function Fx(n,e){for(var t=0;t<e.length;t++){const s=e[t];if(typeof s!="string"&&!Array.isArray(s)){for(const a in s)if(a!=="default"&&!(a in n)){const l=Object.getOwnPropertyDescriptor(s,a);l&&Object.defineProperty(n,a,l.get?l:{enumerable:!0,get:()=>s[a]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const d of l.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&s(d)}).observe(document,{childList:!0,subtree:!0});function t(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(a){if(a.ep)return;a.ep=!0;const l=t(a);fetch(a.href,l)}})();function Gv(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Lh={exports:{}},ul={},Oh={exports:{}},at={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fg;function Ux(){if(Fg)return at;Fg=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),d=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),v=Symbol.for("react.memo"),w=Symbol.for("react.lazy"),S=Symbol.iterator;function C(A){return A===null||typeof A!="object"?null:(A=S&&A[S]||A["@@iterator"],typeof A=="function"?A:null)}var $={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},X=Object.assign,q={};function U(A,N,se){this.props=A,this.context=N,this.refs=q,this.updater=se||$}U.prototype.isReactComponent={},U.prototype.setState=function(A,N){if(typeof A!="object"&&typeof A!="function"&&A!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,A,N,"setState")},U.prototype.forceUpdate=function(A){this.updater.enqueueForceUpdate(this,A,"forceUpdate")};function ne(){}ne.prototype=U.prototype;function xe(A,N,se){this.props=A,this.context=N,this.refs=q,this.updater=se||$}var ge=xe.prototype=new ne;ge.constructor=xe,X(ge,U.prototype),ge.isPureReactComponent=!0;var ye=Array.isArray,ie=Object.prototype.hasOwnProperty,Ee={current:null},k={key:!0,ref:!0,__self:!0,__source:!0};function P(A,N,se){var ee,_e={},me=null,Ae=null;if(N!=null)for(ee in N.ref!==void 0&&(Ae=N.ref),N.key!==void 0&&(me=""+N.key),N)ie.call(N,ee)&&!k.hasOwnProperty(ee)&&(_e[ee]=N[ee]);var Me=arguments.length-2;if(Me===1)_e.children=se;else if(1<Me){for(var Qe=Array(Me),xt=0;xt<Me;xt++)Qe[xt]=arguments[xt+2];_e.children=Qe}if(A&&A.defaultProps)for(ee in Me=A.defaultProps,Me)_e[ee]===void 0&&(_e[ee]=Me[ee]);return{$$typeof:n,type:A,key:me,ref:Ae,props:_e,_owner:Ee.current}}function R(A,N){return{$$typeof:n,type:A.type,key:N,ref:A.ref,props:A.props,_owner:A._owner}}function M(A){return typeof A=="object"&&A!==null&&A.$$typeof===n}function B(A){var N={"=":"=0",":":"=2"};return"$"+A.replace(/[=:]/g,function(se){return N[se]})}var V=/\/+/g;function b(A,N){return typeof A=="object"&&A!==null&&A.key!=null?B(""+A.key):N.toString(36)}function he(A,N,se,ee,_e){var me=typeof A;(me==="undefined"||me==="boolean")&&(A=null);var Ae=!1;if(A===null)Ae=!0;else switch(me){case"string":case"number":Ae=!0;break;case"object":switch(A.$$typeof){case n:case e:Ae=!0}}if(Ae)return Ae=A,_e=_e(Ae),A=ee===""?"."+b(Ae,0):ee,ye(_e)?(se="",A!=null&&(se=A.replace(V,"$&/")+"/"),he(_e,N,se,"",function(xt){return xt})):_e!=null&&(M(_e)&&(_e=R(_e,se+(!_e.key||Ae&&Ae.key===_e.key?"":(""+_e.key).replace(V,"$&/")+"/")+A)),N.push(_e)),1;if(Ae=0,ee=ee===""?".":ee+":",ye(A))for(var Me=0;Me<A.length;Me++){me=A[Me];var Qe=ee+b(me,Me);Ae+=he(me,N,se,Qe,_e)}else if(Qe=C(A),typeof Qe=="function")for(A=Qe.call(A),Me=0;!(me=A.next()).done;)me=me.value,Qe=ee+b(me,Me++),Ae+=he(me,N,se,Qe,_e);else if(me==="object")throw N=String(A),Error("Objects are not valid as a React child (found: "+(N==="[object Object]"?"object with keys {"+Object.keys(A).join(", ")+"}":N)+"). If you meant to render a collection of children, use an array instead.");return Ae}function ve(A,N,se){if(A==null)return A;var ee=[],_e=0;return he(A,ee,"","",function(me){return N.call(se,me,_e++)}),ee}function ot(A){if(A._status===-1){var N=A._result;N=N(),N.then(function(se){(A._status===0||A._status===-1)&&(A._status=1,A._result=se)},function(se){(A._status===0||A._status===-1)&&(A._status=2,A._result=se)}),A._status===-1&&(A._status=0,A._result=N)}if(A._status===1)return A._result.default;throw A._result}var Ve={current:null},pe={transition:null},be={ReactCurrentDispatcher:Ve,ReactCurrentBatchConfig:pe,ReactCurrentOwner:Ee};function Te(){throw Error("act(...) is not supported in production builds of React.")}return at.Children={map:ve,forEach:function(A,N,se){ve(A,function(){N.apply(this,arguments)},se)},count:function(A){var N=0;return ve(A,function(){N++}),N},toArray:function(A){return ve(A,function(N){return N})||[]},only:function(A){if(!M(A))throw Error("React.Children.only expected to receive a single React element child.");return A}},at.Component=U,at.Fragment=t,at.Profiler=a,at.PureComponent=xe,at.StrictMode=s,at.Suspense=m,at.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=be,at.act=Te,at.cloneElement=function(A,N,se){if(A==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+A+".");var ee=X({},A.props),_e=A.key,me=A.ref,Ae=A._owner;if(N!=null){if(N.ref!==void 0&&(me=N.ref,Ae=Ee.current),N.key!==void 0&&(_e=""+N.key),A.type&&A.type.defaultProps)var Me=A.type.defaultProps;for(Qe in N)ie.call(N,Qe)&&!k.hasOwnProperty(Qe)&&(ee[Qe]=N[Qe]===void 0&&Me!==void 0?Me[Qe]:N[Qe])}var Qe=arguments.length-2;if(Qe===1)ee.children=se;else if(1<Qe){Me=Array(Qe);for(var xt=0;xt<Qe;xt++)Me[xt]=arguments[xt+2];ee.children=Me}return{$$typeof:n,type:A.type,key:_e,ref:me,props:ee,_owner:Ae}},at.createContext=function(A){return A={$$typeof:d,_currentValue:A,_currentValue2:A,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},A.Provider={$$typeof:l,_context:A},A.Consumer=A},at.createElement=P,at.createFactory=function(A){var N=P.bind(null,A);return N.type=A,N},at.createRef=function(){return{current:null}},at.forwardRef=function(A){return{$$typeof:f,render:A}},at.isValidElement=M,at.lazy=function(A){return{$$typeof:w,_payload:{_status:-1,_result:A},_init:ot}},at.memo=function(A,N){return{$$typeof:v,type:A,compare:N===void 0?null:N}},at.startTransition=function(A){var N=pe.transition;pe.transition={};try{A()}finally{pe.transition=N}},at.unstable_act=Te,at.useCallback=function(A,N){return Ve.current.useCallback(A,N)},at.useContext=function(A){return Ve.current.useContext(A)},at.useDebugValue=function(){},at.useDeferredValue=function(A){return Ve.current.useDeferredValue(A)},at.useEffect=function(A,N){return Ve.current.useEffect(A,N)},at.useId=function(){return Ve.current.useId()},at.useImperativeHandle=function(A,N,se){return Ve.current.useImperativeHandle(A,N,se)},at.useInsertionEffect=function(A,N){return Ve.current.useInsertionEffect(A,N)},at.useLayoutEffect=function(A,N){return Ve.current.useLayoutEffect(A,N)},at.useMemo=function(A,N){return Ve.current.useMemo(A,N)},at.useReducer=function(A,N,se){return Ve.current.useReducer(A,N,se)},at.useRef=function(A){return Ve.current.useRef(A)},at.useState=function(A){return Ve.current.useState(A)},at.useSyncExternalStore=function(A,N,se){return Ve.current.useSyncExternalStore(A,N,se)},at.useTransition=function(){return Ve.current.useTransition()},at.version="18.3.1",at}var Ug;function kf(){return Ug||(Ug=1,Oh.exports=Ux()),Oh.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zg;function zx(){if(zg)return ul;zg=1;var n=kf(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,a=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function d(f,m,v){var w,S={},C=null,$=null;v!==void 0&&(C=""+v),m.key!==void 0&&(C=""+m.key),m.ref!==void 0&&($=m.ref);for(w in m)s.call(m,w)&&!l.hasOwnProperty(w)&&(S[w]=m[w]);if(f&&f.defaultProps)for(w in m=f.defaultProps,m)S[w]===void 0&&(S[w]=m[w]);return{$$typeof:e,type:f,key:C,ref:$,props:S,_owner:a.current}}return ul.Fragment=t,ul.jsx=d,ul.jsxs=d,ul}var Bg;function Bx(){return Bg||(Bg=1,Lh.exports=zx()),Lh.exports}var c=Bx(),D=kf();const jf=Gv(D),$x=Fx({__proto__:null,default:jf},[D]);var ru={},Mh={exports:{}},pr={},Fh={exports:{}},Uh={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $g;function Wx(){return $g||($g=1,(function(n){function e(pe,be){var Te=pe.length;pe.push(be);e:for(;0<Te;){var A=Te-1>>>1,N=pe[A];if(0<a(N,be))pe[A]=be,pe[Te]=N,Te=A;else break e}}function t(pe){return pe.length===0?null:pe[0]}function s(pe){if(pe.length===0)return null;var be=pe[0],Te=pe.pop();if(Te!==be){pe[0]=Te;e:for(var A=0,N=pe.length,se=N>>>1;A<se;){var ee=2*(A+1)-1,_e=pe[ee],me=ee+1,Ae=pe[me];if(0>a(_e,Te))me<N&&0>a(Ae,_e)?(pe[A]=Ae,pe[me]=Te,A=me):(pe[A]=_e,pe[ee]=Te,A=ee);else if(me<N&&0>a(Ae,Te))pe[A]=Ae,pe[me]=Te,A=me;else break e}}return be}function a(pe,be){var Te=pe.sortIndex-be.sortIndex;return Te!==0?Te:pe.id-be.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;n.unstable_now=function(){return l.now()}}else{var d=Date,f=d.now();n.unstable_now=function(){return d.now()-f}}var m=[],v=[],w=1,S=null,C=3,$=!1,X=!1,q=!1,U=typeof setTimeout=="function"?setTimeout:null,ne=typeof clearTimeout=="function"?clearTimeout:null,xe=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function ge(pe){for(var be=t(v);be!==null;){if(be.callback===null)s(v);else if(be.startTime<=pe)s(v),be.sortIndex=be.expirationTime,e(m,be);else break;be=t(v)}}function ye(pe){if(q=!1,ge(pe),!X)if(t(m)!==null)X=!0,ot(ie);else{var be=t(v);be!==null&&Ve(ye,be.startTime-pe)}}function ie(pe,be){X=!1,q&&(q=!1,ne(P),P=-1),$=!0;var Te=C;try{for(ge(be),S=t(m);S!==null&&(!(S.expirationTime>be)||pe&&!B());){var A=S.callback;if(typeof A=="function"){S.callback=null,C=S.priorityLevel;var N=A(S.expirationTime<=be);be=n.unstable_now(),typeof N=="function"?S.callback=N:S===t(m)&&s(m),ge(be)}else s(m);S=t(m)}if(S!==null)var se=!0;else{var ee=t(v);ee!==null&&Ve(ye,ee.startTime-be),se=!1}return se}finally{S=null,C=Te,$=!1}}var Ee=!1,k=null,P=-1,R=5,M=-1;function B(){return!(n.unstable_now()-M<R)}function V(){if(k!==null){var pe=n.unstable_now();M=pe;var be=!0;try{be=k(!0,pe)}finally{be?b():(Ee=!1,k=null)}}else Ee=!1}var b;if(typeof xe=="function")b=function(){xe(V)};else if(typeof MessageChannel<"u"){var he=new MessageChannel,ve=he.port2;he.port1.onmessage=V,b=function(){ve.postMessage(null)}}else b=function(){U(V,0)};function ot(pe){k=pe,Ee||(Ee=!0,b())}function Ve(pe,be){P=U(function(){pe(n.unstable_now())},be)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(pe){pe.callback=null},n.unstable_continueExecution=function(){X||$||(X=!0,ot(ie))},n.unstable_forceFrameRate=function(pe){0>pe||125<pe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<pe?Math.floor(1e3/pe):5},n.unstable_getCurrentPriorityLevel=function(){return C},n.unstable_getFirstCallbackNode=function(){return t(m)},n.unstable_next=function(pe){switch(C){case 1:case 2:case 3:var be=3;break;default:be=C}var Te=C;C=be;try{return pe()}finally{C=Te}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(pe,be){switch(pe){case 1:case 2:case 3:case 4:case 5:break;default:pe=3}var Te=C;C=pe;try{return be()}finally{C=Te}},n.unstable_scheduleCallback=function(pe,be,Te){var A=n.unstable_now();switch(typeof Te=="object"&&Te!==null?(Te=Te.delay,Te=typeof Te=="number"&&0<Te?A+Te:A):Te=A,pe){case 1:var N=-1;break;case 2:N=250;break;case 5:N=1073741823;break;case 4:N=1e4;break;default:N=5e3}return N=Te+N,pe={id:w++,callback:be,priorityLevel:pe,startTime:Te,expirationTime:N,sortIndex:-1},Te>A?(pe.sortIndex=Te,e(v,pe),t(m)===null&&pe===t(v)&&(q?(ne(P),P=-1):q=!0,Ve(ye,Te-A))):(pe.sortIndex=N,e(m,pe),X||$||(X=!0,ot(ie))),pe},n.unstable_shouldYield=B,n.unstable_wrapCallback=function(pe){var be=C;return function(){var Te=C;C=be;try{return pe.apply(this,arguments)}finally{C=Te}}}})(Uh)),Uh}var Wg;function Gx(){return Wg||(Wg=1,Fh.exports=Wx()),Fh.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gg;function Hx(){if(Gg)return pr;Gg=1;var n=kf(),e=Gx();function t(r){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+r,o=1;o<arguments.length;o++)i+="&args[]="+encodeURIComponent(arguments[o]);return"Minified React error #"+r+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,a={};function l(r,i){d(r,i),d(r+"Capture",i)}function d(r,i){for(a[r]=i,r=0;r<i.length;r++)s.add(i[r])}var f=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),m=Object.prototype.hasOwnProperty,v=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,w={},S={};function C(r){return m.call(S,r)?!0:m.call(w,r)?!1:v.test(r)?S[r]=!0:(w[r]=!0,!1)}function $(r,i,o,h){if(o!==null&&o.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return h?!1:o!==null?!o.acceptsBooleans:(r=r.toLowerCase().slice(0,5),r!=="data-"&&r!=="aria-");default:return!1}}function X(r,i,o,h){if(i===null||typeof i>"u"||$(r,i,o,h))return!0;if(h)return!1;if(o!==null)switch(o.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function q(r,i,o,h,p,y,x){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=h,this.attributeNamespace=p,this.mustUseProperty=o,this.propertyName=r,this.type=i,this.sanitizeURL=y,this.removeEmptyString=x}var U={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(r){U[r]=new q(r,0,!1,r,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(r){var i=r[0];U[i]=new q(i,1,!1,r[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(r){U[r]=new q(r,2,!1,r.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(r){U[r]=new q(r,2,!1,r,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(r){U[r]=new q(r,3,!1,r.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(r){U[r]=new q(r,3,!0,r,null,!1,!1)}),["capture","download"].forEach(function(r){U[r]=new q(r,4,!1,r,null,!1,!1)}),["cols","rows","size","span"].forEach(function(r){U[r]=new q(r,6,!1,r,null,!1,!1)}),["rowSpan","start"].forEach(function(r){U[r]=new q(r,5,!1,r.toLowerCase(),null,!1,!1)});var ne=/[\-:]([a-z])/g;function xe(r){return r[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(r){var i=r.replace(ne,xe);U[i]=new q(i,1,!1,r,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(r){var i=r.replace(ne,xe);U[i]=new q(i,1,!1,r,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(r){var i=r.replace(ne,xe);U[i]=new q(i,1,!1,r,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(r){U[r]=new q(r,1,!1,r.toLowerCase(),null,!1,!1)}),U.xlinkHref=new q("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(r){U[r]=new q(r,1,!1,r.toLowerCase(),null,!0,!0)});function ge(r,i,o,h){var p=U.hasOwnProperty(i)?U[i]:null;(p!==null?p.type!==0:h||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(X(i,o,p,h)&&(o=null),h||p===null?C(i)&&(o===null?r.removeAttribute(i):r.setAttribute(i,""+o)):p.mustUseProperty?r[p.propertyName]=o===null?p.type===3?!1:"":o:(i=p.attributeName,h=p.attributeNamespace,o===null?r.removeAttribute(i):(p=p.type,o=p===3||p===4&&o===!0?"":""+o,h?r.setAttributeNS(h,i,o):r.setAttribute(i,o))))}var ye=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ie=Symbol.for("react.element"),Ee=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),P=Symbol.for("react.strict_mode"),R=Symbol.for("react.profiler"),M=Symbol.for("react.provider"),B=Symbol.for("react.context"),V=Symbol.for("react.forward_ref"),b=Symbol.for("react.suspense"),he=Symbol.for("react.suspense_list"),ve=Symbol.for("react.memo"),ot=Symbol.for("react.lazy"),Ve=Symbol.for("react.offscreen"),pe=Symbol.iterator;function be(r){return r===null||typeof r!="object"?null:(r=pe&&r[pe]||r["@@iterator"],typeof r=="function"?r:null)}var Te=Object.assign,A;function N(r){if(A===void 0)try{throw Error()}catch(o){var i=o.stack.trim().match(/\n( *(at )?)/);A=i&&i[1]||""}return`
`+A+r}var se=!1;function ee(r,i){if(!r||se)return"";se=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(Z){var h=Z}Reflect.construct(r,[],i)}else{try{i.call()}catch(Z){h=Z}r.call(i.prototype)}else{try{throw Error()}catch(Z){h=Z}r()}}catch(Z){if(Z&&h&&typeof Z.stack=="string"){for(var p=Z.stack.split(`
`),y=h.stack.split(`
`),x=p.length-1,j=y.length-1;1<=x&&0<=j&&p[x]!==y[j];)j--;for(;1<=x&&0<=j;x--,j--)if(p[x]!==y[j]){if(x!==1||j!==1)do if(x--,j--,0>j||p[x]!==y[j]){var z=`
`+p[x].replace(" at new "," at ");return r.displayName&&z.includes("<anonymous>")&&(z=z.replace("<anonymous>",r.displayName)),z}while(1<=x&&0<=j);break}}}finally{se=!1,Error.prepareStackTrace=o}return(r=r?r.displayName||r.name:"")?N(r):""}function _e(r){switch(r.tag){case 5:return N(r.type);case 16:return N("Lazy");case 13:return N("Suspense");case 19:return N("SuspenseList");case 0:case 2:case 15:return r=ee(r.type,!1),r;case 11:return r=ee(r.type.render,!1),r;case 1:return r=ee(r.type,!0),r;default:return""}}function me(r){if(r==null)return null;if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case k:return"Fragment";case Ee:return"Portal";case R:return"Profiler";case P:return"StrictMode";case b:return"Suspense";case he:return"SuspenseList"}if(typeof r=="object")switch(r.$$typeof){case B:return(r.displayName||"Context")+".Consumer";case M:return(r._context.displayName||"Context")+".Provider";case V:var i=r.render;return r=r.displayName,r||(r=i.displayName||i.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case ve:return i=r.displayName||null,i!==null?i:me(r.type)||"Memo";case ot:i=r._payload,r=r._init;try{return me(r(i))}catch{}}return null}function Ae(r){var i=r.type;switch(r.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return r=i.render,r=r.displayName||r.name||"",i.displayName||(r!==""?"ForwardRef("+r+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return me(i);case 8:return i===P?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function Me(r){switch(typeof r){case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function Qe(r){var i=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function xt(r){var i=Qe(r)?"checked":"value",o=Object.getOwnPropertyDescriptor(r.constructor.prototype,i),h=""+r[i];if(!r.hasOwnProperty(i)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var p=o.get,y=o.set;return Object.defineProperty(r,i,{configurable:!0,get:function(){return p.call(this)},set:function(x){h=""+x,y.call(this,x)}}),Object.defineProperty(r,i,{enumerable:o.enumerable}),{getValue:function(){return h},setValue:function(x){h=""+x},stopTracking:function(){r._valueTracker=null,delete r[i]}}}}function te(r){r._valueTracker||(r._valueTracker=xt(r))}function Fe(r){if(!r)return!1;var i=r._valueTracker;if(!i)return!0;var o=i.getValue(),h="";return r&&(h=Qe(r)?r.checked?"true":"false":r.value),r=h,r!==o?(i.setValue(r),!0):!1}function Be(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}function We(r,i){var o=i.checked;return Te({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:o??r._wrapperState.initialChecked})}function Et(r,i){var o=i.defaultValue==null?"":i.defaultValue,h=i.checked!=null?i.checked:i.defaultChecked;o=Me(i.value!=null?i.value:o),r._wrapperState={initialChecked:h,initialValue:o,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function wt(r,i){i=i.checked,i!=null&&ge(r,"checked",i,!1)}function pt(r,i){wt(r,i);var o=Me(i.value),h=i.type;if(o!=null)h==="number"?(o===0&&r.value===""||r.value!=o)&&(r.value=""+o):r.value!==""+o&&(r.value=""+o);else if(h==="submit"||h==="reset"){r.removeAttribute("value");return}i.hasOwnProperty("value")?Ut(r,i.type,o):i.hasOwnProperty("defaultValue")&&Ut(r,i.type,Me(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(r.defaultChecked=!!i.defaultChecked)}function Tt(r,i,o){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var h=i.type;if(!(h!=="submit"&&h!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+r._wrapperState.initialValue,o||i===r.value||(r.value=i),r.defaultValue=i}o=r.name,o!==""&&(r.name=""),r.defaultChecked=!!r._wrapperState.initialChecked,o!==""&&(r.name=o)}function Ut(r,i,o){(i!=="number"||Be(r.ownerDocument)!==r)&&(o==null?r.defaultValue=""+r._wrapperState.initialValue:r.defaultValue!==""+o&&(r.defaultValue=""+o))}var It=Array.isArray;function In(r,i,o,h){if(r=r.options,i){i={};for(var p=0;p<o.length;p++)i["$"+o[p]]=!0;for(o=0;o<r.length;o++)p=i.hasOwnProperty("$"+r[o].value),r[o].selected!==p&&(r[o].selected=p),p&&h&&(r[o].defaultSelected=!0)}else{for(o=""+Me(o),i=null,p=0;p<r.length;p++){if(r[p].value===o){r[p].selected=!0,h&&(r[p].defaultSelected=!0);return}i!==null||r[p].disabled||(i=r[p])}i!==null&&(i.selected=!0)}}function gn(r,i){if(i.dangerouslySetInnerHTML!=null)throw Error(t(91));return Te({},i,{value:void 0,defaultValue:void 0,children:""+r._wrapperState.initialValue})}function qn(r,i){var o=i.value;if(o==null){if(o=i.children,i=i.defaultValue,o!=null){if(i!=null)throw Error(t(92));if(It(o)){if(1<o.length)throw Error(t(93));o=o[0]}i=o}i==null&&(i=""),o=i}r._wrapperState={initialValue:Me(o)}}function yn(r,i){var o=Me(i.value),h=Me(i.defaultValue);o!=null&&(o=""+o,o!==r.value&&(r.value=o),i.defaultValue==null&&r.defaultValue!==o&&(r.defaultValue=o)),h!=null&&(r.defaultValue=""+h)}function sr(r){var i=r.textContent;i===r._wrapperState.initialValue&&i!==""&&i!==null&&(r.value=i)}function Lt(r){switch(r){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function bt(r,i){return r==null||r==="http://www.w3.org/1999/xhtml"?Lt(i):r==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":r}var yr,ss=(function(r){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,o,h,p){MSApp.execUnsafeLocalFunction(function(){return r(i,o,h,p)})}:r})(function(r,i){if(r.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in r)r.innerHTML=i;else{for(yr=yr||document.createElement("div"),yr.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=yr.firstChild;r.firstChild;)r.removeChild(r.firstChild);for(;i.firstChild;)r.appendChild(i.firstChild)}});function Vn(r,i){if(i){var o=r.firstChild;if(o&&o===r.lastChild&&o.nodeType===3){o.nodeValue=i;return}}r.textContent=i}var an={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ir=["Webkit","ms","Moz","O"];Object.keys(an).forEach(function(r){ir.forEach(function(i){i=i+r.charAt(0).toUpperCase()+r.substring(1),an[i]=an[r]})});function is(r,i,o){return i==null||typeof i=="boolean"||i===""?"":o||typeof i!="number"||i===0||an.hasOwnProperty(r)&&an[r]?(""+i).trim():i+"px"}function mt(r,i){r=r.style;for(var o in i)if(i.hasOwnProperty(o)){var h=o.indexOf("--")===0,p=is(o,i[o],h);o==="float"&&(o="cssFloat"),h?r.setProperty(o,p):r[o]=p}}var as=Te({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function As(r,i){if(i){if(as[r]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(t(137,r));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(t(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(t(61))}if(i.style!=null&&typeof i.style!="object")throw Error(t(62))}}function ri(r,i){if(r.indexOf("-")===-1)return typeof i.is=="string";switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var on=null;function Cn(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var ar=null,Yt=null,Ht=null;function ln(r){if(r=Qo(r)){if(typeof ar!="function")throw Error(t(280));var i=r.stateNode;i&&(i=vc(i),ar(r.stateNode,r.type,i))}}function vn(r){Yt?Ht?Ht.push(r):Ht=[r]:Yt=r}function os(){if(Yt){var r=Yt,i=Ht;if(Ht=Yt=null,ln(r),i)for(r=0;r<i.length;r++)ln(i[r])}}function yt(r,i){return r(i)}function ls(){}var Kn=!1;function Ln(r,i,o){if(Kn)return r(i,o);Kn=!0;try{return yt(r,i,o)}finally{Kn=!1,(Yt!==null||Ht!==null)&&(ls(),os())}}function Rt(r,i){var o=r.stateNode;if(o===null)return null;var h=vc(o);if(h===null)return null;o=h[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(r=r.type,h=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!h;break e;default:r=!1}if(r)return null;if(o&&typeof o!="function")throw Error(t(231,i,typeof o));return o}var Jt=!1;if(f)try{var On={};Object.defineProperty(On,"passive",{get:function(){Jt=!0}}),window.addEventListener("test",On,On),window.removeEventListener("test",On,On)}catch{Jt=!1}function vr(r,i,o,h,p,y,x,j,z){var Z=Array.prototype.slice.call(arguments,3);try{i.apply(o,Z)}catch(de){this.onError(de)}}var _n=!1,Qn=null,bn=!1,Cr=null,Qi={onError:function(r){_n=!0,Qn=r}};function Fr(r,i,o,h,p,y,x,j,z){_n=!1,Qn=null,vr.apply(Qi,arguments)}function cs(r,i,o,h,p,y,x,j,z){if(Fr.apply(this,arguments),_n){if(_n){var Z=Qn;_n=!1,Qn=null}else throw Error(t(198));bn||(bn=!0,Cr=Z)}}function Yn(r){var i=r,o=r;if(r.alternate)for(;i.return;)i=i.return;else{r=i;do i=r,(i.flags&4098)!==0&&(o=i.return),r=i.return;while(r)}return i.tag===3?o:null}function Ur(r){if(r.tag===13){var i=r.memoizedState;if(i===null&&(r=r.alternate,r!==null&&(i=r.memoizedState)),i!==null)return i.dehydrated}return null}function Jn(r){if(Yn(r)!==r)throw Error(t(188))}function si(r){var i=r.alternate;if(!i){if(i=Yn(r),i===null)throw Error(t(188));return i!==r?null:r}for(var o=r,h=i;;){var p=o.return;if(p===null)break;var y=p.alternate;if(y===null){if(h=p.return,h!==null){o=h;continue}break}if(p.child===y.child){for(y=p.child;y;){if(y===o)return Jn(p),r;if(y===h)return Jn(p),i;y=y.sibling}throw Error(t(188))}if(o.return!==h.return)o=p,h=y;else{for(var x=!1,j=p.child;j;){if(j===o){x=!0,o=p,h=y;break}if(j===h){x=!0,h=p,o=y;break}j=j.sibling}if(!x){for(j=y.child;j;){if(j===o){x=!0,o=y,h=p;break}if(j===h){x=!0,h=y,o=p;break}j=j.sibling}if(!x)throw Error(t(189))}}if(o.alternate!==h)throw Error(t(190))}if(o.tag!==3)throw Error(t(188));return o.stateNode.current===o?r:i}function ks(r){return r=si(r),r!==null?zr(r):null}function zr(r){if(r.tag===5||r.tag===6)return r;for(r=r.child;r!==null;){var i=zr(r);if(i!==null)return i;r=r.sibling}return null}var lt=e.unstable_scheduleCallback,Xn=e.unstable_cancelCallback,Xt=e.unstable_shouldYield,E=e.unstable_requestPaint,H=e.unstable_now,Y=e.unstable_getCurrentPriorityLevel,O=e.unstable_ImmediatePriority,W=e.unstable_UserBlockingPriority,ce=e.unstable_NormalPriority,Ie=e.unstable_LowPriority,Je=e.unstable_IdlePriority,Ce=null,T=null;function L(r){if(T&&typeof T.onCommitFiberRoot=="function")try{T.onCommitFiberRoot(Ce,r,void 0,(r.current.flags&128)===128)}catch{}}var F=Math.clz32?Math.clz32:ze,oe=Math.log,Pe=Math.LN2;function ze(r){return r>>>=0,r===0?32:31-(oe(r)/Pe|0)|0}var Re=64,Ze=4194304;function ct(r){switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return r&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return r}}function vt(r,i){var o=r.pendingLanes;if(o===0)return 0;var h=0,p=r.suspendedLanes,y=r.pingedLanes,x=o&268435455;if(x!==0){var j=x&~p;j!==0?h=ct(j):(y&=x,y!==0&&(h=ct(y)))}else x=o&~p,x!==0?h=ct(x):y!==0&&(h=ct(y));if(h===0)return 0;if(i!==0&&i!==h&&(i&p)===0&&(p=h&-h,y=i&-i,p>=y||p===16&&(y&4194240)!==0))return i;if((h&4)!==0&&(h|=o&16),i=r.entangledLanes,i!==0)for(r=r.entanglements,i&=h;0<i;)o=31-F(i),p=1<<o,h|=r[o],i&=~p;return h}function cn(r,i){switch(r){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Nt(r,i){for(var o=r.suspendedLanes,h=r.pingedLanes,p=r.expirationTimes,y=r.pendingLanes;0<y;){var x=31-F(y),j=1<<x,z=p[x];z===-1?((j&o)===0||(j&h)!==0)&&(p[x]=cn(j,i)):z<=i&&(r.expiredLanes|=j),y&=~j}}function Ot(r){return r=r.pendingLanes&-1073741825,r!==0?r:r&1073741824?1073741824:0}function zt(){var r=Re;return Re<<=1,(Re&4194240)===0&&(Re=64),r}function it(r){for(var i=[],o=0;31>o;o++)i.push(r);return i}function Zn(r,i,o){r.pendingLanes|=i,i!==536870912&&(r.suspendedLanes=0,r.pingedLanes=0),r=r.eventTimes,i=31-F(i),r[i]=o}function nt(r,i){var o=r.pendingLanes&~i;r.pendingLanes=i,r.suspendedLanes=0,r.pingedLanes=0,r.expiredLanes&=i,r.mutableReadLanes&=i,r.entangledLanes&=i,i=r.entanglements;var h=r.eventTimes;for(r=r.expirationTimes;0<o;){var p=31-F(o),y=1<<p;i[p]=0,h[p]=-1,r[p]=-1,o&=~y}}function Mn(r,i){var o=r.entangledLanes|=i;for(r=r.entanglements;o;){var h=31-F(o),p=1<<h;p&i|r[h]&i&&(r[h]|=i),o&=~p}}var rt=0;function us(r){return r&=-r,1<r?4<r?(r&268435455)!==0?16:536870912:4:1}var ba,ii,ds,Pa,ec,Do=!1,hs=[],Pn=null,Br=null,$r=null,ai=new Map,br=new Map,fs=[],fd="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function tc(r,i){switch(r){case"focusin":case"focusout":Pn=null;break;case"dragenter":case"dragleave":Br=null;break;case"mouseover":case"mouseout":$r=null;break;case"pointerover":case"pointerout":ai.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":br.delete(i.pointerId)}}function or(r,i,o,h,p,y){return r===null||r.nativeEvent!==y?(r={blockedOn:i,domEventName:o,eventSystemFlags:h,nativeEvent:y,targetContainers:[p]},i!==null&&(i=Qo(i),i!==null&&ii(i)),r):(r.eventSystemFlags|=h,i=r.targetContainers,p!==null&&i.indexOf(p)===-1&&i.push(p),r)}function pd(r,i,o,h,p){switch(i){case"focusin":return Pn=or(Pn,r,i,o,h,p),!0;case"dragenter":return Br=or(Br,r,i,o,h,p),!0;case"mouseover":return $r=or($r,r,i,o,h,p),!0;case"pointerover":var y=p.pointerId;return ai.set(y,or(ai.get(y)||null,r,i,o,h,p)),!0;case"gotpointercapture":return y=p.pointerId,br.set(y,or(br.get(y)||null,r,i,o,h,p)),!0}return!1}function nc(r){var i=ea(r.target);if(i!==null){var o=Yn(i);if(o!==null){if(i=o.tag,i===13){if(i=Ur(o),i!==null){r.blockedOn=i,ec(r.priority,function(){ds(o)});return}}else if(i===3&&o.stateNode.current.memoizedState.isDehydrated){r.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}r.blockedOn=null}function js(r){if(r.blockedOn!==null)return!1;for(var i=r.targetContainers;0<i.length;){var o=Ra(r.domEventName,r.eventSystemFlags,i[0],r.nativeEvent);if(o===null){o=r.nativeEvent;var h=new o.constructor(o.type,o);on=h,o.target.dispatchEvent(h),on=null}else return i=Qo(o),i!==null&&ii(i),r.blockedOn=o,!1;i.shift()}return!0}function Yi(r,i,o){js(r)&&o.delete(i)}function rc(){Do=!1,Pn!==null&&js(Pn)&&(Pn=null),Br!==null&&js(Br)&&(Br=null),$r!==null&&js($r)&&($r=null),ai.forEach(Yi),br.forEach(Yi)}function Wr(r,i){r.blockedOn===i&&(r.blockedOn=null,Do||(Do=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,rc)))}function Gr(r){function i(p){return Wr(p,r)}if(0<hs.length){Wr(hs[0],r);for(var o=1;o<hs.length;o++){var h=hs[o];h.blockedOn===r&&(h.blockedOn=null)}}for(Pn!==null&&Wr(Pn,r),Br!==null&&Wr(Br,r),$r!==null&&Wr($r,r),ai.forEach(i),br.forEach(i),o=0;o<fs.length;o++)h=fs[o],h.blockedOn===r&&(h.blockedOn=null);for(;0<fs.length&&(o=fs[0],o.blockedOn===null);)nc(o),o.blockedOn===null&&fs.shift()}var Ds=ye.ReactCurrentBatchConfig,oi=!0;function Mt(r,i,o,h){var p=rt,y=Ds.transition;Ds.transition=null;try{rt=1,Vo(r,i,o,h)}finally{rt=p,Ds.transition=y}}function md(r,i,o,h){var p=rt,y=Ds.transition;Ds.transition=null;try{rt=4,Vo(r,i,o,h)}finally{rt=p,Ds.transition=y}}function Vo(r,i,o,h){if(oi){var p=Ra(r,i,o,h);if(p===null)Cd(r,i,h,Ji,o),tc(r,h);else if(pd(p,r,i,o,h))h.stopPropagation();else if(tc(r,h),i&4&&-1<fd.indexOf(r)){for(;p!==null;){var y=Qo(p);if(y!==null&&ba(y),y=Ra(r,i,o,h),y===null&&Cd(r,i,h,Ji,o),y===p)break;p=y}p!==null&&h.stopPropagation()}else Cd(r,i,h,null,o)}}var Ji=null;function Ra(r,i,o,h){if(Ji=null,r=Cn(h),r=ea(r),r!==null)if(i=Yn(r),i===null)r=null;else if(o=i.tag,o===13){if(r=Ur(i),r!==null)return r;r=null}else if(o===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;r=null}else i!==r&&(r=null);return Ji=r,null}function Lo(r){switch(r){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Y()){case O:return 1;case W:return 4;case ce:case Ie:return 16;case Je:return 536870912;default:return 16}default:return 16}}var _r=null,Na=null,lr=null;function Oo(){if(lr)return lr;var r,i=Na,o=i.length,h,p="value"in _r?_r.value:_r.textContent,y=p.length;for(r=0;r<o&&i[r]===p[r];r++);var x=o-r;for(h=1;h<=x&&i[o-h]===p[y-h];h++);return lr=p.slice(r,1<h?1-h:void 0)}function Aa(r){var i=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&i===13&&(r=13)):r=i,r===10&&(r=13),32<=r||r===13?r:0}function ps(){return!0}function Mo(){return!1}function Rn(r){function i(o,h,p,y,x){this._reactName=o,this._targetInst=p,this.type=h,this.nativeEvent=y,this.target=x,this.currentTarget=null;for(var j in r)r.hasOwnProperty(j)&&(o=r[j],this[j]=o?o(y):y[j]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?ps:Mo,this.isPropagationStopped=Mo,this}return Te(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=ps)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=ps)},persist:function(){},isPersistent:ps}),i}var Hr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ka=Rn(Hr),ms=Te({},Hr,{view:0,detail:0}),gd=Rn(ms),ja,Vs,li,Xi=Te({},ms,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:gs,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==li&&(li&&r.type==="mousemove"?(ja=r.screenX-li.screenX,Vs=r.screenY-li.screenY):Vs=ja=0,li=r),ja)},movementY:function(r){return"movementY"in r?r.movementY:Vs}}),Da=Rn(Xi),Fo=Te({},Xi,{dataTransfer:0}),sc=Rn(Fo),Va=Te({},ms,{relatedTarget:0}),La=Rn(Va),ic=Te({},Hr,{animationName:0,elapsedTime:0,pseudoElement:0}),Ls=Rn(ic),ac=Te({},Hr,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),oc=Rn(ac),lc=Te({},Hr,{data:0}),Uo=Rn(lc),Oa={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},er={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},cc={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function uc(r){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(r):(r=cc[r])?!!i[r]:!1}function gs(){return uc}var u=Te({},ms,{key:function(r){if(r.key){var i=Oa[r.key]||r.key;if(i!=="Unidentified")return i}return r.type==="keypress"?(r=Aa(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?er[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:gs,charCode:function(r){return r.type==="keypress"?Aa(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?Aa(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),g=Rn(u),_=Te({},Xi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),I=Rn(_),K=Te({},ms,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:gs}),re=Rn(K),Se=Te({},Hr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ct=Rn(Se),un=Te({},Xi,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),ht=Rn(un),wn=[9,13,27,32],Zt=f&&"CompositionEvent"in window,Pr=null;f&&"documentMode"in document&&(Pr=document.documentMode);var wr=f&&"TextEvent"in window&&!Pr,Zi=f&&(!Zt||Pr&&8<Pr&&11>=Pr),Ma=" ",jp=!1;function Dp(r,i){switch(r){case"keyup":return wn.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Vp(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var Fa=!1;function Lw(r,i){switch(r){case"compositionend":return Vp(i);case"keypress":return i.which!==32?null:(jp=!0,Ma);case"textInput":return r=i.data,r===Ma&&jp?null:r;default:return null}}function Ow(r,i){if(Fa)return r==="compositionend"||!Zt&&Dp(r,i)?(r=Oo(),lr=Na=_r=null,Fa=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return Zi&&i.locale!=="ko"?null:i.data;default:return null}}var Mw={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Lp(r){var i=r&&r.nodeName&&r.nodeName.toLowerCase();return i==="input"?!!Mw[r.type]:i==="textarea"}function Op(r,i,o,h){vn(h),i=mc(i,"onChange"),0<i.length&&(o=new ka("onChange","change",null,o,h),r.push({event:o,listeners:i}))}var zo=null,Bo=null;function Fw(r){tm(r,0)}function dc(r){var i=Wa(r);if(Fe(i))return r}function Uw(r,i){if(r==="change")return i}var Mp=!1;if(f){var yd;if(f){var vd="oninput"in document;if(!vd){var Fp=document.createElement("div");Fp.setAttribute("oninput","return;"),vd=typeof Fp.oninput=="function"}yd=vd}else yd=!1;Mp=yd&&(!document.documentMode||9<document.documentMode)}function Up(){zo&&(zo.detachEvent("onpropertychange",zp),Bo=zo=null)}function zp(r){if(r.propertyName==="value"&&dc(Bo)){var i=[];Op(i,Bo,r,Cn(r)),Ln(Fw,i)}}function zw(r,i,o){r==="focusin"?(Up(),zo=i,Bo=o,zo.attachEvent("onpropertychange",zp)):r==="focusout"&&Up()}function Bw(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return dc(Bo)}function $w(r,i){if(r==="click")return dc(i)}function Ww(r,i){if(r==="input"||r==="change")return dc(i)}function Gw(r,i){return r===i&&(r!==0||1/r===1/i)||r!==r&&i!==i}var qr=typeof Object.is=="function"?Object.is:Gw;function $o(r,i){if(qr(r,i))return!0;if(typeof r!="object"||r===null||typeof i!="object"||i===null)return!1;var o=Object.keys(r),h=Object.keys(i);if(o.length!==h.length)return!1;for(h=0;h<o.length;h++){var p=o[h];if(!m.call(i,p)||!qr(r[p],i[p]))return!1}return!0}function Bp(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function $p(r,i){var o=Bp(r);r=0;for(var h;o;){if(o.nodeType===3){if(h=r+o.textContent.length,r<=i&&h>=i)return{node:o,offset:i-r};r=h}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=Bp(o)}}function Wp(r,i){return r&&i?r===i?!0:r&&r.nodeType===3?!1:i&&i.nodeType===3?Wp(r,i.parentNode):"contains"in r?r.contains(i):r.compareDocumentPosition?!!(r.compareDocumentPosition(i)&16):!1:!1}function Gp(){for(var r=window,i=Be();i instanceof r.HTMLIFrameElement;){try{var o=typeof i.contentWindow.location.href=="string"}catch{o=!1}if(o)r=i.contentWindow;else break;i=Be(r.document)}return i}function _d(r){var i=r&&r.nodeName&&r.nodeName.toLowerCase();return i&&(i==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||i==="textarea"||r.contentEditable==="true")}function Hw(r){var i=Gp(),o=r.focusedElem,h=r.selectionRange;if(i!==o&&o&&o.ownerDocument&&Wp(o.ownerDocument.documentElement,o)){if(h!==null&&_d(o)){if(i=h.start,r=h.end,r===void 0&&(r=i),"selectionStart"in o)o.selectionStart=i,o.selectionEnd=Math.min(r,o.value.length);else if(r=(i=o.ownerDocument||document)&&i.defaultView||window,r.getSelection){r=r.getSelection();var p=o.textContent.length,y=Math.min(h.start,p);h=h.end===void 0?y:Math.min(h.end,p),!r.extend&&y>h&&(p=h,h=y,y=p),p=$p(o,y);var x=$p(o,h);p&&x&&(r.rangeCount!==1||r.anchorNode!==p.node||r.anchorOffset!==p.offset||r.focusNode!==x.node||r.focusOffset!==x.offset)&&(i=i.createRange(),i.setStart(p.node,p.offset),r.removeAllRanges(),y>h?(r.addRange(i),r.extend(x.node,x.offset)):(i.setEnd(x.node,x.offset),r.addRange(i)))}}for(i=[],r=o;r=r.parentNode;)r.nodeType===1&&i.push({element:r,left:r.scrollLeft,top:r.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<i.length;o++)r=i[o],r.element.scrollLeft=r.left,r.element.scrollTop=r.top}}var qw=f&&"documentMode"in document&&11>=document.documentMode,Ua=null,wd=null,Wo=null,xd=!1;function Hp(r,i,o){var h=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;xd||Ua==null||Ua!==Be(h)||(h=Ua,"selectionStart"in h&&_d(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),Wo&&$o(Wo,h)||(Wo=h,h=mc(wd,"onSelect"),0<h.length&&(i=new ka("onSelect","select",null,i,o),r.push({event:i,listeners:h}),i.target=Ua)))}function hc(r,i){var o={};return o[r.toLowerCase()]=i.toLowerCase(),o["Webkit"+r]="webkit"+i,o["Moz"+r]="moz"+i,o}var za={animationend:hc("Animation","AnimationEnd"),animationiteration:hc("Animation","AnimationIteration"),animationstart:hc("Animation","AnimationStart"),transitionend:hc("Transition","TransitionEnd")},Ed={},qp={};f&&(qp=document.createElement("div").style,"AnimationEvent"in window||(delete za.animationend.animation,delete za.animationiteration.animation,delete za.animationstart.animation),"TransitionEvent"in window||delete za.transitionend.transition);function fc(r){if(Ed[r])return Ed[r];if(!za[r])return r;var i=za[r],o;for(o in i)if(i.hasOwnProperty(o)&&o in qp)return Ed[r]=i[o];return r}var Kp=fc("animationend"),Qp=fc("animationiteration"),Yp=fc("animationstart"),Jp=fc("transitionend"),Xp=new Map,Zp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ci(r,i){Xp.set(r,i),l(i,[r])}for(var Td=0;Td<Zp.length;Td++){var Sd=Zp[Td],Kw=Sd.toLowerCase(),Qw=Sd[0].toUpperCase()+Sd.slice(1);ci(Kw,"on"+Qw)}ci(Kp,"onAnimationEnd"),ci(Qp,"onAnimationIteration"),ci(Yp,"onAnimationStart"),ci("dblclick","onDoubleClick"),ci("focusin","onFocus"),ci("focusout","onBlur"),ci(Jp,"onTransitionEnd"),d("onMouseEnter",["mouseout","mouseover"]),d("onMouseLeave",["mouseout","mouseover"]),d("onPointerEnter",["pointerout","pointerover"]),d("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Go="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Yw=new Set("cancel close invalid load scroll toggle".split(" ").concat(Go));function em(r,i,o){var h=r.type||"unknown-event";r.currentTarget=o,cs(h,i,void 0,r),r.currentTarget=null}function tm(r,i){i=(i&4)!==0;for(var o=0;o<r.length;o++){var h=r[o],p=h.event;h=h.listeners;e:{var y=void 0;if(i)for(var x=h.length-1;0<=x;x--){var j=h[x],z=j.instance,Z=j.currentTarget;if(j=j.listener,z!==y&&p.isPropagationStopped())break e;em(p,j,Z),y=z}else for(x=0;x<h.length;x++){if(j=h[x],z=j.instance,Z=j.currentTarget,j=j.listener,z!==y&&p.isPropagationStopped())break e;em(p,j,Z),y=z}}}if(bn)throw r=Cr,bn=!1,Cr=null,r}function kt(r,i){var o=i[kd];o===void 0&&(o=i[kd]=new Set);var h=r+"__bubble";o.has(h)||(nm(i,r,2,!1),o.add(h))}function Id(r,i,o){var h=0;i&&(h|=4),nm(o,r,h,i)}var pc="_reactListening"+Math.random().toString(36).slice(2);function Ho(r){if(!r[pc]){r[pc]=!0,s.forEach(function(o){o!=="selectionchange"&&(Yw.has(o)||Id(o,!1,r),Id(o,!0,r))});var i=r.nodeType===9?r:r.ownerDocument;i===null||i[pc]||(i[pc]=!0,Id("selectionchange",!1,i))}}function nm(r,i,o,h){switch(Lo(i)){case 1:var p=Mt;break;case 4:p=md;break;default:p=Vo}o=p.bind(null,i,o,r),p=void 0,!Jt||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(p=!0),h?p!==void 0?r.addEventListener(i,o,{capture:!0,passive:p}):r.addEventListener(i,o,!0):p!==void 0?r.addEventListener(i,o,{passive:p}):r.addEventListener(i,o,!1)}function Cd(r,i,o,h,p){var y=h;if((i&1)===0&&(i&2)===0&&h!==null)e:for(;;){if(h===null)return;var x=h.tag;if(x===3||x===4){var j=h.stateNode.containerInfo;if(j===p||j.nodeType===8&&j.parentNode===p)break;if(x===4)for(x=h.return;x!==null;){var z=x.tag;if((z===3||z===4)&&(z=x.stateNode.containerInfo,z===p||z.nodeType===8&&z.parentNode===p))return;x=x.return}for(;j!==null;){if(x=ea(j),x===null)return;if(z=x.tag,z===5||z===6){h=y=x;continue e}j=j.parentNode}}h=h.return}Ln(function(){var Z=y,de=Cn(o),fe=[];e:{var ue=Xp.get(r);if(ue!==void 0){var Ne=ka,De=r;switch(r){case"keypress":if(Aa(o)===0)break e;case"keydown":case"keyup":Ne=g;break;case"focusin":De="focus",Ne=La;break;case"focusout":De="blur",Ne=La;break;case"beforeblur":case"afterblur":Ne=La;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ne=Da;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ne=sc;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ne=re;break;case Kp:case Qp:case Yp:Ne=Ls;break;case Jp:Ne=Ct;break;case"scroll":Ne=gd;break;case"wheel":Ne=ht;break;case"copy":case"cut":case"paste":Ne=oc;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ne=I}var Le=(i&4)!==0,qt=!Le&&r==="scroll",Q=Le?ue!==null?ue+"Capture":null:ue;Le=[];for(var G=Z,J;G!==null;){J=G;var we=J.stateNode;if(J.tag===5&&we!==null&&(J=we,Q!==null&&(we=Rt(G,Q),we!=null&&Le.push(qo(G,we,J)))),qt)break;G=G.return}0<Le.length&&(ue=new Ne(ue,De,null,o,de),fe.push({event:ue,listeners:Le}))}}if((i&7)===0){e:{if(ue=r==="mouseover"||r==="pointerover",Ne=r==="mouseout"||r==="pointerout",ue&&o!==on&&(De=o.relatedTarget||o.fromElement)&&(ea(De)||De[Os]))break e;if((Ne||ue)&&(ue=de.window===de?de:(ue=de.ownerDocument)?ue.defaultView||ue.parentWindow:window,Ne?(De=o.relatedTarget||o.toElement,Ne=Z,De=De?ea(De):null,De!==null&&(qt=Yn(De),De!==qt||De.tag!==5&&De.tag!==6)&&(De=null)):(Ne=null,De=Z),Ne!==De)){if(Le=Da,we="onMouseLeave",Q="onMouseEnter",G="mouse",(r==="pointerout"||r==="pointerover")&&(Le=I,we="onPointerLeave",Q="onPointerEnter",G="pointer"),qt=Ne==null?ue:Wa(Ne),J=De==null?ue:Wa(De),ue=new Le(we,G+"leave",Ne,o,de),ue.target=qt,ue.relatedTarget=J,we=null,ea(de)===Z&&(Le=new Le(Q,G+"enter",De,o,de),Le.target=J,Le.relatedTarget=qt,we=Le),qt=we,Ne&&De)t:{for(Le=Ne,Q=De,G=0,J=Le;J;J=Ba(J))G++;for(J=0,we=Q;we;we=Ba(we))J++;for(;0<G-J;)Le=Ba(Le),G--;for(;0<J-G;)Q=Ba(Q),J--;for(;G--;){if(Le===Q||Q!==null&&Le===Q.alternate)break t;Le=Ba(Le),Q=Ba(Q)}Le=null}else Le=null;Ne!==null&&rm(fe,ue,Ne,Le,!1),De!==null&&qt!==null&&rm(fe,qt,De,Le,!0)}}e:{if(ue=Z?Wa(Z):window,Ne=ue.nodeName&&ue.nodeName.toLowerCase(),Ne==="select"||Ne==="input"&&ue.type==="file")var Ue=Uw;else if(Lp(ue))if(Mp)Ue=Ww;else{Ue=Bw;var Ge=zw}else(Ne=ue.nodeName)&&Ne.toLowerCase()==="input"&&(ue.type==="checkbox"||ue.type==="radio")&&(Ue=$w);if(Ue&&(Ue=Ue(r,Z))){Op(fe,Ue,o,de);break e}Ge&&Ge(r,ue,Z),r==="focusout"&&(Ge=ue._wrapperState)&&Ge.controlled&&ue.type==="number"&&Ut(ue,"number",ue.value)}switch(Ge=Z?Wa(Z):window,r){case"focusin":(Lp(Ge)||Ge.contentEditable==="true")&&(Ua=Ge,wd=Z,Wo=null);break;case"focusout":Wo=wd=Ua=null;break;case"mousedown":xd=!0;break;case"contextmenu":case"mouseup":case"dragend":xd=!1,Hp(fe,o,de);break;case"selectionchange":if(qw)break;case"keydown":case"keyup":Hp(fe,o,de)}var He;if(Zt)e:{switch(r){case"compositionstart":var Ye="onCompositionStart";break e;case"compositionend":Ye="onCompositionEnd";break e;case"compositionupdate":Ye="onCompositionUpdate";break e}Ye=void 0}else Fa?Dp(r,o)&&(Ye="onCompositionEnd"):r==="keydown"&&o.keyCode===229&&(Ye="onCompositionStart");Ye&&(Zi&&o.locale!=="ko"&&(Fa||Ye!=="onCompositionStart"?Ye==="onCompositionEnd"&&Fa&&(He=Oo()):(_r=de,Na="value"in _r?_r.value:_r.textContent,Fa=!0)),Ge=mc(Z,Ye),0<Ge.length&&(Ye=new Uo(Ye,r,null,o,de),fe.push({event:Ye,listeners:Ge}),He?Ye.data=He:(He=Vp(o),He!==null&&(Ye.data=He)))),(He=wr?Lw(r,o):Ow(r,o))&&(Z=mc(Z,"onBeforeInput"),0<Z.length&&(de=new Uo("onBeforeInput","beforeinput",null,o,de),fe.push({event:de,listeners:Z}),de.data=He))}tm(fe,i)})}function qo(r,i,o){return{instance:r,listener:i,currentTarget:o}}function mc(r,i){for(var o=i+"Capture",h=[];r!==null;){var p=r,y=p.stateNode;p.tag===5&&y!==null&&(p=y,y=Rt(r,o),y!=null&&h.unshift(qo(r,y,p)),y=Rt(r,i),y!=null&&h.push(qo(r,y,p))),r=r.return}return h}function Ba(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5);return r||null}function rm(r,i,o,h,p){for(var y=i._reactName,x=[];o!==null&&o!==h;){var j=o,z=j.alternate,Z=j.stateNode;if(z!==null&&z===h)break;j.tag===5&&Z!==null&&(j=Z,p?(z=Rt(o,y),z!=null&&x.unshift(qo(o,z,j))):p||(z=Rt(o,y),z!=null&&x.push(qo(o,z,j)))),o=o.return}x.length!==0&&r.push({event:i,listeners:x})}var Jw=/\r\n?/g,Xw=/\u0000|\uFFFD/g;function sm(r){return(typeof r=="string"?r:""+r).replace(Jw,`
`).replace(Xw,"")}function gc(r,i,o){if(i=sm(i),sm(r)!==i&&o)throw Error(t(425))}function yc(){}var bd=null,Pd=null;function Rd(r,i){return r==="textarea"||r==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Nd=typeof setTimeout=="function"?setTimeout:void 0,Zw=typeof clearTimeout=="function"?clearTimeout:void 0,im=typeof Promise=="function"?Promise:void 0,ex=typeof queueMicrotask=="function"?queueMicrotask:typeof im<"u"?function(r){return im.resolve(null).then(r).catch(tx)}:Nd;function tx(r){setTimeout(function(){throw r})}function Ad(r,i){var o=i,h=0;do{var p=o.nextSibling;if(r.removeChild(o),p&&p.nodeType===8)if(o=p.data,o==="/$"){if(h===0){r.removeChild(p),Gr(i);return}h--}else o!=="$"&&o!=="$?"&&o!=="$!"||h++;o=p}while(o);Gr(i)}function ui(r){for(;r!=null;r=r.nextSibling){var i=r.nodeType;if(i===1||i===3)break;if(i===8){if(i=r.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return r}function am(r){r=r.previousSibling;for(var i=0;r;){if(r.nodeType===8){var o=r.data;if(o==="$"||o==="$!"||o==="$?"){if(i===0)return r;i--}else o==="/$"&&i++}r=r.previousSibling}return null}var $a=Math.random().toString(36).slice(2),ys="__reactFiber$"+$a,Ko="__reactProps$"+$a,Os="__reactContainer$"+$a,kd="__reactEvents$"+$a,nx="__reactListeners$"+$a,rx="__reactHandles$"+$a;function ea(r){var i=r[ys];if(i)return i;for(var o=r.parentNode;o;){if(i=o[Os]||o[ys]){if(o=i.alternate,i.child!==null||o!==null&&o.child!==null)for(r=am(r);r!==null;){if(o=r[ys])return o;r=am(r)}return i}r=o,o=r.parentNode}return null}function Qo(r){return r=r[ys]||r[Os],!r||r.tag!==5&&r.tag!==6&&r.tag!==13&&r.tag!==3?null:r}function Wa(r){if(r.tag===5||r.tag===6)return r.stateNode;throw Error(t(33))}function vc(r){return r[Ko]||null}var jd=[],Ga=-1;function di(r){return{current:r}}function jt(r){0>Ga||(r.current=jd[Ga],jd[Ga]=null,Ga--)}function At(r,i){Ga++,jd[Ga]=r.current,r.current=i}var hi={},Fn=di(hi),cr=di(!1),ta=hi;function Ha(r,i){var o=r.type.contextTypes;if(!o)return hi;var h=r.stateNode;if(h&&h.__reactInternalMemoizedUnmaskedChildContext===i)return h.__reactInternalMemoizedMaskedChildContext;var p={},y;for(y in o)p[y]=i[y];return h&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=i,r.__reactInternalMemoizedMaskedChildContext=p),p}function ur(r){return r=r.childContextTypes,r!=null}function _c(){jt(cr),jt(Fn)}function om(r,i,o){if(Fn.current!==hi)throw Error(t(168));At(Fn,i),At(cr,o)}function lm(r,i,o){var h=r.stateNode;if(i=i.childContextTypes,typeof h.getChildContext!="function")return o;h=h.getChildContext();for(var p in h)if(!(p in i))throw Error(t(108,Ae(r)||"Unknown",p));return Te({},o,h)}function wc(r){return r=(r=r.stateNode)&&r.__reactInternalMemoizedMergedChildContext||hi,ta=Fn.current,At(Fn,r),At(cr,cr.current),!0}function cm(r,i,o){var h=r.stateNode;if(!h)throw Error(t(169));o?(r=lm(r,i,ta),h.__reactInternalMemoizedMergedChildContext=r,jt(cr),jt(Fn),At(Fn,r)):jt(cr),At(cr,o)}var Ms=null,xc=!1,Dd=!1;function um(r){Ms===null?Ms=[r]:Ms.push(r)}function sx(r){xc=!0,um(r)}function fi(){if(!Dd&&Ms!==null){Dd=!0;var r=0,i=rt;try{var o=Ms;for(rt=1;r<o.length;r++){var h=o[r];do h=h(!0);while(h!==null)}Ms=null,xc=!1}catch(p){throw Ms!==null&&(Ms=Ms.slice(r+1)),lt(O,fi),p}finally{rt=i,Dd=!1}}return null}var qa=[],Ka=0,Ec=null,Tc=0,Rr=[],Nr=0,na=null,Fs=1,Us="";function ra(r,i){qa[Ka++]=Tc,qa[Ka++]=Ec,Ec=r,Tc=i}function dm(r,i,o){Rr[Nr++]=Fs,Rr[Nr++]=Us,Rr[Nr++]=na,na=r;var h=Fs;r=Us;var p=32-F(h)-1;h&=~(1<<p),o+=1;var y=32-F(i)+p;if(30<y){var x=p-p%5;y=(h&(1<<x)-1).toString(32),h>>=x,p-=x,Fs=1<<32-F(i)+p|o<<p|h,Us=y+r}else Fs=1<<y|o<<p|h,Us=r}function Vd(r){r.return!==null&&(ra(r,1),dm(r,1,0))}function Ld(r){for(;r===Ec;)Ec=qa[--Ka],qa[Ka]=null,Tc=qa[--Ka],qa[Ka]=null;for(;r===na;)na=Rr[--Nr],Rr[Nr]=null,Us=Rr[--Nr],Rr[Nr]=null,Fs=Rr[--Nr],Rr[Nr]=null}var xr=null,Er=null,Ft=!1,Kr=null;function hm(r,i){var o=Dr(5,null,null,0);o.elementType="DELETED",o.stateNode=i,o.return=r,i=r.deletions,i===null?(r.deletions=[o],r.flags|=16):i.push(o)}function fm(r,i){switch(r.tag){case 5:var o=r.type;return i=i.nodeType!==1||o.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(r.stateNode=i,xr=r,Er=ui(i.firstChild),!0):!1;case 6:return i=r.pendingProps===""||i.nodeType!==3?null:i,i!==null?(r.stateNode=i,xr=r,Er=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(o=na!==null?{id:Fs,overflow:Us}:null,r.memoizedState={dehydrated:i,treeContext:o,retryLane:1073741824},o=Dr(18,null,null,0),o.stateNode=i,o.return=r,r.child=o,xr=r,Er=null,!0):!1;default:return!1}}function Od(r){return(r.mode&1)!==0&&(r.flags&128)===0}function Md(r){if(Ft){var i=Er;if(i){var o=i;if(!fm(r,i)){if(Od(r))throw Error(t(418));i=ui(o.nextSibling);var h=xr;i&&fm(r,i)?hm(h,o):(r.flags=r.flags&-4097|2,Ft=!1,xr=r)}}else{if(Od(r))throw Error(t(418));r.flags=r.flags&-4097|2,Ft=!1,xr=r}}}function pm(r){for(r=r.return;r!==null&&r.tag!==5&&r.tag!==3&&r.tag!==13;)r=r.return;xr=r}function Sc(r){if(r!==xr)return!1;if(!Ft)return pm(r),Ft=!0,!1;var i;if((i=r.tag!==3)&&!(i=r.tag!==5)&&(i=r.type,i=i!=="head"&&i!=="body"&&!Rd(r.type,r.memoizedProps)),i&&(i=Er)){if(Od(r))throw mm(),Error(t(418));for(;i;)hm(r,i),i=ui(i.nextSibling)}if(pm(r),r.tag===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(t(317));e:{for(r=r.nextSibling,i=0;r;){if(r.nodeType===8){var o=r.data;if(o==="/$"){if(i===0){Er=ui(r.nextSibling);break e}i--}else o!=="$"&&o!=="$!"&&o!=="$?"||i++}r=r.nextSibling}Er=null}}else Er=xr?ui(r.stateNode.nextSibling):null;return!0}function mm(){for(var r=Er;r;)r=ui(r.nextSibling)}function Qa(){Er=xr=null,Ft=!1}function Fd(r){Kr===null?Kr=[r]:Kr.push(r)}var ix=ye.ReactCurrentBatchConfig;function Yo(r,i,o){if(r=o.ref,r!==null&&typeof r!="function"&&typeof r!="object"){if(o._owner){if(o=o._owner,o){if(o.tag!==1)throw Error(t(309));var h=o.stateNode}if(!h)throw Error(t(147,r));var p=h,y=""+r;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===y?i.ref:(i=function(x){var j=p.refs;x===null?delete j[y]:j[y]=x},i._stringRef=y,i)}if(typeof r!="string")throw Error(t(284));if(!o._owner)throw Error(t(290,r))}return r}function Ic(r,i){throw r=Object.prototype.toString.call(i),Error(t(31,r==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":r))}function gm(r){var i=r._init;return i(r._payload)}function ym(r){function i(Q,G){if(r){var J=Q.deletions;J===null?(Q.deletions=[G],Q.flags|=16):J.push(G)}}function o(Q,G){if(!r)return null;for(;G!==null;)i(Q,G),G=G.sibling;return null}function h(Q,G){for(Q=new Map;G!==null;)G.key!==null?Q.set(G.key,G):Q.set(G.index,G),G=G.sibling;return Q}function p(Q,G){return Q=xi(Q,G),Q.index=0,Q.sibling=null,Q}function y(Q,G,J){return Q.index=J,r?(J=Q.alternate,J!==null?(J=J.index,J<G?(Q.flags|=2,G):J):(Q.flags|=2,G)):(Q.flags|=1048576,G)}function x(Q){return r&&Q.alternate===null&&(Q.flags|=2),Q}function j(Q,G,J,we){return G===null||G.tag!==6?(G=Nh(J,Q.mode,we),G.return=Q,G):(G=p(G,J),G.return=Q,G)}function z(Q,G,J,we){var Ue=J.type;return Ue===k?de(Q,G,J.props.children,we,J.key):G!==null&&(G.elementType===Ue||typeof Ue=="object"&&Ue!==null&&Ue.$$typeof===ot&&gm(Ue)===G.type)?(we=p(G,J.props),we.ref=Yo(Q,G,J),we.return=Q,we):(we=Qc(J.type,J.key,J.props,null,Q.mode,we),we.ref=Yo(Q,G,J),we.return=Q,we)}function Z(Q,G,J,we){return G===null||G.tag!==4||G.stateNode.containerInfo!==J.containerInfo||G.stateNode.implementation!==J.implementation?(G=Ah(J,Q.mode,we),G.return=Q,G):(G=p(G,J.children||[]),G.return=Q,G)}function de(Q,G,J,we,Ue){return G===null||G.tag!==7?(G=da(J,Q.mode,we,Ue),G.return=Q,G):(G=p(G,J),G.return=Q,G)}function fe(Q,G,J){if(typeof G=="string"&&G!==""||typeof G=="number")return G=Nh(""+G,Q.mode,J),G.return=Q,G;if(typeof G=="object"&&G!==null){switch(G.$$typeof){case ie:return J=Qc(G.type,G.key,G.props,null,Q.mode,J),J.ref=Yo(Q,null,G),J.return=Q,J;case Ee:return G=Ah(G,Q.mode,J),G.return=Q,G;case ot:var we=G._init;return fe(Q,we(G._payload),J)}if(It(G)||be(G))return G=da(G,Q.mode,J,null),G.return=Q,G;Ic(Q,G)}return null}function ue(Q,G,J,we){var Ue=G!==null?G.key:null;if(typeof J=="string"&&J!==""||typeof J=="number")return Ue!==null?null:j(Q,G,""+J,we);if(typeof J=="object"&&J!==null){switch(J.$$typeof){case ie:return J.key===Ue?z(Q,G,J,we):null;case Ee:return J.key===Ue?Z(Q,G,J,we):null;case ot:return Ue=J._init,ue(Q,G,Ue(J._payload),we)}if(It(J)||be(J))return Ue!==null?null:de(Q,G,J,we,null);Ic(Q,J)}return null}function Ne(Q,G,J,we,Ue){if(typeof we=="string"&&we!==""||typeof we=="number")return Q=Q.get(J)||null,j(G,Q,""+we,Ue);if(typeof we=="object"&&we!==null){switch(we.$$typeof){case ie:return Q=Q.get(we.key===null?J:we.key)||null,z(G,Q,we,Ue);case Ee:return Q=Q.get(we.key===null?J:we.key)||null,Z(G,Q,we,Ue);case ot:var Ge=we._init;return Ne(Q,G,J,Ge(we._payload),Ue)}if(It(we)||be(we))return Q=Q.get(J)||null,de(G,Q,we,Ue,null);Ic(G,we)}return null}function De(Q,G,J,we){for(var Ue=null,Ge=null,He=G,Ye=G=0,Tn=null;He!==null&&Ye<J.length;Ye++){He.index>Ye?(Tn=He,He=null):Tn=He.sibling;var _t=ue(Q,He,J[Ye],we);if(_t===null){He===null&&(He=Tn);break}r&&He&&_t.alternate===null&&i(Q,He),G=y(_t,G,Ye),Ge===null?Ue=_t:Ge.sibling=_t,Ge=_t,He=Tn}if(Ye===J.length)return o(Q,He),Ft&&ra(Q,Ye),Ue;if(He===null){for(;Ye<J.length;Ye++)He=fe(Q,J[Ye],we),He!==null&&(G=y(He,G,Ye),Ge===null?Ue=He:Ge.sibling=He,Ge=He);return Ft&&ra(Q,Ye),Ue}for(He=h(Q,He);Ye<J.length;Ye++)Tn=Ne(He,Q,Ye,J[Ye],we),Tn!==null&&(r&&Tn.alternate!==null&&He.delete(Tn.key===null?Ye:Tn.key),G=y(Tn,G,Ye),Ge===null?Ue=Tn:Ge.sibling=Tn,Ge=Tn);return r&&He.forEach(function(Ei){return i(Q,Ei)}),Ft&&ra(Q,Ye),Ue}function Le(Q,G,J,we){var Ue=be(J);if(typeof Ue!="function")throw Error(t(150));if(J=Ue.call(J),J==null)throw Error(t(151));for(var Ge=Ue=null,He=G,Ye=G=0,Tn=null,_t=J.next();He!==null&&!_t.done;Ye++,_t=J.next()){He.index>Ye?(Tn=He,He=null):Tn=He.sibling;var Ei=ue(Q,He,_t.value,we);if(Ei===null){He===null&&(He=Tn);break}r&&He&&Ei.alternate===null&&i(Q,He),G=y(Ei,G,Ye),Ge===null?Ue=Ei:Ge.sibling=Ei,Ge=Ei,He=Tn}if(_t.done)return o(Q,He),Ft&&ra(Q,Ye),Ue;if(He===null){for(;!_t.done;Ye++,_t=J.next())_t=fe(Q,_t.value,we),_t!==null&&(G=y(_t,G,Ye),Ge===null?Ue=_t:Ge.sibling=_t,Ge=_t);return Ft&&ra(Q,Ye),Ue}for(He=h(Q,He);!_t.done;Ye++,_t=J.next())_t=Ne(He,Q,Ye,_t.value,we),_t!==null&&(r&&_t.alternate!==null&&He.delete(_t.key===null?Ye:_t.key),G=y(_t,G,Ye),Ge===null?Ue=_t:Ge.sibling=_t,Ge=_t);return r&&He.forEach(function(Mx){return i(Q,Mx)}),Ft&&ra(Q,Ye),Ue}function qt(Q,G,J,we){if(typeof J=="object"&&J!==null&&J.type===k&&J.key===null&&(J=J.props.children),typeof J=="object"&&J!==null){switch(J.$$typeof){case ie:e:{for(var Ue=J.key,Ge=G;Ge!==null;){if(Ge.key===Ue){if(Ue=J.type,Ue===k){if(Ge.tag===7){o(Q,Ge.sibling),G=p(Ge,J.props.children),G.return=Q,Q=G;break e}}else if(Ge.elementType===Ue||typeof Ue=="object"&&Ue!==null&&Ue.$$typeof===ot&&gm(Ue)===Ge.type){o(Q,Ge.sibling),G=p(Ge,J.props),G.ref=Yo(Q,Ge,J),G.return=Q,Q=G;break e}o(Q,Ge);break}else i(Q,Ge);Ge=Ge.sibling}J.type===k?(G=da(J.props.children,Q.mode,we,J.key),G.return=Q,Q=G):(we=Qc(J.type,J.key,J.props,null,Q.mode,we),we.ref=Yo(Q,G,J),we.return=Q,Q=we)}return x(Q);case Ee:e:{for(Ge=J.key;G!==null;){if(G.key===Ge)if(G.tag===4&&G.stateNode.containerInfo===J.containerInfo&&G.stateNode.implementation===J.implementation){o(Q,G.sibling),G=p(G,J.children||[]),G.return=Q,Q=G;break e}else{o(Q,G);break}else i(Q,G);G=G.sibling}G=Ah(J,Q.mode,we),G.return=Q,Q=G}return x(Q);case ot:return Ge=J._init,qt(Q,G,Ge(J._payload),we)}if(It(J))return De(Q,G,J,we);if(be(J))return Le(Q,G,J,we);Ic(Q,J)}return typeof J=="string"&&J!==""||typeof J=="number"?(J=""+J,G!==null&&G.tag===6?(o(Q,G.sibling),G=p(G,J),G.return=Q,Q=G):(o(Q,G),G=Nh(J,Q.mode,we),G.return=Q,Q=G),x(Q)):o(Q,G)}return qt}var Ya=ym(!0),vm=ym(!1),Cc=di(null),bc=null,Ja=null,Ud=null;function zd(){Ud=Ja=bc=null}function Bd(r){var i=Cc.current;jt(Cc),r._currentValue=i}function $d(r,i,o){for(;r!==null;){var h=r.alternate;if((r.childLanes&i)!==i?(r.childLanes|=i,h!==null&&(h.childLanes|=i)):h!==null&&(h.childLanes&i)!==i&&(h.childLanes|=i),r===o)break;r=r.return}}function Xa(r,i){bc=r,Ud=Ja=null,r=r.dependencies,r!==null&&r.firstContext!==null&&((r.lanes&i)!==0&&(dr=!0),r.firstContext=null)}function Ar(r){var i=r._currentValue;if(Ud!==r)if(r={context:r,memoizedValue:i,next:null},Ja===null){if(bc===null)throw Error(t(308));Ja=r,bc.dependencies={lanes:0,firstContext:r}}else Ja=Ja.next=r;return i}var sa=null;function Wd(r){sa===null?sa=[r]:sa.push(r)}function _m(r,i,o,h){var p=i.interleaved;return p===null?(o.next=o,Wd(i)):(o.next=p.next,p.next=o),i.interleaved=o,zs(r,h)}function zs(r,i){r.lanes|=i;var o=r.alternate;for(o!==null&&(o.lanes|=i),o=r,r=r.return;r!==null;)r.childLanes|=i,o=r.alternate,o!==null&&(o.childLanes|=i),o=r,r=r.return;return o.tag===3?o.stateNode:null}var pi=!1;function Gd(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function wm(r,i){r=r.updateQueue,i.updateQueue===r&&(i.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,effects:r.effects})}function Bs(r,i){return{eventTime:r,lane:i,tag:0,payload:null,callback:null,next:null}}function mi(r,i,o){var h=r.updateQueue;if(h===null)return null;if(h=h.shared,(gt&2)!==0){var p=h.pending;return p===null?i.next=i:(i.next=p.next,p.next=i),h.pending=i,zs(r,o)}return p=h.interleaved,p===null?(i.next=i,Wd(h)):(i.next=p.next,p.next=i),h.interleaved=i,zs(r,o)}function Pc(r,i,o){if(i=i.updateQueue,i!==null&&(i=i.shared,(o&4194240)!==0)){var h=i.lanes;h&=r.pendingLanes,o|=h,i.lanes=o,Mn(r,o)}}function xm(r,i){var o=r.updateQueue,h=r.alternate;if(h!==null&&(h=h.updateQueue,o===h)){var p=null,y=null;if(o=o.firstBaseUpdate,o!==null){do{var x={eventTime:o.eventTime,lane:o.lane,tag:o.tag,payload:o.payload,callback:o.callback,next:null};y===null?p=y=x:y=y.next=x,o=o.next}while(o!==null);y===null?p=y=i:y=y.next=i}else p=y=i;o={baseState:h.baseState,firstBaseUpdate:p,lastBaseUpdate:y,shared:h.shared,effects:h.effects},r.updateQueue=o;return}r=o.lastBaseUpdate,r===null?o.firstBaseUpdate=i:r.next=i,o.lastBaseUpdate=i}function Rc(r,i,o,h){var p=r.updateQueue;pi=!1;var y=p.firstBaseUpdate,x=p.lastBaseUpdate,j=p.shared.pending;if(j!==null){p.shared.pending=null;var z=j,Z=z.next;z.next=null,x===null?y=Z:x.next=Z,x=z;var de=r.alternate;de!==null&&(de=de.updateQueue,j=de.lastBaseUpdate,j!==x&&(j===null?de.firstBaseUpdate=Z:j.next=Z,de.lastBaseUpdate=z))}if(y!==null){var fe=p.baseState;x=0,de=Z=z=null,j=y;do{var ue=j.lane,Ne=j.eventTime;if((h&ue)===ue){de!==null&&(de=de.next={eventTime:Ne,lane:0,tag:j.tag,payload:j.payload,callback:j.callback,next:null});e:{var De=r,Le=j;switch(ue=i,Ne=o,Le.tag){case 1:if(De=Le.payload,typeof De=="function"){fe=De.call(Ne,fe,ue);break e}fe=De;break e;case 3:De.flags=De.flags&-65537|128;case 0:if(De=Le.payload,ue=typeof De=="function"?De.call(Ne,fe,ue):De,ue==null)break e;fe=Te({},fe,ue);break e;case 2:pi=!0}}j.callback!==null&&j.lane!==0&&(r.flags|=64,ue=p.effects,ue===null?p.effects=[j]:ue.push(j))}else Ne={eventTime:Ne,lane:ue,tag:j.tag,payload:j.payload,callback:j.callback,next:null},de===null?(Z=de=Ne,z=fe):de=de.next=Ne,x|=ue;if(j=j.next,j===null){if(j=p.shared.pending,j===null)break;ue=j,j=ue.next,ue.next=null,p.lastBaseUpdate=ue,p.shared.pending=null}}while(!0);if(de===null&&(z=fe),p.baseState=z,p.firstBaseUpdate=Z,p.lastBaseUpdate=de,i=p.shared.interleaved,i!==null){p=i;do x|=p.lane,p=p.next;while(p!==i)}else y===null&&(p.shared.lanes=0);oa|=x,r.lanes=x,r.memoizedState=fe}}function Em(r,i,o){if(r=i.effects,i.effects=null,r!==null)for(i=0;i<r.length;i++){var h=r[i],p=h.callback;if(p!==null){if(h.callback=null,h=o,typeof p!="function")throw Error(t(191,p));p.call(h)}}}var Jo={},vs=di(Jo),Xo=di(Jo),Zo=di(Jo);function ia(r){if(r===Jo)throw Error(t(174));return r}function Hd(r,i){switch(At(Zo,i),At(Xo,r),At(vs,Jo),r=i.nodeType,r){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:bt(null,"");break;default:r=r===8?i.parentNode:i,i=r.namespaceURI||null,r=r.tagName,i=bt(i,r)}jt(vs),At(vs,i)}function Za(){jt(vs),jt(Xo),jt(Zo)}function Tm(r){ia(Zo.current);var i=ia(vs.current),o=bt(i,r.type);i!==o&&(At(Xo,r),At(vs,o))}function qd(r){Xo.current===r&&(jt(vs),jt(Xo))}var Bt=di(0);function Nc(r){for(var i=r;i!==null;){if(i.tag===13){var o=i.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||o.data==="$?"||o.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===r)break;for(;i.sibling===null;){if(i.return===null||i.return===r)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var Kd=[];function Qd(){for(var r=0;r<Kd.length;r++)Kd[r]._workInProgressVersionPrimary=null;Kd.length=0}var Ac=ye.ReactCurrentDispatcher,Yd=ye.ReactCurrentBatchConfig,aa=0,$t=null,dn=null,xn=null,kc=!1,el=!1,tl=0,ax=0;function Un(){throw Error(t(321))}function Jd(r,i){if(i===null)return!1;for(var o=0;o<i.length&&o<r.length;o++)if(!qr(r[o],i[o]))return!1;return!0}function Xd(r,i,o,h,p,y){if(aa=y,$t=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,Ac.current=r===null||r.memoizedState===null?ux:dx,r=o(h,p),el){y=0;do{if(el=!1,tl=0,25<=y)throw Error(t(301));y+=1,xn=dn=null,i.updateQueue=null,Ac.current=hx,r=o(h,p)}while(el)}if(Ac.current=Vc,i=dn!==null&&dn.next!==null,aa=0,xn=dn=$t=null,kc=!1,i)throw Error(t(300));return r}function Zd(){var r=tl!==0;return tl=0,r}function _s(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xn===null?$t.memoizedState=xn=r:xn=xn.next=r,xn}function kr(){if(dn===null){var r=$t.alternate;r=r!==null?r.memoizedState:null}else r=dn.next;var i=xn===null?$t.memoizedState:xn.next;if(i!==null)xn=i,dn=r;else{if(r===null)throw Error(t(310));dn=r,r={memoizedState:dn.memoizedState,baseState:dn.baseState,baseQueue:dn.baseQueue,queue:dn.queue,next:null},xn===null?$t.memoizedState=xn=r:xn=xn.next=r}return xn}function nl(r,i){return typeof i=="function"?i(r):i}function eh(r){var i=kr(),o=i.queue;if(o===null)throw Error(t(311));o.lastRenderedReducer=r;var h=dn,p=h.baseQueue,y=o.pending;if(y!==null){if(p!==null){var x=p.next;p.next=y.next,y.next=x}h.baseQueue=p=y,o.pending=null}if(p!==null){y=p.next,h=h.baseState;var j=x=null,z=null,Z=y;do{var de=Z.lane;if((aa&de)===de)z!==null&&(z=z.next={lane:0,action:Z.action,hasEagerState:Z.hasEagerState,eagerState:Z.eagerState,next:null}),h=Z.hasEagerState?Z.eagerState:r(h,Z.action);else{var fe={lane:de,action:Z.action,hasEagerState:Z.hasEagerState,eagerState:Z.eagerState,next:null};z===null?(j=z=fe,x=h):z=z.next=fe,$t.lanes|=de,oa|=de}Z=Z.next}while(Z!==null&&Z!==y);z===null?x=h:z.next=j,qr(h,i.memoizedState)||(dr=!0),i.memoizedState=h,i.baseState=x,i.baseQueue=z,o.lastRenderedState=h}if(r=o.interleaved,r!==null){p=r;do y=p.lane,$t.lanes|=y,oa|=y,p=p.next;while(p!==r)}else p===null&&(o.lanes=0);return[i.memoizedState,o.dispatch]}function th(r){var i=kr(),o=i.queue;if(o===null)throw Error(t(311));o.lastRenderedReducer=r;var h=o.dispatch,p=o.pending,y=i.memoizedState;if(p!==null){o.pending=null;var x=p=p.next;do y=r(y,x.action),x=x.next;while(x!==p);qr(y,i.memoizedState)||(dr=!0),i.memoizedState=y,i.baseQueue===null&&(i.baseState=y),o.lastRenderedState=y}return[y,h]}function Sm(){}function Im(r,i){var o=$t,h=kr(),p=i(),y=!qr(h.memoizedState,p);if(y&&(h.memoizedState=p,dr=!0),h=h.queue,nh(Pm.bind(null,o,h,r),[r]),h.getSnapshot!==i||y||xn!==null&&xn.memoizedState.tag&1){if(o.flags|=2048,rl(9,bm.bind(null,o,h,p,i),void 0,null),En===null)throw Error(t(349));(aa&30)!==0||Cm(o,i,p)}return p}function Cm(r,i,o){r.flags|=16384,r={getSnapshot:i,value:o},i=$t.updateQueue,i===null?(i={lastEffect:null,stores:null},$t.updateQueue=i,i.stores=[r]):(o=i.stores,o===null?i.stores=[r]:o.push(r))}function bm(r,i,o,h){i.value=o,i.getSnapshot=h,Rm(i)&&Nm(r)}function Pm(r,i,o){return o(function(){Rm(i)&&Nm(r)})}function Rm(r){var i=r.getSnapshot;r=r.value;try{var o=i();return!qr(r,o)}catch{return!0}}function Nm(r){var i=zs(r,1);i!==null&&Xr(i,r,1,-1)}function Am(r){var i=_s();return typeof r=="function"&&(r=r()),i.memoizedState=i.baseState=r,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:nl,lastRenderedState:r},i.queue=r,r=r.dispatch=cx.bind(null,$t,r),[i.memoizedState,r]}function rl(r,i,o,h){return r={tag:r,create:i,destroy:o,deps:h,next:null},i=$t.updateQueue,i===null?(i={lastEffect:null,stores:null},$t.updateQueue=i,i.lastEffect=r.next=r):(o=i.lastEffect,o===null?i.lastEffect=r.next=r:(h=o.next,o.next=r,r.next=h,i.lastEffect=r)),r}function km(){return kr().memoizedState}function jc(r,i,o,h){var p=_s();$t.flags|=r,p.memoizedState=rl(1|i,o,void 0,h===void 0?null:h)}function Dc(r,i,o,h){var p=kr();h=h===void 0?null:h;var y=void 0;if(dn!==null){var x=dn.memoizedState;if(y=x.destroy,h!==null&&Jd(h,x.deps)){p.memoizedState=rl(i,o,y,h);return}}$t.flags|=r,p.memoizedState=rl(1|i,o,y,h)}function jm(r,i){return jc(8390656,8,r,i)}function nh(r,i){return Dc(2048,8,r,i)}function Dm(r,i){return Dc(4,2,r,i)}function Vm(r,i){return Dc(4,4,r,i)}function Lm(r,i){if(typeof i=="function")return r=r(),i(r),function(){i(null)};if(i!=null)return r=r(),i.current=r,function(){i.current=null}}function Om(r,i,o){return o=o!=null?o.concat([r]):null,Dc(4,4,Lm.bind(null,i,r),o)}function rh(){}function Mm(r,i){var o=kr();i=i===void 0?null:i;var h=o.memoizedState;return h!==null&&i!==null&&Jd(i,h[1])?h[0]:(o.memoizedState=[r,i],r)}function Fm(r,i){var o=kr();i=i===void 0?null:i;var h=o.memoizedState;return h!==null&&i!==null&&Jd(i,h[1])?h[0]:(r=r(),o.memoizedState=[r,i],r)}function Um(r,i,o){return(aa&21)===0?(r.baseState&&(r.baseState=!1,dr=!0),r.memoizedState=o):(qr(o,i)||(o=zt(),$t.lanes|=o,oa|=o,r.baseState=!0),i)}function ox(r,i){var o=rt;rt=o!==0&&4>o?o:4,r(!0);var h=Yd.transition;Yd.transition={};try{r(!1),i()}finally{rt=o,Yd.transition=h}}function zm(){return kr().memoizedState}function lx(r,i,o){var h=_i(r);if(o={lane:h,action:o,hasEagerState:!1,eagerState:null,next:null},Bm(r))$m(i,o);else if(o=_m(r,i,o,h),o!==null){var p=nr();Xr(o,r,h,p),Wm(o,i,h)}}function cx(r,i,o){var h=_i(r),p={lane:h,action:o,hasEagerState:!1,eagerState:null,next:null};if(Bm(r))$m(i,p);else{var y=r.alternate;if(r.lanes===0&&(y===null||y.lanes===0)&&(y=i.lastRenderedReducer,y!==null))try{var x=i.lastRenderedState,j=y(x,o);if(p.hasEagerState=!0,p.eagerState=j,qr(j,x)){var z=i.interleaved;z===null?(p.next=p,Wd(i)):(p.next=z.next,z.next=p),i.interleaved=p;return}}catch{}finally{}o=_m(r,i,p,h),o!==null&&(p=nr(),Xr(o,r,h,p),Wm(o,i,h))}}function Bm(r){var i=r.alternate;return r===$t||i!==null&&i===$t}function $m(r,i){el=kc=!0;var o=r.pending;o===null?i.next=i:(i.next=o.next,o.next=i),r.pending=i}function Wm(r,i,o){if((o&4194240)!==0){var h=i.lanes;h&=r.pendingLanes,o|=h,i.lanes=o,Mn(r,o)}}var Vc={readContext:Ar,useCallback:Un,useContext:Un,useEffect:Un,useImperativeHandle:Un,useInsertionEffect:Un,useLayoutEffect:Un,useMemo:Un,useReducer:Un,useRef:Un,useState:Un,useDebugValue:Un,useDeferredValue:Un,useTransition:Un,useMutableSource:Un,useSyncExternalStore:Un,useId:Un,unstable_isNewReconciler:!1},ux={readContext:Ar,useCallback:function(r,i){return _s().memoizedState=[r,i===void 0?null:i],r},useContext:Ar,useEffect:jm,useImperativeHandle:function(r,i,o){return o=o!=null?o.concat([r]):null,jc(4194308,4,Lm.bind(null,i,r),o)},useLayoutEffect:function(r,i){return jc(4194308,4,r,i)},useInsertionEffect:function(r,i){return jc(4,2,r,i)},useMemo:function(r,i){var o=_s();return i=i===void 0?null:i,r=r(),o.memoizedState=[r,i],r},useReducer:function(r,i,o){var h=_s();return i=o!==void 0?o(i):i,h.memoizedState=h.baseState=i,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:i},h.queue=r,r=r.dispatch=lx.bind(null,$t,r),[h.memoizedState,r]},useRef:function(r){var i=_s();return r={current:r},i.memoizedState=r},useState:Am,useDebugValue:rh,useDeferredValue:function(r){return _s().memoizedState=r},useTransition:function(){var r=Am(!1),i=r[0];return r=ox.bind(null,r[1]),_s().memoizedState=r,[i,r]},useMutableSource:function(){},useSyncExternalStore:function(r,i,o){var h=$t,p=_s();if(Ft){if(o===void 0)throw Error(t(407));o=o()}else{if(o=i(),En===null)throw Error(t(349));(aa&30)!==0||Cm(h,i,o)}p.memoizedState=o;var y={value:o,getSnapshot:i};return p.queue=y,jm(Pm.bind(null,h,y,r),[r]),h.flags|=2048,rl(9,bm.bind(null,h,y,o,i),void 0,null),o},useId:function(){var r=_s(),i=En.identifierPrefix;if(Ft){var o=Us,h=Fs;o=(h&~(1<<32-F(h)-1)).toString(32)+o,i=":"+i+"R"+o,o=tl++,0<o&&(i+="H"+o.toString(32)),i+=":"}else o=ax++,i=":"+i+"r"+o.toString(32)+":";return r.memoizedState=i},unstable_isNewReconciler:!1},dx={readContext:Ar,useCallback:Mm,useContext:Ar,useEffect:nh,useImperativeHandle:Om,useInsertionEffect:Dm,useLayoutEffect:Vm,useMemo:Fm,useReducer:eh,useRef:km,useState:function(){return eh(nl)},useDebugValue:rh,useDeferredValue:function(r){var i=kr();return Um(i,dn.memoizedState,r)},useTransition:function(){var r=eh(nl)[0],i=kr().memoizedState;return[r,i]},useMutableSource:Sm,useSyncExternalStore:Im,useId:zm,unstable_isNewReconciler:!1},hx={readContext:Ar,useCallback:Mm,useContext:Ar,useEffect:nh,useImperativeHandle:Om,useInsertionEffect:Dm,useLayoutEffect:Vm,useMemo:Fm,useReducer:th,useRef:km,useState:function(){return th(nl)},useDebugValue:rh,useDeferredValue:function(r){var i=kr();return dn===null?i.memoizedState=r:Um(i,dn.memoizedState,r)},useTransition:function(){var r=th(nl)[0],i=kr().memoizedState;return[r,i]},useMutableSource:Sm,useSyncExternalStore:Im,useId:zm,unstable_isNewReconciler:!1};function Qr(r,i){if(r&&r.defaultProps){i=Te({},i),r=r.defaultProps;for(var o in r)i[o]===void 0&&(i[o]=r[o]);return i}return i}function sh(r,i,o,h){i=r.memoizedState,o=o(h,i),o=o==null?i:Te({},i,o),r.memoizedState=o,r.lanes===0&&(r.updateQueue.baseState=o)}var Lc={isMounted:function(r){return(r=r._reactInternals)?Yn(r)===r:!1},enqueueSetState:function(r,i,o){r=r._reactInternals;var h=nr(),p=_i(r),y=Bs(h,p);y.payload=i,o!=null&&(y.callback=o),i=mi(r,y,p),i!==null&&(Xr(i,r,p,h),Pc(i,r,p))},enqueueReplaceState:function(r,i,o){r=r._reactInternals;var h=nr(),p=_i(r),y=Bs(h,p);y.tag=1,y.payload=i,o!=null&&(y.callback=o),i=mi(r,y,p),i!==null&&(Xr(i,r,p,h),Pc(i,r,p))},enqueueForceUpdate:function(r,i){r=r._reactInternals;var o=nr(),h=_i(r),p=Bs(o,h);p.tag=2,i!=null&&(p.callback=i),i=mi(r,p,h),i!==null&&(Xr(i,r,h,o),Pc(i,r,h))}};function Gm(r,i,o,h,p,y,x){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(h,y,x):i.prototype&&i.prototype.isPureReactComponent?!$o(o,h)||!$o(p,y):!0}function Hm(r,i,o){var h=!1,p=hi,y=i.contextType;return typeof y=="object"&&y!==null?y=Ar(y):(p=ur(i)?ta:Fn.current,h=i.contextTypes,y=(h=h!=null)?Ha(r,p):hi),i=new i(o,y),r.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=Lc,r.stateNode=i,i._reactInternals=r,h&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=p,r.__reactInternalMemoizedMaskedChildContext=y),i}function qm(r,i,o,h){r=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(o,h),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(o,h),i.state!==r&&Lc.enqueueReplaceState(i,i.state,null)}function ih(r,i,o,h){var p=r.stateNode;p.props=o,p.state=r.memoizedState,p.refs={},Gd(r);var y=i.contextType;typeof y=="object"&&y!==null?p.context=Ar(y):(y=ur(i)?ta:Fn.current,p.context=Ha(r,y)),p.state=r.memoizedState,y=i.getDerivedStateFromProps,typeof y=="function"&&(sh(r,i,y,o),p.state=r.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(i=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),i!==p.state&&Lc.enqueueReplaceState(p,p.state,null),Rc(r,o,p,h),p.state=r.memoizedState),typeof p.componentDidMount=="function"&&(r.flags|=4194308)}function eo(r,i){try{var o="",h=i;do o+=_e(h),h=h.return;while(h);var p=o}catch(y){p=`
Error generating stack: `+y.message+`
`+y.stack}return{value:r,source:i,stack:p,digest:null}}function ah(r,i,o){return{value:r,source:null,stack:o??null,digest:i??null}}function oh(r,i){try{console.error(i.value)}catch(o){setTimeout(function(){throw o})}}var fx=typeof WeakMap=="function"?WeakMap:Map;function Km(r,i,o){o=Bs(-1,o),o.tag=3,o.payload={element:null};var h=i.value;return o.callback=function(){$c||($c=!0,Eh=h),oh(r,i)},o}function Qm(r,i,o){o=Bs(-1,o),o.tag=3;var h=r.type.getDerivedStateFromError;if(typeof h=="function"){var p=i.value;o.payload=function(){return h(p)},o.callback=function(){oh(r,i)}}var y=r.stateNode;return y!==null&&typeof y.componentDidCatch=="function"&&(o.callback=function(){oh(r,i),typeof h!="function"&&(yi===null?yi=new Set([this]):yi.add(this));var x=i.stack;this.componentDidCatch(i.value,{componentStack:x!==null?x:""})}),o}function Ym(r,i,o){var h=r.pingCache;if(h===null){h=r.pingCache=new fx;var p=new Set;h.set(i,p)}else p=h.get(i),p===void 0&&(p=new Set,h.set(i,p));p.has(o)||(p.add(o),r=bx.bind(null,r,i,o),i.then(r,r))}function Jm(r){do{var i;if((i=r.tag===13)&&(i=r.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return r;r=r.return}while(r!==null);return null}function Xm(r,i,o,h,p){return(r.mode&1)===0?(r===i?r.flags|=65536:(r.flags|=128,o.flags|=131072,o.flags&=-52805,o.tag===1&&(o.alternate===null?o.tag=17:(i=Bs(-1,1),i.tag=2,mi(o,i,1))),o.lanes|=1),r):(r.flags|=65536,r.lanes=p,r)}var px=ye.ReactCurrentOwner,dr=!1;function tr(r,i,o,h){i.child=r===null?vm(i,null,o,h):Ya(i,r.child,o,h)}function Zm(r,i,o,h,p){o=o.render;var y=i.ref;return Xa(i,p),h=Xd(r,i,o,h,y,p),o=Zd(),r!==null&&!dr?(i.updateQueue=r.updateQueue,i.flags&=-2053,r.lanes&=~p,$s(r,i,p)):(Ft&&o&&Vd(i),i.flags|=1,tr(r,i,h,p),i.child)}function eg(r,i,o,h,p){if(r===null){var y=o.type;return typeof y=="function"&&!Rh(y)&&y.defaultProps===void 0&&o.compare===null&&o.defaultProps===void 0?(i.tag=15,i.type=y,tg(r,i,y,h,p)):(r=Qc(o.type,null,h,i,i.mode,p),r.ref=i.ref,r.return=i,i.child=r)}if(y=r.child,(r.lanes&p)===0){var x=y.memoizedProps;if(o=o.compare,o=o!==null?o:$o,o(x,h)&&r.ref===i.ref)return $s(r,i,p)}return i.flags|=1,r=xi(y,h),r.ref=i.ref,r.return=i,i.child=r}function tg(r,i,o,h,p){if(r!==null){var y=r.memoizedProps;if($o(y,h)&&r.ref===i.ref)if(dr=!1,i.pendingProps=h=y,(r.lanes&p)!==0)(r.flags&131072)!==0&&(dr=!0);else return i.lanes=r.lanes,$s(r,i,p)}return lh(r,i,o,h,p)}function ng(r,i,o){var h=i.pendingProps,p=h.children,y=r!==null?r.memoizedState:null;if(h.mode==="hidden")if((i.mode&1)===0)i.memoizedState={baseLanes:0,cachePool:null,transitions:null},At(no,Tr),Tr|=o;else{if((o&1073741824)===0)return r=y!==null?y.baseLanes|o:o,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:r,cachePool:null,transitions:null},i.updateQueue=null,At(no,Tr),Tr|=r,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},h=y!==null?y.baseLanes:o,At(no,Tr),Tr|=h}else y!==null?(h=y.baseLanes|o,i.memoizedState=null):h=o,At(no,Tr),Tr|=h;return tr(r,i,p,o),i.child}function rg(r,i){var o=i.ref;(r===null&&o!==null||r!==null&&r.ref!==o)&&(i.flags|=512,i.flags|=2097152)}function lh(r,i,o,h,p){var y=ur(o)?ta:Fn.current;return y=Ha(i,y),Xa(i,p),o=Xd(r,i,o,h,y,p),h=Zd(),r!==null&&!dr?(i.updateQueue=r.updateQueue,i.flags&=-2053,r.lanes&=~p,$s(r,i,p)):(Ft&&h&&Vd(i),i.flags|=1,tr(r,i,o,p),i.child)}function sg(r,i,o,h,p){if(ur(o)){var y=!0;wc(i)}else y=!1;if(Xa(i,p),i.stateNode===null)Mc(r,i),Hm(i,o,h),ih(i,o,h,p),h=!0;else if(r===null){var x=i.stateNode,j=i.memoizedProps;x.props=j;var z=x.context,Z=o.contextType;typeof Z=="object"&&Z!==null?Z=Ar(Z):(Z=ur(o)?ta:Fn.current,Z=Ha(i,Z));var de=o.getDerivedStateFromProps,fe=typeof de=="function"||typeof x.getSnapshotBeforeUpdate=="function";fe||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(j!==h||z!==Z)&&qm(i,x,h,Z),pi=!1;var ue=i.memoizedState;x.state=ue,Rc(i,h,x,p),z=i.memoizedState,j!==h||ue!==z||cr.current||pi?(typeof de=="function"&&(sh(i,o,de,h),z=i.memoizedState),(j=pi||Gm(i,o,j,h,ue,z,Z))?(fe||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(i.flags|=4194308)):(typeof x.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=h,i.memoizedState=z),x.props=h,x.state=z,x.context=Z,h=j):(typeof x.componentDidMount=="function"&&(i.flags|=4194308),h=!1)}else{x=i.stateNode,wm(r,i),j=i.memoizedProps,Z=i.type===i.elementType?j:Qr(i.type,j),x.props=Z,fe=i.pendingProps,ue=x.context,z=o.contextType,typeof z=="object"&&z!==null?z=Ar(z):(z=ur(o)?ta:Fn.current,z=Ha(i,z));var Ne=o.getDerivedStateFromProps;(de=typeof Ne=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(j!==fe||ue!==z)&&qm(i,x,h,z),pi=!1,ue=i.memoizedState,x.state=ue,Rc(i,h,x,p);var De=i.memoizedState;j!==fe||ue!==De||cr.current||pi?(typeof Ne=="function"&&(sh(i,o,Ne,h),De=i.memoizedState),(Z=pi||Gm(i,o,Z,h,ue,De,z)||!1)?(de||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(h,De,z),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(h,De,z)),typeof x.componentDidUpdate=="function"&&(i.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof x.componentDidUpdate!="function"||j===r.memoizedProps&&ue===r.memoizedState||(i.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||j===r.memoizedProps&&ue===r.memoizedState||(i.flags|=1024),i.memoizedProps=h,i.memoizedState=De),x.props=h,x.state=De,x.context=z,h=Z):(typeof x.componentDidUpdate!="function"||j===r.memoizedProps&&ue===r.memoizedState||(i.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||j===r.memoizedProps&&ue===r.memoizedState||(i.flags|=1024),h=!1)}return ch(r,i,o,h,y,p)}function ch(r,i,o,h,p,y){rg(r,i);var x=(i.flags&128)!==0;if(!h&&!x)return p&&cm(i,o,!1),$s(r,i,y);h=i.stateNode,px.current=i;var j=x&&typeof o.getDerivedStateFromError!="function"?null:h.render();return i.flags|=1,r!==null&&x?(i.child=Ya(i,r.child,null,y),i.child=Ya(i,null,j,y)):tr(r,i,j,y),i.memoizedState=h.state,p&&cm(i,o,!0),i.child}function ig(r){var i=r.stateNode;i.pendingContext?om(r,i.pendingContext,i.pendingContext!==i.context):i.context&&om(r,i.context,!1),Hd(r,i.containerInfo)}function ag(r,i,o,h,p){return Qa(),Fd(p),i.flags|=256,tr(r,i,o,h),i.child}var uh={dehydrated:null,treeContext:null,retryLane:0};function dh(r){return{baseLanes:r,cachePool:null,transitions:null}}function og(r,i,o){var h=i.pendingProps,p=Bt.current,y=!1,x=(i.flags&128)!==0,j;if((j=x)||(j=r!==null&&r.memoizedState===null?!1:(p&2)!==0),j?(y=!0,i.flags&=-129):(r===null||r.memoizedState!==null)&&(p|=1),At(Bt,p&1),r===null)return Md(i),r=i.memoizedState,r!==null&&(r=r.dehydrated,r!==null)?((i.mode&1)===0?i.lanes=1:r.data==="$!"?i.lanes=8:i.lanes=1073741824,null):(x=h.children,r=h.fallback,y?(h=i.mode,y=i.child,x={mode:"hidden",children:x},(h&1)===0&&y!==null?(y.childLanes=0,y.pendingProps=x):y=Yc(x,h,0,null),r=da(r,h,o,null),y.return=i,r.return=i,y.sibling=r,i.child=y,i.child.memoizedState=dh(o),i.memoizedState=uh,r):hh(i,x));if(p=r.memoizedState,p!==null&&(j=p.dehydrated,j!==null))return mx(r,i,x,h,j,p,o);if(y){y=h.fallback,x=i.mode,p=r.child,j=p.sibling;var z={mode:"hidden",children:h.children};return(x&1)===0&&i.child!==p?(h=i.child,h.childLanes=0,h.pendingProps=z,i.deletions=null):(h=xi(p,z),h.subtreeFlags=p.subtreeFlags&14680064),j!==null?y=xi(j,y):(y=da(y,x,o,null),y.flags|=2),y.return=i,h.return=i,h.sibling=y,i.child=h,h=y,y=i.child,x=r.child.memoizedState,x=x===null?dh(o):{baseLanes:x.baseLanes|o,cachePool:null,transitions:x.transitions},y.memoizedState=x,y.childLanes=r.childLanes&~o,i.memoizedState=uh,h}return y=r.child,r=y.sibling,h=xi(y,{mode:"visible",children:h.children}),(i.mode&1)===0&&(h.lanes=o),h.return=i,h.sibling=null,r!==null&&(o=i.deletions,o===null?(i.deletions=[r],i.flags|=16):o.push(r)),i.child=h,i.memoizedState=null,h}function hh(r,i){return i=Yc({mode:"visible",children:i},r.mode,0,null),i.return=r,r.child=i}function Oc(r,i,o,h){return h!==null&&Fd(h),Ya(i,r.child,null,o),r=hh(i,i.pendingProps.children),r.flags|=2,i.memoizedState=null,r}function mx(r,i,o,h,p,y,x){if(o)return i.flags&256?(i.flags&=-257,h=ah(Error(t(422))),Oc(r,i,x,h)):i.memoizedState!==null?(i.child=r.child,i.flags|=128,null):(y=h.fallback,p=i.mode,h=Yc({mode:"visible",children:h.children},p,0,null),y=da(y,p,x,null),y.flags|=2,h.return=i,y.return=i,h.sibling=y,i.child=h,(i.mode&1)!==0&&Ya(i,r.child,null,x),i.child.memoizedState=dh(x),i.memoizedState=uh,y);if((i.mode&1)===0)return Oc(r,i,x,null);if(p.data==="$!"){if(h=p.nextSibling&&p.nextSibling.dataset,h)var j=h.dgst;return h=j,y=Error(t(419)),h=ah(y,h,void 0),Oc(r,i,x,h)}if(j=(x&r.childLanes)!==0,dr||j){if(h=En,h!==null){switch(x&-x){case 4:p=2;break;case 16:p=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:p=32;break;case 536870912:p=268435456;break;default:p=0}p=(p&(h.suspendedLanes|x))!==0?0:p,p!==0&&p!==y.retryLane&&(y.retryLane=p,zs(r,p),Xr(h,r,p,-1))}return Ph(),h=ah(Error(t(421))),Oc(r,i,x,h)}return p.data==="$?"?(i.flags|=128,i.child=r.child,i=Px.bind(null,r),p._reactRetry=i,null):(r=y.treeContext,Er=ui(p.nextSibling),xr=i,Ft=!0,Kr=null,r!==null&&(Rr[Nr++]=Fs,Rr[Nr++]=Us,Rr[Nr++]=na,Fs=r.id,Us=r.overflow,na=i),i=hh(i,h.children),i.flags|=4096,i)}function lg(r,i,o){r.lanes|=i;var h=r.alternate;h!==null&&(h.lanes|=i),$d(r.return,i,o)}function fh(r,i,o,h,p){var y=r.memoizedState;y===null?r.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:h,tail:o,tailMode:p}:(y.isBackwards=i,y.rendering=null,y.renderingStartTime=0,y.last=h,y.tail=o,y.tailMode=p)}function cg(r,i,o){var h=i.pendingProps,p=h.revealOrder,y=h.tail;if(tr(r,i,h.children,o),h=Bt.current,(h&2)!==0)h=h&1|2,i.flags|=128;else{if(r!==null&&(r.flags&128)!==0)e:for(r=i.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&lg(r,o,i);else if(r.tag===19)lg(r,o,i);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===i)break e;for(;r.sibling===null;){if(r.return===null||r.return===i)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}h&=1}if(At(Bt,h),(i.mode&1)===0)i.memoizedState=null;else switch(p){case"forwards":for(o=i.child,p=null;o!==null;)r=o.alternate,r!==null&&Nc(r)===null&&(p=o),o=o.sibling;o=p,o===null?(p=i.child,i.child=null):(p=o.sibling,o.sibling=null),fh(i,!1,p,o,y);break;case"backwards":for(o=null,p=i.child,i.child=null;p!==null;){if(r=p.alternate,r!==null&&Nc(r)===null){i.child=p;break}r=p.sibling,p.sibling=o,o=p,p=r}fh(i,!0,o,null,y);break;case"together":fh(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function Mc(r,i){(i.mode&1)===0&&r!==null&&(r.alternate=null,i.alternate=null,i.flags|=2)}function $s(r,i,o){if(r!==null&&(i.dependencies=r.dependencies),oa|=i.lanes,(o&i.childLanes)===0)return null;if(r!==null&&i.child!==r.child)throw Error(t(153));if(i.child!==null){for(r=i.child,o=xi(r,r.pendingProps),i.child=o,o.return=i;r.sibling!==null;)r=r.sibling,o=o.sibling=xi(r,r.pendingProps),o.return=i;o.sibling=null}return i.child}function gx(r,i,o){switch(i.tag){case 3:ig(i),Qa();break;case 5:Tm(i);break;case 1:ur(i.type)&&wc(i);break;case 4:Hd(i,i.stateNode.containerInfo);break;case 10:var h=i.type._context,p=i.memoizedProps.value;At(Cc,h._currentValue),h._currentValue=p;break;case 13:if(h=i.memoizedState,h!==null)return h.dehydrated!==null?(At(Bt,Bt.current&1),i.flags|=128,null):(o&i.child.childLanes)!==0?og(r,i,o):(At(Bt,Bt.current&1),r=$s(r,i,o),r!==null?r.sibling:null);At(Bt,Bt.current&1);break;case 19:if(h=(o&i.childLanes)!==0,(r.flags&128)!==0){if(h)return cg(r,i,o);i.flags|=128}if(p=i.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),At(Bt,Bt.current),h)break;return null;case 22:case 23:return i.lanes=0,ng(r,i,o)}return $s(r,i,o)}var ug,ph,dg,hg;ug=function(r,i){for(var o=i.child;o!==null;){if(o.tag===5||o.tag===6)r.appendChild(o.stateNode);else if(o.tag!==4&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return;o=o.return}o.sibling.return=o.return,o=o.sibling}},ph=function(){},dg=function(r,i,o,h){var p=r.memoizedProps;if(p!==h){r=i.stateNode,ia(vs.current);var y=null;switch(o){case"input":p=We(r,p),h=We(r,h),y=[];break;case"select":p=Te({},p,{value:void 0}),h=Te({},h,{value:void 0}),y=[];break;case"textarea":p=gn(r,p),h=gn(r,h),y=[];break;default:typeof p.onClick!="function"&&typeof h.onClick=="function"&&(r.onclick=yc)}As(o,h);var x;o=null;for(Z in p)if(!h.hasOwnProperty(Z)&&p.hasOwnProperty(Z)&&p[Z]!=null)if(Z==="style"){var j=p[Z];for(x in j)j.hasOwnProperty(x)&&(o||(o={}),o[x]="")}else Z!=="dangerouslySetInnerHTML"&&Z!=="children"&&Z!=="suppressContentEditableWarning"&&Z!=="suppressHydrationWarning"&&Z!=="autoFocus"&&(a.hasOwnProperty(Z)?y||(y=[]):(y=y||[]).push(Z,null));for(Z in h){var z=h[Z];if(j=p!=null?p[Z]:void 0,h.hasOwnProperty(Z)&&z!==j&&(z!=null||j!=null))if(Z==="style")if(j){for(x in j)!j.hasOwnProperty(x)||z&&z.hasOwnProperty(x)||(o||(o={}),o[x]="");for(x in z)z.hasOwnProperty(x)&&j[x]!==z[x]&&(o||(o={}),o[x]=z[x])}else o||(y||(y=[]),y.push(Z,o)),o=z;else Z==="dangerouslySetInnerHTML"?(z=z?z.__html:void 0,j=j?j.__html:void 0,z!=null&&j!==z&&(y=y||[]).push(Z,z)):Z==="children"?typeof z!="string"&&typeof z!="number"||(y=y||[]).push(Z,""+z):Z!=="suppressContentEditableWarning"&&Z!=="suppressHydrationWarning"&&(a.hasOwnProperty(Z)?(z!=null&&Z==="onScroll"&&kt("scroll",r),y||j===z||(y=[])):(y=y||[]).push(Z,z))}o&&(y=y||[]).push("style",o);var Z=y;(i.updateQueue=Z)&&(i.flags|=4)}},hg=function(r,i,o,h){o!==h&&(i.flags|=4)};function sl(r,i){if(!Ft)switch(r.tailMode){case"hidden":i=r.tail;for(var o=null;i!==null;)i.alternate!==null&&(o=i),i=i.sibling;o===null?r.tail=null:o.sibling=null;break;case"collapsed":o=r.tail;for(var h=null;o!==null;)o.alternate!==null&&(h=o),o=o.sibling;h===null?i||r.tail===null?r.tail=null:r.tail.sibling=null:h.sibling=null}}function zn(r){var i=r.alternate!==null&&r.alternate.child===r.child,o=0,h=0;if(i)for(var p=r.child;p!==null;)o|=p.lanes|p.childLanes,h|=p.subtreeFlags&14680064,h|=p.flags&14680064,p.return=r,p=p.sibling;else for(p=r.child;p!==null;)o|=p.lanes|p.childLanes,h|=p.subtreeFlags,h|=p.flags,p.return=r,p=p.sibling;return r.subtreeFlags|=h,r.childLanes=o,i}function yx(r,i,o){var h=i.pendingProps;switch(Ld(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return zn(i),null;case 1:return ur(i.type)&&_c(),zn(i),null;case 3:return h=i.stateNode,Za(),jt(cr),jt(Fn),Qd(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(r===null||r.child===null)&&(Sc(i)?i.flags|=4:r===null||r.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Kr!==null&&(Ih(Kr),Kr=null))),ph(r,i),zn(i),null;case 5:qd(i);var p=ia(Zo.current);if(o=i.type,r!==null&&i.stateNode!=null)dg(r,i,o,h,p),r.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!h){if(i.stateNode===null)throw Error(t(166));return zn(i),null}if(r=ia(vs.current),Sc(i)){h=i.stateNode,o=i.type;var y=i.memoizedProps;switch(h[ys]=i,h[Ko]=y,r=(i.mode&1)!==0,o){case"dialog":kt("cancel",h),kt("close",h);break;case"iframe":case"object":case"embed":kt("load",h);break;case"video":case"audio":for(p=0;p<Go.length;p++)kt(Go[p],h);break;case"source":kt("error",h);break;case"img":case"image":case"link":kt("error",h),kt("load",h);break;case"details":kt("toggle",h);break;case"input":Et(h,y),kt("invalid",h);break;case"select":h._wrapperState={wasMultiple:!!y.multiple},kt("invalid",h);break;case"textarea":qn(h,y),kt("invalid",h)}As(o,y),p=null;for(var x in y)if(y.hasOwnProperty(x)){var j=y[x];x==="children"?typeof j=="string"?h.textContent!==j&&(y.suppressHydrationWarning!==!0&&gc(h.textContent,j,r),p=["children",j]):typeof j=="number"&&h.textContent!==""+j&&(y.suppressHydrationWarning!==!0&&gc(h.textContent,j,r),p=["children",""+j]):a.hasOwnProperty(x)&&j!=null&&x==="onScroll"&&kt("scroll",h)}switch(o){case"input":te(h),Tt(h,y,!0);break;case"textarea":te(h),sr(h);break;case"select":case"option":break;default:typeof y.onClick=="function"&&(h.onclick=yc)}h=p,i.updateQueue=h,h!==null&&(i.flags|=4)}else{x=p.nodeType===9?p:p.ownerDocument,r==="http://www.w3.org/1999/xhtml"&&(r=Lt(o)),r==="http://www.w3.org/1999/xhtml"?o==="script"?(r=x.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild)):typeof h.is=="string"?r=x.createElement(o,{is:h.is}):(r=x.createElement(o),o==="select"&&(x=r,h.multiple?x.multiple=!0:h.size&&(x.size=h.size))):r=x.createElementNS(r,o),r[ys]=i,r[Ko]=h,ug(r,i,!1,!1),i.stateNode=r;e:{switch(x=ri(o,h),o){case"dialog":kt("cancel",r),kt("close",r),p=h;break;case"iframe":case"object":case"embed":kt("load",r),p=h;break;case"video":case"audio":for(p=0;p<Go.length;p++)kt(Go[p],r);p=h;break;case"source":kt("error",r),p=h;break;case"img":case"image":case"link":kt("error",r),kt("load",r),p=h;break;case"details":kt("toggle",r),p=h;break;case"input":Et(r,h),p=We(r,h),kt("invalid",r);break;case"option":p=h;break;case"select":r._wrapperState={wasMultiple:!!h.multiple},p=Te({},h,{value:void 0}),kt("invalid",r);break;case"textarea":qn(r,h),p=gn(r,h),kt("invalid",r);break;default:p=h}As(o,p),j=p;for(y in j)if(j.hasOwnProperty(y)){var z=j[y];y==="style"?mt(r,z):y==="dangerouslySetInnerHTML"?(z=z?z.__html:void 0,z!=null&&ss(r,z)):y==="children"?typeof z=="string"?(o!=="textarea"||z!=="")&&Vn(r,z):typeof z=="number"&&Vn(r,""+z):y!=="suppressContentEditableWarning"&&y!=="suppressHydrationWarning"&&y!=="autoFocus"&&(a.hasOwnProperty(y)?z!=null&&y==="onScroll"&&kt("scroll",r):z!=null&&ge(r,y,z,x))}switch(o){case"input":te(r),Tt(r,h,!1);break;case"textarea":te(r),sr(r);break;case"option":h.value!=null&&r.setAttribute("value",""+Me(h.value));break;case"select":r.multiple=!!h.multiple,y=h.value,y!=null?In(r,!!h.multiple,y,!1):h.defaultValue!=null&&In(r,!!h.multiple,h.defaultValue,!0);break;default:typeof p.onClick=="function"&&(r.onclick=yc)}switch(o){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}}h&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return zn(i),null;case 6:if(r&&i.stateNode!=null)hg(r,i,r.memoizedProps,h);else{if(typeof h!="string"&&i.stateNode===null)throw Error(t(166));if(o=ia(Zo.current),ia(vs.current),Sc(i)){if(h=i.stateNode,o=i.memoizedProps,h[ys]=i,(y=h.nodeValue!==o)&&(r=xr,r!==null))switch(r.tag){case 3:gc(h.nodeValue,o,(r.mode&1)!==0);break;case 5:r.memoizedProps.suppressHydrationWarning!==!0&&gc(h.nodeValue,o,(r.mode&1)!==0)}y&&(i.flags|=4)}else h=(o.nodeType===9?o:o.ownerDocument).createTextNode(h),h[ys]=i,i.stateNode=h}return zn(i),null;case 13:if(jt(Bt),h=i.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(Ft&&Er!==null&&(i.mode&1)!==0&&(i.flags&128)===0)mm(),Qa(),i.flags|=98560,y=!1;else if(y=Sc(i),h!==null&&h.dehydrated!==null){if(r===null){if(!y)throw Error(t(318));if(y=i.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(t(317));y[ys]=i}else Qa(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;zn(i),y=!1}else Kr!==null&&(Ih(Kr),Kr=null),y=!0;if(!y)return i.flags&65536?i:null}return(i.flags&128)!==0?(i.lanes=o,i):(h=h!==null,h!==(r!==null&&r.memoizedState!==null)&&h&&(i.child.flags|=8192,(i.mode&1)!==0&&(r===null||(Bt.current&1)!==0?hn===0&&(hn=3):Ph())),i.updateQueue!==null&&(i.flags|=4),zn(i),null);case 4:return Za(),ph(r,i),r===null&&Ho(i.stateNode.containerInfo),zn(i),null;case 10:return Bd(i.type._context),zn(i),null;case 17:return ur(i.type)&&_c(),zn(i),null;case 19:if(jt(Bt),y=i.memoizedState,y===null)return zn(i),null;if(h=(i.flags&128)!==0,x=y.rendering,x===null)if(h)sl(y,!1);else{if(hn!==0||r!==null&&(r.flags&128)!==0)for(r=i.child;r!==null;){if(x=Nc(r),x!==null){for(i.flags|=128,sl(y,!1),h=x.updateQueue,h!==null&&(i.updateQueue=h,i.flags|=4),i.subtreeFlags=0,h=o,o=i.child;o!==null;)y=o,r=h,y.flags&=14680066,x=y.alternate,x===null?(y.childLanes=0,y.lanes=r,y.child=null,y.subtreeFlags=0,y.memoizedProps=null,y.memoizedState=null,y.updateQueue=null,y.dependencies=null,y.stateNode=null):(y.childLanes=x.childLanes,y.lanes=x.lanes,y.child=x.child,y.subtreeFlags=0,y.deletions=null,y.memoizedProps=x.memoizedProps,y.memoizedState=x.memoizedState,y.updateQueue=x.updateQueue,y.type=x.type,r=x.dependencies,y.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),o=o.sibling;return At(Bt,Bt.current&1|2),i.child}r=r.sibling}y.tail!==null&&H()>ro&&(i.flags|=128,h=!0,sl(y,!1),i.lanes=4194304)}else{if(!h)if(r=Nc(x),r!==null){if(i.flags|=128,h=!0,o=r.updateQueue,o!==null&&(i.updateQueue=o,i.flags|=4),sl(y,!0),y.tail===null&&y.tailMode==="hidden"&&!x.alternate&&!Ft)return zn(i),null}else 2*H()-y.renderingStartTime>ro&&o!==1073741824&&(i.flags|=128,h=!0,sl(y,!1),i.lanes=4194304);y.isBackwards?(x.sibling=i.child,i.child=x):(o=y.last,o!==null?o.sibling=x:i.child=x,y.last=x)}return y.tail!==null?(i=y.tail,y.rendering=i,y.tail=i.sibling,y.renderingStartTime=H(),i.sibling=null,o=Bt.current,At(Bt,h?o&1|2:o&1),i):(zn(i),null);case 22:case 23:return bh(),h=i.memoizedState!==null,r!==null&&r.memoizedState!==null!==h&&(i.flags|=8192),h&&(i.mode&1)!==0?(Tr&1073741824)!==0&&(zn(i),i.subtreeFlags&6&&(i.flags|=8192)):zn(i),null;case 24:return null;case 25:return null}throw Error(t(156,i.tag))}function vx(r,i){switch(Ld(i),i.tag){case 1:return ur(i.type)&&_c(),r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 3:return Za(),jt(cr),jt(Fn),Qd(),r=i.flags,(r&65536)!==0&&(r&128)===0?(i.flags=r&-65537|128,i):null;case 5:return qd(i),null;case 13:if(jt(Bt),r=i.memoizedState,r!==null&&r.dehydrated!==null){if(i.alternate===null)throw Error(t(340));Qa()}return r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 19:return jt(Bt),null;case 4:return Za(),null;case 10:return Bd(i.type._context),null;case 22:case 23:return bh(),null;case 24:return null;default:return null}}var Fc=!1,Bn=!1,_x=typeof WeakSet=="function"?WeakSet:Set,je=null;function to(r,i){var o=r.ref;if(o!==null)if(typeof o=="function")try{o(null)}catch(h){Gt(r,i,h)}else o.current=null}function mh(r,i,o){try{o()}catch(h){Gt(r,i,h)}}var fg=!1;function wx(r,i){if(bd=oi,r=Gp(),_d(r)){if("selectionStart"in r)var o={start:r.selectionStart,end:r.selectionEnd};else e:{o=(o=r.ownerDocument)&&o.defaultView||window;var h=o.getSelection&&o.getSelection();if(h&&h.rangeCount!==0){o=h.anchorNode;var p=h.anchorOffset,y=h.focusNode;h=h.focusOffset;try{o.nodeType,y.nodeType}catch{o=null;break e}var x=0,j=-1,z=-1,Z=0,de=0,fe=r,ue=null;t:for(;;){for(var Ne;fe!==o||p!==0&&fe.nodeType!==3||(j=x+p),fe!==y||h!==0&&fe.nodeType!==3||(z=x+h),fe.nodeType===3&&(x+=fe.nodeValue.length),(Ne=fe.firstChild)!==null;)ue=fe,fe=Ne;for(;;){if(fe===r)break t;if(ue===o&&++Z===p&&(j=x),ue===y&&++de===h&&(z=x),(Ne=fe.nextSibling)!==null)break;fe=ue,ue=fe.parentNode}fe=Ne}o=j===-1||z===-1?null:{start:j,end:z}}else o=null}o=o||{start:0,end:0}}else o=null;for(Pd={focusedElem:r,selectionRange:o},oi=!1,je=i;je!==null;)if(i=je,r=i.child,(i.subtreeFlags&1028)!==0&&r!==null)r.return=i,je=r;else for(;je!==null;){i=je;try{var De=i.alternate;if((i.flags&1024)!==0)switch(i.tag){case 0:case 11:case 15:break;case 1:if(De!==null){var Le=De.memoizedProps,qt=De.memoizedState,Q=i.stateNode,G=Q.getSnapshotBeforeUpdate(i.elementType===i.type?Le:Qr(i.type,Le),qt);Q.__reactInternalSnapshotBeforeUpdate=G}break;case 3:var J=i.stateNode.containerInfo;J.nodeType===1?J.textContent="":J.nodeType===9&&J.documentElement&&J.removeChild(J.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(we){Gt(i,i.return,we)}if(r=i.sibling,r!==null){r.return=i.return,je=r;break}je=i.return}return De=fg,fg=!1,De}function il(r,i,o){var h=i.updateQueue;if(h=h!==null?h.lastEffect:null,h!==null){var p=h=h.next;do{if((p.tag&r)===r){var y=p.destroy;p.destroy=void 0,y!==void 0&&mh(i,o,y)}p=p.next}while(p!==h)}}function Uc(r,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var o=i=i.next;do{if((o.tag&r)===r){var h=o.create;o.destroy=h()}o=o.next}while(o!==i)}}function gh(r){var i=r.ref;if(i!==null){var o=r.stateNode;switch(r.tag){case 5:r=o;break;default:r=o}typeof i=="function"?i(r):i.current=r}}function pg(r){var i=r.alternate;i!==null&&(r.alternate=null,pg(i)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(i=r.stateNode,i!==null&&(delete i[ys],delete i[Ko],delete i[kd],delete i[nx],delete i[rx])),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}function mg(r){return r.tag===5||r.tag===3||r.tag===4}function gg(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||mg(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function yh(r,i,o){var h=r.tag;if(h===5||h===6)r=r.stateNode,i?o.nodeType===8?o.parentNode.insertBefore(r,i):o.insertBefore(r,i):(o.nodeType===8?(i=o.parentNode,i.insertBefore(r,o)):(i=o,i.appendChild(r)),o=o._reactRootContainer,o!=null||i.onclick!==null||(i.onclick=yc));else if(h!==4&&(r=r.child,r!==null))for(yh(r,i,o),r=r.sibling;r!==null;)yh(r,i,o),r=r.sibling}function vh(r,i,o){var h=r.tag;if(h===5||h===6)r=r.stateNode,i?o.insertBefore(r,i):o.appendChild(r);else if(h!==4&&(r=r.child,r!==null))for(vh(r,i,o),r=r.sibling;r!==null;)vh(r,i,o),r=r.sibling}var Nn=null,Yr=!1;function gi(r,i,o){for(o=o.child;o!==null;)yg(r,i,o),o=o.sibling}function yg(r,i,o){if(T&&typeof T.onCommitFiberUnmount=="function")try{T.onCommitFiberUnmount(Ce,o)}catch{}switch(o.tag){case 5:Bn||to(o,i);case 6:var h=Nn,p=Yr;Nn=null,gi(r,i,o),Nn=h,Yr=p,Nn!==null&&(Yr?(r=Nn,o=o.stateNode,r.nodeType===8?r.parentNode.removeChild(o):r.removeChild(o)):Nn.removeChild(o.stateNode));break;case 18:Nn!==null&&(Yr?(r=Nn,o=o.stateNode,r.nodeType===8?Ad(r.parentNode,o):r.nodeType===1&&Ad(r,o),Gr(r)):Ad(Nn,o.stateNode));break;case 4:h=Nn,p=Yr,Nn=o.stateNode.containerInfo,Yr=!0,gi(r,i,o),Nn=h,Yr=p;break;case 0:case 11:case 14:case 15:if(!Bn&&(h=o.updateQueue,h!==null&&(h=h.lastEffect,h!==null))){p=h=h.next;do{var y=p,x=y.destroy;y=y.tag,x!==void 0&&((y&2)!==0||(y&4)!==0)&&mh(o,i,x),p=p.next}while(p!==h)}gi(r,i,o);break;case 1:if(!Bn&&(to(o,i),h=o.stateNode,typeof h.componentWillUnmount=="function"))try{h.props=o.memoizedProps,h.state=o.memoizedState,h.componentWillUnmount()}catch(j){Gt(o,i,j)}gi(r,i,o);break;case 21:gi(r,i,o);break;case 22:o.mode&1?(Bn=(h=Bn)||o.memoizedState!==null,gi(r,i,o),Bn=h):gi(r,i,o);break;default:gi(r,i,o)}}function vg(r){var i=r.updateQueue;if(i!==null){r.updateQueue=null;var o=r.stateNode;o===null&&(o=r.stateNode=new _x),i.forEach(function(h){var p=Rx.bind(null,r,h);o.has(h)||(o.add(h),h.then(p,p))})}}function Jr(r,i){var o=i.deletions;if(o!==null)for(var h=0;h<o.length;h++){var p=o[h];try{var y=r,x=i,j=x;e:for(;j!==null;){switch(j.tag){case 5:Nn=j.stateNode,Yr=!1;break e;case 3:Nn=j.stateNode.containerInfo,Yr=!0;break e;case 4:Nn=j.stateNode.containerInfo,Yr=!0;break e}j=j.return}if(Nn===null)throw Error(t(160));yg(y,x,p),Nn=null,Yr=!1;var z=p.alternate;z!==null&&(z.return=null),p.return=null}catch(Z){Gt(p,i,Z)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)_g(i,r),i=i.sibling}function _g(r,i){var o=r.alternate,h=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:if(Jr(i,r),ws(r),h&4){try{il(3,r,r.return),Uc(3,r)}catch(Le){Gt(r,r.return,Le)}try{il(5,r,r.return)}catch(Le){Gt(r,r.return,Le)}}break;case 1:Jr(i,r),ws(r),h&512&&o!==null&&to(o,o.return);break;case 5:if(Jr(i,r),ws(r),h&512&&o!==null&&to(o,o.return),r.flags&32){var p=r.stateNode;try{Vn(p,"")}catch(Le){Gt(r,r.return,Le)}}if(h&4&&(p=r.stateNode,p!=null)){var y=r.memoizedProps,x=o!==null?o.memoizedProps:y,j=r.type,z=r.updateQueue;if(r.updateQueue=null,z!==null)try{j==="input"&&y.type==="radio"&&y.name!=null&&wt(p,y),ri(j,x);var Z=ri(j,y);for(x=0;x<z.length;x+=2){var de=z[x],fe=z[x+1];de==="style"?mt(p,fe):de==="dangerouslySetInnerHTML"?ss(p,fe):de==="children"?Vn(p,fe):ge(p,de,fe,Z)}switch(j){case"input":pt(p,y);break;case"textarea":yn(p,y);break;case"select":var ue=p._wrapperState.wasMultiple;p._wrapperState.wasMultiple=!!y.multiple;var Ne=y.value;Ne!=null?In(p,!!y.multiple,Ne,!1):ue!==!!y.multiple&&(y.defaultValue!=null?In(p,!!y.multiple,y.defaultValue,!0):In(p,!!y.multiple,y.multiple?[]:"",!1))}p[Ko]=y}catch(Le){Gt(r,r.return,Le)}}break;case 6:if(Jr(i,r),ws(r),h&4){if(r.stateNode===null)throw Error(t(162));p=r.stateNode,y=r.memoizedProps;try{p.nodeValue=y}catch(Le){Gt(r,r.return,Le)}}break;case 3:if(Jr(i,r),ws(r),h&4&&o!==null&&o.memoizedState.isDehydrated)try{Gr(i.containerInfo)}catch(Le){Gt(r,r.return,Le)}break;case 4:Jr(i,r),ws(r);break;case 13:Jr(i,r),ws(r),p=r.child,p.flags&8192&&(y=p.memoizedState!==null,p.stateNode.isHidden=y,!y||p.alternate!==null&&p.alternate.memoizedState!==null||(xh=H())),h&4&&vg(r);break;case 22:if(de=o!==null&&o.memoizedState!==null,r.mode&1?(Bn=(Z=Bn)||de,Jr(i,r),Bn=Z):Jr(i,r),ws(r),h&8192){if(Z=r.memoizedState!==null,(r.stateNode.isHidden=Z)&&!de&&(r.mode&1)!==0)for(je=r,de=r.child;de!==null;){for(fe=je=de;je!==null;){switch(ue=je,Ne=ue.child,ue.tag){case 0:case 11:case 14:case 15:il(4,ue,ue.return);break;case 1:to(ue,ue.return);var De=ue.stateNode;if(typeof De.componentWillUnmount=="function"){h=ue,o=ue.return;try{i=h,De.props=i.memoizedProps,De.state=i.memoizedState,De.componentWillUnmount()}catch(Le){Gt(h,o,Le)}}break;case 5:to(ue,ue.return);break;case 22:if(ue.memoizedState!==null){Eg(fe);continue}}Ne!==null?(Ne.return=ue,je=Ne):Eg(fe)}de=de.sibling}e:for(de=null,fe=r;;){if(fe.tag===5){if(de===null){de=fe;try{p=fe.stateNode,Z?(y=p.style,typeof y.setProperty=="function"?y.setProperty("display","none","important"):y.display="none"):(j=fe.stateNode,z=fe.memoizedProps.style,x=z!=null&&z.hasOwnProperty("display")?z.display:null,j.style.display=is("display",x))}catch(Le){Gt(r,r.return,Le)}}}else if(fe.tag===6){if(de===null)try{fe.stateNode.nodeValue=Z?"":fe.memoizedProps}catch(Le){Gt(r,r.return,Le)}}else if((fe.tag!==22&&fe.tag!==23||fe.memoizedState===null||fe===r)&&fe.child!==null){fe.child.return=fe,fe=fe.child;continue}if(fe===r)break e;for(;fe.sibling===null;){if(fe.return===null||fe.return===r)break e;de===fe&&(de=null),fe=fe.return}de===fe&&(de=null),fe.sibling.return=fe.return,fe=fe.sibling}}break;case 19:Jr(i,r),ws(r),h&4&&vg(r);break;case 21:break;default:Jr(i,r),ws(r)}}function ws(r){var i=r.flags;if(i&2){try{e:{for(var o=r.return;o!==null;){if(mg(o)){var h=o;break e}o=o.return}throw Error(t(160))}switch(h.tag){case 5:var p=h.stateNode;h.flags&32&&(Vn(p,""),h.flags&=-33);var y=gg(r);vh(r,y,p);break;case 3:case 4:var x=h.stateNode.containerInfo,j=gg(r);yh(r,j,x);break;default:throw Error(t(161))}}catch(z){Gt(r,r.return,z)}r.flags&=-3}i&4096&&(r.flags&=-4097)}function xx(r,i,o){je=r,wg(r)}function wg(r,i,o){for(var h=(r.mode&1)!==0;je!==null;){var p=je,y=p.child;if(p.tag===22&&h){var x=p.memoizedState!==null||Fc;if(!x){var j=p.alternate,z=j!==null&&j.memoizedState!==null||Bn;j=Fc;var Z=Bn;if(Fc=x,(Bn=z)&&!Z)for(je=p;je!==null;)x=je,z=x.child,x.tag===22&&x.memoizedState!==null?Tg(p):z!==null?(z.return=x,je=z):Tg(p);for(;y!==null;)je=y,wg(y),y=y.sibling;je=p,Fc=j,Bn=Z}xg(r)}else(p.subtreeFlags&8772)!==0&&y!==null?(y.return=p,je=y):xg(r)}}function xg(r){for(;je!==null;){var i=je;if((i.flags&8772)!==0){var o=i.alternate;try{if((i.flags&8772)!==0)switch(i.tag){case 0:case 11:case 15:Bn||Uc(5,i);break;case 1:var h=i.stateNode;if(i.flags&4&&!Bn)if(o===null)h.componentDidMount();else{var p=i.elementType===i.type?o.memoizedProps:Qr(i.type,o.memoizedProps);h.componentDidUpdate(p,o.memoizedState,h.__reactInternalSnapshotBeforeUpdate)}var y=i.updateQueue;y!==null&&Em(i,y,h);break;case 3:var x=i.updateQueue;if(x!==null){if(o=null,i.child!==null)switch(i.child.tag){case 5:o=i.child.stateNode;break;case 1:o=i.child.stateNode}Em(i,x,o)}break;case 5:var j=i.stateNode;if(o===null&&i.flags&4){o=j;var z=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":z.autoFocus&&o.focus();break;case"img":z.src&&(o.src=z.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var Z=i.alternate;if(Z!==null){var de=Z.memoizedState;if(de!==null){var fe=de.dehydrated;fe!==null&&Gr(fe)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Bn||i.flags&512&&gh(i)}catch(ue){Gt(i,i.return,ue)}}if(i===r){je=null;break}if(o=i.sibling,o!==null){o.return=i.return,je=o;break}je=i.return}}function Eg(r){for(;je!==null;){var i=je;if(i===r){je=null;break}var o=i.sibling;if(o!==null){o.return=i.return,je=o;break}je=i.return}}function Tg(r){for(;je!==null;){var i=je;try{switch(i.tag){case 0:case 11:case 15:var o=i.return;try{Uc(4,i)}catch(z){Gt(i,o,z)}break;case 1:var h=i.stateNode;if(typeof h.componentDidMount=="function"){var p=i.return;try{h.componentDidMount()}catch(z){Gt(i,p,z)}}var y=i.return;try{gh(i)}catch(z){Gt(i,y,z)}break;case 5:var x=i.return;try{gh(i)}catch(z){Gt(i,x,z)}}}catch(z){Gt(i,i.return,z)}if(i===r){je=null;break}var j=i.sibling;if(j!==null){j.return=i.return,je=j;break}je=i.return}}var Ex=Math.ceil,zc=ye.ReactCurrentDispatcher,_h=ye.ReactCurrentOwner,jr=ye.ReactCurrentBatchConfig,gt=0,En=null,en=null,An=0,Tr=0,no=di(0),hn=0,al=null,oa=0,Bc=0,wh=0,ol=null,hr=null,xh=0,ro=1/0,Ws=null,$c=!1,Eh=null,yi=null,Wc=!1,vi=null,Gc=0,ll=0,Th=null,Hc=-1,qc=0;function nr(){return(gt&6)!==0?H():Hc!==-1?Hc:Hc=H()}function _i(r){return(r.mode&1)===0?1:(gt&2)!==0&&An!==0?An&-An:ix.transition!==null?(qc===0&&(qc=zt()),qc):(r=rt,r!==0||(r=window.event,r=r===void 0?16:Lo(r.type)),r)}function Xr(r,i,o,h){if(50<ll)throw ll=0,Th=null,Error(t(185));Zn(r,o,h),((gt&2)===0||r!==En)&&(r===En&&((gt&2)===0&&(Bc|=o),hn===4&&wi(r,An)),fr(r,h),o===1&&gt===0&&(i.mode&1)===0&&(ro=H()+500,xc&&fi()))}function fr(r,i){var o=r.callbackNode;Nt(r,i);var h=vt(r,r===En?An:0);if(h===0)o!==null&&Xn(o),r.callbackNode=null,r.callbackPriority=0;else if(i=h&-h,r.callbackPriority!==i){if(o!=null&&Xn(o),i===1)r.tag===0?sx(Ig.bind(null,r)):um(Ig.bind(null,r)),ex(function(){(gt&6)===0&&fi()}),o=null;else{switch(us(h)){case 1:o=O;break;case 4:o=W;break;case 16:o=ce;break;case 536870912:o=Je;break;default:o=ce}o=jg(o,Sg.bind(null,r))}r.callbackPriority=i,r.callbackNode=o}}function Sg(r,i){if(Hc=-1,qc=0,(gt&6)!==0)throw Error(t(327));var o=r.callbackNode;if(so()&&r.callbackNode!==o)return null;var h=vt(r,r===En?An:0);if(h===0)return null;if((h&30)!==0||(h&r.expiredLanes)!==0||i)i=Kc(r,h);else{i=h;var p=gt;gt|=2;var y=bg();(En!==r||An!==i)&&(Ws=null,ro=H()+500,ca(r,i));do try{Ix();break}catch(j){Cg(r,j)}while(!0);zd(),zc.current=y,gt=p,en!==null?i=0:(En=null,An=0,i=hn)}if(i!==0){if(i===2&&(p=Ot(r),p!==0&&(h=p,i=Sh(r,p))),i===1)throw o=al,ca(r,0),wi(r,h),fr(r,H()),o;if(i===6)wi(r,h);else{if(p=r.current.alternate,(h&30)===0&&!Tx(p)&&(i=Kc(r,h),i===2&&(y=Ot(r),y!==0&&(h=y,i=Sh(r,y))),i===1))throw o=al,ca(r,0),wi(r,h),fr(r,H()),o;switch(r.finishedWork=p,r.finishedLanes=h,i){case 0:case 1:throw Error(t(345));case 2:ua(r,hr,Ws);break;case 3:if(wi(r,h),(h&130023424)===h&&(i=xh+500-H(),10<i)){if(vt(r,0)!==0)break;if(p=r.suspendedLanes,(p&h)!==h){nr(),r.pingedLanes|=r.suspendedLanes&p;break}r.timeoutHandle=Nd(ua.bind(null,r,hr,Ws),i);break}ua(r,hr,Ws);break;case 4:if(wi(r,h),(h&4194240)===h)break;for(i=r.eventTimes,p=-1;0<h;){var x=31-F(h);y=1<<x,x=i[x],x>p&&(p=x),h&=~y}if(h=p,h=H()-h,h=(120>h?120:480>h?480:1080>h?1080:1920>h?1920:3e3>h?3e3:4320>h?4320:1960*Ex(h/1960))-h,10<h){r.timeoutHandle=Nd(ua.bind(null,r,hr,Ws),h);break}ua(r,hr,Ws);break;case 5:ua(r,hr,Ws);break;default:throw Error(t(329))}}}return fr(r,H()),r.callbackNode===o?Sg.bind(null,r):null}function Sh(r,i){var o=ol;return r.current.memoizedState.isDehydrated&&(ca(r,i).flags|=256),r=Kc(r,i),r!==2&&(i=hr,hr=o,i!==null&&Ih(i)),r}function Ih(r){hr===null?hr=r:hr.push.apply(hr,r)}function Tx(r){for(var i=r;;){if(i.flags&16384){var o=i.updateQueue;if(o!==null&&(o=o.stores,o!==null))for(var h=0;h<o.length;h++){var p=o[h],y=p.getSnapshot;p=p.value;try{if(!qr(y(),p))return!1}catch{return!1}}}if(o=i.child,i.subtreeFlags&16384&&o!==null)o.return=i,i=o;else{if(i===r)break;for(;i.sibling===null;){if(i.return===null||i.return===r)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function wi(r,i){for(i&=~wh,i&=~Bc,r.suspendedLanes|=i,r.pingedLanes&=~i,r=r.expirationTimes;0<i;){var o=31-F(i),h=1<<o;r[o]=-1,i&=~h}}function Ig(r){if((gt&6)!==0)throw Error(t(327));so();var i=vt(r,0);if((i&1)===0)return fr(r,H()),null;var o=Kc(r,i);if(r.tag!==0&&o===2){var h=Ot(r);h!==0&&(i=h,o=Sh(r,h))}if(o===1)throw o=al,ca(r,0),wi(r,i),fr(r,H()),o;if(o===6)throw Error(t(345));return r.finishedWork=r.current.alternate,r.finishedLanes=i,ua(r,hr,Ws),fr(r,H()),null}function Ch(r,i){var o=gt;gt|=1;try{return r(i)}finally{gt=o,gt===0&&(ro=H()+500,xc&&fi())}}function la(r){vi!==null&&vi.tag===0&&(gt&6)===0&&so();var i=gt;gt|=1;var o=jr.transition,h=rt;try{if(jr.transition=null,rt=1,r)return r()}finally{rt=h,jr.transition=o,gt=i,(gt&6)===0&&fi()}}function bh(){Tr=no.current,jt(no)}function ca(r,i){r.finishedWork=null,r.finishedLanes=0;var o=r.timeoutHandle;if(o!==-1&&(r.timeoutHandle=-1,Zw(o)),en!==null)for(o=en.return;o!==null;){var h=o;switch(Ld(h),h.tag){case 1:h=h.type.childContextTypes,h!=null&&_c();break;case 3:Za(),jt(cr),jt(Fn),Qd();break;case 5:qd(h);break;case 4:Za();break;case 13:jt(Bt);break;case 19:jt(Bt);break;case 10:Bd(h.type._context);break;case 22:case 23:bh()}o=o.return}if(En=r,en=r=xi(r.current,null),An=Tr=i,hn=0,al=null,wh=Bc=oa=0,hr=ol=null,sa!==null){for(i=0;i<sa.length;i++)if(o=sa[i],h=o.interleaved,h!==null){o.interleaved=null;var p=h.next,y=o.pending;if(y!==null){var x=y.next;y.next=p,h.next=x}o.pending=h}sa=null}return r}function Cg(r,i){do{var o=en;try{if(zd(),Ac.current=Vc,kc){for(var h=$t.memoizedState;h!==null;){var p=h.queue;p!==null&&(p.pending=null),h=h.next}kc=!1}if(aa=0,xn=dn=$t=null,el=!1,tl=0,_h.current=null,o===null||o.return===null){hn=1,al=i,en=null;break}e:{var y=r,x=o.return,j=o,z=i;if(i=An,j.flags|=32768,z!==null&&typeof z=="object"&&typeof z.then=="function"){var Z=z,de=j,fe=de.tag;if((de.mode&1)===0&&(fe===0||fe===11||fe===15)){var ue=de.alternate;ue?(de.updateQueue=ue.updateQueue,de.memoizedState=ue.memoizedState,de.lanes=ue.lanes):(de.updateQueue=null,de.memoizedState=null)}var Ne=Jm(x);if(Ne!==null){Ne.flags&=-257,Xm(Ne,x,j,y,i),Ne.mode&1&&Ym(y,Z,i),i=Ne,z=Z;var De=i.updateQueue;if(De===null){var Le=new Set;Le.add(z),i.updateQueue=Le}else De.add(z);break e}else{if((i&1)===0){Ym(y,Z,i),Ph();break e}z=Error(t(426))}}else if(Ft&&j.mode&1){var qt=Jm(x);if(qt!==null){(qt.flags&65536)===0&&(qt.flags|=256),Xm(qt,x,j,y,i),Fd(eo(z,j));break e}}y=z=eo(z,j),hn!==4&&(hn=2),ol===null?ol=[y]:ol.push(y),y=x;do{switch(y.tag){case 3:y.flags|=65536,i&=-i,y.lanes|=i;var Q=Km(y,z,i);xm(y,Q);break e;case 1:j=z;var G=y.type,J=y.stateNode;if((y.flags&128)===0&&(typeof G.getDerivedStateFromError=="function"||J!==null&&typeof J.componentDidCatch=="function"&&(yi===null||!yi.has(J)))){y.flags|=65536,i&=-i,y.lanes|=i;var we=Qm(y,j,i);xm(y,we);break e}}y=y.return}while(y!==null)}Rg(o)}catch(Ue){i=Ue,en===o&&o!==null&&(en=o=o.return);continue}break}while(!0)}function bg(){var r=zc.current;return zc.current=Vc,r===null?Vc:r}function Ph(){(hn===0||hn===3||hn===2)&&(hn=4),En===null||(oa&268435455)===0&&(Bc&268435455)===0||wi(En,An)}function Kc(r,i){var o=gt;gt|=2;var h=bg();(En!==r||An!==i)&&(Ws=null,ca(r,i));do try{Sx();break}catch(p){Cg(r,p)}while(!0);if(zd(),gt=o,zc.current=h,en!==null)throw Error(t(261));return En=null,An=0,hn}function Sx(){for(;en!==null;)Pg(en)}function Ix(){for(;en!==null&&!Xt();)Pg(en)}function Pg(r){var i=kg(r.alternate,r,Tr);r.memoizedProps=r.pendingProps,i===null?Rg(r):en=i,_h.current=null}function Rg(r){var i=r;do{var o=i.alternate;if(r=i.return,(i.flags&32768)===0){if(o=yx(o,i,Tr),o!==null){en=o;return}}else{if(o=vx(o,i),o!==null){o.flags&=32767,en=o;return}if(r!==null)r.flags|=32768,r.subtreeFlags=0,r.deletions=null;else{hn=6,en=null;return}}if(i=i.sibling,i!==null){en=i;return}en=i=r}while(i!==null);hn===0&&(hn=5)}function ua(r,i,o){var h=rt,p=jr.transition;try{jr.transition=null,rt=1,Cx(r,i,o,h)}finally{jr.transition=p,rt=h}return null}function Cx(r,i,o,h){do so();while(vi!==null);if((gt&6)!==0)throw Error(t(327));o=r.finishedWork;var p=r.finishedLanes;if(o===null)return null;if(r.finishedWork=null,r.finishedLanes=0,o===r.current)throw Error(t(177));r.callbackNode=null,r.callbackPriority=0;var y=o.lanes|o.childLanes;if(nt(r,y),r===En&&(en=En=null,An=0),(o.subtreeFlags&2064)===0&&(o.flags&2064)===0||Wc||(Wc=!0,jg(ce,function(){return so(),null})),y=(o.flags&15990)!==0,(o.subtreeFlags&15990)!==0||y){y=jr.transition,jr.transition=null;var x=rt;rt=1;var j=gt;gt|=4,_h.current=null,wx(r,o),_g(o,r),Hw(Pd),oi=!!bd,Pd=bd=null,r.current=o,xx(o),E(),gt=j,rt=x,jr.transition=y}else r.current=o;if(Wc&&(Wc=!1,vi=r,Gc=p),y=r.pendingLanes,y===0&&(yi=null),L(o.stateNode),fr(r,H()),i!==null)for(h=r.onRecoverableError,o=0;o<i.length;o++)p=i[o],h(p.value,{componentStack:p.stack,digest:p.digest});if($c)throw $c=!1,r=Eh,Eh=null,r;return(Gc&1)!==0&&r.tag!==0&&so(),y=r.pendingLanes,(y&1)!==0?r===Th?ll++:(ll=0,Th=r):ll=0,fi(),null}function so(){if(vi!==null){var r=us(Gc),i=jr.transition,o=rt;try{if(jr.transition=null,rt=16>r?16:r,vi===null)var h=!1;else{if(r=vi,vi=null,Gc=0,(gt&6)!==0)throw Error(t(331));var p=gt;for(gt|=4,je=r.current;je!==null;){var y=je,x=y.child;if((je.flags&16)!==0){var j=y.deletions;if(j!==null){for(var z=0;z<j.length;z++){var Z=j[z];for(je=Z;je!==null;){var de=je;switch(de.tag){case 0:case 11:case 15:il(8,de,y)}var fe=de.child;if(fe!==null)fe.return=de,je=fe;else for(;je!==null;){de=je;var ue=de.sibling,Ne=de.return;if(pg(de),de===Z){je=null;break}if(ue!==null){ue.return=Ne,je=ue;break}je=Ne}}}var De=y.alternate;if(De!==null){var Le=De.child;if(Le!==null){De.child=null;do{var qt=Le.sibling;Le.sibling=null,Le=qt}while(Le!==null)}}je=y}}if((y.subtreeFlags&2064)!==0&&x!==null)x.return=y,je=x;else e:for(;je!==null;){if(y=je,(y.flags&2048)!==0)switch(y.tag){case 0:case 11:case 15:il(9,y,y.return)}var Q=y.sibling;if(Q!==null){Q.return=y.return,je=Q;break e}je=y.return}}var G=r.current;for(je=G;je!==null;){x=je;var J=x.child;if((x.subtreeFlags&2064)!==0&&J!==null)J.return=x,je=J;else e:for(x=G;je!==null;){if(j=je,(j.flags&2048)!==0)try{switch(j.tag){case 0:case 11:case 15:Uc(9,j)}}catch(Ue){Gt(j,j.return,Ue)}if(j===x){je=null;break e}var we=j.sibling;if(we!==null){we.return=j.return,je=we;break e}je=j.return}}if(gt=p,fi(),T&&typeof T.onPostCommitFiberRoot=="function")try{T.onPostCommitFiberRoot(Ce,r)}catch{}h=!0}return h}finally{rt=o,jr.transition=i}}return!1}function Ng(r,i,o){i=eo(o,i),i=Km(r,i,1),r=mi(r,i,1),i=nr(),r!==null&&(Zn(r,1,i),fr(r,i))}function Gt(r,i,o){if(r.tag===3)Ng(r,r,o);else for(;i!==null;){if(i.tag===3){Ng(i,r,o);break}else if(i.tag===1){var h=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(yi===null||!yi.has(h))){r=eo(o,r),r=Qm(i,r,1),i=mi(i,r,1),r=nr(),i!==null&&(Zn(i,1,r),fr(i,r));break}}i=i.return}}function bx(r,i,o){var h=r.pingCache;h!==null&&h.delete(i),i=nr(),r.pingedLanes|=r.suspendedLanes&o,En===r&&(An&o)===o&&(hn===4||hn===3&&(An&130023424)===An&&500>H()-xh?ca(r,0):wh|=o),fr(r,i)}function Ag(r,i){i===0&&((r.mode&1)===0?i=1:(i=Ze,Ze<<=1,(Ze&130023424)===0&&(Ze=4194304)));var o=nr();r=zs(r,i),r!==null&&(Zn(r,i,o),fr(r,o))}function Px(r){var i=r.memoizedState,o=0;i!==null&&(o=i.retryLane),Ag(r,o)}function Rx(r,i){var o=0;switch(r.tag){case 13:var h=r.stateNode,p=r.memoizedState;p!==null&&(o=p.retryLane);break;case 19:h=r.stateNode;break;default:throw Error(t(314))}h!==null&&h.delete(i),Ag(r,o)}var kg;kg=function(r,i,o){if(r!==null)if(r.memoizedProps!==i.pendingProps||cr.current)dr=!0;else{if((r.lanes&o)===0&&(i.flags&128)===0)return dr=!1,gx(r,i,o);dr=(r.flags&131072)!==0}else dr=!1,Ft&&(i.flags&1048576)!==0&&dm(i,Tc,i.index);switch(i.lanes=0,i.tag){case 2:var h=i.type;Mc(r,i),r=i.pendingProps;var p=Ha(i,Fn.current);Xa(i,o),p=Xd(null,i,h,r,p,o);var y=Zd();return i.flags|=1,typeof p=="object"&&p!==null&&typeof p.render=="function"&&p.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,ur(h)?(y=!0,wc(i)):y=!1,i.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,Gd(i),p.updater=Lc,i.stateNode=p,p._reactInternals=i,ih(i,h,r,o),i=ch(null,i,h,!0,y,o)):(i.tag=0,Ft&&y&&Vd(i),tr(null,i,p,o),i=i.child),i;case 16:h=i.elementType;e:{switch(Mc(r,i),r=i.pendingProps,p=h._init,h=p(h._payload),i.type=h,p=i.tag=Ax(h),r=Qr(h,r),p){case 0:i=lh(null,i,h,r,o);break e;case 1:i=sg(null,i,h,r,o);break e;case 11:i=Zm(null,i,h,r,o);break e;case 14:i=eg(null,i,h,Qr(h.type,r),o);break e}throw Error(t(306,h,""))}return i;case 0:return h=i.type,p=i.pendingProps,p=i.elementType===h?p:Qr(h,p),lh(r,i,h,p,o);case 1:return h=i.type,p=i.pendingProps,p=i.elementType===h?p:Qr(h,p),sg(r,i,h,p,o);case 3:e:{if(ig(i),r===null)throw Error(t(387));h=i.pendingProps,y=i.memoizedState,p=y.element,wm(r,i),Rc(i,h,null,o);var x=i.memoizedState;if(h=x.element,y.isDehydrated)if(y={element:h,isDehydrated:!1,cache:x.cache,pendingSuspenseBoundaries:x.pendingSuspenseBoundaries,transitions:x.transitions},i.updateQueue.baseState=y,i.memoizedState=y,i.flags&256){p=eo(Error(t(423)),i),i=ag(r,i,h,o,p);break e}else if(h!==p){p=eo(Error(t(424)),i),i=ag(r,i,h,o,p);break e}else for(Er=ui(i.stateNode.containerInfo.firstChild),xr=i,Ft=!0,Kr=null,o=vm(i,null,h,o),i.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(Qa(),h===p){i=$s(r,i,o);break e}tr(r,i,h,o)}i=i.child}return i;case 5:return Tm(i),r===null&&Md(i),h=i.type,p=i.pendingProps,y=r!==null?r.memoizedProps:null,x=p.children,Rd(h,p)?x=null:y!==null&&Rd(h,y)&&(i.flags|=32),rg(r,i),tr(r,i,x,o),i.child;case 6:return r===null&&Md(i),null;case 13:return og(r,i,o);case 4:return Hd(i,i.stateNode.containerInfo),h=i.pendingProps,r===null?i.child=Ya(i,null,h,o):tr(r,i,h,o),i.child;case 11:return h=i.type,p=i.pendingProps,p=i.elementType===h?p:Qr(h,p),Zm(r,i,h,p,o);case 7:return tr(r,i,i.pendingProps,o),i.child;case 8:return tr(r,i,i.pendingProps.children,o),i.child;case 12:return tr(r,i,i.pendingProps.children,o),i.child;case 10:e:{if(h=i.type._context,p=i.pendingProps,y=i.memoizedProps,x=p.value,At(Cc,h._currentValue),h._currentValue=x,y!==null)if(qr(y.value,x)){if(y.children===p.children&&!cr.current){i=$s(r,i,o);break e}}else for(y=i.child,y!==null&&(y.return=i);y!==null;){var j=y.dependencies;if(j!==null){x=y.child;for(var z=j.firstContext;z!==null;){if(z.context===h){if(y.tag===1){z=Bs(-1,o&-o),z.tag=2;var Z=y.updateQueue;if(Z!==null){Z=Z.shared;var de=Z.pending;de===null?z.next=z:(z.next=de.next,de.next=z),Z.pending=z}}y.lanes|=o,z=y.alternate,z!==null&&(z.lanes|=o),$d(y.return,o,i),j.lanes|=o;break}z=z.next}}else if(y.tag===10)x=y.type===i.type?null:y.child;else if(y.tag===18){if(x=y.return,x===null)throw Error(t(341));x.lanes|=o,j=x.alternate,j!==null&&(j.lanes|=o),$d(x,o,i),x=y.sibling}else x=y.child;if(x!==null)x.return=y;else for(x=y;x!==null;){if(x===i){x=null;break}if(y=x.sibling,y!==null){y.return=x.return,x=y;break}x=x.return}y=x}tr(r,i,p.children,o),i=i.child}return i;case 9:return p=i.type,h=i.pendingProps.children,Xa(i,o),p=Ar(p),h=h(p),i.flags|=1,tr(r,i,h,o),i.child;case 14:return h=i.type,p=Qr(h,i.pendingProps),p=Qr(h.type,p),eg(r,i,h,p,o);case 15:return tg(r,i,i.type,i.pendingProps,o);case 17:return h=i.type,p=i.pendingProps,p=i.elementType===h?p:Qr(h,p),Mc(r,i),i.tag=1,ur(h)?(r=!0,wc(i)):r=!1,Xa(i,o),Hm(i,h,p),ih(i,h,p,o),ch(null,i,h,!0,r,o);case 19:return cg(r,i,o);case 22:return ng(r,i,o)}throw Error(t(156,i.tag))};function jg(r,i){return lt(r,i)}function Nx(r,i,o,h){this.tag=r,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Dr(r,i,o,h){return new Nx(r,i,o,h)}function Rh(r){return r=r.prototype,!(!r||!r.isReactComponent)}function Ax(r){if(typeof r=="function")return Rh(r)?1:0;if(r!=null){if(r=r.$$typeof,r===V)return 11;if(r===ve)return 14}return 2}function xi(r,i){var o=r.alternate;return o===null?(o=Dr(r.tag,i,r.key,r.mode),o.elementType=r.elementType,o.type=r.type,o.stateNode=r.stateNode,o.alternate=r,r.alternate=o):(o.pendingProps=i,o.type=r.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=r.flags&14680064,o.childLanes=r.childLanes,o.lanes=r.lanes,o.child=r.child,o.memoizedProps=r.memoizedProps,o.memoizedState=r.memoizedState,o.updateQueue=r.updateQueue,i=r.dependencies,o.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},o.sibling=r.sibling,o.index=r.index,o.ref=r.ref,o}function Qc(r,i,o,h,p,y){var x=2;if(h=r,typeof r=="function")Rh(r)&&(x=1);else if(typeof r=="string")x=5;else e:switch(r){case k:return da(o.children,p,y,i);case P:x=8,p|=8;break;case R:return r=Dr(12,o,i,p|2),r.elementType=R,r.lanes=y,r;case b:return r=Dr(13,o,i,p),r.elementType=b,r.lanes=y,r;case he:return r=Dr(19,o,i,p),r.elementType=he,r.lanes=y,r;case Ve:return Yc(o,p,y,i);default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case M:x=10;break e;case B:x=9;break e;case V:x=11;break e;case ve:x=14;break e;case ot:x=16,h=null;break e}throw Error(t(130,r==null?r:typeof r,""))}return i=Dr(x,o,i,p),i.elementType=r,i.type=h,i.lanes=y,i}function da(r,i,o,h){return r=Dr(7,r,h,i),r.lanes=o,r}function Yc(r,i,o,h){return r=Dr(22,r,h,i),r.elementType=Ve,r.lanes=o,r.stateNode={isHidden:!1},r}function Nh(r,i,o){return r=Dr(6,r,null,i),r.lanes=o,r}function Ah(r,i,o){return i=Dr(4,r.children!==null?r.children:[],r.key,i),i.lanes=o,i.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},i}function kx(r,i,o,h,p){this.tag=i,this.containerInfo=r,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=it(0),this.expirationTimes=it(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=it(0),this.identifierPrefix=h,this.onRecoverableError=p,this.mutableSourceEagerHydrationData=null}function kh(r,i,o,h,p,y,x,j,z){return r=new kx(r,i,o,j,z),i===1?(i=1,y===!0&&(i|=8)):i=0,y=Dr(3,null,null,i),r.current=y,y.stateNode=r,y.memoizedState={element:h,isDehydrated:o,cache:null,transitions:null,pendingSuspenseBoundaries:null},Gd(y),r}function jx(r,i,o){var h=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ee,key:h==null?null:""+h,children:r,containerInfo:i,implementation:o}}function Dg(r){if(!r)return hi;r=r._reactInternals;e:{if(Yn(r)!==r||r.tag!==1)throw Error(t(170));var i=r;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(ur(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(t(171))}if(r.tag===1){var o=r.type;if(ur(o))return lm(r,o,i)}return i}function Vg(r,i,o,h,p,y,x,j,z){return r=kh(o,h,!0,r,p,y,x,j,z),r.context=Dg(null),o=r.current,h=nr(),p=_i(o),y=Bs(h,p),y.callback=i??null,mi(o,y,p),r.current.lanes=p,Zn(r,p,h),fr(r,h),r}function Jc(r,i,o,h){var p=i.current,y=nr(),x=_i(p);return o=Dg(o),i.context===null?i.context=o:i.pendingContext=o,i=Bs(y,x),i.payload={element:r},h=h===void 0?null:h,h!==null&&(i.callback=h),r=mi(p,i,x),r!==null&&(Xr(r,p,x,y),Pc(r,p,x)),x}function Xc(r){if(r=r.current,!r.child)return null;switch(r.child.tag){case 5:return r.child.stateNode;default:return r.child.stateNode}}function Lg(r,i){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var o=r.retryLane;r.retryLane=o!==0&&o<i?o:i}}function jh(r,i){Lg(r,i),(r=r.alternate)&&Lg(r,i)}function Dx(){return null}var Og=typeof reportError=="function"?reportError:function(r){console.error(r)};function Dh(r){this._internalRoot=r}Zc.prototype.render=Dh.prototype.render=function(r){var i=this._internalRoot;if(i===null)throw Error(t(409));Jc(r,i,null,null)},Zc.prototype.unmount=Dh.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var i=r.containerInfo;la(function(){Jc(null,r,null,null)}),i[Os]=null}};function Zc(r){this._internalRoot=r}Zc.prototype.unstable_scheduleHydration=function(r){if(r){var i=Pa();r={blockedOn:null,target:r,priority:i};for(var o=0;o<fs.length&&i!==0&&i<fs[o].priority;o++);fs.splice(o,0,r),o===0&&nc(r)}};function Vh(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function eu(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11&&(r.nodeType!==8||r.nodeValue!==" react-mount-point-unstable "))}function Mg(){}function Vx(r,i,o,h,p){if(p){if(typeof h=="function"){var y=h;h=function(){var Z=Xc(x);y.call(Z)}}var x=Vg(i,h,r,0,null,!1,!1,"",Mg);return r._reactRootContainer=x,r[Os]=x.current,Ho(r.nodeType===8?r.parentNode:r),la(),x}for(;p=r.lastChild;)r.removeChild(p);if(typeof h=="function"){var j=h;h=function(){var Z=Xc(z);j.call(Z)}}var z=kh(r,0,!1,null,null,!1,!1,"",Mg);return r._reactRootContainer=z,r[Os]=z.current,Ho(r.nodeType===8?r.parentNode:r),la(function(){Jc(i,z,o,h)}),z}function tu(r,i,o,h,p){var y=o._reactRootContainer;if(y){var x=y;if(typeof p=="function"){var j=p;p=function(){var z=Xc(x);j.call(z)}}Jc(i,x,r,p)}else x=Vx(o,i,r,p,h);return Xc(x)}ba=function(r){switch(r.tag){case 3:var i=r.stateNode;if(i.current.memoizedState.isDehydrated){var o=ct(i.pendingLanes);o!==0&&(Mn(i,o|1),fr(i,H()),(gt&6)===0&&(ro=H()+500,fi()))}break;case 13:la(function(){var h=zs(r,1);if(h!==null){var p=nr();Xr(h,r,1,p)}}),jh(r,1)}},ii=function(r){if(r.tag===13){var i=zs(r,134217728);if(i!==null){var o=nr();Xr(i,r,134217728,o)}jh(r,134217728)}},ds=function(r){if(r.tag===13){var i=_i(r),o=zs(r,i);if(o!==null){var h=nr();Xr(o,r,i,h)}jh(r,i)}},Pa=function(){return rt},ec=function(r,i){var o=rt;try{return rt=r,i()}finally{rt=o}},ar=function(r,i,o){switch(i){case"input":if(pt(r,o),i=o.name,o.type==="radio"&&i!=null){for(o=r;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<o.length;i++){var h=o[i];if(h!==r&&h.form===r.form){var p=vc(h);if(!p)throw Error(t(90));Fe(h),pt(h,p)}}}break;case"textarea":yn(r,o);break;case"select":i=o.value,i!=null&&In(r,!!o.multiple,i,!1)}},yt=Ch,ls=la;var Lx={usingClientEntryPoint:!1,Events:[Qo,Wa,vc,vn,os,Ch]},cl={findFiberByHostInstance:ea,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Ox={bundleType:cl.bundleType,version:cl.version,rendererPackageName:cl.rendererPackageName,rendererConfig:cl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ye.ReactCurrentDispatcher,findHostInstanceByFiber:function(r){return r=ks(r),r===null?null:r.stateNode},findFiberByHostInstance:cl.findFiberByHostInstance||Dx,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var nu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nu.isDisabled&&nu.supportsFiber)try{Ce=nu.inject(Ox),T=nu}catch{}}return pr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Lx,pr.createPortal=function(r,i){var o=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Vh(i))throw Error(t(200));return jx(r,i,null,o)},pr.createRoot=function(r,i){if(!Vh(r))throw Error(t(299));var o=!1,h="",p=Og;return i!=null&&(i.unstable_strictMode===!0&&(o=!0),i.identifierPrefix!==void 0&&(h=i.identifierPrefix),i.onRecoverableError!==void 0&&(p=i.onRecoverableError)),i=kh(r,1,!1,null,null,o,!1,h,p),r[Os]=i.current,Ho(r.nodeType===8?r.parentNode:r),new Dh(i)},pr.findDOMNode=function(r){if(r==null)return null;if(r.nodeType===1)return r;var i=r._reactInternals;if(i===void 0)throw typeof r.render=="function"?Error(t(188)):(r=Object.keys(r).join(","),Error(t(268,r)));return r=ks(i),r=r===null?null:r.stateNode,r},pr.flushSync=function(r){return la(r)},pr.hydrate=function(r,i,o){if(!eu(i))throw Error(t(200));return tu(null,r,i,!0,o)},pr.hydrateRoot=function(r,i,o){if(!Vh(r))throw Error(t(405));var h=o!=null&&o.hydratedSources||null,p=!1,y="",x=Og;if(o!=null&&(o.unstable_strictMode===!0&&(p=!0),o.identifierPrefix!==void 0&&(y=o.identifierPrefix),o.onRecoverableError!==void 0&&(x=o.onRecoverableError)),i=Vg(i,null,r,1,o??null,p,!1,y,x),r[Os]=i.current,Ho(r),h)for(r=0;r<h.length;r++)o=h[r],p=o._getVersion,p=p(o._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[o,p]:i.mutableSourceEagerHydrationData.push(o,p);return new Zc(i)},pr.render=function(r,i,o){if(!eu(i))throw Error(t(200));return tu(null,r,i,!1,o)},pr.unmountComponentAtNode=function(r){if(!eu(r))throw Error(t(40));return r._reactRootContainer?(la(function(){tu(null,null,r,!1,function(){r._reactRootContainer=null,r[Os]=null})}),!0):!1},pr.unstable_batchedUpdates=Ch,pr.unstable_renderSubtreeIntoContainer=function(r,i,o,h){if(!eu(o))throw Error(t(200));if(r==null||r._reactInternals===void 0)throw Error(t(38));return tu(r,i,o,!1,h)},pr.version="18.3.1-next-f1338f8080-20240426",pr}var Hg;function Hv(){if(Hg)return Mh.exports;Hg=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Mh.exports=Hx(),Mh.exports}var qg;function qx(){if(qg)return ru;qg=1;var n=Hv();return ru.createRoot=n.createRoot,ru.hydrateRoot=n.hydrateRoot,ru}var Kx=qx();const Qx=Gv(Kx);Hv();/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Pl(){return Pl=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},Pl.apply(this,arguments)}var bi;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(bi||(bi={}));const Kg="popstate";function Yx(n){n===void 0&&(n={});function e(s,a){let{pathname:l,search:d,hash:f}=s.location;return nf("",{pathname:l,search:d,hash:f},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(s,a){return typeof a=="string"?a:xu(a)}return Xx(e,t,null,n)}function Qt(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Df(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Jx(){return Math.random().toString(36).substr(2,8)}function Qg(n,e){return{usr:n.state,key:n.key,idx:e}}function nf(n,e,t,s){return t===void 0&&(t=null),Pl({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?To(e):e,{state:t,key:e&&e.key||s||Jx()})}function xu(n){let{pathname:e="/",search:t="",hash:s=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),s&&s!=="#"&&(e+=s.charAt(0)==="#"?s:"#"+s),e}function To(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let s=n.indexOf("?");s>=0&&(e.search=n.substr(s),n=n.substr(0,s)),n&&(e.pathname=n)}return e}function Xx(n,e,t,s){s===void 0&&(s={});let{window:a=document.defaultView,v5Compat:l=!1}=s,d=a.history,f=bi.Pop,m=null,v=w();v==null&&(v=0,d.replaceState(Pl({},d.state,{idx:v}),""));function w(){return(d.state||{idx:null}).idx}function S(){f=bi.Pop;let U=w(),ne=U==null?null:U-v;v=U,m&&m({action:f,location:q.location,delta:ne})}function C(U,ne){f=bi.Push;let xe=nf(q.location,U,ne);v=w()+1;let ge=Qg(xe,v),ye=q.createHref(xe);try{d.pushState(ge,"",ye)}catch(ie){if(ie instanceof DOMException&&ie.name==="DataCloneError")throw ie;a.location.assign(ye)}l&&m&&m({action:f,location:q.location,delta:1})}function $(U,ne){f=bi.Replace;let xe=nf(q.location,U,ne);v=w();let ge=Qg(xe,v),ye=q.createHref(xe);d.replaceState(ge,"",ye),l&&m&&m({action:f,location:q.location,delta:0})}function X(U){let ne=a.location.origin!=="null"?a.location.origin:a.location.href,xe=typeof U=="string"?U:xu(U);return xe=xe.replace(/ $/,"%20"),Qt(ne,"No window.location.(origin|href) available to create URL for href: "+xe),new URL(xe,ne)}let q={get action(){return f},get location(){return n(a,d)},listen(U){if(m)throw new Error("A history only accepts one active listener");return a.addEventListener(Kg,S),m=U,()=>{a.removeEventListener(Kg,S),m=null}},createHref(U){return e(a,U)},createURL:X,encodeLocation(U){let ne=X(U);return{pathname:ne.pathname,search:ne.search,hash:ne.hash}},push:C,replace:$,go(U){return d.go(U)}};return q}var Yg;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(Yg||(Yg={}));function Zx(n,e,t){return t===void 0&&(t="/"),eE(n,e,t)}function eE(n,e,t,s){let a=typeof e=="string"?To(e):e,l=Vf(a.pathname||"/",t);if(l==null)return null;let d=qv(n);tE(d);let f=null;for(let m=0;f==null&&m<d.length;++m){let v=fE(l);f=uE(d[m],v)}return f}function qv(n,e,t,s){e===void 0&&(e=[]),t===void 0&&(t=[]),s===void 0&&(s="");let a=(l,d,f)=>{let m={relativePath:f===void 0?l.path||"":f,caseSensitive:l.caseSensitive===!0,childrenIndex:d,route:l};m.relativePath.startsWith("/")&&(Qt(m.relativePath.startsWith(s),'Absolute route path "'+m.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),m.relativePath=m.relativePath.slice(s.length));let v=Ni([s,m.relativePath]),w=t.concat(m);l.children&&l.children.length>0&&(Qt(l.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+v+'".')),qv(l.children,e,w,v)),!(l.path==null&&!l.index)&&e.push({path:v,score:lE(v,l.index),routesMeta:w})};return n.forEach((l,d)=>{var f;if(l.path===""||!((f=l.path)!=null&&f.includes("?")))a(l,d);else for(let m of Kv(l.path))a(l,d,m)}),e}function Kv(n){let e=n.split("/");if(e.length===0)return[];let[t,...s]=e,a=t.endsWith("?"),l=t.replace(/\?$/,"");if(s.length===0)return a?[l,""]:[l];let d=Kv(s.join("/")),f=[];return f.push(...d.map(m=>m===""?l:[l,m].join("/"))),a&&f.push(...d),f.map(m=>n.startsWith("/")&&m===""?"/":m)}function tE(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:cE(e.routesMeta.map(s=>s.childrenIndex),t.routesMeta.map(s=>s.childrenIndex)))}const nE=/^:[\w-]+$/,rE=3,sE=2,iE=1,aE=10,oE=-2,Jg=n=>n==="*";function lE(n,e){let t=n.split("/"),s=t.length;return t.some(Jg)&&(s+=oE),e&&(s+=sE),t.filter(a=>!Jg(a)).reduce((a,l)=>a+(nE.test(l)?rE:l===""?iE:aE),s)}function cE(n,e){return n.length===e.length&&n.slice(0,-1).every((s,a)=>s===e[a])?n[n.length-1]-e[e.length-1]:0}function uE(n,e,t){let{routesMeta:s}=n,a={},l="/",d=[];for(let f=0;f<s.length;++f){let m=s[f],v=f===s.length-1,w=l==="/"?e:e.slice(l.length)||"/",S=dE({path:m.relativePath,caseSensitive:m.caseSensitive,end:v},w),C=m.route;if(!S)return null;Object.assign(a,S.params),d.push({params:a,pathname:Ni([l,S.pathname]),pathnameBase:vE(Ni([l,S.pathnameBase])),route:C}),S.pathnameBase!=="/"&&(l=Ni([l,S.pathnameBase]))}return d}function dE(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,s]=hE(n.path,n.caseSensitive,n.end),a=e.match(t);if(!a)return null;let l=a[0],d=l.replace(/(.)\/+$/,"$1"),f=a.slice(1);return{params:s.reduce((v,w,S)=>{let{paramName:C,isOptional:$}=w;if(C==="*"){let q=f[S]||"";d=l.slice(0,l.length-q.length).replace(/(.)\/+$/,"$1")}const X=f[S];return $&&!X?v[C]=void 0:v[C]=(X||"").replace(/%2F/g,"/"),v},{}),pathname:l,pathnameBase:d,pattern:n}}function hE(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),Df(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let s=[],a="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,f,m)=>(s.push({paramName:f,isOptional:m!=null}),m?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(s.push({paramName:"*"}),a+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?a+="\\/*$":n!==""&&n!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),s]}function fE(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Df(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function Vf(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,s=n.charAt(t);return s&&s!=="/"?null:n.slice(t)||"/"}const pE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,mE=n=>pE.test(n);function gE(n,e){e===void 0&&(e="/");let{pathname:t,search:s="",hash:a=""}=typeof n=="string"?To(n):n,l;if(t)if(mE(t))l=t;else{if(t.includes("//")){let d=t;t=t.replace(/\/\/+/g,"/"),Df(!1,"Pathnames cannot have embedded double slashes - normalizing "+(d+" -> "+t))}t.startsWith("/")?l=Xg(t.substring(1),"/"):l=Xg(t,e)}else l=e;return{pathname:l,search:_E(s),hash:wE(a)}}function Xg(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(a=>{a===".."?t.length>1&&t.pop():a!=="."&&t.push(a)}),t.length>1?t.join("/"):"/"}function zh(n,e,t,s){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function yE(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Lf(n,e){let t=yE(n);return e?t.map((s,a)=>a===t.length-1?s.pathname:s.pathnameBase):t.map(s=>s.pathnameBase)}function Of(n,e,t,s){s===void 0&&(s=!1);let a;typeof n=="string"?a=To(n):(a=Pl({},n),Qt(!a.pathname||!a.pathname.includes("?"),zh("?","pathname","search",a)),Qt(!a.pathname||!a.pathname.includes("#"),zh("#","pathname","hash",a)),Qt(!a.search||!a.search.includes("#"),zh("#","search","hash",a)));let l=n===""||a.pathname==="",d=l?"/":a.pathname,f;if(d==null)f=t;else{let S=e.length-1;if(!s&&d.startsWith("..")){let C=d.split("/");for(;C[0]==="..";)C.shift(),S-=1;a.pathname=C.join("/")}f=S>=0?e[S]:"/"}let m=gE(a,f),v=d&&d!=="/"&&d.endsWith("/"),w=(l||d===".")&&t.endsWith("/");return!m.pathname.endsWith("/")&&(v||w)&&(m.pathname+="/"),m}const Ni=n=>n.join("/").replace(/\/\/+/g,"/"),vE=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),_E=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,wE=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function xE(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const Qv=["post","put","patch","delete"];new Set(Qv);const EE=["get",...Qv];new Set(EE);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Rl(){return Rl=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},Rl.apply(this,arguments)}const Mf=D.createContext(null),TE=D.createContext(null),$i=D.createContext(null),zu=D.createContext(null),Wi=D.createContext({outlet:null,matches:[],isDataRoute:!1}),Yv=D.createContext(null);function SE(n,e){let{relative:t}=e===void 0?{}:e;So()||Qt(!1);let{basename:s,navigator:a}=D.useContext($i),{hash:l,pathname:d,search:f}=Xv(n,{relative:t}),m=d;return s!=="/"&&(m=d==="/"?s:Ni([s,d])),a.createHref({pathname:m,search:f,hash:l})}function So(){return D.useContext(zu)!=null}function Ul(){return So()||Qt(!1),D.useContext(zu).location}function Jv(n){D.useContext($i).static||D.useLayoutEffect(n)}function Bu(){let{isDataRoute:n}=D.useContext(Wi);return n?OE():IE()}function IE(){So()||Qt(!1);let n=D.useContext(Mf),{basename:e,future:t,navigator:s}=D.useContext($i),{matches:a}=D.useContext(Wi),{pathname:l}=Ul(),d=JSON.stringify(Lf(a,t.v7_relativeSplatPath)),f=D.useRef(!1);return Jv(()=>{f.current=!0}),D.useCallback(function(v,w){if(w===void 0&&(w={}),!f.current)return;if(typeof v=="number"){s.go(v);return}let S=Of(v,JSON.parse(d),l,w.relative==="path");n==null&&e!=="/"&&(S.pathname=S.pathname==="/"?e:Ni([e,S.pathname])),(w.replace?s.replace:s.push)(S,w.state,w)},[e,s,d,l,n])}function Xv(n,e){let{relative:t}=e===void 0?{}:e,{future:s}=D.useContext($i),{matches:a}=D.useContext(Wi),{pathname:l}=Ul(),d=JSON.stringify(Lf(a,s.v7_relativeSplatPath));return D.useMemo(()=>Of(n,JSON.parse(d),l,t==="path"),[n,d,l,t])}function CE(n,e){return bE(n,e)}function bE(n,e,t,s){So()||Qt(!1);let{navigator:a}=D.useContext($i),{matches:l}=D.useContext(Wi),d=l[l.length-1],f=d?d.params:{};d&&d.pathname;let m=d?d.pathnameBase:"/";d&&d.route;let v=Ul(),w;if(e){var S;let U=typeof e=="string"?To(e):e;m==="/"||(S=U.pathname)!=null&&S.startsWith(m)||Qt(!1),w=U}else w=v;let C=w.pathname||"/",$=C;if(m!=="/"){let U=m.replace(/^\//,"").split("/");$="/"+C.replace(/^\//,"").split("/").slice(U.length).join("/")}let X=Zx(n,{pathname:$}),q=kE(X&&X.map(U=>Object.assign({},U,{params:Object.assign({},f,U.params),pathname:Ni([m,a.encodeLocation?a.encodeLocation(U.pathname).pathname:U.pathname]),pathnameBase:U.pathnameBase==="/"?m:Ni([m,a.encodeLocation?a.encodeLocation(U.pathnameBase).pathname:U.pathnameBase])})),l,t,s);return e&&q?D.createElement(zu.Provider,{value:{location:Rl({pathname:"/",search:"",hash:"",state:null,key:"default"},w),navigationType:bi.Pop}},q):q}function PE(){let n=LE(),e=xE(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return D.createElement(D.Fragment,null,D.createElement("h2",null,"Unexpected Application Error!"),D.createElement("h3",{style:{fontStyle:"italic"}},e),t?D.createElement("pre",{style:a},t):null,null)}const RE=D.createElement(PE,null);class NE extends D.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?D.createElement(Wi.Provider,{value:this.props.routeContext},D.createElement(Yv.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function AE(n){let{routeContext:e,match:t,children:s}=n,a=D.useContext(Mf);return a&&a.static&&a.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=t.route.id),D.createElement(Wi.Provider,{value:e},s)}function kE(n,e,t,s){var a;if(e===void 0&&(e=[]),t===void 0&&(t=null),s===void 0&&(s=null),n==null){var l;if(!t)return null;if(t.errors)n=t.matches;else if((l=s)!=null&&l.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let d=n,f=(a=t)==null?void 0:a.errors;if(f!=null){let w=d.findIndex(S=>S.route.id&&(f==null?void 0:f[S.route.id])!==void 0);w>=0||Qt(!1),d=d.slice(0,Math.min(d.length,w+1))}let m=!1,v=-1;if(t&&s&&s.v7_partialHydration)for(let w=0;w<d.length;w++){let S=d[w];if((S.route.HydrateFallback||S.route.hydrateFallbackElement)&&(v=w),S.route.id){let{loaderData:C,errors:$}=t,X=S.route.loader&&C[S.route.id]===void 0&&(!$||$[S.route.id]===void 0);if(S.route.lazy||X){m=!0,v>=0?d=d.slice(0,v+1):d=[d[0]];break}}}return d.reduceRight((w,S,C)=>{let $,X=!1,q=null,U=null;t&&($=f&&S.route.id?f[S.route.id]:void 0,q=S.route.errorElement||RE,m&&(v<0&&C===0?(ME("route-fallback"),X=!0,U=null):v===C&&(X=!0,U=S.route.hydrateFallbackElement||null)));let ne=e.concat(d.slice(0,C+1)),xe=()=>{let ge;return $?ge=q:X?ge=U:S.route.Component?ge=D.createElement(S.route.Component,null):S.route.element?ge=S.route.element:ge=w,D.createElement(AE,{match:S,routeContext:{outlet:w,matches:ne,isDataRoute:t!=null},children:ge})};return t&&(S.route.ErrorBoundary||S.route.errorElement||C===0)?D.createElement(NE,{location:t.location,revalidation:t.revalidation,component:q,error:$,children:xe(),routeContext:{outlet:null,matches:ne,isDataRoute:!0}}):xe()},null)}var Zv=(function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n})(Zv||{}),e_=(function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n})(e_||{});function jE(n){let e=D.useContext(Mf);return e||Qt(!1),e}function DE(n){let e=D.useContext(TE);return e||Qt(!1),e}function VE(n){let e=D.useContext(Wi);return e||Qt(!1),e}function t_(n){let e=VE(),t=e.matches[e.matches.length-1];return t.route.id||Qt(!1),t.route.id}function LE(){var n;let e=D.useContext(Yv),t=DE(),s=t_();return e!==void 0?e:(n=t.errors)==null?void 0:n[s]}function OE(){let{router:n}=jE(Zv.UseNavigateStable),e=t_(e_.UseNavigateStable),t=D.useRef(!1);return Jv(()=>{t.current=!0}),D.useCallback(function(a,l){l===void 0&&(l={}),t.current&&(typeof a=="number"?n.navigate(a):n.navigate(a,Rl({fromRouteId:e},l)))},[n,e])}const Zg={};function ME(n,e,t){Zg[n]||(Zg[n]=!0)}function FE(n,e){n==null||n.v7_startTransition,n==null||n.v7_relativeSplatPath}function UE(n){let{to:e,replace:t,state:s,relative:a}=n;So()||Qt(!1);let{future:l,static:d}=D.useContext($i),{matches:f}=D.useContext(Wi),{pathname:m}=Ul(),v=Bu(),w=Of(e,Lf(f,l.v7_relativeSplatPath),m,a==="path"),S=JSON.stringify(w);return D.useEffect(()=>v(JSON.parse(S),{replace:t,state:s,relative:a}),[v,S,a,t,s]),null}function Zr(n){Qt(!1)}function zE(n){let{basename:e="/",children:t=null,location:s,navigationType:a=bi.Pop,navigator:l,static:d=!1,future:f}=n;So()&&Qt(!1);let m=e.replace(/^\/*/,"/"),v=D.useMemo(()=>({basename:m,navigator:l,static:d,future:Rl({v7_relativeSplatPath:!1},f)}),[m,f,l,d]);typeof s=="string"&&(s=To(s));let{pathname:w="/",search:S="",hash:C="",state:$=null,key:X="default"}=s,q=D.useMemo(()=>{let U=Vf(w,m);return U==null?null:{location:{pathname:U,search:S,hash:C,state:$,key:X},navigationType:a}},[m,w,S,C,$,X,a]);return q==null?null:D.createElement($i.Provider,{value:v},D.createElement(zu.Provider,{children:t,value:q}))}function BE(n){let{children:e,location:t}=n;return CE(rf(e),t)}new Promise(()=>{});function rf(n,e){e===void 0&&(e=[]);let t=[];return D.Children.forEach(n,(s,a)=>{if(!D.isValidElement(s))return;let l=[...e,a];if(s.type===D.Fragment){t.push.apply(t,rf(s.props.children,l));return}s.type!==Zr&&Qt(!1),!s.props.index||!s.props.children||Qt(!1);let d={id:s.props.id||l.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(d.children=rf(s.props.children,l)),t.push(d)}),t}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function sf(){return sf=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},sf.apply(this,arguments)}function $E(n,e){if(n==null)return{};var t={},s=Object.keys(n),a,l;for(l=0;l<s.length;l++)a=s[l],!(e.indexOf(a)>=0)&&(t[a]=n[a]);return t}function WE(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function GE(n,e){return n.button===0&&(!e||e==="_self")&&!WE(n)}const HE=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],qE="6";try{window.__reactRouterVersion=qE}catch{}const KE="startTransition",ey=$x[KE];function QE(n){let{basename:e,children:t,future:s,window:a}=n,l=D.useRef();l.current==null&&(l.current=Yx({window:a,v5Compat:!0}));let d=l.current,[f,m]=D.useState({action:d.action,location:d.location}),{v7_startTransition:v}=s||{},w=D.useCallback(S=>{v&&ey?ey(()=>m(S)):m(S)},[m,v]);return D.useLayoutEffect(()=>d.listen(w),[d,w]),D.useEffect(()=>FE(s),[s]),D.createElement(zE,{basename:e,children:t,location:f.location,navigationType:f.action,navigator:d,future:s})}const YE=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",JE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ha=D.forwardRef(function(e,t){let{onClick:s,relative:a,reloadDocument:l,replace:d,state:f,target:m,to:v,preventScrollReset:w,viewTransition:S}=e,C=$E(e,HE),{basename:$}=D.useContext($i),X,q=!1;if(typeof v=="string"&&JE.test(v)&&(X=v,YE))try{let ge=new URL(window.location.href),ye=v.startsWith("//")?new URL(ge.protocol+v):new URL(v),ie=Vf(ye.pathname,$);ye.origin===ge.origin&&ie!=null?v=ie+ye.search+ye.hash:q=!0}catch{}let U=SE(v,{relative:a}),ne=XE(v,{replace:d,state:f,target:m,preventScrollReset:w,relative:a,viewTransition:S});function xe(ge){s&&s(ge),ge.defaultPrevented||ne(ge)}return D.createElement("a",sf({},C,{href:X||U,onClick:q||l?s:xe,ref:t,target:m}))});var ty;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(ty||(ty={}));var ny;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(ny||(ny={}));function XE(n,e){let{target:t,replace:s,state:a,preventScrollReset:l,relative:d,viewTransition:f}=e===void 0?{}:e,m=Bu(),v=Ul(),w=Xv(n,{relative:d});return D.useCallback(S=>{if(GE(S,t)){S.preventDefault();let C=s!==void 0?s:xu(v)===xu(w);m(n,{replace:C,state:a,preventScrollReset:l,relative:d,viewTransition:f})}},[v,m,w,s,a,t,n,l,d,f])}const ZE=()=>{};var ry={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n_=function(n){const e=[];let t=0;for(let s=0;s<n.length;s++){let a=n.charCodeAt(s);a<128?e[t++]=a:a<2048?(e[t++]=a>>6|192,e[t++]=a&63|128):(a&64512)===55296&&s+1<n.length&&(n.charCodeAt(s+1)&64512)===56320?(a=65536+((a&1023)<<10)+(n.charCodeAt(++s)&1023),e[t++]=a>>18|240,e[t++]=a>>12&63|128,e[t++]=a>>6&63|128,e[t++]=a&63|128):(e[t++]=a>>12|224,e[t++]=a>>6&63|128,e[t++]=a&63|128)}return e},eT=function(n){const e=[];let t=0,s=0;for(;t<n.length;){const a=n[t++];if(a<128)e[s++]=String.fromCharCode(a);else if(a>191&&a<224){const l=n[t++];e[s++]=String.fromCharCode((a&31)<<6|l&63)}else if(a>239&&a<365){const l=n[t++],d=n[t++],f=n[t++],m=((a&7)<<18|(l&63)<<12|(d&63)<<6|f&63)-65536;e[s++]=String.fromCharCode(55296+(m>>10)),e[s++]=String.fromCharCode(56320+(m&1023))}else{const l=n[t++],d=n[t++];e[s++]=String.fromCharCode((a&15)<<12|(l&63)<<6|d&63)}}return e.join("")},r_={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let a=0;a<n.length;a+=3){const l=n[a],d=a+1<n.length,f=d?n[a+1]:0,m=a+2<n.length,v=m?n[a+2]:0,w=l>>2,S=(l&3)<<4|f>>4;let C=(f&15)<<2|v>>6,$=v&63;m||($=64,d||(C=64)),s.push(t[w],t[S],t[C],t[$])}return s.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(n_(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):eT(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let a=0;a<n.length;){const l=t[n.charAt(a++)],f=a<n.length?t[n.charAt(a)]:0;++a;const v=a<n.length?t[n.charAt(a)]:64;++a;const S=a<n.length?t[n.charAt(a)]:64;if(++a,l==null||f==null||v==null||S==null)throw new tT;const C=l<<2|f>>4;if(s.push(C),v!==64){const $=f<<4&240|v>>2;if(s.push($),S!==64){const X=v<<6&192|S;s.push(X)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class tT extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const nT=function(n){const e=n_(n);return r_.encodeByteArray(e,!0)},Eu=function(n){return nT(n).replace(/\./g,"")},s_=function(n){try{return r_.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rT(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sT=()=>rT().__FIREBASE_DEFAULTS__,iT=()=>{if(typeof process>"u"||typeof ry>"u")return;const n=ry.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},aT=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&s_(n[1]);return e&&JSON.parse(e)},$u=()=>{try{return ZE()||sT()||iT()||aT()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},i_=n=>{var e,t;return(t=(e=$u())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},oT=n=>{const e=i_(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),s]:[e.substring(0,t),s]},a_=()=>{var n;return(n=$u())===null||n===void 0?void 0:n.config},o_=n=>{var e;return(e=$u())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lT{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,s)=>{t?this.reject(t):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,s))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Io(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function l_(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cT(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},s=e||"demo-project",a=n.iat||0,l=n.sub||n.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d=Object.assign({iss:`https://securetoken.google.com/${s}`,aud:s,iat:a,exp:a+3600,auth_time:a,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Eu(JSON.stringify(t)),Eu(JSON.stringify(d)),""].join(".")}const xl={};function uT(){const n={prod:[],emulator:[]};for(const e of Object.keys(xl))xl[e]?n.emulator.push(e):n.prod.push(e);return n}function dT(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let sy=!1;function c_(n,e){if(typeof window>"u"||typeof document>"u"||!Io(window.location.host)||xl[n]===e||xl[n]||sy)return;xl[n]=e;function t(C){return`__firebase__banner__${C}`}const s="__firebase__banner",l=uT().prod.length>0;function d(){const C=document.getElementById(s);C&&C.remove()}function f(C){C.style.display="flex",C.style.background="#7faaf0",C.style.position="fixed",C.style.bottom="5px",C.style.left="5px",C.style.padding=".5em",C.style.borderRadius="5px",C.style.alignItems="center"}function m(C,$){C.setAttribute("width","24"),C.setAttribute("id",$),C.setAttribute("height","24"),C.setAttribute("viewBox","0 0 24 24"),C.setAttribute("fill","none"),C.style.marginLeft="-6px"}function v(){const C=document.createElement("span");return C.style.cursor="pointer",C.style.marginLeft="16px",C.style.fontSize="24px",C.innerHTML=" &times;",C.onclick=()=>{sy=!0,d()},C}function w(C,$){C.setAttribute("id",$),C.innerText="Learn more",C.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",C.setAttribute("target","__blank"),C.style.paddingLeft="5px",C.style.textDecoration="underline"}function S(){const C=dT(s),$=t("text"),X=document.getElementById($)||document.createElement("span"),q=t("learnmore"),U=document.getElementById(q)||document.createElement("a"),ne=t("preprendIcon"),xe=document.getElementById(ne)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(C.created){const ge=C.element;f(ge),w(U,q);const ye=v();m(xe,ne),ge.append(xe,X,U,ye),document.body.appendChild(ge)}l?(X.innerText="Preview backend disconnected.",xe.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(xe.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,X.innerText="Preview backend running in this workspace."),X.setAttribute("id",$)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",S):S()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function hT(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Hn())}function fT(){var n;const e=(n=$u())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function pT(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function mT(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function gT(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function yT(){const n=Hn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function vT(){return!fT()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function _T(){try{return typeof indexedDB=="object"}catch{return!1}}function wT(){return new Promise((n,e)=>{try{let t=!0;const s="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(s);a.onsuccess=()=>{a.result.close(),t||self.indexedDB.deleteDatabase(s),n(!0)},a.onupgradeneeded=()=>{t=!1},a.onerror=()=>{var l;e(((l=a.error)===null||l===void 0?void 0:l.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xT="FirebaseError";class ni extends Error{constructor(e,t,s){super(t),this.code=e,this.customData=s,this.name=xT,Object.setPrototypeOf(this,ni.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,zl.prototype.create)}}class zl{constructor(e,t,s){this.service=e,this.serviceName=t,this.errors=s}create(e,...t){const s=t[0]||{},a=`${this.service}/${e}`,l=this.errors[e],d=l?ET(l,s):"Error",f=`${this.serviceName}: ${d} (${a}).`;return new ni(a,f,s)}}function ET(n,e){return n.replace(TT,(t,s)=>{const a=e[s];return a!=null?String(a):`<${s}?>`})}const TT=/\{\$([^}]+)}/g;function ST(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function va(n,e){if(n===e)return!0;const t=Object.keys(n),s=Object.keys(e);for(const a of t){if(!s.includes(a))return!1;const l=n[a],d=e[a];if(iy(l)&&iy(d)){if(!va(l,d))return!1}else if(l!==d)return!1}for(const a of s)if(!t.includes(a))return!1;return!0}function iy(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bl(n){const e=[];for(const[t,s]of Object.entries(n))Array.isArray(s)?s.forEach(a=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function pl(n){const e={};return n.replace(/^\?/,"").split("&").forEach(s=>{if(s){const[a,l]=s.split("=");e[decodeURIComponent(a)]=decodeURIComponent(l)}}),e}function ml(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function IT(n,e){const t=new CT(n,e);return t.subscribe.bind(t)}class CT{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,s){let a;if(e===void 0&&t===void 0&&s===void 0)throw new Error("Missing Observer.");bT(e,["next","error","complete"])?a=e:a={next:e,error:t,complete:s},a.next===void 0&&(a.next=Bh),a.error===void 0&&(a.error=Bh),a.complete===void 0&&(a.complete=Bh);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function bT(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Bh(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sn(n){return n&&n._delegate?n._delegate:n}class _a{constructor(e,t,s){this.name=e,this.instanceFactory=t,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fa="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PT{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const s=new lT;if(this.instancesDeferred.set(t,s),this.isInitialized(t)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:t});a&&s.resolve(a)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const s=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),a=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(s)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:s})}catch(l){if(a)return null;throw l}else{if(a)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(NT(e))try{this.getOrInitializeService({instanceIdentifier:fa})}catch{}for(const[t,s]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(t);try{const l=this.getOrInitializeService({instanceIdentifier:a});s.resolve(l)}catch{}}}}clearInstance(e=fa){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=fa){return this.instances.has(e)}getOptions(e=fa){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:s,options:t});for(const[l,d]of this.instancesDeferred.entries()){const f=this.normalizeInstanceIdentifier(l);s===f&&d.resolve(a)}return a}onInit(e,t){var s;const a=this.normalizeInstanceIdentifier(t),l=(s=this.onInitCallbacks.get(a))!==null&&s!==void 0?s:new Set;l.add(e),this.onInitCallbacks.set(a,l);const d=this.instances.get(a);return d&&e(d,a),()=>{l.delete(e)}}invokeOnInitCallbacks(e,t){const s=this.onInitCallbacks.get(t);if(s)for(const a of s)try{a(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:RT(e),options:t}),this.instances.set(e,s),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=fa){return this.component?this.component.multipleInstances?e:fa:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function RT(n){return n===fa?void 0:n}function NT(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AT{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new PT(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ut;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(ut||(ut={}));const kT={debug:ut.DEBUG,verbose:ut.VERBOSE,info:ut.INFO,warn:ut.WARN,error:ut.ERROR,silent:ut.SILENT},jT=ut.INFO,DT={[ut.DEBUG]:"log",[ut.VERBOSE]:"log",[ut.INFO]:"info",[ut.WARN]:"warn",[ut.ERROR]:"error"},VT=(n,e,...t)=>{if(e<n.logLevel)return;const s=new Date().toISOString(),a=DT[e];if(a)console[a](`[${s}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Ff{constructor(e){this.name=e,this._logLevel=jT,this._logHandler=VT,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ut))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?kT[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ut.DEBUG,...e),this._logHandler(this,ut.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ut.VERBOSE,...e),this._logHandler(this,ut.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ut.INFO,...e),this._logHandler(this,ut.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ut.WARN,...e),this._logHandler(this,ut.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ut.ERROR,...e),this._logHandler(this,ut.ERROR,...e)}}const LT=(n,e)=>e.some(t=>n instanceof t);let ay,oy;function OT(){return ay||(ay=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function MT(){return oy||(oy=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const u_=new WeakMap,af=new WeakMap,d_=new WeakMap,$h=new WeakMap,Uf=new WeakMap;function FT(n){const e=new Promise((t,s)=>{const a=()=>{n.removeEventListener("success",l),n.removeEventListener("error",d)},l=()=>{t(Ai(n.result)),a()},d=()=>{s(n.error),a()};n.addEventListener("success",l),n.addEventListener("error",d)});return e.then(t=>{t instanceof IDBCursor&&u_.set(t,n)}).catch(()=>{}),Uf.set(e,n),e}function UT(n){if(af.has(n))return;const e=new Promise((t,s)=>{const a=()=>{n.removeEventListener("complete",l),n.removeEventListener("error",d),n.removeEventListener("abort",d)},l=()=>{t(),a()},d=()=>{s(n.error||new DOMException("AbortError","AbortError")),a()};n.addEventListener("complete",l),n.addEventListener("error",d),n.addEventListener("abort",d)});af.set(n,e)}let of={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return af.get(n);if(e==="objectStoreNames")return n.objectStoreNames||d_.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Ai(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function zT(n){of=n(of)}function BT(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const s=n.call(Wh(this),e,...t);return d_.set(s,e.sort?e.sort():[e]),Ai(s)}:MT().includes(n)?function(...e){return n.apply(Wh(this),e),Ai(u_.get(this))}:function(...e){return Ai(n.apply(Wh(this),e))}}function $T(n){return typeof n=="function"?BT(n):(n instanceof IDBTransaction&&UT(n),LT(n,OT())?new Proxy(n,of):n)}function Ai(n){if(n instanceof IDBRequest)return FT(n);if($h.has(n))return $h.get(n);const e=$T(n);return e!==n&&($h.set(n,e),Uf.set(e,n)),e}const Wh=n=>Uf.get(n);function WT(n,e,{blocked:t,upgrade:s,blocking:a,terminated:l}={}){const d=indexedDB.open(n,e),f=Ai(d);return s&&d.addEventListener("upgradeneeded",m=>{s(Ai(d.result),m.oldVersion,m.newVersion,Ai(d.transaction),m)}),t&&d.addEventListener("blocked",m=>t(m.oldVersion,m.newVersion,m)),f.then(m=>{l&&m.addEventListener("close",()=>l()),a&&m.addEventListener("versionchange",v=>a(v.oldVersion,v.newVersion,v))}).catch(()=>{}),f}const GT=["get","getKey","getAll","getAllKeys","count"],HT=["put","add","delete","clear"],Gh=new Map;function ly(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Gh.get(e))return Gh.get(e);const t=e.replace(/FromIndex$/,""),s=e!==t,a=HT.includes(t);if(!(t in(s?IDBIndex:IDBObjectStore).prototype)||!(a||GT.includes(t)))return;const l=async function(d,...f){const m=this.transaction(d,a?"readwrite":"readonly");let v=m.store;return s&&(v=v.index(f.shift())),(await Promise.all([v[t](...f),a&&m.done]))[0]};return Gh.set(e,l),l}zT(n=>({...n,get:(e,t,s)=>ly(e,t)||n.get(e,t,s),has:(e,t)=>!!ly(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qT{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(KT(t)){const s=t.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(t=>t).join(" ")}}function KT(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const lf="@firebase/app",cy="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Js=new Ff("@firebase/app"),QT="@firebase/app-compat",YT="@firebase/analytics-compat",JT="@firebase/analytics",XT="@firebase/app-check-compat",ZT="@firebase/app-check",eS="@firebase/auth",tS="@firebase/auth-compat",nS="@firebase/database",rS="@firebase/data-connect",sS="@firebase/database-compat",iS="@firebase/functions",aS="@firebase/functions-compat",oS="@firebase/installations",lS="@firebase/installations-compat",cS="@firebase/messaging",uS="@firebase/messaging-compat",dS="@firebase/performance",hS="@firebase/performance-compat",fS="@firebase/remote-config",pS="@firebase/remote-config-compat",mS="@firebase/storage",gS="@firebase/storage-compat",yS="@firebase/firestore",vS="@firebase/ai",_S="@firebase/firestore-compat",wS="firebase",xS="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cf="[DEFAULT]",ES={[lf]:"fire-core",[QT]:"fire-core-compat",[JT]:"fire-analytics",[YT]:"fire-analytics-compat",[ZT]:"fire-app-check",[XT]:"fire-app-check-compat",[eS]:"fire-auth",[tS]:"fire-auth-compat",[nS]:"fire-rtdb",[rS]:"fire-data-connect",[sS]:"fire-rtdb-compat",[iS]:"fire-fn",[aS]:"fire-fn-compat",[oS]:"fire-iid",[lS]:"fire-iid-compat",[cS]:"fire-fcm",[uS]:"fire-fcm-compat",[dS]:"fire-perf",[hS]:"fire-perf-compat",[fS]:"fire-rc",[pS]:"fire-rc-compat",[mS]:"fire-gcs",[gS]:"fire-gcs-compat",[yS]:"fire-fst",[_S]:"fire-fst-compat",[vS]:"fire-vertex","fire-js":"fire-js",[wS]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tu=new Map,TS=new Map,uf=new Map;function uy(n,e){try{n.container.addComponent(e)}catch(t){Js.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function go(n){const e=n.name;if(uf.has(e))return Js.debug(`There were multiple attempts to register component ${e}.`),!1;uf.set(e,n);for(const t of Tu.values())uy(t,n);for(const t of TS.values())uy(t,n);return!0}function zf(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Sr(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SS={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ki=new zl("app","Firebase",SS);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IS{constructor(e,t,s){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new _a("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ki.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Co=xS;function h_(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const s=Object.assign({name:cf,automaticDataCollectionEnabled:!0},e),a=s.name;if(typeof a!="string"||!a)throw ki.create("bad-app-name",{appName:String(a)});if(t||(t=a_()),!t)throw ki.create("no-options");const l=Tu.get(a);if(l){if(va(t,l.options)&&va(s,l.config))return l;throw ki.create("duplicate-app",{appName:a})}const d=new AT(a);for(const m of uf.values())d.addComponent(m);const f=new IS(t,s,d);return Tu.set(a,f),f}function f_(n=cf){const e=Tu.get(n);if(!e&&n===cf&&a_())return h_();if(!e)throw ki.create("no-app",{appName:n});return e}function ji(n,e,t){var s;let a=(s=ES[n])!==null&&s!==void 0?s:n;t&&(a+=`-${t}`);const l=a.match(/\s|\//),d=e.match(/\s|\//);if(l||d){const f=[`Unable to register library "${a}" with version "${e}":`];l&&f.push(`library name "${a}" contains illegal characters (whitespace or "/")`),l&&d&&f.push("and"),d&&f.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Js.warn(f.join(" "));return}go(new _a(`${a}-version`,()=>({library:a,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CS="firebase-heartbeat-database",bS=1,Nl="firebase-heartbeat-store";let Hh=null;function p_(){return Hh||(Hh=WT(CS,bS,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Nl)}catch(t){console.warn(t)}}}}).catch(n=>{throw ki.create("idb-open",{originalErrorMessage:n.message})})),Hh}async function PS(n){try{const t=(await p_()).transaction(Nl),s=await t.objectStore(Nl).get(m_(n));return await t.done,s}catch(e){if(e instanceof ni)Js.warn(e.message);else{const t=ki.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Js.warn(t.message)}}}async function dy(n,e){try{const s=(await p_()).transaction(Nl,"readwrite");await s.objectStore(Nl).put(e,m_(n)),await s.done}catch(t){if(t instanceof ni)Js.warn(t.message);else{const s=ki.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Js.warn(s.message)}}}function m_(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RS=1024,NS=30;class AS{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new jS(t),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){var e,t;try{const a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),l=hy();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===l||this._heartbeatsCache.heartbeats.some(d=>d.date===l))return;if(this._heartbeatsCache.heartbeats.push({date:l,agent:a}),this._heartbeatsCache.heartbeats.length>NS){const d=DS(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(d,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(s){Js.warn(s)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=hy(),{heartbeatsToSend:s,unsentEntries:a}=kS(this._heartbeatsCache.heartbeats),l=Eu(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=t,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(t){return Js.warn(t),""}}}function hy(){return new Date().toISOString().substring(0,10)}function kS(n,e=RS){const t=[];let s=n.slice();for(const a of n){const l=t.find(d=>d.agent===a.agent);if(l){if(l.dates.push(a.date),fy(t)>e){l.dates.pop();break}}else if(t.push({agent:a.agent,dates:[a.date]}),fy(t)>e){t.pop();break}s=s.slice(1)}return{heartbeatsToSend:t,unsentEntries:s}}class jS{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return _T()?wT().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await PS(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const a=await this.read();return dy(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:a.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const a=await this.read();return dy(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:a.lastSentHeartbeatDate,heartbeats:[...a.heartbeats,...e.heartbeats]})}else return}}function fy(n){return Eu(JSON.stringify({version:2,heartbeats:n})).length}function DS(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let s=1;s<n.length;s++)n[s].date<t&&(t=n[s].date,e=s);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VS(n){go(new _a("platform-logger",e=>new qT(e),"PRIVATE")),go(new _a("heartbeat",e=>new AS(e),"PRIVATE")),ji(lf,cy,n),ji(lf,cy,"esm2017"),ji("fire-js","")}VS("");var LS="firebase",OS="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ji(LS,OS,"app");function Bf(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(n);a<s.length;a++)e.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(n,s[a])&&(t[s[a]]=n[s[a]]);return t}function g_(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const MS=g_,y_=new zl("auth","Firebase",g_());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Su=new Ff("@firebase/auth");function FS(n,...e){Su.logLevel<=ut.WARN&&Su.warn(`Auth (${Co}): ${n}`,...e)}function uu(n,...e){Su.logLevel<=ut.ERROR&&Su.error(`Auth (${Co}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mr(n,...e){throw Wf(n,...e)}function ns(n,...e){return Wf(n,...e)}function $f(n,e,t){const s=Object.assign(Object.assign({},MS()),{[e]:t});return new zl("auth","Firebase",s).create(e,{appName:n.name})}function Qs(n){return $f(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function v_(n,e,t){const s=t;if(!(e instanceof s))throw s.name!==e.constructor.name&&Mr(n,"argument-error"),$f(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Wf(n,...e){if(typeof n!="string"){const t=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=n.name),n._errorFactory.create(t,...s)}return y_.create(n,...e)}function qe(n,e,...t){if(!n)throw Wf(e,...t)}function Hs(n){const e="INTERNAL ASSERTION FAILED: "+n;throw uu(e),new Error(e)}function Xs(n,e){n||Hs(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function df(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function US(){return py()==="http:"||py()==="https:"}function py(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zS(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(US()||mT()||"connection"in navigator)?navigator.onLine:!0}function BS(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $l{constructor(e,t){this.shortDelay=e,this.longDelay=t,Xs(t>e,"Short delay should be less than long delay!"),this.isMobile=hT()||gT()}get(){return zS()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gf(n,e){Xs(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __{static initialize(e,t,s){this.fetchImpl=e,t&&(this.headersImpl=t),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Hs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Hs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Hs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $S={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WS=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],GS=new $l(3e4,6e4);function Gi(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function Ns(n,e,t,s,a={}){return w_(n,a,async()=>{let l={},d={};s&&(e==="GET"?d=s:l={body:JSON.stringify(s)});const f=Bl(Object.assign({key:n.config.apiKey},d)).slice(1),m=await n._getAdditionalHeaders();m["Content-Type"]="application/json",n.languageCode&&(m["X-Firebase-Locale"]=n.languageCode);const v=Object.assign({method:e,headers:m},l);return pT()||(v.referrerPolicy="no-referrer"),n.emulatorConfig&&Io(n.emulatorConfig.host)&&(v.credentials="include"),__.fetch()(await x_(n,n.config.apiHost,t,f),v)})}async function w_(n,e,t){n._canInitEmulator=!1;const s=Object.assign(Object.assign({},$S),e);try{const a=new qS(n),l=await Promise.race([t(),a.promise]);a.clearNetworkTimeout();const d=await l.json();if("needConfirmation"in d)throw su(n,"account-exists-with-different-credential",d);if(l.ok&&!("errorMessage"in d))return d;{const f=l.ok?d.errorMessage:d.error.message,[m,v]=f.split(" : ");if(m==="FEDERATED_USER_ID_ALREADY_LINKED")throw su(n,"credential-already-in-use",d);if(m==="EMAIL_EXISTS")throw su(n,"email-already-in-use",d);if(m==="USER_DISABLED")throw su(n,"user-disabled",d);const w=s[m]||m.toLowerCase().replace(/[_\s]+/g,"-");if(v)throw $f(n,w,v);Mr(n,w)}}catch(a){if(a instanceof ni)throw a;Mr(n,"network-request-failed",{message:String(a)})}}async function Wl(n,e,t,s,a={}){const l=await Ns(n,e,t,s,a);return"mfaPendingCredential"in l&&Mr(n,"multi-factor-auth-required",{_serverResponse:l}),l}async function x_(n,e,t,s){const a=`${e}${t}?${s}`,l=n,d=l.config.emulator?Gf(n.config,a):`${n.config.apiScheme}://${a}`;return WS.includes(t)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(d).toString():d}function HS(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class qS{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,s)=>{this.timer=setTimeout(()=>s(ns(this.auth,"network-request-failed")),GS.get())})}}function su(n,e,t){const s={appName:n.name};t.email&&(s.email=t.email),t.phoneNumber&&(s.phoneNumber=t.phoneNumber);const a=ns(n,e,s);return a.customData._tokenResponse=t,a}function my(n){return n!==void 0&&n.enterprise!==void 0}class KS{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return HS(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function QS(n,e){return Ns(n,"GET","/v2/recaptchaConfig",Gi(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YS(n,e){return Ns(n,"POST","/v1/accounts:delete",e)}async function JS(n,e){return Ns(n,"POST","/v1/accounts:update",e)}async function Iu(n,e){return Ns(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function El(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function XS(n,e=!1){const t=sn(n),s=await t.getIdToken(e),a=Hf(s);qe(a&&a.exp&&a.auth_time&&a.iat,t.auth,"internal-error");const l=typeof a.firebase=="object"?a.firebase:void 0,d=l==null?void 0:l.sign_in_provider;return{claims:a,token:s,authTime:El(qh(a.auth_time)),issuedAtTime:El(qh(a.iat)),expirationTime:El(qh(a.exp)),signInProvider:d||null,signInSecondFactor:(l==null?void 0:l.sign_in_second_factor)||null}}function qh(n){return Number(n)*1e3}function Hf(n){const[e,t,s]=n.split(".");if(e===void 0||t===void 0||s===void 0)return uu("JWT malformed, contained fewer than 3 sections"),null;try{const a=s_(t);return a?JSON.parse(a):(uu("Failed to decode base64 JWT payload"),null)}catch(a){return uu("Caught error parsing JWT payload as JSON",a==null?void 0:a.toString()),null}}function gy(n){const e=Hf(n);return qe(e,"internal-error"),qe(typeof e.exp<"u","internal-error"),qe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yo(n,e,t=!1){if(t)return e;try{return await e}catch(s){throw s instanceof ni&&ZS(s)&&n.auth.currentUser===n&&await n.auth.signOut(),s}}function ZS({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e1{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const s=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),s}else{this.errorBackoff=3e4;const a=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,a)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hf{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=El(this.lastLoginAt),this.creationTime=El(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Al(n){var e;const t=n.auth,s=await n.getIdToken(),a=await yo(n,Iu(t,{idToken:s}));qe(a==null?void 0:a.users.length,t,"internal-error");const l=a.users[0];n._notifyReloadListener(l);const d=!((e=l.providerUserInfo)===null||e===void 0)&&e.length?E_(l.providerUserInfo):[],f=n1(n.providerData,d),m=n.isAnonymous,v=!(n.email&&l.passwordHash)&&!(f!=null&&f.length),w=m?v:!1,S={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:f,metadata:new hf(l.createdAt,l.lastLoginAt),isAnonymous:w};Object.assign(n,S)}async function t1(n){const e=sn(n);await Al(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function n1(n,e){return[...n.filter(s=>!e.some(a=>a.providerId===s.providerId)),...e]}function E_(n){return n.map(e=>{var{providerId:t}=e,s=Bf(e,["providerId"]);return{providerId:t,uid:s.rawId||"",displayName:s.displayName||null,email:s.email||null,phoneNumber:s.phoneNumber||null,photoURL:s.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function r1(n,e){const t=await w_(n,{},async()=>{const s=Bl({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:l}=n.config,d=await x_(n,a,"/v1/token",`key=${l}`),f=await n._getAdditionalHeaders();f["Content-Type"]="application/x-www-form-urlencoded";const m={method:"POST",headers:f,body:s};return n.emulatorConfig&&Io(n.emulatorConfig.host)&&(m.credentials="include"),__.fetch()(d,m)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function s1(n,e){return Ns(n,"POST","/v2/accounts:revokeToken",Gi(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){qe(e.idToken,"internal-error"),qe(typeof e.idToken<"u","internal-error"),qe(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):gy(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){qe(e.length!==0,"internal-error");const t=gy(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(qe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:s,refreshToken:a,expiresIn:l}=await r1(e,t);this.updateTokensAndExpiration(s,a,Number(l))}updateTokensAndExpiration(e,t,s){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,t){const{refreshToken:s,accessToken:a,expirationTime:l}=t,d=new uo;return s&&(qe(typeof s=="string","internal-error",{appName:e}),d.refreshToken=s),a&&(qe(typeof a=="string","internal-error",{appName:e}),d.accessToken=a),l&&(qe(typeof l=="number","internal-error",{appName:e}),d.expirationTime=l),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new uo,this.toJSON())}_performRefresh(){return Hs("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ti(n,e){qe(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class ts{constructor(e){var{uid:t,auth:s,stsTokenManager:a}=e,l=Bf(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new e1(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=s,this.stsTokenManager=a,this.accessToken=a.accessToken,this.displayName=l.displayName||null,this.email=l.email||null,this.emailVerified=l.emailVerified||!1,this.phoneNumber=l.phoneNumber||null,this.photoURL=l.photoURL||null,this.isAnonymous=l.isAnonymous||!1,this.tenantId=l.tenantId||null,this.providerData=l.providerData?[...l.providerData]:[],this.metadata=new hf(l.createdAt||void 0,l.lastLoginAt||void 0)}async getIdToken(e){const t=await yo(this,this.stsTokenManager.getToken(this.auth,e));return qe(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return XS(this,e)}reload(){return t1(this)}_assign(e){this!==e&&(qe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new ts(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){qe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),t&&await Al(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Sr(this.auth.app))return Promise.reject(Qs(this.auth));const e=await this.getIdToken();return await yo(this,YS(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var s,a,l,d,f,m,v,w;const S=(s=t.displayName)!==null&&s!==void 0?s:void 0,C=(a=t.email)!==null&&a!==void 0?a:void 0,$=(l=t.phoneNumber)!==null&&l!==void 0?l:void 0,X=(d=t.photoURL)!==null&&d!==void 0?d:void 0,q=(f=t.tenantId)!==null&&f!==void 0?f:void 0,U=(m=t._redirectEventId)!==null&&m!==void 0?m:void 0,ne=(v=t.createdAt)!==null&&v!==void 0?v:void 0,xe=(w=t.lastLoginAt)!==null&&w!==void 0?w:void 0,{uid:ge,emailVerified:ye,isAnonymous:ie,providerData:Ee,stsTokenManager:k}=t;qe(ge&&k,e,"internal-error");const P=uo.fromJSON(this.name,k);qe(typeof ge=="string",e,"internal-error"),Ti(S,e.name),Ti(C,e.name),qe(typeof ye=="boolean",e,"internal-error"),qe(typeof ie=="boolean",e,"internal-error"),Ti($,e.name),Ti(X,e.name),Ti(q,e.name),Ti(U,e.name),Ti(ne,e.name),Ti(xe,e.name);const R=new ts({uid:ge,auth:e,email:C,emailVerified:ye,displayName:S,isAnonymous:ie,photoURL:X,phoneNumber:$,tenantId:q,stsTokenManager:P,createdAt:ne,lastLoginAt:xe});return Ee&&Array.isArray(Ee)&&(R.providerData=Ee.map(M=>Object.assign({},M))),U&&(R._redirectEventId=U),R}static async _fromIdTokenResponse(e,t,s=!1){const a=new uo;a.updateFromServerResponse(t);const l=new ts({uid:t.localId,auth:e,stsTokenManager:a,isAnonymous:s});return await Al(l),l}static async _fromGetAccountInfoResponse(e,t,s){const a=t.users[0];qe(a.localId!==void 0,"internal-error");const l=a.providerUserInfo!==void 0?E_(a.providerUserInfo):[],d=!(a.email&&a.passwordHash)&&!(l!=null&&l.length),f=new uo;f.updateFromIdToken(s);const m=new ts({uid:a.localId,auth:e,stsTokenManager:f,isAnonymous:d}),v={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new hf(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!(l!=null&&l.length)};return Object.assign(m,v),m}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yy=new Map;function qs(n){Xs(n instanceof Function,"Expected a class definition");let e=yy.get(n);return e?(Xs(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,yy.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T_{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}T_.type="NONE";const vy=T_;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function du(n,e,t){return`firebase:${n}:${e}:${t}`}class ho{constructor(e,t,s){this.persistence=e,this.auth=t,this.userKey=s;const{config:a,name:l}=this.auth;this.fullUserKey=du(this.userKey,a.apiKey,l),this.fullPersistenceKey=du("persistence",a.apiKey,l),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Iu(this.auth,{idToken:e}).catch(()=>{});return t?ts._fromGetAccountInfoResponse(this.auth,t,e):null}return ts._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,s="authUser"){if(!t.length)return new ho(qs(vy),e,s);const a=(await Promise.all(t.map(async v=>{if(await v._isAvailable())return v}))).filter(v=>v);let l=a[0]||qs(vy);const d=du(s,e.config.apiKey,e.name);let f=null;for(const v of t)try{const w=await v._get(d);if(w){let S;if(typeof w=="string"){const C=await Iu(e,{idToken:w}).catch(()=>{});if(!C)break;S=await ts._fromGetAccountInfoResponse(e,C,w)}else S=ts._fromJSON(e,w);v!==l&&(f=S),l=v;break}}catch{}const m=a.filter(v=>v._shouldAllowMigration);return!l._shouldAllowMigration||!m.length?new ho(l,e,s):(l=m[0],f&&await l._set(d,f.toJSON()),await Promise.all(t.map(async v=>{if(v!==l)try{await v._remove(d)}catch{}})),new ho(l,e,s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _y(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(b_(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(S_(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(R_(e))return"Blackberry";if(N_(e))return"Webos";if(I_(e))return"Safari";if((e.includes("chrome/")||C_(e))&&!e.includes("edge/"))return"Chrome";if(P_(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=n.match(t);if((s==null?void 0:s.length)===2)return s[1]}return"Other"}function S_(n=Hn()){return/firefox\//i.test(n)}function I_(n=Hn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function C_(n=Hn()){return/crios\//i.test(n)}function b_(n=Hn()){return/iemobile/i.test(n)}function P_(n=Hn()){return/android/i.test(n)}function R_(n=Hn()){return/blackberry/i.test(n)}function N_(n=Hn()){return/webos/i.test(n)}function qf(n=Hn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function i1(n=Hn()){var e;return qf(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function a1(){return yT()&&document.documentMode===10}function A_(n=Hn()){return qf(n)||P_(n)||N_(n)||R_(n)||/windows phone/i.test(n)||b_(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k_(n,e=[]){let t;switch(n){case"Browser":t=_y(Hn());break;case"Worker":t=`${_y(Hn())}-${n}`;break;default:t=n}const s=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Co}/${s}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o1{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const s=l=>new Promise((d,f)=>{try{const m=e(l);d(m)}catch(m){f(m)}});s.onAbort=t,this.queue.push(s);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const s of this.queue)await s(e),s.onAbort&&t.push(s.onAbort)}catch(s){t.reverse();for(const a of t)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s==null?void 0:s.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function l1(n,e={}){return Ns(n,"GET","/v2/passwordPolicy",Gi(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c1=6;class u1{constructor(e){var t,s,a,l;const d=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=d.minPasswordLength)!==null&&t!==void 0?t:c1,d.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=d.maxPasswordLength),d.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=d.containsLowercaseCharacter),d.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=d.containsUppercaseCharacter),d.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=d.containsNumericCharacter),d.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=d.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(a=(s=e.allowedNonAlphanumericCharacters)===null||s===void 0?void 0:s.join(""))!==null&&a!==void 0?a:"",this.forceUpgradeOnSignin=(l=e.forceUpgradeOnSignin)!==null&&l!==void 0?l:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,s,a,l,d,f;const m={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,m),this.validatePasswordCharacterOptions(e,m),m.isValid&&(m.isValid=(t=m.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),m.isValid&&(m.isValid=(s=m.meetsMaxPasswordLength)!==null&&s!==void 0?s:!0),m.isValid&&(m.isValid=(a=m.containsLowercaseLetter)!==null&&a!==void 0?a:!0),m.isValid&&(m.isValid=(l=m.containsUppercaseLetter)!==null&&l!==void 0?l:!0),m.isValid&&(m.isValid=(d=m.containsNumericCharacter)!==null&&d!==void 0?d:!0),m.isValid&&(m.isValid=(f=m.containsNonAlphanumericCharacter)!==null&&f!==void 0?f:!0),m}validatePasswordLengthOptions(e,t){const s=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;s&&(t.meetsMinPasswordLength=e.length>=s),a&&(t.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let s;for(let a=0;a<e.length;a++)s=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(t,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,t,s,a,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d1{constructor(e,t,s,a){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=s,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new wy(this),this.idTokenSubscription=new wy(this),this.beforeStateQueue=new o1(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=y_,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=qs(t)),this._initializationPromise=this.queue(async()=>{var s,a,l;if(!this._deleted&&(this.persistenceManager=await ho.create(this,e),(s=this._resolvePersistenceManagerAvailable)===null||s===void 0||s.call(this),!this._deleted)){if(!((a=this._popupRedirectResolver)===null||a===void 0)&&a._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((l=this.currentUser)===null||l===void 0?void 0:l.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Iu(this,{idToken:e}),s=await ts._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(s)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Sr(this.app)){const d=this.app.settings.authIdToken;return d?new Promise(f=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(d).then(f,f))}):this.directlySetCurrentUser(null)}const s=await this.assertedPersistence.getCurrentUser();let a=s,l=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const d=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,f=a==null?void 0:a._redirectEventId,m=await this.tryRedirectSignIn(e);(!d||d===f)&&(m!=null&&m.user)&&(a=m.user,l=!0)}if(!a)return this.directlySetCurrentUser(null);if(!a._redirectEventId){if(l)try{await this.beforeStateQueue.runMiddleware(a)}catch(d){a=s,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(d))}return a?this.reloadAndSetCurrentUserOrClear(a):this.directlySetCurrentUser(null)}return qe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===a._redirectEventId?this.directlySetCurrentUser(a):this.reloadAndSetCurrentUserOrClear(a)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Al(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=BS()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Sr(this.app))return Promise.reject(Qs(this));const t=e?sn(e):null;return t&&qe(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&qe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Sr(this.app)?Promise.reject(Qs(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Sr(this.app)?Promise.reject(Qs(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(qs(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await l1(this),t=new u1(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new zl("auth","Firebase",e())}onAuthStateChanged(e,t,s){return this.registerStateListener(this.authStateSubscription,e,t,s)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,s){return this.registerStateListener(this.idTokenSubscription,e,t,s)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(s.tenantId=this.tenantId),await s1(this,s)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const s=await this.getOrInitRedirectPersistenceManager(t);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&qs(e)||this._popupRedirectResolver;qe(t,this,"argument-error"),this.redirectPersistenceManager=await ho.create(this,[qs(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,s;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((s=this.redirectUser)===null||s===void 0?void 0:s._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const s=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==s&&(this.lastNotifiedUid=s,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,s,a){if(this._deleted)return()=>{};const l=typeof t=="function"?t:t.next.bind(t);let d=!1;const f=this._isInitialized?Promise.resolve():this._initializationPromise;if(qe(f,this,"internal-error"),f.then(()=>{d||l(this.currentUser)}),typeof t=="function"){const m=e.addObserver(t,s,a);return()=>{d=!0,m()}}else{const m=e.addObserver(t);return()=>{d=!0,m()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return qe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=k_(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const s=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());s&&(t["X-Firebase-Client"]=s);const a=await this._getAppCheckToken();return a&&(t["X-Firebase-AppCheck"]=a),t}async _getAppCheckToken(){var e;if(Sr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&FS(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function Hi(n){return sn(n)}class wy{constructor(e){this.auth=e,this.observer=null,this.addObserver=IT(t=>this.observer=t)}get next(){return qe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Wu={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function h1(n){Wu=n}function j_(n){return Wu.loadJS(n)}function f1(){return Wu.recaptchaEnterpriseScript}function p1(){return Wu.gapiScript}function m1(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class g1{constructor(){this.enterprise=new y1}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class y1{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const v1="recaptcha-enterprise",D_="NO_RECAPTCHA";class _1{constructor(e){this.type=v1,this.auth=Hi(e)}async verify(e="verify",t=!1){async function s(l){if(!t){if(l.tenantId==null&&l._agentRecaptchaConfig!=null)return l._agentRecaptchaConfig.siteKey;if(l.tenantId!=null&&l._tenantRecaptchaConfigs[l.tenantId]!==void 0)return l._tenantRecaptchaConfigs[l.tenantId].siteKey}return new Promise(async(d,f)=>{QS(l,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(m=>{if(m.recaptchaKey===void 0)f(new Error("recaptcha Enterprise site key undefined"));else{const v=new KS(m);return l.tenantId==null?l._agentRecaptchaConfig=v:l._tenantRecaptchaConfigs[l.tenantId]=v,d(v.siteKey)}}).catch(m=>{f(m)})})}function a(l,d,f){const m=window.grecaptcha;my(m)?m.enterprise.ready(()=>{m.enterprise.execute(l,{action:e}).then(v=>{d(v)}).catch(()=>{d(D_)})}):f(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new g1().execute("siteKey",{action:"verify"}):new Promise((l,d)=>{s(this.auth).then(f=>{if(!t&&my(window.grecaptcha))a(f,l,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let m=f1();m.length!==0&&(m+=f),j_(m).then(()=>{a(f,l,d)}).catch(v=>{d(v)})}}).catch(f=>{d(f)})})}}async function xy(n,e,t,s=!1,a=!1){const l=new _1(n);let d;if(a)d=D_;else try{d=await l.verify(t)}catch{d=await l.verify(t,!0)}const f=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in f){const m=f.phoneEnrollmentInfo.phoneNumber,v=f.phoneEnrollmentInfo.recaptchaToken;Object.assign(f,{phoneEnrollmentInfo:{phoneNumber:m,recaptchaToken:v,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in f){const m=f.phoneSignInInfo.recaptchaToken;Object.assign(f,{phoneSignInInfo:{recaptchaToken:m,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return f}return s?Object.assign(f,{captchaResp:d}):Object.assign(f,{captchaResponse:d}),Object.assign(f,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(f,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),f}async function ff(n,e,t,s,a){var l;if(!((l=n._getRecaptchaConfig())===null||l===void 0)&&l.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const d=await xy(n,e,t,t==="getOobCode");return s(n,d)}else return s(n,e).catch(async d=>{if(d.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const f=await xy(n,e,t,t==="getOobCode");return s(n,f)}else return Promise.reject(d)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w1(n,e){const t=zf(n,"auth");if(t.isInitialized()){const a=t.getImmediate(),l=t.getOptions();if(va(l,e??{}))return a;Mr(a,"already-initialized")}return t.initialize({options:e})}function x1(n,e){const t=(e==null?void 0:e.persistence)||[],s=(Array.isArray(t)?t:[t]).map(qs);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(s,e==null?void 0:e.popupRedirectResolver)}function E1(n,e,t){const s=Hi(n);qe(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const a=!1,l=V_(e),{host:d,port:f}=T1(e),m=f===null?"":`:${f}`,v={url:`${l}//${d}${m}/`},w=Object.freeze({host:d,port:f,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!s._canInitEmulator){qe(s.config.emulator&&s.emulatorConfig,s,"emulator-config-failed"),qe(va(v,s.config.emulator)&&va(w,s.emulatorConfig),s,"emulator-config-failed");return}s.config.emulator=v,s.emulatorConfig=w,s.settings.appVerificationDisabledForTesting=!0,Io(d)?(l_(`${l}//${d}${m}`),c_("Auth",!0)):S1()}function V_(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function T1(n){const e=V_(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const s=t[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(s);if(a){const l=a[1];return{host:l,port:Ey(s.substr(l.length+1))}}else{const[l,d]=s.split(":");return{host:l,port:Ey(d)}}}function Ey(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function S1(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kf{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Hs("not implemented")}_getIdTokenResponse(e){return Hs("not implemented")}_linkToIdToken(e,t){return Hs("not implemented")}_getReauthenticationResolver(e){return Hs("not implemented")}}async function I1(n,e){return Ns(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function C1(n,e){return Wl(n,"POST","/v1/accounts:signInWithPassword",Gi(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function b1(n,e){return Wl(n,"POST","/v1/accounts:signInWithEmailLink",Gi(n,e))}async function P1(n,e){return Wl(n,"POST","/v1/accounts:signInWithEmailLink",Gi(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kl extends Kf{constructor(e,t,s,a=null){super("password",s),this._email=e,this._password=t,this._tenantId=a}static _fromEmailAndPassword(e,t){return new kl(e,t,"password")}static _fromEmailAndCode(e,t,s=null){return new kl(e,t,"emailLink",s)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return ff(e,t,"signInWithPassword",C1);case"emailLink":return b1(e,{email:this._email,oobCode:this._password});default:Mr(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const s={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return ff(e,s,"signUpPassword",I1);case"emailLink":return P1(e,{idToken:t,email:this._email,oobCode:this._password});default:Mr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fo(n,e){return Wl(n,"POST","/v1/accounts:signInWithIdp",Gi(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R1="http://localhost";class Zs extends Kf{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Zs(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Mr("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:a}=t,l=Bf(t,["providerId","signInMethod"]);if(!s||!a)return null;const d=new Zs(s,a);return d.idToken=l.idToken||void 0,d.accessToken=l.accessToken||void 0,d.secret=l.secret,d.nonce=l.nonce,d.pendingToken=l.pendingToken||null,d}_getIdTokenResponse(e){const t=this.buildRequest();return fo(e,t)}_linkToIdToken(e,t){const s=this.buildRequest();return s.idToken=t,fo(e,s)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,fo(e,t)}buildRequest(){const e={requestUri:R1,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Bl(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N1(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function A1(n){const e=pl(ml(n)).link,t=e?pl(ml(e)).deep_link_id:null,s=pl(ml(n)).deep_link_id;return(s?pl(ml(s)).link:null)||s||t||e||n}class Qf{constructor(e){var t,s,a,l,d,f;const m=pl(ml(e)),v=(t=m.apiKey)!==null&&t!==void 0?t:null,w=(s=m.oobCode)!==null&&s!==void 0?s:null,S=N1((a=m.mode)!==null&&a!==void 0?a:null);qe(v&&w&&S,"argument-error"),this.apiKey=v,this.operation=S,this.code=w,this.continueUrl=(l=m.continueUrl)!==null&&l!==void 0?l:null,this.languageCode=(d=m.lang)!==null&&d!==void 0?d:null,this.tenantId=(f=m.tenantId)!==null&&f!==void 0?f:null}static parseLink(e){const t=A1(e);try{return new Qf(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bo{constructor(){this.providerId=bo.PROVIDER_ID}static credential(e,t){return kl._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const s=Qf.parseLink(t);return qe(s,"argument-error"),kl._fromEmailAndCode(e,s.code,s.tenantId)}}bo.PROVIDER_ID="password";bo.EMAIL_PASSWORD_SIGN_IN_METHOD="password";bo.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gu{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Po extends Gu{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Tl extends Po{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return qe("providerId"in t&&"signInMethod"in t,"argument-error"),Zs._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return qe(e.idToken||e.accessToken,"argument-error"),Zs._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return Tl.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return Tl.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:s,oauthTokenSecret:a,pendingToken:l,nonce:d,providerId:f}=e;if(!s&&!a&&!t&&!l||!f)return null;try{return new Tl(f)._credential({idToken:t,accessToken:s,nonce:d,pendingToken:l})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Si extends Po{constructor(){super("facebook.com")}static credential(e){return Zs._fromParams({providerId:Si.PROVIDER_ID,signInMethod:Si.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Si.credentialFromTaggedObject(e)}static credentialFromError(e){return Si.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Si.credential(e.oauthAccessToken)}catch{return null}}}Si.FACEBOOK_SIGN_IN_METHOD="facebook.com";Si.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class es extends Po{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Zs._fromParams({providerId:es.PROVIDER_ID,signInMethod:es.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return es.credentialFromTaggedObject(e)}static credentialFromError(e){return es.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:s}=e;if(!t&&!s)return null;try{return es.credential(t,s)}catch{return null}}}es.GOOGLE_SIGN_IN_METHOD="google.com";es.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ii extends Po{constructor(){super("github.com")}static credential(e){return Zs._fromParams({providerId:Ii.PROVIDER_ID,signInMethod:Ii.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ii.credentialFromTaggedObject(e)}static credentialFromError(e){return Ii.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ii.credential(e.oauthAccessToken)}catch{return null}}}Ii.GITHUB_SIGN_IN_METHOD="github.com";Ii.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ci extends Po{constructor(){super("twitter.com")}static credential(e,t){return Zs._fromParams({providerId:Ci.PROVIDER_ID,signInMethod:Ci.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ci.credentialFromTaggedObject(e)}static credentialFromError(e){return Ci.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:s}=e;if(!t||!s)return null;try{return Ci.credential(t,s)}catch{return null}}}Ci.TWITTER_SIGN_IN_METHOD="twitter.com";Ci.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function k1(n,e){return Wl(n,"POST","/v1/accounts:signUp",Gi(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wa{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,s,a=!1){const l=await ts._fromIdTokenResponse(e,s,a),d=Ty(s);return new wa({user:l,providerId:d,_tokenResponse:s,operationType:t})}static async _forOperation(e,t,s){await e._updateTokensIfNecessary(s,!0);const a=Ty(s);return new wa({user:e,providerId:a,_tokenResponse:s,operationType:t})}}function Ty(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cu extends ni{constructor(e,t,s,a){var l;super(t.code,t.message),this.operationType=s,this.user=a,Object.setPrototypeOf(this,Cu.prototype),this.customData={appName:e.name,tenantId:(l=e.tenantId)!==null&&l!==void 0?l:void 0,_serverResponse:t.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,t,s,a){return new Cu(e,t,s,a)}}function L_(n,e,t,s){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?Cu._fromErrorAndOperation(n,l,e,s):l})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O_(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function j1(n,e){const t=sn(n);await V1(!0,t,e);const{providerUserInfo:s}=await JS(t.auth,{idToken:await t.getIdToken(),deleteProvider:[e]}),a=O_(s||[]);return t.providerData=t.providerData.filter(l=>a.has(l.providerId)),a.has("phone")||(t.phoneNumber=null),await t.auth._persistUserIfCurrent(t),t}async function D1(n,e,t=!1){const s=await yo(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return wa._forOperation(n,"link",s)}async function V1(n,e,t){await Al(e);const s=O_(e.providerData);qe(s.has(t)===n,e.auth,"no-such-provider")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function L1(n,e,t=!1){const{auth:s}=n;if(Sr(s.app))return Promise.reject(Qs(s));const a="reauthenticate";try{const l=await yo(n,L_(s,a,e,n),t);qe(l.idToken,s,"internal-error");const d=Hf(l.idToken);qe(d,s,"internal-error");const{sub:f}=d;return qe(n.uid===f,s,"user-mismatch"),wa._forOperation(n,a,l)}catch(l){throw(l==null?void 0:l.code)==="auth/user-not-found"&&Mr(s,"user-mismatch"),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function M_(n,e,t=!1){if(Sr(n.app))return Promise.reject(Qs(n));const s="signIn",a=await L_(n,s,e),l=await wa._fromIdTokenResponse(n,s,a);return t||await n._updateCurrentUser(l.user),l}async function O1(n,e){return M_(Hi(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function F_(n){const e=Hi(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function M1(n,e,t){if(Sr(n.app))return Promise.reject(Qs(n));const s=Hi(n),d=await ff(s,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",k1).catch(m=>{throw m.code==="auth/password-does-not-meet-requirements"&&F_(n),m}),f=await wa._fromIdTokenResponse(s,"signIn",d);return await s._updateCurrentUser(f.user),f}function U_(n,e,t){return Sr(n.app)?Promise.reject(Qs(n)):O1(sn(n),bo.credential(e,t)).catch(async s=>{throw s.code==="auth/password-does-not-meet-requirements"&&F_(n),s})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function F1(n,e){return Ns(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function U1(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const s=sn(n),l={idToken:await s.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},d=await yo(s,F1(s.auth,l));s.displayName=d.displayName||null,s.photoURL=d.photoUrl||null;const f=s.providerData.find(({providerId:m})=>m==="password");f&&(f.displayName=s.displayName,f.photoURL=s.photoURL),await s._updateTokensIfNecessary(d)}function z1(n,e,t,s){return sn(n).onIdTokenChanged(e,t,s)}function B1(n,e,t){return sn(n).beforeAuthStateChanged(e,t)}function $1(n,e,t,s){return sn(n).onAuthStateChanged(e,t,s)}function z_(n){return sn(n).signOut()}const bu="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B_{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(bu,"1"),this.storage.removeItem(bu),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W1=1e3,G1=10;class $_ extends B_{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=A_(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const s=this.storage.getItem(t),a=this.localCache[t];s!==a&&e(t,a,s)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((d,f,m)=>{this.notifyListeners(d,m)});return}const s=e.key;t?this.detachListener():this.stopPolling();const a=()=>{const d=this.storage.getItem(s);!t&&this.localCache[s]===d||this.notifyListeners(s,d)},l=this.storage.getItem(s);a1()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,G1):a()}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const a of Array.from(s))a(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:s}),!0)})},W1)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}$_.type="LOCAL";const H1=$_;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W_ extends B_{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}W_.type="SESSION";const G_=W_;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q1(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hu{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(a=>a.isListeningto(e));if(t)return t;const s=new Hu(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:s,eventType:a,data:l}=t.data,d=this.handlersMap[a];if(!(d!=null&&d.size))return;t.ports[0].postMessage({status:"ack",eventId:s,eventType:a});const f=Array.from(d).map(async v=>v(t.origin,l)),m=await q1(f);t.ports[0].postMessage({status:"done",eventId:s,eventType:a,response:m})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Hu.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yf(n="",e=10){let t="";for(let s=0;s<e;s++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K1{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,s=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let l,d;return new Promise((f,m)=>{const v=Yf("",20);a.port1.start();const w=setTimeout(()=>{m(new Error("unsupported_event"))},s);d={messageChannel:a,onMessage(S){const C=S;if(C.data.eventId===v)switch(C.data.status){case"ack":clearTimeout(w),l=setTimeout(()=>{m(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),f(C.data.response);break;default:clearTimeout(w),clearTimeout(l),m(new Error("invalid_response"));break}}},this.handlers.add(d),a.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:v,data:t},[a.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ts(){return window}function Q1(n){Ts().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H_(){return typeof Ts().WorkerGlobalScope<"u"&&typeof Ts().importScripts=="function"}async function Y1(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function J1(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function X1(){return H_()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q_="firebaseLocalStorageDb",Z1=1,Pu="firebaseLocalStorage",K_="fbase_key";class Gl{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function qu(n,e){return n.transaction([Pu],e?"readwrite":"readonly").objectStore(Pu)}function eI(){const n=indexedDB.deleteDatabase(q_);return new Gl(n).toPromise()}function pf(){const n=indexedDB.open(q_,Z1);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const s=n.result;try{s.createObjectStore(Pu,{keyPath:K_})}catch(a){t(a)}}),n.addEventListener("success",async()=>{const s=n.result;s.objectStoreNames.contains(Pu)?e(s):(s.close(),await eI(),e(await pf()))})})}async function Sy(n,e,t){const s=qu(n,!0).put({[K_]:e,value:t});return new Gl(s).toPromise()}async function tI(n,e){const t=qu(n,!1).get(e),s=await new Gl(t).toPromise();return s===void 0?null:s.value}function Iy(n,e){const t=qu(n,!0).delete(e);return new Gl(t).toPromise()}const nI=800,rI=3;class Q_{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await pf(),this.db)}async _withRetries(e){let t=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(t++>rI)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return H_()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Hu._getInstance(X1()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await Y1(),!this.activeServiceWorker)return;this.sender=new K1(this.activeServiceWorker);const s=await this.sender._send("ping",{},800);s&&!((e=s[0])===null||e===void 0)&&e.fulfilled&&!((t=s[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||J1()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await pf();return await Sy(e,bu,"1"),await Iy(e,bu),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(s=>Sy(s,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(s=>tI(s,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Iy(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const l=qu(a,!1).getAll();return new Gl(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],s=new Set;if(e.length!==0)for(const{fbase_key:a,value:l}of e)s.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(l)&&(this.notifyListeners(a,l),t.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!s.has(a)&&(this.notifyListeners(a,null),t.push(a));return t}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const a of Array.from(s))a(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),nI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Q_.type="LOCAL";const sI=Q_;new $l(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jf(n,e){return e?qs(e):(qe(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xf extends Kf{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return fo(e,this._buildIdpRequest())}_linkToIdToken(e,t){return fo(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return fo(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function iI(n){return M_(n.auth,new Xf(n),n.bypassAuthState)}function aI(n){const{auth:e,user:t}=n;return qe(t,e,"internal-error"),L1(t,new Xf(n),n.bypassAuthState)}async function oI(n){const{auth:e,user:t}=n;return qe(t,e,"internal-error"),D1(t,new Xf(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y_{constructor(e,t,s,a,l=!1){this.auth=e,this.resolver=s,this.user=a,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:s,postBody:a,tenantId:l,error:d,type:f}=e;if(d){this.reject(d);return}const m={auth:this.auth,requestUri:t,sessionId:s,tenantId:l||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(f)(m))}catch(v){this.reject(v)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return iI;case"linkViaPopup":case"linkViaRedirect":return oI;case"reauthViaPopup":case"reauthViaRedirect":return aI;default:Mr(this.auth,"internal-error")}}resolve(e){Xs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Xs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lI=new $l(2e3,1e4);async function J_(n,e,t){if(Sr(n.app))return Promise.reject(ns(n,"operation-not-supported-in-this-environment"));const s=Hi(n);v_(n,e,Gu);const a=Jf(s,t);return new Pi(s,"signInViaPopup",e,a).executeNotNull()}async function Cy(n,e,t){const s=sn(n);v_(s.auth,e,Gu);const a=Jf(s.auth,t);return new Pi(s.auth,"linkViaPopup",e,a,s).executeNotNull()}class Pi extends Y_{constructor(e,t,s,a,l){super(e,t,a,l),this.provider=s,this.authWindow=null,this.pollId=null,Pi.currentPopupAction&&Pi.currentPopupAction.cancel(),Pi.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return qe(e,this.auth,"internal-error"),e}async onExecution(){Xs(this.filter.length===1,"Popup operations only handle one event");const e=Yf();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(ns(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(ns(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Pi.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,s;if(!((s=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||s===void 0)&&s.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ns(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,lI.get())};e()}}Pi.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cI="pendingRedirect",hu=new Map;class uI extends Y_{constructor(e,t,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,s),this.eventId=null}async execute(){let e=hu.get(this.auth._key());if(!e){try{const s=await dI(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(t){e=()=>Promise.reject(t)}hu.set(this.auth._key(),e)}return this.bypassAuthState||hu.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function dI(n,e){const t=pI(e),s=fI(n);if(!await s._isAvailable())return!1;const a=await s._get(t)==="true";return await s._remove(t),a}function hI(n,e){hu.set(n._key(),e)}function fI(n){return qs(n._redirectPersistence)}function pI(n){return du(cI,n.config.apiKey,n.name)}async function mI(n,e,t=!1){if(Sr(n.app))return Promise.reject(Qs(n));const s=Hi(n),a=Jf(s,e),d=await new uI(s,a,t).execute();return d&&!t&&(delete d.user._redirectEventId,await s._persistUserIfCurrent(d.user),await s._setRedirectUser(null,e)),d}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gI=600*1e3;class yI{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(t=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!vI(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var s;if(e.error&&!X_(e)){const a=((s=e.error.code)===null||s===void 0?void 0:s.split("auth/")[1])||"internal-error";t.onError(ns(this.auth,a))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const s=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=gI&&this.cachedEventUids.clear(),this.cachedEventUids.has(by(e))}saveEventToCache(e){this.cachedEventUids.add(by(e)),this.lastProcessedEventTime=Date.now()}}function by(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function X_({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function vI(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return X_(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _I(n,e={}){return Ns(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wI=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,xI=/^https?/;async function EI(n){if(n.config.emulator)return;const{authorizedDomains:e}=await _I(n);for(const t of e)try{if(TI(t))return}catch{}Mr(n,"unauthorized-domain")}function TI(n){const e=df(),{protocol:t,hostname:s}=new URL(e);if(n.startsWith("chrome-extension://")){const d=new URL(n);return d.hostname===""&&s===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&d.hostname===s}if(!xI.test(t))return!1;if(wI.test(n))return s===n;const a=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(s)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SI=new $l(3e4,6e4);function Py(){const n=Ts().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function II(n){return new Promise((e,t)=>{var s,a,l;function d(){Py(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Py(),t(ns(n,"network-request-failed"))},timeout:SI.get()})}if(!((a=(s=Ts().gapi)===null||s===void 0?void 0:s.iframes)===null||a===void 0)&&a.Iframe)e(gapi.iframes.getContext());else if(!((l=Ts().gapi)===null||l===void 0)&&l.load)d();else{const f=m1("iframefcb");return Ts()[f]=()=>{gapi.load?d():t(ns(n,"network-request-failed"))},j_(`${p1()}?onload=${f}`).catch(m=>t(m))}}).catch(e=>{throw fu=null,e})}let fu=null;function CI(n){return fu=fu||II(n),fu}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bI=new $l(5e3,15e3),PI="__/auth/iframe",RI="emulator/auth/iframe",NI={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},AI=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function kI(n){const e=n.config;qe(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Gf(e,RI):`https://${n.config.authDomain}/${PI}`,s={apiKey:e.apiKey,appName:n.name,v:Co},a=AI.get(n.config.apiHost);a&&(s.eid=a);const l=n._getFrameworks();return l.length&&(s.fw=l.join(",")),`${t}?${Bl(s).slice(1)}`}async function jI(n){const e=await CI(n),t=Ts().gapi;return qe(t,n,"internal-error"),e.open({where:document.body,url:kI(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:NI,dontclear:!0},s=>new Promise(async(a,l)=>{await s.restyle({setHideOnLeave:!1});const d=ns(n,"network-request-failed"),f=Ts().setTimeout(()=>{l(d)},bI.get());function m(){Ts().clearTimeout(f),a(s)}s.ping(m).then(m,()=>{l(d)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DI={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},VI=500,LI=600,OI="_blank",MI="http://localhost";class Ry{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function FI(n,e,t,s=VI,a=LI){const l=Math.max((window.screen.availHeight-a)/2,0).toString(),d=Math.max((window.screen.availWidth-s)/2,0).toString();let f="";const m=Object.assign(Object.assign({},DI),{width:s.toString(),height:a.toString(),top:l,left:d}),v=Hn().toLowerCase();t&&(f=C_(v)?OI:t),S_(v)&&(e=e||MI,m.scrollbars="yes");const w=Object.entries(m).reduce((C,[$,X])=>`${C}${$}=${X},`,"");if(i1(v)&&f!=="_self")return UI(e||"",f),new Ry(null);const S=window.open(e||"",f,w);qe(S,n,"popup-blocked");try{S.focus()}catch{}return new Ry(S)}function UI(n,e){const t=document.createElement("a");t.href=n,t.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zI="__/auth/handler",BI="emulator/auth/handler",$I=encodeURIComponent("fac");async function Ny(n,e,t,s,a,l){qe(n.config.authDomain,n,"auth-domain-config-required"),qe(n.config.apiKey,n,"invalid-api-key");const d={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:s,v:Co,eventId:a};if(e instanceof Gu){e.setDefaultLanguage(n.languageCode),d.providerId=e.providerId||"",ST(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[w,S]of Object.entries({}))d[w]=S}if(e instanceof Po){const w=e.getScopes().filter(S=>S!=="");w.length>0&&(d.scopes=w.join(","))}n.tenantId&&(d.tid=n.tenantId);const f=d;for(const w of Object.keys(f))f[w]===void 0&&delete f[w];const m=await n._getAppCheckToken(),v=m?`#${$I}=${encodeURIComponent(m)}`:"";return`${WI(n)}?${Bl(f).slice(1)}${v}`}function WI({config:n}){return n.emulator?Gf(n,BI):`https://${n.authDomain}/${zI}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kh="webStorageSupport";class GI{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=G_,this._completeRedirectFn=mI,this._overrideRedirectResult=hI}async _openPopup(e,t,s,a){var l;Xs((l=this.eventManagers[e._key()])===null||l===void 0?void 0:l.manager,"_initialize() not called before _openPopup()");const d=await Ny(e,t,s,df(),a);return FI(e,d,Yf())}async _openRedirect(e,t,s,a){await this._originValidation(e);const l=await Ny(e,t,s,df(),a);return Q1(l),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:a,promise:l}=this.eventManagers[t];return a?Promise.resolve(a):(Xs(l,"If manager is not set, promise should be"),l)}const s=this.initAndGetManager(e);return this.eventManagers[t]={promise:s},s.catch(()=>{delete this.eventManagers[t]}),s}async initAndGetManager(e){const t=await jI(e),s=new yI(e);return t.register("authEvent",a=>(qe(a==null?void 0:a.authEvent,e,"invalid-auth-event"),{status:s.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=t,s}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Kh,{type:Kh},a=>{var l;const d=(l=a==null?void 0:a[0])===null||l===void 0?void 0:l[Kh];d!==void 0&&t(!!d),Mr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=EI(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return A_()||I_()||qf()}}const HI=GI;var Ay="@firebase/auth",ky="1.10.8";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qI{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(s=>{e((s==null?void 0:s.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){qe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KI(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function QI(n){go(new _a("auth",(e,{options:t})=>{const s=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:d,authDomain:f}=s.options;qe(d&&!d.includes(":"),"invalid-api-key",{appName:s.name});const m={apiKey:d,authDomain:f,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:k_(n)},v=new d1(s,a,l,m);return x1(v,t),v},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,s)=>{e.getProvider("auth-internal").initialize()})),go(new _a("auth-internal",e=>{const t=Hi(e.getProvider("auth").getImmediate());return(s=>new qI(s))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),ji(Ay,ky,KI(n)),ji(Ay,ky,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YI=300,JI=o_("authIdTokenMaxAge")||YI;let jy=null;const XI=n=>async e=>{const t=e&&await e.getIdTokenResult(),s=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(s&&s>JI)return;const a=t==null?void 0:t.token;jy!==a&&(jy=a,await fetch(n,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function ZI(n=f_()){const e=zf(n,"auth");if(e.isInitialized())return e.getImmediate();const t=w1(n,{popupRedirectResolver:HI,persistence:[sI,H1,G_]}),s=o_("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const l=new URL(s,location.origin);if(location.origin===l.origin){const d=XI(l.toString());B1(t,d,()=>d(t.currentUser)),z1(t,f=>d(f))}}const a=i_("auth");return a&&E1(t,`http://${a}`),t}function eC(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}h1({loadJS(n){return new Promise((e,t)=>{const s=document.createElement("script");s.setAttribute("src",n),s.onload=e,s.onerror=a=>{const l=ns("internal-error");l.customData=a,t(l)},s.type="text/javascript",s.charset="UTF-8",eC().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});QI("Browser");var Dy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Di,Z_;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(k,P){function R(){}R.prototype=P.prototype,k.D=P.prototype,k.prototype=new R,k.prototype.constructor=k,k.C=function(M,B,V){for(var b=Array(arguments.length-2),he=2;he<arguments.length;he++)b[he-2]=arguments[he];return P.prototype[B].apply(M,b)}}function t(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(s,t),s.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(k,P,R){R||(R=0);var M=Array(16);if(typeof P=="string")for(var B=0;16>B;++B)M[B]=P.charCodeAt(R++)|P.charCodeAt(R++)<<8|P.charCodeAt(R++)<<16|P.charCodeAt(R++)<<24;else for(B=0;16>B;++B)M[B]=P[R++]|P[R++]<<8|P[R++]<<16|P[R++]<<24;P=k.g[0],R=k.g[1],B=k.g[2];var V=k.g[3],b=P+(V^R&(B^V))+M[0]+3614090360&4294967295;P=R+(b<<7&4294967295|b>>>25),b=V+(B^P&(R^B))+M[1]+3905402710&4294967295,V=P+(b<<12&4294967295|b>>>20),b=B+(R^V&(P^R))+M[2]+606105819&4294967295,B=V+(b<<17&4294967295|b>>>15),b=R+(P^B&(V^P))+M[3]+3250441966&4294967295,R=B+(b<<22&4294967295|b>>>10),b=P+(V^R&(B^V))+M[4]+4118548399&4294967295,P=R+(b<<7&4294967295|b>>>25),b=V+(B^P&(R^B))+M[5]+1200080426&4294967295,V=P+(b<<12&4294967295|b>>>20),b=B+(R^V&(P^R))+M[6]+2821735955&4294967295,B=V+(b<<17&4294967295|b>>>15),b=R+(P^B&(V^P))+M[7]+4249261313&4294967295,R=B+(b<<22&4294967295|b>>>10),b=P+(V^R&(B^V))+M[8]+1770035416&4294967295,P=R+(b<<7&4294967295|b>>>25),b=V+(B^P&(R^B))+M[9]+2336552879&4294967295,V=P+(b<<12&4294967295|b>>>20),b=B+(R^V&(P^R))+M[10]+4294925233&4294967295,B=V+(b<<17&4294967295|b>>>15),b=R+(P^B&(V^P))+M[11]+2304563134&4294967295,R=B+(b<<22&4294967295|b>>>10),b=P+(V^R&(B^V))+M[12]+1804603682&4294967295,P=R+(b<<7&4294967295|b>>>25),b=V+(B^P&(R^B))+M[13]+4254626195&4294967295,V=P+(b<<12&4294967295|b>>>20),b=B+(R^V&(P^R))+M[14]+2792965006&4294967295,B=V+(b<<17&4294967295|b>>>15),b=R+(P^B&(V^P))+M[15]+1236535329&4294967295,R=B+(b<<22&4294967295|b>>>10),b=P+(B^V&(R^B))+M[1]+4129170786&4294967295,P=R+(b<<5&4294967295|b>>>27),b=V+(R^B&(P^R))+M[6]+3225465664&4294967295,V=P+(b<<9&4294967295|b>>>23),b=B+(P^R&(V^P))+M[11]+643717713&4294967295,B=V+(b<<14&4294967295|b>>>18),b=R+(V^P&(B^V))+M[0]+3921069994&4294967295,R=B+(b<<20&4294967295|b>>>12),b=P+(B^V&(R^B))+M[5]+3593408605&4294967295,P=R+(b<<5&4294967295|b>>>27),b=V+(R^B&(P^R))+M[10]+38016083&4294967295,V=P+(b<<9&4294967295|b>>>23),b=B+(P^R&(V^P))+M[15]+3634488961&4294967295,B=V+(b<<14&4294967295|b>>>18),b=R+(V^P&(B^V))+M[4]+3889429448&4294967295,R=B+(b<<20&4294967295|b>>>12),b=P+(B^V&(R^B))+M[9]+568446438&4294967295,P=R+(b<<5&4294967295|b>>>27),b=V+(R^B&(P^R))+M[14]+3275163606&4294967295,V=P+(b<<9&4294967295|b>>>23),b=B+(P^R&(V^P))+M[3]+4107603335&4294967295,B=V+(b<<14&4294967295|b>>>18),b=R+(V^P&(B^V))+M[8]+1163531501&4294967295,R=B+(b<<20&4294967295|b>>>12),b=P+(B^V&(R^B))+M[13]+2850285829&4294967295,P=R+(b<<5&4294967295|b>>>27),b=V+(R^B&(P^R))+M[2]+4243563512&4294967295,V=P+(b<<9&4294967295|b>>>23),b=B+(P^R&(V^P))+M[7]+1735328473&4294967295,B=V+(b<<14&4294967295|b>>>18),b=R+(V^P&(B^V))+M[12]+2368359562&4294967295,R=B+(b<<20&4294967295|b>>>12),b=P+(R^B^V)+M[5]+4294588738&4294967295,P=R+(b<<4&4294967295|b>>>28),b=V+(P^R^B)+M[8]+2272392833&4294967295,V=P+(b<<11&4294967295|b>>>21),b=B+(V^P^R)+M[11]+1839030562&4294967295,B=V+(b<<16&4294967295|b>>>16),b=R+(B^V^P)+M[14]+4259657740&4294967295,R=B+(b<<23&4294967295|b>>>9),b=P+(R^B^V)+M[1]+2763975236&4294967295,P=R+(b<<4&4294967295|b>>>28),b=V+(P^R^B)+M[4]+1272893353&4294967295,V=P+(b<<11&4294967295|b>>>21),b=B+(V^P^R)+M[7]+4139469664&4294967295,B=V+(b<<16&4294967295|b>>>16),b=R+(B^V^P)+M[10]+3200236656&4294967295,R=B+(b<<23&4294967295|b>>>9),b=P+(R^B^V)+M[13]+681279174&4294967295,P=R+(b<<4&4294967295|b>>>28),b=V+(P^R^B)+M[0]+3936430074&4294967295,V=P+(b<<11&4294967295|b>>>21),b=B+(V^P^R)+M[3]+3572445317&4294967295,B=V+(b<<16&4294967295|b>>>16),b=R+(B^V^P)+M[6]+76029189&4294967295,R=B+(b<<23&4294967295|b>>>9),b=P+(R^B^V)+M[9]+3654602809&4294967295,P=R+(b<<4&4294967295|b>>>28),b=V+(P^R^B)+M[12]+3873151461&4294967295,V=P+(b<<11&4294967295|b>>>21),b=B+(V^P^R)+M[15]+530742520&4294967295,B=V+(b<<16&4294967295|b>>>16),b=R+(B^V^P)+M[2]+3299628645&4294967295,R=B+(b<<23&4294967295|b>>>9),b=P+(B^(R|~V))+M[0]+4096336452&4294967295,P=R+(b<<6&4294967295|b>>>26),b=V+(R^(P|~B))+M[7]+1126891415&4294967295,V=P+(b<<10&4294967295|b>>>22),b=B+(P^(V|~R))+M[14]+2878612391&4294967295,B=V+(b<<15&4294967295|b>>>17),b=R+(V^(B|~P))+M[5]+4237533241&4294967295,R=B+(b<<21&4294967295|b>>>11),b=P+(B^(R|~V))+M[12]+1700485571&4294967295,P=R+(b<<6&4294967295|b>>>26),b=V+(R^(P|~B))+M[3]+2399980690&4294967295,V=P+(b<<10&4294967295|b>>>22),b=B+(P^(V|~R))+M[10]+4293915773&4294967295,B=V+(b<<15&4294967295|b>>>17),b=R+(V^(B|~P))+M[1]+2240044497&4294967295,R=B+(b<<21&4294967295|b>>>11),b=P+(B^(R|~V))+M[8]+1873313359&4294967295,P=R+(b<<6&4294967295|b>>>26),b=V+(R^(P|~B))+M[15]+4264355552&4294967295,V=P+(b<<10&4294967295|b>>>22),b=B+(P^(V|~R))+M[6]+2734768916&4294967295,B=V+(b<<15&4294967295|b>>>17),b=R+(V^(B|~P))+M[13]+1309151649&4294967295,R=B+(b<<21&4294967295|b>>>11),b=P+(B^(R|~V))+M[4]+4149444226&4294967295,P=R+(b<<6&4294967295|b>>>26),b=V+(R^(P|~B))+M[11]+3174756917&4294967295,V=P+(b<<10&4294967295|b>>>22),b=B+(P^(V|~R))+M[2]+718787259&4294967295,B=V+(b<<15&4294967295|b>>>17),b=R+(V^(B|~P))+M[9]+3951481745&4294967295,k.g[0]=k.g[0]+P&4294967295,k.g[1]=k.g[1]+(B+(b<<21&4294967295|b>>>11))&4294967295,k.g[2]=k.g[2]+B&4294967295,k.g[3]=k.g[3]+V&4294967295}s.prototype.u=function(k,P){P===void 0&&(P=k.length);for(var R=P-this.blockSize,M=this.B,B=this.h,V=0;V<P;){if(B==0)for(;V<=R;)a(this,k,V),V+=this.blockSize;if(typeof k=="string"){for(;V<P;)if(M[B++]=k.charCodeAt(V++),B==this.blockSize){a(this,M),B=0;break}}else for(;V<P;)if(M[B++]=k[V++],B==this.blockSize){a(this,M),B=0;break}}this.h=B,this.o+=P},s.prototype.v=function(){var k=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);k[0]=128;for(var P=1;P<k.length-8;++P)k[P]=0;var R=8*this.o;for(P=k.length-8;P<k.length;++P)k[P]=R&255,R/=256;for(this.u(k),k=Array(16),P=R=0;4>P;++P)for(var M=0;32>M;M+=8)k[R++]=this.g[P]>>>M&255;return k};function l(k,P){var R=f;return Object.prototype.hasOwnProperty.call(R,k)?R[k]:R[k]=P(k)}function d(k,P){this.h=P;for(var R=[],M=!0,B=k.length-1;0<=B;B--){var V=k[B]|0;M&&V==P||(R[B]=V,M=!1)}this.g=R}var f={};function m(k){return-128<=k&&128>k?l(k,function(P){return new d([P|0],0>P?-1:0)}):new d([k|0],0>k?-1:0)}function v(k){if(isNaN(k)||!isFinite(k))return S;if(0>k)return U(v(-k));for(var P=[],R=1,M=0;k>=R;M++)P[M]=k/R|0,R*=4294967296;return new d(P,0)}function w(k,P){if(k.length==0)throw Error("number format error: empty string");if(P=P||10,2>P||36<P)throw Error("radix out of range: "+P);if(k.charAt(0)=="-")return U(w(k.substring(1),P));if(0<=k.indexOf("-"))throw Error('number format error: interior "-" character');for(var R=v(Math.pow(P,8)),M=S,B=0;B<k.length;B+=8){var V=Math.min(8,k.length-B),b=parseInt(k.substring(B,B+V),P);8>V?(V=v(Math.pow(P,V)),M=M.j(V).add(v(b))):(M=M.j(R),M=M.add(v(b)))}return M}var S=m(0),C=m(1),$=m(16777216);n=d.prototype,n.m=function(){if(q(this))return-U(this).m();for(var k=0,P=1,R=0;R<this.g.length;R++){var M=this.i(R);k+=(0<=M?M:4294967296+M)*P,P*=4294967296}return k},n.toString=function(k){if(k=k||10,2>k||36<k)throw Error("radix out of range: "+k);if(X(this))return"0";if(q(this))return"-"+U(this).toString(k);for(var P=v(Math.pow(k,6)),R=this,M="";;){var B=ye(R,P).g;R=ne(R,B.j(P));var V=((0<R.g.length?R.g[0]:R.h)>>>0).toString(k);if(R=B,X(R))return V+M;for(;6>V.length;)V="0"+V;M=V+M}},n.i=function(k){return 0>k?0:k<this.g.length?this.g[k]:this.h};function X(k){if(k.h!=0)return!1;for(var P=0;P<k.g.length;P++)if(k.g[P]!=0)return!1;return!0}function q(k){return k.h==-1}n.l=function(k){return k=ne(this,k),q(k)?-1:X(k)?0:1};function U(k){for(var P=k.g.length,R=[],M=0;M<P;M++)R[M]=~k.g[M];return new d(R,~k.h).add(C)}n.abs=function(){return q(this)?U(this):this},n.add=function(k){for(var P=Math.max(this.g.length,k.g.length),R=[],M=0,B=0;B<=P;B++){var V=M+(this.i(B)&65535)+(k.i(B)&65535),b=(V>>>16)+(this.i(B)>>>16)+(k.i(B)>>>16);M=b>>>16,V&=65535,b&=65535,R[B]=b<<16|V}return new d(R,R[R.length-1]&-2147483648?-1:0)};function ne(k,P){return k.add(U(P))}n.j=function(k){if(X(this)||X(k))return S;if(q(this))return q(k)?U(this).j(U(k)):U(U(this).j(k));if(q(k))return U(this.j(U(k)));if(0>this.l($)&&0>k.l($))return v(this.m()*k.m());for(var P=this.g.length+k.g.length,R=[],M=0;M<2*P;M++)R[M]=0;for(M=0;M<this.g.length;M++)for(var B=0;B<k.g.length;B++){var V=this.i(M)>>>16,b=this.i(M)&65535,he=k.i(B)>>>16,ve=k.i(B)&65535;R[2*M+2*B]+=b*ve,xe(R,2*M+2*B),R[2*M+2*B+1]+=V*ve,xe(R,2*M+2*B+1),R[2*M+2*B+1]+=b*he,xe(R,2*M+2*B+1),R[2*M+2*B+2]+=V*he,xe(R,2*M+2*B+2)}for(M=0;M<P;M++)R[M]=R[2*M+1]<<16|R[2*M];for(M=P;M<2*P;M++)R[M]=0;return new d(R,0)};function xe(k,P){for(;(k[P]&65535)!=k[P];)k[P+1]+=k[P]>>>16,k[P]&=65535,P++}function ge(k,P){this.g=k,this.h=P}function ye(k,P){if(X(P))throw Error("division by zero");if(X(k))return new ge(S,S);if(q(k))return P=ye(U(k),P),new ge(U(P.g),U(P.h));if(q(P))return P=ye(k,U(P)),new ge(U(P.g),P.h);if(30<k.g.length){if(q(k)||q(P))throw Error("slowDivide_ only works with positive integers.");for(var R=C,M=P;0>=M.l(k);)R=ie(R),M=ie(M);var B=Ee(R,1),V=Ee(M,1);for(M=Ee(M,2),R=Ee(R,2);!X(M);){var b=V.add(M);0>=b.l(k)&&(B=B.add(R),V=b),M=Ee(M,1),R=Ee(R,1)}return P=ne(k,B.j(P)),new ge(B,P)}for(B=S;0<=k.l(P);){for(R=Math.max(1,Math.floor(k.m()/P.m())),M=Math.ceil(Math.log(R)/Math.LN2),M=48>=M?1:Math.pow(2,M-48),V=v(R),b=V.j(P);q(b)||0<b.l(k);)R-=M,V=v(R),b=V.j(P);X(V)&&(V=C),B=B.add(V),k=ne(k,b)}return new ge(B,k)}n.A=function(k){return ye(this,k).h},n.and=function(k){for(var P=Math.max(this.g.length,k.g.length),R=[],M=0;M<P;M++)R[M]=this.i(M)&k.i(M);return new d(R,this.h&k.h)},n.or=function(k){for(var P=Math.max(this.g.length,k.g.length),R=[],M=0;M<P;M++)R[M]=this.i(M)|k.i(M);return new d(R,this.h|k.h)},n.xor=function(k){for(var P=Math.max(this.g.length,k.g.length),R=[],M=0;M<P;M++)R[M]=this.i(M)^k.i(M);return new d(R,this.h^k.h)};function ie(k){for(var P=k.g.length+1,R=[],M=0;M<P;M++)R[M]=k.i(M)<<1|k.i(M-1)>>>31;return new d(R,k.h)}function Ee(k,P){var R=P>>5;P%=32;for(var M=k.g.length-R,B=[],V=0;V<M;V++)B[V]=0<P?k.i(V+R)>>>P|k.i(V+R+1)<<32-P:k.i(V+R);return new d(B,k.h)}s.prototype.digest=s.prototype.v,s.prototype.reset=s.prototype.s,s.prototype.update=s.prototype.u,Z_=s,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.A,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=v,d.fromString=w,Di=d}).apply(typeof Dy<"u"?Dy:typeof self<"u"?self:typeof window<"u"?window:{});var iu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var e0,gl,t0,pu,mf,n0,r0,s0;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,g,_){return u==Array.prototype||u==Object.prototype||(u[g]=_.value),u};function t(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof iu=="object"&&iu];for(var g=0;g<u.length;++g){var _=u[g];if(_&&_.Math==Math)return _}throw Error("Cannot find global object")}var s=t(this);function a(u,g){if(g)e:{var _=s;u=u.split(".");for(var I=0;I<u.length-1;I++){var K=u[I];if(!(K in _))break e;_=_[K]}u=u[u.length-1],I=_[u],g=g(I),g!=I&&g!=null&&e(_,u,{configurable:!0,writable:!0,value:g})}}function l(u,g){u instanceof String&&(u+="");var _=0,I=!1,K={next:function(){if(!I&&_<u.length){var re=_++;return{value:g(re,u[re]),done:!1}}return I=!0,{done:!0,value:void 0}}};return K[Symbol.iterator]=function(){return K},K}a("Array.prototype.values",function(u){return u||function(){return l(this,function(g,_){return _})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var d=d||{},f=this||self;function m(u){var g=typeof u;return g=g!="object"?g:u?Array.isArray(u)?"array":g:"null",g=="array"||g=="object"&&typeof u.length=="number"}function v(u){var g=typeof u;return g=="object"&&u!=null||g=="function"}function w(u,g,_){return u.call.apply(u.bind,arguments)}function S(u,g,_){if(!u)throw Error();if(2<arguments.length){var I=Array.prototype.slice.call(arguments,2);return function(){var K=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(K,I),u.apply(g,K)}}return function(){return u.apply(g,arguments)}}function C(u,g,_){return C=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?w:S,C.apply(null,arguments)}function $(u,g){var _=Array.prototype.slice.call(arguments,1);return function(){var I=_.slice();return I.push.apply(I,arguments),u.apply(this,I)}}function X(u,g){function _(){}_.prototype=g.prototype,u.aa=g.prototype,u.prototype=new _,u.prototype.constructor=u,u.Qb=function(I,K,re){for(var Se=Array(arguments.length-2),Ct=2;Ct<arguments.length;Ct++)Se[Ct-2]=arguments[Ct];return g.prototype[K].apply(I,Se)}}function q(u){const g=u.length;if(0<g){const _=Array(g);for(let I=0;I<g;I++)_[I]=u[I];return _}return[]}function U(u,g){for(let _=1;_<arguments.length;_++){const I=arguments[_];if(m(I)){const K=u.length||0,re=I.length||0;u.length=K+re;for(let Se=0;Se<re;Se++)u[K+Se]=I[Se]}else u.push(I)}}class ne{constructor(g,_){this.i=g,this.j=_,this.h=0,this.g=null}get(){let g;return 0<this.h?(this.h--,g=this.g,this.g=g.next,g.next=null):g=this.i(),g}}function xe(u){return/^[\s\xa0]*$/.test(u)}function ge(){var u=f.navigator;return u&&(u=u.userAgent)?u:""}function ye(u){return ye[" "](u),u}ye[" "]=function(){};var ie=ge().indexOf("Gecko")!=-1&&!(ge().toLowerCase().indexOf("webkit")!=-1&&ge().indexOf("Edge")==-1)&&!(ge().indexOf("Trident")!=-1||ge().indexOf("MSIE")!=-1)&&ge().indexOf("Edge")==-1;function Ee(u,g,_){for(const I in u)g.call(_,u[I],I,u)}function k(u,g){for(const _ in u)g.call(void 0,u[_],_,u)}function P(u){const g={};for(const _ in u)g[_]=u[_];return g}const R="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function M(u,g){let _,I;for(let K=1;K<arguments.length;K++){I=arguments[K];for(_ in I)u[_]=I[_];for(let re=0;re<R.length;re++)_=R[re],Object.prototype.hasOwnProperty.call(I,_)&&(u[_]=I[_])}}function B(u){var g=1;u=u.split(":");const _=[];for(;0<g&&u.length;)_.push(u.shift()),g--;return u.length&&_.push(u.join(":")),_}function V(u){f.setTimeout(()=>{throw u},0)}function b(){var u=be;let g=null;return u.g&&(g=u.g,u.g=u.g.next,u.g||(u.h=null),g.next=null),g}class he{constructor(){this.h=this.g=null}add(g,_){const I=ve.get();I.set(g,_),this.h?this.h.next=I:this.g=I,this.h=I}}var ve=new ne(()=>new ot,u=>u.reset());class ot{constructor(){this.next=this.g=this.h=null}set(g,_){this.h=g,this.g=_,this.next=null}reset(){this.next=this.g=this.h=null}}let Ve,pe=!1,be=new he,Te=()=>{const u=f.Promise.resolve(void 0);Ve=()=>{u.then(A)}};var A=()=>{for(var u;u=b();){try{u.h.call(u.g)}catch(_){V(_)}var g=ve;g.j(u),100>g.h&&(g.h++,u.next=g.g,g.g=u)}pe=!1};function N(){this.s=this.s,this.C=this.C}N.prototype.s=!1,N.prototype.ma=function(){this.s||(this.s=!0,this.N())},N.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function se(u,g){this.type=u,this.g=this.target=g,this.defaultPrevented=!1}se.prototype.h=function(){this.defaultPrevented=!0};var ee=(function(){if(!f.addEventListener||!Object.defineProperty)return!1;var u=!1,g=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const _=()=>{};f.addEventListener("test",_,g),f.removeEventListener("test",_,g)}catch{}return u})();function _e(u,g){if(se.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var _=this.type=u.type,I=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=g,g=u.relatedTarget){if(ie){e:{try{ye(g.nodeName);var K=!0;break e}catch{}K=!1}K||(g=null)}}else _=="mouseover"?g=u.fromElement:_=="mouseout"&&(g=u.toElement);this.relatedTarget=g,I?(this.clientX=I.clientX!==void 0?I.clientX:I.pageX,this.clientY=I.clientY!==void 0?I.clientY:I.pageY,this.screenX=I.screenX||0,this.screenY=I.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:me[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&_e.aa.h.call(this)}}X(_e,se);var me={2:"touch",3:"pen",4:"mouse"};_e.prototype.h=function(){_e.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var Ae="closure_listenable_"+(1e6*Math.random()|0),Me=0;function Qe(u,g,_,I,K){this.listener=u,this.proxy=null,this.src=g,this.type=_,this.capture=!!I,this.ha=K,this.key=++Me,this.da=this.fa=!1}function xt(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function te(u){this.src=u,this.g={},this.h=0}te.prototype.add=function(u,g,_,I,K){var re=u.toString();u=this.g[re],u||(u=this.g[re]=[],this.h++);var Se=Be(u,g,I,K);return-1<Se?(g=u[Se],_||(g.fa=!1)):(g=new Qe(g,this.src,re,!!I,K),g.fa=_,u.push(g)),g};function Fe(u,g){var _=g.type;if(_ in u.g){var I=u.g[_],K=Array.prototype.indexOf.call(I,g,void 0),re;(re=0<=K)&&Array.prototype.splice.call(I,K,1),re&&(xt(g),u.g[_].length==0&&(delete u.g[_],u.h--))}}function Be(u,g,_,I){for(var K=0;K<u.length;++K){var re=u[K];if(!re.da&&re.listener==g&&re.capture==!!_&&re.ha==I)return K}return-1}var We="closure_lm_"+(1e6*Math.random()|0),Et={};function wt(u,g,_,I,K){if(Array.isArray(g)){for(var re=0;re<g.length;re++)wt(u,g[re],_,I,K);return null}return _=sr(_),u&&u[Ae]?u.K(g,_,v(I)?!!I.capture:!1,K):pt(u,g,_,!1,I,K)}function pt(u,g,_,I,K,re){if(!g)throw Error("Invalid event type");var Se=v(K)?!!K.capture:!!K,Ct=qn(u);if(Ct||(u[We]=Ct=new te(u)),_=Ct.add(g,_,I,Se,re),_.proxy)return _;if(I=Tt(),_.proxy=I,I.src=u,I.listener=_,u.addEventListener)ee||(K=Se),K===void 0&&(K=!1),u.addEventListener(g.toString(),I,K);else if(u.attachEvent)u.attachEvent(In(g.toString()),I);else if(u.addListener&&u.removeListener)u.addListener(I);else throw Error("addEventListener and attachEvent are unavailable.");return _}function Tt(){function u(_){return g.call(u.src,u.listener,_)}const g=gn;return u}function Ut(u,g,_,I,K){if(Array.isArray(g))for(var re=0;re<g.length;re++)Ut(u,g[re],_,I,K);else I=v(I)?!!I.capture:!!I,_=sr(_),u&&u[Ae]?(u=u.i,g=String(g).toString(),g in u.g&&(re=u.g[g],_=Be(re,_,I,K),-1<_&&(xt(re[_]),Array.prototype.splice.call(re,_,1),re.length==0&&(delete u.g[g],u.h--)))):u&&(u=qn(u))&&(g=u.g[g.toString()],u=-1,g&&(u=Be(g,_,I,K)),(_=-1<u?g[u]:null)&&It(_))}function It(u){if(typeof u!="number"&&u&&!u.da){var g=u.src;if(g&&g[Ae])Fe(g.i,u);else{var _=u.type,I=u.proxy;g.removeEventListener?g.removeEventListener(_,I,u.capture):g.detachEvent?g.detachEvent(In(_),I):g.addListener&&g.removeListener&&g.removeListener(I),(_=qn(g))?(Fe(_,u),_.h==0&&(_.src=null,g[We]=null)):xt(u)}}}function In(u){return u in Et?Et[u]:Et[u]="on"+u}function gn(u,g){if(u.da)u=!0;else{g=new _e(g,this);var _=u.listener,I=u.ha||u.src;u.fa&&It(u),u=_.call(I,g)}return u}function qn(u){return u=u[We],u instanceof te?u:null}var yn="__closure_events_fn_"+(1e9*Math.random()>>>0);function sr(u){return typeof u=="function"?u:(u[yn]||(u[yn]=function(g){return u.handleEvent(g)}),u[yn])}function Lt(){N.call(this),this.i=new te(this),this.M=this,this.F=null}X(Lt,N),Lt.prototype[Ae]=!0,Lt.prototype.removeEventListener=function(u,g,_,I){Ut(this,u,g,_,I)};function bt(u,g){var _,I=u.F;if(I)for(_=[];I;I=I.F)_.push(I);if(u=u.M,I=g.type||g,typeof g=="string")g=new se(g,u);else if(g instanceof se)g.target=g.target||u;else{var K=g;g=new se(I,u),M(g,K)}if(K=!0,_)for(var re=_.length-1;0<=re;re--){var Se=g.g=_[re];K=yr(Se,I,!0,g)&&K}if(Se=g.g=u,K=yr(Se,I,!0,g)&&K,K=yr(Se,I,!1,g)&&K,_)for(re=0;re<_.length;re++)Se=g.g=_[re],K=yr(Se,I,!1,g)&&K}Lt.prototype.N=function(){if(Lt.aa.N.call(this),this.i){var u=this.i,g;for(g in u.g){for(var _=u.g[g],I=0;I<_.length;I++)xt(_[I]);delete u.g[g],u.h--}}this.F=null},Lt.prototype.K=function(u,g,_,I){return this.i.add(String(u),g,!1,_,I)},Lt.prototype.L=function(u,g,_,I){return this.i.add(String(u),g,!0,_,I)};function yr(u,g,_,I){if(g=u.i.g[String(g)],!g)return!0;g=g.concat();for(var K=!0,re=0;re<g.length;++re){var Se=g[re];if(Se&&!Se.da&&Se.capture==_){var Ct=Se.listener,un=Se.ha||Se.src;Se.fa&&Fe(u.i,Se),K=Ct.call(un,I)!==!1&&K}}return K&&!I.defaultPrevented}function ss(u,g,_){if(typeof u=="function")_&&(u=C(u,_));else if(u&&typeof u.handleEvent=="function")u=C(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(g)?-1:f.setTimeout(u,g||0)}function Vn(u){u.g=ss(()=>{u.g=null,u.i&&(u.i=!1,Vn(u))},u.l);const g=u.h;u.h=null,u.m.apply(null,g)}class an extends N{constructor(g,_){super(),this.m=g,this.l=_,this.h=null,this.i=!1,this.g=null}j(g){this.h=arguments,this.g?this.i=!0:Vn(this)}N(){super.N(),this.g&&(f.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ir(u){N.call(this),this.h=u,this.g={}}X(ir,N);var is=[];function mt(u){Ee(u.g,function(g,_){this.g.hasOwnProperty(_)&&It(g)},u),u.g={}}ir.prototype.N=function(){ir.aa.N.call(this),mt(this)},ir.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var as=f.JSON.stringify,As=f.JSON.parse,ri=class{stringify(u){return f.JSON.stringify(u,void 0)}parse(u){return f.JSON.parse(u,void 0)}};function on(){}on.prototype.h=null;function Cn(u){return u.h||(u.h=u.i())}function ar(){}var Yt={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ht(){se.call(this,"d")}X(Ht,se);function ln(){se.call(this,"c")}X(ln,se);var vn={},os=null;function yt(){return os=os||new Lt}vn.La="serverreachability";function ls(u){se.call(this,vn.La,u)}X(ls,se);function Kn(u){const g=yt();bt(g,new ls(g))}vn.STAT_EVENT="statevent";function Ln(u,g){se.call(this,vn.STAT_EVENT,u),this.stat=g}X(Ln,se);function Rt(u){const g=yt();bt(g,new Ln(g,u))}vn.Ma="timingevent";function Jt(u,g){se.call(this,vn.Ma,u),this.size=g}X(Jt,se);function On(u,g){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return f.setTimeout(function(){u()},g)}function vr(){this.g=!0}vr.prototype.xa=function(){this.g=!1};function _n(u,g,_,I,K,re){u.info(function(){if(u.g)if(re)for(var Se="",Ct=re.split("&"),un=0;un<Ct.length;un++){var ht=Ct[un].split("=");if(1<ht.length){var wn=ht[0];ht=ht[1];var Zt=wn.split("_");Se=2<=Zt.length&&Zt[1]=="type"?Se+(wn+"="+ht+"&"):Se+(wn+"=redacted&")}}else Se=null;else Se=re;return"XMLHTTP REQ ("+I+") [attempt "+K+"]: "+g+`
`+_+`
`+Se})}function Qn(u,g,_,I,K,re,Se){u.info(function(){return"XMLHTTP RESP ("+I+") [ attempt "+K+"]: "+g+`
`+_+`
`+re+" "+Se})}function bn(u,g,_,I){u.info(function(){return"XMLHTTP TEXT ("+g+"): "+Qi(u,_)+(I?" "+I:"")})}function Cr(u,g){u.info(function(){return"TIMEOUT: "+g})}vr.prototype.info=function(){};function Qi(u,g){if(!u.g)return g;if(!g)return null;try{var _=JSON.parse(g);if(_){for(u=0;u<_.length;u++)if(Array.isArray(_[u])){var I=_[u];if(!(2>I.length)){var K=I[1];if(Array.isArray(K)&&!(1>K.length)){var re=K[0];if(re!="noop"&&re!="stop"&&re!="close")for(var Se=1;Se<K.length;Se++)K[Se]=""}}}}return as(_)}catch{return g}}var Fr={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},cs={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Yn;function Ur(){}X(Ur,on),Ur.prototype.g=function(){return new XMLHttpRequest},Ur.prototype.i=function(){return{}},Yn=new Ur;function Jn(u,g,_,I){this.j=u,this.i=g,this.l=_,this.R=I||1,this.U=new ir(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new si}function si(){this.i=null,this.g="",this.h=!1}var ks={},zr={};function lt(u,g,_){u.L=1,u.v=Mn(Ot(g)),u.m=_,u.P=!0,Xn(u,null)}function Xn(u,g){u.F=Date.now(),H(u),u.A=Ot(u.v);var _=u.A,I=u.R;Array.isArray(I)||(I=[String(I)]),ai(_.i,"t",I),u.C=0,_=u.j.J,u.h=new si,u.g=lc(u.j,_?g:null,!u.m),0<u.O&&(u.M=new an(C(u.Y,u,u.g),u.O)),g=u.U,_=u.g,I=u.ca;var K="readystatechange";Array.isArray(K)||(K&&(is[0]=K.toString()),K=is);for(var re=0;re<K.length;re++){var Se=wt(_,K[re],I||g.handleEvent,!1,g.h||g);if(!Se)break;g.g[Se.key]=Se}g=u.H?P(u.H):{},u.m?(u.u||(u.u="POST"),g["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,g)):(u.u="GET",u.g.ea(u.A,u.u,null,g)),Kn(),_n(u.i,u.u,u.A,u.l,u.R,u.m)}Jn.prototype.ca=function(u){u=u.target;const g=this.M;g&&lr(u)==3?g.j():this.Y(u)},Jn.prototype.Y=function(u){try{if(u==this.g)e:{const Zt=lr(this.g);var g=this.g.Ba();const Pr=this.g.Z();if(!(3>Zt)&&(Zt!=3||this.g&&(this.h.h||this.g.oa()||Oo(this.g)))){this.J||Zt!=4||g==7||(g==8||0>=Pr?Kn(3):Kn(2)),O(this);var _=this.g.Z();this.X=_;t:if(Xt(this)){var I=Oo(this.g);u="";var K=I.length,re=lr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ce(this),W(this);var Se="";break t}this.h.i=new f.TextDecoder}for(g=0;g<K;g++)this.h.h=!0,u+=this.h.i.decode(I[g],{stream:!(re&&g==K-1)});I.length=0,this.h.g+=u,this.C=0,Se=this.h.g}else Se=this.g.oa();if(this.o=_==200,Qn(this.i,this.u,this.A,this.l,this.R,Zt,_),this.o){if(this.T&&!this.K){t:{if(this.g){var Ct,un=this.g;if((Ct=un.g?un.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!xe(Ct)){var ht=Ct;break t}}ht=null}if(_=ht)bn(this.i,this.l,_,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ie(this,_);else{this.o=!1,this.s=3,Rt(12),ce(this),W(this);break e}}if(this.P){_=!0;let wr;for(;!this.J&&this.C<Se.length;)if(wr=E(this,Se),wr==zr){Zt==4&&(this.s=4,Rt(14),_=!1),bn(this.i,this.l,null,"[Incomplete Response]");break}else if(wr==ks){this.s=4,Rt(15),bn(this.i,this.l,Se,"[Invalid Chunk]"),_=!1;break}else bn(this.i,this.l,wr,null),Ie(this,wr);if(Xt(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Zt!=4||Se.length!=0||this.h.h||(this.s=1,Rt(16),_=!1),this.o=this.o&&_,!_)bn(this.i,this.l,Se,"[Invalid Chunked Response]"),ce(this),W(this);else if(0<Se.length&&!this.W){this.W=!0;var wn=this.j;wn.g==this&&wn.ba&&!wn.M&&(wn.j.info("Great, no buffering proxy detected. Bytes received: "+Se.length),Fo(wn),wn.M=!0,Rt(11))}}else bn(this.i,this.l,Se,null),Ie(this,Se);Zt==4&&ce(this),this.o&&!this.J&&(Zt==4?La(this.j,this):(this.o=!1,H(this)))}else Aa(this.g),_==400&&0<Se.indexOf("Unknown SID")?(this.s=3,Rt(12)):(this.s=0,Rt(13)),ce(this),W(this)}}}catch{}finally{}};function Xt(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function E(u,g){var _=u.C,I=g.indexOf(`
`,_);return I==-1?zr:(_=Number(g.substring(_,I)),isNaN(_)?ks:(I+=1,I+_>g.length?zr:(g=g.slice(I,I+_),u.C=I+_,g)))}Jn.prototype.cancel=function(){this.J=!0,ce(this)};function H(u){u.S=Date.now()+u.I,Y(u,u.I)}function Y(u,g){if(u.B!=null)throw Error("WatchDog timer not null");u.B=On(C(u.ba,u),g)}function O(u){u.B&&(f.clearTimeout(u.B),u.B=null)}Jn.prototype.ba=function(){this.B=null;const u=Date.now();0<=u-this.S?(Cr(this.i,this.A),this.L!=2&&(Kn(),Rt(17)),ce(this),this.s=2,W(this)):Y(this,this.S-u)};function W(u){u.j.G==0||u.J||La(u.j,u)}function ce(u){O(u);var g=u.M;g&&typeof g.ma=="function"&&g.ma(),u.M=null,mt(u.U),u.g&&(g=u.g,u.g=null,g.abort(),g.ma())}function Ie(u,g){try{var _=u.j;if(_.G!=0&&(_.g==u||F(_.h,u))){if(!u.K&&F(_.h,u)&&_.G==3){try{var I=_.Da.g.parse(g)}catch{I=null}if(Array.isArray(I)&&I.length==3){var K=I;if(K[0]==0){e:if(!_.u){if(_.g)if(_.g.F+3e3<u.F)Va(_),Hr(_);else break e;Da(_),Rt(18)}}else _.za=K[1],0<_.za-_.T&&37500>K[2]&&_.F&&_.v==0&&!_.C&&(_.C=On(C(_.Za,_),6e3));if(1>=L(_.h)&&_.ca){try{_.ca()}catch{}_.ca=void 0}}else Ls(_,11)}else if((u.K||_.g==u)&&Va(_),!xe(g))for(K=_.Da.g.parse(g),g=0;g<K.length;g++){let ht=K[g];if(_.T=ht[0],ht=ht[1],_.G==2)if(ht[0]=="c"){_.K=ht[1],_.ia=ht[2];const wn=ht[3];wn!=null&&(_.la=wn,_.j.info("VER="+_.la));const Zt=ht[4];Zt!=null&&(_.Aa=Zt,_.j.info("SVER="+_.Aa));const Pr=ht[5];Pr!=null&&typeof Pr=="number"&&0<Pr&&(I=1.5*Pr,_.L=I,_.j.info("backChannelRequestTimeoutMs_="+I)),I=_;const wr=u.g;if(wr){const Zi=wr.g?wr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Zi){var re=I.h;re.g||Zi.indexOf("spdy")==-1&&Zi.indexOf("quic")==-1&&Zi.indexOf("h2")==-1||(re.j=re.l,re.g=new Set,re.h&&(oe(re,re.h),re.h=null))}if(I.D){const Ma=wr.g?wr.g.getResponseHeader("X-HTTP-Session-Id"):null;Ma&&(I.ya=Ma,nt(I.I,I.D,Ma))}}_.G=3,_.l&&_.l.ua(),_.ba&&(_.R=Date.now()-u.F,_.j.info("Handshake RTT: "+_.R+"ms")),I=_;var Se=u;if(I.qa=oc(I,I.J?I.ia:null,I.W),Se.K){Pe(I.h,Se);var Ct=Se,un=I.L;un&&(Ct.I=un),Ct.B&&(O(Ct),H(Ct)),I.g=Se}else Xi(I);0<_.i.length&&ms(_)}else ht[0]!="stop"&&ht[0]!="close"||Ls(_,7);else _.G==3&&(ht[0]=="stop"||ht[0]=="close"?ht[0]=="stop"?Ls(_,7):Rn(_):ht[0]!="noop"&&_.l&&_.l.ta(ht),_.v=0)}}Kn(4)}catch{}}var Je=class{constructor(u,g){this.g=u,this.map=g}};function Ce(u){this.l=u||10,f.PerformanceNavigationTiming?(u=f.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(f.chrome&&f.chrome.loadTimes&&f.chrome.loadTimes()&&f.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function T(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function L(u){return u.h?1:u.g?u.g.size:0}function F(u,g){return u.h?u.h==g:u.g?u.g.has(g):!1}function oe(u,g){u.g?u.g.add(g):u.h=g}function Pe(u,g){u.h&&u.h==g?u.h=null:u.g&&u.g.has(g)&&u.g.delete(g)}Ce.prototype.cancel=function(){if(this.i=ze(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function ze(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let g=u.i;for(const _ of u.g.values())g=g.concat(_.D);return g}return q(u.i)}function Re(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(m(u)){for(var g=[],_=u.length,I=0;I<_;I++)g.push(u[I]);return g}g=[],_=0;for(I in u)g[_++]=u[I];return g}function Ze(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(m(u)||typeof u=="string"){var g=[];u=u.length;for(var _=0;_<u;_++)g.push(_);return g}g=[],_=0;for(const I in u)g[_++]=I;return g}}}function ct(u,g){if(u.forEach&&typeof u.forEach=="function")u.forEach(g,void 0);else if(m(u)||typeof u=="string")Array.prototype.forEach.call(u,g,void 0);else for(var _=Ze(u),I=Re(u),K=I.length,re=0;re<K;re++)g.call(void 0,I[re],_&&_[re],u)}var vt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function cn(u,g){if(u){u=u.split("&");for(var _=0;_<u.length;_++){var I=u[_].indexOf("="),K=null;if(0<=I){var re=u[_].substring(0,I);K=u[_].substring(I+1)}else re=u[_];g(re,K?decodeURIComponent(K.replace(/\+/g," ")):"")}}}function Nt(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof Nt){this.h=u.h,zt(this,u.j),this.o=u.o,this.g=u.g,it(this,u.s),this.l=u.l;var g=u.i,_=new hs;_.i=g.i,g.g&&(_.g=new Map(g.g),_.h=g.h),Zn(this,_),this.m=u.m}else u&&(g=String(u).match(vt))?(this.h=!1,zt(this,g[1]||"",!0),this.o=rt(g[2]||""),this.g=rt(g[3]||"",!0),it(this,g[4]),this.l=rt(g[5]||"",!0),Zn(this,g[6]||"",!0),this.m=rt(g[7]||"")):(this.h=!1,this.i=new hs(null,this.h))}Nt.prototype.toString=function(){var u=[],g=this.j;g&&u.push(us(g,ii,!0),":");var _=this.g;return(_||g=="file")&&(u.push("//"),(g=this.o)&&u.push(us(g,ii,!0),"@"),u.push(encodeURIComponent(String(_)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_=this.s,_!=null&&u.push(":",String(_))),(_=this.l)&&(this.g&&_.charAt(0)!="/"&&u.push("/"),u.push(us(_,_.charAt(0)=="/"?Pa:ds,!0))),(_=this.i.toString())&&u.push("?",_),(_=this.m)&&u.push("#",us(_,Do)),u.join("")};function Ot(u){return new Nt(u)}function zt(u,g,_){u.j=_?rt(g,!0):g,u.j&&(u.j=u.j.replace(/:$/,""))}function it(u,g){if(g){if(g=Number(g),isNaN(g)||0>g)throw Error("Bad port number "+g);u.s=g}else u.s=null}function Zn(u,g,_){g instanceof hs?(u.i=g,fs(u.i,u.h)):(_||(g=us(g,ec)),u.i=new hs(g,u.h))}function nt(u,g,_){u.i.set(g,_)}function Mn(u){return nt(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function rt(u,g){return u?g?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function us(u,g,_){return typeof u=="string"?(u=encodeURI(u).replace(g,ba),_&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function ba(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var ii=/[#\/\?@]/g,ds=/[#\?:]/g,Pa=/[#\?]/g,ec=/[#\?@]/g,Do=/#/g;function hs(u,g){this.h=this.g=null,this.i=u||null,this.j=!!g}function Pn(u){u.g||(u.g=new Map,u.h=0,u.i&&cn(u.i,function(g,_){u.add(decodeURIComponent(g.replace(/\+/g," ")),_)}))}n=hs.prototype,n.add=function(u,g){Pn(this),this.i=null,u=br(this,u);var _=this.g.get(u);return _||this.g.set(u,_=[]),_.push(g),this.h+=1,this};function Br(u,g){Pn(u),g=br(u,g),u.g.has(g)&&(u.i=null,u.h-=u.g.get(g).length,u.g.delete(g))}function $r(u,g){return Pn(u),g=br(u,g),u.g.has(g)}n.forEach=function(u,g){Pn(this),this.g.forEach(function(_,I){_.forEach(function(K){u.call(g,K,I,this)},this)},this)},n.na=function(){Pn(this);const u=Array.from(this.g.values()),g=Array.from(this.g.keys()),_=[];for(let I=0;I<g.length;I++){const K=u[I];for(let re=0;re<K.length;re++)_.push(g[I])}return _},n.V=function(u){Pn(this);let g=[];if(typeof u=="string")$r(this,u)&&(g=g.concat(this.g.get(br(this,u))));else{u=Array.from(this.g.values());for(let _=0;_<u.length;_++)g=g.concat(u[_])}return g},n.set=function(u,g){return Pn(this),this.i=null,u=br(this,u),$r(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[g]),this.h+=1,this},n.get=function(u,g){return u?(u=this.V(u),0<u.length?String(u[0]):g):g};function ai(u,g,_){Br(u,g),0<_.length&&(u.i=null,u.g.set(br(u,g),q(_)),u.h+=_.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],g=Array.from(this.g.keys());for(var _=0;_<g.length;_++){var I=g[_];const re=encodeURIComponent(String(I)),Se=this.V(I);for(I=0;I<Se.length;I++){var K=re;Se[I]!==""&&(K+="="+encodeURIComponent(String(Se[I]))),u.push(K)}}return this.i=u.join("&")};function br(u,g){return g=String(g),u.j&&(g=g.toLowerCase()),g}function fs(u,g){g&&!u.j&&(Pn(u),u.i=null,u.g.forEach(function(_,I){var K=I.toLowerCase();I!=K&&(Br(this,I),ai(this,K,_))},u)),u.j=g}function fd(u,g){const _=new vr;if(f.Image){const I=new Image;I.onload=$(or,_,"TestLoadImage: loaded",!0,g,I),I.onerror=$(or,_,"TestLoadImage: error",!1,g,I),I.onabort=$(or,_,"TestLoadImage: abort",!1,g,I),I.ontimeout=$(or,_,"TestLoadImage: timeout",!1,g,I),f.setTimeout(function(){I.ontimeout&&I.ontimeout()},1e4),I.src=u}else g(!1)}function tc(u,g){const _=new vr,I=new AbortController,K=setTimeout(()=>{I.abort(),or(_,"TestPingServer: timeout",!1,g)},1e4);fetch(u,{signal:I.signal}).then(re=>{clearTimeout(K),re.ok?or(_,"TestPingServer: ok",!0,g):or(_,"TestPingServer: server error",!1,g)}).catch(()=>{clearTimeout(K),or(_,"TestPingServer: error",!1,g)})}function or(u,g,_,I,K){try{K&&(K.onload=null,K.onerror=null,K.onabort=null,K.ontimeout=null),I(_)}catch{}}function pd(){this.g=new ri}function nc(u,g,_){const I=_||"";try{ct(u,function(K,re){let Se=K;v(K)&&(Se=as(K)),g.push(I+re+"="+encodeURIComponent(Se))})}catch(K){throw g.push(I+"type="+encodeURIComponent("_badmap")),K}}function js(u){this.l=u.Ub||null,this.j=u.eb||!1}X(js,on),js.prototype.g=function(){return new Yi(this.l,this.j)},js.prototype.i=(function(u){return function(){return u}})({});function Yi(u,g){Lt.call(this),this.D=u,this.o=g,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}X(Yi,Lt),n=Yi.prototype,n.open=function(u,g){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=g,this.readyState=1,Gr(this)},n.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const g={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(g.body=u),(this.D||f).fetch(new Request(this.A,g)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Wr(this)),this.readyState=0},n.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,Gr(this)),this.g&&(this.readyState=3,Gr(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof f.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;rc(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function rc(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}n.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var g=u.value?u.value:new Uint8Array(0);(g=this.v.decode(g,{stream:!u.done}))&&(this.response=this.responseText+=g)}u.done?Wr(this):Gr(this),this.readyState==3&&rc(this)}},n.Ra=function(u){this.g&&(this.response=this.responseText=u,Wr(this))},n.Qa=function(u){this.g&&(this.response=u,Wr(this))},n.ga=function(){this.g&&Wr(this)};function Wr(u){u.readyState=4,u.l=null,u.j=null,u.v=null,Gr(u)}n.setRequestHeader=function(u,g){this.u.append(u,g)},n.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],g=this.h.entries();for(var _=g.next();!_.done;)_=_.value,u.push(_[0]+": "+_[1]),_=g.next();return u.join(`\r
`)};function Gr(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(Yi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function Ds(u){let g="";return Ee(u,function(_,I){g+=I,g+=":",g+=_,g+=`\r
`}),g}function oi(u,g,_){e:{for(I in _){var I=!1;break e}I=!0}I||(_=Ds(_),typeof u=="string"?_!=null&&encodeURIComponent(String(_)):nt(u,g,_))}function Mt(u){Lt.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}X(Mt,Lt);var md=/^https?$/i,Vo=["POST","PUT"];n=Mt.prototype,n.Ha=function(u){this.J=u},n.ea=function(u,g,_,I){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);g=g?g.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Yn.g(),this.v=this.o?Cn(this.o):Cn(Yn),this.g.onreadystatechange=C(this.Ea,this);try{this.B=!0,this.g.open(g,String(u),!0),this.B=!1}catch(re){Ji(this,re);return}if(u=_||"",_=new Map(this.headers),I)if(Object.getPrototypeOf(I)===Object.prototype)for(var K in I)_.set(K,I[K]);else if(typeof I.keys=="function"&&typeof I.get=="function")for(const re of I.keys())_.set(re,I.get(re));else throw Error("Unknown input type for opt_headers: "+String(I));I=Array.from(_.keys()).find(re=>re.toLowerCase()=="content-type"),K=f.FormData&&u instanceof f.FormData,!(0<=Array.prototype.indexOf.call(Vo,g,void 0))||I||K||_.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[re,Se]of _)this.g.setRequestHeader(re,Se);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Na(this),this.u=!0,this.g.send(u),this.u=!1}catch(re){Ji(this,re)}};function Ji(u,g){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=g,u.m=5,Ra(u),_r(u)}function Ra(u){u.A||(u.A=!0,bt(u,"complete"),bt(u,"error"))}n.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,bt(this,"complete"),bt(this,"abort"),_r(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),_r(this,!0)),Mt.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Lo(this):this.bb())},n.bb=function(){Lo(this)};function Lo(u){if(u.h&&typeof d<"u"&&(!u.v[1]||lr(u)!=4||u.Z()!=2)){if(u.u&&lr(u)==4)ss(u.Ea,0,u);else if(bt(u,"readystatechange"),lr(u)==4){u.h=!1;try{const Se=u.Z();e:switch(Se){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var g=!0;break e;default:g=!1}var _;if(!(_=g)){var I;if(I=Se===0){var K=String(u.D).match(vt)[1]||null;!K&&f.self&&f.self.location&&(K=f.self.location.protocol.slice(0,-1)),I=!md.test(K?K.toLowerCase():"")}_=I}if(_)bt(u,"complete"),bt(u,"success");else{u.m=6;try{var re=2<lr(u)?u.g.statusText:""}catch{re=""}u.l=re+" ["+u.Z()+"]",Ra(u)}}finally{_r(u)}}}}function _r(u,g){if(u.g){Na(u);const _=u.g,I=u.v[0]?()=>{}:null;u.g=null,u.v=null,g||bt(u,"ready");try{_.onreadystatechange=I}catch{}}}function Na(u){u.I&&(f.clearTimeout(u.I),u.I=null)}n.isActive=function(){return!!this.g};function lr(u){return u.g?u.g.readyState:0}n.Z=function(){try{return 2<lr(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(u){if(this.g){var g=this.g.responseText;return u&&g.indexOf(u)==0&&(g=g.substring(u.length)),As(g)}};function Oo(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function Aa(u){const g={};u=(u.g&&2<=lr(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let I=0;I<u.length;I++){if(xe(u[I]))continue;var _=B(u[I]);const K=_[0];if(_=_[1],typeof _!="string")continue;_=_.trim();const re=g[K]||[];g[K]=re,re.push(_)}k(g,function(I){return I.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ps(u,g,_){return _&&_.internalChannelParams&&_.internalChannelParams[u]||g}function Mo(u){this.Aa=0,this.i=[],this.j=new vr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ps("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ps("baseRetryDelayMs",5e3,u),this.cb=ps("retryDelaySeedMs",1e4,u),this.Wa=ps("forwardChannelMaxRetries",2,u),this.wa=ps("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new Ce(u&&u.concurrentRequestLimit),this.Da=new pd,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Mo.prototype,n.la=8,n.G=1,n.connect=function(u,g,_,I){Rt(0),this.W=u,this.H=g||{},_&&I!==void 0&&(this.H.OSID=_,this.H.OAID=I),this.F=this.X,this.I=oc(this,null,this.W),ms(this)};function Rn(u){if(ka(u),u.G==3){var g=u.U++,_=Ot(u.I);if(nt(_,"SID",u.K),nt(_,"RID",g),nt(_,"TYPE","terminate"),Vs(u,_),g=new Jn(u,u.j,g),g.L=2,g.v=Mn(Ot(_)),_=!1,f.navigator&&f.navigator.sendBeacon)try{_=f.navigator.sendBeacon(g.v.toString(),"")}catch{}!_&&f.Image&&(new Image().src=g.v,_=!0),_||(g.g=lc(g.j,null),g.g.ea(g.v)),g.F=Date.now(),H(g)}ac(u)}function Hr(u){u.g&&(Fo(u),u.g.cancel(),u.g=null)}function ka(u){Hr(u),u.u&&(f.clearTimeout(u.u),u.u=null),Va(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&f.clearTimeout(u.s),u.s=null)}function ms(u){if(!T(u.h)&&!u.s){u.s=!0;var g=u.Ga;Ve||Te(),pe||(Ve(),pe=!0),be.add(g,u),u.B=0}}function gd(u,g){return L(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=g.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=On(C(u.Ga,u,g),ic(u,u.B)),u.B++,!0)}n.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;const K=new Jn(this,this.j,u);let re=this.o;if(this.S&&(re?(re=P(re),M(re,this.S)):re=this.S),this.m!==null||this.O||(K.H=re,re=null),this.P)e:{for(var g=0,_=0;_<this.i.length;_++){t:{var I=this.i[_];if("__data__"in I.map&&(I=I.map.__data__,typeof I=="string")){I=I.length;break t}I=void 0}if(I===void 0)break;if(g+=I,4096<g){g=_;break e}if(g===4096||_===this.i.length-1){g=_+1;break e}}g=1e3}else g=1e3;g=li(this,K,g),_=Ot(this.I),nt(_,"RID",u),nt(_,"CVER",22),this.D&&nt(_,"X-HTTP-Session-Id",this.D),Vs(this,_),re&&(this.O?g="headers="+encodeURIComponent(String(Ds(re)))+"&"+g:this.m&&oi(_,this.m,re)),oe(this.h,K),this.Ua&&nt(_,"TYPE","init"),this.P?(nt(_,"$req",g),nt(_,"SID","null"),K.T=!0,lt(K,_,null)):lt(K,_,g),this.G=2}}else this.G==3&&(u?ja(this,u):this.i.length==0||T(this.h)||ja(this))};function ja(u,g){var _;g?_=g.l:_=u.U++;const I=Ot(u.I);nt(I,"SID",u.K),nt(I,"RID",_),nt(I,"AID",u.T),Vs(u,I),u.m&&u.o&&oi(I,u.m,u.o),_=new Jn(u,u.j,_,u.B+1),u.m===null&&(_.H=u.o),g&&(u.i=g.D.concat(u.i)),g=li(u,_,1e3),_.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),oe(u.h,_),lt(_,I,g)}function Vs(u,g){u.H&&Ee(u.H,function(_,I){nt(g,I,_)}),u.l&&ct({},function(_,I){nt(g,I,_)})}function li(u,g,_){_=Math.min(u.i.length,_);var I=u.l?C(u.l.Na,u.l,u):null;e:{var K=u.i;let re=-1;for(;;){const Se=["count="+_];re==-1?0<_?(re=K[0].g,Se.push("ofs="+re)):re=0:Se.push("ofs="+re);let Ct=!0;for(let un=0;un<_;un++){let ht=K[un].g;const wn=K[un].map;if(ht-=re,0>ht)re=Math.max(0,K[un].g-100),Ct=!1;else try{nc(wn,Se,"req"+ht+"_")}catch{I&&I(wn)}}if(Ct){I=Se.join("&");break e}}}return u=u.i.splice(0,_),g.D=u,I}function Xi(u){if(!u.g&&!u.u){u.Y=1;var g=u.Fa;Ve||Te(),pe||(Ve(),pe=!0),be.add(g,u),u.v=0}}function Da(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=On(C(u.Fa,u),ic(u,u.v)),u.v++,!0)}n.Fa=function(){if(this.u=null,sc(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=On(C(this.ab,this),u)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Rt(10),Hr(this),sc(this))};function Fo(u){u.A!=null&&(f.clearTimeout(u.A),u.A=null)}function sc(u){u.g=new Jn(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var g=Ot(u.qa);nt(g,"RID","rpc"),nt(g,"SID",u.K),nt(g,"AID",u.T),nt(g,"CI",u.F?"0":"1"),!u.F&&u.ja&&nt(g,"TO",u.ja),nt(g,"TYPE","xmlhttp"),Vs(u,g),u.m&&u.o&&oi(g,u.m,u.o),u.L&&(u.g.I=u.L);var _=u.g;u=u.ia,_.L=1,_.v=Mn(Ot(g)),_.m=null,_.P=!0,Xn(_,u)}n.Za=function(){this.C!=null&&(this.C=null,Hr(this),Da(this),Rt(19))};function Va(u){u.C!=null&&(f.clearTimeout(u.C),u.C=null)}function La(u,g){var _=null;if(u.g==g){Va(u),Fo(u),u.g=null;var I=2}else if(F(u.h,g))_=g.D,Pe(u.h,g),I=1;else return;if(u.G!=0){if(g.o)if(I==1){_=g.m?g.m.length:0,g=Date.now()-g.F;var K=u.B;I=yt(),bt(I,new Jt(I,_)),ms(u)}else Xi(u);else if(K=g.s,K==3||K==0&&0<g.X||!(I==1&&gd(u,g)||I==2&&Da(u)))switch(_&&0<_.length&&(g=u.h,g.i=g.i.concat(_)),K){case 1:Ls(u,5);break;case 4:Ls(u,10);break;case 3:Ls(u,6);break;default:Ls(u,2)}}}function ic(u,g){let _=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(_*=2),_*g}function Ls(u,g){if(u.j.info("Error code "+g),g==2){var _=C(u.fb,u),I=u.Xa;const K=!I;I=new Nt(I||"//www.google.com/images/cleardot.gif"),f.location&&f.location.protocol=="http"||zt(I,"https"),Mn(I),K?fd(I.toString(),_):tc(I.toString(),_)}else Rt(2);u.G=0,u.l&&u.l.sa(g),ac(u),ka(u)}n.fb=function(u){u?(this.j.info("Successfully pinged google.com"),Rt(2)):(this.j.info("Failed to ping google.com"),Rt(1))};function ac(u){if(u.G=0,u.ka=[],u.l){const g=ze(u.h);(g.length!=0||u.i.length!=0)&&(U(u.ka,g),U(u.ka,u.i),u.h.i.length=0,q(u.i),u.i.length=0),u.l.ra()}}function oc(u,g,_){var I=_ instanceof Nt?Ot(_):new Nt(_);if(I.g!="")g&&(I.g=g+"."+I.g),it(I,I.s);else{var K=f.location;I=K.protocol,g=g?g+"."+K.hostname:K.hostname,K=+K.port;var re=new Nt(null);I&&zt(re,I),g&&(re.g=g),K&&it(re,K),_&&(re.l=_),I=re}return _=u.D,g=u.ya,_&&g&&nt(I,_,g),nt(I,"VER",u.la),Vs(u,I),I}function lc(u,g,_){if(g&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return g=u.Ca&&!u.pa?new Mt(new js({eb:_})):new Mt(u.pa),g.Ha(u.J),g}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Uo(){}n=Uo.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Oa(){}Oa.prototype.g=function(u,g){return new er(u,g)};function er(u,g){Lt.call(this),this.g=new Mo(g),this.l=u,this.h=g&&g.messageUrlParams||null,u=g&&g.messageHeaders||null,g&&g.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=g&&g.initMessageHeaders||null,g&&g.messageContentType&&(u?u["X-WebChannel-Content-Type"]=g.messageContentType:u={"X-WebChannel-Content-Type":g.messageContentType}),g&&g.va&&(u?u["X-WebChannel-Client-Profile"]=g.va:u={"X-WebChannel-Client-Profile":g.va}),this.g.S=u,(u=g&&g.Sb)&&!xe(u)&&(this.g.m=u),this.v=g&&g.supportsCrossDomainXhr||!1,this.u=g&&g.sendRawJson||!1,(g=g&&g.httpSessionIdParam)&&!xe(g)&&(this.g.D=g,u=this.h,u!==null&&g in u&&(u=this.h,g in u&&delete u[g])),this.j=new gs(this)}X(er,Lt),er.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},er.prototype.close=function(){Rn(this.g)},er.prototype.o=function(u){var g=this.g;if(typeof u=="string"){var _={};_.__data__=u,u=_}else this.u&&(_={},_.__data__=as(u),u=_);g.i.push(new Je(g.Ya++,u)),g.G==3&&ms(g)},er.prototype.N=function(){this.g.l=null,delete this.j,Rn(this.g),delete this.g,er.aa.N.call(this)};function cc(u){Ht.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var g=u.__sm__;if(g){e:{for(const _ in g){u=_;break e}u=void 0}(this.i=u)&&(u=this.i,g=g!==null&&u in g?g[u]:void 0),this.data=g}else this.data=u}X(cc,Ht);function uc(){ln.call(this),this.status=1}X(uc,ln);function gs(u){this.g=u}X(gs,Uo),gs.prototype.ua=function(){bt(this.g,"a")},gs.prototype.ta=function(u){bt(this.g,new cc(u))},gs.prototype.sa=function(u){bt(this.g,new uc)},gs.prototype.ra=function(){bt(this.g,"b")},Oa.prototype.createWebChannel=Oa.prototype.g,er.prototype.send=er.prototype.o,er.prototype.open=er.prototype.m,er.prototype.close=er.prototype.close,s0=function(){return new Oa},r0=function(){return yt()},n0=vn,mf={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Fr.NO_ERROR=0,Fr.TIMEOUT=8,Fr.HTTP_ERROR=6,pu=Fr,cs.COMPLETE="complete",t0=cs,ar.EventType=Yt,Yt.OPEN="a",Yt.CLOSE="b",Yt.ERROR="c",Yt.MESSAGE="d",Lt.prototype.listen=Lt.prototype.K,gl=ar,Mt.prototype.listenOnce=Mt.prototype.L,Mt.prototype.getLastError=Mt.prototype.Ka,Mt.prototype.getLastErrorCode=Mt.prototype.Ba,Mt.prototype.getStatus=Mt.prototype.Z,Mt.prototype.getResponseJson=Mt.prototype.Oa,Mt.prototype.getResponseText=Mt.prototype.oa,Mt.prototype.send=Mt.prototype.ea,Mt.prototype.setWithCredentials=Mt.prototype.Ha,e0=Mt}).apply(typeof iu<"u"?iu:typeof self<"u"?self:typeof window<"u"?window:{});const Vy="@firebase/firestore",Ly="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Wn.UNAUTHENTICATED=new Wn(null),Wn.GOOGLE_CREDENTIALS=new Wn("google-credentials-uid"),Wn.FIRST_PARTY=new Wn("first-party-uid"),Wn.MOCK_USER=new Wn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ro="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xa=new Ff("@firebase/firestore");function ao(){return xa.logLevel}function ke(n,...e){if(xa.logLevel<=ut.DEBUG){const t=e.map(Zf);xa.debug(`Firestore (${Ro}): ${n}`,...t)}}function ei(n,...e){if(xa.logLevel<=ut.ERROR){const t=e.map(Zf);xa.error(`Firestore (${Ro}): ${n}`,...t)}}function Li(n,...e){if(xa.logLevel<=ut.WARN){const t=e.map(Zf);xa.warn(`Firestore (${Ro}): ${n}`,...t)}}function Zf(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ke(n,e,t){let s="Unexpected state";typeof e=="string"?s=e:t=e,i0(n,s,t)}function i0(n,e,t){let s=`FIRESTORE (${Ro}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{s+=" CONTEXT: "+JSON.stringify(t)}catch{s+=" CONTEXT: "+t}throw ei(s),new Error(s)}function St(n,e,t,s){let a="Unexpected state";typeof t=="string"?a=t:s=t,n||i0(e,a,s)}function et(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const le={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Oe extends ni{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ys{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a0{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class tC{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Wn.UNAUTHENTICATED)))}shutdown(){}}class nC{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class rC{constructor(e){this.t=e,this.currentUser=Wn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){St(this.o===void 0,42304);let s=this.i;const a=m=>this.i!==s?(s=this.i,t(m)):Promise.resolve();let l=new Ys;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new Ys,e.enqueueRetryable((()=>a(this.currentUser)))};const d=()=>{const m=l;e.enqueueRetryable((async()=>{await m.promise,await a(this.currentUser)}))},f=m=>{ke("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=m,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit((m=>f(m))),setTimeout((()=>{if(!this.auth){const m=this.t.getImmediate({optional:!0});m?f(m):(ke("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new Ys)}}),0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((s=>this.i!==e?(ke("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(St(typeof s.accessToken=="string",31837,{l:s}),new a0(s.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return St(e===null||typeof e=="string",2055,{h:e}),new Wn(e)}}class sC{constructor(e,t,s){this.P=e,this.T=t,this.I=s,this.type="FirstParty",this.user=Wn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class iC{constructor(e,t,s){this.P=e,this.T=t,this.I=s}getToken(){return Promise.resolve(new sC(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Wn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Oy{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class aC{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Sr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){St(this.o===void 0,3512);const s=l=>{l.error!=null&&ke("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const d=l.token!==this.m;return this.m=l.token,ke("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?t(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable((()=>s(l)))};const a=l=>{ke("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((l=>a(l))),setTimeout((()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?a(l):ke("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new Oy(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(St(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Oy(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oC(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let s=0;s<n;s++)t[s]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o0(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ep{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let s="";for(;s.length<20;){const a=oC(40);for(let l=0;l<a.length;++l)s.length<20&&a[l]<t&&(s+=e.charAt(a[l]%62))}return s}}function st(n,e){return n<e?-1:n>e?1:0}function gf(n,e){let t=0;for(;t<n.length&&t<e.length;){const s=n.codePointAt(t),a=e.codePointAt(t);if(s!==a){if(s<128&&a<128)return st(s,a);{const l=o0(),d=lC(l.encode(My(n,t)),l.encode(My(e,t)));return d!==0?d:st(s,a)}}t+=s>65535?2:1}return st(n.length,e.length)}function My(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function lC(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return st(n[t],e[t]);return st(n.length,e.length)}function vo(n,e,t){return n.length===e.length&&n.every(((s,a)=>t(s,e[a])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fy="__name__";class xs{constructor(e,t,s){t===void 0?t=0:t>e.length&&Ke(637,{offset:t,range:e.length}),s===void 0?s=e.length-t:s>e.length-t&&Ke(1746,{length:s,range:e.length-t}),this.segments=e,this.offset=t,this.len=s}get length(){return this.len}isEqual(e){return xs.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof xs?e.forEach((s=>{t.push(s)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,s=this.limit();t<s;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const s=Math.min(e.length,t.length);for(let a=0;a<s;a++){const l=xs.compareSegments(e.get(a),t.get(a));if(l!==0)return l}return st(e.length,t.length)}static compareSegments(e,t){const s=xs.isNumericId(e),a=xs.isNumericId(t);return s&&!a?-1:!s&&a?1:s&&a?xs.extractNumericId(e).compare(xs.extractNumericId(t)):gf(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Di.fromString(e.substring(4,e.length-2))}}class Dt extends xs{construct(e,t,s){return new Dt(e,t,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const s of e){if(s.indexOf("//")>=0)throw new Oe(le.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);t.push(...s.split("/").filter((a=>a.length>0)))}return new Dt(t)}static emptyPath(){return new Dt([])}}const cC=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class jn extends xs{construct(e,t,s){return new jn(e,t,s)}static isValidIdentifier(e){return cC.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),jn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Fy}static keyField(){return new jn([Fy])}static fromServerFormat(e){const t=[];let s="",a=0;const l=()=>{if(s.length===0)throw new Oe(le.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(s),s=""};let d=!1;for(;a<e.length;){const f=e[a];if(f==="\\"){if(a+1===e.length)throw new Oe(le.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const m=e[a+1];if(m!=="\\"&&m!=="."&&m!=="`")throw new Oe(le.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=m,a+=2}else f==="`"?(d=!d,a++):f!=="."||d?(s+=f,a++):(l(),a++)}if(l(),d)throw new Oe(le.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new jn(t)}static emptyPath(){return new jn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $e{constructor(e){this.path=e}static fromPath(e){return new $e(Dt.fromString(e))}static fromName(e){return new $e(Dt.fromString(e).popFirst(5))}static empty(){return new $e(Dt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Dt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Dt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new $e(new Dt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l0(n,e,t){if(!t)throw new Oe(le.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function uC(n,e,t,s){if(e===!0&&s===!0)throw new Oe(le.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Uy(n){if(!$e.isDocumentKey(n))throw new Oe(le.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function zy(n){if($e.isDocumentKey(n))throw new Oe(le.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function c0(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function tp(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(s){return s.constructor?s.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Ke(12329,{type:typeof n})}function rs(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Oe(le.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=tp(n);throw new Oe(le.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nn(n,e){const t={typeString:n};return e&&(t.value=e),t}function Hl(n,e){if(!c0(n))throw new Oe(le.INVALID_ARGUMENT,"JSON must be an object");let t;for(const s in e)if(e[s]){const a=e[s].typeString,l="value"in e[s]?{value:e[s].value}:void 0;if(!(s in n)){t=`JSON missing required field: '${s}'`;break}const d=n[s];if(a&&typeof d!==a){t=`JSON field '${s}' must be a ${a}.`;break}if(l!==void 0&&d!==l.value){t=`Expected '${s}' field to equal '${l.value}'`;break}}if(t)throw new Oe(le.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const By=-62135596800,$y=1e6;class Vt{static now(){return Vt.fromMillis(Date.now())}static fromDate(e){return Vt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),s=Math.floor((e-1e3*t)*$y);return new Vt(t,s)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Oe(le.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Oe(le.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<By)throw new Oe(le.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Oe(le.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/$y}_compareTo(e){return this.seconds===e.seconds?st(this.nanoseconds,e.nanoseconds):st(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Vt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Hl(e,Vt._jsonSchema))return new Vt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-By;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Vt._jsonSchemaVersion="firestore/timestamp/1.0",Vt._jsonSchema={type:nn("string",Vt._jsonSchemaVersion),seconds:nn("number"),nanoseconds:nn("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xe{static fromTimestamp(e){return new Xe(e)}static min(){return new Xe(new Vt(0,0))}static max(){return new Xe(new Vt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jl=-1;function dC(n,e){const t=n.toTimestamp().seconds,s=n.toTimestamp().nanoseconds+1,a=Xe.fromTimestamp(s===1e9?new Vt(t+1,0):new Vt(t,s));return new Oi(a,$e.empty(),e)}function hC(n){return new Oi(n.readTime,n.key,jl)}class Oi{constructor(e,t,s){this.readTime=e,this.documentKey=t,this.largestBatchId=s}static min(){return new Oi(Xe.min(),$e.empty(),jl)}static max(){return new Oi(Xe.max(),$e.empty(),jl)}}function fC(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=$e.comparator(n.documentKey,e.documentKey),t!==0?t:st(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pC="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class mC{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function No(n){if(n.code!==le.FAILED_PRECONDITION||n.message!==pC)throw n;ke("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ae{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ke(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ae(((s,a)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(s,a)},this.catchCallback=l=>{this.wrapFailure(t,l).next(s,a)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof ae?t:ae.resolve(t)}catch(t){return ae.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):ae.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):ae.reject(t)}static resolve(e){return new ae(((t,s)=>{t(e)}))}static reject(e){return new ae(((t,s)=>{s(e)}))}static waitFor(e){return new ae(((t,s)=>{let a=0,l=0,d=!1;e.forEach((f=>{++a,f.next((()=>{++l,d&&l===a&&t()}),(m=>s(m)))})),d=!0,l===a&&t()}))}static or(e){let t=ae.resolve(!1);for(const s of e)t=t.next((a=>a?ae.resolve(a):s()));return t}static forEach(e,t){const s=[];return e.forEach(((a,l)=>{s.push(t.call(this,a,l))})),this.waitFor(s)}static mapArray(e,t){return new ae(((s,a)=>{const l=e.length,d=new Array(l);let f=0;for(let m=0;m<l;m++){const v=m;t(e[v]).next((w=>{d[v]=w,++f,f===l&&s(d)}),(w=>a(w)))}}))}static doWhile(e,t){return new ae(((s,a)=>{const l=()=>{e()===!0?t().next((()=>{l()}),a):s()};l()}))}}function gC(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Ao(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ku{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=s=>this._e(s),this.ae=s=>t.writeSequenceNumber(s))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}}Ku.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const np=-1;function Qu(n){return n==null}function Ru(n){return n===0&&1/n==-1/0}function yC(n){return typeof n=="number"&&Number.isInteger(n)&&!Ru(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u0="";function vC(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Wy(e)),e=_C(n.get(t),e);return Wy(e)}function _C(n,e){let t=e;const s=n.length;for(let a=0;a<s;a++){const l=n.charAt(a);switch(l){case"\0":t+="";break;case u0:t+="";break;default:t+=l}}return t}function Wy(n){return n+u0+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gy(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function qi(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function d0(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wt{constructor(e,t){this.comparator=e,this.root=t||kn.EMPTY}insert(e,t){return new Wt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,kn.BLACK,null,null))}remove(e){return new Wt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,kn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const s=this.comparator(e,t.key);if(s===0)return t.value;s<0?t=t.left:s>0&&(t=t.right)}return null}indexOf(e){let t=0,s=this.root;for(;!s.isEmpty();){const a=this.comparator(e,s.key);if(a===0)return t+s.left.size;a<0?s=s.left:(t+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,s)=>(e(t,s),!1)))}toString(){const e=[];return this.inorderTraversal(((t,s)=>(e.push(`${t}:${s}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new au(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new au(this.root,e,this.comparator,!1)}getReverseIterator(){return new au(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new au(this.root,e,this.comparator,!0)}}class au{constructor(e,t,s,a){this.isReverse=a,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=t?s(e.key,t):1,t&&a&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class kn{constructor(e,t,s,a,l){this.key=e,this.value=t,this.color=s??kn.RED,this.left=a??kn.EMPTY,this.right=l??kn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,s,a,l){return new kn(e??this.key,t??this.value,s??this.color,a??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,s){let a=this;const l=s(e,a.key);return a=l<0?a.copy(null,null,null,a.left.insert(e,t,s),null):l===0?a.copy(null,t,null,null,null):a.copy(null,null,null,null,a.right.insert(e,t,s)),a.fixUp()}removeMin(){if(this.left.isEmpty())return kn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let s,a=this;if(t(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,t),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),t(e,a.key)===0){if(a.right.isEmpty())return kn.EMPTY;s=a.right.min(),a=a.copy(s.key,s.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,t))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,kn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,kn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ke(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ke(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ke(27949);return e+(this.isRed()?0:1)}}kn.EMPTY=null,kn.RED=!0,kn.BLACK=!1;kn.EMPTY=new class{constructor(){this.size=0}get key(){throw Ke(57766)}get value(){throw Ke(16141)}get color(){throw Ke(16727)}get left(){throw Ke(29726)}get right(){throw Ke(36894)}copy(e,t,s,a,l){return this}insert(e,t,s){return new kn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mn{constructor(e){this.comparator=e,this.data=new Wt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,s)=>(e(t),!1)))}forEachInRange(e,t){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const a=s.getNext();if(this.comparator(a.key,e[1])>=0)return;t(a.key)}}forEachWhile(e,t){let s;for(s=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Hy(this.data.getIterator())}getIteratorFrom(e){return new Hy(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((s=>{t=t.add(s)})),t}isEqual(e){if(!(e instanceof mn)||this.size!==e.size)return!1;const t=this.data.getIterator(),s=e.data.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=s.getNext().key;if(this.comparator(a,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new mn(this.comparator);return t.data=e,t}}class Hy{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ir{constructor(e){this.fields=e,e.sort(jn.comparator)}static empty(){return new Ir([])}unionWith(e){let t=new mn(jn.comparator);for(const s of this.fields)t=t.add(s);for(const s of e)t=t.add(s);return new Ir(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return vo(this.fields,e.fields,((t,s)=>t.isEqual(s)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h0 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(a){try{return atob(a)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new h0("Invalid base64 string: "+l):l}})(e);return new Dn(t)}static fromUint8Array(e){const t=(function(a){let l="";for(let d=0;d<a.length;++d)l+=String.fromCharCode(a[d]);return l})(e);return new Dn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const s=new Uint8Array(t.length);for(let a=0;a<t.length;a++)s[a]=t.charCodeAt(a);return s})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return st(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Dn.EMPTY_BYTE_STRING=new Dn("");const wC=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Mi(n){if(St(!!n,39018),typeof n=="string"){let e=0;const t=wC.exec(n);if(St(!!t,46558,{timestamp:n}),t[1]){let a=t[1];a=(a+"000000000").substr(0,9),e=Number(a)}const s=new Date(n);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:Kt(n.seconds),nanos:Kt(n.nanos)}}function Kt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Fi(n){return typeof n=="string"?Dn.fromBase64String(n):Dn.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f0="server_timestamp",p0="__type__",m0="__previous_value__",g0="__local_write_time__";function rp(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[p0])===null||t===void 0?void 0:t.stringValue)===f0}function Yu(n){const e=n.mapValue.fields[m0];return rp(e)?Yu(e):e}function Dl(n){const e=Mi(n.mapValue.fields[g0].timestampValue);return new Vt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xC{constructor(e,t,s,a,l,d,f,m,v,w){this.databaseId=e,this.appId=t,this.persistenceKey=s,this.host=a,this.ssl=l,this.forceLongPolling=d,this.autoDetectLongPolling=f,this.longPollingOptions=m,this.useFetchStreams=v,this.isUsingEmulator=w}}const Nu="(default)";class Vl{constructor(e,t){this.projectId=e,this.database=t||Nu}static empty(){return new Vl("","")}get isDefaultDatabase(){return this.database===Nu}isEqual(e){return e instanceof Vl&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y0="__type__",EC="__max__",ou={mapValue:{}},v0="__vector__",Au="value";function Ui(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?rp(n)?4:SC(n)?9007199254740991:TC(n)?10:11:Ke(28295,{value:n})}function Ps(n,e){if(n===e)return!0;const t=Ui(n);if(t!==Ui(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Dl(n).isEqual(Dl(e));case 3:return(function(a,l){if(typeof a.timestampValue=="string"&&typeof l.timestampValue=="string"&&a.timestampValue.length===l.timestampValue.length)return a.timestampValue===l.timestampValue;const d=Mi(a.timestampValue),f=Mi(l.timestampValue);return d.seconds===f.seconds&&d.nanos===f.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(a,l){return Fi(a.bytesValue).isEqual(Fi(l.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(a,l){return Kt(a.geoPointValue.latitude)===Kt(l.geoPointValue.latitude)&&Kt(a.geoPointValue.longitude)===Kt(l.geoPointValue.longitude)})(n,e);case 2:return(function(a,l){if("integerValue"in a&&"integerValue"in l)return Kt(a.integerValue)===Kt(l.integerValue);if("doubleValue"in a&&"doubleValue"in l){const d=Kt(a.doubleValue),f=Kt(l.doubleValue);return d===f?Ru(d)===Ru(f):isNaN(d)&&isNaN(f)}return!1})(n,e);case 9:return vo(n.arrayValue.values||[],e.arrayValue.values||[],Ps);case 10:case 11:return(function(a,l){const d=a.mapValue.fields||{},f=l.mapValue.fields||{};if(Gy(d)!==Gy(f))return!1;for(const m in d)if(d.hasOwnProperty(m)&&(f[m]===void 0||!Ps(d[m],f[m])))return!1;return!0})(n,e);default:return Ke(52216,{left:n})}}function Ll(n,e){return(n.values||[]).find((t=>Ps(t,e)))!==void 0}function _o(n,e){if(n===e)return 0;const t=Ui(n),s=Ui(e);if(t!==s)return st(t,s);switch(t){case 0:case 9007199254740991:return 0;case 1:return st(n.booleanValue,e.booleanValue);case 2:return(function(l,d){const f=Kt(l.integerValue||l.doubleValue),m=Kt(d.integerValue||d.doubleValue);return f<m?-1:f>m?1:f===m?0:isNaN(f)?isNaN(m)?0:-1:1})(n,e);case 3:return qy(n.timestampValue,e.timestampValue);case 4:return qy(Dl(n),Dl(e));case 5:return gf(n.stringValue,e.stringValue);case 6:return(function(l,d){const f=Fi(l),m=Fi(d);return f.compareTo(m)})(n.bytesValue,e.bytesValue);case 7:return(function(l,d){const f=l.split("/"),m=d.split("/");for(let v=0;v<f.length&&v<m.length;v++){const w=st(f[v],m[v]);if(w!==0)return w}return st(f.length,m.length)})(n.referenceValue,e.referenceValue);case 8:return(function(l,d){const f=st(Kt(l.latitude),Kt(d.latitude));return f!==0?f:st(Kt(l.longitude),Kt(d.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Ky(n.arrayValue,e.arrayValue);case 10:return(function(l,d){var f,m,v,w;const S=l.fields||{},C=d.fields||{},$=(f=S[Au])===null||f===void 0?void 0:f.arrayValue,X=(m=C[Au])===null||m===void 0?void 0:m.arrayValue,q=st(((v=$==null?void 0:$.values)===null||v===void 0?void 0:v.length)||0,((w=X==null?void 0:X.values)===null||w===void 0?void 0:w.length)||0);return q!==0?q:Ky($,X)})(n.mapValue,e.mapValue);case 11:return(function(l,d){if(l===ou.mapValue&&d===ou.mapValue)return 0;if(l===ou.mapValue)return 1;if(d===ou.mapValue)return-1;const f=l.fields||{},m=Object.keys(f),v=d.fields||{},w=Object.keys(v);m.sort(),w.sort();for(let S=0;S<m.length&&S<w.length;++S){const C=gf(m[S],w[S]);if(C!==0)return C;const $=_o(f[m[S]],v[w[S]]);if($!==0)return $}return st(m.length,w.length)})(n.mapValue,e.mapValue);default:throw Ke(23264,{le:t})}}function qy(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return st(n,e);const t=Mi(n),s=Mi(e),a=st(t.seconds,s.seconds);return a!==0?a:st(t.nanos,s.nanos)}function Ky(n,e){const t=n.values||[],s=e.values||[];for(let a=0;a<t.length&&a<s.length;++a){const l=_o(t[a],s[a]);if(l)return l}return st(t.length,s.length)}function wo(n){return yf(n)}function yf(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const s=Mi(t);return`time(${s.seconds},${s.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Fi(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return $e.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let s="[",a=!0;for(const l of t.values||[])a?a=!1:s+=",",s+=yf(l);return s+"]"})(n.arrayValue):"mapValue"in n?(function(t){const s=Object.keys(t.fields||{}).sort();let a="{",l=!0;for(const d of s)l?l=!1:a+=",",a+=`${d}:${yf(t.fields[d])}`;return a+"}"})(n.mapValue):Ke(61005,{value:n})}function mu(n){switch(Ui(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Yu(n);return e?16+mu(e):16;case 5:return 2*n.stringValue.length;case 6:return Fi(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(s){return(s.values||[]).reduce(((a,l)=>a+mu(l)),0)})(n.arrayValue);case 10:case 11:return(function(s){let a=0;return qi(s.fields,((l,d)=>{a+=l.length+mu(d)})),a})(n.mapValue);default:throw Ke(13486,{value:n})}}function vf(n){return!!n&&"integerValue"in n}function sp(n){return!!n&&"arrayValue"in n}function Qy(n){return!!n&&"nullValue"in n}function Yy(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function gu(n){return!!n&&"mapValue"in n}function TC(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[y0])===null||t===void 0?void 0:t.stringValue)===v0}function Sl(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return qi(n.mapValue.fields,((t,s)=>e.mapValue.fields[t]=Sl(s))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Sl(n.arrayValue.values[t]);return e}return Object.assign({},n)}function SC(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===EC}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gr{constructor(e){this.value=e}static empty(){return new gr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let s=0;s<e.length-1;++s)if(t=(t.mapValue.fields||{})[e.get(s)],!gu(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Sl(t)}setAll(e){let t=jn.emptyPath(),s={},a=[];e.forEach(((d,f)=>{if(!t.isImmediateParentOf(f)){const m=this.getFieldsMap(t);this.applyChanges(m,s,a),s={},a=[],t=f.popLast()}d?s[f.lastSegment()]=Sl(d):a.push(f.lastSegment())}));const l=this.getFieldsMap(t);this.applyChanges(l,s,a)}delete(e){const t=this.field(e.popLast());gu(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ps(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let s=0;s<e.length;++s){let a=t.mapValue.fields[e.get(s)];gu(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},t.mapValue.fields[e.get(s)]=a),t=a}return t.mapValue.fields}applyChanges(e,t,s){qi(t,((a,l)=>e[a]=l));for(const a of s)delete e[a]}clone(){return new gr(Sl(this.value))}}function _0(n){const e=[];return qi(n.fields,((t,s)=>{const a=new jn([t]);if(gu(s)){const l=_0(s.mapValue).fields;if(l.length===0)e.push(a);else for(const d of l)e.push(a.child(d))}else e.push(a)})),new Ir(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gn{constructor(e,t,s,a,l,d,f){this.key=e,this.documentType=t,this.version=s,this.readTime=a,this.createTime=l,this.data=d,this.documentState=f}static newInvalidDocument(e){return new Gn(e,0,Xe.min(),Xe.min(),Xe.min(),gr.empty(),0)}static newFoundDocument(e,t,s,a){return new Gn(e,1,t,Xe.min(),s,a,0)}static newNoDocument(e,t){return new Gn(e,2,t,Xe.min(),Xe.min(),gr.empty(),0)}static newUnknownDocument(e,t){return new Gn(e,3,t,Xe.min(),Xe.min(),gr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Xe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=gr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=gr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Xe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Gn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Gn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ku{constructor(e,t){this.position=e,this.inclusive=t}}function Jy(n,e,t){let s=0;for(let a=0;a<n.position.length;a++){const l=e[a],d=n.position[a];if(l.field.isKeyField()?s=$e.comparator($e.fromName(d.referenceValue),t.key):s=_o(d,t.data.field(l.field)),l.dir==="desc"&&(s*=-1),s!==0)break}return s}function Xy(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Ps(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ju{constructor(e,t="asc"){this.field=e,this.dir=t}}function IC(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w0{}class pn extends w0{constructor(e,t,s){super(),this.field=e,this.op=t,this.value=s}static create(e,t,s){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,s):new bC(e,t,s):t==="array-contains"?new NC(e,s):t==="in"?new AC(e,s):t==="not-in"?new kC(e,s):t==="array-contains-any"?new jC(e,s):new pn(e,t,s)}static createKeyFieldInFilter(e,t,s){return t==="in"?new PC(e,s):new RC(e,s)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(_o(t,this.value)):t!==null&&Ui(this.value)===Ui(t)&&this.matchesComparison(_o(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ke(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Rs extends w0{constructor(e,t){super(),this.filters=e,this.op=t,this.he=null}static create(e,t){return new Rs(e,t)}matches(e){return x0(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function x0(n){return n.op==="and"}function E0(n){return CC(n)&&x0(n)}function CC(n){for(const e of n.filters)if(e instanceof Rs)return!1;return!0}function _f(n){if(n instanceof pn)return n.field.canonicalString()+n.op.toString()+wo(n.value);if(E0(n))return n.filters.map((e=>_f(e))).join(",");{const e=n.filters.map((t=>_f(t))).join(",");return`${n.op}(${e})`}}function T0(n,e){return n instanceof pn?(function(s,a){return a instanceof pn&&s.op===a.op&&s.field.isEqual(a.field)&&Ps(s.value,a.value)})(n,e):n instanceof Rs?(function(s,a){return a instanceof Rs&&s.op===a.op&&s.filters.length===a.filters.length?s.filters.reduce(((l,d,f)=>l&&T0(d,a.filters[f])),!0):!1})(n,e):void Ke(19439)}function S0(n){return n instanceof pn?(function(t){return`${t.field.canonicalString()} ${t.op} ${wo(t.value)}`})(n):n instanceof Rs?(function(t){return t.op.toString()+" {"+t.getFilters().map(S0).join(" ,")+"}"})(n):"Filter"}class bC extends pn{constructor(e,t,s){super(e,t,s),this.key=$e.fromName(s.referenceValue)}matches(e){const t=$e.comparator(e.key,this.key);return this.matchesComparison(t)}}class PC extends pn{constructor(e,t){super(e,"in",t),this.keys=I0("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class RC extends pn{constructor(e,t){super(e,"not-in",t),this.keys=I0("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function I0(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map((s=>$e.fromName(s.referenceValue)))}class NC extends pn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return sp(t)&&Ll(t.arrayValue,this.value)}}class AC extends pn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Ll(this.value.arrayValue,t)}}class kC extends pn{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ll(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Ll(this.value.arrayValue,t)}}class jC extends pn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!sp(t)||!t.arrayValue.values)&&t.arrayValue.values.some((s=>Ll(this.value.arrayValue,s)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DC{constructor(e,t=null,s=[],a=[],l=null,d=null,f=null){this.path=e,this.collectionGroup=t,this.orderBy=s,this.filters=a,this.limit=l,this.startAt=d,this.endAt=f,this.Pe=null}}function Zy(n,e=null,t=[],s=[],a=null,l=null,d=null){return new DC(n,e,t,s,a,l,d)}function ip(n){const e=et(n);if(e.Pe===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((s=>_f(s))).join(","),t+="|ob:",t+=e.orderBy.map((s=>(function(l){return l.field.canonicalString()+l.dir})(s))).join(","),Qu(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((s=>wo(s))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((s=>wo(s))).join(",")),e.Pe=t}return e.Pe}function ap(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!IC(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!T0(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Xy(n.startAt,e.startAt)&&Xy(n.endAt,e.endAt)}function wf(n){return $e.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ju{constructor(e,t=null,s=[],a=[],l=null,d="F",f=null,m=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=s,this.filters=a,this.limit=l,this.limitType=d,this.startAt=f,this.endAt=m,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function VC(n,e,t,s,a,l,d,f){return new Ju(n,e,t,s,a,l,d,f)}function op(n){return new Ju(n)}function ev(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function LC(n){return n.collectionGroup!==null}function Il(n){const e=et(n);if(e.Te===null){e.Te=[];const t=new Set;for(const l of e.explicitOrderBy)e.Te.push(l),t.add(l.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let f=new mn(jn.comparator);return d.filters.forEach((m=>{m.getFlattenedFilters().forEach((v=>{v.isInequality()&&(f=f.add(v.field))}))})),f})(e).forEach((l=>{t.has(l.canonicalString())||l.isKeyField()||e.Te.push(new ju(l,s))})),t.has(jn.keyField().canonicalString())||e.Te.push(new ju(jn.keyField(),s))}return e.Te}function Ss(n){const e=et(n);return e.Ie||(e.Ie=OC(e,Il(n))),e.Ie}function OC(n,e){if(n.limitType==="F")return Zy(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((a=>{const l=a.dir==="desc"?"asc":"desc";return new ju(a.field,l)}));const t=n.endAt?new ku(n.endAt.position,n.endAt.inclusive):null,s=n.startAt?new ku(n.startAt.position,n.startAt.inclusive):null;return Zy(n.path,n.collectionGroup,e,n.filters,n.limit,t,s)}}function xf(n,e,t){return new Ju(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Xu(n,e){return ap(Ss(n),Ss(e))&&n.limitType===e.limitType}function C0(n){return`${ip(Ss(n))}|lt:${n.limitType}`}function oo(n){return`Query(target=${(function(t){let s=t.path.canonicalString();return t.collectionGroup!==null&&(s+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(s+=`, filters: [${t.filters.map((a=>S0(a))).join(", ")}]`),Qu(t.limit)||(s+=", limit: "+t.limit),t.orderBy.length>0&&(s+=`, orderBy: [${t.orderBy.map((a=>(function(d){return`${d.field.canonicalString()} (${d.dir})`})(a))).join(", ")}]`),t.startAt&&(s+=", startAt: ",s+=t.startAt.inclusive?"b:":"a:",s+=t.startAt.position.map((a=>wo(a))).join(",")),t.endAt&&(s+=", endAt: ",s+=t.endAt.inclusive?"a:":"b:",s+=t.endAt.position.map((a=>wo(a))).join(",")),`Target(${s})`})(Ss(n))}; limitType=${n.limitType})`}function Zu(n,e){return e.isFoundDocument()&&(function(s,a){const l=a.key.path;return s.collectionGroup!==null?a.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(l):$e.isDocumentKey(s.path)?s.path.isEqual(l):s.path.isImmediateParentOf(l)})(n,e)&&(function(s,a){for(const l of Il(s))if(!l.field.isKeyField()&&a.data.field(l.field)===null)return!1;return!0})(n,e)&&(function(s,a){for(const l of s.filters)if(!l.matches(a))return!1;return!0})(n,e)&&(function(s,a){return!(s.startAt&&!(function(d,f,m){const v=Jy(d,f,m);return d.inclusive?v<=0:v<0})(s.startAt,Il(s),a)||s.endAt&&!(function(d,f,m){const v=Jy(d,f,m);return d.inclusive?v>=0:v>0})(s.endAt,Il(s),a))})(n,e)}function MC(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function b0(n){return(e,t)=>{let s=!1;for(const a of Il(n)){const l=FC(a,e,t);if(l!==0)return l;s=s||a.field.isKeyField()}return 0}}function FC(n,e,t){const s=n.field.isKeyField()?$e.comparator(e.key,t.key):(function(l,d,f){const m=d.data.field(l),v=f.data.field(l);return m!==null&&v!==null?_o(m,v):Ke(42886)})(n.field,e,t);switch(n.dir){case"asc":return s;case"desc":return-1*s;default:return Ke(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sa{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s!==void 0){for(const[a,l]of s)if(this.equalsFn(a,e))return l}}has(e){return this.get(e)!==void 0}set(e,t){const s=this.mapKeyFn(e),a=this.inner[s];if(a===void 0)return this.inner[s]=[[e,t]],void this.innerSize++;for(let l=0;l<a.length;l++)if(this.equalsFn(a[l][0],e))return void(a[l]=[e,t]);a.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s===void 0)return!1;for(let a=0;a<s.length;a++)if(this.equalsFn(s[a][0],e))return s.length===1?delete this.inner[t]:s.splice(a,1),this.innerSize--,!0;return!1}forEach(e){qi(this.inner,((t,s)=>{for(const[a,l]of s)e(a,l)}))}isEmpty(){return d0(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UC=new Wt($e.comparator);function ti(){return UC}const P0=new Wt($e.comparator);function yl(...n){let e=P0;for(const t of n)e=e.insert(t.key,t);return e}function R0(n){let e=P0;return n.forEach(((t,s)=>e=e.insert(t,s.overlayedDocument))),e}function ga(){return Cl()}function N0(){return Cl()}function Cl(){return new Sa((n=>n.toString()),((n,e)=>n.isEqual(e)))}const zC=new Wt($e.comparator),BC=new mn($e.comparator);function dt(...n){let e=BC;for(const t of n)e=e.add(t);return e}const $C=new mn(st);function WC(){return $C}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lp(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ru(e)?"-0":e}}function A0(n){return{integerValue:""+n}}function GC(n,e){return yC(e)?A0(e):lp(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ed{constructor(){this._=void 0}}function HC(n,e,t){return n instanceof Ol?(function(a,l){const d={fields:{[p0]:{stringValue:f0},[g0]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return l&&rp(l)&&(l=Yu(l)),l&&(d.fields[m0]=l),{mapValue:d}})(t,e):n instanceof Ml?j0(n,e):n instanceof Fl?D0(n,e):(function(a,l){const d=k0(a,l),f=tv(d)+tv(a.Ee);return vf(d)&&vf(a.Ee)?A0(f):lp(a.serializer,f)})(n,e)}function qC(n,e,t){return n instanceof Ml?j0(n,e):n instanceof Fl?D0(n,e):t}function k0(n,e){return n instanceof Du?(function(s){return vf(s)||(function(l){return!!l&&"doubleValue"in l})(s)})(e)?e:{integerValue:0}:null}class Ol extends ed{}class Ml extends ed{constructor(e){super(),this.elements=e}}function j0(n,e){const t=V0(e);for(const s of n.elements)t.some((a=>Ps(a,s)))||t.push(s);return{arrayValue:{values:t}}}class Fl extends ed{constructor(e){super(),this.elements=e}}function D0(n,e){let t=V0(e);for(const s of n.elements)t=t.filter((a=>!Ps(a,s)));return{arrayValue:{values:t}}}class Du extends ed{constructor(e,t){super(),this.serializer=e,this.Ee=t}}function tv(n){return Kt(n.integerValue||n.doubleValue)}function V0(n){return sp(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KC{constructor(e,t){this.field=e,this.transform=t}}function QC(n,e){return n.field.isEqual(e.field)&&(function(s,a){return s instanceof Ml&&a instanceof Ml||s instanceof Fl&&a instanceof Fl?vo(s.elements,a.elements,Ps):s instanceof Du&&a instanceof Du?Ps(s.Ee,a.Ee):s instanceof Ol&&a instanceof Ol})(n.transform,e.transform)}class YC{constructor(e,t){this.version=e,this.transformResults=t}}class Or{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Or}static exists(e){return new Or(void 0,e)}static updateTime(e){return new Or(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function yu(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class td{}function L0(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new cp(n.key,Or.none()):new ql(n.key,n.data,Or.none());{const t=n.data,s=gr.empty();let a=new mn(jn.comparator);for(let l of e.fields)if(!a.has(l)){let d=t.field(l);d===null&&l.length>1&&(l=l.popLast(),d=t.field(l)),d===null?s.delete(l):s.set(l,d),a=a.add(l)}return new Ki(n.key,s,new Ir(a.toArray()),Or.none())}}function JC(n,e,t){n instanceof ql?(function(a,l,d){const f=a.value.clone(),m=rv(a.fieldTransforms,l,d.transformResults);f.setAll(m),l.convertToFoundDocument(d.version,f).setHasCommittedMutations()})(n,e,t):n instanceof Ki?(function(a,l,d){if(!yu(a.precondition,l))return void l.convertToUnknownDocument(d.version);const f=rv(a.fieldTransforms,l,d.transformResults),m=l.data;m.setAll(O0(a)),m.setAll(f),l.convertToFoundDocument(d.version,m).setHasCommittedMutations()})(n,e,t):(function(a,l,d){l.convertToNoDocument(d.version).setHasCommittedMutations()})(0,e,t)}function bl(n,e,t,s){return n instanceof ql?(function(l,d,f,m){if(!yu(l.precondition,d))return f;const v=l.value.clone(),w=sv(l.fieldTransforms,m,d);return v.setAll(w),d.convertToFoundDocument(d.version,v).setHasLocalMutations(),null})(n,e,t,s):n instanceof Ki?(function(l,d,f,m){if(!yu(l.precondition,d))return f;const v=sv(l.fieldTransforms,m,d),w=d.data;return w.setAll(O0(l)),w.setAll(v),d.convertToFoundDocument(d.version,w).setHasLocalMutations(),f===null?null:f.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((S=>S.field)))})(n,e,t,s):(function(l,d,f){return yu(l.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):f})(n,e,t)}function XC(n,e){let t=null;for(const s of n.fieldTransforms){const a=e.data.field(s.field),l=k0(s.transform,a||null);l!=null&&(t===null&&(t=gr.empty()),t.set(s.field,l))}return t||null}function nv(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(s,a){return s===void 0&&a===void 0||!(!s||!a)&&vo(s,a,((l,d)=>QC(l,d)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class ql extends td{constructor(e,t,s,a=[]){super(),this.key=e,this.value=t,this.precondition=s,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class Ki extends td{constructor(e,t,s,a,l=[]){super(),this.key=e,this.data=t,this.fieldMask=s,this.precondition=a,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function O0(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const s=n.data.field(t);e.set(t,s)}})),e}function rv(n,e,t){const s=new Map;St(n.length===t.length,32656,{Ae:t.length,Re:n.length});for(let a=0;a<t.length;a++){const l=n[a],d=l.transform,f=e.data.field(l.field);s.set(l.field,qC(d,f,t[a]))}return s}function sv(n,e,t){const s=new Map;for(const a of n){const l=a.transform,d=t.data.field(a.field);s.set(a.field,HC(l,d,e))}return s}class cp extends td{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class ZC extends td{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eb{constructor(e,t,s,a){this.batchId=e,this.localWriteTime=t,this.baseMutations=s,this.mutations=a}applyToRemoteDocument(e,t){const s=t.mutationResults;for(let a=0;a<this.mutations.length;a++){const l=this.mutations[a];l.key.isEqual(e.key)&&JC(l,e,s[a])}}applyToLocalView(e,t){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(t=bl(s,e,t,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(t=bl(s,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const s=N0();return this.mutations.forEach((a=>{const l=e.get(a.key),d=l.overlayedDocument;let f=this.applyToLocalView(d,l.mutatedFields);f=t.has(a.key)?null:f;const m=L0(d,f);m!==null&&s.set(a.key,m),d.isValidDocument()||d.convertToNoDocument(Xe.min())})),s}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),dt())}isEqual(e){return this.batchId===e.batchId&&vo(this.mutations,e.mutations,((t,s)=>nv(t,s)))&&vo(this.baseMutations,e.baseMutations,((t,s)=>nv(t,s)))}}class up{constructor(e,t,s,a){this.batch=e,this.commitVersion=t,this.mutationResults=s,this.docVersions=a}static from(e,t,s){St(e.mutations.length===s.length,58842,{Ve:e.mutations.length,me:s.length});let a=(function(){return zC})();const l=e.mutations;for(let d=0;d<l.length;d++)a=a.insert(l[d].key,s[d].version);return new up(e,t,s,a)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tb{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nb{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var tn,ft;function rb(n){switch(n){case le.OK:return Ke(64938);case le.CANCELLED:case le.UNKNOWN:case le.DEADLINE_EXCEEDED:case le.RESOURCE_EXHAUSTED:case le.INTERNAL:case le.UNAVAILABLE:case le.UNAUTHENTICATED:return!1;case le.INVALID_ARGUMENT:case le.NOT_FOUND:case le.ALREADY_EXISTS:case le.PERMISSION_DENIED:case le.FAILED_PRECONDITION:case le.ABORTED:case le.OUT_OF_RANGE:case le.UNIMPLEMENTED:case le.DATA_LOSS:return!0;default:return Ke(15467,{code:n})}}function M0(n){if(n===void 0)return ei("GRPC error has no .code"),le.UNKNOWN;switch(n){case tn.OK:return le.OK;case tn.CANCELLED:return le.CANCELLED;case tn.UNKNOWN:return le.UNKNOWN;case tn.DEADLINE_EXCEEDED:return le.DEADLINE_EXCEEDED;case tn.RESOURCE_EXHAUSTED:return le.RESOURCE_EXHAUSTED;case tn.INTERNAL:return le.INTERNAL;case tn.UNAVAILABLE:return le.UNAVAILABLE;case tn.UNAUTHENTICATED:return le.UNAUTHENTICATED;case tn.INVALID_ARGUMENT:return le.INVALID_ARGUMENT;case tn.NOT_FOUND:return le.NOT_FOUND;case tn.ALREADY_EXISTS:return le.ALREADY_EXISTS;case tn.PERMISSION_DENIED:return le.PERMISSION_DENIED;case tn.FAILED_PRECONDITION:return le.FAILED_PRECONDITION;case tn.ABORTED:return le.ABORTED;case tn.OUT_OF_RANGE:return le.OUT_OF_RANGE;case tn.UNIMPLEMENTED:return le.UNIMPLEMENTED;case tn.DATA_LOSS:return le.DATA_LOSS;default:return Ke(39323,{code:n})}}(ft=tn||(tn={}))[ft.OK=0]="OK",ft[ft.CANCELLED=1]="CANCELLED",ft[ft.UNKNOWN=2]="UNKNOWN",ft[ft.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ft[ft.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ft[ft.NOT_FOUND=5]="NOT_FOUND",ft[ft.ALREADY_EXISTS=6]="ALREADY_EXISTS",ft[ft.PERMISSION_DENIED=7]="PERMISSION_DENIED",ft[ft.UNAUTHENTICATED=16]="UNAUTHENTICATED",ft[ft.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ft[ft.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ft[ft.ABORTED=10]="ABORTED",ft[ft.OUT_OF_RANGE=11]="OUT_OF_RANGE",ft[ft.UNIMPLEMENTED=12]="UNIMPLEMENTED",ft[ft.INTERNAL=13]="INTERNAL",ft[ft.UNAVAILABLE=14]="UNAVAILABLE",ft[ft.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sb=new Di([4294967295,4294967295],0);function iv(n){const e=o0().encode(n),t=new Z_;return t.update(e),new Uint8Array(t.digest())}function av(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),s=e.getUint32(4,!0),a=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new Di([t,s],0),new Di([a,l],0)]}class dp{constructor(e,t,s){if(this.bitmap=e,this.padding=t,this.hashCount=s,t<0||t>=8)throw new vl(`Invalid padding: ${t}`);if(s<0)throw new vl(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new vl(`Invalid hash count: ${s}`);if(e.length===0&&t!==0)throw new vl(`Invalid padding when bitmap length is 0: ${t}`);this.fe=8*e.length-t,this.ge=Di.fromNumber(this.fe)}pe(e,t,s){let a=e.add(t.multiply(Di.fromNumber(s)));return a.compare(sb)===1&&(a=new Di([a.getBits(0),a.getBits(1)],0)),a.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;const t=iv(e),[s,a]=av(t);for(let l=0;l<this.hashCount;l++){const d=this.pe(s,a,l);if(!this.ye(d))return!1}return!0}static create(e,t,s){const a=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),d=new dp(l,a,t);return s.forEach((f=>d.insert(f))),d}insert(e){if(this.fe===0)return;const t=iv(e),[s,a]=av(t);for(let l=0;l<this.hashCount;l++){const d=this.pe(s,a,l);this.we(d)}}we(e){const t=Math.floor(e/8),s=e%8;this.bitmap[t]|=1<<s}}class vl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nd{constructor(e,t,s,a,l){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=s,this.documentUpdates=a,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,t,s){const a=new Map;return a.set(e,Kl.createSynthesizedTargetChangeForCurrentChange(e,t,s)),new nd(Xe.min(),a,new Wt(st),ti(),dt())}}class Kl{constructor(e,t,s,a,l){this.resumeToken=e,this.current=t,this.addedDocuments=s,this.modifiedDocuments=a,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,t,s){return new Kl(s,t,dt(),dt(),dt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vu{constructor(e,t,s,a){this.Se=e,this.removedTargetIds=t,this.key=s,this.be=a}}class F0{constructor(e,t){this.targetId=e,this.De=t}}class U0{constructor(e,t,s=Dn.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=t,this.resumeToken=s,this.cause=a}}class ov{constructor(){this.ve=0,this.Ce=lv(),this.Fe=Dn.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=dt(),t=dt(),s=dt();return this.Ce.forEach(((a,l)=>{switch(l){case 0:e=e.add(a);break;case 2:t=t.add(a);break;case 1:s=s.add(a);break;default:Ke(38017,{changeType:l})}})),new Kl(this.Fe,this.Me,e,t,s)}ke(){this.xe=!1,this.Ce=lv()}qe(e,t){this.xe=!0,this.Ce=this.Ce.insert(e,t)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,St(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class ib{constructor(e){this.We=e,this.Ge=new Map,this.ze=ti(),this.je=lu(),this.Je=lu(),this.He=new Wt(st)}Ye(e){for(const t of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(t,e.be):this.Xe(t,e.key,e.be);for(const t of e.removedTargetIds)this.Xe(t,e.key,e.be)}et(e){this.forEachTarget(e,(t=>{const s=this.tt(t);switch(e.state){case 0:this.nt(t)&&s.Be(e.resumeToken);break;case 1:s.Ue(),s.Oe||s.ke(),s.Be(e.resumeToken);break;case 2:s.Ue(),s.Oe||this.removeTarget(t);break;case 3:this.nt(t)&&(s.Ke(),s.Be(e.resumeToken));break;case 4:this.nt(t)&&(this.rt(t),s.Be(e.resumeToken));break;default:Ke(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ge.forEach(((s,a)=>{this.nt(a)&&t(a)}))}it(e){const t=e.targetId,s=e.De.count,a=this.st(t);if(a){const l=a.target;if(wf(l))if(s===0){const d=new $e(l.path);this.Xe(t,d,Gn.newNoDocument(d,Xe.min()))}else St(s===1,20013,{expectedCount:s});else{const d=this.ot(t);if(d!==s){const f=this._t(e),m=f?this.ut(f,e,d):1;if(m!==0){this.rt(t);const v=m===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(t,v)}}}}}_t(e){const t=e.De.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:s="",padding:a=0},hashCount:l=0}=t;let d,f;try{d=Fi(s).toUint8Array()}catch(m){if(m instanceof h0)return Li("Decoding the base64 bloom filter in existence filter failed ("+m.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw m}try{f=new dp(d,a,l)}catch(m){return Li(m instanceof vl?"BloomFilter error: ":"Applying bloom filter failed: ",m),null}return f.fe===0?null:f}ut(e,t,s){return t.De.count===s-this.ht(e,t.targetId)?0:2}ht(e,t){const s=this.We.getRemoteKeysForTarget(t);let a=0;return s.forEach((l=>{const d=this.We.lt(),f=`projects/${d.projectId}/databases/${d.database}/documents/${l.path.canonicalString()}`;e.mightContain(f)||(this.Xe(t,l,null),a++)})),a}Pt(e){const t=new Map;this.Ge.forEach(((l,d)=>{const f=this.st(d);if(f){if(l.current&&wf(f.target)){const m=new $e(f.target.path);this.Tt(m).has(d)||this.It(d,m)||this.Xe(d,m,Gn.newNoDocument(m,e))}l.Ne&&(t.set(d,l.Le()),l.ke())}}));let s=dt();this.Je.forEach(((l,d)=>{let f=!0;d.forEachWhile((m=>{const v=this.st(m);return!v||v.purpose==="TargetPurposeLimboResolution"||(f=!1,!1)})),f&&(s=s.add(l))})),this.ze.forEach(((l,d)=>d.setReadTime(e)));const a=new nd(e,t,this.He,this.ze,s);return this.ze=ti(),this.je=lu(),this.Je=lu(),this.He=new Wt(st),a}Ze(e,t){if(!this.nt(e))return;const s=this.It(e,t.key)?2:0;this.tt(e).qe(t.key,s),this.ze=this.ze.insert(t.key,t),this.je=this.je.insert(t.key,this.Tt(t.key).add(e)),this.Je=this.Je.insert(t.key,this.dt(t.key).add(e))}Xe(e,t,s){if(!this.nt(e))return;const a=this.tt(e);this.It(e,t)?a.qe(t,1):a.Qe(t),this.Je=this.Je.insert(t,this.dt(t).delete(e)),this.Je=this.Je.insert(t,this.dt(t).add(e)),s&&(this.ze=this.ze.insert(t,s))}removeTarget(e){this.Ge.delete(e)}ot(e){const t=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let t=this.Ge.get(e);return t||(t=new ov,this.Ge.set(e,t)),t}dt(e){let t=this.Je.get(e);return t||(t=new mn(st),this.Je=this.Je.insert(e,t)),t}Tt(e){let t=this.je.get(e);return t||(t=new mn(st),this.je=this.je.insert(e,t)),t}nt(e){const t=this.st(e)!==null;return t||ke("WatchChangeAggregator","Detected inactive target",e),t}st(e){const t=this.Ge.get(e);return t&&t.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new ov),this.We.getRemoteKeysForTarget(e).forEach((t=>{this.Xe(e,t,null)}))}It(e,t){return this.We.getRemoteKeysForTarget(e).has(t)}}function lu(){return new Wt($e.comparator)}function lv(){return new Wt($e.comparator)}const ab={asc:"ASCENDING",desc:"DESCENDING"},ob={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},lb={and:"AND",or:"OR"};class cb{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Ef(n,e){return n.useProto3Json||Qu(e)?e:{value:e}}function Vu(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function z0(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function ub(n,e){return Vu(n,e.toTimestamp())}function Is(n){return St(!!n,49232),Xe.fromTimestamp((function(t){const s=Mi(t);return new Vt(s.seconds,s.nanos)})(n))}function hp(n,e){return Tf(n,e).canonicalString()}function Tf(n,e){const t=(function(a){return new Dt(["projects",a.projectId,"databases",a.database])})(n).child("documents");return e===void 0?t:t.child(e)}function B0(n){const e=Dt.fromString(n);return St(q0(e),10190,{key:e.toString()}),e}function Sf(n,e){return hp(n.databaseId,e.path)}function Qh(n,e){const t=B0(e);if(t.get(1)!==n.databaseId.projectId)throw new Oe(le.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Oe(le.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new $e(W0(t))}function $0(n,e){return hp(n.databaseId,e)}function db(n){const e=B0(n);return e.length===4?Dt.emptyPath():W0(e)}function If(n){return new Dt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function W0(n){return St(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function cv(n,e,t){return{name:Sf(n,e),fields:t.value.mapValue.fields}}function hb(n,e){let t;if("targetChange"in e){e.targetChange;const s=(function(v){return v==="NO_CHANGE"?0:v==="ADD"?1:v==="REMOVE"?2:v==="CURRENT"?3:v==="RESET"?4:Ke(39313,{state:v})})(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],l=(function(v,w){return v.useProto3Json?(St(w===void 0||typeof w=="string",58123),Dn.fromBase64String(w||"")):(St(w===void 0||w instanceof Buffer||w instanceof Uint8Array,16193),Dn.fromUint8Array(w||new Uint8Array))})(n,e.targetChange.resumeToken),d=e.targetChange.cause,f=d&&(function(v){const w=v.code===void 0?le.UNKNOWN:M0(v.code);return new Oe(w,v.message||"")})(d);t=new U0(s,a,l,f||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const a=Qh(n,s.document.name),l=Is(s.document.updateTime),d=s.document.createTime?Is(s.document.createTime):Xe.min(),f=new gr({mapValue:{fields:s.document.fields}}),m=Gn.newFoundDocument(a,l,d,f),v=s.targetIds||[],w=s.removedTargetIds||[];t=new vu(v,w,m.key,m)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const a=Qh(n,s.document),l=s.readTime?Is(s.readTime):Xe.min(),d=Gn.newNoDocument(a,l),f=s.removedTargetIds||[];t=new vu([],f,d.key,d)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const a=Qh(n,s.document),l=s.removedTargetIds||[];t=new vu([],l,a,null)}else{if(!("filter"in e))return Ke(11601,{At:e});{e.filter;const s=e.filter;s.targetId;const{count:a=0,unchangedNames:l}=s,d=new nb(a,l),f=s.targetId;t=new F0(f,d)}}return t}function fb(n,e){let t;if(e instanceof ql)t={update:cv(n,e.key,e.value)};else if(e instanceof cp)t={delete:Sf(n,e.key)};else if(e instanceof Ki)t={update:cv(n,e.key,e.data),updateMask:Eb(e.fieldMask)};else{if(!(e instanceof ZC))return Ke(16599,{Rt:e.type});t={verify:Sf(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((s=>(function(l,d){const f=d.transform;if(f instanceof Ol)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(f instanceof Ml)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:f.elements}};if(f instanceof Fl)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:f.elements}};if(f instanceof Du)return{fieldPath:d.field.canonicalString(),increment:f.Ee};throw Ke(20930,{transform:d.transform})})(0,s)))),e.precondition.isNone||(t.currentDocument=(function(a,l){return l.updateTime!==void 0?{updateTime:ub(a,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:Ke(27497)})(n,e.precondition)),t}function pb(n,e){return n&&n.length>0?(St(e!==void 0,14353),n.map((t=>(function(a,l){let d=a.updateTime?Is(a.updateTime):Is(l);return d.isEqual(Xe.min())&&(d=Is(l)),new YC(d,a.transformResults||[])})(t,e)))):[]}function mb(n,e){return{documents:[$0(n,e.path)]}}function gb(n,e){const t={structuredQuery:{}},s=e.path;let a;e.collectionGroup!==null?(a=s,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=s.popLast(),t.structuredQuery.from=[{collectionId:s.lastSegment()}]),t.parent=$0(n,a);const l=(function(v){if(v.length!==0)return H0(Rs.create(v,"and"))})(e.filters);l&&(t.structuredQuery.where=l);const d=(function(v){if(v.length!==0)return v.map((w=>(function(C){return{field:lo(C.field),direction:_b(C.dir)}})(w)))})(e.orderBy);d&&(t.structuredQuery.orderBy=d);const f=Ef(n,e.limit);return f!==null&&(t.structuredQuery.limit=f),e.startAt&&(t.structuredQuery.startAt=(function(v){return{before:v.inclusive,values:v.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(v){return{before:!v.inclusive,values:v.position}})(e.endAt)),{Vt:t,parent:a}}function yb(n){let e=db(n.parent);const t=n.structuredQuery,s=t.from?t.from.length:0;let a=null;if(s>0){St(s===1,65062);const w=t.from[0];w.allDescendants?a=w.collectionId:e=e.child(w.collectionId)}let l=[];t.where&&(l=(function(S){const C=G0(S);return C instanceof Rs&&E0(C)?C.getFilters():[C]})(t.where));let d=[];t.orderBy&&(d=(function(S){return S.map((C=>(function(X){return new ju(co(X.field),(function(U){switch(U){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(X.direction))})(C)))})(t.orderBy));let f=null;t.limit&&(f=(function(S){let C;return C=typeof S=="object"?S.value:S,Qu(C)?null:C})(t.limit));let m=null;t.startAt&&(m=(function(S){const C=!!S.before,$=S.values||[];return new ku($,C)})(t.startAt));let v=null;return t.endAt&&(v=(function(S){const C=!S.before,$=S.values||[];return new ku($,C)})(t.endAt)),VC(e,a,d,l,f,"F",m,v)}function vb(n,e){const t=(function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ke(28987,{purpose:a})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function G0(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const s=co(t.unaryFilter.field);return pn.create(s,"==",{doubleValue:NaN});case"IS_NULL":const a=co(t.unaryFilter.field);return pn.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=co(t.unaryFilter.field);return pn.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=co(t.unaryFilter.field);return pn.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ke(61313);default:return Ke(60726)}})(n):n.fieldFilter!==void 0?(function(t){return pn.create(co(t.fieldFilter.field),(function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ke(58110);default:return Ke(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Rs.create(t.compositeFilter.filters.map((s=>G0(s))),(function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return Ke(1026)}})(t.compositeFilter.op))})(n):Ke(30097,{filter:n})}function _b(n){return ab[n]}function wb(n){return ob[n]}function xb(n){return lb[n]}function lo(n){return{fieldPath:n.canonicalString()}}function co(n){return jn.fromServerFormat(n.fieldPath)}function H0(n){return n instanceof pn?(function(t){if(t.op==="=="){if(Yy(t.value))return{unaryFilter:{field:lo(t.field),op:"IS_NAN"}};if(Qy(t.value))return{unaryFilter:{field:lo(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Yy(t.value))return{unaryFilter:{field:lo(t.field),op:"IS_NOT_NAN"}};if(Qy(t.value))return{unaryFilter:{field:lo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:lo(t.field),op:wb(t.op),value:t.value}}})(n):n instanceof Rs?(function(t){const s=t.getFilters().map((a=>H0(a)));return s.length===1?s[0]:{compositeFilter:{op:xb(t.op),filters:s}}})(n):Ke(54877,{filter:n})}function Eb(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function q0(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ri{constructor(e,t,s,a,l=Xe.min(),d=Xe.min(),f=Dn.EMPTY_BYTE_STRING,m=null){this.target=e,this.targetId=t,this.purpose=s,this.sequenceNumber=a,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=f,this.expectedCount=m}withSequenceNumber(e){return new Ri(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Ri(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ri(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ri(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tb{constructor(e){this.gt=e}}function Sb(n){const e=yb({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?xf(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ib{constructor(){this.Dn=new Cb}addToCollectionParentIndex(e,t){return this.Dn.add(t),ae.resolve()}getCollectionParents(e,t){return ae.resolve(this.Dn.getEntries(t))}addFieldIndex(e,t){return ae.resolve()}deleteFieldIndex(e,t){return ae.resolve()}deleteAllFieldIndexes(e){return ae.resolve()}createTargetIndexes(e,t){return ae.resolve()}getDocumentsMatchingTarget(e,t){return ae.resolve(null)}getIndexType(e,t){return ae.resolve(0)}getFieldIndexes(e,t){return ae.resolve([])}getNextCollectionGroupToUpdate(e){return ae.resolve(null)}getMinOffset(e,t){return ae.resolve(Oi.min())}getMinOffsetFromCollectionGroup(e,t){return ae.resolve(Oi.min())}updateCollectionGroup(e,t,s){return ae.resolve()}updateIndexEntries(e,t){return ae.resolve()}}class Cb{constructor(){this.index={}}add(e){const t=e.lastSegment(),s=e.popLast(),a=this.index[t]||new mn(Dt.comparator),l=!a.has(s);return this.index[t]=a.add(s),l}has(e){const t=e.lastSegment(),s=e.popLast(),a=this.index[t];return a&&a.has(s)}getEntries(e){return(this.index[e]||new mn(Dt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uv={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},K0=41943040;class mr{static withCacheSize(e){return new mr(e,mr.DEFAULT_COLLECTION_PERCENTILE,mr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */mr.DEFAULT_COLLECTION_PERCENTILE=10,mr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,mr.DEFAULT=new mr(K0,mr.DEFAULT_COLLECTION_PERCENTILE,mr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),mr.DISABLED=new mr(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xo{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new xo(0)}static ur(){return new xo(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dv="LruGarbageCollector",bb=1048576;function hv([n,e],[t,s]){const a=st(n,t);return a===0?st(e,s):a}class Pb{constructor(e){this.Tr=e,this.buffer=new mn(hv),this.Ir=0}dr(){return++this.Ir}Er(e){const t=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(t);else{const s=this.buffer.last();hv(t,s)<0&&(this.buffer=this.buffer.delete(s).add(t))}}get maxValue(){return this.buffer.last()[0]}}class Rb{constructor(e,t,s){this.garbageCollector=e,this.asyncQueue=t,this.localStore=s,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){ke(dv,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Ao(t)?ke(dv,"Ignoring IndexedDB error during garbage collection: ",t):await No(t)}await this.Rr(3e5)}))}}class Nb{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.mr(e).next((s=>Math.floor(t/100*s)))}nthSequenceNumber(e,t){if(t===0)return ae.resolve(Ku.ue);const s=new Pb(t);return this.Vr.forEachTarget(e,(a=>s.Er(a.sequenceNumber))).next((()=>this.Vr.gr(e,(a=>s.Er(a))))).next((()=>s.maxValue))}removeTargets(e,t,s){return this.Vr.removeTargets(e,t,s)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ke("LruGarbageCollector","Garbage collection skipped; disabled"),ae.resolve(uv)):this.getCacheSize(e).next((s=>s<this.params.cacheSizeCollectionThreshold?(ke("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),uv):this.pr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,t){let s,a,l,d,f,m,v;const w=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((S=>(S>this.params.maximumSequenceNumbersToCollect?(ke("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${S}`),a=this.params.maximumSequenceNumbersToCollect):a=S,d=Date.now(),this.nthSequenceNumber(e,a)))).next((S=>(s=S,f=Date.now(),this.removeTargets(e,s,t)))).next((S=>(l=S,m=Date.now(),this.removeOrphanedDocuments(e,s)))).next((S=>(v=Date.now(),ao()<=ut.DEBUG&&ke("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-w}ms
	Determined least recently used ${a} in `+(f-d)+`ms
	Removed ${l} targets in `+(m-f)+`ms
	Removed ${S} documents in `+(v-m)+`ms
Total Duration: ${v-w}ms`),ae.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:l,documentsRemoved:S}))))}}function Ab(n,e){return new Nb(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kb{constructor(){this.changes=new Sa((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Gn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const s=this.changes.get(t);return s!==void 0?ae.resolve(s):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jb{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Db{constructor(e,t,s,a){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=s,this.indexManager=a}getDocument(e,t){let s=null;return this.documentOverlayCache.getOverlay(e,t).next((a=>(s=a,this.remoteDocumentCache.getEntry(e,t)))).next((a=>(s!==null&&bl(s.mutation,a,Ir.empty(),Vt.now()),a)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((s=>this.getLocalViewOfDocuments(e,s,dt()).next((()=>s))))}getLocalViewOfDocuments(e,t,s=dt()){const a=ga();return this.populateOverlays(e,a,t).next((()=>this.computeViews(e,t,a,s).next((l=>{let d=yl();return l.forEach(((f,m)=>{d=d.insert(f,m.overlayedDocument)})),d}))))}getOverlayedDocuments(e,t){const s=ga();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,dt())))}populateOverlays(e,t,s){const a=[];return s.forEach((l=>{t.has(l)||a.push(l)})),this.documentOverlayCache.getOverlays(e,a).next((l=>{l.forEach(((d,f)=>{t.set(d,f)}))}))}computeViews(e,t,s,a){let l=ti();const d=Cl(),f=(function(){return Cl()})();return t.forEach(((m,v)=>{const w=s.get(v.key);a.has(v.key)&&(w===void 0||w.mutation instanceof Ki)?l=l.insert(v.key,v):w!==void 0?(d.set(v.key,w.mutation.getFieldMask()),bl(w.mutation,v,w.mutation.getFieldMask(),Vt.now())):d.set(v.key,Ir.empty())})),this.recalculateAndSaveOverlays(e,l).next((m=>(m.forEach(((v,w)=>d.set(v,w))),t.forEach(((v,w)=>{var S;return f.set(v,new jb(w,(S=d.get(v))!==null&&S!==void 0?S:null))})),f)))}recalculateAndSaveOverlays(e,t){const s=Cl();let a=new Wt(((d,f)=>d-f)),l=dt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((d=>{for(const f of d)f.keys().forEach((m=>{const v=t.get(m);if(v===null)return;let w=s.get(m)||Ir.empty();w=f.applyToLocalView(v,w),s.set(m,w);const S=(a.get(f.batchId)||dt()).add(m);a=a.insert(f.batchId,S)}))})).next((()=>{const d=[],f=a.getReverseIterator();for(;f.hasNext();){const m=f.getNext(),v=m.key,w=m.value,S=N0();w.forEach((C=>{if(!l.has(C)){const $=L0(t.get(C),s.get(C));$!==null&&S.set(C,$),l=l.add(C)}})),d.push(this.documentOverlayCache.saveOverlays(e,v,S))}return ae.waitFor(d)})).next((()=>s))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((s=>this.recalculateAndSaveOverlays(e,s)))}getDocumentsMatchingQuery(e,t,s,a){return(function(d){return $e.isDocumentKey(d.path)&&d.collectionGroup===null&&d.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):LC(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,s,a):this.getDocumentsMatchingCollectionQuery(e,t,s,a)}getNextDocuments(e,t,s,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,s,a).next((l=>{const d=a-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,s.largestBatchId,a-l.size):ae.resolve(ga());let f=jl,m=l;return d.next((v=>ae.forEach(v,((w,S)=>(f<S.largestBatchId&&(f=S.largestBatchId),l.get(w)?ae.resolve():this.remoteDocumentCache.getEntry(e,w).next((C=>{m=m.insert(w,C)}))))).next((()=>this.populateOverlays(e,v,l))).next((()=>this.computeViews(e,m,v,dt()))).next((w=>({batchId:f,changes:R0(w)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new $e(t)).next((s=>{let a=yl();return s.isFoundDocument()&&(a=a.insert(s.key,s)),a}))}getDocumentsMatchingCollectionGroupQuery(e,t,s,a){const l=t.collectionGroup;let d=yl();return this.indexManager.getCollectionParents(e,l).next((f=>ae.forEach(f,(m=>{const v=(function(S,C){return new Ju(C,null,S.explicitOrderBy.slice(),S.filters.slice(),S.limit,S.limitType,S.startAt,S.endAt)})(t,m.child(l));return this.getDocumentsMatchingCollectionQuery(e,v,s,a).next((w=>{w.forEach(((S,C)=>{d=d.insert(S,C)}))}))})).next((()=>d))))}getDocumentsMatchingCollectionQuery(e,t,s,a){let l;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,s.largestBatchId).next((d=>(l=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,s,l,a)))).next((d=>{l.forEach(((m,v)=>{const w=v.getKey();d.get(w)===null&&(d=d.insert(w,Gn.newInvalidDocument(w)))}));let f=yl();return d.forEach(((m,v)=>{const w=l.get(m);w!==void 0&&bl(w.mutation,v,Ir.empty(),Vt.now()),Zu(t,v)&&(f=f.insert(m,v))})),f}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vb{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,t){return ae.resolve(this.Br.get(t))}saveBundleMetadata(e,t){return this.Br.set(t.id,(function(a){return{id:a.id,version:a.version,createTime:Is(a.createTime)}})(t)),ae.resolve()}getNamedQuery(e,t){return ae.resolve(this.Lr.get(t))}saveNamedQuery(e,t){return this.Lr.set(t.name,(function(a){return{name:a.name,query:Sb(a.bundledQuery),readTime:Is(a.readTime)}})(t)),ae.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lb{constructor(){this.overlays=new Wt($e.comparator),this.kr=new Map}getOverlay(e,t){return ae.resolve(this.overlays.get(t))}getOverlays(e,t){const s=ga();return ae.forEach(t,(a=>this.getOverlay(e,a).next((l=>{l!==null&&s.set(a,l)})))).next((()=>s))}saveOverlays(e,t,s){return s.forEach(((a,l)=>{this.wt(e,t,l)})),ae.resolve()}removeOverlaysForBatchId(e,t,s){const a=this.kr.get(s);return a!==void 0&&(a.forEach((l=>this.overlays=this.overlays.remove(l))),this.kr.delete(s)),ae.resolve()}getOverlaysForCollection(e,t,s){const a=ga(),l=t.length+1,d=new $e(t.child("")),f=this.overlays.getIteratorFrom(d);for(;f.hasNext();){const m=f.getNext().value,v=m.getKey();if(!t.isPrefixOf(v.path))break;v.path.length===l&&m.largestBatchId>s&&a.set(m.getKey(),m)}return ae.resolve(a)}getOverlaysForCollectionGroup(e,t,s,a){let l=new Wt(((v,w)=>v-w));const d=this.overlays.getIterator();for(;d.hasNext();){const v=d.getNext().value;if(v.getKey().getCollectionGroup()===t&&v.largestBatchId>s){let w=l.get(v.largestBatchId);w===null&&(w=ga(),l=l.insert(v.largestBatchId,w)),w.set(v.getKey(),v)}}const f=ga(),m=l.getIterator();for(;m.hasNext()&&(m.getNext().value.forEach(((v,w)=>f.set(v,w))),!(f.size()>=a)););return ae.resolve(f)}wt(e,t,s){const a=this.overlays.get(s.key);if(a!==null){const d=this.kr.get(a.largestBatchId).delete(s.key);this.kr.set(a.largestBatchId,d)}this.overlays=this.overlays.insert(s.key,new tb(t,s));let l=this.kr.get(t);l===void 0&&(l=dt(),this.kr.set(t,l)),this.kr.set(t,l.add(s.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ob{constructor(){this.sessionToken=Dn.EMPTY_BYTE_STRING}getSessionToken(e){return ae.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ae.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fp{constructor(){this.qr=new mn(Sn.Qr),this.$r=new mn(Sn.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,t){const s=new Sn(e,t);this.qr=this.qr.add(s),this.$r=this.$r.add(s)}Kr(e,t){e.forEach((s=>this.addReference(s,t)))}removeReference(e,t){this.Wr(new Sn(e,t))}Gr(e,t){e.forEach((s=>this.removeReference(s,t)))}zr(e){const t=new $e(new Dt([])),s=new Sn(t,e),a=new Sn(t,e+1),l=[];return this.$r.forEachInRange([s,a],(d=>{this.Wr(d),l.push(d.key)})),l}jr(){this.qr.forEach((e=>this.Wr(e)))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const t=new $e(new Dt([])),s=new Sn(t,e),a=new Sn(t,e+1);let l=dt();return this.$r.forEachInRange([s,a],(d=>{l=l.add(d.key)})),l}containsKey(e){const t=new Sn(e,0),s=this.qr.firstAfterOrEqual(t);return s!==null&&e.isEqual(s.key)}}class Sn{constructor(e,t){this.key=e,this.Hr=t}static Qr(e,t){return $e.comparator(e.key,t.key)||st(e.Hr,t.Hr)}static Ur(e,t){return st(e.Hr,t.Hr)||$e.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mb{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.er=1,this.Yr=new mn(Sn.Qr)}checkEmpty(e){return ae.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,s,a){const l=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new eb(l,t,s,a);this.mutationQueue.push(d);for(const f of a)this.Yr=this.Yr.add(new Sn(f.key,l)),this.indexManager.addToCollectionParentIndex(e,f.key.path.popLast());return ae.resolve(d)}lookupMutationBatch(e,t){return ae.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const s=t+1,a=this.Xr(s),l=a<0?0:a;return ae.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return ae.resolve(this.mutationQueue.length===0?np:this.er-1)}getAllMutationBatches(e){return ae.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const s=new Sn(t,0),a=new Sn(t,Number.POSITIVE_INFINITY),l=[];return this.Yr.forEachInRange([s,a],(d=>{const f=this.Zr(d.Hr);l.push(f)})),ae.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new mn(st);return t.forEach((a=>{const l=new Sn(a,0),d=new Sn(a,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([l,d],(f=>{s=s.add(f.Hr)}))})),ae.resolve(this.ei(s))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,a=s.length+1;let l=s;$e.isDocumentKey(l)||(l=l.child(""));const d=new Sn(new $e(l),0);let f=new mn(st);return this.Yr.forEachWhile((m=>{const v=m.key.path;return!!s.isPrefixOf(v)&&(v.length===a&&(f=f.add(m.Hr)),!0)}),d),ae.resolve(this.ei(f))}ei(e){const t=[];return e.forEach((s=>{const a=this.Zr(s);a!==null&&t.push(a)})),t}removeMutationBatch(e,t){St(this.ti(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let s=this.Yr;return ae.forEach(t.mutations,(a=>{const l=new Sn(a.key,t.batchId);return s=s.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((()=>{this.Yr=s}))}rr(e){}containsKey(e,t){const s=new Sn(t,0),a=this.Yr.firstAfterOrEqual(s);return ae.resolve(t.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,ae.resolve()}ti(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fb{constructor(e){this.ni=e,this.docs=(function(){return new Wt($e.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const s=t.key,a=this.docs.get(s),l=a?a.size:0,d=this.ni(t);return this.docs=this.docs.insert(s,{document:t.mutableCopy(),size:d}),this.size+=d-l,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const s=this.docs.get(t);return ae.resolve(s?s.document.mutableCopy():Gn.newInvalidDocument(t))}getEntries(e,t){let s=ti();return t.forEach((a=>{const l=this.docs.get(a);s=s.insert(a,l?l.document.mutableCopy():Gn.newInvalidDocument(a))})),ae.resolve(s)}getDocumentsMatchingQuery(e,t,s,a){let l=ti();const d=t.path,f=new $e(d.child("__id-9223372036854775808__")),m=this.docs.getIteratorFrom(f);for(;m.hasNext();){const{key:v,value:{document:w}}=m.getNext();if(!d.isPrefixOf(v.path))break;v.path.length>d.length+1||fC(hC(w),s)<=0||(a.has(w.key)||Zu(t,w))&&(l=l.insert(w.key,w.mutableCopy()))}return ae.resolve(l)}getAllFromCollectionGroup(e,t,s,a){Ke(9500)}ri(e,t){return ae.forEach(this.docs,(s=>t(s)))}newChangeBuffer(e){return new Ub(this)}getSize(e){return ae.resolve(this.size)}}class Ub extends kb{constructor(e){super(),this.Or=e}applyChanges(e){const t=[];return this.changes.forEach(((s,a)=>{a.isValidDocument()?t.push(this.Or.addEntry(e,a)):this.Or.removeEntry(s)})),ae.waitFor(t)}getFromCache(e,t){return this.Or.getEntry(e,t)}getAllFromCache(e,t){return this.Or.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zb{constructor(e){this.persistence=e,this.ii=new Sa((t=>ip(t)),ap),this.lastRemoteSnapshotVersion=Xe.min(),this.highestTargetId=0,this.si=0,this.oi=new fp,this.targetCount=0,this._i=xo.ar()}forEachTarget(e,t){return this.ii.forEach(((s,a)=>t(a))),ae.resolve()}getLastRemoteSnapshotVersion(e){return ae.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ae.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),ae.resolve(this.highestTargetId)}setTargetsMetadata(e,t,s){return s&&(this.lastRemoteSnapshotVersion=s),t>this.si&&(this.si=t),ae.resolve()}hr(e){this.ii.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this._i=new xo(t),this.highestTargetId=t),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,t){return this.hr(t),this.targetCount+=1,ae.resolve()}updateTargetData(e,t){return this.hr(t),ae.resolve()}removeTargetData(e,t){return this.ii.delete(t.target),this.oi.zr(t.targetId),this.targetCount-=1,ae.resolve()}removeTargets(e,t,s){let a=0;const l=[];return this.ii.forEach(((d,f)=>{f.sequenceNumber<=t&&s.get(f.targetId)===null&&(this.ii.delete(d),l.push(this.removeMatchingKeysForTargetId(e,f.targetId)),a++)})),ae.waitFor(l).next((()=>a))}getTargetCount(e){return ae.resolve(this.targetCount)}getTargetData(e,t){const s=this.ii.get(t)||null;return ae.resolve(s)}addMatchingKeys(e,t,s){return this.oi.Kr(t,s),ae.resolve()}removeMatchingKeys(e,t,s){this.oi.Gr(t,s);const a=this.persistence.referenceDelegate,l=[];return a&&t.forEach((d=>{l.push(a.markPotentiallyOrphaned(e,d))})),ae.waitFor(l)}removeMatchingKeysForTargetId(e,t){return this.oi.zr(t),ae.resolve()}getMatchingKeysForTargetId(e,t){const s=this.oi.Jr(t);return ae.resolve(s)}containsKey(e,t){return ae.resolve(this.oi.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q0{constructor(e,t){this.ai={},this.overlays={},this.ui=new Ku(0),this.ci=!1,this.ci=!0,this.li=new Ob,this.referenceDelegate=e(this),this.hi=new zb(this),this.indexManager=new Ib,this.remoteDocumentCache=(function(a){return new Fb(a)})((s=>this.referenceDelegate.Pi(s))),this.serializer=new Tb(t),this.Ti=new Vb(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Lb,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let s=this.ai[e.toKey()];return s||(s=new Mb(t,this.referenceDelegate),this.ai[e.toKey()]=s),s}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,t,s){ke("MemoryPersistence","Starting transaction:",e);const a=new Bb(this.ui.next());return this.referenceDelegate.Ii(),s(a).next((l=>this.referenceDelegate.di(a).next((()=>l)))).toPromise().then((l=>(a.raiseOnCommittedEvent(),l)))}Ei(e,t){return ae.or(Object.values(this.ai).map((s=>()=>s.containsKey(e,t))))}}class Bb extends mC{constructor(e){super(),this.currentSequenceNumber=e}}class pp{constructor(e){this.persistence=e,this.Ai=new fp,this.Ri=null}static Vi(e){return new pp(e)}get mi(){if(this.Ri)return this.Ri;throw Ke(60996)}addReference(e,t,s){return this.Ai.addReference(s,t),this.mi.delete(s.toString()),ae.resolve()}removeReference(e,t,s){return this.Ai.removeReference(s,t),this.mi.add(s.toString()),ae.resolve()}markPotentiallyOrphaned(e,t){return this.mi.add(t.toString()),ae.resolve()}removeTarget(e,t){this.Ai.zr(t.targetId).forEach((a=>this.mi.add(a.toString())));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,t.targetId).next((a=>{a.forEach((l=>this.mi.add(l.toString())))})).next((()=>s.removeTargetData(e,t)))}Ii(){this.Ri=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ae.forEach(this.mi,(s=>{const a=$e.fromPath(s);return this.fi(e,a).next((l=>{l||t.removeEntry(a,Xe.min())}))})).next((()=>(this.Ri=null,t.apply(e))))}updateLimboDocument(e,t){return this.fi(e,t).next((s=>{s?this.mi.delete(t.toString()):this.mi.add(t.toString())}))}Pi(e){return 0}fi(e,t){return ae.or([()=>ae.resolve(this.Ai.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class Lu{constructor(e,t){this.persistence=e,this.gi=new Sa((s=>vC(s.path)),((s,a)=>s.isEqual(a))),this.garbageCollector=Ab(this,t)}static Vi(e,t){return new Lu(e,t)}Ii(){}di(e){return ae.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}mr(e){const t=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next((s=>t.next((a=>s+a))))}yr(e){let t=0;return this.gr(e,(s=>{t++})).next((()=>t))}gr(e,t){return ae.forEach(this.gi,((s,a)=>this.Sr(e,s,a).next((l=>l?ae.resolve():t(a)))))}removeTargets(e,t,s){return this.persistence.getTargetCache().removeTargets(e,t,s)}removeOrphanedDocuments(e,t){let s=0;const a=this.persistence.getRemoteDocumentCache(),l=a.newChangeBuffer();return a.ri(e,(d=>this.Sr(e,d,t).next((f=>{f||(s++,l.removeEntry(d,Xe.min()))})))).next((()=>l.apply(e))).next((()=>s))}markPotentiallyOrphaned(e,t){return this.gi.set(t,e.currentSequenceNumber),ae.resolve()}removeTarget(e,t){const s=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,s)}addReference(e,t,s){return this.gi.set(s,e.currentSequenceNumber),ae.resolve()}removeReference(e,t,s){return this.gi.set(s,e.currentSequenceNumber),ae.resolve()}updateLimboDocument(e,t){return this.gi.set(t,e.currentSequenceNumber),ae.resolve()}Pi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=mu(e.data.value)),t}Sr(e,t,s){return ae.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const a=this.gi.get(t);return ae.resolve(a!==void 0&&a>s)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mp{constructor(e,t,s,a){this.targetId=e,this.fromCache=t,this.Is=s,this.ds=a}static Es(e,t){let s=dt(),a=dt();for(const l of t.docChanges)switch(l.type){case 0:s=s.add(l.doc.key);break;case 1:a=a.add(l.doc.key)}return new mp(e,t.fromCache,s,a)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $b{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wb{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=(function(){return vT()?8:gC(Hn())>0?6:4})()}initialize(e,t){this.gs=e,this.indexManager=t,this.As=!0}getDocumentsMatchingQuery(e,t,s,a){const l={result:null};return this.ps(e,t).next((d=>{l.result=d})).next((()=>{if(!l.result)return this.ys(e,t,a,s).next((d=>{l.result=d}))})).next((()=>{if(l.result)return;const d=new $b;return this.ws(e,t,d).next((f=>{if(l.result=f,this.Rs)return this.Ss(e,t,d,f.size)}))})).next((()=>l.result))}Ss(e,t,s,a){return s.documentReadCount<this.Vs?(ao()<=ut.DEBUG&&ke("QueryEngine","SDK will not create cache indexes for query:",oo(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),ae.resolve()):(ao()<=ut.DEBUG&&ke("QueryEngine","Query:",oo(t),"scans",s.documentReadCount,"local documents and returns",a,"documents as results."),s.documentReadCount>this.fs*a?(ao()<=ut.DEBUG&&ke("QueryEngine","The SDK decides to create cache indexes for query:",oo(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ss(t))):ae.resolve())}ps(e,t){if(ev(t))return ae.resolve(null);let s=Ss(t);return this.indexManager.getIndexType(e,s).next((a=>a===0?null:(t.limit!==null&&a===1&&(t=xf(t,null,"F"),s=Ss(t)),this.indexManager.getDocumentsMatchingTarget(e,s).next((l=>{const d=dt(...l);return this.gs.getDocuments(e,d).next((f=>this.indexManager.getMinOffset(e,s).next((m=>{const v=this.bs(t,f);return this.Ds(t,v,d,m.readTime)?this.ps(e,xf(t,null,"F")):this.vs(e,v,t,m)}))))})))))}ys(e,t,s,a){return ev(t)||a.isEqual(Xe.min())?ae.resolve(null):this.gs.getDocuments(e,s).next((l=>{const d=this.bs(t,l);return this.Ds(t,d,s,a)?ae.resolve(null):(ao()<=ut.DEBUG&&ke("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),oo(t)),this.vs(e,d,t,dC(a,jl)).next((f=>f)))}))}bs(e,t){let s=new mn(b0(e));return t.forEach(((a,l)=>{Zu(e,l)&&(s=s.add(l))})),s}Ds(e,t,s,a){if(e.limit===null)return!1;if(s.size!==t.size)return!0;const l=e.limitType==="F"?t.last():t.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(a)>0)}ws(e,t,s){return ao()<=ut.DEBUG&&ke("QueryEngine","Using full collection scan to execute query:",oo(t)),this.gs.getDocumentsMatchingQuery(e,t,Oi.min(),s)}vs(e,t,s,a){return this.gs.getDocumentsMatchingQuery(e,s,a).next((l=>(t.forEach((d=>{l=l.insert(d.key,d)})),l)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gp="LocalStore",Gb=3e8;class Hb{constructor(e,t,s,a){this.persistence=e,this.Cs=t,this.serializer=a,this.Fs=new Wt(st),this.Ms=new Sa((l=>ip(l)),ap),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(s)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Db(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Fs)))}}function qb(n,e,t,s){return new Hb(n,e,t,s)}async function Y0(n,e){const t=et(n);return await t.persistence.runTransaction("Handle user change","readonly",(s=>{let a;return t.mutationQueue.getAllMutationBatches(s).next((l=>(a=l,t.Ns(e),t.mutationQueue.getAllMutationBatches(s)))).next((l=>{const d=[],f=[];let m=dt();for(const v of a){d.push(v.batchId);for(const w of v.mutations)m=m.add(w.key)}for(const v of l){f.push(v.batchId);for(const w of v.mutations)m=m.add(w.key)}return t.localDocuments.getDocuments(s,m).next((v=>({Bs:v,removedBatchIds:d,addedBatchIds:f})))}))}))}function Kb(n,e){const t=et(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(s=>{const a=e.batch.keys(),l=t.Os.newChangeBuffer({trackRemovals:!0});return(function(f,m,v,w){const S=v.batch,C=S.keys();let $=ae.resolve();return C.forEach((X=>{$=$.next((()=>w.getEntry(m,X))).next((q=>{const U=v.docVersions.get(X);St(U!==null,48541),q.version.compareTo(U)<0&&(S.applyToRemoteDocument(q,v),q.isValidDocument()&&(q.setReadTime(v.commitVersion),w.addEntry(q)))}))})),$.next((()=>f.mutationQueue.removeMutationBatch(m,S)))})(t,s,e,l).next((()=>l.apply(s))).next((()=>t.mutationQueue.performConsistencyCheck(s))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(s,a,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,(function(f){let m=dt();for(let v=0;v<f.mutationResults.length;++v)f.mutationResults[v].transformResults.length>0&&(m=m.add(f.batch.mutations[v].key));return m})(e)))).next((()=>t.localDocuments.getDocuments(s,a)))}))}function J0(n){const e=et(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.hi.getLastRemoteSnapshotVersion(t)))}function Qb(n,e){const t=et(n),s=e.snapshotVersion;let a=t.Fs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const d=t.Os.newChangeBuffer({trackRemovals:!0});a=t.Fs;const f=[];e.targetChanges.forEach(((w,S)=>{const C=a.get(S);if(!C)return;f.push(t.hi.removeMatchingKeys(l,w.removedDocuments,S).next((()=>t.hi.addMatchingKeys(l,w.addedDocuments,S))));let $=C.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(S)!==null?$=$.withResumeToken(Dn.EMPTY_BYTE_STRING,Xe.min()).withLastLimboFreeSnapshotVersion(Xe.min()):w.resumeToken.approximateByteSize()>0&&($=$.withResumeToken(w.resumeToken,s)),a=a.insert(S,$),(function(q,U,ne){return q.resumeToken.approximateByteSize()===0||U.snapshotVersion.toMicroseconds()-q.snapshotVersion.toMicroseconds()>=Gb?!0:ne.addedDocuments.size+ne.modifiedDocuments.size+ne.removedDocuments.size>0})(C,$,w)&&f.push(t.hi.updateTargetData(l,$))}));let m=ti(),v=dt();if(e.documentUpdates.forEach((w=>{e.resolvedLimboDocuments.has(w)&&f.push(t.persistence.referenceDelegate.updateLimboDocument(l,w))})),f.push(Yb(l,d,e.documentUpdates).next((w=>{m=w.Ls,v=w.ks}))),!s.isEqual(Xe.min())){const w=t.hi.getLastRemoteSnapshotVersion(l).next((S=>t.hi.setTargetsMetadata(l,l.currentSequenceNumber,s)));f.push(w)}return ae.waitFor(f).next((()=>d.apply(l))).next((()=>t.localDocuments.getLocalViewOfDocuments(l,m,v))).next((()=>m))})).then((l=>(t.Fs=a,l)))}function Yb(n,e,t){let s=dt(),a=dt();return t.forEach((l=>s=s.add(l))),e.getEntries(n,s).next((l=>{let d=ti();return t.forEach(((f,m)=>{const v=l.get(f);m.isFoundDocument()!==v.isFoundDocument()&&(a=a.add(f)),m.isNoDocument()&&m.version.isEqual(Xe.min())?(e.removeEntry(f,m.readTime),d=d.insert(f,m)):!v.isValidDocument()||m.version.compareTo(v.version)>0||m.version.compareTo(v.version)===0&&v.hasPendingWrites?(e.addEntry(m),d=d.insert(f,m)):ke(gp,"Ignoring outdated watch update for ",f,". Current version:",v.version," Watch version:",m.version)})),{Ls:d,ks:a}}))}function Jb(n,e){const t=et(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(s=>(e===void 0&&(e=np),t.mutationQueue.getNextMutationBatchAfterBatchId(s,e))))}function Xb(n,e){const t=et(n);return t.persistence.runTransaction("Allocate target","readwrite",(s=>{let a;return t.hi.getTargetData(s,e).next((l=>l?(a=l,ae.resolve(a)):t.hi.allocateTargetId(s).next((d=>(a=new Ri(e,d,"TargetPurposeListen",s.currentSequenceNumber),t.hi.addTargetData(s,a).next((()=>a)))))))})).then((s=>{const a=t.Fs.get(s.targetId);return(a===null||s.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(t.Fs=t.Fs.insert(s.targetId,s),t.Ms.set(e,s.targetId)),s}))}async function Cf(n,e,t){const s=et(n),a=s.Fs.get(e),l=t?"readwrite":"readwrite-primary";try{t||await s.persistence.runTransaction("Release target",l,(d=>s.persistence.referenceDelegate.removeTarget(d,a)))}catch(d){if(!Ao(d))throw d;ke(gp,`Failed to update sequence numbers for target ${e}: ${d}`)}s.Fs=s.Fs.remove(e),s.Ms.delete(a.target)}function fv(n,e,t){const s=et(n);let a=Xe.min(),l=dt();return s.persistence.runTransaction("Execute query","readwrite",(d=>(function(m,v,w){const S=et(m),C=S.Ms.get(w);return C!==void 0?ae.resolve(S.Fs.get(C)):S.hi.getTargetData(v,w)})(s,d,Ss(e)).next((f=>{if(f)return a=f.lastLimboFreeSnapshotVersion,s.hi.getMatchingKeysForTargetId(d,f.targetId).next((m=>{l=m}))})).next((()=>s.Cs.getDocumentsMatchingQuery(d,e,t?a:Xe.min(),t?l:dt()))).next((f=>(Zb(s,MC(e),f),{documents:f,qs:l})))))}function Zb(n,e,t){let s=n.xs.get(e)||Xe.min();t.forEach(((a,l)=>{l.readTime.compareTo(s)>0&&(s=l.readTime)})),n.xs.set(e,s)}class pv{constructor(){this.activeTargetIds=WC()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class eP{constructor(){this.Fo=new pv,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,s){}addLocalQueryTarget(e,t=!0){return t&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,t,s){this.Mo[e]=t}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new pv,Promise.resolve()}handleUserChange(e,t,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tP{xo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mv="ConnectivityMonitor";class gv{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){ke(mv,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){ke(mv,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cu=null;function bf(){return cu===null?cu=(function(){return 268435456+Math.round(2147483648*Math.random())})():cu++,"0x"+cu.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yh="RestConnection",nP={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class rP{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.$o=t+"://"+e.host,this.Uo=`projects/${s}/databases/${a}`,this.Ko=this.databaseId.database===Nu?`project_id=${s}`:`project_id=${s}&database_id=${a}`}Wo(e,t,s,a,l){const d=bf(),f=this.Go(e,t.toUriEncodedString());ke(Yh,`Sending RPC '${e}' ${d}:`,f,s);const m={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(m,a,l);const{host:v}=new URL(f),w=Io(v);return this.jo(e,f,m,s,w).then((S=>(ke(Yh,`Received RPC '${e}' ${d}: `,S),S)),(S=>{throw Li(Yh,`RPC '${e}' ${d} failed with error: `,S,"url: ",f,"request:",s),S}))}Jo(e,t,s,a,l,d){return this.Wo(e,t,s,a,l)}zo(e,t,s){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Ro})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((a,l)=>e[l]=a)),s&&s.headers.forEach(((a,l)=>e[l]=a))}Go(e,t){const s=nP[e];return`${this.$o}/v1/${t}:${s}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sP{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $n="WebChannelConnection";class iP extends rP{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,t,s,a,l){const d=bf();return new Promise(((f,m)=>{const v=new e0;v.setWithCredentials(!0),v.listenOnce(t0.COMPLETE,(()=>{try{switch(v.getLastErrorCode()){case pu.NO_ERROR:const S=v.getResponseJson();ke($n,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(S)),f(S);break;case pu.TIMEOUT:ke($n,`RPC '${e}' ${d} timed out`),m(new Oe(le.DEADLINE_EXCEEDED,"Request time out"));break;case pu.HTTP_ERROR:const C=v.getStatus();if(ke($n,`RPC '${e}' ${d} failed with status:`,C,"response text:",v.getResponseText()),C>0){let $=v.getResponseJson();Array.isArray($)&&($=$[0]);const X=$==null?void 0:$.error;if(X&&X.status&&X.message){const q=(function(ne){const xe=ne.toLowerCase().replace(/_/g,"-");return Object.values(le).indexOf(xe)>=0?xe:le.UNKNOWN})(X.status);m(new Oe(q,X.message))}else m(new Oe(le.UNKNOWN,"Server responded with status "+v.getStatus()))}else m(new Oe(le.UNAVAILABLE,"Connection failed."));break;default:Ke(9055,{c_:e,streamId:d,l_:v.getLastErrorCode(),h_:v.getLastError()})}}finally{ke($n,`RPC '${e}' ${d} completed.`)}}));const w=JSON.stringify(a);ke($n,`RPC '${e}' ${d} sending request:`,a),v.send(t,"POST",w,s,15)}))}P_(e,t,s){const a=bf(),l=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=s0(),f=r0(),m={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},v=this.longPollingOptions.timeoutSeconds;v!==void 0&&(m.longPollingTimeout=Math.round(1e3*v)),this.useFetchStreams&&(m.useFetchStreams=!0),this.zo(m.initMessageHeaders,t,s),m.encodeInitMessageHeaders=!0;const w=l.join("");ke($n,`Creating RPC '${e}' stream ${a}: ${w}`,m);const S=d.createWebChannel(w,m);this.T_(S);let C=!1,$=!1;const X=new sP({Ho:U=>{$?ke($n,`Not sending because RPC '${e}' stream ${a} is closed:`,U):(C||(ke($n,`Opening RPC '${e}' stream ${a} transport.`),S.open(),C=!0),ke($n,`RPC '${e}' stream ${a} sending:`,U),S.send(U))},Yo:()=>S.close()}),q=(U,ne,xe)=>{U.listen(ne,(ge=>{try{xe(ge)}catch(ye){setTimeout((()=>{throw ye}),0)}}))};return q(S,gl.EventType.OPEN,(()=>{$||(ke($n,`RPC '${e}' stream ${a} transport opened.`),X.s_())})),q(S,gl.EventType.CLOSE,(()=>{$||($=!0,ke($n,`RPC '${e}' stream ${a} transport closed`),X.__(),this.I_(S))})),q(S,gl.EventType.ERROR,(U=>{$||($=!0,Li($n,`RPC '${e}' stream ${a} transport errored. Name:`,U.name,"Message:",U.message),X.__(new Oe(le.UNAVAILABLE,"The operation could not be completed")))})),q(S,gl.EventType.MESSAGE,(U=>{var ne;if(!$){const xe=U.data[0];St(!!xe,16349);const ge=xe,ye=(ge==null?void 0:ge.error)||((ne=ge[0])===null||ne===void 0?void 0:ne.error);if(ye){ke($n,`RPC '${e}' stream ${a} received error:`,ye);const ie=ye.status;let Ee=(function(R){const M=tn[R];if(M!==void 0)return M0(M)})(ie),k=ye.message;Ee===void 0&&(Ee=le.INTERNAL,k="Unknown error status: "+ie+" with message "+ye.message),$=!0,X.__(new Oe(Ee,k)),S.close()}else ke($n,`RPC '${e}' stream ${a} received:`,xe),X.a_(xe)}})),q(f,n0.STAT_EVENT,(U=>{U.stat===mf.PROXY?ke($n,`RPC '${e}' stream ${a} detected buffering proxy`):U.stat===mf.NOPROXY&&ke($n,`RPC '${e}' stream ${a} detected no buffering proxy`)})),setTimeout((()=>{X.o_()}),0),X}terminate(){this.u_.forEach((e=>e.close())),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter((t=>t===e))}}function Jh(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rd(n){return new cb(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X0{constructor(e,t,s=1e3,a=1.5,l=6e4){this.Fi=e,this.timerId=t,this.d_=s,this.E_=a,this.A_=l,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const t=Math.floor(this.R_+this.p_()),s=Math.max(0,Date.now()-this.m_),a=Math.max(0,t-s);a>0&&ke("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.R_} ms, delay with jitter: ${t} ms, last attempt: ${s} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,a,(()=>(this.m_=Date.now(),e()))),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yv="PersistentStream";class Z0{constructor(e,t,s,a,l,d,f,m){this.Fi=e,this.w_=s,this.S_=a,this.connection=l,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=f,this.listener=m,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new X0(e,t)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,(()=>this.L_())))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():t&&t.code===le.RESOURCE_EXHAUSTED?(ei(t.toString()),ei("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):t&&t.code===le.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(t)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),t=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([s,a])=>{this.b_===t&&this.W_(s,a)}),(s=>{e((()=>{const a=new Oe(le.UNKNOWN,"Fetching auth token failed: "+s.message);return this.G_(a)}))}))}W_(e,t){const s=this.K_(this.b_);this.stream=this.z_(e,t),this.stream.Zo((()=>{s((()=>this.listener.Zo()))})),this.stream.e_((()=>{s((()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,(()=>(this.x_()&&(this.state=3),Promise.resolve()))),this.listener.e_())))})),this.stream.n_((a=>{s((()=>this.G_(a)))})),this.stream.onMessage((a=>{s((()=>++this.C_==1?this.j_(a):this.onNext(a)))}))}O_(){this.state=5,this.F_.g_((async()=>{this.state=0,this.start()}))}G_(e){return ke(yv,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return t=>{this.Fi.enqueueAndForget((()=>this.b_===e?t():(ke(yv,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class aP extends Z0{constructor(e,t,s,a,l,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,s,a,d),this.serializer=l}z_(e,t){return this.connection.P_("Listen",e,t)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const t=hb(this.serializer,e),s=(function(l){if(!("targetChange"in l))return Xe.min();const d=l.targetChange;return d.targetIds&&d.targetIds.length?Xe.min():d.readTime?Is(d.readTime):Xe.min()})(e);return this.listener.J_(t,s)}H_(e){const t={};t.database=If(this.serializer),t.addTarget=(function(l,d){let f;const m=d.target;if(f=wf(m)?{documents:mb(l,m)}:{query:gb(l,m).Vt},f.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){f.resumeToken=z0(l,d.resumeToken);const v=Ef(l,d.expectedCount);v!==null&&(f.expectedCount=v)}else if(d.snapshotVersion.compareTo(Xe.min())>0){f.readTime=Vu(l,d.snapshotVersion.toTimestamp());const v=Ef(l,d.expectedCount);v!==null&&(f.expectedCount=v)}return f})(this.serializer,e);const s=vb(this.serializer,e);s&&(t.labels=s),this.k_(t)}Y_(e){const t={};t.database=If(this.serializer),t.removeTarget=e,this.k_(t)}}class oP extends Z0{constructor(e,t,s,a,l,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,s,a,d),this.serializer=l}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,t){return this.connection.P_("Write",e,t)}j_(e){return St(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,St(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){St(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();const t=pb(e.writeResults,e.commitTime),s=Is(e.commitTime);return this.listener.ta(s,t)}na(){const e={};e.database=If(this.serializer),this.k_(e)}X_(e){const t={streamToken:this.lastStreamToken,writes:e.map((s=>fb(this.serializer,s)))};this.k_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lP{}class cP extends lP{constructor(e,t,s,a){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=s,this.serializer=a,this.ra=!1}ia(){if(this.ra)throw new Oe(le.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,s,a){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,d])=>this.connection.Wo(e,Tf(t,s),a,l,d))).catch((l=>{throw l.name==="FirebaseError"?(l.code===le.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new Oe(le.UNKNOWN,l.toString())}))}Jo(e,t,s,a,l){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([d,f])=>this.connection.Jo(e,Tf(t,s),a,d,f,l))).catch((d=>{throw d.name==="FirebaseError"?(d.code===le.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new Oe(le.UNKNOWN,d.toString())}))}terminate(){this.ra=!0,this.connection.terminate()}}class uP{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve()))))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(ei(t),this._a=!1):ke("OnlineStateTracker",t)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ea="RemoteStore";class dP{constructor(e,t,s,a,l){this.localStore=e,this.datastore=t,this.asyncQueue=s,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=l,this.Ea.xo((d=>{s.enqueueAndForget((async()=>{Ia(this)&&(ke(Ea,"Restarting streams for network reachability change."),await(async function(m){const v=et(m);v.Ia.add(4),await Ql(v),v.Aa.set("Unknown"),v.Ia.delete(4),await sd(v)})(this))}))})),this.Aa=new uP(s,a)}}async function sd(n){if(Ia(n))for(const e of n.da)await e(!0)}async function Ql(n){for(const e of n.da)await e(!1)}function ew(n,e){const t=et(n);t.Ta.has(e.targetId)||(t.Ta.set(e.targetId,e),wp(t)?_p(t):ko(t).x_()&&vp(t,e))}function yp(n,e){const t=et(n),s=ko(t);t.Ta.delete(e),s.x_()&&tw(t,e),t.Ta.size===0&&(s.x_()?s.B_():Ia(t)&&t.Aa.set("Unknown"))}function vp(n,e){if(n.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Xe.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}ko(n).H_(e)}function tw(n,e){n.Ra.$e(e),ko(n).Y_(e)}function _p(n){n.Ra=new ib({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>n.Ta.get(e)||null,lt:()=>n.datastore.serializer.databaseId}),ko(n).start(),n.Aa.aa()}function wp(n){return Ia(n)&&!ko(n).M_()&&n.Ta.size>0}function Ia(n){return et(n).Ia.size===0}function nw(n){n.Ra=void 0}async function hP(n){n.Aa.set("Online")}async function fP(n){n.Ta.forEach(((e,t)=>{vp(n,e)}))}async function pP(n,e){nw(n),wp(n)?(n.Aa.la(e),_p(n)):n.Aa.set("Unknown")}async function mP(n,e,t){if(n.Aa.set("Online"),e instanceof U0&&e.state===2&&e.cause)try{await(async function(a,l){const d=l.cause;for(const f of l.targetIds)a.Ta.has(f)&&(await a.remoteSyncer.rejectListen(f,d),a.Ta.delete(f),a.Ra.removeTarget(f))})(n,e)}catch(s){ke(Ea,"Failed to remove targets %s: %s ",e.targetIds.join(","),s),await Ou(n,s)}else if(e instanceof vu?n.Ra.Ye(e):e instanceof F0?n.Ra.it(e):n.Ra.et(e),!t.isEqual(Xe.min()))try{const s=await J0(n.localStore);t.compareTo(s)>=0&&await(function(l,d){const f=l.Ra.Pt(d);return f.targetChanges.forEach(((m,v)=>{if(m.resumeToken.approximateByteSize()>0){const w=l.Ta.get(v);w&&l.Ta.set(v,w.withResumeToken(m.resumeToken,d))}})),f.targetMismatches.forEach(((m,v)=>{const w=l.Ta.get(m);if(!w)return;l.Ta.set(m,w.withResumeToken(Dn.EMPTY_BYTE_STRING,w.snapshotVersion)),tw(l,m);const S=new Ri(w.target,m,v,w.sequenceNumber);vp(l,S)})),l.remoteSyncer.applyRemoteEvent(f)})(n,t)}catch(s){ke(Ea,"Failed to raise snapshot:",s),await Ou(n,s)}}async function Ou(n,e,t){if(!Ao(e))throw e;n.Ia.add(1),await Ql(n),n.Aa.set("Offline"),t||(t=()=>J0(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{ke(Ea,"Retrying IndexedDB access"),await t(),n.Ia.delete(1),await sd(n)}))}function rw(n,e){return e().catch((t=>Ou(n,t,e)))}async function id(n){const e=et(n),t=zi(e);let s=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:np;for(;gP(e);)try{const a=await Jb(e.localStore,s);if(a===null){e.Pa.length===0&&t.B_();break}s=a.batchId,yP(e,a)}catch(a){await Ou(e,a)}sw(e)&&iw(e)}function gP(n){return Ia(n)&&n.Pa.length<10}function yP(n,e){n.Pa.push(e);const t=zi(n);t.x_()&&t.Z_&&t.X_(e.mutations)}function sw(n){return Ia(n)&&!zi(n).M_()&&n.Pa.length>0}function iw(n){zi(n).start()}async function vP(n){zi(n).na()}async function _P(n){const e=zi(n);for(const t of n.Pa)e.X_(t.mutations)}async function wP(n,e,t){const s=n.Pa.shift(),a=up.from(s,e,t);await rw(n,(()=>n.remoteSyncer.applySuccessfulWrite(a))),await id(n)}async function xP(n,e){e&&zi(n).Z_&&await(async function(s,a){if((function(d){return rb(d)&&d!==le.ABORTED})(a.code)){const l=s.Pa.shift();zi(s).N_(),await rw(s,(()=>s.remoteSyncer.rejectFailedWrite(l.batchId,a))),await id(s)}})(n,e),sw(n)&&iw(n)}async function vv(n,e){const t=et(n);t.asyncQueue.verifyOperationInProgress(),ke(Ea,"RemoteStore received new credentials");const s=Ia(t);t.Ia.add(3),await Ql(t),s&&t.Aa.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ia.delete(3),await sd(t)}async function EP(n,e){const t=et(n);e?(t.Ia.delete(2),await sd(t)):e||(t.Ia.add(2),await Ql(t),t.Aa.set("Unknown"))}function ko(n){return n.Va||(n.Va=(function(t,s,a){const l=et(t);return l.ia(),new aP(s,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(n.datastore,n.asyncQueue,{Zo:hP.bind(null,n),e_:fP.bind(null,n),n_:pP.bind(null,n),J_:mP.bind(null,n)}),n.da.push((async e=>{e?(n.Va.N_(),wp(n)?_p(n):n.Aa.set("Unknown")):(await n.Va.stop(),nw(n))}))),n.Va}function zi(n){return n.ma||(n.ma=(function(t,s,a){const l=et(t);return l.ia(),new oP(s,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),e_:vP.bind(null,n),n_:xP.bind(null,n),ea:_P.bind(null,n),ta:wP.bind(null,n)}),n.da.push((async e=>{e?(n.ma.N_(),await id(n)):(await n.ma.stop(),n.Pa.length>0&&(ke(Ea,`Stopping write stream with ${n.Pa.length} pending writes`),n.Pa=[]))}))),n.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xp{constructor(e,t,s,a,l){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=s,this.op=a,this.removalCallback=l,this.deferred=new Ys,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((d=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,s,a,l){const d=Date.now()+s,f=new xp(e,t,d,a,l);return f.start(s),f}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Oe(le.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ep(n,e){if(ei("AsyncQueue",`${e}: ${n}`),Ao(n))return new Oe(le.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class po{static emptySet(e){return new po(e.comparator)}constructor(e){this.comparator=e?(t,s)=>e(t,s)||$e.comparator(t.key,s.key):(t,s)=>$e.comparator(t.key,s.key),this.keyedMap=yl(),this.sortedSet=new Wt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,s)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof po)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=s.getNext().key;if(!a.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const s=new po;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=t,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _v{constructor(){this.fa=new Wt($e.comparator)}track(e){const t=e.doc.key,s=this.fa.get(t);s?e.type!==0&&s.type===3?this.fa=this.fa.insert(t,e):e.type===3&&s.type!==1?this.fa=this.fa.insert(t,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.fa=this.fa.insert(t,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.fa=this.fa.remove(t):e.type===1&&s.type===2?this.fa=this.fa.insert(t,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):Ke(63341,{At:e,ga:s}):this.fa=this.fa.insert(t,e)}pa(){const e=[];return this.fa.inorderTraversal(((t,s)=>{e.push(s)})),e}}class Eo{constructor(e,t,s,a,l,d,f,m,v){this.query=e,this.docs=t,this.oldDocs=s,this.docChanges=a,this.mutatedKeys=l,this.fromCache=d,this.syncStateChanged=f,this.excludesMetadataChanges=m,this.hasCachedResults=v}static fromInitialDocuments(e,t,s,a,l){const d=[];return t.forEach((f=>{d.push({type:0,doc:f})})),new Eo(e,t,po.emptySet(t),d,s,a,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Xu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,s=e.docChanges;if(t.length!==s.length)return!1;for(let a=0;a<t.length;a++)if(t[a].type!==s[a].type||!t[a].doc.isEqual(s[a].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TP{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some((e=>e.ba()))}}class SP{constructor(){this.queries=wv(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(t,s){const a=et(t),l=a.queries;a.queries=wv(),l.forEach(((d,f)=>{for(const m of f.wa)m.onError(s)}))})(this,new Oe(le.ABORTED,"Firestore shutting down"))}}function wv(){return new Sa((n=>C0(n)),Xu)}async function aw(n,e){const t=et(n);let s=3;const a=e.query;let l=t.queries.get(a);l?!l.Sa()&&e.ba()&&(s=2):(l=new TP,s=e.ba()?0:1);try{switch(s){case 0:l.ya=await t.onListen(a,!0);break;case 1:l.ya=await t.onListen(a,!1);break;case 2:await t.onFirstRemoteStoreListen(a)}}catch(d){const f=Ep(d,`Initialization of query '${oo(e.query)}' failed`);return void e.onError(f)}t.queries.set(a,l),l.wa.push(e),e.va(t.onlineState),l.ya&&e.Ca(l.ya)&&Tp(t)}async function ow(n,e){const t=et(n),s=e.query;let a=3;const l=t.queries.get(s);if(l){const d=l.wa.indexOf(e);d>=0&&(l.wa.splice(d,1),l.wa.length===0?a=e.ba()?0:1:!l.Sa()&&e.ba()&&(a=2))}switch(a){case 0:return t.queries.delete(s),t.onUnlisten(s,!0);case 1:return t.queries.delete(s),t.onUnlisten(s,!1);case 2:return t.onLastRemoteStoreUnlisten(s);default:return}}function IP(n,e){const t=et(n);let s=!1;for(const a of e){const l=a.query,d=t.queries.get(l);if(d){for(const f of d.wa)f.Ca(a)&&(s=!0);d.ya=a}}s&&Tp(t)}function CP(n,e,t){const s=et(n),a=s.queries.get(e);if(a)for(const l of a.wa)l.onError(t);s.queries.delete(e)}function Tp(n){n.Da.forEach((e=>{e.next()}))}var Pf,xv;(xv=Pf||(Pf={})).Fa="default",xv.Cache="cache";class lw{constructor(e,t,s){this.query=e,this.Ma=t,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=s||{}}Ca(e){if(!this.options.includeMetadataChanges){const s=[];for(const a of e.docChanges)a.type!==3&&s.push(a);e=new Eo(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),t=!0):this.Ba(e,this.onlineState)&&(this.La(e),t=!0),this.Oa=e,t}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let t=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),t=!0),t}Ba(e,t){if(!e.fromCache||!this.ba())return!0;const s=t!=="Offline";return(!this.options.ka||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Na(e){if(e.docChanges.length>0)return!0;const t=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}La(e){e=Eo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==Pf.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cw{constructor(e){this.key=e}}class uw{constructor(e){this.key=e}}class bP{constructor(e,t){this.query=e,this.Ha=t,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=dt(),this.mutatedKeys=dt(),this.Xa=b0(e),this.eu=new po(this.Xa)}get tu(){return this.Ha}nu(e,t){const s=t?t.ru:new _v,a=t?t.eu:this.eu;let l=t?t.mutatedKeys:this.mutatedKeys,d=a,f=!1;const m=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,v=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal(((w,S)=>{const C=a.get(w),$=Zu(this.query,S)?S:null,X=!!C&&this.mutatedKeys.has(C.key),q=!!$&&($.hasLocalMutations||this.mutatedKeys.has($.key)&&$.hasCommittedMutations);let U=!1;C&&$?C.data.isEqual($.data)?X!==q&&(s.track({type:3,doc:$}),U=!0):this.iu(C,$)||(s.track({type:2,doc:$}),U=!0,(m&&this.Xa($,m)>0||v&&this.Xa($,v)<0)&&(f=!0)):!C&&$?(s.track({type:0,doc:$}),U=!0):C&&!$&&(s.track({type:1,doc:C}),U=!0,(m||v)&&(f=!0)),U&&($?(d=d.add($),l=q?l.add(w):l.delete(w)):(d=d.delete(w),l=l.delete(w)))})),this.query.limit!==null)for(;d.size>this.query.limit;){const w=this.query.limitType==="F"?d.last():d.first();d=d.delete(w.key),l=l.delete(w.key),s.track({type:1,doc:w})}return{eu:d,ru:s,Ds:f,mutatedKeys:l}}iu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,s,a){const l=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const d=e.ru.pa();d.sort(((w,S)=>(function($,X){const q=U=>{switch(U){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ke(20277,{At:U})}};return q($)-q(X)})(w.type,S.type)||this.Xa(w.doc,S.doc))),this.su(s),a=a!=null&&a;const f=t&&!a?this.ou():[],m=this.Za.size===0&&this.current&&!a?1:0,v=m!==this.Ya;return this.Ya=m,d.length!==0||v?{snapshot:new Eo(this.query,e.eu,l,d,e.mutatedKeys,m===0,v,!1,!!s&&s.resumeToken.approximateByteSize()>0),_u:f}:{_u:f}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new _v,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach((t=>this.Ha=this.Ha.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ha=this.Ha.delete(t))),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=dt(),this.eu.forEach((s=>{this.au(s.key)&&(this.Za=this.Za.add(s.key))}));const t=[];return e.forEach((s=>{this.Za.has(s)||t.push(new uw(s))})),this.Za.forEach((s=>{e.has(s)||t.push(new cw(s))})),t}uu(e){this.Ha=e.qs,this.Za=dt();const t=this.nu(e.documents);return this.applyChanges(t,!0)}cu(){return Eo.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const Sp="SyncEngine";class PP{constructor(e,t,s){this.query=e,this.targetId=t,this.view=s}}class RP{constructor(e){this.key=e,this.lu=!1}}class NP{constructor(e,t,s,a,l,d){this.localStore=e,this.remoteStore=t,this.eventManager=s,this.sharedClientState=a,this.currentUser=l,this.maxConcurrentLimboResolutions=d,this.hu={},this.Pu=new Sa((f=>C0(f)),Xu),this.Tu=new Map,this.Iu=new Set,this.du=new Wt($e.comparator),this.Eu=new Map,this.Au=new fp,this.Ru={},this.Vu=new Map,this.mu=xo.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function AP(n,e,t=!0){const s=gw(n);let a;const l=s.Pu.get(e);return l?(s.sharedClientState.addLocalQueryTarget(l.targetId),a=l.view.cu()):a=await dw(s,e,t,!0),a}async function kP(n,e){const t=gw(n);await dw(t,e,!0,!1)}async function dw(n,e,t,s){const a=await Xb(n.localStore,Ss(e)),l=a.targetId,d=n.sharedClientState.addLocalQueryTarget(l,t);let f;return s&&(f=await jP(n,e,l,d==="current",a.resumeToken)),n.isPrimaryClient&&t&&ew(n.remoteStore,a),f}async function jP(n,e,t,s,a){n.gu=(S,C,$)=>(async function(q,U,ne,xe){let ge=U.view.nu(ne);ge.Ds&&(ge=await fv(q.localStore,U.query,!1).then((({documents:k})=>U.view.nu(k,ge))));const ye=xe&&xe.targetChanges.get(U.targetId),ie=xe&&xe.targetMismatches.get(U.targetId)!=null,Ee=U.view.applyChanges(ge,q.isPrimaryClient,ye,ie);return Tv(q,U.targetId,Ee._u),Ee.snapshot})(n,S,C,$);const l=await fv(n.localStore,e,!0),d=new bP(e,l.qs),f=d.nu(l.documents),m=Kl.createSynthesizedTargetChangeForCurrentChange(t,s&&n.onlineState!=="Offline",a),v=d.applyChanges(f,n.isPrimaryClient,m);Tv(n,t,v._u);const w=new PP(e,t,d);return n.Pu.set(e,w),n.Tu.has(t)?n.Tu.get(t).push(e):n.Tu.set(t,[e]),v.snapshot}async function DP(n,e,t){const s=et(n),a=s.Pu.get(e),l=s.Tu.get(a.targetId);if(l.length>1)return s.Tu.set(a.targetId,l.filter((d=>!Xu(d,e)))),void s.Pu.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(a.targetId),s.sharedClientState.isActiveQueryTarget(a.targetId)||await Cf(s.localStore,a.targetId,!1).then((()=>{s.sharedClientState.clearQueryState(a.targetId),t&&yp(s.remoteStore,a.targetId),Rf(s,a.targetId)})).catch(No)):(Rf(s,a.targetId),await Cf(s.localStore,a.targetId,!0))}async function VP(n,e){const t=et(n),s=t.Pu.get(e),a=t.Tu.get(s.targetId);t.isPrimaryClient&&a.length===1&&(t.sharedClientState.removeLocalQueryTarget(s.targetId),yp(t.remoteStore,s.targetId))}async function LP(n,e,t){const s=$P(n);try{const a=await(function(d,f){const m=et(d),v=Vt.now(),w=f.reduce((($,X)=>$.add(X.key)),dt());let S,C;return m.persistence.runTransaction("Locally write mutations","readwrite",($=>{let X=ti(),q=dt();return m.Os.getEntries($,w).next((U=>{X=U,X.forEach(((ne,xe)=>{xe.isValidDocument()||(q=q.add(ne))}))})).next((()=>m.localDocuments.getOverlayedDocuments($,X))).next((U=>{S=U;const ne=[];for(const xe of f){const ge=XC(xe,S.get(xe.key).overlayedDocument);ge!=null&&ne.push(new Ki(xe.key,ge,_0(ge.value.mapValue),Or.exists(!0)))}return m.mutationQueue.addMutationBatch($,v,ne,f)})).next((U=>{C=U;const ne=U.applyToLocalDocumentSet(S,q);return m.documentOverlayCache.saveOverlays($,U.batchId,ne)}))})).then((()=>({batchId:C.batchId,changes:R0(S)})))})(s.localStore,e);s.sharedClientState.addPendingMutation(a.batchId),(function(d,f,m){let v=d.Ru[d.currentUser.toKey()];v||(v=new Wt(st)),v=v.insert(f,m),d.Ru[d.currentUser.toKey()]=v})(s,a.batchId,t),await Yl(s,a.changes),await id(s.remoteStore)}catch(a){const l=Ep(a,"Failed to persist write");t.reject(l)}}async function hw(n,e){const t=et(n);try{const s=await Qb(t.localStore,e);e.targetChanges.forEach(((a,l)=>{const d=t.Eu.get(l);d&&(St(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?d.lu=!0:a.modifiedDocuments.size>0?St(d.lu,14607):a.removedDocuments.size>0&&(St(d.lu,42227),d.lu=!1))})),await Yl(t,s,e)}catch(s){await No(s)}}function Ev(n,e,t){const s=et(n);if(s.isPrimaryClient&&t===0||!s.isPrimaryClient&&t===1){const a=[];s.Pu.forEach(((l,d)=>{const f=d.view.va(e);f.snapshot&&a.push(f.snapshot)})),(function(d,f){const m=et(d);m.onlineState=f;let v=!1;m.queries.forEach(((w,S)=>{for(const C of S.wa)C.va(f)&&(v=!0)})),v&&Tp(m)})(s.eventManager,e),a.length&&s.hu.J_(a),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function OP(n,e,t){const s=et(n);s.sharedClientState.updateQueryState(e,"rejected",t);const a=s.Eu.get(e),l=a&&a.key;if(l){let d=new Wt($e.comparator);d=d.insert(l,Gn.newNoDocument(l,Xe.min()));const f=dt().add(l),m=new nd(Xe.min(),new Map,new Wt(st),d,f);await hw(s,m),s.du=s.du.remove(l),s.Eu.delete(e),Ip(s)}else await Cf(s.localStore,e,!1).then((()=>Rf(s,e,t))).catch(No)}async function MP(n,e){const t=et(n),s=e.batch.batchId;try{const a=await Kb(t.localStore,e);pw(t,s,null),fw(t,s),t.sharedClientState.updateMutationState(s,"acknowledged"),await Yl(t,a)}catch(a){await No(a)}}async function FP(n,e,t){const s=et(n);try{const a=await(function(d,f){const m=et(d);return m.persistence.runTransaction("Reject batch","readwrite-primary",(v=>{let w;return m.mutationQueue.lookupMutationBatch(v,f).next((S=>(St(S!==null,37113),w=S.keys(),m.mutationQueue.removeMutationBatch(v,S)))).next((()=>m.mutationQueue.performConsistencyCheck(v))).next((()=>m.documentOverlayCache.removeOverlaysForBatchId(v,w,f))).next((()=>m.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(v,w))).next((()=>m.localDocuments.getDocuments(v,w)))}))})(s.localStore,e);pw(s,e,t),fw(s,e),s.sharedClientState.updateMutationState(e,"rejected",t),await Yl(s,a)}catch(a){await No(a)}}function fw(n,e){(n.Vu.get(e)||[]).forEach((t=>{t.resolve()})),n.Vu.delete(e)}function pw(n,e,t){const s=et(n);let a=s.Ru[s.currentUser.toKey()];if(a){const l=a.get(e);l&&(t?l.reject(t):l.resolve(),a=a.remove(e)),s.Ru[s.currentUser.toKey()]=a}}function Rf(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const s of n.Tu.get(e))n.Pu.delete(s),t&&n.hu.pu(s,t);n.Tu.delete(e),n.isPrimaryClient&&n.Au.zr(e).forEach((s=>{n.Au.containsKey(s)||mw(n,s)}))}function mw(n,e){n.Iu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(yp(n.remoteStore,t),n.du=n.du.remove(e),n.Eu.delete(t),Ip(n))}function Tv(n,e,t){for(const s of t)s instanceof cw?(n.Au.addReference(s.key,e),UP(n,s)):s instanceof uw?(ke(Sp,"Document no longer in limbo: "+s.key),n.Au.removeReference(s.key,e),n.Au.containsKey(s.key)||mw(n,s.key)):Ke(19791,{yu:s})}function UP(n,e){const t=e.key,s=t.path.canonicalString();n.du.get(t)||n.Iu.has(s)||(ke(Sp,"New document in limbo: "+t),n.Iu.add(s),Ip(n))}function Ip(n){for(;n.Iu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Iu.values().next().value;n.Iu.delete(e);const t=new $e(Dt.fromString(e)),s=n.mu.next();n.Eu.set(s,new RP(t)),n.du=n.du.insert(t,s),ew(n.remoteStore,new Ri(Ss(op(t.path)),s,"TargetPurposeLimboResolution",Ku.ue))}}async function Yl(n,e,t){const s=et(n),a=[],l=[],d=[];s.Pu.isEmpty()||(s.Pu.forEach(((f,m)=>{d.push(s.gu(m,e,t).then((v=>{var w;if((v||t)&&s.isPrimaryClient){const S=v?!v.fromCache:(w=t==null?void 0:t.targetChanges.get(m.targetId))===null||w===void 0?void 0:w.current;s.sharedClientState.updateQueryState(m.targetId,S?"current":"not-current")}if(v){a.push(v);const S=mp.Es(m.targetId,v);l.push(S)}})))})),await Promise.all(d),s.hu.J_(a),await(async function(m,v){const w=et(m);try{await w.persistence.runTransaction("notifyLocalViewChanges","readwrite",(S=>ae.forEach(v,(C=>ae.forEach(C.Is,($=>w.persistence.referenceDelegate.addReference(S,C.targetId,$))).next((()=>ae.forEach(C.ds,($=>w.persistence.referenceDelegate.removeReference(S,C.targetId,$)))))))))}catch(S){if(!Ao(S))throw S;ke(gp,"Failed to update sequence numbers: "+S)}for(const S of v){const C=S.targetId;if(!S.fromCache){const $=w.Fs.get(C),X=$.snapshotVersion,q=$.withLastLimboFreeSnapshotVersion(X);w.Fs=w.Fs.insert(C,q)}}})(s.localStore,l))}async function zP(n,e){const t=et(n);if(!t.currentUser.isEqual(e)){ke(Sp,"User change. New user:",e.toKey());const s=await Y0(t.localStore,e);t.currentUser=e,(function(l,d){l.Vu.forEach((f=>{f.forEach((m=>{m.reject(new Oe(le.CANCELLED,d))}))})),l.Vu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await Yl(t,s.Bs)}}function BP(n,e){const t=et(n),s=t.Eu.get(e);if(s&&s.lu)return dt().add(s.key);{let a=dt();const l=t.Tu.get(e);if(!l)return a;for(const d of l){const f=t.Pu.get(d);a=a.unionWith(f.view.tu)}return a}}function gw(n){const e=et(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=hw.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=BP.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=OP.bind(null,e),e.hu.J_=IP.bind(null,e.eventManager),e.hu.pu=CP.bind(null,e.eventManager),e}function $P(n){const e=et(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=MP.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=FP.bind(null,e),e}class Mu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=rd(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,t){return null}Fu(e,t){return null}vu(e){return qb(this.persistence,new Wb,e.initialUser,this.serializer)}Du(e){return new Q0(pp.Vi,this.serializer)}bu(e){return new eP}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Mu.provider={build:()=>new Mu};class WP extends Mu{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,t){St(this.persistence.referenceDelegate instanceof Lu,46915);const s=this.persistence.referenceDelegate.garbageCollector;return new Rb(s,e.asyncQueue,t)}Du(e){const t=this.cacheSizeBytes!==void 0?mr.withCacheSize(this.cacheSizeBytes):mr.DEFAULT;return new Q0((s=>Lu.Vi(s,t)),this.serializer)}}class Nf{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>Ev(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=zP.bind(null,this.syncEngine),await EP(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new SP})()}createDatastore(e){const t=rd(e.databaseInfo.databaseId),s=(function(l){return new iP(l)})(e.databaseInfo);return(function(l,d,f,m){return new cP(l,d,f,m)})(e.authCredentials,e.appCheckCredentials,s,t)}createRemoteStore(e){return(function(s,a,l,d,f){return new dP(s,a,l,d,f)})(this.localStore,this.datastore,e.asyncQueue,(t=>Ev(this.syncEngine,t,0)),(function(){return gv.C()?new gv:new tP})())}createSyncEngine(e,t){return(function(a,l,d,f,m,v,w){const S=new NP(a,l,d,f,m,v);return w&&(S.fu=!0),S})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(a){const l=et(a);ke(Ea,"RemoteStore shutting down."),l.Ia.add(5),await Ql(l),l.Ea.shutdown(),l.Aa.set("Unknown")})(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}Nf.provider={build:()=>new Nf};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yw{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):ei("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bi="FirestoreClient";class GP{constructor(e,t,s,a,l){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=s,this.databaseInfo=a,this.user=Wn.UNAUTHENTICATED,this.clientId=ep.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(s,(async d=>{ke(Bi,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d})),this.appCheckCredentials.start(s,(d=>(ke(Bi,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ys;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const s=Ep(t,"Failed to shutdown persistence");e.reject(s)}})),e.promise}}async function Xh(n,e){n.asyncQueue.verifyOperationInProgress(),ke(Bi,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let s=t.initialUser;n.setCredentialChangeListener((async a=>{s.isEqual(a)||(await Y0(e.localStore,a),s=a)})),e.persistence.setDatabaseDeletedListener((()=>{Li("Terminating Firestore due to IndexedDb database deletion"),n.terminate().then((()=>{ke("Terminating Firestore due to IndexedDb database deletion completed successfully")})).catch((a=>{Li("Terminating Firestore due to IndexedDb database deletion failed",a)}))})),n._offlineComponents=e}async function Sv(n,e){n.asyncQueue.verifyOperationInProgress();const t=await HP(n);ke(Bi,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((s=>vv(e.remoteStore,s))),n.setAppCheckTokenChangeListener(((s,a)=>vv(e.remoteStore,a))),n._onlineComponents=e}async function HP(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){ke(Bi,"Using user provided OfflineComponentProvider");try{await Xh(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(a){return a.name==="FirebaseError"?a.code===le.FAILED_PRECONDITION||a.code===le.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11})(t))throw t;Li("Error using user provided cache. Falling back to memory cache: "+t),await Xh(n,new Mu)}}else ke(Bi,"Using default OfflineComponentProvider"),await Xh(n,new WP(void 0));return n._offlineComponents}async function vw(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(ke(Bi,"Using user provided OnlineComponentProvider"),await Sv(n,n._uninitializedComponentsProvider._online)):(ke(Bi,"Using default OnlineComponentProvider"),await Sv(n,new Nf))),n._onlineComponents}function qP(n){return vw(n).then((e=>e.syncEngine))}async function _w(n){const e=await vw(n),t=e.eventManager;return t.onListen=AP.bind(null,e.syncEngine),t.onUnlisten=DP.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=kP.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=VP.bind(null,e.syncEngine),t}function KP(n,e,t={}){const s=new Ys;return n.asyncQueue.enqueueAndForget((async()=>(function(l,d,f,m,v){const w=new yw({next:C=>{w.Ou(),d.enqueueAndForget((()=>ow(l,S)));const $=C.docs.has(f);!$&&C.fromCache?v.reject(new Oe(le.UNAVAILABLE,"Failed to get document because the client is offline.")):$&&C.fromCache&&m&&m.source==="server"?v.reject(new Oe(le.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):v.resolve(C)},error:C=>v.reject(C)}),S=new lw(op(f.path),w,{includeMetadataChanges:!0,ka:!0});return aw(l,S)})(await _w(n),n.asyncQueue,e,t,s))),s.promise}function QP(n,e,t={}){const s=new Ys;return n.asyncQueue.enqueueAndForget((async()=>(function(l,d,f,m,v){const w=new yw({next:C=>{w.Ou(),d.enqueueAndForget((()=>ow(l,S))),C.fromCache&&m.source==="server"?v.reject(new Oe(le.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):v.resolve(C)},error:C=>v.reject(C)}),S=new lw(f,w,{includeMetadataChanges:!0,ka:!0});return aw(l,S)})(await _w(n),n.asyncQueue,e,t,s))),s.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ww(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iv=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xw="firestore.googleapis.com",Cv=!0;class bv{constructor(e){var t,s;if(e.host===void 0){if(e.ssl!==void 0)throw new Oe(le.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=xw,this.ssl=Cv}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:Cv;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=K0;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<bb)throw new Oe(le.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}uC("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=ww((s=e.experimentalLongPollingOptions)!==null&&s!==void 0?s:{}),(function(l){if(l.timeoutSeconds!==void 0){if(isNaN(l.timeoutSeconds))throw new Oe(le.INVALID_ARGUMENT,`invalid long polling timeout: ${l.timeoutSeconds} (must not be NaN)`);if(l.timeoutSeconds<5)throw new Oe(le.INVALID_ARGUMENT,`invalid long polling timeout: ${l.timeoutSeconds} (minimum allowed value is 5)`);if(l.timeoutSeconds>30)throw new Oe(le.INVALID_ARGUMENT,`invalid long polling timeout: ${l.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(s,a){return s.timeoutSeconds===a.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class ad{constructor(e,t,s,a){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=s,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new bv({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Oe(le.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Oe(le.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new bv(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(s){if(!s)return new tC;switch(s.type){case"firstParty":return new iC(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new Oe(le.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const s=Iv.get(t);s&&(ke("ComponentProvider","Removing Datastore"),Iv.delete(t),s.terminate())})(this),Promise.resolve()}}function YP(n,e,t,s={}){var a;n=rs(n,ad);const l=Io(e),d=n._getSettings(),f=Object.assign(Object.assign({},d),{emulatorOptions:n._getEmulatorOptions()}),m=`${e}:${t}`;l&&(l_(`https://${m}`),c_("Firestore",!0)),d.host!==xw&&d.host!==m&&Li("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const v=Object.assign(Object.assign({},d),{host:m,ssl:l,emulatorOptions:s});if(!va(v,f)&&(n._setSettings(v),s.mockUserToken)){let w,S;if(typeof s.mockUserToken=="string")w=s.mockUserToken,S=Wn.MOCK_USER;else{w=cT(s.mockUserToken,(a=n._app)===null||a===void 0?void 0:a.options.projectId);const C=s.mockUserToken.sub||s.mockUserToken.user_id;if(!C)throw new Oe(le.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");S=new Wn(C)}n._authCredentials=new nC(new a0(w,S))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class od{constructor(e,t,s){this.converter=t,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new od(this.firestore,e,this._query)}}class rn{constructor(e,t,s){this.converter=t,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Vi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new rn(this.firestore,e,this._key)}toJSON(){return{type:rn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,s){if(Hl(t,rn._jsonSchema))return new rn(e,s||null,new $e(Dt.fromString(t.referencePath)))}}rn._jsonSchemaVersion="firestore/documentReference/1.0",rn._jsonSchema={type:nn("string",rn._jsonSchemaVersion),referencePath:nn("string")};class Vi extends od{constructor(e,t,s){super(e,t,op(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new rn(this.firestore,null,new $e(e))}withConverter(e){return new Vi(this.firestore,e,this._path)}}function rr(n,e,...t){if(n=sn(n),l0("collection","path",e),n instanceof ad){const s=Dt.fromString(e,...t);return zy(s),new Vi(n,null,s)}{if(!(n instanceof rn||n instanceof Vi))throw new Oe(le.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(Dt.fromString(e,...t));return zy(s),new Vi(n.firestore,null,s)}}function Pt(n,e,...t){if(n=sn(n),arguments.length===1&&(e=ep.newId()),l0("doc","path",e),n instanceof ad){const s=Dt.fromString(e,...t);return Uy(s),new rn(n,null,new $e(s))}{if(!(n instanceof rn||n instanceof Vi))throw new Oe(le.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(Dt.fromString(e,...t));return Uy(s),new rn(n.firestore,n instanceof Vi?n.converter:null,new $e(s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pv="AsyncQueue";class Rv{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new X0(this,"async_queue_retry"),this.oc=()=>{const s=Jh();s&&ke(Pv,"Visibility state changed to "+s.visibilityState),this.F_.y_()},this._c=e;const t=Jh();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const t=Jh();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise((()=>{}));const t=new Ys;return this.uc((()=>this.Xu&&this.rc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Zu.push(e),this.cc())))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!Ao(e))throw e;ke(Pv,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_((()=>this.cc()))}}uc(e){const t=this._c.then((()=>(this.nc=!0,e().catch((s=>{throw this.tc=s,this.nc=!1,ei("INTERNAL UNHANDLED ERROR: ",Nv(s)),s})).then((s=>(this.nc=!1,s))))));return this._c=t,t}enqueueAfterDelay(e,t,s){this.ac(),this.sc.indexOf(e)>-1&&(t=0);const a=xp.createAndSchedule(this,e,t,s,(l=>this.lc(l)));return this.ec.push(a),a}ac(){this.tc&&Ke(47125,{hc:Nv(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(const t of this.ec)if(t.timerId===e)return!0;return!1}Ic(e){return this.Pc().then((()=>{this.ec.sort(((t,s)=>t.targetTimeMs-s.targetTimeMs));for(const t of this.ec)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Pc()}))}dc(e){this.sc.push(e)}lc(e){const t=this.ec.indexOf(e);this.ec.splice(t,1)}}function Nv(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class Ca extends ad{constructor(e,t,s,a){super(e,t,s,a),this.type="firestore",this._queue=new Rv,this._persistenceKey=(a==null?void 0:a.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Rv(e),this._firestoreClient=void 0,await e}}}function JP(n,e){const t=typeof n=="object"?n:f_(),s=typeof n=="string"?n:Nu,a=zf(t,"firestore").getImmediate({identifier:s});if(!a._initialized){const l=oT("firestore");l&&YP(a,...l)}return a}function Cp(n){if(n._terminated)throw new Oe(le.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||XP(n),n._firestoreClient}function XP(n){var e,t,s;const a=n._freezeSettings(),l=(function(f,m,v,w){return new xC(f,m,v,w.host,w.ssl,w.experimentalForceLongPolling,w.experimentalAutoDetectLongPolling,ww(w.experimentalLongPollingOptions),w.useFetchStreams,w.isUsingEmulator)})(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,a);n._componentsProvider||!((t=a.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((s=a.localCache)===null||s===void 0)&&s._onlineComponentProvider)&&(n._componentsProvider={_offline:a.localCache._offlineComponentProvider,_online:a.localCache._onlineComponentProvider}),n._firestoreClient=new GP(n._authCredentials,n._appCheckCredentials,n._queue,l,n._componentsProvider&&(function(f){const m=f==null?void 0:f._online.build();return{_offline:f==null?void 0:f._offline.build(m),_online:m}})(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Vr(Dn.fromBase64String(e))}catch(t){throw new Oe(le.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Vr(Dn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Vr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Hl(e,Vr._jsonSchema))return Vr.fromBase64String(e.bytes)}}Vr._jsonSchemaVersion="firestore/bytes/1.0",Vr._jsonSchema={type:nn("string",Vr._jsonSchemaVersion),bytes:nn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ld{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Oe(le.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new jn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cd{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cs{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Oe(le.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Oe(le.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return st(this._lat,e._lat)||st(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Cs._jsonSchemaVersion}}static fromJSON(e){if(Hl(e,Cs._jsonSchema))return new Cs(e.latitude,e.longitude)}}Cs._jsonSchemaVersion="firestore/geoPoint/1.0",Cs._jsonSchema={type:nn("string",Cs._jsonSchemaVersion),latitude:nn("number"),longitude:nn("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bs{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(s,a){if(s.length!==a.length)return!1;for(let l=0;l<s.length;++l)if(s[l]!==a[l])return!1;return!0})(this._values,e._values)}toJSON(){return{type:bs._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Hl(e,bs._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new bs(e.vectorValues);throw new Oe(le.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}bs._jsonSchemaVersion="firestore/vectorValue/1.0",bs._jsonSchema={type:nn("string",bs._jsonSchemaVersion),vectorValues:nn("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZP=/^__.*__$/;class eR{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return this.fieldMask!==null?new Ki(e,this.data,this.fieldMask,t,this.fieldTransforms):new ql(e,this.data,t,this.fieldTransforms)}}class Ew{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return new Ki(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Tw(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ke(40011,{Ec:n})}}class bp{constructor(e,t,s,a,l,d){this.settings=e,this.databaseId=t,this.serializer=s,this.ignoreUndefinedProperties=a,l===void 0&&this.Ac(),this.fieldTransforms=l||[],this.fieldMask=d||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new bp(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var t;const s=(t=this.path)===null||t===void 0?void 0:t.child(e),a=this.Rc({path:s,mc:!1});return a.fc(e),a}gc(e){var t;const s=(t=this.path)===null||t===void 0?void 0:t.child(e),a=this.Rc({path:s,mc:!1});return a.Ac(),a}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return Fu(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(Tw(this.Ec)&&ZP.test(e))throw this.wc('Document fields cannot begin and end with "__"')}}class tR{constructor(e,t,s){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=s||rd(e)}Dc(e,t,s,a=!1){return new bp({Ec:e,methodName:t,bc:s,path:jn.emptyPath(),mc:!1,Sc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Pp(n){const e=n._freezeSettings(),t=rd(n._databaseId);return new tR(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Sw(n,e,t,s,a,l={}){const d=n.Dc(l.merge||l.mergeFields?2:0,e,t,a);Np("Data must be an object, but it was:",d,s);const f=Iw(s,d);let m,v;if(l.merge)m=new Ir(d.fieldMask),v=d.fieldTransforms;else if(l.mergeFields){const w=[];for(const S of l.mergeFields){const C=Af(e,S,t);if(!d.contains(C))throw new Oe(le.INVALID_ARGUMENT,`Field '${C}' is specified in your field mask but missing from your input data.`);bw(w,C)||w.push(C)}m=new Ir(w),v=d.fieldTransforms.filter((S=>m.covers(S.field)))}else m=null,v=d.fieldTransforms;return new eR(new gr(f),m,v)}class Jl extends cd{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Jl}}class Rp extends cd{_toFieldTransform(e){return new KC(e.path,new Ol)}isEqual(e){return e instanceof Rp}}function nR(n,e,t,s){const a=n.Dc(1,e,t);Np("Data must be an object, but it was:",a,s);const l=[],d=gr.empty();qi(s,((m,v)=>{const w=Ap(e,m,t);v=sn(v);const S=a.gc(w);if(v instanceof Jl)l.push(w);else{const C=ud(v,S);C!=null&&(l.push(w),d.set(w,C))}}));const f=new Ir(l);return new Ew(d,f,a.fieldTransforms)}function rR(n,e,t,s,a,l){const d=n.Dc(1,e,t),f=[Af(e,s,t)],m=[a];if(l.length%2!=0)throw new Oe(le.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let C=0;C<l.length;C+=2)f.push(Af(e,l[C])),m.push(l[C+1]);const v=[],w=gr.empty();for(let C=f.length-1;C>=0;--C)if(!bw(v,f[C])){const $=f[C];let X=m[C];X=sn(X);const q=d.gc($);if(X instanceof Jl)v.push($);else{const U=ud(X,q);U!=null&&(v.push($),w.set($,U))}}const S=new Ir(v);return new Ew(w,S,d.fieldTransforms)}function ud(n,e){if(Cw(n=sn(n)))return Np("Unsupported field value:",e,n),Iw(n,e);if(n instanceof cd)return(function(s,a){if(!Tw(a.Ec))throw a.wc(`${s._methodName}() can only be used with update() and set()`);if(!a.path)throw a.wc(`${s._methodName}() is not currently supported inside arrays`);const l=s._toFieldTransform(a);l&&a.fieldTransforms.push(l)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return(function(s,a){const l=[];let d=0;for(const f of s){let m=ud(f,a.yc(d));m==null&&(m={nullValue:"NULL_VALUE"}),l.push(m),d++}return{arrayValue:{values:l}}})(n,e)}return(function(s,a){if((s=sn(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return GC(a.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const l=Vt.fromDate(s);return{timestampValue:Vu(a.serializer,l)}}if(s instanceof Vt){const l=new Vt(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:Vu(a.serializer,l)}}if(s instanceof Cs)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof Vr)return{bytesValue:z0(a.serializer,s._byteString)};if(s instanceof rn){const l=a.databaseId,d=s.firestore._databaseId;if(!d.isEqual(l))throw a.wc(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:hp(s.firestore._databaseId||a.databaseId,s._key.path)}}if(s instanceof bs)return(function(d,f){return{mapValue:{fields:{[y0]:{stringValue:v0},[Au]:{arrayValue:{values:d.toArray().map((v=>{if(typeof v!="number")throw f.wc("VectorValues must only contain numeric values.");return lp(f.serializer,v)}))}}}}}})(s,a);throw a.wc(`Unsupported field value: ${tp(s)}`)})(n,e)}function Iw(n,e){const t={};return d0(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):qi(n,((s,a)=>{const l=ud(a,e.Vc(s));l!=null&&(t[s]=l)})),{mapValue:{fields:t}}}function Cw(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Vt||n instanceof Cs||n instanceof Vr||n instanceof rn||n instanceof cd||n instanceof bs)}function Np(n,e,t){if(!Cw(t)||!c0(t)){const s=tp(t);throw s==="an object"?e.wc(n+" a custom object"):e.wc(n+" "+s)}}function Af(n,e,t){if((e=sn(e))instanceof ld)return e._internalPath;if(typeof e=="string")return Ap(n,e);throw Fu("Field path arguments must be of type string or ",n,!1,void 0,t)}const sR=new RegExp("[~\\*/\\[\\]]");function Ap(n,e,t){if(e.search(sR)>=0)throw Fu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new ld(...e.split("."))._internalPath}catch{throw Fu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Fu(n,e,t,s,a){const l=s&&!s.isEmpty(),d=a!==void 0;let f=`Function ${e}() called with invalid data`;t&&(f+=" (via `toFirestore()`)"),f+=". ";let m="";return(l||d)&&(m+=" (found",l&&(m+=` in field ${s}`),d&&(m+=` in document ${a}`),m+=")"),new Oe(le.INVALID_ARGUMENT,f+n+m)}function bw(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pw{constructor(e,t,s,a,l){this._firestore=e,this._userDataWriter=t,this._key=s,this._document=a,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new rn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new iR(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Rw("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class iR extends Pw{data(){return super.data()}}function Rw(n,e){return typeof e=="string"?Ap(n,e):e instanceof ld?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aR(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Oe(le.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class oR{convertValue(e,t="none"){switch(Ui(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Kt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Fi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ke(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const s={};return qi(e,((a,l)=>{s[a]=this.convertValue(l,t)})),s}convertVectorValue(e){var t,s,a;const l=(a=(s=(t=e.fields)===null||t===void 0?void 0:t[Au].arrayValue)===null||s===void 0?void 0:s.values)===null||a===void 0?void 0:a.map((d=>Kt(d.doubleValue)));return new bs(l)}convertGeoPoint(e){return new Cs(Kt(e.latitude),Kt(e.longitude))}convertArray(e,t){return(e.values||[]).map((s=>this.convertValue(s,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const s=Yu(e);return s==null?null:this.convertValue(s,t);case"estimate":return this.convertTimestamp(Dl(e));default:return null}}convertTimestamp(e){const t=Mi(e);return new Vt(t.seconds,t.nanos)}convertDocumentKey(e,t){const s=Dt.fromString(e);St(q0(s),9688,{name:e});const a=new Vl(s.get(1),s.get(3)),l=new $e(s.popFirst(5));return a.isEqual(t)||ei(`Document ${l} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nw(n,e,t){let s;return s=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,s}class _l{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ya extends Pw{constructor(e,t,s,a,l,d){super(e,t,s,a,d),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new _u(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const s=this._document.data.field(Rw("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Oe(le.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=ya._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}ya._jsonSchemaVersion="firestore/documentSnapshot/1.0",ya._jsonSchema={type:nn("string",ya._jsonSchemaVersion),bundleSource:nn("string","DocumentSnapshot"),bundleName:nn("string"),bundle:nn("string")};class _u extends ya{data(e={}){return super.data(e)}}class mo{constructor(e,t,s,a){this._firestore=e,this._userDataWriter=t,this._snapshot=a,this.metadata=new _l(a.hasPendingWrites,a.fromCache),this.query=s}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((s=>{e.call(t,new _u(this._firestore,this._userDataWriter,s.key,s,new _l(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Oe(le.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(a,l){if(a._snapshot.oldDocs.isEmpty()){let d=0;return a._snapshot.docChanges.map((f=>{const m=new _u(a._firestore,a._userDataWriter,f.doc.key,f.doc,new _l(a._snapshot.mutatedKeys.has(f.doc.key),a._snapshot.fromCache),a.query.converter);return f.doc,{type:"added",doc:m,oldIndex:-1,newIndex:d++}}))}{let d=a._snapshot.oldDocs;return a._snapshot.docChanges.filter((f=>l||f.type!==3)).map((f=>{const m=new _u(a._firestore,a._userDataWriter,f.doc.key,f.doc,new _l(a._snapshot.mutatedKeys.has(f.doc.key),a._snapshot.fromCache),a.query.converter);let v=-1,w=-1;return f.type!==0&&(v=d.indexOf(f.doc.key),d=d.delete(f.doc.key)),f.type!==1&&(d=d.add(f.doc),w=d.indexOf(f.doc.key)),{type:lR(f.type),doc:m,oldIndex:v,newIndex:w}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Oe(le.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=mo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=ep.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],s=[],a=[];return this.docs.forEach((l=>{l._document!==null&&(t.push(l._document),s.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),a.push(l.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function lR(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ke(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kp(n){n=rs(n,rn);const e=rs(n.firestore,Ca);return KP(Cp(e),n._key).then((t=>cR(e,n,t)))}mo._jsonSchemaVersion="firestore/querySnapshot/1.0",mo._jsonSchema={type:nn("string",mo._jsonSchemaVersion),bundleSource:nn("string","QuerySnapshot"),bundleName:nn("string"),bundle:nn("string")};class Aw extends oR{constructor(e){super(),this.firestore=e}convertBytes(e){return new Vr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new rn(this.firestore,null,t)}}function Gs(n){n=rs(n,od);const e=rs(n.firestore,Ca),t=Cp(e),s=new Aw(e);return aR(n._query),QP(t,n._query).then((a=>new mo(e,s,n,a)))}function Ks(n,e,t){n=rs(n,rn);const s=rs(n.firestore,Ca),a=Nw(n.converter,e,t);return dd(s,[Sw(Pp(s),"setDoc",n._key,a,n.converter!==null,t).toMutation(n._key,Or.none())])}function Es(n,e,t,...s){n=rs(n,rn);const a=rs(n.firestore,Ca),l=Pp(a);let d;return d=typeof(e=sn(e))=="string"||e instanceof ld?rR(l,"updateDoc",n._key,e,t,s):nR(l,"updateDoc",n._key,e),dd(a,[d.toMutation(n._key,Or.exists(!0))])}function pa(n){return dd(rs(n.firestore,Ca),[new cp(n._key,Or.none())])}function ma(n,e){const t=rs(n.firestore,Ca),s=Pt(n),a=Nw(n.converter,e);return dd(t,[Sw(Pp(n.firestore),"addDoc",s._key,a,n.converter!==null,{}).toMutation(s._key,Or.exists(!1))]).then((()=>s))}function dd(n,e){return(function(s,a){const l=new Ys;return s.asyncQueue.enqueueAndForget((async()=>LP(await qP(s),a,l))),l.promise})(Cp(n),e)}function cR(n,e,t){const s=t.docs.get(e._key),a=new Aw(n);return new ya(n,a,e._key,s,new _l(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uR(){return new Jl("deleteField")}function Uu(){return new Rp("serverTimestamp")}(function(e,t=!0){(function(a){Ro=a})(Co),go(new _a("firestore",((s,{instanceIdentifier:a,options:l})=>{const d=s.getProvider("app").getImmediate(),f=new Ca(new rC(s.getProvider("auth-internal")),new aC(d,s.getProvider("app-check-internal")),(function(v,w){if(!Object.prototype.hasOwnProperty.apply(v.options,["projectId"]))throw new Oe(le.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Vl(v.options.projectId,w)})(d,a),d);return l=Object.assign({useFetchStreams:t},l),f._setSettings(l),f}),"PUBLIC").setMultipleInstances(!0)),ji(Vy,Ly,e),ji(Vy,Ly,"esm2017")})();const dR={apiKey:"AIzaSyCOOnlmEcAcJywsS93LLfLSywy9ENqnppM",authDomain:"tyler-manga-library.firebaseapp.com",projectId:"tyler-manga-library",storageBucket:"tyler-manga-library.firebasestorage.app",messagingSenderId:"307412068362",appId:"1:307412068362:web:6cfe5666187439dfa757f3"},kw=h_(dR),Lr=ZI(kw),tt=JP(kw),jw=D.createContext(null);function hR({children:n}){const e="https://discord.com/api/webhooks/1451655828078723156/EA8QhLeiTT-7jOVQ6jFpV2he2zxVpAddAhlu8CiC6RtGFu9wTAOLdRjKeYHIV1OhVbmm",[t,s]=D.useState(null),[a,l]=D.useState(!1),[d,f]=D.useState("viewer"),[m,v]=D.useState(!0),w=async $=>{if(!$)return null;const X=Pt(tt,"users",$.uid);let q=null;try{const ne=await kp(X);ne.exists()&&(q=ne.data())}catch(ne){console.warn("Failed to read user doc",ne)}const U={role:((q==null?void 0:q.role)||"viewer").toLowerCase()==="admin"?"admin":"viewer",email:$.email||(q==null?void 0:q.email)||"",displayName:$.displayName||(q==null?void 0:q.displayName)||"",createdAt:(q==null?void 0:q.createdAt)||Uu()};try{if(await Ks(X,U,{merge:!0}),!q&&e)try{const ne=$.displayName||$.email||$.uid;await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:`New signup: ${ne}`})})}catch(ne){console.warn("Failed to send signup webhook",ne)}}catch(ne){console.error("Failed to ensure user doc",ne)}return{...q,...U}};D.useEffect(()=>{const $=$1(Lr,async X=>{if(s(X),X)try{const q=await w(X),U=(q==null?void 0:q.role)||"viewer";f(U),l(U.toLowerCase()==="admin")}catch(q){console.error("Error checking role:",q),l(!1),f("viewer")}else l(!1),f("viewer");v(!1)});return()=>$()},[]);const S=async($,X)=>{await U_(Lr,$,X)},C=async()=>{await z_(Lr)};return c.jsx(jw.Provider,{value:{user:t,admin:a,role:d,loading:m,login:S,logout:C},children:n})}function jo(){return D.useContext(jw)}function fR({onClose:n}){const[e,t]=D.useState("login"),[s,a]=D.useState(""),[l,d]=D.useState("");async function f(){try{await J_(Lr,new es),n()}catch(w){alert(w.message)}}async function m(w){w.preventDefault();try{await U_(Lr,s,l),n()}catch(S){alert(S.message)}}async function v(w){w.preventDefault();try{await M1(Lr,s,l),n()}catch(S){alert(S.message)}}return c.jsx("div",{className:"auth-modal-backdrop",onClick:n,children:c.jsxs("div",{className:"auth-modal",onClick:w=>w.stopPropagation(),children:[c.jsx("h2",{className:"auth-title",children:e==="login"?"Sign In":"Create Account"}),c.jsxs("button",{className:"google-btn",onClick:f,children:[c.jsx("img",{src:"https://www.svgrepo.com/show/475656/google-color.svg",alt:"",className:"google-icon"}),"Continue with Google"]}),c.jsx("div",{className:"auth-divider",children:c.jsx("span",{children:"or"})}),c.jsxs("form",{onSubmit:e==="login"?m:v,className:"auth-form",children:[c.jsx("input",{type:"email",placeholder:"Email address",className:"auth-input",value:s,onChange:w=>a(w.target.value),required:!0}),c.jsx("input",{type:"password",placeholder:"Password",className:"auth-input",value:l,onChange:w=>d(w.target.value),required:!0}),c.jsx("button",{className:"auth-submit",children:e==="login"?"Sign In":"Create Account"})]}),c.jsx("div",{className:"auth-switcher",children:e==="login"?c.jsxs("p",{children:["No account?"," ",c.jsx("button",{onClick:()=>t("register"),children:"Register"})]}):c.jsxs("p",{children:["Already have an account?"," ",c.jsx("button",{onClick:()=>t("login"),children:"Sign in"})]})}),c.jsx("button",{className:"auth-close",onClick:n,children:"Close"})]})})}function pR(){var pe,be,Te,A,N,se;const n="google.com",e="oidc.discord",[t,s]=D.useState(!1),[a,l]=D.useState(!1),[d,f]=D.useState(!1),[m,v]=D.useState(!1),[w,S]=D.useState(""),[C,$]=D.useState(""),[X,q]=D.useState(""),[U,ne]=D.useState({google:!1,discord:!1}),[xe,ge]=D.useState(!1),[ye,ie]=D.useState(!1),Ee=D.useRef(null),{user:k,admin:P,role:R}=jo(),M=Bu();D.useEffect(()=>{var ee;f(!1),v(!1),$(""),q(""),ie(!1),S((k==null?void 0:k.displayName)||((ee=k==null?void 0:k.email)==null?void 0:ee.split("@")[0])||"")},[k]);async function B(){try{await z_(Lr),s(!1),f(!1),M("/")}catch(ee){console.error(ee),alert("Logout failed.")}}const V=()=>{if(!k){s(!1),l(!0);return}f(!1),$(""),q(""),ie(!1),v(!0)},b=async()=>{if(!k){s(!1),l(!0);return}const ee=(w||"").trim();if(!ee){$("Display name is required.");return}ge(!0),$(""),ie(!1);try{await U1(Lr.currentUser,{displayName:ee}),await Ks(Pt(tt,"users",k.uid),{displayName:ee},{merge:!0}),$("Profile updated."),ie(!1)}catch(_e){console.error("Failed to update profile",_e),$("Failed to update profile.")}finally{ge(!1)}},he=ee=>{var _e;return!!((_e=k==null?void 0:k.providerData)!=null&&_e.some(me=>me.providerId===ee))},ve=async()=>{if(!k){s(!1),l(!0);return}if(he(n)){q("Google is already connected.");return}ne(ee=>({...ee,google:!0})),q("");try{const ee=new es,_e=await Cy(Lr.currentUser,ee);await Ks(Pt(tt,"users",k.uid),{connections:{[n]:{email:_e.user.email||"",connectedAt:Uu()}}},{merge:!0}),q("Google connected.")}catch(ee){console.error("Failed to link Google",ee);const _e=(ee==null?void 0:ee.code)==="auth/credential-already-in-use"?"That Google account is already linked elsewhere. Sign in with it instead.":"Could not connect Google.";q(_e)}finally{ne(ee=>({...ee,google:!1}))}},ot=async()=>{if(!k){s(!1),l(!0);return}if(he(e)){q("Discord is already connected.");return}ne(ee=>({...ee,discord:!0})),q("");try{const ee=new Tl(e);ee.addScope("identify"),ee.addScope("email");const me=(await Cy(Lr.currentUser,ee)).user.providerData.find(Ae=>Ae.providerId===e);await Ks(Pt(tt,"users",k.uid),{connections:{[e]:{username:(me==null?void 0:me.displayName)||(me==null?void 0:me.uid)||"Discord",email:(me==null?void 0:me.email)||"",connectedAt:Uu()}}},{merge:!0}),q("Discord connected.")}catch(ee){console.error("Failed to link Discord",ee);const _e=(ee==null?void 0:ee.code)==="auth/credential-already-in-use"?"That Discord account is already linked elsewhere. Sign in with it instead.":"Could not connect Discord.";q(_e)}finally{ne(ee=>({...ee,discord:!1}))}},Ve=async ee=>{if(!k)return;if(k.providerData.length<=1){q("You need at least one sign-in method.");return}const _e=ee===n?"google":"discord";q(""),ne(me=>({...me,[_e]:!0}));try{await j1(Lr.currentUser,ee),await Ks(Pt(tt,"users",k.uid),{connections:{[ee]:uR()}},{merge:!0}),q("Connection removed.")}catch(me){console.error("Failed to unlink",me),q("Could not remove connection.")}finally{ne(me=>({...me,[_e]:!1}))}};return c.jsxs(c.Fragment,{children:[c.jsxs("button",{className:`menu-toggle ${t?"active":""}`,onClick:()=>s(!t),children:[c.jsx("span",{}),c.jsx("span",{}),c.jsx("span",{})]}),c.jsxs("nav",{className:`menu-panel ${t?"open":""}`,onMouseLeave:()=>f(!1),children:[c.jsx(ha,{to:"/",className:"menu-item",onClick:()=>s(!1),children:"Home"}),c.jsx(ha,{to:"/manga",className:"menu-item",onClick:()=>s(!1),children:"Manga"}),c.jsx(ha,{to:"/anime",className:"menu-item",onClick:()=>s(!1),children:"Anime"}),c.jsx(ha,{to:"/tcg",className:"menu-item",onClick:()=>s(!1),children:"TCG"}),c.jsx(ha,{to:"/music",className:"menu-item",onClick:()=>s(!1),children:"Music"}),c.jsx(ha,{to:"/steam",className:"menu-item",onClick:()=>s(!1),children:"Gaming"}),P&&c.jsx(ha,{to:"/dashboard",className:"menu-item",onClick:()=>s(!1),children:"Dashboard"}),c.jsxs("div",{className:"menu-footer",children:[c.jsx("div",{className:"profile-divider"}),c.jsxs("div",{className:"profile-card",onMouseEnter:()=>k&&f(!0),onMouseLeave:()=>f(!1),onClick:()=>{k?f(ee=>!ee):(f(!1),s(!1),l(!0))},role:"button",tabIndex:0,onKeyDown:ee=>{(ee.key==="Enter"||ee.key===" ")&&(ee.preventDefault(),k?f(_e=>!_e):(s(!1),l(!0)))},children:[c.jsx("div",{className:"profile-avatar",children:k?(((pe=k.displayName)==null?void 0:pe[0])||((be=k.email)==null?void 0:be[0])||((Te=k.uid)==null?void 0:Te[0])||"?").toUpperCase():"?"}),c.jsxs("div",{className:"profile-meta",children:[c.jsx("div",{className:"profile-name",children:(k==null?void 0:k.displayName)||(k==null?void 0:k.email)||"Guest"}),c.jsx("div",{className:"profile-role",children:k?P?"admin":R||"viewer":"Not signed in"})]}),k&&d&&c.jsxs("div",{className:"profile-menu",children:[c.jsx("button",{type:"button",className:"profile-menu-item",onClick:V,children:"Edit profile"}),c.jsx("button",{type:"button",className:"profile-menu-item",onClick:B,children:"Sign out"})]})]})]})]}),a&&c.jsx(fR,{onClose:()=>l(!1)}),m&&c.jsx("div",{className:"profile-edit-backdrop",children:c.jsxs("div",{className:"profile-edit-card",children:[c.jsxs("div",{className:"profile-edit-header",children:[c.jsx("h3",{children:"Edit profile"}),c.jsx("button",{type:"button",className:"profile-edit-close",onClick:()=>{v(!1),$(""),q(""),ie(!1)},children:""})]}),c.jsxs("div",{className:"profile-edit-body",children:[c.jsx("div",{className:"profile-edit-avatar",children:k?(((A=k.displayName)==null?void 0:A[0])||((N=k.email)==null?void 0:N[0])||((se=k.uid)==null?void 0:se[0])||"?").toUpperCase():"?"}),c.jsxs("div",{className:"profile-edit-field",children:[c.jsx("label",{className:"profile-edit-label",htmlFor:"displayName",children:"Display name"}),c.jsxs("div",{className:"profile-edit-input-row",children:[c.jsx("input",{id:"displayName",className:"profile-edit-input",type:"text",readOnly:!ye,value:w,onChange:ee=>S(ee.target.value),maxLength:40,placeholder:"Enter display name",ref:Ee,onBlur:()=>{ye&&b()},onKeyDown:ee=>{ee.key==="Enter"&&ye&&(ee.preventDefault(),b())}}),c.jsx("button",{type:"button",className:"profile-edit-pencil",onClick:()=>{ie(!0),$(""),setTimeout(()=>{var ee;return(ee=Ee.current)==null?void 0:ee.focus()},50)},"aria-label":"Edit display name",children:""})]}),c.jsx("div",{className:"profile-edit-hint",children:"Click the pencil to edit. Changes save on blur or Enter."})]})]}),c.jsxs("div",{className:"profile-connections",children:[c.jsxs("div",{className:"profile-connections-header",children:[c.jsx("span",{children:"Connections"}),X&&c.jsx("span",{className:"profile-connection-status",children:X})]}),c.jsxs("div",{className:"profile-connection-row",children:[c.jsxs("div",{className:"profile-connection-meta",children:[c.jsx("div",{className:"profile-connection-title",children:"Google"}),c.jsx("div",{className:"profile-connection-sub",children:he(n)?"Connected":"Not connected"})]}),c.jsx("div",{className:"profile-connection-actions",children:he(n)?c.jsx("button",{type:"button",className:"profile-connection-btn secondary",onClick:()=>Ve(n),disabled:U.google,children:U.google?"Removing...":"Remove"}):c.jsx("button",{type:"button",className:"profile-connection-btn",onClick:ve,disabled:U.google,children:U.google?"Connecting...":"Connect"})})]}),c.jsxs("div",{className:"profile-connection-row",children:[c.jsxs("div",{className:"profile-connection-meta",children:[c.jsx("div",{className:"profile-connection-title",children:"Discord"}),c.jsx("div",{className:"profile-connection-sub",children:he(e)?"Connected":"Not connected"})]}),c.jsx("div",{className:"profile-connection-actions",children:he(e)?c.jsx("button",{type:"button",className:"profile-connection-btn secondary",onClick:()=>Ve(e),disabled:U.discord,children:U.discord?"Removing...":"Remove"}):c.jsx("button",{type:"button",className:"profile-connection-btn",onClick:ot,disabled:U.discord,children:U.discord?"Connecting...":"Connect"})})]})]}),C&&c.jsx("div",{className:"profile-edit-status",children:C}),xe&&c.jsx("div",{className:"profile-edit-status saving",children:"Saving..."})]})})]})}function Av(){const n="Tyler's Collection's and Hobbies",e="",[t,s]=D.useState(""),[a,l]=D.useState(!0),d=D.useRef(null),[f,m]=D.useState("jp"),[v,w]=D.useState(1);return D.useEffect(()=>{document.title="Tyler's Collection"},[]),D.useEffect(()=>(d.current=setInterval(()=>l(S=>!S),450),()=>{d.current&&clearInterval(d.current)}),[]),D.useEffect(()=>{let S=!1;const C=q=>new Promise(U=>setTimeout(U,q)),$=async(q,U=120)=>{for(let ne=1;ne<=q.length;ne+=1){if(S)return;s(q.slice(0,ne)),await C(U)}},X=async(q,U=70)=>{for(let ne=q.length;ne>=0;ne-=1){if(S)return;s(q.slice(0,ne)),await C(U)}};return(async()=>{if(localStorage.getItem("homeTitleTyped")==="1"){m("en"),s(n),l(!1),d.current&&clearInterval(d.current);return}await C(250),m("jp"),await $(e,140),await C(6e3),await X(e,80),await C(320);const U=n;for(let ne=1;ne<=U.length;ne+=1){if(S)return;s(U.slice(0,ne)),ne===4&&m("en"),await C(110)}m("en"),await C(2e3),l(!1),localStorage.setItem("homeTitleTyped","1"),d.current&&clearInterval(d.current)})(),()=>{S=!0}},[]),c.jsxs("main",{className:"page",children:[c.jsxs("header",{style:{textAlign:"center",marginTop:"32px",marginBottom:"24px"},children:[c.jsxs("h1",{style:{margin:0,fontSize:"2.2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",display:"inline-flex",alignItems:"center",gap:"6px"},children:[c.jsx("span",{children:t||" "}),c.jsx("span",{style:{width:"6px",height:"1.1em",background:"#ffb6c1",opacity:a?1:0,transition:"opacity 0.15s ease"}})]}),c.jsx("p",{style:{margin:"6px 0 0",color:"var(--text-soft)",fontSize:"0.95rem",opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"TCG":"This is my personal webpage to see what is on my shelves, wishlists, and TCG collections."}),c.jsx("div",{style:{display:"inline-flex",alignItems:"center",gap:"10px",padding:"8px 14px",borderRadius:"999px",border:"1px solid rgba(255,182,193,0.5)",background:"linear-gradient(135deg, rgba(255,182,193,0.18), rgba(43,15,29,0.9))",boxShadow:"0 8px 24px rgba(0,0,0,0.55)",marginTop:"14px",fontSize:"0.78rem",color:"#ffe6ed",letterSpacing:"0.05em",textTransform:"uppercase",fontWeight:700,opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?c.jsx("span",{style:{letterSpacing:"0.06em"},children:"          TCG"}):c.jsx("span",{style:{letterSpacing:"0.06em"},children:" Manga   Anime   Music   TCG"})})]}),c.jsxs("section",{style:{display:"grid",gridTemplateColumns:"minmax(0, 2fr) minmax(0, 3fr)",gap:"20px",marginTop:"24px"},children:[c.jsxs("article",{className:"card",children:[c.jsx("h2",{style:{marginTop:0,marginBottom:"8px",fontSize:"1.2rem",color:"#ffb6c1"},children:c.jsx("span",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"About Me"})}),c.jsx("p",{style:{margin:0,color:"var(--text-soft)",fontSize:"0.9rem",lineHeight:1.5,opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"im.okTCG":"Hey, I am Tyler and I go by im.ok. I hoard manga, binge anime, and collect trading cards."}),c.jsx("p",{style:{marginTop:"10px",color:"var(--text-soft)",fontSize:"0.9rem",opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"TCG":"This site is where I track everything: volumes on my shelves, finished shows, and my TCG collection as they all slowly grow."}),c.jsxs("div",{style:{marginTop:"12px",display:"flex",flexWrap:"wrap",gap:"6px",opacity:v,transition:"opacity 0.25s ease"},children:[c.jsx("span",{className:"pill",children:f==="jp"?"":"Manga library"}),c.jsx("span",{className:"pill",children:f==="jp"?"":"My Anime List (MAL)"}),c.jsx("span",{className:"pill",children:f==="jp"?" & TCG":"Pokemon & One Piece TCG"}),c.jsx("span",{className:"pill",children:f==="jp"?"":"Data Nerd"})]})]}),c.jsxs("article",{className:"card",children:[c.jsx("h2",{style:{marginTop:0,marginBottom:"8px",fontSize:"1.2rem",color:"#ffb6c1"},children:c.jsx("span",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Explore these pages"})}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(210px, 1fr))",gap:"14px",marginTop:"10px"},children:[c.jsxs("a",{href:"/base/manga",className:"section-card",children:[c.jsx("h3",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Manga Library"}),c.jsx("p",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Full manga collection & wishlist."}),c.jsx("div",{className:"section-chip-row",children:c.jsx("span",{className:"section-chip accent",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Library & wishlist"})})]}),c.jsxs("a",{href:"/base/music",className:"section-card",style:{justifySelf:"end",alignSelf:"end",order:99},children:[c.jsx("h3",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Music"}),c.jsx("p",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"If you are here for my music, this is the page for you! Catch all the latest releases."}),c.jsxs("div",{className:"section-chip-row",children:[c.jsx("span",{className:"section-chip accent",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Latest tracks"}),c.jsx("span",{className:"section-chip",style:{opacity:v,transition:"opacity 0.25s ease"},children:"Spotify & SoundCloud"})]})]}),c.jsxs("a",{href:"/base/anime",className:"section-card",children:[c.jsx("h3",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Anime Library"}),c.jsx("p",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"MAL":"The entire watched, plan to watch, and watching list synced directly from MyAnimeList."}),c.jsxs("div",{className:"section-chip-row",children:[c.jsx("span",{className:"section-chip accent",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"MAL":"MAL synced"}),c.jsx("span",{className:"section-chip",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Status filters"}),c.jsx("span",{className:"section-chip",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Quick stats"})]})]}),c.jsxs("a",{href:"/base/tcg",className:"section-card",children:[c.jsx("h3",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"TCG":"TCG Collection"}),c.jsx("p",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"TCG":"Pokemon & One Piece TCG cards tracked with quantities, prices, and value."}),c.jsxs("div",{className:"section-chip-row",children:[c.jsx("span",{className:"section-chip accent",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Full Collection"}),c.jsx("span",{className:"section-chip",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Still Under-Construction"})]})]})]})]})]}),c.jsx("footer",{style:{marginTop:"28px",fontSize:"0.78rem",color:"var(--text-soft)",textAlign:"center"},children:"@ 2025 im.ok. All rights reserved."})]})}const mR="modulepreload",gR=function(n){return"/base/"+n},kv={},Xl=function(e,t,s){let a=Promise.resolve();if(t&&t.length>0){let d=function(v){return Promise.all(v.map(w=>Promise.resolve(w).then(S=>({status:"fulfilled",value:S}),S=>({status:"rejected",reason:S}))))};document.getElementsByTagName("link");const f=document.querySelector("meta[property=csp-nonce]"),m=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));a=d(t.map(v=>{if(v=gR(v),v in kv)return;kv[v]=!0;const w=v.endsWith(".css"),S=w?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${v}"]${S}`))return;const C=document.createElement("link");if(C.rel=w?"stylesheet":mR,w||(C.as="script"),C.crossOrigin="",C.href=v,m&&C.setAttribute("nonce",m),document.head.appendChild(C),w)return new Promise(($,X)=>{C.addEventListener("load",$),C.addEventListener("error",()=>X(new Error(`Unable to preload CSS for ${v}`)))})}))}function l(d){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=d,window.dispatchEvent(f),!f.defaultPrevented)throw d}return a.then(d=>{for(const f of d||[])f.status==="rejected"&&l(f.reason);return e().catch(l)})};function Dw({open:n,title:e,placeholder:t,value:s,status:a,loading:l,onChange:d,onSubmit:f,onClose:m}){if(!n)return null;const v=typeof a=="string"&&a.toLowerCase().startsWith("sent!")?"#a3f0cf":"#ffb6c1";return c.jsx("div",{className:"suggestion-backdrop",onClick:w=>{w.target===w.currentTarget&&m&&m()},children:c.jsxs("div",{className:"suggestion-modal",children:[c.jsxs("div",{className:"suggestion-modal-header",children:[c.jsx("h3",{children:e}),c.jsx("button",{className:"suggestion-close",type:"button",onClick:m,children:"Close"})]}),c.jsx("p",{className:"suggestion-hint",children:"Tell me what to add next. Titles only is fine, but extra notes are welcome."}),c.jsx("textarea",{className:"suggestion-textarea",placeholder:t,value:s,onChange:w=>d==null?void 0:d(w.target.value),maxLength:500}),a&&c.jsx("div",{className:"suggestion-status",style:{color:v},children:a}),c.jsxs("div",{className:"suggestion-actions",children:[c.jsx("button",{className:"suggestion-send",type:"button",onClick:f,disabled:l,children:l?"Sending...":"Send Suggestion"}),c.jsx("button",{className:"suggestion-cancel",type:"button",onClick:m,children:"Cancel"})]})]})})}const jv=5,yR=3600*1e3,Dv="mangaSuggestionsSent",Vv="mangaViewMode";function fn(n){let e=(n||"").trim();const t=e.match(/^(.*?)(?:,?\s*(?:Vol\.|Volume)\s*(\d+)(?:\s*[--]\s*\d+)?\s*)?(?:\s*\([^)]*\))?$/i),s=t?t[1].trim().toLowerCase():e.toLowerCase(),a=t&&t[2]?parseInt(t[2],10):0;return{name:s,vol:Number.isFinite(a)?a:0}}function vR(n){const t=(n||"").match(/vol(?:ume)?\.?\s*(\d+)(?:\s*[-]\s*(\d+))?/i);if(!t)return[];const s=parseInt(t[1],10),a=t[2]?parseInt(t[2],10):s;if(!Number.isFinite(s))return[];const l=Number.isFinite(a)&&a>=s?a:s,d=[];for(let f=s;f<=l;f+=1)d.push(f);return d}function _R(){const{admin:n,user:e,role:t}=jo(),s=n,[a,l]=D.useState("library"),[d,f]=D.useState(()=>typeof window>"u"?"series":localStorage.getItem(Vv)==="individual"?"individual":"series");D.useEffect(()=>{document.title="Manga | Library"},[]),D.useEffect(()=>{Me("")},[e]),D.useEffect(()=>{try{localStorage.setItem(Vv,d)}catch(E){console.warn("Failed to persist manga view mode",E)}},[d]);const m=async()=>{const E=Date.now(),Y=(()=>{try{const O=localStorage.getItem(Dv);return Array.isArray(JSON.parse(O))?JSON.parse(O):[]}catch{return[]}})().filter(O=>E-O<yR);if(Y.length>=jv){Me("Rate limit: please wait a bit (max 5 suggestions per hour).");return}if(!_e.trim()){Me("Please enter a manga title or note before sending.");return}xt(!0),Me("");try{const O=`**Manga Suggestion**
${_e.trim()}
From: ${(e==null?void 0:e.displayName)||(e==null?void 0:e.email)||(e==null?void 0:e.uid)||"anonymous user"}`;await ma(rr(tt,"suggestions"),{content:_e.trim(),type:"manga",from:(e==null?void 0:e.displayName)||(e==null?void 0:e.email)||(e==null?void 0:e.uid)||"anonymous user",createdAt:new Date().toISOString()}),Me("Sent! I'll review your suggestion soon."),me("");const W=[...Y,E].slice(-jv);localStorage.setItem(Dv,JSON.stringify(W))}catch(O){console.error("Failed to send suggestion",O),Me("Failed to send suggestion. Please try again later.")}finally{xt(!1)}},[v,w]=D.useState([]),[S,C]=D.useState([]),[$,X]=D.useState([]),[q,U]=D.useState([]),[ne,xe]=D.useState(!1),[ge,ye]=D.useState(!0),[ie,Ee]=D.useState(""),[k,P]=D.useState(""),[R,M]=D.useState(""),[B,V]=D.useState(!1),[b,he]=D.useState(()=>new Set);D.useEffect(()=>{d==="series"&&B&&(V(!1),he(new Set))},[d,B]);const[ve,ot]=D.useState({open:!1,mode:"add",list:"library",data:{title:"",authors:"",publisher:"",demographic:"",genre:"",subGenre:"",date:"",cover:"",isbn:"",pageCount:"",rating:"",amountPaid:"",dateRead:"",datePurchased:"",msrp:"",special:!1,specialType:"",specialVolumes:"",collectiblePrice:"",amazonURL:"",read:!1},editingId:null,multiAdd:!1,startVol:"",endVol:""}),[Ve,pe]=D.useState([]),[be,Te]=D.useState(0),[A,N]=D.useState({open:!1,index:0,items:[]}),[se,ee]=D.useState(!1),[_e,me]=D.useState(""),[Ae,Me]=D.useState(""),[Qe,xt]=D.useState(!1),[te,Fe]=D.useState(null),[Be,We]=D.useState(null);D.useEffect(()=>{if(!!te||!!Be||ve.open||A.open||se){const H=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=H}}},[te,Be,ve.open,A.open,se]);const Et=!!e&&t==="viewer";async function wt(){const E=await Gs(rr(tt,"library")),H=[];E.forEach(Y=>{const O=Y.data();H.push({id:Y.id,title:O.title||"",authors:O.authors||"Unknown",publisher:O.publisher||"Unknown",demographic:O.demographic||"",genre:O.genre||"",subGenre:O.subGenre||"",date:O.date||"Unknown",cover:O.cover||"",isbn:O.isbn||"",pageCount:O.pageCount!==void 0&&O.pageCount!==null?O.pageCount:"",rating:O.rating!==void 0&&O.rating!==null?O.rating:"",amountPaid:O.amountPaid!==void 0&&O.amountPaid!==null?O.amountPaid:"",dateRead:O.dateRead||"",datePurchased:O.datePurchased||"",msrp:O.msrp!==void 0&&O.msrp!==null?O.msrp:"",specialType:O.specialType||"",specialVolumes:O.specialVolumes!==void 0&&O.specialVolumes!==null?O.specialVolumes:"",collectiblePrice:O.collectiblePrice!==void 0&&O.collectiblePrice!==null?O.collectiblePrice:"",read:!!O.read,amazonURL:O.amazonURL||"",hidden:!!O.hidden,kind:"library"})}),H.sort((Y,O)=>{const W=fn(Y.title),ce=fn(O.title),Ie=W.name.localeCompare(ce.name);return Ie!==0?Ie:W.vol-ce.vol}),w(H),X(Y=>{const O=new Set(Y);return H.forEach(W=>O.add(W.title||"")),Array.from(O).filter(Boolean).sort()})}async function pt(){const E=await Gs(rr(tt,"wishlist")),H=[];E.forEach(Y=>{const O=Y.data();H.push({id:Y.id,title:O.title||"",authors:O.authors||"Unknown",publisher:O.publisher||"Unknown",date:O.date||"Unknown",cover:O.cover||"",isbn:O.isbn||"",pageCount:O.pageCount!==void 0&&O.pageCount!==null?O.pageCount:"",rating:O.rating!==void 0&&O.rating!==null?O.rating:"",amountPaid:O.amountPaid!==void 0&&O.amountPaid!==null?O.amountPaid:"",specialType:O.specialType||"",specialVolumes:O.specialVolumes!==void 0&&O.specialVolumes!==null?O.specialVolumes:"",collectiblePrice:O.collectiblePrice!==void 0&&O.collectiblePrice!==null?O.collectiblePrice:"",amazonURL:O.amazonURL||"",hidden:!!O.hidden,kind:"wishlist"})}),H.sort((Y,O)=>{const W=fn(Y.title),ce=fn(O.title),Ie=W.name.localeCompare(ce.name);return Ie!==0?Ie:W.vol-ce.vol}),C(H),X(Y=>{const O=new Set(Y);return H.forEach(W=>O.add(W.title||"")),Array.from(O).filter(Boolean).sort()})}D.useEffect(()=>{let E=!1;const H=async()=>{if(!E)try{const W=await fetch("/base/manga-library-wishlist.json",{cache:"no-cache"});if(!W.ok)throw new Error("fallback fetch failed");const ce=await W.json(),Ie=Array.isArray(ce.library)?ce.library:[],Je=Array.isArray(ce.wishlist)?ce.wishlist:[];w(Ie.map((Ce,T)=>({id:Ce.id||`offline-lib-${T}`,title:Ce.title||"",authors:Ce.authors||"Unknown",publisher:Ce.publisher||"Unknown",demographic:Ce.demographic||"",genre:Ce.genre||"",subGenre:Ce.subGenre||"",date:Ce.date||"Unknown",cover:Ce.cover||"",isbn:Ce.isbn||"",pageCount:Ce.pageCount??"",rating:Ce.rating??"",amountPaid:Ce.amountPaid??"",dateRead:Ce.dateRead||"",datePurchased:Ce.datePurchased||"",msrp:Ce.msrp??"",specialType:Ce.specialType||"",specialVolumes:Ce.specialVolumes??"",collectiblePrice:Ce.collectiblePrice??"",amazonURL:Ce.amazonURL||"",read:!!Ce.read,hidden:!!Ce.hidden,kind:"library"}))),C(Je.map((Ce,T)=>({id:Ce.id||`offline-wish-${T}`,title:Ce.title||"",authors:Ce.authors||"Unknown",publisher:Ce.publisher||"Unknown",demographic:Ce.demographic||"",genre:Ce.genre||"",subGenre:Ce.subGenre||"",date:Ce.date||"Unknown",cover:Ce.cover||"",isbn:Ce.isbn||"",pageCount:Ce.pageCount??"",rating:Ce.rating??"",amountPaid:Ce.amountPaid??"",dateRead:Ce.dateRead||"",datePurchased:Ce.datePurchased||"",msrp:Ce.msrp??"",specialType:Ce.specialType||"",specialVolumes:Ce.specialVolumes??"",collectiblePrice:Ce.collectiblePrice??"",amazonURL:Ce.amazonURL||"",read:!!Ce.read,hidden:!!Ce.hidden,kind:"wishlist"}))),Ee("")}catch(O){console.error("Offline fallback failed",O),Ee("Failed to load manga data from Firestore.")}finally{E||ye(!1)}};async function Y(){ye(!0),Ee("");try{await Promise.all([wt(),pt()]),E||ye(!1)}catch(O){console.error(O),E||(console.warn("Falling back to offline JSON for manga."),await H())}}return Y(),()=>{E=!0}},[e]);const Tt=D.useMemo(()=>{const E=k.trim().toLowerCase();return E?v.filter(H=>[H.title,H.authors,H.publisher,H.isbn,H.date,String(H.pageCount??"")].join(" ").toLowerCase().includes(E)):v},[v,k]),Ut=D.useMemo(()=>s&&ne?Tt:Tt.filter(E=>!E.hidden),[Tt,s,ne]),It=D.useMemo(()=>{const E=R.trim().toLowerCase();return E?S.filter(H=>[H.title,H.authors,H.publisher,H.isbn,H.date,String(H.pageCount??"")].join(" ").toLowerCase().includes(E)):S},[S,R]),In=D.useMemo(()=>s&&ne?It:It.filter(E=>!E.hidden),[It,s,ne]),gn=E=>{f(E==="individual"?"individual":"series"),he(new Set),V(!1)};function qn(){s&&(V(E=>!E),he(new Set))}function yn(E){he(H=>{const Y=new Set(H);return Y.has(E)?Y.delete(E):Y.add(E),Y})}async function sr(E){if(!s){alert("Multi-select actions require admin access.");return}const H=Array.from(b);if(!H.length){alert("Select at least one item first.");return}const Y=a==="library";try{if(E==="move")if(Y){if(!window.confirm(`Move ${H.length} item(s) to Wishlist?`))return;for(const O of H){const W=v.find(Ie=>Ie.id===O);if(!W)continue;const ce={title:W.title,authors:W.authors,publisher:W.publisher,date:W.date,pageCount:W.pageCount||"",cover:W.cover,amazonURL:W.amazonURL||"",hidden:!!W.hidden};await ma(rr(tt,"wishlist"),ce),await pa(Pt(tt,"library",O))}}else{if(!window.confirm(`Move ${H.length} item(s) to Library?`))return;for(const O of H){const W=S.find(Ie=>Ie.id===O);if(!W)continue;const ce={title:W.title,authors:W.authors,publisher:W.publisher,date:W.date,pageCount:W.pageCount||"",cover:W.cover,amountPaid:"",read:!1,rating:"",msrp:"",collectiblePrice:"",specialType:"",specialVolumes:"",isbn:"",demographic:"",genre:"",subGenre:"",hidden:!!W.hidden};await ma(rr(tt,"library"),ce),await pa(Pt(tt,"wishlist",O))}}else if(E==="markRead"&&Y)for(const O of H)await Es(Pt(tt,"library",O),{read:!0,dateRead:new Date().toISOString().slice(0,10)});else if(E==="markUnread"&&Y)for(const O of H)await Es(Pt(tt,"library",O),{read:!1,dateRead:"",rating:""});else if(E==="delete"){const O=Y?"library":"wishlist";if(!window.confirm(`Delete ${H.length} item(s) from ${Y?"Library":"Wishlist"}?`))return;for(const W of H)await pa(Pt(tt,O,W))}await Promise.all([wt(),pt()]),he(new Set),V(!1)}catch(O){console.error(O),alert("Failed to apply multi-select action.")}}function Lt(E){Fe(E)}function bt(){Fe(null)}function yr(E){const H=Qn.filter(Y=>(fn(Y.title||"").name||(Y.title||"").toLowerCase()||Y.id)===E.key).sort((Y,O)=>fn(Y.title).vol-fn(O.title).vol);We({series:E,volumes:H})}function ss(){We(null)}const Vn=()=>{ot(E=>({...E,open:!1,mode:"add",editingId:null,data:{title:"",authors:"",publisher:"",demographic:"",genre:"",subGenre:"",date:"",cover:"",isbn:"",pageCount:"",rating:"",amountPaid:"",dateRead:"",datePurchased:"",msrp:"",special:!1,specialType:"",specialVolumes:"",collectiblePrice:"",amazonURL:"",read:!1,hidden:!1},multiAdd:!1,startVol:"",endVol:""})),pe([]),Te(0)},an=D.useMemo(()=>{const E=new Map;return[...v,...S].forEach(H=>{const Y=fn(H.title||"");if(!Y.name)return;const O=(H.title||"").replace(/,?\s*Vol\.?\s*\d+.*/i,"").trim()||H.title||Y.name;if(!E.has(Y.name))E.set(Y.name,{display:O,maxVol:Y.vol,authors:H.authors||"",publisher:H.publisher||"",demographic:H.demographic||""});else{const W=E.get(Y.name);W.maxVol=Math.max(W.maxVol,Y.vol),!W.authors&&H.authors&&(W.authors=H.authors),!W.publisher&&H.publisher&&(W.publisher=H.publisher),!W.demographic&&H.demographic&&(W.demographic=H.demographic)}}),E},[v,S]),ir=E=>{ot(H=>({...H,open:!0,mode:"add",list:E,editingId:null,data:{...H.data,title:"",list:E}})),pe([{kind:"new",id:null,data:{title:"",authors:"",publisher:"",demographic:"",genre:"",subGenre:"",date:"",cover:"",isbn:"",pageCount:"",rating:"",amountPaid:"",dateRead:"",datePurchased:"",msrp:"",specialType:"",specialVolumes:"",collectiblePrice:"",amazonURL:"",read:!1}}]),Te(0)},is=E=>{const H={open:!0,mode:"edit",list:E.kind==="wishlist"?"wishlist":"library",editingId:E.id,data:{title:E.title||"",authors:E.authors||"",publisher:E.publisher||"",demographic:E.demographic||"",genre:E.genre||"",subGenre:E.subGenre||"",date:E.date||"",cover:E.cover||"",isbn:E.isbn||"",pageCount:E.pageCount||"",rating:E.rating||"",amountPaid:E.amountPaid||"",dateRead:E.dateRead||"",datePurchased:E.datePurchased||"",msrp:E.msrp||"",special:!!(E.specialType||E.specialVolumes||E.collectiblePrice),specialType:E.specialType||"",specialVolumes:E.specialVolumes||"",collectiblePrice:E.collectiblePrice||"",amazonURL:E.amazonURL||"",read:!!E.read,hidden:!!E.hidden}};ot(H),pe([{kind:"edit",id:E.id,data:{...H.data}}]),Te(0)},mt=(E,H,Y="text")=>{if(ot(O=>{const W={...O.data,[E]:Y==="checkbox"?!!H:H};if(E==="special"&&!H&&(W.specialType="",W.specialVolumes="",W.collectiblePrice=""),E==="specialType"&&(H==="collectible"?W.specialVolumes="":(H==="specialEdition"||(W.specialVolumes=""),W.collectiblePrice="")),E==="title"){const ce=fn(H||"");if(ce.name&&an.has(ce.name)){const Ie=an.get(ce.name);W.authors=Ie.authors||W.authors,W.publisher=Ie.publisher||W.publisher,W.demographic=Ie.demographic||W.demographic}}return{...O,data:W}}),pe(O=>{if(!O.length)return O;const W=[...O],ce={...W[be]};return ce.data={...ce.data,[E]:Y==="checkbox"?!!H:H},W[be]=ce,W}),E==="title"){const O=String(H||"").trim().toLowerCase();if(!O)U([]);else{const W=[];an.forEach(ce=>{if(ce.display.toLowerCase().includes(O)){const Ie=ce.maxVol>0?ce.maxVol+1:1;W.push(`${ce.display}, Vol. ${Ie}`)}}),U(W.slice(0,6))}}},as=E=>{Ve[E]&&(Te(E),ot(H=>{const Y=Ve[E];return{...H,data:{...Y.data}}}))},As=()=>{const E=ve.data.title||"",H=fn(E);if(!H.name){alert("Provide a title with a volume number first (e.g., Series, Vol. 1).");return}const Y=E.replace(/,?\s*Vol\.?\s*\d+.*/i,"").trim()||E;let O=H.vol||0;const W=an.get(H.name);W&&W.maxVol>O&&(O=W.maxVol),Ve.forEach(Ce=>{const T=fn(Ce.data.title||"");T.name===H.name&&(O=Math.max(O,T.vol||0))});const ce=(O||0)+1,Je={title:`${Y}, Vol. ${ce}`,authors:ve.data.authors,publisher:ve.data.publisher,demographic:ve.data.demographic,genre:ve.data.genre,subGenre:ve.data.subGenre,msrp:ve.data.msrp,hidden:ve.data.hidden,cover:"",isbn:"",pageCount:"",rating:"",amountPaid:"",date:"",dateRead:"",datePurchased:"",special:!1,specialType:"",specialVolumes:"",collectiblePrice:"",amazonURL:"",read:!1};pe(Ce=>{const T=[...Ce,{kind:"new",id:null,data:Je}];return Te(T.length-1),T}),ot(Ce=>({...Ce,mode:"add",data:Je}))};async function ri(){if(!s)return;const{list:E}=ve,H=E||"library",Y=Ve.length>0?Ve:[{kind:ve.mode,id:ve.editingId,data:ve.data}],O=W=>({title:(W.title||"").trim(),authors:(W.authors||"").trim(),publisher:(W.publisher||"").trim(),demographic:(W.demographic||"").trim(),genre:(W.genre||"").trim(),subGenre:(W.subGenre||"").trim(),date:(W.date||"").trim(),cover:(W.cover||"").trim(),isbn:H==="wishlist"?"":(W.isbn||"").trim(),pageCount:W.pageCount===""?"":Number(W.pageCount),rating:H==="wishlist"||W.rating===""?"":Math.max(.5,Math.min(5,Number(W.rating))),amountPaid:W.amountPaid===""?"":Number(W.amountPaid),dateRead:(W.dateRead||"").trim(),datePurchased:(W.datePurchased||"").trim(),msrp:H==="wishlist"||W.msrp===""?"":Number(W.msrp),special:H==="wishlist"?!1:!!(W.special&&(W.specialType||"").trim()),specialType:H==="wishlist"||!(W.special&&(W.specialType||"").trim())?"":(W.specialType||"").trim(),specialVolumes:H==="wishlist"?"":W.special&&W.specialType==="specialEdition"?W.specialVolumes===""?"":Number(W.specialVolumes):"",collectiblePrice:H==="wishlist"?"":W.special&&W.specialType==="collectible"?W.collectiblePrice===""?"":Number(W.collectiblePrice):"",amazonURL:(W.amazonURL||"").trim(),read:H==="wishlist"?!1:!!W.read,hidden:!!W.hidden,kind:E});try{const W=[];for(const ce of Y){const Ie=O(ce.data);if(H==="library"&&ce.kind!=="edit"){const Je=fn(Ie.title).name,Ce=v.filter(L=>fn(L.title||L.Title||"").name===Je),T=Ce[0];if(T&&(Ie.demographic=Ie.demographic||T.demographic||T.Demographic||"",Ie.genre=Ie.genre||T.genre||T.Genre||"",Ie.subGenre=Ie.subGenre||T.subGenre||T.SubGenre||"",Ie.msrp==="")){const L=Ce.map(F=>Number(F.msrp??F.MSRP)).filter(F=>Number.isFinite(F));L.length>0&&L.every(oe=>oe===L[0])&&(Ie.msrp=L[0])}}if(!Ie.title){alert("Title is required for every entry.");return}ce.kind==="edit"&&ce.id?W.push(Es(Pt(tt,H,ce.id),Ie)):W.push(ma(rr(tt,H),Ie))}await Promise.all(W),await Promise.all([wt(),pt()]),Vn()}catch(W){console.error(W),alert("Failed to save entry.")}}async function on(E,H){if(s&&window.confirm("Delete this entry?"))try{await pa(Pt(tt,H,E)),await Promise.all([wt(),pt()])}catch(Y){console.error(Y),alert("Failed to delete entry.")}}const[Cn,ar]=D.useState(!1),Yt=()=>N({open:!1,index:0,items:[]});async function Ht(E,H){if(!(E!=null&&E.id))return;const Y=E.kind==="wishlist"?"wishlist":"library";ar(!0);try{await Es(Pt(tt,Y,E.id),H),await Promise.all([wt(),pt()]),Fe(O=>O&&O.id===E.id?{...O,...H}:O)}catch(O){console.error(O),alert("Failed to update entry.")}finally{ar(!1)}}const ln=(E,H)=>{const Y=H===""?"":Math.max(.5,Math.min(5,Number(H)));Ht(E,{rating:Y})},vn=(E,H)=>{if(!E)return;const Y=H?{read:!0,dateRead:new Date().toISOString().slice(0,10)}:{read:!1,dateRead:""};Ht(E,Y)},os=()=>{if(!b.size){alert("Select at least one entry first.");return}const H=[...v,...S].filter(O=>b.has(O.id));if(!H.length){alert("No items selected.");return}const Y=H.map(O=>({id:O.id,kind:O.kind||(a==="wishlist"?"wishlist":"library"),data:{title:O.title||"",authors:O.authors||"",publisher:O.publisher||"",demographic:O.demographic||"",genre:O.genre||"",subGenre:O.subGenre||"",date:O.date||"",cover:O.cover||"",isbn:O.isbn||"",pageCount:O.pageCount||"",rating:O.rating||"",amountPaid:O.amountPaid||"",dateRead:O.dateRead||"",datePurchased:O.datePurchased||"",msrp:O.msrp||"",special:!!(O.specialType||O.specialVolumes||O.collectiblePrice),specialType:O.specialType||"",specialVolumes:O.specialVolumes||"",collectiblePrice:O.collectiblePrice||"",amazonURL:O.amazonURL||"",read:!!O.read,hidden:!!O.hidden}}));N({open:!0,index:0,items:Y})},yt=(E,H,Y="text")=>{N(O=>{const W=[...O.items],ce={...W[O.index]},Ie={...ce.data,[E]:Y==="checkbox"?!!H:H};return E==="special"&&!H&&(Ie.specialType="",Ie.specialVolumes="",Ie.collectiblePrice=""),E==="specialType"&&(H==="collectible"?Ie.specialVolumes="":(H==="specialEdition"||(Ie.specialVolumes=""),Ie.collectiblePrice="")),ce.data=Ie,W[O.index]=ce,{...O,items:W}})},ls=()=>{N(E=>({...E,index:Math.min(E.index+1,E.items.length-1)}))},Kn=()=>{N(E=>({...E,index:Math.max(E.index-1,0)}))};async function Ln(){if(!s)return;const E=A.items;if(!E.length){Yt();return}try{const H=E.map(Y=>{const W=!(Y.kind==="wishlist")&&!!(Y.data.special&&(Y.data.specialType||"").trim()),ce={...Y.data,pageCount:Y.data.pageCount===""?"":Number(Y.data.pageCount),rating:Y.data.rating===""?"":Math.max(.5,Math.min(5,Number(Y.data.rating))),amountPaid:Y.data.amountPaid===""?"":Number(Y.data.amountPaid),msrp:Y.data.msrp===""?"":Number(Y.data.msrp),special:W,specialType:W?Y.data.specialType:"",collectiblePrice:W&&Y.data.specialType==="collectible"?Y.data.collectiblePrice===""?"":Number(Y.data.collectiblePrice):"",specialVolumes:W&&Y.data.specialType==="specialEdition"?Y.data.specialVolumes===""?"":Number(Y.data.specialVolumes):"",amazonURL:Y.data.amazonURL||"",read:!!Y.data.read},Ie=Y.kind==="wishlist"?"wishlist":"library";return Es(Pt(tt,Ie,Y.id),ce)});await Promise.all(H),await Promise.all([wt(),pt()]),he(new Set),V(!1),Yt()}catch(H){console.error(H),alert("Failed to save bulk edits.")}}const Rt=E=>{const H=new Map;return E.forEach(Y=>{const O=fn(Y.title||""),W=O.name||(Y.title||"").toLowerCase()||Y.id,ce=an.get(O.name)||null,Ie=(ce==null?void 0:ce.display)||(Y.title||"").replace(/,?\s*Vol\.?\s*\d+.*/i,"").trim()||Y.title||"Untitled",Je=vR(Y.title||""),Ce=Number.isFinite(O.vol)?O.vol:0,T=Je.length>0?Je:Ce>0?[Ce]:[],L=T.length?T[0]:0;if(!H.has(W))H.set(W,{id:`series-${W}`,key:W,title:Ie,authors:Y.authors&&Y.authors!=="Unknown"?Y.authors:(ce==null?void 0:ce.authors)||"",publisher:Y.publisher&&Y.publisher!=="Unknown"?Y.publisher:(ce==null?void 0:ce.publisher)||"",demographic:(ce==null?void 0:ce.demographic)||Y.demographic||"",cover:Y.cover||"",count:1,readCount:Y.read?1:0,minVol:L,maxVol:L,representative:Y,volumes:[...T]});else{const F=H.get(W);if(F.count+=1,Y.read&&(F.readCount+=1),T.length){const oe=Math.min(...T),Pe=Math.max(...T);F.minVol=Math.min(F.minVol,oe),F.maxVol=Math.max(F.maxVol,Pe),F.volumes.push(...T)}!F.cover&&Y.cover&&(F.cover=Y.cover),!F.authors&&Y.authors&&Y.authors!=="Unknown"&&(F.authors=Y.authors),!F.publisher&&Y.publisher&&Y.publisher!=="Unknown"&&(F.publisher=Y.publisher)}}),Array.from(H.values())},Jt=E=>{const H=Array.from(new Set((E||[]).filter(Ie=>Number.isFinite(Ie)&&Ie>0))).sort((Ie,Je)=>Ie-Je);if(!H.length)return null;const Y=[];let O=H[0],W=H[0];for(let Ie=1;Ie<H.length;Ie+=1){const Je=H[Ie];if(Je===W+1){W=Je;continue}Y.push([O,W]),O=Je,W=Je}if(Y.push([O,W]),Y.length===1){const[Ie,Je]=Y[0];return Ie===Je?`Vol. ${Ie}`:`Vol. ${Ie}-${Je}`}return`Vols. ${Y.map(([Ie,Je])=>Ie===Je?`${Ie}`:`${Ie}-${Je}`).join(", ")}`};function On(E){const H=b.has(E.id),Y=E.kind==="library",O=()=>{B&&s?yn(E.id):Lt(E)};return c.jsxs("div",{className:"manga-card"+(E.read&&Y?" read":"")+(H?" multiselect-selected":""),onClick:O,children:[c.jsx("div",{className:"manga-card-cover-wrap",children:c.jsx("img",{src:E.cover||"https://imgur.com/chUgq4W.png",alt:"Cover",loading:"lazy",decoding:"async"})}),c.jsxs("div",{className:"manga-card-body",children:[c.jsx("div",{className:"manga-card-title",children:E.title||"Untitled"}),c.jsxs("div",{className:"manga-card-meta",children:[E.authors&&E.authors!=="Unknown"&&c.jsxs(c.Fragment,{children:[E.authors,c.jsx("br",{})]}),E.publisher&&E.publisher!=="Unknown"&&c.jsxs(c.Fragment,{children:[E.publisher,c.jsx("br",{})]}),E.date&&E.date!=="Unknown"&&E.date]}),E.isbn&&c.jsxs("div",{className:"manga-card-isbn",children:["ISBN: ",E.isbn]}),s&&c.jsxs("div",{className:"manga-card-actions",children:[c.jsx("button",{type:"button",className:"manga-btn mini",onClick:W=>{W.stopPropagation(),is(E)},children:"Edit"}),c.jsx("button",{type:"button",className:"manga-btn mini danger",onClick:W=>{W.stopPropagation(),on(E.id,E.kind==="wishlist"?"wishlist":"library")},children:"Delete"})]})]})]},E.id)}function vr(E){var ce;const H=Jt(E.volumes),Y=`${E.count} volume${E.count===1?"":"s"}`;E.readCount>=E.count&&E.count>0||`${E.readCount}${E.count}`;const O=E.readCount>=E.count&&E.count>0,W=[E.authors&&E.authors!=="Unknown"?E.authors:null,E.publisher&&E.publisher!=="Unknown"?E.publisher:null,H?`${Y} - ${H}`:Y].filter(Boolean);return c.jsxs("div",{className:"manga-card series-view"+(O?" read":""),onClick:()=>yr(E),children:[c.jsx("div",{className:"manga-card-cover-wrap",children:c.jsx("img",{src:E.cover||((ce=E.representative)==null?void 0:ce.cover)||"https://imgur.com/chUgq4W.png",alt:"Cover",loading:"lazy",decoding:"async"})}),c.jsxs("div",{className:"manga-card-body",children:[c.jsx("div",{className:"manga-card-title",children:E.title||"Untitled Series"}),c.jsx("div",{className:"manga-card-meta",children:W.map((Ie,Je)=>c.jsxs(jf.Fragment,{children:[Ie,c.jsx("br",{})]},Ie+Je))}),c.jsx("div",{className:"manga-card-series-count",children:Y})]})]},E.id)}const _n=({value:E,onChange:H})=>{const[Y,O]=D.useState(null),W=Math.max(0,Math.min(5,Number(E)||0)),ce=Y??W,Ie=Array.from({length:10},(T,L)=>(L+1)*.5),Je=5,Ce=Array.from({length:Je},(T,L)=>Math.max(0,Math.min(1,ce-L)));return c.jsxs("div",{className:"star-shell",role:"group","aria-label":"Rating",children:[c.jsxs("div",{className:"star-visual",style:{"--star-count":Je},children:[c.jsx("div",{className:"star-row",children:Ce.map((T,L)=>c.jsxs("div",{className:"star-icon",children:[c.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",className:"star-base",children:c.jsx("path",{d:"M12 2.5l2.9 5.88 6.5.95-4.7 4.58 1.1 6.43L12 17.9l-5.8 3.44 1.1-6.43-4.7-4.58 6.5-.95L12 2.5z"})}),c.jsx("div",{className:"star-fill",style:{"--pct":`${(Math.max(0,Math.min(1,T))*100).toFixed(1)}%`},children:c.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:c.jsx("path",{d:"M12 2.5l2.9 5.88 6.5.95-4.7 4.58 1.1 6.43L12 17.9l-5.8 3.44 1.1-6.43-4.7-4.58 6.5-.95L12 2.5z"})})})]},L))}),c.jsx("div",{className:"star-hit",children:Ie.map(T=>c.jsx("button",{type:"button","aria-label":`${T} stars`,onMouseEnter:()=>O(T),onMouseLeave:()=>O(null),onClick:()=>H(T)},T))})]}),c.jsx("div",{className:"star-value",children:ce?ce.toFixed(1):"--"}),c.jsx("button",{type:"button",className:"star-clear",onClick:()=>H(""),"aria-label":"Clear rating",children:"clear"})]})},Qn=a==="library"?Ut:In,bn=a==="library"?v:S,Cr=D.useMemo(()=>Rt(Qn),[Qn,an]),Qi=D.useMemo(()=>Rt(bn),[bn,an]),Fr=d==="series"?Cr:Qn;d==="series"?Cr.length:Qn.length,d==="series"?Qi.length:bn.length;const cs=(E,H)=>{if(!E.length)return;const Y=Array.from(E.reduce((Ce,T)=>(Object.keys(T).forEach(L=>Ce.add(L)),Ce),new Set)),O=Ce=>{const T=Ce==null?"":String(Ce);return/[",\n]/.test(T)?`"${T.replace(/"/g,'""')}"`:T},W=[Y.join(",")].concat(E.map(Ce=>Y.map(T=>O(Ce[T])).join(","))),ce=new Blob([W.join(`
`)],{type:"text/csv"}),Ie=URL.createObjectURL(ce),Je=document.createElement("a");Je.href=Ie,Je.download=H,Je.click(),URL.revokeObjectURL(Ie)},Yn=async(E,H)=>{const Y=(W,ce="image")=>(W||"").toString().toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"").slice(0,100)||ce,O=E.filter(W=>W.cover).map((W,ce)=>({url:W.cover,name:Y(W.title||`manga-${ce+1}`,`manga-${ce+1}`)}));if(!O.length){alert("No images found to download.");return}try{const W=(await Xl(async()=>{const{default:oe}=await import("https://cdn.jsdelivr.net/npm/jszip@3.10.1/+esm");return{default:oe}},[])).default,ce=new W,Ie=ce.folder("images"),Je={},Ce=O.map(async(oe,Pe)=>{try{const Re=await(await fetch(oe.url)).blob(),Ze=(oe.url.split(".").pop()||"jpg").split(/[?#]/)[0],ct=oe.name||`image-${Pe+1}`;Je[ct]=(Je[ct]||0)+1;const vt=Je[ct]>1?`-${Je[ct]}`:"";Ie.file(`${ct}${vt}.${Ze}`,Re)}catch(ze){console.warn("Failed to fetch image",oe.url,ze)}});await Promise.all(Ce);const T=await ce.generateAsync({type:"blob"}),L=URL.createObjectURL(T),F=document.createElement("a");F.href=L,F.download=H,F.click(),URL.revokeObjectURL(L)}catch(W){console.error("Zip download failed",W),alert("Failed to create zip. Please try again.")}},Ur=(E,H)=>{const Y=new Blob([JSON.stringify(E,null,2)],{type:"application/json"}),O=URL.createObjectURL(Y),W=document.createElement("a");W.href=O,W.download=H,W.click(),URL.revokeObjectURL(O)},Jn=E=>({title:E.title||"",authors:E.authors||"",publisher:E.publisher||"",demographic:E.demographic||"",genre:E.genre||"",subGenre:E.subGenre||"",date:E.date||"",pageCount:E.pageCount??"",cover:E.cover||"",amountPaid:E.amountPaid??"",read:!!E.read,rating:E.rating??"",dateRead:E.dateRead||"",datePurchased:E.datePurchased||"",msrp:E.msrp??"",collectiblePrice:E.collectiblePrice??"",specialType:E.specialType||"",specialVolumes:E.specialVolumes??"",isbn:E.isbn||"",amazonURL:E.amazonURL||"",hidden:!!E.hidden}),si=E=>{const Y=fn(E.title||"").name;if(!Y)return"";const W=[...v,...S].find(ce=>{const Je=fn(ce.title||"").name===Y,Ce=ce.msrp!==void 0&&ce.msrp!==null&&ce.msrp!=="";return Je&&Ce});return W?W.msrp:""},ks=E=>{const Y=fn(E.title||"").name;if(!Y)return{demographic:"",genre:"",subGenre:""};const W=[...v,...S].find(ce=>fn(ce.title||"").name===Y&&(ce.demographic||ce.genre||ce.subGenre));return{demographic:(W==null?void 0:W.demographic)||"",genre:(W==null?void 0:W.genre)||"",subGenre:(W==null?void 0:W.subGenre)||""}},zr=async E=>{if(!s||!(E!=null&&E.id))return;const H=E.kind==="wishlist"?"wishlist":"library",Y=H==="library"?"wishlist":"library";try{const O=Jn(E);if(Y==="library"){const W=si(E);(O.msrp===""||O.msrp===null||O.msrp===void 0)&&(O.msrp=W);const ce=ks(E);O.demographic||(O.demographic=ce.demographic),O.genre||(O.genre=ce.genre),O.subGenre||(O.subGenre=ce.subGenre)}await ma(rr(tt,Y),O),await pa(Pt(tt,H,E.id)),await Promise.all([wt(),pt()]),We(W=>W&&{...W,volumes:W.volumes.filter(ce=>ce.id!==E.id)}),bt()}catch(O){console.error("Move failed",O),alert("Failed to move item.")}},lt=ve.list==="wishlist",Xn=A.items[A.index]||null,Xt=(Xn==null?void 0:Xn.kind)==="wishlist";return c.jsxs("div",{className:"manga-page",children:[c.jsxs("header",{className:"manga-header",style:{flexDirection:"column",alignItems:"center",textAlign:"center"},children:[c.jsx("div",{className:"manga-header-title",style:{justifyContent:"center",gap:"0.6rem",fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Tyler's Manga Library"}),c.jsx("div",{className:"manga-header-sub",style:{textAlign:"center"},children:"This is my Manga Library and Wishlist. Check and see all the Manga I have in my possession!"})]}),Et&&c.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"6px"},children:c.jsx("button",{className:"suggestion-trigger",type:"button",onClick:()=>{Me(""),ee(!0)},children:"+ Suggestion"})}),c.jsxs("div",{className:"manga-tabs",children:[c.jsx("button",{className:"manga-tab-btn"+(a==="library"?" active":""),onClick:()=>{l("library"),V(!1),he(new Set)},children:"Library"}),c.jsx("button",{className:"manga-tab-btn"+(a==="wishlist"?" active":""),onClick:()=>{l("wishlist"),V(!1),he(new Set)},children:"Wishlist"})]}),a!=="dashboard"&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"manga-toolbar",children:[c.jsxs("div",{className:"manga-toolbar-left",children:[c.jsx("input",{type:"text",className:"manga-search-input",placeholder:a==="library"?"Search library by title, author, ISBN...":"Search wishlist...",value:a==="library"?k:R,onChange:E=>a==="library"?P(E.target.value):M(E.target.value)}),c.jsx("div",{className:"manga-counter",children:(()=>{const E=a==="library",H=(E?k:R).trim(),Y=E?v.length:S.length,O=E?Tt.length:It.length;return H?`${O} / ${Y} Volumes`:`${Y} Volumes`})()})]}),c.jsxs("div",{className:"manga-toolbar-right",children:[c.jsxs("div",{className:"manga-view-toggle",children:[c.jsx("button",{className:"manga-btn secondary"+(d==="series"?" active":""),type:"button","aria-pressed":d==="series","aria-label":"Series view",title:"Series View",onClick:()=>gn("series"),children:""}),c.jsx("button",{className:"manga-btn secondary"+(d==="individual"?" active":""),type:"button","aria-pressed":d==="individual","aria-label":"Volume view",title:"Volume View",onClick:()=>gn("individual"),children:""})]}),s&&c.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>xe(E=>!E),children:ne?"Hide Hidden":"Show Hidden"}),s&&c.jsx("button",{className:"manga-btn secondary"+(B?" active":""),disabled:d==="series",onClick:qn,children:B?"Exit Multi-select":"Multi-select"})]})]}),s&&B&&d==="individual"&&c.jsxs("div",{className:"manga-multiselect-bar",children:[c.jsxs("span",{children:["Selected: ",c.jsx("strong",{children:b.size})]}),c.jsx("button",{className:"manga-btn",onClick:os,children:"Bulk Edit"}),c.jsxs("button",{className:"manga-btn secondary",onClick:()=>sr("move"),children:["Move to ",a==="library"?"Wishlist":"Library"]}),a==="library"&&c.jsxs(c.Fragment,{children:[c.jsx("button",{className:"manga-btn",onClick:()=>sr("markRead"),children:"Mark Read"}),c.jsx("button",{className:"manga-btn secondary",onClick:()=>sr("markUnread"),children:"Mark Unread"})]}),c.jsx("button",{className:"manga-btn danger",onClick:()=>sr("delete"),children:"Delete"})]})]}),ge?c.jsx("div",{className:"manga-empty-state",children:"Loading manga from Firestore..."}):ie?c.jsx("div",{className:"manga-empty-state",children:ie}):Fr.length===0?c.jsx("div",{className:"manga-empty-state",children:"No manga found. Try changing your search."}):c.jsx("div",{className:"manga-grid",children:Fr.map(E=>d==="series"?vr(E):On(E))}),Be&&c.jsx("div",{className:"manga-modal-backdrop visible",onClick:E=>{E.target===E.currentTarget&&ss()},children:c.jsx("div",{className:"manga-modal series",children:c.jsxs("div",{className:"manga-modal-body",children:[c.jsxs("div",{className:"manga-modal-header",children:[c.jsx("div",{className:"manga-modal-title",children:Be.series.title||"Series"}),c.jsx("button",{className:"manga-modal-close",onClick:ss,type:"button",children:"Close"})]}),c.jsxs("div",{className:"manga-modal-subtitle",children:[Be.series.count," volume",Be.series.count===1?"":"s"," in this series"]}),c.jsx("div",{className:"manga-series-modal-grid",children:Be.volumes.map(E=>c.jsxs("div",{className:"manga-card mini-card"+(E.read?" read":""),onClick:()=>{Lt(E)},children:[c.jsx("div",{className:"manga-card-cover-wrap",children:c.jsx("img",{src:E.cover||"https://imgur.com/chUgq4W.png",alt:E.title||"Cover",loading:"lazy",decoding:"async"})}),c.jsxs("div",{className:"manga-card-body",children:[c.jsx("div",{className:"manga-card-title",children:E.title||"Untitled"}),c.jsxs("div",{className:"manga-card-meta",children:[E.authors&&E.authors!=="Unknown"&&c.jsxs(c.Fragment,{children:[E.authors,c.jsx("br",{})]}),E.publisher&&E.publisher!=="Unknown"&&c.jsxs(c.Fragment,{children:[E.publisher,c.jsx("br",{})]}),E.date&&E.date!=="Unknown"&&E.date]})]})]},E.id))})]})})}),s&&c.jsxs("div",{className:"manga-floating-actions",children:[c.jsxs("button",{className:"manga-btn",type:"button","aria-label":"Add item",onClick:()=>ir(a==="wishlist"?"wishlist":"library"),children:["+ ",a==="wishlist"?"Wishlist":"Library"]}),c.jsxs("div",{className:"manga-export-actions",children:[n&&c.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>Ur({library:v,wishlist:S},"manga-library-wishlist.json"),children:"Export JSON"}),c.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>cs(a==="library"?v:S,a==="library"?"manga-library.csv":"manga-wishlist.csv"),children:"Export CSV"}),c.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>Yn(a==="library"?v:S,a==="library"?"manga-library-images.zip":"manga-wishlist-images.zip"),children:"Download Images"})]})]}),te&&c.jsx("div",{className:"manga-modal-backdrop visible",onClick:E=>{E.target===E.currentTarget&&bt()},children:c.jsxs("div",{className:"manga-modal",children:[c.jsxs("div",{className:"manga-modal-cover-wrap",children:[te.kind==="library"&&te.read&&c.jsx("div",{className:"manga-modal-read-pill",children:"Read"}),c.jsx("img",{src:te.cover||"https://imgur.com/chUgq4W.png",alt:"Cover"})]}),c.jsxs("div",{className:"manga-modal-body",children:[c.jsxs("div",{className:"manga-modal-header",children:[c.jsx("div",{className:"manga-modal-title",children:te.title||"Untitled"}),c.jsx("button",{className:"manga-modal-close",onClick:bt,type:"button",children:"Close"})]}),c.jsxs("div",{className:"manga-modal-meta",children:[te.authors&&te.authors!=="Unknown"&&c.jsxs(c.Fragment,{children:[c.jsx("strong",{children:"Author(s):"})," ",te.authors,c.jsx("br",{})]}),te.publisher&&te.publisher!=="Unknown"&&c.jsxs(c.Fragment,{children:[c.jsx("strong",{children:"Publisher:"})," ",te.publisher,c.jsx("br",{})]}),te.date&&c.jsxs(c.Fragment,{children:[c.jsx("strong",{children:"Release:"})," ",te.date,c.jsx("br",{})]}),te.isbn&&c.jsxs(c.Fragment,{children:[c.jsx("strong",{children:"ISBN:"})," ",te.isbn,c.jsx("br",{})]})]}),c.jsxs("div",{className:"manga-modal-details",children:[te.pageCount&&c.jsxs(c.Fragment,{children:[c.jsx("strong",{children:"Pages:"})," ",te.pageCount,c.jsx("br",{})]}),c.jsxs("div",{style:{margin:"6px 0"},children:[c.jsx("strong",{children:"Rating:"})," ",c.jsx(_n,{value:te.rating||"",onChange:E=>ln(te,E)})]}),te.amountPaid&&c.jsxs(c.Fragment,{children:[c.jsx("strong",{children:"Amount Paid:"})," $",te.amountPaid,c.jsx("br",{})]}),te.msrp&&c.jsxs(c.Fragment,{children:[c.jsx("strong",{children:"MSRP:"})," $",te.msrp,c.jsx("br",{})]}),te.collectiblePrice&&c.jsxs(c.Fragment,{children:[c.jsx("strong",{children:"Collectible:"})," $",te.collectiblePrice,c.jsx("br",{})]}),te.read&&te.dateRead&&c.jsxs(c.Fragment,{children:[c.jsx("strong",{children:"Date Read:"})," ",te.dateRead,c.jsx("br",{})]}),te.amazonURL&&c.jsx("div",{style:{marginTop:"6px"},children:c.jsx("a",{href:te.amazonURL,target:"_blank",rel:"noreferrer",children:"View on Amazon"})})]}),c.jsxs("div",{className:"manga-modal-footer",style:{gap:"10px",alignItems:"center"},children:[c.jsx("div",{children:te.kind==="library"&&te.read?"Marked as read in your library.":te.kind==="library"?"In your library (unread).":"Wishlist item - not in library yet."}),c.jsxs("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:[s&&c.jsx("button",{className:"manga-btn mini secondary",type:"button",onClick:()=>is(te),children:"Edit"}),te.kind==="library"&&c.jsx(c.Fragment,{children:te.read?c.jsx("button",{className:"manga-btn mini secondary",disabled:Cn,onClick:()=>vn(te,!1),type:"button",children:"Mark as unread"}):c.jsx("button",{className:"manga-btn mini",disabled:Cn,onClick:()=>vn(te,!0),type:"button",children:"Mark as read"})}),s&&c.jsxs("button",{className:"manga-btn mini",type:"button",onClick:()=>zr(te),children:["Move to ",te.kind==="library"?"Wishlist":"Library"]})]})]})]})]})}),s&&ve.open&&c.jsx("div",{className:"manga-modal-backdrop visible",onClick:E=>{E.target===E.currentTarget&&Vn()},children:c.jsx("div",{className:"manga-modal admin",children:c.jsxs("div",{className:"manga-modal-body",children:[c.jsxs("div",{className:"manga-modal-header",children:[c.jsx("div",{className:"manga-modal-title",children:ve.mode==="add"?"Add Entry":"Edit Entry"}),c.jsx("button",{className:"manga-modal-close",onClick:Vn,type:"button",children:"Close"})]}),c.jsxs("div",{className:"admin-form-layout",children:[c.jsx("div",{className:"admin-cover-frame",children:c.jsx("img",{src:ve.data.cover||"https://imgur.com/chUgq4W.png",alt:"Cover preview"})}),c.jsxs("div",{className:"admin-form-fields",children:[c.jsx("div",{className:"admin-row",children:c.jsxs("label",{children:["Title",c.jsx("input",{type:"text",value:ve.data.title,onChange:E=>mt("title",E.target.value)})]})}),q.length>0&&c.jsx("div",{className:"title-suggestions",children:q.map((E,H)=>c.jsx("button",{type:"button",className:"manga-btn mini",onClick:()=>mt("title",E),children:E},E+H))}),c.jsxs("div",{className:"admin-row two",style:{alignItems:"flex-end",marginTop:"-8px"},children:[c.jsxs("div",{children:[c.jsxs("div",{className:"manga-modal-subtitle",style:{marginBottom:"6px"},children:["Entry ",be+1," / ",Math.max(1,Ve.length||1)]}),c.jsxs("div",{style:{display:"flex",gap:"8px"},children:[c.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>be>0&&as(be-1),disabled:be===0,children:"Previous"}),c.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>Ve.length&&be<Ve.length-1?as(be+1):null,disabled:!Ve.length||be===Ve.length-1,children:"Next"})]})]}),c.jsxs("div",{style:{textAlign:"right"},children:[c.jsx("button",{className:"manga-btn",type:"button",onClick:As,disabled:!fn(ve.data.title||"").vol,children:"Add New Volume"}),c.jsx("div",{className:"manga-stat-sub",style:{marginTop:"4px"},children:"Auto-fills the next volume number for this series."})]})]}),c.jsx("div",{className:"admin-row",children:c.jsxs("label",{children:["Authors",c.jsx("input",{type:"text",value:ve.data.authors,onChange:E=>mt("authors",E.target.value)})]})}),c.jsx("div",{className:"admin-row",children:c.jsxs("label",{children:["Publisher",c.jsx("input",{type:"text",value:ve.data.publisher,onChange:E=>mt("publisher",E.target.value)})]})}),c.jsxs("div",{className:"admin-row three",children:[c.jsxs("label",{children:["Release Date",c.jsx("input",{type:"date",value:ve.data.date,onChange:E=>mt("date",E.target.value)})]}),!lt&&c.jsxs(c.Fragment,{children:[c.jsxs("label",{children:["Date Purchased",c.jsx("input",{type:"date",value:ve.data.datePurchased,onChange:E=>mt("datePurchased",E.target.value)})]}),c.jsxs("label",{children:["Date Read",c.jsx("input",{type:"date",value:ve.data.dateRead,onChange:E=>mt("dateRead",E.target.value)})]})]})]}),c.jsxs("div",{className:"admin-row two",children:[c.jsxs("label",{children:["Page Count",c.jsx("input",{type:"number",placeholder:"e.g. 192",value:ve.data.pageCount,onChange:E=>mt("pageCount",E.target.value)})]}),!lt&&c.jsxs("label",{children:["ISBN (library only)",c.jsx("input",{type:"text",value:ve.data.isbn,onChange:E=>mt("isbn",E.target.value)})]})]}),c.jsx("div",{className:"admin-row",children:c.jsxs("label",{children:["Cover URL",c.jsx("input",{type:"text",placeholder:"Paste image URL here",value:ve.data.cover,onChange:E=>mt("cover",E.target.value)})]})}),!lt&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"admin-row two",children:[!(ve.data.special&&ve.data.specialType==="collectible")&&c.jsxs("label",{children:["Amount Paid",c.jsx("input",{type:"number",step:"0.01",value:ve.data.amountPaid,onChange:E=>mt("amountPaid",E.target.value)})]}),c.jsxs("label",{children:["MSRP",c.jsx("input",{type:"number",step:"0.01",value:ve.data.msrp,onChange:E=>mt("msrp",E.target.value)})]})]}),c.jsx("div",{className:"admin-row",children:c.jsxs("label",{className:"checkbox-row",children:[c.jsx("input",{type:"checkbox",checked:!!ve.data.special,onChange:E=>mt("special",E.target.checked,"checkbox")}),c.jsx("span",{children:"Special item?"})]})}),ve.data.special&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"admin-row two",children:[c.jsxs("label",{children:["Special Type",c.jsxs("select",{value:ve.data.specialType,onChange:E=>mt("specialType",E.target.value),children:[c.jsx("option",{value:"",children:"Select type"}),c.jsx("option",{value:"specialEdition",children:"Special Edition"}),c.jsx("option",{value:"collectible",children:"Collectible"})]})]}),ve.data.specialType==="collectible"&&c.jsxs("label",{children:["Collectible Price",c.jsx("input",{type:"number",step:"0.01",value:ve.data.collectiblePrice,onChange:E=>mt("collectiblePrice",E.target.value)})]})]}),ve.data.specialType==="specialEdition"&&c.jsx("div",{className:"admin-row",children:c.jsxs("label",{children:["Special Volumes",c.jsx("input",{type:"number",min:"0",value:ve.data.specialVolumes,onChange:E=>mt("specialVolumes",E.target.value)})]})})]})]}),lt&&c.jsx("div",{className:"admin-row",children:c.jsxs("label",{children:["Amazon URL",c.jsx("input",{type:"text",value:ve.data.amazonURL,onChange:E=>mt("amazonURL",E.target.value)})]})}),!lt&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"admin-row",children:c.jsxs("label",{children:["Rating (1-5 stars)",c.jsx(_n,{value:ve.data.rating,onChange:E=>mt("rating",E)})]})}),c.jsxs("div",{className:"admin-row two",children:[c.jsxs("label",{className:"checkbox-inline",children:[c.jsx("input",{type:"checkbox",checked:ve.data.read,onChange:E=>mt("read",E.target.checked,"checkbox")}),c.jsx("span",{children:"Mark as read"})]}),c.jsxs("label",{className:"checkbox-inline",children:[c.jsx("input",{type:"checkbox",checked:!!ve.data.hidden,onChange:E=>mt("hidden",E.target.checked,"checkbox")}),c.jsx("span",{children:"Hide from public"})]})]})]}),lt&&c.jsx("div",{className:"admin-row",children:c.jsxs("label",{className:"checkbox-inline",children:[c.jsx("input",{type:"checkbox",checked:!!ve.data.hidden,onChange:E=>mt("hidden",E.target.checked,"checkbox")}),c.jsx("span",{children:"Hide from public"})]})})]})]}),c.jsxs("div",{className:"manga-modal-footer",style:{justifyContent:"flex-end",gap:"10px"},children:[c.jsx("button",{className:"manga-btn secondary",onClick:Vn,type:"button",children:"Cancel"}),c.jsx("button",{className:"manga-btn",onClick:ri,type:"button",children:ve.mode==="add"?"Add":"Save"})]})]})})}),s&&A.open&&c.jsx("div",{className:"manga-modal-backdrop visible",onClick:E=>{E.target===E.currentTarget&&Yt()},children:c.jsx("div",{className:"manga-modal admin",children:c.jsxs("div",{className:"manga-modal-body",children:[c.jsxs("div",{className:"manga-modal-header",children:[c.jsxs("div",{className:"manga-modal-title",children:["Bulk Edit (",A.index+1," / ",A.items.length,")"]}),c.jsx("button",{className:"manga-modal-close",onClick:Yt,type:"button",children:"Close"})]}),A.items.length>0&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"manga-modal-subtitle",children:["Editing: ",A.items[A.index].data.title||"Untitled"]}),c.jsxs("div",{className:"admin-form-grid",children:[c.jsxs("label",{children:["Title",c.jsx("input",{type:"text",value:A.items[A.index].data.title,onChange:E=>yt("title",E.target.value)})]}),c.jsxs("label",{children:["Authors",c.jsx("input",{type:"text",value:A.items[A.index].data.authors,onChange:E=>yt("authors",E.target.value)})]}),c.jsxs("label",{children:["Publisher",c.jsx("input",{type:"text",value:A.items[A.index].data.publisher,onChange:E=>yt("publisher",E.target.value)})]}),c.jsxs("label",{children:["Release Date",c.jsx("input",{type:"date",value:A.items[A.index].data.date,onChange:E=>yt("date",E.target.value)})]}),!Xt&&c.jsxs("label",{children:["ISBN",c.jsx("input",{type:"text",value:A.items[A.index].data.isbn,onChange:E=>yt("isbn",E.target.value)})]}),c.jsxs("label",{children:["Cover URL",c.jsx("input",{type:"text",value:A.items[A.index].data.cover,onChange:E=>yt("cover",E.target.value)})]}),c.jsxs("label",{children:["Page Count",c.jsx("input",{type:"number",value:A.items[A.index].data.pageCount,onChange:E=>yt("pageCount",E.target.value)})]}),!Xt&&c.jsxs(c.Fragment,{children:[c.jsxs("label",{children:["Rating (1-5 stars)",c.jsx(_n,{value:A.items[A.index].data.rating,onChange:E=>yt("rating",E)})]}),!(A.items[A.index].data.special&&A.items[A.index].data.specialType==="collectible")&&c.jsxs("label",{children:["Amount Paid",c.jsx("input",{type:"number",step:"0.01",value:A.items[A.index].data.amountPaid,onChange:E=>yt("amountPaid",E.target.value)})]}),!(A.items[A.index].data.special&&A.items[A.index].data.specialType==="collectible")&&c.jsxs("label",{children:["Amount Paid",c.jsx("input",{type:"number",step:"0.01",value:A.items[A.index].data.amountPaid,onChange:E=>yt("amountPaid",E.target.value)})]}),c.jsxs("label",{children:["MSRP",c.jsx("input",{type:"number",step:"0.01",value:A.items[A.index].data.msrp,onChange:E=>yt("msrp",E.target.value)})]}),A.items[A.index].data.special&&A.items[A.index].data.specialType==="collectible"&&c.jsxs("label",{children:["Collectible Price",c.jsx("input",{type:"number",step:"0.01",value:A.items[A.index].data.collectiblePrice,onChange:E=>yt("collectiblePrice",E.target.value)})]})]}),!Xt&&c.jsxs(c.Fragment,{children:[c.jsxs("label",{children:["Date Purchased",c.jsx("input",{type:"date",value:A.items[A.index].data.datePurchased,onChange:E=>yt("datePurchased",E.target.value)})]}),c.jsxs("label",{children:["Date Read",c.jsx("input",{type:"date",value:A.items[A.index].data.dateRead,onChange:E=>yt("dateRead",E.target.value)})]})]}),!Xt&&c.jsxs(c.Fragment,{children:[c.jsxs("label",{className:"checkbox-row",children:[c.jsx("input",{type:"checkbox",checked:!!A.items[A.index].data.special,onChange:E=>yt("special",E.target.checked,"checkbox")}),c.jsx("span",{children:"Special item?"})]}),A.items[A.index].data.special&&c.jsxs(c.Fragment,{children:[c.jsxs("label",{children:["Special Type",c.jsxs("select",{value:A.items[A.index].data.specialType,onChange:E=>yt("specialType",E.target.value),children:[c.jsx("option",{value:"",children:"Select type"}),c.jsx("option",{value:"specialEdition",children:"Special Edition"}),c.jsx("option",{value:"collectible",children:"Collectible"})]})]}),A.items[A.index].data.specialType==="specialEdition"&&c.jsxs("label",{children:["Special Volumes",c.jsx("input",{type:"number",value:A.items[A.index].data.specialVolumes,onChange:E=>yt("specialVolumes",E.target.value)})]}),A.items[A.index].data.specialType==="collectible"&&c.jsxs("label",{children:["Collectible Price",c.jsx("input",{type:"number",step:"0.01",value:A.items[A.index].data.collectiblePrice,onChange:E=>yt("collectiblePrice",E.target.value)})]})]})]}),Xt&&c.jsxs("label",{children:["Amazon URL",c.jsx("input",{type:"text",value:A.items[A.index].data.amazonURL,onChange:E=>yt("amazonURL",E.target.value)})]}),!Xt&&c.jsxs("label",{className:"checkbox-row",children:[c.jsx("input",{type:"checkbox",checked:A.items[A.index].data.read,onChange:E=>yt("read",E.target.checked,"checkbox")}),c.jsx("span",{children:"Marked as read"})]}),c.jsxs("label",{className:"checkbox-row",children:[c.jsx("input",{type:"checkbox",checked:!!A.items[A.index].data.hidden,onChange:E=>yt("hidden",E.target.checked,"checkbox")}),c.jsx("span",{children:"Hidden from public"})]})]}),c.jsxs("div",{className:"manga-modal-footer",style:{justifyContent:"space-between",gap:"10px"},children:[c.jsxs("div",{children:[c.jsx("button",{className:"manga-btn secondary",onClick:Kn,type:"button",disabled:A.index===0,children:"Previous"}),c.jsx("button",{className:"manga-btn secondary",onClick:ls,type:"button",disabled:A.index===A.items.length-1,style:{marginLeft:"6px"},children:"Next"})]}),c.jsxs("div",{style:{display:"flex",gap:"8px"},children:[c.jsx("button",{className:"manga-btn secondary",onClick:Yt,type:"button",children:"Cancel"}),c.jsx("button",{className:"manga-btn",onClick:Ln,type:"button",children:"Save Edits"})]})]})]})]})})}),Et&&c.jsx(Dw,{open:se,title:"Suggest a Manga",placeholder:"Type a manga you'd like me to collect/read...",value:_e,status:Ae,loading:Qe,onChange:me,onSubmit:m,onClose:()=>ee(!1)}),c.jsx("datalist",{id:"adminTitleSuggestions",children:$.map(E=>c.jsx("option",{value:E},E))})]})}const wR="https://imokmalworker.imokissick.workers.dev/?url=",Vw="im_ok",Lv=300,xR={1:"watching",2:"completed",3:"on_hold",4:"dropped",6:"plan_to_watch"};function ER(n){const e=n==null?void 0:n.title_localized,t=typeof e=="string"?e:(e==null?void 0:e.en)||(e==null?void 0:e.english);return(n==null?void 0:n.anime_title_eng)||(n==null?void 0:n.title_english)||t||(n==null?void 0:n.anime_title)||(n==null?void 0:n.title)||"Untitled"}function TR(n){const e=(n==null?void 0:n.updated_at)??(n==null?void 0:n.updatedAt)??(n==null?void 0:n.updated_at_ms)??null;if(e==null)return null;const t=Number(e);if(Number.isFinite(t))return t<1e12?t*1e3:t;const s=Date.parse(e);return Number.isNaN(s)?null:s}function SR(n){const e=xR[n.status]||(typeof n.status=="string"?n.status.toLowerCase():"unknown");return{id:n.anime_id||n.id,title:ER(n),updatedAt:TR(n),episodes:n.anime_num_episodes??n.episodes??null,watchedEpisodes:n.num_watched_episodes??n.my_watched_episodes??n.watched_episodes??n.num_watched??0,status:e,score:n.score??null,image:n.anime_image_path||n.image_url||n.anime_img||n.picture||null,synopsis:n.anime_synopsis||n.synopsis||null}}function Ov(){const n=Date.now();return[{id:1,title:"Cowboy Bebop",episodes:26,status:"completed",score:10,updatedAt:n-1e3*60*60*24*3,synopsis:"In 2071, bounty hunters Spike and Jet roam the solar system looking for their next payout and a place to belong."},{id:2,title:"Fullmetal Alchemist: Brotherhood",episodes:64,status:"completed",score:10,updatedAt:n-1e3*60*60*24*6,synopsis:"Brothers Edward and Alphonse Elric search for the Philosopher's Stone to restore their bodies after a failed alchemy ritual."},{id:3,title:"Frieren: Beyond Journey's End",episodes:28,status:"watching",score:9,updatedAt:n-1e3*60*60*8,synopsis:"An elven mage retraces the steps of a past adventure to understand humanity and the passage of time."},{id:4,title:"One Piece",episodes:1e3,status:"on_hold",score:8,updatedAt:n-1e3*60*60*24*14,synopsis:"Monkey D. Luffy sails toward the Grand Line seeking the One Piece and a crew to make his dream real."},{id:5,title:"Kaiju No. 8",episodes:12,status:"plan_to_watch",score:null,updatedAt:n-1e3*60*30,synopsis:"A middle-aged worker gains kaiju powers and joins the Defense Force to fight monsters from the inside."}]}async function IR(n,e){const t=`https://myanimelist.net/animelist/${n}/load.json?status=7&offset=${e}`,s=await fetch(`${wR}${encodeURIComponent(t)}`);if(!s.ok)throw new Error(`Failed to fetch MAL list (offset ${e})`);return s.json()}async function CR(n=Vw){const e=[];try{let t=0;for(;;){const s=await IR(n,t);if(!Array.isArray(s)||s.length===0||(e.push(...s),s.length<Lv))break;t+=Lv}}catch(t){return console.error("Failed to load MAL list; falling back to sample data.",t),Ov()}return e.length?e.map(SR):Ov()}async function bR(n){var e,t;if(!n)return null;try{const s=await fetch(`https://api.jikan.moe/v4/anime/${n}`);if(!s.ok)throw new Error(`Failed to fetch Jikan summary for id ${n}`);const a=await s.json();return((e=a==null?void 0:a.data)==null?void 0:e.synopsis)||((t=a==null?void 0:a.data)==null?void 0:t.background)||null}catch(s){return console.error("Failed to load anime synopsis",n,s),null}}async function PR(n=Vw){var e;if(!n)return null;try{const t=await fetch(`https://api.jikan.moe/v4/users/${encodeURIComponent(n)}/statistics`);if(!t.ok)throw new Error(`Failed to fetch user stats for ${n}`);const s=await t.json(),a=((e=s==null?void 0:s.data)==null?void 0:e.anime)||{},l=Number(a.days_watched),d=Number(a.total_episodes??a.episodes_watched);return{daysWatched:Number.isFinite(l)?l:null,episodesWatched:Number.isFinite(d)?d:null}}catch(t){return console.error("Failed to load user stats",n,t),null}}const Mv=5,RR=3600*1e3,Fv="animeSuggestionsSent";function NR(){const{admin:n,user:e,role:t}=jo(),s=te=>te?te.toString().replace(/_/g," ").replace(/\b\w/g,Fe=>Fe.toUpperCase()):"Unknown",[a,l]=D.useState([]),[d,f]=D.useState([]),[m,v]=D.useState(""),[w,S]=D.useState("all"),[C,$]=D.useState(!0),[X,q]=D.useState(""),[U,ne]=D.useState(null),[xe,ge]=D.useState({}),[ye,ie]=D.useState(!1),[Ee,k]=D.useState(!1),[P,R]=D.useState(null),[M,B]=D.useState(!1),[V,b]=D.useState(""),[he,ve]=D.useState(""),[ot,Ve]=D.useState(!1);D.useEffect(()=>{document.title="Anime | Library"},[]),D.useEffect(()=>{ve("")},[e]);const pe=te=>{if(!te)return"";const Fe=Date.now()-te,Be=Math.max(Fe,0),We=Math.floor(Be/6e4);if(We<1)return"just now";if(We<60)return`${We}m ago`;const Et=Math.floor(We/60);if(Et<48)return`${Et}h ago`;const wt=Math.floor(Et/24);if(wt<14)return`${wt}d ago`;const pt=Math.floor(wt/7);return pt<8?`${pt}w ago`:`${Math.floor(wt/30)}mo ago`},be=(te,Fe="image")=>(te||"").toString().toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"").slice(0,80)||Fe,Te=async()=>{const te=a.filter(Fe=>Fe.image).map((Fe,Be)=>({url:Fe.image,name:be(Fe.title||`anime-${Be+1}`,`anime-${Be+1}`)}));if(!te.length){alert("No images found to download.");return}try{const Fe=(await Xl(async()=>{const{default:Ut}=await import("https://cdn.jsdelivr.net/npm/jszip@3.10.1/+esm");return{default:Ut}},[])).default,Be=new Fe,We=Be.folder("images"),Et={};await Promise.all(te.map(async(Ut,It)=>{try{const gn=await(await fetch(Ut.url)).blob(),qn=(Ut.url.split(".").pop()||"jpg").split(/[?#]/)[0],yn=Ut.name||`image-${It+1}`;Et[yn]=(Et[yn]||0)+1;const sr=Et[yn]>1?`-${Et[yn]}`:"";We.file(`${yn}${sr}.${qn}`,gn)}catch(In){console.warn("Failed to fetch image",Ut.url,In)}}));const wt=await Be.generateAsync({type:"blob"}),pt=URL.createObjectURL(wt),Tt=document.createElement("a");Tt.href=pt,Tt.download="anime-images.zip",Tt.click(),URL.revokeObjectURL(pt)}catch(Fe){console.error("Zip download failed",Fe),alert("Failed to create zip. Please try again.")}};D.useEffect(()=>{async function te(){try{const Fe=await CR();l(Fe),f(Fe)}catch(Fe){console.error(Fe),q("Failed to load data from MAL.")}finally{$(!1)}}te()},[]),D.useEffect(()=>{PR().then(te=>{te&&R(te)}).catch(()=>{})},[]);const A=te=>{switch((te||"unknown").toLowerCase()){case"watching":return 0;case"completed":return 1;case"on_hold":return 2;case"plan_to_watch":return 3;case"dropped":return 4;default:return 5}},N=te=>{const Fe=Number.isFinite(Number(te.watchedEpisodes))?Number(te.watchedEpisodes):0,Be=Number.isFinite(Number(te.episodes))?Number(te.episodes):null;return Be?`${Math.min(Fe,Be)}/${Be} eps`:Fe?`${Fe} eps`:"No progress"};D.useEffect(()=>{let te=[...a];if(w!=="all"&&(te=te.filter(Fe=>(Fe.status||"").toLowerCase()===w)),m){const Fe=m.toLowerCase();te=te.filter(Be=>(Be.title||"").toLowerCase().includes(Fe))}te.sort((Fe,Be)=>{const We=A(Fe.status),Et=A(Be.status);return We!==Et?We-Et:(Fe.title||"").localeCompare(Be.title||"")}),f(te)},[a,w,m]);const se=D.useMemo(()=>[...a].filter(te=>Number.isFinite(te.updatedAt)).sort((te,Fe)=>Fe.updatedAt-te.updatedAt).slice(0,6),[a]),ee=!!e&&t==="viewer",_e=async()=>{const te=Date.now(),Be=(()=>{try{const We=localStorage.getItem(Fv);return Array.isArray(JSON.parse(We))?JSON.parse(We):[]}catch{return[]}})().filter(We=>te-We<RR);if(Be.length>=Mv){ve("Rate limit: please wait a bit (max 5 suggestions per hour).");return}if(!V.trim()){ve("Please enter a title or note before sending.");return}Ve(!0),ve("");try{const We=`**Anime Suggestion**
${V.trim()}
From: ${(e==null?void 0:e.displayName)||(e==null?void 0:e.email)||(e==null?void 0:e.uid)||"anonymous user"}`;await ma(rr(tt,"suggestions"),{content:V.trim(),type:"anime",from:(e==null?void 0:e.displayName)||(e==null?void 0:e.email)||(e==null?void 0:e.uid)||"anonymous user",createdAt:new Date().toISOString()}),ve("Sent! I'll review your suggestion soon."),b("");const Et=[...Be,te].slice(-Mv);localStorage.setItem(Fv,JSON.stringify(Et))}catch(We){console.error("Failed to send suggestion",We),ve("Failed to send suggestion. Please try again later.")}finally{Ve(!1)}};D.useEffect(()=>{if(!U){k(!1),ie(!1);return}k(!!U.synopsis),ie(!1)},[U==null?void 0:U.id]);const me=D.useMemo(()=>{const te=a.length,Fe=a.reduce((pt,Tt)=>{const Ut=Number(Tt.watchedEpisodes);return Number.isFinite(Ut)?pt+Ut:pt},0),Be=Fe*.4,We=a.filter(pt=>Number.isFinite(pt.score)&&pt.score>0),Et=We.reduce((pt,Tt)=>pt+Tt.score,0),wt={watching:0,completed:0,on_hold:0,dropped:0,plan_to_watch:0,unknown:0};return a.forEach(pt=>{const Tt=(pt.status||"unknown").toLowerCase();wt[Tt]!=null?wt[Tt]+=1:wt.unknown+=1}),{total:te,totalWatchedEpisodes:Fe,byStatus:wt,avgScore:We.length?Et/We.length:0,totalHours:Be}},[a]),Ae=(P==null?void 0:P.daysWatched)??(me.totalHours||0)/24,Me=(P==null?void 0:P.episodesWatched)??me.totalWatchedEpisodes,Qe=te=>{const Fe=te.image||"https://imgur.com/chUgq4W.png",Be=Number.isFinite(Number(te.watchedEpisodes))?Number(te.watchedEpisodes):0,We=Number.isFinite(Number(te.episodes))?Number(te.episodes):null,Et=We?`Episode ${Math.min(Be,We)}/${We}`:`Episode ${Be}`,wt=Number.isFinite(Number(te.score))&&Number(te.score)>0?te.score:"Not rated";return c.jsxs("article",{className:"anime-card",onClick:()=>ne(te.synopsis?te:{...te,synopsis:xe[te.id]}),children:[c.jsxs("div",{className:"anime-cover-wrap",children:[c.jsx("img",{className:"anime-cover",src:Fe,alt:te.title,loading:"lazy",decoding:"async"}),c.jsx("div",{className:`badge-status ${(te.status||"unknown").toLowerCase()}`,children:s(te.status)}),te.score!=null&&c.jsx("div",{className:"badge-score",children:wt})]}),c.jsxs("div",{className:"anime-meta",children:[c.jsx("div",{className:"anime-title",title:te.title,children:te.title}),c.jsx("div",{className:"anime-sub",children:te.episodes?`${te.episodes} episodes`:"Episodes: ?"}),c.jsx("div",{className:"anime-progress",children:Et}),c.jsxs("div",{className:"anime-progress",children:["Status: ",s(te.status)]})]})]},te.id||te.title)},xt=te=>c.jsxs("article",{className:"anime-update-card",children:[c.jsx("div",{className:"anime-update-title",title:te.title,children:te.title}),c.jsxs("div",{className:"anime-update-meta",children:[c.jsx("span",{className:"anime-update-progress",children:N(te)}),c.jsx("span",{className:"anime-update-dot","aria-hidden":"true",children:""}),c.jsx("span",{className:"anime-update-status",children:s(te.status)})]}),c.jsx("div",{className:"anime-update-time",children:pe(te.updatedAt)})]},`update-${te.id||te.title}`);return c.jsxs("main",{className:"anime-page",children:[c.jsxs("div",{className:"anime-content",children:[c.jsxs("header",{className:"anime-header",style:{position:"relative",display:"flex",justifyContent:"center",alignItems:"center",textAlign:"center",width:"100%"},children:[c.jsxs("div",{style:{textAlign:"center",margin:"0 auto",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"0 60px"},children:[c.jsx("h1",{className:"anime-title",style:{margin:0,fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Tyler's Anime Library"}),c.jsx("p",{className:"anime-sub",style:{textAlign:"center",margin:"6px 0 0"},children:"The Anime I've watched/watching synced directly from MAL (MyAnimeList)"})]}),(ee||n)&&c.jsxs("div",{style:{position:"absolute",right:0,top:"50%",transform:"translateY(-50%)",display:"flex",gap:"10px"},children:[ee&&c.jsx("button",{className:"suggestion-trigger",type:"button",onClick:()=>{ve(""),B(!0)},children:"+ Suggestion"}),n&&c.jsx("button",{className:"stat-link",type:"button",onClick:Te,children:"Download Images"})]})]}),c.jsxs("div",{className:"anime-stats",children:[c.jsxs("div",{className:"anime-stat-card",children:[c.jsx("div",{className:"anime-stat-label",children:"Total Entries"}),c.jsx("div",{className:"anime-stat-value",children:me.total})]}),c.jsxs("div",{className:"anime-stat-card",children:[c.jsx("div",{className:"anime-stat-label",children:"Episodes Watched"}),c.jsx("div",{className:"anime-stat-value",children:Me})]}),c.jsxs("div",{className:"anime-stat-card",children:[c.jsx("div",{className:"anime-stat-label",children:"Watching"}),c.jsx("div",{className:"anime-stat-value",children:me.byStatus.watching})]}),c.jsxs("div",{className:"anime-stat-card",children:[c.jsx("div",{className:"anime-stat-label",children:"Completed"}),c.jsx("div",{className:"anime-stat-value",children:me.byStatus.completed})]}),c.jsxs("div",{className:"anime-stat-card",children:[c.jsx("div",{className:"anime-stat-label",children:"Plan to Watch"}),c.jsx("div",{className:"anime-stat-value",children:me.byStatus.plan_to_watch})]}),c.jsxs("div",{className:"anime-stat-card",children:[c.jsx("div",{className:"anime-stat-label",children:"Avg. Score"}),c.jsx("div",{className:"anime-stat-value",children:me.avgScore?me.avgScore.toFixed(1):"0.0"})]}),c.jsxs("div",{className:"anime-stat-card",children:[c.jsx("div",{className:"anime-stat-label",children:"Days Watched"}),c.jsx("div",{className:"anime-stat-value",children:Ae.toFixed(1)})]})]}),c.jsxs("section",{className:"anime-toolbar",children:[c.jsx("input",{type:"text",placeholder:"Search anime by title...",value:m,onChange:te=>v(te.target.value),className:"anime-input"}),c.jsxs("select",{value:w,onChange:te=>S(te.target.value),className:"anime-select",children:[c.jsx("option",{value:"all",children:"All statuses"}),c.jsx("option",{value:"watching",children:"Watching"}),c.jsx("option",{value:"completed",children:"Completed"}),c.jsx("option",{value:"on_hold",children:"On Hold"}),c.jsx("option",{value:"plan_to_watch",children:"Plan to Watch"}),c.jsx("option",{value:"dropped",children:"Dropped"})]})]}),C&&c.jsx("div",{className:"loading",children:"Loading anime list from MAL..."}),X&&c.jsx("div",{className:"error-state",children:X}),!C&&!X&&c.jsx(c.Fragment,{children:d.length===0?c.jsx("div",{className:"empty-state",children:"No results match your filters yet."}):c.jsx("section",{className:"anime-grid",children:d.map(te=>Qe(te))})})]}),se.length>0&&c.jsxs("aside",{className:"anime-updates-float",children:[c.jsxs("div",{className:"anime-updates-header",children:[c.jsx("h3",{children:"Recent Updates"}),c.jsx("span",{className:"anime-updates-caption",children:"Last list activity"})]}),c.jsx("div",{className:"anime-updates-list",children:se.map(te=>xt(te))})]}),ee&&c.jsx(Dw,{open:M,title:"Suggest an Anime",placeholder:"Type an anime you'd like me to watch...",value:V,status:he,loading:ot,onChange:b,onSubmit:_e,onClose:()=>B(!1)}),U&&c.jsx("div",{className:"modal-backdrop visible",onClick:te=>{te.target===te.currentTarget&&ne(null)},children:c.jsxs("div",{className:"anime-modal",children:[c.jsxs("div",{className:"anime-modal-header",children:[c.jsx("h2",{style:{color:"#ffb6c1",margin:0},children:U.title}),c.jsx("button",{className:"anime-modal-close",onClick:()=>ne(null),type:"button",children:"Close"})]}),c.jsxs("div",{className:"anime-modal-body",children:[c.jsx("div",{children:c.jsx("img",{className:"anime-modal-cover",src:U.image||"https://imgur.com/chUgq4W.png",alt:U.title})}),c.jsxs("div",{className:"anime-modal-meta",children:[c.jsxs("div",{children:[c.jsx("strong",{children:"Status:"})," ",s(U.status)]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Episodes:"})," ",U.episodes?U.episodes:"Unknown"]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Progress:"})," ",Number.isFinite(Number(U.watchedEpisodes))?`Episode ${U.watchedEpisodes}${Number.isFinite(Number(U.episodes))?`/${U.episodes}`:""}`:"Unknown"]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Score:"})," ",Number.isFinite(Number(U.score))&&Number(U.score)>0?U.score:"Not rated"]})]}),c.jsx(AR,{modalItem:U,modalLoading:ye,modalSynopsisShown:Ee,onReveal:async()=>{if(!U)return;k(!0);const te=U.id;if(!te)return;const Fe=xe[te];if(Fe!==void 0){ne(Be=>Be&&{...Be,synopsis:Fe});return}ie(!0);try{const Be=await bR(te);ge(We=>({...We,[te]:Be||""})),ne(We=>We&&{...We,synopsis:Be||""})}catch{ge(We=>({...We,[te]:""})),ne(We=>We&&{...We,synopsis:""})}finally{ie(!1)}}})]})]})})]})}function AR({modalItem:n,modalLoading:e,modalSynopsisShown:t,onReveal:s}){var m;const a=((m=n==null?void 0:n.synopsis)==null?void 0:m.trim())||"",[l,d]=D.useState(0),f=D.useRef(null);return D.useEffect(()=>{if(t&&f.current){const v=f.current.scrollHeight+12;d(v)}else d(0)},[t,a]),c.jsxs("div",{className:"anime-modal-summary",children:[c.jsxs("div",{className:"anime-modal-summary-header",children:[c.jsx("h3",{children:"Synopsis"}),!t&&c.jsx("button",{className:"anime-synopsis-btn",type:"button",onClick:s,children:e?"Loading...":"Reveal Synopsis"})]}),c.jsx("div",{className:`anime-modal-summary-body ${t?"is-open":""}`,style:{maxHeight:t?`${l}px`:0,opacity:t?1:0},children:c.jsx("div",{ref:f,children:c.jsx("p",{className:"anime-modal-summary-text",children:e&&!a?"Loading synopsis...":a||"No synopsis available."})})}),!t&&c.jsx("p",{className:"anime-modal-summary-text anime-modal-summary-hint",children:"Synopsis hidden. Click reveal to view."})]})}function kR(){const n={game:"pokemon",name:"",setName:"",number:"",rarity:"",condition:"",quantity:1,pricePaid:"",estimatedValue:"",image:"",productURL:"",notes:""},{admin:e,user:t}=jo(),[s,a]=D.useState(()=>localStorage.getItem("tcgLastGame")||n.game),[l,d]=D.useState([]),[f,m]=D.useState(!0),[v,w]=D.useState(""),[S,C]=D.useState("all"),[$,X]=D.useState("name"),[q,U]=D.useState(!1),[ne,xe]=D.useState([]),[ge,ye]=D.useState(""),[ie,Ee]=D.useState(null),[k,P]=D.useState(!1),[R,M]=D.useState(()=>({...n,game:s}));D.useEffect(()=>{document.title="TCG | Collection"},[]),D.useEffect(()=>{let N=!1;const se=async()=>{if(!N)try{const me=await fetch("/base/tcg-collection.json",{cache:"no-cache"});if(!me.ok)throw new Error("fallback fetch failed");const Ae=await me.json(),Me=Array.isArray(Ae.tcg)?Ae.tcg:[];N||d(Me.map((Qe,xt)=>({id:Qe.id||`offline-${xt}`,...Qe})))}catch(_e){console.error("TCG offline fallback failed",_e)}finally{N||m(!1)}};async function ee(){m(!0);try{const _e=rr(tt,"tcg"),me=await Gs(_e),Ae=[];me.forEach(Me=>Ae.push({id:Me.id,...Me.data()})),N||d(Ae)}catch(_e){console.error("Error loading TCG:",_e),await se()}finally{N||m(!1)}}return ee(),()=>{N=!0}},[t]);const B=l.filter(N=>{if(S!=="all"&&N.game!==S)return!1;if(!v)return!0;const se=v.toLowerCase();return(N.name||"").toLowerCase().includes(se)||(N.setName||"").toLowerCase().includes(se)||(N.number||"").toLowerCase().includes(se)}),V=[...B].sort((N,se)=>{const ee=(N.name||"").toLowerCase(),_e=(se.name||"").toLowerCase(),me=(N.setName||"").toLowerCase(),Ae=(se.setName||"").toLowerCase(),Me=(N.rarity||"").toLowerCase(),Qe=(se.rarity||"").toLowerCase(),xt=Number(N.quantity||0),te=Number(se.quantity||0),Fe=Number(N.estimatedValue||0)*Math.max(1,xt),Be=Number(se.estimatedValue||0)*Math.max(1,te);switch($){case"set":return me.localeCompare(Ae)||ee.localeCompare(_e);case"rarity":return Me.localeCompare(Qe)||ee.localeCompare(_e);case"quantity":return te-xt||ee.localeCompare(_e);case"value":return Be-Fe||ee.localeCompare(_e);case"name":default:return ee.localeCompare(_e)}}),b=l.reduce((N,se)=>{const ee=Number(se.quantity||1),_e=Number(se.pricePaid||0),me=Number(se.estimatedValue||0);N.totalCards+=ee,N.totalPaid+=ee*_e,N.totalValue+=ee*me;const Ae=(se.game||"").toLowerCase(),Me=ee*me;return Ae==="pokemon"?(N.pokemon+=ee,N.valueByGame.pokemon+=Me):Ae==="onepiece"?(N.onepiece+=ee,N.valueByGame.onepiece+=Me):Ae==="mtg"?(N.mtg+=ee,N.valueByGame.mtg+=Me):N.valueByGame.other+=Me,N},{totalCards:0,totalPaid:0,totalValue:0,pokemon:0,onepiece:0,mtg:0,valueByGame:{pokemon:0,onepiece:0,mtg:0,other:0}}),he=b.totalValue-b.totalPaid,ve=[["Pokemon",b.valueByGame.pokemon],["One Piece",b.valueByGame.onepiece],["MTG",b.valueByGame.mtg],["Other",b.valueByGame.other]].filter(([,N])=>N>0).map(([N,se])=>`${N}: $${se.toFixed(2)}`),ot=ve.length?ve.join(`
`):"No value data yet",Ve=(N,se)=>{if(N==="game"){a(se);try{localStorage.setItem("tcgLastGame",se)}catch{}}M(ee=>({...ee,[N]:se}))},pe=async()=>{if(!e)return;if(!R.name.trim()){alert("Card name is required.");return}const N={game:R.game,name:R.name.trim(),setName:R.setName.trim(),number:R.number.trim(),rarity:R.rarity.trim(),condition:R.condition.trim(),quantity:Number(R.quantity||1),pricePaid:Number(R.pricePaid||0),estimatedValue:Number(R.estimatedValue||0),image:R.image.trim(),productURL:R.productURL.trim(),notes:R.notes.trim()},se=me=>({game:(me.game||"").toLowerCase().trim(),name:(me.name||"").toLowerCase().trim(),setName:(me.setName||"").toLowerCase().trim(),number:(me.number||"").toLowerCase().trim(),rarity:(me.rarity||"").toLowerCase().trim(),condition:(me.condition||"").toLowerCase().trim(),pricePaid:Number(me.pricePaid||0),estimatedValue:Number(me.estimatedValue||0),image:(me.image||"").trim(),productURL:(me.productURL||"").trim(),notes:(me.notes||"").trim()}),ee=se(N),_e=l.find(me=>{const Ae=se(me);return Ae.game===ee.game&&Ae.name===ee.name&&Ae.setName===ee.setName&&Ae.number===ee.number&&Ae.rarity===ee.rarity&&Ae.condition===ee.condition&&Ae.pricePaid===ee.pricePaid&&Ae.estimatedValue===ee.estimatedValue&&Ae.image===ee.image&&Ae.productURL===ee.productURL&&Ae.notes===ee.notes});try{const me=rr(tt,"tcg");if(_e!=null&&_e.id){const Ae=Number(_e.quantity||1)+N.quantity;await Es(Pt(tt,"tcg",_e.id),{quantity:Ae}),d(Me=>Me.map(Qe=>Qe.id===_e.id?{...Qe,quantity:Ae}:Qe))}else{await ma(me,N);const Ae=await Gs(me),Me=[];Ae.forEach(Qe=>Me.push({id:Qe.id,...Qe.data()})),d(Me)}M({...n,game:s}),P(!1)}catch(me){console.error("Error adding card:",me),alert("Failed to save card.")}},be=async()=>{if(!e||!ie)return;if(!ie.name.trim()){alert("Card name is required.");return}const N={game:ie.game,name:ie.name.trim(),setName:ie.setName.trim(),number:ie.number.trim(),rarity:ie.rarity.trim(),condition:ie.condition.trim(),quantity:Number(ie.quantity||1),pricePaid:Number(ie.pricePaid||0),estimatedValue:Number(ie.estimatedValue||0),image:ie.image?ie.image.trim():"",productURL:ie.productURL?ie.productURL.trim():"",notes:ie.notes?ie.notes.trim():""};try{await Es(Pt(tt,"tcg",ie.id),N),d(se=>se.map(ee=>ee.id===ie.id?{...ee,...N}:ee)),Ee(null)}catch(se){console.error("Error updating card:",se),alert("Failed to update card.")}},Te=async N=>{if(e&&window.confirm("Delete this card?"))try{await pa(Pt(tt,"tcg",N)),d(se=>se.filter(ee=>ee.id!==N))}catch(se){console.error("Delete error:",se),alert("Failed to delete card.")}},A=()=>{if(!l.length){alert("No cards to export.");return}const N=new Blob([JSON.stringify({tcg:l},null,2)],{type:"application/json"}),se=URL.createObjectURL(N),ee=document.createElement("a");ee.href=se,ee.download="tcg-collection.json",ee.click(),URL.revokeObjectURL(se)};return c.jsxs("main",{className:"page",children:[c.jsxs("header",{style:{marginTop:"32px",marginBottom:"16px",display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",gap:"6px"},children:[c.jsx("h1",{style:{margin:0,fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Tyler's TCG Collection"}),c.jsx("p",{style:{margin:"6px 0 0",color:"var(--text-soft)",fontSize:"0.9rem"},children:"Check out my TCG Collection with all the data of how much I spent (Under construction) and how much my collection is worth in total!"}),e&&c.jsx("div",{style:{marginTop:"10px"},children:c.jsx("button",{className:"manga-btn secondary",type:"button",onClick:A,children:"Export JSON"})})]}),e&&c.jsx("button",{className:"manga-btn",type:"button","aria-label":"Add card",onClick:()=>P(!0),style:{position:"fixed",bottom:"20px",right:"20px",zIndex:1e3,width:"56px",height:"56px",borderRadius:"50%",padding:0,fontSize:"28px",display:"flex",alignItems:"center",justifyContent:"center"},children:"+"}),e&&k&&c.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(8,1,10,0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,padding:"12px"},onClick:N=>{N.target===N.currentTarget&&P(!1)},children:c.jsxs("div",{style:{width:"min(720px, 95vw)",background:"#140710",border:"1px solid rgba(255,182,193,0.3)",borderRadius:"12px",padding:"14px",boxShadow:"0 24px 60px rgba(0,0,0,0.85)"},onClick:N=>N.stopPropagation(),children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[c.jsx("h2",{style:{margin:0,color:"#ffb6c1"},children:"Add card"}),c.jsx("button",{className:"dashboard-close",onClick:()=>P(!1),type:"button",children:"Close"})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"180px 1fr",gap:"12px",alignItems:"flex-start",marginTop:"10px"},children:[c.jsx("div",{style:{width:"100%",maxWidth:"180px",borderRadius:"10px",border:"1px solid rgba(255,182,193,0.25)",background:"#1e0d14",overflow:"hidden",aspectRatio:"3 / 4",display:"flex",alignItems:"center",justifyContent:"center"},children:R.image?c.jsx("img",{src:R.image,alt:"Card preview",style:{width:"100%",height:"100%",objectFit:"cover"}}):c.jsx("div",{style:{color:"var(--text-soft)",fontSize:"0.8rem",padding:"6px"},children:"No image"})}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:"8px"},children:[c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Game",c.jsxs("select",{value:R.game,onChange:N=>Ve("game",N.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"},children:[c.jsx("option",{value:"pokemon",children:"Pokemon"}),c.jsx("option",{value:"onepiece",children:"One Piece"}),c.jsx("option",{value:"mtg",children:"MTG"})]})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Card name",c.jsx("input",{type:"text",value:R.name,onChange:N=>Ve("name",N.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Set name",c.jsx("input",{type:"text",value:R.setName,onChange:N=>Ve("setName",N.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Card number",c.jsx("input",{type:"text",value:R.number,onChange:N=>Ve("number",N.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Rarity",c.jsx("input",{type:"text",value:R.rarity,onChange:N=>Ve("rarity",N.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Condition",c.jsx("input",{type:"text",value:R.condition,onChange:N=>Ve("condition",N.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Quantity",c.jsx("input",{type:"number",min:"1",value:R.quantity,onChange:N=>Ve("quantity",N.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Price paid (per card)",c.jsx("input",{type:"number",step:"0.01",min:"0",value:R.pricePaid,onChange:N=>Ve("pricePaid",N.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Estimated value (per card)",c.jsx("input",{type:"number",step:"0.01",min:"0",value:R.estimatedValue,onChange:N=>Ve("estimatedValue",N.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Image URL",c.jsx("input",{type:"text",value:R.image||"",onChange:N=>Ve("image",N.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Product URL (backend only)",c.jsx("input",{type:"text",value:R.productURL||"",onChange:N=>Ve("productURL",N.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{gridColumn:"1 / -1",fontSize:"0.8rem",color:"var(--text-soft)"},children:["Notes",c.jsx("textarea",{value:R.notes,onChange:N=>Ve("notes",N.target.value),rows:3,style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff",resize:"vertical"}})]})]})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"12px"},children:[c.jsx("button",{onClick:()=>{M(n),P(!1)},style:{padding:"6px 12px",borderRadius:"999px",border:"1px solid rgba(255,182,193,0.5)",background:"transparent",color:"#ffb6c1",cursor:"pointer"},children:"Cancel"}),c.jsx("button",{onClick:pe,style:{padding:"6px 12px",borderRadius:"999px",border:"none",cursor:"pointer",fontWeight:600,background:"#ff69b4",color:"#1e0d14"},children:"Save card"})]})]})}),e&&ie&&c.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(8,1,10,0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,padding:"12px"},onClick:N=>{N.target===N.currentTarget&&Ee(null)},children:c.jsxs("div",{style:{width:"min(720px, 95vw)",background:"#140710",border:"1px solid rgba(255,182,193,0.3)",borderRadius:"12px",padding:"14px",boxShadow:"0 24px 60px rgba(0,0,0,0.85)"},onClick:N=>N.stopPropagation(),children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[c.jsx("h2",{style:{margin:0,color:"#ffb6c1"},children:"Edit card"}),c.jsx("button",{className:"dashboard-close",onClick:()=>Ee(null),type:"button",children:"Close"})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"180px 1fr",gap:"12px",alignItems:"flex-start",marginTop:"10px"},children:[c.jsx("div",{style:{width:"100%",maxWidth:"180px",borderRadius:"10px",border:"1px solid rgba(255,182,193,0.25)",background:"#1e0d14",overflow:"hidden",aspectRatio:"3 / 4",display:"flex",alignItems:"center",justifyContent:"center"},children:ie.image?c.jsx("img",{src:ie.image,alt:"Card preview",style:{width:"100%",height:"100%",objectFit:"cover"}}):c.jsx("div",{style:{color:"var(--text-soft)",fontSize:"0.8rem",padding:"6px"},children:"No image"})}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:"8px"},children:[c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Game",c.jsxs("select",{value:ie.game,onChange:N=>Ee(se=>({...se,game:N.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"},children:[c.jsx("option",{value:"pokemon",children:"Pokemon"}),c.jsx("option",{value:"onepiece",children:"One Piece"}),c.jsx("option",{value:"mtg",children:"MTG"})]})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Card name",c.jsx("input",{type:"text",value:ie.name,onChange:N=>Ee(se=>({...se,name:N.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Set name",c.jsx("input",{type:"text",value:ie.setName,onChange:N=>Ee(se=>({...se,setName:N.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Card number",c.jsx("input",{type:"text",value:ie.number,onChange:N=>Ee(se=>({...se,number:N.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Rarity",c.jsx("input",{type:"text",value:ie.rarity,onChange:N=>Ee(se=>({...se,rarity:N.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Condition",c.jsx("input",{type:"text",value:ie.condition,onChange:N=>Ee(se=>({...se,condition:N.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Quantity",c.jsx("input",{type:"number",value:ie.quantity,onChange:N=>Ee(se=>({...se,quantity:N.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Price paid (each)",c.jsx("input",{type:"number",value:ie.pricePaid,onChange:N=>Ee(se=>({...se,pricePaid:N.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Estimated value (each)",c.jsx("input",{type:"number",value:ie.estimatedValue,onChange:N=>Ee(se=>({...se,estimatedValue:N.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Image URL",c.jsx("input",{type:"text",value:ie.image||"",onChange:N=>Ee(se=>({...se,image:N.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Product URL (backend only)",c.jsx("input",{type:"text",value:ie.productURL||"",onChange:N=>Ee(se=>({...se,productURL:N.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{gridColumn:"1 / -1",fontSize:"0.8rem",color:"var(--text-soft)"},children:["Notes",c.jsx("textarea",{value:ie.notes||"",onChange:N=>Ee(se=>({...se,notes:N.target.value})),rows:3,style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff",resize:"vertical"}})]})]})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"12px"},children:[c.jsx("button",{onClick:()=>Ee(null),style:{padding:"6px 12px",borderRadius:"999px",border:"1px solid rgba(255,182,193,0.5)",background:"transparent",color:"#ffb6c1",cursor:"pointer"},children:"Cancel"}),c.jsx("button",{onClick:be,style:{padding:"6px 12px",borderRadius:"999px",border:"none",cursor:"pointer",fontWeight:600,background:"#ff69b4",color:"#1e0d14"},children:"Save changes"})]})]})}),c.jsxs("section",{style:{display:"flex",flexWrap:"wrap",gap:"12px",marginTop:"18px",justifyContent:"center"},children:[c.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[c.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Total cards"}),c.jsx("div",{style:{fontSize:"1.1rem",fontWeight:700},children:b.totalCards})]}),b.totalPaid>0&&c.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[c.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Total paid"}),c.jsxs("div",{style:{fontSize:"1.1rem",fontWeight:700},children:["$",b.totalPaid.toFixed(2)]})]}),c.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},title:ot,children:[c.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Total value"}),c.jsxs("div",{style:{fontSize:"1.1rem",fontWeight:700},children:["$",b.totalValue.toFixed(2)]})]}),c.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[c.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Unrealized gain / loss"}),c.jsxs("div",{style:{fontSize:"1.1rem",fontWeight:700,color:he>=0?"#00e676":"#ff8a80"},children:[he>=0?"+":"-","$",Math.abs(he).toFixed(2)]})]}),c.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[c.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Pokemon cards"}),c.jsx("div",{style:{fontSize:"1.1rem",fontWeight:700},children:b.pokemon})]}),c.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[c.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"One Piece cards"}),c.jsx("div",{style:{fontSize:"1.1rem",fontWeight:700},children:b.onepiece})]}),c.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[c.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"MTG cards"}),c.jsx("div",{style:{fontSize:"1.1rem",fontWeight:700},children:b.mtg})]})]}),c.jsxs("section",{style:{display:"flex",flexWrap:"wrap",gap:"10px",marginTop:"16px"},children:[c.jsx("input",{type:"text",placeholder:"Search by name, set, or number...",value:v,onChange:N=>w(N.target.value),style:{flex:"1 1 220px",minWidth:"220px",padding:"8px 12px",borderRadius:"999px",border:"1px solid #bb7f8f",background:"#2b0f1d",color:"#fff"}}),c.jsxs("select",{value:S,onChange:N=>C(N.target.value),style:{flex:"0 0 220px",padding:"8px 12px",borderRadius:"999px",border:"1px solid #bb7f8f",background:"#2b0f1d",color:"#fff"},children:[c.jsx("option",{value:"all",children:"All games"}),c.jsx("option",{value:"pokemon",children:"Pokemon only"}),c.jsx("option",{value:"onepiece",children:"One Piece only"}),c.jsx("option",{value:"mtg",children:"MTG only"})]}),c.jsxs("select",{value:$,onChange:N=>X(N.target.value),style:{flex:"0 0 220px",padding:"8px 12px",borderRadius:"999px",border:"1px solid #bb7f8f",background:"#2b0f1d",color:"#fff"},children:[c.jsx("option",{value:"name",children:"Sort: Name (A-Z)"}),c.jsx("option",{value:"set",children:"Sort: Set (A-Z)"}),c.jsx("option",{value:"rarity",children:"Sort: Rarity (A-Z)"}),c.jsx("option",{value:"quantity",children:"Sort: Quantity (high to low)"}),c.jsx("option",{value:"value",children:"Sort: Value (high to low)"})]})]}),f?c.jsx("p",{style:{marginTop:"20px",color:"var(--text-soft)"},children:"Loading TCG collection..."}):B.length===0?c.jsx("p",{style:{marginTop:"20px",color:"var(--text-soft)"},children:"No cards found."}):c.jsx("section",{className:"grid",style:{gridTemplateColumns:"repeat(auto-fill, minmax(170px, 1fr))",marginTop:"20px"},children:V.map(N=>{const se=Number(N.quantity||1),ee=se*Number(N.pricePaid||0),_e=se*Number(N.estimatedValue||0);return c.jsxs("article",{style:{background:"#2b0f1d",borderRadius:"12px",border:"1px solid rgba(255,182,193,0.25)",boxShadow:"0 4px 16px rgba(0,0,0,0.55)",padding:"10px",fontSize:"0.82rem",display:"flex",flexDirection:"column",gap:"6px"},children:[N.image&&c.jsx("div",{style:{width:"100%",paddingTop:"140%",position:"relative",overflow:"hidden",borderRadius:"10px",background:"#1e0d14"},children:c.jsx("img",{src:N.image,alt:N.name||"card image",style:{position:"absolute",inset:0,width:"100%",height:"100%",objectFit:"contain"}})}),c.jsx("div",{style:{fontWeight:700,color:"#ffb6c1",marginBottom:"4px"},children:N.name||"Unnamed card"}),c.jsx("div",{style:{color:"var(--text-soft)",marginBottom:"4px"},children:N.setName||""}),c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",color:"var(--text-soft)"},children:[c.jsxs("span",{children:["#",N.number||"-"]}),c.jsx("span",{children:N.rarity||""})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",color:"var(--text-soft)",marginTop:"4px"},children:[c.jsxs("span",{children:["Cond: ",N.condition||"N/A"]}),c.jsxs("span",{children:["Qty: ",se]})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",color:"var(--text-soft)",marginTop:"4px"},children:[c.jsxs("span",{children:["Paid: $",ee.toFixed(2)]}),c.jsxs("span",{children:["Value: $",_e.toFixed(2)]})]}),N.notes&&c.jsxs("div",{style:{color:"#9c8fa6",fontSize:"0.72rem",fontStyle:"italic",textAlign:"center",marginTop:"6px"},children:['"',N.notes,'"']}),c.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"8px"},children:[c.jsx("span",{style:{padding:"2px 7px",borderRadius:"999px",background:"rgba(255,105,180,0.18)",border:"1px solid rgba(255,105,180,0.5)",color:"#ffb6c1",fontSize:"0.7rem",whiteSpace:"nowrap"},children:{pokemon:"Pokemon",onepiece:"One Piece",mtg:"MTG"}[N.game]||"Other"}),e&&c.jsxs("div",{style:{display:"flex",gap:"6px",alignItems:"center",marginLeft:"auto"},children:[c.jsx("button",{onClick:()=>Ee({...N,pricePaid:N.pricePaid??"",estimatedValue:N.estimatedValue??"",quantity:N.quantity??1}),style:{padding:"3px 8px",borderRadius:"999px",border:"1px solid rgba(255,182,193,0.5)",background:"rgba(255,105,180,0.15)",color:"#ffb6c1",fontSize:"0.7rem",cursor:"pointer"},children:"Edit"}),c.jsx("button",{onClick:()=>Te(N.id),style:{padding:"3px 8px",borderRadius:"999px",border:"1px solid rgba(244,67,54,0.7)",background:"rgba(244,67,54,0.12)",color:"#ff8a80",fontSize:"0.7rem",cursor:"pointer"},children:"Delete"})]})]})]},N.id)})})]})}const dl="https://discord.com/api/webhooks/1448287168845054004/cGWGPoH5LaTFlBZ1vxtgMjOfV9au6qyQ_9ZRnOWN9-AX0MNfwxKNWVcZYQHz0ESA7_4k",hl="https://discord.com/api/webhooks/1448288240871276616/101WI-B2p8tDR34Hl9fZxxb0QG01f1Eo5w1IvbttlQmP2wWFNJ0OI7UnJfJujKRNWW2Q",fl="https://discord.com/api/webhooks/1448329790942613667/wsC8psNZ-Ax2D1O9Gl4sJi6ay7df2cr7IrIdxMPwGZTBnkSUIY2NDpeVd98qW_4plz82",Uv="mangaLibraryActivityLog";function Zl(n){const e=n==null?"":String(n);return e.trim()?e.replace(/\s*,?\s*(?:vol(?:ume)?\.?)\s+\d+.*$/i,"").trim():""}function Ta(n){if(!n)return null;if(n instanceof Date)return n;if(n&&typeof n.toDate=="function")return n.toDate();const e=String(n).trim();if(!e)return null;const t=e.match(/^(\d{4})-(\d{2})-(\d{2})$/);if(t){const[,l,d,f]=t;return new Date(Number(l),Number(d)-1,Number(f))}const s=e.match(/^(\d{1,2})\/(\d{1,2})\/(\d{2,4})$/);if(s){let[,l,d,f]=s;const m=f.length===2?+`20${f}`:Number(f);return new Date(m,Number(l)-1,Number(d))}const a=new Date(e);return isNaN(a.getTime())?null:a}function hd(n){const e=n.seriesKey||n.series||n.Series||n.title||n.Title||"",s=(Zl(e)||e).trim();return s?s.toLowerCase():""}function jR(n){const e=(n==null?void 0:n.series)||(n==null?void 0:n.Series)||(n==null?void 0:n.title)||(n==null?void 0:n.Title)||"Unknown Series";return Zl(e)||"Unknown Series"}function zv(n){const e=(n||"").trim(),t=e.match(/^(.*?)(?:,?\s*(?:vol\.|volume)\s*(\d+)(?:\s*[-]\s*\d+)?\s*)?(?:\s*\([^)]*\))?$/i),s=t?t[1].trim().toLowerCase():e.toLowerCase(),a=t&&t[2]?parseInt(t[2],10):0;return{name:s,vol:Number.isFinite(a)?a:0}}function DR(n,e){const t=(n==null?void 0:n.Title)||(n==null?void 0:n.title)||"",s=(e==null?void 0:e.Title)||(e==null?void 0:e.title)||"",a=zv(t),l=zv(s),d=a.name.localeCompare(l.name);return d!==0?d:a.vol!==l.vol?a.vol-l.vol:t.localeCompare(s)}function Zh(){return{publisher:"",demographic:"",genre:"",subGenre:"",datePurchased:"",msrp:"",initialPublisher:"",initialDemographic:"",initialGenre:"",initialSubGenre:"",initialDatePurchased:"",initialMsrp:"",dateMixed:!1,readChecked:!1,readIndeterminate:!1}}function Bv(){return{read:!1,datePurchased:"",dateRead:"",pageCount:"",msrp:"",amountPaid:"",rating:"",special:!1,specialType:"",specialVolumes:"",collectiblePrice:""}}function $v(n,e={}){const t=e.ignoreShared,s=(n==null?void 0:n.amountPaid)??(n==null?void 0:n.AmountPaid)??(n==null?void 0:n.paid)??(n==null?void 0:n.Paid)??"",a=(n==null?void 0:n.msrp)??(n==null?void 0:n.MSRP)??"",l=((n==null?void 0:n.datePurchased)||(n==null?void 0:n.DatePurchased)||"").trim(),d=((n==null?void 0:n.publisher)||(n==null?void 0:n.Publisher)||"").trim(),f=((n==null?void 0:n.demographic)||(n==null?void 0:n.Demographic)||"").trim(),m=((n==null?void 0:n.genre)||(n==null?void 0:n.Genre)||"").trim(),v=((n==null?void 0:n.specialType)||(n==null?void 0:n.SpecialType)||"").trim(),w=(n==null?void 0:n.specialVolumes)??(n==null?void 0:n.SpecialVolumes)??(n==null?void 0:n.volumesContained)??"",S=(n==null?void 0:n.collectiblePrice)??(n==null?void 0:n.CollectiblePrice)??"",C=!!v,$=(n==null?void 0:n.pageCount)??(n==null?void 0:n.PageCount)??(n==null?void 0:n.pages)??(n==null?void 0:n.Pages)??"",X=$==null?"":String($).trim(),q=Number(X),U=!X||Number.isNaN(q)||q<=0;return!C&&(s===""||s===null)||U||!l||!t&&(a===""||!d||!f||!m)||C&&!v||C&&v.toLowerCase()==="collectible"&&(S===""||S===null)||C&&v.toLowerCase()==="specialedition"&&(w===""||w===null)}function VR(n){const e=(n==null?void 0:n.amountPaid)??"",t=((n==null?void 0:n.datePurchased)||"").trim(),s=!!(n!=null&&n.specialType)||!!(n!=null&&n.special),a=((n==null?void 0:n.specialType)||"").trim(),l=(n==null?void 0:n.specialVolumes)??"",d=(n==null?void 0:n.collectiblePrice)??"",f=(n==null?void 0:n.pageCount)??"",m=(n==null?void 0:n.msrp)??"",v=((n==null?void 0:n.publisher)||"").trim(),w=((n==null?void 0:n.demographic)||"").trim(),S=((n==null?void 0:n.genre)||"").trim(),C=!s&&(e===""||e===null),$=s&&!a,X=s&&a.toLowerCase()==="collectible"&&(d===""||d===null),q=s&&a.toLowerCase()==="specialedition"&&(l===""||l===null),U=(()=>{const ne=(f??"").toString().trim();if(ne==="")return!0;const xe=Number(ne);return Number.isNaN(xe)||xe<=0})();return{amountPaid:C,datePurchased:!t,specialType:$,collectiblePrice:X,specialVolumes:q,pageCount:U,msrp:m===""||m===null,publisher:!v,demographic:!w,genre:!S}}function LR(n){return!n||!n.books||!n.books.length?!1:n.books.some(e=>{const t=(e==null?void 0:e.msrp)??(e==null?void 0:e.MSRP)??"",s=((e==null?void 0:e.publisher)||(e==null?void 0:e.Publisher)||"").trim(),a=((e==null?void 0:e.demographic)||(e==null?void 0:e.Demographic)||"").trim(),l=((e==null?void 0:e.genre)||(e==null?void 0:e.Genre)||"").trim();return t===""||!s||!a||!l})}function OR(n){const e=new Map;for(const t of n){const s=hd(t)||t.id;if(!e.has(s)){const m=Zl(t.series||t.Series||t.title||t.Title||"Unknown Series")||"Unknown Series";e.set(s,{key:s,title:m,publisher:t.publisher||t.Publisher||"",genre:t.genre||t.Genre||"",demographic:t.demographic||t.Demographic||"",volumes:0,totalPages:0,readPages:0,readVolumes:0,ratingSum:0,ratingCount:0})}const a=e.get(s);a.volumes+=1;const l=Number(t.pages||t.Pages||t.pageCount||0)||0;a.totalPages+=l,(!!t.read||t.status==="Read"||t.Read===!0)&&(a.readVolumes+=1,a.readPages+=l);const f=Number(t.rating||t.Rating);!isNaN(f)&&f>0&&(a.ratingSum+=f,a.ratingCount+=1)}return e}function io(n,e,t=5){const s=new Map;for(const a of n.values()){const l=(a[e]||"").trim();if(!l)continue;const d=l.split(/[\/,]/).map(f=>f.trim()).filter(Boolean);for(const f of d)s.set(f,(s.get(f)||0)+1)}return[...s.entries()].sort((a,l)=>l[1]-a[1]).slice(0,t).map(([a,l])=>({name:a,count:l}))}function Wv(n,e){const t=Array.from({length:12},(s,a)=>{const l=new Date(e,a,1);return{key:`${e}-${a}`,label:l.toLocaleString("default",{month:"short"}),year:e,month:a,value:0}});for(const s of n){const a=Ta(s.dateRead||s.DateRead);!a||a.getFullYear()!==e||(t[a.getMonth()].value+=1)}return t}function wl(n){const e=n.getFullYear(),t=`${n.getMonth()+1}`.padStart(2,"0"),s=`${n.getDate()}`.padStart(2,"0");return`${e}-${t}-${s}`}async function ef(n,e){try{await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:e})})}catch(t){console.error("Webhook post failed",t)}}function MR(n){const e=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],t=Array(7).fill(0);for(const l of n){const d=Ta(l.dateRead||l.DateRead);d&&(t[d.getDay()]+=1)}if(!t.some(l=>l>0))return[];const a=t.reduce((l,d)=>Math.max(l,d),0)||1;return e.map((l,d)=>({label:l,value:t[d],pct:t[d]/a}))}function FR(n,e=8){const t=[...n.values()];t.sort((l,d)=>d.volumes-l.volumes);const s=t.slice(0,e),a=s.reduce((l,d)=>Math.max(l,d.volumes),0)||1;return s.map(l=>({label:l.title,value:l.volumes,pct:l.volumes/a}))}function UR(n){const e=[];for(const t of n){const s=Ta(t.releaseDate||t.ReleaseDate||t.date||t.Date)||null;if(!s)continue;const a=(t.title||t.series||t.Title||"Unknown Title").trim();e.push({date:s,title:a})}return e.sort((t,s)=>t.date-s.date),e}function zR(n){const e=new Date;for(const t of n)if(t.date>=e)return t;return n[n.length-1]||null}function BR(n){let e=0,t=0;for(const s of n){const a=Ta(s.datePurchased||s.DatePurchased),l=Ta(s.dateRead||s.DateRead);if(!a||!l)continue;const d=l-a;d<=0||(e+=d/(1e3*60*60*24),t+=1)}return t?e/t:null}function $R(n){const e=new Map;for(const t of n){const s=Ta(t.datePurchased||t.DatePurchased),a=Ta(t.dateRead||t.DateRead);if(!s||!a)continue;const l=a-s;if(l<=0)continue;const d=l/(1e3*60*60*24),f=hd(t)||t.id,m=Zl(t.series||t.Series||t.title||t.Title||"Untitled")||"Untitled";e.has(f)||e.set(f,{key:f,title:m,total:0,count:0,min:d,max:d});const v=e.get(f);v.total+=d,v.count+=1,v.min=Math.min(v.min,d),v.max=Math.max(v.max,d)}return[...e.values()].filter(t=>t.count>0).map(t=>({...t,avg:t.total/t.count})).sort((t,s)=>s.avg-t.avg)}function WR(n){let e=0,t=0,s=0;for(const a of n){const l=Number(a.msrp||a.MSRP||0)||0,d=Number(a.amountPaid||a.AmountPaid||a.pricePaid||0)||l||0,f=Number(a.collectiblePrice||a.CollectiblePrice||0)||0;e+=l,t+=d,s+=f}return{msrpTotal:e,paidTotal:t,collectibleTotal:s}}function GR(n){const e=new Map;for(const t of n){const s=hd(t)||t.id;if(!e.has(s)){const S=t.series||t.Series||t.title||t.Title||"Untitled";e.set(s,{key:s,title:Zl(S)||S.trim()||"Untitled",msrp:0,paid:0,collectible:0,books:0,pages:0,readPages:0,ratings:[]})}const a=e.get(s);a.books+=1;const l=Number(t.msrp||t.MSRP||0)||0,d=Number(t.amountPaid||t.AmountPaid||t.pricePaid||0)||0,f=Number(t.collectiblePrice||t.CollectiblePrice||0)||0,m=Number(t.pages||t.Pages||t.pageCount||0)||0,v=!!t.read||t.status==="Read"||t.Read===!0;a.msrp+=l,a.paid+=d,a.collectible+=f,a.pages+=m,v&&(a.readPages+=m);const w=Number(t.rating||t.Rating);!isNaN(w)&&w>0&&a.ratings.push(w)}return[...e.values()]}function HR(n){let e=0,t=0;for(const s of n){const a=Number(s.pages||s.Pages||s.pageCount||0)||0;e+=a,(!!s.read||s.status==="Read"||s.Read===!0)&&(t+=a)}return{total:e,read:t}}function qR(n){let e=0,t=0;for(const s of n.values())s.ratingCount>0&&(e+=s.ratingSum/s.ratingCount,t+=1);return t?e/t:null}function KR({data:n}){if(!n||!n.length)return c.jsx("div",{className:"line-chart empty",children:"No reading data yet."});const e=n.reduce((v,w)=>Math.max(v,w.value),0)||1,t=480,s=230,a=30,l=s-a*2,d=t/Math.max(n.length-1,1),f=n.map((v,w)=>{const S=w*d,C=s-a-v.value/e*l;return{...v,x:S,y:C}}),m=f.map((v,w)=>w===0?`M ${v.x} ${v.y}`:`L ${v.x} ${v.y}`).join(" ");return c.jsx("div",{className:"line-chart",children:c.jsxs("svg",{viewBox:`0 0 ${t} ${s}`,width:"100%",height:"100%",preserveAspectRatio:"xMidYMid meet",children:[[0,.25,.5,.75,1].map((v,w)=>{const S=s-a-v*l;return c.jsx("line",{className:"line-grid",x1:"0",x2:t,y1:S,y2:S},`h-${w}`)}),f.map((v,w)=>c.jsx("line",{className:"line-grid",x1:v.x,x2:v.x,y1:a/2,y2:s-a/2},`v-${w}`)),c.jsx("path",{className:"line-path",d:m}),f.map((v,w)=>c.jsxs("g",{children:[c.jsx("circle",{className:"line-point",cx:v.x,cy:v.y,r:"1.5"}),c.jsx("text",{className:"line-value",x:v.x,y:v.y-3,children:v.value}),c.jsx("text",{className:"line-label",x:v.x,y:s-4,children:v.label})]},w))]})})}function QR({data:n}){return!n||!n.length?c.jsx("div",{className:"weekday-breakdown empty",children:"No reads recorded yet."}):c.jsx("div",{className:"weekday-bars",children:n.map(e=>c.jsxs("div",{className:"weekday-col",children:[c.jsx("div",{className:"weekday-count",children:e.value}),c.jsx("div",{className:"weekday-bar-vert",children:c.jsx("div",{className:"weekday-bar-vert-fill",style:{height:`${Math.max(e.pct*100,e.value?6:0)}%`}})}),c.jsx("div",{className:"weekday-label",children:e.label})]},e.label))})}function YR(n,e,t){const s=n.getFullYear(),a=n.getMonth(),d=new Date(s,a,1).getDay(),f=new Date(s,a+1,0).getDate(),m=new Map;for(const S of e){const C=S.date;if(C.getFullYear()===s&&C.getMonth()===a){const $=C.getDate();m.has($)||m.set($,[]),m.get($).push(S)}}const v=[];for(let S=0;S<d;S++)v.push({type:"pad"});for(let S=1;S<=f;S++){const C=wl(new Date(s,a,S));v.push({type:"day",day:S,releases:m.get(S)||[],dateKey:C,isToday:C===t})}const w=Math.ceil(v.length/7)*7;for(;v.length<w;)v.push({type:"pad"});return v}function JR(){const{user:n,admin:e,loading:t}=jo(),[s,a]=D.useState([]),[l,d]=D.useState([]),[f,m]=D.useState(!0),[v,w]=D.useState(null),[S,C]=D.useState("-"),[$,X]=D.useState({yearly:dl,release:hl,activity:fl}),[q,U]=D.useState(new Set),[ne,xe]=D.useState(null),[ge,ye]=D.useState(null),[ie,Ee]=D.useState(new Set),[k,P]=D.useState(null),[R,M]=D.useState(""),B=D.useRef(null),[V,b]=D.useState(()=>Zh()),[he,ve]=D.useState(()=>Bv()),[ot,Ve]=D.useState([]),[pe,be]=D.useState(!1),[Te,A]=D.useState([]),[N,se]=D.useState(!1),[ee,_e]=D.useState([]),[me,Ae]=D.useState(!1),[Me,Qe]=D.useState(""),[xt,te]=D.useState(null),[Fe,Be]=D.useState(null),We=async()=>{if(e)try{se(!0);const L=(await Gs(rr(tt,"users"))).docs.map(F=>({uid:F.id,...F.data()}));A(L)}catch(T){console.error("Failed to load users",T)}finally{se(!1)}},Et=async(T,L)=>{const F=(T||"").trim();if(!F){alert("UID is required.");return}try{await Ks(Pt(tt,"users",F),{role:L,updatedBy:(n==null?void 0:n.uid)||"manual",updatedAt:new Date().toISOString()},{merge:!0}),await We()}catch(oe){console.error("Failed to update role",oe),alert("Failed to update role.")}},[wt,pt]=D.useState(!1),[Tt,Ut]=D.useState(()=>new Date),[It,In]=D.useState({open:!1,type:null}),gn=new Date().getFullYear(),qn=D.useRef(null),yn=D.useRef(null);D.useEffect(()=>{document.title="Dashboard"},[]),D.useEffect(()=>(wt||It.open||pe||!!Fe?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[wt,It.open,pe,Fe]),D.useEffect(()=>{typeof window>"u"||(qn.current=localStorage.getItem("dashboard-yearly-posted"),yn.current=localStorage.getItem("dashboard-release-posted"))},[]),D.useEffect(()=>{if(!e)return;const T=Pt(tt,"settings","webhooks");(async()=>{try{const L=await kp(T);if(L.exists()){const F=L.data();X({yearly:F.yearly||dl,release:F.release||hl,activity:F.activity||fl})}else await Ks(T,{yearly:dl,release:hl,activity:fl}),X({yearly:dl,release:hl,activity:fl})}catch(L){console.error("Failed to load webhook settings",L)}})()},[e]),D.useEffect(()=>{if(!e)return;let T=!1;return(async()=>await We())(),()=>{T=!0}},[e]),D.useEffect(()=>{let T=!1;if(!n||!e){_e([]),Qe("");return}return(async()=>{try{Ae(!0);const F=(await Gs(rr(tt,"suggestions"))).docs.map(oe=>{var Re;const Pe=oe.data();let ze=null;if((Re=Pe==null?void 0:Pe.createdAt)!=null&&Re.toDate)ze=Pe.createdAt.toDate();else if(Pe!=null&&Pe.createdAt){const Ze=new Date(Pe.createdAt);ze=isNaN(Ze.getTime())?null:Ze}return{id:oe.id,...Pe,createdAt:ze}});F.sort((oe,Pe)=>{var ze,Re,Ze,ct;return(((Re=(ze=Pe.createdAt)==null?void 0:ze.getTime)==null?void 0:Re.call(ze))||0)-(((ct=(Ze=oe.createdAt)==null?void 0:Ze.getTime)==null?void 0:ct.call(Ze))||0)}),T||(_e(F),Qe(""))}catch(L){console.error("Failed to load suggestions",L),T||(Qe("Failed to load suggestions."),_e([]))}finally{T||Ae(!1)}})(),()=>{T=!0}},[n,e]);const sr=async T=>{if(!(!e||!T))try{await pa(Pt(tt,"suggestions",T)),_e(L=>L.filter(F=>F.id!==T))}catch(L){console.error("Failed to delete suggestion",L),Qe("Failed to delete suggestion.")}};D.useEffect(()=>{let T=!1;async function L(){if(!n||!e){a([]),d([]),w(null),m(!1);return}try{m(!0);const[F,oe]=await Promise.all([Gs(rr(tt,"library")),Gs(rr(tt,"wishlist"))]);if(T)return;a(F.docs.map(Pe=>({id:Pe.id,...Pe.data()}))),d(oe.docs.map(Pe=>({id:Pe.id,...Pe.data()}))),w(null)}catch(F){console.error(F),T||w("Failed to load dashboard data.")}finally{T||m(!1)}}return L(),()=>{T=!0}},[n,e]);const Lt=D.useMemo(()=>{const T=s.length,L=s.filter(ds=>!!ds.read||ds.status==="Read"||ds.Read===!0).length,F=T-L,oe=T?Math.round(L/T*100):0,Pe=l.length,ze=OR(s),Re=Wv(s,gn),Ze=Wv(s,gn-1),ct=Re.reduce((ds,Pa)=>ds+Pa.value,0),vt=MR(s),cn=FR(ze),Nt=UR(l),Ot=zR(Nt),zt=BR(s),it=WR(s),Zn=HR(s),nt=qR(ze),Mn=$R(s),rt=io(ze,"publisher",5),us=io(ze,"genre",5),ba=io(ze,"demographic",5),ii=GR(s);return{totalLibrary:T,readCount:L,unreadCount:F,readPct:oe,wishlistCount:Pe,seriesMap:ze,monthlyReads:Re,prevYearReads:Ze,currentYearReadsTotal:ct,weekdayBreakdown:vt,topSeriesBars:cn,releases:Nt,nextRelease:Ot,avgDays:zt,purchaseToReadSeries:Mn,collectionValue:it,pages:Zn,avgRating:nt,topPublishers:rt,topGenres:us,topDemographics:ba,seriesAggregates:ii}},[s,l,gn]),{totalLibrary:bt,readCount:yr,unreadCount:ss,readPct:Vn,wishlistCount:an,seriesMap:ir,monthlyReads:is,prevYearReads:mt,currentYearReadsTotal:as,weekdayBreakdown:As,topSeriesBars:ri,releases:on,nextRelease:Cn,avgDays:ar,purchaseToReadSeries:Yt,collectionValue:Ht,pages:ln,avgRating:vn,topPublishers:os,topGenres:yt,topDemographics:ls,seriesAggregates:Kn}=Lt,Ln=Cn?Cn.date:null,Rt=!!v,Jt=D.useMemo(()=>{if(!s||!s.length)return[];const T=new Map;s.forEach(F=>{const oe=hd(F)||F.id,Pe=jR(F);T.has(oe)||T.set(oe,{seriesKey:oe,displayName:Pe,books:[]}),T.get(oe).books.push(F)});const L=Array.from(T.values()).map(F=>({...F,books:[...F.books].sort(DR)}));return L.sort((F,oe)=>F.displayName.localeCompare(oe.displayName)),L},[s]),On=D.useMemo(()=>Jt.flatMap(T=>T.books.map(L=>L.id)),[Jt]);D.useEffect(()=>{ge&&(s.some(T=>T.id===ge)||ye(null))},[s,ge]),D.useEffect(()=>{ne&&(Jt.some(T=>T.seriesKey===ne)||xe(null))},[Jt,ne]),D.useEffect(()=>{if(!ie.size)return;const T=new Set(s.map(F=>F.id)),L=Array.from(ie).filter(F=>!T.has(F));L.length&&Ee(F=>{const oe=new Set(F);return L.forEach(Pe=>oe.delete(Pe)),oe})},[s,ie]),D.useEffect(()=>{const T=Array.from(ie);if(!T.length){M("");return}const L=Array.from(new Set(T.map(F=>s.find(oe=>oe.id===F)).filter(Boolean).map(F=>{const oe=F.amountPaid??F.AmountPaid??"";return oe==null?"":String(oe)})));M(L.length===1?L[0]:"")},[ie,s]),D.useEffect(()=>{const T=Jt.find(it=>it.seriesKey===ne);if(!T){b(Zh());return}const L=T.books,F=it=>{const Zn=Array.from(new Set(L.map(nt=>{const Mn=it(nt);return Mn==null?"":String(Mn).trim()})));return Zn.length===1?Zn[0]:""},oe=F(it=>it.publisher||it.Publisher),Pe=F(it=>it.demographic||it.Demographic),ze=F(it=>it.genre||it.Genre),Re=F(it=>it.subGenre||it.SubGenre),Ze=F(it=>it.msrp??it.MSRP),ct=Array.from(new Set(L.map(it=>(it.datePurchased||it.DatePurchased||"").trim()).filter(Boolean))),vt=ct.length>1,cn=vt?"":ct[0]||"",Nt=L.filter(it=>!!it.read||it.status==="Read"||it.Read===!0).length,Ot=Nt===L.length&&L.length>0;b({publisher:oe,demographic:Pe,genre:ze,subGenre:Re,datePurchased:cn,msrp:Ze,initialPublisher:oe,initialDemographic:Pe,initialGenre:ze,initialSubGenre:Re,initialDatePurchased:cn,initialMsrp:Ze,dateMixed:vt,readChecked:Ot,readIndeterminate:!Ot&&!(Nt===0)})},[Jt,ne]),D.useEffect(()=>{B.current&&(B.current.indeterminate=V.readIndeterminate)},[V.readIndeterminate]),D.useEffect(()=>{const T=s.find(F=>F.id===ge);if(!T){ve(Bv());return}const L=!!T.read||T.status==="Read"||T.Read===!0;ve({read:L,datePurchased:T.datePurchased||T.DatePurchased||"",dateRead:L&&(T.dateRead||T.DateRead)||"",pageCount:T.pageCount??T.PageCount??T.pages??T.Pages??"",msrp:T.msrp??T.MSRP??"",amountPaid:T.amountPaid??T.AmountPaid??"",rating:L?T.rating??T.Rating??"":"",special:!!(T.specialType||T.SpecialType),specialType:T.specialType??T.SpecialType??"",specialVolumes:T.specialVolumes??T.SpecialVolumes??"",collectiblePrice:T.collectiblePrice??T.CollectiblePrice??"",publisher:T.publisher||T.Publisher||"",demographic:T.demographic||T.Demographic||"",genre:T.genre||T.Genre||""})},[ge,s]),D.useEffect(()=>{if(!mt||!mt.length)return;const T=gn-1,L=mt.reduce((ze,Re)=>ze+Re.value,0);if(!L||(qn.current?parseInt(qn.current,10):null)===T)return;const oe=mt.map(ze=>`${ze.label}: ${ze.value}`).join(", "),Pe=`Yearly reads summary for ${T}: ${L} total. Breakdown: ${oe}`;ef($.yearly,Pe).then(()=>{qn.current=String(T),typeof window<"u"&&localStorage.setItem("dashboard-yearly-posted",String(T))})},[mt,gn]),D.useEffect(()=>{if(!Cn||!on.length)return;const T=wl(Cn.date),L=wl(new Date);if(T>L||yn.current===T)return;const F=on.filter(Pe=>wl(Pe.date)===T);if(!F.length)return;const oe=`Wishlist releases for ${T}:
${F.map(Pe=>`- ${Pe.title}`).join(`
`)}`;ef($.release,oe).then(()=>{yn.current=T,typeof window<"u"&&localStorage.setItem("dashboard-release-posted",T)})},[Cn,on]),D.useEffect(()=>{if(!Ln){C("-");return}const T=()=>{const F=Ln-new Date;if(F<=0){C("Released");return}const oe=Math.floor(F/1e3),Pe=Math.floor(oe/86400),ze=Math.floor(oe%86400/3600).toString().padStart(2,"0"),Re=Math.floor(oe%3600/60).toString().padStart(2,"0"),Ze=Math.floor(oe%60).toString().padStart(2,"0");C(`${Pe}d ${ze}:${Re}:${Ze}`)};T();const L=setInterval(T,1e3);return()=>clearInterval(L)},[Ln]),D.useEffect(()=>{if(!(typeof window>"u"))try{const T=localStorage.getItem(Uv);if(!T)return;const L=JSON.parse(T);if(!Array.isArray(L))return;const F=L.map(oe=>({message:oe.message,ts:oe.ts?new Date(oe.ts):new Date})).filter(oe=>oe.message);F.length&&Ve(F)}catch(T){console.warn("Failed to load activity log",T)}},[]);const vr=async()=>{try{const T=await Gs(rr(tt,"library"));a(T.docs.map(L=>({id:L.id,...L.data()})))}catch(T){console.error("Failed to refresh library",T),w(L=>L||"Failed to refresh library data.")}},_n=T=>{const L=(T??"").toString().trim();if(L==="")return"";const F=parseFloat(L);return Number.isFinite(F)?F:""},Qn=T=>{const L=(T??"").toString().trim();if(L==="")return"";const F=parseInt(L,10);return Number.isFinite(F)?F:""},bn=T=>{try{const L=T.slice(0,100).map(F=>({message:F.message,ts:F.ts instanceof Date?F.ts.toISOString():F.ts}));typeof window<"u"&&localStorage.setItem(Uv,JSON.stringify(L))}catch(L){console.warn("Failed to persist activity log",L)}},Cr=T=>{if(!T)return;const L={message:T,ts:new Date};Ve(Pe=>{const ze=[L,...Pe].slice(0,100);return bn(ze),ze});const F=(n==null?void 0:n.email)||"anonymous",oe=`Activity: ${T}
User: ${F}
Time: ${new Date().toLocaleString()}`;ef($.activity,oe).catch(Pe=>console.warn("Activity webhook failed",Pe))},Qi=T=>{U(L=>{const F=new Set(L);return F.has(T)?F.delete(T):F.add(T),F}),xe(T),ye(null)},Fr=(T,L,F)=>{const oe=T.metaKey||T.ctrlKey,Pe=T.shiftKey,ze=On.indexOf(L);let Re=new Set(ie);if(Pe&&k!==null&&ze!==-1){const Ze=Math.min(k,ze),ct=Math.max(k,ze);for(let vt=Ze;vt<=ct;vt+=1){const cn=On[vt];cn&&Re.add(cn)}}else oe?Re.has(L)?Re.delete(L):Re.add(L):Re=new Set;Ee(Re),P(ze),ye(L),xe(F),U(Ze=>{const ct=new Set(Ze);return ct.add(F),ct})},cs=()=>{Ee(new Set),P(null)},Yn=async()=>{if(!e){alert("Dashboard is read-only for your account.");return}const T=Array.from(ie);if(!T.length){alert("Select books in Library Manager (use Ctrl/Cmd or Shift) before bulk editing.");return}const L=(R||"").toString().trim(),F=L!=="",oe=_n(L);if(F&&oe===""){alert("Enter a valid number for Amount Paid.");return}try{await Promise.all(T.map(Pe=>Es(Pt(tt,"library",Pe),{amountPaid:F?oe:""}))),await vr(),cs(),Cr(`Updated amount paid for ${T.length} book${T.length===1?"":"s"} in library`),alert(`Applied Amount Paid to ${T.length} selection${T.length===1?"":"s"}.`)}catch(Pe){console.error("Failed to apply Amount Paid",Pe),alert("Failed to apply Amount Paid to selection.")}},Ur=async()=>{if(!e){alert("Dashboard is read-only for your account.");return}const T=Jt.find(Nt=>Nt.seriesKey===ne);if(!T||!T.books.length)return;const L=!V.readIndeterminate,F=!!V.readChecked,oe=V.datePurchased!==V.initialDatePurchased,Pe=V.msrp!==V.initialMsrp,ze=V.publisher!==V.initialPublisher,Re=V.demographic!==V.initialDemographic,Ze=V.genre!==V.initialGenre,ct=V.subGenre!==V.initialSubGenre;if(!L&&!oe&&!Pe&&!ze&&!Re&&!Ze&&!ct)return;const vt=String(V.msrp??"").trim(),cn=Pe?_n(vt):"";if(Pe&&vt!==""&&cn===""){alert("Enter a valid number for MSRP.");return}try{const Nt=[];if(T.books.forEach(Ot=>{const zt={};L&&(zt.read=F,zt.dateRead=F?Ot.dateRead||Ot.DateRead||new Date().toISOString().slice(0,10):""),oe&&(zt.datePurchased=V.datePurchased||""),Pe&&(zt.msrp=V.msrp===""?"":cn),ze&&(zt.publisher=V.publisher||""),Re&&(zt.demographic=V.demographic||""),Ze&&(zt.genre=V.genre||""),ct&&(zt.subGenre=V.subGenre||""),Object.keys(zt).length&&Nt.push(Es(Pt(tt,"library",Ot.id),zt))}),!Nt.length)return;await Promise.all(Nt),await vr(),ye(null),Cr(`Updated series "${T.displayName||"Series"}" (${T.books.length} book${T.books.length===1?"":"s"})`),alert("Series updated.")}catch(Nt){console.error("Failed to save series changes",Nt),alert("Failed to update series.")}},Jn=async()=>{if(!e){alert("Dashboard is read-only for your account.");return}if(!ge)return;const T=!!he.read,L=String(he.msrp??"").trim(),F=String(he.amountPaid??"").trim(),oe=String(he.pageCount??"").trim(),Pe=String(he.rating??"").trim(),ze=_n(L),Re=_n(F),Ze=Qn(oe),ct=_n(Pe);if(L!==""&&ze===""){alert("Enter a valid number for MSRP.");return}if(F!==""&&Re===""){alert("Enter a valid number for Amount Paid.");return}if(oe!==""&&Ze===""){alert("Enter a valid page count.");return}if(T&&Pe!==""&&ct===""){alert("Enter a valid rating.");return}const vt=!!he.special,cn=Qn(he.specialVolumes),Nt=_n(he.collectiblePrice),Ot=String(he.specialVolumes??"").trim(),zt=String(he.collectiblePrice??"").trim();if(vt&&he.specialType==="specialEdition"&&Ot!==""&&cn===""){alert("Enter a valid number for volumes contained.");return}if(vt&&he.specialType==="collectible"&&zt!==""&&Nt===""){alert("Enter a valid collectible price.");return}const it=T?he.dateRead||new Date().toISOString().slice(0,10):"",Zn={read:T,datePurchased:he.datePurchased||"",dateRead:it,msrp:he.msrp===""?"":ze,amountPaid:he.amountPaid===""?"":Re,pageCount:he.pageCount===""?"":Ze,rating:T?he.rating===""?"":ct:"",specialType:vt&&he.specialType||"",specialVolumes:vt&&he.specialType==="specialEdition"?he.specialVolumes===""?"":cn:"",collectiblePrice:vt&&he.specialType==="collectible"?he.collectiblePrice===""?"":Nt:""};try{await Es(Pt(tt,"library",ge),Zn),await vr();const nt=s.find(rt=>rt.id===ge)||lt,Mn=(nt==null?void 0:nt.Title)||(nt==null?void 0:nt.title)||"Untitled";Cr(`Updated "${Mn}" in library`),alert("Saved changes.")}catch(nt){console.error("Failed to save book changes",nt),alert("Failed to save changes.")}},si=()=>{xe(null),ye(null),cs(),b(Zh())},ks=()=>{ye(null),P(null)},zr=Jt.find(T=>T.seriesKey===ne)||null,lt=s.find(T=>T.id===ge)||null,Xn=ne?{msrp:!V.msrp,datePurchased:!V.datePurchased&&!V.dateMixed,publisher:!V.publisher,demographic:!V.demographic,genre:!V.genre}:{},Xt=ge?VR({amountPaid:he.amountPaid,msrp:he.msrp,datePurchased:he.datePurchased,publisher:(lt==null?void 0:lt.publisher)||(lt==null?void 0:lt.Publisher)||"",demographic:(lt==null?void 0:lt.demographic)||(lt==null?void 0:lt.Demographic)||"",genre:(lt==null?void 0:lt.genre)||(lt==null?void 0:lt.Genre)||"",special:he.special,specialType:he.specialType,specialVolumes:he.specialVolumes,collectiblePrice:he.collectiblePrice,pageCount:he.pageCount}):{};if(t)return c.jsx("div",{className:"page dashboard-page",children:c.jsxs("div",{className:"dashboard-loading",children:[c.jsx("h1",{children:"Dashboard"}),c.jsx("p",{children:"Checking permissions..."})]})});if(!n||!e)return c.jsx("div",{className:"page dashboard-page",children:c.jsxs("div",{className:"dashboard-locked",children:[c.jsx("h1",{children:"Dashboard"}),c.jsx("p",{children:"This area is restricted to admin accounts."})]})});if(f)return c.jsx("div",{className:"page dashboard-page",children:c.jsxs("div",{className:"dashboard-loading",children:[c.jsx("h1",{children:"Dashboard"}),v?c.jsx("p",{className:"error",children:v}):c.jsx("p",{children:"Loading stats..."})]})});const E=bt+an,H=E?Math.round(bt/E*100):0,Y=[...ir.values()].filter(T=>T.ratingCount>0).map(T=>({title:T.title,avg:T.ratingSum/T.ratingCount,count:T.ratingCount})).sort((T,L)=>L.avg-T.avg||L.count-T.count).slice(0,3);function O(){if(Ln)Ut(new Date(Ln.getFullYear(),Ln.getMonth(),1));else if(on.length){const T=on[0].date;Ut(new Date(T.getFullYear(),T.getMonth(),1))}pt(!0)}function W(T){In({open:!0,type:T})}function ce(){In({open:!1,type:null})}const Ie=wl(new Date),Je=YR(Tt,on,Ie);function Ce(){const T=It.type;if(!T)return null;if(T==="publishers"){const L=[...io(ir,"publisher",100)];return c.jsxs(c.Fragment,{children:[c.jsx("h3",{children:"Top Publishers by Series"}),L.length===0?c.jsx("p",{children:"No publisher data yet."}):c.jsxs("table",{children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"#"}),c.jsx("th",{children:"Publisher"}),c.jsx("th",{children:"Series Count"})]})}),c.jsx("tbody",{children:L.map((F,oe)=>c.jsxs("tr",{children:[c.jsx("td",{children:oe+1}),c.jsx("td",{children:F.name}),c.jsx("td",{children:F.count})]},F.name+oe))})]})]})}if(T==="genres"){const L=[...io(ir,"genre",100)];return c.jsxs(c.Fragment,{children:[c.jsx("h3",{children:"Top Genres by Series"}),L.length===0?c.jsx("p",{children:"No genre data yet."}):c.jsxs("table",{children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"#"}),c.jsx("th",{children:"Genre"}),c.jsx("th",{children:"Series Count"})]})}),c.jsx("tbody",{children:L.map((F,oe)=>c.jsxs("tr",{children:[c.jsx("td",{children:oe+1}),c.jsx("td",{children:F.name}),c.jsx("td",{children:F.count})]},F.name+oe))})]})]})}if(T==="demographics"){const L=[...io(ir,"demographic",100)];return c.jsxs(c.Fragment,{children:[c.jsx("h3",{children:"Top Demographics by Series"}),L.length===0?c.jsx("p",{children:"No demographic data yet."}):c.jsxs("table",{children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"#"}),c.jsx("th",{children:"Demographic"}),c.jsx("th",{children:"Series Count"})]})}),c.jsx("tbody",{children:L.map((F,oe)=>c.jsxs("tr",{children:[c.jsx("td",{children:oe+1}),c.jsx("td",{children:F.name}),c.jsx("td",{children:F.count})]},F.name+oe))})]})]})}if(T==="timeToRead"){const L=Yt||[];return c.jsxs(c.Fragment,{children:[c.jsx("h3",{children:"Average Time From Purchase to Read"}),ar==null?c.jsx("p",{children:"Not enough volumes have both purchase and read dates to calculate this yet."}):c.jsxs(c.Fragment,{children:[c.jsxs("p",{children:["On average, it takes"," ",c.jsxs("strong",{children:[ar.toFixed(1)," days"]})," from purchase to finishing a volume."]}),L.length>0?c.jsxs("table",{children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"Series"}),c.jsx("th",{children:"Avg Days"}),c.jsx("th",{children:"Longest"}),c.jsx("th",{children:"Shortest"}),c.jsx("th",{children:"Reads Count"})]})}),c.jsx("tbody",{children:L.map(F=>c.jsxs("tr",{children:[c.jsx("td",{children:F.title}),c.jsxs("td",{children:[F.avg.toFixed(1)," days"]}),c.jsxs("td",{children:[Math.round(F.max)," days"]}),c.jsxs("td",{children:[Math.round(F.min)," days"]}),c.jsx("td",{children:F.count})]},F.key))})]}):c.jsx("p",{style:{marginTop:8},children:"No series-level data yet."})]})]})}if(T==="collectionValue"){const{msrpTotal:L,paidTotal:F}=Ht,oe=L-F,Pe=L>0?(F/L*100).toFixed(1):"-",ze=[...Kn].filter(Re=>Re.msrp||Re.paid||Re.collectible).sort((Re,Ze)=>Ze.msrp+Ze.collectible-(Re.msrp+Re.collectible));return c.jsxs(c.Fragment,{children:[c.jsx("h3",{children:"Collection Value Breakdown"}),c.jsx("table",{children:c.jsxs("tbody",{children:[c.jsxs("tr",{children:[c.jsx("th",{children:"Total MSRP"}),c.jsxs("td",{children:["$",L.toFixed(2)]})]}),c.jsxs("tr",{children:[c.jsx("th",{children:"Total Paid"}),c.jsxs("td",{children:["$",F.toFixed(2)]})]}),c.jsxs("tr",{children:[c.jsx("th",{children:"Difference"}),c.jsxs("td",{children:["$",oe.toFixed(2)]})]}),c.jsxs("tr",{children:[c.jsx("th",{children:"Paid vs MSRP"}),c.jsx("td",{children:Pe==="-"?"-":`${Pe}%`})]})]})}),ze.length>0&&c.jsxs(c.Fragment,{children:[c.jsx("h4",{style:{marginTop:"14px"},children:"Collection Pricing"}),c.jsxs("table",{children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"Title"}),c.jsx("th",{children:"MSRP"}),c.jsx("th",{children:"Paid"}),c.jsx("th",{children:"Collectible"}),c.jsx("th",{children:"Books"})]})}),c.jsx("tbody",{children:ze.map((Re,Ze)=>c.jsxs("tr",{children:[c.jsx("td",{children:Re.title}),c.jsxs("td",{children:["$",Re.msrp.toFixed(2)]}),c.jsxs("td",{children:["$",Re.paid.toFixed(2)]}),c.jsx("td",{children:Re.collectible?`$${Re.collectible.toFixed(2)}`:"--"}),c.jsx("td",{children:Re.books})]},Re.title+Ze))})]})]})]})}if(T==="pages"){const L=[...Kn].filter(F=>F.pages>0).map(F=>({...F,pct:F.pages?Math.round(F.readPages/F.pages*100):0})).sort((F,oe)=>oe.pages-F.pages);return c.jsxs(c.Fragment,{children:[c.jsx("h3",{children:"Pages Read vs Total"}),c.jsx("table",{children:c.jsxs("tbody",{children:[c.jsxs("tr",{children:[c.jsx("th",{children:"Total Pages"}),c.jsx("td",{children:ln.total.toLocaleString()})]}),c.jsxs("tr",{children:[c.jsx("th",{children:"Pages Read"}),c.jsx("td",{children:ln.read.toLocaleString()})]}),c.jsxs("tr",{children:[c.jsx("th",{children:"Completion"}),c.jsx("td",{children:ln.total?`${(ln.read/ln.total*100).toFixed(1)}%`:"-"})]})]})}),L.length>0&&c.jsxs(c.Fragment,{children:[c.jsx("h4",{style:{marginTop:"14px"},children:"Pages by Series"}),c.jsxs("table",{children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"Title"}),c.jsx("th",{children:"Read Pages"}),c.jsx("th",{children:"Total Pages"}),c.jsx("th",{children:"% Read"}),c.jsx("th",{children:"Books"})]})}),c.jsx("tbody",{children:L.map((F,oe)=>c.jsxs("tr",{children:[c.jsx("td",{children:F.title}),c.jsx("td",{children:F.readPages.toLocaleString()}),c.jsx("td",{children:F.pages.toLocaleString()}),c.jsxs("td",{children:[F.pct,"%"]}),c.jsx("td",{children:F.books})]},F.title+oe))})]})]})]})}if(T==="ratings"){const L=[...Kn].map(F=>{if(!F.ratings.length)return null;const oe=F.ratings.reduce((Pe,ze)=>Pe+ze,0)/F.ratings.length;return{title:F.title,avg:oe,count:F.ratings.length}}).filter(Boolean).sort((F,oe)=>oe.avg-F.avg||oe.count-F.count);return c.jsxs(c.Fragment,{children:[c.jsx("h3",{children:"Ratings Overview"}),vn==null?c.jsx("p",{children:"No ratings have been recorded yet."}):c.jsxs("p",{children:["Average series rating across rated series is"," ",c.jsx("strong",{children:vn.toFixed(2)}),"."]}),L.length>0&&c.jsxs(c.Fragment,{children:[c.jsx("h4",{style:{marginTop:"14px"},children:"Series Averages"}),c.jsxs("table",{children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"Title"}),c.jsx("th",{children:"Avg"}),c.jsx("th",{children:"Ratings"})]})}),c.jsx("tbody",{children:L.map((F,oe)=>c.jsxs("tr",{children:[c.jsx("td",{children:F.title}),c.jsx("td",{children:F.avg.toFixed(2)}),c.jsx("td",{children:F.count})]},F.title+oe))})]})]})]})}return T==="releases"?c.jsxs(c.Fragment,{children:[c.jsx("h3",{children:"Wishlist Releases"}),on.length===0?c.jsx("p",{children:"No wishlist releases found."}):c.jsxs("table",{children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"Date"}),c.jsx("th",{children:"Title"})]})}),c.jsx("tbody",{children:on.map((L,F)=>c.jsxs("tr",{children:[c.jsx("td",{children:L.date.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}),c.jsx("td",{children:L.title})]},F))})]})]}):null}return c.jsxs("div",{className:"page dashboard-page",children:[c.jsxs("header",{className:"dashboard-header",style:{display:"flex",alignItems:"center",justifyContent:"center",position:"relative",textAlign:"center",width:"100%"},children:[c.jsxs("div",{style:{textAlign:"center",margin:"0 auto",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"0 60px"},children:[c.jsx("h1",{style:{margin:0,fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Dashboard"}),c.jsx("p",{className:"dashboard-sub",style:{textAlign:"center",margin:"6px 0 0"},children:"My Entire Statistics dashboard for my Manga. I still use Excel though."})]}),e&&c.jsx("div",{style:{position:"absolute",right:0,top:"50%",transform:"translateY(-50%)"},children:c.jsx("button",{className:"stat-link",onClick:()=>be(!0),type:"button",children:"Admin Settings"})})]}),c.jsx("section",{id:"dashboardSection",className:"page-section active",children:c.jsxs("div",{className:"dashboard-grid",children:[c.jsxs("div",{className:"stat-stack",children:[c.jsxs("div",{className:"stat-card mini",children:[c.jsx("h3",{children:"Total Library Books"}),c.jsx("div",{className:"stat-value",children:bt}),c.jsx("div",{className:"stat-sub",children:"Volumes in your library."})]}),c.jsxs("div",{className:"stat-card mini",children:[c.jsx("h3",{children:"Wishlist Items"}),c.jsx("div",{className:"stat-value",children:an}),c.jsx("div",{className:"stat-sub",children:"Tracked upcoming wants."})]})]}),c.jsxs("div",{className:"stat-card",children:[c.jsx("h3",{children:"Read / Unread"}),c.jsx("div",{className:"pie",style:{"--pct":`${Vn*3.6}deg`},children:c.jsxs("div",{className:"pie-label",children:[Vn,"%"]})}),c.jsxs("div",{className:"stat-value",children:[yr," read / ",ss," unread"]})]}),c.jsxs("div",{className:"stat-card clickable",onClick:()=>W("ratings"),children:[c.jsx("h3",{children:"Ratings"}),c.jsx("div",{className:"stat-value",children:vn==null?"-":vn.toFixed(2)}),c.jsx("div",{className:"stat-sub",children:"Average across rated series."}),c.jsx("div",{className:"stat-list compact",children:Y.length?Y.map((T,L)=>c.jsxs("div",{className:"stat-list-row",children:[c.jsx("span",{className:"stat-rank",children:L+1}),c.jsx("span",{className:"stat-name",children:T.title}),c.jsx("span",{className:"stat-count",children:T.avg.toFixed(2)})]},T.title+L)):c.jsx("div",{className:"stat-sub",children:"No ratings yet."})})]}),c.jsxs("div",{className:"stat-card clickable",onClick:()=>W("pages"),children:[c.jsx("h3",{children:"Page Count Read / Total"}),c.jsxs("div",{className:"stat-value",children:[ln.read.toLocaleString()," / ",ln.total.toLocaleString()]}),c.jsx("div",{className:"stat-sub",children:ln.total?`${(ln.read/ln.total*100).toFixed(1)}% read`:"-"})]}),c.jsxs("div",{className:"stat-card",children:[c.jsx("h3",{children:"Library vs Wishlist"}),c.jsx("div",{className:"pie",style:{"--pct":`${H*3.6}deg`},children:c.jsxs("div",{className:"pie-label",children:[H,"%"]})}),c.jsxs("div",{className:"stat-value",children:[bt," / ",an]}),c.jsx("div",{className:"stat-sub",children:"Library vs wishlist share"})]}),c.jsxs("div",{className:"stat-card clickable",onClick:()=>W("demographics"),children:[c.jsx("h3",{children:"Top Demographics"}),c.jsx("div",{className:"stat-list",children:ls.length?ls.slice(0,3).map((T,L)=>c.jsxs("div",{className:"stat-list-row",children:[c.jsx("span",{className:"stat-rank",children:L+1}),c.jsx("span",{className:"stat-name",children:T.name}),c.jsx("span",{className:"stat-count",children:T.count})]},T.name)):c.jsx("div",{className:"stat-sub",children:"No demographic data yet."})})]}),c.jsxs("div",{className:"stat-card clickable",onClick:()=>W("publishers"),children:[c.jsx("h3",{children:"Top Publishers"}),c.jsx("div",{className:"stat-list",children:os.length?os.slice(0,3).map((T,L)=>c.jsxs("div",{className:"stat-list-row",children:[c.jsx("span",{className:"stat-rank",children:L+1}),c.jsx("span",{className:"stat-name",children:T.name}),c.jsx("span",{className:"stat-count",children:T.count})]},T.name)):c.jsx("div",{className:"stat-sub",children:"No publisher data yet."})})]}),c.jsxs("div",{className:"stat-card clickable",onClick:()=>W("genres"),children:[c.jsx("h3",{children:"Top Genres"}),c.jsx("div",{className:"stat-list",children:yt.length?yt.slice(0,3).map((T,L)=>c.jsxs("div",{className:"stat-list-row",children:[c.jsx("span",{className:"stat-rank",children:L+1}),c.jsx("span",{className:"stat-name",children:T.name}),c.jsx("span",{className:"stat-count",children:T.count})]},T.name)):c.jsx("div",{className:"stat-sub",children:"No genre data yet."})})]}),c.jsxs("div",{className:"stat-card clickable",onClick:()=>{O()},children:[c.jsx("h3",{children:"Next Wishlist Release"}),c.jsx("div",{className:"stat-value next-release",children:Cn?Cn.title:"No upcoming releases"}),c.jsxs("div",{className:"stat-sub",children:[Ln?Ln.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"}):"-",c.jsx("br",{}),c.jsx("span",{id:"statNextCountdown",children:S})]})]}),c.jsxs("div",{className:"stat-card clickable",onClick:()=>W("collectionValue"),style:{textAlign:"center"},children:[c.jsx("h3",{children:"Collection Pricing"}),c.jsxs("div",{className:"stat-value stat-msrp",children:["$",Ht.msrpTotal.toFixed(2)]}),c.jsxs("div",{className:"stat-value stat-paid",children:["$",Ht.paidTotal.toFixed(2),Ht.msrpTotal>0&&c.jsxs("span",{className:"stat-paid-pct",children:["(",((1-Ht.paidTotal/Ht.msrpTotal)*100).toFixed(1),"% off)"]})]}),c.jsxs("div",{className:"stat-value stat-collectible",children:["$",Ht.collectibleTotal.toFixed(2)]}),c.jsx("div",{className:"stat-sub",children:"MSRP  Paid  Collectible overrides"})]}),c.jsxs("div",{className:"stat-card",children:[c.jsx("h3",{children:"Current Year Reads"}),c.jsx("div",{className:"stat-value",children:as}),c.jsxs("div",{className:"stat-sub",children:["Reads in ",gn]})]}),c.jsxs("div",{className:"stat-card clickable",onClick:()=>W("timeToRead"),children:[c.jsx("h3",{children:"Avg Days From Purchase to Read"}),c.jsx("div",{className:"stat-value",children:ar==null?"-":`${ar.toFixed(1)} days`}),c.jsx("div",{className:"stat-sub",children:"When both dates exist"})]}),c.jsxs("div",{className:"stat-duo",children:[c.jsxs("div",{className:"stat-card tall",children:[c.jsxs("h3",{children:["Reads Per Month (",gn,")"]}),c.jsx(KR,{data:is})]}),c.jsxs("div",{className:"stat-card tall",children:[c.jsx("h3",{children:"Reads by Day of Week (Lifetime)"}),c.jsx(QR,{data:As}),c.jsx("div",{className:"stat-sub",children:"Based on all entries with a read date."})]})]}),c.jsxs("div",{className:"stat-card wide",children:[c.jsx("h3",{children:"Activity Log"}),Rt&&c.jsx("div",{className:"error",style:{textAlign:"center"},children:v}),c.jsx("div",{className:"activity-log scrollable",children:ot.length?ot.map((T,L)=>{const F=T.ts?new Date(T.ts):null;return c.jsxs("div",{className:"activity-row",children:[c.jsx("span",{className:"activity-title",children:T.message}),c.jsx("span",{className:"activity-date",children:F?F.toLocaleString(void 0,{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}):""})]},(T.message||"activity")+L)}):c.jsx("div",{className:"stat-sub",children:"No recent activity yet."})})]}),c.jsxs("div",{className:"stat-card wide",style:{minHeight:"340px",maxHeight:"480px"},children:[c.jsx("h3",{children:"Suggestions"}),Me&&c.jsx("div",{className:"error",style:{textAlign:"center"},children:Me}),c.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",alignItems:"stretch"},children:["anime","manga"].map(T=>{const L=ee.filter(F=>(F.type||"").toLowerCase()===T).sort((F,oe)=>{var Pe,ze,Re,Ze;return(((ze=(Pe=oe.createdAt)==null?void 0:Pe.getTime)==null?void 0:ze.call(Pe))||0)-(((Ze=(Re=F.createdAt)==null?void 0:Re.getTime)==null?void 0:Ze.call(Re))||0)});return c.jsxs("div",{style:{border:"1px solid rgba(255,182,193,0.18)",borderRadius:"16px",padding:"10px 12px",display:"flex",flexDirection:"column",background:"rgba(255,182,193,0.04)",minHeight:"240px"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"8px",position:"relative"},children:[c.jsx("h4",{style:{margin:0,color:"#ffb6c1",textAlign:"center",flex:1},children:T==="anime"?"Anime":"Manga"}),c.jsxs("span",{className:"stat-sub",style:{position:"absolute",right:0},children:[L.length," suggestion",L.length===1?"":"s"]})]}),c.jsx("div",{className:"scrollable",style:{maxHeight:"280px",height:"280px",paddingRight:"4px",overflowY:"auto"},children:me?c.jsx("div",{className:"stat-sub",children:"Loading suggestions..."}):L.length?L.map(F=>{const oe=F.createdAt instanceof Date?F.createdAt:F.createdAt?new Date(F.createdAt):null;return c.jsxs("div",{style:{border:"1px solid rgba(255,182,193,0.25)",borderRadius:"12px",padding:"8px 10px",marginBottom:"8px",background:"rgba(255,182,193,0.06)",display:"grid",gridTemplateColumns:"1fr auto",gap:"6px",alignItems:"center"},children:[c.jsxs("div",{children:[c.jsx("div",{style:{fontWeight:600,color:"#f7d0dc"},children:F.content||"(no content)"}),c.jsxs("div",{className:"stat-sub",style:{fontSize:"0.8rem"},children:[oe?oe.toLocaleString(void 0,{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}):""," ",F.from?` ${F.from}`:""]})]}),c.jsx("div",{style:{display:"flex",gap:"6px"},children:e&&c.jsx("button",{type:"button",className:"stat-link",onClick:()=>sr(F.id),children:"Delete"})})]},F.id)}):c.jsx("div",{className:"stat-sub",children:"No suggestions yet."})})]},T)})}),c.jsxs("div",{className:"stat-sub",style:{marginTop:"8px",textAlign:"center"},children:["Total suggestions: ",ee.length]})]}),c.jsxs("div",{className:"stat-card wide",children:[c.jsx("h3",{children:"Library Manager"}),Jt.length?c.jsxs("div",{className:"dash-library",children:[c.jsxs("div",{className:"dash-library-list",children:[Jt.map(T=>{const L=T.books.filter(Re=>!!Re.read||Re.status==="Read"||Re.Read===!0).length,F=q.has(T.seriesKey),oe=ne===T.seriesKey&&!ge,Pe=LR(T),ze=T.books.some(Re=>$v(Re));return c.jsxs("div",{style:{marginBottom:"8px"},children:[c.jsxs("button",{type:"button",onClick:()=>Qi(T.seriesKey),style:{width:"100%",textAlign:"left",background:Pe?"rgba(255,179,71,0.08)":"transparent",border:`1px solid ${oe?"#ff69b4":Pe?"rgba(255,179,71,0.6)":"rgba(255,182,193,0.25)"}`,color:"#ffb6c1",padding:"8px",borderRadius:"8px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"8px",position:"relative",boxShadow:Pe?"0 0 10px rgba(255,179,71,0.5)":oe?"0 0 8px rgba(255,105,180,0.5)":"none"},children:[c.jsx("span",{style:{transition:"transform 0.2s ease",transform:F?"rotate(90deg)":"none"},children:">"}),c.jsx("span",{style:{flex:1},children:T.displayName}),c.jsxs("span",{style:{fontSize:"11px",color:"#f8d1d8"},children:[T.books.length," book",T.books.length===1?"":"s",T.books.length?`  ${L} read`:""]}),ze&&c.jsx("span",{title:"Some volumes are missing required data",style:{width:"12px",height:"12px",borderRadius:"999px",background:"#ffb347",border:"1px solid rgba(255,255,255,0.25)",boxShadow:"0 0 10px rgba(255,179,71,0.6)"}})]}),c.jsx("div",{style:{margin:"6px 0 10px 10px",paddingLeft:"10px",borderLeft:"1px solid rgba(255,182,193,0.25)",display:F?"block":"none"},children:T.books.map(Re=>{const Ze=ge===Re.id,ct=ie.has(Re.id);Re.read||Re.status==="Read"||Re.Read;const vt=$v(Re,{ignoreShared:!0});return c.jsxs("button",{type:"button",onClick:cn=>Fr(cn,Re.id,T.seriesKey),style:{width:"100%",textAlign:"left",background:vt?"rgba(255,179,71,0.1)":"transparent",border:`1px solid ${Ze?"#ff69b4":ct?"#fff59d":vt?"rgba(255,179,71,0.6)":"rgba(255,182,193,0.25)"}`,color:"#ffb6c1",padding:"8px",borderRadius:"8px",marginBottom:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"8px",boxShadow:Ze?"0 0 8px rgba(255,105,180,0.5)":ct?"0 0 10px rgba(255,255,180,0.65)":vt?"0 0 10px rgba(255,179,71,0.5)":"none"},children:[c.jsx("span",{style:{flex:1,minWidth:0},children:Re.Title||Re.title||"Untitled"}),vt&&c.jsx("span",{style:{flexShrink:0,padding:"2px 8px",borderRadius:"999px",background:"rgba(255,179,71,0.18)",border:"1px solid rgba(255,179,71,0.6)",color:"#ffd8a1",fontSize:"11px",fontWeight:700,whiteSpace:"nowrap"},children:"Missing data"})]},Re.id)})})]},T.seriesKey)}),Jt.length>0&&ie.size>0&&c.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:c.jsx("button",{type:"button",style:{padding:"6px 12px",borderRadius:"999px",border:"1px solid #ffb6c1",background:"transparent",color:"#ffb6c1",cursor:"pointer"},onClick:cs,children:"Clear Selection"})})]}),c.jsxs("div",{className:"dash-library-details",children:[ie.size>0&&c.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px",padding:"10px",marginBottom:"10px",border:"1px dashed rgba(255,182,193,0.45)",borderRadius:"10px",background:"rgba(255,182,193,0.08)"},children:[c.jsxs("div",{children:["Apply Amount Paid to ",ie.size," selected book",ie.size===1?"":"s"]}),c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",flexWrap:"wrap"},children:[c.jsx("input",{type:"number",step:"0.01",min:"0",value:R,onChange:T=>M(T.target.value),style:{maxWidth:"140px"}}),c.jsx("button",{type:"button",className:"dash-btn primary",onClick:Yn,children:"Apply to Selected"})]})]}),!ne&&!ge&&c.jsx("div",{className:"stat-sub",style:{marginTop:6},children:"Select a series or book to edit"}),ne&&!ge&&zr&&c.jsxs("div",{children:[c.jsx("div",{className:"dash-detail-title",children:zr.displayName}),c.jsx("div",{className:"dash-detail-row",children:c.jsxs("label",{className:"inline-checkbox",children:[c.jsx("input",{ref:B,type:"checkbox",checked:V.readChecked,onChange:T=>b(L=>({...L,readChecked:T.target.checked,readIndeterminate:!1}))}),c.jsx("span",{children:"Mark series as read"})]})}),c.jsxs("div",{className:`dash-detail-row${Xn.publisher?" missing-row":""}`,children:[c.jsx("span",{children:"Publisher"}),c.jsx("input",{type:"text",value:V.publisher,onChange:T=>b(L=>({...L,publisher:T.target.value})),placeholder:"Set publisher for series"})]}),c.jsxs("div",{className:`dash-detail-row${Xn.demographic?" missing-row":""}`,children:[c.jsx("span",{children:"Demographic"}),c.jsxs("select",{value:V.demographic,onChange:T=>b(L=>({...L,demographic:T.target.value})),children:[c.jsx("option",{value:"",children:"Select Demographic"}),c.jsx("option",{value:"Shounen",children:"Shounen"}),c.jsx("option",{value:"Seinen",children:"Seinen"}),c.jsx("option",{value:"Shoujo",children:"Shoujo"}),c.jsx("option",{value:"Josei",children:"Josei"})]})]}),c.jsxs("div",{className:`dash-detail-row${Xn.genre?" missing-row":""}`,children:[c.jsx("span",{children:"Genre"}),c.jsx("input",{type:"text",value:V.genre,onChange:T=>b(L=>({...L,genre:T.target.value})),placeholder:"Primary genre"})]}),c.jsxs("div",{className:"dash-detail-row",children:[c.jsx("span",{children:"Sub-Genre"}),c.jsx("input",{type:"text",value:V.subGenre,onChange:T=>b(L=>({...L,subGenre:T.target.value})),placeholder:"Secondary genre / theme"})]}),!V.dateMixed&&c.jsxs("div",{className:`dash-detail-row${Xn.datePurchased?" missing-row":""}`,children:[c.jsx("span",{children:"Date Purchased"}),c.jsx("input",{type:"date",value:V.datePurchased,onChange:T=>b(L=>({...L,datePurchased:T.target.value}))})]}),c.jsxs("div",{className:`dash-detail-row${Xn.msrp?" missing-row":""}`,children:[c.jsx("span",{children:"MSRP (per book)"}),c.jsx("input",{type:"number",step:"0.01",min:"0",value:V.msrp,onChange:T=>b(L=>({...L,msrp:T.target.value})),placeholder:"0.00"})]}),c.jsxs("div",{className:"dash-detail-actions",children:[c.jsx("button",{type:"button",className:"dash-btn secondary",onClick:si,children:"Cancel"}),c.jsx("button",{type:"button",className:"dash-btn primary",onClick:Ur,children:"Save Series"})]})]}),ge&&lt&&c.jsxs("div",{children:[c.jsx("div",{className:"dash-detail-title",children:lt.Title||lt.title||"Untitled"}),c.jsx("div",{className:"dash-detail-row",children:c.jsxs("label",{className:"inline-checkbox",children:[c.jsx("input",{type:"checkbox",checked:!!he.read,onChange:T=>ve(L=>({...L,read:T.target.checked,dateRead:T.target.checked?L.dateRead||new Date().toISOString().slice(0,10):"",rating:T.target.checked?L.rating:""}))}),c.jsx("span",{children:"Mark as read"})]})}),c.jsxs("div",{className:`dash-detail-row${Xt.datePurchased?" missing-row":""}`,children:[c.jsx("span",{children:"Date Purchased"}),c.jsx("input",{type:"date",value:he.datePurchased,onChange:T=>ve(L=>({...L,datePurchased:T.target.value}))})]}),he.read&&c.jsxs("div",{className:"dash-detail-row",children:[c.jsx("span",{children:"Date Read"}),c.jsx("input",{type:"date",value:he.dateRead,onChange:T=>ve(L=>({...L,dateRead:T.target.value}))})]}),c.jsxs("div",{className:`dash-detail-row${Xt.pageCount?" missing-row":""}`,children:[c.jsx("span",{children:"Page Count"}),c.jsx("input",{type:"number",min:"0",step:"1",value:he.pageCount,onChange:T=>ve(L=>({...L,pageCount:T.target.value}))})]}),c.jsxs("div",{className:`dash-detail-row${Xt.msrp?" missing-row":""}`,children:[c.jsx("span",{children:"MSRP (per book)"}),c.jsx("input",{type:"number",step:"0.01",min:"0",value:he.msrp,onChange:T=>ve(L=>({...L,msrp:T.target.value})),placeholder:"0.00"})]}),!(he.special&&he.specialType==="collectible")&&c.jsxs("div",{className:`dash-detail-row${Xt.amountPaid?" missing-row":""}`,children:[c.jsx("span",{children:"Amount Paid"}),c.jsx("input",{type:"number",step:"0.01",min:"0",value:he.amountPaid,onChange:T=>ve(L=>({...L,amountPaid:T.target.value})),placeholder:"0.00"})]}),he.read&&c.jsxs("div",{className:"dash-detail-row",children:[c.jsx("span",{children:"Star Rating"}),c.jsx("input",{type:"number",min:"0",max:"5",step:"0.5",value:he.rating,onChange:T=>ve(L=>({...L,rating:T.target.value})),placeholder:"0-5"})]}),c.jsx("div",{className:`dash-detail-row${Xt.specialType?" missing-row":""}`,children:c.jsxs("label",{className:"inline-checkbox",style:{width:"100%"},children:[c.jsx("input",{type:"checkbox",checked:!!he.special,onChange:T=>ve(L=>({...L,special:T.target.checked,specialType:T.target.checked?L.specialType:"",specialVolumes:T.target.checked?L.specialVolumes:"",collectiblePrice:T.target.checked?L.collectiblePrice:""}))}),c.jsx("span",{children:"Special?"})]})}),he.special&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:`dash-detail-row${Xt.specialType?" missing-row":""}`,children:[c.jsx("span",{children:"Special Type"}),c.jsxs("select",{value:he.specialType,onChange:T=>ve(L=>({...L,specialType:T.target.value,specialVolumes:T.target.value==="specialEdition"?L.specialVolumes:"",collectiblePrice:T.target.value==="collectible"?L.collectiblePrice:""})),children:[c.jsx("option",{value:"",children:"Select type"}),c.jsx("option",{value:"specialEdition",children:"Special Edition"}),c.jsx("option",{value:"collectible",children:"Collectible"})]})]}),he.specialType==="specialEdition"&&c.jsxs("div",{className:`dash-detail-row${Xt.specialVolumes?" missing-row":""}`,children:[c.jsx("span",{children:"Volumes Contained"}),c.jsx("input",{type:"number",min:"1",step:"1",value:he.specialVolumes,onChange:T=>ve(L=>({...L,specialVolumes:T.target.value}))})]}),he.specialType==="collectible"&&c.jsxs("div",{className:`dash-detail-row${Xt.collectiblePrice?" missing-row":""}`,children:[c.jsx("span",{children:"Collectible Price"}),c.jsx("input",{type:"number",min:"0",step:"0.01",value:he.collectiblePrice,onChange:T=>ve(L=>({...L,collectiblePrice:T.target.value})),placeholder:"0.00"})]})]}),c.jsxs("div",{className:"dash-detail-actions",children:[c.jsx("button",{type:"button",className:"dash-btn secondary",onClick:ks,children:"Cancel"}),c.jsx("button",{type:"button",className:"dash-btn primary",onClick:Jn,children:"Save Changes"})]})]})]})]}):c.jsx("div",{className:"stat-sub",children:"No library items."})]})]})}),wt&&c.jsx("div",{id:"calendarOverlay",onClick:()=>pt(!1),children:c.jsxs("div",{id:"calendarCard",onClick:T=>T.stopPropagation(),children:[c.jsxs("div",{className:"calendar-header",children:[c.jsx("div",{className:"calendar-title",children:Tt.toLocaleString(void 0,{month:"long",year:"numeric"})}),c.jsxs("div",{className:"calendar-nav",children:[c.jsx("button",{className:"calendar-nav-btn",onClick:()=>Ut(new Date(Tt.getFullYear(),Tt.getMonth()-1,1)),children:"<"}),c.jsx("button",{className:"calendar-nav-btn",onClick:()=>Ut(new Date(Tt.getFullYear(),Tt.getMonth()+1,1)),children:">"})]})]}),c.jsxs("div",{className:"calendar-weekdays",children:[c.jsx("div",{children:"Sun"}),c.jsx("div",{children:"Mon"}),c.jsx("div",{children:"Tue"}),c.jsx("div",{children:"Wed"}),c.jsx("div",{children:"Thu"}),c.jsx("div",{children:"Fri"}),c.jsx("div",{children:"Sat"})]}),c.jsx("div",{className:"calendar-grid",id:"releaseCalendar",children:Je.map((T,L)=>T.type==="pad"?c.jsx("div",{className:"calendar-day pad"},L):c.jsxs("div",{className:"calendar-day"+(T.isToday?" today":""),children:[c.jsx("div",{className:"day-num",children:T.day}),c.jsxs("div",{className:"calendar-releases",children:[(xt===T.dateKey?T.releases:T.releases.slice(0,2)).map((F,oe)=>c.jsx("div",{className:"calendar-release",title:F.title,children:F.title},oe)),T.releases.length>2&&c.jsxs("button",{className:"calendar-more-btn",onClick:()=>{const F=new Date(Tt.getFullYear(),Tt.getMonth(),T.day);Be({dateLabel:F.toLocaleDateString(void 0,{month:"long",day:"numeric",year:"numeric"}),releases:T.releases})},children:["+",T.releases.length-2," more"]})]})]},L))}),!on.length&&c.jsx("div",{className:"calendar-empty",children:"No wishlist releases found."}),c.jsx("button",{id:"calendarClose",onClick:()=>pt(!1),children:"x"})]})}),It.open&&c.jsx("div",{id:"statDetailOverlay",onClick:ce,children:c.jsxs("div",{id:"statDetailCard",onClick:T=>T.stopPropagation(),children:[c.jsx("button",{id:"statDetailClose",onClick:ce,children:"x"}),c.jsxs("h2",{id:"statDetailTitle",children:[It.type==="publishers"&&"Top Publishers",It.type==="genres"&&"Top Genres",It.type==="demographics"&&"Top Demographics",It.type==="timeToRead"&&"Avg Time From Purchase to Read",It.type==="collectionValue"&&"Collection Value",It.type==="pages"&&"Pages Read vs Total",It.type==="ratings"&&"Ratings",It.type==="releases"&&"Wishlist Releases"]}),c.jsx("div",{id:"statDetailBody",children:Ce()})]})}),Fe&&c.jsx("div",{id:"calendarOverlay",onClick:()=>Be(null),style:{zIndex:10080},children:c.jsxs("div",{id:"calendarCard",onClick:T=>T.stopPropagation(),style:{maxWidth:"520px"},children:[c.jsxs("div",{className:"calendar-header",children:[c.jsx("div",{className:"calendar-title",children:Fe.dateLabel}),c.jsx("button",{className:"calendar-close-btn",onClick:()=>Be(null),type:"button",children:"Close"})]}),c.jsx("div",{className:"calendar-releases",children:Fe.releases.map((T,L)=>c.jsx("div",{className:"calendar-release",title:T.title,children:T.title},L))})]})}),e&&pe&&c.jsx("div",{className:"dashboard-modal-backdrop visible",onClick:T=>{T.target===T.currentTarget&&be(!1)},children:c.jsxs("div",{className:"dashboard-modal",children:[c.jsxs("div",{className:"dashboard-modal-header",children:[c.jsx("h3",{children:"Webhook Settings"}),c.jsx("button",{className:"dashboard-close",onClick:()=>be(!1),type:"button",children:"Close"})]}),c.jsxs("div",{className:"dashboard-modal-body",children:[c.jsxs("label",{className:"dashboard-input",children:[c.jsx("span",{children:"Yearly summary webhook"}),c.jsx("input",{type:"text",value:$.yearly,onChange:T=>X(L=>({...L,yearly:T.target.value}))})]}),c.jsxs("label",{className:"dashboard-input",children:[c.jsx("span",{children:"Release timer webhook"}),c.jsx("input",{type:"text",value:$.release,onChange:T=>X(L=>({...L,release:T.target.value}))})]}),c.jsxs("label",{className:"dashboard-input",children:[c.jsx("span",{children:"Activity webhook"}),c.jsx("input",{type:"text",value:$.activity,onChange:T=>X(L=>({...L,activity:T.target.value}))})]}),c.jsxs("div",{className:"dashboard-input",style:{borderTop:"1px solid rgba(255,182,193,0.2)",paddingTop:8},children:[c.jsx("span",{children:"User roles"}),c.jsx("div",{style:{marginTop:8,fontSize:"0.85rem",color:"var(--text-soft)"},children:N?c.jsx("span",{children:"Loading users"}):Te.length===0?c.jsx("span",{children:"No users found."}):c.jsx("ul",{style:{listStyle:"none",margin:"6px 0 0",padding:0,display:"flex",gap:6,flexDirection:"column"},children:Te.map(T=>c.jsxs("li",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:8,background:"rgba(24,5,18,0.7)",border:"1px solid rgba(255,182,193,0.18)",borderRadius:10,padding:"6px 8px",flexWrap:"wrap"},children:[c.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:2},children:[c.jsx("strong",{children:T.displayName||T.email||T.uid}),c.jsx("span",{style:{fontSize:"0.85rem",opacity:.8},children:T.email||T.uid})]}),c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[c.jsx("span",{className:"role-pill",children:T.role||"viewer"}),T.role==="admin"?c.jsx("button",{className:"dashboard-close",type:"button",onClick:()=>Et(T.uid,"viewer"),style:{padding:"4px 10px"},children:"Make viewer"}):c.jsx("button",{className:"stat-link",type:"button",onClick:()=>Et(T.uid,"admin"),style:{padding:"4px 10px"},children:"Make admin"})]})]},T.uid))})})]})]}),c.jsxs("div",{className:"dashboard-modal-footer",children:[c.jsx("button",{className:"stat-link",type:"button",onClick:async()=>{try{await Ks(Pt(tt,"settings","webhooks"),{yearly:$.yearly||dl,release:$.release||hl,activity:$.activity||fl}),be(!1)}catch(T){console.error("Failed to save webhooks",T),alert("Failed to save webhooks.")}},children:"Save"}),c.jsx("button",{className:"stat-link danger",type:"button",onClick:()=>be(!1),children:"Cancel"})]})]})})]})}function XR(){const[n,e]=D.useState(!0),[t,s]=D.useState(""),[a,l]=D.useState(0),[d,f]=D.useState([]),[m,v]=D.useState(0),w=D.useRef(null);D.useEffect(()=>{document.title="Music | im.ok"},[]),D.useEffect(()=>{let ye=!1;async function ie(){e(!0),s("");try{const Ee=await fetch("https://music-api-worker.imokissick.workers.dev/music");if(!Ee.ok)throw new Error("Worker fetch failed");const k=await Ee.json();if(ye)return;const P=Array.isArray(k.combined)?k.combined:[],R=Array.isArray(k.spotify)?k.spotify:[],M=Array.isArray(k.soundcloud)?k.soundcloud:[],V=[...P,...R,...M].reduce((b,he)=>{const ve=(he.title||"").toLowerCase().trim();if(!ve)return b;const ot=b.findIndex(Ve=>(Ve.title||"").toLowerCase().trim()===ve);return ot>=0?(b[ot].source!=="spotify"&&he.source==="spotify"&&(b[ot]=he),b):(b.push(he),b)},[]).map(b=>({...b,releaseDate:b.releaseDate?new Date(b.releaseDate):new Date}));f(V)}catch(Ee){console.error(Ee),ye||s("Failed to load music feeds.")}finally{ye||e(!1)}}return ie(),()=>{ye=!0}},[]);const S=Math.min(4,Math.max(1,d.length)),C=S?Math.ceil(d.length/S):0,$=()=>{w.current&&clearInterval(w.current),d.length&&(v(ye=>ye+1),w.current=setInterval(()=>{l(ye=>(Math.floor(ye/S)+1)%C*S%d.length),v(ye=>ye+1)},15e3))};D.useEffect(()=>{if(d.length)return $(),()=>{w.current&&clearInterval(w.current)}},[d,S]);const X=ye=>{d.length&&(l(ie=>(Math.floor(ie/S)+ye+C)%C*S%d.length),$())},q=ye=>{d.length&&(l(ye*S%d.length),$())},U=ye=>ie=>{ie.preventDefault();const k=ye.source==="spotify"?`spotify:album:${ye.id}`:ye.url,P=ye.url;try{const R=setTimeout(()=>{window.open(P,"_blank","noopener,noreferrer")},600);window.location.href=k,setTimeout(()=>clearTimeout(R),800)}catch{window.open(P,"_blank","noopener,noreferrer")}},ne=d[0],xe=ye=>ye?{backgroundImage:`url(${ye})`,backgroundSize:"cover",backgroundPosition:"center"}:{},ge=ne?ne.source==="spotify"?"Spotify":"SoundCloud":"";return c.jsxs("main",{className:"page music-page",children:[c.jsxs("header",{className:"music-hero",children:[c.jsxs("div",{className:"music-hero-content",children:[c.jsx("p",{className:"music-pill",children:"im.ok  Artist"}),c.jsx("h1",{children:ne?ne.title:"Latest & Greatest"}),c.jsx("p",{className:"music-sub",children:"Check out my latest song. I know it's been almost a whole year since I've released. I have been on a much needed hiatus. I felt the whole world crumbling around me and had no time to breathe so this is why I took a break. Here's to 2026!"}),ne&&c.jsx("div",{className:"music-badges",children:c.jsx("span",{children:ge})})]}),c.jsx("div",{className:"music-hero-embed",children:c.jsxs("div",{className:"music-hero-art",style:xe(ne==null?void 0:ne.artwork),children:[!(ne!=null&&ne.artwork)&&c.jsx("div",{className:"music-hero-art-fallback",children:"Artwork"}),ne&&c.jsx("button",{className:"music-link music-play hero-play","aria-label":`Play ${ne.title}`,onClick:U(ne)})]})})]}),c.jsxs("section",{className:"music-section",children:[c.jsx("div",{className:"music-section-header",children:c.jsx("h2",{children:"Releases"})}),t&&c.jsx("div",{className:"music-error",children:t}),n&&c.jsx("div",{className:"music-loading",children:"Loading music feeds..."}),!n&&d.length===0&&c.jsx("div",{className:"music-empty",children:"Connect Spotify/SoundCloud tokens to see live releases."}),!n&&d.length>0&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"music-carousel-wrap",children:[c.jsx("button",{className:"music-nav left",onClick:()=>X(-1),"aria-label":"Previous releases",children:""}),c.jsx("div",{className:"music-carousel",children:Array.from({length:S}).map((ye,ie)=>{const Ee=d[(a+ie)%d.length];return Ee?c.jsxs("div",{className:"music-card",children:[c.jsx("div",{className:"music-card-art",style:xe(Ee.artwork)}),c.jsxs("div",{className:"music-card-body",children:[c.jsx("div",{className:"music-card-title",children:Ee.title}),c.jsx("div",{className:"music-card-actions",children:c.jsx("button",{className:"music-link music-play","aria-label":`Play ${Ee.title}`,onClick:U(Ee)})})]})]},`${Ee.id}-${ie}`):null})}),c.jsx("button",{className:"music-nav right",onClick:()=>X(1),"aria-label":"Next releases",children:""})]}),c.jsx("div",{className:"music-dots",children:Array.from({length:C}).map((ye,ie)=>{const Ee=Math.floor(a/S)===ie,k=Ee?`${ie}-${m}`:`${ie}-idle`;return c.jsx("button",{className:`dot ${Ee?"active":""}`,onClick:()=>q(ie),"aria-label":`Go to set ${ie+1}`,children:c.jsx("span",{className:"dot-fill"},k)},ie)})})]})]}),c.jsxs("div",{className:"music-feeds-row",children:[c.jsxs("section",{className:"music-section",children:[c.jsx("div",{className:"music-section-header",children:c.jsx("h2",{children:"Spotify"})}),c.jsx("div",{className:"music-embed-card",children:c.jsx("iframe",{title:"Spotify Artist",src:"https://open.spotify.com/embed/artist/00sbWLxYLDs8i5BLQL9Qdo?utm_source=generator&theme=0",width:"100%",height:"400",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy"})})]}),c.jsxs("section",{className:"music-section",children:[c.jsx("div",{className:"music-section-header",children:c.jsx("h2",{children:"SoundCloud"})}),c.jsx("div",{className:"music-embed-card",children:c.jsx("iframe",{title:"SoundCloud Player",width:"100%",height:"400",scrolling:"no",frameBorder:"no",allow:"autoplay",src:"https://w.soundcloud.com/player/?url=https%3A//soundcloud.com/imxk&color=%23ff69b4&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true&visual=true"})})]})]})]})}function ZR(){const n=Bu(),{user:e}=jo(),t=async a=>{if(!(a!=null&&a.uid))return;const l=Pt(tt,"users",a.uid);try{const d=await kp(l),f=d.exists()?d.data():null,m=(f==null?void 0:f.role)||"viewer";await Ks(l,{role:m,email:a.email||(f==null?void 0:f.email)||"",displayName:a.displayName||(f==null?void 0:f.displayName)||"",createdAt:(f==null?void 0:f.createdAt)||Uu()},{merge:!0})}catch(d){console.warn("Failed to upsert user doc",d)}};D.useEffect(()=>{e!=null&&e.uid&&t(e).finally(()=>n("/"))},[e,n]);async function s(){try{const a=new es,l=await J_(Lr,a);await t(l.user),n("/")}catch(a){console.error(a),alert("Google Sign-In failed.")}}return c.jsx("div",{className:"signin-page",children:c.jsxs("div",{className:"signin-card",children:[c.jsx("h2",{className:"signin-title",children:"Welcome Back"}),c.jsx("p",{className:"signin-sub",children:"Sign in to access the dashboard & edit collections."}),c.jsxs("button",{className:"google-btn",onClick:s,children:[c.jsx("img",{src:"https://www.svgrepo.com/show/475656/google-color.svg",alt:"",className:"google-icon"}),"Continue with Google"]}),c.jsxs("button",{className:"signin-cancel",onClick:()=>n("/"),children:["<"," Back to Home"]})]})})}const eN=D.lazy(()=>Xl(()=>import("./SteamCard-9sNpIONg.js"),[])),tN=D.lazy(()=>Xl(()=>import("./SteamRecents-CaMDzWnR.js"),[])),nN=D.lazy(()=>Xl(()=>import("./SteamGames-CCPHZ2Gf.js"),[]));function rN(){return D.useEffect(()=>{document.title="Tyler's Gaming Lounge"},[]),c.jsxs("div",{className:"steam-page page",children:[c.jsxs("header",{style:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",gap:"6px"},children:[c.jsx("h1",{style:{margin:0,fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Tyler's Gaming Lounge"}),c.jsx("p",{style:{margin:"6px 0 0",color:"var(--text-soft)",fontSize:"0.9rem"},children:"This will be the home to all of my gaming collections, this is still being worked on, but thought it was cool with just steam for now."})]}),c.jsx(tf,{minHeight:260,children:c.jsx(D.Suspense,{fallback:c.jsx(wu,{label:"Profile"}),children:c.jsx(eN,{})})}),c.jsx(tf,{minHeight:240,children:c.jsx(D.Suspense,{fallback:c.jsx(wu,{label:"Recently played"}),children:c.jsx(tN,{})})}),c.jsx(tf,{minHeight:400,children:c.jsx(D.Suspense,{fallback:c.jsx(wu,{label:"Library & Achievements"}),children:c.jsx(nN,{})})})]})}function tf({children:n,minHeight:e=200}){const[t,s]=D.useState(!1),a=D.useRef(null);D.useEffect(()=>{const d=new IntersectionObserver(f=>{f[0].isIntersecting&&(s(!0),d.disconnect())},{rootMargin:"200px 0px"});return a.current&&d.observe(a.current),()=>d.disconnect()},[]);const l=t?void 0:{minHeight:e};return c.jsx("div",{ref:a,style:l,children:t?n:c.jsx(wu,{})})}function wu({label:n="Loading section"}){return c.jsxs("div",{className:"steam-skeleton",children:[c.jsx("div",{className:"steam-skeleton-bar"}),c.jsx("div",{className:"steam-skeleton-bar short"}),c.jsx("p",{className:"steam-skeleton-label",children:n})]})}function sN(){return c.jsxs(hR,{children:[c.jsx(pR,{}),c.jsxs(BE,{children:[c.jsx(Zr,{path:"/",element:c.jsx(Av,{})}),c.jsx(Zr,{path:"/home",element:c.jsx(Av,{})}),c.jsx(Zr,{path:"/manga",element:c.jsx(_R,{})}),c.jsx(Zr,{path:"/anime",element:c.jsx(NR,{})}),c.jsx(Zr,{path:"/tcg",element:c.jsx(kR,{})}),c.jsx(Zr,{path:"/music",element:c.jsx(XR,{})}),c.jsx(Zr,{path:"/dashboard",element:c.jsx(JR,{})}),c.jsx(Zr,{path:"/signin",element:c.jsx(ZR,{})}),c.jsx(Zr,{path:"/steam",element:c.jsx(rN,{})}),c.jsx(Zr,{path:"*",element:c.jsx(UE,{to:"/home",replace:!0})})]})]})}Qx.createRoot(document.getElementById("root")).render(c.jsx(jf.StrictMode,{children:c.jsx(QE,{basename:"/base",children:c.jsx(sN,{})})}));export{c as j,D as r};
