function Xx(n,e){for(var t=0;t<e.length;t++){const s=e[t];if(typeof s!="string"&&!Array.isArray(s)){for(const a in s)if(a!=="default"&&!(a in n)){const l=Object.getOwnPropertyDescriptor(s,a);l&&Object.defineProperty(n,a,l.get?l:{enumerable:!0,get:()=>s[a]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const d of l.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&s(d)}).observe(document,{childList:!0,subtree:!0});function t(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(a){if(a.ep)return;a.ep=!0;const l=t(a);fetch(a.href,l)}})();function a_(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Gh={exports:{}},El={},Hh={exports:{}},pt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yg;function Zx(){if(Yg)return pt;Yg=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),d=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),v=Symbol.for("react.memo"),w=Symbol.for("react.lazy"),S=Symbol.iterator;function I(K){return K===null||typeof K!="object"?null:(K=S&&K[S]||K["@@iterator"],typeof K=="function"?K:null)}var U={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Z=Object.assign,Q={};function M(K,N,W){this.props=K,this.context=N,this.refs=Q,this.updater=W||U}M.prototype.isReactComponent={},M.prototype.setState=function(K,N){if(typeof K!="object"&&typeof K!="function"&&K!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,K,N,"setState")},M.prototype.forceUpdate=function(K){this.updater.enqueueForceUpdate(this,K,"forceUpdate")};function ne(){}ne.prototype=M.prototype;function xe(K,N,W){this.props=K,this.context=N,this.refs=Q,this.updater=W||U}var we=xe.prototype=new ne;we.constructor=xe,Z(we,M.prototype),we.isPureReactComponent=!0;var Ee=Array.isArray,le=Object.prototype.hasOwnProperty,Re={current:null},A={key:!0,ref:!0,__self:!0,__source:!0};function P(K,N,W){var ee,Te={},_e=null,Le=null;if(N!=null)for(ee in N.ref!==void 0&&(Le=N.ref),N.key!==void 0&&(_e=""+N.key),N)le.call(N,ee)&&!A.hasOwnProperty(ee)&&(Te[ee]=N[ee]);var qe=arguments.length-2;if(qe===1)Te.children=W;else if(1<qe){for(var rt=Array(qe),vt=0;vt<qe;vt++)rt[vt]=arguments[vt+2];Te.children=rt}if(K&&K.defaultProps)for(ee in qe=K.defaultProps,qe)Te[ee]===void 0&&(Te[ee]=qe[ee]);return{$$typeof:n,type:K,key:_e,ref:Le,props:Te,_owner:Re.current}}function R(K,N){return{$$typeof:n,type:K.type,key:N,ref:K.ref,props:K.props,_owner:K._owner}}function O(K){return typeof K=="object"&&K!==null&&K.$$typeof===n}function B(K){var N={"=":"=0",":":"=2"};return"$"+K.replace(/[=:]/g,function(W){return N[W]})}var D=/\/+/g;function b(K,N){return typeof K=="object"&&K!==null&&K.key!=null?B(""+K.key):N.toString(36)}function he(K,N,W,ee,Te){var _e=typeof K;(_e==="undefined"||_e==="boolean")&&(K=null);var Le=!1;if(K===null)Le=!0;else switch(_e){case"string":case"number":Le=!0;break;case"object":switch(K.$$typeof){case n:case e:Le=!0}}if(Le)return Le=K,Te=Te(Le),K=ee===""?"."+b(Le,0):ee,Ee(Te)?(W="",K!=null&&(W=K.replace(D,"$&/")+"/"),he(Te,N,W,"",function(vt){return vt})):Te!=null&&(O(Te)&&(Te=R(Te,W+(!Te.key||Le&&Le.key===Te.key?"":(""+Te.key).replace(D,"$&/")+"/")+K)),N.push(Te)),1;if(Le=0,ee=ee===""?".":ee+":",Ee(K))for(var qe=0;qe<K.length;qe++){_e=K[qe];var rt=ee+b(_e,qe);Le+=he(_e,N,W,rt,Te)}else if(rt=I(K),typeof rt=="function")for(K=rt.call(K),qe=0;!(_e=K.next()).done;)_e=_e.value,rt=ee+b(_e,qe++),Le+=he(_e,N,W,rt,Te);else if(_e==="object")throw N=String(K),Error("Objects are not valid as a React child (found: "+(N==="[object Object]"?"object with keys {"+Object.keys(K).join(", ")+"}":N)+"). If you meant to render a collection of children, use an array instead.");return Le}function $e(K,N,W){if(K==null)return K;var ee=[],Te=0;return he(K,ee,"","",function(_e){return N.call(W,_e,Te++)}),ee}function Ae(K){if(K._status===-1){var N=K._result;N=N(),N.then(function(W){(K._status===0||K._status===-1)&&(K._status=1,K._result=W)},function(W){(K._status===0||K._status===-1)&&(K._status=2,K._result=W)}),K._status===-1&&(K._status=0,K._result=N)}if(K._status===1)return K._result.default;throw K._result}var He={current:null},me={transition:null},De={ReactCurrentDispatcher:He,ReactCurrentBatchConfig:me,ReactCurrentOwner:Re};function be(){throw Error("act(...) is not supported in production builds of React.")}return pt.Children={map:$e,forEach:function(K,N,W){$e(K,function(){N.apply(this,arguments)},W)},count:function(K){var N=0;return $e(K,function(){N++}),N},toArray:function(K){return $e(K,function(N){return N})||[]},only:function(K){if(!O(K))throw Error("React.Children.only expected to receive a single React element child.");return K}},pt.Component=M,pt.Fragment=t,pt.Profiler=a,pt.PureComponent=xe,pt.StrictMode=s,pt.Suspense=m,pt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=De,pt.act=be,pt.cloneElement=function(K,N,W){if(K==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+K+".");var ee=Z({},K.props),Te=K.key,_e=K.ref,Le=K._owner;if(N!=null){if(N.ref!==void 0&&(_e=N.ref,Le=Re.current),N.key!==void 0&&(Te=""+N.key),K.type&&K.type.defaultProps)var qe=K.type.defaultProps;for(rt in N)le.call(N,rt)&&!A.hasOwnProperty(rt)&&(ee[rt]=N[rt]===void 0&&qe!==void 0?qe[rt]:N[rt])}var rt=arguments.length-2;if(rt===1)ee.children=W;else if(1<rt){qe=Array(rt);for(var vt=0;vt<rt;vt++)qe[vt]=arguments[vt+2];ee.children=qe}return{$$typeof:n,type:K.type,key:Te,ref:_e,props:ee,_owner:Le}},pt.createContext=function(K){return K={$$typeof:d,_currentValue:K,_currentValue2:K,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},K.Provider={$$typeof:l,_context:K},K.Consumer=K},pt.createElement=P,pt.createFactory=function(K){var N=P.bind(null,K);return N.type=K,N},pt.createRef=function(){return{current:null}},pt.forwardRef=function(K){return{$$typeof:f,render:K}},pt.isValidElement=O,pt.lazy=function(K){return{$$typeof:w,_payload:{_status:-1,_result:K},_init:Ae}},pt.memo=function(K,N){return{$$typeof:v,type:K,compare:N===void 0?null:N}},pt.startTransition=function(K){var N=me.transition;me.transition={};try{K()}finally{me.transition=N}},pt.unstable_act=be,pt.useCallback=function(K,N){return He.current.useCallback(K,N)},pt.useContext=function(K){return He.current.useContext(K)},pt.useDebugValue=function(){},pt.useDeferredValue=function(K){return He.current.useDeferredValue(K)},pt.useEffect=function(K,N){return He.current.useEffect(K,N)},pt.useId=function(){return He.current.useId()},pt.useImperativeHandle=function(K,N,W){return He.current.useImperativeHandle(K,N,W)},pt.useInsertionEffect=function(K,N){return He.current.useInsertionEffect(K,N)},pt.useLayoutEffect=function(K,N){return He.current.useLayoutEffect(K,N)},pt.useMemo=function(K,N){return He.current.useMemo(K,N)},pt.useReducer=function(K,N,W){return He.current.useReducer(K,N,W)},pt.useRef=function(K){return He.current.useRef(K)},pt.useState=function(K){return He.current.useState(K)},pt.useSyncExternalStore=function(K,N,W){return He.current.useSyncExternalStore(K,N,W)},pt.useTransition=function(){return He.current.useTransition()},pt.version="18.3.1",pt}var Jg;function Uf(){return Jg||(Jg=1,Hh.exports=Zx()),Hh.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xg;function eE(){if(Xg)return El;Xg=1;var n=Uf(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,a=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function d(f,m,v){var w,S={},I=null,U=null;v!==void 0&&(I=""+v),m.key!==void 0&&(I=""+m.key),m.ref!==void 0&&(U=m.ref);for(w in m)s.call(m,w)&&!l.hasOwnProperty(w)&&(S[w]=m[w]);if(f&&f.defaultProps)for(w in m=f.defaultProps,m)S[w]===void 0&&(S[w]=m[w]);return{$$typeof:e,type:f,key:I,ref:U,props:S,_owner:a.current}}return El.Fragment=t,El.jsx=d,El.jsxs=d,El}var Zg;function tE(){return Zg||(Zg=1,Gh.exports=eE()),Gh.exports}var c=tE(),k=Uf();const zf=a_(k),nE=Xx({__proto__:null,default:zf},[k]);var uu={},qh={exports:{}},Er={},Kh={exports:{}},Qh={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ey;function rE(){return ey||(ey=1,(function(n){function e(me,De){var be=me.length;me.push(De);e:for(;0<be;){var K=be-1>>>1,N=me[K];if(0<a(N,De))me[K]=De,me[be]=N,be=K;else break e}}function t(me){return me.length===0?null:me[0]}function s(me){if(me.length===0)return null;var De=me[0],be=me.pop();if(be!==De){me[0]=be;e:for(var K=0,N=me.length,W=N>>>1;K<W;){var ee=2*(K+1)-1,Te=me[ee],_e=ee+1,Le=me[_e];if(0>a(Te,be))_e<N&&0>a(Le,Te)?(me[K]=Le,me[_e]=be,K=_e):(me[K]=Te,me[ee]=be,K=ee);else if(_e<N&&0>a(Le,be))me[K]=Le,me[_e]=be,K=_e;else break e}}return De}function a(me,De){var be=me.sortIndex-De.sortIndex;return be!==0?be:me.id-De.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;n.unstable_now=function(){return l.now()}}else{var d=Date,f=d.now();n.unstable_now=function(){return d.now()-f}}var m=[],v=[],w=1,S=null,I=3,U=!1,Z=!1,Q=!1,M=typeof setTimeout=="function"?setTimeout:null,ne=typeof clearTimeout=="function"?clearTimeout:null,xe=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function we(me){for(var De=t(v);De!==null;){if(De.callback===null)s(v);else if(De.startTime<=me)s(v),De.sortIndex=De.expirationTime,e(m,De);else break;De=t(v)}}function Ee(me){if(Q=!1,we(me),!Z)if(t(m)!==null)Z=!0,Ae(le);else{var De=t(v);De!==null&&He(Ee,De.startTime-me)}}function le(me,De){Z=!1,Q&&(Q=!1,ne(P),P=-1),U=!0;var be=I;try{for(we(De),S=t(m);S!==null&&(!(S.expirationTime>De)||me&&!B());){var K=S.callback;if(typeof K=="function"){S.callback=null,I=S.priorityLevel;var N=K(S.expirationTime<=De);De=n.unstable_now(),typeof N=="function"?S.callback=N:S===t(m)&&s(m),we(De)}else s(m);S=t(m)}if(S!==null)var W=!0;else{var ee=t(v);ee!==null&&He(Ee,ee.startTime-De),W=!1}return W}finally{S=null,I=be,U=!1}}var Re=!1,A=null,P=-1,R=5,O=-1;function B(){return!(n.unstable_now()-O<R)}function D(){if(A!==null){var me=n.unstable_now();O=me;var De=!0;try{De=A(!0,me)}finally{De?b():(Re=!1,A=null)}}else Re=!1}var b;if(typeof xe=="function")b=function(){xe(D)};else if(typeof MessageChannel<"u"){var he=new MessageChannel,$e=he.port2;he.port1.onmessage=D,b=function(){$e.postMessage(null)}}else b=function(){M(D,0)};function Ae(me){A=me,Re||(Re=!0,b())}function He(me,De){P=M(function(){me(n.unstable_now())},De)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(me){me.callback=null},n.unstable_continueExecution=function(){Z||U||(Z=!0,Ae(le))},n.unstable_forceFrameRate=function(me){0>me||125<me?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<me?Math.floor(1e3/me):5},n.unstable_getCurrentPriorityLevel=function(){return I},n.unstable_getFirstCallbackNode=function(){return t(m)},n.unstable_next=function(me){switch(I){case 1:case 2:case 3:var De=3;break;default:De=I}var be=I;I=De;try{return me()}finally{I=be}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(me,De){switch(me){case 1:case 2:case 3:case 4:case 5:break;default:me=3}var be=I;I=me;try{return De()}finally{I=be}},n.unstable_scheduleCallback=function(me,De,be){var K=n.unstable_now();switch(typeof be=="object"&&be!==null?(be=be.delay,be=typeof be=="number"&&0<be?K+be:K):be=K,me){case 1:var N=-1;break;case 2:N=250;break;case 5:N=1073741823;break;case 4:N=1e4;break;default:N=5e3}return N=be+N,me={id:w++,callback:De,priorityLevel:me,startTime:be,expirationTime:N,sortIndex:-1},be>K?(me.sortIndex=be,e(v,me),t(m)===null&&me===t(v)&&(Q?(ne(P),P=-1):Q=!0,He(Ee,be-K))):(me.sortIndex=N,e(m,me),Z||U||(Z=!0,Ae(le))),me},n.unstable_shouldYield=B,n.unstable_wrapCallback=function(me){var De=I;return function(){var be=I;I=De;try{return me.apply(this,arguments)}finally{I=be}}}})(Qh)),Qh}var ty;function sE(){return ty||(ty=1,Kh.exports=rE()),Kh.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ny;function iE(){if(ny)return Er;ny=1;var n=Uf(),e=sE();function t(r){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+r,o=1;o<arguments.length;o++)i+="&args[]="+encodeURIComponent(arguments[o]);return"Minified React error #"+r+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,a={};function l(r,i){d(r,i),d(r+"Capture",i)}function d(r,i){for(a[r]=i,r=0;r<i.length;r++)s.add(i[r])}var f=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),m=Object.prototype.hasOwnProperty,v=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,w={},S={};function I(r){return m.call(S,r)?!0:m.call(w,r)?!1:v.test(r)?S[r]=!0:(w[r]=!0,!1)}function U(r,i,o,h){if(o!==null&&o.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return h?!1:o!==null?!o.acceptsBooleans:(r=r.toLowerCase().slice(0,5),r!=="data-"&&r!=="aria-");default:return!1}}function Z(r,i,o,h){if(i===null||typeof i>"u"||U(r,i,o,h))return!0;if(h)return!1;if(o!==null)switch(o.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function Q(r,i,o,h,p,y,E){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=h,this.attributeNamespace=p,this.mustUseProperty=o,this.propertyName=r,this.type=i,this.sanitizeURL=y,this.removeEmptyString=E}var M={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(r){M[r]=new Q(r,0,!1,r,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(r){var i=r[0];M[i]=new Q(i,1,!1,r[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(r){M[r]=new Q(r,2,!1,r.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(r){M[r]=new Q(r,2,!1,r,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(r){M[r]=new Q(r,3,!1,r.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(r){M[r]=new Q(r,3,!0,r,null,!1,!1)}),["capture","download"].forEach(function(r){M[r]=new Q(r,4,!1,r,null,!1,!1)}),["cols","rows","size","span"].forEach(function(r){M[r]=new Q(r,6,!1,r,null,!1,!1)}),["rowSpan","start"].forEach(function(r){M[r]=new Q(r,5,!1,r.toLowerCase(),null,!1,!1)});var ne=/[\-:]([a-z])/g;function xe(r){return r[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(r){var i=r.replace(ne,xe);M[i]=new Q(i,1,!1,r,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(r){var i=r.replace(ne,xe);M[i]=new Q(i,1,!1,r,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(r){var i=r.replace(ne,xe);M[i]=new Q(i,1,!1,r,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(r){M[r]=new Q(r,1,!1,r.toLowerCase(),null,!1,!1)}),M.xlinkHref=new Q("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(r){M[r]=new Q(r,1,!1,r.toLowerCase(),null,!0,!0)});function we(r,i,o,h){var p=M.hasOwnProperty(i)?M[i]:null;(p!==null?p.type!==0:h||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(Z(i,o,p,h)&&(o=null),h||p===null?I(i)&&(o===null?r.removeAttribute(i):r.setAttribute(i,""+o)):p.mustUseProperty?r[p.propertyName]=o===null?p.type===3?!1:"":o:(i=p.attributeName,h=p.attributeNamespace,o===null?r.removeAttribute(i):(p=p.type,o=p===3||p===4&&o===!0?"":""+o,h?r.setAttributeNS(h,i,o):r.setAttribute(i,o))))}var Ee=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,le=Symbol.for("react.element"),Re=Symbol.for("react.portal"),A=Symbol.for("react.fragment"),P=Symbol.for("react.strict_mode"),R=Symbol.for("react.profiler"),O=Symbol.for("react.provider"),B=Symbol.for("react.context"),D=Symbol.for("react.forward_ref"),b=Symbol.for("react.suspense"),he=Symbol.for("react.suspense_list"),$e=Symbol.for("react.memo"),Ae=Symbol.for("react.lazy"),He=Symbol.for("react.offscreen"),me=Symbol.iterator;function De(r){return r===null||typeof r!="object"?null:(r=me&&r[me]||r["@@iterator"],typeof r=="function"?r:null)}var be=Object.assign,K;function N(r){if(K===void 0)try{throw Error()}catch(o){var i=o.stack.trim().match(/\n( *(at )?)/);K=i&&i[1]||""}return`
`+K+r}var W=!1;function ee(r,i){if(!r||W)return"";W=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(te){var h=te}Reflect.construct(r,[],i)}else{try{i.call()}catch(te){h=te}r.call(i.prototype)}else{try{throw Error()}catch(te){h=te}r()}}catch(te){if(te&&h&&typeof te.stack=="string"){for(var p=te.stack.split(`
`),y=h.stack.split(`
`),E=p.length-1,j=y.length-1;1<=E&&0<=j&&p[E]!==y[j];)j--;for(;1<=E&&0<=j;E--,j--)if(p[E]!==y[j]){if(E!==1||j!==1)do if(E--,j--,0>j||p[E]!==y[j]){var F=`
`+p[E].replace(" at new "," at ");return r.displayName&&F.includes("<anonymous>")&&(F=F.replace("<anonymous>",r.displayName)),F}while(1<=E&&0<=j);break}}}finally{W=!1,Error.prepareStackTrace=o}return(r=r?r.displayName||r.name:"")?N(r):""}function Te(r){switch(r.tag){case 5:return N(r.type);case 16:return N("Lazy");case 13:return N("Suspense");case 19:return N("SuspenseList");case 0:case 2:case 15:return r=ee(r.type,!1),r;case 11:return r=ee(r.type.render,!1),r;case 1:return r=ee(r.type,!0),r;default:return""}}function _e(r){if(r==null)return null;if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case A:return"Fragment";case Re:return"Portal";case R:return"Profiler";case P:return"StrictMode";case b:return"Suspense";case he:return"SuspenseList"}if(typeof r=="object")switch(r.$$typeof){case B:return(r.displayName||"Context")+".Consumer";case O:return(r._context.displayName||"Context")+".Provider";case D:var i=r.render;return r=r.displayName,r||(r=i.displayName||i.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case $e:return i=r.displayName||null,i!==null?i:_e(r.type)||"Memo";case Ae:i=r._payload,r=r._init;try{return _e(r(i))}catch{}}return null}function Le(r){var i=r.type;switch(r.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return r=i.render,r=r.displayName||r.name||"",i.displayName||(r!==""?"ForwardRef("+r+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return _e(i);case 8:return i===P?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function qe(r){switch(typeof r){case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function rt(r){var i=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function vt(r){var i=rt(r)?"checked":"value",o=Object.getOwnPropertyDescriptor(r.constructor.prototype,i),h=""+r[i];if(!r.hasOwnProperty(i)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var p=o.get,y=o.set;return Object.defineProperty(r,i,{configurable:!0,get:function(){return p.call(this)},set:function(E){h=""+E,y.call(this,E)}}),Object.defineProperty(r,i,{enumerable:o.enumerable}),{getValue:function(){return h},setValue:function(E){h=""+E},stopTracking:function(){r._valueTracker=null,delete r[i]}}}}function fe(r){r._valueTracker||(r._valueTracker=vt(r))}function We(r){if(!r)return!1;var i=r._valueTracker;if(!i)return!0;var o=i.getValue(),h="";return r&&(h=rt(r)?r.checked?"true":"false":r.value),r=h,r!==o?(i.setValue(r),!0):!1}function ue(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}function Qe(r,i){var o=i.checked;return be({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:o??r._wrapperState.initialChecked})}function Je(r,i){var o=i.defaultValue==null?"":i.defaultValue,h=i.checked!=null?i.checked:i.defaultChecked;o=qe(i.value!=null?i.value:o),r._wrapperState={initialChecked:h,initialValue:o,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function Rt(r,i){i=i.checked,i!=null&&we(r,"checked",i,!1)}function kt(r,i){Rt(r,i);var o=qe(i.value),h=i.type;if(o!=null)h==="number"?(o===0&&r.value===""||r.value!=o)&&(r.value=""+o):r.value!==""+o&&(r.value=""+o);else if(h==="submit"||h==="reset"){r.removeAttribute("value");return}i.hasOwnProperty("value")?jt(r,i.type,o):i.hasOwnProperty("defaultValue")&&jt(r,i.type,qe(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(r.defaultChecked=!!i.defaultChecked)}function St(r,i,o){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var h=i.type;if(!(h!=="submit"&&h!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+r._wrapperState.initialValue,o||i===r.value||(r.value=i),r.defaultValue=i}o=r.name,o!==""&&(r.name=""),r.defaultChecked=!!r._wrapperState.initialChecked,o!==""&&(r.name=o)}function jt(r,i,o){(i!=="number"||ue(r.ownerDocument)!==r)&&(o==null?r.defaultValue=""+r._wrapperState.initialValue:r.defaultValue!==""+o&&(r.defaultValue=""+o))}var on=Array.isArray;function Sn(r,i,o,h){if(r=r.options,i){i={};for(var p=0;p<o.length;p++)i["$"+o[p]]=!0;for(o=0;o<r.length;o++)p=i.hasOwnProperty("$"+r[o].value),r[o].selected!==p&&(r[o].selected=p),p&&h&&(r[o].defaultSelected=!0)}else{for(o=""+qe(o),i=null,p=0;p<r.length;p++){if(r[p].value===o){r[p].selected=!0,h&&(r[p].defaultSelected=!0);return}i!==null||r[p].disabled||(i=r[p])}i!==null&&(i.selected=!0)}}function ln(r,i){if(i.dangerouslySetInnerHTML!=null)throw Error(t(91));return be({},i,{value:void 0,defaultValue:void 0,children:""+r._wrapperState.initialValue})}function fr(r,i){var o=i.value;if(o==null){if(o=i.children,i=i.defaultValue,o!=null){if(i!=null)throw Error(t(92));if(on(o)){if(1<o.length)throw Error(t(93));o=o[0]}i=o}i==null&&(i=""),o=i}r._wrapperState={initialValue:qe(o)}}function Xt(r,i){var o=qe(i.value),h=qe(i.defaultValue);o!=null&&(o=""+o,o!==r.value&&(r.value=o),i.defaultValue==null&&r.defaultValue!==o&&(r.defaultValue=o)),h!=null&&(r.defaultValue=""+h)}function qn(r){var i=r.textContent;i===r._wrapperState.initialValue&&i!==""&&i!==null&&(r.value=i)}function Ot(r){switch(r){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function $t(r,i){return r==null||r==="http://www.w3.org/1999/xhtml"?Ot(i):r==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":r}var On,lr=(function(r){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,o,h,p){MSApp.execUnsafeLocalFunction(function(){return r(i,o,h,p)})}:r})(function(r,i){if(r.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in r)r.innerHTML=i;else{for(On=On||document.createElement("div"),On.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=On.firstChild;r.firstChild;)r.removeChild(r.firstChild);for(;i.firstChild;)r.appendChild(i.firstChild)}});function Cn(r,i){if(i){var o=r.firstChild;if(o&&o===r.lastChild&&o.nodeType===3){o.nodeValue=i;return}}r.textContent=i}var Mn={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Qt=["Webkit","ms","Moz","O"];Object.keys(Mn).forEach(function(r){Qt.forEach(function(i){i=i+r.charAt(0).toUpperCase()+r.substring(1),Mn[i]=Mn[r]})});function Zr(r,i,o){return i==null||typeof i=="boolean"||i===""?"":o||typeof i!="number"||i===0||Mn.hasOwnProperty(r)&&Mn[r]?(""+i).trim():i+"px"}function In(r,i){r=r.style;for(var o in i)if(i.hasOwnProperty(o)){var h=o.indexOf("--")===0,p=Zr(o,i[o],h);o==="float"&&(o="cssFloat"),h?r.setProperty(o,p):r[o]=p}}var pn=be({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function es(r,i){if(i){if(pn[r]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(t(137,r));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(t(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(t(61))}if(i.style!=null&&typeof i.style!="object")throw Error(t(62))}}function ws(r,i){if(r.indexOf("-")===-1)return typeof i.is=="string";switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var It=null;function pr(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var xs=null,Kn=null,Qn=null;function br(r){if(r=ol(r)){if(typeof xs!="function")throw Error(t(280));var i=r.stateNode;i&&(i=Cc(i),xs(r.stateNode,r.type,i))}}function bn(r){Kn?Qn?Qn.push(r):Qn=[r]:Kn=r}function Pr(){if(Kn){var r=Kn,i=Qn;if(Qn=Kn=null,br(r),i)for(r=0;r<i.length;r++)br(i[r])}}function Yn(r,i){return r(i)}function $s(){}var mr=!1;function Ws(r,i,o){if(mr)return r(i,o);mr=!0;try{return Yn(r,i,o)}finally{mr=!1,(Kn!==null||Qn!==null)&&($s(),Pr())}}function tt(r,i){var o=r.stateNode;if(o===null)return null;var h=Cc(o);if(h===null)return null;o=h[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(r=r.type,h=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!h;break e;default:r=!1}if(r)return null;if(o&&typeof o!="function")throw Error(t(231,i,typeof o));return o}var Jn=!1;if(f)try{var Pn={};Object.defineProperty(Pn,"passive",{get:function(){Jn=!0}}),window.addEventListener("test",Pn,Pn),window.removeEventListener("test",Pn,Pn)}catch{Jn=!1}function ts(r,i,o,h,p,y,E,j,F){var te=Array.prototype.slice.call(arguments,3);try{i.apply(o,te)}catch(ge){this.onError(ge)}}var Rn=!1,mn=null,Nn=!1,Es=null,Ts={onError:function(r){Rn=!0,mn=r}};function Fn(r,i,o,h,p,y,E,j,F){Rn=!1,mn=null,ts.apply(Ts,arguments)}function Fr(r,i,o,h,p,y,E,j,F){if(Fn.apply(this,arguments),Rn){if(Rn){var te=mn;Rn=!1,mn=null}else throw Error(t(198));Nn||(Nn=!0,Es=te)}}function Mt(r){var i=r,o=r;if(r.alternate)for(;i.return;)i=i.return;else{r=i;do i=r,(i.flags&4098)!==0&&(o=i.return),r=i.return;while(r)}return i.tag===3?o:null}function ns(r){if(r.tag===13){var i=r.memoizedState;if(i===null&&(r=r.alternate,r!==null&&(i=r.memoizedState)),i!==null)return i.dehydrated}return null}function cn(r){if(Mt(r)!==r)throw Error(t(188))}function Rr(r){var i=r.alternate;if(!i){if(i=Mt(r),i===null)throw Error(t(188));return i!==r?null:r}for(var o=r,h=i;;){var p=o.return;if(p===null)break;var y=p.alternate;if(y===null){if(h=p.return,h!==null){o=h;continue}break}if(p.child===y.child){for(y=p.child;y;){if(y===o)return cn(p),r;if(y===h)return cn(p),i;y=y.sibling}throw Error(t(188))}if(o.return!==h.return)o=p,h=y;else{for(var E=!1,j=p.child;j;){if(j===o){E=!0,o=p,h=y;break}if(j===h){E=!0,h=p,o=y;break}j=j.sibling}if(!E){for(j=y.child;j;){if(j===o){E=!0,o=y,h=p;break}if(j===h){E=!0,h=y,o=p;break}j=j.sibling}if(!E)throw Error(t(189))}}if(o.alternate!==h)throw Error(t(190))}if(o.tag!==3)throw Error(t(188));return o.stateNode.current===o?r:i}function Gs(r){return r=Rr(r),r!==null?Ur(r):null}function Ur(r){if(r.tag===5||r.tag===6)return r;for(r=r.child;r!==null;){var i=Ur(r);if(i!==null)return i;r=r.sibling}return null}var rs=e.unstable_scheduleCallback,gn=e.unstable_cancelCallback,Hs=e.unstable_shouldYield,qs=e.unstable_requestPaint,ut=e.unstable_now,ss=e.unstable_getCurrentPriorityLevel,An=e.unstable_ImmediatePriority,x=e.unstable_UserBlockingPriority,$=e.unstable_NormalPriority,z=e.unstable_LowPriority,L=e.unstable_IdlePriority,q=null,ie=null;function se(r){if(ie&&typeof ie.onCommitFiberRoot=="function")try{ie.onCommitFiberRoot(q,r,void 0,(r.current.flags&128)===128)}catch{}}var Se=Math.clz32?Math.clz32:ae,Ce=Math.log,Ne=Math.LN2;function ae(r){return r>>>=0,r===0?32:31-(Ce(r)/Ne|0)|0}var it=64,ke=4194304;function dt(r){switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return r&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return r}}function cr(r,i){var o=r.pendingLanes;if(o===0)return 0;var h=0,p=r.suspendedLanes,y=r.pingedLanes,E=o&268435455;if(E!==0){var j=E&~p;j!==0?h=dt(j):(y&=E,y!==0&&(h=dt(y)))}else E=o&~p,E!==0?h=dt(E):y!==0&&(h=dt(y));if(h===0)return 0;if(i!==0&&i!==h&&(i&p)===0&&(p=h&-h,y=i&-i,p>=y||p===16&&(y&4194240)!==0))return i;if((h&4)!==0&&(h|=o&16),i=r.entangledLanes,i!==0)for(r=r.entanglements,i&=h;0<i;)o=31-Se(i),p=1<<o,h|=r[o],i&=~p;return h}function Ks(r,i){switch(r){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function yn(r,i){for(var o=r.suspendedLanes,h=r.pingedLanes,p=r.expirationTimes,y=r.pendingLanes;0<y;){var E=31-Se(y),j=1<<E,F=p[E];F===-1?((j&o)===0||(j&h)!==0)&&(p[E]=Ks(j,i)):F<=i&&(r.expiredLanes|=j),y&=~j}}function Yt(r){return r=r.pendingLanes&-1073741825,r!==0?r:r&1073741824?1073741824:0}function is(){var r=it;return it<<=1,(it&4194240)===0&&(it=64),r}function as(r){for(var i=[],o=0;31>o;o++)i.push(r);return i}function os(r,i,o){r.pendingLanes|=i,i!==536870912&&(r.suspendedLanes=0,r.pingedLanes=0),r=r.eventTimes,i=31-Se(i),r[i]=o}function bt(r,i){var o=r.pendingLanes&~i;r.pendingLanes=i,r.suspendedLanes=0,r.pingedLanes=0,r.expiredLanes&=i,r.mutableReadLanes&=i,r.entangledLanes&=i,i=r.entanglements;var h=r.eventTimes;for(r=r.expirationTimes;0<o;){var p=31-Se(o),y=1<<p;i[p]=0,h[p]=-1,r[p]=-1,o&=~y}}function Ss(r,i){var o=r.entangledLanes|=i;for(r=r.entanglements;o;){var h=31-Se(o),p=1<<h;p&i|r[h]&i&&(r[h]|=i),o&=~p}}var ft=0;function Cs(r){return r&=-r,1<r?4<r?(r&268435455)!==0?16:536870912:4:1}var T,V,H,oe,ye,Ue=!1,Ie=[],Ke=null,ct=null,mt=null,Dt=new Map,Et=new Map,Zt=[],vn="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function _t(r,i){switch(r){case"focusin":case"focusout":Ke=null;break;case"dragenter":case"dragleave":ct=null;break;case"mouseover":case"mouseout":mt=null;break;case"pointerover":case"pointerout":Dt.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Et.delete(i.pointerId)}}function en(r,i,o,h,p,y){return r===null||r.nativeEvent!==y?(r={blockedOn:i,domEventName:o,eventSystemFlags:h,nativeEvent:y,targetContainers:[p]},i!==null&&(i=ol(i),i!==null&&V(i)),r):(r.eventSystemFlags|=h,i=r.targetContainers,p!==null&&i.indexOf(p)===-1&&i.push(p),r)}function Xn(r,i,o,h,p){switch(i){case"focusin":return Ke=en(Ke,r,i,o,h,p),!0;case"dragenter":return ct=en(ct,r,i,o,h,p),!0;case"mouseover":return mt=en(mt,r,i,o,h,p),!0;case"pointerover":var y=p.pointerId;return Dt.set(y,en(Dt.get(y)||null,r,i,o,h,p)),!0;case"gotpointercapture":return y=p.pointerId,Et.set(y,en(Et.get(y)||null,r,i,o,h,p)),!0}return!1}function zr(r){var i=da(r.target);if(i!==null){var o=Mt(i);if(o!==null){if(i=o.tag,i===13){if(i=ns(o),i!==null){r.blockedOn=i,ye(r.priority,function(){H(o)});return}}else if(i===3&&o.stateNode.current.memoizedState.isDehydrated){r.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Nr(r){if(r.blockedOn!==null)return!1;for(var i=r.targetContainers;0<i.length;){var o=Ma(r.domEventName,r.eventSystemFlags,i[0],r.nativeEvent);if(o===null){o=r.nativeEvent;var h=new o.constructor(o.type,o);It=h,o.target.dispatchEvent(h),It=null}else return i=ol(o),i!==null&&V(i),r.blockedOn=o,!1;i.shift()}return!0}function Qs(r,i,o){Nr(r)&&o.delete(i)}function Oa(){Ue=!1,Ke!==null&&Nr(Ke)&&(Ke=null),ct!==null&&Nr(ct)&&(ct=null),mt!==null&&Nr(mt)&&(mt=null),Dt.forEach(Qs),Et.forEach(Qs)}function Ar(r,i){r.blockedOn===i&&(r.blockedOn=null,Ue||(Ue=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Oa)))}function Un(r){function i(p){return Ar(p,r)}if(0<Ie.length){Ar(Ie[0],r);for(var o=1;o<Ie.length;o++){var h=Ie[o];h.blockedOn===r&&(h.blockedOn=null)}}for(Ke!==null&&Ar(Ke,r),ct!==null&&Ar(ct,r),mt!==null&&Ar(mt,r),Dt.forEach(i),Et.forEach(i),o=0;o<Zt.length;o++)h=Zt[o],h.blockedOn===r&&(h.blockedOn=null);for(;0<Zt.length&&(o=Zt[0],o.blockedOn===null);)zr(o),o.blockedOn===null&&Zt.shift()}var ls=Ee.ReactCurrentBatchConfig,wi=!0;function Wt(r,i,o,h){var p=ft,y=ls.transition;ls.transition=null;try{ft=1,qo(r,i,o,h)}finally{ft=p,ls.transition=y}}function Sd(r,i,o,h){var p=ft,y=ls.transition;ls.transition=null;try{ft=4,qo(r,i,o,h)}finally{ft=p,ls.transition=y}}function qo(r,i,o,h){if(wi){var p=Ma(r,i,o,h);if(p===null)Ld(r,i,h,la,o),_t(r,h);else if(Xn(p,r,i,o,h))h.stopPropagation();else if(_t(r,h),i&4&&-1<vn.indexOf(r)){for(;p!==null;){var y=ol(p);if(y!==null&&T(y),y=Ma(r,i,o,h),y===null&&Ld(r,i,h,la,o),y===p)break;p=y}p!==null&&h.stopPropagation()}else Ld(r,i,h,null,o)}}var la=null;function Ma(r,i,o,h){if(la=null,r=pr(h),r=da(r),r!==null)if(i=Mt(r),i===null)r=null;else if(o=i.tag,o===13){if(r=ns(i),r!==null)return r;r=null}else if(o===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;r=null}else i!==r&&(r=null);return la=r,null}function Ko(r){switch(r){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ss()){case An:return 1;case x:return 4;case $:case z:return 16;case L:return 536870912;default:return 16}default:return 16}}var kr=null,Fa=null,gr=null;function Qo(){if(gr)return gr;var r,i=Fa,o=i.length,h,p="value"in kr?kr.value:kr.textContent,y=p.length;for(r=0;r<o&&i[r]===p[r];r++);var E=o-r;for(h=1;h<=E&&i[o-h]===p[y-h];h++);return gr=p.slice(r,1<h?1-h:void 0)}function Ua(r){var i=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&i===13&&(r=13)):r=i,r===10&&(r=13),32<=r||r===13?r:0}function Is(){return!0}function Yo(){return!1}function zn(r){function i(o,h,p,y,E){this._reactName=o,this._targetInst=p,this.type=h,this.nativeEvent=y,this.target=E,this.currentTarget=null;for(var j in r)r.hasOwnProperty(j)&&(o=r[j],this[j]=o?o(y):y[j]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?Is:Yo,this.isPropagationStopped=Yo,this}return be(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=Is)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=Is)},persist:function(){},isPersistent:Is}),i}var cs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},za=zn(cs),bs=be({},cs,{view:0,detail:0}),Cd=zn(bs),Ba,Ys,xi,ca=be({},bs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ps,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==xi&&(xi&&r.type==="mousemove"?(Ba=r.screenX-xi.screenX,Ys=r.screenY-xi.screenY):Ys=Ba=0,xi=r),Ba)},movementY:function(r){return"movementY"in r?r.movementY:Ys}}),$a=zn(ca),Jo=be({},ca,{dataTransfer:0}),dc=zn(Jo),Wa=be({},bs,{relatedTarget:0}),Ga=zn(Wa),hc=be({},cs,{animationName:0,elapsedTime:0,pseudoElement:0}),Js=zn(hc),fc=be({},cs,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),pc=zn(fc),mc=be({},cs,{data:0}),Xo=zn(mc),Ha={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ur={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},gc={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function yc(r){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(r):(r=gc[r])?!!i[r]:!1}function Ps(){return yc}var u=be({},bs,{key:function(r){if(r.key){var i=Ha[r.key]||r.key;if(i!=="Unidentified")return i}return r.type==="keypress"?(r=Ua(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?ur[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ps,charCode:function(r){return r.type==="keypress"?Ua(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?Ua(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),g=zn(u),_=be({},ca,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),C=zn(_),Y=be({},bs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ps}),re=zn(Y),je=be({},cs,{propertyName:0,elapsedTime:0,pseudoElement:0}),Nt=zn(je),_n=be({},ca,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),wt=zn(_n),kn=[9,13,27,32],un=f&&"CompositionEvent"in window,Br=null;f&&"documentMode"in document&&(Br=document.documentMode);var jr=f&&"TextEvent"in window&&!Br,ua=f&&(!un||Br&&8<Br&&11>=Br),qa=" ",Wp=!1;function Gp(r,i){switch(r){case"keyup":return kn.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Hp(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var Ka=!1;function Qw(r,i){switch(r){case"compositionend":return Hp(i);case"keypress":return i.which!==32?null:(Wp=!0,qa);case"textInput":return r=i.data,r===qa&&Wp?null:r;default:return null}}function Yw(r,i){if(Ka)return r==="compositionend"||!un&&Gp(r,i)?(r=Qo(),gr=Fa=kr=null,Ka=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return ua&&i.locale!=="ko"?null:i.data;default:return null}}var Jw={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qp(r){var i=r&&r.nodeName&&r.nodeName.toLowerCase();return i==="input"?!!Jw[r.type]:i==="textarea"}function Kp(r,i,o,h){bn(h),i=Ec(i,"onChange"),0<i.length&&(o=new za("onChange","change",null,o,h),r.push({event:o,listeners:i}))}var Zo=null,el=null;function Xw(r){hm(r,0)}function vc(r){var i=Za(r);if(We(i))return r}function Zw(r,i){if(r==="change")return i}var Qp=!1;if(f){var Id;if(f){var bd="oninput"in document;if(!bd){var Yp=document.createElement("div");Yp.setAttribute("oninput","return;"),bd=typeof Yp.oninput=="function"}Id=bd}else Id=!1;Qp=Id&&(!document.documentMode||9<document.documentMode)}function Jp(){Zo&&(Zo.detachEvent("onpropertychange",Xp),el=Zo=null)}function Xp(r){if(r.propertyName==="value"&&vc(el)){var i=[];Kp(i,el,r,pr(r)),Ws(Xw,i)}}function ex(r,i,o){r==="focusin"?(Jp(),Zo=i,el=o,Zo.attachEvent("onpropertychange",Xp)):r==="focusout"&&Jp()}function tx(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return vc(el)}function nx(r,i){if(r==="click")return vc(i)}function rx(r,i){if(r==="input"||r==="change")return vc(i)}function sx(r,i){return r===i&&(r!==0||1/r===1/i)||r!==r&&i!==i}var us=typeof Object.is=="function"?Object.is:sx;function tl(r,i){if(us(r,i))return!0;if(typeof r!="object"||r===null||typeof i!="object"||i===null)return!1;var o=Object.keys(r),h=Object.keys(i);if(o.length!==h.length)return!1;for(h=0;h<o.length;h++){var p=o[h];if(!m.call(i,p)||!us(r[p],i[p]))return!1}return!0}function Zp(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function em(r,i){var o=Zp(r);r=0;for(var h;o;){if(o.nodeType===3){if(h=r+o.textContent.length,r<=i&&h>=i)return{node:o,offset:i-r};r=h}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=Zp(o)}}function tm(r,i){return r&&i?r===i?!0:r&&r.nodeType===3?!1:i&&i.nodeType===3?tm(r,i.parentNode):"contains"in r?r.contains(i):r.compareDocumentPosition?!!(r.compareDocumentPosition(i)&16):!1:!1}function nm(){for(var r=window,i=ue();i instanceof r.HTMLIFrameElement;){try{var o=typeof i.contentWindow.location.href=="string"}catch{o=!1}if(o)r=i.contentWindow;else break;i=ue(r.document)}return i}function Pd(r){var i=r&&r.nodeName&&r.nodeName.toLowerCase();return i&&(i==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||i==="textarea"||r.contentEditable==="true")}function ix(r){var i=nm(),o=r.focusedElem,h=r.selectionRange;if(i!==o&&o&&o.ownerDocument&&tm(o.ownerDocument.documentElement,o)){if(h!==null&&Pd(o)){if(i=h.start,r=h.end,r===void 0&&(r=i),"selectionStart"in o)o.selectionStart=i,o.selectionEnd=Math.min(r,o.value.length);else if(r=(i=o.ownerDocument||document)&&i.defaultView||window,r.getSelection){r=r.getSelection();var p=o.textContent.length,y=Math.min(h.start,p);h=h.end===void 0?y:Math.min(h.end,p),!r.extend&&y>h&&(p=h,h=y,y=p),p=em(o,y);var E=em(o,h);p&&E&&(r.rangeCount!==1||r.anchorNode!==p.node||r.anchorOffset!==p.offset||r.focusNode!==E.node||r.focusOffset!==E.offset)&&(i=i.createRange(),i.setStart(p.node,p.offset),r.removeAllRanges(),y>h?(r.addRange(i),r.extend(E.node,E.offset)):(i.setEnd(E.node,E.offset),r.addRange(i)))}}for(i=[],r=o;r=r.parentNode;)r.nodeType===1&&i.push({element:r,left:r.scrollLeft,top:r.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<i.length;o++)r=i[o],r.element.scrollLeft=r.left,r.element.scrollTop=r.top}}var ax=f&&"documentMode"in document&&11>=document.documentMode,Qa=null,Rd=null,nl=null,Nd=!1;function rm(r,i,o){var h=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Nd||Qa==null||Qa!==ue(h)||(h=Qa,"selectionStart"in h&&Pd(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),nl&&tl(nl,h)||(nl=h,h=Ec(Rd,"onSelect"),0<h.length&&(i=new za("onSelect","select",null,i,o),r.push({event:i,listeners:h}),i.target=Qa)))}function _c(r,i){var o={};return o[r.toLowerCase()]=i.toLowerCase(),o["Webkit"+r]="webkit"+i,o["Moz"+r]="moz"+i,o}var Ya={animationend:_c("Animation","AnimationEnd"),animationiteration:_c("Animation","AnimationIteration"),animationstart:_c("Animation","AnimationStart"),transitionend:_c("Transition","TransitionEnd")},Ad={},sm={};f&&(sm=document.createElement("div").style,"AnimationEvent"in window||(delete Ya.animationend.animation,delete Ya.animationiteration.animation,delete Ya.animationstart.animation),"TransitionEvent"in window||delete Ya.transitionend.transition);function wc(r){if(Ad[r])return Ad[r];if(!Ya[r])return r;var i=Ya[r],o;for(o in i)if(i.hasOwnProperty(o)&&o in sm)return Ad[r]=i[o];return r}var im=wc("animationend"),am=wc("animationiteration"),om=wc("animationstart"),lm=wc("transitionend"),cm=new Map,um="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ei(r,i){cm.set(r,i),l(i,[r])}for(var kd=0;kd<um.length;kd++){var jd=um[kd],ox=jd.toLowerCase(),lx=jd[0].toUpperCase()+jd.slice(1);Ei(ox,"on"+lx)}Ei(im,"onAnimationEnd"),Ei(am,"onAnimationIteration"),Ei(om,"onAnimationStart"),Ei("dblclick","onDoubleClick"),Ei("focusin","onFocus"),Ei("focusout","onBlur"),Ei(lm,"onTransitionEnd"),d("onMouseEnter",["mouseout","mouseover"]),d("onMouseLeave",["mouseout","mouseover"]),d("onPointerEnter",["pointerout","pointerover"]),d("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var rl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),cx=new Set("cancel close invalid load scroll toggle".split(" ").concat(rl));function dm(r,i,o){var h=r.type||"unknown-event";r.currentTarget=o,Fr(h,i,void 0,r),r.currentTarget=null}function hm(r,i){i=(i&4)!==0;for(var o=0;o<r.length;o++){var h=r[o],p=h.event;h=h.listeners;e:{var y=void 0;if(i)for(var E=h.length-1;0<=E;E--){var j=h[E],F=j.instance,te=j.currentTarget;if(j=j.listener,F!==y&&p.isPropagationStopped())break e;dm(p,j,te),y=F}else for(E=0;E<h.length;E++){if(j=h[E],F=j.instance,te=j.currentTarget,j=j.listener,F!==y&&p.isPropagationStopped())break e;dm(p,j,te),y=F}}}if(Nn)throw r=Es,Nn=!1,Es=null,r}function Ft(r,i){var o=i[zd];o===void 0&&(o=i[zd]=new Set);var h=r+"__bubble";o.has(h)||(fm(i,r,2,!1),o.add(h))}function Dd(r,i,o){var h=0;i&&(h|=4),fm(o,r,h,i)}var xc="_reactListening"+Math.random().toString(36).slice(2);function sl(r){if(!r[xc]){r[xc]=!0,s.forEach(function(o){o!=="selectionchange"&&(cx.has(o)||Dd(o,!1,r),Dd(o,!0,r))});var i=r.nodeType===9?r:r.ownerDocument;i===null||i[xc]||(i[xc]=!0,Dd("selectionchange",!1,i))}}function fm(r,i,o,h){switch(Ko(i)){case 1:var p=Wt;break;case 4:p=Sd;break;default:p=qo}o=p.bind(null,i,o,r),p=void 0,!Jn||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(p=!0),h?p!==void 0?r.addEventListener(i,o,{capture:!0,passive:p}):r.addEventListener(i,o,!0):p!==void 0?r.addEventListener(i,o,{passive:p}):r.addEventListener(i,o,!1)}function Ld(r,i,o,h,p){var y=h;if((i&1)===0&&(i&2)===0&&h!==null)e:for(;;){if(h===null)return;var E=h.tag;if(E===3||E===4){var j=h.stateNode.containerInfo;if(j===p||j.nodeType===8&&j.parentNode===p)break;if(E===4)for(E=h.return;E!==null;){var F=E.tag;if((F===3||F===4)&&(F=E.stateNode.containerInfo,F===p||F.nodeType===8&&F.parentNode===p))return;E=E.return}for(;j!==null;){if(E=da(j),E===null)return;if(F=E.tag,F===5||F===6){h=y=E;continue e}j=j.parentNode}}h=h.return}Ws(function(){var te=y,ge=pr(o),ve=[];e:{var pe=cm.get(r);if(pe!==void 0){var Ve=za,Fe=r;switch(r){case"keypress":if(Ua(o)===0)break e;case"keydown":case"keyup":Ve=g;break;case"focusin":Fe="focus",Ve=Ga;break;case"focusout":Fe="blur",Ve=Ga;break;case"beforeblur":case"afterblur":Ve=Ga;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ve=$a;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ve=dc;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ve=re;break;case im:case am:case om:Ve=Js;break;case lm:Ve=Nt;break;case"scroll":Ve=Cd;break;case"wheel":Ve=wt;break;case"copy":case"cut":case"paste":Ve=pc;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ve=C}var ze=(i&4)!==0,tn=!ze&&r==="scroll",J=ze?pe!==null?pe+"Capture":null:pe;ze=[];for(var G=te,X;G!==null;){X=G;var Pe=X.stateNode;if(X.tag===5&&Pe!==null&&(X=Pe,J!==null&&(Pe=tt(G,J),Pe!=null&&ze.push(il(G,Pe,X)))),tn)break;G=G.return}0<ze.length&&(pe=new Ve(pe,Fe,null,o,ge),ve.push({event:pe,listeners:ze}))}}if((i&7)===0){e:{if(pe=r==="mouseover"||r==="pointerover",Ve=r==="mouseout"||r==="pointerout",pe&&o!==It&&(Fe=o.relatedTarget||o.fromElement)&&(da(Fe)||Fe[Xs]))break e;if((Ve||pe)&&(pe=ge.window===ge?ge:(pe=ge.ownerDocument)?pe.defaultView||pe.parentWindow:window,Ve?(Fe=o.relatedTarget||o.toElement,Ve=te,Fe=Fe?da(Fe):null,Fe!==null&&(tn=Mt(Fe),Fe!==tn||Fe.tag!==5&&Fe.tag!==6)&&(Fe=null)):(Ve=null,Fe=te),Ve!==Fe)){if(ze=$a,Pe="onMouseLeave",J="onMouseEnter",G="mouse",(r==="pointerout"||r==="pointerover")&&(ze=C,Pe="onPointerLeave",J="onPointerEnter",G="pointer"),tn=Ve==null?pe:Za(Ve),X=Fe==null?pe:Za(Fe),pe=new ze(Pe,G+"leave",Ve,o,ge),pe.target=tn,pe.relatedTarget=X,Pe=null,da(ge)===te&&(ze=new ze(J,G+"enter",Fe,o,ge),ze.target=X,ze.relatedTarget=tn,Pe=ze),tn=Pe,Ve&&Fe)t:{for(ze=Ve,J=Fe,G=0,X=ze;X;X=Ja(X))G++;for(X=0,Pe=J;Pe;Pe=Ja(Pe))X++;for(;0<G-X;)ze=Ja(ze),G--;for(;0<X-G;)J=Ja(J),X--;for(;G--;){if(ze===J||J!==null&&ze===J.alternate)break t;ze=Ja(ze),J=Ja(J)}ze=null}else ze=null;Ve!==null&&pm(ve,pe,Ve,ze,!1),Fe!==null&&tn!==null&&pm(ve,tn,Fe,ze,!0)}}e:{if(pe=te?Za(te):window,Ve=pe.nodeName&&pe.nodeName.toLowerCase(),Ve==="select"||Ve==="input"&&pe.type==="file")var Ge=Zw;else if(qp(pe))if(Qp)Ge=rx;else{Ge=tx;var Xe=ex}else(Ve=pe.nodeName)&&Ve.toLowerCase()==="input"&&(pe.type==="checkbox"||pe.type==="radio")&&(Ge=nx);if(Ge&&(Ge=Ge(r,te))){Kp(ve,Ge,o,ge);break e}Xe&&Xe(r,pe,te),r==="focusout"&&(Xe=pe._wrapperState)&&Xe.controlled&&pe.type==="number"&&jt(pe,"number",pe.value)}switch(Xe=te?Za(te):window,r){case"focusin":(qp(Xe)||Xe.contentEditable==="true")&&(Qa=Xe,Rd=te,nl=null);break;case"focusout":nl=Rd=Qa=null;break;case"mousedown":Nd=!0;break;case"contextmenu":case"mouseup":case"dragend":Nd=!1,rm(ve,o,ge);break;case"selectionchange":if(ax)break;case"keydown":case"keyup":rm(ve,o,ge)}var Ze;if(un)e:{switch(r){case"compositionstart":var st="onCompositionStart";break e;case"compositionend":st="onCompositionEnd";break e;case"compositionupdate":st="onCompositionUpdate";break e}st=void 0}else Ka?Gp(r,o)&&(st="onCompositionEnd"):r==="keydown"&&o.keyCode===229&&(st="onCompositionStart");st&&(ua&&o.locale!=="ko"&&(Ka||st!=="onCompositionStart"?st==="onCompositionEnd"&&Ka&&(Ze=Qo()):(kr=ge,Fa="value"in kr?kr.value:kr.textContent,Ka=!0)),Xe=Ec(te,st),0<Xe.length&&(st=new Xo(st,r,null,o,ge),ve.push({event:st,listeners:Xe}),Ze?st.data=Ze:(Ze=Hp(o),Ze!==null&&(st.data=Ze)))),(Ze=jr?Qw(r,o):Yw(r,o))&&(te=Ec(te,"onBeforeInput"),0<te.length&&(ge=new Xo("onBeforeInput","beforeinput",null,o,ge),ve.push({event:ge,listeners:te}),ge.data=Ze))}hm(ve,i)})}function il(r,i,o){return{instance:r,listener:i,currentTarget:o}}function Ec(r,i){for(var o=i+"Capture",h=[];r!==null;){var p=r,y=p.stateNode;p.tag===5&&y!==null&&(p=y,y=tt(r,o),y!=null&&h.unshift(il(r,y,p)),y=tt(r,i),y!=null&&h.push(il(r,y,p))),r=r.return}return h}function Ja(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5);return r||null}function pm(r,i,o,h,p){for(var y=i._reactName,E=[];o!==null&&o!==h;){var j=o,F=j.alternate,te=j.stateNode;if(F!==null&&F===h)break;j.tag===5&&te!==null&&(j=te,p?(F=tt(o,y),F!=null&&E.unshift(il(o,F,j))):p||(F=tt(o,y),F!=null&&E.push(il(o,F,j)))),o=o.return}E.length!==0&&r.push({event:i,listeners:E})}var ux=/\r\n?/g,dx=/\u0000|\uFFFD/g;function mm(r){return(typeof r=="string"?r:""+r).replace(ux,`
`).replace(dx,"")}function Tc(r,i,o){if(i=mm(i),mm(r)!==i&&o)throw Error(t(425))}function Sc(){}var Vd=null,Od=null;function Md(r,i){return r==="textarea"||r==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Fd=typeof setTimeout=="function"?setTimeout:void 0,hx=typeof clearTimeout=="function"?clearTimeout:void 0,gm=typeof Promise=="function"?Promise:void 0,fx=typeof queueMicrotask=="function"?queueMicrotask:typeof gm<"u"?function(r){return gm.resolve(null).then(r).catch(px)}:Fd;function px(r){setTimeout(function(){throw r})}function Ud(r,i){var o=i,h=0;do{var p=o.nextSibling;if(r.removeChild(o),p&&p.nodeType===8)if(o=p.data,o==="/$"){if(h===0){r.removeChild(p),Un(i);return}h--}else o!=="$"&&o!=="$?"&&o!=="$!"||h++;o=p}while(o);Un(i)}function Ti(r){for(;r!=null;r=r.nextSibling){var i=r.nodeType;if(i===1||i===3)break;if(i===8){if(i=r.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return r}function ym(r){r=r.previousSibling;for(var i=0;r;){if(r.nodeType===8){var o=r.data;if(o==="$"||o==="$!"||o==="$?"){if(i===0)return r;i--}else o==="/$"&&i++}r=r.previousSibling}return null}var Xa=Math.random().toString(36).slice(2),Rs="__reactFiber$"+Xa,al="__reactProps$"+Xa,Xs="__reactContainer$"+Xa,zd="__reactEvents$"+Xa,mx="__reactListeners$"+Xa,gx="__reactHandles$"+Xa;function da(r){var i=r[Rs];if(i)return i;for(var o=r.parentNode;o;){if(i=o[Xs]||o[Rs]){if(o=i.alternate,i.child!==null||o!==null&&o.child!==null)for(r=ym(r);r!==null;){if(o=r[Rs])return o;r=ym(r)}return i}r=o,o=r.parentNode}return null}function ol(r){return r=r[Rs]||r[Xs],!r||r.tag!==5&&r.tag!==6&&r.tag!==13&&r.tag!==3?null:r}function Za(r){if(r.tag===5||r.tag===6)return r.stateNode;throw Error(t(33))}function Cc(r){return r[al]||null}var Bd=[],eo=-1;function Si(r){return{current:r}}function Ut(r){0>eo||(r.current=Bd[eo],Bd[eo]=null,eo--)}function Vt(r,i){eo++,Bd[eo]=r.current,r.current=i}var Ci={},Zn=Si(Ci),yr=Si(!1),ha=Ci;function to(r,i){var o=r.type.contextTypes;if(!o)return Ci;var h=r.stateNode;if(h&&h.__reactInternalMemoizedUnmaskedChildContext===i)return h.__reactInternalMemoizedMaskedChildContext;var p={},y;for(y in o)p[y]=i[y];return h&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=i,r.__reactInternalMemoizedMaskedChildContext=p),p}function vr(r){return r=r.childContextTypes,r!=null}function Ic(){Ut(yr),Ut(Zn)}function vm(r,i,o){if(Zn.current!==Ci)throw Error(t(168));Vt(Zn,i),Vt(yr,o)}function _m(r,i,o){var h=r.stateNode;if(i=i.childContextTypes,typeof h.getChildContext!="function")return o;h=h.getChildContext();for(var p in h)if(!(p in i))throw Error(t(108,Le(r)||"Unknown",p));return be({},o,h)}function bc(r){return r=(r=r.stateNode)&&r.__reactInternalMemoizedMergedChildContext||Ci,ha=Zn.current,Vt(Zn,r),Vt(yr,yr.current),!0}function wm(r,i,o){var h=r.stateNode;if(!h)throw Error(t(169));o?(r=_m(r,i,ha),h.__reactInternalMemoizedMergedChildContext=r,Ut(yr),Ut(Zn),Vt(Zn,r)):Ut(yr),Vt(yr,o)}var Zs=null,Pc=!1,$d=!1;function xm(r){Zs===null?Zs=[r]:Zs.push(r)}function yx(r){Pc=!0,xm(r)}function Ii(){if(!$d&&Zs!==null){$d=!0;var r=0,i=ft;try{var o=Zs;for(ft=1;r<o.length;r++){var h=o[r];do h=h(!0);while(h!==null)}Zs=null,Pc=!1}catch(p){throw Zs!==null&&(Zs=Zs.slice(r+1)),rs(An,Ii),p}finally{ft=i,$d=!1}}return null}var no=[],ro=0,Rc=null,Nc=0,$r=[],Wr=0,fa=null,ei=1,ti="";function pa(r,i){no[ro++]=Nc,no[ro++]=Rc,Rc=r,Nc=i}function Em(r,i,o){$r[Wr++]=ei,$r[Wr++]=ti,$r[Wr++]=fa,fa=r;var h=ei;r=ti;var p=32-Se(h)-1;h&=~(1<<p),o+=1;var y=32-Se(i)+p;if(30<y){var E=p-p%5;y=(h&(1<<E)-1).toString(32),h>>=E,p-=E,ei=1<<32-Se(i)+p|o<<p|h,ti=y+r}else ei=1<<y|o<<p|h,ti=r}function Wd(r){r.return!==null&&(pa(r,1),Em(r,1,0))}function Gd(r){for(;r===Rc;)Rc=no[--ro],no[ro]=null,Nc=no[--ro],no[ro]=null;for(;r===fa;)fa=$r[--Wr],$r[Wr]=null,ti=$r[--Wr],$r[Wr]=null,ei=$r[--Wr],$r[Wr]=null}var Dr=null,Lr=null,Gt=!1,ds=null;function Tm(r,i){var o=Kr(5,null,null,0);o.elementType="DELETED",o.stateNode=i,o.return=r,i=r.deletions,i===null?(r.deletions=[o],r.flags|=16):i.push(o)}function Sm(r,i){switch(r.tag){case 5:var o=r.type;return i=i.nodeType!==1||o.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(r.stateNode=i,Dr=r,Lr=Ti(i.firstChild),!0):!1;case 6:return i=r.pendingProps===""||i.nodeType!==3?null:i,i!==null?(r.stateNode=i,Dr=r,Lr=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(o=fa!==null?{id:ei,overflow:ti}:null,r.memoizedState={dehydrated:i,treeContext:o,retryLane:1073741824},o=Kr(18,null,null,0),o.stateNode=i,o.return=r,r.child=o,Dr=r,Lr=null,!0):!1;default:return!1}}function Hd(r){return(r.mode&1)!==0&&(r.flags&128)===0}function qd(r){if(Gt){var i=Lr;if(i){var o=i;if(!Sm(r,i)){if(Hd(r))throw Error(t(418));i=Ti(o.nextSibling);var h=Dr;i&&Sm(r,i)?Tm(h,o):(r.flags=r.flags&-4097|2,Gt=!1,Dr=r)}}else{if(Hd(r))throw Error(t(418));r.flags=r.flags&-4097|2,Gt=!1,Dr=r}}}function Cm(r){for(r=r.return;r!==null&&r.tag!==5&&r.tag!==3&&r.tag!==13;)r=r.return;Dr=r}function Ac(r){if(r!==Dr)return!1;if(!Gt)return Cm(r),Gt=!0,!1;var i;if((i=r.tag!==3)&&!(i=r.tag!==5)&&(i=r.type,i=i!=="head"&&i!=="body"&&!Md(r.type,r.memoizedProps)),i&&(i=Lr)){if(Hd(r))throw Im(),Error(t(418));for(;i;)Tm(r,i),i=Ti(i.nextSibling)}if(Cm(r),r.tag===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(t(317));e:{for(r=r.nextSibling,i=0;r;){if(r.nodeType===8){var o=r.data;if(o==="/$"){if(i===0){Lr=Ti(r.nextSibling);break e}i--}else o!=="$"&&o!=="$!"&&o!=="$?"||i++}r=r.nextSibling}Lr=null}}else Lr=Dr?Ti(r.stateNode.nextSibling):null;return!0}function Im(){for(var r=Lr;r;)r=Ti(r.nextSibling)}function so(){Lr=Dr=null,Gt=!1}function Kd(r){ds===null?ds=[r]:ds.push(r)}var vx=Ee.ReactCurrentBatchConfig;function ll(r,i,o){if(r=o.ref,r!==null&&typeof r!="function"&&typeof r!="object"){if(o._owner){if(o=o._owner,o){if(o.tag!==1)throw Error(t(309));var h=o.stateNode}if(!h)throw Error(t(147,r));var p=h,y=""+r;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===y?i.ref:(i=function(E){var j=p.refs;E===null?delete j[y]:j[y]=E},i._stringRef=y,i)}if(typeof r!="string")throw Error(t(284));if(!o._owner)throw Error(t(290,r))}return r}function kc(r,i){throw r=Object.prototype.toString.call(i),Error(t(31,r==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":r))}function bm(r){var i=r._init;return i(r._payload)}function Pm(r){function i(J,G){if(r){var X=J.deletions;X===null?(J.deletions=[G],J.flags|=16):X.push(G)}}function o(J,G){if(!r)return null;for(;G!==null;)i(J,G),G=G.sibling;return null}function h(J,G){for(J=new Map;G!==null;)G.key!==null?J.set(G.key,G):J.set(G.index,G),G=G.sibling;return J}function p(J,G){return J=Di(J,G),J.index=0,J.sibling=null,J}function y(J,G,X){return J.index=X,r?(X=J.alternate,X!==null?(X=X.index,X<G?(J.flags|=2,G):X):(J.flags|=2,G)):(J.flags|=1048576,G)}function E(J){return r&&J.alternate===null&&(J.flags|=2),J}function j(J,G,X,Pe){return G===null||G.tag!==6?(G=Fh(X,J.mode,Pe),G.return=J,G):(G=p(G,X),G.return=J,G)}function F(J,G,X,Pe){var Ge=X.type;return Ge===A?ge(J,G,X.props.children,Pe,X.key):G!==null&&(G.elementType===Ge||typeof Ge=="object"&&Ge!==null&&Ge.$$typeof===Ae&&bm(Ge)===G.type)?(Pe=p(G,X.props),Pe.ref=ll(J,G,X),Pe.return=J,Pe):(Pe=nu(X.type,X.key,X.props,null,J.mode,Pe),Pe.ref=ll(J,G,X),Pe.return=J,Pe)}function te(J,G,X,Pe){return G===null||G.tag!==4||G.stateNode.containerInfo!==X.containerInfo||G.stateNode.implementation!==X.implementation?(G=Uh(X,J.mode,Pe),G.return=J,G):(G=p(G,X.children||[]),G.return=J,G)}function ge(J,G,X,Pe,Ge){return G===null||G.tag!==7?(G=Ea(X,J.mode,Pe,Ge),G.return=J,G):(G=p(G,X),G.return=J,G)}function ve(J,G,X){if(typeof G=="string"&&G!==""||typeof G=="number")return G=Fh(""+G,J.mode,X),G.return=J,G;if(typeof G=="object"&&G!==null){switch(G.$$typeof){case le:return X=nu(G.type,G.key,G.props,null,J.mode,X),X.ref=ll(J,null,G),X.return=J,X;case Re:return G=Uh(G,J.mode,X),G.return=J,G;case Ae:var Pe=G._init;return ve(J,Pe(G._payload),X)}if(on(G)||De(G))return G=Ea(G,J.mode,X,null),G.return=J,G;kc(J,G)}return null}function pe(J,G,X,Pe){var Ge=G!==null?G.key:null;if(typeof X=="string"&&X!==""||typeof X=="number")return Ge!==null?null:j(J,G,""+X,Pe);if(typeof X=="object"&&X!==null){switch(X.$$typeof){case le:return X.key===Ge?F(J,G,X,Pe):null;case Re:return X.key===Ge?te(J,G,X,Pe):null;case Ae:return Ge=X._init,pe(J,G,Ge(X._payload),Pe)}if(on(X)||De(X))return Ge!==null?null:ge(J,G,X,Pe,null);kc(J,X)}return null}function Ve(J,G,X,Pe,Ge){if(typeof Pe=="string"&&Pe!==""||typeof Pe=="number")return J=J.get(X)||null,j(G,J,""+Pe,Ge);if(typeof Pe=="object"&&Pe!==null){switch(Pe.$$typeof){case le:return J=J.get(Pe.key===null?X:Pe.key)||null,F(G,J,Pe,Ge);case Re:return J=J.get(Pe.key===null?X:Pe.key)||null,te(G,J,Pe,Ge);case Ae:var Xe=Pe._init;return Ve(J,G,X,Xe(Pe._payload),Ge)}if(on(Pe)||De(Pe))return J=J.get(X)||null,ge(G,J,Pe,Ge,null);kc(G,Pe)}return null}function Fe(J,G,X,Pe){for(var Ge=null,Xe=null,Ze=G,st=G=0,Ln=null;Ze!==null&&st<X.length;st++){Ze.index>st?(Ln=Ze,Ze=null):Ln=Ze.sibling;var Ct=pe(J,Ze,X[st],Pe);if(Ct===null){Ze===null&&(Ze=Ln);break}r&&Ze&&Ct.alternate===null&&i(J,Ze),G=y(Ct,G,st),Xe===null?Ge=Ct:Xe.sibling=Ct,Xe=Ct,Ze=Ln}if(st===X.length)return o(J,Ze),Gt&&pa(J,st),Ge;if(Ze===null){for(;st<X.length;st++)Ze=ve(J,X[st],Pe),Ze!==null&&(G=y(Ze,G,st),Xe===null?Ge=Ze:Xe.sibling=Ze,Xe=Ze);return Gt&&pa(J,st),Ge}for(Ze=h(J,Ze);st<X.length;st++)Ln=Ve(Ze,J,st,X[st],Pe),Ln!==null&&(r&&Ln.alternate!==null&&Ze.delete(Ln.key===null?st:Ln.key),G=y(Ln,G,st),Xe===null?Ge=Ln:Xe.sibling=Ln,Xe=Ln);return r&&Ze.forEach(function(Li){return i(J,Li)}),Gt&&pa(J,st),Ge}function ze(J,G,X,Pe){var Ge=De(X);if(typeof Ge!="function")throw Error(t(150));if(X=Ge.call(X),X==null)throw Error(t(151));for(var Xe=Ge=null,Ze=G,st=G=0,Ln=null,Ct=X.next();Ze!==null&&!Ct.done;st++,Ct=X.next()){Ze.index>st?(Ln=Ze,Ze=null):Ln=Ze.sibling;var Li=pe(J,Ze,Ct.value,Pe);if(Li===null){Ze===null&&(Ze=Ln);break}r&&Ze&&Li.alternate===null&&i(J,Ze),G=y(Li,G,st),Xe===null?Ge=Li:Xe.sibling=Li,Xe=Li,Ze=Ln}if(Ct.done)return o(J,Ze),Gt&&pa(J,st),Ge;if(Ze===null){for(;!Ct.done;st++,Ct=X.next())Ct=ve(J,Ct.value,Pe),Ct!==null&&(G=y(Ct,G,st),Xe===null?Ge=Ct:Xe.sibling=Ct,Xe=Ct);return Gt&&pa(J,st),Ge}for(Ze=h(J,Ze);!Ct.done;st++,Ct=X.next())Ct=Ve(Ze,J,st,Ct.value,Pe),Ct!==null&&(r&&Ct.alternate!==null&&Ze.delete(Ct.key===null?st:Ct.key),G=y(Ct,G,st),Xe===null?Ge=Ct:Xe.sibling=Ct,Xe=Ct);return r&&Ze.forEach(function(Jx){return i(J,Jx)}),Gt&&pa(J,st),Ge}function tn(J,G,X,Pe){if(typeof X=="object"&&X!==null&&X.type===A&&X.key===null&&(X=X.props.children),typeof X=="object"&&X!==null){switch(X.$$typeof){case le:e:{for(var Ge=X.key,Xe=G;Xe!==null;){if(Xe.key===Ge){if(Ge=X.type,Ge===A){if(Xe.tag===7){o(J,Xe.sibling),G=p(Xe,X.props.children),G.return=J,J=G;break e}}else if(Xe.elementType===Ge||typeof Ge=="object"&&Ge!==null&&Ge.$$typeof===Ae&&bm(Ge)===Xe.type){o(J,Xe.sibling),G=p(Xe,X.props),G.ref=ll(J,Xe,X),G.return=J,J=G;break e}o(J,Xe);break}else i(J,Xe);Xe=Xe.sibling}X.type===A?(G=Ea(X.props.children,J.mode,Pe,X.key),G.return=J,J=G):(Pe=nu(X.type,X.key,X.props,null,J.mode,Pe),Pe.ref=ll(J,G,X),Pe.return=J,J=Pe)}return E(J);case Re:e:{for(Xe=X.key;G!==null;){if(G.key===Xe)if(G.tag===4&&G.stateNode.containerInfo===X.containerInfo&&G.stateNode.implementation===X.implementation){o(J,G.sibling),G=p(G,X.children||[]),G.return=J,J=G;break e}else{o(J,G);break}else i(J,G);G=G.sibling}G=Uh(X,J.mode,Pe),G.return=J,J=G}return E(J);case Ae:return Xe=X._init,tn(J,G,Xe(X._payload),Pe)}if(on(X))return Fe(J,G,X,Pe);if(De(X))return ze(J,G,X,Pe);kc(J,X)}return typeof X=="string"&&X!==""||typeof X=="number"?(X=""+X,G!==null&&G.tag===6?(o(J,G.sibling),G=p(G,X),G.return=J,J=G):(o(J,G),G=Fh(X,J.mode,Pe),G.return=J,J=G),E(J)):o(J,G)}return tn}var io=Pm(!0),Rm=Pm(!1),jc=Si(null),Dc=null,ao=null,Qd=null;function Yd(){Qd=ao=Dc=null}function Jd(r){var i=jc.current;Ut(jc),r._currentValue=i}function Xd(r,i,o){for(;r!==null;){var h=r.alternate;if((r.childLanes&i)!==i?(r.childLanes|=i,h!==null&&(h.childLanes|=i)):h!==null&&(h.childLanes&i)!==i&&(h.childLanes|=i),r===o)break;r=r.return}}function oo(r,i){Dc=r,Qd=ao=null,r=r.dependencies,r!==null&&r.firstContext!==null&&((r.lanes&i)!==0&&(_r=!0),r.firstContext=null)}function Gr(r){var i=r._currentValue;if(Qd!==r)if(r={context:r,memoizedValue:i,next:null},ao===null){if(Dc===null)throw Error(t(308));ao=r,Dc.dependencies={lanes:0,firstContext:r}}else ao=ao.next=r;return i}var ma=null;function Zd(r){ma===null?ma=[r]:ma.push(r)}function Nm(r,i,o,h){var p=i.interleaved;return p===null?(o.next=o,Zd(i)):(o.next=p.next,p.next=o),i.interleaved=o,ni(r,h)}function ni(r,i){r.lanes|=i;var o=r.alternate;for(o!==null&&(o.lanes|=i),o=r,r=r.return;r!==null;)r.childLanes|=i,o=r.alternate,o!==null&&(o.childLanes|=i),o=r,r=r.return;return o.tag===3?o.stateNode:null}var bi=!1;function eh(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Am(r,i){r=r.updateQueue,i.updateQueue===r&&(i.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,effects:r.effects})}function ri(r,i){return{eventTime:r,lane:i,tag:0,payload:null,callback:null,next:null}}function Pi(r,i,o){var h=r.updateQueue;if(h===null)return null;if(h=h.shared,(Tt&2)!==0){var p=h.pending;return p===null?i.next=i:(i.next=p.next,p.next=i),h.pending=i,ni(r,o)}return p=h.interleaved,p===null?(i.next=i,Zd(h)):(i.next=p.next,p.next=i),h.interleaved=i,ni(r,o)}function Lc(r,i,o){if(i=i.updateQueue,i!==null&&(i=i.shared,(o&4194240)!==0)){var h=i.lanes;h&=r.pendingLanes,o|=h,i.lanes=o,Ss(r,o)}}function km(r,i){var o=r.updateQueue,h=r.alternate;if(h!==null&&(h=h.updateQueue,o===h)){var p=null,y=null;if(o=o.firstBaseUpdate,o!==null){do{var E={eventTime:o.eventTime,lane:o.lane,tag:o.tag,payload:o.payload,callback:o.callback,next:null};y===null?p=y=E:y=y.next=E,o=o.next}while(o!==null);y===null?p=y=i:y=y.next=i}else p=y=i;o={baseState:h.baseState,firstBaseUpdate:p,lastBaseUpdate:y,shared:h.shared,effects:h.effects},r.updateQueue=o;return}r=o.lastBaseUpdate,r===null?o.firstBaseUpdate=i:r.next=i,o.lastBaseUpdate=i}function Vc(r,i,o,h){var p=r.updateQueue;bi=!1;var y=p.firstBaseUpdate,E=p.lastBaseUpdate,j=p.shared.pending;if(j!==null){p.shared.pending=null;var F=j,te=F.next;F.next=null,E===null?y=te:E.next=te,E=F;var ge=r.alternate;ge!==null&&(ge=ge.updateQueue,j=ge.lastBaseUpdate,j!==E&&(j===null?ge.firstBaseUpdate=te:j.next=te,ge.lastBaseUpdate=F))}if(y!==null){var ve=p.baseState;E=0,ge=te=F=null,j=y;do{var pe=j.lane,Ve=j.eventTime;if((h&pe)===pe){ge!==null&&(ge=ge.next={eventTime:Ve,lane:0,tag:j.tag,payload:j.payload,callback:j.callback,next:null});e:{var Fe=r,ze=j;switch(pe=i,Ve=o,ze.tag){case 1:if(Fe=ze.payload,typeof Fe=="function"){ve=Fe.call(Ve,ve,pe);break e}ve=Fe;break e;case 3:Fe.flags=Fe.flags&-65537|128;case 0:if(Fe=ze.payload,pe=typeof Fe=="function"?Fe.call(Ve,ve,pe):Fe,pe==null)break e;ve=be({},ve,pe);break e;case 2:bi=!0}}j.callback!==null&&j.lane!==0&&(r.flags|=64,pe=p.effects,pe===null?p.effects=[j]:pe.push(j))}else Ve={eventTime:Ve,lane:pe,tag:j.tag,payload:j.payload,callback:j.callback,next:null},ge===null?(te=ge=Ve,F=ve):ge=ge.next=Ve,E|=pe;if(j=j.next,j===null){if(j=p.shared.pending,j===null)break;pe=j,j=pe.next,pe.next=null,p.lastBaseUpdate=pe,p.shared.pending=null}}while(!0);if(ge===null&&(F=ve),p.baseState=F,p.firstBaseUpdate=te,p.lastBaseUpdate=ge,i=p.shared.interleaved,i!==null){p=i;do E|=p.lane,p=p.next;while(p!==i)}else y===null&&(p.shared.lanes=0);va|=E,r.lanes=E,r.memoizedState=ve}}function jm(r,i,o){if(r=i.effects,i.effects=null,r!==null)for(i=0;i<r.length;i++){var h=r[i],p=h.callback;if(p!==null){if(h.callback=null,h=o,typeof p!="function")throw Error(t(191,p));p.call(h)}}}var cl={},Ns=Si(cl),ul=Si(cl),dl=Si(cl);function ga(r){if(r===cl)throw Error(t(174));return r}function th(r,i){switch(Vt(dl,i),Vt(ul,r),Vt(Ns,cl),r=i.nodeType,r){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:$t(null,"");break;default:r=r===8?i.parentNode:i,i=r.namespaceURI||null,r=r.tagName,i=$t(i,r)}Ut(Ns),Vt(Ns,i)}function lo(){Ut(Ns),Ut(ul),Ut(dl)}function Dm(r){ga(dl.current);var i=ga(Ns.current),o=$t(i,r.type);i!==o&&(Vt(ul,r),Vt(Ns,o))}function nh(r){ul.current===r&&(Ut(Ns),Ut(ul))}var Ht=Si(0);function Oc(r){for(var i=r;i!==null;){if(i.tag===13){var o=i.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||o.data==="$?"||o.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===r)break;for(;i.sibling===null;){if(i.return===null||i.return===r)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var rh=[];function sh(){for(var r=0;r<rh.length;r++)rh[r]._workInProgressVersionPrimary=null;rh.length=0}var Mc=Ee.ReactCurrentDispatcher,ih=Ee.ReactCurrentBatchConfig,ya=0,qt=null,wn=null,jn=null,Fc=!1,hl=!1,fl=0,_x=0;function er(){throw Error(t(321))}function ah(r,i){if(i===null)return!1;for(var o=0;o<i.length&&o<r.length;o++)if(!us(r[o],i[o]))return!1;return!0}function oh(r,i,o,h,p,y){if(ya=y,qt=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,Mc.current=r===null||r.memoizedState===null?Tx:Sx,r=o(h,p),hl){y=0;do{if(hl=!1,fl=0,25<=y)throw Error(t(301));y+=1,jn=wn=null,i.updateQueue=null,Mc.current=Cx,r=o(h,p)}while(hl)}if(Mc.current=Bc,i=wn!==null&&wn.next!==null,ya=0,jn=wn=qt=null,Fc=!1,i)throw Error(t(300));return r}function lh(){var r=fl!==0;return fl=0,r}function As(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return jn===null?qt.memoizedState=jn=r:jn=jn.next=r,jn}function Hr(){if(wn===null){var r=qt.alternate;r=r!==null?r.memoizedState:null}else r=wn.next;var i=jn===null?qt.memoizedState:jn.next;if(i!==null)jn=i,wn=r;else{if(r===null)throw Error(t(310));wn=r,r={memoizedState:wn.memoizedState,baseState:wn.baseState,baseQueue:wn.baseQueue,queue:wn.queue,next:null},jn===null?qt.memoizedState=jn=r:jn=jn.next=r}return jn}function pl(r,i){return typeof i=="function"?i(r):i}function ch(r){var i=Hr(),o=i.queue;if(o===null)throw Error(t(311));o.lastRenderedReducer=r;var h=wn,p=h.baseQueue,y=o.pending;if(y!==null){if(p!==null){var E=p.next;p.next=y.next,y.next=E}h.baseQueue=p=y,o.pending=null}if(p!==null){y=p.next,h=h.baseState;var j=E=null,F=null,te=y;do{var ge=te.lane;if((ya&ge)===ge)F!==null&&(F=F.next={lane:0,action:te.action,hasEagerState:te.hasEagerState,eagerState:te.eagerState,next:null}),h=te.hasEagerState?te.eagerState:r(h,te.action);else{var ve={lane:ge,action:te.action,hasEagerState:te.hasEagerState,eagerState:te.eagerState,next:null};F===null?(j=F=ve,E=h):F=F.next=ve,qt.lanes|=ge,va|=ge}te=te.next}while(te!==null&&te!==y);F===null?E=h:F.next=j,us(h,i.memoizedState)||(_r=!0),i.memoizedState=h,i.baseState=E,i.baseQueue=F,o.lastRenderedState=h}if(r=o.interleaved,r!==null){p=r;do y=p.lane,qt.lanes|=y,va|=y,p=p.next;while(p!==r)}else p===null&&(o.lanes=0);return[i.memoizedState,o.dispatch]}function uh(r){var i=Hr(),o=i.queue;if(o===null)throw Error(t(311));o.lastRenderedReducer=r;var h=o.dispatch,p=o.pending,y=i.memoizedState;if(p!==null){o.pending=null;var E=p=p.next;do y=r(y,E.action),E=E.next;while(E!==p);us(y,i.memoizedState)||(_r=!0),i.memoizedState=y,i.baseQueue===null&&(i.baseState=y),o.lastRenderedState=y}return[y,h]}function Lm(){}function Vm(r,i){var o=qt,h=Hr(),p=i(),y=!us(h.memoizedState,p);if(y&&(h.memoizedState=p,_r=!0),h=h.queue,dh(Fm.bind(null,o,h,r),[r]),h.getSnapshot!==i||y||jn!==null&&jn.memoizedState.tag&1){if(o.flags|=2048,ml(9,Mm.bind(null,o,h,p,i),void 0,null),Dn===null)throw Error(t(349));(ya&30)!==0||Om(o,i,p)}return p}function Om(r,i,o){r.flags|=16384,r={getSnapshot:i,value:o},i=qt.updateQueue,i===null?(i={lastEffect:null,stores:null},qt.updateQueue=i,i.stores=[r]):(o=i.stores,o===null?i.stores=[r]:o.push(r))}function Mm(r,i,o,h){i.value=o,i.getSnapshot=h,Um(i)&&zm(r)}function Fm(r,i,o){return o(function(){Um(i)&&zm(r)})}function Um(r){var i=r.getSnapshot;r=r.value;try{var o=i();return!us(r,o)}catch{return!0}}function zm(r){var i=ni(r,1);i!==null&&ms(i,r,1,-1)}function Bm(r){var i=As();return typeof r=="function"&&(r=r()),i.memoizedState=i.baseState=r,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:pl,lastRenderedState:r},i.queue=r,r=r.dispatch=Ex.bind(null,qt,r),[i.memoizedState,r]}function ml(r,i,o,h){return r={tag:r,create:i,destroy:o,deps:h,next:null},i=qt.updateQueue,i===null?(i={lastEffect:null,stores:null},qt.updateQueue=i,i.lastEffect=r.next=r):(o=i.lastEffect,o===null?i.lastEffect=r.next=r:(h=o.next,o.next=r,r.next=h,i.lastEffect=r)),r}function $m(){return Hr().memoizedState}function Uc(r,i,o,h){var p=As();qt.flags|=r,p.memoizedState=ml(1|i,o,void 0,h===void 0?null:h)}function zc(r,i,o,h){var p=Hr();h=h===void 0?null:h;var y=void 0;if(wn!==null){var E=wn.memoizedState;if(y=E.destroy,h!==null&&ah(h,E.deps)){p.memoizedState=ml(i,o,y,h);return}}qt.flags|=r,p.memoizedState=ml(1|i,o,y,h)}function Wm(r,i){return Uc(8390656,8,r,i)}function dh(r,i){return zc(2048,8,r,i)}function Gm(r,i){return zc(4,2,r,i)}function Hm(r,i){return zc(4,4,r,i)}function qm(r,i){if(typeof i=="function")return r=r(),i(r),function(){i(null)};if(i!=null)return r=r(),i.current=r,function(){i.current=null}}function Km(r,i,o){return o=o!=null?o.concat([r]):null,zc(4,4,qm.bind(null,i,r),o)}function hh(){}function Qm(r,i){var o=Hr();i=i===void 0?null:i;var h=o.memoizedState;return h!==null&&i!==null&&ah(i,h[1])?h[0]:(o.memoizedState=[r,i],r)}function Ym(r,i){var o=Hr();i=i===void 0?null:i;var h=o.memoizedState;return h!==null&&i!==null&&ah(i,h[1])?h[0]:(r=r(),o.memoizedState=[r,i],r)}function Jm(r,i,o){return(ya&21)===0?(r.baseState&&(r.baseState=!1,_r=!0),r.memoizedState=o):(us(o,i)||(o=is(),qt.lanes|=o,va|=o,r.baseState=!0),i)}function wx(r,i){var o=ft;ft=o!==0&&4>o?o:4,r(!0);var h=ih.transition;ih.transition={};try{r(!1),i()}finally{ft=o,ih.transition=h}}function Xm(){return Hr().memoizedState}function xx(r,i,o){var h=ki(r);if(o={lane:h,action:o,hasEagerState:!1,eagerState:null,next:null},Zm(r))eg(i,o);else if(o=Nm(r,i,o,h),o!==null){var p=hr();ms(o,r,h,p),tg(o,i,h)}}function Ex(r,i,o){var h=ki(r),p={lane:h,action:o,hasEagerState:!1,eagerState:null,next:null};if(Zm(r))eg(i,p);else{var y=r.alternate;if(r.lanes===0&&(y===null||y.lanes===0)&&(y=i.lastRenderedReducer,y!==null))try{var E=i.lastRenderedState,j=y(E,o);if(p.hasEagerState=!0,p.eagerState=j,us(j,E)){var F=i.interleaved;F===null?(p.next=p,Zd(i)):(p.next=F.next,F.next=p),i.interleaved=p;return}}catch{}finally{}o=Nm(r,i,p,h),o!==null&&(p=hr(),ms(o,r,h,p),tg(o,i,h))}}function Zm(r){var i=r.alternate;return r===qt||i!==null&&i===qt}function eg(r,i){hl=Fc=!0;var o=r.pending;o===null?i.next=i:(i.next=o.next,o.next=i),r.pending=i}function tg(r,i,o){if((o&4194240)!==0){var h=i.lanes;h&=r.pendingLanes,o|=h,i.lanes=o,Ss(r,o)}}var Bc={readContext:Gr,useCallback:er,useContext:er,useEffect:er,useImperativeHandle:er,useInsertionEffect:er,useLayoutEffect:er,useMemo:er,useReducer:er,useRef:er,useState:er,useDebugValue:er,useDeferredValue:er,useTransition:er,useMutableSource:er,useSyncExternalStore:er,useId:er,unstable_isNewReconciler:!1},Tx={readContext:Gr,useCallback:function(r,i){return As().memoizedState=[r,i===void 0?null:i],r},useContext:Gr,useEffect:Wm,useImperativeHandle:function(r,i,o){return o=o!=null?o.concat([r]):null,Uc(4194308,4,qm.bind(null,i,r),o)},useLayoutEffect:function(r,i){return Uc(4194308,4,r,i)},useInsertionEffect:function(r,i){return Uc(4,2,r,i)},useMemo:function(r,i){var o=As();return i=i===void 0?null:i,r=r(),o.memoizedState=[r,i],r},useReducer:function(r,i,o){var h=As();return i=o!==void 0?o(i):i,h.memoizedState=h.baseState=i,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:i},h.queue=r,r=r.dispatch=xx.bind(null,qt,r),[h.memoizedState,r]},useRef:function(r){var i=As();return r={current:r},i.memoizedState=r},useState:Bm,useDebugValue:hh,useDeferredValue:function(r){return As().memoizedState=r},useTransition:function(){var r=Bm(!1),i=r[0];return r=wx.bind(null,r[1]),As().memoizedState=r,[i,r]},useMutableSource:function(){},useSyncExternalStore:function(r,i,o){var h=qt,p=As();if(Gt){if(o===void 0)throw Error(t(407));o=o()}else{if(o=i(),Dn===null)throw Error(t(349));(ya&30)!==0||Om(h,i,o)}p.memoizedState=o;var y={value:o,getSnapshot:i};return p.queue=y,Wm(Fm.bind(null,h,y,r),[r]),h.flags|=2048,ml(9,Mm.bind(null,h,y,o,i),void 0,null),o},useId:function(){var r=As(),i=Dn.identifierPrefix;if(Gt){var o=ti,h=ei;o=(h&~(1<<32-Se(h)-1)).toString(32)+o,i=":"+i+"R"+o,o=fl++,0<o&&(i+="H"+o.toString(32)),i+=":"}else o=_x++,i=":"+i+"r"+o.toString(32)+":";return r.memoizedState=i},unstable_isNewReconciler:!1},Sx={readContext:Gr,useCallback:Qm,useContext:Gr,useEffect:dh,useImperativeHandle:Km,useInsertionEffect:Gm,useLayoutEffect:Hm,useMemo:Ym,useReducer:ch,useRef:$m,useState:function(){return ch(pl)},useDebugValue:hh,useDeferredValue:function(r){var i=Hr();return Jm(i,wn.memoizedState,r)},useTransition:function(){var r=ch(pl)[0],i=Hr().memoizedState;return[r,i]},useMutableSource:Lm,useSyncExternalStore:Vm,useId:Xm,unstable_isNewReconciler:!1},Cx={readContext:Gr,useCallback:Qm,useContext:Gr,useEffect:dh,useImperativeHandle:Km,useInsertionEffect:Gm,useLayoutEffect:Hm,useMemo:Ym,useReducer:uh,useRef:$m,useState:function(){return uh(pl)},useDebugValue:hh,useDeferredValue:function(r){var i=Hr();return wn===null?i.memoizedState=r:Jm(i,wn.memoizedState,r)},useTransition:function(){var r=uh(pl)[0],i=Hr().memoizedState;return[r,i]},useMutableSource:Lm,useSyncExternalStore:Vm,useId:Xm,unstable_isNewReconciler:!1};function hs(r,i){if(r&&r.defaultProps){i=be({},i),r=r.defaultProps;for(var o in r)i[o]===void 0&&(i[o]=r[o]);return i}return i}function fh(r,i,o,h){i=r.memoizedState,o=o(h,i),o=o==null?i:be({},i,o),r.memoizedState=o,r.lanes===0&&(r.updateQueue.baseState=o)}var $c={isMounted:function(r){return(r=r._reactInternals)?Mt(r)===r:!1},enqueueSetState:function(r,i,o){r=r._reactInternals;var h=hr(),p=ki(r),y=ri(h,p);y.payload=i,o!=null&&(y.callback=o),i=Pi(r,y,p),i!==null&&(ms(i,r,p,h),Lc(i,r,p))},enqueueReplaceState:function(r,i,o){r=r._reactInternals;var h=hr(),p=ki(r),y=ri(h,p);y.tag=1,y.payload=i,o!=null&&(y.callback=o),i=Pi(r,y,p),i!==null&&(ms(i,r,p,h),Lc(i,r,p))},enqueueForceUpdate:function(r,i){r=r._reactInternals;var o=hr(),h=ki(r),p=ri(o,h);p.tag=2,i!=null&&(p.callback=i),i=Pi(r,p,h),i!==null&&(ms(i,r,h,o),Lc(i,r,h))}};function ng(r,i,o,h,p,y,E){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(h,y,E):i.prototype&&i.prototype.isPureReactComponent?!tl(o,h)||!tl(p,y):!0}function rg(r,i,o){var h=!1,p=Ci,y=i.contextType;return typeof y=="object"&&y!==null?y=Gr(y):(p=vr(i)?ha:Zn.current,h=i.contextTypes,y=(h=h!=null)?to(r,p):Ci),i=new i(o,y),r.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=$c,r.stateNode=i,i._reactInternals=r,h&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=p,r.__reactInternalMemoizedMaskedChildContext=y),i}function sg(r,i,o,h){r=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(o,h),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(o,h),i.state!==r&&$c.enqueueReplaceState(i,i.state,null)}function ph(r,i,o,h){var p=r.stateNode;p.props=o,p.state=r.memoizedState,p.refs={},eh(r);var y=i.contextType;typeof y=="object"&&y!==null?p.context=Gr(y):(y=vr(i)?ha:Zn.current,p.context=to(r,y)),p.state=r.memoizedState,y=i.getDerivedStateFromProps,typeof y=="function"&&(fh(r,i,y,o),p.state=r.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(i=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),i!==p.state&&$c.enqueueReplaceState(p,p.state,null),Vc(r,o,p,h),p.state=r.memoizedState),typeof p.componentDidMount=="function"&&(r.flags|=4194308)}function co(r,i){try{var o="",h=i;do o+=Te(h),h=h.return;while(h);var p=o}catch(y){p=`
Error generating stack: `+y.message+`
`+y.stack}return{value:r,source:i,stack:p,digest:null}}function mh(r,i,o){return{value:r,source:null,stack:o??null,digest:i??null}}function gh(r,i){try{console.error(i.value)}catch(o){setTimeout(function(){throw o})}}var Ix=typeof WeakMap=="function"?WeakMap:Map;function ig(r,i,o){o=ri(-1,o),o.tag=3,o.payload={element:null};var h=i.value;return o.callback=function(){Yc||(Yc=!0,Ah=h),gh(r,i)},o}function ag(r,i,o){o=ri(-1,o),o.tag=3;var h=r.type.getDerivedStateFromError;if(typeof h=="function"){var p=i.value;o.payload=function(){return h(p)},o.callback=function(){gh(r,i)}}var y=r.stateNode;return y!==null&&typeof y.componentDidCatch=="function"&&(o.callback=function(){gh(r,i),typeof h!="function"&&(Ni===null?Ni=new Set([this]):Ni.add(this));var E=i.stack;this.componentDidCatch(i.value,{componentStack:E!==null?E:""})}),o}function og(r,i,o){var h=r.pingCache;if(h===null){h=r.pingCache=new Ix;var p=new Set;h.set(i,p)}else p=h.get(i),p===void 0&&(p=new Set,h.set(i,p));p.has(o)||(p.add(o),r=Ux.bind(null,r,i,o),i.then(r,r))}function lg(r){do{var i;if((i=r.tag===13)&&(i=r.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return r;r=r.return}while(r!==null);return null}function cg(r,i,o,h,p){return(r.mode&1)===0?(r===i?r.flags|=65536:(r.flags|=128,o.flags|=131072,o.flags&=-52805,o.tag===1&&(o.alternate===null?o.tag=17:(i=ri(-1,1),i.tag=2,Pi(o,i,1))),o.lanes|=1),r):(r.flags|=65536,r.lanes=p,r)}var bx=Ee.ReactCurrentOwner,_r=!1;function dr(r,i,o,h){i.child=r===null?Rm(i,null,o,h):io(i,r.child,o,h)}function ug(r,i,o,h,p){o=o.render;var y=i.ref;return oo(i,p),h=oh(r,i,o,h,y,p),o=lh(),r!==null&&!_r?(i.updateQueue=r.updateQueue,i.flags&=-2053,r.lanes&=~p,si(r,i,p)):(Gt&&o&&Wd(i),i.flags|=1,dr(r,i,h,p),i.child)}function dg(r,i,o,h,p){if(r===null){var y=o.type;return typeof y=="function"&&!Mh(y)&&y.defaultProps===void 0&&o.compare===null&&o.defaultProps===void 0?(i.tag=15,i.type=y,hg(r,i,y,h,p)):(r=nu(o.type,null,h,i,i.mode,p),r.ref=i.ref,r.return=i,i.child=r)}if(y=r.child,(r.lanes&p)===0){var E=y.memoizedProps;if(o=o.compare,o=o!==null?o:tl,o(E,h)&&r.ref===i.ref)return si(r,i,p)}return i.flags|=1,r=Di(y,h),r.ref=i.ref,r.return=i,i.child=r}function hg(r,i,o,h,p){if(r!==null){var y=r.memoizedProps;if(tl(y,h)&&r.ref===i.ref)if(_r=!1,i.pendingProps=h=y,(r.lanes&p)!==0)(r.flags&131072)!==0&&(_r=!0);else return i.lanes=r.lanes,si(r,i,p)}return yh(r,i,o,h,p)}function fg(r,i,o){var h=i.pendingProps,p=h.children,y=r!==null?r.memoizedState:null;if(h.mode==="hidden")if((i.mode&1)===0)i.memoizedState={baseLanes:0,cachePool:null,transitions:null},Vt(ho,Vr),Vr|=o;else{if((o&1073741824)===0)return r=y!==null?y.baseLanes|o:o,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:r,cachePool:null,transitions:null},i.updateQueue=null,Vt(ho,Vr),Vr|=r,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},h=y!==null?y.baseLanes:o,Vt(ho,Vr),Vr|=h}else y!==null?(h=y.baseLanes|o,i.memoizedState=null):h=o,Vt(ho,Vr),Vr|=h;return dr(r,i,p,o),i.child}function pg(r,i){var o=i.ref;(r===null&&o!==null||r!==null&&r.ref!==o)&&(i.flags|=512,i.flags|=2097152)}function yh(r,i,o,h,p){var y=vr(o)?ha:Zn.current;return y=to(i,y),oo(i,p),o=oh(r,i,o,h,y,p),h=lh(),r!==null&&!_r?(i.updateQueue=r.updateQueue,i.flags&=-2053,r.lanes&=~p,si(r,i,p)):(Gt&&h&&Wd(i),i.flags|=1,dr(r,i,o,p),i.child)}function mg(r,i,o,h,p){if(vr(o)){var y=!0;bc(i)}else y=!1;if(oo(i,p),i.stateNode===null)Gc(r,i),rg(i,o,h),ph(i,o,h,p),h=!0;else if(r===null){var E=i.stateNode,j=i.memoizedProps;E.props=j;var F=E.context,te=o.contextType;typeof te=="object"&&te!==null?te=Gr(te):(te=vr(o)?ha:Zn.current,te=to(i,te));var ge=o.getDerivedStateFromProps,ve=typeof ge=="function"||typeof E.getSnapshotBeforeUpdate=="function";ve||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(j!==h||F!==te)&&sg(i,E,h,te),bi=!1;var pe=i.memoizedState;E.state=pe,Vc(i,h,E,p),F=i.memoizedState,j!==h||pe!==F||yr.current||bi?(typeof ge=="function"&&(fh(i,o,ge,h),F=i.memoizedState),(j=bi||ng(i,o,j,h,pe,F,te))?(ve||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount()),typeof E.componentDidMount=="function"&&(i.flags|=4194308)):(typeof E.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=h,i.memoizedState=F),E.props=h,E.state=F,E.context=te,h=j):(typeof E.componentDidMount=="function"&&(i.flags|=4194308),h=!1)}else{E=i.stateNode,Am(r,i),j=i.memoizedProps,te=i.type===i.elementType?j:hs(i.type,j),E.props=te,ve=i.pendingProps,pe=E.context,F=o.contextType,typeof F=="object"&&F!==null?F=Gr(F):(F=vr(o)?ha:Zn.current,F=to(i,F));var Ve=o.getDerivedStateFromProps;(ge=typeof Ve=="function"||typeof E.getSnapshotBeforeUpdate=="function")||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(j!==ve||pe!==F)&&sg(i,E,h,F),bi=!1,pe=i.memoizedState,E.state=pe,Vc(i,h,E,p);var Fe=i.memoizedState;j!==ve||pe!==Fe||yr.current||bi?(typeof Ve=="function"&&(fh(i,o,Ve,h),Fe=i.memoizedState),(te=bi||ng(i,o,te,h,pe,Fe,F)||!1)?(ge||typeof E.UNSAFE_componentWillUpdate!="function"&&typeof E.componentWillUpdate!="function"||(typeof E.componentWillUpdate=="function"&&E.componentWillUpdate(h,Fe,F),typeof E.UNSAFE_componentWillUpdate=="function"&&E.UNSAFE_componentWillUpdate(h,Fe,F)),typeof E.componentDidUpdate=="function"&&(i.flags|=4),typeof E.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof E.componentDidUpdate!="function"||j===r.memoizedProps&&pe===r.memoizedState||(i.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||j===r.memoizedProps&&pe===r.memoizedState||(i.flags|=1024),i.memoizedProps=h,i.memoizedState=Fe),E.props=h,E.state=Fe,E.context=F,h=te):(typeof E.componentDidUpdate!="function"||j===r.memoizedProps&&pe===r.memoizedState||(i.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||j===r.memoizedProps&&pe===r.memoizedState||(i.flags|=1024),h=!1)}return vh(r,i,o,h,y,p)}function vh(r,i,o,h,p,y){pg(r,i);var E=(i.flags&128)!==0;if(!h&&!E)return p&&wm(i,o,!1),si(r,i,y);h=i.stateNode,bx.current=i;var j=E&&typeof o.getDerivedStateFromError!="function"?null:h.render();return i.flags|=1,r!==null&&E?(i.child=io(i,r.child,null,y),i.child=io(i,null,j,y)):dr(r,i,j,y),i.memoizedState=h.state,p&&wm(i,o,!0),i.child}function gg(r){var i=r.stateNode;i.pendingContext?vm(r,i.pendingContext,i.pendingContext!==i.context):i.context&&vm(r,i.context,!1),th(r,i.containerInfo)}function yg(r,i,o,h,p){return so(),Kd(p),i.flags|=256,dr(r,i,o,h),i.child}var _h={dehydrated:null,treeContext:null,retryLane:0};function wh(r){return{baseLanes:r,cachePool:null,transitions:null}}function vg(r,i,o){var h=i.pendingProps,p=Ht.current,y=!1,E=(i.flags&128)!==0,j;if((j=E)||(j=r!==null&&r.memoizedState===null?!1:(p&2)!==0),j?(y=!0,i.flags&=-129):(r===null||r.memoizedState!==null)&&(p|=1),Vt(Ht,p&1),r===null)return qd(i),r=i.memoizedState,r!==null&&(r=r.dehydrated,r!==null)?((i.mode&1)===0?i.lanes=1:r.data==="$!"?i.lanes=8:i.lanes=1073741824,null):(E=h.children,r=h.fallback,y?(h=i.mode,y=i.child,E={mode:"hidden",children:E},(h&1)===0&&y!==null?(y.childLanes=0,y.pendingProps=E):y=ru(E,h,0,null),r=Ea(r,h,o,null),y.return=i,r.return=i,y.sibling=r,i.child=y,i.child.memoizedState=wh(o),i.memoizedState=_h,r):xh(i,E));if(p=r.memoizedState,p!==null&&(j=p.dehydrated,j!==null))return Px(r,i,E,h,j,p,o);if(y){y=h.fallback,E=i.mode,p=r.child,j=p.sibling;var F={mode:"hidden",children:h.children};return(E&1)===0&&i.child!==p?(h=i.child,h.childLanes=0,h.pendingProps=F,i.deletions=null):(h=Di(p,F),h.subtreeFlags=p.subtreeFlags&14680064),j!==null?y=Di(j,y):(y=Ea(y,E,o,null),y.flags|=2),y.return=i,h.return=i,h.sibling=y,i.child=h,h=y,y=i.child,E=r.child.memoizedState,E=E===null?wh(o):{baseLanes:E.baseLanes|o,cachePool:null,transitions:E.transitions},y.memoizedState=E,y.childLanes=r.childLanes&~o,i.memoizedState=_h,h}return y=r.child,r=y.sibling,h=Di(y,{mode:"visible",children:h.children}),(i.mode&1)===0&&(h.lanes=o),h.return=i,h.sibling=null,r!==null&&(o=i.deletions,o===null?(i.deletions=[r],i.flags|=16):o.push(r)),i.child=h,i.memoizedState=null,h}function xh(r,i){return i=ru({mode:"visible",children:i},r.mode,0,null),i.return=r,r.child=i}function Wc(r,i,o,h){return h!==null&&Kd(h),io(i,r.child,null,o),r=xh(i,i.pendingProps.children),r.flags|=2,i.memoizedState=null,r}function Px(r,i,o,h,p,y,E){if(o)return i.flags&256?(i.flags&=-257,h=mh(Error(t(422))),Wc(r,i,E,h)):i.memoizedState!==null?(i.child=r.child,i.flags|=128,null):(y=h.fallback,p=i.mode,h=ru({mode:"visible",children:h.children},p,0,null),y=Ea(y,p,E,null),y.flags|=2,h.return=i,y.return=i,h.sibling=y,i.child=h,(i.mode&1)!==0&&io(i,r.child,null,E),i.child.memoizedState=wh(E),i.memoizedState=_h,y);if((i.mode&1)===0)return Wc(r,i,E,null);if(p.data==="$!"){if(h=p.nextSibling&&p.nextSibling.dataset,h)var j=h.dgst;return h=j,y=Error(t(419)),h=mh(y,h,void 0),Wc(r,i,E,h)}if(j=(E&r.childLanes)!==0,_r||j){if(h=Dn,h!==null){switch(E&-E){case 4:p=2;break;case 16:p=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:p=32;break;case 536870912:p=268435456;break;default:p=0}p=(p&(h.suspendedLanes|E))!==0?0:p,p!==0&&p!==y.retryLane&&(y.retryLane=p,ni(r,p),ms(h,r,p,-1))}return Oh(),h=mh(Error(t(421))),Wc(r,i,E,h)}return p.data==="$?"?(i.flags|=128,i.child=r.child,i=zx.bind(null,r),p._reactRetry=i,null):(r=y.treeContext,Lr=Ti(p.nextSibling),Dr=i,Gt=!0,ds=null,r!==null&&($r[Wr++]=ei,$r[Wr++]=ti,$r[Wr++]=fa,ei=r.id,ti=r.overflow,fa=i),i=xh(i,h.children),i.flags|=4096,i)}function _g(r,i,o){r.lanes|=i;var h=r.alternate;h!==null&&(h.lanes|=i),Xd(r.return,i,o)}function Eh(r,i,o,h,p){var y=r.memoizedState;y===null?r.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:h,tail:o,tailMode:p}:(y.isBackwards=i,y.rendering=null,y.renderingStartTime=0,y.last=h,y.tail=o,y.tailMode=p)}function wg(r,i,o){var h=i.pendingProps,p=h.revealOrder,y=h.tail;if(dr(r,i,h.children,o),h=Ht.current,(h&2)!==0)h=h&1|2,i.flags|=128;else{if(r!==null&&(r.flags&128)!==0)e:for(r=i.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&_g(r,o,i);else if(r.tag===19)_g(r,o,i);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===i)break e;for(;r.sibling===null;){if(r.return===null||r.return===i)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}h&=1}if(Vt(Ht,h),(i.mode&1)===0)i.memoizedState=null;else switch(p){case"forwards":for(o=i.child,p=null;o!==null;)r=o.alternate,r!==null&&Oc(r)===null&&(p=o),o=o.sibling;o=p,o===null?(p=i.child,i.child=null):(p=o.sibling,o.sibling=null),Eh(i,!1,p,o,y);break;case"backwards":for(o=null,p=i.child,i.child=null;p!==null;){if(r=p.alternate,r!==null&&Oc(r)===null){i.child=p;break}r=p.sibling,p.sibling=o,o=p,p=r}Eh(i,!0,o,null,y);break;case"together":Eh(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function Gc(r,i){(i.mode&1)===0&&r!==null&&(r.alternate=null,i.alternate=null,i.flags|=2)}function si(r,i,o){if(r!==null&&(i.dependencies=r.dependencies),va|=i.lanes,(o&i.childLanes)===0)return null;if(r!==null&&i.child!==r.child)throw Error(t(153));if(i.child!==null){for(r=i.child,o=Di(r,r.pendingProps),i.child=o,o.return=i;r.sibling!==null;)r=r.sibling,o=o.sibling=Di(r,r.pendingProps),o.return=i;o.sibling=null}return i.child}function Rx(r,i,o){switch(i.tag){case 3:gg(i),so();break;case 5:Dm(i);break;case 1:vr(i.type)&&bc(i);break;case 4:th(i,i.stateNode.containerInfo);break;case 10:var h=i.type._context,p=i.memoizedProps.value;Vt(jc,h._currentValue),h._currentValue=p;break;case 13:if(h=i.memoizedState,h!==null)return h.dehydrated!==null?(Vt(Ht,Ht.current&1),i.flags|=128,null):(o&i.child.childLanes)!==0?vg(r,i,o):(Vt(Ht,Ht.current&1),r=si(r,i,o),r!==null?r.sibling:null);Vt(Ht,Ht.current&1);break;case 19:if(h=(o&i.childLanes)!==0,(r.flags&128)!==0){if(h)return wg(r,i,o);i.flags|=128}if(p=i.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),Vt(Ht,Ht.current),h)break;return null;case 22:case 23:return i.lanes=0,fg(r,i,o)}return si(r,i,o)}var xg,Th,Eg,Tg;xg=function(r,i){for(var o=i.child;o!==null;){if(o.tag===5||o.tag===6)r.appendChild(o.stateNode);else if(o.tag!==4&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return;o=o.return}o.sibling.return=o.return,o=o.sibling}},Th=function(){},Eg=function(r,i,o,h){var p=r.memoizedProps;if(p!==h){r=i.stateNode,ga(Ns.current);var y=null;switch(o){case"input":p=Qe(r,p),h=Qe(r,h),y=[];break;case"select":p=be({},p,{value:void 0}),h=be({},h,{value:void 0}),y=[];break;case"textarea":p=ln(r,p),h=ln(r,h),y=[];break;default:typeof p.onClick!="function"&&typeof h.onClick=="function"&&(r.onclick=Sc)}es(o,h);var E;o=null;for(te in p)if(!h.hasOwnProperty(te)&&p.hasOwnProperty(te)&&p[te]!=null)if(te==="style"){var j=p[te];for(E in j)j.hasOwnProperty(E)&&(o||(o={}),o[E]="")}else te!=="dangerouslySetInnerHTML"&&te!=="children"&&te!=="suppressContentEditableWarning"&&te!=="suppressHydrationWarning"&&te!=="autoFocus"&&(a.hasOwnProperty(te)?y||(y=[]):(y=y||[]).push(te,null));for(te in h){var F=h[te];if(j=p!=null?p[te]:void 0,h.hasOwnProperty(te)&&F!==j&&(F!=null||j!=null))if(te==="style")if(j){for(E in j)!j.hasOwnProperty(E)||F&&F.hasOwnProperty(E)||(o||(o={}),o[E]="");for(E in F)F.hasOwnProperty(E)&&j[E]!==F[E]&&(o||(o={}),o[E]=F[E])}else o||(y||(y=[]),y.push(te,o)),o=F;else te==="dangerouslySetInnerHTML"?(F=F?F.__html:void 0,j=j?j.__html:void 0,F!=null&&j!==F&&(y=y||[]).push(te,F)):te==="children"?typeof F!="string"&&typeof F!="number"||(y=y||[]).push(te,""+F):te!=="suppressContentEditableWarning"&&te!=="suppressHydrationWarning"&&(a.hasOwnProperty(te)?(F!=null&&te==="onScroll"&&Ft("scroll",r),y||j===F||(y=[])):(y=y||[]).push(te,F))}o&&(y=y||[]).push("style",o);var te=y;(i.updateQueue=te)&&(i.flags|=4)}},Tg=function(r,i,o,h){o!==h&&(i.flags|=4)};function gl(r,i){if(!Gt)switch(r.tailMode){case"hidden":i=r.tail;for(var o=null;i!==null;)i.alternate!==null&&(o=i),i=i.sibling;o===null?r.tail=null:o.sibling=null;break;case"collapsed":o=r.tail;for(var h=null;o!==null;)o.alternate!==null&&(h=o),o=o.sibling;h===null?i||r.tail===null?r.tail=null:r.tail.sibling=null:h.sibling=null}}function tr(r){var i=r.alternate!==null&&r.alternate.child===r.child,o=0,h=0;if(i)for(var p=r.child;p!==null;)o|=p.lanes|p.childLanes,h|=p.subtreeFlags&14680064,h|=p.flags&14680064,p.return=r,p=p.sibling;else for(p=r.child;p!==null;)o|=p.lanes|p.childLanes,h|=p.subtreeFlags,h|=p.flags,p.return=r,p=p.sibling;return r.subtreeFlags|=h,r.childLanes=o,i}function Nx(r,i,o){var h=i.pendingProps;switch(Gd(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return tr(i),null;case 1:return vr(i.type)&&Ic(),tr(i),null;case 3:return h=i.stateNode,lo(),Ut(yr),Ut(Zn),sh(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(r===null||r.child===null)&&(Ac(i)?i.flags|=4:r===null||r.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,ds!==null&&(Dh(ds),ds=null))),Th(r,i),tr(i),null;case 5:nh(i);var p=ga(dl.current);if(o=i.type,r!==null&&i.stateNode!=null)Eg(r,i,o,h,p),r.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!h){if(i.stateNode===null)throw Error(t(166));return tr(i),null}if(r=ga(Ns.current),Ac(i)){h=i.stateNode,o=i.type;var y=i.memoizedProps;switch(h[Rs]=i,h[al]=y,r=(i.mode&1)!==0,o){case"dialog":Ft("cancel",h),Ft("close",h);break;case"iframe":case"object":case"embed":Ft("load",h);break;case"video":case"audio":for(p=0;p<rl.length;p++)Ft(rl[p],h);break;case"source":Ft("error",h);break;case"img":case"image":case"link":Ft("error",h),Ft("load",h);break;case"details":Ft("toggle",h);break;case"input":Je(h,y),Ft("invalid",h);break;case"select":h._wrapperState={wasMultiple:!!y.multiple},Ft("invalid",h);break;case"textarea":fr(h,y),Ft("invalid",h)}es(o,y),p=null;for(var E in y)if(y.hasOwnProperty(E)){var j=y[E];E==="children"?typeof j=="string"?h.textContent!==j&&(y.suppressHydrationWarning!==!0&&Tc(h.textContent,j,r),p=["children",j]):typeof j=="number"&&h.textContent!==""+j&&(y.suppressHydrationWarning!==!0&&Tc(h.textContent,j,r),p=["children",""+j]):a.hasOwnProperty(E)&&j!=null&&E==="onScroll"&&Ft("scroll",h)}switch(o){case"input":fe(h),St(h,y,!0);break;case"textarea":fe(h),qn(h);break;case"select":case"option":break;default:typeof y.onClick=="function"&&(h.onclick=Sc)}h=p,i.updateQueue=h,h!==null&&(i.flags|=4)}else{E=p.nodeType===9?p:p.ownerDocument,r==="http://www.w3.org/1999/xhtml"&&(r=Ot(o)),r==="http://www.w3.org/1999/xhtml"?o==="script"?(r=E.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild)):typeof h.is=="string"?r=E.createElement(o,{is:h.is}):(r=E.createElement(o),o==="select"&&(E=r,h.multiple?E.multiple=!0:h.size&&(E.size=h.size))):r=E.createElementNS(r,o),r[Rs]=i,r[al]=h,xg(r,i,!1,!1),i.stateNode=r;e:{switch(E=ws(o,h),o){case"dialog":Ft("cancel",r),Ft("close",r),p=h;break;case"iframe":case"object":case"embed":Ft("load",r),p=h;break;case"video":case"audio":for(p=0;p<rl.length;p++)Ft(rl[p],r);p=h;break;case"source":Ft("error",r),p=h;break;case"img":case"image":case"link":Ft("error",r),Ft("load",r),p=h;break;case"details":Ft("toggle",r),p=h;break;case"input":Je(r,h),p=Qe(r,h),Ft("invalid",r);break;case"option":p=h;break;case"select":r._wrapperState={wasMultiple:!!h.multiple},p=be({},h,{value:void 0}),Ft("invalid",r);break;case"textarea":fr(r,h),p=ln(r,h),Ft("invalid",r);break;default:p=h}es(o,p),j=p;for(y in j)if(j.hasOwnProperty(y)){var F=j[y];y==="style"?In(r,F):y==="dangerouslySetInnerHTML"?(F=F?F.__html:void 0,F!=null&&lr(r,F)):y==="children"?typeof F=="string"?(o!=="textarea"||F!=="")&&Cn(r,F):typeof F=="number"&&Cn(r,""+F):y!=="suppressContentEditableWarning"&&y!=="suppressHydrationWarning"&&y!=="autoFocus"&&(a.hasOwnProperty(y)?F!=null&&y==="onScroll"&&Ft("scroll",r):F!=null&&we(r,y,F,E))}switch(o){case"input":fe(r),St(r,h,!1);break;case"textarea":fe(r),qn(r);break;case"option":h.value!=null&&r.setAttribute("value",""+qe(h.value));break;case"select":r.multiple=!!h.multiple,y=h.value,y!=null?Sn(r,!!h.multiple,y,!1):h.defaultValue!=null&&Sn(r,!!h.multiple,h.defaultValue,!0);break;default:typeof p.onClick=="function"&&(r.onclick=Sc)}switch(o){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}}h&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return tr(i),null;case 6:if(r&&i.stateNode!=null)Tg(r,i,r.memoizedProps,h);else{if(typeof h!="string"&&i.stateNode===null)throw Error(t(166));if(o=ga(dl.current),ga(Ns.current),Ac(i)){if(h=i.stateNode,o=i.memoizedProps,h[Rs]=i,(y=h.nodeValue!==o)&&(r=Dr,r!==null))switch(r.tag){case 3:Tc(h.nodeValue,o,(r.mode&1)!==0);break;case 5:r.memoizedProps.suppressHydrationWarning!==!0&&Tc(h.nodeValue,o,(r.mode&1)!==0)}y&&(i.flags|=4)}else h=(o.nodeType===9?o:o.ownerDocument).createTextNode(h),h[Rs]=i,i.stateNode=h}return tr(i),null;case 13:if(Ut(Ht),h=i.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(Gt&&Lr!==null&&(i.mode&1)!==0&&(i.flags&128)===0)Im(),so(),i.flags|=98560,y=!1;else if(y=Ac(i),h!==null&&h.dehydrated!==null){if(r===null){if(!y)throw Error(t(318));if(y=i.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(t(317));y[Rs]=i}else so(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;tr(i),y=!1}else ds!==null&&(Dh(ds),ds=null),y=!0;if(!y)return i.flags&65536?i:null}return(i.flags&128)!==0?(i.lanes=o,i):(h=h!==null,h!==(r!==null&&r.memoizedState!==null)&&h&&(i.child.flags|=8192,(i.mode&1)!==0&&(r===null||(Ht.current&1)!==0?xn===0&&(xn=3):Oh())),i.updateQueue!==null&&(i.flags|=4),tr(i),null);case 4:return lo(),Th(r,i),r===null&&sl(i.stateNode.containerInfo),tr(i),null;case 10:return Jd(i.type._context),tr(i),null;case 17:return vr(i.type)&&Ic(),tr(i),null;case 19:if(Ut(Ht),y=i.memoizedState,y===null)return tr(i),null;if(h=(i.flags&128)!==0,E=y.rendering,E===null)if(h)gl(y,!1);else{if(xn!==0||r!==null&&(r.flags&128)!==0)for(r=i.child;r!==null;){if(E=Oc(r),E!==null){for(i.flags|=128,gl(y,!1),h=E.updateQueue,h!==null&&(i.updateQueue=h,i.flags|=4),i.subtreeFlags=0,h=o,o=i.child;o!==null;)y=o,r=h,y.flags&=14680066,E=y.alternate,E===null?(y.childLanes=0,y.lanes=r,y.child=null,y.subtreeFlags=0,y.memoizedProps=null,y.memoizedState=null,y.updateQueue=null,y.dependencies=null,y.stateNode=null):(y.childLanes=E.childLanes,y.lanes=E.lanes,y.child=E.child,y.subtreeFlags=0,y.deletions=null,y.memoizedProps=E.memoizedProps,y.memoizedState=E.memoizedState,y.updateQueue=E.updateQueue,y.type=E.type,r=E.dependencies,y.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),o=o.sibling;return Vt(Ht,Ht.current&1|2),i.child}r=r.sibling}y.tail!==null&&ut()>fo&&(i.flags|=128,h=!0,gl(y,!1),i.lanes=4194304)}else{if(!h)if(r=Oc(E),r!==null){if(i.flags|=128,h=!0,o=r.updateQueue,o!==null&&(i.updateQueue=o,i.flags|=4),gl(y,!0),y.tail===null&&y.tailMode==="hidden"&&!E.alternate&&!Gt)return tr(i),null}else 2*ut()-y.renderingStartTime>fo&&o!==1073741824&&(i.flags|=128,h=!0,gl(y,!1),i.lanes=4194304);y.isBackwards?(E.sibling=i.child,i.child=E):(o=y.last,o!==null?o.sibling=E:i.child=E,y.last=E)}return y.tail!==null?(i=y.tail,y.rendering=i,y.tail=i.sibling,y.renderingStartTime=ut(),i.sibling=null,o=Ht.current,Vt(Ht,h?o&1|2:o&1),i):(tr(i),null);case 22:case 23:return Vh(),h=i.memoizedState!==null,r!==null&&r.memoizedState!==null!==h&&(i.flags|=8192),h&&(i.mode&1)!==0?(Vr&1073741824)!==0&&(tr(i),i.subtreeFlags&6&&(i.flags|=8192)):tr(i),null;case 24:return null;case 25:return null}throw Error(t(156,i.tag))}function Ax(r,i){switch(Gd(i),i.tag){case 1:return vr(i.type)&&Ic(),r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 3:return lo(),Ut(yr),Ut(Zn),sh(),r=i.flags,(r&65536)!==0&&(r&128)===0?(i.flags=r&-65537|128,i):null;case 5:return nh(i),null;case 13:if(Ut(Ht),r=i.memoizedState,r!==null&&r.dehydrated!==null){if(i.alternate===null)throw Error(t(340));so()}return r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 19:return Ut(Ht),null;case 4:return lo(),null;case 10:return Jd(i.type._context),null;case 22:case 23:return Vh(),null;case 24:return null;default:return null}}var Hc=!1,nr=!1,kx=typeof WeakSet=="function"?WeakSet:Set,Me=null;function uo(r,i){var o=r.ref;if(o!==null)if(typeof o=="function")try{o(null)}catch(h){Jt(r,i,h)}else o.current=null}function Sh(r,i,o){try{o()}catch(h){Jt(r,i,h)}}var Sg=!1;function jx(r,i){if(Vd=wi,r=nm(),Pd(r)){if("selectionStart"in r)var o={start:r.selectionStart,end:r.selectionEnd};else e:{o=(o=r.ownerDocument)&&o.defaultView||window;var h=o.getSelection&&o.getSelection();if(h&&h.rangeCount!==0){o=h.anchorNode;var p=h.anchorOffset,y=h.focusNode;h=h.focusOffset;try{o.nodeType,y.nodeType}catch{o=null;break e}var E=0,j=-1,F=-1,te=0,ge=0,ve=r,pe=null;t:for(;;){for(var Ve;ve!==o||p!==0&&ve.nodeType!==3||(j=E+p),ve!==y||h!==0&&ve.nodeType!==3||(F=E+h),ve.nodeType===3&&(E+=ve.nodeValue.length),(Ve=ve.firstChild)!==null;)pe=ve,ve=Ve;for(;;){if(ve===r)break t;if(pe===o&&++te===p&&(j=E),pe===y&&++ge===h&&(F=E),(Ve=ve.nextSibling)!==null)break;ve=pe,pe=ve.parentNode}ve=Ve}o=j===-1||F===-1?null:{start:j,end:F}}else o=null}o=o||{start:0,end:0}}else o=null;for(Od={focusedElem:r,selectionRange:o},wi=!1,Me=i;Me!==null;)if(i=Me,r=i.child,(i.subtreeFlags&1028)!==0&&r!==null)r.return=i,Me=r;else for(;Me!==null;){i=Me;try{var Fe=i.alternate;if((i.flags&1024)!==0)switch(i.tag){case 0:case 11:case 15:break;case 1:if(Fe!==null){var ze=Fe.memoizedProps,tn=Fe.memoizedState,J=i.stateNode,G=J.getSnapshotBeforeUpdate(i.elementType===i.type?ze:hs(i.type,ze),tn);J.__reactInternalSnapshotBeforeUpdate=G}break;case 3:var X=i.stateNode.containerInfo;X.nodeType===1?X.textContent="":X.nodeType===9&&X.documentElement&&X.removeChild(X.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Pe){Jt(i,i.return,Pe)}if(r=i.sibling,r!==null){r.return=i.return,Me=r;break}Me=i.return}return Fe=Sg,Sg=!1,Fe}function yl(r,i,o){var h=i.updateQueue;if(h=h!==null?h.lastEffect:null,h!==null){var p=h=h.next;do{if((p.tag&r)===r){var y=p.destroy;p.destroy=void 0,y!==void 0&&Sh(i,o,y)}p=p.next}while(p!==h)}}function qc(r,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var o=i=i.next;do{if((o.tag&r)===r){var h=o.create;o.destroy=h()}o=o.next}while(o!==i)}}function Ch(r){var i=r.ref;if(i!==null){var o=r.stateNode;switch(r.tag){case 5:r=o;break;default:r=o}typeof i=="function"?i(r):i.current=r}}function Cg(r){var i=r.alternate;i!==null&&(r.alternate=null,Cg(i)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(i=r.stateNode,i!==null&&(delete i[Rs],delete i[al],delete i[zd],delete i[mx],delete i[gx])),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}function Ig(r){return r.tag===5||r.tag===3||r.tag===4}function bg(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||Ig(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Ih(r,i,o){var h=r.tag;if(h===5||h===6)r=r.stateNode,i?o.nodeType===8?o.parentNode.insertBefore(r,i):o.insertBefore(r,i):(o.nodeType===8?(i=o.parentNode,i.insertBefore(r,o)):(i=o,i.appendChild(r)),o=o._reactRootContainer,o!=null||i.onclick!==null||(i.onclick=Sc));else if(h!==4&&(r=r.child,r!==null))for(Ih(r,i,o),r=r.sibling;r!==null;)Ih(r,i,o),r=r.sibling}function bh(r,i,o){var h=r.tag;if(h===5||h===6)r=r.stateNode,i?o.insertBefore(r,i):o.appendChild(r);else if(h!==4&&(r=r.child,r!==null))for(bh(r,i,o),r=r.sibling;r!==null;)bh(r,i,o),r=r.sibling}var Bn=null,fs=!1;function Ri(r,i,o){for(o=o.child;o!==null;)Pg(r,i,o),o=o.sibling}function Pg(r,i,o){if(ie&&typeof ie.onCommitFiberUnmount=="function")try{ie.onCommitFiberUnmount(q,o)}catch{}switch(o.tag){case 5:nr||uo(o,i);case 6:var h=Bn,p=fs;Bn=null,Ri(r,i,o),Bn=h,fs=p,Bn!==null&&(fs?(r=Bn,o=o.stateNode,r.nodeType===8?r.parentNode.removeChild(o):r.removeChild(o)):Bn.removeChild(o.stateNode));break;case 18:Bn!==null&&(fs?(r=Bn,o=o.stateNode,r.nodeType===8?Ud(r.parentNode,o):r.nodeType===1&&Ud(r,o),Un(r)):Ud(Bn,o.stateNode));break;case 4:h=Bn,p=fs,Bn=o.stateNode.containerInfo,fs=!0,Ri(r,i,o),Bn=h,fs=p;break;case 0:case 11:case 14:case 15:if(!nr&&(h=o.updateQueue,h!==null&&(h=h.lastEffect,h!==null))){p=h=h.next;do{var y=p,E=y.destroy;y=y.tag,E!==void 0&&((y&2)!==0||(y&4)!==0)&&Sh(o,i,E),p=p.next}while(p!==h)}Ri(r,i,o);break;case 1:if(!nr&&(uo(o,i),h=o.stateNode,typeof h.componentWillUnmount=="function"))try{h.props=o.memoizedProps,h.state=o.memoizedState,h.componentWillUnmount()}catch(j){Jt(o,i,j)}Ri(r,i,o);break;case 21:Ri(r,i,o);break;case 22:o.mode&1?(nr=(h=nr)||o.memoizedState!==null,Ri(r,i,o),nr=h):Ri(r,i,o);break;default:Ri(r,i,o)}}function Rg(r){var i=r.updateQueue;if(i!==null){r.updateQueue=null;var o=r.stateNode;o===null&&(o=r.stateNode=new kx),i.forEach(function(h){var p=Bx.bind(null,r,h);o.has(h)||(o.add(h),h.then(p,p))})}}function ps(r,i){var o=i.deletions;if(o!==null)for(var h=0;h<o.length;h++){var p=o[h];try{var y=r,E=i,j=E;e:for(;j!==null;){switch(j.tag){case 5:Bn=j.stateNode,fs=!1;break e;case 3:Bn=j.stateNode.containerInfo,fs=!0;break e;case 4:Bn=j.stateNode.containerInfo,fs=!0;break e}j=j.return}if(Bn===null)throw Error(t(160));Pg(y,E,p),Bn=null,fs=!1;var F=p.alternate;F!==null&&(F.return=null),p.return=null}catch(te){Jt(p,i,te)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)Ng(i,r),i=i.sibling}function Ng(r,i){var o=r.alternate,h=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:if(ps(i,r),ks(r),h&4){try{yl(3,r,r.return),qc(3,r)}catch(ze){Jt(r,r.return,ze)}try{yl(5,r,r.return)}catch(ze){Jt(r,r.return,ze)}}break;case 1:ps(i,r),ks(r),h&512&&o!==null&&uo(o,o.return);break;case 5:if(ps(i,r),ks(r),h&512&&o!==null&&uo(o,o.return),r.flags&32){var p=r.stateNode;try{Cn(p,"")}catch(ze){Jt(r,r.return,ze)}}if(h&4&&(p=r.stateNode,p!=null)){var y=r.memoizedProps,E=o!==null?o.memoizedProps:y,j=r.type,F=r.updateQueue;if(r.updateQueue=null,F!==null)try{j==="input"&&y.type==="radio"&&y.name!=null&&Rt(p,y),ws(j,E);var te=ws(j,y);for(E=0;E<F.length;E+=2){var ge=F[E],ve=F[E+1];ge==="style"?In(p,ve):ge==="dangerouslySetInnerHTML"?lr(p,ve):ge==="children"?Cn(p,ve):we(p,ge,ve,te)}switch(j){case"input":kt(p,y);break;case"textarea":Xt(p,y);break;case"select":var pe=p._wrapperState.wasMultiple;p._wrapperState.wasMultiple=!!y.multiple;var Ve=y.value;Ve!=null?Sn(p,!!y.multiple,Ve,!1):pe!==!!y.multiple&&(y.defaultValue!=null?Sn(p,!!y.multiple,y.defaultValue,!0):Sn(p,!!y.multiple,y.multiple?[]:"",!1))}p[al]=y}catch(ze){Jt(r,r.return,ze)}}break;case 6:if(ps(i,r),ks(r),h&4){if(r.stateNode===null)throw Error(t(162));p=r.stateNode,y=r.memoizedProps;try{p.nodeValue=y}catch(ze){Jt(r,r.return,ze)}}break;case 3:if(ps(i,r),ks(r),h&4&&o!==null&&o.memoizedState.isDehydrated)try{Un(i.containerInfo)}catch(ze){Jt(r,r.return,ze)}break;case 4:ps(i,r),ks(r);break;case 13:ps(i,r),ks(r),p=r.child,p.flags&8192&&(y=p.memoizedState!==null,p.stateNode.isHidden=y,!y||p.alternate!==null&&p.alternate.memoizedState!==null||(Nh=ut())),h&4&&Rg(r);break;case 22:if(ge=o!==null&&o.memoizedState!==null,r.mode&1?(nr=(te=nr)||ge,ps(i,r),nr=te):ps(i,r),ks(r),h&8192){if(te=r.memoizedState!==null,(r.stateNode.isHidden=te)&&!ge&&(r.mode&1)!==0)for(Me=r,ge=r.child;ge!==null;){for(ve=Me=ge;Me!==null;){switch(pe=Me,Ve=pe.child,pe.tag){case 0:case 11:case 14:case 15:yl(4,pe,pe.return);break;case 1:uo(pe,pe.return);var Fe=pe.stateNode;if(typeof Fe.componentWillUnmount=="function"){h=pe,o=pe.return;try{i=h,Fe.props=i.memoizedProps,Fe.state=i.memoizedState,Fe.componentWillUnmount()}catch(ze){Jt(h,o,ze)}}break;case 5:uo(pe,pe.return);break;case 22:if(pe.memoizedState!==null){jg(ve);continue}}Ve!==null?(Ve.return=pe,Me=Ve):jg(ve)}ge=ge.sibling}e:for(ge=null,ve=r;;){if(ve.tag===5){if(ge===null){ge=ve;try{p=ve.stateNode,te?(y=p.style,typeof y.setProperty=="function"?y.setProperty("display","none","important"):y.display="none"):(j=ve.stateNode,F=ve.memoizedProps.style,E=F!=null&&F.hasOwnProperty("display")?F.display:null,j.style.display=Zr("display",E))}catch(ze){Jt(r,r.return,ze)}}}else if(ve.tag===6){if(ge===null)try{ve.stateNode.nodeValue=te?"":ve.memoizedProps}catch(ze){Jt(r,r.return,ze)}}else if((ve.tag!==22&&ve.tag!==23||ve.memoizedState===null||ve===r)&&ve.child!==null){ve.child.return=ve,ve=ve.child;continue}if(ve===r)break e;for(;ve.sibling===null;){if(ve.return===null||ve.return===r)break e;ge===ve&&(ge=null),ve=ve.return}ge===ve&&(ge=null),ve.sibling.return=ve.return,ve=ve.sibling}}break;case 19:ps(i,r),ks(r),h&4&&Rg(r);break;case 21:break;default:ps(i,r),ks(r)}}function ks(r){var i=r.flags;if(i&2){try{e:{for(var o=r.return;o!==null;){if(Ig(o)){var h=o;break e}o=o.return}throw Error(t(160))}switch(h.tag){case 5:var p=h.stateNode;h.flags&32&&(Cn(p,""),h.flags&=-33);var y=bg(r);bh(r,y,p);break;case 3:case 4:var E=h.stateNode.containerInfo,j=bg(r);Ih(r,j,E);break;default:throw Error(t(161))}}catch(F){Jt(r,r.return,F)}r.flags&=-3}i&4096&&(r.flags&=-4097)}function Dx(r,i,o){Me=r,Ag(r)}function Ag(r,i,o){for(var h=(r.mode&1)!==0;Me!==null;){var p=Me,y=p.child;if(p.tag===22&&h){var E=p.memoizedState!==null||Hc;if(!E){var j=p.alternate,F=j!==null&&j.memoizedState!==null||nr;j=Hc;var te=nr;if(Hc=E,(nr=F)&&!te)for(Me=p;Me!==null;)E=Me,F=E.child,E.tag===22&&E.memoizedState!==null?Dg(p):F!==null?(F.return=E,Me=F):Dg(p);for(;y!==null;)Me=y,Ag(y),y=y.sibling;Me=p,Hc=j,nr=te}kg(r)}else(p.subtreeFlags&8772)!==0&&y!==null?(y.return=p,Me=y):kg(r)}}function kg(r){for(;Me!==null;){var i=Me;if((i.flags&8772)!==0){var o=i.alternate;try{if((i.flags&8772)!==0)switch(i.tag){case 0:case 11:case 15:nr||qc(5,i);break;case 1:var h=i.stateNode;if(i.flags&4&&!nr)if(o===null)h.componentDidMount();else{var p=i.elementType===i.type?o.memoizedProps:hs(i.type,o.memoizedProps);h.componentDidUpdate(p,o.memoizedState,h.__reactInternalSnapshotBeforeUpdate)}var y=i.updateQueue;y!==null&&jm(i,y,h);break;case 3:var E=i.updateQueue;if(E!==null){if(o=null,i.child!==null)switch(i.child.tag){case 5:o=i.child.stateNode;break;case 1:o=i.child.stateNode}jm(i,E,o)}break;case 5:var j=i.stateNode;if(o===null&&i.flags&4){o=j;var F=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":F.autoFocus&&o.focus();break;case"img":F.src&&(o.src=F.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var te=i.alternate;if(te!==null){var ge=te.memoizedState;if(ge!==null){var ve=ge.dehydrated;ve!==null&&Un(ve)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}nr||i.flags&512&&Ch(i)}catch(pe){Jt(i,i.return,pe)}}if(i===r){Me=null;break}if(o=i.sibling,o!==null){o.return=i.return,Me=o;break}Me=i.return}}function jg(r){for(;Me!==null;){var i=Me;if(i===r){Me=null;break}var o=i.sibling;if(o!==null){o.return=i.return,Me=o;break}Me=i.return}}function Dg(r){for(;Me!==null;){var i=Me;try{switch(i.tag){case 0:case 11:case 15:var o=i.return;try{qc(4,i)}catch(F){Jt(i,o,F)}break;case 1:var h=i.stateNode;if(typeof h.componentDidMount=="function"){var p=i.return;try{h.componentDidMount()}catch(F){Jt(i,p,F)}}var y=i.return;try{Ch(i)}catch(F){Jt(i,y,F)}break;case 5:var E=i.return;try{Ch(i)}catch(F){Jt(i,E,F)}}}catch(F){Jt(i,i.return,F)}if(i===r){Me=null;break}var j=i.sibling;if(j!==null){j.return=i.return,Me=j;break}Me=i.return}}var Lx=Math.ceil,Kc=Ee.ReactCurrentDispatcher,Ph=Ee.ReactCurrentOwner,qr=Ee.ReactCurrentBatchConfig,Tt=0,Dn=null,dn=null,$n=0,Vr=0,ho=Si(0),xn=0,vl=null,va=0,Qc=0,Rh=0,_l=null,wr=null,Nh=0,fo=1/0,ii=null,Yc=!1,Ah=null,Ni=null,Jc=!1,Ai=null,Xc=0,wl=0,kh=null,Zc=-1,eu=0;function hr(){return(Tt&6)!==0?ut():Zc!==-1?Zc:Zc=ut()}function ki(r){return(r.mode&1)===0?1:(Tt&2)!==0&&$n!==0?$n&-$n:vx.transition!==null?(eu===0&&(eu=is()),eu):(r=ft,r!==0||(r=window.event,r=r===void 0?16:Ko(r.type)),r)}function ms(r,i,o,h){if(50<wl)throw wl=0,kh=null,Error(t(185));os(r,o,h),((Tt&2)===0||r!==Dn)&&(r===Dn&&((Tt&2)===0&&(Qc|=o),xn===4&&ji(r,$n)),xr(r,h),o===1&&Tt===0&&(i.mode&1)===0&&(fo=ut()+500,Pc&&Ii()))}function xr(r,i){var o=r.callbackNode;yn(r,i);var h=cr(r,r===Dn?$n:0);if(h===0)o!==null&&gn(o),r.callbackNode=null,r.callbackPriority=0;else if(i=h&-h,r.callbackPriority!==i){if(o!=null&&gn(o),i===1)r.tag===0?yx(Vg.bind(null,r)):xm(Vg.bind(null,r)),fx(function(){(Tt&6)===0&&Ii()}),o=null;else{switch(Cs(h)){case 1:o=An;break;case 4:o=x;break;case 16:o=$;break;case 536870912:o=L;break;default:o=$}o=Wg(o,Lg.bind(null,r))}r.callbackPriority=i,r.callbackNode=o}}function Lg(r,i){if(Zc=-1,eu=0,(Tt&6)!==0)throw Error(t(327));var o=r.callbackNode;if(po()&&r.callbackNode!==o)return null;var h=cr(r,r===Dn?$n:0);if(h===0)return null;if((h&30)!==0||(h&r.expiredLanes)!==0||i)i=tu(r,h);else{i=h;var p=Tt;Tt|=2;var y=Mg();(Dn!==r||$n!==i)&&(ii=null,fo=ut()+500,wa(r,i));do try{Mx();break}catch(j){Og(r,j)}while(!0);Yd(),Kc.current=y,Tt=p,dn!==null?i=0:(Dn=null,$n=0,i=xn)}if(i!==0){if(i===2&&(p=Yt(r),p!==0&&(h=p,i=jh(r,p))),i===1)throw o=vl,wa(r,0),ji(r,h),xr(r,ut()),o;if(i===6)ji(r,h);else{if(p=r.current.alternate,(h&30)===0&&!Vx(p)&&(i=tu(r,h),i===2&&(y=Yt(r),y!==0&&(h=y,i=jh(r,y))),i===1))throw o=vl,wa(r,0),ji(r,h),xr(r,ut()),o;switch(r.finishedWork=p,r.finishedLanes=h,i){case 0:case 1:throw Error(t(345));case 2:xa(r,wr,ii);break;case 3:if(ji(r,h),(h&130023424)===h&&(i=Nh+500-ut(),10<i)){if(cr(r,0)!==0)break;if(p=r.suspendedLanes,(p&h)!==h){hr(),r.pingedLanes|=r.suspendedLanes&p;break}r.timeoutHandle=Fd(xa.bind(null,r,wr,ii),i);break}xa(r,wr,ii);break;case 4:if(ji(r,h),(h&4194240)===h)break;for(i=r.eventTimes,p=-1;0<h;){var E=31-Se(h);y=1<<E,E=i[E],E>p&&(p=E),h&=~y}if(h=p,h=ut()-h,h=(120>h?120:480>h?480:1080>h?1080:1920>h?1920:3e3>h?3e3:4320>h?4320:1960*Lx(h/1960))-h,10<h){r.timeoutHandle=Fd(xa.bind(null,r,wr,ii),h);break}xa(r,wr,ii);break;case 5:xa(r,wr,ii);break;default:throw Error(t(329))}}}return xr(r,ut()),r.callbackNode===o?Lg.bind(null,r):null}function jh(r,i){var o=_l;return r.current.memoizedState.isDehydrated&&(wa(r,i).flags|=256),r=tu(r,i),r!==2&&(i=wr,wr=o,i!==null&&Dh(i)),r}function Dh(r){wr===null?wr=r:wr.push.apply(wr,r)}function Vx(r){for(var i=r;;){if(i.flags&16384){var o=i.updateQueue;if(o!==null&&(o=o.stores,o!==null))for(var h=0;h<o.length;h++){var p=o[h],y=p.getSnapshot;p=p.value;try{if(!us(y(),p))return!1}catch{return!1}}}if(o=i.child,i.subtreeFlags&16384&&o!==null)o.return=i,i=o;else{if(i===r)break;for(;i.sibling===null;){if(i.return===null||i.return===r)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function ji(r,i){for(i&=~Rh,i&=~Qc,r.suspendedLanes|=i,r.pingedLanes&=~i,r=r.expirationTimes;0<i;){var o=31-Se(i),h=1<<o;r[o]=-1,i&=~h}}function Vg(r){if((Tt&6)!==0)throw Error(t(327));po();var i=cr(r,0);if((i&1)===0)return xr(r,ut()),null;var o=tu(r,i);if(r.tag!==0&&o===2){var h=Yt(r);h!==0&&(i=h,o=jh(r,h))}if(o===1)throw o=vl,wa(r,0),ji(r,i),xr(r,ut()),o;if(o===6)throw Error(t(345));return r.finishedWork=r.current.alternate,r.finishedLanes=i,xa(r,wr,ii),xr(r,ut()),null}function Lh(r,i){var o=Tt;Tt|=1;try{return r(i)}finally{Tt=o,Tt===0&&(fo=ut()+500,Pc&&Ii())}}function _a(r){Ai!==null&&Ai.tag===0&&(Tt&6)===0&&po();var i=Tt;Tt|=1;var o=qr.transition,h=ft;try{if(qr.transition=null,ft=1,r)return r()}finally{ft=h,qr.transition=o,Tt=i,(Tt&6)===0&&Ii()}}function Vh(){Vr=ho.current,Ut(ho)}function wa(r,i){r.finishedWork=null,r.finishedLanes=0;var o=r.timeoutHandle;if(o!==-1&&(r.timeoutHandle=-1,hx(o)),dn!==null)for(o=dn.return;o!==null;){var h=o;switch(Gd(h),h.tag){case 1:h=h.type.childContextTypes,h!=null&&Ic();break;case 3:lo(),Ut(yr),Ut(Zn),sh();break;case 5:nh(h);break;case 4:lo();break;case 13:Ut(Ht);break;case 19:Ut(Ht);break;case 10:Jd(h.type._context);break;case 22:case 23:Vh()}o=o.return}if(Dn=r,dn=r=Di(r.current,null),$n=Vr=i,xn=0,vl=null,Rh=Qc=va=0,wr=_l=null,ma!==null){for(i=0;i<ma.length;i++)if(o=ma[i],h=o.interleaved,h!==null){o.interleaved=null;var p=h.next,y=o.pending;if(y!==null){var E=y.next;y.next=p,h.next=E}o.pending=h}ma=null}return r}function Og(r,i){do{var o=dn;try{if(Yd(),Mc.current=Bc,Fc){for(var h=qt.memoizedState;h!==null;){var p=h.queue;p!==null&&(p.pending=null),h=h.next}Fc=!1}if(ya=0,jn=wn=qt=null,hl=!1,fl=0,Ph.current=null,o===null||o.return===null){xn=1,vl=i,dn=null;break}e:{var y=r,E=o.return,j=o,F=i;if(i=$n,j.flags|=32768,F!==null&&typeof F=="object"&&typeof F.then=="function"){var te=F,ge=j,ve=ge.tag;if((ge.mode&1)===0&&(ve===0||ve===11||ve===15)){var pe=ge.alternate;pe?(ge.updateQueue=pe.updateQueue,ge.memoizedState=pe.memoizedState,ge.lanes=pe.lanes):(ge.updateQueue=null,ge.memoizedState=null)}var Ve=lg(E);if(Ve!==null){Ve.flags&=-257,cg(Ve,E,j,y,i),Ve.mode&1&&og(y,te,i),i=Ve,F=te;var Fe=i.updateQueue;if(Fe===null){var ze=new Set;ze.add(F),i.updateQueue=ze}else Fe.add(F);break e}else{if((i&1)===0){og(y,te,i),Oh();break e}F=Error(t(426))}}else if(Gt&&j.mode&1){var tn=lg(E);if(tn!==null){(tn.flags&65536)===0&&(tn.flags|=256),cg(tn,E,j,y,i),Kd(co(F,j));break e}}y=F=co(F,j),xn!==4&&(xn=2),_l===null?_l=[y]:_l.push(y),y=E;do{switch(y.tag){case 3:y.flags|=65536,i&=-i,y.lanes|=i;var J=ig(y,F,i);km(y,J);break e;case 1:j=F;var G=y.type,X=y.stateNode;if((y.flags&128)===0&&(typeof G.getDerivedStateFromError=="function"||X!==null&&typeof X.componentDidCatch=="function"&&(Ni===null||!Ni.has(X)))){y.flags|=65536,i&=-i,y.lanes|=i;var Pe=ag(y,j,i);km(y,Pe);break e}}y=y.return}while(y!==null)}Ug(o)}catch(Ge){i=Ge,dn===o&&o!==null&&(dn=o=o.return);continue}break}while(!0)}function Mg(){var r=Kc.current;return Kc.current=Bc,r===null?Bc:r}function Oh(){(xn===0||xn===3||xn===2)&&(xn=4),Dn===null||(va&268435455)===0&&(Qc&268435455)===0||ji(Dn,$n)}function tu(r,i){var o=Tt;Tt|=2;var h=Mg();(Dn!==r||$n!==i)&&(ii=null,wa(r,i));do try{Ox();break}catch(p){Og(r,p)}while(!0);if(Yd(),Tt=o,Kc.current=h,dn!==null)throw Error(t(261));return Dn=null,$n=0,xn}function Ox(){for(;dn!==null;)Fg(dn)}function Mx(){for(;dn!==null&&!Hs();)Fg(dn)}function Fg(r){var i=$g(r.alternate,r,Vr);r.memoizedProps=r.pendingProps,i===null?Ug(r):dn=i,Ph.current=null}function Ug(r){var i=r;do{var o=i.alternate;if(r=i.return,(i.flags&32768)===0){if(o=Nx(o,i,Vr),o!==null){dn=o;return}}else{if(o=Ax(o,i),o!==null){o.flags&=32767,dn=o;return}if(r!==null)r.flags|=32768,r.subtreeFlags=0,r.deletions=null;else{xn=6,dn=null;return}}if(i=i.sibling,i!==null){dn=i;return}dn=i=r}while(i!==null);xn===0&&(xn=5)}function xa(r,i,o){var h=ft,p=qr.transition;try{qr.transition=null,ft=1,Fx(r,i,o,h)}finally{qr.transition=p,ft=h}return null}function Fx(r,i,o,h){do po();while(Ai!==null);if((Tt&6)!==0)throw Error(t(327));o=r.finishedWork;var p=r.finishedLanes;if(o===null)return null;if(r.finishedWork=null,r.finishedLanes=0,o===r.current)throw Error(t(177));r.callbackNode=null,r.callbackPriority=0;var y=o.lanes|o.childLanes;if(bt(r,y),r===Dn&&(dn=Dn=null,$n=0),(o.subtreeFlags&2064)===0&&(o.flags&2064)===0||Jc||(Jc=!0,Wg($,function(){return po(),null})),y=(o.flags&15990)!==0,(o.subtreeFlags&15990)!==0||y){y=qr.transition,qr.transition=null;var E=ft;ft=1;var j=Tt;Tt|=4,Ph.current=null,jx(r,o),Ng(o,r),ix(Od),wi=!!Vd,Od=Vd=null,r.current=o,Dx(o),qs(),Tt=j,ft=E,qr.transition=y}else r.current=o;if(Jc&&(Jc=!1,Ai=r,Xc=p),y=r.pendingLanes,y===0&&(Ni=null),se(o.stateNode),xr(r,ut()),i!==null)for(h=r.onRecoverableError,o=0;o<i.length;o++)p=i[o],h(p.value,{componentStack:p.stack,digest:p.digest});if(Yc)throw Yc=!1,r=Ah,Ah=null,r;return(Xc&1)!==0&&r.tag!==0&&po(),y=r.pendingLanes,(y&1)!==0?r===kh?wl++:(wl=0,kh=r):wl=0,Ii(),null}function po(){if(Ai!==null){var r=Cs(Xc),i=qr.transition,o=ft;try{if(qr.transition=null,ft=16>r?16:r,Ai===null)var h=!1;else{if(r=Ai,Ai=null,Xc=0,(Tt&6)!==0)throw Error(t(331));var p=Tt;for(Tt|=4,Me=r.current;Me!==null;){var y=Me,E=y.child;if((Me.flags&16)!==0){var j=y.deletions;if(j!==null){for(var F=0;F<j.length;F++){var te=j[F];for(Me=te;Me!==null;){var ge=Me;switch(ge.tag){case 0:case 11:case 15:yl(8,ge,y)}var ve=ge.child;if(ve!==null)ve.return=ge,Me=ve;else for(;Me!==null;){ge=Me;var pe=ge.sibling,Ve=ge.return;if(Cg(ge),ge===te){Me=null;break}if(pe!==null){pe.return=Ve,Me=pe;break}Me=Ve}}}var Fe=y.alternate;if(Fe!==null){var ze=Fe.child;if(ze!==null){Fe.child=null;do{var tn=ze.sibling;ze.sibling=null,ze=tn}while(ze!==null)}}Me=y}}if((y.subtreeFlags&2064)!==0&&E!==null)E.return=y,Me=E;else e:for(;Me!==null;){if(y=Me,(y.flags&2048)!==0)switch(y.tag){case 0:case 11:case 15:yl(9,y,y.return)}var J=y.sibling;if(J!==null){J.return=y.return,Me=J;break e}Me=y.return}}var G=r.current;for(Me=G;Me!==null;){E=Me;var X=E.child;if((E.subtreeFlags&2064)!==0&&X!==null)X.return=E,Me=X;else e:for(E=G;Me!==null;){if(j=Me,(j.flags&2048)!==0)try{switch(j.tag){case 0:case 11:case 15:qc(9,j)}}catch(Ge){Jt(j,j.return,Ge)}if(j===E){Me=null;break e}var Pe=j.sibling;if(Pe!==null){Pe.return=j.return,Me=Pe;break e}Me=j.return}}if(Tt=p,Ii(),ie&&typeof ie.onPostCommitFiberRoot=="function")try{ie.onPostCommitFiberRoot(q,r)}catch{}h=!0}return h}finally{ft=o,qr.transition=i}}return!1}function zg(r,i,o){i=co(o,i),i=ig(r,i,1),r=Pi(r,i,1),i=hr(),r!==null&&(os(r,1,i),xr(r,i))}function Jt(r,i,o){if(r.tag===3)zg(r,r,o);else for(;i!==null;){if(i.tag===3){zg(i,r,o);break}else if(i.tag===1){var h=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(Ni===null||!Ni.has(h))){r=co(o,r),r=ag(i,r,1),i=Pi(i,r,1),r=hr(),i!==null&&(os(i,1,r),xr(i,r));break}}i=i.return}}function Ux(r,i,o){var h=r.pingCache;h!==null&&h.delete(i),i=hr(),r.pingedLanes|=r.suspendedLanes&o,Dn===r&&($n&o)===o&&(xn===4||xn===3&&($n&130023424)===$n&&500>ut()-Nh?wa(r,0):Rh|=o),xr(r,i)}function Bg(r,i){i===0&&((r.mode&1)===0?i=1:(i=ke,ke<<=1,(ke&130023424)===0&&(ke=4194304)));var o=hr();r=ni(r,i),r!==null&&(os(r,i,o),xr(r,o))}function zx(r){var i=r.memoizedState,o=0;i!==null&&(o=i.retryLane),Bg(r,o)}function Bx(r,i){var o=0;switch(r.tag){case 13:var h=r.stateNode,p=r.memoizedState;p!==null&&(o=p.retryLane);break;case 19:h=r.stateNode;break;default:throw Error(t(314))}h!==null&&h.delete(i),Bg(r,o)}var $g;$g=function(r,i,o){if(r!==null)if(r.memoizedProps!==i.pendingProps||yr.current)_r=!0;else{if((r.lanes&o)===0&&(i.flags&128)===0)return _r=!1,Rx(r,i,o);_r=(r.flags&131072)!==0}else _r=!1,Gt&&(i.flags&1048576)!==0&&Em(i,Nc,i.index);switch(i.lanes=0,i.tag){case 2:var h=i.type;Gc(r,i),r=i.pendingProps;var p=to(i,Zn.current);oo(i,o),p=oh(null,i,h,r,p,o);var y=lh();return i.flags|=1,typeof p=="object"&&p!==null&&typeof p.render=="function"&&p.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,vr(h)?(y=!0,bc(i)):y=!1,i.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,eh(i),p.updater=$c,i.stateNode=p,p._reactInternals=i,ph(i,h,r,o),i=vh(null,i,h,!0,y,o)):(i.tag=0,Gt&&y&&Wd(i),dr(null,i,p,o),i=i.child),i;case 16:h=i.elementType;e:{switch(Gc(r,i),r=i.pendingProps,p=h._init,h=p(h._payload),i.type=h,p=i.tag=Wx(h),r=hs(h,r),p){case 0:i=yh(null,i,h,r,o);break e;case 1:i=mg(null,i,h,r,o);break e;case 11:i=ug(null,i,h,r,o);break e;case 14:i=dg(null,i,h,hs(h.type,r),o);break e}throw Error(t(306,h,""))}return i;case 0:return h=i.type,p=i.pendingProps,p=i.elementType===h?p:hs(h,p),yh(r,i,h,p,o);case 1:return h=i.type,p=i.pendingProps,p=i.elementType===h?p:hs(h,p),mg(r,i,h,p,o);case 3:e:{if(gg(i),r===null)throw Error(t(387));h=i.pendingProps,y=i.memoizedState,p=y.element,Am(r,i),Vc(i,h,null,o);var E=i.memoizedState;if(h=E.element,y.isDehydrated)if(y={element:h,isDehydrated:!1,cache:E.cache,pendingSuspenseBoundaries:E.pendingSuspenseBoundaries,transitions:E.transitions},i.updateQueue.baseState=y,i.memoizedState=y,i.flags&256){p=co(Error(t(423)),i),i=yg(r,i,h,o,p);break e}else if(h!==p){p=co(Error(t(424)),i),i=yg(r,i,h,o,p);break e}else for(Lr=Ti(i.stateNode.containerInfo.firstChild),Dr=i,Gt=!0,ds=null,o=Rm(i,null,h,o),i.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(so(),h===p){i=si(r,i,o);break e}dr(r,i,h,o)}i=i.child}return i;case 5:return Dm(i),r===null&&qd(i),h=i.type,p=i.pendingProps,y=r!==null?r.memoizedProps:null,E=p.children,Md(h,p)?E=null:y!==null&&Md(h,y)&&(i.flags|=32),pg(r,i),dr(r,i,E,o),i.child;case 6:return r===null&&qd(i),null;case 13:return vg(r,i,o);case 4:return th(i,i.stateNode.containerInfo),h=i.pendingProps,r===null?i.child=io(i,null,h,o):dr(r,i,h,o),i.child;case 11:return h=i.type,p=i.pendingProps,p=i.elementType===h?p:hs(h,p),ug(r,i,h,p,o);case 7:return dr(r,i,i.pendingProps,o),i.child;case 8:return dr(r,i,i.pendingProps.children,o),i.child;case 12:return dr(r,i,i.pendingProps.children,o),i.child;case 10:e:{if(h=i.type._context,p=i.pendingProps,y=i.memoizedProps,E=p.value,Vt(jc,h._currentValue),h._currentValue=E,y!==null)if(us(y.value,E)){if(y.children===p.children&&!yr.current){i=si(r,i,o);break e}}else for(y=i.child,y!==null&&(y.return=i);y!==null;){var j=y.dependencies;if(j!==null){E=y.child;for(var F=j.firstContext;F!==null;){if(F.context===h){if(y.tag===1){F=ri(-1,o&-o),F.tag=2;var te=y.updateQueue;if(te!==null){te=te.shared;var ge=te.pending;ge===null?F.next=F:(F.next=ge.next,ge.next=F),te.pending=F}}y.lanes|=o,F=y.alternate,F!==null&&(F.lanes|=o),Xd(y.return,o,i),j.lanes|=o;break}F=F.next}}else if(y.tag===10)E=y.type===i.type?null:y.child;else if(y.tag===18){if(E=y.return,E===null)throw Error(t(341));E.lanes|=o,j=E.alternate,j!==null&&(j.lanes|=o),Xd(E,o,i),E=y.sibling}else E=y.child;if(E!==null)E.return=y;else for(E=y;E!==null;){if(E===i){E=null;break}if(y=E.sibling,y!==null){y.return=E.return,E=y;break}E=E.return}y=E}dr(r,i,p.children,o),i=i.child}return i;case 9:return p=i.type,h=i.pendingProps.children,oo(i,o),p=Gr(p),h=h(p),i.flags|=1,dr(r,i,h,o),i.child;case 14:return h=i.type,p=hs(h,i.pendingProps),p=hs(h.type,p),dg(r,i,h,p,o);case 15:return hg(r,i,i.type,i.pendingProps,o);case 17:return h=i.type,p=i.pendingProps,p=i.elementType===h?p:hs(h,p),Gc(r,i),i.tag=1,vr(h)?(r=!0,bc(i)):r=!1,oo(i,o),rg(i,h,p),ph(i,h,p,o),vh(null,i,h,!0,r,o);case 19:return wg(r,i,o);case 22:return fg(r,i,o)}throw Error(t(156,i.tag))};function Wg(r,i){return rs(r,i)}function $x(r,i,o,h){this.tag=r,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Kr(r,i,o,h){return new $x(r,i,o,h)}function Mh(r){return r=r.prototype,!(!r||!r.isReactComponent)}function Wx(r){if(typeof r=="function")return Mh(r)?1:0;if(r!=null){if(r=r.$$typeof,r===D)return 11;if(r===$e)return 14}return 2}function Di(r,i){var o=r.alternate;return o===null?(o=Kr(r.tag,i,r.key,r.mode),o.elementType=r.elementType,o.type=r.type,o.stateNode=r.stateNode,o.alternate=r,r.alternate=o):(o.pendingProps=i,o.type=r.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=r.flags&14680064,o.childLanes=r.childLanes,o.lanes=r.lanes,o.child=r.child,o.memoizedProps=r.memoizedProps,o.memoizedState=r.memoizedState,o.updateQueue=r.updateQueue,i=r.dependencies,o.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},o.sibling=r.sibling,o.index=r.index,o.ref=r.ref,o}function nu(r,i,o,h,p,y){var E=2;if(h=r,typeof r=="function")Mh(r)&&(E=1);else if(typeof r=="string")E=5;else e:switch(r){case A:return Ea(o.children,p,y,i);case P:E=8,p|=8;break;case R:return r=Kr(12,o,i,p|2),r.elementType=R,r.lanes=y,r;case b:return r=Kr(13,o,i,p),r.elementType=b,r.lanes=y,r;case he:return r=Kr(19,o,i,p),r.elementType=he,r.lanes=y,r;case He:return ru(o,p,y,i);default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case O:E=10;break e;case B:E=9;break e;case D:E=11;break e;case $e:E=14;break e;case Ae:E=16,h=null;break e}throw Error(t(130,r==null?r:typeof r,""))}return i=Kr(E,o,i,p),i.elementType=r,i.type=h,i.lanes=y,i}function Ea(r,i,o,h){return r=Kr(7,r,h,i),r.lanes=o,r}function ru(r,i,o,h){return r=Kr(22,r,h,i),r.elementType=He,r.lanes=o,r.stateNode={isHidden:!1},r}function Fh(r,i,o){return r=Kr(6,r,null,i),r.lanes=o,r}function Uh(r,i,o){return i=Kr(4,r.children!==null?r.children:[],r.key,i),i.lanes=o,i.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},i}function Gx(r,i,o,h,p){this.tag=i,this.containerInfo=r,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=as(0),this.expirationTimes=as(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=as(0),this.identifierPrefix=h,this.onRecoverableError=p,this.mutableSourceEagerHydrationData=null}function zh(r,i,o,h,p,y,E,j,F){return r=new Gx(r,i,o,j,F),i===1?(i=1,y===!0&&(i|=8)):i=0,y=Kr(3,null,null,i),r.current=y,y.stateNode=r,y.memoizedState={element:h,isDehydrated:o,cache:null,transitions:null,pendingSuspenseBoundaries:null},eh(y),r}function Hx(r,i,o){var h=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Re,key:h==null?null:""+h,children:r,containerInfo:i,implementation:o}}function Gg(r){if(!r)return Ci;r=r._reactInternals;e:{if(Mt(r)!==r||r.tag!==1)throw Error(t(170));var i=r;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(vr(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(t(171))}if(r.tag===1){var o=r.type;if(vr(o))return _m(r,o,i)}return i}function Hg(r,i,o,h,p,y,E,j,F){return r=zh(o,h,!0,r,p,y,E,j,F),r.context=Gg(null),o=r.current,h=hr(),p=ki(o),y=ri(h,p),y.callback=i??null,Pi(o,y,p),r.current.lanes=p,os(r,p,h),xr(r,h),r}function su(r,i,o,h){var p=i.current,y=hr(),E=ki(p);return o=Gg(o),i.context===null?i.context=o:i.pendingContext=o,i=ri(y,E),i.payload={element:r},h=h===void 0?null:h,h!==null&&(i.callback=h),r=Pi(p,i,E),r!==null&&(ms(r,p,E,y),Lc(r,p,E)),E}function iu(r){if(r=r.current,!r.child)return null;switch(r.child.tag){case 5:return r.child.stateNode;default:return r.child.stateNode}}function qg(r,i){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var o=r.retryLane;r.retryLane=o!==0&&o<i?o:i}}function Bh(r,i){qg(r,i),(r=r.alternate)&&qg(r,i)}function qx(){return null}var Kg=typeof reportError=="function"?reportError:function(r){console.error(r)};function $h(r){this._internalRoot=r}au.prototype.render=$h.prototype.render=function(r){var i=this._internalRoot;if(i===null)throw Error(t(409));su(r,i,null,null)},au.prototype.unmount=$h.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var i=r.containerInfo;_a(function(){su(null,r,null,null)}),i[Xs]=null}};function au(r){this._internalRoot=r}au.prototype.unstable_scheduleHydration=function(r){if(r){var i=oe();r={blockedOn:null,target:r,priority:i};for(var o=0;o<Zt.length&&i!==0&&i<Zt[o].priority;o++);Zt.splice(o,0,r),o===0&&zr(r)}};function Wh(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function ou(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11&&(r.nodeType!==8||r.nodeValue!==" react-mount-point-unstable "))}function Qg(){}function Kx(r,i,o,h,p){if(p){if(typeof h=="function"){var y=h;h=function(){var te=iu(E);y.call(te)}}var E=Hg(i,h,r,0,null,!1,!1,"",Qg);return r._reactRootContainer=E,r[Xs]=E.current,sl(r.nodeType===8?r.parentNode:r),_a(),E}for(;p=r.lastChild;)r.removeChild(p);if(typeof h=="function"){var j=h;h=function(){var te=iu(F);j.call(te)}}var F=zh(r,0,!1,null,null,!1,!1,"",Qg);return r._reactRootContainer=F,r[Xs]=F.current,sl(r.nodeType===8?r.parentNode:r),_a(function(){su(i,F,o,h)}),F}function lu(r,i,o,h,p){var y=o._reactRootContainer;if(y){var E=y;if(typeof p=="function"){var j=p;p=function(){var F=iu(E);j.call(F)}}su(i,E,r,p)}else E=Kx(o,i,r,p,h);return iu(E)}T=function(r){switch(r.tag){case 3:var i=r.stateNode;if(i.current.memoizedState.isDehydrated){var o=dt(i.pendingLanes);o!==0&&(Ss(i,o|1),xr(i,ut()),(Tt&6)===0&&(fo=ut()+500,Ii()))}break;case 13:_a(function(){var h=ni(r,1);if(h!==null){var p=hr();ms(h,r,1,p)}}),Bh(r,1)}},V=function(r){if(r.tag===13){var i=ni(r,134217728);if(i!==null){var o=hr();ms(i,r,134217728,o)}Bh(r,134217728)}},H=function(r){if(r.tag===13){var i=ki(r),o=ni(r,i);if(o!==null){var h=hr();ms(o,r,i,h)}Bh(r,i)}},oe=function(){return ft},ye=function(r,i){var o=ft;try{return ft=r,i()}finally{ft=o}},xs=function(r,i,o){switch(i){case"input":if(kt(r,o),i=o.name,o.type==="radio"&&i!=null){for(o=r;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<o.length;i++){var h=o[i];if(h!==r&&h.form===r.form){var p=Cc(h);if(!p)throw Error(t(90));We(h),kt(h,p)}}}break;case"textarea":Xt(r,o);break;case"select":i=o.value,i!=null&&Sn(r,!!o.multiple,i,!1)}},Yn=Lh,$s=_a;var Qx={usingClientEntryPoint:!1,Events:[ol,Za,Cc,bn,Pr,Lh]},xl={findFiberByHostInstance:da,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Yx={bundleType:xl.bundleType,version:xl.version,rendererPackageName:xl.rendererPackageName,rendererConfig:xl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ee.ReactCurrentDispatcher,findHostInstanceByFiber:function(r){return r=Gs(r),r===null?null:r.stateNode},findFiberByHostInstance:xl.findFiberByHostInstance||qx,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var cu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!cu.isDisabled&&cu.supportsFiber)try{q=cu.inject(Yx),ie=cu}catch{}}return Er.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Qx,Er.createPortal=function(r,i){var o=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Wh(i))throw Error(t(200));return Hx(r,i,null,o)},Er.createRoot=function(r,i){if(!Wh(r))throw Error(t(299));var o=!1,h="",p=Kg;return i!=null&&(i.unstable_strictMode===!0&&(o=!0),i.identifierPrefix!==void 0&&(h=i.identifierPrefix),i.onRecoverableError!==void 0&&(p=i.onRecoverableError)),i=zh(r,1,!1,null,null,o,!1,h,p),r[Xs]=i.current,sl(r.nodeType===8?r.parentNode:r),new $h(i)},Er.findDOMNode=function(r){if(r==null)return null;if(r.nodeType===1)return r;var i=r._reactInternals;if(i===void 0)throw typeof r.render=="function"?Error(t(188)):(r=Object.keys(r).join(","),Error(t(268,r)));return r=Gs(i),r=r===null?null:r.stateNode,r},Er.flushSync=function(r){return _a(r)},Er.hydrate=function(r,i,o){if(!ou(i))throw Error(t(200));return lu(null,r,i,!0,o)},Er.hydrateRoot=function(r,i,o){if(!Wh(r))throw Error(t(405));var h=o!=null&&o.hydratedSources||null,p=!1,y="",E=Kg;if(o!=null&&(o.unstable_strictMode===!0&&(p=!0),o.identifierPrefix!==void 0&&(y=o.identifierPrefix),o.onRecoverableError!==void 0&&(E=o.onRecoverableError)),i=Hg(i,null,r,1,o??null,p,!1,y,E),r[Xs]=i.current,sl(r),h)for(r=0;r<h.length;r++)o=h[r],p=o._getVersion,p=p(o._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[o,p]:i.mutableSourceEagerHydrationData.push(o,p);return new au(i)},Er.render=function(r,i,o){if(!ou(i))throw Error(t(200));return lu(null,r,i,!1,o)},Er.unmountComponentAtNode=function(r){if(!ou(r))throw Error(t(40));return r._reactRootContainer?(_a(function(){lu(null,null,r,!1,function(){r._reactRootContainer=null,r[Xs]=null})}),!0):!1},Er.unstable_batchedUpdates=Lh,Er.unstable_renderSubtreeIntoContainer=function(r,i,o,h){if(!ou(o))throw Error(t(200));if(r==null||r._reactInternals===void 0)throw Error(t(38));return lu(r,i,o,!1,h)},Er.version="18.3.1-next-f1338f8080-20240426",Er}var ry;function o_(){if(ry)return qh.exports;ry=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),qh.exports=iE(),qh.exports}var sy;function aE(){if(sy)return uu;sy=1;var n=o_();return uu.createRoot=n.createRoot,uu.hydrateRoot=n.hydrateRoot,uu}var oE=aE();const lE=a_(oE);o_();/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ml(){return Ml=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},Ml.apply(this,arguments)}var Ui;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(Ui||(Ui={}));const iy="popstate";function cE(n){n===void 0&&(n={});function e(s,a){let{pathname:l,search:d,hash:f}=s.location;return df("",{pathname:l,search:d,hash:f},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(s,a){return typeof a=="string"?a:Ru(a)}return dE(e,t,null,n)}function sn(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Bf(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function uE(){return Math.random().toString(36).substr(2,8)}function ay(n,e){return{usr:n.state,key:n.key,idx:e}}function df(n,e,t,s){return t===void 0&&(t=null),Ml({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?Vo(e):e,{state:t,key:e&&e.key||s||uE()})}function Ru(n){let{pathname:e="/",search:t="",hash:s=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),s&&s!=="#"&&(e+=s.charAt(0)==="#"?s:"#"+s),e}function Vo(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let s=n.indexOf("?");s>=0&&(e.search=n.substr(s),n=n.substr(0,s)),n&&(e.pathname=n)}return e}function dE(n,e,t,s){s===void 0&&(s={});let{window:a=document.defaultView,v5Compat:l=!1}=s,d=a.history,f=Ui.Pop,m=null,v=w();v==null&&(v=0,d.replaceState(Ml({},d.state,{idx:v}),""));function w(){return(d.state||{idx:null}).idx}function S(){f=Ui.Pop;let M=w(),ne=M==null?null:M-v;v=M,m&&m({action:f,location:Q.location,delta:ne})}function I(M,ne){f=Ui.Push;let xe=df(Q.location,M,ne);v=w()+1;let we=ay(xe,v),Ee=Q.createHref(xe);try{d.pushState(we,"",Ee)}catch(le){if(le instanceof DOMException&&le.name==="DataCloneError")throw le;a.location.assign(Ee)}l&&m&&m({action:f,location:Q.location,delta:1})}function U(M,ne){f=Ui.Replace;let xe=df(Q.location,M,ne);v=w();let we=ay(xe,v),Ee=Q.createHref(xe);d.replaceState(we,"",Ee),l&&m&&m({action:f,location:Q.location,delta:0})}function Z(M){let ne=a.location.origin!=="null"?a.location.origin:a.location.href,xe=typeof M=="string"?M:Ru(M);return xe=xe.replace(/ $/,"%20"),sn(ne,"No window.location.(origin|href) available to create URL for href: "+xe),new URL(xe,ne)}let Q={get action(){return f},get location(){return n(a,d)},listen(M){if(m)throw new Error("A history only accepts one active listener");return a.addEventListener(iy,S),m=M,()=>{a.removeEventListener(iy,S),m=null}},createHref(M){return e(a,M)},createURL:Z,encodeLocation(M){let ne=Z(M);return{pathname:ne.pathname,search:ne.search,hash:ne.hash}},push:I,replace:U,go(M){return d.go(M)}};return Q}var oy;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(oy||(oy={}));function hE(n,e,t){return t===void 0&&(t="/"),fE(n,e,t)}function fE(n,e,t,s){let a=typeof e=="string"?Vo(e):e,l=$f(a.pathname||"/",t);if(l==null)return null;let d=l_(n);pE(d);let f=null;for(let m=0;f==null&&m<d.length;++m){let v=IE(l);f=TE(d[m],v)}return f}function l_(n,e,t,s){e===void 0&&(e=[]),t===void 0&&(t=[]),s===void 0&&(s="");let a=(l,d,f)=>{let m={relativePath:f===void 0?l.path||"":f,caseSensitive:l.caseSensitive===!0,childrenIndex:d,route:l};m.relativePath.startsWith("/")&&(sn(m.relativePath.startsWith(s),'Absolute route path "'+m.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),m.relativePath=m.relativePath.slice(s.length));let v=$i([s,m.relativePath]),w=t.concat(m);l.children&&l.children.length>0&&(sn(l.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+v+'".')),l_(l.children,e,w,v)),!(l.path==null&&!l.index)&&e.push({path:v,score:xE(v,l.index),routesMeta:w})};return n.forEach((l,d)=>{var f;if(l.path===""||!((f=l.path)!=null&&f.includes("?")))a(l,d);else for(let m of c_(l.path))a(l,d,m)}),e}function c_(n){let e=n.split("/");if(e.length===0)return[];let[t,...s]=e,a=t.endsWith("?"),l=t.replace(/\?$/,"");if(s.length===0)return a?[l,""]:[l];let d=c_(s.join("/")),f=[];return f.push(...d.map(m=>m===""?l:[l,m].join("/"))),a&&f.push(...d),f.map(m=>n.startsWith("/")&&m===""?"/":m)}function pE(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:EE(e.routesMeta.map(s=>s.childrenIndex),t.routesMeta.map(s=>s.childrenIndex)))}const mE=/^:[\w-]+$/,gE=3,yE=2,vE=1,_E=10,wE=-2,ly=n=>n==="*";function xE(n,e){let t=n.split("/"),s=t.length;return t.some(ly)&&(s+=wE),e&&(s+=yE),t.filter(a=>!ly(a)).reduce((a,l)=>a+(mE.test(l)?gE:l===""?vE:_E),s)}function EE(n,e){return n.length===e.length&&n.slice(0,-1).every((s,a)=>s===e[a])?n[n.length-1]-e[e.length-1]:0}function TE(n,e,t){let{routesMeta:s}=n,a={},l="/",d=[];for(let f=0;f<s.length;++f){let m=s[f],v=f===s.length-1,w=l==="/"?e:e.slice(l.length)||"/",S=SE({path:m.relativePath,caseSensitive:m.caseSensitive,end:v},w),I=m.route;if(!S)return null;Object.assign(a,S.params),d.push({params:a,pathname:$i([l,S.pathname]),pathnameBase:AE($i([l,S.pathnameBase])),route:I}),S.pathnameBase!=="/"&&(l=$i([l,S.pathnameBase]))}return d}function SE(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,s]=CE(n.path,n.caseSensitive,n.end),a=e.match(t);if(!a)return null;let l=a[0],d=l.replace(/(.)\/+$/,"$1"),f=a.slice(1);return{params:s.reduce((v,w,S)=>{let{paramName:I,isOptional:U}=w;if(I==="*"){let Q=f[S]||"";d=l.slice(0,l.length-Q.length).replace(/(.)\/+$/,"$1")}const Z=f[S];return U&&!Z?v[I]=void 0:v[I]=(Z||"").replace(/%2F/g,"/"),v},{}),pathname:l,pathnameBase:d,pattern:n}}function CE(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),Bf(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let s=[],a="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,f,m)=>(s.push({paramName:f,isOptional:m!=null}),m?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(s.push({paramName:"*"}),a+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?a+="\\/*$":n!==""&&n!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),s]}function IE(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Bf(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function $f(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,s=n.charAt(t);return s&&s!=="/"?null:n.slice(t)||"/"}const bE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,PE=n=>bE.test(n);function RE(n,e){e===void 0&&(e="/");let{pathname:t,search:s="",hash:a=""}=typeof n=="string"?Vo(n):n,l;if(t)if(PE(t))l=t;else{if(t.includes("//")){let d=t;t=t.replace(/\/\/+/g,"/"),Bf(!1,"Pathnames cannot have embedded double slashes - normalizing "+(d+" -> "+t))}t.startsWith("/")?l=cy(t.substring(1),"/"):l=cy(t,e)}else l=e;return{pathname:l,search:kE(s),hash:jE(a)}}function cy(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(a=>{a===".."?t.length>1&&t.pop():a!=="."&&t.push(a)}),t.length>1?t.join("/"):"/"}function Yh(n,e,t,s){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function NE(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Wf(n,e){let t=NE(n);return e?t.map((s,a)=>a===t.length-1?s.pathname:s.pathnameBase):t.map(s=>s.pathnameBase)}function Gf(n,e,t,s){s===void 0&&(s=!1);let a;typeof n=="string"?a=Vo(n):(a=Ml({},n),sn(!a.pathname||!a.pathname.includes("?"),Yh("?","pathname","search",a)),sn(!a.pathname||!a.pathname.includes("#"),Yh("#","pathname","hash",a)),sn(!a.search||!a.search.includes("#"),Yh("#","search","hash",a)));let l=n===""||a.pathname==="",d=l?"/":a.pathname,f;if(d==null)f=t;else{let S=e.length-1;if(!s&&d.startsWith("..")){let I=d.split("/");for(;I[0]==="..";)I.shift(),S-=1;a.pathname=I.join("/")}f=S>=0?e[S]:"/"}let m=RE(a,f),v=d&&d!=="/"&&d.endsWith("/"),w=(l||d===".")&&t.endsWith("/");return!m.pathname.endsWith("/")&&(v||w)&&(m.pathname+="/"),m}const $i=n=>n.join("/").replace(/\/\/+/g,"/"),AE=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),kE=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,jE=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function DE(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const u_=["post","put","patch","delete"];new Set(u_);const LE=["get",...u_];new Set(LE);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Fl(){return Fl=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},Fl.apply(this,arguments)}const Hf=k.createContext(null),VE=k.createContext(null),na=k.createContext(null),Yu=k.createContext(null),ra=k.createContext({outlet:null,matches:[],isDataRoute:!1}),d_=k.createContext(null);function OE(n,e){let{relative:t}=e===void 0?{}:e;Oo()||sn(!1);let{basename:s,navigator:a}=k.useContext(na),{hash:l,pathname:d,search:f}=f_(n,{relative:t}),m=d;return s!=="/"&&(m=d==="/"?s:$i([s,d])),a.createHref({pathname:m,search:f,hash:l})}function Oo(){return k.useContext(Yu)!=null}function Yl(){return Oo()||sn(!1),k.useContext(Yu).location}function h_(n){k.useContext(na).static||k.useLayoutEffect(n)}function Ju(){let{isDataRoute:n}=k.useContext(ra);return n?YE():ME()}function ME(){Oo()||sn(!1);let n=k.useContext(Hf),{basename:e,future:t,navigator:s}=k.useContext(na),{matches:a}=k.useContext(ra),{pathname:l}=Yl(),d=JSON.stringify(Wf(a,t.v7_relativeSplatPath)),f=k.useRef(!1);return h_(()=>{f.current=!0}),k.useCallback(function(v,w){if(w===void 0&&(w={}),!f.current)return;if(typeof v=="number"){s.go(v);return}let S=Gf(v,JSON.parse(d),l,w.relative==="path");n==null&&e!=="/"&&(S.pathname=S.pathname==="/"?e:$i([e,S.pathname])),(w.replace?s.replace:s.push)(S,w.state,w)},[e,s,d,l,n])}function f_(n,e){let{relative:t}=e===void 0?{}:e,{future:s}=k.useContext(na),{matches:a}=k.useContext(ra),{pathname:l}=Yl(),d=JSON.stringify(Wf(a,s.v7_relativeSplatPath));return k.useMemo(()=>Gf(n,JSON.parse(d),l,t==="path"),[n,d,l,t])}function FE(n,e){return UE(n,e)}function UE(n,e,t,s){Oo()||sn(!1);let{navigator:a}=k.useContext(na),{matches:l}=k.useContext(ra),d=l[l.length-1],f=d?d.params:{};d&&d.pathname;let m=d?d.pathnameBase:"/";d&&d.route;let v=Yl(),w;if(e){var S;let M=typeof e=="string"?Vo(e):e;m==="/"||(S=M.pathname)!=null&&S.startsWith(m)||sn(!1),w=M}else w=v;let I=w.pathname||"/",U=I;if(m!=="/"){let M=m.replace(/^\//,"").split("/");U="/"+I.replace(/^\//,"").split("/").slice(M.length).join("/")}let Z=hE(n,{pathname:U}),Q=GE(Z&&Z.map(M=>Object.assign({},M,{params:Object.assign({},f,M.params),pathname:$i([m,a.encodeLocation?a.encodeLocation(M.pathname).pathname:M.pathname]),pathnameBase:M.pathnameBase==="/"?m:$i([m,a.encodeLocation?a.encodeLocation(M.pathnameBase).pathname:M.pathnameBase])})),l,t,s);return e&&Q?k.createElement(Yu.Provider,{value:{location:Fl({pathname:"/",search:"",hash:"",state:null,key:"default"},w),navigationType:Ui.Pop}},Q):Q}function zE(){let n=QE(),e=DE(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return k.createElement(k.Fragment,null,k.createElement("h2",null,"Unexpected Application Error!"),k.createElement("h3",{style:{fontStyle:"italic"}},e),t?k.createElement("pre",{style:a},t):null,null)}const BE=k.createElement(zE,null);class $E extends k.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?k.createElement(ra.Provider,{value:this.props.routeContext},k.createElement(d_.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function WE(n){let{routeContext:e,match:t,children:s}=n,a=k.useContext(Hf);return a&&a.static&&a.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=t.route.id),k.createElement(ra.Provider,{value:e},s)}function GE(n,e,t,s){var a;if(e===void 0&&(e=[]),t===void 0&&(t=null),s===void 0&&(s=null),n==null){var l;if(!t)return null;if(t.errors)n=t.matches;else if((l=s)!=null&&l.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let d=n,f=(a=t)==null?void 0:a.errors;if(f!=null){let w=d.findIndex(S=>S.route.id&&(f==null?void 0:f[S.route.id])!==void 0);w>=0||sn(!1),d=d.slice(0,Math.min(d.length,w+1))}let m=!1,v=-1;if(t&&s&&s.v7_partialHydration)for(let w=0;w<d.length;w++){let S=d[w];if((S.route.HydrateFallback||S.route.hydrateFallbackElement)&&(v=w),S.route.id){let{loaderData:I,errors:U}=t,Z=S.route.loader&&I[S.route.id]===void 0&&(!U||U[S.route.id]===void 0);if(S.route.lazy||Z){m=!0,v>=0?d=d.slice(0,v+1):d=[d[0]];break}}}return d.reduceRight((w,S,I)=>{let U,Z=!1,Q=null,M=null;t&&(U=f&&S.route.id?f[S.route.id]:void 0,Q=S.route.errorElement||BE,m&&(v<0&&I===0?(JE("route-fallback"),Z=!0,M=null):v===I&&(Z=!0,M=S.route.hydrateFallbackElement||null)));let ne=e.concat(d.slice(0,I+1)),xe=()=>{let we;return U?we=Q:Z?we=M:S.route.Component?we=k.createElement(S.route.Component,null):S.route.element?we=S.route.element:we=w,k.createElement(WE,{match:S,routeContext:{outlet:w,matches:ne,isDataRoute:t!=null},children:we})};return t&&(S.route.ErrorBoundary||S.route.errorElement||I===0)?k.createElement($E,{location:t.location,revalidation:t.revalidation,component:Q,error:U,children:xe(),routeContext:{outlet:null,matches:ne,isDataRoute:!0}}):xe()},null)}var p_=(function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n})(p_||{}),m_=(function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n})(m_||{});function HE(n){let e=k.useContext(Hf);return e||sn(!1),e}function qE(n){let e=k.useContext(VE);return e||sn(!1),e}function KE(n){let e=k.useContext(ra);return e||sn(!1),e}function g_(n){let e=KE(),t=e.matches[e.matches.length-1];return t.route.id||sn(!1),t.route.id}function QE(){var n;let e=k.useContext(d_),t=qE(),s=g_();return e!==void 0?e:(n=t.errors)==null?void 0:n[s]}function YE(){let{router:n}=HE(p_.UseNavigateStable),e=g_(m_.UseNavigateStable),t=k.useRef(!1);return h_(()=>{t.current=!0}),k.useCallback(function(a,l){l===void 0&&(l={}),t.current&&(typeof a=="number"?n.navigate(a):n.navigate(a,Fl({fromRouteId:e},l)))},[n,e])}const uy={};function JE(n,e,t){uy[n]||(uy[n]=!0)}function XE(n,e){n==null||n.v7_startTransition,n==null||n.v7_relativeSplatPath}function ZE(n){let{to:e,replace:t,state:s,relative:a}=n;Oo()||sn(!1);let{future:l,static:d}=k.useContext(na),{matches:f}=k.useContext(ra),{pathname:m}=Yl(),v=Ju(),w=Gf(e,Wf(f,l.v7_relativeSplatPath),m,a==="path"),S=JSON.stringify(w);return k.useEffect(()=>v(JSON.parse(S),{replace:t,state:s,relative:a}),[v,S,a,t,s]),null}function gs(n){sn(!1)}function eT(n){let{basename:e="/",children:t=null,location:s,navigationType:a=Ui.Pop,navigator:l,static:d=!1,future:f}=n;Oo()&&sn(!1);let m=e.replace(/^\/*/,"/"),v=k.useMemo(()=>({basename:m,navigator:l,static:d,future:Fl({v7_relativeSplatPath:!1},f)}),[m,f,l,d]);typeof s=="string"&&(s=Vo(s));let{pathname:w="/",search:S="",hash:I="",state:U=null,key:Z="default"}=s,Q=k.useMemo(()=>{let M=$f(w,m);return M==null?null:{location:{pathname:M,search:S,hash:I,state:U,key:Z},navigationType:a}},[m,w,S,I,U,Z,a]);return Q==null?null:k.createElement(na.Provider,{value:v},k.createElement(Yu.Provider,{children:t,value:Q}))}function tT(n){let{children:e,location:t}=n;return FE(hf(e),t)}new Promise(()=>{});function hf(n,e){e===void 0&&(e=[]);let t=[];return k.Children.forEach(n,(s,a)=>{if(!k.isValidElement(s))return;let l=[...e,a];if(s.type===k.Fragment){t.push.apply(t,hf(s.props.children,l));return}s.type!==gs&&sn(!1),!s.props.index||!s.props.children||sn(!1);let d={id:s.props.id||l.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(d.children=hf(s.props.children,l)),t.push(d)}),t}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ff(){return ff=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},ff.apply(this,arguments)}function nT(n,e){if(n==null)return{};var t={},s=Object.keys(n),a,l;for(l=0;l<s.length;l++)a=s[l],!(e.indexOf(a)>=0)&&(t[a]=n[a]);return t}function rT(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function sT(n,e){return n.button===0&&(!e||e==="_self")&&!rT(n)}const iT=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],aT="6";try{window.__reactRouterVersion=aT}catch{}const oT="startTransition",dy=nE[oT];function lT(n){let{basename:e,children:t,future:s,window:a}=n,l=k.useRef();l.current==null&&(l.current=cE({window:a,v5Compat:!0}));let d=l.current,[f,m]=k.useState({action:d.action,location:d.location}),{v7_startTransition:v}=s||{},w=k.useCallback(S=>{v&&dy?dy(()=>m(S)):m(S)},[m,v]);return k.useLayoutEffect(()=>d.listen(w),[d,w]),k.useEffect(()=>XE(s),[s]),k.createElement(eT,{basename:e,children:t,location:f.location,navigationType:f.action,navigator:d,future:s})}const cT=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",uT=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ta=k.forwardRef(function(e,t){let{onClick:s,relative:a,reloadDocument:l,replace:d,state:f,target:m,to:v,preventScrollReset:w,viewTransition:S}=e,I=nT(e,iT),{basename:U}=k.useContext(na),Z,Q=!1;if(typeof v=="string"&&uT.test(v)&&(Z=v,cT))try{let we=new URL(window.location.href),Ee=v.startsWith("//")?new URL(we.protocol+v):new URL(v),le=$f(Ee.pathname,U);Ee.origin===we.origin&&le!=null?v=le+Ee.search+Ee.hash:Q=!0}catch{}let M=OE(v,{relative:a}),ne=dT(v,{replace:d,state:f,target:m,preventScrollReset:w,relative:a,viewTransition:S});function xe(we){s&&s(we),we.defaultPrevented||ne(we)}return k.createElement("a",ff({},I,{href:Z||M,onClick:Q||l?s:xe,ref:t,target:m}))});var hy;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(hy||(hy={}));var fy;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(fy||(fy={}));function dT(n,e){let{target:t,replace:s,state:a,preventScrollReset:l,relative:d,viewTransition:f}=e===void 0?{}:e,m=Ju(),v=Yl(),w=f_(n,{relative:d});return k.useCallback(S=>{if(sT(S,t)){S.preventDefault();let I=s!==void 0?s:Ru(v)===Ru(w);m(n,{replace:I,state:a,preventScrollReset:l,relative:d,viewTransition:f})}},[v,m,w,s,a,t,n,l,d,f])}const hT=()=>{};var py={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y_=function(n){const e=[];let t=0;for(let s=0;s<n.length;s++){let a=n.charCodeAt(s);a<128?e[t++]=a:a<2048?(e[t++]=a>>6|192,e[t++]=a&63|128):(a&64512)===55296&&s+1<n.length&&(n.charCodeAt(s+1)&64512)===56320?(a=65536+((a&1023)<<10)+(n.charCodeAt(++s)&1023),e[t++]=a>>18|240,e[t++]=a>>12&63|128,e[t++]=a>>6&63|128,e[t++]=a&63|128):(e[t++]=a>>12|224,e[t++]=a>>6&63|128,e[t++]=a&63|128)}return e},fT=function(n){const e=[];let t=0,s=0;for(;t<n.length;){const a=n[t++];if(a<128)e[s++]=String.fromCharCode(a);else if(a>191&&a<224){const l=n[t++];e[s++]=String.fromCharCode((a&31)<<6|l&63)}else if(a>239&&a<365){const l=n[t++],d=n[t++],f=n[t++],m=((a&7)<<18|(l&63)<<12|(d&63)<<6|f&63)-65536;e[s++]=String.fromCharCode(55296+(m>>10)),e[s++]=String.fromCharCode(56320+(m&1023))}else{const l=n[t++],d=n[t++];e[s++]=String.fromCharCode((a&15)<<12|(l&63)<<6|d&63)}}return e.join("")},v_={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let a=0;a<n.length;a+=3){const l=n[a],d=a+1<n.length,f=d?n[a+1]:0,m=a+2<n.length,v=m?n[a+2]:0,w=l>>2,S=(l&3)<<4|f>>4;let I=(f&15)<<2|v>>6,U=v&63;m||(U=64,d||(I=64)),s.push(t[w],t[S],t[I],t[U])}return s.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(y_(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):fT(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let a=0;a<n.length;){const l=t[n.charAt(a++)],f=a<n.length?t[n.charAt(a)]:0;++a;const v=a<n.length?t[n.charAt(a)]:64;++a;const S=a<n.length?t[n.charAt(a)]:64;if(++a,l==null||f==null||v==null||S==null)throw new pT;const I=l<<2|f>>4;if(s.push(I),v!==64){const U=f<<4&240|v>>2;if(s.push(U),S!==64){const Z=v<<6&192|S;s.push(Z)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class pT extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const mT=function(n){const e=y_(n);return v_.encodeByteArray(e,!0)},Nu=function(n){return mT(n).replace(/\./g,"")},__=function(n){try{return v_.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gT(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yT=()=>gT().__FIREBASE_DEFAULTS__,vT=()=>{if(typeof process>"u"||typeof py>"u")return;const n=py.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},_T=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&__(n[1]);return e&&JSON.parse(e)},Xu=()=>{try{return hT()||yT()||vT()||_T()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},w_=n=>{var e,t;return(t=(e=Xu())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},wT=n=>{const e=w_(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),s]:[e.substring(0,t),s]},x_=()=>{var n;return(n=Xu())===null||n===void 0?void 0:n.config},E_=n=>{var e;return(e=Xu())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xT{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,s)=>{t?this.reject(t):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,s))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mo(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function T_(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ET(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},s=e||"demo-project",a=n.iat||0,l=n.sub||n.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d=Object.assign({iss:`https://securetoken.google.com/${s}`,aud:s,iat:a,exp:a+3600,auth_time:a,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Nu(JSON.stringify(t)),Nu(JSON.stringify(d)),""].join(".")}const Al={};function TT(){const n={prod:[],emulator:[]};for(const e of Object.keys(Al))Al[e]?n.emulator.push(e):n.prod.push(e);return n}function ST(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let my=!1;function S_(n,e){if(typeof window>"u"||typeof document>"u"||!Mo(window.location.host)||Al[n]===e||Al[n]||my)return;Al[n]=e;function t(I){return`__firebase__banner__${I}`}const s="__firebase__banner",l=TT().prod.length>0;function d(){const I=document.getElementById(s);I&&I.remove()}function f(I){I.style.display="flex",I.style.background="#7faaf0",I.style.position="fixed",I.style.bottom="5px",I.style.left="5px",I.style.padding=".5em",I.style.borderRadius="5px",I.style.alignItems="center"}function m(I,U){I.setAttribute("width","24"),I.setAttribute("id",U),I.setAttribute("height","24"),I.setAttribute("viewBox","0 0 24 24"),I.setAttribute("fill","none"),I.style.marginLeft="-6px"}function v(){const I=document.createElement("span");return I.style.cursor="pointer",I.style.marginLeft="16px",I.style.fontSize="24px",I.innerHTML=" &times;",I.onclick=()=>{my=!0,d()},I}function w(I,U){I.setAttribute("id",U),I.innerText="Learn more",I.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",I.setAttribute("target","__blank"),I.style.paddingLeft="5px",I.style.textDecoration="underline"}function S(){const I=ST(s),U=t("text"),Z=document.getElementById(U)||document.createElement("span"),Q=t("learnmore"),M=document.getElementById(Q)||document.createElement("a"),ne=t("preprendIcon"),xe=document.getElementById(ne)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(I.created){const we=I.element;f(we),w(M,Q);const Ee=v();m(xe,ne),we.append(xe,Z,M,Ee),document.body.appendChild(we)}l?(Z.innerText="Preview backend disconnected.",xe.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(xe.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,Z.innerText="Preview backend running in this workspace."),Z.setAttribute("id",U)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",S):S()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function or(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function CT(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(or())}function IT(){var n;const e=(n=Xu())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function bT(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function PT(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function RT(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function NT(){const n=or();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function AT(){return!IT()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function kT(){try{return typeof indexedDB=="object"}catch{return!1}}function jT(){return new Promise((n,e)=>{try{let t=!0;const s="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(s);a.onsuccess=()=>{a.result.close(),t||self.indexedDB.deleteDatabase(s),n(!0)},a.onupgradeneeded=()=>{t=!1},a.onerror=()=>{var l;e(((l=a.error)===null||l===void 0?void 0:l.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DT="FirebaseError";class _i extends Error{constructor(e,t,s){super(t),this.code=e,this.customData=s,this.name=DT,Object.setPrototypeOf(this,_i.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Jl.prototype.create)}}class Jl{constructor(e,t,s){this.service=e,this.serviceName=t,this.errors=s}create(e,...t){const s=t[0]||{},a=`${this.service}/${e}`,l=this.errors[e],d=l?LT(l,s):"Error",f=`${this.serviceName}: ${d} (${a}).`;return new _i(a,f,s)}}function LT(n,e){return n.replace(VT,(t,s)=>{const a=e[s];return a!=null?String(a):`<${s}?>`})}const VT=/\{\$([^}]+)}/g;function OT(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Na(n,e){if(n===e)return!0;const t=Object.keys(n),s=Object.keys(e);for(const a of t){if(!s.includes(a))return!1;const l=n[a],d=e[a];if(gy(l)&&gy(d)){if(!Na(l,d))return!1}else if(l!==d)return!1}for(const a of s)if(!t.includes(a))return!1;return!0}function gy(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xl(n){const e=[];for(const[t,s]of Object.entries(n))Array.isArray(s)?s.forEach(a=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function Cl(n){const e={};return n.replace(/^\?/,"").split("&").forEach(s=>{if(s){const[a,l]=s.split("=");e[decodeURIComponent(a)]=decodeURIComponent(l)}}),e}function Il(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function MT(n,e){const t=new FT(n,e);return t.subscribe.bind(t)}class FT{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,s){let a;if(e===void 0&&t===void 0&&s===void 0)throw new Error("Missing Observer.");UT(e,["next","error","complete"])?a=e:a={next:e,error:t,complete:s},a.next===void 0&&(a.next=Jh),a.error===void 0&&(a.error=Jh),a.complete===void 0&&(a.complete=Jh);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function UT(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Jh(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function an(n){return n&&n._delegate?n._delegate:n}class Aa{constructor(e,t,s){this.name=e,this.instanceFactory=t,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sa="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zT{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const s=new xT;if(this.instancesDeferred.set(t,s),this.isInitialized(t)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:t});a&&s.resolve(a)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const s=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),a=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(s)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:s})}catch(l){if(a)return null;throw l}else{if(a)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if($T(e))try{this.getOrInitializeService({instanceIdentifier:Sa})}catch{}for(const[t,s]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(t);try{const l=this.getOrInitializeService({instanceIdentifier:a});s.resolve(l)}catch{}}}}clearInstance(e=Sa){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Sa){return this.instances.has(e)}getOptions(e=Sa){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:s,options:t});for(const[l,d]of this.instancesDeferred.entries()){const f=this.normalizeInstanceIdentifier(l);s===f&&d.resolve(a)}return a}onInit(e,t){var s;const a=this.normalizeInstanceIdentifier(t),l=(s=this.onInitCallbacks.get(a))!==null&&s!==void 0?s:new Set;l.add(e),this.onInitCallbacks.set(a,l);const d=this.instances.get(a);return d&&e(d,a),()=>{l.delete(e)}}invokeOnInitCallbacks(e,t){const s=this.onInitCallbacks.get(t);if(s)for(const a of s)try{a(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:BT(e),options:t}),this.instances.set(e,s),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=Sa){return this.component?this.component.multipleInstances?e:Sa:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function BT(n){return n===Sa?void 0:n}function $T(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WT{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new zT(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var gt;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(gt||(gt={}));const GT={debug:gt.DEBUG,verbose:gt.VERBOSE,info:gt.INFO,warn:gt.WARN,error:gt.ERROR,silent:gt.SILENT},HT=gt.INFO,qT={[gt.DEBUG]:"log",[gt.VERBOSE]:"log",[gt.INFO]:"info",[gt.WARN]:"warn",[gt.ERROR]:"error"},KT=(n,e,...t)=>{if(e<n.logLevel)return;const s=new Date().toISOString(),a=qT[e];if(a)console[a](`[${s}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class qf{constructor(e){this.name=e,this._logLevel=HT,this._logHandler=KT,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in gt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?GT[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,gt.DEBUG,...e),this._logHandler(this,gt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,gt.VERBOSE,...e),this._logHandler(this,gt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,gt.INFO,...e),this._logHandler(this,gt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,gt.WARN,...e),this._logHandler(this,gt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,gt.ERROR,...e),this._logHandler(this,gt.ERROR,...e)}}const QT=(n,e)=>e.some(t=>n instanceof t);let yy,vy;function YT(){return yy||(yy=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function JT(){return vy||(vy=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const C_=new WeakMap,pf=new WeakMap,I_=new WeakMap,Xh=new WeakMap,Kf=new WeakMap;function XT(n){const e=new Promise((t,s)=>{const a=()=>{n.removeEventListener("success",l),n.removeEventListener("error",d)},l=()=>{t(Wi(n.result)),a()},d=()=>{s(n.error),a()};n.addEventListener("success",l),n.addEventListener("error",d)});return e.then(t=>{t instanceof IDBCursor&&C_.set(t,n)}).catch(()=>{}),Kf.set(e,n),e}function ZT(n){if(pf.has(n))return;const e=new Promise((t,s)=>{const a=()=>{n.removeEventListener("complete",l),n.removeEventListener("error",d),n.removeEventListener("abort",d)},l=()=>{t(),a()},d=()=>{s(n.error||new DOMException("AbortError","AbortError")),a()};n.addEventListener("complete",l),n.addEventListener("error",d),n.addEventListener("abort",d)});pf.set(n,e)}let mf={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return pf.get(n);if(e==="objectStoreNames")return n.objectStoreNames||I_.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Wi(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function eS(n){mf=n(mf)}function tS(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const s=n.call(Zh(this),e,...t);return I_.set(s,e.sort?e.sort():[e]),Wi(s)}:JT().includes(n)?function(...e){return n.apply(Zh(this),e),Wi(C_.get(this))}:function(...e){return Wi(n.apply(Zh(this),e))}}function nS(n){return typeof n=="function"?tS(n):(n instanceof IDBTransaction&&ZT(n),QT(n,YT())?new Proxy(n,mf):n)}function Wi(n){if(n instanceof IDBRequest)return XT(n);if(Xh.has(n))return Xh.get(n);const e=nS(n);return e!==n&&(Xh.set(n,e),Kf.set(e,n)),e}const Zh=n=>Kf.get(n);function rS(n,e,{blocked:t,upgrade:s,blocking:a,terminated:l}={}){const d=indexedDB.open(n,e),f=Wi(d);return s&&d.addEventListener("upgradeneeded",m=>{s(Wi(d.result),m.oldVersion,m.newVersion,Wi(d.transaction),m)}),t&&d.addEventListener("blocked",m=>t(m.oldVersion,m.newVersion,m)),f.then(m=>{l&&m.addEventListener("close",()=>l()),a&&m.addEventListener("versionchange",v=>a(v.oldVersion,v.newVersion,v))}).catch(()=>{}),f}const sS=["get","getKey","getAll","getAllKeys","count"],iS=["put","add","delete","clear"],ef=new Map;function _y(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(ef.get(e))return ef.get(e);const t=e.replace(/FromIndex$/,""),s=e!==t,a=iS.includes(t);if(!(t in(s?IDBIndex:IDBObjectStore).prototype)||!(a||sS.includes(t)))return;const l=async function(d,...f){const m=this.transaction(d,a?"readwrite":"readonly");let v=m.store;return s&&(v=v.index(f.shift())),(await Promise.all([v[t](...f),a&&m.done]))[0]};return ef.set(e,l),l}eS(n=>({...n,get:(e,t,s)=>_y(e,t)||n.get(e,t,s),has:(e,t)=>!!_y(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aS{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(oS(t)){const s=t.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(t=>t).join(" ")}}function oS(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const gf="@firebase/app",wy="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hi=new qf("@firebase/app"),lS="@firebase/app-compat",cS="@firebase/analytics-compat",uS="@firebase/analytics",dS="@firebase/app-check-compat",hS="@firebase/app-check",fS="@firebase/auth",pS="@firebase/auth-compat",mS="@firebase/database",gS="@firebase/data-connect",yS="@firebase/database-compat",vS="@firebase/functions",_S="@firebase/functions-compat",wS="@firebase/installations",xS="@firebase/installations-compat",ES="@firebase/messaging",TS="@firebase/messaging-compat",SS="@firebase/performance",CS="@firebase/performance-compat",IS="@firebase/remote-config",bS="@firebase/remote-config-compat",PS="@firebase/storage",RS="@firebase/storage-compat",NS="@firebase/firestore",AS="@firebase/ai",kS="@firebase/firestore-compat",jS="firebase",DS="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yf="[DEFAULT]",LS={[gf]:"fire-core",[lS]:"fire-core-compat",[uS]:"fire-analytics",[cS]:"fire-analytics-compat",[hS]:"fire-app-check",[dS]:"fire-app-check-compat",[fS]:"fire-auth",[pS]:"fire-auth-compat",[mS]:"fire-rtdb",[gS]:"fire-data-connect",[yS]:"fire-rtdb-compat",[vS]:"fire-fn",[_S]:"fire-fn-compat",[wS]:"fire-iid",[xS]:"fire-iid-compat",[ES]:"fire-fcm",[TS]:"fire-fcm-compat",[SS]:"fire-perf",[CS]:"fire-perf-compat",[IS]:"fire-rc",[bS]:"fire-rc-compat",[PS]:"fire-gcs",[RS]:"fire-gcs-compat",[NS]:"fire-fst",[kS]:"fire-fst-compat",[AS]:"fire-vertex","fire-js":"fire-js",[jS]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Au=new Map,VS=new Map,vf=new Map;function xy(n,e){try{n.container.addComponent(e)}catch(t){hi.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Ro(n){const e=n.name;if(vf.has(e))return hi.debug(`There were multiple attempts to register component ${e}.`),!1;vf.set(e,n);for(const t of Au.values())xy(t,n);for(const t of VS.values())xy(t,n);return!0}function Qf(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Or(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OS={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Gi=new Jl("app","Firebase",OS);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MS{constructor(e,t,s){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new Aa("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Gi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fo=DS;function b_(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const s=Object.assign({name:yf,automaticDataCollectionEnabled:!0},e),a=s.name;if(typeof a!="string"||!a)throw Gi.create("bad-app-name",{appName:String(a)});if(t||(t=x_()),!t)throw Gi.create("no-options");const l=Au.get(a);if(l){if(Na(t,l.options)&&Na(s,l.config))return l;throw Gi.create("duplicate-app",{appName:a})}const d=new WT(a);for(const m of vf.values())d.addComponent(m);const f=new MS(t,s,d);return Au.set(a,f),f}function P_(n=yf){const e=Au.get(n);if(!e&&n===yf&&x_())return b_();if(!e)throw Gi.create("no-app",{appName:n});return e}function Hi(n,e,t){var s;let a=(s=LS[n])!==null&&s!==void 0?s:n;t&&(a+=`-${t}`);const l=a.match(/\s|\//),d=e.match(/\s|\//);if(l||d){const f=[`Unable to register library "${a}" with version "${e}":`];l&&f.push(`library name "${a}" contains illegal characters (whitespace or "/")`),l&&d&&f.push("and"),d&&f.push(`version name "${e}" contains illegal characters (whitespace or "/")`),hi.warn(f.join(" "));return}Ro(new Aa(`${a}-version`,()=>({library:a,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FS="firebase-heartbeat-database",US=1,Ul="firebase-heartbeat-store";let tf=null;function R_(){return tf||(tf=rS(FS,US,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Ul)}catch(t){console.warn(t)}}}}).catch(n=>{throw Gi.create("idb-open",{originalErrorMessage:n.message})})),tf}async function zS(n){try{const t=(await R_()).transaction(Ul),s=await t.objectStore(Ul).get(N_(n));return await t.done,s}catch(e){if(e instanceof _i)hi.warn(e.message);else{const t=Gi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});hi.warn(t.message)}}}async function Ey(n,e){try{const s=(await R_()).transaction(Ul,"readwrite");await s.objectStore(Ul).put(e,N_(n)),await s.done}catch(t){if(t instanceof _i)hi.warn(t.message);else{const s=Gi.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});hi.warn(s.message)}}}function N_(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BS=1024,$S=30;class WS{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new HS(t),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){var e,t;try{const a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),l=Ty();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===l||this._heartbeatsCache.heartbeats.some(d=>d.date===l))return;if(this._heartbeatsCache.heartbeats.push({date:l,agent:a}),this._heartbeatsCache.heartbeats.length>$S){const d=qS(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(d,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(s){hi.warn(s)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Ty(),{heartbeatsToSend:s,unsentEntries:a}=GS(this._heartbeatsCache.heartbeats),l=Nu(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=t,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(t){return hi.warn(t),""}}}function Ty(){return new Date().toISOString().substring(0,10)}function GS(n,e=BS){const t=[];let s=n.slice();for(const a of n){const l=t.find(d=>d.agent===a.agent);if(l){if(l.dates.push(a.date),Sy(t)>e){l.dates.pop();break}}else if(t.push({agent:a.agent,dates:[a.date]}),Sy(t)>e){t.pop();break}s=s.slice(1)}return{heartbeatsToSend:t,unsentEntries:s}}class HS{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return kT()?jT().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await zS(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const a=await this.read();return Ey(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:a.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const a=await this.read();return Ey(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:a.lastSentHeartbeatDate,heartbeats:[...a.heartbeats,...e.heartbeats]})}else return}}function Sy(n){return Nu(JSON.stringify({version:2,heartbeats:n})).length}function qS(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let s=1;s<n.length;s++)n[s].date<t&&(t=n[s].date,e=s);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KS(n){Ro(new Aa("platform-logger",e=>new aS(e),"PRIVATE")),Ro(new Aa("heartbeat",e=>new WS(e),"PRIVATE")),Hi(gf,wy,n),Hi(gf,wy,"esm2017"),Hi("fire-js","")}KS("");var QS="firebase",YS="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Hi(QS,YS,"app");function Yf(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(n);a<s.length;a++)e.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(n,s[a])&&(t[s[a]]=n[s[a]]);return t}function A_(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const JS=A_,k_=new Jl("auth","Firebase",A_());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ku=new qf("@firebase/auth");function XS(n,...e){ku.logLevel<=gt.WARN&&ku.warn(`Auth (${Fo}): ${n}`,...e)}function vu(n,...e){ku.logLevel<=gt.ERROR&&ku.error(`Auth (${Fo}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xr(n,...e){throw Xf(n,...e)}function _s(n,...e){return Xf(n,...e)}function Jf(n,e,t){const s=Object.assign(Object.assign({},JS()),{[e]:t});return new Jl("auth","Firebase",s).create(e,{appName:n.name})}function ui(n){return Jf(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function j_(n,e,t){const s=t;if(!(e instanceof s))throw s.name!==e.constructor.name&&Xr(n,"argument-error"),Jf(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Xf(n,...e){if(typeof n!="string"){const t=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=n.name),n._errorFactory.create(t,...s)}return k_.create(n,...e)}function et(n,e,...t){if(!n)throw Xf(e,...t)}function oi(n){const e="INTERNAL ASSERTION FAILED: "+n;throw vu(e),new Error(e)}function fi(n,e){n||oi(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _f(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function ZS(){return Cy()==="http:"||Cy()==="https:"}function Cy(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e1(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(ZS()||PT()||"connection"in navigator)?navigator.onLine:!0}function t1(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zl{constructor(e,t){this.shortDelay=e,this.longDelay=t,fi(t>e,"Short delay should be less than long delay!"),this.isMobile=CT()||RT()}get(){return e1()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zf(n,e){fi(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D_{static initialize(e,t,s){this.fetchImpl=e,t&&(this.headersImpl=t),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;oi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;oi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;oi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n1={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r1=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],s1=new Zl(3e4,6e4);function sa(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function Bs(n,e,t,s,a={}){return L_(n,a,async()=>{let l={},d={};s&&(e==="GET"?d=s:l={body:JSON.stringify(s)});const f=Xl(Object.assign({key:n.config.apiKey},d)).slice(1),m=await n._getAdditionalHeaders();m["Content-Type"]="application/json",n.languageCode&&(m["X-Firebase-Locale"]=n.languageCode);const v=Object.assign({method:e,headers:m},l);return bT()||(v.referrerPolicy="no-referrer"),n.emulatorConfig&&Mo(n.emulatorConfig.host)&&(v.credentials="include"),D_.fetch()(await V_(n,n.config.apiHost,t,f),v)})}async function L_(n,e,t){n._canInitEmulator=!1;const s=Object.assign(Object.assign({},n1),e);try{const a=new a1(n),l=await Promise.race([t(),a.promise]);a.clearNetworkTimeout();const d=await l.json();if("needConfirmation"in d)throw du(n,"account-exists-with-different-credential",d);if(l.ok&&!("errorMessage"in d))return d;{const f=l.ok?d.errorMessage:d.error.message,[m,v]=f.split(" : ");if(m==="FEDERATED_USER_ID_ALREADY_LINKED")throw du(n,"credential-already-in-use",d);if(m==="EMAIL_EXISTS")throw du(n,"email-already-in-use",d);if(m==="USER_DISABLED")throw du(n,"user-disabled",d);const w=s[m]||m.toLowerCase().replace(/[_\s]+/g,"-");if(v)throw Jf(n,w,v);Xr(n,w)}}catch(a){if(a instanceof _i)throw a;Xr(n,"network-request-failed",{message:String(a)})}}async function ec(n,e,t,s,a={}){const l=await Bs(n,e,t,s,a);return"mfaPendingCredential"in l&&Xr(n,"multi-factor-auth-required",{_serverResponse:l}),l}async function V_(n,e,t,s){const a=`${e}${t}?${s}`,l=n,d=l.config.emulator?Zf(n.config,a):`${n.config.apiScheme}://${a}`;return r1.includes(t)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(d).toString():d}function i1(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class a1{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,s)=>{this.timer=setTimeout(()=>s(_s(this.auth,"network-request-failed")),s1.get())})}}function du(n,e,t){const s={appName:n.name};t.email&&(s.email=t.email),t.phoneNumber&&(s.phoneNumber=t.phoneNumber);const a=_s(n,e,s);return a.customData._tokenResponse=t,a}function Iy(n){return n!==void 0&&n.enterprise!==void 0}class o1{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return i1(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function l1(n,e){return Bs(n,"GET","/v2/recaptchaConfig",sa(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function c1(n,e){return Bs(n,"POST","/v1/accounts:delete",e)}async function u1(n,e){return Bs(n,"POST","/v1/accounts:update",e)}async function ju(n,e){return Bs(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kl(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function d1(n,e=!1){const t=an(n),s=await t.getIdToken(e),a=ep(s);et(a&&a.exp&&a.auth_time&&a.iat,t.auth,"internal-error");const l=typeof a.firebase=="object"?a.firebase:void 0,d=l==null?void 0:l.sign_in_provider;return{claims:a,token:s,authTime:kl(nf(a.auth_time)),issuedAtTime:kl(nf(a.iat)),expirationTime:kl(nf(a.exp)),signInProvider:d||null,signInSecondFactor:(l==null?void 0:l.sign_in_second_factor)||null}}function nf(n){return Number(n)*1e3}function ep(n){const[e,t,s]=n.split(".");if(e===void 0||t===void 0||s===void 0)return vu("JWT malformed, contained fewer than 3 sections"),null;try{const a=__(t);return a?JSON.parse(a):(vu("Failed to decode base64 JWT payload"),null)}catch(a){return vu("Caught error parsing JWT payload as JSON",a==null?void 0:a.toString()),null}}function by(n){const e=ep(n);return et(e,"internal-error"),et(typeof e.exp<"u","internal-error"),et(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function No(n,e,t=!1){if(t)return e;try{return await e}catch(s){throw s instanceof _i&&h1(s)&&n.auth.currentUser===n&&await n.auth.signOut(),s}}function h1({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f1{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const s=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),s}else{this.errorBackoff=3e4;const a=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,a)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wf{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=kl(this.lastLoginAt),this.creationTime=kl(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zl(n){var e;const t=n.auth,s=await n.getIdToken(),a=await No(n,ju(t,{idToken:s}));et(a==null?void 0:a.users.length,t,"internal-error");const l=a.users[0];n._notifyReloadListener(l);const d=!((e=l.providerUserInfo)===null||e===void 0)&&e.length?O_(l.providerUserInfo):[],f=m1(n.providerData,d),m=n.isAnonymous,v=!(n.email&&l.passwordHash)&&!(f!=null&&f.length),w=m?v:!1,S={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:f,metadata:new wf(l.createdAt,l.lastLoginAt),isAnonymous:w};Object.assign(n,S)}async function p1(n){const e=an(n);await zl(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function m1(n,e){return[...n.filter(s=>!e.some(a=>a.providerId===s.providerId)),...e]}function O_(n){return n.map(e=>{var{providerId:t}=e,s=Yf(e,["providerId"]);return{providerId:t,uid:s.rawId||"",displayName:s.displayName||null,email:s.email||null,phoneNumber:s.phoneNumber||null,photoURL:s.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function g1(n,e){const t=await L_(n,{},async()=>{const s=Xl({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:l}=n.config,d=await V_(n,a,"/v1/token",`key=${l}`),f=await n._getAdditionalHeaders();f["Content-Type"]="application/x-www-form-urlencoded";const m={method:"POST",headers:f,body:s};return n.emulatorConfig&&Mo(n.emulatorConfig.host)&&(m.credentials="include"),D_.fetch()(d,m)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function y1(n,e){return Bs(n,"POST","/v2/accounts:revokeToken",sa(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class So{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){et(e.idToken,"internal-error"),et(typeof e.idToken<"u","internal-error"),et(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):by(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){et(e.length!==0,"internal-error");const t=by(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(et(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:s,refreshToken:a,expiresIn:l}=await g1(e,t);this.updateTokensAndExpiration(s,a,Number(l))}updateTokensAndExpiration(e,t,s){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,t){const{refreshToken:s,accessToken:a,expirationTime:l}=t,d=new So;return s&&(et(typeof s=="string","internal-error",{appName:e}),d.refreshToken=s),a&&(et(typeof a=="string","internal-error",{appName:e}),d.accessToken=a),l&&(et(typeof l=="number","internal-error",{appName:e}),d.expirationTime=l),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new So,this.toJSON())}_performRefresh(){return oi("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vi(n,e){et(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class vs{constructor(e){var{uid:t,auth:s,stsTokenManager:a}=e,l=Yf(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new f1(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=s,this.stsTokenManager=a,this.accessToken=a.accessToken,this.displayName=l.displayName||null,this.email=l.email||null,this.emailVerified=l.emailVerified||!1,this.phoneNumber=l.phoneNumber||null,this.photoURL=l.photoURL||null,this.isAnonymous=l.isAnonymous||!1,this.tenantId=l.tenantId||null,this.providerData=l.providerData?[...l.providerData]:[],this.metadata=new wf(l.createdAt||void 0,l.lastLoginAt||void 0)}async getIdToken(e){const t=await No(this,this.stsTokenManager.getToken(this.auth,e));return et(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return d1(this,e)}reload(){return p1(this)}_assign(e){this!==e&&(et(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new vs(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){et(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),t&&await zl(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Or(this.auth.app))return Promise.reject(ui(this.auth));const e=await this.getIdToken();return await No(this,c1(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var s,a,l,d,f,m,v,w;const S=(s=t.displayName)!==null&&s!==void 0?s:void 0,I=(a=t.email)!==null&&a!==void 0?a:void 0,U=(l=t.phoneNumber)!==null&&l!==void 0?l:void 0,Z=(d=t.photoURL)!==null&&d!==void 0?d:void 0,Q=(f=t.tenantId)!==null&&f!==void 0?f:void 0,M=(m=t._redirectEventId)!==null&&m!==void 0?m:void 0,ne=(v=t.createdAt)!==null&&v!==void 0?v:void 0,xe=(w=t.lastLoginAt)!==null&&w!==void 0?w:void 0,{uid:we,emailVerified:Ee,isAnonymous:le,providerData:Re,stsTokenManager:A}=t;et(we&&A,e,"internal-error");const P=So.fromJSON(this.name,A);et(typeof we=="string",e,"internal-error"),Vi(S,e.name),Vi(I,e.name),et(typeof Ee=="boolean",e,"internal-error"),et(typeof le=="boolean",e,"internal-error"),Vi(U,e.name),Vi(Z,e.name),Vi(Q,e.name),Vi(M,e.name),Vi(ne,e.name),Vi(xe,e.name);const R=new vs({uid:we,auth:e,email:I,emailVerified:Ee,displayName:S,isAnonymous:le,photoURL:Z,phoneNumber:U,tenantId:Q,stsTokenManager:P,createdAt:ne,lastLoginAt:xe});return Re&&Array.isArray(Re)&&(R.providerData=Re.map(O=>Object.assign({},O))),M&&(R._redirectEventId=M),R}static async _fromIdTokenResponse(e,t,s=!1){const a=new So;a.updateFromServerResponse(t);const l=new vs({uid:t.localId,auth:e,stsTokenManager:a,isAnonymous:s});return await zl(l),l}static async _fromGetAccountInfoResponse(e,t,s){const a=t.users[0];et(a.localId!==void 0,"internal-error");const l=a.providerUserInfo!==void 0?O_(a.providerUserInfo):[],d=!(a.email&&a.passwordHash)&&!(l!=null&&l.length),f=new So;f.updateFromIdToken(s);const m=new vs({uid:a.localId,auth:e,stsTokenManager:f,isAnonymous:d}),v={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new wf(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!(l!=null&&l.length)};return Object.assign(m,v),m}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Py=new Map;function li(n){fi(n instanceof Function,"Expected a class definition");let e=Py.get(n);return e?(fi(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Py.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M_{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}M_.type="NONE";const Ry=M_;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _u(n,e,t){return`firebase:${n}:${e}:${t}`}class Co{constructor(e,t,s){this.persistence=e,this.auth=t,this.userKey=s;const{config:a,name:l}=this.auth;this.fullUserKey=_u(this.userKey,a.apiKey,l),this.fullPersistenceKey=_u("persistence",a.apiKey,l),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await ju(this.auth,{idToken:e}).catch(()=>{});return t?vs._fromGetAccountInfoResponse(this.auth,t,e):null}return vs._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,s="authUser"){if(!t.length)return new Co(li(Ry),e,s);const a=(await Promise.all(t.map(async v=>{if(await v._isAvailable())return v}))).filter(v=>v);let l=a[0]||li(Ry);const d=_u(s,e.config.apiKey,e.name);let f=null;for(const v of t)try{const w=await v._get(d);if(w){let S;if(typeof w=="string"){const I=await ju(e,{idToken:w}).catch(()=>{});if(!I)break;S=await vs._fromGetAccountInfoResponse(e,I,w)}else S=vs._fromJSON(e,w);v!==l&&(f=S),l=v;break}}catch{}const m=a.filter(v=>v._shouldAllowMigration);return!l._shouldAllowMigration||!m.length?new Co(l,e,s):(l=m[0],f&&await l._set(d,f.toJSON()),await Promise.all(t.map(async v=>{if(v!==l)try{await v._remove(d)}catch{}})),new Co(l,e,s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ny(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(B_(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(F_(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(W_(e))return"Blackberry";if(G_(e))return"Webos";if(U_(e))return"Safari";if((e.includes("chrome/")||z_(e))&&!e.includes("edge/"))return"Chrome";if($_(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=n.match(t);if((s==null?void 0:s.length)===2)return s[1]}return"Other"}function F_(n=or()){return/firefox\//i.test(n)}function U_(n=or()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function z_(n=or()){return/crios\//i.test(n)}function B_(n=or()){return/iemobile/i.test(n)}function $_(n=or()){return/android/i.test(n)}function W_(n=or()){return/blackberry/i.test(n)}function G_(n=or()){return/webos/i.test(n)}function tp(n=or()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function v1(n=or()){var e;return tp(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function _1(){return NT()&&document.documentMode===10}function H_(n=or()){return tp(n)||$_(n)||G_(n)||W_(n)||/windows phone/i.test(n)||B_(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q_(n,e=[]){let t;switch(n){case"Browser":t=Ny(or());break;case"Worker":t=`${Ny(or())}-${n}`;break;default:t=n}const s=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Fo}/${s}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w1{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const s=l=>new Promise((d,f)=>{try{const m=e(l);d(m)}catch(m){f(m)}});s.onAbort=t,this.queue.push(s);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const s of this.queue)await s(e),s.onAbort&&t.push(s.onAbort)}catch(s){t.reverse();for(const a of t)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s==null?void 0:s.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function x1(n,e={}){return Bs(n,"GET","/v2/passwordPolicy",sa(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E1=6;class T1{constructor(e){var t,s,a,l;const d=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=d.minPasswordLength)!==null&&t!==void 0?t:E1,d.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=d.maxPasswordLength),d.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=d.containsLowercaseCharacter),d.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=d.containsUppercaseCharacter),d.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=d.containsNumericCharacter),d.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=d.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(a=(s=e.allowedNonAlphanumericCharacters)===null||s===void 0?void 0:s.join(""))!==null&&a!==void 0?a:"",this.forceUpgradeOnSignin=(l=e.forceUpgradeOnSignin)!==null&&l!==void 0?l:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,s,a,l,d,f;const m={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,m),this.validatePasswordCharacterOptions(e,m),m.isValid&&(m.isValid=(t=m.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),m.isValid&&(m.isValid=(s=m.meetsMaxPasswordLength)!==null&&s!==void 0?s:!0),m.isValid&&(m.isValid=(a=m.containsLowercaseLetter)!==null&&a!==void 0?a:!0),m.isValid&&(m.isValid=(l=m.containsUppercaseLetter)!==null&&l!==void 0?l:!0),m.isValid&&(m.isValid=(d=m.containsNumericCharacter)!==null&&d!==void 0?d:!0),m.isValid&&(m.isValid=(f=m.containsNonAlphanumericCharacter)!==null&&f!==void 0?f:!0),m}validatePasswordLengthOptions(e,t){const s=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;s&&(t.meetsMinPasswordLength=e.length>=s),a&&(t.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let s;for(let a=0;a<e.length;a++)s=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(t,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,t,s,a,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S1{constructor(e,t,s,a){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=s,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ay(this),this.idTokenSubscription=new Ay(this),this.beforeStateQueue=new w1(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=k_,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=li(t)),this._initializationPromise=this.queue(async()=>{var s,a,l;if(!this._deleted&&(this.persistenceManager=await Co.create(this,e),(s=this._resolvePersistenceManagerAvailable)===null||s===void 0||s.call(this),!this._deleted)){if(!((a=this._popupRedirectResolver)===null||a===void 0)&&a._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((l=this.currentUser)===null||l===void 0?void 0:l.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await ju(this,{idToken:e}),s=await vs._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(s)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Or(this.app)){const d=this.app.settings.authIdToken;return d?new Promise(f=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(d).then(f,f))}):this.directlySetCurrentUser(null)}const s=await this.assertedPersistence.getCurrentUser();let a=s,l=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const d=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,f=a==null?void 0:a._redirectEventId,m=await this.tryRedirectSignIn(e);(!d||d===f)&&(m!=null&&m.user)&&(a=m.user,l=!0)}if(!a)return this.directlySetCurrentUser(null);if(!a._redirectEventId){if(l)try{await this.beforeStateQueue.runMiddleware(a)}catch(d){a=s,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(d))}return a?this.reloadAndSetCurrentUserOrClear(a):this.directlySetCurrentUser(null)}return et(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===a._redirectEventId?this.directlySetCurrentUser(a):this.reloadAndSetCurrentUserOrClear(a)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await zl(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=t1()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Or(this.app))return Promise.reject(ui(this));const t=e?an(e):null;return t&&et(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&et(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Or(this.app)?Promise.reject(ui(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Or(this.app)?Promise.reject(ui(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(li(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await x1(this),t=new T1(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Jl("auth","Firebase",e())}onAuthStateChanged(e,t,s){return this.registerStateListener(this.authStateSubscription,e,t,s)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,s){return this.registerStateListener(this.idTokenSubscription,e,t,s)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(s.tenantId=this.tenantId),await y1(this,s)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const s=await this.getOrInitRedirectPersistenceManager(t);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&li(e)||this._popupRedirectResolver;et(t,this,"argument-error"),this.redirectPersistenceManager=await Co.create(this,[li(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,s;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((s=this.redirectUser)===null||s===void 0?void 0:s._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const s=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==s&&(this.lastNotifiedUid=s,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,s,a){if(this._deleted)return()=>{};const l=typeof t=="function"?t:t.next.bind(t);let d=!1;const f=this._isInitialized?Promise.resolve():this._initializationPromise;if(et(f,this,"internal-error"),f.then(()=>{d||l(this.currentUser)}),typeof t=="function"){const m=e.addObserver(t,s,a);return()=>{d=!0,m()}}else{const m=e.addObserver(t);return()=>{d=!0,m()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return et(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=q_(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const s=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());s&&(t["X-Firebase-Client"]=s);const a=await this._getAppCheckToken();return a&&(t["X-Firebase-AppCheck"]=a),t}async _getAppCheckToken(){var e;if(Or(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&XS(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function ia(n){return an(n)}class Ay{constructor(e){this.auth=e,this.observer=null,this.addObserver=MT(t=>this.observer=t)}get next(){return et(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zu={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function C1(n){Zu=n}function K_(n){return Zu.loadJS(n)}function I1(){return Zu.recaptchaEnterpriseScript}function b1(){return Zu.gapiScript}function P1(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class R1{constructor(){this.enterprise=new N1}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class N1{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const A1="recaptcha-enterprise",Q_="NO_RECAPTCHA";class k1{constructor(e){this.type=A1,this.auth=ia(e)}async verify(e="verify",t=!1){async function s(l){if(!t){if(l.tenantId==null&&l._agentRecaptchaConfig!=null)return l._agentRecaptchaConfig.siteKey;if(l.tenantId!=null&&l._tenantRecaptchaConfigs[l.tenantId]!==void 0)return l._tenantRecaptchaConfigs[l.tenantId].siteKey}return new Promise(async(d,f)=>{l1(l,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(m=>{if(m.recaptchaKey===void 0)f(new Error("recaptcha Enterprise site key undefined"));else{const v=new o1(m);return l.tenantId==null?l._agentRecaptchaConfig=v:l._tenantRecaptchaConfigs[l.tenantId]=v,d(v.siteKey)}}).catch(m=>{f(m)})})}function a(l,d,f){const m=window.grecaptcha;Iy(m)?m.enterprise.ready(()=>{m.enterprise.execute(l,{action:e}).then(v=>{d(v)}).catch(()=>{d(Q_)})}):f(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new R1().execute("siteKey",{action:"verify"}):new Promise((l,d)=>{s(this.auth).then(f=>{if(!t&&Iy(window.grecaptcha))a(f,l,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let m=I1();m.length!==0&&(m+=f),K_(m).then(()=>{a(f,l,d)}).catch(v=>{d(v)})}}).catch(f=>{d(f)})})}}async function ky(n,e,t,s=!1,a=!1){const l=new k1(n);let d;if(a)d=Q_;else try{d=await l.verify(t)}catch{d=await l.verify(t,!0)}const f=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in f){const m=f.phoneEnrollmentInfo.phoneNumber,v=f.phoneEnrollmentInfo.recaptchaToken;Object.assign(f,{phoneEnrollmentInfo:{phoneNumber:m,recaptchaToken:v,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in f){const m=f.phoneSignInInfo.recaptchaToken;Object.assign(f,{phoneSignInInfo:{recaptchaToken:m,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return f}return s?Object.assign(f,{captchaResp:d}):Object.assign(f,{captchaResponse:d}),Object.assign(f,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(f,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),f}async function xf(n,e,t,s,a){var l;if(!((l=n._getRecaptchaConfig())===null||l===void 0)&&l.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const d=await ky(n,e,t,t==="getOobCode");return s(n,d)}else return s(n,e).catch(async d=>{if(d.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const f=await ky(n,e,t,t==="getOobCode");return s(n,f)}else return Promise.reject(d)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j1(n,e){const t=Qf(n,"auth");if(t.isInitialized()){const a=t.getImmediate(),l=t.getOptions();if(Na(l,e??{}))return a;Xr(a,"already-initialized")}return t.initialize({options:e})}function D1(n,e){const t=(e==null?void 0:e.persistence)||[],s=(Array.isArray(t)?t:[t]).map(li);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(s,e==null?void 0:e.popupRedirectResolver)}function L1(n,e,t){const s=ia(n);et(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const a=!1,l=Y_(e),{host:d,port:f}=V1(e),m=f===null?"":`:${f}`,v={url:`${l}//${d}${m}/`},w=Object.freeze({host:d,port:f,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!s._canInitEmulator){et(s.config.emulator&&s.emulatorConfig,s,"emulator-config-failed"),et(Na(v,s.config.emulator)&&Na(w,s.emulatorConfig),s,"emulator-config-failed");return}s.config.emulator=v,s.emulatorConfig=w,s.settings.appVerificationDisabledForTesting=!0,Mo(d)?(T_(`${l}//${d}${m}`),S_("Auth",!0)):O1()}function Y_(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function V1(n){const e=Y_(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const s=t[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(s);if(a){const l=a[1];return{host:l,port:jy(s.substr(l.length+1))}}else{const[l,d]=s.split(":");return{host:l,port:jy(d)}}}function jy(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function O1(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class np{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return oi("not implemented")}_getIdTokenResponse(e){return oi("not implemented")}_linkToIdToken(e,t){return oi("not implemented")}_getReauthenticationResolver(e){return oi("not implemented")}}async function M1(n,e){return Bs(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function F1(n,e){return ec(n,"POST","/v1/accounts:signInWithPassword",sa(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function U1(n,e){return ec(n,"POST","/v1/accounts:signInWithEmailLink",sa(n,e))}async function z1(n,e){return ec(n,"POST","/v1/accounts:signInWithEmailLink",sa(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bl extends np{constructor(e,t,s,a=null){super("password",s),this._email=e,this._password=t,this._tenantId=a}static _fromEmailAndPassword(e,t){return new Bl(e,t,"password")}static _fromEmailAndCode(e,t,s=null){return new Bl(e,t,"emailLink",s)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return xf(e,t,"signInWithPassword",F1);case"emailLink":return U1(e,{email:this._email,oobCode:this._password});default:Xr(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const s={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return xf(e,s,"signUpPassword",M1);case"emailLink":return z1(e,{idToken:t,email:this._email,oobCode:this._password});default:Xr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Io(n,e){return ec(n,"POST","/v1/accounts:signInWithIdp",sa(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B1="http://localhost";class pi extends np{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new pi(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Xr("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:a}=t,l=Yf(t,["providerId","signInMethod"]);if(!s||!a)return null;const d=new pi(s,a);return d.idToken=l.idToken||void 0,d.accessToken=l.accessToken||void 0,d.secret=l.secret,d.nonce=l.nonce,d.pendingToken=l.pendingToken||null,d}_getIdTokenResponse(e){const t=this.buildRequest();return Io(e,t)}_linkToIdToken(e,t){const s=this.buildRequest();return s.idToken=t,Io(e,s)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Io(e,t)}buildRequest(){const e={requestUri:B1,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Xl(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $1(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function W1(n){const e=Cl(Il(n)).link,t=e?Cl(Il(e)).deep_link_id:null,s=Cl(Il(n)).deep_link_id;return(s?Cl(Il(s)).link:null)||s||t||e||n}class rp{constructor(e){var t,s,a,l,d,f;const m=Cl(Il(e)),v=(t=m.apiKey)!==null&&t!==void 0?t:null,w=(s=m.oobCode)!==null&&s!==void 0?s:null,S=$1((a=m.mode)!==null&&a!==void 0?a:null);et(v&&w&&S,"argument-error"),this.apiKey=v,this.operation=S,this.code=w,this.continueUrl=(l=m.continueUrl)!==null&&l!==void 0?l:null,this.languageCode=(d=m.lang)!==null&&d!==void 0?d:null,this.tenantId=(f=m.tenantId)!==null&&f!==void 0?f:null}static parseLink(e){const t=W1(e);try{return new rp(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uo{constructor(){this.providerId=Uo.PROVIDER_ID}static credential(e,t){return Bl._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const s=rp.parseLink(t);return et(s,"argument-error"),Bl._fromEmailAndCode(e,s.code,s.tenantId)}}Uo.PROVIDER_ID="password";Uo.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Uo.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ed{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zo extends ed{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class jl extends zo{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return et("providerId"in t&&"signInMethod"in t,"argument-error"),pi._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return et(e.idToken||e.accessToken,"argument-error"),pi._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return jl.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return jl.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:s,oauthTokenSecret:a,pendingToken:l,nonce:d,providerId:f}=e;if(!s&&!a&&!t&&!l||!f)return null;try{return new jl(f)._credential({idToken:t,accessToken:s,nonce:d,pendingToken:l})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oi extends zo{constructor(){super("facebook.com")}static credential(e){return pi._fromParams({providerId:Oi.PROVIDER_ID,signInMethod:Oi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Oi.credentialFromTaggedObject(e)}static credentialFromError(e){return Oi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Oi.credential(e.oauthAccessToken)}catch{return null}}}Oi.FACEBOOK_SIGN_IN_METHOD="facebook.com";Oi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ys extends zo{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return pi._fromParams({providerId:ys.PROVIDER_ID,signInMethod:ys.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return ys.credentialFromTaggedObject(e)}static credentialFromError(e){return ys.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:s}=e;if(!t&&!s)return null;try{return ys.credential(t,s)}catch{return null}}}ys.GOOGLE_SIGN_IN_METHOD="google.com";ys.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mi extends zo{constructor(){super("github.com")}static credential(e){return pi._fromParams({providerId:Mi.PROVIDER_ID,signInMethod:Mi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Mi.credentialFromTaggedObject(e)}static credentialFromError(e){return Mi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Mi.credential(e.oauthAccessToken)}catch{return null}}}Mi.GITHUB_SIGN_IN_METHOD="github.com";Mi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fi extends zo{constructor(){super("twitter.com")}static credential(e,t){return pi._fromParams({providerId:Fi.PROVIDER_ID,signInMethod:Fi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Fi.credentialFromTaggedObject(e)}static credentialFromError(e){return Fi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:s}=e;if(!t||!s)return null;try{return Fi.credential(t,s)}catch{return null}}}Fi.TWITTER_SIGN_IN_METHOD="twitter.com";Fi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function G1(n,e){return ec(n,"POST","/v1/accounts:signUp",sa(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ka{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,s,a=!1){const l=await vs._fromIdTokenResponse(e,s,a),d=Dy(s);return new ka({user:l,providerId:d,_tokenResponse:s,operationType:t})}static async _forOperation(e,t,s){await e._updateTokensIfNecessary(s,!0);const a=Dy(s);return new ka({user:e,providerId:a,_tokenResponse:s,operationType:t})}}function Dy(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Du extends _i{constructor(e,t,s,a){var l;super(t.code,t.message),this.operationType=s,this.user=a,Object.setPrototypeOf(this,Du.prototype),this.customData={appName:e.name,tenantId:(l=e.tenantId)!==null&&l!==void 0?l:void 0,_serverResponse:t.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,t,s,a){return new Du(e,t,s,a)}}function J_(n,e,t,s){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?Du._fromErrorAndOperation(n,l,e,s):l})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X_(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function H1(n,e){const t=an(n);await K1(!0,t,e);const{providerUserInfo:s}=await u1(t.auth,{idToken:await t.getIdToken(),deleteProvider:[e]}),a=X_(s||[]);return t.providerData=t.providerData.filter(l=>a.has(l.providerId)),a.has("phone")||(t.phoneNumber=null),await t.auth._persistUserIfCurrent(t),t}async function q1(n,e,t=!1){const s=await No(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return ka._forOperation(n,"link",s)}async function K1(n,e,t){await zl(e);const s=X_(e.providerData);et(s.has(t)===n,e.auth,"no-such-provider")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Q1(n,e,t=!1){const{auth:s}=n;if(Or(s.app))return Promise.reject(ui(s));const a="reauthenticate";try{const l=await No(n,J_(s,a,e,n),t);et(l.idToken,s,"internal-error");const d=ep(l.idToken);et(d,s,"internal-error");const{sub:f}=d;return et(n.uid===f,s,"user-mismatch"),ka._forOperation(n,a,l)}catch(l){throw(l==null?void 0:l.code)==="auth/user-not-found"&&Xr(s,"user-mismatch"),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Z_(n,e,t=!1){if(Or(n.app))return Promise.reject(ui(n));const s="signIn",a=await J_(n,s,e),l=await ka._fromIdTokenResponse(n,s,a);return t||await n._updateCurrentUser(l.user),l}async function Y1(n,e){return Z_(ia(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function e0(n){const e=ia(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function J1(n,e,t){if(Or(n.app))return Promise.reject(ui(n));const s=ia(n),d=await xf(s,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",G1).catch(m=>{throw m.code==="auth/password-does-not-meet-requirements"&&e0(n),m}),f=await ka._fromIdTokenResponse(s,"signIn",d);return await s._updateCurrentUser(f.user),f}function t0(n,e,t){return Or(n.app)?Promise.reject(ui(n)):Y1(an(n),Uo.credential(e,t)).catch(async s=>{throw s.code==="auth/password-does-not-meet-requirements"&&e0(n),s})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function X1(n,e){return Bs(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Z1(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const s=an(n),l={idToken:await s.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},d=await No(s,X1(s.auth,l));s.displayName=d.displayName||null,s.photoURL=d.photoUrl||null;const f=s.providerData.find(({providerId:m})=>m==="password");f&&(f.displayName=s.displayName,f.photoURL=s.photoURL),await s._updateTokensIfNecessary(d)}function eC(n,e,t,s){return an(n).onIdTokenChanged(e,t,s)}function tC(n,e,t){return an(n).beforeAuthStateChanged(e,t)}function nC(n,e,t,s){return an(n).onAuthStateChanged(e,t,s)}function n0(n){return an(n).signOut()}const Lu="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r0{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Lu,"1"),this.storage.removeItem(Lu),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rC=1e3,sC=10;class s0 extends r0{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=H_(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const s=this.storage.getItem(t),a=this.localCache[t];s!==a&&e(t,a,s)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((d,f,m)=>{this.notifyListeners(d,m)});return}const s=e.key;t?this.detachListener():this.stopPolling();const a=()=>{const d=this.storage.getItem(s);!t&&this.localCache[s]===d||this.notifyListeners(s,d)},l=this.storage.getItem(s);_1()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,sC):a()}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const a of Array.from(s))a(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:s}),!0)})},rC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}s0.type="LOCAL";const iC=s0;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i0 extends r0{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}i0.type="SESSION";const a0=i0;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aC(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class td{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(a=>a.isListeningto(e));if(t)return t;const s=new td(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:s,eventType:a,data:l}=t.data,d=this.handlersMap[a];if(!(d!=null&&d.size))return;t.ports[0].postMessage({status:"ack",eventId:s,eventType:a});const f=Array.from(d).map(async v=>v(t.origin,l)),m=await aC(f);t.ports[0].postMessage({status:"done",eventId:s,eventType:a,response:m})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}td.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sp(n="",e=10){let t="";for(let s=0;s<e;s++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oC{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,s=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let l,d;return new Promise((f,m)=>{const v=sp("",20);a.port1.start();const w=setTimeout(()=>{m(new Error("unsupported_event"))},s);d={messageChannel:a,onMessage(S){const I=S;if(I.data.eventId===v)switch(I.data.status){case"ack":clearTimeout(w),l=setTimeout(()=>{m(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),f(I.data.response);break;default:clearTimeout(w),clearTimeout(l),m(new Error("invalid_response"));break}}},this.handlers.add(d),a.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:v,data:t},[a.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ls(){return window}function lC(n){Ls().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o0(){return typeof Ls().WorkerGlobalScope<"u"&&typeof Ls().importScripts=="function"}async function cC(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function uC(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function dC(){return o0()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l0="firebaseLocalStorageDb",hC=1,Vu="firebaseLocalStorage",c0="fbase_key";class tc{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function nd(n,e){return n.transaction([Vu],e?"readwrite":"readonly").objectStore(Vu)}function fC(){const n=indexedDB.deleteDatabase(l0);return new tc(n).toPromise()}function Ef(){const n=indexedDB.open(l0,hC);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const s=n.result;try{s.createObjectStore(Vu,{keyPath:c0})}catch(a){t(a)}}),n.addEventListener("success",async()=>{const s=n.result;s.objectStoreNames.contains(Vu)?e(s):(s.close(),await fC(),e(await Ef()))})})}async function Ly(n,e,t){const s=nd(n,!0).put({[c0]:e,value:t});return new tc(s).toPromise()}async function pC(n,e){const t=nd(n,!1).get(e),s=await new tc(t).toPromise();return s===void 0?null:s.value}function Vy(n,e){const t=nd(n,!0).delete(e);return new tc(t).toPromise()}const mC=800,gC=3;class u0{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Ef(),this.db)}async _withRetries(e){let t=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(t++>gC)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return o0()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=td._getInstance(dC()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await cC(),!this.activeServiceWorker)return;this.sender=new oC(this.activeServiceWorker);const s=await this.sender._send("ping",{},800);s&&!((e=s[0])===null||e===void 0)&&e.fulfilled&&!((t=s[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||uC()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Ef();return await Ly(e,Lu,"1"),await Vy(e,Lu),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(s=>Ly(s,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(s=>pC(s,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Vy(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const l=nd(a,!1).getAll();return new tc(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],s=new Set;if(e.length!==0)for(const{fbase_key:a,value:l}of e)s.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(l)&&(this.notifyListeners(a,l),t.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!s.has(a)&&(this.notifyListeners(a,null),t.push(a));return t}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const a of Array.from(s))a(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),mC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}u0.type="LOCAL";const yC=u0;new Zl(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ip(n,e){return e?li(e):(et(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ap extends np{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Io(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Io(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Io(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function vC(n){return Z_(n.auth,new ap(n),n.bypassAuthState)}function _C(n){const{auth:e,user:t}=n;return et(t,e,"internal-error"),Q1(t,new ap(n),n.bypassAuthState)}async function wC(n){const{auth:e,user:t}=n;return et(t,e,"internal-error"),q1(t,new ap(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d0{constructor(e,t,s,a,l=!1){this.auth=e,this.resolver=s,this.user=a,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:s,postBody:a,tenantId:l,error:d,type:f}=e;if(d){this.reject(d);return}const m={auth:this.auth,requestUri:t,sessionId:s,tenantId:l||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(f)(m))}catch(v){this.reject(v)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return vC;case"linkViaPopup":case"linkViaRedirect":return wC;case"reauthViaPopup":case"reauthViaRedirect":return _C;default:Xr(this.auth,"internal-error")}}resolve(e){fi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){fi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xC=new Zl(2e3,1e4);async function h0(n,e,t){if(Or(n.app))return Promise.reject(_s(n,"operation-not-supported-in-this-environment"));const s=ia(n);j_(n,e,ed);const a=ip(s,t);return new zi(s,"signInViaPopup",e,a).executeNotNull()}async function Oy(n,e,t){const s=an(n);j_(s.auth,e,ed);const a=ip(s.auth,t);return new zi(s.auth,"linkViaPopup",e,a,s).executeNotNull()}class zi extends d0{constructor(e,t,s,a,l){super(e,t,a,l),this.provider=s,this.authWindow=null,this.pollId=null,zi.currentPopupAction&&zi.currentPopupAction.cancel(),zi.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return et(e,this.auth,"internal-error"),e}async onExecution(){fi(this.filter.length===1,"Popup operations only handle one event");const e=sp();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(_s(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(_s(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,zi.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,s;if(!((s=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||s===void 0)&&s.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(_s(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,xC.get())};e()}}zi.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EC="pendingRedirect",wu=new Map;class TC extends d0{constructor(e,t,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,s),this.eventId=null}async execute(){let e=wu.get(this.auth._key());if(!e){try{const s=await SC(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(t){e=()=>Promise.reject(t)}wu.set(this.auth._key(),e)}return this.bypassAuthState||wu.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function SC(n,e){const t=bC(e),s=IC(n);if(!await s._isAvailable())return!1;const a=await s._get(t)==="true";return await s._remove(t),a}function CC(n,e){wu.set(n._key(),e)}function IC(n){return li(n._redirectPersistence)}function bC(n){return _u(EC,n.config.apiKey,n.name)}async function PC(n,e,t=!1){if(Or(n.app))return Promise.reject(ui(n));const s=ia(n),a=ip(s,e),d=await new TC(s,a,t).execute();return d&&!t&&(delete d.user._redirectEventId,await s._persistUserIfCurrent(d.user),await s._setRedirectUser(null,e)),d}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RC=600*1e3;class NC{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(t=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!AC(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var s;if(e.error&&!f0(e)){const a=((s=e.error.code)===null||s===void 0?void 0:s.split("auth/")[1])||"internal-error";t.onError(_s(this.auth,a))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const s=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=RC&&this.cachedEventUids.clear(),this.cachedEventUids.has(My(e))}saveEventToCache(e){this.cachedEventUids.add(My(e)),this.lastProcessedEventTime=Date.now()}}function My(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function f0({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function AC(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return f0(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kC(n,e={}){return Bs(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jC=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,DC=/^https?/;async function LC(n){if(n.config.emulator)return;const{authorizedDomains:e}=await kC(n);for(const t of e)try{if(VC(t))return}catch{}Xr(n,"unauthorized-domain")}function VC(n){const e=_f(),{protocol:t,hostname:s}=new URL(e);if(n.startsWith("chrome-extension://")){const d=new URL(n);return d.hostname===""&&s===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&d.hostname===s}if(!DC.test(t))return!1;if(jC.test(n))return s===n;const a=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(s)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OC=new Zl(3e4,6e4);function Fy(){const n=Ls().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function MC(n){return new Promise((e,t)=>{var s,a,l;function d(){Fy(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Fy(),t(_s(n,"network-request-failed"))},timeout:OC.get()})}if(!((a=(s=Ls().gapi)===null||s===void 0?void 0:s.iframes)===null||a===void 0)&&a.Iframe)e(gapi.iframes.getContext());else if(!((l=Ls().gapi)===null||l===void 0)&&l.load)d();else{const f=P1("iframefcb");return Ls()[f]=()=>{gapi.load?d():t(_s(n,"network-request-failed"))},K_(`${b1()}?onload=${f}`).catch(m=>t(m))}}).catch(e=>{throw xu=null,e})}let xu=null;function FC(n){return xu=xu||MC(n),xu}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UC=new Zl(5e3,15e3),zC="__/auth/iframe",BC="emulator/auth/iframe",$C={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},WC=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function GC(n){const e=n.config;et(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Zf(e,BC):`https://${n.config.authDomain}/${zC}`,s={apiKey:e.apiKey,appName:n.name,v:Fo},a=WC.get(n.config.apiHost);a&&(s.eid=a);const l=n._getFrameworks();return l.length&&(s.fw=l.join(",")),`${t}?${Xl(s).slice(1)}`}async function HC(n){const e=await FC(n),t=Ls().gapi;return et(t,n,"internal-error"),e.open({where:document.body,url:GC(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:$C,dontclear:!0},s=>new Promise(async(a,l)=>{await s.restyle({setHideOnLeave:!1});const d=_s(n,"network-request-failed"),f=Ls().setTimeout(()=>{l(d)},UC.get());function m(){Ls().clearTimeout(f),a(s)}s.ping(m).then(m,()=>{l(d)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qC={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},KC=500,QC=600,YC="_blank",JC="http://localhost";class Uy{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function XC(n,e,t,s=KC,a=QC){const l=Math.max((window.screen.availHeight-a)/2,0).toString(),d=Math.max((window.screen.availWidth-s)/2,0).toString();let f="";const m=Object.assign(Object.assign({},qC),{width:s.toString(),height:a.toString(),top:l,left:d}),v=or().toLowerCase();t&&(f=z_(v)?YC:t),F_(v)&&(e=e||JC,m.scrollbars="yes");const w=Object.entries(m).reduce((I,[U,Z])=>`${I}${U}=${Z},`,"");if(v1(v)&&f!=="_self")return ZC(e||"",f),new Uy(null);const S=window.open(e||"",f,w);et(S,n,"popup-blocked");try{S.focus()}catch{}return new Uy(S)}function ZC(n,e){const t=document.createElement("a");t.href=n,t.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eI="__/auth/handler",tI="emulator/auth/handler",nI=encodeURIComponent("fac");async function zy(n,e,t,s,a,l){et(n.config.authDomain,n,"auth-domain-config-required"),et(n.config.apiKey,n,"invalid-api-key");const d={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:s,v:Fo,eventId:a};if(e instanceof ed){e.setDefaultLanguage(n.languageCode),d.providerId=e.providerId||"",OT(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[w,S]of Object.entries({}))d[w]=S}if(e instanceof zo){const w=e.getScopes().filter(S=>S!=="");w.length>0&&(d.scopes=w.join(","))}n.tenantId&&(d.tid=n.tenantId);const f=d;for(const w of Object.keys(f))f[w]===void 0&&delete f[w];const m=await n._getAppCheckToken(),v=m?`#${nI}=${encodeURIComponent(m)}`:"";return`${rI(n)}?${Xl(f).slice(1)}${v}`}function rI({config:n}){return n.emulator?Zf(n,tI):`https://${n.authDomain}/${eI}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rf="webStorageSupport";class sI{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=a0,this._completeRedirectFn=PC,this._overrideRedirectResult=CC}async _openPopup(e,t,s,a){var l;fi((l=this.eventManagers[e._key()])===null||l===void 0?void 0:l.manager,"_initialize() not called before _openPopup()");const d=await zy(e,t,s,_f(),a);return XC(e,d,sp())}async _openRedirect(e,t,s,a){await this._originValidation(e);const l=await zy(e,t,s,_f(),a);return lC(l),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:a,promise:l}=this.eventManagers[t];return a?Promise.resolve(a):(fi(l,"If manager is not set, promise should be"),l)}const s=this.initAndGetManager(e);return this.eventManagers[t]={promise:s},s.catch(()=>{delete this.eventManagers[t]}),s}async initAndGetManager(e){const t=await HC(e),s=new NC(e);return t.register("authEvent",a=>(et(a==null?void 0:a.authEvent,e,"invalid-auth-event"),{status:s.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=t,s}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(rf,{type:rf},a=>{var l;const d=(l=a==null?void 0:a[0])===null||l===void 0?void 0:l[rf];d!==void 0&&t(!!d),Xr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=LC(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return H_()||U_()||tp()}}const iI=sI;var By="@firebase/auth",$y="1.10.8";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aI{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(s=>{e((s==null?void 0:s.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){et(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oI(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function lI(n){Ro(new Aa("auth",(e,{options:t})=>{const s=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:d,authDomain:f}=s.options;et(d&&!d.includes(":"),"invalid-api-key",{appName:s.name});const m={apiKey:d,authDomain:f,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:q_(n)},v=new S1(s,a,l,m);return D1(v,t),v},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,s)=>{e.getProvider("auth-internal").initialize()})),Ro(new Aa("auth-internal",e=>{const t=ia(e.getProvider("auth").getImmediate());return(s=>new aI(s))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Hi(By,$y,oI(n)),Hi(By,$y,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cI=300,uI=E_("authIdTokenMaxAge")||cI;let Wy=null;const dI=n=>async e=>{const t=e&&await e.getIdTokenResult(),s=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(s&&s>uI)return;const a=t==null?void 0:t.token;Wy!==a&&(Wy=a,await fetch(n,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function hI(n=P_()){const e=Qf(n,"auth");if(e.isInitialized())return e.getImmediate();const t=j1(n,{popupRedirectResolver:iI,persistence:[yC,iC,a0]}),s=E_("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const l=new URL(s,location.origin);if(location.origin===l.origin){const d=dI(l.toString());tC(t,d,()=>d(t.currentUser)),eC(t,f=>d(f))}}const a=w_("auth");return a&&L1(t,`http://${a}`),t}function fI(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}C1({loadJS(n){return new Promise((e,t)=>{const s=document.createElement("script");s.setAttribute("src",n),s.onload=e,s.onerror=a=>{const l=_s("internal-error");l.customData=a,t(l)},s.type="text/javascript",s.charset="UTF-8",fI().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});lI("Browser");var Gy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var qi,p0;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(A,P){function R(){}R.prototype=P.prototype,A.D=P.prototype,A.prototype=new R,A.prototype.constructor=A,A.C=function(O,B,D){for(var b=Array(arguments.length-2),he=2;he<arguments.length;he++)b[he-2]=arguments[he];return P.prototype[B].apply(O,b)}}function t(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(s,t),s.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(A,P,R){R||(R=0);var O=Array(16);if(typeof P=="string")for(var B=0;16>B;++B)O[B]=P.charCodeAt(R++)|P.charCodeAt(R++)<<8|P.charCodeAt(R++)<<16|P.charCodeAt(R++)<<24;else for(B=0;16>B;++B)O[B]=P[R++]|P[R++]<<8|P[R++]<<16|P[R++]<<24;P=A.g[0],R=A.g[1],B=A.g[2];var D=A.g[3],b=P+(D^R&(B^D))+O[0]+3614090360&4294967295;P=R+(b<<7&4294967295|b>>>25),b=D+(B^P&(R^B))+O[1]+3905402710&4294967295,D=P+(b<<12&4294967295|b>>>20),b=B+(R^D&(P^R))+O[2]+606105819&4294967295,B=D+(b<<17&4294967295|b>>>15),b=R+(P^B&(D^P))+O[3]+3250441966&4294967295,R=B+(b<<22&4294967295|b>>>10),b=P+(D^R&(B^D))+O[4]+4118548399&4294967295,P=R+(b<<7&4294967295|b>>>25),b=D+(B^P&(R^B))+O[5]+1200080426&4294967295,D=P+(b<<12&4294967295|b>>>20),b=B+(R^D&(P^R))+O[6]+2821735955&4294967295,B=D+(b<<17&4294967295|b>>>15),b=R+(P^B&(D^P))+O[7]+4249261313&4294967295,R=B+(b<<22&4294967295|b>>>10),b=P+(D^R&(B^D))+O[8]+1770035416&4294967295,P=R+(b<<7&4294967295|b>>>25),b=D+(B^P&(R^B))+O[9]+2336552879&4294967295,D=P+(b<<12&4294967295|b>>>20),b=B+(R^D&(P^R))+O[10]+4294925233&4294967295,B=D+(b<<17&4294967295|b>>>15),b=R+(P^B&(D^P))+O[11]+2304563134&4294967295,R=B+(b<<22&4294967295|b>>>10),b=P+(D^R&(B^D))+O[12]+1804603682&4294967295,P=R+(b<<7&4294967295|b>>>25),b=D+(B^P&(R^B))+O[13]+4254626195&4294967295,D=P+(b<<12&4294967295|b>>>20),b=B+(R^D&(P^R))+O[14]+2792965006&4294967295,B=D+(b<<17&4294967295|b>>>15),b=R+(P^B&(D^P))+O[15]+1236535329&4294967295,R=B+(b<<22&4294967295|b>>>10),b=P+(B^D&(R^B))+O[1]+4129170786&4294967295,P=R+(b<<5&4294967295|b>>>27),b=D+(R^B&(P^R))+O[6]+3225465664&4294967295,D=P+(b<<9&4294967295|b>>>23),b=B+(P^R&(D^P))+O[11]+643717713&4294967295,B=D+(b<<14&4294967295|b>>>18),b=R+(D^P&(B^D))+O[0]+3921069994&4294967295,R=B+(b<<20&4294967295|b>>>12),b=P+(B^D&(R^B))+O[5]+3593408605&4294967295,P=R+(b<<5&4294967295|b>>>27),b=D+(R^B&(P^R))+O[10]+38016083&4294967295,D=P+(b<<9&4294967295|b>>>23),b=B+(P^R&(D^P))+O[15]+3634488961&4294967295,B=D+(b<<14&4294967295|b>>>18),b=R+(D^P&(B^D))+O[4]+3889429448&4294967295,R=B+(b<<20&4294967295|b>>>12),b=P+(B^D&(R^B))+O[9]+568446438&4294967295,P=R+(b<<5&4294967295|b>>>27),b=D+(R^B&(P^R))+O[14]+3275163606&4294967295,D=P+(b<<9&4294967295|b>>>23),b=B+(P^R&(D^P))+O[3]+4107603335&4294967295,B=D+(b<<14&4294967295|b>>>18),b=R+(D^P&(B^D))+O[8]+1163531501&4294967295,R=B+(b<<20&4294967295|b>>>12),b=P+(B^D&(R^B))+O[13]+2850285829&4294967295,P=R+(b<<5&4294967295|b>>>27),b=D+(R^B&(P^R))+O[2]+4243563512&4294967295,D=P+(b<<9&4294967295|b>>>23),b=B+(P^R&(D^P))+O[7]+1735328473&4294967295,B=D+(b<<14&4294967295|b>>>18),b=R+(D^P&(B^D))+O[12]+2368359562&4294967295,R=B+(b<<20&4294967295|b>>>12),b=P+(R^B^D)+O[5]+4294588738&4294967295,P=R+(b<<4&4294967295|b>>>28),b=D+(P^R^B)+O[8]+2272392833&4294967295,D=P+(b<<11&4294967295|b>>>21),b=B+(D^P^R)+O[11]+1839030562&4294967295,B=D+(b<<16&4294967295|b>>>16),b=R+(B^D^P)+O[14]+4259657740&4294967295,R=B+(b<<23&4294967295|b>>>9),b=P+(R^B^D)+O[1]+2763975236&4294967295,P=R+(b<<4&4294967295|b>>>28),b=D+(P^R^B)+O[4]+1272893353&4294967295,D=P+(b<<11&4294967295|b>>>21),b=B+(D^P^R)+O[7]+4139469664&4294967295,B=D+(b<<16&4294967295|b>>>16),b=R+(B^D^P)+O[10]+3200236656&4294967295,R=B+(b<<23&4294967295|b>>>9),b=P+(R^B^D)+O[13]+681279174&4294967295,P=R+(b<<4&4294967295|b>>>28),b=D+(P^R^B)+O[0]+3936430074&4294967295,D=P+(b<<11&4294967295|b>>>21),b=B+(D^P^R)+O[3]+3572445317&4294967295,B=D+(b<<16&4294967295|b>>>16),b=R+(B^D^P)+O[6]+76029189&4294967295,R=B+(b<<23&4294967295|b>>>9),b=P+(R^B^D)+O[9]+3654602809&4294967295,P=R+(b<<4&4294967295|b>>>28),b=D+(P^R^B)+O[12]+3873151461&4294967295,D=P+(b<<11&4294967295|b>>>21),b=B+(D^P^R)+O[15]+530742520&4294967295,B=D+(b<<16&4294967295|b>>>16),b=R+(B^D^P)+O[2]+3299628645&4294967295,R=B+(b<<23&4294967295|b>>>9),b=P+(B^(R|~D))+O[0]+4096336452&4294967295,P=R+(b<<6&4294967295|b>>>26),b=D+(R^(P|~B))+O[7]+1126891415&4294967295,D=P+(b<<10&4294967295|b>>>22),b=B+(P^(D|~R))+O[14]+2878612391&4294967295,B=D+(b<<15&4294967295|b>>>17),b=R+(D^(B|~P))+O[5]+4237533241&4294967295,R=B+(b<<21&4294967295|b>>>11),b=P+(B^(R|~D))+O[12]+1700485571&4294967295,P=R+(b<<6&4294967295|b>>>26),b=D+(R^(P|~B))+O[3]+2399980690&4294967295,D=P+(b<<10&4294967295|b>>>22),b=B+(P^(D|~R))+O[10]+4293915773&4294967295,B=D+(b<<15&4294967295|b>>>17),b=R+(D^(B|~P))+O[1]+2240044497&4294967295,R=B+(b<<21&4294967295|b>>>11),b=P+(B^(R|~D))+O[8]+1873313359&4294967295,P=R+(b<<6&4294967295|b>>>26),b=D+(R^(P|~B))+O[15]+4264355552&4294967295,D=P+(b<<10&4294967295|b>>>22),b=B+(P^(D|~R))+O[6]+2734768916&4294967295,B=D+(b<<15&4294967295|b>>>17),b=R+(D^(B|~P))+O[13]+1309151649&4294967295,R=B+(b<<21&4294967295|b>>>11),b=P+(B^(R|~D))+O[4]+4149444226&4294967295,P=R+(b<<6&4294967295|b>>>26),b=D+(R^(P|~B))+O[11]+3174756917&4294967295,D=P+(b<<10&4294967295|b>>>22),b=B+(P^(D|~R))+O[2]+718787259&4294967295,B=D+(b<<15&4294967295|b>>>17),b=R+(D^(B|~P))+O[9]+3951481745&4294967295,A.g[0]=A.g[0]+P&4294967295,A.g[1]=A.g[1]+(B+(b<<21&4294967295|b>>>11))&4294967295,A.g[2]=A.g[2]+B&4294967295,A.g[3]=A.g[3]+D&4294967295}s.prototype.u=function(A,P){P===void 0&&(P=A.length);for(var R=P-this.blockSize,O=this.B,B=this.h,D=0;D<P;){if(B==0)for(;D<=R;)a(this,A,D),D+=this.blockSize;if(typeof A=="string"){for(;D<P;)if(O[B++]=A.charCodeAt(D++),B==this.blockSize){a(this,O),B=0;break}}else for(;D<P;)if(O[B++]=A[D++],B==this.blockSize){a(this,O),B=0;break}}this.h=B,this.o+=P},s.prototype.v=function(){var A=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);A[0]=128;for(var P=1;P<A.length-8;++P)A[P]=0;var R=8*this.o;for(P=A.length-8;P<A.length;++P)A[P]=R&255,R/=256;for(this.u(A),A=Array(16),P=R=0;4>P;++P)for(var O=0;32>O;O+=8)A[R++]=this.g[P]>>>O&255;return A};function l(A,P){var R=f;return Object.prototype.hasOwnProperty.call(R,A)?R[A]:R[A]=P(A)}function d(A,P){this.h=P;for(var R=[],O=!0,B=A.length-1;0<=B;B--){var D=A[B]|0;O&&D==P||(R[B]=D,O=!1)}this.g=R}var f={};function m(A){return-128<=A&&128>A?l(A,function(P){return new d([P|0],0>P?-1:0)}):new d([A|0],0>A?-1:0)}function v(A){if(isNaN(A)||!isFinite(A))return S;if(0>A)return M(v(-A));for(var P=[],R=1,O=0;A>=R;O++)P[O]=A/R|0,R*=4294967296;return new d(P,0)}function w(A,P){if(A.length==0)throw Error("number format error: empty string");if(P=P||10,2>P||36<P)throw Error("radix out of range: "+P);if(A.charAt(0)=="-")return M(w(A.substring(1),P));if(0<=A.indexOf("-"))throw Error('number format error: interior "-" character');for(var R=v(Math.pow(P,8)),O=S,B=0;B<A.length;B+=8){var D=Math.min(8,A.length-B),b=parseInt(A.substring(B,B+D),P);8>D?(D=v(Math.pow(P,D)),O=O.j(D).add(v(b))):(O=O.j(R),O=O.add(v(b)))}return O}var S=m(0),I=m(1),U=m(16777216);n=d.prototype,n.m=function(){if(Q(this))return-M(this).m();for(var A=0,P=1,R=0;R<this.g.length;R++){var O=this.i(R);A+=(0<=O?O:4294967296+O)*P,P*=4294967296}return A},n.toString=function(A){if(A=A||10,2>A||36<A)throw Error("radix out of range: "+A);if(Z(this))return"0";if(Q(this))return"-"+M(this).toString(A);for(var P=v(Math.pow(A,6)),R=this,O="";;){var B=Ee(R,P).g;R=ne(R,B.j(P));var D=((0<R.g.length?R.g[0]:R.h)>>>0).toString(A);if(R=B,Z(R))return D+O;for(;6>D.length;)D="0"+D;O=D+O}},n.i=function(A){return 0>A?0:A<this.g.length?this.g[A]:this.h};function Z(A){if(A.h!=0)return!1;for(var P=0;P<A.g.length;P++)if(A.g[P]!=0)return!1;return!0}function Q(A){return A.h==-1}n.l=function(A){return A=ne(this,A),Q(A)?-1:Z(A)?0:1};function M(A){for(var P=A.g.length,R=[],O=0;O<P;O++)R[O]=~A.g[O];return new d(R,~A.h).add(I)}n.abs=function(){return Q(this)?M(this):this},n.add=function(A){for(var P=Math.max(this.g.length,A.g.length),R=[],O=0,B=0;B<=P;B++){var D=O+(this.i(B)&65535)+(A.i(B)&65535),b=(D>>>16)+(this.i(B)>>>16)+(A.i(B)>>>16);O=b>>>16,D&=65535,b&=65535,R[B]=b<<16|D}return new d(R,R[R.length-1]&-2147483648?-1:0)};function ne(A,P){return A.add(M(P))}n.j=function(A){if(Z(this)||Z(A))return S;if(Q(this))return Q(A)?M(this).j(M(A)):M(M(this).j(A));if(Q(A))return M(this.j(M(A)));if(0>this.l(U)&&0>A.l(U))return v(this.m()*A.m());for(var P=this.g.length+A.g.length,R=[],O=0;O<2*P;O++)R[O]=0;for(O=0;O<this.g.length;O++)for(var B=0;B<A.g.length;B++){var D=this.i(O)>>>16,b=this.i(O)&65535,he=A.i(B)>>>16,$e=A.i(B)&65535;R[2*O+2*B]+=b*$e,xe(R,2*O+2*B),R[2*O+2*B+1]+=D*$e,xe(R,2*O+2*B+1),R[2*O+2*B+1]+=b*he,xe(R,2*O+2*B+1),R[2*O+2*B+2]+=D*he,xe(R,2*O+2*B+2)}for(O=0;O<P;O++)R[O]=R[2*O+1]<<16|R[2*O];for(O=P;O<2*P;O++)R[O]=0;return new d(R,0)};function xe(A,P){for(;(A[P]&65535)!=A[P];)A[P+1]+=A[P]>>>16,A[P]&=65535,P++}function we(A,P){this.g=A,this.h=P}function Ee(A,P){if(Z(P))throw Error("division by zero");if(Z(A))return new we(S,S);if(Q(A))return P=Ee(M(A),P),new we(M(P.g),M(P.h));if(Q(P))return P=Ee(A,M(P)),new we(M(P.g),P.h);if(30<A.g.length){if(Q(A)||Q(P))throw Error("slowDivide_ only works with positive integers.");for(var R=I,O=P;0>=O.l(A);)R=le(R),O=le(O);var B=Re(R,1),D=Re(O,1);for(O=Re(O,2),R=Re(R,2);!Z(O);){var b=D.add(O);0>=b.l(A)&&(B=B.add(R),D=b),O=Re(O,1),R=Re(R,1)}return P=ne(A,B.j(P)),new we(B,P)}for(B=S;0<=A.l(P);){for(R=Math.max(1,Math.floor(A.m()/P.m())),O=Math.ceil(Math.log(R)/Math.LN2),O=48>=O?1:Math.pow(2,O-48),D=v(R),b=D.j(P);Q(b)||0<b.l(A);)R-=O,D=v(R),b=D.j(P);Z(D)&&(D=I),B=B.add(D),A=ne(A,b)}return new we(B,A)}n.A=function(A){return Ee(this,A).h},n.and=function(A){for(var P=Math.max(this.g.length,A.g.length),R=[],O=0;O<P;O++)R[O]=this.i(O)&A.i(O);return new d(R,this.h&A.h)},n.or=function(A){for(var P=Math.max(this.g.length,A.g.length),R=[],O=0;O<P;O++)R[O]=this.i(O)|A.i(O);return new d(R,this.h|A.h)},n.xor=function(A){for(var P=Math.max(this.g.length,A.g.length),R=[],O=0;O<P;O++)R[O]=this.i(O)^A.i(O);return new d(R,this.h^A.h)};function le(A){for(var P=A.g.length+1,R=[],O=0;O<P;O++)R[O]=A.i(O)<<1|A.i(O-1)>>>31;return new d(R,A.h)}function Re(A,P){var R=P>>5;P%=32;for(var O=A.g.length-R,B=[],D=0;D<O;D++)B[D]=0<P?A.i(D+R)>>>P|A.i(D+R+1)<<32-P:A.i(D+R);return new d(B,A.h)}s.prototype.digest=s.prototype.v,s.prototype.reset=s.prototype.s,s.prototype.update=s.prototype.u,p0=s,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.A,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=v,d.fromString=w,qi=d}).apply(typeof Gy<"u"?Gy:typeof self<"u"?self:typeof window<"u"?window:{});var hu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var m0,bl,g0,Eu,Tf,y0,v0,_0;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,g,_){return u==Array.prototype||u==Object.prototype||(u[g]=_.value),u};function t(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof hu=="object"&&hu];for(var g=0;g<u.length;++g){var _=u[g];if(_&&_.Math==Math)return _}throw Error("Cannot find global object")}var s=t(this);function a(u,g){if(g)e:{var _=s;u=u.split(".");for(var C=0;C<u.length-1;C++){var Y=u[C];if(!(Y in _))break e;_=_[Y]}u=u[u.length-1],C=_[u],g=g(C),g!=C&&g!=null&&e(_,u,{configurable:!0,writable:!0,value:g})}}function l(u,g){u instanceof String&&(u+="");var _=0,C=!1,Y={next:function(){if(!C&&_<u.length){var re=_++;return{value:g(re,u[re]),done:!1}}return C=!0,{done:!0,value:void 0}}};return Y[Symbol.iterator]=function(){return Y},Y}a("Array.prototype.values",function(u){return u||function(){return l(this,function(g,_){return _})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var d=d||{},f=this||self;function m(u){var g=typeof u;return g=g!="object"?g:u?Array.isArray(u)?"array":g:"null",g=="array"||g=="object"&&typeof u.length=="number"}function v(u){var g=typeof u;return g=="object"&&u!=null||g=="function"}function w(u,g,_){return u.call.apply(u.bind,arguments)}function S(u,g,_){if(!u)throw Error();if(2<arguments.length){var C=Array.prototype.slice.call(arguments,2);return function(){var Y=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Y,C),u.apply(g,Y)}}return function(){return u.apply(g,arguments)}}function I(u,g,_){return I=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?w:S,I.apply(null,arguments)}function U(u,g){var _=Array.prototype.slice.call(arguments,1);return function(){var C=_.slice();return C.push.apply(C,arguments),u.apply(this,C)}}function Z(u,g){function _(){}_.prototype=g.prototype,u.aa=g.prototype,u.prototype=new _,u.prototype.constructor=u,u.Qb=function(C,Y,re){for(var je=Array(arguments.length-2),Nt=2;Nt<arguments.length;Nt++)je[Nt-2]=arguments[Nt];return g.prototype[Y].apply(C,je)}}function Q(u){const g=u.length;if(0<g){const _=Array(g);for(let C=0;C<g;C++)_[C]=u[C];return _}return[]}function M(u,g){for(let _=1;_<arguments.length;_++){const C=arguments[_];if(m(C)){const Y=u.length||0,re=C.length||0;u.length=Y+re;for(let je=0;je<re;je++)u[Y+je]=C[je]}else u.push(C)}}class ne{constructor(g,_){this.i=g,this.j=_,this.h=0,this.g=null}get(){let g;return 0<this.h?(this.h--,g=this.g,this.g=g.next,g.next=null):g=this.i(),g}}function xe(u){return/^[\s\xa0]*$/.test(u)}function we(){var u=f.navigator;return u&&(u=u.userAgent)?u:""}function Ee(u){return Ee[" "](u),u}Ee[" "]=function(){};var le=we().indexOf("Gecko")!=-1&&!(we().toLowerCase().indexOf("webkit")!=-1&&we().indexOf("Edge")==-1)&&!(we().indexOf("Trident")!=-1||we().indexOf("MSIE")!=-1)&&we().indexOf("Edge")==-1;function Re(u,g,_){for(const C in u)g.call(_,u[C],C,u)}function A(u,g){for(const _ in u)g.call(void 0,u[_],_,u)}function P(u){const g={};for(const _ in u)g[_]=u[_];return g}const R="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function O(u,g){let _,C;for(let Y=1;Y<arguments.length;Y++){C=arguments[Y];for(_ in C)u[_]=C[_];for(let re=0;re<R.length;re++)_=R[re],Object.prototype.hasOwnProperty.call(C,_)&&(u[_]=C[_])}}function B(u){var g=1;u=u.split(":");const _=[];for(;0<g&&u.length;)_.push(u.shift()),g--;return u.length&&_.push(u.join(":")),_}function D(u){f.setTimeout(()=>{throw u},0)}function b(){var u=De;let g=null;return u.g&&(g=u.g,u.g=u.g.next,u.g||(u.h=null),g.next=null),g}class he{constructor(){this.h=this.g=null}add(g,_){const C=$e.get();C.set(g,_),this.h?this.h.next=C:this.g=C,this.h=C}}var $e=new ne(()=>new Ae,u=>u.reset());class Ae{constructor(){this.next=this.g=this.h=null}set(g,_){this.h=g,this.g=_,this.next=null}reset(){this.next=this.g=this.h=null}}let He,me=!1,De=new he,be=()=>{const u=f.Promise.resolve(void 0);He=()=>{u.then(K)}};var K=()=>{for(var u;u=b();){try{u.h.call(u.g)}catch(_){D(_)}var g=$e;g.j(u),100>g.h&&(g.h++,u.next=g.g,g.g=u)}me=!1};function N(){this.s=this.s,this.C=this.C}N.prototype.s=!1,N.prototype.ma=function(){this.s||(this.s=!0,this.N())},N.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function W(u,g){this.type=u,this.g=this.target=g,this.defaultPrevented=!1}W.prototype.h=function(){this.defaultPrevented=!0};var ee=(function(){if(!f.addEventListener||!Object.defineProperty)return!1;var u=!1,g=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const _=()=>{};f.addEventListener("test",_,g),f.removeEventListener("test",_,g)}catch{}return u})();function Te(u,g){if(W.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var _=this.type=u.type,C=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=g,g=u.relatedTarget){if(le){e:{try{Ee(g.nodeName);var Y=!0;break e}catch{}Y=!1}Y||(g=null)}}else _=="mouseover"?g=u.fromElement:_=="mouseout"&&(g=u.toElement);this.relatedTarget=g,C?(this.clientX=C.clientX!==void 0?C.clientX:C.pageX,this.clientY=C.clientY!==void 0?C.clientY:C.pageY,this.screenX=C.screenX||0,this.screenY=C.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:_e[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&Te.aa.h.call(this)}}Z(Te,W);var _e={2:"touch",3:"pen",4:"mouse"};Te.prototype.h=function(){Te.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var Le="closure_listenable_"+(1e6*Math.random()|0),qe=0;function rt(u,g,_,C,Y){this.listener=u,this.proxy=null,this.src=g,this.type=_,this.capture=!!C,this.ha=Y,this.key=++qe,this.da=this.fa=!1}function vt(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function fe(u){this.src=u,this.g={},this.h=0}fe.prototype.add=function(u,g,_,C,Y){var re=u.toString();u=this.g[re],u||(u=this.g[re]=[],this.h++);var je=ue(u,g,C,Y);return-1<je?(g=u[je],_||(g.fa=!1)):(g=new rt(g,this.src,re,!!C,Y),g.fa=_,u.push(g)),g};function We(u,g){var _=g.type;if(_ in u.g){var C=u.g[_],Y=Array.prototype.indexOf.call(C,g,void 0),re;(re=0<=Y)&&Array.prototype.splice.call(C,Y,1),re&&(vt(g),u.g[_].length==0&&(delete u.g[_],u.h--))}}function ue(u,g,_,C){for(var Y=0;Y<u.length;++Y){var re=u[Y];if(!re.da&&re.listener==g&&re.capture==!!_&&re.ha==C)return Y}return-1}var Qe="closure_lm_"+(1e6*Math.random()|0),Je={};function Rt(u,g,_,C,Y){if(Array.isArray(g)){for(var re=0;re<g.length;re++)Rt(u,g[re],_,C,Y);return null}return _=qn(_),u&&u[Le]?u.K(g,_,v(C)?!!C.capture:!1,Y):kt(u,g,_,!1,C,Y)}function kt(u,g,_,C,Y,re){if(!g)throw Error("Invalid event type");var je=v(Y)?!!Y.capture:!!Y,Nt=fr(u);if(Nt||(u[Qe]=Nt=new fe(u)),_=Nt.add(g,_,C,je,re),_.proxy)return _;if(C=St(),_.proxy=C,C.src=u,C.listener=_,u.addEventListener)ee||(Y=je),Y===void 0&&(Y=!1),u.addEventListener(g.toString(),C,Y);else if(u.attachEvent)u.attachEvent(Sn(g.toString()),C);else if(u.addListener&&u.removeListener)u.addListener(C);else throw Error("addEventListener and attachEvent are unavailable.");return _}function St(){function u(_){return g.call(u.src,u.listener,_)}const g=ln;return u}function jt(u,g,_,C,Y){if(Array.isArray(g))for(var re=0;re<g.length;re++)jt(u,g[re],_,C,Y);else C=v(C)?!!C.capture:!!C,_=qn(_),u&&u[Le]?(u=u.i,g=String(g).toString(),g in u.g&&(re=u.g[g],_=ue(re,_,C,Y),-1<_&&(vt(re[_]),Array.prototype.splice.call(re,_,1),re.length==0&&(delete u.g[g],u.h--)))):u&&(u=fr(u))&&(g=u.g[g.toString()],u=-1,g&&(u=ue(g,_,C,Y)),(_=-1<u?g[u]:null)&&on(_))}function on(u){if(typeof u!="number"&&u&&!u.da){var g=u.src;if(g&&g[Le])We(g.i,u);else{var _=u.type,C=u.proxy;g.removeEventListener?g.removeEventListener(_,C,u.capture):g.detachEvent?g.detachEvent(Sn(_),C):g.addListener&&g.removeListener&&g.removeListener(C),(_=fr(g))?(We(_,u),_.h==0&&(_.src=null,g[Qe]=null)):vt(u)}}}function Sn(u){return u in Je?Je[u]:Je[u]="on"+u}function ln(u,g){if(u.da)u=!0;else{g=new Te(g,this);var _=u.listener,C=u.ha||u.src;u.fa&&on(u),u=_.call(C,g)}return u}function fr(u){return u=u[Qe],u instanceof fe?u:null}var Xt="__closure_events_fn_"+(1e9*Math.random()>>>0);function qn(u){return typeof u=="function"?u:(u[Xt]||(u[Xt]=function(g){return u.handleEvent(g)}),u[Xt])}function Ot(){N.call(this),this.i=new fe(this),this.M=this,this.F=null}Z(Ot,N),Ot.prototype[Le]=!0,Ot.prototype.removeEventListener=function(u,g,_,C){jt(this,u,g,_,C)};function $t(u,g){var _,C=u.F;if(C)for(_=[];C;C=C.F)_.push(C);if(u=u.M,C=g.type||g,typeof g=="string")g=new W(g,u);else if(g instanceof W)g.target=g.target||u;else{var Y=g;g=new W(C,u),O(g,Y)}if(Y=!0,_)for(var re=_.length-1;0<=re;re--){var je=g.g=_[re];Y=On(je,C,!0,g)&&Y}if(je=g.g=u,Y=On(je,C,!0,g)&&Y,Y=On(je,C,!1,g)&&Y,_)for(re=0;re<_.length;re++)je=g.g=_[re],Y=On(je,C,!1,g)&&Y}Ot.prototype.N=function(){if(Ot.aa.N.call(this),this.i){var u=this.i,g;for(g in u.g){for(var _=u.g[g],C=0;C<_.length;C++)vt(_[C]);delete u.g[g],u.h--}}this.F=null},Ot.prototype.K=function(u,g,_,C){return this.i.add(String(u),g,!1,_,C)},Ot.prototype.L=function(u,g,_,C){return this.i.add(String(u),g,!0,_,C)};function On(u,g,_,C){if(g=u.i.g[String(g)],!g)return!0;g=g.concat();for(var Y=!0,re=0;re<g.length;++re){var je=g[re];if(je&&!je.da&&je.capture==_){var Nt=je.listener,_n=je.ha||je.src;je.fa&&We(u.i,je),Y=Nt.call(_n,C)!==!1&&Y}}return Y&&!C.defaultPrevented}function lr(u,g,_){if(typeof u=="function")_&&(u=I(u,_));else if(u&&typeof u.handleEvent=="function")u=I(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(g)?-1:f.setTimeout(u,g||0)}function Cn(u){u.g=lr(()=>{u.g=null,u.i&&(u.i=!1,Cn(u))},u.l);const g=u.h;u.h=null,u.m.apply(null,g)}class Mn extends N{constructor(g,_){super(),this.m=g,this.l=_,this.h=null,this.i=!1,this.g=null}j(g){this.h=arguments,this.g?this.i=!0:Cn(this)}N(){super.N(),this.g&&(f.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Qt(u){N.call(this),this.h=u,this.g={}}Z(Qt,N);var Zr=[];function In(u){Re(u.g,function(g,_){this.g.hasOwnProperty(_)&&on(g)},u),u.g={}}Qt.prototype.N=function(){Qt.aa.N.call(this),In(this)},Qt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var pn=f.JSON.stringify,es=f.JSON.parse,ws=class{stringify(u){return f.JSON.stringify(u,void 0)}parse(u){return f.JSON.parse(u,void 0)}};function It(){}It.prototype.h=null;function pr(u){return u.h||(u.h=u.i())}function xs(){}var Kn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Qn(){W.call(this,"d")}Z(Qn,W);function br(){W.call(this,"c")}Z(br,W);var bn={},Pr=null;function Yn(){return Pr=Pr||new Ot}bn.La="serverreachability";function $s(u){W.call(this,bn.La,u)}Z($s,W);function mr(u){const g=Yn();$t(g,new $s(g))}bn.STAT_EVENT="statevent";function Ws(u,g){W.call(this,bn.STAT_EVENT,u),this.stat=g}Z(Ws,W);function tt(u){const g=Yn();$t(g,new Ws(g,u))}bn.Ma="timingevent";function Jn(u,g){W.call(this,bn.Ma,u),this.size=g}Z(Jn,W);function Pn(u,g){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return f.setTimeout(function(){u()},g)}function ts(){this.g=!0}ts.prototype.xa=function(){this.g=!1};function Rn(u,g,_,C,Y,re){u.info(function(){if(u.g)if(re)for(var je="",Nt=re.split("&"),_n=0;_n<Nt.length;_n++){var wt=Nt[_n].split("=");if(1<wt.length){var kn=wt[0];wt=wt[1];var un=kn.split("_");je=2<=un.length&&un[1]=="type"?je+(kn+"="+wt+"&"):je+(kn+"=redacted&")}}else je=null;else je=re;return"XMLHTTP REQ ("+C+") [attempt "+Y+"]: "+g+`
`+_+`
`+je})}function mn(u,g,_,C,Y,re,je){u.info(function(){return"XMLHTTP RESP ("+C+") [ attempt "+Y+"]: "+g+`
`+_+`
`+re+" "+je})}function Nn(u,g,_,C){u.info(function(){return"XMLHTTP TEXT ("+g+"): "+Ts(u,_)+(C?" "+C:"")})}function Es(u,g){u.info(function(){return"TIMEOUT: "+g})}ts.prototype.info=function(){};function Ts(u,g){if(!u.g)return g;if(!g)return null;try{var _=JSON.parse(g);if(_){for(u=0;u<_.length;u++)if(Array.isArray(_[u])){var C=_[u];if(!(2>C.length)){var Y=C[1];if(Array.isArray(Y)&&!(1>Y.length)){var re=Y[0];if(re!="noop"&&re!="stop"&&re!="close")for(var je=1;je<Y.length;je++)Y[je]=""}}}}return pn(_)}catch{return g}}var Fn={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Fr={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Mt;function ns(){}Z(ns,It),ns.prototype.g=function(){return new XMLHttpRequest},ns.prototype.i=function(){return{}},Mt=new ns;function cn(u,g,_,C){this.j=u,this.i=g,this.l=_,this.R=C||1,this.U=new Qt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Rr}function Rr(){this.i=null,this.g="",this.h=!1}var Gs={},Ur={};function rs(u,g,_){u.L=1,u.v=Ss(Yt(g)),u.m=_,u.P=!0,gn(u,null)}function gn(u,g){u.F=Date.now(),ut(u),u.A=Yt(u.v);var _=u.A,C=u.R;Array.isArray(C)||(C=[String(C)]),Dt(_.i,"t",C),u.C=0,_=u.j.J,u.h=new Rr,u.g=mc(u.j,_?g:null,!u.m),0<u.O&&(u.M=new Mn(I(u.Y,u,u.g),u.O)),g=u.U,_=u.g,C=u.ca;var Y="readystatechange";Array.isArray(Y)||(Y&&(Zr[0]=Y.toString()),Y=Zr);for(var re=0;re<Y.length;re++){var je=Rt(_,Y[re],C||g.handleEvent,!1,g.h||g);if(!je)break;g.g[je.key]=je}g=u.H?P(u.H):{},u.m?(u.u||(u.u="POST"),g["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,g)):(u.u="GET",u.g.ea(u.A,u.u,null,g)),mr(),Rn(u.i,u.u,u.A,u.l,u.R,u.m)}cn.prototype.ca=function(u){u=u.target;const g=this.M;g&&gr(u)==3?g.j():this.Y(u)},cn.prototype.Y=function(u){try{if(u==this.g)e:{const un=gr(this.g);var g=this.g.Ba();const Br=this.g.Z();if(!(3>un)&&(un!=3||this.g&&(this.h.h||this.g.oa()||Qo(this.g)))){this.J||un!=4||g==7||(g==8||0>=Br?mr(3):mr(2)),An(this);var _=this.g.Z();this.X=_;t:if(Hs(this)){var C=Qo(this.g);u="";var Y=C.length,re=gr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){$(this),x(this);var je="";break t}this.h.i=new f.TextDecoder}for(g=0;g<Y;g++)this.h.h=!0,u+=this.h.i.decode(C[g],{stream:!(re&&g==Y-1)});C.length=0,this.h.g+=u,this.C=0,je=this.h.g}else je=this.g.oa();if(this.o=_==200,mn(this.i,this.u,this.A,this.l,this.R,un,_),this.o){if(this.T&&!this.K){t:{if(this.g){var Nt,_n=this.g;if((Nt=_n.g?_n.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!xe(Nt)){var wt=Nt;break t}}wt=null}if(_=wt)Nn(this.i,this.l,_,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,z(this,_);else{this.o=!1,this.s=3,tt(12),$(this),x(this);break e}}if(this.P){_=!0;let jr;for(;!this.J&&this.C<je.length;)if(jr=qs(this,je),jr==Ur){un==4&&(this.s=4,tt(14),_=!1),Nn(this.i,this.l,null,"[Incomplete Response]");break}else if(jr==Gs){this.s=4,tt(15),Nn(this.i,this.l,je,"[Invalid Chunk]"),_=!1;break}else Nn(this.i,this.l,jr,null),z(this,jr);if(Hs(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),un!=4||je.length!=0||this.h.h||(this.s=1,tt(16),_=!1),this.o=this.o&&_,!_)Nn(this.i,this.l,je,"[Invalid Chunked Response]"),$(this),x(this);else if(0<je.length&&!this.W){this.W=!0;var kn=this.j;kn.g==this&&kn.ba&&!kn.M&&(kn.j.info("Great, no buffering proxy detected. Bytes received: "+je.length),Jo(kn),kn.M=!0,tt(11))}}else Nn(this.i,this.l,je,null),z(this,je);un==4&&$(this),this.o&&!this.J&&(un==4?Ga(this.j,this):(this.o=!1,ut(this)))}else Ua(this.g),_==400&&0<je.indexOf("Unknown SID")?(this.s=3,tt(12)):(this.s=0,tt(13)),$(this),x(this)}}}catch{}finally{}};function Hs(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function qs(u,g){var _=u.C,C=g.indexOf(`
`,_);return C==-1?Ur:(_=Number(g.substring(_,C)),isNaN(_)?Gs:(C+=1,C+_>g.length?Ur:(g=g.slice(C,C+_),u.C=C+_,g)))}cn.prototype.cancel=function(){this.J=!0,$(this)};function ut(u){u.S=Date.now()+u.I,ss(u,u.I)}function ss(u,g){if(u.B!=null)throw Error("WatchDog timer not null");u.B=Pn(I(u.ba,u),g)}function An(u){u.B&&(f.clearTimeout(u.B),u.B=null)}cn.prototype.ba=function(){this.B=null;const u=Date.now();0<=u-this.S?(Es(this.i,this.A),this.L!=2&&(mr(),tt(17)),$(this),this.s=2,x(this)):ss(this,this.S-u)};function x(u){u.j.G==0||u.J||Ga(u.j,u)}function $(u){An(u);var g=u.M;g&&typeof g.ma=="function"&&g.ma(),u.M=null,In(u.U),u.g&&(g=u.g,u.g=null,g.abort(),g.ma())}function z(u,g){try{var _=u.j;if(_.G!=0&&(_.g==u||Se(_.h,u))){if(!u.K&&Se(_.h,u)&&_.G==3){try{var C=_.Da.g.parse(g)}catch{C=null}if(Array.isArray(C)&&C.length==3){var Y=C;if(Y[0]==0){e:if(!_.u){if(_.g)if(_.g.F+3e3<u.F)Wa(_),cs(_);else break e;$a(_),tt(18)}}else _.za=Y[1],0<_.za-_.T&&37500>Y[2]&&_.F&&_.v==0&&!_.C&&(_.C=Pn(I(_.Za,_),6e3));if(1>=se(_.h)&&_.ca){try{_.ca()}catch{}_.ca=void 0}}else Js(_,11)}else if((u.K||_.g==u)&&Wa(_),!xe(g))for(Y=_.Da.g.parse(g),g=0;g<Y.length;g++){let wt=Y[g];if(_.T=wt[0],wt=wt[1],_.G==2)if(wt[0]=="c"){_.K=wt[1],_.ia=wt[2];const kn=wt[3];kn!=null&&(_.la=kn,_.j.info("VER="+_.la));const un=wt[4];un!=null&&(_.Aa=un,_.j.info("SVER="+_.Aa));const Br=wt[5];Br!=null&&typeof Br=="number"&&0<Br&&(C=1.5*Br,_.L=C,_.j.info("backChannelRequestTimeoutMs_="+C)),C=_;const jr=u.g;if(jr){const ua=jr.g?jr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ua){var re=C.h;re.g||ua.indexOf("spdy")==-1&&ua.indexOf("quic")==-1&&ua.indexOf("h2")==-1||(re.j=re.l,re.g=new Set,re.h&&(Ce(re,re.h),re.h=null))}if(C.D){const qa=jr.g?jr.g.getResponseHeader("X-HTTP-Session-Id"):null;qa&&(C.ya=qa,bt(C.I,C.D,qa))}}_.G=3,_.l&&_.l.ua(),_.ba&&(_.R=Date.now()-u.F,_.j.info("Handshake RTT: "+_.R+"ms")),C=_;var je=u;if(C.qa=pc(C,C.J?C.ia:null,C.W),je.K){Ne(C.h,je);var Nt=je,_n=C.L;_n&&(Nt.I=_n),Nt.B&&(An(Nt),ut(Nt)),C.g=je}else ca(C);0<_.i.length&&bs(_)}else wt[0]!="stop"&&wt[0]!="close"||Js(_,7);else _.G==3&&(wt[0]=="stop"||wt[0]=="close"?wt[0]=="stop"?Js(_,7):zn(_):wt[0]!="noop"&&_.l&&_.l.ta(wt),_.v=0)}}mr(4)}catch{}}var L=class{constructor(u,g){this.g=u,this.map=g}};function q(u){this.l=u||10,f.PerformanceNavigationTiming?(u=f.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(f.chrome&&f.chrome.loadTimes&&f.chrome.loadTimes()&&f.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function ie(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function se(u){return u.h?1:u.g?u.g.size:0}function Se(u,g){return u.h?u.h==g:u.g?u.g.has(g):!1}function Ce(u,g){u.g?u.g.add(g):u.h=g}function Ne(u,g){u.h&&u.h==g?u.h=null:u.g&&u.g.has(g)&&u.g.delete(g)}q.prototype.cancel=function(){if(this.i=ae(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function ae(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let g=u.i;for(const _ of u.g.values())g=g.concat(_.D);return g}return Q(u.i)}function it(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(m(u)){for(var g=[],_=u.length,C=0;C<_;C++)g.push(u[C]);return g}g=[],_=0;for(C in u)g[_++]=u[C];return g}function ke(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(m(u)||typeof u=="string"){var g=[];u=u.length;for(var _=0;_<u;_++)g.push(_);return g}g=[],_=0;for(const C in u)g[_++]=C;return g}}}function dt(u,g){if(u.forEach&&typeof u.forEach=="function")u.forEach(g,void 0);else if(m(u)||typeof u=="string")Array.prototype.forEach.call(u,g,void 0);else for(var _=ke(u),C=it(u),Y=C.length,re=0;re<Y;re++)g.call(void 0,C[re],_&&_[re],u)}var cr=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ks(u,g){if(u){u=u.split("&");for(var _=0;_<u.length;_++){var C=u[_].indexOf("="),Y=null;if(0<=C){var re=u[_].substring(0,C);Y=u[_].substring(C+1)}else re=u[_];g(re,Y?decodeURIComponent(Y.replace(/\+/g," ")):"")}}}function yn(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof yn){this.h=u.h,is(this,u.j),this.o=u.o,this.g=u.g,as(this,u.s),this.l=u.l;var g=u.i,_=new Ie;_.i=g.i,g.g&&(_.g=new Map(g.g),_.h=g.h),os(this,_),this.m=u.m}else u&&(g=String(u).match(cr))?(this.h=!1,is(this,g[1]||"",!0),this.o=ft(g[2]||""),this.g=ft(g[3]||"",!0),as(this,g[4]),this.l=ft(g[5]||"",!0),os(this,g[6]||"",!0),this.m=ft(g[7]||"")):(this.h=!1,this.i=new Ie(null,this.h))}yn.prototype.toString=function(){var u=[],g=this.j;g&&u.push(Cs(g,V,!0),":");var _=this.g;return(_||g=="file")&&(u.push("//"),(g=this.o)&&u.push(Cs(g,V,!0),"@"),u.push(encodeURIComponent(String(_)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_=this.s,_!=null&&u.push(":",String(_))),(_=this.l)&&(this.g&&_.charAt(0)!="/"&&u.push("/"),u.push(Cs(_,_.charAt(0)=="/"?oe:H,!0))),(_=this.i.toString())&&u.push("?",_),(_=this.m)&&u.push("#",Cs(_,Ue)),u.join("")};function Yt(u){return new yn(u)}function is(u,g,_){u.j=_?ft(g,!0):g,u.j&&(u.j=u.j.replace(/:$/,""))}function as(u,g){if(g){if(g=Number(g),isNaN(g)||0>g)throw Error("Bad port number "+g);u.s=g}else u.s=null}function os(u,g,_){g instanceof Ie?(u.i=g,Zt(u.i,u.h)):(_||(g=Cs(g,ye)),u.i=new Ie(g,u.h))}function bt(u,g,_){u.i.set(g,_)}function Ss(u){return bt(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function ft(u,g){return u?g?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function Cs(u,g,_){return typeof u=="string"?(u=encodeURI(u).replace(g,T),_&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function T(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var V=/[#\/\?@]/g,H=/[#\?:]/g,oe=/[#\?]/g,ye=/[#\?@]/g,Ue=/#/g;function Ie(u,g){this.h=this.g=null,this.i=u||null,this.j=!!g}function Ke(u){u.g||(u.g=new Map,u.h=0,u.i&&Ks(u.i,function(g,_){u.add(decodeURIComponent(g.replace(/\+/g," ")),_)}))}n=Ie.prototype,n.add=function(u,g){Ke(this),this.i=null,u=Et(this,u);var _=this.g.get(u);return _||this.g.set(u,_=[]),_.push(g),this.h+=1,this};function ct(u,g){Ke(u),g=Et(u,g),u.g.has(g)&&(u.i=null,u.h-=u.g.get(g).length,u.g.delete(g))}function mt(u,g){return Ke(u),g=Et(u,g),u.g.has(g)}n.forEach=function(u,g){Ke(this),this.g.forEach(function(_,C){_.forEach(function(Y){u.call(g,Y,C,this)},this)},this)},n.na=function(){Ke(this);const u=Array.from(this.g.values()),g=Array.from(this.g.keys()),_=[];for(let C=0;C<g.length;C++){const Y=u[C];for(let re=0;re<Y.length;re++)_.push(g[C])}return _},n.V=function(u){Ke(this);let g=[];if(typeof u=="string")mt(this,u)&&(g=g.concat(this.g.get(Et(this,u))));else{u=Array.from(this.g.values());for(let _=0;_<u.length;_++)g=g.concat(u[_])}return g},n.set=function(u,g){return Ke(this),this.i=null,u=Et(this,u),mt(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[g]),this.h+=1,this},n.get=function(u,g){return u?(u=this.V(u),0<u.length?String(u[0]):g):g};function Dt(u,g,_){ct(u,g),0<_.length&&(u.i=null,u.g.set(Et(u,g),Q(_)),u.h+=_.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],g=Array.from(this.g.keys());for(var _=0;_<g.length;_++){var C=g[_];const re=encodeURIComponent(String(C)),je=this.V(C);for(C=0;C<je.length;C++){var Y=re;je[C]!==""&&(Y+="="+encodeURIComponent(String(je[C]))),u.push(Y)}}return this.i=u.join("&")};function Et(u,g){return g=String(g),u.j&&(g=g.toLowerCase()),g}function Zt(u,g){g&&!u.j&&(Ke(u),u.i=null,u.g.forEach(function(_,C){var Y=C.toLowerCase();C!=Y&&(ct(this,C),Dt(this,Y,_))},u)),u.j=g}function vn(u,g){const _=new ts;if(f.Image){const C=new Image;C.onload=U(en,_,"TestLoadImage: loaded",!0,g,C),C.onerror=U(en,_,"TestLoadImage: error",!1,g,C),C.onabort=U(en,_,"TestLoadImage: abort",!1,g,C),C.ontimeout=U(en,_,"TestLoadImage: timeout",!1,g,C),f.setTimeout(function(){C.ontimeout&&C.ontimeout()},1e4),C.src=u}else g(!1)}function _t(u,g){const _=new ts,C=new AbortController,Y=setTimeout(()=>{C.abort(),en(_,"TestPingServer: timeout",!1,g)},1e4);fetch(u,{signal:C.signal}).then(re=>{clearTimeout(Y),re.ok?en(_,"TestPingServer: ok",!0,g):en(_,"TestPingServer: server error",!1,g)}).catch(()=>{clearTimeout(Y),en(_,"TestPingServer: error",!1,g)})}function en(u,g,_,C,Y){try{Y&&(Y.onload=null,Y.onerror=null,Y.onabort=null,Y.ontimeout=null),C(_)}catch{}}function Xn(){this.g=new ws}function zr(u,g,_){const C=_||"";try{dt(u,function(Y,re){let je=Y;v(Y)&&(je=pn(Y)),g.push(C+re+"="+encodeURIComponent(je))})}catch(Y){throw g.push(C+"type="+encodeURIComponent("_badmap")),Y}}function Nr(u){this.l=u.Ub||null,this.j=u.eb||!1}Z(Nr,It),Nr.prototype.g=function(){return new Qs(this.l,this.j)},Nr.prototype.i=(function(u){return function(){return u}})({});function Qs(u,g){Ot.call(this),this.D=u,this.o=g,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}Z(Qs,Ot),n=Qs.prototype,n.open=function(u,g){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=g,this.readyState=1,Un(this)},n.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const g={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(g.body=u),(this.D||f).fetch(new Request(this.A,g)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ar(this)),this.readyState=0},n.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,Un(this)),this.g&&(this.readyState=3,Un(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof f.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Oa(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function Oa(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}n.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var g=u.value?u.value:new Uint8Array(0);(g=this.v.decode(g,{stream:!u.done}))&&(this.response=this.responseText+=g)}u.done?Ar(this):Un(this),this.readyState==3&&Oa(this)}},n.Ra=function(u){this.g&&(this.response=this.responseText=u,Ar(this))},n.Qa=function(u){this.g&&(this.response=u,Ar(this))},n.ga=function(){this.g&&Ar(this)};function Ar(u){u.readyState=4,u.l=null,u.j=null,u.v=null,Un(u)}n.setRequestHeader=function(u,g){this.u.append(u,g)},n.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],g=this.h.entries();for(var _=g.next();!_.done;)_=_.value,u.push(_[0]+": "+_[1]),_=g.next();return u.join(`\r
`)};function Un(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(Qs.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function ls(u){let g="";return Re(u,function(_,C){g+=C,g+=":",g+=_,g+=`\r
`}),g}function wi(u,g,_){e:{for(C in _){var C=!1;break e}C=!0}C||(_=ls(_),typeof u=="string"?_!=null&&encodeURIComponent(String(_)):bt(u,g,_))}function Wt(u){Ot.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}Z(Wt,Ot);var Sd=/^https?$/i,qo=["POST","PUT"];n=Wt.prototype,n.Ha=function(u){this.J=u},n.ea=function(u,g,_,C){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);g=g?g.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Mt.g(),this.v=this.o?pr(this.o):pr(Mt),this.g.onreadystatechange=I(this.Ea,this);try{this.B=!0,this.g.open(g,String(u),!0),this.B=!1}catch(re){la(this,re);return}if(u=_||"",_=new Map(this.headers),C)if(Object.getPrototypeOf(C)===Object.prototype)for(var Y in C)_.set(Y,C[Y]);else if(typeof C.keys=="function"&&typeof C.get=="function")for(const re of C.keys())_.set(re,C.get(re));else throw Error("Unknown input type for opt_headers: "+String(C));C=Array.from(_.keys()).find(re=>re.toLowerCase()=="content-type"),Y=f.FormData&&u instanceof f.FormData,!(0<=Array.prototype.indexOf.call(qo,g,void 0))||C||Y||_.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[re,je]of _)this.g.setRequestHeader(re,je);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Fa(this),this.u=!0,this.g.send(u),this.u=!1}catch(re){la(this,re)}};function la(u,g){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=g,u.m=5,Ma(u),kr(u)}function Ma(u){u.A||(u.A=!0,$t(u,"complete"),$t(u,"error"))}n.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,$t(this,"complete"),$t(this,"abort"),kr(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),kr(this,!0)),Wt.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Ko(this):this.bb())},n.bb=function(){Ko(this)};function Ko(u){if(u.h&&typeof d<"u"&&(!u.v[1]||gr(u)!=4||u.Z()!=2)){if(u.u&&gr(u)==4)lr(u.Ea,0,u);else if($t(u,"readystatechange"),gr(u)==4){u.h=!1;try{const je=u.Z();e:switch(je){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var g=!0;break e;default:g=!1}var _;if(!(_=g)){var C;if(C=je===0){var Y=String(u.D).match(cr)[1]||null;!Y&&f.self&&f.self.location&&(Y=f.self.location.protocol.slice(0,-1)),C=!Sd.test(Y?Y.toLowerCase():"")}_=C}if(_)$t(u,"complete"),$t(u,"success");else{u.m=6;try{var re=2<gr(u)?u.g.statusText:""}catch{re=""}u.l=re+" ["+u.Z()+"]",Ma(u)}}finally{kr(u)}}}}function kr(u,g){if(u.g){Fa(u);const _=u.g,C=u.v[0]?()=>{}:null;u.g=null,u.v=null,g||$t(u,"ready");try{_.onreadystatechange=C}catch{}}}function Fa(u){u.I&&(f.clearTimeout(u.I),u.I=null)}n.isActive=function(){return!!this.g};function gr(u){return u.g?u.g.readyState:0}n.Z=function(){try{return 2<gr(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(u){if(this.g){var g=this.g.responseText;return u&&g.indexOf(u)==0&&(g=g.substring(u.length)),es(g)}};function Qo(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function Ua(u){const g={};u=(u.g&&2<=gr(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let C=0;C<u.length;C++){if(xe(u[C]))continue;var _=B(u[C]);const Y=_[0];if(_=_[1],typeof _!="string")continue;_=_.trim();const re=g[Y]||[];g[Y]=re,re.push(_)}A(g,function(C){return C.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Is(u,g,_){return _&&_.internalChannelParams&&_.internalChannelParams[u]||g}function Yo(u){this.Aa=0,this.i=[],this.j=new ts,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Is("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Is("baseRetryDelayMs",5e3,u),this.cb=Is("retryDelaySeedMs",1e4,u),this.Wa=Is("forwardChannelMaxRetries",2,u),this.wa=Is("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new q(u&&u.concurrentRequestLimit),this.Da=new Xn,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Yo.prototype,n.la=8,n.G=1,n.connect=function(u,g,_,C){tt(0),this.W=u,this.H=g||{},_&&C!==void 0&&(this.H.OSID=_,this.H.OAID=C),this.F=this.X,this.I=pc(this,null,this.W),bs(this)};function zn(u){if(za(u),u.G==3){var g=u.U++,_=Yt(u.I);if(bt(_,"SID",u.K),bt(_,"RID",g),bt(_,"TYPE","terminate"),Ys(u,_),g=new cn(u,u.j,g),g.L=2,g.v=Ss(Yt(_)),_=!1,f.navigator&&f.navigator.sendBeacon)try{_=f.navigator.sendBeacon(g.v.toString(),"")}catch{}!_&&f.Image&&(new Image().src=g.v,_=!0),_||(g.g=mc(g.j,null),g.g.ea(g.v)),g.F=Date.now(),ut(g)}fc(u)}function cs(u){u.g&&(Jo(u),u.g.cancel(),u.g=null)}function za(u){cs(u),u.u&&(f.clearTimeout(u.u),u.u=null),Wa(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&f.clearTimeout(u.s),u.s=null)}function bs(u){if(!ie(u.h)&&!u.s){u.s=!0;var g=u.Ga;He||be(),me||(He(),me=!0),De.add(g,u),u.B=0}}function Cd(u,g){return se(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=g.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=Pn(I(u.Ga,u,g),hc(u,u.B)),u.B++,!0)}n.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;const Y=new cn(this,this.j,u);let re=this.o;if(this.S&&(re?(re=P(re),O(re,this.S)):re=this.S),this.m!==null||this.O||(Y.H=re,re=null),this.P)e:{for(var g=0,_=0;_<this.i.length;_++){t:{var C=this.i[_];if("__data__"in C.map&&(C=C.map.__data__,typeof C=="string")){C=C.length;break t}C=void 0}if(C===void 0)break;if(g+=C,4096<g){g=_;break e}if(g===4096||_===this.i.length-1){g=_+1;break e}}g=1e3}else g=1e3;g=xi(this,Y,g),_=Yt(this.I),bt(_,"RID",u),bt(_,"CVER",22),this.D&&bt(_,"X-HTTP-Session-Id",this.D),Ys(this,_),re&&(this.O?g="headers="+encodeURIComponent(String(ls(re)))+"&"+g:this.m&&wi(_,this.m,re)),Ce(this.h,Y),this.Ua&&bt(_,"TYPE","init"),this.P?(bt(_,"$req",g),bt(_,"SID","null"),Y.T=!0,rs(Y,_,null)):rs(Y,_,g),this.G=2}}else this.G==3&&(u?Ba(this,u):this.i.length==0||ie(this.h)||Ba(this))};function Ba(u,g){var _;g?_=g.l:_=u.U++;const C=Yt(u.I);bt(C,"SID",u.K),bt(C,"RID",_),bt(C,"AID",u.T),Ys(u,C),u.m&&u.o&&wi(C,u.m,u.o),_=new cn(u,u.j,_,u.B+1),u.m===null&&(_.H=u.o),g&&(u.i=g.D.concat(u.i)),g=xi(u,_,1e3),_.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),Ce(u.h,_),rs(_,C,g)}function Ys(u,g){u.H&&Re(u.H,function(_,C){bt(g,C,_)}),u.l&&dt({},function(_,C){bt(g,C,_)})}function xi(u,g,_){_=Math.min(u.i.length,_);var C=u.l?I(u.l.Na,u.l,u):null;e:{var Y=u.i;let re=-1;for(;;){const je=["count="+_];re==-1?0<_?(re=Y[0].g,je.push("ofs="+re)):re=0:je.push("ofs="+re);let Nt=!0;for(let _n=0;_n<_;_n++){let wt=Y[_n].g;const kn=Y[_n].map;if(wt-=re,0>wt)re=Math.max(0,Y[_n].g-100),Nt=!1;else try{zr(kn,je,"req"+wt+"_")}catch{C&&C(kn)}}if(Nt){C=je.join("&");break e}}}return u=u.i.splice(0,_),g.D=u,C}function ca(u){if(!u.g&&!u.u){u.Y=1;var g=u.Fa;He||be(),me||(He(),me=!0),De.add(g,u),u.v=0}}function $a(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=Pn(I(u.Fa,u),hc(u,u.v)),u.v++,!0)}n.Fa=function(){if(this.u=null,dc(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=Pn(I(this.ab,this),u)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,tt(10),cs(this),dc(this))};function Jo(u){u.A!=null&&(f.clearTimeout(u.A),u.A=null)}function dc(u){u.g=new cn(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var g=Yt(u.qa);bt(g,"RID","rpc"),bt(g,"SID",u.K),bt(g,"AID",u.T),bt(g,"CI",u.F?"0":"1"),!u.F&&u.ja&&bt(g,"TO",u.ja),bt(g,"TYPE","xmlhttp"),Ys(u,g),u.m&&u.o&&wi(g,u.m,u.o),u.L&&(u.g.I=u.L);var _=u.g;u=u.ia,_.L=1,_.v=Ss(Yt(g)),_.m=null,_.P=!0,gn(_,u)}n.Za=function(){this.C!=null&&(this.C=null,cs(this),$a(this),tt(19))};function Wa(u){u.C!=null&&(f.clearTimeout(u.C),u.C=null)}function Ga(u,g){var _=null;if(u.g==g){Wa(u),Jo(u),u.g=null;var C=2}else if(Se(u.h,g))_=g.D,Ne(u.h,g),C=1;else return;if(u.G!=0){if(g.o)if(C==1){_=g.m?g.m.length:0,g=Date.now()-g.F;var Y=u.B;C=Yn(),$t(C,new Jn(C,_)),bs(u)}else ca(u);else if(Y=g.s,Y==3||Y==0&&0<g.X||!(C==1&&Cd(u,g)||C==2&&$a(u)))switch(_&&0<_.length&&(g=u.h,g.i=g.i.concat(_)),Y){case 1:Js(u,5);break;case 4:Js(u,10);break;case 3:Js(u,6);break;default:Js(u,2)}}}function hc(u,g){let _=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(_*=2),_*g}function Js(u,g){if(u.j.info("Error code "+g),g==2){var _=I(u.fb,u),C=u.Xa;const Y=!C;C=new yn(C||"//www.google.com/images/cleardot.gif"),f.location&&f.location.protocol=="http"||is(C,"https"),Ss(C),Y?vn(C.toString(),_):_t(C.toString(),_)}else tt(2);u.G=0,u.l&&u.l.sa(g),fc(u),za(u)}n.fb=function(u){u?(this.j.info("Successfully pinged google.com"),tt(2)):(this.j.info("Failed to ping google.com"),tt(1))};function fc(u){if(u.G=0,u.ka=[],u.l){const g=ae(u.h);(g.length!=0||u.i.length!=0)&&(M(u.ka,g),M(u.ka,u.i),u.h.i.length=0,Q(u.i),u.i.length=0),u.l.ra()}}function pc(u,g,_){var C=_ instanceof yn?Yt(_):new yn(_);if(C.g!="")g&&(C.g=g+"."+C.g),as(C,C.s);else{var Y=f.location;C=Y.protocol,g=g?g+"."+Y.hostname:Y.hostname,Y=+Y.port;var re=new yn(null);C&&is(re,C),g&&(re.g=g),Y&&as(re,Y),_&&(re.l=_),C=re}return _=u.D,g=u.ya,_&&g&&bt(C,_,g),bt(C,"VER",u.la),Ys(u,C),C}function mc(u,g,_){if(g&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return g=u.Ca&&!u.pa?new Wt(new Nr({eb:_})):new Wt(u.pa),g.Ha(u.J),g}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Xo(){}n=Xo.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Ha(){}Ha.prototype.g=function(u,g){return new ur(u,g)};function ur(u,g){Ot.call(this),this.g=new Yo(g),this.l=u,this.h=g&&g.messageUrlParams||null,u=g&&g.messageHeaders||null,g&&g.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=g&&g.initMessageHeaders||null,g&&g.messageContentType&&(u?u["X-WebChannel-Content-Type"]=g.messageContentType:u={"X-WebChannel-Content-Type":g.messageContentType}),g&&g.va&&(u?u["X-WebChannel-Client-Profile"]=g.va:u={"X-WebChannel-Client-Profile":g.va}),this.g.S=u,(u=g&&g.Sb)&&!xe(u)&&(this.g.m=u),this.v=g&&g.supportsCrossDomainXhr||!1,this.u=g&&g.sendRawJson||!1,(g=g&&g.httpSessionIdParam)&&!xe(g)&&(this.g.D=g,u=this.h,u!==null&&g in u&&(u=this.h,g in u&&delete u[g])),this.j=new Ps(this)}Z(ur,Ot),ur.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},ur.prototype.close=function(){zn(this.g)},ur.prototype.o=function(u){var g=this.g;if(typeof u=="string"){var _={};_.__data__=u,u=_}else this.u&&(_={},_.__data__=pn(u),u=_);g.i.push(new L(g.Ya++,u)),g.G==3&&bs(g)},ur.prototype.N=function(){this.g.l=null,delete this.j,zn(this.g),delete this.g,ur.aa.N.call(this)};function gc(u){Qn.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var g=u.__sm__;if(g){e:{for(const _ in g){u=_;break e}u=void 0}(this.i=u)&&(u=this.i,g=g!==null&&u in g?g[u]:void 0),this.data=g}else this.data=u}Z(gc,Qn);function yc(){br.call(this),this.status=1}Z(yc,br);function Ps(u){this.g=u}Z(Ps,Xo),Ps.prototype.ua=function(){$t(this.g,"a")},Ps.prototype.ta=function(u){$t(this.g,new gc(u))},Ps.prototype.sa=function(u){$t(this.g,new yc)},Ps.prototype.ra=function(){$t(this.g,"b")},Ha.prototype.createWebChannel=Ha.prototype.g,ur.prototype.send=ur.prototype.o,ur.prototype.open=ur.prototype.m,ur.prototype.close=ur.prototype.close,_0=function(){return new Ha},v0=function(){return Yn()},y0=bn,Tf={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Fn.NO_ERROR=0,Fn.TIMEOUT=8,Fn.HTTP_ERROR=6,Eu=Fn,Fr.COMPLETE="complete",g0=Fr,xs.EventType=Kn,Kn.OPEN="a",Kn.CLOSE="b",Kn.ERROR="c",Kn.MESSAGE="d",Ot.prototype.listen=Ot.prototype.K,bl=xs,Wt.prototype.listenOnce=Wt.prototype.L,Wt.prototype.getLastError=Wt.prototype.Ka,Wt.prototype.getLastErrorCode=Wt.prototype.Ba,Wt.prototype.getStatus=Wt.prototype.Z,Wt.prototype.getResponseJson=Wt.prototype.Oa,Wt.prototype.getResponseText=Wt.prototype.oa,Wt.prototype.send=Wt.prototype.ea,Wt.prototype.setWithCredentials=Wt.prototype.Ha,m0=Wt}).apply(typeof hu<"u"?hu:typeof self<"u"?self:typeof window<"u"?window:{});const Hy="@firebase/firestore",qy="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}sr.UNAUTHENTICATED=new sr(null),sr.GOOGLE_CREDENTIALS=new sr("google-credentials-uid"),sr.FIRST_PARTY=new sr("first-party-uid"),sr.MOCK_USER=new sr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bo="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ja=new qf("@firebase/firestore");function vo(){return ja.logLevel}function Oe(n,...e){if(ja.logLevel<=gt.DEBUG){const t=e.map(op);ja.debug(`Firestore (${Bo}): ${n}`,...t)}}function mi(n,...e){if(ja.logLevel<=gt.ERROR){const t=e.map(op);ja.error(`Firestore (${Bo}): ${n}`,...t)}}function Qi(n,...e){if(ja.logLevel<=gt.WARN){const t=e.map(op);ja.warn(`Firestore (${Bo}): ${n}`,...t)}}function op(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nt(n,e,t){let s="Unexpected state";typeof e=="string"?s=e:t=e,w0(n,s,t)}function w0(n,e,t){let s=`FIRESTORE (${Bo}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{s+=" CONTEXT: "+JSON.stringify(t)}catch{s+=" CONTEXT: "+t}throw mi(s),new Error(s)}function Pt(n,e,t,s){let a="Unexpected state";typeof t=="string"?a=t:s=t,n||w0(e,a,s)}function ot(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const de={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Be extends _i{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class di{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x0{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class pI{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(sr.UNAUTHENTICATED)))}shutdown(){}}class mI{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class gI{constructor(e){this.t=e,this.currentUser=sr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Pt(this.o===void 0,42304);let s=this.i;const a=m=>this.i!==s?(s=this.i,t(m)):Promise.resolve();let l=new di;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new di,e.enqueueRetryable((()=>a(this.currentUser)))};const d=()=>{const m=l;e.enqueueRetryable((async()=>{await m.promise,await a(this.currentUser)}))},f=m=>{Oe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=m,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit((m=>f(m))),setTimeout((()=>{if(!this.auth){const m=this.t.getImmediate({optional:!0});m?f(m):(Oe("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new di)}}),0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((s=>this.i!==e?(Oe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(Pt(typeof s.accessToken=="string",31837,{l:s}),new x0(s.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Pt(e===null||typeof e=="string",2055,{h:e}),new sr(e)}}class yI{constructor(e,t,s){this.P=e,this.T=t,this.I=s,this.type="FirstParty",this.user=sr.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class vI{constructor(e,t,s){this.P=e,this.T=t,this.I=s}getToken(){return Promise.resolve(new yI(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(sr.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Ky{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class _I{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Or(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Pt(this.o===void 0,3512);const s=l=>{l.error!=null&&Oe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const d=l.token!==this.m;return this.m=l.token,Oe("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?t(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable((()=>s(l)))};const a=l=>{Oe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((l=>a(l))),setTimeout((()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?a(l):Oe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new Ky(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Pt(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Ky(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wI(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let s=0;s<n;s++)t[s]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E0(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lp{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let s="";for(;s.length<20;){const a=wI(40);for(let l=0;l<a.length;++l)s.length<20&&a[l]<t&&(s+=e.charAt(a[l]%62))}return s}}function ht(n,e){return n<e?-1:n>e?1:0}function Sf(n,e){let t=0;for(;t<n.length&&t<e.length;){const s=n.codePointAt(t),a=e.codePointAt(t);if(s!==a){if(s<128&&a<128)return ht(s,a);{const l=E0(),d=xI(l.encode(Qy(n,t)),l.encode(Qy(e,t)));return d!==0?d:ht(s,a)}}t+=s>65535?2:1}return ht(n.length,e.length)}function Qy(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function xI(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return ht(n[t],e[t]);return ht(n.length,e.length)}function Ao(n,e,t){return n.length===e.length&&n.every(((s,a)=>t(s,e[a])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yy="__name__";class js{constructor(e,t,s){t===void 0?t=0:t>e.length&&nt(637,{offset:t,range:e.length}),s===void 0?s=e.length-t:s>e.length-t&&nt(1746,{length:s,range:e.length-t}),this.segments=e,this.offset=t,this.len=s}get length(){return this.len}isEqual(e){return js.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof js?e.forEach((s=>{t.push(s)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,s=this.limit();t<s;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const s=Math.min(e.length,t.length);for(let a=0;a<s;a++){const l=js.compareSegments(e.get(a),t.get(a));if(l!==0)return l}return ht(e.length,t.length)}static compareSegments(e,t){const s=js.isNumericId(e),a=js.isNumericId(t);return s&&!a?-1:!s&&a?1:s&&a?js.extractNumericId(e).compare(js.extractNumericId(t)):Sf(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return qi.fromString(e.substring(4,e.length-2))}}class zt extends js{construct(e,t,s){return new zt(e,t,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const s of e){if(s.indexOf("//")>=0)throw new Be(de.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);t.push(...s.split("/").filter((a=>a.length>0)))}return new zt(t)}static emptyPath(){return new zt([])}}const EI=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Gn extends js{construct(e,t,s){return new Gn(e,t,s)}static isValidIdentifier(e){return EI.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Gn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Yy}static keyField(){return new Gn([Yy])}static fromServerFormat(e){const t=[];let s="",a=0;const l=()=>{if(s.length===0)throw new Be(de.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(s),s=""};let d=!1;for(;a<e.length;){const f=e[a];if(f==="\\"){if(a+1===e.length)throw new Be(de.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const m=e[a+1];if(m!=="\\"&&m!=="."&&m!=="`")throw new Be(de.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=m,a+=2}else f==="`"?(d=!d,a++):f!=="."||d?(s+=f,a++):(l(),a++)}if(l(),d)throw new Be(de.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Gn(t)}static emptyPath(){return new Gn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ye{constructor(e){this.path=e}static fromPath(e){return new Ye(zt.fromString(e))}static fromName(e){return new Ye(zt.fromString(e).popFirst(5))}static empty(){return new Ye(zt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&zt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return zt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ye(new zt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T0(n,e,t){if(!t)throw new Be(de.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function TI(n,e,t,s){if(e===!0&&s===!0)throw new Be(de.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Jy(n){if(!Ye.isDocumentKey(n))throw new Be(de.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Xy(n){if(Ye.isDocumentKey(n))throw new Be(de.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function S0(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function cp(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(s){return s.constructor?s.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":nt(12329,{type:typeof n})}function Ir(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Be(de.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=cp(n);throw new Be(de.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fn(n,e){const t={typeString:n};return e&&(t.value=e),t}function nc(n,e){if(!S0(n))throw new Be(de.INVALID_ARGUMENT,"JSON must be an object");let t;for(const s in e)if(e[s]){const a=e[s].typeString,l="value"in e[s]?{value:e[s].value}:void 0;if(!(s in n)){t=`JSON missing required field: '${s}'`;break}const d=n[s];if(a&&typeof d!==a){t=`JSON field '${s}' must be a ${a}.`;break}if(l!==void 0&&d!==l.value){t=`Expected '${s}' field to equal '${l.value}'`;break}}if(t)throw new Be(de.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zy=-62135596800,ev=1e6;class Bt{static now(){return Bt.fromMillis(Date.now())}static fromDate(e){return Bt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),s=Math.floor((e-1e3*t)*ev);return new Bt(t,s)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Be(de.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Be(de.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Zy)throw new Be(de.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Be(de.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/ev}_compareTo(e){return this.seconds===e.seconds?ht(this.nanoseconds,e.nanoseconds):ht(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Bt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(nc(e,Bt._jsonSchema))return new Bt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Zy;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Bt._jsonSchemaVersion="firestore/timestamp/1.0",Bt._jsonSchema={type:fn("string",Bt._jsonSchemaVersion),seconds:fn("number"),nanoseconds:fn("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class at{static fromTimestamp(e){return new at(e)}static min(){return new at(new Bt(0,0))}static max(){return new at(new Bt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $l=-1;function SI(n,e){const t=n.toTimestamp().seconds,s=n.toTimestamp().nanoseconds+1,a=at.fromTimestamp(s===1e9?new Bt(t+1,0):new Bt(t,s));return new Yi(a,Ye.empty(),e)}function CI(n){return new Yi(n.readTime,n.key,$l)}class Yi{constructor(e,t,s){this.readTime=e,this.documentKey=t,this.largestBatchId=s}static min(){return new Yi(at.min(),Ye.empty(),$l)}static max(){return new Yi(at.max(),Ye.empty(),$l)}}function II(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Ye.comparator(n.documentKey,e.documentKey),t!==0?t:ht(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bI="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class PI{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $o(n){if(n.code!==de.FAILED_PRECONDITION||n.message!==bI)throw n;Oe("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ce{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&nt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ce(((s,a)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(s,a)},this.catchCallback=l=>{this.wrapFailure(t,l).next(s,a)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof ce?t:ce.resolve(t)}catch(t){return ce.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):ce.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):ce.reject(t)}static resolve(e){return new ce(((t,s)=>{t(e)}))}static reject(e){return new ce(((t,s)=>{s(e)}))}static waitFor(e){return new ce(((t,s)=>{let a=0,l=0,d=!1;e.forEach((f=>{++a,f.next((()=>{++l,d&&l===a&&t()}),(m=>s(m)))})),d=!0,l===a&&t()}))}static or(e){let t=ce.resolve(!1);for(const s of e)t=t.next((a=>a?ce.resolve(a):s()));return t}static forEach(e,t){const s=[];return e.forEach(((a,l)=>{s.push(t.call(this,a,l))})),this.waitFor(s)}static mapArray(e,t){return new ce(((s,a)=>{const l=e.length,d=new Array(l);let f=0;for(let m=0;m<l;m++){const v=m;t(e[v]).next((w=>{d[v]=w,++f,f===l&&s(d)}),(w=>a(w)))}}))}static doWhile(e,t){return new ce(((s,a)=>{const l=()=>{e()===!0?t().next((()=>{l()}),a):s()};l()}))}}function RI(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Wo(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rd{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=s=>this._e(s),this.ae=s=>t.writeSequenceNumber(s))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}}rd.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const up=-1;function sd(n){return n==null}function Ou(n){return n===0&&1/n==-1/0}function NI(n){return typeof n=="number"&&Number.isInteger(n)&&!Ou(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C0="";function AI(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=tv(e)),e=kI(n.get(t),e);return tv(e)}function kI(n,e){let t=e;const s=n.length;for(let a=0;a<s;a++){const l=n.charAt(a);switch(l){case"\0":t+="";break;case C0:t+="";break;default:t+=l}}return t}function tv(n){return n+C0+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nv(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function aa(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function I0(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kt{constructor(e,t){this.comparator=e,this.root=t||Wn.EMPTY}insert(e,t){return new Kt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Wn.BLACK,null,null))}remove(e){return new Kt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Wn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const s=this.comparator(e,t.key);if(s===0)return t.value;s<0?t=t.left:s>0&&(t=t.right)}return null}indexOf(e){let t=0,s=this.root;for(;!s.isEmpty();){const a=this.comparator(e,s.key);if(a===0)return t+s.left.size;a<0?s=s.left:(t+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,s)=>(e(t,s),!1)))}toString(){const e=[];return this.inorderTraversal(((t,s)=>(e.push(`${t}:${s}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new fu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new fu(this.root,e,this.comparator,!1)}getReverseIterator(){return new fu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new fu(this.root,e,this.comparator,!0)}}class fu{constructor(e,t,s,a){this.isReverse=a,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=t?s(e.key,t):1,t&&a&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Wn{constructor(e,t,s,a,l){this.key=e,this.value=t,this.color=s??Wn.RED,this.left=a??Wn.EMPTY,this.right=l??Wn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,s,a,l){return new Wn(e??this.key,t??this.value,s??this.color,a??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,s){let a=this;const l=s(e,a.key);return a=l<0?a.copy(null,null,null,a.left.insert(e,t,s),null):l===0?a.copy(null,t,null,null,null):a.copy(null,null,null,null,a.right.insert(e,t,s)),a.fixUp()}removeMin(){if(this.left.isEmpty())return Wn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let s,a=this;if(t(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,t),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),t(e,a.key)===0){if(a.right.isEmpty())return Wn.EMPTY;s=a.right.min(),a=a.copy(s.key,s.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,t))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Wn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Wn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw nt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw nt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw nt(27949);return e+(this.isRed()?0:1)}}Wn.EMPTY=null,Wn.RED=!0,Wn.BLACK=!1;Wn.EMPTY=new class{constructor(){this.size=0}get key(){throw nt(57766)}get value(){throw nt(16141)}get color(){throw nt(16727)}get left(){throw nt(29726)}get right(){throw nt(36894)}copy(e,t,s,a,l){return this}insert(e,t,s){return new Wn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tn{constructor(e){this.comparator=e,this.data=new Kt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,s)=>(e(t),!1)))}forEachInRange(e,t){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const a=s.getNext();if(this.comparator(a.key,e[1])>=0)return;t(a.key)}}forEachWhile(e,t){let s;for(s=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new rv(this.data.getIterator())}getIteratorFrom(e){return new rv(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((s=>{t=t.add(s)})),t}isEqual(e){if(!(e instanceof Tn)||this.size!==e.size)return!1;const t=this.data.getIterator(),s=e.data.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=s.getNext().key;if(this.comparator(a,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Tn(this.comparator);return t.data=e,t}}class rv{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mr{constructor(e){this.fields=e,e.sort(Gn.comparator)}static empty(){return new Mr([])}unionWith(e){let t=new Tn(Gn.comparator);for(const s of this.fields)t=t.add(s);for(const s of e)t=t.add(s);return new Mr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Ao(this.fields,e.fields,((t,s)=>t.isEqual(s)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b0 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(a){try{return atob(a)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new b0("Invalid base64 string: "+l):l}})(e);return new Hn(t)}static fromUint8Array(e){const t=(function(a){let l="";for(let d=0;d<a.length;++d)l+=String.fromCharCode(a[d]);return l})(e);return new Hn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const s=new Uint8Array(t.length);for(let a=0;a<t.length;a++)s[a]=t.charCodeAt(a);return s})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ht(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Hn.EMPTY_BYTE_STRING=new Hn("");const jI=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ji(n){if(Pt(!!n,39018),typeof n=="string"){let e=0;const t=jI.exec(n);if(Pt(!!t,46558,{timestamp:n}),t[1]){let a=t[1];a=(a+"000000000").substr(0,9),e=Number(a)}const s=new Date(n);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:nn(n.seconds),nanos:nn(n.nanos)}}function nn(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Xi(n){return typeof n=="string"?Hn.fromBase64String(n):Hn.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P0="server_timestamp",R0="__type__",N0="__previous_value__",A0="__local_write_time__";function dp(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[R0])===null||t===void 0?void 0:t.stringValue)===P0}function id(n){const e=n.mapValue.fields[N0];return dp(e)?id(e):e}function Wl(n){const e=Ji(n.mapValue.fields[A0].timestampValue);return new Bt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DI{constructor(e,t,s,a,l,d,f,m,v,w){this.databaseId=e,this.appId=t,this.persistenceKey=s,this.host=a,this.ssl=l,this.forceLongPolling=d,this.autoDetectLongPolling=f,this.longPollingOptions=m,this.useFetchStreams=v,this.isUsingEmulator=w}}const Mu="(default)";class Gl{constructor(e,t){this.projectId=e,this.database=t||Mu}static empty(){return new Gl("","")}get isDefaultDatabase(){return this.database===Mu}isEqual(e){return e instanceof Gl&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k0="__type__",LI="__max__",pu={mapValue:{}},j0="__vector__",Fu="value";function Zi(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?dp(n)?4:OI(n)?9007199254740991:VI(n)?10:11:nt(28295,{value:n})}function Us(n,e){if(n===e)return!0;const t=Zi(n);if(t!==Zi(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Wl(n).isEqual(Wl(e));case 3:return(function(a,l){if(typeof a.timestampValue=="string"&&typeof l.timestampValue=="string"&&a.timestampValue.length===l.timestampValue.length)return a.timestampValue===l.timestampValue;const d=Ji(a.timestampValue),f=Ji(l.timestampValue);return d.seconds===f.seconds&&d.nanos===f.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(a,l){return Xi(a.bytesValue).isEqual(Xi(l.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(a,l){return nn(a.geoPointValue.latitude)===nn(l.geoPointValue.latitude)&&nn(a.geoPointValue.longitude)===nn(l.geoPointValue.longitude)})(n,e);case 2:return(function(a,l){if("integerValue"in a&&"integerValue"in l)return nn(a.integerValue)===nn(l.integerValue);if("doubleValue"in a&&"doubleValue"in l){const d=nn(a.doubleValue),f=nn(l.doubleValue);return d===f?Ou(d)===Ou(f):isNaN(d)&&isNaN(f)}return!1})(n,e);case 9:return Ao(n.arrayValue.values||[],e.arrayValue.values||[],Us);case 10:case 11:return(function(a,l){const d=a.mapValue.fields||{},f=l.mapValue.fields||{};if(nv(d)!==nv(f))return!1;for(const m in d)if(d.hasOwnProperty(m)&&(f[m]===void 0||!Us(d[m],f[m])))return!1;return!0})(n,e);default:return nt(52216,{left:n})}}function Hl(n,e){return(n.values||[]).find((t=>Us(t,e)))!==void 0}function ko(n,e){if(n===e)return 0;const t=Zi(n),s=Zi(e);if(t!==s)return ht(t,s);switch(t){case 0:case 9007199254740991:return 0;case 1:return ht(n.booleanValue,e.booleanValue);case 2:return(function(l,d){const f=nn(l.integerValue||l.doubleValue),m=nn(d.integerValue||d.doubleValue);return f<m?-1:f>m?1:f===m?0:isNaN(f)?isNaN(m)?0:-1:1})(n,e);case 3:return sv(n.timestampValue,e.timestampValue);case 4:return sv(Wl(n),Wl(e));case 5:return Sf(n.stringValue,e.stringValue);case 6:return(function(l,d){const f=Xi(l),m=Xi(d);return f.compareTo(m)})(n.bytesValue,e.bytesValue);case 7:return(function(l,d){const f=l.split("/"),m=d.split("/");for(let v=0;v<f.length&&v<m.length;v++){const w=ht(f[v],m[v]);if(w!==0)return w}return ht(f.length,m.length)})(n.referenceValue,e.referenceValue);case 8:return(function(l,d){const f=ht(nn(l.latitude),nn(d.latitude));return f!==0?f:ht(nn(l.longitude),nn(d.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return iv(n.arrayValue,e.arrayValue);case 10:return(function(l,d){var f,m,v,w;const S=l.fields||{},I=d.fields||{},U=(f=S[Fu])===null||f===void 0?void 0:f.arrayValue,Z=(m=I[Fu])===null||m===void 0?void 0:m.arrayValue,Q=ht(((v=U==null?void 0:U.values)===null||v===void 0?void 0:v.length)||0,((w=Z==null?void 0:Z.values)===null||w===void 0?void 0:w.length)||0);return Q!==0?Q:iv(U,Z)})(n.mapValue,e.mapValue);case 11:return(function(l,d){if(l===pu.mapValue&&d===pu.mapValue)return 0;if(l===pu.mapValue)return 1;if(d===pu.mapValue)return-1;const f=l.fields||{},m=Object.keys(f),v=d.fields||{},w=Object.keys(v);m.sort(),w.sort();for(let S=0;S<m.length&&S<w.length;++S){const I=Sf(m[S],w[S]);if(I!==0)return I;const U=ko(f[m[S]],v[w[S]]);if(U!==0)return U}return ht(m.length,w.length)})(n.mapValue,e.mapValue);default:throw nt(23264,{le:t})}}function sv(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ht(n,e);const t=Ji(n),s=Ji(e),a=ht(t.seconds,s.seconds);return a!==0?a:ht(t.nanos,s.nanos)}function iv(n,e){const t=n.values||[],s=e.values||[];for(let a=0;a<t.length&&a<s.length;++a){const l=ko(t[a],s[a]);if(l)return l}return ht(t.length,s.length)}function jo(n){return Cf(n)}function Cf(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const s=Ji(t);return`time(${s.seconds},${s.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Xi(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Ye.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let s="[",a=!0;for(const l of t.values||[])a?a=!1:s+=",",s+=Cf(l);return s+"]"})(n.arrayValue):"mapValue"in n?(function(t){const s=Object.keys(t.fields||{}).sort();let a="{",l=!0;for(const d of s)l?l=!1:a+=",",a+=`${d}:${Cf(t.fields[d])}`;return a+"}"})(n.mapValue):nt(61005,{value:n})}function Tu(n){switch(Zi(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=id(n);return e?16+Tu(e):16;case 5:return 2*n.stringValue.length;case 6:return Xi(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(s){return(s.values||[]).reduce(((a,l)=>a+Tu(l)),0)})(n.arrayValue);case 10:case 11:return(function(s){let a=0;return aa(s.fields,((l,d)=>{a+=l.length+Tu(d)})),a})(n.mapValue);default:throw nt(13486,{value:n})}}function If(n){return!!n&&"integerValue"in n}function hp(n){return!!n&&"arrayValue"in n}function av(n){return!!n&&"nullValue"in n}function ov(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Su(n){return!!n&&"mapValue"in n}function VI(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[k0])===null||t===void 0?void 0:t.stringValue)===j0}function Dl(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return aa(n.mapValue.fields,((t,s)=>e.mapValue.fields[t]=Dl(s))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Dl(n.arrayValue.values[t]);return e}return Object.assign({},n)}function OI(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===LI}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cr{constructor(e){this.value=e}static empty(){return new Cr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let s=0;s<e.length-1;++s)if(t=(t.mapValue.fields||{})[e.get(s)],!Su(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Dl(t)}setAll(e){let t=Gn.emptyPath(),s={},a=[];e.forEach(((d,f)=>{if(!t.isImmediateParentOf(f)){const m=this.getFieldsMap(t);this.applyChanges(m,s,a),s={},a=[],t=f.popLast()}d?s[f.lastSegment()]=Dl(d):a.push(f.lastSegment())}));const l=this.getFieldsMap(t);this.applyChanges(l,s,a)}delete(e){const t=this.field(e.popLast());Su(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Us(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let s=0;s<e.length;++s){let a=t.mapValue.fields[e.get(s)];Su(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},t.mapValue.fields[e.get(s)]=a),t=a}return t.mapValue.fields}applyChanges(e,t,s){aa(t,((a,l)=>e[a]=l));for(const a of s)delete e[a]}clone(){return new Cr(Dl(this.value))}}function D0(n){const e=[];return aa(n.fields,((t,s)=>{const a=new Gn([t]);if(Su(s)){const l=D0(s.mapValue).fields;if(l.length===0)e.push(a);else for(const d of l)e.push(a.child(d))}else e.push(a)})),new Mr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ar{constructor(e,t,s,a,l,d,f){this.key=e,this.documentType=t,this.version=s,this.readTime=a,this.createTime=l,this.data=d,this.documentState=f}static newInvalidDocument(e){return new ar(e,0,at.min(),at.min(),at.min(),Cr.empty(),0)}static newFoundDocument(e,t,s,a){return new ar(e,1,t,at.min(),s,a,0)}static newNoDocument(e,t){return new ar(e,2,t,at.min(),at.min(),Cr.empty(),0)}static newUnknownDocument(e,t){return new ar(e,3,t,at.min(),at.min(),Cr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(at.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Cr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Cr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=at.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ar&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ar(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uu{constructor(e,t){this.position=e,this.inclusive=t}}function lv(n,e,t){let s=0;for(let a=0;a<n.position.length;a++){const l=e[a],d=n.position[a];if(l.field.isKeyField()?s=Ye.comparator(Ye.fromName(d.referenceValue),t.key):s=ko(d,t.data.field(l.field)),l.dir==="desc"&&(s*=-1),s!==0)break}return s}function cv(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Us(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zu{constructor(e,t="asc"){this.field=e,this.dir=t}}function MI(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L0{}class En extends L0{constructor(e,t,s){super(),this.field=e,this.op=t,this.value=s}static create(e,t,s){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,s):new UI(e,t,s):t==="array-contains"?new $I(e,s):t==="in"?new WI(e,s):t==="not-in"?new GI(e,s):t==="array-contains-any"?new HI(e,s):new En(e,t,s)}static createKeyFieldInFilter(e,t,s){return t==="in"?new zI(e,s):new BI(e,s)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(ko(t,this.value)):t!==null&&Zi(this.value)===Zi(t)&&this.matchesComparison(ko(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return nt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class zs extends L0{constructor(e,t){super(),this.filters=e,this.op=t,this.he=null}static create(e,t){return new zs(e,t)}matches(e){return V0(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function V0(n){return n.op==="and"}function O0(n){return FI(n)&&V0(n)}function FI(n){for(const e of n.filters)if(e instanceof zs)return!1;return!0}function bf(n){if(n instanceof En)return n.field.canonicalString()+n.op.toString()+jo(n.value);if(O0(n))return n.filters.map((e=>bf(e))).join(",");{const e=n.filters.map((t=>bf(t))).join(",");return`${n.op}(${e})`}}function M0(n,e){return n instanceof En?(function(s,a){return a instanceof En&&s.op===a.op&&s.field.isEqual(a.field)&&Us(s.value,a.value)})(n,e):n instanceof zs?(function(s,a){return a instanceof zs&&s.op===a.op&&s.filters.length===a.filters.length?s.filters.reduce(((l,d,f)=>l&&M0(d,a.filters[f])),!0):!1})(n,e):void nt(19439)}function F0(n){return n instanceof En?(function(t){return`${t.field.canonicalString()} ${t.op} ${jo(t.value)}`})(n):n instanceof zs?(function(t){return t.op.toString()+" {"+t.getFilters().map(F0).join(" ,")+"}"})(n):"Filter"}class UI extends En{constructor(e,t,s){super(e,t,s),this.key=Ye.fromName(s.referenceValue)}matches(e){const t=Ye.comparator(e.key,this.key);return this.matchesComparison(t)}}class zI extends En{constructor(e,t){super(e,"in",t),this.keys=U0("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class BI extends En{constructor(e,t){super(e,"not-in",t),this.keys=U0("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function U0(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map((s=>Ye.fromName(s.referenceValue)))}class $I extends En{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return hp(t)&&Hl(t.arrayValue,this.value)}}class WI extends En{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Hl(this.value.arrayValue,t)}}class GI extends En{constructor(e,t){super(e,"not-in",t)}matches(e){if(Hl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Hl(this.value.arrayValue,t)}}class HI extends En{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!hp(t)||!t.arrayValue.values)&&t.arrayValue.values.some((s=>Hl(this.value.arrayValue,s)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qI{constructor(e,t=null,s=[],a=[],l=null,d=null,f=null){this.path=e,this.collectionGroup=t,this.orderBy=s,this.filters=a,this.limit=l,this.startAt=d,this.endAt=f,this.Pe=null}}function uv(n,e=null,t=[],s=[],a=null,l=null,d=null){return new qI(n,e,t,s,a,l,d)}function fp(n){const e=ot(n);if(e.Pe===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((s=>bf(s))).join(","),t+="|ob:",t+=e.orderBy.map((s=>(function(l){return l.field.canonicalString()+l.dir})(s))).join(","),sd(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((s=>jo(s))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((s=>jo(s))).join(",")),e.Pe=t}return e.Pe}function pp(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!MI(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!M0(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!cv(n.startAt,e.startAt)&&cv(n.endAt,e.endAt)}function Pf(n){return Ye.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ad{constructor(e,t=null,s=[],a=[],l=null,d="F",f=null,m=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=s,this.filters=a,this.limit=l,this.limitType=d,this.startAt=f,this.endAt=m,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function KI(n,e,t,s,a,l,d,f){return new ad(n,e,t,s,a,l,d,f)}function od(n){return new ad(n)}function dv(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function QI(n){return n.collectionGroup!==null}function Ll(n){const e=ot(n);if(e.Te===null){e.Te=[];const t=new Set;for(const l of e.explicitOrderBy)e.Te.push(l),t.add(l.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let f=new Tn(Gn.comparator);return d.filters.forEach((m=>{m.getFlattenedFilters().forEach((v=>{v.isInequality()&&(f=f.add(v.field))}))})),f})(e).forEach((l=>{t.has(l.canonicalString())||l.isKeyField()||e.Te.push(new zu(l,s))})),t.has(Gn.keyField().canonicalString())||e.Te.push(new zu(Gn.keyField(),s))}return e.Te}function Vs(n){const e=ot(n);return e.Ie||(e.Ie=YI(e,Ll(n))),e.Ie}function YI(n,e){if(n.limitType==="F")return uv(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((a=>{const l=a.dir==="desc"?"asc":"desc";return new zu(a.field,l)}));const t=n.endAt?new Uu(n.endAt.position,n.endAt.inclusive):null,s=n.startAt?new Uu(n.startAt.position,n.startAt.inclusive):null;return uv(n.path,n.collectionGroup,e,n.filters,n.limit,t,s)}}function Rf(n,e,t){return new ad(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function ld(n,e){return pp(Vs(n),Vs(e))&&n.limitType===e.limitType}function z0(n){return`${fp(Vs(n))}|lt:${n.limitType}`}function _o(n){return`Query(target=${(function(t){let s=t.path.canonicalString();return t.collectionGroup!==null&&(s+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(s+=`, filters: [${t.filters.map((a=>F0(a))).join(", ")}]`),sd(t.limit)||(s+=", limit: "+t.limit),t.orderBy.length>0&&(s+=`, orderBy: [${t.orderBy.map((a=>(function(d){return`${d.field.canonicalString()} (${d.dir})`})(a))).join(", ")}]`),t.startAt&&(s+=", startAt: ",s+=t.startAt.inclusive?"b:":"a:",s+=t.startAt.position.map((a=>jo(a))).join(",")),t.endAt&&(s+=", endAt: ",s+=t.endAt.inclusive?"a:":"b:",s+=t.endAt.position.map((a=>jo(a))).join(",")),`Target(${s})`})(Vs(n))}; limitType=${n.limitType})`}function cd(n,e){return e.isFoundDocument()&&(function(s,a){const l=a.key.path;return s.collectionGroup!==null?a.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(l):Ye.isDocumentKey(s.path)?s.path.isEqual(l):s.path.isImmediateParentOf(l)})(n,e)&&(function(s,a){for(const l of Ll(s))if(!l.field.isKeyField()&&a.data.field(l.field)===null)return!1;return!0})(n,e)&&(function(s,a){for(const l of s.filters)if(!l.matches(a))return!1;return!0})(n,e)&&(function(s,a){return!(s.startAt&&!(function(d,f,m){const v=lv(d,f,m);return d.inclusive?v<=0:v<0})(s.startAt,Ll(s),a)||s.endAt&&!(function(d,f,m){const v=lv(d,f,m);return d.inclusive?v>=0:v>0})(s.endAt,Ll(s),a))})(n,e)}function JI(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function B0(n){return(e,t)=>{let s=!1;for(const a of Ll(n)){const l=XI(a,e,t);if(l!==0)return l;s=s||a.field.isKeyField()}return 0}}function XI(n,e,t){const s=n.field.isKeyField()?Ye.comparator(e.key,t.key):(function(l,d,f){const m=d.data.field(l),v=f.data.field(l);return m!==null&&v!==null?ko(m,v):nt(42886)})(n.field,e,t);switch(n.dir){case"asc":return s;case"desc":return-1*s;default:return nt(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class La{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s!==void 0){for(const[a,l]of s)if(this.equalsFn(a,e))return l}}has(e){return this.get(e)!==void 0}set(e,t){const s=this.mapKeyFn(e),a=this.inner[s];if(a===void 0)return this.inner[s]=[[e,t]],void this.innerSize++;for(let l=0;l<a.length;l++)if(this.equalsFn(a[l][0],e))return void(a[l]=[e,t]);a.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s===void 0)return!1;for(let a=0;a<s.length;a++)if(this.equalsFn(s[a][0],e))return s.length===1?delete this.inner[t]:s.splice(a,1),this.innerSize--,!0;return!1}forEach(e){aa(this.inner,((t,s)=>{for(const[a,l]of s)e(a,l)}))}isEmpty(){return I0(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZI=new Kt(Ye.comparator);function gi(){return ZI}const $0=new Kt(Ye.comparator);function Pl(...n){let e=$0;for(const t of n)e=e.insert(t.key,t);return e}function W0(n){let e=$0;return n.forEach(((t,s)=>e=e.insert(t,s.overlayedDocument))),e}function ba(){return Vl()}function G0(){return Vl()}function Vl(){return new La((n=>n.toString()),((n,e)=>n.isEqual(e)))}const eb=new Kt(Ye.comparator),tb=new Tn(Ye.comparator);function yt(...n){let e=tb;for(const t of n)e=e.add(t);return e}const nb=new Tn(ht);function rb(){return nb}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mp(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ou(e)?"-0":e}}function H0(n){return{integerValue:""+n}}function sb(n,e){return NI(e)?H0(e):mp(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ud{constructor(){this._=void 0}}function ib(n,e,t){return n instanceof ql?(function(a,l){const d={fields:{[R0]:{stringValue:P0},[A0]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return l&&dp(l)&&(l=id(l)),l&&(d.fields[N0]=l),{mapValue:d}})(t,e):n instanceof Kl?K0(n,e):n instanceof Ql?Q0(n,e):(function(a,l){const d=q0(a,l),f=hv(d)+hv(a.Ee);return If(d)&&If(a.Ee)?H0(f):mp(a.serializer,f)})(n,e)}function ab(n,e,t){return n instanceof Kl?K0(n,e):n instanceof Ql?Q0(n,e):t}function q0(n,e){return n instanceof Bu?(function(s){return If(s)||(function(l){return!!l&&"doubleValue"in l})(s)})(e)?e:{integerValue:0}:null}class ql extends ud{}class Kl extends ud{constructor(e){super(),this.elements=e}}function K0(n,e){const t=Y0(e);for(const s of n.elements)t.some((a=>Us(a,s)))||t.push(s);return{arrayValue:{values:t}}}class Ql extends ud{constructor(e){super(),this.elements=e}}function Q0(n,e){let t=Y0(e);for(const s of n.elements)t=t.filter((a=>!Us(a,s)));return{arrayValue:{values:t}}}class Bu extends ud{constructor(e,t){super(),this.serializer=e,this.Ee=t}}function hv(n){return nn(n.integerValue||n.doubleValue)}function Y0(n){return hp(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ob{constructor(e,t){this.field=e,this.transform=t}}function lb(n,e){return n.field.isEqual(e.field)&&(function(s,a){return s instanceof Kl&&a instanceof Kl||s instanceof Ql&&a instanceof Ql?Ao(s.elements,a.elements,Us):s instanceof Bu&&a instanceof Bu?Us(s.Ee,a.Ee):s instanceof ql&&a instanceof ql})(n.transform,e.transform)}class cb{constructor(e,t){this.version=e,this.transformResults=t}}class Jr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Jr}static exists(e){return new Jr(void 0,e)}static updateTime(e){return new Jr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Cu(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class dd{}function J0(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new gp(n.key,Jr.none()):new rc(n.key,n.data,Jr.none());{const t=n.data,s=Cr.empty();let a=new Tn(Gn.comparator);for(let l of e.fields)if(!a.has(l)){let d=t.field(l);d===null&&l.length>1&&(l=l.popLast(),d=t.field(l)),d===null?s.delete(l):s.set(l,d),a=a.add(l)}return new oa(n.key,s,new Mr(a.toArray()),Jr.none())}}function ub(n,e,t){n instanceof rc?(function(a,l,d){const f=a.value.clone(),m=pv(a.fieldTransforms,l,d.transformResults);f.setAll(m),l.convertToFoundDocument(d.version,f).setHasCommittedMutations()})(n,e,t):n instanceof oa?(function(a,l,d){if(!Cu(a.precondition,l))return void l.convertToUnknownDocument(d.version);const f=pv(a.fieldTransforms,l,d.transformResults),m=l.data;m.setAll(X0(a)),m.setAll(f),l.convertToFoundDocument(d.version,m).setHasCommittedMutations()})(n,e,t):(function(a,l,d){l.convertToNoDocument(d.version).setHasCommittedMutations()})(0,e,t)}function Ol(n,e,t,s){return n instanceof rc?(function(l,d,f,m){if(!Cu(l.precondition,d))return f;const v=l.value.clone(),w=mv(l.fieldTransforms,m,d);return v.setAll(w),d.convertToFoundDocument(d.version,v).setHasLocalMutations(),null})(n,e,t,s):n instanceof oa?(function(l,d,f,m){if(!Cu(l.precondition,d))return f;const v=mv(l.fieldTransforms,m,d),w=d.data;return w.setAll(X0(l)),w.setAll(v),d.convertToFoundDocument(d.version,w).setHasLocalMutations(),f===null?null:f.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((S=>S.field)))})(n,e,t,s):(function(l,d,f){return Cu(l.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):f})(n,e,t)}function db(n,e){let t=null;for(const s of n.fieldTransforms){const a=e.data.field(s.field),l=q0(s.transform,a||null);l!=null&&(t===null&&(t=Cr.empty()),t.set(s.field,l))}return t||null}function fv(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(s,a){return s===void 0&&a===void 0||!(!s||!a)&&Ao(s,a,((l,d)=>lb(l,d)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class rc extends dd{constructor(e,t,s,a=[]){super(),this.key=e,this.value=t,this.precondition=s,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class oa extends dd{constructor(e,t,s,a,l=[]){super(),this.key=e,this.data=t,this.fieldMask=s,this.precondition=a,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function X0(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const s=n.data.field(t);e.set(t,s)}})),e}function pv(n,e,t){const s=new Map;Pt(n.length===t.length,32656,{Ae:t.length,Re:n.length});for(let a=0;a<t.length;a++){const l=n[a],d=l.transform,f=e.data.field(l.field);s.set(l.field,ab(d,f,t[a]))}return s}function mv(n,e,t){const s=new Map;for(const a of n){const l=a.transform,d=t.data.field(a.field);s.set(a.field,ib(l,d,e))}return s}class gp extends dd{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class hb extends dd{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fb{constructor(e,t,s,a){this.batchId=e,this.localWriteTime=t,this.baseMutations=s,this.mutations=a}applyToRemoteDocument(e,t){const s=t.mutationResults;for(let a=0;a<this.mutations.length;a++){const l=this.mutations[a];l.key.isEqual(e.key)&&ub(l,e,s[a])}}applyToLocalView(e,t){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(t=Ol(s,e,t,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(t=Ol(s,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const s=G0();return this.mutations.forEach((a=>{const l=e.get(a.key),d=l.overlayedDocument;let f=this.applyToLocalView(d,l.mutatedFields);f=t.has(a.key)?null:f;const m=J0(d,f);m!==null&&s.set(a.key,m),d.isValidDocument()||d.convertToNoDocument(at.min())})),s}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),yt())}isEqual(e){return this.batchId===e.batchId&&Ao(this.mutations,e.mutations,((t,s)=>fv(t,s)))&&Ao(this.baseMutations,e.baseMutations,((t,s)=>fv(t,s)))}}class yp{constructor(e,t,s,a){this.batch=e,this.commitVersion=t,this.mutationResults=s,this.docVersions=a}static from(e,t,s){Pt(e.mutations.length===s.length,58842,{Ve:e.mutations.length,me:s.length});let a=(function(){return eb})();const l=e.mutations;for(let d=0;d<l.length;d++)a=a.insert(l[d].key,s[d].version);return new yp(e,t,s,a)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pb{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mb{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var hn,xt;function gb(n){switch(n){case de.OK:return nt(64938);case de.CANCELLED:case de.UNKNOWN:case de.DEADLINE_EXCEEDED:case de.RESOURCE_EXHAUSTED:case de.INTERNAL:case de.UNAVAILABLE:case de.UNAUTHENTICATED:return!1;case de.INVALID_ARGUMENT:case de.NOT_FOUND:case de.ALREADY_EXISTS:case de.PERMISSION_DENIED:case de.FAILED_PRECONDITION:case de.ABORTED:case de.OUT_OF_RANGE:case de.UNIMPLEMENTED:case de.DATA_LOSS:return!0;default:return nt(15467,{code:n})}}function Z0(n){if(n===void 0)return mi("GRPC error has no .code"),de.UNKNOWN;switch(n){case hn.OK:return de.OK;case hn.CANCELLED:return de.CANCELLED;case hn.UNKNOWN:return de.UNKNOWN;case hn.DEADLINE_EXCEEDED:return de.DEADLINE_EXCEEDED;case hn.RESOURCE_EXHAUSTED:return de.RESOURCE_EXHAUSTED;case hn.INTERNAL:return de.INTERNAL;case hn.UNAVAILABLE:return de.UNAVAILABLE;case hn.UNAUTHENTICATED:return de.UNAUTHENTICATED;case hn.INVALID_ARGUMENT:return de.INVALID_ARGUMENT;case hn.NOT_FOUND:return de.NOT_FOUND;case hn.ALREADY_EXISTS:return de.ALREADY_EXISTS;case hn.PERMISSION_DENIED:return de.PERMISSION_DENIED;case hn.FAILED_PRECONDITION:return de.FAILED_PRECONDITION;case hn.ABORTED:return de.ABORTED;case hn.OUT_OF_RANGE:return de.OUT_OF_RANGE;case hn.UNIMPLEMENTED:return de.UNIMPLEMENTED;case hn.DATA_LOSS:return de.DATA_LOSS;default:return nt(39323,{code:n})}}(xt=hn||(hn={}))[xt.OK=0]="OK",xt[xt.CANCELLED=1]="CANCELLED",xt[xt.UNKNOWN=2]="UNKNOWN",xt[xt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",xt[xt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",xt[xt.NOT_FOUND=5]="NOT_FOUND",xt[xt.ALREADY_EXISTS=6]="ALREADY_EXISTS",xt[xt.PERMISSION_DENIED=7]="PERMISSION_DENIED",xt[xt.UNAUTHENTICATED=16]="UNAUTHENTICATED",xt[xt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",xt[xt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",xt[xt.ABORTED=10]="ABORTED",xt[xt.OUT_OF_RANGE=11]="OUT_OF_RANGE",xt[xt.UNIMPLEMENTED=12]="UNIMPLEMENTED",xt[xt.INTERNAL=13]="INTERNAL",xt[xt.UNAVAILABLE=14]="UNAVAILABLE",xt[xt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yb=new qi([4294967295,4294967295],0);function gv(n){const e=E0().encode(n),t=new p0;return t.update(e),new Uint8Array(t.digest())}function yv(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),s=e.getUint32(4,!0),a=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new qi([t,s],0),new qi([a,l],0)]}class vp{constructor(e,t,s){if(this.bitmap=e,this.padding=t,this.hashCount=s,t<0||t>=8)throw new Rl(`Invalid padding: ${t}`);if(s<0)throw new Rl(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new Rl(`Invalid hash count: ${s}`);if(e.length===0&&t!==0)throw new Rl(`Invalid padding when bitmap length is 0: ${t}`);this.fe=8*e.length-t,this.ge=qi.fromNumber(this.fe)}pe(e,t,s){let a=e.add(t.multiply(qi.fromNumber(s)));return a.compare(yb)===1&&(a=new qi([a.getBits(0),a.getBits(1)],0)),a.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;const t=gv(e),[s,a]=yv(t);for(let l=0;l<this.hashCount;l++){const d=this.pe(s,a,l);if(!this.ye(d))return!1}return!0}static create(e,t,s){const a=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),d=new vp(l,a,t);return s.forEach((f=>d.insert(f))),d}insert(e){if(this.fe===0)return;const t=gv(e),[s,a]=yv(t);for(let l=0;l<this.hashCount;l++){const d=this.pe(s,a,l);this.we(d)}}we(e){const t=Math.floor(e/8),s=e%8;this.bitmap[t]|=1<<s}}class Rl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hd{constructor(e,t,s,a,l){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=s,this.documentUpdates=a,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,t,s){const a=new Map;return a.set(e,sc.createSynthesizedTargetChangeForCurrentChange(e,t,s)),new hd(at.min(),a,new Kt(ht),gi(),yt())}}class sc{constructor(e,t,s,a,l){this.resumeToken=e,this.current=t,this.addedDocuments=s,this.modifiedDocuments=a,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,t,s){return new sc(s,t,yt(),yt(),yt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iu{constructor(e,t,s,a){this.Se=e,this.removedTargetIds=t,this.key=s,this.be=a}}class ew{constructor(e,t){this.targetId=e,this.De=t}}class tw{constructor(e,t,s=Hn.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=t,this.resumeToken=s,this.cause=a}}class vv{constructor(){this.ve=0,this.Ce=_v(),this.Fe=Hn.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=yt(),t=yt(),s=yt();return this.Ce.forEach(((a,l)=>{switch(l){case 0:e=e.add(a);break;case 2:t=t.add(a);break;case 1:s=s.add(a);break;default:nt(38017,{changeType:l})}})),new sc(this.Fe,this.Me,e,t,s)}ke(){this.xe=!1,this.Ce=_v()}qe(e,t){this.xe=!0,this.Ce=this.Ce.insert(e,t)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,Pt(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class vb{constructor(e){this.We=e,this.Ge=new Map,this.ze=gi(),this.je=mu(),this.Je=mu(),this.He=new Kt(ht)}Ye(e){for(const t of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(t,e.be):this.Xe(t,e.key,e.be);for(const t of e.removedTargetIds)this.Xe(t,e.key,e.be)}et(e){this.forEachTarget(e,(t=>{const s=this.tt(t);switch(e.state){case 0:this.nt(t)&&s.Be(e.resumeToken);break;case 1:s.Ue(),s.Oe||s.ke(),s.Be(e.resumeToken);break;case 2:s.Ue(),s.Oe||this.removeTarget(t);break;case 3:this.nt(t)&&(s.Ke(),s.Be(e.resumeToken));break;case 4:this.nt(t)&&(this.rt(t),s.Be(e.resumeToken));break;default:nt(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ge.forEach(((s,a)=>{this.nt(a)&&t(a)}))}it(e){const t=e.targetId,s=e.De.count,a=this.st(t);if(a){const l=a.target;if(Pf(l))if(s===0){const d=new Ye(l.path);this.Xe(t,d,ar.newNoDocument(d,at.min()))}else Pt(s===1,20013,{expectedCount:s});else{const d=this.ot(t);if(d!==s){const f=this._t(e),m=f?this.ut(f,e,d):1;if(m!==0){this.rt(t);const v=m===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(t,v)}}}}}_t(e){const t=e.De.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:s="",padding:a=0},hashCount:l=0}=t;let d,f;try{d=Xi(s).toUint8Array()}catch(m){if(m instanceof b0)return Qi("Decoding the base64 bloom filter in existence filter failed ("+m.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw m}try{f=new vp(d,a,l)}catch(m){return Qi(m instanceof Rl?"BloomFilter error: ":"Applying bloom filter failed: ",m),null}return f.fe===0?null:f}ut(e,t,s){return t.De.count===s-this.ht(e,t.targetId)?0:2}ht(e,t){const s=this.We.getRemoteKeysForTarget(t);let a=0;return s.forEach((l=>{const d=this.We.lt(),f=`projects/${d.projectId}/databases/${d.database}/documents/${l.path.canonicalString()}`;e.mightContain(f)||(this.Xe(t,l,null),a++)})),a}Pt(e){const t=new Map;this.Ge.forEach(((l,d)=>{const f=this.st(d);if(f){if(l.current&&Pf(f.target)){const m=new Ye(f.target.path);this.Tt(m).has(d)||this.It(d,m)||this.Xe(d,m,ar.newNoDocument(m,e))}l.Ne&&(t.set(d,l.Le()),l.ke())}}));let s=yt();this.Je.forEach(((l,d)=>{let f=!0;d.forEachWhile((m=>{const v=this.st(m);return!v||v.purpose==="TargetPurposeLimboResolution"||(f=!1,!1)})),f&&(s=s.add(l))})),this.ze.forEach(((l,d)=>d.setReadTime(e)));const a=new hd(e,t,this.He,this.ze,s);return this.ze=gi(),this.je=mu(),this.Je=mu(),this.He=new Kt(ht),a}Ze(e,t){if(!this.nt(e))return;const s=this.It(e,t.key)?2:0;this.tt(e).qe(t.key,s),this.ze=this.ze.insert(t.key,t),this.je=this.je.insert(t.key,this.Tt(t.key).add(e)),this.Je=this.Je.insert(t.key,this.dt(t.key).add(e))}Xe(e,t,s){if(!this.nt(e))return;const a=this.tt(e);this.It(e,t)?a.qe(t,1):a.Qe(t),this.Je=this.Je.insert(t,this.dt(t).delete(e)),this.Je=this.Je.insert(t,this.dt(t).add(e)),s&&(this.ze=this.ze.insert(t,s))}removeTarget(e){this.Ge.delete(e)}ot(e){const t=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let t=this.Ge.get(e);return t||(t=new vv,this.Ge.set(e,t)),t}dt(e){let t=this.Je.get(e);return t||(t=new Tn(ht),this.Je=this.Je.insert(e,t)),t}Tt(e){let t=this.je.get(e);return t||(t=new Tn(ht),this.je=this.je.insert(e,t)),t}nt(e){const t=this.st(e)!==null;return t||Oe("WatchChangeAggregator","Detected inactive target",e),t}st(e){const t=this.Ge.get(e);return t&&t.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new vv),this.We.getRemoteKeysForTarget(e).forEach((t=>{this.Xe(e,t,null)}))}It(e,t){return this.We.getRemoteKeysForTarget(e).has(t)}}function mu(){return new Kt(Ye.comparator)}function _v(){return new Kt(Ye.comparator)}const _b={asc:"ASCENDING",desc:"DESCENDING"},wb={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},xb={and:"AND",or:"OR"};class Eb{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Nf(n,e){return n.useProto3Json||sd(e)?e:{value:e}}function $u(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function nw(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function Tb(n,e){return $u(n,e.toTimestamp())}function Os(n){return Pt(!!n,49232),at.fromTimestamp((function(t){const s=Ji(t);return new Bt(s.seconds,s.nanos)})(n))}function _p(n,e){return Af(n,e).canonicalString()}function Af(n,e){const t=(function(a){return new zt(["projects",a.projectId,"databases",a.database])})(n).child("documents");return e===void 0?t:t.child(e)}function rw(n){const e=zt.fromString(n);return Pt(lw(e),10190,{key:e.toString()}),e}function kf(n,e){return _p(n.databaseId,e.path)}function sf(n,e){const t=rw(e);if(t.get(1)!==n.databaseId.projectId)throw new Be(de.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Be(de.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Ye(iw(t))}function sw(n,e){return _p(n.databaseId,e)}function Sb(n){const e=rw(n);return e.length===4?zt.emptyPath():iw(e)}function jf(n){return new zt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function iw(n){return Pt(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function wv(n,e,t){return{name:kf(n,e),fields:t.value.mapValue.fields}}function Cb(n,e){let t;if("targetChange"in e){e.targetChange;const s=(function(v){return v==="NO_CHANGE"?0:v==="ADD"?1:v==="REMOVE"?2:v==="CURRENT"?3:v==="RESET"?4:nt(39313,{state:v})})(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],l=(function(v,w){return v.useProto3Json?(Pt(w===void 0||typeof w=="string",58123),Hn.fromBase64String(w||"")):(Pt(w===void 0||w instanceof Buffer||w instanceof Uint8Array,16193),Hn.fromUint8Array(w||new Uint8Array))})(n,e.targetChange.resumeToken),d=e.targetChange.cause,f=d&&(function(v){const w=v.code===void 0?de.UNKNOWN:Z0(v.code);return new Be(w,v.message||"")})(d);t=new tw(s,a,l,f||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const a=sf(n,s.document.name),l=Os(s.document.updateTime),d=s.document.createTime?Os(s.document.createTime):at.min(),f=new Cr({mapValue:{fields:s.document.fields}}),m=ar.newFoundDocument(a,l,d,f),v=s.targetIds||[],w=s.removedTargetIds||[];t=new Iu(v,w,m.key,m)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const a=sf(n,s.document),l=s.readTime?Os(s.readTime):at.min(),d=ar.newNoDocument(a,l),f=s.removedTargetIds||[];t=new Iu([],f,d.key,d)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const a=sf(n,s.document),l=s.removedTargetIds||[];t=new Iu([],l,a,null)}else{if(!("filter"in e))return nt(11601,{At:e});{e.filter;const s=e.filter;s.targetId;const{count:a=0,unchangedNames:l}=s,d=new mb(a,l),f=s.targetId;t=new ew(f,d)}}return t}function Ib(n,e){let t;if(e instanceof rc)t={update:wv(n,e.key,e.value)};else if(e instanceof gp)t={delete:kf(n,e.key)};else if(e instanceof oa)t={update:wv(n,e.key,e.data),updateMask:Lb(e.fieldMask)};else{if(!(e instanceof hb))return nt(16599,{Rt:e.type});t={verify:kf(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((s=>(function(l,d){const f=d.transform;if(f instanceof ql)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(f instanceof Kl)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:f.elements}};if(f instanceof Ql)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:f.elements}};if(f instanceof Bu)return{fieldPath:d.field.canonicalString(),increment:f.Ee};throw nt(20930,{transform:d.transform})})(0,s)))),e.precondition.isNone||(t.currentDocument=(function(a,l){return l.updateTime!==void 0?{updateTime:Tb(a,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:nt(27497)})(n,e.precondition)),t}function bb(n,e){return n&&n.length>0?(Pt(e!==void 0,14353),n.map((t=>(function(a,l){let d=a.updateTime?Os(a.updateTime):Os(l);return d.isEqual(at.min())&&(d=Os(l)),new cb(d,a.transformResults||[])})(t,e)))):[]}function Pb(n,e){return{documents:[sw(n,e.path)]}}function Rb(n,e){const t={structuredQuery:{}},s=e.path;let a;e.collectionGroup!==null?(a=s,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=s.popLast(),t.structuredQuery.from=[{collectionId:s.lastSegment()}]),t.parent=sw(n,a);const l=(function(v){if(v.length!==0)return ow(zs.create(v,"and"))})(e.filters);l&&(t.structuredQuery.where=l);const d=(function(v){if(v.length!==0)return v.map((w=>(function(I){return{field:wo(I.field),direction:kb(I.dir)}})(w)))})(e.orderBy);d&&(t.structuredQuery.orderBy=d);const f=Nf(n,e.limit);return f!==null&&(t.structuredQuery.limit=f),e.startAt&&(t.structuredQuery.startAt=(function(v){return{before:v.inclusive,values:v.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(v){return{before:!v.inclusive,values:v.position}})(e.endAt)),{Vt:t,parent:a}}function Nb(n){let e=Sb(n.parent);const t=n.structuredQuery,s=t.from?t.from.length:0;let a=null;if(s>0){Pt(s===1,65062);const w=t.from[0];w.allDescendants?a=w.collectionId:e=e.child(w.collectionId)}let l=[];t.where&&(l=(function(S){const I=aw(S);return I instanceof zs&&O0(I)?I.getFilters():[I]})(t.where));let d=[];t.orderBy&&(d=(function(S){return S.map((I=>(function(Z){return new zu(xo(Z.field),(function(M){switch(M){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(Z.direction))})(I)))})(t.orderBy));let f=null;t.limit&&(f=(function(S){let I;return I=typeof S=="object"?S.value:S,sd(I)?null:I})(t.limit));let m=null;t.startAt&&(m=(function(S){const I=!!S.before,U=S.values||[];return new Uu(U,I)})(t.startAt));let v=null;return t.endAt&&(v=(function(S){const I=!S.before,U=S.values||[];return new Uu(U,I)})(t.endAt)),KI(e,a,d,l,f,"F",m,v)}function Ab(n,e){const t=(function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return nt(28987,{purpose:a})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function aw(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const s=xo(t.unaryFilter.field);return En.create(s,"==",{doubleValue:NaN});case"IS_NULL":const a=xo(t.unaryFilter.field);return En.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=xo(t.unaryFilter.field);return En.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=xo(t.unaryFilter.field);return En.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return nt(61313);default:return nt(60726)}})(n):n.fieldFilter!==void 0?(function(t){return En.create(xo(t.fieldFilter.field),(function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return nt(58110);default:return nt(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return zs.create(t.compositeFilter.filters.map((s=>aw(s))),(function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return nt(1026)}})(t.compositeFilter.op))})(n):nt(30097,{filter:n})}function kb(n){return _b[n]}function jb(n){return wb[n]}function Db(n){return xb[n]}function wo(n){return{fieldPath:n.canonicalString()}}function xo(n){return Gn.fromServerFormat(n.fieldPath)}function ow(n){return n instanceof En?(function(t){if(t.op==="=="){if(ov(t.value))return{unaryFilter:{field:wo(t.field),op:"IS_NAN"}};if(av(t.value))return{unaryFilter:{field:wo(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(ov(t.value))return{unaryFilter:{field:wo(t.field),op:"IS_NOT_NAN"}};if(av(t.value))return{unaryFilter:{field:wo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:wo(t.field),op:jb(t.op),value:t.value}}})(n):n instanceof zs?(function(t){const s=t.getFilters().map((a=>ow(a)));return s.length===1?s[0]:{compositeFilter:{op:Db(t.op),filters:s}}})(n):nt(54877,{filter:n})}function Lb(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function lw(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bi{constructor(e,t,s,a,l=at.min(),d=at.min(),f=Hn.EMPTY_BYTE_STRING,m=null){this.target=e,this.targetId=t,this.purpose=s,this.sequenceNumber=a,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=f,this.expectedCount=m}withSequenceNumber(e){return new Bi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Bi(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Bi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Bi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vb{constructor(e){this.gt=e}}function Ob(n){const e=Nb({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Rf(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mb{constructor(){this.Dn=new Fb}addToCollectionParentIndex(e,t){return this.Dn.add(t),ce.resolve()}getCollectionParents(e,t){return ce.resolve(this.Dn.getEntries(t))}addFieldIndex(e,t){return ce.resolve()}deleteFieldIndex(e,t){return ce.resolve()}deleteAllFieldIndexes(e){return ce.resolve()}createTargetIndexes(e,t){return ce.resolve()}getDocumentsMatchingTarget(e,t){return ce.resolve(null)}getIndexType(e,t){return ce.resolve(0)}getFieldIndexes(e,t){return ce.resolve([])}getNextCollectionGroupToUpdate(e){return ce.resolve(null)}getMinOffset(e,t){return ce.resolve(Yi.min())}getMinOffsetFromCollectionGroup(e,t){return ce.resolve(Yi.min())}updateCollectionGroup(e,t,s){return ce.resolve()}updateIndexEntries(e,t){return ce.resolve()}}class Fb{constructor(){this.index={}}add(e){const t=e.lastSegment(),s=e.popLast(),a=this.index[t]||new Tn(zt.comparator),l=!a.has(s);return this.index[t]=a.add(s),l}has(e){const t=e.lastSegment(),s=e.popLast(),a=this.index[t];return a&&a.has(s)}getEntries(e){return(this.index[e]||new Tn(zt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xv={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},cw=41943040;class Sr{static withCacheSize(e){return new Sr(e,Sr.DEFAULT_COLLECTION_PERCENTILE,Sr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Sr.DEFAULT_COLLECTION_PERCENTILE=10,Sr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Sr.DEFAULT=new Sr(cw,Sr.DEFAULT_COLLECTION_PERCENTILE,Sr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Sr.DISABLED=new Sr(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Do{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new Do(0)}static ur(){return new Do(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ev="LruGarbageCollector",Ub=1048576;function Tv([n,e],[t,s]){const a=ht(n,t);return a===0?ht(e,s):a}class zb{constructor(e){this.Tr=e,this.buffer=new Tn(Tv),this.Ir=0}dr(){return++this.Ir}Er(e){const t=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(t);else{const s=this.buffer.last();Tv(t,s)<0&&(this.buffer=this.buffer.delete(s).add(t))}}get maxValue(){return this.buffer.last()[0]}}class Bb{constructor(e,t,s){this.garbageCollector=e,this.asyncQueue=t,this.localStore=s,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){Oe(Ev,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Wo(t)?Oe(Ev,"Ignoring IndexedDB error during garbage collection: ",t):await $o(t)}await this.Rr(3e5)}))}}class $b{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.mr(e).next((s=>Math.floor(t/100*s)))}nthSequenceNumber(e,t){if(t===0)return ce.resolve(rd.ue);const s=new zb(t);return this.Vr.forEachTarget(e,(a=>s.Er(a.sequenceNumber))).next((()=>this.Vr.gr(e,(a=>s.Er(a))))).next((()=>s.maxValue))}removeTargets(e,t,s){return this.Vr.removeTargets(e,t,s)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Oe("LruGarbageCollector","Garbage collection skipped; disabled"),ce.resolve(xv)):this.getCacheSize(e).next((s=>s<this.params.cacheSizeCollectionThreshold?(Oe("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),xv):this.pr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,t){let s,a,l,d,f,m,v;const w=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((S=>(S>this.params.maximumSequenceNumbersToCollect?(Oe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${S}`),a=this.params.maximumSequenceNumbersToCollect):a=S,d=Date.now(),this.nthSequenceNumber(e,a)))).next((S=>(s=S,f=Date.now(),this.removeTargets(e,s,t)))).next((S=>(l=S,m=Date.now(),this.removeOrphanedDocuments(e,s)))).next((S=>(v=Date.now(),vo()<=gt.DEBUG&&Oe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-w}ms
	Determined least recently used ${a} in `+(f-d)+`ms
	Removed ${l} targets in `+(m-f)+`ms
	Removed ${S} documents in `+(v-m)+`ms
Total Duration: ${v-w}ms`),ce.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:l,documentsRemoved:S}))))}}function Wb(n,e){return new $b(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gb{constructor(){this.changes=new La((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ar.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const s=this.changes.get(t);return s!==void 0?ce.resolve(s):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hb{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qb{constructor(e,t,s,a){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=s,this.indexManager=a}getDocument(e,t){let s=null;return this.documentOverlayCache.getOverlay(e,t).next((a=>(s=a,this.remoteDocumentCache.getEntry(e,t)))).next((a=>(s!==null&&Ol(s.mutation,a,Mr.empty(),Bt.now()),a)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((s=>this.getLocalViewOfDocuments(e,s,yt()).next((()=>s))))}getLocalViewOfDocuments(e,t,s=yt()){const a=ba();return this.populateOverlays(e,a,t).next((()=>this.computeViews(e,t,a,s).next((l=>{let d=Pl();return l.forEach(((f,m)=>{d=d.insert(f,m.overlayedDocument)})),d}))))}getOverlayedDocuments(e,t){const s=ba();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,yt())))}populateOverlays(e,t,s){const a=[];return s.forEach((l=>{t.has(l)||a.push(l)})),this.documentOverlayCache.getOverlays(e,a).next((l=>{l.forEach(((d,f)=>{t.set(d,f)}))}))}computeViews(e,t,s,a){let l=gi();const d=Vl(),f=(function(){return Vl()})();return t.forEach(((m,v)=>{const w=s.get(v.key);a.has(v.key)&&(w===void 0||w.mutation instanceof oa)?l=l.insert(v.key,v):w!==void 0?(d.set(v.key,w.mutation.getFieldMask()),Ol(w.mutation,v,w.mutation.getFieldMask(),Bt.now())):d.set(v.key,Mr.empty())})),this.recalculateAndSaveOverlays(e,l).next((m=>(m.forEach(((v,w)=>d.set(v,w))),t.forEach(((v,w)=>{var S;return f.set(v,new Hb(w,(S=d.get(v))!==null&&S!==void 0?S:null))})),f)))}recalculateAndSaveOverlays(e,t){const s=Vl();let a=new Kt(((d,f)=>d-f)),l=yt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((d=>{for(const f of d)f.keys().forEach((m=>{const v=t.get(m);if(v===null)return;let w=s.get(m)||Mr.empty();w=f.applyToLocalView(v,w),s.set(m,w);const S=(a.get(f.batchId)||yt()).add(m);a=a.insert(f.batchId,S)}))})).next((()=>{const d=[],f=a.getReverseIterator();for(;f.hasNext();){const m=f.getNext(),v=m.key,w=m.value,S=G0();w.forEach((I=>{if(!l.has(I)){const U=J0(t.get(I),s.get(I));U!==null&&S.set(I,U),l=l.add(I)}})),d.push(this.documentOverlayCache.saveOverlays(e,v,S))}return ce.waitFor(d)})).next((()=>s))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((s=>this.recalculateAndSaveOverlays(e,s)))}getDocumentsMatchingQuery(e,t,s,a){return(function(d){return Ye.isDocumentKey(d.path)&&d.collectionGroup===null&&d.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):QI(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,s,a):this.getDocumentsMatchingCollectionQuery(e,t,s,a)}getNextDocuments(e,t,s,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,s,a).next((l=>{const d=a-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,s.largestBatchId,a-l.size):ce.resolve(ba());let f=$l,m=l;return d.next((v=>ce.forEach(v,((w,S)=>(f<S.largestBatchId&&(f=S.largestBatchId),l.get(w)?ce.resolve():this.remoteDocumentCache.getEntry(e,w).next((I=>{m=m.insert(w,I)}))))).next((()=>this.populateOverlays(e,v,l))).next((()=>this.computeViews(e,m,v,yt()))).next((w=>({batchId:f,changes:W0(w)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ye(t)).next((s=>{let a=Pl();return s.isFoundDocument()&&(a=a.insert(s.key,s)),a}))}getDocumentsMatchingCollectionGroupQuery(e,t,s,a){const l=t.collectionGroup;let d=Pl();return this.indexManager.getCollectionParents(e,l).next((f=>ce.forEach(f,(m=>{const v=(function(S,I){return new ad(I,null,S.explicitOrderBy.slice(),S.filters.slice(),S.limit,S.limitType,S.startAt,S.endAt)})(t,m.child(l));return this.getDocumentsMatchingCollectionQuery(e,v,s,a).next((w=>{w.forEach(((S,I)=>{d=d.insert(S,I)}))}))})).next((()=>d))))}getDocumentsMatchingCollectionQuery(e,t,s,a){let l;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,s.largestBatchId).next((d=>(l=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,s,l,a)))).next((d=>{l.forEach(((m,v)=>{const w=v.getKey();d.get(w)===null&&(d=d.insert(w,ar.newInvalidDocument(w)))}));let f=Pl();return d.forEach(((m,v)=>{const w=l.get(m);w!==void 0&&Ol(w.mutation,v,Mr.empty(),Bt.now()),cd(t,v)&&(f=f.insert(m,v))})),f}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kb{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,t){return ce.resolve(this.Br.get(t))}saveBundleMetadata(e,t){return this.Br.set(t.id,(function(a){return{id:a.id,version:a.version,createTime:Os(a.createTime)}})(t)),ce.resolve()}getNamedQuery(e,t){return ce.resolve(this.Lr.get(t))}saveNamedQuery(e,t){return this.Lr.set(t.name,(function(a){return{name:a.name,query:Ob(a.bundledQuery),readTime:Os(a.readTime)}})(t)),ce.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qb{constructor(){this.overlays=new Kt(Ye.comparator),this.kr=new Map}getOverlay(e,t){return ce.resolve(this.overlays.get(t))}getOverlays(e,t){const s=ba();return ce.forEach(t,(a=>this.getOverlay(e,a).next((l=>{l!==null&&s.set(a,l)})))).next((()=>s))}saveOverlays(e,t,s){return s.forEach(((a,l)=>{this.wt(e,t,l)})),ce.resolve()}removeOverlaysForBatchId(e,t,s){const a=this.kr.get(s);return a!==void 0&&(a.forEach((l=>this.overlays=this.overlays.remove(l))),this.kr.delete(s)),ce.resolve()}getOverlaysForCollection(e,t,s){const a=ba(),l=t.length+1,d=new Ye(t.child("")),f=this.overlays.getIteratorFrom(d);for(;f.hasNext();){const m=f.getNext().value,v=m.getKey();if(!t.isPrefixOf(v.path))break;v.path.length===l&&m.largestBatchId>s&&a.set(m.getKey(),m)}return ce.resolve(a)}getOverlaysForCollectionGroup(e,t,s,a){let l=new Kt(((v,w)=>v-w));const d=this.overlays.getIterator();for(;d.hasNext();){const v=d.getNext().value;if(v.getKey().getCollectionGroup()===t&&v.largestBatchId>s){let w=l.get(v.largestBatchId);w===null&&(w=ba(),l=l.insert(v.largestBatchId,w)),w.set(v.getKey(),v)}}const f=ba(),m=l.getIterator();for(;m.hasNext()&&(m.getNext().value.forEach(((v,w)=>f.set(v,w))),!(f.size()>=a)););return ce.resolve(f)}wt(e,t,s){const a=this.overlays.get(s.key);if(a!==null){const d=this.kr.get(a.largestBatchId).delete(s.key);this.kr.set(a.largestBatchId,d)}this.overlays=this.overlays.insert(s.key,new pb(t,s));let l=this.kr.get(t);l===void 0&&(l=yt(),this.kr.set(t,l)),this.kr.set(t,l.add(s.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yb{constructor(){this.sessionToken=Hn.EMPTY_BYTE_STRING}getSessionToken(e){return ce.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ce.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wp{constructor(){this.qr=new Tn(Vn.Qr),this.$r=new Tn(Vn.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,t){const s=new Vn(e,t);this.qr=this.qr.add(s),this.$r=this.$r.add(s)}Kr(e,t){e.forEach((s=>this.addReference(s,t)))}removeReference(e,t){this.Wr(new Vn(e,t))}Gr(e,t){e.forEach((s=>this.removeReference(s,t)))}zr(e){const t=new Ye(new zt([])),s=new Vn(t,e),a=new Vn(t,e+1),l=[];return this.$r.forEachInRange([s,a],(d=>{this.Wr(d),l.push(d.key)})),l}jr(){this.qr.forEach((e=>this.Wr(e)))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const t=new Ye(new zt([])),s=new Vn(t,e),a=new Vn(t,e+1);let l=yt();return this.$r.forEachInRange([s,a],(d=>{l=l.add(d.key)})),l}containsKey(e){const t=new Vn(e,0),s=this.qr.firstAfterOrEqual(t);return s!==null&&e.isEqual(s.key)}}class Vn{constructor(e,t){this.key=e,this.Hr=t}static Qr(e,t){return Ye.comparator(e.key,t.key)||ht(e.Hr,t.Hr)}static Ur(e,t){return ht(e.Hr,t.Hr)||Ye.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jb{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.er=1,this.Yr=new Tn(Vn.Qr)}checkEmpty(e){return ce.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,s,a){const l=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new fb(l,t,s,a);this.mutationQueue.push(d);for(const f of a)this.Yr=this.Yr.add(new Vn(f.key,l)),this.indexManager.addToCollectionParentIndex(e,f.key.path.popLast());return ce.resolve(d)}lookupMutationBatch(e,t){return ce.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const s=t+1,a=this.Xr(s),l=a<0?0:a;return ce.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return ce.resolve(this.mutationQueue.length===0?up:this.er-1)}getAllMutationBatches(e){return ce.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const s=new Vn(t,0),a=new Vn(t,Number.POSITIVE_INFINITY),l=[];return this.Yr.forEachInRange([s,a],(d=>{const f=this.Zr(d.Hr);l.push(f)})),ce.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new Tn(ht);return t.forEach((a=>{const l=new Vn(a,0),d=new Vn(a,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([l,d],(f=>{s=s.add(f.Hr)}))})),ce.resolve(this.ei(s))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,a=s.length+1;let l=s;Ye.isDocumentKey(l)||(l=l.child(""));const d=new Vn(new Ye(l),0);let f=new Tn(ht);return this.Yr.forEachWhile((m=>{const v=m.key.path;return!!s.isPrefixOf(v)&&(v.length===a&&(f=f.add(m.Hr)),!0)}),d),ce.resolve(this.ei(f))}ei(e){const t=[];return e.forEach((s=>{const a=this.Zr(s);a!==null&&t.push(a)})),t}removeMutationBatch(e,t){Pt(this.ti(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let s=this.Yr;return ce.forEach(t.mutations,(a=>{const l=new Vn(a.key,t.batchId);return s=s.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((()=>{this.Yr=s}))}rr(e){}containsKey(e,t){const s=new Vn(t,0),a=this.Yr.firstAfterOrEqual(s);return ce.resolve(t.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,ce.resolve()}ti(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xb{constructor(e){this.ni=e,this.docs=(function(){return new Kt(Ye.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const s=t.key,a=this.docs.get(s),l=a?a.size:0,d=this.ni(t);return this.docs=this.docs.insert(s,{document:t.mutableCopy(),size:d}),this.size+=d-l,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const s=this.docs.get(t);return ce.resolve(s?s.document.mutableCopy():ar.newInvalidDocument(t))}getEntries(e,t){let s=gi();return t.forEach((a=>{const l=this.docs.get(a);s=s.insert(a,l?l.document.mutableCopy():ar.newInvalidDocument(a))})),ce.resolve(s)}getDocumentsMatchingQuery(e,t,s,a){let l=gi();const d=t.path,f=new Ye(d.child("__id-9223372036854775808__")),m=this.docs.getIteratorFrom(f);for(;m.hasNext();){const{key:v,value:{document:w}}=m.getNext();if(!d.isPrefixOf(v.path))break;v.path.length>d.length+1||II(CI(w),s)<=0||(a.has(w.key)||cd(t,w))&&(l=l.insert(w.key,w.mutableCopy()))}return ce.resolve(l)}getAllFromCollectionGroup(e,t,s,a){nt(9500)}ri(e,t){return ce.forEach(this.docs,(s=>t(s)))}newChangeBuffer(e){return new Zb(this)}getSize(e){return ce.resolve(this.size)}}class Zb extends Gb{constructor(e){super(),this.Or=e}applyChanges(e){const t=[];return this.changes.forEach(((s,a)=>{a.isValidDocument()?t.push(this.Or.addEntry(e,a)):this.Or.removeEntry(s)})),ce.waitFor(t)}getFromCache(e,t){return this.Or.getEntry(e,t)}getAllFromCache(e,t){return this.Or.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eP{constructor(e){this.persistence=e,this.ii=new La((t=>fp(t)),pp),this.lastRemoteSnapshotVersion=at.min(),this.highestTargetId=0,this.si=0,this.oi=new wp,this.targetCount=0,this._i=Do.ar()}forEachTarget(e,t){return this.ii.forEach(((s,a)=>t(a))),ce.resolve()}getLastRemoteSnapshotVersion(e){return ce.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ce.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),ce.resolve(this.highestTargetId)}setTargetsMetadata(e,t,s){return s&&(this.lastRemoteSnapshotVersion=s),t>this.si&&(this.si=t),ce.resolve()}hr(e){this.ii.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this._i=new Do(t),this.highestTargetId=t),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,t){return this.hr(t),this.targetCount+=1,ce.resolve()}updateTargetData(e,t){return this.hr(t),ce.resolve()}removeTargetData(e,t){return this.ii.delete(t.target),this.oi.zr(t.targetId),this.targetCount-=1,ce.resolve()}removeTargets(e,t,s){let a=0;const l=[];return this.ii.forEach(((d,f)=>{f.sequenceNumber<=t&&s.get(f.targetId)===null&&(this.ii.delete(d),l.push(this.removeMatchingKeysForTargetId(e,f.targetId)),a++)})),ce.waitFor(l).next((()=>a))}getTargetCount(e){return ce.resolve(this.targetCount)}getTargetData(e,t){const s=this.ii.get(t)||null;return ce.resolve(s)}addMatchingKeys(e,t,s){return this.oi.Kr(t,s),ce.resolve()}removeMatchingKeys(e,t,s){this.oi.Gr(t,s);const a=this.persistence.referenceDelegate,l=[];return a&&t.forEach((d=>{l.push(a.markPotentiallyOrphaned(e,d))})),ce.waitFor(l)}removeMatchingKeysForTargetId(e,t){return this.oi.zr(t),ce.resolve()}getMatchingKeysForTargetId(e,t){const s=this.oi.Jr(t);return ce.resolve(s)}containsKey(e,t){return ce.resolve(this.oi.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uw{constructor(e,t){this.ai={},this.overlays={},this.ui=new rd(0),this.ci=!1,this.ci=!0,this.li=new Yb,this.referenceDelegate=e(this),this.hi=new eP(this),this.indexManager=new Mb,this.remoteDocumentCache=(function(a){return new Xb(a)})((s=>this.referenceDelegate.Pi(s))),this.serializer=new Vb(t),this.Ti=new Kb(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Qb,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let s=this.ai[e.toKey()];return s||(s=new Jb(t,this.referenceDelegate),this.ai[e.toKey()]=s),s}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,t,s){Oe("MemoryPersistence","Starting transaction:",e);const a=new tP(this.ui.next());return this.referenceDelegate.Ii(),s(a).next((l=>this.referenceDelegate.di(a).next((()=>l)))).toPromise().then((l=>(a.raiseOnCommittedEvent(),l)))}Ei(e,t){return ce.or(Object.values(this.ai).map((s=>()=>s.containsKey(e,t))))}}class tP extends PI{constructor(e){super(),this.currentSequenceNumber=e}}class xp{constructor(e){this.persistence=e,this.Ai=new wp,this.Ri=null}static Vi(e){return new xp(e)}get mi(){if(this.Ri)return this.Ri;throw nt(60996)}addReference(e,t,s){return this.Ai.addReference(s,t),this.mi.delete(s.toString()),ce.resolve()}removeReference(e,t,s){return this.Ai.removeReference(s,t),this.mi.add(s.toString()),ce.resolve()}markPotentiallyOrphaned(e,t){return this.mi.add(t.toString()),ce.resolve()}removeTarget(e,t){this.Ai.zr(t.targetId).forEach((a=>this.mi.add(a.toString())));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,t.targetId).next((a=>{a.forEach((l=>this.mi.add(l.toString())))})).next((()=>s.removeTargetData(e,t)))}Ii(){this.Ri=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ce.forEach(this.mi,(s=>{const a=Ye.fromPath(s);return this.fi(e,a).next((l=>{l||t.removeEntry(a,at.min())}))})).next((()=>(this.Ri=null,t.apply(e))))}updateLimboDocument(e,t){return this.fi(e,t).next((s=>{s?this.mi.delete(t.toString()):this.mi.add(t.toString())}))}Pi(e){return 0}fi(e,t){return ce.or([()=>ce.resolve(this.Ai.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class Wu{constructor(e,t){this.persistence=e,this.gi=new La((s=>AI(s.path)),((s,a)=>s.isEqual(a))),this.garbageCollector=Wb(this,t)}static Vi(e,t){return new Wu(e,t)}Ii(){}di(e){return ce.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}mr(e){const t=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next((s=>t.next((a=>s+a))))}yr(e){let t=0;return this.gr(e,(s=>{t++})).next((()=>t))}gr(e,t){return ce.forEach(this.gi,((s,a)=>this.Sr(e,s,a).next((l=>l?ce.resolve():t(a)))))}removeTargets(e,t,s){return this.persistence.getTargetCache().removeTargets(e,t,s)}removeOrphanedDocuments(e,t){let s=0;const a=this.persistence.getRemoteDocumentCache(),l=a.newChangeBuffer();return a.ri(e,(d=>this.Sr(e,d,t).next((f=>{f||(s++,l.removeEntry(d,at.min()))})))).next((()=>l.apply(e))).next((()=>s))}markPotentiallyOrphaned(e,t){return this.gi.set(t,e.currentSequenceNumber),ce.resolve()}removeTarget(e,t){const s=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,s)}addReference(e,t,s){return this.gi.set(s,e.currentSequenceNumber),ce.resolve()}removeReference(e,t,s){return this.gi.set(s,e.currentSequenceNumber),ce.resolve()}updateLimboDocument(e,t){return this.gi.set(t,e.currentSequenceNumber),ce.resolve()}Pi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Tu(e.data.value)),t}Sr(e,t,s){return ce.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const a=this.gi.get(t);return ce.resolve(a!==void 0&&a>s)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ep{constructor(e,t,s,a){this.targetId=e,this.fromCache=t,this.Is=s,this.ds=a}static Es(e,t){let s=yt(),a=yt();for(const l of t.docChanges)switch(l.type){case 0:s=s.add(l.doc.key);break;case 1:a=a.add(l.doc.key)}return new Ep(e,t.fromCache,s,a)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nP{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rP{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=(function(){return AT()?8:RI(or())>0?6:4})()}initialize(e,t){this.gs=e,this.indexManager=t,this.As=!0}getDocumentsMatchingQuery(e,t,s,a){const l={result:null};return this.ps(e,t).next((d=>{l.result=d})).next((()=>{if(!l.result)return this.ys(e,t,a,s).next((d=>{l.result=d}))})).next((()=>{if(l.result)return;const d=new nP;return this.ws(e,t,d).next((f=>{if(l.result=f,this.Rs)return this.Ss(e,t,d,f.size)}))})).next((()=>l.result))}Ss(e,t,s,a){return s.documentReadCount<this.Vs?(vo()<=gt.DEBUG&&Oe("QueryEngine","SDK will not create cache indexes for query:",_o(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),ce.resolve()):(vo()<=gt.DEBUG&&Oe("QueryEngine","Query:",_o(t),"scans",s.documentReadCount,"local documents and returns",a,"documents as results."),s.documentReadCount>this.fs*a?(vo()<=gt.DEBUG&&Oe("QueryEngine","The SDK decides to create cache indexes for query:",_o(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Vs(t))):ce.resolve())}ps(e,t){if(dv(t))return ce.resolve(null);let s=Vs(t);return this.indexManager.getIndexType(e,s).next((a=>a===0?null:(t.limit!==null&&a===1&&(t=Rf(t,null,"F"),s=Vs(t)),this.indexManager.getDocumentsMatchingTarget(e,s).next((l=>{const d=yt(...l);return this.gs.getDocuments(e,d).next((f=>this.indexManager.getMinOffset(e,s).next((m=>{const v=this.bs(t,f);return this.Ds(t,v,d,m.readTime)?this.ps(e,Rf(t,null,"F")):this.vs(e,v,t,m)}))))})))))}ys(e,t,s,a){return dv(t)||a.isEqual(at.min())?ce.resolve(null):this.gs.getDocuments(e,s).next((l=>{const d=this.bs(t,l);return this.Ds(t,d,s,a)?ce.resolve(null):(vo()<=gt.DEBUG&&Oe("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),_o(t)),this.vs(e,d,t,SI(a,$l)).next((f=>f)))}))}bs(e,t){let s=new Tn(B0(e));return t.forEach(((a,l)=>{cd(e,l)&&(s=s.add(l))})),s}Ds(e,t,s,a){if(e.limit===null)return!1;if(s.size!==t.size)return!0;const l=e.limitType==="F"?t.last():t.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(a)>0)}ws(e,t,s){return vo()<=gt.DEBUG&&Oe("QueryEngine","Using full collection scan to execute query:",_o(t)),this.gs.getDocumentsMatchingQuery(e,t,Yi.min(),s)}vs(e,t,s,a){return this.gs.getDocumentsMatchingQuery(e,s,a).next((l=>(t.forEach((d=>{l=l.insert(d.key,d)})),l)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tp="LocalStore",sP=3e8;class iP{constructor(e,t,s,a){this.persistence=e,this.Cs=t,this.serializer=a,this.Fs=new Kt(ht),this.Ms=new La((l=>fp(l)),pp),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(s)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new qb(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Fs)))}}function aP(n,e,t,s){return new iP(n,e,t,s)}async function dw(n,e){const t=ot(n);return await t.persistence.runTransaction("Handle user change","readonly",(s=>{let a;return t.mutationQueue.getAllMutationBatches(s).next((l=>(a=l,t.Ns(e),t.mutationQueue.getAllMutationBatches(s)))).next((l=>{const d=[],f=[];let m=yt();for(const v of a){d.push(v.batchId);for(const w of v.mutations)m=m.add(w.key)}for(const v of l){f.push(v.batchId);for(const w of v.mutations)m=m.add(w.key)}return t.localDocuments.getDocuments(s,m).next((v=>({Bs:v,removedBatchIds:d,addedBatchIds:f})))}))}))}function oP(n,e){const t=ot(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(s=>{const a=e.batch.keys(),l=t.Os.newChangeBuffer({trackRemovals:!0});return(function(f,m,v,w){const S=v.batch,I=S.keys();let U=ce.resolve();return I.forEach((Z=>{U=U.next((()=>w.getEntry(m,Z))).next((Q=>{const M=v.docVersions.get(Z);Pt(M!==null,48541),Q.version.compareTo(M)<0&&(S.applyToRemoteDocument(Q,v),Q.isValidDocument()&&(Q.setReadTime(v.commitVersion),w.addEntry(Q)))}))})),U.next((()=>f.mutationQueue.removeMutationBatch(m,S)))})(t,s,e,l).next((()=>l.apply(s))).next((()=>t.mutationQueue.performConsistencyCheck(s))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(s,a,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,(function(f){let m=yt();for(let v=0;v<f.mutationResults.length;++v)f.mutationResults[v].transformResults.length>0&&(m=m.add(f.batch.mutations[v].key));return m})(e)))).next((()=>t.localDocuments.getDocuments(s,a)))}))}function hw(n){const e=ot(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.hi.getLastRemoteSnapshotVersion(t)))}function lP(n,e){const t=ot(n),s=e.snapshotVersion;let a=t.Fs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const d=t.Os.newChangeBuffer({trackRemovals:!0});a=t.Fs;const f=[];e.targetChanges.forEach(((w,S)=>{const I=a.get(S);if(!I)return;f.push(t.hi.removeMatchingKeys(l,w.removedDocuments,S).next((()=>t.hi.addMatchingKeys(l,w.addedDocuments,S))));let U=I.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(S)!==null?U=U.withResumeToken(Hn.EMPTY_BYTE_STRING,at.min()).withLastLimboFreeSnapshotVersion(at.min()):w.resumeToken.approximateByteSize()>0&&(U=U.withResumeToken(w.resumeToken,s)),a=a.insert(S,U),(function(Q,M,ne){return Q.resumeToken.approximateByteSize()===0||M.snapshotVersion.toMicroseconds()-Q.snapshotVersion.toMicroseconds()>=sP?!0:ne.addedDocuments.size+ne.modifiedDocuments.size+ne.removedDocuments.size>0})(I,U,w)&&f.push(t.hi.updateTargetData(l,U))}));let m=gi(),v=yt();if(e.documentUpdates.forEach((w=>{e.resolvedLimboDocuments.has(w)&&f.push(t.persistence.referenceDelegate.updateLimboDocument(l,w))})),f.push(cP(l,d,e.documentUpdates).next((w=>{m=w.Ls,v=w.ks}))),!s.isEqual(at.min())){const w=t.hi.getLastRemoteSnapshotVersion(l).next((S=>t.hi.setTargetsMetadata(l,l.currentSequenceNumber,s)));f.push(w)}return ce.waitFor(f).next((()=>d.apply(l))).next((()=>t.localDocuments.getLocalViewOfDocuments(l,m,v))).next((()=>m))})).then((l=>(t.Fs=a,l)))}function cP(n,e,t){let s=yt(),a=yt();return t.forEach((l=>s=s.add(l))),e.getEntries(n,s).next((l=>{let d=gi();return t.forEach(((f,m)=>{const v=l.get(f);m.isFoundDocument()!==v.isFoundDocument()&&(a=a.add(f)),m.isNoDocument()&&m.version.isEqual(at.min())?(e.removeEntry(f,m.readTime),d=d.insert(f,m)):!v.isValidDocument()||m.version.compareTo(v.version)>0||m.version.compareTo(v.version)===0&&v.hasPendingWrites?(e.addEntry(m),d=d.insert(f,m)):Oe(Tp,"Ignoring outdated watch update for ",f,". Current version:",v.version," Watch version:",m.version)})),{Ls:d,ks:a}}))}function uP(n,e){const t=ot(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(s=>(e===void 0&&(e=up),t.mutationQueue.getNextMutationBatchAfterBatchId(s,e))))}function dP(n,e){const t=ot(n);return t.persistence.runTransaction("Allocate target","readwrite",(s=>{let a;return t.hi.getTargetData(s,e).next((l=>l?(a=l,ce.resolve(a)):t.hi.allocateTargetId(s).next((d=>(a=new Bi(e,d,"TargetPurposeListen",s.currentSequenceNumber),t.hi.addTargetData(s,a).next((()=>a)))))))})).then((s=>{const a=t.Fs.get(s.targetId);return(a===null||s.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(t.Fs=t.Fs.insert(s.targetId,s),t.Ms.set(e,s.targetId)),s}))}async function Df(n,e,t){const s=ot(n),a=s.Fs.get(e),l=t?"readwrite":"readwrite-primary";try{t||await s.persistence.runTransaction("Release target",l,(d=>s.persistence.referenceDelegate.removeTarget(d,a)))}catch(d){if(!Wo(d))throw d;Oe(Tp,`Failed to update sequence numbers for target ${e}: ${d}`)}s.Fs=s.Fs.remove(e),s.Ms.delete(a.target)}function Sv(n,e,t){const s=ot(n);let a=at.min(),l=yt();return s.persistence.runTransaction("Execute query","readwrite",(d=>(function(m,v,w){const S=ot(m),I=S.Ms.get(w);return I!==void 0?ce.resolve(S.Fs.get(I)):S.hi.getTargetData(v,w)})(s,d,Vs(e)).next((f=>{if(f)return a=f.lastLimboFreeSnapshotVersion,s.hi.getMatchingKeysForTargetId(d,f.targetId).next((m=>{l=m}))})).next((()=>s.Cs.getDocumentsMatchingQuery(d,e,t?a:at.min(),t?l:yt()))).next((f=>(hP(s,JI(e),f),{documents:f,qs:l})))))}function hP(n,e,t){let s=n.xs.get(e)||at.min();t.forEach(((a,l)=>{l.readTime.compareTo(s)>0&&(s=l.readTime)})),n.xs.set(e,s)}class Cv{constructor(){this.activeTargetIds=rb()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class fP{constructor(){this.Fo=new Cv,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,s){}addLocalQueryTarget(e,t=!0){return t&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,t,s){this.Mo[e]=t}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new Cv,Promise.resolve()}handleUserChange(e,t,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pP{xo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iv="ConnectivityMonitor";class bv{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){Oe(Iv,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){Oe(Iv,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gu=null;function Lf(){return gu===null?gu=(function(){return 268435456+Math.round(2147483648*Math.random())})():gu++,"0x"+gu.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const af="RestConnection",mP={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class gP{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.$o=t+"://"+e.host,this.Uo=`projects/${s}/databases/${a}`,this.Ko=this.databaseId.database===Mu?`project_id=${s}`:`project_id=${s}&database_id=${a}`}Wo(e,t,s,a,l){const d=Lf(),f=this.Go(e,t.toUriEncodedString());Oe(af,`Sending RPC '${e}' ${d}:`,f,s);const m={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(m,a,l);const{host:v}=new URL(f),w=Mo(v);return this.jo(e,f,m,s,w).then((S=>(Oe(af,`Received RPC '${e}' ${d}: `,S),S)),(S=>{throw Qi(af,`RPC '${e}' ${d} failed with error: `,S,"url: ",f,"request:",s),S}))}Jo(e,t,s,a,l,d){return this.Wo(e,t,s,a,l)}zo(e,t,s){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Bo})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((a,l)=>e[l]=a)),s&&s.headers.forEach(((a,l)=>e[l]=a))}Go(e,t){const s=mP[e];return`${this.$o}/v1/${t}:${s}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yP{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rr="WebChannelConnection";class vP extends gP{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,t,s,a,l){const d=Lf();return new Promise(((f,m)=>{const v=new m0;v.setWithCredentials(!0),v.listenOnce(g0.COMPLETE,(()=>{try{switch(v.getLastErrorCode()){case Eu.NO_ERROR:const S=v.getResponseJson();Oe(rr,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(S)),f(S);break;case Eu.TIMEOUT:Oe(rr,`RPC '${e}' ${d} timed out`),m(new Be(de.DEADLINE_EXCEEDED,"Request time out"));break;case Eu.HTTP_ERROR:const I=v.getStatus();if(Oe(rr,`RPC '${e}' ${d} failed with status:`,I,"response text:",v.getResponseText()),I>0){let U=v.getResponseJson();Array.isArray(U)&&(U=U[0]);const Z=U==null?void 0:U.error;if(Z&&Z.status&&Z.message){const Q=(function(ne){const xe=ne.toLowerCase().replace(/_/g,"-");return Object.values(de).indexOf(xe)>=0?xe:de.UNKNOWN})(Z.status);m(new Be(Q,Z.message))}else m(new Be(de.UNKNOWN,"Server responded with status "+v.getStatus()))}else m(new Be(de.UNAVAILABLE,"Connection failed."));break;default:nt(9055,{c_:e,streamId:d,l_:v.getLastErrorCode(),h_:v.getLastError()})}}finally{Oe(rr,`RPC '${e}' ${d} completed.`)}}));const w=JSON.stringify(a);Oe(rr,`RPC '${e}' ${d} sending request:`,a),v.send(t,"POST",w,s,15)}))}P_(e,t,s){const a=Lf(),l=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=_0(),f=v0(),m={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},v=this.longPollingOptions.timeoutSeconds;v!==void 0&&(m.longPollingTimeout=Math.round(1e3*v)),this.useFetchStreams&&(m.useFetchStreams=!0),this.zo(m.initMessageHeaders,t,s),m.encodeInitMessageHeaders=!0;const w=l.join("");Oe(rr,`Creating RPC '${e}' stream ${a}: ${w}`,m);const S=d.createWebChannel(w,m);this.T_(S);let I=!1,U=!1;const Z=new yP({Ho:M=>{U?Oe(rr,`Not sending because RPC '${e}' stream ${a} is closed:`,M):(I||(Oe(rr,`Opening RPC '${e}' stream ${a} transport.`),S.open(),I=!0),Oe(rr,`RPC '${e}' stream ${a} sending:`,M),S.send(M))},Yo:()=>S.close()}),Q=(M,ne,xe)=>{M.listen(ne,(we=>{try{xe(we)}catch(Ee){setTimeout((()=>{throw Ee}),0)}}))};return Q(S,bl.EventType.OPEN,(()=>{U||(Oe(rr,`RPC '${e}' stream ${a} transport opened.`),Z.s_())})),Q(S,bl.EventType.CLOSE,(()=>{U||(U=!0,Oe(rr,`RPC '${e}' stream ${a} transport closed`),Z.__(),this.I_(S))})),Q(S,bl.EventType.ERROR,(M=>{U||(U=!0,Qi(rr,`RPC '${e}' stream ${a} transport errored. Name:`,M.name,"Message:",M.message),Z.__(new Be(de.UNAVAILABLE,"The operation could not be completed")))})),Q(S,bl.EventType.MESSAGE,(M=>{var ne;if(!U){const xe=M.data[0];Pt(!!xe,16349);const we=xe,Ee=(we==null?void 0:we.error)||((ne=we[0])===null||ne===void 0?void 0:ne.error);if(Ee){Oe(rr,`RPC '${e}' stream ${a} received error:`,Ee);const le=Ee.status;let Re=(function(R){const O=hn[R];if(O!==void 0)return Z0(O)})(le),A=Ee.message;Re===void 0&&(Re=de.INTERNAL,A="Unknown error status: "+le+" with message "+Ee.message),U=!0,Z.__(new Be(Re,A)),S.close()}else Oe(rr,`RPC '${e}' stream ${a} received:`,xe),Z.a_(xe)}})),Q(f,y0.STAT_EVENT,(M=>{M.stat===Tf.PROXY?Oe(rr,`RPC '${e}' stream ${a} detected buffering proxy`):M.stat===Tf.NOPROXY&&Oe(rr,`RPC '${e}' stream ${a} detected no buffering proxy`)})),setTimeout((()=>{Z.o_()}),0),Z}terminate(){this.u_.forEach((e=>e.close())),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter((t=>t===e))}}function of(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fd(n){return new Eb(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fw{constructor(e,t,s=1e3,a=1.5,l=6e4){this.Fi=e,this.timerId=t,this.d_=s,this.E_=a,this.A_=l,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const t=Math.floor(this.R_+this.p_()),s=Math.max(0,Date.now()-this.m_),a=Math.max(0,t-s);a>0&&Oe("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.R_} ms, delay with jitter: ${t} ms, last attempt: ${s} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,a,(()=>(this.m_=Date.now(),e()))),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pv="PersistentStream";class pw{constructor(e,t,s,a,l,d,f,m){this.Fi=e,this.w_=s,this.S_=a,this.connection=l,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=f,this.listener=m,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new fw(e,t)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,(()=>this.L_())))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():t&&t.code===de.RESOURCE_EXHAUSTED?(mi(t.toString()),mi("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):t&&t.code===de.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(t)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),t=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([s,a])=>{this.b_===t&&this.W_(s,a)}),(s=>{e((()=>{const a=new Be(de.UNKNOWN,"Fetching auth token failed: "+s.message);return this.G_(a)}))}))}W_(e,t){const s=this.K_(this.b_);this.stream=this.z_(e,t),this.stream.Zo((()=>{s((()=>this.listener.Zo()))})),this.stream.e_((()=>{s((()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,(()=>(this.x_()&&(this.state=3),Promise.resolve()))),this.listener.e_())))})),this.stream.n_((a=>{s((()=>this.G_(a)))})),this.stream.onMessage((a=>{s((()=>++this.C_==1?this.j_(a):this.onNext(a)))}))}O_(){this.state=5,this.F_.g_((async()=>{this.state=0,this.start()}))}G_(e){return Oe(Pv,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return t=>{this.Fi.enqueueAndForget((()=>this.b_===e?t():(Oe(Pv,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class _P extends pw{constructor(e,t,s,a,l,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,s,a,d),this.serializer=l}z_(e,t){return this.connection.P_("Listen",e,t)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const t=Cb(this.serializer,e),s=(function(l){if(!("targetChange"in l))return at.min();const d=l.targetChange;return d.targetIds&&d.targetIds.length?at.min():d.readTime?Os(d.readTime):at.min()})(e);return this.listener.J_(t,s)}H_(e){const t={};t.database=jf(this.serializer),t.addTarget=(function(l,d){let f;const m=d.target;if(f=Pf(m)?{documents:Pb(l,m)}:{query:Rb(l,m).Vt},f.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){f.resumeToken=nw(l,d.resumeToken);const v=Nf(l,d.expectedCount);v!==null&&(f.expectedCount=v)}else if(d.snapshotVersion.compareTo(at.min())>0){f.readTime=$u(l,d.snapshotVersion.toTimestamp());const v=Nf(l,d.expectedCount);v!==null&&(f.expectedCount=v)}return f})(this.serializer,e);const s=Ab(this.serializer,e);s&&(t.labels=s),this.k_(t)}Y_(e){const t={};t.database=jf(this.serializer),t.removeTarget=e,this.k_(t)}}class wP extends pw{constructor(e,t,s,a,l,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,s,a,d),this.serializer=l}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,t){return this.connection.P_("Write",e,t)}j_(e){return Pt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Pt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){Pt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();const t=bb(e.writeResults,e.commitTime),s=Os(e.commitTime);return this.listener.ta(s,t)}na(){const e={};e.database=jf(this.serializer),this.k_(e)}X_(e){const t={streamToken:this.lastStreamToken,writes:e.map((s=>Ib(this.serializer,s)))};this.k_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xP{}class EP extends xP{constructor(e,t,s,a){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=s,this.serializer=a,this.ra=!1}ia(){if(this.ra)throw new Be(de.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,s,a){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,d])=>this.connection.Wo(e,Af(t,s),a,l,d))).catch((l=>{throw l.name==="FirebaseError"?(l.code===de.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new Be(de.UNKNOWN,l.toString())}))}Jo(e,t,s,a,l){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([d,f])=>this.connection.Jo(e,Af(t,s),a,d,f,l))).catch((d=>{throw d.name==="FirebaseError"?(d.code===de.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new Be(de.UNKNOWN,d.toString())}))}terminate(){this.ra=!0,this.connection.terminate()}}class TP{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve()))))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(mi(t),this._a=!1):Oe("OnlineStateTracker",t)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Da="RemoteStore";class SP{constructor(e,t,s,a,l){this.localStore=e,this.datastore=t,this.asyncQueue=s,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=l,this.Ea.xo((d=>{s.enqueueAndForget((async()=>{Va(this)&&(Oe(Da,"Restarting streams for network reachability change."),await(async function(m){const v=ot(m);v.Ia.add(4),await ic(v),v.Aa.set("Unknown"),v.Ia.delete(4),await pd(v)})(this))}))})),this.Aa=new TP(s,a)}}async function pd(n){if(Va(n))for(const e of n.da)await e(!0)}async function ic(n){for(const e of n.da)await e(!1)}function mw(n,e){const t=ot(n);t.Ta.has(e.targetId)||(t.Ta.set(e.targetId,e),bp(t)?Ip(t):Go(t).x_()&&Cp(t,e))}function Sp(n,e){const t=ot(n),s=Go(t);t.Ta.delete(e),s.x_()&&gw(t,e),t.Ta.size===0&&(s.x_()?s.B_():Va(t)&&t.Aa.set("Unknown"))}function Cp(n,e){if(n.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(at.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Go(n).H_(e)}function gw(n,e){n.Ra.$e(e),Go(n).Y_(e)}function Ip(n){n.Ra=new vb({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>n.Ta.get(e)||null,lt:()=>n.datastore.serializer.databaseId}),Go(n).start(),n.Aa.aa()}function bp(n){return Va(n)&&!Go(n).M_()&&n.Ta.size>0}function Va(n){return ot(n).Ia.size===0}function yw(n){n.Ra=void 0}async function CP(n){n.Aa.set("Online")}async function IP(n){n.Ta.forEach(((e,t)=>{Cp(n,e)}))}async function bP(n,e){yw(n),bp(n)?(n.Aa.la(e),Ip(n)):n.Aa.set("Unknown")}async function PP(n,e,t){if(n.Aa.set("Online"),e instanceof tw&&e.state===2&&e.cause)try{await(async function(a,l){const d=l.cause;for(const f of l.targetIds)a.Ta.has(f)&&(await a.remoteSyncer.rejectListen(f,d),a.Ta.delete(f),a.Ra.removeTarget(f))})(n,e)}catch(s){Oe(Da,"Failed to remove targets %s: %s ",e.targetIds.join(","),s),await Gu(n,s)}else if(e instanceof Iu?n.Ra.Ye(e):e instanceof ew?n.Ra.it(e):n.Ra.et(e),!t.isEqual(at.min()))try{const s=await hw(n.localStore);t.compareTo(s)>=0&&await(function(l,d){const f=l.Ra.Pt(d);return f.targetChanges.forEach(((m,v)=>{if(m.resumeToken.approximateByteSize()>0){const w=l.Ta.get(v);w&&l.Ta.set(v,w.withResumeToken(m.resumeToken,d))}})),f.targetMismatches.forEach(((m,v)=>{const w=l.Ta.get(m);if(!w)return;l.Ta.set(m,w.withResumeToken(Hn.EMPTY_BYTE_STRING,w.snapshotVersion)),gw(l,m);const S=new Bi(w.target,m,v,w.sequenceNumber);Cp(l,S)})),l.remoteSyncer.applyRemoteEvent(f)})(n,t)}catch(s){Oe(Da,"Failed to raise snapshot:",s),await Gu(n,s)}}async function Gu(n,e,t){if(!Wo(e))throw e;n.Ia.add(1),await ic(n),n.Aa.set("Offline"),t||(t=()=>hw(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{Oe(Da,"Retrying IndexedDB access"),await t(),n.Ia.delete(1),await pd(n)}))}function vw(n,e){return e().catch((t=>Gu(n,t,e)))}async function md(n){const e=ot(n),t=ea(e);let s=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:up;for(;RP(e);)try{const a=await uP(e.localStore,s);if(a===null){e.Pa.length===0&&t.B_();break}s=a.batchId,NP(e,a)}catch(a){await Gu(e,a)}_w(e)&&ww(e)}function RP(n){return Va(n)&&n.Pa.length<10}function NP(n,e){n.Pa.push(e);const t=ea(n);t.x_()&&t.Z_&&t.X_(e.mutations)}function _w(n){return Va(n)&&!ea(n).M_()&&n.Pa.length>0}function ww(n){ea(n).start()}async function AP(n){ea(n).na()}async function kP(n){const e=ea(n);for(const t of n.Pa)e.X_(t.mutations)}async function jP(n,e,t){const s=n.Pa.shift(),a=yp.from(s,e,t);await vw(n,(()=>n.remoteSyncer.applySuccessfulWrite(a))),await md(n)}async function DP(n,e){e&&ea(n).Z_&&await(async function(s,a){if((function(d){return gb(d)&&d!==de.ABORTED})(a.code)){const l=s.Pa.shift();ea(s).N_(),await vw(s,(()=>s.remoteSyncer.rejectFailedWrite(l.batchId,a))),await md(s)}})(n,e),_w(n)&&ww(n)}async function Rv(n,e){const t=ot(n);t.asyncQueue.verifyOperationInProgress(),Oe(Da,"RemoteStore received new credentials");const s=Va(t);t.Ia.add(3),await ic(t),s&&t.Aa.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ia.delete(3),await pd(t)}async function LP(n,e){const t=ot(n);e?(t.Ia.delete(2),await pd(t)):e||(t.Ia.add(2),await ic(t),t.Aa.set("Unknown"))}function Go(n){return n.Va||(n.Va=(function(t,s,a){const l=ot(t);return l.ia(),new _P(s,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(n.datastore,n.asyncQueue,{Zo:CP.bind(null,n),e_:IP.bind(null,n),n_:bP.bind(null,n),J_:PP.bind(null,n)}),n.da.push((async e=>{e?(n.Va.N_(),bp(n)?Ip(n):n.Aa.set("Unknown")):(await n.Va.stop(),yw(n))}))),n.Va}function ea(n){return n.ma||(n.ma=(function(t,s,a){const l=ot(t);return l.ia(),new wP(s,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),e_:AP.bind(null,n),n_:DP.bind(null,n),ea:kP.bind(null,n),ta:jP.bind(null,n)}),n.da.push((async e=>{e?(n.ma.N_(),await md(n)):(await n.ma.stop(),n.Pa.length>0&&(Oe(Da,`Stopping write stream with ${n.Pa.length} pending writes`),n.Pa=[]))}))),n.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pp{constructor(e,t,s,a,l){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=s,this.op=a,this.removalCallback=l,this.deferred=new di,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((d=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,s,a,l){const d=Date.now()+s,f=new Pp(e,t,d,a,l);return f.start(s),f}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Be(de.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Rp(n,e){if(mi("AsyncQueue",`${e}: ${n}`),Wo(n))return new Be(de.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bo{static emptySet(e){return new bo(e.comparator)}constructor(e){this.comparator=e?(t,s)=>e(t,s)||Ye.comparator(t.key,s.key):(t,s)=>Ye.comparator(t.key,s.key),this.keyedMap=Pl(),this.sortedSet=new Kt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,s)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof bo)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=s.getNext().key;if(!a.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const s=new bo;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=t,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nv{constructor(){this.fa=new Kt(Ye.comparator)}track(e){const t=e.doc.key,s=this.fa.get(t);s?e.type!==0&&s.type===3?this.fa=this.fa.insert(t,e):e.type===3&&s.type!==1?this.fa=this.fa.insert(t,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.fa=this.fa.insert(t,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.fa=this.fa.remove(t):e.type===1&&s.type===2?this.fa=this.fa.insert(t,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):nt(63341,{At:e,ga:s}):this.fa=this.fa.insert(t,e)}pa(){const e=[];return this.fa.inorderTraversal(((t,s)=>{e.push(s)})),e}}class Lo{constructor(e,t,s,a,l,d,f,m,v){this.query=e,this.docs=t,this.oldDocs=s,this.docChanges=a,this.mutatedKeys=l,this.fromCache=d,this.syncStateChanged=f,this.excludesMetadataChanges=m,this.hasCachedResults=v}static fromInitialDocuments(e,t,s,a,l){const d=[];return t.forEach((f=>{d.push({type:0,doc:f})})),new Lo(e,t,bo.emptySet(t),d,s,a,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ld(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,s=e.docChanges;if(t.length!==s.length)return!1;for(let a=0;a<t.length;a++)if(t[a].type!==s[a].type||!t[a].doc.isEqual(s[a].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VP{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some((e=>e.ba()))}}class OP{constructor(){this.queries=Av(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(t,s){const a=ot(t),l=a.queries;a.queries=Av(),l.forEach(((d,f)=>{for(const m of f.wa)m.onError(s)}))})(this,new Be(de.ABORTED,"Firestore shutting down"))}}function Av(){return new La((n=>z0(n)),ld)}async function Np(n,e){const t=ot(n);let s=3;const a=e.query;let l=t.queries.get(a);l?!l.Sa()&&e.ba()&&(s=2):(l=new VP,s=e.ba()?0:1);try{switch(s){case 0:l.ya=await t.onListen(a,!0);break;case 1:l.ya=await t.onListen(a,!1);break;case 2:await t.onFirstRemoteStoreListen(a)}}catch(d){const f=Rp(d,`Initialization of query '${_o(e.query)}' failed`);return void e.onError(f)}t.queries.set(a,l),l.wa.push(e),e.va(t.onlineState),l.ya&&e.Ca(l.ya)&&kp(t)}async function Ap(n,e){const t=ot(n),s=e.query;let a=3;const l=t.queries.get(s);if(l){const d=l.wa.indexOf(e);d>=0&&(l.wa.splice(d,1),l.wa.length===0?a=e.ba()?0:1:!l.Sa()&&e.ba()&&(a=2))}switch(a){case 0:return t.queries.delete(s),t.onUnlisten(s,!0);case 1:return t.queries.delete(s),t.onUnlisten(s,!1);case 2:return t.onLastRemoteStoreUnlisten(s);default:return}}function MP(n,e){const t=ot(n);let s=!1;for(const a of e){const l=a.query,d=t.queries.get(l);if(d){for(const f of d.wa)f.Ca(a)&&(s=!0);d.ya=a}}s&&kp(t)}function FP(n,e,t){const s=ot(n),a=s.queries.get(e);if(a)for(const l of a.wa)l.onError(t);s.queries.delete(e)}function kp(n){n.Da.forEach((e=>{e.next()}))}var Vf,kv;(kv=Vf||(Vf={})).Fa="default",kv.Cache="cache";class jp{constructor(e,t,s){this.query=e,this.Ma=t,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=s||{}}Ca(e){if(!this.options.includeMetadataChanges){const s=[];for(const a of e.docChanges)a.type!==3&&s.push(a);e=new Lo(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),t=!0):this.Ba(e,this.onlineState)&&(this.La(e),t=!0),this.Oa=e,t}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let t=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),t=!0),t}Ba(e,t){if(!e.fromCache||!this.ba())return!0;const s=t!=="Offline";return(!this.options.ka||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Na(e){if(e.docChanges.length>0)return!0;const t=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}La(e){e=Lo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==Vf.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xw{constructor(e){this.key=e}}class Ew{constructor(e){this.key=e}}class UP{constructor(e,t){this.query=e,this.Ha=t,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=yt(),this.mutatedKeys=yt(),this.Xa=B0(e),this.eu=new bo(this.Xa)}get tu(){return this.Ha}nu(e,t){const s=t?t.ru:new Nv,a=t?t.eu:this.eu;let l=t?t.mutatedKeys:this.mutatedKeys,d=a,f=!1;const m=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,v=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal(((w,S)=>{const I=a.get(w),U=cd(this.query,S)?S:null,Z=!!I&&this.mutatedKeys.has(I.key),Q=!!U&&(U.hasLocalMutations||this.mutatedKeys.has(U.key)&&U.hasCommittedMutations);let M=!1;I&&U?I.data.isEqual(U.data)?Z!==Q&&(s.track({type:3,doc:U}),M=!0):this.iu(I,U)||(s.track({type:2,doc:U}),M=!0,(m&&this.Xa(U,m)>0||v&&this.Xa(U,v)<0)&&(f=!0)):!I&&U?(s.track({type:0,doc:U}),M=!0):I&&!U&&(s.track({type:1,doc:I}),M=!0,(m||v)&&(f=!0)),M&&(U?(d=d.add(U),l=Q?l.add(w):l.delete(w)):(d=d.delete(w),l=l.delete(w)))})),this.query.limit!==null)for(;d.size>this.query.limit;){const w=this.query.limitType==="F"?d.last():d.first();d=d.delete(w.key),l=l.delete(w.key),s.track({type:1,doc:w})}return{eu:d,ru:s,Ds:f,mutatedKeys:l}}iu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,s,a){const l=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const d=e.ru.pa();d.sort(((w,S)=>(function(U,Z){const Q=M=>{switch(M){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return nt(20277,{At:M})}};return Q(U)-Q(Z)})(w.type,S.type)||this.Xa(w.doc,S.doc))),this.su(s),a=a!=null&&a;const f=t&&!a?this.ou():[],m=this.Za.size===0&&this.current&&!a?1:0,v=m!==this.Ya;return this.Ya=m,d.length!==0||v?{snapshot:new Lo(this.query,e.eu,l,d,e.mutatedKeys,m===0,v,!1,!!s&&s.resumeToken.approximateByteSize()>0),_u:f}:{_u:f}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new Nv,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach((t=>this.Ha=this.Ha.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ha=this.Ha.delete(t))),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=yt(),this.eu.forEach((s=>{this.au(s.key)&&(this.Za=this.Za.add(s.key))}));const t=[];return e.forEach((s=>{this.Za.has(s)||t.push(new Ew(s))})),this.Za.forEach((s=>{e.has(s)||t.push(new xw(s))})),t}uu(e){this.Ha=e.qs,this.Za=yt();const t=this.nu(e.documents);return this.applyChanges(t,!0)}cu(){return Lo.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const Dp="SyncEngine";class zP{constructor(e,t,s){this.query=e,this.targetId=t,this.view=s}}class BP{constructor(e){this.key=e,this.lu=!1}}class $P{constructor(e,t,s,a,l,d){this.localStore=e,this.remoteStore=t,this.eventManager=s,this.sharedClientState=a,this.currentUser=l,this.maxConcurrentLimboResolutions=d,this.hu={},this.Pu=new La((f=>z0(f)),ld),this.Tu=new Map,this.Iu=new Set,this.du=new Kt(Ye.comparator),this.Eu=new Map,this.Au=new wp,this.Ru={},this.Vu=new Map,this.mu=Do.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function WP(n,e,t=!0){const s=Pw(n);let a;const l=s.Pu.get(e);return l?(s.sharedClientState.addLocalQueryTarget(l.targetId),a=l.view.cu()):a=await Tw(s,e,t,!0),a}async function GP(n,e){const t=Pw(n);await Tw(t,e,!0,!1)}async function Tw(n,e,t,s){const a=await dP(n.localStore,Vs(e)),l=a.targetId,d=n.sharedClientState.addLocalQueryTarget(l,t);let f;return s&&(f=await HP(n,e,l,d==="current",a.resumeToken)),n.isPrimaryClient&&t&&mw(n.remoteStore,a),f}async function HP(n,e,t,s,a){n.gu=(S,I,U)=>(async function(Q,M,ne,xe){let we=M.view.nu(ne);we.Ds&&(we=await Sv(Q.localStore,M.query,!1).then((({documents:A})=>M.view.nu(A,we))));const Ee=xe&&xe.targetChanges.get(M.targetId),le=xe&&xe.targetMismatches.get(M.targetId)!=null,Re=M.view.applyChanges(we,Q.isPrimaryClient,Ee,le);return Dv(Q,M.targetId,Re._u),Re.snapshot})(n,S,I,U);const l=await Sv(n.localStore,e,!0),d=new UP(e,l.qs),f=d.nu(l.documents),m=sc.createSynthesizedTargetChangeForCurrentChange(t,s&&n.onlineState!=="Offline",a),v=d.applyChanges(f,n.isPrimaryClient,m);Dv(n,t,v._u);const w=new zP(e,t,d);return n.Pu.set(e,w),n.Tu.has(t)?n.Tu.get(t).push(e):n.Tu.set(t,[e]),v.snapshot}async function qP(n,e,t){const s=ot(n),a=s.Pu.get(e),l=s.Tu.get(a.targetId);if(l.length>1)return s.Tu.set(a.targetId,l.filter((d=>!ld(d,e)))),void s.Pu.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(a.targetId),s.sharedClientState.isActiveQueryTarget(a.targetId)||await Df(s.localStore,a.targetId,!1).then((()=>{s.sharedClientState.clearQueryState(a.targetId),t&&Sp(s.remoteStore,a.targetId),Of(s,a.targetId)})).catch($o)):(Of(s,a.targetId),await Df(s.localStore,a.targetId,!0))}async function KP(n,e){const t=ot(n),s=t.Pu.get(e),a=t.Tu.get(s.targetId);t.isPrimaryClient&&a.length===1&&(t.sharedClientState.removeLocalQueryTarget(s.targetId),Sp(t.remoteStore,s.targetId))}async function QP(n,e,t){const s=nR(n);try{const a=await(function(d,f){const m=ot(d),v=Bt.now(),w=f.reduce(((U,Z)=>U.add(Z.key)),yt());let S,I;return m.persistence.runTransaction("Locally write mutations","readwrite",(U=>{let Z=gi(),Q=yt();return m.Os.getEntries(U,w).next((M=>{Z=M,Z.forEach(((ne,xe)=>{xe.isValidDocument()||(Q=Q.add(ne))}))})).next((()=>m.localDocuments.getOverlayedDocuments(U,Z))).next((M=>{S=M;const ne=[];for(const xe of f){const we=db(xe,S.get(xe.key).overlayedDocument);we!=null&&ne.push(new oa(xe.key,we,D0(we.value.mapValue),Jr.exists(!0)))}return m.mutationQueue.addMutationBatch(U,v,ne,f)})).next((M=>{I=M;const ne=M.applyToLocalDocumentSet(S,Q);return m.documentOverlayCache.saveOverlays(U,M.batchId,ne)}))})).then((()=>({batchId:I.batchId,changes:W0(S)})))})(s.localStore,e);s.sharedClientState.addPendingMutation(a.batchId),(function(d,f,m){let v=d.Ru[d.currentUser.toKey()];v||(v=new Kt(ht)),v=v.insert(f,m),d.Ru[d.currentUser.toKey()]=v})(s,a.batchId,t),await ac(s,a.changes),await md(s.remoteStore)}catch(a){const l=Rp(a,"Failed to persist write");t.reject(l)}}async function Sw(n,e){const t=ot(n);try{const s=await lP(t.localStore,e);e.targetChanges.forEach(((a,l)=>{const d=t.Eu.get(l);d&&(Pt(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?d.lu=!0:a.modifiedDocuments.size>0?Pt(d.lu,14607):a.removedDocuments.size>0&&(Pt(d.lu,42227),d.lu=!1))})),await ac(t,s,e)}catch(s){await $o(s)}}function jv(n,e,t){const s=ot(n);if(s.isPrimaryClient&&t===0||!s.isPrimaryClient&&t===1){const a=[];s.Pu.forEach(((l,d)=>{const f=d.view.va(e);f.snapshot&&a.push(f.snapshot)})),(function(d,f){const m=ot(d);m.onlineState=f;let v=!1;m.queries.forEach(((w,S)=>{for(const I of S.wa)I.va(f)&&(v=!0)})),v&&kp(m)})(s.eventManager,e),a.length&&s.hu.J_(a),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function YP(n,e,t){const s=ot(n);s.sharedClientState.updateQueryState(e,"rejected",t);const a=s.Eu.get(e),l=a&&a.key;if(l){let d=new Kt(Ye.comparator);d=d.insert(l,ar.newNoDocument(l,at.min()));const f=yt().add(l),m=new hd(at.min(),new Map,new Kt(ht),d,f);await Sw(s,m),s.du=s.du.remove(l),s.Eu.delete(e),Lp(s)}else await Df(s.localStore,e,!1).then((()=>Of(s,e,t))).catch($o)}async function JP(n,e){const t=ot(n),s=e.batch.batchId;try{const a=await oP(t.localStore,e);Iw(t,s,null),Cw(t,s),t.sharedClientState.updateMutationState(s,"acknowledged"),await ac(t,a)}catch(a){await $o(a)}}async function XP(n,e,t){const s=ot(n);try{const a=await(function(d,f){const m=ot(d);return m.persistence.runTransaction("Reject batch","readwrite-primary",(v=>{let w;return m.mutationQueue.lookupMutationBatch(v,f).next((S=>(Pt(S!==null,37113),w=S.keys(),m.mutationQueue.removeMutationBatch(v,S)))).next((()=>m.mutationQueue.performConsistencyCheck(v))).next((()=>m.documentOverlayCache.removeOverlaysForBatchId(v,w,f))).next((()=>m.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(v,w))).next((()=>m.localDocuments.getDocuments(v,w)))}))})(s.localStore,e);Iw(s,e,t),Cw(s,e),s.sharedClientState.updateMutationState(e,"rejected",t),await ac(s,a)}catch(a){await $o(a)}}function Cw(n,e){(n.Vu.get(e)||[]).forEach((t=>{t.resolve()})),n.Vu.delete(e)}function Iw(n,e,t){const s=ot(n);let a=s.Ru[s.currentUser.toKey()];if(a){const l=a.get(e);l&&(t?l.reject(t):l.resolve(),a=a.remove(e)),s.Ru[s.currentUser.toKey()]=a}}function Of(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const s of n.Tu.get(e))n.Pu.delete(s),t&&n.hu.pu(s,t);n.Tu.delete(e),n.isPrimaryClient&&n.Au.zr(e).forEach((s=>{n.Au.containsKey(s)||bw(n,s)}))}function bw(n,e){n.Iu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(Sp(n.remoteStore,t),n.du=n.du.remove(e),n.Eu.delete(t),Lp(n))}function Dv(n,e,t){for(const s of t)s instanceof xw?(n.Au.addReference(s.key,e),ZP(n,s)):s instanceof Ew?(Oe(Dp,"Document no longer in limbo: "+s.key),n.Au.removeReference(s.key,e),n.Au.containsKey(s.key)||bw(n,s.key)):nt(19791,{yu:s})}function ZP(n,e){const t=e.key,s=t.path.canonicalString();n.du.get(t)||n.Iu.has(s)||(Oe(Dp,"New document in limbo: "+t),n.Iu.add(s),Lp(n))}function Lp(n){for(;n.Iu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Iu.values().next().value;n.Iu.delete(e);const t=new Ye(zt.fromString(e)),s=n.mu.next();n.Eu.set(s,new BP(t)),n.du=n.du.insert(t,s),mw(n.remoteStore,new Bi(Vs(od(t.path)),s,"TargetPurposeLimboResolution",rd.ue))}}async function ac(n,e,t){const s=ot(n),a=[],l=[],d=[];s.Pu.isEmpty()||(s.Pu.forEach(((f,m)=>{d.push(s.gu(m,e,t).then((v=>{var w;if((v||t)&&s.isPrimaryClient){const S=v?!v.fromCache:(w=t==null?void 0:t.targetChanges.get(m.targetId))===null||w===void 0?void 0:w.current;s.sharedClientState.updateQueryState(m.targetId,S?"current":"not-current")}if(v){a.push(v);const S=Ep.Es(m.targetId,v);l.push(S)}})))})),await Promise.all(d),s.hu.J_(a),await(async function(m,v){const w=ot(m);try{await w.persistence.runTransaction("notifyLocalViewChanges","readwrite",(S=>ce.forEach(v,(I=>ce.forEach(I.Is,(U=>w.persistence.referenceDelegate.addReference(S,I.targetId,U))).next((()=>ce.forEach(I.ds,(U=>w.persistence.referenceDelegate.removeReference(S,I.targetId,U)))))))))}catch(S){if(!Wo(S))throw S;Oe(Tp,"Failed to update sequence numbers: "+S)}for(const S of v){const I=S.targetId;if(!S.fromCache){const U=w.Fs.get(I),Z=U.snapshotVersion,Q=U.withLastLimboFreeSnapshotVersion(Z);w.Fs=w.Fs.insert(I,Q)}}})(s.localStore,l))}async function eR(n,e){const t=ot(n);if(!t.currentUser.isEqual(e)){Oe(Dp,"User change. New user:",e.toKey());const s=await dw(t.localStore,e);t.currentUser=e,(function(l,d){l.Vu.forEach((f=>{f.forEach((m=>{m.reject(new Be(de.CANCELLED,d))}))})),l.Vu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await ac(t,s.Bs)}}function tR(n,e){const t=ot(n),s=t.Eu.get(e);if(s&&s.lu)return yt().add(s.key);{let a=yt();const l=t.Tu.get(e);if(!l)return a;for(const d of l){const f=t.Pu.get(d);a=a.unionWith(f.view.tu)}return a}}function Pw(n){const e=ot(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Sw.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=tR.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=YP.bind(null,e),e.hu.J_=MP.bind(null,e.eventManager),e.hu.pu=FP.bind(null,e.eventManager),e}function nR(n){const e=ot(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=JP.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=XP.bind(null,e),e}class Hu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=fd(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,t){return null}Fu(e,t){return null}vu(e){return aP(this.persistence,new rP,e.initialUser,this.serializer)}Du(e){return new uw(xp.Vi,this.serializer)}bu(e){return new fP}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Hu.provider={build:()=>new Hu};class rR extends Hu{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,t){Pt(this.persistence.referenceDelegate instanceof Wu,46915);const s=this.persistence.referenceDelegate.garbageCollector;return new Bb(s,e.asyncQueue,t)}Du(e){const t=this.cacheSizeBytes!==void 0?Sr.withCacheSize(this.cacheSizeBytes):Sr.DEFAULT;return new uw((s=>Wu.Vi(s,t)),this.serializer)}}class Mf{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>jv(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=eR.bind(null,this.syncEngine),await LP(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new OP})()}createDatastore(e){const t=fd(e.databaseInfo.databaseId),s=(function(l){return new vP(l)})(e.databaseInfo);return(function(l,d,f,m){return new EP(l,d,f,m)})(e.authCredentials,e.appCheckCredentials,s,t)}createRemoteStore(e){return(function(s,a,l,d,f){return new SP(s,a,l,d,f)})(this.localStore,this.datastore,e.asyncQueue,(t=>jv(this.syncEngine,t,0)),(function(){return bv.C()?new bv:new pP})())}createSyncEngine(e,t){return(function(a,l,d,f,m,v,w){const S=new $P(a,l,d,f,m,v);return w&&(S.fu=!0),S})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(a){const l=ot(a);Oe(Da,"RemoteStore shutting down."),l.Ia.add(5),await ic(l),l.Ea.shutdown(),l.Aa.set("Unknown")})(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}Mf.provider={build:()=>new Mf};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vp{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):mi("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ta="FirestoreClient";class sR{constructor(e,t,s,a,l){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=s,this.databaseInfo=a,this.user=sr.UNAUTHENTICATED,this.clientId=lp.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(s,(async d=>{Oe(ta,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d})),this.appCheckCredentials.start(s,(d=>(Oe(ta,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new di;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const s=Rp(t,"Failed to shutdown persistence");e.reject(s)}})),e.promise}}async function lf(n,e){n.asyncQueue.verifyOperationInProgress(),Oe(ta,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let s=t.initialUser;n.setCredentialChangeListener((async a=>{s.isEqual(a)||(await dw(e.localStore,a),s=a)})),e.persistence.setDatabaseDeletedListener((()=>{Qi("Terminating Firestore due to IndexedDb database deletion"),n.terminate().then((()=>{Oe("Terminating Firestore due to IndexedDb database deletion completed successfully")})).catch((a=>{Qi("Terminating Firestore due to IndexedDb database deletion failed",a)}))})),n._offlineComponents=e}async function Lv(n,e){n.asyncQueue.verifyOperationInProgress();const t=await iR(n);Oe(ta,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((s=>Rv(e.remoteStore,s))),n.setAppCheckTokenChangeListener(((s,a)=>Rv(e.remoteStore,a))),n._onlineComponents=e}async function iR(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Oe(ta,"Using user provided OfflineComponentProvider");try{await lf(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(a){return a.name==="FirebaseError"?a.code===de.FAILED_PRECONDITION||a.code===de.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11})(t))throw t;Qi("Error using user provided cache. Falling back to memory cache: "+t),await lf(n,new Hu)}}else Oe(ta,"Using default OfflineComponentProvider"),await lf(n,new rR(void 0));return n._offlineComponents}async function Rw(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Oe(ta,"Using user provided OnlineComponentProvider"),await Lv(n,n._uninitializedComponentsProvider._online)):(Oe(ta,"Using default OnlineComponentProvider"),await Lv(n,new Mf))),n._onlineComponents}function aR(n){return Rw(n).then((e=>e.syncEngine))}async function qu(n){const e=await Rw(n),t=e.eventManager;return t.onListen=WP.bind(null,e.syncEngine),t.onUnlisten=qP.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=GP.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=KP.bind(null,e.syncEngine),t}function oR(n,e,t={}){const s=new di;return n.asyncQueue.enqueueAndForget((async()=>(function(l,d,f,m,v){const w=new Vp({next:I=>{w.Ou(),d.enqueueAndForget((()=>Ap(l,S)));const U=I.docs.has(f);!U&&I.fromCache?v.reject(new Be(de.UNAVAILABLE,"Failed to get document because the client is offline.")):U&&I.fromCache&&m&&m.source==="server"?v.reject(new Be(de.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):v.resolve(I)},error:I=>v.reject(I)}),S=new jp(od(f.path),w,{includeMetadataChanges:!0,ka:!0});return Np(l,S)})(await qu(n),n.asyncQueue,e,t,s))),s.promise}function lR(n,e,t={}){const s=new di;return n.asyncQueue.enqueueAndForget((async()=>(function(l,d,f,m,v){const w=new Vp({next:I=>{w.Ou(),d.enqueueAndForget((()=>Ap(l,S))),I.fromCache&&m.source==="server"?v.reject(new Be(de.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):v.resolve(I)},error:I=>v.reject(I)}),S=new jp(f,w,{includeMetadataChanges:!0,ka:!0});return Np(l,S)})(await qu(n),n.asyncQueue,e,t,s))),s.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nw(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vv=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Aw="firestore.googleapis.com",Ov=!0;class Mv{constructor(e){var t,s;if(e.host===void 0){if(e.ssl!==void 0)throw new Be(de.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Aw,this.ssl=Ov}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:Ov;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=cw;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Ub)throw new Be(de.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}TI("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Nw((s=e.experimentalLongPollingOptions)!==null&&s!==void 0?s:{}),(function(l){if(l.timeoutSeconds!==void 0){if(isNaN(l.timeoutSeconds))throw new Be(de.INVALID_ARGUMENT,`invalid long polling timeout: ${l.timeoutSeconds} (must not be NaN)`);if(l.timeoutSeconds<5)throw new Be(de.INVALID_ARGUMENT,`invalid long polling timeout: ${l.timeoutSeconds} (minimum allowed value is 5)`);if(l.timeoutSeconds>30)throw new Be(de.INVALID_ARGUMENT,`invalid long polling timeout: ${l.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(s,a){return s.timeoutSeconds===a.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class gd{constructor(e,t,s,a){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=s,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Mv({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Be(de.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Be(de.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Mv(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(s){if(!s)return new pI;switch(s.type){case"firstParty":return new vI(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new Be(de.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const s=Vv.get(t);s&&(Oe("ComponentProvider","Removing Datastore"),Vv.delete(t),s.terminate())})(this),Promise.resolve()}}function cR(n,e,t,s={}){var a;n=Ir(n,gd);const l=Mo(e),d=n._getSettings(),f=Object.assign(Object.assign({},d),{emulatorOptions:n._getEmulatorOptions()}),m=`${e}:${t}`;l&&(T_(`https://${m}`),S_("Firestore",!0)),d.host!==Aw&&d.host!==m&&Qi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const v=Object.assign(Object.assign({},d),{host:m,ssl:l,emulatorOptions:s});if(!Na(v,f)&&(n._setSettings(v),s.mockUserToken)){let w,S;if(typeof s.mockUserToken=="string")w=s.mockUserToken,S=sr.MOCK_USER;else{w=ET(s.mockUserToken,(a=n._app)===null||a===void 0?void 0:a.options.projectId);const I=s.mockUserToken.sub||s.mockUserToken.user_id;if(!I)throw new Be(de.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");S=new sr(I)}n._authCredentials=new mI(new x0(w,S))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oc{constructor(e,t,s){this.converter=t,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new oc(this.firestore,e,this._query)}}class rn{constructor(e,t,s){this.converter=t,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ki(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new rn(this.firestore,e,this._key)}toJSON(){return{type:rn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,s){if(nc(t,rn._jsonSchema))return new rn(e,s||null,new Ye(zt.fromString(t.referencePath)))}}rn._jsonSchemaVersion="firestore/documentReference/1.0",rn._jsonSchema={type:fn("string",rn._jsonSchemaVersion),referencePath:fn("string")};class Ki extends oc{constructor(e,t,s){super(e,t,od(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new rn(this.firestore,null,new Ye(e))}withConverter(e){return new Ki(this.firestore,e,this._path)}}function ir(n,e,...t){if(n=an(n),T0("collection","path",e),n instanceof gd){const s=zt.fromString(e,...t);return Xy(s),new Ki(n,null,s)}{if(!(n instanceof rn||n instanceof Ki))throw new Be(de.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(zt.fromString(e,...t));return Xy(s),new Ki(n.firestore,null,s)}}function Lt(n,e,...t){if(n=an(n),arguments.length===1&&(e=lp.newId()),T0("doc","path",e),n instanceof gd){const s=zt.fromString(e,...t);return Jy(s),new rn(n,null,new Ye(s))}{if(!(n instanceof rn||n instanceof Ki))throw new Be(de.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(zt.fromString(e,...t));return Jy(s),new rn(n.firestore,n instanceof Ki?n.converter:null,new Ye(s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fv="AsyncQueue";class Uv{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new fw(this,"async_queue_retry"),this.oc=()=>{const s=of();s&&Oe(Fv,"Visibility state changed to "+s.visibilityState),this.F_.y_()},this._c=e;const t=of();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const t=of();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise((()=>{}));const t=new di;return this.uc((()=>this.Xu&&this.rc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Zu.push(e),this.cc())))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!Wo(e))throw e;Oe(Fv,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_((()=>this.cc()))}}uc(e){const t=this._c.then((()=>(this.nc=!0,e().catch((s=>{throw this.tc=s,this.nc=!1,mi("INTERNAL UNHANDLED ERROR: ",zv(s)),s})).then((s=>(this.nc=!1,s))))));return this._c=t,t}enqueueAfterDelay(e,t,s){this.ac(),this.sc.indexOf(e)>-1&&(t=0);const a=Pp.createAndSchedule(this,e,t,s,(l=>this.lc(l)));return this.ec.push(a),a}ac(){this.tc&&nt(47125,{hc:zv(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(const t of this.ec)if(t.timerId===e)return!0;return!1}Ic(e){return this.Pc().then((()=>{this.ec.sort(((t,s)=>t.targetTimeMs-s.targetTimeMs));for(const t of this.ec)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Pc()}))}dc(e){this.sc.push(e)}lc(e){const t=this.ec.indexOf(e);this.ec.splice(t,1)}}function zv(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bv(n){return(function(t,s){if(typeof t!="object"||t===null)return!1;const a=t;for(const l of s)if(l in a&&typeof a[l]=="function")return!0;return!1})(n,["next","error","complete"])}class yi extends gd{constructor(e,t,s,a){super(e,t,s,a),this.type="firestore",this._queue=new Uv,this._persistenceKey=(a==null?void 0:a.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Uv(e),this._firestoreClient=void 0,await e}}}function uR(n,e){const t=typeof n=="object"?n:P_(),s=typeof n=="string"?n:Mu,a=Qf(t,"firestore").getImmediate({identifier:s});if(!a._initialized){const l=wT("firestore");l&&cR(a,...l)}return a}function yd(n){if(n._terminated)throw new Be(de.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||dR(n),n._firestoreClient}function dR(n){var e,t,s;const a=n._freezeSettings(),l=(function(f,m,v,w){return new DI(f,m,v,w.host,w.ssl,w.experimentalForceLongPolling,w.experimentalAutoDetectLongPolling,Nw(w.experimentalLongPollingOptions),w.useFetchStreams,w.isUsingEmulator)})(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,a);n._componentsProvider||!((t=a.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((s=a.localCache)===null||s===void 0)&&s._onlineComponentProvider)&&(n._componentsProvider={_offline:a.localCache._offlineComponentProvider,_online:a.localCache._onlineComponentProvider}),n._firestoreClient=new sR(n._authCredentials,n._appCheckCredentials,n._queue,l,n._componentsProvider&&(function(f){const m=f==null?void 0:f._online.build();return{_offline:f==null?void 0:f._offline.build(m),_online:m}})(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Qr(Hn.fromBase64String(e))}catch(t){throw new Be(de.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Qr(Hn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Qr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(nc(e,Qr._jsonSchema))return Qr.fromBase64String(e.bytes)}}Qr._jsonSchemaVersion="firestore/bytes/1.0",Qr._jsonSchema={type:fn("string",Qr._jsonSchemaVersion),bytes:fn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vd{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Be(de.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Gn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _d{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ms{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Be(de.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Be(de.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return ht(this._lat,e._lat)||ht(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ms._jsonSchemaVersion}}static fromJSON(e){if(nc(e,Ms._jsonSchema))return new Ms(e.latitude,e.longitude)}}Ms._jsonSchemaVersion="firestore/geoPoint/1.0",Ms._jsonSchema={type:fn("string",Ms._jsonSchemaVersion),latitude:fn("number"),longitude:fn("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fs{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(s,a){if(s.length!==a.length)return!1;for(let l=0;l<s.length;++l)if(s[l]!==a[l])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Fs._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(nc(e,Fs._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Fs(e.vectorValues);throw new Be(de.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Fs._jsonSchemaVersion="firestore/vectorValue/1.0",Fs._jsonSchema={type:fn("string",Fs._jsonSchemaVersion),vectorValues:fn("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hR=/^__.*__$/;class fR{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return this.fieldMask!==null?new oa(e,this.data,this.fieldMask,t,this.fieldTransforms):new rc(e,this.data,t,this.fieldTransforms)}}class kw{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return new oa(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function jw(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw nt(40011,{Ec:n})}}class Op{constructor(e,t,s,a,l,d){this.settings=e,this.databaseId=t,this.serializer=s,this.ignoreUndefinedProperties=a,l===void 0&&this.Ac(),this.fieldTransforms=l||[],this.fieldMask=d||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new Op(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var t;const s=(t=this.path)===null||t===void 0?void 0:t.child(e),a=this.Rc({path:s,mc:!1});return a.fc(e),a}gc(e){var t;const s=(t=this.path)===null||t===void 0?void 0:t.child(e),a=this.Rc({path:s,mc:!1});return a.Ac(),a}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return Ku(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(jw(this.Ec)&&hR.test(e))throw this.wc('Document fields cannot begin and end with "__"')}}class pR{constructor(e,t,s){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=s||fd(e)}Dc(e,t,s,a=!1){return new Op({Ec:e,methodName:t,bc:s,path:Gn.emptyPath(),mc:!1,Sc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Mp(n){const e=n._freezeSettings(),t=fd(n._databaseId);return new pR(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Dw(n,e,t,s,a,l={}){const d=n.Dc(l.merge||l.mergeFields?2:0,e,t,a);Up("Data must be an object, but it was:",d,s);const f=Lw(s,d);let m,v;if(l.merge)m=new Mr(d.fieldMask),v=d.fieldTransforms;else if(l.mergeFields){const w=[];for(const S of l.mergeFields){const I=Ff(e,S,t);if(!d.contains(I))throw new Be(de.INVALID_ARGUMENT,`Field '${I}' is specified in your field mask but missing from your input data.`);Ow(w,I)||w.push(I)}m=new Mr(w),v=d.fieldTransforms.filter((S=>m.covers(S.field)))}else m=null,v=d.fieldTransforms;return new fR(new Cr(f),m,v)}class lc extends _d{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof lc}}class Fp extends _d{_toFieldTransform(e){return new ob(e.path,new ql)}isEqual(e){return e instanceof Fp}}function mR(n,e,t,s){const a=n.Dc(1,e,t);Up("Data must be an object, but it was:",a,s);const l=[],d=Cr.empty();aa(s,((m,v)=>{const w=zp(e,m,t);v=an(v);const S=a.gc(w);if(v instanceof lc)l.push(w);else{const I=wd(v,S);I!=null&&(l.push(w),d.set(w,I))}}));const f=new Mr(l);return new kw(d,f,a.fieldTransforms)}function gR(n,e,t,s,a,l){const d=n.Dc(1,e,t),f=[Ff(e,s,t)],m=[a];if(l.length%2!=0)throw new Be(de.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let I=0;I<l.length;I+=2)f.push(Ff(e,l[I])),m.push(l[I+1]);const v=[],w=Cr.empty();for(let I=f.length-1;I>=0;--I)if(!Ow(v,f[I])){const U=f[I];let Z=m[I];Z=an(Z);const Q=d.gc(U);if(Z instanceof lc)v.push(U);else{const M=wd(Z,Q);M!=null&&(v.push(U),w.set(U,M))}}const S=new Mr(v);return new kw(w,S,d.fieldTransforms)}function wd(n,e){if(Vw(n=an(n)))return Up("Unsupported field value:",e,n),Lw(n,e);if(n instanceof _d)return(function(s,a){if(!jw(a.Ec))throw a.wc(`${s._methodName}() can only be used with update() and set()`);if(!a.path)throw a.wc(`${s._methodName}() is not currently supported inside arrays`);const l=s._toFieldTransform(a);l&&a.fieldTransforms.push(l)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return(function(s,a){const l=[];let d=0;for(const f of s){let m=wd(f,a.yc(d));m==null&&(m={nullValue:"NULL_VALUE"}),l.push(m),d++}return{arrayValue:{values:l}}})(n,e)}return(function(s,a){if((s=an(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return sb(a.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const l=Bt.fromDate(s);return{timestampValue:$u(a.serializer,l)}}if(s instanceof Bt){const l=new Bt(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:$u(a.serializer,l)}}if(s instanceof Ms)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof Qr)return{bytesValue:nw(a.serializer,s._byteString)};if(s instanceof rn){const l=a.databaseId,d=s.firestore._databaseId;if(!d.isEqual(l))throw a.wc(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:_p(s.firestore._databaseId||a.databaseId,s._key.path)}}if(s instanceof Fs)return(function(d,f){return{mapValue:{fields:{[k0]:{stringValue:j0},[Fu]:{arrayValue:{values:d.toArray().map((v=>{if(typeof v!="number")throw f.wc("VectorValues must only contain numeric values.");return mp(f.serializer,v)}))}}}}}})(s,a);throw a.wc(`Unsupported field value: ${cp(s)}`)})(n,e)}function Lw(n,e){const t={};return I0(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):aa(n,((s,a)=>{const l=wd(a,e.Vc(s));l!=null&&(t[s]=l)})),{mapValue:{fields:t}}}function Vw(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Bt||n instanceof Ms||n instanceof Qr||n instanceof rn||n instanceof _d||n instanceof Fs)}function Up(n,e,t){if(!Vw(t)||!S0(t)){const s=cp(t);throw s==="an object"?e.wc(n+" a custom object"):e.wc(n+" "+s)}}function Ff(n,e,t){if((e=an(e))instanceof vd)return e._internalPath;if(typeof e=="string")return zp(n,e);throw Ku("Field path arguments must be of type string or ",n,!1,void 0,t)}const yR=new RegExp("[~\\*/\\[\\]]");function zp(n,e,t){if(e.search(yR)>=0)throw Ku(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new vd(...e.split("."))._internalPath}catch{throw Ku(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Ku(n,e,t,s,a){const l=s&&!s.isEmpty(),d=a!==void 0;let f=`Function ${e}() called with invalid data`;t&&(f+=" (via `toFirestore()`)"),f+=". ";let m="";return(l||d)&&(m+=" (found",l&&(m+=` in field ${s}`),d&&(m+=` in document ${a}`),m+=")"),new Be(de.INVALID_ARGUMENT,f+n+m)}function Ow(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mw{constructor(e,t,s,a,l){this._firestore=e,this._userDataWriter=t,this._key=s,this._document=a,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new rn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new vR(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Fw("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class vR extends Mw{data(){return super.data()}}function Fw(n,e){return typeof e=="string"?zp(n,e):e instanceof vd?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uw(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Be(de.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class _R{convertValue(e,t="none"){switch(Zi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return nn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Xi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw nt(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const s={};return aa(e,((a,l)=>{s[a]=this.convertValue(l,t)})),s}convertVectorValue(e){var t,s,a;const l=(a=(s=(t=e.fields)===null||t===void 0?void 0:t[Fu].arrayValue)===null||s===void 0?void 0:s.values)===null||a===void 0?void 0:a.map((d=>nn(d.doubleValue)));return new Fs(l)}convertGeoPoint(e){return new Ms(nn(e.latitude),nn(e.longitude))}convertArray(e,t){return(e.values||[]).map((s=>this.convertValue(s,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const s=id(e);return s==null?null:this.convertValue(s,t);case"estimate":return this.convertTimestamp(Wl(e));default:return null}}convertTimestamp(e){const t=Ji(e);return new Bt(t.seconds,t.nanos)}convertDocumentKey(e,t){const s=zt.fromString(e);Pt(lw(s),9688,{name:e});const a=new Gl(s.get(1),s.get(3)),l=new Ye(s.popFirst(5));return a.isEqual(t)||mi(`Document ${l} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zw(n,e,t){let s;return s=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,s}class Nl{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Pa extends Mw{constructor(e,t,s,a,l,d){super(e,t,s,a,d),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new bu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const s=this._document.data.field(Fw("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Be(de.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Pa._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Pa._jsonSchemaVersion="firestore/documentSnapshot/1.0",Pa._jsonSchema={type:fn("string",Pa._jsonSchemaVersion),bundleSource:fn("string","DocumentSnapshot"),bundleName:fn("string"),bundle:fn("string")};class bu extends Pa{data(e={}){return super.data(e)}}class Ra{constructor(e,t,s,a){this._firestore=e,this._userDataWriter=t,this._snapshot=a,this.metadata=new Nl(a.hasPendingWrites,a.fromCache),this.query=s}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((s=>{e.call(t,new bu(this._firestore,this._userDataWriter,s.key,s,new Nl(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Be(de.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(a,l){if(a._snapshot.oldDocs.isEmpty()){let d=0;return a._snapshot.docChanges.map((f=>{const m=new bu(a._firestore,a._userDataWriter,f.doc.key,f.doc,new Nl(a._snapshot.mutatedKeys.has(f.doc.key),a._snapshot.fromCache),a.query.converter);return f.doc,{type:"added",doc:m,oldIndex:-1,newIndex:d++}}))}{let d=a._snapshot.oldDocs;return a._snapshot.docChanges.filter((f=>l||f.type!==3)).map((f=>{const m=new bu(a._firestore,a._userDataWriter,f.doc.key,f.doc,new Nl(a._snapshot.mutatedKeys.has(f.doc.key),a._snapshot.fromCache),a.query.converter);let v=-1,w=-1;return f.type!==0&&(v=d.indexOf(f.doc.key),d=d.delete(f.doc.key)),f.type!==1&&(d=d.add(f.doc),w=d.indexOf(f.doc.key)),{type:wR(f.type),doc:m,oldIndex:v,newIndex:w}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Be(de.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Ra._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=lp.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],s=[],a=[];return this.docs.forEach((l=>{l._document!==null&&(t.push(l._document),s.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),a.push(l.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function wR(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return nt(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xd(n){n=Ir(n,rn);const e=Ir(n.firestore,yi);return oR(yd(e),n._key).then((t=>Bw(e,n,t)))}Ra._jsonSchemaVersion="firestore/querySnapshot/1.0",Ra._jsonSchema={type:fn("string",Ra._jsonSchemaVersion),bundleSource:fn("string","QuerySnapshot"),bundleName:fn("string"),bundle:fn("string")};class Bp extends _R{constructor(e){super(),this.firestore=e}convertBytes(e){return new Qr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new rn(this.firestore,null,t)}}function ai(n){n=Ir(n,oc);const e=Ir(n.firestore,yi),t=yd(e),s=new Bp(e);return Uw(n._query),lR(t,n._query).then((a=>new Ra(e,s,n,a)))}function ci(n,e,t){n=Ir(n,rn);const s=Ir(n.firestore,yi),a=zw(n.converter,e,t);return Ed(s,[Dw(Mp(s),"setDoc",n._key,a,n.converter!==null,t).toMutation(n._key,Jr.none())])}function Ds(n,e,t,...s){n=Ir(n,rn);const a=Ir(n.firestore,yi),l=Mp(a);let d;return d=typeof(e=an(e))=="string"||e instanceof vd?gR(l,"updateDoc",n._key,e,t,s):mR(l,"updateDoc",n._key,e),Ed(a,[d.toMutation(n._key,Jr.exists(!0))])}function Eo(n){return Ed(Ir(n.firestore,yi),[new gp(n._key,Jr.none())])}function To(n,e){const t=Ir(n.firestore,yi),s=Lt(n),a=zw(n.converter,e);return Ed(t,[Dw(Mp(n.firestore),"addDoc",s._key,a,n.converter!==null,{}).toMutation(s._key,Jr.exists(!1))]).then((()=>s))}function $v(n,...e){var t,s,a;n=an(n);let l={includeMetadataChanges:!1,source:"default"},d=0;typeof e[d]!="object"||Bv(e[d])||(l=e[d++]);const f={includeMetadataChanges:l.includeMetadataChanges,source:l.source};if(Bv(e[d])){const S=e[d];e[d]=(t=S.next)===null||t===void 0?void 0:t.bind(S),e[d+1]=(s=S.error)===null||s===void 0?void 0:s.bind(S),e[d+2]=(a=S.complete)===null||a===void 0?void 0:a.bind(S)}let m,v,w;if(n instanceof rn)v=Ir(n.firestore,yi),w=od(n._key.path),m={next:S=>{e[d]&&e[d](Bw(v,n,S))},error:e[d+1],complete:e[d+2]};else{const S=Ir(n,oc);v=Ir(S.firestore,yi),w=S._query;const I=new Bp(v);m={next:U=>{e[d]&&e[d](new Ra(v,I,S,U))},error:e[d+1],complete:e[d+2]},Uw(n._query)}return(function(I,U,Z,Q){const M=new Vp(Q),ne=new jp(U,M,Z);return I.asyncQueue.enqueueAndForget((async()=>Np(await qu(I),ne))),()=>{M.Ou(),I.asyncQueue.enqueueAndForget((async()=>Ap(await qu(I),ne)))}})(yd(v),w,f,m)}function Ed(n,e){return(function(s,a){const l=new di;return s.asyncQueue.enqueueAndForget((async()=>QP(await aR(s),a,l))),l.promise})(yd(n),e)}function Bw(n,e,t){const s=t.docs.get(e._key),a=new Bp(n);return new Pa(n,a,e._key,s,new Nl(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xR(){return new lc("deleteField")}function Qu(){return new Fp("serverTimestamp")}(function(e,t=!0){(function(a){Bo=a})(Fo),Ro(new Aa("firestore",((s,{instanceIdentifier:a,options:l})=>{const d=s.getProvider("app").getImmediate(),f=new yi(new gI(s.getProvider("auth-internal")),new _I(d,s.getProvider("app-check-internal")),(function(v,w){if(!Object.prototype.hasOwnProperty.apply(v.options,["projectId"]))throw new Be(de.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Gl(v.options.projectId,w)})(d,a),d);return l=Object.assign({useFetchStreams:t},l),f._setSettings(l),f}),"PUBLIC").setMultipleInstances(!0)),Hi(Hy,qy,e),Hi(Hy,qy,"esm2017")})();const ER={apiKey:"AIzaSyCOOnlmEcAcJywsS93LLfLSywy9ENqnppM",authDomain:"tyler-manga-library.firebaseapp.com",projectId:"tyler-manga-library",storageBucket:"tyler-manga-library.firebasestorage.app",messagingSenderId:"307412068362",appId:"1:307412068362:web:6cfe5666187439dfa757f3"},$w=b_(ER),Yr=hI($w),lt=uR($w),Ww=k.createContext(null);function TR({children:n}){const e="https://discord.com/api/webhooks/1451655828078723156/EA8QhLeiTT-7jOVQ6jFpV2he2zxVpAddAhlu8CiC6RtGFu9wTAOLdRjKeYHIV1OhVbmm",[t,s]=k.useState(null),[a,l]=k.useState(!1),[d,f]=k.useState("viewer"),[m,v]=k.useState(!0),w=async U=>{if(!U)return null;const Z=Lt(lt,"users",U.uid);let Q=null;try{const ne=await xd(Z);ne.exists()&&(Q=ne.data())}catch(ne){console.warn("Failed to read user doc",ne)}const M={role:((Q==null?void 0:Q.role)||"viewer").toLowerCase()==="admin"?"admin":"viewer",email:U.email||(Q==null?void 0:Q.email)||"",displayName:U.displayName||(Q==null?void 0:Q.displayName)||"",createdAt:(Q==null?void 0:Q.createdAt)||Qu()};try{if(await ci(Z,M,{merge:!0}),!Q&&e)try{const ne=U.displayName||U.email||U.uid;await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:`New signup: ${ne}`})})}catch(ne){console.warn("Failed to send signup webhook",ne)}}catch(ne){console.error("Failed to ensure user doc",ne)}return{...Q,...M}};k.useEffect(()=>{const U=nC(Yr,async Z=>{if(s(Z),Z)try{const Q=await w(Z),M=(Q==null?void 0:Q.role)||"viewer";f(M),l(M.toLowerCase()==="admin")}catch(Q){console.error("Error checking role:",Q),l(!1),f("viewer")}else l(!1),f("viewer");v(!1)});return()=>U()},[]);const S=async(U,Z)=>{await t0(Yr,U,Z)},I=async()=>{await n0(Yr)};return c.jsx(Ww.Provider,{value:{user:t,admin:a,role:d,loading:m,login:S,logout:I},children:n})}function Ho(){return k.useContext(Ww)}function SR({onClose:n}){const[e,t]=k.useState("login"),[s,a]=k.useState(""),[l,d]=k.useState("");async function f(){try{await h0(Yr,new ys),n()}catch(w){alert(w.message)}}async function m(w){w.preventDefault();try{await t0(Yr,s,l),n()}catch(S){alert(S.message)}}async function v(w){w.preventDefault();try{await J1(Yr,s,l),n()}catch(S){alert(S.message)}}return c.jsx("div",{className:"auth-modal-backdrop",onClick:n,children:c.jsxs("div",{className:"auth-modal",onClick:w=>w.stopPropagation(),children:[c.jsx("h2",{className:"auth-title",children:e==="login"?"Sign In":"Create Account"}),c.jsxs("button",{className:"google-btn",onClick:f,children:[c.jsx("img",{src:"https://www.svgrepo.com/show/475656/google-color.svg",alt:"",className:"google-icon"}),"Continue with Google"]}),c.jsx("div",{className:"auth-divider",children:c.jsx("span",{children:"or"})}),c.jsxs("form",{onSubmit:e==="login"?m:v,className:"auth-form",children:[c.jsx("input",{type:"email",placeholder:"Email address",className:"auth-input",value:s,onChange:w=>a(w.target.value),required:!0}),c.jsx("input",{type:"password",placeholder:"Password",className:"auth-input",value:l,onChange:w=>d(w.target.value),required:!0}),c.jsx("button",{className:"auth-submit",children:e==="login"?"Sign In":"Create Account"})]}),c.jsx("div",{className:"auth-switcher",children:e==="login"?c.jsxs("p",{children:["No account?"," ",c.jsx("button",{onClick:()=>t("register"),children:"Register"})]}):c.jsxs("p",{children:["Already have an account?"," ",c.jsx("button",{onClick:()=>t("login"),children:"Sign in"})]})}),c.jsx("button",{className:"auth-close",onClick:n,"aria-label":"Close",children:"X"})]})})}function CR(){var me,De,be,K,N,W;const n="google.com",e="oidc.discord",[t,s]=k.useState(!1),[a,l]=k.useState(!1),[d,f]=k.useState(!1),[m,v]=k.useState(!1),[w,S]=k.useState(""),[I,U]=k.useState(""),[Z,Q]=k.useState(""),[M,ne]=k.useState({google:!1,discord:!1}),[xe,we]=k.useState(!1),[Ee,le]=k.useState(!1),Re=k.useRef(null),{user:A,admin:P,role:R}=Ho(),O=Ju();k.useEffect(()=>{var ee;f(!1),v(!1),U(""),Q(""),le(!1),S((A==null?void 0:A.displayName)||((ee=A==null?void 0:A.email)==null?void 0:ee.split("@")[0])||"")},[A]);async function B(){try{await n0(Yr),s(!1),f(!1),O("/")}catch(ee){console.error(ee),alert("Logout failed.")}}const D=()=>{if(!A){s(!1),l(!0);return}f(!1),U(""),Q(""),le(!1),v(!0)},b=async()=>{if(!A){s(!1),l(!0);return}const ee=(w||"").trim();if(!ee){U("Display name is required.");return}we(!0),U(""),le(!1);try{await Z1(Yr.currentUser,{displayName:ee}),await ci(Lt(lt,"users",A.uid),{displayName:ee},{merge:!0}),U("Profile updated."),le(!1)}catch(Te){console.error("Failed to update profile",Te),U("Failed to update profile.")}finally{we(!1)}},he=ee=>{var Te;return!!((Te=A==null?void 0:A.providerData)!=null&&Te.some(_e=>_e.providerId===ee))},$e=async()=>{if(!A){s(!1),l(!0);return}if(he(n)){Q("Google is already connected.");return}ne(ee=>({...ee,google:!0})),Q("");try{const ee=new ys,Te=await Oy(Yr.currentUser,ee);await ci(Lt(lt,"users",A.uid),{connections:{[n]:{email:Te.user.email||"",connectedAt:Qu()}}},{merge:!0}),Q("Google connected.")}catch(ee){console.error("Failed to link Google",ee);const Te=(ee==null?void 0:ee.code)==="auth/credential-already-in-use"?"That Google account is already linked elsewhere. Sign in with it instead.":"Could not connect Google.";Q(Te)}finally{ne(ee=>({...ee,google:!1}))}},Ae=async()=>{if(!A){s(!1),l(!0);return}if(he(e)){Q("Discord is already connected.");return}ne(ee=>({...ee,discord:!0})),Q("");try{const ee=new jl(e);ee.addScope("identify"),ee.addScope("email");const _e=(await Oy(Yr.currentUser,ee)).user.providerData.find(Le=>Le.providerId===e);await ci(Lt(lt,"users",A.uid),{connections:{[e]:{username:(_e==null?void 0:_e.displayName)||(_e==null?void 0:_e.uid)||"Discord",email:(_e==null?void 0:_e.email)||"",connectedAt:Qu()}}},{merge:!0}),Q("Discord connected.")}catch(ee){console.error("Failed to link Discord",ee);const Te=(ee==null?void 0:ee.code)==="auth/credential-already-in-use"?"That Discord account is already linked elsewhere. Sign in with it instead.":"Could not connect Discord.";Q(Te)}finally{ne(ee=>({...ee,discord:!1}))}},He=async ee=>{if(!A)return;if(A.providerData.length<=1){Q("You need at least one sign-in method.");return}const Te=ee===n?"google":"discord";Q(""),ne(_e=>({..._e,[Te]:!0}));try{await H1(Yr.currentUser,ee),await ci(Lt(lt,"users",A.uid),{connections:{[ee]:xR()}},{merge:!0}),Q("Connection removed.")}catch(_e){console.error("Failed to unlink",_e),Q("Could not remove connection.")}finally{ne(_e=>({..._e,[Te]:!1}))}};return c.jsxs(c.Fragment,{children:[c.jsxs("button",{className:`menu-toggle ${t?"active":""}`,onClick:()=>s(!t),children:[c.jsx("span",{}),c.jsx("span",{}),c.jsx("span",{})]}),c.jsxs("nav",{className:`menu-panel ${t?"open":""}`,onMouseLeave:()=>f(!1),children:[c.jsx(Ta,{to:"/",className:"menu-item",onClick:()=>s(!1),children:"Home"}),c.jsx(Ta,{to:"/manga",className:"menu-item",onClick:()=>s(!1),children:"Manga"}),c.jsx(Ta,{to:"/anime",className:"menu-item",onClick:()=>s(!1),children:"Anime"}),c.jsx(Ta,{to:"/tcg",className:"menu-item",onClick:()=>s(!1),children:"TCG"}),c.jsx(Ta,{to:"/music",className:"menu-item",onClick:()=>s(!1),children:"Music"}),c.jsx(Ta,{to:"/steam",className:"menu-item",onClick:()=>s(!1),children:"Gaming"}),P&&c.jsx(Ta,{to:"/dashboard",className:"menu-item",onClick:()=>s(!1),children:"Dashboard"}),c.jsxs("div",{className:"menu-footer",children:[c.jsx("div",{className:"profile-divider"}),c.jsxs("div",{className:"profile-card",onMouseEnter:()=>A&&f(!0),onMouseLeave:()=>f(!1),onClick:()=>{A?f(ee=>!ee):(f(!1),s(!1),l(!0))},role:"button",tabIndex:0,onKeyDown:ee=>{(ee.key==="Enter"||ee.key===" ")&&(ee.preventDefault(),A?f(Te=>!Te):(s(!1),l(!0)))},children:[c.jsx("div",{className:"profile-avatar",children:A?(((me=A.displayName)==null?void 0:me[0])||((De=A.email)==null?void 0:De[0])||((be=A.uid)==null?void 0:be[0])||"?").toUpperCase():"?"}),c.jsxs("div",{className:"profile-meta",children:[c.jsx("div",{className:"profile-name",children:(A==null?void 0:A.displayName)||(A==null?void 0:A.email)||"Guest"}),c.jsx("div",{className:"profile-role",children:A?P?"admin":R||"viewer":"Not signed in"})]}),A&&d&&c.jsxs("div",{className:"profile-menu",children:[c.jsx("button",{type:"button",className:"profile-menu-item",onClick:D,children:"Edit profile"}),c.jsx("button",{type:"button",className:"profile-menu-item",onClick:B,children:"Sign out"})]})]})]})]}),a&&c.jsx(SR,{onClose:()=>l(!1)}),m&&c.jsx("div",{className:"profile-edit-backdrop",children:c.jsxs("div",{className:"profile-edit-card",children:[c.jsxs("div",{className:"profile-edit-header",children:[c.jsx("h3",{children:"Edit profile"}),c.jsx("button",{type:"button",className:"profile-edit-close",onClick:()=>{v(!1),U(""),Q(""),le(!1)},children:""})]}),c.jsxs("div",{className:"profile-edit-body",children:[c.jsx("div",{className:"profile-edit-avatar",children:A?(((K=A.displayName)==null?void 0:K[0])||((N=A.email)==null?void 0:N[0])||((W=A.uid)==null?void 0:W[0])||"?").toUpperCase():"?"}),c.jsxs("div",{className:"profile-edit-field",children:[c.jsx("label",{className:"profile-edit-label",htmlFor:"displayName",children:"Display name"}),c.jsxs("div",{className:"profile-edit-input-row",children:[c.jsx("input",{id:"displayName",className:"profile-edit-input",type:"text",readOnly:!Ee,value:w,onChange:ee=>S(ee.target.value),maxLength:40,placeholder:"Enter display name",ref:Re,onBlur:()=>{Ee&&b()},onKeyDown:ee=>{ee.key==="Enter"&&Ee&&(ee.preventDefault(),b())}}),c.jsx("button",{type:"button",className:"profile-edit-pencil",onClick:()=>{le(!0),U(""),setTimeout(()=>{var ee;return(ee=Re.current)==null?void 0:ee.focus()},50)},"aria-label":"Edit display name",children:""})]}),c.jsx("div",{className:"profile-edit-hint",children:"Click the pencil to edit. Changes save on blur or Enter."})]})]}),c.jsxs("div",{className:"profile-connections",children:[c.jsxs("div",{className:"profile-connections-header",children:[c.jsx("span",{children:"Connections"}),Z&&c.jsx("span",{className:"profile-connection-status",children:Z})]}),c.jsxs("div",{className:"profile-connection-row",children:[c.jsxs("div",{className:"profile-connection-meta",children:[c.jsx("div",{className:"profile-connection-title",children:"Google"}),c.jsx("div",{className:"profile-connection-sub",children:he(n)?"Connected":"Not connected"})]}),c.jsx("div",{className:"profile-connection-actions",children:he(n)?c.jsx("button",{type:"button",className:"profile-connection-btn secondary",onClick:()=>He(n),disabled:M.google,children:M.google?"Removing...":"Remove"}):c.jsx("button",{type:"button",className:"profile-connection-btn",onClick:$e,disabled:M.google,children:M.google?"Connecting...":"Connect"})})]}),c.jsxs("div",{className:"profile-connection-row",children:[c.jsxs("div",{className:"profile-connection-meta",children:[c.jsx("div",{className:"profile-connection-title",children:"Discord"}),c.jsx("div",{className:"profile-connection-sub",children:he(e)?"Connected":"Not connected"})]}),c.jsx("div",{className:"profile-connection-actions",children:he(e)?c.jsx("button",{type:"button",className:"profile-connection-btn secondary",onClick:()=>He(e),disabled:M.discord,children:M.discord?"Removing...":"Remove"}):c.jsx("button",{type:"button",className:"profile-connection-btn",onClick:Ae,disabled:M.discord,children:M.discord?"Connecting...":"Connect"})})]})]}),I&&c.jsx("div",{className:"profile-edit-status",children:I}),xe&&c.jsx("div",{className:"profile-edit-status saving",children:"Saving..."})]})})]})}function Wv(){const n="Tyler's Collection's and Hobbies",e="",[t,s]=k.useState(""),[a,l]=k.useState(!0),d=k.useRef(null),[f,m]=k.useState("jp"),[v,w]=k.useState(1);return k.useEffect(()=>{document.title="Tyler's Collection"},[]),k.useEffect(()=>(d.current=setInterval(()=>l(S=>!S),450),()=>{d.current&&clearInterval(d.current)}),[]),k.useEffect(()=>{let S=!1;const I=Q=>new Promise(M=>setTimeout(M,Q)),U=async(Q,M=120)=>{for(let ne=1;ne<=Q.length;ne+=1){if(S)return;s(Q.slice(0,ne)),await I(M)}},Z=async(Q,M=70)=>{for(let ne=Q.length;ne>=0;ne-=1){if(S)return;s(Q.slice(0,ne)),await I(M)}};return(async()=>{if(localStorage.getItem("homeTitleTyped")==="1"){m("en"),s(n),l(!1),d.current&&clearInterval(d.current);return}await I(250),m("jp"),await U(e,140),await I(6e3),await Z(e,80),await I(320);const M=n;for(let ne=1;ne<=M.length;ne+=1){if(S)return;s(M.slice(0,ne)),ne===4&&m("en"),await I(110)}m("en"),await I(2e3),l(!1),localStorage.setItem("homeTitleTyped","1"),d.current&&clearInterval(d.current)})(),()=>{S=!0}},[]),c.jsxs("main",{className:"page",children:[c.jsxs("header",{style:{textAlign:"center",marginTop:"32px",marginBottom:"24px"},children:[c.jsxs("h1",{style:{margin:0,fontSize:"2.2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",display:"inline-flex",alignItems:"center",gap:"6px"},children:[c.jsx("span",{children:t||" "}),c.jsx("span",{style:{width:"6px",height:"1.1em",background:"#ffb6c1",opacity:a?1:0,transition:"opacity 0.15s ease"}})]}),c.jsx("p",{style:{margin:"6px 0 0",color:"var(--text-soft)",fontSize:"0.95rem",opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"TCG":"This is my personal webpage to see what is on my shelves, wishlists, and TCG collections."}),c.jsx("div",{style:{display:"inline-flex",alignItems:"center",gap:"10px",padding:"8px 14px",borderRadius:"999px",border:"1px solid rgba(255,182,193,0.5)",background:"linear-gradient(135deg, rgba(255,182,193,0.18), rgba(43,15,29,0.9))",boxShadow:"0 8px 24px rgba(0,0,0,0.55)",marginTop:"14px",fontSize:"0.78rem",color:"#ffe6ed",letterSpacing:"0.05em",textTransform:"uppercase",fontWeight:700,opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?c.jsx("span",{style:{letterSpacing:"0.06em"},children:"          TCG"}):c.jsx("span",{style:{letterSpacing:"0.06em"},children:" Manga   Anime   Music   TCG"})})]}),c.jsxs("section",{style:{display:"grid",gridTemplateColumns:"minmax(0, 2fr) minmax(0, 3fr)",gap:"20px",marginTop:"24px"},children:[c.jsxs("article",{className:"card",children:[c.jsx("h2",{style:{marginTop:0,marginBottom:"8px",fontSize:"1.2rem",color:"#ffb6c1"},children:c.jsx("span",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"About Me"})}),c.jsx("p",{style:{margin:0,color:"var(--text-soft)",fontSize:"0.9rem",lineHeight:1.5,opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"im.okTCG":"Hey, I am Tyler and I go by im.ok. I hoard manga, binge anime, and collect trading cards."}),c.jsx("p",{style:{marginTop:"10px",color:"var(--text-soft)",fontSize:"0.9rem",opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"TCG":"This site is where I track everything: volumes on my shelves, finished shows, and my TCG collection as they all slowly grow."}),c.jsxs("div",{style:{marginTop:"12px",display:"flex",flexWrap:"wrap",gap:"6px",opacity:v,transition:"opacity 0.25s ease"},children:[c.jsx("span",{className:"pill",children:f==="jp"?"":"Manga library"}),c.jsx("span",{className:"pill",children:f==="jp"?"":"My Anime List (MAL)"}),c.jsx("span",{className:"pill",children:f==="jp"?" & TCG":"Pokemon & One Piece TCG"}),c.jsx("span",{className:"pill",children:f==="jp"?"":"Data Nerd"})]})]}),c.jsxs("article",{className:"card",children:[c.jsx("h2",{style:{marginTop:0,marginBottom:"8px",fontSize:"1.2rem",color:"#ffb6c1"},children:c.jsx("span",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Explore these pages"})}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(210px, 1fr))",gap:"14px",marginTop:"10px"},children:[c.jsxs("a",{href:"/base/manga",className:"section-card",children:[c.jsx("h3",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Manga Library"}),c.jsx("p",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Full manga collection & wishlist."}),c.jsx("div",{className:"section-chip-row",children:c.jsx("span",{className:"section-chip accent",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Library & wishlist"})})]}),c.jsxs("a",{href:"/base/music",className:"section-card",style:{justifySelf:"end",alignSelf:"end",order:99},children:[c.jsx("h3",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Music"}),c.jsx("p",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"If you are here for my music, this is the page for you! Catch all the latest releases."}),c.jsxs("div",{className:"section-chip-row",children:[c.jsx("span",{className:"section-chip accent",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Latest tracks"}),c.jsx("span",{className:"section-chip",style:{opacity:v,transition:"opacity 0.25s ease"},children:"Spotify & SoundCloud"})]})]}),c.jsxs("a",{href:"/base/anime",className:"section-card",children:[c.jsx("h3",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Anime Library"}),c.jsx("p",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"MAL":"The entire watched, plan to watch, and watching list synced directly from MyAnimeList."}),c.jsxs("div",{className:"section-chip-row",children:[c.jsx("span",{className:"section-chip accent",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"MAL":"MAL synced"}),c.jsx("span",{className:"section-chip",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Status filters"}),c.jsx("span",{className:"section-chip",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Quick stats"})]})]}),c.jsxs("a",{href:"/base/tcg",className:"section-card",children:[c.jsx("h3",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"TCG":"TCG Collection"}),c.jsx("p",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"TCG":"Pokemon & One Piece TCG cards tracked with quantities, prices, and value."}),c.jsxs("div",{className:"section-chip-row",children:[c.jsx("span",{className:"section-chip accent",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Full Collection"}),c.jsx("span",{className:"section-chip",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Still Under-Construction"})]})]})]})]})]}),c.jsx("footer",{style:{marginTop:"28px",fontSize:"0.78rem",color:"var(--text-soft)",textAlign:"center"},children:"@ 2025 im.ok. All rights reserved."})]})}const IR="modulepreload",bR=function(n){return"/base/"+n},Gv={},cc=function(e,t,s){let a=Promise.resolve();if(t&&t.length>0){let d=function(v){return Promise.all(v.map(w=>Promise.resolve(w).then(S=>({status:"fulfilled",value:S}),S=>({status:"rejected",reason:S}))))};document.getElementsByTagName("link");const f=document.querySelector("meta[property=csp-nonce]"),m=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));a=d(t.map(v=>{if(v=bR(v),v in Gv)return;Gv[v]=!0;const w=v.endsWith(".css"),S=w?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${v}"]${S}`))return;const I=document.createElement("link");if(I.rel=w?"stylesheet":IR,w||(I.as="script"),I.crossOrigin="",I.href=v,m&&I.setAttribute("nonce",m),document.head.appendChild(I),w)return new Promise((U,Z)=>{I.addEventListener("load",U),I.addEventListener("error",()=>Z(new Error(`Unable to preload CSS for ${v}`)))})}))}function l(d){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=d,window.dispatchEvent(f),!f.defaultPrevented)throw d}return a.then(d=>{for(const f of d||[])f.status==="rejected"&&l(f.reason);return e().catch(l)})};function Gw({open:n,title:e,placeholder:t,value:s,status:a,loading:l,onChange:d,onSubmit:f,onClose:m}){if(!n)return null;const v=typeof a=="string"&&a.toLowerCase().startsWith("sent!")?"#a3f0cf":"#ffb6c1";return c.jsx("div",{className:"suggestion-backdrop",onClick:w=>{w.target===w.currentTarget&&m&&m()},children:c.jsxs("div",{className:"suggestion-modal",children:[c.jsxs("div",{className:"suggestion-modal-header",children:[c.jsx("h3",{children:e}),c.jsx("button",{className:"suggestion-close",type:"button",onClick:m,"aria-label":"Close",children:"X"})]}),c.jsx("p",{className:"suggestion-hint",children:"Tell me what to add next. Titles only is fine, but extra notes are welcome."}),c.jsx("textarea",{className:"suggestion-textarea",placeholder:t,value:s,onChange:w=>d==null?void 0:d(w.target.value),maxLength:500}),a&&c.jsx("div",{className:"suggestion-status",style:{color:v},children:a}),c.jsxs("div",{className:"suggestion-actions",children:[c.jsx("button",{className:"suggestion-send",type:"button",onClick:f,disabled:l,children:l?"Sending...":"Send Suggestion"}),c.jsx("button",{className:"suggestion-cancel",type:"button",onClick:m,children:"Cancel"})]})]})})}const $p="mangaLibraryActivityLog",Ia="https://discord.com/api/webhooks/1448329790942613667/wsC8psNZ-Ax2D1O9Gl4sJi6ay7df2cr7IrIdxMPwGZTBnkSUIY2NDpeVd98qW_4plz82";let mo=null;function PR(n){return Array.isArray(n)?n.map(e=>({message:e.message,ts:e.ts?new Date(e.ts):new Date})).filter(e=>e.message):[]}function RR(){if(typeof window>"u")return[];try{const n=localStorage.getItem($p);if(!n)return[];const e=JSON.parse(n);return PR(e)}catch(n){return console.warn("Failed to read activity log",n),[]}}function Hw(n){try{const e=(n||[]).slice(0,100).map(t=>({message:t.message,ts:t.ts instanceof Date?t.ts.toISOString():t.ts}));typeof window<"u"&&localStorage.setItem($p,JSON.stringify(e))}catch(e){console.warn("Failed to persist activity log",e)}}async function NR(){if(mo)return mo;try{const n=Lt(lt,"settings","webhooks"),e=await xd(n);if(e.exists())return mo=e.data().activity||Ia,mo}catch(n){console.warn("Failed to load activity webhook",n)}return mo=Ia,mo}async function AR(n,{email:e,name:t,webhookOverride:s}){if(n)try{const a=s||await NR();if(!a)return;const l=(t||"").trim()||e||"anonymous",d=`Activity: ${n}
User: ${l}
Time: ${new Date().toLocaleString()}`;await fetch(a,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:d})})}catch(a){console.warn("Activity webhook failed",a)}}async function qw(n,e={}){if(!n)return null;const{email:t,name:s,webhookOverride:a,persistLocal:l=!0}=e,d={message:n,ts:new Date};if(l){const f=RR(),m=[d,...f].slice(0,100);Hw(m)}return await AR(n,{email:t,name:s,webhookOverride:a}),d}const Hv=5,kR=3600*1e3,qv="mangaSuggestionsSent",Kv="mangaViewMode";function At(n){let e=(n||"").trim();const t=e.match(/^(.*?)(?:,?\s*(?:Vol\.|Volume)\s*(\d+)(?:\s*[--]\s*\d+)?\s*)?(?:\s*\([^)]*\))?$/i),s=t?t[1].trim().toLowerCase():e.toLowerCase(),a=t&&t[2]?parseInt(t[2],10):0;return{name:s,vol:Number.isFinite(a)?a:0}}function jR(n){if(typeof n=="number")return n;if(n==null||n==="")return 0;const e=parseInt(n,10);return Number.isFinite(e)?e:0}function Qv(){const n=new Date,e=n.getFullYear(),t=String(n.getMonth()+1).padStart(2,"0"),s=String(n.getDate()).padStart(2,"0");return`${e}-${t}-${s}`}function yu(n){const e=(n==null?void 0:n.pageCount)??(n==null?void 0:n.PageCount)??"",t=String(e??"").trim();if(!t)return!0;const s=jR(t);return!Number.isFinite(s)||s<=0}function Po(n,e=!1){const t=(n??"").toString().trim();return!t||!e&&t.toLowerCase()==="unknown"}function go(n){const e=Po(n==null?void 0:n.authors),t=Po(n==null?void 0:n.publisher),s=Po(n==null?void 0:n.date);return{authorMissing:e,publisherMissing:t,dateMissing:s,any:e||t||s}}function Tr(n){if(!n)return"";const e=String(n).trim();if(/^\d{4}-\d{2}-\d{2}$/.test(e))return e;const t=new Date(e);if(Number.isNaN(t.getTime()))return"";const s=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),l=String(t.getDate()).padStart(2,"0");return`${s}-${a}-${l}`}const DR=(n,e)=>{const t=At(n.title||""),s=At(e.title||""),a=t.name.localeCompare(s.name);return a!==0?a:t.vol-s.vol};function LR(n){const t=(n||"").match(/vol(?:ume)?\.?\s*(\d+)(?:\s*[-]\s*(\d+))?/i);if(!t)return[];const s=parseInt(t[1],10),a=t[2]?parseInt(t[2],10):s;if(!Number.isFinite(s))return[];const l=Number.isFinite(a)&&a>=s?a:s,d=[];for(let f=s;f<=l;f+=1)d.push(f);return d}function VR(){const{admin:n,user:e,role:t}=Ho(),s=n,a=x=>{x&&qw(x,{email:(e==null?void 0:e.email)||"anonymous",name:(e==null?void 0:e.displayName)||""})},[l,d]=k.useState("library"),[f,m]=k.useState(()=>typeof window>"u"?"series":localStorage.getItem(Kv)==="individual"?"individual":"series");k.useEffect(()=>{document.title="Manga | Library"},[]),k.useEffect(()=>{vt("")},[e]),k.useEffect(()=>{try{localStorage.setItem(Kv,f)}catch(x){console.warn("Failed to persist manga view mode",x)}},[f]);const v=async()=>{const x=Date.now(),z=(()=>{try{const L=localStorage.getItem(qv);return Array.isArray(JSON.parse(L))?JSON.parse(L):[]}catch{return[]}})().filter(L=>x-L<kR);if(z.length>=Hv){vt("Rate limit: please wait a bit (max 5 suggestions per hour).");return}if(!Le.trim()){vt("Please enter a manga title or note before sending.");return}We(!0),vt("");try{const L=`**Manga Suggestion**
${Le.trim()}
From: ${(e==null?void 0:e.displayName)||(e==null?void 0:e.email)||(e==null?void 0:e.uid)||"anonymous user"}`;await To(ir(lt,"suggestions"),{content:Le.trim(),type:"manga",from:(e==null?void 0:e.displayName)||(e==null?void 0:e.email)||(e==null?void 0:e.uid)||"anonymous user",createdAt:new Date().toISOString()}),vt("Sent! I'll review your suggestion soon."),qe("");const q=[...z,x].slice(-Hv);localStorage.setItem(qv,JSON.stringify(q))}catch(L){console.error("Failed to send suggestion",L),vt("Failed to send suggestion. Please try again later.")}finally{We(!1)}},[w,S]=k.useState([]),[I,U]=k.useState([]),[Z,Q]=k.useState([]),[M,ne]=k.useState([]),[xe,we]=k.useState(!1),[Ee,le]=k.useState(!0),[Re,A]=k.useState(""),[P,R]=k.useState(""),[O,B]=k.useState(""),[D,b]=k.useState(!1),[he,$e]=k.useState(()=>new Set);k.useEffect(()=>{f==="series"&&D&&(typeof Je>"u"||Je===null)&&(b(!1),$e(new Set))},[f,D]);const[Ae,He]=k.useState({open:!1,mode:"add",list:"library",data:{title:"",authors:"",publisher:"",demographic:"",genre:"",subGenre:"",date:"",cover:"",isbn:"",pageCount:"",rating:"",amountPaid:"",dateRead:"",datePurchased:"",msrp:"",special:!1,specialType:"",specialVolumes:"",collectiblePrice:"",amazonURL:"",read:!1},editingId:null,multiAdd:!1,startVol:"",endVol:""}),[me,De]=k.useState([]),[be,K]=k.useState(0),N=k.useMemo(()=>({author:Po(Ae.data.authors),publisher:Po(Ae.data.publisher),date:Po(Ae.data.date),page:yu({pageCount:Ae.data.pageCount})}),[Ae.data]),[W,ee]=k.useState({open:!1,index:0,items:[]}),[Te,_e]=k.useState(!1),[Le,qe]=k.useState(""),[rt,vt]=k.useState(""),[fe,We]=k.useState(!1),[ue,Qe]=k.useState(null),[Je,Rt]=k.useState(null);k.useEffect(()=>{if(!!ue||!!Je||Ae.open||W.open||Te){const $=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=$}}},[ue,Je,Ae.open,W.open,Te]);const kt=!!e&&t==="viewer";async function St(){const x=await ai(ir(lt,"library")),$=[];x.forEach(z=>{const L=z.data();$.push({id:z.id,title:L.title||"",authors:L.authors||"Unknown",publisher:L.publisher||"Unknown",demographic:L.demographic||"",genre:L.genre||"",subGenre:L.subGenre||"",date:Tr(L.date)||L.date||"Unknown",cover:L.cover||"",isbn:L.isbn||"",pageCount:L.pageCount!==void 0&&L.pageCount!==null?L.pageCount:"",rating:L.rating!==void 0&&L.rating!==null?L.rating:"",amountPaid:L.amountPaid!==void 0&&L.amountPaid!==null?L.amountPaid:"",dateRead:Tr(L.dateRead)||L.dateRead||"",datePurchased:Tr(L.datePurchased)||L.datePurchased||"",msrp:L.msrp!==void 0&&L.msrp!==null?L.msrp:"",specialType:L.specialType||"",specialVolumes:L.specialVolumes!==void 0&&L.specialVolumes!==null?L.specialVolumes:"",collectiblePrice:L.collectiblePrice!==void 0&&L.collectiblePrice!==null?L.collectiblePrice:"",read:!!L.read,amazonURL:L.amazonURL||"",hidden:!!L.hidden,kind:"library"})}),$.sort((z,L)=>{const q=At(z.title),ie=At(L.title),se=q.name.localeCompare(ie.name);return se!==0?se:q.vol-ie.vol}),S($),Q(z=>{const L=new Set(z);return $.forEach(q=>L.add(q.title||"")),Array.from(L).filter(Boolean).sort()})}async function jt(){const x=await ai(ir(lt,"wishlist")),$=[];x.forEach(z=>{const L=z.data();$.push({id:z.id,title:L.title||"",authors:L.authors||"Unknown",publisher:L.publisher||"Unknown",date:Tr(L.date)||L.date||"Unknown",cover:L.cover||"",isbn:L.isbn||"",pageCount:L.pageCount!==void 0&&L.pageCount!==null?L.pageCount:"",rating:L.rating!==void 0&&L.rating!==null?L.rating:"",amountPaid:L.amountPaid!==void 0&&L.amountPaid!==null?L.amountPaid:"",datePurchased:Tr(L.datePurchased)||L.datePurchased||"",specialType:L.specialType||"",specialVolumes:L.specialVolumes!==void 0&&L.specialVolumes!==null?L.specialVolumes:"",collectiblePrice:L.collectiblePrice!==void 0&&L.collectiblePrice!==null?L.collectiblePrice:"",amazonURL:L.amazonURL||"",hidden:!!L.hidden,kind:"wishlist"})}),$.sort((z,L)=>{const q=At(z.title),ie=At(L.title),se=q.name.localeCompare(ie.name);return se!==0?se:q.vol-ie.vol}),U($),Q(z=>{const L=new Set(z);return $.forEach(q=>L.add(q.title||"")),Array.from(L).filter(Boolean).sort()})}k.useEffect(()=>{let x=!1,$=!1,z=!1;const L=async()=>{if(!x)try{const Ce=await fetch("/base/manga-library-wishlist.json",{cache:"no-cache"});if(!Ce.ok)throw new Error("fallback fetch failed");const Ne=await Ce.json(),ae=Array.isArray(Ne.library)?Ne.library:[],it=Array.isArray(Ne.wishlist)?Ne.wishlist:[];S(ae.map((ke,dt)=>({id:ke.id||`offline-lib-${dt}`,title:ke.title||"",authors:ke.authors||"Unknown",publisher:ke.publisher||"Unknown",demographic:ke.demographic||"",genre:ke.genre||"",subGenre:ke.subGenre||"",date:Tr(ke.date)||ke.date||"Unknown",cover:ke.cover||"",isbn:ke.isbn||"",pageCount:ke.pageCount??"",rating:ke.rating??"",amountPaid:ke.amountPaid??"",dateRead:Tr(ke.dateRead)||ke.dateRead||"",datePurchased:Tr(ke.datePurchased)||ke.datePurchased||"",msrp:ke.msrp??"",specialType:ke.specialType||"",specialVolumes:ke.specialVolumes??"",collectiblePrice:ke.collectiblePrice??"",amazonURL:ke.amazonURL||"",read:!!ke.read,hidden:!!ke.hidden,kind:"library"}))),U(it.map((ke,dt)=>({id:ke.id||`offline-wish-${dt}`,title:ke.title||"",authors:ke.authors||"Unknown",publisher:ke.publisher||"Unknown",demographic:ke.demographic||"",genre:ke.genre||"",subGenre:ke.subGenre||"",date:Tr(ke.date)||ke.date||"Unknown",cover:ke.cover||"",isbn:ke.isbn||"",pageCount:ke.pageCount??"",rating:ke.rating??"",amountPaid:ke.amountPaid??"",dateRead:Tr(ke.dateRead)||ke.dateRead||"",datePurchased:Tr(ke.datePurchased)||ke.datePurchased||"",msrp:ke.msrp??"",specialType:ke.specialType||"",specialVolumes:ke.specialVolumes??"",collectiblePrice:ke.collectiblePrice??"",amazonURL:ke.amazonURL||"",read:!!ke.read,hidden:!!ke.hidden,kind:"wishlist"}))),A("")}catch(Se){console.error("Offline fallback failed",Se),A("Failed to load manga data from Firestore.")}finally{x||le(!1)}},q=()=>{$&&z&&!x&&le(!1)};if(!e)return;le(!0),A("");const ie=$v(ir(lt,"library"),Se=>{if(x)return;const Ce=[];Se.forEach(Ne=>{const ae=Ne.data();Ce.push({id:Ne.id,title:ae.title||"",authors:ae.authors||"Unknown",publisher:ae.publisher||"Unknown",demographic:ae.demographic||"",genre:ae.genre||"",subGenre:ae.subGenre||"",date:ae.date||"Unknown",cover:ae.cover||"",isbn:ae.isbn||"",pageCount:ae.pageCount!==void 0&&ae.pageCount!==null?ae.pageCount:"",rating:ae.rating!==void 0&&ae.rating!==null?ae.rating:"",amountPaid:ae.amountPaid!==void 0&&ae.amountPaid!==null?ae.amountPaid:"",dateRead:ae.dateRead||"",datePurchased:ae.datePurchased||"",msrp:ae.msrp!==void 0&&ae.msrp!==null?ae.msrp:"",specialType:ae.specialType||"",specialVolumes:ae.specialVolumes!==void 0&&ae.specialVolumes!==null?ae.specialVolumes:"",collectiblePrice:ae.collectiblePrice!==void 0&&ae.collectiblePrice!==null?ae.collectiblePrice:"",read:!!ae.read,amazonURL:ae.amazonURL||"",hidden:!!ae.hidden,kind:"library"})}),Ce.sort((Ne,ae)=>{const it=At(Ne.title),ke=At(ae.title),dt=it.name.localeCompare(ke.name);return dt!==0?dt:it.vol-ke.vol}),S(Ce),Q(Ne=>{const ae=new Set(Ne);return Ce.forEach(it=>ae.add(it.title||"")),Array.from(ae).filter(Boolean).sort()}),$=!0,q()},async Se=>{console.error("Library listener failed",Se),x||(A("Failed to load manga data from Firestore."),await L())}),se=$v(ir(lt,"wishlist"),Se=>{if(x)return;const Ce=[];Se.forEach(Ne=>{const ae=Ne.data();Ce.push({id:Ne.id,title:ae.title||"",authors:ae.authors||"Unknown",publisher:ae.publisher||"Unknown",demographic:ae.demographic||"",genre:ae.genre||"",subGenre:ae.subGenre||"",date:ae.date||"Unknown",cover:ae.cover||"",isbn:ae.isbn||"",pageCount:ae.pageCount!==void 0&&ae.pageCount!==null?ae.pageCount:"",rating:ae.rating!==void 0&&ae.rating!==null?ae.rating:"",amountPaid:ae.amountPaid!==void 0&&ae.amountPaid!==null?ae.amountPaid:"",datePurchased:ae.datePurchased||"",specialType:ae.specialType||"",specialVolumes:ae.specialVolumes!==void 0&&ae.specialVolumes!==null?ae.specialVolumes:"",collectiblePrice:ae.collectiblePrice!==void 0&&ae.collectiblePrice!==null?ae.collectiblePrice:"",amazonURL:ae.amazonURL||"",hidden:!!ae.hidden,kind:"wishlist"})}),Ce.sort((Ne,ae)=>{const it=At(Ne.title),ke=At(ae.title),dt=it.name.localeCompare(ke.name);return dt!==0?dt:it.vol-ke.vol}),U(Ce),Q(Ne=>{const ae=new Set(Ne);return Ce.forEach(it=>ae.add(it.title||"")),Array.from(ae).filter(Boolean).sort()}),z=!0,q()},async Se=>{console.error("Wishlist listener failed",Se),x||(A("Failed to load manga data from Firestore."),await L())});return()=>{x=!0,ie==null||ie(),se==null||se()}},[e]);const on=k.useMemo(()=>{const x=P.trim().toLowerCase();return x?w.filter($=>[$.title,$.authors,$.publisher,$.isbn,$.date,String($.pageCount??"")].join(" ").toLowerCase().includes(x)):w},[w,P]),Sn=k.useMemo(()=>s&&xe?on:on.filter(x=>!x.hidden),[on,s,xe]),ln=k.useMemo(()=>{const x=O.trim().toLowerCase();return x?I.filter($=>[$.title,$.authors,$.publisher,$.isbn,$.date,String($.pageCount??"")].join(" ").toLowerCase().includes(x)):I},[I,O]),fr=k.useMemo(()=>s&&xe?ln:ln.filter(x=>!x.hidden),[ln,s,xe]),Xt=x=>{m(x==="individual"?"individual":"series"),$e(new Set),b(!1)},qn=x=>{if(!(x!=null&&x.length))return;const $=(z,L)=>{let q=[...z];return x.filter(ie=>ie.target===L).forEach(ie=>{const se=q.findIndex(Ce=>Ce.id===ie.id),Se={...se>=0?q[se]:{},...ie.payload,id:ie.id,kind:L};se>=0?q[se]=Se:q.push(Se)}),q.sort(DR),q};S(z=>$(z,"library")),U(z=>$(z,"wishlist"))},Ot=x=>{b($=>{const z=!$;if(z){const L=new Set((x||[]).map(q=>q.id));$e(q=>new Set([...q].filter(ie=>L.has(ie))))}else $e(new Set);return z})};function $t(){s&&(b(x=>!x),$e(new Set))}function On(x){$e($=>{const z=new Set($);return z.has(x)?z.delete(x):z.add(x),z})}async function lr(x,$=null){if(!s){alert("Multi-select actions require admin access.");return}const z=Array.from(he);if(!z.length){alert("Select at least one item first.");return}const L=l==="library"?"library":"wishlist",q=$||(L==="library"?"wishlist":"library"),ie=L==="library";try{if(x==="move"){const se=L==="library"?w:I;if(!window.confirm(`Move ${z.length} item(s) from ${L==="library"?"Library":"Wishlist"} to ${q==="library"?"Library":"Wishlist"}?`))return;for(const Se of z){const Ce=se.find(ae=>ae.id===Se);if(!Ce)continue;const Ne=q==="library"?{title:Ce.title,authors:Ce.authors,publisher:Ce.publisher,date:Ce.date,pageCount:Ce.pageCount||"",cover:Ce.cover,amountPaid:"",read:!1,rating:"",msrp:"",collectiblePrice:"",specialType:"",specialVolumes:"",isbn:Ce.isbn||"",demographic:Ce.demographic||"",genre:Ce.genre||"",subGenre:Ce.subGenre||"",hidden:!!Ce.hidden,datePurchased:Ce.datePurchased||"",dateRead:Ce.dateRead||""}:{title:Ce.title,authors:Ce.authors,publisher:Ce.publisher,date:Ce.date,pageCount:Ce.pageCount||"",cover:Ce.cover,amazonURL:Ce.amazonURL||"",hidden:!!Ce.hidden,datePurchased:"",read:!1,rating:"",msrp:"",collectiblePrice:"",specialType:"",specialVolumes:"",isbn:"",demographic:"",genre:"",subGenre:""};await To(ir(lt,q),Ne),await Eo(Lt(lt,L,Se))}a(`Moved ${z.length} item${z.length===1?"":"s"} from ${L==="library"?"Library":"Wishlist"} to ${q==="library"?"Library":"Wishlist"}`)}else if(x==="markRead"&&ie){for(const se of z)await Ds(Lt(lt,"library",se),{read:!0,dateRead:Qv()});a(`Marked ${z.length} library book${z.length===1?"":"s"} as read`)}else if(x==="markUnread"&&ie){for(const se of z)await Ds(Lt(lt,"library",se),{read:!1,dateRead:"",rating:""});a(`Marked ${z.length} library book${z.length===1?"":"s"} as unread`)}else if(x==="delete"){const se=ie?"library":"wishlist";if(!window.confirm(`Delete ${z.length} item(s) from ${ie?"Library":"Wishlist"}?`))return;for(const Se of z)await Eo(Lt(lt,se,Se));a(`Deleted ${z.length} item${z.length===1?"":"s"} from ${se==="library"?"Library":"Wishlist"}`)}await Promise.all([St(),jt()]),$e(new Set),b(!1)}catch(se){console.error(se),alert("Failed to apply multi-select action.")}}function Cn(x){Qe(x)}function Mn(){Qe(null)}function Qt(x){const $=Fn.filter(z=>(At(z.title||"").name||(z.title||"").toLowerCase()||z.id)===x.key).sort((z,L)=>At(z.title).vol-At(L.title).vol);Rt({series:x,volumes:$})}function Zr(){Rt(null)}const In=()=>{He(x=>({...x,open:!1,mode:"add",editingId:null,data:{title:"",authors:"",publisher:"",demographic:"",genre:"",subGenre:"",date:"",cover:"",isbn:"",pageCount:"",rating:"",amountPaid:"",dateRead:"",datePurchased:"",msrp:"",special:!1,specialType:"",specialVolumes:"",collectiblePrice:"",amazonURL:"",read:!1,hidden:!1},multiAdd:!1,startVol:"",endVol:""})),De([]),K(0)},pn=k.useMemo(()=>{const x=new Map;return[...w,...I].forEach($=>{const z=At($.title||"");if(!z.name)return;const L=($.title||"").replace(/,?\s*Vol\.?\s*\d+.*/i,"").trim()||$.title||z.name;if(!x.has(z.name))x.set(z.name,{display:L,maxVol:z.vol,authors:$.authors||"",publisher:$.publisher||"",demographic:$.demographic||""});else{const q=x.get(z.name);q.maxVol=Math.max(q.maxVol,z.vol),!q.authors&&$.authors&&(q.authors=$.authors),!q.publisher&&$.publisher&&(q.publisher=$.publisher),!q.demographic&&$.demographic&&(q.demographic=$.demographic)}}),x},[w,I]),es=x=>{He($=>({...$,open:!0,mode:"add",list:x,editingId:null,data:{...$.data,title:"",list:x}})),De([{kind:"new",id:null,data:{title:"",authors:"",publisher:"",demographic:"",genre:"",subGenre:"",date:"",cover:"",isbn:"",pageCount:"",rating:"",amountPaid:"",dateRead:"",datePurchased:"",msrp:"",specialType:"",specialVolumes:"",collectiblePrice:"",amazonURL:"",read:!1}}]),K(0)},ws=x=>{const $={open:!0,mode:"edit",list:x.kind==="wishlist"?"wishlist":"library",editingId:x.id,data:{title:x.title||"",authors:x.authors||"",publisher:x.publisher||"",demographic:x.demographic||"",genre:x.genre||"",subGenre:x.subGenre||"",date:x.date||"",cover:x.cover||"",isbn:x.isbn||"",pageCount:x.pageCount||"",rating:x.rating||"",amountPaid:x.amountPaid||"",dateRead:x.dateRead||"",datePurchased:x.datePurchased||"",msrp:x.msrp||"",special:!!(x.specialType||x.specialVolumes||x.collectiblePrice),specialType:x.specialType||"",specialVolumes:x.specialVolumes||"",collectiblePrice:x.collectiblePrice||"",amazonURL:x.amazonURL||"",read:!!x.read,hidden:!!x.hidden}};He($),De([{kind:"edit",id:x.id,data:{...$.data}}]),K(0)},It=(x,$,z="text")=>{if(He(L=>{const q={...L.data,[x]:z==="checkbox"?!!$:$};if(x==="special"&&!$&&(q.specialType="",q.specialVolumes="",q.collectiblePrice=""),x==="specialType"&&($==="collectible"?q.specialVolumes="":($==="specialEdition"||(q.specialVolumes=""),q.collectiblePrice="")),x==="title"){const ie=At($||"");if(ie.name&&pn.has(ie.name)){const se=pn.get(ie.name);q.authors=se.authors||q.authors,q.publisher=se.publisher||q.publisher,q.demographic=se.demographic||q.demographic}}return{...L,data:q}}),De(L=>{if(!L.length)return L;const q=[...L],ie={...q[be]};return ie.data={...ie.data,[x]:z==="checkbox"?!!$:$},q[be]=ie,q}),x==="title"){const L=String($||"").trim().toLowerCase();if(!L)ne([]);else{const q=[];pn.forEach(ie=>{if(ie.display.toLowerCase().includes(L)){const se=ie.maxVol>0?ie.maxVol+1:1;q.push(`${ie.display}, Vol. ${se}`)}}),ne(q.slice(0,6))}}},pr=x=>{me[x]&&(K(x),He($=>{const z=me[x];return{...$,data:{...z.data}}}))},xs=()=>{const x=Ae.data.title||"",$=At(x);if(!$.name){alert("Provide a title with a volume number first (e.g., Series, Vol. 1).");return}const z={kind:Ae.mode,id:Ae.editingId,data:{...Ae.data}},L=me.length?[...me]:[];L.length?L[be]=z:L.push(z);const q=x.replace(/,?\s*Vol\.?\s*\d+.*/i,"").trim()||x;let ie=$.vol||0;const se=pn.get($.name);se&&se.maxVol>ie&&(ie=se.maxVol),L.forEach(ae=>{const it=At(ae.data.title||"");it.name===$.name&&(ie=Math.max(ie,it.vol||0))});const Se=(ie||0)+1,Ne={title:`${q}, Vol. ${Se}`,authors:Ae.data.authors,publisher:Ae.data.publisher,demographic:Ae.data.demographic,genre:Ae.data.genre,subGenre:Ae.data.subGenre,msrp:Ae.data.msrp,hidden:Ae.data.hidden,cover:"",isbn:"",pageCount:"",rating:"",amountPaid:"",date:"",dateRead:"",datePurchased:"",special:!1,specialType:"",specialVolumes:"",collectiblePrice:"",amazonURL:"",read:!1};L.push({kind:"new",id:null,data:Ne}),De(L),K(L.length-1),He(ae=>({...ae,mode:"add",data:Ne}))};async function Kn(){if(!s)return;const{list:x}=Ae,$=x||"library",z=me.length>0?me:[{kind:Ae.mode,id:Ae.editingId,data:Ae.data}],L=q=>{const ie=(q.title||"").trim(),se=At(ie),Se=pn.get(se.name)||{},Ce=(q.authors||"").trim()||Se.authors||"",Ne=(q.publisher||"").trim()||Se.publisher||"",ae=(q.demographic||"").trim()||Se.demographic||"",it=(q.genre||"").trim()||Se.genre||"",ke=(q.subGenre||"").trim()||Se.subGenre||"";return{title:ie,authors:Ce,publisher:Ne,demographic:ae,genre:it,subGenre:ke,date:Tr(q.date||""),cover:(q.cover||"").trim(),isbn:$==="wishlist"?"":(q.isbn||"").trim(),pageCount:q.pageCount===""?"":Number(q.pageCount),rating:$==="wishlist"||q.rating===""?"":Math.max(.5,Math.min(5,Number(q.rating))),amountPaid:q.amountPaid===""?"":Number(q.amountPaid),dateRead:Tr(q.dateRead||""),datePurchased:Tr(q.datePurchased||""),msrp:$==="wishlist"||q.msrp===""?"":Number(q.msrp),special:$==="wishlist"?!1:!!(q.special&&(q.specialType||"").trim()),specialType:$==="wishlist"||!(q.special&&(q.specialType||"").trim())?"":(q.specialType||"").trim(),specialVolumes:$==="wishlist"?"":q.special&&q.specialType==="specialEdition"?q.specialVolumes===""?"":Number(q.specialVolumes):"",collectiblePrice:$==="wishlist"?"":q.special&&q.specialType==="collectible"?q.collectiblePrice===""?"":Number(q.collectiblePrice):"",amazonURL:(q.amazonURL||"").trim(),read:$==="wishlist"?!1:!!q.read,hidden:!!q.hidden,kind:x}};try{const q=await Promise.all(z.map(async ie=>{const se=L(ie.data);if($==="library"&&ie.kind!=="edit"){const Se=At(se.title).name,Ce=w.filter(ae=>At(ae.title||ae.Title||"").name===Se),Ne=Ce[0];if(Ne&&(se.demographic=se.demographic||Ne.demographic||Ne.Demographic||"",se.genre=se.genre||Ne.genre||Ne.Genre||"",se.subGenre=se.subGenre||Ne.subGenre||Ne.SubGenre||"",se.msrp==="")){const ae=Ce.map(it=>Number(it.msrp??it.MSRP)).filter(it=>Number.isFinite(it));ae.length>0&&ae.every(ke=>ke===ae[0])&&(se.msrp=ae[0])}}if(!se.title)throw alert("Title is required for every entry."),new Error("missing title");if(ie.kind==="edit"&&ie.id)return await Ds(Lt(lt,$,ie.id),se),{target:$,id:ie.id,payload:se};{const Se=await To(ir(lt,$),se);return{target:$,id:Se.id,payload:se}}}));qn(q.filter(Boolean)),await Promise.all([St(),jt()]),a(`${Ae.mode==="add"?"Added":"Saved"} ${z.length} item${z.length===1?"":"s"} in ${$==="library"?"Library":"Wishlist"}`),In()}catch(q){console.error(q),alert("Failed to save entry.")}}async function Qn(x,$){if(!s||!window.confirm("Delete this entry?"))return;const L=($==="wishlist"?I:w).find(q=>q.id===x);try{await Eo(Lt(lt,$,x)),await Promise.all([St(),jt()]),a(`Deleted "${(L==null?void 0:L.title)||"Untitled"}" from ${$==="library"?"Library":"Wishlist"}`)}catch(q){console.error(q),alert("Failed to delete entry.")}}const[br,bn]=k.useState(!1),Pr=()=>ee({open:!1,index:0,items:[]});async function Yn(x,$){if(!(x!=null&&x.id))return;const z=x.kind==="wishlist"?"wishlist":"library";bn(!0);try{await Ds(Lt(lt,z,x.id),$),qn([{target:z,id:x.id,payload:$}]),await Promise.all([St(),jt()]),a(`Updated "${x.title||"Untitled"}" in ${z==="library"?"Library":"Wishlist"}`),Qe(L=>L&&L.id===x.id?{...L,...$}:L)}catch(L){console.error(L),alert("Failed to update entry.")}finally{bn(!1)}}const $s=(x,$)=>{const z=$===""?"":Math.max(.5,Math.min(5,Number($)));Yn(x,{rating:z})},mr=(x,$)=>{if(!x)return;const z=$?{read:!0,dateRead:Qv()}:{read:!1,dateRead:""};Yn(x,z)},Ws=()=>{if(!he.size){alert("Select at least one entry first.");return}const $=[...w,...I].filter(L=>he.has(L.id));if(!$.length){alert("No items selected.");return}const z=$.map(L=>({id:L.id,kind:L.kind||(l==="wishlist"?"wishlist":"library"),data:{title:L.title||"",authors:L.authors||"",publisher:L.publisher||"",demographic:L.demographic||"",genre:L.genre||"",subGenre:L.subGenre||"",date:L.date||"",cover:L.cover||"",isbn:L.isbn||"",pageCount:L.pageCount||"",rating:L.rating||"",amountPaid:L.amountPaid||"",dateRead:L.dateRead||"",datePurchased:L.datePurchased||"",msrp:L.msrp||"",special:!!(L.specialType||L.specialVolumes||L.collectiblePrice),specialType:L.specialType||"",specialVolumes:L.specialVolumes||"",collectiblePrice:L.collectiblePrice||"",amazonURL:L.amazonURL||"",read:!!L.read,hidden:!!L.hidden}}));ee({open:!0,index:0,items:z})},tt=(x,$,z="text")=>{ee(L=>{const q=[...L.items],ie={...q[L.index]},se={...ie.data,[x]:z==="checkbox"?!!$:$};return x==="special"&&!$&&(se.specialType="",se.specialVolumes="",se.collectiblePrice=""),x==="specialType"&&($==="collectible"?se.specialVolumes="":($==="specialEdition"||(se.specialVolumes=""),se.collectiblePrice="")),ie.data=se,q[L.index]=ie,{...L,items:q}})},Jn=()=>{ee(x=>({...x,index:Math.min(x.index+1,x.items.length-1)}))},Pn=()=>{ee(x=>({...x,index:Math.max(x.index-1,0)}))};async function ts(){if(!s)return;const x=W.items;if(!x.length){Pr();return}try{const $=await Promise.all(x.map(async z=>{const q=!(z.kind==="wishlist")&&!!(z.data.special&&(z.data.specialType||"").trim()),ie={...z.data,pageCount:z.data.pageCount===""?"":Number(z.data.pageCount),rating:z.data.rating===""?"":Math.max(.5,Math.min(5,Number(z.data.rating))),amountPaid:z.data.amountPaid===""?"":Number(z.data.amountPaid),msrp:z.data.msrp===""?"":Number(z.data.msrp),special:q,specialType:q?z.data.specialType:"",collectiblePrice:q&&z.data.specialType==="collectible"?z.data.collectiblePrice===""?"":Number(z.data.collectiblePrice):"",specialVolumes:q&&z.data.specialType==="specialEdition"?z.data.specialVolumes===""?"":Number(z.data.specialVolumes):"",datePurchased:z.data.datePurchased||"",amazonURL:z.data.amazonURL||"",read:!!z.data.read},se=z.kind==="wishlist"?"wishlist":"library";return await Ds(Lt(lt,se,z.id),ie),{target:se,id:z.id,payload:ie}}));qn($.filter(Boolean)),await Promise.all([St(),jt()]),$e(new Set),b(!1),a(`Bulk edited ${x.length} item${x.length===1?"":"s"} in Library/Wishlist`),Pr()}catch($){console.error($),alert("Failed to save bulk edits.")}}const Rn=x=>{const $=new Map;return x.forEach(z=>{const L=At(z.title||""),q=L.name||(z.title||"").toLowerCase()||z.id,ie=pn.get(L.name)||null,se=(ie==null?void 0:ie.display)||(z.title||"").replace(/,?\s*Vol\.?\s*\d+.*/i,"").trim()||z.title||"Untitled",Se=go(z),Ce=LR(z.title||""),Ne=Number.isFinite(L.vol)?L.vol:0,ae=Ce.length>0?Ce:Ne>0?[Ne]:[],it=ae.length?ae[0]:0,ke=yu(z);if(!$.has(q))$.set(q,{id:`series-${q}`,key:q,title:se,authors:z.authors&&z.authors!=="Unknown"?z.authors:(ie==null?void 0:ie.authors)||"",publisher:z.publisher&&z.publisher!=="Unknown"?z.publisher:(ie==null?void 0:ie.publisher)||"",demographic:(ie==null?void 0:ie.demographic)||z.demographic||"",cover:z.cover||"",count:1,readCount:z.read?1:0,minVol:it,maxVol:it,representative:z,volumes:[...ae],missingPageCount:ke?1:0,missingMetaCount:Se.any?1:0,missingVolumeCount:ke||Se.any?1:0});else{const dt=$.get(q);if(dt.count+=1,z.read&&(dt.readCount+=1),ke&&(dt.missingPageCount+=1),Se.any&&(dt.missingMetaCount+=1),(ke||Se.any)&&(dt.missingVolumeCount+=1),ae.length){const cr=Math.min(...ae),Ks=Math.max(...ae);dt.minVol=Math.min(dt.minVol,cr),dt.maxVol=Math.max(dt.maxVol,Ks),dt.volumes.push(...ae)}!dt.cover&&z.cover&&(dt.cover=z.cover),!dt.authors&&z.authors&&z.authors!=="Unknown"&&(dt.authors=z.authors),!dt.publisher&&z.publisher&&z.publisher!=="Unknown"&&(dt.publisher=z.publisher)}}),Array.from($.values())},mn=x=>{const $=Array.from(new Set((x||[]).filter(se=>Number.isFinite(se)&&se>=0))).sort((se,Se)=>se-Se);if(!$.length)return null;const z=[];let L=$[0],q=$[0];for(let se=1;se<$.length;se+=1){const Se=$[se];if(Se===q+1){q=Se;continue}z.push([L,q]),L=Se,q=Se}if(z.push([L,q]),z.length===1){const[se,Se]=z[0];return se===Se?`Vol. ${se}`:`Vol. ${se}-${Se}`}return`Vols. ${z.map(([se,Se])=>se===Se?`${se}`:`${se}-${Se}`).join(", ")}`};function Nn(x){const $=he.has(x.id),z=x.kind==="library",L=s&&yu(x),q=s?go(x):{any:!1,authorMissing:!1,publisherMissing:!1,dateMissing:!1},ie=()=>{D&&s?On(x.id):Cn(x)};return c.jsxs("div",{className:"manga-card"+(x.read&&z?" read":"")+($?" multiselect-selected":"")+(L?" missing-page":"")+(q.any?" missing-meta":""),onClick:ie,children:[c.jsx("div",{className:"manga-card-cover-wrap",children:c.jsx("img",{src:x.cover||"https://imgur.com/chUgq4W.png",alt:"Cover",loading:"lazy",decoding:"async"})}),c.jsxs("div",{className:"manga-card-body",children:[c.jsx("div",{className:"manga-card-title",children:x.title||"Untitled"}),c.jsxs("div",{className:"manga-card-meta",children:[c.jsx("span",{className:q.authorMissing?"missing-field":"",children:x.authors&&x.authors!=="Unknown"?x.authors:q.authorMissing?"Missing author":""}),c.jsx("br",{}),c.jsx("span",{className:q.publisherMissing?"missing-field":"",children:x.publisher&&x.publisher!=="Unknown"?x.publisher:q.publisherMissing?"Missing publisher":""}),c.jsx("br",{}),c.jsx("span",{className:q.dateMissing?"missing-field":"",children:x.date&&x.date!=="Unknown"?x.date:q.dateMissing?"Missing date":""})]}),x.isbn&&c.jsxs("div",{className:"manga-card-isbn",children:["ISBN: ",x.isbn]}),s&&c.jsxs("div",{className:"manga-card-actions",children:[c.jsx("button",{type:"button",className:"manga-btn mini",onClick:se=>{se.stopPropagation(),ws(x)},children:"Edit"}),c.jsx("button",{type:"button",className:"manga-btn mini danger",onClick:se=>{se.stopPropagation(),Qn(x.id,x.kind==="wishlist"?"wishlist":"library")},children:"Delete"})]})]})]},x.id)}function Es(x){var Se;const $=mn(x.volumes),z=`${x.count} volume${x.count===1?"":"s"}`;x.readCount>=x.count&&x.count>0||`${x.readCount}${x.count}`;const L=x.readCount>=x.count&&x.count>0,q=s&&x.missingVolumeCount||0,ie=q>0,se=[x.authors&&x.authors!=="Unknown"?x.authors:null,x.publisher&&x.publisher!=="Unknown"?x.publisher:null,$?`${z} - ${$}`:z].filter(Boolean);return c.jsxs("div",{className:"manga-card series-view"+(L?" read":"")+(ie?" missing-page missing-meta":""),onClick:()=>Qt(x),children:[ie&&c.jsx("div",{className:"missing-page-badge",title:"Volumes missing required data",children:q}),c.jsx("div",{className:"manga-card-cover-wrap",children:c.jsx("img",{src:x.cover||((Se=x.representative)==null?void 0:Se.cover)||"https://imgur.com/chUgq4W.png",alt:"Cover",loading:"lazy",decoding:"async"})}),c.jsxs("div",{className:"manga-card-body",children:[c.jsx("div",{className:"manga-card-title",children:x.title||"Untitled Series"}),c.jsx("div",{className:"manga-card-meta",children:se.map((Ce,Ne)=>c.jsxs(zf.Fragment,{children:[Ce,c.jsx("br",{})]},Ce+Ne))}),c.jsx("div",{className:"manga-card-series-count",children:z})]})]},x.id)}const Ts=({value:x,onChange:$})=>{const[z,L]=k.useState(null),q=Math.max(0,Math.min(5,Number(x)||0)),ie=z??q,se=Array.from({length:10},(Ne,ae)=>(ae+1)*.5),Se=5,Ce=Array.from({length:Se},(Ne,ae)=>Math.max(0,Math.min(1,ie-ae)));return c.jsxs("div",{className:"star-shell",role:"group","aria-label":"Rating",children:[c.jsxs("div",{className:"star-visual",style:{"--star-count":Se},children:[c.jsx("div",{className:"star-row",children:Ce.map((Ne,ae)=>c.jsxs("div",{className:"star-icon",children:[c.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",className:"star-base",children:c.jsx("path",{d:"M12 2.5l2.9 5.88 6.5.95-4.7 4.58 1.1 6.43L12 17.9l-5.8 3.44 1.1-6.43-4.7-4.58 6.5-.95L12 2.5z"})}),c.jsx("div",{className:"star-fill",style:{"--pct":`${(Math.max(0,Math.min(1,Ne))*100).toFixed(1)}%`},children:c.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:c.jsx("path",{d:"M12 2.5l2.9 5.88 6.5.95-4.7 4.58 1.1 6.43L12 17.9l-5.8 3.44 1.1-6.43-4.7-4.58 6.5-.95L12 2.5z"})})})]},ae))}),c.jsx("div",{className:"star-hit",children:se.map(Ne=>c.jsx("button",{type:"button","aria-label":`${Ne} stars`,onMouseEnter:()=>L(Ne),onMouseLeave:()=>L(null),onClick:()=>$(Ne)},Ne))})]}),c.jsx("div",{className:"star-value",children:ie?ie.toFixed(1):"--"}),c.jsx("button",{type:"button",className:"star-clear",onClick:()=>$(""),"aria-label":"Clear rating",children:"clear"})]})},Fn=l==="library"?Sn:fr,Fr=l==="library"?w:I,Mt=k.useMemo(()=>Rn(Fn),[Fn,pn]),ns=k.useMemo(()=>Rn(Fr),[Fr,pn]);k.useEffect(()=>{if(!ue&&!Je)return;const x=[...w,...I];if(ue){const $=x.find(z=>z.id===ue.id);$?($.title!==ue.title||$.isbn!==ue.isbn||$.publisher!==ue.publisher||$.authors!==ue.authors||$.date!==ue.date||$.pageCount!==ue.pageCount||$.amountPaid!==ue.amountPaid||$.msrp!==ue.msrp||$.rating!==ue.rating||$.read!==ue.read||$.amazonURL!==ue.amazonURL)&&Qe($):Qe(null)}if(Je){const $=Mt.find(se=>se.key===Je.series.key);if(!$){Rt(null);return}const z=Fn.filter(se=>(At(se.title||"").name||(se.title||"").toLowerCase()||se.id)===$.key).sort((se,Se)=>At(se.title).vol-At(Se.title).vol),L=z.length===Je.volumes.length&&z.every((se,Se)=>{var Ce;return((Ce=Je.volumes[Se])==null?void 0:Ce.id)===se.id}),q=z.length!==Je.volumes.length||z.some((se,Se)=>{const Ce=Je.volumes[Se];return!Ce||Ce.id!==se.id?!0:Ce.title!==se.title||Ce.authors!==se.authors||Ce.publisher!==se.publisher||Ce.date!==se.date||Ce.isbn!==se.isbn||Ce.cover!==se.cover||Ce.read!==se.read||Ce.pageCount!==se.pageCount||Ce.amountPaid!==se.amountPaid||Ce.msrp!==se.msrp||Ce.rating!==se.rating}),ie=$.title!==Je.series.title||$.authors!==Je.series.authors||$.publisher!==Je.series.publisher||$.count!==Je.series.count;(q||ie||!L)&&Rt({series:$,volumes:z})}},[w,I,ue,Je,Fn,Mt]);const cn=f==="series"?Mt:Fn;f==="series"?Mt.length:Fn.length,f==="series"?ns.length:Fr.length;const Rr=(x,$)=>{if(!x.length)return;const z=Array.from(x.reduce((Ce,Ne)=>(Object.keys(Ne).forEach(ae=>Ce.add(ae)),Ce),new Set)),L=Ce=>{const Ne=Ce==null?"":String(Ce);return/[",\n]/.test(Ne)?`"${Ne.replace(/"/g,'""')}"`:Ne},q=[z.join(",")].concat(x.map(Ce=>z.map(Ne=>L(Ce[Ne])).join(","))),ie=new Blob([q.join(`
`)],{type:"text/csv"}),se=URL.createObjectURL(ie),Se=document.createElement("a");Se.href=se,Se.download=$,Se.click(),URL.revokeObjectURL(se)},Gs=async(x,$)=>{const z=(q,ie="image")=>(q||"").toString().toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"").slice(0,100)||ie,L=x.filter(q=>q.cover).map((q,ie)=>({url:q.cover,name:z(q.title||`manga-${ie+1}`,`manga-${ie+1}`)}));if(!L.length){alert("No images found to download.");return}try{const q=(await cc(async()=>{const{default:ke}=await import("https://cdn.jsdelivr.net/npm/jszip@3.10.1/+esm");return{default:ke}},[])).default,ie=new q,se=ie.folder("images"),Se={},Ce=L.map(async(ke,dt)=>{try{const Ks=await(await fetch(ke.url)).blob(),yn=(ke.url.split(".").pop()||"jpg").split(/[?#]/)[0],Yt=ke.name||`image-${dt+1}`;Se[Yt]=(Se[Yt]||0)+1;const is=Se[Yt]>1?`-${Se[Yt]}`:"";se.file(`${Yt}${is}.${yn}`,Ks)}catch(cr){console.warn("Failed to fetch image",ke.url,cr)}});await Promise.all(Ce);const Ne=await ie.generateAsync({type:"blob"}),ae=URL.createObjectURL(Ne),it=document.createElement("a");it.href=ae,it.download=$,it.click(),URL.revokeObjectURL(ae)}catch(q){console.error("Zip download failed",q),alert("Failed to create zip. Please try again.")}},Ur=(x,$)=>{const z=new Blob([JSON.stringify(x,null,2)],{type:"application/json"}),L=URL.createObjectURL(z),q=document.createElement("a");q.href=L,q.download=$,q.click(),URL.revokeObjectURL(L)},rs=x=>({title:x.title||"",authors:x.authors||"",publisher:x.publisher||"",demographic:x.demographic||"",genre:x.genre||"",subGenre:x.subGenre||"",date:x.date||"",pageCount:x.pageCount??"",cover:x.cover||"",amountPaid:x.amountPaid??"",read:!!x.read,rating:x.rating??"",dateRead:x.dateRead||"",datePurchased:x.datePurchased||"",msrp:x.msrp??"",collectiblePrice:x.collectiblePrice??"",specialType:x.specialType||"",specialVolumes:x.specialVolumes??"",isbn:x.isbn||"",amazonURL:x.amazonURL||"",hidden:!!x.hidden}),gn=x=>{const z=At(x.title||"").name;if(!z)return"";const q=[...w,...I].find(ie=>{const Se=At(ie.title||"").name===z,Ce=ie.msrp!==void 0&&ie.msrp!==null&&ie.msrp!=="";return Se&&Ce});return q?q.msrp:""},Hs=x=>{const z=At(x.title||"").name;if(!z)return{demographic:"",genre:"",subGenre:""};const q=[...w,...I].find(ie=>At(ie.title||"").name===z&&(ie.demographic||ie.genre||ie.subGenre));return{demographic:(q==null?void 0:q.demographic)||"",genre:(q==null?void 0:q.genre)||"",subGenre:(q==null?void 0:q.subGenre)||""}},qs=async x=>{if(!s||!(x!=null&&x.id))return;const $=x.kind==="wishlist"?"wishlist":"library",z=$==="library"?"wishlist":"library";try{const L=rs(x);if(z==="library"){const q=gn(x);(L.msrp===""||L.msrp===null||L.msrp===void 0)&&(L.msrp=q);const ie=Hs(x);L.demographic||(L.demographic=ie.demographic),L.genre||(L.genre=ie.genre),L.subGenre||(L.subGenre=ie.subGenre)}await To(ir(lt,z),L),await Eo(Lt(lt,$,x.id)),await Promise.all([St(),jt()]),Rt(q=>q&&{...q,volumes:q.volumes.filter(ie=>ie.id!==x.id)}),Mn()}catch(L){console.error("Move failed",L),alert("Failed to move item.")}},ut=Ae.list==="wishlist",ss=W.items[W.index]||null,An=(ss==null?void 0:ss.kind)==="wishlist";return c.jsxs("div",{className:"manga-page",children:[c.jsxs("header",{className:"manga-header",style:{flexDirection:"column",alignItems:"center",textAlign:"center"},children:[c.jsx("div",{className:"manga-header-title",style:{justifyContent:"center",gap:"0.6rem",fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Tyler's Manga Library"}),c.jsx("div",{className:"manga-header-sub",style:{textAlign:"center"},children:"This is my Manga Library and Wishlist. Check and see all the Manga I have in my possession!"})]}),kt&&c.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"6px"},children:c.jsx("button",{className:"suggestion-trigger",type:"button",onClick:()=>{vt(""),_e(!0)},children:"+ Suggestion"})}),c.jsxs("div",{className:"manga-tabs",children:[c.jsx("button",{className:"manga-tab-btn"+(l==="library"?" active":""),onClick:()=>{d("library"),b(!1),$e(new Set)},children:"Library"}),c.jsx("button",{className:"manga-tab-btn"+(l==="wishlist"?" active":""),onClick:()=>{d("wishlist"),b(!1),$e(new Set)},children:"Wishlist"})]}),l!=="dashboard"&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"manga-toolbar",children:[c.jsxs("div",{className:"manga-toolbar-left",children:[c.jsx("input",{type:"text",className:"manga-search-input",placeholder:l==="library"?"Search library by title, author, ISBN...":"Search wishlist...",value:l==="library"?P:O,onChange:x=>l==="library"?R(x.target.value):B(x.target.value)}),c.jsx("div",{className:"manga-counter",children:(()=>{const x=l==="library",$=(x?P:O).trim(),z=x?w.length:I.length,L=x?on.length:ln.length;return $?`${L} / ${z} Volumes`:`${z} Volumes`})()})]}),c.jsxs("div",{className:"manga-toolbar-right",children:[c.jsxs("div",{className:"manga-view-toggle",children:[c.jsx("button",{className:"manga-btn secondary"+(f==="series"?" active":""),type:"button","aria-pressed":f==="series","aria-label":"Series view",title:"Series View",onClick:()=>Xt("series"),children:""}),c.jsx("button",{className:"manga-btn secondary"+(f==="individual"?" active":""),type:"button","aria-pressed":f==="individual","aria-label":"Volume view",title:"Volume View",onClick:()=>Xt("individual"),children:""})]}),s&&c.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>we(x=>!x),children:xe?"Hide Hidden":"Show Hidden"}),s&&c.jsx("button",{className:"manga-btn secondary"+(D?" active":""),disabled:f==="series",onClick:$t,children:D?"Exit Multi-select":"Multi-select"})]})]}),s&&D&&f==="individual"&&c.jsxs("div",{className:"manga-multiselect-bar",children:[c.jsxs("span",{children:["Selected: ",c.jsx("strong",{children:he.size})]}),c.jsx("button",{className:"manga-btn",onClick:Ws,children:"Bulk Edit"}),c.jsxs("button",{className:"manga-btn secondary",onClick:()=>lr("move"),children:["Move to ",l==="library"?"Wishlist":"Library"]}),l==="library"&&c.jsxs(c.Fragment,{children:[c.jsx("button",{className:"manga-btn",onClick:()=>lr("markRead"),children:"Mark Read"}),c.jsx("button",{className:"manga-btn secondary",onClick:()=>lr("markUnread"),children:"Mark Unread"})]}),c.jsx("button",{className:"manga-btn danger",onClick:()=>lr("delete"),children:"Delete"})]})]}),Ee?c.jsx("div",{className:"manga-empty-state",children:"Loading manga from Firestore..."}):Re?c.jsx("div",{className:"manga-empty-state",children:Re}):cn.length===0?c.jsx("div",{className:"manga-empty-state",children:"No manga found. Try changing your search."}):c.jsx("div",{className:"manga-grid",children:cn.map(x=>f==="series"?Es(x):Nn(x))}),Je&&c.jsx("div",{className:"manga-modal-backdrop visible",onClick:x=>{x.target===x.currentTarget&&Zr()},children:c.jsx("div",{className:"manga-modal series",children:c.jsxs("div",{className:"manga-modal-body",children:[c.jsxs("div",{className:"manga-modal-header",children:[c.jsx("div",{className:"manga-modal-title",children:Je.series.title||"Series"}),c.jsx("button",{className:"manga-modal-close",onClick:Zr,type:"button","aria-label":"Close",children:"X"})]}),c.jsxs("div",{className:"manga-modal-subtitle",children:[Je.series.count," volume",Je.series.count===1?"":"s"," in this series"]}),s&&c.jsxs("div",{className:"series-bulk-controls",children:[c.jsx("button",{type:"button",className:"manga-btn mini secondary"+(D?" active":""),onClick:()=>Ot(Je.volumes),children:D?"Exit Multi-select":"Multi-select"}),D&&c.jsxs(c.Fragment,{children:[c.jsx("button",{type:"button",className:"manga-btn mini secondary",onClick:()=>{const x=Je.volumes.map($=>$.id);$e(new Set(x))},children:"Select All"}),c.jsx("button",{type:"button",className:"manga-btn mini secondary",onClick:()=>{$e(new Set)},children:"Clear"}),l==="wishlist"?c.jsx("button",{type:"button",className:"manga-btn mini",disabled:!he.size,onClick:()=>{he.size&&lr("move","library")},children:"Move to Library"}):c.jsx("button",{type:"button",className:"manga-btn mini",disabled:!he.size,onClick:()=>{he.size&&lr("move","wishlist")},children:"Move to Wishlist"}),c.jsxs("button",{type:"button",className:"manga-btn mini",disabled:!he.size,onClick:()=>{if(!he.size)return;const x=new Set(Je.volumes.map($=>$.id));$e($=>new Set([...$].filter(z=>x.has(z)))),Ws()},children:["Bulk Edit Selected (",he.size||0,")"]})]})]}),c.jsx("div",{className:"manga-series-modal-grid",children:Je.volumes.map(x=>c.jsxs("div",{className:"manga-card mini-card"+(x.read?" read":"")+(s&&yu(x)?" missing-page":"")+(s&&go(x).any?" missing-meta":""),onClick:()=>{if(!s){Cn(x);return}if(D){On(x.id);return}Cn(x)},children:[c.jsxs("div",{className:"manga-card-cover-wrap",children:[D&&s&&c.jsx("div",{className:"mini-select-indicator"+(he.has(x.id)?" selected":""),children:he.has(x.id)?"X":""}),c.jsx("img",{src:x.cover||"https://imgur.com/chUgq4W.png",alt:x.title||"Cover",loading:"lazy",decoding:"async"})]}),c.jsxs("div",{className:"manga-card-body",children:[c.jsx("div",{className:"manga-card-title",children:x.title||"Untitled"}),c.jsxs("div",{className:"manga-card-meta",children:[c.jsx("span",{className:go(x).authorMissing?"missing-field":"",children:x.authors&&x.authors!=="Unknown"?x.authors:"Missing author"}),c.jsx("br",{}),c.jsx("span",{className:go(x).publisherMissing?"missing-field":"",children:x.publisher&&x.publisher!=="Unknown"?x.publisher:"Missing publisher"}),c.jsx("br",{}),c.jsx("span",{className:go(x).dateMissing?"missing-field":"",children:x.date&&x.date!=="Unknown"?x.date:"Missing date"})]}),x.isbn&&c.jsxs("div",{className:"manga-card-isbn",children:["ISBN: ",x.isbn]})]})]},x.id))})]})})}),s&&c.jsxs("div",{className:"manga-floating-actions",children:[c.jsxs("button",{className:"manga-btn",type:"button","aria-label":"Add item",onClick:()=>es(l==="wishlist"?"wishlist":"library"),children:["+ ",l==="wishlist"?"Wishlist":"Library"]}),c.jsxs("div",{className:"manga-export-actions",children:[n&&c.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>Ur({library:w,wishlist:I},"manga-library-wishlist.json"),children:"Export JSON"}),c.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>Rr(l==="library"?w:I,l==="library"?"manga-library.csv":"manga-wishlist.csv"),children:"Export CSV"}),c.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>Gs(l==="library"?w:I,l==="library"?"manga-library-images.zip":"manga-wishlist-images.zip"),children:"Download Images"})]})]}),ue&&c.jsx("div",{className:"manga-modal-backdrop visible",onClick:x=>{x.target===x.currentTarget&&Mn()},children:c.jsxs("div",{className:"manga-modal",children:[c.jsxs("div",{className:"manga-modal-cover-wrap",children:[ue.kind==="library"&&ue.read&&c.jsx("div",{className:"manga-modal-read-pill",children:"Read"}),c.jsx("img",{src:ue.cover||"https://imgur.com/chUgq4W.png",alt:"Cover"})]}),c.jsxs("div",{className:"manga-modal-body",children:[c.jsxs("div",{className:"manga-modal-header",children:[c.jsx("div",{className:"manga-modal-title",children:ue.title||"Untitled"}),c.jsx("button",{className:"manga-modal-close",onClick:Mn,type:"button","aria-label":"Close",children:"X"})]}),c.jsxs("div",{className:"manga-modal-meta",children:[ue.authors&&ue.authors!=="Unknown"&&c.jsxs(c.Fragment,{children:[c.jsx("strong",{children:"Author(s):"})," ",ue.authors,c.jsx("br",{})]}),ue.publisher&&ue.publisher!=="Unknown"&&c.jsxs(c.Fragment,{children:[c.jsx("strong",{children:"Publisher:"})," ",ue.publisher,c.jsx("br",{})]}),ue.date&&c.jsxs(c.Fragment,{children:[c.jsx("strong",{children:"Release:"})," ",ue.date,c.jsx("br",{})]}),ue.isbn&&c.jsxs(c.Fragment,{children:[c.jsx("strong",{children:"ISBN:"})," ",ue.isbn,c.jsx("br",{})]})]}),c.jsxs("div",{className:"manga-modal-details",children:[ue.pageCount&&c.jsxs(c.Fragment,{children:[c.jsx("strong",{children:"Pages:"})," ",ue.pageCount,c.jsx("br",{})]}),c.jsxs("div",{style:{margin:"6px 0"},children:[c.jsx("strong",{children:"Rating:"})," ",c.jsx(Ts,{value:ue.rating||"",onChange:x=>$s(ue,x)})]}),ue.amountPaid&&c.jsxs(c.Fragment,{children:[c.jsx("strong",{children:"Amount Paid:"})," $",ue.amountPaid,c.jsx("br",{})]}),ue.msrp&&c.jsxs(c.Fragment,{children:[c.jsx("strong",{children:"MSRP:"})," $",ue.msrp,c.jsx("br",{})]}),ue.collectiblePrice&&c.jsxs(c.Fragment,{children:[c.jsx("strong",{children:"Collectible:"})," $",ue.collectiblePrice,c.jsx("br",{})]}),ue.read&&ue.dateRead&&c.jsxs(c.Fragment,{children:[c.jsx("strong",{children:"Date Read:"})," ",ue.dateRead,c.jsx("br",{})]}),ue.amazonURL&&c.jsx("div",{style:{marginTop:"6px"},children:c.jsx("a",{href:ue.amazonURL,target:"_blank",rel:"noreferrer",children:"View on Amazon"})})]}),c.jsxs("div",{className:"manga-modal-footer",style:{gap:"10px",alignItems:"center"},children:[c.jsx("div",{children:ue.kind==="library"&&ue.read?"Marked as read in your library.":ue.kind==="library"?"In your library (unread).":"Wishlist item - not in library yet."}),c.jsxs("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:[s&&c.jsx("button",{className:"manga-btn mini secondary",type:"button",onClick:()=>ws(ue),children:"Edit"}),ue.kind==="library"&&c.jsx(c.Fragment,{children:ue.read?c.jsx("button",{className:"manga-btn mini secondary",disabled:br,onClick:()=>mr(ue,!1),type:"button",children:"Mark as unread"}):c.jsx("button",{className:"manga-btn mini",disabled:br,onClick:()=>mr(ue,!0),type:"button",children:"Mark as read"})}),s&&c.jsxs("button",{className:"manga-btn mini",type:"button",onClick:()=>qs(ue),children:["Move to ",ue.kind==="library"?"Wishlist":"Library"]}),s&&c.jsx("button",{className:"manga-btn mini danger",type:"button",onClick:()=>Qn(ue.id,ue.kind==="library"?"library":"wishlist"),children:"Delete"})]})]})]})]})}),s&&Ae.open&&c.jsx("div",{className:"manga-modal-backdrop visible",onClick:x=>{x.target===x.currentTarget&&In()},children:c.jsx("div",{className:"manga-modal admin",children:c.jsxs("div",{className:"manga-modal-body",children:[c.jsxs("div",{className:"manga-modal-header",children:[c.jsx("div",{className:"manga-modal-title",children:Ae.mode==="add"?"Add Entry":"Edit Entry"}),c.jsx("button",{className:"manga-modal-close",onClick:In,type:"button","aria-label":"Close",children:"X"})]}),c.jsxs("div",{className:"admin-form-layout",children:[c.jsx("div",{className:"admin-cover-frame",children:c.jsx("img",{src:Ae.data.cover||"https://imgur.com/chUgq4W.png",alt:"Cover preview"})}),c.jsxs("div",{className:"admin-form-fields",children:[c.jsx("div",{className:"admin-row",children:c.jsxs("label",{children:["Title",c.jsx("input",{type:"text",value:Ae.data.title,onChange:x=>It("title",x.target.value)})]})}),M.length>0&&c.jsx("div",{className:"title-suggestions",children:M.map((x,$)=>c.jsx("button",{type:"button",className:"manga-btn mini",onClick:()=>It("title",x),children:x},x+$))}),c.jsxs("div",{className:"admin-row two",style:{alignItems:"flex-end",marginTop:"-8px"},children:[c.jsxs("div",{children:[c.jsxs("div",{className:"manga-modal-subtitle",style:{marginBottom:"6px"},children:["Entry ",be+1," / ",Math.max(1,me.length||1)]}),c.jsxs("div",{style:{display:"flex",gap:"8px"},children:[c.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>be>0&&pr(be-1),disabled:be===0,children:"Previous"}),c.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>me.length&&be<me.length-1?pr(be+1):null,disabled:!me.length||be===me.length-1,children:"Next"})]})]}),c.jsxs("div",{style:{textAlign:"right"},children:[c.jsx("button",{className:"manga-btn",type:"button",onClick:xs,disabled:!At(Ae.data.title||"").vol,children:"Add New Volume"}),c.jsx("div",{className:"manga-stat-sub",style:{marginTop:"4px"},children:"Auto-fills the next volume number for this series."})]})]}),c.jsx("div",{className:"admin-row",children:c.jsxs("label",{className:N.author?"missing-field-input":"",children:["Authors",c.jsx("input",{type:"text",value:Ae.data.authors,onChange:x=>It("authors",x.target.value)})]})}),c.jsx("div",{className:"admin-row",children:c.jsxs("label",{className:N.publisher?"missing-field-input":"",children:["Publisher",c.jsx("input",{type:"text",value:Ae.data.publisher,onChange:x=>It("publisher",x.target.value)})]})}),c.jsxs("div",{className:"admin-row three",children:[c.jsxs("label",{className:N.date?"missing-field-input":"",children:["Release Date",c.jsx("input",{type:"date",value:Ae.data.date,onChange:x=>It("date",x.target.value)})]}),c.jsxs("label",{children:["Purchase Date",c.jsx("input",{type:"date",value:Ae.data.datePurchased,onChange:x=>It("datePurchased",x.target.value)})]}),!ut&&c.jsxs("label",{children:["Date Read",c.jsx("input",{type:"date",value:Ae.data.dateRead,onChange:x=>It("dateRead",x.target.value)})]})]}),c.jsxs("div",{className:"admin-row two",children:[c.jsxs("label",{className:N.page?"missing-field-input":"",children:["Page Count",c.jsx("input",{type:"number",placeholder:"e.g. 192",value:Ae.data.pageCount,onChange:x=>It("pageCount",x.target.value)})]}),!ut&&c.jsxs("label",{children:["ISBN (library only)",c.jsx("input",{type:"text",value:Ae.data.isbn,onChange:x=>It("isbn",x.target.value)})]})]}),c.jsx("div",{className:"admin-row",children:c.jsxs("label",{children:["Cover URL",c.jsx("input",{type:"text",placeholder:"Paste image URL here",value:Ae.data.cover,onChange:x=>It("cover",x.target.value)})]})}),!ut&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"admin-row two",children:[!(Ae.data.special&&Ae.data.specialType==="collectible")&&c.jsxs("label",{children:["Amount Paid",c.jsx("input",{type:"number",step:"0.01",value:Ae.data.amountPaid,onChange:x=>It("amountPaid",x.target.value)})]}),c.jsxs("label",{children:["MSRP",c.jsx("input",{type:"number",step:"0.01",value:Ae.data.msrp,onChange:x=>It("msrp",x.target.value)})]})]}),c.jsx("div",{className:"admin-row",children:c.jsxs("label",{className:"checkbox-row",children:[c.jsx("input",{type:"checkbox",checked:!!Ae.data.special,onChange:x=>It("special",x.target.checked,"checkbox")}),c.jsx("span",{children:"Special item?"})]})}),Ae.data.special&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"admin-row two",children:[c.jsxs("label",{children:["Special Type",c.jsxs("select",{value:Ae.data.specialType,onChange:x=>It("specialType",x.target.value),children:[c.jsx("option",{value:"",children:"Select type"}),c.jsx("option",{value:"specialEdition",children:"Special Edition"}),c.jsx("option",{value:"collectible",children:"Collectible"})]})]}),Ae.data.specialType==="collectible"&&c.jsxs("label",{children:["Collectible Price",c.jsx("input",{type:"number",step:"0.01",value:Ae.data.collectiblePrice,onChange:x=>It("collectiblePrice",x.target.value)})]})]}),Ae.data.specialType==="specialEdition"&&c.jsx("div",{className:"admin-row",children:c.jsxs("label",{children:["Special Volumes",c.jsx("input",{type:"number",min:"0",value:Ae.data.specialVolumes,onChange:x=>It("specialVolumes",x.target.value)})]})})]})]}),ut&&c.jsx("div",{className:"admin-row",children:c.jsxs("label",{children:["Amazon URL",c.jsx("input",{type:"text",value:Ae.data.amazonURL,onChange:x=>It("amazonURL",x.target.value)})]})}),!ut&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"admin-row",children:c.jsxs("label",{children:["Rating (1-5 stars)",c.jsx(Ts,{value:Ae.data.rating,onChange:x=>It("rating",x)})]})}),c.jsxs("div",{className:"admin-row two",children:[c.jsxs("label",{className:"checkbox-inline",children:[c.jsx("input",{type:"checkbox",checked:Ae.data.read,onChange:x=>It("read",x.target.checked,"checkbox")}),c.jsx("span",{children:"Mark as read"})]}),c.jsxs("label",{className:"checkbox-inline",children:[c.jsx("input",{type:"checkbox",checked:!!Ae.data.hidden,onChange:x=>It("hidden",x.target.checked,"checkbox")}),c.jsx("span",{children:"Hide from public"})]})]})]}),ut&&c.jsx("div",{className:"admin-row",children:c.jsxs("label",{className:"checkbox-inline",children:[c.jsx("input",{type:"checkbox",checked:!!Ae.data.hidden,onChange:x=>It("hidden",x.target.checked,"checkbox")}),c.jsx("span",{children:"Hide from public"})]})})]})]}),c.jsxs("div",{className:"manga-modal-footer",style:{justifyContent:"flex-end",gap:"10px"},children:[c.jsx("button",{className:"manga-btn secondary",onClick:In,type:"button",children:"Cancel"}),c.jsx("button",{className:"manga-btn",onClick:Kn,type:"button",children:Ae.mode==="add"?"Add":"Save"})]})]})})}),s&&W.open&&c.jsx("div",{className:"manga-modal-backdrop visible",onClick:x=>{x.target===x.currentTarget&&Pr()},children:c.jsx("div",{className:"manga-modal admin",children:c.jsxs("div",{className:"manga-modal-body",children:[c.jsxs("div",{className:"manga-modal-header",children:[c.jsxs("div",{className:"manga-modal-title",children:["Bulk Edit (",W.index+1," / ",W.items.length,")"]}),c.jsx("button",{className:"manga-modal-close",onClick:Pr,type:"button","aria-label":"Close",children:"X"})]}),W.items.length>0&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"manga-modal-subtitle",children:["Editing: ",W.items[W.index].data.title||"Untitled"]}),c.jsxs("div",{className:"admin-form-grid two-col",children:[c.jsx("div",{className:"admin-cover",children:c.jsx("div",{className:"manga-card-cover-wrap",children:c.jsx("img",{src:W.items[W.index].data.cover||"https://imgur.com/chUgq4W.png",alt:W.items[W.index].data.title||"Cover",loading:"lazy",decoding:"async"})})}),c.jsxs("div",{className:"admin-fields",children:[c.jsxs("div",{className:"admin-row two",children:[c.jsxs("label",{className:"full",children:["Title",c.jsx("input",{type:"text",value:W.items[W.index].data.title,onChange:x=>tt("title",x.target.value)})]}),c.jsxs("div",{className:"admin-entry-info",children:["Entry ",W.index+1," / ",W.items.length]})]}),c.jsx("div",{className:"admin-row",children:c.jsxs("label",{children:["Authors",c.jsx("input",{type:"text",value:W.items[W.index].data.authors,onChange:x=>tt("authors",x.target.value)})]})}),c.jsx("div",{className:"admin-row",children:c.jsxs("label",{children:["Publisher",c.jsx("input",{type:"text",value:W.items[W.index].data.publisher,onChange:x=>tt("publisher",x.target.value)})]})}),c.jsxs("div",{className:"admin-row three",children:[c.jsxs("label",{children:["Release Date",c.jsx("input",{type:"date",value:W.items[W.index].data.date,onChange:x=>tt("date",x.target.value)})]}),c.jsxs("label",{children:["Purchase Date",c.jsx("input",{type:"date",value:W.items[W.index].data.datePurchased,onChange:x=>tt("datePurchased",x.target.value)})]}),!An&&c.jsxs("label",{children:["Date Read",c.jsx("input",{type:"date",value:W.items[W.index].data.dateRead,onChange:x=>tt("dateRead",x.target.value)})]})]}),c.jsxs("div",{className:"admin-row two",children:[c.jsxs("label",{children:["Page Count",c.jsx("input",{type:"number",value:W.items[W.index].data.pageCount,onChange:x=>tt("pageCount",x.target.value)})]}),!An&&c.jsxs("label",{children:["ISBN (library only)",c.jsx("input",{type:"text",value:W.items[W.index].data.isbn,onChange:x=>tt("isbn",x.target.value)})]})]}),c.jsx("div",{className:"admin-row",children:c.jsxs("label",{children:["Cover URL",c.jsx("input",{type:"text",value:W.items[W.index].data.cover,onChange:x=>tt("cover",x.target.value)})]})}),!An&&c.jsxs("div",{className:"admin-row two",children:[c.jsxs("label",{children:["Amount Paid",c.jsx("input",{type:"number",step:"0.01",value:W.items[W.index].data.amountPaid,onChange:x=>tt("amountPaid",x.target.value)})]}),c.jsxs("label",{children:["MSRP",c.jsx("input",{type:"number",step:"0.01",value:W.items[W.index].data.msrp,onChange:x=>tt("msrp",x.target.value)})]})]}),!An&&c.jsx("div",{className:"admin-row two",children:c.jsxs("div",{children:[c.jsx("div",{className:"star-label",children:"Rating (1-5 stars)"}),c.jsx(Ts,{value:W.items[W.index].data.rating,onChange:x=>tt("rating",x)})]})}),!An&&c.jsxs("div",{className:"admin-row two",children:[c.jsxs("label",{className:"checkbox-row",children:[c.jsx("input",{type:"checkbox",checked:!!W.items[W.index].data.special,onChange:x=>tt("special",x.target.checked,"checkbox")}),c.jsx("span",{children:"Special item?"})]}),c.jsxs("label",{className:"checkbox-row",children:[c.jsx("input",{type:"checkbox",checked:W.items[W.index].data.read,onChange:x=>tt("read",x.target.checked,"checkbox")}),c.jsx("span",{children:"Mark as read"})]})]}),W.items[W.index].data.special&&!An&&c.jsxs("div",{className:"admin-row two",children:[c.jsxs("label",{children:["Special Type",c.jsxs("select",{value:W.items[W.index].data.specialType,onChange:x=>tt("specialType",x.target.value),children:[c.jsx("option",{value:"",children:"Select type"}),c.jsx("option",{value:"specialEdition",children:"Special Edition"}),c.jsx("option",{value:"collectible",children:"Collectible"})]})]}),W.items[W.index].data.specialType==="specialEdition"&&c.jsxs("label",{children:["Special Volumes",c.jsx("input",{type:"number",value:W.items[W.index].data.specialVolumes,onChange:x=>tt("specialVolumes",x.target.value)})]}),W.items[W.index].data.specialType==="collectible"&&c.jsxs("label",{children:["Collectible Price",c.jsx("input",{type:"number",step:"0.01",value:W.items[W.index].data.collectiblePrice,onChange:x=>tt("collectiblePrice",x.target.value)})]})]}),c.jsxs("div",{className:"admin-row two",children:[c.jsxs("label",{children:["Amazon URL",c.jsx("input",{type:"text",value:W.items[W.index].data.amazonURL,onChange:x=>tt("amazonURL",x.target.value)})]}),c.jsxs("label",{className:"checkbox-row",children:[c.jsx("input",{type:"checkbox",checked:!!W.items[W.index].data.hidden,onChange:x=>tt("hidden",x.target.checked,"checkbox")}),c.jsx("span",{children:"Hidden from public"})]})]})]})]}),c.jsxs("div",{className:"manga-modal-footer",style:{justifyContent:"space-between",gap:"10px"},children:[c.jsxs("div",{children:[c.jsx("button",{className:"manga-btn secondary",onClick:Pn,type:"button",disabled:W.index===0,children:"Previous"}),c.jsx("button",{className:"manga-btn secondary",onClick:Jn,type:"button",disabled:W.index===W.items.length-1,style:{marginLeft:"6px"},children:"Next"})]}),c.jsxs("div",{style:{display:"flex",gap:"8px"},children:[c.jsx("button",{className:"manga-btn secondary",onClick:Pr,type:"button",children:"Cancel"}),c.jsx("button",{className:"manga-btn",onClick:ts,type:"button",children:"Save Edits"})]})]})]})]})})}),kt&&c.jsx(Gw,{open:Te,title:"Suggest a Manga",placeholder:"Type a manga you'd like me to collect/read...",value:Le,status:rt,loading:fe,onChange:qe,onSubmit:v,onClose:()=>_e(!1)}),c.jsx("datalist",{id:"adminTitleSuggestions",children:Z.map(x=>c.jsx("option",{value:x},x))})]})}const OR="https://imokmalworker.imokissick.workers.dev/?url=",Kw="im_ok",Yv=300,MR={1:"watching",2:"completed",3:"on_hold",4:"dropped",6:"plan_to_watch"};function FR(n){const e=n==null?void 0:n.title_localized,t=typeof e=="string"?e:(e==null?void 0:e.en)||(e==null?void 0:e.english);return(n==null?void 0:n.anime_title_eng)||(n==null?void 0:n.title_english)||t||(n==null?void 0:n.anime_title)||(n==null?void 0:n.title)||"Untitled"}function UR(n){const e=(n==null?void 0:n.updated_at)??(n==null?void 0:n.updatedAt)??(n==null?void 0:n.updated_at_ms)??null;if(e==null)return null;const t=Number(e);if(Number.isFinite(t))return t<1e12?t*1e3:t;const s=Date.parse(e);return Number.isNaN(s)?null:s}function zR(n){const e=MR[n.status]||(typeof n.status=="string"?n.status.toLowerCase():"unknown");return{id:n.anime_id||n.id,title:FR(n),updatedAt:UR(n),episodes:n.anime_num_episodes??n.episodes??null,watchedEpisodes:n.num_watched_episodes??n.my_watched_episodes??n.watched_episodes??n.num_watched??0,status:e,score:n.score??null,image:n.anime_image_path||n.image_url||n.anime_img||n.picture||null,synopsis:n.anime_synopsis||n.synopsis||null}}function Jv(){const n=Date.now();return[{id:1,title:"Cowboy Bebop",episodes:26,status:"completed",score:10,updatedAt:n-1e3*60*60*24*3,synopsis:"In 2071, bounty hunters Spike and Jet roam the solar system looking for their next payout and a place to belong."},{id:2,title:"Fullmetal Alchemist: Brotherhood",episodes:64,status:"completed",score:10,updatedAt:n-1e3*60*60*24*6,synopsis:"Brothers Edward and Alphonse Elric search for the Philosopher's Stone to restore their bodies after a failed alchemy ritual."},{id:3,title:"Frieren: Beyond Journey's End",episodes:28,status:"watching",score:9,updatedAt:n-1e3*60*60*8,synopsis:"An elven mage retraces the steps of a past adventure to understand humanity and the passage of time."},{id:4,title:"One Piece",episodes:1e3,status:"on_hold",score:8,updatedAt:n-1e3*60*60*24*14,synopsis:"Monkey D. Luffy sails toward the Grand Line seeking the One Piece and a crew to make his dream real."},{id:5,title:"Kaiju No. 8",episodes:12,status:"plan_to_watch",score:null,updatedAt:n-1e3*60*30,synopsis:"A middle-aged worker gains kaiju powers and joins the Defense Force to fight monsters from the inside."}]}async function BR(n,e){const t=`https://myanimelist.net/animelist/${n}/load.json?status=7&offset=${e}`,s=await fetch(`${OR}${encodeURIComponent(t)}`);if(!s.ok)throw new Error(`Failed to fetch MAL list (offset ${e})`);return s.json()}async function $R(n=Kw){const e=[];try{let t=0;for(;;){const s=await BR(n,t);if(!Array.isArray(s)||s.length===0||(e.push(...s),s.length<Yv))break;t+=Yv}}catch(t){return console.error("Failed to load MAL list; falling back to sample data.",t),Jv()}return e.length?e.map(zR):Jv()}async function WR(n){var e,t;if(!n)return null;try{const s=await fetch(`https://api.jikan.moe/v4/anime/${n}`);if(!s.ok)throw new Error(`Failed to fetch Jikan summary for id ${n}`);const a=await s.json();return((e=a==null?void 0:a.data)==null?void 0:e.synopsis)||((t=a==null?void 0:a.data)==null?void 0:t.background)||null}catch(s){return console.error("Failed to load anime synopsis",n,s),null}}async function GR(n=Kw){var e;if(!n)return null;try{const t=await fetch(`https://api.jikan.moe/v4/users/${encodeURIComponent(n)}/statistics`);if(!t.ok)throw new Error(`Failed to fetch user stats for ${n}`);const s=await t.json(),a=((e=s==null?void 0:s.data)==null?void 0:e.anime)||{},l=Number(a.days_watched),d=Number(a.total_episodes??a.episodes_watched);return{daysWatched:Number.isFinite(l)?l:null,episodesWatched:Number.isFinite(d)?d:null}}catch(t){return console.error("Failed to load user stats",n,t),null}}const Xv=5,HR=3600*1e3,Zv="animeSuggestionsSent";function qR(){const{admin:n,user:e,role:t}=Ho(),s=fe=>fe?fe.toString().replace(/_/g," ").replace(/\b\w/g,We=>We.toUpperCase()):"Unknown",[a,l]=k.useState([]),[d,f]=k.useState([]),[m,v]=k.useState(""),[w,S]=k.useState("all"),[I,U]=k.useState(!0),[Z,Q]=k.useState(""),[M,ne]=k.useState(null),[xe,we]=k.useState({}),[Ee,le]=k.useState(!1),[Re,A]=k.useState(!1),[P,R]=k.useState(null),[O,B]=k.useState(!1),[D,b]=k.useState(""),[he,$e]=k.useState(""),[Ae,He]=k.useState(!1);k.useEffect(()=>{document.title="Anime | Library"},[]),k.useEffect(()=>{$e("")},[e]);const me=fe=>{if(!fe)return"";const We=Date.now()-fe,ue=Math.max(We,0),Qe=Math.floor(ue/6e4);if(Qe<1)return"just now";if(Qe<60)return`${Qe}m ago`;const Je=Math.floor(Qe/60);if(Je<48)return`${Je}h ago`;const Rt=Math.floor(Je/24);if(Rt<14)return`${Rt}d ago`;const kt=Math.floor(Rt/7);return kt<8?`${kt}w ago`:`${Math.floor(Rt/30)}mo ago`},De=(fe,We="image")=>(fe||"").toString().toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"").slice(0,80)||We,be=async()=>{const fe=a.filter(We=>We.image).map((We,ue)=>({url:We.image,name:De(We.title||`anime-${ue+1}`,`anime-${ue+1}`)}));if(!fe.length){alert("No images found to download.");return}try{const We=(await cc(async()=>{const{default:jt}=await import("https://cdn.jsdelivr.net/npm/jszip@3.10.1/+esm");return{default:jt}},[])).default,ue=new We,Qe=ue.folder("images"),Je={};await Promise.all(fe.map(async(jt,on)=>{try{const ln=await(await fetch(jt.url)).blob(),fr=(jt.url.split(".").pop()||"jpg").split(/[?#]/)[0],Xt=jt.name||`image-${on+1}`;Je[Xt]=(Je[Xt]||0)+1;const qn=Je[Xt]>1?`-${Je[Xt]}`:"";Qe.file(`${Xt}${qn}.${fr}`,ln)}catch(Sn){console.warn("Failed to fetch image",jt.url,Sn)}}));const Rt=await ue.generateAsync({type:"blob"}),kt=URL.createObjectURL(Rt),St=document.createElement("a");St.href=kt,St.download="anime-images.zip",St.click(),URL.revokeObjectURL(kt)}catch(We){console.error("Zip download failed",We),alert("Failed to create zip. Please try again.")}};k.useEffect(()=>{async function fe(){try{const We=await $R();l(We),f(We)}catch(We){console.error(We),Q("Failed to load data from MAL.")}finally{U(!1)}}fe()},[]),k.useEffect(()=>{GR().then(fe=>{fe&&R(fe)}).catch(()=>{})},[]);const K=fe=>{switch((fe||"unknown").toLowerCase()){case"watching":return 0;case"completed":return 1;case"on_hold":return 2;case"plan_to_watch":return 3;case"dropped":return 4;default:return 5}},N=fe=>{const We=Number.isFinite(Number(fe.watchedEpisodes))?Number(fe.watchedEpisodes):0,ue=Number.isFinite(Number(fe.episodes))?Number(fe.episodes):null;return ue?`${Math.min(We,ue)}/${ue} eps`:We?`${We} eps`:"No progress"};k.useEffect(()=>{let fe=[...a];if(w!=="all"&&(fe=fe.filter(We=>(We.status||"").toLowerCase()===w)),m){const We=m.toLowerCase();fe=fe.filter(ue=>(ue.title||"").toLowerCase().includes(We))}fe.sort((We,ue)=>{const Qe=K(We.status),Je=K(ue.status);return Qe!==Je?Qe-Je:(We.title||"").localeCompare(ue.title||"")}),f(fe)},[a,w,m]);const W=k.useMemo(()=>[...a].filter(fe=>Number.isFinite(fe.updatedAt)).sort((fe,We)=>We.updatedAt-fe.updatedAt).slice(0,6),[a]),ee=!!e&&t==="viewer",Te=async()=>{const fe=Date.now(),ue=(()=>{try{const Qe=localStorage.getItem(Zv);return Array.isArray(JSON.parse(Qe))?JSON.parse(Qe):[]}catch{return[]}})().filter(Qe=>fe-Qe<HR);if(ue.length>=Xv){$e("Rate limit: please wait a bit (max 5 suggestions per hour).");return}if(!D.trim()){$e("Please enter a title or note before sending.");return}He(!0),$e("");try{const Qe=`**Anime Suggestion**
${D.trim()}
From: ${(e==null?void 0:e.displayName)||(e==null?void 0:e.email)||(e==null?void 0:e.uid)||"anonymous user"}`;await To(ir(lt,"suggestions"),{content:D.trim(),type:"anime",from:(e==null?void 0:e.displayName)||(e==null?void 0:e.email)||(e==null?void 0:e.uid)||"anonymous user",createdAt:new Date().toISOString()}),$e("Sent! I'll review your suggestion soon."),b("");const Je=[...ue,fe].slice(-Xv);localStorage.setItem(Zv,JSON.stringify(Je))}catch(Qe){console.error("Failed to send suggestion",Qe),$e("Failed to send suggestion. Please try again later.")}finally{He(!1)}};k.useEffect(()=>{if(!M){A(!1),le(!1);return}A(!!M.synopsis),le(!1)},[M==null?void 0:M.id]);const _e=k.useMemo(()=>{const fe=a.length,We=a.reduce((kt,St)=>{const jt=Number(St.watchedEpisodes);return Number.isFinite(jt)?kt+jt:kt},0),ue=We*.4,Qe=a.filter(kt=>Number.isFinite(kt.score)&&kt.score>0),Je=Qe.reduce((kt,St)=>kt+St.score,0),Rt={watching:0,completed:0,on_hold:0,dropped:0,plan_to_watch:0,unknown:0};return a.forEach(kt=>{const St=(kt.status||"unknown").toLowerCase();Rt[St]!=null?Rt[St]+=1:Rt.unknown+=1}),{total:fe,totalWatchedEpisodes:We,byStatus:Rt,avgScore:Qe.length?Je/Qe.length:0,totalHours:ue}},[a]),Le=(P==null?void 0:P.daysWatched)??(_e.totalHours||0)/24,qe=(P==null?void 0:P.episodesWatched)??_e.totalWatchedEpisodes,rt=fe=>{const We=fe.image||"https://imgur.com/chUgq4W.png",ue=Number.isFinite(Number(fe.watchedEpisodes))?Number(fe.watchedEpisodes):0,Qe=Number.isFinite(Number(fe.episodes))?Number(fe.episodes):null,Je=Qe?`Episode ${Math.min(ue,Qe)}/${Qe}`:`Episode ${ue}`,Rt=Number.isFinite(Number(fe.score))&&Number(fe.score)>0?fe.score:"Not rated";return c.jsxs("article",{className:"anime-card",onClick:()=>ne(fe.synopsis?fe:{...fe,synopsis:xe[fe.id]}),children:[c.jsxs("div",{className:"anime-cover-wrap",children:[c.jsx("img",{className:"anime-cover",src:We,alt:fe.title,loading:"lazy",decoding:"async"}),c.jsx("div",{className:`badge-status ${(fe.status||"unknown").toLowerCase()}`,children:s(fe.status)}),fe.score!=null&&c.jsx("div",{className:"badge-score",children:Rt})]}),c.jsxs("div",{className:"anime-meta",children:[c.jsx("div",{className:"anime-title",title:fe.title,children:fe.title}),c.jsx("div",{className:"anime-sub",children:fe.episodes?`${fe.episodes} episodes`:"Episodes: ?"}),c.jsx("div",{className:"anime-progress",children:Je}),c.jsxs("div",{className:"anime-progress",children:["Status: ",s(fe.status)]})]})]},fe.id||fe.title)},vt=fe=>c.jsxs("article",{className:"anime-update-card",children:[c.jsx("div",{className:"anime-update-title",title:fe.title,children:fe.title}),c.jsxs("div",{className:"anime-update-meta",children:[c.jsx("span",{className:"anime-update-progress",children:N(fe)}),c.jsx("span",{className:"anime-update-dot","aria-hidden":"true",children:""}),c.jsx("span",{className:"anime-update-status",children:s(fe.status)})]}),c.jsx("div",{className:"anime-update-time",children:me(fe.updatedAt)})]},`update-${fe.id||fe.title}`);return c.jsxs("main",{className:"anime-page",children:[c.jsxs("div",{className:"anime-content",children:[c.jsxs("header",{className:"anime-header",style:{position:"relative",display:"flex",justifyContent:"center",alignItems:"center",textAlign:"center",width:"100%"},children:[c.jsxs("div",{style:{textAlign:"center",margin:"0 auto",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"0 60px"},children:[c.jsx("h1",{className:"anime-title",style:{margin:0,fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Tyler's Anime Library"}),c.jsx("p",{className:"anime-sub",style:{textAlign:"center",margin:"6px 0 0"},children:"The Anime I've watched/watching synced directly from MAL (MyAnimeList)"})]}),(ee||n)&&c.jsxs("div",{style:{position:"absolute",right:0,top:"50%",transform:"translateY(-50%)",display:"flex",gap:"10px"},children:[ee&&c.jsx("button",{className:"suggestion-trigger",type:"button",onClick:()=>{$e(""),B(!0)},children:"+ Suggestion"}),n&&c.jsx("button",{className:"stat-link",type:"button",onClick:be,children:"Download Images"})]})]}),c.jsxs("div",{className:"anime-stats",children:[c.jsxs("div",{className:"anime-stat-card",children:[c.jsx("div",{className:"anime-stat-label",children:"Total Entries"}),c.jsx("div",{className:"anime-stat-value",children:_e.total})]}),c.jsxs("div",{className:"anime-stat-card",children:[c.jsx("div",{className:"anime-stat-label",children:"Episodes Watched"}),c.jsx("div",{className:"anime-stat-value",children:qe})]}),c.jsxs("div",{className:"anime-stat-card",children:[c.jsx("div",{className:"anime-stat-label",children:"Watching"}),c.jsx("div",{className:"anime-stat-value",children:_e.byStatus.watching})]}),c.jsxs("div",{className:"anime-stat-card",children:[c.jsx("div",{className:"anime-stat-label",children:"Completed"}),c.jsx("div",{className:"anime-stat-value",children:_e.byStatus.completed})]}),c.jsxs("div",{className:"anime-stat-card",children:[c.jsx("div",{className:"anime-stat-label",children:"Plan to Watch"}),c.jsx("div",{className:"anime-stat-value",children:_e.byStatus.plan_to_watch})]}),c.jsxs("div",{className:"anime-stat-card",children:[c.jsx("div",{className:"anime-stat-label",children:"Avg. Score"}),c.jsx("div",{className:"anime-stat-value",children:_e.avgScore?_e.avgScore.toFixed(1):"0.0"})]}),c.jsxs("div",{className:"anime-stat-card",children:[c.jsx("div",{className:"anime-stat-label",children:"Days Watched"}),c.jsx("div",{className:"anime-stat-value",children:Le.toFixed(1)})]})]}),c.jsxs("section",{className:"anime-toolbar",children:[c.jsx("input",{type:"text",placeholder:"Search anime by title...",value:m,onChange:fe=>v(fe.target.value),className:"anime-input"}),c.jsxs("select",{value:w,onChange:fe=>S(fe.target.value),className:"anime-select",children:[c.jsx("option",{value:"all",children:"All statuses"}),c.jsx("option",{value:"watching",children:"Watching"}),c.jsx("option",{value:"completed",children:"Completed"}),c.jsx("option",{value:"on_hold",children:"On Hold"}),c.jsx("option",{value:"plan_to_watch",children:"Plan to Watch"}),c.jsx("option",{value:"dropped",children:"Dropped"})]})]}),I&&c.jsx("div",{className:"loading",children:"Loading anime list from MAL..."}),Z&&c.jsx("div",{className:"error-state",children:Z}),!I&&!Z&&c.jsx(c.Fragment,{children:d.length===0?c.jsx("div",{className:"empty-state",children:"No results match your filters yet."}):c.jsx("section",{className:"anime-grid",children:d.map(fe=>rt(fe))})})]}),W.length>0&&c.jsxs("aside",{className:"anime-updates-float",children:[c.jsxs("div",{className:"anime-updates-header",children:[c.jsx("h3",{children:"Recent Updates"}),c.jsx("span",{className:"anime-updates-caption",children:"Last list activity"})]}),c.jsx("div",{className:"anime-updates-list",children:W.map(fe=>vt(fe))})]}),ee&&c.jsx(Gw,{open:O,title:"Suggest an Anime",placeholder:"Type an anime you'd like me to watch...",value:D,status:he,loading:Ae,onChange:b,onSubmit:Te,onClose:()=>B(!1)}),M&&c.jsx("div",{className:"modal-backdrop visible",onClick:fe=>{fe.target===fe.currentTarget&&ne(null)},children:c.jsxs("div",{className:"anime-modal",children:[c.jsxs("div",{className:"anime-modal-header",children:[c.jsx("h2",{style:{color:"#ffb6c1",margin:0},children:M.title}),c.jsx("button",{className:"anime-modal-close",onClick:()=>ne(null),type:"button","aria-label":"Close",children:"X"})]}),c.jsxs("div",{className:"anime-modal-body",children:[c.jsx("div",{children:c.jsx("img",{className:"anime-modal-cover",src:M.image||"https://imgur.com/chUgq4W.png",alt:M.title})}),c.jsxs("div",{className:"anime-modal-meta",children:[c.jsxs("div",{children:[c.jsx("strong",{children:"Status:"})," ",s(M.status)]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Episodes:"})," ",M.episodes?M.episodes:"Unknown"]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Progress:"})," ",Number.isFinite(Number(M.watchedEpisodes))?`Episode ${M.watchedEpisodes}${Number.isFinite(Number(M.episodes))?`/${M.episodes}`:""}`:"Unknown"]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Score:"})," ",Number.isFinite(Number(M.score))&&Number(M.score)>0?M.score:"Not rated"]})]}),c.jsx(KR,{modalItem:M,modalLoading:Ee,modalSynopsisShown:Re,onReveal:async()=>{if(!M)return;A(!0);const fe=M.id;if(!fe)return;const We=xe[fe];if(We!==void 0){ne(ue=>ue&&{...ue,synopsis:We});return}le(!0);try{const ue=await WR(fe);we(Qe=>({...Qe,[fe]:ue||""})),ne(Qe=>Qe&&{...Qe,synopsis:ue||""})}catch{we(Qe=>({...Qe,[fe]:""})),ne(Qe=>Qe&&{...Qe,synopsis:""})}finally{le(!1)}}})]})]})})]})}function KR({modalItem:n,modalLoading:e,modalSynopsisShown:t,onReveal:s}){var m;const a=((m=n==null?void 0:n.synopsis)==null?void 0:m.trim())||"",[l,d]=k.useState(0),f=k.useRef(null);return k.useEffect(()=>{if(t&&f.current){const v=f.current.scrollHeight+12;d(v)}else d(0)},[t,a]),c.jsxs("div",{className:"anime-modal-summary",children:[c.jsxs("div",{className:"anime-modal-summary-header",children:[c.jsx("h3",{children:"Synopsis"}),!t&&c.jsx("button",{className:"anime-synopsis-btn",type:"button",onClick:s,children:e?"Loading...":"Reveal Synopsis"})]}),c.jsx("div",{className:`anime-modal-summary-body ${t?"is-open":""}`,style:{maxHeight:t?`${l}px`:0,opacity:t?1:0},children:c.jsx("div",{ref:f,children:c.jsx("p",{className:"anime-modal-summary-text",children:e&&!a?"Loading synopsis...":a||"No synopsis available."})})}),!t&&c.jsx("p",{className:"anime-modal-summary-text anime-modal-summary-hint",children:"Synopsis hidden. Click reveal to view."})]})}function QR(){const n={game:"pokemon",name:"",setName:"",number:"",rarity:"",condition:"",quantity:1,pricePaid:"",estimatedValue:"",image:"",productURL:"",notes:""},{admin:e,user:t}=Ho(),[s,a]=k.useState(()=>localStorage.getItem("tcgLastGame")||n.game),[l,d]=k.useState([]),[f,m]=k.useState(!0),[v,w]=k.useState(""),[S,I]=k.useState("all"),[U,Z]=k.useState("name"),[Q,M]=k.useState(!1),[ne,xe]=k.useState([]),[we,Ee]=k.useState(""),[le,Re]=k.useState(null),[A,P]=k.useState(!1),[R,O]=k.useState(()=>({...n,game:s}));k.useEffect(()=>{document.title="TCG | Collection"},[]),k.useEffect(()=>{let N=!1;const W=async()=>{if(!N)try{const _e=await fetch("/base/tcg-collection.json",{cache:"no-cache"});if(!_e.ok)throw new Error("fallback fetch failed");const Le=await _e.json(),qe=Array.isArray(Le.tcg)?Le.tcg:[];N||d(qe.map((rt,vt)=>({id:rt.id||`offline-${vt}`,...rt})))}catch(Te){console.error("TCG offline fallback failed",Te)}finally{N||m(!1)}};async function ee(){m(!0);try{const Te=ir(lt,"tcg"),_e=await ai(Te),Le=[];_e.forEach(qe=>Le.push({id:qe.id,...qe.data()})),N||d(Le)}catch(Te){console.error("Error loading TCG:",Te),await W()}finally{N||m(!1)}}return ee(),()=>{N=!0}},[t]);const B=l.filter(N=>{if(S!=="all"&&N.game!==S)return!1;if(!v)return!0;const W=v.toLowerCase();return(N.name||"").toLowerCase().includes(W)||(N.setName||"").toLowerCase().includes(W)||(N.number||"").toLowerCase().includes(W)}),D=[...B].sort((N,W)=>{const ee=(N.name||"").toLowerCase(),Te=(W.name||"").toLowerCase(),_e=(N.setName||"").toLowerCase(),Le=(W.setName||"").toLowerCase(),qe=(N.rarity||"").toLowerCase(),rt=(W.rarity||"").toLowerCase(),vt=Number(N.quantity||0),fe=Number(W.quantity||0),We=Number(N.estimatedValue||0)*Math.max(1,vt),ue=Number(W.estimatedValue||0)*Math.max(1,fe);switch(U){case"set":return _e.localeCompare(Le)||ee.localeCompare(Te);case"rarity":return qe.localeCompare(rt)||ee.localeCompare(Te);case"quantity":return fe-vt||ee.localeCompare(Te);case"value":return ue-We||ee.localeCompare(Te);case"name":default:return ee.localeCompare(Te)}}),b=l.reduce((N,W)=>{const ee=Number(W.quantity||1),Te=Number(W.pricePaid||0),_e=Number(W.estimatedValue||0);N.totalCards+=ee,N.totalPaid+=ee*Te,N.totalValue+=ee*_e;const Le=(W.game||"").toLowerCase(),qe=ee*_e;return Le==="pokemon"?(N.pokemon+=ee,N.valueByGame.pokemon+=qe):Le==="onepiece"?(N.onepiece+=ee,N.valueByGame.onepiece+=qe):Le==="mtg"?(N.mtg+=ee,N.valueByGame.mtg+=qe):N.valueByGame.other+=qe,N},{totalCards:0,totalPaid:0,totalValue:0,pokemon:0,onepiece:0,mtg:0,valueByGame:{pokemon:0,onepiece:0,mtg:0,other:0}}),he=b.totalValue-b.totalPaid,$e=[["Pokemon",b.valueByGame.pokemon],["One Piece",b.valueByGame.onepiece],["MTG",b.valueByGame.mtg],["Other",b.valueByGame.other]].filter(([,N])=>N>0).map(([N,W])=>`${N}: $${W.toFixed(2)}`),Ae=$e.length?$e.join(`
`):"No value data yet",He=(N,W)=>{if(N==="game"){a(W);try{localStorage.setItem("tcgLastGame",W)}catch{}}O(ee=>({...ee,[N]:W}))},me=async()=>{if(!e)return;if(!R.name.trim()){alert("Card name is required.");return}const N={game:R.game,name:R.name.trim(),setName:R.setName.trim(),number:R.number.trim(),rarity:R.rarity.trim(),condition:R.condition.trim(),quantity:Number(R.quantity||1),pricePaid:Number(R.pricePaid||0),estimatedValue:Number(R.estimatedValue||0),image:R.image.trim(),productURL:R.productURL.trim(),notes:R.notes.trim()},W=_e=>({game:(_e.game||"").toLowerCase().trim(),name:(_e.name||"").toLowerCase().trim(),setName:(_e.setName||"").toLowerCase().trim(),number:(_e.number||"").toLowerCase().trim(),rarity:(_e.rarity||"").toLowerCase().trim(),condition:(_e.condition||"").toLowerCase().trim(),pricePaid:Number(_e.pricePaid||0),estimatedValue:Number(_e.estimatedValue||0),image:(_e.image||"").trim(),productURL:(_e.productURL||"").trim(),notes:(_e.notes||"").trim()}),ee=W(N),Te=l.find(_e=>{const Le=W(_e);return Le.game===ee.game&&Le.name===ee.name&&Le.setName===ee.setName&&Le.number===ee.number&&Le.rarity===ee.rarity&&Le.condition===ee.condition&&Le.pricePaid===ee.pricePaid&&Le.estimatedValue===ee.estimatedValue&&Le.image===ee.image&&Le.productURL===ee.productURL&&Le.notes===ee.notes});try{const _e=ir(lt,"tcg");if(Te!=null&&Te.id){const Le=Number(Te.quantity||1)+N.quantity;await Ds(Lt(lt,"tcg",Te.id),{quantity:Le}),d(qe=>qe.map(rt=>rt.id===Te.id?{...rt,quantity:Le}:rt))}else{await To(_e,N);const Le=await ai(_e),qe=[];Le.forEach(rt=>qe.push({id:rt.id,...rt.data()})),d(qe)}O({...n,game:s}),P(!1)}catch(_e){console.error("Error adding card:",_e),alert("Failed to save card.")}},De=async()=>{if(!e||!le)return;if(!le.name.trim()){alert("Card name is required.");return}const N={game:le.game,name:le.name.trim(),setName:le.setName.trim(),number:le.number.trim(),rarity:le.rarity.trim(),condition:le.condition.trim(),quantity:Number(le.quantity||1),pricePaid:Number(le.pricePaid||0),estimatedValue:Number(le.estimatedValue||0),image:le.image?le.image.trim():"",productURL:le.productURL?le.productURL.trim():"",notes:le.notes?le.notes.trim():""};try{await Ds(Lt(lt,"tcg",le.id),N),d(W=>W.map(ee=>ee.id===le.id?{...ee,...N}:ee)),Re(null)}catch(W){console.error("Error updating card:",W),alert("Failed to update card.")}},be=async N=>{if(e&&window.confirm("Delete this card?"))try{await Eo(Lt(lt,"tcg",N)),d(W=>W.filter(ee=>ee.id!==N))}catch(W){console.error("Delete error:",W),alert("Failed to delete card.")}},K=()=>{if(!l.length){alert("No cards to export.");return}const N=new Blob([JSON.stringify({tcg:l},null,2)],{type:"application/json"}),W=URL.createObjectURL(N),ee=document.createElement("a");ee.href=W,ee.download="tcg-collection.json",ee.click(),URL.revokeObjectURL(W)};return c.jsxs("main",{className:"page",children:[c.jsxs("header",{style:{marginTop:"32px",marginBottom:"16px",display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",gap:"6px"},children:[c.jsx("h1",{style:{margin:0,fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Tyler's TCG Collection"}),c.jsx("p",{style:{margin:"6px 0 0",color:"var(--text-soft)",fontSize:"0.9rem"},children:"Check out my TCG Collection with all the data of how much I spent (Under construction) and how much my collection is worth in total!"}),e&&c.jsx("div",{style:{marginTop:"10px"},children:c.jsx("button",{className:"manga-btn secondary",type:"button",onClick:K,children:"Export JSON"})})]}),e&&c.jsx("button",{className:"manga-btn",type:"button","aria-label":"Add card",onClick:()=>P(!0),style:{position:"fixed",bottom:"20px",right:"20px",zIndex:1e3,width:"56px",height:"56px",borderRadius:"50%",padding:0,fontSize:"28px",display:"flex",alignItems:"center",justifyContent:"center"},children:"+"}),e&&A&&c.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(8,1,10,0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,padding:"12px"},onClick:N=>{N.target===N.currentTarget&&P(!1)},children:c.jsxs("div",{style:{width:"min(720px, 95vw)",background:"#140710",border:"1px solid rgba(255,182,193,0.3)",borderRadius:"12px",padding:"14px",boxShadow:"0 24px 60px rgba(0,0,0,0.85)"},onClick:N=>N.stopPropagation(),children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[c.jsx("h2",{style:{margin:0,color:"#ffb6c1"},children:"Add card"}),c.jsx("button",{className:"dashboard-close",onClick:()=>P(!1),type:"button","aria-label":"Close",children:"X"})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"180px 1fr",gap:"12px",alignItems:"flex-start",marginTop:"10px"},children:[c.jsx("div",{style:{width:"100%",maxWidth:"180px",borderRadius:"10px",border:"1px solid rgba(255,182,193,0.25)",background:"#1e0d14",overflow:"hidden",aspectRatio:"3 / 4",display:"flex",alignItems:"center",justifyContent:"center"},children:R.image?c.jsx("img",{src:R.image,alt:"Card preview",style:{width:"100%",height:"100%",objectFit:"cover"}}):c.jsx("div",{style:{color:"var(--text-soft)",fontSize:"0.8rem",padding:"6px"},children:"No image"})}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:"8px"},children:[c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Game",c.jsxs("select",{value:R.game,onChange:N=>He("game",N.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"},children:[c.jsx("option",{value:"pokemon",children:"Pokemon"}),c.jsx("option",{value:"onepiece",children:"One Piece"}),c.jsx("option",{value:"mtg",children:"MTG"})]})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Card name",c.jsx("input",{type:"text",value:R.name,onChange:N=>He("name",N.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Set name",c.jsx("input",{type:"text",value:R.setName,onChange:N=>He("setName",N.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Card number",c.jsx("input",{type:"text",value:R.number,onChange:N=>He("number",N.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Rarity",c.jsx("input",{type:"text",value:R.rarity,onChange:N=>He("rarity",N.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Condition",c.jsx("input",{type:"text",value:R.condition,onChange:N=>He("condition",N.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Quantity",c.jsx("input",{type:"number",min:"1",value:R.quantity,onChange:N=>He("quantity",N.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Price paid (per card)",c.jsx("input",{type:"number",step:"0.01",min:"0",value:R.pricePaid,onChange:N=>He("pricePaid",N.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Estimated value (per card)",c.jsx("input",{type:"number",step:"0.01",min:"0",value:R.estimatedValue,onChange:N=>He("estimatedValue",N.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Image URL",c.jsx("input",{type:"text",value:R.image||"",onChange:N=>He("image",N.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Product URL (backend only)",c.jsx("input",{type:"text",value:R.productURL||"",onChange:N=>He("productURL",N.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{gridColumn:"1 / -1",fontSize:"0.8rem",color:"var(--text-soft)"},children:["Notes",c.jsx("textarea",{value:R.notes,onChange:N=>He("notes",N.target.value),rows:3,style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff",resize:"vertical"}})]})]})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"12px"},children:[c.jsx("button",{onClick:()=>{O(n),P(!1)},style:{padding:"6px 12px",borderRadius:"999px",border:"1px solid rgba(255,182,193,0.5)",background:"transparent",color:"#ffb6c1",cursor:"pointer"},children:"Cancel"}),c.jsx("button",{onClick:me,style:{padding:"6px 12px",borderRadius:"999px",border:"none",cursor:"pointer",fontWeight:600,background:"#ff69b4",color:"#1e0d14"},children:"Save card"})]})]})}),e&&le&&c.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(8,1,10,0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,padding:"12px"},onClick:N=>{N.target===N.currentTarget&&Re(null)},children:c.jsxs("div",{style:{width:"min(720px, 95vw)",background:"#140710",border:"1px solid rgba(255,182,193,0.3)",borderRadius:"12px",padding:"14px",boxShadow:"0 24px 60px rgba(0,0,0,0.85)"},onClick:N=>N.stopPropagation(),children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[c.jsx("h2",{style:{margin:0,color:"#ffb6c1"},children:"Edit card"}),c.jsx("button",{className:"dashboard-close",onClick:()=>Re(null),type:"button","aria-label":"Close",children:"X"})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"180px 1fr",gap:"12px",alignItems:"flex-start",marginTop:"10px"},children:[c.jsx("div",{style:{width:"100%",maxWidth:"180px",borderRadius:"10px",border:"1px solid rgba(255,182,193,0.25)",background:"#1e0d14",overflow:"hidden",aspectRatio:"3 / 4",display:"flex",alignItems:"center",justifyContent:"center"},children:le.image?c.jsx("img",{src:le.image,alt:"Card preview",style:{width:"100%",height:"100%",objectFit:"cover"}}):c.jsx("div",{style:{color:"var(--text-soft)",fontSize:"0.8rem",padding:"6px"},children:"No image"})}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:"8px"},children:[c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Game",c.jsxs("select",{value:le.game,onChange:N=>Re(W=>({...W,game:N.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"},children:[c.jsx("option",{value:"pokemon",children:"Pokemon"}),c.jsx("option",{value:"onepiece",children:"One Piece"}),c.jsx("option",{value:"mtg",children:"MTG"})]})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Card name",c.jsx("input",{type:"text",value:le.name,onChange:N=>Re(W=>({...W,name:N.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Set name",c.jsx("input",{type:"text",value:le.setName,onChange:N=>Re(W=>({...W,setName:N.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Card number",c.jsx("input",{type:"text",value:le.number,onChange:N=>Re(W=>({...W,number:N.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Rarity",c.jsx("input",{type:"text",value:le.rarity,onChange:N=>Re(W=>({...W,rarity:N.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Condition",c.jsx("input",{type:"text",value:le.condition,onChange:N=>Re(W=>({...W,condition:N.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Quantity",c.jsx("input",{type:"number",value:le.quantity,onChange:N=>Re(W=>({...W,quantity:N.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Price paid (each)",c.jsx("input",{type:"number",value:le.pricePaid,onChange:N=>Re(W=>({...W,pricePaid:N.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Estimated value (each)",c.jsx("input",{type:"number",value:le.estimatedValue,onChange:N=>Re(W=>({...W,estimatedValue:N.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Image URL",c.jsx("input",{type:"text",value:le.image||"",onChange:N=>Re(W=>({...W,image:N.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Product URL (backend only)",c.jsx("input",{type:"text",value:le.productURL||"",onChange:N=>Re(W=>({...W,productURL:N.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{gridColumn:"1 / -1",fontSize:"0.8rem",color:"var(--text-soft)"},children:["Notes",c.jsx("textarea",{value:le.notes||"",onChange:N=>Re(W=>({...W,notes:N.target.value})),rows:3,style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff",resize:"vertical"}})]})]})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"12px"},children:[c.jsx("button",{onClick:()=>Re(null),style:{padding:"6px 12px",borderRadius:"999px",border:"1px solid rgba(255,182,193,0.5)",background:"transparent",color:"#ffb6c1",cursor:"pointer"},children:"Cancel"}),c.jsx("button",{onClick:De,style:{padding:"6px 12px",borderRadius:"999px",border:"none",cursor:"pointer",fontWeight:600,background:"#ff69b4",color:"#1e0d14"},children:"Save changes"})]})]})}),c.jsxs("section",{style:{display:"flex",flexWrap:"wrap",gap:"12px",marginTop:"18px",justifyContent:"center"},children:[c.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[c.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Total cards"}),c.jsx("div",{style:{fontSize:"1.1rem",fontWeight:700},children:b.totalCards})]}),b.totalPaid>0&&c.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[c.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Total paid"}),c.jsxs("div",{style:{fontSize:"1.1rem",fontWeight:700},children:["$",b.totalPaid.toFixed(2)]})]}),c.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},title:Ae,children:[c.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Total value"}),c.jsxs("div",{style:{fontSize:"1.1rem",fontWeight:700},children:["$",b.totalValue.toFixed(2)]})]}),c.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[c.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Unrealized gain / loss"}),c.jsxs("div",{style:{fontSize:"1.1rem",fontWeight:700,color:he>=0?"#00e676":"#ff8a80"},children:[he>=0?"+":"-","$",Math.abs(he).toFixed(2)]})]}),c.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[c.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Pokemon cards"}),c.jsx("div",{style:{fontSize:"1.1rem",fontWeight:700},children:b.pokemon})]}),c.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[c.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"One Piece cards"}),c.jsx("div",{style:{fontSize:"1.1rem",fontWeight:700},children:b.onepiece})]}),c.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[c.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"MTG cards"}),c.jsx("div",{style:{fontSize:"1.1rem",fontWeight:700},children:b.mtg})]})]}),c.jsxs("section",{style:{display:"flex",flexWrap:"wrap",gap:"10px",marginTop:"16px"},children:[c.jsx("input",{type:"text",placeholder:"Search by name, set, or number...",value:v,onChange:N=>w(N.target.value),style:{flex:"1 1 220px",minWidth:"220px",padding:"8px 12px",borderRadius:"999px",border:"1px solid #bb7f8f",background:"#2b0f1d",color:"#fff"}}),c.jsxs("select",{value:S,onChange:N=>I(N.target.value),style:{flex:"0 0 220px",padding:"8px 12px",borderRadius:"999px",border:"1px solid #bb7f8f",background:"#2b0f1d",color:"#fff"},children:[c.jsx("option",{value:"all",children:"All games"}),c.jsx("option",{value:"pokemon",children:"Pokemon only"}),c.jsx("option",{value:"onepiece",children:"One Piece only"}),c.jsx("option",{value:"mtg",children:"MTG only"})]}),c.jsxs("select",{value:U,onChange:N=>Z(N.target.value),style:{flex:"0 0 220px",padding:"8px 12px",borderRadius:"999px",border:"1px solid #bb7f8f",background:"#2b0f1d",color:"#fff"},children:[c.jsx("option",{value:"name",children:"Sort: Name (A-Z)"}),c.jsx("option",{value:"set",children:"Sort: Set (A-Z)"}),c.jsx("option",{value:"rarity",children:"Sort: Rarity (A-Z)"}),c.jsx("option",{value:"quantity",children:"Sort: Quantity (high to low)"}),c.jsx("option",{value:"value",children:"Sort: Value (high to low)"})]})]}),f?c.jsx("p",{style:{marginTop:"20px",color:"var(--text-soft)"},children:"Loading TCG collection..."}):B.length===0?c.jsx("p",{style:{marginTop:"20px",color:"var(--text-soft)"},children:"No cards found."}):c.jsx("section",{className:"grid",style:{gridTemplateColumns:"repeat(auto-fill, minmax(170px, 1fr))",marginTop:"20px"},children:D.map(N=>{const W=Number(N.quantity||1),ee=W*Number(N.pricePaid||0),Te=W*Number(N.estimatedValue||0);return c.jsxs("article",{style:{background:"#2b0f1d",borderRadius:"12px",border:"1px solid rgba(255,182,193,0.25)",boxShadow:"0 4px 16px rgba(0,0,0,0.55)",padding:"10px",fontSize:"0.82rem",display:"flex",flexDirection:"column",gap:"6px"},children:[N.image&&c.jsx("div",{style:{width:"100%",paddingTop:"140%",position:"relative",overflow:"hidden",borderRadius:"10px",background:"#1e0d14"},children:c.jsx("img",{src:N.image,alt:N.name||"card image",style:{position:"absolute",inset:0,width:"100%",height:"100%",objectFit:"contain"}})}),c.jsx("div",{style:{fontWeight:700,color:"#ffb6c1",marginBottom:"4px"},children:N.name||"Unnamed card"}),c.jsx("div",{style:{color:"var(--text-soft)",marginBottom:"4px"},children:N.setName||""}),c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",color:"var(--text-soft)"},children:[c.jsxs("span",{children:["#",N.number||"-"]}),c.jsx("span",{children:N.rarity||""})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",color:"var(--text-soft)",marginTop:"4px"},children:[c.jsxs("span",{children:["Cond: ",N.condition||"N/A"]}),c.jsxs("span",{children:["Qty: ",W]})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",color:"var(--text-soft)",marginTop:"4px"},children:[c.jsxs("span",{children:["Paid: $",ee.toFixed(2)]}),c.jsxs("span",{children:["Value: $",Te.toFixed(2)]})]}),N.notes&&c.jsxs("div",{style:{color:"#9c8fa6",fontSize:"0.72rem",fontStyle:"italic",textAlign:"center",marginTop:"6px"},children:['"',N.notes,'"']}),c.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"8px"},children:[c.jsx("span",{style:{padding:"2px 7px",borderRadius:"999px",background:"rgba(255,105,180,0.18)",border:"1px solid rgba(255,105,180,0.5)",color:"#ffb6c1",fontSize:"0.7rem",whiteSpace:"nowrap"},children:{pokemon:"Pokemon",onepiece:"One Piece",mtg:"MTG"}[N.game]||"Other"}),e&&c.jsxs("div",{style:{display:"flex",gap:"6px",alignItems:"center",marginLeft:"auto"},children:[c.jsx("button",{onClick:()=>Re({...N,pricePaid:N.pricePaid??"",estimatedValue:N.estimatedValue??"",quantity:N.quantity??1}),style:{padding:"3px 8px",borderRadius:"999px",border:"1px solid rgba(255,182,193,0.5)",background:"rgba(255,105,180,0.15)",color:"#ffb6c1",fontSize:"0.7rem",cursor:"pointer"},children:"Edit"}),c.jsx("button",{onClick:()=>be(N.id),style:{padding:"3px 8px",borderRadius:"999px",border:"1px solid rgba(244,67,54,0.7)",background:"rgba(244,67,54,0.12)",color:"#ff8a80",fontSize:"0.7rem",cursor:"pointer"},children:"Delete"})]})]})]},N.id)})})]})}const Tl="https://discord.com/api/webhooks/1448287168845054004/cGWGPoH5LaTFlBZ1vxtgMjOfV9au6qyQ_9ZRnOWN9-AX0MNfwxKNWVcZYQHz0ESA7_4k",Sl="https://discord.com/api/webhooks/1448288240871276616/101WI-B2p8tDR34Hl9fZxxb0QG01f1Eo5w1IvbttlQmP2wWFNJ0OI7UnJfJujKRNWW2Q";function uc(n){const e=n==null?"":String(n);return e.trim()?e.replace(/\s*,?\s*(?:vol(?:ume)?\.?)\s+\d+.*$/i,"").trim():""}function vi(n){if(!n)return null;if(n instanceof Date)return n;if(n&&typeof n.toDate=="function")return n.toDate();const e=String(n).trim();if(!e)return null;const t=e.match(/^(\d{4})-(\d{2})-(\d{2})$/);if(t){const[,l,d,f]=t;return new Date(Number(l),Number(d)-1,Number(f))}const s=e.match(/^(\d{1,2})\/(\d{1,2})\/(\d{2,4})$/);if(s){let[,l,d,f]=s;const m=f.length===2?+`20${f}`:Number(f);return new Date(m,Number(l)-1,Number(d))}const a=new Date(e);return isNaN(a.getTime())?null:a}function Td(n){const e=n.seriesKey||n.series||n.Series||n.title||n.Title||"",s=(uc(e)||e).trim();return s?s.toLowerCase():""}function YR(n){const e=(n==null?void 0:n.series)||(n==null?void 0:n.Series)||(n==null?void 0:n.title)||(n==null?void 0:n.Title)||"Unknown Series";return uc(e)||"Unknown Series"}function e_(n){const e=(n||"").trim(),t=e.match(/^(.*?)(?:,?\s*(?:vol\.|volume)\s*(\d+)(?:\s*[-]\s*\d+)?\s*)?(?:\s*\([^)]*\))?$/i),s=t?t[1].trim().toLowerCase():e.toLowerCase(),a=t&&t[2]?parseInt(t[2],10):0;return{name:s,vol:Number.isFinite(a)?a:0}}function JR(n,e){const t=(n==null?void 0:n.Title)||(n==null?void 0:n.title)||"",s=(e==null?void 0:e.Title)||(e==null?void 0:e.title)||"",a=e_(t),l=e_(s),d=a.name.localeCompare(l.name);return d!==0?d:a.vol!==l.vol?a.vol-l.vol:t.localeCompare(s)}function cf(){return{publisher:"",demographic:"",genre:"",subGenre:"",datePurchased:"",msrp:"",initialPublisher:"",initialDemographic:"",initialGenre:"",initialSubGenre:"",initialDatePurchased:"",initialMsrp:"",dateMixed:!1,readChecked:!1,readIndeterminate:!1}}function t_(){return{read:!1,datePurchased:"",dateRead:"",pageCount:"",msrp:"",amountPaid:"",rating:"",special:!1,specialType:"",specialVolumes:"",collectiblePrice:""}}function n_(n,e={}){const t=e.ignoreShared,s=(n==null?void 0:n.amountPaid)??(n==null?void 0:n.AmountPaid)??(n==null?void 0:n.paid)??(n==null?void 0:n.Paid)??"",a=(n==null?void 0:n.msrp)??(n==null?void 0:n.MSRP)??"",l=((n==null?void 0:n.datePurchased)||(n==null?void 0:n.DatePurchased)||"").trim(),d=((n==null?void 0:n.publisher)||(n==null?void 0:n.Publisher)||"").trim(),f=((n==null?void 0:n.demographic)||(n==null?void 0:n.Demographic)||"").trim(),m=((n==null?void 0:n.genre)||(n==null?void 0:n.Genre)||"").trim(),v=((n==null?void 0:n.specialType)||(n==null?void 0:n.SpecialType)||"").trim(),w=(n==null?void 0:n.specialVolumes)??(n==null?void 0:n.SpecialVolumes)??(n==null?void 0:n.volumesContained)??"",S=(n==null?void 0:n.collectiblePrice)??(n==null?void 0:n.CollectiblePrice)??"",I=!!v,U=(n==null?void 0:n.pageCount)??(n==null?void 0:n.PageCount)??(n==null?void 0:n.pages)??(n==null?void 0:n.Pages)??"",Z=U==null?"":String(U).trim(),Q=Number(Z),M=!Z||Number.isNaN(Q)||Q<=0;return!I&&(s===""||s===null)||M||!l||!t&&(a===""||!d||!f||!m)||I&&!v||I&&v.toLowerCase()==="collectible"&&(S===""||S===null)||I&&v.toLowerCase()==="specialedition"&&(w===""||w===null)}function XR(n){const e=(n==null?void 0:n.amountPaid)??"",t=((n==null?void 0:n.datePurchased)||"").trim(),s=!!(n!=null&&n.specialType)||!!(n!=null&&n.special),a=((n==null?void 0:n.specialType)||"").trim(),l=(n==null?void 0:n.specialVolumes)??"",d=(n==null?void 0:n.collectiblePrice)??"",f=(n==null?void 0:n.pageCount)??"",m=(n==null?void 0:n.msrp)??"",v=((n==null?void 0:n.publisher)||"").trim(),w=((n==null?void 0:n.demographic)||"").trim(),S=((n==null?void 0:n.genre)||"").trim(),I=!s&&(e===""||e===null),U=s&&!a,Z=s&&a.toLowerCase()==="collectible"&&(d===""||d===null),Q=s&&a.toLowerCase()==="specialedition"&&(l===""||l===null),M=(()=>{const ne=(f??"").toString().trim();if(ne==="")return!0;const xe=Number(ne);return Number.isNaN(xe)||xe<=0})();return{amountPaid:I,datePurchased:!t,specialType:U,collectiblePrice:Z,specialVolumes:Q,pageCount:M,msrp:m===""||m===null,publisher:!v,demographic:!w,genre:!S}}function ZR(n){return!n||!n.books||!n.books.length?!1:n.books.some(e=>{const t=(e==null?void 0:e.msrp)??(e==null?void 0:e.MSRP)??"",s=((e==null?void 0:e.publisher)||(e==null?void 0:e.Publisher)||"").trim(),a=((e==null?void 0:e.demographic)||(e==null?void 0:e.Demographic)||"").trim(),l=((e==null?void 0:e.genre)||(e==null?void 0:e.Genre)||"").trim();return t===""||!s||!a||!l})}function eN(n){const e=new Map;for(const t of n){const s=Td(t)||t.id;if(!e.has(s)){const m=uc(t.series||t.Series||t.title||t.Title||"Unknown Series")||"Unknown Series";e.set(s,{key:s,title:m,publisher:t.publisher||t.Publisher||"",genre:t.genre||t.Genre||"",demographic:t.demographic||t.Demographic||"",volumes:0,totalPages:0,readPages:0,readVolumes:0,ratingSum:0,ratingCount:0})}const a=e.get(s);a.volumes+=1;const l=Number(t.pages||t.Pages||t.pageCount||0)||0;a.totalPages+=l,(!!t.read||t.status==="Read"||t.Read===!0)&&(a.readVolumes+=1,a.readPages+=l);const f=Number(t.rating||t.Rating);!isNaN(f)&&f>0&&(a.ratingSum+=f,a.ratingCount+=1)}return e}function yo(n,e,t=5){const s=new Map;for(const a of n.values()){const l=(a[e]||"").trim();if(!l)continue;const d=l.split(/[\/,]/).map(f=>f.trim()).filter(Boolean);for(const f of d)s.set(f,(s.get(f)||0)+1)}return[...s.entries()].sort((a,l)=>l[1]-a[1]).slice(0,t).map(([a,l])=>({name:a,count:l}))}function r_(n,e){const t=Array.from({length:12},(s,a)=>{const l=new Date(e,a,1);return{key:`${e}-${a}`,label:l.toLocaleString("default",{month:"short"}),year:e,month:a,value:0}});for(const s of n){const a=vi(s.dateRead||s.DateRead);!a||a.getFullYear()!==e||(t[a.getMonth()].value+=1)}return t}function Ca(n){const e=n.getFullYear(),t=`${n.getMonth()+1}`.padStart(2,"0"),s=`${n.getDate()}`.padStart(2,"0");return`${e}-${t}-${s}`}async function s_(n,e){try{await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:e})})}catch(t){console.error("Webhook post failed",t)}}function tN(n){const e=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],t=Array(7).fill(0);for(const l of n){const d=vi(l.dateRead||l.DateRead);d&&(t[d.getDay()]+=1)}if(!t.some(l=>l>0))return[];const a=t.reduce((l,d)=>Math.max(l,d),0)||1;return e.map((l,d)=>({label:l,value:t[d],pct:t[d]/a}))}function nN(n,e=8){const t=[...n.values()];t.sort((l,d)=>d.volumes-l.volumes);const s=t.slice(0,e),a=s.reduce((l,d)=>Math.max(l,d.volumes),0)||1;return s.map(l=>({label:l.title,value:l.volumes,pct:l.volumes/a}))}function rN(n,e){const t=(a,l)=>{const d=vi(a.releaseDate||a.ReleaseDate||a.date||a.Date);if(!d)return null;const f=(a.title||a.series||a.Title||"Unknown Title").trim(),m=!!(a.datePurchased||a.DatePurchased||"").trim();return{date:d,title:f,purchased:m,source:l}},s=[];return(e||[]).forEach(a=>{const l=t(a,"wishlist");l&&s.push(l)}),(n||[]).forEach(a=>{const l=t(a,"library");l&&s.push(l)}),s.sort((a,l)=>a.date-l.date),s}function sN(n){const e=new Date;for(const t of n)if(t.date>=e)return t;return n[n.length-1]||null}function iN(n){let e=0,t=0;for(const s of n){const a=vi(s.datePurchased||s.DatePurchased),l=vi(s.dateRead||s.DateRead);if(!a||!l)continue;const d=l-a;d<=0||(e+=d/(1e3*60*60*24),t+=1)}return t?e/t:null}function aN(n){const e=new Map;for(const t of n){const s=vi(t.datePurchased||t.DatePurchased),a=vi(t.dateRead||t.DateRead);if(!s||!a)continue;const l=a-s;if(l<=0)continue;const d=l/(1e3*60*60*24),f=Td(t)||t.id,m=uc(t.series||t.Series||t.title||t.Title||"Untitled")||"Untitled";e.has(f)||e.set(f,{key:f,title:m,total:0,count:0,min:d,max:d});const v=e.get(f);v.total+=d,v.count+=1,v.min=Math.min(v.min,d),v.max=Math.max(v.max,d)}return[...e.values()].filter(t=>t.count>0).map(t=>({...t,avg:t.total/t.count})).sort((t,s)=>s.avg-t.avg)}function oN(n){let e=0,t=0,s=0;for(const a of n){const l=Number(a.msrp||a.MSRP||0)||0,d=Number(a.amountPaid||a.AmountPaid||a.pricePaid||0)||l||0,f=Number(a.collectiblePrice||a.CollectiblePrice||0)||0;e+=l,t+=d,s+=f}return{msrpTotal:e,paidTotal:t,collectibleTotal:s}}function lN(n){const e=new Map;for(const t of n){const s=Td(t)||t.id;if(!e.has(s)){const S=t.series||t.Series||t.title||t.Title||"Untitled";e.set(s,{key:s,title:uc(S)||S.trim()||"Untitled",msrp:0,paid:0,collectible:0,books:0,pages:0,readPages:0,ratings:[]})}const a=e.get(s);a.books+=1;const l=Number(t.msrp||t.MSRP||0)||0,d=Number(t.amountPaid||t.AmountPaid||t.pricePaid||0)||0,f=Number(t.collectiblePrice||t.CollectiblePrice||0)||0,m=Number(t.pages||t.Pages||t.pageCount||0)||0,v=!!t.read||t.status==="Read"||t.Read===!0;a.msrp+=l,a.paid+=d,a.collectible+=f,a.pages+=m,v&&(a.readPages+=m);const w=Number(t.rating||t.Rating);!isNaN(w)&&w>0&&a.ratings.push(w)}return[...e.values()]}function cN(n){let e=0,t=0;for(const s of n){const a=Number(s.pages||s.Pages||s.pageCount||0)||0;e+=a,(!!s.read||s.status==="Read"||s.Read===!0)&&(t+=a)}return{total:e,read:t}}function uN(n){let e=0,t=0;for(const s of n.values())s.ratingCount>0&&(e+=s.ratingSum/s.ratingCount,t+=1);return t?e/t:null}function dN({data:n}){if(!n||!n.length)return c.jsx("div",{className:"line-chart empty",children:"No reading data yet."});const e=n.reduce((v,w)=>Math.max(v,w.value),0)||1,t=480,s=230,a=30,l=s-a*2,d=t/Math.max(n.length-1,1),f=n.map((v,w)=>{const S=w*d,I=s-a-v.value/e*l;return{...v,x:S,y:I}}),m=f.map((v,w)=>w===0?`M ${v.x} ${v.y}`:`L ${v.x} ${v.y}`).join(" ");return c.jsx("div",{className:"line-chart",children:c.jsxs("svg",{viewBox:`0 0 ${t} ${s}`,width:"100%",height:"100%",preserveAspectRatio:"xMidYMid meet",children:[[0,.25,.5,.75,1].map((v,w)=>{const S=s-a-v*l;return c.jsx("line",{className:"line-grid",x1:"0",x2:t,y1:S,y2:S},`h-${w}`)}),f.map((v,w)=>c.jsx("line",{className:"line-grid",x1:v.x,x2:v.x,y1:a/2,y2:s-a/2},`v-${w}`)),c.jsx("path",{className:"line-path",d:m}),f.map((v,w)=>c.jsxs("g",{children:[c.jsx("circle",{className:"line-point",cx:v.x,cy:v.y,r:"1.5"}),c.jsx("text",{className:"line-value",x:v.x,y:v.y-3,children:v.value}),c.jsx("text",{className:"line-label",x:v.x,y:s-4,children:v.label})]},w))]})})}function hN({data:n}){return!n||!n.length?c.jsx("div",{className:"weekday-breakdown empty",children:"No reads recorded yet."}):c.jsx("div",{className:"weekday-bars",children:n.map(e=>c.jsxs("div",{className:"weekday-col",children:[c.jsx("div",{className:"weekday-count",children:e.value}),c.jsx("div",{className:"weekday-bar-vert",children:c.jsx("div",{className:"weekday-bar-vert-fill",style:{height:`${Math.max(e.pct*100,e.value?6:0)}%`}})}),c.jsx("div",{className:"weekday-label",children:e.label})]},e.label))})}function i_(n,e,t){const s=n.getFullYear(),a=n.getMonth(),d=new Date(s,a,1).getDay(),f=new Date(s,a+1,0).getDate(),m=new Map;for(const S of e){const I=S.date;if(I.getFullYear()===s&&I.getMonth()===a){const U=I.getDate();m.has(U)||m.set(U,[]),m.get(U).push(S)}}const v=[];for(let S=0;S<d;S++)v.push({type:"pad"});for(let S=1;S<=f;S++){const I=Ca(new Date(s,a,S));v.push({type:"day",day:S,releases:m.get(S)||[],dateKey:I,isToday:I===t})}const w=Math.ceil(v.length/7)*7;for(;v.length<w;)v.push({type:"pad"});return v}function fN(){const{user:n,admin:e,loading:t}=Ho(),[s,a]=k.useState([]),[l,d]=k.useState([]),[f,m]=k.useState(!0),[v,w]=k.useState(null),[S,I]=k.useState("-"),[U,Z]=k.useState({yearly:Tl,release:Sl,activity:Ia}),[Q,M]=k.useState(new Set),[ne,xe]=k.useState(null),[we,Ee]=k.useState(null),[le,Re]=k.useState(new Set),[A,P]=k.useState(null),[R,O]=k.useState(""),B=k.useRef(null),[D,b]=k.useState(()=>cf()),[he,$e]=k.useState(()=>t_()),[Ae,He]=k.useState([]),[me,De]=k.useState(!1),[be,K]=k.useState([]),[N,W]=k.useState(!1),[ee,Te]=k.useState([]),[_e,Le]=k.useState(!1),[qe,rt]=k.useState(""),[vt,fe]=k.useState(null),[We,ue]=k.useState(null),Qe=async()=>{if(e)try{W(!0);const V=(await ai(ir(lt,"users"))).docs.map(H=>({uid:H.id,...H.data()}));K(V)}catch(T){console.error("Failed to load users",T)}finally{W(!1)}},Je=async(T,V)=>{const H=(T||"").trim();if(!H){alert("UID is required.");return}try{await ci(Lt(lt,"users",H),{role:V,updatedBy:(n==null?void 0:n.uid)||"manual",updatedAt:new Date().toISOString()},{merge:!0}),await Qe()}catch(oe){console.error("Failed to update role",oe),alert("Failed to update role.")}},[Rt,kt]=k.useState(!1),[St,jt]=k.useState(()=>new Date),[on,Sn]=k.useState(!1),[ln,fr]=k.useState(()=>new Date),[Xt,qn]=k.useState(null),[Ot,$t]=k.useState(!1),[On,lr]=k.useState(()=>{const T=new Date;return{year:T.getFullYear(),month:T.getMonth()}}),[Cn,Mn]=k.useState(null),[Qt,Zr]=k.useState({open:!1,type:null}),In=new Date().getFullYear(),pn=k.useRef(null),es=k.useRef(null);k.useEffect(()=>{document.title="Dashboard"},[]),k.useEffect(()=>(Rt||Qt.open||me||!!We||on||!!Xt||Ot||!!Cn?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[Rt,Qt.open,me,We,on,Xt,Ot,Cn]),k.useEffect(()=>{typeof window>"u"||(pn.current=localStorage.getItem("dashboard-yearly-posted"),es.current=localStorage.getItem("dashboard-release-posted"))},[]),k.useEffect(()=>{if(!e)return;const T=Lt(lt,"settings","webhooks");(async()=>{try{const V=await xd(T);if(V.exists()){const H=V.data();Z({yearly:H.yearly||Tl,release:H.release||Sl,activity:H.activity||Ia})}else await ci(T,{yearly:Tl,release:Sl,activity:Ia}),Z({yearly:Tl,release:Sl,activity:Ia})}catch(V){console.error("Failed to load webhook settings",V)}})()},[e]),k.useEffect(()=>{if(!e)return;let T=!1;return(async()=>await Qe())(),()=>{T=!0}},[e]),k.useEffect(()=>{let T=!1;if(!n||!e){Te([]),rt("");return}return(async()=>{try{Le(!0);const H=(await ai(ir(lt,"suggestions"))).docs.map(oe=>{var Ie;const ye=oe.data();let Ue=null;if((Ie=ye==null?void 0:ye.createdAt)!=null&&Ie.toDate)Ue=ye.createdAt.toDate();else if(ye!=null&&ye.createdAt){const Ke=new Date(ye.createdAt);Ue=isNaN(Ke.getTime())?null:Ke}return{id:oe.id,...ye,createdAt:Ue}});H.sort((oe,ye)=>{var Ue,Ie,Ke,ct;return(((Ie=(Ue=ye.createdAt)==null?void 0:Ue.getTime)==null?void 0:Ie.call(Ue))||0)-(((ct=(Ke=oe.createdAt)==null?void 0:Ke.getTime)==null?void 0:ct.call(Ke))||0)}),T||(Te(H),rt(""))}catch(V){console.error("Failed to load suggestions",V),T||(rt("Failed to load suggestions."),Te([]))}finally{T||Le(!1)}})(),()=>{T=!0}},[n,e]);const ws=async T=>{if(!(!e||!T))try{await Eo(Lt(lt,"suggestions",T)),Te(V=>V.filter(H=>H.id!==T))}catch(V){console.error("Failed to delete suggestion",V),rt("Failed to delete suggestion.")}};k.useEffect(()=>{let T=!1;async function V(){if(!n||!e){a([]),d([]),w(null),m(!1);return}try{m(!0);const[H,oe]=await Promise.all([ai(ir(lt,"library")),ai(ir(lt,"wishlist"))]);if(T)return;a(H.docs.map(ye=>({id:ye.id,...ye.data()}))),d(oe.docs.map(ye=>({id:ye.id,...ye.data()}))),w(null)}catch(H){console.error(H),T||w("Failed to load dashboard data.")}finally{T||m(!1)}}return V(),()=>{T=!0}},[n,e]);const It=k.useMemo(()=>{const T=s.length,V=s.filter(Un=>!!Un.read||Un.status==="Read"||Un.Read===!0).length,H=T-V,oe=T?Math.round(V/T*100):0,ye=l.length,Ue=eN(s),Ie=r_(s,In),Ke=r_(s,In-1),ct=Ie.reduce((Un,ls)=>Un+ls.value,0),mt=tN(s),Dt=nN(Ue),Et=rN(s,l),Zt=sN(Et),vn=iN(s),_t=oN(s),en=cN(s),Xn=uN(Ue),zr=aN(s),Nr=yo(Ue,"publisher",5),Qs=yo(Ue,"genre",5),Oa=yo(Ue,"demographic",5),Ar=lN(s);return{totalLibrary:T,readCount:V,unreadCount:H,readPct:oe,wishlistCount:ye,seriesMap:Ue,monthlyReads:Ie,prevYearReads:Ke,currentYearReadsTotal:ct,weekdayBreakdown:mt,topSeriesBars:Dt,releases:Et,nextRelease:Zt,avgDays:vn,purchaseToReadSeries:zr,collectionValue:_t,pages:en,avgRating:Xn,topPublishers:Nr,topGenres:Qs,topDemographics:Oa,seriesAggregates:Ar}},[s,l,In]),{totalLibrary:pr,readCount:xs,unreadCount:Kn,readPct:Qn,wishlistCount:br,seriesMap:bn,monthlyReads:Pr,prevYearReads:Yn,currentYearReadsTotal:$s,weekdayBreakdown:mr,topSeriesBars:Ws,releases:tt,nextRelease:Jn,avgDays:Pn,purchaseToReadSeries:ts,collectionValue:Rn,pages:mn,avgRating:Nn,topPublishers:Es,topGenres:Ts,topDemographics:Fn,seriesAggregates:Fr}=It,Mt=Jn?Jn.date:null,ns=!!v,cn=Ca(new Date),Rr=k.useMemo(()=>s.map(T=>{const V=vi(T.dateRead||T.DateRead);return!V||!(T.read||T.status==="Read"||T.Read===!0)?null:{date:V,title:T.title||T.Title||"Untitled"}}).filter(Boolean).sort((T,V)=>T.date-V.date),[s]),Gs=k.useMemo(()=>i_(ln,Rr,cn),[ln,Rr,cn]),Ur=k.useMemo(()=>{const T=new Map;return[...s,...l].forEach(H=>{const oe=vi(H.datePurchased||H.DatePurchased);if(!oe)return;const ye=Ca(oe);T.has(ye)||T.set(ye,[]),T.get(ye).push({id:H.id||H.Title||H.title||ye,title:H.title||H.Title||"Untitled"})}),T.forEach(H=>H.sort((oe,ye)=>(oe.title||"").localeCompare(ye.title||""))),T},[s,l]),rs=k.useMemo(()=>{const{year:T,month:V}=On,oe=new Date(T,V,1).getDay(),ye=new Date(T,V+1,0).getDate();let Ue=!1;const Ie=[];for(let ct=0;ct<oe;ct+=1)Ie.push({type:"pad"});for(let ct=1;ct<=ye;ct+=1){const mt=new Date(T,V,ct),Dt=Ca(mt),Et=Ur.get(Dt)||[];Et.length&&(Ue=!0),Ie.push({type:"day",day:ct,dateKey:Dt,items:Et,releases:Et,isToday:Dt===cn})}const Ke=Math.ceil(Ie.length/7)*7;for(;Ie.length<Ke;)Ie.push({type:"pad"});return{cells:Ie,hasItems:Ue}},[On,Ur,cn]),gn=k.useMemo(()=>{if(!s||!s.length)return[];const T=new Map;s.forEach(H=>{const oe=Td(H)||H.id,ye=YR(H);T.has(oe)||T.set(oe,{seriesKey:oe,displayName:ye,books:[]}),T.get(oe).books.push(H)});const V=Array.from(T.values()).map(H=>({...H,books:[...H.books].sort(JR)}));return V.sort((H,oe)=>H.displayName.localeCompare(oe.displayName)),V},[s]),Hs=k.useMemo(()=>gn.flatMap(T=>T.books.map(V=>V.id)),[gn]);k.useEffect(()=>{we&&(s.some(T=>T.id===we)||Ee(null))},[s,we]),k.useEffect(()=>{ne&&(gn.some(T=>T.seriesKey===ne)||xe(null))},[gn,ne]),k.useEffect(()=>{if(!le.size)return;const T=new Set(s.map(H=>H.id)),V=Array.from(le).filter(H=>!T.has(H));V.length&&Re(H=>{const oe=new Set(H);return V.forEach(ye=>oe.delete(ye)),oe})},[s,le]),k.useEffect(()=>{const T=Array.from(le);if(!T.length){O("");return}const V=Array.from(new Set(T.map(H=>s.find(oe=>oe.id===H)).filter(Boolean).map(H=>{const oe=H.amountPaid??H.AmountPaid??"";return oe==null?"":String(oe)})));O(V.length===1?V[0]:"")},[le,s]),k.useEffect(()=>{const T=gn.find(_t=>_t.seriesKey===ne);if(!T){b(cf());return}const V=T.books,H=_t=>{const en=Array.from(new Set(V.map(Xn=>{const zr=_t(Xn);return zr==null?"":String(zr).trim()})));return en.length===1?en[0]:""},oe=H(_t=>_t.publisher||_t.Publisher),ye=H(_t=>_t.demographic||_t.Demographic),Ue=H(_t=>_t.genre||_t.Genre),Ie=H(_t=>_t.subGenre||_t.SubGenre),Ke=H(_t=>_t.msrp??_t.MSRP),ct=Array.from(new Set(V.map(_t=>(_t.datePurchased||_t.DatePurchased||"").trim()).filter(Boolean))),mt=ct.length>1,Dt=mt?"":ct[0]||"",Et=V.filter(_t=>!!_t.read||_t.status==="Read"||_t.Read===!0).length,Zt=Et===V.length&&V.length>0;b({publisher:oe,demographic:ye,genre:Ue,subGenre:Ie,datePurchased:Dt,msrp:Ke,initialPublisher:oe,initialDemographic:ye,initialGenre:Ue,initialSubGenre:Ie,initialDatePurchased:Dt,initialMsrp:Ke,dateMixed:mt,readChecked:Zt,readIndeterminate:!Zt&&!(Et===0)})},[gn,ne]),k.useEffect(()=>{B.current&&(B.current.indeterminate=D.readIndeterminate)},[D.readIndeterminate]),k.useEffect(()=>{const T=s.find(H=>H.id===we);if(!T){$e(t_());return}const V=!!T.read||T.status==="Read"||T.Read===!0;$e({read:V,datePurchased:T.datePurchased||T.DatePurchased||"",dateRead:V&&(T.dateRead||T.DateRead)||"",pageCount:T.pageCount??T.PageCount??T.pages??T.Pages??"",msrp:T.msrp??T.MSRP??"",amountPaid:T.amountPaid??T.AmountPaid??"",rating:V?T.rating??T.Rating??"":"",special:!!(T.specialType||T.SpecialType),specialType:T.specialType??T.SpecialType??"",specialVolumes:T.specialVolumes??T.SpecialVolumes??"",collectiblePrice:T.collectiblePrice??T.CollectiblePrice??"",publisher:T.publisher||T.Publisher||"",demographic:T.demographic||T.Demographic||"",genre:T.genre||T.Genre||""})},[we,s]),k.useEffect(()=>{if(!Yn||!Yn.length)return;const T=In-1,V=Yn.reduce((Ue,Ie)=>Ue+Ie.value,0);if(!V||(pn.current?parseInt(pn.current,10):null)===T)return;const oe=Yn.map(Ue=>`${Ue.label}: ${Ue.value}`).join(", "),ye=`Yearly reads summary for ${T}: ${V} total. Breakdown: ${oe}`;s_(U.yearly,ye).then(()=>{pn.current=String(T),typeof window<"u"&&localStorage.setItem("dashboard-yearly-posted",String(T))})},[Yn,In]),k.useEffect(()=>{if(!Jn||!tt.length)return;const T=Ca(Jn.date),V=Ca(new Date);if(T>V||es.current===T)return;const H=tt.filter(ye=>Ca(ye.date)===T);if(!H.length)return;const oe=`Wishlist releases for ${T}:
${H.map(ye=>`- ${ye.title}`).join(`
`)}`;s_(U.release,oe).then(()=>{es.current=T,typeof window<"u"&&localStorage.setItem("dashboard-release-posted",T)})},[Jn,tt]),k.useEffect(()=>{if(!Mt){I("-");return}const T=()=>{const H=Mt-new Date;if(H<=0){I("Released");return}const oe=Math.floor(H/1e3),ye=Math.floor(oe/86400),Ue=Math.floor(oe%86400/3600).toString().padStart(2,"0"),Ie=Math.floor(oe%3600/60).toString().padStart(2,"0"),Ke=Math.floor(oe%60).toString().padStart(2,"0");I(`${ye}d ${Ue}:${Ie}:${Ke}`)};T();const V=setInterval(T,1e3);return()=>clearInterval(V)},[Mt]),k.useEffect(()=>{if(!(typeof window>"u"))try{const T=localStorage.getItem($p);if(!T)return;const V=JSON.parse(T);if(!Array.isArray(V))return;const H=V.map(oe=>({message:oe.message,ts:oe.ts?new Date(oe.ts):new Date})).filter(oe=>oe.message);H.length&&He(H)}catch(T){console.warn("Failed to load activity log",T)}},[]);const qs=async()=>{try{const T=await ai(ir(lt,"library"));a(T.docs.map(V=>({id:V.id,...V.data()})))}catch(T){console.error("Failed to refresh library",T),w(V=>V||"Failed to refresh library data.")}},ut=T=>{const V=(T??"").toString().trim();if(V==="")return"";const H=parseFloat(V);return Number.isFinite(H)?H:""},ss=T=>{const V=(T??"").toString().trim();if(V==="")return"";const H=parseInt(V,10);return Number.isFinite(H)?H:""},An=T=>{if(!T)return;const V={message:T,ts:new Date};He(H=>{const oe=[V,...H].slice(0,100);return Hw(oe),oe}),qw(T,{email:(n==null?void 0:n.email)||"anonymous",name:(n==null?void 0:n.displayName)||"",webhookOverride:U.activity,persistLocal:!1})},x=T=>{M(V=>{const H=new Set(V);return H.has(T)?H.delete(T):H.add(T),H}),xe(T),Ee(null)},$=(T,V,H)=>{const oe=T.metaKey||T.ctrlKey,ye=T.shiftKey,Ue=Hs.indexOf(V);let Ie=new Set(le);if(ye&&A!==null&&Ue!==-1){const Ke=Math.min(A,Ue),ct=Math.max(A,Ue);for(let mt=Ke;mt<=ct;mt+=1){const Dt=Hs[mt];Dt&&Ie.add(Dt)}}else oe?Ie.has(V)?Ie.delete(V):Ie.add(V):Ie=new Set;Re(Ie),P(Ue),Ee(V),xe(H),M(Ke=>{const ct=new Set(Ke);return ct.add(H),ct})},z=()=>{Re(new Set),P(null)},L=async()=>{if(!e){alert("Dashboard is read-only for your account.");return}const T=Array.from(le);if(!T.length){alert("Select books in Library Manager (use Ctrl/Cmd or Shift) before bulk editing.");return}const V=(R||"").toString().trim(),H=V!=="",oe=ut(V);if(H&&oe===""){alert("Enter a valid number for Amount Paid.");return}try{await Promise.all(T.map(ye=>Ds(Lt(lt,"library",ye),{amountPaid:H?oe:""}))),await qs(),z(),An(`Updated amount paid for ${T.length} book${T.length===1?"":"s"} in library`),alert(`Applied Amount Paid to ${T.length} selection${T.length===1?"":"s"}.`)}catch(ye){console.error("Failed to apply Amount Paid",ye),alert("Failed to apply Amount Paid to selection.")}},q=async()=>{if(!e){alert("Dashboard is read-only for your account.");return}const T=gn.find(Et=>Et.seriesKey===ne);if(!T||!T.books.length)return;const V=!D.readIndeterminate,H=!!D.readChecked,oe=D.datePurchased!==D.initialDatePurchased,ye=D.msrp!==D.initialMsrp,Ue=D.publisher!==D.initialPublisher,Ie=D.demographic!==D.initialDemographic,Ke=D.genre!==D.initialGenre,ct=D.subGenre!==D.initialSubGenre;if(!V&&!oe&&!ye&&!Ue&&!Ie&&!Ke&&!ct)return;const mt=String(D.msrp??"").trim(),Dt=ye?ut(mt):"";if(ye&&mt!==""&&Dt===""){alert("Enter a valid number for MSRP.");return}try{const Et=[];if(T.books.forEach(Zt=>{const vn={};V&&(vn.read=H,vn.dateRead=H?Zt.dateRead||Zt.DateRead||new Date().toISOString().slice(0,10):""),oe&&(vn.datePurchased=D.datePurchased||""),ye&&(vn.msrp=D.msrp===""?"":Dt),Ue&&(vn.publisher=D.publisher||""),Ie&&(vn.demographic=D.demographic||""),Ke&&(vn.genre=D.genre||""),ct&&(vn.subGenre=D.subGenre||""),Object.keys(vn).length&&Et.push(Ds(Lt(lt,"library",Zt.id),vn))}),!Et.length)return;await Promise.all(Et),await qs(),Ee(null),An(`Updated series "${T.displayName||"Series"}" (${T.books.length} book${T.books.length===1?"":"s"})`),alert("Series updated.")}catch(Et){console.error("Failed to save series changes",Et),alert("Failed to update series.")}},ie=async()=>{if(!e){alert("Dashboard is read-only for your account.");return}if(!we)return;const T=!!he.read,V=String(he.msrp??"").trim(),H=String(he.amountPaid??"").trim(),oe=String(he.pageCount??"").trim(),ye=String(he.rating??"").trim(),Ue=ut(V),Ie=ut(H),Ke=ss(oe),ct=ut(ye);if(V!==""&&Ue===""){alert("Enter a valid number for MSRP.");return}if(H!==""&&Ie===""){alert("Enter a valid number for Amount Paid.");return}if(oe!==""&&Ke===""){alert("Enter a valid page count.");return}if(T&&ye!==""&&ct===""){alert("Enter a valid rating.");return}const mt=!!he.special,Dt=ss(he.specialVolumes),Et=ut(he.collectiblePrice),Zt=String(he.specialVolumes??"").trim(),vn=String(he.collectiblePrice??"").trim();if(mt&&he.specialType==="specialEdition"&&Zt!==""&&Dt===""){alert("Enter a valid number for volumes contained.");return}if(mt&&he.specialType==="collectible"&&vn!==""&&Et===""){alert("Enter a valid collectible price.");return}const _t=T?he.dateRead||new Date().toISOString().slice(0,10):"",en={read:T,datePurchased:he.datePurchased||"",dateRead:_t,msrp:he.msrp===""?"":Ue,amountPaid:he.amountPaid===""?"":Ie,pageCount:he.pageCount===""?"":Ke,rating:T?he.rating===""?"":ct:"",specialType:mt&&he.specialType||"",specialVolumes:mt&&he.specialType==="specialEdition"?he.specialVolumes===""?"":Dt:"",collectiblePrice:mt&&he.specialType==="collectible"?he.collectiblePrice===""?"":Et:""};try{await Ds(Lt(lt,"library",we),en),await qs();const Xn=s.find(Nr=>Nr.id===we)||Ne,zr=(Xn==null?void 0:Xn.Title)||(Xn==null?void 0:Xn.title)||"Untitled";An(`Updated "${zr}" in library`),alert("Saved changes.")}catch(Xn){console.error("Failed to save book changes",Xn),alert("Failed to save changes.")}},se=()=>{xe(null),Ee(null),z(),b(cf())},Se=()=>{Ee(null),P(null)},Ce=gn.find(T=>T.seriesKey===ne)||null,Ne=s.find(T=>T.id===we)||null,ae=ne?{msrp:!D.msrp,datePurchased:!D.datePurchased&&!D.dateMixed,publisher:!D.publisher,demographic:!D.demographic,genre:!D.genre}:{},it=we?XR({amountPaid:he.amountPaid,msrp:he.msrp,datePurchased:he.datePurchased,publisher:(Ne==null?void 0:Ne.publisher)||(Ne==null?void 0:Ne.Publisher)||"",demographic:(Ne==null?void 0:Ne.demographic)||(Ne==null?void 0:Ne.Demographic)||"",genre:(Ne==null?void 0:Ne.genre)||(Ne==null?void 0:Ne.Genre)||"",special:he.special,specialType:he.specialType,specialVolumes:he.specialVolumes,collectiblePrice:he.collectiblePrice,pageCount:he.pageCount}):{};if(t)return c.jsx("div",{className:"page dashboard-page",children:c.jsxs("div",{className:"dashboard-loading",children:[c.jsx("h1",{children:"Dashboard"}),c.jsx("p",{children:"Checking permissions..."})]})});if(!n||!e)return c.jsx("div",{className:"page dashboard-page",children:c.jsxs("div",{className:"dashboard-locked",children:[c.jsx("h1",{children:"Dashboard"}),c.jsx("p",{children:"This area is restricted to admin accounts."})]})});if(f)return c.jsx("div",{className:"page dashboard-page",children:c.jsxs("div",{className:"dashboard-loading",children:[c.jsx("h1",{children:"Dashboard"}),v?c.jsx("p",{className:"error",children:v}):c.jsx("p",{children:"Loading stats..."})]})});const ke=pr+br,dt=ke?Math.round(pr/ke*100):0,cr=[...bn.values()].filter(T=>T.ratingCount>0).map(T=>({title:T.title,avg:T.ratingSum/T.ratingCount,count:T.ratingCount})).sort((T,V)=>V.avg-T.avg||V.count-T.count).slice(0,3);function Ks(){if(Mt)jt(new Date(Mt.getFullYear(),Mt.getMonth(),1));else if(tt.length){const T=tt[0].date;jt(new Date(T.getFullYear(),T.getMonth(),1))}kt(!0)}function yn(T){Zr({open:!0,type:T})}function Yt(){Zr({open:!1,type:null})}const is=i_(St,tt,cn),as=T=>{lr(V=>{const H=new Date(V.year,V.month+T,1);return{year:H.getFullYear(),month:H.getMonth()}})},os=T=>{fr(V=>new Date(V.getFullYear(),V.getMonth()+T,1))},bt=()=>{$t(!1),Mn(null)},Ss=()=>{const T=Array.from(Ur.keys()).sort();if(T.length){const V=T[T.length-1],[H,oe]=V.split("-"),ye=Number(H),Ue=Number(oe)-1;!Number.isNaN(ye)&&!Number.isNaN(Ue)&&lr({year:ye,month:Ue})}$t(!0)},ft=()=>{if(Rr.length){const T=Rr[Rr.length-1].date;fr(new Date(T.getFullYear(),T.getMonth(),1))}else fr(new Date);Sn(!0)};function Cs(){const T=Qt.type;if(!T)return null;if(T==="publishers"){const V=[...yo(bn,"publisher",100)];return c.jsxs(c.Fragment,{children:[c.jsx("h3",{children:"Top Publishers by Series"}),V.length===0?c.jsx("p",{children:"No publisher data yet."}):c.jsxs("table",{children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"#"}),c.jsx("th",{children:"Publisher"}),c.jsx("th",{children:"Series Count"})]})}),c.jsx("tbody",{children:V.map((H,oe)=>c.jsxs("tr",{children:[c.jsx("td",{children:oe+1}),c.jsx("td",{children:H.name}),c.jsx("td",{children:H.count})]},H.name+oe))})]})]})}if(T==="genres"){const V=[...yo(bn,"genre",100)];return c.jsxs(c.Fragment,{children:[c.jsx("h3",{children:"Top Genres by Series"}),V.length===0?c.jsx("p",{children:"No genre data yet."}):c.jsxs("table",{children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"#"}),c.jsx("th",{children:"Genre"}),c.jsx("th",{children:"Series Count"})]})}),c.jsx("tbody",{children:V.map((H,oe)=>c.jsxs("tr",{children:[c.jsx("td",{children:oe+1}),c.jsx("td",{children:H.name}),c.jsx("td",{children:H.count})]},H.name+oe))})]})]})}if(T==="demographics"){const V=[...yo(bn,"demographic",100)];return c.jsxs(c.Fragment,{children:[c.jsx("h3",{children:"Top Demographics by Series"}),V.length===0?c.jsx("p",{children:"No demographic data yet."}):c.jsxs("table",{children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"#"}),c.jsx("th",{children:"Demographic"}),c.jsx("th",{children:"Series Count"})]})}),c.jsx("tbody",{children:V.map((H,oe)=>c.jsxs("tr",{children:[c.jsx("td",{children:oe+1}),c.jsx("td",{children:H.name}),c.jsx("td",{children:H.count})]},H.name+oe))})]})]})}if(T==="timeToRead"){const V=ts||[];return c.jsxs(c.Fragment,{children:[c.jsx("h3",{children:"Average Time From Purchase to Read"}),Pn==null?c.jsx("p",{children:"Not enough volumes have both purchase and read dates to calculate this yet."}):c.jsxs(c.Fragment,{children:[c.jsxs("p",{children:["On average, it takes"," ",c.jsxs("strong",{children:[Pn.toFixed(1)," days"]})," from purchase to finishing a volume."]}),V.length>0?c.jsxs("table",{children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"Series"}),c.jsx("th",{children:"Avg Days"}),c.jsx("th",{children:"Longest"}),c.jsx("th",{children:"Shortest"}),c.jsx("th",{children:"Reads Count"})]})}),c.jsx("tbody",{children:V.map(H=>c.jsxs("tr",{children:[c.jsx("td",{children:H.title}),c.jsxs("td",{children:[H.avg.toFixed(1)," days"]}),c.jsxs("td",{children:[Math.round(H.max)," days"]}),c.jsxs("td",{children:[Math.round(H.min)," days"]}),c.jsx("td",{children:H.count})]},H.key))})]}):c.jsx("p",{style:{marginTop:8},children:"No series-level data yet."})]})]})}if(T==="collectionValue"){const{msrpTotal:V,paidTotal:H}=Rn,oe=V-H,ye=V>0?(H/V*100).toFixed(1):"-",Ue=[...Fr].filter(Ie=>Ie.msrp||Ie.paid||Ie.collectible).sort((Ie,Ke)=>Ke.msrp+Ke.collectible-(Ie.msrp+Ie.collectible));return c.jsxs(c.Fragment,{children:[c.jsx("h3",{children:"Collection Value Breakdown"}),c.jsx("table",{children:c.jsxs("tbody",{children:[c.jsxs("tr",{children:[c.jsx("th",{children:"Total MSRP"}),c.jsxs("td",{children:["$",V.toFixed(2)]})]}),c.jsxs("tr",{children:[c.jsx("th",{children:"Total Paid"}),c.jsxs("td",{children:["$",H.toFixed(2)]})]}),c.jsxs("tr",{children:[c.jsx("th",{children:"Difference"}),c.jsxs("td",{children:["$",oe.toFixed(2)]})]}),c.jsxs("tr",{children:[c.jsx("th",{children:"Paid vs MSRP"}),c.jsx("td",{children:ye==="-"?"-":`${ye}%`})]})]})}),Ue.length>0&&c.jsxs(c.Fragment,{children:[c.jsx("h4",{style:{marginTop:"14px"},children:"Collection Pricing"}),c.jsxs("table",{children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"Title"}),c.jsx("th",{children:"MSRP"}),c.jsx("th",{children:"Paid"}),c.jsx("th",{children:"Collectible"}),c.jsx("th",{children:"Books"})]})}),c.jsx("tbody",{children:Ue.map((Ie,Ke)=>c.jsxs("tr",{children:[c.jsx("td",{children:Ie.title}),c.jsxs("td",{children:["$",Ie.msrp.toFixed(2)]}),c.jsxs("td",{children:["$",Ie.paid.toFixed(2)]}),c.jsx("td",{children:Ie.collectible?`$${Ie.collectible.toFixed(2)}`:"--"}),c.jsx("td",{children:Ie.books})]},Ie.title+Ke))})]})]})]})}if(T==="pages"){const V=[...Fr].filter(H=>H.pages>0).map(H=>({...H,pct:H.pages?Math.round(H.readPages/H.pages*100):0})).sort((H,oe)=>oe.pages-H.pages);return c.jsxs(c.Fragment,{children:[c.jsx("h3",{children:"Pages Read vs Total"}),c.jsx("table",{children:c.jsxs("tbody",{children:[c.jsxs("tr",{children:[c.jsx("th",{children:"Total Pages"}),c.jsx("td",{children:mn.total.toLocaleString()})]}),c.jsxs("tr",{children:[c.jsx("th",{children:"Pages Read"}),c.jsx("td",{children:mn.read.toLocaleString()})]}),c.jsxs("tr",{children:[c.jsx("th",{children:"Completion"}),c.jsx("td",{children:mn.total?`${(mn.read/mn.total*100).toFixed(1)}%`:"-"})]})]})}),V.length>0&&c.jsxs(c.Fragment,{children:[c.jsx("h4",{style:{marginTop:"14px"},children:"Pages by Series"}),c.jsxs("table",{children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"Title"}),c.jsx("th",{children:"Read Pages"}),c.jsx("th",{children:"Total Pages"}),c.jsx("th",{children:"% Read"}),c.jsx("th",{children:"Books"})]})}),c.jsx("tbody",{children:V.map((H,oe)=>c.jsxs("tr",{children:[c.jsx("td",{children:H.title}),c.jsx("td",{children:H.readPages.toLocaleString()}),c.jsx("td",{children:H.pages.toLocaleString()}),c.jsxs("td",{children:[H.pct,"%"]}),c.jsx("td",{children:H.books})]},H.title+oe))})]})]})]})}if(T==="ratings"){const V=[...Fr].map(H=>{if(!H.ratings.length)return null;const oe=H.ratings.reduce((ye,Ue)=>ye+Ue,0)/H.ratings.length;return{title:H.title,avg:oe,count:H.ratings.length}}).filter(Boolean).sort((H,oe)=>oe.avg-H.avg||oe.count-H.count);return c.jsxs(c.Fragment,{children:[c.jsx("h3",{children:"Ratings Overview"}),Nn==null?c.jsx("p",{children:"No ratings have been recorded yet."}):c.jsxs("p",{children:["Average series rating across rated series is"," ",c.jsx("strong",{children:Nn.toFixed(2)}),"."]}),V.length>0&&c.jsxs(c.Fragment,{children:[c.jsx("h4",{style:{marginTop:"14px"},children:"Series Averages"}),c.jsxs("table",{children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"Title"}),c.jsx("th",{children:"Avg"}),c.jsx("th",{children:"Ratings"})]})}),c.jsx("tbody",{children:V.map((H,oe)=>c.jsxs("tr",{children:[c.jsx("td",{children:H.title}),c.jsx("td",{children:H.avg.toFixed(2)}),c.jsx("td",{children:H.count})]},H.title+oe))})]})]})]})}return T==="releases"?c.jsxs(c.Fragment,{children:[c.jsx("h3",{children:"Library & Wishlist Releases"}),tt.length===0?c.jsx("p",{children:"No wishlist releases found."}):c.jsxs("table",{children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"Date"}),c.jsx("th",{children:"Title"})]})}),c.jsx("tbody",{children:tt.map((V,H)=>c.jsxs("tr",{children:[c.jsx("td",{children:V.date.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}),c.jsx("td",{children:V.title})]},H))})]})]}):null}return c.jsxs("div",{className:"page dashboard-page",children:[c.jsxs("header",{className:"dashboard-header",style:{display:"flex",alignItems:"center",justifyContent:"center",position:"relative",textAlign:"center",width:"100%"},children:[c.jsxs("div",{style:{textAlign:"center",margin:"0 auto",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"0 60px"},children:[c.jsx("h1",{style:{margin:0,fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Dashboard"}),c.jsx("p",{className:"dashboard-sub",style:{textAlign:"center",margin:"6px 0 0"},children:"My Entire Statistics dashboard for my Manga. I still use Excel though."})]}),e&&c.jsx("div",{style:{position:"absolute",right:0,top:"50%",transform:"translateY(-50%)"},children:c.jsx("button",{className:"stat-link",onClick:()=>De(!0),type:"button",children:"Admin Settings"})})]}),c.jsx("section",{id:"dashboardSection",className:"page-section active",children:c.jsxs("div",{className:"dashboard-grid",children:[c.jsxs("div",{className:"stat-stack",children:[c.jsxs("div",{className:"stat-card mini clickable",onClick:Ss,children:[c.jsx("h3",{children:"Total Library Books"}),c.jsx("div",{className:"stat-value",children:pr}),c.jsx("div",{className:"stat-sub",children:"Volumes in your library."})]}),c.jsxs("div",{className:"stat-card mini",children:[c.jsx("h3",{children:"Wishlist Items"}),c.jsx("div",{className:"stat-value",children:br}),c.jsx("div",{className:"stat-sub",children:"Tracked upcoming wants."})]})]}),c.jsxs("div",{className:"stat-card clickable",onClick:ft,role:"button",tabIndex:0,onKeyDown:T=>{(T.key==="Enter"||T.key===" ")&&(T.preventDefault(),ft())},children:[c.jsx("h3",{children:"Read / Unread"}),c.jsx("div",{className:"pie",style:{"--pct":`${Qn*3.6}deg`},children:c.jsxs("div",{className:"pie-label",children:[Qn,"%"]})}),c.jsxs("div",{className:"stat-value",children:[xs," read / ",Kn," unread"]})]}),c.jsxs("div",{className:"stat-card clickable",onClick:()=>yn("ratings"),children:[c.jsx("h3",{children:"Ratings"}),c.jsx("div",{className:"stat-value",children:Nn==null?"-":Nn.toFixed(2)}),c.jsx("div",{className:"stat-sub",children:"Average across rated series."}),c.jsx("div",{className:"stat-list compact",children:cr.length?cr.map((T,V)=>c.jsxs("div",{className:"stat-list-row",children:[c.jsx("span",{className:"stat-rank",children:V+1}),c.jsx("span",{className:"stat-name",children:T.title}),c.jsx("span",{className:"stat-count",children:T.avg.toFixed(2)})]},T.title+V)):c.jsx("div",{className:"stat-sub",children:"No ratings yet."})})]}),c.jsxs("div",{className:"stat-card clickable",onClick:()=>yn("pages"),children:[c.jsx("h3",{children:"Page Count Read / Total"}),c.jsxs("div",{className:"stat-value",children:[mn.read.toLocaleString()," / ",mn.total.toLocaleString()]}),c.jsx("div",{className:"stat-sub",children:mn.total?`${(mn.read/mn.total*100).toFixed(1)}% read`:"-"})]}),c.jsxs("div",{className:"stat-card",children:[c.jsx("h3",{children:"Library vs Wishlist"}),c.jsx("div",{className:"pie",style:{"--pct":`${dt*3.6}deg`},children:c.jsxs("div",{className:"pie-label",children:[dt,"%"]})}),c.jsxs("div",{className:"stat-value",children:[pr," / ",br]}),c.jsx("div",{className:"stat-sub",children:"Library vs wishlist share"})]}),c.jsxs("div",{className:"stat-card clickable",onClick:()=>yn("demographics"),children:[c.jsx("h3",{children:"Top Demographics"}),c.jsx("div",{className:"stat-list",children:Fn.length?Fn.slice(0,3).map((T,V)=>c.jsxs("div",{className:"stat-list-row",children:[c.jsx("span",{className:"stat-rank",children:V+1}),c.jsx("span",{className:"stat-name",children:T.name}),c.jsx("span",{className:"stat-count",children:T.count})]},T.name)):c.jsx("div",{className:"stat-sub",children:"No demographic data yet."})})]}),c.jsxs("div",{className:"stat-card clickable",onClick:()=>yn("publishers"),children:[c.jsx("h3",{children:"Top Publishers"}),c.jsx("div",{className:"stat-list",children:Es.length?Es.slice(0,3).map((T,V)=>c.jsxs("div",{className:"stat-list-row",children:[c.jsx("span",{className:"stat-rank",children:V+1}),c.jsx("span",{className:"stat-name",children:T.name}),c.jsx("span",{className:"stat-count",children:T.count})]},T.name)):c.jsx("div",{className:"stat-sub",children:"No publisher data yet."})})]}),c.jsxs("div",{className:"stat-card clickable",onClick:()=>yn("genres"),children:[c.jsx("h3",{children:"Top Genres"}),c.jsx("div",{className:"stat-list",children:Ts.length?Ts.slice(0,3).map((T,V)=>c.jsxs("div",{className:"stat-list-row",children:[c.jsx("span",{className:"stat-rank",children:V+1}),c.jsx("span",{className:"stat-name",children:T.name}),c.jsx("span",{className:"stat-count",children:T.count})]},T.name)):c.jsx("div",{className:"stat-sub",children:"No genre data yet."})})]}),c.jsxs("div",{className:"stat-card clickable",onClick:()=>{Ks()},children:[c.jsx("h3",{children:"Next Wishlist Release"}),c.jsx("div",{className:"stat-value next-release",children:Jn?Jn.title:"No upcoming releases"}),c.jsxs("div",{className:"stat-sub",children:[Mt?Mt.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"}):"-",c.jsx("br",{}),c.jsx("span",{id:"statNextCountdown",children:S})]})]}),c.jsxs("div",{className:"stat-card clickable",onClick:()=>yn("collectionValue"),style:{textAlign:"center"},children:[c.jsx("h3",{children:"Collection Pricing"}),c.jsxs("div",{className:"stat-value stat-msrp",children:["$",Rn.msrpTotal.toFixed(2)]}),c.jsxs("div",{className:"stat-value stat-paid",children:["$",Rn.paidTotal.toFixed(2),Rn.msrpTotal>0&&c.jsxs("span",{className:"stat-paid-pct",children:["(",((1-Rn.paidTotal/Rn.msrpTotal)*100).toFixed(1),"% off)"]})]}),c.jsxs("div",{className:"stat-value stat-collectible",children:["$",Rn.collectibleTotal.toFixed(2)]}),c.jsx("div",{className:"stat-sub",children:"MSRP  Paid  Collectible overrides"})]}),c.jsxs("div",{className:"stat-card",children:[c.jsx("h3",{children:"Current Year Reads"}),c.jsx("div",{className:"stat-value",children:$s}),c.jsxs("div",{className:"stat-sub",children:["Reads in ",In]})]}),c.jsxs("div",{className:"stat-card clickable",onClick:()=>yn("timeToRead"),children:[c.jsx("h3",{children:"Avg Days From Purchase to Read"}),c.jsx("div",{className:"stat-value",children:Pn==null?"-":`${Pn.toFixed(1)} days`}),c.jsx("div",{className:"stat-sub",children:"When both dates exist"})]}),c.jsxs("div",{className:"stat-duo",children:[c.jsxs("div",{className:"stat-card tall",children:[c.jsxs("h3",{children:["Reads Per Month (",In,")"]}),c.jsx(dN,{data:Pr})]}),c.jsxs("div",{className:"stat-card tall",children:[c.jsx("h3",{children:"Reads by Day of Week (Lifetime)"}),c.jsx(hN,{data:mr}),c.jsx("div",{className:"stat-sub",children:"Based on all entries with a read date."})]})]}),c.jsxs("div",{className:"stat-card wide",children:[c.jsx("h3",{children:"Activity Log"}),ns&&c.jsx("div",{className:"error",style:{textAlign:"center"},children:v}),c.jsx("div",{className:"activity-log scrollable",children:Ae.length?Ae.map((T,V)=>{const H=T.ts?new Date(T.ts):null;return c.jsxs("div",{className:"activity-row",children:[c.jsx("span",{className:"activity-title",children:T.message}),c.jsx("span",{className:"activity-date",children:H?H.toLocaleString(void 0,{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}):""})]},(T.message||"activity")+V)}):c.jsx("div",{className:"stat-sub",children:"No recent activity yet."})})]}),c.jsxs("div",{className:"stat-card wide",style:{minHeight:"340px",maxHeight:"480px"},children:[c.jsx("h3",{children:"Suggestions"}),qe&&c.jsx("div",{className:"error",style:{textAlign:"center"},children:qe}),c.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",alignItems:"stretch"},children:["anime","manga"].map(T=>{const V=ee.filter(H=>(H.type||"").toLowerCase()===T).sort((H,oe)=>{var ye,Ue,Ie,Ke;return(((Ue=(ye=oe.createdAt)==null?void 0:ye.getTime)==null?void 0:Ue.call(ye))||0)-(((Ke=(Ie=H.createdAt)==null?void 0:Ie.getTime)==null?void 0:Ke.call(Ie))||0)});return c.jsxs("div",{style:{border:"1px solid rgba(255,182,193,0.18)",borderRadius:"16px",padding:"10px 12px",display:"flex",flexDirection:"column",background:"rgba(255,182,193,0.04)",minHeight:"240px"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"8px",position:"relative"},children:[c.jsx("h4",{style:{margin:0,color:"#ffb6c1",textAlign:"center",flex:1},children:T==="anime"?"Anime":"Manga"}),c.jsxs("span",{className:"stat-sub",style:{position:"absolute",right:0},children:[V.length," suggestion",V.length===1?"":"s"]})]}),c.jsx("div",{className:"scrollable",style:{maxHeight:"280px",height:"280px",paddingRight:"4px",overflowY:"auto"},children:_e?c.jsx("div",{className:"stat-sub",children:"Loading suggestions..."}):V.length?V.map(H=>{const oe=H.createdAt instanceof Date?H.createdAt:H.createdAt?new Date(H.createdAt):null;return c.jsxs("div",{style:{border:"1px solid rgba(255,182,193,0.25)",borderRadius:"12px",padding:"8px 10px",marginBottom:"8px",background:"rgba(255,182,193,0.06)",display:"grid",gridTemplateColumns:"1fr auto",gap:"6px",alignItems:"center"},children:[c.jsxs("div",{children:[c.jsx("div",{style:{fontWeight:600,color:"#f7d0dc"},children:H.content||"(no content)"}),c.jsxs("div",{className:"stat-sub",style:{fontSize:"0.8rem"},children:[oe?oe.toLocaleString(void 0,{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}):""," ",H.from?` ${H.from}`:""]})]}),c.jsx("div",{style:{display:"flex",gap:"6px"},children:e&&c.jsx("button",{type:"button",className:"stat-link",onClick:()=>ws(H.id),children:"Delete"})})]},H.id)}):c.jsx("div",{className:"stat-sub",children:"No suggestions yet."})})]},T)})}),c.jsxs("div",{className:"stat-sub",style:{marginTop:"8px",textAlign:"center"},children:["Total suggestions: ",ee.length]})]}),c.jsxs("div",{className:"stat-card wide",children:[c.jsx("h3",{children:"Library Manager"}),gn.length?c.jsxs("div",{className:"dash-library",children:[c.jsxs("div",{className:"dash-library-list",children:[gn.map(T=>{const V=T.books.filter(Ie=>!!Ie.read||Ie.status==="Read"||Ie.Read===!0).length,H=Q.has(T.seriesKey),oe=ne===T.seriesKey&&!we,ye=ZR(T),Ue=T.books.some(Ie=>n_(Ie));return c.jsxs("div",{style:{marginBottom:"8px"},children:[c.jsxs("button",{type:"button",onClick:()=>x(T.seriesKey),style:{width:"100%",textAlign:"left",background:ye?"rgba(255,179,71,0.08)":"transparent",border:`1px solid ${oe?"#ff69b4":ye?"rgba(255,179,71,0.6)":"rgba(255,182,193,0.25)"}`,color:"#ffb6c1",padding:"8px",borderRadius:"8px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"8px",position:"relative",boxShadow:ye?"0 0 10px rgba(255,179,71,0.5)":oe?"0 0 8px rgba(255,105,180,0.5)":"none"},children:[c.jsx("span",{style:{transition:"transform 0.2s ease",transform:H?"rotate(90deg)":"none"},children:">"}),c.jsx("span",{style:{flex:1},children:T.displayName}),c.jsxs("span",{style:{fontSize:"11px",color:"#f8d1d8"},children:[T.books.length," book",T.books.length===1?"":"s",T.books.length?` | ${V} read`:""]}),Ue&&c.jsx("span",{title:"Some volumes are missing required data",style:{width:"12px",height:"12px",borderRadius:"999px",background:"#ffb347",border:"1px solid rgba(255,255,255,0.25)",boxShadow:"0 0 10px rgba(255,179,71,0.6)"}})]}),c.jsx("div",{style:{margin:"6px 0 10px 10px",paddingLeft:"10px",borderLeft:"1px solid rgba(255,182,193,0.25)",display:H?"block":"none"},children:T.books.map(Ie=>{const Ke=we===Ie.id,ct=le.has(Ie.id);Ie.read||Ie.status==="Read"||Ie.Read;const mt=n_(Ie,{ignoreShared:!0});return c.jsxs("button",{type:"button",onClick:Dt=>$(Dt,Ie.id,T.seriesKey),style:{width:"100%",textAlign:"left",background:mt?"rgba(255,179,71,0.1)":"transparent",border:`1px solid ${Ke?"#ff69b4":ct?"#fff59d":mt?"rgba(255,179,71,0.6)":"rgba(255,182,193,0.25)"}`,color:"#ffb6c1",padding:"8px",borderRadius:"8px",marginBottom:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"8px",boxShadow:Ke?"0 0 8px rgba(255,105,180,0.5)":ct?"0 0 10px rgba(255,255,180,0.65)":mt?"0 0 10px rgba(255,179,71,0.5)":"none"},children:[c.jsx("span",{style:{flex:1,minWidth:0},children:Ie.Title||Ie.title||"Untitled"}),mt&&c.jsx("span",{style:{flexShrink:0,padding:"2px 8px",borderRadius:"999px",background:"rgba(255,179,71,0.18)",border:"1px solid rgba(255,179,71,0.6)",color:"#ffd8a1",fontSize:"11px",fontWeight:700,whiteSpace:"nowrap"},children:"Missing data"})]},Ie.id)})})]},T.seriesKey)}),gn.length>0&&le.size>0&&c.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:c.jsx("button",{type:"button",style:{padding:"6px 12px",borderRadius:"999px",border:"1px solid #ffb6c1",background:"transparent",color:"#ffb6c1",cursor:"pointer"},onClick:z,children:"Clear Selection"})})]}),c.jsxs("div",{className:"dash-library-details",children:[le.size>0&&c.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px",padding:"10px",marginBottom:"10px",border:"1px dashed rgba(255,182,193,0.45)",borderRadius:"10px",background:"rgba(255,182,193,0.08)"},children:[c.jsxs("div",{children:["Apply Amount Paid to ",le.size," selected book",le.size===1?"":"s"]}),c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",flexWrap:"wrap"},children:[c.jsx("input",{type:"number",step:"0.01",min:"0",value:R,onChange:T=>O(T.target.value),style:{maxWidth:"140px"}}),c.jsx("button",{type:"button",className:"dash-btn primary",onClick:L,children:"Apply to Selected"})]})]}),!ne&&!we&&c.jsx("div",{className:"stat-sub",style:{marginTop:6},children:"Select a series or book to edit"}),ne&&!we&&Ce&&c.jsxs("div",{children:[c.jsx("div",{className:"dash-detail-title",children:Ce.displayName}),c.jsx("div",{className:"dash-detail-row",children:c.jsxs("label",{className:"inline-checkbox",children:[c.jsx("input",{ref:B,type:"checkbox",checked:D.readChecked,onChange:T=>b(V=>({...V,readChecked:T.target.checked,readIndeterminate:!1}))}),c.jsx("span",{children:"Mark series as read"})]})}),c.jsxs("div",{className:`dash-detail-row${ae.publisher?" missing-row":""}`,children:[c.jsx("span",{children:"Publisher"}),c.jsx("input",{type:"text",value:D.publisher,onChange:T=>b(V=>({...V,publisher:T.target.value})),placeholder:"Set publisher for series"})]}),c.jsxs("div",{className:`dash-detail-row${ae.demographic?" missing-row":""}`,children:[c.jsx("span",{children:"Demographic"}),c.jsxs("select",{value:D.demographic,onChange:T=>b(V=>({...V,demographic:T.target.value})),children:[c.jsx("option",{value:"",children:"Select Demographic"}),c.jsx("option",{value:"Shounen",children:"Shounen"}),c.jsx("option",{value:"Seinen",children:"Seinen"}),c.jsx("option",{value:"Shoujo",children:"Shoujo"}),c.jsx("option",{value:"Josei",children:"Josei"})]})]}),c.jsxs("div",{className:`dash-detail-row${ae.genre?" missing-row":""}`,children:[c.jsx("span",{children:"Genre"}),c.jsx("input",{type:"text",value:D.genre,onChange:T=>b(V=>({...V,genre:T.target.value})),placeholder:"Primary genre"})]}),c.jsxs("div",{className:"dash-detail-row",children:[c.jsx("span",{children:"Sub-Genre"}),c.jsx("input",{type:"text",value:D.subGenre,onChange:T=>b(V=>({...V,subGenre:T.target.value})),placeholder:"Secondary genre / theme"})]}),!D.dateMixed&&c.jsxs("div",{className:`dash-detail-row${ae.datePurchased?" missing-row":""}`,children:[c.jsx("span",{children:"Date Purchased"}),c.jsx("input",{type:"date",value:D.datePurchased,onChange:T=>b(V=>({...V,datePurchased:T.target.value}))})]}),c.jsxs("div",{className:`dash-detail-row${ae.msrp?" missing-row":""}`,children:[c.jsx("span",{children:"MSRP (per book)"}),c.jsx("input",{type:"number",step:"0.01",min:"0",value:D.msrp,onChange:T=>b(V=>({...V,msrp:T.target.value})),placeholder:"0.00"})]}),c.jsxs("div",{className:"dash-detail-actions",children:[c.jsx("button",{type:"button",className:"dash-btn secondary",onClick:se,children:"Cancel"}),c.jsx("button",{type:"button",className:"dash-btn primary",onClick:q,children:"Save Series"})]})]}),we&&Ne&&c.jsxs("div",{children:[c.jsx("div",{className:"dash-detail-title",children:Ne.Title||Ne.title||"Untitled"}),c.jsx("div",{className:"dash-detail-row",children:c.jsxs("label",{className:"inline-checkbox",children:[c.jsx("input",{type:"checkbox",checked:!!he.read,onChange:T=>$e(V=>({...V,read:T.target.checked,dateRead:T.target.checked?V.dateRead||new Date().toISOString().slice(0,10):"",rating:T.target.checked?V.rating:""}))}),c.jsx("span",{children:"Mark as read"})]})}),c.jsxs("div",{className:`dash-detail-row${it.datePurchased?" missing-row":""}`,children:[c.jsx("span",{children:"Date Purchased"}),c.jsx("input",{type:"date",value:he.datePurchased,onChange:T=>$e(V=>({...V,datePurchased:T.target.value}))})]}),he.read&&c.jsxs("div",{className:"dash-detail-row",children:[c.jsx("span",{children:"Date Read"}),c.jsx("input",{type:"date",value:he.dateRead,onChange:T=>$e(V=>({...V,dateRead:T.target.value}))})]}),c.jsxs("div",{className:`dash-detail-row${it.pageCount?" missing-row":""}`,children:[c.jsx("span",{children:"Page Count"}),c.jsx("input",{type:"number",min:"0",step:"1",value:he.pageCount,onChange:T=>$e(V=>({...V,pageCount:T.target.value}))})]}),c.jsxs("div",{className:`dash-detail-row${it.msrp?" missing-row":""}`,children:[c.jsx("span",{children:"MSRP (per book)"}),c.jsx("input",{type:"number",step:"0.01",min:"0",value:he.msrp,onChange:T=>$e(V=>({...V,msrp:T.target.value})),placeholder:"0.00"})]}),!(he.special&&he.specialType==="collectible")&&c.jsxs("div",{className:`dash-detail-row${it.amountPaid?" missing-row":""}`,children:[c.jsx("span",{children:"Amount Paid"}),c.jsx("input",{type:"number",step:"0.01",min:"0",value:he.amountPaid,onChange:T=>$e(V=>({...V,amountPaid:T.target.value})),placeholder:"0.00"})]}),he.read&&c.jsxs("div",{className:"dash-detail-row",children:[c.jsx("span",{children:"Star Rating"}),c.jsx("input",{type:"number",min:"0",max:"5",step:"0.5",value:he.rating,onChange:T=>$e(V=>({...V,rating:T.target.value})),placeholder:"0-5"})]}),c.jsx("div",{className:`dash-detail-row${it.specialType?" missing-row":""}`,children:c.jsxs("label",{className:"inline-checkbox",style:{width:"100%"},children:[c.jsx("input",{type:"checkbox",checked:!!he.special,onChange:T=>$e(V=>({...V,special:T.target.checked,specialType:T.target.checked?V.specialType:"",specialVolumes:T.target.checked?V.specialVolumes:"",collectiblePrice:T.target.checked?V.collectiblePrice:""}))}),c.jsx("span",{children:"Special?"})]})}),he.special&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:`dash-detail-row${it.specialType?" missing-row":""}`,children:[c.jsx("span",{children:"Special Type"}),c.jsxs("select",{value:he.specialType,onChange:T=>$e(V=>({...V,specialType:T.target.value,specialVolumes:T.target.value==="specialEdition"?V.specialVolumes:"",collectiblePrice:T.target.value==="collectible"?V.collectiblePrice:""})),children:[c.jsx("option",{value:"",children:"Select type"}),c.jsx("option",{value:"specialEdition",children:"Special Edition"}),c.jsx("option",{value:"collectible",children:"Collectible"})]})]}),he.specialType==="specialEdition"&&c.jsxs("div",{className:`dash-detail-row${it.specialVolumes?" missing-row":""}`,children:[c.jsx("span",{children:"Volumes Contained"}),c.jsx("input",{type:"number",min:"1",step:"1",value:he.specialVolumes,onChange:T=>$e(V=>({...V,specialVolumes:T.target.value}))})]}),he.specialType==="collectible"&&c.jsxs("div",{className:`dash-detail-row${it.collectiblePrice?" missing-row":""}`,children:[c.jsx("span",{children:"Collectible Price"}),c.jsx("input",{type:"number",min:"0",step:"0.01",value:he.collectiblePrice,onChange:T=>$e(V=>({...V,collectiblePrice:T.target.value})),placeholder:"0.00"})]})]}),c.jsxs("div",{className:"dash-detail-actions",children:[c.jsx("button",{type:"button",className:"dash-btn secondary",onClick:Se,children:"Cancel"}),c.jsx("button",{type:"button",className:"dash-btn primary",onClick:ie,children:"Save Changes"})]})]})]})]}):c.jsx("div",{className:"stat-sub",children:"No library items."})]})]})}),Ot&&c.jsx("div",{id:"calendarOverlay",onClick:T=>{T.target===T.currentTarget&&bt()},children:c.jsxs("div",{id:"calendarCard",onClick:T=>T.stopPropagation(),children:[c.jsxs("div",{className:"calendar-header",children:[c.jsx("div",{className:"calendar-title",children:new Date(On.year,On.month).toLocaleString(void 0,{month:"long",year:"numeric"})}),c.jsxs("div",{className:"calendar-nav",children:[c.jsx("button",{className:"calendar-nav-btn",onClick:()=>as(-1),type:"button",children:"<"}),c.jsx("button",{className:"calendar-nav-btn",onClick:()=>as(1),type:"button",children:">"})]})]}),c.jsxs("div",{className:"calendar-weekdays",children:[c.jsx("div",{children:"Sun"}),c.jsx("div",{children:"Mon"}),c.jsx("div",{children:"Tue"}),c.jsx("div",{children:"Wed"}),c.jsx("div",{children:"Thu"}),c.jsx("div",{children:"Fri"}),c.jsx("div",{children:"Sat"})]}),c.jsxs("div",{className:"calendar-grid",children:[rs.cells.map((T,V)=>{if(T.type==="pad")return c.jsx("div",{className:"calendar-day pad"},`pad-${V}`);const{day:H,dateKey:oe,items:ye,isToday:Ue}=T;return c.jsxs("div",{className:"calendar-day"+(ye.length?" has-releases":"")+(Ue?" today":""),onClick:()=>{ye.length&&Mn({date:oe,items:ye})},role:"button",tabIndex:0,onKeyDown:Ie=>{if(Ie.key==="Enter"||Ie.key===" "){if(Ie.preventDefault(),!ye.length)return;Mn({date:oe,items:ye})}},children:[c.jsx("div",{className:"day-num",children:H}),c.jsxs("div",{className:"calendar-releases",children:[ye.slice(0,2).map(Ie=>c.jsx("div",{className:"calendar-release purchased",children:Ie.title||"Untitled"},Ie.id)),ye.length>2&&c.jsxs("div",{className:"calendar-release more",children:["+",ye.length-2," more"]})]})]},oe)}),!rs.hasItems&&c.jsx("div",{className:"calendar-empty",children:"No purchases for this month."})]}),c.jsx("button",{id:"calendarClose",onClick:bt,type:"button",children:"x"})]})}),Cn&&c.jsx("div",{className:"purchase-overlay",onClick:T=>{T.target===T.currentTarget&&Mn(null)},children:c.jsxs("div",{className:"purchase-day-modal",onClick:T=>T.stopPropagation(),children:[c.jsxs("div",{className:"purchase-day-header",children:[c.jsx("div",{className:"purchase-day-title",children:new Date(Cn.date).toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"})}),c.jsx("button",{className:"manga-btn secondary",onClick:()=>Mn(null),type:"button",children:"x"})]}),c.jsx("div",{className:"purchase-day-list",children:Cn.items.map(T=>c.jsx("div",{className:"purchase-day-item",children:T.title||"Untitled"},T.id))})]})}),on&&c.jsx("div",{id:"calendarOverlay",onClick:()=>Sn(!1),style:{zIndex:10060},children:c.jsxs("div",{id:"calendarCard",onClick:T=>T.stopPropagation(),children:[c.jsxs("div",{className:"calendar-header",children:[c.jsx("div",{className:"calendar-title",children:ln.toLocaleString(void 0,{month:"long",year:"numeric"})}),c.jsxs("div",{className:"calendar-nav",children:[c.jsx("button",{className:"calendar-nav-btn",onClick:()=>os(-1),type:"button",children:"<"}),c.jsx("button",{className:"calendar-nav-btn",onClick:()=>os(1),type:"button",children:">"})]})]}),c.jsxs("div",{className:"calendar-weekdays",children:[c.jsx("div",{children:"Sun"}),c.jsx("div",{children:"Mon"}),c.jsx("div",{children:"Tue"}),c.jsx("div",{children:"Wed"}),c.jsx("div",{children:"Thu"}),c.jsx("div",{children:"Fri"}),c.jsx("div",{children:"Sat"})]}),c.jsx("div",{className:"calendar-grid",children:Gs.map((T,V)=>{var H;return T.type==="pad"?c.jsx("div",{className:"calendar-day pad"},V):c.jsxs("div",{className:"calendar-day"+(T.isToday?" today":"")+((H=T.releases)!=null&&H.length?" has-releases":""),onClick:()=>{var ye;if(!((ye=T.releases)!=null&&ye.length))return;const oe=new Date(ln.getFullYear(),ln.getMonth(),T.day);qn({dateLabel:oe.toLocaleDateString(void 0,{month:"long",day:"numeric",year:"numeric"}),releases:T.releases})},role:"button",tabIndex:0,onKeyDown:oe=>{var ye;if(oe.key==="Enter"||oe.key===" "){if(oe.preventDefault(),!((ye=T.releases)!=null&&ye.length))return;const Ue=new Date(ln.getFullYear(),ln.getMonth(),T.day);qn({dateLabel:Ue.toLocaleDateString(void 0,{month:"long",day:"numeric",year:"numeric"}),releases:T.releases})}},children:[c.jsx("div",{className:"day-num",children:T.day}),c.jsxs("div",{className:"calendar-releases",children:[(T.releases||[]).slice(0,2).map((oe,ye)=>c.jsx("div",{className:"calendar-release purchased",title:oe.title,children:oe.title},ye)),(T.releases||[]).length>2&&c.jsxs("div",{className:"calendar-release more",children:["+",(T.releases||[]).length-2," more"]})]})]},T.dateKey||V)})}),!Rr.length&&c.jsx("div",{className:"calendar-empty",children:"No reads recorded yet."}),c.jsx("button",{id:"calendarClose",onClick:()=>Sn(!1),type:"button",children:"x"})]})}),Xt&&c.jsx("div",{id:"calendarOverlay",onClick:()=>qn(null),style:{zIndex:10080},children:c.jsxs("div",{id:"calendarCard",onClick:T=>T.stopPropagation(),style:{maxWidth:"520px"},children:[c.jsxs("div",{className:"calendar-header",children:[c.jsx("div",{className:"calendar-title",children:Xt.dateLabel}),c.jsx("button",{className:"calendar-close-btn",onClick:()=>qn(null),type:"button",children:"x"})]}),c.jsx("div",{className:"calendar-releases",children:Xt.releases.map((T,V)=>c.jsx("div",{className:"calendar-release purchased",title:T.title,children:T.title},V))})]})}),Rt&&c.jsx("div",{id:"calendarOverlay",onClick:()=>kt(!1),children:c.jsxs("div",{id:"calendarCard",onClick:T=>T.stopPropagation(),children:[c.jsxs("div",{className:"calendar-header",children:[c.jsx("div",{className:"calendar-title",children:St.toLocaleString(void 0,{month:"long",year:"numeric"})}),c.jsxs("div",{className:"calendar-nav",children:[c.jsx("button",{className:"calendar-nav-btn",onClick:()=>jt(new Date(St.getFullYear(),St.getMonth()-1,1)),children:"<"}),c.jsx("button",{className:"calendar-nav-btn",onClick:()=>jt(new Date(St.getFullYear(),St.getMonth()+1,1)),children:">"})]})]}),c.jsxs("div",{className:"calendar-weekdays",children:[c.jsx("div",{children:"Sun"}),c.jsx("div",{children:"Mon"}),c.jsx("div",{children:"Tue"}),c.jsx("div",{children:"Wed"}),c.jsx("div",{children:"Thu"}),c.jsx("div",{children:"Fri"}),c.jsx("div",{children:"Sat"})]}),c.jsx("div",{className:"calendar-grid",id:"releaseCalendar",children:is.map((T,V)=>T.type==="pad"?c.jsx("div",{className:"calendar-day pad"},V):c.jsxs("div",{className:"calendar-day"+(T.isToday?" today":""),children:[c.jsx("div",{className:"day-num",children:T.day}),c.jsxs("div",{className:"calendar-releases",children:[(vt===T.dateKey?T.releases:T.releases.slice(0,2)).map((H,oe)=>c.jsx("div",{className:"calendar-release"+(H.purchased?" purchased":""),title:H.title,children:H.title},oe)),T.releases.length>2&&c.jsxs("button",{className:"calendar-more-btn",onClick:()=>{const H=new Date(St.getFullYear(),St.getMonth(),T.day);ue({dateLabel:H.toLocaleDateString(void 0,{month:"long",day:"numeric",year:"numeric"}),releases:T.releases})},children:["+",T.releases.length-2," more"]})]})]},V))}),!tt.length&&c.jsx("div",{className:"calendar-empty",children:"No wishlist releases found."}),c.jsx("button",{id:"calendarClose",onClick:()=>kt(!1),children:"x"})]})}),Qt.open&&c.jsx("div",{id:"statDetailOverlay",onClick:Yt,children:c.jsxs("div",{id:"statDetailCard",onClick:T=>T.stopPropagation(),children:[c.jsx("button",{id:"statDetailClose",onClick:Yt,children:"x"}),c.jsxs("h2",{id:"statDetailTitle",children:[Qt.type==="publishers"&&"Top Publishers",Qt.type==="genres"&&"Top Genres",Qt.type==="demographics"&&"Top Demographics",Qt.type==="timeToRead"&&"Avg Time From Purchase to Read",Qt.type==="collectionValue"&&"Collection Value",Qt.type==="pages"&&"Pages Read vs Total",Qt.type==="ratings"&&"Ratings",Qt.type==="releases"&&"Library & Wishlist Releases"]}),c.jsx("div",{id:"statDetailBody",children:Cs()})]})}),We&&c.jsx("div",{id:"calendarOverlay",onClick:()=>ue(null),style:{zIndex:10080},children:c.jsxs("div",{id:"calendarCard",onClick:T=>T.stopPropagation(),style:{maxWidth:"520px"},children:[c.jsxs("div",{className:"calendar-header",children:[c.jsx("div",{className:"calendar-title",children:We.dateLabel}),c.jsx("button",{className:"calendar-close-btn",onClick:()=>ue(null),type:"button",children:"x"})]}),c.jsx("div",{className:"calendar-releases",children:We.releases.map((T,V)=>c.jsx("div",{className:"calendar-release"+(T.purchased?" purchased":""),title:T.title,children:T.title},V))})]})}),e&&me&&c.jsx("div",{className:"dashboard-modal-backdrop visible",onClick:T=>{T.target===T.currentTarget&&De(!1)},children:c.jsxs("div",{className:"dashboard-modal",children:[c.jsxs("div",{className:"dashboard-modal-header",children:[c.jsx("h3",{children:"Webhook Settings"}),c.jsx("button",{className:"dashboard-close",onClick:()=>De(!1),type:"button",children:"X"})]}),c.jsxs("div",{className:"dashboard-modal-body",children:[c.jsxs("label",{className:"dashboard-input",children:[c.jsx("span",{children:"Yearly summary webhook"}),c.jsx("input",{type:"text",value:U.yearly,onChange:T=>Z(V=>({...V,yearly:T.target.value}))})]}),c.jsxs("label",{className:"dashboard-input",children:[c.jsx("span",{children:"Release timer webhook"}),c.jsx("input",{type:"text",value:U.release,onChange:T=>Z(V=>({...V,release:T.target.value}))})]}),c.jsxs("label",{className:"dashboard-input",children:[c.jsx("span",{children:"Activity webhook"}),c.jsx("input",{type:"text",value:U.activity,onChange:T=>Z(V=>({...V,activity:T.target.value}))})]}),c.jsxs("div",{className:"dashboard-input",style:{borderTop:"1px solid rgba(255,182,193,0.2)",paddingTop:8},children:[c.jsx("span",{children:"User roles"}),c.jsx("div",{style:{marginTop:8,fontSize:"0.85rem",color:"var(--text-soft)"},children:N?c.jsx("span",{children:"Loading users"}):be.length===0?c.jsx("span",{children:"No users found."}):c.jsx("ul",{style:{listStyle:"none",margin:"6px 0 0",padding:0,display:"flex",gap:6,flexDirection:"column"},children:be.map(T=>c.jsxs("li",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:8,background:"rgba(24,5,18,0.7)",border:"1px solid rgba(255,182,193,0.18)",borderRadius:10,padding:"6px 8px",flexWrap:"wrap"},children:[c.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:2},children:[c.jsx("strong",{children:T.displayName||T.email||T.uid}),c.jsx("span",{style:{fontSize:"0.85rem",opacity:.8},children:T.email||T.uid})]}),c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[c.jsx("span",{className:"role-pill",children:T.role||"viewer"}),T.role==="admin"?c.jsx("button",{className:"dashboard-close",type:"button",onClick:()=>Je(T.uid,"viewer"),style:{padding:"4px 10px"},children:"Make viewer"}):c.jsx("button",{className:"stat-link",type:"button",onClick:()=>Je(T.uid,"admin"),style:{padding:"4px 10px"},children:"Make admin"})]})]},T.uid))})})]})]}),c.jsxs("div",{className:"dashboard-modal-footer",children:[c.jsx("button",{className:"stat-link",type:"button",onClick:async()=>{try{await ci(Lt(lt,"settings","webhooks"),{yearly:U.yearly||Tl,release:U.release||Sl,activity:U.activity||Ia}),De(!1)}catch(T){console.error("Failed to save webhooks",T),alert("Failed to save webhooks.")}},children:"Save"}),c.jsx("button",{className:"stat-link danger",type:"button",onClick:()=>De(!1),children:"Cancel"})]})]})})]})}function pN(){const[n,e]=k.useState(!0),[t,s]=k.useState(""),[a,l]=k.useState(0),[d,f]=k.useState([]),[m,v]=k.useState(0),w=k.useRef(null);k.useEffect(()=>{document.title="Music | im.ok"},[]),k.useEffect(()=>{let Ee=!1;async function le(){e(!0),s("");try{const Re=await fetch("https://music-api-worker.imokissick.workers.dev/music");if(!Re.ok)throw new Error("Worker fetch failed");const A=await Re.json();if(Ee)return;const P=Array.isArray(A.combined)?A.combined:[],R=Array.isArray(A.spotify)?A.spotify:[],O=Array.isArray(A.soundcloud)?A.soundcloud:[],D=[...P,...R,...O].reduce((b,he)=>{const $e=(he.title||"").toLowerCase().trim();if(!$e)return b;const Ae=b.findIndex(He=>(He.title||"").toLowerCase().trim()===$e);return Ae>=0?(b[Ae].source!=="spotify"&&he.source==="spotify"&&(b[Ae]=he),b):(b.push(he),b)},[]).map(b=>({...b,releaseDate:b.releaseDate?new Date(b.releaseDate):new Date}));f(D)}catch(Re){console.error(Re),Ee||s("Failed to load music feeds.")}finally{Ee||e(!1)}}return le(),()=>{Ee=!0}},[]);const S=Math.min(4,Math.max(1,d.length)),I=S?Math.ceil(d.length/S):0,U=()=>{w.current&&clearInterval(w.current),d.length&&(v(Ee=>Ee+1),w.current=setInterval(()=>{l(Ee=>(Math.floor(Ee/S)+1)%I*S%d.length),v(Ee=>Ee+1)},15e3))};k.useEffect(()=>{if(d.length)return U(),()=>{w.current&&clearInterval(w.current)}},[d,S]);const Z=Ee=>{d.length&&(l(le=>(Math.floor(le/S)+Ee+I)%I*S%d.length),U())},Q=Ee=>{d.length&&(l(Ee*S%d.length),U())},M=Ee=>le=>{le.preventDefault();const A=Ee.source==="spotify"?`spotify:album:${Ee.id}`:Ee.url,P=Ee.url;try{const R=setTimeout(()=>{window.open(P,"_blank","noopener,noreferrer")},600);window.location.href=A,setTimeout(()=>clearTimeout(R),800)}catch{window.open(P,"_blank","noopener,noreferrer")}},ne=d[0],xe=Ee=>Ee?{backgroundImage:`url(${Ee})`,backgroundSize:"cover",backgroundPosition:"center"}:{},we=ne?ne.source==="spotify"?"Spotify":"SoundCloud":"";return c.jsxs("main",{className:"page music-page",children:[c.jsxs("header",{className:"music-hero",children:[c.jsxs("div",{className:"music-hero-content",children:[c.jsx("p",{className:"music-pill",children:"im.ok  Artist"}),c.jsx("h1",{children:ne?ne.title:"Latest & Greatest"}),c.jsx("p",{className:"music-sub",children:"Check out my latest song. I know it's been almost a whole year since I've released. I have been on a much needed hiatus. I felt the whole world crumbling around me and had no time to breathe so this is why I took a break. Here's to 2026!"}),ne&&c.jsx("div",{className:"music-badges",children:c.jsx("span",{children:we})})]}),c.jsx("div",{className:"music-hero-embed",children:c.jsxs("div",{className:"music-hero-art",style:xe(ne==null?void 0:ne.artwork),children:[!(ne!=null&&ne.artwork)&&c.jsx("div",{className:"music-hero-art-fallback",children:"Artwork"}),ne&&c.jsx("button",{className:"music-link music-play hero-play","aria-label":`Play ${ne.title}`,onClick:M(ne)})]})})]}),c.jsxs("section",{className:"music-section",children:[c.jsx("div",{className:"music-section-header",children:c.jsx("h2",{children:"Releases"})}),t&&c.jsx("div",{className:"music-error",children:t}),n&&c.jsx("div",{className:"music-loading",children:"Loading music feeds..."}),!n&&d.length===0&&c.jsx("div",{className:"music-empty",children:"Connect Spotify/SoundCloud tokens to see live releases."}),!n&&d.length>0&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"music-carousel-wrap",children:[c.jsx("button",{className:"music-nav left",onClick:()=>Z(-1),"aria-label":"Previous releases",children:""}),c.jsx("div",{className:"music-carousel",children:Array.from({length:S}).map((Ee,le)=>{const Re=d[(a+le)%d.length];return Re?c.jsxs("div",{className:"music-card",children:[c.jsx("div",{className:"music-card-art",style:xe(Re.artwork)}),c.jsxs("div",{className:"music-card-body",children:[c.jsx("div",{className:"music-card-title",children:Re.title}),c.jsx("div",{className:"music-card-actions",children:c.jsx("button",{className:"music-link music-play","aria-label":`Play ${Re.title}`,onClick:M(Re)})})]})]},`${Re.id}-${le}`):null})}),c.jsx("button",{className:"music-nav right",onClick:()=>Z(1),"aria-label":"Next releases",children:""})]}),c.jsx("div",{className:"music-dots",children:Array.from({length:I}).map((Ee,le)=>{const Re=Math.floor(a/S)===le,A=Re?`${le}-${m}`:`${le}-idle`;return c.jsx("button",{className:`dot ${Re?"active":""}`,onClick:()=>Q(le),"aria-label":`Go to set ${le+1}`,children:c.jsx("span",{className:"dot-fill"},A)},le)})})]})]}),c.jsxs("div",{className:"music-feeds-row",children:[c.jsxs("section",{className:"music-section",children:[c.jsx("div",{className:"music-section-header",children:c.jsx("h2",{children:"Spotify"})}),c.jsx("div",{className:"music-embed-card",children:c.jsx("iframe",{title:"Spotify Artist",src:"https://open.spotify.com/embed/artist/00sbWLxYLDs8i5BLQL9Qdo?utm_source=generator&theme=0",width:"100%",height:"400",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy"})})]}),c.jsxs("section",{className:"music-section",children:[c.jsx("div",{className:"music-section-header",children:c.jsx("h2",{children:"SoundCloud"})}),c.jsx("div",{className:"music-embed-card",children:c.jsx("iframe",{title:"SoundCloud Player",width:"100%",height:"400",scrolling:"no",frameBorder:"no",allow:"autoplay",src:"https://w.soundcloud.com/player/?url=https%3A//soundcloud.com/imxk&color=%23ff69b4&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true&visual=true"})})]})]})]})}function mN(){const n=Ju(),{user:e}=Ho(),t=async a=>{if(!(a!=null&&a.uid))return;const l=Lt(lt,"users",a.uid);try{const d=await xd(l),f=d.exists()?d.data():null,m=(f==null?void 0:f.role)||"viewer";await ci(l,{role:m,email:a.email||(f==null?void 0:f.email)||"",displayName:a.displayName||(f==null?void 0:f.displayName)||"",createdAt:(f==null?void 0:f.createdAt)||Qu()},{merge:!0})}catch(d){console.warn("Failed to upsert user doc",d)}};k.useEffect(()=>{e!=null&&e.uid&&t(e).finally(()=>n("/"))},[e,n]);async function s(){try{const a=new ys,l=await h0(Yr,a);await t(l.user),n("/")}catch(a){console.error(a),alert("Google Sign-In failed.")}}return c.jsx("div",{className:"signin-page",children:c.jsxs("div",{className:"signin-card",children:[c.jsx("h2",{className:"signin-title",children:"Welcome Back"}),c.jsx("p",{className:"signin-sub",children:"Sign in to access the dashboard & edit collections."}),c.jsxs("button",{className:"google-btn",onClick:s,children:[c.jsx("img",{src:"https://www.svgrepo.com/show/475656/google-color.svg",alt:"",className:"google-icon"}),"Continue with Google"]}),c.jsxs("button",{className:"signin-cancel",onClick:()=>n("/"),children:["<"," Back to Home"]})]})})}const gN=k.lazy(()=>cc(()=>import("./SteamCard-DfktaAaM.js"),[])),yN=k.lazy(()=>cc(()=>import("./SteamRecents-BUDxKvlo.js"),[])),vN=k.lazy(()=>cc(()=>import("./SteamGames-D3-b2LQg.js"),[]));function _N(){return k.useEffect(()=>{document.title="Tyler's Gaming Lounge"},[]),c.jsxs("div",{className:"steam-page page",children:[c.jsxs("header",{style:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",gap:"6px"},children:[c.jsx("h1",{style:{margin:0,fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Tyler's Gaming Lounge"}),c.jsx("p",{style:{margin:"6px 0 0",color:"var(--text-soft)",fontSize:"0.9rem"},children:"This will be the home to all of my gaming collections, this is still being worked on, but thought it was cool with just steam for now."})]}),c.jsx(uf,{minHeight:260,children:c.jsx(k.Suspense,{fallback:c.jsx(Pu,{label:"Profile"}),children:c.jsx(gN,{})})}),c.jsx(uf,{minHeight:240,children:c.jsx(k.Suspense,{fallback:c.jsx(Pu,{label:"Recently played"}),children:c.jsx(yN,{})})}),c.jsx(uf,{minHeight:400,children:c.jsx(k.Suspense,{fallback:c.jsx(Pu,{label:"Library & Achievements"}),children:c.jsx(vN,{})})})]})}function uf({children:n,minHeight:e=200}){const[t,s]=k.useState(!1),a=k.useRef(null);k.useEffect(()=>{const d=new IntersectionObserver(f=>{f[0].isIntersecting&&(s(!0),d.disconnect())},{rootMargin:"200px 0px"});return a.current&&d.observe(a.current),()=>d.disconnect()},[]);const l=t?void 0:{minHeight:e};return c.jsx("div",{ref:a,style:l,children:t?n:c.jsx(Pu,{})})}function Pu({label:n="Loading section"}){return c.jsxs("div",{className:"steam-skeleton",children:[c.jsx("div",{className:"steam-skeleton-bar"}),c.jsx("div",{className:"steam-skeleton-bar short"}),c.jsx("p",{className:"steam-skeleton-label",children:n})]})}function wN(){return c.jsxs(TR,{children:[c.jsx(CR,{}),c.jsxs(tT,{children:[c.jsx(gs,{path:"/",element:c.jsx(Wv,{})}),c.jsx(gs,{path:"/home",element:c.jsx(Wv,{})}),c.jsx(gs,{path:"/manga",element:c.jsx(VR,{})}),c.jsx(gs,{path:"/anime",element:c.jsx(qR,{})}),c.jsx(gs,{path:"/tcg",element:c.jsx(QR,{})}),c.jsx(gs,{path:"/music",element:c.jsx(pN,{})}),c.jsx(gs,{path:"/dashboard",element:c.jsx(fN,{})}),c.jsx(gs,{path:"/signin",element:c.jsx(mN,{})}),c.jsx(gs,{path:"/steam",element:c.jsx(_N,{})}),c.jsx(gs,{path:"*",element:c.jsx(ZE,{to:"/home",replace:!0})})]})]})}lE.createRoot(document.getElementById("root")).render(c.jsx(zf.StrictMode,{children:c.jsx(lT,{basename:"/base",children:c.jsx(wN,{})})}));export{c as j,k as r};
