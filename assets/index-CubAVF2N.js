function EE(n,e){for(var t=0;t<e.length;t++){const s=e[t];if(typeof s!="string"&&!Array.isArray(s)){for(const a in s)if(a!=="default"&&!(a in n)){const l=Object.getOwnPropertyDescriptor(s,a);l&&Object.defineProperty(n,a,l.get?l:{enumerable:!0,get:()=>s[a]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const d of l.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&s(d)}).observe(document,{childList:!0,subtree:!0});function t(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(a){if(a.ep)return;a.ep=!0;const l=t(a);fetch(a.href,l)}})();function ep(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var ef={exports:{}},Nl={},tf={exports:{}},pt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var py;function TE(){if(py)return pt;py=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),d=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),y=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),E=Symbol.iterator;function C(Y){return Y===null||typeof Y!="object"?null:(Y=E&&Y[E]||Y["@@iterator"],typeof Y=="function"?Y:null)}var O={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},X=Object.assign,B={};function U(Y,k,K){this.props=Y,this.context=k,this.refs=B,this.updater=K||O}U.prototype.isReactComponent={},U.prototype.setState=function(Y,k){if(typeof Y!="object"&&typeof Y!="function"&&Y!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Y,k,"setState")},U.prototype.forceUpdate=function(Y){this.updater.enqueueForceUpdate(this,Y,"forceUpdate")};function se(){}se.prototype=U.prototype;function we(Y,k,K){this.props=Y,this.context=k,this.refs=B,this.updater=K||O}var _e=we.prototype=new se;_e.constructor=we,X(_e,U.prototype),_e.isPureReactComponent=!0;var ve=Array.isArray,L=Object.prototype.hasOwnProperty,ie={current:null},I={key:!0,ref:!0,__self:!0,__source:!0};function N(Y,k,K){var Te,De={},ke=null,Oe=null;if(k!=null)for(Te in k.ref!==void 0&&(Oe=k.ref),k.key!==void 0&&(ke=""+k.key),k)L.call(k,Te)&&!I.hasOwnProperty(Te)&&(De[Te]=k[Te]);var Qe=arguments.length-2;if(Qe===1)De.children=K;else if(1<Qe){for(var nt=Array(Qe),me=0;me<Qe;me++)nt[me]=arguments[me+2];De.children=nt}if(Y&&Y.defaultProps)for(Te in Qe=Y.defaultProps,Qe)De[Te]===void 0&&(De[Te]=Qe[Te]);return{$$typeof:n,type:Y,key:ke,ref:Oe,props:De,_owner:ie.current}}function A(Y,k){return{$$typeof:n,type:Y.type,key:k,ref:Y.ref,props:Y.props,_owner:Y._owner}}function M(Y){return typeof Y=="object"&&Y!==null&&Y.$$typeof===n}function D(Y){var k={"=":"=0",":":"=2"};return"$"+Y.replace(/[=:]/g,function(K){return k[K]})}var P=/\/+/g;function b(Y,k){return typeof Y=="object"&&Y!==null&&Y.key!=null?D(""+Y.key):k.toString(36)}function J(Y,k,K,Te,De){var ke=typeof Y;(ke==="undefined"||ke==="boolean")&&(Y=null);var Oe=!1;if(Y===null)Oe=!0;else switch(ke){case"string":case"number":Oe=!0;break;case"object":switch(Y.$$typeof){case n:case e:Oe=!0}}if(Oe)return Oe=Y,De=De(Oe),Y=Te===""?"."+b(Oe,0):Te,ve(De)?(K="",Y!=null&&(K=Y.replace(P,"$&/")+"/"),J(De,k,K,"",function(me){return me})):De!=null&&(M(De)&&(De=A(De,K+(!De.key||Oe&&Oe.key===De.key?"":(""+De.key).replace(P,"$&/")+"/")+Y)),k.push(De)),1;if(Oe=0,Te=Te===""?".":Te+":",ve(Y))for(var Qe=0;Qe<Y.length;Qe++){ke=Y[Qe];var nt=Te+b(ke,Qe);Oe+=J(ke,k,K,nt,De)}else if(nt=C(Y),typeof nt=="function")for(Y=nt.call(Y),Qe=0;!(ke=Y.next()).done;)ke=ke.value,nt=Te+b(ke,Qe++),Oe+=J(ke,k,K,nt,De);else if(ke==="object")throw k=String(Y),Error("Objects are not valid as a React child (found: "+(k==="[object Object]"?"object with keys {"+Object.keys(Y).join(", ")+"}":k)+"). If you meant to render a collection of children, use an array instead.");return Oe}function re(Y,k,K){if(Y==null)return Y;var Te=[],De=0;return J(Y,Te,"","",function(ke){return k.call(K,ke,De++)}),Te}function Ce(Y){if(Y._status===-1){var k=Y._result;k=k(),k.then(function(K){(Y._status===0||Y._status===-1)&&(Y._status=1,Y._result=K)},function(K){(Y._status===0||Y._status===-1)&&(Y._status=2,Y._result=K)}),Y._status===-1&&(Y._status=0,Y._result=k)}if(Y._status===1)return Y._result.default;throw Y._result}var fe={current:null},le={transition:null},Pe={ReactCurrentDispatcher:fe,ReactCurrentBatchConfig:le,ReactCurrentOwner:ie};function xe(){throw Error("act(...) is not supported in production builds of React.")}return pt.Children={map:re,forEach:function(Y,k,K){re(Y,function(){k.apply(this,arguments)},K)},count:function(Y){var k=0;return re(Y,function(){k++}),k},toArray:function(Y){return re(Y,function(k){return k})||[]},only:function(Y){if(!M(Y))throw Error("React.Children.only expected to receive a single React element child.");return Y}},pt.Component=U,pt.Fragment=t,pt.Profiler=a,pt.PureComponent=we,pt.StrictMode=s,pt.Suspense=m,pt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Pe,pt.act=xe,pt.cloneElement=function(Y,k,K){if(Y==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+Y+".");var Te=X({},Y.props),De=Y.key,ke=Y.ref,Oe=Y._owner;if(k!=null){if(k.ref!==void 0&&(ke=k.ref,Oe=ie.current),k.key!==void 0&&(De=""+k.key),Y.type&&Y.type.defaultProps)var Qe=Y.type.defaultProps;for(nt in k)L.call(k,nt)&&!I.hasOwnProperty(nt)&&(Te[nt]=k[nt]===void 0&&Qe!==void 0?Qe[nt]:k[nt])}var nt=arguments.length-2;if(nt===1)Te.children=K;else if(1<nt){Qe=Array(nt);for(var me=0;me<nt;me++)Qe[me]=arguments[me+2];Te.children=Qe}return{$$typeof:n,type:Y.type,key:De,ref:ke,props:Te,_owner:Oe}},pt.createContext=function(Y){return Y={$$typeof:d,_currentValue:Y,_currentValue2:Y,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},Y.Provider={$$typeof:l,_context:Y},Y.Consumer=Y},pt.createElement=N,pt.createFactory=function(Y){var k=N.bind(null,Y);return k.type=Y,k},pt.createRef=function(){return{current:null}},pt.forwardRef=function(Y){return{$$typeof:f,render:Y}},pt.isValidElement=M,pt.lazy=function(Y){return{$$typeof:x,_payload:{_status:-1,_result:Y},_init:Ce}},pt.memo=function(Y,k){return{$$typeof:y,type:Y,compare:k===void 0?null:k}},pt.startTransition=function(Y){var k=le.transition;le.transition={};try{Y()}finally{le.transition=k}},pt.unstable_act=xe,pt.useCallback=function(Y,k){return fe.current.useCallback(Y,k)},pt.useContext=function(Y){return fe.current.useContext(Y)},pt.useDebugValue=function(){},pt.useDeferredValue=function(Y){return fe.current.useDeferredValue(Y)},pt.useEffect=function(Y,k){return fe.current.useEffect(Y,k)},pt.useId=function(){return fe.current.useId()},pt.useImperativeHandle=function(Y,k,K){return fe.current.useImperativeHandle(Y,k,K)},pt.useInsertionEffect=function(Y,k){return fe.current.useInsertionEffect(Y,k)},pt.useLayoutEffect=function(Y,k){return fe.current.useLayoutEffect(Y,k)},pt.useMemo=function(Y,k){return fe.current.useMemo(Y,k)},pt.useReducer=function(Y,k,K){return fe.current.useReducer(Y,k,K)},pt.useRef=function(Y){return fe.current.useRef(Y)},pt.useState=function(Y){return fe.current.useState(Y)},pt.useSyncExternalStore=function(Y,k,K){return fe.current.useSyncExternalStore(Y,k,K)},pt.useTransition=function(){return fe.current.useTransition()},pt.version="18.3.1",pt}var my;function tp(){return my||(my=1,tf.exports=TE()),tf.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gy;function SE(){if(gy)return Nl;gy=1;var n=tp(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,a=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function d(f,m,y){var x,E={},C=null,O=null;y!==void 0&&(C=""+y),m.key!==void 0&&(C=""+m.key),m.ref!==void 0&&(O=m.ref);for(x in m)s.call(m,x)&&!l.hasOwnProperty(x)&&(E[x]=m[x]);if(f&&f.defaultProps)for(x in m=f.defaultProps,m)E[x]===void 0&&(E[x]=m[x]);return{$$typeof:e,type:f,key:C,ref:O,props:E,_owner:a.current}}return Nl.Fragment=t,Nl.jsx=d,Nl.jsxs=d,Nl}var yy;function bE(){return yy||(yy=1,ef.exports=SE()),ef.exports}var o=bE(),j=tp();const np=ep(j),CE=EE({__proto__:null,default:np},[j]);var yu={},nf={exports:{}},Ar={},rf={exports:{}},sf={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vy;function IE(){return vy||(vy=1,(function(n){function e(le,Pe){var xe=le.length;le.push(Pe);e:for(;0<xe;){var Y=xe-1>>>1,k=le[Y];if(0<a(k,Pe))le[Y]=Pe,le[xe]=k,xe=Y;else break e}}function t(le){return le.length===0?null:le[0]}function s(le){if(le.length===0)return null;var Pe=le[0],xe=le.pop();if(xe!==Pe){le[0]=xe;e:for(var Y=0,k=le.length,K=k>>>1;Y<K;){var Te=2*(Y+1)-1,De=le[Te],ke=Te+1,Oe=le[ke];if(0>a(De,xe))ke<k&&0>a(Oe,De)?(le[Y]=Oe,le[ke]=xe,Y=ke):(le[Y]=De,le[Te]=xe,Y=Te);else if(ke<k&&0>a(Oe,xe))le[Y]=Oe,le[ke]=xe,Y=ke;else break e}}return Pe}function a(le,Pe){var xe=le.sortIndex-Pe.sortIndex;return xe!==0?xe:le.id-Pe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;n.unstable_now=function(){return l.now()}}else{var d=Date,f=d.now();n.unstable_now=function(){return d.now()-f}}var m=[],y=[],x=1,E=null,C=3,O=!1,X=!1,B=!1,U=typeof setTimeout=="function"?setTimeout:null,se=typeof clearTimeout=="function"?clearTimeout:null,we=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _e(le){for(var Pe=t(y);Pe!==null;){if(Pe.callback===null)s(y);else if(Pe.startTime<=le)s(y),Pe.sortIndex=Pe.expirationTime,e(m,Pe);else break;Pe=t(y)}}function ve(le){if(B=!1,_e(le),!X)if(t(m)!==null)X=!0,Ce(L);else{var Pe=t(y);Pe!==null&&fe(ve,Pe.startTime-le)}}function L(le,Pe){X=!1,B&&(B=!1,se(N),N=-1),O=!0;var xe=C;try{for(_e(Pe),E=t(m);E!==null&&(!(E.expirationTime>Pe)||le&&!D());){var Y=E.callback;if(typeof Y=="function"){E.callback=null,C=E.priorityLevel;var k=Y(E.expirationTime<=Pe);Pe=n.unstable_now(),typeof k=="function"?E.callback=k:E===t(m)&&s(m),_e(Pe)}else s(m);E=t(m)}if(E!==null)var K=!0;else{var Te=t(y);Te!==null&&fe(ve,Te.startTime-Pe),K=!1}return K}finally{E=null,C=xe,O=!1}}var ie=!1,I=null,N=-1,A=5,M=-1;function D(){return!(n.unstable_now()-M<A)}function P(){if(I!==null){var le=n.unstable_now();M=le;var Pe=!0;try{Pe=I(!0,le)}finally{Pe?b():(ie=!1,I=null)}}else ie=!1}var b;if(typeof we=="function")b=function(){we(P)};else if(typeof MessageChannel<"u"){var J=new MessageChannel,re=J.port2;J.port1.onmessage=P,b=function(){re.postMessage(null)}}else b=function(){U(P,0)};function Ce(le){I=le,ie||(ie=!0,b())}function fe(le,Pe){N=U(function(){le(n.unstable_now())},Pe)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(le){le.callback=null},n.unstable_continueExecution=function(){X||O||(X=!0,Ce(L))},n.unstable_forceFrameRate=function(le){0>le||125<le?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<le?Math.floor(1e3/le):5},n.unstable_getCurrentPriorityLevel=function(){return C},n.unstable_getFirstCallbackNode=function(){return t(m)},n.unstable_next=function(le){switch(C){case 1:case 2:case 3:var Pe=3;break;default:Pe=C}var xe=C;C=Pe;try{return le()}finally{C=xe}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(le,Pe){switch(le){case 1:case 2:case 3:case 4:case 5:break;default:le=3}var xe=C;C=le;try{return Pe()}finally{C=xe}},n.unstable_scheduleCallback=function(le,Pe,xe){var Y=n.unstable_now();switch(typeof xe=="object"&&xe!==null?(xe=xe.delay,xe=typeof xe=="number"&&0<xe?Y+xe:Y):xe=Y,le){case 1:var k=-1;break;case 2:k=250;break;case 5:k=1073741823;break;case 4:k=1e4;break;default:k=5e3}return k=xe+k,le={id:x++,callback:Pe,priorityLevel:le,startTime:xe,expirationTime:k,sortIndex:-1},xe>Y?(le.sortIndex=xe,e(y,le),t(m)===null&&le===t(y)&&(B?(se(N),N=-1):B=!0,fe(ve,xe-Y))):(le.sortIndex=k,e(m,le),X||O||(X=!0,Ce(L))),le},n.unstable_shouldYield=D,n.unstable_wrapCallback=function(le){var Pe=C;return function(){var xe=C;C=Pe;try{return le.apply(this,arguments)}finally{C=xe}}}})(sf)),sf}var _y;function NE(){return _y||(_y=1,rf.exports=IE()),rf.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xy;function PE(){if(xy)return Ar;xy=1;var n=tp(),e=NE();function t(r){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+r,c=1;c<arguments.length;c++)i+="&args[]="+encodeURIComponent(arguments[c]);return"Minified React error #"+r+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,a={};function l(r,i){d(r,i),d(r+"Capture",i)}function d(r,i){for(a[r]=i,r=0;r<i.length;r++)s.add(i[r])}var f=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),m=Object.prototype.hasOwnProperty,y=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,x={},E={};function C(r){return m.call(E,r)?!0:m.call(x,r)?!1:y.test(r)?E[r]=!0:(x[r]=!0,!1)}function O(r,i,c,h){if(c!==null&&c.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return h?!1:c!==null?!c.acceptsBooleans:(r=r.toLowerCase().slice(0,5),r!=="data-"&&r!=="aria-");default:return!1}}function X(r,i,c,h){if(i===null||typeof i>"u"||O(r,i,c,h))return!0;if(h)return!1;if(c!==null)switch(c.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function B(r,i,c,h,p,v,S){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=h,this.attributeNamespace=p,this.mustUseProperty=c,this.propertyName=r,this.type=i,this.sanitizeURL=v,this.removeEmptyString=S}var U={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(r){U[r]=new B(r,0,!1,r,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(r){var i=r[0];U[i]=new B(i,1,!1,r[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(r){U[r]=new B(r,2,!1,r.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(r){U[r]=new B(r,2,!1,r,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(r){U[r]=new B(r,3,!1,r.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(r){U[r]=new B(r,3,!0,r,null,!1,!1)}),["capture","download"].forEach(function(r){U[r]=new B(r,4,!1,r,null,!1,!1)}),["cols","rows","size","span"].forEach(function(r){U[r]=new B(r,6,!1,r,null,!1,!1)}),["rowSpan","start"].forEach(function(r){U[r]=new B(r,5,!1,r.toLowerCase(),null,!1,!1)});var se=/[\-:]([a-z])/g;function we(r){return r[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(r){var i=r.replace(se,we);U[i]=new B(i,1,!1,r,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(r){var i=r.replace(se,we);U[i]=new B(i,1,!1,r,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(r){var i=r.replace(se,we);U[i]=new B(i,1,!1,r,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(r){U[r]=new B(r,1,!1,r.toLowerCase(),null,!1,!1)}),U.xlinkHref=new B("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(r){U[r]=new B(r,1,!1,r.toLowerCase(),null,!0,!0)});function _e(r,i,c,h){var p=U.hasOwnProperty(i)?U[i]:null;(p!==null?p.type!==0:h||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(X(i,c,p,h)&&(c=null),h||p===null?C(i)&&(c===null?r.removeAttribute(i):r.setAttribute(i,""+c)):p.mustUseProperty?r[p.propertyName]=c===null?p.type===3?!1:"":c:(i=p.attributeName,h=p.attributeNamespace,c===null?r.removeAttribute(i):(p=p.type,c=p===3||p===4&&c===!0?"":""+c,h?r.setAttributeNS(h,i,c):r.setAttribute(i,c))))}var ve=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,L=Symbol.for("react.element"),ie=Symbol.for("react.portal"),I=Symbol.for("react.fragment"),N=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),M=Symbol.for("react.provider"),D=Symbol.for("react.context"),P=Symbol.for("react.forward_ref"),b=Symbol.for("react.suspense"),J=Symbol.for("react.suspense_list"),re=Symbol.for("react.memo"),Ce=Symbol.for("react.lazy"),fe=Symbol.for("react.offscreen"),le=Symbol.iterator;function Pe(r){return r===null||typeof r!="object"?null:(r=le&&r[le]||r["@@iterator"],typeof r=="function"?r:null)}var xe=Object.assign,Y;function k(r){if(Y===void 0)try{throw Error()}catch(c){var i=c.stack.trim().match(/\n( *(at )?)/);Y=i&&i[1]||""}return`
`+Y+r}var K=!1;function Te(r,i){if(!r||K)return"";K=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(ae){var h=ae}Reflect.construct(r,[],i)}else{try{i.call()}catch(ae){h=ae}r.call(i.prototype)}else{try{throw Error()}catch(ae){h=ae}r()}}catch(ae){if(ae&&h&&typeof ae.stack=="string"){for(var p=ae.stack.split(`
`),v=h.stack.split(`
`),S=p.length-1,V=v.length-1;1<=S&&0<=V&&p[S]!==v[V];)V--;for(;1<=S&&0<=V;S--,V--)if(p[S]!==v[V]){if(S!==1||V!==1)do if(S--,V--,0>V||p[S]!==v[V]){var H=`
`+p[S].replace(" at new "," at ");return r.displayName&&H.includes("<anonymous>")&&(H=H.replace("<anonymous>",r.displayName)),H}while(1<=S&&0<=V);break}}}finally{K=!1,Error.prepareStackTrace=c}return(r=r?r.displayName||r.name:"")?k(r):""}function De(r){switch(r.tag){case 5:return k(r.type);case 16:return k("Lazy");case 13:return k("Suspense");case 19:return k("SuspenseList");case 0:case 2:case 15:return r=Te(r.type,!1),r;case 11:return r=Te(r.type.render,!1),r;case 1:return r=Te(r.type,!0),r;default:return""}}function ke(r){if(r==null)return null;if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case I:return"Fragment";case ie:return"Portal";case A:return"Profiler";case N:return"StrictMode";case b:return"Suspense";case J:return"SuspenseList"}if(typeof r=="object")switch(r.$$typeof){case D:return(r.displayName||"Context")+".Consumer";case M:return(r._context.displayName||"Context")+".Provider";case P:var i=r.render;return r=r.displayName,r||(r=i.displayName||i.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case re:return i=r.displayName||null,i!==null?i:ke(r.type)||"Memo";case Ce:i=r._payload,r=r._init;try{return ke(r(i))}catch{}}return null}function Oe(r){var i=r.type;switch(r.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return r=i.render,r=r.displayName||r.name||"",i.displayName||(r!==""?"ForwardRef("+r+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ke(i);case 8:return i===N?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function Qe(r){switch(typeof r){case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function nt(r){var i=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function me(r){var i=nt(r)?"checked":"value",c=Object.getOwnPropertyDescriptor(r.constructor.prototype,i),h=""+r[i];if(!r.hasOwnProperty(i)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var p=c.get,v=c.set;return Object.defineProperty(r,i,{configurable:!0,get:function(){return p.call(this)},set:function(S){h=""+S,v.call(this,S)}}),Object.defineProperty(r,i,{enumerable:c.enumerable}),{getValue:function(){return h},setValue:function(S){h=""+S},stopTracking:function(){r._valueTracker=null,delete r[i]}}}}function ce(r){r._valueTracker||(r._valueTracker=me(r))}function Le(r){if(!r)return!1;var i=r._valueTracker;if(!i)return!0;var c=i.getValue(),h="";return r&&(h=nt(r)?r.checked?"true":"false":r.value),r=h,r!==c?(i.setValue(r),!0):!1}function ge(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}function He(r,i){var c=i.checked;return xe({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:c??r._wrapperState.initialChecked})}function Je(r,i){var c=i.defaultValue==null?"":i.defaultValue,h=i.checked!=null?i.checked:i.defaultChecked;c=Qe(i.value!=null?i.value:c),r._wrapperState={initialChecked:h,initialValue:c,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function _t(r,i){i=i.checked,i!=null&&_e(r,"checked",i,!1)}function Ct(r,i){_t(r,i);var c=Qe(i.value),h=i.type;if(c!=null)h==="number"?(c===0&&r.value===""||r.value!=c)&&(r.value=""+c):r.value!==""+c&&(r.value=""+c);else if(h==="submit"||h==="reset"){r.removeAttribute("value");return}i.hasOwnProperty("value")?Ot(r,i.type,c):i.hasOwnProperty("defaultValue")&&Ot(r,i.type,Qe(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(r.defaultChecked=!!i.defaultChecked)}function Nt(r,i,c){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var h=i.type;if(!(h!=="submit"&&h!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+r._wrapperState.initialValue,c||i===r.value||(r.value=i),r.defaultValue=i}c=r.name,c!==""&&(r.name=""),r.defaultChecked=!!r._wrapperState.initialChecked,c!==""&&(r.name=c)}function Ot(r,i,c){(i!=="number"||ge(r.ownerDocument)!==r)&&(c==null?r.defaultValue=""+r._wrapperState.initialValue:r.defaultValue!==""+c&&(r.defaultValue=""+c))}var Zt=Array.isArray;function sn(r,i,c,h){if(r=r.options,i){i={};for(var p=0;p<c.length;p++)i["$"+c[p]]=!0;for(c=0;c<r.length;c++)p=i.hasOwnProperty("$"+r[c].value),r[c].selected!==p&&(r[c].selected=p),p&&h&&(r[c].defaultSelected=!0)}else{for(c=""+Qe(c),i=null,p=0;p<r.length;p++){if(r[p].value===c){r[p].selected=!0,h&&(r[p].defaultSelected=!0);return}i!==null||r[p].disabled||(i=r[p])}i!==null&&(i.selected=!0)}}function en(r,i){if(i.dangerouslySetInnerHTML!=null)throw Error(t(91));return xe({},i,{value:void 0,defaultValue:void 0,children:""+r._wrapperState.initialValue})}function qn(r,i){var c=i.value;if(c==null){if(c=i.children,i=i.defaultValue,c!=null){if(i!=null)throw Error(t(92));if(Zt(c)){if(1<c.length)throw Error(t(93));c=c[0]}i=c}i==null&&(i=""),c=i}r._wrapperState={initialValue:Qe(c)}}function yn(r,i){var c=Qe(i.value),h=Qe(i.defaultValue);c!=null&&(c=""+c,c!==r.value&&(r.value=c),i.defaultValue==null&&r.defaultValue!==c&&(r.defaultValue=c)),h!=null&&(r.defaultValue=""+h)}function cr(r){var i=r.textContent;i===r._wrapperState.initialValue&&i!==""&&i!==null&&(r.value=i)}function jt(r){switch(r){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Bt(r,i){return r==null||r==="http://www.w3.org/1999/xhtml"?jt(i):r==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":r}var In,Dn=(function(r){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,c,h,p){MSApp.execUnsafeLocalFunction(function(){return r(i,c,h,p)})}:r})(function(r,i){if(r.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in r)r.innerHTML=i;else{for(In=In||document.createElement("div"),In.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=In.firstChild;r.firstChild;)r.removeChild(r.firstChild);for(;i.firstChild;)r.appendChild(i.firstChild)}});function Hn(r,i){if(i){var c=r.firstChild;if(c&&c===r.lastChild&&c.nodeType===3){c.nodeValue=i;return}}r.textContent=i}var _r={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},xr=["Webkit","ms","Moz","O"];Object.keys(_r).forEach(function(r){xr.forEach(function(i){i=i+r.charAt(0).toUpperCase()+r.substring(1),_r[i]=_r[r]})});function ys(r,i,c){return i==null||typeof i=="boolean"||i===""?"":c||typeof i!="number"||i===0||_r.hasOwnProperty(r)&&_r[r]?(""+i).trim():i+"px"}function Kn(r,i){r=r.style;for(var c in i)if(i.hasOwnProperty(c)){var h=c.indexOf("--")===0,p=ys(c,i[c],h);c==="float"&&(c="cssFloat"),h?r.setProperty(c,p):r[c]=p}}var cn=xe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function un(r,i){if(i){if(cn[r]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(t(137,r));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(t(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(t(61))}if(i.style!=null&&typeof i.style!="object")throw Error(t(62))}}function vs(r,i){if(r.indexOf("-")===-1)return typeof i.is=="string";switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var mt=null;function wr(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Br=null,Qn=null,Nn=null;function Wr(r){if(r=fl(r)){if(typeof Br!="function")throw Error(t(280));var i=r.stateNode;i&&(i=jc(i),Br(r.stateNode,r.type,i))}}function ur(r){Qn?Nn?Nn.push(r):Nn=[r]:Qn=r}function Yn(){if(Qn){var r=Qn,i=Nn;if(Nn=Qn=null,Wr(r),i)for(r=0;r<i.length;r++)Wr(i[r])}}function Gr(r,i){return r(i)}function Xs(){}var dr=!1;function qr(r,i,c){if(dr)return r(i,c);dr=!0;try{return Gr(r,i,c)}finally{dr=!1,(Qn!==null||Nn!==null)&&(Xs(),Yn())}}function st(r,i){var c=r.stateNode;if(c===null)return null;var h=jc(c);if(h===null)return null;c=h[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(r=r.type,h=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!h;break e;default:r=!1}if(r)return null;if(c&&typeof c!="function")throw Error(t(231,i,typeof c));return c}var ks=!1;if(f)try{var vn={};Object.defineProperty(vn,"passive",{get:function(){ks=!0}}),window.addEventListener("test",vn,vn),window.removeEventListener("test",vn,vn)}catch{ks=!1}function _s(r,i,c,h,p,v,S,V,H){var ae=Array.prototype.slice.call(arguments,3);try{i.apply(c,ae)}catch(Se){this.onError(Se)}}var Hr=!1,Zs=null,Ft=!1,hr=null,Kr={onError:function(r){Hr=!0,Zs=r}};function Jn(r,i,c,h,p,v,S,V,H){Hr=!1,Zs=null,_s.apply(Kr,arguments)}function Xn(r,i,c,h,p,v,S,V,H){if(Jn.apply(this,arguments),Hr){if(Hr){var ae=Zs;Hr=!1,Zs=null}else throw Error(t(198));Ft||(Ft=!0,hr=ae)}}function Ut(r){var i=r,c=r;if(r.alternate)for(;i.return;)i=i.return;else{r=i;do i=r,(i.flags&4098)!==0&&(c=i.return),r=i.return;while(r)}return i.tag===3?c:null}function Er(r){if(r.tag===13){var i=r.memoizedState;if(i===null&&(r=r.alternate,r!==null&&(i=r.memoizedState)),i!==null)return i.dehydrated}return null}function Vn(r){if(Ut(r)!==r)throw Error(t(188))}function ei(r){var i=r.alternate;if(!i){if(i=Ut(r),i===null)throw Error(t(188));return i!==r?null:r}for(var c=r,h=i;;){var p=c.return;if(p===null)break;var v=p.alternate;if(v===null){if(h=p.return,h!==null){c=h;continue}break}if(p.child===v.child){for(v=p.child;v;){if(v===c)return Vn(p),r;if(v===h)return Vn(p),i;v=v.sibling}throw Error(t(188))}if(c.return!==h.return)c=p,h=v;else{for(var S=!1,V=p.child;V;){if(V===c){S=!0,c=p,h=v;break}if(V===h){S=!0,h=p,c=v;break}V=V.sibling}if(!S){for(V=v.child;V;){if(V===c){S=!0,c=v,h=p;break}if(V===h){S=!0,h=v,c=p;break}V=V.sibling}if(!S)throw Error(t(189))}}if(c.alternate!==h)throw Error(t(190))}if(c.tag!==3)throw Error(t(188));return c.stateNode.current===c?r:i}function Ds(r){return r=ei(r),r!==null?Qr(r):null}function Qr(r){if(r.tag===5||r.tag===6)return r;for(r=r.child;r!==null;){var i=Qr(r);if(i!==null)return i;r=r.sibling}return null}var Ln=e.unstable_scheduleCallback,Vs=e.unstable_cancelCallback,Yr=e.unstable_shouldYield,Jr=e.unstable_requestPaint,xt=e.unstable_now,Zn=e.unstable_getCurrentPriorityLevel,_n=e.unstable_ImmediatePriority,Wt=e.unstable_UserBlockingPriority,w=e.unstable_NormalPriority,z=e.unstable_LowPriority,W=e.unstable_IdlePriority,F=null,G=null;function ue(r){if(G&&typeof G.onCommitFiberRoot=="function")try{G.onCommitFiberRoot(F,r,void 0,(r.current.flags&128)===128)}catch{}}var te=Math.clz32?Math.clz32:$e,Me=Math.log,Ne=Math.LN2;function $e(r){return r>>>=0,r===0?32:31-(Me(r)/Ne|0)|0}var de=64,Xe=4194304;function Re(r){switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return r&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return r}}function ht(r,i){var c=r.pendingLanes;if(c===0)return 0;var h=0,p=r.suspendedLanes,v=r.pingedLanes,S=c&268435455;if(S!==0){var V=S&~p;V!==0?h=Re(V):(v&=S,v!==0&&(h=Re(v)))}else S=c&~p,S!==0?h=Re(S):v!==0&&(h=Re(v));if(h===0)return 0;if(i!==0&&i!==h&&(i&p)===0&&(p=h&-h,v=i&-i,p>=v||p===16&&(v&4194240)!==0))return i;if((h&4)!==0&&(h|=c&16),i=r.entangledLanes,i!==0)for(r=r.entanglements,i&=h;0<i;)c=31-te(i),p=1<<c,h|=r[c],i&=~p;return h}function Xr(r,i){switch(r){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function fr(r,i){for(var c=r.suspendedLanes,h=r.pingedLanes,p=r.expirationTimes,v=r.pendingLanes;0<v;){var S=31-te(v),V=1<<S,H=p[S];H===-1?((V&c)===0||(V&h)!==0)&&(p[S]=Xr(V,i)):H<=i&&(r.expiredLanes|=V),v&=~V}}function Mn(r){return r=r.pendingLanes&-1073741825,r!==0?r:r&1073741824?1073741824:0}function pr(){var r=de;return de<<=1,(de&4194240)===0&&(de=64),r}function Zr(r){for(var i=[],c=0;31>c;c++)i.push(r);return i}function Ls(r,i,c){r.pendingLanes|=i,i!==536870912&&(r.suspendedLanes=0,r.pingedLanes=0),r=r.eventTimes,i=31-te(i),r[i]=c}function Rt(r,i){var c=r.pendingLanes&~i;r.pendingLanes=i,r.suspendedLanes=0,r.pingedLanes=0,r.expiredLanes&=i,r.mutableReadLanes&=i,r.entangledLanes&=i,i=r.entanglements;var h=r.eventTimes;for(r=r.expirationTimes;0<c;){var p=31-te(c),v=1<<p;i[p]=0,h[p]=-1,r[p]=-1,c&=~v}}function Pt(r,i){var c=r.entangledLanes|=i;for(r=r.entanglements;c;){var h=31-te(c),p=1<<h;p&i|r[h]&i&&(r[h]|=i),c&=~p}}var ut=0;function On(r){return r&=-r,1<r?4<r?(r&268435455)!==0?16:536870912:4:1}var ga,ti,ya,Ja,es,Ci=!1,ts=[],dn=null,Tr=null,Sr=null,Ms=new Map,mr=new Map,ns=[],T="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function $(r,i){switch(r){case"focusin":case"focusout":dn=null;break;case"dragenter":case"dragleave":Tr=null;break;case"mouseover":case"mouseout":Sr=null;break;case"pointerover":case"pointerout":Ms.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":mr.delete(i.pointerId)}}function q(r,i,c,h,p,v){return r===null||r.nativeEvent!==v?(r={blockedOn:i,domEventName:c,eventSystemFlags:h,nativeEvent:v,targetContainers:[p]},i!==null&&(i=fl(i),i!==null&&ti(i)),r):(r.eventSystemFlags|=h,i=r.targetContainers,p!==null&&i.indexOf(p)===-1&&i.push(p),r)}function he(r,i,c,h,p){switch(i){case"focusin":return dn=q(dn,r,i,c,h,p),!0;case"dragenter":return Tr=q(Tr,r,i,c,h,p),!0;case"mouseover":return Sr=q(Sr,r,i,c,h,p),!0;case"pointerover":var v=p.pointerId;return Ms.set(v,q(Ms.get(v)||null,r,i,c,h,p)),!0;case"gotpointercapture":return v=p.pointerId,mr.set(v,q(mr.get(v)||null,r,i,c,h,p)),!0}return!1}function be(r){var i=wa(r.target);if(i!==null){var c=Ut(i);if(c!==null){if(i=c.tag,i===13){if(i=Er(c),i!==null){r.blockedOn=i,es(r.priority,function(){ya(c)});return}}else if(i===3&&c.stateNode.current.memoizedState.isDehydrated){r.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Be(r){if(r.blockedOn!==null)return!1;for(var i=r.targetContainers;0<i.length;){var c=wn(r.domEventName,r.eventSystemFlags,i[0],r.nativeEvent);if(c===null){c=r.nativeEvent;var h=new c.constructor(c.type,c);mt=h,c.target.dispatchEvent(h),mt=null}else return i=fl(c),i!==null&&ti(i),r.blockedOn=c,!1;i.shift()}return!0}function je(r,i,c){Be(r)&&c.delete(i)}function ct(){Ci=!1,dn!==null&&Be(dn)&&(dn=null),Tr!==null&&Be(Tr)&&(Tr=null),Sr!==null&&Be(Sr)&&(Sr=null),Ms.forEach(je),mr.forEach(je)}function dt(r,i){r.blockedOn===i&&(r.blockedOn=null,Ci||(Ci=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,ct)))}function gt(r){function i(p){return dt(p,r)}if(0<ts.length){dt(ts[0],r);for(var c=1;c<ts.length;c++){var h=ts[c];h.blockedOn===r&&(h.blockedOn=null)}}for(dn!==null&&dt(dn,r),Tr!==null&&dt(Tr,r),Sr!==null&&dt(Sr,r),Ms.forEach(i),mr.forEach(i),c=0;c<ns.length;c++)h=ns[c],h.blockedOn===r&&(h.blockedOn=null);for(;0<ns.length&&(c=ns[0],c.blockedOn===null);)be(c),c.blockedOn===null&&ns.shift()}var kt=ve.ReactCurrentBatchConfig,Dt=!0;function wt(r,i,c,h){var p=ut,v=kt.transition;kt.transition=null;try{ut=1,Et(r,i,c,h)}finally{ut=p,kt.transition=v}}function xn(r,i,c,h){var p=ut,v=kt.transition;kt.transition=null;try{ut=4,Et(r,i,c,h)}finally{ut=p,kt.transition=v}}function Et(r,i,c,h){if(Dt){var p=wn(r,i,c,h);if(p===null)Wd(r,i,h,br,c),$(r,h);else if(he(p,r,i,c,h))h.stopPropagation();else if($(r,h),i&4&&-1<T.indexOf(r)){for(;p!==null;){var v=fl(p);if(v!==null&&ga(v),v=wn(r,i,c,h),v===null&&Wd(r,i,h,br,c),v===p)break;p=v}p!==null&&h.stopPropagation()}else Wd(r,i,h,null,c)}}var br=null;function wn(r,i,c,h){if(br=null,r=wr(h),r=wa(r),r!==null)if(i=Ut(r),i===null)r=null;else if(c=i.tag,c===13){if(r=Er(i),r!==null)return r;r=null}else if(c===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;r=null}else i!==r&&(r=null);return br=r,null}function Lr(r){switch(r){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Zn()){case _n:return 1;case Wt:return 4;case w:case z:return 16;case W:return 536870912;default:return 16}default:return 16}}var Fn=null,Ii=null,er=null;function va(){if(er)return er;var r,i=Ii,c=i.length,h,p="value"in Fn?Fn.value:Fn.textContent,v=p.length;for(r=0;r<c&&i[r]===p[r];r++);var S=c-r;for(h=1;h<=S&&i[c-h]===p[v-h];h++);return er=p.slice(r,1<h?1-h:void 0)}function rs(r){var i=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&i===13&&(r=13)):r=i,r===10&&(r=13),32<=r||r===13?r:0}function ss(){return!0}function nl(){return!1}function Un(r){function i(c,h,p,v,S){this._reactName=c,this._targetInst=p,this.type=h,this.nativeEvent=v,this.target=S,this.currentTarget=null;for(var V in r)r.hasOwnProperty(V)&&(c=r[V],this[V]=c?c(v):v[V]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?ss:nl,this.isPropagationStopped=nl,this}return xe(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=ss)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=ss)},persist:function(){},isPersistent:ss}),i}var xs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Xa=Un(xs),Os=xe({},xs,{view:0,detail:0}),Dd=Un(Os),Za,ni,Ni,_a=xe({},Os,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Fs,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Ni&&(Ni&&r.type==="mousemove"?(Za=r.screenX-Ni.screenX,ni=r.screenY-Ni.screenY):ni=Za=0,Ni=r),Za)},movementY:function(r){return"movementY"in r?r.movementY:ni}}),eo=Un(_a),rl=xe({},_a,{dataTransfer:0}),vc=Un(rl),to=xe({},Os,{relatedTarget:0}),no=Un(to),_c=xe({},xs,{animationName:0,elapsedTime:0,pseudoElement:0}),ri=Un(_c),xc=xe({},xs,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),wc=Un(xc),Ec=xe({},xs,{data:0}),sl=Un(Ec),ro={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},gr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Tc={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sc(r){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(r):(r=Tc[r])?!!i[r]:!1}function Fs(){return Sc}var u=xe({},Os,{key:function(r){if(r.key){var i=ro[r.key]||r.key;if(i!=="Unidentified")return i}return r.type==="keypress"?(r=rs(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?gr[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Fs,charCode:function(r){return r.type==="keypress"?rs(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?rs(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),g=Un(u),_=xe({},_a,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),R=Un(_),Z=xe({},Os,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Fs}),oe=Un(Z),Ve=xe({},xs,{propertyName:0,elapsedTime:0,pseudoElement:0}),Vt=Un(Ve),En=xe({},_a,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),Tt=Un(En),Pn=[9,13,27,32],hn=f&&"CompositionEvent"in window,is=null;f&&"documentMode"in document&&(is=document.documentMode);var Mr=f&&"TextEvent"in window&&!is,xa=f&&(!hn||is&&8<is&&11>=is),so=" ",lm=!1;function cm(r,i){switch(r){case"keyup":return Pn.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function um(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var io=!1;function _w(r,i){switch(r){case"compositionend":return um(i);case"keypress":return i.which!==32?null:(lm=!0,so);case"textInput":return r=i.data,r===so&&lm?null:r;default:return null}}function xw(r,i){if(io)return r==="compositionend"||!hn&&cm(r,i)?(r=va(),er=Ii=Fn=null,io=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return xa&&i.locale!=="ko"?null:i.data;default:return null}}var ww={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function dm(r){var i=r&&r.nodeName&&r.nodeName.toLowerCase();return i==="input"?!!ww[r.type]:i==="textarea"}function hm(r,i,c,h){ur(h),i=Pc(i,"onChange"),0<i.length&&(c=new Xa("onChange","change",null,c,h),r.push({event:c,listeners:i}))}var il=null,al=null;function Ew(r){Rm(r,0)}function bc(r){var i=uo(r);if(Le(i))return r}function Tw(r,i){if(r==="change")return i}var fm=!1;if(f){var Vd;if(f){var Ld="oninput"in document;if(!Ld){var pm=document.createElement("div");pm.setAttribute("oninput","return;"),Ld=typeof pm.oninput=="function"}Vd=Ld}else Vd=!1;fm=Vd&&(!document.documentMode||9<document.documentMode)}function mm(){il&&(il.detachEvent("onpropertychange",gm),al=il=null)}function gm(r){if(r.propertyName==="value"&&bc(al)){var i=[];hm(i,al,r,wr(r)),qr(Ew,i)}}function Sw(r,i,c){r==="focusin"?(mm(),il=i,al=c,il.attachEvent("onpropertychange",gm)):r==="focusout"&&mm()}function bw(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return bc(al)}function Cw(r,i){if(r==="click")return bc(i)}function Iw(r,i){if(r==="input"||r==="change")return bc(i)}function Nw(r,i){return r===i&&(r!==0||1/r===1/i)||r!==r&&i!==i}var ws=typeof Object.is=="function"?Object.is:Nw;function ol(r,i){if(ws(r,i))return!0;if(typeof r!="object"||r===null||typeof i!="object"||i===null)return!1;var c=Object.keys(r),h=Object.keys(i);if(c.length!==h.length)return!1;for(h=0;h<c.length;h++){var p=c[h];if(!m.call(i,p)||!ws(r[p],i[p]))return!1}return!0}function ym(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function vm(r,i){var c=ym(r);r=0;for(var h;c;){if(c.nodeType===3){if(h=r+c.textContent.length,r<=i&&h>=i)return{node:c,offset:i-r};r=h}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=ym(c)}}function _m(r,i){return r&&i?r===i?!0:r&&r.nodeType===3?!1:i&&i.nodeType===3?_m(r,i.parentNode):"contains"in r?r.contains(i):r.compareDocumentPosition?!!(r.compareDocumentPosition(i)&16):!1:!1}function xm(){for(var r=window,i=ge();i instanceof r.HTMLIFrameElement;){try{var c=typeof i.contentWindow.location.href=="string"}catch{c=!1}if(c)r=i.contentWindow;else break;i=ge(r.document)}return i}function Md(r){var i=r&&r.nodeName&&r.nodeName.toLowerCase();return i&&(i==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||i==="textarea"||r.contentEditable==="true")}function Pw(r){var i=xm(),c=r.focusedElem,h=r.selectionRange;if(i!==c&&c&&c.ownerDocument&&_m(c.ownerDocument.documentElement,c)){if(h!==null&&Md(c)){if(i=h.start,r=h.end,r===void 0&&(r=i),"selectionStart"in c)c.selectionStart=i,c.selectionEnd=Math.min(r,c.value.length);else if(r=(i=c.ownerDocument||document)&&i.defaultView||window,r.getSelection){r=r.getSelection();var p=c.textContent.length,v=Math.min(h.start,p);h=h.end===void 0?v:Math.min(h.end,p),!r.extend&&v>h&&(p=h,h=v,v=p),p=vm(c,v);var S=vm(c,h);p&&S&&(r.rangeCount!==1||r.anchorNode!==p.node||r.anchorOffset!==p.offset||r.focusNode!==S.node||r.focusOffset!==S.offset)&&(i=i.createRange(),i.setStart(p.node,p.offset),r.removeAllRanges(),v>h?(r.addRange(i),r.extend(S.node,S.offset)):(i.setEnd(S.node,S.offset),r.addRange(i)))}}for(i=[],r=c;r=r.parentNode;)r.nodeType===1&&i.push({element:r,left:r.scrollLeft,top:r.scrollTop});for(typeof c.focus=="function"&&c.focus(),c=0;c<i.length;c++)r=i[c],r.element.scrollLeft=r.left,r.element.scrollTop=r.top}}var Rw=f&&"documentMode"in document&&11>=document.documentMode,ao=null,Od=null,ll=null,Fd=!1;function wm(r,i,c){var h=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Fd||ao==null||ao!==ge(h)||(h=ao,"selectionStart"in h&&Md(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),ll&&ol(ll,h)||(ll=h,h=Pc(Od,"onSelect"),0<h.length&&(i=new Xa("onSelect","select",null,i,c),r.push({event:i,listeners:h}),i.target=ao)))}function Cc(r,i){var c={};return c[r.toLowerCase()]=i.toLowerCase(),c["Webkit"+r]="webkit"+i,c["Moz"+r]="moz"+i,c}var oo={animationend:Cc("Animation","AnimationEnd"),animationiteration:Cc("Animation","AnimationIteration"),animationstart:Cc("Animation","AnimationStart"),transitionend:Cc("Transition","TransitionEnd")},Ud={},Em={};f&&(Em=document.createElement("div").style,"AnimationEvent"in window||(delete oo.animationend.animation,delete oo.animationiteration.animation,delete oo.animationstart.animation),"TransitionEvent"in window||delete oo.transitionend.transition);function Ic(r){if(Ud[r])return Ud[r];if(!oo[r])return r;var i=oo[r],c;for(c in i)if(i.hasOwnProperty(c)&&c in Em)return Ud[r]=i[c];return r}var Tm=Ic("animationend"),Sm=Ic("animationiteration"),bm=Ic("animationstart"),Cm=Ic("transitionend"),Im=new Map,Nm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Pi(r,i){Im.set(r,i),l(i,[r])}for(var zd=0;zd<Nm.length;zd++){var $d=Nm[zd],Aw=$d.toLowerCase(),jw=$d[0].toUpperCase()+$d.slice(1);Pi(Aw,"on"+jw)}Pi(Tm,"onAnimationEnd"),Pi(Sm,"onAnimationIteration"),Pi(bm,"onAnimationStart"),Pi("dblclick","onDoubleClick"),Pi("focusin","onFocus"),Pi("focusout","onBlur"),Pi(Cm,"onTransitionEnd"),d("onMouseEnter",["mouseout","mouseover"]),d("onMouseLeave",["mouseout","mouseover"]),d("onPointerEnter",["pointerout","pointerover"]),d("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var cl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),kw=new Set("cancel close invalid load scroll toggle".split(" ").concat(cl));function Pm(r,i,c){var h=r.type||"unknown-event";r.currentTarget=c,Xn(h,i,void 0,r),r.currentTarget=null}function Rm(r,i){i=(i&4)!==0;for(var c=0;c<r.length;c++){var h=r[c],p=h.event;h=h.listeners;e:{var v=void 0;if(i)for(var S=h.length-1;0<=S;S--){var V=h[S],H=V.instance,ae=V.currentTarget;if(V=V.listener,H!==v&&p.isPropagationStopped())break e;Pm(p,V,ae),v=H}else for(S=0;S<h.length;S++){if(V=h[S],H=V.instance,ae=V.currentTarget,V=V.listener,H!==v&&p.isPropagationStopped())break e;Pm(p,V,ae),v=H}}}if(Ft)throw r=hr,Ft=!1,hr=null,r}function Gt(r,i){var c=i[Yd];c===void 0&&(c=i[Yd]=new Set);var h=r+"__bubble";c.has(h)||(Am(i,r,2,!1),c.add(h))}function Bd(r,i,c){var h=0;i&&(h|=4),Am(c,r,h,i)}var Nc="_reactListening"+Math.random().toString(36).slice(2);function ul(r){if(!r[Nc]){r[Nc]=!0,s.forEach(function(c){c!=="selectionchange"&&(kw.has(c)||Bd(c,!1,r),Bd(c,!0,r))});var i=r.nodeType===9?r:r.ownerDocument;i===null||i[Nc]||(i[Nc]=!0,Bd("selectionchange",!1,i))}}function Am(r,i,c,h){switch(Lr(i)){case 1:var p=wt;break;case 4:p=xn;break;default:p=Et}c=p.bind(null,i,c,r),p=void 0,!ks||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(p=!0),h?p!==void 0?r.addEventListener(i,c,{capture:!0,passive:p}):r.addEventListener(i,c,!0):p!==void 0?r.addEventListener(i,c,{passive:p}):r.addEventListener(i,c,!1)}function Wd(r,i,c,h,p){var v=h;if((i&1)===0&&(i&2)===0&&h!==null)e:for(;;){if(h===null)return;var S=h.tag;if(S===3||S===4){var V=h.stateNode.containerInfo;if(V===p||V.nodeType===8&&V.parentNode===p)break;if(S===4)for(S=h.return;S!==null;){var H=S.tag;if((H===3||H===4)&&(H=S.stateNode.containerInfo,H===p||H.nodeType===8&&H.parentNode===p))return;S=S.return}for(;V!==null;){if(S=wa(V),S===null)return;if(H=S.tag,H===5||H===6){h=v=S;continue e}V=V.parentNode}}h=h.return}qr(function(){var ae=v,Se=wr(c),Ie=[];e:{var Ee=Im.get(r);if(Ee!==void 0){var Ue=Xa,Ge=r;switch(r){case"keypress":if(rs(c)===0)break e;case"keydown":case"keyup":Ue=g;break;case"focusin":Ge="focus",Ue=no;break;case"focusout":Ge="blur",Ue=no;break;case"beforeblur":case"afterblur":Ue=no;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ue=eo;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ue=vc;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ue=oe;break;case Tm:case Sm:case bm:Ue=ri;break;case Cm:Ue=Vt;break;case"scroll":Ue=Dd;break;case"wheel":Ue=Tt;break;case"copy":case"cut":case"paste":Ue=wc;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ue=R}var qe=(i&4)!==0,an=!qe&&r==="scroll",ee=qe?Ee!==null?Ee+"Capture":null:Ee;qe=[];for(var Q=ae,ne;Q!==null;){ne=Q;var Ae=ne.stateNode;if(ne.tag===5&&Ae!==null&&(ne=Ae,ee!==null&&(Ae=st(Q,ee),Ae!=null&&qe.push(dl(Q,Ae,ne)))),an)break;Q=Q.return}0<qe.length&&(Ee=new Ue(Ee,Ge,null,c,Se),Ie.push({event:Ee,listeners:qe}))}}if((i&7)===0){e:{if(Ee=r==="mouseover"||r==="pointerover",Ue=r==="mouseout"||r==="pointerout",Ee&&c!==mt&&(Ge=c.relatedTarget||c.fromElement)&&(wa(Ge)||Ge[si]))break e;if((Ue||Ee)&&(Ee=Se.window===Se?Se:(Ee=Se.ownerDocument)?Ee.defaultView||Ee.parentWindow:window,Ue?(Ge=c.relatedTarget||c.toElement,Ue=ae,Ge=Ge?wa(Ge):null,Ge!==null&&(an=Ut(Ge),Ge!==an||Ge.tag!==5&&Ge.tag!==6)&&(Ge=null)):(Ue=null,Ge=ae),Ue!==Ge)){if(qe=eo,Ae="onMouseLeave",ee="onMouseEnter",Q="mouse",(r==="pointerout"||r==="pointerover")&&(qe=R,Ae="onPointerLeave",ee="onPointerEnter",Q="pointer"),an=Ue==null?Ee:uo(Ue),ne=Ge==null?Ee:uo(Ge),Ee=new qe(Ae,Q+"leave",Ue,c,Se),Ee.target=an,Ee.relatedTarget=ne,Ae=null,wa(Se)===ae&&(qe=new qe(ee,Q+"enter",Ge,c,Se),qe.target=ne,qe.relatedTarget=an,Ae=qe),an=Ae,Ue&&Ge)t:{for(qe=Ue,ee=Ge,Q=0,ne=qe;ne;ne=lo(ne))Q++;for(ne=0,Ae=ee;Ae;Ae=lo(Ae))ne++;for(;0<Q-ne;)qe=lo(qe),Q--;for(;0<ne-Q;)ee=lo(ee),ne--;for(;Q--;){if(qe===ee||ee!==null&&qe===ee.alternate)break t;qe=lo(qe),ee=lo(ee)}qe=null}else qe=null;Ue!==null&&jm(Ie,Ee,Ue,qe,!1),Ge!==null&&an!==null&&jm(Ie,an,Ge,qe,!0)}}e:{if(Ee=ae?uo(ae):window,Ue=Ee.nodeName&&Ee.nodeName.toLowerCase(),Ue==="select"||Ue==="input"&&Ee.type==="file")var Ke=Tw;else if(dm(Ee))if(fm)Ke=Iw;else{Ke=bw;var Ze=Sw}else(Ue=Ee.nodeName)&&Ue.toLowerCase()==="input"&&(Ee.type==="checkbox"||Ee.type==="radio")&&(Ke=Cw);if(Ke&&(Ke=Ke(r,ae))){hm(Ie,Ke,c,Se);break e}Ze&&Ze(r,Ee,ae),r==="focusout"&&(Ze=Ee._wrapperState)&&Ze.controlled&&Ee.type==="number"&&Ot(Ee,"number",Ee.value)}switch(Ze=ae?uo(ae):window,r){case"focusin":(dm(Ze)||Ze.contentEditable==="true")&&(ao=Ze,Od=ae,ll=null);break;case"focusout":ll=Od=ao=null;break;case"mousedown":Fd=!0;break;case"contextmenu":case"mouseup":case"dragend":Fd=!1,wm(Ie,c,Se);break;case"selectionchange":if(Rw)break;case"keydown":case"keyup":wm(Ie,c,Se)}var et;if(hn)e:{switch(r){case"compositionstart":var it="onCompositionStart";break e;case"compositionend":it="onCompositionEnd";break e;case"compositionupdate":it="onCompositionUpdate";break e}it=void 0}else io?cm(r,c)&&(it="onCompositionEnd"):r==="keydown"&&c.keyCode===229&&(it="onCompositionStart");it&&(xa&&c.locale!=="ko"&&(io||it!=="onCompositionStart"?it==="onCompositionEnd"&&io&&(et=va()):(Fn=Se,Ii="value"in Fn?Fn.value:Fn.textContent,io=!0)),Ze=Pc(ae,it),0<Ze.length&&(it=new sl(it,r,null,c,Se),Ie.push({event:it,listeners:Ze}),et?it.data=et:(et=um(c),et!==null&&(it.data=et)))),(et=Mr?_w(r,c):xw(r,c))&&(ae=Pc(ae,"onBeforeInput"),0<ae.length&&(Se=new sl("onBeforeInput","beforeinput",null,c,Se),Ie.push({event:Se,listeners:ae}),Se.data=et))}Rm(Ie,i)})}function dl(r,i,c){return{instance:r,listener:i,currentTarget:c}}function Pc(r,i){for(var c=i+"Capture",h=[];r!==null;){var p=r,v=p.stateNode;p.tag===5&&v!==null&&(p=v,v=st(r,c),v!=null&&h.unshift(dl(r,v,p)),v=st(r,i),v!=null&&h.push(dl(r,v,p))),r=r.return}return h}function lo(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5);return r||null}function jm(r,i,c,h,p){for(var v=i._reactName,S=[];c!==null&&c!==h;){var V=c,H=V.alternate,ae=V.stateNode;if(H!==null&&H===h)break;V.tag===5&&ae!==null&&(V=ae,p?(H=st(c,v),H!=null&&S.unshift(dl(c,H,V))):p||(H=st(c,v),H!=null&&S.push(dl(c,H,V)))),c=c.return}S.length!==0&&r.push({event:i,listeners:S})}var Dw=/\r\n?/g,Vw=/\u0000|\uFFFD/g;function km(r){return(typeof r=="string"?r:""+r).replace(Dw,`
`).replace(Vw,"")}function Rc(r,i,c){if(i=km(i),km(r)!==i&&c)throw Error(t(425))}function Ac(){}var Gd=null,qd=null;function Hd(r,i){return r==="textarea"||r==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Kd=typeof setTimeout=="function"?setTimeout:void 0,Lw=typeof clearTimeout=="function"?clearTimeout:void 0,Dm=typeof Promise=="function"?Promise:void 0,Mw=typeof queueMicrotask=="function"?queueMicrotask:typeof Dm<"u"?function(r){return Dm.resolve(null).then(r).catch(Ow)}:Kd;function Ow(r){setTimeout(function(){throw r})}function Qd(r,i){var c=i,h=0;do{var p=c.nextSibling;if(r.removeChild(c),p&&p.nodeType===8)if(c=p.data,c==="/$"){if(h===0){r.removeChild(p),gt(i);return}h--}else c!=="$"&&c!=="$?"&&c!=="$!"||h++;c=p}while(c);gt(i)}function Ri(r){for(;r!=null;r=r.nextSibling){var i=r.nodeType;if(i===1||i===3)break;if(i===8){if(i=r.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return r}function Vm(r){r=r.previousSibling;for(var i=0;r;){if(r.nodeType===8){var c=r.data;if(c==="$"||c==="$!"||c==="$?"){if(i===0)return r;i--}else c==="/$"&&i++}r=r.previousSibling}return null}var co=Math.random().toString(36).slice(2),Us="__reactFiber$"+co,hl="__reactProps$"+co,si="__reactContainer$"+co,Yd="__reactEvents$"+co,Fw="__reactListeners$"+co,Uw="__reactHandles$"+co;function wa(r){var i=r[Us];if(i)return i;for(var c=r.parentNode;c;){if(i=c[si]||c[Us]){if(c=i.alternate,i.child!==null||c!==null&&c.child!==null)for(r=Vm(r);r!==null;){if(c=r[Us])return c;r=Vm(r)}return i}r=c,c=r.parentNode}return null}function fl(r){return r=r[Us]||r[si],!r||r.tag!==5&&r.tag!==6&&r.tag!==13&&r.tag!==3?null:r}function uo(r){if(r.tag===5||r.tag===6)return r.stateNode;throw Error(t(33))}function jc(r){return r[hl]||null}var Jd=[],ho=-1;function Ai(r){return{current:r}}function qt(r){0>ho||(r.current=Jd[ho],Jd[ho]=null,ho--)}function zt(r,i){ho++,Jd[ho]=r.current,r.current=i}var ji={},tr=Ai(ji),Cr=Ai(!1),Ea=ji;function fo(r,i){var c=r.type.contextTypes;if(!c)return ji;var h=r.stateNode;if(h&&h.__reactInternalMemoizedUnmaskedChildContext===i)return h.__reactInternalMemoizedMaskedChildContext;var p={},v;for(v in c)p[v]=i[v];return h&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=i,r.__reactInternalMemoizedMaskedChildContext=p),p}function Ir(r){return r=r.childContextTypes,r!=null}function kc(){qt(Cr),qt(tr)}function Lm(r,i,c){if(tr.current!==ji)throw Error(t(168));zt(tr,i),zt(Cr,c)}function Mm(r,i,c){var h=r.stateNode;if(i=i.childContextTypes,typeof h.getChildContext!="function")return c;h=h.getChildContext();for(var p in h)if(!(p in i))throw Error(t(108,Oe(r)||"Unknown",p));return xe({},c,h)}function Dc(r){return r=(r=r.stateNode)&&r.__reactInternalMemoizedMergedChildContext||ji,Ea=tr.current,zt(tr,r),zt(Cr,Cr.current),!0}function Om(r,i,c){var h=r.stateNode;if(!h)throw Error(t(169));c?(r=Mm(r,i,Ea),h.__reactInternalMemoizedMergedChildContext=r,qt(Cr),qt(tr),zt(tr,r)):qt(Cr),zt(Cr,c)}var ii=null,Vc=!1,Xd=!1;function Fm(r){ii===null?ii=[r]:ii.push(r)}function zw(r){Vc=!0,Fm(r)}function ki(){if(!Xd&&ii!==null){Xd=!0;var r=0,i=ut;try{var c=ii;for(ut=1;r<c.length;r++){var h=c[r];do h=h(!0);while(h!==null)}ii=null,Vc=!1}catch(p){throw ii!==null&&(ii=ii.slice(r+1)),Ln(_n,ki),p}finally{ut=i,Xd=!1}}return null}var po=[],mo=0,Lc=null,Mc=0,as=[],os=0,Ta=null,ai=1,oi="";function Sa(r,i){po[mo++]=Mc,po[mo++]=Lc,Lc=r,Mc=i}function Um(r,i,c){as[os++]=ai,as[os++]=oi,as[os++]=Ta,Ta=r;var h=ai;r=oi;var p=32-te(h)-1;h&=~(1<<p),c+=1;var v=32-te(i)+p;if(30<v){var S=p-p%5;v=(h&(1<<S)-1).toString(32),h>>=S,p-=S,ai=1<<32-te(i)+p|c<<p|h,oi=v+r}else ai=1<<v|c<<p|h,oi=r}function Zd(r){r.return!==null&&(Sa(r,1),Um(r,1,0))}function eh(r){for(;r===Lc;)Lc=po[--mo],po[mo]=null,Mc=po[--mo],po[mo]=null;for(;r===Ta;)Ta=as[--os],as[os]=null,oi=as[--os],as[os]=null,ai=as[--os],as[os]=null}var Or=null,Fr=null,Kt=!1,Es=null;function zm(r,i){var c=ds(5,null,null,0);c.elementType="DELETED",c.stateNode=i,c.return=r,i=r.deletions,i===null?(r.deletions=[c],r.flags|=16):i.push(c)}function $m(r,i){switch(r.tag){case 5:var c=r.type;return i=i.nodeType!==1||c.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(r.stateNode=i,Or=r,Fr=Ri(i.firstChild),!0):!1;case 6:return i=r.pendingProps===""||i.nodeType!==3?null:i,i!==null?(r.stateNode=i,Or=r,Fr=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(c=Ta!==null?{id:ai,overflow:oi}:null,r.memoizedState={dehydrated:i,treeContext:c,retryLane:1073741824},c=ds(18,null,null,0),c.stateNode=i,c.return=r,r.child=c,Or=r,Fr=null,!0):!1;default:return!1}}function th(r){return(r.mode&1)!==0&&(r.flags&128)===0}function nh(r){if(Kt){var i=Fr;if(i){var c=i;if(!$m(r,i)){if(th(r))throw Error(t(418));i=Ri(c.nextSibling);var h=Or;i&&$m(r,i)?zm(h,c):(r.flags=r.flags&-4097|2,Kt=!1,Or=r)}}else{if(th(r))throw Error(t(418));r.flags=r.flags&-4097|2,Kt=!1,Or=r}}}function Bm(r){for(r=r.return;r!==null&&r.tag!==5&&r.tag!==3&&r.tag!==13;)r=r.return;Or=r}function Oc(r){if(r!==Or)return!1;if(!Kt)return Bm(r),Kt=!0,!1;var i;if((i=r.tag!==3)&&!(i=r.tag!==5)&&(i=r.type,i=i!=="head"&&i!=="body"&&!Hd(r.type,r.memoizedProps)),i&&(i=Fr)){if(th(r))throw Wm(),Error(t(418));for(;i;)zm(r,i),i=Ri(i.nextSibling)}if(Bm(r),r.tag===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(t(317));e:{for(r=r.nextSibling,i=0;r;){if(r.nodeType===8){var c=r.data;if(c==="/$"){if(i===0){Fr=Ri(r.nextSibling);break e}i--}else c!=="$"&&c!=="$!"&&c!=="$?"||i++}r=r.nextSibling}Fr=null}}else Fr=Or?Ri(r.stateNode.nextSibling):null;return!0}function Wm(){for(var r=Fr;r;)r=Ri(r.nextSibling)}function go(){Fr=Or=null,Kt=!1}function rh(r){Es===null?Es=[r]:Es.push(r)}var $w=ve.ReactCurrentBatchConfig;function pl(r,i,c){if(r=c.ref,r!==null&&typeof r!="function"&&typeof r!="object"){if(c._owner){if(c=c._owner,c){if(c.tag!==1)throw Error(t(309));var h=c.stateNode}if(!h)throw Error(t(147,r));var p=h,v=""+r;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===v?i.ref:(i=function(S){var V=p.refs;S===null?delete V[v]:V[v]=S},i._stringRef=v,i)}if(typeof r!="string")throw Error(t(284));if(!c._owner)throw Error(t(290,r))}return r}function Fc(r,i){throw r=Object.prototype.toString.call(i),Error(t(31,r==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":r))}function Gm(r){var i=r._init;return i(r._payload)}function qm(r){function i(ee,Q){if(r){var ne=ee.deletions;ne===null?(ee.deletions=[Q],ee.flags|=16):ne.push(Q)}}function c(ee,Q){if(!r)return null;for(;Q!==null;)i(ee,Q),Q=Q.sibling;return null}function h(ee,Q){for(ee=new Map;Q!==null;)Q.key!==null?ee.set(Q.key,Q):ee.set(Q.index,Q),Q=Q.sibling;return ee}function p(ee,Q){return ee=zi(ee,Q),ee.index=0,ee.sibling=null,ee}function v(ee,Q,ne){return ee.index=ne,r?(ne=ee.alternate,ne!==null?(ne=ne.index,ne<Q?(ee.flags|=2,Q):ne):(ee.flags|=2,Q)):(ee.flags|=1048576,Q)}function S(ee){return r&&ee.alternate===null&&(ee.flags|=2),ee}function V(ee,Q,ne,Ae){return Q===null||Q.tag!==6?(Q=Kh(ne,ee.mode,Ae),Q.return=ee,Q):(Q=p(Q,ne),Q.return=ee,Q)}function H(ee,Q,ne,Ae){var Ke=ne.type;return Ke===I?Se(ee,Q,ne.props.children,Ae,ne.key):Q!==null&&(Q.elementType===Ke||typeof Ke=="object"&&Ke!==null&&Ke.$$typeof===Ce&&Gm(Ke)===Q.type)?(Ae=p(Q,ne.props),Ae.ref=pl(ee,Q,ne),Ae.return=ee,Ae):(Ae=cu(ne.type,ne.key,ne.props,null,ee.mode,Ae),Ae.ref=pl(ee,Q,ne),Ae.return=ee,Ae)}function ae(ee,Q,ne,Ae){return Q===null||Q.tag!==4||Q.stateNode.containerInfo!==ne.containerInfo||Q.stateNode.implementation!==ne.implementation?(Q=Qh(ne,ee.mode,Ae),Q.return=ee,Q):(Q=p(Q,ne.children||[]),Q.return=ee,Q)}function Se(ee,Q,ne,Ae,Ke){return Q===null||Q.tag!==7?(Q=ja(ne,ee.mode,Ae,Ke),Q.return=ee,Q):(Q=p(Q,ne),Q.return=ee,Q)}function Ie(ee,Q,ne){if(typeof Q=="string"&&Q!==""||typeof Q=="number")return Q=Kh(""+Q,ee.mode,ne),Q.return=ee,Q;if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case L:return ne=cu(Q.type,Q.key,Q.props,null,ee.mode,ne),ne.ref=pl(ee,null,Q),ne.return=ee,ne;case ie:return Q=Qh(Q,ee.mode,ne),Q.return=ee,Q;case Ce:var Ae=Q._init;return Ie(ee,Ae(Q._payload),ne)}if(Zt(Q)||Pe(Q))return Q=ja(Q,ee.mode,ne,null),Q.return=ee,Q;Fc(ee,Q)}return null}function Ee(ee,Q,ne,Ae){var Ke=Q!==null?Q.key:null;if(typeof ne=="string"&&ne!==""||typeof ne=="number")return Ke!==null?null:V(ee,Q,""+ne,Ae);if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case L:return ne.key===Ke?H(ee,Q,ne,Ae):null;case ie:return ne.key===Ke?ae(ee,Q,ne,Ae):null;case Ce:return Ke=ne._init,Ee(ee,Q,Ke(ne._payload),Ae)}if(Zt(ne)||Pe(ne))return Ke!==null?null:Se(ee,Q,ne,Ae,null);Fc(ee,ne)}return null}function Ue(ee,Q,ne,Ae,Ke){if(typeof Ae=="string"&&Ae!==""||typeof Ae=="number")return ee=ee.get(ne)||null,V(Q,ee,""+Ae,Ke);if(typeof Ae=="object"&&Ae!==null){switch(Ae.$$typeof){case L:return ee=ee.get(Ae.key===null?ne:Ae.key)||null,H(Q,ee,Ae,Ke);case ie:return ee=ee.get(Ae.key===null?ne:Ae.key)||null,ae(Q,ee,Ae,Ke);case Ce:var Ze=Ae._init;return Ue(ee,Q,ne,Ze(Ae._payload),Ke)}if(Zt(Ae)||Pe(Ae))return ee=ee.get(ne)||null,Se(Q,ee,Ae,Ke,null);Fc(Q,Ae)}return null}function Ge(ee,Q,ne,Ae){for(var Ke=null,Ze=null,et=Q,it=Q=0,jn=null;et!==null&&it<ne.length;it++){et.index>it?(jn=et,et=null):jn=et.sibling;var It=Ee(ee,et,ne[it],Ae);if(It===null){et===null&&(et=jn);break}r&&et&&It.alternate===null&&i(ee,et),Q=v(It,Q,it),Ze===null?Ke=It:Ze.sibling=It,Ze=It,et=jn}if(it===ne.length)return c(ee,et),Kt&&Sa(ee,it),Ke;if(et===null){for(;it<ne.length;it++)et=Ie(ee,ne[it],Ae),et!==null&&(Q=v(et,Q,it),Ze===null?Ke=et:Ze.sibling=et,Ze=et);return Kt&&Sa(ee,it),Ke}for(et=h(ee,et);it<ne.length;it++)jn=Ue(et,ee,it,ne[it],Ae),jn!==null&&(r&&jn.alternate!==null&&et.delete(jn.key===null?it:jn.key),Q=v(jn,Q,it),Ze===null?Ke=jn:Ze.sibling=jn,Ze=jn);return r&&et.forEach(function($i){return i(ee,$i)}),Kt&&Sa(ee,it),Ke}function qe(ee,Q,ne,Ae){var Ke=Pe(ne);if(typeof Ke!="function")throw Error(t(150));if(ne=Ke.call(ne),ne==null)throw Error(t(151));for(var Ze=Ke=null,et=Q,it=Q=0,jn=null,It=ne.next();et!==null&&!It.done;it++,It=ne.next()){et.index>it?(jn=et,et=null):jn=et.sibling;var $i=Ee(ee,et,It.value,Ae);if($i===null){et===null&&(et=jn);break}r&&et&&$i.alternate===null&&i(ee,et),Q=v($i,Q,it),Ze===null?Ke=$i:Ze.sibling=$i,Ze=$i,et=jn}if(It.done)return c(ee,et),Kt&&Sa(ee,it),Ke;if(et===null){for(;!It.done;it++,It=ne.next())It=Ie(ee,It.value,Ae),It!==null&&(Q=v(It,Q,it),Ze===null?Ke=It:Ze.sibling=It,Ze=It);return Kt&&Sa(ee,it),Ke}for(et=h(ee,et);!It.done;it++,It=ne.next())It=Ue(et,ee,it,It.value,Ae),It!==null&&(r&&It.alternate!==null&&et.delete(It.key===null?it:It.key),Q=v(It,Q,it),Ze===null?Ke=It:Ze.sibling=It,Ze=It);return r&&et.forEach(function(wE){return i(ee,wE)}),Kt&&Sa(ee,it),Ke}function an(ee,Q,ne,Ae){if(typeof ne=="object"&&ne!==null&&ne.type===I&&ne.key===null&&(ne=ne.props.children),typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case L:e:{for(var Ke=ne.key,Ze=Q;Ze!==null;){if(Ze.key===Ke){if(Ke=ne.type,Ke===I){if(Ze.tag===7){c(ee,Ze.sibling),Q=p(Ze,ne.props.children),Q.return=ee,ee=Q;break e}}else if(Ze.elementType===Ke||typeof Ke=="object"&&Ke!==null&&Ke.$$typeof===Ce&&Gm(Ke)===Ze.type){c(ee,Ze.sibling),Q=p(Ze,ne.props),Q.ref=pl(ee,Ze,ne),Q.return=ee,ee=Q;break e}c(ee,Ze);break}else i(ee,Ze);Ze=Ze.sibling}ne.type===I?(Q=ja(ne.props.children,ee.mode,Ae,ne.key),Q.return=ee,ee=Q):(Ae=cu(ne.type,ne.key,ne.props,null,ee.mode,Ae),Ae.ref=pl(ee,Q,ne),Ae.return=ee,ee=Ae)}return S(ee);case ie:e:{for(Ze=ne.key;Q!==null;){if(Q.key===Ze)if(Q.tag===4&&Q.stateNode.containerInfo===ne.containerInfo&&Q.stateNode.implementation===ne.implementation){c(ee,Q.sibling),Q=p(Q,ne.children||[]),Q.return=ee,ee=Q;break e}else{c(ee,Q);break}else i(ee,Q);Q=Q.sibling}Q=Qh(ne,ee.mode,Ae),Q.return=ee,ee=Q}return S(ee);case Ce:return Ze=ne._init,an(ee,Q,Ze(ne._payload),Ae)}if(Zt(ne))return Ge(ee,Q,ne,Ae);if(Pe(ne))return qe(ee,Q,ne,Ae);Fc(ee,ne)}return typeof ne=="string"&&ne!==""||typeof ne=="number"?(ne=""+ne,Q!==null&&Q.tag===6?(c(ee,Q.sibling),Q=p(Q,ne),Q.return=ee,ee=Q):(c(ee,Q),Q=Kh(ne,ee.mode,Ae),Q.return=ee,ee=Q),S(ee)):c(ee,Q)}return an}var yo=qm(!0),Hm=qm(!1),Uc=Ai(null),zc=null,vo=null,sh=null;function ih(){sh=vo=zc=null}function ah(r){var i=Uc.current;qt(Uc),r._currentValue=i}function oh(r,i,c){for(;r!==null;){var h=r.alternate;if((r.childLanes&i)!==i?(r.childLanes|=i,h!==null&&(h.childLanes|=i)):h!==null&&(h.childLanes&i)!==i&&(h.childLanes|=i),r===c)break;r=r.return}}function _o(r,i){zc=r,sh=vo=null,r=r.dependencies,r!==null&&r.firstContext!==null&&((r.lanes&i)!==0&&(Nr=!0),r.firstContext=null)}function ls(r){var i=r._currentValue;if(sh!==r)if(r={context:r,memoizedValue:i,next:null},vo===null){if(zc===null)throw Error(t(308));vo=r,zc.dependencies={lanes:0,firstContext:r}}else vo=vo.next=r;return i}var ba=null;function lh(r){ba===null?ba=[r]:ba.push(r)}function Km(r,i,c,h){var p=i.interleaved;return p===null?(c.next=c,lh(i)):(c.next=p.next,p.next=c),i.interleaved=c,li(r,h)}function li(r,i){r.lanes|=i;var c=r.alternate;for(c!==null&&(c.lanes|=i),c=r,r=r.return;r!==null;)r.childLanes|=i,c=r.alternate,c!==null&&(c.childLanes|=i),c=r,r=r.return;return c.tag===3?c.stateNode:null}var Di=!1;function ch(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Qm(r,i){r=r.updateQueue,i.updateQueue===r&&(i.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,effects:r.effects})}function ci(r,i){return{eventTime:r,lane:i,tag:0,payload:null,callback:null,next:null}}function Vi(r,i,c){var h=r.updateQueue;if(h===null)return null;if(h=h.shared,(bt&2)!==0){var p=h.pending;return p===null?i.next=i:(i.next=p.next,p.next=i),h.pending=i,li(r,c)}return p=h.interleaved,p===null?(i.next=i,lh(h)):(i.next=p.next,p.next=i),h.interleaved=i,li(r,c)}function $c(r,i,c){if(i=i.updateQueue,i!==null&&(i=i.shared,(c&4194240)!==0)){var h=i.lanes;h&=r.pendingLanes,c|=h,i.lanes=c,Pt(r,c)}}function Ym(r,i){var c=r.updateQueue,h=r.alternate;if(h!==null&&(h=h.updateQueue,c===h)){var p=null,v=null;if(c=c.firstBaseUpdate,c!==null){do{var S={eventTime:c.eventTime,lane:c.lane,tag:c.tag,payload:c.payload,callback:c.callback,next:null};v===null?p=v=S:v=v.next=S,c=c.next}while(c!==null);v===null?p=v=i:v=v.next=i}else p=v=i;c={baseState:h.baseState,firstBaseUpdate:p,lastBaseUpdate:v,shared:h.shared,effects:h.effects},r.updateQueue=c;return}r=c.lastBaseUpdate,r===null?c.firstBaseUpdate=i:r.next=i,c.lastBaseUpdate=i}function Bc(r,i,c,h){var p=r.updateQueue;Di=!1;var v=p.firstBaseUpdate,S=p.lastBaseUpdate,V=p.shared.pending;if(V!==null){p.shared.pending=null;var H=V,ae=H.next;H.next=null,S===null?v=ae:S.next=ae,S=H;var Se=r.alternate;Se!==null&&(Se=Se.updateQueue,V=Se.lastBaseUpdate,V!==S&&(V===null?Se.firstBaseUpdate=ae:V.next=ae,Se.lastBaseUpdate=H))}if(v!==null){var Ie=p.baseState;S=0,Se=ae=H=null,V=v;do{var Ee=V.lane,Ue=V.eventTime;if((h&Ee)===Ee){Se!==null&&(Se=Se.next={eventTime:Ue,lane:0,tag:V.tag,payload:V.payload,callback:V.callback,next:null});e:{var Ge=r,qe=V;switch(Ee=i,Ue=c,qe.tag){case 1:if(Ge=qe.payload,typeof Ge=="function"){Ie=Ge.call(Ue,Ie,Ee);break e}Ie=Ge;break e;case 3:Ge.flags=Ge.flags&-65537|128;case 0:if(Ge=qe.payload,Ee=typeof Ge=="function"?Ge.call(Ue,Ie,Ee):Ge,Ee==null)break e;Ie=xe({},Ie,Ee);break e;case 2:Di=!0}}V.callback!==null&&V.lane!==0&&(r.flags|=64,Ee=p.effects,Ee===null?p.effects=[V]:Ee.push(V))}else Ue={eventTime:Ue,lane:Ee,tag:V.tag,payload:V.payload,callback:V.callback,next:null},Se===null?(ae=Se=Ue,H=Ie):Se=Se.next=Ue,S|=Ee;if(V=V.next,V===null){if(V=p.shared.pending,V===null)break;Ee=V,V=Ee.next,Ee.next=null,p.lastBaseUpdate=Ee,p.shared.pending=null}}while(!0);if(Se===null&&(H=Ie),p.baseState=H,p.firstBaseUpdate=ae,p.lastBaseUpdate=Se,i=p.shared.interleaved,i!==null){p=i;do S|=p.lane,p=p.next;while(p!==i)}else v===null&&(p.shared.lanes=0);Na|=S,r.lanes=S,r.memoizedState=Ie}}function Jm(r,i,c){if(r=i.effects,i.effects=null,r!==null)for(i=0;i<r.length;i++){var h=r[i],p=h.callback;if(p!==null){if(h.callback=null,h=c,typeof p!="function")throw Error(t(191,p));p.call(h)}}}var ml={},zs=Ai(ml),gl=Ai(ml),yl=Ai(ml);function Ca(r){if(r===ml)throw Error(t(174));return r}function uh(r,i){switch(zt(yl,i),zt(gl,r),zt(zs,ml),r=i.nodeType,r){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:Bt(null,"");break;default:r=r===8?i.parentNode:i,i=r.namespaceURI||null,r=r.tagName,i=Bt(i,r)}qt(zs),zt(zs,i)}function xo(){qt(zs),qt(gl),qt(yl)}function Xm(r){Ca(yl.current);var i=Ca(zs.current),c=Bt(i,r.type);i!==c&&(zt(gl,r),zt(zs,c))}function dh(r){gl.current===r&&(qt(zs),qt(gl))}var Yt=Ai(0);function Wc(r){for(var i=r;i!==null;){if(i.tag===13){var c=i.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||c.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===r)break;for(;i.sibling===null;){if(i.return===null||i.return===r)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var hh=[];function fh(){for(var r=0;r<hh.length;r++)hh[r]._workInProgressVersionPrimary=null;hh.length=0}var Gc=ve.ReactCurrentDispatcher,ph=ve.ReactCurrentBatchConfig,Ia=0,Jt=null,Tn=null,Rn=null,qc=!1,vl=!1,_l=0,Bw=0;function nr(){throw Error(t(321))}function mh(r,i){if(i===null)return!1;for(var c=0;c<i.length&&c<r.length;c++)if(!ws(r[c],i[c]))return!1;return!0}function gh(r,i,c,h,p,v){if(Ia=v,Jt=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,Gc.current=r===null||r.memoizedState===null?Hw:Kw,r=c(h,p),vl){v=0;do{if(vl=!1,_l=0,25<=v)throw Error(t(301));v+=1,Rn=Tn=null,i.updateQueue=null,Gc.current=Qw,r=c(h,p)}while(vl)}if(Gc.current=Qc,i=Tn!==null&&Tn.next!==null,Ia=0,Rn=Tn=Jt=null,qc=!1,i)throw Error(t(300));return r}function yh(){var r=_l!==0;return _l=0,r}function $s(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Rn===null?Jt.memoizedState=Rn=r:Rn=Rn.next=r,Rn}function cs(){if(Tn===null){var r=Jt.alternate;r=r!==null?r.memoizedState:null}else r=Tn.next;var i=Rn===null?Jt.memoizedState:Rn.next;if(i!==null)Rn=i,Tn=r;else{if(r===null)throw Error(t(310));Tn=r,r={memoizedState:Tn.memoizedState,baseState:Tn.baseState,baseQueue:Tn.baseQueue,queue:Tn.queue,next:null},Rn===null?Jt.memoizedState=Rn=r:Rn=Rn.next=r}return Rn}function xl(r,i){return typeof i=="function"?i(r):i}function vh(r){var i=cs(),c=i.queue;if(c===null)throw Error(t(311));c.lastRenderedReducer=r;var h=Tn,p=h.baseQueue,v=c.pending;if(v!==null){if(p!==null){var S=p.next;p.next=v.next,v.next=S}h.baseQueue=p=v,c.pending=null}if(p!==null){v=p.next,h=h.baseState;var V=S=null,H=null,ae=v;do{var Se=ae.lane;if((Ia&Se)===Se)H!==null&&(H=H.next={lane:0,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null}),h=ae.hasEagerState?ae.eagerState:r(h,ae.action);else{var Ie={lane:Se,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null};H===null?(V=H=Ie,S=h):H=H.next=Ie,Jt.lanes|=Se,Na|=Se}ae=ae.next}while(ae!==null&&ae!==v);H===null?S=h:H.next=V,ws(h,i.memoizedState)||(Nr=!0),i.memoizedState=h,i.baseState=S,i.baseQueue=H,c.lastRenderedState=h}if(r=c.interleaved,r!==null){p=r;do v=p.lane,Jt.lanes|=v,Na|=v,p=p.next;while(p!==r)}else p===null&&(c.lanes=0);return[i.memoizedState,c.dispatch]}function _h(r){var i=cs(),c=i.queue;if(c===null)throw Error(t(311));c.lastRenderedReducer=r;var h=c.dispatch,p=c.pending,v=i.memoizedState;if(p!==null){c.pending=null;var S=p=p.next;do v=r(v,S.action),S=S.next;while(S!==p);ws(v,i.memoizedState)||(Nr=!0),i.memoizedState=v,i.baseQueue===null&&(i.baseState=v),c.lastRenderedState=v}return[v,h]}function Zm(){}function eg(r,i){var c=Jt,h=cs(),p=i(),v=!ws(h.memoizedState,p);if(v&&(h.memoizedState=p,Nr=!0),h=h.queue,xh(rg.bind(null,c,h,r),[r]),h.getSnapshot!==i||v||Rn!==null&&Rn.memoizedState.tag&1){if(c.flags|=2048,wl(9,ng.bind(null,c,h,p,i),void 0,null),An===null)throw Error(t(349));(Ia&30)!==0||tg(c,i,p)}return p}function tg(r,i,c){r.flags|=16384,r={getSnapshot:i,value:c},i=Jt.updateQueue,i===null?(i={lastEffect:null,stores:null},Jt.updateQueue=i,i.stores=[r]):(c=i.stores,c===null?i.stores=[r]:c.push(r))}function ng(r,i,c,h){i.value=c,i.getSnapshot=h,sg(i)&&ig(r)}function rg(r,i,c){return c(function(){sg(i)&&ig(r)})}function sg(r){var i=r.getSnapshot;r=r.value;try{var c=i();return!ws(r,c)}catch{return!0}}function ig(r){var i=li(r,1);i!==null&&Cs(i,r,1,-1)}function ag(r){var i=$s();return typeof r=="function"&&(r=r()),i.memoizedState=i.baseState=r,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xl,lastRenderedState:r},i.queue=r,r=r.dispatch=qw.bind(null,Jt,r),[i.memoizedState,r]}function wl(r,i,c,h){return r={tag:r,create:i,destroy:c,deps:h,next:null},i=Jt.updateQueue,i===null?(i={lastEffect:null,stores:null},Jt.updateQueue=i,i.lastEffect=r.next=r):(c=i.lastEffect,c===null?i.lastEffect=r.next=r:(h=c.next,c.next=r,r.next=h,i.lastEffect=r)),r}function og(){return cs().memoizedState}function Hc(r,i,c,h){var p=$s();Jt.flags|=r,p.memoizedState=wl(1|i,c,void 0,h===void 0?null:h)}function Kc(r,i,c,h){var p=cs();h=h===void 0?null:h;var v=void 0;if(Tn!==null){var S=Tn.memoizedState;if(v=S.destroy,h!==null&&mh(h,S.deps)){p.memoizedState=wl(i,c,v,h);return}}Jt.flags|=r,p.memoizedState=wl(1|i,c,v,h)}function lg(r,i){return Hc(8390656,8,r,i)}function xh(r,i){return Kc(2048,8,r,i)}function cg(r,i){return Kc(4,2,r,i)}function ug(r,i){return Kc(4,4,r,i)}function dg(r,i){if(typeof i=="function")return r=r(),i(r),function(){i(null)};if(i!=null)return r=r(),i.current=r,function(){i.current=null}}function hg(r,i,c){return c=c!=null?c.concat([r]):null,Kc(4,4,dg.bind(null,i,r),c)}function wh(){}function fg(r,i){var c=cs();i=i===void 0?null:i;var h=c.memoizedState;return h!==null&&i!==null&&mh(i,h[1])?h[0]:(c.memoizedState=[r,i],r)}function pg(r,i){var c=cs();i=i===void 0?null:i;var h=c.memoizedState;return h!==null&&i!==null&&mh(i,h[1])?h[0]:(r=r(),c.memoizedState=[r,i],r)}function mg(r,i,c){return(Ia&21)===0?(r.baseState&&(r.baseState=!1,Nr=!0),r.memoizedState=c):(ws(c,i)||(c=pr(),Jt.lanes|=c,Na|=c,r.baseState=!0),i)}function Ww(r,i){var c=ut;ut=c!==0&&4>c?c:4,r(!0);var h=ph.transition;ph.transition={};try{r(!1),i()}finally{ut=c,ph.transition=h}}function gg(){return cs().memoizedState}function Gw(r,i,c){var h=Fi(r);if(c={lane:h,action:c,hasEagerState:!1,eagerState:null,next:null},yg(r))vg(i,c);else if(c=Km(r,i,c,h),c!==null){var p=vr();Cs(c,r,h,p),_g(c,i,h)}}function qw(r,i,c){var h=Fi(r),p={lane:h,action:c,hasEagerState:!1,eagerState:null,next:null};if(yg(r))vg(i,p);else{var v=r.alternate;if(r.lanes===0&&(v===null||v.lanes===0)&&(v=i.lastRenderedReducer,v!==null))try{var S=i.lastRenderedState,V=v(S,c);if(p.hasEagerState=!0,p.eagerState=V,ws(V,S)){var H=i.interleaved;H===null?(p.next=p,lh(i)):(p.next=H.next,H.next=p),i.interleaved=p;return}}catch{}finally{}c=Km(r,i,p,h),c!==null&&(p=vr(),Cs(c,r,h,p),_g(c,i,h))}}function yg(r){var i=r.alternate;return r===Jt||i!==null&&i===Jt}function vg(r,i){vl=qc=!0;var c=r.pending;c===null?i.next=i:(i.next=c.next,c.next=i),r.pending=i}function _g(r,i,c){if((c&4194240)!==0){var h=i.lanes;h&=r.pendingLanes,c|=h,i.lanes=c,Pt(r,c)}}var Qc={readContext:ls,useCallback:nr,useContext:nr,useEffect:nr,useImperativeHandle:nr,useInsertionEffect:nr,useLayoutEffect:nr,useMemo:nr,useReducer:nr,useRef:nr,useState:nr,useDebugValue:nr,useDeferredValue:nr,useTransition:nr,useMutableSource:nr,useSyncExternalStore:nr,useId:nr,unstable_isNewReconciler:!1},Hw={readContext:ls,useCallback:function(r,i){return $s().memoizedState=[r,i===void 0?null:i],r},useContext:ls,useEffect:lg,useImperativeHandle:function(r,i,c){return c=c!=null?c.concat([r]):null,Hc(4194308,4,dg.bind(null,i,r),c)},useLayoutEffect:function(r,i){return Hc(4194308,4,r,i)},useInsertionEffect:function(r,i){return Hc(4,2,r,i)},useMemo:function(r,i){var c=$s();return i=i===void 0?null:i,r=r(),c.memoizedState=[r,i],r},useReducer:function(r,i,c){var h=$s();return i=c!==void 0?c(i):i,h.memoizedState=h.baseState=i,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:i},h.queue=r,r=r.dispatch=Gw.bind(null,Jt,r),[h.memoizedState,r]},useRef:function(r){var i=$s();return r={current:r},i.memoizedState=r},useState:ag,useDebugValue:wh,useDeferredValue:function(r){return $s().memoizedState=r},useTransition:function(){var r=ag(!1),i=r[0];return r=Ww.bind(null,r[1]),$s().memoizedState=r,[i,r]},useMutableSource:function(){},useSyncExternalStore:function(r,i,c){var h=Jt,p=$s();if(Kt){if(c===void 0)throw Error(t(407));c=c()}else{if(c=i(),An===null)throw Error(t(349));(Ia&30)!==0||tg(h,i,c)}p.memoizedState=c;var v={value:c,getSnapshot:i};return p.queue=v,lg(rg.bind(null,h,v,r),[r]),h.flags|=2048,wl(9,ng.bind(null,h,v,c,i),void 0,null),c},useId:function(){var r=$s(),i=An.identifierPrefix;if(Kt){var c=oi,h=ai;c=(h&~(1<<32-te(h)-1)).toString(32)+c,i=":"+i+"R"+c,c=_l++,0<c&&(i+="H"+c.toString(32)),i+=":"}else c=Bw++,i=":"+i+"r"+c.toString(32)+":";return r.memoizedState=i},unstable_isNewReconciler:!1},Kw={readContext:ls,useCallback:fg,useContext:ls,useEffect:xh,useImperativeHandle:hg,useInsertionEffect:cg,useLayoutEffect:ug,useMemo:pg,useReducer:vh,useRef:og,useState:function(){return vh(xl)},useDebugValue:wh,useDeferredValue:function(r){var i=cs();return mg(i,Tn.memoizedState,r)},useTransition:function(){var r=vh(xl)[0],i=cs().memoizedState;return[r,i]},useMutableSource:Zm,useSyncExternalStore:eg,useId:gg,unstable_isNewReconciler:!1},Qw={readContext:ls,useCallback:fg,useContext:ls,useEffect:xh,useImperativeHandle:hg,useInsertionEffect:cg,useLayoutEffect:ug,useMemo:pg,useReducer:_h,useRef:og,useState:function(){return _h(xl)},useDebugValue:wh,useDeferredValue:function(r){var i=cs();return Tn===null?i.memoizedState=r:mg(i,Tn.memoizedState,r)},useTransition:function(){var r=_h(xl)[0],i=cs().memoizedState;return[r,i]},useMutableSource:Zm,useSyncExternalStore:eg,useId:gg,unstable_isNewReconciler:!1};function Ts(r,i){if(r&&r.defaultProps){i=xe({},i),r=r.defaultProps;for(var c in r)i[c]===void 0&&(i[c]=r[c]);return i}return i}function Eh(r,i,c,h){i=r.memoizedState,c=c(h,i),c=c==null?i:xe({},i,c),r.memoizedState=c,r.lanes===0&&(r.updateQueue.baseState=c)}var Yc={isMounted:function(r){return(r=r._reactInternals)?Ut(r)===r:!1},enqueueSetState:function(r,i,c){r=r._reactInternals;var h=vr(),p=Fi(r),v=ci(h,p);v.payload=i,c!=null&&(v.callback=c),i=Vi(r,v,p),i!==null&&(Cs(i,r,p,h),$c(i,r,p))},enqueueReplaceState:function(r,i,c){r=r._reactInternals;var h=vr(),p=Fi(r),v=ci(h,p);v.tag=1,v.payload=i,c!=null&&(v.callback=c),i=Vi(r,v,p),i!==null&&(Cs(i,r,p,h),$c(i,r,p))},enqueueForceUpdate:function(r,i){r=r._reactInternals;var c=vr(),h=Fi(r),p=ci(c,h);p.tag=2,i!=null&&(p.callback=i),i=Vi(r,p,h),i!==null&&(Cs(i,r,h,c),$c(i,r,h))}};function xg(r,i,c,h,p,v,S){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(h,v,S):i.prototype&&i.prototype.isPureReactComponent?!ol(c,h)||!ol(p,v):!0}function wg(r,i,c){var h=!1,p=ji,v=i.contextType;return typeof v=="object"&&v!==null?v=ls(v):(p=Ir(i)?Ea:tr.current,h=i.contextTypes,v=(h=h!=null)?fo(r,p):ji),i=new i(c,v),r.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=Yc,r.stateNode=i,i._reactInternals=r,h&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=p,r.__reactInternalMemoizedMaskedChildContext=v),i}function Eg(r,i,c,h){r=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(c,h),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(c,h),i.state!==r&&Yc.enqueueReplaceState(i,i.state,null)}function Th(r,i,c,h){var p=r.stateNode;p.props=c,p.state=r.memoizedState,p.refs={},ch(r);var v=i.contextType;typeof v=="object"&&v!==null?p.context=ls(v):(v=Ir(i)?Ea:tr.current,p.context=fo(r,v)),p.state=r.memoizedState,v=i.getDerivedStateFromProps,typeof v=="function"&&(Eh(r,i,v,c),p.state=r.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(i=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),i!==p.state&&Yc.enqueueReplaceState(p,p.state,null),Bc(r,c,p,h),p.state=r.memoizedState),typeof p.componentDidMount=="function"&&(r.flags|=4194308)}function wo(r,i){try{var c="",h=i;do c+=De(h),h=h.return;while(h);var p=c}catch(v){p=`
Error generating stack: `+v.message+`
`+v.stack}return{value:r,source:i,stack:p,digest:null}}function Sh(r,i,c){return{value:r,source:null,stack:c??null,digest:i??null}}function bh(r,i){try{console.error(i.value)}catch(c){setTimeout(function(){throw c})}}var Yw=typeof WeakMap=="function"?WeakMap:Map;function Tg(r,i,c){c=ci(-1,c),c.tag=3,c.payload={element:null};var h=i.value;return c.callback=function(){ru||(ru=!0,Uh=h),bh(r,i)},c}function Sg(r,i,c){c=ci(-1,c),c.tag=3;var h=r.type.getDerivedStateFromError;if(typeof h=="function"){var p=i.value;c.payload=function(){return h(p)},c.callback=function(){bh(r,i)}}var v=r.stateNode;return v!==null&&typeof v.componentDidCatch=="function"&&(c.callback=function(){bh(r,i),typeof h!="function"&&(Mi===null?Mi=new Set([this]):Mi.add(this));var S=i.stack;this.componentDidCatch(i.value,{componentStack:S!==null?S:""})}),c}function bg(r,i,c){var h=r.pingCache;if(h===null){h=r.pingCache=new Yw;var p=new Set;h.set(i,p)}else p=h.get(i),p===void 0&&(p=new Set,h.set(i,p));p.has(c)||(p.add(c),r=uE.bind(null,r,i,c),i.then(r,r))}function Cg(r){do{var i;if((i=r.tag===13)&&(i=r.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return r;r=r.return}while(r!==null);return null}function Ig(r,i,c,h,p){return(r.mode&1)===0?(r===i?r.flags|=65536:(r.flags|=128,c.flags|=131072,c.flags&=-52805,c.tag===1&&(c.alternate===null?c.tag=17:(i=ci(-1,1),i.tag=2,Vi(c,i,1))),c.lanes|=1),r):(r.flags|=65536,r.lanes=p,r)}var Jw=ve.ReactCurrentOwner,Nr=!1;function yr(r,i,c,h){i.child=r===null?Hm(i,null,c,h):yo(i,r.child,c,h)}function Ng(r,i,c,h,p){c=c.render;var v=i.ref;return _o(i,p),h=gh(r,i,c,h,v,p),c=yh(),r!==null&&!Nr?(i.updateQueue=r.updateQueue,i.flags&=-2053,r.lanes&=~p,ui(r,i,p)):(Kt&&c&&Zd(i),i.flags|=1,yr(r,i,h,p),i.child)}function Pg(r,i,c,h,p){if(r===null){var v=c.type;return typeof v=="function"&&!Hh(v)&&v.defaultProps===void 0&&c.compare===null&&c.defaultProps===void 0?(i.tag=15,i.type=v,Rg(r,i,v,h,p)):(r=cu(c.type,null,h,i,i.mode,p),r.ref=i.ref,r.return=i,i.child=r)}if(v=r.child,(r.lanes&p)===0){var S=v.memoizedProps;if(c=c.compare,c=c!==null?c:ol,c(S,h)&&r.ref===i.ref)return ui(r,i,p)}return i.flags|=1,r=zi(v,h),r.ref=i.ref,r.return=i,i.child=r}function Rg(r,i,c,h,p){if(r!==null){var v=r.memoizedProps;if(ol(v,h)&&r.ref===i.ref)if(Nr=!1,i.pendingProps=h=v,(r.lanes&p)!==0)(r.flags&131072)!==0&&(Nr=!0);else return i.lanes=r.lanes,ui(r,i,p)}return Ch(r,i,c,h,p)}function Ag(r,i,c){var h=i.pendingProps,p=h.children,v=r!==null?r.memoizedState:null;if(h.mode==="hidden")if((i.mode&1)===0)i.memoizedState={baseLanes:0,cachePool:null,transitions:null},zt(To,Ur),Ur|=c;else{if((c&1073741824)===0)return r=v!==null?v.baseLanes|c:c,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:r,cachePool:null,transitions:null},i.updateQueue=null,zt(To,Ur),Ur|=r,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},h=v!==null?v.baseLanes:c,zt(To,Ur),Ur|=h}else v!==null?(h=v.baseLanes|c,i.memoizedState=null):h=c,zt(To,Ur),Ur|=h;return yr(r,i,p,c),i.child}function jg(r,i){var c=i.ref;(r===null&&c!==null||r!==null&&r.ref!==c)&&(i.flags|=512,i.flags|=2097152)}function Ch(r,i,c,h,p){var v=Ir(c)?Ea:tr.current;return v=fo(i,v),_o(i,p),c=gh(r,i,c,h,v,p),h=yh(),r!==null&&!Nr?(i.updateQueue=r.updateQueue,i.flags&=-2053,r.lanes&=~p,ui(r,i,p)):(Kt&&h&&Zd(i),i.flags|=1,yr(r,i,c,p),i.child)}function kg(r,i,c,h,p){if(Ir(c)){var v=!0;Dc(i)}else v=!1;if(_o(i,p),i.stateNode===null)Xc(r,i),wg(i,c,h),Th(i,c,h,p),h=!0;else if(r===null){var S=i.stateNode,V=i.memoizedProps;S.props=V;var H=S.context,ae=c.contextType;typeof ae=="object"&&ae!==null?ae=ls(ae):(ae=Ir(c)?Ea:tr.current,ae=fo(i,ae));var Se=c.getDerivedStateFromProps,Ie=typeof Se=="function"||typeof S.getSnapshotBeforeUpdate=="function";Ie||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(V!==h||H!==ae)&&Eg(i,S,h,ae),Di=!1;var Ee=i.memoizedState;S.state=Ee,Bc(i,h,S,p),H=i.memoizedState,V!==h||Ee!==H||Cr.current||Di?(typeof Se=="function"&&(Eh(i,c,Se,h),H=i.memoizedState),(V=Di||xg(i,c,V,h,Ee,H,ae))?(Ie||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount()),typeof S.componentDidMount=="function"&&(i.flags|=4194308)):(typeof S.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=h,i.memoizedState=H),S.props=h,S.state=H,S.context=ae,h=V):(typeof S.componentDidMount=="function"&&(i.flags|=4194308),h=!1)}else{S=i.stateNode,Qm(r,i),V=i.memoizedProps,ae=i.type===i.elementType?V:Ts(i.type,V),S.props=ae,Ie=i.pendingProps,Ee=S.context,H=c.contextType,typeof H=="object"&&H!==null?H=ls(H):(H=Ir(c)?Ea:tr.current,H=fo(i,H));var Ue=c.getDerivedStateFromProps;(Se=typeof Ue=="function"||typeof S.getSnapshotBeforeUpdate=="function")||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(V!==Ie||Ee!==H)&&Eg(i,S,h,H),Di=!1,Ee=i.memoizedState,S.state=Ee,Bc(i,h,S,p);var Ge=i.memoizedState;V!==Ie||Ee!==Ge||Cr.current||Di?(typeof Ue=="function"&&(Eh(i,c,Ue,h),Ge=i.memoizedState),(ae=Di||xg(i,c,ae,h,Ee,Ge,H)||!1)?(Se||typeof S.UNSAFE_componentWillUpdate!="function"&&typeof S.componentWillUpdate!="function"||(typeof S.componentWillUpdate=="function"&&S.componentWillUpdate(h,Ge,H),typeof S.UNSAFE_componentWillUpdate=="function"&&S.UNSAFE_componentWillUpdate(h,Ge,H)),typeof S.componentDidUpdate=="function"&&(i.flags|=4),typeof S.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof S.componentDidUpdate!="function"||V===r.memoizedProps&&Ee===r.memoizedState||(i.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||V===r.memoizedProps&&Ee===r.memoizedState||(i.flags|=1024),i.memoizedProps=h,i.memoizedState=Ge),S.props=h,S.state=Ge,S.context=H,h=ae):(typeof S.componentDidUpdate!="function"||V===r.memoizedProps&&Ee===r.memoizedState||(i.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||V===r.memoizedProps&&Ee===r.memoizedState||(i.flags|=1024),h=!1)}return Ih(r,i,c,h,v,p)}function Ih(r,i,c,h,p,v){jg(r,i);var S=(i.flags&128)!==0;if(!h&&!S)return p&&Om(i,c,!1),ui(r,i,v);h=i.stateNode,Jw.current=i;var V=S&&typeof c.getDerivedStateFromError!="function"?null:h.render();return i.flags|=1,r!==null&&S?(i.child=yo(i,r.child,null,v),i.child=yo(i,null,V,v)):yr(r,i,V,v),i.memoizedState=h.state,p&&Om(i,c,!0),i.child}function Dg(r){var i=r.stateNode;i.pendingContext?Lm(r,i.pendingContext,i.pendingContext!==i.context):i.context&&Lm(r,i.context,!1),uh(r,i.containerInfo)}function Vg(r,i,c,h,p){return go(),rh(p),i.flags|=256,yr(r,i,c,h),i.child}var Nh={dehydrated:null,treeContext:null,retryLane:0};function Ph(r){return{baseLanes:r,cachePool:null,transitions:null}}function Lg(r,i,c){var h=i.pendingProps,p=Yt.current,v=!1,S=(i.flags&128)!==0,V;if((V=S)||(V=r!==null&&r.memoizedState===null?!1:(p&2)!==0),V?(v=!0,i.flags&=-129):(r===null||r.memoizedState!==null)&&(p|=1),zt(Yt,p&1),r===null)return nh(i),r=i.memoizedState,r!==null&&(r=r.dehydrated,r!==null)?((i.mode&1)===0?i.lanes=1:r.data==="$!"?i.lanes=8:i.lanes=1073741824,null):(S=h.children,r=h.fallback,v?(h=i.mode,v=i.child,S={mode:"hidden",children:S},(h&1)===0&&v!==null?(v.childLanes=0,v.pendingProps=S):v=uu(S,h,0,null),r=ja(r,h,c,null),v.return=i,r.return=i,v.sibling=r,i.child=v,i.child.memoizedState=Ph(c),i.memoizedState=Nh,r):Rh(i,S));if(p=r.memoizedState,p!==null&&(V=p.dehydrated,V!==null))return Xw(r,i,S,h,V,p,c);if(v){v=h.fallback,S=i.mode,p=r.child,V=p.sibling;var H={mode:"hidden",children:h.children};return(S&1)===0&&i.child!==p?(h=i.child,h.childLanes=0,h.pendingProps=H,i.deletions=null):(h=zi(p,H),h.subtreeFlags=p.subtreeFlags&14680064),V!==null?v=zi(V,v):(v=ja(v,S,c,null),v.flags|=2),v.return=i,h.return=i,h.sibling=v,i.child=h,h=v,v=i.child,S=r.child.memoizedState,S=S===null?Ph(c):{baseLanes:S.baseLanes|c,cachePool:null,transitions:S.transitions},v.memoizedState=S,v.childLanes=r.childLanes&~c,i.memoizedState=Nh,h}return v=r.child,r=v.sibling,h=zi(v,{mode:"visible",children:h.children}),(i.mode&1)===0&&(h.lanes=c),h.return=i,h.sibling=null,r!==null&&(c=i.deletions,c===null?(i.deletions=[r],i.flags|=16):c.push(r)),i.child=h,i.memoizedState=null,h}function Rh(r,i){return i=uu({mode:"visible",children:i},r.mode,0,null),i.return=r,r.child=i}function Jc(r,i,c,h){return h!==null&&rh(h),yo(i,r.child,null,c),r=Rh(i,i.pendingProps.children),r.flags|=2,i.memoizedState=null,r}function Xw(r,i,c,h,p,v,S){if(c)return i.flags&256?(i.flags&=-257,h=Sh(Error(t(422))),Jc(r,i,S,h)):i.memoizedState!==null?(i.child=r.child,i.flags|=128,null):(v=h.fallback,p=i.mode,h=uu({mode:"visible",children:h.children},p,0,null),v=ja(v,p,S,null),v.flags|=2,h.return=i,v.return=i,h.sibling=v,i.child=h,(i.mode&1)!==0&&yo(i,r.child,null,S),i.child.memoizedState=Ph(S),i.memoizedState=Nh,v);if((i.mode&1)===0)return Jc(r,i,S,null);if(p.data==="$!"){if(h=p.nextSibling&&p.nextSibling.dataset,h)var V=h.dgst;return h=V,v=Error(t(419)),h=Sh(v,h,void 0),Jc(r,i,S,h)}if(V=(S&r.childLanes)!==0,Nr||V){if(h=An,h!==null){switch(S&-S){case 4:p=2;break;case 16:p=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:p=32;break;case 536870912:p=268435456;break;default:p=0}p=(p&(h.suspendedLanes|S))!==0?0:p,p!==0&&p!==v.retryLane&&(v.retryLane=p,li(r,p),Cs(h,r,p,-1))}return qh(),h=Sh(Error(t(421))),Jc(r,i,S,h)}return p.data==="$?"?(i.flags|=128,i.child=r.child,i=dE.bind(null,r),p._reactRetry=i,null):(r=v.treeContext,Fr=Ri(p.nextSibling),Or=i,Kt=!0,Es=null,r!==null&&(as[os++]=ai,as[os++]=oi,as[os++]=Ta,ai=r.id,oi=r.overflow,Ta=i),i=Rh(i,h.children),i.flags|=4096,i)}function Mg(r,i,c){r.lanes|=i;var h=r.alternate;h!==null&&(h.lanes|=i),oh(r.return,i,c)}function Ah(r,i,c,h,p){var v=r.memoizedState;v===null?r.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:h,tail:c,tailMode:p}:(v.isBackwards=i,v.rendering=null,v.renderingStartTime=0,v.last=h,v.tail=c,v.tailMode=p)}function Og(r,i,c){var h=i.pendingProps,p=h.revealOrder,v=h.tail;if(yr(r,i,h.children,c),h=Yt.current,(h&2)!==0)h=h&1|2,i.flags|=128;else{if(r!==null&&(r.flags&128)!==0)e:for(r=i.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&Mg(r,c,i);else if(r.tag===19)Mg(r,c,i);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===i)break e;for(;r.sibling===null;){if(r.return===null||r.return===i)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}h&=1}if(zt(Yt,h),(i.mode&1)===0)i.memoizedState=null;else switch(p){case"forwards":for(c=i.child,p=null;c!==null;)r=c.alternate,r!==null&&Wc(r)===null&&(p=c),c=c.sibling;c=p,c===null?(p=i.child,i.child=null):(p=c.sibling,c.sibling=null),Ah(i,!1,p,c,v);break;case"backwards":for(c=null,p=i.child,i.child=null;p!==null;){if(r=p.alternate,r!==null&&Wc(r)===null){i.child=p;break}r=p.sibling,p.sibling=c,c=p,p=r}Ah(i,!0,c,null,v);break;case"together":Ah(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function Xc(r,i){(i.mode&1)===0&&r!==null&&(r.alternate=null,i.alternate=null,i.flags|=2)}function ui(r,i,c){if(r!==null&&(i.dependencies=r.dependencies),Na|=i.lanes,(c&i.childLanes)===0)return null;if(r!==null&&i.child!==r.child)throw Error(t(153));if(i.child!==null){for(r=i.child,c=zi(r,r.pendingProps),i.child=c,c.return=i;r.sibling!==null;)r=r.sibling,c=c.sibling=zi(r,r.pendingProps),c.return=i;c.sibling=null}return i.child}function Zw(r,i,c){switch(i.tag){case 3:Dg(i),go();break;case 5:Xm(i);break;case 1:Ir(i.type)&&Dc(i);break;case 4:uh(i,i.stateNode.containerInfo);break;case 10:var h=i.type._context,p=i.memoizedProps.value;zt(Uc,h._currentValue),h._currentValue=p;break;case 13:if(h=i.memoizedState,h!==null)return h.dehydrated!==null?(zt(Yt,Yt.current&1),i.flags|=128,null):(c&i.child.childLanes)!==0?Lg(r,i,c):(zt(Yt,Yt.current&1),r=ui(r,i,c),r!==null?r.sibling:null);zt(Yt,Yt.current&1);break;case 19:if(h=(c&i.childLanes)!==0,(r.flags&128)!==0){if(h)return Og(r,i,c);i.flags|=128}if(p=i.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),zt(Yt,Yt.current),h)break;return null;case 22:case 23:return i.lanes=0,Ag(r,i,c)}return ui(r,i,c)}var Fg,jh,Ug,zg;Fg=function(r,i){for(var c=i.child;c!==null;){if(c.tag===5||c.tag===6)r.appendChild(c.stateNode);else if(c.tag!==4&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===i)break;for(;c.sibling===null;){if(c.return===null||c.return===i)return;c=c.return}c.sibling.return=c.return,c=c.sibling}},jh=function(){},Ug=function(r,i,c,h){var p=r.memoizedProps;if(p!==h){r=i.stateNode,Ca(zs.current);var v=null;switch(c){case"input":p=He(r,p),h=He(r,h),v=[];break;case"select":p=xe({},p,{value:void 0}),h=xe({},h,{value:void 0}),v=[];break;case"textarea":p=en(r,p),h=en(r,h),v=[];break;default:typeof p.onClick!="function"&&typeof h.onClick=="function"&&(r.onclick=Ac)}un(c,h);var S;c=null;for(ae in p)if(!h.hasOwnProperty(ae)&&p.hasOwnProperty(ae)&&p[ae]!=null)if(ae==="style"){var V=p[ae];for(S in V)V.hasOwnProperty(S)&&(c||(c={}),c[S]="")}else ae!=="dangerouslySetInnerHTML"&&ae!=="children"&&ae!=="suppressContentEditableWarning"&&ae!=="suppressHydrationWarning"&&ae!=="autoFocus"&&(a.hasOwnProperty(ae)?v||(v=[]):(v=v||[]).push(ae,null));for(ae in h){var H=h[ae];if(V=p!=null?p[ae]:void 0,h.hasOwnProperty(ae)&&H!==V&&(H!=null||V!=null))if(ae==="style")if(V){for(S in V)!V.hasOwnProperty(S)||H&&H.hasOwnProperty(S)||(c||(c={}),c[S]="");for(S in H)H.hasOwnProperty(S)&&V[S]!==H[S]&&(c||(c={}),c[S]=H[S])}else c||(v||(v=[]),v.push(ae,c)),c=H;else ae==="dangerouslySetInnerHTML"?(H=H?H.__html:void 0,V=V?V.__html:void 0,H!=null&&V!==H&&(v=v||[]).push(ae,H)):ae==="children"?typeof H!="string"&&typeof H!="number"||(v=v||[]).push(ae,""+H):ae!=="suppressContentEditableWarning"&&ae!=="suppressHydrationWarning"&&(a.hasOwnProperty(ae)?(H!=null&&ae==="onScroll"&&Gt("scroll",r),v||V===H||(v=[])):(v=v||[]).push(ae,H))}c&&(v=v||[]).push("style",c);var ae=v;(i.updateQueue=ae)&&(i.flags|=4)}},zg=function(r,i,c,h){c!==h&&(i.flags|=4)};function El(r,i){if(!Kt)switch(r.tailMode){case"hidden":i=r.tail;for(var c=null;i!==null;)i.alternate!==null&&(c=i),i=i.sibling;c===null?r.tail=null:c.sibling=null;break;case"collapsed":c=r.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?i||r.tail===null?r.tail=null:r.tail.sibling=null:h.sibling=null}}function rr(r){var i=r.alternate!==null&&r.alternate.child===r.child,c=0,h=0;if(i)for(var p=r.child;p!==null;)c|=p.lanes|p.childLanes,h|=p.subtreeFlags&14680064,h|=p.flags&14680064,p.return=r,p=p.sibling;else for(p=r.child;p!==null;)c|=p.lanes|p.childLanes,h|=p.subtreeFlags,h|=p.flags,p.return=r,p=p.sibling;return r.subtreeFlags|=h,r.childLanes=c,i}function eE(r,i,c){var h=i.pendingProps;switch(eh(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return rr(i),null;case 1:return Ir(i.type)&&kc(),rr(i),null;case 3:return h=i.stateNode,xo(),qt(Cr),qt(tr),fh(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(r===null||r.child===null)&&(Oc(i)?i.flags|=4:r===null||r.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Es!==null&&(Bh(Es),Es=null))),jh(r,i),rr(i),null;case 5:dh(i);var p=Ca(yl.current);if(c=i.type,r!==null&&i.stateNode!=null)Ug(r,i,c,h,p),r.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!h){if(i.stateNode===null)throw Error(t(166));return rr(i),null}if(r=Ca(zs.current),Oc(i)){h=i.stateNode,c=i.type;var v=i.memoizedProps;switch(h[Us]=i,h[hl]=v,r=(i.mode&1)!==0,c){case"dialog":Gt("cancel",h),Gt("close",h);break;case"iframe":case"object":case"embed":Gt("load",h);break;case"video":case"audio":for(p=0;p<cl.length;p++)Gt(cl[p],h);break;case"source":Gt("error",h);break;case"img":case"image":case"link":Gt("error",h),Gt("load",h);break;case"details":Gt("toggle",h);break;case"input":Je(h,v),Gt("invalid",h);break;case"select":h._wrapperState={wasMultiple:!!v.multiple},Gt("invalid",h);break;case"textarea":qn(h,v),Gt("invalid",h)}un(c,v),p=null;for(var S in v)if(v.hasOwnProperty(S)){var V=v[S];S==="children"?typeof V=="string"?h.textContent!==V&&(v.suppressHydrationWarning!==!0&&Rc(h.textContent,V,r),p=["children",V]):typeof V=="number"&&h.textContent!==""+V&&(v.suppressHydrationWarning!==!0&&Rc(h.textContent,V,r),p=["children",""+V]):a.hasOwnProperty(S)&&V!=null&&S==="onScroll"&&Gt("scroll",h)}switch(c){case"input":ce(h),Nt(h,v,!0);break;case"textarea":ce(h),cr(h);break;case"select":case"option":break;default:typeof v.onClick=="function"&&(h.onclick=Ac)}h=p,i.updateQueue=h,h!==null&&(i.flags|=4)}else{S=p.nodeType===9?p:p.ownerDocument,r==="http://www.w3.org/1999/xhtml"&&(r=jt(c)),r==="http://www.w3.org/1999/xhtml"?c==="script"?(r=S.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild)):typeof h.is=="string"?r=S.createElement(c,{is:h.is}):(r=S.createElement(c),c==="select"&&(S=r,h.multiple?S.multiple=!0:h.size&&(S.size=h.size))):r=S.createElementNS(r,c),r[Us]=i,r[hl]=h,Fg(r,i,!1,!1),i.stateNode=r;e:{switch(S=vs(c,h),c){case"dialog":Gt("cancel",r),Gt("close",r),p=h;break;case"iframe":case"object":case"embed":Gt("load",r),p=h;break;case"video":case"audio":for(p=0;p<cl.length;p++)Gt(cl[p],r);p=h;break;case"source":Gt("error",r),p=h;break;case"img":case"image":case"link":Gt("error",r),Gt("load",r),p=h;break;case"details":Gt("toggle",r),p=h;break;case"input":Je(r,h),p=He(r,h),Gt("invalid",r);break;case"option":p=h;break;case"select":r._wrapperState={wasMultiple:!!h.multiple},p=xe({},h,{value:void 0}),Gt("invalid",r);break;case"textarea":qn(r,h),p=en(r,h),Gt("invalid",r);break;default:p=h}un(c,p),V=p;for(v in V)if(V.hasOwnProperty(v)){var H=V[v];v==="style"?Kn(r,H):v==="dangerouslySetInnerHTML"?(H=H?H.__html:void 0,H!=null&&Dn(r,H)):v==="children"?typeof H=="string"?(c!=="textarea"||H!=="")&&Hn(r,H):typeof H=="number"&&Hn(r,""+H):v!=="suppressContentEditableWarning"&&v!=="suppressHydrationWarning"&&v!=="autoFocus"&&(a.hasOwnProperty(v)?H!=null&&v==="onScroll"&&Gt("scroll",r):H!=null&&_e(r,v,H,S))}switch(c){case"input":ce(r),Nt(r,h,!1);break;case"textarea":ce(r),cr(r);break;case"option":h.value!=null&&r.setAttribute("value",""+Qe(h.value));break;case"select":r.multiple=!!h.multiple,v=h.value,v!=null?sn(r,!!h.multiple,v,!1):h.defaultValue!=null&&sn(r,!!h.multiple,h.defaultValue,!0);break;default:typeof p.onClick=="function"&&(r.onclick=Ac)}switch(c){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}}h&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return rr(i),null;case 6:if(r&&i.stateNode!=null)zg(r,i,r.memoizedProps,h);else{if(typeof h!="string"&&i.stateNode===null)throw Error(t(166));if(c=Ca(yl.current),Ca(zs.current),Oc(i)){if(h=i.stateNode,c=i.memoizedProps,h[Us]=i,(v=h.nodeValue!==c)&&(r=Or,r!==null))switch(r.tag){case 3:Rc(h.nodeValue,c,(r.mode&1)!==0);break;case 5:r.memoizedProps.suppressHydrationWarning!==!0&&Rc(h.nodeValue,c,(r.mode&1)!==0)}v&&(i.flags|=4)}else h=(c.nodeType===9?c:c.ownerDocument).createTextNode(h),h[Us]=i,i.stateNode=h}return rr(i),null;case 13:if(qt(Yt),h=i.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(Kt&&Fr!==null&&(i.mode&1)!==0&&(i.flags&128)===0)Wm(),go(),i.flags|=98560,v=!1;else if(v=Oc(i),h!==null&&h.dehydrated!==null){if(r===null){if(!v)throw Error(t(318));if(v=i.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(t(317));v[Us]=i}else go(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;rr(i),v=!1}else Es!==null&&(Bh(Es),Es=null),v=!0;if(!v)return i.flags&65536?i:null}return(i.flags&128)!==0?(i.lanes=c,i):(h=h!==null,h!==(r!==null&&r.memoizedState!==null)&&h&&(i.child.flags|=8192,(i.mode&1)!==0&&(r===null||(Yt.current&1)!==0?Sn===0&&(Sn=3):qh())),i.updateQueue!==null&&(i.flags|=4),rr(i),null);case 4:return xo(),jh(r,i),r===null&&ul(i.stateNode.containerInfo),rr(i),null;case 10:return ah(i.type._context),rr(i),null;case 17:return Ir(i.type)&&kc(),rr(i),null;case 19:if(qt(Yt),v=i.memoizedState,v===null)return rr(i),null;if(h=(i.flags&128)!==0,S=v.rendering,S===null)if(h)El(v,!1);else{if(Sn!==0||r!==null&&(r.flags&128)!==0)for(r=i.child;r!==null;){if(S=Wc(r),S!==null){for(i.flags|=128,El(v,!1),h=S.updateQueue,h!==null&&(i.updateQueue=h,i.flags|=4),i.subtreeFlags=0,h=c,c=i.child;c!==null;)v=c,r=h,v.flags&=14680066,S=v.alternate,S===null?(v.childLanes=0,v.lanes=r,v.child=null,v.subtreeFlags=0,v.memoizedProps=null,v.memoizedState=null,v.updateQueue=null,v.dependencies=null,v.stateNode=null):(v.childLanes=S.childLanes,v.lanes=S.lanes,v.child=S.child,v.subtreeFlags=0,v.deletions=null,v.memoizedProps=S.memoizedProps,v.memoizedState=S.memoizedState,v.updateQueue=S.updateQueue,v.type=S.type,r=S.dependencies,v.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),c=c.sibling;return zt(Yt,Yt.current&1|2),i.child}r=r.sibling}v.tail!==null&&xt()>So&&(i.flags|=128,h=!0,El(v,!1),i.lanes=4194304)}else{if(!h)if(r=Wc(S),r!==null){if(i.flags|=128,h=!0,c=r.updateQueue,c!==null&&(i.updateQueue=c,i.flags|=4),El(v,!0),v.tail===null&&v.tailMode==="hidden"&&!S.alternate&&!Kt)return rr(i),null}else 2*xt()-v.renderingStartTime>So&&c!==1073741824&&(i.flags|=128,h=!0,El(v,!1),i.lanes=4194304);v.isBackwards?(S.sibling=i.child,i.child=S):(c=v.last,c!==null?c.sibling=S:i.child=S,v.last=S)}return v.tail!==null?(i=v.tail,v.rendering=i,v.tail=i.sibling,v.renderingStartTime=xt(),i.sibling=null,c=Yt.current,zt(Yt,h?c&1|2:c&1),i):(rr(i),null);case 22:case 23:return Gh(),h=i.memoizedState!==null,r!==null&&r.memoizedState!==null!==h&&(i.flags|=8192),h&&(i.mode&1)!==0?(Ur&1073741824)!==0&&(rr(i),i.subtreeFlags&6&&(i.flags|=8192)):rr(i),null;case 24:return null;case 25:return null}throw Error(t(156,i.tag))}function tE(r,i){switch(eh(i),i.tag){case 1:return Ir(i.type)&&kc(),r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 3:return xo(),qt(Cr),qt(tr),fh(),r=i.flags,(r&65536)!==0&&(r&128)===0?(i.flags=r&-65537|128,i):null;case 5:return dh(i),null;case 13:if(qt(Yt),r=i.memoizedState,r!==null&&r.dehydrated!==null){if(i.alternate===null)throw Error(t(340));go()}return r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 19:return qt(Yt),null;case 4:return xo(),null;case 10:return ah(i.type._context),null;case 22:case 23:return Gh(),null;case 24:return null;default:return null}}var Zc=!1,sr=!1,nE=typeof WeakSet=="function"?WeakSet:Set,We=null;function Eo(r,i){var c=r.ref;if(c!==null)if(typeof c=="function")try{c(null)}catch(h){tn(r,i,h)}else c.current=null}function kh(r,i,c){try{c()}catch(h){tn(r,i,h)}}var $g=!1;function rE(r,i){if(Gd=Dt,r=xm(),Md(r)){if("selectionStart"in r)var c={start:r.selectionStart,end:r.selectionEnd};else e:{c=(c=r.ownerDocument)&&c.defaultView||window;var h=c.getSelection&&c.getSelection();if(h&&h.rangeCount!==0){c=h.anchorNode;var p=h.anchorOffset,v=h.focusNode;h=h.focusOffset;try{c.nodeType,v.nodeType}catch{c=null;break e}var S=0,V=-1,H=-1,ae=0,Se=0,Ie=r,Ee=null;t:for(;;){for(var Ue;Ie!==c||p!==0&&Ie.nodeType!==3||(V=S+p),Ie!==v||h!==0&&Ie.nodeType!==3||(H=S+h),Ie.nodeType===3&&(S+=Ie.nodeValue.length),(Ue=Ie.firstChild)!==null;)Ee=Ie,Ie=Ue;for(;;){if(Ie===r)break t;if(Ee===c&&++ae===p&&(V=S),Ee===v&&++Se===h&&(H=S),(Ue=Ie.nextSibling)!==null)break;Ie=Ee,Ee=Ie.parentNode}Ie=Ue}c=V===-1||H===-1?null:{start:V,end:H}}else c=null}c=c||{start:0,end:0}}else c=null;for(qd={focusedElem:r,selectionRange:c},Dt=!1,We=i;We!==null;)if(i=We,r=i.child,(i.subtreeFlags&1028)!==0&&r!==null)r.return=i,We=r;else for(;We!==null;){i=We;try{var Ge=i.alternate;if((i.flags&1024)!==0)switch(i.tag){case 0:case 11:case 15:break;case 1:if(Ge!==null){var qe=Ge.memoizedProps,an=Ge.memoizedState,ee=i.stateNode,Q=ee.getSnapshotBeforeUpdate(i.elementType===i.type?qe:Ts(i.type,qe),an);ee.__reactInternalSnapshotBeforeUpdate=Q}break;case 3:var ne=i.stateNode.containerInfo;ne.nodeType===1?ne.textContent="":ne.nodeType===9&&ne.documentElement&&ne.removeChild(ne.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Ae){tn(i,i.return,Ae)}if(r=i.sibling,r!==null){r.return=i.return,We=r;break}We=i.return}return Ge=$g,$g=!1,Ge}function Tl(r,i,c){var h=i.updateQueue;if(h=h!==null?h.lastEffect:null,h!==null){var p=h=h.next;do{if((p.tag&r)===r){var v=p.destroy;p.destroy=void 0,v!==void 0&&kh(i,c,v)}p=p.next}while(p!==h)}}function eu(r,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var c=i=i.next;do{if((c.tag&r)===r){var h=c.create;c.destroy=h()}c=c.next}while(c!==i)}}function Dh(r){var i=r.ref;if(i!==null){var c=r.stateNode;switch(r.tag){case 5:r=c;break;default:r=c}typeof i=="function"?i(r):i.current=r}}function Bg(r){var i=r.alternate;i!==null&&(r.alternate=null,Bg(i)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(i=r.stateNode,i!==null&&(delete i[Us],delete i[hl],delete i[Yd],delete i[Fw],delete i[Uw])),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}function Wg(r){return r.tag===5||r.tag===3||r.tag===4}function Gg(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||Wg(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Vh(r,i,c){var h=r.tag;if(h===5||h===6)r=r.stateNode,i?c.nodeType===8?c.parentNode.insertBefore(r,i):c.insertBefore(r,i):(c.nodeType===8?(i=c.parentNode,i.insertBefore(r,c)):(i=c,i.appendChild(r)),c=c._reactRootContainer,c!=null||i.onclick!==null||(i.onclick=Ac));else if(h!==4&&(r=r.child,r!==null))for(Vh(r,i,c),r=r.sibling;r!==null;)Vh(r,i,c),r=r.sibling}function Lh(r,i,c){var h=r.tag;if(h===5||h===6)r=r.stateNode,i?c.insertBefore(r,i):c.appendChild(r);else if(h!==4&&(r=r.child,r!==null))for(Lh(r,i,c),r=r.sibling;r!==null;)Lh(r,i,c),r=r.sibling}var zn=null,Ss=!1;function Li(r,i,c){for(c=c.child;c!==null;)qg(r,i,c),c=c.sibling}function qg(r,i,c){if(G&&typeof G.onCommitFiberUnmount=="function")try{G.onCommitFiberUnmount(F,c)}catch{}switch(c.tag){case 5:sr||Eo(c,i);case 6:var h=zn,p=Ss;zn=null,Li(r,i,c),zn=h,Ss=p,zn!==null&&(Ss?(r=zn,c=c.stateNode,r.nodeType===8?r.parentNode.removeChild(c):r.removeChild(c)):zn.removeChild(c.stateNode));break;case 18:zn!==null&&(Ss?(r=zn,c=c.stateNode,r.nodeType===8?Qd(r.parentNode,c):r.nodeType===1&&Qd(r,c),gt(r)):Qd(zn,c.stateNode));break;case 4:h=zn,p=Ss,zn=c.stateNode.containerInfo,Ss=!0,Li(r,i,c),zn=h,Ss=p;break;case 0:case 11:case 14:case 15:if(!sr&&(h=c.updateQueue,h!==null&&(h=h.lastEffect,h!==null))){p=h=h.next;do{var v=p,S=v.destroy;v=v.tag,S!==void 0&&((v&2)!==0||(v&4)!==0)&&kh(c,i,S),p=p.next}while(p!==h)}Li(r,i,c);break;case 1:if(!sr&&(Eo(c,i),h=c.stateNode,typeof h.componentWillUnmount=="function"))try{h.props=c.memoizedProps,h.state=c.memoizedState,h.componentWillUnmount()}catch(V){tn(c,i,V)}Li(r,i,c);break;case 21:Li(r,i,c);break;case 22:c.mode&1?(sr=(h=sr)||c.memoizedState!==null,Li(r,i,c),sr=h):Li(r,i,c);break;default:Li(r,i,c)}}function Hg(r){var i=r.updateQueue;if(i!==null){r.updateQueue=null;var c=r.stateNode;c===null&&(c=r.stateNode=new nE),i.forEach(function(h){var p=hE.bind(null,r,h);c.has(h)||(c.add(h),h.then(p,p))})}}function bs(r,i){var c=i.deletions;if(c!==null)for(var h=0;h<c.length;h++){var p=c[h];try{var v=r,S=i,V=S;e:for(;V!==null;){switch(V.tag){case 5:zn=V.stateNode,Ss=!1;break e;case 3:zn=V.stateNode.containerInfo,Ss=!0;break e;case 4:zn=V.stateNode.containerInfo,Ss=!0;break e}V=V.return}if(zn===null)throw Error(t(160));qg(v,S,p),zn=null,Ss=!1;var H=p.alternate;H!==null&&(H.return=null),p.return=null}catch(ae){tn(p,i,ae)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)Kg(i,r),i=i.sibling}function Kg(r,i){var c=r.alternate,h=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:if(bs(i,r),Bs(r),h&4){try{Tl(3,r,r.return),eu(3,r)}catch(qe){tn(r,r.return,qe)}try{Tl(5,r,r.return)}catch(qe){tn(r,r.return,qe)}}break;case 1:bs(i,r),Bs(r),h&512&&c!==null&&Eo(c,c.return);break;case 5:if(bs(i,r),Bs(r),h&512&&c!==null&&Eo(c,c.return),r.flags&32){var p=r.stateNode;try{Hn(p,"")}catch(qe){tn(r,r.return,qe)}}if(h&4&&(p=r.stateNode,p!=null)){var v=r.memoizedProps,S=c!==null?c.memoizedProps:v,V=r.type,H=r.updateQueue;if(r.updateQueue=null,H!==null)try{V==="input"&&v.type==="radio"&&v.name!=null&&_t(p,v),vs(V,S);var ae=vs(V,v);for(S=0;S<H.length;S+=2){var Se=H[S],Ie=H[S+1];Se==="style"?Kn(p,Ie):Se==="dangerouslySetInnerHTML"?Dn(p,Ie):Se==="children"?Hn(p,Ie):_e(p,Se,Ie,ae)}switch(V){case"input":Ct(p,v);break;case"textarea":yn(p,v);break;case"select":var Ee=p._wrapperState.wasMultiple;p._wrapperState.wasMultiple=!!v.multiple;var Ue=v.value;Ue!=null?sn(p,!!v.multiple,Ue,!1):Ee!==!!v.multiple&&(v.defaultValue!=null?sn(p,!!v.multiple,v.defaultValue,!0):sn(p,!!v.multiple,v.multiple?[]:"",!1))}p[hl]=v}catch(qe){tn(r,r.return,qe)}}break;case 6:if(bs(i,r),Bs(r),h&4){if(r.stateNode===null)throw Error(t(162));p=r.stateNode,v=r.memoizedProps;try{p.nodeValue=v}catch(qe){tn(r,r.return,qe)}}break;case 3:if(bs(i,r),Bs(r),h&4&&c!==null&&c.memoizedState.isDehydrated)try{gt(i.containerInfo)}catch(qe){tn(r,r.return,qe)}break;case 4:bs(i,r),Bs(r);break;case 13:bs(i,r),Bs(r),p=r.child,p.flags&8192&&(v=p.memoizedState!==null,p.stateNode.isHidden=v,!v||p.alternate!==null&&p.alternate.memoizedState!==null||(Fh=xt())),h&4&&Hg(r);break;case 22:if(Se=c!==null&&c.memoizedState!==null,r.mode&1?(sr=(ae=sr)||Se,bs(i,r),sr=ae):bs(i,r),Bs(r),h&8192){if(ae=r.memoizedState!==null,(r.stateNode.isHidden=ae)&&!Se&&(r.mode&1)!==0)for(We=r,Se=r.child;Se!==null;){for(Ie=We=Se;We!==null;){switch(Ee=We,Ue=Ee.child,Ee.tag){case 0:case 11:case 14:case 15:Tl(4,Ee,Ee.return);break;case 1:Eo(Ee,Ee.return);var Ge=Ee.stateNode;if(typeof Ge.componentWillUnmount=="function"){h=Ee,c=Ee.return;try{i=h,Ge.props=i.memoizedProps,Ge.state=i.memoizedState,Ge.componentWillUnmount()}catch(qe){tn(h,c,qe)}}break;case 5:Eo(Ee,Ee.return);break;case 22:if(Ee.memoizedState!==null){Jg(Ie);continue}}Ue!==null?(Ue.return=Ee,We=Ue):Jg(Ie)}Se=Se.sibling}e:for(Se=null,Ie=r;;){if(Ie.tag===5){if(Se===null){Se=Ie;try{p=Ie.stateNode,ae?(v=p.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none"):(V=Ie.stateNode,H=Ie.memoizedProps.style,S=H!=null&&H.hasOwnProperty("display")?H.display:null,V.style.display=ys("display",S))}catch(qe){tn(r,r.return,qe)}}}else if(Ie.tag===6){if(Se===null)try{Ie.stateNode.nodeValue=ae?"":Ie.memoizedProps}catch(qe){tn(r,r.return,qe)}}else if((Ie.tag!==22&&Ie.tag!==23||Ie.memoizedState===null||Ie===r)&&Ie.child!==null){Ie.child.return=Ie,Ie=Ie.child;continue}if(Ie===r)break e;for(;Ie.sibling===null;){if(Ie.return===null||Ie.return===r)break e;Se===Ie&&(Se=null),Ie=Ie.return}Se===Ie&&(Se=null),Ie.sibling.return=Ie.return,Ie=Ie.sibling}}break;case 19:bs(i,r),Bs(r),h&4&&Hg(r);break;case 21:break;default:bs(i,r),Bs(r)}}function Bs(r){var i=r.flags;if(i&2){try{e:{for(var c=r.return;c!==null;){if(Wg(c)){var h=c;break e}c=c.return}throw Error(t(160))}switch(h.tag){case 5:var p=h.stateNode;h.flags&32&&(Hn(p,""),h.flags&=-33);var v=Gg(r);Lh(r,v,p);break;case 3:case 4:var S=h.stateNode.containerInfo,V=Gg(r);Vh(r,V,S);break;default:throw Error(t(161))}}catch(H){tn(r,r.return,H)}r.flags&=-3}i&4096&&(r.flags&=-4097)}function sE(r,i,c){We=r,Qg(r)}function Qg(r,i,c){for(var h=(r.mode&1)!==0;We!==null;){var p=We,v=p.child;if(p.tag===22&&h){var S=p.memoizedState!==null||Zc;if(!S){var V=p.alternate,H=V!==null&&V.memoizedState!==null||sr;V=Zc;var ae=sr;if(Zc=S,(sr=H)&&!ae)for(We=p;We!==null;)S=We,H=S.child,S.tag===22&&S.memoizedState!==null?Xg(p):H!==null?(H.return=S,We=H):Xg(p);for(;v!==null;)We=v,Qg(v),v=v.sibling;We=p,Zc=V,sr=ae}Yg(r)}else(p.subtreeFlags&8772)!==0&&v!==null?(v.return=p,We=v):Yg(r)}}function Yg(r){for(;We!==null;){var i=We;if((i.flags&8772)!==0){var c=i.alternate;try{if((i.flags&8772)!==0)switch(i.tag){case 0:case 11:case 15:sr||eu(5,i);break;case 1:var h=i.stateNode;if(i.flags&4&&!sr)if(c===null)h.componentDidMount();else{var p=i.elementType===i.type?c.memoizedProps:Ts(i.type,c.memoizedProps);h.componentDidUpdate(p,c.memoizedState,h.__reactInternalSnapshotBeforeUpdate)}var v=i.updateQueue;v!==null&&Jm(i,v,h);break;case 3:var S=i.updateQueue;if(S!==null){if(c=null,i.child!==null)switch(i.child.tag){case 5:c=i.child.stateNode;break;case 1:c=i.child.stateNode}Jm(i,S,c)}break;case 5:var V=i.stateNode;if(c===null&&i.flags&4){c=V;var H=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":H.autoFocus&&c.focus();break;case"img":H.src&&(c.src=H.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var ae=i.alternate;if(ae!==null){var Se=ae.memoizedState;if(Se!==null){var Ie=Se.dehydrated;Ie!==null&&gt(Ie)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}sr||i.flags&512&&Dh(i)}catch(Ee){tn(i,i.return,Ee)}}if(i===r){We=null;break}if(c=i.sibling,c!==null){c.return=i.return,We=c;break}We=i.return}}function Jg(r){for(;We!==null;){var i=We;if(i===r){We=null;break}var c=i.sibling;if(c!==null){c.return=i.return,We=c;break}We=i.return}}function Xg(r){for(;We!==null;){var i=We;try{switch(i.tag){case 0:case 11:case 15:var c=i.return;try{eu(4,i)}catch(H){tn(i,c,H)}break;case 1:var h=i.stateNode;if(typeof h.componentDidMount=="function"){var p=i.return;try{h.componentDidMount()}catch(H){tn(i,p,H)}}var v=i.return;try{Dh(i)}catch(H){tn(i,v,H)}break;case 5:var S=i.return;try{Dh(i)}catch(H){tn(i,S,H)}}}catch(H){tn(i,i.return,H)}if(i===r){We=null;break}var V=i.sibling;if(V!==null){V.return=i.return,We=V;break}We=i.return}}var iE=Math.ceil,tu=ve.ReactCurrentDispatcher,Mh=ve.ReactCurrentOwner,us=ve.ReactCurrentBatchConfig,bt=0,An=null,fn=null,$n=0,Ur=0,To=Ai(0),Sn=0,Sl=null,Na=0,nu=0,Oh=0,bl=null,Pr=null,Fh=0,So=1/0,di=null,ru=!1,Uh=null,Mi=null,su=!1,Oi=null,iu=0,Cl=0,zh=null,au=-1,ou=0;function vr(){return(bt&6)!==0?xt():au!==-1?au:au=xt()}function Fi(r){return(r.mode&1)===0?1:(bt&2)!==0&&$n!==0?$n&-$n:$w.transition!==null?(ou===0&&(ou=pr()),ou):(r=ut,r!==0||(r=window.event,r=r===void 0?16:Lr(r.type)),r)}function Cs(r,i,c,h){if(50<Cl)throw Cl=0,zh=null,Error(t(185));Ls(r,c,h),((bt&2)===0||r!==An)&&(r===An&&((bt&2)===0&&(nu|=c),Sn===4&&Ui(r,$n)),Rr(r,h),c===1&&bt===0&&(i.mode&1)===0&&(So=xt()+500,Vc&&ki()))}function Rr(r,i){var c=r.callbackNode;fr(r,i);var h=ht(r,r===An?$n:0);if(h===0)c!==null&&Vs(c),r.callbackNode=null,r.callbackPriority=0;else if(i=h&-h,r.callbackPriority!==i){if(c!=null&&Vs(c),i===1)r.tag===0?zw(ey.bind(null,r)):Fm(ey.bind(null,r)),Mw(function(){(bt&6)===0&&ki()}),c=null;else{switch(On(h)){case 1:c=_n;break;case 4:c=Wt;break;case 16:c=w;break;case 536870912:c=W;break;default:c=w}c=ly(c,Zg.bind(null,r))}r.callbackPriority=i,r.callbackNode=c}}function Zg(r,i){if(au=-1,ou=0,(bt&6)!==0)throw Error(t(327));var c=r.callbackNode;if(bo()&&r.callbackNode!==c)return null;var h=ht(r,r===An?$n:0);if(h===0)return null;if((h&30)!==0||(h&r.expiredLanes)!==0||i)i=lu(r,h);else{i=h;var p=bt;bt|=2;var v=ny();(An!==r||$n!==i)&&(di=null,So=xt()+500,Ra(r,i));do try{lE();break}catch(V){ty(r,V)}while(!0);ih(),tu.current=v,bt=p,fn!==null?i=0:(An=null,$n=0,i=Sn)}if(i!==0){if(i===2&&(p=Mn(r),p!==0&&(h=p,i=$h(r,p))),i===1)throw c=Sl,Ra(r,0),Ui(r,h),Rr(r,xt()),c;if(i===6)Ui(r,h);else{if(p=r.current.alternate,(h&30)===0&&!aE(p)&&(i=lu(r,h),i===2&&(v=Mn(r),v!==0&&(h=v,i=$h(r,v))),i===1))throw c=Sl,Ra(r,0),Ui(r,h),Rr(r,xt()),c;switch(r.finishedWork=p,r.finishedLanes=h,i){case 0:case 1:throw Error(t(345));case 2:Aa(r,Pr,di);break;case 3:if(Ui(r,h),(h&130023424)===h&&(i=Fh+500-xt(),10<i)){if(ht(r,0)!==0)break;if(p=r.suspendedLanes,(p&h)!==h){vr(),r.pingedLanes|=r.suspendedLanes&p;break}r.timeoutHandle=Kd(Aa.bind(null,r,Pr,di),i);break}Aa(r,Pr,di);break;case 4:if(Ui(r,h),(h&4194240)===h)break;for(i=r.eventTimes,p=-1;0<h;){var S=31-te(h);v=1<<S,S=i[S],S>p&&(p=S),h&=~v}if(h=p,h=xt()-h,h=(120>h?120:480>h?480:1080>h?1080:1920>h?1920:3e3>h?3e3:4320>h?4320:1960*iE(h/1960))-h,10<h){r.timeoutHandle=Kd(Aa.bind(null,r,Pr,di),h);break}Aa(r,Pr,di);break;case 5:Aa(r,Pr,di);break;default:throw Error(t(329))}}}return Rr(r,xt()),r.callbackNode===c?Zg.bind(null,r):null}function $h(r,i){var c=bl;return r.current.memoizedState.isDehydrated&&(Ra(r,i).flags|=256),r=lu(r,i),r!==2&&(i=Pr,Pr=c,i!==null&&Bh(i)),r}function Bh(r){Pr===null?Pr=r:Pr.push.apply(Pr,r)}function aE(r){for(var i=r;;){if(i.flags&16384){var c=i.updateQueue;if(c!==null&&(c=c.stores,c!==null))for(var h=0;h<c.length;h++){var p=c[h],v=p.getSnapshot;p=p.value;try{if(!ws(v(),p))return!1}catch{return!1}}}if(c=i.child,i.subtreeFlags&16384&&c!==null)c.return=i,i=c;else{if(i===r)break;for(;i.sibling===null;){if(i.return===null||i.return===r)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Ui(r,i){for(i&=~Oh,i&=~nu,r.suspendedLanes|=i,r.pingedLanes&=~i,r=r.expirationTimes;0<i;){var c=31-te(i),h=1<<c;r[c]=-1,i&=~h}}function ey(r){if((bt&6)!==0)throw Error(t(327));bo();var i=ht(r,0);if((i&1)===0)return Rr(r,xt()),null;var c=lu(r,i);if(r.tag!==0&&c===2){var h=Mn(r);h!==0&&(i=h,c=$h(r,h))}if(c===1)throw c=Sl,Ra(r,0),Ui(r,i),Rr(r,xt()),c;if(c===6)throw Error(t(345));return r.finishedWork=r.current.alternate,r.finishedLanes=i,Aa(r,Pr,di),Rr(r,xt()),null}function Wh(r,i){var c=bt;bt|=1;try{return r(i)}finally{bt=c,bt===0&&(So=xt()+500,Vc&&ki())}}function Pa(r){Oi!==null&&Oi.tag===0&&(bt&6)===0&&bo();var i=bt;bt|=1;var c=us.transition,h=ut;try{if(us.transition=null,ut=1,r)return r()}finally{ut=h,us.transition=c,bt=i,(bt&6)===0&&ki()}}function Gh(){Ur=To.current,qt(To)}function Ra(r,i){r.finishedWork=null,r.finishedLanes=0;var c=r.timeoutHandle;if(c!==-1&&(r.timeoutHandle=-1,Lw(c)),fn!==null)for(c=fn.return;c!==null;){var h=c;switch(eh(h),h.tag){case 1:h=h.type.childContextTypes,h!=null&&kc();break;case 3:xo(),qt(Cr),qt(tr),fh();break;case 5:dh(h);break;case 4:xo();break;case 13:qt(Yt);break;case 19:qt(Yt);break;case 10:ah(h.type._context);break;case 22:case 23:Gh()}c=c.return}if(An=r,fn=r=zi(r.current,null),$n=Ur=i,Sn=0,Sl=null,Oh=nu=Na=0,Pr=bl=null,ba!==null){for(i=0;i<ba.length;i++)if(c=ba[i],h=c.interleaved,h!==null){c.interleaved=null;var p=h.next,v=c.pending;if(v!==null){var S=v.next;v.next=p,h.next=S}c.pending=h}ba=null}return r}function ty(r,i){do{var c=fn;try{if(ih(),Gc.current=Qc,qc){for(var h=Jt.memoizedState;h!==null;){var p=h.queue;p!==null&&(p.pending=null),h=h.next}qc=!1}if(Ia=0,Rn=Tn=Jt=null,vl=!1,_l=0,Mh.current=null,c===null||c.return===null){Sn=1,Sl=i,fn=null;break}e:{var v=r,S=c.return,V=c,H=i;if(i=$n,V.flags|=32768,H!==null&&typeof H=="object"&&typeof H.then=="function"){var ae=H,Se=V,Ie=Se.tag;if((Se.mode&1)===0&&(Ie===0||Ie===11||Ie===15)){var Ee=Se.alternate;Ee?(Se.updateQueue=Ee.updateQueue,Se.memoizedState=Ee.memoizedState,Se.lanes=Ee.lanes):(Se.updateQueue=null,Se.memoizedState=null)}var Ue=Cg(S);if(Ue!==null){Ue.flags&=-257,Ig(Ue,S,V,v,i),Ue.mode&1&&bg(v,ae,i),i=Ue,H=ae;var Ge=i.updateQueue;if(Ge===null){var qe=new Set;qe.add(H),i.updateQueue=qe}else Ge.add(H);break e}else{if((i&1)===0){bg(v,ae,i),qh();break e}H=Error(t(426))}}else if(Kt&&V.mode&1){var an=Cg(S);if(an!==null){(an.flags&65536)===0&&(an.flags|=256),Ig(an,S,V,v,i),rh(wo(H,V));break e}}v=H=wo(H,V),Sn!==4&&(Sn=2),bl===null?bl=[v]:bl.push(v),v=S;do{switch(v.tag){case 3:v.flags|=65536,i&=-i,v.lanes|=i;var ee=Tg(v,H,i);Ym(v,ee);break e;case 1:V=H;var Q=v.type,ne=v.stateNode;if((v.flags&128)===0&&(typeof Q.getDerivedStateFromError=="function"||ne!==null&&typeof ne.componentDidCatch=="function"&&(Mi===null||!Mi.has(ne)))){v.flags|=65536,i&=-i,v.lanes|=i;var Ae=Sg(v,V,i);Ym(v,Ae);break e}}v=v.return}while(v!==null)}sy(c)}catch(Ke){i=Ke,fn===c&&c!==null&&(fn=c=c.return);continue}break}while(!0)}function ny(){var r=tu.current;return tu.current=Qc,r===null?Qc:r}function qh(){(Sn===0||Sn===3||Sn===2)&&(Sn=4),An===null||(Na&268435455)===0&&(nu&268435455)===0||Ui(An,$n)}function lu(r,i){var c=bt;bt|=2;var h=ny();(An!==r||$n!==i)&&(di=null,Ra(r,i));do try{oE();break}catch(p){ty(r,p)}while(!0);if(ih(),bt=c,tu.current=h,fn!==null)throw Error(t(261));return An=null,$n=0,Sn}function oE(){for(;fn!==null;)ry(fn)}function lE(){for(;fn!==null&&!Yr();)ry(fn)}function ry(r){var i=oy(r.alternate,r,Ur);r.memoizedProps=r.pendingProps,i===null?sy(r):fn=i,Mh.current=null}function sy(r){var i=r;do{var c=i.alternate;if(r=i.return,(i.flags&32768)===0){if(c=eE(c,i,Ur),c!==null){fn=c;return}}else{if(c=tE(c,i),c!==null){c.flags&=32767,fn=c;return}if(r!==null)r.flags|=32768,r.subtreeFlags=0,r.deletions=null;else{Sn=6,fn=null;return}}if(i=i.sibling,i!==null){fn=i;return}fn=i=r}while(i!==null);Sn===0&&(Sn=5)}function Aa(r,i,c){var h=ut,p=us.transition;try{us.transition=null,ut=1,cE(r,i,c,h)}finally{us.transition=p,ut=h}return null}function cE(r,i,c,h){do bo();while(Oi!==null);if((bt&6)!==0)throw Error(t(327));c=r.finishedWork;var p=r.finishedLanes;if(c===null)return null;if(r.finishedWork=null,r.finishedLanes=0,c===r.current)throw Error(t(177));r.callbackNode=null,r.callbackPriority=0;var v=c.lanes|c.childLanes;if(Rt(r,v),r===An&&(fn=An=null,$n=0),(c.subtreeFlags&2064)===0&&(c.flags&2064)===0||su||(su=!0,ly(w,function(){return bo(),null})),v=(c.flags&15990)!==0,(c.subtreeFlags&15990)!==0||v){v=us.transition,us.transition=null;var S=ut;ut=1;var V=bt;bt|=4,Mh.current=null,rE(r,c),Kg(c,r),Pw(qd),Dt=!!Gd,qd=Gd=null,r.current=c,sE(c),Jr(),bt=V,ut=S,us.transition=v}else r.current=c;if(su&&(su=!1,Oi=r,iu=p),v=r.pendingLanes,v===0&&(Mi=null),ue(c.stateNode),Rr(r,xt()),i!==null)for(h=r.onRecoverableError,c=0;c<i.length;c++)p=i[c],h(p.value,{componentStack:p.stack,digest:p.digest});if(ru)throw ru=!1,r=Uh,Uh=null,r;return(iu&1)!==0&&r.tag!==0&&bo(),v=r.pendingLanes,(v&1)!==0?r===zh?Cl++:(Cl=0,zh=r):Cl=0,ki(),null}function bo(){if(Oi!==null){var r=On(iu),i=us.transition,c=ut;try{if(us.transition=null,ut=16>r?16:r,Oi===null)var h=!1;else{if(r=Oi,Oi=null,iu=0,(bt&6)!==0)throw Error(t(331));var p=bt;for(bt|=4,We=r.current;We!==null;){var v=We,S=v.child;if((We.flags&16)!==0){var V=v.deletions;if(V!==null){for(var H=0;H<V.length;H++){var ae=V[H];for(We=ae;We!==null;){var Se=We;switch(Se.tag){case 0:case 11:case 15:Tl(8,Se,v)}var Ie=Se.child;if(Ie!==null)Ie.return=Se,We=Ie;else for(;We!==null;){Se=We;var Ee=Se.sibling,Ue=Se.return;if(Bg(Se),Se===ae){We=null;break}if(Ee!==null){Ee.return=Ue,We=Ee;break}We=Ue}}}var Ge=v.alternate;if(Ge!==null){var qe=Ge.child;if(qe!==null){Ge.child=null;do{var an=qe.sibling;qe.sibling=null,qe=an}while(qe!==null)}}We=v}}if((v.subtreeFlags&2064)!==0&&S!==null)S.return=v,We=S;else e:for(;We!==null;){if(v=We,(v.flags&2048)!==0)switch(v.tag){case 0:case 11:case 15:Tl(9,v,v.return)}var ee=v.sibling;if(ee!==null){ee.return=v.return,We=ee;break e}We=v.return}}var Q=r.current;for(We=Q;We!==null;){S=We;var ne=S.child;if((S.subtreeFlags&2064)!==0&&ne!==null)ne.return=S,We=ne;else e:for(S=Q;We!==null;){if(V=We,(V.flags&2048)!==0)try{switch(V.tag){case 0:case 11:case 15:eu(9,V)}}catch(Ke){tn(V,V.return,Ke)}if(V===S){We=null;break e}var Ae=V.sibling;if(Ae!==null){Ae.return=V.return,We=Ae;break e}We=V.return}}if(bt=p,ki(),G&&typeof G.onPostCommitFiberRoot=="function")try{G.onPostCommitFiberRoot(F,r)}catch{}h=!0}return h}finally{ut=c,us.transition=i}}return!1}function iy(r,i,c){i=wo(c,i),i=Tg(r,i,1),r=Vi(r,i,1),i=vr(),r!==null&&(Ls(r,1,i),Rr(r,i))}function tn(r,i,c){if(r.tag===3)iy(r,r,c);else for(;i!==null;){if(i.tag===3){iy(i,r,c);break}else if(i.tag===1){var h=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(Mi===null||!Mi.has(h))){r=wo(c,r),r=Sg(i,r,1),i=Vi(i,r,1),r=vr(),i!==null&&(Ls(i,1,r),Rr(i,r));break}}i=i.return}}function uE(r,i,c){var h=r.pingCache;h!==null&&h.delete(i),i=vr(),r.pingedLanes|=r.suspendedLanes&c,An===r&&($n&c)===c&&(Sn===4||Sn===3&&($n&130023424)===$n&&500>xt()-Fh?Ra(r,0):Oh|=c),Rr(r,i)}function ay(r,i){i===0&&((r.mode&1)===0?i=1:(i=Xe,Xe<<=1,(Xe&130023424)===0&&(Xe=4194304)));var c=vr();r=li(r,i),r!==null&&(Ls(r,i,c),Rr(r,c))}function dE(r){var i=r.memoizedState,c=0;i!==null&&(c=i.retryLane),ay(r,c)}function hE(r,i){var c=0;switch(r.tag){case 13:var h=r.stateNode,p=r.memoizedState;p!==null&&(c=p.retryLane);break;case 19:h=r.stateNode;break;default:throw Error(t(314))}h!==null&&h.delete(i),ay(r,c)}var oy;oy=function(r,i,c){if(r!==null)if(r.memoizedProps!==i.pendingProps||Cr.current)Nr=!0;else{if((r.lanes&c)===0&&(i.flags&128)===0)return Nr=!1,Zw(r,i,c);Nr=(r.flags&131072)!==0}else Nr=!1,Kt&&(i.flags&1048576)!==0&&Um(i,Mc,i.index);switch(i.lanes=0,i.tag){case 2:var h=i.type;Xc(r,i),r=i.pendingProps;var p=fo(i,tr.current);_o(i,c),p=gh(null,i,h,r,p,c);var v=yh();return i.flags|=1,typeof p=="object"&&p!==null&&typeof p.render=="function"&&p.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,Ir(h)?(v=!0,Dc(i)):v=!1,i.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,ch(i),p.updater=Yc,i.stateNode=p,p._reactInternals=i,Th(i,h,r,c),i=Ih(null,i,h,!0,v,c)):(i.tag=0,Kt&&v&&Zd(i),yr(null,i,p,c),i=i.child),i;case 16:h=i.elementType;e:{switch(Xc(r,i),r=i.pendingProps,p=h._init,h=p(h._payload),i.type=h,p=i.tag=pE(h),r=Ts(h,r),p){case 0:i=Ch(null,i,h,r,c);break e;case 1:i=kg(null,i,h,r,c);break e;case 11:i=Ng(null,i,h,r,c);break e;case 14:i=Pg(null,i,h,Ts(h.type,r),c);break e}throw Error(t(306,h,""))}return i;case 0:return h=i.type,p=i.pendingProps,p=i.elementType===h?p:Ts(h,p),Ch(r,i,h,p,c);case 1:return h=i.type,p=i.pendingProps,p=i.elementType===h?p:Ts(h,p),kg(r,i,h,p,c);case 3:e:{if(Dg(i),r===null)throw Error(t(387));h=i.pendingProps,v=i.memoizedState,p=v.element,Qm(r,i),Bc(i,h,null,c);var S=i.memoizedState;if(h=S.element,v.isDehydrated)if(v={element:h,isDehydrated:!1,cache:S.cache,pendingSuspenseBoundaries:S.pendingSuspenseBoundaries,transitions:S.transitions},i.updateQueue.baseState=v,i.memoizedState=v,i.flags&256){p=wo(Error(t(423)),i),i=Vg(r,i,h,c,p);break e}else if(h!==p){p=wo(Error(t(424)),i),i=Vg(r,i,h,c,p);break e}else for(Fr=Ri(i.stateNode.containerInfo.firstChild),Or=i,Kt=!0,Es=null,c=Hm(i,null,h,c),i.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{if(go(),h===p){i=ui(r,i,c);break e}yr(r,i,h,c)}i=i.child}return i;case 5:return Xm(i),r===null&&nh(i),h=i.type,p=i.pendingProps,v=r!==null?r.memoizedProps:null,S=p.children,Hd(h,p)?S=null:v!==null&&Hd(h,v)&&(i.flags|=32),jg(r,i),yr(r,i,S,c),i.child;case 6:return r===null&&nh(i),null;case 13:return Lg(r,i,c);case 4:return uh(i,i.stateNode.containerInfo),h=i.pendingProps,r===null?i.child=yo(i,null,h,c):yr(r,i,h,c),i.child;case 11:return h=i.type,p=i.pendingProps,p=i.elementType===h?p:Ts(h,p),Ng(r,i,h,p,c);case 7:return yr(r,i,i.pendingProps,c),i.child;case 8:return yr(r,i,i.pendingProps.children,c),i.child;case 12:return yr(r,i,i.pendingProps.children,c),i.child;case 10:e:{if(h=i.type._context,p=i.pendingProps,v=i.memoizedProps,S=p.value,zt(Uc,h._currentValue),h._currentValue=S,v!==null)if(ws(v.value,S)){if(v.children===p.children&&!Cr.current){i=ui(r,i,c);break e}}else for(v=i.child,v!==null&&(v.return=i);v!==null;){var V=v.dependencies;if(V!==null){S=v.child;for(var H=V.firstContext;H!==null;){if(H.context===h){if(v.tag===1){H=ci(-1,c&-c),H.tag=2;var ae=v.updateQueue;if(ae!==null){ae=ae.shared;var Se=ae.pending;Se===null?H.next=H:(H.next=Se.next,Se.next=H),ae.pending=H}}v.lanes|=c,H=v.alternate,H!==null&&(H.lanes|=c),oh(v.return,c,i),V.lanes|=c;break}H=H.next}}else if(v.tag===10)S=v.type===i.type?null:v.child;else if(v.tag===18){if(S=v.return,S===null)throw Error(t(341));S.lanes|=c,V=S.alternate,V!==null&&(V.lanes|=c),oh(S,c,i),S=v.sibling}else S=v.child;if(S!==null)S.return=v;else for(S=v;S!==null;){if(S===i){S=null;break}if(v=S.sibling,v!==null){v.return=S.return,S=v;break}S=S.return}v=S}yr(r,i,p.children,c),i=i.child}return i;case 9:return p=i.type,h=i.pendingProps.children,_o(i,c),p=ls(p),h=h(p),i.flags|=1,yr(r,i,h,c),i.child;case 14:return h=i.type,p=Ts(h,i.pendingProps),p=Ts(h.type,p),Pg(r,i,h,p,c);case 15:return Rg(r,i,i.type,i.pendingProps,c);case 17:return h=i.type,p=i.pendingProps,p=i.elementType===h?p:Ts(h,p),Xc(r,i),i.tag=1,Ir(h)?(r=!0,Dc(i)):r=!1,_o(i,c),wg(i,h,p),Th(i,h,p,c),Ih(null,i,h,!0,r,c);case 19:return Og(r,i,c);case 22:return Ag(r,i,c)}throw Error(t(156,i.tag))};function ly(r,i){return Ln(r,i)}function fE(r,i,c,h){this.tag=r,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ds(r,i,c,h){return new fE(r,i,c,h)}function Hh(r){return r=r.prototype,!(!r||!r.isReactComponent)}function pE(r){if(typeof r=="function")return Hh(r)?1:0;if(r!=null){if(r=r.$$typeof,r===P)return 11;if(r===re)return 14}return 2}function zi(r,i){var c=r.alternate;return c===null?(c=ds(r.tag,i,r.key,r.mode),c.elementType=r.elementType,c.type=r.type,c.stateNode=r.stateNode,c.alternate=r,r.alternate=c):(c.pendingProps=i,c.type=r.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=r.flags&14680064,c.childLanes=r.childLanes,c.lanes=r.lanes,c.child=r.child,c.memoizedProps=r.memoizedProps,c.memoizedState=r.memoizedState,c.updateQueue=r.updateQueue,i=r.dependencies,c.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},c.sibling=r.sibling,c.index=r.index,c.ref=r.ref,c}function cu(r,i,c,h,p,v){var S=2;if(h=r,typeof r=="function")Hh(r)&&(S=1);else if(typeof r=="string")S=5;else e:switch(r){case I:return ja(c.children,p,v,i);case N:S=8,p|=8;break;case A:return r=ds(12,c,i,p|2),r.elementType=A,r.lanes=v,r;case b:return r=ds(13,c,i,p),r.elementType=b,r.lanes=v,r;case J:return r=ds(19,c,i,p),r.elementType=J,r.lanes=v,r;case fe:return uu(c,p,v,i);default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case M:S=10;break e;case D:S=9;break e;case P:S=11;break e;case re:S=14;break e;case Ce:S=16,h=null;break e}throw Error(t(130,r==null?r:typeof r,""))}return i=ds(S,c,i,p),i.elementType=r,i.type=h,i.lanes=v,i}function ja(r,i,c,h){return r=ds(7,r,h,i),r.lanes=c,r}function uu(r,i,c,h){return r=ds(22,r,h,i),r.elementType=fe,r.lanes=c,r.stateNode={isHidden:!1},r}function Kh(r,i,c){return r=ds(6,r,null,i),r.lanes=c,r}function Qh(r,i,c){return i=ds(4,r.children!==null?r.children:[],r.key,i),i.lanes=c,i.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},i}function mE(r,i,c,h,p){this.tag=i,this.containerInfo=r,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Zr(0),this.expirationTimes=Zr(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Zr(0),this.identifierPrefix=h,this.onRecoverableError=p,this.mutableSourceEagerHydrationData=null}function Yh(r,i,c,h,p,v,S,V,H){return r=new mE(r,i,c,V,H),i===1?(i=1,v===!0&&(i|=8)):i=0,v=ds(3,null,null,i),r.current=v,v.stateNode=r,v.memoizedState={element:h,isDehydrated:c,cache:null,transitions:null,pendingSuspenseBoundaries:null},ch(v),r}function gE(r,i,c){var h=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ie,key:h==null?null:""+h,children:r,containerInfo:i,implementation:c}}function cy(r){if(!r)return ji;r=r._reactInternals;e:{if(Ut(r)!==r||r.tag!==1)throw Error(t(170));var i=r;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(Ir(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(t(171))}if(r.tag===1){var c=r.type;if(Ir(c))return Mm(r,c,i)}return i}function uy(r,i,c,h,p,v,S,V,H){return r=Yh(c,h,!0,r,p,v,S,V,H),r.context=cy(null),c=r.current,h=vr(),p=Fi(c),v=ci(h,p),v.callback=i??null,Vi(c,v,p),r.current.lanes=p,Ls(r,p,h),Rr(r,h),r}function du(r,i,c,h){var p=i.current,v=vr(),S=Fi(p);return c=cy(c),i.context===null?i.context=c:i.pendingContext=c,i=ci(v,S),i.payload={element:r},h=h===void 0?null:h,h!==null&&(i.callback=h),r=Vi(p,i,S),r!==null&&(Cs(r,p,S,v),$c(r,p,S)),S}function hu(r){if(r=r.current,!r.child)return null;switch(r.child.tag){case 5:return r.child.stateNode;default:return r.child.stateNode}}function dy(r,i){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var c=r.retryLane;r.retryLane=c!==0&&c<i?c:i}}function Jh(r,i){dy(r,i),(r=r.alternate)&&dy(r,i)}function yE(){return null}var hy=typeof reportError=="function"?reportError:function(r){console.error(r)};function Xh(r){this._internalRoot=r}fu.prototype.render=Xh.prototype.render=function(r){var i=this._internalRoot;if(i===null)throw Error(t(409));du(r,i,null,null)},fu.prototype.unmount=Xh.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var i=r.containerInfo;Pa(function(){du(null,r,null,null)}),i[si]=null}};function fu(r){this._internalRoot=r}fu.prototype.unstable_scheduleHydration=function(r){if(r){var i=Ja();r={blockedOn:null,target:r,priority:i};for(var c=0;c<ns.length&&i!==0&&i<ns[c].priority;c++);ns.splice(c,0,r),c===0&&be(r)}};function Zh(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function pu(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11&&(r.nodeType!==8||r.nodeValue!==" react-mount-point-unstable "))}function fy(){}function vE(r,i,c,h,p){if(p){if(typeof h=="function"){var v=h;h=function(){var ae=hu(S);v.call(ae)}}var S=uy(i,h,r,0,null,!1,!1,"",fy);return r._reactRootContainer=S,r[si]=S.current,ul(r.nodeType===8?r.parentNode:r),Pa(),S}for(;p=r.lastChild;)r.removeChild(p);if(typeof h=="function"){var V=h;h=function(){var ae=hu(H);V.call(ae)}}var H=Yh(r,0,!1,null,null,!1,!1,"",fy);return r._reactRootContainer=H,r[si]=H.current,ul(r.nodeType===8?r.parentNode:r),Pa(function(){du(i,H,c,h)}),H}function mu(r,i,c,h,p){var v=c._reactRootContainer;if(v){var S=v;if(typeof p=="function"){var V=p;p=function(){var H=hu(S);V.call(H)}}du(i,S,r,p)}else S=vE(c,i,r,p,h);return hu(S)}ga=function(r){switch(r.tag){case 3:var i=r.stateNode;if(i.current.memoizedState.isDehydrated){var c=Re(i.pendingLanes);c!==0&&(Pt(i,c|1),Rr(i,xt()),(bt&6)===0&&(So=xt()+500,ki()))}break;case 13:Pa(function(){var h=li(r,1);if(h!==null){var p=vr();Cs(h,r,1,p)}}),Jh(r,1)}},ti=function(r){if(r.tag===13){var i=li(r,134217728);if(i!==null){var c=vr();Cs(i,r,134217728,c)}Jh(r,134217728)}},ya=function(r){if(r.tag===13){var i=Fi(r),c=li(r,i);if(c!==null){var h=vr();Cs(c,r,i,h)}Jh(r,i)}},Ja=function(){return ut},es=function(r,i){var c=ut;try{return ut=r,i()}finally{ut=c}},Br=function(r,i,c){switch(i){case"input":if(Ct(r,c),i=c.name,c.type==="radio"&&i!=null){for(c=r;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<c.length;i++){var h=c[i];if(h!==r&&h.form===r.form){var p=jc(h);if(!p)throw Error(t(90));Le(h),Ct(h,p)}}}break;case"textarea":yn(r,c);break;case"select":i=c.value,i!=null&&sn(r,!!c.multiple,i,!1)}},Gr=Wh,Xs=Pa;var _E={usingClientEntryPoint:!1,Events:[fl,uo,jc,ur,Yn,Wh]},Il={findFiberByHostInstance:wa,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},xE={bundleType:Il.bundleType,version:Il.version,rendererPackageName:Il.rendererPackageName,rendererConfig:Il.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ve.ReactCurrentDispatcher,findHostInstanceByFiber:function(r){return r=Ds(r),r===null?null:r.stateNode},findFiberByHostInstance:Il.findFiberByHostInstance||yE,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var gu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!gu.isDisabled&&gu.supportsFiber)try{F=gu.inject(xE),G=gu}catch{}}return Ar.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=_E,Ar.createPortal=function(r,i){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Zh(i))throw Error(t(200));return gE(r,i,null,c)},Ar.createRoot=function(r,i){if(!Zh(r))throw Error(t(299));var c=!1,h="",p=hy;return i!=null&&(i.unstable_strictMode===!0&&(c=!0),i.identifierPrefix!==void 0&&(h=i.identifierPrefix),i.onRecoverableError!==void 0&&(p=i.onRecoverableError)),i=Yh(r,1,!1,null,null,c,!1,h,p),r[si]=i.current,ul(r.nodeType===8?r.parentNode:r),new Xh(i)},Ar.findDOMNode=function(r){if(r==null)return null;if(r.nodeType===1)return r;var i=r._reactInternals;if(i===void 0)throw typeof r.render=="function"?Error(t(188)):(r=Object.keys(r).join(","),Error(t(268,r)));return r=Ds(i),r=r===null?null:r.stateNode,r},Ar.flushSync=function(r){return Pa(r)},Ar.hydrate=function(r,i,c){if(!pu(i))throw Error(t(200));return mu(null,r,i,!0,c)},Ar.hydrateRoot=function(r,i,c){if(!Zh(r))throw Error(t(405));var h=c!=null&&c.hydratedSources||null,p=!1,v="",S=hy;if(c!=null&&(c.unstable_strictMode===!0&&(p=!0),c.identifierPrefix!==void 0&&(v=c.identifierPrefix),c.onRecoverableError!==void 0&&(S=c.onRecoverableError)),i=uy(i,null,r,1,c??null,p,!1,v,S),r[si]=i.current,ul(r),h)for(r=0;r<h.length;r++)c=h[r],p=c._getVersion,p=p(c._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[c,p]:i.mutableSourceEagerHydrationData.push(c,p);return new fu(i)},Ar.render=function(r,i,c){if(!pu(i))throw Error(t(200));return mu(null,r,i,!1,c)},Ar.unmountComponentAtNode=function(r){if(!pu(r))throw Error(t(40));return r._reactRootContainer?(Pa(function(){mu(null,null,r,!1,function(){r._reactRootContainer=null,r[si]=null})}),!0):!1},Ar.unstable_batchedUpdates=Wh,Ar.unstable_renderSubtreeIntoContainer=function(r,i,c,h){if(!pu(c))throw Error(t(200));if(r==null||r._reactInternals===void 0)throw Error(t(38));return mu(r,i,c,!1,h)},Ar.version="18.3.1-next-f1338f8080-20240426",Ar}var wy;function N_(){if(wy)return nf.exports;wy=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),nf.exports=PE(),nf.exports}var Ey;function RE(){if(Ey)return yu;Ey=1;var n=N_();return yu.createRoot=n.createRoot,yu.hydrateRoot=n.hydrateRoot,yu}var AE=RE();const jE=ep(AE);N_();/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Wl(){return Wl=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},Wl.apply(this,arguments)}var Ki;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(Ki||(Ki={}));const Ty="popstate";function kE(n){n===void 0&&(n={});function e(s,a){let{pathname:l,search:d,hash:f}=s.location;return wf("",{pathname:l,search:d,hash:f},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(s,a){return typeof a=="string"?a:Fu(a)}return VE(e,t,null,n)}function ln(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function rp(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function DE(){return Math.random().toString(36).substr(2,8)}function Sy(n,e){return{usr:n.state,key:n.key,idx:e}}function wf(n,e,t,s){return t===void 0&&(t=null),Wl({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?Wo(e):e,{state:t,key:e&&e.key||s||DE()})}function Fu(n){let{pathname:e="/",search:t="",hash:s=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),s&&s!=="#"&&(e+=s.charAt(0)==="#"?s:"#"+s),e}function Wo(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let s=n.indexOf("?");s>=0&&(e.search=n.substr(s),n=n.substr(0,s)),n&&(e.pathname=n)}return e}function VE(n,e,t,s){s===void 0&&(s={});let{window:a=document.defaultView,v5Compat:l=!1}=s,d=a.history,f=Ki.Pop,m=null,y=x();y==null&&(y=0,d.replaceState(Wl({},d.state,{idx:y}),""));function x(){return(d.state||{idx:null}).idx}function E(){f=Ki.Pop;let U=x(),se=U==null?null:U-y;y=U,m&&m({action:f,location:B.location,delta:se})}function C(U,se){f=Ki.Push;let we=wf(B.location,U,se);y=x()+1;let _e=Sy(we,y),ve=B.createHref(we);try{d.pushState(_e,"",ve)}catch(L){if(L instanceof DOMException&&L.name==="DataCloneError")throw L;a.location.assign(ve)}l&&m&&m({action:f,location:B.location,delta:1})}function O(U,se){f=Ki.Replace;let we=wf(B.location,U,se);y=x();let _e=Sy(we,y),ve=B.createHref(we);d.replaceState(_e,"",ve),l&&m&&m({action:f,location:B.location,delta:0})}function X(U){let se=a.location.origin!=="null"?a.location.origin:a.location.href,we=typeof U=="string"?U:Fu(U);return we=we.replace(/ $/,"%20"),ln(se,"No window.location.(origin|href) available to create URL for href: "+we),new URL(we,se)}let B={get action(){return f},get location(){return n(a,d)},listen(U){if(m)throw new Error("A history only accepts one active listener");return a.addEventListener(Ty,E),m=U,()=>{a.removeEventListener(Ty,E),m=null}},createHref(U){return e(a,U)},createURL:X,encodeLocation(U){let se=X(U);return{pathname:se.pathname,search:se.search,hash:se.hash}},push:C,replace:O,go(U){return d.go(U)}};return B}var by;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(by||(by={}));function LE(n,e,t){return t===void 0&&(t="/"),ME(n,e,t)}function ME(n,e,t,s){let a=typeof e=="string"?Wo(e):e,l=sp(a.pathname||"/",t);if(l==null)return null;let d=P_(n);OE(d);let f=null;for(let m=0;f==null&&m<d.length;++m){let y=YE(l);f=HE(d[m],y)}return f}function P_(n,e,t,s){e===void 0&&(e=[]),t===void 0&&(t=[]),s===void 0&&(s="");let a=(l,d,f)=>{let m={relativePath:f===void 0?l.path||"":f,caseSensitive:l.caseSensitive===!0,childrenIndex:d,route:l};m.relativePath.startsWith("/")&&(ln(m.relativePath.startsWith(s),'Absolute route path "'+m.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),m.relativePath=m.relativePath.slice(s.length));let y=Ji([s,m.relativePath]),x=t.concat(m);l.children&&l.children.length>0&&(ln(l.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+y+'".')),P_(l.children,e,x,y)),!(l.path==null&&!l.index)&&e.push({path:y,score:GE(y,l.index),routesMeta:x})};return n.forEach((l,d)=>{var f;if(l.path===""||!((f=l.path)!=null&&f.includes("?")))a(l,d);else for(let m of R_(l.path))a(l,d,m)}),e}function R_(n){let e=n.split("/");if(e.length===0)return[];let[t,...s]=e,a=t.endsWith("?"),l=t.replace(/\?$/,"");if(s.length===0)return a?[l,""]:[l];let d=R_(s.join("/")),f=[];return f.push(...d.map(m=>m===""?l:[l,m].join("/"))),a&&f.push(...d),f.map(m=>n.startsWith("/")&&m===""?"/":m)}function OE(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:qE(e.routesMeta.map(s=>s.childrenIndex),t.routesMeta.map(s=>s.childrenIndex)))}const FE=/^:[\w-]+$/,UE=3,zE=2,$E=1,BE=10,WE=-2,Cy=n=>n==="*";function GE(n,e){let t=n.split("/"),s=t.length;return t.some(Cy)&&(s+=WE),e&&(s+=zE),t.filter(a=>!Cy(a)).reduce((a,l)=>a+(FE.test(l)?UE:l===""?$E:BE),s)}function qE(n,e){return n.length===e.length&&n.slice(0,-1).every((s,a)=>s===e[a])?n[n.length-1]-e[e.length-1]:0}function HE(n,e,t){let{routesMeta:s}=n,a={},l="/",d=[];for(let f=0;f<s.length;++f){let m=s[f],y=f===s.length-1,x=l==="/"?e:e.slice(l.length)||"/",E=KE({path:m.relativePath,caseSensitive:m.caseSensitive,end:y},x),C=m.route;if(!E)return null;Object.assign(a,E.params),d.push({params:a,pathname:Ji([l,E.pathname]),pathnameBase:t1(Ji([l,E.pathnameBase])),route:C}),E.pathnameBase!=="/"&&(l=Ji([l,E.pathnameBase]))}return d}function KE(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,s]=QE(n.path,n.caseSensitive,n.end),a=e.match(t);if(!a)return null;let l=a[0],d=l.replace(/(.)\/+$/,"$1"),f=a.slice(1);return{params:s.reduce((y,x,E)=>{let{paramName:C,isOptional:O}=x;if(C==="*"){let B=f[E]||"";d=l.slice(0,l.length-B.length).replace(/(.)\/+$/,"$1")}const X=f[E];return O&&!X?y[C]=void 0:y[C]=(X||"").replace(/%2F/g,"/"),y},{}),pathname:l,pathnameBase:d,pattern:n}}function QE(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),rp(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let s=[],a="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,f,m)=>(s.push({paramName:f,isOptional:m!=null}),m?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(s.push({paramName:"*"}),a+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?a+="\\/*$":n!==""&&n!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),s]}function YE(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return rp(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function sp(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,s=n.charAt(t);return s&&s!=="/"?null:n.slice(t)||"/"}const JE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,XE=n=>JE.test(n);function ZE(n,e){e===void 0&&(e="/");let{pathname:t,search:s="",hash:a=""}=typeof n=="string"?Wo(n):n,l;if(t)if(XE(t))l=t;else{if(t.includes("//")){let d=t;t=t.replace(/\/\/+/g,"/"),rp(!1,"Pathnames cannot have embedded double slashes - normalizing "+(d+" -> "+t))}t.startsWith("/")?l=Iy(t.substring(1),"/"):l=Iy(t,e)}else l=e;return{pathname:l,search:n1(s),hash:r1(a)}}function Iy(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(a=>{a===".."?t.length>1&&t.pop():a!=="."&&t.push(a)}),t.length>1?t.join("/"):"/"}function af(n,e,t,s){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function e1(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function ip(n,e){let t=e1(n);return e?t.map((s,a)=>a===t.length-1?s.pathname:s.pathnameBase):t.map(s=>s.pathnameBase)}function ap(n,e,t,s){s===void 0&&(s=!1);let a;typeof n=="string"?a=Wo(n):(a=Wl({},n),ln(!a.pathname||!a.pathname.includes("?"),af("?","pathname","search",a)),ln(!a.pathname||!a.pathname.includes("#"),af("#","pathname","hash",a)),ln(!a.search||!a.search.includes("#"),af("#","search","hash",a)));let l=n===""||a.pathname==="",d=l?"/":a.pathname,f;if(d==null)f=t;else{let E=e.length-1;if(!s&&d.startsWith("..")){let C=d.split("/");for(;C[0]==="..";)C.shift(),E-=1;a.pathname=C.join("/")}f=E>=0?e[E]:"/"}let m=ZE(a,f),y=d&&d!=="/"&&d.endsWith("/"),x=(l||d===".")&&t.endsWith("/");return!m.pathname.endsWith("/")&&(y||x)&&(m.pathname+="/"),m}const Ji=n=>n.join("/").replace(/\/\/+/g,"/"),t1=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),n1=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,r1=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function s1(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const A_=["post","put","patch","delete"];new Set(A_);const i1=["get",...A_];new Set(i1);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Gl(){return Gl=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},Gl.apply(this,arguments)}const op=j.createContext(null),a1=j.createContext(null),ua=j.createContext(null),ad=j.createContext(null),da=j.createContext({outlet:null,matches:[],isDataRoute:!1}),j_=j.createContext(null);function o1(n,e){let{relative:t}=e===void 0?{}:e;Go()||ln(!1);let{basename:s,navigator:a}=j.useContext(ua),{hash:l,pathname:d,search:f}=D_(n,{relative:t}),m=d;return s!=="/"&&(m=d==="/"?s:Ji([s,d])),a.createHref({pathname:m,search:f,hash:l})}function Go(){return j.useContext(ad)!=null}function qo(){return Go()||ln(!1),j.useContext(ad).location}function k_(n){j.useContext(ua).static||j.useLayoutEffect(n)}function rc(){let{isDataRoute:n}=j.useContext(da);return n?x1():l1()}function l1(){Go()||ln(!1);let n=j.useContext(op),{basename:e,future:t,navigator:s}=j.useContext(ua),{matches:a}=j.useContext(da),{pathname:l}=qo(),d=JSON.stringify(ip(a,t.v7_relativeSplatPath)),f=j.useRef(!1);return k_(()=>{f.current=!0}),j.useCallback(function(y,x){if(x===void 0&&(x={}),!f.current)return;if(typeof y=="number"){s.go(y);return}let E=ap(y,JSON.parse(d),l,x.relative==="path");n==null&&e!=="/"&&(E.pathname=E.pathname==="/"?e:Ji([e,E.pathname])),(x.replace?s.replace:s.push)(E,x.state,x)},[e,s,d,l,n])}function D_(n,e){let{relative:t}=e===void 0?{}:e,{future:s}=j.useContext(ua),{matches:a}=j.useContext(da),{pathname:l}=qo(),d=JSON.stringify(ip(a,s.v7_relativeSplatPath));return j.useMemo(()=>ap(n,JSON.parse(d),l,t==="path"),[n,d,l,t])}function c1(n,e){return u1(n,e)}function u1(n,e,t,s){Go()||ln(!1);let{navigator:a}=j.useContext(ua),{matches:l}=j.useContext(da),d=l[l.length-1],f=d?d.params:{};d&&d.pathname;let m=d?d.pathnameBase:"/";d&&d.route;let y=qo(),x;if(e){var E;let U=typeof e=="string"?Wo(e):e;m==="/"||(E=U.pathname)!=null&&E.startsWith(m)||ln(!1),x=U}else x=y;let C=x.pathname||"/",O=C;if(m!=="/"){let U=m.replace(/^\//,"").split("/");O="/"+C.replace(/^\//,"").split("/").slice(U.length).join("/")}let X=LE(n,{pathname:O}),B=m1(X&&X.map(U=>Object.assign({},U,{params:Object.assign({},f,U.params),pathname:Ji([m,a.encodeLocation?a.encodeLocation(U.pathname).pathname:U.pathname]),pathnameBase:U.pathnameBase==="/"?m:Ji([m,a.encodeLocation?a.encodeLocation(U.pathnameBase).pathname:U.pathnameBase])})),l,t,s);return e&&B?j.createElement(ad.Provider,{value:{location:Gl({pathname:"/",search:"",hash:"",state:null,key:"default"},x),navigationType:Ki.Pop}},B):B}function d1(){let n=_1(),e=s1(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return j.createElement(j.Fragment,null,j.createElement("h2",null,"Unexpected Application Error!"),j.createElement("h3",{style:{fontStyle:"italic"}},e),t?j.createElement("pre",{style:a},t):null,null)}const h1=j.createElement(d1,null);class f1 extends j.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?j.createElement(da.Provider,{value:this.props.routeContext},j.createElement(j_.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function p1(n){let{routeContext:e,match:t,children:s}=n,a=j.useContext(op);return a&&a.static&&a.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=t.route.id),j.createElement(da.Provider,{value:e},s)}function m1(n,e,t,s){var a;if(e===void 0&&(e=[]),t===void 0&&(t=null),s===void 0&&(s=null),n==null){var l;if(!t)return null;if(t.errors)n=t.matches;else if((l=s)!=null&&l.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let d=n,f=(a=t)==null?void 0:a.errors;if(f!=null){let x=d.findIndex(E=>E.route.id&&(f==null?void 0:f[E.route.id])!==void 0);x>=0||ln(!1),d=d.slice(0,Math.min(d.length,x+1))}let m=!1,y=-1;if(t&&s&&s.v7_partialHydration)for(let x=0;x<d.length;x++){let E=d[x];if((E.route.HydrateFallback||E.route.hydrateFallbackElement)&&(y=x),E.route.id){let{loaderData:C,errors:O}=t,X=E.route.loader&&C[E.route.id]===void 0&&(!O||O[E.route.id]===void 0);if(E.route.lazy||X){m=!0,y>=0?d=d.slice(0,y+1):d=[d[0]];break}}}return d.reduceRight((x,E,C)=>{let O,X=!1,B=null,U=null;t&&(O=f&&E.route.id?f[E.route.id]:void 0,B=E.route.errorElement||h1,m&&(y<0&&C===0?(w1("route-fallback"),X=!0,U=null):y===C&&(X=!0,U=E.route.hydrateFallbackElement||null)));let se=e.concat(d.slice(0,C+1)),we=()=>{let _e;return O?_e=B:X?_e=U:E.route.Component?_e=j.createElement(E.route.Component,null):E.route.element?_e=E.route.element:_e=x,j.createElement(p1,{match:E,routeContext:{outlet:x,matches:se,isDataRoute:t!=null},children:_e})};return t&&(E.route.ErrorBoundary||E.route.errorElement||C===0)?j.createElement(f1,{location:t.location,revalidation:t.revalidation,component:B,error:O,children:we(),routeContext:{outlet:null,matches:se,isDataRoute:!0}}):we()},null)}var V_=(function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n})(V_||{}),L_=(function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n})(L_||{});function g1(n){let e=j.useContext(op);return e||ln(!1),e}function y1(n){let e=j.useContext(a1);return e||ln(!1),e}function v1(n){let e=j.useContext(da);return e||ln(!1),e}function M_(n){let e=v1(),t=e.matches[e.matches.length-1];return t.route.id||ln(!1),t.route.id}function _1(){var n;let e=j.useContext(j_),t=y1(),s=M_();return e!==void 0?e:(n=t.errors)==null?void 0:n[s]}function x1(){let{router:n}=g1(V_.UseNavigateStable),e=M_(L_.UseNavigateStable),t=j.useRef(!1);return k_(()=>{t.current=!0}),j.useCallback(function(a,l){l===void 0&&(l={}),t.current&&(typeof a=="number"?n.navigate(a):n.navigate(a,Gl({fromRouteId:e},l)))},[n,e])}const Ny={};function w1(n,e,t){Ny[n]||(Ny[n]=!0)}function E1(n,e){n==null||n.v7_startTransition,n==null||n.v7_relativeSplatPath}function Ef(n){let{to:e,replace:t,state:s,relative:a}=n;Go()||ln(!1);let{future:l,static:d}=j.useContext(ua),{matches:f}=j.useContext(da),{pathname:m}=qo(),y=rc(),x=ap(e,ip(f,l.v7_relativeSplatPath),m,a==="path"),E=JSON.stringify(x);return j.useEffect(()=>y(JSON.parse(E),{replace:t,state:s,relative:a}),[y,E,a,t,s]),null}function hs(n){ln(!1)}function T1(n){let{basename:e="/",children:t=null,location:s,navigationType:a=Ki.Pop,navigator:l,static:d=!1,future:f}=n;Go()&&ln(!1);let m=e.replace(/^\/*/,"/"),y=j.useMemo(()=>({basename:m,navigator:l,static:d,future:Gl({v7_relativeSplatPath:!1},f)}),[m,f,l,d]);typeof s=="string"&&(s=Wo(s));let{pathname:x="/",search:E="",hash:C="",state:O=null,key:X="default"}=s,B=j.useMemo(()=>{let U=sp(x,m);return U==null?null:{location:{pathname:U,search:E,hash:C,state:O,key:X},navigationType:a}},[m,x,E,C,O,X,a]);return B==null?null:j.createElement(ua.Provider,{value:y},j.createElement(ad.Provider,{children:t,value:B}))}function S1(n){let{children:e,location:t}=n;return c1(Tf(e),t)}new Promise(()=>{});function Tf(n,e){e===void 0&&(e=[]);let t=[];return j.Children.forEach(n,(s,a)=>{if(!j.isValidElement(s))return;let l=[...e,a];if(s.type===j.Fragment){t.push.apply(t,Tf(s.props.children,l));return}s.type!==hs&&ln(!1),!s.props.index||!s.props.children||ln(!1);let d={id:s.props.id||l.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(d.children=Tf(s.props.children,l)),t.push(d)}),t}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Sf(){return Sf=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},Sf.apply(this,arguments)}function b1(n,e){if(n==null)return{};var t={},s=Object.keys(n),a,l;for(l=0;l<s.length;l++)a=s[l],!(e.indexOf(a)>=0)&&(t[a]=n[a]);return t}function C1(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function I1(n,e){return n.button===0&&(!e||e==="_self")&&!C1(n)}function bf(n){return n===void 0&&(n=""),new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((e,t)=>{let s=n[t];return e.concat(Array.isArray(s)?s.map(a=>[t,a]):[[t,s]])},[]))}function N1(n,e){let t=bf(n);return e&&e.forEach((s,a)=>{t.has(a)||e.getAll(a).forEach(l=>{t.append(a,l)})}),t}const P1=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],R1="6";try{window.__reactRouterVersion=R1}catch{}const A1="startTransition",Py=CE[A1];function j1(n){let{basename:e,children:t,future:s,window:a}=n,l=j.useRef();l.current==null&&(l.current=kE({window:a,v5Compat:!0}));let d=l.current,[f,m]=j.useState({action:d.action,location:d.location}),{v7_startTransition:y}=s||{},x=j.useCallback(E=>{y&&Py?Py(()=>m(E)):m(E)},[m,y]);return j.useLayoutEffect(()=>d.listen(x),[d,x]),j.useEffect(()=>E1(s),[s]),j.createElement(T1,{basename:e,children:t,location:f.location,navigationType:f.action,navigator:d,future:s})}const k1=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",D1=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Bi=j.forwardRef(function(e,t){let{onClick:s,relative:a,reloadDocument:l,replace:d,state:f,target:m,to:y,preventScrollReset:x,viewTransition:E}=e,C=b1(e,P1),{basename:O}=j.useContext(ua),X,B=!1;if(typeof y=="string"&&D1.test(y)&&(X=y,k1))try{let _e=new URL(window.location.href),ve=y.startsWith("//")?new URL(_e.protocol+y):new URL(y),L=sp(ve.pathname,O);ve.origin===_e.origin&&L!=null?y=L+ve.search+ve.hash:B=!0}catch{}let U=o1(y,{relative:a}),se=V1(y,{replace:d,state:f,target:m,preventScrollReset:x,relative:a,viewTransition:E});function we(_e){s&&s(_e),_e.defaultPrevented||se(_e)}return j.createElement("a",Sf({},C,{href:X||U,onClick:B||l?s:we,ref:t,target:m}))});var Ry;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(Ry||(Ry={}));var Ay;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(Ay||(Ay={}));function V1(n,e){let{target:t,replace:s,state:a,preventScrollReset:l,relative:d,viewTransition:f}=e===void 0?{}:e,m=rc(),y=qo(),x=D_(n,{relative:d});return j.useCallback(E=>{if(I1(E,t)){E.preventDefault();let C=s!==void 0?s:Fu(y)===Fu(x);m(n,{replace:C,state:a,preventScrollReset:l,relative:d,viewTransition:f})}},[y,m,x,s,a,t,n,l,d,f])}function L1(n){let e=j.useRef(bf(n)),t=j.useRef(!1),s=qo(),a=j.useMemo(()=>N1(s.search,t.current?null:e.current),[s.search]),l=rc(),d=j.useCallback((f,m)=>{const y=bf(typeof f=="function"?f(a):f);t.current=!0,l("?"+y,m)},[l,a]);return[a,d]}const M1=()=>{};var jy={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O_=function(n){const e=[];let t=0;for(let s=0;s<n.length;s++){let a=n.charCodeAt(s);a<128?e[t++]=a:a<2048?(e[t++]=a>>6|192,e[t++]=a&63|128):(a&64512)===55296&&s+1<n.length&&(n.charCodeAt(s+1)&64512)===56320?(a=65536+((a&1023)<<10)+(n.charCodeAt(++s)&1023),e[t++]=a>>18|240,e[t++]=a>>12&63|128,e[t++]=a>>6&63|128,e[t++]=a&63|128):(e[t++]=a>>12|224,e[t++]=a>>6&63|128,e[t++]=a&63|128)}return e},O1=function(n){const e=[];let t=0,s=0;for(;t<n.length;){const a=n[t++];if(a<128)e[s++]=String.fromCharCode(a);else if(a>191&&a<224){const l=n[t++];e[s++]=String.fromCharCode((a&31)<<6|l&63)}else if(a>239&&a<365){const l=n[t++],d=n[t++],f=n[t++],m=((a&7)<<18|(l&63)<<12|(d&63)<<6|f&63)-65536;e[s++]=String.fromCharCode(55296+(m>>10)),e[s++]=String.fromCharCode(56320+(m&1023))}else{const l=n[t++],d=n[t++];e[s++]=String.fromCharCode((a&15)<<12|(l&63)<<6|d&63)}}return e.join("")},F_={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let a=0;a<n.length;a+=3){const l=n[a],d=a+1<n.length,f=d?n[a+1]:0,m=a+2<n.length,y=m?n[a+2]:0,x=l>>2,E=(l&3)<<4|f>>4;let C=(f&15)<<2|y>>6,O=y&63;m||(O=64,d||(C=64)),s.push(t[x],t[E],t[C],t[O])}return s.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(O_(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):O1(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let a=0;a<n.length;){const l=t[n.charAt(a++)],f=a<n.length?t[n.charAt(a)]:0;++a;const y=a<n.length?t[n.charAt(a)]:64;++a;const E=a<n.length?t[n.charAt(a)]:64;if(++a,l==null||f==null||y==null||E==null)throw new F1;const C=l<<2|f>>4;if(s.push(C),y!==64){const O=f<<4&240|y>>2;if(s.push(O),E!==64){const X=y<<6&192|E;s.push(X)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class F1 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const U1=function(n){const e=O_(n);return F_.encodeByteArray(e,!0)},Uu=function(n){return U1(n).replace(/\./g,"")},U_=function(n){try{return F_.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z1(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $1=()=>z1().__FIREBASE_DEFAULTS__,B1=()=>{if(typeof process>"u"||typeof jy>"u")return;const n=jy.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},W1=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&U_(n[1]);return e&&JSON.parse(e)},od=()=>{try{return M1()||$1()||B1()||W1()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},z_=n=>{var e,t;return(t=(e=od())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},G1=n=>{const e=z_(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),s]:[e.substring(0,t),s]},$_=()=>{var n;return(n=od())===null||n===void 0?void 0:n.config},B_=n=>{var e;return(e=od())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q1{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,s)=>{t?this.reject(t):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,s))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ho(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function W_(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H1(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},s=e||"demo-project",a=n.iat||0,l=n.sub||n.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d=Object.assign({iss:`https://securetoken.google.com/${s}`,aud:s,iat:a,exp:a+3600,auth_time:a,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Uu(JSON.stringify(t)),Uu(JSON.stringify(d)),""].join(".")}const Ml={};function K1(){const n={prod:[],emulator:[]};for(const e of Object.keys(Ml))Ml[e]?n.emulator.push(e):n.prod.push(e);return n}function Q1(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let ky=!1;function G_(n,e){if(typeof window>"u"||typeof document>"u"||!Ho(window.location.host)||Ml[n]===e||Ml[n]||ky)return;Ml[n]=e;function t(C){return`__firebase__banner__${C}`}const s="__firebase__banner",l=K1().prod.length>0;function d(){const C=document.getElementById(s);C&&C.remove()}function f(C){C.style.display="flex",C.style.background="#7faaf0",C.style.position="fixed",C.style.bottom="5px",C.style.left="5px",C.style.padding=".5em",C.style.borderRadius="5px",C.style.alignItems="center"}function m(C,O){C.setAttribute("width","24"),C.setAttribute("id",O),C.setAttribute("height","24"),C.setAttribute("viewBox","0 0 24 24"),C.setAttribute("fill","none"),C.style.marginLeft="-6px"}function y(){const C=document.createElement("span");return C.style.cursor="pointer",C.style.marginLeft="16px",C.style.fontSize="24px",C.innerHTML=" &times;",C.onclick=()=>{ky=!0,d()},C}function x(C,O){C.setAttribute("id",O),C.innerText="Learn more",C.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",C.setAttribute("target","__blank"),C.style.paddingLeft="5px",C.style.textDecoration="underline"}function E(){const C=Q1(s),O=t("text"),X=document.getElementById(O)||document.createElement("span"),B=t("learnmore"),U=document.getElementById(B)||document.createElement("a"),se=t("preprendIcon"),we=document.getElementById(se)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(C.created){const _e=C.element;f(_e),x(U,B);const ve=y();m(we,se),_e.append(we,X,U,ve),document.body.appendChild(_e)}l?(X.innerText="Preview backend disconnected.",we.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(we.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,X.innerText="Preview backend running in this workspace."),X.setAttribute("id",O)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",E):E()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Y1(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(lr())}function J1(){var n;const e=(n=od())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function X1(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Z1(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function eT(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function tT(){const n=lr();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function nT(){return!J1()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function rT(){try{return typeof indexedDB=="object"}catch{return!1}}function sT(){return new Promise((n,e)=>{try{let t=!0;const s="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(s);a.onsuccess=()=>{a.result.close(),t||self.indexedDB.deleteDatabase(s),n(!0)},a.onupgradeneeded=()=>{t=!1},a.onerror=()=>{var l;e(((l=a.error)===null||l===void 0?void 0:l.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iT="FirebaseError";class Si extends Error{constructor(e,t,s){super(t),this.code=e,this.customData=s,this.name=iT,Object.setPrototypeOf(this,Si.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,sc.prototype.create)}}class sc{constructor(e,t,s){this.service=e,this.serviceName=t,this.errors=s}create(e,...t){const s=t[0]||{},a=`${this.service}/${e}`,l=this.errors[e],d=l?aT(l,s):"Error",f=`${this.serviceName}: ${d} (${a}).`;return new Si(a,f,s)}}function aT(n,e){return n.replace(oT,(t,s)=>{const a=e[s];return a!=null?String(a):`<${s}?>`})}const oT=/\{\$([^}]+)}/g;function lT(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function $a(n,e){if(n===e)return!0;const t=Object.keys(n),s=Object.keys(e);for(const a of t){if(!s.includes(a))return!1;const l=n[a],d=e[a];if(Dy(l)&&Dy(d)){if(!$a(l,d))return!1}else if(l!==d)return!1}for(const a of s)if(!t.includes(a))return!1;return!0}function Dy(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ic(n){const e=[];for(const[t,s]of Object.entries(n))Array.isArray(s)?s.forEach(a=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function Al(n){const e={};return n.replace(/^\?/,"").split("&").forEach(s=>{if(s){const[a,l]=s.split("=");e[decodeURIComponent(a)]=decodeURIComponent(l)}}),e}function jl(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function cT(n,e){const t=new uT(n,e);return t.subscribe.bind(t)}class uT{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,s){let a;if(e===void 0&&t===void 0&&s===void 0)throw new Error("Missing Observer.");dT(e,["next","error","complete"])?a=e:a={next:e,error:t,complete:s},a.next===void 0&&(a.next=of),a.error===void 0&&(a.error=of),a.complete===void 0&&(a.complete=of);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function dT(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function of(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rn(n){return n&&n._delegate?n._delegate:n}class Ba{constructor(e,t,s){this.name=e,this.instanceFactory=t,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ka="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hT{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const s=new q1;if(this.instancesDeferred.set(t,s),this.isInitialized(t)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:t});a&&s.resolve(a)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const s=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),a=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(s)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:s})}catch(l){if(a)return null;throw l}else{if(a)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(pT(e))try{this.getOrInitializeService({instanceIdentifier:ka})}catch{}for(const[t,s]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(t);try{const l=this.getOrInitializeService({instanceIdentifier:a});s.resolve(l)}catch{}}}}clearInstance(e=ka){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ka){return this.instances.has(e)}getOptions(e=ka){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:s,options:t});for(const[l,d]of this.instancesDeferred.entries()){const f=this.normalizeInstanceIdentifier(l);s===f&&d.resolve(a)}return a}onInit(e,t){var s;const a=this.normalizeInstanceIdentifier(t),l=(s=this.onInitCallbacks.get(a))!==null&&s!==void 0?s:new Set;l.add(e),this.onInitCallbacks.set(a,l);const d=this.instances.get(a);return d&&e(d,a),()=>{l.delete(e)}}invokeOnInitCallbacks(e,t){const s=this.onInitCallbacks.get(t);if(s)for(const a of s)try{a(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:fT(e),options:t}),this.instances.set(e,s),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=ka){return this.component?this.component.multipleInstances?e:ka:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function fT(n){return n===ka?void 0:n}function pT(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mT{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new hT(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var yt;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(yt||(yt={}));const gT={debug:yt.DEBUG,verbose:yt.VERBOSE,info:yt.INFO,warn:yt.WARN,error:yt.ERROR,silent:yt.SILENT},yT=yt.INFO,vT={[yt.DEBUG]:"log",[yt.VERBOSE]:"log",[yt.INFO]:"info",[yt.WARN]:"warn",[yt.ERROR]:"error"},_T=(n,e,...t)=>{if(e<n.logLevel)return;const s=new Date().toISOString(),a=vT[e];if(a)console[a](`[${s}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class lp{constructor(e){this.name=e,this._logLevel=yT,this._logHandler=_T,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in yt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?gT[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,yt.DEBUG,...e),this._logHandler(this,yt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,yt.VERBOSE,...e),this._logHandler(this,yt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,yt.INFO,...e),this._logHandler(this,yt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,yt.WARN,...e),this._logHandler(this,yt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,yt.ERROR,...e),this._logHandler(this,yt.ERROR,...e)}}const xT=(n,e)=>e.some(t=>n instanceof t);let Vy,Ly;function wT(){return Vy||(Vy=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ET(){return Ly||(Ly=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const q_=new WeakMap,Cf=new WeakMap,H_=new WeakMap,lf=new WeakMap,cp=new WeakMap;function TT(n){const e=new Promise((t,s)=>{const a=()=>{n.removeEventListener("success",l),n.removeEventListener("error",d)},l=()=>{t(Xi(n.result)),a()},d=()=>{s(n.error),a()};n.addEventListener("success",l),n.addEventListener("error",d)});return e.then(t=>{t instanceof IDBCursor&&q_.set(t,n)}).catch(()=>{}),cp.set(e,n),e}function ST(n){if(Cf.has(n))return;const e=new Promise((t,s)=>{const a=()=>{n.removeEventListener("complete",l),n.removeEventListener("error",d),n.removeEventListener("abort",d)},l=()=>{t(),a()},d=()=>{s(n.error||new DOMException("AbortError","AbortError")),a()};n.addEventListener("complete",l),n.addEventListener("error",d),n.addEventListener("abort",d)});Cf.set(n,e)}let If={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Cf.get(n);if(e==="objectStoreNames")return n.objectStoreNames||H_.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Xi(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function bT(n){If=n(If)}function CT(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const s=n.call(cf(this),e,...t);return H_.set(s,e.sort?e.sort():[e]),Xi(s)}:ET().includes(n)?function(...e){return n.apply(cf(this),e),Xi(q_.get(this))}:function(...e){return Xi(n.apply(cf(this),e))}}function IT(n){return typeof n=="function"?CT(n):(n instanceof IDBTransaction&&ST(n),xT(n,wT())?new Proxy(n,If):n)}function Xi(n){if(n instanceof IDBRequest)return TT(n);if(lf.has(n))return lf.get(n);const e=IT(n);return e!==n&&(lf.set(n,e),cp.set(e,n)),e}const cf=n=>cp.get(n);function NT(n,e,{blocked:t,upgrade:s,blocking:a,terminated:l}={}){const d=indexedDB.open(n,e),f=Xi(d);return s&&d.addEventListener("upgradeneeded",m=>{s(Xi(d.result),m.oldVersion,m.newVersion,Xi(d.transaction),m)}),t&&d.addEventListener("blocked",m=>t(m.oldVersion,m.newVersion,m)),f.then(m=>{l&&m.addEventListener("close",()=>l()),a&&m.addEventListener("versionchange",y=>a(y.oldVersion,y.newVersion,y))}).catch(()=>{}),f}const PT=["get","getKey","getAll","getAllKeys","count"],RT=["put","add","delete","clear"],uf=new Map;function My(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(uf.get(e))return uf.get(e);const t=e.replace(/FromIndex$/,""),s=e!==t,a=RT.includes(t);if(!(t in(s?IDBIndex:IDBObjectStore).prototype)||!(a||PT.includes(t)))return;const l=async function(d,...f){const m=this.transaction(d,a?"readwrite":"readonly");let y=m.store;return s&&(y=y.index(f.shift())),(await Promise.all([y[t](...f),a&&m.done]))[0]};return uf.set(e,l),l}bT(n=>({...n,get:(e,t,s)=>My(e,t)||n.get(e,t,s),has:(e,t)=>!!My(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AT{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(jT(t)){const s=t.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(t=>t).join(" ")}}function jT(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Nf="@firebase/app",Oy="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yi=new lp("@firebase/app"),kT="@firebase/app-compat",DT="@firebase/analytics-compat",VT="@firebase/analytics",LT="@firebase/app-check-compat",MT="@firebase/app-check",OT="@firebase/auth",FT="@firebase/auth-compat",UT="@firebase/database",zT="@firebase/data-connect",$T="@firebase/database-compat",BT="@firebase/functions",WT="@firebase/functions-compat",GT="@firebase/installations",qT="@firebase/installations-compat",HT="@firebase/messaging",KT="@firebase/messaging-compat",QT="@firebase/performance",YT="@firebase/performance-compat",JT="@firebase/remote-config",XT="@firebase/remote-config-compat",ZT="@firebase/storage",eS="@firebase/storage-compat",tS="@firebase/firestore",nS="@firebase/ai",rS="@firebase/firestore-compat",sS="firebase",iS="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pf="[DEFAULT]",aS={[Nf]:"fire-core",[kT]:"fire-core-compat",[VT]:"fire-analytics",[DT]:"fire-analytics-compat",[MT]:"fire-app-check",[LT]:"fire-app-check-compat",[OT]:"fire-auth",[FT]:"fire-auth-compat",[UT]:"fire-rtdb",[zT]:"fire-data-connect",[$T]:"fire-rtdb-compat",[BT]:"fire-fn",[WT]:"fire-fn-compat",[GT]:"fire-iid",[qT]:"fire-iid-compat",[HT]:"fire-fcm",[KT]:"fire-fcm-compat",[QT]:"fire-perf",[YT]:"fire-perf-compat",[JT]:"fire-rc",[XT]:"fire-rc-compat",[ZT]:"fire-gcs",[eS]:"fire-gcs-compat",[tS]:"fire-fst",[rS]:"fire-fst-compat",[nS]:"fire-vertex","fire-js":"fire-js",[sS]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zu=new Map,oS=new Map,Rf=new Map;function Fy(n,e){try{n.container.addComponent(e)}catch(t){yi.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Mo(n){const e=n.name;if(Rf.has(e))return yi.debug(`There were multiple attempts to register component ${e}.`),!1;Rf.set(e,n);for(const t of zu.values())Fy(t,n);for(const t of oS.values())Fy(t,n);return!0}function up(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function zr(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lS={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Zi=new sc("app","Firebase",lS);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cS{constructor(e,t,s){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new Ba("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Zi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ko=iS;function K_(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const s=Object.assign({name:Pf,automaticDataCollectionEnabled:!0},e),a=s.name;if(typeof a!="string"||!a)throw Zi.create("bad-app-name",{appName:String(a)});if(t||(t=$_()),!t)throw Zi.create("no-options");const l=zu.get(a);if(l){if($a(t,l.options)&&$a(s,l.config))return l;throw Zi.create("duplicate-app",{appName:a})}const d=new mT(a);for(const m of Rf.values())d.addComponent(m);const f=new cS(t,s,d);return zu.set(a,f),f}function Q_(n=Pf){const e=zu.get(n);if(!e&&n===Pf&&$_())return K_();if(!e)throw Zi.create("no-app",{appName:n});return e}function ea(n,e,t){var s;let a=(s=aS[n])!==null&&s!==void 0?s:n;t&&(a+=`-${t}`);const l=a.match(/\s|\//),d=e.match(/\s|\//);if(l||d){const f=[`Unable to register library "${a}" with version "${e}":`];l&&f.push(`library name "${a}" contains illegal characters (whitespace or "/")`),l&&d&&f.push("and"),d&&f.push(`version name "${e}" contains illegal characters (whitespace or "/")`),yi.warn(f.join(" "));return}Mo(new Ba(`${a}-version`,()=>({library:a,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uS="firebase-heartbeat-database",dS=1,ql="firebase-heartbeat-store";let df=null;function Y_(){return df||(df=NT(uS,dS,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(ql)}catch(t){console.warn(t)}}}}).catch(n=>{throw Zi.create("idb-open",{originalErrorMessage:n.message})})),df}async function hS(n){try{const t=(await Y_()).transaction(ql),s=await t.objectStore(ql).get(J_(n));return await t.done,s}catch(e){if(e instanceof Si)yi.warn(e.message);else{const t=Zi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});yi.warn(t.message)}}}async function Uy(n,e){try{const s=(await Y_()).transaction(ql,"readwrite");await s.objectStore(ql).put(e,J_(n)),await s.done}catch(t){if(t instanceof Si)yi.warn(t.message);else{const s=Zi.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});yi.warn(s.message)}}}function J_(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fS=1024,pS=30;class mS{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new yS(t),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){var e,t;try{const a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),l=zy();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===l||this._heartbeatsCache.heartbeats.some(d=>d.date===l))return;if(this._heartbeatsCache.heartbeats.push({date:l,agent:a}),this._heartbeatsCache.heartbeats.length>pS){const d=vS(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(d,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(s){yi.warn(s)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=zy(),{heartbeatsToSend:s,unsentEntries:a}=gS(this._heartbeatsCache.heartbeats),l=Uu(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=t,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(t){return yi.warn(t),""}}}function zy(){return new Date().toISOString().substring(0,10)}function gS(n,e=fS){const t=[];let s=n.slice();for(const a of n){const l=t.find(d=>d.agent===a.agent);if(l){if(l.dates.push(a.date),$y(t)>e){l.dates.pop();break}}else if(t.push({agent:a.agent,dates:[a.date]}),$y(t)>e){t.pop();break}s=s.slice(1)}return{heartbeatsToSend:t,unsentEntries:s}}class yS{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return rT()?sT().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await hS(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const a=await this.read();return Uy(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:a.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const a=await this.read();return Uy(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:a.lastSentHeartbeatDate,heartbeats:[...a.heartbeats,...e.heartbeats]})}else return}}function $y(n){return Uu(JSON.stringify({version:2,heartbeats:n})).length}function vS(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let s=1;s<n.length;s++)n[s].date<t&&(t=n[s].date,e=s);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _S(n){Mo(new Ba("platform-logger",e=>new AT(e),"PRIVATE")),Mo(new Ba("heartbeat",e=>new mS(e),"PRIVATE")),ea(Nf,Oy,n),ea(Nf,Oy,"esm2017"),ea("fire-js","")}_S("");var xS="firebase",wS="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ea(xS,wS,"app");function dp(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(n);a<s.length;a++)e.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(n,s[a])&&(t[s[a]]=n[s[a]]);return t}function X_(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const ES=X_,Z_=new sc("auth","Firebase",X_());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $u=new lp("@firebase/auth");function TS(n,...e){$u.logLevel<=yt.WARN&&$u.warn(`Auth (${Ko}): ${n}`,...e)}function Cu(n,...e){$u.logLevel<=yt.ERROR&&$u.error(`Auth (${Ko}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gs(n,...e){throw fp(n,...e)}function As(n,...e){return fp(n,...e)}function hp(n,e,t){const s=Object.assign(Object.assign({},ES()),{[e]:t});return new sc("auth","Firebase",s).create(e,{appName:n.name})}function mi(n){return hp(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function e0(n,e,t){const s=t;if(!(e instanceof s))throw s.name!==e.constructor.name&&gs(n,"argument-error"),hp(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function fp(n,...e){if(typeof n!="string"){const t=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=n.name),n._errorFactory.create(t,...s)}return Z_.create(n,...e)}function tt(n,e,...t){if(!n)throw fp(e,...t)}function hi(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Cu(e),new Error(e)}function vi(n,e){n||hi(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Af(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function SS(){return By()==="http:"||By()==="https:"}function By(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bS(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(SS()||Z1()||"connection"in navigator)?navigator.onLine:!0}function CS(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ac{constructor(e,t){this.shortDelay=e,this.longDelay=t,vi(t>e,"Short delay should be less than long delay!"),this.isMobile=Y1()||eT()}get(){return bS()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pp(n,e){vi(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t0{static initialize(e,t,s){this.fetchImpl=e,t&&(this.headersImpl=t),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;hi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;hi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;hi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IS={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NS=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],PS=new ac(3e4,6e4);function ha(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function Js(n,e,t,s,a={}){return n0(n,a,async()=>{let l={},d={};s&&(e==="GET"?d=s:l={body:JSON.stringify(s)});const f=ic(Object.assign({key:n.config.apiKey},d)).slice(1),m=await n._getAdditionalHeaders();m["Content-Type"]="application/json",n.languageCode&&(m["X-Firebase-Locale"]=n.languageCode);const y=Object.assign({method:e,headers:m},l);return X1()||(y.referrerPolicy="no-referrer"),n.emulatorConfig&&Ho(n.emulatorConfig.host)&&(y.credentials="include"),t0.fetch()(await r0(n,n.config.apiHost,t,f),y)})}async function n0(n,e,t){n._canInitEmulator=!1;const s=Object.assign(Object.assign({},IS),e);try{const a=new AS(n),l=await Promise.race([t(),a.promise]);a.clearNetworkTimeout();const d=await l.json();if("needConfirmation"in d)throw vu(n,"account-exists-with-different-credential",d);if(l.ok&&!("errorMessage"in d))return d;{const f=l.ok?d.errorMessage:d.error.message,[m,y]=f.split(" : ");if(m==="FEDERATED_USER_ID_ALREADY_LINKED")throw vu(n,"credential-already-in-use",d);if(m==="EMAIL_EXISTS")throw vu(n,"email-already-in-use",d);if(m==="USER_DISABLED")throw vu(n,"user-disabled",d);const x=s[m]||m.toLowerCase().replace(/[_\s]+/g,"-");if(y)throw hp(n,x,y);gs(n,x)}}catch(a){if(a instanceof Si)throw a;gs(n,"network-request-failed",{message:String(a)})}}async function oc(n,e,t,s,a={}){const l=await Js(n,e,t,s,a);return"mfaPendingCredential"in l&&gs(n,"multi-factor-auth-required",{_serverResponse:l}),l}async function r0(n,e,t,s){const a=`${e}${t}?${s}`,l=n,d=l.config.emulator?pp(n.config,a):`${n.config.apiScheme}://${a}`;return NS.includes(t)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(d).toString():d}function RS(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class AS{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,s)=>{this.timer=setTimeout(()=>s(As(this.auth,"network-request-failed")),PS.get())})}}function vu(n,e,t){const s={appName:n.name};t.email&&(s.email=t.email),t.phoneNumber&&(s.phoneNumber=t.phoneNumber);const a=As(n,e,s);return a.customData._tokenResponse=t,a}function Wy(n){return n!==void 0&&n.enterprise!==void 0}class jS{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return RS(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function kS(n,e){return Js(n,"GET","/v2/recaptchaConfig",ha(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DS(n,e){return Js(n,"POST","/v1/accounts:delete",e)}async function VS(n,e){return Js(n,"POST","/v1/accounts:update",e)}async function Bu(n,e){return Js(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ol(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function LS(n,e=!1){const t=rn(n),s=await t.getIdToken(e),a=mp(s);tt(a&&a.exp&&a.auth_time&&a.iat,t.auth,"internal-error");const l=typeof a.firebase=="object"?a.firebase:void 0,d=l==null?void 0:l.sign_in_provider;return{claims:a,token:s,authTime:Ol(hf(a.auth_time)),issuedAtTime:Ol(hf(a.iat)),expirationTime:Ol(hf(a.exp)),signInProvider:d||null,signInSecondFactor:(l==null?void 0:l.sign_in_second_factor)||null}}function hf(n){return Number(n)*1e3}function mp(n){const[e,t,s]=n.split(".");if(e===void 0||t===void 0||s===void 0)return Cu("JWT malformed, contained fewer than 3 sections"),null;try{const a=U_(t);return a?JSON.parse(a):(Cu("Failed to decode base64 JWT payload"),null)}catch(a){return Cu("Caught error parsing JWT payload as JSON",a==null?void 0:a.toString()),null}}function Gy(n){const e=mp(n);return tt(e,"internal-error"),tt(typeof e.exp<"u","internal-error"),tt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Oo(n,e,t=!1){if(t)return e;try{return await e}catch(s){throw s instanceof Si&&MS(s)&&n.auth.currentUser===n&&await n.auth.signOut(),s}}function MS({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OS{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const s=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),s}else{this.errorBackoff=3e4;const a=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,a)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jf{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ol(this.lastLoginAt),this.creationTime=Ol(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Hl(n){var e;const t=n.auth,s=await n.getIdToken(),a=await Oo(n,Bu(t,{idToken:s}));tt(a==null?void 0:a.users.length,t,"internal-error");const l=a.users[0];n._notifyReloadListener(l);const d=!((e=l.providerUserInfo)===null||e===void 0)&&e.length?s0(l.providerUserInfo):[],f=US(n.providerData,d),m=n.isAnonymous,y=!(n.email&&l.passwordHash)&&!(f!=null&&f.length),x=m?y:!1,E={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:f,metadata:new jf(l.createdAt,l.lastLoginAt),isAnonymous:x};Object.assign(n,E)}async function FS(n){const e=rn(n);await Hl(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function US(n,e){return[...n.filter(s=>!e.some(a=>a.providerId===s.providerId)),...e]}function s0(n){return n.map(e=>{var{providerId:t}=e,s=dp(e,["providerId"]);return{providerId:t,uid:s.rawId||"",displayName:s.displayName||null,email:s.email||null,phoneNumber:s.phoneNumber||null,photoURL:s.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zS(n,e){const t=await n0(n,{},async()=>{const s=ic({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:l}=n.config,d=await r0(n,a,"/v1/token",`key=${l}`),f=await n._getAdditionalHeaders();f["Content-Type"]="application/x-www-form-urlencoded";const m={method:"POST",headers:f,body:s};return n.emulatorConfig&&Ho(n.emulatorConfig.host)&&(m.credentials="include"),t0.fetch()(d,m)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function $S(n,e){return Js(n,"POST","/v2/accounts:revokeToken",ha(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ko{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){tt(e.idToken,"internal-error"),tt(typeof e.idToken<"u","internal-error"),tt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Gy(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){tt(e.length!==0,"internal-error");const t=Gy(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(tt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:s,refreshToken:a,expiresIn:l}=await zS(e,t);this.updateTokensAndExpiration(s,a,Number(l))}updateTokensAndExpiration(e,t,s){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,t){const{refreshToken:s,accessToken:a,expirationTime:l}=t,d=new ko;return s&&(tt(typeof s=="string","internal-error",{appName:e}),d.refreshToken=s),a&&(tt(typeof a=="string","internal-error",{appName:e}),d.accessToken=a),l&&(tt(typeof l=="number","internal-error",{appName:e}),d.expirationTime=l),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ko,this.toJSON())}_performRefresh(){return hi("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wi(n,e){tt(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Rs{constructor(e){var{uid:t,auth:s,stsTokenManager:a}=e,l=dp(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new OS(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=s,this.stsTokenManager=a,this.accessToken=a.accessToken,this.displayName=l.displayName||null,this.email=l.email||null,this.emailVerified=l.emailVerified||!1,this.phoneNumber=l.phoneNumber||null,this.photoURL=l.photoURL||null,this.isAnonymous=l.isAnonymous||!1,this.tenantId=l.tenantId||null,this.providerData=l.providerData?[...l.providerData]:[],this.metadata=new jf(l.createdAt||void 0,l.lastLoginAt||void 0)}async getIdToken(e){const t=await Oo(this,this.stsTokenManager.getToken(this.auth,e));return tt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return LS(this,e)}reload(){return FS(this)}_assign(e){this!==e&&(tt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Rs(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){tt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),t&&await Hl(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(zr(this.auth.app))return Promise.reject(mi(this.auth));const e=await this.getIdToken();return await Oo(this,DS(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var s,a,l,d,f,m,y,x;const E=(s=t.displayName)!==null&&s!==void 0?s:void 0,C=(a=t.email)!==null&&a!==void 0?a:void 0,O=(l=t.phoneNumber)!==null&&l!==void 0?l:void 0,X=(d=t.photoURL)!==null&&d!==void 0?d:void 0,B=(f=t.tenantId)!==null&&f!==void 0?f:void 0,U=(m=t._redirectEventId)!==null&&m!==void 0?m:void 0,se=(y=t.createdAt)!==null&&y!==void 0?y:void 0,we=(x=t.lastLoginAt)!==null&&x!==void 0?x:void 0,{uid:_e,emailVerified:ve,isAnonymous:L,providerData:ie,stsTokenManager:I}=t;tt(_e&&I,e,"internal-error");const N=ko.fromJSON(this.name,I);tt(typeof _e=="string",e,"internal-error"),Wi(E,e.name),Wi(C,e.name),tt(typeof ve=="boolean",e,"internal-error"),tt(typeof L=="boolean",e,"internal-error"),Wi(O,e.name),Wi(X,e.name),Wi(B,e.name),Wi(U,e.name),Wi(se,e.name),Wi(we,e.name);const A=new Rs({uid:_e,auth:e,email:C,emailVerified:ve,displayName:E,isAnonymous:L,photoURL:X,phoneNumber:O,tenantId:B,stsTokenManager:N,createdAt:se,lastLoginAt:we});return ie&&Array.isArray(ie)&&(A.providerData=ie.map(M=>Object.assign({},M))),U&&(A._redirectEventId=U),A}static async _fromIdTokenResponse(e,t,s=!1){const a=new ko;a.updateFromServerResponse(t);const l=new Rs({uid:t.localId,auth:e,stsTokenManager:a,isAnonymous:s});return await Hl(l),l}static async _fromGetAccountInfoResponse(e,t,s){const a=t.users[0];tt(a.localId!==void 0,"internal-error");const l=a.providerUserInfo!==void 0?s0(a.providerUserInfo):[],d=!(a.email&&a.passwordHash)&&!(l!=null&&l.length),f=new ko;f.updateFromIdToken(s);const m=new Rs({uid:a.localId,auth:e,stsTokenManager:f,isAnonymous:d}),y={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new jf(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!(l!=null&&l.length)};return Object.assign(m,y),m}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qy=new Map;function fi(n){vi(n instanceof Function,"Expected a class definition");let e=qy.get(n);return e?(vi(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,qy.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i0{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}i0.type="NONE";const Hy=i0;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iu(n,e,t){return`firebase:${n}:${e}:${t}`}class Do{constructor(e,t,s){this.persistence=e,this.auth=t,this.userKey=s;const{config:a,name:l}=this.auth;this.fullUserKey=Iu(this.userKey,a.apiKey,l),this.fullPersistenceKey=Iu("persistence",a.apiKey,l),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Bu(this.auth,{idToken:e}).catch(()=>{});return t?Rs._fromGetAccountInfoResponse(this.auth,t,e):null}return Rs._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,s="authUser"){if(!t.length)return new Do(fi(Hy),e,s);const a=(await Promise.all(t.map(async y=>{if(await y._isAvailable())return y}))).filter(y=>y);let l=a[0]||fi(Hy);const d=Iu(s,e.config.apiKey,e.name);let f=null;for(const y of t)try{const x=await y._get(d);if(x){let E;if(typeof x=="string"){const C=await Bu(e,{idToken:x}).catch(()=>{});if(!C)break;E=await Rs._fromGetAccountInfoResponse(e,C,x)}else E=Rs._fromJSON(e,x);y!==l&&(f=E),l=y;break}}catch{}const m=a.filter(y=>y._shouldAllowMigration);return!l._shouldAllowMigration||!m.length?new Do(l,e,s):(l=m[0],f&&await l._set(d,f.toJSON()),await Promise.all(t.map(async y=>{if(y!==l)try{await y._remove(d)}catch{}})),new Do(l,e,s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ky(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(c0(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(a0(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(d0(e))return"Blackberry";if(h0(e))return"Webos";if(o0(e))return"Safari";if((e.includes("chrome/")||l0(e))&&!e.includes("edge/"))return"Chrome";if(u0(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=n.match(t);if((s==null?void 0:s.length)===2)return s[1]}return"Other"}function a0(n=lr()){return/firefox\//i.test(n)}function o0(n=lr()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function l0(n=lr()){return/crios\//i.test(n)}function c0(n=lr()){return/iemobile/i.test(n)}function u0(n=lr()){return/android/i.test(n)}function d0(n=lr()){return/blackberry/i.test(n)}function h0(n=lr()){return/webos/i.test(n)}function gp(n=lr()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function BS(n=lr()){var e;return gp(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function WS(){return tT()&&document.documentMode===10}function f0(n=lr()){return gp(n)||u0(n)||h0(n)||d0(n)||/windows phone/i.test(n)||c0(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p0(n,e=[]){let t;switch(n){case"Browser":t=Ky(lr());break;case"Worker":t=`${Ky(lr())}-${n}`;break;default:t=n}const s=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Ko}/${s}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GS{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const s=l=>new Promise((d,f)=>{try{const m=e(l);d(m)}catch(m){f(m)}});s.onAbort=t,this.queue.push(s);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const s of this.queue)await s(e),s.onAbort&&t.push(s.onAbort)}catch(s){t.reverse();for(const a of t)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s==null?void 0:s.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qS(n,e={}){return Js(n,"GET","/v2/passwordPolicy",ha(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HS=6;class KS{constructor(e){var t,s,a,l;const d=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=d.minPasswordLength)!==null&&t!==void 0?t:HS,d.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=d.maxPasswordLength),d.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=d.containsLowercaseCharacter),d.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=d.containsUppercaseCharacter),d.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=d.containsNumericCharacter),d.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=d.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(a=(s=e.allowedNonAlphanumericCharacters)===null||s===void 0?void 0:s.join(""))!==null&&a!==void 0?a:"",this.forceUpgradeOnSignin=(l=e.forceUpgradeOnSignin)!==null&&l!==void 0?l:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,s,a,l,d,f;const m={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,m),this.validatePasswordCharacterOptions(e,m),m.isValid&&(m.isValid=(t=m.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),m.isValid&&(m.isValid=(s=m.meetsMaxPasswordLength)!==null&&s!==void 0?s:!0),m.isValid&&(m.isValid=(a=m.containsLowercaseLetter)!==null&&a!==void 0?a:!0),m.isValid&&(m.isValid=(l=m.containsUppercaseLetter)!==null&&l!==void 0?l:!0),m.isValid&&(m.isValid=(d=m.containsNumericCharacter)!==null&&d!==void 0?d:!0),m.isValid&&(m.isValid=(f=m.containsNonAlphanumericCharacter)!==null&&f!==void 0?f:!0),m}validatePasswordLengthOptions(e,t){const s=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;s&&(t.meetsMinPasswordLength=e.length>=s),a&&(t.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let s;for(let a=0;a<e.length;a++)s=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(t,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,t,s,a,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QS{constructor(e,t,s,a){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=s,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Qy(this),this.idTokenSubscription=new Qy(this),this.beforeStateQueue=new GS(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Z_,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=fi(t)),this._initializationPromise=this.queue(async()=>{var s,a,l;if(!this._deleted&&(this.persistenceManager=await Do.create(this,e),(s=this._resolvePersistenceManagerAvailable)===null||s===void 0||s.call(this),!this._deleted)){if(!((a=this._popupRedirectResolver)===null||a===void 0)&&a._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((l=this.currentUser)===null||l===void 0?void 0:l.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Bu(this,{idToken:e}),s=await Rs._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(s)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(zr(this.app)){const d=this.app.settings.authIdToken;return d?new Promise(f=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(d).then(f,f))}):this.directlySetCurrentUser(null)}const s=await this.assertedPersistence.getCurrentUser();let a=s,l=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const d=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,f=a==null?void 0:a._redirectEventId,m=await this.tryRedirectSignIn(e);(!d||d===f)&&(m!=null&&m.user)&&(a=m.user,l=!0)}if(!a)return this.directlySetCurrentUser(null);if(!a._redirectEventId){if(l)try{await this.beforeStateQueue.runMiddleware(a)}catch(d){a=s,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(d))}return a?this.reloadAndSetCurrentUserOrClear(a):this.directlySetCurrentUser(null)}return tt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===a._redirectEventId?this.directlySetCurrentUser(a):this.reloadAndSetCurrentUserOrClear(a)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Hl(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=CS()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(zr(this.app))return Promise.reject(mi(this));const t=e?rn(e):null;return t&&tt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&tt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return zr(this.app)?Promise.reject(mi(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return zr(this.app)?Promise.reject(mi(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(fi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await qS(this),t=new KS(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new sc("auth","Firebase",e())}onAuthStateChanged(e,t,s){return this.registerStateListener(this.authStateSubscription,e,t,s)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,s){return this.registerStateListener(this.idTokenSubscription,e,t,s)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(s.tenantId=this.tenantId),await $S(this,s)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const s=await this.getOrInitRedirectPersistenceManager(t);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&fi(e)||this._popupRedirectResolver;tt(t,this,"argument-error"),this.redirectPersistenceManager=await Do.create(this,[fi(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,s;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((s=this.redirectUser)===null||s===void 0?void 0:s._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const s=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==s&&(this.lastNotifiedUid=s,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,s,a){if(this._deleted)return()=>{};const l=typeof t=="function"?t:t.next.bind(t);let d=!1;const f=this._isInitialized?Promise.resolve():this._initializationPromise;if(tt(f,this,"internal-error"),f.then(()=>{d||l(this.currentUser)}),typeof t=="function"){const m=e.addObserver(t,s,a);return()=>{d=!0,m()}}else{const m=e.addObserver(t);return()=>{d=!0,m()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return tt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=p0(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const s=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());s&&(t["X-Firebase-Client"]=s);const a=await this._getAppCheckToken();return a&&(t["X-Firebase-AppCheck"]=a),t}async _getAppCheckToken(){var e;if(zr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&TS(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function fa(n){return rn(n)}class Qy{constructor(e){this.auth=e,this.observer=null,this.addObserver=cT(t=>this.observer=t)}get next(){return tt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ld={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function YS(n){ld=n}function m0(n){return ld.loadJS(n)}function JS(){return ld.recaptchaEnterpriseScript}function XS(){return ld.gapiScript}function ZS(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class eb{constructor(){this.enterprise=new tb}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class tb{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const nb="recaptcha-enterprise",g0="NO_RECAPTCHA";class rb{constructor(e){this.type=nb,this.auth=fa(e)}async verify(e="verify",t=!1){async function s(l){if(!t){if(l.tenantId==null&&l._agentRecaptchaConfig!=null)return l._agentRecaptchaConfig.siteKey;if(l.tenantId!=null&&l._tenantRecaptchaConfigs[l.tenantId]!==void 0)return l._tenantRecaptchaConfigs[l.tenantId].siteKey}return new Promise(async(d,f)=>{kS(l,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(m=>{if(m.recaptchaKey===void 0)f(new Error("recaptcha Enterprise site key undefined"));else{const y=new jS(m);return l.tenantId==null?l._agentRecaptchaConfig=y:l._tenantRecaptchaConfigs[l.tenantId]=y,d(y.siteKey)}}).catch(m=>{f(m)})})}function a(l,d,f){const m=window.grecaptcha;Wy(m)?m.enterprise.ready(()=>{m.enterprise.execute(l,{action:e}).then(y=>{d(y)}).catch(()=>{d(g0)})}):f(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new eb().execute("siteKey",{action:"verify"}):new Promise((l,d)=>{s(this.auth).then(f=>{if(!t&&Wy(window.grecaptcha))a(f,l,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let m=JS();m.length!==0&&(m+=f),m0(m).then(()=>{a(f,l,d)}).catch(y=>{d(y)})}}).catch(f=>{d(f)})})}}async function Yy(n,e,t,s=!1,a=!1){const l=new rb(n);let d;if(a)d=g0;else try{d=await l.verify(t)}catch{d=await l.verify(t,!0)}const f=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in f){const m=f.phoneEnrollmentInfo.phoneNumber,y=f.phoneEnrollmentInfo.recaptchaToken;Object.assign(f,{phoneEnrollmentInfo:{phoneNumber:m,recaptchaToken:y,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in f){const m=f.phoneSignInInfo.recaptchaToken;Object.assign(f,{phoneSignInInfo:{recaptchaToken:m,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return f}return s?Object.assign(f,{captchaResp:d}):Object.assign(f,{captchaResponse:d}),Object.assign(f,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(f,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),f}async function kf(n,e,t,s,a){var l;if(!((l=n._getRecaptchaConfig())===null||l===void 0)&&l.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const d=await Yy(n,e,t,t==="getOobCode");return s(n,d)}else return s(n,e).catch(async d=>{if(d.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const f=await Yy(n,e,t,t==="getOobCode");return s(n,f)}else return Promise.reject(d)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sb(n,e){const t=up(n,"auth");if(t.isInitialized()){const a=t.getImmediate(),l=t.getOptions();if($a(l,e??{}))return a;gs(a,"already-initialized")}return t.initialize({options:e})}function ib(n,e){const t=(e==null?void 0:e.persistence)||[],s=(Array.isArray(t)?t:[t]).map(fi);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(s,e==null?void 0:e.popupRedirectResolver)}function ab(n,e,t){const s=fa(n);tt(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const a=!1,l=y0(e),{host:d,port:f}=ob(e),m=f===null?"":`:${f}`,y={url:`${l}//${d}${m}/`},x=Object.freeze({host:d,port:f,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!s._canInitEmulator){tt(s.config.emulator&&s.emulatorConfig,s,"emulator-config-failed"),tt($a(y,s.config.emulator)&&$a(x,s.emulatorConfig),s,"emulator-config-failed");return}s.config.emulator=y,s.emulatorConfig=x,s.settings.appVerificationDisabledForTesting=!0,Ho(d)?(W_(`${l}//${d}${m}`),G_("Auth",!0)):lb()}function y0(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function ob(n){const e=y0(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const s=t[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(s);if(a){const l=a[1];return{host:l,port:Jy(s.substr(l.length+1))}}else{const[l,d]=s.split(":");return{host:l,port:Jy(d)}}}function Jy(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function lb(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yp{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return hi("not implemented")}_getIdTokenResponse(e){return hi("not implemented")}_linkToIdToken(e,t){return hi("not implemented")}_getReauthenticationResolver(e){return hi("not implemented")}}async function cb(n,e){return Js(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ub(n,e){return oc(n,"POST","/v1/accounts:signInWithPassword",ha(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function db(n,e){return oc(n,"POST","/v1/accounts:signInWithEmailLink",ha(n,e))}async function hb(n,e){return oc(n,"POST","/v1/accounts:signInWithEmailLink",ha(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kl extends yp{constructor(e,t,s,a=null){super("password",s),this._email=e,this._password=t,this._tenantId=a}static _fromEmailAndPassword(e,t){return new Kl(e,t,"password")}static _fromEmailAndCode(e,t,s=null){return new Kl(e,t,"emailLink",s)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return kf(e,t,"signInWithPassword",ub);case"emailLink":return db(e,{email:this._email,oobCode:this._password});default:gs(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const s={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return kf(e,s,"signUpPassword",cb);case"emailLink":return hb(e,{idToken:t,email:this._email,oobCode:this._password});default:gs(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vo(n,e){return oc(n,"POST","/v1/accounts:signInWithIdp",ha(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fb="http://localhost";class _i extends yp{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new _i(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):gs("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:a}=t,l=dp(t,["providerId","signInMethod"]);if(!s||!a)return null;const d=new _i(s,a);return d.idToken=l.idToken||void 0,d.accessToken=l.accessToken||void 0,d.secret=l.secret,d.nonce=l.nonce,d.pendingToken=l.pendingToken||null,d}_getIdTokenResponse(e){const t=this.buildRequest();return Vo(e,t)}_linkToIdToken(e,t){const s=this.buildRequest();return s.idToken=t,Vo(e,s)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Vo(e,t)}buildRequest(){const e={requestUri:fb,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=ic(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pb(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function mb(n){const e=Al(jl(n)).link,t=e?Al(jl(e)).deep_link_id:null,s=Al(jl(n)).deep_link_id;return(s?Al(jl(s)).link:null)||s||t||e||n}class vp{constructor(e){var t,s,a,l,d,f;const m=Al(jl(e)),y=(t=m.apiKey)!==null&&t!==void 0?t:null,x=(s=m.oobCode)!==null&&s!==void 0?s:null,E=pb((a=m.mode)!==null&&a!==void 0?a:null);tt(y&&x&&E,"argument-error"),this.apiKey=y,this.operation=E,this.code=x,this.continueUrl=(l=m.continueUrl)!==null&&l!==void 0?l:null,this.languageCode=(d=m.lang)!==null&&d!==void 0?d:null,this.tenantId=(f=m.tenantId)!==null&&f!==void 0?f:null}static parseLink(e){const t=mb(e);try{return new vp(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qo{constructor(){this.providerId=Qo.PROVIDER_ID}static credential(e,t){return Kl._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const s=vp.parseLink(t);return tt(s,"argument-error"),Kl._fromEmailAndCode(e,s.code,s.tenantId)}}Qo.PROVIDER_ID="password";Qo.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Qo.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cd{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yo extends cd{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Fl extends Yo{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return tt("providerId"in t&&"signInMethod"in t,"argument-error"),_i._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return tt(e.idToken||e.accessToken,"argument-error"),_i._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return Fl.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return Fl.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:s,oauthTokenSecret:a,pendingToken:l,nonce:d,providerId:f}=e;if(!s&&!a&&!t&&!l||!f)return null;try{return new Fl(f)._credential({idToken:t,accessToken:s,nonce:d,pendingToken:l})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gi extends Yo{constructor(){super("facebook.com")}static credential(e){return _i._fromParams({providerId:Gi.PROVIDER_ID,signInMethod:Gi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Gi.credentialFromTaggedObject(e)}static credentialFromError(e){return Gi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Gi.credential(e.oauthAccessToken)}catch{return null}}}Gi.FACEBOOK_SIGN_IN_METHOD="facebook.com";Gi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Is extends Yo{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return _i._fromParams({providerId:Is.PROVIDER_ID,signInMethod:Is.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Is.credentialFromTaggedObject(e)}static credentialFromError(e){return Is.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:s}=e;if(!t&&!s)return null;try{return Is.credential(t,s)}catch{return null}}}Is.GOOGLE_SIGN_IN_METHOD="google.com";Is.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qi extends Yo{constructor(){super("github.com")}static credential(e){return _i._fromParams({providerId:qi.PROVIDER_ID,signInMethod:qi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return qi.credentialFromTaggedObject(e)}static credentialFromError(e){return qi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return qi.credential(e.oauthAccessToken)}catch{return null}}}qi.GITHUB_SIGN_IN_METHOD="github.com";qi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hi extends Yo{constructor(){super("twitter.com")}static credential(e,t){return _i._fromParams({providerId:Hi.PROVIDER_ID,signInMethod:Hi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Hi.credentialFromTaggedObject(e)}static credentialFromError(e){return Hi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:s}=e;if(!t||!s)return null;try{return Hi.credential(t,s)}catch{return null}}}Hi.TWITTER_SIGN_IN_METHOD="twitter.com";Hi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gb(n,e){return oc(n,"POST","/v1/accounts:signUp",ha(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wa{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,s,a=!1){const l=await Rs._fromIdTokenResponse(e,s,a),d=Xy(s);return new Wa({user:l,providerId:d,_tokenResponse:s,operationType:t})}static async _forOperation(e,t,s){await e._updateTokensIfNecessary(s,!0);const a=Xy(s);return new Wa({user:e,providerId:a,_tokenResponse:s,operationType:t})}}function Xy(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wu extends Si{constructor(e,t,s,a){var l;super(t.code,t.message),this.operationType=s,this.user=a,Object.setPrototypeOf(this,Wu.prototype),this.customData={appName:e.name,tenantId:(l=e.tenantId)!==null&&l!==void 0?l:void 0,_serverResponse:t.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,t,s,a){return new Wu(e,t,s,a)}}function v0(n,e,t,s){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?Wu._fromErrorAndOperation(n,l,e,s):l})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _0(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yb(n,e){const t=rn(n);await _b(!0,t,e);const{providerUserInfo:s}=await VS(t.auth,{idToken:await t.getIdToken(),deleteProvider:[e]}),a=_0(s||[]);return t.providerData=t.providerData.filter(l=>a.has(l.providerId)),a.has("phone")||(t.phoneNumber=null),await t.auth._persistUserIfCurrent(t),t}async function vb(n,e,t=!1){const s=await Oo(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Wa._forOperation(n,"link",s)}async function _b(n,e,t){await Hl(e);const s=_0(e.providerData);tt(s.has(t)===n,e.auth,"no-such-provider")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xb(n,e,t=!1){const{auth:s}=n;if(zr(s.app))return Promise.reject(mi(s));const a="reauthenticate";try{const l=await Oo(n,v0(s,a,e,n),t);tt(l.idToken,s,"internal-error");const d=mp(l.idToken);tt(d,s,"internal-error");const{sub:f}=d;return tt(n.uid===f,s,"user-mismatch"),Wa._forOperation(n,a,l)}catch(l){throw(l==null?void 0:l.code)==="auth/user-not-found"&&gs(s,"user-mismatch"),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function x0(n,e,t=!1){if(zr(n.app))return Promise.reject(mi(n));const s="signIn",a=await v0(n,s,e),l=await Wa._fromIdTokenResponse(n,s,a);return t||await n._updateCurrentUser(l.user),l}async function wb(n,e){return x0(fa(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function w0(n){const e=fa(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function Eb(n,e,t){if(zr(n.app))return Promise.reject(mi(n));const s=fa(n),d=await kf(s,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",gb).catch(m=>{throw m.code==="auth/password-does-not-meet-requirements"&&w0(n),m}),f=await Wa._fromIdTokenResponse(s,"signIn",d);return await s._updateCurrentUser(f.user),f}function E0(n,e,t){return zr(n.app)?Promise.reject(mi(n)):wb(rn(n),Qo.credential(e,t)).catch(async s=>{throw s.code==="auth/password-does-not-meet-requirements"&&w0(n),s})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Tb(n,e){return Js(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Sb(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const s=rn(n),l={idToken:await s.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},d=await Oo(s,Tb(s.auth,l));s.displayName=d.displayName||null,s.photoURL=d.photoUrl||null;const f=s.providerData.find(({providerId:m})=>m==="password");f&&(f.displayName=s.displayName,f.photoURL=s.photoURL),await s._updateTokensIfNecessary(d)}function bb(n,e,t,s){return rn(n).onIdTokenChanged(e,t,s)}function Cb(n,e,t){return rn(n).beforeAuthStateChanged(e,t)}function Ib(n,e,t,s){return rn(n).onAuthStateChanged(e,t,s)}function T0(n){return rn(n).signOut()}const Gu="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S0{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Gu,"1"),this.storage.removeItem(Gu),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nb=1e3,Pb=10;class b0 extends S0{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=f0(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const s=this.storage.getItem(t),a=this.localCache[t];s!==a&&e(t,a,s)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((d,f,m)=>{this.notifyListeners(d,m)});return}const s=e.key;t?this.detachListener():this.stopPolling();const a=()=>{const d=this.storage.getItem(s);!t&&this.localCache[s]===d||this.notifyListeners(s,d)},l=this.storage.getItem(s);WS()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,Pb):a()}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const a of Array.from(s))a(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:s}),!0)})},Nb)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}b0.type="LOCAL";const Rb=b0;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C0 extends S0{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}C0.type="SESSION";const I0=C0;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ab(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ud{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(a=>a.isListeningto(e));if(t)return t;const s=new ud(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:s,eventType:a,data:l}=t.data,d=this.handlersMap[a];if(!(d!=null&&d.size))return;t.ports[0].postMessage({status:"ack",eventId:s,eventType:a});const f=Array.from(d).map(async y=>y(t.origin,l)),m=await Ab(f);t.ports[0].postMessage({status:"done",eventId:s,eventType:a,response:m})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}ud.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _p(n="",e=10){let t="";for(let s=0;s<e;s++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jb{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,s=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let l,d;return new Promise((f,m)=>{const y=_p("",20);a.port1.start();const x=setTimeout(()=>{m(new Error("unsupported_event"))},s);d={messageChannel:a,onMessage(E){const C=E;if(C.data.eventId===y)switch(C.data.status){case"ack":clearTimeout(x),l=setTimeout(()=>{m(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),f(C.data.response);break;default:clearTimeout(x),clearTimeout(l),m(new Error("invalid_response"));break}}},this.handlers.add(d),a.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:y,data:t},[a.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gs(){return window}function kb(n){Gs().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N0(){return typeof Gs().WorkerGlobalScope<"u"&&typeof Gs().importScripts=="function"}async function Db(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Vb(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function Lb(){return N0()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P0="firebaseLocalStorageDb",Mb=1,qu="firebaseLocalStorage",R0="fbase_key";class lc{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function dd(n,e){return n.transaction([qu],e?"readwrite":"readonly").objectStore(qu)}function Ob(){const n=indexedDB.deleteDatabase(P0);return new lc(n).toPromise()}function Df(){const n=indexedDB.open(P0,Mb);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const s=n.result;try{s.createObjectStore(qu,{keyPath:R0})}catch(a){t(a)}}),n.addEventListener("success",async()=>{const s=n.result;s.objectStoreNames.contains(qu)?e(s):(s.close(),await Ob(),e(await Df()))})})}async function Zy(n,e,t){const s=dd(n,!0).put({[R0]:e,value:t});return new lc(s).toPromise()}async function Fb(n,e){const t=dd(n,!1).get(e),s=await new lc(t).toPromise();return s===void 0?null:s.value}function ev(n,e){const t=dd(n,!0).delete(e);return new lc(t).toPromise()}const Ub=800,zb=3;class A0{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Df(),this.db)}async _withRetries(e){let t=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(t++>zb)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return N0()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ud._getInstance(Lb()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await Db(),!this.activeServiceWorker)return;this.sender=new jb(this.activeServiceWorker);const s=await this.sender._send("ping",{},800);s&&!((e=s[0])===null||e===void 0)&&e.fulfilled&&!((t=s[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Vb()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Df();return await Zy(e,Gu,"1"),await ev(e,Gu),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(s=>Zy(s,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(s=>Fb(s,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>ev(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const l=dd(a,!1).getAll();return new lc(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],s=new Set;if(e.length!==0)for(const{fbase_key:a,value:l}of e)s.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(l)&&(this.notifyListeners(a,l),t.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!s.has(a)&&(this.notifyListeners(a,null),t.push(a));return t}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const a of Array.from(s))a(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Ub)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}A0.type="LOCAL";const $b=A0;new ac(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xp(n,e){return e?fi(e):(tt(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wp extends yp{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Vo(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Vo(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Vo(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Bb(n){return x0(n.auth,new wp(n),n.bypassAuthState)}function Wb(n){const{auth:e,user:t}=n;return tt(t,e,"internal-error"),xb(t,new wp(n),n.bypassAuthState)}async function Gb(n){const{auth:e,user:t}=n;return tt(t,e,"internal-error"),vb(t,new wp(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j0{constructor(e,t,s,a,l=!1){this.auth=e,this.resolver=s,this.user=a,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:s,postBody:a,tenantId:l,error:d,type:f}=e;if(d){this.reject(d);return}const m={auth:this.auth,requestUri:t,sessionId:s,tenantId:l||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(f)(m))}catch(y){this.reject(y)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Bb;case"linkViaPopup":case"linkViaRedirect":return Gb;case"reauthViaPopup":case"reauthViaRedirect":return Wb;default:gs(this.auth,"internal-error")}}resolve(e){vi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){vi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qb=new ac(2e3,1e4);async function k0(n,e,t){if(zr(n.app))return Promise.reject(As(n,"operation-not-supported-in-this-environment"));const s=fa(n);e0(n,e,cd);const a=xp(s,t);return new Qi(s,"signInViaPopup",e,a).executeNotNull()}async function tv(n,e,t){const s=rn(n);e0(s.auth,e,cd);const a=xp(s.auth,t);return new Qi(s.auth,"linkViaPopup",e,a,s).executeNotNull()}class Qi extends j0{constructor(e,t,s,a,l){super(e,t,a,l),this.provider=s,this.authWindow=null,this.pollId=null,Qi.currentPopupAction&&Qi.currentPopupAction.cancel(),Qi.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return tt(e,this.auth,"internal-error"),e}async onExecution(){vi(this.filter.length===1,"Popup operations only handle one event");const e=_p();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(As(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(As(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Qi.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,s;if(!((s=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||s===void 0)&&s.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(As(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,qb.get())};e()}}Qi.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hb="pendingRedirect",Nu=new Map;class Kb extends j0{constructor(e,t,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,s),this.eventId=null}async execute(){let e=Nu.get(this.auth._key());if(!e){try{const s=await Qb(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(t){e=()=>Promise.reject(t)}Nu.set(this.auth._key(),e)}return this.bypassAuthState||Nu.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Qb(n,e){const t=Xb(e),s=Jb(n);if(!await s._isAvailable())return!1;const a=await s._get(t)==="true";return await s._remove(t),a}function Yb(n,e){Nu.set(n._key(),e)}function Jb(n){return fi(n._redirectPersistence)}function Xb(n){return Iu(Hb,n.config.apiKey,n.name)}async function Zb(n,e,t=!1){if(zr(n.app))return Promise.reject(mi(n));const s=fa(n),a=xp(s,e),d=await new Kb(s,a,t).execute();return d&&!t&&(delete d.user._redirectEventId,await s._persistUserIfCurrent(d.user),await s._setRedirectUser(null,e)),d}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eC=600*1e3;class tC{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(t=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!nC(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var s;if(e.error&&!D0(e)){const a=((s=e.error.code)===null||s===void 0?void 0:s.split("auth/")[1])||"internal-error";t.onError(As(this.auth,a))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const s=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=eC&&this.cachedEventUids.clear(),this.cachedEventUids.has(nv(e))}saveEventToCache(e){this.cachedEventUids.add(nv(e)),this.lastProcessedEventTime=Date.now()}}function nv(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function D0({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function nC(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return D0(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rC(n,e={}){return Js(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sC=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,iC=/^https?/;async function aC(n){if(n.config.emulator)return;const{authorizedDomains:e}=await rC(n);for(const t of e)try{if(oC(t))return}catch{}gs(n,"unauthorized-domain")}function oC(n){const e=Af(),{protocol:t,hostname:s}=new URL(e);if(n.startsWith("chrome-extension://")){const d=new URL(n);return d.hostname===""&&s===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&d.hostname===s}if(!iC.test(t))return!1;if(sC.test(n))return s===n;const a=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(s)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lC=new ac(3e4,6e4);function rv(){const n=Gs().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function cC(n){return new Promise((e,t)=>{var s,a,l;function d(){rv(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{rv(),t(As(n,"network-request-failed"))},timeout:lC.get()})}if(!((a=(s=Gs().gapi)===null||s===void 0?void 0:s.iframes)===null||a===void 0)&&a.Iframe)e(gapi.iframes.getContext());else if(!((l=Gs().gapi)===null||l===void 0)&&l.load)d();else{const f=ZS("iframefcb");return Gs()[f]=()=>{gapi.load?d():t(As(n,"network-request-failed"))},m0(`${XS()}?onload=${f}`).catch(m=>t(m))}}).catch(e=>{throw Pu=null,e})}let Pu=null;function uC(n){return Pu=Pu||cC(n),Pu}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dC=new ac(5e3,15e3),hC="__/auth/iframe",fC="emulator/auth/iframe",pC={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},mC=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function gC(n){const e=n.config;tt(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?pp(e,fC):`https://${n.config.authDomain}/${hC}`,s={apiKey:e.apiKey,appName:n.name,v:Ko},a=mC.get(n.config.apiHost);a&&(s.eid=a);const l=n._getFrameworks();return l.length&&(s.fw=l.join(",")),`${t}?${ic(s).slice(1)}`}async function yC(n){const e=await uC(n),t=Gs().gapi;return tt(t,n,"internal-error"),e.open({where:document.body,url:gC(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:pC,dontclear:!0},s=>new Promise(async(a,l)=>{await s.restyle({setHideOnLeave:!1});const d=As(n,"network-request-failed"),f=Gs().setTimeout(()=>{l(d)},dC.get());function m(){Gs().clearTimeout(f),a(s)}s.ping(m).then(m,()=>{l(d)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vC={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},_C=500,xC=600,wC="_blank",EC="http://localhost";class sv{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function TC(n,e,t,s=_C,a=xC){const l=Math.max((window.screen.availHeight-a)/2,0).toString(),d=Math.max((window.screen.availWidth-s)/2,0).toString();let f="";const m=Object.assign(Object.assign({},vC),{width:s.toString(),height:a.toString(),top:l,left:d}),y=lr().toLowerCase();t&&(f=l0(y)?wC:t),a0(y)&&(e=e||EC,m.scrollbars="yes");const x=Object.entries(m).reduce((C,[O,X])=>`${C}${O}=${X},`,"");if(BS(y)&&f!=="_self")return SC(e||"",f),new sv(null);const E=window.open(e||"",f,x);tt(E,n,"popup-blocked");try{E.focus()}catch{}return new sv(E)}function SC(n,e){const t=document.createElement("a");t.href=n,t.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bC="__/auth/handler",CC="emulator/auth/handler",IC=encodeURIComponent("fac");async function iv(n,e,t,s,a,l){tt(n.config.authDomain,n,"auth-domain-config-required"),tt(n.config.apiKey,n,"invalid-api-key");const d={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:s,v:Ko,eventId:a};if(e instanceof cd){e.setDefaultLanguage(n.languageCode),d.providerId=e.providerId||"",lT(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[x,E]of Object.entries({}))d[x]=E}if(e instanceof Yo){const x=e.getScopes().filter(E=>E!=="");x.length>0&&(d.scopes=x.join(","))}n.tenantId&&(d.tid=n.tenantId);const f=d;for(const x of Object.keys(f))f[x]===void 0&&delete f[x];const m=await n._getAppCheckToken(),y=m?`#${IC}=${encodeURIComponent(m)}`:"";return`${NC(n)}?${ic(f).slice(1)}${y}`}function NC({config:n}){return n.emulator?pp(n,CC):`https://${n.authDomain}/${bC}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ff="webStorageSupport";class PC{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=I0,this._completeRedirectFn=Zb,this._overrideRedirectResult=Yb}async _openPopup(e,t,s,a){var l;vi((l=this.eventManagers[e._key()])===null||l===void 0?void 0:l.manager,"_initialize() not called before _openPopup()");const d=await iv(e,t,s,Af(),a);return TC(e,d,_p())}async _openRedirect(e,t,s,a){await this._originValidation(e);const l=await iv(e,t,s,Af(),a);return kb(l),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:a,promise:l}=this.eventManagers[t];return a?Promise.resolve(a):(vi(l,"If manager is not set, promise should be"),l)}const s=this.initAndGetManager(e);return this.eventManagers[t]={promise:s},s.catch(()=>{delete this.eventManagers[t]}),s}async initAndGetManager(e){const t=await yC(e),s=new tC(e);return t.register("authEvent",a=>(tt(a==null?void 0:a.authEvent,e,"invalid-auth-event"),{status:s.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=t,s}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(ff,{type:ff},a=>{var l;const d=(l=a==null?void 0:a[0])===null||l===void 0?void 0:l[ff];d!==void 0&&t(!!d),gs(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=aC(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return f0()||o0()||gp()}}const RC=PC;var av="@firebase/auth",ov="1.10.8";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AC{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(s=>{e((s==null?void 0:s.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){tt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jC(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function kC(n){Mo(new Ba("auth",(e,{options:t})=>{const s=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:d,authDomain:f}=s.options;tt(d&&!d.includes(":"),"invalid-api-key",{appName:s.name});const m={apiKey:d,authDomain:f,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:p0(n)},y=new QS(s,a,l,m);return ib(y,t),y},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,s)=>{e.getProvider("auth-internal").initialize()})),Mo(new Ba("auth-internal",e=>{const t=fa(e.getProvider("auth").getImmediate());return(s=>new AC(s))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),ea(av,ov,jC(n)),ea(av,ov,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DC=300,VC=B_("authIdTokenMaxAge")||DC;let lv=null;const LC=n=>async e=>{const t=e&&await e.getIdTokenResult(),s=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(s&&s>VC)return;const a=t==null?void 0:t.token;lv!==a&&(lv=a,await fetch(n,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function MC(n=Q_()){const e=up(n,"auth");if(e.isInitialized())return e.getImmediate();const t=sb(n,{popupRedirectResolver:RC,persistence:[$b,Rb,I0]}),s=B_("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const l=new URL(s,location.origin);if(location.origin===l.origin){const d=LC(l.toString());Cb(t,d,()=>d(t.currentUser)),bb(t,f=>d(f))}}const a=z_("auth");return a&&ab(t,`http://${a}`),t}function OC(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}YS({loadJS(n){return new Promise((e,t)=>{const s=document.createElement("script");s.setAttribute("src",n),s.onload=e,s.onerror=a=>{const l=As("internal-error");l.customData=a,t(l)},s.type="text/javascript",s.charset="UTF-8",OC().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});kC("Browser");var cv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ta,V0;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(I,N){function A(){}A.prototype=N.prototype,I.D=N.prototype,I.prototype=new A,I.prototype.constructor=I,I.C=function(M,D,P){for(var b=Array(arguments.length-2),J=2;J<arguments.length;J++)b[J-2]=arguments[J];return N.prototype[D].apply(M,b)}}function t(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(s,t),s.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(I,N,A){A||(A=0);var M=Array(16);if(typeof N=="string")for(var D=0;16>D;++D)M[D]=N.charCodeAt(A++)|N.charCodeAt(A++)<<8|N.charCodeAt(A++)<<16|N.charCodeAt(A++)<<24;else for(D=0;16>D;++D)M[D]=N[A++]|N[A++]<<8|N[A++]<<16|N[A++]<<24;N=I.g[0],A=I.g[1],D=I.g[2];var P=I.g[3],b=N+(P^A&(D^P))+M[0]+3614090360&4294967295;N=A+(b<<7&4294967295|b>>>25),b=P+(D^N&(A^D))+M[1]+3905402710&4294967295,P=N+(b<<12&4294967295|b>>>20),b=D+(A^P&(N^A))+M[2]+606105819&4294967295,D=P+(b<<17&4294967295|b>>>15),b=A+(N^D&(P^N))+M[3]+3250441966&4294967295,A=D+(b<<22&4294967295|b>>>10),b=N+(P^A&(D^P))+M[4]+4118548399&4294967295,N=A+(b<<7&4294967295|b>>>25),b=P+(D^N&(A^D))+M[5]+1200080426&4294967295,P=N+(b<<12&4294967295|b>>>20),b=D+(A^P&(N^A))+M[6]+2821735955&4294967295,D=P+(b<<17&4294967295|b>>>15),b=A+(N^D&(P^N))+M[7]+4249261313&4294967295,A=D+(b<<22&4294967295|b>>>10),b=N+(P^A&(D^P))+M[8]+1770035416&4294967295,N=A+(b<<7&4294967295|b>>>25),b=P+(D^N&(A^D))+M[9]+2336552879&4294967295,P=N+(b<<12&4294967295|b>>>20),b=D+(A^P&(N^A))+M[10]+4294925233&4294967295,D=P+(b<<17&4294967295|b>>>15),b=A+(N^D&(P^N))+M[11]+2304563134&4294967295,A=D+(b<<22&4294967295|b>>>10),b=N+(P^A&(D^P))+M[12]+1804603682&4294967295,N=A+(b<<7&4294967295|b>>>25),b=P+(D^N&(A^D))+M[13]+4254626195&4294967295,P=N+(b<<12&4294967295|b>>>20),b=D+(A^P&(N^A))+M[14]+2792965006&4294967295,D=P+(b<<17&4294967295|b>>>15),b=A+(N^D&(P^N))+M[15]+1236535329&4294967295,A=D+(b<<22&4294967295|b>>>10),b=N+(D^P&(A^D))+M[1]+4129170786&4294967295,N=A+(b<<5&4294967295|b>>>27),b=P+(A^D&(N^A))+M[6]+3225465664&4294967295,P=N+(b<<9&4294967295|b>>>23),b=D+(N^A&(P^N))+M[11]+643717713&4294967295,D=P+(b<<14&4294967295|b>>>18),b=A+(P^N&(D^P))+M[0]+3921069994&4294967295,A=D+(b<<20&4294967295|b>>>12),b=N+(D^P&(A^D))+M[5]+3593408605&4294967295,N=A+(b<<5&4294967295|b>>>27),b=P+(A^D&(N^A))+M[10]+38016083&4294967295,P=N+(b<<9&4294967295|b>>>23),b=D+(N^A&(P^N))+M[15]+3634488961&4294967295,D=P+(b<<14&4294967295|b>>>18),b=A+(P^N&(D^P))+M[4]+3889429448&4294967295,A=D+(b<<20&4294967295|b>>>12),b=N+(D^P&(A^D))+M[9]+568446438&4294967295,N=A+(b<<5&4294967295|b>>>27),b=P+(A^D&(N^A))+M[14]+3275163606&4294967295,P=N+(b<<9&4294967295|b>>>23),b=D+(N^A&(P^N))+M[3]+4107603335&4294967295,D=P+(b<<14&4294967295|b>>>18),b=A+(P^N&(D^P))+M[8]+1163531501&4294967295,A=D+(b<<20&4294967295|b>>>12),b=N+(D^P&(A^D))+M[13]+2850285829&4294967295,N=A+(b<<5&4294967295|b>>>27),b=P+(A^D&(N^A))+M[2]+4243563512&4294967295,P=N+(b<<9&4294967295|b>>>23),b=D+(N^A&(P^N))+M[7]+1735328473&4294967295,D=P+(b<<14&4294967295|b>>>18),b=A+(P^N&(D^P))+M[12]+2368359562&4294967295,A=D+(b<<20&4294967295|b>>>12),b=N+(A^D^P)+M[5]+4294588738&4294967295,N=A+(b<<4&4294967295|b>>>28),b=P+(N^A^D)+M[8]+2272392833&4294967295,P=N+(b<<11&4294967295|b>>>21),b=D+(P^N^A)+M[11]+1839030562&4294967295,D=P+(b<<16&4294967295|b>>>16),b=A+(D^P^N)+M[14]+4259657740&4294967295,A=D+(b<<23&4294967295|b>>>9),b=N+(A^D^P)+M[1]+2763975236&4294967295,N=A+(b<<4&4294967295|b>>>28),b=P+(N^A^D)+M[4]+1272893353&4294967295,P=N+(b<<11&4294967295|b>>>21),b=D+(P^N^A)+M[7]+4139469664&4294967295,D=P+(b<<16&4294967295|b>>>16),b=A+(D^P^N)+M[10]+3200236656&4294967295,A=D+(b<<23&4294967295|b>>>9),b=N+(A^D^P)+M[13]+681279174&4294967295,N=A+(b<<4&4294967295|b>>>28),b=P+(N^A^D)+M[0]+3936430074&4294967295,P=N+(b<<11&4294967295|b>>>21),b=D+(P^N^A)+M[3]+3572445317&4294967295,D=P+(b<<16&4294967295|b>>>16),b=A+(D^P^N)+M[6]+76029189&4294967295,A=D+(b<<23&4294967295|b>>>9),b=N+(A^D^P)+M[9]+3654602809&4294967295,N=A+(b<<4&4294967295|b>>>28),b=P+(N^A^D)+M[12]+3873151461&4294967295,P=N+(b<<11&4294967295|b>>>21),b=D+(P^N^A)+M[15]+530742520&4294967295,D=P+(b<<16&4294967295|b>>>16),b=A+(D^P^N)+M[2]+3299628645&4294967295,A=D+(b<<23&4294967295|b>>>9),b=N+(D^(A|~P))+M[0]+4096336452&4294967295,N=A+(b<<6&4294967295|b>>>26),b=P+(A^(N|~D))+M[7]+1126891415&4294967295,P=N+(b<<10&4294967295|b>>>22),b=D+(N^(P|~A))+M[14]+2878612391&4294967295,D=P+(b<<15&4294967295|b>>>17),b=A+(P^(D|~N))+M[5]+4237533241&4294967295,A=D+(b<<21&4294967295|b>>>11),b=N+(D^(A|~P))+M[12]+1700485571&4294967295,N=A+(b<<6&4294967295|b>>>26),b=P+(A^(N|~D))+M[3]+2399980690&4294967295,P=N+(b<<10&4294967295|b>>>22),b=D+(N^(P|~A))+M[10]+4293915773&4294967295,D=P+(b<<15&4294967295|b>>>17),b=A+(P^(D|~N))+M[1]+2240044497&4294967295,A=D+(b<<21&4294967295|b>>>11),b=N+(D^(A|~P))+M[8]+1873313359&4294967295,N=A+(b<<6&4294967295|b>>>26),b=P+(A^(N|~D))+M[15]+4264355552&4294967295,P=N+(b<<10&4294967295|b>>>22),b=D+(N^(P|~A))+M[6]+2734768916&4294967295,D=P+(b<<15&4294967295|b>>>17),b=A+(P^(D|~N))+M[13]+1309151649&4294967295,A=D+(b<<21&4294967295|b>>>11),b=N+(D^(A|~P))+M[4]+4149444226&4294967295,N=A+(b<<6&4294967295|b>>>26),b=P+(A^(N|~D))+M[11]+3174756917&4294967295,P=N+(b<<10&4294967295|b>>>22),b=D+(N^(P|~A))+M[2]+718787259&4294967295,D=P+(b<<15&4294967295|b>>>17),b=A+(P^(D|~N))+M[9]+3951481745&4294967295,I.g[0]=I.g[0]+N&4294967295,I.g[1]=I.g[1]+(D+(b<<21&4294967295|b>>>11))&4294967295,I.g[2]=I.g[2]+D&4294967295,I.g[3]=I.g[3]+P&4294967295}s.prototype.u=function(I,N){N===void 0&&(N=I.length);for(var A=N-this.blockSize,M=this.B,D=this.h,P=0;P<N;){if(D==0)for(;P<=A;)a(this,I,P),P+=this.blockSize;if(typeof I=="string"){for(;P<N;)if(M[D++]=I.charCodeAt(P++),D==this.blockSize){a(this,M),D=0;break}}else for(;P<N;)if(M[D++]=I[P++],D==this.blockSize){a(this,M),D=0;break}}this.h=D,this.o+=N},s.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var N=1;N<I.length-8;++N)I[N]=0;var A=8*this.o;for(N=I.length-8;N<I.length;++N)I[N]=A&255,A/=256;for(this.u(I),I=Array(16),N=A=0;4>N;++N)for(var M=0;32>M;M+=8)I[A++]=this.g[N]>>>M&255;return I};function l(I,N){var A=f;return Object.prototype.hasOwnProperty.call(A,I)?A[I]:A[I]=N(I)}function d(I,N){this.h=N;for(var A=[],M=!0,D=I.length-1;0<=D;D--){var P=I[D]|0;M&&P==N||(A[D]=P,M=!1)}this.g=A}var f={};function m(I){return-128<=I&&128>I?l(I,function(N){return new d([N|0],0>N?-1:0)}):new d([I|0],0>I?-1:0)}function y(I){if(isNaN(I)||!isFinite(I))return E;if(0>I)return U(y(-I));for(var N=[],A=1,M=0;I>=A;M++)N[M]=I/A|0,A*=4294967296;return new d(N,0)}function x(I,N){if(I.length==0)throw Error("number format error: empty string");if(N=N||10,2>N||36<N)throw Error("radix out of range: "+N);if(I.charAt(0)=="-")return U(x(I.substring(1),N));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var A=y(Math.pow(N,8)),M=E,D=0;D<I.length;D+=8){var P=Math.min(8,I.length-D),b=parseInt(I.substring(D,D+P),N);8>P?(P=y(Math.pow(N,P)),M=M.j(P).add(y(b))):(M=M.j(A),M=M.add(y(b)))}return M}var E=m(0),C=m(1),O=m(16777216);n=d.prototype,n.m=function(){if(B(this))return-U(this).m();for(var I=0,N=1,A=0;A<this.g.length;A++){var M=this.i(A);I+=(0<=M?M:4294967296+M)*N,N*=4294967296}return I},n.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(X(this))return"0";if(B(this))return"-"+U(this).toString(I);for(var N=y(Math.pow(I,6)),A=this,M="";;){var D=ve(A,N).g;A=se(A,D.j(N));var P=((0<A.g.length?A.g[0]:A.h)>>>0).toString(I);if(A=D,X(A))return P+M;for(;6>P.length;)P="0"+P;M=P+M}},n.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function X(I){if(I.h!=0)return!1;for(var N=0;N<I.g.length;N++)if(I.g[N]!=0)return!1;return!0}function B(I){return I.h==-1}n.l=function(I){return I=se(this,I),B(I)?-1:X(I)?0:1};function U(I){for(var N=I.g.length,A=[],M=0;M<N;M++)A[M]=~I.g[M];return new d(A,~I.h).add(C)}n.abs=function(){return B(this)?U(this):this},n.add=function(I){for(var N=Math.max(this.g.length,I.g.length),A=[],M=0,D=0;D<=N;D++){var P=M+(this.i(D)&65535)+(I.i(D)&65535),b=(P>>>16)+(this.i(D)>>>16)+(I.i(D)>>>16);M=b>>>16,P&=65535,b&=65535,A[D]=b<<16|P}return new d(A,A[A.length-1]&-2147483648?-1:0)};function se(I,N){return I.add(U(N))}n.j=function(I){if(X(this)||X(I))return E;if(B(this))return B(I)?U(this).j(U(I)):U(U(this).j(I));if(B(I))return U(this.j(U(I)));if(0>this.l(O)&&0>I.l(O))return y(this.m()*I.m());for(var N=this.g.length+I.g.length,A=[],M=0;M<2*N;M++)A[M]=0;for(M=0;M<this.g.length;M++)for(var D=0;D<I.g.length;D++){var P=this.i(M)>>>16,b=this.i(M)&65535,J=I.i(D)>>>16,re=I.i(D)&65535;A[2*M+2*D]+=b*re,we(A,2*M+2*D),A[2*M+2*D+1]+=P*re,we(A,2*M+2*D+1),A[2*M+2*D+1]+=b*J,we(A,2*M+2*D+1),A[2*M+2*D+2]+=P*J,we(A,2*M+2*D+2)}for(M=0;M<N;M++)A[M]=A[2*M+1]<<16|A[2*M];for(M=N;M<2*N;M++)A[M]=0;return new d(A,0)};function we(I,N){for(;(I[N]&65535)!=I[N];)I[N+1]+=I[N]>>>16,I[N]&=65535,N++}function _e(I,N){this.g=I,this.h=N}function ve(I,N){if(X(N))throw Error("division by zero");if(X(I))return new _e(E,E);if(B(I))return N=ve(U(I),N),new _e(U(N.g),U(N.h));if(B(N))return N=ve(I,U(N)),new _e(U(N.g),N.h);if(30<I.g.length){if(B(I)||B(N))throw Error("slowDivide_ only works with positive integers.");for(var A=C,M=N;0>=M.l(I);)A=L(A),M=L(M);var D=ie(A,1),P=ie(M,1);for(M=ie(M,2),A=ie(A,2);!X(M);){var b=P.add(M);0>=b.l(I)&&(D=D.add(A),P=b),M=ie(M,1),A=ie(A,1)}return N=se(I,D.j(N)),new _e(D,N)}for(D=E;0<=I.l(N);){for(A=Math.max(1,Math.floor(I.m()/N.m())),M=Math.ceil(Math.log(A)/Math.LN2),M=48>=M?1:Math.pow(2,M-48),P=y(A),b=P.j(N);B(b)||0<b.l(I);)A-=M,P=y(A),b=P.j(N);X(P)&&(P=C),D=D.add(P),I=se(I,b)}return new _e(D,I)}n.A=function(I){return ve(this,I).h},n.and=function(I){for(var N=Math.max(this.g.length,I.g.length),A=[],M=0;M<N;M++)A[M]=this.i(M)&I.i(M);return new d(A,this.h&I.h)},n.or=function(I){for(var N=Math.max(this.g.length,I.g.length),A=[],M=0;M<N;M++)A[M]=this.i(M)|I.i(M);return new d(A,this.h|I.h)},n.xor=function(I){for(var N=Math.max(this.g.length,I.g.length),A=[],M=0;M<N;M++)A[M]=this.i(M)^I.i(M);return new d(A,this.h^I.h)};function L(I){for(var N=I.g.length+1,A=[],M=0;M<N;M++)A[M]=I.i(M)<<1|I.i(M-1)>>>31;return new d(A,I.h)}function ie(I,N){var A=N>>5;N%=32;for(var M=I.g.length-A,D=[],P=0;P<M;P++)D[P]=0<N?I.i(P+A)>>>N|I.i(P+A+1)<<32-N:I.i(P+A);return new d(D,I.h)}s.prototype.digest=s.prototype.v,s.prototype.reset=s.prototype.s,s.prototype.update=s.prototype.u,V0=s,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.A,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=y,d.fromString=x,ta=d}).apply(typeof cv<"u"?cv:typeof self<"u"?self:typeof window<"u"?window:{});var _u=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var L0,kl,M0,Ru,Vf,O0,F0,U0;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,g,_){return u==Array.prototype||u==Object.prototype||(u[g]=_.value),u};function t(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof _u=="object"&&_u];for(var g=0;g<u.length;++g){var _=u[g];if(_&&_.Math==Math)return _}throw Error("Cannot find global object")}var s=t(this);function a(u,g){if(g)e:{var _=s;u=u.split(".");for(var R=0;R<u.length-1;R++){var Z=u[R];if(!(Z in _))break e;_=_[Z]}u=u[u.length-1],R=_[u],g=g(R),g!=R&&g!=null&&e(_,u,{configurable:!0,writable:!0,value:g})}}function l(u,g){u instanceof String&&(u+="");var _=0,R=!1,Z={next:function(){if(!R&&_<u.length){var oe=_++;return{value:g(oe,u[oe]),done:!1}}return R=!0,{done:!0,value:void 0}}};return Z[Symbol.iterator]=function(){return Z},Z}a("Array.prototype.values",function(u){return u||function(){return l(this,function(g,_){return _})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var d=d||{},f=this||self;function m(u){var g=typeof u;return g=g!="object"?g:u?Array.isArray(u)?"array":g:"null",g=="array"||g=="object"&&typeof u.length=="number"}function y(u){var g=typeof u;return g=="object"&&u!=null||g=="function"}function x(u,g,_){return u.call.apply(u.bind,arguments)}function E(u,g,_){if(!u)throw Error();if(2<arguments.length){var R=Array.prototype.slice.call(arguments,2);return function(){var Z=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Z,R),u.apply(g,Z)}}return function(){return u.apply(g,arguments)}}function C(u,g,_){return C=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?x:E,C.apply(null,arguments)}function O(u,g){var _=Array.prototype.slice.call(arguments,1);return function(){var R=_.slice();return R.push.apply(R,arguments),u.apply(this,R)}}function X(u,g){function _(){}_.prototype=g.prototype,u.aa=g.prototype,u.prototype=new _,u.prototype.constructor=u,u.Qb=function(R,Z,oe){for(var Ve=Array(arguments.length-2),Vt=2;Vt<arguments.length;Vt++)Ve[Vt-2]=arguments[Vt];return g.prototype[Z].apply(R,Ve)}}function B(u){const g=u.length;if(0<g){const _=Array(g);for(let R=0;R<g;R++)_[R]=u[R];return _}return[]}function U(u,g){for(let _=1;_<arguments.length;_++){const R=arguments[_];if(m(R)){const Z=u.length||0,oe=R.length||0;u.length=Z+oe;for(let Ve=0;Ve<oe;Ve++)u[Z+Ve]=R[Ve]}else u.push(R)}}class se{constructor(g,_){this.i=g,this.j=_,this.h=0,this.g=null}get(){let g;return 0<this.h?(this.h--,g=this.g,this.g=g.next,g.next=null):g=this.i(),g}}function we(u){return/^[\s\xa0]*$/.test(u)}function _e(){var u=f.navigator;return u&&(u=u.userAgent)?u:""}function ve(u){return ve[" "](u),u}ve[" "]=function(){};var L=_e().indexOf("Gecko")!=-1&&!(_e().toLowerCase().indexOf("webkit")!=-1&&_e().indexOf("Edge")==-1)&&!(_e().indexOf("Trident")!=-1||_e().indexOf("MSIE")!=-1)&&_e().indexOf("Edge")==-1;function ie(u,g,_){for(const R in u)g.call(_,u[R],R,u)}function I(u,g){for(const _ in u)g.call(void 0,u[_],_,u)}function N(u){const g={};for(const _ in u)g[_]=u[_];return g}const A="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function M(u,g){let _,R;for(let Z=1;Z<arguments.length;Z++){R=arguments[Z];for(_ in R)u[_]=R[_];for(let oe=0;oe<A.length;oe++)_=A[oe],Object.prototype.hasOwnProperty.call(R,_)&&(u[_]=R[_])}}function D(u){var g=1;u=u.split(":");const _=[];for(;0<g&&u.length;)_.push(u.shift()),g--;return u.length&&_.push(u.join(":")),_}function P(u){f.setTimeout(()=>{throw u},0)}function b(){var u=Pe;let g=null;return u.g&&(g=u.g,u.g=u.g.next,u.g||(u.h=null),g.next=null),g}class J{constructor(){this.h=this.g=null}add(g,_){const R=re.get();R.set(g,_),this.h?this.h.next=R:this.g=R,this.h=R}}var re=new se(()=>new Ce,u=>u.reset());class Ce{constructor(){this.next=this.g=this.h=null}set(g,_){this.h=g,this.g=_,this.next=null}reset(){this.next=this.g=this.h=null}}let fe,le=!1,Pe=new J,xe=()=>{const u=f.Promise.resolve(void 0);fe=()=>{u.then(Y)}};var Y=()=>{for(var u;u=b();){try{u.h.call(u.g)}catch(_){P(_)}var g=re;g.j(u),100>g.h&&(g.h++,u.next=g.g,g.g=u)}le=!1};function k(){this.s=this.s,this.C=this.C}k.prototype.s=!1,k.prototype.ma=function(){this.s||(this.s=!0,this.N())},k.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function K(u,g){this.type=u,this.g=this.target=g,this.defaultPrevented=!1}K.prototype.h=function(){this.defaultPrevented=!0};var Te=(function(){if(!f.addEventListener||!Object.defineProperty)return!1;var u=!1,g=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const _=()=>{};f.addEventListener("test",_,g),f.removeEventListener("test",_,g)}catch{}return u})();function De(u,g){if(K.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var _=this.type=u.type,R=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=g,g=u.relatedTarget){if(L){e:{try{ve(g.nodeName);var Z=!0;break e}catch{}Z=!1}Z||(g=null)}}else _=="mouseover"?g=u.fromElement:_=="mouseout"&&(g=u.toElement);this.relatedTarget=g,R?(this.clientX=R.clientX!==void 0?R.clientX:R.pageX,this.clientY=R.clientY!==void 0?R.clientY:R.pageY,this.screenX=R.screenX||0,this.screenY=R.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:ke[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&De.aa.h.call(this)}}X(De,K);var ke={2:"touch",3:"pen",4:"mouse"};De.prototype.h=function(){De.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var Oe="closure_listenable_"+(1e6*Math.random()|0),Qe=0;function nt(u,g,_,R,Z){this.listener=u,this.proxy=null,this.src=g,this.type=_,this.capture=!!R,this.ha=Z,this.key=++Qe,this.da=this.fa=!1}function me(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function ce(u){this.src=u,this.g={},this.h=0}ce.prototype.add=function(u,g,_,R,Z){var oe=u.toString();u=this.g[oe],u||(u=this.g[oe]=[],this.h++);var Ve=ge(u,g,R,Z);return-1<Ve?(g=u[Ve],_||(g.fa=!1)):(g=new nt(g,this.src,oe,!!R,Z),g.fa=_,u.push(g)),g};function Le(u,g){var _=g.type;if(_ in u.g){var R=u.g[_],Z=Array.prototype.indexOf.call(R,g,void 0),oe;(oe=0<=Z)&&Array.prototype.splice.call(R,Z,1),oe&&(me(g),u.g[_].length==0&&(delete u.g[_],u.h--))}}function ge(u,g,_,R){for(var Z=0;Z<u.length;++Z){var oe=u[Z];if(!oe.da&&oe.listener==g&&oe.capture==!!_&&oe.ha==R)return Z}return-1}var He="closure_lm_"+(1e6*Math.random()|0),Je={};function _t(u,g,_,R,Z){if(Array.isArray(g)){for(var oe=0;oe<g.length;oe++)_t(u,g[oe],_,R,Z);return null}return _=cr(_),u&&u[Oe]?u.K(g,_,y(R)?!!R.capture:!1,Z):Ct(u,g,_,!1,R,Z)}function Ct(u,g,_,R,Z,oe){if(!g)throw Error("Invalid event type");var Ve=y(Z)?!!Z.capture:!!Z,Vt=qn(u);if(Vt||(u[He]=Vt=new ce(u)),_=Vt.add(g,_,R,Ve,oe),_.proxy)return _;if(R=Nt(),_.proxy=R,R.src=u,R.listener=_,u.addEventListener)Te||(Z=Ve),Z===void 0&&(Z=!1),u.addEventListener(g.toString(),R,Z);else if(u.attachEvent)u.attachEvent(sn(g.toString()),R);else if(u.addListener&&u.removeListener)u.addListener(R);else throw Error("addEventListener and attachEvent are unavailable.");return _}function Nt(){function u(_){return g.call(u.src,u.listener,_)}const g=en;return u}function Ot(u,g,_,R,Z){if(Array.isArray(g))for(var oe=0;oe<g.length;oe++)Ot(u,g[oe],_,R,Z);else R=y(R)?!!R.capture:!!R,_=cr(_),u&&u[Oe]?(u=u.i,g=String(g).toString(),g in u.g&&(oe=u.g[g],_=ge(oe,_,R,Z),-1<_&&(me(oe[_]),Array.prototype.splice.call(oe,_,1),oe.length==0&&(delete u.g[g],u.h--)))):u&&(u=qn(u))&&(g=u.g[g.toString()],u=-1,g&&(u=ge(g,_,R,Z)),(_=-1<u?g[u]:null)&&Zt(_))}function Zt(u){if(typeof u!="number"&&u&&!u.da){var g=u.src;if(g&&g[Oe])Le(g.i,u);else{var _=u.type,R=u.proxy;g.removeEventListener?g.removeEventListener(_,R,u.capture):g.detachEvent?g.detachEvent(sn(_),R):g.addListener&&g.removeListener&&g.removeListener(R),(_=qn(g))?(Le(_,u),_.h==0&&(_.src=null,g[He]=null)):me(u)}}}function sn(u){return u in Je?Je[u]:Je[u]="on"+u}function en(u,g){if(u.da)u=!0;else{g=new De(g,this);var _=u.listener,R=u.ha||u.src;u.fa&&Zt(u),u=_.call(R,g)}return u}function qn(u){return u=u[He],u instanceof ce?u:null}var yn="__closure_events_fn_"+(1e9*Math.random()>>>0);function cr(u){return typeof u=="function"?u:(u[yn]||(u[yn]=function(g){return u.handleEvent(g)}),u[yn])}function jt(){k.call(this),this.i=new ce(this),this.M=this,this.F=null}X(jt,k),jt.prototype[Oe]=!0,jt.prototype.removeEventListener=function(u,g,_,R){Ot(this,u,g,_,R)};function Bt(u,g){var _,R=u.F;if(R)for(_=[];R;R=R.F)_.push(R);if(u=u.M,R=g.type||g,typeof g=="string")g=new K(g,u);else if(g instanceof K)g.target=g.target||u;else{var Z=g;g=new K(R,u),M(g,Z)}if(Z=!0,_)for(var oe=_.length-1;0<=oe;oe--){var Ve=g.g=_[oe];Z=In(Ve,R,!0,g)&&Z}if(Ve=g.g=u,Z=In(Ve,R,!0,g)&&Z,Z=In(Ve,R,!1,g)&&Z,_)for(oe=0;oe<_.length;oe++)Ve=g.g=_[oe],Z=In(Ve,R,!1,g)&&Z}jt.prototype.N=function(){if(jt.aa.N.call(this),this.i){var u=this.i,g;for(g in u.g){for(var _=u.g[g],R=0;R<_.length;R++)me(_[R]);delete u.g[g],u.h--}}this.F=null},jt.prototype.K=function(u,g,_,R){return this.i.add(String(u),g,!1,_,R)},jt.prototype.L=function(u,g,_,R){return this.i.add(String(u),g,!0,_,R)};function In(u,g,_,R){if(g=u.i.g[String(g)],!g)return!0;g=g.concat();for(var Z=!0,oe=0;oe<g.length;++oe){var Ve=g[oe];if(Ve&&!Ve.da&&Ve.capture==_){var Vt=Ve.listener,En=Ve.ha||Ve.src;Ve.fa&&Le(u.i,Ve),Z=Vt.call(En,R)!==!1&&Z}}return Z&&!R.defaultPrevented}function Dn(u,g,_){if(typeof u=="function")_&&(u=C(u,_));else if(u&&typeof u.handleEvent=="function")u=C(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(g)?-1:f.setTimeout(u,g||0)}function Hn(u){u.g=Dn(()=>{u.g=null,u.i&&(u.i=!1,Hn(u))},u.l);const g=u.h;u.h=null,u.m.apply(null,g)}class _r extends k{constructor(g,_){super(),this.m=g,this.l=_,this.h=null,this.i=!1,this.g=null}j(g){this.h=arguments,this.g?this.i=!0:Hn(this)}N(){super.N(),this.g&&(f.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function xr(u){k.call(this),this.h=u,this.g={}}X(xr,k);var ys=[];function Kn(u){ie(u.g,function(g,_){this.g.hasOwnProperty(_)&&Zt(g)},u),u.g={}}xr.prototype.N=function(){xr.aa.N.call(this),Kn(this)},xr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var cn=f.JSON.stringify,un=f.JSON.parse,vs=class{stringify(u){return f.JSON.stringify(u,void 0)}parse(u){return f.JSON.parse(u,void 0)}};function mt(){}mt.prototype.h=null;function wr(u){return u.h||(u.h=u.i())}function Br(){}var Qn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Nn(){K.call(this,"d")}X(Nn,K);function Wr(){K.call(this,"c")}X(Wr,K);var ur={},Yn=null;function Gr(){return Yn=Yn||new jt}ur.La="serverreachability";function Xs(u){K.call(this,ur.La,u)}X(Xs,K);function dr(u){const g=Gr();Bt(g,new Xs(g))}ur.STAT_EVENT="statevent";function qr(u,g){K.call(this,ur.STAT_EVENT,u),this.stat=g}X(qr,K);function st(u){const g=Gr();Bt(g,new qr(g,u))}ur.Ma="timingevent";function ks(u,g){K.call(this,ur.Ma,u),this.size=g}X(ks,K);function vn(u,g){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return f.setTimeout(function(){u()},g)}function _s(){this.g=!0}_s.prototype.xa=function(){this.g=!1};function Hr(u,g,_,R,Z,oe){u.info(function(){if(u.g)if(oe)for(var Ve="",Vt=oe.split("&"),En=0;En<Vt.length;En++){var Tt=Vt[En].split("=");if(1<Tt.length){var Pn=Tt[0];Tt=Tt[1];var hn=Pn.split("_");Ve=2<=hn.length&&hn[1]=="type"?Ve+(Pn+"="+Tt+"&"):Ve+(Pn+"=redacted&")}}else Ve=null;else Ve=oe;return"XMLHTTP REQ ("+R+") [attempt "+Z+"]: "+g+`
`+_+`
`+Ve})}function Zs(u,g,_,R,Z,oe,Ve){u.info(function(){return"XMLHTTP RESP ("+R+") [ attempt "+Z+"]: "+g+`
`+_+`
`+oe+" "+Ve})}function Ft(u,g,_,R){u.info(function(){return"XMLHTTP TEXT ("+g+"): "+Kr(u,_)+(R?" "+R:"")})}function hr(u,g){u.info(function(){return"TIMEOUT: "+g})}_s.prototype.info=function(){};function Kr(u,g){if(!u.g)return g;if(!g)return null;try{var _=JSON.parse(g);if(_){for(u=0;u<_.length;u++)if(Array.isArray(_[u])){var R=_[u];if(!(2>R.length)){var Z=R[1];if(Array.isArray(Z)&&!(1>Z.length)){var oe=Z[0];if(oe!="noop"&&oe!="stop"&&oe!="close")for(var Ve=1;Ve<Z.length;Ve++)Z[Ve]=""}}}}return cn(_)}catch{return g}}var Jn={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Xn={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Ut;function Er(){}X(Er,mt),Er.prototype.g=function(){return new XMLHttpRequest},Er.prototype.i=function(){return{}},Ut=new Er;function Vn(u,g,_,R){this.j=u,this.i=g,this.l=_,this.R=R||1,this.U=new xr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new ei}function ei(){this.i=null,this.g="",this.h=!1}var Ds={},Qr={};function Ln(u,g,_){u.L=1,u.v=Pt(Mn(g)),u.m=_,u.P=!0,Vs(u,null)}function Vs(u,g){u.F=Date.now(),xt(u),u.A=Mn(u.v);var _=u.A,R=u.R;Array.isArray(R)||(R=[String(R)]),Ms(_.i,"t",R),u.C=0,_=u.j.J,u.h=new ei,u.g=Ec(u.j,_?g:null,!u.m),0<u.O&&(u.M=new _r(C(u.Y,u,u.g),u.O)),g=u.U,_=u.g,R=u.ca;var Z="readystatechange";Array.isArray(Z)||(Z&&(ys[0]=Z.toString()),Z=ys);for(var oe=0;oe<Z.length;oe++){var Ve=_t(_,Z[oe],R||g.handleEvent,!1,g.h||g);if(!Ve)break;g.g[Ve.key]=Ve}g=u.H?N(u.H):{},u.m?(u.u||(u.u="POST"),g["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,g)):(u.u="GET",u.g.ea(u.A,u.u,null,g)),dr(),Hr(u.i,u.u,u.A,u.l,u.R,u.m)}Vn.prototype.ca=function(u){u=u.target;const g=this.M;g&&er(u)==3?g.j():this.Y(u)},Vn.prototype.Y=function(u){try{if(u==this.g)e:{const hn=er(this.g);var g=this.g.Ba();const is=this.g.Z();if(!(3>hn)&&(hn!=3||this.g&&(this.h.h||this.g.oa()||va(this.g)))){this.J||hn!=4||g==7||(g==8||0>=is?dr(3):dr(2)),_n(this);var _=this.g.Z();this.X=_;t:if(Yr(this)){var R=va(this.g);u="";var Z=R.length,oe=er(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){w(this),Wt(this);var Ve="";break t}this.h.i=new f.TextDecoder}for(g=0;g<Z;g++)this.h.h=!0,u+=this.h.i.decode(R[g],{stream:!(oe&&g==Z-1)});R.length=0,this.h.g+=u,this.C=0,Ve=this.h.g}else Ve=this.g.oa();if(this.o=_==200,Zs(this.i,this.u,this.A,this.l,this.R,hn,_),this.o){if(this.T&&!this.K){t:{if(this.g){var Vt,En=this.g;if((Vt=En.g?En.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!we(Vt)){var Tt=Vt;break t}}Tt=null}if(_=Tt)Ft(this.i,this.l,_,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,z(this,_);else{this.o=!1,this.s=3,st(12),w(this),Wt(this);break e}}if(this.P){_=!0;let Mr;for(;!this.J&&this.C<Ve.length;)if(Mr=Jr(this,Ve),Mr==Qr){hn==4&&(this.s=4,st(14),_=!1),Ft(this.i,this.l,null,"[Incomplete Response]");break}else if(Mr==Ds){this.s=4,st(15),Ft(this.i,this.l,Ve,"[Invalid Chunk]"),_=!1;break}else Ft(this.i,this.l,Mr,null),z(this,Mr);if(Yr(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),hn!=4||Ve.length!=0||this.h.h||(this.s=1,st(16),_=!1),this.o=this.o&&_,!_)Ft(this.i,this.l,Ve,"[Invalid Chunked Response]"),w(this),Wt(this);else if(0<Ve.length&&!this.W){this.W=!0;var Pn=this.j;Pn.g==this&&Pn.ba&&!Pn.M&&(Pn.j.info("Great, no buffering proxy detected. Bytes received: "+Ve.length),rl(Pn),Pn.M=!0,st(11))}}else Ft(this.i,this.l,Ve,null),z(this,Ve);hn==4&&w(this),this.o&&!this.J&&(hn==4?no(this.j,this):(this.o=!1,xt(this)))}else rs(this.g),_==400&&0<Ve.indexOf("Unknown SID")?(this.s=3,st(12)):(this.s=0,st(13)),w(this),Wt(this)}}}catch{}finally{}};function Yr(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function Jr(u,g){var _=u.C,R=g.indexOf(`
`,_);return R==-1?Qr:(_=Number(g.substring(_,R)),isNaN(_)?Ds:(R+=1,R+_>g.length?Qr:(g=g.slice(R,R+_),u.C=R+_,g)))}Vn.prototype.cancel=function(){this.J=!0,w(this)};function xt(u){u.S=Date.now()+u.I,Zn(u,u.I)}function Zn(u,g){if(u.B!=null)throw Error("WatchDog timer not null");u.B=vn(C(u.ba,u),g)}function _n(u){u.B&&(f.clearTimeout(u.B),u.B=null)}Vn.prototype.ba=function(){this.B=null;const u=Date.now();0<=u-this.S?(hr(this.i,this.A),this.L!=2&&(dr(),st(17)),w(this),this.s=2,Wt(this)):Zn(this,this.S-u)};function Wt(u){u.j.G==0||u.J||no(u.j,u)}function w(u){_n(u);var g=u.M;g&&typeof g.ma=="function"&&g.ma(),u.M=null,Kn(u.U),u.g&&(g=u.g,u.g=null,g.abort(),g.ma())}function z(u,g){try{var _=u.j;if(_.G!=0&&(_.g==u||te(_.h,u))){if(!u.K&&te(_.h,u)&&_.G==3){try{var R=_.Da.g.parse(g)}catch{R=null}if(Array.isArray(R)&&R.length==3){var Z=R;if(Z[0]==0){e:if(!_.u){if(_.g)if(_.g.F+3e3<u.F)to(_),xs(_);else break e;eo(_),st(18)}}else _.za=Z[1],0<_.za-_.T&&37500>Z[2]&&_.F&&_.v==0&&!_.C&&(_.C=vn(C(_.Za,_),6e3));if(1>=ue(_.h)&&_.ca){try{_.ca()}catch{}_.ca=void 0}}else ri(_,11)}else if((u.K||_.g==u)&&to(_),!we(g))for(Z=_.Da.g.parse(g),g=0;g<Z.length;g++){let Tt=Z[g];if(_.T=Tt[0],Tt=Tt[1],_.G==2)if(Tt[0]=="c"){_.K=Tt[1],_.ia=Tt[2];const Pn=Tt[3];Pn!=null&&(_.la=Pn,_.j.info("VER="+_.la));const hn=Tt[4];hn!=null&&(_.Aa=hn,_.j.info("SVER="+_.Aa));const is=Tt[5];is!=null&&typeof is=="number"&&0<is&&(R=1.5*is,_.L=R,_.j.info("backChannelRequestTimeoutMs_="+R)),R=_;const Mr=u.g;if(Mr){const xa=Mr.g?Mr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(xa){var oe=R.h;oe.g||xa.indexOf("spdy")==-1&&xa.indexOf("quic")==-1&&xa.indexOf("h2")==-1||(oe.j=oe.l,oe.g=new Set,oe.h&&(Me(oe,oe.h),oe.h=null))}if(R.D){const so=Mr.g?Mr.g.getResponseHeader("X-HTTP-Session-Id"):null;so&&(R.ya=so,Rt(R.I,R.D,so))}}_.G=3,_.l&&_.l.ua(),_.ba&&(_.R=Date.now()-u.F,_.j.info("Handshake RTT: "+_.R+"ms")),R=_;var Ve=u;if(R.qa=wc(R,R.J?R.ia:null,R.W),Ve.K){Ne(R.h,Ve);var Vt=Ve,En=R.L;En&&(Vt.I=En),Vt.B&&(_n(Vt),xt(Vt)),R.g=Ve}else _a(R);0<_.i.length&&Os(_)}else Tt[0]!="stop"&&Tt[0]!="close"||ri(_,7);else _.G==3&&(Tt[0]=="stop"||Tt[0]=="close"?Tt[0]=="stop"?ri(_,7):Un(_):Tt[0]!="noop"&&_.l&&_.l.ta(Tt),_.v=0)}}dr(4)}catch{}}var W=class{constructor(u,g){this.g=u,this.map=g}};function F(u){this.l=u||10,f.PerformanceNavigationTiming?(u=f.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(f.chrome&&f.chrome.loadTimes&&f.chrome.loadTimes()&&f.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function G(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function ue(u){return u.h?1:u.g?u.g.size:0}function te(u,g){return u.h?u.h==g:u.g?u.g.has(g):!1}function Me(u,g){u.g?u.g.add(g):u.h=g}function Ne(u,g){u.h&&u.h==g?u.h=null:u.g&&u.g.has(g)&&u.g.delete(g)}F.prototype.cancel=function(){if(this.i=$e(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function $e(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let g=u.i;for(const _ of u.g.values())g=g.concat(_.D);return g}return B(u.i)}function de(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(m(u)){for(var g=[],_=u.length,R=0;R<_;R++)g.push(u[R]);return g}g=[],_=0;for(R in u)g[_++]=u[R];return g}function Xe(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(m(u)||typeof u=="string"){var g=[];u=u.length;for(var _=0;_<u;_++)g.push(_);return g}g=[],_=0;for(const R in u)g[_++]=R;return g}}}function Re(u,g){if(u.forEach&&typeof u.forEach=="function")u.forEach(g,void 0);else if(m(u)||typeof u=="string")Array.prototype.forEach.call(u,g,void 0);else for(var _=Xe(u),R=de(u),Z=R.length,oe=0;oe<Z;oe++)g.call(void 0,R[oe],_&&_[oe],u)}var ht=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Xr(u,g){if(u){u=u.split("&");for(var _=0;_<u.length;_++){var R=u[_].indexOf("="),Z=null;if(0<=R){var oe=u[_].substring(0,R);Z=u[_].substring(R+1)}else oe=u[_];g(oe,Z?decodeURIComponent(Z.replace(/\+/g," ")):"")}}}function fr(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof fr){this.h=u.h,pr(this,u.j),this.o=u.o,this.g=u.g,Zr(this,u.s),this.l=u.l;var g=u.i,_=new ts;_.i=g.i,g.g&&(_.g=new Map(g.g),_.h=g.h),Ls(this,_),this.m=u.m}else u&&(g=String(u).match(ht))?(this.h=!1,pr(this,g[1]||"",!0),this.o=ut(g[2]||""),this.g=ut(g[3]||"",!0),Zr(this,g[4]),this.l=ut(g[5]||"",!0),Ls(this,g[6]||"",!0),this.m=ut(g[7]||"")):(this.h=!1,this.i=new ts(null,this.h))}fr.prototype.toString=function(){var u=[],g=this.j;g&&u.push(On(g,ti,!0),":");var _=this.g;return(_||g=="file")&&(u.push("//"),(g=this.o)&&u.push(On(g,ti,!0),"@"),u.push(encodeURIComponent(String(_)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_=this.s,_!=null&&u.push(":",String(_))),(_=this.l)&&(this.g&&_.charAt(0)!="/"&&u.push("/"),u.push(On(_,_.charAt(0)=="/"?Ja:ya,!0))),(_=this.i.toString())&&u.push("?",_),(_=this.m)&&u.push("#",On(_,Ci)),u.join("")};function Mn(u){return new fr(u)}function pr(u,g,_){u.j=_?ut(g,!0):g,u.j&&(u.j=u.j.replace(/:$/,""))}function Zr(u,g){if(g){if(g=Number(g),isNaN(g)||0>g)throw Error("Bad port number "+g);u.s=g}else u.s=null}function Ls(u,g,_){g instanceof ts?(u.i=g,ns(u.i,u.h)):(_||(g=On(g,es)),u.i=new ts(g,u.h))}function Rt(u,g,_){u.i.set(g,_)}function Pt(u){return Rt(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function ut(u,g){return u?g?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function On(u,g,_){return typeof u=="string"?(u=encodeURI(u).replace(g,ga),_&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function ga(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var ti=/[#\/\?@]/g,ya=/[#\?:]/g,Ja=/[#\?]/g,es=/[#\?@]/g,Ci=/#/g;function ts(u,g){this.h=this.g=null,this.i=u||null,this.j=!!g}function dn(u){u.g||(u.g=new Map,u.h=0,u.i&&Xr(u.i,function(g,_){u.add(decodeURIComponent(g.replace(/\+/g," ")),_)}))}n=ts.prototype,n.add=function(u,g){dn(this),this.i=null,u=mr(this,u);var _=this.g.get(u);return _||this.g.set(u,_=[]),_.push(g),this.h+=1,this};function Tr(u,g){dn(u),g=mr(u,g),u.g.has(g)&&(u.i=null,u.h-=u.g.get(g).length,u.g.delete(g))}function Sr(u,g){return dn(u),g=mr(u,g),u.g.has(g)}n.forEach=function(u,g){dn(this),this.g.forEach(function(_,R){_.forEach(function(Z){u.call(g,Z,R,this)},this)},this)},n.na=function(){dn(this);const u=Array.from(this.g.values()),g=Array.from(this.g.keys()),_=[];for(let R=0;R<g.length;R++){const Z=u[R];for(let oe=0;oe<Z.length;oe++)_.push(g[R])}return _},n.V=function(u){dn(this);let g=[];if(typeof u=="string")Sr(this,u)&&(g=g.concat(this.g.get(mr(this,u))));else{u=Array.from(this.g.values());for(let _=0;_<u.length;_++)g=g.concat(u[_])}return g},n.set=function(u,g){return dn(this),this.i=null,u=mr(this,u),Sr(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[g]),this.h+=1,this},n.get=function(u,g){return u?(u=this.V(u),0<u.length?String(u[0]):g):g};function Ms(u,g,_){Tr(u,g),0<_.length&&(u.i=null,u.g.set(mr(u,g),B(_)),u.h+=_.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],g=Array.from(this.g.keys());for(var _=0;_<g.length;_++){var R=g[_];const oe=encodeURIComponent(String(R)),Ve=this.V(R);for(R=0;R<Ve.length;R++){var Z=oe;Ve[R]!==""&&(Z+="="+encodeURIComponent(String(Ve[R]))),u.push(Z)}}return this.i=u.join("&")};function mr(u,g){return g=String(g),u.j&&(g=g.toLowerCase()),g}function ns(u,g){g&&!u.j&&(dn(u),u.i=null,u.g.forEach(function(_,R){var Z=R.toLowerCase();R!=Z&&(Tr(this,R),Ms(this,Z,_))},u)),u.j=g}function T(u,g){const _=new _s;if(f.Image){const R=new Image;R.onload=O(q,_,"TestLoadImage: loaded",!0,g,R),R.onerror=O(q,_,"TestLoadImage: error",!1,g,R),R.onabort=O(q,_,"TestLoadImage: abort",!1,g,R),R.ontimeout=O(q,_,"TestLoadImage: timeout",!1,g,R),f.setTimeout(function(){R.ontimeout&&R.ontimeout()},1e4),R.src=u}else g(!1)}function $(u,g){const _=new _s,R=new AbortController,Z=setTimeout(()=>{R.abort(),q(_,"TestPingServer: timeout",!1,g)},1e4);fetch(u,{signal:R.signal}).then(oe=>{clearTimeout(Z),oe.ok?q(_,"TestPingServer: ok",!0,g):q(_,"TestPingServer: server error",!1,g)}).catch(()=>{clearTimeout(Z),q(_,"TestPingServer: error",!1,g)})}function q(u,g,_,R,Z){try{Z&&(Z.onload=null,Z.onerror=null,Z.onabort=null,Z.ontimeout=null),R(_)}catch{}}function he(){this.g=new vs}function be(u,g,_){const R=_||"";try{Re(u,function(Z,oe){let Ve=Z;y(Z)&&(Ve=cn(Z)),g.push(R+oe+"="+encodeURIComponent(Ve))})}catch(Z){throw g.push(R+"type="+encodeURIComponent("_badmap")),Z}}function Be(u){this.l=u.Ub||null,this.j=u.eb||!1}X(Be,mt),Be.prototype.g=function(){return new je(this.l,this.j)},Be.prototype.i=(function(u){return function(){return u}})({});function je(u,g){jt.call(this),this.D=u,this.o=g,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}X(je,jt),n=je.prototype,n.open=function(u,g){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=g,this.readyState=1,gt(this)},n.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const g={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(g.body=u),(this.D||f).fetch(new Request(this.A,g)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,dt(this)),this.readyState=0},n.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,gt(this)),this.g&&(this.readyState=3,gt(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof f.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;ct(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function ct(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}n.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var g=u.value?u.value:new Uint8Array(0);(g=this.v.decode(g,{stream:!u.done}))&&(this.response=this.responseText+=g)}u.done?dt(this):gt(this),this.readyState==3&&ct(this)}},n.Ra=function(u){this.g&&(this.response=this.responseText=u,dt(this))},n.Qa=function(u){this.g&&(this.response=u,dt(this))},n.ga=function(){this.g&&dt(this)};function dt(u){u.readyState=4,u.l=null,u.j=null,u.v=null,gt(u)}n.setRequestHeader=function(u,g){this.u.append(u,g)},n.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],g=this.h.entries();for(var _=g.next();!_.done;)_=_.value,u.push(_[0]+": "+_[1]),_=g.next();return u.join(`\r
`)};function gt(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(je.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function kt(u){let g="";return ie(u,function(_,R){g+=R,g+=":",g+=_,g+=`\r
`}),g}function Dt(u,g,_){e:{for(R in _){var R=!1;break e}R=!0}R||(_=kt(_),typeof u=="string"?_!=null&&encodeURIComponent(String(_)):Rt(u,g,_))}function wt(u){jt.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}X(wt,jt);var xn=/^https?$/i,Et=["POST","PUT"];n=wt.prototype,n.Ha=function(u){this.J=u},n.ea=function(u,g,_,R){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);g=g?g.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ut.g(),this.v=this.o?wr(this.o):wr(Ut),this.g.onreadystatechange=C(this.Ea,this);try{this.B=!0,this.g.open(g,String(u),!0),this.B=!1}catch(oe){br(this,oe);return}if(u=_||"",_=new Map(this.headers),R)if(Object.getPrototypeOf(R)===Object.prototype)for(var Z in R)_.set(Z,R[Z]);else if(typeof R.keys=="function"&&typeof R.get=="function")for(const oe of R.keys())_.set(oe,R.get(oe));else throw Error("Unknown input type for opt_headers: "+String(R));R=Array.from(_.keys()).find(oe=>oe.toLowerCase()=="content-type"),Z=f.FormData&&u instanceof f.FormData,!(0<=Array.prototype.indexOf.call(Et,g,void 0))||R||Z||_.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[oe,Ve]of _)this.g.setRequestHeader(oe,Ve);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Ii(this),this.u=!0,this.g.send(u),this.u=!1}catch(oe){br(this,oe)}};function br(u,g){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=g,u.m=5,wn(u),Fn(u)}function wn(u){u.A||(u.A=!0,Bt(u,"complete"),Bt(u,"error"))}n.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,Bt(this,"complete"),Bt(this,"abort"),Fn(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Fn(this,!0)),wt.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Lr(this):this.bb())},n.bb=function(){Lr(this)};function Lr(u){if(u.h&&typeof d<"u"&&(!u.v[1]||er(u)!=4||u.Z()!=2)){if(u.u&&er(u)==4)Dn(u.Ea,0,u);else if(Bt(u,"readystatechange"),er(u)==4){u.h=!1;try{const Ve=u.Z();e:switch(Ve){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var g=!0;break e;default:g=!1}var _;if(!(_=g)){var R;if(R=Ve===0){var Z=String(u.D).match(ht)[1]||null;!Z&&f.self&&f.self.location&&(Z=f.self.location.protocol.slice(0,-1)),R=!xn.test(Z?Z.toLowerCase():"")}_=R}if(_)Bt(u,"complete"),Bt(u,"success");else{u.m=6;try{var oe=2<er(u)?u.g.statusText:""}catch{oe=""}u.l=oe+" ["+u.Z()+"]",wn(u)}}finally{Fn(u)}}}}function Fn(u,g){if(u.g){Ii(u);const _=u.g,R=u.v[0]?()=>{}:null;u.g=null,u.v=null,g||Bt(u,"ready");try{_.onreadystatechange=R}catch{}}}function Ii(u){u.I&&(f.clearTimeout(u.I),u.I=null)}n.isActive=function(){return!!this.g};function er(u){return u.g?u.g.readyState:0}n.Z=function(){try{return 2<er(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(u){if(this.g){var g=this.g.responseText;return u&&g.indexOf(u)==0&&(g=g.substring(u.length)),un(g)}};function va(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function rs(u){const g={};u=(u.g&&2<=er(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let R=0;R<u.length;R++){if(we(u[R]))continue;var _=D(u[R]);const Z=_[0];if(_=_[1],typeof _!="string")continue;_=_.trim();const oe=g[Z]||[];g[Z]=oe,oe.push(_)}I(g,function(R){return R.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ss(u,g,_){return _&&_.internalChannelParams&&_.internalChannelParams[u]||g}function nl(u){this.Aa=0,this.i=[],this.j=new _s,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ss("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ss("baseRetryDelayMs",5e3,u),this.cb=ss("retryDelaySeedMs",1e4,u),this.Wa=ss("forwardChannelMaxRetries",2,u),this.wa=ss("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new F(u&&u.concurrentRequestLimit),this.Da=new he,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=nl.prototype,n.la=8,n.G=1,n.connect=function(u,g,_,R){st(0),this.W=u,this.H=g||{},_&&R!==void 0&&(this.H.OSID=_,this.H.OAID=R),this.F=this.X,this.I=wc(this,null,this.W),Os(this)};function Un(u){if(Xa(u),u.G==3){var g=u.U++,_=Mn(u.I);if(Rt(_,"SID",u.K),Rt(_,"RID",g),Rt(_,"TYPE","terminate"),ni(u,_),g=new Vn(u,u.j,g),g.L=2,g.v=Pt(Mn(_)),_=!1,f.navigator&&f.navigator.sendBeacon)try{_=f.navigator.sendBeacon(g.v.toString(),"")}catch{}!_&&f.Image&&(new Image().src=g.v,_=!0),_||(g.g=Ec(g.j,null),g.g.ea(g.v)),g.F=Date.now(),xt(g)}xc(u)}function xs(u){u.g&&(rl(u),u.g.cancel(),u.g=null)}function Xa(u){xs(u),u.u&&(f.clearTimeout(u.u),u.u=null),to(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&f.clearTimeout(u.s),u.s=null)}function Os(u){if(!G(u.h)&&!u.s){u.s=!0;var g=u.Ga;fe||xe(),le||(fe(),le=!0),Pe.add(g,u),u.B=0}}function Dd(u,g){return ue(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=g.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=vn(C(u.Ga,u,g),_c(u,u.B)),u.B++,!0)}n.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;const Z=new Vn(this,this.j,u);let oe=this.o;if(this.S&&(oe?(oe=N(oe),M(oe,this.S)):oe=this.S),this.m!==null||this.O||(Z.H=oe,oe=null),this.P)e:{for(var g=0,_=0;_<this.i.length;_++){t:{var R=this.i[_];if("__data__"in R.map&&(R=R.map.__data__,typeof R=="string")){R=R.length;break t}R=void 0}if(R===void 0)break;if(g+=R,4096<g){g=_;break e}if(g===4096||_===this.i.length-1){g=_+1;break e}}g=1e3}else g=1e3;g=Ni(this,Z,g),_=Mn(this.I),Rt(_,"RID",u),Rt(_,"CVER",22),this.D&&Rt(_,"X-HTTP-Session-Id",this.D),ni(this,_),oe&&(this.O?g="headers="+encodeURIComponent(String(kt(oe)))+"&"+g:this.m&&Dt(_,this.m,oe)),Me(this.h,Z),this.Ua&&Rt(_,"TYPE","init"),this.P?(Rt(_,"$req",g),Rt(_,"SID","null"),Z.T=!0,Ln(Z,_,null)):Ln(Z,_,g),this.G=2}}else this.G==3&&(u?Za(this,u):this.i.length==0||G(this.h)||Za(this))};function Za(u,g){var _;g?_=g.l:_=u.U++;const R=Mn(u.I);Rt(R,"SID",u.K),Rt(R,"RID",_),Rt(R,"AID",u.T),ni(u,R),u.m&&u.o&&Dt(R,u.m,u.o),_=new Vn(u,u.j,_,u.B+1),u.m===null&&(_.H=u.o),g&&(u.i=g.D.concat(u.i)),g=Ni(u,_,1e3),_.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),Me(u.h,_),Ln(_,R,g)}function ni(u,g){u.H&&ie(u.H,function(_,R){Rt(g,R,_)}),u.l&&Re({},function(_,R){Rt(g,R,_)})}function Ni(u,g,_){_=Math.min(u.i.length,_);var R=u.l?C(u.l.Na,u.l,u):null;e:{var Z=u.i;let oe=-1;for(;;){const Ve=["count="+_];oe==-1?0<_?(oe=Z[0].g,Ve.push("ofs="+oe)):oe=0:Ve.push("ofs="+oe);let Vt=!0;for(let En=0;En<_;En++){let Tt=Z[En].g;const Pn=Z[En].map;if(Tt-=oe,0>Tt)oe=Math.max(0,Z[En].g-100),Vt=!1;else try{be(Pn,Ve,"req"+Tt+"_")}catch{R&&R(Pn)}}if(Vt){R=Ve.join("&");break e}}}return u=u.i.splice(0,_),g.D=u,R}function _a(u){if(!u.g&&!u.u){u.Y=1;var g=u.Fa;fe||xe(),le||(fe(),le=!0),Pe.add(g,u),u.v=0}}function eo(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=vn(C(u.Fa,u),_c(u,u.v)),u.v++,!0)}n.Fa=function(){if(this.u=null,vc(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=vn(C(this.ab,this),u)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,st(10),xs(this),vc(this))};function rl(u){u.A!=null&&(f.clearTimeout(u.A),u.A=null)}function vc(u){u.g=new Vn(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var g=Mn(u.qa);Rt(g,"RID","rpc"),Rt(g,"SID",u.K),Rt(g,"AID",u.T),Rt(g,"CI",u.F?"0":"1"),!u.F&&u.ja&&Rt(g,"TO",u.ja),Rt(g,"TYPE","xmlhttp"),ni(u,g),u.m&&u.o&&Dt(g,u.m,u.o),u.L&&(u.g.I=u.L);var _=u.g;u=u.ia,_.L=1,_.v=Pt(Mn(g)),_.m=null,_.P=!0,Vs(_,u)}n.Za=function(){this.C!=null&&(this.C=null,xs(this),eo(this),st(19))};function to(u){u.C!=null&&(f.clearTimeout(u.C),u.C=null)}function no(u,g){var _=null;if(u.g==g){to(u),rl(u),u.g=null;var R=2}else if(te(u.h,g))_=g.D,Ne(u.h,g),R=1;else return;if(u.G!=0){if(g.o)if(R==1){_=g.m?g.m.length:0,g=Date.now()-g.F;var Z=u.B;R=Gr(),Bt(R,new ks(R,_)),Os(u)}else _a(u);else if(Z=g.s,Z==3||Z==0&&0<g.X||!(R==1&&Dd(u,g)||R==2&&eo(u)))switch(_&&0<_.length&&(g=u.h,g.i=g.i.concat(_)),Z){case 1:ri(u,5);break;case 4:ri(u,10);break;case 3:ri(u,6);break;default:ri(u,2)}}}function _c(u,g){let _=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(_*=2),_*g}function ri(u,g){if(u.j.info("Error code "+g),g==2){var _=C(u.fb,u),R=u.Xa;const Z=!R;R=new fr(R||"//www.google.com/images/cleardot.gif"),f.location&&f.location.protocol=="http"||pr(R,"https"),Pt(R),Z?T(R.toString(),_):$(R.toString(),_)}else st(2);u.G=0,u.l&&u.l.sa(g),xc(u),Xa(u)}n.fb=function(u){u?(this.j.info("Successfully pinged google.com"),st(2)):(this.j.info("Failed to ping google.com"),st(1))};function xc(u){if(u.G=0,u.ka=[],u.l){const g=$e(u.h);(g.length!=0||u.i.length!=0)&&(U(u.ka,g),U(u.ka,u.i),u.h.i.length=0,B(u.i),u.i.length=0),u.l.ra()}}function wc(u,g,_){var R=_ instanceof fr?Mn(_):new fr(_);if(R.g!="")g&&(R.g=g+"."+R.g),Zr(R,R.s);else{var Z=f.location;R=Z.protocol,g=g?g+"."+Z.hostname:Z.hostname,Z=+Z.port;var oe=new fr(null);R&&pr(oe,R),g&&(oe.g=g),Z&&Zr(oe,Z),_&&(oe.l=_),R=oe}return _=u.D,g=u.ya,_&&g&&Rt(R,_,g),Rt(R,"VER",u.la),ni(u,R),R}function Ec(u,g,_){if(g&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return g=u.Ca&&!u.pa?new wt(new Be({eb:_})):new wt(u.pa),g.Ha(u.J),g}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function sl(){}n=sl.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function ro(){}ro.prototype.g=function(u,g){return new gr(u,g)};function gr(u,g){jt.call(this),this.g=new nl(g),this.l=u,this.h=g&&g.messageUrlParams||null,u=g&&g.messageHeaders||null,g&&g.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=g&&g.initMessageHeaders||null,g&&g.messageContentType&&(u?u["X-WebChannel-Content-Type"]=g.messageContentType:u={"X-WebChannel-Content-Type":g.messageContentType}),g&&g.va&&(u?u["X-WebChannel-Client-Profile"]=g.va:u={"X-WebChannel-Client-Profile":g.va}),this.g.S=u,(u=g&&g.Sb)&&!we(u)&&(this.g.m=u),this.v=g&&g.supportsCrossDomainXhr||!1,this.u=g&&g.sendRawJson||!1,(g=g&&g.httpSessionIdParam)&&!we(g)&&(this.g.D=g,u=this.h,u!==null&&g in u&&(u=this.h,g in u&&delete u[g])),this.j=new Fs(this)}X(gr,jt),gr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},gr.prototype.close=function(){Un(this.g)},gr.prototype.o=function(u){var g=this.g;if(typeof u=="string"){var _={};_.__data__=u,u=_}else this.u&&(_={},_.__data__=cn(u),u=_);g.i.push(new W(g.Ya++,u)),g.G==3&&Os(g)},gr.prototype.N=function(){this.g.l=null,delete this.j,Un(this.g),delete this.g,gr.aa.N.call(this)};function Tc(u){Nn.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var g=u.__sm__;if(g){e:{for(const _ in g){u=_;break e}u=void 0}(this.i=u)&&(u=this.i,g=g!==null&&u in g?g[u]:void 0),this.data=g}else this.data=u}X(Tc,Nn);function Sc(){Wr.call(this),this.status=1}X(Sc,Wr);function Fs(u){this.g=u}X(Fs,sl),Fs.prototype.ua=function(){Bt(this.g,"a")},Fs.prototype.ta=function(u){Bt(this.g,new Tc(u))},Fs.prototype.sa=function(u){Bt(this.g,new Sc)},Fs.prototype.ra=function(){Bt(this.g,"b")},ro.prototype.createWebChannel=ro.prototype.g,gr.prototype.send=gr.prototype.o,gr.prototype.open=gr.prototype.m,gr.prototype.close=gr.prototype.close,U0=function(){return new ro},F0=function(){return Gr()},O0=ur,Vf={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Jn.NO_ERROR=0,Jn.TIMEOUT=8,Jn.HTTP_ERROR=6,Ru=Jn,Xn.COMPLETE="complete",M0=Xn,Br.EventType=Qn,Qn.OPEN="a",Qn.CLOSE="b",Qn.ERROR="c",Qn.MESSAGE="d",jt.prototype.listen=jt.prototype.K,kl=Br,wt.prototype.listenOnce=wt.prototype.L,wt.prototype.getLastError=wt.prototype.Ka,wt.prototype.getLastErrorCode=wt.prototype.Ba,wt.prototype.getStatus=wt.prototype.Z,wt.prototype.getResponseJson=wt.prototype.Oa,wt.prototype.getResponseText=wt.prototype.oa,wt.prototype.send=wt.prototype.ea,wt.prototype.setWithCredentials=wt.prototype.Ha,L0=wt}).apply(typeof _u<"u"?_u:typeof self<"u"?self:typeof window<"u"?window:{});const uv="@firebase/firestore",dv="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ar{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ar.UNAUTHENTICATED=new ar(null),ar.GOOGLE_CREDENTIALS=new ar("google-credentials-uid"),ar.FIRST_PARTY=new ar("first-party-uid"),ar.MOCK_USER=new ar("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Jo="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ga=new lp("@firebase/firestore");function Po(){return Ga.logLevel}function ze(n,...e){if(Ga.logLevel<=yt.DEBUG){const t=e.map(Ep);Ga.debug(`Firestore (${Jo}): ${n}`,...t)}}function xi(n,...e){if(Ga.logLevel<=yt.ERROR){const t=e.map(Ep);Ga.error(`Firestore (${Jo}): ${n}`,...t)}}function ra(n,...e){if(Ga.logLevel<=yt.WARN){const t=e.map(Ep);Ga.warn(`Firestore (${Jo}): ${n}`,...t)}}function Ep(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rt(n,e,t){let s="Unexpected state";typeof e=="string"?s=e:t=e,z0(n,s,t)}function z0(n,e,t){let s=`FIRESTORE (${Jo}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{s+=" CONTEXT: "+JSON.stringify(t)}catch{s+=" CONTEXT: "+t}throw xi(s),new Error(s)}function At(n,e,t,s){let a="Unexpected state";typeof t=="string"?a=t:s=t,n||z0(e,a,s)}function lt(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Fe extends Si{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gi{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $0{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class FC{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(ar.UNAUTHENTICATED)))}shutdown(){}}class UC{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class zC{constructor(e){this.t=e,this.currentUser=ar.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){At(this.o===void 0,42304);let s=this.i;const a=m=>this.i!==s?(s=this.i,t(m)):Promise.resolve();let l=new gi;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new gi,e.enqueueRetryable((()=>a(this.currentUser)))};const d=()=>{const m=l;e.enqueueRetryable((async()=>{await m.promise,await a(this.currentUser)}))},f=m=>{ze("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=m,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit((m=>f(m))),setTimeout((()=>{if(!this.auth){const m=this.t.getImmediate({optional:!0});m?f(m):(ze("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new gi)}}),0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((s=>this.i!==e?(ze("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(At(typeof s.accessToken=="string",31837,{l:s}),new $0(s.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return At(e===null||typeof e=="string",2055,{h:e}),new ar(e)}}class $C{constructor(e,t,s){this.P=e,this.T=t,this.I=s,this.type="FirstParty",this.user=ar.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class BC{constructor(e,t,s){this.P=e,this.T=t,this.I=s}getToken(){return Promise.resolve(new $C(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(ar.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class hv{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class WC{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,zr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){At(this.o===void 0,3512);const s=l=>{l.error!=null&&ze("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const d=l.token!==this.m;return this.m=l.token,ze("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?t(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable((()=>s(l)))};const a=l=>{ze("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((l=>a(l))),setTimeout((()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?a(l):ze("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new hv(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(At(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new hv(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GC(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let s=0;s<n;s++)t[s]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B0(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tp{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let s="";for(;s.length<20;){const a=GC(40);for(let l=0;l<a.length;++l)s.length<20&&a[l]<t&&(s+=e.charAt(a[l]%62))}return s}}function ft(n,e){return n<e?-1:n>e?1:0}function Lf(n,e){let t=0;for(;t<n.length&&t<e.length;){const s=n.codePointAt(t),a=e.codePointAt(t);if(s!==a){if(s<128&&a<128)return ft(s,a);{const l=B0(),d=qC(l.encode(fv(n,t)),l.encode(fv(e,t)));return d!==0?d:ft(s,a)}}t+=s>65535?2:1}return ft(n.length,e.length)}function fv(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function qC(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return ft(n[t],e[t]);return ft(n.length,e.length)}function Fo(n,e,t){return n.length===e.length&&n.every(((s,a)=>t(s,e[a])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pv="__name__";class Ws{constructor(e,t,s){t===void 0?t=0:t>e.length&&rt(637,{offset:t,range:e.length}),s===void 0?s=e.length-t:s>e.length-t&&rt(1746,{length:s,range:e.length-t}),this.segments=e,this.offset=t,this.len=s}get length(){return this.len}isEqual(e){return Ws.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ws?e.forEach((s=>{t.push(s)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,s=this.limit();t<s;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const s=Math.min(e.length,t.length);for(let a=0;a<s;a++){const l=Ws.compareSegments(e.get(a),t.get(a));if(l!==0)return l}return ft(e.length,t.length)}static compareSegments(e,t){const s=Ws.isNumericId(e),a=Ws.isNumericId(t);return s&&!a?-1:!s&&a?1:s&&a?Ws.extractNumericId(e).compare(Ws.extractNumericId(t)):Lf(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ta.fromString(e.substring(4,e.length-2))}}class $t extends Ws{construct(e,t,s){return new $t(e,t,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const s of e){if(s.indexOf("//")>=0)throw new Fe(pe.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);t.push(...s.split("/").filter((a=>a.length>0)))}return new $t(t)}static emptyPath(){return new $t([])}}const HC=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Wn extends Ws{construct(e,t,s){return new Wn(e,t,s)}static isValidIdentifier(e){return HC.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Wn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===pv}static keyField(){return new Wn([pv])}static fromServerFormat(e){const t=[];let s="",a=0;const l=()=>{if(s.length===0)throw new Fe(pe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(s),s=""};let d=!1;for(;a<e.length;){const f=e[a];if(f==="\\"){if(a+1===e.length)throw new Fe(pe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const m=e[a+1];if(m!=="\\"&&m!=="."&&m!=="`")throw new Fe(pe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=m,a+=2}else f==="`"?(d=!d,a++):f!=="."||d?(s+=f,a++):(l(),a++)}if(l(),d)throw new Fe(pe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Wn(t)}static emptyPath(){return new Wn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ye{constructor(e){this.path=e}static fromPath(e){return new Ye($t.fromString(e))}static fromName(e){return new Ye($t.fromString(e).popFirst(5))}static empty(){return new Ye($t.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&$t.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return $t.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ye(new $t(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W0(n,e,t){if(!t)throw new Fe(pe.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function KC(n,e,t,s){if(e===!0&&s===!0)throw new Fe(pe.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function mv(n){if(!Ye.isDocumentKey(n))throw new Fe(pe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function gv(n){if(Ye.isDocumentKey(n))throw new Fe(pe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function G0(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function hd(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(s){return s.constructor?s.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":rt(12329,{type:typeof n})}function Vr(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Fe(pe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=hd(n);throw new Fe(pe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gn(n,e){const t={typeString:n};return e&&(t.value=e),t}function cc(n,e){if(!G0(n))throw new Fe(pe.INVALID_ARGUMENT,"JSON must be an object");let t;for(const s in e)if(e[s]){const a=e[s].typeString,l="value"in e[s]?{value:e[s].value}:void 0;if(!(s in n)){t=`JSON missing required field: '${s}'`;break}const d=n[s];if(a&&typeof d!==a){t=`JSON field '${s}' must be a ${a}.`;break}if(l!==void 0&&d!==l.value){t=`Expected '${s}' field to equal '${l.value}'`;break}}if(t)throw new Fe(pe.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yv=-62135596800,vv=1e6;class Ht{static now(){return Ht.fromMillis(Date.now())}static fromDate(e){return Ht.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),s=Math.floor((e-1e3*t)*vv);return new Ht(t,s)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Fe(pe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Fe(pe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<yv)throw new Fe(pe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Fe(pe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/vv}_compareTo(e){return this.seconds===e.seconds?ft(this.nanoseconds,e.nanoseconds):ft(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Ht._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(cc(e,Ht._jsonSchema))return new Ht(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-yv;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Ht._jsonSchemaVersion="firestore/timestamp/1.0",Ht._jsonSchema={type:gn("string",Ht._jsonSchemaVersion),seconds:gn("number"),nanoseconds:gn("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ot{static fromTimestamp(e){return new ot(e)}static min(){return new ot(new Ht(0,0))}static max(){return new ot(new Ht(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ql=-1;function QC(n,e){const t=n.toTimestamp().seconds,s=n.toTimestamp().nanoseconds+1,a=ot.fromTimestamp(s===1e9?new Ht(t+1,0):new Ht(t,s));return new sa(a,Ye.empty(),e)}function YC(n){return new sa(n.readTime,n.key,Ql)}class sa{constructor(e,t,s){this.readTime=e,this.documentKey=t,this.largestBatchId=s}static min(){return new sa(ot.min(),Ye.empty(),Ql)}static max(){return new sa(ot.max(),Ye.empty(),Ql)}}function JC(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Ye.comparator(n.documentKey,e.documentKey),t!==0?t:ft(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XC="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class ZC{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xo(n){if(n.code!==pe.FAILED_PRECONDITION||n.message!==XC)throw n;ze("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ye{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&rt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ye(((s,a)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(s,a)},this.catchCallback=l=>{this.wrapFailure(t,l).next(s,a)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof ye?t:ye.resolve(t)}catch(t){return ye.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):ye.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):ye.reject(t)}static resolve(e){return new ye(((t,s)=>{t(e)}))}static reject(e){return new ye(((t,s)=>{s(e)}))}static waitFor(e){return new ye(((t,s)=>{let a=0,l=0,d=!1;e.forEach((f=>{++a,f.next((()=>{++l,d&&l===a&&t()}),(m=>s(m)))})),d=!0,l===a&&t()}))}static or(e){let t=ye.resolve(!1);for(const s of e)t=t.next((a=>a?ye.resolve(a):s()));return t}static forEach(e,t){const s=[];return e.forEach(((a,l)=>{s.push(t.call(this,a,l))})),this.waitFor(s)}static mapArray(e,t){return new ye(((s,a)=>{const l=e.length,d=new Array(l);let f=0;for(let m=0;m<l;m++){const y=m;t(e[y]).next((x=>{d[y]=x,++f,f===l&&s(d)}),(x=>a(x)))}}))}static doWhile(e,t){return new ye(((s,a)=>{const l=()=>{e()===!0?t().next((()=>{l()}),a):s()};l()}))}}function eI(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Zo(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fd{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=s=>this._e(s),this.ae=s=>t.writeSequenceNumber(s))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}}fd.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sp=-1;function pd(n){return n==null}function Hu(n){return n===0&&1/n==-1/0}function tI(n){return typeof n=="number"&&Number.isInteger(n)&&!Hu(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q0="";function nI(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=_v(e)),e=rI(n.get(t),e);return _v(e)}function rI(n,e){let t=e;const s=n.length;for(let a=0;a<s;a++){const l=n.charAt(a);switch(l){case"\0":t+="";break;case q0:t+="";break;default:t+=l}}return t}function _v(n){return n+q0+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xv(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function pa(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function H0(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xt{constructor(e,t){this.comparator=e,this.root=t||Bn.EMPTY}insert(e,t){return new Xt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Bn.BLACK,null,null))}remove(e){return new Xt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Bn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const s=this.comparator(e,t.key);if(s===0)return t.value;s<0?t=t.left:s>0&&(t=t.right)}return null}indexOf(e){let t=0,s=this.root;for(;!s.isEmpty();){const a=this.comparator(e,s.key);if(a===0)return t+s.left.size;a<0?s=s.left:(t+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,s)=>(e(t,s),!1)))}toString(){const e=[];return this.inorderTraversal(((t,s)=>(e.push(`${t}:${s}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new xu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new xu(this.root,e,this.comparator,!1)}getReverseIterator(){return new xu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new xu(this.root,e,this.comparator,!0)}}class xu{constructor(e,t,s,a){this.isReverse=a,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=t?s(e.key,t):1,t&&a&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Bn{constructor(e,t,s,a,l){this.key=e,this.value=t,this.color=s??Bn.RED,this.left=a??Bn.EMPTY,this.right=l??Bn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,s,a,l){return new Bn(e??this.key,t??this.value,s??this.color,a??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,s){let a=this;const l=s(e,a.key);return a=l<0?a.copy(null,null,null,a.left.insert(e,t,s),null):l===0?a.copy(null,t,null,null,null):a.copy(null,null,null,null,a.right.insert(e,t,s)),a.fixUp()}removeMin(){if(this.left.isEmpty())return Bn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let s,a=this;if(t(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,t),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),t(e,a.key)===0){if(a.right.isEmpty())return Bn.EMPTY;s=a.right.min(),a=a.copy(s.key,s.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,t))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Bn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Bn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw rt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw rt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw rt(27949);return e+(this.isRed()?0:1)}}Bn.EMPTY=null,Bn.RED=!0,Bn.BLACK=!1;Bn.EMPTY=new class{constructor(){this.size=0}get key(){throw rt(57766)}get value(){throw rt(16141)}get color(){throw rt(16727)}get left(){throw rt(29726)}get right(){throw rt(36894)}copy(e,t,s,a,l){return this}insert(e,t,s){return new Bn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cn{constructor(e){this.comparator=e,this.data=new Xt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,s)=>(e(t),!1)))}forEachInRange(e,t){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const a=s.getNext();if(this.comparator(a.key,e[1])>=0)return;t(a.key)}}forEachWhile(e,t){let s;for(s=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new wv(this.data.getIterator())}getIteratorFrom(e){return new wv(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((s=>{t=t.add(s)})),t}isEqual(e){if(!(e instanceof Cn)||this.size!==e.size)return!1;const t=this.data.getIterator(),s=e.data.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=s.getNext().key;if(this.comparator(a,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Cn(this.comparator);return t.data=e,t}}class wv{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $r{constructor(e){this.fields=e,e.sort(Wn.comparator)}static empty(){return new $r([])}unionWith(e){let t=new Cn(Wn.comparator);for(const s of this.fields)t=t.add(s);for(const s of e)t=t.add(s);return new $r(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Fo(this.fields,e.fields,((t,s)=>t.isEqual(s)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K0 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(a){try{return atob(a)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new K0("Invalid base64 string: "+l):l}})(e);return new Gn(t)}static fromUint8Array(e){const t=(function(a){let l="";for(let d=0;d<a.length;++d)l+=String.fromCharCode(a[d]);return l})(e);return new Gn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const s=new Uint8Array(t.length);for(let a=0;a<t.length;a++)s[a]=t.charCodeAt(a);return s})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ft(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Gn.EMPTY_BYTE_STRING=new Gn("");const sI=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ia(n){if(At(!!n,39018),typeof n=="string"){let e=0;const t=sI.exec(n);if(At(!!t,46558,{timestamp:n}),t[1]){let a=t[1];a=(a+"000000000").substr(0,9),e=Number(a)}const s=new Date(n);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:on(n.seconds),nanos:on(n.nanos)}}function on(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function aa(n){return typeof n=="string"?Gn.fromBase64String(n):Gn.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q0="server_timestamp",Y0="__type__",J0="__previous_value__",X0="__local_write_time__";function bp(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[Y0])===null||t===void 0?void 0:t.stringValue)===Q0}function md(n){const e=n.mapValue.fields[J0];return bp(e)?md(e):e}function Yl(n){const e=ia(n.mapValue.fields[X0].timestampValue);return new Ht(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iI{constructor(e,t,s,a,l,d,f,m,y,x){this.databaseId=e,this.appId=t,this.persistenceKey=s,this.host=a,this.ssl=l,this.forceLongPolling=d,this.autoDetectLongPolling=f,this.longPollingOptions=m,this.useFetchStreams=y,this.isUsingEmulator=x}}const Ku="(default)";class Jl{constructor(e,t){this.projectId=e,this.database=t||Ku}static empty(){return new Jl("","")}get isDefaultDatabase(){return this.database===Ku}isEqual(e){return e instanceof Jl&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z0="__type__",aI="__max__",wu={mapValue:{}},ex="__vector__",Qu="value";function oa(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?bp(n)?4:lI(n)?9007199254740991:oI(n)?10:11:rt(28295,{value:n})}function Ys(n,e){if(n===e)return!0;const t=oa(n);if(t!==oa(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Yl(n).isEqual(Yl(e));case 3:return(function(a,l){if(typeof a.timestampValue=="string"&&typeof l.timestampValue=="string"&&a.timestampValue.length===l.timestampValue.length)return a.timestampValue===l.timestampValue;const d=ia(a.timestampValue),f=ia(l.timestampValue);return d.seconds===f.seconds&&d.nanos===f.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(a,l){return aa(a.bytesValue).isEqual(aa(l.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(a,l){return on(a.geoPointValue.latitude)===on(l.geoPointValue.latitude)&&on(a.geoPointValue.longitude)===on(l.geoPointValue.longitude)})(n,e);case 2:return(function(a,l){if("integerValue"in a&&"integerValue"in l)return on(a.integerValue)===on(l.integerValue);if("doubleValue"in a&&"doubleValue"in l){const d=on(a.doubleValue),f=on(l.doubleValue);return d===f?Hu(d)===Hu(f):isNaN(d)&&isNaN(f)}return!1})(n,e);case 9:return Fo(n.arrayValue.values||[],e.arrayValue.values||[],Ys);case 10:case 11:return(function(a,l){const d=a.mapValue.fields||{},f=l.mapValue.fields||{};if(xv(d)!==xv(f))return!1;for(const m in d)if(d.hasOwnProperty(m)&&(f[m]===void 0||!Ys(d[m],f[m])))return!1;return!0})(n,e);default:return rt(52216,{left:n})}}function Xl(n,e){return(n.values||[]).find((t=>Ys(t,e)))!==void 0}function Uo(n,e){if(n===e)return 0;const t=oa(n),s=oa(e);if(t!==s)return ft(t,s);switch(t){case 0:case 9007199254740991:return 0;case 1:return ft(n.booleanValue,e.booleanValue);case 2:return(function(l,d){const f=on(l.integerValue||l.doubleValue),m=on(d.integerValue||d.doubleValue);return f<m?-1:f>m?1:f===m?0:isNaN(f)?isNaN(m)?0:-1:1})(n,e);case 3:return Ev(n.timestampValue,e.timestampValue);case 4:return Ev(Yl(n),Yl(e));case 5:return Lf(n.stringValue,e.stringValue);case 6:return(function(l,d){const f=aa(l),m=aa(d);return f.compareTo(m)})(n.bytesValue,e.bytesValue);case 7:return(function(l,d){const f=l.split("/"),m=d.split("/");for(let y=0;y<f.length&&y<m.length;y++){const x=ft(f[y],m[y]);if(x!==0)return x}return ft(f.length,m.length)})(n.referenceValue,e.referenceValue);case 8:return(function(l,d){const f=ft(on(l.latitude),on(d.latitude));return f!==0?f:ft(on(l.longitude),on(d.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Tv(n.arrayValue,e.arrayValue);case 10:return(function(l,d){var f,m,y,x;const E=l.fields||{},C=d.fields||{},O=(f=E[Qu])===null||f===void 0?void 0:f.arrayValue,X=(m=C[Qu])===null||m===void 0?void 0:m.arrayValue,B=ft(((y=O==null?void 0:O.values)===null||y===void 0?void 0:y.length)||0,((x=X==null?void 0:X.values)===null||x===void 0?void 0:x.length)||0);return B!==0?B:Tv(O,X)})(n.mapValue,e.mapValue);case 11:return(function(l,d){if(l===wu.mapValue&&d===wu.mapValue)return 0;if(l===wu.mapValue)return 1;if(d===wu.mapValue)return-1;const f=l.fields||{},m=Object.keys(f),y=d.fields||{},x=Object.keys(y);m.sort(),x.sort();for(let E=0;E<m.length&&E<x.length;++E){const C=Lf(m[E],x[E]);if(C!==0)return C;const O=Uo(f[m[E]],y[x[E]]);if(O!==0)return O}return ft(m.length,x.length)})(n.mapValue,e.mapValue);default:throw rt(23264,{le:t})}}function Ev(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ft(n,e);const t=ia(n),s=ia(e),a=ft(t.seconds,s.seconds);return a!==0?a:ft(t.nanos,s.nanos)}function Tv(n,e){const t=n.values||[],s=e.values||[];for(let a=0;a<t.length&&a<s.length;++a){const l=Uo(t[a],s[a]);if(l)return l}return ft(t.length,s.length)}function zo(n){return Mf(n)}function Mf(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const s=ia(t);return`time(${s.seconds},${s.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return aa(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Ye.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let s="[",a=!0;for(const l of t.values||[])a?a=!1:s+=",",s+=Mf(l);return s+"]"})(n.arrayValue):"mapValue"in n?(function(t){const s=Object.keys(t.fields||{}).sort();let a="{",l=!0;for(const d of s)l?l=!1:a+=",",a+=`${d}:${Mf(t.fields[d])}`;return a+"}"})(n.mapValue):rt(61005,{value:n})}function Au(n){switch(oa(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=md(n);return e?16+Au(e):16;case 5:return 2*n.stringValue.length;case 6:return aa(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(s){return(s.values||[]).reduce(((a,l)=>a+Au(l)),0)})(n.arrayValue);case 10:case 11:return(function(s){let a=0;return pa(s.fields,((l,d)=>{a+=l.length+Au(d)})),a})(n.mapValue);default:throw rt(13486,{value:n})}}function Sv(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Of(n){return!!n&&"integerValue"in n}function Cp(n){return!!n&&"arrayValue"in n}function bv(n){return!!n&&"nullValue"in n}function Cv(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function ju(n){return!!n&&"mapValue"in n}function oI(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[Z0])===null||t===void 0?void 0:t.stringValue)===ex}function Ul(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return pa(n.mapValue.fields,((t,s)=>e.mapValue.fields[t]=Ul(s))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Ul(n.arrayValue.values[t]);return e}return Object.assign({},n)}function lI(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===aI}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr{constructor(e){this.value=e}static empty(){return new Dr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let s=0;s<e.length-1;++s)if(t=(t.mapValue.fields||{})[e.get(s)],!ju(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ul(t)}setAll(e){let t=Wn.emptyPath(),s={},a=[];e.forEach(((d,f)=>{if(!t.isImmediateParentOf(f)){const m=this.getFieldsMap(t);this.applyChanges(m,s,a),s={},a=[],t=f.popLast()}d?s[f.lastSegment()]=Ul(d):a.push(f.lastSegment())}));const l=this.getFieldsMap(t);this.applyChanges(l,s,a)}delete(e){const t=this.field(e.popLast());ju(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ys(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let s=0;s<e.length;++s){let a=t.mapValue.fields[e.get(s)];ju(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},t.mapValue.fields[e.get(s)]=a),t=a}return t.mapValue.fields}applyChanges(e,t,s){pa(t,((a,l)=>e[a]=l));for(const a of s)delete e[a]}clone(){return new Dr(Ul(this.value))}}function tx(n){const e=[];return pa(n.fields,((t,s)=>{const a=new Wn([t]);if(ju(s)){const l=tx(s.mapValue).fields;if(l.length===0)e.push(a);else for(const d of l)e.push(a.child(d))}else e.push(a)})),new $r(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class or{constructor(e,t,s,a,l,d,f){this.key=e,this.documentType=t,this.version=s,this.readTime=a,this.createTime=l,this.data=d,this.documentState=f}static newInvalidDocument(e){return new or(e,0,ot.min(),ot.min(),ot.min(),Dr.empty(),0)}static newFoundDocument(e,t,s,a){return new or(e,1,t,ot.min(),s,a,0)}static newNoDocument(e,t){return new or(e,2,t,ot.min(),ot.min(),Dr.empty(),0)}static newUnknownDocument(e,t){return new or(e,3,t,ot.min(),ot.min(),Dr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ot.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Dr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Dr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ot.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof or&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new or(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yu{constructor(e,t){this.position=e,this.inclusive=t}}function Iv(n,e,t){let s=0;for(let a=0;a<n.position.length;a++){const l=e[a],d=n.position[a];if(l.field.isKeyField()?s=Ye.comparator(Ye.fromName(d.referenceValue),t.key):s=Uo(d,t.data.field(l.field)),l.dir==="desc"&&(s*=-1),s!==0)break}return s}function Nv(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Ys(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zl{constructor(e,t="asc"){this.field=e,this.dir=t}}function cI(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nx{}class mn extends nx{constructor(e,t,s){super(),this.field=e,this.op=t,this.value=s}static create(e,t,s){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,s):new dI(e,t,s):t==="array-contains"?new pI(e,s):t==="in"?new mI(e,s):t==="not-in"?new gI(e,s):t==="array-contains-any"?new yI(e,s):new mn(e,t,s)}static createKeyFieldInFilter(e,t,s){return t==="in"?new hI(e,s):new fI(e,s)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Uo(t,this.value)):t!==null&&oa(this.value)===oa(t)&&this.matchesComparison(Uo(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return rt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class js extends nx{constructor(e,t){super(),this.filters=e,this.op=t,this.he=null}static create(e,t){return new js(e,t)}matches(e){return rx(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function rx(n){return n.op==="and"}function sx(n){return uI(n)&&rx(n)}function uI(n){for(const e of n.filters)if(e instanceof js)return!1;return!0}function Ff(n){if(n instanceof mn)return n.field.canonicalString()+n.op.toString()+zo(n.value);if(sx(n))return n.filters.map((e=>Ff(e))).join(",");{const e=n.filters.map((t=>Ff(t))).join(",");return`${n.op}(${e})`}}function ix(n,e){return n instanceof mn?(function(s,a){return a instanceof mn&&s.op===a.op&&s.field.isEqual(a.field)&&Ys(s.value,a.value)})(n,e):n instanceof js?(function(s,a){return a instanceof js&&s.op===a.op&&s.filters.length===a.filters.length?s.filters.reduce(((l,d,f)=>l&&ix(d,a.filters[f])),!0):!1})(n,e):void rt(19439)}function ax(n){return n instanceof mn?(function(t){return`${t.field.canonicalString()} ${t.op} ${zo(t.value)}`})(n):n instanceof js?(function(t){return t.op.toString()+" {"+t.getFilters().map(ax).join(" ,")+"}"})(n):"Filter"}class dI extends mn{constructor(e,t,s){super(e,t,s),this.key=Ye.fromName(s.referenceValue)}matches(e){const t=Ye.comparator(e.key,this.key);return this.matchesComparison(t)}}class hI extends mn{constructor(e,t){super(e,"in",t),this.keys=ox("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class fI extends mn{constructor(e,t){super(e,"not-in",t),this.keys=ox("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function ox(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map((s=>Ye.fromName(s.referenceValue)))}class pI extends mn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Cp(t)&&Xl(t.arrayValue,this.value)}}class mI extends mn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Xl(this.value.arrayValue,t)}}class gI extends mn{constructor(e,t){super(e,"not-in",t)}matches(e){if(Xl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Xl(this.value.arrayValue,t)}}class yI extends mn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Cp(t)||!t.arrayValue.values)&&t.arrayValue.values.some((s=>Xl(this.value.arrayValue,s)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vI{constructor(e,t=null,s=[],a=[],l=null,d=null,f=null){this.path=e,this.collectionGroup=t,this.orderBy=s,this.filters=a,this.limit=l,this.startAt=d,this.endAt=f,this.Pe=null}}function Pv(n,e=null,t=[],s=[],a=null,l=null,d=null){return new vI(n,e,t,s,a,l,d)}function Ip(n){const e=lt(n);if(e.Pe===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((s=>Ff(s))).join(","),t+="|ob:",t+=e.orderBy.map((s=>(function(l){return l.field.canonicalString()+l.dir})(s))).join(","),pd(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((s=>zo(s))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((s=>zo(s))).join(",")),e.Pe=t}return e.Pe}function Np(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!cI(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!ix(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Nv(n.startAt,e.startAt)&&Nv(n.endAt,e.endAt)}function Uf(n){return Ye.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class el{constructor(e,t=null,s=[],a=[],l=null,d="F",f=null,m=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=s,this.filters=a,this.limit=l,this.limitType=d,this.startAt=f,this.endAt=m,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function _I(n,e,t,s,a,l,d,f){return new el(n,e,t,s,a,l,d,f)}function gd(n){return new el(n)}function Rv(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function lx(n){return n.collectionGroup!==null}function zl(n){const e=lt(n);if(e.Te===null){e.Te=[];const t=new Set;for(const l of e.explicitOrderBy)e.Te.push(l),t.add(l.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let f=new Cn(Wn.comparator);return d.filters.forEach((m=>{m.getFlattenedFilters().forEach((y=>{y.isInequality()&&(f=f.add(y.field))}))})),f})(e).forEach((l=>{t.has(l.canonicalString())||l.isKeyField()||e.Te.push(new Zl(l,s))})),t.has(Wn.keyField().canonicalString())||e.Te.push(new Zl(Wn.keyField(),s))}return e.Te}function qs(n){const e=lt(n);return e.Ie||(e.Ie=xI(e,zl(n))),e.Ie}function xI(n,e){if(n.limitType==="F")return Pv(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((a=>{const l=a.dir==="desc"?"asc":"desc";return new Zl(a.field,l)}));const t=n.endAt?new Yu(n.endAt.position,n.endAt.inclusive):null,s=n.startAt?new Yu(n.startAt.position,n.startAt.inclusive):null;return Pv(n.path,n.collectionGroup,e,n.filters,n.limit,t,s)}}function zf(n,e){const t=n.filters.concat([e]);return new el(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Ju(n,e,t){return new el(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function yd(n,e){return Np(qs(n),qs(e))&&n.limitType===e.limitType}function cx(n){return`${Ip(qs(n))}|lt:${n.limitType}`}function Ro(n){return`Query(target=${(function(t){let s=t.path.canonicalString();return t.collectionGroup!==null&&(s+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(s+=`, filters: [${t.filters.map((a=>ax(a))).join(", ")}]`),pd(t.limit)||(s+=", limit: "+t.limit),t.orderBy.length>0&&(s+=`, orderBy: [${t.orderBy.map((a=>(function(d){return`${d.field.canonicalString()} (${d.dir})`})(a))).join(", ")}]`),t.startAt&&(s+=", startAt: ",s+=t.startAt.inclusive?"b:":"a:",s+=t.startAt.position.map((a=>zo(a))).join(",")),t.endAt&&(s+=", endAt: ",s+=t.endAt.inclusive?"a:":"b:",s+=t.endAt.position.map((a=>zo(a))).join(",")),`Target(${s})`})(qs(n))}; limitType=${n.limitType})`}function vd(n,e){return e.isFoundDocument()&&(function(s,a){const l=a.key.path;return s.collectionGroup!==null?a.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(l):Ye.isDocumentKey(s.path)?s.path.isEqual(l):s.path.isImmediateParentOf(l)})(n,e)&&(function(s,a){for(const l of zl(s))if(!l.field.isKeyField()&&a.data.field(l.field)===null)return!1;return!0})(n,e)&&(function(s,a){for(const l of s.filters)if(!l.matches(a))return!1;return!0})(n,e)&&(function(s,a){return!(s.startAt&&!(function(d,f,m){const y=Iv(d,f,m);return d.inclusive?y<=0:y<0})(s.startAt,zl(s),a)||s.endAt&&!(function(d,f,m){const y=Iv(d,f,m);return d.inclusive?y>=0:y>0})(s.endAt,zl(s),a))})(n,e)}function wI(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function ux(n){return(e,t)=>{let s=!1;for(const a of zl(n)){const l=EI(a,e,t);if(l!==0)return l;s=s||a.field.isKeyField()}return 0}}function EI(n,e,t){const s=n.field.isKeyField()?Ye.comparator(e.key,t.key):(function(l,d,f){const m=d.data.field(l),y=f.data.field(l);return m!==null&&y!==null?Uo(m,y):rt(42886)})(n.field,e,t);switch(n.dir){case"asc":return s;case"desc":return-1*s;default:return rt(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ha{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s!==void 0){for(const[a,l]of s)if(this.equalsFn(a,e))return l}}has(e){return this.get(e)!==void 0}set(e,t){const s=this.mapKeyFn(e),a=this.inner[s];if(a===void 0)return this.inner[s]=[[e,t]],void this.innerSize++;for(let l=0;l<a.length;l++)if(this.equalsFn(a[l][0],e))return void(a[l]=[e,t]);a.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s===void 0)return!1;for(let a=0;a<s.length;a++)if(this.equalsFn(s[a][0],e))return s.length===1?delete this.inner[t]:s.splice(a,1),this.innerSize--,!0;return!1}forEach(e){pa(this.inner,((t,s)=>{for(const[a,l]of s)e(a,l)}))}isEmpty(){return H0(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TI=new Xt(Ye.comparator);function wi(){return TI}const dx=new Xt(Ye.comparator);function Dl(...n){let e=dx;for(const t of n)e=e.insert(t.key,t);return e}function hx(n){let e=dx;return n.forEach(((t,s)=>e=e.insert(t,s.overlayedDocument))),e}function La(){return $l()}function fx(){return $l()}function $l(){return new Ha((n=>n.toString()),((n,e)=>n.isEqual(e)))}const SI=new Xt(Ye.comparator),bI=new Cn(Ye.comparator);function vt(...n){let e=bI;for(const t of n)e=e.add(t);return e}const CI=new Cn(ft);function II(){return CI}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pp(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Hu(e)?"-0":e}}function px(n){return{integerValue:""+n}}function NI(n,e){return tI(e)?px(e):Pp(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _d{constructor(){this._=void 0}}function PI(n,e,t){return n instanceof ec?(function(a,l){const d={fields:{[Y0]:{stringValue:Q0},[X0]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return l&&bp(l)&&(l=md(l)),l&&(d.fields[J0]=l),{mapValue:d}})(t,e):n instanceof tc?gx(n,e):n instanceof nc?yx(n,e):(function(a,l){const d=mx(a,l),f=Av(d)+Av(a.Ee);return Of(d)&&Of(a.Ee)?px(f):Pp(a.serializer,f)})(n,e)}function RI(n,e,t){return n instanceof tc?gx(n,e):n instanceof nc?yx(n,e):t}function mx(n,e){return n instanceof Xu?(function(s){return Of(s)||(function(l){return!!l&&"doubleValue"in l})(s)})(e)?e:{integerValue:0}:null}class ec extends _d{}class tc extends _d{constructor(e){super(),this.elements=e}}function gx(n,e){const t=vx(e);for(const s of n.elements)t.some((a=>Ys(a,s)))||t.push(s);return{arrayValue:{values:t}}}class nc extends _d{constructor(e){super(),this.elements=e}}function yx(n,e){let t=vx(e);for(const s of n.elements)t=t.filter((a=>!Ys(a,s)));return{arrayValue:{values:t}}}class Xu extends _d{constructor(e,t){super(),this.serializer=e,this.Ee=t}}function Av(n){return on(n.integerValue||n.doubleValue)}function vx(n){return Cp(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AI{constructor(e,t){this.field=e,this.transform=t}}function jI(n,e){return n.field.isEqual(e.field)&&(function(s,a){return s instanceof tc&&a instanceof tc||s instanceof nc&&a instanceof nc?Fo(s.elements,a.elements,Ys):s instanceof Xu&&a instanceof Xu?Ys(s.Ee,a.Ee):s instanceof ec&&a instanceof ec})(n.transform,e.transform)}class kI{constructor(e,t){this.version=e,this.transformResults=t}}class ms{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new ms}static exists(e){return new ms(void 0,e)}static updateTime(e){return new ms(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ku(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class xd{}function _x(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Rp(n.key,ms.none()):new uc(n.key,n.data,ms.none());{const t=n.data,s=Dr.empty();let a=new Cn(Wn.comparator);for(let l of e.fields)if(!a.has(l)){let d=t.field(l);d===null&&l.length>1&&(l=l.popLast(),d=t.field(l)),d===null?s.delete(l):s.set(l,d),a=a.add(l)}return new ma(n.key,s,new $r(a.toArray()),ms.none())}}function DI(n,e,t){n instanceof uc?(function(a,l,d){const f=a.value.clone(),m=kv(a.fieldTransforms,l,d.transformResults);f.setAll(m),l.convertToFoundDocument(d.version,f).setHasCommittedMutations()})(n,e,t):n instanceof ma?(function(a,l,d){if(!ku(a.precondition,l))return void l.convertToUnknownDocument(d.version);const f=kv(a.fieldTransforms,l,d.transformResults),m=l.data;m.setAll(xx(a)),m.setAll(f),l.convertToFoundDocument(d.version,m).setHasCommittedMutations()})(n,e,t):(function(a,l,d){l.convertToNoDocument(d.version).setHasCommittedMutations()})(0,e,t)}function Bl(n,e,t,s){return n instanceof uc?(function(l,d,f,m){if(!ku(l.precondition,d))return f;const y=l.value.clone(),x=Dv(l.fieldTransforms,m,d);return y.setAll(x),d.convertToFoundDocument(d.version,y).setHasLocalMutations(),null})(n,e,t,s):n instanceof ma?(function(l,d,f,m){if(!ku(l.precondition,d))return f;const y=Dv(l.fieldTransforms,m,d),x=d.data;return x.setAll(xx(l)),x.setAll(y),d.convertToFoundDocument(d.version,x).setHasLocalMutations(),f===null?null:f.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((E=>E.field)))})(n,e,t,s):(function(l,d,f){return ku(l.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):f})(n,e,t)}function VI(n,e){let t=null;for(const s of n.fieldTransforms){const a=e.data.field(s.field),l=mx(s.transform,a||null);l!=null&&(t===null&&(t=Dr.empty()),t.set(s.field,l))}return t||null}function jv(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(s,a){return s===void 0&&a===void 0||!(!s||!a)&&Fo(s,a,((l,d)=>jI(l,d)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class uc extends xd{constructor(e,t,s,a=[]){super(),this.key=e,this.value=t,this.precondition=s,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class ma extends xd{constructor(e,t,s,a,l=[]){super(),this.key=e,this.data=t,this.fieldMask=s,this.precondition=a,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function xx(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const s=n.data.field(t);e.set(t,s)}})),e}function kv(n,e,t){const s=new Map;At(n.length===t.length,32656,{Ae:t.length,Re:n.length});for(let a=0;a<t.length;a++){const l=n[a],d=l.transform,f=e.data.field(l.field);s.set(l.field,RI(d,f,t[a]))}return s}function Dv(n,e,t){const s=new Map;for(const a of n){const l=a.transform,d=t.data.field(a.field);s.set(a.field,PI(l,d,e))}return s}class Rp extends xd{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class LI extends xd{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MI{constructor(e,t,s,a){this.batchId=e,this.localWriteTime=t,this.baseMutations=s,this.mutations=a}applyToRemoteDocument(e,t){const s=t.mutationResults;for(let a=0;a<this.mutations.length;a++){const l=this.mutations[a];l.key.isEqual(e.key)&&DI(l,e,s[a])}}applyToLocalView(e,t){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(t=Bl(s,e,t,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(t=Bl(s,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const s=fx();return this.mutations.forEach((a=>{const l=e.get(a.key),d=l.overlayedDocument;let f=this.applyToLocalView(d,l.mutatedFields);f=t.has(a.key)?null:f;const m=_x(d,f);m!==null&&s.set(a.key,m),d.isValidDocument()||d.convertToNoDocument(ot.min())})),s}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),vt())}isEqual(e){return this.batchId===e.batchId&&Fo(this.mutations,e.mutations,((t,s)=>jv(t,s)))&&Fo(this.baseMutations,e.baseMutations,((t,s)=>jv(t,s)))}}class Ap{constructor(e,t,s,a){this.batch=e,this.commitVersion=t,this.mutationResults=s,this.docVersions=a}static from(e,t,s){At(e.mutations.length===s.length,58842,{Ve:e.mutations.length,me:s.length});let a=(function(){return SI})();const l=e.mutations;for(let d=0;d<l.length;d++)a=a.insert(l[d].key,s[d].version);return new Ap(e,t,s,a)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OI{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FI{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var pn,St;function UI(n){switch(n){case pe.OK:return rt(64938);case pe.CANCELLED:case pe.UNKNOWN:case pe.DEADLINE_EXCEEDED:case pe.RESOURCE_EXHAUSTED:case pe.INTERNAL:case pe.UNAVAILABLE:case pe.UNAUTHENTICATED:return!1;case pe.INVALID_ARGUMENT:case pe.NOT_FOUND:case pe.ALREADY_EXISTS:case pe.PERMISSION_DENIED:case pe.FAILED_PRECONDITION:case pe.ABORTED:case pe.OUT_OF_RANGE:case pe.UNIMPLEMENTED:case pe.DATA_LOSS:return!0;default:return rt(15467,{code:n})}}function wx(n){if(n===void 0)return xi("GRPC error has no .code"),pe.UNKNOWN;switch(n){case pn.OK:return pe.OK;case pn.CANCELLED:return pe.CANCELLED;case pn.UNKNOWN:return pe.UNKNOWN;case pn.DEADLINE_EXCEEDED:return pe.DEADLINE_EXCEEDED;case pn.RESOURCE_EXHAUSTED:return pe.RESOURCE_EXHAUSTED;case pn.INTERNAL:return pe.INTERNAL;case pn.UNAVAILABLE:return pe.UNAVAILABLE;case pn.UNAUTHENTICATED:return pe.UNAUTHENTICATED;case pn.INVALID_ARGUMENT:return pe.INVALID_ARGUMENT;case pn.NOT_FOUND:return pe.NOT_FOUND;case pn.ALREADY_EXISTS:return pe.ALREADY_EXISTS;case pn.PERMISSION_DENIED:return pe.PERMISSION_DENIED;case pn.FAILED_PRECONDITION:return pe.FAILED_PRECONDITION;case pn.ABORTED:return pe.ABORTED;case pn.OUT_OF_RANGE:return pe.OUT_OF_RANGE;case pn.UNIMPLEMENTED:return pe.UNIMPLEMENTED;case pn.DATA_LOSS:return pe.DATA_LOSS;default:return rt(39323,{code:n})}}(St=pn||(pn={}))[St.OK=0]="OK",St[St.CANCELLED=1]="CANCELLED",St[St.UNKNOWN=2]="UNKNOWN",St[St.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",St[St.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",St[St.NOT_FOUND=5]="NOT_FOUND",St[St.ALREADY_EXISTS=6]="ALREADY_EXISTS",St[St.PERMISSION_DENIED=7]="PERMISSION_DENIED",St[St.UNAUTHENTICATED=16]="UNAUTHENTICATED",St[St.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",St[St.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",St[St.ABORTED=10]="ABORTED",St[St.OUT_OF_RANGE=11]="OUT_OF_RANGE",St[St.UNIMPLEMENTED=12]="UNIMPLEMENTED",St[St.INTERNAL=13]="INTERNAL",St[St.UNAVAILABLE=14]="UNAVAILABLE",St[St.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zI=new ta([4294967295,4294967295],0);function Vv(n){const e=B0().encode(n),t=new V0;return t.update(e),new Uint8Array(t.digest())}function Lv(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),s=e.getUint32(4,!0),a=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new ta([t,s],0),new ta([a,l],0)]}class jp{constructor(e,t,s){if(this.bitmap=e,this.padding=t,this.hashCount=s,t<0||t>=8)throw new Vl(`Invalid padding: ${t}`);if(s<0)throw new Vl(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new Vl(`Invalid hash count: ${s}`);if(e.length===0&&t!==0)throw new Vl(`Invalid padding when bitmap length is 0: ${t}`);this.fe=8*e.length-t,this.ge=ta.fromNumber(this.fe)}pe(e,t,s){let a=e.add(t.multiply(ta.fromNumber(s)));return a.compare(zI)===1&&(a=new ta([a.getBits(0),a.getBits(1)],0)),a.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;const t=Vv(e),[s,a]=Lv(t);for(let l=0;l<this.hashCount;l++){const d=this.pe(s,a,l);if(!this.ye(d))return!1}return!0}static create(e,t,s){const a=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),d=new jp(l,a,t);return s.forEach((f=>d.insert(f))),d}insert(e){if(this.fe===0)return;const t=Vv(e),[s,a]=Lv(t);for(let l=0;l<this.hashCount;l++){const d=this.pe(s,a,l);this.we(d)}}we(e){const t=Math.floor(e/8),s=e%8;this.bitmap[t]|=1<<s}}class Vl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wd{constructor(e,t,s,a,l){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=s,this.documentUpdates=a,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,t,s){const a=new Map;return a.set(e,dc.createSynthesizedTargetChangeForCurrentChange(e,t,s)),new wd(ot.min(),a,new Xt(ft),wi(),vt())}}class dc{constructor(e,t,s,a,l){this.resumeToken=e,this.current=t,this.addedDocuments=s,this.modifiedDocuments=a,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,t,s){return new dc(s,t,vt(),vt(),vt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Du{constructor(e,t,s,a){this.Se=e,this.removedTargetIds=t,this.key=s,this.be=a}}class Ex{constructor(e,t){this.targetId=e,this.De=t}}class Tx{constructor(e,t,s=Gn.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=t,this.resumeToken=s,this.cause=a}}class Mv{constructor(){this.ve=0,this.Ce=Ov(),this.Fe=Gn.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=vt(),t=vt(),s=vt();return this.Ce.forEach(((a,l)=>{switch(l){case 0:e=e.add(a);break;case 2:t=t.add(a);break;case 1:s=s.add(a);break;default:rt(38017,{changeType:l})}})),new dc(this.Fe,this.Me,e,t,s)}ke(){this.xe=!1,this.Ce=Ov()}qe(e,t){this.xe=!0,this.Ce=this.Ce.insert(e,t)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,At(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class $I{constructor(e){this.We=e,this.Ge=new Map,this.ze=wi(),this.je=Eu(),this.Je=Eu(),this.He=new Xt(ft)}Ye(e){for(const t of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(t,e.be):this.Xe(t,e.key,e.be);for(const t of e.removedTargetIds)this.Xe(t,e.key,e.be)}et(e){this.forEachTarget(e,(t=>{const s=this.tt(t);switch(e.state){case 0:this.nt(t)&&s.Be(e.resumeToken);break;case 1:s.Ue(),s.Oe||s.ke(),s.Be(e.resumeToken);break;case 2:s.Ue(),s.Oe||this.removeTarget(t);break;case 3:this.nt(t)&&(s.Ke(),s.Be(e.resumeToken));break;case 4:this.nt(t)&&(this.rt(t),s.Be(e.resumeToken));break;default:rt(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ge.forEach(((s,a)=>{this.nt(a)&&t(a)}))}it(e){const t=e.targetId,s=e.De.count,a=this.st(t);if(a){const l=a.target;if(Uf(l))if(s===0){const d=new Ye(l.path);this.Xe(t,d,or.newNoDocument(d,ot.min()))}else At(s===1,20013,{expectedCount:s});else{const d=this.ot(t);if(d!==s){const f=this._t(e),m=f?this.ut(f,e,d):1;if(m!==0){this.rt(t);const y=m===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(t,y)}}}}}_t(e){const t=e.De.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:s="",padding:a=0},hashCount:l=0}=t;let d,f;try{d=aa(s).toUint8Array()}catch(m){if(m instanceof K0)return ra("Decoding the base64 bloom filter in existence filter failed ("+m.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw m}try{f=new jp(d,a,l)}catch(m){return ra(m instanceof Vl?"BloomFilter error: ":"Applying bloom filter failed: ",m),null}return f.fe===0?null:f}ut(e,t,s){return t.De.count===s-this.ht(e,t.targetId)?0:2}ht(e,t){const s=this.We.getRemoteKeysForTarget(t);let a=0;return s.forEach((l=>{const d=this.We.lt(),f=`projects/${d.projectId}/databases/${d.database}/documents/${l.path.canonicalString()}`;e.mightContain(f)||(this.Xe(t,l,null),a++)})),a}Pt(e){const t=new Map;this.Ge.forEach(((l,d)=>{const f=this.st(d);if(f){if(l.current&&Uf(f.target)){const m=new Ye(f.target.path);this.Tt(m).has(d)||this.It(d,m)||this.Xe(d,m,or.newNoDocument(m,e))}l.Ne&&(t.set(d,l.Le()),l.ke())}}));let s=vt();this.Je.forEach(((l,d)=>{let f=!0;d.forEachWhile((m=>{const y=this.st(m);return!y||y.purpose==="TargetPurposeLimboResolution"||(f=!1,!1)})),f&&(s=s.add(l))})),this.ze.forEach(((l,d)=>d.setReadTime(e)));const a=new wd(e,t,this.He,this.ze,s);return this.ze=wi(),this.je=Eu(),this.Je=Eu(),this.He=new Xt(ft),a}Ze(e,t){if(!this.nt(e))return;const s=this.It(e,t.key)?2:0;this.tt(e).qe(t.key,s),this.ze=this.ze.insert(t.key,t),this.je=this.je.insert(t.key,this.Tt(t.key).add(e)),this.Je=this.Je.insert(t.key,this.dt(t.key).add(e))}Xe(e,t,s){if(!this.nt(e))return;const a=this.tt(e);this.It(e,t)?a.qe(t,1):a.Qe(t),this.Je=this.Je.insert(t,this.dt(t).delete(e)),this.Je=this.Je.insert(t,this.dt(t).add(e)),s&&(this.ze=this.ze.insert(t,s))}removeTarget(e){this.Ge.delete(e)}ot(e){const t=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let t=this.Ge.get(e);return t||(t=new Mv,this.Ge.set(e,t)),t}dt(e){let t=this.Je.get(e);return t||(t=new Cn(ft),this.Je=this.Je.insert(e,t)),t}Tt(e){let t=this.je.get(e);return t||(t=new Cn(ft),this.je=this.je.insert(e,t)),t}nt(e){const t=this.st(e)!==null;return t||ze("WatchChangeAggregator","Detected inactive target",e),t}st(e){const t=this.Ge.get(e);return t&&t.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new Mv),this.We.getRemoteKeysForTarget(e).forEach((t=>{this.Xe(e,t,null)}))}It(e,t){return this.We.getRemoteKeysForTarget(e).has(t)}}function Eu(){return new Xt(Ye.comparator)}function Ov(){return new Xt(Ye.comparator)}const BI={asc:"ASCENDING",desc:"DESCENDING"},WI={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},GI={and:"AND",or:"OR"};class qI{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function $f(n,e){return n.useProto3Json||pd(e)?e:{value:e}}function Zu(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Sx(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function HI(n,e){return Zu(n,e.toTimestamp())}function Hs(n){return At(!!n,49232),ot.fromTimestamp((function(t){const s=ia(t);return new Ht(s.seconds,s.nanos)})(n))}function kp(n,e){return Bf(n,e).canonicalString()}function Bf(n,e){const t=(function(a){return new $t(["projects",a.projectId,"databases",a.database])})(n).child("documents");return e===void 0?t:t.child(e)}function bx(n){const e=$t.fromString(n);return At(Rx(e),10190,{key:e.toString()}),e}function Wf(n,e){return kp(n.databaseId,e.path)}function pf(n,e){const t=bx(e);if(t.get(1)!==n.databaseId.projectId)throw new Fe(pe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Fe(pe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Ye(Ix(t))}function Cx(n,e){return kp(n.databaseId,e)}function KI(n){const e=bx(n);return e.length===4?$t.emptyPath():Ix(e)}function Gf(n){return new $t(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Ix(n){return At(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function Fv(n,e,t){return{name:Wf(n,e),fields:t.value.mapValue.fields}}function QI(n,e){let t;if("targetChange"in e){e.targetChange;const s=(function(y){return y==="NO_CHANGE"?0:y==="ADD"?1:y==="REMOVE"?2:y==="CURRENT"?3:y==="RESET"?4:rt(39313,{state:y})})(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],l=(function(y,x){return y.useProto3Json?(At(x===void 0||typeof x=="string",58123),Gn.fromBase64String(x||"")):(At(x===void 0||x instanceof Buffer||x instanceof Uint8Array,16193),Gn.fromUint8Array(x||new Uint8Array))})(n,e.targetChange.resumeToken),d=e.targetChange.cause,f=d&&(function(y){const x=y.code===void 0?pe.UNKNOWN:wx(y.code);return new Fe(x,y.message||"")})(d);t=new Tx(s,a,l,f||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const a=pf(n,s.document.name),l=Hs(s.document.updateTime),d=s.document.createTime?Hs(s.document.createTime):ot.min(),f=new Dr({mapValue:{fields:s.document.fields}}),m=or.newFoundDocument(a,l,d,f),y=s.targetIds||[],x=s.removedTargetIds||[];t=new Du(y,x,m.key,m)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const a=pf(n,s.document),l=s.readTime?Hs(s.readTime):ot.min(),d=or.newNoDocument(a,l),f=s.removedTargetIds||[];t=new Du([],f,d.key,d)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const a=pf(n,s.document),l=s.removedTargetIds||[];t=new Du([],l,a,null)}else{if(!("filter"in e))return rt(11601,{At:e});{e.filter;const s=e.filter;s.targetId;const{count:a=0,unchangedNames:l}=s,d=new FI(a,l),f=s.targetId;t=new Ex(f,d)}}return t}function YI(n,e){let t;if(e instanceof uc)t={update:Fv(n,e.key,e.value)};else if(e instanceof Rp)t={delete:Wf(n,e.key)};else if(e instanceof ma)t={update:Fv(n,e.key,e.data),updateMask:iN(e.fieldMask)};else{if(!(e instanceof LI))return rt(16599,{Rt:e.type});t={verify:Wf(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((s=>(function(l,d){const f=d.transform;if(f instanceof ec)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(f instanceof tc)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:f.elements}};if(f instanceof nc)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:f.elements}};if(f instanceof Xu)return{fieldPath:d.field.canonicalString(),increment:f.Ee};throw rt(20930,{transform:d.transform})})(0,s)))),e.precondition.isNone||(t.currentDocument=(function(a,l){return l.updateTime!==void 0?{updateTime:HI(a,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:rt(27497)})(n,e.precondition)),t}function JI(n,e){return n&&n.length>0?(At(e!==void 0,14353),n.map((t=>(function(a,l){let d=a.updateTime?Hs(a.updateTime):Hs(l);return d.isEqual(ot.min())&&(d=Hs(l)),new kI(d,a.transformResults||[])})(t,e)))):[]}function XI(n,e){return{documents:[Cx(n,e.path)]}}function ZI(n,e){const t={structuredQuery:{}},s=e.path;let a;e.collectionGroup!==null?(a=s,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=s.popLast(),t.structuredQuery.from=[{collectionId:s.lastSegment()}]),t.parent=Cx(n,a);const l=(function(y){if(y.length!==0)return Px(js.create(y,"and"))})(e.filters);l&&(t.structuredQuery.where=l);const d=(function(y){if(y.length!==0)return y.map((x=>(function(C){return{field:Ao(C.field),direction:nN(C.dir)}})(x)))})(e.orderBy);d&&(t.structuredQuery.orderBy=d);const f=$f(n,e.limit);return f!==null&&(t.structuredQuery.limit=f),e.startAt&&(t.structuredQuery.startAt=(function(y){return{before:y.inclusive,values:y.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(y){return{before:!y.inclusive,values:y.position}})(e.endAt)),{Vt:t,parent:a}}function eN(n){let e=KI(n.parent);const t=n.structuredQuery,s=t.from?t.from.length:0;let a=null;if(s>0){At(s===1,65062);const x=t.from[0];x.allDescendants?a=x.collectionId:e=e.child(x.collectionId)}let l=[];t.where&&(l=(function(E){const C=Nx(E);return C instanceof js&&sx(C)?C.getFilters():[C]})(t.where));let d=[];t.orderBy&&(d=(function(E){return E.map((C=>(function(X){return new Zl(jo(X.field),(function(U){switch(U){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(X.direction))})(C)))})(t.orderBy));let f=null;t.limit&&(f=(function(E){let C;return C=typeof E=="object"?E.value:E,pd(C)?null:C})(t.limit));let m=null;t.startAt&&(m=(function(E){const C=!!E.before,O=E.values||[];return new Yu(O,C)})(t.startAt));let y=null;return t.endAt&&(y=(function(E){const C=!E.before,O=E.values||[];return new Yu(O,C)})(t.endAt)),_I(e,a,d,l,f,"F",m,y)}function tN(n,e){const t=(function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return rt(28987,{purpose:a})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Nx(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const s=jo(t.unaryFilter.field);return mn.create(s,"==",{doubleValue:NaN});case"IS_NULL":const a=jo(t.unaryFilter.field);return mn.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=jo(t.unaryFilter.field);return mn.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=jo(t.unaryFilter.field);return mn.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return rt(61313);default:return rt(60726)}})(n):n.fieldFilter!==void 0?(function(t){return mn.create(jo(t.fieldFilter.field),(function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return rt(58110);default:return rt(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return js.create(t.compositeFilter.filters.map((s=>Nx(s))),(function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return rt(1026)}})(t.compositeFilter.op))})(n):rt(30097,{filter:n})}function nN(n){return BI[n]}function rN(n){return WI[n]}function sN(n){return GI[n]}function Ao(n){return{fieldPath:n.canonicalString()}}function jo(n){return Wn.fromServerFormat(n.fieldPath)}function Px(n){return n instanceof mn?(function(t){if(t.op==="=="){if(Cv(t.value))return{unaryFilter:{field:Ao(t.field),op:"IS_NAN"}};if(bv(t.value))return{unaryFilter:{field:Ao(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Cv(t.value))return{unaryFilter:{field:Ao(t.field),op:"IS_NOT_NAN"}};if(bv(t.value))return{unaryFilter:{field:Ao(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ao(t.field),op:rN(t.op),value:t.value}}})(n):n instanceof js?(function(t){const s=t.getFilters().map((a=>Px(a)));return s.length===1?s[0]:{compositeFilter:{op:sN(t.op),filters:s}}})(n):rt(54877,{filter:n})}function iN(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function Rx(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yi{constructor(e,t,s,a,l=ot.min(),d=ot.min(),f=Gn.EMPTY_BYTE_STRING,m=null){this.target=e,this.targetId=t,this.purpose=s,this.sequenceNumber=a,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=f,this.expectedCount=m}withSequenceNumber(e){return new Yi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Yi(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Yi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Yi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aN{constructor(e){this.gt=e}}function oN(n){const e=eN({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Ju(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lN{constructor(){this.Dn=new cN}addToCollectionParentIndex(e,t){return this.Dn.add(t),ye.resolve()}getCollectionParents(e,t){return ye.resolve(this.Dn.getEntries(t))}addFieldIndex(e,t){return ye.resolve()}deleteFieldIndex(e,t){return ye.resolve()}deleteAllFieldIndexes(e){return ye.resolve()}createTargetIndexes(e,t){return ye.resolve()}getDocumentsMatchingTarget(e,t){return ye.resolve(null)}getIndexType(e,t){return ye.resolve(0)}getFieldIndexes(e,t){return ye.resolve([])}getNextCollectionGroupToUpdate(e){return ye.resolve(null)}getMinOffset(e,t){return ye.resolve(sa.min())}getMinOffsetFromCollectionGroup(e,t){return ye.resolve(sa.min())}updateCollectionGroup(e,t,s){return ye.resolve()}updateIndexEntries(e,t){return ye.resolve()}}class cN{constructor(){this.index={}}add(e){const t=e.lastSegment(),s=e.popLast(),a=this.index[t]||new Cn($t.comparator),l=!a.has(s);return this.index[t]=a.add(s),l}has(e){const t=e.lastSegment(),s=e.popLast(),a=this.index[t];return a&&a.has(s)}getEntries(e){return(this.index[e]||new Cn($t.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uv={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Ax=41943040;class kr{static withCacheSize(e){return new kr(e,kr.DEFAULT_COLLECTION_PERCENTILE,kr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */kr.DEFAULT_COLLECTION_PERCENTILE=10,kr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,kr.DEFAULT=new kr(Ax,kr.DEFAULT_COLLECTION_PERCENTILE,kr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),kr.DISABLED=new kr(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $o{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new $o(0)}static ur(){return new $o(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zv="LruGarbageCollector",uN=1048576;function $v([n,e],[t,s]){const a=ft(n,t);return a===0?ft(e,s):a}class dN{constructor(e){this.Tr=e,this.buffer=new Cn($v),this.Ir=0}dr(){return++this.Ir}Er(e){const t=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(t);else{const s=this.buffer.last();$v(t,s)<0&&(this.buffer=this.buffer.delete(s).add(t))}}get maxValue(){return this.buffer.last()[0]}}class hN{constructor(e,t,s){this.garbageCollector=e,this.asyncQueue=t,this.localStore=s,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){ze(zv,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Zo(t)?ze(zv,"Ignoring IndexedDB error during garbage collection: ",t):await Xo(t)}await this.Rr(3e5)}))}}class fN{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.mr(e).next((s=>Math.floor(t/100*s)))}nthSequenceNumber(e,t){if(t===0)return ye.resolve(fd.ue);const s=new dN(t);return this.Vr.forEachTarget(e,(a=>s.Er(a.sequenceNumber))).next((()=>this.Vr.gr(e,(a=>s.Er(a))))).next((()=>s.maxValue))}removeTargets(e,t,s){return this.Vr.removeTargets(e,t,s)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ze("LruGarbageCollector","Garbage collection skipped; disabled"),ye.resolve(Uv)):this.getCacheSize(e).next((s=>s<this.params.cacheSizeCollectionThreshold?(ze("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Uv):this.pr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,t){let s,a,l,d,f,m,y;const x=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((E=>(E>this.params.maximumSequenceNumbersToCollect?(ze("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${E}`),a=this.params.maximumSequenceNumbersToCollect):a=E,d=Date.now(),this.nthSequenceNumber(e,a)))).next((E=>(s=E,f=Date.now(),this.removeTargets(e,s,t)))).next((E=>(l=E,m=Date.now(),this.removeOrphanedDocuments(e,s)))).next((E=>(y=Date.now(),Po()<=yt.DEBUG&&ze("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-x}ms
	Determined least recently used ${a} in `+(f-d)+`ms
	Removed ${l} targets in `+(m-f)+`ms
	Removed ${E} documents in `+(y-m)+`ms
Total Duration: ${y-x}ms`),ye.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:l,documentsRemoved:E}))))}}function pN(n,e){return new fN(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mN{constructor(){this.changes=new Ha((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,or.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const s=this.changes.get(t);return s!==void 0?ye.resolve(s):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gN{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yN{constructor(e,t,s,a){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=s,this.indexManager=a}getDocument(e,t){let s=null;return this.documentOverlayCache.getOverlay(e,t).next((a=>(s=a,this.remoteDocumentCache.getEntry(e,t)))).next((a=>(s!==null&&Bl(s.mutation,a,$r.empty(),Ht.now()),a)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((s=>this.getLocalViewOfDocuments(e,s,vt()).next((()=>s))))}getLocalViewOfDocuments(e,t,s=vt()){const a=La();return this.populateOverlays(e,a,t).next((()=>this.computeViews(e,t,a,s).next((l=>{let d=Dl();return l.forEach(((f,m)=>{d=d.insert(f,m.overlayedDocument)})),d}))))}getOverlayedDocuments(e,t){const s=La();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,vt())))}populateOverlays(e,t,s){const a=[];return s.forEach((l=>{t.has(l)||a.push(l)})),this.documentOverlayCache.getOverlays(e,a).next((l=>{l.forEach(((d,f)=>{t.set(d,f)}))}))}computeViews(e,t,s,a){let l=wi();const d=$l(),f=(function(){return $l()})();return t.forEach(((m,y)=>{const x=s.get(y.key);a.has(y.key)&&(x===void 0||x.mutation instanceof ma)?l=l.insert(y.key,y):x!==void 0?(d.set(y.key,x.mutation.getFieldMask()),Bl(x.mutation,y,x.mutation.getFieldMask(),Ht.now())):d.set(y.key,$r.empty())})),this.recalculateAndSaveOverlays(e,l).next((m=>(m.forEach(((y,x)=>d.set(y,x))),t.forEach(((y,x)=>{var E;return f.set(y,new gN(x,(E=d.get(y))!==null&&E!==void 0?E:null))})),f)))}recalculateAndSaveOverlays(e,t){const s=$l();let a=new Xt(((d,f)=>d-f)),l=vt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((d=>{for(const f of d)f.keys().forEach((m=>{const y=t.get(m);if(y===null)return;let x=s.get(m)||$r.empty();x=f.applyToLocalView(y,x),s.set(m,x);const E=(a.get(f.batchId)||vt()).add(m);a=a.insert(f.batchId,E)}))})).next((()=>{const d=[],f=a.getReverseIterator();for(;f.hasNext();){const m=f.getNext(),y=m.key,x=m.value,E=fx();x.forEach((C=>{if(!l.has(C)){const O=_x(t.get(C),s.get(C));O!==null&&E.set(C,O),l=l.add(C)}})),d.push(this.documentOverlayCache.saveOverlays(e,y,E))}return ye.waitFor(d)})).next((()=>s))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((s=>this.recalculateAndSaveOverlays(e,s)))}getDocumentsMatchingQuery(e,t,s,a){return(function(d){return Ye.isDocumentKey(d.path)&&d.collectionGroup===null&&d.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):lx(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,s,a):this.getDocumentsMatchingCollectionQuery(e,t,s,a)}getNextDocuments(e,t,s,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,s,a).next((l=>{const d=a-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,s.largestBatchId,a-l.size):ye.resolve(La());let f=Ql,m=l;return d.next((y=>ye.forEach(y,((x,E)=>(f<E.largestBatchId&&(f=E.largestBatchId),l.get(x)?ye.resolve():this.remoteDocumentCache.getEntry(e,x).next((C=>{m=m.insert(x,C)}))))).next((()=>this.populateOverlays(e,y,l))).next((()=>this.computeViews(e,m,y,vt()))).next((x=>({batchId:f,changes:hx(x)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ye(t)).next((s=>{let a=Dl();return s.isFoundDocument()&&(a=a.insert(s.key,s)),a}))}getDocumentsMatchingCollectionGroupQuery(e,t,s,a){const l=t.collectionGroup;let d=Dl();return this.indexManager.getCollectionParents(e,l).next((f=>ye.forEach(f,(m=>{const y=(function(E,C){return new el(C,null,E.explicitOrderBy.slice(),E.filters.slice(),E.limit,E.limitType,E.startAt,E.endAt)})(t,m.child(l));return this.getDocumentsMatchingCollectionQuery(e,y,s,a).next((x=>{x.forEach(((E,C)=>{d=d.insert(E,C)}))}))})).next((()=>d))))}getDocumentsMatchingCollectionQuery(e,t,s,a){let l;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,s.largestBatchId).next((d=>(l=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,s,l,a)))).next((d=>{l.forEach(((m,y)=>{const x=y.getKey();d.get(x)===null&&(d=d.insert(x,or.newInvalidDocument(x)))}));let f=Dl();return d.forEach(((m,y)=>{const x=l.get(m);x!==void 0&&Bl(x.mutation,y,$r.empty(),Ht.now()),vd(t,y)&&(f=f.insert(m,y))})),f}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vN{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,t){return ye.resolve(this.Br.get(t))}saveBundleMetadata(e,t){return this.Br.set(t.id,(function(a){return{id:a.id,version:a.version,createTime:Hs(a.createTime)}})(t)),ye.resolve()}getNamedQuery(e,t){return ye.resolve(this.Lr.get(t))}saveNamedQuery(e,t){return this.Lr.set(t.name,(function(a){return{name:a.name,query:oN(a.bundledQuery),readTime:Hs(a.readTime)}})(t)),ye.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _N{constructor(){this.overlays=new Xt(Ye.comparator),this.kr=new Map}getOverlay(e,t){return ye.resolve(this.overlays.get(t))}getOverlays(e,t){const s=La();return ye.forEach(t,(a=>this.getOverlay(e,a).next((l=>{l!==null&&s.set(a,l)})))).next((()=>s))}saveOverlays(e,t,s){return s.forEach(((a,l)=>{this.wt(e,t,l)})),ye.resolve()}removeOverlaysForBatchId(e,t,s){const a=this.kr.get(s);return a!==void 0&&(a.forEach((l=>this.overlays=this.overlays.remove(l))),this.kr.delete(s)),ye.resolve()}getOverlaysForCollection(e,t,s){const a=La(),l=t.length+1,d=new Ye(t.child("")),f=this.overlays.getIteratorFrom(d);for(;f.hasNext();){const m=f.getNext().value,y=m.getKey();if(!t.isPrefixOf(y.path))break;y.path.length===l&&m.largestBatchId>s&&a.set(m.getKey(),m)}return ye.resolve(a)}getOverlaysForCollectionGroup(e,t,s,a){let l=new Xt(((y,x)=>y-x));const d=this.overlays.getIterator();for(;d.hasNext();){const y=d.getNext().value;if(y.getKey().getCollectionGroup()===t&&y.largestBatchId>s){let x=l.get(y.largestBatchId);x===null&&(x=La(),l=l.insert(y.largestBatchId,x)),x.set(y.getKey(),y)}}const f=La(),m=l.getIterator();for(;m.hasNext()&&(m.getNext().value.forEach(((y,x)=>f.set(y,x))),!(f.size()>=a)););return ye.resolve(f)}wt(e,t,s){const a=this.overlays.get(s.key);if(a!==null){const d=this.kr.get(a.largestBatchId).delete(s.key);this.kr.set(a.largestBatchId,d)}this.overlays=this.overlays.insert(s.key,new OI(t,s));let l=this.kr.get(t);l===void 0&&(l=vt(),this.kr.set(t,l)),this.kr.set(t,l.add(s.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xN{constructor(){this.sessionToken=Gn.EMPTY_BYTE_STRING}getSessionToken(e){return ye.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ye.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dp{constructor(){this.qr=new Cn(kn.Qr),this.$r=new Cn(kn.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,t){const s=new kn(e,t);this.qr=this.qr.add(s),this.$r=this.$r.add(s)}Kr(e,t){e.forEach((s=>this.addReference(s,t)))}removeReference(e,t){this.Wr(new kn(e,t))}Gr(e,t){e.forEach((s=>this.removeReference(s,t)))}zr(e){const t=new Ye(new $t([])),s=new kn(t,e),a=new kn(t,e+1),l=[];return this.$r.forEachInRange([s,a],(d=>{this.Wr(d),l.push(d.key)})),l}jr(){this.qr.forEach((e=>this.Wr(e)))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const t=new Ye(new $t([])),s=new kn(t,e),a=new kn(t,e+1);let l=vt();return this.$r.forEachInRange([s,a],(d=>{l=l.add(d.key)})),l}containsKey(e){const t=new kn(e,0),s=this.qr.firstAfterOrEqual(t);return s!==null&&e.isEqual(s.key)}}class kn{constructor(e,t){this.key=e,this.Hr=t}static Qr(e,t){return Ye.comparator(e.key,t.key)||ft(e.Hr,t.Hr)}static Ur(e,t){return ft(e.Hr,t.Hr)||Ye.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wN{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.er=1,this.Yr=new Cn(kn.Qr)}checkEmpty(e){return ye.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,s,a){const l=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new MI(l,t,s,a);this.mutationQueue.push(d);for(const f of a)this.Yr=this.Yr.add(new kn(f.key,l)),this.indexManager.addToCollectionParentIndex(e,f.key.path.popLast());return ye.resolve(d)}lookupMutationBatch(e,t){return ye.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const s=t+1,a=this.Xr(s),l=a<0?0:a;return ye.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return ye.resolve(this.mutationQueue.length===0?Sp:this.er-1)}getAllMutationBatches(e){return ye.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const s=new kn(t,0),a=new kn(t,Number.POSITIVE_INFINITY),l=[];return this.Yr.forEachInRange([s,a],(d=>{const f=this.Zr(d.Hr);l.push(f)})),ye.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new Cn(ft);return t.forEach((a=>{const l=new kn(a,0),d=new kn(a,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([l,d],(f=>{s=s.add(f.Hr)}))})),ye.resolve(this.ei(s))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,a=s.length+1;let l=s;Ye.isDocumentKey(l)||(l=l.child(""));const d=new kn(new Ye(l),0);let f=new Cn(ft);return this.Yr.forEachWhile((m=>{const y=m.key.path;return!!s.isPrefixOf(y)&&(y.length===a&&(f=f.add(m.Hr)),!0)}),d),ye.resolve(this.ei(f))}ei(e){const t=[];return e.forEach((s=>{const a=this.Zr(s);a!==null&&t.push(a)})),t}removeMutationBatch(e,t){At(this.ti(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let s=this.Yr;return ye.forEach(t.mutations,(a=>{const l=new kn(a.key,t.batchId);return s=s.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((()=>{this.Yr=s}))}rr(e){}containsKey(e,t){const s=new kn(t,0),a=this.Yr.firstAfterOrEqual(s);return ye.resolve(t.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,ye.resolve()}ti(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EN{constructor(e){this.ni=e,this.docs=(function(){return new Xt(Ye.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const s=t.key,a=this.docs.get(s),l=a?a.size:0,d=this.ni(t);return this.docs=this.docs.insert(s,{document:t.mutableCopy(),size:d}),this.size+=d-l,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const s=this.docs.get(t);return ye.resolve(s?s.document.mutableCopy():or.newInvalidDocument(t))}getEntries(e,t){let s=wi();return t.forEach((a=>{const l=this.docs.get(a);s=s.insert(a,l?l.document.mutableCopy():or.newInvalidDocument(a))})),ye.resolve(s)}getDocumentsMatchingQuery(e,t,s,a){let l=wi();const d=t.path,f=new Ye(d.child("__id-9223372036854775808__")),m=this.docs.getIteratorFrom(f);for(;m.hasNext();){const{key:y,value:{document:x}}=m.getNext();if(!d.isPrefixOf(y.path))break;y.path.length>d.length+1||JC(YC(x),s)<=0||(a.has(x.key)||vd(t,x))&&(l=l.insert(x.key,x.mutableCopy()))}return ye.resolve(l)}getAllFromCollectionGroup(e,t,s,a){rt(9500)}ri(e,t){return ye.forEach(this.docs,(s=>t(s)))}newChangeBuffer(e){return new TN(this)}getSize(e){return ye.resolve(this.size)}}class TN extends mN{constructor(e){super(),this.Or=e}applyChanges(e){const t=[];return this.changes.forEach(((s,a)=>{a.isValidDocument()?t.push(this.Or.addEntry(e,a)):this.Or.removeEntry(s)})),ye.waitFor(t)}getFromCache(e,t){return this.Or.getEntry(e,t)}getAllFromCache(e,t){return this.Or.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SN{constructor(e){this.persistence=e,this.ii=new Ha((t=>Ip(t)),Np),this.lastRemoteSnapshotVersion=ot.min(),this.highestTargetId=0,this.si=0,this.oi=new Dp,this.targetCount=0,this._i=$o.ar()}forEachTarget(e,t){return this.ii.forEach(((s,a)=>t(a))),ye.resolve()}getLastRemoteSnapshotVersion(e){return ye.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ye.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),ye.resolve(this.highestTargetId)}setTargetsMetadata(e,t,s){return s&&(this.lastRemoteSnapshotVersion=s),t>this.si&&(this.si=t),ye.resolve()}hr(e){this.ii.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this._i=new $o(t),this.highestTargetId=t),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,t){return this.hr(t),this.targetCount+=1,ye.resolve()}updateTargetData(e,t){return this.hr(t),ye.resolve()}removeTargetData(e,t){return this.ii.delete(t.target),this.oi.zr(t.targetId),this.targetCount-=1,ye.resolve()}removeTargets(e,t,s){let a=0;const l=[];return this.ii.forEach(((d,f)=>{f.sequenceNumber<=t&&s.get(f.targetId)===null&&(this.ii.delete(d),l.push(this.removeMatchingKeysForTargetId(e,f.targetId)),a++)})),ye.waitFor(l).next((()=>a))}getTargetCount(e){return ye.resolve(this.targetCount)}getTargetData(e,t){const s=this.ii.get(t)||null;return ye.resolve(s)}addMatchingKeys(e,t,s){return this.oi.Kr(t,s),ye.resolve()}removeMatchingKeys(e,t,s){this.oi.Gr(t,s);const a=this.persistence.referenceDelegate,l=[];return a&&t.forEach((d=>{l.push(a.markPotentiallyOrphaned(e,d))})),ye.waitFor(l)}removeMatchingKeysForTargetId(e,t){return this.oi.zr(t),ye.resolve()}getMatchingKeysForTargetId(e,t){const s=this.oi.Jr(t);return ye.resolve(s)}containsKey(e,t){return ye.resolve(this.oi.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jx{constructor(e,t){this.ai={},this.overlays={},this.ui=new fd(0),this.ci=!1,this.ci=!0,this.li=new xN,this.referenceDelegate=e(this),this.hi=new SN(this),this.indexManager=new lN,this.remoteDocumentCache=(function(a){return new EN(a)})((s=>this.referenceDelegate.Pi(s))),this.serializer=new aN(t),this.Ti=new vN(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new _N,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let s=this.ai[e.toKey()];return s||(s=new wN(t,this.referenceDelegate),this.ai[e.toKey()]=s),s}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,t,s){ze("MemoryPersistence","Starting transaction:",e);const a=new bN(this.ui.next());return this.referenceDelegate.Ii(),s(a).next((l=>this.referenceDelegate.di(a).next((()=>l)))).toPromise().then((l=>(a.raiseOnCommittedEvent(),l)))}Ei(e,t){return ye.or(Object.values(this.ai).map((s=>()=>s.containsKey(e,t))))}}class bN extends ZC{constructor(e){super(),this.currentSequenceNumber=e}}class Vp{constructor(e){this.persistence=e,this.Ai=new Dp,this.Ri=null}static Vi(e){return new Vp(e)}get mi(){if(this.Ri)return this.Ri;throw rt(60996)}addReference(e,t,s){return this.Ai.addReference(s,t),this.mi.delete(s.toString()),ye.resolve()}removeReference(e,t,s){return this.Ai.removeReference(s,t),this.mi.add(s.toString()),ye.resolve()}markPotentiallyOrphaned(e,t){return this.mi.add(t.toString()),ye.resolve()}removeTarget(e,t){this.Ai.zr(t.targetId).forEach((a=>this.mi.add(a.toString())));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,t.targetId).next((a=>{a.forEach((l=>this.mi.add(l.toString())))})).next((()=>s.removeTargetData(e,t)))}Ii(){this.Ri=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ye.forEach(this.mi,(s=>{const a=Ye.fromPath(s);return this.fi(e,a).next((l=>{l||t.removeEntry(a,ot.min())}))})).next((()=>(this.Ri=null,t.apply(e))))}updateLimboDocument(e,t){return this.fi(e,t).next((s=>{s?this.mi.delete(t.toString()):this.mi.add(t.toString())}))}Pi(e){return 0}fi(e,t){return ye.or([()=>ye.resolve(this.Ai.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class ed{constructor(e,t){this.persistence=e,this.gi=new Ha((s=>nI(s.path)),((s,a)=>s.isEqual(a))),this.garbageCollector=pN(this,t)}static Vi(e,t){return new ed(e,t)}Ii(){}di(e){return ye.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}mr(e){const t=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next((s=>t.next((a=>s+a))))}yr(e){let t=0;return this.gr(e,(s=>{t++})).next((()=>t))}gr(e,t){return ye.forEach(this.gi,((s,a)=>this.Sr(e,s,a).next((l=>l?ye.resolve():t(a)))))}removeTargets(e,t,s){return this.persistence.getTargetCache().removeTargets(e,t,s)}removeOrphanedDocuments(e,t){let s=0;const a=this.persistence.getRemoteDocumentCache(),l=a.newChangeBuffer();return a.ri(e,(d=>this.Sr(e,d,t).next((f=>{f||(s++,l.removeEntry(d,ot.min()))})))).next((()=>l.apply(e))).next((()=>s))}markPotentiallyOrphaned(e,t){return this.gi.set(t,e.currentSequenceNumber),ye.resolve()}removeTarget(e,t){const s=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,s)}addReference(e,t,s){return this.gi.set(s,e.currentSequenceNumber),ye.resolve()}removeReference(e,t,s){return this.gi.set(s,e.currentSequenceNumber),ye.resolve()}updateLimboDocument(e,t){return this.gi.set(t,e.currentSequenceNumber),ye.resolve()}Pi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Au(e.data.value)),t}Sr(e,t,s){return ye.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const a=this.gi.get(t);return ye.resolve(a!==void 0&&a>s)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lp{constructor(e,t,s,a){this.targetId=e,this.fromCache=t,this.Is=s,this.ds=a}static Es(e,t){let s=vt(),a=vt();for(const l of t.docChanges)switch(l.type){case 0:s=s.add(l.doc.key);break;case 1:a=a.add(l.doc.key)}return new Lp(e,t.fromCache,s,a)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CN{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IN{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=(function(){return nT()?8:eI(lr())>0?6:4})()}initialize(e,t){this.gs=e,this.indexManager=t,this.As=!0}getDocumentsMatchingQuery(e,t,s,a){const l={result:null};return this.ps(e,t).next((d=>{l.result=d})).next((()=>{if(!l.result)return this.ys(e,t,a,s).next((d=>{l.result=d}))})).next((()=>{if(l.result)return;const d=new CN;return this.ws(e,t,d).next((f=>{if(l.result=f,this.Rs)return this.Ss(e,t,d,f.size)}))})).next((()=>l.result))}Ss(e,t,s,a){return s.documentReadCount<this.Vs?(Po()<=yt.DEBUG&&ze("QueryEngine","SDK will not create cache indexes for query:",Ro(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),ye.resolve()):(Po()<=yt.DEBUG&&ze("QueryEngine","Query:",Ro(t),"scans",s.documentReadCount,"local documents and returns",a,"documents as results."),s.documentReadCount>this.fs*a?(Po()<=yt.DEBUG&&ze("QueryEngine","The SDK decides to create cache indexes for query:",Ro(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,qs(t))):ye.resolve())}ps(e,t){if(Rv(t))return ye.resolve(null);let s=qs(t);return this.indexManager.getIndexType(e,s).next((a=>a===0?null:(t.limit!==null&&a===1&&(t=Ju(t,null,"F"),s=qs(t)),this.indexManager.getDocumentsMatchingTarget(e,s).next((l=>{const d=vt(...l);return this.gs.getDocuments(e,d).next((f=>this.indexManager.getMinOffset(e,s).next((m=>{const y=this.bs(t,f);return this.Ds(t,y,d,m.readTime)?this.ps(e,Ju(t,null,"F")):this.vs(e,y,t,m)}))))})))))}ys(e,t,s,a){return Rv(t)||a.isEqual(ot.min())?ye.resolve(null):this.gs.getDocuments(e,s).next((l=>{const d=this.bs(t,l);return this.Ds(t,d,s,a)?ye.resolve(null):(Po()<=yt.DEBUG&&ze("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),Ro(t)),this.vs(e,d,t,QC(a,Ql)).next((f=>f)))}))}bs(e,t){let s=new Cn(ux(e));return t.forEach(((a,l)=>{vd(e,l)&&(s=s.add(l))})),s}Ds(e,t,s,a){if(e.limit===null)return!1;if(s.size!==t.size)return!0;const l=e.limitType==="F"?t.last():t.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(a)>0)}ws(e,t,s){return Po()<=yt.DEBUG&&ze("QueryEngine","Using full collection scan to execute query:",Ro(t)),this.gs.getDocumentsMatchingQuery(e,t,sa.min(),s)}vs(e,t,s,a){return this.gs.getDocumentsMatchingQuery(e,s,a).next((l=>(t.forEach((d=>{l=l.insert(d.key,d)})),l)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mp="LocalStore",NN=3e8;class PN{constructor(e,t,s,a){this.persistence=e,this.Cs=t,this.serializer=a,this.Fs=new Xt(ft),this.Ms=new Ha((l=>Ip(l)),Np),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(s)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new yN(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Fs)))}}function RN(n,e,t,s){return new PN(n,e,t,s)}async function kx(n,e){const t=lt(n);return await t.persistence.runTransaction("Handle user change","readonly",(s=>{let a;return t.mutationQueue.getAllMutationBatches(s).next((l=>(a=l,t.Ns(e),t.mutationQueue.getAllMutationBatches(s)))).next((l=>{const d=[],f=[];let m=vt();for(const y of a){d.push(y.batchId);for(const x of y.mutations)m=m.add(x.key)}for(const y of l){f.push(y.batchId);for(const x of y.mutations)m=m.add(x.key)}return t.localDocuments.getDocuments(s,m).next((y=>({Bs:y,removedBatchIds:d,addedBatchIds:f})))}))}))}function AN(n,e){const t=lt(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(s=>{const a=e.batch.keys(),l=t.Os.newChangeBuffer({trackRemovals:!0});return(function(f,m,y,x){const E=y.batch,C=E.keys();let O=ye.resolve();return C.forEach((X=>{O=O.next((()=>x.getEntry(m,X))).next((B=>{const U=y.docVersions.get(X);At(U!==null,48541),B.version.compareTo(U)<0&&(E.applyToRemoteDocument(B,y),B.isValidDocument()&&(B.setReadTime(y.commitVersion),x.addEntry(B)))}))})),O.next((()=>f.mutationQueue.removeMutationBatch(m,E)))})(t,s,e,l).next((()=>l.apply(s))).next((()=>t.mutationQueue.performConsistencyCheck(s))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(s,a,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,(function(f){let m=vt();for(let y=0;y<f.mutationResults.length;++y)f.mutationResults[y].transformResults.length>0&&(m=m.add(f.batch.mutations[y].key));return m})(e)))).next((()=>t.localDocuments.getDocuments(s,a)))}))}function Dx(n){const e=lt(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.hi.getLastRemoteSnapshotVersion(t)))}function jN(n,e){const t=lt(n),s=e.snapshotVersion;let a=t.Fs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const d=t.Os.newChangeBuffer({trackRemovals:!0});a=t.Fs;const f=[];e.targetChanges.forEach(((x,E)=>{const C=a.get(E);if(!C)return;f.push(t.hi.removeMatchingKeys(l,x.removedDocuments,E).next((()=>t.hi.addMatchingKeys(l,x.addedDocuments,E))));let O=C.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(E)!==null?O=O.withResumeToken(Gn.EMPTY_BYTE_STRING,ot.min()).withLastLimboFreeSnapshotVersion(ot.min()):x.resumeToken.approximateByteSize()>0&&(O=O.withResumeToken(x.resumeToken,s)),a=a.insert(E,O),(function(B,U,se){return B.resumeToken.approximateByteSize()===0||U.snapshotVersion.toMicroseconds()-B.snapshotVersion.toMicroseconds()>=NN?!0:se.addedDocuments.size+se.modifiedDocuments.size+se.removedDocuments.size>0})(C,O,x)&&f.push(t.hi.updateTargetData(l,O))}));let m=wi(),y=vt();if(e.documentUpdates.forEach((x=>{e.resolvedLimboDocuments.has(x)&&f.push(t.persistence.referenceDelegate.updateLimboDocument(l,x))})),f.push(kN(l,d,e.documentUpdates).next((x=>{m=x.Ls,y=x.ks}))),!s.isEqual(ot.min())){const x=t.hi.getLastRemoteSnapshotVersion(l).next((E=>t.hi.setTargetsMetadata(l,l.currentSequenceNumber,s)));f.push(x)}return ye.waitFor(f).next((()=>d.apply(l))).next((()=>t.localDocuments.getLocalViewOfDocuments(l,m,y))).next((()=>m))})).then((l=>(t.Fs=a,l)))}function kN(n,e,t){let s=vt(),a=vt();return t.forEach((l=>s=s.add(l))),e.getEntries(n,s).next((l=>{let d=wi();return t.forEach(((f,m)=>{const y=l.get(f);m.isFoundDocument()!==y.isFoundDocument()&&(a=a.add(f)),m.isNoDocument()&&m.version.isEqual(ot.min())?(e.removeEntry(f,m.readTime),d=d.insert(f,m)):!y.isValidDocument()||m.version.compareTo(y.version)>0||m.version.compareTo(y.version)===0&&y.hasPendingWrites?(e.addEntry(m),d=d.insert(f,m)):ze(Mp,"Ignoring outdated watch update for ",f,". Current version:",y.version," Watch version:",m.version)})),{Ls:d,ks:a}}))}function DN(n,e){const t=lt(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(s=>(e===void 0&&(e=Sp),t.mutationQueue.getNextMutationBatchAfterBatchId(s,e))))}function VN(n,e){const t=lt(n);return t.persistence.runTransaction("Allocate target","readwrite",(s=>{let a;return t.hi.getTargetData(s,e).next((l=>l?(a=l,ye.resolve(a)):t.hi.allocateTargetId(s).next((d=>(a=new Yi(e,d,"TargetPurposeListen",s.currentSequenceNumber),t.hi.addTargetData(s,a).next((()=>a)))))))})).then((s=>{const a=t.Fs.get(s.targetId);return(a===null||s.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(t.Fs=t.Fs.insert(s.targetId,s),t.Ms.set(e,s.targetId)),s}))}async function qf(n,e,t){const s=lt(n),a=s.Fs.get(e),l=t?"readwrite":"readwrite-primary";try{t||await s.persistence.runTransaction("Release target",l,(d=>s.persistence.referenceDelegate.removeTarget(d,a)))}catch(d){if(!Zo(d))throw d;ze(Mp,`Failed to update sequence numbers for target ${e}: ${d}`)}s.Fs=s.Fs.remove(e),s.Ms.delete(a.target)}function Bv(n,e,t){const s=lt(n);let a=ot.min(),l=vt();return s.persistence.runTransaction("Execute query","readwrite",(d=>(function(m,y,x){const E=lt(m),C=E.Ms.get(x);return C!==void 0?ye.resolve(E.Fs.get(C)):E.hi.getTargetData(y,x)})(s,d,qs(e)).next((f=>{if(f)return a=f.lastLimboFreeSnapshotVersion,s.hi.getMatchingKeysForTargetId(d,f.targetId).next((m=>{l=m}))})).next((()=>s.Cs.getDocumentsMatchingQuery(d,e,t?a:ot.min(),t?l:vt()))).next((f=>(LN(s,wI(e),f),{documents:f,qs:l})))))}function LN(n,e,t){let s=n.xs.get(e)||ot.min();t.forEach(((a,l)=>{l.readTime.compareTo(s)>0&&(s=l.readTime)})),n.xs.set(e,s)}class Wv{constructor(){this.activeTargetIds=II()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class MN{constructor(){this.Fo=new Wv,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,s){}addLocalQueryTarget(e,t=!0){return t&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,t,s){this.Mo[e]=t}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new Wv,Promise.resolve()}handleUserChange(e,t,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ON{xo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gv="ConnectivityMonitor";class qv{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){ze(Gv,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){ze(Gv,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Tu=null;function Hf(){return Tu===null?Tu=(function(){return 268435456+Math.round(2147483648*Math.random())})():Tu++,"0x"+Tu.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mf="RestConnection",FN={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class UN{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.$o=t+"://"+e.host,this.Uo=`projects/${s}/databases/${a}`,this.Ko=this.databaseId.database===Ku?`project_id=${s}`:`project_id=${s}&database_id=${a}`}Wo(e,t,s,a,l){const d=Hf(),f=this.Go(e,t.toUriEncodedString());ze(mf,`Sending RPC '${e}' ${d}:`,f,s);const m={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(m,a,l);const{host:y}=new URL(f),x=Ho(y);return this.jo(e,f,m,s,x).then((E=>(ze(mf,`Received RPC '${e}' ${d}: `,E),E)),(E=>{throw ra(mf,`RPC '${e}' ${d} failed with error: `,E,"url: ",f,"request:",s),E}))}Jo(e,t,s,a,l,d){return this.Wo(e,t,s,a,l)}zo(e,t,s){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Jo})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((a,l)=>e[l]=a)),s&&s.headers.forEach(((a,l)=>e[l]=a))}Go(e,t){const s=FN[e];return`${this.$o}/v1/${t}:${s}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zN{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ir="WebChannelConnection";class $N extends UN{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,t,s,a,l){const d=Hf();return new Promise(((f,m)=>{const y=new L0;y.setWithCredentials(!0),y.listenOnce(M0.COMPLETE,(()=>{try{switch(y.getLastErrorCode()){case Ru.NO_ERROR:const E=y.getResponseJson();ze(ir,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(E)),f(E);break;case Ru.TIMEOUT:ze(ir,`RPC '${e}' ${d} timed out`),m(new Fe(pe.DEADLINE_EXCEEDED,"Request time out"));break;case Ru.HTTP_ERROR:const C=y.getStatus();if(ze(ir,`RPC '${e}' ${d} failed with status:`,C,"response text:",y.getResponseText()),C>0){let O=y.getResponseJson();Array.isArray(O)&&(O=O[0]);const X=O==null?void 0:O.error;if(X&&X.status&&X.message){const B=(function(se){const we=se.toLowerCase().replace(/_/g,"-");return Object.values(pe).indexOf(we)>=0?we:pe.UNKNOWN})(X.status);m(new Fe(B,X.message))}else m(new Fe(pe.UNKNOWN,"Server responded with status "+y.getStatus()))}else m(new Fe(pe.UNAVAILABLE,"Connection failed."));break;default:rt(9055,{c_:e,streamId:d,l_:y.getLastErrorCode(),h_:y.getLastError()})}}finally{ze(ir,`RPC '${e}' ${d} completed.`)}}));const x=JSON.stringify(a);ze(ir,`RPC '${e}' ${d} sending request:`,a),y.send(t,"POST",x,s,15)}))}P_(e,t,s){const a=Hf(),l=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=U0(),f=F0(),m={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},y=this.longPollingOptions.timeoutSeconds;y!==void 0&&(m.longPollingTimeout=Math.round(1e3*y)),this.useFetchStreams&&(m.useFetchStreams=!0),this.zo(m.initMessageHeaders,t,s),m.encodeInitMessageHeaders=!0;const x=l.join("");ze(ir,`Creating RPC '${e}' stream ${a}: ${x}`,m);const E=d.createWebChannel(x,m);this.T_(E);let C=!1,O=!1;const X=new zN({Ho:U=>{O?ze(ir,`Not sending because RPC '${e}' stream ${a} is closed:`,U):(C||(ze(ir,`Opening RPC '${e}' stream ${a} transport.`),E.open(),C=!0),ze(ir,`RPC '${e}' stream ${a} sending:`,U),E.send(U))},Yo:()=>E.close()}),B=(U,se,we)=>{U.listen(se,(_e=>{try{we(_e)}catch(ve){setTimeout((()=>{throw ve}),0)}}))};return B(E,kl.EventType.OPEN,(()=>{O||(ze(ir,`RPC '${e}' stream ${a} transport opened.`),X.s_())})),B(E,kl.EventType.CLOSE,(()=>{O||(O=!0,ze(ir,`RPC '${e}' stream ${a} transport closed`),X.__(),this.I_(E))})),B(E,kl.EventType.ERROR,(U=>{O||(O=!0,ra(ir,`RPC '${e}' stream ${a} transport errored. Name:`,U.name,"Message:",U.message),X.__(new Fe(pe.UNAVAILABLE,"The operation could not be completed")))})),B(E,kl.EventType.MESSAGE,(U=>{var se;if(!O){const we=U.data[0];At(!!we,16349);const _e=we,ve=(_e==null?void 0:_e.error)||((se=_e[0])===null||se===void 0?void 0:se.error);if(ve){ze(ir,`RPC '${e}' stream ${a} received error:`,ve);const L=ve.status;let ie=(function(A){const M=pn[A];if(M!==void 0)return wx(M)})(L),I=ve.message;ie===void 0&&(ie=pe.INTERNAL,I="Unknown error status: "+L+" with message "+ve.message),O=!0,X.__(new Fe(ie,I)),E.close()}else ze(ir,`RPC '${e}' stream ${a} received:`,we),X.a_(we)}})),B(f,O0.STAT_EVENT,(U=>{U.stat===Vf.PROXY?ze(ir,`RPC '${e}' stream ${a} detected buffering proxy`):U.stat===Vf.NOPROXY&&ze(ir,`RPC '${e}' stream ${a} detected no buffering proxy`)})),setTimeout((()=>{X.o_()}),0),X}terminate(){this.u_.forEach((e=>e.close())),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter((t=>t===e))}}function gf(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ed(n){return new qI(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vx{constructor(e,t,s=1e3,a=1.5,l=6e4){this.Fi=e,this.timerId=t,this.d_=s,this.E_=a,this.A_=l,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const t=Math.floor(this.R_+this.p_()),s=Math.max(0,Date.now()-this.m_),a=Math.max(0,t-s);a>0&&ze("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.R_} ms, delay with jitter: ${t} ms, last attempt: ${s} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,a,(()=>(this.m_=Date.now(),e()))),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hv="PersistentStream";class Lx{constructor(e,t,s,a,l,d,f,m){this.Fi=e,this.w_=s,this.S_=a,this.connection=l,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=f,this.listener=m,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new Vx(e,t)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,(()=>this.L_())))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():t&&t.code===pe.RESOURCE_EXHAUSTED?(xi(t.toString()),xi("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):t&&t.code===pe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(t)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),t=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([s,a])=>{this.b_===t&&this.W_(s,a)}),(s=>{e((()=>{const a=new Fe(pe.UNKNOWN,"Fetching auth token failed: "+s.message);return this.G_(a)}))}))}W_(e,t){const s=this.K_(this.b_);this.stream=this.z_(e,t),this.stream.Zo((()=>{s((()=>this.listener.Zo()))})),this.stream.e_((()=>{s((()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,(()=>(this.x_()&&(this.state=3),Promise.resolve()))),this.listener.e_())))})),this.stream.n_((a=>{s((()=>this.G_(a)))})),this.stream.onMessage((a=>{s((()=>++this.C_==1?this.j_(a):this.onNext(a)))}))}O_(){this.state=5,this.F_.g_((async()=>{this.state=0,this.start()}))}G_(e){return ze(Hv,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return t=>{this.Fi.enqueueAndForget((()=>this.b_===e?t():(ze(Hv,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class BN extends Lx{constructor(e,t,s,a,l,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,s,a,d),this.serializer=l}z_(e,t){return this.connection.P_("Listen",e,t)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const t=QI(this.serializer,e),s=(function(l){if(!("targetChange"in l))return ot.min();const d=l.targetChange;return d.targetIds&&d.targetIds.length?ot.min():d.readTime?Hs(d.readTime):ot.min()})(e);return this.listener.J_(t,s)}H_(e){const t={};t.database=Gf(this.serializer),t.addTarget=(function(l,d){let f;const m=d.target;if(f=Uf(m)?{documents:XI(l,m)}:{query:ZI(l,m).Vt},f.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){f.resumeToken=Sx(l,d.resumeToken);const y=$f(l,d.expectedCount);y!==null&&(f.expectedCount=y)}else if(d.snapshotVersion.compareTo(ot.min())>0){f.readTime=Zu(l,d.snapshotVersion.toTimestamp());const y=$f(l,d.expectedCount);y!==null&&(f.expectedCount=y)}return f})(this.serializer,e);const s=tN(this.serializer,e);s&&(t.labels=s),this.k_(t)}Y_(e){const t={};t.database=Gf(this.serializer),t.removeTarget=e,this.k_(t)}}class WN extends Lx{constructor(e,t,s,a,l,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,s,a,d),this.serializer=l}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,t){return this.connection.P_("Write",e,t)}j_(e){return At(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,At(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){At(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();const t=JI(e.writeResults,e.commitTime),s=Hs(e.commitTime);return this.listener.ta(s,t)}na(){const e={};e.database=Gf(this.serializer),this.k_(e)}X_(e){const t={streamToken:this.lastStreamToken,writes:e.map((s=>YI(this.serializer,s)))};this.k_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GN{}class qN extends GN{constructor(e,t,s,a){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=s,this.serializer=a,this.ra=!1}ia(){if(this.ra)throw new Fe(pe.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,s,a){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,d])=>this.connection.Wo(e,Bf(t,s),a,l,d))).catch((l=>{throw l.name==="FirebaseError"?(l.code===pe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new Fe(pe.UNKNOWN,l.toString())}))}Jo(e,t,s,a,l){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([d,f])=>this.connection.Jo(e,Bf(t,s),a,d,f,l))).catch((d=>{throw d.name==="FirebaseError"?(d.code===pe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new Fe(pe.UNKNOWN,d.toString())}))}terminate(){this.ra=!0,this.connection.terminate()}}class HN{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve()))))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(xi(t),this._a=!1):ze("OnlineStateTracker",t)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qa="RemoteStore";class KN{constructor(e,t,s,a,l){this.localStore=e,this.datastore=t,this.asyncQueue=s,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=l,this.Ea.xo((d=>{s.enqueueAndForget((async()=>{Ka(this)&&(ze(qa,"Restarting streams for network reachability change."),await(async function(m){const y=lt(m);y.Ia.add(4),await hc(y),y.Aa.set("Unknown"),y.Ia.delete(4),await Td(y)})(this))}))})),this.Aa=new HN(s,a)}}async function Td(n){if(Ka(n))for(const e of n.da)await e(!0)}async function hc(n){for(const e of n.da)await e(!1)}function Mx(n,e){const t=lt(n);t.Ta.has(e.targetId)||(t.Ta.set(e.targetId,e),zp(t)?Up(t):tl(t).x_()&&Fp(t,e))}function Op(n,e){const t=lt(n),s=tl(t);t.Ta.delete(e),s.x_()&&Ox(t,e),t.Ta.size===0&&(s.x_()?s.B_():Ka(t)&&t.Aa.set("Unknown"))}function Fp(n,e){if(n.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ot.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}tl(n).H_(e)}function Ox(n,e){n.Ra.$e(e),tl(n).Y_(e)}function Up(n){n.Ra=new $I({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>n.Ta.get(e)||null,lt:()=>n.datastore.serializer.databaseId}),tl(n).start(),n.Aa.aa()}function zp(n){return Ka(n)&&!tl(n).M_()&&n.Ta.size>0}function Ka(n){return lt(n).Ia.size===0}function Fx(n){n.Ra=void 0}async function QN(n){n.Aa.set("Online")}async function YN(n){n.Ta.forEach(((e,t)=>{Fp(n,e)}))}async function JN(n,e){Fx(n),zp(n)?(n.Aa.la(e),Up(n)):n.Aa.set("Unknown")}async function XN(n,e,t){if(n.Aa.set("Online"),e instanceof Tx&&e.state===2&&e.cause)try{await(async function(a,l){const d=l.cause;for(const f of l.targetIds)a.Ta.has(f)&&(await a.remoteSyncer.rejectListen(f,d),a.Ta.delete(f),a.Ra.removeTarget(f))})(n,e)}catch(s){ze(qa,"Failed to remove targets %s: %s ",e.targetIds.join(","),s),await td(n,s)}else if(e instanceof Du?n.Ra.Ye(e):e instanceof Ex?n.Ra.it(e):n.Ra.et(e),!t.isEqual(ot.min()))try{const s=await Dx(n.localStore);t.compareTo(s)>=0&&await(function(l,d){const f=l.Ra.Pt(d);return f.targetChanges.forEach(((m,y)=>{if(m.resumeToken.approximateByteSize()>0){const x=l.Ta.get(y);x&&l.Ta.set(y,x.withResumeToken(m.resumeToken,d))}})),f.targetMismatches.forEach(((m,y)=>{const x=l.Ta.get(m);if(!x)return;l.Ta.set(m,x.withResumeToken(Gn.EMPTY_BYTE_STRING,x.snapshotVersion)),Ox(l,m);const E=new Yi(x.target,m,y,x.sequenceNumber);Fp(l,E)})),l.remoteSyncer.applyRemoteEvent(f)})(n,t)}catch(s){ze(qa,"Failed to raise snapshot:",s),await td(n,s)}}async function td(n,e,t){if(!Zo(e))throw e;n.Ia.add(1),await hc(n),n.Aa.set("Offline"),t||(t=()=>Dx(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{ze(qa,"Retrying IndexedDB access"),await t(),n.Ia.delete(1),await Td(n)}))}function Ux(n,e){return e().catch((t=>td(n,t,e)))}async function Sd(n){const e=lt(n),t=la(e);let s=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:Sp;for(;ZN(e);)try{const a=await DN(e.localStore,s);if(a===null){e.Pa.length===0&&t.B_();break}s=a.batchId,eP(e,a)}catch(a){await td(e,a)}zx(e)&&$x(e)}function ZN(n){return Ka(n)&&n.Pa.length<10}function eP(n,e){n.Pa.push(e);const t=la(n);t.x_()&&t.Z_&&t.X_(e.mutations)}function zx(n){return Ka(n)&&!la(n).M_()&&n.Pa.length>0}function $x(n){la(n).start()}async function tP(n){la(n).na()}async function nP(n){const e=la(n);for(const t of n.Pa)e.X_(t.mutations)}async function rP(n,e,t){const s=n.Pa.shift(),a=Ap.from(s,e,t);await Ux(n,(()=>n.remoteSyncer.applySuccessfulWrite(a))),await Sd(n)}async function sP(n,e){e&&la(n).Z_&&await(async function(s,a){if((function(d){return UI(d)&&d!==pe.ABORTED})(a.code)){const l=s.Pa.shift();la(s).N_(),await Ux(s,(()=>s.remoteSyncer.rejectFailedWrite(l.batchId,a))),await Sd(s)}})(n,e),zx(n)&&$x(n)}async function Kv(n,e){const t=lt(n);t.asyncQueue.verifyOperationInProgress(),ze(qa,"RemoteStore received new credentials");const s=Ka(t);t.Ia.add(3),await hc(t),s&&t.Aa.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ia.delete(3),await Td(t)}async function iP(n,e){const t=lt(n);e?(t.Ia.delete(2),await Td(t)):e||(t.Ia.add(2),await hc(t),t.Aa.set("Unknown"))}function tl(n){return n.Va||(n.Va=(function(t,s,a){const l=lt(t);return l.ia(),new BN(s,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(n.datastore,n.asyncQueue,{Zo:QN.bind(null,n),e_:YN.bind(null,n),n_:JN.bind(null,n),J_:XN.bind(null,n)}),n.da.push((async e=>{e?(n.Va.N_(),zp(n)?Up(n):n.Aa.set("Unknown")):(await n.Va.stop(),Fx(n))}))),n.Va}function la(n){return n.ma||(n.ma=(function(t,s,a){const l=lt(t);return l.ia(),new WN(s,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),e_:tP.bind(null,n),n_:sP.bind(null,n),ea:nP.bind(null,n),ta:rP.bind(null,n)}),n.da.push((async e=>{e?(n.ma.N_(),await Sd(n)):(await n.ma.stop(),n.Pa.length>0&&(ze(qa,`Stopping write stream with ${n.Pa.length} pending writes`),n.Pa=[]))}))),n.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $p{constructor(e,t,s,a,l){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=s,this.op=a,this.removalCallback=l,this.deferred=new gi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((d=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,s,a,l){const d=Date.now()+s,f=new $p(e,t,d,a,l);return f.start(s),f}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Fe(pe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Bp(n,e){if(xi("AsyncQueue",`${e}: ${n}`),Zo(n))return new Fe(pe.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lo{static emptySet(e){return new Lo(e.comparator)}constructor(e){this.comparator=e?(t,s)=>e(t,s)||Ye.comparator(t.key,s.key):(t,s)=>Ye.comparator(t.key,s.key),this.keyedMap=Dl(),this.sortedSet=new Xt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,s)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Lo)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=s.getNext().key;if(!a.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const s=new Lo;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=t,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qv{constructor(){this.fa=new Xt(Ye.comparator)}track(e){const t=e.doc.key,s=this.fa.get(t);s?e.type!==0&&s.type===3?this.fa=this.fa.insert(t,e):e.type===3&&s.type!==1?this.fa=this.fa.insert(t,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.fa=this.fa.insert(t,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.fa=this.fa.remove(t):e.type===1&&s.type===2?this.fa=this.fa.insert(t,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):rt(63341,{At:e,ga:s}):this.fa=this.fa.insert(t,e)}pa(){const e=[];return this.fa.inorderTraversal(((t,s)=>{e.push(s)})),e}}class Bo{constructor(e,t,s,a,l,d,f,m,y){this.query=e,this.docs=t,this.oldDocs=s,this.docChanges=a,this.mutatedKeys=l,this.fromCache=d,this.syncStateChanged=f,this.excludesMetadataChanges=m,this.hasCachedResults=y}static fromInitialDocuments(e,t,s,a,l){const d=[];return t.forEach((f=>{d.push({type:0,doc:f})})),new Bo(e,t,Lo.emptySet(t),d,s,a,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&yd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,s=e.docChanges;if(t.length!==s.length)return!1;for(let a=0;a<t.length;a++)if(t[a].type!==s[a].type||!t[a].doc.isEqual(s[a].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aP{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some((e=>e.ba()))}}class oP{constructor(){this.queries=Yv(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(t,s){const a=lt(t),l=a.queries;a.queries=Yv(),l.forEach(((d,f)=>{for(const m of f.wa)m.onError(s)}))})(this,new Fe(pe.ABORTED,"Firestore shutting down"))}}function Yv(){return new Ha((n=>cx(n)),yd)}async function Wp(n,e){const t=lt(n);let s=3;const a=e.query;let l=t.queries.get(a);l?!l.Sa()&&e.ba()&&(s=2):(l=new aP,s=e.ba()?0:1);try{switch(s){case 0:l.ya=await t.onListen(a,!0);break;case 1:l.ya=await t.onListen(a,!1);break;case 2:await t.onFirstRemoteStoreListen(a)}}catch(d){const f=Bp(d,`Initialization of query '${Ro(e.query)}' failed`);return void e.onError(f)}t.queries.set(a,l),l.wa.push(e),e.va(t.onlineState),l.ya&&e.Ca(l.ya)&&qp(t)}async function Gp(n,e){const t=lt(n),s=e.query;let a=3;const l=t.queries.get(s);if(l){const d=l.wa.indexOf(e);d>=0&&(l.wa.splice(d,1),l.wa.length===0?a=e.ba()?0:1:!l.Sa()&&e.ba()&&(a=2))}switch(a){case 0:return t.queries.delete(s),t.onUnlisten(s,!0);case 1:return t.queries.delete(s),t.onUnlisten(s,!1);case 2:return t.onLastRemoteStoreUnlisten(s);default:return}}function lP(n,e){const t=lt(n);let s=!1;for(const a of e){const l=a.query,d=t.queries.get(l);if(d){for(const f of d.wa)f.Ca(a)&&(s=!0);d.ya=a}}s&&qp(t)}function cP(n,e,t){const s=lt(n),a=s.queries.get(e);if(a)for(const l of a.wa)l.onError(t);s.queries.delete(e)}function qp(n){n.Da.forEach((e=>{e.next()}))}var Kf,Jv;(Jv=Kf||(Kf={})).Fa="default",Jv.Cache="cache";class Hp{constructor(e,t,s){this.query=e,this.Ma=t,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=s||{}}Ca(e){if(!this.options.includeMetadataChanges){const s=[];for(const a of e.docChanges)a.type!==3&&s.push(a);e=new Bo(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),t=!0):this.Ba(e,this.onlineState)&&(this.La(e),t=!0),this.Oa=e,t}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let t=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),t=!0),t}Ba(e,t){if(!e.fromCache||!this.ba())return!0;const s=t!=="Offline";return(!this.options.ka||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Na(e){if(e.docChanges.length>0)return!0;const t=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}La(e){e=Bo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==Kf.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bx{constructor(e){this.key=e}}class Wx{constructor(e){this.key=e}}class uP{constructor(e,t){this.query=e,this.Ha=t,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=vt(),this.mutatedKeys=vt(),this.Xa=ux(e),this.eu=new Lo(this.Xa)}get tu(){return this.Ha}nu(e,t){const s=t?t.ru:new Qv,a=t?t.eu:this.eu;let l=t?t.mutatedKeys:this.mutatedKeys,d=a,f=!1;const m=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,y=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal(((x,E)=>{const C=a.get(x),O=vd(this.query,E)?E:null,X=!!C&&this.mutatedKeys.has(C.key),B=!!O&&(O.hasLocalMutations||this.mutatedKeys.has(O.key)&&O.hasCommittedMutations);let U=!1;C&&O?C.data.isEqual(O.data)?X!==B&&(s.track({type:3,doc:O}),U=!0):this.iu(C,O)||(s.track({type:2,doc:O}),U=!0,(m&&this.Xa(O,m)>0||y&&this.Xa(O,y)<0)&&(f=!0)):!C&&O?(s.track({type:0,doc:O}),U=!0):C&&!O&&(s.track({type:1,doc:C}),U=!0,(m||y)&&(f=!0)),U&&(O?(d=d.add(O),l=B?l.add(x):l.delete(x)):(d=d.delete(x),l=l.delete(x)))})),this.query.limit!==null)for(;d.size>this.query.limit;){const x=this.query.limitType==="F"?d.last():d.first();d=d.delete(x.key),l=l.delete(x.key),s.track({type:1,doc:x})}return{eu:d,ru:s,Ds:f,mutatedKeys:l}}iu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,s,a){const l=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const d=e.ru.pa();d.sort(((x,E)=>(function(O,X){const B=U=>{switch(U){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return rt(20277,{At:U})}};return B(O)-B(X)})(x.type,E.type)||this.Xa(x.doc,E.doc))),this.su(s),a=a!=null&&a;const f=t&&!a?this.ou():[],m=this.Za.size===0&&this.current&&!a?1:0,y=m!==this.Ya;return this.Ya=m,d.length!==0||y?{snapshot:new Bo(this.query,e.eu,l,d,e.mutatedKeys,m===0,y,!1,!!s&&s.resumeToken.approximateByteSize()>0),_u:f}:{_u:f}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new Qv,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach((t=>this.Ha=this.Ha.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ha=this.Ha.delete(t))),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=vt(),this.eu.forEach((s=>{this.au(s.key)&&(this.Za=this.Za.add(s.key))}));const t=[];return e.forEach((s=>{this.Za.has(s)||t.push(new Wx(s))})),this.Za.forEach((s=>{e.has(s)||t.push(new Bx(s))})),t}uu(e){this.Ha=e.qs,this.Za=vt();const t=this.nu(e.documents);return this.applyChanges(t,!0)}cu(){return Bo.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const Kp="SyncEngine";class dP{constructor(e,t,s){this.query=e,this.targetId=t,this.view=s}}class hP{constructor(e){this.key=e,this.lu=!1}}class fP{constructor(e,t,s,a,l,d){this.localStore=e,this.remoteStore=t,this.eventManager=s,this.sharedClientState=a,this.currentUser=l,this.maxConcurrentLimboResolutions=d,this.hu={},this.Pu=new Ha((f=>cx(f)),yd),this.Tu=new Map,this.Iu=new Set,this.du=new Xt(Ye.comparator),this.Eu=new Map,this.Au=new Dp,this.Ru={},this.Vu=new Map,this.mu=$o.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function pP(n,e,t=!0){const s=Yx(n);let a;const l=s.Pu.get(e);return l?(s.sharedClientState.addLocalQueryTarget(l.targetId),a=l.view.cu()):a=await Gx(s,e,t,!0),a}async function mP(n,e){const t=Yx(n);await Gx(t,e,!0,!1)}async function Gx(n,e,t,s){const a=await VN(n.localStore,qs(e)),l=a.targetId,d=n.sharedClientState.addLocalQueryTarget(l,t);let f;return s&&(f=await gP(n,e,l,d==="current",a.resumeToken)),n.isPrimaryClient&&t&&Mx(n.remoteStore,a),f}async function gP(n,e,t,s,a){n.gu=(E,C,O)=>(async function(B,U,se,we){let _e=U.view.nu(se);_e.Ds&&(_e=await Bv(B.localStore,U.query,!1).then((({documents:I})=>U.view.nu(I,_e))));const ve=we&&we.targetChanges.get(U.targetId),L=we&&we.targetMismatches.get(U.targetId)!=null,ie=U.view.applyChanges(_e,B.isPrimaryClient,ve,L);return Zv(B,U.targetId,ie._u),ie.snapshot})(n,E,C,O);const l=await Bv(n.localStore,e,!0),d=new uP(e,l.qs),f=d.nu(l.documents),m=dc.createSynthesizedTargetChangeForCurrentChange(t,s&&n.onlineState!=="Offline",a),y=d.applyChanges(f,n.isPrimaryClient,m);Zv(n,t,y._u);const x=new dP(e,t,d);return n.Pu.set(e,x),n.Tu.has(t)?n.Tu.get(t).push(e):n.Tu.set(t,[e]),y.snapshot}async function yP(n,e,t){const s=lt(n),a=s.Pu.get(e),l=s.Tu.get(a.targetId);if(l.length>1)return s.Tu.set(a.targetId,l.filter((d=>!yd(d,e)))),void s.Pu.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(a.targetId),s.sharedClientState.isActiveQueryTarget(a.targetId)||await qf(s.localStore,a.targetId,!1).then((()=>{s.sharedClientState.clearQueryState(a.targetId),t&&Op(s.remoteStore,a.targetId),Qf(s,a.targetId)})).catch(Xo)):(Qf(s,a.targetId),await qf(s.localStore,a.targetId,!0))}async function vP(n,e){const t=lt(n),s=t.Pu.get(e),a=t.Tu.get(s.targetId);t.isPrimaryClient&&a.length===1&&(t.sharedClientState.removeLocalQueryTarget(s.targetId),Op(t.remoteStore,s.targetId))}async function _P(n,e,t){const s=CP(n);try{const a=await(function(d,f){const m=lt(d),y=Ht.now(),x=f.reduce(((O,X)=>O.add(X.key)),vt());let E,C;return m.persistence.runTransaction("Locally write mutations","readwrite",(O=>{let X=wi(),B=vt();return m.Os.getEntries(O,x).next((U=>{X=U,X.forEach(((se,we)=>{we.isValidDocument()||(B=B.add(se))}))})).next((()=>m.localDocuments.getOverlayedDocuments(O,X))).next((U=>{E=U;const se=[];for(const we of f){const _e=VI(we,E.get(we.key).overlayedDocument);_e!=null&&se.push(new ma(we.key,_e,tx(_e.value.mapValue),ms.exists(!0)))}return m.mutationQueue.addMutationBatch(O,y,se,f)})).next((U=>{C=U;const se=U.applyToLocalDocumentSet(E,B);return m.documentOverlayCache.saveOverlays(O,U.batchId,se)}))})).then((()=>({batchId:C.batchId,changes:hx(E)})))})(s.localStore,e);s.sharedClientState.addPendingMutation(a.batchId),(function(d,f,m){let y=d.Ru[d.currentUser.toKey()];y||(y=new Xt(ft)),y=y.insert(f,m),d.Ru[d.currentUser.toKey()]=y})(s,a.batchId,t),await fc(s,a.changes),await Sd(s.remoteStore)}catch(a){const l=Bp(a,"Failed to persist write");t.reject(l)}}async function qx(n,e){const t=lt(n);try{const s=await jN(t.localStore,e);e.targetChanges.forEach(((a,l)=>{const d=t.Eu.get(l);d&&(At(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?d.lu=!0:a.modifiedDocuments.size>0?At(d.lu,14607):a.removedDocuments.size>0&&(At(d.lu,42227),d.lu=!1))})),await fc(t,s,e)}catch(s){await Xo(s)}}function Xv(n,e,t){const s=lt(n);if(s.isPrimaryClient&&t===0||!s.isPrimaryClient&&t===1){const a=[];s.Pu.forEach(((l,d)=>{const f=d.view.va(e);f.snapshot&&a.push(f.snapshot)})),(function(d,f){const m=lt(d);m.onlineState=f;let y=!1;m.queries.forEach(((x,E)=>{for(const C of E.wa)C.va(f)&&(y=!0)})),y&&qp(m)})(s.eventManager,e),a.length&&s.hu.J_(a),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function xP(n,e,t){const s=lt(n);s.sharedClientState.updateQueryState(e,"rejected",t);const a=s.Eu.get(e),l=a&&a.key;if(l){let d=new Xt(Ye.comparator);d=d.insert(l,or.newNoDocument(l,ot.min()));const f=vt().add(l),m=new wd(ot.min(),new Map,new Xt(ft),d,f);await qx(s,m),s.du=s.du.remove(l),s.Eu.delete(e),Qp(s)}else await qf(s.localStore,e,!1).then((()=>Qf(s,e,t))).catch(Xo)}async function wP(n,e){const t=lt(n),s=e.batch.batchId;try{const a=await AN(t.localStore,e);Kx(t,s,null),Hx(t,s),t.sharedClientState.updateMutationState(s,"acknowledged"),await fc(t,a)}catch(a){await Xo(a)}}async function EP(n,e,t){const s=lt(n);try{const a=await(function(d,f){const m=lt(d);return m.persistence.runTransaction("Reject batch","readwrite-primary",(y=>{let x;return m.mutationQueue.lookupMutationBatch(y,f).next((E=>(At(E!==null,37113),x=E.keys(),m.mutationQueue.removeMutationBatch(y,E)))).next((()=>m.mutationQueue.performConsistencyCheck(y))).next((()=>m.documentOverlayCache.removeOverlaysForBatchId(y,x,f))).next((()=>m.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(y,x))).next((()=>m.localDocuments.getDocuments(y,x)))}))})(s.localStore,e);Kx(s,e,t),Hx(s,e),s.sharedClientState.updateMutationState(e,"rejected",t),await fc(s,a)}catch(a){await Xo(a)}}function Hx(n,e){(n.Vu.get(e)||[]).forEach((t=>{t.resolve()})),n.Vu.delete(e)}function Kx(n,e,t){const s=lt(n);let a=s.Ru[s.currentUser.toKey()];if(a){const l=a.get(e);l&&(t?l.reject(t):l.resolve(),a=a.remove(e)),s.Ru[s.currentUser.toKey()]=a}}function Qf(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const s of n.Tu.get(e))n.Pu.delete(s),t&&n.hu.pu(s,t);n.Tu.delete(e),n.isPrimaryClient&&n.Au.zr(e).forEach((s=>{n.Au.containsKey(s)||Qx(n,s)}))}function Qx(n,e){n.Iu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(Op(n.remoteStore,t),n.du=n.du.remove(e),n.Eu.delete(t),Qp(n))}function Zv(n,e,t){for(const s of t)s instanceof Bx?(n.Au.addReference(s.key,e),TP(n,s)):s instanceof Wx?(ze(Kp,"Document no longer in limbo: "+s.key),n.Au.removeReference(s.key,e),n.Au.containsKey(s.key)||Qx(n,s.key)):rt(19791,{yu:s})}function TP(n,e){const t=e.key,s=t.path.canonicalString();n.du.get(t)||n.Iu.has(s)||(ze(Kp,"New document in limbo: "+t),n.Iu.add(s),Qp(n))}function Qp(n){for(;n.Iu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Iu.values().next().value;n.Iu.delete(e);const t=new Ye($t.fromString(e)),s=n.mu.next();n.Eu.set(s,new hP(t)),n.du=n.du.insert(t,s),Mx(n.remoteStore,new Yi(qs(gd(t.path)),s,"TargetPurposeLimboResolution",fd.ue))}}async function fc(n,e,t){const s=lt(n),a=[],l=[],d=[];s.Pu.isEmpty()||(s.Pu.forEach(((f,m)=>{d.push(s.gu(m,e,t).then((y=>{var x;if((y||t)&&s.isPrimaryClient){const E=y?!y.fromCache:(x=t==null?void 0:t.targetChanges.get(m.targetId))===null||x===void 0?void 0:x.current;s.sharedClientState.updateQueryState(m.targetId,E?"current":"not-current")}if(y){a.push(y);const E=Lp.Es(m.targetId,y);l.push(E)}})))})),await Promise.all(d),s.hu.J_(a),await(async function(m,y){const x=lt(m);try{await x.persistence.runTransaction("notifyLocalViewChanges","readwrite",(E=>ye.forEach(y,(C=>ye.forEach(C.Is,(O=>x.persistence.referenceDelegate.addReference(E,C.targetId,O))).next((()=>ye.forEach(C.ds,(O=>x.persistence.referenceDelegate.removeReference(E,C.targetId,O)))))))))}catch(E){if(!Zo(E))throw E;ze(Mp,"Failed to update sequence numbers: "+E)}for(const E of y){const C=E.targetId;if(!E.fromCache){const O=x.Fs.get(C),X=O.snapshotVersion,B=O.withLastLimboFreeSnapshotVersion(X);x.Fs=x.Fs.insert(C,B)}}})(s.localStore,l))}async function SP(n,e){const t=lt(n);if(!t.currentUser.isEqual(e)){ze(Kp,"User change. New user:",e.toKey());const s=await kx(t.localStore,e);t.currentUser=e,(function(l,d){l.Vu.forEach((f=>{f.forEach((m=>{m.reject(new Fe(pe.CANCELLED,d))}))})),l.Vu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await fc(t,s.Bs)}}function bP(n,e){const t=lt(n),s=t.Eu.get(e);if(s&&s.lu)return vt().add(s.key);{let a=vt();const l=t.Tu.get(e);if(!l)return a;for(const d of l){const f=t.Pu.get(d);a=a.unionWith(f.view.tu)}return a}}function Yx(n){const e=lt(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=qx.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=bP.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=xP.bind(null,e),e.hu.J_=lP.bind(null,e.eventManager),e.hu.pu=cP.bind(null,e.eventManager),e}function CP(n){const e=lt(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=wP.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=EP.bind(null,e),e}class nd{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Ed(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,t){return null}Fu(e,t){return null}vu(e){return RN(this.persistence,new IN,e.initialUser,this.serializer)}Du(e){return new jx(Vp.Vi,this.serializer)}bu(e){return new MN}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}nd.provider={build:()=>new nd};class IP extends nd{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,t){At(this.persistence.referenceDelegate instanceof ed,46915);const s=this.persistence.referenceDelegate.garbageCollector;return new hN(s,e.asyncQueue,t)}Du(e){const t=this.cacheSizeBytes!==void 0?kr.withCacheSize(this.cacheSizeBytes):kr.DEFAULT;return new jx((s=>ed.Vi(s,t)),this.serializer)}}class Yf{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>Xv(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=SP.bind(null,this.syncEngine),await iP(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new oP})()}createDatastore(e){const t=Ed(e.databaseInfo.databaseId),s=(function(l){return new $N(l)})(e.databaseInfo);return(function(l,d,f,m){return new qN(l,d,f,m)})(e.authCredentials,e.appCheckCredentials,s,t)}createRemoteStore(e){return(function(s,a,l,d,f){return new KN(s,a,l,d,f)})(this.localStore,this.datastore,e.asyncQueue,(t=>Xv(this.syncEngine,t,0)),(function(){return qv.C()?new qv:new ON})())}createSyncEngine(e,t){return(function(a,l,d,f,m,y,x){const E=new fP(a,l,d,f,m,y);return x&&(E.fu=!0),E})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(a){const l=lt(a);ze(qa,"RemoteStore shutting down."),l.Ia.add(5),await hc(l),l.Ea.shutdown(),l.Aa.set("Unknown")})(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}Yf.provider={build:()=>new Yf};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yp{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):xi("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ca="FirestoreClient";class NP{constructor(e,t,s,a,l){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=s,this.databaseInfo=a,this.user=ar.UNAUTHENTICATED,this.clientId=Tp.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(s,(async d=>{ze(ca,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d})),this.appCheckCredentials.start(s,(d=>(ze(ca,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new gi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const s=Bp(t,"Failed to shutdown persistence");e.reject(s)}})),e.promise}}async function yf(n,e){n.asyncQueue.verifyOperationInProgress(),ze(ca,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let s=t.initialUser;n.setCredentialChangeListener((async a=>{s.isEqual(a)||(await kx(e.localStore,a),s=a)})),e.persistence.setDatabaseDeletedListener((()=>{ra("Terminating Firestore due to IndexedDb database deletion"),n.terminate().then((()=>{ze("Terminating Firestore due to IndexedDb database deletion completed successfully")})).catch((a=>{ra("Terminating Firestore due to IndexedDb database deletion failed",a)}))})),n._offlineComponents=e}async function e_(n,e){n.asyncQueue.verifyOperationInProgress();const t=await PP(n);ze(ca,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((s=>Kv(e.remoteStore,s))),n.setAppCheckTokenChangeListener(((s,a)=>Kv(e.remoteStore,a))),n._onlineComponents=e}async function PP(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){ze(ca,"Using user provided OfflineComponentProvider");try{await yf(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(a){return a.name==="FirebaseError"?a.code===pe.FAILED_PRECONDITION||a.code===pe.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11})(t))throw t;ra("Error using user provided cache. Falling back to memory cache: "+t),await yf(n,new nd)}}else ze(ca,"Using default OfflineComponentProvider"),await yf(n,new IP(void 0));return n._offlineComponents}async function Jx(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(ze(ca,"Using user provided OnlineComponentProvider"),await e_(n,n._uninitializedComponentsProvider._online)):(ze(ca,"Using default OnlineComponentProvider"),await e_(n,new Yf))),n._onlineComponents}function RP(n){return Jx(n).then((e=>e.syncEngine))}async function rd(n){const e=await Jx(n),t=e.eventManager;return t.onListen=pP.bind(null,e.syncEngine),t.onUnlisten=yP.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=mP.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=vP.bind(null,e.syncEngine),t}function AP(n,e,t={}){const s=new gi;return n.asyncQueue.enqueueAndForget((async()=>(function(l,d,f,m,y){const x=new Yp({next:C=>{x.Ou(),d.enqueueAndForget((()=>Gp(l,E)));const O=C.docs.has(f);!O&&C.fromCache?y.reject(new Fe(pe.UNAVAILABLE,"Failed to get document because the client is offline.")):O&&C.fromCache&&m&&m.source==="server"?y.reject(new Fe(pe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):y.resolve(C)},error:C=>y.reject(C)}),E=new Hp(gd(f.path),x,{includeMetadataChanges:!0,ka:!0});return Wp(l,E)})(await rd(n),n.asyncQueue,e,t,s))),s.promise}function jP(n,e,t={}){const s=new gi;return n.asyncQueue.enqueueAndForget((async()=>(function(l,d,f,m,y){const x=new Yp({next:C=>{x.Ou(),d.enqueueAndForget((()=>Gp(l,E))),C.fromCache&&m.source==="server"?y.reject(new Fe(pe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):y.resolve(C)},error:C=>y.reject(C)}),E=new Hp(f,x,{includeMetadataChanges:!0,ka:!0});return Wp(l,E)})(await rd(n),n.asyncQueue,e,t,s))),s.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xx(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t_=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zx="firestore.googleapis.com",n_=!0;class r_{constructor(e){var t,s;if(e.host===void 0){if(e.ssl!==void 0)throw new Fe(pe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Zx,this.ssl=n_}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:n_;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Ax;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<uN)throw new Fe(pe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}KC("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Xx((s=e.experimentalLongPollingOptions)!==null&&s!==void 0?s:{}),(function(l){if(l.timeoutSeconds!==void 0){if(isNaN(l.timeoutSeconds))throw new Fe(pe.INVALID_ARGUMENT,`invalid long polling timeout: ${l.timeoutSeconds} (must not be NaN)`);if(l.timeoutSeconds<5)throw new Fe(pe.INVALID_ARGUMENT,`invalid long polling timeout: ${l.timeoutSeconds} (minimum allowed value is 5)`);if(l.timeoutSeconds>30)throw new Fe(pe.INVALID_ARGUMENT,`invalid long polling timeout: ${l.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(s,a){return s.timeoutSeconds===a.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class bd{constructor(e,t,s,a){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=s,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new r_({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Fe(pe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Fe(pe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new r_(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(s){if(!s)return new FC;switch(s.type){case"firstParty":return new BC(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new Fe(pe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const s=t_.get(t);s&&(ze("ComponentProvider","Removing Datastore"),t_.delete(t),s.terminate())})(this),Promise.resolve()}}function kP(n,e,t,s={}){var a;n=Vr(n,bd);const l=Ho(e),d=n._getSettings(),f=Object.assign(Object.assign({},d),{emulatorOptions:n._getEmulatorOptions()}),m=`${e}:${t}`;l&&(W_(`https://${m}`),G_("Firestore",!0)),d.host!==Zx&&d.host!==m&&ra("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const y=Object.assign(Object.assign({},d),{host:m,ssl:l,emulatorOptions:s});if(!$a(y,f)&&(n._setSettings(y),s.mockUserToken)){let x,E;if(typeof s.mockUserToken=="string")x=s.mockUserToken,E=ar.MOCK_USER;else{x=H1(s.mockUserToken,(a=n._app)===null||a===void 0?void 0:a.options.projectId);const C=s.mockUserToken.sub||s.mockUserToken.user_id;if(!C)throw new Fe(pe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");E=new ar(C)}n._authCredentials=new UC(new $0(x,E))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bi{constructor(e,t,s){this.converter=t,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new bi(this.firestore,e,this._query)}}class nn{constructor(e,t,s){this.converter=t,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new na(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new nn(this.firestore,e,this._key)}toJSON(){return{type:nn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,s){if(cc(t,nn._jsonSchema))return new nn(e,s||null,new Ye($t.fromString(t.referencePath)))}}nn._jsonSchemaVersion="firestore/documentReference/1.0",nn._jsonSchema={type:gn("string",nn._jsonSchemaVersion),referencePath:gn("string")};class na extends bi{constructor(e,t,s){super(e,t,gd(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new nn(this.firestore,null,new Ye(e))}withConverter(e){return new na(this.firestore,e,this._path)}}function bn(n,e,...t){if(n=rn(n),W0("collection","path",e),n instanceof bd){const s=$t.fromString(e,...t);return gv(s),new na(n,null,s)}{if(!(n instanceof nn||n instanceof na))throw new Fe(pe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child($t.fromString(e,...t));return gv(s),new na(n.firestore,null,s)}}function Mt(n,e,...t){if(n=rn(n),arguments.length===1&&(e=Tp.newId()),W0("doc","path",e),n instanceof bd){const s=$t.fromString(e,...t);return mv(s),new nn(n,null,new Ye(s))}{if(!(n instanceof nn||n instanceof na))throw new Fe(pe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child($t.fromString(e,...t));return mv(s),new nn(n.firestore,n instanceof na?n.converter:null,new Ye(s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s_="AsyncQueue";class i_{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new Vx(this,"async_queue_retry"),this.oc=()=>{const s=gf();s&&ze(s_,"Visibility state changed to "+s.visibilityState),this.F_.y_()},this._c=e;const t=gf();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const t=gf();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise((()=>{}));const t=new gi;return this.uc((()=>this.Xu&&this.rc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Zu.push(e),this.cc())))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!Zo(e))throw e;ze(s_,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_((()=>this.cc()))}}uc(e){const t=this._c.then((()=>(this.nc=!0,e().catch((s=>{throw this.tc=s,this.nc=!1,xi("INTERNAL UNHANDLED ERROR: ",a_(s)),s})).then((s=>(this.nc=!1,s))))));return this._c=t,t}enqueueAfterDelay(e,t,s){this.ac(),this.sc.indexOf(e)>-1&&(t=0);const a=$p.createAndSchedule(this,e,t,s,(l=>this.lc(l)));return this.ec.push(a),a}ac(){this.tc&&rt(47125,{hc:a_(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(const t of this.ec)if(t.timerId===e)return!0;return!1}Ic(e){return this.Pc().then((()=>{this.ec.sort(((t,s)=>t.targetTimeMs-s.targetTimeMs));for(const t of this.ec)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Pc()}))}dc(e){this.sc.push(e)}lc(e){const t=this.ec.indexOf(e);this.ec.splice(t,1)}}function a_(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o_(n){return(function(t,s){if(typeof t!="object"||t===null)return!1;const a=t;for(const l of s)if(l in a&&typeof a[l]=="function")return!0;return!1})(n,["next","error","complete"])}class Ei extends bd{constructor(e,t,s,a){super(e,t,s,a),this.type="firestore",this._queue=new i_,this._persistenceKey=(a==null?void 0:a.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new i_(e),this._firestoreClient=void 0,await e}}}function DP(n,e){const t=typeof n=="object"?n:Q_(),s=typeof n=="string"?n:Ku,a=up(t,"firestore").getImmediate({identifier:s});if(!a._initialized){const l=G1("firestore");l&&kP(a,...l)}return a}function Cd(n){if(n._terminated)throw new Fe(pe.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||VP(n),n._firestoreClient}function VP(n){var e,t,s;const a=n._freezeSettings(),l=(function(f,m,y,x){return new iI(f,m,y,x.host,x.ssl,x.experimentalForceLongPolling,x.experimentalAutoDetectLongPolling,Xx(x.experimentalLongPollingOptions),x.useFetchStreams,x.isUsingEmulator)})(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,a);n._componentsProvider||!((t=a.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((s=a.localCache)===null||s===void 0)&&s._onlineComponentProvider)&&(n._componentsProvider={_offline:a.localCache._offlineComponentProvider,_online:a.localCache._onlineComponentProvider}),n._firestoreClient=new NP(n._authCredentials,n._appCheckCredentials,n._queue,l,n._componentsProvider&&(function(f){const m=f==null?void 0:f._online.build();return{_offline:f==null?void 0:f._offline.build(m),_online:m}})(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fs{constructor(e){this._byteString=e}static fromBase64String(e){try{return new fs(Gn.fromBase64String(e))}catch(t){throw new Fe(pe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new fs(Gn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:fs._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(cc(e,fs._jsonSchema))return fs.fromBase64String(e.bytes)}}fs._jsonSchemaVersion="firestore/bytes/1.0",fs._jsonSchema={type:gn("string",fs._jsonSchemaVersion),bytes:gn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Id{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Fe(pe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Wn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nd{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ks{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Fe(pe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Fe(pe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return ft(this._lat,e._lat)||ft(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ks._jsonSchemaVersion}}static fromJSON(e){if(cc(e,Ks._jsonSchema))return new Ks(e.latitude,e.longitude)}}Ks._jsonSchemaVersion="firestore/geoPoint/1.0",Ks._jsonSchema={type:gn("string",Ks._jsonSchemaVersion),latitude:gn("number"),longitude:gn("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qs{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(s,a){if(s.length!==a.length)return!1;for(let l=0;l<s.length;++l)if(s[l]!==a[l])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Qs._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(cc(e,Qs._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Qs(e.vectorValues);throw new Fe(pe.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Qs._jsonSchemaVersion="firestore/vectorValue/1.0",Qs._jsonSchema={type:gn("string",Qs._jsonSchemaVersion),vectorValues:gn("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LP=/^__.*__$/;class MP{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return this.fieldMask!==null?new ma(e,this.data,this.fieldMask,t,this.fieldTransforms):new uc(e,this.data,t,this.fieldTransforms)}}class ew{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return new ma(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function tw(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw rt(40011,{Ec:n})}}class Jp{constructor(e,t,s,a,l,d){this.settings=e,this.databaseId=t,this.serializer=s,this.ignoreUndefinedProperties=a,l===void 0&&this.Ac(),this.fieldTransforms=l||[],this.fieldMask=d||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new Jp(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var t;const s=(t=this.path)===null||t===void 0?void 0:t.child(e),a=this.Rc({path:s,mc:!1});return a.fc(e),a}gc(e){var t;const s=(t=this.path)===null||t===void 0?void 0:t.child(e),a=this.Rc({path:s,mc:!1});return a.Ac(),a}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return sd(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(tw(this.Ec)&&LP.test(e))throw this.wc('Document fields cannot begin and end with "__"')}}class OP{constructor(e,t,s){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=s||Ed(e)}Dc(e,t,s,a=!1){return new Jp({Ec:e,methodName:t,bc:s,path:Wn.emptyPath(),mc:!1,Sc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Pd(n){const e=n._freezeSettings(),t=Ed(n._databaseId);return new OP(n._databaseId,!!e.ignoreUndefinedProperties,t)}function nw(n,e,t,s,a,l={}){const d=n.Dc(l.merge||l.mergeFields?2:0,e,t,a);Zp("Data must be an object, but it was:",d,s);const f=rw(s,d);let m,y;if(l.merge)m=new $r(d.fieldMask),y=d.fieldTransforms;else if(l.mergeFields){const x=[];for(const E of l.mergeFields){const C=Jf(e,E,t);if(!d.contains(C))throw new Fe(pe.INVALID_ARGUMENT,`Field '${C}' is specified in your field mask but missing from your input data.`);iw(x,C)||x.push(C)}m=new $r(x),y=d.fieldTransforms.filter((E=>m.covers(E.field)))}else m=null,y=d.fieldTransforms;return new MP(new Dr(f),m,y)}class pc extends Nd{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof pc}}class Xp extends Nd{_toFieldTransform(e){return new AI(e.path,new ec)}isEqual(e){return e instanceof Xp}}function FP(n,e,t,s){const a=n.Dc(1,e,t);Zp("Data must be an object, but it was:",a,s);const l=[],d=Dr.empty();pa(s,((m,y)=>{const x=em(e,m,t);y=rn(y);const E=a.gc(x);if(y instanceof pc)l.push(x);else{const C=mc(y,E);C!=null&&(l.push(x),d.set(x,C))}}));const f=new $r(l);return new ew(d,f,a.fieldTransforms)}function UP(n,e,t,s,a,l){const d=n.Dc(1,e,t),f=[Jf(e,s,t)],m=[a];if(l.length%2!=0)throw new Fe(pe.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let C=0;C<l.length;C+=2)f.push(Jf(e,l[C])),m.push(l[C+1]);const y=[],x=Dr.empty();for(let C=f.length-1;C>=0;--C)if(!iw(y,f[C])){const O=f[C];let X=m[C];X=rn(X);const B=d.gc(O);if(X instanceof pc)y.push(O);else{const U=mc(X,B);U!=null&&(y.push(O),x.set(O,U))}}const E=new $r(y);return new ew(x,E,d.fieldTransforms)}function zP(n,e,t,s=!1){return mc(t,n.Dc(s?4:3,e))}function mc(n,e){if(sw(n=rn(n)))return Zp("Unsupported field value:",e,n),rw(n,e);if(n instanceof Nd)return(function(s,a){if(!tw(a.Ec))throw a.wc(`${s._methodName}() can only be used with update() and set()`);if(!a.path)throw a.wc(`${s._methodName}() is not currently supported inside arrays`);const l=s._toFieldTransform(a);l&&a.fieldTransforms.push(l)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return(function(s,a){const l=[];let d=0;for(const f of s){let m=mc(f,a.yc(d));m==null&&(m={nullValue:"NULL_VALUE"}),l.push(m),d++}return{arrayValue:{values:l}}})(n,e)}return(function(s,a){if((s=rn(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return NI(a.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const l=Ht.fromDate(s);return{timestampValue:Zu(a.serializer,l)}}if(s instanceof Ht){const l=new Ht(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:Zu(a.serializer,l)}}if(s instanceof Ks)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof fs)return{bytesValue:Sx(a.serializer,s._byteString)};if(s instanceof nn){const l=a.databaseId,d=s.firestore._databaseId;if(!d.isEqual(l))throw a.wc(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:kp(s.firestore._databaseId||a.databaseId,s._key.path)}}if(s instanceof Qs)return(function(d,f){return{mapValue:{fields:{[Z0]:{stringValue:ex},[Qu]:{arrayValue:{values:d.toArray().map((y=>{if(typeof y!="number")throw f.wc("VectorValues must only contain numeric values.");return Pp(f.serializer,y)}))}}}}}})(s,a);throw a.wc(`Unsupported field value: ${hd(s)}`)})(n,e)}function rw(n,e){const t={};return H0(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):pa(n,((s,a)=>{const l=mc(a,e.Vc(s));l!=null&&(t[s]=l)})),{mapValue:{fields:t}}}function sw(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Ht||n instanceof Ks||n instanceof fs||n instanceof nn||n instanceof Nd||n instanceof Qs)}function Zp(n,e,t){if(!sw(t)||!G0(t)){const s=hd(t);throw s==="an object"?e.wc(n+" a custom object"):e.wc(n+" "+s)}}function Jf(n,e,t){if((e=rn(e))instanceof Id)return e._internalPath;if(typeof e=="string")return em(n,e);throw sd("Field path arguments must be of type string or ",n,!1,void 0,t)}const $P=new RegExp("[~\\*/\\[\\]]");function em(n,e,t){if(e.search($P)>=0)throw sd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Id(...e.split("."))._internalPath}catch{throw sd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function sd(n,e,t,s,a){const l=s&&!s.isEmpty(),d=a!==void 0;let f=`Function ${e}() called with invalid data`;t&&(f+=" (via `toFirestore()`)"),f+=". ";let m="";return(l||d)&&(m+=" (found",l&&(m+=` in field ${s}`),d&&(m+=` in document ${a}`),m+=")"),new Fe(pe.INVALID_ARGUMENT,f+n+m)}function iw(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aw{constructor(e,t,s,a,l){this._firestore=e,this._userDataWriter=t,this._key=s,this._document=a,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new nn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new BP(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Rd("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class BP extends aw{data(){return super.data()}}function Rd(n,e){return typeof e=="string"?em(n,e):e instanceof Id?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ow(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Fe(pe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class tm{}class nm extends tm{}function Xf(n,e,...t){let s=[];e instanceof tm&&s.push(e),s=s.concat(t),(function(l){const d=l.filter((m=>m instanceof rm)).length,f=l.filter((m=>m instanceof Ad)).length;if(d>1||d>0&&f>0)throw new Fe(pe.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(s);for(const a of s)n=a._apply(n);return n}class Ad extends nm{constructor(e,t,s){super(),this._field=e,this._op=t,this._value=s,this.type="where"}static _create(e,t,s){return new Ad(e,t,s)}_apply(e){const t=this._parse(e);return cw(e._query,t),new bi(e.firestore,e.converter,zf(e._query,t))}_parse(e){const t=Pd(e.firestore);return(function(l,d,f,m,y,x,E){let C;if(y.isKeyField()){if(x==="array-contains"||x==="array-contains-any")throw new Fe(pe.INVALID_ARGUMENT,`Invalid Query. You can't perform '${x}' queries on documentId().`);if(x==="in"||x==="not-in"){c_(E,x);const X=[];for(const B of E)X.push(l_(m,l,B));C={arrayValue:{values:X}}}else C=l_(m,l,E)}else x!=="in"&&x!=="not-in"&&x!=="array-contains-any"||c_(E,x),C=zP(f,d,E,x==="in"||x==="not-in");return mn.create(y,x,C)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function lw(n,e,t){const s=e,a=Rd("where",n);return Ad._create(a,s,t)}class rm extends tm{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new rm(e,t)}_parse(e){const t=this._queryConstraints.map((s=>s._parse(e))).filter((s=>s.getFilters().length>0));return t.length===1?t[0]:js.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(a,l){let d=a;const f=l.getFlattenedFilters();for(const m of f)cw(d,m),d=zf(d,m)})(e._query,t),new bi(e.firestore,e.converter,zf(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class sm extends nm{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new sm(e,t)}_apply(e){const t=(function(a,l,d){if(a.startAt!==null)throw new Fe(pe.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(a.endAt!==null)throw new Fe(pe.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Zl(l,d)})(e._query,this._field,this._direction);return new bi(e.firestore,e.converter,(function(a,l){const d=a.explicitOrderBy.concat([l]);return new el(a.path,a.collectionGroup,d,a.filters.slice(),a.limit,a.limitType,a.startAt,a.endAt)})(e._query,t))}}function Zf(n,e="asc"){const t=e,s=Rd("orderBy",n);return sm._create(s,t)}class im extends nm{constructor(e,t,s){super(),this.type=e,this._limit=t,this._limitType=s}static _create(e,t,s){return new im(e,t,s)}_apply(e){return new bi(e.firestore,e.converter,Ju(e._query,this._limit,this._limitType))}}function WP(n){return im._create("limit",n,"F")}function l_(n,e,t){if(typeof(t=rn(t))=="string"){if(t==="")throw new Fe(pe.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!lx(e)&&t.indexOf("/")!==-1)throw new Fe(pe.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const s=e.path.child($t.fromString(t));if(!Ye.isDocumentKey(s))throw new Fe(pe.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return Sv(n,new Ye(s))}if(t instanceof nn)return Sv(n,t._key);throw new Fe(pe.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${hd(t)}.`)}function c_(n,e){if(!Array.isArray(n)||n.length===0)throw new Fe(pe.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function cw(n,e){const t=(function(a,l){for(const d of a)for(const f of d.getFlattenedFilters())if(l.indexOf(f.op)>=0)return f.op;return null})(n.filters,(function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new Fe(pe.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Fe(pe.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class GP{convertValue(e,t="none"){switch(oa(e)){case 0:return null;case 1:return e.booleanValue;case 2:return on(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(aa(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw rt(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const s={};return pa(e,((a,l)=>{s[a]=this.convertValue(l,t)})),s}convertVectorValue(e){var t,s,a;const l=(a=(s=(t=e.fields)===null||t===void 0?void 0:t[Qu].arrayValue)===null||s===void 0?void 0:s.values)===null||a===void 0?void 0:a.map((d=>on(d.doubleValue)));return new Qs(l)}convertGeoPoint(e){return new Ks(on(e.latitude),on(e.longitude))}convertArray(e,t){return(e.values||[]).map((s=>this.convertValue(s,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const s=md(e);return s==null?null:this.convertValue(s,t);case"estimate":return this.convertTimestamp(Yl(e));default:return null}}convertTimestamp(e){const t=ia(e);return new Ht(t.seconds,t.nanos)}convertDocumentKey(e,t){const s=$t.fromString(e);At(Rx(s),9688,{name:e});const a=new Jl(s.get(1),s.get(3)),l=new Ye(s.popFirst(5));return a.isEqual(t)||xi(`Document ${l} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uw(n,e,t){let s;return s=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,s}class Ll{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Fa extends aw{constructor(e,t,s,a,l,d){super(e,t,s,a,d),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Vu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const s=this._document.data.field(Rd("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Fe(pe.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Fa._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Fa._jsonSchemaVersion="firestore/documentSnapshot/1.0",Fa._jsonSchema={type:gn("string",Fa._jsonSchemaVersion),bundleSource:gn("string","DocumentSnapshot"),bundleName:gn("string"),bundle:gn("string")};class Vu extends Fa{data(e={}){return super.data(e)}}class Ua{constructor(e,t,s,a){this._firestore=e,this._userDataWriter=t,this._snapshot=a,this.metadata=new Ll(a.hasPendingWrites,a.fromCache),this.query=s}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((s=>{e.call(t,new Vu(this._firestore,this._userDataWriter,s.key,s,new Ll(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Fe(pe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(a,l){if(a._snapshot.oldDocs.isEmpty()){let d=0;return a._snapshot.docChanges.map((f=>{const m=new Vu(a._firestore,a._userDataWriter,f.doc.key,f.doc,new Ll(a._snapshot.mutatedKeys.has(f.doc.key),a._snapshot.fromCache),a.query.converter);return f.doc,{type:"added",doc:m,oldIndex:-1,newIndex:d++}}))}{let d=a._snapshot.oldDocs;return a._snapshot.docChanges.filter((f=>l||f.type!==3)).map((f=>{const m=new Vu(a._firestore,a._userDataWriter,f.doc.key,f.doc,new Ll(a._snapshot.mutatedKeys.has(f.doc.key),a._snapshot.fromCache),a.query.converter);let y=-1,x=-1;return f.type!==0&&(y=d.indexOf(f.doc.key),d=d.delete(f.doc.key)),f.type!==1&&(d=d.add(f.doc),x=d.indexOf(f.doc.key)),{type:qP(f.type),doc:m,oldIndex:y,newIndex:x}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Fe(pe.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Ua._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Tp.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],s=[],a=[];return this.docs.forEach((l=>{l._document!==null&&(t.push(l._document),s.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),a.push(l.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function qP(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return rt(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jd(n){n=Vr(n,nn);const e=Vr(n.firestore,Ei);return AP(Cd(e),n._key).then((t=>dw(e,n,t)))}Ua._jsonSchemaVersion="firestore/querySnapshot/1.0",Ua._jsonSchema={type:gn("string",Ua._jsonSchemaVersion),bundleSource:gn("string","QuerySnapshot"),bundleName:gn("string"),bundle:gn("string")};class am extends GP{constructor(e){super(),this.firestore=e}convertBytes(e){return new fs(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new nn(this.firestore,null,t)}}function Ns(n){n=Vr(n,bi);const e=Vr(n.firestore,Ei),t=Cd(e),s=new am(e);return ow(n._query),jP(t,n._query).then((a=>new Ua(e,s,n,a)))}function pi(n,e,t){n=Vr(n,nn);const s=Vr(n.firestore,Ei),a=uw(n.converter,e,t);return kd(s,[nw(Pd(s),"setDoc",n._key,a,n.converter!==null,t).toMutation(n._key,ms.none())])}function Ps(n,e,t,...s){n=Vr(n,nn);const a=Vr(n.firestore,Ei),l=Pd(a);let d;return d=typeof(e=rn(e))=="string"||e instanceof Id?UP(l,"updateDoc",n._key,e,t,s):FP(l,"updateDoc",n._key,e),kd(a,[d.toMutation(n._key,ms.exists(!0))])}function Ma(n){return kd(Vr(n.firestore,Ei),[new Rp(n._key,ms.none())])}function Oa(n,e){const t=Vr(n.firestore,Ei),s=Mt(n),a=uw(n.converter,e);return kd(t,[nw(Pd(n.firestore),"addDoc",s._key,a,n.converter!==null,{}).toMutation(s._key,ms.exists(!1))]).then((()=>s))}function u_(n,...e){var t,s,a;n=rn(n);let l={includeMetadataChanges:!1,source:"default"},d=0;typeof e[d]!="object"||o_(e[d])||(l=e[d++]);const f={includeMetadataChanges:l.includeMetadataChanges,source:l.source};if(o_(e[d])){const E=e[d];e[d]=(t=E.next)===null||t===void 0?void 0:t.bind(E),e[d+1]=(s=E.error)===null||s===void 0?void 0:s.bind(E),e[d+2]=(a=E.complete)===null||a===void 0?void 0:a.bind(E)}let m,y,x;if(n instanceof nn)y=Vr(n.firestore,Ei),x=gd(n._key.path),m={next:E=>{e[d]&&e[d](dw(y,n,E))},error:e[d+1],complete:e[d+2]};else{const E=Vr(n,bi);y=Vr(E.firestore,Ei),x=E._query;const C=new am(y);m={next:O=>{e[d]&&e[d](new Ua(y,C,E,O))},error:e[d+1],complete:e[d+2]},ow(n._query)}return(function(C,O,X,B){const U=new Yp(B),se=new Hp(O,U,X);return C.asyncQueue.enqueueAndForget((async()=>Wp(await rd(C),se))),()=>{U.Ou(),C.asyncQueue.enqueueAndForget((async()=>Gp(await rd(C),se)))}})(Cd(y),x,f,m)}function kd(n,e){return(function(s,a){const l=new gi;return s.asyncQueue.enqueueAndForget((async()=>_P(await RP(s),a,l))),l.promise})(Cd(n),e)}function dw(n,e,t){const s=t.docs.get(e._key),a=new am(n);return new Fa(n,a,e._key,s,new Ll(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HP(){return new pc("deleteField")}function za(){return new Xp("serverTimestamp")}(function(e,t=!0){(function(a){Jo=a})(Ko),Mo(new Ba("firestore",((s,{instanceIdentifier:a,options:l})=>{const d=s.getProvider("app").getImmediate(),f=new Ei(new zC(s.getProvider("auth-internal")),new WC(d,s.getProvider("app-check-internal")),(function(y,x){if(!Object.prototype.hasOwnProperty.apply(y.options,["projectId"]))throw new Fe(pe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Jl(y.options.projectId,x)})(d,a),d);return l=Object.assign({useFetchStreams:t},l),f._setSettings(l),f}),"PUBLIC").setMultipleInstances(!0)),ea(uv,dv,e),ea(uv,dv,"esm2017")})();const KP={apiKey:"AIzaSyCOOnlmEcAcJywsS93LLfLSywy9ENqnppM",authDomain:"tyler-manga-library.firebaseapp.com",projectId:"tyler-manga-library",storageBucket:"tyler-manga-library.firebasestorage.app",messagingSenderId:"307412068362",appId:"1:307412068362:web:6cfe5666187439dfa757f3"},hw=K_(KP),ps=MC(hw),at=DP(hw),fw=j.createContext(null);function QP({children:n}){const e="https://discord.com/api/webhooks/1451655828078723156/EA8QhLeiTT-7jOVQ6jFpV2he2zxVpAddAhlu8CiC6RtGFu9wTAOLdRjKeYHIV1OhVbmm",[t,s]=j.useState(null),[a,l]=j.useState(!1),[d,f]=j.useState("viewer"),[m,y]=j.useState(!0),x=async O=>{if(!O)return null;const X=Mt(at,"users",O.uid);let B=null;try{const se=await jd(X);se.exists()&&(B=se.data())}catch(se){console.warn("Failed to read user doc",se)}const U={role:((B==null?void 0:B.role)||"viewer").toLowerCase()==="admin"?"admin":"viewer",email:O.email||(B==null?void 0:B.email)||"",displayName:O.displayName||(B==null?void 0:B.displayName)||"",createdAt:(B==null?void 0:B.createdAt)||za()};try{if(await pi(X,U,{merge:!0}),!B&&e)try{const se=O.displayName||O.email||O.uid;await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:`New signup: ${se}`})})}catch(se){console.warn("Failed to send signup webhook",se)}}catch(se){console.error("Failed to ensure user doc",se)}return{...B,...U}};j.useEffect(()=>{const O=Ib(ps,async X=>{if(s(X),X)try{const B=await x(X),U=(B==null?void 0:B.role)||"viewer";f(U),l(U.toLowerCase()==="admin")}catch(B){console.error("Error checking role:",B),l(!1),f("viewer")}else l(!1),f("viewer");y(!1)});return()=>O()},[]);const E=async(O,X)=>{await E0(ps,O,X)},C=async()=>{await T0(ps)};return o.jsx(fw.Provider,{value:{user:t,admin:a,role:d,loading:m,login:E,logout:C},children:n})}function Qa(){return j.useContext(fw)}function YP({onClose:n}){const[e,t]=j.useState("login"),[s,a]=j.useState(""),[l,d]=j.useState("");async function f(){try{await k0(ps,new Is),n()}catch(x){alert(x.message)}}async function m(x){x.preventDefault();try{await E0(ps,s,l),n()}catch(E){alert(E.message)}}async function y(x){x.preventDefault();try{await Eb(ps,s,l),n()}catch(E){alert(E.message)}}return o.jsx("div",{className:"auth-modal-backdrop",onClick:n,children:o.jsxs("div",{className:"auth-modal",onClick:x=>x.stopPropagation(),children:[o.jsx("h2",{className:"auth-title",children:e==="login"?"Sign In":"Create Account"}),o.jsxs("button",{className:"google-btn",onClick:f,children:[o.jsx("img",{src:"https://www.svgrepo.com/show/475656/google-color.svg",alt:"",className:"google-icon"}),"Continue with Google"]}),o.jsx("div",{className:"auth-divider",children:o.jsx("span",{children:"or"})}),o.jsxs("form",{onSubmit:e==="login"?m:y,className:"auth-form",children:[o.jsx("input",{type:"email",placeholder:"Email address",className:"auth-input",value:s,onChange:x=>a(x.target.value),required:!0}),o.jsx("input",{type:"password",placeholder:"Password",className:"auth-input",value:l,onChange:x=>d(x.target.value),required:!0}),o.jsx("button",{className:"auth-submit",children:e==="login"?"Sign In":"Create Account"})]}),o.jsx("div",{className:"auth-switcher",children:e==="login"?o.jsxs("p",{children:["No account?"," ",o.jsx("button",{onClick:()=>t("register"),children:"Register"})]}):o.jsxs("p",{children:["Already have an account?"," ",o.jsx("button",{onClick:()=>t("login"),children:"Sign in"})]})}),o.jsx("button",{className:"auth-close",onClick:n,"aria-label":"Close",children:"X"})]})})}var Lu={exports:{}},JP=Lu.exports,d_;function XP(){return d_||(d_=1,(function(n){(function(e){function t(L,ie){var I=(L&65535)+(ie&65535),N=(L>>16)+(ie>>16)+(I>>16);return N<<16|I&65535}function s(L,ie){return L<<ie|L>>>32-ie}function a(L,ie,I,N,A,M){return t(s(t(t(ie,L),t(N,M)),A),I)}function l(L,ie,I,N,A,M,D){return a(ie&I|~ie&N,L,ie,A,M,D)}function d(L,ie,I,N,A,M,D){return a(ie&N|I&~N,L,ie,A,M,D)}function f(L,ie,I,N,A,M,D){return a(ie^I^N,L,ie,A,M,D)}function m(L,ie,I,N,A,M,D){return a(I^(ie|~N),L,ie,A,M,D)}function y(L,ie){L[ie>>5]|=128<<ie%32,L[(ie+64>>>9<<4)+14]=ie;var I,N,A,M,D,P=1732584193,b=-271733879,J=-1732584194,re=271733878;for(I=0;I<L.length;I+=16)N=P,A=b,M=J,D=re,P=l(P,b,J,re,L[I],7,-680876936),re=l(re,P,b,J,L[I+1],12,-389564586),J=l(J,re,P,b,L[I+2],17,606105819),b=l(b,J,re,P,L[I+3],22,-1044525330),P=l(P,b,J,re,L[I+4],7,-176418897),re=l(re,P,b,J,L[I+5],12,1200080426),J=l(J,re,P,b,L[I+6],17,-1473231341),b=l(b,J,re,P,L[I+7],22,-45705983),P=l(P,b,J,re,L[I+8],7,1770035416),re=l(re,P,b,J,L[I+9],12,-1958414417),J=l(J,re,P,b,L[I+10],17,-42063),b=l(b,J,re,P,L[I+11],22,-1990404162),P=l(P,b,J,re,L[I+12],7,1804603682),re=l(re,P,b,J,L[I+13],12,-40341101),J=l(J,re,P,b,L[I+14],17,-1502002290),b=l(b,J,re,P,L[I+15],22,1236535329),P=d(P,b,J,re,L[I+1],5,-165796510),re=d(re,P,b,J,L[I+6],9,-1069501632),J=d(J,re,P,b,L[I+11],14,643717713),b=d(b,J,re,P,L[I],20,-373897302),P=d(P,b,J,re,L[I+5],5,-701558691),re=d(re,P,b,J,L[I+10],9,38016083),J=d(J,re,P,b,L[I+15],14,-660478335),b=d(b,J,re,P,L[I+4],20,-405537848),P=d(P,b,J,re,L[I+9],5,568446438),re=d(re,P,b,J,L[I+14],9,-1019803690),J=d(J,re,P,b,L[I+3],14,-187363961),b=d(b,J,re,P,L[I+8],20,1163531501),P=d(P,b,J,re,L[I+13],5,-1444681467),re=d(re,P,b,J,L[I+2],9,-51403784),J=d(J,re,P,b,L[I+7],14,1735328473),b=d(b,J,re,P,L[I+12],20,-1926607734),P=f(P,b,J,re,L[I+5],4,-378558),re=f(re,P,b,J,L[I+8],11,-2022574463),J=f(J,re,P,b,L[I+11],16,1839030562),b=f(b,J,re,P,L[I+14],23,-35309556),P=f(P,b,J,re,L[I+1],4,-1530992060),re=f(re,P,b,J,L[I+4],11,1272893353),J=f(J,re,P,b,L[I+7],16,-155497632),b=f(b,J,re,P,L[I+10],23,-1094730640),P=f(P,b,J,re,L[I+13],4,681279174),re=f(re,P,b,J,L[I],11,-358537222),J=f(J,re,P,b,L[I+3],16,-722521979),b=f(b,J,re,P,L[I+6],23,76029189),P=f(P,b,J,re,L[I+9],4,-640364487),re=f(re,P,b,J,L[I+12],11,-421815835),J=f(J,re,P,b,L[I+15],16,530742520),b=f(b,J,re,P,L[I+2],23,-995338651),P=m(P,b,J,re,L[I],6,-198630844),re=m(re,P,b,J,L[I+7],10,1126891415),J=m(J,re,P,b,L[I+14],15,-1416354905),b=m(b,J,re,P,L[I+5],21,-57434055),P=m(P,b,J,re,L[I+12],6,1700485571),re=m(re,P,b,J,L[I+3],10,-1894986606),J=m(J,re,P,b,L[I+10],15,-1051523),b=m(b,J,re,P,L[I+1],21,-2054922799),P=m(P,b,J,re,L[I+8],6,1873313359),re=m(re,P,b,J,L[I+15],10,-30611744),J=m(J,re,P,b,L[I+6],15,-1560198380),b=m(b,J,re,P,L[I+13],21,1309151649),P=m(P,b,J,re,L[I+4],6,-145523070),re=m(re,P,b,J,L[I+11],10,-1120210379),J=m(J,re,P,b,L[I+2],15,718787259),b=m(b,J,re,P,L[I+9],21,-343485551),P=t(P,N),b=t(b,A),J=t(J,M),re=t(re,D);return[P,b,J,re]}function x(L){var ie,I="",N=L.length*32;for(ie=0;ie<N;ie+=8)I+=String.fromCharCode(L[ie>>5]>>>ie%32&255);return I}function E(L){var ie,I=[];for(I[(L.length>>2)-1]=void 0,ie=0;ie<I.length;ie+=1)I[ie]=0;var N=L.length*8;for(ie=0;ie<N;ie+=8)I[ie>>5]|=(L.charCodeAt(ie/8)&255)<<ie%32;return I}function C(L){return x(y(E(L),L.length*8))}function O(L,ie){var I,N=E(L),A=[],M=[],D;for(A[15]=M[15]=void 0,N.length>16&&(N=y(N,L.length*8)),I=0;I<16;I+=1)A[I]=N[I]^909522486,M[I]=N[I]^1549556828;return D=y(A.concat(E(ie)),512+ie.length*8),x(y(M.concat(D),640))}function X(L){var ie="0123456789abcdef",I="",N,A;for(A=0;A<L.length;A+=1)N=L.charCodeAt(A),I+=ie.charAt(N>>>4&15)+ie.charAt(N&15);return I}function B(L){return unescape(encodeURIComponent(L))}function U(L){return C(B(L))}function se(L){return X(U(L))}function we(L,ie){return O(B(L),B(ie))}function _e(L,ie){return X(we(L,ie))}function ve(L,ie,I){return ie?I?we(ie,L):_e(ie,L):I?U(L):se(L)}n.exports?n.exports=ve:e.md5=ve})(JP)})(Lu)),Lu.exports}var ZP=XP();const eR=ep(ZP);function tR(){var Oe,Qe,nt;const n="google.com",e="oidc.discord",[t,s]=j.useState(!1),[a,l]=j.useState(!1),[d,f]=j.useState(!1),[m,y]=j.useState(!1),[x,E]=j.useState(""),[C,O]=j.useState(""),[X,B]=j.useState(""),[U,se]=j.useState({google:!1,discord:!1}),[we,_e]=j.useState(""),[ve,L]=j.useState(!1),[ie,I]=j.useState(!1),[N,A]=j.useState(null),M=j.useRef(null),{user:D,admin:P,role:b}=Qa(),J=rc();j.useEffect(()=>{var me;f(!1),y(!1),O(""),B(""),I(!1),E((D==null?void 0:D.displayName)||((me=D==null?void 0:D.email)==null?void 0:me.split("@")[0])||"")},[D]),j.useEffect(()=>{const me=((D==null?void 0:D.email)||"").trim().toLowerCase();if(!me){_e("");return}const ce=eR(me),Le=Date.now();_e(`https://www.gravatar.com/avatar/${ce}?s=160&d=identicon&r=g&cb=${Le}`)},[D==null?void 0:D.email]),j.useEffect(()=>{let me=!1;const ce=async()=>{var ge;try{const He=Xf(bn(at,"blogPosts"),lw("status","==","published"),Zf("publishedAt","desc"),WP(1)),Je=await Ns(He);if(me)return;if(Je.empty){A(null);return}const _t=Je.docs[0],Ct=_t.data(),Nt=(ge=Ct.publishedAt)!=null&&ge.toDate?Ct.publishedAt.toDate():null;if(!Nt){A(null);return}const Ot=Ct.title||"New blog post",Zt=Nt.toISOString().slice(0,10),sn=`blog-alert-${_t.id}-${Zt}`;if(!(Date.now()-Nt.getTime()<=1440*60*1e3)){A(null);return}if(typeof localStorage<"u"&&localStorage.getItem(sn)==="dismissed")return;A({id:_t.id,title:Ot,alertKey:sn,publishedAt:Nt})}catch(He){(He==null?void 0:He.code)!=="permission-denied"&&console.error("Failed to load blog alert",He)}};ce();const Le=setInterval(ce,6e4);return()=>{me=!0,clearInterval(Le)}},[]);const re=me=>{N!=null&&N.alertKey&&typeof localStorage<"u"&&localStorage.setItem(N.alertKey,"dismissed"),A(null),J(me?`/blog?post=${me}`:"/blog")},Ce=me=>{me!=null&&me.stopPropagation&&me.stopPropagation(),N!=null&&N.alertKey&&typeof localStorage<"u"&&localStorage.setItem(N.alertKey,"dismissed"),A(null)};async function fe(){try{await T0(ps),s(!1),f(!1),J("/")}catch(me){console.error(me),alert("Logout failed.")}}const le=()=>{if(!D){s(!1),l(!0);return}f(!1),O(""),B(""),I(!1),y(!0)},Pe=async()=>{if(!D){s(!1),l(!0);return}const me=(x||"").trim();if(!me){O("Display name is required.");return}L(!0),O(""),I(!1);try{await Sb(ps.currentUser,{displayName:me}),await pi(Mt(at,"users",D.uid),{displayName:me},{merge:!0}),O("Profile updated."),I(!1)}catch(ce){console.error("Failed to update profile",ce),O("Failed to update profile.")}finally{L(!1)}},xe=me=>{var ce;return!!((ce=D==null?void 0:D.providerData)!=null&&ce.some(Le=>Le.providerId===me))},Y=async()=>{if(!D){s(!1),l(!0);return}if(xe(n)){B("Google is already connected.");return}se(me=>({...me,google:!0})),B("");try{const me=new Is,ce=await tv(ps.currentUser,me);await pi(Mt(at,"users",D.uid),{connections:{[n]:{email:ce.user.email||"",connectedAt:za()}}},{merge:!0}),B("Google connected.")}catch(me){console.error("Failed to link Google",me);const ce=(me==null?void 0:me.code)==="auth/credential-already-in-use"?"That Google account is already linked elsewhere. Sign in with it instead.":"Could not connect Google.";B(ce)}finally{se(me=>({...me,google:!1}))}},k=async()=>{if(!D){s(!1),l(!0);return}if(xe(e)){B("Discord is already connected.");return}se(me=>({...me,discord:!0})),B("");try{const me=new Fl(e);me.addScope("identify"),me.addScope("email");const Le=(await tv(ps.currentUser,me)).user.providerData.find(ge=>ge.providerId===e);await pi(Mt(at,"users",D.uid),{connections:{[e]:{username:(Le==null?void 0:Le.displayName)||(Le==null?void 0:Le.uid)||"Discord",email:(Le==null?void 0:Le.email)||"",connectedAt:za()}}},{merge:!0}),B("Discord connected.")}catch(me){console.error("Failed to link Discord",me);const ce=(me==null?void 0:me.code)==="auth/credential-already-in-use"?"That Discord account is already linked elsewhere. Sign in with it instead.":"Could not connect Discord.";B(ce)}finally{se(me=>({...me,discord:!1}))}},K=async me=>{if(!D)return;if(D.providerData.length<=1){B("You need at least one sign-in method.");return}const ce=me===n?"google":"discord";B(""),se(Le=>({...Le,[ce]:!0}));try{await yb(ps.currentUser,me),await pi(Mt(at,"users",D.uid),{connections:{[me]:HP()}},{merge:!0}),B("Connection removed.")}catch(Le){console.error("Failed to unlink",Le),B("Could not remove connection.")}finally{se(Le=>({...Le,[ce]:!1}))}},Te=D?(((Oe=D.displayName)==null?void 0:Oe[0])||((Qe=D.email)==null?void 0:Qe[0])||((nt=D.uid)==null?void 0:nt[0])||"?").toUpperCase():"?",De=(D==null?void 0:D.displayName)||(D==null?void 0:D.email)||"Guest",ke=D?P?"admin":b||"viewer":"Not signed in";return o.jsxs(o.Fragment,{children:[N&&o.jsxs("div",{className:"blog-alert-banner",onClick:()=>re(N.id),role:"button",tabIndex:0,onKeyDown:me=>{(me.key==="Enter"||me.key===" ")&&(me.preventDefault(),re(N.id))},children:[o.jsx("div",{className:"blog-alert-dot"}),o.jsxs("div",{className:"blog-alert-text",children:["New blog post today: ",o.jsx("strong",{children:N.title})]}),o.jsxs("div",{className:"blog-alert-actions",children:[o.jsx("button",{type:"button",className:"blog-alert-btn",onClick:me=>{me.stopPropagation(),re(N.id)},children:"Read now"}),o.jsx("button",{type:"button",className:"blog-alert-dismiss",onClick:Ce,children:"Dismiss"})]})]}),o.jsxs("button",{className:`menu-toggle ${t?"active":""}`,onClick:()=>s(!t),children:[o.jsx("span",{}),o.jsx("span",{}),o.jsx("span",{})]}),o.jsxs("nav",{className:`menu-panel ${t?"open":""}`,onMouseLeave:()=>f(!1),children:[o.jsx(Bi,{to:"/",className:"menu-item",onClick:()=>s(!1),children:"Home"}),o.jsx(Bi,{to:"/manga",className:"menu-item",onClick:()=>s(!1),children:"Manga"}),o.jsx(Bi,{to:"/anime",className:"menu-item",onClick:()=>s(!1),children:"Anime"}),o.jsx(Bi,{to:"/tcg",className:"menu-item",onClick:()=>s(!1),children:"TCG"}),o.jsx(Bi,{to:"/music",className:"menu-item",onClick:()=>s(!1),children:"Music"}),o.jsx(Bi,{to:"/steam",className:"menu-item",onClick:()=>s(!1),children:"Gaming"}),P&&o.jsx(Bi,{to:"/blog",className:"menu-item",onClick:()=>s(!1),children:"Blog"}),P&&o.jsx(Bi,{to:"/dashboard",className:"menu-item",onClick:()=>s(!1),children:"Dashboard"}),o.jsxs("div",{className:"menu-footer",children:[o.jsx("div",{className:"profile-divider"}),o.jsxs("div",{className:"profile-card",onMouseEnter:()=>D&&f(!0),onMouseLeave:()=>f(!1),onClick:()=>{D?f(me=>!me):(f(!1),s(!1),l(!0))},role:"button",tabIndex:0,onKeyDown:me=>{(me.key==="Enter"||me.key===" ")&&(me.preventDefault(),D?f(ce=>!ce):(s(!1),l(!0)))},children:[o.jsx("div",{className:"profile-avatar",children:we?o.jsx("img",{src:we,alt:`${De} avatar`,onError:()=>_e("")}):Te}),o.jsxs("div",{className:"profile-meta",children:[o.jsx("div",{className:"profile-name",children:De}),o.jsx("div",{className:"profile-role",children:ke})]}),D&&d&&o.jsxs("div",{className:"profile-menu",children:[o.jsx("button",{type:"button",className:"profile-menu-item",onClick:le,children:"Edit profile"}),o.jsx("button",{type:"button",className:"profile-menu-item",onClick:fe,children:"Sign out"})]})]})]})]}),a&&o.jsx(YP,{onClose:()=>l(!1)}),m&&o.jsx("div",{className:"profile-edit-backdrop",children:o.jsxs("div",{className:"profile-edit-card",children:[o.jsxs("div",{className:"profile-edit-header",children:[o.jsx("h3",{children:"Edit profile"}),o.jsx("button",{type:"button",className:"profile-edit-close",onClick:()=>{y(!1),O(""),B(""),I(!1)},children:""})]}),o.jsxs("div",{className:"profile-edit-body",children:[o.jsxs("a",{className:"profile-edit-avatar clickable",href:"https://gravatar.com/profile",target:"_blank",rel:"noreferrer",title:"Manage your picture on Gravatar (opens in new tab)",children:[we?o.jsx("img",{src:we,alt:`${De} avatar`,onError:()=>_e("")}):Te,o.jsx("span",{className:"profile-avatar-hover-hint",children:"Change on Gravatar"})]}),o.jsxs("div",{className:"profile-edit-field",children:[o.jsx("label",{className:"profile-edit-label",htmlFor:"displayName",children:"Display name"}),o.jsxs("div",{className:"profile-edit-input-row",children:[o.jsx("input",{id:"displayName",className:"profile-edit-input",type:"text",readOnly:!ie,value:x,onChange:me=>E(me.target.value),maxLength:40,placeholder:"Enter display name",ref:M,onBlur:()=>{ie&&Pe()},onKeyDown:me=>{me.key==="Enter"&&ie&&(me.preventDefault(),Pe())}}),o.jsx("button",{type:"button",className:"profile-edit-pencil",onClick:()=>{I(!0),O(""),setTimeout(()=>{var me;return(me=M.current)==null?void 0:me.focus()},50)},"aria-label":"Edit display name",children:""})]}),o.jsx("div",{className:"profile-edit-hint",children:"Click the pencil to edit. Changes save on blur or Enter."})]})]}),o.jsxs("div",{className:"profile-connections",children:[o.jsxs("div",{className:"profile-connections-header",children:[o.jsx("span",{children:"Connections"}),X&&o.jsx("span",{className:"profile-connection-status",children:X})]}),o.jsxs("div",{className:"profile-connection-row",children:[o.jsxs("div",{className:"profile-connection-meta",children:[o.jsx("div",{className:"profile-connection-title",children:"Google"}),o.jsx("div",{className:"profile-connection-sub",children:xe(n)?"Connected":"Not connected"})]}),o.jsx("div",{className:"profile-connection-actions",children:xe(n)?o.jsx("button",{type:"button",className:"profile-connection-btn secondary",onClick:()=>K(n),disabled:U.google,children:U.google?"Removing...":"Remove"}):o.jsx("button",{type:"button",className:"profile-connection-btn",onClick:Y,disabled:U.google,children:U.google?"Connecting...":"Connect"})})]}),o.jsxs("div",{className:"profile-connection-row",children:[o.jsxs("div",{className:"profile-connection-meta",children:[o.jsx("div",{className:"profile-connection-title",children:"Discord"}),o.jsx("div",{className:"profile-connection-sub",children:xe(e)?"Connected":"Not connected"})]}),o.jsx("div",{className:"profile-connection-actions",children:xe(e)?o.jsx("button",{type:"button",className:"profile-connection-btn secondary",onClick:()=>K(e),disabled:U.discord,children:U.discord?"Removing...":"Remove"}):o.jsx("button",{type:"button",className:"profile-connection-btn",onClick:k,disabled:U.discord,children:U.discord?"Connecting...":"Connect"})})]})]}),C&&o.jsx("div",{className:"profile-edit-status",children:C}),ve&&o.jsx("div",{className:"profile-edit-status saving",children:"Saving..."}),o.jsx("div",{className:"profile-gravatar-note",children:"Profile pictures are managed through Gravatarclick the avatar to update."})]})})]})}function h_(){const n="Tyler's Collection's and Hobbies",e="",[t,s]=j.useState(""),[a,l]=j.useState(!0),d=j.useRef(null),[f,m]=j.useState("jp"),[y,x]=j.useState(1);return j.useEffect(()=>{document.title="Tyler's Collection"},[]),j.useEffect(()=>(d.current=setInterval(()=>l(E=>!E),450),()=>{d.current&&clearInterval(d.current)}),[]),j.useEffect(()=>{let E=!1;const C=B=>new Promise(U=>setTimeout(U,B)),O=async(B,U=120)=>{for(let se=1;se<=B.length;se+=1){if(E)return;s(B.slice(0,se)),await C(U)}},X=async(B,U=70)=>{for(let se=B.length;se>=0;se-=1){if(E)return;s(B.slice(0,se)),await C(U)}};return(async()=>{if(localStorage.getItem("homeTitleTyped")==="1"){m("en"),s(n),l(!1),d.current&&clearInterval(d.current);return}await C(250),m("jp"),await O(e,140),await C(6e3),await X(e,80),await C(320);const U=n;for(let se=1;se<=U.length;se+=1){if(E)return;s(U.slice(0,se)),se===4&&m("en"),await C(110)}m("en"),await C(2e3),l(!1),localStorage.setItem("homeTitleTyped","1"),d.current&&clearInterval(d.current)})(),()=>{E=!0}},[]),o.jsxs("main",{className:"page",children:[o.jsxs("header",{style:{textAlign:"center",marginTop:"32px",marginBottom:"24px"},children:[o.jsxs("h1",{style:{margin:0,fontSize:"2.2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",display:"inline-flex",alignItems:"center",gap:"6px"},children:[o.jsx("span",{children:t||" "}),o.jsx("span",{style:{width:"6px",height:"1.1em",background:"#ffb6c1",opacity:a?1:0,transition:"opacity 0.15s ease"}})]}),o.jsx("p",{style:{margin:"6px 0 0",color:"var(--text-soft)",fontSize:"0.95rem",opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"TCG":"This is my personal webpage to see what is on my shelves, wishlists, and TCG collections."}),o.jsx("div",{style:{display:"inline-flex",alignItems:"center",gap:"10px",padding:"8px 14px",borderRadius:"999px",border:"1px solid rgba(255,182,193,0.5)",background:"linear-gradient(135deg, rgba(255,182,193,0.18), rgba(43,15,29,0.9))",boxShadow:"0 8px 24px rgba(0,0,0,0.55)",marginTop:"14px",fontSize:"0.78rem",color:"#ffe6ed",letterSpacing:"0.05em",textTransform:"uppercase",fontWeight:700,opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?o.jsx("span",{style:{letterSpacing:"0.06em"},children:"          TCG"}):o.jsx("span",{style:{letterSpacing:"0.06em"},children:" Manga   Anime   Music   TCG"})})]}),o.jsxs("section",{style:{display:"grid",gridTemplateColumns:"minmax(0, 2fr) minmax(0, 3fr)",gap:"20px",marginTop:"24px"},children:[o.jsxs("article",{className:"card",children:[o.jsx("h2",{style:{marginTop:0,marginBottom:"8px",fontSize:"1.2rem",color:"#ffb6c1"},children:o.jsx("span",{style:{opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"":"About Me"})}),o.jsx("p",{style:{margin:0,color:"var(--text-soft)",fontSize:"0.9rem",lineHeight:1.5,opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"im.okTCG":"Hey, I am Tyler and I go by im.ok. I hoard manga, binge anime, and collect trading cards."}),o.jsx("p",{style:{marginTop:"10px",color:"var(--text-soft)",fontSize:"0.9rem",opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"TCG":"This site is where I track everything: volumes on my shelves, finished shows, and my TCG collection as they all slowly grow."}),o.jsxs("div",{style:{marginTop:"12px",display:"flex",flexWrap:"wrap",gap:"6px",opacity:y,transition:"opacity 0.25s ease"},children:[o.jsx("span",{className:"pill",children:f==="jp"?"":"Manga library"}),o.jsx("span",{className:"pill",children:f==="jp"?"":"My Anime List (MAL)"}),o.jsx("span",{className:"pill",children:f==="jp"?" & TCG":"Pokemon & One Piece TCG"}),o.jsx("span",{className:"pill",children:f==="jp"?"":"Data Nerd"})]})]}),o.jsxs("article",{className:"card",children:[o.jsx("h2",{style:{marginTop:0,marginBottom:"8px",fontSize:"1.2rem",color:"#ffb6c1"},children:o.jsx("span",{style:{opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Explore these pages"})}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(210px, 1fr))",gap:"14px",marginTop:"10px"},children:[o.jsxs("a",{href:"/base/manga",className:"section-card",children:[o.jsx("h3",{style:{opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Manga Library"}),o.jsx("p",{style:{opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Full manga collection & wishlist."}),o.jsx("div",{className:"section-chip-row",children:o.jsx("span",{className:"section-chip accent",style:{opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Library & wishlist"})})]}),o.jsxs("a",{href:"/base/music",className:"section-card",style:{justifySelf:"end",alignSelf:"end",order:99},children:[o.jsx("h3",{style:{opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Music"}),o.jsx("p",{style:{opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"":"If you are here for my music, this is the page for you! Catch all the latest releases."}),o.jsxs("div",{className:"section-chip-row",children:[o.jsx("span",{className:"section-chip accent",style:{opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Latest tracks"}),o.jsx("span",{className:"section-chip",style:{opacity:y,transition:"opacity 0.25s ease"},children:"Spotify & SoundCloud"})]})]}),o.jsxs("a",{href:"/base/anime",className:"section-card",children:[o.jsx("h3",{style:{opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Anime Library"}),o.jsx("p",{style:{opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"MAL":"The entire watched, plan to watch, and watching list synced directly from MyAnimeList."}),o.jsxs("div",{className:"section-chip-row",children:[o.jsx("span",{className:"section-chip accent",style:{opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"MAL":"MAL synced"}),o.jsx("span",{className:"section-chip",style:{opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Status filters"}),o.jsx("span",{className:"section-chip",style:{opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Quick stats"})]})]}),o.jsxs("a",{href:"/base/tcg",className:"section-card",children:[o.jsx("h3",{style:{opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"TCG":"TCG Collection"}),o.jsx("p",{style:{opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"TCG":"Pokemon & One Piece TCG cards tracked with quantities, prices, and value."}),o.jsxs("div",{className:"section-chip-row",children:[o.jsx("span",{className:"section-chip accent",style:{opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Full Collection"}),o.jsx("span",{className:"section-chip",style:{opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Still Under-Construction"})]})]})]})]})]}),o.jsx("footer",{style:{marginTop:"28px",fontSize:"0.78rem",color:"var(--text-soft)",textAlign:"center"},children:"@ 2025 im.ok. All rights reserved."})]})}const nR="modulepreload",rR=function(n){return"/base/"+n},f_={},gc=function(e,t,s){let a=Promise.resolve();if(t&&t.length>0){let d=function(y){return Promise.all(y.map(x=>Promise.resolve(x).then(E=>({status:"fulfilled",value:E}),E=>({status:"rejected",reason:E}))))};document.getElementsByTagName("link");const f=document.querySelector("meta[property=csp-nonce]"),m=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));a=d(t.map(y=>{if(y=rR(y),y in f_)return;f_[y]=!0;const x=y.endsWith(".css"),E=x?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${y}"]${E}`))return;const C=document.createElement("link");if(C.rel=x?"stylesheet":nR,x||(C.as="script"),C.crossOrigin="",C.href=y,m&&C.setAttribute("nonce",m),document.head.appendChild(C),x)return new Promise((O,X)=>{C.addEventListener("load",O),C.addEventListener("error",()=>X(new Error(`Unable to preload CSS for ${y}`)))})}))}function l(d){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=d,window.dispatchEvent(f),!f.defaultPrevented)throw d}return a.then(d=>{for(const f of d||[])f.status==="rejected"&&l(f.reason);return e().catch(l)})};function pw({open:n,title:e,placeholder:t,value:s,status:a,loading:l,onChange:d,onSubmit:f,onClose:m}){if(!n)return null;const y=typeof a=="string"&&a.toLowerCase().startsWith("sent!")?"#a3f0cf":"#ffb6c1";return o.jsx("div",{className:"suggestion-backdrop",onClick:x=>{x.target===x.currentTarget&&m&&m()},children:o.jsxs("div",{className:"suggestion-modal",children:[o.jsxs("div",{className:"suggestion-modal-header",children:[o.jsx("h3",{children:e}),o.jsx("button",{className:"suggestion-close",type:"button",onClick:m,"aria-label":"Close",children:"X"})]}),o.jsx("p",{className:"suggestion-hint",children:"Tell me what to add next. Titles only is fine, but extra notes are welcome."}),o.jsx("textarea",{className:"suggestion-textarea",placeholder:t,value:s,onChange:x=>d==null?void 0:d(x.target.value),maxLength:500}),a&&o.jsx("div",{className:"suggestion-status",style:{color:y},children:a}),o.jsxs("div",{className:"suggestion-actions",children:[o.jsx("button",{className:"suggestion-send",type:"button",onClick:f,disabled:l,children:l?"Sending...":"Send Suggestion"}),o.jsx("button",{className:"suggestion-cancel",type:"button",onClick:m,children:"Cancel"})]})]})})}const om="mangaLibraryActivityLog",Va="https://discord.com/api/webhooks/1448329790942613667/wsC8psNZ-Ax2D1O9Gl4sJi6ay7df2cr7IrIdxMPwGZTBnkSUIY2NDpeVd98qW_4plz82";let Co=null;function sR(n){return Array.isArray(n)?n.map(e=>({message:e.message,ts:e.ts?new Date(e.ts):new Date,user:e.user||e.email||"",context:e.context||"",details:Array.isArray(e.details)?e.details:[]})).filter(e=>e.message):[]}function iR(){if(typeof window>"u")return[];try{const n=localStorage.getItem(om);if(!n)return[];const e=JSON.parse(n);return sR(e)}catch(n){return console.warn("Failed to read activity log",n),[]}}function mw(n){try{const e=(n||[]).slice(0,100).map(t=>({message:t.message,ts:t.ts instanceof Date?t.ts.toISOString():t.ts,user:t.user||"",context:t.context||"",details:t.details||[]}));typeof window<"u"&&localStorage.setItem(om,JSON.stringify(e))}catch(e){console.warn("Failed to persist activity log",e)}}async function aR(){if(Co)return Co;try{const n=Mt(at,"settings","webhooks"),e=await jd(n);if(e.exists())return Co=e.data().activity||Va,Co}catch(n){console.warn("Failed to load activity webhook",n)}return Co=Va,Co}function p_(n){if(n==null)return"";if(typeof n=="object")try{return JSON.stringify(n)}catch{return String(n)}return String(n)}function oR(n){return n?typeof n=="string"?[n]:Array.isArray(n)?n.map(e=>p_(e)):typeof n=="object"?Object.entries(n).map(([e,t])=>`${e}: ${p_(t)}`):[]:[]}async function lR(n,e={}){if(n)try{const{email:t,name:s,webhookOverride:a,context:l,list:d,action:f,detailLines:m=[]}=e,y=a||await aR();if(!y)return;const x=(s||"").trim()||t||"anonymous",E=new Date,C=Intl.DateTimeFormat().resolvedOptions().timeZone||"local time",O=[];O.push(" **Library Activity**"),O.push(` ${n}`),O.push(` ${x}       ${E.toLocaleString()} (${C})`);const X=[];l&&X.push(`Context: ${l}`),d&&X.push(`List: ${d}`),f&&X.push(`Action: ${f}`),X.length&&O.push(X.join("      ")),m.length&&(O.push(" Details:"),m.forEach(B=>O.push(` ${B}`))),await fetch(y,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:O.join(`
`)})})}catch(t){console.warn("Activity webhook failed",t)}}async function gw(n,e={}){if(!n)return null;const{email:t,name:s,webhookOverride:a,persistLocal:l=!0,context:d="",list:f="",action:m="",details:y=null}=e,x=oR(y),E={message:n,ts:new Date,user:(s||"").trim()||t||"",context:d,details:x};if(l){const C=iR(),O=[E,...C].slice(0,100);mw(O)}return await lR(n,{email:t,name:s,webhookOverride:a,context:d,list:f,action:m,detailLines:x}),E}const m_=5,cR=3600*1e3,g_="mangaSuggestionsSent",y_="mangaViewMode";function Lt(n){let e=(n||"").trim();const t=e.match(/^(.*?)(?:,?\s*(?:Vol\.|Volume)\s*(\d+)(?:\s*[--]\s*\d+)?\s*)?(?:\s*\([^)]*\))?$/i),s=t?t[1].trim().toLowerCase():e.toLowerCase(),a=t&&t[2]?parseInt(t[2],10):0;return{name:s,vol:Number.isFinite(a)?a:0}}function uR(n){if(typeof n=="number")return n;if(n==null||n==="")return 0;const e=parseInt(n,10);return Number.isFinite(e)?e:0}function v_(){const n=new Date,e=n.getFullYear(),t=String(n.getMonth()+1).padStart(2,"0"),s=String(n.getDate()).padStart(2,"0");return`${e}-${t}-${s}`}function Io(n){const e=(n==null?void 0:n.pageCount)??(n==null?void 0:n.PageCount)??"",t=String(e??"").trim();if(!t)return!0;const s=uR(t);return!Number.isFinite(s)||s<=0}function Qt(n,e=!1){const t=(n??"").toString().trim();return!t||!e&&t.toLowerCase()==="unknown"}function Su(n,e={}){const t=e.includeIsbn??!1,s=e.includeFinance??!1,a=((n==null?void 0:n.specialType)||"").toLowerCase()==="collectible"||((n==null?void 0:n.SpecialType)||"").toLowerCase()==="collectible",l=Qt(n==null?void 0:n.authors),d=Qt(n==null?void 0:n.publisher),f=Qt(n==null?void 0:n.date),m=t?Qt(n==null?void 0:n.isbn):!1,y=s&&!a?Qt(n==null?void 0:n.amountPaid):!1,x=s&&a?Qt(n==null?void 0:n.collectiblePrice):!1,E=s?Qt((n==null?void 0:n.msrp)??(n==null?void 0:n.MSRP)):!1,C=s?Qt(n==null?void 0:n.datePurchased):!1;return{authorMissing:l,publisherMissing:d,dateMissing:f,isbnMissing:m,amountMissing:y,collectibleMissing:x,msrpMissing:E,purchaseMissing:C,any:l||d||f||m||y||x||E||C}}function jr(n){if(!n)return"";const e=String(n).trim();if(/^\d{4}-\d{2}-\d{2}$/.test(e))return e;const t=new Date(e);if(Number.isNaN(t.getTime()))return"";const s=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),l=String(t.getDate()).padStart(2,"0");return`${s}-${a}-${l}`}const dR=(n,e)=>{const t=Lt(n.title||""),s=Lt(e.title||""),a=t.name.localeCompare(s.name);return a!==0?a:t.vol-s.vol};function hR(n){const t=(n||"").match(/vol(?:ume)?\.?\s*(\d+)(?:\s*[-]\s*(\d+))?/i);if(!t)return[];const s=parseInt(t[1],10),a=t[2]?parseInt(t[2],10):s;if(!Number.isFinite(s))return[];const l=Number.isFinite(a)&&a>=s?a:s,d=[];for(let f=s;f<=l;f+=1)d.push(f);return d}function fR(){const{admin:n,user:e,role:t}=Qa(),s=n,a=(w,z={})=>{w&&gw(w,{email:(e==null?void 0:e.email)||"anonymous",name:(e==null?void 0:e.displayName)||"",context:"Manga",...z})},[l,d]=j.useState("library"),[f,m]=j.useState(()=>typeof window>"u"?"series":localStorage.getItem(y_)==="individual"?"individual":"series");j.useEffect(()=>{me("")},[e]),j.useEffect(()=>{try{localStorage.setItem(y_,f)}catch(w){console.warn("Failed to persist manga view mode",w)}},[f]);const y=async()=>{const w=Date.now(),W=(()=>{try{const F=localStorage.getItem(g_);return Array.isArray(JSON.parse(F))?JSON.parse(F):[]}catch{return[]}})().filter(F=>w-F<cR);if(W.length>=m_){me("Rate limit: please wait a bit (max 5 suggestions per hour).");return}if(!Oe.trim()){me("Please enter a manga title or note before sending.");return}Le(!0),me("");try{const F=`**Manga Suggestion**
${Oe.trim()}
From: ${(e==null?void 0:e.displayName)||(e==null?void 0:e.email)||(e==null?void 0:e.uid)||"anonymous user"}`;await Oa(bn(at,"suggestions"),{content:Oe.trim(),type:"manga",from:(e==null?void 0:e.displayName)||(e==null?void 0:e.email)||(e==null?void 0:e.uid)||"anonymous user",createdAt:new Date().toISOString()}),me("Sent! I'll review your suggestion soon."),Qe("");const G=[...W,w].slice(-m_);localStorage.setItem(g_,JSON.stringify(G))}catch(F){console.error("Failed to send suggestion",F),me("Failed to send suggestion. Please try again later.")}finally{Le(!1)}},[x,E]=j.useState([]),[C,O]=j.useState([]),[X,B]=j.useState([]),[U,se]=j.useState([]),[we,_e]=j.useState(!1),[ve,L]=j.useState(!0),[ie,I]=j.useState(""),[N,A]=j.useState(""),[M,D]=j.useState(""),[P,b]=j.useState(!1),[J,re]=j.useState(()=>new Set);j.useEffect(()=>{f==="series"&&P&&(typeof Je>"u"||Je===null)&&(b(!1),re(new Set))},[f,P]);const[Ce,fe]=j.useState({open:!1,mode:"add",list:"library",data:{title:"",authors:"",publisher:"",demographic:"",genre:"",subGenre:"",date:"",cover:"",isbn:"",pageCount:"",rating:"",amountPaid:"",dateRead:"",datePurchased:"",msrp:"",special:!1,specialType:"",specialVolumes:"",collectiblePrice:"",amazonURL:"",read:!1},editingId:null,multiAdd:!1,startVol:"",endVol:""}),[le,Pe]=j.useState([]),[xe,Y]=j.useState(0),k=j.useMemo(()=>{const w=Ce.list==="library",z=w&&Ce.data.special&&Ce.data.specialType==="collectible",W=w&&!z;return{author:Qt(Ce.data.authors),publisher:Qt(Ce.data.publisher),date:Qt(Ce.data.date),purchaseDate:w?Qt(Ce.data.datePurchased):!1,page:Io({pageCount:Ce.data.pageCount}),isbn:w?Qt(Ce.data.isbn):!1,amountPaid:W?Qt(Ce.data.amountPaid):!1,collectiblePrice:z?Qt(Ce.data.collectiblePrice):!1,msrp:w?Qt(Ce.data.msrp):!1}},[Ce.data,Ce.list]),[K,Te]=j.useState({open:!1,index:0,items:[]}),[De,ke]=j.useState(!1),[Oe,Qe]=j.useState(""),[nt,me]=j.useState(""),[ce,Le]=j.useState(!1),[ge,He]=j.useState(null),[Je,_t]=j.useState(null);j.useEffect(()=>{const w="Manga | Library";if(!s){document.title=w;return}const z=[...x,...C].reduce((W,F)=>{const G=Io(F),ue=Su(F,{includeIsbn:F.kind==="library",includeFinance:F.kind==="library"});return W+(G||ue.any?1:0)},0);document.title=z>0?`(${z}) ${w}`:w},[s,x,C]),j.useEffect(()=>{if(!!ge||!!Je||Ce.open||K.open||De){const z=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=z}}},[ge,Je,Ce.open,K.open,De]);const Ct=!!e&&t==="viewer";async function Nt(){const w=await Ns(bn(at,"library")),z=[];w.forEach(W=>{const F=W.data();z.push({id:W.id,title:F.title||"",authors:F.authors||"Unknown",publisher:F.publisher||"Unknown",demographic:F.demographic||"",genre:F.genre||"",subGenre:F.subGenre||"",date:jr(F.date)||F.date||"Unknown",cover:F.cover||"",isbn:F.isbn||"",pageCount:F.pageCount!==void 0&&F.pageCount!==null?F.pageCount:"",rating:F.rating!==void 0&&F.rating!==null?F.rating:"",amountPaid:F.amountPaid!==void 0&&F.amountPaid!==null?F.amountPaid:"",dateRead:jr(F.dateRead)||F.dateRead||"",datePurchased:jr(F.datePurchased)||F.datePurchased||"",msrp:F.msrp!==void 0&&F.msrp!==null?F.msrp:"",specialType:F.specialType||"",specialVolumes:F.specialVolumes!==void 0&&F.specialVolumes!==null?F.specialVolumes:"",collectiblePrice:F.collectiblePrice!==void 0&&F.collectiblePrice!==null?F.collectiblePrice:"",read:!!F.read,amazonURL:F.amazonURL||"",hidden:!!F.hidden,kind:"library"})}),z.sort((W,F)=>{const G=Lt(W.title),ue=Lt(F.title),te=G.name.localeCompare(ue.name);return te!==0?te:G.vol-ue.vol}),E(z),B(W=>{const F=new Set(W);return z.forEach(G=>F.add(G.title||"")),Array.from(F).filter(Boolean).sort()})}async function Ot(){const w=await Ns(bn(at,"wishlist")),z=[];w.forEach(W=>{const F=W.data();z.push({id:W.id,title:F.title||"",authors:F.authors||"Unknown",publisher:F.publisher||"Unknown",date:jr(F.date)||F.date||"Unknown",cover:F.cover||"",isbn:F.isbn||"",pageCount:F.pageCount!==void 0&&F.pageCount!==null?F.pageCount:"",rating:F.rating!==void 0&&F.rating!==null?F.rating:"",amountPaid:F.amountPaid!==void 0&&F.amountPaid!==null?F.amountPaid:"",datePurchased:jr(F.datePurchased)||F.datePurchased||"",specialType:F.specialType||"",specialVolumes:F.specialVolumes!==void 0&&F.specialVolumes!==null?F.specialVolumes:"",collectiblePrice:F.collectiblePrice!==void 0&&F.collectiblePrice!==null?F.collectiblePrice:"",amazonURL:F.amazonURL||"",hidden:!!F.hidden,kind:"wishlist"})}),z.sort((W,F)=>{const G=Lt(W.title),ue=Lt(F.title),te=G.name.localeCompare(ue.name);return te!==0?te:G.vol-ue.vol}),O(z),B(W=>{const F=new Set(W);return z.forEach(G=>F.add(G.title||"")),Array.from(F).filter(Boolean).sort()})}j.useEffect(()=>{let w=!1,z=!1,W=!1;const F=async()=>{if(!w)try{const Ne=await fetch("/base/manga-library-wishlist.json",{cache:"no-cache"});if(!Ne.ok)throw new Error("fallback fetch failed");const $e=await Ne.json(),de=Array.isArray($e.library)?$e.library:[],Xe=Array.isArray($e.wishlist)?$e.wishlist:[];E(de.map((Re,ht)=>({id:Re.id||`offline-lib-${ht}`,title:Re.title||"",authors:Re.authors||"Unknown",publisher:Re.publisher||"Unknown",demographic:Re.demographic||"",genre:Re.genre||"",subGenre:Re.subGenre||"",date:jr(Re.date)||Re.date||"Unknown",cover:Re.cover||"",isbn:Re.isbn||"",pageCount:Re.pageCount??"",rating:Re.rating??"",amountPaid:Re.amountPaid??"",dateRead:jr(Re.dateRead)||Re.dateRead||"",datePurchased:jr(Re.datePurchased)||Re.datePurchased||"",msrp:Re.msrp??"",specialType:Re.specialType||"",specialVolumes:Re.specialVolumes??"",collectiblePrice:Re.collectiblePrice??"",amazonURL:Re.amazonURL||"",read:!!Re.read,hidden:!!Re.hidden,kind:"library"}))),O(Xe.map((Re,ht)=>({id:Re.id||`offline-wish-${ht}`,title:Re.title||"",authors:Re.authors||"Unknown",publisher:Re.publisher||"Unknown",demographic:Re.demographic||"",genre:Re.genre||"",subGenre:Re.subGenre||"",date:jr(Re.date)||Re.date||"Unknown",cover:Re.cover||"",isbn:Re.isbn||"",pageCount:Re.pageCount??"",rating:Re.rating??"",amountPaid:Re.amountPaid??"",dateRead:jr(Re.dateRead)||Re.dateRead||"",datePurchased:jr(Re.datePurchased)||Re.datePurchased||"",msrp:Re.msrp??"",specialType:Re.specialType||"",specialVolumes:Re.specialVolumes??"",collectiblePrice:Re.collectiblePrice??"",amazonURL:Re.amazonURL||"",read:!!Re.read,hidden:!!Re.hidden,kind:"wishlist"}))),I("")}catch(Me){console.error("Offline fallback failed",Me),I("Failed to load manga data from Firestore.")}finally{w||L(!1)}},G=()=>{z&&W&&!w&&L(!1)};if(!e)return;L(!0),I("");const ue=u_(bn(at,"library"),Me=>{if(w)return;const Ne=[];Me.forEach($e=>{const de=$e.data();Ne.push({id:$e.id,title:de.title||"",authors:de.authors||"Unknown",publisher:de.publisher||"Unknown",demographic:de.demographic||"",genre:de.genre||"",subGenre:de.subGenre||"",date:de.date||"Unknown",cover:de.cover||"",isbn:de.isbn||"",pageCount:de.pageCount!==void 0&&de.pageCount!==null?de.pageCount:"",rating:de.rating!==void 0&&de.rating!==null?de.rating:"",amountPaid:de.amountPaid!==void 0&&de.amountPaid!==null?de.amountPaid:"",dateRead:de.dateRead||"",datePurchased:de.datePurchased||"",msrp:de.msrp!==void 0&&de.msrp!==null?de.msrp:"",specialType:de.specialType||"",specialVolumes:de.specialVolumes!==void 0&&de.specialVolumes!==null?de.specialVolumes:"",collectiblePrice:de.collectiblePrice!==void 0&&de.collectiblePrice!==null?de.collectiblePrice:"",read:!!de.read,amazonURL:de.amazonURL||"",hidden:!!de.hidden,kind:"library"})}),Ne.sort(($e,de)=>{const Xe=Lt($e.title),Re=Lt(de.title),ht=Xe.name.localeCompare(Re.name);return ht!==0?ht:Xe.vol-Re.vol}),E(Ne),B($e=>{const de=new Set($e);return Ne.forEach(Xe=>de.add(Xe.title||"")),Array.from(de).filter(Boolean).sort()}),z=!0,G()},async Me=>{console.error("Library listener failed",Me),w||(I("Failed to load manga data from Firestore."),await F())}),te=u_(bn(at,"wishlist"),Me=>{if(w)return;const Ne=[];Me.forEach($e=>{const de=$e.data();Ne.push({id:$e.id,title:de.title||"",authors:de.authors||"Unknown",publisher:de.publisher||"Unknown",demographic:de.demographic||"",genre:de.genre||"",subGenre:de.subGenre||"",date:de.date||"Unknown",cover:de.cover||"",isbn:de.isbn||"",pageCount:de.pageCount!==void 0&&de.pageCount!==null?de.pageCount:"",rating:de.rating!==void 0&&de.rating!==null?de.rating:"",amountPaid:de.amountPaid!==void 0&&de.amountPaid!==null?de.amountPaid:"",datePurchased:de.datePurchased||"",specialType:de.specialType||"",specialVolumes:de.specialVolumes!==void 0&&de.specialVolumes!==null?de.specialVolumes:"",collectiblePrice:de.collectiblePrice!==void 0&&de.collectiblePrice!==null?de.collectiblePrice:"",amazonURL:de.amazonURL||"",hidden:!!de.hidden,kind:"wishlist"})}),Ne.sort(($e,de)=>{const Xe=Lt($e.title),Re=Lt(de.title),ht=Xe.name.localeCompare(Re.name);return ht!==0?ht:Xe.vol-Re.vol}),O(Ne),B($e=>{const de=new Set($e);return Ne.forEach(Xe=>de.add(Xe.title||"")),Array.from(de).filter(Boolean).sort()}),W=!0,G()},async Me=>{console.error("Wishlist listener failed",Me),w||(I("Failed to load manga data from Firestore."),await F())});return()=>{w=!0,ue==null||ue(),te==null||te()}},[e]);const Zt=j.useMemo(()=>{const w=N.trim().toLowerCase();return w?x.filter(z=>[z.title,z.authors,z.publisher,z.isbn,z.date,String(z.pageCount??"")].join(" ").toLowerCase().includes(w)):x},[x,N]),sn=j.useMemo(()=>s&&we?Zt:Zt.filter(w=>!w.hidden),[Zt,s,we]),en=j.useMemo(()=>{const w=M.trim().toLowerCase();return w?C.filter(z=>[z.title,z.authors,z.publisher,z.isbn,z.date,String(z.pageCount??"")].join(" ").toLowerCase().includes(w)):C},[C,M]),qn=j.useMemo(()=>s&&we?en:en.filter(w=>!w.hidden),[en,s,we]),yn=w=>{m(w==="individual"?"individual":"series"),re(new Set),b(!1)},cr=w=>{if(!(w!=null&&w.length))return;const z=(W,F)=>{let G=[...W];return w.filter(ue=>ue.target===F).forEach(ue=>{const te=G.findIndex(Ne=>Ne.id===ue.id),Me={...te>=0?G[te]:{},...ue.payload,id:ue.id,kind:F};te>=0?G[te]=Me:G.push(Me)}),G.sort(dR),G};E(W=>z(W,"library")),O(W=>z(W,"wishlist"))},jt=w=>{b(z=>{const W=!z;if(W){const F=new Set((w||[]).map(G=>G.id));re(G=>new Set([...G].filter(ue=>F.has(ue))))}else re(new Set);return W})};function Bt(){s&&(b(w=>!w),re(new Set))}function In(w){re(z=>{const W=new Set(z);return W.has(w)?W.delete(w):W.add(w),W})}async function Dn(w,z=null){if(!s){alert("Multi-select actions require admin access.");return}const W=Array.from(J);if(!W.length){alert("Select at least one item first.");return}const F=l==="library"?"library":"wishlist",G=z||(F==="library"?"wishlist":"library"),ue=F==="library";try{if(w==="move"){const te=F==="library"?x:C;if(!window.confirm(`Move ${W.length} item(s) from ${F==="library"?"Library":"Wishlist"} to ${G==="library"?"Library":"Wishlist"}?`))return;for(const Me of W){const Ne=te.find(de=>de.id===Me);if(!Ne)continue;const $e=G==="library"?{title:Ne.title,authors:Ne.authors,publisher:Ne.publisher,date:Ne.date,pageCount:Ne.pageCount||"",cover:Ne.cover,amountPaid:"",read:!1,rating:"",msrp:"",collectiblePrice:"",specialType:"",specialVolumes:"",isbn:Ne.isbn||"",demographic:Ne.demographic||"",genre:Ne.genre||"",subGenre:Ne.subGenre||"",hidden:!!Ne.hidden,datePurchased:Ne.datePurchased||"",dateRead:Ne.dateRead||""}:{title:Ne.title,authors:Ne.authors,publisher:Ne.publisher,date:Ne.date,pageCount:Ne.pageCount||"",cover:Ne.cover,amazonURL:Ne.amazonURL||"",hidden:!!Ne.hidden,datePurchased:"",read:!1,rating:"",msrp:"",collectiblePrice:"",specialType:"",specialVolumes:"",isbn:"",demographic:"",genre:"",subGenre:""};if(G==="library"&&($e.msrp===""||$e.msrp===null)){const de=Vs(Ne);de!==""&&de!==null&&de!==void 0&&($e.msrp=de)}await Oa(bn(at,G),$e),await Ma(Mt(at,F,Me))}a(`Moved ${W.length} item${W.length===1?"":"s"} from ${F==="library"?"Library":"Wishlist"} to ${G==="library"?"Library":"Wishlist"}`,{action:"move",list:F==="library"?"Library":"Wishlist",details:{count:W.length,from:F,to:G}})}else if(w==="markRead"&&ue){for(const te of W)await Ps(Mt(at,"library",te),{read:!0,dateRead:v_()});a(`Marked ${W.length} library book${W.length===1?"":"s"} as read`,{action:"markRead",list:"Library",details:{count:W.length}})}else if(w==="markUnread"&&ue){for(const te of W)await Ps(Mt(at,"library",te),{read:!1,dateRead:"",rating:""});a(`Marked ${W.length} library book${W.length===1?"":"s"} as unread`,{action:"markUnread",list:"Library",details:{count:W.length}})}else if(w==="delete"){const te=ue?"library":"wishlist";if(!window.confirm(`Delete ${W.length} item(s) from ${ue?"Library":"Wishlist"}?`))return;for(const Me of W)await Ma(Mt(at,te,Me));a(`Deleted ${W.length} item${W.length===1?"":"s"} from ${te==="library"?"Library":"Wishlist"}`,{action:"delete-multi",list:te==="library"?"Library":"Wishlist",details:{count:W.length}})}await Promise.all([Nt(),Ot()]),re(new Set),b(!1)}catch(te){console.error(te),alert("Failed to apply multi-select action.")}}function Hn(w){He(w)}function _r(){He(null)}function xr(w){const z=Jn.filter(W=>(Lt(W.title||"").name||(W.title||"").toLowerCase()||W.id)===w.key).sort((W,F)=>Lt(W.title).vol-Lt(F.title).vol);_t({series:w,volumes:z})}function ys(){_t(null)}const Kn=()=>{fe(w=>({...w,open:!1,mode:"add",editingId:null,data:{title:"",authors:"",publisher:"",demographic:"",genre:"",subGenre:"",date:"",cover:"",isbn:"",pageCount:"",rating:"",amountPaid:"",dateRead:"",datePurchased:"",msrp:"",special:!1,specialType:"",specialVolumes:"",collectiblePrice:"",amazonURL:"",read:!1,hidden:!1},multiAdd:!1,startVol:"",endVol:""})),Pe([]),Y(0)},cn=j.useMemo(()=>{const w=new Map;return[...x,...C].forEach(z=>{const W=Lt(z.title||"");if(!W.name)return;const F=(z.title||"").replace(/,?\s*Vol\.?\s*\d+.*/i,"").trim()||z.title||W.name;if(!w.has(W.name))w.set(W.name,{display:F,maxVol:W.vol,authors:z.authors||"",publisher:z.publisher||"",demographic:z.demographic||""});else{const G=w.get(W.name);G.maxVol=Math.max(G.maxVol,W.vol),!G.authors&&z.authors&&(G.authors=z.authors),!G.publisher&&z.publisher&&(G.publisher=z.publisher),!G.demographic&&z.demographic&&(G.demographic=z.demographic)}}),w},[x,C]),un=w=>{fe(z=>({...z,open:!0,mode:"add",list:w,editingId:null,data:{...z.data,title:"",list:w}})),Pe([{kind:"new",id:null,data:{title:"",authors:"",publisher:"",demographic:"",genre:"",subGenre:"",date:"",cover:"",isbn:"",pageCount:"",rating:"",amountPaid:"",dateRead:"",datePurchased:"",msrp:"",specialType:"",specialVolumes:"",collectiblePrice:"",amazonURL:"",read:!1}}]),Y(0)},vs=w=>{const z={open:!0,mode:"edit",list:w.kind==="wishlist"?"wishlist":"library",editingId:w.id,data:{title:w.title||"",authors:w.authors||"",publisher:w.publisher||"",demographic:w.demographic||"",genre:w.genre||"",subGenre:w.subGenre||"",date:w.date||"",cover:w.cover||"",isbn:w.isbn||"",pageCount:w.pageCount||"",rating:w.rating||"",amountPaid:w.amountPaid||"",dateRead:w.dateRead||"",datePurchased:w.datePurchased||"",msrp:w.msrp||"",special:!!(w.specialType||w.specialVolumes||w.collectiblePrice),specialType:w.specialType||"",specialVolumes:w.specialVolumes||"",collectiblePrice:w.collectiblePrice||"",amazonURL:w.amazonURL||"",read:!!w.read,hidden:!!w.hidden}};fe(z),Pe([{kind:"edit",id:w.id,data:{...z.data}}]),Y(0)},mt=(w,z,W="text")=>{if(fe(F=>{const G={...F.data,[w]:W==="checkbox"?!!z:z};if(w==="special"&&!z&&(G.specialType="",G.specialVolumes="",G.collectiblePrice=""),w==="specialType"&&(z==="collectible"?G.specialVolumes="":(z==="specialEdition"||(G.specialVolumes=""),G.collectiblePrice="")),w==="title"){const ue=Lt(z||"");if(ue.name&&cn.has(ue.name)){const te=cn.get(ue.name);G.authors=te.authors||G.authors,G.publisher=te.publisher||G.publisher,G.demographic=te.demographic||G.demographic}}return{...F,data:G}}),Pe(F=>{if(!F.length)return F;const G=[...F],ue={...G[xe]};return ue.data={...ue.data,[w]:W==="checkbox"?!!z:z},G[xe]=ue,G}),w==="title"){const F=String(z||"").trim().toLowerCase();if(!F)se([]);else{const G=[];cn.forEach(ue=>{if(ue.display.toLowerCase().includes(F)){const te=ue.maxVol>0?ue.maxVol+1:1;G.push(`${ue.display}, Vol. ${te}`)}}),se(G.slice(0,6))}}},wr=w=>{le[w]&&(Y(w),fe(z=>{const W=le[w];return{...z,data:{...W.data}}}))},Br=()=>{const w=Ce.data.title||"",z=Lt(w);if(!z.name){alert("Provide a title with a volume number first (e.g., Series, Vol. 1).");return}const W={kind:Ce.mode,id:Ce.editingId,data:{...Ce.data}},F=le.length?[...le]:[];F.length?F[xe]=W:F.push(W);const G=w.replace(/,?\s*Vol\.?\s*\d+.*/i,"").trim()||w;let ue=z.vol||0;const te=cn.get(z.name);te&&te.maxVol>ue&&(ue=te.maxVol),F.forEach(de=>{const Xe=Lt(de.data.title||"");Xe.name===z.name&&(ue=Math.max(ue,Xe.vol||0))});const Me=(ue||0)+1,$e={title:`${G}, Vol. ${Me}`,authors:Ce.data.authors,publisher:Ce.data.publisher,demographic:Ce.data.demographic,genre:Ce.data.genre,subGenre:Ce.data.subGenre,msrp:Ce.data.msrp,hidden:Ce.data.hidden,cover:"",isbn:"",pageCount:"",rating:"",amountPaid:"",date:"",dateRead:"",datePurchased:"",special:!1,specialType:"",specialVolumes:"",collectiblePrice:"",amazonURL:"",read:!1};F.push({kind:"new",id:null,data:$e}),Pe(F),Y(F.length-1),fe(de=>({...de,mode:"add",data:$e}))};async function Qn(){if(!s)return;const{list:w}=Ce,z=w||"library",W=le.length>0?le:[{kind:Ce.mode,id:Ce.editingId,data:Ce.data}],F=G=>{const ue=(G.title||"").trim(),te=Lt(ue),Me=cn.get(te.name)||{},Ne=(G.authors||"").trim()||Me.authors||"",$e=(G.publisher||"").trim()||Me.publisher||"",de=(G.demographic||"").trim()||Me.demographic||"",Xe=(G.genre||"").trim()||Me.genre||"",Re=(G.subGenre||"").trim()||Me.subGenre||"";return{title:ue,authors:Ne,publisher:$e,demographic:de,genre:Xe,subGenre:Re,date:jr(G.date||""),cover:(G.cover||"").trim(),isbn:z==="wishlist"?"":(G.isbn||"").trim(),pageCount:G.pageCount===""?"":Number(G.pageCount),rating:z==="wishlist"||G.rating===""?"":Math.max(.5,Math.min(5,Number(G.rating))),amountPaid:G.amountPaid===""?"":Number(G.amountPaid),dateRead:jr(G.dateRead||""),datePurchased:jr(G.datePurchased||""),msrp:z==="wishlist"||G.msrp===""?"":Number(G.msrp),special:z==="wishlist"?!1:!!(G.special&&(G.specialType||"").trim()),specialType:z==="wishlist"||!(G.special&&(G.specialType||"").trim())?"":(G.specialType||"").trim(),specialVolumes:z==="wishlist"?"":G.special&&G.specialType==="specialEdition"?G.specialVolumes===""?"":Number(G.specialVolumes):"",collectiblePrice:z==="wishlist"?"":G.special&&G.specialType==="collectible"?G.collectiblePrice===""?"":Number(G.collectiblePrice):"",amazonURL:(G.amazonURL||"").trim(),read:z==="wishlist"?!1:!!G.read,hidden:!!G.hidden,kind:w}};try{const G=await Promise.all(W.map(async ue=>{const te=F(ue.data);if(z==="library"&&ue.kind!=="edit"){const Me=Lt(te.title).name,Ne=x.filter(de=>Lt(de.title||de.Title||"").name===Me),$e=Ne[0];if($e&&(te.demographic=te.demographic||$e.demographic||$e.Demographic||"",te.genre=te.genre||$e.genre||$e.Genre||"",te.subGenre=te.subGenre||$e.subGenre||$e.SubGenre||"",te.msrp==="")){const de=Ne.map(Xe=>Number(Xe.msrp??Xe.MSRP)).filter(Xe=>Number.isFinite(Xe));de.length>0&&de.every(Re=>Re===de[0])&&(te.msrp=de[0])}}if(!te.title)throw alert("Title is required for every entry."),new Error("missing title");if(ue.kind==="edit"&&ue.id)return await Ps(Mt(at,z,ue.id),te),{target:z,id:ue.id,payload:te};{const Me=await Oa(bn(at,z),te);return{target:z,id:Me.id,payload:te}}}));cr(G.filter(Boolean)),await Promise.all([Nt(),Ot()]),a(`${Ce.mode==="add"?"Added":"Saved"} ${W.length} item${W.length===1?"":"s"} in ${z==="library"?"Library":"Wishlist"}`,{action:Ce.mode==="add"?"create":"update",list:z==="library"?"Library":"Wishlist",details:{entries:W.length,mode:Ce.mode}}),Kn()}catch(G){console.error(G),alert("Failed to save entry.")}}async function Nn(w,z){if(!s||!window.confirm("Delete this entry?"))return;const F=(z==="wishlist"?C:x).find(G=>G.id===w);try{await Ma(Mt(at,z,w)),await Promise.all([Nt(),Ot()]),a(`Deleted "${(F==null?void 0:F.title)||"Untitled"}" from ${z==="library"?"Library":"Wishlist"}`,{action:"delete-single",list:z==="library"?"Library":"Wishlist",details:{title:(F==null?void 0:F.title)||"Untitled"}})}catch(G){console.error(G),alert("Failed to delete entry.")}}const[Wr,ur]=j.useState(!1),Yn=()=>Te({open:!1,index:0,items:[]});async function Gr(w,z,W={}){if(!(w!=null&&w.id))return;const F=w.kind==="wishlist"?"wishlist":"library";ur(!0);try{await Ps(Mt(at,F,w.id),z),cr([{target:F,id:w.id,payload:z}]),await Promise.all([Nt(),Ot()]),a(`Updated "${w.title||"Untitled"}" in ${F==="library"?"Library":"Wishlist"}`,{action:W.action||"inline-update",list:F==="library"?"Library":"Wishlist",details:W.details||{title:w.title||"Untitled",fields:Object.keys(z||{}).join(", "),rating:z.rating??void 0}}),He(G=>G&&G.id===w.id?{...G,...z}:G)}catch(G){console.error(G),alert("Failed to update entry.")}finally{ur(!1)}}const Xs=(w,z)=>{const W=z===""?"":Math.max(.5,Math.min(5,Number(z)));Gr(w,{rating:W},{action:"rating",details:{title:w.title||"Untitled",rating:W}})},dr=(w,z)=>{if(!w)return;const W=z?{read:!0,dateRead:v_(),rating:w.rating??""}:{read:!1,dateRead:"",rating:""};Gr(w,W,{action:z?"mark-read":"mark-unread",details:{title:w.title||"Untitled",dateRead:z?W.dateRead:"cleared",rating:w.rating||"not set"}})},qr=()=>{if(!J.size){alert("Select at least one entry first.");return}const z=[...x,...C].filter(F=>J.has(F.id));if(!z.length){alert("No items selected.");return}const W=z.map(F=>({id:F.id,kind:F.kind||(l==="wishlist"?"wishlist":"library"),data:{title:F.title||"",authors:F.authors||"",publisher:F.publisher||"",demographic:F.demographic||"",genre:F.genre||"",subGenre:F.subGenre||"",date:F.date||"",cover:F.cover||"",isbn:F.isbn||"",pageCount:F.pageCount||"",rating:F.rating||"",amountPaid:F.amountPaid||"",dateRead:F.dateRead||"",datePurchased:F.datePurchased||"",msrp:F.msrp||"",special:!!(F.specialType||F.specialVolumes||F.collectiblePrice),specialType:F.specialType||"",specialVolumes:F.specialVolumes||"",collectiblePrice:F.collectiblePrice||"",amazonURL:F.amazonURL||"",read:!!F.read,hidden:!!F.hidden}}));Te({open:!0,index:0,items:W})},st=(w,z,W="text")=>{Te(F=>{const G=[...F.items],ue={...G[F.index]},te={...ue.data,[w]:W==="checkbox"?!!z:z};return w==="special"&&!z&&(te.specialType="",te.specialVolumes="",te.collectiblePrice=""),w==="specialType"&&(z==="collectible"?te.specialVolumes="":(z==="specialEdition"||(te.specialVolumes=""),te.collectiblePrice="")),ue.data=te,G[F.index]=ue,{...F,items:G}})},ks=()=>{Te(w=>({...w,index:Math.min(w.index+1,w.items.length-1)}))},vn=()=>{Te(w=>({...w,index:Math.max(w.index-1,0)}))};async function _s(){if(!s)return;const w=K.items;if(!w.length){Yn();return}try{const z=await Promise.all(w.map(async W=>{const G=!(W.kind==="wishlist")&&!!(W.data.special&&(W.data.specialType||"").trim()),ue={...W.data,pageCount:W.data.pageCount===""?"":Number(W.data.pageCount),rating:W.data.rating===""?"":Math.max(.5,Math.min(5,Number(W.data.rating))),amountPaid:W.data.amountPaid===""?"":Number(W.data.amountPaid),msrp:W.data.msrp===""?"":Number(W.data.msrp),special:G,specialType:G?W.data.specialType:"",collectiblePrice:G&&W.data.specialType==="collectible"?W.data.collectiblePrice===""?"":Number(W.data.collectiblePrice):"",specialVolumes:G&&W.data.specialType==="specialEdition"?W.data.specialVolumes===""?"":Number(W.data.specialVolumes):"",datePurchased:W.data.datePurchased||"",amazonURL:W.data.amazonURL||"",read:!!W.data.read},te=W.kind==="wishlist"?"wishlist":"library";return await Ps(Mt(at,te,W.id),ue),{target:te,id:W.id,payload:ue}}));cr(z.filter(Boolean)),await Promise.all([Nt(),Ot()]),re(new Set),b(!1),a(`Bulk edited ${w.length} item${w.length===1?"":"s"} in Library/Wishlist`,{action:"bulk-edit",list:"Library/Wishlist",details:{count:w.length}}),Yn()}catch(z){console.error(z),alert("Failed to save bulk edits.")}}const Hr=w=>{const z=new Map;return w.forEach(W=>{const F=Lt(W.title||""),G=F.name||(W.title||"").toLowerCase()||W.id,ue=cn.get(F.name)||null,te=(ue==null?void 0:ue.display)||(W.title||"").replace(/,?\s*Vol\.?\s*\d+.*/i,"").trim()||W.title||"Untitled",Me=Su(W,{includeIsbn:W.kind==="library",includeFinance:W.kind==="library"}),Ne=hR(W.title||""),$e=Number.isFinite(F.vol)?F.vol:0,de=Ne.length>0?Ne:$e>0?[$e]:[],Xe=de.length?de[0]:0,Re=Io(W);if(!z.has(G))z.set(G,{id:`series-${G}`,key:G,title:te,authors:W.authors&&W.authors!=="Unknown"?W.authors:(ue==null?void 0:ue.authors)||"",publisher:W.publisher&&W.publisher!=="Unknown"?W.publisher:(ue==null?void 0:ue.publisher)||"",demographic:(ue==null?void 0:ue.demographic)||W.demographic||"",cover:W.cover||"",count:1,readCount:W.read?1:0,minVol:Xe,maxVol:Xe,representative:W,volumes:[...de],missingPageCount:Re?1:0,missingMetaCount:Me.any?1:0,missingVolumeCount:Re||Me.any?1:0});else{const ht=z.get(G);if(ht.count+=1,W.read&&(ht.readCount+=1),Re&&(ht.missingPageCount+=1),Me.any&&(ht.missingMetaCount+=1),(Re||Me.any)&&(ht.missingVolumeCount+=1),de.length){const Xr=Math.min(...de),fr=Math.max(...de);ht.minVol=Math.min(ht.minVol,Xr),ht.maxVol=Math.max(ht.maxVol,fr),ht.volumes.push(...de)}!ht.cover&&W.cover&&(ht.cover=W.cover),!ht.authors&&W.authors&&W.authors!=="Unknown"&&(ht.authors=W.authors),!ht.publisher&&W.publisher&&W.publisher!=="Unknown"&&(ht.publisher=W.publisher)}}),Array.from(z.values())},Zs=w=>{const z=Array.from(new Set((w||[]).filter(te=>Number.isFinite(te)&&te>=0))).sort((te,Me)=>te-Me);if(!z.length)return null;const W=[];let F=z[0],G=z[0];for(let te=1;te<z.length;te+=1){const Me=z[te];if(Me===G+1){G=Me;continue}W.push([F,G]),F=Me,G=Me}if(W.push([F,G]),W.length===1){const[te,Me]=W[0];return te===Me?`Vol. ${te}`:`Vol. ${te}-${Me}`}return`Vols. ${W.map(([te,Me])=>te===Me?`${te}`:`${te}-${Me}`).join(", ")}`};function Ft(w){const z=J.has(w.id),W=w.kind==="library",F=s&&Io(w),G=s?Su(w,{includeIsbn:W,includeFinance:W}):{any:!1,authorMissing:!1,publisherMissing:!1,dateMissing:!1,isbnMissing:!1},ue=()=>{P&&s?In(w.id):Hn(w)};return o.jsxs("div",{className:"manga-card"+(w.read&&W?" read":"")+(z?" multiselect-selected":"")+(F?" missing-page":"")+(G.any?" missing-meta":""),onClick:ue,children:[o.jsx("div",{className:"manga-card-cover-wrap",children:o.jsx("img",{src:w.cover||"https://imgur.com/chUgq4W.png",alt:"Cover",loading:"lazy",decoding:"async"})}),o.jsxs("div",{className:"manga-card-body",children:[o.jsx("div",{className:"manga-card-title",children:w.title||"Untitled"}),o.jsxs("div",{className:"manga-card-meta",children:[o.jsx("span",{className:G.authorMissing?"missing-field":"",children:w.authors&&w.authors!=="Unknown"?w.authors:G.authorMissing?"Missing author":""}),o.jsx("br",{}),o.jsx("span",{className:G.publisherMissing?"missing-field":"",children:w.publisher&&w.publisher!=="Unknown"?w.publisher:G.publisherMissing?"Missing publisher":""}),o.jsx("br",{}),o.jsx("span",{className:G.dateMissing?"missing-field":"",children:w.date&&w.date!=="Unknown"?w.date:G.dateMissing?"Missing date":""})]}),w.isbn?o.jsxs("div",{className:"manga-card-isbn",children:["ISBN: ",w.isbn]}):W&&G.isbnMissing&&o.jsx("div",{className:"manga-card-isbn missing-field",children:"Missing ISBN"}),s&&o.jsxs("div",{className:"manga-card-actions",children:[o.jsx("button",{type:"button",className:"manga-btn mini",onClick:te=>{te.stopPropagation(),vs(w)},children:"Edit"}),o.jsx("button",{type:"button",className:"manga-btn mini danger",onClick:te=>{te.stopPropagation(),Nn(w.id,w.kind==="wishlist"?"wishlist":"library")},children:"Delete"})]})]})]},w.id)}function hr(w){var Me;const z=Zs(w.volumes),W=`${w.count} volume${w.count===1?"":"s"}`;w.readCount>=w.count&&w.count>0||`${w.readCount}${w.count}`;const F=w.readCount>=w.count&&w.count>0,G=s&&w.missingVolumeCount||0,ue=G>0,te=[w.authors&&w.authors!=="Unknown"?w.authors:null,w.publisher&&w.publisher!=="Unknown"?w.publisher:null,z?`${W} - ${z}`:W].filter(Boolean);return o.jsxs("div",{className:"manga-card series-view"+(F?" read":"")+(ue?" missing-page missing-meta":""),onClick:()=>xr(w),children:[ue&&o.jsx("div",{className:"missing-page-badge",title:"Volumes missing required data",children:G}),o.jsx("div",{className:"manga-card-cover-wrap",children:o.jsx("img",{src:w.cover||((Me=w.representative)==null?void 0:Me.cover)||"https://imgur.com/chUgq4W.png",alt:"Cover",loading:"lazy",decoding:"async"})}),o.jsxs("div",{className:"manga-card-body",children:[o.jsx("div",{className:"manga-card-title",children:w.title||"Untitled Series"}),o.jsx("div",{className:"manga-card-meta",children:te.map((Ne,$e)=>o.jsxs(np.Fragment,{children:[Ne,o.jsx("br",{})]},Ne+$e))}),o.jsx("div",{className:"manga-card-series-count",children:W})]})]},w.id)}const Kr=({value:w,onChange:z,interactive:W=!0})=>{const[F,G]=j.useState(null),ue=Math.max(0,Math.min(5,Number(w)||0)),te=W&&F!=null?F:ue,Me=Array.from({length:10},(Xe,Re)=>(Re+1)*.5),Ne=5,$e=Array.from({length:Ne},(Xe,Re)=>Math.max(0,Math.min(1,te-Re))),de=W&&typeof z=="function";return o.jsxs("div",{className:`star-shell${de?"":" read-only"}`,role:"group","aria-label":"Rating",children:[o.jsxs("div",{className:"star-visual",style:{"--star-count":Ne},children:[o.jsx("div",{className:"star-row",children:$e.map((Xe,Re)=>o.jsxs("div",{className:"star-icon",children:[o.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",className:"star-base",children:o.jsx("path",{d:"M12 2.5l2.9 5.88 6.5.95-4.7 4.58 1.1 6.43L12 17.9l-5.8 3.44 1.1-6.43-4.7-4.58 6.5-.95L12 2.5z"})}),o.jsx("div",{className:"star-fill",style:{"--pct":`${(Math.max(0,Math.min(1,Xe))*100).toFixed(1)}%`},children:o.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:o.jsx("path",{d:"M12 2.5l2.9 5.88 6.5.95-4.7 4.58 1.1 6.43L12 17.9l-5.8 3.44 1.1-6.43-4.7-4.58 6.5-.95L12 2.5z"})})})]},Re))}),de&&o.jsx("div",{className:"star-hit",children:Me.map(Xe=>o.jsx("button",{type:"button","aria-label":`${Xe} stars`,onMouseEnter:()=>G(Xe),onMouseLeave:()=>G(null),onClick:()=>z(Xe)},Xe))})]}),o.jsx("div",{className:"star-value",children:te?te.toFixed(1):"--"}),de&&o.jsx("button",{type:"button",className:"star-clear",onClick:()=>z(""),"aria-label":"Clear rating",children:"clear"})]})},Jn=l==="library"?sn:qn,Xn=l==="library"?x:C,Ut=j.useMemo(()=>Hr(Jn),[Jn,cn]),Er=j.useMemo(()=>Hr(Xn),[Xn,cn]);j.useEffect(()=>{if(!ge&&!Je)return;const w=[...x,...C];if(ge){const z=w.find(W=>W.id===ge.id);z?(z.title!==ge.title||z.isbn!==ge.isbn||z.publisher!==ge.publisher||z.authors!==ge.authors||z.date!==ge.date||z.pageCount!==ge.pageCount||z.amountPaid!==ge.amountPaid||z.msrp!==ge.msrp||z.rating!==ge.rating||z.read!==ge.read||z.amazonURL!==ge.amazonURL)&&He(z):He(null)}if(Je){const z=Ut.find(te=>te.key===Je.series.key);if(!z){_t(null);return}const W=Jn.filter(te=>(Lt(te.title||"").name||(te.title||"").toLowerCase()||te.id)===z.key).sort((te,Me)=>Lt(te.title).vol-Lt(Me.title).vol),F=W.length===Je.volumes.length&&W.every((te,Me)=>{var Ne;return((Ne=Je.volumes[Me])==null?void 0:Ne.id)===te.id}),G=W.length!==Je.volumes.length||W.some((te,Me)=>{const Ne=Je.volumes[Me];return!Ne||Ne.id!==te.id?!0:Ne.title!==te.title||Ne.authors!==te.authors||Ne.publisher!==te.publisher||Ne.date!==te.date||Ne.isbn!==te.isbn||Ne.cover!==te.cover||Ne.read!==te.read||Ne.pageCount!==te.pageCount||Ne.datePurchased!==te.datePurchased||Ne.amountPaid!==te.amountPaid||Ne.msrp!==te.msrp||Ne.rating!==te.rating}),ue=z.title!==Je.series.title||z.authors!==Je.series.authors||z.publisher!==Je.series.publisher||z.count!==Je.series.count;(G||ue||!F)&&_t({series:z,volumes:W})}},[x,C,ge,Je,Jn,Ut]);const Vn=f==="series"?Ut:Jn;f==="series"?Ut.length:Jn.length,f==="series"?Er.length:Xn.length;const ei=(w,z)=>{if(!w.length)return;const W=Array.from(w.reduce((Ne,$e)=>(Object.keys($e).forEach(de=>Ne.add(de)),Ne),new Set)),F=Ne=>{const $e=Ne==null?"":String(Ne);return/[",\n]/.test($e)?`"${$e.replace(/"/g,'""')}"`:$e},G=[W.join(",")].concat(w.map(Ne=>W.map($e=>F(Ne[$e])).join(","))),ue=new Blob([G.join(`
`)],{type:"text/csv"}),te=URL.createObjectURL(ue),Me=document.createElement("a");Me.href=te,Me.download=z,Me.click(),URL.revokeObjectURL(te)},Ds=async(w,z)=>{const W=(G,ue="image")=>(G||"").toString().toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"").slice(0,100)||ue,F=w.filter(G=>G.cover).map((G,ue)=>({url:G.cover,name:W(G.title||`manga-${ue+1}`,`manga-${ue+1}`)}));if(!F.length){alert("No images found to download.");return}try{const G=(await gc(async()=>{const{default:Re}=await import("https://cdn.jsdelivr.net/npm/jszip@3.10.1/+esm");return{default:Re}},[])).default,ue=new G,te=ue.folder("images"),Me={},Ne=F.map(async(Re,ht)=>{try{const fr=await(await fetch(Re.url)).blob(),Mn=(Re.url.split(".").pop()||"jpg").split(/[?#]/)[0],pr=Re.name||`image-${ht+1}`;Me[pr]=(Me[pr]||0)+1;const Zr=Me[pr]>1?`-${Me[pr]}`:"";te.file(`${pr}${Zr}.${Mn}`,fr)}catch(Xr){console.warn("Failed to fetch image",Re.url,Xr)}});await Promise.all(Ne);const $e=await ue.generateAsync({type:"blob"}),de=URL.createObjectURL($e),Xe=document.createElement("a");Xe.href=de,Xe.download=z,Xe.click(),URL.revokeObjectURL(de)}catch(G){console.error("Zip download failed",G),alert("Failed to create zip. Please try again.")}},Qr=(w,z)=>{const W=new Blob([JSON.stringify(w,null,2)],{type:"application/json"}),F=URL.createObjectURL(W),G=document.createElement("a");G.href=F,G.download=z,G.click(),URL.revokeObjectURL(F)},Ln=w=>({title:w.title||"",authors:w.authors||"",publisher:w.publisher||"",demographic:w.demographic||"",genre:w.genre||"",subGenre:w.subGenre||"",date:w.date||"",pageCount:w.pageCount??"",cover:w.cover||"",amountPaid:w.amountPaid??"",read:!!w.read,rating:w.rating??"",dateRead:w.dateRead||"",datePurchased:w.datePurchased||"",msrp:w.msrp??"",collectiblePrice:w.collectiblePrice??"",specialType:w.specialType||"",specialVolumes:w.specialVolumes??"",isbn:w.isbn||"",amazonURL:w.amazonURL||"",hidden:!!w.hidden}),Vs=w=>{const W=Lt(w.title||"").name;if(!W)return"";const G=[...x,...C].map(te=>{const Ne=Lt(te.title||"").name===W,$e=te.msrp??te.MSRP??"",de=String($e).trim();if(!Ne||!de)return null;const Xe=Number(de);return Number.isFinite(Xe)?Xe:null}).filter(te=>te!==null);if(!G.length)return"";const ue=G[0];return G.every(te=>te===ue)?ue:""},Yr=w=>{const W=Lt(w.title||"").name;if(!W)return{demographic:"",genre:"",subGenre:""};const G=[...x,...C].find(ue=>Lt(ue.title||"").name===W&&(ue.demographic||ue.genre||ue.subGenre));return{demographic:(G==null?void 0:G.demographic)||"",genre:(G==null?void 0:G.genre)||"",subGenre:(G==null?void 0:G.subGenre)||""}},Jr=async w=>{if(!s||!(w!=null&&w.id))return;const z=w.kind==="wishlist"?"wishlist":"library",W=z==="library"?"wishlist":"library";try{const F=Ln(w);if(W==="library"){const G=Vs(w);(F.msrp===""||F.msrp===null||F.msrp===void 0)&&(F.msrp=G);const ue=Yr(w);F.demographic||(F.demographic=ue.demographic),F.genre||(F.genre=ue.genre),F.subGenre||(F.subGenre=ue.subGenre)}await Oa(bn(at,W),F),await Ma(Mt(at,z,w.id)),await Promise.all([Nt(),Ot()]),_t(G=>G&&{...G,volumes:G.volumes.filter(ue=>ue.id!==w.id)}),_r()}catch(F){console.error("Move failed",F),alert("Failed to move item.")}},xt=Ce.list==="wishlist",Zn=K.items[K.index]||null,_n=(Zn==null?void 0:Zn.kind)==="wishlist",Wt=j.useMemo(()=>{if(!Zn)return{author:!1,publisher:!1,date:!1,purchaseDate:!1,page:!1,isbn:!1,amountPaid:!1,collectiblePrice:!1,msrp:!1};const w=Zn.data||{},z=Zn.kind==="library",W=z&&w.special&&w.specialType==="collectible",F=z&&!W;return{author:Qt(w.authors),publisher:Qt(w.publisher),date:Qt(w.date),purchaseDate:z?Qt(w.datePurchased):!1,page:Io({pageCount:w.pageCount}),isbn:z?Qt(w.isbn):!1,amountPaid:F?Qt(w.amountPaid):!1,collectiblePrice:W?Qt(w.collectiblePrice):!1,msrp:z?Qt(w.msrp):!1}},[Zn]);return o.jsxs("div",{className:"manga-page",children:[o.jsxs("header",{className:"manga-header",style:{flexDirection:"column",alignItems:"center",textAlign:"center"},children:[o.jsx("div",{className:"manga-header-title",style:{justifyContent:"center",gap:"0.6rem",fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Tyler's Manga Library"}),o.jsx("div",{className:"manga-header-sub",style:{textAlign:"center"},children:"This is my Manga Library and Wishlist. Check and see all the Manga I have in my possession!"})]}),Ct&&o.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"6px"},children:o.jsx("button",{className:"suggestion-trigger",type:"button",onClick:()=>{me(""),ke(!0)},children:"+ Suggestion"})}),o.jsxs("div",{className:"manga-tabs",children:[o.jsx("button",{className:"manga-tab-btn"+(l==="library"?" active":""),onClick:()=>{d("library"),b(!1),re(new Set)},children:"Library"}),o.jsx("button",{className:"manga-tab-btn"+(l==="wishlist"?" active":""),onClick:()=>{d("wishlist"),b(!1),re(new Set)},children:"Wishlist"})]}),l!=="dashboard"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"manga-toolbar",children:[o.jsxs("div",{className:"manga-toolbar-left",children:[o.jsx("input",{type:"text",className:"manga-search-input",placeholder:l==="library"?"Search library by title, author, ISBN...":"Search wishlist...",value:l==="library"?N:M,onChange:w=>l==="library"?A(w.target.value):D(w.target.value)}),o.jsx("div",{className:"manga-counter",children:(()=>{const w=l==="library",z=(w?N:M).trim(),W=w?x.length:C.length,F=w?Zt.length:en.length;return z?`${F} / ${W} Volumes`:`${W} Volumes`})()})]}),o.jsxs("div",{className:"manga-toolbar-right",children:[o.jsxs("div",{className:"manga-view-toggle",children:[o.jsx("button",{className:"manga-btn secondary"+(f==="series"?" active":""),type:"button","aria-pressed":f==="series","aria-label":"Series view",title:"Series View",onClick:()=>yn("series"),children:""}),o.jsx("button",{className:"manga-btn secondary"+(f==="individual"?" active":""),type:"button","aria-pressed":f==="individual","aria-label":"Volume view",title:"Volume View",onClick:()=>yn("individual"),children:""})]}),s&&o.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>_e(w=>!w),children:we?"Hide Hidden":"Show Hidden"}),s&&o.jsx("button",{className:"manga-btn secondary"+(P?" active":""),disabled:f==="series",onClick:Bt,children:P?"Exit Multi-select":"Multi-select"})]})]}),s&&P&&f==="individual"&&o.jsxs("div",{className:"manga-multiselect-bar",children:[o.jsxs("span",{children:["Selected: ",o.jsx("strong",{children:J.size})]}),o.jsx("button",{className:"manga-btn",onClick:qr,children:"Bulk Edit"}),o.jsxs("button",{className:"manga-btn secondary",onClick:()=>Dn("move"),children:["Move to ",l==="library"?"Wishlist":"Library"]}),l==="library"&&o.jsxs(o.Fragment,{children:[o.jsx("button",{className:"manga-btn",onClick:()=>Dn("markRead"),children:"Mark Read"}),o.jsx("button",{className:"manga-btn secondary",onClick:()=>Dn("markUnread"),children:"Mark Unread"})]}),o.jsx("button",{className:"manga-btn danger",onClick:()=>Dn("delete"),children:"Delete"})]})]}),ve?o.jsx("div",{className:"manga-empty-state",children:"Loading manga from Firestore..."}):ie?o.jsx("div",{className:"manga-empty-state",children:ie}):Vn.length===0?o.jsx("div",{className:"manga-empty-state",children:"No manga found. Try changing your search."}):o.jsx("div",{className:"manga-grid",children:Vn.map(w=>f==="series"?hr(w):Ft(w))}),Je&&o.jsx("div",{className:"manga-modal-backdrop visible",onClick:w=>{w.target===w.currentTarget&&ys()},children:o.jsx("div",{className:"manga-modal series",children:o.jsxs("div",{className:"manga-modal-body",children:[o.jsxs("div",{className:"manga-modal-header",children:[o.jsx("div",{className:"manga-modal-title",children:Je.series.title||"Series"}),o.jsx("button",{className:"manga-modal-close",onClick:ys,type:"button","aria-label":"Close",children:"X"})]}),o.jsxs("div",{className:"manga-modal-subtitle",children:[Je.series.count," volume",Je.series.count===1?"":"s"," in this series"]}),s&&o.jsxs("div",{className:"series-bulk-controls",children:[o.jsx("button",{type:"button",className:"manga-btn mini secondary"+(P?" active":""),onClick:()=>jt(Je.volumes),children:P?"Exit Multi-select":"Multi-select"}),P&&o.jsxs(o.Fragment,{children:[o.jsx("button",{type:"button",className:"manga-btn mini secondary",onClick:()=>{const w=Je.volumes.map(z=>z.id);re(new Set(w))},children:"Select All"}),o.jsx("button",{type:"button",className:"manga-btn mini secondary",onClick:()=>{re(new Set)},children:"Clear"}),l==="wishlist"?o.jsx("button",{type:"button",className:"manga-btn mini",disabled:!J.size,onClick:()=>{J.size&&Dn("move","library")},children:"Move to Library"}):o.jsx("button",{type:"button",className:"manga-btn mini",disabled:!J.size,onClick:()=>{J.size&&Dn("move","wishlist")},children:"Move to Wishlist"}),o.jsxs("button",{type:"button",className:"manga-btn mini",disabled:!J.size,onClick:()=>{if(!J.size)return;const w=new Set(Je.volumes.map(z=>z.id));re(z=>new Set([...z].filter(W=>w.has(W)))),qr()},children:["Bulk Edit Selected (",J.size||0,")"]})]})]}),o.jsx("div",{className:"manga-series-modal-grid",children:Je.volumes.map(w=>{const z=Su(w,{includeIsbn:w.kind==="library",includeFinance:w.kind==="library"});return o.jsxs("div",{className:"manga-card mini-card"+(w.read?" read":"")+(s&&Io(w)?" missing-page":"")+(s&&z.any?" missing-meta":""),onClick:()=>{if(!s){Hn(w);return}if(P){In(w.id);return}Hn(w)},children:[o.jsxs("div",{className:"manga-card-cover-wrap",children:[P&&s&&o.jsx("div",{className:"mini-select-indicator"+(J.has(w.id)?" selected":""),children:J.has(w.id)?"X":""}),o.jsx("img",{src:w.cover||"https://imgur.com/chUgq4W.png",alt:w.title||"Cover",loading:"lazy",decoding:"async"})]}),o.jsxs("div",{className:"manga-card-body",children:[o.jsx("div",{className:"manga-card-title",children:w.title||"Untitled"}),o.jsxs("div",{className:"manga-card-meta",children:[o.jsx("span",{className:z.authorMissing?"missing-field":"",children:w.authors&&w.authors!=="Unknown"?w.authors:"Missing author"}),o.jsx("br",{}),o.jsx("span",{className:z.publisherMissing?"missing-field":"",children:w.publisher&&w.publisher!=="Unknown"?w.publisher:"Missing publisher"}),o.jsx("br",{}),o.jsx("span",{className:z.dateMissing?"missing-field":"",children:w.date&&w.date!=="Unknown"?w.date:"Missing date"})]}),w.isbn?o.jsxs("div",{className:"manga-card-isbn",children:["ISBN: ",w.isbn]}):w.kind==="library"&&z.isbnMissing&&o.jsx("div",{className:"manga-card-isbn missing-field",children:"Missing ISBN"})]})]},w.id)})})]})})}),s&&o.jsxs("div",{className:"manga-floating-actions",children:[o.jsxs("button",{className:"manga-btn",type:"button","aria-label":"Add item",onClick:()=>un(l==="wishlist"?"wishlist":"library"),children:["+ ",l==="wishlist"?"Wishlist":"Library"]}),o.jsxs("div",{className:"manga-export-actions",children:[n&&o.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>Qr({library:x,wishlist:C},"manga-library-wishlist.json"),children:"Export JSON"}),o.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>ei(l==="library"?x:C,l==="library"?"manga-library.csv":"manga-wishlist.csv"),children:"Export CSV"}),o.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>Ds(l==="library"?x:C,l==="library"?"manga-library-images.zip":"manga-wishlist-images.zip"),children:"Download Images"})]})]}),ge&&o.jsx("div",{className:"manga-modal-backdrop visible",onClick:w=>{w.target===w.currentTarget&&_r()},children:o.jsxs("div",{className:"manga-modal",children:[o.jsxs("div",{className:"manga-modal-cover-wrap",children:[ge.kind==="library"&&ge.read&&o.jsx("div",{className:"manga-modal-read-pill",children:"Read"}),o.jsx("img",{src:ge.cover||"https://imgur.com/chUgq4W.png",alt:"Cover"})]}),o.jsxs("div",{className:"manga-modal-body",children:[o.jsxs("div",{className:"manga-modal-header",children:[o.jsx("div",{className:"manga-modal-title",children:ge.title||"Untitled"}),o.jsx("button",{className:"manga-modal-close",onClick:_r,type:"button","aria-label":"Close",children:"X"})]}),o.jsxs("div",{className:"manga-modal-meta",children:[ge.authors&&ge.authors!=="Unknown"&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"Author(s):"})," ",ge.authors,o.jsx("br",{})]}),ge.publisher&&ge.publisher!=="Unknown"&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"Publisher:"})," ",ge.publisher,o.jsx("br",{})]}),ge.date&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"Release:"})," ",ge.date,o.jsx("br",{})]}),ge.isbn&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"ISBN:"})," ",ge.isbn,o.jsx("br",{})]})]}),o.jsxs("div",{className:"manga-modal-details",children:[ge.pageCount&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"Pages:"})," ",ge.pageCount,o.jsx("br",{})]}),o.jsxs("div",{style:{margin:"6px 0"},children:[o.jsx("strong",{children:"Rating:"})," ",o.jsx(Kr,{value:ge.rating||"",onChange:s?w=>Xs(ge,w):void 0,interactive:s})]}),ge.amountPaid&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"Amount Paid:"})," $",ge.amountPaid,o.jsx("br",{})]}),ge.msrp&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"MSRP:"})," $",ge.msrp,o.jsx("br",{})]}),ge.collectiblePrice&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"Collectible:"})," $",ge.collectiblePrice,o.jsx("br",{})]}),ge.read&&ge.dateRead&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"Date Read:"})," ",ge.dateRead,o.jsx("br",{})]}),ge.amazonURL&&o.jsx("div",{style:{marginTop:"6px"},children:o.jsx("a",{href:ge.amazonURL,target:"_blank",rel:"noreferrer",children:"View on Amazon"})})]}),o.jsxs("div",{className:"manga-modal-footer",style:{gap:"10px",alignItems:"center"},children:[o.jsx("div",{children:ge.kind==="library"&&ge.read?"Marked as read in your library.":ge.kind==="library"?"In your library (unread).":"Wishlist item - not in library yet."}),o.jsxs("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:[s&&o.jsx("button",{className:"manga-btn mini secondary",type:"button",onClick:()=>vs(ge),children:"Edit"}),ge.kind==="library"&&s&&o.jsx(o.Fragment,{children:ge.read?o.jsx("button",{className:"manga-btn mini secondary",disabled:Wr,onClick:()=>dr(ge,!1),type:"button",children:"Mark as unread"}):o.jsx("button",{className:"manga-btn mini",disabled:Wr,onClick:()=>dr(ge,!0),type:"button",children:"Mark as read"})}),s&&o.jsxs("button",{className:"manga-btn mini",type:"button",onClick:()=>Jr(ge),children:["Move to ",ge.kind==="library"?"Wishlist":"Library"]}),s&&o.jsx("button",{className:"manga-btn mini danger",type:"button",onClick:()=>Nn(ge.id,ge.kind==="library"?"library":"wishlist"),children:"Delete"})]})]})]})]})}),s&&Ce.open&&o.jsx("div",{className:"manga-modal-backdrop visible",onClick:w=>{w.target===w.currentTarget&&Kn()},children:o.jsx("div",{className:"manga-modal admin",children:o.jsxs("div",{className:"manga-modal-body",children:[o.jsxs("div",{className:"manga-modal-header",children:[o.jsx("div",{className:"manga-modal-title",children:Ce.mode==="add"?"Add Entry":"Edit Entry"}),o.jsx("button",{className:"manga-modal-close",onClick:Kn,type:"button","aria-label":"Close",children:"X"})]}),o.jsxs("div",{className:"admin-form-layout",children:[o.jsx("div",{className:"admin-cover-frame",children:o.jsx("img",{src:Ce.data.cover||"https://imgur.com/chUgq4W.png",alt:"Cover preview"})}),o.jsxs("div",{className:"admin-form-fields",children:[o.jsx("div",{className:"admin-row",children:o.jsxs("label",{children:["Title",o.jsx("input",{type:"text",value:Ce.data.title,onChange:w=>mt("title",w.target.value)})]})}),U.length>0&&o.jsx("div",{className:"title-suggestions",children:U.map((w,z)=>o.jsx("button",{type:"button",className:"manga-btn mini",onClick:()=>mt("title",w),children:w},w+z))}),o.jsxs("div",{className:"admin-row two",style:{alignItems:"flex-end",marginTop:"-8px"},children:[o.jsxs("div",{children:[o.jsxs("div",{className:"manga-modal-subtitle",style:{marginBottom:"6px"},children:["Entry ",xe+1," / ",Math.max(1,le.length||1)]}),o.jsxs("div",{style:{display:"flex",gap:"8px"},children:[o.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>xe>0&&wr(xe-1),disabled:xe===0,children:"Previous"}),o.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>le.length&&xe<le.length-1?wr(xe+1):null,disabled:!le.length||xe===le.length-1,children:"Next"})]})]}),o.jsxs("div",{style:{textAlign:"right"},children:[o.jsx("button",{className:"manga-btn",type:"button",onClick:Br,disabled:!Lt(Ce.data.title||"").vol,children:"Add New Volume"}),o.jsx("div",{className:"manga-stat-sub",style:{marginTop:"4px"},children:"Auto-fills the next volume number for this series."})]})]}),o.jsx("div",{className:"admin-row",children:o.jsxs("label",{className:k.author?"missing-field-input":"",children:["Authors",o.jsx("input",{type:"text",value:Ce.data.authors,onChange:w=>mt("authors",w.target.value)})]})}),o.jsx("div",{className:"admin-row",children:o.jsxs("label",{className:k.publisher?"missing-field-input":"",children:["Publisher",o.jsx("input",{type:"text",value:Ce.data.publisher,onChange:w=>mt("publisher",w.target.value)})]})}),o.jsxs("div",{className:"admin-row three",children:[o.jsxs("label",{className:k.date?"missing-field-input":"",children:["Release Date",o.jsx("input",{type:"date",value:Ce.data.date,onChange:w=>mt("date",w.target.value)})]}),o.jsxs("label",{className:k.purchaseDate?"missing-field-input":"",children:["Purchase Date",o.jsx("input",{type:"date",value:Ce.data.datePurchased,onChange:w=>mt("datePurchased",w.target.value)})]}),!xt&&o.jsxs("label",{children:["Date Read",o.jsx("input",{type:"date",value:Ce.data.dateRead,onChange:w=>mt("dateRead",w.target.value)})]})]}),o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{className:k.page?"missing-field-input":"",children:["Page Count",o.jsx("input",{type:"number",placeholder:"e.g. 192",value:Ce.data.pageCount,onChange:w=>mt("pageCount",w.target.value)})]}),!xt&&o.jsxs("label",{className:k.isbn?"missing-field-input":"",children:["ISBN (library only)",o.jsx("input",{type:"text",value:Ce.data.isbn,onChange:w=>mt("isbn",w.target.value)})]})]}),o.jsx("div",{className:"admin-row",children:o.jsxs("label",{children:["Cover URL",o.jsx("input",{type:"text",placeholder:"Paste image URL here",value:Ce.data.cover,onChange:w=>mt("cover",w.target.value)})]})}),!xt&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"admin-row two",children:[!(Ce.data.special&&Ce.data.specialType==="collectible")&&o.jsxs("label",{className:k.amountPaid?"missing-field-input":"",children:["Amount Paid",o.jsx("input",{type:"number",step:"0.01",value:Ce.data.amountPaid,onChange:w=>mt("amountPaid",w.target.value)})]}),o.jsxs("label",{className:k.msrp?"missing-field-input":"",children:["MSRP",o.jsx("input",{type:"number",step:"0.01",value:Ce.data.msrp,onChange:w=>mt("msrp",w.target.value)})]})]}),o.jsx("div",{className:"admin-row",children:o.jsxs("label",{className:"checkbox-row",children:[o.jsx("input",{type:"checkbox",checked:!!Ce.data.special,onChange:w=>mt("special",w.target.checked,"checkbox")}),o.jsx("span",{children:"Special item?"})]})}),Ce.data.special&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{children:["Special Type",o.jsxs("select",{value:Ce.data.specialType,onChange:w=>mt("specialType",w.target.value),children:[o.jsx("option",{value:"",children:"Select type"}),o.jsx("option",{value:"specialEdition",children:"Special Edition"}),o.jsx("option",{value:"collectible",children:"Collectible"})]})]}),Ce.data.specialType==="collectible"&&o.jsxs("label",{className:k.collectiblePrice?"missing-field-input":"",children:["Collectible Price",o.jsx("input",{type:"number",step:"0.01",value:Ce.data.collectiblePrice,onChange:w=>mt("collectiblePrice",w.target.value)})]})]}),Ce.data.specialType==="specialEdition"&&o.jsx("div",{className:"admin-row",children:o.jsxs("label",{children:["Special Volumes",o.jsx("input",{type:"number",min:"0",value:Ce.data.specialVolumes,onChange:w=>mt("specialVolumes",w.target.value)})]})})]})]}),xt&&o.jsx("div",{className:"admin-row",children:o.jsxs("label",{children:["Amazon URL",o.jsx("input",{type:"text",value:Ce.data.amazonURL,onChange:w=>mt("amazonURL",w.target.value)})]})}),!xt&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"admin-row",children:o.jsxs("label",{children:["Rating (1-5 stars)",o.jsx(Kr,{value:Ce.data.rating,onChange:w=>mt("rating",w)})]})}),o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{className:"checkbox-inline",children:[o.jsx("input",{type:"checkbox",checked:Ce.data.read,onChange:w=>mt("read",w.target.checked,"checkbox")}),o.jsx("span",{children:"Mark as read"})]}),o.jsxs("label",{className:"checkbox-inline",children:[o.jsx("input",{type:"checkbox",checked:!!Ce.data.hidden,onChange:w=>mt("hidden",w.target.checked,"checkbox")}),o.jsx("span",{children:"Hide from public"})]})]})]}),xt&&o.jsx("div",{className:"admin-row",children:o.jsxs("label",{className:"checkbox-inline",children:[o.jsx("input",{type:"checkbox",checked:!!Ce.data.hidden,onChange:w=>mt("hidden",w.target.checked,"checkbox")}),o.jsx("span",{children:"Hide from public"})]})})]})]}),o.jsxs("div",{className:"manga-modal-footer",style:{justifyContent:"flex-end",gap:"10px"},children:[o.jsx("button",{className:"manga-btn secondary",onClick:Kn,type:"button",children:"Cancel"}),o.jsx("button",{className:"manga-btn",onClick:Qn,type:"button",children:Ce.mode==="add"?"Add":"Save"})]})]})})}),s&&K.open&&o.jsx("div",{className:"manga-modal-backdrop visible",onClick:w=>{w.target===w.currentTarget&&Yn()},children:o.jsx("div",{className:"manga-modal admin",children:o.jsxs("div",{className:"manga-modal-body",children:[o.jsxs("div",{className:"manga-modal-header",children:[o.jsxs("div",{className:"manga-modal-title",children:["Bulk Edit (",K.index+1," / ",K.items.length,")"]}),o.jsx("button",{className:"manga-modal-close",onClick:Yn,type:"button","aria-label":"Close",children:"X"})]}),K.items.length>0&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"manga-modal-subtitle",children:["Editing: ",K.items[K.index].data.title||"Untitled"]}),o.jsxs("div",{className:"admin-form-grid two-col",children:[o.jsx("div",{className:"admin-cover",children:o.jsx("div",{className:"manga-card-cover-wrap",children:o.jsx("img",{src:K.items[K.index].data.cover||"https://imgur.com/chUgq4W.png",alt:K.items[K.index].data.title||"Cover",loading:"lazy",decoding:"async"})})}),o.jsxs("div",{className:"admin-fields",children:[o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{className:"full",children:["Title",o.jsx("input",{type:"text",value:K.items[K.index].data.title,onChange:w=>st("title",w.target.value)})]}),o.jsxs("div",{className:"admin-entry-info",children:["Entry ",K.index+1," / ",K.items.length]})]}),o.jsx("div",{className:"admin-row",children:o.jsxs("label",{className:Wt.author?"missing-field-input":"",children:["Authors",o.jsx("input",{type:"text",value:K.items[K.index].data.authors,onChange:w=>st("authors",w.target.value)})]})}),o.jsx("div",{className:"admin-row",children:o.jsxs("label",{className:Wt.publisher?"missing-field-input":"",children:["Publisher",o.jsx("input",{type:"text",value:K.items[K.index].data.publisher,onChange:w=>st("publisher",w.target.value)})]})}),o.jsxs("div",{className:"admin-row three",children:[o.jsxs("label",{className:Wt.date?"missing-field-input":"",children:["Release Date",o.jsx("input",{type:"date",value:K.items[K.index].data.date,onChange:w=>st("date",w.target.value)})]}),o.jsxs("label",{className:Wt.purchaseDate?"missing-field-input":"",children:["Purchase Date",o.jsx("input",{type:"date",value:K.items[K.index].data.datePurchased,onChange:w=>st("datePurchased",w.target.value)})]}),!_n&&o.jsxs("label",{children:["Date Read",o.jsx("input",{type:"date",value:K.items[K.index].data.dateRead,onChange:w=>st("dateRead",w.target.value)})]})]}),o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{className:Wt.page?"missing-field-input":"",children:["Page Count",o.jsx("input",{type:"number",value:K.items[K.index].data.pageCount,onChange:w=>st("pageCount",w.target.value)})]}),!_n&&o.jsxs("label",{className:Wt.isbn?"missing-field-input":"",children:["ISBN (library only)",o.jsx("input",{type:"text",value:K.items[K.index].data.isbn,onChange:w=>st("isbn",w.target.value)})]})]}),o.jsx("div",{className:"admin-row",children:o.jsxs("label",{children:["Cover URL",o.jsx("input",{type:"text",value:K.items[K.index].data.cover,onChange:w=>st("cover",w.target.value)})]})}),!_n&&o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{className:Wt.amountPaid?"missing-field-input":"",children:["Amount Paid",o.jsx("input",{type:"number",step:"0.01",value:K.items[K.index].data.amountPaid,onChange:w=>st("amountPaid",w.target.value)})]}),o.jsxs("label",{className:Wt.msrp?"missing-field-input":"",children:["MSRP",o.jsx("input",{type:"number",step:"0.01",value:K.items[K.index].data.msrp,onChange:w=>st("msrp",w.target.value)})]})]}),!_n&&o.jsx("div",{className:"admin-row two",children:o.jsxs("div",{children:[o.jsx("div",{className:"star-label",children:"Rating (1-5 stars)"}),o.jsx(Kr,{value:K.items[K.index].data.rating,onChange:w=>st("rating",w)})]})}),!_n&&o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{className:"checkbox-row",children:[o.jsx("input",{type:"checkbox",checked:!!K.items[K.index].data.special,onChange:w=>st("special",w.target.checked,"checkbox")}),o.jsx("span",{children:"Special item?"})]}),o.jsxs("label",{className:"checkbox-row",children:[o.jsx("input",{type:"checkbox",checked:K.items[K.index].data.read,onChange:w=>st("read",w.target.checked,"checkbox")}),o.jsx("span",{children:"Mark as read"})]})]}),K.items[K.index].data.special&&!_n&&o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{children:["Special Type",o.jsxs("select",{value:K.items[K.index].data.specialType,onChange:w=>st("specialType",w.target.value),children:[o.jsx("option",{value:"",children:"Select type"}),o.jsx("option",{value:"specialEdition",children:"Special Edition"}),o.jsx("option",{value:"collectible",children:"Collectible"})]})]}),K.items[K.index].data.specialType==="specialEdition"&&o.jsxs("label",{children:["Special Volumes",o.jsx("input",{type:"number",value:K.items[K.index].data.specialVolumes,onChange:w=>st("specialVolumes",w.target.value)})]}),K.items[K.index].data.specialType==="collectible"&&o.jsxs("label",{className:Wt.collectiblePrice?"missing-field-input":"",children:["Collectible Price",o.jsx("input",{type:"number",step:"0.01",value:K.items[K.index].data.collectiblePrice,onChange:w=>st("collectiblePrice",w.target.value)})]})]}),_n&&o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{children:["Amazon URL",o.jsx("input",{type:"text",value:K.items[K.index].data.amazonURL,onChange:w=>st("amazonURL",w.target.value)})]}),o.jsxs("label",{className:"checkbox-row",children:[o.jsx("input",{type:"checkbox",checked:!!K.items[K.index].data.hidden,onChange:w=>st("hidden",w.target.checked,"checkbox")}),o.jsx("span",{children:"Hidden from public"})]})]}),!_n&&o.jsx("div",{className:"admin-row",children:o.jsxs("label",{className:"checkbox-row",children:[o.jsx("input",{type:"checkbox",checked:!!K.items[K.index].data.hidden,onChange:w=>st("hidden",w.target.checked,"checkbox")}),o.jsx("span",{children:"Hidden from public"})]})})]})]}),o.jsxs("div",{className:"manga-modal-footer",style:{justifyContent:"space-between",gap:"10px"},children:[o.jsxs("div",{children:[o.jsx("button",{className:"manga-btn secondary",onClick:vn,type:"button",disabled:K.index===0,children:"Previous"}),o.jsx("button",{className:"manga-btn secondary",onClick:ks,type:"button",disabled:K.index===K.items.length-1,style:{marginLeft:"6px"},children:"Next"})]}),o.jsxs("div",{style:{display:"flex",gap:"8px"},children:[o.jsx("button",{className:"manga-btn secondary",onClick:Yn,type:"button",children:"Cancel"}),o.jsx("button",{className:"manga-btn",onClick:_s,type:"button",children:"Save Edits"})]})]})]})]})})}),Ct&&o.jsx(pw,{open:De,title:"Suggest a Manga",placeholder:"Type a manga you'd like me to collect/read...",value:Oe,status:nt,loading:ce,onChange:Qe,onSubmit:y,onClose:()=>ke(!1)}),o.jsx("datalist",{id:"adminTitleSuggestions",children:X.map(w=>o.jsx("option",{value:w},w))})]})}const pR="https://imokmalworker.imokissick.workers.dev/?url=",yw="im_ok",__=300,mR={1:"watching",2:"completed",3:"on_hold",4:"dropped",6:"plan_to_watch"};function gR(n){const e=n==null?void 0:n.title_localized,t=typeof e=="string"?e:(e==null?void 0:e.en)||(e==null?void 0:e.english);return(n==null?void 0:n.anime_title_eng)||(n==null?void 0:n.title_english)||t||(n==null?void 0:n.anime_title)||(n==null?void 0:n.title)||"Untitled"}function yR(n){const e=(n==null?void 0:n.updated_at)??(n==null?void 0:n.updatedAt)??(n==null?void 0:n.updated_at_ms)??null;if(e==null)return null;const t=Number(e);if(Number.isFinite(t))return t<1e12?t*1e3:t;const s=Date.parse(e);return Number.isNaN(s)?null:s}function vR(n){const e=mR[n.status]||(typeof n.status=="string"?n.status.toLowerCase():"unknown");return{id:n.anime_id||n.id,title:gR(n),updatedAt:yR(n),episodes:n.anime_num_episodes??n.episodes??null,watchedEpisodes:n.num_watched_episodes??n.my_watched_episodes??n.watched_episodes??n.num_watched??0,status:e,score:n.score??null,image:n.anime_image_path||n.image_url||n.anime_img||n.picture||null,synopsis:n.anime_synopsis||n.synopsis||null}}function x_(){const n=Date.now();return[{id:1,title:"Cowboy Bebop",episodes:26,status:"completed",score:10,updatedAt:n-1e3*60*60*24*3,synopsis:"In 2071, bounty hunters Spike and Jet roam the solar system looking for their next payout and a place to belong."},{id:2,title:"Fullmetal Alchemist: Brotherhood",episodes:64,status:"completed",score:10,updatedAt:n-1e3*60*60*24*6,synopsis:"Brothers Edward and Alphonse Elric search for the Philosopher's Stone to restore their bodies after a failed alchemy ritual."},{id:3,title:"Frieren: Beyond Journey's End",episodes:28,status:"watching",score:9,updatedAt:n-1e3*60*60*8,synopsis:"An elven mage retraces the steps of a past adventure to understand humanity and the passage of time."},{id:4,title:"One Piece",episodes:1e3,status:"on_hold",score:8,updatedAt:n-1e3*60*60*24*14,synopsis:"Monkey D. Luffy sails toward the Grand Line seeking the One Piece and a crew to make his dream real."},{id:5,title:"Kaiju No. 8",episodes:12,status:"plan_to_watch",score:null,updatedAt:n-1e3*60*30,synopsis:"A middle-aged worker gains kaiju powers and joins the Defense Force to fight monsters from the inside."}]}async function _R(n,e){const t=`https://myanimelist.net/animelist/${n}/load.json?status=7&offset=${e}`,s=await fetch(`${pR}${encodeURIComponent(t)}`);if(!s.ok)throw new Error(`Failed to fetch MAL list (offset ${e})`);return s.json()}async function xR(n=yw){const e=[];try{let t=0;for(;;){const s=await _R(n,t);if(!Array.isArray(s)||s.length===0||(e.push(...s),s.length<__))break;t+=__}}catch(t){return console.error("Failed to load MAL list; falling back to sample data.",t),x_()}return e.length?e.map(vR):x_()}async function wR(n){var e,t;if(!n)return null;try{const s=await fetch(`https://api.jikan.moe/v4/anime/${n}`);if(!s.ok)throw new Error(`Failed to fetch Jikan summary for id ${n}`);const a=await s.json();return((e=a==null?void 0:a.data)==null?void 0:e.synopsis)||((t=a==null?void 0:a.data)==null?void 0:t.background)||null}catch(s){return console.error("Failed to load anime synopsis",n,s),null}}async function ER(n=yw){var e;if(!n)return null;try{const t=await fetch(`https://api.jikan.moe/v4/users/${encodeURIComponent(n)}/statistics`);if(!t.ok)throw new Error(`Failed to fetch user stats for ${n}`);const s=await t.json(),a=((e=s==null?void 0:s.data)==null?void 0:e.anime)||{},l=Number(a.days_watched),d=Number(a.total_episodes??a.episodes_watched);return{daysWatched:Number.isFinite(l)?l:null,episodesWatched:Number.isFinite(d)?d:null}}catch(t){return console.error("Failed to load user stats",n,t),null}}const w_=5,TR=3600*1e3,E_="animeSuggestionsSent";function SR(){const{admin:n,user:e,role:t}=Qa(),s=ce=>ce?ce.toString().replace(/_/g," ").replace(/\b\w/g,Le=>Le.toUpperCase()):"Unknown",[a,l]=j.useState([]),[d,f]=j.useState([]),[m,y]=j.useState(""),[x,E]=j.useState("all"),[C,O]=j.useState(!0),[X,B]=j.useState(""),[U,se]=j.useState(null),[we,_e]=j.useState({}),[ve,L]=j.useState(!1),[ie,I]=j.useState(!1),[N,A]=j.useState(null),[M,D]=j.useState(!1),[P,b]=j.useState(""),[J,re]=j.useState(""),[Ce,fe]=j.useState(!1);j.useEffect(()=>{document.title="Anime | Library"},[]),j.useEffect(()=>{re("")},[e]);const le=ce=>{if(!ce)return"";const Le=Date.now()-ce,ge=Math.max(Le,0),He=Math.floor(ge/6e4);if(He<1)return"just now";if(He<60)return`${He}m ago`;const Je=Math.floor(He/60);if(Je<48)return`${Je}h ago`;const _t=Math.floor(Je/24);if(_t<14)return`${_t}d ago`;const Ct=Math.floor(_t/7);return Ct<8?`${Ct}w ago`:`${Math.floor(_t/30)}mo ago`},Pe=(ce,Le="image")=>(ce||"").toString().toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"").slice(0,80)||Le,xe=async()=>{const ce=a.filter(Le=>Le.image).map((Le,ge)=>({url:Le.image,name:Pe(Le.title||`anime-${ge+1}`,`anime-${ge+1}`)}));if(!ce.length){alert("No images found to download.");return}try{const Le=(await gc(async()=>{const{default:Ot}=await import("https://cdn.jsdelivr.net/npm/jszip@3.10.1/+esm");return{default:Ot}},[])).default,ge=new Le,He=ge.folder("images"),Je={};await Promise.all(ce.map(async(Ot,Zt)=>{try{const en=await(await fetch(Ot.url)).blob(),qn=(Ot.url.split(".").pop()||"jpg").split(/[?#]/)[0],yn=Ot.name||`image-${Zt+1}`;Je[yn]=(Je[yn]||0)+1;const cr=Je[yn]>1?`-${Je[yn]}`:"";He.file(`${yn}${cr}.${qn}`,en)}catch(sn){console.warn("Failed to fetch image",Ot.url,sn)}}));const _t=await ge.generateAsync({type:"blob"}),Ct=URL.createObjectURL(_t),Nt=document.createElement("a");Nt.href=Ct,Nt.download="anime-images.zip",Nt.click(),URL.revokeObjectURL(Ct)}catch(Le){console.error("Zip download failed",Le),alert("Failed to create zip. Please try again.")}};j.useEffect(()=>{async function ce(){try{const Le=await xR();l(Le),f(Le)}catch(Le){console.error(Le),B("Failed to load data from MAL.")}finally{O(!1)}}ce()},[]),j.useEffect(()=>{ER().then(ce=>{ce&&A(ce)}).catch(()=>{})},[]);const Y=ce=>{switch((ce||"unknown").toLowerCase()){case"watching":return 0;case"completed":return 1;case"on_hold":return 2;case"plan_to_watch":return 3;case"dropped":return 4;default:return 5}},k=ce=>{const Le=Number.isFinite(Number(ce.watchedEpisodes))?Number(ce.watchedEpisodes):0,ge=Number.isFinite(Number(ce.episodes))?Number(ce.episodes):null;return ge?`${Math.min(Le,ge)}/${ge} eps`:Le?`${Le} eps`:"No progress"};j.useEffect(()=>{let ce=[...a];if(x!=="all"&&(ce=ce.filter(Le=>(Le.status||"").toLowerCase()===x)),m){const Le=m.toLowerCase();ce=ce.filter(ge=>(ge.title||"").toLowerCase().includes(Le))}ce.sort((Le,ge)=>{const He=Y(Le.status),Je=Y(ge.status);return He!==Je?He-Je:(Le.title||"").localeCompare(ge.title||"")}),f(ce)},[a,x,m]);const K=j.useMemo(()=>[...a].filter(ce=>Number.isFinite(ce.updatedAt)).sort((ce,Le)=>Le.updatedAt-ce.updatedAt).slice(0,6),[a]),Te=!!e&&t==="viewer",De=async()=>{const ce=Date.now(),ge=(()=>{try{const He=localStorage.getItem(E_);return Array.isArray(JSON.parse(He))?JSON.parse(He):[]}catch{return[]}})().filter(He=>ce-He<TR);if(ge.length>=w_){re("Rate limit: please wait a bit (max 5 suggestions per hour).");return}if(!P.trim()){re("Please enter a title or note before sending.");return}fe(!0),re("");try{const He=`**Anime Suggestion**
${P.trim()}
From: ${(e==null?void 0:e.displayName)||(e==null?void 0:e.email)||(e==null?void 0:e.uid)||"anonymous user"}`;await Oa(bn(at,"suggestions"),{content:P.trim(),type:"anime",from:(e==null?void 0:e.displayName)||(e==null?void 0:e.email)||(e==null?void 0:e.uid)||"anonymous user",createdAt:new Date().toISOString()}),re("Sent! I'll review your suggestion soon."),b("");const Je=[...ge,ce].slice(-w_);localStorage.setItem(E_,JSON.stringify(Je))}catch(He){console.error("Failed to send suggestion",He),re("Failed to send suggestion. Please try again later.")}finally{fe(!1)}};j.useEffect(()=>{if(!U){I(!1),L(!1);return}I(!!U.synopsis),L(!1)},[U==null?void 0:U.id]);const ke=j.useMemo(()=>{const ce=a.length,Le=a.reduce((Ct,Nt)=>{const Ot=Number(Nt.watchedEpisodes);return Number.isFinite(Ot)?Ct+Ot:Ct},0),ge=Le*.4,He=a.filter(Ct=>Number.isFinite(Ct.score)&&Ct.score>0),Je=He.reduce((Ct,Nt)=>Ct+Nt.score,0),_t={watching:0,completed:0,on_hold:0,dropped:0,plan_to_watch:0,unknown:0};return a.forEach(Ct=>{const Nt=(Ct.status||"unknown").toLowerCase();_t[Nt]!=null?_t[Nt]+=1:_t.unknown+=1}),{total:ce,totalWatchedEpisodes:Le,byStatus:_t,avgScore:He.length?Je/He.length:0,totalHours:ge}},[a]),Oe=(N==null?void 0:N.daysWatched)??(ke.totalHours||0)/24,Qe=(N==null?void 0:N.episodesWatched)??ke.totalWatchedEpisodes,nt=ce=>{const Le=ce.image||"https://imgur.com/chUgq4W.png",ge=Number.isFinite(Number(ce.watchedEpisodes))?Number(ce.watchedEpisodes):0,He=Number.isFinite(Number(ce.episodes))?Number(ce.episodes):null,Je=He?`Episode ${Math.min(ge,He)}/${He}`:`Episode ${ge}`,_t=Number.isFinite(Number(ce.score))&&Number(ce.score)>0?ce.score:"Not rated";return o.jsxs("article",{className:"anime-card",onClick:()=>se(ce.synopsis?ce:{...ce,synopsis:we[ce.id]}),children:[o.jsxs("div",{className:"anime-cover-wrap",children:[o.jsx("img",{className:"anime-cover",src:Le,alt:ce.title,loading:"lazy",decoding:"async"}),o.jsx("div",{className:`badge-status ${(ce.status||"unknown").toLowerCase()}`,children:s(ce.status)}),ce.score!=null&&o.jsx("div",{className:"badge-score",children:_t})]}),o.jsxs("div",{className:"anime-meta",children:[o.jsx("div",{className:"anime-title",title:ce.title,children:ce.title}),o.jsx("div",{className:"anime-sub",children:ce.episodes?`${ce.episodes} episodes`:"Episodes: ?"}),o.jsx("div",{className:"anime-progress",children:Je}),o.jsxs("div",{className:"anime-progress",children:["Status: ",s(ce.status)]})]})]},ce.id||ce.title)},me=ce=>o.jsxs("article",{className:"anime-update-card",children:[o.jsx("div",{className:"anime-update-title",title:ce.title,children:ce.title}),o.jsxs("div",{className:"anime-update-meta",children:[o.jsx("span",{className:"anime-update-progress",children:k(ce)}),o.jsx("span",{className:"anime-update-dot","aria-hidden":"true",children:""}),o.jsx("span",{className:"anime-update-status",children:s(ce.status)})]}),o.jsx("div",{className:"anime-update-time",children:le(ce.updatedAt)})]},`update-${ce.id||ce.title}`);return o.jsxs("main",{className:"anime-page",children:[o.jsxs("div",{className:"anime-content",children:[o.jsxs("header",{className:"anime-header",style:{position:"relative",display:"flex",justifyContent:"center",alignItems:"center",textAlign:"center",width:"100%"},children:[o.jsxs("div",{style:{textAlign:"center",margin:"0 auto",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"0 60px"},children:[o.jsx("h1",{className:"anime-title",style:{margin:0,fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Tyler's Anime Library"}),o.jsx("p",{className:"anime-sub",style:{textAlign:"center",margin:"6px 0 0"},children:"The Anime I've watched/watching synced directly from MAL (MyAnimeList)"})]}),(Te||n)&&o.jsxs("div",{style:{position:"absolute",right:0,top:"50%",transform:"translateY(-50%)",display:"flex",gap:"10px"},children:[Te&&o.jsx("button",{className:"suggestion-trigger",type:"button",onClick:()=>{re(""),D(!0)},children:"+ Suggestion"}),n&&o.jsx("button",{className:"stat-link",type:"button",onClick:xe,children:"Download Images"})]})]}),o.jsxs("div",{className:"anime-stats",children:[o.jsxs("div",{className:"anime-stat-card",children:[o.jsx("div",{className:"anime-stat-label",children:"Total Entries"}),o.jsx("div",{className:"anime-stat-value",children:ke.total})]}),o.jsxs("div",{className:"anime-stat-card",children:[o.jsx("div",{className:"anime-stat-label",children:"Episodes Watched"}),o.jsx("div",{className:"anime-stat-value",children:Qe})]}),o.jsxs("div",{className:"anime-stat-card",children:[o.jsx("div",{className:"anime-stat-label",children:"Watching"}),o.jsx("div",{className:"anime-stat-value",children:ke.byStatus.watching})]}),o.jsxs("div",{className:"anime-stat-card",children:[o.jsx("div",{className:"anime-stat-label",children:"Completed"}),o.jsx("div",{className:"anime-stat-value",children:ke.byStatus.completed})]}),o.jsxs("div",{className:"anime-stat-card",children:[o.jsx("div",{className:"anime-stat-label",children:"Plan to Watch"}),o.jsx("div",{className:"anime-stat-value",children:ke.byStatus.plan_to_watch})]}),o.jsxs("div",{className:"anime-stat-card",children:[o.jsx("div",{className:"anime-stat-label",children:"Avg. Score"}),o.jsx("div",{className:"anime-stat-value",children:ke.avgScore?ke.avgScore.toFixed(1):"0.0"})]}),o.jsxs("div",{className:"anime-stat-card",children:[o.jsx("div",{className:"anime-stat-label",children:"Days Watched"}),o.jsx("div",{className:"anime-stat-value",children:Oe.toFixed(1)})]})]}),o.jsxs("section",{className:"anime-toolbar",children:[o.jsx("input",{type:"text",placeholder:"Search anime by title...",value:m,onChange:ce=>y(ce.target.value),className:"anime-input"}),o.jsxs("select",{value:x,onChange:ce=>E(ce.target.value),className:"anime-select",children:[o.jsx("option",{value:"all",children:"All statuses"}),o.jsx("option",{value:"watching",children:"Watching"}),o.jsx("option",{value:"completed",children:"Completed"}),o.jsx("option",{value:"on_hold",children:"On Hold"}),o.jsx("option",{value:"plan_to_watch",children:"Plan to Watch"}),o.jsx("option",{value:"dropped",children:"Dropped"})]})]}),C&&o.jsx("div",{className:"loading",children:"Loading anime list from MAL..."}),X&&o.jsx("div",{className:"error-state",children:X}),!C&&!X&&o.jsx(o.Fragment,{children:d.length===0?o.jsx("div",{className:"empty-state",children:"No results match your filters yet."}):o.jsx("section",{className:"anime-grid",children:d.map(ce=>nt(ce))})})]}),K.length>0&&o.jsxs("aside",{className:"anime-updates-float",children:[o.jsxs("div",{className:"anime-updates-header",children:[o.jsx("h3",{children:"Recent Updates"}),o.jsx("span",{className:"anime-updates-caption",children:"Last list activity"})]}),o.jsx("div",{className:"anime-updates-list",children:K.map(ce=>me(ce))})]}),Te&&o.jsx(pw,{open:M,title:"Suggest an Anime",placeholder:"Type an anime you'd like me to watch...",value:P,status:J,loading:Ce,onChange:b,onSubmit:De,onClose:()=>D(!1)}),U&&o.jsx("div",{className:"modal-backdrop visible",onClick:ce=>{ce.target===ce.currentTarget&&se(null)},children:o.jsxs("div",{className:"anime-modal",children:[o.jsxs("div",{className:"anime-modal-header",children:[o.jsx("h2",{style:{color:"#ffb6c1",margin:0},children:U.title}),o.jsx("button",{className:"anime-modal-close",onClick:()=>se(null),type:"button","aria-label":"Close",children:"X"})]}),o.jsxs("div",{className:"anime-modal-body",children:[o.jsx("div",{children:o.jsx("img",{className:"anime-modal-cover",src:U.image||"https://imgur.com/chUgq4W.png",alt:U.title})}),o.jsxs("div",{className:"anime-modal-meta",children:[o.jsxs("div",{children:[o.jsx("strong",{children:"Status:"})," ",s(U.status)]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Episodes:"})," ",U.episodes?U.episodes:"Unknown"]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Progress:"})," ",Number.isFinite(Number(U.watchedEpisodes))?`Episode ${U.watchedEpisodes}${Number.isFinite(Number(U.episodes))?`/${U.episodes}`:""}`:"Unknown"]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Score:"})," ",Number.isFinite(Number(U.score))&&Number(U.score)>0?U.score:"Not rated"]})]}),o.jsx(bR,{modalItem:U,modalLoading:ve,modalSynopsisShown:ie,onReveal:async()=>{if(!U)return;I(!0);const ce=U.id;if(!ce)return;const Le=we[ce];if(Le!==void 0){se(ge=>ge&&{...ge,synopsis:Le});return}L(!0);try{const ge=await wR(ce);_e(He=>({...He,[ce]:ge||""})),se(He=>He&&{...He,synopsis:ge||""})}catch{_e(He=>({...He,[ce]:""})),se(He=>He&&{...He,synopsis:""})}finally{L(!1)}}})]})]})})]})}function bR({modalItem:n,modalLoading:e,modalSynopsisShown:t,onReveal:s}){var m;const a=((m=n==null?void 0:n.synopsis)==null?void 0:m.trim())||"",[l,d]=j.useState(0),f=j.useRef(null);return j.useEffect(()=>{if(t&&f.current){const y=f.current.scrollHeight+12;d(y)}else d(0)},[t,a]),o.jsxs("div",{className:"anime-modal-summary",children:[o.jsxs("div",{className:"anime-modal-summary-header",children:[o.jsx("h3",{children:"Synopsis"}),!t&&o.jsx("button",{className:"anime-synopsis-btn",type:"button",onClick:s,children:e?"Loading...":"Reveal Synopsis"})]}),o.jsx("div",{className:`anime-modal-summary-body ${t?"is-open":""}`,style:{maxHeight:t?`${l}px`:0,opacity:t?1:0},children:o.jsx("div",{ref:f,children:o.jsx("p",{className:"anime-modal-summary-text",children:e&&!a?"Loading synopsis...":a||"No synopsis available."})})}),!t&&o.jsx("p",{className:"anime-modal-summary-text anime-modal-summary-hint",children:"Synopsis hidden. Click reveal to view."})]})}function CR(){const n={game:"pokemon",name:"",setName:"",number:"",rarity:"",condition:"",quantity:1,pricePaid:"",estimatedValue:"",image:"",productURL:"",notes:""},{admin:e,user:t}=Qa(),[s,a]=j.useState(()=>localStorage.getItem("tcgLastGame")||n.game),[l,d]=j.useState([]),[f,m]=j.useState(!0),[y,x]=j.useState(""),[E,C]=j.useState("all"),[O,X]=j.useState("name"),[B,U]=j.useState(!1),[se,we]=j.useState([]),[_e,ve]=j.useState(""),[L,ie]=j.useState(null),[I,N]=j.useState(!1),[A,M]=j.useState(()=>({...n,game:s}));j.useEffect(()=>{document.title="TCG | Collection"},[]),j.useEffect(()=>{let k=!1;const K=async()=>{if(!k)try{const ke=await fetch("/base/tcg-collection.json",{cache:"no-cache"});if(!ke.ok)throw new Error("fallback fetch failed");const Oe=await ke.json(),Qe=Array.isArray(Oe.tcg)?Oe.tcg:[];k||d(Qe.map((nt,me)=>({id:nt.id||`offline-${me}`,...nt})))}catch(De){console.error("TCG offline fallback failed",De)}finally{k||m(!1)}};async function Te(){m(!0);try{const De=bn(at,"tcg"),ke=await Ns(De),Oe=[];ke.forEach(Qe=>Oe.push({id:Qe.id,...Qe.data()})),k||d(Oe)}catch(De){console.error("Error loading TCG:",De),await K()}finally{k||m(!1)}}return Te(),()=>{k=!0}},[t]);const D=l.filter(k=>{if(E!=="all"&&k.game!==E)return!1;if(!y)return!0;const K=y.toLowerCase();return(k.name||"").toLowerCase().includes(K)||(k.setName||"").toLowerCase().includes(K)||(k.number||"").toLowerCase().includes(K)}),P=[...D].sort((k,K)=>{const Te=(k.name||"").toLowerCase(),De=(K.name||"").toLowerCase(),ke=(k.setName||"").toLowerCase(),Oe=(K.setName||"").toLowerCase(),Qe=(k.rarity||"").toLowerCase(),nt=(K.rarity||"").toLowerCase(),me=Number(k.quantity||0),ce=Number(K.quantity||0),Le=Number(k.estimatedValue||0)*Math.max(1,me),ge=Number(K.estimatedValue||0)*Math.max(1,ce);switch(O){case"set":return ke.localeCompare(Oe)||Te.localeCompare(De);case"rarity":return Qe.localeCompare(nt)||Te.localeCompare(De);case"quantity":return ce-me||Te.localeCompare(De);case"value":return ge-Le||Te.localeCompare(De);case"name":default:return Te.localeCompare(De)}}),b=l.reduce((k,K)=>{const Te=Number(K.quantity||1),De=Number(K.pricePaid||0),ke=Number(K.estimatedValue||0);k.totalCards+=Te,k.totalPaid+=Te*De,k.totalValue+=Te*ke;const Oe=(K.game||"").toLowerCase(),Qe=Te*ke;return Oe==="pokemon"?(k.pokemon+=Te,k.valueByGame.pokemon+=Qe):Oe==="onepiece"?(k.onepiece+=Te,k.valueByGame.onepiece+=Qe):Oe==="mtg"?(k.mtg+=Te,k.valueByGame.mtg+=Qe):k.valueByGame.other+=Qe,k},{totalCards:0,totalPaid:0,totalValue:0,pokemon:0,onepiece:0,mtg:0,valueByGame:{pokemon:0,onepiece:0,mtg:0,other:0}}),J=b.totalValue-b.totalPaid,re=[["Pokemon",b.valueByGame.pokemon],["One Piece",b.valueByGame.onepiece],["MTG",b.valueByGame.mtg],["Other",b.valueByGame.other]].filter(([,k])=>k>0).map(([k,K])=>`${k}: $${K.toFixed(2)}`),Ce=re.length?re.join(`
`):"No value data yet",fe=(k,K)=>{if(k==="game"){a(K);try{localStorage.setItem("tcgLastGame",K)}catch{}}M(Te=>({...Te,[k]:K}))},le=async()=>{if(!e)return;if(!A.name.trim()){alert("Card name is required.");return}const k={game:A.game,name:A.name.trim(),setName:A.setName.trim(),number:A.number.trim(),rarity:A.rarity.trim(),condition:A.condition.trim(),quantity:Number(A.quantity||1),pricePaid:Number(A.pricePaid||0),estimatedValue:Number(A.estimatedValue||0),image:A.image.trim(),productURL:A.productURL.trim(),notes:A.notes.trim()},K=ke=>({game:(ke.game||"").toLowerCase().trim(),name:(ke.name||"").toLowerCase().trim(),setName:(ke.setName||"").toLowerCase().trim(),number:(ke.number||"").toLowerCase().trim(),rarity:(ke.rarity||"").toLowerCase().trim(),condition:(ke.condition||"").toLowerCase().trim(),pricePaid:Number(ke.pricePaid||0),estimatedValue:Number(ke.estimatedValue||0),image:(ke.image||"").trim(),productURL:(ke.productURL||"").trim(),notes:(ke.notes||"").trim()}),Te=K(k),De=l.find(ke=>{const Oe=K(ke);return Oe.game===Te.game&&Oe.name===Te.name&&Oe.setName===Te.setName&&Oe.number===Te.number&&Oe.rarity===Te.rarity&&Oe.condition===Te.condition&&Oe.pricePaid===Te.pricePaid&&Oe.estimatedValue===Te.estimatedValue&&Oe.image===Te.image&&Oe.productURL===Te.productURL&&Oe.notes===Te.notes});try{const ke=bn(at,"tcg");if(De!=null&&De.id){const Oe=Number(De.quantity||1)+k.quantity;await Ps(Mt(at,"tcg",De.id),{quantity:Oe}),d(Qe=>Qe.map(nt=>nt.id===De.id?{...nt,quantity:Oe}:nt))}else{await Oa(ke,k);const Oe=await Ns(ke),Qe=[];Oe.forEach(nt=>Qe.push({id:nt.id,...nt.data()})),d(Qe)}M({...n,game:s}),N(!1)}catch(ke){console.error("Error adding card:",ke),alert("Failed to save card.")}},Pe=async()=>{if(!e||!L)return;if(!L.name.trim()){alert("Card name is required.");return}const k={game:L.game,name:L.name.trim(),setName:L.setName.trim(),number:L.number.trim(),rarity:L.rarity.trim(),condition:L.condition.trim(),quantity:Number(L.quantity||1),pricePaid:Number(L.pricePaid||0),estimatedValue:Number(L.estimatedValue||0),image:L.image?L.image.trim():"",productURL:L.productURL?L.productURL.trim():"",notes:L.notes?L.notes.trim():""};try{await Ps(Mt(at,"tcg",L.id),k),d(K=>K.map(Te=>Te.id===L.id?{...Te,...k}:Te)),ie(null)}catch(K){console.error("Error updating card:",K),alert("Failed to update card.")}},xe=async k=>{if(e&&window.confirm("Delete this card?"))try{await Ma(Mt(at,"tcg",k)),d(K=>K.filter(Te=>Te.id!==k))}catch(K){console.error("Delete error:",K),alert("Failed to delete card.")}},Y=()=>{if(!l.length){alert("No cards to export.");return}const k=new Blob([JSON.stringify({tcg:l},null,2)],{type:"application/json"}),K=URL.createObjectURL(k),Te=document.createElement("a");Te.href=K,Te.download="tcg-collection.json",Te.click(),URL.revokeObjectURL(K)};return o.jsxs("main",{className:"page",children:[o.jsxs("header",{style:{marginTop:"32px",marginBottom:"16px",display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",gap:"6px"},children:[o.jsx("h1",{style:{margin:0,fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Tyler's TCG Collection"}),o.jsx("p",{style:{margin:"6px 0 0",color:"var(--text-soft)",fontSize:"0.9rem"},children:"Check out my TCG Collection with all the data of how much I spent (Under construction) and how much my collection is worth in total!"}),e&&o.jsx("div",{style:{marginTop:"10px"},children:o.jsx("button",{className:"manga-btn secondary",type:"button",onClick:Y,children:"Export JSON"})})]}),e&&o.jsx("button",{className:"manga-btn",type:"button","aria-label":"Add card",onClick:()=>N(!0),style:{position:"fixed",bottom:"20px",right:"20px",zIndex:1e3,width:"56px",height:"56px",borderRadius:"50%",padding:0,fontSize:"28px",display:"flex",alignItems:"center",justifyContent:"center"},children:"+"}),e&&I&&o.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(8,1,10,0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,padding:"12px"},onClick:k=>{k.target===k.currentTarget&&N(!1)},children:o.jsxs("div",{style:{width:"min(720px, 95vw)",background:"#140710",border:"1px solid rgba(255,182,193,0.3)",borderRadius:"12px",padding:"14px",boxShadow:"0 24px 60px rgba(0,0,0,0.85)"},onClick:k=>k.stopPropagation(),children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx("h2",{style:{margin:0,color:"#ffb6c1"},children:"Add card"}),o.jsx("button",{className:"dashboard-close",onClick:()=>N(!1),type:"button","aria-label":"Close",children:"X"})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"180px 1fr",gap:"12px",alignItems:"flex-start",marginTop:"10px"},children:[o.jsx("div",{style:{width:"100%",maxWidth:"180px",borderRadius:"10px",border:"1px solid rgba(255,182,193,0.25)",background:"#1e0d14",overflow:"hidden",aspectRatio:"3 / 4",display:"flex",alignItems:"center",justifyContent:"center"},children:A.image?o.jsx("img",{src:A.image,alt:"Card preview",style:{width:"100%",height:"100%",objectFit:"cover"}}):o.jsx("div",{style:{color:"var(--text-soft)",fontSize:"0.8rem",padding:"6px"},children:"No image"})}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:"8px"},children:[o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Game",o.jsxs("select",{value:A.game,onChange:k=>fe("game",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"},children:[o.jsx("option",{value:"pokemon",children:"Pokemon"}),o.jsx("option",{value:"onepiece",children:"One Piece"}),o.jsx("option",{value:"mtg",children:"MTG"})]})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Card name",o.jsx("input",{type:"text",value:A.name,onChange:k=>fe("name",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Set name",o.jsx("input",{type:"text",value:A.setName,onChange:k=>fe("setName",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Card number",o.jsx("input",{type:"text",value:A.number,onChange:k=>fe("number",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Rarity",o.jsx("input",{type:"text",value:A.rarity,onChange:k=>fe("rarity",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Condition",o.jsx("input",{type:"text",value:A.condition,onChange:k=>fe("condition",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Quantity",o.jsx("input",{type:"number",min:"1",value:A.quantity,onChange:k=>fe("quantity",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Price paid (per card)",o.jsx("input",{type:"number",step:"0.01",min:"0",value:A.pricePaid,onChange:k=>fe("pricePaid",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Estimated value (per card)",o.jsx("input",{type:"number",step:"0.01",min:"0",value:A.estimatedValue,onChange:k=>fe("estimatedValue",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Image URL",o.jsx("input",{type:"text",value:A.image||"",onChange:k=>fe("image",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Product URL (backend only)",o.jsx("input",{type:"text",value:A.productURL||"",onChange:k=>fe("productURL",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{gridColumn:"1 / -1",fontSize:"0.8rem",color:"var(--text-soft)"},children:["Notes",o.jsx("textarea",{value:A.notes,onChange:k=>fe("notes",k.target.value),rows:3,style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff",resize:"vertical"}})]})]})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"12px"},children:[o.jsx("button",{onClick:()=>{M(n),N(!1)},style:{padding:"6px 12px",borderRadius:"999px",border:"1px solid rgba(255,182,193,0.5)",background:"transparent",color:"#ffb6c1",cursor:"pointer"},children:"Cancel"}),o.jsx("button",{onClick:le,style:{padding:"6px 12px",borderRadius:"999px",border:"none",cursor:"pointer",fontWeight:600,background:"#ff69b4",color:"#1e0d14"},children:"Save card"})]})]})}),e&&L&&o.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(8,1,10,0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,padding:"12px"},onClick:k=>{k.target===k.currentTarget&&ie(null)},children:o.jsxs("div",{style:{width:"min(720px, 95vw)",background:"#140710",border:"1px solid rgba(255,182,193,0.3)",borderRadius:"12px",padding:"14px",boxShadow:"0 24px 60px rgba(0,0,0,0.85)"},onClick:k=>k.stopPropagation(),children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx("h2",{style:{margin:0,color:"#ffb6c1"},children:"Edit card"}),o.jsx("button",{className:"dashboard-close",onClick:()=>ie(null),type:"button","aria-label":"Close",children:"X"})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"180px 1fr",gap:"12px",alignItems:"flex-start",marginTop:"10px"},children:[o.jsx("div",{style:{width:"100%",maxWidth:"180px",borderRadius:"10px",border:"1px solid rgba(255,182,193,0.25)",background:"#1e0d14",overflow:"hidden",aspectRatio:"3 / 4",display:"flex",alignItems:"center",justifyContent:"center"},children:L.image?o.jsx("img",{src:L.image,alt:"Card preview",style:{width:"100%",height:"100%",objectFit:"cover"}}):o.jsx("div",{style:{color:"var(--text-soft)",fontSize:"0.8rem",padding:"6px"},children:"No image"})}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:"8px"},children:[o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Game",o.jsxs("select",{value:L.game,onChange:k=>ie(K=>({...K,game:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"},children:[o.jsx("option",{value:"pokemon",children:"Pokemon"}),o.jsx("option",{value:"onepiece",children:"One Piece"}),o.jsx("option",{value:"mtg",children:"MTG"})]})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Card name",o.jsx("input",{type:"text",value:L.name,onChange:k=>ie(K=>({...K,name:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Set name",o.jsx("input",{type:"text",value:L.setName,onChange:k=>ie(K=>({...K,setName:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Card number",o.jsx("input",{type:"text",value:L.number,onChange:k=>ie(K=>({...K,number:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Rarity",o.jsx("input",{type:"text",value:L.rarity,onChange:k=>ie(K=>({...K,rarity:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Condition",o.jsx("input",{type:"text",value:L.condition,onChange:k=>ie(K=>({...K,condition:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Quantity",o.jsx("input",{type:"number",value:L.quantity,onChange:k=>ie(K=>({...K,quantity:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Price paid (each)",o.jsx("input",{type:"number",value:L.pricePaid,onChange:k=>ie(K=>({...K,pricePaid:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Estimated value (each)",o.jsx("input",{type:"number",value:L.estimatedValue,onChange:k=>ie(K=>({...K,estimatedValue:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Image URL",o.jsx("input",{type:"text",value:L.image||"",onChange:k=>ie(K=>({...K,image:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Product URL (backend only)",o.jsx("input",{type:"text",value:L.productURL||"",onChange:k=>ie(K=>({...K,productURL:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{gridColumn:"1 / -1",fontSize:"0.8rem",color:"var(--text-soft)"},children:["Notes",o.jsx("textarea",{value:L.notes||"",onChange:k=>ie(K=>({...K,notes:k.target.value})),rows:3,style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff",resize:"vertical"}})]})]})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"12px"},children:[o.jsx("button",{onClick:()=>ie(null),style:{padding:"6px 12px",borderRadius:"999px",border:"1px solid rgba(255,182,193,0.5)",background:"transparent",color:"#ffb6c1",cursor:"pointer"},children:"Cancel"}),o.jsx("button",{onClick:Pe,style:{padding:"6px 12px",borderRadius:"999px",border:"none",cursor:"pointer",fontWeight:600,background:"#ff69b4",color:"#1e0d14"},children:"Save changes"})]})]})}),o.jsxs("section",{style:{display:"flex",flexWrap:"wrap",gap:"12px",marginTop:"18px",justifyContent:"center"},children:[o.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[o.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Total cards"}),o.jsx("div",{style:{fontSize:"1.1rem",fontWeight:700},children:b.totalCards})]}),b.totalPaid>0&&o.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[o.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Total paid"}),o.jsxs("div",{style:{fontSize:"1.1rem",fontWeight:700},children:["$",b.totalPaid.toFixed(2)]})]}),o.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},title:Ce,children:[o.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Total value"}),o.jsxs("div",{style:{fontSize:"1.1rem",fontWeight:700},children:["$",b.totalValue.toFixed(2)]})]}),b.totalPaid>0&&o.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[o.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Unrealized gain / loss"}),o.jsxs("div",{style:{fontSize:"1.1rem",fontWeight:700,color:J>=0?"#00e676":"#ff8a80"},children:[J>=0?"+":"-","$",Math.abs(J).toFixed(2)]})]}),o.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[o.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Pokemon cards"}),o.jsx("div",{style:{fontSize:"1.1rem",fontWeight:700},children:b.pokemon})]}),o.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[o.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"One Piece cards"}),o.jsx("div",{style:{fontSize:"1.1rem",fontWeight:700},children:b.onepiece})]}),o.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[o.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"MTG cards"}),o.jsx("div",{style:{fontSize:"1.1rem",fontWeight:700},children:b.mtg})]})]}),o.jsxs("section",{style:{display:"flex",flexWrap:"wrap",gap:"10px",marginTop:"16px"},children:[o.jsx("input",{type:"text",placeholder:"Search by name, set, or number...",value:y,onChange:k=>x(k.target.value),style:{flex:"1 1 220px",minWidth:"220px",padding:"8px 12px",borderRadius:"999px",border:"1px solid #bb7f8f",background:"#2b0f1d",color:"#fff"}}),o.jsxs("select",{value:E,onChange:k=>C(k.target.value),style:{flex:"0 0 220px",padding:"8px 12px",borderRadius:"999px",border:"1px solid #bb7f8f",background:"#2b0f1d",color:"#fff"},children:[o.jsx("option",{value:"all",children:"All games"}),o.jsx("option",{value:"pokemon",children:"Pokemon only"}),o.jsx("option",{value:"onepiece",children:"One Piece only"}),o.jsx("option",{value:"mtg",children:"MTG only"})]}),o.jsxs("select",{value:O,onChange:k=>X(k.target.value),style:{flex:"0 0 220px",padding:"8px 12px",borderRadius:"999px",border:"1px solid #bb7f8f",background:"#2b0f1d",color:"#fff"},children:[o.jsx("option",{value:"name",children:"Sort: Name (A-Z)"}),o.jsx("option",{value:"set",children:"Sort: Set (A-Z)"}),o.jsx("option",{value:"rarity",children:"Sort: Rarity (A-Z)"}),o.jsx("option",{value:"quantity",children:"Sort: Quantity (high to low)"}),o.jsx("option",{value:"value",children:"Sort: Value (high to low)"})]})]}),f?o.jsx("p",{style:{marginTop:"20px",color:"var(--text-soft)"},children:"Loading TCG collection..."}):D.length===0?o.jsx("p",{style:{marginTop:"20px",color:"var(--text-soft)"},children:"No cards found."}):o.jsx("section",{className:"grid",style:{gridTemplateColumns:"repeat(auto-fill, minmax(170px, 1fr))",marginTop:"20px"},children:P.map(k=>{const K=Number(k.quantity||1),Te=K*Number(k.pricePaid||0),De=K*Number(k.estimatedValue||0);return o.jsxs("article",{style:{background:"#2b0f1d",borderRadius:"12px",border:"1px solid rgba(255,182,193,0.25)",boxShadow:"0 4px 16px rgba(0,0,0,0.55)",padding:"10px",fontSize:"0.82rem",display:"flex",flexDirection:"column",gap:"6px"},children:[k.image&&o.jsx("div",{style:{width:"100%",paddingTop:"140%",position:"relative",overflow:"hidden",borderRadius:"10px",background:"#1e0d14"},children:o.jsx("img",{src:k.image,alt:k.name||"card image",style:{position:"absolute",inset:0,width:"100%",height:"100%",objectFit:"contain"}})}),o.jsx("div",{style:{fontWeight:700,color:"#ffb6c1",marginBottom:"4px"},children:k.name||"Unnamed card"}),o.jsx("div",{style:{color:"var(--text-soft)",marginBottom:"4px"},children:k.setName||""}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",color:"var(--text-soft)"},children:[o.jsxs("span",{children:["#",k.number||"-"]}),o.jsx("span",{children:k.rarity||""})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",color:"var(--text-soft)",marginTop:"4px"},children:[o.jsxs("span",{children:["Cond: ",k.condition||"N/A"]}),o.jsxs("span",{children:["Qty: ",K]})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",color:"var(--text-soft)",marginTop:"4px"},children:[o.jsxs("span",{children:["Paid: $",Te.toFixed(2)]}),o.jsxs("span",{children:["Value: $",De.toFixed(2)]})]}),k.notes&&o.jsxs("div",{style:{color:"#9c8fa6",fontSize:"0.72rem",fontStyle:"italic",textAlign:"center",marginTop:"6px"},children:['"',k.notes,'"']}),o.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"8px"},children:[o.jsx("span",{style:{padding:"2px 7px",borderRadius:"999px",background:"rgba(255,105,180,0.18)",border:"1px solid rgba(255,105,180,0.5)",color:"#ffb6c1",fontSize:"0.7rem",whiteSpace:"nowrap"},children:{pokemon:"Pokemon",onepiece:"One Piece",mtg:"MTG"}[k.game]||"Other"}),e&&o.jsxs("div",{style:{display:"flex",gap:"6px",alignItems:"center",marginLeft:"auto"},children:[o.jsx("button",{onClick:()=>ie({...k,pricePaid:k.pricePaid??"",estimatedValue:k.estimatedValue??"",quantity:k.quantity??1}),style:{padding:"3px 8px",borderRadius:"999px",border:"1px solid rgba(255,182,193,0.5)",background:"rgba(255,105,180,0.15)",color:"#ffb6c1",fontSize:"0.7rem",cursor:"pointer"},children:"Edit"}),o.jsx("button",{onClick:()=>xe(k.id),style:{padding:"3px 8px",borderRadius:"999px",border:"1px solid rgba(244,67,54,0.7)",background:"rgba(244,67,54,0.12)",color:"#ff8a80",fontSize:"0.7rem",cursor:"pointer"},children:"Delete"})]})]})]},k.id)})})]})}const Pl="https://discord.com/api/webhooks/1448287168845054004/cGWGPoH5LaTFlBZ1vxtgMjOfV9au6qyQ_9ZRnOWN9-AX0MNfwxKNWVcZYQHz0ESA7_4k",Rl="https://discord.com/api/webhooks/1448288240871276616/101WI-B2p8tDR34Hl9fZxxb0QG01f1Eo5w1IvbttlQmP2wWFNJ0OI7UnJfJujKRNWW2Q";function Ya(n){const e=n==null?"":String(n);return e.trim()?e.replace(/\s*,?\s*(?:vol(?:ume)?\.?)\s+\d+.*$/i,"").trim():""}function Ti(n){if(!n)return null;if(n instanceof Date)return n;if(n&&typeof n.toDate=="function")return n.toDate();const e=String(n).trim();if(!e)return null;const t=e.match(/^(\d{4})-(\d{2})-(\d{2})$/);if(t){const[,l,d,f]=t;return new Date(Number(l),Number(d)-1,Number(f))}const s=e.match(/^(\d{1,2})\/(\d{1,2})\/(\d{2,4})$/);if(s){let[,l,d,f]=s;const m=f.length===2?+`20${f}`:Number(f);return new Date(m,Number(l)-1,Number(d))}const a=new Date(e);return isNaN(a.getTime())?null:a}function yc(n){const e=n.seriesKey||n.series||n.Series||n.title||n.Title||"",s=(Ya(e)||e).trim();return s?s.toLowerCase():""}function vw(n){const e=(n==null?void 0:n.series)||(n==null?void 0:n.Series)||(n==null?void 0:n.title)||(n==null?void 0:n.Title)||"Unknown Series";return Ya(e)||"Unknown Series"}function id(n){const e=(n||"").trim(),t=e.match(/^(.*?)(?:,?\s*(?:vol\.|volume)\s*(\d+)(?:\s*[-]\s*\d+)?\s*)?(?:\s*\([^)]*\))?$/i),s=t?t[1].trim().toLowerCase():e.toLowerCase(),a=t&&t[2]?parseInt(t[2],10):0;return{name:s,vol:Number.isFinite(a)?a:0}}function IR(n,e){const t=(n==null?void 0:n.Title)||(n==null?void 0:n.title)||"",s=(e==null?void 0:e.Title)||(e==null?void 0:e.title)||"",a=id(t),l=id(s),d=a.name.localeCompare(l.name);return d!==0?d:a.vol!==l.vol?a.vol-l.vol:t.localeCompare(s)}function vf(){return{publisher:"",demographic:"",genre:"",subGenre:"",datePurchased:"",msrp:"",initialPublisher:"",initialDemographic:"",initialGenre:"",initialSubGenre:"",initialDatePurchased:"",initialMsrp:"",dateMixed:!1,readChecked:!1,readIndeterminate:!1}}function T_(){return{read:!1,datePurchased:"",dateRead:"",pageCount:"",msrp:"",amountPaid:"",rating:"",special:!1,specialType:"",specialVolumes:"",collectiblePrice:""}}function S_(n,e={}){const t=e.ignoreShared,s=(n==null?void 0:n.amountPaid)??(n==null?void 0:n.AmountPaid)??(n==null?void 0:n.paid)??(n==null?void 0:n.Paid)??"",a=(n==null?void 0:n.msrp)??(n==null?void 0:n.MSRP)??"",l=((n==null?void 0:n.datePurchased)||(n==null?void 0:n.DatePurchased)||"").trim(),d=((n==null?void 0:n.publisher)||(n==null?void 0:n.Publisher)||"").trim(),f=((n==null?void 0:n.demographic)||(n==null?void 0:n.Demographic)||"").trim(),m=((n==null?void 0:n.genre)||(n==null?void 0:n.Genre)||"").trim(),y=((n==null?void 0:n.specialType)||(n==null?void 0:n.SpecialType)||"").trim(),x=(n==null?void 0:n.specialVolumes)??(n==null?void 0:n.SpecialVolumes)??(n==null?void 0:n.volumesContained)??"",E=(n==null?void 0:n.collectiblePrice)??(n==null?void 0:n.CollectiblePrice)??"",C=!!y,O=(n==null?void 0:n.pageCount)??(n==null?void 0:n.PageCount)??(n==null?void 0:n.pages)??(n==null?void 0:n.Pages)??"",X=O==null?"":String(O).trim(),B=Number(X),U=!X||Number.isNaN(B)||B<=0;return!C&&(s===""||s===null)||U||!l||!t&&(a===""||!d||!f||!m)||C&&!y||C&&y.toLowerCase()==="collectible"&&(E===""||E===null)||C&&y.toLowerCase()==="specialedition"&&(x===""||x===null)}function NR(n){const e=(n==null?void 0:n.amountPaid)??"",t=((n==null?void 0:n.datePurchased)||"").trim(),s=!!(n!=null&&n.specialType)||!!(n!=null&&n.special),a=((n==null?void 0:n.specialType)||"").trim(),l=(n==null?void 0:n.specialVolumes)??"",d=(n==null?void 0:n.collectiblePrice)??"",f=(n==null?void 0:n.pageCount)??"",m=(n==null?void 0:n.msrp)??"",y=((n==null?void 0:n.publisher)||"").trim(),x=((n==null?void 0:n.demographic)||"").trim(),E=((n==null?void 0:n.genre)||"").trim(),C=!s&&(e===""||e===null),O=s&&!a,X=s&&a.toLowerCase()==="collectible"&&(d===""||d===null),B=s&&a.toLowerCase()==="specialedition"&&(l===""||l===null),U=(()=>{const se=(f??"").toString().trim();if(se==="")return!0;const we=Number(se);return Number.isNaN(we)||we<=0})();return{amountPaid:C,datePurchased:!t,specialType:O,collectiblePrice:X,specialVolumes:B,pageCount:U,msrp:m===""||m===null,publisher:!y,demographic:!x,genre:!E}}function PR(n){return!n||!n.books||!n.books.length?!1:n.books.some(e=>{const t=(e==null?void 0:e.msrp)??(e==null?void 0:e.MSRP)??"",s=((e==null?void 0:e.publisher)||(e==null?void 0:e.Publisher)||"").trim(),a=((e==null?void 0:e.demographic)||(e==null?void 0:e.Demographic)||"").trim(),l=((e==null?void 0:e.genre)||(e==null?void 0:e.Genre)||"").trim();return t===""||!s||!a||!l})}function RR(n){const e=new Map;for(const t of n){const s=yc(t)||t.id;if(!e.has(s)){const m=Ya(t.series||t.Series||t.title||t.Title||"Unknown Series")||"Unknown Series";e.set(s,{key:s,title:m,publisher:t.publisher||t.Publisher||"",genre:t.genre||t.Genre||"",demographic:t.demographic||t.Demographic||"",volumes:0,totalPages:0,readPages:0,readVolumes:0,ratingSum:0,ratingCount:0})}const a=e.get(s);a.volumes+=1;const l=Number(t.pages||t.Pages||t.pageCount||0)||0;a.totalPages+=l,(!!t.read||t.status==="Read"||t.Read===!0)&&(a.readVolumes+=1,a.readPages+=l);const f=Number(t.rating||t.Rating);!isNaN(f)&&f>0&&(a.ratingSum+=f,a.ratingCount+=1)}return e}function No(n,e,t=5){const s=new Map;for(const a of n.values()){const l=(a[e]||"").trim();if(!l)continue;const d=l.split(/[\/,]/).map(f=>f.trim()).filter(Boolean);for(const f of d)s.set(f,(s.get(f)||0)+1)}return[...s.entries()].sort((a,l)=>l[1]-a[1]).slice(0,t).map(([a,l])=>({name:a,count:l}))}function b_(n,e){const t=Array.from({length:12},(s,a)=>{const l=new Date(e,a,1);return{key:`${e}-${a}`,label:l.toLocaleString("default",{month:"short"}),year:e,month:a,value:0}});for(const s of n){const a=Ti(s.dateRead||s.DateRead);!a||a.getFullYear()!==e||(t[a.getMonth()].value+=1)}return t}function Da(n){const e=n.getFullYear(),t=`${n.getMonth()+1}`.padStart(2,"0"),s=`${n.getDate()}`.padStart(2,"0");return`${e}-${t}-${s}`}async function C_(n,e){try{await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:e})})}catch(t){console.error("Webhook post failed",t)}}function AR(n){const e=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],t=Array(7).fill(0);for(const l of n){const d=Ti(l.dateRead||l.DateRead);d&&(t[d.getDay()]+=1)}if(!t.some(l=>l>0))return[];const a=t.reduce((l,d)=>Math.max(l,d),0)||1;return e.map((l,d)=>({label:l,value:t[d],pct:t[d]/a}))}function jR(n,e=8){const t=[...n.values()];t.sort((l,d)=>d.volumes-l.volumes);const s=t.slice(0,e),a=s.reduce((l,d)=>Math.max(l,d.volumes),0)||1;return s.map(l=>({label:l.title,value:l.volumes,pct:l.volumes/a}))}function kR(n,e){const t=(a,l)=>{const d=Ti(a.releaseDate||a.ReleaseDate||a.date||a.Date);if(!d)return null;const f=(a.title||a.series||a.Title||"Unknown Title").trim(),m=id(f),y=m!=null&&m.vol?m.vol:null,x=f,E=!!(a.datePurchased||a.DatePurchased||"").trim(),C=Ya(x||"").toLowerCase();return{date:d,title:x,purchased:E,source:l,seriesKey:C,volume:y}},s=[];return(e||[]).forEach(a=>{const l=t(a,"wishlist");l&&s.push(l)}),(n||[]).forEach(a=>{const l=t(a,"library");l&&s.push(l)}),s.sort((a,l)=>a.date-l.date),s}function DR(n){const e=new Date;for(const t of n)if(t.date>=e)return t;return n[n.length-1]||null}function VR(n){let e=0,t=0;for(const s of n){const a=Ti(s.datePurchased||s.DatePurchased),l=Ti(s.dateRead||s.DateRead);if(!a||!l)continue;const d=l-a;d<=0||(e+=d/(1e3*60*60*24),t+=1)}return t?e/t:null}function LR(n){const e=new Map;for(const t of n){const s=Ti(t.datePurchased||t.DatePurchased),a=Ti(t.dateRead||t.DateRead);if(!s||!a)continue;const l=a-s;if(l<=0)continue;const d=l/(1e3*60*60*24),f=yc(t)||t.id,m=Ya(t.series||t.Series||t.title||t.Title||"Untitled")||"Untitled";e.has(f)||e.set(f,{key:f,title:m,total:0,count:0,min:d,max:d});const y=e.get(f);y.total+=d,y.count+=1,y.min=Math.min(y.min,d),y.max=Math.max(y.max,d)}return[...e.values()].filter(t=>t.count>0).map(t=>({...t,avg:t.total/t.count})).sort((t,s)=>s.avg-t.avg)}function MR(n){let e=0,t=0,s=0;for(const a of n){const l=Number(a.msrp||a.MSRP||0)||0,d=Number(a.amountPaid||a.AmountPaid||a.pricePaid||0)||l||0,f=Number(a.collectiblePrice||a.CollectiblePrice||0)||0;e+=l,t+=d,s+=f}return{msrpTotal:e,paidTotal:t,collectibleTotal:s}}function OR(n){const e=new Map;let t=0,s=0;n.forEach(l=>{const d=yc(l)||l.id;if(!d)return;const m=id(l.title||l.Title||l.series||"").vol||0;e.has(d)||e.set(d,{key:d,title:vw(l),highestOwnedVolume:0,lastReadVolume:0,unreadCount:0,total:0,msrpSum:0,msrpCount:0});const y=e.get(d);y.total+=1,y.highestOwnedVolume=Math.max(y.highestOwnedVolume,m),!!l.read||l.status==="Read"||l.Read===!0?y.lastReadVolume=Math.max(y.lastReadVolume,m):y.unreadCount+=1;const E=Number(l.msrp||l.MSRP);!Number.isNaN(E)&&E>0&&(y.msrpSum+=E,y.msrpCount+=1,t+=E,s+=1)}),e.forEach(l=>{l.avgMsrp=l.msrpCount?l.msrpSum/l.msrpCount:null});const a=s?t/s:null;return{map:e,globalAvgMsrp:a}}function FR(n,e,t={},s=0){if(!n||!n.size)return null;const a=new Date,l=new Map;(e||[]).forEach(E=>{if(!E||!E.date||E.date<a)return;const C=E.seriesKey||Ya(E.title||"").toLowerCase();if(!C)return;const O=l.get(C);(!O||E.date<O.date)&&l.set(C,E)});const d=[...n.values()].filter(E=>E.unreadCount>0);if(!d.length)return null;let f=0;for(const E of d){const C=t!=null&&t[E.key]?new Date(t[E.key]):null;if(C&&C>a){E.snoozedUntil=C,E.score=-1/0;continue}const O=l.get(E.key)||null,X=O?Math.round((O.date-a)/(1e3*60*60*24)):null,B=O&&Number.isFinite(O.volume)?O.volume:null,U=B?Math.max(0,B-E.highestOwnedVolume-1):0,se=B?Math.max(E.highestOwnedVolume||0,B-1):E.highestOwnedVolume||E.total,we=Math.max(0,se-E.lastReadVolume),_e=B?Math.max(0,B-1-E.lastReadVolume):0,ve=Math.max(E.unreadCount,we,_e),L=Math.min(ve,8)/8,ie=X!=null&&X>=0?Math.max(0,120-X)/120:0,I=X!=null&&X<=45?.8:0,N=B?Math.min(U,12)/12:0,A=U>=6?.6:0,M=.85+Math.abs(Math.sin(s+f+1))%.35,D=1+L*1.2+ie*1.4+I-N*1.6-A;E.score=Math.max(D,.05)*M,E.nextRelease=O,E.daysToRelease=X,E.catchUpTarget=se,E.behindCount=ve,E.upcomingVolume=B,E.ownedVolume=E.highestOwnedVolume,E.ownedVsUpcomingGap=U,f+=1}d.sort((E,C)=>C.score-E.score);const m=d.filter(E=>E.score>-1/0),y=m[0]||null,x=m.find((E,C)=>C>0&&E.unreadCount>0)||null;return{pick:y,backup:x}}function UR(n,e,t){if(!n||!n.size)return null;const s=new Date,a=new Map;(e||[]).forEach(d=>{if(!d||!d.date||d.date<s)return;const f=d.seriesKey;if(!f)return;const m=a.get(f);(!m||d.date<m.date)&&a.set(f,d)});const l=[];return n.forEach(d=>{const f=a.get(d.key);if(!f)return;const m=f&&Number.isFinite(f.volume)?f.volume:null;if(!m)return;const y=Math.max(0,m-1-d.highestOwnedVolume);if(y<=0)return;const x=f.date instanceof Date?Math.round((f.date-s)/(1e3*60*60*24)):null,E=d.avgMsrp||t||0,C=E>0?E*y:0,O=E>0?1/(1+C/60):.7,X=x!=null&&x>=0?Math.max(0,120-x)/120:0,B=Math.min(y,12)/12,U=X*1.3+O*1.1+1/(1+y)-B*.9;l.push({...d,nextRelease:f,releaseVolume:m,daysToRelease:x,missingCount:y,costEstimate:C,avgMsrp:E,score:U})}),l.length?(l.sort((d,f)=>f.score-d.score),{pick:l[0],list:l}):null}function zR(n){const e=new Map;for(const t of n){const s=yc(t)||t.id;if(!e.has(s)){const E=t.series||t.Series||t.title||t.Title||"Untitled";e.set(s,{key:s,title:Ya(E)||E.trim()||"Untitled",msrp:0,paid:0,collectible:0,books:0,pages:0,readPages:0,ratings:[]})}const a=e.get(s);a.books+=1;const l=Number(t.msrp||t.MSRP||0)||0,d=Number(t.amountPaid||t.AmountPaid||t.pricePaid||0)||0,f=Number(t.collectiblePrice||t.CollectiblePrice||0)||0,m=Number(t.pages||t.Pages||t.pageCount||0)||0,y=!!t.read||t.status==="Read"||t.Read===!0;a.msrp+=l,a.paid+=d,a.collectible+=f,a.pages+=m,y&&(a.readPages+=m);const x=Number(t.rating||t.Rating);!isNaN(x)&&x>0&&a.ratings.push(x)}return[...e.values()]}function $R(n){let e=0,t=0;for(const s of n){const a=Number(s.pages||s.Pages||s.pageCount||0)||0;e+=a,(!!s.read||s.status==="Read"||s.Read===!0)&&(t+=a)}return{total:e,read:t}}function BR(n){let e=0,t=0;for(const s of n.values())s.ratingCount>0&&(e+=s.ratingSum/s.ratingCount,t+=1);return t?e/t:null}function WR({data:n}){if(!n||!n.length)return o.jsx("div",{className:"line-chart empty",children:"No reading data yet."});const e=n.reduce((y,x)=>Math.max(y,x.value),0)||1,t=480,s=230,a=30,l=s-a*2,d=t/Math.max(n.length-1,1),f=n.map((y,x)=>{const E=x*d,C=s-a-y.value/e*l;return{...y,x:E,y:C}}),m=f.map((y,x)=>x===0?`M ${y.x} ${y.y}`:`L ${y.x} ${y.y}`).join(" ");return o.jsx("div",{className:"line-chart",children:o.jsxs("svg",{viewBox:`0 0 ${t} ${s}`,width:"100%",height:"100%",preserveAspectRatio:"xMidYMid meet",children:[[0,.25,.5,.75,1].map((y,x)=>{const E=s-a-y*l;return o.jsx("line",{className:"line-grid",x1:"0",x2:t,y1:E,y2:E},`h-${x}`)}),f.map((y,x)=>o.jsx("line",{className:"line-grid",x1:y.x,x2:y.x,y1:a/2,y2:s-a/2},`v-${x}`)),o.jsx("path",{className:"line-path",d:m}),f.map((y,x)=>o.jsxs("g",{children:[o.jsx("circle",{className:"line-point",cx:y.x,cy:y.y,r:"1.5"}),o.jsx("text",{className:"line-value",x:y.x,y:y.y-3,children:y.value}),o.jsx("text",{className:"line-label",x:y.x,y:s-4,children:y.label})]},x))]})})}function GR({data:n}){return!n||!n.length?o.jsx("div",{className:"weekday-breakdown empty",children:"No reads recorded yet."}):o.jsx("div",{className:"weekday-bars",children:n.map(e=>o.jsxs("div",{className:"weekday-col",children:[o.jsx("div",{className:"weekday-count",children:e.value}),o.jsx("div",{className:"weekday-bar-vert",children:o.jsx("div",{className:"weekday-bar-vert-fill",style:{height:`${Math.max(e.pct*100,e.value?6:0)}%`}})}),o.jsx("div",{className:"weekday-label",children:e.label})]},e.label))})}function I_(n,e,t){const s=n.getFullYear(),a=n.getMonth(),d=new Date(s,a,1).getDay(),f=new Date(s,a+1,0).getDate(),m=new Map;for(const E of e){const C=E.date;if(C.getFullYear()===s&&C.getMonth()===a){const O=C.getDate();m.has(O)||m.set(O,[]),m.get(O).push(E)}}const y=[];for(let E=0;E<d;E++)y.push({type:"pad"});for(let E=1;E<=f;E++){const C=Da(new Date(s,a,E));y.push({type:"day",day:E,releases:m.get(E)||[],dateKey:C,isToday:C===t})}const x=Math.ceil(y.length/7)*7;for(;y.length<x;)y.push({type:"pad"});return y}function qR(){const{user:n,admin:e,loading:t}=Qa(),[s,a]=j.useState([]),[l,d]=j.useState([]),[f,m]=j.useState(!0),[y,x]=j.useState(null),[E,C]=j.useState("-"),[O,X]=j.useState({yearly:Pl,release:Rl,activity:Va}),[B,U]=j.useState(new Set),[se,we]=j.useState(null),[_e,ve]=j.useState(null),[L,ie]=j.useState(new Set),[I,N]=j.useState(null),[A,M]=j.useState(""),D=j.useRef(null),[P,b]=j.useState(()=>vf()),[J,re]=j.useState(()=>T_()),[Ce,fe]=j.useState([]),[le,Pe]=j.useState(!1),[xe,Y]=j.useState([]),[k,K]=j.useState(!1),[Te,De]=j.useState([]),[ke,Oe]=j.useState(!1),[Qe,nt]=j.useState(""),[me,ce]=j.useState({}),[Le,ge]=j.useState(()=>Math.random()),[He,Je]=j.useState(null),[_t,Ct]=j.useState(null),Nt=async()=>{if(e)try{K(!0);const $=(await Ns(bn(at,"users"))).docs.map(q=>({uid:q.id,...q.data()}));Y($)}catch(T){console.error("Failed to load users",T)}finally{K(!1)}},Ot=async(T,$)=>{const q=(T||"").trim();if(!q){alert("UID is required.");return}try{await pi(Mt(at,"users",q),{role:$,updatedBy:(n==null?void 0:n.uid)||"manual",updatedAt:new Date().toISOString()},{merge:!0}),await Nt()}catch(he){console.error("Failed to update role",he),alert("Failed to update role.")}},[Zt,sn]=j.useState(!1),[en,qn]=j.useState(()=>new Date),[yn,cr]=j.useState(!1),[jt,Bt]=j.useState(()=>new Date),[In,Dn]=j.useState(null),[Hn,_r]=j.useState(!1),[xr,ys]=j.useState(()=>{const T=new Date;return{year:T.getFullYear(),month:T.getMonth()}}),[Kn,cn]=j.useState(null),[un,vs]=j.useState({open:!1,type:null}),mt=new Date().getFullYear(),wr=j.useRef(null),Br=j.useRef(null);j.useEffect(()=>{document.title="Dashboard"},[]),j.useEffect(()=>(Zt||un.open||le||!!_t||yn||!!In||Hn||!!Kn?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[Zt,un.open,le,_t,yn,In,Hn,Kn]),j.useEffect(()=>{typeof window>"u"||(wr.current=localStorage.getItem("dashboard-yearly-posted"),Br.current=localStorage.getItem("dashboard-release-posted"))},[]),j.useEffect(()=>{if(!e)return;const T=Mt(at,"settings","webhooks");(async()=>{try{const $=await jd(T);if($.exists()){const q=$.data();X({yearly:q.yearly||Pl,release:q.release||Rl,activity:q.activity||Va})}else await pi(T,{yearly:Pl,release:Rl,activity:Va}),X({yearly:Pl,release:Rl,activity:Va})}catch($){console.error("Failed to load webhook settings",$)}})()},[e]),j.useEffect(()=>{if(!e)return;let T=!1;return(async()=>await Nt())(),()=>{T=!0}},[e]),j.useEffect(()=>{let T=!1;if(!n||!e){De([]),nt("");return}return(async()=>{try{Oe(!0);const q=(await Ns(bn(at,"suggestions"))).docs.map(he=>{var je;const be=he.data();let Be=null;if((je=be==null?void 0:be.createdAt)!=null&&je.toDate)Be=be.createdAt.toDate();else if(be!=null&&be.createdAt){const ct=new Date(be.createdAt);Be=isNaN(ct.getTime())?null:ct}return{id:he.id,...be,createdAt:Be}});q.sort((he,be)=>{var Be,je,ct,dt;return(((je=(Be=be.createdAt)==null?void 0:Be.getTime)==null?void 0:je.call(Be))||0)-(((dt=(ct=he.createdAt)==null?void 0:ct.getTime)==null?void 0:dt.call(ct))||0)}),T||(De(q),nt(""))}catch($){console.error("Failed to load suggestions",$),T||(nt("Failed to load suggestions."),De([]))}finally{T||Oe(!1)}})(),()=>{T=!0}},[n,e]);const Qn=async T=>{if(!(!e||!T))try{await Ma(Mt(at,"suggestions",T)),De($=>$.filter(q=>q.id!==T))}catch($){console.error("Failed to delete suggestion",$),nt("Failed to delete suggestion.")}};j.useEffect(()=>{let T=!1;async function $(){if(!n||!e){a([]),d([]),x(null),m(!1);return}try{m(!0);const[q,he]=await Promise.all([Ns(bn(at,"library")),Ns(bn(at,"wishlist"))]);if(T)return;a(q.docs.map(be=>({id:be.id,...be.data()}))),d(he.docs.map(be=>({id:be.id,...be.data()}))),x(null)}catch(q){console.error(q),T||x("Failed to load dashboard data.")}finally{T||m(!1)}}return $(),()=>{T=!0}},[n,e]);const{map:Nn,globalAvgMsrp:Wr}=j.useMemo(()=>OR(s),[s]),ur=j.useMemo(()=>{const T=s.length,$=s.filter(rs=>!!rs.read||rs.status==="Read"||rs.Read===!0).length,q=T-$,he=T?Math.round($/T*100):0,be=l.length,Be=RR(s),je=b_(s,mt),ct=b_(s,mt-1),dt=je.reduce((rs,ss)=>rs+ss.value,0),gt=AR(s),kt=jR(Be),Dt=kR(s,l),wt=DR(Dt),xn=VR(s),Et=MR(s),br=$R(s),wn=BR(Be),Lr=LR(s),Fn=No(Be,"publisher",5),Ii=No(Be,"genre",5),er=No(Be,"demographic",5),va=zR(s);return{totalLibrary:T,readCount:$,unreadCount:q,readPct:he,wishlistCount:be,seriesMap:Be,monthlyReads:je,prevYearReads:ct,currentYearReadsTotal:dt,weekdayBreakdown:gt,topSeriesBars:kt,releases:Dt,nextRelease:wt,avgDays:xn,purchaseToReadSeries:Lr,collectionValue:Et,pages:br,avgRating:wn,topPublishers:Fn,topGenres:Ii,topDemographics:er,seriesAggregates:va}},[s,l,mt]),{totalLibrary:Yn,readCount:Gr,unreadCount:Xs,readPct:dr,wishlistCount:qr,seriesMap:st,monthlyReads:ks,prevYearReads:vn,currentYearReadsTotal:_s,weekdayBreakdown:Hr,topSeriesBars:Zs,releases:Ft,nextRelease:hr,avgDays:Kr,purchaseToReadSeries:Jn,collectionValue:Xn,pages:Ut,avgRating:Er,topPublishers:Vn,topGenres:ei,topDemographics:Ds,seriesAggregates:Qr}=ur,Ln=hr?hr.date:null,Vs=!!y,Yr=Da(new Date),Jr=j.useMemo(()=>s.map(T=>{const $=Ti(T.dateRead||T.DateRead);return!$||!(T.read||T.status==="Read"||T.Read===!0)?null:{date:$,title:T.title||T.Title||"Untitled"}}).filter(Boolean).sort((T,$)=>T.date-$.date),[s]),xt=j.useMemo(()=>I_(jt,Jr,Yr),[jt,Jr,Yr]),Zn=j.useMemo(()=>{const T=new Map;return[...s,...l].forEach(q=>{const he=Ti(q.datePurchased||q.DatePurchased);if(!he)return;const be=Da(he);T.has(be)||T.set(be,[]),T.get(be).push({id:q.id||q.Title||q.title||be,title:q.title||q.Title||"Untitled"})}),T.forEach(q=>q.sort((he,be)=>(he.title||"").localeCompare(be.title||""))),T},[s,l]),_n=j.useMemo(()=>{const{year:T,month:$}=xr,he=new Date(T,$,1).getDay(),be=new Date(T,$+1,0).getDate();let Be=!1;const je=[];for(let dt=0;dt<he;dt+=1)je.push({type:"pad"});for(let dt=1;dt<=be;dt+=1){const gt=new Date(T,$,dt),kt=Da(gt),Dt=Zn.get(kt)||[];Dt.length&&(Be=!0),je.push({type:"day",day:dt,dateKey:kt,items:Dt,releases:Dt,isToday:kt===Yr})}const ct=Math.ceil(je.length/7)*7;for(;je.length<ct;)je.push({type:"pad"});return{cells:je,hasItems:Be}},[xr,Zn,Yr]);j.useEffect(()=>{try{const T=localStorage.getItem("dashboard.readNextSnoozed");if(!T)return;const $=JSON.parse(T);$&&typeof $=="object"&&ce($)}catch(T){console.error("Failed to load read-next snoozed state",T)}},[]),j.useEffect(()=>{const T={},$=Date.now();if(Object.entries(me||{}).forEach(([q,he])=>{const be=Number(he);Number.isFinite(be)&&be>$&&(T[q]=be)}),JSON.stringify(T)!==JSON.stringify(me)){ce(T);return}try{localStorage.setItem("dashboard.readNextSnoozed",JSON.stringify(T))}catch(q){console.error("Failed to persist read-next snoozed state",q)}},[me]);const Wt=j.useMemo(()=>FR(Nn,Ft,me,Le),[Nn,Ft,me,Le]),w=(Wt==null?void 0:Wt.pick)||null,z=(Wt==null?void 0:Wt.backup)||null,W=(w==null?void 0:w.snoozedUntil)||null,F=(T=7)=>{if(!(w!=null&&w.key))return;const $=Date.now()+T*24*60*60*1e3;ce(q=>({...q,[w.key]:$})),ge(q=>q+1)},G=j.useMemo(()=>UR(Nn,Ft,Wr),[Nn,Ft,Wr]),ue=(G==null?void 0:G.pick)||null,te=j.useMemo(()=>{if(!s||!s.length)return[];const T=new Map;s.forEach(q=>{const he=yc(q)||q.id,be=vw(q);T.has(he)||T.set(he,{seriesKey:he,displayName:be,books:[]}),T.get(he).books.push(q)});const $=Array.from(T.values()).map(q=>({...q,books:[...q.books].sort(IR)}));return $.sort((q,he)=>q.displayName.localeCompare(he.displayName)),$},[s]),Me=j.useMemo(()=>te.flatMap(T=>T.books.map($=>$.id)),[te]);j.useEffect(()=>{_e&&(s.some(T=>T.id===_e)||ve(null))},[s,_e]),j.useEffect(()=>{se&&(te.some(T=>T.seriesKey===se)||we(null))},[te,se]),j.useEffect(()=>{if(!L.size)return;const T=new Set(s.map(q=>q.id)),$=Array.from(L).filter(q=>!T.has(q));$.length&&ie(q=>{const he=new Set(q);return $.forEach(be=>he.delete(be)),he})},[s,L]),j.useEffect(()=>{const T=Array.from(L);if(!T.length){M("");return}const $=Array.from(new Set(T.map(q=>s.find(he=>he.id===q)).filter(Boolean).map(q=>{const he=q.amountPaid??q.AmountPaid??"";return he==null?"":String(he)})));M($.length===1?$[0]:"")},[L,s]),j.useEffect(()=>{const T=te.find(Et=>Et.seriesKey===se);if(!T){b(vf());return}const $=T.books,q=Et=>{const br=Array.from(new Set($.map(wn=>{const Lr=Et(wn);return Lr==null?"":String(Lr).trim()})));return br.length===1?br[0]:""},he=q(Et=>Et.publisher||Et.Publisher),be=q(Et=>Et.demographic||Et.Demographic),Be=q(Et=>Et.genre||Et.Genre),je=q(Et=>Et.subGenre||Et.SubGenre),ct=q(Et=>Et.msrp??Et.MSRP),dt=Array.from(new Set($.map(Et=>(Et.datePurchased||Et.DatePurchased||"").trim()).filter(Boolean))),gt=dt.length>1,kt=gt?"":dt[0]||"",Dt=$.filter(Et=>!!Et.read||Et.status==="Read"||Et.Read===!0).length,wt=Dt===$.length&&$.length>0;b({publisher:he,demographic:be,genre:Be,subGenre:je,datePurchased:kt,msrp:ct,initialPublisher:he,initialDemographic:be,initialGenre:Be,initialSubGenre:je,initialDatePurchased:kt,initialMsrp:ct,dateMixed:gt,readChecked:wt,readIndeterminate:!wt&&!(Dt===0)})},[te,se]),j.useEffect(()=>{D.current&&(D.current.indeterminate=P.readIndeterminate)},[P.readIndeterminate]),j.useEffect(()=>{const T=s.find(q=>q.id===_e);if(!T){re(T_());return}const $=!!T.read||T.status==="Read"||T.Read===!0;re({read:$,datePurchased:T.datePurchased||T.DatePurchased||"",dateRead:$&&(T.dateRead||T.DateRead)||"",pageCount:T.pageCount??T.PageCount??T.pages??T.Pages??"",msrp:T.msrp??T.MSRP??"",amountPaid:T.amountPaid??T.AmountPaid??"",rating:$?T.rating??T.Rating??"":"",special:!!(T.specialType||T.SpecialType),specialType:T.specialType??T.SpecialType??"",specialVolumes:T.specialVolumes??T.SpecialVolumes??"",collectiblePrice:T.collectiblePrice??T.CollectiblePrice??"",publisher:T.publisher||T.Publisher||"",demographic:T.demographic||T.Demographic||"",genre:T.genre||T.Genre||""})},[_e,s]),j.useEffect(()=>{if(!vn||!vn.length)return;const T=mt-1,$=vn.reduce((Be,je)=>Be+je.value,0);if(!$||(wr.current?parseInt(wr.current,10):null)===T)return;const he=vn.map(Be=>`${Be.label}: ${Be.value}`).join(", "),be=`Yearly reads summary for ${T}: ${$} total. Breakdown: ${he}`;C_(O.yearly,be).then(()=>{wr.current=String(T),typeof window<"u"&&localStorage.setItem("dashboard-yearly-posted",String(T))})},[vn,mt]),j.useEffect(()=>{if(!hr||!Ft.length)return;const T=Da(hr.date),$=Da(new Date);if(T>$||Br.current===T)return;const q=Ft.filter(be=>Da(be.date)===T);if(!q.length)return;const he=`Wishlist releases for ${T}:
${q.map(be=>`- ${be.title}`).join(`
`)}`;C_(O.release,he).then(()=>{Br.current=T,typeof window<"u"&&localStorage.setItem("dashboard-release-posted",T)})},[hr,Ft]),j.useEffect(()=>{if(!Ln){C("-");return}const T=()=>{const q=Ln-new Date;if(q<=0){C("Released");return}const he=Math.floor(q/1e3),be=Math.floor(he/86400),Be=Math.floor(he%86400/3600).toString().padStart(2,"0"),je=Math.floor(he%3600/60).toString().padStart(2,"0"),ct=Math.floor(he%60).toString().padStart(2,"0");C(`${be}d ${Be}:${je}:${ct}`)};T();const $=setInterval(T,1e3);return()=>clearInterval($)},[Ln]),j.useEffect(()=>{if(!(typeof window>"u"))try{const T=localStorage.getItem(om);if(!T)return;const $=JSON.parse(T);if(!Array.isArray($))return;const q=$.map(he=>({message:he.message,ts:he.ts?new Date(he.ts):new Date})).filter(he=>he.message);q.length&&fe(q)}catch(T){console.warn("Failed to load activity log",T)}},[]);const Ne=async()=>{try{const T=await Ns(bn(at,"library"));a(T.docs.map($=>({id:$.id,...$.data()})))}catch(T){console.error("Failed to refresh library",T),x($=>$||"Failed to refresh library data.")}},$e=T=>{const $=(T??"").toString().trim();if($==="")return"";const q=parseFloat($);return Number.isFinite(q)?q:""},de=T=>{const $=(T??"").toString().trim();if($==="")return"";const q=parseInt($,10);return Number.isFinite(q)?q:""},Xe=T=>{if(!T)return;const $={message:T,ts:new Date};fe(q=>{const he=[$,...q].slice(0,100);return mw(he),he}),gw(T,{email:(n==null?void 0:n.email)||"anonymous",name:(n==null?void 0:n.displayName)||"",webhookOverride:O.activity,persistLocal:!1})},Re=T=>{U($=>{const q=new Set($);return q.has(T)?q.delete(T):q.add(T),q}),we(T),ve(null)},ht=(T,$,q)=>{const he=T.metaKey||T.ctrlKey,be=T.shiftKey,Be=Me.indexOf($);let je=new Set(L);if(be&&I!==null&&Be!==-1){const ct=Math.min(I,Be),dt=Math.max(I,Be);for(let gt=ct;gt<=dt;gt+=1){const kt=Me[gt];kt&&je.add(kt)}}else he?je.has($)?je.delete($):je.add($):je=new Set;ie(je),N(Be),ve($),we(q),U(ct=>{const dt=new Set(ct);return dt.add(q),dt})},Xr=()=>{ie(new Set),N(null)},fr=async()=>{if(!e){alert("Dashboard is read-only for your account.");return}const T=Array.from(L);if(!T.length){alert("Select books in Library Manager (use Ctrl/Cmd or Shift) before bulk editing.");return}const $=(A||"").toString().trim(),q=$!=="",he=$e($);if(q&&he===""){alert("Enter a valid number for Amount Paid.");return}try{await Promise.all(T.map(be=>Ps(Mt(at,"library",be),{amountPaid:q?he:""}))),await Ne(),Xr(),Xe(`Updated amount paid for ${T.length} book${T.length===1?"":"s"} in library`),alert(`Applied Amount Paid to ${T.length} selection${T.length===1?"":"s"}.`)}catch(be){console.error("Failed to apply Amount Paid",be),alert("Failed to apply Amount Paid to selection.")}},Mn=async()=>{if(!e){alert("Dashboard is read-only for your account.");return}const T=te.find(Dt=>Dt.seriesKey===se);if(!T||!T.books.length)return;const $=!P.readIndeterminate,q=!!P.readChecked,he=P.datePurchased!==P.initialDatePurchased,be=P.msrp!==P.initialMsrp,Be=P.publisher!==P.initialPublisher,je=P.demographic!==P.initialDemographic,ct=P.genre!==P.initialGenre,dt=P.subGenre!==P.initialSubGenre;if(!$&&!he&&!be&&!Be&&!je&&!ct&&!dt)return;const gt=String(P.msrp??"").trim(),kt=be?$e(gt):"";if(be&&gt!==""&&kt===""){alert("Enter a valid number for MSRP.");return}try{const Dt=[];if(T.books.forEach(wt=>{const xn={};$&&(xn.read=q,xn.dateRead=q?wt.dateRead||wt.DateRead||new Date().toISOString().slice(0,10):""),he&&(xn.datePurchased=P.datePurchased||""),be&&(xn.msrp=P.msrp===""?"":kt),Be&&(xn.publisher=P.publisher||""),je&&(xn.demographic=P.demographic||""),ct&&(xn.genre=P.genre||""),dt&&(xn.subGenre=P.subGenre||""),Object.keys(xn).length&&Dt.push(Ps(Mt(at,"library",wt.id),xn))}),!Dt.length)return;await Promise.all(Dt),await Ne(),ve(null),Xe(`Updated series "${T.displayName||"Series"}" (${T.books.length} book${T.books.length===1?"":"s"})`),alert("Series updated.")}catch(Dt){console.error("Failed to save series changes",Dt),alert("Failed to update series.")}},pr=async()=>{if(!e){alert("Dashboard is read-only for your account.");return}if(!_e)return;const T=!!J.read,$=String(J.msrp??"").trim(),q=String(J.amountPaid??"").trim(),he=String(J.pageCount??"").trim(),be=String(J.rating??"").trim(),Be=$e($),je=$e(q),ct=de(he),dt=$e(be);if($!==""&&Be===""){alert("Enter a valid number for MSRP.");return}if(q!==""&&je===""){alert("Enter a valid number for Amount Paid.");return}if(he!==""&&ct===""){alert("Enter a valid page count.");return}if(T&&be!==""&&dt===""){alert("Enter a valid rating.");return}const gt=!!J.special,kt=de(J.specialVolumes),Dt=$e(J.collectiblePrice),wt=String(J.specialVolumes??"").trim(),xn=String(J.collectiblePrice??"").trim();if(gt&&J.specialType==="specialEdition"&&wt!==""&&kt===""){alert("Enter a valid number for volumes contained.");return}if(gt&&J.specialType==="collectible"&&xn!==""&&Dt===""){alert("Enter a valid collectible price.");return}const Et=T?J.dateRead||new Date().toISOString().slice(0,10):"",br={read:T,datePurchased:J.datePurchased||"",dateRead:Et,msrp:J.msrp===""?"":Be,amountPaid:J.amountPaid===""?"":je,pageCount:J.pageCount===""?"":ct,rating:T?J.rating===""?"":dt:"",specialType:gt&&J.specialType||"",specialVolumes:gt&&J.specialType==="specialEdition"?J.specialVolumes===""?"":kt:"",collectiblePrice:gt&&J.specialType==="collectible"?J.collectiblePrice===""?"":Dt:""};try{await Ps(Mt(at,"library",_e),br),await Ne();const wn=s.find(Fn=>Fn.id===_e)||Pt,Lr=(wn==null?void 0:wn.Title)||(wn==null?void 0:wn.title)||"Untitled";Xe(`Updated "${Lr}" in library`),alert("Saved changes.")}catch(wn){console.error("Failed to save book changes",wn),alert("Failed to save changes.")}},Zr=()=>{we(null),ve(null),Xr(),b(vf())},Ls=()=>{ve(null),N(null)},Rt=te.find(T=>T.seriesKey===se)||null,Pt=s.find(T=>T.id===_e)||null,ut=se?{msrp:!P.msrp,datePurchased:!P.datePurchased&&!P.dateMixed,publisher:!P.publisher,demographic:!P.demographic,genre:!P.genre}:{},On=_e?NR({amountPaid:J.amountPaid,msrp:J.msrp,datePurchased:J.datePurchased,publisher:(Pt==null?void 0:Pt.publisher)||(Pt==null?void 0:Pt.Publisher)||"",demographic:(Pt==null?void 0:Pt.demographic)||(Pt==null?void 0:Pt.Demographic)||"",genre:(Pt==null?void 0:Pt.genre)||(Pt==null?void 0:Pt.Genre)||"",special:J.special,specialType:J.specialType,specialVolumes:J.specialVolumes,collectiblePrice:J.collectiblePrice,pageCount:J.pageCount}):{};if(t)return o.jsx("div",{className:"page dashboard-page",children:o.jsxs("div",{className:"dashboard-loading",children:[o.jsx("h1",{children:"Dashboard"}),o.jsx("p",{children:"Checking permissions..."})]})});if(!n||!e)return o.jsx("div",{className:"page dashboard-page",children:o.jsxs("div",{className:"dashboard-locked",children:[o.jsx("h1",{children:"Dashboard"}),o.jsx("p",{children:"This area is restricted to admin accounts."})]})});if(f)return o.jsx("div",{className:"page dashboard-page",children:o.jsxs("div",{className:"dashboard-loading",children:[o.jsx("h1",{children:"Dashboard"}),y?o.jsx("p",{className:"error",children:y}):o.jsx("p",{children:"Loading stats..."})]})});const ga=Yn+qr,ti=ga?Math.round(Yn/ga*100):0,ya=[...st.values()].filter(T=>T.ratingCount>0).map(T=>({title:T.title,avg:T.ratingSum/T.ratingCount,count:T.ratingCount})).sort((T,$)=>$.avg-T.avg||$.count-T.count).slice(0,3);function Ja(){if(Ln)qn(new Date(Ln.getFullYear(),Ln.getMonth(),1));else if(Ft.length){const T=Ft[0].date;qn(new Date(T.getFullYear(),T.getMonth(),1))}sn(!0)}function es(T){vs({open:!0,type:T})}function Ci(){vs({open:!1,type:null})}const ts=I_(en,Ft,Yr),dn=T=>{ys($=>{const q=new Date($.year,$.month+T,1);return{year:q.getFullYear(),month:q.getMonth()}})},Tr=T=>{Bt($=>new Date($.getFullYear(),$.getMonth()+T,1))},Sr=()=>{_r(!1),cn(null)},Ms=()=>{const T=Array.from(Zn.keys()).sort();if(T.length){const $=T[T.length-1],[q,he]=$.split("-"),be=Number(q),Be=Number(he)-1;!Number.isNaN(be)&&!Number.isNaN(Be)&&ys({year:be,month:Be})}_r(!0)},mr=()=>{if(Jr.length){const T=Jr[Jr.length-1].date;Bt(new Date(T.getFullYear(),T.getMonth(),1))}else Bt(new Date);cr(!0)};function ns(){const T=un.type;if(!T)return null;if(T==="publishers"){const $=[...No(st,"publisher",100)];return o.jsxs(o.Fragment,{children:[o.jsx("h3",{children:"Top Publishers by Series"}),$.length===0?o.jsx("p",{children:"No publisher data yet."}):o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"#"}),o.jsx("th",{children:"Publisher"}),o.jsx("th",{children:"Series Count"})]})}),o.jsx("tbody",{children:$.map((q,he)=>o.jsxs("tr",{children:[o.jsx("td",{children:he+1}),o.jsx("td",{children:q.name}),o.jsx("td",{children:q.count})]},q.name+he))})]})]})}if(T==="genres"){const $=[...No(st,"genre",100)];return o.jsxs(o.Fragment,{children:[o.jsx("h3",{children:"Top Genres by Series"}),$.length===0?o.jsx("p",{children:"No genre data yet."}):o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"#"}),o.jsx("th",{children:"Genre"}),o.jsx("th",{children:"Series Count"})]})}),o.jsx("tbody",{children:$.map((q,he)=>o.jsxs("tr",{children:[o.jsx("td",{children:he+1}),o.jsx("td",{children:q.name}),o.jsx("td",{children:q.count})]},q.name+he))})]})]})}if(T==="demographics"){const $=[...No(st,"demographic",100)];return o.jsxs(o.Fragment,{children:[o.jsx("h3",{children:"Top Demographics by Series"}),$.length===0?o.jsx("p",{children:"No demographic data yet."}):o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"#"}),o.jsx("th",{children:"Demographic"}),o.jsx("th",{children:"Series Count"})]})}),o.jsx("tbody",{children:$.map((q,he)=>o.jsxs("tr",{children:[o.jsx("td",{children:he+1}),o.jsx("td",{children:q.name}),o.jsx("td",{children:q.count})]},q.name+he))})]})]})}if(T==="timeToRead"){const $=Jn||[];return o.jsxs(o.Fragment,{children:[o.jsx("h3",{children:"Average Time From Purchase to Read"}),Kr==null?o.jsx("p",{children:"Not enough volumes have both purchase and read dates to calculate this yet."}):o.jsxs(o.Fragment,{children:[o.jsxs("p",{children:["On average, it takes"," ",o.jsxs("strong",{children:[Kr.toFixed(1)," days"]})," from purchase to finishing a volume."]}),$.length>0?o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Series"}),o.jsx("th",{children:"Avg Days"}),o.jsx("th",{children:"Longest"}),o.jsx("th",{children:"Shortest"}),o.jsx("th",{children:"Reads Count"})]})}),o.jsx("tbody",{children:$.map(q=>o.jsxs("tr",{children:[o.jsx("td",{children:q.title}),o.jsxs("td",{children:[q.avg.toFixed(1)," days"]}),o.jsxs("td",{children:[Math.round(q.max)," days"]}),o.jsxs("td",{children:[Math.round(q.min)," days"]}),o.jsx("td",{children:q.count})]},q.key))})]}):o.jsx("p",{style:{marginTop:8},children:"No series-level data yet."})]})]})}if(T==="collectionValue"){const{msrpTotal:$,paidTotal:q}=Xn,he=$-q,be=$>0?(q/$*100).toFixed(1):"-",Be=[...Qr].filter(je=>je.msrp||je.paid||je.collectible).sort((je,ct)=>ct.msrp+ct.collectible-(je.msrp+je.collectible));return o.jsxs(o.Fragment,{children:[o.jsx("h3",{children:"Collection Value Breakdown"}),o.jsx("table",{children:o.jsxs("tbody",{children:[o.jsxs("tr",{children:[o.jsx("th",{children:"Total MSRP"}),o.jsxs("td",{children:["$",$.toFixed(2)]})]}),o.jsxs("tr",{children:[o.jsx("th",{children:"Total Paid"}),o.jsxs("td",{children:["$",q.toFixed(2)]})]}),o.jsxs("tr",{children:[o.jsx("th",{children:"Difference"}),o.jsxs("td",{children:["$",he.toFixed(2)]})]}),o.jsxs("tr",{children:[o.jsx("th",{children:"Paid vs MSRP"}),o.jsx("td",{children:be==="-"?"-":`${be}%`})]})]})}),Be.length>0&&o.jsxs(o.Fragment,{children:[o.jsx("h4",{style:{marginTop:"14px"},children:"Collection Pricing"}),o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Title"}),o.jsx("th",{children:"MSRP"}),o.jsx("th",{children:"Paid"}),o.jsx("th",{children:"Collectible"}),o.jsx("th",{children:"Books"})]})}),o.jsx("tbody",{children:Be.map((je,ct)=>o.jsxs("tr",{children:[o.jsx("td",{children:je.title}),o.jsxs("td",{children:["$",je.msrp.toFixed(2)]}),o.jsxs("td",{children:["$",je.paid.toFixed(2)]}),o.jsx("td",{children:je.collectible?`$${je.collectible.toFixed(2)}`:"--"}),o.jsx("td",{children:je.books})]},je.title+ct))})]})]})]})}if(T==="pages"){const $=[...Qr].filter(q=>q.pages>0).map(q=>({...q,pct:q.pages?Math.round(q.readPages/q.pages*100):0})).sort((q,he)=>he.pages-q.pages);return o.jsxs(o.Fragment,{children:[o.jsx("h3",{children:"Pages Read vs Total"}),o.jsx("table",{children:o.jsxs("tbody",{children:[o.jsxs("tr",{children:[o.jsx("th",{children:"Total Pages"}),o.jsx("td",{children:Ut.total.toLocaleString()})]}),o.jsxs("tr",{children:[o.jsx("th",{children:"Pages Read"}),o.jsx("td",{children:Ut.read.toLocaleString()})]}),o.jsxs("tr",{children:[o.jsx("th",{children:"Completion"}),o.jsx("td",{children:Ut.total?`${(Ut.read/Ut.total*100).toFixed(1)}%`:"-"})]})]})}),$.length>0&&o.jsxs(o.Fragment,{children:[o.jsx("h4",{style:{marginTop:"14px"},children:"Pages by Series"}),o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Title"}),o.jsx("th",{children:"Read Pages"}),o.jsx("th",{children:"Total Pages"}),o.jsx("th",{children:"% Read"}),o.jsx("th",{children:"Books"})]})}),o.jsx("tbody",{children:$.map((q,he)=>o.jsxs("tr",{children:[o.jsx("td",{children:q.title}),o.jsx("td",{children:q.readPages.toLocaleString()}),o.jsx("td",{children:q.pages.toLocaleString()}),o.jsxs("td",{children:[q.pct,"%"]}),o.jsx("td",{children:q.books})]},q.title+he))})]})]})]})}if(T==="ratings"){const $=[...Qr].map(q=>{if(!q.ratings.length)return null;const he=q.ratings.reduce((be,Be)=>be+Be,0)/q.ratings.length;return{title:q.title,avg:he,count:q.ratings.length}}).filter(Boolean).sort((q,he)=>he.avg-q.avg||he.count-q.count);return o.jsxs(o.Fragment,{children:[o.jsx("h3",{children:"Ratings Overview"}),Er==null?o.jsx("p",{children:"No ratings have been recorded yet."}):o.jsxs("p",{children:["Average series rating across rated series is"," ",o.jsx("strong",{children:Er.toFixed(2)}),"."]}),$.length>0&&o.jsxs(o.Fragment,{children:[o.jsx("h4",{style:{marginTop:"14px"},children:"Series Averages"}),o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Title"}),o.jsx("th",{children:"Avg"}),o.jsx("th",{children:"Ratings"})]})}),o.jsx("tbody",{children:$.map((q,he)=>o.jsxs("tr",{children:[o.jsx("td",{children:q.title}),o.jsx("td",{children:q.avg.toFixed(2)}),o.jsx("td",{children:q.count})]},q.title+he))})]})]})]})}return T==="releases"?o.jsxs(o.Fragment,{children:[o.jsx("h3",{children:"Library & Wishlist Releases"}),Ft.length===0?o.jsx("p",{children:"No wishlist releases found."}):o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Date"}),o.jsx("th",{children:"Title"})]})}),o.jsx("tbody",{children:Ft.map(($,q)=>o.jsxs("tr",{children:[o.jsx("td",{children:$.date.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}),o.jsx("td",{children:$.title})]},q))})]})]}):null}return o.jsxs("div",{className:"page dashboard-page",children:[o.jsxs("header",{className:"dashboard-header",style:{display:"flex",alignItems:"center",justifyContent:"center",position:"relative",textAlign:"center",width:"100%"},children:[o.jsxs("div",{style:{textAlign:"center",margin:"0 auto",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"0 60px"},children:[o.jsx("h1",{style:{margin:0,fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Dashboard"}),o.jsx("p",{className:"dashboard-sub",style:{textAlign:"center",margin:"6px 0 0"},children:"My Entire Statistics dashboard for my Manga. I still use Excel though."})]}),e&&o.jsx("div",{style:{position:"absolute",right:0,top:"50%",transform:"translateY(-50%)"},children:o.jsx("button",{className:"stat-link",onClick:()=>Pe(!0),type:"button",children:"Admin Settings"})})]}),o.jsx("section",{id:"dashboardSection",className:"page-section active",children:o.jsxs("div",{className:"dashboard-grid",children:[o.jsxs("div",{className:"stat-stack",children:[o.jsxs("div",{className:"stat-card mini clickable",onClick:Ms,children:[o.jsx("h3",{children:"Total Library Books"}),o.jsx("div",{className:"stat-value",children:Yn}),o.jsx("div",{className:"stat-sub",children:"Volumes in your library."})]}),o.jsxs("div",{className:"stat-card mini",children:[o.jsx("h3",{children:"Wishlist Items"}),o.jsx("div",{className:"stat-value",children:qr}),o.jsx("div",{className:"stat-sub",children:"Tracked upcoming wants."})]})]}),o.jsxs("div",{className:"stat-card clickable",onClick:mr,role:"button",tabIndex:0,onKeyDown:T=>{(T.key==="Enter"||T.key===" ")&&(T.preventDefault(),mr())},children:[o.jsx("h3",{children:"Read / Unread"}),o.jsx("div",{className:"pie",style:{"--pct":`${dr*3.6}deg`},children:o.jsxs("div",{className:"pie-label",children:[dr,"%"]})}),o.jsxs("div",{className:"stat-value",children:[Gr," read / ",Xs," unread"]})]}),o.jsxs("div",{className:"stat-card clickable",onClick:()=>es("ratings"),children:[o.jsx("h3",{children:"Ratings"}),o.jsx("div",{className:"stat-value",children:Er==null?"-":Er.toFixed(2)}),o.jsx("div",{className:"stat-sub",children:"Average across rated series."}),o.jsx("div",{className:"stat-list compact",children:ya.length?ya.map((T,$)=>o.jsxs("div",{className:"stat-list-row",children:[o.jsx("span",{className:"stat-rank",children:$+1}),o.jsx("span",{className:"stat-name",children:T.title}),o.jsx("span",{className:"stat-count",children:T.avg.toFixed(2)})]},T.title+$)):o.jsx("div",{className:"stat-sub",children:"No ratings yet."})})]}),o.jsxs("div",{className:"stat-card clickable",onClick:()=>es("pages"),children:[o.jsx("h3",{children:"Page Count Read / Total"}),o.jsxs("div",{className:"stat-value",children:[Ut.read.toLocaleString()," / ",Ut.total.toLocaleString()]}),o.jsx("div",{className:"stat-sub",children:Ut.total?`${(Ut.read/Ut.total*100).toFixed(1)}% read`:"-"})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("h3",{children:"Library vs Wishlist"}),o.jsx("div",{className:"pie",style:{"--pct":`${ti*3.6}deg`},children:o.jsxs("div",{className:"pie-label",children:[ti,"%"]})}),o.jsxs("div",{className:"stat-value",children:[Yn," / ",qr]}),o.jsx("div",{className:"stat-sub",children:"Library vs wishlist share"})]}),o.jsxs("div",{className:"stat-card clickable",onClick:()=>es("demographics"),children:[o.jsx("h3",{children:"Top Demographics"}),o.jsx("div",{className:"stat-list",children:Ds.length?Ds.slice(0,3).map((T,$)=>o.jsxs("div",{className:"stat-list-row",children:[o.jsx("span",{className:"stat-rank",children:$+1}),o.jsx("span",{className:"stat-name",children:T.name}),o.jsx("span",{className:"stat-count",children:T.count})]},T.name)):o.jsx("div",{className:"stat-sub",children:"No demographic data yet."})})]}),o.jsxs("div",{className:"stat-card clickable",onClick:()=>es("publishers"),children:[o.jsx("h3",{children:"Top Publishers"}),o.jsx("div",{className:"stat-list",children:Vn.length?Vn.slice(0,3).map((T,$)=>o.jsxs("div",{className:"stat-list-row",children:[o.jsx("span",{className:"stat-rank",children:$+1}),o.jsx("span",{className:"stat-name",children:T.name}),o.jsx("span",{className:"stat-count",children:T.count})]},T.name)):o.jsx("div",{className:"stat-sub",children:"No publisher data yet."})})]}),o.jsxs("div",{className:"stat-card clickable",onClick:()=>es("genres"),children:[o.jsx("h3",{children:"Top Genres"}),o.jsx("div",{className:"stat-list",children:ei.length?ei.slice(0,3).map((T,$)=>o.jsxs("div",{className:"stat-list-row",children:[o.jsx("span",{className:"stat-rank",children:$+1}),o.jsx("span",{className:"stat-name",children:T.name}),o.jsx("span",{className:"stat-count",children:T.count})]},T.name)):o.jsx("div",{className:"stat-sub",children:"No genre data yet."})})]}),o.jsxs("div",{className:"stat-card clickable",onClick:()=>{Ja()},children:[o.jsx("h3",{children:"Next Wishlist Release"}),o.jsx("div",{className:"stat-value next-release",children:hr?hr.title:"No upcoming releases"}),o.jsxs("div",{className:"stat-sub",children:[Ln?Ln.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"}):"-",o.jsx("br",{}),o.jsx("span",{id:"statNextCountdown",children:E})]})]}),o.jsxs("div",{className:"stat-card clickable",onClick:()=>es("collectionValue"),style:{textAlign:"center"},children:[o.jsx("h3",{children:"Collection Pricing"}),o.jsxs("div",{className:"stat-value stat-msrp",children:["$",Xn.msrpTotal.toFixed(2)]}),o.jsxs("div",{className:"stat-value stat-paid",children:["$",Xn.paidTotal.toFixed(2),Xn.msrpTotal>0&&o.jsxs("span",{className:"stat-paid-pct",children:["(",((1-Xn.paidTotal/Xn.msrpTotal)*100).toFixed(1),"% off)"]})]}),o.jsxs("div",{className:"stat-value stat-collectible",children:["$",Xn.collectibleTotal.toFixed(2)]}),o.jsx("div",{className:"stat-sub",children:"MSRP | Paid | Collectible overrides"})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("h3",{children:"Current Year Reads"}),o.jsx("div",{className:"stat-value",children:_s}),o.jsxs("div",{className:"stat-sub",children:["Reads in ",mt]})]}),o.jsxs("div",{className:"stat-card clickable",onClick:()=>es("timeToRead"),children:[o.jsx("h3",{children:"Avg Days From Purchase to Read"}),o.jsx("div",{className:"stat-value",children:Kr==null?"-":`${Kr.toFixed(1)} days`}),o.jsx("div",{className:"stat-sub",children:"When both dates exist"})]}),o.jsxs("div",{className:"stat-duo",children:[o.jsxs("div",{className:"stat-card tall",children:[o.jsxs("h3",{children:["Reads Per Month (",mt,")"]}),o.jsx(WR,{data:ks})]}),o.jsxs("div",{className:"stat-card tall",children:[o.jsx("h3",{children:"Reads by Day of Week (Lifetime)"}),o.jsx(GR,{data:Hr}),o.jsx("div",{className:"stat-sub",children:"Based on all entries with a read date."})]})]}),o.jsxs("div",{className:"stat-card wide",style:{position:"relative",overflow:"hidden",background:"linear-gradient(135deg, rgba(255,182,193,0.08), rgba(255,105,180,0.08)) , radial-gradient(120% 120% at 0% 0%, rgba(255,182,193,0.14), rgba(36,12,24,0.8))",border:"1px solid rgba(255,182,193,0.24)",boxShadow:"0 16px 50px rgba(0,0,0,0.52)",paddingTop:18,marginTop:12},children:[o.jsx("div",{style:{position:"absolute",right:-32,top:-32,width:180,height:180,background:"radial-gradient(circle, rgba(255,105,180,0.16), rgba(255,105,180,0))",pointerEvents:"none"}}),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:12},children:[o.jsx("div",{style:{width:6,height:40,borderRadius:999,background:"linear-gradient(180deg, #ff7fb0, #ffb6c1)"}}),o.jsxs("div",{style:{flex:1},children:[o.jsx("h3",{style:{marginBottom:4},children:"Read Next"}),o.jsx("div",{className:"stat-sub",style:{color:"#f7d0dc",fontSize:"0.9rem"},children:"Weighted pick that balances backlog and upcoming releases."})]}),o.jsx("span",{style:{background:"rgba(255,182,193,0.18)",border:"1px solid rgba(255,182,193,0.32)",color:"#ffb6c1",fontSize:"0.78rem",padding:"6px 11px",borderRadius:"999px",letterSpacing:"0.02em"},children:"Smart"})]}),w?o.jsxs(o.Fragment,{children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14,alignItems:"stretch",textAlign:"center"},children:[o.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:10},children:[o.jsxs("div",{style:{padding:"12px 14px",borderRadius:"14px",border:"1px solid rgba(255,255,255,0.08)",background:"rgba(255,255,255,0.04)",display:"grid",gridTemplateColumns:"1fr",gap:8,textAlign:"center"},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:10,flexWrap:"wrap"},children:[o.jsx("div",{className:"stat-value",style:{lineHeight:1.2},children:w.title}),W&&W>new Date&&o.jsxs("span",{className:"stat-sub",style:{padding:"4px 8px",borderRadius:"999px",border:"1px solid rgba(255,218,123,0.5)",background:"rgba(255,218,123,0.12)",color:"#ffda7b",fontSize:"0.75rem"},children:["Snoozed to ",W.toLocaleDateString(void 0,{month:"short",day:"numeric"})]})]}),o.jsxs("div",{className:"stat-sub",style:{color:"#f7d0dc"},children:["Catch up ",w.behindCount," volume",w.behindCount===1?"":"s"," to reach vol ",w.catchUpTarget,"."]}),w.upcomingVolume?o.jsxs("div",{className:"stat-sub",style:{color:"#c5b3bc"},children:["Own to vol ",w.ownedVolume||0,"; next release is vol ",w.upcomingVolume,w.ownedVsUpcomingGap>0?` (gap ${w.ownedVsUpcomingGap})`:"","."]}):null,o.jsxs("div",{className:"stat-sub",style:{color:"#b6a6af"},children:["Queued after:"," ",z?`${z.title} (${z.unreadCount} unread)`:"Shuffle for another option","."]})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,textAlign:"center"},children:[o.jsxs("div",{style:{padding:"10px",borderRadius:"12px",border:"1px solid rgba(255,182,193,0.22)",background:"rgba(255,182,193,0.08)"},children:[o.jsx("div",{className:"stat-sub",style:{marginBottom:4},children:"Next release"}),o.jsx("div",{style:{fontWeight:700,marginBottom:2},children:w.nextRelease?w.nextRelease.date.toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"}):"None scheduled"}),o.jsx("div",{className:"stat-sub",children:w.nextRelease?`${w.daysToRelease} days out`:"Backlog focus"})]}),o.jsxs("div",{style:{padding:"10px",borderRadius:"12px",border:"1px solid rgba(255,255,255,0.12)",background:"rgba(255,255,255,0.05)"},children:[o.jsx("div",{className:"stat-sub",style:{marginBottom:4},children:"Up next"}),o.jsx("div",{style:{fontWeight:700,marginBottom:2},children:z?z.title:"Shuffle for another pick"}),o.jsx("div",{className:"stat-sub",children:z?`${z.unreadCount} unread`:"Queue empty"})]})]})]}),o.jsxs("div",{style:{padding:"12px 14px",borderRadius:"14px",border:"1px solid rgba(255,182,193,0.24)",background:"rgba(255,182,193,0.08)",display:"flex",flexDirection:"column",gap:8,textAlign:"center"},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,justifyContent:"center",flexWrap:"wrap"},children:[o.jsx("h4",{style:{margin:0},children:"Purchase Next"}),o.jsx("span",{className:"stat-sub",style:{padding:"2px 8px",borderRadius:"999px",border:"1px solid rgba(255,255,255,0.18)",background:"rgba(255,255,255,0.06)",fontSize:"0.7rem"},children:"Catch-up buy"})]}),ue?o.jsxs(o.Fragment,{children:[o.jsx("div",{style:{fontWeight:700,fontSize:"1rem"},children:ue.title}),o.jsxs("div",{className:"stat-sub",style:{color:"#f7d0dc"},children:["Need ",ue.missingCount," volume",ue.missingCount===1?"":"s"," to reach vol ",ue.releaseVolume,"."]}),o.jsxs("div",{className:"stat-sub",style:{color:"#c5b3bc"},children:["Own to vol ",ue.highestOwnedVolume||0,"; est. catch-up cost"," ",ue.costEstimate?`$${ue.costEstimate.toFixed(2)}`:"n/a"," ",ue.avgMsrp?`(avg $${ue.avgMsrp.toFixed(2)})`:""]}),o.jsxs("div",{className:"stat-sub",children:["Next release:"," ",ue.nextRelease?`${ue.nextRelease.date.toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"})} (${ue.daysToRelease} days)`:"No date"]})]}):o.jsx("div",{className:"stat-sub",children:"No purchase catch-ups needed right now."})]})]}),o.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",marginTop:12,justifyContent:"center"},children:[o.jsx("button",{className:"stat-link",type:"button",onClick:()=>ge(T=>T+1),children:"Shuffle pick"}),o.jsx("button",{type:"button",className:"stat-link",style:{background:"rgba(255,218,123,0.1)",borderColor:"rgba(255,218,123,0.4)",color:"#ffda7b"},onClick:()=>F(7),children:"Delay 7 days"}),o.jsx("button",{type:"button",className:"stat-link",style:{background:"rgba(255,255,255,0.08)",borderColor:"rgba(255,255,255,0.22)"},onClick:()=>ce({}),children:"Clear delays"})]})]}):o.jsx("div",{className:"stat-sub",children:"Add some unread volumes to get a tailored pick."})]}),o.jsxs("div",{className:"stat-card wide",children:[o.jsx("h3",{children:"Activity Log"}),Vs&&o.jsx("div",{className:"error",style:{textAlign:"center"},children:y}),o.jsx("div",{className:"activity-log scrollable",children:Ce.length?Ce.map((T,$)=>{const q=T.ts?new Date(T.ts):null;return o.jsxs("div",{className:"activity-row",children:[o.jsx("span",{className:"activity-title",children:T.message}),o.jsx("span",{className:"activity-date",children:q?q.toLocaleString(void 0,{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}):""})]},(T.message||"activity")+$)}):o.jsx("div",{className:"stat-sub",children:"No recent activity yet."})})]}),o.jsxs("div",{className:"stat-card wide",style:{minHeight:"340px",maxHeight:"480px"},children:[o.jsx("h3",{children:"Suggestions"}),Qe&&o.jsx("div",{className:"error",style:{textAlign:"center"},children:Qe}),o.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",alignItems:"stretch"},children:["anime","manga"].map(T=>{const $=Te.filter(q=>(q.type||"").toLowerCase()===T).sort((q,he)=>{var be,Be,je,ct;return(((Be=(be=he.createdAt)==null?void 0:be.getTime)==null?void 0:Be.call(be))||0)-(((ct=(je=q.createdAt)==null?void 0:je.getTime)==null?void 0:ct.call(je))||0)});return o.jsxs("div",{style:{border:"1px solid rgba(255,182,193,0.18)",borderRadius:"16px",padding:"10px 12px",display:"flex",flexDirection:"column",background:"rgba(255,182,193,0.04)",minHeight:"240px"},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"8px",position:"relative"},children:[o.jsx("h4",{style:{margin:0,color:"#ffb6c1",textAlign:"center",flex:1},children:T==="anime"?"Anime":"Manga"}),o.jsxs("span",{className:"stat-sub",style:{position:"absolute",right:0},children:[$.length," suggestion",$.length===1?"":"s"]})]}),o.jsx("div",{className:"scrollable",style:{maxHeight:"280px",height:"280px",paddingRight:"4px",overflowY:"auto"},children:ke?o.jsx("div",{className:"stat-sub",children:"Loading suggestions..."}):$.length?$.map(q=>{const he=q.createdAt instanceof Date?q.createdAt:q.createdAt?new Date(q.createdAt):null;return o.jsxs("div",{style:{border:"1px solid rgba(255,182,193,0.25)",borderRadius:"12px",padding:"8px 10px",marginBottom:"8px",background:"rgba(255,182,193,0.06)",display:"grid",gridTemplateColumns:"1fr auto",gap:"6px",alignItems:"center"},children:[o.jsxs("div",{children:[o.jsx("div",{style:{fontWeight:600,color:"#f7d0dc"},children:q.content||"(no content)"}),o.jsxs("div",{className:"stat-sub",style:{fontSize:"0.8rem"},children:[he?he.toLocaleString(void 0,{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}):""," ",q.from?`| ${q.from}`:""]})]}),o.jsx("div",{style:{display:"flex",gap:"6px"},children:e&&o.jsx("button",{type:"button",className:"stat-link",onClick:()=>Qn(q.id),children:"Delete"})})]},q.id)}):o.jsx("div",{className:"stat-sub",children:"No suggestions yet."})})]},T)})}),o.jsxs("div",{className:"stat-sub",style:{marginTop:"8px",textAlign:"center"},children:["Total suggestions: ",Te.length]})]}),o.jsxs("div",{className:"stat-card wide",children:[o.jsx("h3",{children:"Library Manager"}),te.length?o.jsxs("div",{className:"dash-library",children:[o.jsxs("div",{className:"dash-library-list",children:[te.map(T=>{const $=T.books.filter(je=>!!je.read||je.status==="Read"||je.Read===!0).length,q=B.has(T.seriesKey),he=se===T.seriesKey&&!_e,be=PR(T),Be=T.books.some(je=>S_(je));return o.jsxs("div",{style:{marginBottom:"8px"},children:[o.jsxs("button",{type:"button",onClick:()=>Re(T.seriesKey),style:{width:"100%",textAlign:"left",background:be?"rgba(255,179,71,0.08)":"transparent",border:`1px solid ${he?"#ff69b4":be?"rgba(255,179,71,0.6)":"rgba(255,182,193,0.25)"}`,color:"#ffb6c1",padding:"8px",borderRadius:"8px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"8px",position:"relative",boxShadow:be?"0 0 10px rgba(255,179,71,0.5)":he?"0 0 8px rgba(255,105,180,0.5)":"none"},children:[o.jsx("span",{style:{transition:"transform 0.2s ease",transform:q?"rotate(90deg)":"none"},children:">"}),o.jsx("span",{style:{flex:1},children:T.displayName}),o.jsxs("span",{style:{fontSize:"11px",color:"#f8d1d8"},children:[T.books.length," book",T.books.length===1?"":"s",T.books.length?` | ${$} read`:""]}),Be&&o.jsx("span",{title:"Some volumes are missing required data",style:{width:"12px",height:"12px",borderRadius:"999px",background:"#ffb347",border:"1px solid rgba(255,255,255,0.25)",boxShadow:"0 0 10px rgba(255,179,71,0.6)"}})]}),o.jsx("div",{style:{margin:"6px 0 10px 10px",paddingLeft:"10px",borderLeft:"1px solid rgba(255,182,193,0.25)",display:q?"block":"none"},children:T.books.map(je=>{const ct=_e===je.id,dt=L.has(je.id);je.read||je.status==="Read"||je.Read;const gt=S_(je,{ignoreShared:!0});return o.jsxs("button",{type:"button",onClick:kt=>ht(kt,je.id,T.seriesKey),style:{width:"100%",textAlign:"left",background:gt?"rgba(255,179,71,0.1)":"transparent",border:`1px solid ${ct?"#ff69b4":dt?"#fff59d":gt?"rgba(255,179,71,0.6)":"rgba(255,182,193,0.25)"}`,color:"#ffb6c1",padding:"8px",borderRadius:"8px",marginBottom:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"8px",boxShadow:ct?"0 0 8px rgba(255,105,180,0.5)":dt?"0 0 10px rgba(255,255,180,0.65)":gt?"0 0 10px rgba(255,179,71,0.5)":"none"},children:[o.jsx("span",{style:{flex:1,minWidth:0},children:je.Title||je.title||"Untitled"}),gt&&o.jsx("span",{style:{flexShrink:0,padding:"2px 8px",borderRadius:"999px",background:"rgba(255,179,71,0.18)",border:"1px solid rgba(255,179,71,0.6)",color:"#ffd8a1",fontSize:"11px",fontWeight:700,whiteSpace:"nowrap"},children:"Missing data"})]},je.id)})})]},T.seriesKey)}),te.length>0&&L.size>0&&o.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:o.jsx("button",{type:"button",style:{padding:"6px 12px",borderRadius:"999px",border:"1px solid #ffb6c1",background:"transparent",color:"#ffb6c1",cursor:"pointer"},onClick:Xr,children:"Clear Selection"})})]}),o.jsxs("div",{className:"dash-library-details",children:[L.size>0&&o.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px",padding:"10px",marginBottom:"10px",border:"1px dashed rgba(255,182,193,0.45)",borderRadius:"10px",background:"rgba(255,182,193,0.08)"},children:[o.jsxs("div",{children:["Apply Amount Paid to ",L.size," selected book",L.size===1?"":"s"]}),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",flexWrap:"wrap"},children:[o.jsx("input",{type:"number",step:"0.01",min:"0",value:A,onChange:T=>M(T.target.value),style:{maxWidth:"140px"}}),o.jsx("button",{type:"button",className:"dash-btn primary",onClick:fr,children:"Apply to Selected"})]})]}),!se&&!_e&&o.jsx("div",{className:"stat-sub",style:{marginTop:6},children:"Select a series or book to edit"}),se&&!_e&&Rt&&o.jsxs("div",{children:[o.jsx("div",{className:"dash-detail-title",children:Rt.displayName}),o.jsx("div",{className:"dash-detail-row",children:o.jsxs("label",{className:"inline-checkbox",children:[o.jsx("input",{ref:D,type:"checkbox",checked:P.readChecked,onChange:T=>b($=>({...$,readChecked:T.target.checked,readIndeterminate:!1}))}),o.jsx("span",{children:"Mark series as read"})]})}),o.jsxs("div",{className:`dash-detail-row${ut.publisher?" missing-row":""}`,children:[o.jsx("span",{children:"Publisher"}),o.jsx("input",{type:"text",value:P.publisher,onChange:T=>b($=>({...$,publisher:T.target.value})),placeholder:"Set publisher for series"})]}),o.jsxs("div",{className:`dash-detail-row${ut.demographic?" missing-row":""}`,children:[o.jsx("span",{children:"Demographic"}),o.jsxs("select",{value:P.demographic,onChange:T=>b($=>({...$,demographic:T.target.value})),children:[o.jsx("option",{value:"",children:"Select Demographic"}),o.jsx("option",{value:"Shounen",children:"Shounen"}),o.jsx("option",{value:"Seinen",children:"Seinen"}),o.jsx("option",{value:"Shoujo",children:"Shoujo"}),o.jsx("option",{value:"Josei",children:"Josei"})]})]}),o.jsxs("div",{className:`dash-detail-row${ut.genre?" missing-row":""}`,children:[o.jsx("span",{children:"Genre"}),o.jsx("input",{type:"text",value:P.genre,onChange:T=>b($=>({...$,genre:T.target.value})),placeholder:"Primary genre"})]}),o.jsxs("div",{className:"dash-detail-row",children:[o.jsx("span",{children:"Sub-Genre"}),o.jsx("input",{type:"text",value:P.subGenre,onChange:T=>b($=>({...$,subGenre:T.target.value})),placeholder:"Secondary genre / theme"})]}),!P.dateMixed&&o.jsxs("div",{className:`dash-detail-row${ut.datePurchased?" missing-row":""}`,children:[o.jsx("span",{children:"Date Purchased"}),o.jsx("input",{type:"date",value:P.datePurchased,onChange:T=>b($=>({...$,datePurchased:T.target.value}))})]}),o.jsxs("div",{className:`dash-detail-row${ut.msrp?" missing-row":""}`,children:[o.jsx("span",{children:"MSRP (per book)"}),o.jsx("input",{type:"number",step:"0.01",min:"0",value:P.msrp,onChange:T=>b($=>({...$,msrp:T.target.value})),placeholder:"0.00"})]}),o.jsxs("div",{className:"dash-detail-actions",children:[o.jsx("button",{type:"button",className:"dash-btn secondary",onClick:Zr,children:"Cancel"}),o.jsx("button",{type:"button",className:"dash-btn primary",onClick:Mn,children:"Save Series"})]})]}),_e&&Pt&&o.jsxs("div",{children:[o.jsx("div",{className:"dash-detail-title",children:Pt.Title||Pt.title||"Untitled"}),o.jsx("div",{className:"dash-detail-row",children:o.jsxs("label",{className:"inline-checkbox",children:[o.jsx("input",{type:"checkbox",checked:!!J.read,onChange:T=>re($=>({...$,read:T.target.checked,dateRead:T.target.checked?$.dateRead||new Date().toISOString().slice(0,10):"",rating:T.target.checked?$.rating:""}))}),o.jsx("span",{children:"Mark as read"})]})}),o.jsxs("div",{className:`dash-detail-row${On.datePurchased?" missing-row":""}`,children:[o.jsx("span",{children:"Date Purchased"}),o.jsx("input",{type:"date",value:J.datePurchased,onChange:T=>re($=>({...$,datePurchased:T.target.value}))})]}),J.read&&o.jsxs("div",{className:"dash-detail-row",children:[o.jsx("span",{children:"Date Read"}),o.jsx("input",{type:"date",value:J.dateRead,onChange:T=>re($=>({...$,dateRead:T.target.value}))})]}),o.jsxs("div",{className:`dash-detail-row${On.pageCount?" missing-row":""}`,children:[o.jsx("span",{children:"Page Count"}),o.jsx("input",{type:"number",min:"0",step:"1",value:J.pageCount,onChange:T=>re($=>({...$,pageCount:T.target.value}))})]}),o.jsxs("div",{className:`dash-detail-row${On.msrp?" missing-row":""}`,children:[o.jsx("span",{children:"MSRP (per book)"}),o.jsx("input",{type:"number",step:"0.01",min:"0",value:J.msrp,onChange:T=>re($=>({...$,msrp:T.target.value})),placeholder:"0.00"})]}),!(J.special&&J.specialType==="collectible")&&o.jsxs("div",{className:`dash-detail-row${On.amountPaid?" missing-row":""}`,children:[o.jsx("span",{children:"Amount Paid"}),o.jsx("input",{type:"number",step:"0.01",min:"0",value:J.amountPaid,onChange:T=>re($=>({...$,amountPaid:T.target.value})),placeholder:"0.00"})]}),J.read&&o.jsxs("div",{className:"dash-detail-row",children:[o.jsx("span",{children:"Star Rating"}),o.jsx("input",{type:"number",min:"0",max:"5",step:"0.5",value:J.rating,onChange:T=>re($=>({...$,rating:T.target.value})),placeholder:"0-5"})]}),o.jsx("div",{className:`dash-detail-row${On.specialType?" missing-row":""}`,children:o.jsxs("label",{className:"inline-checkbox",style:{width:"100%"},children:[o.jsx("input",{type:"checkbox",checked:!!J.special,onChange:T=>re($=>({...$,special:T.target.checked,specialType:T.target.checked?$.specialType:"",specialVolumes:T.target.checked?$.specialVolumes:"",collectiblePrice:T.target.checked?$.collectiblePrice:""}))}),o.jsx("span",{children:"Special?"})]})}),J.special&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:`dash-detail-row${On.specialType?" missing-row":""}`,children:[o.jsx("span",{children:"Special Type"}),o.jsxs("select",{value:J.specialType,onChange:T=>re($=>({...$,specialType:T.target.value,specialVolumes:T.target.value==="specialEdition"?$.specialVolumes:"",collectiblePrice:T.target.value==="collectible"?$.collectiblePrice:""})),children:[o.jsx("option",{value:"",children:"Select type"}),o.jsx("option",{value:"specialEdition",children:"Special Edition"}),o.jsx("option",{value:"collectible",children:"Collectible"})]})]}),J.specialType==="specialEdition"&&o.jsxs("div",{className:`dash-detail-row${On.specialVolumes?" missing-row":""}`,children:[o.jsx("span",{children:"Volumes Contained"}),o.jsx("input",{type:"number",min:"1",step:"1",value:J.specialVolumes,onChange:T=>re($=>({...$,specialVolumes:T.target.value}))})]}),J.specialType==="collectible"&&o.jsxs("div",{className:`dash-detail-row${On.collectiblePrice?" missing-row":""}`,children:[o.jsx("span",{children:"Collectible Price"}),o.jsx("input",{type:"number",min:"0",step:"0.01",value:J.collectiblePrice,onChange:T=>re($=>({...$,collectiblePrice:T.target.value})),placeholder:"0.00"})]})]}),o.jsxs("div",{className:"dash-detail-actions",children:[o.jsx("button",{type:"button",className:"dash-btn secondary",onClick:Ls,children:"Cancel"}),o.jsx("button",{type:"button",className:"dash-btn primary",onClick:pr,children:"Save Changes"})]})]})]})]}):o.jsx("div",{className:"stat-sub",children:"No library items."})]})]})}),Hn&&o.jsx("div",{id:"calendarOverlay",onClick:T=>{T.target===T.currentTarget&&Sr()},children:o.jsxs("div",{id:"calendarCard",onClick:T=>T.stopPropagation(),children:[o.jsxs("div",{className:"calendar-header",children:[o.jsx("div",{className:"calendar-title",children:new Date(xr.year,xr.month).toLocaleString(void 0,{month:"long",year:"numeric"})}),o.jsxs("div",{className:"calendar-nav",children:[o.jsx("button",{className:"calendar-nav-btn",onClick:()=>dn(-1),type:"button",children:"<"}),o.jsx("button",{className:"calendar-nav-btn",onClick:()=>dn(1),type:"button",children:">"})]})]}),o.jsxs("div",{className:"calendar-weekdays",children:[o.jsx("div",{children:"Sun"}),o.jsx("div",{children:"Mon"}),o.jsx("div",{children:"Tue"}),o.jsx("div",{children:"Wed"}),o.jsx("div",{children:"Thu"}),o.jsx("div",{children:"Fri"}),o.jsx("div",{children:"Sat"})]}),o.jsxs("div",{className:"calendar-grid",children:[_n.cells.map((T,$)=>{if(T.type==="pad")return o.jsx("div",{className:"calendar-day pad"},`pad-${$}`);const{day:q,dateKey:he,items:be,isToday:Be}=T;return o.jsxs("div",{className:"calendar-day"+(be.length?" has-releases":"")+(Be?" today":""),onClick:()=>{be.length&&cn({date:he,items:be})},role:"button",tabIndex:0,onKeyDown:je=>{if(je.key==="Enter"||je.key===" "){if(je.preventDefault(),!be.length)return;cn({date:he,items:be})}},children:[o.jsx("div",{className:"day-num",children:q}),o.jsxs("div",{className:"calendar-releases",children:[be.slice(0,2).map(je=>o.jsx("div",{className:"calendar-release purchased",children:je.title||"Untitled"},je.id)),be.length>2&&o.jsxs("div",{className:"calendar-release more",children:["+",be.length-2," more"]})]})]},he)}),!_n.hasItems&&o.jsx("div",{className:"calendar-empty",children:"No purchases for this month."})]}),o.jsx("button",{id:"calendarClose",onClick:Sr,type:"button",children:"x"})]})}),Kn&&o.jsx("div",{className:"purchase-overlay",onClick:T=>{T.target===T.currentTarget&&cn(null)},children:o.jsxs("div",{className:"purchase-day-modal",onClick:T=>T.stopPropagation(),children:[o.jsxs("div",{className:"purchase-day-header",children:[o.jsx("div",{className:"purchase-day-title",children:new Date(Kn.date).toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"})}),o.jsx("button",{className:"manga-btn secondary",onClick:()=>cn(null),type:"button",children:"x"})]}),o.jsx("div",{className:"purchase-day-list",children:Kn.items.map(T=>o.jsx("div",{className:"purchase-day-item",children:T.title||"Untitled"},T.id))})]})}),yn&&o.jsx("div",{id:"calendarOverlay",onClick:()=>cr(!1),style:{zIndex:10060},children:o.jsxs("div",{id:"calendarCard",onClick:T=>T.stopPropagation(),children:[o.jsxs("div",{className:"calendar-header",children:[o.jsx("div",{className:"calendar-title",children:jt.toLocaleString(void 0,{month:"long",year:"numeric"})}),o.jsxs("div",{className:"calendar-nav",children:[o.jsx("button",{className:"calendar-nav-btn",onClick:()=>Tr(-1),type:"button",children:"<"}),o.jsx("button",{className:"calendar-nav-btn",onClick:()=>Tr(1),type:"button",children:">"})]})]}),o.jsxs("div",{className:"calendar-weekdays",children:[o.jsx("div",{children:"Sun"}),o.jsx("div",{children:"Mon"}),o.jsx("div",{children:"Tue"}),o.jsx("div",{children:"Wed"}),o.jsx("div",{children:"Thu"}),o.jsx("div",{children:"Fri"}),o.jsx("div",{children:"Sat"})]}),o.jsx("div",{className:"calendar-grid",children:xt.map((T,$)=>{var q;return T.type==="pad"?o.jsx("div",{className:"calendar-day pad"},$):o.jsxs("div",{className:"calendar-day"+(T.isToday?" today":"")+((q=T.releases)!=null&&q.length?" has-releases":""),onClick:()=>{var be;if(!((be=T.releases)!=null&&be.length))return;const he=new Date(jt.getFullYear(),jt.getMonth(),T.day);Dn({dateLabel:he.toLocaleDateString(void 0,{month:"long",day:"numeric",year:"numeric"}),releases:T.releases})},role:"button",tabIndex:0,onKeyDown:he=>{var be;if(he.key==="Enter"||he.key===" "){if(he.preventDefault(),!((be=T.releases)!=null&&be.length))return;const Be=new Date(jt.getFullYear(),jt.getMonth(),T.day);Dn({dateLabel:Be.toLocaleDateString(void 0,{month:"long",day:"numeric",year:"numeric"}),releases:T.releases})}},children:[o.jsx("div",{className:"day-num",children:T.day}),o.jsxs("div",{className:"calendar-releases",children:[(T.releases||[]).slice(0,2).map((he,be)=>o.jsx("div",{className:"calendar-release purchased",title:he.title,children:he.title},be)),(T.releases||[]).length>2&&o.jsxs("div",{className:"calendar-release more",children:["+",(T.releases||[]).length-2," more"]})]})]},T.dateKey||$)})}),!Jr.length&&o.jsx("div",{className:"calendar-empty",children:"No reads recorded yet."}),o.jsx("button",{id:"calendarClose",onClick:()=>cr(!1),type:"button",children:"x"})]})}),In&&o.jsx("div",{id:"calendarOverlay",onClick:()=>Dn(null),style:{zIndex:10080},children:o.jsxs("div",{id:"calendarCard",onClick:T=>T.stopPropagation(),style:{maxWidth:"520px"},children:[o.jsxs("div",{className:"calendar-header",children:[o.jsx("div",{className:"calendar-title",children:In.dateLabel}),o.jsx("button",{className:"calendar-close-btn",onClick:()=>Dn(null),type:"button",children:"x"})]}),o.jsx("div",{className:"calendar-releases modal-list",children:In.releases.map((T,$)=>o.jsx("div",{className:"calendar-release purchased",title:T.title,children:T.title},$))})]})}),Zt&&o.jsx("div",{id:"calendarOverlay",onClick:()=>sn(!1),children:o.jsxs("div",{id:"calendarCard",onClick:T=>T.stopPropagation(),children:[o.jsxs("div",{className:"calendar-header",children:[o.jsx("div",{className:"calendar-title",children:en.toLocaleString(void 0,{month:"long",year:"numeric"})}),o.jsxs("div",{className:"calendar-nav",children:[o.jsx("button",{className:"calendar-nav-btn",onClick:()=>qn(new Date(en.getFullYear(),en.getMonth()-1,1)),children:"<"}),o.jsx("button",{className:"calendar-nav-btn",onClick:()=>qn(new Date(en.getFullYear(),en.getMonth()+1,1)),children:">"})]})]}),o.jsxs("div",{className:"calendar-weekdays",children:[o.jsx("div",{children:"Sun"}),o.jsx("div",{children:"Mon"}),o.jsx("div",{children:"Tue"}),o.jsx("div",{children:"Wed"}),o.jsx("div",{children:"Thu"}),o.jsx("div",{children:"Fri"}),o.jsx("div",{children:"Sat"})]}),o.jsx("div",{className:"calendar-grid",id:"releaseCalendar",children:ts.map((T,$)=>T.type==="pad"?o.jsx("div",{className:"calendar-day pad"},$):o.jsxs("div",{className:"calendar-day"+(T.isToday?" today":""),children:[o.jsx("div",{className:"day-num",children:T.day}),o.jsxs("div",{className:"calendar-releases",children:[(He===T.dateKey?T.releases:T.releases.slice(0,2)).map((q,he)=>o.jsx("div",{className:"calendar-release"+(q.purchased?" purchased":""),title:q.title,children:q.title},he)),T.releases.length>2&&o.jsxs("button",{className:"calendar-more-btn",onClick:()=>{const q=new Date(en.getFullYear(),en.getMonth(),T.day);Ct({dateLabel:q.toLocaleDateString(void 0,{month:"long",day:"numeric",year:"numeric"}),releases:T.releases})},children:["+",T.releases.length-2," more"]})]})]},$))}),!Ft.length&&o.jsx("div",{className:"calendar-empty",children:"No wishlist releases found."}),o.jsx("button",{id:"calendarClose",onClick:()=>sn(!1),children:"x"})]})}),un.open&&o.jsx("div",{id:"statDetailOverlay",onClick:Ci,children:o.jsxs("div",{id:"statDetailCard",onClick:T=>T.stopPropagation(),children:[o.jsx("button",{id:"statDetailClose",onClick:Ci,children:"x"}),o.jsxs("h2",{id:"statDetailTitle",children:[un.type==="publishers"&&"Top Publishers",un.type==="genres"&&"Top Genres",un.type==="demographics"&&"Top Demographics",un.type==="timeToRead"&&"Avg Time From Purchase to Read",un.type==="collectionValue"&&"Collection Value",un.type==="pages"&&"Pages Read vs Total",un.type==="ratings"&&"Ratings",un.type==="releases"&&"Library & Wishlist Releases"]}),o.jsx("div",{id:"statDetailBody",children:ns()})]})}),_t&&o.jsx("div",{id:"calendarOverlay",onClick:()=>Ct(null),style:{zIndex:10080},children:o.jsxs("div",{id:"calendarCard",onClick:T=>T.stopPropagation(),style:{maxWidth:"520px"},children:[o.jsxs("div",{className:"calendar-header",children:[o.jsx("div",{className:"calendar-title",children:_t.dateLabel}),o.jsx("button",{className:"calendar-close-btn",onClick:()=>Ct(null),type:"button",children:"x"})]}),o.jsx("div",{className:"calendar-releases modal-list",children:_t.releases.map((T,$)=>o.jsx("div",{className:"calendar-release"+(T.purchased?" purchased":""),title:T.title,children:T.title},$))})]})}),e&&le&&o.jsx("div",{className:"dashboard-modal-backdrop visible",onClick:T=>{T.target===T.currentTarget&&Pe(!1)},children:o.jsxs("div",{className:"dashboard-modal",children:[o.jsxs("div",{className:"dashboard-modal-header",children:[o.jsx("h3",{children:"Webhook Settings"}),o.jsx("button",{className:"dashboard-close",onClick:()=>Pe(!1),type:"button",children:"X"})]}),o.jsxs("div",{className:"dashboard-modal-body",children:[o.jsxs("label",{className:"dashboard-input",children:[o.jsx("span",{children:"Yearly summary webhook"}),o.jsx("input",{type:"text",value:O.yearly,onChange:T=>X($=>({...$,yearly:T.target.value}))})]}),o.jsxs("label",{className:"dashboard-input",children:[o.jsx("span",{children:"Release timer webhook"}),o.jsx("input",{type:"text",value:O.release,onChange:T=>X($=>({...$,release:T.target.value}))})]}),o.jsxs("label",{className:"dashboard-input",children:[o.jsx("span",{children:"Activity webhook"}),o.jsx("input",{type:"text",value:O.activity,onChange:T=>X($=>({...$,activity:T.target.value}))})]}),o.jsxs("div",{className:"dashboard-input",style:{borderTop:"1px solid rgba(255,182,193,0.2)",paddingTop:8},children:[o.jsx("span",{children:"User roles"}),o.jsx("div",{style:{marginTop:8,fontSize:"0.85rem",color:"var(--text-soft)"},children:k?o.jsx("span",{children:"Loading users"}):xe.length===0?o.jsx("span",{children:"No users found."}):o.jsx("ul",{style:{listStyle:"none",margin:"6px 0 0",padding:0,display:"flex",gap:6,flexDirection:"column"},children:xe.map(T=>o.jsxs("li",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:8,background:"rgba(24,5,18,0.7)",border:"1px solid rgba(255,182,193,0.18)",borderRadius:10,padding:"6px 8px",flexWrap:"wrap"},children:[o.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:2},children:[o.jsx("strong",{children:T.displayName||T.email||T.uid}),o.jsx("span",{style:{fontSize:"0.85rem",opacity:.8},children:T.email||T.uid})]}),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[o.jsx("span",{className:"role-pill",children:T.role||"viewer"}),T.role==="admin"?o.jsx("button",{className:"dashboard-close",type:"button",onClick:()=>Ot(T.uid,"viewer"),style:{padding:"4px 10px"},children:"Make viewer"}):o.jsx("button",{className:"stat-link",type:"button",onClick:()=>Ot(T.uid,"admin"),style:{padding:"4px 10px"},children:"Make admin"})]})]},T.uid))})})]})]}),o.jsxs("div",{className:"dashboard-modal-footer",children:[o.jsx("button",{className:"stat-link",type:"button",onClick:async()=>{try{await pi(Mt(at,"settings","webhooks"),{yearly:O.yearly||Pl,release:O.release||Rl,activity:O.activity||Va}),Pe(!1)}catch(T){console.error("Failed to save webhooks",T),alert("Failed to save webhooks.")}},children:"Save"}),o.jsx("button",{className:"stat-link danger",type:"button",onClick:()=>Pe(!1),children:"Cancel"})]})]})})]})}function HR(){const[n,e]=j.useState(!0),[t,s]=j.useState(""),[a,l]=j.useState(0),[d,f]=j.useState([]),[m,y]=j.useState(0),x=j.useRef(null);j.useEffect(()=>{document.title="Music | im.ok"},[]),j.useEffect(()=>{let ve=!1;async function L(){e(!0),s("");try{const ie=await fetch("https://music-api-worker.imokissick.workers.dev/music");if(!ie.ok)throw new Error("Worker fetch failed");const I=await ie.json();if(ve)return;const N=Array.isArray(I.combined)?I.combined:[],A=Array.isArray(I.spotify)?I.spotify:[],M=Array.isArray(I.soundcloud)?I.soundcloud:[],P=[...N,...A,...M].reduce((b,J)=>{const re=(J.title||"").toLowerCase().trim();if(!re)return b;const Ce=b.findIndex(fe=>(fe.title||"").toLowerCase().trim()===re);return Ce>=0?(b[Ce].source!=="spotify"&&J.source==="spotify"&&(b[Ce]=J),b):(b.push(J),b)},[]).map(b=>({...b,releaseDate:b.releaseDate?new Date(b.releaseDate):new Date}));f(P)}catch(ie){console.error(ie),ve||s("Failed to load music feeds.")}finally{ve||e(!1)}}return L(),()=>{ve=!0}},[]);const E=Math.min(4,Math.max(1,d.length)),C=E?Math.ceil(d.length/E):0,O=()=>{x.current&&clearInterval(x.current),d.length&&(y(ve=>ve+1),x.current=setInterval(()=>{l(ve=>(Math.floor(ve/E)+1)%C*E%d.length),y(ve=>ve+1)},15e3))};j.useEffect(()=>{if(d.length)return O(),()=>{x.current&&clearInterval(x.current)}},[d,E]);const X=ve=>{d.length&&(l(L=>(Math.floor(L/E)+ve+C)%C*E%d.length),O())},B=ve=>{d.length&&(l(ve*E%d.length),O())},U=ve=>L=>{L.preventDefault();const I=ve.source==="spotify"?`spotify:album:${ve.id}`:ve.url,N=ve.url;try{const A=setTimeout(()=>{window.open(N,"_blank","noopener,noreferrer")},600);window.location.href=I,setTimeout(()=>clearTimeout(A),800)}catch{window.open(N,"_blank","noopener,noreferrer")}},se=d[0],we=ve=>ve?{backgroundImage:`url(${ve})`,backgroundSize:"cover",backgroundPosition:"center"}:{},_e=se?se.source==="spotify"?"Spotify":"SoundCloud":"";return o.jsxs("main",{className:"page music-page",children:[o.jsxs("header",{className:"music-hero",children:[o.jsxs("div",{className:"music-hero-content",children:[o.jsx("p",{className:"music-pill",children:"im.ok  Artist"}),o.jsx("h1",{children:se?se.title:"Latest & Greatest"}),o.jsx("p",{className:"music-sub",children:"Check out my latest song. I know it's been almost a whole year since I've released. I have been on a much needed hiatus. I felt the whole world crumbling around me and had no time to breathe so this is why I took a break. Here's to 2026!"}),se&&o.jsx("div",{className:"music-badges",children:o.jsx("span",{children:_e})})]}),o.jsx("div",{className:"music-hero-embed",children:o.jsxs("div",{className:"music-hero-art",style:we(se==null?void 0:se.artwork),children:[!(se!=null&&se.artwork)&&o.jsx("div",{className:"music-hero-art-fallback",children:"Artwork"}),se&&o.jsx("button",{className:"music-link music-play hero-play","aria-label":`Play ${se.title}`,onClick:U(se)})]})})]}),o.jsxs("section",{className:"music-section",children:[o.jsx("div",{className:"music-section-header",children:o.jsx("h2",{children:"Releases"})}),t&&o.jsx("div",{className:"music-error",children:t}),n&&o.jsx("div",{className:"music-loading",children:"Loading music feeds..."}),!n&&d.length===0&&o.jsx("div",{className:"music-empty",children:"Connect Spotify/SoundCloud tokens to see live releases."}),!n&&d.length>0&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"music-carousel-wrap",children:[o.jsx("button",{className:"music-nav left",onClick:()=>X(-1),"aria-label":"Previous releases",children:""}),o.jsx("div",{className:"music-carousel",children:Array.from({length:E}).map((ve,L)=>{const ie=d[(a+L)%d.length];return ie?o.jsxs("div",{className:"music-card",children:[o.jsx("div",{className:"music-card-art",style:we(ie.artwork)}),o.jsxs("div",{className:"music-card-body",children:[o.jsx("div",{className:"music-card-title",children:ie.title}),o.jsx("div",{className:"music-card-actions",children:o.jsx("button",{className:"music-link music-play","aria-label":`Play ${ie.title}`,onClick:U(ie)})})]})]},`${ie.id}-${L}`):null})}),o.jsx("button",{className:"music-nav right",onClick:()=>X(1),"aria-label":"Next releases",children:""})]}),o.jsx("div",{className:"music-dots",children:Array.from({length:C}).map((ve,L)=>{const ie=Math.floor(a/E)===L,I=ie?`${L}-${m}`:`${L}-idle`;return o.jsx("button",{className:`dot ${ie?"active":""}`,onClick:()=>B(L),"aria-label":`Go to set ${L+1}`,children:o.jsx("span",{className:"dot-fill"},I)},L)})})]})]}),o.jsxs("div",{className:"music-feeds-row",children:[o.jsxs("section",{className:"music-section",children:[o.jsx("div",{className:"music-section-header",children:o.jsx("h2",{children:"Spotify"})}),o.jsx("div",{className:"music-embed-card",children:o.jsx("iframe",{title:"Spotify Artist",src:"https://open.spotify.com/embed/artist/00sbWLxYLDs8i5BLQL9Qdo?utm_source=generator&theme=0",width:"100%",height:"400",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy"})})]}),o.jsxs("section",{className:"music-section",children:[o.jsx("div",{className:"music-section-header",children:o.jsx("h2",{children:"SoundCloud"})}),o.jsx("div",{className:"music-embed-card",children:o.jsx("iframe",{title:"SoundCloud Player",width:"100%",height:"400",scrolling:"no",frameBorder:"no",allow:"autoplay",src:"https://w.soundcloud.com/player/?url=https%3A//soundcloud.com/imxk&color=%23ff69b4&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true&visual=true"})})]})]})]})}function KR(){const n=rc(),{user:e}=Qa(),t=async a=>{if(!(a!=null&&a.uid))return;const l=Mt(at,"users",a.uid);try{const d=await jd(l),f=d.exists()?d.data():null,m=(f==null?void 0:f.role)||"viewer";await pi(l,{role:m,email:a.email||(f==null?void 0:f.email)||"",displayName:a.displayName||(f==null?void 0:f.displayName)||"",createdAt:(f==null?void 0:f.createdAt)||za()},{merge:!0})}catch(d){console.warn("Failed to upsert user doc",d)}};j.useEffect(()=>{e!=null&&e.uid&&t(e).finally(()=>n("/"))},[e,n]);async function s(){try{const a=new Is,l=await k0(ps,a);await t(l.user),n("/")}catch(a){console.error(a),alert("Google Sign-In failed.")}}return o.jsx("div",{className:"signin-page",children:o.jsxs("div",{className:"signin-card",children:[o.jsx("h2",{className:"signin-title",children:"Welcome Back"}),o.jsx("p",{className:"signin-sub",children:"Sign in to access the dashboard & edit collections."}),o.jsxs("button",{className:"google-btn",onClick:s,children:[o.jsx("img",{src:"https://www.svgrepo.com/show/475656/google-color.svg",alt:"",className:"google-icon"}),"Continue with Google"]}),o.jsxs("button",{className:"signin-cancel",onClick:()=>n("/"),children:["<"," Back to Home"]})]})})}const QR=j.lazy(()=>gc(()=>import("./SteamCard-CzyRtlBt.js"),[])),YR=j.lazy(()=>gc(()=>import("./SteamRecents-DaCFi8S2.js"),[])),JR=j.lazy(()=>gc(()=>import("./SteamGames-DsdVokFj.js"),[]));function XR(){return j.useEffect(()=>{document.title="Tyler's Gaming Lounge"},[]),o.jsxs("div",{className:"steam-page page",children:[o.jsxs("header",{style:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",gap:"6px"},children:[o.jsx("h1",{style:{margin:0,fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Tyler's Gaming Lounge"}),o.jsx("p",{style:{margin:"6px 0 0",color:"var(--text-soft)",fontSize:"0.9rem"},children:"This will be the home to all of my gaming collections, this is still being worked on, but thought it was cool with just steam for now."})]}),o.jsx(_f,{minHeight:260,children:o.jsx(j.Suspense,{fallback:o.jsx(Mu,{label:"Profile"}),children:o.jsx(QR,{})})}),o.jsx(_f,{minHeight:240,children:o.jsx(j.Suspense,{fallback:o.jsx(Mu,{label:"Recently played"}),children:o.jsx(YR,{})})}),o.jsx(_f,{minHeight:400,children:o.jsx(j.Suspense,{fallback:o.jsx(Mu,{label:"Library & Achievements"}),children:o.jsx(JR,{})})})]})}function _f({children:n,minHeight:e=200}){const[t,s]=j.useState(!1),a=j.useRef(null);j.useEffect(()=>{const d=new IntersectionObserver(f=>{f[0].isIntersecting&&(s(!0),d.disconnect())},{rootMargin:"200px 0px"});return a.current&&d.observe(a.current),()=>d.disconnect()},[]);const l=t?void 0:{minHeight:e};return o.jsx("div",{ref:a,style:l,children:t?n:o.jsx(Mu,{})})}function Mu({label:n="Loading section"}){return o.jsxs("div",{className:"steam-skeleton",children:[o.jsx("div",{className:"steam-skeleton-bar"}),o.jsx("div",{className:"steam-skeleton-bar short"}),o.jsx("p",{className:"steam-skeleton-label",children:n})]})}const xf={id:null,title:"",summary:"",body:"",cover:"",tags:"",status:"draft",publishedAt:null};function Ou(n){return n?n instanceof Date?n:n!=null&&n.toDate?n.toDate():null:null}function bu(n){const e=Ou(n);return e?e.toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"}):""}function ZR(n=[]){return Array.isArray(n)?n.join(", "):""}function eA(n){return(n||"").split(",").map(e=>e.trim()).filter(Boolean)}function tA(){var Ce;const{admin:n,user:e,loading:t}=Qa(),[s,a]=L1(),[l,d]=j.useState([]),[f,m]=j.useState(!0),[y,x]=j.useState(!1),[E,C]=j.useState(!1),[O,X]=j.useState(""),[B,U]=j.useState(xf),[se,we]=j.useState(null),_e=j.useMemo(()=>l.filter(fe=>fe.status==="published"),[l]),ve=j.useMemo(()=>n?l:_e,[n,l,_e]),L=j.useMemo(()=>ve.find(fe=>fe.id===se)||null,[se,ve]);j.useEffect(()=>{document.title="Blog | Reviews"},[]),j.useEffect(()=>{t||N()},[n,t]),j.useEffect(()=>{const fe=s.get("post");fe&&we(fe)},[s]),j.useEffect(()=>{var xe;if(f)return;const le=s.get("post")||se,Pe=le&&ve.some(Y=>Y.id===le)?le:((xe=ve[0])==null?void 0:xe.id)||null;A(Pe,{list:ve})},[f,ve]);const ie=!n&&!f&&_e.length===0;function I(fe){return{id:fe.id,title:fe.title||"",summary:fe.summary||"",body:fe.body||"",cover:fe.cover||"",tags:ZR(fe.tags),status:fe.status||"draft",publishedAt:fe.publishedAt||null}}async function N(fe=null){var le;if(!t){m(!0),X("");try{const Pe=bn(at,"blogPosts"),xe=n?Xf(Pe,Zf("updatedAt","desc")):Xf(Pe,lw("status","==","published"),Zf("publishedAt","desc")),k=(await Ns(xe)).docs.map(De=>{const ke=De.data();return{id:De.id,...ke,createdAt:Ou(ke.createdAt),updatedAt:Ou(ke.updatedAt),publishedAt:Ou(ke.publishedAt),tags:Array.isArray(ke.tags)?ke.tags:[]}});d(k);const K=n?k:k.filter(De=>De.status==="published"),Te=fe||s.get("post")||(K.length?K[0].id:null);Te&&K.some(De=>De.id===Te)?A(Te,{list:K}):A(((le=K[0])==null?void 0:le.id)||null,{list:K})}catch(Pe){console.error("Failed to load blog posts",Pe);const xe=(Pe==null?void 0:Pe.code)==="permission-denied";X(xe?"You do not have permission to view these posts. Make sure you are signed in with an admin account.":"Failed to load posts. Try again shortly.")}finally{m(!1)}}}function A(fe,{list:le}={}){we(fe||null),a(fe?{post:fe}:{});const Pe=le||l;if(n){const xe=Pe.find(Y=>Y.id===fe);U(xe?I(xe):xf)}}function M(fe){A(fe),window.scrollTo({top:0,behavior:"smooth"})}function D(){U(xf),we(null),a({})}function P(fe){const le=fe||B.status||"draft",Pe=le==="published"?B.publishedAt||za():null;return{title:B.title.trim(),summary:B.summary.trim(),body:B.body.trim(),cover:B.cover.trim(),tags:eA(B.tags),status:le,publishedAt:Pe,updatedAt:za()}}async function b(fe="draft"){if(!(!n||y)){if(!B.title.trim()||!B.body.trim()){X("Title and body are required.");return}x(!0),X("");try{const le=P(fe);let Pe=B.id;B.id?await Ps(Mt(at,"blogPosts",B.id),le):Pe=(await Oa(bn(at,"blogPosts"),{...le,createdAt:za()})).id,X(fe==="published"?"Post published and visible to everyone.":"Draft saved."),await N(Pe)}catch(le){console.error("Failed to save blog post",le),X("Could not save the post. Try again.")}finally{x(!1)}}}async function J(fe){if(!(!n||!fe||E||!window.confirm("Delete this post? This cannot be undone."))){C(!0),X("");try{await Ma(Mt(at,"blogPosts",fe)),X("Post deleted."),await N(),D()}catch(Pe){console.error("Failed to delete post",Pe),X("Could not delete the post.")}finally{C(!1)}}}const re=((L==null?void 0:L.body)||"").split(/\n{2,}/).map((fe,le)=>o.jsx("p",{className:"blog-body-paragraph",children:fe},le));return t?o.jsx("div",{className:"page blog-page",children:o.jsx("div",{className:"blog-guard-card",children:"Checking access..."})}):e?n?o.jsxs("div",{className:"page blog-page",children:[o.jsxs("header",{className:"blog-hero",children:[o.jsx("div",{className:"blog-pill",children:n?"Admin workspace":"Latest updates"}),o.jsx("h1",{children:"Blog & Reviews"}),o.jsx("p",{children:"Share reviews for anime or manga you have read. Draft privately, publish when ready, and keep visitors in the loop with new releases."})]}),O&&o.jsx("div",{className:"blog-status",children:O}),o.jsxs("div",{className:"blog-shell",children:[o.jsxs("aside",{className:"blog-sidebar",children:[o.jsxs("div",{className:"blog-sidebar-header",children:[o.jsxs("div",{children:[o.jsx("div",{className:"blog-sidebar-label",children:"Posts"}),o.jsxs("div",{className:"blog-sidebar-count",children:[ve.length," ",ve.length===1?"entry":"entries"]})]}),n&&o.jsx("button",{type:"button",className:"blog-btn solid",onClick:D,children:"+ New draft"})]}),o.jsxs("div",{className:"blog-list",children:[f&&o.jsx("div",{className:"blog-muted",children:"Loading posts..."}),!f&&!ve.length&&o.jsx("div",{className:"blog-muted",children:"No posts yet."}),ve.map(fe=>o.jsxs("button",{className:"blog-list-item"+(se===fe.id?" active":""),onClick:()=>M(fe.id),children:[o.jsxs("div",{className:"blog-list-row",children:[o.jsx("span",{className:"blog-list-title",children:fe.title||"Untitled"}),o.jsx("span",{className:"blog-chip "+(fe.status==="published"?"success":"draft"),children:fe.status==="published"?"Published":"Draft"})]}),o.jsx("div",{className:"blog-list-sub",children:fe.status==="published"?`Published ${bu(fe.publishedAt)}`:`Last touched ${bu(fe.updatedAt)}`})]},fe.id))]})]}),o.jsxs("section",{className:"blog-main",children:[ie?o.jsxs("div",{className:"blog-guard-card",children:[o.jsx("h3",{children:"Under construction"}),o.jsx("p",{children:"This blog page is being built. Once posts are published, they will appear here. Admins can already create and publish posts."})]}):L?o.jsxs("article",{className:"blog-article",children:[o.jsxs("div",{className:"blog-article-meta",children:[o.jsx("span",{className:"blog-chip "+(L.status==="published"?"success":"draft"),children:L.status==="published"?"Published":"Draft"}),o.jsx("span",{className:"blog-meta-text",children:L.status==="published"?`Published ${bu(L.publishedAt)}`:`Last saved ${bu(L.updatedAt)}`})]}),o.jsx("h2",{className:"blog-article-title",children:L.title||"Untitled"}),L.summary&&o.jsx("p",{className:"blog-article-summary",children:L.summary}),L.cover&&o.jsx("div",{className:"blog-cover",children:o.jsx("img",{src:L.cover,alt:""})}),o.jsx("div",{className:"blog-body",children:re}),(Ce=L.tags)!=null&&Ce.length?o.jsx("div",{className:"blog-tag-row",children:L.tags.map(fe=>o.jsx("span",{className:"blog-chip ghost",children:fe},fe))}):null]}):o.jsxs("div",{className:"blog-guard-card",children:[o.jsx("h3",{children:"No post selected"}),o.jsx("p",{children:"Select a post from the left to read it."})]}),n&&o.jsxs("div",{className:"blog-editor-card",children:[o.jsxs("div",{className:"blog-editor-header",children:[o.jsxs("div",{children:[o.jsx("div",{className:"blog-sidebar-label",children:B.id?"Edit post":"New draft"}),o.jsx("div",{className:"blog-sidebar-count",children:B.id?"Update and publish when ready":"Fill in the details to create"})]}),B.id&&o.jsx("button",{type:"button",className:"blog-btn danger",onClick:()=>J(B.id),disabled:E,children:E?"Deleting...":"Delete"})]}),o.jsxs("div",{className:"blog-form",children:[o.jsxs("label",{className:"blog-field",children:[o.jsx("span",{children:"Title"}),o.jsx("input",{type:"text",value:B.title,onChange:fe=>U(le=>({...le,title:fe.target.value})),placeholder:"e.g., Chainsaw Man Volume 14 Review"})]}),o.jsxs("label",{className:"blog-field",children:[o.jsx("span",{children:"Summary"}),o.jsx("input",{type:"text",value:B.summary,onChange:fe=>U(le=>({...le,summary:fe.target.value})),placeholder:"One-liner that appears in previews"})]}),o.jsxs("label",{className:"blog-field",children:[o.jsx("span",{children:"Cover image URL (optional)"}),o.jsx("input",{type:"url",value:B.cover,onChange:fe=>U(le=>({...le,cover:fe.target.value})),placeholder:"https://..."})]}),o.jsxs("label",{className:"blog-field",children:[o.jsx("span",{children:"Tags (comma separated)"}),o.jsx("input",{type:"text",value:B.tags,onChange:fe=>U(le=>({...le,tags:fe.target.value})),placeholder:"anime, manga, review"})]}),o.jsxs("label",{className:"blog-field",children:[o.jsx("span",{children:"Body"}),o.jsx("textarea",{rows:8,value:B.body,onChange:fe=>U(le=>({...le,body:fe.target.value})),placeholder:"Write your review here. Separate paragraphs with blank lines."})]}),o.jsxs("div",{className:"blog-actions",children:[o.jsx("button",{type:"button",className:"blog-btn",onClick:()=>b("draft"),disabled:y,children:y?"Saving...":"Save draft"}),o.jsx("button",{type:"button",className:"blog-btn solid",onClick:()=>b("published"),disabled:y,children:y?"Publishing...":"Publish"}),B.status==="published"&&o.jsx("button",{type:"button",className:"blog-btn ghost",onClick:()=>b("draft"),disabled:y,children:"Move to draft"})]})]})]})]})]})]}):o.jsx(Ef,{to:"/home",replace:!0}):o.jsx(Ef,{to:"/signin",replace:!0})}function nA(){return o.jsxs(QP,{children:[o.jsx(tR,{}),o.jsxs(S1,{children:[o.jsx(hs,{path:"/",element:o.jsx(h_,{})}),o.jsx(hs,{path:"/home",element:o.jsx(h_,{})}),o.jsx(hs,{path:"/manga",element:o.jsx(fR,{})}),o.jsx(hs,{path:"/anime",element:o.jsx(SR,{})}),o.jsx(hs,{path:"/tcg",element:o.jsx(CR,{})}),o.jsx(hs,{path:"/music",element:o.jsx(HR,{})}),o.jsx(hs,{path:"/blog",element:o.jsx(tA,{})}),o.jsx(hs,{path:"/dashboard",element:o.jsx(qR,{})}),o.jsx(hs,{path:"/signin",element:o.jsx(KR,{})}),o.jsx(hs,{path:"/steam",element:o.jsx(XR,{})}),o.jsx(hs,{path:"*",element:o.jsx(Ef,{to:"/home",replace:!0})})]})]})}jE.createRoot(document.getElementById("root")).render(o.jsx(np.StrictMode,{children:o.jsx(j1,{basename:"/base",children:o.jsx(nA,{})})}));export{o as j,j as r};
