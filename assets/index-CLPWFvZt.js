function _E(n,e){for(var t=0;t<e.length;t++){const s=e[t];if(typeof s!="string"&&!Array.isArray(s)){for(const a in s)if(a!=="default"&&!(a in n)){const c=Object.getOwnPropertyDescriptor(s,a);c&&Object.defineProperty(n,a,c.get?c:{enumerable:!0,get:()=>s[a]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const c of a)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&s(d)}).observe(document,{childList:!0,subtree:!0});function t(a){const c={};return a.integrity&&(c.integrity=a.integrity),a.referrerPolicy&&(c.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?c.credentials="include":a.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function s(a){if(a.ep)return;a.ep=!0;const c=t(a);fetch(a.href,c)}})();function b_(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Xh={exports:{}},Il={},Zh={exports:{}},mt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dy;function xE(){if(dy)return mt;dy=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),c=Symbol.for("react.provider"),d=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),v=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),S=Symbol.iterator;function b(K){return K===null||typeof K!="object"?null:(K=S&&K[S]||K["@@iterator"],typeof K=="function"?K:null)}var M={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Y=Object.assign,z={};function V(K,A,W){this.props=K,this.context=A,this.refs=z,this.updater=W||M}V.prototype.isReactComponent={},V.prototype.setState=function(K,A){if(typeof K!="object"&&typeof K!="function"&&K!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,K,A,"setState")},V.prototype.forceUpdate=function(K){this.updater.enqueueForceUpdate(this,K,"forceUpdate")};function te(){}te.prototype=V.prototype;function be(K,A,W){this.props=K,this.context=A,this.refs=z,this.updater=W||M}var we=be.prototype=new te;we.constructor=be,Y(we,V.prototype),we.isPureReactComponent=!0;var ge=Array.isArray,ie=Object.prototype.hasOwnProperty,Ee={current:null},D={key:!0,ref:!0,__self:!0,__source:!0};function N(K,A,W){var ye,De={},je=null,Me=null;if(A!=null)for(ye in A.ref!==void 0&&(Me=A.ref),A.key!==void 0&&(je=""+A.key),A)ie.call(A,ye)&&!D.hasOwnProperty(ye)&&(De[ye]=A[ye]);var ae=arguments.length-2;if(ae===1)De.children=W;else if(1<ae){for(var ze=Array(ae),Je=0;Je<ae;Je++)ze[Je]=arguments[Je+2];De.children=ze}if(K&&K.defaultProps)for(ye in ae=K.defaultProps,ae)De[ye]===void 0&&(De[ye]=ae[ye]);return{$$typeof:n,type:K,key:je,ref:Me,props:De,_owner:Ee.current}}function C(K,A){return{$$typeof:n,type:K.type,key:A,ref:K.ref,props:K.props,_owner:K._owner}}function O(K){return typeof K=="object"&&K!==null&&K.$$typeof===n}function G(K){var A={"=":"=0",":":"=2"};return"$"+K.replace(/[=:]/g,function(W){return A[W]})}var k=/\/+/g;function P(K,A){return typeof K=="object"&&K!==null&&K.key!=null?G(""+K.key):A.toString(36)}function ve(K,A,W,ye,De){var je=typeof K;(je==="undefined"||je==="boolean")&&(K=null);var Me=!1;if(K===null)Me=!0;else switch(je){case"string":case"number":Me=!0;break;case"object":switch(K.$$typeof){case n:case e:Me=!0}}if(Me)return Me=K,De=De(Me),K=ye===""?"."+P(Me,0):ye,ge(De)?(W="",K!=null&&(W=K.replace(k,"$&/")+"/"),ve(De,A,W,"",function(Je){return Je})):De!=null&&(O(De)&&(De=C(De,W+(!De.key||Me&&Me.key===De.key?"":(""+De.key).replace(k,"$&/")+"/")+K)),A.push(De)),1;if(Me=0,ye=ye===""?".":ye+":",ge(K))for(var ae=0;ae<K.length;ae++){je=K[ae];var ze=ye+P(je,ae);Me+=ve(je,A,W,ze,De)}else if(ze=b(K),typeof ze=="function")for(K=ze.call(K),ae=0;!(je=K.next()).done;)je=je.value,ze=ye+P(je,ae++),Me+=ve(je,A,W,ze,De);else if(je==="object")throw A=String(K),Error("Objects are not valid as a React child (found: "+(A==="[object Object]"?"object with keys {"+Object.keys(K).join(", ")+"}":A)+"). If you meant to render a collection of children, use an array instead.");return Me}function Ge(K,A,W){if(K==null)return K;var ye=[],De=0;return ve(K,ye,"","",function(je){return A.call(W,je,De++)}),ye}function Re(K){if(K._status===-1){var A=K._result;A=A(),A.then(function(W){(K._status===0||K._status===-1)&&(K._status=1,K._result=W)},function(W){(K._status===0||K._status===-1)&&(K._status=2,K._result=W)}),K._status===-1&&(K._status=0,K._result=A)}if(K._status===1)return K._result.default;throw K._result}var ce={current:null},re={transition:null},Ie={ReactCurrentDispatcher:ce,ReactCurrentBatchConfig:re,ReactCurrentOwner:Ee};function xe(){throw Error("act(...) is not supported in production builds of React.")}return mt.Children={map:Ge,forEach:function(K,A,W){Ge(K,function(){A.apply(this,arguments)},W)},count:function(K){var A=0;return Ge(K,function(){A++}),A},toArray:function(K){return Ge(K,function(A){return A})||[]},only:function(K){if(!O(K))throw Error("React.Children.only expected to receive a single React element child.");return K}},mt.Component=V,mt.Fragment=t,mt.Profiler=a,mt.PureComponent=be,mt.StrictMode=s,mt.Suspense=m,mt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ie,mt.act=xe,mt.cloneElement=function(K,A,W){if(K==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+K+".");var ye=Y({},K.props),De=K.key,je=K.ref,Me=K._owner;if(A!=null){if(A.ref!==void 0&&(je=A.ref,Me=Ee.current),A.key!==void 0&&(De=""+A.key),K.type&&K.type.defaultProps)var ae=K.type.defaultProps;for(ze in A)ie.call(A,ze)&&!D.hasOwnProperty(ze)&&(ye[ze]=A[ze]===void 0&&ae!==void 0?ae[ze]:A[ze])}var ze=arguments.length-2;if(ze===1)ye.children=W;else if(1<ze){ae=Array(ze);for(var Je=0;Je<ze;Je++)ae[Je]=arguments[Je+2];ye.children=ae}return{$$typeof:n,type:K.type,key:De,ref:je,props:ye,_owner:Me}},mt.createContext=function(K){return K={$$typeof:d,_currentValue:K,_currentValue2:K,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},K.Provider={$$typeof:c,_context:K},K.Consumer=K},mt.createElement=N,mt.createFactory=function(K){var A=N.bind(null,K);return A.type=K,A},mt.createRef=function(){return{current:null}},mt.forwardRef=function(K){return{$$typeof:f,render:K}},mt.isValidElement=O,mt.lazy=function(K){return{$$typeof:x,_payload:{_status:-1,_result:K},_init:Re}},mt.memo=function(K,A){return{$$typeof:v,type:K,compare:A===void 0?null:A}},mt.startTransition=function(K){var A=re.transition;re.transition={};try{K()}finally{re.transition=A}},mt.unstable_act=xe,mt.useCallback=function(K,A){return ce.current.useCallback(K,A)},mt.useContext=function(K){return ce.current.useContext(K)},mt.useDebugValue=function(){},mt.useDeferredValue=function(K){return ce.current.useDeferredValue(K)},mt.useEffect=function(K,A){return ce.current.useEffect(K,A)},mt.useId=function(){return ce.current.useId()},mt.useImperativeHandle=function(K,A,W){return ce.current.useImperativeHandle(K,A,W)},mt.useInsertionEffect=function(K,A){return ce.current.useInsertionEffect(K,A)},mt.useLayoutEffect=function(K,A){return ce.current.useLayoutEffect(K,A)},mt.useMemo=function(K,A){return ce.current.useMemo(K,A)},mt.useReducer=function(K,A,W){return ce.current.useReducer(K,A,W)},mt.useRef=function(K){return ce.current.useRef(K)},mt.useState=function(K){return ce.current.useState(K)},mt.useSyncExternalStore=function(K,A,W){return ce.current.useSyncExternalStore(K,A,W)},mt.useTransition=function(){return ce.current.useTransition()},mt.version="18.3.1",mt}var hy;function Xf(){return hy||(hy=1,Zh.exports=xE()),Zh.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fy;function wE(){if(fy)return Il;fy=1;var n=Xf(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,a=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function d(f,m,v){var x,S={},b=null,M=null;v!==void 0&&(b=""+v),m.key!==void 0&&(b=""+m.key),m.ref!==void 0&&(M=m.ref);for(x in m)s.call(m,x)&&!c.hasOwnProperty(x)&&(S[x]=m[x]);if(f&&f.defaultProps)for(x in m=f.defaultProps,m)S[x]===void 0&&(S[x]=m[x]);return{$$typeof:e,type:f,key:b,ref:M,props:S,_owner:a.current}}return Il.Fragment=t,Il.jsx=d,Il.jsxs=d,Il}var py;function EE(){return py||(py=1,Xh.exports=wE()),Xh.exports}var o=EE(),R=Xf();const Zf=b_(R),TE=_E({__proto__:null,default:Zf},[R]);var mu={},ef={exports:{}},Er={},tf={exports:{}},nf={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var my;function SE(){return my||(my=1,(function(n){function e(re,Ie){var xe=re.length;re.push(Ie);e:for(;0<xe;){var K=xe-1>>>1,A=re[K];if(0<a(A,Ie))re[K]=Ie,re[xe]=A,xe=K;else break e}}function t(re){return re.length===0?null:re[0]}function s(re){if(re.length===0)return null;var Ie=re[0],xe=re.pop();if(xe!==Ie){re[0]=xe;e:for(var K=0,A=re.length,W=A>>>1;K<W;){var ye=2*(K+1)-1,De=re[ye],je=ye+1,Me=re[je];if(0>a(De,xe))je<A&&0>a(Me,De)?(re[K]=Me,re[je]=xe,K=je):(re[K]=De,re[ye]=xe,K=ye);else if(je<A&&0>a(Me,xe))re[K]=Me,re[je]=xe,K=je;else break e}}return Ie}function a(re,Ie){var xe=re.sortIndex-Ie.sortIndex;return xe!==0?xe:re.id-Ie.id}if(typeof performance=="object"&&typeof performance.now=="function"){var c=performance;n.unstable_now=function(){return c.now()}}else{var d=Date,f=d.now();n.unstable_now=function(){return d.now()-f}}var m=[],v=[],x=1,S=null,b=3,M=!1,Y=!1,z=!1,V=typeof setTimeout=="function"?setTimeout:null,te=typeof clearTimeout=="function"?clearTimeout:null,be=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function we(re){for(var Ie=t(v);Ie!==null;){if(Ie.callback===null)s(v);else if(Ie.startTime<=re)s(v),Ie.sortIndex=Ie.expirationTime,e(m,Ie);else break;Ie=t(v)}}function ge(re){if(z=!1,we(re),!Y)if(t(m)!==null)Y=!0,Re(ie);else{var Ie=t(v);Ie!==null&&ce(ge,Ie.startTime-re)}}function ie(re,Ie){Y=!1,z&&(z=!1,te(N),N=-1),M=!0;var xe=b;try{for(we(Ie),S=t(m);S!==null&&(!(S.expirationTime>Ie)||re&&!G());){var K=S.callback;if(typeof K=="function"){S.callback=null,b=S.priorityLevel;var A=K(S.expirationTime<=Ie);Ie=n.unstable_now(),typeof A=="function"?S.callback=A:S===t(m)&&s(m),we(Ie)}else s(m);S=t(m)}if(S!==null)var W=!0;else{var ye=t(v);ye!==null&&ce(ge,ye.startTime-Ie),W=!1}return W}finally{S=null,b=xe,M=!1}}var Ee=!1,D=null,N=-1,C=5,O=-1;function G(){return!(n.unstable_now()-O<C)}function k(){if(D!==null){var re=n.unstable_now();O=re;var Ie=!0;try{Ie=D(!0,re)}finally{Ie?P():(Ee=!1,D=null)}}else Ee=!1}var P;if(typeof be=="function")P=function(){be(k)};else if(typeof MessageChannel<"u"){var ve=new MessageChannel,Ge=ve.port2;ve.port1.onmessage=k,P=function(){Ge.postMessage(null)}}else P=function(){V(k,0)};function Re(re){D=re,Ee||(Ee=!0,P())}function ce(re,Ie){N=V(function(){re(n.unstable_now())},Ie)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(re){re.callback=null},n.unstable_continueExecution=function(){Y||M||(Y=!0,Re(ie))},n.unstable_forceFrameRate=function(re){0>re||125<re?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<re?Math.floor(1e3/re):5},n.unstable_getCurrentPriorityLevel=function(){return b},n.unstable_getFirstCallbackNode=function(){return t(m)},n.unstable_next=function(re){switch(b){case 1:case 2:case 3:var Ie=3;break;default:Ie=b}var xe=b;b=Ie;try{return re()}finally{b=xe}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(re,Ie){switch(re){case 1:case 2:case 3:case 4:case 5:break;default:re=3}var xe=b;b=re;try{return Ie()}finally{b=xe}},n.unstable_scheduleCallback=function(re,Ie,xe){var K=n.unstable_now();switch(typeof xe=="object"&&xe!==null?(xe=xe.delay,xe=typeof xe=="number"&&0<xe?K+xe:K):xe=K,re){case 1:var A=-1;break;case 2:A=250;break;case 5:A=1073741823;break;case 4:A=1e4;break;default:A=5e3}return A=xe+A,re={id:x++,callback:Ie,priorityLevel:re,startTime:xe,expirationTime:A,sortIndex:-1},xe>K?(re.sortIndex=xe,e(v,re),t(m)===null&&re===t(v)&&(z?(te(N),N=-1):z=!0,ce(ge,xe-K))):(re.sortIndex=A,e(m,re),Y||M||(Y=!0,Re(ie))),re},n.unstable_shouldYield=G,n.unstable_wrapCallback=function(re){var Ie=b;return function(){var xe=b;b=Ie;try{return re.apply(this,arguments)}finally{b=xe}}}})(nf)),nf}var gy;function bE(){return gy||(gy=1,tf.exports=SE()),tf.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yy;function IE(){if(yy)return Er;yy=1;var n=Xf(),e=bE();function t(r){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+r,l=1;l<arguments.length;l++)i+="&args[]="+encodeURIComponent(arguments[l]);return"Minified React error #"+r+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,a={};function c(r,i){d(r,i),d(r+"Capture",i)}function d(r,i){for(a[r]=i,r=0;r<i.length;r++)s.add(i[r])}var f=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),m=Object.prototype.hasOwnProperty,v=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,x={},S={};function b(r){return m.call(S,r)?!0:m.call(x,r)?!1:v.test(r)?S[r]=!0:(x[r]=!0,!1)}function M(r,i,l,h){if(l!==null&&l.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return h?!1:l!==null?!l.acceptsBooleans:(r=r.toLowerCase().slice(0,5),r!=="data-"&&r!=="aria-");default:return!1}}function Y(r,i,l,h){if(i===null||typeof i>"u"||M(r,i,l,h))return!0;if(h)return!1;if(l!==null)switch(l.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function z(r,i,l,h,p,y,E){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=h,this.attributeNamespace=p,this.mustUseProperty=l,this.propertyName=r,this.type=i,this.sanitizeURL=y,this.removeEmptyString=E}var V={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(r){V[r]=new z(r,0,!1,r,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(r){var i=r[0];V[i]=new z(i,1,!1,r[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(r){V[r]=new z(r,2,!1,r.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(r){V[r]=new z(r,2,!1,r,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(r){V[r]=new z(r,3,!1,r.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(r){V[r]=new z(r,3,!0,r,null,!1,!1)}),["capture","download"].forEach(function(r){V[r]=new z(r,4,!1,r,null,!1,!1)}),["cols","rows","size","span"].forEach(function(r){V[r]=new z(r,6,!1,r,null,!1,!1)}),["rowSpan","start"].forEach(function(r){V[r]=new z(r,5,!1,r.toLowerCase(),null,!1,!1)});var te=/[\-:]([a-z])/g;function be(r){return r[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(r){var i=r.replace(te,be);V[i]=new z(i,1,!1,r,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(r){var i=r.replace(te,be);V[i]=new z(i,1,!1,r,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(r){var i=r.replace(te,be);V[i]=new z(i,1,!1,r,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(r){V[r]=new z(r,1,!1,r.toLowerCase(),null,!1,!1)}),V.xlinkHref=new z("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(r){V[r]=new z(r,1,!1,r.toLowerCase(),null,!0,!0)});function we(r,i,l,h){var p=V.hasOwnProperty(i)?V[i]:null;(p!==null?p.type!==0:h||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(Y(i,l,p,h)&&(l=null),h||p===null?b(i)&&(l===null?r.removeAttribute(i):r.setAttribute(i,""+l)):p.mustUseProperty?r[p.propertyName]=l===null?p.type===3?!1:"":l:(i=p.attributeName,h=p.attributeNamespace,l===null?r.removeAttribute(i):(p=p.type,l=p===3||p===4&&l===!0?"":""+l,h?r.setAttributeNS(h,i,l):r.setAttribute(i,l))))}var ge=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ie=Symbol.for("react.element"),Ee=Symbol.for("react.portal"),D=Symbol.for("react.fragment"),N=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),O=Symbol.for("react.provider"),G=Symbol.for("react.context"),k=Symbol.for("react.forward_ref"),P=Symbol.for("react.suspense"),ve=Symbol.for("react.suspense_list"),Ge=Symbol.for("react.memo"),Re=Symbol.for("react.lazy"),ce=Symbol.for("react.offscreen"),re=Symbol.iterator;function Ie(r){return r===null||typeof r!="object"?null:(r=re&&r[re]||r["@@iterator"],typeof r=="function"?r:null)}var xe=Object.assign,K;function A(r){if(K===void 0)try{throw Error()}catch(l){var i=l.stack.trim().match(/\n( *(at )?)/);K=i&&i[1]||""}return`
`+K+r}var W=!1;function ye(r,i){if(!r||W)return"";W=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(ee){var h=ee}Reflect.construct(r,[],i)}else{try{i.call()}catch(ee){h=ee}r.call(i.prototype)}else{try{throw Error()}catch(ee){h=ee}r()}}catch(ee){if(ee&&h&&typeof ee.stack=="string"){for(var p=ee.stack.split(`
`),y=h.stack.split(`
`),E=p.length-1,j=y.length-1;1<=E&&0<=j&&p[E]!==y[j];)j--;for(;1<=E&&0<=j;E--,j--)if(p[E]!==y[j]){if(E!==1||j!==1)do if(E--,j--,0>j||p[E]!==y[j]){var U=`
`+p[E].replace(" at new "," at ");return r.displayName&&U.includes("<anonymous>")&&(U=U.replace("<anonymous>",r.displayName)),U}while(1<=E&&0<=j);break}}}finally{W=!1,Error.prepareStackTrace=l}return(r=r?r.displayName||r.name:"")?A(r):""}function De(r){switch(r.tag){case 5:return A(r.type);case 16:return A("Lazy");case 13:return A("Suspense");case 19:return A("SuspenseList");case 0:case 2:case 15:return r=ye(r.type,!1),r;case 11:return r=ye(r.type.render,!1),r;case 1:return r=ye(r.type,!0),r;default:return""}}function je(r){if(r==null)return null;if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case D:return"Fragment";case Ee:return"Portal";case C:return"Profiler";case N:return"StrictMode";case P:return"Suspense";case ve:return"SuspenseList"}if(typeof r=="object")switch(r.$$typeof){case G:return(r.displayName||"Context")+".Consumer";case O:return(r._context.displayName||"Context")+".Provider";case k:var i=r.render;return r=r.displayName,r||(r=i.displayName||i.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case Ge:return i=r.displayName||null,i!==null?i:je(r.type)||"Memo";case Re:i=r._payload,r=r._init;try{return je(r(i))}catch{}}return null}function Me(r){var i=r.type;switch(r.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return r=i.render,r=r.displayName||r.name||"",i.displayName||(r!==""?"ForwardRef("+r+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return je(i);case 8:return i===N?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function ae(r){switch(typeof r){case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function ze(r){var i=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function Je(r){var i=ze(r)?"checked":"value",l=Object.getOwnPropertyDescriptor(r.constructor.prototype,i),h=""+r[i];if(!r.hasOwnProperty(i)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var p=l.get,y=l.set;return Object.defineProperty(r,i,{configurable:!0,get:function(){return p.call(this)},set:function(E){h=""+E,y.call(this,E)}}),Object.defineProperty(r,i,{enumerable:l.enumerable}),{getValue:function(){return h},setValue:function(E){h=""+E},stopTracking:function(){r._valueTracker=null,delete r[i]}}}}function pe(r){r._valueTracker||(r._valueTracker=Je(r))}function Be(r){if(!r)return!1;var i=r._valueTracker;if(!i)return!0;var l=i.getValue(),h="";return r&&(h=ze(r)?r.checked?"true":"false":r.value),r=h,r!==l?(i.setValue(r),!0):!1}function he(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}function Qe(r,i){var l=i.checked;return xe({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:l??r._wrapperState.initialChecked})}function Ye(r,i){var l=i.defaultValue==null?"":i.defaultValue,h=i.checked!=null?i.checked:i.defaultChecked;l=ae(i.value!=null?i.value:l),r._wrapperState={initialChecked:h,initialValue:l,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function _t(r,i){i=i.checked,i!=null&&we(r,"checked",i,!1)}function Nt(r,i){_t(r,i);var l=ae(i.value),h=i.type;if(l!=null)h==="number"?(l===0&&r.value===""||r.value!=l)&&(r.value=""+l):r.value!==""+l&&(r.value=""+l);else if(h==="submit"||h==="reset"){r.removeAttribute("value");return}i.hasOwnProperty("value")?Ct(r,i.type,l):i.hasOwnProperty("defaultValue")&&Ct(r,i.type,ae(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(r.defaultChecked=!!i.defaultChecked)}function xt(r,i,l){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var h=i.type;if(!(h!=="submit"&&h!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+r._wrapperState.initialValue,l||i===r.value||(r.value=i),r.defaultValue=i}l=r.name,l!==""&&(r.name=""),r.defaultChecked=!!r._wrapperState.initialChecked,l!==""&&(r.name=l)}function Ct(r,i,l){(i!=="number"||he(r.ownerDocument)!==r)&&(l==null?r.defaultValue=""+r._wrapperState.initialValue:r.defaultValue!==""+l&&(r.defaultValue=""+l))}var en=Array.isArray;function mn(r,i,l,h){if(r=r.options,i){i={};for(var p=0;p<l.length;p++)i["$"+l[p]]=!0;for(l=0;l<r.length;l++)p=i.hasOwnProperty("$"+r[l].value),r[l].selected!==p&&(r[l].selected=p),p&&h&&(r[l].defaultSelected=!0)}else{for(l=""+ae(l),i=null,p=0;p<r.length;p++){if(r[p].value===l){r[p].selected=!0,h&&(r[p].defaultSelected=!0);return}i!==null||r[p].disabled||(i=r[p])}i!==null&&(i.selected=!0)}}function ln(r,i){if(i.dangerouslySetInnerHTML!=null)throw Error(t(91));return xe({},i,{value:void 0,defaultValue:void 0,children:""+r._wrapperState.initialValue})}function fr(r,i){var l=i.value;if(l==null){if(l=i.children,i=i.defaultValue,l!=null){if(i!=null)throw Error(t(92));if(en(l)){if(1<l.length)throw Error(t(93));l=l[0]}i=l}i==null&&(i=""),l=i}r._wrapperState={initialValue:ae(l)}}function tn(r,i){var l=ae(i.value),h=ae(i.defaultValue);l!=null&&(l=""+l,l!==r.value&&(r.value=l),i.defaultValue==null&&r.defaultValue!==l&&(r.defaultValue=l)),h!=null&&(r.defaultValue=""+h)}function Kn(r){var i=r.textContent;i===r._wrapperState.initialValue&&i!==""&&i!==null&&(r.value=i)}function Ot(r){switch(r){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function $t(r,i){return r==null||r==="http://www.w3.org/1999/xhtml"?Ot(i):r==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":r}var On,lr=(function(r){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,l,h,p){MSApp.execUnsafeLocalFunction(function(){return r(i,l,h,p)})}:r})(function(r,i){if(r.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in r)r.innerHTML=i;else{for(On=On||document.createElement("div"),On.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=On.firstChild;r.firstChild;)r.removeChild(r.firstChild);for(;i.firstChild;)r.appendChild(i.firstChild)}});function In(r,i){if(i){var l=r.firstChild;if(l&&l===r.lastChild&&l.nodeType===3){l.nodeValue=i;return}}r.textContent=i}var Fn={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Qt=["Webkit","ms","Moz","O"];Object.keys(Fn).forEach(function(r){Qt.forEach(function(i){i=i+r.charAt(0).toUpperCase()+r.substring(1),Fn[i]=Fn[r]})});function es(r,i,l){return i==null||typeof i=="boolean"||i===""?"":l||typeof i!="number"||i===0||Fn.hasOwnProperty(r)&&Fn[r]?(""+i).trim():i+"px"}function Cn(r,i){r=r.style;for(var l in i)if(i.hasOwnProperty(l)){var h=l.indexOf("--")===0,p=es(l,i[l],h);l==="float"&&(l="cssFloat"),h?r.setProperty(l,p):r[l]=p}}var gn=xe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ts(r,i){if(i){if(gn[r]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(t(137,r));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(t(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(t(61))}if(i.style!=null&&typeof i.style!="object")throw Error(t(62))}}function Ts(r,i){if(r.indexOf("-")===-1)return typeof i.is=="string";switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Pt=null;function pr(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Ss=null,Qn=null,Yn=null;function Cr(r){if(r=dl(r)){if(typeof Ss!="function")throw Error(t(280));var i=r.stateNode;i&&(i=Rc(i),Ss(r.stateNode,r.type,i))}}function Pn(r){Qn?Yn?Yn.push(r):Yn=[r]:Qn=r}function Pr(){if(Qn){var r=Qn,i=Yn;if(Yn=Qn=null,Cr(r),i)for(r=0;r<i.length;r++)Cr(i[r])}}function Jn(r,i){return r(i)}function Ws(){}var mr=!1;function Gs(r,i,l){if(mr)return r(i,l);mr=!0;try{return Jn(r,i,l)}finally{mr=!1,(Qn!==null||Yn!==null)&&(Ws(),Pr())}}function rt(r,i){var l=r.stateNode;if(l===null)return null;var h=Rc(l);if(h===null)return null;l=h[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(r=r.type,h=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!h;break e;default:r=!1}if(r)return null;if(l&&typeof l!="function")throw Error(t(231,i,typeof l));return l}var Xn=!1;if(f)try{var Nn={};Object.defineProperty(Nn,"passive",{get:function(){Xn=!0}}),window.addEventListener("test",Nn,Nn),window.removeEventListener("test",Nn,Nn)}catch{Xn=!1}function ns(r,i,l,h,p,y,E,j,U){var ee=Array.prototype.slice.call(arguments,3);try{i.apply(l,ee)}catch(_e){this.onError(_e)}}var Rn=!1,yn=null,An=!1,bs=null,Is={onError:function(r){Rn=!0,yn=r}};function Un(r,i,l,h,p,y,E,j,U){Rn=!1,yn=null,ns.apply(Is,arguments)}function Fr(r,i,l,h,p,y,E,j,U){if(Un.apply(this,arguments),Rn){if(Rn){var ee=yn;Rn=!1,yn=null}else throw Error(t(198));An||(An=!0,bs=ee)}}function Ft(r){var i=r,l=r;if(r.alternate)for(;i.return;)i=i.return;else{r=i;do i=r,(i.flags&4098)!==0&&(l=i.return),r=i.return;while(r)}return i.tag===3?l:null}function rs(r){if(r.tag===13){var i=r.memoizedState;if(i===null&&(r=r.alternate,r!==null&&(i=r.memoizedState)),i!==null)return i.dehydrated}return null}function cn(r){if(Ft(r)!==r)throw Error(t(188))}function Nr(r){var i=r.alternate;if(!i){if(i=Ft(r),i===null)throw Error(t(188));return i!==r?null:r}for(var l=r,h=i;;){var p=l.return;if(p===null)break;var y=p.alternate;if(y===null){if(h=p.return,h!==null){l=h;continue}break}if(p.child===y.child){for(y=p.child;y;){if(y===l)return cn(p),r;if(y===h)return cn(p),i;y=y.sibling}throw Error(t(188))}if(l.return!==h.return)l=p,h=y;else{for(var E=!1,j=p.child;j;){if(j===l){E=!0,l=p,h=y;break}if(j===h){E=!0,h=p,l=y;break}j=j.sibling}if(!E){for(j=y.child;j;){if(j===l){E=!0,l=y,h=p;break}if(j===h){E=!0,h=y,l=p;break}j=j.sibling}if(!E)throw Error(t(189))}}if(l.alternate!==h)throw Error(t(190))}if(l.tag!==3)throw Error(t(188));return l.stateNode.current===l?r:i}function qs(r){return r=Nr(r),r!==null?Ur(r):null}function Ur(r){if(r.tag===5||r.tag===6)return r;for(r=r.child;r!==null;){var i=Ur(r);if(i!==null)return i;r=r.sibling}return null}var ss=e.unstable_scheduleCallback,vn=e.unstable_cancelCallback,Hs=e.unstable_shouldYield,Ks=e.unstable_requestPaint,dt=e.unstable_now,is=e.unstable_getCurrentPriorityLevel,jn=e.unstable_ImmediatePriority,w=e.unstable_UserBlockingPriority,B=e.unstable_NormalPriority,$=e.unstable_LowPriority,L=e.unstable_IdlePriority,q=null,oe=null;function se(r){if(oe&&typeof oe.onCommitFiberRoot=="function")try{oe.onCommitFiberRoot(q,r,void 0,(r.current.flags&128)===128)}catch{}}var Ce=Math.clz32?Math.clz32:le,Pe=Math.log,ke=Math.LN2;function le(r){return r>>>=0,r===0?32:31-(Pe(r)/ke|0)|0}var ot=64,Le=4194304;function ht(r){switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return r&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return r}}function cr(r,i){var l=r.pendingLanes;if(l===0)return 0;var h=0,p=r.suspendedLanes,y=r.pingedLanes,E=l&268435455;if(E!==0){var j=E&~p;j!==0?h=ht(j):(y&=E,y!==0&&(h=ht(y)))}else E=l&~p,E!==0?h=ht(E):y!==0&&(h=ht(y));if(h===0)return 0;if(i!==0&&i!==h&&(i&p)===0&&(p=h&-h,y=i&-i,p>=y||p===16&&(y&4194240)!==0))return i;if((h&4)!==0&&(h|=l&16),i=r.entangledLanes,i!==0)for(r=r.entanglements,i&=h;0<i;)l=31-Ce(i),p=1<<l,h|=r[l],i&=~p;return h}function Qs(r,i){switch(r){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _n(r,i){for(var l=r.suspendedLanes,h=r.pingedLanes,p=r.expirationTimes,y=r.pendingLanes;0<y;){var E=31-Ce(y),j=1<<E,U=p[E];U===-1?((j&l)===0||(j&h)!==0)&&(p[E]=Qs(j,i)):U<=i&&(r.expiredLanes|=j),y&=~j}}function Yt(r){return r=r.pendingLanes&-1073741825,r!==0?r:r&1073741824?1073741824:0}function as(){var r=ot;return ot<<=1,(ot&4194240)===0&&(ot=64),r}function os(r){for(var i=[],l=0;31>l;l++)i.push(r);return i}function ls(r,i,l){r.pendingLanes|=i,i!==536870912&&(r.suspendedLanes=0,r.pingedLanes=0),r=r.eventTimes,i=31-Ce(i),r[i]=l}function Rt(r,i){var l=r.pendingLanes&~i;r.pendingLanes=i,r.suspendedLanes=0,r.pingedLanes=0,r.expiredLanes&=i,r.mutableReadLanes&=i,r.entangledLanes&=i,i=r.entanglements;var h=r.eventTimes;for(r=r.expirationTimes;0<l;){var p=31-Ce(l),y=1<<p;i[p]=0,h[p]=-1,r[p]=-1,l&=~y}}function Cs(r,i){var l=r.entangledLanes|=i;for(r=r.entanglements;l;){var h=31-Ce(l),p=1<<h;p&i|r[h]&i&&(r[h]|=i),l&=~p}}var pt=0;function Ps(r){return r&=-r,1<r?4<r?(r&268435455)!==0?16:536870912:4:1}var T,F,Q,ue,Te,qe=!1,Ne=[],Xe=null,ut=null,gt=null,Lt=new Map,St=new Map,nn=[],xn="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function wt(r,i){switch(r){case"focusin":case"focusout":Xe=null;break;case"dragenter":case"dragleave":ut=null;break;case"mouseover":case"mouseout":gt=null;break;case"pointerover":case"pointerout":Lt.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":St.delete(i.pointerId)}}function rn(r,i,l,h,p,y){return r===null||r.nativeEvent!==y?(r={blockedOn:i,domEventName:l,eventSystemFlags:h,nativeEvent:y,targetContainers:[p]},i!==null&&(i=dl(i),i!==null&&F(i)),r):(r.eventSystemFlags|=h,i=r.targetContainers,p!==null&&i.indexOf(p)===-1&&i.push(p),r)}function Zn(r,i,l,h,p){switch(i){case"focusin":return Xe=rn(Xe,r,i,l,h,p),!0;case"dragenter":return ut=rn(ut,r,i,l,h,p),!0;case"mouseover":return gt=rn(gt,r,i,l,h,p),!0;case"pointerover":var y=p.pointerId;return Lt.set(y,rn(Lt.get(y)||null,r,i,l,h,p)),!0;case"gotpointercapture":return y=p.pointerId,St.set(y,rn(St.get(y)||null,r,i,l,h,p)),!0}return!1}function zr(r){var i=fa(r.target);if(i!==null){var l=Ft(i);if(l!==null){if(i=l.tag,i===13){if(i=rs(l),i!==null){r.blockedOn=i,Te(r.priority,function(){Q(l)});return}}else if(i===3&&l.stateNode.current.memoizedState.isDehydrated){r.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Rr(r){if(r.blockedOn!==null)return!1;for(var i=r.targetContainers;0<i.length;){var l=$a(r.domEventName,r.eventSystemFlags,i[0],r.nativeEvent);if(l===null){l=r.nativeEvent;var h=new l.constructor(l.type,l);Pt=h,l.target.dispatchEvent(h),Pt=null}else return i=dl(l),i!==null&&F(i),r.blockedOn=l,!1;i.shift()}return!0}function Ys(r,i,l){Rr(r)&&l.delete(i)}function Ba(){qe=!1,Xe!==null&&Rr(Xe)&&(Xe=null),ut!==null&&Rr(ut)&&(ut=null),gt!==null&&Rr(gt)&&(gt=null),Lt.forEach(Ys),St.forEach(Ys)}function Ar(r,i){r.blockedOn===i&&(r.blockedOn=null,qe||(qe=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Ba)))}function zn(r){function i(p){return Ar(p,r)}if(0<Ne.length){Ar(Ne[0],r);for(var l=1;l<Ne.length;l++){var h=Ne[l];h.blockedOn===r&&(h.blockedOn=null)}}for(Xe!==null&&Ar(Xe,r),ut!==null&&Ar(ut,r),gt!==null&&Ar(gt,r),Lt.forEach(i),St.forEach(i),l=0;l<nn.length;l++)h=nn[l],h.blockedOn===r&&(h.blockedOn=null);for(;0<nn.length&&(l=nn[0],l.blockedOn===null);)zr(l),l.blockedOn===null&&nn.shift()}var cs=ge.ReactCurrentBatchConfig,wi=!0;function Wt(r,i,l,h){var p=pt,y=cs.transition;cs.transition=null;try{pt=1,Jo(r,i,l,h)}finally{pt=p,cs.transition=y}}function Ad(r,i,l,h){var p=pt,y=cs.transition;cs.transition=null;try{pt=4,Jo(r,i,l,h)}finally{pt=p,cs.transition=y}}function Jo(r,i,l,h){if(wi){var p=$a(r,i,l,h);if(p===null)Bd(r,i,h,ua,l),wt(r,h);else if(Zn(p,r,i,l,h))h.stopPropagation();else if(wt(r,h),i&4&&-1<xn.indexOf(r)){for(;p!==null;){var y=dl(p);if(y!==null&&T(y),y=$a(r,i,l,h),y===null&&Bd(r,i,h,ua,l),y===p)break;p=y}p!==null&&h.stopPropagation()}else Bd(r,i,h,null,l)}}var ua=null;function $a(r,i,l,h){if(ua=null,r=pr(h),r=fa(r),r!==null)if(i=Ft(r),i===null)r=null;else if(l=i.tag,l===13){if(r=rs(i),r!==null)return r;r=null}else if(l===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;r=null}else i!==r&&(r=null);return ua=r,null}function Xo(r){switch(r){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(is()){case jn:return 1;case w:return 4;case B:case $:return 16;case L:return 536870912;default:return 16}default:return 16}}var jr=null,Wa=null,gr=null;function Zo(){if(gr)return gr;var r,i=Wa,l=i.length,h,p="value"in jr?jr.value:jr.textContent,y=p.length;for(r=0;r<l&&i[r]===p[r];r++);var E=l-r;for(h=1;h<=E&&i[l-h]===p[y-h];h++);return gr=p.slice(r,1<h?1-h:void 0)}function Ga(r){var i=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&i===13&&(r=13)):r=i,r===10&&(r=13),32<=r||r===13?r:0}function Ns(){return!0}function el(){return!1}function Bn(r){function i(l,h,p,y,E){this._reactName=l,this._targetInst=p,this.type=h,this.nativeEvent=y,this.target=E,this.currentTarget=null;for(var j in r)r.hasOwnProperty(j)&&(l=r[j],this[j]=l?l(y):y[j]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?Ns:el,this.isPropagationStopped=el,this}return xe(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=Ns)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=Ns)},persist:function(){},isPersistent:Ns}),i}var us={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},qa=Bn(us),Rs=xe({},us,{view:0,detail:0}),jd=Bn(Rs),Ha,Js,Ei,da=xe({},Rs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:As,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Ei&&(Ei&&r.type==="mousemove"?(Ha=r.screenX-Ei.screenX,Js=r.screenY-Ei.screenY):Js=Ha=0,Ei=r),Ha)},movementY:function(r){return"movementY"in r?r.movementY:Js}}),Ka=Bn(da),tl=xe({},da,{dataTransfer:0}),gc=Bn(tl),Qa=xe({},Rs,{relatedTarget:0}),Ya=Bn(Qa),yc=xe({},us,{animationName:0,elapsedTime:0,pseudoElement:0}),Xs=Bn(yc),vc=xe({},us,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),_c=Bn(vc),xc=xe({},us,{data:0}),nl=Bn(xc),Ja={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ur={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},wc={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ec(r){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(r):(r=wc[r])?!!i[r]:!1}function As(){return Ec}var u=xe({},Rs,{key:function(r){if(r.key){var i=Ja[r.key]||r.key;if(i!=="Unidentified")return i}return r.type==="keypress"?(r=Ga(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?ur[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:As,charCode:function(r){return r.type==="keypress"?Ga(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?Ga(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),g=Bn(u),_=xe({},da,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),I=Bn(_),J=xe({},Rs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:As}),ne=Bn(J),Ve=xe({},us,{propertyName:0,elapsedTime:0,pseudoElement:0}),jt=Bn(Ve),wn=xe({},da,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),Et=Bn(wn),kn=[9,13,27,32],un=f&&"CompositionEvent"in window,Br=null;f&&"documentMode"in document&&(Br=document.documentMode);var kr=f&&"TextEvent"in window&&!Br,ha=f&&(!un||Br&&8<Br&&11>=Br),Xa=" ",im=!1;function am(r,i){switch(r){case"keyup":return kn.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function om(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var Za=!1;function gw(r,i){switch(r){case"compositionend":return om(i);case"keypress":return i.which!==32?null:(im=!0,Xa);case"textInput":return r=i.data,r===Xa&&im?null:r;default:return null}}function yw(r,i){if(Za)return r==="compositionend"||!un&&am(r,i)?(r=Zo(),gr=Wa=jr=null,Za=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return ha&&i.locale!=="ko"?null:i.data;default:return null}}var vw={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function lm(r){var i=r&&r.nodeName&&r.nodeName.toLowerCase();return i==="input"?!!vw[r.type]:i==="textarea"}function cm(r,i,l,h){Pn(h),i=Cc(i,"onChange"),0<i.length&&(l=new qa("onChange","change",null,l,h),r.push({event:l,listeners:i}))}var rl=null,sl=null;function _w(r){Cm(r,0)}function Tc(r){var i=so(r);if(Be(i))return r}function xw(r,i){if(r==="change")return i}var um=!1;if(f){var kd;if(f){var Dd="oninput"in document;if(!Dd){var dm=document.createElement("div");dm.setAttribute("oninput","return;"),Dd=typeof dm.oninput=="function"}kd=Dd}else kd=!1;um=kd&&(!document.documentMode||9<document.documentMode)}function hm(){rl&&(rl.detachEvent("onpropertychange",fm),sl=rl=null)}function fm(r){if(r.propertyName==="value"&&Tc(sl)){var i=[];cm(i,sl,r,pr(r)),Gs(_w,i)}}function ww(r,i,l){r==="focusin"?(hm(),rl=i,sl=l,rl.attachEvent("onpropertychange",fm)):r==="focusout"&&hm()}function Ew(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Tc(sl)}function Tw(r,i){if(r==="click")return Tc(i)}function Sw(r,i){if(r==="input"||r==="change")return Tc(i)}function bw(r,i){return r===i&&(r!==0||1/r===1/i)||r!==r&&i!==i}var ds=typeof Object.is=="function"?Object.is:bw;function il(r,i){if(ds(r,i))return!0;if(typeof r!="object"||r===null||typeof i!="object"||i===null)return!1;var l=Object.keys(r),h=Object.keys(i);if(l.length!==h.length)return!1;for(h=0;h<l.length;h++){var p=l[h];if(!m.call(i,p)||!ds(r[p],i[p]))return!1}return!0}function pm(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function mm(r,i){var l=pm(r);r=0;for(var h;l;){if(l.nodeType===3){if(h=r+l.textContent.length,r<=i&&h>=i)return{node:l,offset:i-r};r=h}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=pm(l)}}function gm(r,i){return r&&i?r===i?!0:r&&r.nodeType===3?!1:i&&i.nodeType===3?gm(r,i.parentNode):"contains"in r?r.contains(i):r.compareDocumentPosition?!!(r.compareDocumentPosition(i)&16):!1:!1}function ym(){for(var r=window,i=he();i instanceof r.HTMLIFrameElement;){try{var l=typeof i.contentWindow.location.href=="string"}catch{l=!1}if(l)r=i.contentWindow;else break;i=he(r.document)}return i}function Ld(r){var i=r&&r.nodeName&&r.nodeName.toLowerCase();return i&&(i==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||i==="textarea"||r.contentEditable==="true")}function Iw(r){var i=ym(),l=r.focusedElem,h=r.selectionRange;if(i!==l&&l&&l.ownerDocument&&gm(l.ownerDocument.documentElement,l)){if(h!==null&&Ld(l)){if(i=h.start,r=h.end,r===void 0&&(r=i),"selectionStart"in l)l.selectionStart=i,l.selectionEnd=Math.min(r,l.value.length);else if(r=(i=l.ownerDocument||document)&&i.defaultView||window,r.getSelection){r=r.getSelection();var p=l.textContent.length,y=Math.min(h.start,p);h=h.end===void 0?y:Math.min(h.end,p),!r.extend&&y>h&&(p=h,h=y,y=p),p=mm(l,y);var E=mm(l,h);p&&E&&(r.rangeCount!==1||r.anchorNode!==p.node||r.anchorOffset!==p.offset||r.focusNode!==E.node||r.focusOffset!==E.offset)&&(i=i.createRange(),i.setStart(p.node,p.offset),r.removeAllRanges(),y>h?(r.addRange(i),r.extend(E.node,E.offset)):(i.setEnd(E.node,E.offset),r.addRange(i)))}}for(i=[],r=l;r=r.parentNode;)r.nodeType===1&&i.push({element:r,left:r.scrollLeft,top:r.scrollTop});for(typeof l.focus=="function"&&l.focus(),l=0;l<i.length;l++)r=i[l],r.element.scrollLeft=r.left,r.element.scrollTop=r.top}}var Cw=f&&"documentMode"in document&&11>=document.documentMode,eo=null,Vd=null,al=null,Md=!1;function vm(r,i,l){var h=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Md||eo==null||eo!==he(h)||(h=eo,"selectionStart"in h&&Ld(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),al&&il(al,h)||(al=h,h=Cc(Vd,"onSelect"),0<h.length&&(i=new qa("onSelect","select",null,i,l),r.push({event:i,listeners:h}),i.target=eo)))}function Sc(r,i){var l={};return l[r.toLowerCase()]=i.toLowerCase(),l["Webkit"+r]="webkit"+i,l["Moz"+r]="moz"+i,l}var to={animationend:Sc("Animation","AnimationEnd"),animationiteration:Sc("Animation","AnimationIteration"),animationstart:Sc("Animation","AnimationStart"),transitionend:Sc("Transition","TransitionEnd")},Od={},_m={};f&&(_m=document.createElement("div").style,"AnimationEvent"in window||(delete to.animationend.animation,delete to.animationiteration.animation,delete to.animationstart.animation),"TransitionEvent"in window||delete to.transitionend.transition);function bc(r){if(Od[r])return Od[r];if(!to[r])return r;var i=to[r],l;for(l in i)if(i.hasOwnProperty(l)&&l in _m)return Od[r]=i[l];return r}var xm=bc("animationend"),wm=bc("animationiteration"),Em=bc("animationstart"),Tm=bc("transitionend"),Sm=new Map,bm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ti(r,i){Sm.set(r,i),c(i,[r])}for(var Fd=0;Fd<bm.length;Fd++){var Ud=bm[Fd],Pw=Ud.toLowerCase(),Nw=Ud[0].toUpperCase()+Ud.slice(1);Ti(Pw,"on"+Nw)}Ti(xm,"onAnimationEnd"),Ti(wm,"onAnimationIteration"),Ti(Em,"onAnimationStart"),Ti("dblclick","onDoubleClick"),Ti("focusin","onFocus"),Ti("focusout","onBlur"),Ti(Tm,"onTransitionEnd"),d("onMouseEnter",["mouseout","mouseover"]),d("onMouseLeave",["mouseout","mouseover"]),d("onPointerEnter",["pointerout","pointerover"]),d("onPointerLeave",["pointerout","pointerover"]),c("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),c("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),c("onBeforeInput",["compositionend","keypress","textInput","paste"]),c("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ol="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Rw=new Set("cancel close invalid load scroll toggle".split(" ").concat(ol));function Im(r,i,l){var h=r.type||"unknown-event";r.currentTarget=l,Fr(h,i,void 0,r),r.currentTarget=null}function Cm(r,i){i=(i&4)!==0;for(var l=0;l<r.length;l++){var h=r[l],p=h.event;h=h.listeners;e:{var y=void 0;if(i)for(var E=h.length-1;0<=E;E--){var j=h[E],U=j.instance,ee=j.currentTarget;if(j=j.listener,U!==y&&p.isPropagationStopped())break e;Im(p,j,ee),y=U}else for(E=0;E<h.length;E++){if(j=h[E],U=j.instance,ee=j.currentTarget,j=j.listener,U!==y&&p.isPropagationStopped())break e;Im(p,j,ee),y=U}}}if(An)throw r=bs,An=!1,bs=null,r}function Ut(r,i){var l=i[Kd];l===void 0&&(l=i[Kd]=new Set);var h=r+"__bubble";l.has(h)||(Pm(i,r,2,!1),l.add(h))}function zd(r,i,l){var h=0;i&&(h|=4),Pm(l,r,h,i)}var Ic="_reactListening"+Math.random().toString(36).slice(2);function ll(r){if(!r[Ic]){r[Ic]=!0,s.forEach(function(l){l!=="selectionchange"&&(Rw.has(l)||zd(l,!1,r),zd(l,!0,r))});var i=r.nodeType===9?r:r.ownerDocument;i===null||i[Ic]||(i[Ic]=!0,zd("selectionchange",!1,i))}}function Pm(r,i,l,h){switch(Xo(i)){case 1:var p=Wt;break;case 4:p=Ad;break;default:p=Jo}l=p.bind(null,i,l,r),p=void 0,!Xn||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(p=!0),h?p!==void 0?r.addEventListener(i,l,{capture:!0,passive:p}):r.addEventListener(i,l,!0):p!==void 0?r.addEventListener(i,l,{passive:p}):r.addEventListener(i,l,!1)}function Bd(r,i,l,h,p){var y=h;if((i&1)===0&&(i&2)===0&&h!==null)e:for(;;){if(h===null)return;var E=h.tag;if(E===3||E===4){var j=h.stateNode.containerInfo;if(j===p||j.nodeType===8&&j.parentNode===p)break;if(E===4)for(E=h.return;E!==null;){var U=E.tag;if((U===3||U===4)&&(U=E.stateNode.containerInfo,U===p||U.nodeType===8&&U.parentNode===p))return;E=E.return}for(;j!==null;){if(E=fa(j),E===null)return;if(U=E.tag,U===5||U===6){h=y=E;continue e}j=j.parentNode}}h=h.return}Gs(function(){var ee=y,_e=pr(l),Se=[];e:{var me=Sm.get(r);if(me!==void 0){var Fe=qa,We=r;switch(r){case"keypress":if(Ga(l)===0)break e;case"keydown":case"keyup":Fe=g;break;case"focusin":We="focus",Fe=Ya;break;case"focusout":We="blur",Fe=Ya;break;case"beforeblur":case"afterblur":Fe=Ya;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Fe=Ka;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Fe=gc;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Fe=ne;break;case xm:case wm:case Em:Fe=Xs;break;case Tm:Fe=jt;break;case"scroll":Fe=jd;break;case"wheel":Fe=Et;break;case"copy":case"cut":case"paste":Fe=_c;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Fe=I}var He=(i&4)!==0,sn=!He&&r==="scroll",X=He?me!==null?me+"Capture":null:me;He=[];for(var H=ee,Z;H!==null;){Z=H;var Ae=Z.stateNode;if(Z.tag===5&&Ae!==null&&(Z=Ae,X!==null&&(Ae=rt(H,X),Ae!=null&&He.push(cl(H,Ae,Z)))),sn)break;H=H.return}0<He.length&&(me=new Fe(me,We,null,l,_e),Se.push({event:me,listeners:He}))}}if((i&7)===0){e:{if(me=r==="mouseover"||r==="pointerover",Fe=r==="mouseout"||r==="pointerout",me&&l!==Pt&&(We=l.relatedTarget||l.fromElement)&&(fa(We)||We[Zs]))break e;if((Fe||me)&&(me=_e.window===_e?_e:(me=_e.ownerDocument)?me.defaultView||me.parentWindow:window,Fe?(We=l.relatedTarget||l.toElement,Fe=ee,We=We?fa(We):null,We!==null&&(sn=Ft(We),We!==sn||We.tag!==5&&We.tag!==6)&&(We=null)):(Fe=null,We=ee),Fe!==We)){if(He=Ka,Ae="onMouseLeave",X="onMouseEnter",H="mouse",(r==="pointerout"||r==="pointerover")&&(He=I,Ae="onPointerLeave",X="onPointerEnter",H="pointer"),sn=Fe==null?me:so(Fe),Z=We==null?me:so(We),me=new He(Ae,H+"leave",Fe,l,_e),me.target=sn,me.relatedTarget=Z,Ae=null,fa(_e)===ee&&(He=new He(X,H+"enter",We,l,_e),He.target=Z,He.relatedTarget=sn,Ae=He),sn=Ae,Fe&&We)t:{for(He=Fe,X=We,H=0,Z=He;Z;Z=no(Z))H++;for(Z=0,Ae=X;Ae;Ae=no(Ae))Z++;for(;0<H-Z;)He=no(He),H--;for(;0<Z-H;)X=no(X),Z--;for(;H--;){if(He===X||X!==null&&He===X.alternate)break t;He=no(He),X=no(X)}He=null}else He=null;Fe!==null&&Nm(Se,me,Fe,He,!1),We!==null&&sn!==null&&Nm(Se,sn,We,He,!0)}}e:{if(me=ee?so(ee):window,Fe=me.nodeName&&me.nodeName.toLowerCase(),Fe==="select"||Fe==="input"&&me.type==="file")var Ke=xw;else if(lm(me))if(um)Ke=Sw;else{Ke=Ew;var et=ww}else(Fe=me.nodeName)&&Fe.toLowerCase()==="input"&&(me.type==="checkbox"||me.type==="radio")&&(Ke=Tw);if(Ke&&(Ke=Ke(r,ee))){cm(Se,Ke,l,_e);break e}et&&et(r,me,ee),r==="focusout"&&(et=me._wrapperState)&&et.controlled&&me.type==="number"&&Ct(me,"number",me.value)}switch(et=ee?so(ee):window,r){case"focusin":(lm(et)||et.contentEditable==="true")&&(eo=et,Vd=ee,al=null);break;case"focusout":al=Vd=eo=null;break;case"mousedown":Md=!0;break;case"contextmenu":case"mouseup":case"dragend":Md=!1,vm(Se,l,_e);break;case"selectionchange":if(Cw)break;case"keydown":case"keyup":vm(Se,l,_e)}var tt;if(un)e:{switch(r){case"compositionstart":var it="onCompositionStart";break e;case"compositionend":it="onCompositionEnd";break e;case"compositionupdate":it="onCompositionUpdate";break e}it=void 0}else Za?am(r,l)&&(it="onCompositionEnd"):r==="keydown"&&l.keyCode===229&&(it="onCompositionStart");it&&(ha&&l.locale!=="ko"&&(Za||it!=="onCompositionStart"?it==="onCompositionEnd"&&Za&&(tt=Zo()):(jr=_e,Wa="value"in jr?jr.value:jr.textContent,Za=!0)),et=Cc(ee,it),0<et.length&&(it=new nl(it,r,null,l,_e),Se.push({event:it,listeners:et}),tt?it.data=tt:(tt=om(l),tt!==null&&(it.data=tt)))),(tt=kr?gw(r,l):yw(r,l))&&(ee=Cc(ee,"onBeforeInput"),0<ee.length&&(_e=new nl("onBeforeInput","beforeinput",null,l,_e),Se.push({event:_e,listeners:ee}),_e.data=tt))}Cm(Se,i)})}function cl(r,i,l){return{instance:r,listener:i,currentTarget:l}}function Cc(r,i){for(var l=i+"Capture",h=[];r!==null;){var p=r,y=p.stateNode;p.tag===5&&y!==null&&(p=y,y=rt(r,l),y!=null&&h.unshift(cl(r,y,p)),y=rt(r,i),y!=null&&h.push(cl(r,y,p))),r=r.return}return h}function no(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5);return r||null}function Nm(r,i,l,h,p){for(var y=i._reactName,E=[];l!==null&&l!==h;){var j=l,U=j.alternate,ee=j.stateNode;if(U!==null&&U===h)break;j.tag===5&&ee!==null&&(j=ee,p?(U=rt(l,y),U!=null&&E.unshift(cl(l,U,j))):p||(U=rt(l,y),U!=null&&E.push(cl(l,U,j)))),l=l.return}E.length!==0&&r.push({event:i,listeners:E})}var Aw=/\r\n?/g,jw=/\u0000|\uFFFD/g;function Rm(r){return(typeof r=="string"?r:""+r).replace(Aw,`
`).replace(jw,"")}function Pc(r,i,l){if(i=Rm(i),Rm(r)!==i&&l)throw Error(t(425))}function Nc(){}var $d=null,Wd=null;function Gd(r,i){return r==="textarea"||r==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var qd=typeof setTimeout=="function"?setTimeout:void 0,kw=typeof clearTimeout=="function"?clearTimeout:void 0,Am=typeof Promise=="function"?Promise:void 0,Dw=typeof queueMicrotask=="function"?queueMicrotask:typeof Am<"u"?function(r){return Am.resolve(null).then(r).catch(Lw)}:qd;function Lw(r){setTimeout(function(){throw r})}function Hd(r,i){var l=i,h=0;do{var p=l.nextSibling;if(r.removeChild(l),p&&p.nodeType===8)if(l=p.data,l==="/$"){if(h===0){r.removeChild(p),zn(i);return}h--}else l!=="$"&&l!=="$?"&&l!=="$!"||h++;l=p}while(l);zn(i)}function Si(r){for(;r!=null;r=r.nextSibling){var i=r.nodeType;if(i===1||i===3)break;if(i===8){if(i=r.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return r}function jm(r){r=r.previousSibling;for(var i=0;r;){if(r.nodeType===8){var l=r.data;if(l==="$"||l==="$!"||l==="$?"){if(i===0)return r;i--}else l==="/$"&&i++}r=r.previousSibling}return null}var ro=Math.random().toString(36).slice(2),js="__reactFiber$"+ro,ul="__reactProps$"+ro,Zs="__reactContainer$"+ro,Kd="__reactEvents$"+ro,Vw="__reactListeners$"+ro,Mw="__reactHandles$"+ro;function fa(r){var i=r[js];if(i)return i;for(var l=r.parentNode;l;){if(i=l[Zs]||l[js]){if(l=i.alternate,i.child!==null||l!==null&&l.child!==null)for(r=jm(r);r!==null;){if(l=r[js])return l;r=jm(r)}return i}r=l,l=r.parentNode}return null}function dl(r){return r=r[js]||r[Zs],!r||r.tag!==5&&r.tag!==6&&r.tag!==13&&r.tag!==3?null:r}function so(r){if(r.tag===5||r.tag===6)return r.stateNode;throw Error(t(33))}function Rc(r){return r[ul]||null}var Qd=[],io=-1;function bi(r){return{current:r}}function zt(r){0>io||(r.current=Qd[io],Qd[io]=null,io--)}function Vt(r,i){io++,Qd[io]=r.current,r.current=i}var Ii={},er=bi(Ii),yr=bi(!1),pa=Ii;function ao(r,i){var l=r.type.contextTypes;if(!l)return Ii;var h=r.stateNode;if(h&&h.__reactInternalMemoizedUnmaskedChildContext===i)return h.__reactInternalMemoizedMaskedChildContext;var p={},y;for(y in l)p[y]=i[y];return h&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=i,r.__reactInternalMemoizedMaskedChildContext=p),p}function vr(r){return r=r.childContextTypes,r!=null}function Ac(){zt(yr),zt(er)}function km(r,i,l){if(er.current!==Ii)throw Error(t(168));Vt(er,i),Vt(yr,l)}function Dm(r,i,l){var h=r.stateNode;if(i=i.childContextTypes,typeof h.getChildContext!="function")return l;h=h.getChildContext();for(var p in h)if(!(p in i))throw Error(t(108,Me(r)||"Unknown",p));return xe({},l,h)}function jc(r){return r=(r=r.stateNode)&&r.__reactInternalMemoizedMergedChildContext||Ii,pa=er.current,Vt(er,r),Vt(yr,yr.current),!0}function Lm(r,i,l){var h=r.stateNode;if(!h)throw Error(t(169));l?(r=Dm(r,i,pa),h.__reactInternalMemoizedMergedChildContext=r,zt(yr),zt(er),Vt(er,r)):zt(yr),Vt(yr,l)}var ei=null,kc=!1,Yd=!1;function Vm(r){ei===null?ei=[r]:ei.push(r)}function Ow(r){kc=!0,Vm(r)}function Ci(){if(!Yd&&ei!==null){Yd=!0;var r=0,i=pt;try{var l=ei;for(pt=1;r<l.length;r++){var h=l[r];do h=h(!0);while(h!==null)}ei=null,kc=!1}catch(p){throw ei!==null&&(ei=ei.slice(r+1)),ss(jn,Ci),p}finally{pt=i,Yd=!1}}return null}var oo=[],lo=0,Dc=null,Lc=0,$r=[],Wr=0,ma=null,ti=1,ni="";function ga(r,i){oo[lo++]=Lc,oo[lo++]=Dc,Dc=r,Lc=i}function Mm(r,i,l){$r[Wr++]=ti,$r[Wr++]=ni,$r[Wr++]=ma,ma=r;var h=ti;r=ni;var p=32-Ce(h)-1;h&=~(1<<p),l+=1;var y=32-Ce(i)+p;if(30<y){var E=p-p%5;y=(h&(1<<E)-1).toString(32),h>>=E,p-=E,ti=1<<32-Ce(i)+p|l<<p|h,ni=y+r}else ti=1<<y|l<<p|h,ni=r}function Jd(r){r.return!==null&&(ga(r,1),Mm(r,1,0))}function Xd(r){for(;r===Dc;)Dc=oo[--lo],oo[lo]=null,Lc=oo[--lo],oo[lo]=null;for(;r===ma;)ma=$r[--Wr],$r[Wr]=null,ni=$r[--Wr],$r[Wr]=null,ti=$r[--Wr],$r[Wr]=null}var Dr=null,Lr=null,Gt=!1,hs=null;function Om(r,i){var l=Kr(5,null,null,0);l.elementType="DELETED",l.stateNode=i,l.return=r,i=r.deletions,i===null?(r.deletions=[l],r.flags|=16):i.push(l)}function Fm(r,i){switch(r.tag){case 5:var l=r.type;return i=i.nodeType!==1||l.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(r.stateNode=i,Dr=r,Lr=Si(i.firstChild),!0):!1;case 6:return i=r.pendingProps===""||i.nodeType!==3?null:i,i!==null?(r.stateNode=i,Dr=r,Lr=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(l=ma!==null?{id:ti,overflow:ni}:null,r.memoizedState={dehydrated:i,treeContext:l,retryLane:1073741824},l=Kr(18,null,null,0),l.stateNode=i,l.return=r,r.child=l,Dr=r,Lr=null,!0):!1;default:return!1}}function Zd(r){return(r.mode&1)!==0&&(r.flags&128)===0}function eh(r){if(Gt){var i=Lr;if(i){var l=i;if(!Fm(r,i)){if(Zd(r))throw Error(t(418));i=Si(l.nextSibling);var h=Dr;i&&Fm(r,i)?Om(h,l):(r.flags=r.flags&-4097|2,Gt=!1,Dr=r)}}else{if(Zd(r))throw Error(t(418));r.flags=r.flags&-4097|2,Gt=!1,Dr=r}}}function Um(r){for(r=r.return;r!==null&&r.tag!==5&&r.tag!==3&&r.tag!==13;)r=r.return;Dr=r}function Vc(r){if(r!==Dr)return!1;if(!Gt)return Um(r),Gt=!0,!1;var i;if((i=r.tag!==3)&&!(i=r.tag!==5)&&(i=r.type,i=i!=="head"&&i!=="body"&&!Gd(r.type,r.memoizedProps)),i&&(i=Lr)){if(Zd(r))throw zm(),Error(t(418));for(;i;)Om(r,i),i=Si(i.nextSibling)}if(Um(r),r.tag===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(t(317));e:{for(r=r.nextSibling,i=0;r;){if(r.nodeType===8){var l=r.data;if(l==="/$"){if(i===0){Lr=Si(r.nextSibling);break e}i--}else l!=="$"&&l!=="$!"&&l!=="$?"||i++}r=r.nextSibling}Lr=null}}else Lr=Dr?Si(r.stateNode.nextSibling):null;return!0}function zm(){for(var r=Lr;r;)r=Si(r.nextSibling)}function co(){Lr=Dr=null,Gt=!1}function th(r){hs===null?hs=[r]:hs.push(r)}var Fw=ge.ReactCurrentBatchConfig;function hl(r,i,l){if(r=l.ref,r!==null&&typeof r!="function"&&typeof r!="object"){if(l._owner){if(l=l._owner,l){if(l.tag!==1)throw Error(t(309));var h=l.stateNode}if(!h)throw Error(t(147,r));var p=h,y=""+r;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===y?i.ref:(i=function(E){var j=p.refs;E===null?delete j[y]:j[y]=E},i._stringRef=y,i)}if(typeof r!="string")throw Error(t(284));if(!l._owner)throw Error(t(290,r))}return r}function Mc(r,i){throw r=Object.prototype.toString.call(i),Error(t(31,r==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":r))}function Bm(r){var i=r._init;return i(r._payload)}function $m(r){function i(X,H){if(r){var Z=X.deletions;Z===null?(X.deletions=[H],X.flags|=16):Z.push(H)}}function l(X,H){if(!r)return null;for(;H!==null;)i(X,H),H=H.sibling;return null}function h(X,H){for(X=new Map;H!==null;)H.key!==null?X.set(H.key,H):X.set(H.index,H),H=H.sibling;return X}function p(X,H){return X=Li(X,H),X.index=0,X.sibling=null,X}function y(X,H,Z){return X.index=Z,r?(Z=X.alternate,Z!==null?(Z=Z.index,Z<H?(X.flags|=2,H):Z):(X.flags|=2,H)):(X.flags|=1048576,H)}function E(X){return r&&X.alternate===null&&(X.flags|=2),X}function j(X,H,Z,Ae){return H===null||H.tag!==6?(H=qh(Z,X.mode,Ae),H.return=X,H):(H=p(H,Z),H.return=X,H)}function U(X,H,Z,Ae){var Ke=Z.type;return Ke===D?_e(X,H,Z.props.children,Ae,Z.key):H!==null&&(H.elementType===Ke||typeof Ke=="object"&&Ke!==null&&Ke.$$typeof===Re&&Bm(Ke)===H.type)?(Ae=p(H,Z.props),Ae.ref=hl(X,H,Z),Ae.return=X,Ae):(Ae=ou(Z.type,Z.key,Z.props,null,X.mode,Ae),Ae.ref=hl(X,H,Z),Ae.return=X,Ae)}function ee(X,H,Z,Ae){return H===null||H.tag!==4||H.stateNode.containerInfo!==Z.containerInfo||H.stateNode.implementation!==Z.implementation?(H=Hh(Z,X.mode,Ae),H.return=X,H):(H=p(H,Z.children||[]),H.return=X,H)}function _e(X,H,Z,Ae,Ke){return H===null||H.tag!==7?(H=Sa(Z,X.mode,Ae,Ke),H.return=X,H):(H=p(H,Z),H.return=X,H)}function Se(X,H,Z){if(typeof H=="string"&&H!==""||typeof H=="number")return H=qh(""+H,X.mode,Z),H.return=X,H;if(typeof H=="object"&&H!==null){switch(H.$$typeof){case ie:return Z=ou(H.type,H.key,H.props,null,X.mode,Z),Z.ref=hl(X,null,H),Z.return=X,Z;case Ee:return H=Hh(H,X.mode,Z),H.return=X,H;case Re:var Ae=H._init;return Se(X,Ae(H._payload),Z)}if(en(H)||Ie(H))return H=Sa(H,X.mode,Z,null),H.return=X,H;Mc(X,H)}return null}function me(X,H,Z,Ae){var Ke=H!==null?H.key:null;if(typeof Z=="string"&&Z!==""||typeof Z=="number")return Ke!==null?null:j(X,H,""+Z,Ae);if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case ie:return Z.key===Ke?U(X,H,Z,Ae):null;case Ee:return Z.key===Ke?ee(X,H,Z,Ae):null;case Re:return Ke=Z._init,me(X,H,Ke(Z._payload),Ae)}if(en(Z)||Ie(Z))return Ke!==null?null:_e(X,H,Z,Ae,null);Mc(X,Z)}return null}function Fe(X,H,Z,Ae,Ke){if(typeof Ae=="string"&&Ae!==""||typeof Ae=="number")return X=X.get(Z)||null,j(H,X,""+Ae,Ke);if(typeof Ae=="object"&&Ae!==null){switch(Ae.$$typeof){case ie:return X=X.get(Ae.key===null?Z:Ae.key)||null,U(H,X,Ae,Ke);case Ee:return X=X.get(Ae.key===null?Z:Ae.key)||null,ee(H,X,Ae,Ke);case Re:var et=Ae._init;return Fe(X,H,Z,et(Ae._payload),Ke)}if(en(Ae)||Ie(Ae))return X=X.get(Z)||null,_e(H,X,Ae,Ke,null);Mc(H,Ae)}return null}function We(X,H,Z,Ae){for(var Ke=null,et=null,tt=H,it=H=0,Vn=null;tt!==null&&it<Z.length;it++){tt.index>it?(Vn=tt,tt=null):Vn=tt.sibling;var It=me(X,tt,Z[it],Ae);if(It===null){tt===null&&(tt=Vn);break}r&&tt&&It.alternate===null&&i(X,tt),H=y(It,H,it),et===null?Ke=It:et.sibling=It,et=It,tt=Vn}if(it===Z.length)return l(X,tt),Gt&&ga(X,it),Ke;if(tt===null){for(;it<Z.length;it++)tt=Se(X,Z[it],Ae),tt!==null&&(H=y(tt,H,it),et===null?Ke=tt:et.sibling=tt,et=tt);return Gt&&ga(X,it),Ke}for(tt=h(X,tt);it<Z.length;it++)Vn=Fe(tt,X,it,Z[it],Ae),Vn!==null&&(r&&Vn.alternate!==null&&tt.delete(Vn.key===null?it:Vn.key),H=y(Vn,H,it),et===null?Ke=Vn:et.sibling=Vn,et=Vn);return r&&tt.forEach(function(Vi){return i(X,Vi)}),Gt&&ga(X,it),Ke}function He(X,H,Z,Ae){var Ke=Ie(Z);if(typeof Ke!="function")throw Error(t(150));if(Z=Ke.call(Z),Z==null)throw Error(t(151));for(var et=Ke=null,tt=H,it=H=0,Vn=null,It=Z.next();tt!==null&&!It.done;it++,It=Z.next()){tt.index>it?(Vn=tt,tt=null):Vn=tt.sibling;var Vi=me(X,tt,It.value,Ae);if(Vi===null){tt===null&&(tt=Vn);break}r&&tt&&Vi.alternate===null&&i(X,tt),H=y(Vi,H,it),et===null?Ke=Vi:et.sibling=Vi,et=Vi,tt=Vn}if(It.done)return l(X,tt),Gt&&ga(X,it),Ke;if(tt===null){for(;!It.done;it++,It=Z.next())It=Se(X,It.value,Ae),It!==null&&(H=y(It,H,it),et===null?Ke=It:et.sibling=It,et=It);return Gt&&ga(X,it),Ke}for(tt=h(X,tt);!It.done;it++,It=Z.next())It=Fe(tt,X,it,It.value,Ae),It!==null&&(r&&It.alternate!==null&&tt.delete(It.key===null?it:It.key),H=y(It,H,it),et===null?Ke=It:et.sibling=It,et=It);return r&&tt.forEach(function(vE){return i(X,vE)}),Gt&&ga(X,it),Ke}function sn(X,H,Z,Ae){if(typeof Z=="object"&&Z!==null&&Z.type===D&&Z.key===null&&(Z=Z.props.children),typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case ie:e:{for(var Ke=Z.key,et=H;et!==null;){if(et.key===Ke){if(Ke=Z.type,Ke===D){if(et.tag===7){l(X,et.sibling),H=p(et,Z.props.children),H.return=X,X=H;break e}}else if(et.elementType===Ke||typeof Ke=="object"&&Ke!==null&&Ke.$$typeof===Re&&Bm(Ke)===et.type){l(X,et.sibling),H=p(et,Z.props),H.ref=hl(X,et,Z),H.return=X,X=H;break e}l(X,et);break}else i(X,et);et=et.sibling}Z.type===D?(H=Sa(Z.props.children,X.mode,Ae,Z.key),H.return=X,X=H):(Ae=ou(Z.type,Z.key,Z.props,null,X.mode,Ae),Ae.ref=hl(X,H,Z),Ae.return=X,X=Ae)}return E(X);case Ee:e:{for(et=Z.key;H!==null;){if(H.key===et)if(H.tag===4&&H.stateNode.containerInfo===Z.containerInfo&&H.stateNode.implementation===Z.implementation){l(X,H.sibling),H=p(H,Z.children||[]),H.return=X,X=H;break e}else{l(X,H);break}else i(X,H);H=H.sibling}H=Hh(Z,X.mode,Ae),H.return=X,X=H}return E(X);case Re:return et=Z._init,sn(X,H,et(Z._payload),Ae)}if(en(Z))return We(X,H,Z,Ae);if(Ie(Z))return He(X,H,Z,Ae);Mc(X,Z)}return typeof Z=="string"&&Z!==""||typeof Z=="number"?(Z=""+Z,H!==null&&H.tag===6?(l(X,H.sibling),H=p(H,Z),H.return=X,X=H):(l(X,H),H=qh(Z,X.mode,Ae),H.return=X,X=H),E(X)):l(X,H)}return sn}var uo=$m(!0),Wm=$m(!1),Oc=bi(null),Fc=null,ho=null,nh=null;function rh(){nh=ho=Fc=null}function sh(r){var i=Oc.current;zt(Oc),r._currentValue=i}function ih(r,i,l){for(;r!==null;){var h=r.alternate;if((r.childLanes&i)!==i?(r.childLanes|=i,h!==null&&(h.childLanes|=i)):h!==null&&(h.childLanes&i)!==i&&(h.childLanes|=i),r===l)break;r=r.return}}function fo(r,i){Fc=r,nh=ho=null,r=r.dependencies,r!==null&&r.firstContext!==null&&((r.lanes&i)!==0&&(_r=!0),r.firstContext=null)}function Gr(r){var i=r._currentValue;if(nh!==r)if(r={context:r,memoizedValue:i,next:null},ho===null){if(Fc===null)throw Error(t(308));ho=r,Fc.dependencies={lanes:0,firstContext:r}}else ho=ho.next=r;return i}var ya=null;function ah(r){ya===null?ya=[r]:ya.push(r)}function Gm(r,i,l,h){var p=i.interleaved;return p===null?(l.next=l,ah(i)):(l.next=p.next,p.next=l),i.interleaved=l,ri(r,h)}function ri(r,i){r.lanes|=i;var l=r.alternate;for(l!==null&&(l.lanes|=i),l=r,r=r.return;r!==null;)r.childLanes|=i,l=r.alternate,l!==null&&(l.childLanes|=i),l=r,r=r.return;return l.tag===3?l.stateNode:null}var Pi=!1;function oh(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function qm(r,i){r=r.updateQueue,i.updateQueue===r&&(i.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,effects:r.effects})}function si(r,i){return{eventTime:r,lane:i,tag:0,payload:null,callback:null,next:null}}function Ni(r,i,l){var h=r.updateQueue;if(h===null)return null;if(h=h.shared,(bt&2)!==0){var p=h.pending;return p===null?i.next=i:(i.next=p.next,p.next=i),h.pending=i,ri(r,l)}return p=h.interleaved,p===null?(i.next=i,ah(h)):(i.next=p.next,p.next=i),h.interleaved=i,ri(r,l)}function Uc(r,i,l){if(i=i.updateQueue,i!==null&&(i=i.shared,(l&4194240)!==0)){var h=i.lanes;h&=r.pendingLanes,l|=h,i.lanes=l,Cs(r,l)}}function Hm(r,i){var l=r.updateQueue,h=r.alternate;if(h!==null&&(h=h.updateQueue,l===h)){var p=null,y=null;if(l=l.firstBaseUpdate,l!==null){do{var E={eventTime:l.eventTime,lane:l.lane,tag:l.tag,payload:l.payload,callback:l.callback,next:null};y===null?p=y=E:y=y.next=E,l=l.next}while(l!==null);y===null?p=y=i:y=y.next=i}else p=y=i;l={baseState:h.baseState,firstBaseUpdate:p,lastBaseUpdate:y,shared:h.shared,effects:h.effects},r.updateQueue=l;return}r=l.lastBaseUpdate,r===null?l.firstBaseUpdate=i:r.next=i,l.lastBaseUpdate=i}function zc(r,i,l,h){var p=r.updateQueue;Pi=!1;var y=p.firstBaseUpdate,E=p.lastBaseUpdate,j=p.shared.pending;if(j!==null){p.shared.pending=null;var U=j,ee=U.next;U.next=null,E===null?y=ee:E.next=ee,E=U;var _e=r.alternate;_e!==null&&(_e=_e.updateQueue,j=_e.lastBaseUpdate,j!==E&&(j===null?_e.firstBaseUpdate=ee:j.next=ee,_e.lastBaseUpdate=U))}if(y!==null){var Se=p.baseState;E=0,_e=ee=U=null,j=y;do{var me=j.lane,Fe=j.eventTime;if((h&me)===me){_e!==null&&(_e=_e.next={eventTime:Fe,lane:0,tag:j.tag,payload:j.payload,callback:j.callback,next:null});e:{var We=r,He=j;switch(me=i,Fe=l,He.tag){case 1:if(We=He.payload,typeof We=="function"){Se=We.call(Fe,Se,me);break e}Se=We;break e;case 3:We.flags=We.flags&-65537|128;case 0:if(We=He.payload,me=typeof We=="function"?We.call(Fe,Se,me):We,me==null)break e;Se=xe({},Se,me);break e;case 2:Pi=!0}}j.callback!==null&&j.lane!==0&&(r.flags|=64,me=p.effects,me===null?p.effects=[j]:me.push(j))}else Fe={eventTime:Fe,lane:me,tag:j.tag,payload:j.payload,callback:j.callback,next:null},_e===null?(ee=_e=Fe,U=Se):_e=_e.next=Fe,E|=me;if(j=j.next,j===null){if(j=p.shared.pending,j===null)break;me=j,j=me.next,me.next=null,p.lastBaseUpdate=me,p.shared.pending=null}}while(!0);if(_e===null&&(U=Se),p.baseState=U,p.firstBaseUpdate=ee,p.lastBaseUpdate=_e,i=p.shared.interleaved,i!==null){p=i;do E|=p.lane,p=p.next;while(p!==i)}else y===null&&(p.shared.lanes=0);xa|=E,r.lanes=E,r.memoizedState=Se}}function Km(r,i,l){if(r=i.effects,i.effects=null,r!==null)for(i=0;i<r.length;i++){var h=r[i],p=h.callback;if(p!==null){if(h.callback=null,h=l,typeof p!="function")throw Error(t(191,p));p.call(h)}}}var fl={},ks=bi(fl),pl=bi(fl),ml=bi(fl);function va(r){if(r===fl)throw Error(t(174));return r}function lh(r,i){switch(Vt(ml,i),Vt(pl,r),Vt(ks,fl),r=i.nodeType,r){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:$t(null,"");break;default:r=r===8?i.parentNode:i,i=r.namespaceURI||null,r=r.tagName,i=$t(i,r)}zt(ks),Vt(ks,i)}function po(){zt(ks),zt(pl),zt(ml)}function Qm(r){va(ml.current);var i=va(ks.current),l=$t(i,r.type);i!==l&&(Vt(pl,r),Vt(ks,l))}function ch(r){pl.current===r&&(zt(ks),zt(pl))}var qt=bi(0);function Bc(r){for(var i=r;i!==null;){if(i.tag===13){var l=i.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||l.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===r)break;for(;i.sibling===null;){if(i.return===null||i.return===r)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var uh=[];function dh(){for(var r=0;r<uh.length;r++)uh[r]._workInProgressVersionPrimary=null;uh.length=0}var $c=ge.ReactCurrentDispatcher,hh=ge.ReactCurrentBatchConfig,_a=0,Ht=null,En=null,Dn=null,Wc=!1,gl=!1,yl=0,Uw=0;function tr(){throw Error(t(321))}function fh(r,i){if(i===null)return!1;for(var l=0;l<i.length&&l<r.length;l++)if(!ds(r[l],i[l]))return!1;return!0}function ph(r,i,l,h,p,y){if(_a=y,Ht=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,$c.current=r===null||r.memoizedState===null?Ww:Gw,r=l(h,p),gl){y=0;do{if(gl=!1,yl=0,25<=y)throw Error(t(301));y+=1,Dn=En=null,i.updateQueue=null,$c.current=qw,r=l(h,p)}while(gl)}if($c.current=Hc,i=En!==null&&En.next!==null,_a=0,Dn=En=Ht=null,Wc=!1,i)throw Error(t(300));return r}function mh(){var r=yl!==0;return yl=0,r}function Ds(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Dn===null?Ht.memoizedState=Dn=r:Dn=Dn.next=r,Dn}function qr(){if(En===null){var r=Ht.alternate;r=r!==null?r.memoizedState:null}else r=En.next;var i=Dn===null?Ht.memoizedState:Dn.next;if(i!==null)Dn=i,En=r;else{if(r===null)throw Error(t(310));En=r,r={memoizedState:En.memoizedState,baseState:En.baseState,baseQueue:En.baseQueue,queue:En.queue,next:null},Dn===null?Ht.memoizedState=Dn=r:Dn=Dn.next=r}return Dn}function vl(r,i){return typeof i=="function"?i(r):i}function gh(r){var i=qr(),l=i.queue;if(l===null)throw Error(t(311));l.lastRenderedReducer=r;var h=En,p=h.baseQueue,y=l.pending;if(y!==null){if(p!==null){var E=p.next;p.next=y.next,y.next=E}h.baseQueue=p=y,l.pending=null}if(p!==null){y=p.next,h=h.baseState;var j=E=null,U=null,ee=y;do{var _e=ee.lane;if((_a&_e)===_e)U!==null&&(U=U.next={lane:0,action:ee.action,hasEagerState:ee.hasEagerState,eagerState:ee.eagerState,next:null}),h=ee.hasEagerState?ee.eagerState:r(h,ee.action);else{var Se={lane:_e,action:ee.action,hasEagerState:ee.hasEagerState,eagerState:ee.eagerState,next:null};U===null?(j=U=Se,E=h):U=U.next=Se,Ht.lanes|=_e,xa|=_e}ee=ee.next}while(ee!==null&&ee!==y);U===null?E=h:U.next=j,ds(h,i.memoizedState)||(_r=!0),i.memoizedState=h,i.baseState=E,i.baseQueue=U,l.lastRenderedState=h}if(r=l.interleaved,r!==null){p=r;do y=p.lane,Ht.lanes|=y,xa|=y,p=p.next;while(p!==r)}else p===null&&(l.lanes=0);return[i.memoizedState,l.dispatch]}function yh(r){var i=qr(),l=i.queue;if(l===null)throw Error(t(311));l.lastRenderedReducer=r;var h=l.dispatch,p=l.pending,y=i.memoizedState;if(p!==null){l.pending=null;var E=p=p.next;do y=r(y,E.action),E=E.next;while(E!==p);ds(y,i.memoizedState)||(_r=!0),i.memoizedState=y,i.baseQueue===null&&(i.baseState=y),l.lastRenderedState=y}return[y,h]}function Ym(){}function Jm(r,i){var l=Ht,h=qr(),p=i(),y=!ds(h.memoizedState,p);if(y&&(h.memoizedState=p,_r=!0),h=h.queue,vh(eg.bind(null,l,h,r),[r]),h.getSnapshot!==i||y||Dn!==null&&Dn.memoizedState.tag&1){if(l.flags|=2048,_l(9,Zm.bind(null,l,h,p,i),void 0,null),Ln===null)throw Error(t(349));(_a&30)!==0||Xm(l,i,p)}return p}function Xm(r,i,l){r.flags|=16384,r={getSnapshot:i,value:l},i=Ht.updateQueue,i===null?(i={lastEffect:null,stores:null},Ht.updateQueue=i,i.stores=[r]):(l=i.stores,l===null?i.stores=[r]:l.push(r))}function Zm(r,i,l,h){i.value=l,i.getSnapshot=h,tg(i)&&ng(r)}function eg(r,i,l){return l(function(){tg(i)&&ng(r)})}function tg(r){var i=r.getSnapshot;r=r.value;try{var l=i();return!ds(r,l)}catch{return!0}}function ng(r){var i=ri(r,1);i!==null&&gs(i,r,1,-1)}function rg(r){var i=Ds();return typeof r=="function"&&(r=r()),i.memoizedState=i.baseState=r,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:vl,lastRenderedState:r},i.queue=r,r=r.dispatch=$w.bind(null,Ht,r),[i.memoizedState,r]}function _l(r,i,l,h){return r={tag:r,create:i,destroy:l,deps:h,next:null},i=Ht.updateQueue,i===null?(i={lastEffect:null,stores:null},Ht.updateQueue=i,i.lastEffect=r.next=r):(l=i.lastEffect,l===null?i.lastEffect=r.next=r:(h=l.next,l.next=r,r.next=h,i.lastEffect=r)),r}function sg(){return qr().memoizedState}function Gc(r,i,l,h){var p=Ds();Ht.flags|=r,p.memoizedState=_l(1|i,l,void 0,h===void 0?null:h)}function qc(r,i,l,h){var p=qr();h=h===void 0?null:h;var y=void 0;if(En!==null){var E=En.memoizedState;if(y=E.destroy,h!==null&&fh(h,E.deps)){p.memoizedState=_l(i,l,y,h);return}}Ht.flags|=r,p.memoizedState=_l(1|i,l,y,h)}function ig(r,i){return Gc(8390656,8,r,i)}function vh(r,i){return qc(2048,8,r,i)}function ag(r,i){return qc(4,2,r,i)}function og(r,i){return qc(4,4,r,i)}function lg(r,i){if(typeof i=="function")return r=r(),i(r),function(){i(null)};if(i!=null)return r=r(),i.current=r,function(){i.current=null}}function cg(r,i,l){return l=l!=null?l.concat([r]):null,qc(4,4,lg.bind(null,i,r),l)}function _h(){}function ug(r,i){var l=qr();i=i===void 0?null:i;var h=l.memoizedState;return h!==null&&i!==null&&fh(i,h[1])?h[0]:(l.memoizedState=[r,i],r)}function dg(r,i){var l=qr();i=i===void 0?null:i;var h=l.memoizedState;return h!==null&&i!==null&&fh(i,h[1])?h[0]:(r=r(),l.memoizedState=[r,i],r)}function hg(r,i,l){return(_a&21)===0?(r.baseState&&(r.baseState=!1,_r=!0),r.memoizedState=l):(ds(l,i)||(l=as(),Ht.lanes|=l,xa|=l,r.baseState=!0),i)}function zw(r,i){var l=pt;pt=l!==0&&4>l?l:4,r(!0);var h=hh.transition;hh.transition={};try{r(!1),i()}finally{pt=l,hh.transition=h}}function fg(){return qr().memoizedState}function Bw(r,i,l){var h=ki(r);if(l={lane:h,action:l,hasEagerState:!1,eagerState:null,next:null},pg(r))mg(i,l);else if(l=Gm(r,i,l,h),l!==null){var p=hr();gs(l,r,h,p),gg(l,i,h)}}function $w(r,i,l){var h=ki(r),p={lane:h,action:l,hasEagerState:!1,eagerState:null,next:null};if(pg(r))mg(i,p);else{var y=r.alternate;if(r.lanes===0&&(y===null||y.lanes===0)&&(y=i.lastRenderedReducer,y!==null))try{var E=i.lastRenderedState,j=y(E,l);if(p.hasEagerState=!0,p.eagerState=j,ds(j,E)){var U=i.interleaved;U===null?(p.next=p,ah(i)):(p.next=U.next,U.next=p),i.interleaved=p;return}}catch{}finally{}l=Gm(r,i,p,h),l!==null&&(p=hr(),gs(l,r,h,p),gg(l,i,h))}}function pg(r){var i=r.alternate;return r===Ht||i!==null&&i===Ht}function mg(r,i){gl=Wc=!0;var l=r.pending;l===null?i.next=i:(i.next=l.next,l.next=i),r.pending=i}function gg(r,i,l){if((l&4194240)!==0){var h=i.lanes;h&=r.pendingLanes,l|=h,i.lanes=l,Cs(r,l)}}var Hc={readContext:Gr,useCallback:tr,useContext:tr,useEffect:tr,useImperativeHandle:tr,useInsertionEffect:tr,useLayoutEffect:tr,useMemo:tr,useReducer:tr,useRef:tr,useState:tr,useDebugValue:tr,useDeferredValue:tr,useTransition:tr,useMutableSource:tr,useSyncExternalStore:tr,useId:tr,unstable_isNewReconciler:!1},Ww={readContext:Gr,useCallback:function(r,i){return Ds().memoizedState=[r,i===void 0?null:i],r},useContext:Gr,useEffect:ig,useImperativeHandle:function(r,i,l){return l=l!=null?l.concat([r]):null,Gc(4194308,4,lg.bind(null,i,r),l)},useLayoutEffect:function(r,i){return Gc(4194308,4,r,i)},useInsertionEffect:function(r,i){return Gc(4,2,r,i)},useMemo:function(r,i){var l=Ds();return i=i===void 0?null:i,r=r(),l.memoizedState=[r,i],r},useReducer:function(r,i,l){var h=Ds();return i=l!==void 0?l(i):i,h.memoizedState=h.baseState=i,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:i},h.queue=r,r=r.dispatch=Bw.bind(null,Ht,r),[h.memoizedState,r]},useRef:function(r){var i=Ds();return r={current:r},i.memoizedState=r},useState:rg,useDebugValue:_h,useDeferredValue:function(r){return Ds().memoizedState=r},useTransition:function(){var r=rg(!1),i=r[0];return r=zw.bind(null,r[1]),Ds().memoizedState=r,[i,r]},useMutableSource:function(){},useSyncExternalStore:function(r,i,l){var h=Ht,p=Ds();if(Gt){if(l===void 0)throw Error(t(407));l=l()}else{if(l=i(),Ln===null)throw Error(t(349));(_a&30)!==0||Xm(h,i,l)}p.memoizedState=l;var y={value:l,getSnapshot:i};return p.queue=y,ig(eg.bind(null,h,y,r),[r]),h.flags|=2048,_l(9,Zm.bind(null,h,y,l,i),void 0,null),l},useId:function(){var r=Ds(),i=Ln.identifierPrefix;if(Gt){var l=ni,h=ti;l=(h&~(1<<32-Ce(h)-1)).toString(32)+l,i=":"+i+"R"+l,l=yl++,0<l&&(i+="H"+l.toString(32)),i+=":"}else l=Uw++,i=":"+i+"r"+l.toString(32)+":";return r.memoizedState=i},unstable_isNewReconciler:!1},Gw={readContext:Gr,useCallback:ug,useContext:Gr,useEffect:vh,useImperativeHandle:cg,useInsertionEffect:ag,useLayoutEffect:og,useMemo:dg,useReducer:gh,useRef:sg,useState:function(){return gh(vl)},useDebugValue:_h,useDeferredValue:function(r){var i=qr();return hg(i,En.memoizedState,r)},useTransition:function(){var r=gh(vl)[0],i=qr().memoizedState;return[r,i]},useMutableSource:Ym,useSyncExternalStore:Jm,useId:fg,unstable_isNewReconciler:!1},qw={readContext:Gr,useCallback:ug,useContext:Gr,useEffect:vh,useImperativeHandle:cg,useInsertionEffect:ag,useLayoutEffect:og,useMemo:dg,useReducer:yh,useRef:sg,useState:function(){return yh(vl)},useDebugValue:_h,useDeferredValue:function(r){var i=qr();return En===null?i.memoizedState=r:hg(i,En.memoizedState,r)},useTransition:function(){var r=yh(vl)[0],i=qr().memoizedState;return[r,i]},useMutableSource:Ym,useSyncExternalStore:Jm,useId:fg,unstable_isNewReconciler:!1};function fs(r,i){if(r&&r.defaultProps){i=xe({},i),r=r.defaultProps;for(var l in r)i[l]===void 0&&(i[l]=r[l]);return i}return i}function xh(r,i,l,h){i=r.memoizedState,l=l(h,i),l=l==null?i:xe({},i,l),r.memoizedState=l,r.lanes===0&&(r.updateQueue.baseState=l)}var Kc={isMounted:function(r){return(r=r._reactInternals)?Ft(r)===r:!1},enqueueSetState:function(r,i,l){r=r._reactInternals;var h=hr(),p=ki(r),y=si(h,p);y.payload=i,l!=null&&(y.callback=l),i=Ni(r,y,p),i!==null&&(gs(i,r,p,h),Uc(i,r,p))},enqueueReplaceState:function(r,i,l){r=r._reactInternals;var h=hr(),p=ki(r),y=si(h,p);y.tag=1,y.payload=i,l!=null&&(y.callback=l),i=Ni(r,y,p),i!==null&&(gs(i,r,p,h),Uc(i,r,p))},enqueueForceUpdate:function(r,i){r=r._reactInternals;var l=hr(),h=ki(r),p=si(l,h);p.tag=2,i!=null&&(p.callback=i),i=Ni(r,p,h),i!==null&&(gs(i,r,h,l),Uc(i,r,h))}};function yg(r,i,l,h,p,y,E){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(h,y,E):i.prototype&&i.prototype.isPureReactComponent?!il(l,h)||!il(p,y):!0}function vg(r,i,l){var h=!1,p=Ii,y=i.contextType;return typeof y=="object"&&y!==null?y=Gr(y):(p=vr(i)?pa:er.current,h=i.contextTypes,y=(h=h!=null)?ao(r,p):Ii),i=new i(l,y),r.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=Kc,r.stateNode=i,i._reactInternals=r,h&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=p,r.__reactInternalMemoizedMaskedChildContext=y),i}function _g(r,i,l,h){r=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(l,h),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(l,h),i.state!==r&&Kc.enqueueReplaceState(i,i.state,null)}function wh(r,i,l,h){var p=r.stateNode;p.props=l,p.state=r.memoizedState,p.refs={},oh(r);var y=i.contextType;typeof y=="object"&&y!==null?p.context=Gr(y):(y=vr(i)?pa:er.current,p.context=ao(r,y)),p.state=r.memoizedState,y=i.getDerivedStateFromProps,typeof y=="function"&&(xh(r,i,y,l),p.state=r.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(i=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),i!==p.state&&Kc.enqueueReplaceState(p,p.state,null),zc(r,l,p,h),p.state=r.memoizedState),typeof p.componentDidMount=="function"&&(r.flags|=4194308)}function mo(r,i){try{var l="",h=i;do l+=De(h),h=h.return;while(h);var p=l}catch(y){p=`
Error generating stack: `+y.message+`
`+y.stack}return{value:r,source:i,stack:p,digest:null}}function Eh(r,i,l){return{value:r,source:null,stack:l??null,digest:i??null}}function Th(r,i){try{console.error(i.value)}catch(l){setTimeout(function(){throw l})}}var Hw=typeof WeakMap=="function"?WeakMap:Map;function xg(r,i,l){l=si(-1,l),l.tag=3,l.payload={element:null};var h=i.value;return l.callback=function(){tu||(tu=!0,Oh=h),Th(r,i)},l}function wg(r,i,l){l=si(-1,l),l.tag=3;var h=r.type.getDerivedStateFromError;if(typeof h=="function"){var p=i.value;l.payload=function(){return h(p)},l.callback=function(){Th(r,i)}}var y=r.stateNode;return y!==null&&typeof y.componentDidCatch=="function"&&(l.callback=function(){Th(r,i),typeof h!="function"&&(Ai===null?Ai=new Set([this]):Ai.add(this));var E=i.stack;this.componentDidCatch(i.value,{componentStack:E!==null?E:""})}),l}function Eg(r,i,l){var h=r.pingCache;if(h===null){h=r.pingCache=new Hw;var p=new Set;h.set(i,p)}else p=h.get(i),p===void 0&&(p=new Set,h.set(i,p));p.has(l)||(p.add(l),r=oE.bind(null,r,i,l),i.then(r,r))}function Tg(r){do{var i;if((i=r.tag===13)&&(i=r.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return r;r=r.return}while(r!==null);return null}function Sg(r,i,l,h,p){return(r.mode&1)===0?(r===i?r.flags|=65536:(r.flags|=128,l.flags|=131072,l.flags&=-52805,l.tag===1&&(l.alternate===null?l.tag=17:(i=si(-1,1),i.tag=2,Ni(l,i,1))),l.lanes|=1),r):(r.flags|=65536,r.lanes=p,r)}var Kw=ge.ReactCurrentOwner,_r=!1;function dr(r,i,l,h){i.child=r===null?Wm(i,null,l,h):uo(i,r.child,l,h)}function bg(r,i,l,h,p){l=l.render;var y=i.ref;return fo(i,p),h=ph(r,i,l,h,y,p),l=mh(),r!==null&&!_r?(i.updateQueue=r.updateQueue,i.flags&=-2053,r.lanes&=~p,ii(r,i,p)):(Gt&&l&&Jd(i),i.flags|=1,dr(r,i,h,p),i.child)}function Ig(r,i,l,h,p){if(r===null){var y=l.type;return typeof y=="function"&&!Gh(y)&&y.defaultProps===void 0&&l.compare===null&&l.defaultProps===void 0?(i.tag=15,i.type=y,Cg(r,i,y,h,p)):(r=ou(l.type,null,h,i,i.mode,p),r.ref=i.ref,r.return=i,i.child=r)}if(y=r.child,(r.lanes&p)===0){var E=y.memoizedProps;if(l=l.compare,l=l!==null?l:il,l(E,h)&&r.ref===i.ref)return ii(r,i,p)}return i.flags|=1,r=Li(y,h),r.ref=i.ref,r.return=i,i.child=r}function Cg(r,i,l,h,p){if(r!==null){var y=r.memoizedProps;if(il(y,h)&&r.ref===i.ref)if(_r=!1,i.pendingProps=h=y,(r.lanes&p)!==0)(r.flags&131072)!==0&&(_r=!0);else return i.lanes=r.lanes,ii(r,i,p)}return Sh(r,i,l,h,p)}function Pg(r,i,l){var h=i.pendingProps,p=h.children,y=r!==null?r.memoizedState:null;if(h.mode==="hidden")if((i.mode&1)===0)i.memoizedState={baseLanes:0,cachePool:null,transitions:null},Vt(yo,Vr),Vr|=l;else{if((l&1073741824)===0)return r=y!==null?y.baseLanes|l:l,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:r,cachePool:null,transitions:null},i.updateQueue=null,Vt(yo,Vr),Vr|=r,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},h=y!==null?y.baseLanes:l,Vt(yo,Vr),Vr|=h}else y!==null?(h=y.baseLanes|l,i.memoizedState=null):h=l,Vt(yo,Vr),Vr|=h;return dr(r,i,p,l),i.child}function Ng(r,i){var l=i.ref;(r===null&&l!==null||r!==null&&r.ref!==l)&&(i.flags|=512,i.flags|=2097152)}function Sh(r,i,l,h,p){var y=vr(l)?pa:er.current;return y=ao(i,y),fo(i,p),l=ph(r,i,l,h,y,p),h=mh(),r!==null&&!_r?(i.updateQueue=r.updateQueue,i.flags&=-2053,r.lanes&=~p,ii(r,i,p)):(Gt&&h&&Jd(i),i.flags|=1,dr(r,i,l,p),i.child)}function Rg(r,i,l,h,p){if(vr(l)){var y=!0;jc(i)}else y=!1;if(fo(i,p),i.stateNode===null)Yc(r,i),vg(i,l,h),wh(i,l,h,p),h=!0;else if(r===null){var E=i.stateNode,j=i.memoizedProps;E.props=j;var U=E.context,ee=l.contextType;typeof ee=="object"&&ee!==null?ee=Gr(ee):(ee=vr(l)?pa:er.current,ee=ao(i,ee));var _e=l.getDerivedStateFromProps,Se=typeof _e=="function"||typeof E.getSnapshotBeforeUpdate=="function";Se||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(j!==h||U!==ee)&&_g(i,E,h,ee),Pi=!1;var me=i.memoizedState;E.state=me,zc(i,h,E,p),U=i.memoizedState,j!==h||me!==U||yr.current||Pi?(typeof _e=="function"&&(xh(i,l,_e,h),U=i.memoizedState),(j=Pi||yg(i,l,j,h,me,U,ee))?(Se||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount()),typeof E.componentDidMount=="function"&&(i.flags|=4194308)):(typeof E.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=h,i.memoizedState=U),E.props=h,E.state=U,E.context=ee,h=j):(typeof E.componentDidMount=="function"&&(i.flags|=4194308),h=!1)}else{E=i.stateNode,qm(r,i),j=i.memoizedProps,ee=i.type===i.elementType?j:fs(i.type,j),E.props=ee,Se=i.pendingProps,me=E.context,U=l.contextType,typeof U=="object"&&U!==null?U=Gr(U):(U=vr(l)?pa:er.current,U=ao(i,U));var Fe=l.getDerivedStateFromProps;(_e=typeof Fe=="function"||typeof E.getSnapshotBeforeUpdate=="function")||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(j!==Se||me!==U)&&_g(i,E,h,U),Pi=!1,me=i.memoizedState,E.state=me,zc(i,h,E,p);var We=i.memoizedState;j!==Se||me!==We||yr.current||Pi?(typeof Fe=="function"&&(xh(i,l,Fe,h),We=i.memoizedState),(ee=Pi||yg(i,l,ee,h,me,We,U)||!1)?(_e||typeof E.UNSAFE_componentWillUpdate!="function"&&typeof E.componentWillUpdate!="function"||(typeof E.componentWillUpdate=="function"&&E.componentWillUpdate(h,We,U),typeof E.UNSAFE_componentWillUpdate=="function"&&E.UNSAFE_componentWillUpdate(h,We,U)),typeof E.componentDidUpdate=="function"&&(i.flags|=4),typeof E.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof E.componentDidUpdate!="function"||j===r.memoizedProps&&me===r.memoizedState||(i.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||j===r.memoizedProps&&me===r.memoizedState||(i.flags|=1024),i.memoizedProps=h,i.memoizedState=We),E.props=h,E.state=We,E.context=U,h=ee):(typeof E.componentDidUpdate!="function"||j===r.memoizedProps&&me===r.memoizedState||(i.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||j===r.memoizedProps&&me===r.memoizedState||(i.flags|=1024),h=!1)}return bh(r,i,l,h,y,p)}function bh(r,i,l,h,p,y){Ng(r,i);var E=(i.flags&128)!==0;if(!h&&!E)return p&&Lm(i,l,!1),ii(r,i,y);h=i.stateNode,Kw.current=i;var j=E&&typeof l.getDerivedStateFromError!="function"?null:h.render();return i.flags|=1,r!==null&&E?(i.child=uo(i,r.child,null,y),i.child=uo(i,null,j,y)):dr(r,i,j,y),i.memoizedState=h.state,p&&Lm(i,l,!0),i.child}function Ag(r){var i=r.stateNode;i.pendingContext?km(r,i.pendingContext,i.pendingContext!==i.context):i.context&&km(r,i.context,!1),lh(r,i.containerInfo)}function jg(r,i,l,h,p){return co(),th(p),i.flags|=256,dr(r,i,l,h),i.child}var Ih={dehydrated:null,treeContext:null,retryLane:0};function Ch(r){return{baseLanes:r,cachePool:null,transitions:null}}function kg(r,i,l){var h=i.pendingProps,p=qt.current,y=!1,E=(i.flags&128)!==0,j;if((j=E)||(j=r!==null&&r.memoizedState===null?!1:(p&2)!==0),j?(y=!0,i.flags&=-129):(r===null||r.memoizedState!==null)&&(p|=1),Vt(qt,p&1),r===null)return eh(i),r=i.memoizedState,r!==null&&(r=r.dehydrated,r!==null)?((i.mode&1)===0?i.lanes=1:r.data==="$!"?i.lanes=8:i.lanes=1073741824,null):(E=h.children,r=h.fallback,y?(h=i.mode,y=i.child,E={mode:"hidden",children:E},(h&1)===0&&y!==null?(y.childLanes=0,y.pendingProps=E):y=lu(E,h,0,null),r=Sa(r,h,l,null),y.return=i,r.return=i,y.sibling=r,i.child=y,i.child.memoizedState=Ch(l),i.memoizedState=Ih,r):Ph(i,E));if(p=r.memoizedState,p!==null&&(j=p.dehydrated,j!==null))return Qw(r,i,E,h,j,p,l);if(y){y=h.fallback,E=i.mode,p=r.child,j=p.sibling;var U={mode:"hidden",children:h.children};return(E&1)===0&&i.child!==p?(h=i.child,h.childLanes=0,h.pendingProps=U,i.deletions=null):(h=Li(p,U),h.subtreeFlags=p.subtreeFlags&14680064),j!==null?y=Li(j,y):(y=Sa(y,E,l,null),y.flags|=2),y.return=i,h.return=i,h.sibling=y,i.child=h,h=y,y=i.child,E=r.child.memoizedState,E=E===null?Ch(l):{baseLanes:E.baseLanes|l,cachePool:null,transitions:E.transitions},y.memoizedState=E,y.childLanes=r.childLanes&~l,i.memoizedState=Ih,h}return y=r.child,r=y.sibling,h=Li(y,{mode:"visible",children:h.children}),(i.mode&1)===0&&(h.lanes=l),h.return=i,h.sibling=null,r!==null&&(l=i.deletions,l===null?(i.deletions=[r],i.flags|=16):l.push(r)),i.child=h,i.memoizedState=null,h}function Ph(r,i){return i=lu({mode:"visible",children:i},r.mode,0,null),i.return=r,r.child=i}function Qc(r,i,l,h){return h!==null&&th(h),uo(i,r.child,null,l),r=Ph(i,i.pendingProps.children),r.flags|=2,i.memoizedState=null,r}function Qw(r,i,l,h,p,y,E){if(l)return i.flags&256?(i.flags&=-257,h=Eh(Error(t(422))),Qc(r,i,E,h)):i.memoizedState!==null?(i.child=r.child,i.flags|=128,null):(y=h.fallback,p=i.mode,h=lu({mode:"visible",children:h.children},p,0,null),y=Sa(y,p,E,null),y.flags|=2,h.return=i,y.return=i,h.sibling=y,i.child=h,(i.mode&1)!==0&&uo(i,r.child,null,E),i.child.memoizedState=Ch(E),i.memoizedState=Ih,y);if((i.mode&1)===0)return Qc(r,i,E,null);if(p.data==="$!"){if(h=p.nextSibling&&p.nextSibling.dataset,h)var j=h.dgst;return h=j,y=Error(t(419)),h=Eh(y,h,void 0),Qc(r,i,E,h)}if(j=(E&r.childLanes)!==0,_r||j){if(h=Ln,h!==null){switch(E&-E){case 4:p=2;break;case 16:p=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:p=32;break;case 536870912:p=268435456;break;default:p=0}p=(p&(h.suspendedLanes|E))!==0?0:p,p!==0&&p!==y.retryLane&&(y.retryLane=p,ri(r,p),gs(h,r,p,-1))}return Wh(),h=Eh(Error(t(421))),Qc(r,i,E,h)}return p.data==="$?"?(i.flags|=128,i.child=r.child,i=lE.bind(null,r),p._reactRetry=i,null):(r=y.treeContext,Lr=Si(p.nextSibling),Dr=i,Gt=!0,hs=null,r!==null&&($r[Wr++]=ti,$r[Wr++]=ni,$r[Wr++]=ma,ti=r.id,ni=r.overflow,ma=i),i=Ph(i,h.children),i.flags|=4096,i)}function Dg(r,i,l){r.lanes|=i;var h=r.alternate;h!==null&&(h.lanes|=i),ih(r.return,i,l)}function Nh(r,i,l,h,p){var y=r.memoizedState;y===null?r.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:h,tail:l,tailMode:p}:(y.isBackwards=i,y.rendering=null,y.renderingStartTime=0,y.last=h,y.tail=l,y.tailMode=p)}function Lg(r,i,l){var h=i.pendingProps,p=h.revealOrder,y=h.tail;if(dr(r,i,h.children,l),h=qt.current,(h&2)!==0)h=h&1|2,i.flags|=128;else{if(r!==null&&(r.flags&128)!==0)e:for(r=i.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&Dg(r,l,i);else if(r.tag===19)Dg(r,l,i);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===i)break e;for(;r.sibling===null;){if(r.return===null||r.return===i)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}h&=1}if(Vt(qt,h),(i.mode&1)===0)i.memoizedState=null;else switch(p){case"forwards":for(l=i.child,p=null;l!==null;)r=l.alternate,r!==null&&Bc(r)===null&&(p=l),l=l.sibling;l=p,l===null?(p=i.child,i.child=null):(p=l.sibling,l.sibling=null),Nh(i,!1,p,l,y);break;case"backwards":for(l=null,p=i.child,i.child=null;p!==null;){if(r=p.alternate,r!==null&&Bc(r)===null){i.child=p;break}r=p.sibling,p.sibling=l,l=p,p=r}Nh(i,!0,l,null,y);break;case"together":Nh(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function Yc(r,i){(i.mode&1)===0&&r!==null&&(r.alternate=null,i.alternate=null,i.flags|=2)}function ii(r,i,l){if(r!==null&&(i.dependencies=r.dependencies),xa|=i.lanes,(l&i.childLanes)===0)return null;if(r!==null&&i.child!==r.child)throw Error(t(153));if(i.child!==null){for(r=i.child,l=Li(r,r.pendingProps),i.child=l,l.return=i;r.sibling!==null;)r=r.sibling,l=l.sibling=Li(r,r.pendingProps),l.return=i;l.sibling=null}return i.child}function Yw(r,i,l){switch(i.tag){case 3:Ag(i),co();break;case 5:Qm(i);break;case 1:vr(i.type)&&jc(i);break;case 4:lh(i,i.stateNode.containerInfo);break;case 10:var h=i.type._context,p=i.memoizedProps.value;Vt(Oc,h._currentValue),h._currentValue=p;break;case 13:if(h=i.memoizedState,h!==null)return h.dehydrated!==null?(Vt(qt,qt.current&1),i.flags|=128,null):(l&i.child.childLanes)!==0?kg(r,i,l):(Vt(qt,qt.current&1),r=ii(r,i,l),r!==null?r.sibling:null);Vt(qt,qt.current&1);break;case 19:if(h=(l&i.childLanes)!==0,(r.flags&128)!==0){if(h)return Lg(r,i,l);i.flags|=128}if(p=i.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),Vt(qt,qt.current),h)break;return null;case 22:case 23:return i.lanes=0,Pg(r,i,l)}return ii(r,i,l)}var Vg,Rh,Mg,Og;Vg=function(r,i){for(var l=i.child;l!==null;){if(l.tag===5||l.tag===6)r.appendChild(l.stateNode);else if(l.tag!==4&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===i)break;for(;l.sibling===null;){if(l.return===null||l.return===i)return;l=l.return}l.sibling.return=l.return,l=l.sibling}},Rh=function(){},Mg=function(r,i,l,h){var p=r.memoizedProps;if(p!==h){r=i.stateNode,va(ks.current);var y=null;switch(l){case"input":p=Qe(r,p),h=Qe(r,h),y=[];break;case"select":p=xe({},p,{value:void 0}),h=xe({},h,{value:void 0}),y=[];break;case"textarea":p=ln(r,p),h=ln(r,h),y=[];break;default:typeof p.onClick!="function"&&typeof h.onClick=="function"&&(r.onclick=Nc)}ts(l,h);var E;l=null;for(ee in p)if(!h.hasOwnProperty(ee)&&p.hasOwnProperty(ee)&&p[ee]!=null)if(ee==="style"){var j=p[ee];for(E in j)j.hasOwnProperty(E)&&(l||(l={}),l[E]="")}else ee!=="dangerouslySetInnerHTML"&&ee!=="children"&&ee!=="suppressContentEditableWarning"&&ee!=="suppressHydrationWarning"&&ee!=="autoFocus"&&(a.hasOwnProperty(ee)?y||(y=[]):(y=y||[]).push(ee,null));for(ee in h){var U=h[ee];if(j=p!=null?p[ee]:void 0,h.hasOwnProperty(ee)&&U!==j&&(U!=null||j!=null))if(ee==="style")if(j){for(E in j)!j.hasOwnProperty(E)||U&&U.hasOwnProperty(E)||(l||(l={}),l[E]="");for(E in U)U.hasOwnProperty(E)&&j[E]!==U[E]&&(l||(l={}),l[E]=U[E])}else l||(y||(y=[]),y.push(ee,l)),l=U;else ee==="dangerouslySetInnerHTML"?(U=U?U.__html:void 0,j=j?j.__html:void 0,U!=null&&j!==U&&(y=y||[]).push(ee,U)):ee==="children"?typeof U!="string"&&typeof U!="number"||(y=y||[]).push(ee,""+U):ee!=="suppressContentEditableWarning"&&ee!=="suppressHydrationWarning"&&(a.hasOwnProperty(ee)?(U!=null&&ee==="onScroll"&&Ut("scroll",r),y||j===U||(y=[])):(y=y||[]).push(ee,U))}l&&(y=y||[]).push("style",l);var ee=y;(i.updateQueue=ee)&&(i.flags|=4)}},Og=function(r,i,l,h){l!==h&&(i.flags|=4)};function xl(r,i){if(!Gt)switch(r.tailMode){case"hidden":i=r.tail;for(var l=null;i!==null;)i.alternate!==null&&(l=i),i=i.sibling;l===null?r.tail=null:l.sibling=null;break;case"collapsed":l=r.tail;for(var h=null;l!==null;)l.alternate!==null&&(h=l),l=l.sibling;h===null?i||r.tail===null?r.tail=null:r.tail.sibling=null:h.sibling=null}}function nr(r){var i=r.alternate!==null&&r.alternate.child===r.child,l=0,h=0;if(i)for(var p=r.child;p!==null;)l|=p.lanes|p.childLanes,h|=p.subtreeFlags&14680064,h|=p.flags&14680064,p.return=r,p=p.sibling;else for(p=r.child;p!==null;)l|=p.lanes|p.childLanes,h|=p.subtreeFlags,h|=p.flags,p.return=r,p=p.sibling;return r.subtreeFlags|=h,r.childLanes=l,i}function Jw(r,i,l){var h=i.pendingProps;switch(Xd(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return nr(i),null;case 1:return vr(i.type)&&Ac(),nr(i),null;case 3:return h=i.stateNode,po(),zt(yr),zt(er),dh(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(r===null||r.child===null)&&(Vc(i)?i.flags|=4:r===null||r.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,hs!==null&&(zh(hs),hs=null))),Rh(r,i),nr(i),null;case 5:ch(i);var p=va(ml.current);if(l=i.type,r!==null&&i.stateNode!=null)Mg(r,i,l,h,p),r.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!h){if(i.stateNode===null)throw Error(t(166));return nr(i),null}if(r=va(ks.current),Vc(i)){h=i.stateNode,l=i.type;var y=i.memoizedProps;switch(h[js]=i,h[ul]=y,r=(i.mode&1)!==0,l){case"dialog":Ut("cancel",h),Ut("close",h);break;case"iframe":case"object":case"embed":Ut("load",h);break;case"video":case"audio":for(p=0;p<ol.length;p++)Ut(ol[p],h);break;case"source":Ut("error",h);break;case"img":case"image":case"link":Ut("error",h),Ut("load",h);break;case"details":Ut("toggle",h);break;case"input":Ye(h,y),Ut("invalid",h);break;case"select":h._wrapperState={wasMultiple:!!y.multiple},Ut("invalid",h);break;case"textarea":fr(h,y),Ut("invalid",h)}ts(l,y),p=null;for(var E in y)if(y.hasOwnProperty(E)){var j=y[E];E==="children"?typeof j=="string"?h.textContent!==j&&(y.suppressHydrationWarning!==!0&&Pc(h.textContent,j,r),p=["children",j]):typeof j=="number"&&h.textContent!==""+j&&(y.suppressHydrationWarning!==!0&&Pc(h.textContent,j,r),p=["children",""+j]):a.hasOwnProperty(E)&&j!=null&&E==="onScroll"&&Ut("scroll",h)}switch(l){case"input":pe(h),xt(h,y,!0);break;case"textarea":pe(h),Kn(h);break;case"select":case"option":break;default:typeof y.onClick=="function"&&(h.onclick=Nc)}h=p,i.updateQueue=h,h!==null&&(i.flags|=4)}else{E=p.nodeType===9?p:p.ownerDocument,r==="http://www.w3.org/1999/xhtml"&&(r=Ot(l)),r==="http://www.w3.org/1999/xhtml"?l==="script"?(r=E.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild)):typeof h.is=="string"?r=E.createElement(l,{is:h.is}):(r=E.createElement(l),l==="select"&&(E=r,h.multiple?E.multiple=!0:h.size&&(E.size=h.size))):r=E.createElementNS(r,l),r[js]=i,r[ul]=h,Vg(r,i,!1,!1),i.stateNode=r;e:{switch(E=Ts(l,h),l){case"dialog":Ut("cancel",r),Ut("close",r),p=h;break;case"iframe":case"object":case"embed":Ut("load",r),p=h;break;case"video":case"audio":for(p=0;p<ol.length;p++)Ut(ol[p],r);p=h;break;case"source":Ut("error",r),p=h;break;case"img":case"image":case"link":Ut("error",r),Ut("load",r),p=h;break;case"details":Ut("toggle",r),p=h;break;case"input":Ye(r,h),p=Qe(r,h),Ut("invalid",r);break;case"option":p=h;break;case"select":r._wrapperState={wasMultiple:!!h.multiple},p=xe({},h,{value:void 0}),Ut("invalid",r);break;case"textarea":fr(r,h),p=ln(r,h),Ut("invalid",r);break;default:p=h}ts(l,p),j=p;for(y in j)if(j.hasOwnProperty(y)){var U=j[y];y==="style"?Cn(r,U):y==="dangerouslySetInnerHTML"?(U=U?U.__html:void 0,U!=null&&lr(r,U)):y==="children"?typeof U=="string"?(l!=="textarea"||U!=="")&&In(r,U):typeof U=="number"&&In(r,""+U):y!=="suppressContentEditableWarning"&&y!=="suppressHydrationWarning"&&y!=="autoFocus"&&(a.hasOwnProperty(y)?U!=null&&y==="onScroll"&&Ut("scroll",r):U!=null&&we(r,y,U,E))}switch(l){case"input":pe(r),xt(r,h,!1);break;case"textarea":pe(r),Kn(r);break;case"option":h.value!=null&&r.setAttribute("value",""+ae(h.value));break;case"select":r.multiple=!!h.multiple,y=h.value,y!=null?mn(r,!!h.multiple,y,!1):h.defaultValue!=null&&mn(r,!!h.multiple,h.defaultValue,!0);break;default:typeof p.onClick=="function"&&(r.onclick=Nc)}switch(l){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}}h&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return nr(i),null;case 6:if(r&&i.stateNode!=null)Og(r,i,r.memoizedProps,h);else{if(typeof h!="string"&&i.stateNode===null)throw Error(t(166));if(l=va(ml.current),va(ks.current),Vc(i)){if(h=i.stateNode,l=i.memoizedProps,h[js]=i,(y=h.nodeValue!==l)&&(r=Dr,r!==null))switch(r.tag){case 3:Pc(h.nodeValue,l,(r.mode&1)!==0);break;case 5:r.memoizedProps.suppressHydrationWarning!==!0&&Pc(h.nodeValue,l,(r.mode&1)!==0)}y&&(i.flags|=4)}else h=(l.nodeType===9?l:l.ownerDocument).createTextNode(h),h[js]=i,i.stateNode=h}return nr(i),null;case 13:if(zt(qt),h=i.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(Gt&&Lr!==null&&(i.mode&1)!==0&&(i.flags&128)===0)zm(),co(),i.flags|=98560,y=!1;else if(y=Vc(i),h!==null&&h.dehydrated!==null){if(r===null){if(!y)throw Error(t(318));if(y=i.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(t(317));y[js]=i}else co(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;nr(i),y=!1}else hs!==null&&(zh(hs),hs=null),y=!0;if(!y)return i.flags&65536?i:null}return(i.flags&128)!==0?(i.lanes=l,i):(h=h!==null,h!==(r!==null&&r.memoizedState!==null)&&h&&(i.child.flags|=8192,(i.mode&1)!==0&&(r===null||(qt.current&1)!==0?Tn===0&&(Tn=3):Wh())),i.updateQueue!==null&&(i.flags|=4),nr(i),null);case 4:return po(),Rh(r,i),r===null&&ll(i.stateNode.containerInfo),nr(i),null;case 10:return sh(i.type._context),nr(i),null;case 17:return vr(i.type)&&Ac(),nr(i),null;case 19:if(zt(qt),y=i.memoizedState,y===null)return nr(i),null;if(h=(i.flags&128)!==0,E=y.rendering,E===null)if(h)xl(y,!1);else{if(Tn!==0||r!==null&&(r.flags&128)!==0)for(r=i.child;r!==null;){if(E=Bc(r),E!==null){for(i.flags|=128,xl(y,!1),h=E.updateQueue,h!==null&&(i.updateQueue=h,i.flags|=4),i.subtreeFlags=0,h=l,l=i.child;l!==null;)y=l,r=h,y.flags&=14680066,E=y.alternate,E===null?(y.childLanes=0,y.lanes=r,y.child=null,y.subtreeFlags=0,y.memoizedProps=null,y.memoizedState=null,y.updateQueue=null,y.dependencies=null,y.stateNode=null):(y.childLanes=E.childLanes,y.lanes=E.lanes,y.child=E.child,y.subtreeFlags=0,y.deletions=null,y.memoizedProps=E.memoizedProps,y.memoizedState=E.memoizedState,y.updateQueue=E.updateQueue,y.type=E.type,r=E.dependencies,y.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),l=l.sibling;return Vt(qt,qt.current&1|2),i.child}r=r.sibling}y.tail!==null&&dt()>vo&&(i.flags|=128,h=!0,xl(y,!1),i.lanes=4194304)}else{if(!h)if(r=Bc(E),r!==null){if(i.flags|=128,h=!0,l=r.updateQueue,l!==null&&(i.updateQueue=l,i.flags|=4),xl(y,!0),y.tail===null&&y.tailMode==="hidden"&&!E.alternate&&!Gt)return nr(i),null}else 2*dt()-y.renderingStartTime>vo&&l!==1073741824&&(i.flags|=128,h=!0,xl(y,!1),i.lanes=4194304);y.isBackwards?(E.sibling=i.child,i.child=E):(l=y.last,l!==null?l.sibling=E:i.child=E,y.last=E)}return y.tail!==null?(i=y.tail,y.rendering=i,y.tail=i.sibling,y.renderingStartTime=dt(),i.sibling=null,l=qt.current,Vt(qt,h?l&1|2:l&1),i):(nr(i),null);case 22:case 23:return $h(),h=i.memoizedState!==null,r!==null&&r.memoizedState!==null!==h&&(i.flags|=8192),h&&(i.mode&1)!==0?(Vr&1073741824)!==0&&(nr(i),i.subtreeFlags&6&&(i.flags|=8192)):nr(i),null;case 24:return null;case 25:return null}throw Error(t(156,i.tag))}function Xw(r,i){switch(Xd(i),i.tag){case 1:return vr(i.type)&&Ac(),r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 3:return po(),zt(yr),zt(er),dh(),r=i.flags,(r&65536)!==0&&(r&128)===0?(i.flags=r&-65537|128,i):null;case 5:return ch(i),null;case 13:if(zt(qt),r=i.memoizedState,r!==null&&r.dehydrated!==null){if(i.alternate===null)throw Error(t(340));co()}return r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 19:return zt(qt),null;case 4:return po(),null;case 10:return sh(i.type._context),null;case 22:case 23:return $h(),null;case 24:return null;default:return null}}var Jc=!1,rr=!1,Zw=typeof WeakSet=="function"?WeakSet:Set,$e=null;function go(r,i){var l=r.ref;if(l!==null)if(typeof l=="function")try{l(null)}catch(h){Jt(r,i,h)}else l.current=null}function Ah(r,i,l){try{l()}catch(h){Jt(r,i,h)}}var Fg=!1;function eE(r,i){if($d=wi,r=ym(),Ld(r)){if("selectionStart"in r)var l={start:r.selectionStart,end:r.selectionEnd};else e:{l=(l=r.ownerDocument)&&l.defaultView||window;var h=l.getSelection&&l.getSelection();if(h&&h.rangeCount!==0){l=h.anchorNode;var p=h.anchorOffset,y=h.focusNode;h=h.focusOffset;try{l.nodeType,y.nodeType}catch{l=null;break e}var E=0,j=-1,U=-1,ee=0,_e=0,Se=r,me=null;t:for(;;){for(var Fe;Se!==l||p!==0&&Se.nodeType!==3||(j=E+p),Se!==y||h!==0&&Se.nodeType!==3||(U=E+h),Se.nodeType===3&&(E+=Se.nodeValue.length),(Fe=Se.firstChild)!==null;)me=Se,Se=Fe;for(;;){if(Se===r)break t;if(me===l&&++ee===p&&(j=E),me===y&&++_e===h&&(U=E),(Fe=Se.nextSibling)!==null)break;Se=me,me=Se.parentNode}Se=Fe}l=j===-1||U===-1?null:{start:j,end:U}}else l=null}l=l||{start:0,end:0}}else l=null;for(Wd={focusedElem:r,selectionRange:l},wi=!1,$e=i;$e!==null;)if(i=$e,r=i.child,(i.subtreeFlags&1028)!==0&&r!==null)r.return=i,$e=r;else for(;$e!==null;){i=$e;try{var We=i.alternate;if((i.flags&1024)!==0)switch(i.tag){case 0:case 11:case 15:break;case 1:if(We!==null){var He=We.memoizedProps,sn=We.memoizedState,X=i.stateNode,H=X.getSnapshotBeforeUpdate(i.elementType===i.type?He:fs(i.type,He),sn);X.__reactInternalSnapshotBeforeUpdate=H}break;case 3:var Z=i.stateNode.containerInfo;Z.nodeType===1?Z.textContent="":Z.nodeType===9&&Z.documentElement&&Z.removeChild(Z.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Ae){Jt(i,i.return,Ae)}if(r=i.sibling,r!==null){r.return=i.return,$e=r;break}$e=i.return}return We=Fg,Fg=!1,We}function wl(r,i,l){var h=i.updateQueue;if(h=h!==null?h.lastEffect:null,h!==null){var p=h=h.next;do{if((p.tag&r)===r){var y=p.destroy;p.destroy=void 0,y!==void 0&&Ah(i,l,y)}p=p.next}while(p!==h)}}function Xc(r,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var l=i=i.next;do{if((l.tag&r)===r){var h=l.create;l.destroy=h()}l=l.next}while(l!==i)}}function jh(r){var i=r.ref;if(i!==null){var l=r.stateNode;switch(r.tag){case 5:r=l;break;default:r=l}typeof i=="function"?i(r):i.current=r}}function Ug(r){var i=r.alternate;i!==null&&(r.alternate=null,Ug(i)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(i=r.stateNode,i!==null&&(delete i[js],delete i[ul],delete i[Kd],delete i[Vw],delete i[Mw])),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}function zg(r){return r.tag===5||r.tag===3||r.tag===4}function Bg(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||zg(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function kh(r,i,l){var h=r.tag;if(h===5||h===6)r=r.stateNode,i?l.nodeType===8?l.parentNode.insertBefore(r,i):l.insertBefore(r,i):(l.nodeType===8?(i=l.parentNode,i.insertBefore(r,l)):(i=l,i.appendChild(r)),l=l._reactRootContainer,l!=null||i.onclick!==null||(i.onclick=Nc));else if(h!==4&&(r=r.child,r!==null))for(kh(r,i,l),r=r.sibling;r!==null;)kh(r,i,l),r=r.sibling}function Dh(r,i,l){var h=r.tag;if(h===5||h===6)r=r.stateNode,i?l.insertBefore(r,i):l.appendChild(r);else if(h!==4&&(r=r.child,r!==null))for(Dh(r,i,l),r=r.sibling;r!==null;)Dh(r,i,l),r=r.sibling}var $n=null,ps=!1;function Ri(r,i,l){for(l=l.child;l!==null;)$g(r,i,l),l=l.sibling}function $g(r,i,l){if(oe&&typeof oe.onCommitFiberUnmount=="function")try{oe.onCommitFiberUnmount(q,l)}catch{}switch(l.tag){case 5:rr||go(l,i);case 6:var h=$n,p=ps;$n=null,Ri(r,i,l),$n=h,ps=p,$n!==null&&(ps?(r=$n,l=l.stateNode,r.nodeType===8?r.parentNode.removeChild(l):r.removeChild(l)):$n.removeChild(l.stateNode));break;case 18:$n!==null&&(ps?(r=$n,l=l.stateNode,r.nodeType===8?Hd(r.parentNode,l):r.nodeType===1&&Hd(r,l),zn(r)):Hd($n,l.stateNode));break;case 4:h=$n,p=ps,$n=l.stateNode.containerInfo,ps=!0,Ri(r,i,l),$n=h,ps=p;break;case 0:case 11:case 14:case 15:if(!rr&&(h=l.updateQueue,h!==null&&(h=h.lastEffect,h!==null))){p=h=h.next;do{var y=p,E=y.destroy;y=y.tag,E!==void 0&&((y&2)!==0||(y&4)!==0)&&Ah(l,i,E),p=p.next}while(p!==h)}Ri(r,i,l);break;case 1:if(!rr&&(go(l,i),h=l.stateNode,typeof h.componentWillUnmount=="function"))try{h.props=l.memoizedProps,h.state=l.memoizedState,h.componentWillUnmount()}catch(j){Jt(l,i,j)}Ri(r,i,l);break;case 21:Ri(r,i,l);break;case 22:l.mode&1?(rr=(h=rr)||l.memoizedState!==null,Ri(r,i,l),rr=h):Ri(r,i,l);break;default:Ri(r,i,l)}}function Wg(r){var i=r.updateQueue;if(i!==null){r.updateQueue=null;var l=r.stateNode;l===null&&(l=r.stateNode=new Zw),i.forEach(function(h){var p=cE.bind(null,r,h);l.has(h)||(l.add(h),h.then(p,p))})}}function ms(r,i){var l=i.deletions;if(l!==null)for(var h=0;h<l.length;h++){var p=l[h];try{var y=r,E=i,j=E;e:for(;j!==null;){switch(j.tag){case 5:$n=j.stateNode,ps=!1;break e;case 3:$n=j.stateNode.containerInfo,ps=!0;break e;case 4:$n=j.stateNode.containerInfo,ps=!0;break e}j=j.return}if($n===null)throw Error(t(160));$g(y,E,p),$n=null,ps=!1;var U=p.alternate;U!==null&&(U.return=null),p.return=null}catch(ee){Jt(p,i,ee)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)Gg(i,r),i=i.sibling}function Gg(r,i){var l=r.alternate,h=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:if(ms(i,r),Ls(r),h&4){try{wl(3,r,r.return),Xc(3,r)}catch(He){Jt(r,r.return,He)}try{wl(5,r,r.return)}catch(He){Jt(r,r.return,He)}}break;case 1:ms(i,r),Ls(r),h&512&&l!==null&&go(l,l.return);break;case 5:if(ms(i,r),Ls(r),h&512&&l!==null&&go(l,l.return),r.flags&32){var p=r.stateNode;try{In(p,"")}catch(He){Jt(r,r.return,He)}}if(h&4&&(p=r.stateNode,p!=null)){var y=r.memoizedProps,E=l!==null?l.memoizedProps:y,j=r.type,U=r.updateQueue;if(r.updateQueue=null,U!==null)try{j==="input"&&y.type==="radio"&&y.name!=null&&_t(p,y),Ts(j,E);var ee=Ts(j,y);for(E=0;E<U.length;E+=2){var _e=U[E],Se=U[E+1];_e==="style"?Cn(p,Se):_e==="dangerouslySetInnerHTML"?lr(p,Se):_e==="children"?In(p,Se):we(p,_e,Se,ee)}switch(j){case"input":Nt(p,y);break;case"textarea":tn(p,y);break;case"select":var me=p._wrapperState.wasMultiple;p._wrapperState.wasMultiple=!!y.multiple;var Fe=y.value;Fe!=null?mn(p,!!y.multiple,Fe,!1):me!==!!y.multiple&&(y.defaultValue!=null?mn(p,!!y.multiple,y.defaultValue,!0):mn(p,!!y.multiple,y.multiple?[]:"",!1))}p[ul]=y}catch(He){Jt(r,r.return,He)}}break;case 6:if(ms(i,r),Ls(r),h&4){if(r.stateNode===null)throw Error(t(162));p=r.stateNode,y=r.memoizedProps;try{p.nodeValue=y}catch(He){Jt(r,r.return,He)}}break;case 3:if(ms(i,r),Ls(r),h&4&&l!==null&&l.memoizedState.isDehydrated)try{zn(i.containerInfo)}catch(He){Jt(r,r.return,He)}break;case 4:ms(i,r),Ls(r);break;case 13:ms(i,r),Ls(r),p=r.child,p.flags&8192&&(y=p.memoizedState!==null,p.stateNode.isHidden=y,!y||p.alternate!==null&&p.alternate.memoizedState!==null||(Mh=dt())),h&4&&Wg(r);break;case 22:if(_e=l!==null&&l.memoizedState!==null,r.mode&1?(rr=(ee=rr)||_e,ms(i,r),rr=ee):ms(i,r),Ls(r),h&8192){if(ee=r.memoizedState!==null,(r.stateNode.isHidden=ee)&&!_e&&(r.mode&1)!==0)for($e=r,_e=r.child;_e!==null;){for(Se=$e=_e;$e!==null;){switch(me=$e,Fe=me.child,me.tag){case 0:case 11:case 14:case 15:wl(4,me,me.return);break;case 1:go(me,me.return);var We=me.stateNode;if(typeof We.componentWillUnmount=="function"){h=me,l=me.return;try{i=h,We.props=i.memoizedProps,We.state=i.memoizedState,We.componentWillUnmount()}catch(He){Jt(h,l,He)}}break;case 5:go(me,me.return);break;case 22:if(me.memoizedState!==null){Kg(Se);continue}}Fe!==null?(Fe.return=me,$e=Fe):Kg(Se)}_e=_e.sibling}e:for(_e=null,Se=r;;){if(Se.tag===5){if(_e===null){_e=Se;try{p=Se.stateNode,ee?(y=p.style,typeof y.setProperty=="function"?y.setProperty("display","none","important"):y.display="none"):(j=Se.stateNode,U=Se.memoizedProps.style,E=U!=null&&U.hasOwnProperty("display")?U.display:null,j.style.display=es("display",E))}catch(He){Jt(r,r.return,He)}}}else if(Se.tag===6){if(_e===null)try{Se.stateNode.nodeValue=ee?"":Se.memoizedProps}catch(He){Jt(r,r.return,He)}}else if((Se.tag!==22&&Se.tag!==23||Se.memoizedState===null||Se===r)&&Se.child!==null){Se.child.return=Se,Se=Se.child;continue}if(Se===r)break e;for(;Se.sibling===null;){if(Se.return===null||Se.return===r)break e;_e===Se&&(_e=null),Se=Se.return}_e===Se&&(_e=null),Se.sibling.return=Se.return,Se=Se.sibling}}break;case 19:ms(i,r),Ls(r),h&4&&Wg(r);break;case 21:break;default:ms(i,r),Ls(r)}}function Ls(r){var i=r.flags;if(i&2){try{e:{for(var l=r.return;l!==null;){if(zg(l)){var h=l;break e}l=l.return}throw Error(t(160))}switch(h.tag){case 5:var p=h.stateNode;h.flags&32&&(In(p,""),h.flags&=-33);var y=Bg(r);Dh(r,y,p);break;case 3:case 4:var E=h.stateNode.containerInfo,j=Bg(r);kh(r,j,E);break;default:throw Error(t(161))}}catch(U){Jt(r,r.return,U)}r.flags&=-3}i&4096&&(r.flags&=-4097)}function tE(r,i,l){$e=r,qg(r)}function qg(r,i,l){for(var h=(r.mode&1)!==0;$e!==null;){var p=$e,y=p.child;if(p.tag===22&&h){var E=p.memoizedState!==null||Jc;if(!E){var j=p.alternate,U=j!==null&&j.memoizedState!==null||rr;j=Jc;var ee=rr;if(Jc=E,(rr=U)&&!ee)for($e=p;$e!==null;)E=$e,U=E.child,E.tag===22&&E.memoizedState!==null?Qg(p):U!==null?(U.return=E,$e=U):Qg(p);for(;y!==null;)$e=y,qg(y),y=y.sibling;$e=p,Jc=j,rr=ee}Hg(r)}else(p.subtreeFlags&8772)!==0&&y!==null?(y.return=p,$e=y):Hg(r)}}function Hg(r){for(;$e!==null;){var i=$e;if((i.flags&8772)!==0){var l=i.alternate;try{if((i.flags&8772)!==0)switch(i.tag){case 0:case 11:case 15:rr||Xc(5,i);break;case 1:var h=i.stateNode;if(i.flags&4&&!rr)if(l===null)h.componentDidMount();else{var p=i.elementType===i.type?l.memoizedProps:fs(i.type,l.memoizedProps);h.componentDidUpdate(p,l.memoizedState,h.__reactInternalSnapshotBeforeUpdate)}var y=i.updateQueue;y!==null&&Km(i,y,h);break;case 3:var E=i.updateQueue;if(E!==null){if(l=null,i.child!==null)switch(i.child.tag){case 5:l=i.child.stateNode;break;case 1:l=i.child.stateNode}Km(i,E,l)}break;case 5:var j=i.stateNode;if(l===null&&i.flags&4){l=j;var U=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":U.autoFocus&&l.focus();break;case"img":U.src&&(l.src=U.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var ee=i.alternate;if(ee!==null){var _e=ee.memoizedState;if(_e!==null){var Se=_e.dehydrated;Se!==null&&zn(Se)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}rr||i.flags&512&&jh(i)}catch(me){Jt(i,i.return,me)}}if(i===r){$e=null;break}if(l=i.sibling,l!==null){l.return=i.return,$e=l;break}$e=i.return}}function Kg(r){for(;$e!==null;){var i=$e;if(i===r){$e=null;break}var l=i.sibling;if(l!==null){l.return=i.return,$e=l;break}$e=i.return}}function Qg(r){for(;$e!==null;){var i=$e;try{switch(i.tag){case 0:case 11:case 15:var l=i.return;try{Xc(4,i)}catch(U){Jt(i,l,U)}break;case 1:var h=i.stateNode;if(typeof h.componentDidMount=="function"){var p=i.return;try{h.componentDidMount()}catch(U){Jt(i,p,U)}}var y=i.return;try{jh(i)}catch(U){Jt(i,y,U)}break;case 5:var E=i.return;try{jh(i)}catch(U){Jt(i,E,U)}}}catch(U){Jt(i,i.return,U)}if(i===r){$e=null;break}var j=i.sibling;if(j!==null){j.return=i.return,$e=j;break}$e=i.return}}var nE=Math.ceil,Zc=ge.ReactCurrentDispatcher,Lh=ge.ReactCurrentOwner,Hr=ge.ReactCurrentBatchConfig,bt=0,Ln=null,dn=null,Wn=0,Vr=0,yo=bi(0),Tn=0,El=null,xa=0,eu=0,Vh=0,Tl=null,xr=null,Mh=0,vo=1/0,ai=null,tu=!1,Oh=null,Ai=null,nu=!1,ji=null,ru=0,Sl=0,Fh=null,su=-1,iu=0;function hr(){return(bt&6)!==0?dt():su!==-1?su:su=dt()}function ki(r){return(r.mode&1)===0?1:(bt&2)!==0&&Wn!==0?Wn&-Wn:Fw.transition!==null?(iu===0&&(iu=as()),iu):(r=pt,r!==0||(r=window.event,r=r===void 0?16:Xo(r.type)),r)}function gs(r,i,l,h){if(50<Sl)throw Sl=0,Fh=null,Error(t(185));ls(r,l,h),((bt&2)===0||r!==Ln)&&(r===Ln&&((bt&2)===0&&(eu|=l),Tn===4&&Di(r,Wn)),wr(r,h),l===1&&bt===0&&(i.mode&1)===0&&(vo=dt()+500,kc&&Ci()))}function wr(r,i){var l=r.callbackNode;_n(r,i);var h=cr(r,r===Ln?Wn:0);if(h===0)l!==null&&vn(l),r.callbackNode=null,r.callbackPriority=0;else if(i=h&-h,r.callbackPriority!==i){if(l!=null&&vn(l),i===1)r.tag===0?Ow(Jg.bind(null,r)):Vm(Jg.bind(null,r)),Dw(function(){(bt&6)===0&&Ci()}),l=null;else{switch(Ps(h)){case 1:l=jn;break;case 4:l=w;break;case 16:l=B;break;case 536870912:l=L;break;default:l=B}l=iy(l,Yg.bind(null,r))}r.callbackPriority=i,r.callbackNode=l}}function Yg(r,i){if(su=-1,iu=0,(bt&6)!==0)throw Error(t(327));var l=r.callbackNode;if(_o()&&r.callbackNode!==l)return null;var h=cr(r,r===Ln?Wn:0);if(h===0)return null;if((h&30)!==0||(h&r.expiredLanes)!==0||i)i=au(r,h);else{i=h;var p=bt;bt|=2;var y=Zg();(Ln!==r||Wn!==i)&&(ai=null,vo=dt()+500,Ea(r,i));do try{iE();break}catch(j){Xg(r,j)}while(!0);rh(),Zc.current=y,bt=p,dn!==null?i=0:(Ln=null,Wn=0,i=Tn)}if(i!==0){if(i===2&&(p=Yt(r),p!==0&&(h=p,i=Uh(r,p))),i===1)throw l=El,Ea(r,0),Di(r,h),wr(r,dt()),l;if(i===6)Di(r,h);else{if(p=r.current.alternate,(h&30)===0&&!rE(p)&&(i=au(r,h),i===2&&(y=Yt(r),y!==0&&(h=y,i=Uh(r,y))),i===1))throw l=El,Ea(r,0),Di(r,h),wr(r,dt()),l;switch(r.finishedWork=p,r.finishedLanes=h,i){case 0:case 1:throw Error(t(345));case 2:Ta(r,xr,ai);break;case 3:if(Di(r,h),(h&130023424)===h&&(i=Mh+500-dt(),10<i)){if(cr(r,0)!==0)break;if(p=r.suspendedLanes,(p&h)!==h){hr(),r.pingedLanes|=r.suspendedLanes&p;break}r.timeoutHandle=qd(Ta.bind(null,r,xr,ai),i);break}Ta(r,xr,ai);break;case 4:if(Di(r,h),(h&4194240)===h)break;for(i=r.eventTimes,p=-1;0<h;){var E=31-Ce(h);y=1<<E,E=i[E],E>p&&(p=E),h&=~y}if(h=p,h=dt()-h,h=(120>h?120:480>h?480:1080>h?1080:1920>h?1920:3e3>h?3e3:4320>h?4320:1960*nE(h/1960))-h,10<h){r.timeoutHandle=qd(Ta.bind(null,r,xr,ai),h);break}Ta(r,xr,ai);break;case 5:Ta(r,xr,ai);break;default:throw Error(t(329))}}}return wr(r,dt()),r.callbackNode===l?Yg.bind(null,r):null}function Uh(r,i){var l=Tl;return r.current.memoizedState.isDehydrated&&(Ea(r,i).flags|=256),r=au(r,i),r!==2&&(i=xr,xr=l,i!==null&&zh(i)),r}function zh(r){xr===null?xr=r:xr.push.apply(xr,r)}function rE(r){for(var i=r;;){if(i.flags&16384){var l=i.updateQueue;if(l!==null&&(l=l.stores,l!==null))for(var h=0;h<l.length;h++){var p=l[h],y=p.getSnapshot;p=p.value;try{if(!ds(y(),p))return!1}catch{return!1}}}if(l=i.child,i.subtreeFlags&16384&&l!==null)l.return=i,i=l;else{if(i===r)break;for(;i.sibling===null;){if(i.return===null||i.return===r)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Di(r,i){for(i&=~Vh,i&=~eu,r.suspendedLanes|=i,r.pingedLanes&=~i,r=r.expirationTimes;0<i;){var l=31-Ce(i),h=1<<l;r[l]=-1,i&=~h}}function Jg(r){if((bt&6)!==0)throw Error(t(327));_o();var i=cr(r,0);if((i&1)===0)return wr(r,dt()),null;var l=au(r,i);if(r.tag!==0&&l===2){var h=Yt(r);h!==0&&(i=h,l=Uh(r,h))}if(l===1)throw l=El,Ea(r,0),Di(r,i),wr(r,dt()),l;if(l===6)throw Error(t(345));return r.finishedWork=r.current.alternate,r.finishedLanes=i,Ta(r,xr,ai),wr(r,dt()),null}function Bh(r,i){var l=bt;bt|=1;try{return r(i)}finally{bt=l,bt===0&&(vo=dt()+500,kc&&Ci())}}function wa(r){ji!==null&&ji.tag===0&&(bt&6)===0&&_o();var i=bt;bt|=1;var l=Hr.transition,h=pt;try{if(Hr.transition=null,pt=1,r)return r()}finally{pt=h,Hr.transition=l,bt=i,(bt&6)===0&&Ci()}}function $h(){Vr=yo.current,zt(yo)}function Ea(r,i){r.finishedWork=null,r.finishedLanes=0;var l=r.timeoutHandle;if(l!==-1&&(r.timeoutHandle=-1,kw(l)),dn!==null)for(l=dn.return;l!==null;){var h=l;switch(Xd(h),h.tag){case 1:h=h.type.childContextTypes,h!=null&&Ac();break;case 3:po(),zt(yr),zt(er),dh();break;case 5:ch(h);break;case 4:po();break;case 13:zt(qt);break;case 19:zt(qt);break;case 10:sh(h.type._context);break;case 22:case 23:$h()}l=l.return}if(Ln=r,dn=r=Li(r.current,null),Wn=Vr=i,Tn=0,El=null,Vh=eu=xa=0,xr=Tl=null,ya!==null){for(i=0;i<ya.length;i++)if(l=ya[i],h=l.interleaved,h!==null){l.interleaved=null;var p=h.next,y=l.pending;if(y!==null){var E=y.next;y.next=p,h.next=E}l.pending=h}ya=null}return r}function Xg(r,i){do{var l=dn;try{if(rh(),$c.current=Hc,Wc){for(var h=Ht.memoizedState;h!==null;){var p=h.queue;p!==null&&(p.pending=null),h=h.next}Wc=!1}if(_a=0,Dn=En=Ht=null,gl=!1,yl=0,Lh.current=null,l===null||l.return===null){Tn=1,El=i,dn=null;break}e:{var y=r,E=l.return,j=l,U=i;if(i=Wn,j.flags|=32768,U!==null&&typeof U=="object"&&typeof U.then=="function"){var ee=U,_e=j,Se=_e.tag;if((_e.mode&1)===0&&(Se===0||Se===11||Se===15)){var me=_e.alternate;me?(_e.updateQueue=me.updateQueue,_e.memoizedState=me.memoizedState,_e.lanes=me.lanes):(_e.updateQueue=null,_e.memoizedState=null)}var Fe=Tg(E);if(Fe!==null){Fe.flags&=-257,Sg(Fe,E,j,y,i),Fe.mode&1&&Eg(y,ee,i),i=Fe,U=ee;var We=i.updateQueue;if(We===null){var He=new Set;He.add(U),i.updateQueue=He}else We.add(U);break e}else{if((i&1)===0){Eg(y,ee,i),Wh();break e}U=Error(t(426))}}else if(Gt&&j.mode&1){var sn=Tg(E);if(sn!==null){(sn.flags&65536)===0&&(sn.flags|=256),Sg(sn,E,j,y,i),th(mo(U,j));break e}}y=U=mo(U,j),Tn!==4&&(Tn=2),Tl===null?Tl=[y]:Tl.push(y),y=E;do{switch(y.tag){case 3:y.flags|=65536,i&=-i,y.lanes|=i;var X=xg(y,U,i);Hm(y,X);break e;case 1:j=U;var H=y.type,Z=y.stateNode;if((y.flags&128)===0&&(typeof H.getDerivedStateFromError=="function"||Z!==null&&typeof Z.componentDidCatch=="function"&&(Ai===null||!Ai.has(Z)))){y.flags|=65536,i&=-i,y.lanes|=i;var Ae=wg(y,j,i);Hm(y,Ae);break e}}y=y.return}while(y!==null)}ty(l)}catch(Ke){i=Ke,dn===l&&l!==null&&(dn=l=l.return);continue}break}while(!0)}function Zg(){var r=Zc.current;return Zc.current=Hc,r===null?Hc:r}function Wh(){(Tn===0||Tn===3||Tn===2)&&(Tn=4),Ln===null||(xa&268435455)===0&&(eu&268435455)===0||Di(Ln,Wn)}function au(r,i){var l=bt;bt|=2;var h=Zg();(Ln!==r||Wn!==i)&&(ai=null,Ea(r,i));do try{sE();break}catch(p){Xg(r,p)}while(!0);if(rh(),bt=l,Zc.current=h,dn!==null)throw Error(t(261));return Ln=null,Wn=0,Tn}function sE(){for(;dn!==null;)ey(dn)}function iE(){for(;dn!==null&&!Hs();)ey(dn)}function ey(r){var i=sy(r.alternate,r,Vr);r.memoizedProps=r.pendingProps,i===null?ty(r):dn=i,Lh.current=null}function ty(r){var i=r;do{var l=i.alternate;if(r=i.return,(i.flags&32768)===0){if(l=Jw(l,i,Vr),l!==null){dn=l;return}}else{if(l=Xw(l,i),l!==null){l.flags&=32767,dn=l;return}if(r!==null)r.flags|=32768,r.subtreeFlags=0,r.deletions=null;else{Tn=6,dn=null;return}}if(i=i.sibling,i!==null){dn=i;return}dn=i=r}while(i!==null);Tn===0&&(Tn=5)}function Ta(r,i,l){var h=pt,p=Hr.transition;try{Hr.transition=null,pt=1,aE(r,i,l,h)}finally{Hr.transition=p,pt=h}return null}function aE(r,i,l,h){do _o();while(ji!==null);if((bt&6)!==0)throw Error(t(327));l=r.finishedWork;var p=r.finishedLanes;if(l===null)return null;if(r.finishedWork=null,r.finishedLanes=0,l===r.current)throw Error(t(177));r.callbackNode=null,r.callbackPriority=0;var y=l.lanes|l.childLanes;if(Rt(r,y),r===Ln&&(dn=Ln=null,Wn=0),(l.subtreeFlags&2064)===0&&(l.flags&2064)===0||nu||(nu=!0,iy(B,function(){return _o(),null})),y=(l.flags&15990)!==0,(l.subtreeFlags&15990)!==0||y){y=Hr.transition,Hr.transition=null;var E=pt;pt=1;var j=bt;bt|=4,Lh.current=null,eE(r,l),Gg(l,r),Iw(Wd),wi=!!$d,Wd=$d=null,r.current=l,tE(l),Ks(),bt=j,pt=E,Hr.transition=y}else r.current=l;if(nu&&(nu=!1,ji=r,ru=p),y=r.pendingLanes,y===0&&(Ai=null),se(l.stateNode),wr(r,dt()),i!==null)for(h=r.onRecoverableError,l=0;l<i.length;l++)p=i[l],h(p.value,{componentStack:p.stack,digest:p.digest});if(tu)throw tu=!1,r=Oh,Oh=null,r;return(ru&1)!==0&&r.tag!==0&&_o(),y=r.pendingLanes,(y&1)!==0?r===Fh?Sl++:(Sl=0,Fh=r):Sl=0,Ci(),null}function _o(){if(ji!==null){var r=Ps(ru),i=Hr.transition,l=pt;try{if(Hr.transition=null,pt=16>r?16:r,ji===null)var h=!1;else{if(r=ji,ji=null,ru=0,(bt&6)!==0)throw Error(t(331));var p=bt;for(bt|=4,$e=r.current;$e!==null;){var y=$e,E=y.child;if(($e.flags&16)!==0){var j=y.deletions;if(j!==null){for(var U=0;U<j.length;U++){var ee=j[U];for($e=ee;$e!==null;){var _e=$e;switch(_e.tag){case 0:case 11:case 15:wl(8,_e,y)}var Se=_e.child;if(Se!==null)Se.return=_e,$e=Se;else for(;$e!==null;){_e=$e;var me=_e.sibling,Fe=_e.return;if(Ug(_e),_e===ee){$e=null;break}if(me!==null){me.return=Fe,$e=me;break}$e=Fe}}}var We=y.alternate;if(We!==null){var He=We.child;if(He!==null){We.child=null;do{var sn=He.sibling;He.sibling=null,He=sn}while(He!==null)}}$e=y}}if((y.subtreeFlags&2064)!==0&&E!==null)E.return=y,$e=E;else e:for(;$e!==null;){if(y=$e,(y.flags&2048)!==0)switch(y.tag){case 0:case 11:case 15:wl(9,y,y.return)}var X=y.sibling;if(X!==null){X.return=y.return,$e=X;break e}$e=y.return}}var H=r.current;for($e=H;$e!==null;){E=$e;var Z=E.child;if((E.subtreeFlags&2064)!==0&&Z!==null)Z.return=E,$e=Z;else e:for(E=H;$e!==null;){if(j=$e,(j.flags&2048)!==0)try{switch(j.tag){case 0:case 11:case 15:Xc(9,j)}}catch(Ke){Jt(j,j.return,Ke)}if(j===E){$e=null;break e}var Ae=j.sibling;if(Ae!==null){Ae.return=j.return,$e=Ae;break e}$e=j.return}}if(bt=p,Ci(),oe&&typeof oe.onPostCommitFiberRoot=="function")try{oe.onPostCommitFiberRoot(q,r)}catch{}h=!0}return h}finally{pt=l,Hr.transition=i}}return!1}function ny(r,i,l){i=mo(l,i),i=xg(r,i,1),r=Ni(r,i,1),i=hr(),r!==null&&(ls(r,1,i),wr(r,i))}function Jt(r,i,l){if(r.tag===3)ny(r,r,l);else for(;i!==null;){if(i.tag===3){ny(i,r,l);break}else if(i.tag===1){var h=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(Ai===null||!Ai.has(h))){r=mo(l,r),r=wg(i,r,1),i=Ni(i,r,1),r=hr(),i!==null&&(ls(i,1,r),wr(i,r));break}}i=i.return}}function oE(r,i,l){var h=r.pingCache;h!==null&&h.delete(i),i=hr(),r.pingedLanes|=r.suspendedLanes&l,Ln===r&&(Wn&l)===l&&(Tn===4||Tn===3&&(Wn&130023424)===Wn&&500>dt()-Mh?Ea(r,0):Vh|=l),wr(r,i)}function ry(r,i){i===0&&((r.mode&1)===0?i=1:(i=Le,Le<<=1,(Le&130023424)===0&&(Le=4194304)));var l=hr();r=ri(r,i),r!==null&&(ls(r,i,l),wr(r,l))}function lE(r){var i=r.memoizedState,l=0;i!==null&&(l=i.retryLane),ry(r,l)}function cE(r,i){var l=0;switch(r.tag){case 13:var h=r.stateNode,p=r.memoizedState;p!==null&&(l=p.retryLane);break;case 19:h=r.stateNode;break;default:throw Error(t(314))}h!==null&&h.delete(i),ry(r,l)}var sy;sy=function(r,i,l){if(r!==null)if(r.memoizedProps!==i.pendingProps||yr.current)_r=!0;else{if((r.lanes&l)===0&&(i.flags&128)===0)return _r=!1,Yw(r,i,l);_r=(r.flags&131072)!==0}else _r=!1,Gt&&(i.flags&1048576)!==0&&Mm(i,Lc,i.index);switch(i.lanes=0,i.tag){case 2:var h=i.type;Yc(r,i),r=i.pendingProps;var p=ao(i,er.current);fo(i,l),p=ph(null,i,h,r,p,l);var y=mh();return i.flags|=1,typeof p=="object"&&p!==null&&typeof p.render=="function"&&p.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,vr(h)?(y=!0,jc(i)):y=!1,i.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,oh(i),p.updater=Kc,i.stateNode=p,p._reactInternals=i,wh(i,h,r,l),i=bh(null,i,h,!0,y,l)):(i.tag=0,Gt&&y&&Jd(i),dr(null,i,p,l),i=i.child),i;case 16:h=i.elementType;e:{switch(Yc(r,i),r=i.pendingProps,p=h._init,h=p(h._payload),i.type=h,p=i.tag=dE(h),r=fs(h,r),p){case 0:i=Sh(null,i,h,r,l);break e;case 1:i=Rg(null,i,h,r,l);break e;case 11:i=bg(null,i,h,r,l);break e;case 14:i=Ig(null,i,h,fs(h.type,r),l);break e}throw Error(t(306,h,""))}return i;case 0:return h=i.type,p=i.pendingProps,p=i.elementType===h?p:fs(h,p),Sh(r,i,h,p,l);case 1:return h=i.type,p=i.pendingProps,p=i.elementType===h?p:fs(h,p),Rg(r,i,h,p,l);case 3:e:{if(Ag(i),r===null)throw Error(t(387));h=i.pendingProps,y=i.memoizedState,p=y.element,qm(r,i),zc(i,h,null,l);var E=i.memoizedState;if(h=E.element,y.isDehydrated)if(y={element:h,isDehydrated:!1,cache:E.cache,pendingSuspenseBoundaries:E.pendingSuspenseBoundaries,transitions:E.transitions},i.updateQueue.baseState=y,i.memoizedState=y,i.flags&256){p=mo(Error(t(423)),i),i=jg(r,i,h,l,p);break e}else if(h!==p){p=mo(Error(t(424)),i),i=jg(r,i,h,l,p);break e}else for(Lr=Si(i.stateNode.containerInfo.firstChild),Dr=i,Gt=!0,hs=null,l=Wm(i,null,h,l),i.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling;else{if(co(),h===p){i=ii(r,i,l);break e}dr(r,i,h,l)}i=i.child}return i;case 5:return Qm(i),r===null&&eh(i),h=i.type,p=i.pendingProps,y=r!==null?r.memoizedProps:null,E=p.children,Gd(h,p)?E=null:y!==null&&Gd(h,y)&&(i.flags|=32),Ng(r,i),dr(r,i,E,l),i.child;case 6:return r===null&&eh(i),null;case 13:return kg(r,i,l);case 4:return lh(i,i.stateNode.containerInfo),h=i.pendingProps,r===null?i.child=uo(i,null,h,l):dr(r,i,h,l),i.child;case 11:return h=i.type,p=i.pendingProps,p=i.elementType===h?p:fs(h,p),bg(r,i,h,p,l);case 7:return dr(r,i,i.pendingProps,l),i.child;case 8:return dr(r,i,i.pendingProps.children,l),i.child;case 12:return dr(r,i,i.pendingProps.children,l),i.child;case 10:e:{if(h=i.type._context,p=i.pendingProps,y=i.memoizedProps,E=p.value,Vt(Oc,h._currentValue),h._currentValue=E,y!==null)if(ds(y.value,E)){if(y.children===p.children&&!yr.current){i=ii(r,i,l);break e}}else for(y=i.child,y!==null&&(y.return=i);y!==null;){var j=y.dependencies;if(j!==null){E=y.child;for(var U=j.firstContext;U!==null;){if(U.context===h){if(y.tag===1){U=si(-1,l&-l),U.tag=2;var ee=y.updateQueue;if(ee!==null){ee=ee.shared;var _e=ee.pending;_e===null?U.next=U:(U.next=_e.next,_e.next=U),ee.pending=U}}y.lanes|=l,U=y.alternate,U!==null&&(U.lanes|=l),ih(y.return,l,i),j.lanes|=l;break}U=U.next}}else if(y.tag===10)E=y.type===i.type?null:y.child;else if(y.tag===18){if(E=y.return,E===null)throw Error(t(341));E.lanes|=l,j=E.alternate,j!==null&&(j.lanes|=l),ih(E,l,i),E=y.sibling}else E=y.child;if(E!==null)E.return=y;else for(E=y;E!==null;){if(E===i){E=null;break}if(y=E.sibling,y!==null){y.return=E.return,E=y;break}E=E.return}y=E}dr(r,i,p.children,l),i=i.child}return i;case 9:return p=i.type,h=i.pendingProps.children,fo(i,l),p=Gr(p),h=h(p),i.flags|=1,dr(r,i,h,l),i.child;case 14:return h=i.type,p=fs(h,i.pendingProps),p=fs(h.type,p),Ig(r,i,h,p,l);case 15:return Cg(r,i,i.type,i.pendingProps,l);case 17:return h=i.type,p=i.pendingProps,p=i.elementType===h?p:fs(h,p),Yc(r,i),i.tag=1,vr(h)?(r=!0,jc(i)):r=!1,fo(i,l),vg(i,h,p),wh(i,h,p,l),bh(null,i,h,!0,r,l);case 19:return Lg(r,i,l);case 22:return Pg(r,i,l)}throw Error(t(156,i.tag))};function iy(r,i){return ss(r,i)}function uE(r,i,l,h){this.tag=r,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Kr(r,i,l,h){return new uE(r,i,l,h)}function Gh(r){return r=r.prototype,!(!r||!r.isReactComponent)}function dE(r){if(typeof r=="function")return Gh(r)?1:0;if(r!=null){if(r=r.$$typeof,r===k)return 11;if(r===Ge)return 14}return 2}function Li(r,i){var l=r.alternate;return l===null?(l=Kr(r.tag,i,r.key,r.mode),l.elementType=r.elementType,l.type=r.type,l.stateNode=r.stateNode,l.alternate=r,r.alternate=l):(l.pendingProps=i,l.type=r.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=r.flags&14680064,l.childLanes=r.childLanes,l.lanes=r.lanes,l.child=r.child,l.memoizedProps=r.memoizedProps,l.memoizedState=r.memoizedState,l.updateQueue=r.updateQueue,i=r.dependencies,l.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},l.sibling=r.sibling,l.index=r.index,l.ref=r.ref,l}function ou(r,i,l,h,p,y){var E=2;if(h=r,typeof r=="function")Gh(r)&&(E=1);else if(typeof r=="string")E=5;else e:switch(r){case D:return Sa(l.children,p,y,i);case N:E=8,p|=8;break;case C:return r=Kr(12,l,i,p|2),r.elementType=C,r.lanes=y,r;case P:return r=Kr(13,l,i,p),r.elementType=P,r.lanes=y,r;case ve:return r=Kr(19,l,i,p),r.elementType=ve,r.lanes=y,r;case ce:return lu(l,p,y,i);default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case O:E=10;break e;case G:E=9;break e;case k:E=11;break e;case Ge:E=14;break e;case Re:E=16,h=null;break e}throw Error(t(130,r==null?r:typeof r,""))}return i=Kr(E,l,i,p),i.elementType=r,i.type=h,i.lanes=y,i}function Sa(r,i,l,h){return r=Kr(7,r,h,i),r.lanes=l,r}function lu(r,i,l,h){return r=Kr(22,r,h,i),r.elementType=ce,r.lanes=l,r.stateNode={isHidden:!1},r}function qh(r,i,l){return r=Kr(6,r,null,i),r.lanes=l,r}function Hh(r,i,l){return i=Kr(4,r.children!==null?r.children:[],r.key,i),i.lanes=l,i.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},i}function hE(r,i,l,h,p){this.tag=i,this.containerInfo=r,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=os(0),this.expirationTimes=os(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=os(0),this.identifierPrefix=h,this.onRecoverableError=p,this.mutableSourceEagerHydrationData=null}function Kh(r,i,l,h,p,y,E,j,U){return r=new hE(r,i,l,j,U),i===1?(i=1,y===!0&&(i|=8)):i=0,y=Kr(3,null,null,i),r.current=y,y.stateNode=r,y.memoizedState={element:h,isDehydrated:l,cache:null,transitions:null,pendingSuspenseBoundaries:null},oh(y),r}function fE(r,i,l){var h=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ee,key:h==null?null:""+h,children:r,containerInfo:i,implementation:l}}function ay(r){if(!r)return Ii;r=r._reactInternals;e:{if(Ft(r)!==r||r.tag!==1)throw Error(t(170));var i=r;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(vr(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(t(171))}if(r.tag===1){var l=r.type;if(vr(l))return Dm(r,l,i)}return i}function oy(r,i,l,h,p,y,E,j,U){return r=Kh(l,h,!0,r,p,y,E,j,U),r.context=ay(null),l=r.current,h=hr(),p=ki(l),y=si(h,p),y.callback=i??null,Ni(l,y,p),r.current.lanes=p,ls(r,p,h),wr(r,h),r}function cu(r,i,l,h){var p=i.current,y=hr(),E=ki(p);return l=ay(l),i.context===null?i.context=l:i.pendingContext=l,i=si(y,E),i.payload={element:r},h=h===void 0?null:h,h!==null&&(i.callback=h),r=Ni(p,i,E),r!==null&&(gs(r,p,E,y),Uc(r,p,E)),E}function uu(r){if(r=r.current,!r.child)return null;switch(r.child.tag){case 5:return r.child.stateNode;default:return r.child.stateNode}}function ly(r,i){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var l=r.retryLane;r.retryLane=l!==0&&l<i?l:i}}function Qh(r,i){ly(r,i),(r=r.alternate)&&ly(r,i)}function pE(){return null}var cy=typeof reportError=="function"?reportError:function(r){console.error(r)};function Yh(r){this._internalRoot=r}du.prototype.render=Yh.prototype.render=function(r){var i=this._internalRoot;if(i===null)throw Error(t(409));cu(r,i,null,null)},du.prototype.unmount=Yh.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var i=r.containerInfo;wa(function(){cu(null,r,null,null)}),i[Zs]=null}};function du(r){this._internalRoot=r}du.prototype.unstable_scheduleHydration=function(r){if(r){var i=ue();r={blockedOn:null,target:r,priority:i};for(var l=0;l<nn.length&&i!==0&&i<nn[l].priority;l++);nn.splice(l,0,r),l===0&&zr(r)}};function Jh(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function hu(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11&&(r.nodeType!==8||r.nodeValue!==" react-mount-point-unstable "))}function uy(){}function mE(r,i,l,h,p){if(p){if(typeof h=="function"){var y=h;h=function(){var ee=uu(E);y.call(ee)}}var E=oy(i,h,r,0,null,!1,!1,"",uy);return r._reactRootContainer=E,r[Zs]=E.current,ll(r.nodeType===8?r.parentNode:r),wa(),E}for(;p=r.lastChild;)r.removeChild(p);if(typeof h=="function"){var j=h;h=function(){var ee=uu(U);j.call(ee)}}var U=Kh(r,0,!1,null,null,!1,!1,"",uy);return r._reactRootContainer=U,r[Zs]=U.current,ll(r.nodeType===8?r.parentNode:r),wa(function(){cu(i,U,l,h)}),U}function fu(r,i,l,h,p){var y=l._reactRootContainer;if(y){var E=y;if(typeof p=="function"){var j=p;p=function(){var U=uu(E);j.call(U)}}cu(i,E,r,p)}else E=mE(l,i,r,p,h);return uu(E)}T=function(r){switch(r.tag){case 3:var i=r.stateNode;if(i.current.memoizedState.isDehydrated){var l=ht(i.pendingLanes);l!==0&&(Cs(i,l|1),wr(i,dt()),(bt&6)===0&&(vo=dt()+500,Ci()))}break;case 13:wa(function(){var h=ri(r,1);if(h!==null){var p=hr();gs(h,r,1,p)}}),Qh(r,1)}},F=function(r){if(r.tag===13){var i=ri(r,134217728);if(i!==null){var l=hr();gs(i,r,134217728,l)}Qh(r,134217728)}},Q=function(r){if(r.tag===13){var i=ki(r),l=ri(r,i);if(l!==null){var h=hr();gs(l,r,i,h)}Qh(r,i)}},ue=function(){return pt},Te=function(r,i){var l=pt;try{return pt=r,i()}finally{pt=l}},Ss=function(r,i,l){switch(i){case"input":if(Nt(r,l),i=l.name,l.type==="radio"&&i!=null){for(l=r;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<l.length;i++){var h=l[i];if(h!==r&&h.form===r.form){var p=Rc(h);if(!p)throw Error(t(90));Be(h),Nt(h,p)}}}break;case"textarea":tn(r,l);break;case"select":i=l.value,i!=null&&mn(r,!!l.multiple,i,!1)}},Jn=Bh,Ws=wa;var gE={usingClientEntryPoint:!1,Events:[dl,so,Rc,Pn,Pr,Bh]},bl={findFiberByHostInstance:fa,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},yE={bundleType:bl.bundleType,version:bl.version,rendererPackageName:bl.rendererPackageName,rendererConfig:bl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ge.ReactCurrentDispatcher,findHostInstanceByFiber:function(r){return r=qs(r),r===null?null:r.stateNode},findFiberByHostInstance:bl.findFiberByHostInstance||pE,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var pu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!pu.isDisabled&&pu.supportsFiber)try{q=pu.inject(yE),oe=pu}catch{}}return Er.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=gE,Er.createPortal=function(r,i){var l=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Jh(i))throw Error(t(200));return fE(r,i,null,l)},Er.createRoot=function(r,i){if(!Jh(r))throw Error(t(299));var l=!1,h="",p=cy;return i!=null&&(i.unstable_strictMode===!0&&(l=!0),i.identifierPrefix!==void 0&&(h=i.identifierPrefix),i.onRecoverableError!==void 0&&(p=i.onRecoverableError)),i=Kh(r,1,!1,null,null,l,!1,h,p),r[Zs]=i.current,ll(r.nodeType===8?r.parentNode:r),new Yh(i)},Er.findDOMNode=function(r){if(r==null)return null;if(r.nodeType===1)return r;var i=r._reactInternals;if(i===void 0)throw typeof r.render=="function"?Error(t(188)):(r=Object.keys(r).join(","),Error(t(268,r)));return r=qs(i),r=r===null?null:r.stateNode,r},Er.flushSync=function(r){return wa(r)},Er.hydrate=function(r,i,l){if(!hu(i))throw Error(t(200));return fu(null,r,i,!0,l)},Er.hydrateRoot=function(r,i,l){if(!Jh(r))throw Error(t(405));var h=l!=null&&l.hydratedSources||null,p=!1,y="",E=cy;if(l!=null&&(l.unstable_strictMode===!0&&(p=!0),l.identifierPrefix!==void 0&&(y=l.identifierPrefix),l.onRecoverableError!==void 0&&(E=l.onRecoverableError)),i=oy(i,null,r,1,l??null,p,!1,y,E),r[Zs]=i.current,ll(r),h)for(r=0;r<h.length;r++)l=h[r],p=l._getVersion,p=p(l._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[l,p]:i.mutableSourceEagerHydrationData.push(l,p);return new du(i)},Er.render=function(r,i,l){if(!hu(i))throw Error(t(200));return fu(null,r,i,!1,l)},Er.unmountComponentAtNode=function(r){if(!hu(r))throw Error(t(40));return r._reactRootContainer?(wa(function(){fu(null,null,r,!1,function(){r._reactRootContainer=null,r[Zs]=null})}),!0):!1},Er.unstable_batchedUpdates=Bh,Er.unstable_renderSubtreeIntoContainer=function(r,i,l,h){if(!hu(l))throw Error(t(200));if(r==null||r._reactInternals===void 0)throw Error(t(38));return fu(r,i,l,!1,h)},Er.version="18.3.1-next-f1338f8080-20240426",Er}var vy;function I_(){if(vy)return ef.exports;vy=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),ef.exports=IE(),ef.exports}var _y;function CE(){if(_y)return mu;_y=1;var n=I_();return mu.createRoot=n.createRoot,mu.hydrateRoot=n.hydrateRoot,mu}var PE=CE();const NE=b_(PE);I_();/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Bl(){return Bl=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},Bl.apply(this,arguments)}var Bi;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(Bi||(Bi={}));const xy="popstate";function RE(n){n===void 0&&(n={});function e(s,a){let{pathname:c,search:d,hash:f}=s.location;return _f("",{pathname:c,search:d,hash:f},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(s,a){return typeof a=="string"?a:Vu(a)}return jE(e,t,null,n)}function on(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function ep(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function AE(){return Math.random().toString(36).substr(2,8)}function wy(n,e){return{usr:n.state,key:n.key,idx:e}}function _f(n,e,t,s){return t===void 0&&(t=null),Bl({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?Fo(e):e,{state:t,key:e&&e.key||s||AE()})}function Vu(n){let{pathname:e="/",search:t="",hash:s=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),s&&s!=="#"&&(e+=s.charAt(0)==="#"?s:"#"+s),e}function Fo(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let s=n.indexOf("?");s>=0&&(e.search=n.substr(s),n=n.substr(0,s)),n&&(e.pathname=n)}return e}function jE(n,e,t,s){s===void 0&&(s={});let{window:a=document.defaultView,v5Compat:c=!1}=s,d=a.history,f=Bi.Pop,m=null,v=x();v==null&&(v=0,d.replaceState(Bl({},d.state,{idx:v}),""));function x(){return(d.state||{idx:null}).idx}function S(){f=Bi.Pop;let V=x(),te=V==null?null:V-v;v=V,m&&m({action:f,location:z.location,delta:te})}function b(V,te){f=Bi.Push;let be=_f(z.location,V,te);v=x()+1;let we=wy(be,v),ge=z.createHref(be);try{d.pushState(we,"",ge)}catch(ie){if(ie instanceof DOMException&&ie.name==="DataCloneError")throw ie;a.location.assign(ge)}c&&m&&m({action:f,location:z.location,delta:1})}function M(V,te){f=Bi.Replace;let be=_f(z.location,V,te);v=x();let we=wy(be,v),ge=z.createHref(be);d.replaceState(we,"",ge),c&&m&&m({action:f,location:z.location,delta:0})}function Y(V){let te=a.location.origin!=="null"?a.location.origin:a.location.href,be=typeof V=="string"?V:Vu(V);return be=be.replace(/ $/,"%20"),on(te,"No window.location.(origin|href) available to create URL for href: "+be),new URL(be,te)}let z={get action(){return f},get location(){return n(a,d)},listen(V){if(m)throw new Error("A history only accepts one active listener");return a.addEventListener(xy,S),m=V,()=>{a.removeEventListener(xy,S),m=null}},createHref(V){return e(a,V)},createURL:Y,encodeLocation(V){let te=Y(V);return{pathname:te.pathname,search:te.search,hash:te.hash}},push:b,replace:M,go(V){return d.go(V)}};return z}var Ey;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(Ey||(Ey={}));function kE(n,e,t){return t===void 0&&(t="/"),DE(n,e,t)}function DE(n,e,t,s){let a=typeof e=="string"?Fo(e):e,c=tp(a.pathname||"/",t);if(c==null)return null;let d=C_(n);LE(d);let f=null;for(let m=0;f==null&&m<d.length;++m){let v=HE(c);f=WE(d[m],v)}return f}function C_(n,e,t,s){e===void 0&&(e=[]),t===void 0&&(t=[]),s===void 0&&(s="");let a=(c,d,f)=>{let m={relativePath:f===void 0?c.path||"":f,caseSensitive:c.caseSensitive===!0,childrenIndex:d,route:c};m.relativePath.startsWith("/")&&(on(m.relativePath.startsWith(s),'Absolute route path "'+m.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),m.relativePath=m.relativePath.slice(s.length));let v=Gi([s,m.relativePath]),x=t.concat(m);c.children&&c.children.length>0&&(on(c.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+v+'".')),C_(c.children,e,x,v)),!(c.path==null&&!c.index)&&e.push({path:v,score:BE(v,c.index),routesMeta:x})};return n.forEach((c,d)=>{var f;if(c.path===""||!((f=c.path)!=null&&f.includes("?")))a(c,d);else for(let m of P_(c.path))a(c,d,m)}),e}function P_(n){let e=n.split("/");if(e.length===0)return[];let[t,...s]=e,a=t.endsWith("?"),c=t.replace(/\?$/,"");if(s.length===0)return a?[c,""]:[c];let d=P_(s.join("/")),f=[];return f.push(...d.map(m=>m===""?c:[c,m].join("/"))),a&&f.push(...d),f.map(m=>n.startsWith("/")&&m===""?"/":m)}function LE(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:$E(e.routesMeta.map(s=>s.childrenIndex),t.routesMeta.map(s=>s.childrenIndex)))}const VE=/^:[\w-]+$/,ME=3,OE=2,FE=1,UE=10,zE=-2,Ty=n=>n==="*";function BE(n,e){let t=n.split("/"),s=t.length;return t.some(Ty)&&(s+=zE),e&&(s+=OE),t.filter(a=>!Ty(a)).reduce((a,c)=>a+(VE.test(c)?ME:c===""?FE:UE),s)}function $E(n,e){return n.length===e.length&&n.slice(0,-1).every((s,a)=>s===e[a])?n[n.length-1]-e[e.length-1]:0}function WE(n,e,t){let{routesMeta:s}=n,a={},c="/",d=[];for(let f=0;f<s.length;++f){let m=s[f],v=f===s.length-1,x=c==="/"?e:e.slice(c.length)||"/",S=GE({path:m.relativePath,caseSensitive:m.caseSensitive,end:v},x),b=m.route;if(!S)return null;Object.assign(a,S.params),d.push({params:a,pathname:Gi([c,S.pathname]),pathnameBase:XE(Gi([c,S.pathnameBase])),route:b}),S.pathnameBase!=="/"&&(c=Gi([c,S.pathnameBase]))}return d}function GE(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,s]=qE(n.path,n.caseSensitive,n.end),a=e.match(t);if(!a)return null;let c=a[0],d=c.replace(/(.)\/+$/,"$1"),f=a.slice(1);return{params:s.reduce((v,x,S)=>{let{paramName:b,isOptional:M}=x;if(b==="*"){let z=f[S]||"";d=c.slice(0,c.length-z.length).replace(/(.)\/+$/,"$1")}const Y=f[S];return M&&!Y?v[b]=void 0:v[b]=(Y||"").replace(/%2F/g,"/"),v},{}),pathname:c,pathnameBase:d,pattern:n}}function qE(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),ep(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let s=[],a="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,f,m)=>(s.push({paramName:f,isOptional:m!=null}),m?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(s.push({paramName:"*"}),a+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?a+="\\/*$":n!==""&&n!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),s]}function HE(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return ep(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function tp(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,s=n.charAt(t);return s&&s!=="/"?null:n.slice(t)||"/"}const KE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,QE=n=>KE.test(n);function YE(n,e){e===void 0&&(e="/");let{pathname:t,search:s="",hash:a=""}=typeof n=="string"?Fo(n):n,c;if(t)if(QE(t))c=t;else{if(t.includes("//")){let d=t;t=t.replace(/\/\/+/g,"/"),ep(!1,"Pathnames cannot have embedded double slashes - normalizing "+(d+" -> "+t))}t.startsWith("/")?c=Sy(t.substring(1),"/"):c=Sy(t,e)}else c=e;return{pathname:c,search:ZE(s),hash:eT(a)}}function Sy(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(a=>{a===".."?t.length>1&&t.pop():a!=="."&&t.push(a)}),t.length>1?t.join("/"):"/"}function rf(n,e,t,s){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function JE(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function np(n,e){let t=JE(n);return e?t.map((s,a)=>a===t.length-1?s.pathname:s.pathnameBase):t.map(s=>s.pathnameBase)}function rp(n,e,t,s){s===void 0&&(s=!1);let a;typeof n=="string"?a=Fo(n):(a=Bl({},n),on(!a.pathname||!a.pathname.includes("?"),rf("?","pathname","search",a)),on(!a.pathname||!a.pathname.includes("#"),rf("#","pathname","hash",a)),on(!a.search||!a.search.includes("#"),rf("#","search","hash",a)));let c=n===""||a.pathname==="",d=c?"/":a.pathname,f;if(d==null)f=t;else{let S=e.length-1;if(!s&&d.startsWith("..")){let b=d.split("/");for(;b[0]==="..";)b.shift(),S-=1;a.pathname=b.join("/")}f=S>=0?e[S]:"/"}let m=YE(a,f),v=d&&d!=="/"&&d.endsWith("/"),x=(c||d===".")&&t.endsWith("/");return!m.pathname.endsWith("/")&&(v||x)&&(m.pathname+="/"),m}const Gi=n=>n.join("/").replace(/\/\/+/g,"/"),XE=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),ZE=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,eT=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function tT(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const N_=["post","put","patch","delete"];new Set(N_);const nT=["get",...N_];new Set(nT);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function $l(){return $l=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},$l.apply(this,arguments)}const sp=R.createContext(null),rT=R.createContext(null),sa=R.createContext(null),nd=R.createContext(null),ia=R.createContext({outlet:null,matches:[],isDataRoute:!1}),R_=R.createContext(null);function sT(n,e){let{relative:t}=e===void 0?{}:e;Uo()||on(!1);let{basename:s,navigator:a}=R.useContext(sa),{hash:c,pathname:d,search:f}=j_(n,{relative:t}),m=d;return s!=="/"&&(m=d==="/"?s:Gi([s,d])),a.createHref({pathname:m,search:f,hash:c})}function Uo(){return R.useContext(nd)!=null}function zo(){return Uo()||on(!1),R.useContext(nd).location}function A_(n){R.useContext(sa).static||R.useLayoutEffect(n)}function tc(){let{isDataRoute:n}=R.useContext(ia);return n?yT():iT()}function iT(){Uo()||on(!1);let n=R.useContext(sp),{basename:e,future:t,navigator:s}=R.useContext(sa),{matches:a}=R.useContext(ia),{pathname:c}=zo(),d=JSON.stringify(np(a,t.v7_relativeSplatPath)),f=R.useRef(!1);return A_(()=>{f.current=!0}),R.useCallback(function(v,x){if(x===void 0&&(x={}),!f.current)return;if(typeof v=="number"){s.go(v);return}let S=rp(v,JSON.parse(d),c,x.relative==="path");n==null&&e!=="/"&&(S.pathname=S.pathname==="/"?e:Gi([e,S.pathname])),(x.replace?s.replace:s.push)(S,x.state,x)},[e,s,d,c,n])}function j_(n,e){let{relative:t}=e===void 0?{}:e,{future:s}=R.useContext(sa),{matches:a}=R.useContext(ia),{pathname:c}=zo(),d=JSON.stringify(np(a,s.v7_relativeSplatPath));return R.useMemo(()=>rp(n,JSON.parse(d),c,t==="path"),[n,d,c,t])}function aT(n,e){return oT(n,e)}function oT(n,e,t,s){Uo()||on(!1);let{navigator:a}=R.useContext(sa),{matches:c}=R.useContext(ia),d=c[c.length-1],f=d?d.params:{};d&&d.pathname;let m=d?d.pathnameBase:"/";d&&d.route;let v=zo(),x;if(e){var S;let V=typeof e=="string"?Fo(e):e;m==="/"||(S=V.pathname)!=null&&S.startsWith(m)||on(!1),x=V}else x=v;let b=x.pathname||"/",M=b;if(m!=="/"){let V=m.replace(/^\//,"").split("/");M="/"+b.replace(/^\//,"").split("/").slice(V.length).join("/")}let Y=kE(n,{pathname:M}),z=hT(Y&&Y.map(V=>Object.assign({},V,{params:Object.assign({},f,V.params),pathname:Gi([m,a.encodeLocation?a.encodeLocation(V.pathname).pathname:V.pathname]),pathnameBase:V.pathnameBase==="/"?m:Gi([m,a.encodeLocation?a.encodeLocation(V.pathnameBase).pathname:V.pathnameBase])})),c,t,s);return e&&z?R.createElement(nd.Provider,{value:{location:$l({pathname:"/",search:"",hash:"",state:null,key:"default"},x),navigationType:Bi.Pop}},z):z}function lT(){let n=gT(),e=tT(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return R.createElement(R.Fragment,null,R.createElement("h2",null,"Unexpected Application Error!"),R.createElement("h3",{style:{fontStyle:"italic"}},e),t?R.createElement("pre",{style:a},t):null,null)}const cT=R.createElement(lT,null);class uT extends R.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?R.createElement(ia.Provider,{value:this.props.routeContext},R.createElement(R_.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function dT(n){let{routeContext:e,match:t,children:s}=n,a=R.useContext(sp);return a&&a.static&&a.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=t.route.id),R.createElement(ia.Provider,{value:e},s)}function hT(n,e,t,s){var a;if(e===void 0&&(e=[]),t===void 0&&(t=null),s===void 0&&(s=null),n==null){var c;if(!t)return null;if(t.errors)n=t.matches;else if((c=s)!=null&&c.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let d=n,f=(a=t)==null?void 0:a.errors;if(f!=null){let x=d.findIndex(S=>S.route.id&&(f==null?void 0:f[S.route.id])!==void 0);x>=0||on(!1),d=d.slice(0,Math.min(d.length,x+1))}let m=!1,v=-1;if(t&&s&&s.v7_partialHydration)for(let x=0;x<d.length;x++){let S=d[x];if((S.route.HydrateFallback||S.route.hydrateFallbackElement)&&(v=x),S.route.id){let{loaderData:b,errors:M}=t,Y=S.route.loader&&b[S.route.id]===void 0&&(!M||M[S.route.id]===void 0);if(S.route.lazy||Y){m=!0,v>=0?d=d.slice(0,v+1):d=[d[0]];break}}}return d.reduceRight((x,S,b)=>{let M,Y=!1,z=null,V=null;t&&(M=f&&S.route.id?f[S.route.id]:void 0,z=S.route.errorElement||cT,m&&(v<0&&b===0?(vT("route-fallback"),Y=!0,V=null):v===b&&(Y=!0,V=S.route.hydrateFallbackElement||null)));let te=e.concat(d.slice(0,b+1)),be=()=>{let we;return M?we=z:Y?we=V:S.route.Component?we=R.createElement(S.route.Component,null):S.route.element?we=S.route.element:we=x,R.createElement(dT,{match:S,routeContext:{outlet:x,matches:te,isDataRoute:t!=null},children:we})};return t&&(S.route.ErrorBoundary||S.route.errorElement||b===0)?R.createElement(uT,{location:t.location,revalidation:t.revalidation,component:z,error:M,children:be(),routeContext:{outlet:null,matches:te,isDataRoute:!0}}):be()},null)}var k_=(function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n})(k_||{}),D_=(function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n})(D_||{});function fT(n){let e=R.useContext(sp);return e||on(!1),e}function pT(n){let e=R.useContext(rT);return e||on(!1),e}function mT(n){let e=R.useContext(ia);return e||on(!1),e}function L_(n){let e=mT(),t=e.matches[e.matches.length-1];return t.route.id||on(!1),t.route.id}function gT(){var n;let e=R.useContext(R_),t=pT(),s=L_();return e!==void 0?e:(n=t.errors)==null?void 0:n[s]}function yT(){let{router:n}=fT(k_.UseNavigateStable),e=L_(D_.UseNavigateStable),t=R.useRef(!1);return A_(()=>{t.current=!0}),R.useCallback(function(a,c){c===void 0&&(c={}),t.current&&(typeof a=="number"?n.navigate(a):n.navigate(a,$l({fromRouteId:e},c)))},[n,e])}const by={};function vT(n,e,t){by[n]||(by[n]=!0)}function _T(n,e){n==null||n.v7_startTransition,n==null||n.v7_relativeSplatPath}function xf(n){let{to:e,replace:t,state:s,relative:a}=n;Uo()||on(!1);let{future:c,static:d}=R.useContext(sa),{matches:f}=R.useContext(ia),{pathname:m}=zo(),v=tc(),x=rp(e,np(f,c.v7_relativeSplatPath),m,a==="path"),S=JSON.stringify(x);return R.useEffect(()=>v(JSON.parse(S),{replace:t,state:s,relative:a}),[v,S,a,t,s]),null}function Qr(n){on(!1)}function xT(n){let{basename:e="/",children:t=null,location:s,navigationType:a=Bi.Pop,navigator:c,static:d=!1,future:f}=n;Uo()&&on(!1);let m=e.replace(/^\/*/,"/"),v=R.useMemo(()=>({basename:m,navigator:c,static:d,future:$l({v7_relativeSplatPath:!1},f)}),[m,f,c,d]);typeof s=="string"&&(s=Fo(s));let{pathname:x="/",search:S="",hash:b="",state:M=null,key:Y="default"}=s,z=R.useMemo(()=>{let V=tp(x,m);return V==null?null:{location:{pathname:V,search:S,hash:b,state:M,key:Y},navigationType:a}},[m,x,S,b,M,Y,a]);return z==null?null:R.createElement(sa.Provider,{value:v},R.createElement(nd.Provider,{children:t,value:z}))}function wT(n){let{children:e,location:t}=n;return aT(wf(e),t)}new Promise(()=>{});function wf(n,e){e===void 0&&(e=[]);let t=[];return R.Children.forEach(n,(s,a)=>{if(!R.isValidElement(s))return;let c=[...e,a];if(s.type===R.Fragment){t.push.apply(t,wf(s.props.children,c));return}s.type!==Qr&&on(!1),!s.props.index||!s.props.children||on(!1);let d={id:s.props.id||c.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(d.children=wf(s.props.children,c)),t.push(d)}),t}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ef(){return Ef=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},Ef.apply(this,arguments)}function ET(n,e){if(n==null)return{};var t={},s=Object.keys(n),a,c;for(c=0;c<s.length;c++)a=s[c],!(e.indexOf(a)>=0)&&(t[a]=n[a]);return t}function TT(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function ST(n,e){return n.button===0&&(!e||e==="_self")&&!TT(n)}function Tf(n){return n===void 0&&(n=""),new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((e,t)=>{let s=n[t];return e.concat(Array.isArray(s)?s.map(a=>[t,a]):[[t,s]])},[]))}function bT(n,e){let t=Tf(n);return e&&e.forEach((s,a)=>{t.has(a)||e.getAll(a).forEach(c=>{t.append(a,c)})}),t}const IT=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],CT="6";try{window.__reactRouterVersion=CT}catch{}const PT="startTransition",Iy=TE[PT];function NT(n){let{basename:e,children:t,future:s,window:a}=n,c=R.useRef();c.current==null&&(c.current=RE({window:a,v5Compat:!0}));let d=c.current,[f,m]=R.useState({action:d.action,location:d.location}),{v7_startTransition:v}=s||{},x=R.useCallback(S=>{v&&Iy?Iy(()=>m(S)):m(S)},[m,v]);return R.useLayoutEffect(()=>d.listen(x),[d,x]),R.useEffect(()=>_T(s),[s]),R.createElement(xT,{basename:e,children:t,location:f.location,navigationType:f.action,navigator:d,future:s})}const RT=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",AT=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Mi=R.forwardRef(function(e,t){let{onClick:s,relative:a,reloadDocument:c,replace:d,state:f,target:m,to:v,preventScrollReset:x,viewTransition:S}=e,b=ET(e,IT),{basename:M}=R.useContext(sa),Y,z=!1;if(typeof v=="string"&&AT.test(v)&&(Y=v,RT))try{let we=new URL(window.location.href),ge=v.startsWith("//")?new URL(we.protocol+v):new URL(v),ie=tp(ge.pathname,M);ge.origin===we.origin&&ie!=null?v=ie+ge.search+ge.hash:z=!0}catch{}let V=sT(v,{relative:a}),te=jT(v,{replace:d,state:f,target:m,preventScrollReset:x,relative:a,viewTransition:S});function be(we){s&&s(we),we.defaultPrevented||te(we)}return R.createElement("a",Ef({},b,{href:Y||V,onClick:z||c?s:be,ref:t,target:m}))});var Cy;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(Cy||(Cy={}));var Py;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(Py||(Py={}));function jT(n,e){let{target:t,replace:s,state:a,preventScrollReset:c,relative:d,viewTransition:f}=e===void 0?{}:e,m=tc(),v=zo(),x=j_(n,{relative:d});return R.useCallback(S=>{if(ST(S,t)){S.preventDefault();let b=s!==void 0?s:Vu(v)===Vu(x);m(n,{replace:b,state:a,preventScrollReset:c,relative:d,viewTransition:f})}},[v,m,x,s,a,t,n,c,d,f])}function kT(n){let e=R.useRef(Tf(n)),t=R.useRef(!1),s=zo(),a=R.useMemo(()=>bT(s.search,t.current?null:e.current),[s.search]),c=tc(),d=R.useCallback((f,m)=>{const v=Tf(typeof f=="function"?f(a):f);t.current=!0,c("?"+v,m)},[c,a]);return[a,d]}const DT=()=>{};var Ny={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V_=function(n){const e=[];let t=0;for(let s=0;s<n.length;s++){let a=n.charCodeAt(s);a<128?e[t++]=a:a<2048?(e[t++]=a>>6|192,e[t++]=a&63|128):(a&64512)===55296&&s+1<n.length&&(n.charCodeAt(s+1)&64512)===56320?(a=65536+((a&1023)<<10)+(n.charCodeAt(++s)&1023),e[t++]=a>>18|240,e[t++]=a>>12&63|128,e[t++]=a>>6&63|128,e[t++]=a&63|128):(e[t++]=a>>12|224,e[t++]=a>>6&63|128,e[t++]=a&63|128)}return e},LT=function(n){const e=[];let t=0,s=0;for(;t<n.length;){const a=n[t++];if(a<128)e[s++]=String.fromCharCode(a);else if(a>191&&a<224){const c=n[t++];e[s++]=String.fromCharCode((a&31)<<6|c&63)}else if(a>239&&a<365){const c=n[t++],d=n[t++],f=n[t++],m=((a&7)<<18|(c&63)<<12|(d&63)<<6|f&63)-65536;e[s++]=String.fromCharCode(55296+(m>>10)),e[s++]=String.fromCharCode(56320+(m&1023))}else{const c=n[t++],d=n[t++];e[s++]=String.fromCharCode((a&15)<<12|(c&63)<<6|d&63)}}return e.join("")},M_={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let a=0;a<n.length;a+=3){const c=n[a],d=a+1<n.length,f=d?n[a+1]:0,m=a+2<n.length,v=m?n[a+2]:0,x=c>>2,S=(c&3)<<4|f>>4;let b=(f&15)<<2|v>>6,M=v&63;m||(M=64,d||(b=64)),s.push(t[x],t[S],t[b],t[M])}return s.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(V_(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):LT(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let a=0;a<n.length;){const c=t[n.charAt(a++)],f=a<n.length?t[n.charAt(a)]:0;++a;const v=a<n.length?t[n.charAt(a)]:64;++a;const S=a<n.length?t[n.charAt(a)]:64;if(++a,c==null||f==null||v==null||S==null)throw new VT;const b=c<<2|f>>4;if(s.push(b),v!==64){const M=f<<4&240|v>>2;if(s.push(M),S!==64){const Y=v<<6&192|S;s.push(Y)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class VT extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const MT=function(n){const e=V_(n);return M_.encodeByteArray(e,!0)},Mu=function(n){return MT(n).replace(/\./g,"")},O_=function(n){try{return M_.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OT(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FT=()=>OT().__FIREBASE_DEFAULTS__,UT=()=>{if(typeof process>"u"||typeof Ny>"u")return;const n=Ny.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},zT=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&O_(n[1]);return e&&JSON.parse(e)},rd=()=>{try{return DT()||FT()||UT()||zT()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},F_=n=>{var e,t;return(t=(e=rd())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},BT=n=>{const e=F_(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),s]:[e.substring(0,t),s]},U_=()=>{var n;return(n=rd())===null||n===void 0?void 0:n.config},z_=n=>{var e;return(e=rd())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $T{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,s)=>{t?this.reject(t):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,s))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bo(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function B_(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WT(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},s=e||"demo-project",a=n.iat||0,c=n.sub||n.user_id;if(!c)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d=Object.assign({iss:`https://securetoken.google.com/${s}`,aud:s,iat:a,exp:a+3600,auth_time:a,sub:c,user_id:c,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Mu(JSON.stringify(t)),Mu(JSON.stringify(d)),""].join(".")}const Ll={};function GT(){const n={prod:[],emulator:[]};for(const e of Object.keys(Ll))Ll[e]?n.emulator.push(e):n.prod.push(e);return n}function qT(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let Ry=!1;function $_(n,e){if(typeof window>"u"||typeof document>"u"||!Bo(window.location.host)||Ll[n]===e||Ll[n]||Ry)return;Ll[n]=e;function t(b){return`__firebase__banner__${b}`}const s="__firebase__banner",c=GT().prod.length>0;function d(){const b=document.getElementById(s);b&&b.remove()}function f(b){b.style.display="flex",b.style.background="#7faaf0",b.style.position="fixed",b.style.bottom="5px",b.style.left="5px",b.style.padding=".5em",b.style.borderRadius="5px",b.style.alignItems="center"}function m(b,M){b.setAttribute("width","24"),b.setAttribute("id",M),b.setAttribute("height","24"),b.setAttribute("viewBox","0 0 24 24"),b.setAttribute("fill","none"),b.style.marginLeft="-6px"}function v(){const b=document.createElement("span");return b.style.cursor="pointer",b.style.marginLeft="16px",b.style.fontSize="24px",b.innerHTML=" &times;",b.onclick=()=>{Ry=!0,d()},b}function x(b,M){b.setAttribute("id",M),b.innerText="Learn more",b.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",b.setAttribute("target","__blank"),b.style.paddingLeft="5px",b.style.textDecoration="underline"}function S(){const b=qT(s),M=t("text"),Y=document.getElementById(M)||document.createElement("span"),z=t("learnmore"),V=document.getElementById(z)||document.createElement("a"),te=t("preprendIcon"),be=document.getElementById(te)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(b.created){const we=b.element;f(we),x(V,z);const ge=v();m(be,te),we.append(be,Y,V,ge),document.body.appendChild(we)}c?(Y.innerText="Preview backend disconnected.",be.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(be.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,Y.innerText="Preview backend running in this workspace."),Y.setAttribute("id",M)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",S):S()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function or(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function HT(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(or())}function KT(){var n;const e=(n=rd())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function QT(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function YT(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function JT(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function XT(){const n=or();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function ZT(){return!KT()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function eS(){try{return typeof indexedDB=="object"}catch{return!1}}function tS(){return new Promise((n,e)=>{try{let t=!0;const s="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(s);a.onsuccess=()=>{a.result.close(),t||self.indexedDB.deleteDatabase(s),n(!0)},a.onupgradeneeded=()=>{t=!1},a.onerror=()=>{var c;e(((c=a.error)===null||c===void 0?void 0:c.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nS="FirebaseError";class _i extends Error{constructor(e,t,s){super(t),this.code=e,this.customData=s,this.name=nS,Object.setPrototypeOf(this,_i.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,nc.prototype.create)}}class nc{constructor(e,t,s){this.service=e,this.serviceName=t,this.errors=s}create(e,...t){const s=t[0]||{},a=`${this.service}/${e}`,c=this.errors[e],d=c?rS(c,s):"Error",f=`${this.serviceName}: ${d} (${a}).`;return new _i(a,f,s)}}function rS(n,e){return n.replace(sS,(t,s)=>{const a=e[s];return a!=null?String(a):`<${s}?>`})}const sS=/\{\$([^}]+)}/g;function iS(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Da(n,e){if(n===e)return!0;const t=Object.keys(n),s=Object.keys(e);for(const a of t){if(!s.includes(a))return!1;const c=n[a],d=e[a];if(Ay(c)&&Ay(d)){if(!Da(c,d))return!1}else if(c!==d)return!1}for(const a of s)if(!t.includes(a))return!1;return!0}function Ay(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rc(n){const e=[];for(const[t,s]of Object.entries(n))Array.isArray(s)?s.forEach(a=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function Nl(n){const e={};return n.replace(/^\?/,"").split("&").forEach(s=>{if(s){const[a,c]=s.split("=");e[decodeURIComponent(a)]=decodeURIComponent(c)}}),e}function Rl(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function aS(n,e){const t=new oS(n,e);return t.subscribe.bind(t)}class oS{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,s){let a;if(e===void 0&&t===void 0&&s===void 0)throw new Error("Missing Observer.");lS(e,["next","error","complete"])?a=e:a={next:e,error:t,complete:s},a.next===void 0&&(a.next=sf),a.error===void 0&&(a.error=sf),a.complete===void 0&&(a.complete=sf);const c=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),c}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function lS(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function sf(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zt(n){return n&&n._delegate?n._delegate:n}class La{constructor(e,t,s){this.name=e,this.instanceFactory=t,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ba="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cS{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const s=new $T;if(this.instancesDeferred.set(t,s),this.isInitialized(t)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:t});a&&s.resolve(a)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const s=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),a=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(s)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:s})}catch(c){if(a)return null;throw c}else{if(a)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(dS(e))try{this.getOrInitializeService({instanceIdentifier:ba})}catch{}for(const[t,s]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(t);try{const c=this.getOrInitializeService({instanceIdentifier:a});s.resolve(c)}catch{}}}}clearInstance(e=ba){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ba){return this.instances.has(e)}getOptions(e=ba){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:s,options:t});for(const[c,d]of this.instancesDeferred.entries()){const f=this.normalizeInstanceIdentifier(c);s===f&&d.resolve(a)}return a}onInit(e,t){var s;const a=this.normalizeInstanceIdentifier(t),c=(s=this.onInitCallbacks.get(a))!==null&&s!==void 0?s:new Set;c.add(e),this.onInitCallbacks.set(a,c);const d=this.instances.get(a);return d&&e(d,a),()=>{c.delete(e)}}invokeOnInitCallbacks(e,t){const s=this.onInitCallbacks.get(t);if(s)for(const a of s)try{a(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:uS(e),options:t}),this.instances.set(e,s),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=ba){return this.component?this.component.multipleInstances?e:ba:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function uS(n){return n===ba?void 0:n}function dS(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hS{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new cS(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var yt;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(yt||(yt={}));const fS={debug:yt.DEBUG,verbose:yt.VERBOSE,info:yt.INFO,warn:yt.WARN,error:yt.ERROR,silent:yt.SILENT},pS=yt.INFO,mS={[yt.DEBUG]:"log",[yt.VERBOSE]:"log",[yt.INFO]:"info",[yt.WARN]:"warn",[yt.ERROR]:"error"},gS=(n,e,...t)=>{if(e<n.logLevel)return;const s=new Date().toISOString(),a=mS[e];if(a)console[a](`[${s}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class ip{constructor(e){this.name=e,this._logLevel=pS,this._logHandler=gS,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in yt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?fS[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,yt.DEBUG,...e),this._logHandler(this,yt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,yt.VERBOSE,...e),this._logHandler(this,yt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,yt.INFO,...e),this._logHandler(this,yt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,yt.WARN,...e),this._logHandler(this,yt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,yt.ERROR,...e),this._logHandler(this,yt.ERROR,...e)}}const yS=(n,e)=>e.some(t=>n instanceof t);let jy,ky;function vS(){return jy||(jy=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function _S(){return ky||(ky=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const W_=new WeakMap,Sf=new WeakMap,G_=new WeakMap,af=new WeakMap,ap=new WeakMap;function xS(n){const e=new Promise((t,s)=>{const a=()=>{n.removeEventListener("success",c),n.removeEventListener("error",d)},c=()=>{t(qi(n.result)),a()},d=()=>{s(n.error),a()};n.addEventListener("success",c),n.addEventListener("error",d)});return e.then(t=>{t instanceof IDBCursor&&W_.set(t,n)}).catch(()=>{}),ap.set(e,n),e}function wS(n){if(Sf.has(n))return;const e=new Promise((t,s)=>{const a=()=>{n.removeEventListener("complete",c),n.removeEventListener("error",d),n.removeEventListener("abort",d)},c=()=>{t(),a()},d=()=>{s(n.error||new DOMException("AbortError","AbortError")),a()};n.addEventListener("complete",c),n.addEventListener("error",d),n.addEventListener("abort",d)});Sf.set(n,e)}let bf={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Sf.get(n);if(e==="objectStoreNames")return n.objectStoreNames||G_.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return qi(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function ES(n){bf=n(bf)}function TS(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const s=n.call(of(this),e,...t);return G_.set(s,e.sort?e.sort():[e]),qi(s)}:_S().includes(n)?function(...e){return n.apply(of(this),e),qi(W_.get(this))}:function(...e){return qi(n.apply(of(this),e))}}function SS(n){return typeof n=="function"?TS(n):(n instanceof IDBTransaction&&wS(n),yS(n,vS())?new Proxy(n,bf):n)}function qi(n){if(n instanceof IDBRequest)return xS(n);if(af.has(n))return af.get(n);const e=SS(n);return e!==n&&(af.set(n,e),ap.set(e,n)),e}const of=n=>ap.get(n);function bS(n,e,{blocked:t,upgrade:s,blocking:a,terminated:c}={}){const d=indexedDB.open(n,e),f=qi(d);return s&&d.addEventListener("upgradeneeded",m=>{s(qi(d.result),m.oldVersion,m.newVersion,qi(d.transaction),m)}),t&&d.addEventListener("blocked",m=>t(m.oldVersion,m.newVersion,m)),f.then(m=>{c&&m.addEventListener("close",()=>c()),a&&m.addEventListener("versionchange",v=>a(v.oldVersion,v.newVersion,v))}).catch(()=>{}),f}const IS=["get","getKey","getAll","getAllKeys","count"],CS=["put","add","delete","clear"],lf=new Map;function Dy(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(lf.get(e))return lf.get(e);const t=e.replace(/FromIndex$/,""),s=e!==t,a=CS.includes(t);if(!(t in(s?IDBIndex:IDBObjectStore).prototype)||!(a||IS.includes(t)))return;const c=async function(d,...f){const m=this.transaction(d,a?"readwrite":"readonly");let v=m.store;return s&&(v=v.index(f.shift())),(await Promise.all([v[t](...f),a&&m.done]))[0]};return lf.set(e,c),c}ES(n=>({...n,get:(e,t,s)=>Dy(e,t)||n.get(e,t,s),has:(e,t)=>!!Dy(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PS{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(NS(t)){const s=t.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(t=>t).join(" ")}}function NS(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const If="@firebase/app",Ly="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hi=new ip("@firebase/app"),RS="@firebase/app-compat",AS="@firebase/analytics-compat",jS="@firebase/analytics",kS="@firebase/app-check-compat",DS="@firebase/app-check",LS="@firebase/auth",VS="@firebase/auth-compat",MS="@firebase/database",OS="@firebase/data-connect",FS="@firebase/database-compat",US="@firebase/functions",zS="@firebase/functions-compat",BS="@firebase/installations",$S="@firebase/installations-compat",WS="@firebase/messaging",GS="@firebase/messaging-compat",qS="@firebase/performance",HS="@firebase/performance-compat",KS="@firebase/remote-config",QS="@firebase/remote-config-compat",YS="@firebase/storage",JS="@firebase/storage-compat",XS="@firebase/firestore",ZS="@firebase/ai",e1="@firebase/firestore-compat",t1="firebase",n1="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cf="[DEFAULT]",r1={[If]:"fire-core",[RS]:"fire-core-compat",[jS]:"fire-analytics",[AS]:"fire-analytics-compat",[DS]:"fire-app-check",[kS]:"fire-app-check-compat",[LS]:"fire-auth",[VS]:"fire-auth-compat",[MS]:"fire-rtdb",[OS]:"fire-data-connect",[FS]:"fire-rtdb-compat",[US]:"fire-fn",[zS]:"fire-fn-compat",[BS]:"fire-iid",[$S]:"fire-iid-compat",[WS]:"fire-fcm",[GS]:"fire-fcm-compat",[qS]:"fire-perf",[HS]:"fire-perf-compat",[KS]:"fire-rc",[QS]:"fire-rc-compat",[YS]:"fire-gcs",[JS]:"fire-gcs-compat",[XS]:"fire-fst",[e1]:"fire-fst-compat",[ZS]:"fire-vertex","fire-js":"fire-js",[t1]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ou=new Map,s1=new Map,Pf=new Map;function Vy(n,e){try{n.container.addComponent(e)}catch(t){hi.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function jo(n){const e=n.name;if(Pf.has(e))return hi.debug(`There were multiple attempts to register component ${e}.`),!1;Pf.set(e,n);for(const t of Ou.values())Vy(t,n);for(const t of s1.values())Vy(t,n);return!0}function op(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Mr(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i1={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Hi=new nc("app","Firebase",i1);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a1{constructor(e,t,s){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new La("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Hi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $o=n1;function q_(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const s=Object.assign({name:Cf,automaticDataCollectionEnabled:!0},e),a=s.name;if(typeof a!="string"||!a)throw Hi.create("bad-app-name",{appName:String(a)});if(t||(t=U_()),!t)throw Hi.create("no-options");const c=Ou.get(a);if(c){if(Da(t,c.options)&&Da(s,c.config))return c;throw Hi.create("duplicate-app",{appName:a})}const d=new hS(a);for(const m of Pf.values())d.addComponent(m);const f=new a1(t,s,d);return Ou.set(a,f),f}function H_(n=Cf){const e=Ou.get(n);if(!e&&n===Cf&&U_())return q_();if(!e)throw Hi.create("no-app",{appName:n});return e}function Ki(n,e,t){var s;let a=(s=r1[n])!==null&&s!==void 0?s:n;t&&(a+=`-${t}`);const c=a.match(/\s|\//),d=e.match(/\s|\//);if(c||d){const f=[`Unable to register library "${a}" with version "${e}":`];c&&f.push(`library name "${a}" contains illegal characters (whitespace or "/")`),c&&d&&f.push("and"),d&&f.push(`version name "${e}" contains illegal characters (whitespace or "/")`),hi.warn(f.join(" "));return}jo(new La(`${a}-version`,()=>({library:a,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o1="firebase-heartbeat-database",l1=1,Wl="firebase-heartbeat-store";let cf=null;function K_(){return cf||(cf=bS(o1,l1,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Wl)}catch(t){console.warn(t)}}}}).catch(n=>{throw Hi.create("idb-open",{originalErrorMessage:n.message})})),cf}async function c1(n){try{const t=(await K_()).transaction(Wl),s=await t.objectStore(Wl).get(Q_(n));return await t.done,s}catch(e){if(e instanceof _i)hi.warn(e.message);else{const t=Hi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});hi.warn(t.message)}}}async function My(n,e){try{const s=(await K_()).transaction(Wl,"readwrite");await s.objectStore(Wl).put(e,Q_(n)),await s.done}catch(t){if(t instanceof _i)hi.warn(t.message);else{const s=Hi.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});hi.warn(s.message)}}}function Q_(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u1=1024,d1=30;class h1{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new p1(t),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){var e,t;try{const a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),c=Oy();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===c||this._heartbeatsCache.heartbeats.some(d=>d.date===c))return;if(this._heartbeatsCache.heartbeats.push({date:c,agent:a}),this._heartbeatsCache.heartbeats.length>d1){const d=m1(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(d,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(s){hi.warn(s)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Oy(),{heartbeatsToSend:s,unsentEntries:a}=f1(this._heartbeatsCache.heartbeats),c=Mu(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=t,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),c}catch(t){return hi.warn(t),""}}}function Oy(){return new Date().toISOString().substring(0,10)}function f1(n,e=u1){const t=[];let s=n.slice();for(const a of n){const c=t.find(d=>d.agent===a.agent);if(c){if(c.dates.push(a.date),Fy(t)>e){c.dates.pop();break}}else if(t.push({agent:a.agent,dates:[a.date]}),Fy(t)>e){t.pop();break}s=s.slice(1)}return{heartbeatsToSend:t,unsentEntries:s}}class p1{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return eS()?tS().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await c1(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const a=await this.read();return My(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:a.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const a=await this.read();return My(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:a.lastSentHeartbeatDate,heartbeats:[...a.heartbeats,...e.heartbeats]})}else return}}function Fy(n){return Mu(JSON.stringify({version:2,heartbeats:n})).length}function m1(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let s=1;s<n.length;s++)n[s].date<t&&(t=n[s].date,e=s);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g1(n){jo(new La("platform-logger",e=>new PS(e),"PRIVATE")),jo(new La("heartbeat",e=>new h1(e),"PRIVATE")),Ki(If,Ly,n),Ki(If,Ly,"esm2017"),Ki("fire-js","")}g1("");var y1="firebase",v1="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ki(y1,v1,"app");function lp(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(n);a<s.length;a++)e.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(n,s[a])&&(t[s[a]]=n[s[a]]);return t}function Y_(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const _1=Y_,J_=new nc("auth","Firebase",Y_());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fu=new ip("@firebase/auth");function x1(n,...e){Fu.logLevel<=yt.WARN&&Fu.warn(`Auth (${$o}): ${n}`,...e)}function Su(n,...e){Fu.logLevel<=yt.ERROR&&Fu.error(`Auth (${$o}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zr(n,...e){throw up(n,...e)}function ws(n,...e){return up(n,...e)}function cp(n,e,t){const s=Object.assign(Object.assign({},_1()),{[e]:t});return new nc("auth","Firebase",s).create(e,{appName:n.name})}function ui(n){return cp(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function X_(n,e,t){const s=t;if(!(e instanceof s))throw s.name!==e.constructor.name&&Zr(n,"argument-error"),cp(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function up(n,...e){if(typeof n!="string"){const t=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=n.name),n._errorFactory.create(t,...s)}return J_.create(n,...e)}function nt(n,e,...t){if(!n)throw up(e,...t)}function oi(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Su(e),new Error(e)}function fi(n,e){n||oi(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nf(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function w1(){return Uy()==="http:"||Uy()==="https:"}function Uy(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E1(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(w1()||YT()||"connection"in navigator)?navigator.onLine:!0}function T1(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sc{constructor(e,t){this.shortDelay=e,this.longDelay=t,fi(t>e,"Short delay should be less than long delay!"),this.isMobile=HT()||JT()}get(){return E1()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dp(n,e){fi(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z_{static initialize(e,t,s){this.fetchImpl=e,t&&(this.headersImpl=t),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;oi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;oi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;oi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S1={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b1=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],I1=new sc(3e4,6e4);function aa(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function $s(n,e,t,s,a={}){return e0(n,a,async()=>{let c={},d={};s&&(e==="GET"?d=s:c={body:JSON.stringify(s)});const f=rc(Object.assign({key:n.config.apiKey},d)).slice(1),m=await n._getAdditionalHeaders();m["Content-Type"]="application/json",n.languageCode&&(m["X-Firebase-Locale"]=n.languageCode);const v=Object.assign({method:e,headers:m},c);return QT()||(v.referrerPolicy="no-referrer"),n.emulatorConfig&&Bo(n.emulatorConfig.host)&&(v.credentials="include"),Z_.fetch()(await t0(n,n.config.apiHost,t,f),v)})}async function e0(n,e,t){n._canInitEmulator=!1;const s=Object.assign(Object.assign({},S1),e);try{const a=new P1(n),c=await Promise.race([t(),a.promise]);a.clearNetworkTimeout();const d=await c.json();if("needConfirmation"in d)throw gu(n,"account-exists-with-different-credential",d);if(c.ok&&!("errorMessage"in d))return d;{const f=c.ok?d.errorMessage:d.error.message,[m,v]=f.split(" : ");if(m==="FEDERATED_USER_ID_ALREADY_LINKED")throw gu(n,"credential-already-in-use",d);if(m==="EMAIL_EXISTS")throw gu(n,"email-already-in-use",d);if(m==="USER_DISABLED")throw gu(n,"user-disabled",d);const x=s[m]||m.toLowerCase().replace(/[_\s]+/g,"-");if(v)throw cp(n,x,v);Zr(n,x)}}catch(a){if(a instanceof _i)throw a;Zr(n,"network-request-failed",{message:String(a)})}}async function ic(n,e,t,s,a={}){const c=await $s(n,e,t,s,a);return"mfaPendingCredential"in c&&Zr(n,"multi-factor-auth-required",{_serverResponse:c}),c}async function t0(n,e,t,s){const a=`${e}${t}?${s}`,c=n,d=c.config.emulator?dp(n.config,a):`${n.config.apiScheme}://${a}`;return b1.includes(t)&&(await c._persistenceManagerAvailable,c._getPersistenceType()==="COOKIE")?c._getPersistence()._getFinalTarget(d).toString():d}function C1(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class P1{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,s)=>{this.timer=setTimeout(()=>s(ws(this.auth,"network-request-failed")),I1.get())})}}function gu(n,e,t){const s={appName:n.name};t.email&&(s.email=t.email),t.phoneNumber&&(s.phoneNumber=t.phoneNumber);const a=ws(n,e,s);return a.customData._tokenResponse=t,a}function zy(n){return n!==void 0&&n.enterprise!==void 0}class N1{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return C1(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function R1(n,e){return $s(n,"GET","/v2/recaptchaConfig",aa(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function A1(n,e){return $s(n,"POST","/v1/accounts:delete",e)}async function j1(n,e){return $s(n,"POST","/v1/accounts:update",e)}async function Uu(n,e){return $s(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vl(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function k1(n,e=!1){const t=Zt(n),s=await t.getIdToken(e),a=hp(s);nt(a&&a.exp&&a.auth_time&&a.iat,t.auth,"internal-error");const c=typeof a.firebase=="object"?a.firebase:void 0,d=c==null?void 0:c.sign_in_provider;return{claims:a,token:s,authTime:Vl(uf(a.auth_time)),issuedAtTime:Vl(uf(a.iat)),expirationTime:Vl(uf(a.exp)),signInProvider:d||null,signInSecondFactor:(c==null?void 0:c.sign_in_second_factor)||null}}function uf(n){return Number(n)*1e3}function hp(n){const[e,t,s]=n.split(".");if(e===void 0||t===void 0||s===void 0)return Su("JWT malformed, contained fewer than 3 sections"),null;try{const a=O_(t);return a?JSON.parse(a):(Su("Failed to decode base64 JWT payload"),null)}catch(a){return Su("Caught error parsing JWT payload as JSON",a==null?void 0:a.toString()),null}}function By(n){const e=hp(n);return nt(e,"internal-error"),nt(typeof e.exp<"u","internal-error"),nt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ko(n,e,t=!1){if(t)return e;try{return await e}catch(s){throw s instanceof _i&&D1(s)&&n.auth.currentUser===n&&await n.auth.signOut(),s}}function D1({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L1{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const s=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),s}else{this.errorBackoff=3e4;const a=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,a)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rf{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Vl(this.lastLoginAt),this.creationTime=Vl(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gl(n){var e;const t=n.auth,s=await n.getIdToken(),a=await ko(n,Uu(t,{idToken:s}));nt(a==null?void 0:a.users.length,t,"internal-error");const c=a.users[0];n._notifyReloadListener(c);const d=!((e=c.providerUserInfo)===null||e===void 0)&&e.length?n0(c.providerUserInfo):[],f=M1(n.providerData,d),m=n.isAnonymous,v=!(n.email&&c.passwordHash)&&!(f!=null&&f.length),x=m?v:!1,S={uid:c.localId,displayName:c.displayName||null,photoURL:c.photoUrl||null,email:c.email||null,emailVerified:c.emailVerified||!1,phoneNumber:c.phoneNumber||null,tenantId:c.tenantId||null,providerData:f,metadata:new Rf(c.createdAt,c.lastLoginAt),isAnonymous:x};Object.assign(n,S)}async function V1(n){const e=Zt(n);await Gl(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function M1(n,e){return[...n.filter(s=>!e.some(a=>a.providerId===s.providerId)),...e]}function n0(n){return n.map(e=>{var{providerId:t}=e,s=lp(e,["providerId"]);return{providerId:t,uid:s.rawId||"",displayName:s.displayName||null,email:s.email||null,phoneNumber:s.phoneNumber||null,photoURL:s.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function O1(n,e){const t=await e0(n,{},async()=>{const s=rc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:c}=n.config,d=await t0(n,a,"/v1/token",`key=${c}`),f=await n._getAdditionalHeaders();f["Content-Type"]="application/x-www-form-urlencoded";const m={method:"POST",headers:f,body:s};return n.emulatorConfig&&Bo(n.emulatorConfig.host)&&(m.credentials="include"),Z_.fetch()(d,m)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function F1(n,e){return $s(n,"POST","/v2/accounts:revokeToken",aa(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Co{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){nt(e.idToken,"internal-error"),nt(typeof e.idToken<"u","internal-error"),nt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):By(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){nt(e.length!==0,"internal-error");const t=By(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(nt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:s,refreshToken:a,expiresIn:c}=await O1(e,t);this.updateTokensAndExpiration(s,a,Number(c))}updateTokensAndExpiration(e,t,s){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,t){const{refreshToken:s,accessToken:a,expirationTime:c}=t,d=new Co;return s&&(nt(typeof s=="string","internal-error",{appName:e}),d.refreshToken=s),a&&(nt(typeof a=="string","internal-error",{appName:e}),d.accessToken=a),c&&(nt(typeof c=="number","internal-error",{appName:e}),d.expirationTime=c),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Co,this.toJSON())}_performRefresh(){return oi("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oi(n,e){nt(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class xs{constructor(e){var{uid:t,auth:s,stsTokenManager:a}=e,c=lp(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new L1(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=s,this.stsTokenManager=a,this.accessToken=a.accessToken,this.displayName=c.displayName||null,this.email=c.email||null,this.emailVerified=c.emailVerified||!1,this.phoneNumber=c.phoneNumber||null,this.photoURL=c.photoURL||null,this.isAnonymous=c.isAnonymous||!1,this.tenantId=c.tenantId||null,this.providerData=c.providerData?[...c.providerData]:[],this.metadata=new Rf(c.createdAt||void 0,c.lastLoginAt||void 0)}async getIdToken(e){const t=await ko(this,this.stsTokenManager.getToken(this.auth,e));return nt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return k1(this,e)}reload(){return V1(this)}_assign(e){this!==e&&(nt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new xs(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){nt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),t&&await Gl(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Mr(this.auth.app))return Promise.reject(ui(this.auth));const e=await this.getIdToken();return await ko(this,A1(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var s,a,c,d,f,m,v,x;const S=(s=t.displayName)!==null&&s!==void 0?s:void 0,b=(a=t.email)!==null&&a!==void 0?a:void 0,M=(c=t.phoneNumber)!==null&&c!==void 0?c:void 0,Y=(d=t.photoURL)!==null&&d!==void 0?d:void 0,z=(f=t.tenantId)!==null&&f!==void 0?f:void 0,V=(m=t._redirectEventId)!==null&&m!==void 0?m:void 0,te=(v=t.createdAt)!==null&&v!==void 0?v:void 0,be=(x=t.lastLoginAt)!==null&&x!==void 0?x:void 0,{uid:we,emailVerified:ge,isAnonymous:ie,providerData:Ee,stsTokenManager:D}=t;nt(we&&D,e,"internal-error");const N=Co.fromJSON(this.name,D);nt(typeof we=="string",e,"internal-error"),Oi(S,e.name),Oi(b,e.name),nt(typeof ge=="boolean",e,"internal-error"),nt(typeof ie=="boolean",e,"internal-error"),Oi(M,e.name),Oi(Y,e.name),Oi(z,e.name),Oi(V,e.name),Oi(te,e.name),Oi(be,e.name);const C=new xs({uid:we,auth:e,email:b,emailVerified:ge,displayName:S,isAnonymous:ie,photoURL:Y,phoneNumber:M,tenantId:z,stsTokenManager:N,createdAt:te,lastLoginAt:be});return Ee&&Array.isArray(Ee)&&(C.providerData=Ee.map(O=>Object.assign({},O))),V&&(C._redirectEventId=V),C}static async _fromIdTokenResponse(e,t,s=!1){const a=new Co;a.updateFromServerResponse(t);const c=new xs({uid:t.localId,auth:e,stsTokenManager:a,isAnonymous:s});return await Gl(c),c}static async _fromGetAccountInfoResponse(e,t,s){const a=t.users[0];nt(a.localId!==void 0,"internal-error");const c=a.providerUserInfo!==void 0?n0(a.providerUserInfo):[],d=!(a.email&&a.passwordHash)&&!(c!=null&&c.length),f=new Co;f.updateFromIdToken(s);const m=new xs({uid:a.localId,auth:e,stsTokenManager:f,isAnonymous:d}),v={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:c,metadata:new Rf(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!(c!=null&&c.length)};return Object.assign(m,v),m}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $y=new Map;function li(n){fi(n instanceof Function,"Expected a class definition");let e=$y.get(n);return e?(fi(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,$y.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r0{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}r0.type="NONE";const Wy=r0;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bu(n,e,t){return`firebase:${n}:${e}:${t}`}class Po{constructor(e,t,s){this.persistence=e,this.auth=t,this.userKey=s;const{config:a,name:c}=this.auth;this.fullUserKey=bu(this.userKey,a.apiKey,c),this.fullPersistenceKey=bu("persistence",a.apiKey,c),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Uu(this.auth,{idToken:e}).catch(()=>{});return t?xs._fromGetAccountInfoResponse(this.auth,t,e):null}return xs._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,s="authUser"){if(!t.length)return new Po(li(Wy),e,s);const a=(await Promise.all(t.map(async v=>{if(await v._isAvailable())return v}))).filter(v=>v);let c=a[0]||li(Wy);const d=bu(s,e.config.apiKey,e.name);let f=null;for(const v of t)try{const x=await v._get(d);if(x){let S;if(typeof x=="string"){const b=await Uu(e,{idToken:x}).catch(()=>{});if(!b)break;S=await xs._fromGetAccountInfoResponse(e,b,x)}else S=xs._fromJSON(e,x);v!==c&&(f=S),c=v;break}}catch{}const m=a.filter(v=>v._shouldAllowMigration);return!c._shouldAllowMigration||!m.length?new Po(c,e,s):(c=m[0],f&&await c._set(d,f.toJSON()),await Promise.all(t.map(async v=>{if(v!==c)try{await v._remove(d)}catch{}})),new Po(c,e,s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gy(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(o0(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(s0(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(c0(e))return"Blackberry";if(u0(e))return"Webos";if(i0(e))return"Safari";if((e.includes("chrome/")||a0(e))&&!e.includes("edge/"))return"Chrome";if(l0(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=n.match(t);if((s==null?void 0:s.length)===2)return s[1]}return"Other"}function s0(n=or()){return/firefox\//i.test(n)}function i0(n=or()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function a0(n=or()){return/crios\//i.test(n)}function o0(n=or()){return/iemobile/i.test(n)}function l0(n=or()){return/android/i.test(n)}function c0(n=or()){return/blackberry/i.test(n)}function u0(n=or()){return/webos/i.test(n)}function fp(n=or()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function U1(n=or()){var e;return fp(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function z1(){return XT()&&document.documentMode===10}function d0(n=or()){return fp(n)||l0(n)||u0(n)||c0(n)||/windows phone/i.test(n)||o0(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h0(n,e=[]){let t;switch(n){case"Browser":t=Gy(or());break;case"Worker":t=`${Gy(or())}-${n}`;break;default:t=n}const s=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${$o}/${s}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B1{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const s=c=>new Promise((d,f)=>{try{const m=e(c);d(m)}catch(m){f(m)}});s.onAbort=t,this.queue.push(s);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const s of this.queue)await s(e),s.onAbort&&t.push(s.onAbort)}catch(s){t.reverse();for(const a of t)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s==null?void 0:s.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $1(n,e={}){return $s(n,"GET","/v2/passwordPolicy",aa(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W1=6;class G1{constructor(e){var t,s,a,c;const d=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=d.minPasswordLength)!==null&&t!==void 0?t:W1,d.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=d.maxPasswordLength),d.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=d.containsLowercaseCharacter),d.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=d.containsUppercaseCharacter),d.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=d.containsNumericCharacter),d.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=d.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(a=(s=e.allowedNonAlphanumericCharacters)===null||s===void 0?void 0:s.join(""))!==null&&a!==void 0?a:"",this.forceUpgradeOnSignin=(c=e.forceUpgradeOnSignin)!==null&&c!==void 0?c:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,s,a,c,d,f;const m={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,m),this.validatePasswordCharacterOptions(e,m),m.isValid&&(m.isValid=(t=m.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),m.isValid&&(m.isValid=(s=m.meetsMaxPasswordLength)!==null&&s!==void 0?s:!0),m.isValid&&(m.isValid=(a=m.containsLowercaseLetter)!==null&&a!==void 0?a:!0),m.isValid&&(m.isValid=(c=m.containsUppercaseLetter)!==null&&c!==void 0?c:!0),m.isValid&&(m.isValid=(d=m.containsNumericCharacter)!==null&&d!==void 0?d:!0),m.isValid&&(m.isValid=(f=m.containsNonAlphanumericCharacter)!==null&&f!==void 0?f:!0),m}validatePasswordLengthOptions(e,t){const s=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;s&&(t.meetsMinPasswordLength=e.length>=s),a&&(t.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let s;for(let a=0;a<e.length;a++)s=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(t,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,t,s,a,c){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q1{constructor(e,t,s,a){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=s,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new qy(this),this.idTokenSubscription=new qy(this),this.beforeStateQueue=new B1(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=J_,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(c=>this._resolvePersistenceManagerAvailable=c)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=li(t)),this._initializationPromise=this.queue(async()=>{var s,a,c;if(!this._deleted&&(this.persistenceManager=await Po.create(this,e),(s=this._resolvePersistenceManagerAvailable)===null||s===void 0||s.call(this),!this._deleted)){if(!((a=this._popupRedirectResolver)===null||a===void 0)&&a._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((c=this.currentUser)===null||c===void 0?void 0:c.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Uu(this,{idToken:e}),s=await xs._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(s)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Mr(this.app)){const d=this.app.settings.authIdToken;return d?new Promise(f=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(d).then(f,f))}):this.directlySetCurrentUser(null)}const s=await this.assertedPersistence.getCurrentUser();let a=s,c=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const d=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,f=a==null?void 0:a._redirectEventId,m=await this.tryRedirectSignIn(e);(!d||d===f)&&(m!=null&&m.user)&&(a=m.user,c=!0)}if(!a)return this.directlySetCurrentUser(null);if(!a._redirectEventId){if(c)try{await this.beforeStateQueue.runMiddleware(a)}catch(d){a=s,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(d))}return a?this.reloadAndSetCurrentUserOrClear(a):this.directlySetCurrentUser(null)}return nt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===a._redirectEventId?this.directlySetCurrentUser(a):this.reloadAndSetCurrentUserOrClear(a)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Gl(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=T1()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Mr(this.app))return Promise.reject(ui(this));const t=e?Zt(e):null;return t&&nt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&nt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Mr(this.app)?Promise.reject(ui(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Mr(this.app)?Promise.reject(ui(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(li(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await $1(this),t=new G1(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new nc("auth","Firebase",e())}onAuthStateChanged(e,t,s){return this.registerStateListener(this.authStateSubscription,e,t,s)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,s){return this.registerStateListener(this.idTokenSubscription,e,t,s)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(s.tenantId=this.tenantId),await F1(this,s)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const s=await this.getOrInitRedirectPersistenceManager(t);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&li(e)||this._popupRedirectResolver;nt(t,this,"argument-error"),this.redirectPersistenceManager=await Po.create(this,[li(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,s;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((s=this.redirectUser)===null||s===void 0?void 0:s._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const s=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==s&&(this.lastNotifiedUid=s,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,s,a){if(this._deleted)return()=>{};const c=typeof t=="function"?t:t.next.bind(t);let d=!1;const f=this._isInitialized?Promise.resolve():this._initializationPromise;if(nt(f,this,"internal-error"),f.then(()=>{d||c(this.currentUser)}),typeof t=="function"){const m=e.addObserver(t,s,a);return()=>{d=!0,m()}}else{const m=e.addObserver(t);return()=>{d=!0,m()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return nt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=h0(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const s=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());s&&(t["X-Firebase-Client"]=s);const a=await this._getAppCheckToken();return a&&(t["X-Firebase-AppCheck"]=a),t}async _getAppCheckToken(){var e;if(Mr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&x1(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function oa(n){return Zt(n)}class qy{constructor(e){this.auth=e,this.observer=null,this.addObserver=aS(t=>this.observer=t)}get next(){return nt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sd={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function H1(n){sd=n}function f0(n){return sd.loadJS(n)}function K1(){return sd.recaptchaEnterpriseScript}function Q1(){return sd.gapiScript}function Y1(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class J1{constructor(){this.enterprise=new X1}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class X1{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const Z1="recaptcha-enterprise",p0="NO_RECAPTCHA";class eb{constructor(e){this.type=Z1,this.auth=oa(e)}async verify(e="verify",t=!1){async function s(c){if(!t){if(c.tenantId==null&&c._agentRecaptchaConfig!=null)return c._agentRecaptchaConfig.siteKey;if(c.tenantId!=null&&c._tenantRecaptchaConfigs[c.tenantId]!==void 0)return c._tenantRecaptchaConfigs[c.tenantId].siteKey}return new Promise(async(d,f)=>{R1(c,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(m=>{if(m.recaptchaKey===void 0)f(new Error("recaptcha Enterprise site key undefined"));else{const v=new N1(m);return c.tenantId==null?c._agentRecaptchaConfig=v:c._tenantRecaptchaConfigs[c.tenantId]=v,d(v.siteKey)}}).catch(m=>{f(m)})})}function a(c,d,f){const m=window.grecaptcha;zy(m)?m.enterprise.ready(()=>{m.enterprise.execute(c,{action:e}).then(v=>{d(v)}).catch(()=>{d(p0)})}):f(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new J1().execute("siteKey",{action:"verify"}):new Promise((c,d)=>{s(this.auth).then(f=>{if(!t&&zy(window.grecaptcha))a(f,c,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let m=K1();m.length!==0&&(m+=f),f0(m).then(()=>{a(f,c,d)}).catch(v=>{d(v)})}}).catch(f=>{d(f)})})}}async function Hy(n,e,t,s=!1,a=!1){const c=new eb(n);let d;if(a)d=p0;else try{d=await c.verify(t)}catch{d=await c.verify(t,!0)}const f=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in f){const m=f.phoneEnrollmentInfo.phoneNumber,v=f.phoneEnrollmentInfo.recaptchaToken;Object.assign(f,{phoneEnrollmentInfo:{phoneNumber:m,recaptchaToken:v,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in f){const m=f.phoneSignInInfo.recaptchaToken;Object.assign(f,{phoneSignInInfo:{recaptchaToken:m,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return f}return s?Object.assign(f,{captchaResp:d}):Object.assign(f,{captchaResponse:d}),Object.assign(f,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(f,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),f}async function Af(n,e,t,s,a){var c;if(!((c=n._getRecaptchaConfig())===null||c===void 0)&&c.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const d=await Hy(n,e,t,t==="getOobCode");return s(n,d)}else return s(n,e).catch(async d=>{if(d.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const f=await Hy(n,e,t,t==="getOobCode");return s(n,f)}else return Promise.reject(d)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tb(n,e){const t=op(n,"auth");if(t.isInitialized()){const a=t.getImmediate(),c=t.getOptions();if(Da(c,e??{}))return a;Zr(a,"already-initialized")}return t.initialize({options:e})}function nb(n,e){const t=(e==null?void 0:e.persistence)||[],s=(Array.isArray(t)?t:[t]).map(li);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(s,e==null?void 0:e.popupRedirectResolver)}function rb(n,e,t){const s=oa(n);nt(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const a=!1,c=m0(e),{host:d,port:f}=sb(e),m=f===null?"":`:${f}`,v={url:`${c}//${d}${m}/`},x=Object.freeze({host:d,port:f,protocol:c.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!s._canInitEmulator){nt(s.config.emulator&&s.emulatorConfig,s,"emulator-config-failed"),nt(Da(v,s.config.emulator)&&Da(x,s.emulatorConfig),s,"emulator-config-failed");return}s.config.emulator=v,s.emulatorConfig=x,s.settings.appVerificationDisabledForTesting=!0,Bo(d)?(B_(`${c}//${d}${m}`),$_("Auth",!0)):ib()}function m0(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function sb(n){const e=m0(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const s=t[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(s);if(a){const c=a[1];return{host:c,port:Ky(s.substr(c.length+1))}}else{const[c,d]=s.split(":");return{host:c,port:Ky(d)}}}function Ky(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function ib(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pp{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return oi("not implemented")}_getIdTokenResponse(e){return oi("not implemented")}_linkToIdToken(e,t){return oi("not implemented")}_getReauthenticationResolver(e){return oi("not implemented")}}async function ab(n,e){return $s(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ob(n,e){return ic(n,"POST","/v1/accounts:signInWithPassword",aa(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lb(n,e){return ic(n,"POST","/v1/accounts:signInWithEmailLink",aa(n,e))}async function cb(n,e){return ic(n,"POST","/v1/accounts:signInWithEmailLink",aa(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ql extends pp{constructor(e,t,s,a=null){super("password",s),this._email=e,this._password=t,this._tenantId=a}static _fromEmailAndPassword(e,t){return new ql(e,t,"password")}static _fromEmailAndCode(e,t,s=null){return new ql(e,t,"emailLink",s)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Af(e,t,"signInWithPassword",ob);case"emailLink":return lb(e,{email:this._email,oobCode:this._password});default:Zr(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const s={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Af(e,s,"signUpPassword",ab);case"emailLink":return cb(e,{idToken:t,email:this._email,oobCode:this._password});default:Zr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function No(n,e){return ic(n,"POST","/v1/accounts:signInWithIdp",aa(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ub="http://localhost";class pi extends pp{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new pi(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Zr("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:a}=t,c=lp(t,["providerId","signInMethod"]);if(!s||!a)return null;const d=new pi(s,a);return d.idToken=c.idToken||void 0,d.accessToken=c.accessToken||void 0,d.secret=c.secret,d.nonce=c.nonce,d.pendingToken=c.pendingToken||null,d}_getIdTokenResponse(e){const t=this.buildRequest();return No(e,t)}_linkToIdToken(e,t){const s=this.buildRequest();return s.idToken=t,No(e,s)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,No(e,t)}buildRequest(){const e={requestUri:ub,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=rc(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function db(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function hb(n){const e=Nl(Rl(n)).link,t=e?Nl(Rl(e)).deep_link_id:null,s=Nl(Rl(n)).deep_link_id;return(s?Nl(Rl(s)).link:null)||s||t||e||n}class mp{constructor(e){var t,s,a,c,d,f;const m=Nl(Rl(e)),v=(t=m.apiKey)!==null&&t!==void 0?t:null,x=(s=m.oobCode)!==null&&s!==void 0?s:null,S=db((a=m.mode)!==null&&a!==void 0?a:null);nt(v&&x&&S,"argument-error"),this.apiKey=v,this.operation=S,this.code=x,this.continueUrl=(c=m.continueUrl)!==null&&c!==void 0?c:null,this.languageCode=(d=m.lang)!==null&&d!==void 0?d:null,this.tenantId=(f=m.tenantId)!==null&&f!==void 0?f:null}static parseLink(e){const t=hb(e);try{return new mp(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wo{constructor(){this.providerId=Wo.PROVIDER_ID}static credential(e,t){return ql._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const s=mp.parseLink(t);return nt(s,"argument-error"),ql._fromEmailAndCode(e,s.code,s.tenantId)}}Wo.PROVIDER_ID="password";Wo.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Wo.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class id{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Go extends id{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Ml extends Go{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return nt("providerId"in t&&"signInMethod"in t,"argument-error"),pi._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return nt(e.idToken||e.accessToken,"argument-error"),pi._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return Ml.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return Ml.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:s,oauthTokenSecret:a,pendingToken:c,nonce:d,providerId:f}=e;if(!s&&!a&&!t&&!c||!f)return null;try{return new Ml(f)._credential({idToken:t,accessToken:s,nonce:d,pendingToken:c})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fi extends Go{constructor(){super("facebook.com")}static credential(e){return pi._fromParams({providerId:Fi.PROVIDER_ID,signInMethod:Fi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Fi.credentialFromTaggedObject(e)}static credentialFromError(e){return Fi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Fi.credential(e.oauthAccessToken)}catch{return null}}}Fi.FACEBOOK_SIGN_IN_METHOD="facebook.com";Fi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ys extends Go{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return pi._fromParams({providerId:ys.PROVIDER_ID,signInMethod:ys.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return ys.credentialFromTaggedObject(e)}static credentialFromError(e){return ys.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:s}=e;if(!t&&!s)return null;try{return ys.credential(t,s)}catch{return null}}}ys.GOOGLE_SIGN_IN_METHOD="google.com";ys.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ui extends Go{constructor(){super("github.com")}static credential(e){return pi._fromParams({providerId:Ui.PROVIDER_ID,signInMethod:Ui.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ui.credentialFromTaggedObject(e)}static credentialFromError(e){return Ui.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ui.credential(e.oauthAccessToken)}catch{return null}}}Ui.GITHUB_SIGN_IN_METHOD="github.com";Ui.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zi extends Go{constructor(){super("twitter.com")}static credential(e,t){return pi._fromParams({providerId:zi.PROVIDER_ID,signInMethod:zi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return zi.credentialFromTaggedObject(e)}static credentialFromError(e){return zi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:s}=e;if(!t||!s)return null;try{return zi.credential(t,s)}catch{return null}}}zi.TWITTER_SIGN_IN_METHOD="twitter.com";zi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fb(n,e){return ic(n,"POST","/v1/accounts:signUp",aa(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Va{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,s,a=!1){const c=await xs._fromIdTokenResponse(e,s,a),d=Qy(s);return new Va({user:c,providerId:d,_tokenResponse:s,operationType:t})}static async _forOperation(e,t,s){await e._updateTokensIfNecessary(s,!0);const a=Qy(s);return new Va({user:e,providerId:a,_tokenResponse:s,operationType:t})}}function Qy(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zu extends _i{constructor(e,t,s,a){var c;super(t.code,t.message),this.operationType=s,this.user=a,Object.setPrototypeOf(this,zu.prototype),this.customData={appName:e.name,tenantId:(c=e.tenantId)!==null&&c!==void 0?c:void 0,_serverResponse:t.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,t,s,a){return new zu(e,t,s,a)}}function g0(n,e,t,s){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(c=>{throw c.code==="auth/multi-factor-auth-required"?zu._fromErrorAndOperation(n,c,e,s):c})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y0(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pb(n,e){const t=Zt(n);await gb(!0,t,e);const{providerUserInfo:s}=await j1(t.auth,{idToken:await t.getIdToken(),deleteProvider:[e]}),a=y0(s||[]);return t.providerData=t.providerData.filter(c=>a.has(c.providerId)),a.has("phone")||(t.phoneNumber=null),await t.auth._persistUserIfCurrent(t),t}async function mb(n,e,t=!1){const s=await ko(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Va._forOperation(n,"link",s)}async function gb(n,e,t){await Gl(e);const s=y0(e.providerData);nt(s.has(t)===n,e.auth,"no-such-provider")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yb(n,e,t=!1){const{auth:s}=n;if(Mr(s.app))return Promise.reject(ui(s));const a="reauthenticate";try{const c=await ko(n,g0(s,a,e,n),t);nt(c.idToken,s,"internal-error");const d=hp(c.idToken);nt(d,s,"internal-error");const{sub:f}=d;return nt(n.uid===f,s,"user-mismatch"),Va._forOperation(n,a,c)}catch(c){throw(c==null?void 0:c.code)==="auth/user-not-found"&&Zr(s,"user-mismatch"),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function v0(n,e,t=!1){if(Mr(n.app))return Promise.reject(ui(n));const s="signIn",a=await g0(n,s,e),c=await Va._fromIdTokenResponse(n,s,a);return t||await n._updateCurrentUser(c.user),c}async function vb(n,e){return v0(oa(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _0(n){const e=oa(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function _b(n,e,t){if(Mr(n.app))return Promise.reject(ui(n));const s=oa(n),d=await Af(s,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",fb).catch(m=>{throw m.code==="auth/password-does-not-meet-requirements"&&_0(n),m}),f=await Va._fromIdTokenResponse(s,"signIn",d);return await s._updateCurrentUser(f.user),f}function x0(n,e,t){return Mr(n.app)?Promise.reject(ui(n)):vb(Zt(n),Wo.credential(e,t)).catch(async s=>{throw s.code==="auth/password-does-not-meet-requirements"&&_0(n),s})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xb(n,e){return $s(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wb(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const s=Zt(n),c={idToken:await s.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},d=await ko(s,xb(s.auth,c));s.displayName=d.displayName||null,s.photoURL=d.photoUrl||null;const f=s.providerData.find(({providerId:m})=>m==="password");f&&(f.displayName=s.displayName,f.photoURL=s.photoURL),await s._updateTokensIfNecessary(d)}function Eb(n,e,t,s){return Zt(n).onIdTokenChanged(e,t,s)}function Tb(n,e,t){return Zt(n).beforeAuthStateChanged(e,t)}function Sb(n,e,t,s){return Zt(n).onAuthStateChanged(e,t,s)}function w0(n){return Zt(n).signOut()}const Bu="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E0{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Bu,"1"),this.storage.removeItem(Bu),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bb=1e3,Ib=10;class T0 extends E0{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=d0(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const s=this.storage.getItem(t),a=this.localCache[t];s!==a&&e(t,a,s)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((d,f,m)=>{this.notifyListeners(d,m)});return}const s=e.key;t?this.detachListener():this.stopPolling();const a=()=>{const d=this.storage.getItem(s);!t&&this.localCache[s]===d||this.notifyListeners(s,d)},c=this.storage.getItem(s);z1()&&c!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,Ib):a()}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const a of Array.from(s))a(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:s}),!0)})},bb)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}T0.type="LOCAL";const Cb=T0;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S0 extends E0{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}S0.type="SESSION";const b0=S0;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pb(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ad{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(a=>a.isListeningto(e));if(t)return t;const s=new ad(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:s,eventType:a,data:c}=t.data,d=this.handlersMap[a];if(!(d!=null&&d.size))return;t.ports[0].postMessage({status:"ack",eventId:s,eventType:a});const f=Array.from(d).map(async v=>v(t.origin,c)),m=await Pb(f);t.ports[0].postMessage({status:"done",eventId:s,eventType:a,response:m})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}ad.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gp(n="",e=10){let t="";for(let s=0;s<e;s++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nb{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,s=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let c,d;return new Promise((f,m)=>{const v=gp("",20);a.port1.start();const x=setTimeout(()=>{m(new Error("unsupported_event"))},s);d={messageChannel:a,onMessage(S){const b=S;if(b.data.eventId===v)switch(b.data.status){case"ack":clearTimeout(x),c=setTimeout(()=>{m(new Error("timeout"))},3e3);break;case"done":clearTimeout(c),f(b.data.response);break;default:clearTimeout(x),clearTimeout(c),m(new Error("invalid_response"));break}}},this.handlers.add(d),a.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:v,data:t},[a.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ms(){return window}function Rb(n){Ms().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I0(){return typeof Ms().WorkerGlobalScope<"u"&&typeof Ms().importScripts=="function"}async function Ab(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function jb(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function kb(){return I0()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C0="firebaseLocalStorageDb",Db=1,$u="firebaseLocalStorage",P0="fbase_key";class ac{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function od(n,e){return n.transaction([$u],e?"readwrite":"readonly").objectStore($u)}function Lb(){const n=indexedDB.deleteDatabase(C0);return new ac(n).toPromise()}function jf(){const n=indexedDB.open(C0,Db);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const s=n.result;try{s.createObjectStore($u,{keyPath:P0})}catch(a){t(a)}}),n.addEventListener("success",async()=>{const s=n.result;s.objectStoreNames.contains($u)?e(s):(s.close(),await Lb(),e(await jf()))})})}async function Yy(n,e,t){const s=od(n,!0).put({[P0]:e,value:t});return new ac(s).toPromise()}async function Vb(n,e){const t=od(n,!1).get(e),s=await new ac(t).toPromise();return s===void 0?null:s.value}function Jy(n,e){const t=od(n,!0).delete(e);return new ac(t).toPromise()}const Mb=800,Ob=3;class N0{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await jf(),this.db)}async _withRetries(e){let t=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(t++>Ob)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return I0()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ad._getInstance(kb()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await Ab(),!this.activeServiceWorker)return;this.sender=new Nb(this.activeServiceWorker);const s=await this.sender._send("ping",{},800);s&&!((e=s[0])===null||e===void 0)&&e.fulfilled&&!((t=s[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||jb()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await jf();return await Yy(e,Bu,"1"),await Jy(e,Bu),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(s=>Yy(s,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(s=>Vb(s,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Jy(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const c=od(a,!1).getAll();return new ac(c).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],s=new Set;if(e.length!==0)for(const{fbase_key:a,value:c}of e)s.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(c)&&(this.notifyListeners(a,c),t.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!s.has(a)&&(this.notifyListeners(a,null),t.push(a));return t}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const a of Array.from(s))a(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Mb)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}N0.type="LOCAL";const Fb=N0;new sc(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yp(n,e){return e?li(e):(nt(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vp extends pp{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return No(e,this._buildIdpRequest())}_linkToIdToken(e,t){return No(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return No(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Ub(n){return v0(n.auth,new vp(n),n.bypassAuthState)}function zb(n){const{auth:e,user:t}=n;return nt(t,e,"internal-error"),yb(t,new vp(n),n.bypassAuthState)}async function Bb(n){const{auth:e,user:t}=n;return nt(t,e,"internal-error"),mb(t,new vp(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R0{constructor(e,t,s,a,c=!1){this.auth=e,this.resolver=s,this.user=a,this.bypassAuthState=c,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:s,postBody:a,tenantId:c,error:d,type:f}=e;if(d){this.reject(d);return}const m={auth:this.auth,requestUri:t,sessionId:s,tenantId:c||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(f)(m))}catch(v){this.reject(v)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Ub;case"linkViaPopup":case"linkViaRedirect":return Bb;case"reauthViaPopup":case"reauthViaRedirect":return zb;default:Zr(this.auth,"internal-error")}}resolve(e){fi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){fi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $b=new sc(2e3,1e4);async function A0(n,e,t){if(Mr(n.app))return Promise.reject(ws(n,"operation-not-supported-in-this-environment"));const s=oa(n);X_(n,e,id);const a=yp(s,t);return new $i(s,"signInViaPopup",e,a).executeNotNull()}async function Xy(n,e,t){const s=Zt(n);X_(s.auth,e,id);const a=yp(s.auth,t);return new $i(s.auth,"linkViaPopup",e,a,s).executeNotNull()}class $i extends R0{constructor(e,t,s,a,c){super(e,t,a,c),this.provider=s,this.authWindow=null,this.pollId=null,$i.currentPopupAction&&$i.currentPopupAction.cancel(),$i.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return nt(e,this.auth,"internal-error"),e}async onExecution(){fi(this.filter.length===1,"Popup operations only handle one event");const e=gp();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(ws(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(ws(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,$i.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,s;if(!((s=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||s===void 0)&&s.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ws(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,$b.get())};e()}}$i.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wb="pendingRedirect",Iu=new Map;class Gb extends R0{constructor(e,t,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,s),this.eventId=null}async execute(){let e=Iu.get(this.auth._key());if(!e){try{const s=await qb(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(t){e=()=>Promise.reject(t)}Iu.set(this.auth._key(),e)}return this.bypassAuthState||Iu.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function qb(n,e){const t=Qb(e),s=Kb(n);if(!await s._isAvailable())return!1;const a=await s._get(t)==="true";return await s._remove(t),a}function Hb(n,e){Iu.set(n._key(),e)}function Kb(n){return li(n._redirectPersistence)}function Qb(n){return bu(Wb,n.config.apiKey,n.name)}async function Yb(n,e,t=!1){if(Mr(n.app))return Promise.reject(ui(n));const s=oa(n),a=yp(s,e),d=await new Gb(s,a,t).execute();return d&&!t&&(delete d.user._redirectEventId,await s._persistUserIfCurrent(d.user),await s._setRedirectUser(null,e)),d}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jb=600*1e3;class Xb{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(t=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Zb(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var s;if(e.error&&!j0(e)){const a=((s=e.error.code)===null||s===void 0?void 0:s.split("auth/")[1])||"internal-error";t.onError(ws(this.auth,a))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const s=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Jb&&this.cachedEventUids.clear(),this.cachedEventUids.has(Zy(e))}saveEventToCache(e){this.cachedEventUids.add(Zy(e)),this.lastProcessedEventTime=Date.now()}}function Zy(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function j0({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function Zb(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return j0(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eI(n,e={}){return $s(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tI=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,nI=/^https?/;async function rI(n){if(n.config.emulator)return;const{authorizedDomains:e}=await eI(n);for(const t of e)try{if(sI(t))return}catch{}Zr(n,"unauthorized-domain")}function sI(n){const e=Nf(),{protocol:t,hostname:s}=new URL(e);if(n.startsWith("chrome-extension://")){const d=new URL(n);return d.hostname===""&&s===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&d.hostname===s}if(!nI.test(t))return!1;if(tI.test(n))return s===n;const a=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(s)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iI=new sc(3e4,6e4);function ev(){const n=Ms().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function aI(n){return new Promise((e,t)=>{var s,a,c;function d(){ev(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{ev(),t(ws(n,"network-request-failed"))},timeout:iI.get()})}if(!((a=(s=Ms().gapi)===null||s===void 0?void 0:s.iframes)===null||a===void 0)&&a.Iframe)e(gapi.iframes.getContext());else if(!((c=Ms().gapi)===null||c===void 0)&&c.load)d();else{const f=Y1("iframefcb");return Ms()[f]=()=>{gapi.load?d():t(ws(n,"network-request-failed"))},f0(`${Q1()}?onload=${f}`).catch(m=>t(m))}}).catch(e=>{throw Cu=null,e})}let Cu=null;function oI(n){return Cu=Cu||aI(n),Cu}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lI=new sc(5e3,15e3),cI="__/auth/iframe",uI="emulator/auth/iframe",dI={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},hI=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function fI(n){const e=n.config;nt(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?dp(e,uI):`https://${n.config.authDomain}/${cI}`,s={apiKey:e.apiKey,appName:n.name,v:$o},a=hI.get(n.config.apiHost);a&&(s.eid=a);const c=n._getFrameworks();return c.length&&(s.fw=c.join(",")),`${t}?${rc(s).slice(1)}`}async function pI(n){const e=await oI(n),t=Ms().gapi;return nt(t,n,"internal-error"),e.open({where:document.body,url:fI(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:dI,dontclear:!0},s=>new Promise(async(a,c)=>{await s.restyle({setHideOnLeave:!1});const d=ws(n,"network-request-failed"),f=Ms().setTimeout(()=>{c(d)},lI.get());function m(){Ms().clearTimeout(f),a(s)}s.ping(m).then(m,()=>{c(d)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mI={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},gI=500,yI=600,vI="_blank",_I="http://localhost";class tv{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function xI(n,e,t,s=gI,a=yI){const c=Math.max((window.screen.availHeight-a)/2,0).toString(),d=Math.max((window.screen.availWidth-s)/2,0).toString();let f="";const m=Object.assign(Object.assign({},mI),{width:s.toString(),height:a.toString(),top:c,left:d}),v=or().toLowerCase();t&&(f=a0(v)?vI:t),s0(v)&&(e=e||_I,m.scrollbars="yes");const x=Object.entries(m).reduce((b,[M,Y])=>`${b}${M}=${Y},`,"");if(U1(v)&&f!=="_self")return wI(e||"",f),new tv(null);const S=window.open(e||"",f,x);nt(S,n,"popup-blocked");try{S.focus()}catch{}return new tv(S)}function wI(n,e){const t=document.createElement("a");t.href=n,t.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EI="__/auth/handler",TI="emulator/auth/handler",SI=encodeURIComponent("fac");async function nv(n,e,t,s,a,c){nt(n.config.authDomain,n,"auth-domain-config-required"),nt(n.config.apiKey,n,"invalid-api-key");const d={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:s,v:$o,eventId:a};if(e instanceof id){e.setDefaultLanguage(n.languageCode),d.providerId=e.providerId||"",iS(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[x,S]of Object.entries({}))d[x]=S}if(e instanceof Go){const x=e.getScopes().filter(S=>S!=="");x.length>0&&(d.scopes=x.join(","))}n.tenantId&&(d.tid=n.tenantId);const f=d;for(const x of Object.keys(f))f[x]===void 0&&delete f[x];const m=await n._getAppCheckToken(),v=m?`#${SI}=${encodeURIComponent(m)}`:"";return`${bI(n)}?${rc(f).slice(1)}${v}`}function bI({config:n}){return n.emulator?dp(n,TI):`https://${n.authDomain}/${EI}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const df="webStorageSupport";class II{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=b0,this._completeRedirectFn=Yb,this._overrideRedirectResult=Hb}async _openPopup(e,t,s,a){var c;fi((c=this.eventManagers[e._key()])===null||c===void 0?void 0:c.manager,"_initialize() not called before _openPopup()");const d=await nv(e,t,s,Nf(),a);return xI(e,d,gp())}async _openRedirect(e,t,s,a){await this._originValidation(e);const c=await nv(e,t,s,Nf(),a);return Rb(c),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:a,promise:c}=this.eventManagers[t];return a?Promise.resolve(a):(fi(c,"If manager is not set, promise should be"),c)}const s=this.initAndGetManager(e);return this.eventManagers[t]={promise:s},s.catch(()=>{delete this.eventManagers[t]}),s}async initAndGetManager(e){const t=await pI(e),s=new Xb(e);return t.register("authEvent",a=>(nt(a==null?void 0:a.authEvent,e,"invalid-auth-event"),{status:s.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=t,s}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(df,{type:df},a=>{var c;const d=(c=a==null?void 0:a[0])===null||c===void 0?void 0:c[df];d!==void 0&&t(!!d),Zr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=rI(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return d0()||i0()||fp()}}const CI=II;var rv="@firebase/auth",sv="1.10.8";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PI{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(s=>{e((s==null?void 0:s.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){nt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NI(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function RI(n){jo(new La("auth",(e,{options:t})=>{const s=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),c=e.getProvider("app-check-internal"),{apiKey:d,authDomain:f}=s.options;nt(d&&!d.includes(":"),"invalid-api-key",{appName:s.name});const m={apiKey:d,authDomain:f,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:h0(n)},v=new q1(s,a,c,m);return nb(v,t),v},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,s)=>{e.getProvider("auth-internal").initialize()})),jo(new La("auth-internal",e=>{const t=oa(e.getProvider("auth").getImmediate());return(s=>new PI(s))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ki(rv,sv,NI(n)),Ki(rv,sv,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AI=300,jI=z_("authIdTokenMaxAge")||AI;let iv=null;const kI=n=>async e=>{const t=e&&await e.getIdTokenResult(),s=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(s&&s>jI)return;const a=t==null?void 0:t.token;iv!==a&&(iv=a,await fetch(n,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function DI(n=H_()){const e=op(n,"auth");if(e.isInitialized())return e.getImmediate();const t=tb(n,{popupRedirectResolver:CI,persistence:[Fb,Cb,b0]}),s=z_("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const c=new URL(s,location.origin);if(location.origin===c.origin){const d=kI(c.toString());Tb(t,d,()=>d(t.currentUser)),Eb(t,f=>d(f))}}const a=F_("auth");return a&&rb(t,`http://${a}`),t}function LI(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}H1({loadJS(n){return new Promise((e,t)=>{const s=document.createElement("script");s.setAttribute("src",n),s.onload=e,s.onerror=a=>{const c=ws("internal-error");c.customData=a,t(c)},s.type="text/javascript",s.charset="UTF-8",LI().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});RI("Browser");var av=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Qi,k0;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(D,N){function C(){}C.prototype=N.prototype,D.D=N.prototype,D.prototype=new C,D.prototype.constructor=D,D.C=function(O,G,k){for(var P=Array(arguments.length-2),ve=2;ve<arguments.length;ve++)P[ve-2]=arguments[ve];return N.prototype[G].apply(O,P)}}function t(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(s,t),s.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(D,N,C){C||(C=0);var O=Array(16);if(typeof N=="string")for(var G=0;16>G;++G)O[G]=N.charCodeAt(C++)|N.charCodeAt(C++)<<8|N.charCodeAt(C++)<<16|N.charCodeAt(C++)<<24;else for(G=0;16>G;++G)O[G]=N[C++]|N[C++]<<8|N[C++]<<16|N[C++]<<24;N=D.g[0],C=D.g[1],G=D.g[2];var k=D.g[3],P=N+(k^C&(G^k))+O[0]+3614090360&4294967295;N=C+(P<<7&4294967295|P>>>25),P=k+(G^N&(C^G))+O[1]+3905402710&4294967295,k=N+(P<<12&4294967295|P>>>20),P=G+(C^k&(N^C))+O[2]+606105819&4294967295,G=k+(P<<17&4294967295|P>>>15),P=C+(N^G&(k^N))+O[3]+3250441966&4294967295,C=G+(P<<22&4294967295|P>>>10),P=N+(k^C&(G^k))+O[4]+4118548399&4294967295,N=C+(P<<7&4294967295|P>>>25),P=k+(G^N&(C^G))+O[5]+1200080426&4294967295,k=N+(P<<12&4294967295|P>>>20),P=G+(C^k&(N^C))+O[6]+2821735955&4294967295,G=k+(P<<17&4294967295|P>>>15),P=C+(N^G&(k^N))+O[7]+4249261313&4294967295,C=G+(P<<22&4294967295|P>>>10),P=N+(k^C&(G^k))+O[8]+1770035416&4294967295,N=C+(P<<7&4294967295|P>>>25),P=k+(G^N&(C^G))+O[9]+2336552879&4294967295,k=N+(P<<12&4294967295|P>>>20),P=G+(C^k&(N^C))+O[10]+4294925233&4294967295,G=k+(P<<17&4294967295|P>>>15),P=C+(N^G&(k^N))+O[11]+2304563134&4294967295,C=G+(P<<22&4294967295|P>>>10),P=N+(k^C&(G^k))+O[12]+1804603682&4294967295,N=C+(P<<7&4294967295|P>>>25),P=k+(G^N&(C^G))+O[13]+4254626195&4294967295,k=N+(P<<12&4294967295|P>>>20),P=G+(C^k&(N^C))+O[14]+2792965006&4294967295,G=k+(P<<17&4294967295|P>>>15),P=C+(N^G&(k^N))+O[15]+1236535329&4294967295,C=G+(P<<22&4294967295|P>>>10),P=N+(G^k&(C^G))+O[1]+4129170786&4294967295,N=C+(P<<5&4294967295|P>>>27),P=k+(C^G&(N^C))+O[6]+3225465664&4294967295,k=N+(P<<9&4294967295|P>>>23),P=G+(N^C&(k^N))+O[11]+643717713&4294967295,G=k+(P<<14&4294967295|P>>>18),P=C+(k^N&(G^k))+O[0]+3921069994&4294967295,C=G+(P<<20&4294967295|P>>>12),P=N+(G^k&(C^G))+O[5]+3593408605&4294967295,N=C+(P<<5&4294967295|P>>>27),P=k+(C^G&(N^C))+O[10]+38016083&4294967295,k=N+(P<<9&4294967295|P>>>23),P=G+(N^C&(k^N))+O[15]+3634488961&4294967295,G=k+(P<<14&4294967295|P>>>18),P=C+(k^N&(G^k))+O[4]+3889429448&4294967295,C=G+(P<<20&4294967295|P>>>12),P=N+(G^k&(C^G))+O[9]+568446438&4294967295,N=C+(P<<5&4294967295|P>>>27),P=k+(C^G&(N^C))+O[14]+3275163606&4294967295,k=N+(P<<9&4294967295|P>>>23),P=G+(N^C&(k^N))+O[3]+4107603335&4294967295,G=k+(P<<14&4294967295|P>>>18),P=C+(k^N&(G^k))+O[8]+1163531501&4294967295,C=G+(P<<20&4294967295|P>>>12),P=N+(G^k&(C^G))+O[13]+2850285829&4294967295,N=C+(P<<5&4294967295|P>>>27),P=k+(C^G&(N^C))+O[2]+4243563512&4294967295,k=N+(P<<9&4294967295|P>>>23),P=G+(N^C&(k^N))+O[7]+1735328473&4294967295,G=k+(P<<14&4294967295|P>>>18),P=C+(k^N&(G^k))+O[12]+2368359562&4294967295,C=G+(P<<20&4294967295|P>>>12),P=N+(C^G^k)+O[5]+4294588738&4294967295,N=C+(P<<4&4294967295|P>>>28),P=k+(N^C^G)+O[8]+2272392833&4294967295,k=N+(P<<11&4294967295|P>>>21),P=G+(k^N^C)+O[11]+1839030562&4294967295,G=k+(P<<16&4294967295|P>>>16),P=C+(G^k^N)+O[14]+4259657740&4294967295,C=G+(P<<23&4294967295|P>>>9),P=N+(C^G^k)+O[1]+2763975236&4294967295,N=C+(P<<4&4294967295|P>>>28),P=k+(N^C^G)+O[4]+1272893353&4294967295,k=N+(P<<11&4294967295|P>>>21),P=G+(k^N^C)+O[7]+4139469664&4294967295,G=k+(P<<16&4294967295|P>>>16),P=C+(G^k^N)+O[10]+3200236656&4294967295,C=G+(P<<23&4294967295|P>>>9),P=N+(C^G^k)+O[13]+681279174&4294967295,N=C+(P<<4&4294967295|P>>>28),P=k+(N^C^G)+O[0]+3936430074&4294967295,k=N+(P<<11&4294967295|P>>>21),P=G+(k^N^C)+O[3]+3572445317&4294967295,G=k+(P<<16&4294967295|P>>>16),P=C+(G^k^N)+O[6]+76029189&4294967295,C=G+(P<<23&4294967295|P>>>9),P=N+(C^G^k)+O[9]+3654602809&4294967295,N=C+(P<<4&4294967295|P>>>28),P=k+(N^C^G)+O[12]+3873151461&4294967295,k=N+(P<<11&4294967295|P>>>21),P=G+(k^N^C)+O[15]+530742520&4294967295,G=k+(P<<16&4294967295|P>>>16),P=C+(G^k^N)+O[2]+3299628645&4294967295,C=G+(P<<23&4294967295|P>>>9),P=N+(G^(C|~k))+O[0]+4096336452&4294967295,N=C+(P<<6&4294967295|P>>>26),P=k+(C^(N|~G))+O[7]+1126891415&4294967295,k=N+(P<<10&4294967295|P>>>22),P=G+(N^(k|~C))+O[14]+2878612391&4294967295,G=k+(P<<15&4294967295|P>>>17),P=C+(k^(G|~N))+O[5]+4237533241&4294967295,C=G+(P<<21&4294967295|P>>>11),P=N+(G^(C|~k))+O[12]+1700485571&4294967295,N=C+(P<<6&4294967295|P>>>26),P=k+(C^(N|~G))+O[3]+2399980690&4294967295,k=N+(P<<10&4294967295|P>>>22),P=G+(N^(k|~C))+O[10]+4293915773&4294967295,G=k+(P<<15&4294967295|P>>>17),P=C+(k^(G|~N))+O[1]+2240044497&4294967295,C=G+(P<<21&4294967295|P>>>11),P=N+(G^(C|~k))+O[8]+1873313359&4294967295,N=C+(P<<6&4294967295|P>>>26),P=k+(C^(N|~G))+O[15]+4264355552&4294967295,k=N+(P<<10&4294967295|P>>>22),P=G+(N^(k|~C))+O[6]+2734768916&4294967295,G=k+(P<<15&4294967295|P>>>17),P=C+(k^(G|~N))+O[13]+1309151649&4294967295,C=G+(P<<21&4294967295|P>>>11),P=N+(G^(C|~k))+O[4]+4149444226&4294967295,N=C+(P<<6&4294967295|P>>>26),P=k+(C^(N|~G))+O[11]+3174756917&4294967295,k=N+(P<<10&4294967295|P>>>22),P=G+(N^(k|~C))+O[2]+718787259&4294967295,G=k+(P<<15&4294967295|P>>>17),P=C+(k^(G|~N))+O[9]+3951481745&4294967295,D.g[0]=D.g[0]+N&4294967295,D.g[1]=D.g[1]+(G+(P<<21&4294967295|P>>>11))&4294967295,D.g[2]=D.g[2]+G&4294967295,D.g[3]=D.g[3]+k&4294967295}s.prototype.u=function(D,N){N===void 0&&(N=D.length);for(var C=N-this.blockSize,O=this.B,G=this.h,k=0;k<N;){if(G==0)for(;k<=C;)a(this,D,k),k+=this.blockSize;if(typeof D=="string"){for(;k<N;)if(O[G++]=D.charCodeAt(k++),G==this.blockSize){a(this,O),G=0;break}}else for(;k<N;)if(O[G++]=D[k++],G==this.blockSize){a(this,O),G=0;break}}this.h=G,this.o+=N},s.prototype.v=function(){var D=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);D[0]=128;for(var N=1;N<D.length-8;++N)D[N]=0;var C=8*this.o;for(N=D.length-8;N<D.length;++N)D[N]=C&255,C/=256;for(this.u(D),D=Array(16),N=C=0;4>N;++N)for(var O=0;32>O;O+=8)D[C++]=this.g[N]>>>O&255;return D};function c(D,N){var C=f;return Object.prototype.hasOwnProperty.call(C,D)?C[D]:C[D]=N(D)}function d(D,N){this.h=N;for(var C=[],O=!0,G=D.length-1;0<=G;G--){var k=D[G]|0;O&&k==N||(C[G]=k,O=!1)}this.g=C}var f={};function m(D){return-128<=D&&128>D?c(D,function(N){return new d([N|0],0>N?-1:0)}):new d([D|0],0>D?-1:0)}function v(D){if(isNaN(D)||!isFinite(D))return S;if(0>D)return V(v(-D));for(var N=[],C=1,O=0;D>=C;O++)N[O]=D/C|0,C*=4294967296;return new d(N,0)}function x(D,N){if(D.length==0)throw Error("number format error: empty string");if(N=N||10,2>N||36<N)throw Error("radix out of range: "+N);if(D.charAt(0)=="-")return V(x(D.substring(1),N));if(0<=D.indexOf("-"))throw Error('number format error: interior "-" character');for(var C=v(Math.pow(N,8)),O=S,G=0;G<D.length;G+=8){var k=Math.min(8,D.length-G),P=parseInt(D.substring(G,G+k),N);8>k?(k=v(Math.pow(N,k)),O=O.j(k).add(v(P))):(O=O.j(C),O=O.add(v(P)))}return O}var S=m(0),b=m(1),M=m(16777216);n=d.prototype,n.m=function(){if(z(this))return-V(this).m();for(var D=0,N=1,C=0;C<this.g.length;C++){var O=this.i(C);D+=(0<=O?O:4294967296+O)*N,N*=4294967296}return D},n.toString=function(D){if(D=D||10,2>D||36<D)throw Error("radix out of range: "+D);if(Y(this))return"0";if(z(this))return"-"+V(this).toString(D);for(var N=v(Math.pow(D,6)),C=this,O="";;){var G=ge(C,N).g;C=te(C,G.j(N));var k=((0<C.g.length?C.g[0]:C.h)>>>0).toString(D);if(C=G,Y(C))return k+O;for(;6>k.length;)k="0"+k;O=k+O}},n.i=function(D){return 0>D?0:D<this.g.length?this.g[D]:this.h};function Y(D){if(D.h!=0)return!1;for(var N=0;N<D.g.length;N++)if(D.g[N]!=0)return!1;return!0}function z(D){return D.h==-1}n.l=function(D){return D=te(this,D),z(D)?-1:Y(D)?0:1};function V(D){for(var N=D.g.length,C=[],O=0;O<N;O++)C[O]=~D.g[O];return new d(C,~D.h).add(b)}n.abs=function(){return z(this)?V(this):this},n.add=function(D){for(var N=Math.max(this.g.length,D.g.length),C=[],O=0,G=0;G<=N;G++){var k=O+(this.i(G)&65535)+(D.i(G)&65535),P=(k>>>16)+(this.i(G)>>>16)+(D.i(G)>>>16);O=P>>>16,k&=65535,P&=65535,C[G]=P<<16|k}return new d(C,C[C.length-1]&-2147483648?-1:0)};function te(D,N){return D.add(V(N))}n.j=function(D){if(Y(this)||Y(D))return S;if(z(this))return z(D)?V(this).j(V(D)):V(V(this).j(D));if(z(D))return V(this.j(V(D)));if(0>this.l(M)&&0>D.l(M))return v(this.m()*D.m());for(var N=this.g.length+D.g.length,C=[],O=0;O<2*N;O++)C[O]=0;for(O=0;O<this.g.length;O++)for(var G=0;G<D.g.length;G++){var k=this.i(O)>>>16,P=this.i(O)&65535,ve=D.i(G)>>>16,Ge=D.i(G)&65535;C[2*O+2*G]+=P*Ge,be(C,2*O+2*G),C[2*O+2*G+1]+=k*Ge,be(C,2*O+2*G+1),C[2*O+2*G+1]+=P*ve,be(C,2*O+2*G+1),C[2*O+2*G+2]+=k*ve,be(C,2*O+2*G+2)}for(O=0;O<N;O++)C[O]=C[2*O+1]<<16|C[2*O];for(O=N;O<2*N;O++)C[O]=0;return new d(C,0)};function be(D,N){for(;(D[N]&65535)!=D[N];)D[N+1]+=D[N]>>>16,D[N]&=65535,N++}function we(D,N){this.g=D,this.h=N}function ge(D,N){if(Y(N))throw Error("division by zero");if(Y(D))return new we(S,S);if(z(D))return N=ge(V(D),N),new we(V(N.g),V(N.h));if(z(N))return N=ge(D,V(N)),new we(V(N.g),N.h);if(30<D.g.length){if(z(D)||z(N))throw Error("slowDivide_ only works with positive integers.");for(var C=b,O=N;0>=O.l(D);)C=ie(C),O=ie(O);var G=Ee(C,1),k=Ee(O,1);for(O=Ee(O,2),C=Ee(C,2);!Y(O);){var P=k.add(O);0>=P.l(D)&&(G=G.add(C),k=P),O=Ee(O,1),C=Ee(C,1)}return N=te(D,G.j(N)),new we(G,N)}for(G=S;0<=D.l(N);){for(C=Math.max(1,Math.floor(D.m()/N.m())),O=Math.ceil(Math.log(C)/Math.LN2),O=48>=O?1:Math.pow(2,O-48),k=v(C),P=k.j(N);z(P)||0<P.l(D);)C-=O,k=v(C),P=k.j(N);Y(k)&&(k=b),G=G.add(k),D=te(D,P)}return new we(G,D)}n.A=function(D){return ge(this,D).h},n.and=function(D){for(var N=Math.max(this.g.length,D.g.length),C=[],O=0;O<N;O++)C[O]=this.i(O)&D.i(O);return new d(C,this.h&D.h)},n.or=function(D){for(var N=Math.max(this.g.length,D.g.length),C=[],O=0;O<N;O++)C[O]=this.i(O)|D.i(O);return new d(C,this.h|D.h)},n.xor=function(D){for(var N=Math.max(this.g.length,D.g.length),C=[],O=0;O<N;O++)C[O]=this.i(O)^D.i(O);return new d(C,this.h^D.h)};function ie(D){for(var N=D.g.length+1,C=[],O=0;O<N;O++)C[O]=D.i(O)<<1|D.i(O-1)>>>31;return new d(C,D.h)}function Ee(D,N){var C=N>>5;N%=32;for(var O=D.g.length-C,G=[],k=0;k<O;k++)G[k]=0<N?D.i(k+C)>>>N|D.i(k+C+1)<<32-N:D.i(k+C);return new d(G,D.h)}s.prototype.digest=s.prototype.v,s.prototype.reset=s.prototype.s,s.prototype.update=s.prototype.u,k0=s,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.A,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=v,d.fromString=x,Qi=d}).apply(typeof av<"u"?av:typeof self<"u"?self:typeof window<"u"?window:{});var yu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var D0,Al,L0,Pu,kf,V0,M0,O0;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,g,_){return u==Array.prototype||u==Object.prototype||(u[g]=_.value),u};function t(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof yu=="object"&&yu];for(var g=0;g<u.length;++g){var _=u[g];if(_&&_.Math==Math)return _}throw Error("Cannot find global object")}var s=t(this);function a(u,g){if(g)e:{var _=s;u=u.split(".");for(var I=0;I<u.length-1;I++){var J=u[I];if(!(J in _))break e;_=_[J]}u=u[u.length-1],I=_[u],g=g(I),g!=I&&g!=null&&e(_,u,{configurable:!0,writable:!0,value:g})}}function c(u,g){u instanceof String&&(u+="");var _=0,I=!1,J={next:function(){if(!I&&_<u.length){var ne=_++;return{value:g(ne,u[ne]),done:!1}}return I=!0,{done:!0,value:void 0}}};return J[Symbol.iterator]=function(){return J},J}a("Array.prototype.values",function(u){return u||function(){return c(this,function(g,_){return _})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var d=d||{},f=this||self;function m(u){var g=typeof u;return g=g!="object"?g:u?Array.isArray(u)?"array":g:"null",g=="array"||g=="object"&&typeof u.length=="number"}function v(u){var g=typeof u;return g=="object"&&u!=null||g=="function"}function x(u,g,_){return u.call.apply(u.bind,arguments)}function S(u,g,_){if(!u)throw Error();if(2<arguments.length){var I=Array.prototype.slice.call(arguments,2);return function(){var J=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(J,I),u.apply(g,J)}}return function(){return u.apply(g,arguments)}}function b(u,g,_){return b=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?x:S,b.apply(null,arguments)}function M(u,g){var _=Array.prototype.slice.call(arguments,1);return function(){var I=_.slice();return I.push.apply(I,arguments),u.apply(this,I)}}function Y(u,g){function _(){}_.prototype=g.prototype,u.aa=g.prototype,u.prototype=new _,u.prototype.constructor=u,u.Qb=function(I,J,ne){for(var Ve=Array(arguments.length-2),jt=2;jt<arguments.length;jt++)Ve[jt-2]=arguments[jt];return g.prototype[J].apply(I,Ve)}}function z(u){const g=u.length;if(0<g){const _=Array(g);for(let I=0;I<g;I++)_[I]=u[I];return _}return[]}function V(u,g){for(let _=1;_<arguments.length;_++){const I=arguments[_];if(m(I)){const J=u.length||0,ne=I.length||0;u.length=J+ne;for(let Ve=0;Ve<ne;Ve++)u[J+Ve]=I[Ve]}else u.push(I)}}class te{constructor(g,_){this.i=g,this.j=_,this.h=0,this.g=null}get(){let g;return 0<this.h?(this.h--,g=this.g,this.g=g.next,g.next=null):g=this.i(),g}}function be(u){return/^[\s\xa0]*$/.test(u)}function we(){var u=f.navigator;return u&&(u=u.userAgent)?u:""}function ge(u){return ge[" "](u),u}ge[" "]=function(){};var ie=we().indexOf("Gecko")!=-1&&!(we().toLowerCase().indexOf("webkit")!=-1&&we().indexOf("Edge")==-1)&&!(we().indexOf("Trident")!=-1||we().indexOf("MSIE")!=-1)&&we().indexOf("Edge")==-1;function Ee(u,g,_){for(const I in u)g.call(_,u[I],I,u)}function D(u,g){for(const _ in u)g.call(void 0,u[_],_,u)}function N(u){const g={};for(const _ in u)g[_]=u[_];return g}const C="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function O(u,g){let _,I;for(let J=1;J<arguments.length;J++){I=arguments[J];for(_ in I)u[_]=I[_];for(let ne=0;ne<C.length;ne++)_=C[ne],Object.prototype.hasOwnProperty.call(I,_)&&(u[_]=I[_])}}function G(u){var g=1;u=u.split(":");const _=[];for(;0<g&&u.length;)_.push(u.shift()),g--;return u.length&&_.push(u.join(":")),_}function k(u){f.setTimeout(()=>{throw u},0)}function P(){var u=Ie;let g=null;return u.g&&(g=u.g,u.g=u.g.next,u.g||(u.h=null),g.next=null),g}class ve{constructor(){this.h=this.g=null}add(g,_){const I=Ge.get();I.set(g,_),this.h?this.h.next=I:this.g=I,this.h=I}}var Ge=new te(()=>new Re,u=>u.reset());class Re{constructor(){this.next=this.g=this.h=null}set(g,_){this.h=g,this.g=_,this.next=null}reset(){this.next=this.g=this.h=null}}let ce,re=!1,Ie=new ve,xe=()=>{const u=f.Promise.resolve(void 0);ce=()=>{u.then(K)}};var K=()=>{for(var u;u=P();){try{u.h.call(u.g)}catch(_){k(_)}var g=Ge;g.j(u),100>g.h&&(g.h++,u.next=g.g,g.g=u)}re=!1};function A(){this.s=this.s,this.C=this.C}A.prototype.s=!1,A.prototype.ma=function(){this.s||(this.s=!0,this.N())},A.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function W(u,g){this.type=u,this.g=this.target=g,this.defaultPrevented=!1}W.prototype.h=function(){this.defaultPrevented=!0};var ye=(function(){if(!f.addEventListener||!Object.defineProperty)return!1;var u=!1,g=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const _=()=>{};f.addEventListener("test",_,g),f.removeEventListener("test",_,g)}catch{}return u})();function De(u,g){if(W.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var _=this.type=u.type,I=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=g,g=u.relatedTarget){if(ie){e:{try{ge(g.nodeName);var J=!0;break e}catch{}J=!1}J||(g=null)}}else _=="mouseover"?g=u.fromElement:_=="mouseout"&&(g=u.toElement);this.relatedTarget=g,I?(this.clientX=I.clientX!==void 0?I.clientX:I.pageX,this.clientY=I.clientY!==void 0?I.clientY:I.pageY,this.screenX=I.screenX||0,this.screenY=I.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:je[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&De.aa.h.call(this)}}Y(De,W);var je={2:"touch",3:"pen",4:"mouse"};De.prototype.h=function(){De.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var Me="closure_listenable_"+(1e6*Math.random()|0),ae=0;function ze(u,g,_,I,J){this.listener=u,this.proxy=null,this.src=g,this.type=_,this.capture=!!I,this.ha=J,this.key=++ae,this.da=this.fa=!1}function Je(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function pe(u){this.src=u,this.g={},this.h=0}pe.prototype.add=function(u,g,_,I,J){var ne=u.toString();u=this.g[ne],u||(u=this.g[ne]=[],this.h++);var Ve=he(u,g,I,J);return-1<Ve?(g=u[Ve],_||(g.fa=!1)):(g=new ze(g,this.src,ne,!!I,J),g.fa=_,u.push(g)),g};function Be(u,g){var _=g.type;if(_ in u.g){var I=u.g[_],J=Array.prototype.indexOf.call(I,g,void 0),ne;(ne=0<=J)&&Array.prototype.splice.call(I,J,1),ne&&(Je(g),u.g[_].length==0&&(delete u.g[_],u.h--))}}function he(u,g,_,I){for(var J=0;J<u.length;++J){var ne=u[J];if(!ne.da&&ne.listener==g&&ne.capture==!!_&&ne.ha==I)return J}return-1}var Qe="closure_lm_"+(1e6*Math.random()|0),Ye={};function _t(u,g,_,I,J){if(Array.isArray(g)){for(var ne=0;ne<g.length;ne++)_t(u,g[ne],_,I,J);return null}return _=Kn(_),u&&u[Me]?u.K(g,_,v(I)?!!I.capture:!1,J):Nt(u,g,_,!1,I,J)}function Nt(u,g,_,I,J,ne){if(!g)throw Error("Invalid event type");var Ve=v(J)?!!J.capture:!!J,jt=fr(u);if(jt||(u[Qe]=jt=new pe(u)),_=jt.add(g,_,I,Ve,ne),_.proxy)return _;if(I=xt(),_.proxy=I,I.src=u,I.listener=_,u.addEventListener)ye||(J=Ve),J===void 0&&(J=!1),u.addEventListener(g.toString(),I,J);else if(u.attachEvent)u.attachEvent(mn(g.toString()),I);else if(u.addListener&&u.removeListener)u.addListener(I);else throw Error("addEventListener and attachEvent are unavailable.");return _}function xt(){function u(_){return g.call(u.src,u.listener,_)}const g=ln;return u}function Ct(u,g,_,I,J){if(Array.isArray(g))for(var ne=0;ne<g.length;ne++)Ct(u,g[ne],_,I,J);else I=v(I)?!!I.capture:!!I,_=Kn(_),u&&u[Me]?(u=u.i,g=String(g).toString(),g in u.g&&(ne=u.g[g],_=he(ne,_,I,J),-1<_&&(Je(ne[_]),Array.prototype.splice.call(ne,_,1),ne.length==0&&(delete u.g[g],u.h--)))):u&&(u=fr(u))&&(g=u.g[g.toString()],u=-1,g&&(u=he(g,_,I,J)),(_=-1<u?g[u]:null)&&en(_))}function en(u){if(typeof u!="number"&&u&&!u.da){var g=u.src;if(g&&g[Me])Be(g.i,u);else{var _=u.type,I=u.proxy;g.removeEventListener?g.removeEventListener(_,I,u.capture):g.detachEvent?g.detachEvent(mn(_),I):g.addListener&&g.removeListener&&g.removeListener(I),(_=fr(g))?(Be(_,u),_.h==0&&(_.src=null,g[Qe]=null)):Je(u)}}}function mn(u){return u in Ye?Ye[u]:Ye[u]="on"+u}function ln(u,g){if(u.da)u=!0;else{g=new De(g,this);var _=u.listener,I=u.ha||u.src;u.fa&&en(u),u=_.call(I,g)}return u}function fr(u){return u=u[Qe],u instanceof pe?u:null}var tn="__closure_events_fn_"+(1e9*Math.random()>>>0);function Kn(u){return typeof u=="function"?u:(u[tn]||(u[tn]=function(g){return u.handleEvent(g)}),u[tn])}function Ot(){A.call(this),this.i=new pe(this),this.M=this,this.F=null}Y(Ot,A),Ot.prototype[Me]=!0,Ot.prototype.removeEventListener=function(u,g,_,I){Ct(this,u,g,_,I)};function $t(u,g){var _,I=u.F;if(I)for(_=[];I;I=I.F)_.push(I);if(u=u.M,I=g.type||g,typeof g=="string")g=new W(g,u);else if(g instanceof W)g.target=g.target||u;else{var J=g;g=new W(I,u),O(g,J)}if(J=!0,_)for(var ne=_.length-1;0<=ne;ne--){var Ve=g.g=_[ne];J=On(Ve,I,!0,g)&&J}if(Ve=g.g=u,J=On(Ve,I,!0,g)&&J,J=On(Ve,I,!1,g)&&J,_)for(ne=0;ne<_.length;ne++)Ve=g.g=_[ne],J=On(Ve,I,!1,g)&&J}Ot.prototype.N=function(){if(Ot.aa.N.call(this),this.i){var u=this.i,g;for(g in u.g){for(var _=u.g[g],I=0;I<_.length;I++)Je(_[I]);delete u.g[g],u.h--}}this.F=null},Ot.prototype.K=function(u,g,_,I){return this.i.add(String(u),g,!1,_,I)},Ot.prototype.L=function(u,g,_,I){return this.i.add(String(u),g,!0,_,I)};function On(u,g,_,I){if(g=u.i.g[String(g)],!g)return!0;g=g.concat();for(var J=!0,ne=0;ne<g.length;++ne){var Ve=g[ne];if(Ve&&!Ve.da&&Ve.capture==_){var jt=Ve.listener,wn=Ve.ha||Ve.src;Ve.fa&&Be(u.i,Ve),J=jt.call(wn,I)!==!1&&J}}return J&&!I.defaultPrevented}function lr(u,g,_){if(typeof u=="function")_&&(u=b(u,_));else if(u&&typeof u.handleEvent=="function")u=b(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(g)?-1:f.setTimeout(u,g||0)}function In(u){u.g=lr(()=>{u.g=null,u.i&&(u.i=!1,In(u))},u.l);const g=u.h;u.h=null,u.m.apply(null,g)}class Fn extends A{constructor(g,_){super(),this.m=g,this.l=_,this.h=null,this.i=!1,this.g=null}j(g){this.h=arguments,this.g?this.i=!0:In(this)}N(){super.N(),this.g&&(f.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Qt(u){A.call(this),this.h=u,this.g={}}Y(Qt,A);var es=[];function Cn(u){Ee(u.g,function(g,_){this.g.hasOwnProperty(_)&&en(g)},u),u.g={}}Qt.prototype.N=function(){Qt.aa.N.call(this),Cn(this)},Qt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var gn=f.JSON.stringify,ts=f.JSON.parse,Ts=class{stringify(u){return f.JSON.stringify(u,void 0)}parse(u){return f.JSON.parse(u,void 0)}};function Pt(){}Pt.prototype.h=null;function pr(u){return u.h||(u.h=u.i())}function Ss(){}var Qn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Yn(){W.call(this,"d")}Y(Yn,W);function Cr(){W.call(this,"c")}Y(Cr,W);var Pn={},Pr=null;function Jn(){return Pr=Pr||new Ot}Pn.La="serverreachability";function Ws(u){W.call(this,Pn.La,u)}Y(Ws,W);function mr(u){const g=Jn();$t(g,new Ws(g))}Pn.STAT_EVENT="statevent";function Gs(u,g){W.call(this,Pn.STAT_EVENT,u),this.stat=g}Y(Gs,W);function rt(u){const g=Jn();$t(g,new Gs(g,u))}Pn.Ma="timingevent";function Xn(u,g){W.call(this,Pn.Ma,u),this.size=g}Y(Xn,W);function Nn(u,g){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return f.setTimeout(function(){u()},g)}function ns(){this.g=!0}ns.prototype.xa=function(){this.g=!1};function Rn(u,g,_,I,J,ne){u.info(function(){if(u.g)if(ne)for(var Ve="",jt=ne.split("&"),wn=0;wn<jt.length;wn++){var Et=jt[wn].split("=");if(1<Et.length){var kn=Et[0];Et=Et[1];var un=kn.split("_");Ve=2<=un.length&&un[1]=="type"?Ve+(kn+"="+Et+"&"):Ve+(kn+"=redacted&")}}else Ve=null;else Ve=ne;return"XMLHTTP REQ ("+I+") [attempt "+J+"]: "+g+`
`+_+`
`+Ve})}function yn(u,g,_,I,J,ne,Ve){u.info(function(){return"XMLHTTP RESP ("+I+") [ attempt "+J+"]: "+g+`
`+_+`
`+ne+" "+Ve})}function An(u,g,_,I){u.info(function(){return"XMLHTTP TEXT ("+g+"): "+Is(u,_)+(I?" "+I:"")})}function bs(u,g){u.info(function(){return"TIMEOUT: "+g})}ns.prototype.info=function(){};function Is(u,g){if(!u.g)return g;if(!g)return null;try{var _=JSON.parse(g);if(_){for(u=0;u<_.length;u++)if(Array.isArray(_[u])){var I=_[u];if(!(2>I.length)){var J=I[1];if(Array.isArray(J)&&!(1>J.length)){var ne=J[0];if(ne!="noop"&&ne!="stop"&&ne!="close")for(var Ve=1;Ve<J.length;Ve++)J[Ve]=""}}}}return gn(_)}catch{return g}}var Un={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Fr={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Ft;function rs(){}Y(rs,Pt),rs.prototype.g=function(){return new XMLHttpRequest},rs.prototype.i=function(){return{}},Ft=new rs;function cn(u,g,_,I){this.j=u,this.i=g,this.l=_,this.R=I||1,this.U=new Qt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Nr}function Nr(){this.i=null,this.g="",this.h=!1}var qs={},Ur={};function ss(u,g,_){u.L=1,u.v=Cs(Yt(g)),u.m=_,u.P=!0,vn(u,null)}function vn(u,g){u.F=Date.now(),dt(u),u.A=Yt(u.v);var _=u.A,I=u.R;Array.isArray(I)||(I=[String(I)]),Lt(_.i,"t",I),u.C=0,_=u.j.J,u.h=new Nr,u.g=xc(u.j,_?g:null,!u.m),0<u.O&&(u.M=new Fn(b(u.Y,u,u.g),u.O)),g=u.U,_=u.g,I=u.ca;var J="readystatechange";Array.isArray(J)||(J&&(es[0]=J.toString()),J=es);for(var ne=0;ne<J.length;ne++){var Ve=_t(_,J[ne],I||g.handleEvent,!1,g.h||g);if(!Ve)break;g.g[Ve.key]=Ve}g=u.H?N(u.H):{},u.m?(u.u||(u.u="POST"),g["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,g)):(u.u="GET",u.g.ea(u.A,u.u,null,g)),mr(),Rn(u.i,u.u,u.A,u.l,u.R,u.m)}cn.prototype.ca=function(u){u=u.target;const g=this.M;g&&gr(u)==3?g.j():this.Y(u)},cn.prototype.Y=function(u){try{if(u==this.g)e:{const un=gr(this.g);var g=this.g.Ba();const Br=this.g.Z();if(!(3>un)&&(un!=3||this.g&&(this.h.h||this.g.oa()||Zo(this.g)))){this.J||un!=4||g==7||(g==8||0>=Br?mr(3):mr(2)),jn(this);var _=this.g.Z();this.X=_;t:if(Hs(this)){var I=Zo(this.g);u="";var J=I.length,ne=gr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){B(this),w(this);var Ve="";break t}this.h.i=new f.TextDecoder}for(g=0;g<J;g++)this.h.h=!0,u+=this.h.i.decode(I[g],{stream:!(ne&&g==J-1)});I.length=0,this.h.g+=u,this.C=0,Ve=this.h.g}else Ve=this.g.oa();if(this.o=_==200,yn(this.i,this.u,this.A,this.l,this.R,un,_),this.o){if(this.T&&!this.K){t:{if(this.g){var jt,wn=this.g;if((jt=wn.g?wn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!be(jt)){var Et=jt;break t}}Et=null}if(_=Et)An(this.i,this.l,_,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,$(this,_);else{this.o=!1,this.s=3,rt(12),B(this),w(this);break e}}if(this.P){_=!0;let kr;for(;!this.J&&this.C<Ve.length;)if(kr=Ks(this,Ve),kr==Ur){un==4&&(this.s=4,rt(14),_=!1),An(this.i,this.l,null,"[Incomplete Response]");break}else if(kr==qs){this.s=4,rt(15),An(this.i,this.l,Ve,"[Invalid Chunk]"),_=!1;break}else An(this.i,this.l,kr,null),$(this,kr);if(Hs(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),un!=4||Ve.length!=0||this.h.h||(this.s=1,rt(16),_=!1),this.o=this.o&&_,!_)An(this.i,this.l,Ve,"[Invalid Chunked Response]"),B(this),w(this);else if(0<Ve.length&&!this.W){this.W=!0;var kn=this.j;kn.g==this&&kn.ba&&!kn.M&&(kn.j.info("Great, no buffering proxy detected. Bytes received: "+Ve.length),tl(kn),kn.M=!0,rt(11))}}else An(this.i,this.l,Ve,null),$(this,Ve);un==4&&B(this),this.o&&!this.J&&(un==4?Ya(this.j,this):(this.o=!1,dt(this)))}else Ga(this.g),_==400&&0<Ve.indexOf("Unknown SID")?(this.s=3,rt(12)):(this.s=0,rt(13)),B(this),w(this)}}}catch{}finally{}};function Hs(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function Ks(u,g){var _=u.C,I=g.indexOf(`
`,_);return I==-1?Ur:(_=Number(g.substring(_,I)),isNaN(_)?qs:(I+=1,I+_>g.length?Ur:(g=g.slice(I,I+_),u.C=I+_,g)))}cn.prototype.cancel=function(){this.J=!0,B(this)};function dt(u){u.S=Date.now()+u.I,is(u,u.I)}function is(u,g){if(u.B!=null)throw Error("WatchDog timer not null");u.B=Nn(b(u.ba,u),g)}function jn(u){u.B&&(f.clearTimeout(u.B),u.B=null)}cn.prototype.ba=function(){this.B=null;const u=Date.now();0<=u-this.S?(bs(this.i,this.A),this.L!=2&&(mr(),rt(17)),B(this),this.s=2,w(this)):is(this,this.S-u)};function w(u){u.j.G==0||u.J||Ya(u.j,u)}function B(u){jn(u);var g=u.M;g&&typeof g.ma=="function"&&g.ma(),u.M=null,Cn(u.U),u.g&&(g=u.g,u.g=null,g.abort(),g.ma())}function $(u,g){try{var _=u.j;if(_.G!=0&&(_.g==u||Ce(_.h,u))){if(!u.K&&Ce(_.h,u)&&_.G==3){try{var I=_.Da.g.parse(g)}catch{I=null}if(Array.isArray(I)&&I.length==3){var J=I;if(J[0]==0){e:if(!_.u){if(_.g)if(_.g.F+3e3<u.F)Qa(_),us(_);else break e;Ka(_),rt(18)}}else _.za=J[1],0<_.za-_.T&&37500>J[2]&&_.F&&_.v==0&&!_.C&&(_.C=Nn(b(_.Za,_),6e3));if(1>=se(_.h)&&_.ca){try{_.ca()}catch{}_.ca=void 0}}else Xs(_,11)}else if((u.K||_.g==u)&&Qa(_),!be(g))for(J=_.Da.g.parse(g),g=0;g<J.length;g++){let Et=J[g];if(_.T=Et[0],Et=Et[1],_.G==2)if(Et[0]=="c"){_.K=Et[1],_.ia=Et[2];const kn=Et[3];kn!=null&&(_.la=kn,_.j.info("VER="+_.la));const un=Et[4];un!=null&&(_.Aa=un,_.j.info("SVER="+_.Aa));const Br=Et[5];Br!=null&&typeof Br=="number"&&0<Br&&(I=1.5*Br,_.L=I,_.j.info("backChannelRequestTimeoutMs_="+I)),I=_;const kr=u.g;if(kr){const ha=kr.g?kr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ha){var ne=I.h;ne.g||ha.indexOf("spdy")==-1&&ha.indexOf("quic")==-1&&ha.indexOf("h2")==-1||(ne.j=ne.l,ne.g=new Set,ne.h&&(Pe(ne,ne.h),ne.h=null))}if(I.D){const Xa=kr.g?kr.g.getResponseHeader("X-HTTP-Session-Id"):null;Xa&&(I.ya=Xa,Rt(I.I,I.D,Xa))}}_.G=3,_.l&&_.l.ua(),_.ba&&(_.R=Date.now()-u.F,_.j.info("Handshake RTT: "+_.R+"ms")),I=_;var Ve=u;if(I.qa=_c(I,I.J?I.ia:null,I.W),Ve.K){ke(I.h,Ve);var jt=Ve,wn=I.L;wn&&(jt.I=wn),jt.B&&(jn(jt),dt(jt)),I.g=Ve}else da(I);0<_.i.length&&Rs(_)}else Et[0]!="stop"&&Et[0]!="close"||Xs(_,7);else _.G==3&&(Et[0]=="stop"||Et[0]=="close"?Et[0]=="stop"?Xs(_,7):Bn(_):Et[0]!="noop"&&_.l&&_.l.ta(Et),_.v=0)}}mr(4)}catch{}}var L=class{constructor(u,g){this.g=u,this.map=g}};function q(u){this.l=u||10,f.PerformanceNavigationTiming?(u=f.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(f.chrome&&f.chrome.loadTimes&&f.chrome.loadTimes()&&f.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function oe(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function se(u){return u.h?1:u.g?u.g.size:0}function Ce(u,g){return u.h?u.h==g:u.g?u.g.has(g):!1}function Pe(u,g){u.g?u.g.add(g):u.h=g}function ke(u,g){u.h&&u.h==g?u.h=null:u.g&&u.g.has(g)&&u.g.delete(g)}q.prototype.cancel=function(){if(this.i=le(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function le(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let g=u.i;for(const _ of u.g.values())g=g.concat(_.D);return g}return z(u.i)}function ot(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(m(u)){for(var g=[],_=u.length,I=0;I<_;I++)g.push(u[I]);return g}g=[],_=0;for(I in u)g[_++]=u[I];return g}function Le(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(m(u)||typeof u=="string"){var g=[];u=u.length;for(var _=0;_<u;_++)g.push(_);return g}g=[],_=0;for(const I in u)g[_++]=I;return g}}}function ht(u,g){if(u.forEach&&typeof u.forEach=="function")u.forEach(g,void 0);else if(m(u)||typeof u=="string")Array.prototype.forEach.call(u,g,void 0);else for(var _=Le(u),I=ot(u),J=I.length,ne=0;ne<J;ne++)g.call(void 0,I[ne],_&&_[ne],u)}var cr=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Qs(u,g){if(u){u=u.split("&");for(var _=0;_<u.length;_++){var I=u[_].indexOf("="),J=null;if(0<=I){var ne=u[_].substring(0,I);J=u[_].substring(I+1)}else ne=u[_];g(ne,J?decodeURIComponent(J.replace(/\+/g," ")):"")}}}function _n(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof _n){this.h=u.h,as(this,u.j),this.o=u.o,this.g=u.g,os(this,u.s),this.l=u.l;var g=u.i,_=new Ne;_.i=g.i,g.g&&(_.g=new Map(g.g),_.h=g.h),ls(this,_),this.m=u.m}else u&&(g=String(u).match(cr))?(this.h=!1,as(this,g[1]||"",!0),this.o=pt(g[2]||""),this.g=pt(g[3]||"",!0),os(this,g[4]),this.l=pt(g[5]||"",!0),ls(this,g[6]||"",!0),this.m=pt(g[7]||"")):(this.h=!1,this.i=new Ne(null,this.h))}_n.prototype.toString=function(){var u=[],g=this.j;g&&u.push(Ps(g,F,!0),":");var _=this.g;return(_||g=="file")&&(u.push("//"),(g=this.o)&&u.push(Ps(g,F,!0),"@"),u.push(encodeURIComponent(String(_)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_=this.s,_!=null&&u.push(":",String(_))),(_=this.l)&&(this.g&&_.charAt(0)!="/"&&u.push("/"),u.push(Ps(_,_.charAt(0)=="/"?ue:Q,!0))),(_=this.i.toString())&&u.push("?",_),(_=this.m)&&u.push("#",Ps(_,qe)),u.join("")};function Yt(u){return new _n(u)}function as(u,g,_){u.j=_?pt(g,!0):g,u.j&&(u.j=u.j.replace(/:$/,""))}function os(u,g){if(g){if(g=Number(g),isNaN(g)||0>g)throw Error("Bad port number "+g);u.s=g}else u.s=null}function ls(u,g,_){g instanceof Ne?(u.i=g,nn(u.i,u.h)):(_||(g=Ps(g,Te)),u.i=new Ne(g,u.h))}function Rt(u,g,_){u.i.set(g,_)}function Cs(u){return Rt(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function pt(u,g){return u?g?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function Ps(u,g,_){return typeof u=="string"?(u=encodeURI(u).replace(g,T),_&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function T(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var F=/[#\/\?@]/g,Q=/[#\?:]/g,ue=/[#\?]/g,Te=/[#\?@]/g,qe=/#/g;function Ne(u,g){this.h=this.g=null,this.i=u||null,this.j=!!g}function Xe(u){u.g||(u.g=new Map,u.h=0,u.i&&Qs(u.i,function(g,_){u.add(decodeURIComponent(g.replace(/\+/g," ")),_)}))}n=Ne.prototype,n.add=function(u,g){Xe(this),this.i=null,u=St(this,u);var _=this.g.get(u);return _||this.g.set(u,_=[]),_.push(g),this.h+=1,this};function ut(u,g){Xe(u),g=St(u,g),u.g.has(g)&&(u.i=null,u.h-=u.g.get(g).length,u.g.delete(g))}function gt(u,g){return Xe(u),g=St(u,g),u.g.has(g)}n.forEach=function(u,g){Xe(this),this.g.forEach(function(_,I){_.forEach(function(J){u.call(g,J,I,this)},this)},this)},n.na=function(){Xe(this);const u=Array.from(this.g.values()),g=Array.from(this.g.keys()),_=[];for(let I=0;I<g.length;I++){const J=u[I];for(let ne=0;ne<J.length;ne++)_.push(g[I])}return _},n.V=function(u){Xe(this);let g=[];if(typeof u=="string")gt(this,u)&&(g=g.concat(this.g.get(St(this,u))));else{u=Array.from(this.g.values());for(let _=0;_<u.length;_++)g=g.concat(u[_])}return g},n.set=function(u,g){return Xe(this),this.i=null,u=St(this,u),gt(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[g]),this.h+=1,this},n.get=function(u,g){return u?(u=this.V(u),0<u.length?String(u[0]):g):g};function Lt(u,g,_){ut(u,g),0<_.length&&(u.i=null,u.g.set(St(u,g),z(_)),u.h+=_.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],g=Array.from(this.g.keys());for(var _=0;_<g.length;_++){var I=g[_];const ne=encodeURIComponent(String(I)),Ve=this.V(I);for(I=0;I<Ve.length;I++){var J=ne;Ve[I]!==""&&(J+="="+encodeURIComponent(String(Ve[I]))),u.push(J)}}return this.i=u.join("&")};function St(u,g){return g=String(g),u.j&&(g=g.toLowerCase()),g}function nn(u,g){g&&!u.j&&(Xe(u),u.i=null,u.g.forEach(function(_,I){var J=I.toLowerCase();I!=J&&(ut(this,I),Lt(this,J,_))},u)),u.j=g}function xn(u,g){const _=new ns;if(f.Image){const I=new Image;I.onload=M(rn,_,"TestLoadImage: loaded",!0,g,I),I.onerror=M(rn,_,"TestLoadImage: error",!1,g,I),I.onabort=M(rn,_,"TestLoadImage: abort",!1,g,I),I.ontimeout=M(rn,_,"TestLoadImage: timeout",!1,g,I),f.setTimeout(function(){I.ontimeout&&I.ontimeout()},1e4),I.src=u}else g(!1)}function wt(u,g){const _=new ns,I=new AbortController,J=setTimeout(()=>{I.abort(),rn(_,"TestPingServer: timeout",!1,g)},1e4);fetch(u,{signal:I.signal}).then(ne=>{clearTimeout(J),ne.ok?rn(_,"TestPingServer: ok",!0,g):rn(_,"TestPingServer: server error",!1,g)}).catch(()=>{clearTimeout(J),rn(_,"TestPingServer: error",!1,g)})}function rn(u,g,_,I,J){try{J&&(J.onload=null,J.onerror=null,J.onabort=null,J.ontimeout=null),I(_)}catch{}}function Zn(){this.g=new Ts}function zr(u,g,_){const I=_||"";try{ht(u,function(J,ne){let Ve=J;v(J)&&(Ve=gn(J)),g.push(I+ne+"="+encodeURIComponent(Ve))})}catch(J){throw g.push(I+"type="+encodeURIComponent("_badmap")),J}}function Rr(u){this.l=u.Ub||null,this.j=u.eb||!1}Y(Rr,Pt),Rr.prototype.g=function(){return new Ys(this.l,this.j)},Rr.prototype.i=(function(u){return function(){return u}})({});function Ys(u,g){Ot.call(this),this.D=u,this.o=g,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}Y(Ys,Ot),n=Ys.prototype,n.open=function(u,g){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=g,this.readyState=1,zn(this)},n.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const g={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(g.body=u),(this.D||f).fetch(new Request(this.A,g)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ar(this)),this.readyState=0},n.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,zn(this)),this.g&&(this.readyState=3,zn(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof f.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Ba(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function Ba(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}n.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var g=u.value?u.value:new Uint8Array(0);(g=this.v.decode(g,{stream:!u.done}))&&(this.response=this.responseText+=g)}u.done?Ar(this):zn(this),this.readyState==3&&Ba(this)}},n.Ra=function(u){this.g&&(this.response=this.responseText=u,Ar(this))},n.Qa=function(u){this.g&&(this.response=u,Ar(this))},n.ga=function(){this.g&&Ar(this)};function Ar(u){u.readyState=4,u.l=null,u.j=null,u.v=null,zn(u)}n.setRequestHeader=function(u,g){this.u.append(u,g)},n.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],g=this.h.entries();for(var _=g.next();!_.done;)_=_.value,u.push(_[0]+": "+_[1]),_=g.next();return u.join(`\r
`)};function zn(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(Ys.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function cs(u){let g="";return Ee(u,function(_,I){g+=I,g+=":",g+=_,g+=`\r
`}),g}function wi(u,g,_){e:{for(I in _){var I=!1;break e}I=!0}I||(_=cs(_),typeof u=="string"?_!=null&&encodeURIComponent(String(_)):Rt(u,g,_))}function Wt(u){Ot.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}Y(Wt,Ot);var Ad=/^https?$/i,Jo=["POST","PUT"];n=Wt.prototype,n.Ha=function(u){this.J=u},n.ea=function(u,g,_,I){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);g=g?g.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ft.g(),this.v=this.o?pr(this.o):pr(Ft),this.g.onreadystatechange=b(this.Ea,this);try{this.B=!0,this.g.open(g,String(u),!0),this.B=!1}catch(ne){ua(this,ne);return}if(u=_||"",_=new Map(this.headers),I)if(Object.getPrototypeOf(I)===Object.prototype)for(var J in I)_.set(J,I[J]);else if(typeof I.keys=="function"&&typeof I.get=="function")for(const ne of I.keys())_.set(ne,I.get(ne));else throw Error("Unknown input type for opt_headers: "+String(I));I=Array.from(_.keys()).find(ne=>ne.toLowerCase()=="content-type"),J=f.FormData&&u instanceof f.FormData,!(0<=Array.prototype.indexOf.call(Jo,g,void 0))||I||J||_.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ne,Ve]of _)this.g.setRequestHeader(ne,Ve);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Wa(this),this.u=!0,this.g.send(u),this.u=!1}catch(ne){ua(this,ne)}};function ua(u,g){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=g,u.m=5,$a(u),jr(u)}function $a(u){u.A||(u.A=!0,$t(u,"complete"),$t(u,"error"))}n.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,$t(this,"complete"),$t(this,"abort"),jr(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),jr(this,!0)),Wt.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Xo(this):this.bb())},n.bb=function(){Xo(this)};function Xo(u){if(u.h&&typeof d<"u"&&(!u.v[1]||gr(u)!=4||u.Z()!=2)){if(u.u&&gr(u)==4)lr(u.Ea,0,u);else if($t(u,"readystatechange"),gr(u)==4){u.h=!1;try{const Ve=u.Z();e:switch(Ve){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var g=!0;break e;default:g=!1}var _;if(!(_=g)){var I;if(I=Ve===0){var J=String(u.D).match(cr)[1]||null;!J&&f.self&&f.self.location&&(J=f.self.location.protocol.slice(0,-1)),I=!Ad.test(J?J.toLowerCase():"")}_=I}if(_)$t(u,"complete"),$t(u,"success");else{u.m=6;try{var ne=2<gr(u)?u.g.statusText:""}catch{ne=""}u.l=ne+" ["+u.Z()+"]",$a(u)}}finally{jr(u)}}}}function jr(u,g){if(u.g){Wa(u);const _=u.g,I=u.v[0]?()=>{}:null;u.g=null,u.v=null,g||$t(u,"ready");try{_.onreadystatechange=I}catch{}}}function Wa(u){u.I&&(f.clearTimeout(u.I),u.I=null)}n.isActive=function(){return!!this.g};function gr(u){return u.g?u.g.readyState:0}n.Z=function(){try{return 2<gr(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(u){if(this.g){var g=this.g.responseText;return u&&g.indexOf(u)==0&&(g=g.substring(u.length)),ts(g)}};function Zo(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function Ga(u){const g={};u=(u.g&&2<=gr(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let I=0;I<u.length;I++){if(be(u[I]))continue;var _=G(u[I]);const J=_[0];if(_=_[1],typeof _!="string")continue;_=_.trim();const ne=g[J]||[];g[J]=ne,ne.push(_)}D(g,function(I){return I.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ns(u,g,_){return _&&_.internalChannelParams&&_.internalChannelParams[u]||g}function el(u){this.Aa=0,this.i=[],this.j=new ns,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ns("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ns("baseRetryDelayMs",5e3,u),this.cb=Ns("retryDelaySeedMs",1e4,u),this.Wa=Ns("forwardChannelMaxRetries",2,u),this.wa=Ns("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new q(u&&u.concurrentRequestLimit),this.Da=new Zn,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=el.prototype,n.la=8,n.G=1,n.connect=function(u,g,_,I){rt(0),this.W=u,this.H=g||{},_&&I!==void 0&&(this.H.OSID=_,this.H.OAID=I),this.F=this.X,this.I=_c(this,null,this.W),Rs(this)};function Bn(u){if(qa(u),u.G==3){var g=u.U++,_=Yt(u.I);if(Rt(_,"SID",u.K),Rt(_,"RID",g),Rt(_,"TYPE","terminate"),Js(u,_),g=new cn(u,u.j,g),g.L=2,g.v=Cs(Yt(_)),_=!1,f.navigator&&f.navigator.sendBeacon)try{_=f.navigator.sendBeacon(g.v.toString(),"")}catch{}!_&&f.Image&&(new Image().src=g.v,_=!0),_||(g.g=xc(g.j,null),g.g.ea(g.v)),g.F=Date.now(),dt(g)}vc(u)}function us(u){u.g&&(tl(u),u.g.cancel(),u.g=null)}function qa(u){us(u),u.u&&(f.clearTimeout(u.u),u.u=null),Qa(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&f.clearTimeout(u.s),u.s=null)}function Rs(u){if(!oe(u.h)&&!u.s){u.s=!0;var g=u.Ga;ce||xe(),re||(ce(),re=!0),Ie.add(g,u),u.B=0}}function jd(u,g){return se(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=g.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=Nn(b(u.Ga,u,g),yc(u,u.B)),u.B++,!0)}n.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;const J=new cn(this,this.j,u);let ne=this.o;if(this.S&&(ne?(ne=N(ne),O(ne,this.S)):ne=this.S),this.m!==null||this.O||(J.H=ne,ne=null),this.P)e:{for(var g=0,_=0;_<this.i.length;_++){t:{var I=this.i[_];if("__data__"in I.map&&(I=I.map.__data__,typeof I=="string")){I=I.length;break t}I=void 0}if(I===void 0)break;if(g+=I,4096<g){g=_;break e}if(g===4096||_===this.i.length-1){g=_+1;break e}}g=1e3}else g=1e3;g=Ei(this,J,g),_=Yt(this.I),Rt(_,"RID",u),Rt(_,"CVER",22),this.D&&Rt(_,"X-HTTP-Session-Id",this.D),Js(this,_),ne&&(this.O?g="headers="+encodeURIComponent(String(cs(ne)))+"&"+g:this.m&&wi(_,this.m,ne)),Pe(this.h,J),this.Ua&&Rt(_,"TYPE","init"),this.P?(Rt(_,"$req",g),Rt(_,"SID","null"),J.T=!0,ss(J,_,null)):ss(J,_,g),this.G=2}}else this.G==3&&(u?Ha(this,u):this.i.length==0||oe(this.h)||Ha(this))};function Ha(u,g){var _;g?_=g.l:_=u.U++;const I=Yt(u.I);Rt(I,"SID",u.K),Rt(I,"RID",_),Rt(I,"AID",u.T),Js(u,I),u.m&&u.o&&wi(I,u.m,u.o),_=new cn(u,u.j,_,u.B+1),u.m===null&&(_.H=u.o),g&&(u.i=g.D.concat(u.i)),g=Ei(u,_,1e3),_.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),Pe(u.h,_),ss(_,I,g)}function Js(u,g){u.H&&Ee(u.H,function(_,I){Rt(g,I,_)}),u.l&&ht({},function(_,I){Rt(g,I,_)})}function Ei(u,g,_){_=Math.min(u.i.length,_);var I=u.l?b(u.l.Na,u.l,u):null;e:{var J=u.i;let ne=-1;for(;;){const Ve=["count="+_];ne==-1?0<_?(ne=J[0].g,Ve.push("ofs="+ne)):ne=0:Ve.push("ofs="+ne);let jt=!0;for(let wn=0;wn<_;wn++){let Et=J[wn].g;const kn=J[wn].map;if(Et-=ne,0>Et)ne=Math.max(0,J[wn].g-100),jt=!1;else try{zr(kn,Ve,"req"+Et+"_")}catch{I&&I(kn)}}if(jt){I=Ve.join("&");break e}}}return u=u.i.splice(0,_),g.D=u,I}function da(u){if(!u.g&&!u.u){u.Y=1;var g=u.Fa;ce||xe(),re||(ce(),re=!0),Ie.add(g,u),u.v=0}}function Ka(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=Nn(b(u.Fa,u),yc(u,u.v)),u.v++,!0)}n.Fa=function(){if(this.u=null,gc(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=Nn(b(this.ab,this),u)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,rt(10),us(this),gc(this))};function tl(u){u.A!=null&&(f.clearTimeout(u.A),u.A=null)}function gc(u){u.g=new cn(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var g=Yt(u.qa);Rt(g,"RID","rpc"),Rt(g,"SID",u.K),Rt(g,"AID",u.T),Rt(g,"CI",u.F?"0":"1"),!u.F&&u.ja&&Rt(g,"TO",u.ja),Rt(g,"TYPE","xmlhttp"),Js(u,g),u.m&&u.o&&wi(g,u.m,u.o),u.L&&(u.g.I=u.L);var _=u.g;u=u.ia,_.L=1,_.v=Cs(Yt(g)),_.m=null,_.P=!0,vn(_,u)}n.Za=function(){this.C!=null&&(this.C=null,us(this),Ka(this),rt(19))};function Qa(u){u.C!=null&&(f.clearTimeout(u.C),u.C=null)}function Ya(u,g){var _=null;if(u.g==g){Qa(u),tl(u),u.g=null;var I=2}else if(Ce(u.h,g))_=g.D,ke(u.h,g),I=1;else return;if(u.G!=0){if(g.o)if(I==1){_=g.m?g.m.length:0,g=Date.now()-g.F;var J=u.B;I=Jn(),$t(I,new Xn(I,_)),Rs(u)}else da(u);else if(J=g.s,J==3||J==0&&0<g.X||!(I==1&&jd(u,g)||I==2&&Ka(u)))switch(_&&0<_.length&&(g=u.h,g.i=g.i.concat(_)),J){case 1:Xs(u,5);break;case 4:Xs(u,10);break;case 3:Xs(u,6);break;default:Xs(u,2)}}}function yc(u,g){let _=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(_*=2),_*g}function Xs(u,g){if(u.j.info("Error code "+g),g==2){var _=b(u.fb,u),I=u.Xa;const J=!I;I=new _n(I||"//www.google.com/images/cleardot.gif"),f.location&&f.location.protocol=="http"||as(I,"https"),Cs(I),J?xn(I.toString(),_):wt(I.toString(),_)}else rt(2);u.G=0,u.l&&u.l.sa(g),vc(u),qa(u)}n.fb=function(u){u?(this.j.info("Successfully pinged google.com"),rt(2)):(this.j.info("Failed to ping google.com"),rt(1))};function vc(u){if(u.G=0,u.ka=[],u.l){const g=le(u.h);(g.length!=0||u.i.length!=0)&&(V(u.ka,g),V(u.ka,u.i),u.h.i.length=0,z(u.i),u.i.length=0),u.l.ra()}}function _c(u,g,_){var I=_ instanceof _n?Yt(_):new _n(_);if(I.g!="")g&&(I.g=g+"."+I.g),os(I,I.s);else{var J=f.location;I=J.protocol,g=g?g+"."+J.hostname:J.hostname,J=+J.port;var ne=new _n(null);I&&as(ne,I),g&&(ne.g=g),J&&os(ne,J),_&&(ne.l=_),I=ne}return _=u.D,g=u.ya,_&&g&&Rt(I,_,g),Rt(I,"VER",u.la),Js(u,I),I}function xc(u,g,_){if(g&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return g=u.Ca&&!u.pa?new Wt(new Rr({eb:_})):new Wt(u.pa),g.Ha(u.J),g}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function nl(){}n=nl.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Ja(){}Ja.prototype.g=function(u,g){return new ur(u,g)};function ur(u,g){Ot.call(this),this.g=new el(g),this.l=u,this.h=g&&g.messageUrlParams||null,u=g&&g.messageHeaders||null,g&&g.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=g&&g.initMessageHeaders||null,g&&g.messageContentType&&(u?u["X-WebChannel-Content-Type"]=g.messageContentType:u={"X-WebChannel-Content-Type":g.messageContentType}),g&&g.va&&(u?u["X-WebChannel-Client-Profile"]=g.va:u={"X-WebChannel-Client-Profile":g.va}),this.g.S=u,(u=g&&g.Sb)&&!be(u)&&(this.g.m=u),this.v=g&&g.supportsCrossDomainXhr||!1,this.u=g&&g.sendRawJson||!1,(g=g&&g.httpSessionIdParam)&&!be(g)&&(this.g.D=g,u=this.h,u!==null&&g in u&&(u=this.h,g in u&&delete u[g])),this.j=new As(this)}Y(ur,Ot),ur.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},ur.prototype.close=function(){Bn(this.g)},ur.prototype.o=function(u){var g=this.g;if(typeof u=="string"){var _={};_.__data__=u,u=_}else this.u&&(_={},_.__data__=gn(u),u=_);g.i.push(new L(g.Ya++,u)),g.G==3&&Rs(g)},ur.prototype.N=function(){this.g.l=null,delete this.j,Bn(this.g),delete this.g,ur.aa.N.call(this)};function wc(u){Yn.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var g=u.__sm__;if(g){e:{for(const _ in g){u=_;break e}u=void 0}(this.i=u)&&(u=this.i,g=g!==null&&u in g?g[u]:void 0),this.data=g}else this.data=u}Y(wc,Yn);function Ec(){Cr.call(this),this.status=1}Y(Ec,Cr);function As(u){this.g=u}Y(As,nl),As.prototype.ua=function(){$t(this.g,"a")},As.prototype.ta=function(u){$t(this.g,new wc(u))},As.prototype.sa=function(u){$t(this.g,new Ec)},As.prototype.ra=function(){$t(this.g,"b")},Ja.prototype.createWebChannel=Ja.prototype.g,ur.prototype.send=ur.prototype.o,ur.prototype.open=ur.prototype.m,ur.prototype.close=ur.prototype.close,O0=function(){return new Ja},M0=function(){return Jn()},V0=Pn,kf={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Un.NO_ERROR=0,Un.TIMEOUT=8,Un.HTTP_ERROR=6,Pu=Un,Fr.COMPLETE="complete",L0=Fr,Ss.EventType=Qn,Qn.OPEN="a",Qn.CLOSE="b",Qn.ERROR="c",Qn.MESSAGE="d",Ot.prototype.listen=Ot.prototype.K,Al=Ss,Wt.prototype.listenOnce=Wt.prototype.L,Wt.prototype.getLastError=Wt.prototype.Ka,Wt.prototype.getLastErrorCode=Wt.prototype.Ba,Wt.prototype.getStatus=Wt.prototype.Z,Wt.prototype.getResponseJson=Wt.prototype.Oa,Wt.prototype.getResponseText=Wt.prototype.oa,Wt.prototype.send=Wt.prototype.ea,Wt.prototype.setWithCredentials=Wt.prototype.Ha,D0=Wt}).apply(typeof yu<"u"?yu:typeof self<"u"?self:typeof window<"u"?window:{});const ov="@firebase/firestore",lv="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ir{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ir.UNAUTHENTICATED=new ir(null),ir.GOOGLE_CREDENTIALS=new ir("google-credentials-uid"),ir.FIRST_PARTY=new ir("first-party-uid"),ir.MOCK_USER=new ir("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let qo="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ma=new ip("@firebase/firestore");function To(){return Ma.logLevel}function Ue(n,...e){if(Ma.logLevel<=yt.DEBUG){const t=e.map(_p);Ma.debug(`Firestore (${qo}): ${n}`,...t)}}function mi(n,...e){if(Ma.logLevel<=yt.ERROR){const t=e.map(_p);Ma.error(`Firestore (${qo}): ${n}`,...t)}}function Ji(n,...e){if(Ma.logLevel<=yt.WARN){const t=e.map(_p);Ma.warn(`Firestore (${qo}): ${n}`,...t)}}function _p(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function st(n,e,t){let s="Unexpected state";typeof e=="string"?s=e:t=e,F0(n,s,t)}function F0(n,e,t){let s=`FIRESTORE (${qo}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{s+=" CONTEXT: "+JSON.stringify(t)}catch{s+=" CONTEXT: "+t}throw mi(s),new Error(s)}function At(n,e,t,s){let a="Unexpected state";typeof t=="string"?a=t:s=t,n||F0(e,a,s)}function ct(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const de={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Oe extends _i{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class di{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U0{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class VI{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(ir.UNAUTHENTICATED)))}shutdown(){}}class MI{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class OI{constructor(e){this.t=e,this.currentUser=ir.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){At(this.o===void 0,42304);let s=this.i;const a=m=>this.i!==s?(s=this.i,t(m)):Promise.resolve();let c=new di;this.o=()=>{this.i++,this.currentUser=this.u(),c.resolve(),c=new di,e.enqueueRetryable((()=>a(this.currentUser)))};const d=()=>{const m=c;e.enqueueRetryable((async()=>{await m.promise,await a(this.currentUser)}))},f=m=>{Ue("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=m,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit((m=>f(m))),setTimeout((()=>{if(!this.auth){const m=this.t.getImmediate({optional:!0});m?f(m):(Ue("FirebaseAuthCredentialsProvider","Auth not yet detected"),c.resolve(),c=new di)}}),0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((s=>this.i!==e?(Ue("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(At(typeof s.accessToken=="string",31837,{l:s}),new U0(s.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return At(e===null||typeof e=="string",2055,{h:e}),new ir(e)}}class FI{constructor(e,t,s){this.P=e,this.T=t,this.I=s,this.type="FirstParty",this.user=ir.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class UI{constructor(e,t,s){this.P=e,this.T=t,this.I=s}getToken(){return Promise.resolve(new FI(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(ir.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class cv{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class zI{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Mr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){At(this.o===void 0,3512);const s=c=>{c.error!=null&&Ue("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${c.error.message}`);const d=c.token!==this.m;return this.m=c.token,Ue("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?t(c.token):Promise.resolve()};this.o=c=>{e.enqueueRetryable((()=>s(c)))};const a=c=>{Ue("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=c,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((c=>a(c))),setTimeout((()=>{if(!this.appCheck){const c=this.V.getImmediate({optional:!0});c?a(c):Ue("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new cv(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(At(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new cv(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BI(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let s=0;s<n;s++)t[s]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z0(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xp{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let s="";for(;s.length<20;){const a=BI(40);for(let c=0;c<a.length;++c)s.length<20&&a[c]<t&&(s+=e.charAt(a[c]%62))}return s}}function ft(n,e){return n<e?-1:n>e?1:0}function Df(n,e){let t=0;for(;t<n.length&&t<e.length;){const s=n.codePointAt(t),a=e.codePointAt(t);if(s!==a){if(s<128&&a<128)return ft(s,a);{const c=z0(),d=$I(c.encode(uv(n,t)),c.encode(uv(e,t)));return d!==0?d:ft(s,a)}}t+=s>65535?2:1}return ft(n.length,e.length)}function uv(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function $I(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return ft(n[t],e[t]);return ft(n.length,e.length)}function Do(n,e,t){return n.length===e.length&&n.every(((s,a)=>t(s,e[a])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dv="__name__";class Vs{constructor(e,t,s){t===void 0?t=0:t>e.length&&st(637,{offset:t,range:e.length}),s===void 0?s=e.length-t:s>e.length-t&&st(1746,{length:s,range:e.length-t}),this.segments=e,this.offset=t,this.len=s}get length(){return this.len}isEqual(e){return Vs.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Vs?e.forEach((s=>{t.push(s)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,s=this.limit();t<s;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const s=Math.min(e.length,t.length);for(let a=0;a<s;a++){const c=Vs.compareSegments(e.get(a),t.get(a));if(c!==0)return c}return ft(e.length,t.length)}static compareSegments(e,t){const s=Vs.isNumericId(e),a=Vs.isNumericId(t);return s&&!a?-1:!s&&a?1:s&&a?Vs.extractNumericId(e).compare(Vs.extractNumericId(t)):Df(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Qi.fromString(e.substring(4,e.length-2))}}class Mt extends Vs{construct(e,t,s){return new Mt(e,t,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const s of e){if(s.indexOf("//")>=0)throw new Oe(de.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);t.push(...s.split("/").filter((a=>a.length>0)))}return new Mt(t)}static emptyPath(){return new Mt([])}}const WI=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class qn extends Vs{construct(e,t,s){return new qn(e,t,s)}static isValidIdentifier(e){return WI.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),qn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===dv}static keyField(){return new qn([dv])}static fromServerFormat(e){const t=[];let s="",a=0;const c=()=>{if(s.length===0)throw new Oe(de.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(s),s=""};let d=!1;for(;a<e.length;){const f=e[a];if(f==="\\"){if(a+1===e.length)throw new Oe(de.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const m=e[a+1];if(m!=="\\"&&m!=="."&&m!=="`")throw new Oe(de.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=m,a+=2}else f==="`"?(d=!d,a++):f!=="."||d?(s+=f,a++):(c(),a++)}if(c(),d)throw new Oe(de.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new qn(t)}static emptyPath(){return new qn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ze{constructor(e){this.path=e}static fromPath(e){return new Ze(Mt.fromString(e))}static fromName(e){return new Ze(Mt.fromString(e).popFirst(5))}static empty(){return new Ze(Mt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Mt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Mt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ze(new Mt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B0(n,e,t){if(!t)throw new Oe(de.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function GI(n,e,t,s){if(e===!0&&s===!0)throw new Oe(de.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function hv(n){if(!Ze.isDocumentKey(n))throw new Oe(de.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function fv(n){if(Ze.isDocumentKey(n))throw new Oe(de.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function $0(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function ld(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(s){return s.constructor?s.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":st(12329,{type:typeof n})}function Ir(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Oe(de.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=ld(n);throw new Oe(de.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pn(n,e){const t={typeString:n};return e&&(t.value=e),t}function oc(n,e){if(!$0(n))throw new Oe(de.INVALID_ARGUMENT,"JSON must be an object");let t;for(const s in e)if(e[s]){const a=e[s].typeString,c="value"in e[s]?{value:e[s].value}:void 0;if(!(s in n)){t=`JSON missing required field: '${s}'`;break}const d=n[s];if(a&&typeof d!==a){t=`JSON field '${s}' must be a ${a}.`;break}if(c!==void 0&&d!==c.value){t=`Expected '${s}' field to equal '${c.value}'`;break}}if(t)throw new Oe(de.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pv=-62135596800,mv=1e6;class Bt{static now(){return Bt.fromMillis(Date.now())}static fromDate(e){return Bt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),s=Math.floor((e-1e3*t)*mv);return new Bt(t,s)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Oe(de.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Oe(de.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<pv)throw new Oe(de.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Oe(de.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/mv}_compareTo(e){return this.seconds===e.seconds?ft(this.nanoseconds,e.nanoseconds):ft(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Bt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(oc(e,Bt._jsonSchema))return new Bt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-pv;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Bt._jsonSchemaVersion="firestore/timestamp/1.0",Bt._jsonSchema={type:pn("string",Bt._jsonSchemaVersion),seconds:pn("number"),nanoseconds:pn("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lt{static fromTimestamp(e){return new lt(e)}static min(){return new lt(new Bt(0,0))}static max(){return new lt(new Bt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hl=-1;function qI(n,e){const t=n.toTimestamp().seconds,s=n.toTimestamp().nanoseconds+1,a=lt.fromTimestamp(s===1e9?new Bt(t+1,0):new Bt(t,s));return new Xi(a,Ze.empty(),e)}function HI(n){return new Xi(n.readTime,n.key,Hl)}class Xi{constructor(e,t,s){this.readTime=e,this.documentKey=t,this.largestBatchId=s}static min(){return new Xi(lt.min(),Ze.empty(),Hl)}static max(){return new Xi(lt.max(),Ze.empty(),Hl)}}function KI(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Ze.comparator(n.documentKey,e.documentKey),t!==0?t:ft(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QI="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class YI{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ho(n){if(n.code!==de.FAILED_PRECONDITION||n.message!==QI)throw n;Ue("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&st(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new fe(((s,a)=>{this.nextCallback=c=>{this.wrapSuccess(e,c).next(s,a)},this.catchCallback=c=>{this.wrapFailure(t,c).next(s,a)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof fe?t:fe.resolve(t)}catch(t){return fe.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):fe.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):fe.reject(t)}static resolve(e){return new fe(((t,s)=>{t(e)}))}static reject(e){return new fe(((t,s)=>{s(e)}))}static waitFor(e){return new fe(((t,s)=>{let a=0,c=0,d=!1;e.forEach((f=>{++a,f.next((()=>{++c,d&&c===a&&t()}),(m=>s(m)))})),d=!0,c===a&&t()}))}static or(e){let t=fe.resolve(!1);for(const s of e)t=t.next((a=>a?fe.resolve(a):s()));return t}static forEach(e,t){const s=[];return e.forEach(((a,c)=>{s.push(t.call(this,a,c))})),this.waitFor(s)}static mapArray(e,t){return new fe(((s,a)=>{const c=e.length,d=new Array(c);let f=0;for(let m=0;m<c;m++){const v=m;t(e[v]).next((x=>{d[v]=x,++f,f===c&&s(d)}),(x=>a(x)))}}))}static doWhile(e,t){return new fe(((s,a)=>{const c=()=>{e()===!0?t().next((()=>{c()}),a):s()};c()}))}}function JI(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Ko(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cd{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=s=>this._e(s),this.ae=s=>t.writeSequenceNumber(s))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}}cd.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wp=-1;function ud(n){return n==null}function Wu(n){return n===0&&1/n==-1/0}function XI(n){return typeof n=="number"&&Number.isInteger(n)&&!Wu(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W0="";function ZI(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=gv(e)),e=eC(n.get(t),e);return gv(e)}function eC(n,e){let t=e;const s=n.length;for(let a=0;a<s;a++){const c=n.charAt(a);switch(c){case"\0":t+="";break;case W0:t+="";break;default:t+=c}}return t}function gv(n){return n+W0+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yv(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function la(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function G0(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kt{constructor(e,t){this.comparator=e,this.root=t||Gn.EMPTY}insert(e,t){return new Kt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Gn.BLACK,null,null))}remove(e){return new Kt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Gn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const s=this.comparator(e,t.key);if(s===0)return t.value;s<0?t=t.left:s>0&&(t=t.right)}return null}indexOf(e){let t=0,s=this.root;for(;!s.isEmpty();){const a=this.comparator(e,s.key);if(a===0)return t+s.left.size;a<0?s=s.left:(t+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,s)=>(e(t,s),!1)))}toString(){const e=[];return this.inorderTraversal(((t,s)=>(e.push(`${t}:${s}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new vu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new vu(this.root,e,this.comparator,!1)}getReverseIterator(){return new vu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new vu(this.root,e,this.comparator,!0)}}class vu{constructor(e,t,s,a){this.isReverse=a,this.nodeStack=[];let c=1;for(;!e.isEmpty();)if(c=t?s(e.key,t):1,t&&a&&(c*=-1),c<0)e=this.isReverse?e.left:e.right;else{if(c===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Gn{constructor(e,t,s,a,c){this.key=e,this.value=t,this.color=s??Gn.RED,this.left=a??Gn.EMPTY,this.right=c??Gn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,s,a,c){return new Gn(e??this.key,t??this.value,s??this.color,a??this.left,c??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,s){let a=this;const c=s(e,a.key);return a=c<0?a.copy(null,null,null,a.left.insert(e,t,s),null):c===0?a.copy(null,t,null,null,null):a.copy(null,null,null,null,a.right.insert(e,t,s)),a.fixUp()}removeMin(){if(this.left.isEmpty())return Gn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let s,a=this;if(t(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,t),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),t(e,a.key)===0){if(a.right.isEmpty())return Gn.EMPTY;s=a.right.min(),a=a.copy(s.key,s.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,t))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Gn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Gn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw st(43730,{key:this.key,value:this.value});if(this.right.isRed())throw st(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw st(27949);return e+(this.isRed()?0:1)}}Gn.EMPTY=null,Gn.RED=!0,Gn.BLACK=!1;Gn.EMPTY=new class{constructor(){this.size=0}get key(){throw st(57766)}get value(){throw st(16141)}get color(){throw st(16727)}get left(){throw st(29726)}get right(){throw st(36894)}copy(e,t,s,a,c){return this}insert(e,t,s){return new Gn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bn{constructor(e){this.comparator=e,this.data=new Kt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,s)=>(e(t),!1)))}forEachInRange(e,t){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const a=s.getNext();if(this.comparator(a.key,e[1])>=0)return;t(a.key)}}forEachWhile(e,t){let s;for(s=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new vv(this.data.getIterator())}getIteratorFrom(e){return new vv(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((s=>{t=t.add(s)})),t}isEqual(e){if(!(e instanceof bn)||this.size!==e.size)return!1;const t=this.data.getIterator(),s=e.data.getIterator();for(;t.hasNext();){const a=t.getNext().key,c=s.getNext().key;if(this.comparator(a,c)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new bn(this.comparator);return t.data=e,t}}class vv{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Or{constructor(e){this.fields=e,e.sort(qn.comparator)}static empty(){return new Or([])}unionWith(e){let t=new bn(qn.comparator);for(const s of this.fields)t=t.add(s);for(const s of e)t=t.add(s);return new Or(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Do(this.fields,e.fields,((t,s)=>t.isEqual(s)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q0 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(a){try{return atob(a)}catch(c){throw typeof DOMException<"u"&&c instanceof DOMException?new q0("Invalid base64 string: "+c):c}})(e);return new Hn(t)}static fromUint8Array(e){const t=(function(a){let c="";for(let d=0;d<a.length;++d)c+=String.fromCharCode(a[d]);return c})(e);return new Hn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const s=new Uint8Array(t.length);for(let a=0;a<t.length;a++)s[a]=t.charCodeAt(a);return s})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ft(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Hn.EMPTY_BYTE_STRING=new Hn("");const tC=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Zi(n){if(At(!!n,39018),typeof n=="string"){let e=0;const t=tC.exec(n);if(At(!!t,46558,{timestamp:n}),t[1]){let a=t[1];a=(a+"000000000").substr(0,9),e=Number(a)}const s=new Date(n);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:an(n.seconds),nanos:an(n.nanos)}}function an(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function ea(n){return typeof n=="string"?Hn.fromBase64String(n):Hn.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H0="server_timestamp",K0="__type__",Q0="__previous_value__",Y0="__local_write_time__";function Ep(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[K0])===null||t===void 0?void 0:t.stringValue)===H0}function dd(n){const e=n.mapValue.fields[Q0];return Ep(e)?dd(e):e}function Kl(n){const e=Zi(n.mapValue.fields[Y0].timestampValue);return new Bt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nC{constructor(e,t,s,a,c,d,f,m,v,x){this.databaseId=e,this.appId=t,this.persistenceKey=s,this.host=a,this.ssl=c,this.forceLongPolling=d,this.autoDetectLongPolling=f,this.longPollingOptions=m,this.useFetchStreams=v,this.isUsingEmulator=x}}const Gu="(default)";class Ql{constructor(e,t){this.projectId=e,this.database=t||Gu}static empty(){return new Ql("","")}get isDefaultDatabase(){return this.database===Gu}isEqual(e){return e instanceof Ql&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J0="__type__",rC="__max__",_u={mapValue:{}},X0="__vector__",qu="value";function ta(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Ep(n)?4:iC(n)?9007199254740991:sC(n)?10:11:st(28295,{value:n})}function Bs(n,e){if(n===e)return!0;const t=ta(n);if(t!==ta(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Kl(n).isEqual(Kl(e));case 3:return(function(a,c){if(typeof a.timestampValue=="string"&&typeof c.timestampValue=="string"&&a.timestampValue.length===c.timestampValue.length)return a.timestampValue===c.timestampValue;const d=Zi(a.timestampValue),f=Zi(c.timestampValue);return d.seconds===f.seconds&&d.nanos===f.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(a,c){return ea(a.bytesValue).isEqual(ea(c.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(a,c){return an(a.geoPointValue.latitude)===an(c.geoPointValue.latitude)&&an(a.geoPointValue.longitude)===an(c.geoPointValue.longitude)})(n,e);case 2:return(function(a,c){if("integerValue"in a&&"integerValue"in c)return an(a.integerValue)===an(c.integerValue);if("doubleValue"in a&&"doubleValue"in c){const d=an(a.doubleValue),f=an(c.doubleValue);return d===f?Wu(d)===Wu(f):isNaN(d)&&isNaN(f)}return!1})(n,e);case 9:return Do(n.arrayValue.values||[],e.arrayValue.values||[],Bs);case 10:case 11:return(function(a,c){const d=a.mapValue.fields||{},f=c.mapValue.fields||{};if(yv(d)!==yv(f))return!1;for(const m in d)if(d.hasOwnProperty(m)&&(f[m]===void 0||!Bs(d[m],f[m])))return!1;return!0})(n,e);default:return st(52216,{left:n})}}function Yl(n,e){return(n.values||[]).find((t=>Bs(t,e)))!==void 0}function Lo(n,e){if(n===e)return 0;const t=ta(n),s=ta(e);if(t!==s)return ft(t,s);switch(t){case 0:case 9007199254740991:return 0;case 1:return ft(n.booleanValue,e.booleanValue);case 2:return(function(c,d){const f=an(c.integerValue||c.doubleValue),m=an(d.integerValue||d.doubleValue);return f<m?-1:f>m?1:f===m?0:isNaN(f)?isNaN(m)?0:-1:1})(n,e);case 3:return _v(n.timestampValue,e.timestampValue);case 4:return _v(Kl(n),Kl(e));case 5:return Df(n.stringValue,e.stringValue);case 6:return(function(c,d){const f=ea(c),m=ea(d);return f.compareTo(m)})(n.bytesValue,e.bytesValue);case 7:return(function(c,d){const f=c.split("/"),m=d.split("/");for(let v=0;v<f.length&&v<m.length;v++){const x=ft(f[v],m[v]);if(x!==0)return x}return ft(f.length,m.length)})(n.referenceValue,e.referenceValue);case 8:return(function(c,d){const f=ft(an(c.latitude),an(d.latitude));return f!==0?f:ft(an(c.longitude),an(d.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return xv(n.arrayValue,e.arrayValue);case 10:return(function(c,d){var f,m,v,x;const S=c.fields||{},b=d.fields||{},M=(f=S[qu])===null||f===void 0?void 0:f.arrayValue,Y=(m=b[qu])===null||m===void 0?void 0:m.arrayValue,z=ft(((v=M==null?void 0:M.values)===null||v===void 0?void 0:v.length)||0,((x=Y==null?void 0:Y.values)===null||x===void 0?void 0:x.length)||0);return z!==0?z:xv(M,Y)})(n.mapValue,e.mapValue);case 11:return(function(c,d){if(c===_u.mapValue&&d===_u.mapValue)return 0;if(c===_u.mapValue)return 1;if(d===_u.mapValue)return-1;const f=c.fields||{},m=Object.keys(f),v=d.fields||{},x=Object.keys(v);m.sort(),x.sort();for(let S=0;S<m.length&&S<x.length;++S){const b=Df(m[S],x[S]);if(b!==0)return b;const M=Lo(f[m[S]],v[x[S]]);if(M!==0)return M}return ft(m.length,x.length)})(n.mapValue,e.mapValue);default:throw st(23264,{le:t})}}function _v(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ft(n,e);const t=Zi(n),s=Zi(e),a=ft(t.seconds,s.seconds);return a!==0?a:ft(t.nanos,s.nanos)}function xv(n,e){const t=n.values||[],s=e.values||[];for(let a=0;a<t.length&&a<s.length;++a){const c=Lo(t[a],s[a]);if(c)return c}return ft(t.length,s.length)}function Vo(n){return Lf(n)}function Lf(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const s=Zi(t);return`time(${s.seconds},${s.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return ea(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Ze.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let s="[",a=!0;for(const c of t.values||[])a?a=!1:s+=",",s+=Lf(c);return s+"]"})(n.arrayValue):"mapValue"in n?(function(t){const s=Object.keys(t.fields||{}).sort();let a="{",c=!0;for(const d of s)c?c=!1:a+=",",a+=`${d}:${Lf(t.fields[d])}`;return a+"}"})(n.mapValue):st(61005,{value:n})}function Nu(n){switch(ta(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=dd(n);return e?16+Nu(e):16;case 5:return 2*n.stringValue.length;case 6:return ea(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(s){return(s.values||[]).reduce(((a,c)=>a+Nu(c)),0)})(n.arrayValue);case 10:case 11:return(function(s){let a=0;return la(s.fields,((c,d)=>{a+=c.length+Nu(d)})),a})(n.mapValue);default:throw st(13486,{value:n})}}function wv(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Vf(n){return!!n&&"integerValue"in n}function Tp(n){return!!n&&"arrayValue"in n}function Ev(n){return!!n&&"nullValue"in n}function Tv(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Ru(n){return!!n&&"mapValue"in n}function sC(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[J0])===null||t===void 0?void 0:t.stringValue)===X0}function Ol(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return la(n.mapValue.fields,((t,s)=>e.mapValue.fields[t]=Ol(s))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Ol(n.arrayValue.values[t]);return e}return Object.assign({},n)}function iC(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===rC}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class br{constructor(e){this.value=e}static empty(){return new br({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let s=0;s<e.length-1;++s)if(t=(t.mapValue.fields||{})[e.get(s)],!Ru(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ol(t)}setAll(e){let t=qn.emptyPath(),s={},a=[];e.forEach(((d,f)=>{if(!t.isImmediateParentOf(f)){const m=this.getFieldsMap(t);this.applyChanges(m,s,a),s={},a=[],t=f.popLast()}d?s[f.lastSegment()]=Ol(d):a.push(f.lastSegment())}));const c=this.getFieldsMap(t);this.applyChanges(c,s,a)}delete(e){const t=this.field(e.popLast());Ru(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Bs(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let s=0;s<e.length;++s){let a=t.mapValue.fields[e.get(s)];Ru(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},t.mapValue.fields[e.get(s)]=a),t=a}return t.mapValue.fields}applyChanges(e,t,s){la(t,((a,c)=>e[a]=c));for(const a of s)delete e[a]}clone(){return new br(Ol(this.value))}}function Z0(n){const e=[];return la(n.fields,((t,s)=>{const a=new qn([t]);if(Ru(s)){const c=Z0(s.mapValue).fields;if(c.length===0)e.push(a);else for(const d of c)e.push(a.child(d))}else e.push(a)})),new Or(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ar{constructor(e,t,s,a,c,d,f){this.key=e,this.documentType=t,this.version=s,this.readTime=a,this.createTime=c,this.data=d,this.documentState=f}static newInvalidDocument(e){return new ar(e,0,lt.min(),lt.min(),lt.min(),br.empty(),0)}static newFoundDocument(e,t,s,a){return new ar(e,1,t,lt.min(),s,a,0)}static newNoDocument(e,t){return new ar(e,2,t,lt.min(),lt.min(),br.empty(),0)}static newUnknownDocument(e,t){return new ar(e,3,t,lt.min(),lt.min(),br.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(lt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=br.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=br.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=lt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ar&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ar(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hu{constructor(e,t){this.position=e,this.inclusive=t}}function Sv(n,e,t){let s=0;for(let a=0;a<n.position.length;a++){const c=e[a],d=n.position[a];if(c.field.isKeyField()?s=Ze.comparator(Ze.fromName(d.referenceValue),t.key):s=Lo(d,t.data.field(c.field)),c.dir==="desc"&&(s*=-1),s!==0)break}return s}function bv(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Bs(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jl{constructor(e,t="asc"){this.field=e,this.dir=t}}function aC(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ex{}class fn extends ex{constructor(e,t,s){super(),this.field=e,this.op=t,this.value=s}static create(e,t,s){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,s):new lC(e,t,s):t==="array-contains"?new dC(e,s):t==="in"?new hC(e,s):t==="not-in"?new fC(e,s):t==="array-contains-any"?new pC(e,s):new fn(e,t,s)}static createKeyFieldInFilter(e,t,s){return t==="in"?new cC(e,s):new uC(e,s)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Lo(t,this.value)):t!==null&&ta(this.value)===ta(t)&&this.matchesComparison(Lo(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return st(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Es extends ex{constructor(e,t){super(),this.filters=e,this.op=t,this.he=null}static create(e,t){return new Es(e,t)}matches(e){return tx(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function tx(n){return n.op==="and"}function nx(n){return oC(n)&&tx(n)}function oC(n){for(const e of n.filters)if(e instanceof Es)return!1;return!0}function Mf(n){if(n instanceof fn)return n.field.canonicalString()+n.op.toString()+Vo(n.value);if(nx(n))return n.filters.map((e=>Mf(e))).join(",");{const e=n.filters.map((t=>Mf(t))).join(",");return`${n.op}(${e})`}}function rx(n,e){return n instanceof fn?(function(s,a){return a instanceof fn&&s.op===a.op&&s.field.isEqual(a.field)&&Bs(s.value,a.value)})(n,e):n instanceof Es?(function(s,a){return a instanceof Es&&s.op===a.op&&s.filters.length===a.filters.length?s.filters.reduce(((c,d,f)=>c&&rx(d,a.filters[f])),!0):!1})(n,e):void st(19439)}function sx(n){return n instanceof fn?(function(t){return`${t.field.canonicalString()} ${t.op} ${Vo(t.value)}`})(n):n instanceof Es?(function(t){return t.op.toString()+" {"+t.getFilters().map(sx).join(" ,")+"}"})(n):"Filter"}class lC extends fn{constructor(e,t,s){super(e,t,s),this.key=Ze.fromName(s.referenceValue)}matches(e){const t=Ze.comparator(e.key,this.key);return this.matchesComparison(t)}}class cC extends fn{constructor(e,t){super(e,"in",t),this.keys=ix("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class uC extends fn{constructor(e,t){super(e,"not-in",t),this.keys=ix("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function ix(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map((s=>Ze.fromName(s.referenceValue)))}class dC extends fn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Tp(t)&&Yl(t.arrayValue,this.value)}}class hC extends fn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Yl(this.value.arrayValue,t)}}class fC extends fn{constructor(e,t){super(e,"not-in",t)}matches(e){if(Yl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Yl(this.value.arrayValue,t)}}class pC extends fn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Tp(t)||!t.arrayValue.values)&&t.arrayValue.values.some((s=>Yl(this.value.arrayValue,s)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mC{constructor(e,t=null,s=[],a=[],c=null,d=null,f=null){this.path=e,this.collectionGroup=t,this.orderBy=s,this.filters=a,this.limit=c,this.startAt=d,this.endAt=f,this.Pe=null}}function Iv(n,e=null,t=[],s=[],a=null,c=null,d=null){return new mC(n,e,t,s,a,c,d)}function Sp(n){const e=ct(n);if(e.Pe===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((s=>Mf(s))).join(","),t+="|ob:",t+=e.orderBy.map((s=>(function(c){return c.field.canonicalString()+c.dir})(s))).join(","),ud(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((s=>Vo(s))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((s=>Vo(s))).join(",")),e.Pe=t}return e.Pe}function bp(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!aC(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!rx(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!bv(n.startAt,e.startAt)&&bv(n.endAt,e.endAt)}function Of(n){return Ze.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qo{constructor(e,t=null,s=[],a=[],c=null,d="F",f=null,m=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=s,this.filters=a,this.limit=c,this.limitType=d,this.startAt=f,this.endAt=m,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function gC(n,e,t,s,a,c,d,f){return new Qo(n,e,t,s,a,c,d,f)}function hd(n){return new Qo(n)}function Cv(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function ax(n){return n.collectionGroup!==null}function Fl(n){const e=ct(n);if(e.Te===null){e.Te=[];const t=new Set;for(const c of e.explicitOrderBy)e.Te.push(c),t.add(c.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let f=new bn(qn.comparator);return d.filters.forEach((m=>{m.getFlattenedFilters().forEach((v=>{v.isInequality()&&(f=f.add(v.field))}))})),f})(e).forEach((c=>{t.has(c.canonicalString())||c.isKeyField()||e.Te.push(new Jl(c,s))})),t.has(qn.keyField().canonicalString())||e.Te.push(new Jl(qn.keyField(),s))}return e.Te}function Os(n){const e=ct(n);return e.Ie||(e.Ie=yC(e,Fl(n))),e.Ie}function yC(n,e){if(n.limitType==="F")return Iv(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((a=>{const c=a.dir==="desc"?"asc":"desc";return new Jl(a.field,c)}));const t=n.endAt?new Hu(n.endAt.position,n.endAt.inclusive):null,s=n.startAt?new Hu(n.startAt.position,n.startAt.inclusive):null;return Iv(n.path,n.collectionGroup,e,n.filters,n.limit,t,s)}}function Ff(n,e){const t=n.filters.concat([e]);return new Qo(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Ku(n,e,t){return new Qo(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function fd(n,e){return bp(Os(n),Os(e))&&n.limitType===e.limitType}function ox(n){return`${Sp(Os(n))}|lt:${n.limitType}`}function So(n){return`Query(target=${(function(t){let s=t.path.canonicalString();return t.collectionGroup!==null&&(s+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(s+=`, filters: [${t.filters.map((a=>sx(a))).join(", ")}]`),ud(t.limit)||(s+=", limit: "+t.limit),t.orderBy.length>0&&(s+=`, orderBy: [${t.orderBy.map((a=>(function(d){return`${d.field.canonicalString()} (${d.dir})`})(a))).join(", ")}]`),t.startAt&&(s+=", startAt: ",s+=t.startAt.inclusive?"b:":"a:",s+=t.startAt.position.map((a=>Vo(a))).join(",")),t.endAt&&(s+=", endAt: ",s+=t.endAt.inclusive?"a:":"b:",s+=t.endAt.position.map((a=>Vo(a))).join(",")),`Target(${s})`})(Os(n))}; limitType=${n.limitType})`}function pd(n,e){return e.isFoundDocument()&&(function(s,a){const c=a.key.path;return s.collectionGroup!==null?a.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(c):Ze.isDocumentKey(s.path)?s.path.isEqual(c):s.path.isImmediateParentOf(c)})(n,e)&&(function(s,a){for(const c of Fl(s))if(!c.field.isKeyField()&&a.data.field(c.field)===null)return!1;return!0})(n,e)&&(function(s,a){for(const c of s.filters)if(!c.matches(a))return!1;return!0})(n,e)&&(function(s,a){return!(s.startAt&&!(function(d,f,m){const v=Sv(d,f,m);return d.inclusive?v<=0:v<0})(s.startAt,Fl(s),a)||s.endAt&&!(function(d,f,m){const v=Sv(d,f,m);return d.inclusive?v>=0:v>0})(s.endAt,Fl(s),a))})(n,e)}function vC(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function lx(n){return(e,t)=>{let s=!1;for(const a of Fl(n)){const c=_C(a,e,t);if(c!==0)return c;s=s||a.field.isKeyField()}return 0}}function _C(n,e,t){const s=n.field.isKeyField()?Ze.comparator(e.key,t.key):(function(c,d,f){const m=d.data.field(c),v=f.data.field(c);return m!==null&&v!==null?Lo(m,v):st(42886)})(n.field,e,t);switch(n.dir){case"asc":return s;case"desc":return-1*s;default:return st(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fa{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s!==void 0){for(const[a,c]of s)if(this.equalsFn(a,e))return c}}has(e){return this.get(e)!==void 0}set(e,t){const s=this.mapKeyFn(e),a=this.inner[s];if(a===void 0)return this.inner[s]=[[e,t]],void this.innerSize++;for(let c=0;c<a.length;c++)if(this.equalsFn(a[c][0],e))return void(a[c]=[e,t]);a.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s===void 0)return!1;for(let a=0;a<s.length;a++)if(this.equalsFn(s[a][0],e))return s.length===1?delete this.inner[t]:s.splice(a,1),this.innerSize--,!0;return!1}forEach(e){la(this.inner,((t,s)=>{for(const[a,c]of s)e(a,c)}))}isEmpty(){return G0(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xC=new Kt(Ze.comparator);function gi(){return xC}const cx=new Kt(Ze.comparator);function jl(...n){let e=cx;for(const t of n)e=e.insert(t.key,t);return e}function ux(n){let e=cx;return n.forEach(((t,s)=>e=e.insert(t,s.overlayedDocument))),e}function Pa(){return Ul()}function dx(){return Ul()}function Ul(){return new Fa((n=>n.toString()),((n,e)=>n.isEqual(e)))}const wC=new Kt(Ze.comparator),EC=new bn(Ze.comparator);function vt(...n){let e=EC;for(const t of n)e=e.add(t);return e}const TC=new bn(ft);function SC(){return TC}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ip(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Wu(e)?"-0":e}}function hx(n){return{integerValue:""+n}}function bC(n,e){return XI(e)?hx(e):Ip(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class md{constructor(){this._=void 0}}function IC(n,e,t){return n instanceof Xl?(function(a,c){const d={fields:{[K0]:{stringValue:H0},[Y0]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return c&&Ep(c)&&(c=dd(c)),c&&(d.fields[Q0]=c),{mapValue:d}})(t,e):n instanceof Zl?px(n,e):n instanceof ec?mx(n,e):(function(a,c){const d=fx(a,c),f=Pv(d)+Pv(a.Ee);return Vf(d)&&Vf(a.Ee)?hx(f):Ip(a.serializer,f)})(n,e)}function CC(n,e,t){return n instanceof Zl?px(n,e):n instanceof ec?mx(n,e):t}function fx(n,e){return n instanceof Qu?(function(s){return Vf(s)||(function(c){return!!c&&"doubleValue"in c})(s)})(e)?e:{integerValue:0}:null}class Xl extends md{}class Zl extends md{constructor(e){super(),this.elements=e}}function px(n,e){const t=gx(e);for(const s of n.elements)t.some((a=>Bs(a,s)))||t.push(s);return{arrayValue:{values:t}}}class ec extends md{constructor(e){super(),this.elements=e}}function mx(n,e){let t=gx(e);for(const s of n.elements)t=t.filter((a=>!Bs(a,s)));return{arrayValue:{values:t}}}class Qu extends md{constructor(e,t){super(),this.serializer=e,this.Ee=t}}function Pv(n){return an(n.integerValue||n.doubleValue)}function gx(n){return Tp(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PC{constructor(e,t){this.field=e,this.transform=t}}function NC(n,e){return n.field.isEqual(e.field)&&(function(s,a){return s instanceof Zl&&a instanceof Zl||s instanceof ec&&a instanceof ec?Do(s.elements,a.elements,Bs):s instanceof Qu&&a instanceof Qu?Bs(s.Ee,a.Ee):s instanceof Xl&&a instanceof Xl})(n.transform,e.transform)}class RC{constructor(e,t){this.version=e,this.transformResults=t}}class Xr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Xr}static exists(e){return new Xr(void 0,e)}static updateTime(e){return new Xr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Au(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class gd{}function yx(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Cp(n.key,Xr.none()):new lc(n.key,n.data,Xr.none());{const t=n.data,s=br.empty();let a=new bn(qn.comparator);for(let c of e.fields)if(!a.has(c)){let d=t.field(c);d===null&&c.length>1&&(c=c.popLast(),d=t.field(c)),d===null?s.delete(c):s.set(c,d),a=a.add(c)}return new ca(n.key,s,new Or(a.toArray()),Xr.none())}}function AC(n,e,t){n instanceof lc?(function(a,c,d){const f=a.value.clone(),m=Rv(a.fieldTransforms,c,d.transformResults);f.setAll(m),c.convertToFoundDocument(d.version,f).setHasCommittedMutations()})(n,e,t):n instanceof ca?(function(a,c,d){if(!Au(a.precondition,c))return void c.convertToUnknownDocument(d.version);const f=Rv(a.fieldTransforms,c,d.transformResults),m=c.data;m.setAll(vx(a)),m.setAll(f),c.convertToFoundDocument(d.version,m).setHasCommittedMutations()})(n,e,t):(function(a,c,d){c.convertToNoDocument(d.version).setHasCommittedMutations()})(0,e,t)}function zl(n,e,t,s){return n instanceof lc?(function(c,d,f,m){if(!Au(c.precondition,d))return f;const v=c.value.clone(),x=Av(c.fieldTransforms,m,d);return v.setAll(x),d.convertToFoundDocument(d.version,v).setHasLocalMutations(),null})(n,e,t,s):n instanceof ca?(function(c,d,f,m){if(!Au(c.precondition,d))return f;const v=Av(c.fieldTransforms,m,d),x=d.data;return x.setAll(vx(c)),x.setAll(v),d.convertToFoundDocument(d.version,x).setHasLocalMutations(),f===null?null:f.unionWith(c.fieldMask.fields).unionWith(c.fieldTransforms.map((S=>S.field)))})(n,e,t,s):(function(c,d,f){return Au(c.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):f})(n,e,t)}function jC(n,e){let t=null;for(const s of n.fieldTransforms){const a=e.data.field(s.field),c=fx(s.transform,a||null);c!=null&&(t===null&&(t=br.empty()),t.set(s.field,c))}return t||null}function Nv(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(s,a){return s===void 0&&a===void 0||!(!s||!a)&&Do(s,a,((c,d)=>NC(c,d)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class lc extends gd{constructor(e,t,s,a=[]){super(),this.key=e,this.value=t,this.precondition=s,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class ca extends gd{constructor(e,t,s,a,c=[]){super(),this.key=e,this.data=t,this.fieldMask=s,this.precondition=a,this.fieldTransforms=c,this.type=1}getFieldMask(){return this.fieldMask}}function vx(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const s=n.data.field(t);e.set(t,s)}})),e}function Rv(n,e,t){const s=new Map;At(n.length===t.length,32656,{Ae:t.length,Re:n.length});for(let a=0;a<t.length;a++){const c=n[a],d=c.transform,f=e.data.field(c.field);s.set(c.field,CC(d,f,t[a]))}return s}function Av(n,e,t){const s=new Map;for(const a of n){const c=a.transform,d=t.data.field(a.field);s.set(a.field,IC(c,d,e))}return s}class Cp extends gd{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class kC extends gd{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DC{constructor(e,t,s,a){this.batchId=e,this.localWriteTime=t,this.baseMutations=s,this.mutations=a}applyToRemoteDocument(e,t){const s=t.mutationResults;for(let a=0;a<this.mutations.length;a++){const c=this.mutations[a];c.key.isEqual(e.key)&&AC(c,e,s[a])}}applyToLocalView(e,t){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(t=zl(s,e,t,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(t=zl(s,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const s=dx();return this.mutations.forEach((a=>{const c=e.get(a.key),d=c.overlayedDocument;let f=this.applyToLocalView(d,c.mutatedFields);f=t.has(a.key)?null:f;const m=yx(d,f);m!==null&&s.set(a.key,m),d.isValidDocument()||d.convertToNoDocument(lt.min())})),s}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),vt())}isEqual(e){return this.batchId===e.batchId&&Do(this.mutations,e.mutations,((t,s)=>Nv(t,s)))&&Do(this.baseMutations,e.baseMutations,((t,s)=>Nv(t,s)))}}class Pp{constructor(e,t,s,a){this.batch=e,this.commitVersion=t,this.mutationResults=s,this.docVersions=a}static from(e,t,s){At(e.mutations.length===s.length,58842,{Ve:e.mutations.length,me:s.length});let a=(function(){return wC})();const c=e.mutations;for(let d=0;d<c.length;d++)a=a.insert(c[d].key,s[d].version);return new Pp(e,t,s,a)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LC{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VC{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var hn,Tt;function MC(n){switch(n){case de.OK:return st(64938);case de.CANCELLED:case de.UNKNOWN:case de.DEADLINE_EXCEEDED:case de.RESOURCE_EXHAUSTED:case de.INTERNAL:case de.UNAVAILABLE:case de.UNAUTHENTICATED:return!1;case de.INVALID_ARGUMENT:case de.NOT_FOUND:case de.ALREADY_EXISTS:case de.PERMISSION_DENIED:case de.FAILED_PRECONDITION:case de.ABORTED:case de.OUT_OF_RANGE:case de.UNIMPLEMENTED:case de.DATA_LOSS:return!0;default:return st(15467,{code:n})}}function _x(n){if(n===void 0)return mi("GRPC error has no .code"),de.UNKNOWN;switch(n){case hn.OK:return de.OK;case hn.CANCELLED:return de.CANCELLED;case hn.UNKNOWN:return de.UNKNOWN;case hn.DEADLINE_EXCEEDED:return de.DEADLINE_EXCEEDED;case hn.RESOURCE_EXHAUSTED:return de.RESOURCE_EXHAUSTED;case hn.INTERNAL:return de.INTERNAL;case hn.UNAVAILABLE:return de.UNAVAILABLE;case hn.UNAUTHENTICATED:return de.UNAUTHENTICATED;case hn.INVALID_ARGUMENT:return de.INVALID_ARGUMENT;case hn.NOT_FOUND:return de.NOT_FOUND;case hn.ALREADY_EXISTS:return de.ALREADY_EXISTS;case hn.PERMISSION_DENIED:return de.PERMISSION_DENIED;case hn.FAILED_PRECONDITION:return de.FAILED_PRECONDITION;case hn.ABORTED:return de.ABORTED;case hn.OUT_OF_RANGE:return de.OUT_OF_RANGE;case hn.UNIMPLEMENTED:return de.UNIMPLEMENTED;case hn.DATA_LOSS:return de.DATA_LOSS;default:return st(39323,{code:n})}}(Tt=hn||(hn={}))[Tt.OK=0]="OK",Tt[Tt.CANCELLED=1]="CANCELLED",Tt[Tt.UNKNOWN=2]="UNKNOWN",Tt[Tt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Tt[Tt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Tt[Tt.NOT_FOUND=5]="NOT_FOUND",Tt[Tt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Tt[Tt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Tt[Tt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Tt[Tt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Tt[Tt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Tt[Tt.ABORTED=10]="ABORTED",Tt[Tt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Tt[Tt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Tt[Tt.INTERNAL=13]="INTERNAL",Tt[Tt.UNAVAILABLE=14]="UNAVAILABLE",Tt[Tt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OC=new Qi([4294967295,4294967295],0);function jv(n){const e=z0().encode(n),t=new k0;return t.update(e),new Uint8Array(t.digest())}function kv(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),s=e.getUint32(4,!0),a=e.getUint32(8,!0),c=e.getUint32(12,!0);return[new Qi([t,s],0),new Qi([a,c],0)]}class Np{constructor(e,t,s){if(this.bitmap=e,this.padding=t,this.hashCount=s,t<0||t>=8)throw new kl(`Invalid padding: ${t}`);if(s<0)throw new kl(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new kl(`Invalid hash count: ${s}`);if(e.length===0&&t!==0)throw new kl(`Invalid padding when bitmap length is 0: ${t}`);this.fe=8*e.length-t,this.ge=Qi.fromNumber(this.fe)}pe(e,t,s){let a=e.add(t.multiply(Qi.fromNumber(s)));return a.compare(OC)===1&&(a=new Qi([a.getBits(0),a.getBits(1)],0)),a.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;const t=jv(e),[s,a]=kv(t);for(let c=0;c<this.hashCount;c++){const d=this.pe(s,a,c);if(!this.ye(d))return!1}return!0}static create(e,t,s){const a=e%8==0?0:8-e%8,c=new Uint8Array(Math.ceil(e/8)),d=new Np(c,a,t);return s.forEach((f=>d.insert(f))),d}insert(e){if(this.fe===0)return;const t=jv(e),[s,a]=kv(t);for(let c=0;c<this.hashCount;c++){const d=this.pe(s,a,c);this.we(d)}}we(e){const t=Math.floor(e/8),s=e%8;this.bitmap[t]|=1<<s}}class kl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yd{constructor(e,t,s,a,c){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=s,this.documentUpdates=a,this.resolvedLimboDocuments=c}static createSynthesizedRemoteEventForCurrentChange(e,t,s){const a=new Map;return a.set(e,cc.createSynthesizedTargetChangeForCurrentChange(e,t,s)),new yd(lt.min(),a,new Kt(ft),gi(),vt())}}class cc{constructor(e,t,s,a,c){this.resumeToken=e,this.current=t,this.addedDocuments=s,this.modifiedDocuments=a,this.removedDocuments=c}static createSynthesizedTargetChangeForCurrentChange(e,t,s){return new cc(s,t,vt(),vt(),vt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ju{constructor(e,t,s,a){this.Se=e,this.removedTargetIds=t,this.key=s,this.be=a}}class xx{constructor(e,t){this.targetId=e,this.De=t}}class wx{constructor(e,t,s=Hn.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=t,this.resumeToken=s,this.cause=a}}class Dv{constructor(){this.ve=0,this.Ce=Lv(),this.Fe=Hn.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=vt(),t=vt(),s=vt();return this.Ce.forEach(((a,c)=>{switch(c){case 0:e=e.add(a);break;case 2:t=t.add(a);break;case 1:s=s.add(a);break;default:st(38017,{changeType:c})}})),new cc(this.Fe,this.Me,e,t,s)}ke(){this.xe=!1,this.Ce=Lv()}qe(e,t){this.xe=!0,this.Ce=this.Ce.insert(e,t)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,At(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class FC{constructor(e){this.We=e,this.Ge=new Map,this.ze=gi(),this.je=xu(),this.Je=xu(),this.He=new Kt(ft)}Ye(e){for(const t of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(t,e.be):this.Xe(t,e.key,e.be);for(const t of e.removedTargetIds)this.Xe(t,e.key,e.be)}et(e){this.forEachTarget(e,(t=>{const s=this.tt(t);switch(e.state){case 0:this.nt(t)&&s.Be(e.resumeToken);break;case 1:s.Ue(),s.Oe||s.ke(),s.Be(e.resumeToken);break;case 2:s.Ue(),s.Oe||this.removeTarget(t);break;case 3:this.nt(t)&&(s.Ke(),s.Be(e.resumeToken));break;case 4:this.nt(t)&&(this.rt(t),s.Be(e.resumeToken));break;default:st(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ge.forEach(((s,a)=>{this.nt(a)&&t(a)}))}it(e){const t=e.targetId,s=e.De.count,a=this.st(t);if(a){const c=a.target;if(Of(c))if(s===0){const d=new Ze(c.path);this.Xe(t,d,ar.newNoDocument(d,lt.min()))}else At(s===1,20013,{expectedCount:s});else{const d=this.ot(t);if(d!==s){const f=this._t(e),m=f?this.ut(f,e,d):1;if(m!==0){this.rt(t);const v=m===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(t,v)}}}}}_t(e){const t=e.De.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:s="",padding:a=0},hashCount:c=0}=t;let d,f;try{d=ea(s).toUint8Array()}catch(m){if(m instanceof q0)return Ji("Decoding the base64 bloom filter in existence filter failed ("+m.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw m}try{f=new Np(d,a,c)}catch(m){return Ji(m instanceof kl?"BloomFilter error: ":"Applying bloom filter failed: ",m),null}return f.fe===0?null:f}ut(e,t,s){return t.De.count===s-this.ht(e,t.targetId)?0:2}ht(e,t){const s=this.We.getRemoteKeysForTarget(t);let a=0;return s.forEach((c=>{const d=this.We.lt(),f=`projects/${d.projectId}/databases/${d.database}/documents/${c.path.canonicalString()}`;e.mightContain(f)||(this.Xe(t,c,null),a++)})),a}Pt(e){const t=new Map;this.Ge.forEach(((c,d)=>{const f=this.st(d);if(f){if(c.current&&Of(f.target)){const m=new Ze(f.target.path);this.Tt(m).has(d)||this.It(d,m)||this.Xe(d,m,ar.newNoDocument(m,e))}c.Ne&&(t.set(d,c.Le()),c.ke())}}));let s=vt();this.Je.forEach(((c,d)=>{let f=!0;d.forEachWhile((m=>{const v=this.st(m);return!v||v.purpose==="TargetPurposeLimboResolution"||(f=!1,!1)})),f&&(s=s.add(c))})),this.ze.forEach(((c,d)=>d.setReadTime(e)));const a=new yd(e,t,this.He,this.ze,s);return this.ze=gi(),this.je=xu(),this.Je=xu(),this.He=new Kt(ft),a}Ze(e,t){if(!this.nt(e))return;const s=this.It(e,t.key)?2:0;this.tt(e).qe(t.key,s),this.ze=this.ze.insert(t.key,t),this.je=this.je.insert(t.key,this.Tt(t.key).add(e)),this.Je=this.Je.insert(t.key,this.dt(t.key).add(e))}Xe(e,t,s){if(!this.nt(e))return;const a=this.tt(e);this.It(e,t)?a.qe(t,1):a.Qe(t),this.Je=this.Je.insert(t,this.dt(t).delete(e)),this.Je=this.Je.insert(t,this.dt(t).add(e)),s&&(this.ze=this.ze.insert(t,s))}removeTarget(e){this.Ge.delete(e)}ot(e){const t=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let t=this.Ge.get(e);return t||(t=new Dv,this.Ge.set(e,t)),t}dt(e){let t=this.Je.get(e);return t||(t=new bn(ft),this.Je=this.Je.insert(e,t)),t}Tt(e){let t=this.je.get(e);return t||(t=new bn(ft),this.je=this.je.insert(e,t)),t}nt(e){const t=this.st(e)!==null;return t||Ue("WatchChangeAggregator","Detected inactive target",e),t}st(e){const t=this.Ge.get(e);return t&&t.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new Dv),this.We.getRemoteKeysForTarget(e).forEach((t=>{this.Xe(e,t,null)}))}It(e,t){return this.We.getRemoteKeysForTarget(e).has(t)}}function xu(){return new Kt(Ze.comparator)}function Lv(){return new Kt(Ze.comparator)}const UC={asc:"ASCENDING",desc:"DESCENDING"},zC={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},BC={and:"AND",or:"OR"};class $C{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Uf(n,e){return n.useProto3Json||ud(e)?e:{value:e}}function Yu(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Ex(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function WC(n,e){return Yu(n,e.toTimestamp())}function Fs(n){return At(!!n,49232),lt.fromTimestamp((function(t){const s=Zi(t);return new Bt(s.seconds,s.nanos)})(n))}function Rp(n,e){return zf(n,e).canonicalString()}function zf(n,e){const t=(function(a){return new Mt(["projects",a.projectId,"databases",a.database])})(n).child("documents");return e===void 0?t:t.child(e)}function Tx(n){const e=Mt.fromString(n);return At(Px(e),10190,{key:e.toString()}),e}function Bf(n,e){return Rp(n.databaseId,e.path)}function hf(n,e){const t=Tx(e);if(t.get(1)!==n.databaseId.projectId)throw new Oe(de.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Oe(de.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Ze(bx(t))}function Sx(n,e){return Rp(n.databaseId,e)}function GC(n){const e=Tx(n);return e.length===4?Mt.emptyPath():bx(e)}function $f(n){return new Mt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function bx(n){return At(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function Vv(n,e,t){return{name:Bf(n,e),fields:t.value.mapValue.fields}}function qC(n,e){let t;if("targetChange"in e){e.targetChange;const s=(function(v){return v==="NO_CHANGE"?0:v==="ADD"?1:v==="REMOVE"?2:v==="CURRENT"?3:v==="RESET"?4:st(39313,{state:v})})(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],c=(function(v,x){return v.useProto3Json?(At(x===void 0||typeof x=="string",58123),Hn.fromBase64String(x||"")):(At(x===void 0||x instanceof Buffer||x instanceof Uint8Array,16193),Hn.fromUint8Array(x||new Uint8Array))})(n,e.targetChange.resumeToken),d=e.targetChange.cause,f=d&&(function(v){const x=v.code===void 0?de.UNKNOWN:_x(v.code);return new Oe(x,v.message||"")})(d);t=new wx(s,a,c,f||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const a=hf(n,s.document.name),c=Fs(s.document.updateTime),d=s.document.createTime?Fs(s.document.createTime):lt.min(),f=new br({mapValue:{fields:s.document.fields}}),m=ar.newFoundDocument(a,c,d,f),v=s.targetIds||[],x=s.removedTargetIds||[];t=new ju(v,x,m.key,m)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const a=hf(n,s.document),c=s.readTime?Fs(s.readTime):lt.min(),d=ar.newNoDocument(a,c),f=s.removedTargetIds||[];t=new ju([],f,d.key,d)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const a=hf(n,s.document),c=s.removedTargetIds||[];t=new ju([],c,a,null)}else{if(!("filter"in e))return st(11601,{At:e});{e.filter;const s=e.filter;s.targetId;const{count:a=0,unchangedNames:c}=s,d=new VC(a,c),f=s.targetId;t=new xx(f,d)}}return t}function HC(n,e){let t;if(e instanceof lc)t={update:Vv(n,e.key,e.value)};else if(e instanceof Cp)t={delete:Bf(n,e.key)};else if(e instanceof ca)t={update:Vv(n,e.key,e.data),updateMask:nP(e.fieldMask)};else{if(!(e instanceof kC))return st(16599,{Rt:e.type});t={verify:Bf(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((s=>(function(c,d){const f=d.transform;if(f instanceof Xl)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(f instanceof Zl)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:f.elements}};if(f instanceof ec)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:f.elements}};if(f instanceof Qu)return{fieldPath:d.field.canonicalString(),increment:f.Ee};throw st(20930,{transform:d.transform})})(0,s)))),e.precondition.isNone||(t.currentDocument=(function(a,c){return c.updateTime!==void 0?{updateTime:WC(a,c.updateTime)}:c.exists!==void 0?{exists:c.exists}:st(27497)})(n,e.precondition)),t}function KC(n,e){return n&&n.length>0?(At(e!==void 0,14353),n.map((t=>(function(a,c){let d=a.updateTime?Fs(a.updateTime):Fs(c);return d.isEqual(lt.min())&&(d=Fs(c)),new RC(d,a.transformResults||[])})(t,e)))):[]}function QC(n,e){return{documents:[Sx(n,e.path)]}}function YC(n,e){const t={structuredQuery:{}},s=e.path;let a;e.collectionGroup!==null?(a=s,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=s.popLast(),t.structuredQuery.from=[{collectionId:s.lastSegment()}]),t.parent=Sx(n,a);const c=(function(v){if(v.length!==0)return Cx(Es.create(v,"and"))})(e.filters);c&&(t.structuredQuery.where=c);const d=(function(v){if(v.length!==0)return v.map((x=>(function(b){return{field:bo(b.field),direction:ZC(b.dir)}})(x)))})(e.orderBy);d&&(t.structuredQuery.orderBy=d);const f=Uf(n,e.limit);return f!==null&&(t.structuredQuery.limit=f),e.startAt&&(t.structuredQuery.startAt=(function(v){return{before:v.inclusive,values:v.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(v){return{before:!v.inclusive,values:v.position}})(e.endAt)),{Vt:t,parent:a}}function JC(n){let e=GC(n.parent);const t=n.structuredQuery,s=t.from?t.from.length:0;let a=null;if(s>0){At(s===1,65062);const x=t.from[0];x.allDescendants?a=x.collectionId:e=e.child(x.collectionId)}let c=[];t.where&&(c=(function(S){const b=Ix(S);return b instanceof Es&&nx(b)?b.getFilters():[b]})(t.where));let d=[];t.orderBy&&(d=(function(S){return S.map((b=>(function(Y){return new Jl(Io(Y.field),(function(V){switch(V){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(Y.direction))})(b)))})(t.orderBy));let f=null;t.limit&&(f=(function(S){let b;return b=typeof S=="object"?S.value:S,ud(b)?null:b})(t.limit));let m=null;t.startAt&&(m=(function(S){const b=!!S.before,M=S.values||[];return new Hu(M,b)})(t.startAt));let v=null;return t.endAt&&(v=(function(S){const b=!S.before,M=S.values||[];return new Hu(M,b)})(t.endAt)),gC(e,a,d,c,f,"F",m,v)}function XC(n,e){const t=(function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return st(28987,{purpose:a})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Ix(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const s=Io(t.unaryFilter.field);return fn.create(s,"==",{doubleValue:NaN});case"IS_NULL":const a=Io(t.unaryFilter.field);return fn.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const c=Io(t.unaryFilter.field);return fn.create(c,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=Io(t.unaryFilter.field);return fn.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return st(61313);default:return st(60726)}})(n):n.fieldFilter!==void 0?(function(t){return fn.create(Io(t.fieldFilter.field),(function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return st(58110);default:return st(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Es.create(t.compositeFilter.filters.map((s=>Ix(s))),(function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return st(1026)}})(t.compositeFilter.op))})(n):st(30097,{filter:n})}function ZC(n){return UC[n]}function eP(n){return zC[n]}function tP(n){return BC[n]}function bo(n){return{fieldPath:n.canonicalString()}}function Io(n){return qn.fromServerFormat(n.fieldPath)}function Cx(n){return n instanceof fn?(function(t){if(t.op==="=="){if(Tv(t.value))return{unaryFilter:{field:bo(t.field),op:"IS_NAN"}};if(Ev(t.value))return{unaryFilter:{field:bo(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Tv(t.value))return{unaryFilter:{field:bo(t.field),op:"IS_NOT_NAN"}};if(Ev(t.value))return{unaryFilter:{field:bo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:bo(t.field),op:eP(t.op),value:t.value}}})(n):n instanceof Es?(function(t){const s=t.getFilters().map((a=>Cx(a)));return s.length===1?s[0]:{compositeFilter:{op:tP(t.op),filters:s}}})(n):st(54877,{filter:n})}function nP(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function Px(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wi{constructor(e,t,s,a,c=lt.min(),d=lt.min(),f=Hn.EMPTY_BYTE_STRING,m=null){this.target=e,this.targetId=t,this.purpose=s,this.sequenceNumber=a,this.snapshotVersion=c,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=f,this.expectedCount=m}withSequenceNumber(e){return new Wi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Wi(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Wi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Wi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rP{constructor(e){this.gt=e}}function sP(n){const e=JC({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Ku(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iP{constructor(){this.Dn=new aP}addToCollectionParentIndex(e,t){return this.Dn.add(t),fe.resolve()}getCollectionParents(e,t){return fe.resolve(this.Dn.getEntries(t))}addFieldIndex(e,t){return fe.resolve()}deleteFieldIndex(e,t){return fe.resolve()}deleteAllFieldIndexes(e){return fe.resolve()}createTargetIndexes(e,t){return fe.resolve()}getDocumentsMatchingTarget(e,t){return fe.resolve(null)}getIndexType(e,t){return fe.resolve(0)}getFieldIndexes(e,t){return fe.resolve([])}getNextCollectionGroupToUpdate(e){return fe.resolve(null)}getMinOffset(e,t){return fe.resolve(Xi.min())}getMinOffsetFromCollectionGroup(e,t){return fe.resolve(Xi.min())}updateCollectionGroup(e,t,s){return fe.resolve()}updateIndexEntries(e,t){return fe.resolve()}}class aP{constructor(){this.index={}}add(e){const t=e.lastSegment(),s=e.popLast(),a=this.index[t]||new bn(Mt.comparator),c=!a.has(s);return this.index[t]=a.add(s),c}has(e){const t=e.lastSegment(),s=e.popLast(),a=this.index[t];return a&&a.has(s)}getEntries(e){return(this.index[e]||new bn(Mt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mv={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Nx=41943040;class Sr{static withCacheSize(e){return new Sr(e,Sr.DEFAULT_COLLECTION_PERCENTILE,Sr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Sr.DEFAULT_COLLECTION_PERCENTILE=10,Sr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Sr.DEFAULT=new Sr(Nx,Sr.DEFAULT_COLLECTION_PERCENTILE,Sr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Sr.DISABLED=new Sr(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mo{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new Mo(0)}static ur(){return new Mo(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ov="LruGarbageCollector",oP=1048576;function Fv([n,e],[t,s]){const a=ft(n,t);return a===0?ft(e,s):a}class lP{constructor(e){this.Tr=e,this.buffer=new bn(Fv),this.Ir=0}dr(){return++this.Ir}Er(e){const t=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(t);else{const s=this.buffer.last();Fv(t,s)<0&&(this.buffer=this.buffer.delete(s).add(t))}}get maxValue(){return this.buffer.last()[0]}}class cP{constructor(e,t,s){this.garbageCollector=e,this.asyncQueue=t,this.localStore=s,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){Ue(Ov,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Ko(t)?Ue(Ov,"Ignoring IndexedDB error during garbage collection: ",t):await Ho(t)}await this.Rr(3e5)}))}}class uP{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.mr(e).next((s=>Math.floor(t/100*s)))}nthSequenceNumber(e,t){if(t===0)return fe.resolve(cd.ue);const s=new lP(t);return this.Vr.forEachTarget(e,(a=>s.Er(a.sequenceNumber))).next((()=>this.Vr.gr(e,(a=>s.Er(a))))).next((()=>s.maxValue))}removeTargets(e,t,s){return this.Vr.removeTargets(e,t,s)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Ue("LruGarbageCollector","Garbage collection skipped; disabled"),fe.resolve(Mv)):this.getCacheSize(e).next((s=>s<this.params.cacheSizeCollectionThreshold?(Ue("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Mv):this.pr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,t){let s,a,c,d,f,m,v;const x=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((S=>(S>this.params.maximumSequenceNumbersToCollect?(Ue("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${S}`),a=this.params.maximumSequenceNumbersToCollect):a=S,d=Date.now(),this.nthSequenceNumber(e,a)))).next((S=>(s=S,f=Date.now(),this.removeTargets(e,s,t)))).next((S=>(c=S,m=Date.now(),this.removeOrphanedDocuments(e,s)))).next((S=>(v=Date.now(),To()<=yt.DEBUG&&Ue("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-x}ms
	Determined least recently used ${a} in `+(f-d)+`ms
	Removed ${c} targets in `+(m-f)+`ms
	Removed ${S} documents in `+(v-m)+`ms
Total Duration: ${v-x}ms`),fe.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:c,documentsRemoved:S}))))}}function dP(n,e){return new uP(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hP{constructor(){this.changes=new Fa((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ar.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const s=this.changes.get(t);return s!==void 0?fe.resolve(s):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fP{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pP{constructor(e,t,s,a){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=s,this.indexManager=a}getDocument(e,t){let s=null;return this.documentOverlayCache.getOverlay(e,t).next((a=>(s=a,this.remoteDocumentCache.getEntry(e,t)))).next((a=>(s!==null&&zl(s.mutation,a,Or.empty(),Bt.now()),a)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((s=>this.getLocalViewOfDocuments(e,s,vt()).next((()=>s))))}getLocalViewOfDocuments(e,t,s=vt()){const a=Pa();return this.populateOverlays(e,a,t).next((()=>this.computeViews(e,t,a,s).next((c=>{let d=jl();return c.forEach(((f,m)=>{d=d.insert(f,m.overlayedDocument)})),d}))))}getOverlayedDocuments(e,t){const s=Pa();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,vt())))}populateOverlays(e,t,s){const a=[];return s.forEach((c=>{t.has(c)||a.push(c)})),this.documentOverlayCache.getOverlays(e,a).next((c=>{c.forEach(((d,f)=>{t.set(d,f)}))}))}computeViews(e,t,s,a){let c=gi();const d=Ul(),f=(function(){return Ul()})();return t.forEach(((m,v)=>{const x=s.get(v.key);a.has(v.key)&&(x===void 0||x.mutation instanceof ca)?c=c.insert(v.key,v):x!==void 0?(d.set(v.key,x.mutation.getFieldMask()),zl(x.mutation,v,x.mutation.getFieldMask(),Bt.now())):d.set(v.key,Or.empty())})),this.recalculateAndSaveOverlays(e,c).next((m=>(m.forEach(((v,x)=>d.set(v,x))),t.forEach(((v,x)=>{var S;return f.set(v,new fP(x,(S=d.get(v))!==null&&S!==void 0?S:null))})),f)))}recalculateAndSaveOverlays(e,t){const s=Ul();let a=new Kt(((d,f)=>d-f)),c=vt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((d=>{for(const f of d)f.keys().forEach((m=>{const v=t.get(m);if(v===null)return;let x=s.get(m)||Or.empty();x=f.applyToLocalView(v,x),s.set(m,x);const S=(a.get(f.batchId)||vt()).add(m);a=a.insert(f.batchId,S)}))})).next((()=>{const d=[],f=a.getReverseIterator();for(;f.hasNext();){const m=f.getNext(),v=m.key,x=m.value,S=dx();x.forEach((b=>{if(!c.has(b)){const M=yx(t.get(b),s.get(b));M!==null&&S.set(b,M),c=c.add(b)}})),d.push(this.documentOverlayCache.saveOverlays(e,v,S))}return fe.waitFor(d)})).next((()=>s))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((s=>this.recalculateAndSaveOverlays(e,s)))}getDocumentsMatchingQuery(e,t,s,a){return(function(d){return Ze.isDocumentKey(d.path)&&d.collectionGroup===null&&d.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):ax(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,s,a):this.getDocumentsMatchingCollectionQuery(e,t,s,a)}getNextDocuments(e,t,s,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,s,a).next((c=>{const d=a-c.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,s.largestBatchId,a-c.size):fe.resolve(Pa());let f=Hl,m=c;return d.next((v=>fe.forEach(v,((x,S)=>(f<S.largestBatchId&&(f=S.largestBatchId),c.get(x)?fe.resolve():this.remoteDocumentCache.getEntry(e,x).next((b=>{m=m.insert(x,b)}))))).next((()=>this.populateOverlays(e,v,c))).next((()=>this.computeViews(e,m,v,vt()))).next((x=>({batchId:f,changes:ux(x)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ze(t)).next((s=>{let a=jl();return s.isFoundDocument()&&(a=a.insert(s.key,s)),a}))}getDocumentsMatchingCollectionGroupQuery(e,t,s,a){const c=t.collectionGroup;let d=jl();return this.indexManager.getCollectionParents(e,c).next((f=>fe.forEach(f,(m=>{const v=(function(S,b){return new Qo(b,null,S.explicitOrderBy.slice(),S.filters.slice(),S.limit,S.limitType,S.startAt,S.endAt)})(t,m.child(c));return this.getDocumentsMatchingCollectionQuery(e,v,s,a).next((x=>{x.forEach(((S,b)=>{d=d.insert(S,b)}))}))})).next((()=>d))))}getDocumentsMatchingCollectionQuery(e,t,s,a){let c;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,s.largestBatchId).next((d=>(c=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,s,c,a)))).next((d=>{c.forEach(((m,v)=>{const x=v.getKey();d.get(x)===null&&(d=d.insert(x,ar.newInvalidDocument(x)))}));let f=jl();return d.forEach(((m,v)=>{const x=c.get(m);x!==void 0&&zl(x.mutation,v,Or.empty(),Bt.now()),pd(t,v)&&(f=f.insert(m,v))})),f}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mP{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,t){return fe.resolve(this.Br.get(t))}saveBundleMetadata(e,t){return this.Br.set(t.id,(function(a){return{id:a.id,version:a.version,createTime:Fs(a.createTime)}})(t)),fe.resolve()}getNamedQuery(e,t){return fe.resolve(this.Lr.get(t))}saveNamedQuery(e,t){return this.Lr.set(t.name,(function(a){return{name:a.name,query:sP(a.bundledQuery),readTime:Fs(a.readTime)}})(t)),fe.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gP{constructor(){this.overlays=new Kt(Ze.comparator),this.kr=new Map}getOverlay(e,t){return fe.resolve(this.overlays.get(t))}getOverlays(e,t){const s=Pa();return fe.forEach(t,(a=>this.getOverlay(e,a).next((c=>{c!==null&&s.set(a,c)})))).next((()=>s))}saveOverlays(e,t,s){return s.forEach(((a,c)=>{this.wt(e,t,c)})),fe.resolve()}removeOverlaysForBatchId(e,t,s){const a=this.kr.get(s);return a!==void 0&&(a.forEach((c=>this.overlays=this.overlays.remove(c))),this.kr.delete(s)),fe.resolve()}getOverlaysForCollection(e,t,s){const a=Pa(),c=t.length+1,d=new Ze(t.child("")),f=this.overlays.getIteratorFrom(d);for(;f.hasNext();){const m=f.getNext().value,v=m.getKey();if(!t.isPrefixOf(v.path))break;v.path.length===c&&m.largestBatchId>s&&a.set(m.getKey(),m)}return fe.resolve(a)}getOverlaysForCollectionGroup(e,t,s,a){let c=new Kt(((v,x)=>v-x));const d=this.overlays.getIterator();for(;d.hasNext();){const v=d.getNext().value;if(v.getKey().getCollectionGroup()===t&&v.largestBatchId>s){let x=c.get(v.largestBatchId);x===null&&(x=Pa(),c=c.insert(v.largestBatchId,x)),x.set(v.getKey(),v)}}const f=Pa(),m=c.getIterator();for(;m.hasNext()&&(m.getNext().value.forEach(((v,x)=>f.set(v,x))),!(f.size()>=a)););return fe.resolve(f)}wt(e,t,s){const a=this.overlays.get(s.key);if(a!==null){const d=this.kr.get(a.largestBatchId).delete(s.key);this.kr.set(a.largestBatchId,d)}this.overlays=this.overlays.insert(s.key,new LC(t,s));let c=this.kr.get(t);c===void 0&&(c=vt(),this.kr.set(t,c)),this.kr.set(t,c.add(s.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yP{constructor(){this.sessionToken=Hn.EMPTY_BYTE_STRING}getSessionToken(e){return fe.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,fe.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ap{constructor(){this.qr=new bn(Mn.Qr),this.$r=new bn(Mn.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,t){const s=new Mn(e,t);this.qr=this.qr.add(s),this.$r=this.$r.add(s)}Kr(e,t){e.forEach((s=>this.addReference(s,t)))}removeReference(e,t){this.Wr(new Mn(e,t))}Gr(e,t){e.forEach((s=>this.removeReference(s,t)))}zr(e){const t=new Ze(new Mt([])),s=new Mn(t,e),a=new Mn(t,e+1),c=[];return this.$r.forEachInRange([s,a],(d=>{this.Wr(d),c.push(d.key)})),c}jr(){this.qr.forEach((e=>this.Wr(e)))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const t=new Ze(new Mt([])),s=new Mn(t,e),a=new Mn(t,e+1);let c=vt();return this.$r.forEachInRange([s,a],(d=>{c=c.add(d.key)})),c}containsKey(e){const t=new Mn(e,0),s=this.qr.firstAfterOrEqual(t);return s!==null&&e.isEqual(s.key)}}class Mn{constructor(e,t){this.key=e,this.Hr=t}static Qr(e,t){return Ze.comparator(e.key,t.key)||ft(e.Hr,t.Hr)}static Ur(e,t){return ft(e.Hr,t.Hr)||Ze.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vP{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.er=1,this.Yr=new bn(Mn.Qr)}checkEmpty(e){return fe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,s,a){const c=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new DC(c,t,s,a);this.mutationQueue.push(d);for(const f of a)this.Yr=this.Yr.add(new Mn(f.key,c)),this.indexManager.addToCollectionParentIndex(e,f.key.path.popLast());return fe.resolve(d)}lookupMutationBatch(e,t){return fe.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const s=t+1,a=this.Xr(s),c=a<0?0:a;return fe.resolve(this.mutationQueue.length>c?this.mutationQueue[c]:null)}getHighestUnacknowledgedBatchId(){return fe.resolve(this.mutationQueue.length===0?wp:this.er-1)}getAllMutationBatches(e){return fe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const s=new Mn(t,0),a=new Mn(t,Number.POSITIVE_INFINITY),c=[];return this.Yr.forEachInRange([s,a],(d=>{const f=this.Zr(d.Hr);c.push(f)})),fe.resolve(c)}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new bn(ft);return t.forEach((a=>{const c=new Mn(a,0),d=new Mn(a,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([c,d],(f=>{s=s.add(f.Hr)}))})),fe.resolve(this.ei(s))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,a=s.length+1;let c=s;Ze.isDocumentKey(c)||(c=c.child(""));const d=new Mn(new Ze(c),0);let f=new bn(ft);return this.Yr.forEachWhile((m=>{const v=m.key.path;return!!s.isPrefixOf(v)&&(v.length===a&&(f=f.add(m.Hr)),!0)}),d),fe.resolve(this.ei(f))}ei(e){const t=[];return e.forEach((s=>{const a=this.Zr(s);a!==null&&t.push(a)})),t}removeMutationBatch(e,t){At(this.ti(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let s=this.Yr;return fe.forEach(t.mutations,(a=>{const c=new Mn(a.key,t.batchId);return s=s.delete(c),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((()=>{this.Yr=s}))}rr(e){}containsKey(e,t){const s=new Mn(t,0),a=this.Yr.firstAfterOrEqual(s);return fe.resolve(t.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,fe.resolve()}ti(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _P{constructor(e){this.ni=e,this.docs=(function(){return new Kt(Ze.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const s=t.key,a=this.docs.get(s),c=a?a.size:0,d=this.ni(t);return this.docs=this.docs.insert(s,{document:t.mutableCopy(),size:d}),this.size+=d-c,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const s=this.docs.get(t);return fe.resolve(s?s.document.mutableCopy():ar.newInvalidDocument(t))}getEntries(e,t){let s=gi();return t.forEach((a=>{const c=this.docs.get(a);s=s.insert(a,c?c.document.mutableCopy():ar.newInvalidDocument(a))})),fe.resolve(s)}getDocumentsMatchingQuery(e,t,s,a){let c=gi();const d=t.path,f=new Ze(d.child("__id-9223372036854775808__")),m=this.docs.getIteratorFrom(f);for(;m.hasNext();){const{key:v,value:{document:x}}=m.getNext();if(!d.isPrefixOf(v.path))break;v.path.length>d.length+1||KI(HI(x),s)<=0||(a.has(x.key)||pd(t,x))&&(c=c.insert(x.key,x.mutableCopy()))}return fe.resolve(c)}getAllFromCollectionGroup(e,t,s,a){st(9500)}ri(e,t){return fe.forEach(this.docs,(s=>t(s)))}newChangeBuffer(e){return new xP(this)}getSize(e){return fe.resolve(this.size)}}class xP extends hP{constructor(e){super(),this.Or=e}applyChanges(e){const t=[];return this.changes.forEach(((s,a)=>{a.isValidDocument()?t.push(this.Or.addEntry(e,a)):this.Or.removeEntry(s)})),fe.waitFor(t)}getFromCache(e,t){return this.Or.getEntry(e,t)}getAllFromCache(e,t){return this.Or.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wP{constructor(e){this.persistence=e,this.ii=new Fa((t=>Sp(t)),bp),this.lastRemoteSnapshotVersion=lt.min(),this.highestTargetId=0,this.si=0,this.oi=new Ap,this.targetCount=0,this._i=Mo.ar()}forEachTarget(e,t){return this.ii.forEach(((s,a)=>t(a))),fe.resolve()}getLastRemoteSnapshotVersion(e){return fe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return fe.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),fe.resolve(this.highestTargetId)}setTargetsMetadata(e,t,s){return s&&(this.lastRemoteSnapshotVersion=s),t>this.si&&(this.si=t),fe.resolve()}hr(e){this.ii.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this._i=new Mo(t),this.highestTargetId=t),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,t){return this.hr(t),this.targetCount+=1,fe.resolve()}updateTargetData(e,t){return this.hr(t),fe.resolve()}removeTargetData(e,t){return this.ii.delete(t.target),this.oi.zr(t.targetId),this.targetCount-=1,fe.resolve()}removeTargets(e,t,s){let a=0;const c=[];return this.ii.forEach(((d,f)=>{f.sequenceNumber<=t&&s.get(f.targetId)===null&&(this.ii.delete(d),c.push(this.removeMatchingKeysForTargetId(e,f.targetId)),a++)})),fe.waitFor(c).next((()=>a))}getTargetCount(e){return fe.resolve(this.targetCount)}getTargetData(e,t){const s=this.ii.get(t)||null;return fe.resolve(s)}addMatchingKeys(e,t,s){return this.oi.Kr(t,s),fe.resolve()}removeMatchingKeys(e,t,s){this.oi.Gr(t,s);const a=this.persistence.referenceDelegate,c=[];return a&&t.forEach((d=>{c.push(a.markPotentiallyOrphaned(e,d))})),fe.waitFor(c)}removeMatchingKeysForTargetId(e,t){return this.oi.zr(t),fe.resolve()}getMatchingKeysForTargetId(e,t){const s=this.oi.Jr(t);return fe.resolve(s)}containsKey(e,t){return fe.resolve(this.oi.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rx{constructor(e,t){this.ai={},this.overlays={},this.ui=new cd(0),this.ci=!1,this.ci=!0,this.li=new yP,this.referenceDelegate=e(this),this.hi=new wP(this),this.indexManager=new iP,this.remoteDocumentCache=(function(a){return new _P(a)})((s=>this.referenceDelegate.Pi(s))),this.serializer=new rP(t),this.Ti=new mP(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new gP,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let s=this.ai[e.toKey()];return s||(s=new vP(t,this.referenceDelegate),this.ai[e.toKey()]=s),s}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,t,s){Ue("MemoryPersistence","Starting transaction:",e);const a=new EP(this.ui.next());return this.referenceDelegate.Ii(),s(a).next((c=>this.referenceDelegate.di(a).next((()=>c)))).toPromise().then((c=>(a.raiseOnCommittedEvent(),c)))}Ei(e,t){return fe.or(Object.values(this.ai).map((s=>()=>s.containsKey(e,t))))}}class EP extends YI{constructor(e){super(),this.currentSequenceNumber=e}}class jp{constructor(e){this.persistence=e,this.Ai=new Ap,this.Ri=null}static Vi(e){return new jp(e)}get mi(){if(this.Ri)return this.Ri;throw st(60996)}addReference(e,t,s){return this.Ai.addReference(s,t),this.mi.delete(s.toString()),fe.resolve()}removeReference(e,t,s){return this.Ai.removeReference(s,t),this.mi.add(s.toString()),fe.resolve()}markPotentiallyOrphaned(e,t){return this.mi.add(t.toString()),fe.resolve()}removeTarget(e,t){this.Ai.zr(t.targetId).forEach((a=>this.mi.add(a.toString())));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,t.targetId).next((a=>{a.forEach((c=>this.mi.add(c.toString())))})).next((()=>s.removeTargetData(e,t)))}Ii(){this.Ri=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return fe.forEach(this.mi,(s=>{const a=Ze.fromPath(s);return this.fi(e,a).next((c=>{c||t.removeEntry(a,lt.min())}))})).next((()=>(this.Ri=null,t.apply(e))))}updateLimboDocument(e,t){return this.fi(e,t).next((s=>{s?this.mi.delete(t.toString()):this.mi.add(t.toString())}))}Pi(e){return 0}fi(e,t){return fe.or([()=>fe.resolve(this.Ai.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class Ju{constructor(e,t){this.persistence=e,this.gi=new Fa((s=>ZI(s.path)),((s,a)=>s.isEqual(a))),this.garbageCollector=dP(this,t)}static Vi(e,t){return new Ju(e,t)}Ii(){}di(e){return fe.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}mr(e){const t=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next((s=>t.next((a=>s+a))))}yr(e){let t=0;return this.gr(e,(s=>{t++})).next((()=>t))}gr(e,t){return fe.forEach(this.gi,((s,a)=>this.Sr(e,s,a).next((c=>c?fe.resolve():t(a)))))}removeTargets(e,t,s){return this.persistence.getTargetCache().removeTargets(e,t,s)}removeOrphanedDocuments(e,t){let s=0;const a=this.persistence.getRemoteDocumentCache(),c=a.newChangeBuffer();return a.ri(e,(d=>this.Sr(e,d,t).next((f=>{f||(s++,c.removeEntry(d,lt.min()))})))).next((()=>c.apply(e))).next((()=>s))}markPotentiallyOrphaned(e,t){return this.gi.set(t,e.currentSequenceNumber),fe.resolve()}removeTarget(e,t){const s=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,s)}addReference(e,t,s){return this.gi.set(s,e.currentSequenceNumber),fe.resolve()}removeReference(e,t,s){return this.gi.set(s,e.currentSequenceNumber),fe.resolve()}updateLimboDocument(e,t){return this.gi.set(t,e.currentSequenceNumber),fe.resolve()}Pi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Nu(e.data.value)),t}Sr(e,t,s){return fe.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const a=this.gi.get(t);return fe.resolve(a!==void 0&&a>s)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kp{constructor(e,t,s,a){this.targetId=e,this.fromCache=t,this.Is=s,this.ds=a}static Es(e,t){let s=vt(),a=vt();for(const c of t.docChanges)switch(c.type){case 0:s=s.add(c.doc.key);break;case 1:a=a.add(c.doc.key)}return new kp(e,t.fromCache,s,a)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TP{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SP{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=(function(){return ZT()?8:JI(or())>0?6:4})()}initialize(e,t){this.gs=e,this.indexManager=t,this.As=!0}getDocumentsMatchingQuery(e,t,s,a){const c={result:null};return this.ps(e,t).next((d=>{c.result=d})).next((()=>{if(!c.result)return this.ys(e,t,a,s).next((d=>{c.result=d}))})).next((()=>{if(c.result)return;const d=new TP;return this.ws(e,t,d).next((f=>{if(c.result=f,this.Rs)return this.Ss(e,t,d,f.size)}))})).next((()=>c.result))}Ss(e,t,s,a){return s.documentReadCount<this.Vs?(To()<=yt.DEBUG&&Ue("QueryEngine","SDK will not create cache indexes for query:",So(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),fe.resolve()):(To()<=yt.DEBUG&&Ue("QueryEngine","Query:",So(t),"scans",s.documentReadCount,"local documents and returns",a,"documents as results."),s.documentReadCount>this.fs*a?(To()<=yt.DEBUG&&Ue("QueryEngine","The SDK decides to create cache indexes for query:",So(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Os(t))):fe.resolve())}ps(e,t){if(Cv(t))return fe.resolve(null);let s=Os(t);return this.indexManager.getIndexType(e,s).next((a=>a===0?null:(t.limit!==null&&a===1&&(t=Ku(t,null,"F"),s=Os(t)),this.indexManager.getDocumentsMatchingTarget(e,s).next((c=>{const d=vt(...c);return this.gs.getDocuments(e,d).next((f=>this.indexManager.getMinOffset(e,s).next((m=>{const v=this.bs(t,f);return this.Ds(t,v,d,m.readTime)?this.ps(e,Ku(t,null,"F")):this.vs(e,v,t,m)}))))})))))}ys(e,t,s,a){return Cv(t)||a.isEqual(lt.min())?fe.resolve(null):this.gs.getDocuments(e,s).next((c=>{const d=this.bs(t,c);return this.Ds(t,d,s,a)?fe.resolve(null):(To()<=yt.DEBUG&&Ue("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),So(t)),this.vs(e,d,t,qI(a,Hl)).next((f=>f)))}))}bs(e,t){let s=new bn(lx(e));return t.forEach(((a,c)=>{pd(e,c)&&(s=s.add(c))})),s}Ds(e,t,s,a){if(e.limit===null)return!1;if(s.size!==t.size)return!0;const c=e.limitType==="F"?t.last():t.first();return!!c&&(c.hasPendingWrites||c.version.compareTo(a)>0)}ws(e,t,s){return To()<=yt.DEBUG&&Ue("QueryEngine","Using full collection scan to execute query:",So(t)),this.gs.getDocumentsMatchingQuery(e,t,Xi.min(),s)}vs(e,t,s,a){return this.gs.getDocumentsMatchingQuery(e,s,a).next((c=>(t.forEach((d=>{c=c.insert(d.key,d)})),c)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dp="LocalStore",bP=3e8;class IP{constructor(e,t,s,a){this.persistence=e,this.Cs=t,this.serializer=a,this.Fs=new Kt(ft),this.Ms=new Fa((c=>Sp(c)),bp),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(s)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new pP(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Fs)))}}function CP(n,e,t,s){return new IP(n,e,t,s)}async function Ax(n,e){const t=ct(n);return await t.persistence.runTransaction("Handle user change","readonly",(s=>{let a;return t.mutationQueue.getAllMutationBatches(s).next((c=>(a=c,t.Ns(e),t.mutationQueue.getAllMutationBatches(s)))).next((c=>{const d=[],f=[];let m=vt();for(const v of a){d.push(v.batchId);for(const x of v.mutations)m=m.add(x.key)}for(const v of c){f.push(v.batchId);for(const x of v.mutations)m=m.add(x.key)}return t.localDocuments.getDocuments(s,m).next((v=>({Bs:v,removedBatchIds:d,addedBatchIds:f})))}))}))}function PP(n,e){const t=ct(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(s=>{const a=e.batch.keys(),c=t.Os.newChangeBuffer({trackRemovals:!0});return(function(f,m,v,x){const S=v.batch,b=S.keys();let M=fe.resolve();return b.forEach((Y=>{M=M.next((()=>x.getEntry(m,Y))).next((z=>{const V=v.docVersions.get(Y);At(V!==null,48541),z.version.compareTo(V)<0&&(S.applyToRemoteDocument(z,v),z.isValidDocument()&&(z.setReadTime(v.commitVersion),x.addEntry(z)))}))})),M.next((()=>f.mutationQueue.removeMutationBatch(m,S)))})(t,s,e,c).next((()=>c.apply(s))).next((()=>t.mutationQueue.performConsistencyCheck(s))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(s,a,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,(function(f){let m=vt();for(let v=0;v<f.mutationResults.length;++v)f.mutationResults[v].transformResults.length>0&&(m=m.add(f.batch.mutations[v].key));return m})(e)))).next((()=>t.localDocuments.getDocuments(s,a)))}))}function jx(n){const e=ct(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.hi.getLastRemoteSnapshotVersion(t)))}function NP(n,e){const t=ct(n),s=e.snapshotVersion;let a=t.Fs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(c=>{const d=t.Os.newChangeBuffer({trackRemovals:!0});a=t.Fs;const f=[];e.targetChanges.forEach(((x,S)=>{const b=a.get(S);if(!b)return;f.push(t.hi.removeMatchingKeys(c,x.removedDocuments,S).next((()=>t.hi.addMatchingKeys(c,x.addedDocuments,S))));let M=b.withSequenceNumber(c.currentSequenceNumber);e.targetMismatches.get(S)!==null?M=M.withResumeToken(Hn.EMPTY_BYTE_STRING,lt.min()).withLastLimboFreeSnapshotVersion(lt.min()):x.resumeToken.approximateByteSize()>0&&(M=M.withResumeToken(x.resumeToken,s)),a=a.insert(S,M),(function(z,V,te){return z.resumeToken.approximateByteSize()===0||V.snapshotVersion.toMicroseconds()-z.snapshotVersion.toMicroseconds()>=bP?!0:te.addedDocuments.size+te.modifiedDocuments.size+te.removedDocuments.size>0})(b,M,x)&&f.push(t.hi.updateTargetData(c,M))}));let m=gi(),v=vt();if(e.documentUpdates.forEach((x=>{e.resolvedLimboDocuments.has(x)&&f.push(t.persistence.referenceDelegate.updateLimboDocument(c,x))})),f.push(RP(c,d,e.documentUpdates).next((x=>{m=x.Ls,v=x.ks}))),!s.isEqual(lt.min())){const x=t.hi.getLastRemoteSnapshotVersion(c).next((S=>t.hi.setTargetsMetadata(c,c.currentSequenceNumber,s)));f.push(x)}return fe.waitFor(f).next((()=>d.apply(c))).next((()=>t.localDocuments.getLocalViewOfDocuments(c,m,v))).next((()=>m))})).then((c=>(t.Fs=a,c)))}function RP(n,e,t){let s=vt(),a=vt();return t.forEach((c=>s=s.add(c))),e.getEntries(n,s).next((c=>{let d=gi();return t.forEach(((f,m)=>{const v=c.get(f);m.isFoundDocument()!==v.isFoundDocument()&&(a=a.add(f)),m.isNoDocument()&&m.version.isEqual(lt.min())?(e.removeEntry(f,m.readTime),d=d.insert(f,m)):!v.isValidDocument()||m.version.compareTo(v.version)>0||m.version.compareTo(v.version)===0&&v.hasPendingWrites?(e.addEntry(m),d=d.insert(f,m)):Ue(Dp,"Ignoring outdated watch update for ",f,". Current version:",v.version," Watch version:",m.version)})),{Ls:d,ks:a}}))}function AP(n,e){const t=ct(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(s=>(e===void 0&&(e=wp),t.mutationQueue.getNextMutationBatchAfterBatchId(s,e))))}function jP(n,e){const t=ct(n);return t.persistence.runTransaction("Allocate target","readwrite",(s=>{let a;return t.hi.getTargetData(s,e).next((c=>c?(a=c,fe.resolve(a)):t.hi.allocateTargetId(s).next((d=>(a=new Wi(e,d,"TargetPurposeListen",s.currentSequenceNumber),t.hi.addTargetData(s,a).next((()=>a)))))))})).then((s=>{const a=t.Fs.get(s.targetId);return(a===null||s.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(t.Fs=t.Fs.insert(s.targetId,s),t.Ms.set(e,s.targetId)),s}))}async function Wf(n,e,t){const s=ct(n),a=s.Fs.get(e),c=t?"readwrite":"readwrite-primary";try{t||await s.persistence.runTransaction("Release target",c,(d=>s.persistence.referenceDelegate.removeTarget(d,a)))}catch(d){if(!Ko(d))throw d;Ue(Dp,`Failed to update sequence numbers for target ${e}: ${d}`)}s.Fs=s.Fs.remove(e),s.Ms.delete(a.target)}function Uv(n,e,t){const s=ct(n);let a=lt.min(),c=vt();return s.persistence.runTransaction("Execute query","readwrite",(d=>(function(m,v,x){const S=ct(m),b=S.Ms.get(x);return b!==void 0?fe.resolve(S.Fs.get(b)):S.hi.getTargetData(v,x)})(s,d,Os(e)).next((f=>{if(f)return a=f.lastLimboFreeSnapshotVersion,s.hi.getMatchingKeysForTargetId(d,f.targetId).next((m=>{c=m}))})).next((()=>s.Cs.getDocumentsMatchingQuery(d,e,t?a:lt.min(),t?c:vt()))).next((f=>(kP(s,vC(e),f),{documents:f,qs:c})))))}function kP(n,e,t){let s=n.xs.get(e)||lt.min();t.forEach(((a,c)=>{c.readTime.compareTo(s)>0&&(s=c.readTime)})),n.xs.set(e,s)}class zv{constructor(){this.activeTargetIds=SC()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class DP{constructor(){this.Fo=new zv,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,s){}addLocalQueryTarget(e,t=!0){return t&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,t,s){this.Mo[e]=t}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new zv,Promise.resolve()}handleUserChange(e,t,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LP{xo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bv="ConnectivityMonitor";class $v{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){Ue(Bv,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){Ue(Bv,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wu=null;function Gf(){return wu===null?wu=(function(){return 268435456+Math.round(2147483648*Math.random())})():wu++,"0x"+wu.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ff="RestConnection",VP={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class MP{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.$o=t+"://"+e.host,this.Uo=`projects/${s}/databases/${a}`,this.Ko=this.databaseId.database===Gu?`project_id=${s}`:`project_id=${s}&database_id=${a}`}Wo(e,t,s,a,c){const d=Gf(),f=this.Go(e,t.toUriEncodedString());Ue(ff,`Sending RPC '${e}' ${d}:`,f,s);const m={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(m,a,c);const{host:v}=new URL(f),x=Bo(v);return this.jo(e,f,m,s,x).then((S=>(Ue(ff,`Received RPC '${e}' ${d}: `,S),S)),(S=>{throw Ji(ff,`RPC '${e}' ${d} failed with error: `,S,"url: ",f,"request:",s),S}))}Jo(e,t,s,a,c,d){return this.Wo(e,t,s,a,c)}zo(e,t,s){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+qo})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((a,c)=>e[c]=a)),s&&s.headers.forEach(((a,c)=>e[c]=a))}Go(e,t){const s=VP[e];return`${this.$o}/v1/${t}:${s}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OP{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sr="WebChannelConnection";class FP extends MP{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,t,s,a,c){const d=Gf();return new Promise(((f,m)=>{const v=new D0;v.setWithCredentials(!0),v.listenOnce(L0.COMPLETE,(()=>{try{switch(v.getLastErrorCode()){case Pu.NO_ERROR:const S=v.getResponseJson();Ue(sr,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(S)),f(S);break;case Pu.TIMEOUT:Ue(sr,`RPC '${e}' ${d} timed out`),m(new Oe(de.DEADLINE_EXCEEDED,"Request time out"));break;case Pu.HTTP_ERROR:const b=v.getStatus();if(Ue(sr,`RPC '${e}' ${d} failed with status:`,b,"response text:",v.getResponseText()),b>0){let M=v.getResponseJson();Array.isArray(M)&&(M=M[0]);const Y=M==null?void 0:M.error;if(Y&&Y.status&&Y.message){const z=(function(te){const be=te.toLowerCase().replace(/_/g,"-");return Object.values(de).indexOf(be)>=0?be:de.UNKNOWN})(Y.status);m(new Oe(z,Y.message))}else m(new Oe(de.UNKNOWN,"Server responded with status "+v.getStatus()))}else m(new Oe(de.UNAVAILABLE,"Connection failed."));break;default:st(9055,{c_:e,streamId:d,l_:v.getLastErrorCode(),h_:v.getLastError()})}}finally{Ue(sr,`RPC '${e}' ${d} completed.`)}}));const x=JSON.stringify(a);Ue(sr,`RPC '${e}' ${d} sending request:`,a),v.send(t,"POST",x,s,15)}))}P_(e,t,s){const a=Gf(),c=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=O0(),f=M0(),m={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},v=this.longPollingOptions.timeoutSeconds;v!==void 0&&(m.longPollingTimeout=Math.round(1e3*v)),this.useFetchStreams&&(m.useFetchStreams=!0),this.zo(m.initMessageHeaders,t,s),m.encodeInitMessageHeaders=!0;const x=c.join("");Ue(sr,`Creating RPC '${e}' stream ${a}: ${x}`,m);const S=d.createWebChannel(x,m);this.T_(S);let b=!1,M=!1;const Y=new OP({Ho:V=>{M?Ue(sr,`Not sending because RPC '${e}' stream ${a} is closed:`,V):(b||(Ue(sr,`Opening RPC '${e}' stream ${a} transport.`),S.open(),b=!0),Ue(sr,`RPC '${e}' stream ${a} sending:`,V),S.send(V))},Yo:()=>S.close()}),z=(V,te,be)=>{V.listen(te,(we=>{try{be(we)}catch(ge){setTimeout((()=>{throw ge}),0)}}))};return z(S,Al.EventType.OPEN,(()=>{M||(Ue(sr,`RPC '${e}' stream ${a} transport opened.`),Y.s_())})),z(S,Al.EventType.CLOSE,(()=>{M||(M=!0,Ue(sr,`RPC '${e}' stream ${a} transport closed`),Y.__(),this.I_(S))})),z(S,Al.EventType.ERROR,(V=>{M||(M=!0,Ji(sr,`RPC '${e}' stream ${a} transport errored. Name:`,V.name,"Message:",V.message),Y.__(new Oe(de.UNAVAILABLE,"The operation could not be completed")))})),z(S,Al.EventType.MESSAGE,(V=>{var te;if(!M){const be=V.data[0];At(!!be,16349);const we=be,ge=(we==null?void 0:we.error)||((te=we[0])===null||te===void 0?void 0:te.error);if(ge){Ue(sr,`RPC '${e}' stream ${a} received error:`,ge);const ie=ge.status;let Ee=(function(C){const O=hn[C];if(O!==void 0)return _x(O)})(ie),D=ge.message;Ee===void 0&&(Ee=de.INTERNAL,D="Unknown error status: "+ie+" with message "+ge.message),M=!0,Y.__(new Oe(Ee,D)),S.close()}else Ue(sr,`RPC '${e}' stream ${a} received:`,be),Y.a_(be)}})),z(f,V0.STAT_EVENT,(V=>{V.stat===kf.PROXY?Ue(sr,`RPC '${e}' stream ${a} detected buffering proxy`):V.stat===kf.NOPROXY&&Ue(sr,`RPC '${e}' stream ${a} detected no buffering proxy`)})),setTimeout((()=>{Y.o_()}),0),Y}terminate(){this.u_.forEach((e=>e.close())),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter((t=>t===e))}}function pf(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vd(n){return new $C(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kx{constructor(e,t,s=1e3,a=1.5,c=6e4){this.Fi=e,this.timerId=t,this.d_=s,this.E_=a,this.A_=c,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const t=Math.floor(this.R_+this.p_()),s=Math.max(0,Date.now()-this.m_),a=Math.max(0,t-s);a>0&&Ue("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.R_} ms, delay with jitter: ${t} ms, last attempt: ${s} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,a,(()=>(this.m_=Date.now(),e()))),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wv="PersistentStream";class Dx{constructor(e,t,s,a,c,d,f,m){this.Fi=e,this.w_=s,this.S_=a,this.connection=c,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=f,this.listener=m,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new kx(e,t)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,(()=>this.L_())))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():t&&t.code===de.RESOURCE_EXHAUSTED?(mi(t.toString()),mi("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):t&&t.code===de.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(t)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),t=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([s,a])=>{this.b_===t&&this.W_(s,a)}),(s=>{e((()=>{const a=new Oe(de.UNKNOWN,"Fetching auth token failed: "+s.message);return this.G_(a)}))}))}W_(e,t){const s=this.K_(this.b_);this.stream=this.z_(e,t),this.stream.Zo((()=>{s((()=>this.listener.Zo()))})),this.stream.e_((()=>{s((()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,(()=>(this.x_()&&(this.state=3),Promise.resolve()))),this.listener.e_())))})),this.stream.n_((a=>{s((()=>this.G_(a)))})),this.stream.onMessage((a=>{s((()=>++this.C_==1?this.j_(a):this.onNext(a)))}))}O_(){this.state=5,this.F_.g_((async()=>{this.state=0,this.start()}))}G_(e){return Ue(Wv,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return t=>{this.Fi.enqueueAndForget((()=>this.b_===e?t():(Ue(Wv,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class UP extends Dx{constructor(e,t,s,a,c,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,s,a,d),this.serializer=c}z_(e,t){return this.connection.P_("Listen",e,t)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const t=qC(this.serializer,e),s=(function(c){if(!("targetChange"in c))return lt.min();const d=c.targetChange;return d.targetIds&&d.targetIds.length?lt.min():d.readTime?Fs(d.readTime):lt.min()})(e);return this.listener.J_(t,s)}H_(e){const t={};t.database=$f(this.serializer),t.addTarget=(function(c,d){let f;const m=d.target;if(f=Of(m)?{documents:QC(c,m)}:{query:YC(c,m).Vt},f.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){f.resumeToken=Ex(c,d.resumeToken);const v=Uf(c,d.expectedCount);v!==null&&(f.expectedCount=v)}else if(d.snapshotVersion.compareTo(lt.min())>0){f.readTime=Yu(c,d.snapshotVersion.toTimestamp());const v=Uf(c,d.expectedCount);v!==null&&(f.expectedCount=v)}return f})(this.serializer,e);const s=XC(this.serializer,e);s&&(t.labels=s),this.k_(t)}Y_(e){const t={};t.database=$f(this.serializer),t.removeTarget=e,this.k_(t)}}class zP extends Dx{constructor(e,t,s,a,c,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,s,a,d),this.serializer=c}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,t){return this.connection.P_("Write",e,t)}j_(e){return At(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,At(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){At(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();const t=KC(e.writeResults,e.commitTime),s=Fs(e.commitTime);return this.listener.ta(s,t)}na(){const e={};e.database=$f(this.serializer),this.k_(e)}X_(e){const t={streamToken:this.lastStreamToken,writes:e.map((s=>HC(this.serializer,s)))};this.k_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BP{}class $P extends BP{constructor(e,t,s,a){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=s,this.serializer=a,this.ra=!1}ia(){if(this.ra)throw new Oe(de.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,s,a){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([c,d])=>this.connection.Wo(e,zf(t,s),a,c,d))).catch((c=>{throw c.name==="FirebaseError"?(c.code===de.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new Oe(de.UNKNOWN,c.toString())}))}Jo(e,t,s,a,c){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([d,f])=>this.connection.Jo(e,zf(t,s),a,d,f,c))).catch((d=>{throw d.name==="FirebaseError"?(d.code===de.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new Oe(de.UNKNOWN,d.toString())}))}terminate(){this.ra=!0,this.connection.terminate()}}class WP{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve()))))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(mi(t),this._a=!1):Ue("OnlineStateTracker",t)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oa="RemoteStore";class GP{constructor(e,t,s,a,c){this.localStore=e,this.datastore=t,this.asyncQueue=s,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=c,this.Ea.xo((d=>{s.enqueueAndForget((async()=>{Ua(this)&&(Ue(Oa,"Restarting streams for network reachability change."),await(async function(m){const v=ct(m);v.Ia.add(4),await uc(v),v.Aa.set("Unknown"),v.Ia.delete(4),await _d(v)})(this))}))})),this.Aa=new WP(s,a)}}async function _d(n){if(Ua(n))for(const e of n.da)await e(!0)}async function uc(n){for(const e of n.da)await e(!1)}function Lx(n,e){const t=ct(n);t.Ta.has(e.targetId)||(t.Ta.set(e.targetId,e),Op(t)?Mp(t):Yo(t).x_()&&Vp(t,e))}function Lp(n,e){const t=ct(n),s=Yo(t);t.Ta.delete(e),s.x_()&&Vx(t,e),t.Ta.size===0&&(s.x_()?s.B_():Ua(t)&&t.Aa.set("Unknown"))}function Vp(n,e){if(n.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(lt.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Yo(n).H_(e)}function Vx(n,e){n.Ra.$e(e),Yo(n).Y_(e)}function Mp(n){n.Ra=new FC({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>n.Ta.get(e)||null,lt:()=>n.datastore.serializer.databaseId}),Yo(n).start(),n.Aa.aa()}function Op(n){return Ua(n)&&!Yo(n).M_()&&n.Ta.size>0}function Ua(n){return ct(n).Ia.size===0}function Mx(n){n.Ra=void 0}async function qP(n){n.Aa.set("Online")}async function HP(n){n.Ta.forEach(((e,t)=>{Vp(n,e)}))}async function KP(n,e){Mx(n),Op(n)?(n.Aa.la(e),Mp(n)):n.Aa.set("Unknown")}async function QP(n,e,t){if(n.Aa.set("Online"),e instanceof wx&&e.state===2&&e.cause)try{await(async function(a,c){const d=c.cause;for(const f of c.targetIds)a.Ta.has(f)&&(await a.remoteSyncer.rejectListen(f,d),a.Ta.delete(f),a.Ra.removeTarget(f))})(n,e)}catch(s){Ue(Oa,"Failed to remove targets %s: %s ",e.targetIds.join(","),s),await Xu(n,s)}else if(e instanceof ju?n.Ra.Ye(e):e instanceof xx?n.Ra.it(e):n.Ra.et(e),!t.isEqual(lt.min()))try{const s=await jx(n.localStore);t.compareTo(s)>=0&&await(function(c,d){const f=c.Ra.Pt(d);return f.targetChanges.forEach(((m,v)=>{if(m.resumeToken.approximateByteSize()>0){const x=c.Ta.get(v);x&&c.Ta.set(v,x.withResumeToken(m.resumeToken,d))}})),f.targetMismatches.forEach(((m,v)=>{const x=c.Ta.get(m);if(!x)return;c.Ta.set(m,x.withResumeToken(Hn.EMPTY_BYTE_STRING,x.snapshotVersion)),Vx(c,m);const S=new Wi(x.target,m,v,x.sequenceNumber);Vp(c,S)})),c.remoteSyncer.applyRemoteEvent(f)})(n,t)}catch(s){Ue(Oa,"Failed to raise snapshot:",s),await Xu(n,s)}}async function Xu(n,e,t){if(!Ko(e))throw e;n.Ia.add(1),await uc(n),n.Aa.set("Offline"),t||(t=()=>jx(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{Ue(Oa,"Retrying IndexedDB access"),await t(),n.Ia.delete(1),await _d(n)}))}function Ox(n,e){return e().catch((t=>Xu(n,t,e)))}async function xd(n){const e=ct(n),t=na(e);let s=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:wp;for(;YP(e);)try{const a=await AP(e.localStore,s);if(a===null){e.Pa.length===0&&t.B_();break}s=a.batchId,JP(e,a)}catch(a){await Xu(e,a)}Fx(e)&&Ux(e)}function YP(n){return Ua(n)&&n.Pa.length<10}function JP(n,e){n.Pa.push(e);const t=na(n);t.x_()&&t.Z_&&t.X_(e.mutations)}function Fx(n){return Ua(n)&&!na(n).M_()&&n.Pa.length>0}function Ux(n){na(n).start()}async function XP(n){na(n).na()}async function ZP(n){const e=na(n);for(const t of n.Pa)e.X_(t.mutations)}async function eN(n,e,t){const s=n.Pa.shift(),a=Pp.from(s,e,t);await Ox(n,(()=>n.remoteSyncer.applySuccessfulWrite(a))),await xd(n)}async function tN(n,e){e&&na(n).Z_&&await(async function(s,a){if((function(d){return MC(d)&&d!==de.ABORTED})(a.code)){const c=s.Pa.shift();na(s).N_(),await Ox(s,(()=>s.remoteSyncer.rejectFailedWrite(c.batchId,a))),await xd(s)}})(n,e),Fx(n)&&Ux(n)}async function Gv(n,e){const t=ct(n);t.asyncQueue.verifyOperationInProgress(),Ue(Oa,"RemoteStore received new credentials");const s=Ua(t);t.Ia.add(3),await uc(t),s&&t.Aa.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ia.delete(3),await _d(t)}async function nN(n,e){const t=ct(n);e?(t.Ia.delete(2),await _d(t)):e||(t.Ia.add(2),await uc(t),t.Aa.set("Unknown"))}function Yo(n){return n.Va||(n.Va=(function(t,s,a){const c=ct(t);return c.ia(),new UP(s,c.connection,c.authCredentials,c.appCheckCredentials,c.serializer,a)})(n.datastore,n.asyncQueue,{Zo:qP.bind(null,n),e_:HP.bind(null,n),n_:KP.bind(null,n),J_:QP.bind(null,n)}),n.da.push((async e=>{e?(n.Va.N_(),Op(n)?Mp(n):n.Aa.set("Unknown")):(await n.Va.stop(),Mx(n))}))),n.Va}function na(n){return n.ma||(n.ma=(function(t,s,a){const c=ct(t);return c.ia(),new zP(s,c.connection,c.authCredentials,c.appCheckCredentials,c.serializer,a)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),e_:XP.bind(null,n),n_:tN.bind(null,n),ea:ZP.bind(null,n),ta:eN.bind(null,n)}),n.da.push((async e=>{e?(n.ma.N_(),await xd(n)):(await n.ma.stop(),n.Pa.length>0&&(Ue(Oa,`Stopping write stream with ${n.Pa.length} pending writes`),n.Pa=[]))}))),n.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fp{constructor(e,t,s,a,c){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=s,this.op=a,this.removalCallback=c,this.deferred=new di,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((d=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,s,a,c){const d=Date.now()+s,f=new Fp(e,t,d,a,c);return f.start(s),f}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Oe(de.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Up(n,e){if(mi("AsyncQueue",`${e}: ${n}`),Ko(n))return new Oe(de.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ro{static emptySet(e){return new Ro(e.comparator)}constructor(e){this.comparator=e?(t,s)=>e(t,s)||Ze.comparator(t.key,s.key):(t,s)=>Ze.comparator(t.key,s.key),this.keyedMap=jl(),this.sortedSet=new Kt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,s)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Ro)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;t.hasNext();){const a=t.getNext().key,c=s.getNext().key;if(!a.isEqual(c))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const s=new Ro;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=t,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qv{constructor(){this.fa=new Kt(Ze.comparator)}track(e){const t=e.doc.key,s=this.fa.get(t);s?e.type!==0&&s.type===3?this.fa=this.fa.insert(t,e):e.type===3&&s.type!==1?this.fa=this.fa.insert(t,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.fa=this.fa.insert(t,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.fa=this.fa.remove(t):e.type===1&&s.type===2?this.fa=this.fa.insert(t,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):st(63341,{At:e,ga:s}):this.fa=this.fa.insert(t,e)}pa(){const e=[];return this.fa.inorderTraversal(((t,s)=>{e.push(s)})),e}}class Oo{constructor(e,t,s,a,c,d,f,m,v){this.query=e,this.docs=t,this.oldDocs=s,this.docChanges=a,this.mutatedKeys=c,this.fromCache=d,this.syncStateChanged=f,this.excludesMetadataChanges=m,this.hasCachedResults=v}static fromInitialDocuments(e,t,s,a,c){const d=[];return t.forEach((f=>{d.push({type:0,doc:f})})),new Oo(e,t,Ro.emptySet(t),d,s,a,!0,!1,c)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&fd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,s=e.docChanges;if(t.length!==s.length)return!1;for(let a=0;a<t.length;a++)if(t[a].type!==s[a].type||!t[a].doc.isEqual(s[a].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rN{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some((e=>e.ba()))}}class sN{constructor(){this.queries=Hv(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(t,s){const a=ct(t),c=a.queries;a.queries=Hv(),c.forEach(((d,f)=>{for(const m of f.wa)m.onError(s)}))})(this,new Oe(de.ABORTED,"Firestore shutting down"))}}function Hv(){return new Fa((n=>ox(n)),fd)}async function zp(n,e){const t=ct(n);let s=3;const a=e.query;let c=t.queries.get(a);c?!c.Sa()&&e.ba()&&(s=2):(c=new rN,s=e.ba()?0:1);try{switch(s){case 0:c.ya=await t.onListen(a,!0);break;case 1:c.ya=await t.onListen(a,!1);break;case 2:await t.onFirstRemoteStoreListen(a)}}catch(d){const f=Up(d,`Initialization of query '${So(e.query)}' failed`);return void e.onError(f)}t.queries.set(a,c),c.wa.push(e),e.va(t.onlineState),c.ya&&e.Ca(c.ya)&&$p(t)}async function Bp(n,e){const t=ct(n),s=e.query;let a=3;const c=t.queries.get(s);if(c){const d=c.wa.indexOf(e);d>=0&&(c.wa.splice(d,1),c.wa.length===0?a=e.ba()?0:1:!c.Sa()&&e.ba()&&(a=2))}switch(a){case 0:return t.queries.delete(s),t.onUnlisten(s,!0);case 1:return t.queries.delete(s),t.onUnlisten(s,!1);case 2:return t.onLastRemoteStoreUnlisten(s);default:return}}function iN(n,e){const t=ct(n);let s=!1;for(const a of e){const c=a.query,d=t.queries.get(c);if(d){for(const f of d.wa)f.Ca(a)&&(s=!0);d.ya=a}}s&&$p(t)}function aN(n,e,t){const s=ct(n),a=s.queries.get(e);if(a)for(const c of a.wa)c.onError(t);s.queries.delete(e)}function $p(n){n.Da.forEach((e=>{e.next()}))}var qf,Kv;(Kv=qf||(qf={})).Fa="default",Kv.Cache="cache";class Wp{constructor(e,t,s){this.query=e,this.Ma=t,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=s||{}}Ca(e){if(!this.options.includeMetadataChanges){const s=[];for(const a of e.docChanges)a.type!==3&&s.push(a);e=new Oo(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),t=!0):this.Ba(e,this.onlineState)&&(this.La(e),t=!0),this.Oa=e,t}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let t=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),t=!0),t}Ba(e,t){if(!e.fromCache||!this.ba())return!0;const s=t!=="Offline";return(!this.options.ka||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Na(e){if(e.docChanges.length>0)return!0;const t=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}La(e){e=Oo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==qf.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zx{constructor(e){this.key=e}}class Bx{constructor(e){this.key=e}}class oN{constructor(e,t){this.query=e,this.Ha=t,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=vt(),this.mutatedKeys=vt(),this.Xa=lx(e),this.eu=new Ro(this.Xa)}get tu(){return this.Ha}nu(e,t){const s=t?t.ru:new qv,a=t?t.eu:this.eu;let c=t?t.mutatedKeys:this.mutatedKeys,d=a,f=!1;const m=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,v=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal(((x,S)=>{const b=a.get(x),M=pd(this.query,S)?S:null,Y=!!b&&this.mutatedKeys.has(b.key),z=!!M&&(M.hasLocalMutations||this.mutatedKeys.has(M.key)&&M.hasCommittedMutations);let V=!1;b&&M?b.data.isEqual(M.data)?Y!==z&&(s.track({type:3,doc:M}),V=!0):this.iu(b,M)||(s.track({type:2,doc:M}),V=!0,(m&&this.Xa(M,m)>0||v&&this.Xa(M,v)<0)&&(f=!0)):!b&&M?(s.track({type:0,doc:M}),V=!0):b&&!M&&(s.track({type:1,doc:b}),V=!0,(m||v)&&(f=!0)),V&&(M?(d=d.add(M),c=z?c.add(x):c.delete(x)):(d=d.delete(x),c=c.delete(x)))})),this.query.limit!==null)for(;d.size>this.query.limit;){const x=this.query.limitType==="F"?d.last():d.first();d=d.delete(x.key),c=c.delete(x.key),s.track({type:1,doc:x})}return{eu:d,ru:s,Ds:f,mutatedKeys:c}}iu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,s,a){const c=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const d=e.ru.pa();d.sort(((x,S)=>(function(M,Y){const z=V=>{switch(V){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return st(20277,{At:V})}};return z(M)-z(Y)})(x.type,S.type)||this.Xa(x.doc,S.doc))),this.su(s),a=a!=null&&a;const f=t&&!a?this.ou():[],m=this.Za.size===0&&this.current&&!a?1:0,v=m!==this.Ya;return this.Ya=m,d.length!==0||v?{snapshot:new Oo(this.query,e.eu,c,d,e.mutatedKeys,m===0,v,!1,!!s&&s.resumeToken.approximateByteSize()>0),_u:f}:{_u:f}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new qv,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach((t=>this.Ha=this.Ha.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ha=this.Ha.delete(t))),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=vt(),this.eu.forEach((s=>{this.au(s.key)&&(this.Za=this.Za.add(s.key))}));const t=[];return e.forEach((s=>{this.Za.has(s)||t.push(new Bx(s))})),this.Za.forEach((s=>{e.has(s)||t.push(new zx(s))})),t}uu(e){this.Ha=e.qs,this.Za=vt();const t=this.nu(e.documents);return this.applyChanges(t,!0)}cu(){return Oo.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const Gp="SyncEngine";class lN{constructor(e,t,s){this.query=e,this.targetId=t,this.view=s}}class cN{constructor(e){this.key=e,this.lu=!1}}class uN{constructor(e,t,s,a,c,d){this.localStore=e,this.remoteStore=t,this.eventManager=s,this.sharedClientState=a,this.currentUser=c,this.maxConcurrentLimboResolutions=d,this.hu={},this.Pu=new Fa((f=>ox(f)),fd),this.Tu=new Map,this.Iu=new Set,this.du=new Kt(Ze.comparator),this.Eu=new Map,this.Au=new Ap,this.Ru={},this.Vu=new Map,this.mu=Mo.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function dN(n,e,t=!0){const s=Kx(n);let a;const c=s.Pu.get(e);return c?(s.sharedClientState.addLocalQueryTarget(c.targetId),a=c.view.cu()):a=await $x(s,e,t,!0),a}async function hN(n,e){const t=Kx(n);await $x(t,e,!0,!1)}async function $x(n,e,t,s){const a=await jP(n.localStore,Os(e)),c=a.targetId,d=n.sharedClientState.addLocalQueryTarget(c,t);let f;return s&&(f=await fN(n,e,c,d==="current",a.resumeToken)),n.isPrimaryClient&&t&&Lx(n.remoteStore,a),f}async function fN(n,e,t,s,a){n.gu=(S,b,M)=>(async function(z,V,te,be){let we=V.view.nu(te);we.Ds&&(we=await Uv(z.localStore,V.query,!1).then((({documents:D})=>V.view.nu(D,we))));const ge=be&&be.targetChanges.get(V.targetId),ie=be&&be.targetMismatches.get(V.targetId)!=null,Ee=V.view.applyChanges(we,z.isPrimaryClient,ge,ie);return Yv(z,V.targetId,Ee._u),Ee.snapshot})(n,S,b,M);const c=await Uv(n.localStore,e,!0),d=new oN(e,c.qs),f=d.nu(c.documents),m=cc.createSynthesizedTargetChangeForCurrentChange(t,s&&n.onlineState!=="Offline",a),v=d.applyChanges(f,n.isPrimaryClient,m);Yv(n,t,v._u);const x=new lN(e,t,d);return n.Pu.set(e,x),n.Tu.has(t)?n.Tu.get(t).push(e):n.Tu.set(t,[e]),v.snapshot}async function pN(n,e,t){const s=ct(n),a=s.Pu.get(e),c=s.Tu.get(a.targetId);if(c.length>1)return s.Tu.set(a.targetId,c.filter((d=>!fd(d,e)))),void s.Pu.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(a.targetId),s.sharedClientState.isActiveQueryTarget(a.targetId)||await Wf(s.localStore,a.targetId,!1).then((()=>{s.sharedClientState.clearQueryState(a.targetId),t&&Lp(s.remoteStore,a.targetId),Hf(s,a.targetId)})).catch(Ho)):(Hf(s,a.targetId),await Wf(s.localStore,a.targetId,!0))}async function mN(n,e){const t=ct(n),s=t.Pu.get(e),a=t.Tu.get(s.targetId);t.isPrimaryClient&&a.length===1&&(t.sharedClientState.removeLocalQueryTarget(s.targetId),Lp(t.remoteStore,s.targetId))}async function gN(n,e,t){const s=TN(n);try{const a=await(function(d,f){const m=ct(d),v=Bt.now(),x=f.reduce(((M,Y)=>M.add(Y.key)),vt());let S,b;return m.persistence.runTransaction("Locally write mutations","readwrite",(M=>{let Y=gi(),z=vt();return m.Os.getEntries(M,x).next((V=>{Y=V,Y.forEach(((te,be)=>{be.isValidDocument()||(z=z.add(te))}))})).next((()=>m.localDocuments.getOverlayedDocuments(M,Y))).next((V=>{S=V;const te=[];for(const be of f){const we=jC(be,S.get(be.key).overlayedDocument);we!=null&&te.push(new ca(be.key,we,Z0(we.value.mapValue),Xr.exists(!0)))}return m.mutationQueue.addMutationBatch(M,v,te,f)})).next((V=>{b=V;const te=V.applyToLocalDocumentSet(S,z);return m.documentOverlayCache.saveOverlays(M,V.batchId,te)}))})).then((()=>({batchId:b.batchId,changes:ux(S)})))})(s.localStore,e);s.sharedClientState.addPendingMutation(a.batchId),(function(d,f,m){let v=d.Ru[d.currentUser.toKey()];v||(v=new Kt(ft)),v=v.insert(f,m),d.Ru[d.currentUser.toKey()]=v})(s,a.batchId,t),await dc(s,a.changes),await xd(s.remoteStore)}catch(a){const c=Up(a,"Failed to persist write");t.reject(c)}}async function Wx(n,e){const t=ct(n);try{const s=await NP(t.localStore,e);e.targetChanges.forEach(((a,c)=>{const d=t.Eu.get(c);d&&(At(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?d.lu=!0:a.modifiedDocuments.size>0?At(d.lu,14607):a.removedDocuments.size>0&&(At(d.lu,42227),d.lu=!1))})),await dc(t,s,e)}catch(s){await Ho(s)}}function Qv(n,e,t){const s=ct(n);if(s.isPrimaryClient&&t===0||!s.isPrimaryClient&&t===1){const a=[];s.Pu.forEach(((c,d)=>{const f=d.view.va(e);f.snapshot&&a.push(f.snapshot)})),(function(d,f){const m=ct(d);m.onlineState=f;let v=!1;m.queries.forEach(((x,S)=>{for(const b of S.wa)b.va(f)&&(v=!0)})),v&&$p(m)})(s.eventManager,e),a.length&&s.hu.J_(a),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function yN(n,e,t){const s=ct(n);s.sharedClientState.updateQueryState(e,"rejected",t);const a=s.Eu.get(e),c=a&&a.key;if(c){let d=new Kt(Ze.comparator);d=d.insert(c,ar.newNoDocument(c,lt.min()));const f=vt().add(c),m=new yd(lt.min(),new Map,new Kt(ft),d,f);await Wx(s,m),s.du=s.du.remove(c),s.Eu.delete(e),qp(s)}else await Wf(s.localStore,e,!1).then((()=>Hf(s,e,t))).catch(Ho)}async function vN(n,e){const t=ct(n),s=e.batch.batchId;try{const a=await PP(t.localStore,e);qx(t,s,null),Gx(t,s),t.sharedClientState.updateMutationState(s,"acknowledged"),await dc(t,a)}catch(a){await Ho(a)}}async function _N(n,e,t){const s=ct(n);try{const a=await(function(d,f){const m=ct(d);return m.persistence.runTransaction("Reject batch","readwrite-primary",(v=>{let x;return m.mutationQueue.lookupMutationBatch(v,f).next((S=>(At(S!==null,37113),x=S.keys(),m.mutationQueue.removeMutationBatch(v,S)))).next((()=>m.mutationQueue.performConsistencyCheck(v))).next((()=>m.documentOverlayCache.removeOverlaysForBatchId(v,x,f))).next((()=>m.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(v,x))).next((()=>m.localDocuments.getDocuments(v,x)))}))})(s.localStore,e);qx(s,e,t),Gx(s,e),s.sharedClientState.updateMutationState(e,"rejected",t),await dc(s,a)}catch(a){await Ho(a)}}function Gx(n,e){(n.Vu.get(e)||[]).forEach((t=>{t.resolve()})),n.Vu.delete(e)}function qx(n,e,t){const s=ct(n);let a=s.Ru[s.currentUser.toKey()];if(a){const c=a.get(e);c&&(t?c.reject(t):c.resolve(),a=a.remove(e)),s.Ru[s.currentUser.toKey()]=a}}function Hf(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const s of n.Tu.get(e))n.Pu.delete(s),t&&n.hu.pu(s,t);n.Tu.delete(e),n.isPrimaryClient&&n.Au.zr(e).forEach((s=>{n.Au.containsKey(s)||Hx(n,s)}))}function Hx(n,e){n.Iu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(Lp(n.remoteStore,t),n.du=n.du.remove(e),n.Eu.delete(t),qp(n))}function Yv(n,e,t){for(const s of t)s instanceof zx?(n.Au.addReference(s.key,e),xN(n,s)):s instanceof Bx?(Ue(Gp,"Document no longer in limbo: "+s.key),n.Au.removeReference(s.key,e),n.Au.containsKey(s.key)||Hx(n,s.key)):st(19791,{yu:s})}function xN(n,e){const t=e.key,s=t.path.canonicalString();n.du.get(t)||n.Iu.has(s)||(Ue(Gp,"New document in limbo: "+t),n.Iu.add(s),qp(n))}function qp(n){for(;n.Iu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Iu.values().next().value;n.Iu.delete(e);const t=new Ze(Mt.fromString(e)),s=n.mu.next();n.Eu.set(s,new cN(t)),n.du=n.du.insert(t,s),Lx(n.remoteStore,new Wi(Os(hd(t.path)),s,"TargetPurposeLimboResolution",cd.ue))}}async function dc(n,e,t){const s=ct(n),a=[],c=[],d=[];s.Pu.isEmpty()||(s.Pu.forEach(((f,m)=>{d.push(s.gu(m,e,t).then((v=>{var x;if((v||t)&&s.isPrimaryClient){const S=v?!v.fromCache:(x=t==null?void 0:t.targetChanges.get(m.targetId))===null||x===void 0?void 0:x.current;s.sharedClientState.updateQueryState(m.targetId,S?"current":"not-current")}if(v){a.push(v);const S=kp.Es(m.targetId,v);c.push(S)}})))})),await Promise.all(d),s.hu.J_(a),await(async function(m,v){const x=ct(m);try{await x.persistence.runTransaction("notifyLocalViewChanges","readwrite",(S=>fe.forEach(v,(b=>fe.forEach(b.Is,(M=>x.persistence.referenceDelegate.addReference(S,b.targetId,M))).next((()=>fe.forEach(b.ds,(M=>x.persistence.referenceDelegate.removeReference(S,b.targetId,M)))))))))}catch(S){if(!Ko(S))throw S;Ue(Dp,"Failed to update sequence numbers: "+S)}for(const S of v){const b=S.targetId;if(!S.fromCache){const M=x.Fs.get(b),Y=M.snapshotVersion,z=M.withLastLimboFreeSnapshotVersion(Y);x.Fs=x.Fs.insert(b,z)}}})(s.localStore,c))}async function wN(n,e){const t=ct(n);if(!t.currentUser.isEqual(e)){Ue(Gp,"User change. New user:",e.toKey());const s=await Ax(t.localStore,e);t.currentUser=e,(function(c,d){c.Vu.forEach((f=>{f.forEach((m=>{m.reject(new Oe(de.CANCELLED,d))}))})),c.Vu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await dc(t,s.Bs)}}function EN(n,e){const t=ct(n),s=t.Eu.get(e);if(s&&s.lu)return vt().add(s.key);{let a=vt();const c=t.Tu.get(e);if(!c)return a;for(const d of c){const f=t.Pu.get(d);a=a.unionWith(f.view.tu)}return a}}function Kx(n){const e=ct(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Wx.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=EN.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=yN.bind(null,e),e.hu.J_=iN.bind(null,e.eventManager),e.hu.pu=aN.bind(null,e.eventManager),e}function TN(n){const e=ct(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=vN.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=_N.bind(null,e),e}class Zu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=vd(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,t){return null}Fu(e,t){return null}vu(e){return CP(this.persistence,new SP,e.initialUser,this.serializer)}Du(e){return new Rx(jp.Vi,this.serializer)}bu(e){return new DP}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Zu.provider={build:()=>new Zu};class SN extends Zu{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,t){At(this.persistence.referenceDelegate instanceof Ju,46915);const s=this.persistence.referenceDelegate.garbageCollector;return new cP(s,e.asyncQueue,t)}Du(e){const t=this.cacheSizeBytes!==void 0?Sr.withCacheSize(this.cacheSizeBytes):Sr.DEFAULT;return new Rx((s=>Ju.Vi(s,t)),this.serializer)}}class Kf{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>Qv(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=wN.bind(null,this.syncEngine),await nN(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new sN})()}createDatastore(e){const t=vd(e.databaseInfo.databaseId),s=(function(c){return new FP(c)})(e.databaseInfo);return(function(c,d,f,m){return new $P(c,d,f,m)})(e.authCredentials,e.appCheckCredentials,s,t)}createRemoteStore(e){return(function(s,a,c,d,f){return new GP(s,a,c,d,f)})(this.localStore,this.datastore,e.asyncQueue,(t=>Qv(this.syncEngine,t,0)),(function(){return $v.C()?new $v:new LP})())}createSyncEngine(e,t){return(function(a,c,d,f,m,v,x){const S=new uN(a,c,d,f,m,v);return x&&(S.fu=!0),S})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(a){const c=ct(a);Ue(Oa,"RemoteStore shutting down."),c.Ia.add(5),await uc(c),c.Ea.shutdown(),c.Aa.set("Unknown")})(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}Kf.provider={build:()=>new Kf};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hp{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):mi("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ra="FirestoreClient";class bN{constructor(e,t,s,a,c){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=s,this.databaseInfo=a,this.user=ir.UNAUTHENTICATED,this.clientId=xp.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=c,this.authCredentials.start(s,(async d=>{Ue(ra,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d})),this.appCheckCredentials.start(s,(d=>(Ue(ra,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new di;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const s=Up(t,"Failed to shutdown persistence");e.reject(s)}})),e.promise}}async function mf(n,e){n.asyncQueue.verifyOperationInProgress(),Ue(ra,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let s=t.initialUser;n.setCredentialChangeListener((async a=>{s.isEqual(a)||(await Ax(e.localStore,a),s=a)})),e.persistence.setDatabaseDeletedListener((()=>{Ji("Terminating Firestore due to IndexedDb database deletion"),n.terminate().then((()=>{Ue("Terminating Firestore due to IndexedDb database deletion completed successfully")})).catch((a=>{Ji("Terminating Firestore due to IndexedDb database deletion failed",a)}))})),n._offlineComponents=e}async function Jv(n,e){n.asyncQueue.verifyOperationInProgress();const t=await IN(n);Ue(ra,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((s=>Gv(e.remoteStore,s))),n.setAppCheckTokenChangeListener(((s,a)=>Gv(e.remoteStore,a))),n._onlineComponents=e}async function IN(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Ue(ra,"Using user provided OfflineComponentProvider");try{await mf(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(a){return a.name==="FirebaseError"?a.code===de.FAILED_PRECONDITION||a.code===de.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11})(t))throw t;Ji("Error using user provided cache. Falling back to memory cache: "+t),await mf(n,new Zu)}}else Ue(ra,"Using default OfflineComponentProvider"),await mf(n,new SN(void 0));return n._offlineComponents}async function Qx(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Ue(ra,"Using user provided OnlineComponentProvider"),await Jv(n,n._uninitializedComponentsProvider._online)):(Ue(ra,"Using default OnlineComponentProvider"),await Jv(n,new Kf))),n._onlineComponents}function CN(n){return Qx(n).then((e=>e.syncEngine))}async function ed(n){const e=await Qx(n),t=e.eventManager;return t.onListen=dN.bind(null,e.syncEngine),t.onUnlisten=pN.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=hN.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=mN.bind(null,e.syncEngine),t}function PN(n,e,t={}){const s=new di;return n.asyncQueue.enqueueAndForget((async()=>(function(c,d,f,m,v){const x=new Hp({next:b=>{x.Ou(),d.enqueueAndForget((()=>Bp(c,S)));const M=b.docs.has(f);!M&&b.fromCache?v.reject(new Oe(de.UNAVAILABLE,"Failed to get document because the client is offline.")):M&&b.fromCache&&m&&m.source==="server"?v.reject(new Oe(de.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):v.resolve(b)},error:b=>v.reject(b)}),S=new Wp(hd(f.path),x,{includeMetadataChanges:!0,ka:!0});return zp(c,S)})(await ed(n),n.asyncQueue,e,t,s))),s.promise}function NN(n,e,t={}){const s=new di;return n.asyncQueue.enqueueAndForget((async()=>(function(c,d,f,m,v){const x=new Hp({next:b=>{x.Ou(),d.enqueueAndForget((()=>Bp(c,S))),b.fromCache&&m.source==="server"?v.reject(new Oe(de.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):v.resolve(b)},error:b=>v.reject(b)}),S=new Wp(f,x,{includeMetadataChanges:!0,ka:!0});return zp(c,S)})(await ed(n),n.asyncQueue,e,t,s))),s.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yx(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xv=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jx="firestore.googleapis.com",Zv=!0;class e_{constructor(e){var t,s;if(e.host===void 0){if(e.ssl!==void 0)throw new Oe(de.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Jx,this.ssl=Zv}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:Zv;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Nx;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<oP)throw new Oe(de.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}GI("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Yx((s=e.experimentalLongPollingOptions)!==null&&s!==void 0?s:{}),(function(c){if(c.timeoutSeconds!==void 0){if(isNaN(c.timeoutSeconds))throw new Oe(de.INVALID_ARGUMENT,`invalid long polling timeout: ${c.timeoutSeconds} (must not be NaN)`);if(c.timeoutSeconds<5)throw new Oe(de.INVALID_ARGUMENT,`invalid long polling timeout: ${c.timeoutSeconds} (minimum allowed value is 5)`);if(c.timeoutSeconds>30)throw new Oe(de.INVALID_ARGUMENT,`invalid long polling timeout: ${c.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(s,a){return s.timeoutSeconds===a.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class wd{constructor(e,t,s,a){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=s,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new e_({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Oe(de.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Oe(de.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new e_(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(s){if(!s)return new VI;switch(s.type){case"firstParty":return new UI(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new Oe(de.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const s=Xv.get(t);s&&(Ue("ComponentProvider","Removing Datastore"),Xv.delete(t),s.terminate())})(this),Promise.resolve()}}function RN(n,e,t,s={}){var a;n=Ir(n,wd);const c=Bo(e),d=n._getSettings(),f=Object.assign(Object.assign({},d),{emulatorOptions:n._getEmulatorOptions()}),m=`${e}:${t}`;c&&(B_(`https://${m}`),$_("Firestore",!0)),d.host!==Jx&&d.host!==m&&Ji("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const v=Object.assign(Object.assign({},d),{host:m,ssl:c,emulatorOptions:s});if(!Da(v,f)&&(n._setSettings(v),s.mockUserToken)){let x,S;if(typeof s.mockUserToken=="string")x=s.mockUserToken,S=ir.MOCK_USER;else{x=WT(s.mockUserToken,(a=n._app)===null||a===void 0?void 0:a.options.projectId);const b=s.mockUserToken.sub||s.mockUserToken.user_id;if(!b)throw new Oe(de.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");S=new ir(b)}n._authCredentials=new MI(new U0(x,S))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xi{constructor(e,t,s){this.converter=t,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new xi(this.firestore,e,this._query)}}class Xt{constructor(e,t,s){this.converter=t,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Yi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Xt(this.firestore,e,this._key)}toJSON(){return{type:Xt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,s){if(oc(t,Xt._jsonSchema))return new Xt(e,s||null,new Ze(Mt.fromString(t.referencePath)))}}Xt._jsonSchemaVersion="firestore/documentReference/1.0",Xt._jsonSchema={type:pn("string",Xt._jsonSchemaVersion),referencePath:pn("string")};class Yi extends xi{constructor(e,t,s){super(e,t,hd(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Xt(this.firestore,null,new Ze(e))}withConverter(e){return new Yi(this.firestore,e,this._path)}}function Sn(n,e,...t){if(n=Zt(n),B0("collection","path",e),n instanceof wd){const s=Mt.fromString(e,...t);return fv(s),new Yi(n,null,s)}{if(!(n instanceof Xt||n instanceof Yi))throw new Oe(de.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(Mt.fromString(e,...t));return fv(s),new Yi(n.firestore,null,s)}}function Dt(n,e,...t){if(n=Zt(n),arguments.length===1&&(e=xp.newId()),B0("doc","path",e),n instanceof wd){const s=Mt.fromString(e,...t);return hv(s),new Xt(n,null,new Ze(s))}{if(!(n instanceof Xt||n instanceof Yi))throw new Oe(de.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(Mt.fromString(e,...t));return hv(s),new Xt(n.firestore,n instanceof Yi?n.converter:null,new Ze(s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t_="AsyncQueue";class n_{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new kx(this,"async_queue_retry"),this.oc=()=>{const s=pf();s&&Ue(t_,"Visibility state changed to "+s.visibilityState),this.F_.y_()},this._c=e;const t=pf();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const t=pf();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise((()=>{}));const t=new di;return this.uc((()=>this.Xu&&this.rc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Zu.push(e),this.cc())))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!Ko(e))throw e;Ue(t_,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_((()=>this.cc()))}}uc(e){const t=this._c.then((()=>(this.nc=!0,e().catch((s=>{throw this.tc=s,this.nc=!1,mi("INTERNAL UNHANDLED ERROR: ",r_(s)),s})).then((s=>(this.nc=!1,s))))));return this._c=t,t}enqueueAfterDelay(e,t,s){this.ac(),this.sc.indexOf(e)>-1&&(t=0);const a=Fp.createAndSchedule(this,e,t,s,(c=>this.lc(c)));return this.ec.push(a),a}ac(){this.tc&&st(47125,{hc:r_(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(const t of this.ec)if(t.timerId===e)return!0;return!1}Ic(e){return this.Pc().then((()=>{this.ec.sort(((t,s)=>t.targetTimeMs-s.targetTimeMs));for(const t of this.ec)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Pc()}))}dc(e){this.sc.push(e)}lc(e){const t=this.ec.indexOf(e);this.ec.splice(t,1)}}function r_(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s_(n){return(function(t,s){if(typeof t!="object"||t===null)return!1;const a=t;for(const c of s)if(c in a&&typeof a[c]=="function")return!0;return!1})(n,["next","error","complete"])}class yi extends wd{constructor(e,t,s,a){super(e,t,s,a),this.type="firestore",this._queue=new n_,this._persistenceKey=(a==null?void 0:a.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new n_(e),this._firestoreClient=void 0,await e}}}function AN(n,e){const t=typeof n=="object"?n:H_(),s=typeof n=="string"?n:Gu,a=op(t,"firestore").getImmediate({identifier:s});if(!a._initialized){const c=BT("firestore");c&&RN(a,...c)}return a}function Ed(n){if(n._terminated)throw new Oe(de.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||jN(n),n._firestoreClient}function jN(n){var e,t,s;const a=n._freezeSettings(),c=(function(f,m,v,x){return new nC(f,m,v,x.host,x.ssl,x.experimentalForceLongPolling,x.experimentalAutoDetectLongPolling,Yx(x.experimentalLongPollingOptions),x.useFetchStreams,x.isUsingEmulator)})(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,a);n._componentsProvider||!((t=a.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((s=a.localCache)===null||s===void 0)&&s._onlineComponentProvider)&&(n._componentsProvider={_offline:a.localCache._offlineComponentProvider,_online:a.localCache._onlineComponentProvider}),n._firestoreClient=new bN(n._authCredentials,n._appCheckCredentials,n._queue,c,n._componentsProvider&&(function(f){const m=f==null?void 0:f._online.build();return{_offline:f==null?void 0:f._offline.build(m),_online:m}})(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Yr(Hn.fromBase64String(e))}catch(t){throw new Oe(de.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Yr(Hn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Yr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(oc(e,Yr._jsonSchema))return Yr.fromBase64String(e.bytes)}}Yr._jsonSchemaVersion="firestore/bytes/1.0",Yr._jsonSchema={type:pn("string",Yr._jsonSchemaVersion),bytes:pn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Td{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Oe(de.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new qn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sd{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Us{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Oe(de.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Oe(de.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return ft(this._lat,e._lat)||ft(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Us._jsonSchemaVersion}}static fromJSON(e){if(oc(e,Us._jsonSchema))return new Us(e.latitude,e.longitude)}}Us._jsonSchemaVersion="firestore/geoPoint/1.0",Us._jsonSchema={type:pn("string",Us._jsonSchemaVersion),latitude:pn("number"),longitude:pn("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zs{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(s,a){if(s.length!==a.length)return!1;for(let c=0;c<s.length;++c)if(s[c]!==a[c])return!1;return!0})(this._values,e._values)}toJSON(){return{type:zs._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(oc(e,zs._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new zs(e.vectorValues);throw new Oe(de.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}zs._jsonSchemaVersion="firestore/vectorValue/1.0",zs._jsonSchema={type:pn("string",zs._jsonSchemaVersion),vectorValues:pn("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kN=/^__.*__$/;class DN{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return this.fieldMask!==null?new ca(e,this.data,this.fieldMask,t,this.fieldTransforms):new lc(e,this.data,t,this.fieldTransforms)}}class Xx{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return new ca(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Zx(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw st(40011,{Ec:n})}}class Kp{constructor(e,t,s,a,c,d){this.settings=e,this.databaseId=t,this.serializer=s,this.ignoreUndefinedProperties=a,c===void 0&&this.Ac(),this.fieldTransforms=c||[],this.fieldMask=d||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new Kp(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var t;const s=(t=this.path)===null||t===void 0?void 0:t.child(e),a=this.Rc({path:s,mc:!1});return a.fc(e),a}gc(e){var t;const s=(t=this.path)===null||t===void 0?void 0:t.child(e),a=this.Rc({path:s,mc:!1});return a.Ac(),a}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return td(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(Zx(this.Ec)&&kN.test(e))throw this.wc('Document fields cannot begin and end with "__"')}}class LN{constructor(e,t,s){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=s||vd(e)}Dc(e,t,s,a=!1){return new Kp({Ec:e,methodName:t,bc:s,path:qn.emptyPath(),mc:!1,Sc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function bd(n){const e=n._freezeSettings(),t=vd(n._databaseId);return new LN(n._databaseId,!!e.ignoreUndefinedProperties,t)}function ew(n,e,t,s,a,c={}){const d=n.Dc(c.merge||c.mergeFields?2:0,e,t,a);Yp("Data must be an object, but it was:",d,s);const f=tw(s,d);let m,v;if(c.merge)m=new Or(d.fieldMask),v=d.fieldTransforms;else if(c.mergeFields){const x=[];for(const S of c.mergeFields){const b=Qf(e,S,t);if(!d.contains(b))throw new Oe(de.INVALID_ARGUMENT,`Field '${b}' is specified in your field mask but missing from your input data.`);rw(x,b)||x.push(b)}m=new Or(x),v=d.fieldTransforms.filter((S=>m.covers(S.field)))}else m=null,v=d.fieldTransforms;return new DN(new br(f),m,v)}class hc extends Sd{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof hc}}class Qp extends Sd{_toFieldTransform(e){return new PC(e.path,new Xl)}isEqual(e){return e instanceof Qp}}function VN(n,e,t,s){const a=n.Dc(1,e,t);Yp("Data must be an object, but it was:",a,s);const c=[],d=br.empty();la(s,((m,v)=>{const x=Jp(e,m,t);v=Zt(v);const S=a.gc(x);if(v instanceof hc)c.push(x);else{const b=fc(v,S);b!=null&&(c.push(x),d.set(x,b))}}));const f=new Or(c);return new Xx(d,f,a.fieldTransforms)}function MN(n,e,t,s,a,c){const d=n.Dc(1,e,t),f=[Qf(e,s,t)],m=[a];if(c.length%2!=0)throw new Oe(de.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let b=0;b<c.length;b+=2)f.push(Qf(e,c[b])),m.push(c[b+1]);const v=[],x=br.empty();for(let b=f.length-1;b>=0;--b)if(!rw(v,f[b])){const M=f[b];let Y=m[b];Y=Zt(Y);const z=d.gc(M);if(Y instanceof hc)v.push(M);else{const V=fc(Y,z);V!=null&&(v.push(M),x.set(M,V))}}const S=new Or(v);return new Xx(x,S,d.fieldTransforms)}function ON(n,e,t,s=!1){return fc(t,n.Dc(s?4:3,e))}function fc(n,e){if(nw(n=Zt(n)))return Yp("Unsupported field value:",e,n),tw(n,e);if(n instanceof Sd)return(function(s,a){if(!Zx(a.Ec))throw a.wc(`${s._methodName}() can only be used with update() and set()`);if(!a.path)throw a.wc(`${s._methodName}() is not currently supported inside arrays`);const c=s._toFieldTransform(a);c&&a.fieldTransforms.push(c)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return(function(s,a){const c=[];let d=0;for(const f of s){let m=fc(f,a.yc(d));m==null&&(m={nullValue:"NULL_VALUE"}),c.push(m),d++}return{arrayValue:{values:c}}})(n,e)}return(function(s,a){if((s=Zt(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return bC(a.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const c=Bt.fromDate(s);return{timestampValue:Yu(a.serializer,c)}}if(s instanceof Bt){const c=new Bt(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:Yu(a.serializer,c)}}if(s instanceof Us)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof Yr)return{bytesValue:Ex(a.serializer,s._byteString)};if(s instanceof Xt){const c=a.databaseId,d=s.firestore._databaseId;if(!d.isEqual(c))throw a.wc(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${c.projectId}/${c.database}`);return{referenceValue:Rp(s.firestore._databaseId||a.databaseId,s._key.path)}}if(s instanceof zs)return(function(d,f){return{mapValue:{fields:{[J0]:{stringValue:X0},[qu]:{arrayValue:{values:d.toArray().map((v=>{if(typeof v!="number")throw f.wc("VectorValues must only contain numeric values.");return Ip(f.serializer,v)}))}}}}}})(s,a);throw a.wc(`Unsupported field value: ${ld(s)}`)})(n,e)}function tw(n,e){const t={};return G0(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):la(n,((s,a)=>{const c=fc(a,e.Vc(s));c!=null&&(t[s]=c)})),{mapValue:{fields:t}}}function nw(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Bt||n instanceof Us||n instanceof Yr||n instanceof Xt||n instanceof Sd||n instanceof zs)}function Yp(n,e,t){if(!nw(t)||!$0(t)){const s=ld(t);throw s==="an object"?e.wc(n+" a custom object"):e.wc(n+" "+s)}}function Qf(n,e,t){if((e=Zt(e))instanceof Td)return e._internalPath;if(typeof e=="string")return Jp(n,e);throw td("Field path arguments must be of type string or ",n,!1,void 0,t)}const FN=new RegExp("[~\\*/\\[\\]]");function Jp(n,e,t){if(e.search(FN)>=0)throw td(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Td(...e.split("."))._internalPath}catch{throw td(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function td(n,e,t,s,a){const c=s&&!s.isEmpty(),d=a!==void 0;let f=`Function ${e}() called with invalid data`;t&&(f+=" (via `toFirestore()`)"),f+=". ";let m="";return(c||d)&&(m+=" (found",c&&(m+=` in field ${s}`),d&&(m+=` in document ${a}`),m+=")"),new Oe(de.INVALID_ARGUMENT,f+n+m)}function rw(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sw{constructor(e,t,s,a,c){this._firestore=e,this._userDataWriter=t,this._key=s,this._document=a,this._converter=c}get id(){return this._key.path.lastSegment()}get ref(){return new Xt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new UN(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Id("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class UN extends sw{data(){return super.data()}}function Id(n,e){return typeof e=="string"?Jp(n,e):e instanceof Td?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iw(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Oe(de.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Xp{}class Zp extends Xp{}function Yf(n,e,...t){let s=[];e instanceof Xp&&s.push(e),s=s.concat(t),(function(c){const d=c.filter((m=>m instanceof em)).length,f=c.filter((m=>m instanceof Cd)).length;if(d>1||d>0&&f>0)throw new Oe(de.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(s);for(const a of s)n=a._apply(n);return n}class Cd extends Zp{constructor(e,t,s){super(),this._field=e,this._op=t,this._value=s,this.type="where"}static _create(e,t,s){return new Cd(e,t,s)}_apply(e){const t=this._parse(e);return ow(e._query,t),new xi(e.firestore,e.converter,Ff(e._query,t))}_parse(e){const t=bd(e.firestore);return(function(c,d,f,m,v,x,S){let b;if(v.isKeyField()){if(x==="array-contains"||x==="array-contains-any")throw new Oe(de.INVALID_ARGUMENT,`Invalid Query. You can't perform '${x}' queries on documentId().`);if(x==="in"||x==="not-in"){a_(S,x);const Y=[];for(const z of S)Y.push(i_(m,c,z));b={arrayValue:{values:Y}}}else b=i_(m,c,S)}else x!=="in"&&x!=="not-in"&&x!=="array-contains-any"||a_(S,x),b=ON(f,d,S,x==="in"||x==="not-in");return fn.create(v,x,b)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function aw(n,e,t){const s=e,a=Id("where",n);return Cd._create(a,s,t)}class em extends Xp{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new em(e,t)}_parse(e){const t=this._queryConstraints.map((s=>s._parse(e))).filter((s=>s.getFilters().length>0));return t.length===1?t[0]:Es.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(a,c){let d=a;const f=c.getFlattenedFilters();for(const m of f)ow(d,m),d=Ff(d,m)})(e._query,t),new xi(e.firestore,e.converter,Ff(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class tm extends Zp{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new tm(e,t)}_apply(e){const t=(function(a,c,d){if(a.startAt!==null)throw new Oe(de.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(a.endAt!==null)throw new Oe(de.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Jl(c,d)})(e._query,this._field,this._direction);return new xi(e.firestore,e.converter,(function(a,c){const d=a.explicitOrderBy.concat([c]);return new Qo(a.path,a.collectionGroup,d,a.filters.slice(),a.limit,a.limitType,a.startAt,a.endAt)})(e._query,t))}}function Jf(n,e="asc"){const t=e,s=Id("orderBy",n);return tm._create(s,t)}class nm extends Zp{constructor(e,t,s){super(),this.type=e,this._limit=t,this._limitType=s}static _create(e,t,s){return new nm(e,t,s)}_apply(e){return new xi(e.firestore,e.converter,Ku(e._query,this._limit,this._limitType))}}function zN(n){return nm._create("limit",n,"F")}function i_(n,e,t){if(typeof(t=Zt(t))=="string"){if(t==="")throw new Oe(de.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!ax(e)&&t.indexOf("/")!==-1)throw new Oe(de.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const s=e.path.child(Mt.fromString(t));if(!Ze.isDocumentKey(s))throw new Oe(de.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return wv(n,new Ze(s))}if(t instanceof Xt)return wv(n,t._key);throw new Oe(de.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ld(t)}.`)}function a_(n,e){if(!Array.isArray(n)||n.length===0)throw new Oe(de.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function ow(n,e){const t=(function(a,c){for(const d of a)for(const f of d.getFlattenedFilters())if(c.indexOf(f.op)>=0)return f.op;return null})(n.filters,(function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new Oe(de.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Oe(de.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class BN{convertValue(e,t="none"){switch(ta(e)){case 0:return null;case 1:return e.booleanValue;case 2:return an(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ea(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw st(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const s={};return la(e,((a,c)=>{s[a]=this.convertValue(c,t)})),s}convertVectorValue(e){var t,s,a;const c=(a=(s=(t=e.fields)===null||t===void 0?void 0:t[qu].arrayValue)===null||s===void 0?void 0:s.values)===null||a===void 0?void 0:a.map((d=>an(d.doubleValue)));return new zs(c)}convertGeoPoint(e){return new Us(an(e.latitude),an(e.longitude))}convertArray(e,t){return(e.values||[]).map((s=>this.convertValue(s,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const s=dd(e);return s==null?null:this.convertValue(s,t);case"estimate":return this.convertTimestamp(Kl(e));default:return null}}convertTimestamp(e){const t=Zi(e);return new Bt(t.seconds,t.nanos)}convertDocumentKey(e,t){const s=Mt.fromString(e);At(Px(s),9688,{name:e});const a=new Ql(s.get(1),s.get(3)),c=new Ze(s.popFirst(5));return a.isEqual(t)||mi(`Document ${c} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lw(n,e,t){let s;return s=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,s}class Dl{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Aa extends sw{constructor(e,t,s,a,c,d){super(e,t,s,a,d),this._firestore=e,this._firestoreImpl=e,this.metadata=c}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new ku(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const s=this._document.data.field(Id("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Oe(de.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Aa._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Aa._jsonSchemaVersion="firestore/documentSnapshot/1.0",Aa._jsonSchema={type:pn("string",Aa._jsonSchemaVersion),bundleSource:pn("string","DocumentSnapshot"),bundleName:pn("string"),bundle:pn("string")};class ku extends Aa{data(e={}){return super.data(e)}}class ja{constructor(e,t,s,a){this._firestore=e,this._userDataWriter=t,this._snapshot=a,this.metadata=new Dl(a.hasPendingWrites,a.fromCache),this.query=s}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((s=>{e.call(t,new ku(this._firestore,this._userDataWriter,s.key,s,new Dl(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Oe(de.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(a,c){if(a._snapshot.oldDocs.isEmpty()){let d=0;return a._snapshot.docChanges.map((f=>{const m=new ku(a._firestore,a._userDataWriter,f.doc.key,f.doc,new Dl(a._snapshot.mutatedKeys.has(f.doc.key),a._snapshot.fromCache),a.query.converter);return f.doc,{type:"added",doc:m,oldIndex:-1,newIndex:d++}}))}{let d=a._snapshot.oldDocs;return a._snapshot.docChanges.filter((f=>c||f.type!==3)).map((f=>{const m=new ku(a._firestore,a._userDataWriter,f.doc.key,f.doc,new Dl(a._snapshot.mutatedKeys.has(f.doc.key),a._snapshot.fromCache),a.query.converter);let v=-1,x=-1;return f.type!==0&&(v=d.indexOf(f.doc.key),d=d.delete(f.doc.key)),f.type!==1&&(d=d.add(f.doc),x=d.indexOf(f.doc.key)),{type:$N(f.type),doc:m,oldIndex:v,newIndex:x}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Oe(de.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ja._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=xp.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],s=[],a=[];return this.docs.forEach((c=>{c._document!==null&&(t.push(c._document),s.push(this._userDataWriter.convertObjectMap(c._document.data.value.mapValue.fields,"previous")),a.push(c.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function $N(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return st(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pd(n){n=Ir(n,Xt);const e=Ir(n.firestore,yi);return PN(Ed(e),n._key).then((t=>cw(e,n,t)))}ja._jsonSchemaVersion="firestore/querySnapshot/1.0",ja._jsonSchema={type:pn("string",ja._jsonSchemaVersion),bundleSource:pn("string","QuerySnapshot"),bundleName:pn("string"),bundle:pn("string")};class rm extends BN{constructor(e){super(),this.firestore=e}convertBytes(e){return new Yr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Xt(this.firestore,null,t)}}function vs(n){n=Ir(n,xi);const e=Ir(n.firestore,yi),t=Ed(e),s=new rm(e);return iw(n._query),NN(t,n._query).then((a=>new ja(e,s,n,a)))}function ci(n,e,t){n=Ir(n,Xt);const s=Ir(n.firestore,yi),a=lw(n.converter,e,t);return Nd(s,[ew(bd(s),"setDoc",n._key,a,n.converter!==null,t).toMutation(n._key,Xr.none())])}function _s(n,e,t,...s){n=Ir(n,Xt);const a=Ir(n.firestore,yi),c=bd(a);let d;return d=typeof(e=Zt(e))=="string"||e instanceof Td?MN(c,"updateDoc",n._key,e,t,s):VN(c,"updateDoc",n._key,e),Nd(a,[d.toMutation(n._key,Xr.exists(!0))])}function Na(n){return Nd(Ir(n.firestore,yi),[new Cp(n._key,Xr.none())])}function Ra(n,e){const t=Ir(n.firestore,yi),s=Dt(n),a=lw(n.converter,e);return Nd(t,[ew(bd(n.firestore),"addDoc",s._key,a,n.converter!==null,{}).toMutation(s._key,Xr.exists(!1))]).then((()=>s))}function o_(n,...e){var t,s,a;n=Zt(n);let c={includeMetadataChanges:!1,source:"default"},d=0;typeof e[d]!="object"||s_(e[d])||(c=e[d++]);const f={includeMetadataChanges:c.includeMetadataChanges,source:c.source};if(s_(e[d])){const S=e[d];e[d]=(t=S.next)===null||t===void 0?void 0:t.bind(S),e[d+1]=(s=S.error)===null||s===void 0?void 0:s.bind(S),e[d+2]=(a=S.complete)===null||a===void 0?void 0:a.bind(S)}let m,v,x;if(n instanceof Xt)v=Ir(n.firestore,yi),x=hd(n._key.path),m={next:S=>{e[d]&&e[d](cw(v,n,S))},error:e[d+1],complete:e[d+2]};else{const S=Ir(n,xi);v=Ir(S.firestore,yi),x=S._query;const b=new rm(v);m={next:M=>{e[d]&&e[d](new ja(v,b,S,M))},error:e[d+1],complete:e[d+2]},iw(n._query)}return(function(b,M,Y,z){const V=new Hp(z),te=new Wp(M,V,Y);return b.asyncQueue.enqueueAndForget((async()=>zp(await ed(b),te))),()=>{V.Ou(),b.asyncQueue.enqueueAndForget((async()=>Bp(await ed(b),te)))}})(Ed(v),x,f,m)}function Nd(n,e){return(function(s,a){const c=new di;return s.asyncQueue.enqueueAndForget((async()=>gN(await CN(s),a,c))),c.promise})(Ed(n),e)}function cw(n,e,t){const s=t.docs.get(e._key),a=new rm(n);return new Aa(n,a,e._key,s,new Dl(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WN(){return new hc("deleteField")}function ka(){return new Qp("serverTimestamp")}(function(e,t=!0){(function(a){qo=a})($o),jo(new La("firestore",((s,{instanceIdentifier:a,options:c})=>{const d=s.getProvider("app").getImmediate(),f=new yi(new OI(s.getProvider("auth-internal")),new zI(d,s.getProvider("app-check-internal")),(function(v,x){if(!Object.prototype.hasOwnProperty.apply(v.options,["projectId"]))throw new Oe(de.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ql(v.options.projectId,x)})(d,a),d);return c=Object.assign({useFetchStreams:t},c),f._setSettings(c),f}),"PUBLIC").setMultipleInstances(!0)),Ki(ov,lv,e),Ki(ov,lv,"esm2017")})();const GN={apiKey:"AIzaSyCOOnlmEcAcJywsS93LLfLSywy9ENqnppM",authDomain:"tyler-manga-library.firebaseapp.com",projectId:"tyler-manga-library",storageBucket:"tyler-manga-library.firebasestorage.app",messagingSenderId:"307412068362",appId:"1:307412068362:web:6cfe5666187439dfa757f3"},uw=q_(GN),Jr=DI(uw),at=AN(uw),dw=R.createContext(null);function qN({children:n}){const e="https://discord.com/api/webhooks/1451655828078723156/EA8QhLeiTT-7jOVQ6jFpV2he2zxVpAddAhlu8CiC6RtGFu9wTAOLdRjKeYHIV1OhVbmm",[t,s]=R.useState(null),[a,c]=R.useState(!1),[d,f]=R.useState("viewer"),[m,v]=R.useState(!0),x=async M=>{if(!M)return null;const Y=Dt(at,"users",M.uid);let z=null;try{const te=await Pd(Y);te.exists()&&(z=te.data())}catch(te){console.warn("Failed to read user doc",te)}const V={role:((z==null?void 0:z.role)||"viewer").toLowerCase()==="admin"?"admin":"viewer",email:M.email||(z==null?void 0:z.email)||"",displayName:M.displayName||(z==null?void 0:z.displayName)||"",createdAt:(z==null?void 0:z.createdAt)||ka()};try{if(await ci(Y,V,{merge:!0}),!z&&e)try{const te=M.displayName||M.email||M.uid;await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:`New signup: ${te}`})})}catch(te){console.warn("Failed to send signup webhook",te)}}catch(te){console.error("Failed to ensure user doc",te)}return{...z,...V}};R.useEffect(()=>{const M=Sb(Jr,async Y=>{if(s(Y),Y)try{const z=await x(Y),V=(z==null?void 0:z.role)||"viewer";f(V),c(V.toLowerCase()==="admin")}catch(z){console.error("Error checking role:",z),c(!1),f("viewer")}else c(!1),f("viewer");v(!1)});return()=>M()},[]);const S=async(M,Y)=>{await x0(Jr,M,Y)},b=async()=>{await w0(Jr)};return o.jsx(dw.Provider,{value:{user:t,admin:a,role:d,loading:m,login:S,logout:b},children:n})}function za(){return R.useContext(dw)}function HN({onClose:n}){const[e,t]=R.useState("login"),[s,a]=R.useState(""),[c,d]=R.useState("");async function f(){try{await A0(Jr,new ys),n()}catch(x){alert(x.message)}}async function m(x){x.preventDefault();try{await x0(Jr,s,c),n()}catch(S){alert(S.message)}}async function v(x){x.preventDefault();try{await _b(Jr,s,c),n()}catch(S){alert(S.message)}}return o.jsx("div",{className:"auth-modal-backdrop",onClick:n,children:o.jsxs("div",{className:"auth-modal",onClick:x=>x.stopPropagation(),children:[o.jsx("h2",{className:"auth-title",children:e==="login"?"Sign In":"Create Account"}),o.jsxs("button",{className:"google-btn",onClick:f,children:[o.jsx("img",{src:"https://www.svgrepo.com/show/475656/google-color.svg",alt:"",className:"google-icon"}),"Continue with Google"]}),o.jsx("div",{className:"auth-divider",children:o.jsx("span",{children:"or"})}),o.jsxs("form",{onSubmit:e==="login"?m:v,className:"auth-form",children:[o.jsx("input",{type:"email",placeholder:"Email address",className:"auth-input",value:s,onChange:x=>a(x.target.value),required:!0}),o.jsx("input",{type:"password",placeholder:"Password",className:"auth-input",value:c,onChange:x=>d(x.target.value),required:!0}),o.jsx("button",{className:"auth-submit",children:e==="login"?"Sign In":"Create Account"})]}),o.jsx("div",{className:"auth-switcher",children:e==="login"?o.jsxs("p",{children:["No account?"," ",o.jsx("button",{onClick:()=>t("register"),children:"Register"})]}):o.jsxs("p",{children:["Already have an account?"," ",o.jsx("button",{onClick:()=>t("login"),children:"Sign in"})]})}),o.jsx("button",{className:"auth-close",onClick:n,"aria-label":"Close",children:"X"})]})})}function KN(){var A,W,ye,De,je,Me;const n="google.com",e="oidc.discord",[t,s]=R.useState(!1),[a,c]=R.useState(!1),[d,f]=R.useState(!1),[m,v]=R.useState(!1),[x,S]=R.useState(""),[b,M]=R.useState(""),[Y,z]=R.useState(""),[V,te]=R.useState({google:!1,discord:!1}),[be,we]=R.useState(!1),[ge,ie]=R.useState(!1),[Ee,D]=R.useState(null),N=R.useRef(null),{user:C,admin:O,role:G}=za(),k=tc();R.useEffect(()=>{var ae;f(!1),v(!1),M(""),z(""),ie(!1),S((C==null?void 0:C.displayName)||((ae=C==null?void 0:C.email)==null?void 0:ae.split("@")[0])||"")},[C]),R.useEffect(()=>{let ae=!1;const ze=async()=>{var pe;try{const Be=Yf(Sn(at,"blogPosts"),aw("status","==","published"),Jf("publishedAt","desc"),zN(1)),he=await vs(Be);if(ae)return;if(he.empty){D(null);return}const Qe=he.docs[0],Ye=Qe.data(),_t=(pe=Ye.publishedAt)!=null&&pe.toDate?Ye.publishedAt.toDate():null;if(!_t){D(null);return}const Nt=Ye.title||"New blog post",xt=_t.toISOString().slice(0,10),Ct=`blog-alert-${Qe.id}-${xt}`;if(!(Date.now()-_t.getTime()<=1440*60*1e3)){D(null);return}if(typeof localStorage<"u"&&localStorage.getItem(Ct)==="dismissed")return;D({id:Qe.id,title:Nt,alertKey:Ct,publishedAt:_t})}catch(Be){(Be==null?void 0:Be.code)!=="permission-denied"&&console.error("Failed to load blog alert",Be)}};ze();const Je=setInterval(ze,6e4);return()=>{ae=!0,clearInterval(Je)}},[]);const P=ae=>{Ee!=null&&Ee.alertKey&&typeof localStorage<"u"&&localStorage.setItem(Ee.alertKey,"dismissed"),D(null),k(ae?`/blog?post=${ae}`:"/blog")},ve=ae=>{ae!=null&&ae.stopPropagation&&ae.stopPropagation(),Ee!=null&&Ee.alertKey&&typeof localStorage<"u"&&localStorage.setItem(Ee.alertKey,"dismissed"),D(null)};async function Ge(){try{await w0(Jr),s(!1),f(!1),k("/")}catch(ae){console.error(ae),alert("Logout failed.")}}const Re=()=>{if(!C){s(!1),c(!0);return}f(!1),M(""),z(""),ie(!1),v(!0)},ce=async()=>{if(!C){s(!1),c(!0);return}const ae=(x||"").trim();if(!ae){M("Display name is required.");return}we(!0),M(""),ie(!1);try{await wb(Jr.currentUser,{displayName:ae}),await ci(Dt(at,"users",C.uid),{displayName:ae},{merge:!0}),M("Profile updated."),ie(!1)}catch(ze){console.error("Failed to update profile",ze),M("Failed to update profile.")}finally{we(!1)}},re=ae=>{var ze;return!!((ze=C==null?void 0:C.providerData)!=null&&ze.some(Je=>Je.providerId===ae))},Ie=async()=>{if(!C){s(!1),c(!0);return}if(re(n)){z("Google is already connected.");return}te(ae=>({...ae,google:!0})),z("");try{const ae=new ys,ze=await Xy(Jr.currentUser,ae);await ci(Dt(at,"users",C.uid),{connections:{[n]:{email:ze.user.email||"",connectedAt:ka()}}},{merge:!0}),z("Google connected.")}catch(ae){console.error("Failed to link Google",ae);const ze=(ae==null?void 0:ae.code)==="auth/credential-already-in-use"?"That Google account is already linked elsewhere. Sign in with it instead.":"Could not connect Google.";z(ze)}finally{te(ae=>({...ae,google:!1}))}},xe=async()=>{if(!C){s(!1),c(!0);return}if(re(e)){z("Discord is already connected.");return}te(ae=>({...ae,discord:!0})),z("");try{const ae=new Ml(e);ae.addScope("identify"),ae.addScope("email");const Je=(await Xy(Jr.currentUser,ae)).user.providerData.find(pe=>pe.providerId===e);await ci(Dt(at,"users",C.uid),{connections:{[e]:{username:(Je==null?void 0:Je.displayName)||(Je==null?void 0:Je.uid)||"Discord",email:(Je==null?void 0:Je.email)||"",connectedAt:ka()}}},{merge:!0}),z("Discord connected.")}catch(ae){console.error("Failed to link Discord",ae);const ze=(ae==null?void 0:ae.code)==="auth/credential-already-in-use"?"That Discord account is already linked elsewhere. Sign in with it instead.":"Could not connect Discord.";z(ze)}finally{te(ae=>({...ae,discord:!1}))}},K=async ae=>{if(!C)return;if(C.providerData.length<=1){z("You need at least one sign-in method.");return}const ze=ae===n?"google":"discord";z(""),te(Je=>({...Je,[ze]:!0}));try{await pb(Jr.currentUser,ae),await ci(Dt(at,"users",C.uid),{connections:{[ae]:WN()}},{merge:!0}),z("Connection removed.")}catch(Je){console.error("Failed to unlink",Je),z("Could not remove connection.")}finally{te(Je=>({...Je,[ze]:!1}))}};return o.jsxs(o.Fragment,{children:[Ee&&o.jsxs("div",{className:"blog-alert-banner",onClick:()=>P(Ee.id),role:"button",tabIndex:0,onKeyDown:ae=>{(ae.key==="Enter"||ae.key===" ")&&(ae.preventDefault(),P(Ee.id))},children:[o.jsx("div",{className:"blog-alert-dot"}),o.jsxs("div",{className:"blog-alert-text",children:["New blog post today: ",o.jsx("strong",{children:Ee.title})]}),o.jsxs("div",{className:"blog-alert-actions",children:[o.jsx("button",{type:"button",className:"blog-alert-btn",onClick:ae=>{ae.stopPropagation(),P(Ee.id)},children:"Read now"}),o.jsx("button",{type:"button",className:"blog-alert-dismiss",onClick:ve,children:"Dismiss"})]})]}),o.jsxs("button",{className:`menu-toggle ${t?"active":""}`,onClick:()=>s(!t),children:[o.jsx("span",{}),o.jsx("span",{}),o.jsx("span",{})]}),o.jsxs("nav",{className:`menu-panel ${t?"open":""}`,onMouseLeave:()=>f(!1),children:[o.jsx(Mi,{to:"/",className:"menu-item",onClick:()=>s(!1),children:"Home"}),o.jsx(Mi,{to:"/manga",className:"menu-item",onClick:()=>s(!1),children:"Manga"}),o.jsx(Mi,{to:"/anime",className:"menu-item",onClick:()=>s(!1),children:"Anime"}),o.jsx(Mi,{to:"/tcg",className:"menu-item",onClick:()=>s(!1),children:"TCG"}),o.jsx(Mi,{to:"/music",className:"menu-item",onClick:()=>s(!1),children:"Music"}),o.jsx(Mi,{to:"/steam",className:"menu-item",onClick:()=>s(!1),children:"Gaming"}),O&&o.jsx(Mi,{to:"/blog",className:"menu-item",onClick:()=>s(!1),children:"Blog"}),O&&o.jsx(Mi,{to:"/dashboard",className:"menu-item",onClick:()=>s(!1),children:"Dashboard"}),o.jsxs("div",{className:"menu-footer",children:[o.jsx("div",{className:"profile-divider"}),o.jsxs("div",{className:"profile-card",onMouseEnter:()=>C&&f(!0),onMouseLeave:()=>f(!1),onClick:()=>{C?f(ae=>!ae):(f(!1),s(!1),c(!0))},role:"button",tabIndex:0,onKeyDown:ae=>{(ae.key==="Enter"||ae.key===" ")&&(ae.preventDefault(),C?f(ze=>!ze):(s(!1),c(!0)))},children:[o.jsx("div",{className:"profile-avatar",children:C?(((A=C.displayName)==null?void 0:A[0])||((W=C.email)==null?void 0:W[0])||((ye=C.uid)==null?void 0:ye[0])||"?").toUpperCase():"?"}),o.jsxs("div",{className:"profile-meta",children:[o.jsx("div",{className:"profile-name",children:(C==null?void 0:C.displayName)||(C==null?void 0:C.email)||"Guest"}),o.jsx("div",{className:"profile-role",children:C?O?"admin":G||"viewer":"Not signed in"})]}),C&&d&&o.jsxs("div",{className:"profile-menu",children:[o.jsx("button",{type:"button",className:"profile-menu-item",onClick:Re,children:"Edit profile"}),o.jsx("button",{type:"button",className:"profile-menu-item",onClick:Ge,children:"Sign out"})]})]})]})]}),a&&o.jsx(HN,{onClose:()=>c(!1)}),m&&o.jsx("div",{className:"profile-edit-backdrop",children:o.jsxs("div",{className:"profile-edit-card",children:[o.jsxs("div",{className:"profile-edit-header",children:[o.jsx("h3",{children:"Edit profile"}),o.jsx("button",{type:"button",className:"profile-edit-close",onClick:()=>{v(!1),M(""),z(""),ie(!1)},children:""})]}),o.jsxs("div",{className:"profile-edit-body",children:[o.jsx("div",{className:"profile-edit-avatar",children:C?(((De=C.displayName)==null?void 0:De[0])||((je=C.email)==null?void 0:je[0])||((Me=C.uid)==null?void 0:Me[0])||"?").toUpperCase():"?"}),o.jsxs("div",{className:"profile-edit-field",children:[o.jsx("label",{className:"profile-edit-label",htmlFor:"displayName",children:"Display name"}),o.jsxs("div",{className:"profile-edit-input-row",children:[o.jsx("input",{id:"displayName",className:"profile-edit-input",type:"text",readOnly:!ge,value:x,onChange:ae=>S(ae.target.value),maxLength:40,placeholder:"Enter display name",ref:N,onBlur:()=>{ge&&ce()},onKeyDown:ae=>{ae.key==="Enter"&&ge&&(ae.preventDefault(),ce())}}),o.jsx("button",{type:"button",className:"profile-edit-pencil",onClick:()=>{ie(!0),M(""),setTimeout(()=>{var ae;return(ae=N.current)==null?void 0:ae.focus()},50)},"aria-label":"Edit display name",children:""})]}),o.jsx("div",{className:"profile-edit-hint",children:"Click the pencil to edit. Changes save on blur or Enter."})]})]}),o.jsxs("div",{className:"profile-connections",children:[o.jsxs("div",{className:"profile-connections-header",children:[o.jsx("span",{children:"Connections"}),Y&&o.jsx("span",{className:"profile-connection-status",children:Y})]}),o.jsxs("div",{className:"profile-connection-row",children:[o.jsxs("div",{className:"profile-connection-meta",children:[o.jsx("div",{className:"profile-connection-title",children:"Google"}),o.jsx("div",{className:"profile-connection-sub",children:re(n)?"Connected":"Not connected"})]}),o.jsx("div",{className:"profile-connection-actions",children:re(n)?o.jsx("button",{type:"button",className:"profile-connection-btn secondary",onClick:()=>K(n),disabled:V.google,children:V.google?"Removing...":"Remove"}):o.jsx("button",{type:"button",className:"profile-connection-btn",onClick:Ie,disabled:V.google,children:V.google?"Connecting...":"Connect"})})]}),o.jsxs("div",{className:"profile-connection-row",children:[o.jsxs("div",{className:"profile-connection-meta",children:[o.jsx("div",{className:"profile-connection-title",children:"Discord"}),o.jsx("div",{className:"profile-connection-sub",children:re(e)?"Connected":"Not connected"})]}),o.jsx("div",{className:"profile-connection-actions",children:re(e)?o.jsx("button",{type:"button",className:"profile-connection-btn secondary",onClick:()=>K(e),disabled:V.discord,children:V.discord?"Removing...":"Remove"}):o.jsx("button",{type:"button",className:"profile-connection-btn",onClick:xe,disabled:V.discord,children:V.discord?"Connecting...":"Connect"})})]})]}),b&&o.jsx("div",{className:"profile-edit-status",children:b}),be&&o.jsx("div",{className:"profile-edit-status saving",children:"Saving..."})]})})]})}function l_(){const n="Tyler's Collection's and Hobbies",e="",[t,s]=R.useState(""),[a,c]=R.useState(!0),d=R.useRef(null),[f,m]=R.useState("jp"),[v,x]=R.useState(1);return R.useEffect(()=>{document.title="Tyler's Collection"},[]),R.useEffect(()=>(d.current=setInterval(()=>c(S=>!S),450),()=>{d.current&&clearInterval(d.current)}),[]),R.useEffect(()=>{let S=!1;const b=z=>new Promise(V=>setTimeout(V,z)),M=async(z,V=120)=>{for(let te=1;te<=z.length;te+=1){if(S)return;s(z.slice(0,te)),await b(V)}},Y=async(z,V=70)=>{for(let te=z.length;te>=0;te-=1){if(S)return;s(z.slice(0,te)),await b(V)}};return(async()=>{if(localStorage.getItem("homeTitleTyped")==="1"){m("en"),s(n),c(!1),d.current&&clearInterval(d.current);return}await b(250),m("jp"),await M(e,140),await b(6e3),await Y(e,80),await b(320);const V=n;for(let te=1;te<=V.length;te+=1){if(S)return;s(V.slice(0,te)),te===4&&m("en"),await b(110)}m("en"),await b(2e3),c(!1),localStorage.setItem("homeTitleTyped","1"),d.current&&clearInterval(d.current)})(),()=>{S=!0}},[]),o.jsxs("main",{className:"page",children:[o.jsxs("header",{style:{textAlign:"center",marginTop:"32px",marginBottom:"24px"},children:[o.jsxs("h1",{style:{margin:0,fontSize:"2.2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",display:"inline-flex",alignItems:"center",gap:"6px"},children:[o.jsx("span",{children:t||" "}),o.jsx("span",{style:{width:"6px",height:"1.1em",background:"#ffb6c1",opacity:a?1:0,transition:"opacity 0.15s ease"}})]}),o.jsx("p",{style:{margin:"6px 0 0",color:"var(--text-soft)",fontSize:"0.95rem",opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"TCG":"This is my personal webpage to see what is on my shelves, wishlists, and TCG collections."}),o.jsx("div",{style:{display:"inline-flex",alignItems:"center",gap:"10px",padding:"8px 14px",borderRadius:"999px",border:"1px solid rgba(255,182,193,0.5)",background:"linear-gradient(135deg, rgba(255,182,193,0.18), rgba(43,15,29,0.9))",boxShadow:"0 8px 24px rgba(0,0,0,0.55)",marginTop:"14px",fontSize:"0.78rem",color:"#ffe6ed",letterSpacing:"0.05em",textTransform:"uppercase",fontWeight:700,opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?o.jsx("span",{style:{letterSpacing:"0.06em"},children:"          TCG"}):o.jsx("span",{style:{letterSpacing:"0.06em"},children:" Manga   Anime   Music   TCG"})})]}),o.jsxs("section",{style:{display:"grid",gridTemplateColumns:"minmax(0, 2fr) minmax(0, 3fr)",gap:"20px",marginTop:"24px"},children:[o.jsxs("article",{className:"card",children:[o.jsx("h2",{style:{marginTop:0,marginBottom:"8px",fontSize:"1.2rem",color:"#ffb6c1"},children:o.jsx("span",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"About Me"})}),o.jsx("p",{style:{margin:0,color:"var(--text-soft)",fontSize:"0.9rem",lineHeight:1.5,opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"im.okTCG":"Hey, I am Tyler and I go by im.ok. I hoard manga, binge anime, and collect trading cards."}),o.jsx("p",{style:{marginTop:"10px",color:"var(--text-soft)",fontSize:"0.9rem",opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"TCG":"This site is where I track everything: volumes on my shelves, finished shows, and my TCG collection as they all slowly grow."}),o.jsxs("div",{style:{marginTop:"12px",display:"flex",flexWrap:"wrap",gap:"6px",opacity:v,transition:"opacity 0.25s ease"},children:[o.jsx("span",{className:"pill",children:f==="jp"?"":"Manga library"}),o.jsx("span",{className:"pill",children:f==="jp"?"":"My Anime List (MAL)"}),o.jsx("span",{className:"pill",children:f==="jp"?" & TCG":"Pokemon & One Piece TCG"}),o.jsx("span",{className:"pill",children:f==="jp"?"":"Data Nerd"})]})]}),o.jsxs("article",{className:"card",children:[o.jsx("h2",{style:{marginTop:0,marginBottom:"8px",fontSize:"1.2rem",color:"#ffb6c1"},children:o.jsx("span",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Explore these pages"})}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(210px, 1fr))",gap:"14px",marginTop:"10px"},children:[o.jsxs("a",{href:"/base/manga",className:"section-card",children:[o.jsx("h3",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Manga Library"}),o.jsx("p",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Full manga collection & wishlist."}),o.jsx("div",{className:"section-chip-row",children:o.jsx("span",{className:"section-chip accent",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Library & wishlist"})})]}),o.jsxs("a",{href:"/base/music",className:"section-card",style:{justifySelf:"end",alignSelf:"end",order:99},children:[o.jsx("h3",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Music"}),o.jsx("p",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"If you are here for my music, this is the page for you! Catch all the latest releases."}),o.jsxs("div",{className:"section-chip-row",children:[o.jsx("span",{className:"section-chip accent",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Latest tracks"}),o.jsx("span",{className:"section-chip",style:{opacity:v,transition:"opacity 0.25s ease"},children:"Spotify & SoundCloud"})]})]}),o.jsxs("a",{href:"/base/anime",className:"section-card",children:[o.jsx("h3",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Anime Library"}),o.jsx("p",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"MAL":"The entire watched, plan to watch, and watching list synced directly from MyAnimeList."}),o.jsxs("div",{className:"section-chip-row",children:[o.jsx("span",{className:"section-chip accent",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"MAL":"MAL synced"}),o.jsx("span",{className:"section-chip",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Status filters"}),o.jsx("span",{className:"section-chip",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Quick stats"})]})]}),o.jsxs("a",{href:"/base/tcg",className:"section-card",children:[o.jsx("h3",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"TCG":"TCG Collection"}),o.jsx("p",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"TCG":"Pokemon & One Piece TCG cards tracked with quantities, prices, and value."}),o.jsxs("div",{className:"section-chip-row",children:[o.jsx("span",{className:"section-chip accent",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Full Collection"}),o.jsx("span",{className:"section-chip",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Still Under-Construction"})]})]})]})]})]}),o.jsx("footer",{style:{marginTop:"28px",fontSize:"0.78rem",color:"var(--text-soft)",textAlign:"center"},children:"@ 2025 im.ok. All rights reserved."})]})}const QN="modulepreload",YN=function(n){return"/base/"+n},c_={},pc=function(e,t,s){let a=Promise.resolve();if(t&&t.length>0){let d=function(v){return Promise.all(v.map(x=>Promise.resolve(x).then(S=>({status:"fulfilled",value:S}),S=>({status:"rejected",reason:S}))))};document.getElementsByTagName("link");const f=document.querySelector("meta[property=csp-nonce]"),m=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));a=d(t.map(v=>{if(v=YN(v),v in c_)return;c_[v]=!0;const x=v.endsWith(".css"),S=x?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${v}"]${S}`))return;const b=document.createElement("link");if(b.rel=x?"stylesheet":QN,x||(b.as="script"),b.crossOrigin="",b.href=v,m&&b.setAttribute("nonce",m),document.head.appendChild(b),x)return new Promise((M,Y)=>{b.addEventListener("load",M),b.addEventListener("error",()=>Y(new Error(`Unable to preload CSS for ${v}`)))})}))}function c(d){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=d,window.dispatchEvent(f),!f.defaultPrevented)throw d}return a.then(d=>{for(const f of d||[])f.status==="rejected"&&c(f.reason);return e().catch(c)})};function hw({open:n,title:e,placeholder:t,value:s,status:a,loading:c,onChange:d,onSubmit:f,onClose:m}){if(!n)return null;const v=typeof a=="string"&&a.toLowerCase().startsWith("sent!")?"#a3f0cf":"#ffb6c1";return o.jsx("div",{className:"suggestion-backdrop",onClick:x=>{x.target===x.currentTarget&&m&&m()},children:o.jsxs("div",{className:"suggestion-modal",children:[o.jsxs("div",{className:"suggestion-modal-header",children:[o.jsx("h3",{children:e}),o.jsx("button",{className:"suggestion-close",type:"button",onClick:m,"aria-label":"Close",children:"X"})]}),o.jsx("p",{className:"suggestion-hint",children:"Tell me what to add next. Titles only is fine, but extra notes are welcome."}),o.jsx("textarea",{className:"suggestion-textarea",placeholder:t,value:s,onChange:x=>d==null?void 0:d(x.target.value),maxLength:500}),a&&o.jsx("div",{className:"suggestion-status",style:{color:v},children:a}),o.jsxs("div",{className:"suggestion-actions",children:[o.jsx("button",{className:"suggestion-send",type:"button",onClick:f,disabled:c,children:c?"Sending...":"Send Suggestion"}),o.jsx("button",{className:"suggestion-cancel",type:"button",onClick:m,children:"Cancel"})]})]})})}const sm="mangaLibraryActivityLog",Ca="https://discord.com/api/webhooks/1448329790942613667/wsC8psNZ-Ax2D1O9Gl4sJi6ay7df2cr7IrIdxMPwGZTBnkSUIY2NDpeVd98qW_4plz82";let xo=null;function JN(n){return Array.isArray(n)?n.map(e=>({message:e.message,ts:e.ts?new Date(e.ts):new Date,user:e.user||e.email||"",context:e.context||"",details:Array.isArray(e.details)?e.details:[]})).filter(e=>e.message):[]}function XN(){if(typeof window>"u")return[];try{const n=localStorage.getItem(sm);if(!n)return[];const e=JSON.parse(n);return JN(e)}catch(n){return console.warn("Failed to read activity log",n),[]}}function fw(n){try{const e=(n||[]).slice(0,100).map(t=>({message:t.message,ts:t.ts instanceof Date?t.ts.toISOString():t.ts,user:t.user||"",context:t.context||"",details:t.details||[]}));typeof window<"u"&&localStorage.setItem(sm,JSON.stringify(e))}catch(e){console.warn("Failed to persist activity log",e)}}async function ZN(){if(xo)return xo;try{const n=Dt(at,"settings","webhooks"),e=await Pd(n);if(e.exists())return xo=e.data().activity||Ca,xo}catch(n){console.warn("Failed to load activity webhook",n)}return xo=Ca,xo}function u_(n){if(n==null)return"";if(typeof n=="object")try{return JSON.stringify(n)}catch{return String(n)}return String(n)}function eR(n){return n?typeof n=="string"?[n]:Array.isArray(n)?n.map(e=>u_(e)):typeof n=="object"?Object.entries(n).map(([e,t])=>`${e}: ${u_(t)}`):[]:[]}async function tR(n,e={}){if(n)try{const{email:t,name:s,webhookOverride:a,context:c,list:d,action:f,detailLines:m=[]}=e,v=a||await ZN();if(!v)return;const x=(s||"").trim()||t||"anonymous",S=new Date,b=Intl.DateTimeFormat().resolvedOptions().timeZone||"local time",M=[];M.push(" **Library Activity**"),M.push(` ${n}`),M.push(` ${x}       ${S.toLocaleString()} (${b})`);const Y=[];c&&Y.push(`Context: ${c}`),d&&Y.push(`List: ${d}`),f&&Y.push(`Action: ${f}`),Y.length&&M.push(Y.join("      ")),m.length&&(M.push(" Details:"),m.forEach(z=>M.push(` ${z}`))),await fetch(v,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:M.join(`
`)})})}catch(t){console.warn("Activity webhook failed",t)}}async function pw(n,e={}){if(!n)return null;const{email:t,name:s,webhookOverride:a,persistLocal:c=!0,context:d="",list:f="",action:m="",details:v=null}=e,x=eR(v),S={message:n,ts:new Date,user:(s||"").trim()||t||"",context:d,details:x};if(c){const b=XN(),M=[S,...b].slice(0,100);fw(M)}return await tR(n,{email:t,name:s,webhookOverride:a,context:d,list:f,action:m,detailLines:x}),S}const d_=5,nR=3600*1e3,h_="mangaSuggestionsSent",f_="mangaViewMode";function kt(n){let e=(n||"").trim();const t=e.match(/^(.*?)(?:,?\s*(?:Vol\.|Volume)\s*(\d+)(?:\s*[--]\s*\d+)?\s*)?(?:\s*\([^)]*\))?$/i),s=t?t[1].trim().toLowerCase():e.toLowerCase(),a=t&&t[2]?parseInt(t[2],10):0;return{name:s,vol:Number.isFinite(a)?a:0}}function rR(n){if(typeof n=="number")return n;if(n==null||n==="")return 0;const e=parseInt(n,10);return Number.isFinite(e)?e:0}function p_(){const n=new Date,e=n.getFullYear(),t=String(n.getMonth()+1).padStart(2,"0"),s=String(n.getDate()).padStart(2,"0");return`${e}-${t}-${s}`}function Eu(n){const e=(n==null?void 0:n.pageCount)??(n==null?void 0:n.PageCount)??"",t=String(e??"").trim();if(!t)return!0;const s=rR(t);return!Number.isFinite(s)||s<=0}function Ao(n,e=!1){const t=(n??"").toString().trim();return!t||!e&&t.toLowerCase()==="unknown"}function wo(n){const e=Ao(n==null?void 0:n.authors),t=Ao(n==null?void 0:n.publisher),s=Ao(n==null?void 0:n.date);return{authorMissing:e,publisherMissing:t,dateMissing:s,any:e||t||s}}function Tr(n){if(!n)return"";const e=String(n).trim();if(/^\d{4}-\d{2}-\d{2}$/.test(e))return e;const t=new Date(e);if(Number.isNaN(t.getTime()))return"";const s=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),c=String(t.getDate()).padStart(2,"0");return`${s}-${a}-${c}`}const sR=(n,e)=>{const t=kt(n.title||""),s=kt(e.title||""),a=t.name.localeCompare(s.name);return a!==0?a:t.vol-s.vol};function iR(n){const t=(n||"").match(/vol(?:ume)?\.?\s*(\d+)(?:\s*[-]\s*(\d+))?/i);if(!t)return[];const s=parseInt(t[1],10),a=t[2]?parseInt(t[2],10):s;if(!Number.isFinite(s))return[];const c=Number.isFinite(a)&&a>=s?a:s,d=[];for(let f=s;f<=c;f+=1)d.push(f);return d}function aR(){const{admin:n,user:e,role:t}=za(),s=n,a=(w,B={})=>{w&&pw(w,{email:(e==null?void 0:e.email)||"anonymous",name:(e==null?void 0:e.displayName)||"",context:"Manga",...B})},[c,d]=R.useState("library"),[f,m]=R.useState(()=>typeof window>"u"?"series":localStorage.getItem(f_)==="individual"?"individual":"series");R.useEffect(()=>{document.title="Manga | Library"},[]),R.useEffect(()=>{Je("")},[e]),R.useEffect(()=>{try{localStorage.setItem(f_,f)}catch(w){console.warn("Failed to persist manga view mode",w)}},[f]);const v=async()=>{const w=Date.now(),$=(()=>{try{const L=localStorage.getItem(h_);return Array.isArray(JSON.parse(L))?JSON.parse(L):[]}catch{return[]}})().filter(L=>w-L<nR);if($.length>=d_){Je("Rate limit: please wait a bit (max 5 suggestions per hour).");return}if(!Me.trim()){Je("Please enter a manga title or note before sending.");return}Be(!0),Je("");try{const L=`**Manga Suggestion**
${Me.trim()}
From: ${(e==null?void 0:e.displayName)||(e==null?void 0:e.email)||(e==null?void 0:e.uid)||"anonymous user"}`;await Ra(Sn(at,"suggestions"),{content:Me.trim(),type:"manga",from:(e==null?void 0:e.displayName)||(e==null?void 0:e.email)||(e==null?void 0:e.uid)||"anonymous user",createdAt:new Date().toISOString()}),Je("Sent! I'll review your suggestion soon."),ae("");const q=[...$,w].slice(-d_);localStorage.setItem(h_,JSON.stringify(q))}catch(L){console.error("Failed to send suggestion",L),Je("Failed to send suggestion. Please try again later.")}finally{Be(!1)}},[x,S]=R.useState([]),[b,M]=R.useState([]),[Y,z]=R.useState([]),[V,te]=R.useState([]),[be,we]=R.useState(!1),[ge,ie]=R.useState(!0),[Ee,D]=R.useState(""),[N,C]=R.useState(""),[O,G]=R.useState(""),[k,P]=R.useState(!1),[ve,Ge]=R.useState(()=>new Set);R.useEffect(()=>{f==="series"&&k&&(typeof Ye>"u"||Ye===null)&&(P(!1),Ge(new Set))},[f,k]);const[Re,ce]=R.useState({open:!1,mode:"add",list:"library",data:{title:"",authors:"",publisher:"",demographic:"",genre:"",subGenre:"",date:"",cover:"",isbn:"",pageCount:"",rating:"",amountPaid:"",dateRead:"",datePurchased:"",msrp:"",special:!1,specialType:"",specialVolumes:"",collectiblePrice:"",amazonURL:"",read:!1},editingId:null,multiAdd:!1,startVol:"",endVol:""}),[re,Ie]=R.useState([]),[xe,K]=R.useState(0),A=R.useMemo(()=>({author:Ao(Re.data.authors),publisher:Ao(Re.data.publisher),date:Ao(Re.data.date),page:Eu({pageCount:Re.data.pageCount})}),[Re.data]),[W,ye]=R.useState({open:!1,index:0,items:[]}),[De,je]=R.useState(!1),[Me,ae]=R.useState(""),[ze,Je]=R.useState(""),[pe,Be]=R.useState(!1),[he,Qe]=R.useState(null),[Ye,_t]=R.useState(null);R.useEffect(()=>{if(!!he||!!Ye||Re.open||W.open||De){const B=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=B}}},[he,Ye,Re.open,W.open,De]);const Nt=!!e&&t==="viewer";async function xt(){const w=await vs(Sn(at,"library")),B=[];w.forEach($=>{const L=$.data();B.push({id:$.id,title:L.title||"",authors:L.authors||"Unknown",publisher:L.publisher||"Unknown",demographic:L.demographic||"",genre:L.genre||"",subGenre:L.subGenre||"",date:Tr(L.date)||L.date||"Unknown",cover:L.cover||"",isbn:L.isbn||"",pageCount:L.pageCount!==void 0&&L.pageCount!==null?L.pageCount:"",rating:L.rating!==void 0&&L.rating!==null?L.rating:"",amountPaid:L.amountPaid!==void 0&&L.amountPaid!==null?L.amountPaid:"",dateRead:Tr(L.dateRead)||L.dateRead||"",datePurchased:Tr(L.datePurchased)||L.datePurchased||"",msrp:L.msrp!==void 0&&L.msrp!==null?L.msrp:"",specialType:L.specialType||"",specialVolumes:L.specialVolumes!==void 0&&L.specialVolumes!==null?L.specialVolumes:"",collectiblePrice:L.collectiblePrice!==void 0&&L.collectiblePrice!==null?L.collectiblePrice:"",read:!!L.read,amazonURL:L.amazonURL||"",hidden:!!L.hidden,kind:"library"})}),B.sort(($,L)=>{const q=kt($.title),oe=kt(L.title),se=q.name.localeCompare(oe.name);return se!==0?se:q.vol-oe.vol}),S(B),z($=>{const L=new Set($);return B.forEach(q=>L.add(q.title||"")),Array.from(L).filter(Boolean).sort()})}async function Ct(){const w=await vs(Sn(at,"wishlist")),B=[];w.forEach($=>{const L=$.data();B.push({id:$.id,title:L.title||"",authors:L.authors||"Unknown",publisher:L.publisher||"Unknown",date:Tr(L.date)||L.date||"Unknown",cover:L.cover||"",isbn:L.isbn||"",pageCount:L.pageCount!==void 0&&L.pageCount!==null?L.pageCount:"",rating:L.rating!==void 0&&L.rating!==null?L.rating:"",amountPaid:L.amountPaid!==void 0&&L.amountPaid!==null?L.amountPaid:"",datePurchased:Tr(L.datePurchased)||L.datePurchased||"",specialType:L.specialType||"",specialVolumes:L.specialVolumes!==void 0&&L.specialVolumes!==null?L.specialVolumes:"",collectiblePrice:L.collectiblePrice!==void 0&&L.collectiblePrice!==null?L.collectiblePrice:"",amazonURL:L.amazonURL||"",hidden:!!L.hidden,kind:"wishlist"})}),B.sort(($,L)=>{const q=kt($.title),oe=kt(L.title),se=q.name.localeCompare(oe.name);return se!==0?se:q.vol-oe.vol}),M(B),z($=>{const L=new Set($);return B.forEach(q=>L.add(q.title||"")),Array.from(L).filter(Boolean).sort()})}R.useEffect(()=>{let w=!1,B=!1,$=!1;const L=async()=>{if(!w)try{const Pe=await fetch("/base/manga-library-wishlist.json",{cache:"no-cache"});if(!Pe.ok)throw new Error("fallback fetch failed");const ke=await Pe.json(),le=Array.isArray(ke.library)?ke.library:[],ot=Array.isArray(ke.wishlist)?ke.wishlist:[];S(le.map((Le,ht)=>({id:Le.id||`offline-lib-${ht}`,title:Le.title||"",authors:Le.authors||"Unknown",publisher:Le.publisher||"Unknown",demographic:Le.demographic||"",genre:Le.genre||"",subGenre:Le.subGenre||"",date:Tr(Le.date)||Le.date||"Unknown",cover:Le.cover||"",isbn:Le.isbn||"",pageCount:Le.pageCount??"",rating:Le.rating??"",amountPaid:Le.amountPaid??"",dateRead:Tr(Le.dateRead)||Le.dateRead||"",datePurchased:Tr(Le.datePurchased)||Le.datePurchased||"",msrp:Le.msrp??"",specialType:Le.specialType||"",specialVolumes:Le.specialVolumes??"",collectiblePrice:Le.collectiblePrice??"",amazonURL:Le.amazonURL||"",read:!!Le.read,hidden:!!Le.hidden,kind:"library"}))),M(ot.map((Le,ht)=>({id:Le.id||`offline-wish-${ht}`,title:Le.title||"",authors:Le.authors||"Unknown",publisher:Le.publisher||"Unknown",demographic:Le.demographic||"",genre:Le.genre||"",subGenre:Le.subGenre||"",date:Tr(Le.date)||Le.date||"Unknown",cover:Le.cover||"",isbn:Le.isbn||"",pageCount:Le.pageCount??"",rating:Le.rating??"",amountPaid:Le.amountPaid??"",dateRead:Tr(Le.dateRead)||Le.dateRead||"",datePurchased:Tr(Le.datePurchased)||Le.datePurchased||"",msrp:Le.msrp??"",specialType:Le.specialType||"",specialVolumes:Le.specialVolumes??"",collectiblePrice:Le.collectiblePrice??"",amazonURL:Le.amazonURL||"",read:!!Le.read,hidden:!!Le.hidden,kind:"wishlist"}))),D("")}catch(Ce){console.error("Offline fallback failed",Ce),D("Failed to load manga data from Firestore.")}finally{w||ie(!1)}},q=()=>{B&&$&&!w&&ie(!1)};if(!e)return;ie(!0),D("");const oe=o_(Sn(at,"library"),Ce=>{if(w)return;const Pe=[];Ce.forEach(ke=>{const le=ke.data();Pe.push({id:ke.id,title:le.title||"",authors:le.authors||"Unknown",publisher:le.publisher||"Unknown",demographic:le.demographic||"",genre:le.genre||"",subGenre:le.subGenre||"",date:le.date||"Unknown",cover:le.cover||"",isbn:le.isbn||"",pageCount:le.pageCount!==void 0&&le.pageCount!==null?le.pageCount:"",rating:le.rating!==void 0&&le.rating!==null?le.rating:"",amountPaid:le.amountPaid!==void 0&&le.amountPaid!==null?le.amountPaid:"",dateRead:le.dateRead||"",datePurchased:le.datePurchased||"",msrp:le.msrp!==void 0&&le.msrp!==null?le.msrp:"",specialType:le.specialType||"",specialVolumes:le.specialVolumes!==void 0&&le.specialVolumes!==null?le.specialVolumes:"",collectiblePrice:le.collectiblePrice!==void 0&&le.collectiblePrice!==null?le.collectiblePrice:"",read:!!le.read,amazonURL:le.amazonURL||"",hidden:!!le.hidden,kind:"library"})}),Pe.sort((ke,le)=>{const ot=kt(ke.title),Le=kt(le.title),ht=ot.name.localeCompare(Le.name);return ht!==0?ht:ot.vol-Le.vol}),S(Pe),z(ke=>{const le=new Set(ke);return Pe.forEach(ot=>le.add(ot.title||"")),Array.from(le).filter(Boolean).sort()}),B=!0,q()},async Ce=>{console.error("Library listener failed",Ce),w||(D("Failed to load manga data from Firestore."),await L())}),se=o_(Sn(at,"wishlist"),Ce=>{if(w)return;const Pe=[];Ce.forEach(ke=>{const le=ke.data();Pe.push({id:ke.id,title:le.title||"",authors:le.authors||"Unknown",publisher:le.publisher||"Unknown",demographic:le.demographic||"",genre:le.genre||"",subGenre:le.subGenre||"",date:le.date||"Unknown",cover:le.cover||"",isbn:le.isbn||"",pageCount:le.pageCount!==void 0&&le.pageCount!==null?le.pageCount:"",rating:le.rating!==void 0&&le.rating!==null?le.rating:"",amountPaid:le.amountPaid!==void 0&&le.amountPaid!==null?le.amountPaid:"",datePurchased:le.datePurchased||"",specialType:le.specialType||"",specialVolumes:le.specialVolumes!==void 0&&le.specialVolumes!==null?le.specialVolumes:"",collectiblePrice:le.collectiblePrice!==void 0&&le.collectiblePrice!==null?le.collectiblePrice:"",amazonURL:le.amazonURL||"",hidden:!!le.hidden,kind:"wishlist"})}),Pe.sort((ke,le)=>{const ot=kt(ke.title),Le=kt(le.title),ht=ot.name.localeCompare(Le.name);return ht!==0?ht:ot.vol-Le.vol}),M(Pe),z(ke=>{const le=new Set(ke);return Pe.forEach(ot=>le.add(ot.title||"")),Array.from(le).filter(Boolean).sort()}),$=!0,q()},async Ce=>{console.error("Wishlist listener failed",Ce),w||(D("Failed to load manga data from Firestore."),await L())});return()=>{w=!0,oe==null||oe(),se==null||se()}},[e]);const en=R.useMemo(()=>{const w=N.trim().toLowerCase();return w?x.filter(B=>[B.title,B.authors,B.publisher,B.isbn,B.date,String(B.pageCount??"")].join(" ").toLowerCase().includes(w)):x},[x,N]),mn=R.useMemo(()=>s&&be?en:en.filter(w=>!w.hidden),[en,s,be]),ln=R.useMemo(()=>{const w=O.trim().toLowerCase();return w?b.filter(B=>[B.title,B.authors,B.publisher,B.isbn,B.date,String(B.pageCount??"")].join(" ").toLowerCase().includes(w)):b},[b,O]),fr=R.useMemo(()=>s&&be?ln:ln.filter(w=>!w.hidden),[ln,s,be]),tn=w=>{m(w==="individual"?"individual":"series"),Ge(new Set),P(!1)},Kn=w=>{if(!(w!=null&&w.length))return;const B=($,L)=>{let q=[...$];return w.filter(oe=>oe.target===L).forEach(oe=>{const se=q.findIndex(Pe=>Pe.id===oe.id),Ce={...se>=0?q[se]:{},...oe.payload,id:oe.id,kind:L};se>=0?q[se]=Ce:q.push(Ce)}),q.sort(sR),q};S($=>B($,"library")),M($=>B($,"wishlist"))},Ot=w=>{P(B=>{const $=!B;if($){const L=new Set((w||[]).map(q=>q.id));Ge(q=>new Set([...q].filter(oe=>L.has(oe))))}else Ge(new Set);return $})};function $t(){s&&(P(w=>!w),Ge(new Set))}function On(w){Ge(B=>{const $=new Set(B);return $.has(w)?$.delete(w):$.add(w),$})}async function lr(w,B=null){if(!s){alert("Multi-select actions require admin access.");return}const $=Array.from(ve);if(!$.length){alert("Select at least one item first.");return}const L=c==="library"?"library":"wishlist",q=B||(L==="library"?"wishlist":"library"),oe=L==="library";try{if(w==="move"){const se=L==="library"?x:b;if(!window.confirm(`Move ${$.length} item(s) from ${L==="library"?"Library":"Wishlist"} to ${q==="library"?"Library":"Wishlist"}?`))return;for(const Ce of $){const Pe=se.find(le=>le.id===Ce);if(!Pe)continue;const ke=q==="library"?{title:Pe.title,authors:Pe.authors,publisher:Pe.publisher,date:Pe.date,pageCount:Pe.pageCount||"",cover:Pe.cover,amountPaid:"",read:!1,rating:"",msrp:"",collectiblePrice:"",specialType:"",specialVolumes:"",isbn:Pe.isbn||"",demographic:Pe.demographic||"",genre:Pe.genre||"",subGenre:Pe.subGenre||"",hidden:!!Pe.hidden,datePurchased:Pe.datePurchased||"",dateRead:Pe.dateRead||""}:{title:Pe.title,authors:Pe.authors,publisher:Pe.publisher,date:Pe.date,pageCount:Pe.pageCount||"",cover:Pe.cover,amazonURL:Pe.amazonURL||"",hidden:!!Pe.hidden,datePurchased:"",read:!1,rating:"",msrp:"",collectiblePrice:"",specialType:"",specialVolumes:"",isbn:"",demographic:"",genre:"",subGenre:""};await Ra(Sn(at,q),ke),await Na(Dt(at,L,Ce))}a(`Moved ${$.length} item${$.length===1?"":"s"} from ${L==="library"?"Library":"Wishlist"} to ${q==="library"?"Library":"Wishlist"}`,{action:"move",list:L==="library"?"Library":"Wishlist",details:{count:$.length,from:L,to:q}})}else if(w==="markRead"&&oe){for(const se of $)await _s(Dt(at,"library",se),{read:!0,dateRead:p_()});a(`Marked ${$.length} library book${$.length===1?"":"s"} as read`,{action:"markRead",list:"Library",details:{count:$.length}})}else if(w==="markUnread"&&oe){for(const se of $)await _s(Dt(at,"library",se),{read:!1,dateRead:"",rating:""});a(`Marked ${$.length} library book${$.length===1?"":"s"} as unread`,{action:"markUnread",list:"Library",details:{count:$.length}})}else if(w==="delete"){const se=oe?"library":"wishlist";if(!window.confirm(`Delete ${$.length} item(s) from ${oe?"Library":"Wishlist"}?`))return;for(const Ce of $)await Na(Dt(at,se,Ce));a(`Deleted ${$.length} item${$.length===1?"":"s"} from ${se==="library"?"Library":"Wishlist"}`,{action:"delete-multi",list:se==="library"?"Library":"Wishlist",details:{count:$.length}})}await Promise.all([xt(),Ct()]),Ge(new Set),P(!1)}catch(se){console.error(se),alert("Failed to apply multi-select action.")}}function In(w){Qe(w)}function Fn(){Qe(null)}function Qt(w){const B=Un.filter($=>(kt($.title||"").name||($.title||"").toLowerCase()||$.id)===w.key).sort(($,L)=>kt($.title).vol-kt(L.title).vol);_t({series:w,volumes:B})}function es(){_t(null)}const Cn=()=>{ce(w=>({...w,open:!1,mode:"add",editingId:null,data:{title:"",authors:"",publisher:"",demographic:"",genre:"",subGenre:"",date:"",cover:"",isbn:"",pageCount:"",rating:"",amountPaid:"",dateRead:"",datePurchased:"",msrp:"",special:!1,specialType:"",specialVolumes:"",collectiblePrice:"",amazonURL:"",read:!1,hidden:!1},multiAdd:!1,startVol:"",endVol:""})),Ie([]),K(0)},gn=R.useMemo(()=>{const w=new Map;return[...x,...b].forEach(B=>{const $=kt(B.title||"");if(!$.name)return;const L=(B.title||"").replace(/,?\s*Vol\.?\s*\d+.*/i,"").trim()||B.title||$.name;if(!w.has($.name))w.set($.name,{display:L,maxVol:$.vol,authors:B.authors||"",publisher:B.publisher||"",demographic:B.demographic||""});else{const q=w.get($.name);q.maxVol=Math.max(q.maxVol,$.vol),!q.authors&&B.authors&&(q.authors=B.authors),!q.publisher&&B.publisher&&(q.publisher=B.publisher),!q.demographic&&B.demographic&&(q.demographic=B.demographic)}}),w},[x,b]),ts=w=>{ce(B=>({...B,open:!0,mode:"add",list:w,editingId:null,data:{...B.data,title:"",list:w}})),Ie([{kind:"new",id:null,data:{title:"",authors:"",publisher:"",demographic:"",genre:"",subGenre:"",date:"",cover:"",isbn:"",pageCount:"",rating:"",amountPaid:"",dateRead:"",datePurchased:"",msrp:"",specialType:"",specialVolumes:"",collectiblePrice:"",amazonURL:"",read:!1}}]),K(0)},Ts=w=>{const B={open:!0,mode:"edit",list:w.kind==="wishlist"?"wishlist":"library",editingId:w.id,data:{title:w.title||"",authors:w.authors||"",publisher:w.publisher||"",demographic:w.demographic||"",genre:w.genre||"",subGenre:w.subGenre||"",date:w.date||"",cover:w.cover||"",isbn:w.isbn||"",pageCount:w.pageCount||"",rating:w.rating||"",amountPaid:w.amountPaid||"",dateRead:w.dateRead||"",datePurchased:w.datePurchased||"",msrp:w.msrp||"",special:!!(w.specialType||w.specialVolumes||w.collectiblePrice),specialType:w.specialType||"",specialVolumes:w.specialVolumes||"",collectiblePrice:w.collectiblePrice||"",amazonURL:w.amazonURL||"",read:!!w.read,hidden:!!w.hidden}};ce(B),Ie([{kind:"edit",id:w.id,data:{...B.data}}]),K(0)},Pt=(w,B,$="text")=>{if(ce(L=>{const q={...L.data,[w]:$==="checkbox"?!!B:B};if(w==="special"&&!B&&(q.specialType="",q.specialVolumes="",q.collectiblePrice=""),w==="specialType"&&(B==="collectible"?q.specialVolumes="":(B==="specialEdition"||(q.specialVolumes=""),q.collectiblePrice="")),w==="title"){const oe=kt(B||"");if(oe.name&&gn.has(oe.name)){const se=gn.get(oe.name);q.authors=se.authors||q.authors,q.publisher=se.publisher||q.publisher,q.demographic=se.demographic||q.demographic}}return{...L,data:q}}),Ie(L=>{if(!L.length)return L;const q=[...L],oe={...q[xe]};return oe.data={...oe.data,[w]:$==="checkbox"?!!B:B},q[xe]=oe,q}),w==="title"){const L=String(B||"").trim().toLowerCase();if(!L)te([]);else{const q=[];gn.forEach(oe=>{if(oe.display.toLowerCase().includes(L)){const se=oe.maxVol>0?oe.maxVol+1:1;q.push(`${oe.display}, Vol. ${se}`)}}),te(q.slice(0,6))}}},pr=w=>{re[w]&&(K(w),ce(B=>{const $=re[w];return{...B,data:{...$.data}}}))},Ss=()=>{const w=Re.data.title||"",B=kt(w);if(!B.name){alert("Provide a title with a volume number first (e.g., Series, Vol. 1).");return}const $={kind:Re.mode,id:Re.editingId,data:{...Re.data}},L=re.length?[...re]:[];L.length?L[xe]=$:L.push($);const q=w.replace(/,?\s*Vol\.?\s*\d+.*/i,"").trim()||w;let oe=B.vol||0;const se=gn.get(B.name);se&&se.maxVol>oe&&(oe=se.maxVol),L.forEach(le=>{const ot=kt(le.data.title||"");ot.name===B.name&&(oe=Math.max(oe,ot.vol||0))});const Ce=(oe||0)+1,ke={title:`${q}, Vol. ${Ce}`,authors:Re.data.authors,publisher:Re.data.publisher,demographic:Re.data.demographic,genre:Re.data.genre,subGenre:Re.data.subGenre,msrp:Re.data.msrp,hidden:Re.data.hidden,cover:"",isbn:"",pageCount:"",rating:"",amountPaid:"",date:"",dateRead:"",datePurchased:"",special:!1,specialType:"",specialVolumes:"",collectiblePrice:"",amazonURL:"",read:!1};L.push({kind:"new",id:null,data:ke}),Ie(L),K(L.length-1),ce(le=>({...le,mode:"add",data:ke}))};async function Qn(){if(!s)return;const{list:w}=Re,B=w||"library",$=re.length>0?re:[{kind:Re.mode,id:Re.editingId,data:Re.data}],L=q=>{const oe=(q.title||"").trim(),se=kt(oe),Ce=gn.get(se.name)||{},Pe=(q.authors||"").trim()||Ce.authors||"",ke=(q.publisher||"").trim()||Ce.publisher||"",le=(q.demographic||"").trim()||Ce.demographic||"",ot=(q.genre||"").trim()||Ce.genre||"",Le=(q.subGenre||"").trim()||Ce.subGenre||"";return{title:oe,authors:Pe,publisher:ke,demographic:le,genre:ot,subGenre:Le,date:Tr(q.date||""),cover:(q.cover||"").trim(),isbn:B==="wishlist"?"":(q.isbn||"").trim(),pageCount:q.pageCount===""?"":Number(q.pageCount),rating:B==="wishlist"||q.rating===""?"":Math.max(.5,Math.min(5,Number(q.rating))),amountPaid:q.amountPaid===""?"":Number(q.amountPaid),dateRead:Tr(q.dateRead||""),datePurchased:Tr(q.datePurchased||""),msrp:B==="wishlist"||q.msrp===""?"":Number(q.msrp),special:B==="wishlist"?!1:!!(q.special&&(q.specialType||"").trim()),specialType:B==="wishlist"||!(q.special&&(q.specialType||"").trim())?"":(q.specialType||"").trim(),specialVolumes:B==="wishlist"?"":q.special&&q.specialType==="specialEdition"?q.specialVolumes===""?"":Number(q.specialVolumes):"",collectiblePrice:B==="wishlist"?"":q.special&&q.specialType==="collectible"?q.collectiblePrice===""?"":Number(q.collectiblePrice):"",amazonURL:(q.amazonURL||"").trim(),read:B==="wishlist"?!1:!!q.read,hidden:!!q.hidden,kind:w}};try{const q=await Promise.all($.map(async oe=>{const se=L(oe.data);if(B==="library"&&oe.kind!=="edit"){const Ce=kt(se.title).name,Pe=x.filter(le=>kt(le.title||le.Title||"").name===Ce),ke=Pe[0];if(ke&&(se.demographic=se.demographic||ke.demographic||ke.Demographic||"",se.genre=se.genre||ke.genre||ke.Genre||"",se.subGenre=se.subGenre||ke.subGenre||ke.SubGenre||"",se.msrp==="")){const le=Pe.map(ot=>Number(ot.msrp??ot.MSRP)).filter(ot=>Number.isFinite(ot));le.length>0&&le.every(Le=>Le===le[0])&&(se.msrp=le[0])}}if(!se.title)throw alert("Title is required for every entry."),new Error("missing title");if(oe.kind==="edit"&&oe.id)return await _s(Dt(at,B,oe.id),se),{target:B,id:oe.id,payload:se};{const Ce=await Ra(Sn(at,B),se);return{target:B,id:Ce.id,payload:se}}}));Kn(q.filter(Boolean)),await Promise.all([xt(),Ct()]),a(`${Re.mode==="add"?"Added":"Saved"} ${$.length} item${$.length===1?"":"s"} in ${B==="library"?"Library":"Wishlist"}`,{action:Re.mode==="add"?"create":"update",list:B==="library"?"Library":"Wishlist",details:{entries:$.length,mode:Re.mode}}),Cn()}catch(q){console.error(q),alert("Failed to save entry.")}}async function Yn(w,B){if(!s||!window.confirm("Delete this entry?"))return;const L=(B==="wishlist"?b:x).find(q=>q.id===w);try{await Na(Dt(at,B,w)),await Promise.all([xt(),Ct()]),a(`Deleted "${(L==null?void 0:L.title)||"Untitled"}" from ${B==="library"?"Library":"Wishlist"}`,{action:"delete-single",list:B==="library"?"Library":"Wishlist",details:{title:(L==null?void 0:L.title)||"Untitled"}})}catch(q){console.error(q),alert("Failed to delete entry.")}}const[Cr,Pn]=R.useState(!1),Pr=()=>ye({open:!1,index:0,items:[]});async function Jn(w,B,$={}){if(!(w!=null&&w.id))return;const L=w.kind==="wishlist"?"wishlist":"library";Pn(!0);try{await _s(Dt(at,L,w.id),B),Kn([{target:L,id:w.id,payload:B}]),await Promise.all([xt(),Ct()]),a(`Updated "${w.title||"Untitled"}" in ${L==="library"?"Library":"Wishlist"}`,{action:$.action||"inline-update",list:L==="library"?"Library":"Wishlist",details:$.details||{title:w.title||"Untitled",fields:Object.keys(B||{}).join(", "),rating:B.rating??void 0}}),Qe(q=>q&&q.id===w.id?{...q,...B}:q)}catch(q){console.error(q),alert("Failed to update entry.")}finally{Pn(!1)}}const Ws=(w,B)=>{const $=B===""?"":Math.max(.5,Math.min(5,Number(B)));Jn(w,{rating:$},{action:"rating",details:{title:w.title||"Untitled",rating:$}})},mr=(w,B)=>{if(!w)return;const $=B?{read:!0,dateRead:p_(),rating:w.rating??""}:{read:!1,dateRead:"",rating:""};Jn(w,$,{action:B?"mark-read":"mark-unread",details:{title:w.title||"Untitled",dateRead:B?$.dateRead:"cleared",rating:w.rating||"not set"}})},Gs=()=>{if(!ve.size){alert("Select at least one entry first.");return}const B=[...x,...b].filter(L=>ve.has(L.id));if(!B.length){alert("No items selected.");return}const $=B.map(L=>({id:L.id,kind:L.kind||(c==="wishlist"?"wishlist":"library"),data:{title:L.title||"",authors:L.authors||"",publisher:L.publisher||"",demographic:L.demographic||"",genre:L.genre||"",subGenre:L.subGenre||"",date:L.date||"",cover:L.cover||"",isbn:L.isbn||"",pageCount:L.pageCount||"",rating:L.rating||"",amountPaid:L.amountPaid||"",dateRead:L.dateRead||"",datePurchased:L.datePurchased||"",msrp:L.msrp||"",special:!!(L.specialType||L.specialVolumes||L.collectiblePrice),specialType:L.specialType||"",specialVolumes:L.specialVolumes||"",collectiblePrice:L.collectiblePrice||"",amazonURL:L.amazonURL||"",read:!!L.read,hidden:!!L.hidden}}));ye({open:!0,index:0,items:$})},rt=(w,B,$="text")=>{ye(L=>{const q=[...L.items],oe={...q[L.index]},se={...oe.data,[w]:$==="checkbox"?!!B:B};return w==="special"&&!B&&(se.specialType="",se.specialVolumes="",se.collectiblePrice=""),w==="specialType"&&(B==="collectible"?se.specialVolumes="":(B==="specialEdition"||(se.specialVolumes=""),se.collectiblePrice="")),oe.data=se,q[L.index]=oe,{...L,items:q}})},Xn=()=>{ye(w=>({...w,index:Math.min(w.index+1,w.items.length-1)}))},Nn=()=>{ye(w=>({...w,index:Math.max(w.index-1,0)}))};async function ns(){if(!s)return;const w=W.items;if(!w.length){Pr();return}try{const B=await Promise.all(w.map(async $=>{const q=!($.kind==="wishlist")&&!!($.data.special&&($.data.specialType||"").trim()),oe={...$.data,pageCount:$.data.pageCount===""?"":Number($.data.pageCount),rating:$.data.rating===""?"":Math.max(.5,Math.min(5,Number($.data.rating))),amountPaid:$.data.amountPaid===""?"":Number($.data.amountPaid),msrp:$.data.msrp===""?"":Number($.data.msrp),special:q,specialType:q?$.data.specialType:"",collectiblePrice:q&&$.data.specialType==="collectible"?$.data.collectiblePrice===""?"":Number($.data.collectiblePrice):"",specialVolumes:q&&$.data.specialType==="specialEdition"?$.data.specialVolumes===""?"":Number($.data.specialVolumes):"",datePurchased:$.data.datePurchased||"",amazonURL:$.data.amazonURL||"",read:!!$.data.read},se=$.kind==="wishlist"?"wishlist":"library";return await _s(Dt(at,se,$.id),oe),{target:se,id:$.id,payload:oe}}));Kn(B.filter(Boolean)),await Promise.all([xt(),Ct()]),Ge(new Set),P(!1),a(`Bulk edited ${w.length} item${w.length===1?"":"s"} in Library/Wishlist`,{action:"bulk-edit",list:"Library/Wishlist",details:{count:w.length}}),Pr()}catch(B){console.error(B),alert("Failed to save bulk edits.")}}const Rn=w=>{const B=new Map;return w.forEach($=>{const L=kt($.title||""),q=L.name||($.title||"").toLowerCase()||$.id,oe=gn.get(L.name)||null,se=(oe==null?void 0:oe.display)||($.title||"").replace(/,?\s*Vol\.?\s*\d+.*/i,"").trim()||$.title||"Untitled",Ce=wo($),Pe=iR($.title||""),ke=Number.isFinite(L.vol)?L.vol:0,le=Pe.length>0?Pe:ke>0?[ke]:[],ot=le.length?le[0]:0,Le=Eu($);if(!B.has(q))B.set(q,{id:`series-${q}`,key:q,title:se,authors:$.authors&&$.authors!=="Unknown"?$.authors:(oe==null?void 0:oe.authors)||"",publisher:$.publisher&&$.publisher!=="Unknown"?$.publisher:(oe==null?void 0:oe.publisher)||"",demographic:(oe==null?void 0:oe.demographic)||$.demographic||"",cover:$.cover||"",count:1,readCount:$.read?1:0,minVol:ot,maxVol:ot,representative:$,volumes:[...le],missingPageCount:Le?1:0,missingMetaCount:Ce.any?1:0,missingVolumeCount:Le||Ce.any?1:0});else{const ht=B.get(q);if(ht.count+=1,$.read&&(ht.readCount+=1),Le&&(ht.missingPageCount+=1),Ce.any&&(ht.missingMetaCount+=1),(Le||Ce.any)&&(ht.missingVolumeCount+=1),le.length){const cr=Math.min(...le),Qs=Math.max(...le);ht.minVol=Math.min(ht.minVol,cr),ht.maxVol=Math.max(ht.maxVol,Qs),ht.volumes.push(...le)}!ht.cover&&$.cover&&(ht.cover=$.cover),!ht.authors&&$.authors&&$.authors!=="Unknown"&&(ht.authors=$.authors),!ht.publisher&&$.publisher&&$.publisher!=="Unknown"&&(ht.publisher=$.publisher)}}),Array.from(B.values())},yn=w=>{const B=Array.from(new Set((w||[]).filter(se=>Number.isFinite(se)&&se>=0))).sort((se,Ce)=>se-Ce);if(!B.length)return null;const $=[];let L=B[0],q=B[0];for(let se=1;se<B.length;se+=1){const Ce=B[se];if(Ce===q+1){q=Ce;continue}$.push([L,q]),L=Ce,q=Ce}if($.push([L,q]),$.length===1){const[se,Ce]=$[0];return se===Ce?`Vol. ${se}`:`Vol. ${se}-${Ce}`}return`Vols. ${$.map(([se,Ce])=>se===Ce?`${se}`:`${se}-${Ce}`).join(", ")}`};function An(w){const B=ve.has(w.id),$=w.kind==="library",L=s&&Eu(w),q=s?wo(w):{any:!1,authorMissing:!1,publisherMissing:!1,dateMissing:!1},oe=()=>{k&&s?On(w.id):In(w)};return o.jsxs("div",{className:"manga-card"+(w.read&&$?" read":"")+(B?" multiselect-selected":"")+(L?" missing-page":"")+(q.any?" missing-meta":""),onClick:oe,children:[o.jsx("div",{className:"manga-card-cover-wrap",children:o.jsx("img",{src:w.cover||"https://imgur.com/chUgq4W.png",alt:"Cover",loading:"lazy",decoding:"async"})}),o.jsxs("div",{className:"manga-card-body",children:[o.jsx("div",{className:"manga-card-title",children:w.title||"Untitled"}),o.jsxs("div",{className:"manga-card-meta",children:[o.jsx("span",{className:q.authorMissing?"missing-field":"",children:w.authors&&w.authors!=="Unknown"?w.authors:q.authorMissing?"Missing author":""}),o.jsx("br",{}),o.jsx("span",{className:q.publisherMissing?"missing-field":"",children:w.publisher&&w.publisher!=="Unknown"?w.publisher:q.publisherMissing?"Missing publisher":""}),o.jsx("br",{}),o.jsx("span",{className:q.dateMissing?"missing-field":"",children:w.date&&w.date!=="Unknown"?w.date:q.dateMissing?"Missing date":""})]}),w.isbn&&o.jsxs("div",{className:"manga-card-isbn",children:["ISBN: ",w.isbn]}),s&&o.jsxs("div",{className:"manga-card-actions",children:[o.jsx("button",{type:"button",className:"manga-btn mini",onClick:se=>{se.stopPropagation(),Ts(w)},children:"Edit"}),o.jsx("button",{type:"button",className:"manga-btn mini danger",onClick:se=>{se.stopPropagation(),Yn(w.id,w.kind==="wishlist"?"wishlist":"library")},children:"Delete"})]})]})]},w.id)}function bs(w){var Ce;const B=yn(w.volumes),$=`${w.count} volume${w.count===1?"":"s"}`;w.readCount>=w.count&&w.count>0||`${w.readCount}${w.count}`;const L=w.readCount>=w.count&&w.count>0,q=s&&w.missingVolumeCount||0,oe=q>0,se=[w.authors&&w.authors!=="Unknown"?w.authors:null,w.publisher&&w.publisher!=="Unknown"?w.publisher:null,B?`${$} - ${B}`:$].filter(Boolean);return o.jsxs("div",{className:"manga-card series-view"+(L?" read":"")+(oe?" missing-page missing-meta":""),onClick:()=>Qt(w),children:[oe&&o.jsx("div",{className:"missing-page-badge",title:"Volumes missing required data",children:q}),o.jsx("div",{className:"manga-card-cover-wrap",children:o.jsx("img",{src:w.cover||((Ce=w.representative)==null?void 0:Ce.cover)||"https://imgur.com/chUgq4W.png",alt:"Cover",loading:"lazy",decoding:"async"})}),o.jsxs("div",{className:"manga-card-body",children:[o.jsx("div",{className:"manga-card-title",children:w.title||"Untitled Series"}),o.jsx("div",{className:"manga-card-meta",children:se.map((Pe,ke)=>o.jsxs(Zf.Fragment,{children:[Pe,o.jsx("br",{})]},Pe+ke))}),o.jsx("div",{className:"manga-card-series-count",children:$})]})]},w.id)}const Is=({value:w,onChange:B})=>{const[$,L]=R.useState(null),q=Math.max(0,Math.min(5,Number(w)||0)),oe=$??q,se=Array.from({length:10},(ke,le)=>(le+1)*.5),Ce=5,Pe=Array.from({length:Ce},(ke,le)=>Math.max(0,Math.min(1,oe-le)));return o.jsxs("div",{className:"star-shell",role:"group","aria-label":"Rating",children:[o.jsxs("div",{className:"star-visual",style:{"--star-count":Ce},children:[o.jsx("div",{className:"star-row",children:Pe.map((ke,le)=>o.jsxs("div",{className:"star-icon",children:[o.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",className:"star-base",children:o.jsx("path",{d:"M12 2.5l2.9 5.88 6.5.95-4.7 4.58 1.1 6.43L12 17.9l-5.8 3.44 1.1-6.43-4.7-4.58 6.5-.95L12 2.5z"})}),o.jsx("div",{className:"star-fill",style:{"--pct":`${(Math.max(0,Math.min(1,ke))*100).toFixed(1)}%`},children:o.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:o.jsx("path",{d:"M12 2.5l2.9 5.88 6.5.95-4.7 4.58 1.1 6.43L12 17.9l-5.8 3.44 1.1-6.43-4.7-4.58 6.5-.95L12 2.5z"})})})]},le))}),o.jsx("div",{className:"star-hit",children:se.map(ke=>o.jsx("button",{type:"button","aria-label":`${ke} stars`,onMouseEnter:()=>L(ke),onMouseLeave:()=>L(null),onClick:()=>B(ke)},ke))})]}),o.jsx("div",{className:"star-value",children:oe?oe.toFixed(1):"--"}),o.jsx("button",{type:"button",className:"star-clear",onClick:()=>B(""),"aria-label":"Clear rating",children:"clear"})]})},Un=c==="library"?mn:fr,Fr=c==="library"?x:b,Ft=R.useMemo(()=>Rn(Un),[Un,gn]),rs=R.useMemo(()=>Rn(Fr),[Fr,gn]);R.useEffect(()=>{if(!he&&!Ye)return;const w=[...x,...b];if(he){const B=w.find($=>$.id===he.id);B?(B.title!==he.title||B.isbn!==he.isbn||B.publisher!==he.publisher||B.authors!==he.authors||B.date!==he.date||B.pageCount!==he.pageCount||B.amountPaid!==he.amountPaid||B.msrp!==he.msrp||B.rating!==he.rating||B.read!==he.read||B.amazonURL!==he.amazonURL)&&Qe(B):Qe(null)}if(Ye){const B=Ft.find(se=>se.key===Ye.series.key);if(!B){_t(null);return}const $=Un.filter(se=>(kt(se.title||"").name||(se.title||"").toLowerCase()||se.id)===B.key).sort((se,Ce)=>kt(se.title).vol-kt(Ce.title).vol),L=$.length===Ye.volumes.length&&$.every((se,Ce)=>{var Pe;return((Pe=Ye.volumes[Ce])==null?void 0:Pe.id)===se.id}),q=$.length!==Ye.volumes.length||$.some((se,Ce)=>{const Pe=Ye.volumes[Ce];return!Pe||Pe.id!==se.id?!0:Pe.title!==se.title||Pe.authors!==se.authors||Pe.publisher!==se.publisher||Pe.date!==se.date||Pe.isbn!==se.isbn||Pe.cover!==se.cover||Pe.read!==se.read||Pe.pageCount!==se.pageCount||Pe.amountPaid!==se.amountPaid||Pe.msrp!==se.msrp||Pe.rating!==se.rating}),oe=B.title!==Ye.series.title||B.authors!==Ye.series.authors||B.publisher!==Ye.series.publisher||B.count!==Ye.series.count;(q||oe||!L)&&_t({series:B,volumes:$})}},[x,b,he,Ye,Un,Ft]);const cn=f==="series"?Ft:Un;f==="series"?Ft.length:Un.length,f==="series"?rs.length:Fr.length;const Nr=(w,B)=>{if(!w.length)return;const $=Array.from(w.reduce((Pe,ke)=>(Object.keys(ke).forEach(le=>Pe.add(le)),Pe),new Set)),L=Pe=>{const ke=Pe==null?"":String(Pe);return/[",\n]/.test(ke)?`"${ke.replace(/"/g,'""')}"`:ke},q=[$.join(",")].concat(w.map(Pe=>$.map(ke=>L(Pe[ke])).join(","))),oe=new Blob([q.join(`
`)],{type:"text/csv"}),se=URL.createObjectURL(oe),Ce=document.createElement("a");Ce.href=se,Ce.download=B,Ce.click(),URL.revokeObjectURL(se)},qs=async(w,B)=>{const $=(q,oe="image")=>(q||"").toString().toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"").slice(0,100)||oe,L=w.filter(q=>q.cover).map((q,oe)=>({url:q.cover,name:$(q.title||`manga-${oe+1}`,`manga-${oe+1}`)}));if(!L.length){alert("No images found to download.");return}try{const q=(await pc(async()=>{const{default:Le}=await import("https://cdn.jsdelivr.net/npm/jszip@3.10.1/+esm");return{default:Le}},[])).default,oe=new q,se=oe.folder("images"),Ce={},Pe=L.map(async(Le,ht)=>{try{const Qs=await(await fetch(Le.url)).blob(),_n=(Le.url.split(".").pop()||"jpg").split(/[?#]/)[0],Yt=Le.name||`image-${ht+1}`;Ce[Yt]=(Ce[Yt]||0)+1;const as=Ce[Yt]>1?`-${Ce[Yt]}`:"";se.file(`${Yt}${as}.${_n}`,Qs)}catch(cr){console.warn("Failed to fetch image",Le.url,cr)}});await Promise.all(Pe);const ke=await oe.generateAsync({type:"blob"}),le=URL.createObjectURL(ke),ot=document.createElement("a");ot.href=le,ot.download=B,ot.click(),URL.revokeObjectURL(le)}catch(q){console.error("Zip download failed",q),alert("Failed to create zip. Please try again.")}},Ur=(w,B)=>{const $=new Blob([JSON.stringify(w,null,2)],{type:"application/json"}),L=URL.createObjectURL($),q=document.createElement("a");q.href=L,q.download=B,q.click(),URL.revokeObjectURL(L)},ss=w=>({title:w.title||"",authors:w.authors||"",publisher:w.publisher||"",demographic:w.demographic||"",genre:w.genre||"",subGenre:w.subGenre||"",date:w.date||"",pageCount:w.pageCount??"",cover:w.cover||"",amountPaid:w.amountPaid??"",read:!!w.read,rating:w.rating??"",dateRead:w.dateRead||"",datePurchased:w.datePurchased||"",msrp:w.msrp??"",collectiblePrice:w.collectiblePrice??"",specialType:w.specialType||"",specialVolumes:w.specialVolumes??"",isbn:w.isbn||"",amazonURL:w.amazonURL||"",hidden:!!w.hidden}),vn=w=>{const $=kt(w.title||"").name;if(!$)return"";const q=[...x,...b].find(oe=>{const Ce=kt(oe.title||"").name===$,Pe=oe.msrp!==void 0&&oe.msrp!==null&&oe.msrp!=="";return Ce&&Pe});return q?q.msrp:""},Hs=w=>{const $=kt(w.title||"").name;if(!$)return{demographic:"",genre:"",subGenre:""};const q=[...x,...b].find(oe=>kt(oe.title||"").name===$&&(oe.demographic||oe.genre||oe.subGenre));return{demographic:(q==null?void 0:q.demographic)||"",genre:(q==null?void 0:q.genre)||"",subGenre:(q==null?void 0:q.subGenre)||""}},Ks=async w=>{if(!s||!(w!=null&&w.id))return;const B=w.kind==="wishlist"?"wishlist":"library",$=B==="library"?"wishlist":"library";try{const L=ss(w);if($==="library"){const q=vn(w);(L.msrp===""||L.msrp===null||L.msrp===void 0)&&(L.msrp=q);const oe=Hs(w);L.demographic||(L.demographic=oe.demographic),L.genre||(L.genre=oe.genre),L.subGenre||(L.subGenre=oe.subGenre)}await Ra(Sn(at,$),L),await Na(Dt(at,B,w.id)),await Promise.all([xt(),Ct()]),_t(q=>q&&{...q,volumes:q.volumes.filter(oe=>oe.id!==w.id)}),Fn()}catch(L){console.error("Move failed",L),alert("Failed to move item.")}},dt=Re.list==="wishlist",is=W.items[W.index]||null,jn=(is==null?void 0:is.kind)==="wishlist";return o.jsxs("div",{className:"manga-page",children:[o.jsxs("header",{className:"manga-header",style:{flexDirection:"column",alignItems:"center",textAlign:"center"},children:[o.jsx("div",{className:"manga-header-title",style:{justifyContent:"center",gap:"0.6rem",fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Tyler's Manga Library"}),o.jsx("div",{className:"manga-header-sub",style:{textAlign:"center"},children:"This is my Manga Library and Wishlist. Check and see all the Manga I have in my possession!"})]}),Nt&&o.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"6px"},children:o.jsx("button",{className:"suggestion-trigger",type:"button",onClick:()=>{Je(""),je(!0)},children:"+ Suggestion"})}),o.jsxs("div",{className:"manga-tabs",children:[o.jsx("button",{className:"manga-tab-btn"+(c==="library"?" active":""),onClick:()=>{d("library"),P(!1),Ge(new Set)},children:"Library"}),o.jsx("button",{className:"manga-tab-btn"+(c==="wishlist"?" active":""),onClick:()=>{d("wishlist"),P(!1),Ge(new Set)},children:"Wishlist"})]}),c!=="dashboard"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"manga-toolbar",children:[o.jsxs("div",{className:"manga-toolbar-left",children:[o.jsx("input",{type:"text",className:"manga-search-input",placeholder:c==="library"?"Search library by title, author, ISBN...":"Search wishlist...",value:c==="library"?N:O,onChange:w=>c==="library"?C(w.target.value):G(w.target.value)}),o.jsx("div",{className:"manga-counter",children:(()=>{const w=c==="library",B=(w?N:O).trim(),$=w?x.length:b.length,L=w?en.length:ln.length;return B?`${L} / ${$} Volumes`:`${$} Volumes`})()})]}),o.jsxs("div",{className:"manga-toolbar-right",children:[o.jsxs("div",{className:"manga-view-toggle",children:[o.jsx("button",{className:"manga-btn secondary"+(f==="series"?" active":""),type:"button","aria-pressed":f==="series","aria-label":"Series view",title:"Series View",onClick:()=>tn("series"),children:""}),o.jsx("button",{className:"manga-btn secondary"+(f==="individual"?" active":""),type:"button","aria-pressed":f==="individual","aria-label":"Volume view",title:"Volume View",onClick:()=>tn("individual"),children:""})]}),s&&o.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>we(w=>!w),children:be?"Hide Hidden":"Show Hidden"}),s&&o.jsx("button",{className:"manga-btn secondary"+(k?" active":""),disabled:f==="series",onClick:$t,children:k?"Exit Multi-select":"Multi-select"})]})]}),s&&k&&f==="individual"&&o.jsxs("div",{className:"manga-multiselect-bar",children:[o.jsxs("span",{children:["Selected: ",o.jsx("strong",{children:ve.size})]}),o.jsx("button",{className:"manga-btn",onClick:Gs,children:"Bulk Edit"}),o.jsxs("button",{className:"manga-btn secondary",onClick:()=>lr("move"),children:["Move to ",c==="library"?"Wishlist":"Library"]}),c==="library"&&o.jsxs(o.Fragment,{children:[o.jsx("button",{className:"manga-btn",onClick:()=>lr("markRead"),children:"Mark Read"}),o.jsx("button",{className:"manga-btn secondary",onClick:()=>lr("markUnread"),children:"Mark Unread"})]}),o.jsx("button",{className:"manga-btn danger",onClick:()=>lr("delete"),children:"Delete"})]})]}),ge?o.jsx("div",{className:"manga-empty-state",children:"Loading manga from Firestore..."}):Ee?o.jsx("div",{className:"manga-empty-state",children:Ee}):cn.length===0?o.jsx("div",{className:"manga-empty-state",children:"No manga found. Try changing your search."}):o.jsx("div",{className:"manga-grid",children:cn.map(w=>f==="series"?bs(w):An(w))}),Ye&&o.jsx("div",{className:"manga-modal-backdrop visible",onClick:w=>{w.target===w.currentTarget&&es()},children:o.jsx("div",{className:"manga-modal series",children:o.jsxs("div",{className:"manga-modal-body",children:[o.jsxs("div",{className:"manga-modal-header",children:[o.jsx("div",{className:"manga-modal-title",children:Ye.series.title||"Series"}),o.jsx("button",{className:"manga-modal-close",onClick:es,type:"button","aria-label":"Close",children:"X"})]}),o.jsxs("div",{className:"manga-modal-subtitle",children:[Ye.series.count," volume",Ye.series.count===1?"":"s"," in this series"]}),s&&o.jsxs("div",{className:"series-bulk-controls",children:[o.jsx("button",{type:"button",className:"manga-btn mini secondary"+(k?" active":""),onClick:()=>Ot(Ye.volumes),children:k?"Exit Multi-select":"Multi-select"}),k&&o.jsxs(o.Fragment,{children:[o.jsx("button",{type:"button",className:"manga-btn mini secondary",onClick:()=>{const w=Ye.volumes.map(B=>B.id);Ge(new Set(w))},children:"Select All"}),o.jsx("button",{type:"button",className:"manga-btn mini secondary",onClick:()=>{Ge(new Set)},children:"Clear"}),c==="wishlist"?o.jsx("button",{type:"button",className:"manga-btn mini",disabled:!ve.size,onClick:()=>{ve.size&&lr("move","library")},children:"Move to Library"}):o.jsx("button",{type:"button",className:"manga-btn mini",disabled:!ve.size,onClick:()=>{ve.size&&lr("move","wishlist")},children:"Move to Wishlist"}),o.jsxs("button",{type:"button",className:"manga-btn mini",disabled:!ve.size,onClick:()=>{if(!ve.size)return;const w=new Set(Ye.volumes.map(B=>B.id));Ge(B=>new Set([...B].filter($=>w.has($)))),Gs()},children:["Bulk Edit Selected (",ve.size||0,")"]})]})]}),o.jsx("div",{className:"manga-series-modal-grid",children:Ye.volumes.map(w=>o.jsxs("div",{className:"manga-card mini-card"+(w.read?" read":"")+(s&&Eu(w)?" missing-page":"")+(s&&wo(w).any?" missing-meta":""),onClick:()=>{if(!s){In(w);return}if(k){On(w.id);return}In(w)},children:[o.jsxs("div",{className:"manga-card-cover-wrap",children:[k&&s&&o.jsx("div",{className:"mini-select-indicator"+(ve.has(w.id)?" selected":""),children:ve.has(w.id)?"X":""}),o.jsx("img",{src:w.cover||"https://imgur.com/chUgq4W.png",alt:w.title||"Cover",loading:"lazy",decoding:"async"})]}),o.jsxs("div",{className:"manga-card-body",children:[o.jsx("div",{className:"manga-card-title",children:w.title||"Untitled"}),o.jsxs("div",{className:"manga-card-meta",children:[o.jsx("span",{className:wo(w).authorMissing?"missing-field":"",children:w.authors&&w.authors!=="Unknown"?w.authors:"Missing author"}),o.jsx("br",{}),o.jsx("span",{className:wo(w).publisherMissing?"missing-field":"",children:w.publisher&&w.publisher!=="Unknown"?w.publisher:"Missing publisher"}),o.jsx("br",{}),o.jsx("span",{className:wo(w).dateMissing?"missing-field":"",children:w.date&&w.date!=="Unknown"?w.date:"Missing date"})]}),w.isbn&&o.jsxs("div",{className:"manga-card-isbn",children:["ISBN: ",w.isbn]})]})]},w.id))})]})})}),s&&o.jsxs("div",{className:"manga-floating-actions",children:[o.jsxs("button",{className:"manga-btn",type:"button","aria-label":"Add item",onClick:()=>ts(c==="wishlist"?"wishlist":"library"),children:["+ ",c==="wishlist"?"Wishlist":"Library"]}),o.jsxs("div",{className:"manga-export-actions",children:[n&&o.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>Ur({library:x,wishlist:b},"manga-library-wishlist.json"),children:"Export JSON"}),o.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>Nr(c==="library"?x:b,c==="library"?"manga-library.csv":"manga-wishlist.csv"),children:"Export CSV"}),o.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>qs(c==="library"?x:b,c==="library"?"manga-library-images.zip":"manga-wishlist-images.zip"),children:"Download Images"})]})]}),he&&o.jsx("div",{className:"manga-modal-backdrop visible",onClick:w=>{w.target===w.currentTarget&&Fn()},children:o.jsxs("div",{className:"manga-modal",children:[o.jsxs("div",{className:"manga-modal-cover-wrap",children:[he.kind==="library"&&he.read&&o.jsx("div",{className:"manga-modal-read-pill",children:"Read"}),o.jsx("img",{src:he.cover||"https://imgur.com/chUgq4W.png",alt:"Cover"})]}),o.jsxs("div",{className:"manga-modal-body",children:[o.jsxs("div",{className:"manga-modal-header",children:[o.jsx("div",{className:"manga-modal-title",children:he.title||"Untitled"}),o.jsx("button",{className:"manga-modal-close",onClick:Fn,type:"button","aria-label":"Close",children:"X"})]}),o.jsxs("div",{className:"manga-modal-meta",children:[he.authors&&he.authors!=="Unknown"&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"Author(s):"})," ",he.authors,o.jsx("br",{})]}),he.publisher&&he.publisher!=="Unknown"&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"Publisher:"})," ",he.publisher,o.jsx("br",{})]}),he.date&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"Release:"})," ",he.date,o.jsx("br",{})]}),he.isbn&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"ISBN:"})," ",he.isbn,o.jsx("br",{})]})]}),o.jsxs("div",{className:"manga-modal-details",children:[he.pageCount&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"Pages:"})," ",he.pageCount,o.jsx("br",{})]}),o.jsxs("div",{style:{margin:"6px 0"},children:[o.jsx("strong",{children:"Rating:"})," ",o.jsx(Is,{value:he.rating||"",onChange:w=>Ws(he,w)})]}),he.amountPaid&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"Amount Paid:"})," $",he.amountPaid,o.jsx("br",{})]}),he.msrp&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"MSRP:"})," $",he.msrp,o.jsx("br",{})]}),he.collectiblePrice&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"Collectible:"})," $",he.collectiblePrice,o.jsx("br",{})]}),he.read&&he.dateRead&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"Date Read:"})," ",he.dateRead,o.jsx("br",{})]}),he.amazonURL&&o.jsx("div",{style:{marginTop:"6px"},children:o.jsx("a",{href:he.amazonURL,target:"_blank",rel:"noreferrer",children:"View on Amazon"})})]}),o.jsxs("div",{className:"manga-modal-footer",style:{gap:"10px",alignItems:"center"},children:[o.jsx("div",{children:he.kind==="library"&&he.read?"Marked as read in your library.":he.kind==="library"?"In your library (unread).":"Wishlist item - not in library yet."}),o.jsxs("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:[s&&o.jsx("button",{className:"manga-btn mini secondary",type:"button",onClick:()=>Ts(he),children:"Edit"}),he.kind==="library"&&o.jsx(o.Fragment,{children:he.read?o.jsx("button",{className:"manga-btn mini secondary",disabled:Cr,onClick:()=>mr(he,!1),type:"button",children:"Mark as unread"}):o.jsx("button",{className:"manga-btn mini",disabled:Cr,onClick:()=>mr(he,!0),type:"button",children:"Mark as read"})}),s&&o.jsxs("button",{className:"manga-btn mini",type:"button",onClick:()=>Ks(he),children:["Move to ",he.kind==="library"?"Wishlist":"Library"]}),s&&o.jsx("button",{className:"manga-btn mini danger",type:"button",onClick:()=>Yn(he.id,he.kind==="library"?"library":"wishlist"),children:"Delete"})]})]})]})]})}),s&&Re.open&&o.jsx("div",{className:"manga-modal-backdrop visible",onClick:w=>{w.target===w.currentTarget&&Cn()},children:o.jsx("div",{className:"manga-modal admin",children:o.jsxs("div",{className:"manga-modal-body",children:[o.jsxs("div",{className:"manga-modal-header",children:[o.jsx("div",{className:"manga-modal-title",children:Re.mode==="add"?"Add Entry":"Edit Entry"}),o.jsx("button",{className:"manga-modal-close",onClick:Cn,type:"button","aria-label":"Close",children:"X"})]}),o.jsxs("div",{className:"admin-form-layout",children:[o.jsx("div",{className:"admin-cover-frame",children:o.jsx("img",{src:Re.data.cover||"https://imgur.com/chUgq4W.png",alt:"Cover preview"})}),o.jsxs("div",{className:"admin-form-fields",children:[o.jsx("div",{className:"admin-row",children:o.jsxs("label",{children:["Title",o.jsx("input",{type:"text",value:Re.data.title,onChange:w=>Pt("title",w.target.value)})]})}),V.length>0&&o.jsx("div",{className:"title-suggestions",children:V.map((w,B)=>o.jsx("button",{type:"button",className:"manga-btn mini",onClick:()=>Pt("title",w),children:w},w+B))}),o.jsxs("div",{className:"admin-row two",style:{alignItems:"flex-end",marginTop:"-8px"},children:[o.jsxs("div",{children:[o.jsxs("div",{className:"manga-modal-subtitle",style:{marginBottom:"6px"},children:["Entry ",xe+1," / ",Math.max(1,re.length||1)]}),o.jsxs("div",{style:{display:"flex",gap:"8px"},children:[o.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>xe>0&&pr(xe-1),disabled:xe===0,children:"Previous"}),o.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>re.length&&xe<re.length-1?pr(xe+1):null,disabled:!re.length||xe===re.length-1,children:"Next"})]})]}),o.jsxs("div",{style:{textAlign:"right"},children:[o.jsx("button",{className:"manga-btn",type:"button",onClick:Ss,disabled:!kt(Re.data.title||"").vol,children:"Add New Volume"}),o.jsx("div",{className:"manga-stat-sub",style:{marginTop:"4px"},children:"Auto-fills the next volume number for this series."})]})]}),o.jsx("div",{className:"admin-row",children:o.jsxs("label",{className:A.author?"missing-field-input":"",children:["Authors",o.jsx("input",{type:"text",value:Re.data.authors,onChange:w=>Pt("authors",w.target.value)})]})}),o.jsx("div",{className:"admin-row",children:o.jsxs("label",{className:A.publisher?"missing-field-input":"",children:["Publisher",o.jsx("input",{type:"text",value:Re.data.publisher,onChange:w=>Pt("publisher",w.target.value)})]})}),o.jsxs("div",{className:"admin-row three",children:[o.jsxs("label",{className:A.date?"missing-field-input":"",children:["Release Date",o.jsx("input",{type:"date",value:Re.data.date,onChange:w=>Pt("date",w.target.value)})]}),o.jsxs("label",{children:["Purchase Date",o.jsx("input",{type:"date",value:Re.data.datePurchased,onChange:w=>Pt("datePurchased",w.target.value)})]}),!dt&&o.jsxs("label",{children:["Date Read",o.jsx("input",{type:"date",value:Re.data.dateRead,onChange:w=>Pt("dateRead",w.target.value)})]})]}),o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{className:A.page?"missing-field-input":"",children:["Page Count",o.jsx("input",{type:"number",placeholder:"e.g. 192",value:Re.data.pageCount,onChange:w=>Pt("pageCount",w.target.value)})]}),!dt&&o.jsxs("label",{children:["ISBN (library only)",o.jsx("input",{type:"text",value:Re.data.isbn,onChange:w=>Pt("isbn",w.target.value)})]})]}),o.jsx("div",{className:"admin-row",children:o.jsxs("label",{children:["Cover URL",o.jsx("input",{type:"text",placeholder:"Paste image URL here",value:Re.data.cover,onChange:w=>Pt("cover",w.target.value)})]})}),!dt&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"admin-row two",children:[!(Re.data.special&&Re.data.specialType==="collectible")&&o.jsxs("label",{children:["Amount Paid",o.jsx("input",{type:"number",step:"0.01",value:Re.data.amountPaid,onChange:w=>Pt("amountPaid",w.target.value)})]}),o.jsxs("label",{children:["MSRP",o.jsx("input",{type:"number",step:"0.01",value:Re.data.msrp,onChange:w=>Pt("msrp",w.target.value)})]})]}),o.jsx("div",{className:"admin-row",children:o.jsxs("label",{className:"checkbox-row",children:[o.jsx("input",{type:"checkbox",checked:!!Re.data.special,onChange:w=>Pt("special",w.target.checked,"checkbox")}),o.jsx("span",{children:"Special item?"})]})}),Re.data.special&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{children:["Special Type",o.jsxs("select",{value:Re.data.specialType,onChange:w=>Pt("specialType",w.target.value),children:[o.jsx("option",{value:"",children:"Select type"}),o.jsx("option",{value:"specialEdition",children:"Special Edition"}),o.jsx("option",{value:"collectible",children:"Collectible"})]})]}),Re.data.specialType==="collectible"&&o.jsxs("label",{children:["Collectible Price",o.jsx("input",{type:"number",step:"0.01",value:Re.data.collectiblePrice,onChange:w=>Pt("collectiblePrice",w.target.value)})]})]}),Re.data.specialType==="specialEdition"&&o.jsx("div",{className:"admin-row",children:o.jsxs("label",{children:["Special Volumes",o.jsx("input",{type:"number",min:"0",value:Re.data.specialVolumes,onChange:w=>Pt("specialVolumes",w.target.value)})]})})]})]}),dt&&o.jsx("div",{className:"admin-row",children:o.jsxs("label",{children:["Amazon URL",o.jsx("input",{type:"text",value:Re.data.amazonURL,onChange:w=>Pt("amazonURL",w.target.value)})]})}),!dt&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"admin-row",children:o.jsxs("label",{children:["Rating (1-5 stars)",o.jsx(Is,{value:Re.data.rating,onChange:w=>Pt("rating",w)})]})}),o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{className:"checkbox-inline",children:[o.jsx("input",{type:"checkbox",checked:Re.data.read,onChange:w=>Pt("read",w.target.checked,"checkbox")}),o.jsx("span",{children:"Mark as read"})]}),o.jsxs("label",{className:"checkbox-inline",children:[o.jsx("input",{type:"checkbox",checked:!!Re.data.hidden,onChange:w=>Pt("hidden",w.target.checked,"checkbox")}),o.jsx("span",{children:"Hide from public"})]})]})]}),dt&&o.jsx("div",{className:"admin-row",children:o.jsxs("label",{className:"checkbox-inline",children:[o.jsx("input",{type:"checkbox",checked:!!Re.data.hidden,onChange:w=>Pt("hidden",w.target.checked,"checkbox")}),o.jsx("span",{children:"Hide from public"})]})})]})]}),o.jsxs("div",{className:"manga-modal-footer",style:{justifyContent:"flex-end",gap:"10px"},children:[o.jsx("button",{className:"manga-btn secondary",onClick:Cn,type:"button",children:"Cancel"}),o.jsx("button",{className:"manga-btn",onClick:Qn,type:"button",children:Re.mode==="add"?"Add":"Save"})]})]})})}),s&&W.open&&o.jsx("div",{className:"manga-modal-backdrop visible",onClick:w=>{w.target===w.currentTarget&&Pr()},children:o.jsx("div",{className:"manga-modal admin",children:o.jsxs("div",{className:"manga-modal-body",children:[o.jsxs("div",{className:"manga-modal-header",children:[o.jsxs("div",{className:"manga-modal-title",children:["Bulk Edit (",W.index+1," / ",W.items.length,")"]}),o.jsx("button",{className:"manga-modal-close",onClick:Pr,type:"button","aria-label":"Close",children:"X"})]}),W.items.length>0&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"manga-modal-subtitle",children:["Editing: ",W.items[W.index].data.title||"Untitled"]}),o.jsxs("div",{className:"admin-form-grid two-col",children:[o.jsx("div",{className:"admin-cover",children:o.jsx("div",{className:"manga-card-cover-wrap",children:o.jsx("img",{src:W.items[W.index].data.cover||"https://imgur.com/chUgq4W.png",alt:W.items[W.index].data.title||"Cover",loading:"lazy",decoding:"async"})})}),o.jsxs("div",{className:"admin-fields",children:[o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{className:"full",children:["Title",o.jsx("input",{type:"text",value:W.items[W.index].data.title,onChange:w=>rt("title",w.target.value)})]}),o.jsxs("div",{className:"admin-entry-info",children:["Entry ",W.index+1," / ",W.items.length]})]}),o.jsx("div",{className:"admin-row",children:o.jsxs("label",{children:["Authors",o.jsx("input",{type:"text",value:W.items[W.index].data.authors,onChange:w=>rt("authors",w.target.value)})]})}),o.jsx("div",{className:"admin-row",children:o.jsxs("label",{children:["Publisher",o.jsx("input",{type:"text",value:W.items[W.index].data.publisher,onChange:w=>rt("publisher",w.target.value)})]})}),o.jsxs("div",{className:"admin-row three",children:[o.jsxs("label",{children:["Release Date",o.jsx("input",{type:"date",value:W.items[W.index].data.date,onChange:w=>rt("date",w.target.value)})]}),o.jsxs("label",{children:["Purchase Date",o.jsx("input",{type:"date",value:W.items[W.index].data.datePurchased,onChange:w=>rt("datePurchased",w.target.value)})]}),!jn&&o.jsxs("label",{children:["Date Read",o.jsx("input",{type:"date",value:W.items[W.index].data.dateRead,onChange:w=>rt("dateRead",w.target.value)})]})]}),o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{children:["Page Count",o.jsx("input",{type:"number",value:W.items[W.index].data.pageCount,onChange:w=>rt("pageCount",w.target.value)})]}),!jn&&o.jsxs("label",{children:["ISBN (library only)",o.jsx("input",{type:"text",value:W.items[W.index].data.isbn,onChange:w=>rt("isbn",w.target.value)})]})]}),o.jsx("div",{className:"admin-row",children:o.jsxs("label",{children:["Cover URL",o.jsx("input",{type:"text",value:W.items[W.index].data.cover,onChange:w=>rt("cover",w.target.value)})]})}),!jn&&o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{children:["Amount Paid",o.jsx("input",{type:"number",step:"0.01",value:W.items[W.index].data.amountPaid,onChange:w=>rt("amountPaid",w.target.value)})]}),o.jsxs("label",{children:["MSRP",o.jsx("input",{type:"number",step:"0.01",value:W.items[W.index].data.msrp,onChange:w=>rt("msrp",w.target.value)})]})]}),!jn&&o.jsx("div",{className:"admin-row two",children:o.jsxs("div",{children:[o.jsx("div",{className:"star-label",children:"Rating (1-5 stars)"}),o.jsx(Is,{value:W.items[W.index].data.rating,onChange:w=>rt("rating",w)})]})}),!jn&&o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{className:"checkbox-row",children:[o.jsx("input",{type:"checkbox",checked:!!W.items[W.index].data.special,onChange:w=>rt("special",w.target.checked,"checkbox")}),o.jsx("span",{children:"Special item?"})]}),o.jsxs("label",{className:"checkbox-row",children:[o.jsx("input",{type:"checkbox",checked:W.items[W.index].data.read,onChange:w=>rt("read",w.target.checked,"checkbox")}),o.jsx("span",{children:"Mark as read"})]})]}),W.items[W.index].data.special&&!jn&&o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{children:["Special Type",o.jsxs("select",{value:W.items[W.index].data.specialType,onChange:w=>rt("specialType",w.target.value),children:[o.jsx("option",{value:"",children:"Select type"}),o.jsx("option",{value:"specialEdition",children:"Special Edition"}),o.jsx("option",{value:"collectible",children:"Collectible"})]})]}),W.items[W.index].data.specialType==="specialEdition"&&o.jsxs("label",{children:["Special Volumes",o.jsx("input",{type:"number",value:W.items[W.index].data.specialVolumes,onChange:w=>rt("specialVolumes",w.target.value)})]}),W.items[W.index].data.specialType==="collectible"&&o.jsxs("label",{children:["Collectible Price",o.jsx("input",{type:"number",step:"0.01",value:W.items[W.index].data.collectiblePrice,onChange:w=>rt("collectiblePrice",w.target.value)})]})]}),o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{children:["Amazon URL",o.jsx("input",{type:"text",value:W.items[W.index].data.amazonURL,onChange:w=>rt("amazonURL",w.target.value)})]}),o.jsxs("label",{className:"checkbox-row",children:[o.jsx("input",{type:"checkbox",checked:!!W.items[W.index].data.hidden,onChange:w=>rt("hidden",w.target.checked,"checkbox")}),o.jsx("span",{children:"Hidden from public"})]})]})]})]}),o.jsxs("div",{className:"manga-modal-footer",style:{justifyContent:"space-between",gap:"10px"},children:[o.jsxs("div",{children:[o.jsx("button",{className:"manga-btn secondary",onClick:Nn,type:"button",disabled:W.index===0,children:"Previous"}),o.jsx("button",{className:"manga-btn secondary",onClick:Xn,type:"button",disabled:W.index===W.items.length-1,style:{marginLeft:"6px"},children:"Next"})]}),o.jsxs("div",{style:{display:"flex",gap:"8px"},children:[o.jsx("button",{className:"manga-btn secondary",onClick:Pr,type:"button",children:"Cancel"}),o.jsx("button",{className:"manga-btn",onClick:ns,type:"button",children:"Save Edits"})]})]})]})]})})}),Nt&&o.jsx(hw,{open:De,title:"Suggest a Manga",placeholder:"Type a manga you'd like me to collect/read...",value:Me,status:ze,loading:pe,onChange:ae,onSubmit:v,onClose:()=>je(!1)}),o.jsx("datalist",{id:"adminTitleSuggestions",children:Y.map(w=>o.jsx("option",{value:w},w))})]})}const oR="https://imokmalworker.imokissick.workers.dev/?url=",mw="im_ok",m_=300,lR={1:"watching",2:"completed",3:"on_hold",4:"dropped",6:"plan_to_watch"};function cR(n){const e=n==null?void 0:n.title_localized,t=typeof e=="string"?e:(e==null?void 0:e.en)||(e==null?void 0:e.english);return(n==null?void 0:n.anime_title_eng)||(n==null?void 0:n.title_english)||t||(n==null?void 0:n.anime_title)||(n==null?void 0:n.title)||"Untitled"}function uR(n){const e=(n==null?void 0:n.updated_at)??(n==null?void 0:n.updatedAt)??(n==null?void 0:n.updated_at_ms)??null;if(e==null)return null;const t=Number(e);if(Number.isFinite(t))return t<1e12?t*1e3:t;const s=Date.parse(e);return Number.isNaN(s)?null:s}function dR(n){const e=lR[n.status]||(typeof n.status=="string"?n.status.toLowerCase():"unknown");return{id:n.anime_id||n.id,title:cR(n),updatedAt:uR(n),episodes:n.anime_num_episodes??n.episodes??null,watchedEpisodes:n.num_watched_episodes??n.my_watched_episodes??n.watched_episodes??n.num_watched??0,status:e,score:n.score??null,image:n.anime_image_path||n.image_url||n.anime_img||n.picture||null,synopsis:n.anime_synopsis||n.synopsis||null}}function g_(){const n=Date.now();return[{id:1,title:"Cowboy Bebop",episodes:26,status:"completed",score:10,updatedAt:n-1e3*60*60*24*3,synopsis:"In 2071, bounty hunters Spike and Jet roam the solar system looking for their next payout and a place to belong."},{id:2,title:"Fullmetal Alchemist: Brotherhood",episodes:64,status:"completed",score:10,updatedAt:n-1e3*60*60*24*6,synopsis:"Brothers Edward and Alphonse Elric search for the Philosopher's Stone to restore their bodies after a failed alchemy ritual."},{id:3,title:"Frieren: Beyond Journey's End",episodes:28,status:"watching",score:9,updatedAt:n-1e3*60*60*8,synopsis:"An elven mage retraces the steps of a past adventure to understand humanity and the passage of time."},{id:4,title:"One Piece",episodes:1e3,status:"on_hold",score:8,updatedAt:n-1e3*60*60*24*14,synopsis:"Monkey D. Luffy sails toward the Grand Line seeking the One Piece and a crew to make his dream real."},{id:5,title:"Kaiju No. 8",episodes:12,status:"plan_to_watch",score:null,updatedAt:n-1e3*60*30,synopsis:"A middle-aged worker gains kaiju powers and joins the Defense Force to fight monsters from the inside."}]}async function hR(n,e){const t=`https://myanimelist.net/animelist/${n}/load.json?status=7&offset=${e}`,s=await fetch(`${oR}${encodeURIComponent(t)}`);if(!s.ok)throw new Error(`Failed to fetch MAL list (offset ${e})`);return s.json()}async function fR(n=mw){const e=[];try{let t=0;for(;;){const s=await hR(n,t);if(!Array.isArray(s)||s.length===0||(e.push(...s),s.length<m_))break;t+=m_}}catch(t){return console.error("Failed to load MAL list; falling back to sample data.",t),g_()}return e.length?e.map(dR):g_()}async function pR(n){var e,t;if(!n)return null;try{const s=await fetch(`https://api.jikan.moe/v4/anime/${n}`);if(!s.ok)throw new Error(`Failed to fetch Jikan summary for id ${n}`);const a=await s.json();return((e=a==null?void 0:a.data)==null?void 0:e.synopsis)||((t=a==null?void 0:a.data)==null?void 0:t.background)||null}catch(s){return console.error("Failed to load anime synopsis",n,s),null}}async function mR(n=mw){var e;if(!n)return null;try{const t=await fetch(`https://api.jikan.moe/v4/users/${encodeURIComponent(n)}/statistics`);if(!t.ok)throw new Error(`Failed to fetch user stats for ${n}`);const s=await t.json(),a=((e=s==null?void 0:s.data)==null?void 0:e.anime)||{},c=Number(a.days_watched),d=Number(a.total_episodes??a.episodes_watched);return{daysWatched:Number.isFinite(c)?c:null,episodesWatched:Number.isFinite(d)?d:null}}catch(t){return console.error("Failed to load user stats",n,t),null}}const y_=5,gR=3600*1e3,v_="animeSuggestionsSent";function yR(){const{admin:n,user:e,role:t}=za(),s=pe=>pe?pe.toString().replace(/_/g," ").replace(/\b\w/g,Be=>Be.toUpperCase()):"Unknown",[a,c]=R.useState([]),[d,f]=R.useState([]),[m,v]=R.useState(""),[x,S]=R.useState("all"),[b,M]=R.useState(!0),[Y,z]=R.useState(""),[V,te]=R.useState(null),[be,we]=R.useState({}),[ge,ie]=R.useState(!1),[Ee,D]=R.useState(!1),[N,C]=R.useState(null),[O,G]=R.useState(!1),[k,P]=R.useState(""),[ve,Ge]=R.useState(""),[Re,ce]=R.useState(!1);R.useEffect(()=>{document.title="Anime | Library"},[]),R.useEffect(()=>{Ge("")},[e]);const re=pe=>{if(!pe)return"";const Be=Date.now()-pe,he=Math.max(Be,0),Qe=Math.floor(he/6e4);if(Qe<1)return"just now";if(Qe<60)return`${Qe}m ago`;const Ye=Math.floor(Qe/60);if(Ye<48)return`${Ye}h ago`;const _t=Math.floor(Ye/24);if(_t<14)return`${_t}d ago`;const Nt=Math.floor(_t/7);return Nt<8?`${Nt}w ago`:`${Math.floor(_t/30)}mo ago`},Ie=(pe,Be="image")=>(pe||"").toString().toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"").slice(0,80)||Be,xe=async()=>{const pe=a.filter(Be=>Be.image).map((Be,he)=>({url:Be.image,name:Ie(Be.title||`anime-${he+1}`,`anime-${he+1}`)}));if(!pe.length){alert("No images found to download.");return}try{const Be=(await pc(async()=>{const{default:Ct}=await import("https://cdn.jsdelivr.net/npm/jszip@3.10.1/+esm");return{default:Ct}},[])).default,he=new Be,Qe=he.folder("images"),Ye={};await Promise.all(pe.map(async(Ct,en)=>{try{const ln=await(await fetch(Ct.url)).blob(),fr=(Ct.url.split(".").pop()||"jpg").split(/[?#]/)[0],tn=Ct.name||`image-${en+1}`;Ye[tn]=(Ye[tn]||0)+1;const Kn=Ye[tn]>1?`-${Ye[tn]}`:"";Qe.file(`${tn}${Kn}.${fr}`,ln)}catch(mn){console.warn("Failed to fetch image",Ct.url,mn)}}));const _t=await he.generateAsync({type:"blob"}),Nt=URL.createObjectURL(_t),xt=document.createElement("a");xt.href=Nt,xt.download="anime-images.zip",xt.click(),URL.revokeObjectURL(Nt)}catch(Be){console.error("Zip download failed",Be),alert("Failed to create zip. Please try again.")}};R.useEffect(()=>{async function pe(){try{const Be=await fR();c(Be),f(Be)}catch(Be){console.error(Be),z("Failed to load data from MAL.")}finally{M(!1)}}pe()},[]),R.useEffect(()=>{mR().then(pe=>{pe&&C(pe)}).catch(()=>{})},[]);const K=pe=>{switch((pe||"unknown").toLowerCase()){case"watching":return 0;case"completed":return 1;case"on_hold":return 2;case"plan_to_watch":return 3;case"dropped":return 4;default:return 5}},A=pe=>{const Be=Number.isFinite(Number(pe.watchedEpisodes))?Number(pe.watchedEpisodes):0,he=Number.isFinite(Number(pe.episodes))?Number(pe.episodes):null;return he?`${Math.min(Be,he)}/${he} eps`:Be?`${Be} eps`:"No progress"};R.useEffect(()=>{let pe=[...a];if(x!=="all"&&(pe=pe.filter(Be=>(Be.status||"").toLowerCase()===x)),m){const Be=m.toLowerCase();pe=pe.filter(he=>(he.title||"").toLowerCase().includes(Be))}pe.sort((Be,he)=>{const Qe=K(Be.status),Ye=K(he.status);return Qe!==Ye?Qe-Ye:(Be.title||"").localeCompare(he.title||"")}),f(pe)},[a,x,m]);const W=R.useMemo(()=>[...a].filter(pe=>Number.isFinite(pe.updatedAt)).sort((pe,Be)=>Be.updatedAt-pe.updatedAt).slice(0,6),[a]),ye=!!e&&t==="viewer",De=async()=>{const pe=Date.now(),he=(()=>{try{const Qe=localStorage.getItem(v_);return Array.isArray(JSON.parse(Qe))?JSON.parse(Qe):[]}catch{return[]}})().filter(Qe=>pe-Qe<gR);if(he.length>=y_){Ge("Rate limit: please wait a bit (max 5 suggestions per hour).");return}if(!k.trim()){Ge("Please enter a title or note before sending.");return}ce(!0),Ge("");try{const Qe=`**Anime Suggestion**
${k.trim()}
From: ${(e==null?void 0:e.displayName)||(e==null?void 0:e.email)||(e==null?void 0:e.uid)||"anonymous user"}`;await Ra(Sn(at,"suggestions"),{content:k.trim(),type:"anime",from:(e==null?void 0:e.displayName)||(e==null?void 0:e.email)||(e==null?void 0:e.uid)||"anonymous user",createdAt:new Date().toISOString()}),Ge("Sent! I'll review your suggestion soon."),P("");const Ye=[...he,pe].slice(-y_);localStorage.setItem(v_,JSON.stringify(Ye))}catch(Qe){console.error("Failed to send suggestion",Qe),Ge("Failed to send suggestion. Please try again later.")}finally{ce(!1)}};R.useEffect(()=>{if(!V){D(!1),ie(!1);return}D(!!V.synopsis),ie(!1)},[V==null?void 0:V.id]);const je=R.useMemo(()=>{const pe=a.length,Be=a.reduce((Nt,xt)=>{const Ct=Number(xt.watchedEpisodes);return Number.isFinite(Ct)?Nt+Ct:Nt},0),he=Be*.4,Qe=a.filter(Nt=>Number.isFinite(Nt.score)&&Nt.score>0),Ye=Qe.reduce((Nt,xt)=>Nt+xt.score,0),_t={watching:0,completed:0,on_hold:0,dropped:0,plan_to_watch:0,unknown:0};return a.forEach(Nt=>{const xt=(Nt.status||"unknown").toLowerCase();_t[xt]!=null?_t[xt]+=1:_t.unknown+=1}),{total:pe,totalWatchedEpisodes:Be,byStatus:_t,avgScore:Qe.length?Ye/Qe.length:0,totalHours:he}},[a]),Me=(N==null?void 0:N.daysWatched)??(je.totalHours||0)/24,ae=(N==null?void 0:N.episodesWatched)??je.totalWatchedEpisodes,ze=pe=>{const Be=pe.image||"https://imgur.com/chUgq4W.png",he=Number.isFinite(Number(pe.watchedEpisodes))?Number(pe.watchedEpisodes):0,Qe=Number.isFinite(Number(pe.episodes))?Number(pe.episodes):null,Ye=Qe?`Episode ${Math.min(he,Qe)}/${Qe}`:`Episode ${he}`,_t=Number.isFinite(Number(pe.score))&&Number(pe.score)>0?pe.score:"Not rated";return o.jsxs("article",{className:"anime-card",onClick:()=>te(pe.synopsis?pe:{...pe,synopsis:be[pe.id]}),children:[o.jsxs("div",{className:"anime-cover-wrap",children:[o.jsx("img",{className:"anime-cover",src:Be,alt:pe.title,loading:"lazy",decoding:"async"}),o.jsx("div",{className:`badge-status ${(pe.status||"unknown").toLowerCase()}`,children:s(pe.status)}),pe.score!=null&&o.jsx("div",{className:"badge-score",children:_t})]}),o.jsxs("div",{className:"anime-meta",children:[o.jsx("div",{className:"anime-title",title:pe.title,children:pe.title}),o.jsx("div",{className:"anime-sub",children:pe.episodes?`${pe.episodes} episodes`:"Episodes: ?"}),o.jsx("div",{className:"anime-progress",children:Ye}),o.jsxs("div",{className:"anime-progress",children:["Status: ",s(pe.status)]})]})]},pe.id||pe.title)},Je=pe=>o.jsxs("article",{className:"anime-update-card",children:[o.jsx("div",{className:"anime-update-title",title:pe.title,children:pe.title}),o.jsxs("div",{className:"anime-update-meta",children:[o.jsx("span",{className:"anime-update-progress",children:A(pe)}),o.jsx("span",{className:"anime-update-dot","aria-hidden":"true",children:""}),o.jsx("span",{className:"anime-update-status",children:s(pe.status)})]}),o.jsx("div",{className:"anime-update-time",children:re(pe.updatedAt)})]},`update-${pe.id||pe.title}`);return o.jsxs("main",{className:"anime-page",children:[o.jsxs("div",{className:"anime-content",children:[o.jsxs("header",{className:"anime-header",style:{position:"relative",display:"flex",justifyContent:"center",alignItems:"center",textAlign:"center",width:"100%"},children:[o.jsxs("div",{style:{textAlign:"center",margin:"0 auto",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"0 60px"},children:[o.jsx("h1",{className:"anime-title",style:{margin:0,fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Tyler's Anime Library"}),o.jsx("p",{className:"anime-sub",style:{textAlign:"center",margin:"6px 0 0"},children:"The Anime I've watched/watching synced directly from MAL (MyAnimeList)"})]}),(ye||n)&&o.jsxs("div",{style:{position:"absolute",right:0,top:"50%",transform:"translateY(-50%)",display:"flex",gap:"10px"},children:[ye&&o.jsx("button",{className:"suggestion-trigger",type:"button",onClick:()=>{Ge(""),G(!0)},children:"+ Suggestion"}),n&&o.jsx("button",{className:"stat-link",type:"button",onClick:xe,children:"Download Images"})]})]}),o.jsxs("div",{className:"anime-stats",children:[o.jsxs("div",{className:"anime-stat-card",children:[o.jsx("div",{className:"anime-stat-label",children:"Total Entries"}),o.jsx("div",{className:"anime-stat-value",children:je.total})]}),o.jsxs("div",{className:"anime-stat-card",children:[o.jsx("div",{className:"anime-stat-label",children:"Episodes Watched"}),o.jsx("div",{className:"anime-stat-value",children:ae})]}),o.jsxs("div",{className:"anime-stat-card",children:[o.jsx("div",{className:"anime-stat-label",children:"Watching"}),o.jsx("div",{className:"anime-stat-value",children:je.byStatus.watching})]}),o.jsxs("div",{className:"anime-stat-card",children:[o.jsx("div",{className:"anime-stat-label",children:"Completed"}),o.jsx("div",{className:"anime-stat-value",children:je.byStatus.completed})]}),o.jsxs("div",{className:"anime-stat-card",children:[o.jsx("div",{className:"anime-stat-label",children:"Plan to Watch"}),o.jsx("div",{className:"anime-stat-value",children:je.byStatus.plan_to_watch})]}),o.jsxs("div",{className:"anime-stat-card",children:[o.jsx("div",{className:"anime-stat-label",children:"Avg. Score"}),o.jsx("div",{className:"anime-stat-value",children:je.avgScore?je.avgScore.toFixed(1):"0.0"})]}),o.jsxs("div",{className:"anime-stat-card",children:[o.jsx("div",{className:"anime-stat-label",children:"Days Watched"}),o.jsx("div",{className:"anime-stat-value",children:Me.toFixed(1)})]})]}),o.jsxs("section",{className:"anime-toolbar",children:[o.jsx("input",{type:"text",placeholder:"Search anime by title...",value:m,onChange:pe=>v(pe.target.value),className:"anime-input"}),o.jsxs("select",{value:x,onChange:pe=>S(pe.target.value),className:"anime-select",children:[o.jsx("option",{value:"all",children:"All statuses"}),o.jsx("option",{value:"watching",children:"Watching"}),o.jsx("option",{value:"completed",children:"Completed"}),o.jsx("option",{value:"on_hold",children:"On Hold"}),o.jsx("option",{value:"plan_to_watch",children:"Plan to Watch"}),o.jsx("option",{value:"dropped",children:"Dropped"})]})]}),b&&o.jsx("div",{className:"loading",children:"Loading anime list from MAL..."}),Y&&o.jsx("div",{className:"error-state",children:Y}),!b&&!Y&&o.jsx(o.Fragment,{children:d.length===0?o.jsx("div",{className:"empty-state",children:"No results match your filters yet."}):o.jsx("section",{className:"anime-grid",children:d.map(pe=>ze(pe))})})]}),W.length>0&&o.jsxs("aside",{className:"anime-updates-float",children:[o.jsxs("div",{className:"anime-updates-header",children:[o.jsx("h3",{children:"Recent Updates"}),o.jsx("span",{className:"anime-updates-caption",children:"Last list activity"})]}),o.jsx("div",{className:"anime-updates-list",children:W.map(pe=>Je(pe))})]}),ye&&o.jsx(hw,{open:O,title:"Suggest an Anime",placeholder:"Type an anime you'd like me to watch...",value:k,status:ve,loading:Re,onChange:P,onSubmit:De,onClose:()=>G(!1)}),V&&o.jsx("div",{className:"modal-backdrop visible",onClick:pe=>{pe.target===pe.currentTarget&&te(null)},children:o.jsxs("div",{className:"anime-modal",children:[o.jsxs("div",{className:"anime-modal-header",children:[o.jsx("h2",{style:{color:"#ffb6c1",margin:0},children:V.title}),o.jsx("button",{className:"anime-modal-close",onClick:()=>te(null),type:"button","aria-label":"Close",children:"X"})]}),o.jsxs("div",{className:"anime-modal-body",children:[o.jsx("div",{children:o.jsx("img",{className:"anime-modal-cover",src:V.image||"https://imgur.com/chUgq4W.png",alt:V.title})}),o.jsxs("div",{className:"anime-modal-meta",children:[o.jsxs("div",{children:[o.jsx("strong",{children:"Status:"})," ",s(V.status)]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Episodes:"})," ",V.episodes?V.episodes:"Unknown"]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Progress:"})," ",Number.isFinite(Number(V.watchedEpisodes))?`Episode ${V.watchedEpisodes}${Number.isFinite(Number(V.episodes))?`/${V.episodes}`:""}`:"Unknown"]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Score:"})," ",Number.isFinite(Number(V.score))&&Number(V.score)>0?V.score:"Not rated"]})]}),o.jsx(vR,{modalItem:V,modalLoading:ge,modalSynopsisShown:Ee,onReveal:async()=>{if(!V)return;D(!0);const pe=V.id;if(!pe)return;const Be=be[pe];if(Be!==void 0){te(he=>he&&{...he,synopsis:Be});return}ie(!0);try{const he=await pR(pe);we(Qe=>({...Qe,[pe]:he||""})),te(Qe=>Qe&&{...Qe,synopsis:he||""})}catch{we(Qe=>({...Qe,[pe]:""})),te(Qe=>Qe&&{...Qe,synopsis:""})}finally{ie(!1)}}})]})]})})]})}function vR({modalItem:n,modalLoading:e,modalSynopsisShown:t,onReveal:s}){var m;const a=((m=n==null?void 0:n.synopsis)==null?void 0:m.trim())||"",[c,d]=R.useState(0),f=R.useRef(null);return R.useEffect(()=>{if(t&&f.current){const v=f.current.scrollHeight+12;d(v)}else d(0)},[t,a]),o.jsxs("div",{className:"anime-modal-summary",children:[o.jsxs("div",{className:"anime-modal-summary-header",children:[o.jsx("h3",{children:"Synopsis"}),!t&&o.jsx("button",{className:"anime-synopsis-btn",type:"button",onClick:s,children:e?"Loading...":"Reveal Synopsis"})]}),o.jsx("div",{className:`anime-modal-summary-body ${t?"is-open":""}`,style:{maxHeight:t?`${c}px`:0,opacity:t?1:0},children:o.jsx("div",{ref:f,children:o.jsx("p",{className:"anime-modal-summary-text",children:e&&!a?"Loading synopsis...":a||"No synopsis available."})})}),!t&&o.jsx("p",{className:"anime-modal-summary-text anime-modal-summary-hint",children:"Synopsis hidden. Click reveal to view."})]})}function _R(){const n={game:"pokemon",name:"",setName:"",number:"",rarity:"",condition:"",quantity:1,pricePaid:"",estimatedValue:"",image:"",productURL:"",notes:""},{admin:e,user:t}=za(),[s,a]=R.useState(()=>localStorage.getItem("tcgLastGame")||n.game),[c,d]=R.useState([]),[f,m]=R.useState(!0),[v,x]=R.useState(""),[S,b]=R.useState("all"),[M,Y]=R.useState("name"),[z,V]=R.useState(!1),[te,be]=R.useState([]),[we,ge]=R.useState(""),[ie,Ee]=R.useState(null),[D,N]=R.useState(!1),[C,O]=R.useState(()=>({...n,game:s}));R.useEffect(()=>{document.title="TCG | Collection"},[]),R.useEffect(()=>{let A=!1;const W=async()=>{if(!A)try{const je=await fetch("/base/tcg-collection.json",{cache:"no-cache"});if(!je.ok)throw new Error("fallback fetch failed");const Me=await je.json(),ae=Array.isArray(Me.tcg)?Me.tcg:[];A||d(ae.map((ze,Je)=>({id:ze.id||`offline-${Je}`,...ze})))}catch(De){console.error("TCG offline fallback failed",De)}finally{A||m(!1)}};async function ye(){m(!0);try{const De=Sn(at,"tcg"),je=await vs(De),Me=[];je.forEach(ae=>Me.push({id:ae.id,...ae.data()})),A||d(Me)}catch(De){console.error("Error loading TCG:",De),await W()}finally{A||m(!1)}}return ye(),()=>{A=!0}},[t]);const G=c.filter(A=>{if(S!=="all"&&A.game!==S)return!1;if(!v)return!0;const W=v.toLowerCase();return(A.name||"").toLowerCase().includes(W)||(A.setName||"").toLowerCase().includes(W)||(A.number||"").toLowerCase().includes(W)}),k=[...G].sort((A,W)=>{const ye=(A.name||"").toLowerCase(),De=(W.name||"").toLowerCase(),je=(A.setName||"").toLowerCase(),Me=(W.setName||"").toLowerCase(),ae=(A.rarity||"").toLowerCase(),ze=(W.rarity||"").toLowerCase(),Je=Number(A.quantity||0),pe=Number(W.quantity||0),Be=Number(A.estimatedValue||0)*Math.max(1,Je),he=Number(W.estimatedValue||0)*Math.max(1,pe);switch(M){case"set":return je.localeCompare(Me)||ye.localeCompare(De);case"rarity":return ae.localeCompare(ze)||ye.localeCompare(De);case"quantity":return pe-Je||ye.localeCompare(De);case"value":return he-Be||ye.localeCompare(De);case"name":default:return ye.localeCompare(De)}}),P=c.reduce((A,W)=>{const ye=Number(W.quantity||1),De=Number(W.pricePaid||0),je=Number(W.estimatedValue||0);A.totalCards+=ye,A.totalPaid+=ye*De,A.totalValue+=ye*je;const Me=(W.game||"").toLowerCase(),ae=ye*je;return Me==="pokemon"?(A.pokemon+=ye,A.valueByGame.pokemon+=ae):Me==="onepiece"?(A.onepiece+=ye,A.valueByGame.onepiece+=ae):Me==="mtg"?(A.mtg+=ye,A.valueByGame.mtg+=ae):A.valueByGame.other+=ae,A},{totalCards:0,totalPaid:0,totalValue:0,pokemon:0,onepiece:0,mtg:0,valueByGame:{pokemon:0,onepiece:0,mtg:0,other:0}}),ve=P.totalValue-P.totalPaid,Ge=[["Pokemon",P.valueByGame.pokemon],["One Piece",P.valueByGame.onepiece],["MTG",P.valueByGame.mtg],["Other",P.valueByGame.other]].filter(([,A])=>A>0).map(([A,W])=>`${A}: $${W.toFixed(2)}`),Re=Ge.length?Ge.join(`
`):"No value data yet",ce=(A,W)=>{if(A==="game"){a(W);try{localStorage.setItem("tcgLastGame",W)}catch{}}O(ye=>({...ye,[A]:W}))},re=async()=>{if(!e)return;if(!C.name.trim()){alert("Card name is required.");return}const A={game:C.game,name:C.name.trim(),setName:C.setName.trim(),number:C.number.trim(),rarity:C.rarity.trim(),condition:C.condition.trim(),quantity:Number(C.quantity||1),pricePaid:Number(C.pricePaid||0),estimatedValue:Number(C.estimatedValue||0),image:C.image.trim(),productURL:C.productURL.trim(),notes:C.notes.trim()},W=je=>({game:(je.game||"").toLowerCase().trim(),name:(je.name||"").toLowerCase().trim(),setName:(je.setName||"").toLowerCase().trim(),number:(je.number||"").toLowerCase().trim(),rarity:(je.rarity||"").toLowerCase().trim(),condition:(je.condition||"").toLowerCase().trim(),pricePaid:Number(je.pricePaid||0),estimatedValue:Number(je.estimatedValue||0),image:(je.image||"").trim(),productURL:(je.productURL||"").trim(),notes:(je.notes||"").trim()}),ye=W(A),De=c.find(je=>{const Me=W(je);return Me.game===ye.game&&Me.name===ye.name&&Me.setName===ye.setName&&Me.number===ye.number&&Me.rarity===ye.rarity&&Me.condition===ye.condition&&Me.pricePaid===ye.pricePaid&&Me.estimatedValue===ye.estimatedValue&&Me.image===ye.image&&Me.productURL===ye.productURL&&Me.notes===ye.notes});try{const je=Sn(at,"tcg");if(De!=null&&De.id){const Me=Number(De.quantity||1)+A.quantity;await _s(Dt(at,"tcg",De.id),{quantity:Me}),d(ae=>ae.map(ze=>ze.id===De.id?{...ze,quantity:Me}:ze))}else{await Ra(je,A);const Me=await vs(je),ae=[];Me.forEach(ze=>ae.push({id:ze.id,...ze.data()})),d(ae)}O({...n,game:s}),N(!1)}catch(je){console.error("Error adding card:",je),alert("Failed to save card.")}},Ie=async()=>{if(!e||!ie)return;if(!ie.name.trim()){alert("Card name is required.");return}const A={game:ie.game,name:ie.name.trim(),setName:ie.setName.trim(),number:ie.number.trim(),rarity:ie.rarity.trim(),condition:ie.condition.trim(),quantity:Number(ie.quantity||1),pricePaid:Number(ie.pricePaid||0),estimatedValue:Number(ie.estimatedValue||0),image:ie.image?ie.image.trim():"",productURL:ie.productURL?ie.productURL.trim():"",notes:ie.notes?ie.notes.trim():""};try{await _s(Dt(at,"tcg",ie.id),A),d(W=>W.map(ye=>ye.id===ie.id?{...ye,...A}:ye)),Ee(null)}catch(W){console.error("Error updating card:",W),alert("Failed to update card.")}},xe=async A=>{if(e&&window.confirm("Delete this card?"))try{await Na(Dt(at,"tcg",A)),d(W=>W.filter(ye=>ye.id!==A))}catch(W){console.error("Delete error:",W),alert("Failed to delete card.")}},K=()=>{if(!c.length){alert("No cards to export.");return}const A=new Blob([JSON.stringify({tcg:c},null,2)],{type:"application/json"}),W=URL.createObjectURL(A),ye=document.createElement("a");ye.href=W,ye.download="tcg-collection.json",ye.click(),URL.revokeObjectURL(W)};return o.jsxs("main",{className:"page",children:[o.jsxs("header",{style:{marginTop:"32px",marginBottom:"16px",display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",gap:"6px"},children:[o.jsx("h1",{style:{margin:0,fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Tyler's TCG Collection"}),o.jsx("p",{style:{margin:"6px 0 0",color:"var(--text-soft)",fontSize:"0.9rem"},children:"Check out my TCG Collection with all the data of how much I spent (Under construction) and how much my collection is worth in total!"}),e&&o.jsx("div",{style:{marginTop:"10px"},children:o.jsx("button",{className:"manga-btn secondary",type:"button",onClick:K,children:"Export JSON"})})]}),e&&o.jsx("button",{className:"manga-btn",type:"button","aria-label":"Add card",onClick:()=>N(!0),style:{position:"fixed",bottom:"20px",right:"20px",zIndex:1e3,width:"56px",height:"56px",borderRadius:"50%",padding:0,fontSize:"28px",display:"flex",alignItems:"center",justifyContent:"center"},children:"+"}),e&&D&&o.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(8,1,10,0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,padding:"12px"},onClick:A=>{A.target===A.currentTarget&&N(!1)},children:o.jsxs("div",{style:{width:"min(720px, 95vw)",background:"#140710",border:"1px solid rgba(255,182,193,0.3)",borderRadius:"12px",padding:"14px",boxShadow:"0 24px 60px rgba(0,0,0,0.85)"},onClick:A=>A.stopPropagation(),children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx("h2",{style:{margin:0,color:"#ffb6c1"},children:"Add card"}),o.jsx("button",{className:"dashboard-close",onClick:()=>N(!1),type:"button","aria-label":"Close",children:"X"})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"180px 1fr",gap:"12px",alignItems:"flex-start",marginTop:"10px"},children:[o.jsx("div",{style:{width:"100%",maxWidth:"180px",borderRadius:"10px",border:"1px solid rgba(255,182,193,0.25)",background:"#1e0d14",overflow:"hidden",aspectRatio:"3 / 4",display:"flex",alignItems:"center",justifyContent:"center"},children:C.image?o.jsx("img",{src:C.image,alt:"Card preview",style:{width:"100%",height:"100%",objectFit:"cover"}}):o.jsx("div",{style:{color:"var(--text-soft)",fontSize:"0.8rem",padding:"6px"},children:"No image"})}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:"8px"},children:[o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Game",o.jsxs("select",{value:C.game,onChange:A=>ce("game",A.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"},children:[o.jsx("option",{value:"pokemon",children:"Pokemon"}),o.jsx("option",{value:"onepiece",children:"One Piece"}),o.jsx("option",{value:"mtg",children:"MTG"})]})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Card name",o.jsx("input",{type:"text",value:C.name,onChange:A=>ce("name",A.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Set name",o.jsx("input",{type:"text",value:C.setName,onChange:A=>ce("setName",A.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Card number",o.jsx("input",{type:"text",value:C.number,onChange:A=>ce("number",A.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Rarity",o.jsx("input",{type:"text",value:C.rarity,onChange:A=>ce("rarity",A.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Condition",o.jsx("input",{type:"text",value:C.condition,onChange:A=>ce("condition",A.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Quantity",o.jsx("input",{type:"number",min:"1",value:C.quantity,onChange:A=>ce("quantity",A.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Price paid (per card)",o.jsx("input",{type:"number",step:"0.01",min:"0",value:C.pricePaid,onChange:A=>ce("pricePaid",A.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Estimated value (per card)",o.jsx("input",{type:"number",step:"0.01",min:"0",value:C.estimatedValue,onChange:A=>ce("estimatedValue",A.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Image URL",o.jsx("input",{type:"text",value:C.image||"",onChange:A=>ce("image",A.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Product URL (backend only)",o.jsx("input",{type:"text",value:C.productURL||"",onChange:A=>ce("productURL",A.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{gridColumn:"1 / -1",fontSize:"0.8rem",color:"var(--text-soft)"},children:["Notes",o.jsx("textarea",{value:C.notes,onChange:A=>ce("notes",A.target.value),rows:3,style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff",resize:"vertical"}})]})]})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"12px"},children:[o.jsx("button",{onClick:()=>{O(n),N(!1)},style:{padding:"6px 12px",borderRadius:"999px",border:"1px solid rgba(255,182,193,0.5)",background:"transparent",color:"#ffb6c1",cursor:"pointer"},children:"Cancel"}),o.jsx("button",{onClick:re,style:{padding:"6px 12px",borderRadius:"999px",border:"none",cursor:"pointer",fontWeight:600,background:"#ff69b4",color:"#1e0d14"},children:"Save card"})]})]})}),e&&ie&&o.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(8,1,10,0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,padding:"12px"},onClick:A=>{A.target===A.currentTarget&&Ee(null)},children:o.jsxs("div",{style:{width:"min(720px, 95vw)",background:"#140710",border:"1px solid rgba(255,182,193,0.3)",borderRadius:"12px",padding:"14px",boxShadow:"0 24px 60px rgba(0,0,0,0.85)"},onClick:A=>A.stopPropagation(),children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx("h2",{style:{margin:0,color:"#ffb6c1"},children:"Edit card"}),o.jsx("button",{className:"dashboard-close",onClick:()=>Ee(null),type:"button","aria-label":"Close",children:"X"})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"180px 1fr",gap:"12px",alignItems:"flex-start",marginTop:"10px"},children:[o.jsx("div",{style:{width:"100%",maxWidth:"180px",borderRadius:"10px",border:"1px solid rgba(255,182,193,0.25)",background:"#1e0d14",overflow:"hidden",aspectRatio:"3 / 4",display:"flex",alignItems:"center",justifyContent:"center"},children:ie.image?o.jsx("img",{src:ie.image,alt:"Card preview",style:{width:"100%",height:"100%",objectFit:"cover"}}):o.jsx("div",{style:{color:"var(--text-soft)",fontSize:"0.8rem",padding:"6px"},children:"No image"})}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:"8px"},children:[o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Game",o.jsxs("select",{value:ie.game,onChange:A=>Ee(W=>({...W,game:A.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"},children:[o.jsx("option",{value:"pokemon",children:"Pokemon"}),o.jsx("option",{value:"onepiece",children:"One Piece"}),o.jsx("option",{value:"mtg",children:"MTG"})]})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Card name",o.jsx("input",{type:"text",value:ie.name,onChange:A=>Ee(W=>({...W,name:A.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Set name",o.jsx("input",{type:"text",value:ie.setName,onChange:A=>Ee(W=>({...W,setName:A.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Card number",o.jsx("input",{type:"text",value:ie.number,onChange:A=>Ee(W=>({...W,number:A.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Rarity",o.jsx("input",{type:"text",value:ie.rarity,onChange:A=>Ee(W=>({...W,rarity:A.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Condition",o.jsx("input",{type:"text",value:ie.condition,onChange:A=>Ee(W=>({...W,condition:A.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Quantity",o.jsx("input",{type:"number",value:ie.quantity,onChange:A=>Ee(W=>({...W,quantity:A.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Price paid (each)",o.jsx("input",{type:"number",value:ie.pricePaid,onChange:A=>Ee(W=>({...W,pricePaid:A.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Estimated value (each)",o.jsx("input",{type:"number",value:ie.estimatedValue,onChange:A=>Ee(W=>({...W,estimatedValue:A.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Image URL",o.jsx("input",{type:"text",value:ie.image||"",onChange:A=>Ee(W=>({...W,image:A.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Product URL (backend only)",o.jsx("input",{type:"text",value:ie.productURL||"",onChange:A=>Ee(W=>({...W,productURL:A.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{gridColumn:"1 / -1",fontSize:"0.8rem",color:"var(--text-soft)"},children:["Notes",o.jsx("textarea",{value:ie.notes||"",onChange:A=>Ee(W=>({...W,notes:A.target.value})),rows:3,style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff",resize:"vertical"}})]})]})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"12px"},children:[o.jsx("button",{onClick:()=>Ee(null),style:{padding:"6px 12px",borderRadius:"999px",border:"1px solid rgba(255,182,193,0.5)",background:"transparent",color:"#ffb6c1",cursor:"pointer"},children:"Cancel"}),o.jsx("button",{onClick:Ie,style:{padding:"6px 12px",borderRadius:"999px",border:"none",cursor:"pointer",fontWeight:600,background:"#ff69b4",color:"#1e0d14"},children:"Save changes"})]})]})}),o.jsxs("section",{style:{display:"flex",flexWrap:"wrap",gap:"12px",marginTop:"18px",justifyContent:"center"},children:[o.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[o.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Total cards"}),o.jsx("div",{style:{fontSize:"1.1rem",fontWeight:700},children:P.totalCards})]}),P.totalPaid>0&&o.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[o.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Total paid"}),o.jsxs("div",{style:{fontSize:"1.1rem",fontWeight:700},children:["$",P.totalPaid.toFixed(2)]})]}),o.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},title:Re,children:[o.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Total value"}),o.jsxs("div",{style:{fontSize:"1.1rem",fontWeight:700},children:["$",P.totalValue.toFixed(2)]})]}),o.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[o.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Unrealized gain / loss"}),o.jsxs("div",{style:{fontSize:"1.1rem",fontWeight:700,color:ve>=0?"#00e676":"#ff8a80"},children:[ve>=0?"+":"-","$",Math.abs(ve).toFixed(2)]})]}),o.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[o.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Pokemon cards"}),o.jsx("div",{style:{fontSize:"1.1rem",fontWeight:700},children:P.pokemon})]}),o.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[o.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"One Piece cards"}),o.jsx("div",{style:{fontSize:"1.1rem",fontWeight:700},children:P.onepiece})]}),o.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[o.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"MTG cards"}),o.jsx("div",{style:{fontSize:"1.1rem",fontWeight:700},children:P.mtg})]})]}),o.jsxs("section",{style:{display:"flex",flexWrap:"wrap",gap:"10px",marginTop:"16px"},children:[o.jsx("input",{type:"text",placeholder:"Search by name, set, or number...",value:v,onChange:A=>x(A.target.value),style:{flex:"1 1 220px",minWidth:"220px",padding:"8px 12px",borderRadius:"999px",border:"1px solid #bb7f8f",background:"#2b0f1d",color:"#fff"}}),o.jsxs("select",{value:S,onChange:A=>b(A.target.value),style:{flex:"0 0 220px",padding:"8px 12px",borderRadius:"999px",border:"1px solid #bb7f8f",background:"#2b0f1d",color:"#fff"},children:[o.jsx("option",{value:"all",children:"All games"}),o.jsx("option",{value:"pokemon",children:"Pokemon only"}),o.jsx("option",{value:"onepiece",children:"One Piece only"}),o.jsx("option",{value:"mtg",children:"MTG only"})]}),o.jsxs("select",{value:M,onChange:A=>Y(A.target.value),style:{flex:"0 0 220px",padding:"8px 12px",borderRadius:"999px",border:"1px solid #bb7f8f",background:"#2b0f1d",color:"#fff"},children:[o.jsx("option",{value:"name",children:"Sort: Name (A-Z)"}),o.jsx("option",{value:"set",children:"Sort: Set (A-Z)"}),o.jsx("option",{value:"rarity",children:"Sort: Rarity (A-Z)"}),o.jsx("option",{value:"quantity",children:"Sort: Quantity (high to low)"}),o.jsx("option",{value:"value",children:"Sort: Value (high to low)"})]})]}),f?o.jsx("p",{style:{marginTop:"20px",color:"var(--text-soft)"},children:"Loading TCG collection..."}):G.length===0?o.jsx("p",{style:{marginTop:"20px",color:"var(--text-soft)"},children:"No cards found."}):o.jsx("section",{className:"grid",style:{gridTemplateColumns:"repeat(auto-fill, minmax(170px, 1fr))",marginTop:"20px"},children:k.map(A=>{const W=Number(A.quantity||1),ye=W*Number(A.pricePaid||0),De=W*Number(A.estimatedValue||0);return o.jsxs("article",{style:{background:"#2b0f1d",borderRadius:"12px",border:"1px solid rgba(255,182,193,0.25)",boxShadow:"0 4px 16px rgba(0,0,0,0.55)",padding:"10px",fontSize:"0.82rem",display:"flex",flexDirection:"column",gap:"6px"},children:[A.image&&o.jsx("div",{style:{width:"100%",paddingTop:"140%",position:"relative",overflow:"hidden",borderRadius:"10px",background:"#1e0d14"},children:o.jsx("img",{src:A.image,alt:A.name||"card image",style:{position:"absolute",inset:0,width:"100%",height:"100%",objectFit:"contain"}})}),o.jsx("div",{style:{fontWeight:700,color:"#ffb6c1",marginBottom:"4px"},children:A.name||"Unnamed card"}),o.jsx("div",{style:{color:"var(--text-soft)",marginBottom:"4px"},children:A.setName||""}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",color:"var(--text-soft)"},children:[o.jsxs("span",{children:["#",A.number||"-"]}),o.jsx("span",{children:A.rarity||""})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",color:"var(--text-soft)",marginTop:"4px"},children:[o.jsxs("span",{children:["Cond: ",A.condition||"N/A"]}),o.jsxs("span",{children:["Qty: ",W]})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",color:"var(--text-soft)",marginTop:"4px"},children:[o.jsxs("span",{children:["Paid: $",ye.toFixed(2)]}),o.jsxs("span",{children:["Value: $",De.toFixed(2)]})]}),A.notes&&o.jsxs("div",{style:{color:"#9c8fa6",fontSize:"0.72rem",fontStyle:"italic",textAlign:"center",marginTop:"6px"},children:['"',A.notes,'"']}),o.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"8px"},children:[o.jsx("span",{style:{padding:"2px 7px",borderRadius:"999px",background:"rgba(255,105,180,0.18)",border:"1px solid rgba(255,105,180,0.5)",color:"#ffb6c1",fontSize:"0.7rem",whiteSpace:"nowrap"},children:{pokemon:"Pokemon",onepiece:"One Piece",mtg:"MTG"}[A.game]||"Other"}),e&&o.jsxs("div",{style:{display:"flex",gap:"6px",alignItems:"center",marginLeft:"auto"},children:[o.jsx("button",{onClick:()=>Ee({...A,pricePaid:A.pricePaid??"",estimatedValue:A.estimatedValue??"",quantity:A.quantity??1}),style:{padding:"3px 8px",borderRadius:"999px",border:"1px solid rgba(255,182,193,0.5)",background:"rgba(255,105,180,0.15)",color:"#ffb6c1",fontSize:"0.7rem",cursor:"pointer"},children:"Edit"}),o.jsx("button",{onClick:()=>xe(A.id),style:{padding:"3px 8px",borderRadius:"999px",border:"1px solid rgba(244,67,54,0.7)",background:"rgba(244,67,54,0.12)",color:"#ff8a80",fontSize:"0.7rem",cursor:"pointer"},children:"Delete"})]})]})]},A.id)})})]})}const Cl="https://discord.com/api/webhooks/1448287168845054004/cGWGPoH5LaTFlBZ1vxtgMjOfV9au6qyQ_9ZRnOWN9-AX0MNfwxKNWVcZYQHz0ESA7_4k",Pl="https://discord.com/api/webhooks/1448288240871276616/101WI-B2p8tDR34Hl9fZxxb0QG01f1Eo5w1IvbttlQmP2wWFNJ0OI7UnJfJujKRNWW2Q";function mc(n){const e=n==null?"":String(n);return e.trim()?e.replace(/\s*,?\s*(?:vol(?:ume)?\.?)\s+\d+.*$/i,"").trim():""}function vi(n){if(!n)return null;if(n instanceof Date)return n;if(n&&typeof n.toDate=="function")return n.toDate();const e=String(n).trim();if(!e)return null;const t=e.match(/^(\d{4})-(\d{2})-(\d{2})$/);if(t){const[,c,d,f]=t;return new Date(Number(c),Number(d)-1,Number(f))}const s=e.match(/^(\d{1,2})\/(\d{1,2})\/(\d{2,4})$/);if(s){let[,c,d,f]=s;const m=f.length===2?+`20${f}`:Number(f);return new Date(m,Number(c)-1,Number(d))}const a=new Date(e);return isNaN(a.getTime())?null:a}function Rd(n){const e=n.seriesKey||n.series||n.Series||n.title||n.Title||"",s=(mc(e)||e).trim();return s?s.toLowerCase():""}function xR(n){const e=(n==null?void 0:n.series)||(n==null?void 0:n.Series)||(n==null?void 0:n.title)||(n==null?void 0:n.Title)||"Unknown Series";return mc(e)||"Unknown Series"}function __(n){const e=(n||"").trim(),t=e.match(/^(.*?)(?:,?\s*(?:vol\.|volume)\s*(\d+)(?:\s*[-]\s*\d+)?\s*)?(?:\s*\([^)]*\))?$/i),s=t?t[1].trim().toLowerCase():e.toLowerCase(),a=t&&t[2]?parseInt(t[2],10):0;return{name:s,vol:Number.isFinite(a)?a:0}}function wR(n,e){const t=(n==null?void 0:n.Title)||(n==null?void 0:n.title)||"",s=(e==null?void 0:e.Title)||(e==null?void 0:e.title)||"",a=__(t),c=__(s),d=a.name.localeCompare(c.name);return d!==0?d:a.vol!==c.vol?a.vol-c.vol:t.localeCompare(s)}function gf(){return{publisher:"",demographic:"",genre:"",subGenre:"",datePurchased:"",msrp:"",initialPublisher:"",initialDemographic:"",initialGenre:"",initialSubGenre:"",initialDatePurchased:"",initialMsrp:"",dateMixed:!1,readChecked:!1,readIndeterminate:!1}}function x_(){return{read:!1,datePurchased:"",dateRead:"",pageCount:"",msrp:"",amountPaid:"",rating:"",special:!1,specialType:"",specialVolumes:"",collectiblePrice:""}}function w_(n,e={}){const t=e.ignoreShared,s=(n==null?void 0:n.amountPaid)??(n==null?void 0:n.AmountPaid)??(n==null?void 0:n.paid)??(n==null?void 0:n.Paid)??"",a=(n==null?void 0:n.msrp)??(n==null?void 0:n.MSRP)??"",c=((n==null?void 0:n.datePurchased)||(n==null?void 0:n.DatePurchased)||"").trim(),d=((n==null?void 0:n.publisher)||(n==null?void 0:n.Publisher)||"").trim(),f=((n==null?void 0:n.demographic)||(n==null?void 0:n.Demographic)||"").trim(),m=((n==null?void 0:n.genre)||(n==null?void 0:n.Genre)||"").trim(),v=((n==null?void 0:n.specialType)||(n==null?void 0:n.SpecialType)||"").trim(),x=(n==null?void 0:n.specialVolumes)??(n==null?void 0:n.SpecialVolumes)??(n==null?void 0:n.volumesContained)??"",S=(n==null?void 0:n.collectiblePrice)??(n==null?void 0:n.CollectiblePrice)??"",b=!!v,M=(n==null?void 0:n.pageCount)??(n==null?void 0:n.PageCount)??(n==null?void 0:n.pages)??(n==null?void 0:n.Pages)??"",Y=M==null?"":String(M).trim(),z=Number(Y),V=!Y||Number.isNaN(z)||z<=0;return!b&&(s===""||s===null)||V||!c||!t&&(a===""||!d||!f||!m)||b&&!v||b&&v.toLowerCase()==="collectible"&&(S===""||S===null)||b&&v.toLowerCase()==="specialedition"&&(x===""||x===null)}function ER(n){const e=(n==null?void 0:n.amountPaid)??"",t=((n==null?void 0:n.datePurchased)||"").trim(),s=!!(n!=null&&n.specialType)||!!(n!=null&&n.special),a=((n==null?void 0:n.specialType)||"").trim(),c=(n==null?void 0:n.specialVolumes)??"",d=(n==null?void 0:n.collectiblePrice)??"",f=(n==null?void 0:n.pageCount)??"",m=(n==null?void 0:n.msrp)??"",v=((n==null?void 0:n.publisher)||"").trim(),x=((n==null?void 0:n.demographic)||"").trim(),S=((n==null?void 0:n.genre)||"").trim(),b=!s&&(e===""||e===null),M=s&&!a,Y=s&&a.toLowerCase()==="collectible"&&(d===""||d===null),z=s&&a.toLowerCase()==="specialedition"&&(c===""||c===null),V=(()=>{const te=(f??"").toString().trim();if(te==="")return!0;const be=Number(te);return Number.isNaN(be)||be<=0})();return{amountPaid:b,datePurchased:!t,specialType:M,collectiblePrice:Y,specialVolumes:z,pageCount:V,msrp:m===""||m===null,publisher:!v,demographic:!x,genre:!S}}function TR(n){return!n||!n.books||!n.books.length?!1:n.books.some(e=>{const t=(e==null?void 0:e.msrp)??(e==null?void 0:e.MSRP)??"",s=((e==null?void 0:e.publisher)||(e==null?void 0:e.Publisher)||"").trim(),a=((e==null?void 0:e.demographic)||(e==null?void 0:e.Demographic)||"").trim(),c=((e==null?void 0:e.genre)||(e==null?void 0:e.Genre)||"").trim();return t===""||!s||!a||!c})}function SR(n){const e=new Map;for(const t of n){const s=Rd(t)||t.id;if(!e.has(s)){const m=mc(t.series||t.Series||t.title||t.Title||"Unknown Series")||"Unknown Series";e.set(s,{key:s,title:m,publisher:t.publisher||t.Publisher||"",genre:t.genre||t.Genre||"",demographic:t.demographic||t.Demographic||"",volumes:0,totalPages:0,readPages:0,readVolumes:0,ratingSum:0,ratingCount:0})}const a=e.get(s);a.volumes+=1;const c=Number(t.pages||t.Pages||t.pageCount||0)||0;a.totalPages+=c,(!!t.read||t.status==="Read"||t.Read===!0)&&(a.readVolumes+=1,a.readPages+=c);const f=Number(t.rating||t.Rating);!isNaN(f)&&f>0&&(a.ratingSum+=f,a.ratingCount+=1)}return e}function Eo(n,e,t=5){const s=new Map;for(const a of n.values()){const c=(a[e]||"").trim();if(!c)continue;const d=c.split(/[\/,]/).map(f=>f.trim()).filter(Boolean);for(const f of d)s.set(f,(s.get(f)||0)+1)}return[...s.entries()].sort((a,c)=>c[1]-a[1]).slice(0,t).map(([a,c])=>({name:a,count:c}))}function E_(n,e){const t=Array.from({length:12},(s,a)=>{const c=new Date(e,a,1);return{key:`${e}-${a}`,label:c.toLocaleString("default",{month:"short"}),year:e,month:a,value:0}});for(const s of n){const a=vi(s.dateRead||s.DateRead);!a||a.getFullYear()!==e||(t[a.getMonth()].value+=1)}return t}function Ia(n){const e=n.getFullYear(),t=`${n.getMonth()+1}`.padStart(2,"0"),s=`${n.getDate()}`.padStart(2,"0");return`${e}-${t}-${s}`}async function T_(n,e){try{await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:e})})}catch(t){console.error("Webhook post failed",t)}}function bR(n){const e=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],t=Array(7).fill(0);for(const c of n){const d=vi(c.dateRead||c.DateRead);d&&(t[d.getDay()]+=1)}if(!t.some(c=>c>0))return[];const a=t.reduce((c,d)=>Math.max(c,d),0)||1;return e.map((c,d)=>({label:c,value:t[d],pct:t[d]/a}))}function IR(n,e=8){const t=[...n.values()];t.sort((c,d)=>d.volumes-c.volumes);const s=t.slice(0,e),a=s.reduce((c,d)=>Math.max(c,d.volumes),0)||1;return s.map(c=>({label:c.title,value:c.volumes,pct:c.volumes/a}))}function CR(n,e){const t=(a,c)=>{const d=vi(a.releaseDate||a.ReleaseDate||a.date||a.Date);if(!d)return null;const f=(a.title||a.series||a.Title||"Unknown Title").trim(),m=!!(a.datePurchased||a.DatePurchased||"").trim();return{date:d,title:f,purchased:m,source:c}},s=[];return(e||[]).forEach(a=>{const c=t(a,"wishlist");c&&s.push(c)}),(n||[]).forEach(a=>{const c=t(a,"library");c&&s.push(c)}),s.sort((a,c)=>a.date-c.date),s}function PR(n){const e=new Date;for(const t of n)if(t.date>=e)return t;return n[n.length-1]||null}function NR(n){let e=0,t=0;for(const s of n){const a=vi(s.datePurchased||s.DatePurchased),c=vi(s.dateRead||s.DateRead);if(!a||!c)continue;const d=c-a;d<=0||(e+=d/(1e3*60*60*24),t+=1)}return t?e/t:null}function RR(n){const e=new Map;for(const t of n){const s=vi(t.datePurchased||t.DatePurchased),a=vi(t.dateRead||t.DateRead);if(!s||!a)continue;const c=a-s;if(c<=0)continue;const d=c/(1e3*60*60*24),f=Rd(t)||t.id,m=mc(t.series||t.Series||t.title||t.Title||"Untitled")||"Untitled";e.has(f)||e.set(f,{key:f,title:m,total:0,count:0,min:d,max:d});const v=e.get(f);v.total+=d,v.count+=1,v.min=Math.min(v.min,d),v.max=Math.max(v.max,d)}return[...e.values()].filter(t=>t.count>0).map(t=>({...t,avg:t.total/t.count})).sort((t,s)=>s.avg-t.avg)}function AR(n){let e=0,t=0,s=0;for(const a of n){const c=Number(a.msrp||a.MSRP||0)||0,d=Number(a.amountPaid||a.AmountPaid||a.pricePaid||0)||c||0,f=Number(a.collectiblePrice||a.CollectiblePrice||0)||0;e+=c,t+=d,s+=f}return{msrpTotal:e,paidTotal:t,collectibleTotal:s}}function jR(n){const e=new Map;for(const t of n){const s=Rd(t)||t.id;if(!e.has(s)){const S=t.series||t.Series||t.title||t.Title||"Untitled";e.set(s,{key:s,title:mc(S)||S.trim()||"Untitled",msrp:0,paid:0,collectible:0,books:0,pages:0,readPages:0,ratings:[]})}const a=e.get(s);a.books+=1;const c=Number(t.msrp||t.MSRP||0)||0,d=Number(t.amountPaid||t.AmountPaid||t.pricePaid||0)||0,f=Number(t.collectiblePrice||t.CollectiblePrice||0)||0,m=Number(t.pages||t.Pages||t.pageCount||0)||0,v=!!t.read||t.status==="Read"||t.Read===!0;a.msrp+=c,a.paid+=d,a.collectible+=f,a.pages+=m,v&&(a.readPages+=m);const x=Number(t.rating||t.Rating);!isNaN(x)&&x>0&&a.ratings.push(x)}return[...e.values()]}function kR(n){let e=0,t=0;for(const s of n){const a=Number(s.pages||s.Pages||s.pageCount||0)||0;e+=a,(!!s.read||s.status==="Read"||s.Read===!0)&&(t+=a)}return{total:e,read:t}}function DR(n){let e=0,t=0;for(const s of n.values())s.ratingCount>0&&(e+=s.ratingSum/s.ratingCount,t+=1);return t?e/t:null}function LR({data:n}){if(!n||!n.length)return o.jsx("div",{className:"line-chart empty",children:"No reading data yet."});const e=n.reduce((v,x)=>Math.max(v,x.value),0)||1,t=480,s=230,a=30,c=s-a*2,d=t/Math.max(n.length-1,1),f=n.map((v,x)=>{const S=x*d,b=s-a-v.value/e*c;return{...v,x:S,y:b}}),m=f.map((v,x)=>x===0?`M ${v.x} ${v.y}`:`L ${v.x} ${v.y}`).join(" ");return o.jsx("div",{className:"line-chart",children:o.jsxs("svg",{viewBox:`0 0 ${t} ${s}`,width:"100%",height:"100%",preserveAspectRatio:"xMidYMid meet",children:[[0,.25,.5,.75,1].map((v,x)=>{const S=s-a-v*c;return o.jsx("line",{className:"line-grid",x1:"0",x2:t,y1:S,y2:S},`h-${x}`)}),f.map((v,x)=>o.jsx("line",{className:"line-grid",x1:v.x,x2:v.x,y1:a/2,y2:s-a/2},`v-${x}`)),o.jsx("path",{className:"line-path",d:m}),f.map((v,x)=>o.jsxs("g",{children:[o.jsx("circle",{className:"line-point",cx:v.x,cy:v.y,r:"1.5"}),o.jsx("text",{className:"line-value",x:v.x,y:v.y-3,children:v.value}),o.jsx("text",{className:"line-label",x:v.x,y:s-4,children:v.label})]},x))]})})}function VR({data:n}){return!n||!n.length?o.jsx("div",{className:"weekday-breakdown empty",children:"No reads recorded yet."}):o.jsx("div",{className:"weekday-bars",children:n.map(e=>o.jsxs("div",{className:"weekday-col",children:[o.jsx("div",{className:"weekday-count",children:e.value}),o.jsx("div",{className:"weekday-bar-vert",children:o.jsx("div",{className:"weekday-bar-vert-fill",style:{height:`${Math.max(e.pct*100,e.value?6:0)}%`}})}),o.jsx("div",{className:"weekday-label",children:e.label})]},e.label))})}function S_(n,e,t){const s=n.getFullYear(),a=n.getMonth(),d=new Date(s,a,1).getDay(),f=new Date(s,a+1,0).getDate(),m=new Map;for(const S of e){const b=S.date;if(b.getFullYear()===s&&b.getMonth()===a){const M=b.getDate();m.has(M)||m.set(M,[]),m.get(M).push(S)}}const v=[];for(let S=0;S<d;S++)v.push({type:"pad"});for(let S=1;S<=f;S++){const b=Ia(new Date(s,a,S));v.push({type:"day",day:S,releases:m.get(S)||[],dateKey:b,isToday:b===t})}const x=Math.ceil(v.length/7)*7;for(;v.length<x;)v.push({type:"pad"});return v}function MR(){const{user:n,admin:e,loading:t}=za(),[s,a]=R.useState([]),[c,d]=R.useState([]),[f,m]=R.useState(!0),[v,x]=R.useState(null),[S,b]=R.useState("-"),[M,Y]=R.useState({yearly:Cl,release:Pl,activity:Ca}),[z,V]=R.useState(new Set),[te,be]=R.useState(null),[we,ge]=R.useState(null),[ie,Ee]=R.useState(new Set),[D,N]=R.useState(null),[C,O]=R.useState(""),G=R.useRef(null),[k,P]=R.useState(()=>gf()),[ve,Ge]=R.useState(()=>x_()),[Re,ce]=R.useState([]),[re,Ie]=R.useState(!1),[xe,K]=R.useState([]),[A,W]=R.useState(!1),[ye,De]=R.useState([]),[je,Me]=R.useState(!1),[ae,ze]=R.useState(""),[Je,pe]=R.useState(null),[Be,he]=R.useState(null),Qe=async()=>{if(e)try{W(!0);const F=(await vs(Sn(at,"users"))).docs.map(Q=>({uid:Q.id,...Q.data()}));K(F)}catch(T){console.error("Failed to load users",T)}finally{W(!1)}},Ye=async(T,F)=>{const Q=(T||"").trim();if(!Q){alert("UID is required.");return}try{await ci(Dt(at,"users",Q),{role:F,updatedBy:(n==null?void 0:n.uid)||"manual",updatedAt:new Date().toISOString()},{merge:!0}),await Qe()}catch(ue){console.error("Failed to update role",ue),alert("Failed to update role.")}},[_t,Nt]=R.useState(!1),[xt,Ct]=R.useState(()=>new Date),[en,mn]=R.useState(!1),[ln,fr]=R.useState(()=>new Date),[tn,Kn]=R.useState(null),[Ot,$t]=R.useState(!1),[On,lr]=R.useState(()=>{const T=new Date;return{year:T.getFullYear(),month:T.getMonth()}}),[In,Fn]=R.useState(null),[Qt,es]=R.useState({open:!1,type:null}),Cn=new Date().getFullYear(),gn=R.useRef(null),ts=R.useRef(null);R.useEffect(()=>{document.title="Dashboard"},[]),R.useEffect(()=>(_t||Qt.open||re||!!Be||en||!!tn||Ot||!!In?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[_t,Qt.open,re,Be,en,tn,Ot,In]),R.useEffect(()=>{typeof window>"u"||(gn.current=localStorage.getItem("dashboard-yearly-posted"),ts.current=localStorage.getItem("dashboard-release-posted"))},[]),R.useEffect(()=>{if(!e)return;const T=Dt(at,"settings","webhooks");(async()=>{try{const F=await Pd(T);if(F.exists()){const Q=F.data();Y({yearly:Q.yearly||Cl,release:Q.release||Pl,activity:Q.activity||Ca})}else await ci(T,{yearly:Cl,release:Pl,activity:Ca}),Y({yearly:Cl,release:Pl,activity:Ca})}catch(F){console.error("Failed to load webhook settings",F)}})()},[e]),R.useEffect(()=>{if(!e)return;let T=!1;return(async()=>await Qe())(),()=>{T=!0}},[e]),R.useEffect(()=>{let T=!1;if(!n||!e){De([]),ze("");return}return(async()=>{try{Me(!0);const Q=(await vs(Sn(at,"suggestions"))).docs.map(ue=>{var Ne;const Te=ue.data();let qe=null;if((Ne=Te==null?void 0:Te.createdAt)!=null&&Ne.toDate)qe=Te.createdAt.toDate();else if(Te!=null&&Te.createdAt){const Xe=new Date(Te.createdAt);qe=isNaN(Xe.getTime())?null:Xe}return{id:ue.id,...Te,createdAt:qe}});Q.sort((ue,Te)=>{var qe,Ne,Xe,ut;return(((Ne=(qe=Te.createdAt)==null?void 0:qe.getTime)==null?void 0:Ne.call(qe))||0)-(((ut=(Xe=ue.createdAt)==null?void 0:Xe.getTime)==null?void 0:ut.call(Xe))||0)}),T||(De(Q),ze(""))}catch(F){console.error("Failed to load suggestions",F),T||(ze("Failed to load suggestions."),De([]))}finally{T||Me(!1)}})(),()=>{T=!0}},[n,e]);const Ts=async T=>{if(!(!e||!T))try{await Na(Dt(at,"suggestions",T)),De(F=>F.filter(Q=>Q.id!==T))}catch(F){console.error("Failed to delete suggestion",F),ze("Failed to delete suggestion.")}};R.useEffect(()=>{let T=!1;async function F(){if(!n||!e){a([]),d([]),x(null),m(!1);return}try{m(!0);const[Q,ue]=await Promise.all([vs(Sn(at,"library")),vs(Sn(at,"wishlist"))]);if(T)return;a(Q.docs.map(Te=>({id:Te.id,...Te.data()}))),d(ue.docs.map(Te=>({id:Te.id,...Te.data()}))),x(null)}catch(Q){console.error(Q),T||x("Failed to load dashboard data.")}finally{T||m(!1)}}return F(),()=>{T=!0}},[n,e]);const Pt=R.useMemo(()=>{const T=s.length,F=s.filter(zn=>!!zn.read||zn.status==="Read"||zn.Read===!0).length,Q=T-F,ue=T?Math.round(F/T*100):0,Te=c.length,qe=SR(s),Ne=E_(s,Cn),Xe=E_(s,Cn-1),ut=Ne.reduce((zn,cs)=>zn+cs.value,0),gt=bR(s),Lt=IR(qe),St=CR(s,c),nn=PR(St),xn=NR(s),wt=AR(s),rn=kR(s),Zn=DR(qe),zr=RR(s),Rr=Eo(qe,"publisher",5),Ys=Eo(qe,"genre",5),Ba=Eo(qe,"demographic",5),Ar=jR(s);return{totalLibrary:T,readCount:F,unreadCount:Q,readPct:ue,wishlistCount:Te,seriesMap:qe,monthlyReads:Ne,prevYearReads:Xe,currentYearReadsTotal:ut,weekdayBreakdown:gt,topSeriesBars:Lt,releases:St,nextRelease:nn,avgDays:xn,purchaseToReadSeries:zr,collectionValue:wt,pages:rn,avgRating:Zn,topPublishers:Rr,topGenres:Ys,topDemographics:Ba,seriesAggregates:Ar}},[s,c,Cn]),{totalLibrary:pr,readCount:Ss,unreadCount:Qn,readPct:Yn,wishlistCount:Cr,seriesMap:Pn,monthlyReads:Pr,prevYearReads:Jn,currentYearReadsTotal:Ws,weekdayBreakdown:mr,topSeriesBars:Gs,releases:rt,nextRelease:Xn,avgDays:Nn,purchaseToReadSeries:ns,collectionValue:Rn,pages:yn,avgRating:An,topPublishers:bs,topGenres:Is,topDemographics:Un,seriesAggregates:Fr}=Pt,Ft=Xn?Xn.date:null,rs=!!v,cn=Ia(new Date),Nr=R.useMemo(()=>s.map(T=>{const F=vi(T.dateRead||T.DateRead);return!F||!(T.read||T.status==="Read"||T.Read===!0)?null:{date:F,title:T.title||T.Title||"Untitled"}}).filter(Boolean).sort((T,F)=>T.date-F.date),[s]),qs=R.useMemo(()=>S_(ln,Nr,cn),[ln,Nr,cn]),Ur=R.useMemo(()=>{const T=new Map;return[...s,...c].forEach(Q=>{const ue=vi(Q.datePurchased||Q.DatePurchased);if(!ue)return;const Te=Ia(ue);T.has(Te)||T.set(Te,[]),T.get(Te).push({id:Q.id||Q.Title||Q.title||Te,title:Q.title||Q.Title||"Untitled"})}),T.forEach(Q=>Q.sort((ue,Te)=>(ue.title||"").localeCompare(Te.title||""))),T},[s,c]),ss=R.useMemo(()=>{const{year:T,month:F}=On,ue=new Date(T,F,1).getDay(),Te=new Date(T,F+1,0).getDate();let qe=!1;const Ne=[];for(let ut=0;ut<ue;ut+=1)Ne.push({type:"pad"});for(let ut=1;ut<=Te;ut+=1){const gt=new Date(T,F,ut),Lt=Ia(gt),St=Ur.get(Lt)||[];St.length&&(qe=!0),Ne.push({type:"day",day:ut,dateKey:Lt,items:St,releases:St,isToday:Lt===cn})}const Xe=Math.ceil(Ne.length/7)*7;for(;Ne.length<Xe;)Ne.push({type:"pad"});return{cells:Ne,hasItems:qe}},[On,Ur,cn]),vn=R.useMemo(()=>{if(!s||!s.length)return[];const T=new Map;s.forEach(Q=>{const ue=Rd(Q)||Q.id,Te=xR(Q);T.has(ue)||T.set(ue,{seriesKey:ue,displayName:Te,books:[]}),T.get(ue).books.push(Q)});const F=Array.from(T.values()).map(Q=>({...Q,books:[...Q.books].sort(wR)}));return F.sort((Q,ue)=>Q.displayName.localeCompare(ue.displayName)),F},[s]),Hs=R.useMemo(()=>vn.flatMap(T=>T.books.map(F=>F.id)),[vn]);R.useEffect(()=>{we&&(s.some(T=>T.id===we)||ge(null))},[s,we]),R.useEffect(()=>{te&&(vn.some(T=>T.seriesKey===te)||be(null))},[vn,te]),R.useEffect(()=>{if(!ie.size)return;const T=new Set(s.map(Q=>Q.id)),F=Array.from(ie).filter(Q=>!T.has(Q));F.length&&Ee(Q=>{const ue=new Set(Q);return F.forEach(Te=>ue.delete(Te)),ue})},[s,ie]),R.useEffect(()=>{const T=Array.from(ie);if(!T.length){O("");return}const F=Array.from(new Set(T.map(Q=>s.find(ue=>ue.id===Q)).filter(Boolean).map(Q=>{const ue=Q.amountPaid??Q.AmountPaid??"";return ue==null?"":String(ue)})));O(F.length===1?F[0]:"")},[ie,s]),R.useEffect(()=>{const T=vn.find(wt=>wt.seriesKey===te);if(!T){P(gf());return}const F=T.books,Q=wt=>{const rn=Array.from(new Set(F.map(Zn=>{const zr=wt(Zn);return zr==null?"":String(zr).trim()})));return rn.length===1?rn[0]:""},ue=Q(wt=>wt.publisher||wt.Publisher),Te=Q(wt=>wt.demographic||wt.Demographic),qe=Q(wt=>wt.genre||wt.Genre),Ne=Q(wt=>wt.subGenre||wt.SubGenre),Xe=Q(wt=>wt.msrp??wt.MSRP),ut=Array.from(new Set(F.map(wt=>(wt.datePurchased||wt.DatePurchased||"").trim()).filter(Boolean))),gt=ut.length>1,Lt=gt?"":ut[0]||"",St=F.filter(wt=>!!wt.read||wt.status==="Read"||wt.Read===!0).length,nn=St===F.length&&F.length>0;P({publisher:ue,demographic:Te,genre:qe,subGenre:Ne,datePurchased:Lt,msrp:Xe,initialPublisher:ue,initialDemographic:Te,initialGenre:qe,initialSubGenre:Ne,initialDatePurchased:Lt,initialMsrp:Xe,dateMixed:gt,readChecked:nn,readIndeterminate:!nn&&!(St===0)})},[vn,te]),R.useEffect(()=>{G.current&&(G.current.indeterminate=k.readIndeterminate)},[k.readIndeterminate]),R.useEffect(()=>{const T=s.find(Q=>Q.id===we);if(!T){Ge(x_());return}const F=!!T.read||T.status==="Read"||T.Read===!0;Ge({read:F,datePurchased:T.datePurchased||T.DatePurchased||"",dateRead:F&&(T.dateRead||T.DateRead)||"",pageCount:T.pageCount??T.PageCount??T.pages??T.Pages??"",msrp:T.msrp??T.MSRP??"",amountPaid:T.amountPaid??T.AmountPaid??"",rating:F?T.rating??T.Rating??"":"",special:!!(T.specialType||T.SpecialType),specialType:T.specialType??T.SpecialType??"",specialVolumes:T.specialVolumes??T.SpecialVolumes??"",collectiblePrice:T.collectiblePrice??T.CollectiblePrice??"",publisher:T.publisher||T.Publisher||"",demographic:T.demographic||T.Demographic||"",genre:T.genre||T.Genre||""})},[we,s]),R.useEffect(()=>{if(!Jn||!Jn.length)return;const T=Cn-1,F=Jn.reduce((qe,Ne)=>qe+Ne.value,0);if(!F||(gn.current?parseInt(gn.current,10):null)===T)return;const ue=Jn.map(qe=>`${qe.label}: ${qe.value}`).join(", "),Te=`Yearly reads summary for ${T}: ${F} total. Breakdown: ${ue}`;T_(M.yearly,Te).then(()=>{gn.current=String(T),typeof window<"u"&&localStorage.setItem("dashboard-yearly-posted",String(T))})},[Jn,Cn]),R.useEffect(()=>{if(!Xn||!rt.length)return;const T=Ia(Xn.date),F=Ia(new Date);if(T>F||ts.current===T)return;const Q=rt.filter(Te=>Ia(Te.date)===T);if(!Q.length)return;const ue=`Wishlist releases for ${T}:
${Q.map(Te=>`- ${Te.title}`).join(`
`)}`;T_(M.release,ue).then(()=>{ts.current=T,typeof window<"u"&&localStorage.setItem("dashboard-release-posted",T)})},[Xn,rt]),R.useEffect(()=>{if(!Ft){b("-");return}const T=()=>{const Q=Ft-new Date;if(Q<=0){b("Released");return}const ue=Math.floor(Q/1e3),Te=Math.floor(ue/86400),qe=Math.floor(ue%86400/3600).toString().padStart(2,"0"),Ne=Math.floor(ue%3600/60).toString().padStart(2,"0"),Xe=Math.floor(ue%60).toString().padStart(2,"0");b(`${Te}d ${qe}:${Ne}:${Xe}`)};T();const F=setInterval(T,1e3);return()=>clearInterval(F)},[Ft]),R.useEffect(()=>{if(!(typeof window>"u"))try{const T=localStorage.getItem(sm);if(!T)return;const F=JSON.parse(T);if(!Array.isArray(F))return;const Q=F.map(ue=>({message:ue.message,ts:ue.ts?new Date(ue.ts):new Date})).filter(ue=>ue.message);Q.length&&ce(Q)}catch(T){console.warn("Failed to load activity log",T)}},[]);const Ks=async()=>{try{const T=await vs(Sn(at,"library"));a(T.docs.map(F=>({id:F.id,...F.data()})))}catch(T){console.error("Failed to refresh library",T),x(F=>F||"Failed to refresh library data.")}},dt=T=>{const F=(T??"").toString().trim();if(F==="")return"";const Q=parseFloat(F);return Number.isFinite(Q)?Q:""},is=T=>{const F=(T??"").toString().trim();if(F==="")return"";const Q=parseInt(F,10);return Number.isFinite(Q)?Q:""},jn=T=>{if(!T)return;const F={message:T,ts:new Date};ce(Q=>{const ue=[F,...Q].slice(0,100);return fw(ue),ue}),pw(T,{email:(n==null?void 0:n.email)||"anonymous",name:(n==null?void 0:n.displayName)||"",webhookOverride:M.activity,persistLocal:!1})},w=T=>{V(F=>{const Q=new Set(F);return Q.has(T)?Q.delete(T):Q.add(T),Q}),be(T),ge(null)},B=(T,F,Q)=>{const ue=T.metaKey||T.ctrlKey,Te=T.shiftKey,qe=Hs.indexOf(F);let Ne=new Set(ie);if(Te&&D!==null&&qe!==-1){const Xe=Math.min(D,qe),ut=Math.max(D,qe);for(let gt=Xe;gt<=ut;gt+=1){const Lt=Hs[gt];Lt&&Ne.add(Lt)}}else ue?Ne.has(F)?Ne.delete(F):Ne.add(F):Ne=new Set;Ee(Ne),N(qe),ge(F),be(Q),V(Xe=>{const ut=new Set(Xe);return ut.add(Q),ut})},$=()=>{Ee(new Set),N(null)},L=async()=>{if(!e){alert("Dashboard is read-only for your account.");return}const T=Array.from(ie);if(!T.length){alert("Select books in Library Manager (use Ctrl/Cmd or Shift) before bulk editing.");return}const F=(C||"").toString().trim(),Q=F!=="",ue=dt(F);if(Q&&ue===""){alert("Enter a valid number for Amount Paid.");return}try{await Promise.all(T.map(Te=>_s(Dt(at,"library",Te),{amountPaid:Q?ue:""}))),await Ks(),$(),jn(`Updated amount paid for ${T.length} book${T.length===1?"":"s"} in library`),alert(`Applied Amount Paid to ${T.length} selection${T.length===1?"":"s"}.`)}catch(Te){console.error("Failed to apply Amount Paid",Te),alert("Failed to apply Amount Paid to selection.")}},q=async()=>{if(!e){alert("Dashboard is read-only for your account.");return}const T=vn.find(St=>St.seriesKey===te);if(!T||!T.books.length)return;const F=!k.readIndeterminate,Q=!!k.readChecked,ue=k.datePurchased!==k.initialDatePurchased,Te=k.msrp!==k.initialMsrp,qe=k.publisher!==k.initialPublisher,Ne=k.demographic!==k.initialDemographic,Xe=k.genre!==k.initialGenre,ut=k.subGenre!==k.initialSubGenre;if(!F&&!ue&&!Te&&!qe&&!Ne&&!Xe&&!ut)return;const gt=String(k.msrp??"").trim(),Lt=Te?dt(gt):"";if(Te&&gt!==""&&Lt===""){alert("Enter a valid number for MSRP.");return}try{const St=[];if(T.books.forEach(nn=>{const xn={};F&&(xn.read=Q,xn.dateRead=Q?nn.dateRead||nn.DateRead||new Date().toISOString().slice(0,10):""),ue&&(xn.datePurchased=k.datePurchased||""),Te&&(xn.msrp=k.msrp===""?"":Lt),qe&&(xn.publisher=k.publisher||""),Ne&&(xn.demographic=k.demographic||""),Xe&&(xn.genre=k.genre||""),ut&&(xn.subGenre=k.subGenre||""),Object.keys(xn).length&&St.push(_s(Dt(at,"library",nn.id),xn))}),!St.length)return;await Promise.all(St),await Ks(),ge(null),jn(`Updated series "${T.displayName||"Series"}" (${T.books.length} book${T.books.length===1?"":"s"})`),alert("Series updated.")}catch(St){console.error("Failed to save series changes",St),alert("Failed to update series.")}},oe=async()=>{if(!e){alert("Dashboard is read-only for your account.");return}if(!we)return;const T=!!ve.read,F=String(ve.msrp??"").trim(),Q=String(ve.amountPaid??"").trim(),ue=String(ve.pageCount??"").trim(),Te=String(ve.rating??"").trim(),qe=dt(F),Ne=dt(Q),Xe=is(ue),ut=dt(Te);if(F!==""&&qe===""){alert("Enter a valid number for MSRP.");return}if(Q!==""&&Ne===""){alert("Enter a valid number for Amount Paid.");return}if(ue!==""&&Xe===""){alert("Enter a valid page count.");return}if(T&&Te!==""&&ut===""){alert("Enter a valid rating.");return}const gt=!!ve.special,Lt=is(ve.specialVolumes),St=dt(ve.collectiblePrice),nn=String(ve.specialVolumes??"").trim(),xn=String(ve.collectiblePrice??"").trim();if(gt&&ve.specialType==="specialEdition"&&nn!==""&&Lt===""){alert("Enter a valid number for volumes contained.");return}if(gt&&ve.specialType==="collectible"&&xn!==""&&St===""){alert("Enter a valid collectible price.");return}const wt=T?ve.dateRead||new Date().toISOString().slice(0,10):"",rn={read:T,datePurchased:ve.datePurchased||"",dateRead:wt,msrp:ve.msrp===""?"":qe,amountPaid:ve.amountPaid===""?"":Ne,pageCount:ve.pageCount===""?"":Xe,rating:T?ve.rating===""?"":ut:"",specialType:gt&&ve.specialType||"",specialVolumes:gt&&ve.specialType==="specialEdition"?ve.specialVolumes===""?"":Lt:"",collectiblePrice:gt&&ve.specialType==="collectible"?ve.collectiblePrice===""?"":St:""};try{await _s(Dt(at,"library",we),rn),await Ks();const Zn=s.find(Rr=>Rr.id===we)||ke,zr=(Zn==null?void 0:Zn.Title)||(Zn==null?void 0:Zn.title)||"Untitled";jn(`Updated "${zr}" in library`),alert("Saved changes.")}catch(Zn){console.error("Failed to save book changes",Zn),alert("Failed to save changes.")}},se=()=>{be(null),ge(null),$(),P(gf())},Ce=()=>{ge(null),N(null)},Pe=vn.find(T=>T.seriesKey===te)||null,ke=s.find(T=>T.id===we)||null,le=te?{msrp:!k.msrp,datePurchased:!k.datePurchased&&!k.dateMixed,publisher:!k.publisher,demographic:!k.demographic,genre:!k.genre}:{},ot=we?ER({amountPaid:ve.amountPaid,msrp:ve.msrp,datePurchased:ve.datePurchased,publisher:(ke==null?void 0:ke.publisher)||(ke==null?void 0:ke.Publisher)||"",demographic:(ke==null?void 0:ke.demographic)||(ke==null?void 0:ke.Demographic)||"",genre:(ke==null?void 0:ke.genre)||(ke==null?void 0:ke.Genre)||"",special:ve.special,specialType:ve.specialType,specialVolumes:ve.specialVolumes,collectiblePrice:ve.collectiblePrice,pageCount:ve.pageCount}):{};if(t)return o.jsx("div",{className:"page dashboard-page",children:o.jsxs("div",{className:"dashboard-loading",children:[o.jsx("h1",{children:"Dashboard"}),o.jsx("p",{children:"Checking permissions..."})]})});if(!n||!e)return o.jsx("div",{className:"page dashboard-page",children:o.jsxs("div",{className:"dashboard-locked",children:[o.jsx("h1",{children:"Dashboard"}),o.jsx("p",{children:"This area is restricted to admin accounts."})]})});if(f)return o.jsx("div",{className:"page dashboard-page",children:o.jsxs("div",{className:"dashboard-loading",children:[o.jsx("h1",{children:"Dashboard"}),v?o.jsx("p",{className:"error",children:v}):o.jsx("p",{children:"Loading stats..."})]})});const Le=pr+Cr,ht=Le?Math.round(pr/Le*100):0,cr=[...Pn.values()].filter(T=>T.ratingCount>0).map(T=>({title:T.title,avg:T.ratingSum/T.ratingCount,count:T.ratingCount})).sort((T,F)=>F.avg-T.avg||F.count-T.count).slice(0,3);function Qs(){if(Ft)Ct(new Date(Ft.getFullYear(),Ft.getMonth(),1));else if(rt.length){const T=rt[0].date;Ct(new Date(T.getFullYear(),T.getMonth(),1))}Nt(!0)}function _n(T){es({open:!0,type:T})}function Yt(){es({open:!1,type:null})}const as=S_(xt,rt,cn),os=T=>{lr(F=>{const Q=new Date(F.year,F.month+T,1);return{year:Q.getFullYear(),month:Q.getMonth()}})},ls=T=>{fr(F=>new Date(F.getFullYear(),F.getMonth()+T,1))},Rt=()=>{$t(!1),Fn(null)},Cs=()=>{const T=Array.from(Ur.keys()).sort();if(T.length){const F=T[T.length-1],[Q,ue]=F.split("-"),Te=Number(Q),qe=Number(ue)-1;!Number.isNaN(Te)&&!Number.isNaN(qe)&&lr({year:Te,month:qe})}$t(!0)},pt=()=>{if(Nr.length){const T=Nr[Nr.length-1].date;fr(new Date(T.getFullYear(),T.getMonth(),1))}else fr(new Date);mn(!0)};function Ps(){const T=Qt.type;if(!T)return null;if(T==="publishers"){const F=[...Eo(Pn,"publisher",100)];return o.jsxs(o.Fragment,{children:[o.jsx("h3",{children:"Top Publishers by Series"}),F.length===0?o.jsx("p",{children:"No publisher data yet."}):o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"#"}),o.jsx("th",{children:"Publisher"}),o.jsx("th",{children:"Series Count"})]})}),o.jsx("tbody",{children:F.map((Q,ue)=>o.jsxs("tr",{children:[o.jsx("td",{children:ue+1}),o.jsx("td",{children:Q.name}),o.jsx("td",{children:Q.count})]},Q.name+ue))})]})]})}if(T==="genres"){const F=[...Eo(Pn,"genre",100)];return o.jsxs(o.Fragment,{children:[o.jsx("h3",{children:"Top Genres by Series"}),F.length===0?o.jsx("p",{children:"No genre data yet."}):o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"#"}),o.jsx("th",{children:"Genre"}),o.jsx("th",{children:"Series Count"})]})}),o.jsx("tbody",{children:F.map((Q,ue)=>o.jsxs("tr",{children:[o.jsx("td",{children:ue+1}),o.jsx("td",{children:Q.name}),o.jsx("td",{children:Q.count})]},Q.name+ue))})]})]})}if(T==="demographics"){const F=[...Eo(Pn,"demographic",100)];return o.jsxs(o.Fragment,{children:[o.jsx("h3",{children:"Top Demographics by Series"}),F.length===0?o.jsx("p",{children:"No demographic data yet."}):o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"#"}),o.jsx("th",{children:"Demographic"}),o.jsx("th",{children:"Series Count"})]})}),o.jsx("tbody",{children:F.map((Q,ue)=>o.jsxs("tr",{children:[o.jsx("td",{children:ue+1}),o.jsx("td",{children:Q.name}),o.jsx("td",{children:Q.count})]},Q.name+ue))})]})]})}if(T==="timeToRead"){const F=ns||[];return o.jsxs(o.Fragment,{children:[o.jsx("h3",{children:"Average Time From Purchase to Read"}),Nn==null?o.jsx("p",{children:"Not enough volumes have both purchase and read dates to calculate this yet."}):o.jsxs(o.Fragment,{children:[o.jsxs("p",{children:["On average, it takes"," ",o.jsxs("strong",{children:[Nn.toFixed(1)," days"]})," from purchase to finishing a volume."]}),F.length>0?o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Series"}),o.jsx("th",{children:"Avg Days"}),o.jsx("th",{children:"Longest"}),o.jsx("th",{children:"Shortest"}),o.jsx("th",{children:"Reads Count"})]})}),o.jsx("tbody",{children:F.map(Q=>o.jsxs("tr",{children:[o.jsx("td",{children:Q.title}),o.jsxs("td",{children:[Q.avg.toFixed(1)," days"]}),o.jsxs("td",{children:[Math.round(Q.max)," days"]}),o.jsxs("td",{children:[Math.round(Q.min)," days"]}),o.jsx("td",{children:Q.count})]},Q.key))})]}):o.jsx("p",{style:{marginTop:8},children:"No series-level data yet."})]})]})}if(T==="collectionValue"){const{msrpTotal:F,paidTotal:Q}=Rn,ue=F-Q,Te=F>0?(Q/F*100).toFixed(1):"-",qe=[...Fr].filter(Ne=>Ne.msrp||Ne.paid||Ne.collectible).sort((Ne,Xe)=>Xe.msrp+Xe.collectible-(Ne.msrp+Ne.collectible));return o.jsxs(o.Fragment,{children:[o.jsx("h3",{children:"Collection Value Breakdown"}),o.jsx("table",{children:o.jsxs("tbody",{children:[o.jsxs("tr",{children:[o.jsx("th",{children:"Total MSRP"}),o.jsxs("td",{children:["$",F.toFixed(2)]})]}),o.jsxs("tr",{children:[o.jsx("th",{children:"Total Paid"}),o.jsxs("td",{children:["$",Q.toFixed(2)]})]}),o.jsxs("tr",{children:[o.jsx("th",{children:"Difference"}),o.jsxs("td",{children:["$",ue.toFixed(2)]})]}),o.jsxs("tr",{children:[o.jsx("th",{children:"Paid vs MSRP"}),o.jsx("td",{children:Te==="-"?"-":`${Te}%`})]})]})}),qe.length>0&&o.jsxs(o.Fragment,{children:[o.jsx("h4",{style:{marginTop:"14px"},children:"Collection Pricing"}),o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Title"}),o.jsx("th",{children:"MSRP"}),o.jsx("th",{children:"Paid"}),o.jsx("th",{children:"Collectible"}),o.jsx("th",{children:"Books"})]})}),o.jsx("tbody",{children:qe.map((Ne,Xe)=>o.jsxs("tr",{children:[o.jsx("td",{children:Ne.title}),o.jsxs("td",{children:["$",Ne.msrp.toFixed(2)]}),o.jsxs("td",{children:["$",Ne.paid.toFixed(2)]}),o.jsx("td",{children:Ne.collectible?`$${Ne.collectible.toFixed(2)}`:"--"}),o.jsx("td",{children:Ne.books})]},Ne.title+Xe))})]})]})]})}if(T==="pages"){const F=[...Fr].filter(Q=>Q.pages>0).map(Q=>({...Q,pct:Q.pages?Math.round(Q.readPages/Q.pages*100):0})).sort((Q,ue)=>ue.pages-Q.pages);return o.jsxs(o.Fragment,{children:[o.jsx("h3",{children:"Pages Read vs Total"}),o.jsx("table",{children:o.jsxs("tbody",{children:[o.jsxs("tr",{children:[o.jsx("th",{children:"Total Pages"}),o.jsx("td",{children:yn.total.toLocaleString()})]}),o.jsxs("tr",{children:[o.jsx("th",{children:"Pages Read"}),o.jsx("td",{children:yn.read.toLocaleString()})]}),o.jsxs("tr",{children:[o.jsx("th",{children:"Completion"}),o.jsx("td",{children:yn.total?`${(yn.read/yn.total*100).toFixed(1)}%`:"-"})]})]})}),F.length>0&&o.jsxs(o.Fragment,{children:[o.jsx("h4",{style:{marginTop:"14px"},children:"Pages by Series"}),o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Title"}),o.jsx("th",{children:"Read Pages"}),o.jsx("th",{children:"Total Pages"}),o.jsx("th",{children:"% Read"}),o.jsx("th",{children:"Books"})]})}),o.jsx("tbody",{children:F.map((Q,ue)=>o.jsxs("tr",{children:[o.jsx("td",{children:Q.title}),o.jsx("td",{children:Q.readPages.toLocaleString()}),o.jsx("td",{children:Q.pages.toLocaleString()}),o.jsxs("td",{children:[Q.pct,"%"]}),o.jsx("td",{children:Q.books})]},Q.title+ue))})]})]})]})}if(T==="ratings"){const F=[...Fr].map(Q=>{if(!Q.ratings.length)return null;const ue=Q.ratings.reduce((Te,qe)=>Te+qe,0)/Q.ratings.length;return{title:Q.title,avg:ue,count:Q.ratings.length}}).filter(Boolean).sort((Q,ue)=>ue.avg-Q.avg||ue.count-Q.count);return o.jsxs(o.Fragment,{children:[o.jsx("h3",{children:"Ratings Overview"}),An==null?o.jsx("p",{children:"No ratings have been recorded yet."}):o.jsxs("p",{children:["Average series rating across rated series is"," ",o.jsx("strong",{children:An.toFixed(2)}),"."]}),F.length>0&&o.jsxs(o.Fragment,{children:[o.jsx("h4",{style:{marginTop:"14px"},children:"Series Averages"}),o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Title"}),o.jsx("th",{children:"Avg"}),o.jsx("th",{children:"Ratings"})]})}),o.jsx("tbody",{children:F.map((Q,ue)=>o.jsxs("tr",{children:[o.jsx("td",{children:Q.title}),o.jsx("td",{children:Q.avg.toFixed(2)}),o.jsx("td",{children:Q.count})]},Q.title+ue))})]})]})]})}return T==="releases"?o.jsxs(o.Fragment,{children:[o.jsx("h3",{children:"Library & Wishlist Releases"}),rt.length===0?o.jsx("p",{children:"No wishlist releases found."}):o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Date"}),o.jsx("th",{children:"Title"})]})}),o.jsx("tbody",{children:rt.map((F,Q)=>o.jsxs("tr",{children:[o.jsx("td",{children:F.date.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}),o.jsx("td",{children:F.title})]},Q))})]})]}):null}return o.jsxs("div",{className:"page dashboard-page",children:[o.jsxs("header",{className:"dashboard-header",style:{display:"flex",alignItems:"center",justifyContent:"center",position:"relative",textAlign:"center",width:"100%"},children:[o.jsxs("div",{style:{textAlign:"center",margin:"0 auto",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"0 60px"},children:[o.jsx("h1",{style:{margin:0,fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Dashboard"}),o.jsx("p",{className:"dashboard-sub",style:{textAlign:"center",margin:"6px 0 0"},children:"My Entire Statistics dashboard for my Manga. I still use Excel though."})]}),e&&o.jsx("div",{style:{position:"absolute",right:0,top:"50%",transform:"translateY(-50%)"},children:o.jsx("button",{className:"stat-link",onClick:()=>Ie(!0),type:"button",children:"Admin Settings"})})]}),o.jsx("section",{id:"dashboardSection",className:"page-section active",children:o.jsxs("div",{className:"dashboard-grid",children:[o.jsxs("div",{className:"stat-stack",children:[o.jsxs("div",{className:"stat-card mini clickable",onClick:Cs,children:[o.jsx("h3",{children:"Total Library Books"}),o.jsx("div",{className:"stat-value",children:pr}),o.jsx("div",{className:"stat-sub",children:"Volumes in your library."})]}),o.jsxs("div",{className:"stat-card mini",children:[o.jsx("h3",{children:"Wishlist Items"}),o.jsx("div",{className:"stat-value",children:Cr}),o.jsx("div",{className:"stat-sub",children:"Tracked upcoming wants."})]})]}),o.jsxs("div",{className:"stat-card clickable",onClick:pt,role:"button",tabIndex:0,onKeyDown:T=>{(T.key==="Enter"||T.key===" ")&&(T.preventDefault(),pt())},children:[o.jsx("h3",{children:"Read / Unread"}),o.jsx("div",{className:"pie",style:{"--pct":`${Yn*3.6}deg`},children:o.jsxs("div",{className:"pie-label",children:[Yn,"%"]})}),o.jsxs("div",{className:"stat-value",children:[Ss," read / ",Qn," unread"]})]}),o.jsxs("div",{className:"stat-card clickable",onClick:()=>_n("ratings"),children:[o.jsx("h3",{children:"Ratings"}),o.jsx("div",{className:"stat-value",children:An==null?"-":An.toFixed(2)}),o.jsx("div",{className:"stat-sub",children:"Average across rated series."}),o.jsx("div",{className:"stat-list compact",children:cr.length?cr.map((T,F)=>o.jsxs("div",{className:"stat-list-row",children:[o.jsx("span",{className:"stat-rank",children:F+1}),o.jsx("span",{className:"stat-name",children:T.title}),o.jsx("span",{className:"stat-count",children:T.avg.toFixed(2)})]},T.title+F)):o.jsx("div",{className:"stat-sub",children:"No ratings yet."})})]}),o.jsxs("div",{className:"stat-card clickable",onClick:()=>_n("pages"),children:[o.jsx("h3",{children:"Page Count Read / Total"}),o.jsxs("div",{className:"stat-value",children:[yn.read.toLocaleString()," / ",yn.total.toLocaleString()]}),o.jsx("div",{className:"stat-sub",children:yn.total?`${(yn.read/yn.total*100).toFixed(1)}% read`:"-"})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("h3",{children:"Library vs Wishlist"}),o.jsx("div",{className:"pie",style:{"--pct":`${ht*3.6}deg`},children:o.jsxs("div",{className:"pie-label",children:[ht,"%"]})}),o.jsxs("div",{className:"stat-value",children:[pr," / ",Cr]}),o.jsx("div",{className:"stat-sub",children:"Library vs wishlist share"})]}),o.jsxs("div",{className:"stat-card clickable",onClick:()=>_n("demographics"),children:[o.jsx("h3",{children:"Top Demographics"}),o.jsx("div",{className:"stat-list",children:Un.length?Un.slice(0,3).map((T,F)=>o.jsxs("div",{className:"stat-list-row",children:[o.jsx("span",{className:"stat-rank",children:F+1}),o.jsx("span",{className:"stat-name",children:T.name}),o.jsx("span",{className:"stat-count",children:T.count})]},T.name)):o.jsx("div",{className:"stat-sub",children:"No demographic data yet."})})]}),o.jsxs("div",{className:"stat-card clickable",onClick:()=>_n("publishers"),children:[o.jsx("h3",{children:"Top Publishers"}),o.jsx("div",{className:"stat-list",children:bs.length?bs.slice(0,3).map((T,F)=>o.jsxs("div",{className:"stat-list-row",children:[o.jsx("span",{className:"stat-rank",children:F+1}),o.jsx("span",{className:"stat-name",children:T.name}),o.jsx("span",{className:"stat-count",children:T.count})]},T.name)):o.jsx("div",{className:"stat-sub",children:"No publisher data yet."})})]}),o.jsxs("div",{className:"stat-card clickable",onClick:()=>_n("genres"),children:[o.jsx("h3",{children:"Top Genres"}),o.jsx("div",{className:"stat-list",children:Is.length?Is.slice(0,3).map((T,F)=>o.jsxs("div",{className:"stat-list-row",children:[o.jsx("span",{className:"stat-rank",children:F+1}),o.jsx("span",{className:"stat-name",children:T.name}),o.jsx("span",{className:"stat-count",children:T.count})]},T.name)):o.jsx("div",{className:"stat-sub",children:"No genre data yet."})})]}),o.jsxs("div",{className:"stat-card clickable",onClick:()=>{Qs()},children:[o.jsx("h3",{children:"Next Wishlist Release"}),o.jsx("div",{className:"stat-value next-release",children:Xn?Xn.title:"No upcoming releases"}),o.jsxs("div",{className:"stat-sub",children:[Ft?Ft.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"}):"-",o.jsx("br",{}),o.jsx("span",{id:"statNextCountdown",children:S})]})]}),o.jsxs("div",{className:"stat-card clickable",onClick:()=>_n("collectionValue"),style:{textAlign:"center"},children:[o.jsx("h3",{children:"Collection Pricing"}),o.jsxs("div",{className:"stat-value stat-msrp",children:["$",Rn.msrpTotal.toFixed(2)]}),o.jsxs("div",{className:"stat-value stat-paid",children:["$",Rn.paidTotal.toFixed(2),Rn.msrpTotal>0&&o.jsxs("span",{className:"stat-paid-pct",children:["(",((1-Rn.paidTotal/Rn.msrpTotal)*100).toFixed(1),"% off)"]})]}),o.jsxs("div",{className:"stat-value stat-collectible",children:["$",Rn.collectibleTotal.toFixed(2)]}),o.jsx("div",{className:"stat-sub",children:"MSRP | Paid | Collectible overrides"})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("h3",{children:"Current Year Reads"}),o.jsx("div",{className:"stat-value",children:Ws}),o.jsxs("div",{className:"stat-sub",children:["Reads in ",Cn]})]}),o.jsxs("div",{className:"stat-card clickable",onClick:()=>_n("timeToRead"),children:[o.jsx("h3",{children:"Avg Days From Purchase to Read"}),o.jsx("div",{className:"stat-value",children:Nn==null?"-":`${Nn.toFixed(1)} days`}),o.jsx("div",{className:"stat-sub",children:"When both dates exist"})]}),o.jsxs("div",{className:"stat-duo",children:[o.jsxs("div",{className:"stat-card tall",children:[o.jsxs("h3",{children:["Reads Per Month (",Cn,")"]}),o.jsx(LR,{data:Pr})]}),o.jsxs("div",{className:"stat-card tall",children:[o.jsx("h3",{children:"Reads by Day of Week (Lifetime)"}),o.jsx(VR,{data:mr}),o.jsx("div",{className:"stat-sub",children:"Based on all entries with a read date."})]})]}),o.jsxs("div",{className:"stat-card wide",children:[o.jsx("h3",{children:"Activity Log"}),rs&&o.jsx("div",{className:"error",style:{textAlign:"center"},children:v}),o.jsx("div",{className:"activity-log scrollable",children:Re.length?Re.map((T,F)=>{const Q=T.ts?new Date(T.ts):null;return o.jsxs("div",{className:"activity-row",children:[o.jsx("span",{className:"activity-title",children:T.message}),o.jsx("span",{className:"activity-date",children:Q?Q.toLocaleString(void 0,{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}):""})]},(T.message||"activity")+F)}):o.jsx("div",{className:"stat-sub",children:"No recent activity yet."})})]}),o.jsxs("div",{className:"stat-card wide",style:{minHeight:"340px",maxHeight:"480px"},children:[o.jsx("h3",{children:"Suggestions"}),ae&&o.jsx("div",{className:"error",style:{textAlign:"center"},children:ae}),o.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",alignItems:"stretch"},children:["anime","manga"].map(T=>{const F=ye.filter(Q=>(Q.type||"").toLowerCase()===T).sort((Q,ue)=>{var Te,qe,Ne,Xe;return(((qe=(Te=ue.createdAt)==null?void 0:Te.getTime)==null?void 0:qe.call(Te))||0)-(((Xe=(Ne=Q.createdAt)==null?void 0:Ne.getTime)==null?void 0:Xe.call(Ne))||0)});return o.jsxs("div",{style:{border:"1px solid rgba(255,182,193,0.18)",borderRadius:"16px",padding:"10px 12px",display:"flex",flexDirection:"column",background:"rgba(255,182,193,0.04)",minHeight:"240px"},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"8px",position:"relative"},children:[o.jsx("h4",{style:{margin:0,color:"#ffb6c1",textAlign:"center",flex:1},children:T==="anime"?"Anime":"Manga"}),o.jsxs("span",{className:"stat-sub",style:{position:"absolute",right:0},children:[F.length," suggestion",F.length===1?"":"s"]})]}),o.jsx("div",{className:"scrollable",style:{maxHeight:"280px",height:"280px",paddingRight:"4px",overflowY:"auto"},children:je?o.jsx("div",{className:"stat-sub",children:"Loading suggestions..."}):F.length?F.map(Q=>{const ue=Q.createdAt instanceof Date?Q.createdAt:Q.createdAt?new Date(Q.createdAt):null;return o.jsxs("div",{style:{border:"1px solid rgba(255,182,193,0.25)",borderRadius:"12px",padding:"8px 10px",marginBottom:"8px",background:"rgba(255,182,193,0.06)",display:"grid",gridTemplateColumns:"1fr auto",gap:"6px",alignItems:"center"},children:[o.jsxs("div",{children:[o.jsx("div",{style:{fontWeight:600,color:"#f7d0dc"},children:Q.content||"(no content)"}),o.jsxs("div",{className:"stat-sub",style:{fontSize:"0.8rem"},children:[ue?ue.toLocaleString(void 0,{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}):""," ",Q.from?`| ${Q.from}`:""]})]}),o.jsx("div",{style:{display:"flex",gap:"6px"},children:e&&o.jsx("button",{type:"button",className:"stat-link",onClick:()=>Ts(Q.id),children:"Delete"})})]},Q.id)}):o.jsx("div",{className:"stat-sub",children:"No suggestions yet."})})]},T)})}),o.jsxs("div",{className:"stat-sub",style:{marginTop:"8px",textAlign:"center"},children:["Total suggestions: ",ye.length]})]}),o.jsxs("div",{className:"stat-card wide",children:[o.jsx("h3",{children:"Library Manager"}),vn.length?o.jsxs("div",{className:"dash-library",children:[o.jsxs("div",{className:"dash-library-list",children:[vn.map(T=>{const F=T.books.filter(Ne=>!!Ne.read||Ne.status==="Read"||Ne.Read===!0).length,Q=z.has(T.seriesKey),ue=te===T.seriesKey&&!we,Te=TR(T),qe=T.books.some(Ne=>w_(Ne));return o.jsxs("div",{style:{marginBottom:"8px"},children:[o.jsxs("button",{type:"button",onClick:()=>w(T.seriesKey),style:{width:"100%",textAlign:"left",background:Te?"rgba(255,179,71,0.08)":"transparent",border:`1px solid ${ue?"#ff69b4":Te?"rgba(255,179,71,0.6)":"rgba(255,182,193,0.25)"}`,color:"#ffb6c1",padding:"8px",borderRadius:"8px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"8px",position:"relative",boxShadow:Te?"0 0 10px rgba(255,179,71,0.5)":ue?"0 0 8px rgba(255,105,180,0.5)":"none"},children:[o.jsx("span",{style:{transition:"transform 0.2s ease",transform:Q?"rotate(90deg)":"none"},children:">"}),o.jsx("span",{style:{flex:1},children:T.displayName}),o.jsxs("span",{style:{fontSize:"11px",color:"#f8d1d8"},children:[T.books.length," book",T.books.length===1?"":"s",T.books.length?` | ${F} read`:""]}),qe&&o.jsx("span",{title:"Some volumes are missing required data",style:{width:"12px",height:"12px",borderRadius:"999px",background:"#ffb347",border:"1px solid rgba(255,255,255,0.25)",boxShadow:"0 0 10px rgba(255,179,71,0.6)"}})]}),o.jsx("div",{style:{margin:"6px 0 10px 10px",paddingLeft:"10px",borderLeft:"1px solid rgba(255,182,193,0.25)",display:Q?"block":"none"},children:T.books.map(Ne=>{const Xe=we===Ne.id,ut=ie.has(Ne.id);Ne.read||Ne.status==="Read"||Ne.Read;const gt=w_(Ne,{ignoreShared:!0});return o.jsxs("button",{type:"button",onClick:Lt=>B(Lt,Ne.id,T.seriesKey),style:{width:"100%",textAlign:"left",background:gt?"rgba(255,179,71,0.1)":"transparent",border:`1px solid ${Xe?"#ff69b4":ut?"#fff59d":gt?"rgba(255,179,71,0.6)":"rgba(255,182,193,0.25)"}`,color:"#ffb6c1",padding:"8px",borderRadius:"8px",marginBottom:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"8px",boxShadow:Xe?"0 0 8px rgba(255,105,180,0.5)":ut?"0 0 10px rgba(255,255,180,0.65)":gt?"0 0 10px rgba(255,179,71,0.5)":"none"},children:[o.jsx("span",{style:{flex:1,minWidth:0},children:Ne.Title||Ne.title||"Untitled"}),gt&&o.jsx("span",{style:{flexShrink:0,padding:"2px 8px",borderRadius:"999px",background:"rgba(255,179,71,0.18)",border:"1px solid rgba(255,179,71,0.6)",color:"#ffd8a1",fontSize:"11px",fontWeight:700,whiteSpace:"nowrap"},children:"Missing data"})]},Ne.id)})})]},T.seriesKey)}),vn.length>0&&ie.size>0&&o.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:o.jsx("button",{type:"button",style:{padding:"6px 12px",borderRadius:"999px",border:"1px solid #ffb6c1",background:"transparent",color:"#ffb6c1",cursor:"pointer"},onClick:$,children:"Clear Selection"})})]}),o.jsxs("div",{className:"dash-library-details",children:[ie.size>0&&o.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px",padding:"10px",marginBottom:"10px",border:"1px dashed rgba(255,182,193,0.45)",borderRadius:"10px",background:"rgba(255,182,193,0.08)"},children:[o.jsxs("div",{children:["Apply Amount Paid to ",ie.size," selected book",ie.size===1?"":"s"]}),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",flexWrap:"wrap"},children:[o.jsx("input",{type:"number",step:"0.01",min:"0",value:C,onChange:T=>O(T.target.value),style:{maxWidth:"140px"}}),o.jsx("button",{type:"button",className:"dash-btn primary",onClick:L,children:"Apply to Selected"})]})]}),!te&&!we&&o.jsx("div",{className:"stat-sub",style:{marginTop:6},children:"Select a series or book to edit"}),te&&!we&&Pe&&o.jsxs("div",{children:[o.jsx("div",{className:"dash-detail-title",children:Pe.displayName}),o.jsx("div",{className:"dash-detail-row",children:o.jsxs("label",{className:"inline-checkbox",children:[o.jsx("input",{ref:G,type:"checkbox",checked:k.readChecked,onChange:T=>P(F=>({...F,readChecked:T.target.checked,readIndeterminate:!1}))}),o.jsx("span",{children:"Mark series as read"})]})}),o.jsxs("div",{className:`dash-detail-row${le.publisher?" missing-row":""}`,children:[o.jsx("span",{children:"Publisher"}),o.jsx("input",{type:"text",value:k.publisher,onChange:T=>P(F=>({...F,publisher:T.target.value})),placeholder:"Set publisher for series"})]}),o.jsxs("div",{className:`dash-detail-row${le.demographic?" missing-row":""}`,children:[o.jsx("span",{children:"Demographic"}),o.jsxs("select",{value:k.demographic,onChange:T=>P(F=>({...F,demographic:T.target.value})),children:[o.jsx("option",{value:"",children:"Select Demographic"}),o.jsx("option",{value:"Shounen",children:"Shounen"}),o.jsx("option",{value:"Seinen",children:"Seinen"}),o.jsx("option",{value:"Shoujo",children:"Shoujo"}),o.jsx("option",{value:"Josei",children:"Josei"})]})]}),o.jsxs("div",{className:`dash-detail-row${le.genre?" missing-row":""}`,children:[o.jsx("span",{children:"Genre"}),o.jsx("input",{type:"text",value:k.genre,onChange:T=>P(F=>({...F,genre:T.target.value})),placeholder:"Primary genre"})]}),o.jsxs("div",{className:"dash-detail-row",children:[o.jsx("span",{children:"Sub-Genre"}),o.jsx("input",{type:"text",value:k.subGenre,onChange:T=>P(F=>({...F,subGenre:T.target.value})),placeholder:"Secondary genre / theme"})]}),!k.dateMixed&&o.jsxs("div",{className:`dash-detail-row${le.datePurchased?" missing-row":""}`,children:[o.jsx("span",{children:"Date Purchased"}),o.jsx("input",{type:"date",value:k.datePurchased,onChange:T=>P(F=>({...F,datePurchased:T.target.value}))})]}),o.jsxs("div",{className:`dash-detail-row${le.msrp?" missing-row":""}`,children:[o.jsx("span",{children:"MSRP (per book)"}),o.jsx("input",{type:"number",step:"0.01",min:"0",value:k.msrp,onChange:T=>P(F=>({...F,msrp:T.target.value})),placeholder:"0.00"})]}),o.jsxs("div",{className:"dash-detail-actions",children:[o.jsx("button",{type:"button",className:"dash-btn secondary",onClick:se,children:"Cancel"}),o.jsx("button",{type:"button",className:"dash-btn primary",onClick:q,children:"Save Series"})]})]}),we&&ke&&o.jsxs("div",{children:[o.jsx("div",{className:"dash-detail-title",children:ke.Title||ke.title||"Untitled"}),o.jsx("div",{className:"dash-detail-row",children:o.jsxs("label",{className:"inline-checkbox",children:[o.jsx("input",{type:"checkbox",checked:!!ve.read,onChange:T=>Ge(F=>({...F,read:T.target.checked,dateRead:T.target.checked?F.dateRead||new Date().toISOString().slice(0,10):"",rating:T.target.checked?F.rating:""}))}),o.jsx("span",{children:"Mark as read"})]})}),o.jsxs("div",{className:`dash-detail-row${ot.datePurchased?" missing-row":""}`,children:[o.jsx("span",{children:"Date Purchased"}),o.jsx("input",{type:"date",value:ve.datePurchased,onChange:T=>Ge(F=>({...F,datePurchased:T.target.value}))})]}),ve.read&&o.jsxs("div",{className:"dash-detail-row",children:[o.jsx("span",{children:"Date Read"}),o.jsx("input",{type:"date",value:ve.dateRead,onChange:T=>Ge(F=>({...F,dateRead:T.target.value}))})]}),o.jsxs("div",{className:`dash-detail-row${ot.pageCount?" missing-row":""}`,children:[o.jsx("span",{children:"Page Count"}),o.jsx("input",{type:"number",min:"0",step:"1",value:ve.pageCount,onChange:T=>Ge(F=>({...F,pageCount:T.target.value}))})]}),o.jsxs("div",{className:`dash-detail-row${ot.msrp?" missing-row":""}`,children:[o.jsx("span",{children:"MSRP (per book)"}),o.jsx("input",{type:"number",step:"0.01",min:"0",value:ve.msrp,onChange:T=>Ge(F=>({...F,msrp:T.target.value})),placeholder:"0.00"})]}),!(ve.special&&ve.specialType==="collectible")&&o.jsxs("div",{className:`dash-detail-row${ot.amountPaid?" missing-row":""}`,children:[o.jsx("span",{children:"Amount Paid"}),o.jsx("input",{type:"number",step:"0.01",min:"0",value:ve.amountPaid,onChange:T=>Ge(F=>({...F,amountPaid:T.target.value})),placeholder:"0.00"})]}),ve.read&&o.jsxs("div",{className:"dash-detail-row",children:[o.jsx("span",{children:"Star Rating"}),o.jsx("input",{type:"number",min:"0",max:"5",step:"0.5",value:ve.rating,onChange:T=>Ge(F=>({...F,rating:T.target.value})),placeholder:"0-5"})]}),o.jsx("div",{className:`dash-detail-row${ot.specialType?" missing-row":""}`,children:o.jsxs("label",{className:"inline-checkbox",style:{width:"100%"},children:[o.jsx("input",{type:"checkbox",checked:!!ve.special,onChange:T=>Ge(F=>({...F,special:T.target.checked,specialType:T.target.checked?F.specialType:"",specialVolumes:T.target.checked?F.specialVolumes:"",collectiblePrice:T.target.checked?F.collectiblePrice:""}))}),o.jsx("span",{children:"Special?"})]})}),ve.special&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:`dash-detail-row${ot.specialType?" missing-row":""}`,children:[o.jsx("span",{children:"Special Type"}),o.jsxs("select",{value:ve.specialType,onChange:T=>Ge(F=>({...F,specialType:T.target.value,specialVolumes:T.target.value==="specialEdition"?F.specialVolumes:"",collectiblePrice:T.target.value==="collectible"?F.collectiblePrice:""})),children:[o.jsx("option",{value:"",children:"Select type"}),o.jsx("option",{value:"specialEdition",children:"Special Edition"}),o.jsx("option",{value:"collectible",children:"Collectible"})]})]}),ve.specialType==="specialEdition"&&o.jsxs("div",{className:`dash-detail-row${ot.specialVolumes?" missing-row":""}`,children:[o.jsx("span",{children:"Volumes Contained"}),o.jsx("input",{type:"number",min:"1",step:"1",value:ve.specialVolumes,onChange:T=>Ge(F=>({...F,specialVolumes:T.target.value}))})]}),ve.specialType==="collectible"&&o.jsxs("div",{className:`dash-detail-row${ot.collectiblePrice?" missing-row":""}`,children:[o.jsx("span",{children:"Collectible Price"}),o.jsx("input",{type:"number",min:"0",step:"0.01",value:ve.collectiblePrice,onChange:T=>Ge(F=>({...F,collectiblePrice:T.target.value})),placeholder:"0.00"})]})]}),o.jsxs("div",{className:"dash-detail-actions",children:[o.jsx("button",{type:"button",className:"dash-btn secondary",onClick:Ce,children:"Cancel"}),o.jsx("button",{type:"button",className:"dash-btn primary",onClick:oe,children:"Save Changes"})]})]})]})]}):o.jsx("div",{className:"stat-sub",children:"No library items."})]})]})}),Ot&&o.jsx("div",{id:"calendarOverlay",onClick:T=>{T.target===T.currentTarget&&Rt()},children:o.jsxs("div",{id:"calendarCard",onClick:T=>T.stopPropagation(),children:[o.jsxs("div",{className:"calendar-header",children:[o.jsx("div",{className:"calendar-title",children:new Date(On.year,On.month).toLocaleString(void 0,{month:"long",year:"numeric"})}),o.jsxs("div",{className:"calendar-nav",children:[o.jsx("button",{className:"calendar-nav-btn",onClick:()=>os(-1),type:"button",children:"<"}),o.jsx("button",{className:"calendar-nav-btn",onClick:()=>os(1),type:"button",children:">"})]})]}),o.jsxs("div",{className:"calendar-weekdays",children:[o.jsx("div",{children:"Sun"}),o.jsx("div",{children:"Mon"}),o.jsx("div",{children:"Tue"}),o.jsx("div",{children:"Wed"}),o.jsx("div",{children:"Thu"}),o.jsx("div",{children:"Fri"}),o.jsx("div",{children:"Sat"})]}),o.jsxs("div",{className:"calendar-grid",children:[ss.cells.map((T,F)=>{if(T.type==="pad")return o.jsx("div",{className:"calendar-day pad"},`pad-${F}`);const{day:Q,dateKey:ue,items:Te,isToday:qe}=T;return o.jsxs("div",{className:"calendar-day"+(Te.length?" has-releases":"")+(qe?" today":""),onClick:()=>{Te.length&&Fn({date:ue,items:Te})},role:"button",tabIndex:0,onKeyDown:Ne=>{if(Ne.key==="Enter"||Ne.key===" "){if(Ne.preventDefault(),!Te.length)return;Fn({date:ue,items:Te})}},children:[o.jsx("div",{className:"day-num",children:Q}),o.jsxs("div",{className:"calendar-releases",children:[Te.slice(0,2).map(Ne=>o.jsx("div",{className:"calendar-release purchased",children:Ne.title||"Untitled"},Ne.id)),Te.length>2&&o.jsxs("div",{className:"calendar-release more",children:["+",Te.length-2," more"]})]})]},ue)}),!ss.hasItems&&o.jsx("div",{className:"calendar-empty",children:"No purchases for this month."})]}),o.jsx("button",{id:"calendarClose",onClick:Rt,type:"button",children:"x"})]})}),In&&o.jsx("div",{className:"purchase-overlay",onClick:T=>{T.target===T.currentTarget&&Fn(null)},children:o.jsxs("div",{className:"purchase-day-modal",onClick:T=>T.stopPropagation(),children:[o.jsxs("div",{className:"purchase-day-header",children:[o.jsx("div",{className:"purchase-day-title",children:new Date(In.date).toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"})}),o.jsx("button",{className:"manga-btn secondary",onClick:()=>Fn(null),type:"button",children:"x"})]}),o.jsx("div",{className:"purchase-day-list",children:In.items.map(T=>o.jsx("div",{className:"purchase-day-item",children:T.title||"Untitled"},T.id))})]})}),en&&o.jsx("div",{id:"calendarOverlay",onClick:()=>mn(!1),style:{zIndex:10060},children:o.jsxs("div",{id:"calendarCard",onClick:T=>T.stopPropagation(),children:[o.jsxs("div",{className:"calendar-header",children:[o.jsx("div",{className:"calendar-title",children:ln.toLocaleString(void 0,{month:"long",year:"numeric"})}),o.jsxs("div",{className:"calendar-nav",children:[o.jsx("button",{className:"calendar-nav-btn",onClick:()=>ls(-1),type:"button",children:"<"}),o.jsx("button",{className:"calendar-nav-btn",onClick:()=>ls(1),type:"button",children:">"})]})]}),o.jsxs("div",{className:"calendar-weekdays",children:[o.jsx("div",{children:"Sun"}),o.jsx("div",{children:"Mon"}),o.jsx("div",{children:"Tue"}),o.jsx("div",{children:"Wed"}),o.jsx("div",{children:"Thu"}),o.jsx("div",{children:"Fri"}),o.jsx("div",{children:"Sat"})]}),o.jsx("div",{className:"calendar-grid",children:qs.map((T,F)=>{var Q;return T.type==="pad"?o.jsx("div",{className:"calendar-day pad"},F):o.jsxs("div",{className:"calendar-day"+(T.isToday?" today":"")+((Q=T.releases)!=null&&Q.length?" has-releases":""),onClick:()=>{var Te;if(!((Te=T.releases)!=null&&Te.length))return;const ue=new Date(ln.getFullYear(),ln.getMonth(),T.day);Kn({dateLabel:ue.toLocaleDateString(void 0,{month:"long",day:"numeric",year:"numeric"}),releases:T.releases})},role:"button",tabIndex:0,onKeyDown:ue=>{var Te;if(ue.key==="Enter"||ue.key===" "){if(ue.preventDefault(),!((Te=T.releases)!=null&&Te.length))return;const qe=new Date(ln.getFullYear(),ln.getMonth(),T.day);Kn({dateLabel:qe.toLocaleDateString(void 0,{month:"long",day:"numeric",year:"numeric"}),releases:T.releases})}},children:[o.jsx("div",{className:"day-num",children:T.day}),o.jsxs("div",{className:"calendar-releases",children:[(T.releases||[]).slice(0,2).map((ue,Te)=>o.jsx("div",{className:"calendar-release purchased",title:ue.title,children:ue.title},Te)),(T.releases||[]).length>2&&o.jsxs("div",{className:"calendar-release more",children:["+",(T.releases||[]).length-2," more"]})]})]},T.dateKey||F)})}),!Nr.length&&o.jsx("div",{className:"calendar-empty",children:"No reads recorded yet."}),o.jsx("button",{id:"calendarClose",onClick:()=>mn(!1),type:"button",children:"x"})]})}),tn&&o.jsx("div",{id:"calendarOverlay",onClick:()=>Kn(null),style:{zIndex:10080},children:o.jsxs("div",{id:"calendarCard",onClick:T=>T.stopPropagation(),style:{maxWidth:"520px"},children:[o.jsxs("div",{className:"calendar-header",children:[o.jsx("div",{className:"calendar-title",children:tn.dateLabel}),o.jsx("button",{className:"calendar-close-btn",onClick:()=>Kn(null),type:"button",children:"x"})]}),o.jsx("div",{className:"calendar-releases",children:tn.releases.map((T,F)=>o.jsx("div",{className:"calendar-release purchased",title:T.title,children:T.title},F))})]})}),_t&&o.jsx("div",{id:"calendarOverlay",onClick:()=>Nt(!1),children:o.jsxs("div",{id:"calendarCard",onClick:T=>T.stopPropagation(),children:[o.jsxs("div",{className:"calendar-header",children:[o.jsx("div",{className:"calendar-title",children:xt.toLocaleString(void 0,{month:"long",year:"numeric"})}),o.jsxs("div",{className:"calendar-nav",children:[o.jsx("button",{className:"calendar-nav-btn",onClick:()=>Ct(new Date(xt.getFullYear(),xt.getMonth()-1,1)),children:"<"}),o.jsx("button",{className:"calendar-nav-btn",onClick:()=>Ct(new Date(xt.getFullYear(),xt.getMonth()+1,1)),children:">"})]})]}),o.jsxs("div",{className:"calendar-weekdays",children:[o.jsx("div",{children:"Sun"}),o.jsx("div",{children:"Mon"}),o.jsx("div",{children:"Tue"}),o.jsx("div",{children:"Wed"}),o.jsx("div",{children:"Thu"}),o.jsx("div",{children:"Fri"}),o.jsx("div",{children:"Sat"})]}),o.jsx("div",{className:"calendar-grid",id:"releaseCalendar",children:as.map((T,F)=>T.type==="pad"?o.jsx("div",{className:"calendar-day pad"},F):o.jsxs("div",{className:"calendar-day"+(T.isToday?" today":""),children:[o.jsx("div",{className:"day-num",children:T.day}),o.jsxs("div",{className:"calendar-releases",children:[(Je===T.dateKey?T.releases:T.releases.slice(0,2)).map((Q,ue)=>o.jsx("div",{className:"calendar-release"+(Q.purchased?" purchased":""),title:Q.title,children:Q.title},ue)),T.releases.length>2&&o.jsxs("button",{className:"calendar-more-btn",onClick:()=>{const Q=new Date(xt.getFullYear(),xt.getMonth(),T.day);he({dateLabel:Q.toLocaleDateString(void 0,{month:"long",day:"numeric",year:"numeric"}),releases:T.releases})},children:["+",T.releases.length-2," more"]})]})]},F))}),!rt.length&&o.jsx("div",{className:"calendar-empty",children:"No wishlist releases found."}),o.jsx("button",{id:"calendarClose",onClick:()=>Nt(!1),children:"x"})]})}),Qt.open&&o.jsx("div",{id:"statDetailOverlay",onClick:Yt,children:o.jsxs("div",{id:"statDetailCard",onClick:T=>T.stopPropagation(),children:[o.jsx("button",{id:"statDetailClose",onClick:Yt,children:"x"}),o.jsxs("h2",{id:"statDetailTitle",children:[Qt.type==="publishers"&&"Top Publishers",Qt.type==="genres"&&"Top Genres",Qt.type==="demographics"&&"Top Demographics",Qt.type==="timeToRead"&&"Avg Time From Purchase to Read",Qt.type==="collectionValue"&&"Collection Value",Qt.type==="pages"&&"Pages Read vs Total",Qt.type==="ratings"&&"Ratings",Qt.type==="releases"&&"Library & Wishlist Releases"]}),o.jsx("div",{id:"statDetailBody",children:Ps()})]})}),Be&&o.jsx("div",{id:"calendarOverlay",onClick:()=>he(null),style:{zIndex:10080},children:o.jsxs("div",{id:"calendarCard",onClick:T=>T.stopPropagation(),style:{maxWidth:"520px"},children:[o.jsxs("div",{className:"calendar-header",children:[o.jsx("div",{className:"calendar-title",children:Be.dateLabel}),o.jsx("button",{className:"calendar-close-btn",onClick:()=>he(null),type:"button",children:"x"})]}),o.jsx("div",{className:"calendar-releases",children:Be.releases.map((T,F)=>o.jsx("div",{className:"calendar-release"+(T.purchased?" purchased":""),title:T.title,children:T.title},F))})]})}),e&&re&&o.jsx("div",{className:"dashboard-modal-backdrop visible",onClick:T=>{T.target===T.currentTarget&&Ie(!1)},children:o.jsxs("div",{className:"dashboard-modal",children:[o.jsxs("div",{className:"dashboard-modal-header",children:[o.jsx("h3",{children:"Webhook Settings"}),o.jsx("button",{className:"dashboard-close",onClick:()=>Ie(!1),type:"button",children:"X"})]}),o.jsxs("div",{className:"dashboard-modal-body",children:[o.jsxs("label",{className:"dashboard-input",children:[o.jsx("span",{children:"Yearly summary webhook"}),o.jsx("input",{type:"text",value:M.yearly,onChange:T=>Y(F=>({...F,yearly:T.target.value}))})]}),o.jsxs("label",{className:"dashboard-input",children:[o.jsx("span",{children:"Release timer webhook"}),o.jsx("input",{type:"text",value:M.release,onChange:T=>Y(F=>({...F,release:T.target.value}))})]}),o.jsxs("label",{className:"dashboard-input",children:[o.jsx("span",{children:"Activity webhook"}),o.jsx("input",{type:"text",value:M.activity,onChange:T=>Y(F=>({...F,activity:T.target.value}))})]}),o.jsxs("div",{className:"dashboard-input",style:{borderTop:"1px solid rgba(255,182,193,0.2)",paddingTop:8},children:[o.jsx("span",{children:"User roles"}),o.jsx("div",{style:{marginTop:8,fontSize:"0.85rem",color:"var(--text-soft)"},children:A?o.jsx("span",{children:"Loading users"}):xe.length===0?o.jsx("span",{children:"No users found."}):o.jsx("ul",{style:{listStyle:"none",margin:"6px 0 0",padding:0,display:"flex",gap:6,flexDirection:"column"},children:xe.map(T=>o.jsxs("li",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:8,background:"rgba(24,5,18,0.7)",border:"1px solid rgba(255,182,193,0.18)",borderRadius:10,padding:"6px 8px",flexWrap:"wrap"},children:[o.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:2},children:[o.jsx("strong",{children:T.displayName||T.email||T.uid}),o.jsx("span",{style:{fontSize:"0.85rem",opacity:.8},children:T.email||T.uid})]}),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[o.jsx("span",{className:"role-pill",children:T.role||"viewer"}),T.role==="admin"?o.jsx("button",{className:"dashboard-close",type:"button",onClick:()=>Ye(T.uid,"viewer"),style:{padding:"4px 10px"},children:"Make viewer"}):o.jsx("button",{className:"stat-link",type:"button",onClick:()=>Ye(T.uid,"admin"),style:{padding:"4px 10px"},children:"Make admin"})]})]},T.uid))})})]})]}),o.jsxs("div",{className:"dashboard-modal-footer",children:[o.jsx("button",{className:"stat-link",type:"button",onClick:async()=>{try{await ci(Dt(at,"settings","webhooks"),{yearly:M.yearly||Cl,release:M.release||Pl,activity:M.activity||Ca}),Ie(!1)}catch(T){console.error("Failed to save webhooks",T),alert("Failed to save webhooks.")}},children:"Save"}),o.jsx("button",{className:"stat-link danger",type:"button",onClick:()=>Ie(!1),children:"Cancel"})]})]})})]})}function OR(){const[n,e]=R.useState(!0),[t,s]=R.useState(""),[a,c]=R.useState(0),[d,f]=R.useState([]),[m,v]=R.useState(0),x=R.useRef(null);R.useEffect(()=>{document.title="Music | im.ok"},[]),R.useEffect(()=>{let ge=!1;async function ie(){e(!0),s("");try{const Ee=await fetch("https://music-api-worker.imokissick.workers.dev/music");if(!Ee.ok)throw new Error("Worker fetch failed");const D=await Ee.json();if(ge)return;const N=Array.isArray(D.combined)?D.combined:[],C=Array.isArray(D.spotify)?D.spotify:[],O=Array.isArray(D.soundcloud)?D.soundcloud:[],k=[...N,...C,...O].reduce((P,ve)=>{const Ge=(ve.title||"").toLowerCase().trim();if(!Ge)return P;const Re=P.findIndex(ce=>(ce.title||"").toLowerCase().trim()===Ge);return Re>=0?(P[Re].source!=="spotify"&&ve.source==="spotify"&&(P[Re]=ve),P):(P.push(ve),P)},[]).map(P=>({...P,releaseDate:P.releaseDate?new Date(P.releaseDate):new Date}));f(k)}catch(Ee){console.error(Ee),ge||s("Failed to load music feeds.")}finally{ge||e(!1)}}return ie(),()=>{ge=!0}},[]);const S=Math.min(4,Math.max(1,d.length)),b=S?Math.ceil(d.length/S):0,M=()=>{x.current&&clearInterval(x.current),d.length&&(v(ge=>ge+1),x.current=setInterval(()=>{c(ge=>(Math.floor(ge/S)+1)%b*S%d.length),v(ge=>ge+1)},15e3))};R.useEffect(()=>{if(d.length)return M(),()=>{x.current&&clearInterval(x.current)}},[d,S]);const Y=ge=>{d.length&&(c(ie=>(Math.floor(ie/S)+ge+b)%b*S%d.length),M())},z=ge=>{d.length&&(c(ge*S%d.length),M())},V=ge=>ie=>{ie.preventDefault();const D=ge.source==="spotify"?`spotify:album:${ge.id}`:ge.url,N=ge.url;try{const C=setTimeout(()=>{window.open(N,"_blank","noopener,noreferrer")},600);window.location.href=D,setTimeout(()=>clearTimeout(C),800)}catch{window.open(N,"_blank","noopener,noreferrer")}},te=d[0],be=ge=>ge?{backgroundImage:`url(${ge})`,backgroundSize:"cover",backgroundPosition:"center"}:{},we=te?te.source==="spotify"?"Spotify":"SoundCloud":"";return o.jsxs("main",{className:"page music-page",children:[o.jsxs("header",{className:"music-hero",children:[o.jsxs("div",{className:"music-hero-content",children:[o.jsx("p",{className:"music-pill",children:"im.ok  Artist"}),o.jsx("h1",{children:te?te.title:"Latest & Greatest"}),o.jsx("p",{className:"music-sub",children:"Check out my latest song. I know it's been almost a whole year since I've released. I have been on a much needed hiatus. I felt the whole world crumbling around me and had no time to breathe so this is why I took a break. Here's to 2026!"}),te&&o.jsx("div",{className:"music-badges",children:o.jsx("span",{children:we})})]}),o.jsx("div",{className:"music-hero-embed",children:o.jsxs("div",{className:"music-hero-art",style:be(te==null?void 0:te.artwork),children:[!(te!=null&&te.artwork)&&o.jsx("div",{className:"music-hero-art-fallback",children:"Artwork"}),te&&o.jsx("button",{className:"music-link music-play hero-play","aria-label":`Play ${te.title}`,onClick:V(te)})]})})]}),o.jsxs("section",{className:"music-section",children:[o.jsx("div",{className:"music-section-header",children:o.jsx("h2",{children:"Releases"})}),t&&o.jsx("div",{className:"music-error",children:t}),n&&o.jsx("div",{className:"music-loading",children:"Loading music feeds..."}),!n&&d.length===0&&o.jsx("div",{className:"music-empty",children:"Connect Spotify/SoundCloud tokens to see live releases."}),!n&&d.length>0&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"music-carousel-wrap",children:[o.jsx("button",{className:"music-nav left",onClick:()=>Y(-1),"aria-label":"Previous releases",children:""}),o.jsx("div",{className:"music-carousel",children:Array.from({length:S}).map((ge,ie)=>{const Ee=d[(a+ie)%d.length];return Ee?o.jsxs("div",{className:"music-card",children:[o.jsx("div",{className:"music-card-art",style:be(Ee.artwork)}),o.jsxs("div",{className:"music-card-body",children:[o.jsx("div",{className:"music-card-title",children:Ee.title}),o.jsx("div",{className:"music-card-actions",children:o.jsx("button",{className:"music-link music-play","aria-label":`Play ${Ee.title}`,onClick:V(Ee)})})]})]},`${Ee.id}-${ie}`):null})}),o.jsx("button",{className:"music-nav right",onClick:()=>Y(1),"aria-label":"Next releases",children:""})]}),o.jsx("div",{className:"music-dots",children:Array.from({length:b}).map((ge,ie)=>{const Ee=Math.floor(a/S)===ie,D=Ee?`${ie}-${m}`:`${ie}-idle`;return o.jsx("button",{className:`dot ${Ee?"active":""}`,onClick:()=>z(ie),"aria-label":`Go to set ${ie+1}`,children:o.jsx("span",{className:"dot-fill"},D)},ie)})})]})]}),o.jsxs("div",{className:"music-feeds-row",children:[o.jsxs("section",{className:"music-section",children:[o.jsx("div",{className:"music-section-header",children:o.jsx("h2",{children:"Spotify"})}),o.jsx("div",{className:"music-embed-card",children:o.jsx("iframe",{title:"Spotify Artist",src:"https://open.spotify.com/embed/artist/00sbWLxYLDs8i5BLQL9Qdo?utm_source=generator&theme=0",width:"100%",height:"400",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy"})})]}),o.jsxs("section",{className:"music-section",children:[o.jsx("div",{className:"music-section-header",children:o.jsx("h2",{children:"SoundCloud"})}),o.jsx("div",{className:"music-embed-card",children:o.jsx("iframe",{title:"SoundCloud Player",width:"100%",height:"400",scrolling:"no",frameBorder:"no",allow:"autoplay",src:"https://w.soundcloud.com/player/?url=https%3A//soundcloud.com/imxk&color=%23ff69b4&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true&visual=true"})})]})]})]})}function FR(){const n=tc(),{user:e}=za(),t=async a=>{if(!(a!=null&&a.uid))return;const c=Dt(at,"users",a.uid);try{const d=await Pd(c),f=d.exists()?d.data():null,m=(f==null?void 0:f.role)||"viewer";await ci(c,{role:m,email:a.email||(f==null?void 0:f.email)||"",displayName:a.displayName||(f==null?void 0:f.displayName)||"",createdAt:(f==null?void 0:f.createdAt)||ka()},{merge:!0})}catch(d){console.warn("Failed to upsert user doc",d)}};R.useEffect(()=>{e!=null&&e.uid&&t(e).finally(()=>n("/"))},[e,n]);async function s(){try{const a=new ys,c=await A0(Jr,a);await t(c.user),n("/")}catch(a){console.error(a),alert("Google Sign-In failed.")}}return o.jsx("div",{className:"signin-page",children:o.jsxs("div",{className:"signin-card",children:[o.jsx("h2",{className:"signin-title",children:"Welcome Back"}),o.jsx("p",{className:"signin-sub",children:"Sign in to access the dashboard & edit collections."}),o.jsxs("button",{className:"google-btn",onClick:s,children:[o.jsx("img",{src:"https://www.svgrepo.com/show/475656/google-color.svg",alt:"",className:"google-icon"}),"Continue with Google"]}),o.jsxs("button",{className:"signin-cancel",onClick:()=>n("/"),children:["<"," Back to Home"]})]})})}const UR=R.lazy(()=>pc(()=>import("./SteamCard-Cc7MCPcW.js"),[])),zR=R.lazy(()=>pc(()=>import("./SteamRecents-CPNLKQw3.js"),[])),BR=R.lazy(()=>pc(()=>import("./SteamGames-CqiH47T3.js"),[]));function $R(){return R.useEffect(()=>{document.title="Tyler's Gaming Lounge"},[]),o.jsxs("div",{className:"steam-page page",children:[o.jsxs("header",{style:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",gap:"6px"},children:[o.jsx("h1",{style:{margin:0,fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Tyler's Gaming Lounge"}),o.jsx("p",{style:{margin:"6px 0 0",color:"var(--text-soft)",fontSize:"0.9rem"},children:"This will be the home to all of my gaming collections, this is still being worked on, but thought it was cool with just steam for now."})]}),o.jsx(yf,{minHeight:260,children:o.jsx(R.Suspense,{fallback:o.jsx(Du,{label:"Profile"}),children:o.jsx(UR,{})})}),o.jsx(yf,{minHeight:240,children:o.jsx(R.Suspense,{fallback:o.jsx(Du,{label:"Recently played"}),children:o.jsx(zR,{})})}),o.jsx(yf,{minHeight:400,children:o.jsx(R.Suspense,{fallback:o.jsx(Du,{label:"Library & Achievements"}),children:o.jsx(BR,{})})})]})}function yf({children:n,minHeight:e=200}){const[t,s]=R.useState(!1),a=R.useRef(null);R.useEffect(()=>{const d=new IntersectionObserver(f=>{f[0].isIntersecting&&(s(!0),d.disconnect())},{rootMargin:"200px 0px"});return a.current&&d.observe(a.current),()=>d.disconnect()},[]);const c=t?void 0:{minHeight:e};return o.jsx("div",{ref:a,style:c,children:t?n:o.jsx(Du,{})})}function Du({label:n="Loading section"}){return o.jsxs("div",{className:"steam-skeleton",children:[o.jsx("div",{className:"steam-skeleton-bar"}),o.jsx("div",{className:"steam-skeleton-bar short"}),o.jsx("p",{className:"steam-skeleton-label",children:n})]})}const vf={id:null,title:"",summary:"",body:"",cover:"",tags:"",status:"draft",publishedAt:null};function Lu(n){return n?n instanceof Date?n:n!=null&&n.toDate?n.toDate():null:null}function Tu(n){const e=Lu(n);return e?e.toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"}):""}function WR(n=[]){return Array.isArray(n)?n.join(", "):""}function GR(n){return(n||"").split(",").map(e=>e.trim()).filter(Boolean)}function qR(){var Re;const{admin:n,user:e,loading:t}=za(),[s,a]=kT(),[c,d]=R.useState([]),[f,m]=R.useState(!0),[v,x]=R.useState(!1),[S,b]=R.useState(!1),[M,Y]=R.useState(""),[z,V]=R.useState(vf),[te,be]=R.useState(null),we=R.useMemo(()=>c.filter(ce=>ce.status==="published"),[c]),ge=R.useMemo(()=>n?c:we,[n,c,we]),ie=R.useMemo(()=>ge.find(ce=>ce.id===te)||null,[te,ge]);R.useEffect(()=>{document.title="Blog | Reviews"},[]),R.useEffect(()=>{t||N()},[n,t]),R.useEffect(()=>{const ce=s.get("post");ce&&be(ce)},[s]),R.useEffect(()=>{var xe;if(f)return;const re=s.get("post")||te,Ie=re&&ge.some(K=>K.id===re)?re:((xe=ge[0])==null?void 0:xe.id)||null;C(Ie,{list:ge})},[f,ge]);const Ee=!n&&!f&&we.length===0;function D(ce){return{id:ce.id,title:ce.title||"",summary:ce.summary||"",body:ce.body||"",cover:ce.cover||"",tags:WR(ce.tags),status:ce.status||"draft",publishedAt:ce.publishedAt||null}}async function N(ce=null){var re;if(!t){m(!0),Y("");try{const Ie=Sn(at,"blogPosts"),xe=n?Yf(Ie,Jf("updatedAt","desc")):Yf(Ie,aw("status","==","published"),Jf("publishedAt","desc")),A=(await vs(xe)).docs.map(De=>{const je=De.data();return{id:De.id,...je,createdAt:Lu(je.createdAt),updatedAt:Lu(je.updatedAt),publishedAt:Lu(je.publishedAt),tags:Array.isArray(je.tags)?je.tags:[]}});d(A);const W=n?A:A.filter(De=>De.status==="published"),ye=ce||s.get("post")||(W.length?W[0].id:null);ye&&W.some(De=>De.id===ye)?C(ye,{list:W}):C(((re=W[0])==null?void 0:re.id)||null,{list:W})}catch(Ie){console.error("Failed to load blog posts",Ie);const xe=(Ie==null?void 0:Ie.code)==="permission-denied";Y(xe?"You do not have permission to view these posts. Make sure you are signed in with an admin account.":"Failed to load posts. Try again shortly.")}finally{m(!1)}}}function C(ce,{list:re}={}){be(ce||null),a(ce?{post:ce}:{});const Ie=re||c;if(n){const xe=Ie.find(K=>K.id===ce);V(xe?D(xe):vf)}}function O(ce){C(ce),window.scrollTo({top:0,behavior:"smooth"})}function G(){V(vf),be(null),a({})}function k(ce){const re=ce||z.status||"draft",Ie=re==="published"?z.publishedAt||ka():null;return{title:z.title.trim(),summary:z.summary.trim(),body:z.body.trim(),cover:z.cover.trim(),tags:GR(z.tags),status:re,publishedAt:Ie,updatedAt:ka()}}async function P(ce="draft"){if(!(!n||v)){if(!z.title.trim()||!z.body.trim()){Y("Title and body are required.");return}x(!0),Y("");try{const re=k(ce);let Ie=z.id;z.id?await _s(Dt(at,"blogPosts",z.id),re):Ie=(await Ra(Sn(at,"blogPosts"),{...re,createdAt:ka()})).id,Y(ce==="published"?"Post published and visible to everyone.":"Draft saved."),await N(Ie)}catch(re){console.error("Failed to save blog post",re),Y("Could not save the post. Try again.")}finally{x(!1)}}}async function ve(ce){if(!(!n||!ce||S||!window.confirm("Delete this post? This cannot be undone."))){b(!0),Y("");try{await Na(Dt(at,"blogPosts",ce)),Y("Post deleted."),await N(),G()}catch(Ie){console.error("Failed to delete post",Ie),Y("Could not delete the post.")}finally{b(!1)}}}const Ge=((ie==null?void 0:ie.body)||"").split(/\n{2,}/).map((ce,re)=>o.jsx("p",{className:"blog-body-paragraph",children:ce},re));return t?o.jsx("div",{className:"page blog-page",children:o.jsx("div",{className:"blog-guard-card",children:"Checking access..."})}):e?n?o.jsxs("div",{className:"page blog-page",children:[o.jsxs("header",{className:"blog-hero",children:[o.jsx("div",{className:"blog-pill",children:n?"Admin workspace":"Latest updates"}),o.jsx("h1",{children:"Blog & Reviews"}),o.jsx("p",{children:"Share reviews for anime or manga you have read. Draft privately, publish when ready, and keep visitors in the loop with new releases."})]}),M&&o.jsx("div",{className:"blog-status",children:M}),o.jsxs("div",{className:"blog-shell",children:[o.jsxs("aside",{className:"blog-sidebar",children:[o.jsxs("div",{className:"blog-sidebar-header",children:[o.jsxs("div",{children:[o.jsx("div",{className:"blog-sidebar-label",children:"Posts"}),o.jsxs("div",{className:"blog-sidebar-count",children:[ge.length," ",ge.length===1?"entry":"entries"]})]}),n&&o.jsx("button",{type:"button",className:"blog-btn solid",onClick:G,children:"+ New draft"})]}),o.jsxs("div",{className:"blog-list",children:[f&&o.jsx("div",{className:"blog-muted",children:"Loading posts..."}),!f&&!ge.length&&o.jsx("div",{className:"blog-muted",children:"No posts yet."}),ge.map(ce=>o.jsxs("button",{className:"blog-list-item"+(te===ce.id?" active":""),onClick:()=>O(ce.id),children:[o.jsxs("div",{className:"blog-list-row",children:[o.jsx("span",{className:"blog-list-title",children:ce.title||"Untitled"}),o.jsx("span",{className:"blog-chip "+(ce.status==="published"?"success":"draft"),children:ce.status==="published"?"Published":"Draft"})]}),o.jsx("div",{className:"blog-list-sub",children:ce.status==="published"?`Published ${Tu(ce.publishedAt)}`:`Last touched ${Tu(ce.updatedAt)}`})]},ce.id))]})]}),o.jsxs("section",{className:"blog-main",children:[Ee?o.jsxs("div",{className:"blog-guard-card",children:[o.jsx("h3",{children:"Under construction"}),o.jsx("p",{children:"This blog page is being built. Once posts are published, they will appear here. Admins can already create and publish posts."})]}):ie?o.jsxs("article",{className:"blog-article",children:[o.jsxs("div",{className:"blog-article-meta",children:[o.jsx("span",{className:"blog-chip "+(ie.status==="published"?"success":"draft"),children:ie.status==="published"?"Published":"Draft"}),o.jsx("span",{className:"blog-meta-text",children:ie.status==="published"?`Published ${Tu(ie.publishedAt)}`:`Last saved ${Tu(ie.updatedAt)}`})]}),o.jsx("h2",{className:"blog-article-title",children:ie.title||"Untitled"}),ie.summary&&o.jsx("p",{className:"blog-article-summary",children:ie.summary}),ie.cover&&o.jsx("div",{className:"blog-cover",children:o.jsx("img",{src:ie.cover,alt:""})}),o.jsx("div",{className:"blog-body",children:Ge}),(Re=ie.tags)!=null&&Re.length?o.jsx("div",{className:"blog-tag-row",children:ie.tags.map(ce=>o.jsx("span",{className:"blog-chip ghost",children:ce},ce))}):null]}):o.jsxs("div",{className:"blog-guard-card",children:[o.jsx("h3",{children:"No post selected"}),o.jsx("p",{children:"Select a post from the left to read it."})]}),n&&o.jsxs("div",{className:"blog-editor-card",children:[o.jsxs("div",{className:"blog-editor-header",children:[o.jsxs("div",{children:[o.jsx("div",{className:"blog-sidebar-label",children:z.id?"Edit post":"New draft"}),o.jsx("div",{className:"blog-sidebar-count",children:z.id?"Update and publish when ready":"Fill in the details to create"})]}),z.id&&o.jsx("button",{type:"button",className:"blog-btn danger",onClick:()=>ve(z.id),disabled:S,children:S?"Deleting...":"Delete"})]}),o.jsxs("div",{className:"blog-form",children:[o.jsxs("label",{className:"blog-field",children:[o.jsx("span",{children:"Title"}),o.jsx("input",{type:"text",value:z.title,onChange:ce=>V(re=>({...re,title:ce.target.value})),placeholder:"e.g., Chainsaw Man Volume 14 Review"})]}),o.jsxs("label",{className:"blog-field",children:[o.jsx("span",{children:"Summary"}),o.jsx("input",{type:"text",value:z.summary,onChange:ce=>V(re=>({...re,summary:ce.target.value})),placeholder:"One-liner that appears in previews"})]}),o.jsxs("label",{className:"blog-field",children:[o.jsx("span",{children:"Cover image URL (optional)"}),o.jsx("input",{type:"url",value:z.cover,onChange:ce=>V(re=>({...re,cover:ce.target.value})),placeholder:"https://..."})]}),o.jsxs("label",{className:"blog-field",children:[o.jsx("span",{children:"Tags (comma separated)"}),o.jsx("input",{type:"text",value:z.tags,onChange:ce=>V(re=>({...re,tags:ce.target.value})),placeholder:"anime, manga, review"})]}),o.jsxs("label",{className:"blog-field",children:[o.jsx("span",{children:"Body"}),o.jsx("textarea",{rows:8,value:z.body,onChange:ce=>V(re=>({...re,body:ce.target.value})),placeholder:"Write your review here. Separate paragraphs with blank lines."})]}),o.jsxs("div",{className:"blog-actions",children:[o.jsx("button",{type:"button",className:"blog-btn",onClick:()=>P("draft"),disabled:v,children:v?"Saving...":"Save draft"}),o.jsx("button",{type:"button",className:"blog-btn solid",onClick:()=>P("published"),disabled:v,children:v?"Publishing...":"Publish"}),z.status==="published"&&o.jsx("button",{type:"button",className:"blog-btn ghost",onClick:()=>P("draft"),disabled:v,children:"Move to draft"})]})]})]})]})]})]}):o.jsx(xf,{to:"/home",replace:!0}):o.jsx(xf,{to:"/signin",replace:!0})}function HR(){return o.jsxs(qN,{children:[o.jsx(KN,{}),o.jsxs(wT,{children:[o.jsx(Qr,{path:"/",element:o.jsx(l_,{})}),o.jsx(Qr,{path:"/home",element:o.jsx(l_,{})}),o.jsx(Qr,{path:"/manga",element:o.jsx(aR,{})}),o.jsx(Qr,{path:"/anime",element:o.jsx(yR,{})}),o.jsx(Qr,{path:"/tcg",element:o.jsx(_R,{})}),o.jsx(Qr,{path:"/music",element:o.jsx(OR,{})}),o.jsx(Qr,{path:"/blog",element:o.jsx(qR,{})}),o.jsx(Qr,{path:"/dashboard",element:o.jsx(MR,{})}),o.jsx(Qr,{path:"/signin",element:o.jsx(FR,{})}),o.jsx(Qr,{path:"/steam",element:o.jsx($R,{})}),o.jsx(Qr,{path:"*",element:o.jsx(xf,{to:"/home",replace:!0})})]})]})}NE.createRoot(document.getElementById("root")).render(o.jsx(Zf.StrictMode,{children:o.jsx(NT,{basename:"/base",children:o.jsx(HR,{})})}));export{o as j,R as r};
