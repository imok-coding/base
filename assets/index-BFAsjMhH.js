function SE(n,e){for(var t=0;t<e.length;t++){const s=e[t];if(typeof s!="string"&&!Array.isArray(s)){for(const a in s)if(a!=="default"&&!(a in n)){const l=Object.getOwnPropertyDescriptor(s,a);l&&Object.defineProperty(n,a,l.get?l:{enumerable:!0,get:()=>s[a]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const d of l.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&s(d)}).observe(document,{childList:!0,subtree:!0});function t(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(a){if(a.ep)return;a.ep=!0;const l=t(a);fetch(a.href,l)}})();function tp(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var ef={exports:{}},Nl={},tf={exports:{}},yt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var my;function bE(){if(my)return yt;my=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),d=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),y=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),E=Symbol.iterator;function C(Y){return Y===null||typeof Y!="object"?null:(Y=E&&Y[E]||Y["@@iterator"],typeof Y=="function"?Y:null)}var U={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},X=Object.assign,W={};function z(Y,k,H){this.props=Y,this.context=k,this.refs=W,this.updater=H||U}z.prototype.isReactComponent={},z.prototype.setState=function(Y,k){if(typeof Y!="object"&&typeof Y!="function"&&Y!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Y,k,"setState")},z.prototype.forceUpdate=function(Y){this.updater.enqueueForceUpdate(this,Y,"forceUpdate")};function se(){}se.prototype=z.prototype;function we(Y,k,H){this.props=Y,this.context=k,this.refs=W,this.updater=H||U}var _e=we.prototype=new se;_e.constructor=we,X(_e,z.prototype),_e.isPureReactComponent=!0;var ve=Array.isArray,L=Object.prototype.hasOwnProperty,ie={current:null},I={key:!0,ref:!0,__self:!0,__source:!0};function N(Y,k,H){var Te,Ve={},De=null,Oe=null;if(k!=null)for(Te in k.ref!==void 0&&(Oe=k.ref),k.key!==void 0&&(De=""+k.key),k)L.call(k,Te)&&!I.hasOwnProperty(Te)&&(Ve[Te]=k[Te]);var Qe=arguments.length-2;if(Qe===1)Ve.children=H;else if(1<Qe){for(var nt=Array(Qe),ge=0;ge<Qe;ge++)nt[ge]=arguments[ge+2];Ve.children=nt}if(Y&&Y.defaultProps)for(Te in Qe=Y.defaultProps,Qe)Ve[Te]===void 0&&(Ve[Te]=Qe[Te]);return{$$typeof:n,type:Y,key:De,ref:Oe,props:Ve,_owner:ie.current}}function A(Y,k){return{$$typeof:n,type:Y.type,key:k,ref:Y.ref,props:Y.props,_owner:Y._owner}}function O(Y){return typeof Y=="object"&&Y!==null&&Y.$$typeof===n}function D(Y){var k={"=":"=0",":":"=2"};return"$"+Y.replace(/[=:]/g,function(H){return k[H]})}var P=/\/+/g;function b(Y,k){return typeof Y=="object"&&Y!==null&&Y.key!=null?D(""+Y.key):k.toString(36)}function J(Y,k,H,Te,Ve){var De=typeof Y;(De==="undefined"||De==="boolean")&&(Y=null);var Oe=!1;if(Y===null)Oe=!0;else switch(De){case"string":case"number":Oe=!0;break;case"object":switch(Y.$$typeof){case n:case e:Oe=!0}}if(Oe)return Oe=Y,Ve=Ve(Oe),Y=Te===""?"."+b(Oe,0):Te,ve(Ve)?(H="",Y!=null&&(H=Y.replace(P,"$&/")+"/"),J(Ve,k,H,"",function(ge){return ge})):Ve!=null&&(O(Ve)&&(Ve=A(Ve,H+(!Ve.key||Oe&&Oe.key===Ve.key?"":(""+Ve.key).replace(P,"$&/")+"/")+Y)),k.push(Ve)),1;if(Oe=0,Te=Te===""?".":Te+":",ve(Y))for(var Qe=0;Qe<Y.length;Qe++){De=Y[Qe];var nt=Te+b(De,Qe);Oe+=J(De,k,H,nt,Ve)}else if(nt=C(Y),typeof nt=="function")for(Y=nt.call(Y),Qe=0;!(De=Y.next()).done;)De=De.value,nt=Te+b(De,Qe++),Oe+=J(De,k,H,nt,Ve);else if(De==="object")throw k=String(Y),Error("Objects are not valid as a React child (found: "+(k==="[object Object]"?"object with keys {"+Object.keys(Y).join(", ")+"}":k)+"). If you meant to render a collection of children, use an array instead.");return Oe}function re(Y,k,H){if(Y==null)return Y;var Te=[],Ve=0;return J(Y,Te,"","",function(De){return k.call(H,De,Ve++)}),Te}function Ie(Y){if(Y._status===-1){var k=Y._result;k=k(),k.then(function(H){(Y._status===0||Y._status===-1)&&(Y._status=1,Y._result=H)},function(H){(Y._status===0||Y._status===-1)&&(Y._status=2,Y._result=H)}),Y._status===-1&&(Y._status=0,Y._result=k)}if(Y._status===1)return Y._result.default;throw Y._result}var he={current:null},ce={transition:null},Pe={ReactCurrentDispatcher:he,ReactCurrentBatchConfig:ce,ReactCurrentOwner:ie};function xe(){throw Error("act(...) is not supported in production builds of React.")}return yt.Children={map:re,forEach:function(Y,k,H){re(Y,function(){k.apply(this,arguments)},H)},count:function(Y){var k=0;return re(Y,function(){k++}),k},toArray:function(Y){return re(Y,function(k){return k})||[]},only:function(Y){if(!O(Y))throw Error("React.Children.only expected to receive a single React element child.");return Y}},yt.Component=z,yt.Fragment=t,yt.Profiler=a,yt.PureComponent=we,yt.StrictMode=s,yt.Suspense=m,yt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Pe,yt.act=xe,yt.cloneElement=function(Y,k,H){if(Y==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+Y+".");var Te=X({},Y.props),Ve=Y.key,De=Y.ref,Oe=Y._owner;if(k!=null){if(k.ref!==void 0&&(De=k.ref,Oe=ie.current),k.key!==void 0&&(Ve=""+k.key),Y.type&&Y.type.defaultProps)var Qe=Y.type.defaultProps;for(nt in k)L.call(k,nt)&&!I.hasOwnProperty(nt)&&(Te[nt]=k[nt]===void 0&&Qe!==void 0?Qe[nt]:k[nt])}var nt=arguments.length-2;if(nt===1)Te.children=H;else if(1<nt){Qe=Array(nt);for(var ge=0;ge<nt;ge++)Qe[ge]=arguments[ge+2];Te.children=Qe}return{$$typeof:n,type:Y.type,key:Ve,ref:De,props:Te,_owner:Oe}},yt.createContext=function(Y){return Y={$$typeof:d,_currentValue:Y,_currentValue2:Y,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},Y.Provider={$$typeof:l,_context:Y},Y.Consumer=Y},yt.createElement=N,yt.createFactory=function(Y){var k=N.bind(null,Y);return k.type=Y,k},yt.createRef=function(){return{current:null}},yt.forwardRef=function(Y){return{$$typeof:f,render:Y}},yt.isValidElement=O,yt.lazy=function(Y){return{$$typeof:x,_payload:{_status:-1,_result:Y},_init:Ie}},yt.memo=function(Y,k){return{$$typeof:y,type:Y,compare:k===void 0?null:k}},yt.startTransition=function(Y){var k=ce.transition;ce.transition={};try{Y()}finally{ce.transition=k}},yt.unstable_act=xe,yt.useCallback=function(Y,k){return he.current.useCallback(Y,k)},yt.useContext=function(Y){return he.current.useContext(Y)},yt.useDebugValue=function(){},yt.useDeferredValue=function(Y){return he.current.useDeferredValue(Y)},yt.useEffect=function(Y,k){return he.current.useEffect(Y,k)},yt.useId=function(){return he.current.useId()},yt.useImperativeHandle=function(Y,k,H){return he.current.useImperativeHandle(Y,k,H)},yt.useInsertionEffect=function(Y,k){return he.current.useInsertionEffect(Y,k)},yt.useLayoutEffect=function(Y,k){return he.current.useLayoutEffect(Y,k)},yt.useMemo=function(Y,k){return he.current.useMemo(Y,k)},yt.useReducer=function(Y,k,H){return he.current.useReducer(Y,k,H)},yt.useRef=function(Y){return he.current.useRef(Y)},yt.useState=function(Y){return he.current.useState(Y)},yt.useSyncExternalStore=function(Y,k,H){return he.current.useSyncExternalStore(Y,k,H)},yt.useTransition=function(){return he.current.useTransition()},yt.version="18.3.1",yt}var gy;function np(){return gy||(gy=1,tf.exports=bE()),tf.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yy;function CE(){if(yy)return Nl;yy=1;var n=np(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,a=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function d(f,m,y){var x,E={},C=null,U=null;y!==void 0&&(C=""+y),m.key!==void 0&&(C=""+m.key),m.ref!==void 0&&(U=m.ref);for(x in m)s.call(m,x)&&!l.hasOwnProperty(x)&&(E[x]=m[x]);if(f&&f.defaultProps)for(x in m=f.defaultProps,m)E[x]===void 0&&(E[x]=m[x]);return{$$typeof:e,type:f,key:C,ref:U,props:E,_owner:a.current}}return Nl.Fragment=t,Nl.jsx=d,Nl.jsxs=d,Nl}var vy;function IE(){return vy||(vy=1,ef.exports=CE()),ef.exports}var o=IE(),j=np();const rp=tp(j),NE=SE({__proto__:null,default:rp},[j]);var vu={},nf={exports:{}},Pr={},rf={exports:{}},sf={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _y;function PE(){return _y||(_y=1,(function(n){function e(ce,Pe){var xe=ce.length;ce.push(Pe);e:for(;0<xe;){var Y=xe-1>>>1,k=ce[Y];if(0<a(k,Pe))ce[Y]=Pe,ce[xe]=k,xe=Y;else break e}}function t(ce){return ce.length===0?null:ce[0]}function s(ce){if(ce.length===0)return null;var Pe=ce[0],xe=ce.pop();if(xe!==Pe){ce[0]=xe;e:for(var Y=0,k=ce.length,H=k>>>1;Y<H;){var Te=2*(Y+1)-1,Ve=ce[Te],De=Te+1,Oe=ce[De];if(0>a(Ve,xe))De<k&&0>a(Oe,Ve)?(ce[Y]=Oe,ce[De]=xe,Y=De):(ce[Y]=Ve,ce[Te]=xe,Y=Te);else if(De<k&&0>a(Oe,xe))ce[Y]=Oe,ce[De]=xe,Y=De;else break e}}return Pe}function a(ce,Pe){var xe=ce.sortIndex-Pe.sortIndex;return xe!==0?xe:ce.id-Pe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;n.unstable_now=function(){return l.now()}}else{var d=Date,f=d.now();n.unstable_now=function(){return d.now()-f}}var m=[],y=[],x=1,E=null,C=3,U=!1,X=!1,W=!1,z=typeof setTimeout=="function"?setTimeout:null,se=typeof clearTimeout=="function"?clearTimeout:null,we=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _e(ce){for(var Pe=t(y);Pe!==null;){if(Pe.callback===null)s(y);else if(Pe.startTime<=ce)s(y),Pe.sortIndex=Pe.expirationTime,e(m,Pe);else break;Pe=t(y)}}function ve(ce){if(W=!1,_e(ce),!X)if(t(m)!==null)X=!0,Ie(L);else{var Pe=t(y);Pe!==null&&he(ve,Pe.startTime-ce)}}function L(ce,Pe){X=!1,W&&(W=!1,se(N),N=-1),U=!0;var xe=C;try{for(_e(Pe),E=t(m);E!==null&&(!(E.expirationTime>Pe)||ce&&!D());){var Y=E.callback;if(typeof Y=="function"){E.callback=null,C=E.priorityLevel;var k=Y(E.expirationTime<=Pe);Pe=n.unstable_now(),typeof k=="function"?E.callback=k:E===t(m)&&s(m),_e(Pe)}else s(m);E=t(m)}if(E!==null)var H=!0;else{var Te=t(y);Te!==null&&he(ve,Te.startTime-Pe),H=!1}return H}finally{E=null,C=xe,U=!1}}var ie=!1,I=null,N=-1,A=5,O=-1;function D(){return!(n.unstable_now()-O<A)}function P(){if(I!==null){var ce=n.unstable_now();O=ce;var Pe=!0;try{Pe=I(!0,ce)}finally{Pe?b():(ie=!1,I=null)}}else ie=!1}var b;if(typeof we=="function")b=function(){we(P)};else if(typeof MessageChannel<"u"){var J=new MessageChannel,re=J.port2;J.port1.onmessage=P,b=function(){re.postMessage(null)}}else b=function(){z(P,0)};function Ie(ce){I=ce,ie||(ie=!0,b())}function he(ce,Pe){N=z(function(){ce(n.unstable_now())},Pe)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ce){ce.callback=null},n.unstable_continueExecution=function(){X||U||(X=!0,Ie(L))},n.unstable_forceFrameRate=function(ce){0>ce||125<ce?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<ce?Math.floor(1e3/ce):5},n.unstable_getCurrentPriorityLevel=function(){return C},n.unstable_getFirstCallbackNode=function(){return t(m)},n.unstable_next=function(ce){switch(C){case 1:case 2:case 3:var Pe=3;break;default:Pe=C}var xe=C;C=Pe;try{return ce()}finally{C=xe}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(ce,Pe){switch(ce){case 1:case 2:case 3:case 4:case 5:break;default:ce=3}var xe=C;C=ce;try{return Pe()}finally{C=xe}},n.unstable_scheduleCallback=function(ce,Pe,xe){var Y=n.unstable_now();switch(typeof xe=="object"&&xe!==null?(xe=xe.delay,xe=typeof xe=="number"&&0<xe?Y+xe:Y):xe=Y,ce){case 1:var k=-1;break;case 2:k=250;break;case 5:k=1073741823;break;case 4:k=1e4;break;default:k=5e3}return k=xe+k,ce={id:x++,callback:Pe,priorityLevel:ce,startTime:xe,expirationTime:k,sortIndex:-1},xe>Y?(ce.sortIndex=xe,e(y,ce),t(m)===null&&ce===t(y)&&(W?(se(N),N=-1):W=!0,he(ve,xe-Y))):(ce.sortIndex=k,e(m,ce),X||U||(X=!0,Ie(L))),ce},n.unstable_shouldYield=D,n.unstable_wrapCallback=function(ce){var Pe=C;return function(){var xe=C;C=Pe;try{return ce.apply(this,arguments)}finally{C=xe}}}})(sf)),sf}var xy;function RE(){return xy||(xy=1,rf.exports=PE()),rf.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wy;function AE(){if(wy)return Pr;wy=1;var n=np(),e=RE();function t(r){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+r,c=1;c<arguments.length;c++)i+="&args[]="+encodeURIComponent(arguments[c]);return"Minified React error #"+r+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,a={};function l(r,i){d(r,i),d(r+"Capture",i)}function d(r,i){for(a[r]=i,r=0;r<i.length;r++)s.add(i[r])}var f=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),m=Object.prototype.hasOwnProperty,y=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,x={},E={};function C(r){return m.call(E,r)?!0:m.call(x,r)?!1:y.test(r)?E[r]=!0:(x[r]=!0,!1)}function U(r,i,c,h){if(c!==null&&c.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return h?!1:c!==null?!c.acceptsBooleans:(r=r.toLowerCase().slice(0,5),r!=="data-"&&r!=="aria-");default:return!1}}function X(r,i,c,h){if(i===null||typeof i>"u"||U(r,i,c,h))return!0;if(h)return!1;if(c!==null)switch(c.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function W(r,i,c,h,p,v,S){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=h,this.attributeNamespace=p,this.mustUseProperty=c,this.propertyName=r,this.type=i,this.sanitizeURL=v,this.removeEmptyString=S}var z={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(r){z[r]=new W(r,0,!1,r,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(r){var i=r[0];z[i]=new W(i,1,!1,r[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(r){z[r]=new W(r,2,!1,r.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(r){z[r]=new W(r,2,!1,r,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(r){z[r]=new W(r,3,!1,r.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(r){z[r]=new W(r,3,!0,r,null,!1,!1)}),["capture","download"].forEach(function(r){z[r]=new W(r,4,!1,r,null,!1,!1)}),["cols","rows","size","span"].forEach(function(r){z[r]=new W(r,6,!1,r,null,!1,!1)}),["rowSpan","start"].forEach(function(r){z[r]=new W(r,5,!1,r.toLowerCase(),null,!1,!1)});var se=/[\-:]([a-z])/g;function we(r){return r[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(r){var i=r.replace(se,we);z[i]=new W(i,1,!1,r,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(r){var i=r.replace(se,we);z[i]=new W(i,1,!1,r,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(r){var i=r.replace(se,we);z[i]=new W(i,1,!1,r,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(r){z[r]=new W(r,1,!1,r.toLowerCase(),null,!1,!1)}),z.xlinkHref=new W("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(r){z[r]=new W(r,1,!1,r.toLowerCase(),null,!0,!0)});function _e(r,i,c,h){var p=z.hasOwnProperty(i)?z[i]:null;(p!==null?p.type!==0:h||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(X(i,c,p,h)&&(c=null),h||p===null?C(i)&&(c===null?r.removeAttribute(i):r.setAttribute(i,""+c)):p.mustUseProperty?r[p.propertyName]=c===null?p.type===3?!1:"":c:(i=p.attributeName,h=p.attributeNamespace,c===null?r.removeAttribute(i):(p=p.type,c=p===3||p===4&&c===!0?"":""+c,h?r.setAttributeNS(h,i,c):r.setAttribute(i,c))))}var ve=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,L=Symbol.for("react.element"),ie=Symbol.for("react.portal"),I=Symbol.for("react.fragment"),N=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),O=Symbol.for("react.provider"),D=Symbol.for("react.context"),P=Symbol.for("react.forward_ref"),b=Symbol.for("react.suspense"),J=Symbol.for("react.suspense_list"),re=Symbol.for("react.memo"),Ie=Symbol.for("react.lazy"),he=Symbol.for("react.offscreen"),ce=Symbol.iterator;function Pe(r){return r===null||typeof r!="object"?null:(r=ce&&r[ce]||r["@@iterator"],typeof r=="function"?r:null)}var xe=Object.assign,Y;function k(r){if(Y===void 0)try{throw Error()}catch(c){var i=c.stack.trim().match(/\n( *(at )?)/);Y=i&&i[1]||""}return`
`+Y+r}var H=!1;function Te(r,i){if(!r||H)return"";H=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(ae){var h=ae}Reflect.construct(r,[],i)}else{try{i.call()}catch(ae){h=ae}r.call(i.prototype)}else{try{throw Error()}catch(ae){h=ae}r()}}catch(ae){if(ae&&h&&typeof ae.stack=="string"){for(var p=ae.stack.split(`
`),v=h.stack.split(`
`),S=p.length-1,V=v.length-1;1<=S&&0<=V&&p[S]!==v[V];)V--;for(;1<=S&&0<=V;S--,V--)if(p[S]!==v[V]){if(S!==1||V!==1)do if(S--,V--,0>V||p[S]!==v[V]){var q=`
`+p[S].replace(" at new "," at ");return r.displayName&&q.includes("<anonymous>")&&(q=q.replace("<anonymous>",r.displayName)),q}while(1<=S&&0<=V);break}}}finally{H=!1,Error.prepareStackTrace=c}return(r=r?r.displayName||r.name:"")?k(r):""}function Ve(r){switch(r.tag){case 5:return k(r.type);case 16:return k("Lazy");case 13:return k("Suspense");case 19:return k("SuspenseList");case 0:case 2:case 15:return r=Te(r.type,!1),r;case 11:return r=Te(r.type.render,!1),r;case 1:return r=Te(r.type,!0),r;default:return""}}function De(r){if(r==null)return null;if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case I:return"Fragment";case ie:return"Portal";case A:return"Profiler";case N:return"StrictMode";case b:return"Suspense";case J:return"SuspenseList"}if(typeof r=="object")switch(r.$$typeof){case D:return(r.displayName||"Context")+".Consumer";case O:return(r._context.displayName||"Context")+".Provider";case P:var i=r.render;return r=r.displayName,r||(r=i.displayName||i.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case re:return i=r.displayName||null,i!==null?i:De(r.type)||"Memo";case Ie:i=r._payload,r=r._init;try{return De(r(i))}catch{}}return null}function Oe(r){var i=r.type;switch(r.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return r=i.render,r=r.displayName||r.name||"",i.displayName||(r!==""?"ForwardRef("+r+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return De(i);case 8:return i===N?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function Qe(r){switch(typeof r){case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function nt(r){var i=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function ge(r){var i=nt(r)?"checked":"value",c=Object.getOwnPropertyDescriptor(r.constructor.prototype,i),h=""+r[i];if(!r.hasOwnProperty(i)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var p=c.get,v=c.set;return Object.defineProperty(r,i,{configurable:!0,get:function(){return p.call(this)},set:function(S){h=""+S,v.call(this,S)}}),Object.defineProperty(r,i,{enumerable:c.enumerable}),{getValue:function(){return h},setValue:function(S){h=""+S},stopTracking:function(){r._valueTracker=null,delete r[i]}}}}function le(r){r._valueTracker||(r._valueTracker=ge(r))}function Me(r){if(!r)return!1;var i=r._valueTracker;if(!i)return!0;var c=i.getValue(),h="";return r&&(h=nt(r)?r.checked?"true":"false":r.value),r=h,r!==c?(i.setValue(r),!0):!1}function pe(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}function qe(r,i){var c=i.checked;return xe({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:c??r._wrapperState.initialChecked})}function Ye(r,i){var c=i.defaultValue==null?"":i.defaultValue,h=i.checked!=null?i.checked:i.defaultChecked;c=Qe(i.value!=null?i.value:c),r._wrapperState={initialChecked:h,initialValue:c,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function It(r,i){i=i.checked,i!=null&&_e(r,"checked",i,!1)}function At(r,i){It(r,i);var c=Qe(i.value),h=i.type;if(c!=null)h==="number"?(c===0&&r.value===""||r.value!=c)&&(r.value=""+c):r.value!==""+c&&(r.value=""+c);else if(h==="submit"||h==="reset"){r.removeAttribute("value");return}i.hasOwnProperty("value")?jt(r,i.type,c):i.hasOwnProperty("defaultValue")&&jt(r,i.type,Qe(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(r.defaultChecked=!!i.defaultChecked)}function wt(r,i,c){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var h=i.type;if(!(h!=="submit"&&h!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+r._wrapperState.initialValue,c||i===r.value||(r.value=i),r.defaultValue=i}c=r.name,c!==""&&(r.name=""),r.defaultChecked=!!r._wrapperState.initialChecked,c!==""&&(r.name=c)}function jt(r,i,c){(i!=="number"||pe(r.ownerDocument)!==r)&&(c==null?r.defaultValue=""+r._wrapperState.initialValue:r.defaultValue!==""+c&&(r.defaultValue=""+c))}var sn=Array.isArray;function un(r,i,c,h){if(r=r.options,i){i={};for(var p=0;p<c.length;p++)i["$"+c[p]]=!0;for(c=0;c<r.length;c++)p=i.hasOwnProperty("$"+r[c].value),r[c].selected!==p&&(r[c].selected=p),p&&h&&(r[c].defaultSelected=!0)}else{for(c=""+Qe(c),i=null,p=0;p<r.length;p++){if(r[p].value===c){r[p].selected=!0,h&&(r[p].defaultSelected=!0);return}i!==null||r[p].disabled||(i=r[p])}i!==null&&(i.selected=!0)}}function Fn(r,i){if(i.dangerouslySetInnerHTML!=null)throw Error(t(91));return xe({},i,{value:void 0,defaultValue:void 0,children:""+r._wrapperState.initialValue})}function lr(r,i){var c=i.value;if(c==null){if(c=i.children,i=i.defaultValue,c!=null){if(i!=null)throw Error(t(92));if(sn(c)){if(1<c.length)throw Error(t(93));c=c[0]}i=c}i==null&&(i=""),c=i}r._wrapperState={initialValue:Qe(c)}}function Gt(r,i){var c=Qe(i.value),h=Qe(i.defaultValue);c!=null&&(c=""+c,c!==r.value&&(r.value=c),i.defaultValue==null&&r.defaultValue!==c&&(r.defaultValue=c)),h!=null&&(r.defaultValue=""+h)}function Kn(r){var i=r.textContent;i===r._wrapperState.initialValue&&i!==""&&i!==null&&(r.value=i)}function Ft(r){switch(r){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ut(r,i){return r==null||r==="http://www.w3.org/1999/xhtml"?Ft(i):r==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":r}var dn,Qn=(function(r){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,c,h,p){MSApp.execUnsafeLocalFunction(function(){return r(i,c,h,p)})}:r})(function(r,i){if(r.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in r)r.innerHTML=i;else{for(dn=dn||document.createElement("div"),dn.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=dn.firstChild;r.firstChild;)r.removeChild(r.firstChild);for(;i.firstChild;)r.appendChild(i.firstChild)}});function In(r,i){if(i){var c=r.firstChild;if(c&&c===r.lastChild&&c.nodeType===3){c.nodeValue=i;return}}r.textContent=i}var Yn={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Dr=["Webkit","ms","Moz","O"];Object.keys(Yn).forEach(function(r){Dr.forEach(function(i){i=i+r.charAt(0).toUpperCase()+r.substring(1),Yn[i]=Yn[r]})});function ds(r,i,c){return i==null||typeof i=="boolean"||i===""?"":c||typeof i!="number"||i===0||Yn.hasOwnProperty(r)&&Yn[r]?(""+i).trim():i+"px"}function cr(r,i){r=r.style;for(var c in i)if(i.hasOwnProperty(c)){var h=c.indexOf("--")===0,p=ds(c,i[c],h);c==="float"&&(c="cssFloat"),h?r.setProperty(c,p):r[c]=p}}var Un=xe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Vr(r,i){if(i){if(Un[r]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(t(137,r));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(t(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(t(61))}if(i.style!=null&&typeof i.style!="object")throw Error(t(62))}}function _r(r,i){if(r.indexOf("-")===-1)return typeof i.is=="string";switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var dt=null;function Wr(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Jn=null,vn=null,zn=null;function hs(r){if(r=fl(r)){if(typeof Jn!="function")throw Error(t(280));var i=r.stateNode;i&&(i=kc(i),Jn(r.stateNode,r.type,i))}}function Nn(r){vn?zn?zn.push(r):zn=[r]:vn=r}function xr(){if(vn){var r=vn,i=zn;if(zn=vn=null,hs(r),i)for(r=0;r<i.length;r++)hs(i[r])}}function Gr(r,i){return r(i)}function qr(){}var wr=!1;function js(r,i,c){if(wr)return r(i,c);wr=!0;try{return Gr(r,i,c)}finally{wr=!1,(vn!==null||zn!==null)&&(qr(),xr())}}function ot(r,i){var c=r.stateNode;if(c===null)return null;var h=kc(c);if(h===null)return null;c=h[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(r=r.type,h=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!h;break e;default:r=!1}if(r)return null;if(c&&typeof c!="function")throw Error(t(231,i,typeof c));return c}var Hr=!1;if(f)try{var Pn={};Object.defineProperty(Pn,"passive",{get:function(){Hr=!0}}),window.addEventListener("test",Pn,Pn),window.removeEventListener("test",Pn,Pn)}catch{Hr=!1}function fs(r,i,c,h,p,v,S,V,q){var ae=Array.prototype.slice.call(arguments,3);try{i.apply(c,ae)}catch(be){this.onError(be)}}var Xn=!1,ks=null,ur=!1,Ti=null,an={onError:function(r){Xn=!0,ks=r}};function Zt(r,i,c,h,p,v,S,V,q){Xn=!1,ks=null,fs.apply(an,arguments)}function Lr(r,i,c,h,p,v,S,V,q){if(Zt.apply(this,arguments),Xn){if(Xn){var ae=ks;Xn=!1,ks=null}else throw Error(t(198));ur||(ur=!0,Ti=ae)}}function Rn(r){var i=r,c=r;if(r.alternate)for(;i.return;)i=i.return;else{r=i;do i=r,(i.flags&4098)!==0&&(c=i.return),r=i.return;while(r)}return i.tag===3?c:null}function $n(r){if(r.tag===13){var i=r.memoizedState;if(i===null&&(r=r.alternate,r!==null&&(i=r.memoizedState)),i!==null)return i.dehydrated}return null}function zt(r){if(Rn(r)!==r)throw Error(t(188))}function ps(r){var i=r.alternate;if(!i){if(i=Rn(r),i===null)throw Error(t(188));return i!==r?null:r}for(var c=r,h=i;;){var p=c.return;if(p===null)break;var v=p.alternate;if(v===null){if(h=p.return,h!==null){c=h;continue}break}if(p.child===v.child){for(v=p.child;v;){if(v===c)return zt(p),r;if(v===h)return zt(p),i;v=v.sibling}throw Error(t(188))}if(c.return!==h.return)c=p,h=v;else{for(var S=!1,V=p.child;V;){if(V===c){S=!0,c=p,h=v;break}if(V===h){S=!0,h=p,c=v;break}V=V.sibling}if(!S){for(V=v.child;V;){if(V===c){S=!0,c=v,h=p;break}if(V===h){S=!0,h=v,c=p;break}V=V.sibling}if(!S)throw Error(t(189))}}if(c.alternate!==h)throw Error(t(190))}if(c.tag!==3)throw Error(t(188));return c.stateNode.current===c?r:i}function Ds(r){return r=ps(r),r!==null?ms(r):null}function ms(r){if(r.tag===5||r.tag===6)return r;for(r=r.child;r!==null;){var i=ms(r);if(i!==null)return i;r=r.sibling}return null}var gs=e.unstable_scheduleCallback,Kr=e.unstable_cancelCallback,dr=e.unstable_shouldYield,fa=e.unstable_requestPaint,ft=e.unstable_now,_n=e.unstable_getCurrentPriorityLevel,An=e.unstable_ImmediatePriority,en=e.unstable_UserBlockingPriority,w=e.unstable_NormalPriority,B=e.unstable_LowPriority,F=e.unstable_IdlePriority,M=null,G=null;function me(r){if(G&&typeof G.onCommitFiberRoot=="function")try{G.onCommitFiberRoot(M,r,void 0,(r.current.flags&128)===128)}catch{}}var ne=Math.clz32?Math.clz32:We,je=Math.log,Se=Math.LN2;function We(r){return r>>>=0,r===0?32:31-(je(r)/Se|0)|0}var de=64,Je=4194304;function Re(r){switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return r&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return r}}function ht(r,i){var c=r.pendingLanes;if(c===0)return 0;var h=0,p=r.suspendedLanes,v=r.pingedLanes,S=c&268435455;if(S!==0){var V=S&~p;V!==0?h=Re(V):(v&=S,v!==0&&(h=Re(v)))}else S=c&~p,S!==0?h=Re(S):v!==0&&(h=Re(v));if(h===0)return 0;if(i!==0&&i!==h&&(i&p)===0&&(p=h&-h,v=i&-i,p>=v||p===16&&(v&4194240)!==0))return i;if((h&4)!==0&&(h|=c&16),i=r.entangledLanes,i!==0)for(r=r.entanglements,i&=h;0<i;)c=31-ne(i),p=1<<c,h|=r[c],i&=~p;return h}function Vs(r,i){switch(r){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function hr(r,i){for(var c=r.suspendedLanes,h=r.pingedLanes,p=r.expirationTimes,v=r.pendingLanes;0<v;){var S=31-ne(v),V=1<<S,q=p[S];q===-1?((V&c)===0||(V&h)!==0)&&(p[S]=Vs(V,i)):q<=i&&(r.expiredLanes|=V),v&=~V}}function xn(r){return r=r.pendingLanes&-1073741825,r!==0?r:r&1073741824?1073741824:0}function fr(){var r=de;return de<<=1,(de&4194240)===0&&(de=64),r}function Qr(r){for(var i=[],c=0;31>c;c++)i.push(r);return i}function Ls(r,i,c){r.pendingLanes|=i,i!==536870912&&(r.suspendedLanes=0,r.pingedLanes=0),r=r.eventTimes,i=31-ne(i),r[i]=c}function kt(r,i){var c=r.pendingLanes&~i;r.pendingLanes=i,r.suspendedLanes=0,r.pingedLanes=0,r.expiredLanes&=i,r.mutableReadLanes&=i,r.entangledLanes&=i,i=r.entanglements;var h=r.eventTimes;for(r=r.expirationTimes;0<c;){var p=31-ne(c),v=1<<p;i[p]=0,h[p]=-1,r[p]=-1,c&=~v}}function Ms(r,i){var c=r.entangledLanes|=i;for(r=r.entanglements;c;){var h=31-ne(c),p=1<<h;p&i|r[h]&i&&(r[h]|=i),c&=~p}}var gt=0;function Nt(r){return r&=-r,1<r?4<r?(r&268435455)!==0?16:536870912:4:1}var Os,pr,pa,ma,ga,ya=!1,jn=[],hn=null,Mr=null,Er=null,ys=new Map,mr=new Map,Yr=[],Ja="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Xa(r,i){switch(r){case"focusin":case"focusout":hn=null;break;case"dragenter":case"dragleave":Mr=null;break;case"mouseover":case"mouseout":Er=null;break;case"pointerover":case"pointerout":ys.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":mr.delete(i.pointerId)}}function T(r,i,c,h,p,v){return r===null||r.nativeEvent!==v?(r={blockedOn:i,domEventName:c,eventSystemFlags:h,nativeEvent:v,targetContainers:[p]},i!==null&&(i=fl(i),i!==null&&pr(i)),r):(r.eventSystemFlags|=h,i=r.targetContainers,p!==null&&i.indexOf(p)===-1&&i.push(p),r)}function $(r,i,c,h,p){switch(i){case"focusin":return hn=T(hn,r,i,c,h,p),!0;case"dragenter":return Mr=T(Mr,r,i,c,h,p),!0;case"mouseover":return Er=T(Er,r,i,c,h,p),!0;case"pointerover":var v=p.pointerId;return ys.set(v,T(ys.get(v)||null,r,i,c,h,p)),!0;case"gotpointercapture":return v=p.pointerId,mr.set(v,T(mr.get(v)||null,r,i,c,h,p)),!0}return!1}function K(r){var i=wa(r.target);if(i!==null){var c=Rn(i);if(c!==null){if(i=c.tag,i===13){if(i=$n(c),i!==null){r.blockedOn=i,ga(r.priority,function(){pa(c)});return}}else if(i===3&&c.stateNode.current.memoizedState.isDehydrated){r.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}r.blockedOn=null}function ue(r){if(r.blockedOn!==null)return!1;for(var i=r.targetContainers;0<i.length;){var c=vt(r.domEventName,r.eventSystemFlags,i[0],r.nativeEvent);if(c===null){c=r.nativeEvent;var h=new c.constructor(c.type,c);dt=h,c.target.dispatchEvent(h),dt=null}else return i=fl(c),i!==null&&pr(i),r.blockedOn=c,!1;i.shift()}return!0}function Ce(r,i,c){ue(r)&&c.delete(i)}function He(){ya=!1,hn!==null&&ue(hn)&&(hn=null),Mr!==null&&ue(Mr)&&(Mr=null),Er!==null&&ue(Er)&&(Er=null),ys.forEach(Ce),mr.forEach(Ce)}function Ae(r,i){r.blockedOn===i&&(r.blockedOn=null,ya||(ya=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,He)))}function rt(r){function i(p){return Ae(p,r)}if(0<jn.length){Ae(jn[0],r);for(var c=1;c<jn.length;c++){var h=jn[c];h.blockedOn===r&&(h.blockedOn=null)}}for(hn!==null&&Ae(hn,r),Mr!==null&&Ae(Mr,r),Er!==null&&Ae(Er,r),ys.forEach(i),mr.forEach(i),c=0;c<Yr.length;c++)h=Yr[c],h.blockedOn===r&&(h.blockedOn=null);for(;0<Yr.length&&(c=Yr[0],c.blockedOn===null);)K(c),c.blockedOn===null&&Yr.shift()}var pt=ve.ReactCurrentBatchConfig,St=!0;function ct(r,i,c,h){var p=gt,v=pt.transition;pt.transition=null;try{gt=1,Zn(r,i,c,h)}finally{gt=p,pt.transition=v}}function qt(r,i,c,h){var p=gt,v=pt.transition;pt.transition=null;try{gt=4,Zn(r,i,c,h)}finally{gt=p,pt.transition=v}}function Zn(r,i,c,h){if(St){var p=vt(r,i,c,h);if(p===null)Wd(r,i,h,Qt,c),Xa(r,h);else if($(p,r,i,c,h))h.stopPropagation();else if(Xa(r,h),i&4&&-1<Ja.indexOf(r)){for(;p!==null;){var v=fl(p);if(v!==null&&Os(v),v=vt(r,i,c,h),v===null&&Wd(r,i,h,Qt,c),v===p)break;p=v}p!==null&&h.stopPropagation()}else Wd(r,i,h,null,c)}}var Qt=null;function vt(r,i,c,h){if(Qt=null,r=Wr(h),r=wa(r),r!==null)if(i=Rn(r),i===null)r=null;else if(c=i.tag,c===13){if(r=$n(i),r!==null)return r;r=null}else if(c===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;r=null}else i!==r&&(r=null);return Qt=r,null}function Jr(r){switch(r){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(_n()){case An:return 1;case en:return 4;case w:case B:return 16;case F:return 536870912;default:return 16}default:return 16}}var Lt=null,Tr=null,kn=null;function va(){if(kn)return kn;var r,i=Tr,c=i.length,h,p="value"in Lt?Lt.value:Lt.textContent,v=p.length;for(r=0;r<c&&i[r]===p[r];r++);var S=c-r;for(h=1;h<=S&&i[c-h]===p[v-h];h++);return kn=p.slice(r,1<h?1-h:void 0)}function Si(r){var i=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&i===13&&(r=13)):r=i,r===10&&(r=13),32<=r||r===13?r:0}function Xr(){return!0}function vs(){return!1}function wn(r){function i(c,h,p,v,S){this._reactName=c,this._targetInst=p,this.type=h,this.nativeEvent=v,this.target=S,this.currentTarget=null;for(var V in r)r.hasOwnProperty(V)&&(c=r[V],this[V]=c?c(v):v[V]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?Xr:vs,this.isPropagationStopped=vs,this}return xe(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=Xr)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=Xr)},persist:function(){},isPersistent:Xr}),i}var _s={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Za=wn(_s),Fs=xe({},_s,{view:0,detail:0}),Dd=wn(Fs),eo,ei,bi,_a=xe({},Fs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Us,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==bi&&(bi&&r.type==="mousemove"?(eo=r.screenX-bi.screenX,ei=r.screenY-bi.screenY):ei=eo=0,bi=r),eo)},movementY:function(r){return"movementY"in r?r.movementY:ei}}),to=wn(_a),rl=xe({},_a,{dataTransfer:0}),_c=wn(rl),no=xe({},Fs,{relatedTarget:0}),ro=wn(no),xc=xe({},_s,{animationName:0,elapsedTime:0,pseudoElement:0}),ti=wn(xc),wc=xe({},_s,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),Ec=wn(wc),Tc=xe({},_s,{data:0}),sl=wn(Tc),so={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},gr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Sc={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function bc(r){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(r):(r=Sc[r])?!!i[r]:!1}function Us(){return bc}var u=xe({},Fs,{key:function(r){if(r.key){var i=so[r.key]||r.key;if(i!=="Unidentified")return i}return r.type==="keypress"?(r=Si(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?gr[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Us,charCode:function(r){return r.type==="keypress"?Si(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?Si(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),g=wn(u),_=xe({},_a,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),R=wn(_),Z=xe({},Fs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Us}),oe=wn(Z),Le=xe({},_s,{propertyName:0,elapsedTime:0,pseudoElement:0}),Dt=wn(Le),En=xe({},_a,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),Et=wn(En),Dn=[9,13,27,32],fn=f&&"CompositionEvent"in window,Zr=null;f&&"documentMode"in document&&(Zr=document.documentMode);var Or=f&&"TextEvent"in window&&!Zr,xa=f&&(!fn||Zr&&8<Zr&&11>=Zr),io=" ",cm=!1;function um(r,i){switch(r){case"keyup":return Dn.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function dm(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var ao=!1;function ww(r,i){switch(r){case"compositionend":return dm(i);case"keypress":return i.which!==32?null:(cm=!0,io);case"textInput":return r=i.data,r===io&&cm?null:r;default:return null}}function Ew(r,i){if(ao)return r==="compositionend"||!fn&&um(r,i)?(r=va(),kn=Tr=Lt=null,ao=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return xa&&i.locale!=="ko"?null:i.data;default:return null}}var Tw={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function hm(r){var i=r&&r.nodeName&&r.nodeName.toLowerCase();return i==="input"?!!Tw[r.type]:i==="textarea"}function fm(r,i,c,h){Nn(h),i=Rc(i,"onChange"),0<i.length&&(c=new Za("onChange","change",null,c,h),r.push({event:c,listeners:i}))}var il=null,al=null;function Sw(r){Am(r,0)}function Cc(r){var i=ho(r);if(Me(i))return r}function bw(r,i){if(r==="change")return i}var pm=!1;if(f){var Vd;if(f){var Ld="oninput"in document;if(!Ld){var mm=document.createElement("div");mm.setAttribute("oninput","return;"),Ld=typeof mm.oninput=="function"}Vd=Ld}else Vd=!1;pm=Vd&&(!document.documentMode||9<document.documentMode)}function gm(){il&&(il.detachEvent("onpropertychange",ym),al=il=null)}function ym(r){if(r.propertyName==="value"&&Cc(al)){var i=[];fm(i,al,r,Wr(r)),js(Sw,i)}}function Cw(r,i,c){r==="focusin"?(gm(),il=i,al=c,il.attachEvent("onpropertychange",ym)):r==="focusout"&&gm()}function Iw(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Cc(al)}function Nw(r,i){if(r==="click")return Cc(i)}function Pw(r,i){if(r==="input"||r==="change")return Cc(i)}function Rw(r,i){return r===i&&(r!==0||1/r===1/i)||r!==r&&i!==i}var xs=typeof Object.is=="function"?Object.is:Rw;function ol(r,i){if(xs(r,i))return!0;if(typeof r!="object"||r===null||typeof i!="object"||i===null)return!1;var c=Object.keys(r),h=Object.keys(i);if(c.length!==h.length)return!1;for(h=0;h<c.length;h++){var p=c[h];if(!m.call(i,p)||!xs(r[p],i[p]))return!1}return!0}function vm(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function _m(r,i){var c=vm(r);r=0;for(var h;c;){if(c.nodeType===3){if(h=r+c.textContent.length,r<=i&&h>=i)return{node:c,offset:i-r};r=h}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=vm(c)}}function xm(r,i){return r&&i?r===i?!0:r&&r.nodeType===3?!1:i&&i.nodeType===3?xm(r,i.parentNode):"contains"in r?r.contains(i):r.compareDocumentPosition?!!(r.compareDocumentPosition(i)&16):!1:!1}function wm(){for(var r=window,i=pe();i instanceof r.HTMLIFrameElement;){try{var c=typeof i.contentWindow.location.href=="string"}catch{c=!1}if(c)r=i.contentWindow;else break;i=pe(r.document)}return i}function Md(r){var i=r&&r.nodeName&&r.nodeName.toLowerCase();return i&&(i==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||i==="textarea"||r.contentEditable==="true")}function Aw(r){var i=wm(),c=r.focusedElem,h=r.selectionRange;if(i!==c&&c&&c.ownerDocument&&xm(c.ownerDocument.documentElement,c)){if(h!==null&&Md(c)){if(i=h.start,r=h.end,r===void 0&&(r=i),"selectionStart"in c)c.selectionStart=i,c.selectionEnd=Math.min(r,c.value.length);else if(r=(i=c.ownerDocument||document)&&i.defaultView||window,r.getSelection){r=r.getSelection();var p=c.textContent.length,v=Math.min(h.start,p);h=h.end===void 0?v:Math.min(h.end,p),!r.extend&&v>h&&(p=h,h=v,v=p),p=_m(c,v);var S=_m(c,h);p&&S&&(r.rangeCount!==1||r.anchorNode!==p.node||r.anchorOffset!==p.offset||r.focusNode!==S.node||r.focusOffset!==S.offset)&&(i=i.createRange(),i.setStart(p.node,p.offset),r.removeAllRanges(),v>h?(r.addRange(i),r.extend(S.node,S.offset)):(i.setEnd(S.node,S.offset),r.addRange(i)))}}for(i=[],r=c;r=r.parentNode;)r.nodeType===1&&i.push({element:r,left:r.scrollLeft,top:r.scrollTop});for(typeof c.focus=="function"&&c.focus(),c=0;c<i.length;c++)r=i[c],r.element.scrollLeft=r.left,r.element.scrollTop=r.top}}var jw=f&&"documentMode"in document&&11>=document.documentMode,oo=null,Od=null,ll=null,Fd=!1;function Em(r,i,c){var h=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Fd||oo==null||oo!==pe(h)||(h=oo,"selectionStart"in h&&Md(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),ll&&ol(ll,h)||(ll=h,h=Rc(Od,"onSelect"),0<h.length&&(i=new Za("onSelect","select",null,i,c),r.push({event:i,listeners:h}),i.target=oo)))}function Ic(r,i){var c={};return c[r.toLowerCase()]=i.toLowerCase(),c["Webkit"+r]="webkit"+i,c["Moz"+r]="moz"+i,c}var lo={animationend:Ic("Animation","AnimationEnd"),animationiteration:Ic("Animation","AnimationIteration"),animationstart:Ic("Animation","AnimationStart"),transitionend:Ic("Transition","TransitionEnd")},Ud={},Tm={};f&&(Tm=document.createElement("div").style,"AnimationEvent"in window||(delete lo.animationend.animation,delete lo.animationiteration.animation,delete lo.animationstart.animation),"TransitionEvent"in window||delete lo.transitionend.transition);function Nc(r){if(Ud[r])return Ud[r];if(!lo[r])return r;var i=lo[r],c;for(c in i)if(i.hasOwnProperty(c)&&c in Tm)return Ud[r]=i[c];return r}var Sm=Nc("animationend"),bm=Nc("animationiteration"),Cm=Nc("animationstart"),Im=Nc("transitionend"),Nm=new Map,Pm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ci(r,i){Nm.set(r,i),l(i,[r])}for(var zd=0;zd<Pm.length;zd++){var $d=Pm[zd],kw=$d.toLowerCase(),Dw=$d[0].toUpperCase()+$d.slice(1);Ci(kw,"on"+Dw)}Ci(Sm,"onAnimationEnd"),Ci(bm,"onAnimationIteration"),Ci(Cm,"onAnimationStart"),Ci("dblclick","onDoubleClick"),Ci("focusin","onFocus"),Ci("focusout","onBlur"),Ci(Im,"onTransitionEnd"),d("onMouseEnter",["mouseout","mouseover"]),d("onMouseLeave",["mouseout","mouseover"]),d("onPointerEnter",["pointerout","pointerover"]),d("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var cl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Vw=new Set("cancel close invalid load scroll toggle".split(" ").concat(cl));function Rm(r,i,c){var h=r.type||"unknown-event";r.currentTarget=c,Lr(h,i,void 0,r),r.currentTarget=null}function Am(r,i){i=(i&4)!==0;for(var c=0;c<r.length;c++){var h=r[c],p=h.event;h=h.listeners;e:{var v=void 0;if(i)for(var S=h.length-1;0<=S;S--){var V=h[S],q=V.instance,ae=V.currentTarget;if(V=V.listener,q!==v&&p.isPropagationStopped())break e;Rm(p,V,ae),v=q}else for(S=0;S<h.length;S++){if(V=h[S],q=V.instance,ae=V.currentTarget,V=V.listener,q!==v&&p.isPropagationStopped())break e;Rm(p,V,ae),v=q}}}if(ur)throw r=Ti,ur=!1,Ti=null,r}function $t(r,i){var c=i[Yd];c===void 0&&(c=i[Yd]=new Set);var h=r+"__bubble";c.has(h)||(jm(i,r,2,!1),c.add(h))}function Bd(r,i,c){var h=0;i&&(h|=4),jm(c,r,h,i)}var Pc="_reactListening"+Math.random().toString(36).slice(2);function ul(r){if(!r[Pc]){r[Pc]=!0,s.forEach(function(c){c!=="selectionchange"&&(Vw.has(c)||Bd(c,!1,r),Bd(c,!0,r))});var i=r.nodeType===9?r:r.ownerDocument;i===null||i[Pc]||(i[Pc]=!0,Bd("selectionchange",!1,i))}}function jm(r,i,c,h){switch(Jr(i)){case 1:var p=ct;break;case 4:p=qt;break;default:p=Zn}c=p.bind(null,i,c,r),p=void 0,!Hr||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(p=!0),h?p!==void 0?r.addEventListener(i,c,{capture:!0,passive:p}):r.addEventListener(i,c,!0):p!==void 0?r.addEventListener(i,c,{passive:p}):r.addEventListener(i,c,!1)}function Wd(r,i,c,h,p){var v=h;if((i&1)===0&&(i&2)===0&&h!==null)e:for(;;){if(h===null)return;var S=h.tag;if(S===3||S===4){var V=h.stateNode.containerInfo;if(V===p||V.nodeType===8&&V.parentNode===p)break;if(S===4)for(S=h.return;S!==null;){var q=S.tag;if((q===3||q===4)&&(q=S.stateNode.containerInfo,q===p||q.nodeType===8&&q.parentNode===p))return;S=S.return}for(;V!==null;){if(S=wa(V),S===null)return;if(q=S.tag,q===5||q===6){h=v=S;continue e}V=V.parentNode}}h=h.return}js(function(){var ae=v,be=Wr(c),Ne=[];e:{var Ee=Nm.get(r);if(Ee!==void 0){var Ue=Za,Be=r;switch(r){case"keypress":if(Si(c)===0)break e;case"keydown":case"keyup":Ue=g;break;case"focusin":Be="focus",Ue=ro;break;case"focusout":Be="blur",Ue=ro;break;case"beforeblur":case"afterblur":Ue=ro;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ue=to;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ue=_c;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ue=oe;break;case Sm:case bm:case Cm:Ue=ti;break;case Im:Ue=Dt;break;case"scroll":Ue=Dd;break;case"wheel":Ue=Et;break;case"copy":case"cut":case"paste":Ue=Ec;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ue=R}var Ge=(i&4)!==0,on=!Ge&&r==="scroll",ee=Ge?Ee!==null?Ee+"Capture":null:Ee;Ge=[];for(var Q=ae,te;Q!==null;){te=Q;var ke=te.stateNode;if(te.tag===5&&ke!==null&&(te=ke,ee!==null&&(ke=ot(Q,ee),ke!=null&&Ge.push(dl(Q,ke,te)))),on)break;Q=Q.return}0<Ge.length&&(Ee=new Ue(Ee,Be,null,c,be),Ne.push({event:Ee,listeners:Ge}))}}if((i&7)===0){e:{if(Ee=r==="mouseover"||r==="pointerover",Ue=r==="mouseout"||r==="pointerout",Ee&&c!==dt&&(Be=c.relatedTarget||c.fromElement)&&(wa(Be)||Be[ni]))break e;if((Ue||Ee)&&(Ee=be.window===be?be:(Ee=be.ownerDocument)?Ee.defaultView||Ee.parentWindow:window,Ue?(Be=c.relatedTarget||c.toElement,Ue=ae,Be=Be?wa(Be):null,Be!==null&&(on=Rn(Be),Be!==on||Be.tag!==5&&Be.tag!==6)&&(Be=null)):(Ue=null,Be=ae),Ue!==Be)){if(Ge=to,ke="onMouseLeave",ee="onMouseEnter",Q="mouse",(r==="pointerout"||r==="pointerover")&&(Ge=R,ke="onPointerLeave",ee="onPointerEnter",Q="pointer"),on=Ue==null?Ee:ho(Ue),te=Be==null?Ee:ho(Be),Ee=new Ge(ke,Q+"leave",Ue,c,be),Ee.target=on,Ee.relatedTarget=te,ke=null,wa(be)===ae&&(Ge=new Ge(ee,Q+"enter",Be,c,be),Ge.target=te,Ge.relatedTarget=on,ke=Ge),on=ke,Ue&&Be)t:{for(Ge=Ue,ee=Be,Q=0,te=Ge;te;te=co(te))Q++;for(te=0,ke=ee;ke;ke=co(ke))te++;for(;0<Q-te;)Ge=co(Ge),Q--;for(;0<te-Q;)ee=co(ee),te--;for(;Q--;){if(Ge===ee||ee!==null&&Ge===ee.alternate)break t;Ge=co(Ge),ee=co(ee)}Ge=null}else Ge=null;Ue!==null&&km(Ne,Ee,Ue,Ge,!1),Be!==null&&on!==null&&km(Ne,on,Be,Ge,!0)}}e:{if(Ee=ae?ho(ae):window,Ue=Ee.nodeName&&Ee.nodeName.toLowerCase(),Ue==="select"||Ue==="input"&&Ee.type==="file")var Ke=bw;else if(hm(Ee))if(pm)Ke=Pw;else{Ke=Iw;var Ze=Cw}else(Ue=Ee.nodeName)&&Ue.toLowerCase()==="input"&&(Ee.type==="checkbox"||Ee.type==="radio")&&(Ke=Nw);if(Ke&&(Ke=Ke(r,ae))){fm(Ne,Ke,c,be);break e}Ze&&Ze(r,Ee,ae),r==="focusout"&&(Ze=Ee._wrapperState)&&Ze.controlled&&Ee.type==="number"&&jt(Ee,"number",Ee.value)}switch(Ze=ae?ho(ae):window,r){case"focusin":(hm(Ze)||Ze.contentEditable==="true")&&(oo=Ze,Od=ae,ll=null);break;case"focusout":ll=Od=oo=null;break;case"mousedown":Fd=!0;break;case"contextmenu":case"mouseup":case"dragend":Fd=!1,Em(Ne,c,be);break;case"selectionchange":if(jw)break;case"keydown":case"keyup":Em(Ne,c,be)}var et;if(fn)e:{switch(r){case"compositionstart":var at="onCompositionStart";break e;case"compositionend":at="onCompositionEnd";break e;case"compositionupdate":at="onCompositionUpdate";break e}at=void 0}else ao?um(r,c)&&(at="onCompositionEnd"):r==="keydown"&&c.keyCode===229&&(at="onCompositionStart");at&&(xa&&c.locale!=="ko"&&(ao||at!=="onCompositionStart"?at==="onCompositionEnd"&&ao&&(et=va()):(Lt=be,Tr="value"in Lt?Lt.value:Lt.textContent,ao=!0)),Ze=Rc(ae,at),0<Ze.length&&(at=new sl(at,r,null,c,be),Ne.push({event:at,listeners:Ze}),et?at.data=et:(et=dm(c),et!==null&&(at.data=et)))),(et=Or?ww(r,c):Ew(r,c))&&(ae=Rc(ae,"onBeforeInput"),0<ae.length&&(be=new sl("onBeforeInput","beforeinput",null,c,be),Ne.push({event:be,listeners:ae}),be.data=et))}Am(Ne,i)})}function dl(r,i,c){return{instance:r,listener:i,currentTarget:c}}function Rc(r,i){for(var c=i+"Capture",h=[];r!==null;){var p=r,v=p.stateNode;p.tag===5&&v!==null&&(p=v,v=ot(r,c),v!=null&&h.unshift(dl(r,v,p)),v=ot(r,i),v!=null&&h.push(dl(r,v,p))),r=r.return}return h}function co(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5);return r||null}function km(r,i,c,h,p){for(var v=i._reactName,S=[];c!==null&&c!==h;){var V=c,q=V.alternate,ae=V.stateNode;if(q!==null&&q===h)break;V.tag===5&&ae!==null&&(V=ae,p?(q=ot(c,v),q!=null&&S.unshift(dl(c,q,V))):p||(q=ot(c,v),q!=null&&S.push(dl(c,q,V)))),c=c.return}S.length!==0&&r.push({event:i,listeners:S})}var Lw=/\r\n?/g,Mw=/\u0000|\uFFFD/g;function Dm(r){return(typeof r=="string"?r:""+r).replace(Lw,`
`).replace(Mw,"")}function Ac(r,i,c){if(i=Dm(i),Dm(r)!==i&&c)throw Error(t(425))}function jc(){}var Gd=null,qd=null;function Hd(r,i){return r==="textarea"||r==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Kd=typeof setTimeout=="function"?setTimeout:void 0,Ow=typeof clearTimeout=="function"?clearTimeout:void 0,Vm=typeof Promise=="function"?Promise:void 0,Fw=typeof queueMicrotask=="function"?queueMicrotask:typeof Vm<"u"?function(r){return Vm.resolve(null).then(r).catch(Uw)}:Kd;function Uw(r){setTimeout(function(){throw r})}function Qd(r,i){var c=i,h=0;do{var p=c.nextSibling;if(r.removeChild(c),p&&p.nodeType===8)if(c=p.data,c==="/$"){if(h===0){r.removeChild(p),rt(i);return}h--}else c!=="$"&&c!=="$?"&&c!=="$!"||h++;c=p}while(c);rt(i)}function Ii(r){for(;r!=null;r=r.nextSibling){var i=r.nodeType;if(i===1||i===3)break;if(i===8){if(i=r.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return r}function Lm(r){r=r.previousSibling;for(var i=0;r;){if(r.nodeType===8){var c=r.data;if(c==="$"||c==="$!"||c==="$?"){if(i===0)return r;i--}else c==="/$"&&i++}r=r.previousSibling}return null}var uo=Math.random().toString(36).slice(2),zs="__reactFiber$"+uo,hl="__reactProps$"+uo,ni="__reactContainer$"+uo,Yd="__reactEvents$"+uo,zw="__reactListeners$"+uo,$w="__reactHandles$"+uo;function wa(r){var i=r[zs];if(i)return i;for(var c=r.parentNode;c;){if(i=c[ni]||c[zs]){if(c=i.alternate,i.child!==null||c!==null&&c.child!==null)for(r=Lm(r);r!==null;){if(c=r[zs])return c;r=Lm(r)}return i}r=c,c=r.parentNode}return null}function fl(r){return r=r[zs]||r[ni],!r||r.tag!==5&&r.tag!==6&&r.tag!==13&&r.tag!==3?null:r}function ho(r){if(r.tag===5||r.tag===6)return r.stateNode;throw Error(t(33))}function kc(r){return r[hl]||null}var Jd=[],fo=-1;function Ni(r){return{current:r}}function Bt(r){0>fo||(r.current=Jd[fo],Jd[fo]=null,fo--)}function Mt(r,i){fo++,Jd[fo]=r.current,r.current=i}var Pi={},er=Ni(Pi),Sr=Ni(!1),Ea=Pi;function po(r,i){var c=r.type.contextTypes;if(!c)return Pi;var h=r.stateNode;if(h&&h.__reactInternalMemoizedUnmaskedChildContext===i)return h.__reactInternalMemoizedMaskedChildContext;var p={},v;for(v in c)p[v]=i[v];return h&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=i,r.__reactInternalMemoizedMaskedChildContext=p),p}function br(r){return r=r.childContextTypes,r!=null}function Dc(){Bt(Sr),Bt(er)}function Mm(r,i,c){if(er.current!==Pi)throw Error(t(168));Mt(er,i),Mt(Sr,c)}function Om(r,i,c){var h=r.stateNode;if(i=i.childContextTypes,typeof h.getChildContext!="function")return c;h=h.getChildContext();for(var p in h)if(!(p in i))throw Error(t(108,Oe(r)||"Unknown",p));return xe({},c,h)}function Vc(r){return r=(r=r.stateNode)&&r.__reactInternalMemoizedMergedChildContext||Pi,Ea=er.current,Mt(er,r),Mt(Sr,Sr.current),!0}function Fm(r,i,c){var h=r.stateNode;if(!h)throw Error(t(169));c?(r=Om(r,i,Ea),h.__reactInternalMemoizedMergedChildContext=r,Bt(Sr),Bt(er),Mt(er,r)):Bt(Sr),Mt(Sr,c)}var ri=null,Lc=!1,Xd=!1;function Um(r){ri===null?ri=[r]:ri.push(r)}function Bw(r){Lc=!0,Um(r)}function Ri(){if(!Xd&&ri!==null){Xd=!0;var r=0,i=gt;try{var c=ri;for(gt=1;r<c.length;r++){var h=c[r];do h=h(!0);while(h!==null)}ri=null,Lc=!1}catch(p){throw ri!==null&&(ri=ri.slice(r+1)),gs(An,Ri),p}finally{gt=i,Xd=!1}}return null}var mo=[],go=0,Mc=null,Oc=0,es=[],ts=0,Ta=null,si=1,ii="";function Sa(r,i){mo[go++]=Oc,mo[go++]=Mc,Mc=r,Oc=i}function zm(r,i,c){es[ts++]=si,es[ts++]=ii,es[ts++]=Ta,Ta=r;var h=si;r=ii;var p=32-ne(h)-1;h&=~(1<<p),c+=1;var v=32-ne(i)+p;if(30<v){var S=p-p%5;v=(h&(1<<S)-1).toString(32),h>>=S,p-=S,si=1<<32-ne(i)+p|c<<p|h,ii=v+r}else si=1<<v|c<<p|h,ii=r}function Zd(r){r.return!==null&&(Sa(r,1),zm(r,1,0))}function eh(r){for(;r===Mc;)Mc=mo[--go],mo[go]=null,Oc=mo[--go],mo[go]=null;for(;r===Ta;)Ta=es[--ts],es[ts]=null,ii=es[--ts],es[ts]=null,si=es[--ts],es[ts]=null}var Fr=null,Ur=null,Ht=!1,ws=null;function $m(r,i){var c=is(5,null,null,0);c.elementType="DELETED",c.stateNode=i,c.return=r,i=r.deletions,i===null?(r.deletions=[c],r.flags|=16):i.push(c)}function Bm(r,i){switch(r.tag){case 5:var c=r.type;return i=i.nodeType!==1||c.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(r.stateNode=i,Fr=r,Ur=Ii(i.firstChild),!0):!1;case 6:return i=r.pendingProps===""||i.nodeType!==3?null:i,i!==null?(r.stateNode=i,Fr=r,Ur=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(c=Ta!==null?{id:si,overflow:ii}:null,r.memoizedState={dehydrated:i,treeContext:c,retryLane:1073741824},c=is(18,null,null,0),c.stateNode=i,c.return=r,r.child=c,Fr=r,Ur=null,!0):!1;default:return!1}}function th(r){return(r.mode&1)!==0&&(r.flags&128)===0}function nh(r){if(Ht){var i=Ur;if(i){var c=i;if(!Bm(r,i)){if(th(r))throw Error(t(418));i=Ii(c.nextSibling);var h=Fr;i&&Bm(r,i)?$m(h,c):(r.flags=r.flags&-4097|2,Ht=!1,Fr=r)}}else{if(th(r))throw Error(t(418));r.flags=r.flags&-4097|2,Ht=!1,Fr=r}}}function Wm(r){for(r=r.return;r!==null&&r.tag!==5&&r.tag!==3&&r.tag!==13;)r=r.return;Fr=r}function Fc(r){if(r!==Fr)return!1;if(!Ht)return Wm(r),Ht=!0,!1;var i;if((i=r.tag!==3)&&!(i=r.tag!==5)&&(i=r.type,i=i!=="head"&&i!=="body"&&!Hd(r.type,r.memoizedProps)),i&&(i=Ur)){if(th(r))throw Gm(),Error(t(418));for(;i;)$m(r,i),i=Ii(i.nextSibling)}if(Wm(r),r.tag===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(t(317));e:{for(r=r.nextSibling,i=0;r;){if(r.nodeType===8){var c=r.data;if(c==="/$"){if(i===0){Ur=Ii(r.nextSibling);break e}i--}else c!=="$"&&c!=="$!"&&c!=="$?"||i++}r=r.nextSibling}Ur=null}}else Ur=Fr?Ii(r.stateNode.nextSibling):null;return!0}function Gm(){for(var r=Ur;r;)r=Ii(r.nextSibling)}function yo(){Ur=Fr=null,Ht=!1}function rh(r){ws===null?ws=[r]:ws.push(r)}var Ww=ve.ReactCurrentBatchConfig;function pl(r,i,c){if(r=c.ref,r!==null&&typeof r!="function"&&typeof r!="object"){if(c._owner){if(c=c._owner,c){if(c.tag!==1)throw Error(t(309));var h=c.stateNode}if(!h)throw Error(t(147,r));var p=h,v=""+r;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===v?i.ref:(i=function(S){var V=p.refs;S===null?delete V[v]:V[v]=S},i._stringRef=v,i)}if(typeof r!="string")throw Error(t(284));if(!c._owner)throw Error(t(290,r))}return r}function Uc(r,i){throw r=Object.prototype.toString.call(i),Error(t(31,r==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":r))}function qm(r){var i=r._init;return i(r._payload)}function Hm(r){function i(ee,Q){if(r){var te=ee.deletions;te===null?(ee.deletions=[Q],ee.flags|=16):te.push(Q)}}function c(ee,Q){if(!r)return null;for(;Q!==null;)i(ee,Q),Q=Q.sibling;return null}function h(ee,Q){for(ee=new Map;Q!==null;)Q.key!==null?ee.set(Q.key,Q):ee.set(Q.index,Q),Q=Q.sibling;return ee}function p(ee,Q){return ee=Oi(ee,Q),ee.index=0,ee.sibling=null,ee}function v(ee,Q,te){return ee.index=te,r?(te=ee.alternate,te!==null?(te=te.index,te<Q?(ee.flags|=2,Q):te):(ee.flags|=2,Q)):(ee.flags|=1048576,Q)}function S(ee){return r&&ee.alternate===null&&(ee.flags|=2),ee}function V(ee,Q,te,ke){return Q===null||Q.tag!==6?(Q=Kh(te,ee.mode,ke),Q.return=ee,Q):(Q=p(Q,te),Q.return=ee,Q)}function q(ee,Q,te,ke){var Ke=te.type;return Ke===I?be(ee,Q,te.props.children,ke,te.key):Q!==null&&(Q.elementType===Ke||typeof Ke=="object"&&Ke!==null&&Ke.$$typeof===Ie&&qm(Ke)===Q.type)?(ke=p(Q,te.props),ke.ref=pl(ee,Q,te),ke.return=ee,ke):(ke=uu(te.type,te.key,te.props,null,ee.mode,ke),ke.ref=pl(ee,Q,te),ke.return=ee,ke)}function ae(ee,Q,te,ke){return Q===null||Q.tag!==4||Q.stateNode.containerInfo!==te.containerInfo||Q.stateNode.implementation!==te.implementation?(Q=Qh(te,ee.mode,ke),Q.return=ee,Q):(Q=p(Q,te.children||[]),Q.return=ee,Q)}function be(ee,Q,te,ke,Ke){return Q===null||Q.tag!==7?(Q=ja(te,ee.mode,ke,Ke),Q.return=ee,Q):(Q=p(Q,te),Q.return=ee,Q)}function Ne(ee,Q,te){if(typeof Q=="string"&&Q!==""||typeof Q=="number")return Q=Kh(""+Q,ee.mode,te),Q.return=ee,Q;if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case L:return te=uu(Q.type,Q.key,Q.props,null,ee.mode,te),te.ref=pl(ee,null,Q),te.return=ee,te;case ie:return Q=Qh(Q,ee.mode,te),Q.return=ee,Q;case Ie:var ke=Q._init;return Ne(ee,ke(Q._payload),te)}if(sn(Q)||Pe(Q))return Q=ja(Q,ee.mode,te,null),Q.return=ee,Q;Uc(ee,Q)}return null}function Ee(ee,Q,te,ke){var Ke=Q!==null?Q.key:null;if(typeof te=="string"&&te!==""||typeof te=="number")return Ke!==null?null:V(ee,Q,""+te,ke);if(typeof te=="object"&&te!==null){switch(te.$$typeof){case L:return te.key===Ke?q(ee,Q,te,ke):null;case ie:return te.key===Ke?ae(ee,Q,te,ke):null;case Ie:return Ke=te._init,Ee(ee,Q,Ke(te._payload),ke)}if(sn(te)||Pe(te))return Ke!==null?null:be(ee,Q,te,ke,null);Uc(ee,te)}return null}function Ue(ee,Q,te,ke,Ke){if(typeof ke=="string"&&ke!==""||typeof ke=="number")return ee=ee.get(te)||null,V(Q,ee,""+ke,Ke);if(typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case L:return ee=ee.get(ke.key===null?te:ke.key)||null,q(Q,ee,ke,Ke);case ie:return ee=ee.get(ke.key===null?te:ke.key)||null,ae(Q,ee,ke,Ke);case Ie:var Ze=ke._init;return Ue(ee,Q,te,Ze(ke._payload),Ke)}if(sn(ke)||Pe(ke))return ee=ee.get(te)||null,be(Q,ee,ke,Ke,null);Uc(Q,ke)}return null}function Be(ee,Q,te,ke){for(var Ke=null,Ze=null,et=Q,at=Q=0,Mn=null;et!==null&&at<te.length;at++){et.index>at?(Mn=et,et=null):Mn=et.sibling;var Ct=Ee(ee,et,te[at],ke);if(Ct===null){et===null&&(et=Mn);break}r&&et&&Ct.alternate===null&&i(ee,et),Q=v(Ct,Q,at),Ze===null?Ke=Ct:Ze.sibling=Ct,Ze=Ct,et=Mn}if(at===te.length)return c(ee,et),Ht&&Sa(ee,at),Ke;if(et===null){for(;at<te.length;at++)et=Ne(ee,te[at],ke),et!==null&&(Q=v(et,Q,at),Ze===null?Ke=et:Ze.sibling=et,Ze=et);return Ht&&Sa(ee,at),Ke}for(et=h(ee,et);at<te.length;at++)Mn=Ue(et,ee,at,te[at],ke),Mn!==null&&(r&&Mn.alternate!==null&&et.delete(Mn.key===null?at:Mn.key),Q=v(Mn,Q,at),Ze===null?Ke=Mn:Ze.sibling=Mn,Ze=Mn);return r&&et.forEach(function(Fi){return i(ee,Fi)}),Ht&&Sa(ee,at),Ke}function Ge(ee,Q,te,ke){var Ke=Pe(te);if(typeof Ke!="function")throw Error(t(150));if(te=Ke.call(te),te==null)throw Error(t(151));for(var Ze=Ke=null,et=Q,at=Q=0,Mn=null,Ct=te.next();et!==null&&!Ct.done;at++,Ct=te.next()){et.index>at?(Mn=et,et=null):Mn=et.sibling;var Fi=Ee(ee,et,Ct.value,ke);if(Fi===null){et===null&&(et=Mn);break}r&&et&&Fi.alternate===null&&i(ee,et),Q=v(Fi,Q,at),Ze===null?Ke=Fi:Ze.sibling=Fi,Ze=Fi,et=Mn}if(Ct.done)return c(ee,et),Ht&&Sa(ee,at),Ke;if(et===null){for(;!Ct.done;at++,Ct=te.next())Ct=Ne(ee,Ct.value,ke),Ct!==null&&(Q=v(Ct,Q,at),Ze===null?Ke=Ct:Ze.sibling=Ct,Ze=Ct);return Ht&&Sa(ee,at),Ke}for(et=h(ee,et);!Ct.done;at++,Ct=te.next())Ct=Ue(et,ee,at,Ct.value,ke),Ct!==null&&(r&&Ct.alternate!==null&&et.delete(Ct.key===null?at:Ct.key),Q=v(Ct,Q,at),Ze===null?Ke=Ct:Ze.sibling=Ct,Ze=Ct);return r&&et.forEach(function(TE){return i(ee,TE)}),Ht&&Sa(ee,at),Ke}function on(ee,Q,te,ke){if(typeof te=="object"&&te!==null&&te.type===I&&te.key===null&&(te=te.props.children),typeof te=="object"&&te!==null){switch(te.$$typeof){case L:e:{for(var Ke=te.key,Ze=Q;Ze!==null;){if(Ze.key===Ke){if(Ke=te.type,Ke===I){if(Ze.tag===7){c(ee,Ze.sibling),Q=p(Ze,te.props.children),Q.return=ee,ee=Q;break e}}else if(Ze.elementType===Ke||typeof Ke=="object"&&Ke!==null&&Ke.$$typeof===Ie&&qm(Ke)===Ze.type){c(ee,Ze.sibling),Q=p(Ze,te.props),Q.ref=pl(ee,Ze,te),Q.return=ee,ee=Q;break e}c(ee,Ze);break}else i(ee,Ze);Ze=Ze.sibling}te.type===I?(Q=ja(te.props.children,ee.mode,ke,te.key),Q.return=ee,ee=Q):(ke=uu(te.type,te.key,te.props,null,ee.mode,ke),ke.ref=pl(ee,Q,te),ke.return=ee,ee=ke)}return S(ee);case ie:e:{for(Ze=te.key;Q!==null;){if(Q.key===Ze)if(Q.tag===4&&Q.stateNode.containerInfo===te.containerInfo&&Q.stateNode.implementation===te.implementation){c(ee,Q.sibling),Q=p(Q,te.children||[]),Q.return=ee,ee=Q;break e}else{c(ee,Q);break}else i(ee,Q);Q=Q.sibling}Q=Qh(te,ee.mode,ke),Q.return=ee,ee=Q}return S(ee);case Ie:return Ze=te._init,on(ee,Q,Ze(te._payload),ke)}if(sn(te))return Be(ee,Q,te,ke);if(Pe(te))return Ge(ee,Q,te,ke);Uc(ee,te)}return typeof te=="string"&&te!==""||typeof te=="number"?(te=""+te,Q!==null&&Q.tag===6?(c(ee,Q.sibling),Q=p(Q,te),Q.return=ee,ee=Q):(c(ee,Q),Q=Kh(te,ee.mode,ke),Q.return=ee,ee=Q),S(ee)):c(ee,Q)}return on}var vo=Hm(!0),Km=Hm(!1),zc=Ni(null),$c=null,_o=null,sh=null;function ih(){sh=_o=$c=null}function ah(r){var i=zc.current;Bt(zc),r._currentValue=i}function oh(r,i,c){for(;r!==null;){var h=r.alternate;if((r.childLanes&i)!==i?(r.childLanes|=i,h!==null&&(h.childLanes|=i)):h!==null&&(h.childLanes&i)!==i&&(h.childLanes|=i),r===c)break;r=r.return}}function xo(r,i){$c=r,sh=_o=null,r=r.dependencies,r!==null&&r.firstContext!==null&&((r.lanes&i)!==0&&(Cr=!0),r.firstContext=null)}function ns(r){var i=r._currentValue;if(sh!==r)if(r={context:r,memoizedValue:i,next:null},_o===null){if($c===null)throw Error(t(308));_o=r,$c.dependencies={lanes:0,firstContext:r}}else _o=_o.next=r;return i}var ba=null;function lh(r){ba===null?ba=[r]:ba.push(r)}function Qm(r,i,c,h){var p=i.interleaved;return p===null?(c.next=c,lh(i)):(c.next=p.next,p.next=c),i.interleaved=c,ai(r,h)}function ai(r,i){r.lanes|=i;var c=r.alternate;for(c!==null&&(c.lanes|=i),c=r,r=r.return;r!==null;)r.childLanes|=i,c=r.alternate,c!==null&&(c.childLanes|=i),c=r,r=r.return;return c.tag===3?c.stateNode:null}var Ai=!1;function ch(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ym(r,i){r=r.updateQueue,i.updateQueue===r&&(i.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,effects:r.effects})}function oi(r,i){return{eventTime:r,lane:i,tag:0,payload:null,callback:null,next:null}}function ji(r,i,c){var h=r.updateQueue;if(h===null)return null;if(h=h.shared,(bt&2)!==0){var p=h.pending;return p===null?i.next=i:(i.next=p.next,p.next=i),h.pending=i,ai(r,c)}return p=h.interleaved,p===null?(i.next=i,lh(h)):(i.next=p.next,p.next=i),h.interleaved=i,ai(r,c)}function Bc(r,i,c){if(i=i.updateQueue,i!==null&&(i=i.shared,(c&4194240)!==0)){var h=i.lanes;h&=r.pendingLanes,c|=h,i.lanes=c,Ms(r,c)}}function Jm(r,i){var c=r.updateQueue,h=r.alternate;if(h!==null&&(h=h.updateQueue,c===h)){var p=null,v=null;if(c=c.firstBaseUpdate,c!==null){do{var S={eventTime:c.eventTime,lane:c.lane,tag:c.tag,payload:c.payload,callback:c.callback,next:null};v===null?p=v=S:v=v.next=S,c=c.next}while(c!==null);v===null?p=v=i:v=v.next=i}else p=v=i;c={baseState:h.baseState,firstBaseUpdate:p,lastBaseUpdate:v,shared:h.shared,effects:h.effects},r.updateQueue=c;return}r=c.lastBaseUpdate,r===null?c.firstBaseUpdate=i:r.next=i,c.lastBaseUpdate=i}function Wc(r,i,c,h){var p=r.updateQueue;Ai=!1;var v=p.firstBaseUpdate,S=p.lastBaseUpdate,V=p.shared.pending;if(V!==null){p.shared.pending=null;var q=V,ae=q.next;q.next=null,S===null?v=ae:S.next=ae,S=q;var be=r.alternate;be!==null&&(be=be.updateQueue,V=be.lastBaseUpdate,V!==S&&(V===null?be.firstBaseUpdate=ae:V.next=ae,be.lastBaseUpdate=q))}if(v!==null){var Ne=p.baseState;S=0,be=ae=q=null,V=v;do{var Ee=V.lane,Ue=V.eventTime;if((h&Ee)===Ee){be!==null&&(be=be.next={eventTime:Ue,lane:0,tag:V.tag,payload:V.payload,callback:V.callback,next:null});e:{var Be=r,Ge=V;switch(Ee=i,Ue=c,Ge.tag){case 1:if(Be=Ge.payload,typeof Be=="function"){Ne=Be.call(Ue,Ne,Ee);break e}Ne=Be;break e;case 3:Be.flags=Be.flags&-65537|128;case 0:if(Be=Ge.payload,Ee=typeof Be=="function"?Be.call(Ue,Ne,Ee):Be,Ee==null)break e;Ne=xe({},Ne,Ee);break e;case 2:Ai=!0}}V.callback!==null&&V.lane!==0&&(r.flags|=64,Ee=p.effects,Ee===null?p.effects=[V]:Ee.push(V))}else Ue={eventTime:Ue,lane:Ee,tag:V.tag,payload:V.payload,callback:V.callback,next:null},be===null?(ae=be=Ue,q=Ne):be=be.next=Ue,S|=Ee;if(V=V.next,V===null){if(V=p.shared.pending,V===null)break;Ee=V,V=Ee.next,Ee.next=null,p.lastBaseUpdate=Ee,p.shared.pending=null}}while(!0);if(be===null&&(q=Ne),p.baseState=q,p.firstBaseUpdate=ae,p.lastBaseUpdate=be,i=p.shared.interleaved,i!==null){p=i;do S|=p.lane,p=p.next;while(p!==i)}else v===null&&(p.shared.lanes=0);Na|=S,r.lanes=S,r.memoizedState=Ne}}function Xm(r,i,c){if(r=i.effects,i.effects=null,r!==null)for(i=0;i<r.length;i++){var h=r[i],p=h.callback;if(p!==null){if(h.callback=null,h=c,typeof p!="function")throw Error(t(191,p));p.call(h)}}}var ml={},$s=Ni(ml),gl=Ni(ml),yl=Ni(ml);function Ca(r){if(r===ml)throw Error(t(174));return r}function uh(r,i){switch(Mt(yl,i),Mt(gl,r),Mt($s,ml),r=i.nodeType,r){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:Ut(null,"");break;default:r=r===8?i.parentNode:i,i=r.namespaceURI||null,r=r.tagName,i=Ut(i,r)}Bt($s),Mt($s,i)}function wo(){Bt($s),Bt(gl),Bt(yl)}function Zm(r){Ca(yl.current);var i=Ca($s.current),c=Ut(i,r.type);i!==c&&(Mt(gl,r),Mt($s,c))}function dh(r){gl.current===r&&(Bt($s),Bt(gl))}var Yt=Ni(0);function Gc(r){for(var i=r;i!==null;){if(i.tag===13){var c=i.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||c.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===r)break;for(;i.sibling===null;){if(i.return===null||i.return===r)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var hh=[];function fh(){for(var r=0;r<hh.length;r++)hh[r]._workInProgressVersionPrimary=null;hh.length=0}var qc=ve.ReactCurrentDispatcher,ph=ve.ReactCurrentBatchConfig,Ia=0,Jt=null,Tn=null,Vn=null,Hc=!1,vl=!1,_l=0,Gw=0;function tr(){throw Error(t(321))}function mh(r,i){if(i===null)return!1;for(var c=0;c<i.length&&c<r.length;c++)if(!xs(r[c],i[c]))return!1;return!0}function gh(r,i,c,h,p,v){if(Ia=v,Jt=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,qc.current=r===null||r.memoizedState===null?Qw:Yw,r=c(h,p),vl){v=0;do{if(vl=!1,_l=0,25<=v)throw Error(t(301));v+=1,Vn=Tn=null,i.updateQueue=null,qc.current=Jw,r=c(h,p)}while(vl)}if(qc.current=Yc,i=Tn!==null&&Tn.next!==null,Ia=0,Vn=Tn=Jt=null,Hc=!1,i)throw Error(t(300));return r}function yh(){var r=_l!==0;return _l=0,r}function Bs(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Vn===null?Jt.memoizedState=Vn=r:Vn=Vn.next=r,Vn}function rs(){if(Tn===null){var r=Jt.alternate;r=r!==null?r.memoizedState:null}else r=Tn.next;var i=Vn===null?Jt.memoizedState:Vn.next;if(i!==null)Vn=i,Tn=r;else{if(r===null)throw Error(t(310));Tn=r,r={memoizedState:Tn.memoizedState,baseState:Tn.baseState,baseQueue:Tn.baseQueue,queue:Tn.queue,next:null},Vn===null?Jt.memoizedState=Vn=r:Vn=Vn.next=r}return Vn}function xl(r,i){return typeof i=="function"?i(r):i}function vh(r){var i=rs(),c=i.queue;if(c===null)throw Error(t(311));c.lastRenderedReducer=r;var h=Tn,p=h.baseQueue,v=c.pending;if(v!==null){if(p!==null){var S=p.next;p.next=v.next,v.next=S}h.baseQueue=p=v,c.pending=null}if(p!==null){v=p.next,h=h.baseState;var V=S=null,q=null,ae=v;do{var be=ae.lane;if((Ia&be)===be)q!==null&&(q=q.next={lane:0,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null}),h=ae.hasEagerState?ae.eagerState:r(h,ae.action);else{var Ne={lane:be,action:ae.action,hasEagerState:ae.hasEagerState,eagerState:ae.eagerState,next:null};q===null?(V=q=Ne,S=h):q=q.next=Ne,Jt.lanes|=be,Na|=be}ae=ae.next}while(ae!==null&&ae!==v);q===null?S=h:q.next=V,xs(h,i.memoizedState)||(Cr=!0),i.memoizedState=h,i.baseState=S,i.baseQueue=q,c.lastRenderedState=h}if(r=c.interleaved,r!==null){p=r;do v=p.lane,Jt.lanes|=v,Na|=v,p=p.next;while(p!==r)}else p===null&&(c.lanes=0);return[i.memoizedState,c.dispatch]}function _h(r){var i=rs(),c=i.queue;if(c===null)throw Error(t(311));c.lastRenderedReducer=r;var h=c.dispatch,p=c.pending,v=i.memoizedState;if(p!==null){c.pending=null;var S=p=p.next;do v=r(v,S.action),S=S.next;while(S!==p);xs(v,i.memoizedState)||(Cr=!0),i.memoizedState=v,i.baseQueue===null&&(i.baseState=v),c.lastRenderedState=v}return[v,h]}function eg(){}function tg(r,i){var c=Jt,h=rs(),p=i(),v=!xs(h.memoizedState,p);if(v&&(h.memoizedState=p,Cr=!0),h=h.queue,xh(sg.bind(null,c,h,r),[r]),h.getSnapshot!==i||v||Vn!==null&&Vn.memoizedState.tag&1){if(c.flags|=2048,wl(9,rg.bind(null,c,h,p,i),void 0,null),Ln===null)throw Error(t(349));(Ia&30)!==0||ng(c,i,p)}return p}function ng(r,i,c){r.flags|=16384,r={getSnapshot:i,value:c},i=Jt.updateQueue,i===null?(i={lastEffect:null,stores:null},Jt.updateQueue=i,i.stores=[r]):(c=i.stores,c===null?i.stores=[r]:c.push(r))}function rg(r,i,c,h){i.value=c,i.getSnapshot=h,ig(i)&&ag(r)}function sg(r,i,c){return c(function(){ig(i)&&ag(r)})}function ig(r){var i=r.getSnapshot;r=r.value;try{var c=i();return!xs(r,c)}catch{return!0}}function ag(r){var i=ai(r,1);i!==null&&bs(i,r,1,-1)}function og(r){var i=Bs();return typeof r=="function"&&(r=r()),i.memoizedState=i.baseState=r,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xl,lastRenderedState:r},i.queue=r,r=r.dispatch=Kw.bind(null,Jt,r),[i.memoizedState,r]}function wl(r,i,c,h){return r={tag:r,create:i,destroy:c,deps:h,next:null},i=Jt.updateQueue,i===null?(i={lastEffect:null,stores:null},Jt.updateQueue=i,i.lastEffect=r.next=r):(c=i.lastEffect,c===null?i.lastEffect=r.next=r:(h=c.next,c.next=r,r.next=h,i.lastEffect=r)),r}function lg(){return rs().memoizedState}function Kc(r,i,c,h){var p=Bs();Jt.flags|=r,p.memoizedState=wl(1|i,c,void 0,h===void 0?null:h)}function Qc(r,i,c,h){var p=rs();h=h===void 0?null:h;var v=void 0;if(Tn!==null){var S=Tn.memoizedState;if(v=S.destroy,h!==null&&mh(h,S.deps)){p.memoizedState=wl(i,c,v,h);return}}Jt.flags|=r,p.memoizedState=wl(1|i,c,v,h)}function cg(r,i){return Kc(8390656,8,r,i)}function xh(r,i){return Qc(2048,8,r,i)}function ug(r,i){return Qc(4,2,r,i)}function dg(r,i){return Qc(4,4,r,i)}function hg(r,i){if(typeof i=="function")return r=r(),i(r),function(){i(null)};if(i!=null)return r=r(),i.current=r,function(){i.current=null}}function fg(r,i,c){return c=c!=null?c.concat([r]):null,Qc(4,4,hg.bind(null,i,r),c)}function wh(){}function pg(r,i){var c=rs();i=i===void 0?null:i;var h=c.memoizedState;return h!==null&&i!==null&&mh(i,h[1])?h[0]:(c.memoizedState=[r,i],r)}function mg(r,i){var c=rs();i=i===void 0?null:i;var h=c.memoizedState;return h!==null&&i!==null&&mh(i,h[1])?h[0]:(r=r(),c.memoizedState=[r,i],r)}function gg(r,i,c){return(Ia&21)===0?(r.baseState&&(r.baseState=!1,Cr=!0),r.memoizedState=c):(xs(c,i)||(c=fr(),Jt.lanes|=c,Na|=c,r.baseState=!0),i)}function qw(r,i){var c=gt;gt=c!==0&&4>c?c:4,r(!0);var h=ph.transition;ph.transition={};try{r(!1),i()}finally{gt=c,ph.transition=h}}function yg(){return rs().memoizedState}function Hw(r,i,c){var h=Li(r);if(c={lane:h,action:c,hasEagerState:!1,eagerState:null,next:null},vg(r))_g(i,c);else if(c=Qm(r,i,c,h),c!==null){var p=vr();bs(c,r,h,p),xg(c,i,h)}}function Kw(r,i,c){var h=Li(r),p={lane:h,action:c,hasEagerState:!1,eagerState:null,next:null};if(vg(r))_g(i,p);else{var v=r.alternate;if(r.lanes===0&&(v===null||v.lanes===0)&&(v=i.lastRenderedReducer,v!==null))try{var S=i.lastRenderedState,V=v(S,c);if(p.hasEagerState=!0,p.eagerState=V,xs(V,S)){var q=i.interleaved;q===null?(p.next=p,lh(i)):(p.next=q.next,q.next=p),i.interleaved=p;return}}catch{}finally{}c=Qm(r,i,p,h),c!==null&&(p=vr(),bs(c,r,h,p),xg(c,i,h))}}function vg(r){var i=r.alternate;return r===Jt||i!==null&&i===Jt}function _g(r,i){vl=Hc=!0;var c=r.pending;c===null?i.next=i:(i.next=c.next,c.next=i),r.pending=i}function xg(r,i,c){if((c&4194240)!==0){var h=i.lanes;h&=r.pendingLanes,c|=h,i.lanes=c,Ms(r,c)}}var Yc={readContext:ns,useCallback:tr,useContext:tr,useEffect:tr,useImperativeHandle:tr,useInsertionEffect:tr,useLayoutEffect:tr,useMemo:tr,useReducer:tr,useRef:tr,useState:tr,useDebugValue:tr,useDeferredValue:tr,useTransition:tr,useMutableSource:tr,useSyncExternalStore:tr,useId:tr,unstable_isNewReconciler:!1},Qw={readContext:ns,useCallback:function(r,i){return Bs().memoizedState=[r,i===void 0?null:i],r},useContext:ns,useEffect:cg,useImperativeHandle:function(r,i,c){return c=c!=null?c.concat([r]):null,Kc(4194308,4,hg.bind(null,i,r),c)},useLayoutEffect:function(r,i){return Kc(4194308,4,r,i)},useInsertionEffect:function(r,i){return Kc(4,2,r,i)},useMemo:function(r,i){var c=Bs();return i=i===void 0?null:i,r=r(),c.memoizedState=[r,i],r},useReducer:function(r,i,c){var h=Bs();return i=c!==void 0?c(i):i,h.memoizedState=h.baseState=i,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:i},h.queue=r,r=r.dispatch=Hw.bind(null,Jt,r),[h.memoizedState,r]},useRef:function(r){var i=Bs();return r={current:r},i.memoizedState=r},useState:og,useDebugValue:wh,useDeferredValue:function(r){return Bs().memoizedState=r},useTransition:function(){var r=og(!1),i=r[0];return r=qw.bind(null,r[1]),Bs().memoizedState=r,[i,r]},useMutableSource:function(){},useSyncExternalStore:function(r,i,c){var h=Jt,p=Bs();if(Ht){if(c===void 0)throw Error(t(407));c=c()}else{if(c=i(),Ln===null)throw Error(t(349));(Ia&30)!==0||ng(h,i,c)}p.memoizedState=c;var v={value:c,getSnapshot:i};return p.queue=v,cg(sg.bind(null,h,v,r),[r]),h.flags|=2048,wl(9,rg.bind(null,h,v,c,i),void 0,null),c},useId:function(){var r=Bs(),i=Ln.identifierPrefix;if(Ht){var c=ii,h=si;c=(h&~(1<<32-ne(h)-1)).toString(32)+c,i=":"+i+"R"+c,c=_l++,0<c&&(i+="H"+c.toString(32)),i+=":"}else c=Gw++,i=":"+i+"r"+c.toString(32)+":";return r.memoizedState=i},unstable_isNewReconciler:!1},Yw={readContext:ns,useCallback:pg,useContext:ns,useEffect:xh,useImperativeHandle:fg,useInsertionEffect:ug,useLayoutEffect:dg,useMemo:mg,useReducer:vh,useRef:lg,useState:function(){return vh(xl)},useDebugValue:wh,useDeferredValue:function(r){var i=rs();return gg(i,Tn.memoizedState,r)},useTransition:function(){var r=vh(xl)[0],i=rs().memoizedState;return[r,i]},useMutableSource:eg,useSyncExternalStore:tg,useId:yg,unstable_isNewReconciler:!1},Jw={readContext:ns,useCallback:pg,useContext:ns,useEffect:xh,useImperativeHandle:fg,useInsertionEffect:ug,useLayoutEffect:dg,useMemo:mg,useReducer:_h,useRef:lg,useState:function(){return _h(xl)},useDebugValue:wh,useDeferredValue:function(r){var i=rs();return Tn===null?i.memoizedState=r:gg(i,Tn.memoizedState,r)},useTransition:function(){var r=_h(xl)[0],i=rs().memoizedState;return[r,i]},useMutableSource:eg,useSyncExternalStore:tg,useId:yg,unstable_isNewReconciler:!1};function Es(r,i){if(r&&r.defaultProps){i=xe({},i),r=r.defaultProps;for(var c in r)i[c]===void 0&&(i[c]=r[c]);return i}return i}function Eh(r,i,c,h){i=r.memoizedState,c=c(h,i),c=c==null?i:xe({},i,c),r.memoizedState=c,r.lanes===0&&(r.updateQueue.baseState=c)}var Jc={isMounted:function(r){return(r=r._reactInternals)?Rn(r)===r:!1},enqueueSetState:function(r,i,c){r=r._reactInternals;var h=vr(),p=Li(r),v=oi(h,p);v.payload=i,c!=null&&(v.callback=c),i=ji(r,v,p),i!==null&&(bs(i,r,p,h),Bc(i,r,p))},enqueueReplaceState:function(r,i,c){r=r._reactInternals;var h=vr(),p=Li(r),v=oi(h,p);v.tag=1,v.payload=i,c!=null&&(v.callback=c),i=ji(r,v,p),i!==null&&(bs(i,r,p,h),Bc(i,r,p))},enqueueForceUpdate:function(r,i){r=r._reactInternals;var c=vr(),h=Li(r),p=oi(c,h);p.tag=2,i!=null&&(p.callback=i),i=ji(r,p,h),i!==null&&(bs(i,r,h,c),Bc(i,r,h))}};function wg(r,i,c,h,p,v,S){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(h,v,S):i.prototype&&i.prototype.isPureReactComponent?!ol(c,h)||!ol(p,v):!0}function Eg(r,i,c){var h=!1,p=Pi,v=i.contextType;return typeof v=="object"&&v!==null?v=ns(v):(p=br(i)?Ea:er.current,h=i.contextTypes,v=(h=h!=null)?po(r,p):Pi),i=new i(c,v),r.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=Jc,r.stateNode=i,i._reactInternals=r,h&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=p,r.__reactInternalMemoizedMaskedChildContext=v),i}function Tg(r,i,c,h){r=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(c,h),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(c,h),i.state!==r&&Jc.enqueueReplaceState(i,i.state,null)}function Th(r,i,c,h){var p=r.stateNode;p.props=c,p.state=r.memoizedState,p.refs={},ch(r);var v=i.contextType;typeof v=="object"&&v!==null?p.context=ns(v):(v=br(i)?Ea:er.current,p.context=po(r,v)),p.state=r.memoizedState,v=i.getDerivedStateFromProps,typeof v=="function"&&(Eh(r,i,v,c),p.state=r.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(i=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),i!==p.state&&Jc.enqueueReplaceState(p,p.state,null),Wc(r,c,p,h),p.state=r.memoizedState),typeof p.componentDidMount=="function"&&(r.flags|=4194308)}function Eo(r,i){try{var c="",h=i;do c+=Ve(h),h=h.return;while(h);var p=c}catch(v){p=`
Error generating stack: `+v.message+`
`+v.stack}return{value:r,source:i,stack:p,digest:null}}function Sh(r,i,c){return{value:r,source:null,stack:c??null,digest:i??null}}function bh(r,i){try{console.error(i.value)}catch(c){setTimeout(function(){throw c})}}var Xw=typeof WeakMap=="function"?WeakMap:Map;function Sg(r,i,c){c=oi(-1,c),c.tag=3,c.payload={element:null};var h=i.value;return c.callback=function(){su||(su=!0,Uh=h),bh(r,i)},c}function bg(r,i,c){c=oi(-1,c),c.tag=3;var h=r.type.getDerivedStateFromError;if(typeof h=="function"){var p=i.value;c.payload=function(){return h(p)},c.callback=function(){bh(r,i)}}var v=r.stateNode;return v!==null&&typeof v.componentDidCatch=="function"&&(c.callback=function(){bh(r,i),typeof h!="function"&&(Di===null?Di=new Set([this]):Di.add(this));var S=i.stack;this.componentDidCatch(i.value,{componentStack:S!==null?S:""})}),c}function Cg(r,i,c){var h=r.pingCache;if(h===null){h=r.pingCache=new Xw;var p=new Set;h.set(i,p)}else p=h.get(i),p===void 0&&(p=new Set,h.set(i,p));p.has(c)||(p.add(c),r=hE.bind(null,r,i,c),i.then(r,r))}function Ig(r){do{var i;if((i=r.tag===13)&&(i=r.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return r;r=r.return}while(r!==null);return null}function Ng(r,i,c,h,p){return(r.mode&1)===0?(r===i?r.flags|=65536:(r.flags|=128,c.flags|=131072,c.flags&=-52805,c.tag===1&&(c.alternate===null?c.tag=17:(i=oi(-1,1),i.tag=2,ji(c,i,1))),c.lanes|=1),r):(r.flags|=65536,r.lanes=p,r)}var Zw=ve.ReactCurrentOwner,Cr=!1;function yr(r,i,c,h){i.child=r===null?Km(i,null,c,h):vo(i,r.child,c,h)}function Pg(r,i,c,h,p){c=c.render;var v=i.ref;return xo(i,p),h=gh(r,i,c,h,v,p),c=yh(),r!==null&&!Cr?(i.updateQueue=r.updateQueue,i.flags&=-2053,r.lanes&=~p,li(r,i,p)):(Ht&&c&&Zd(i),i.flags|=1,yr(r,i,h,p),i.child)}function Rg(r,i,c,h,p){if(r===null){var v=c.type;return typeof v=="function"&&!Hh(v)&&v.defaultProps===void 0&&c.compare===null&&c.defaultProps===void 0?(i.tag=15,i.type=v,Ag(r,i,v,h,p)):(r=uu(c.type,null,h,i,i.mode,p),r.ref=i.ref,r.return=i,i.child=r)}if(v=r.child,(r.lanes&p)===0){var S=v.memoizedProps;if(c=c.compare,c=c!==null?c:ol,c(S,h)&&r.ref===i.ref)return li(r,i,p)}return i.flags|=1,r=Oi(v,h),r.ref=i.ref,r.return=i,i.child=r}function Ag(r,i,c,h,p){if(r!==null){var v=r.memoizedProps;if(ol(v,h)&&r.ref===i.ref)if(Cr=!1,i.pendingProps=h=v,(r.lanes&p)!==0)(r.flags&131072)!==0&&(Cr=!0);else return i.lanes=r.lanes,li(r,i,p)}return Ch(r,i,c,h,p)}function jg(r,i,c){var h=i.pendingProps,p=h.children,v=r!==null?r.memoizedState:null;if(h.mode==="hidden")if((i.mode&1)===0)i.memoizedState={baseLanes:0,cachePool:null,transitions:null},Mt(So,zr),zr|=c;else{if((c&1073741824)===0)return r=v!==null?v.baseLanes|c:c,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:r,cachePool:null,transitions:null},i.updateQueue=null,Mt(So,zr),zr|=r,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},h=v!==null?v.baseLanes:c,Mt(So,zr),zr|=h}else v!==null?(h=v.baseLanes|c,i.memoizedState=null):h=c,Mt(So,zr),zr|=h;return yr(r,i,p,c),i.child}function kg(r,i){var c=i.ref;(r===null&&c!==null||r!==null&&r.ref!==c)&&(i.flags|=512,i.flags|=2097152)}function Ch(r,i,c,h,p){var v=br(c)?Ea:er.current;return v=po(i,v),xo(i,p),c=gh(r,i,c,h,v,p),h=yh(),r!==null&&!Cr?(i.updateQueue=r.updateQueue,i.flags&=-2053,r.lanes&=~p,li(r,i,p)):(Ht&&h&&Zd(i),i.flags|=1,yr(r,i,c,p),i.child)}function Dg(r,i,c,h,p){if(br(c)){var v=!0;Vc(i)}else v=!1;if(xo(i,p),i.stateNode===null)Zc(r,i),Eg(i,c,h),Th(i,c,h,p),h=!0;else if(r===null){var S=i.stateNode,V=i.memoizedProps;S.props=V;var q=S.context,ae=c.contextType;typeof ae=="object"&&ae!==null?ae=ns(ae):(ae=br(c)?Ea:er.current,ae=po(i,ae));var be=c.getDerivedStateFromProps,Ne=typeof be=="function"||typeof S.getSnapshotBeforeUpdate=="function";Ne||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(V!==h||q!==ae)&&Tg(i,S,h,ae),Ai=!1;var Ee=i.memoizedState;S.state=Ee,Wc(i,h,S,p),q=i.memoizedState,V!==h||Ee!==q||Sr.current||Ai?(typeof be=="function"&&(Eh(i,c,be,h),q=i.memoizedState),(V=Ai||wg(i,c,V,h,Ee,q,ae))?(Ne||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount()),typeof S.componentDidMount=="function"&&(i.flags|=4194308)):(typeof S.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=h,i.memoizedState=q),S.props=h,S.state=q,S.context=ae,h=V):(typeof S.componentDidMount=="function"&&(i.flags|=4194308),h=!1)}else{S=i.stateNode,Ym(r,i),V=i.memoizedProps,ae=i.type===i.elementType?V:Es(i.type,V),S.props=ae,Ne=i.pendingProps,Ee=S.context,q=c.contextType,typeof q=="object"&&q!==null?q=ns(q):(q=br(c)?Ea:er.current,q=po(i,q));var Ue=c.getDerivedStateFromProps;(be=typeof Ue=="function"||typeof S.getSnapshotBeforeUpdate=="function")||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(V!==Ne||Ee!==q)&&Tg(i,S,h,q),Ai=!1,Ee=i.memoizedState,S.state=Ee,Wc(i,h,S,p);var Be=i.memoizedState;V!==Ne||Ee!==Be||Sr.current||Ai?(typeof Ue=="function"&&(Eh(i,c,Ue,h),Be=i.memoizedState),(ae=Ai||wg(i,c,ae,h,Ee,Be,q)||!1)?(be||typeof S.UNSAFE_componentWillUpdate!="function"&&typeof S.componentWillUpdate!="function"||(typeof S.componentWillUpdate=="function"&&S.componentWillUpdate(h,Be,q),typeof S.UNSAFE_componentWillUpdate=="function"&&S.UNSAFE_componentWillUpdate(h,Be,q)),typeof S.componentDidUpdate=="function"&&(i.flags|=4),typeof S.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof S.componentDidUpdate!="function"||V===r.memoizedProps&&Ee===r.memoizedState||(i.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||V===r.memoizedProps&&Ee===r.memoizedState||(i.flags|=1024),i.memoizedProps=h,i.memoizedState=Be),S.props=h,S.state=Be,S.context=q,h=ae):(typeof S.componentDidUpdate!="function"||V===r.memoizedProps&&Ee===r.memoizedState||(i.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||V===r.memoizedProps&&Ee===r.memoizedState||(i.flags|=1024),h=!1)}return Ih(r,i,c,h,v,p)}function Ih(r,i,c,h,p,v){kg(r,i);var S=(i.flags&128)!==0;if(!h&&!S)return p&&Fm(i,c,!1),li(r,i,v);h=i.stateNode,Zw.current=i;var V=S&&typeof c.getDerivedStateFromError!="function"?null:h.render();return i.flags|=1,r!==null&&S?(i.child=vo(i,r.child,null,v),i.child=vo(i,null,V,v)):yr(r,i,V,v),i.memoizedState=h.state,p&&Fm(i,c,!0),i.child}function Vg(r){var i=r.stateNode;i.pendingContext?Mm(r,i.pendingContext,i.pendingContext!==i.context):i.context&&Mm(r,i.context,!1),uh(r,i.containerInfo)}function Lg(r,i,c,h,p){return yo(),rh(p),i.flags|=256,yr(r,i,c,h),i.child}var Nh={dehydrated:null,treeContext:null,retryLane:0};function Ph(r){return{baseLanes:r,cachePool:null,transitions:null}}function Mg(r,i,c){var h=i.pendingProps,p=Yt.current,v=!1,S=(i.flags&128)!==0,V;if((V=S)||(V=r!==null&&r.memoizedState===null?!1:(p&2)!==0),V?(v=!0,i.flags&=-129):(r===null||r.memoizedState!==null)&&(p|=1),Mt(Yt,p&1),r===null)return nh(i),r=i.memoizedState,r!==null&&(r=r.dehydrated,r!==null)?((i.mode&1)===0?i.lanes=1:r.data==="$!"?i.lanes=8:i.lanes=1073741824,null):(S=h.children,r=h.fallback,v?(h=i.mode,v=i.child,S={mode:"hidden",children:S},(h&1)===0&&v!==null?(v.childLanes=0,v.pendingProps=S):v=du(S,h,0,null),r=ja(r,h,c,null),v.return=i,r.return=i,v.sibling=r,i.child=v,i.child.memoizedState=Ph(c),i.memoizedState=Nh,r):Rh(i,S));if(p=r.memoizedState,p!==null&&(V=p.dehydrated,V!==null))return eE(r,i,S,h,V,p,c);if(v){v=h.fallback,S=i.mode,p=r.child,V=p.sibling;var q={mode:"hidden",children:h.children};return(S&1)===0&&i.child!==p?(h=i.child,h.childLanes=0,h.pendingProps=q,i.deletions=null):(h=Oi(p,q),h.subtreeFlags=p.subtreeFlags&14680064),V!==null?v=Oi(V,v):(v=ja(v,S,c,null),v.flags|=2),v.return=i,h.return=i,h.sibling=v,i.child=h,h=v,v=i.child,S=r.child.memoizedState,S=S===null?Ph(c):{baseLanes:S.baseLanes|c,cachePool:null,transitions:S.transitions},v.memoizedState=S,v.childLanes=r.childLanes&~c,i.memoizedState=Nh,h}return v=r.child,r=v.sibling,h=Oi(v,{mode:"visible",children:h.children}),(i.mode&1)===0&&(h.lanes=c),h.return=i,h.sibling=null,r!==null&&(c=i.deletions,c===null?(i.deletions=[r],i.flags|=16):c.push(r)),i.child=h,i.memoizedState=null,h}function Rh(r,i){return i=du({mode:"visible",children:i},r.mode,0,null),i.return=r,r.child=i}function Xc(r,i,c,h){return h!==null&&rh(h),vo(i,r.child,null,c),r=Rh(i,i.pendingProps.children),r.flags|=2,i.memoizedState=null,r}function eE(r,i,c,h,p,v,S){if(c)return i.flags&256?(i.flags&=-257,h=Sh(Error(t(422))),Xc(r,i,S,h)):i.memoizedState!==null?(i.child=r.child,i.flags|=128,null):(v=h.fallback,p=i.mode,h=du({mode:"visible",children:h.children},p,0,null),v=ja(v,p,S,null),v.flags|=2,h.return=i,v.return=i,h.sibling=v,i.child=h,(i.mode&1)!==0&&vo(i,r.child,null,S),i.child.memoizedState=Ph(S),i.memoizedState=Nh,v);if((i.mode&1)===0)return Xc(r,i,S,null);if(p.data==="$!"){if(h=p.nextSibling&&p.nextSibling.dataset,h)var V=h.dgst;return h=V,v=Error(t(419)),h=Sh(v,h,void 0),Xc(r,i,S,h)}if(V=(S&r.childLanes)!==0,Cr||V){if(h=Ln,h!==null){switch(S&-S){case 4:p=2;break;case 16:p=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:p=32;break;case 536870912:p=268435456;break;default:p=0}p=(p&(h.suspendedLanes|S))!==0?0:p,p!==0&&p!==v.retryLane&&(v.retryLane=p,ai(r,p),bs(h,r,p,-1))}return qh(),h=Sh(Error(t(421))),Xc(r,i,S,h)}return p.data==="$?"?(i.flags|=128,i.child=r.child,i=fE.bind(null,r),p._reactRetry=i,null):(r=v.treeContext,Ur=Ii(p.nextSibling),Fr=i,Ht=!0,ws=null,r!==null&&(es[ts++]=si,es[ts++]=ii,es[ts++]=Ta,si=r.id,ii=r.overflow,Ta=i),i=Rh(i,h.children),i.flags|=4096,i)}function Og(r,i,c){r.lanes|=i;var h=r.alternate;h!==null&&(h.lanes|=i),oh(r.return,i,c)}function Ah(r,i,c,h,p){var v=r.memoizedState;v===null?r.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:h,tail:c,tailMode:p}:(v.isBackwards=i,v.rendering=null,v.renderingStartTime=0,v.last=h,v.tail=c,v.tailMode=p)}function Fg(r,i,c){var h=i.pendingProps,p=h.revealOrder,v=h.tail;if(yr(r,i,h.children,c),h=Yt.current,(h&2)!==0)h=h&1|2,i.flags|=128;else{if(r!==null&&(r.flags&128)!==0)e:for(r=i.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&Og(r,c,i);else if(r.tag===19)Og(r,c,i);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===i)break e;for(;r.sibling===null;){if(r.return===null||r.return===i)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}h&=1}if(Mt(Yt,h),(i.mode&1)===0)i.memoizedState=null;else switch(p){case"forwards":for(c=i.child,p=null;c!==null;)r=c.alternate,r!==null&&Gc(r)===null&&(p=c),c=c.sibling;c=p,c===null?(p=i.child,i.child=null):(p=c.sibling,c.sibling=null),Ah(i,!1,p,c,v);break;case"backwards":for(c=null,p=i.child,i.child=null;p!==null;){if(r=p.alternate,r!==null&&Gc(r)===null){i.child=p;break}r=p.sibling,p.sibling=c,c=p,p=r}Ah(i,!0,c,null,v);break;case"together":Ah(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function Zc(r,i){(i.mode&1)===0&&r!==null&&(r.alternate=null,i.alternate=null,i.flags|=2)}function li(r,i,c){if(r!==null&&(i.dependencies=r.dependencies),Na|=i.lanes,(c&i.childLanes)===0)return null;if(r!==null&&i.child!==r.child)throw Error(t(153));if(i.child!==null){for(r=i.child,c=Oi(r,r.pendingProps),i.child=c,c.return=i;r.sibling!==null;)r=r.sibling,c=c.sibling=Oi(r,r.pendingProps),c.return=i;c.sibling=null}return i.child}function tE(r,i,c){switch(i.tag){case 3:Vg(i),yo();break;case 5:Zm(i);break;case 1:br(i.type)&&Vc(i);break;case 4:uh(i,i.stateNode.containerInfo);break;case 10:var h=i.type._context,p=i.memoizedProps.value;Mt(zc,h._currentValue),h._currentValue=p;break;case 13:if(h=i.memoizedState,h!==null)return h.dehydrated!==null?(Mt(Yt,Yt.current&1),i.flags|=128,null):(c&i.child.childLanes)!==0?Mg(r,i,c):(Mt(Yt,Yt.current&1),r=li(r,i,c),r!==null?r.sibling:null);Mt(Yt,Yt.current&1);break;case 19:if(h=(c&i.childLanes)!==0,(r.flags&128)!==0){if(h)return Fg(r,i,c);i.flags|=128}if(p=i.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),Mt(Yt,Yt.current),h)break;return null;case 22:case 23:return i.lanes=0,jg(r,i,c)}return li(r,i,c)}var Ug,jh,zg,$g;Ug=function(r,i){for(var c=i.child;c!==null;){if(c.tag===5||c.tag===6)r.appendChild(c.stateNode);else if(c.tag!==4&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===i)break;for(;c.sibling===null;){if(c.return===null||c.return===i)return;c=c.return}c.sibling.return=c.return,c=c.sibling}},jh=function(){},zg=function(r,i,c,h){var p=r.memoizedProps;if(p!==h){r=i.stateNode,Ca($s.current);var v=null;switch(c){case"input":p=qe(r,p),h=qe(r,h),v=[];break;case"select":p=xe({},p,{value:void 0}),h=xe({},h,{value:void 0}),v=[];break;case"textarea":p=Fn(r,p),h=Fn(r,h),v=[];break;default:typeof p.onClick!="function"&&typeof h.onClick=="function"&&(r.onclick=jc)}Vr(c,h);var S;c=null;for(ae in p)if(!h.hasOwnProperty(ae)&&p.hasOwnProperty(ae)&&p[ae]!=null)if(ae==="style"){var V=p[ae];for(S in V)V.hasOwnProperty(S)&&(c||(c={}),c[S]="")}else ae!=="dangerouslySetInnerHTML"&&ae!=="children"&&ae!=="suppressContentEditableWarning"&&ae!=="suppressHydrationWarning"&&ae!=="autoFocus"&&(a.hasOwnProperty(ae)?v||(v=[]):(v=v||[]).push(ae,null));for(ae in h){var q=h[ae];if(V=p!=null?p[ae]:void 0,h.hasOwnProperty(ae)&&q!==V&&(q!=null||V!=null))if(ae==="style")if(V){for(S in V)!V.hasOwnProperty(S)||q&&q.hasOwnProperty(S)||(c||(c={}),c[S]="");for(S in q)q.hasOwnProperty(S)&&V[S]!==q[S]&&(c||(c={}),c[S]=q[S])}else c||(v||(v=[]),v.push(ae,c)),c=q;else ae==="dangerouslySetInnerHTML"?(q=q?q.__html:void 0,V=V?V.__html:void 0,q!=null&&V!==q&&(v=v||[]).push(ae,q)):ae==="children"?typeof q!="string"&&typeof q!="number"||(v=v||[]).push(ae,""+q):ae!=="suppressContentEditableWarning"&&ae!=="suppressHydrationWarning"&&(a.hasOwnProperty(ae)?(q!=null&&ae==="onScroll"&&$t("scroll",r),v||V===q||(v=[])):(v=v||[]).push(ae,q))}c&&(v=v||[]).push("style",c);var ae=v;(i.updateQueue=ae)&&(i.flags|=4)}},$g=function(r,i,c,h){c!==h&&(i.flags|=4)};function El(r,i){if(!Ht)switch(r.tailMode){case"hidden":i=r.tail;for(var c=null;i!==null;)i.alternate!==null&&(c=i),i=i.sibling;c===null?r.tail=null:c.sibling=null;break;case"collapsed":c=r.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?i||r.tail===null?r.tail=null:r.tail.sibling=null:h.sibling=null}}function nr(r){var i=r.alternate!==null&&r.alternate.child===r.child,c=0,h=0;if(i)for(var p=r.child;p!==null;)c|=p.lanes|p.childLanes,h|=p.subtreeFlags&14680064,h|=p.flags&14680064,p.return=r,p=p.sibling;else for(p=r.child;p!==null;)c|=p.lanes|p.childLanes,h|=p.subtreeFlags,h|=p.flags,p.return=r,p=p.sibling;return r.subtreeFlags|=h,r.childLanes=c,i}function nE(r,i,c){var h=i.pendingProps;switch(eh(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return nr(i),null;case 1:return br(i.type)&&Dc(),nr(i),null;case 3:return h=i.stateNode,wo(),Bt(Sr),Bt(er),fh(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(r===null||r.child===null)&&(Fc(i)?i.flags|=4:r===null||r.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,ws!==null&&(Bh(ws),ws=null))),jh(r,i),nr(i),null;case 5:dh(i);var p=Ca(yl.current);if(c=i.type,r!==null&&i.stateNode!=null)zg(r,i,c,h,p),r.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!h){if(i.stateNode===null)throw Error(t(166));return nr(i),null}if(r=Ca($s.current),Fc(i)){h=i.stateNode,c=i.type;var v=i.memoizedProps;switch(h[zs]=i,h[hl]=v,r=(i.mode&1)!==0,c){case"dialog":$t("cancel",h),$t("close",h);break;case"iframe":case"object":case"embed":$t("load",h);break;case"video":case"audio":for(p=0;p<cl.length;p++)$t(cl[p],h);break;case"source":$t("error",h);break;case"img":case"image":case"link":$t("error",h),$t("load",h);break;case"details":$t("toggle",h);break;case"input":Ye(h,v),$t("invalid",h);break;case"select":h._wrapperState={wasMultiple:!!v.multiple},$t("invalid",h);break;case"textarea":lr(h,v),$t("invalid",h)}Vr(c,v),p=null;for(var S in v)if(v.hasOwnProperty(S)){var V=v[S];S==="children"?typeof V=="string"?h.textContent!==V&&(v.suppressHydrationWarning!==!0&&Ac(h.textContent,V,r),p=["children",V]):typeof V=="number"&&h.textContent!==""+V&&(v.suppressHydrationWarning!==!0&&Ac(h.textContent,V,r),p=["children",""+V]):a.hasOwnProperty(S)&&V!=null&&S==="onScroll"&&$t("scroll",h)}switch(c){case"input":le(h),wt(h,v,!0);break;case"textarea":le(h),Kn(h);break;case"select":case"option":break;default:typeof v.onClick=="function"&&(h.onclick=jc)}h=p,i.updateQueue=h,h!==null&&(i.flags|=4)}else{S=p.nodeType===9?p:p.ownerDocument,r==="http://www.w3.org/1999/xhtml"&&(r=Ft(c)),r==="http://www.w3.org/1999/xhtml"?c==="script"?(r=S.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild)):typeof h.is=="string"?r=S.createElement(c,{is:h.is}):(r=S.createElement(c),c==="select"&&(S=r,h.multiple?S.multiple=!0:h.size&&(S.size=h.size))):r=S.createElementNS(r,c),r[zs]=i,r[hl]=h,Ug(r,i,!1,!1),i.stateNode=r;e:{switch(S=_r(c,h),c){case"dialog":$t("cancel",r),$t("close",r),p=h;break;case"iframe":case"object":case"embed":$t("load",r),p=h;break;case"video":case"audio":for(p=0;p<cl.length;p++)$t(cl[p],r);p=h;break;case"source":$t("error",r),p=h;break;case"img":case"image":case"link":$t("error",r),$t("load",r),p=h;break;case"details":$t("toggle",r),p=h;break;case"input":Ye(r,h),p=qe(r,h),$t("invalid",r);break;case"option":p=h;break;case"select":r._wrapperState={wasMultiple:!!h.multiple},p=xe({},h,{value:void 0}),$t("invalid",r);break;case"textarea":lr(r,h),p=Fn(r,h),$t("invalid",r);break;default:p=h}Vr(c,p),V=p;for(v in V)if(V.hasOwnProperty(v)){var q=V[v];v==="style"?cr(r,q):v==="dangerouslySetInnerHTML"?(q=q?q.__html:void 0,q!=null&&Qn(r,q)):v==="children"?typeof q=="string"?(c!=="textarea"||q!=="")&&In(r,q):typeof q=="number"&&In(r,""+q):v!=="suppressContentEditableWarning"&&v!=="suppressHydrationWarning"&&v!=="autoFocus"&&(a.hasOwnProperty(v)?q!=null&&v==="onScroll"&&$t("scroll",r):q!=null&&_e(r,v,q,S))}switch(c){case"input":le(r),wt(r,h,!1);break;case"textarea":le(r),Kn(r);break;case"option":h.value!=null&&r.setAttribute("value",""+Qe(h.value));break;case"select":r.multiple=!!h.multiple,v=h.value,v!=null?un(r,!!h.multiple,v,!1):h.defaultValue!=null&&un(r,!!h.multiple,h.defaultValue,!0);break;default:typeof p.onClick=="function"&&(r.onclick=jc)}switch(c){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}}h&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return nr(i),null;case 6:if(r&&i.stateNode!=null)$g(r,i,r.memoizedProps,h);else{if(typeof h!="string"&&i.stateNode===null)throw Error(t(166));if(c=Ca(yl.current),Ca($s.current),Fc(i)){if(h=i.stateNode,c=i.memoizedProps,h[zs]=i,(v=h.nodeValue!==c)&&(r=Fr,r!==null))switch(r.tag){case 3:Ac(h.nodeValue,c,(r.mode&1)!==0);break;case 5:r.memoizedProps.suppressHydrationWarning!==!0&&Ac(h.nodeValue,c,(r.mode&1)!==0)}v&&(i.flags|=4)}else h=(c.nodeType===9?c:c.ownerDocument).createTextNode(h),h[zs]=i,i.stateNode=h}return nr(i),null;case 13:if(Bt(Yt),h=i.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(Ht&&Ur!==null&&(i.mode&1)!==0&&(i.flags&128)===0)Gm(),yo(),i.flags|=98560,v=!1;else if(v=Fc(i),h!==null&&h.dehydrated!==null){if(r===null){if(!v)throw Error(t(318));if(v=i.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(t(317));v[zs]=i}else yo(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;nr(i),v=!1}else ws!==null&&(Bh(ws),ws=null),v=!0;if(!v)return i.flags&65536?i:null}return(i.flags&128)!==0?(i.lanes=c,i):(h=h!==null,h!==(r!==null&&r.memoizedState!==null)&&h&&(i.child.flags|=8192,(i.mode&1)!==0&&(r===null||(Yt.current&1)!==0?Sn===0&&(Sn=3):qh())),i.updateQueue!==null&&(i.flags|=4),nr(i),null);case 4:return wo(),jh(r,i),r===null&&ul(i.stateNode.containerInfo),nr(i),null;case 10:return ah(i.type._context),nr(i),null;case 17:return br(i.type)&&Dc(),nr(i),null;case 19:if(Bt(Yt),v=i.memoizedState,v===null)return nr(i),null;if(h=(i.flags&128)!==0,S=v.rendering,S===null)if(h)El(v,!1);else{if(Sn!==0||r!==null&&(r.flags&128)!==0)for(r=i.child;r!==null;){if(S=Gc(r),S!==null){for(i.flags|=128,El(v,!1),h=S.updateQueue,h!==null&&(i.updateQueue=h,i.flags|=4),i.subtreeFlags=0,h=c,c=i.child;c!==null;)v=c,r=h,v.flags&=14680066,S=v.alternate,S===null?(v.childLanes=0,v.lanes=r,v.child=null,v.subtreeFlags=0,v.memoizedProps=null,v.memoizedState=null,v.updateQueue=null,v.dependencies=null,v.stateNode=null):(v.childLanes=S.childLanes,v.lanes=S.lanes,v.child=S.child,v.subtreeFlags=0,v.deletions=null,v.memoizedProps=S.memoizedProps,v.memoizedState=S.memoizedState,v.updateQueue=S.updateQueue,v.type=S.type,r=S.dependencies,v.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),c=c.sibling;return Mt(Yt,Yt.current&1|2),i.child}r=r.sibling}v.tail!==null&&ft()>bo&&(i.flags|=128,h=!0,El(v,!1),i.lanes=4194304)}else{if(!h)if(r=Gc(S),r!==null){if(i.flags|=128,h=!0,c=r.updateQueue,c!==null&&(i.updateQueue=c,i.flags|=4),El(v,!0),v.tail===null&&v.tailMode==="hidden"&&!S.alternate&&!Ht)return nr(i),null}else 2*ft()-v.renderingStartTime>bo&&c!==1073741824&&(i.flags|=128,h=!0,El(v,!1),i.lanes=4194304);v.isBackwards?(S.sibling=i.child,i.child=S):(c=v.last,c!==null?c.sibling=S:i.child=S,v.last=S)}return v.tail!==null?(i=v.tail,v.rendering=i,v.tail=i.sibling,v.renderingStartTime=ft(),i.sibling=null,c=Yt.current,Mt(Yt,h?c&1|2:c&1),i):(nr(i),null);case 22:case 23:return Gh(),h=i.memoizedState!==null,r!==null&&r.memoizedState!==null!==h&&(i.flags|=8192),h&&(i.mode&1)!==0?(zr&1073741824)!==0&&(nr(i),i.subtreeFlags&6&&(i.flags|=8192)):nr(i),null;case 24:return null;case 25:return null}throw Error(t(156,i.tag))}function rE(r,i){switch(eh(i),i.tag){case 1:return br(i.type)&&Dc(),r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 3:return wo(),Bt(Sr),Bt(er),fh(),r=i.flags,(r&65536)!==0&&(r&128)===0?(i.flags=r&-65537|128,i):null;case 5:return dh(i),null;case 13:if(Bt(Yt),r=i.memoizedState,r!==null&&r.dehydrated!==null){if(i.alternate===null)throw Error(t(340));yo()}return r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 19:return Bt(Yt),null;case 4:return wo(),null;case 10:return ah(i.type._context),null;case 22:case 23:return Gh(),null;case 24:return null;default:return null}}var eu=!1,rr=!1,sE=typeof WeakSet=="function"?WeakSet:Set,$e=null;function To(r,i){var c=r.ref;if(c!==null)if(typeof c=="function")try{c(null)}catch(h){tn(r,i,h)}else c.current=null}function kh(r,i,c){try{c()}catch(h){tn(r,i,h)}}var Bg=!1;function iE(r,i){if(Gd=St,r=wm(),Md(r)){if("selectionStart"in r)var c={start:r.selectionStart,end:r.selectionEnd};else e:{c=(c=r.ownerDocument)&&c.defaultView||window;var h=c.getSelection&&c.getSelection();if(h&&h.rangeCount!==0){c=h.anchorNode;var p=h.anchorOffset,v=h.focusNode;h=h.focusOffset;try{c.nodeType,v.nodeType}catch{c=null;break e}var S=0,V=-1,q=-1,ae=0,be=0,Ne=r,Ee=null;t:for(;;){for(var Ue;Ne!==c||p!==0&&Ne.nodeType!==3||(V=S+p),Ne!==v||h!==0&&Ne.nodeType!==3||(q=S+h),Ne.nodeType===3&&(S+=Ne.nodeValue.length),(Ue=Ne.firstChild)!==null;)Ee=Ne,Ne=Ue;for(;;){if(Ne===r)break t;if(Ee===c&&++ae===p&&(V=S),Ee===v&&++be===h&&(q=S),(Ue=Ne.nextSibling)!==null)break;Ne=Ee,Ee=Ne.parentNode}Ne=Ue}c=V===-1||q===-1?null:{start:V,end:q}}else c=null}c=c||{start:0,end:0}}else c=null;for(qd={focusedElem:r,selectionRange:c},St=!1,$e=i;$e!==null;)if(i=$e,r=i.child,(i.subtreeFlags&1028)!==0&&r!==null)r.return=i,$e=r;else for(;$e!==null;){i=$e;try{var Be=i.alternate;if((i.flags&1024)!==0)switch(i.tag){case 0:case 11:case 15:break;case 1:if(Be!==null){var Ge=Be.memoizedProps,on=Be.memoizedState,ee=i.stateNode,Q=ee.getSnapshotBeforeUpdate(i.elementType===i.type?Ge:Es(i.type,Ge),on);ee.__reactInternalSnapshotBeforeUpdate=Q}break;case 3:var te=i.stateNode.containerInfo;te.nodeType===1?te.textContent="":te.nodeType===9&&te.documentElement&&te.removeChild(te.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(ke){tn(i,i.return,ke)}if(r=i.sibling,r!==null){r.return=i.return,$e=r;break}$e=i.return}return Be=Bg,Bg=!1,Be}function Tl(r,i,c){var h=i.updateQueue;if(h=h!==null?h.lastEffect:null,h!==null){var p=h=h.next;do{if((p.tag&r)===r){var v=p.destroy;p.destroy=void 0,v!==void 0&&kh(i,c,v)}p=p.next}while(p!==h)}}function tu(r,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var c=i=i.next;do{if((c.tag&r)===r){var h=c.create;c.destroy=h()}c=c.next}while(c!==i)}}function Dh(r){var i=r.ref;if(i!==null){var c=r.stateNode;switch(r.tag){case 5:r=c;break;default:r=c}typeof i=="function"?i(r):i.current=r}}function Wg(r){var i=r.alternate;i!==null&&(r.alternate=null,Wg(i)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(i=r.stateNode,i!==null&&(delete i[zs],delete i[hl],delete i[Yd],delete i[zw],delete i[$w])),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}function Gg(r){return r.tag===5||r.tag===3||r.tag===4}function qg(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||Gg(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Vh(r,i,c){var h=r.tag;if(h===5||h===6)r=r.stateNode,i?c.nodeType===8?c.parentNode.insertBefore(r,i):c.insertBefore(r,i):(c.nodeType===8?(i=c.parentNode,i.insertBefore(r,c)):(i=c,i.appendChild(r)),c=c._reactRootContainer,c!=null||i.onclick!==null||(i.onclick=jc));else if(h!==4&&(r=r.child,r!==null))for(Vh(r,i,c),r=r.sibling;r!==null;)Vh(r,i,c),r=r.sibling}function Lh(r,i,c){var h=r.tag;if(h===5||h===6)r=r.stateNode,i?c.insertBefore(r,i):c.appendChild(r);else if(h!==4&&(r=r.child,r!==null))for(Lh(r,i,c),r=r.sibling;r!==null;)Lh(r,i,c),r=r.sibling}var Bn=null,Ts=!1;function ki(r,i,c){for(c=c.child;c!==null;)Hg(r,i,c),c=c.sibling}function Hg(r,i,c){if(G&&typeof G.onCommitFiberUnmount=="function")try{G.onCommitFiberUnmount(M,c)}catch{}switch(c.tag){case 5:rr||To(c,i);case 6:var h=Bn,p=Ts;Bn=null,ki(r,i,c),Bn=h,Ts=p,Bn!==null&&(Ts?(r=Bn,c=c.stateNode,r.nodeType===8?r.parentNode.removeChild(c):r.removeChild(c)):Bn.removeChild(c.stateNode));break;case 18:Bn!==null&&(Ts?(r=Bn,c=c.stateNode,r.nodeType===8?Qd(r.parentNode,c):r.nodeType===1&&Qd(r,c),rt(r)):Qd(Bn,c.stateNode));break;case 4:h=Bn,p=Ts,Bn=c.stateNode.containerInfo,Ts=!0,ki(r,i,c),Bn=h,Ts=p;break;case 0:case 11:case 14:case 15:if(!rr&&(h=c.updateQueue,h!==null&&(h=h.lastEffect,h!==null))){p=h=h.next;do{var v=p,S=v.destroy;v=v.tag,S!==void 0&&((v&2)!==0||(v&4)!==0)&&kh(c,i,S),p=p.next}while(p!==h)}ki(r,i,c);break;case 1:if(!rr&&(To(c,i),h=c.stateNode,typeof h.componentWillUnmount=="function"))try{h.props=c.memoizedProps,h.state=c.memoizedState,h.componentWillUnmount()}catch(V){tn(c,i,V)}ki(r,i,c);break;case 21:ki(r,i,c);break;case 22:c.mode&1?(rr=(h=rr)||c.memoizedState!==null,ki(r,i,c),rr=h):ki(r,i,c);break;default:ki(r,i,c)}}function Kg(r){var i=r.updateQueue;if(i!==null){r.updateQueue=null;var c=r.stateNode;c===null&&(c=r.stateNode=new sE),i.forEach(function(h){var p=pE.bind(null,r,h);c.has(h)||(c.add(h),h.then(p,p))})}}function Ss(r,i){var c=i.deletions;if(c!==null)for(var h=0;h<c.length;h++){var p=c[h];try{var v=r,S=i,V=S;e:for(;V!==null;){switch(V.tag){case 5:Bn=V.stateNode,Ts=!1;break e;case 3:Bn=V.stateNode.containerInfo,Ts=!0;break e;case 4:Bn=V.stateNode.containerInfo,Ts=!0;break e}V=V.return}if(Bn===null)throw Error(t(160));Hg(v,S,p),Bn=null,Ts=!1;var q=p.alternate;q!==null&&(q.return=null),p.return=null}catch(ae){tn(p,i,ae)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)Qg(i,r),i=i.sibling}function Qg(r,i){var c=r.alternate,h=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:if(Ss(i,r),Ws(r),h&4){try{Tl(3,r,r.return),tu(3,r)}catch(Ge){tn(r,r.return,Ge)}try{Tl(5,r,r.return)}catch(Ge){tn(r,r.return,Ge)}}break;case 1:Ss(i,r),Ws(r),h&512&&c!==null&&To(c,c.return);break;case 5:if(Ss(i,r),Ws(r),h&512&&c!==null&&To(c,c.return),r.flags&32){var p=r.stateNode;try{In(p,"")}catch(Ge){tn(r,r.return,Ge)}}if(h&4&&(p=r.stateNode,p!=null)){var v=r.memoizedProps,S=c!==null?c.memoizedProps:v,V=r.type,q=r.updateQueue;if(r.updateQueue=null,q!==null)try{V==="input"&&v.type==="radio"&&v.name!=null&&It(p,v),_r(V,S);var ae=_r(V,v);for(S=0;S<q.length;S+=2){var be=q[S],Ne=q[S+1];be==="style"?cr(p,Ne):be==="dangerouslySetInnerHTML"?Qn(p,Ne):be==="children"?In(p,Ne):_e(p,be,Ne,ae)}switch(V){case"input":At(p,v);break;case"textarea":Gt(p,v);break;case"select":var Ee=p._wrapperState.wasMultiple;p._wrapperState.wasMultiple=!!v.multiple;var Ue=v.value;Ue!=null?un(p,!!v.multiple,Ue,!1):Ee!==!!v.multiple&&(v.defaultValue!=null?un(p,!!v.multiple,v.defaultValue,!0):un(p,!!v.multiple,v.multiple?[]:"",!1))}p[hl]=v}catch(Ge){tn(r,r.return,Ge)}}break;case 6:if(Ss(i,r),Ws(r),h&4){if(r.stateNode===null)throw Error(t(162));p=r.stateNode,v=r.memoizedProps;try{p.nodeValue=v}catch(Ge){tn(r,r.return,Ge)}}break;case 3:if(Ss(i,r),Ws(r),h&4&&c!==null&&c.memoizedState.isDehydrated)try{rt(i.containerInfo)}catch(Ge){tn(r,r.return,Ge)}break;case 4:Ss(i,r),Ws(r);break;case 13:Ss(i,r),Ws(r),p=r.child,p.flags&8192&&(v=p.memoizedState!==null,p.stateNode.isHidden=v,!v||p.alternate!==null&&p.alternate.memoizedState!==null||(Fh=ft())),h&4&&Kg(r);break;case 22:if(be=c!==null&&c.memoizedState!==null,r.mode&1?(rr=(ae=rr)||be,Ss(i,r),rr=ae):Ss(i,r),Ws(r),h&8192){if(ae=r.memoizedState!==null,(r.stateNode.isHidden=ae)&&!be&&(r.mode&1)!==0)for($e=r,be=r.child;be!==null;){for(Ne=$e=be;$e!==null;){switch(Ee=$e,Ue=Ee.child,Ee.tag){case 0:case 11:case 14:case 15:Tl(4,Ee,Ee.return);break;case 1:To(Ee,Ee.return);var Be=Ee.stateNode;if(typeof Be.componentWillUnmount=="function"){h=Ee,c=Ee.return;try{i=h,Be.props=i.memoizedProps,Be.state=i.memoizedState,Be.componentWillUnmount()}catch(Ge){tn(h,c,Ge)}}break;case 5:To(Ee,Ee.return);break;case 22:if(Ee.memoizedState!==null){Xg(Ne);continue}}Ue!==null?(Ue.return=Ee,$e=Ue):Xg(Ne)}be=be.sibling}e:for(be=null,Ne=r;;){if(Ne.tag===5){if(be===null){be=Ne;try{p=Ne.stateNode,ae?(v=p.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none"):(V=Ne.stateNode,q=Ne.memoizedProps.style,S=q!=null&&q.hasOwnProperty("display")?q.display:null,V.style.display=ds("display",S))}catch(Ge){tn(r,r.return,Ge)}}}else if(Ne.tag===6){if(be===null)try{Ne.stateNode.nodeValue=ae?"":Ne.memoizedProps}catch(Ge){tn(r,r.return,Ge)}}else if((Ne.tag!==22&&Ne.tag!==23||Ne.memoizedState===null||Ne===r)&&Ne.child!==null){Ne.child.return=Ne,Ne=Ne.child;continue}if(Ne===r)break e;for(;Ne.sibling===null;){if(Ne.return===null||Ne.return===r)break e;be===Ne&&(be=null),Ne=Ne.return}be===Ne&&(be=null),Ne.sibling.return=Ne.return,Ne=Ne.sibling}}break;case 19:Ss(i,r),Ws(r),h&4&&Kg(r);break;case 21:break;default:Ss(i,r),Ws(r)}}function Ws(r){var i=r.flags;if(i&2){try{e:{for(var c=r.return;c!==null;){if(Gg(c)){var h=c;break e}c=c.return}throw Error(t(160))}switch(h.tag){case 5:var p=h.stateNode;h.flags&32&&(In(p,""),h.flags&=-33);var v=qg(r);Lh(r,v,p);break;case 3:case 4:var S=h.stateNode.containerInfo,V=qg(r);Vh(r,V,S);break;default:throw Error(t(161))}}catch(q){tn(r,r.return,q)}r.flags&=-3}i&4096&&(r.flags&=-4097)}function aE(r,i,c){$e=r,Yg(r)}function Yg(r,i,c){for(var h=(r.mode&1)!==0;$e!==null;){var p=$e,v=p.child;if(p.tag===22&&h){var S=p.memoizedState!==null||eu;if(!S){var V=p.alternate,q=V!==null&&V.memoizedState!==null||rr;V=eu;var ae=rr;if(eu=S,(rr=q)&&!ae)for($e=p;$e!==null;)S=$e,q=S.child,S.tag===22&&S.memoizedState!==null?Zg(p):q!==null?(q.return=S,$e=q):Zg(p);for(;v!==null;)$e=v,Yg(v),v=v.sibling;$e=p,eu=V,rr=ae}Jg(r)}else(p.subtreeFlags&8772)!==0&&v!==null?(v.return=p,$e=v):Jg(r)}}function Jg(r){for(;$e!==null;){var i=$e;if((i.flags&8772)!==0){var c=i.alternate;try{if((i.flags&8772)!==0)switch(i.tag){case 0:case 11:case 15:rr||tu(5,i);break;case 1:var h=i.stateNode;if(i.flags&4&&!rr)if(c===null)h.componentDidMount();else{var p=i.elementType===i.type?c.memoizedProps:Es(i.type,c.memoizedProps);h.componentDidUpdate(p,c.memoizedState,h.__reactInternalSnapshotBeforeUpdate)}var v=i.updateQueue;v!==null&&Xm(i,v,h);break;case 3:var S=i.updateQueue;if(S!==null){if(c=null,i.child!==null)switch(i.child.tag){case 5:c=i.child.stateNode;break;case 1:c=i.child.stateNode}Xm(i,S,c)}break;case 5:var V=i.stateNode;if(c===null&&i.flags&4){c=V;var q=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":q.autoFocus&&c.focus();break;case"img":q.src&&(c.src=q.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var ae=i.alternate;if(ae!==null){var be=ae.memoizedState;if(be!==null){var Ne=be.dehydrated;Ne!==null&&rt(Ne)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}rr||i.flags&512&&Dh(i)}catch(Ee){tn(i,i.return,Ee)}}if(i===r){$e=null;break}if(c=i.sibling,c!==null){c.return=i.return,$e=c;break}$e=i.return}}function Xg(r){for(;$e!==null;){var i=$e;if(i===r){$e=null;break}var c=i.sibling;if(c!==null){c.return=i.return,$e=c;break}$e=i.return}}function Zg(r){for(;$e!==null;){var i=$e;try{switch(i.tag){case 0:case 11:case 15:var c=i.return;try{tu(4,i)}catch(q){tn(i,c,q)}break;case 1:var h=i.stateNode;if(typeof h.componentDidMount=="function"){var p=i.return;try{h.componentDidMount()}catch(q){tn(i,p,q)}}var v=i.return;try{Dh(i)}catch(q){tn(i,v,q)}break;case 5:var S=i.return;try{Dh(i)}catch(q){tn(i,S,q)}}}catch(q){tn(i,i.return,q)}if(i===r){$e=null;break}var V=i.sibling;if(V!==null){V.return=i.return,$e=V;break}$e=i.return}}var oE=Math.ceil,nu=ve.ReactCurrentDispatcher,Mh=ve.ReactCurrentOwner,ss=ve.ReactCurrentBatchConfig,bt=0,Ln=null,pn=null,Wn=0,zr=0,So=Ni(0),Sn=0,Sl=null,Na=0,ru=0,Oh=0,bl=null,Ir=null,Fh=0,bo=1/0,ci=null,su=!1,Uh=null,Di=null,iu=!1,Vi=null,au=0,Cl=0,zh=null,ou=-1,lu=0;function vr(){return(bt&6)!==0?ft():ou!==-1?ou:ou=ft()}function Li(r){return(r.mode&1)===0?1:(bt&2)!==0&&Wn!==0?Wn&-Wn:Ww.transition!==null?(lu===0&&(lu=fr()),lu):(r=gt,r!==0||(r=window.event,r=r===void 0?16:Jr(r.type)),r)}function bs(r,i,c,h){if(50<Cl)throw Cl=0,zh=null,Error(t(185));Ls(r,c,h),((bt&2)===0||r!==Ln)&&(r===Ln&&((bt&2)===0&&(ru|=c),Sn===4&&Mi(r,Wn)),Nr(r,h),c===1&&bt===0&&(i.mode&1)===0&&(bo=ft()+500,Lc&&Ri()))}function Nr(r,i){var c=r.callbackNode;hr(r,i);var h=ht(r,r===Ln?Wn:0);if(h===0)c!==null&&Kr(c),r.callbackNode=null,r.callbackPriority=0;else if(i=h&-h,r.callbackPriority!==i){if(c!=null&&Kr(c),i===1)r.tag===0?Bw(ty.bind(null,r)):Um(ty.bind(null,r)),Fw(function(){(bt&6)===0&&Ri()}),c=null;else{switch(Nt(h)){case 1:c=An;break;case 4:c=en;break;case 16:c=w;break;case 536870912:c=F;break;default:c=w}c=cy(c,ey.bind(null,r))}r.callbackPriority=i,r.callbackNode=c}}function ey(r,i){if(ou=-1,lu=0,(bt&6)!==0)throw Error(t(327));var c=r.callbackNode;if(Co()&&r.callbackNode!==c)return null;var h=ht(r,r===Ln?Wn:0);if(h===0)return null;if((h&30)!==0||(h&r.expiredLanes)!==0||i)i=cu(r,h);else{i=h;var p=bt;bt|=2;var v=ry();(Ln!==r||Wn!==i)&&(ci=null,bo=ft()+500,Ra(r,i));do try{uE();break}catch(V){ny(r,V)}while(!0);ih(),nu.current=v,bt=p,pn!==null?i=0:(Ln=null,Wn=0,i=Sn)}if(i!==0){if(i===2&&(p=xn(r),p!==0&&(h=p,i=$h(r,p))),i===1)throw c=Sl,Ra(r,0),Mi(r,h),Nr(r,ft()),c;if(i===6)Mi(r,h);else{if(p=r.current.alternate,(h&30)===0&&!lE(p)&&(i=cu(r,h),i===2&&(v=xn(r),v!==0&&(h=v,i=$h(r,v))),i===1))throw c=Sl,Ra(r,0),Mi(r,h),Nr(r,ft()),c;switch(r.finishedWork=p,r.finishedLanes=h,i){case 0:case 1:throw Error(t(345));case 2:Aa(r,Ir,ci);break;case 3:if(Mi(r,h),(h&130023424)===h&&(i=Fh+500-ft(),10<i)){if(ht(r,0)!==0)break;if(p=r.suspendedLanes,(p&h)!==h){vr(),r.pingedLanes|=r.suspendedLanes&p;break}r.timeoutHandle=Kd(Aa.bind(null,r,Ir,ci),i);break}Aa(r,Ir,ci);break;case 4:if(Mi(r,h),(h&4194240)===h)break;for(i=r.eventTimes,p=-1;0<h;){var S=31-ne(h);v=1<<S,S=i[S],S>p&&(p=S),h&=~v}if(h=p,h=ft()-h,h=(120>h?120:480>h?480:1080>h?1080:1920>h?1920:3e3>h?3e3:4320>h?4320:1960*oE(h/1960))-h,10<h){r.timeoutHandle=Kd(Aa.bind(null,r,Ir,ci),h);break}Aa(r,Ir,ci);break;case 5:Aa(r,Ir,ci);break;default:throw Error(t(329))}}}return Nr(r,ft()),r.callbackNode===c?ey.bind(null,r):null}function $h(r,i){var c=bl;return r.current.memoizedState.isDehydrated&&(Ra(r,i).flags|=256),r=cu(r,i),r!==2&&(i=Ir,Ir=c,i!==null&&Bh(i)),r}function Bh(r){Ir===null?Ir=r:Ir.push.apply(Ir,r)}function lE(r){for(var i=r;;){if(i.flags&16384){var c=i.updateQueue;if(c!==null&&(c=c.stores,c!==null))for(var h=0;h<c.length;h++){var p=c[h],v=p.getSnapshot;p=p.value;try{if(!xs(v(),p))return!1}catch{return!1}}}if(c=i.child,i.subtreeFlags&16384&&c!==null)c.return=i,i=c;else{if(i===r)break;for(;i.sibling===null;){if(i.return===null||i.return===r)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Mi(r,i){for(i&=~Oh,i&=~ru,r.suspendedLanes|=i,r.pingedLanes&=~i,r=r.expirationTimes;0<i;){var c=31-ne(i),h=1<<c;r[c]=-1,i&=~h}}function ty(r){if((bt&6)!==0)throw Error(t(327));Co();var i=ht(r,0);if((i&1)===0)return Nr(r,ft()),null;var c=cu(r,i);if(r.tag!==0&&c===2){var h=xn(r);h!==0&&(i=h,c=$h(r,h))}if(c===1)throw c=Sl,Ra(r,0),Mi(r,i),Nr(r,ft()),c;if(c===6)throw Error(t(345));return r.finishedWork=r.current.alternate,r.finishedLanes=i,Aa(r,Ir,ci),Nr(r,ft()),null}function Wh(r,i){var c=bt;bt|=1;try{return r(i)}finally{bt=c,bt===0&&(bo=ft()+500,Lc&&Ri())}}function Pa(r){Vi!==null&&Vi.tag===0&&(bt&6)===0&&Co();var i=bt;bt|=1;var c=ss.transition,h=gt;try{if(ss.transition=null,gt=1,r)return r()}finally{gt=h,ss.transition=c,bt=i,(bt&6)===0&&Ri()}}function Gh(){zr=So.current,Bt(So)}function Ra(r,i){r.finishedWork=null,r.finishedLanes=0;var c=r.timeoutHandle;if(c!==-1&&(r.timeoutHandle=-1,Ow(c)),pn!==null)for(c=pn.return;c!==null;){var h=c;switch(eh(h),h.tag){case 1:h=h.type.childContextTypes,h!=null&&Dc();break;case 3:wo(),Bt(Sr),Bt(er),fh();break;case 5:dh(h);break;case 4:wo();break;case 13:Bt(Yt);break;case 19:Bt(Yt);break;case 10:ah(h.type._context);break;case 22:case 23:Gh()}c=c.return}if(Ln=r,pn=r=Oi(r.current,null),Wn=zr=i,Sn=0,Sl=null,Oh=ru=Na=0,Ir=bl=null,ba!==null){for(i=0;i<ba.length;i++)if(c=ba[i],h=c.interleaved,h!==null){c.interleaved=null;var p=h.next,v=c.pending;if(v!==null){var S=v.next;v.next=p,h.next=S}c.pending=h}ba=null}return r}function ny(r,i){do{var c=pn;try{if(ih(),qc.current=Yc,Hc){for(var h=Jt.memoizedState;h!==null;){var p=h.queue;p!==null&&(p.pending=null),h=h.next}Hc=!1}if(Ia=0,Vn=Tn=Jt=null,vl=!1,_l=0,Mh.current=null,c===null||c.return===null){Sn=1,Sl=i,pn=null;break}e:{var v=r,S=c.return,V=c,q=i;if(i=Wn,V.flags|=32768,q!==null&&typeof q=="object"&&typeof q.then=="function"){var ae=q,be=V,Ne=be.tag;if((be.mode&1)===0&&(Ne===0||Ne===11||Ne===15)){var Ee=be.alternate;Ee?(be.updateQueue=Ee.updateQueue,be.memoizedState=Ee.memoizedState,be.lanes=Ee.lanes):(be.updateQueue=null,be.memoizedState=null)}var Ue=Ig(S);if(Ue!==null){Ue.flags&=-257,Ng(Ue,S,V,v,i),Ue.mode&1&&Cg(v,ae,i),i=Ue,q=ae;var Be=i.updateQueue;if(Be===null){var Ge=new Set;Ge.add(q),i.updateQueue=Ge}else Be.add(q);break e}else{if((i&1)===0){Cg(v,ae,i),qh();break e}q=Error(t(426))}}else if(Ht&&V.mode&1){var on=Ig(S);if(on!==null){(on.flags&65536)===0&&(on.flags|=256),Ng(on,S,V,v,i),rh(Eo(q,V));break e}}v=q=Eo(q,V),Sn!==4&&(Sn=2),bl===null?bl=[v]:bl.push(v),v=S;do{switch(v.tag){case 3:v.flags|=65536,i&=-i,v.lanes|=i;var ee=Sg(v,q,i);Jm(v,ee);break e;case 1:V=q;var Q=v.type,te=v.stateNode;if((v.flags&128)===0&&(typeof Q.getDerivedStateFromError=="function"||te!==null&&typeof te.componentDidCatch=="function"&&(Di===null||!Di.has(te)))){v.flags|=65536,i&=-i,v.lanes|=i;var ke=bg(v,V,i);Jm(v,ke);break e}}v=v.return}while(v!==null)}iy(c)}catch(Ke){i=Ke,pn===c&&c!==null&&(pn=c=c.return);continue}break}while(!0)}function ry(){var r=nu.current;return nu.current=Yc,r===null?Yc:r}function qh(){(Sn===0||Sn===3||Sn===2)&&(Sn=4),Ln===null||(Na&268435455)===0&&(ru&268435455)===0||Mi(Ln,Wn)}function cu(r,i){var c=bt;bt|=2;var h=ry();(Ln!==r||Wn!==i)&&(ci=null,Ra(r,i));do try{cE();break}catch(p){ny(r,p)}while(!0);if(ih(),bt=c,nu.current=h,pn!==null)throw Error(t(261));return Ln=null,Wn=0,Sn}function cE(){for(;pn!==null;)sy(pn)}function uE(){for(;pn!==null&&!dr();)sy(pn)}function sy(r){var i=ly(r.alternate,r,zr);r.memoizedProps=r.pendingProps,i===null?iy(r):pn=i,Mh.current=null}function iy(r){var i=r;do{var c=i.alternate;if(r=i.return,(i.flags&32768)===0){if(c=nE(c,i,zr),c!==null){pn=c;return}}else{if(c=rE(c,i),c!==null){c.flags&=32767,pn=c;return}if(r!==null)r.flags|=32768,r.subtreeFlags=0,r.deletions=null;else{Sn=6,pn=null;return}}if(i=i.sibling,i!==null){pn=i;return}pn=i=r}while(i!==null);Sn===0&&(Sn=5)}function Aa(r,i,c){var h=gt,p=ss.transition;try{ss.transition=null,gt=1,dE(r,i,c,h)}finally{ss.transition=p,gt=h}return null}function dE(r,i,c,h){do Co();while(Vi!==null);if((bt&6)!==0)throw Error(t(327));c=r.finishedWork;var p=r.finishedLanes;if(c===null)return null;if(r.finishedWork=null,r.finishedLanes=0,c===r.current)throw Error(t(177));r.callbackNode=null,r.callbackPriority=0;var v=c.lanes|c.childLanes;if(kt(r,v),r===Ln&&(pn=Ln=null,Wn=0),(c.subtreeFlags&2064)===0&&(c.flags&2064)===0||iu||(iu=!0,cy(w,function(){return Co(),null})),v=(c.flags&15990)!==0,(c.subtreeFlags&15990)!==0||v){v=ss.transition,ss.transition=null;var S=gt;gt=1;var V=bt;bt|=4,Mh.current=null,iE(r,c),Qg(c,r),Aw(qd),St=!!Gd,qd=Gd=null,r.current=c,aE(c),fa(),bt=V,gt=S,ss.transition=v}else r.current=c;if(iu&&(iu=!1,Vi=r,au=p),v=r.pendingLanes,v===0&&(Di=null),me(c.stateNode),Nr(r,ft()),i!==null)for(h=r.onRecoverableError,c=0;c<i.length;c++)p=i[c],h(p.value,{componentStack:p.stack,digest:p.digest});if(su)throw su=!1,r=Uh,Uh=null,r;return(au&1)!==0&&r.tag!==0&&Co(),v=r.pendingLanes,(v&1)!==0?r===zh?Cl++:(Cl=0,zh=r):Cl=0,Ri(),null}function Co(){if(Vi!==null){var r=Nt(au),i=ss.transition,c=gt;try{if(ss.transition=null,gt=16>r?16:r,Vi===null)var h=!1;else{if(r=Vi,Vi=null,au=0,(bt&6)!==0)throw Error(t(331));var p=bt;for(bt|=4,$e=r.current;$e!==null;){var v=$e,S=v.child;if(($e.flags&16)!==0){var V=v.deletions;if(V!==null){for(var q=0;q<V.length;q++){var ae=V[q];for($e=ae;$e!==null;){var be=$e;switch(be.tag){case 0:case 11:case 15:Tl(8,be,v)}var Ne=be.child;if(Ne!==null)Ne.return=be,$e=Ne;else for(;$e!==null;){be=$e;var Ee=be.sibling,Ue=be.return;if(Wg(be),be===ae){$e=null;break}if(Ee!==null){Ee.return=Ue,$e=Ee;break}$e=Ue}}}var Be=v.alternate;if(Be!==null){var Ge=Be.child;if(Ge!==null){Be.child=null;do{var on=Ge.sibling;Ge.sibling=null,Ge=on}while(Ge!==null)}}$e=v}}if((v.subtreeFlags&2064)!==0&&S!==null)S.return=v,$e=S;else e:for(;$e!==null;){if(v=$e,(v.flags&2048)!==0)switch(v.tag){case 0:case 11:case 15:Tl(9,v,v.return)}var ee=v.sibling;if(ee!==null){ee.return=v.return,$e=ee;break e}$e=v.return}}var Q=r.current;for($e=Q;$e!==null;){S=$e;var te=S.child;if((S.subtreeFlags&2064)!==0&&te!==null)te.return=S,$e=te;else e:for(S=Q;$e!==null;){if(V=$e,(V.flags&2048)!==0)try{switch(V.tag){case 0:case 11:case 15:tu(9,V)}}catch(Ke){tn(V,V.return,Ke)}if(V===S){$e=null;break e}var ke=V.sibling;if(ke!==null){ke.return=V.return,$e=ke;break e}$e=V.return}}if(bt=p,Ri(),G&&typeof G.onPostCommitFiberRoot=="function")try{G.onPostCommitFiberRoot(M,r)}catch{}h=!0}return h}finally{gt=c,ss.transition=i}}return!1}function ay(r,i,c){i=Eo(c,i),i=Sg(r,i,1),r=ji(r,i,1),i=vr(),r!==null&&(Ls(r,1,i),Nr(r,i))}function tn(r,i,c){if(r.tag===3)ay(r,r,c);else for(;i!==null;){if(i.tag===3){ay(i,r,c);break}else if(i.tag===1){var h=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(Di===null||!Di.has(h))){r=Eo(c,r),r=bg(i,r,1),i=ji(i,r,1),r=vr(),i!==null&&(Ls(i,1,r),Nr(i,r));break}}i=i.return}}function hE(r,i,c){var h=r.pingCache;h!==null&&h.delete(i),i=vr(),r.pingedLanes|=r.suspendedLanes&c,Ln===r&&(Wn&c)===c&&(Sn===4||Sn===3&&(Wn&130023424)===Wn&&500>ft()-Fh?Ra(r,0):Oh|=c),Nr(r,i)}function oy(r,i){i===0&&((r.mode&1)===0?i=1:(i=Je,Je<<=1,(Je&130023424)===0&&(Je=4194304)));var c=vr();r=ai(r,i),r!==null&&(Ls(r,i,c),Nr(r,c))}function fE(r){var i=r.memoizedState,c=0;i!==null&&(c=i.retryLane),oy(r,c)}function pE(r,i){var c=0;switch(r.tag){case 13:var h=r.stateNode,p=r.memoizedState;p!==null&&(c=p.retryLane);break;case 19:h=r.stateNode;break;default:throw Error(t(314))}h!==null&&h.delete(i),oy(r,c)}var ly;ly=function(r,i,c){if(r!==null)if(r.memoizedProps!==i.pendingProps||Sr.current)Cr=!0;else{if((r.lanes&c)===0&&(i.flags&128)===0)return Cr=!1,tE(r,i,c);Cr=(r.flags&131072)!==0}else Cr=!1,Ht&&(i.flags&1048576)!==0&&zm(i,Oc,i.index);switch(i.lanes=0,i.tag){case 2:var h=i.type;Zc(r,i),r=i.pendingProps;var p=po(i,er.current);xo(i,c),p=gh(null,i,h,r,p,c);var v=yh();return i.flags|=1,typeof p=="object"&&p!==null&&typeof p.render=="function"&&p.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,br(h)?(v=!0,Vc(i)):v=!1,i.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,ch(i),p.updater=Jc,i.stateNode=p,p._reactInternals=i,Th(i,h,r,c),i=Ih(null,i,h,!0,v,c)):(i.tag=0,Ht&&v&&Zd(i),yr(null,i,p,c),i=i.child),i;case 16:h=i.elementType;e:{switch(Zc(r,i),r=i.pendingProps,p=h._init,h=p(h._payload),i.type=h,p=i.tag=gE(h),r=Es(h,r),p){case 0:i=Ch(null,i,h,r,c);break e;case 1:i=Dg(null,i,h,r,c);break e;case 11:i=Pg(null,i,h,r,c);break e;case 14:i=Rg(null,i,h,Es(h.type,r),c);break e}throw Error(t(306,h,""))}return i;case 0:return h=i.type,p=i.pendingProps,p=i.elementType===h?p:Es(h,p),Ch(r,i,h,p,c);case 1:return h=i.type,p=i.pendingProps,p=i.elementType===h?p:Es(h,p),Dg(r,i,h,p,c);case 3:e:{if(Vg(i),r===null)throw Error(t(387));h=i.pendingProps,v=i.memoizedState,p=v.element,Ym(r,i),Wc(i,h,null,c);var S=i.memoizedState;if(h=S.element,v.isDehydrated)if(v={element:h,isDehydrated:!1,cache:S.cache,pendingSuspenseBoundaries:S.pendingSuspenseBoundaries,transitions:S.transitions},i.updateQueue.baseState=v,i.memoizedState=v,i.flags&256){p=Eo(Error(t(423)),i),i=Lg(r,i,h,c,p);break e}else if(h!==p){p=Eo(Error(t(424)),i),i=Lg(r,i,h,c,p);break e}else for(Ur=Ii(i.stateNode.containerInfo.firstChild),Fr=i,Ht=!0,ws=null,c=Km(i,null,h,c),i.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{if(yo(),h===p){i=li(r,i,c);break e}yr(r,i,h,c)}i=i.child}return i;case 5:return Zm(i),r===null&&nh(i),h=i.type,p=i.pendingProps,v=r!==null?r.memoizedProps:null,S=p.children,Hd(h,p)?S=null:v!==null&&Hd(h,v)&&(i.flags|=32),kg(r,i),yr(r,i,S,c),i.child;case 6:return r===null&&nh(i),null;case 13:return Mg(r,i,c);case 4:return uh(i,i.stateNode.containerInfo),h=i.pendingProps,r===null?i.child=vo(i,null,h,c):yr(r,i,h,c),i.child;case 11:return h=i.type,p=i.pendingProps,p=i.elementType===h?p:Es(h,p),Pg(r,i,h,p,c);case 7:return yr(r,i,i.pendingProps,c),i.child;case 8:return yr(r,i,i.pendingProps.children,c),i.child;case 12:return yr(r,i,i.pendingProps.children,c),i.child;case 10:e:{if(h=i.type._context,p=i.pendingProps,v=i.memoizedProps,S=p.value,Mt(zc,h._currentValue),h._currentValue=S,v!==null)if(xs(v.value,S)){if(v.children===p.children&&!Sr.current){i=li(r,i,c);break e}}else for(v=i.child,v!==null&&(v.return=i);v!==null;){var V=v.dependencies;if(V!==null){S=v.child;for(var q=V.firstContext;q!==null;){if(q.context===h){if(v.tag===1){q=oi(-1,c&-c),q.tag=2;var ae=v.updateQueue;if(ae!==null){ae=ae.shared;var be=ae.pending;be===null?q.next=q:(q.next=be.next,be.next=q),ae.pending=q}}v.lanes|=c,q=v.alternate,q!==null&&(q.lanes|=c),oh(v.return,c,i),V.lanes|=c;break}q=q.next}}else if(v.tag===10)S=v.type===i.type?null:v.child;else if(v.tag===18){if(S=v.return,S===null)throw Error(t(341));S.lanes|=c,V=S.alternate,V!==null&&(V.lanes|=c),oh(S,c,i),S=v.sibling}else S=v.child;if(S!==null)S.return=v;else for(S=v;S!==null;){if(S===i){S=null;break}if(v=S.sibling,v!==null){v.return=S.return,S=v;break}S=S.return}v=S}yr(r,i,p.children,c),i=i.child}return i;case 9:return p=i.type,h=i.pendingProps.children,xo(i,c),p=ns(p),h=h(p),i.flags|=1,yr(r,i,h,c),i.child;case 14:return h=i.type,p=Es(h,i.pendingProps),p=Es(h.type,p),Rg(r,i,h,p,c);case 15:return Ag(r,i,i.type,i.pendingProps,c);case 17:return h=i.type,p=i.pendingProps,p=i.elementType===h?p:Es(h,p),Zc(r,i),i.tag=1,br(h)?(r=!0,Vc(i)):r=!1,xo(i,c),Eg(i,h,p),Th(i,h,p,c),Ih(null,i,h,!0,r,c);case 19:return Fg(r,i,c);case 22:return jg(r,i,c)}throw Error(t(156,i.tag))};function cy(r,i){return gs(r,i)}function mE(r,i,c,h){this.tag=r,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function is(r,i,c,h){return new mE(r,i,c,h)}function Hh(r){return r=r.prototype,!(!r||!r.isReactComponent)}function gE(r){if(typeof r=="function")return Hh(r)?1:0;if(r!=null){if(r=r.$$typeof,r===P)return 11;if(r===re)return 14}return 2}function Oi(r,i){var c=r.alternate;return c===null?(c=is(r.tag,i,r.key,r.mode),c.elementType=r.elementType,c.type=r.type,c.stateNode=r.stateNode,c.alternate=r,r.alternate=c):(c.pendingProps=i,c.type=r.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=r.flags&14680064,c.childLanes=r.childLanes,c.lanes=r.lanes,c.child=r.child,c.memoizedProps=r.memoizedProps,c.memoizedState=r.memoizedState,c.updateQueue=r.updateQueue,i=r.dependencies,c.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},c.sibling=r.sibling,c.index=r.index,c.ref=r.ref,c}function uu(r,i,c,h,p,v){var S=2;if(h=r,typeof r=="function")Hh(r)&&(S=1);else if(typeof r=="string")S=5;else e:switch(r){case I:return ja(c.children,p,v,i);case N:S=8,p|=8;break;case A:return r=is(12,c,i,p|2),r.elementType=A,r.lanes=v,r;case b:return r=is(13,c,i,p),r.elementType=b,r.lanes=v,r;case J:return r=is(19,c,i,p),r.elementType=J,r.lanes=v,r;case he:return du(c,p,v,i);default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case O:S=10;break e;case D:S=9;break e;case P:S=11;break e;case re:S=14;break e;case Ie:S=16,h=null;break e}throw Error(t(130,r==null?r:typeof r,""))}return i=is(S,c,i,p),i.elementType=r,i.type=h,i.lanes=v,i}function ja(r,i,c,h){return r=is(7,r,h,i),r.lanes=c,r}function du(r,i,c,h){return r=is(22,r,h,i),r.elementType=he,r.lanes=c,r.stateNode={isHidden:!1},r}function Kh(r,i,c){return r=is(6,r,null,i),r.lanes=c,r}function Qh(r,i,c){return i=is(4,r.children!==null?r.children:[],r.key,i),i.lanes=c,i.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},i}function yE(r,i,c,h,p){this.tag=i,this.containerInfo=r,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Qr(0),this.expirationTimes=Qr(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Qr(0),this.identifierPrefix=h,this.onRecoverableError=p,this.mutableSourceEagerHydrationData=null}function Yh(r,i,c,h,p,v,S,V,q){return r=new yE(r,i,c,V,q),i===1?(i=1,v===!0&&(i|=8)):i=0,v=is(3,null,null,i),r.current=v,v.stateNode=r,v.memoizedState={element:h,isDehydrated:c,cache:null,transitions:null,pendingSuspenseBoundaries:null},ch(v),r}function vE(r,i,c){var h=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ie,key:h==null?null:""+h,children:r,containerInfo:i,implementation:c}}function uy(r){if(!r)return Pi;r=r._reactInternals;e:{if(Rn(r)!==r||r.tag!==1)throw Error(t(170));var i=r;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(br(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(t(171))}if(r.tag===1){var c=r.type;if(br(c))return Om(r,c,i)}return i}function dy(r,i,c,h,p,v,S,V,q){return r=Yh(c,h,!0,r,p,v,S,V,q),r.context=uy(null),c=r.current,h=vr(),p=Li(c),v=oi(h,p),v.callback=i??null,ji(c,v,p),r.current.lanes=p,Ls(r,p,h),Nr(r,h),r}function hu(r,i,c,h){var p=i.current,v=vr(),S=Li(p);return c=uy(c),i.context===null?i.context=c:i.pendingContext=c,i=oi(v,S),i.payload={element:r},h=h===void 0?null:h,h!==null&&(i.callback=h),r=ji(p,i,S),r!==null&&(bs(r,p,S,v),Bc(r,p,S)),S}function fu(r){if(r=r.current,!r.child)return null;switch(r.child.tag){case 5:return r.child.stateNode;default:return r.child.stateNode}}function hy(r,i){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var c=r.retryLane;r.retryLane=c!==0&&c<i?c:i}}function Jh(r,i){hy(r,i),(r=r.alternate)&&hy(r,i)}function _E(){return null}var fy=typeof reportError=="function"?reportError:function(r){console.error(r)};function Xh(r){this._internalRoot=r}pu.prototype.render=Xh.prototype.render=function(r){var i=this._internalRoot;if(i===null)throw Error(t(409));hu(r,i,null,null)},pu.prototype.unmount=Xh.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var i=r.containerInfo;Pa(function(){hu(null,r,null,null)}),i[ni]=null}};function pu(r){this._internalRoot=r}pu.prototype.unstable_scheduleHydration=function(r){if(r){var i=ma();r={blockedOn:null,target:r,priority:i};for(var c=0;c<Yr.length&&i!==0&&i<Yr[c].priority;c++);Yr.splice(c,0,r),c===0&&K(r)}};function Zh(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function mu(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11&&(r.nodeType!==8||r.nodeValue!==" react-mount-point-unstable "))}function py(){}function xE(r,i,c,h,p){if(p){if(typeof h=="function"){var v=h;h=function(){var ae=fu(S);v.call(ae)}}var S=dy(i,h,r,0,null,!1,!1,"",py);return r._reactRootContainer=S,r[ni]=S.current,ul(r.nodeType===8?r.parentNode:r),Pa(),S}for(;p=r.lastChild;)r.removeChild(p);if(typeof h=="function"){var V=h;h=function(){var ae=fu(q);V.call(ae)}}var q=Yh(r,0,!1,null,null,!1,!1,"",py);return r._reactRootContainer=q,r[ni]=q.current,ul(r.nodeType===8?r.parentNode:r),Pa(function(){hu(i,q,c,h)}),q}function gu(r,i,c,h,p){var v=c._reactRootContainer;if(v){var S=v;if(typeof p=="function"){var V=p;p=function(){var q=fu(S);V.call(q)}}hu(i,S,r,p)}else S=xE(c,i,r,p,h);return fu(S)}Os=function(r){switch(r.tag){case 3:var i=r.stateNode;if(i.current.memoizedState.isDehydrated){var c=Re(i.pendingLanes);c!==0&&(Ms(i,c|1),Nr(i,ft()),(bt&6)===0&&(bo=ft()+500,Ri()))}break;case 13:Pa(function(){var h=ai(r,1);if(h!==null){var p=vr();bs(h,r,1,p)}}),Jh(r,1)}},pr=function(r){if(r.tag===13){var i=ai(r,134217728);if(i!==null){var c=vr();bs(i,r,134217728,c)}Jh(r,134217728)}},pa=function(r){if(r.tag===13){var i=Li(r),c=ai(r,i);if(c!==null){var h=vr();bs(c,r,i,h)}Jh(r,i)}},ma=function(){return gt},ga=function(r,i){var c=gt;try{return gt=r,i()}finally{gt=c}},Jn=function(r,i,c){switch(i){case"input":if(At(r,c),i=c.name,c.type==="radio"&&i!=null){for(c=r;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<c.length;i++){var h=c[i];if(h!==r&&h.form===r.form){var p=kc(h);if(!p)throw Error(t(90));Me(h),At(h,p)}}}break;case"textarea":Gt(r,c);break;case"select":i=c.value,i!=null&&un(r,!!c.multiple,i,!1)}},Gr=Wh,qr=Pa;var wE={usingClientEntryPoint:!1,Events:[fl,ho,kc,Nn,xr,Wh]},Il={findFiberByHostInstance:wa,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},EE={bundleType:Il.bundleType,version:Il.version,rendererPackageName:Il.rendererPackageName,rendererConfig:Il.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ve.ReactCurrentDispatcher,findHostInstanceByFiber:function(r){return r=Ds(r),r===null?null:r.stateNode},findFiberByHostInstance:Il.findFiberByHostInstance||_E,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var yu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!yu.isDisabled&&yu.supportsFiber)try{M=yu.inject(EE),G=yu}catch{}}return Pr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=wE,Pr.createPortal=function(r,i){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Zh(i))throw Error(t(200));return vE(r,i,null,c)},Pr.createRoot=function(r,i){if(!Zh(r))throw Error(t(299));var c=!1,h="",p=fy;return i!=null&&(i.unstable_strictMode===!0&&(c=!0),i.identifierPrefix!==void 0&&(h=i.identifierPrefix),i.onRecoverableError!==void 0&&(p=i.onRecoverableError)),i=Yh(r,1,!1,null,null,c,!1,h,p),r[ni]=i.current,ul(r.nodeType===8?r.parentNode:r),new Xh(i)},Pr.findDOMNode=function(r){if(r==null)return null;if(r.nodeType===1)return r;var i=r._reactInternals;if(i===void 0)throw typeof r.render=="function"?Error(t(188)):(r=Object.keys(r).join(","),Error(t(268,r)));return r=Ds(i),r=r===null?null:r.stateNode,r},Pr.flushSync=function(r){return Pa(r)},Pr.hydrate=function(r,i,c){if(!mu(i))throw Error(t(200));return gu(null,r,i,!0,c)},Pr.hydrateRoot=function(r,i,c){if(!Zh(r))throw Error(t(405));var h=c!=null&&c.hydratedSources||null,p=!1,v="",S=fy;if(c!=null&&(c.unstable_strictMode===!0&&(p=!0),c.identifierPrefix!==void 0&&(v=c.identifierPrefix),c.onRecoverableError!==void 0&&(S=c.onRecoverableError)),i=dy(i,null,r,1,c??null,p,!1,v,S),r[ni]=i.current,ul(r),h)for(r=0;r<h.length;r++)c=h[r],p=c._getVersion,p=p(c._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[c,p]:i.mutableSourceEagerHydrationData.push(c,p);return new pu(i)},Pr.render=function(r,i,c){if(!mu(i))throw Error(t(200));return gu(null,r,i,!1,c)},Pr.unmountComponentAtNode=function(r){if(!mu(r))throw Error(t(40));return r._reactRootContainer?(Pa(function(){gu(null,null,r,!1,function(){r._reactRootContainer=null,r[ni]=null})}),!0):!1},Pr.unstable_batchedUpdates=Wh,Pr.unstable_renderSubtreeIntoContainer=function(r,i,c,h){if(!mu(c))throw Error(t(200));if(r==null||r._reactInternals===void 0)throw Error(t(38));return gu(r,i,c,!1,h)},Pr.version="18.3.1-next-f1338f8080-20240426",Pr}var Ey;function R_(){if(Ey)return nf.exports;Ey=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),nf.exports=AE(),nf.exports}var Ty;function jE(){if(Ty)return vu;Ty=1;var n=R_();return vu.createRoot=n.createRoot,vu.hydrateRoot=n.hydrateRoot,vu}var kE=jE();const DE=tp(kE);R_();/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Wl(){return Wl=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},Wl.apply(this,arguments)}var Gi;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(Gi||(Gi={}));const Sy="popstate";function VE(n){n===void 0&&(n={});function e(s,a){let{pathname:l,search:d,hash:f}=s.location;return Ef("",{pathname:l,search:d,hash:f},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(s,a){return typeof a=="string"?a:Uu(a)}return ME(e,t,null,n)}function cn(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function sp(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function LE(){return Math.random().toString(36).substr(2,8)}function by(n,e){return{usr:n.state,key:n.key,idx:e}}function Ef(n,e,t,s){return t===void 0&&(t=null),Wl({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?Go(e):e,{state:t,key:e&&e.key||s||LE()})}function Uu(n){let{pathname:e="/",search:t="",hash:s=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),s&&s!=="#"&&(e+=s.charAt(0)==="#"?s:"#"+s),e}function Go(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let s=n.indexOf("?");s>=0&&(e.search=n.substr(s),n=n.substr(0,s)),n&&(e.pathname=n)}return e}function ME(n,e,t,s){s===void 0&&(s={});let{window:a=document.defaultView,v5Compat:l=!1}=s,d=a.history,f=Gi.Pop,m=null,y=x();y==null&&(y=0,d.replaceState(Wl({},d.state,{idx:y}),""));function x(){return(d.state||{idx:null}).idx}function E(){f=Gi.Pop;let z=x(),se=z==null?null:z-y;y=z,m&&m({action:f,location:W.location,delta:se})}function C(z,se){f=Gi.Push;let we=Ef(W.location,z,se);y=x()+1;let _e=by(we,y),ve=W.createHref(we);try{d.pushState(_e,"",ve)}catch(L){if(L instanceof DOMException&&L.name==="DataCloneError")throw L;a.location.assign(ve)}l&&m&&m({action:f,location:W.location,delta:1})}function U(z,se){f=Gi.Replace;let we=Ef(W.location,z,se);y=x();let _e=by(we,y),ve=W.createHref(we);d.replaceState(_e,"",ve),l&&m&&m({action:f,location:W.location,delta:0})}function X(z){let se=a.location.origin!=="null"?a.location.origin:a.location.href,we=typeof z=="string"?z:Uu(z);return we=we.replace(/ $/,"%20"),cn(se,"No window.location.(origin|href) available to create URL for href: "+we),new URL(we,se)}let W={get action(){return f},get location(){return n(a,d)},listen(z){if(m)throw new Error("A history only accepts one active listener");return a.addEventListener(Sy,E),m=z,()=>{a.removeEventListener(Sy,E),m=null}},createHref(z){return e(a,z)},createURL:X,encodeLocation(z){let se=X(z);return{pathname:se.pathname,search:se.search,hash:se.hash}},push:C,replace:U,go(z){return d.go(z)}};return W}var Cy;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(Cy||(Cy={}));function OE(n,e,t){return t===void 0&&(t="/"),FE(n,e,t)}function FE(n,e,t,s){let a=typeof e=="string"?Go(e):e,l=ip(a.pathname||"/",t);if(l==null)return null;let d=A_(n);UE(d);let f=null;for(let m=0;f==null&&m<d.length;++m){let y=XE(l);f=QE(d[m],y)}return f}function A_(n,e,t,s){e===void 0&&(e=[]),t===void 0&&(t=[]),s===void 0&&(s="");let a=(l,d,f)=>{let m={relativePath:f===void 0?l.path||"":f,caseSensitive:l.caseSensitive===!0,childrenIndex:d,route:l};m.relativePath.startsWith("/")&&(cn(m.relativePath.startsWith(s),'Absolute route path "'+m.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),m.relativePath=m.relativePath.slice(s.length));let y=Ki([s,m.relativePath]),x=t.concat(m);l.children&&l.children.length>0&&(cn(l.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+y+'".')),A_(l.children,e,x,y)),!(l.path==null&&!l.index)&&e.push({path:y,score:HE(y,l.index),routesMeta:x})};return n.forEach((l,d)=>{var f;if(l.path===""||!((f=l.path)!=null&&f.includes("?")))a(l,d);else for(let m of j_(l.path))a(l,d,m)}),e}function j_(n){let e=n.split("/");if(e.length===0)return[];let[t,...s]=e,a=t.endsWith("?"),l=t.replace(/\?$/,"");if(s.length===0)return a?[l,""]:[l];let d=j_(s.join("/")),f=[];return f.push(...d.map(m=>m===""?l:[l,m].join("/"))),a&&f.push(...d),f.map(m=>n.startsWith("/")&&m===""?"/":m)}function UE(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:KE(e.routesMeta.map(s=>s.childrenIndex),t.routesMeta.map(s=>s.childrenIndex)))}const zE=/^:[\w-]+$/,$E=3,BE=2,WE=1,GE=10,qE=-2,Iy=n=>n==="*";function HE(n,e){let t=n.split("/"),s=t.length;return t.some(Iy)&&(s+=qE),e&&(s+=BE),t.filter(a=>!Iy(a)).reduce((a,l)=>a+(zE.test(l)?$E:l===""?WE:GE),s)}function KE(n,e){return n.length===e.length&&n.slice(0,-1).every((s,a)=>s===e[a])?n[n.length-1]-e[e.length-1]:0}function QE(n,e,t){let{routesMeta:s}=n,a={},l="/",d=[];for(let f=0;f<s.length;++f){let m=s[f],y=f===s.length-1,x=l==="/"?e:e.slice(l.length)||"/",E=YE({path:m.relativePath,caseSensitive:m.caseSensitive,end:y},x),C=m.route;if(!E)return null;Object.assign(a,E.params),d.push({params:a,pathname:Ki([l,E.pathname]),pathnameBase:r1(Ki([l,E.pathnameBase])),route:C}),E.pathnameBase!=="/"&&(l=Ki([l,E.pathnameBase]))}return d}function YE(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,s]=JE(n.path,n.caseSensitive,n.end),a=e.match(t);if(!a)return null;let l=a[0],d=l.replace(/(.)\/+$/,"$1"),f=a.slice(1);return{params:s.reduce((y,x,E)=>{let{paramName:C,isOptional:U}=x;if(C==="*"){let W=f[E]||"";d=l.slice(0,l.length-W.length).replace(/(.)\/+$/,"$1")}const X=f[E];return U&&!X?y[C]=void 0:y[C]=(X||"").replace(/%2F/g,"/"),y},{}),pathname:l,pathnameBase:d,pattern:n}}function JE(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),sp(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let s=[],a="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,f,m)=>(s.push({paramName:f,isOptional:m!=null}),m?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(s.push({paramName:"*"}),a+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?a+="\\/*$":n!==""&&n!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),s]}function XE(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return sp(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function ip(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,s=n.charAt(t);return s&&s!=="/"?null:n.slice(t)||"/"}const ZE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,e1=n=>ZE.test(n);function t1(n,e){e===void 0&&(e="/");let{pathname:t,search:s="",hash:a=""}=typeof n=="string"?Go(n):n,l;if(t)if(e1(t))l=t;else{if(t.includes("//")){let d=t;t=t.replace(/\/\/+/g,"/"),sp(!1,"Pathnames cannot have embedded double slashes - normalizing "+(d+" -> "+t))}t.startsWith("/")?l=Ny(t.substring(1),"/"):l=Ny(t,e)}else l=e;return{pathname:l,search:s1(s),hash:i1(a)}}function Ny(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(a=>{a===".."?t.length>1&&t.pop():a!=="."&&t.push(a)}),t.length>1?t.join("/"):"/"}function af(n,e,t,s){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function n1(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function ap(n,e){let t=n1(n);return e?t.map((s,a)=>a===t.length-1?s.pathname:s.pathnameBase):t.map(s=>s.pathnameBase)}function op(n,e,t,s){s===void 0&&(s=!1);let a;typeof n=="string"?a=Go(n):(a=Wl({},n),cn(!a.pathname||!a.pathname.includes("?"),af("?","pathname","search",a)),cn(!a.pathname||!a.pathname.includes("#"),af("#","pathname","hash",a)),cn(!a.search||!a.search.includes("#"),af("#","search","hash",a)));let l=n===""||a.pathname==="",d=l?"/":a.pathname,f;if(d==null)f=t;else{let E=e.length-1;if(!s&&d.startsWith("..")){let C=d.split("/");for(;C[0]==="..";)C.shift(),E-=1;a.pathname=C.join("/")}f=E>=0?e[E]:"/"}let m=t1(a,f),y=d&&d!=="/"&&d.endsWith("/"),x=(l||d===".")&&t.endsWith("/");return!m.pathname.endsWith("/")&&(y||x)&&(m.pathname+="/"),m}const Ki=n=>n.join("/").replace(/\/\/+/g,"/"),r1=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),s1=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,i1=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function a1(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const k_=["post","put","patch","delete"];new Set(k_);const o1=["get",...k_];new Set(o1);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Gl(){return Gl=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},Gl.apply(this,arguments)}const lp=j.createContext(null),l1=j.createContext(null),oa=j.createContext(null),od=j.createContext(null),la=j.createContext({outlet:null,matches:[],isDataRoute:!1}),D_=j.createContext(null);function c1(n,e){let{relative:t}=e===void 0?{}:e;qo()||cn(!1);let{basename:s,navigator:a}=j.useContext(oa),{hash:l,pathname:d,search:f}=L_(n,{relative:t}),m=d;return s!=="/"&&(m=d==="/"?s:Ki([s,d])),a.createHref({pathname:m,search:f,hash:l})}function qo(){return j.useContext(od)!=null}function Ho(){return qo()||cn(!1),j.useContext(od).location}function V_(n){j.useContext(oa).static||j.useLayoutEffect(n)}function sc(){let{isDataRoute:n}=j.useContext(la);return n?E1():u1()}function u1(){qo()||cn(!1);let n=j.useContext(lp),{basename:e,future:t,navigator:s}=j.useContext(oa),{matches:a}=j.useContext(la),{pathname:l}=Ho(),d=JSON.stringify(ap(a,t.v7_relativeSplatPath)),f=j.useRef(!1);return V_(()=>{f.current=!0}),j.useCallback(function(y,x){if(x===void 0&&(x={}),!f.current)return;if(typeof y=="number"){s.go(y);return}let E=op(y,JSON.parse(d),l,x.relative==="path");n==null&&e!=="/"&&(E.pathname=E.pathname==="/"?e:Ki([e,E.pathname])),(x.replace?s.replace:s.push)(E,x.state,x)},[e,s,d,l,n])}function L_(n,e){let{relative:t}=e===void 0?{}:e,{future:s}=j.useContext(oa),{matches:a}=j.useContext(la),{pathname:l}=Ho(),d=JSON.stringify(ap(a,s.v7_relativeSplatPath));return j.useMemo(()=>op(n,JSON.parse(d),l,t==="path"),[n,d,l,t])}function d1(n,e){return h1(n,e)}function h1(n,e,t,s){qo()||cn(!1);let{navigator:a}=j.useContext(oa),{matches:l}=j.useContext(la),d=l[l.length-1],f=d?d.params:{};d&&d.pathname;let m=d?d.pathnameBase:"/";d&&d.route;let y=Ho(),x;if(e){var E;let z=typeof e=="string"?Go(e):e;m==="/"||(E=z.pathname)!=null&&E.startsWith(m)||cn(!1),x=z}else x=y;let C=x.pathname||"/",U=C;if(m!=="/"){let z=m.replace(/^\//,"").split("/");U="/"+C.replace(/^\//,"").split("/").slice(z.length).join("/")}let X=OE(n,{pathname:U}),W=y1(X&&X.map(z=>Object.assign({},z,{params:Object.assign({},f,z.params),pathname:Ki([m,a.encodeLocation?a.encodeLocation(z.pathname).pathname:z.pathname]),pathnameBase:z.pathnameBase==="/"?m:Ki([m,a.encodeLocation?a.encodeLocation(z.pathnameBase).pathname:z.pathnameBase])})),l,t,s);return e&&W?j.createElement(od.Provider,{value:{location:Gl({pathname:"/",search:"",hash:"",state:null,key:"default"},x),navigationType:Gi.Pop}},W):W}function f1(){let n=w1(),e=a1(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return j.createElement(j.Fragment,null,j.createElement("h2",null,"Unexpected Application Error!"),j.createElement("h3",{style:{fontStyle:"italic"}},e),t?j.createElement("pre",{style:a},t):null,null)}const p1=j.createElement(f1,null);class m1 extends j.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?j.createElement(la.Provider,{value:this.props.routeContext},j.createElement(D_.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function g1(n){let{routeContext:e,match:t,children:s}=n,a=j.useContext(lp);return a&&a.static&&a.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=t.route.id),j.createElement(la.Provider,{value:e},s)}function y1(n,e,t,s){var a;if(e===void 0&&(e=[]),t===void 0&&(t=null),s===void 0&&(s=null),n==null){var l;if(!t)return null;if(t.errors)n=t.matches;else if((l=s)!=null&&l.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let d=n,f=(a=t)==null?void 0:a.errors;if(f!=null){let x=d.findIndex(E=>E.route.id&&(f==null?void 0:f[E.route.id])!==void 0);x>=0||cn(!1),d=d.slice(0,Math.min(d.length,x+1))}let m=!1,y=-1;if(t&&s&&s.v7_partialHydration)for(let x=0;x<d.length;x++){let E=d[x];if((E.route.HydrateFallback||E.route.hydrateFallbackElement)&&(y=x),E.route.id){let{loaderData:C,errors:U}=t,X=E.route.loader&&C[E.route.id]===void 0&&(!U||U[E.route.id]===void 0);if(E.route.lazy||X){m=!0,y>=0?d=d.slice(0,y+1):d=[d[0]];break}}}return d.reduceRight((x,E,C)=>{let U,X=!1,W=null,z=null;t&&(U=f&&E.route.id?f[E.route.id]:void 0,W=E.route.errorElement||p1,m&&(y<0&&C===0?(T1("route-fallback"),X=!0,z=null):y===C&&(X=!0,z=E.route.hydrateFallbackElement||null)));let se=e.concat(d.slice(0,C+1)),we=()=>{let _e;return U?_e=W:X?_e=z:E.route.Component?_e=j.createElement(E.route.Component,null):E.route.element?_e=E.route.element:_e=x,j.createElement(g1,{match:E,routeContext:{outlet:x,matches:se,isDataRoute:t!=null},children:_e})};return t&&(E.route.ErrorBoundary||E.route.errorElement||C===0)?j.createElement(m1,{location:t.location,revalidation:t.revalidation,component:W,error:U,children:we(),routeContext:{outlet:null,matches:se,isDataRoute:!0}}):we()},null)}var M_=(function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n})(M_||{}),O_=(function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n})(O_||{});function v1(n){let e=j.useContext(lp);return e||cn(!1),e}function _1(n){let e=j.useContext(l1);return e||cn(!1),e}function x1(n){let e=j.useContext(la);return e||cn(!1),e}function F_(n){let e=x1(),t=e.matches[e.matches.length-1];return t.route.id||cn(!1),t.route.id}function w1(){var n;let e=j.useContext(D_),t=_1(),s=F_();return e!==void 0?e:(n=t.errors)==null?void 0:n[s]}function E1(){let{router:n}=v1(M_.UseNavigateStable),e=F_(O_.UseNavigateStable),t=j.useRef(!1);return V_(()=>{t.current=!0}),j.useCallback(function(a,l){l===void 0&&(l={}),t.current&&(typeof a=="number"?n.navigate(a):n.navigate(a,Gl({fromRouteId:e},l)))},[n,e])}const Py={};function T1(n,e,t){Py[n]||(Py[n]=!0)}function S1(n,e){n==null||n.v7_startTransition,n==null||n.v7_relativeSplatPath}function Tf(n){let{to:e,replace:t,state:s,relative:a}=n;qo()||cn(!1);let{future:l,static:d}=j.useContext(oa),{matches:f}=j.useContext(la),{pathname:m}=Ho(),y=sc(),x=op(e,ap(f,l.v7_relativeSplatPath),m,a==="path"),E=JSON.stringify(x);return j.useEffect(()=>y(JSON.parse(E),{replace:t,state:s,relative:a}),[y,E,a,t,s]),null}function as(n){cn(!1)}function b1(n){let{basename:e="/",children:t=null,location:s,navigationType:a=Gi.Pop,navigator:l,static:d=!1,future:f}=n;qo()&&cn(!1);let m=e.replace(/^\/*/,"/"),y=j.useMemo(()=>({basename:m,navigator:l,static:d,future:Gl({v7_relativeSplatPath:!1},f)}),[m,f,l,d]);typeof s=="string"&&(s=Go(s));let{pathname:x="/",search:E="",hash:C="",state:U=null,key:X="default"}=s,W=j.useMemo(()=>{let z=ip(x,m);return z==null?null:{location:{pathname:z,search:E,hash:C,state:U,key:X},navigationType:a}},[m,x,E,C,U,X,a]);return W==null?null:j.createElement(oa.Provider,{value:y},j.createElement(od.Provider,{children:t,value:W}))}function C1(n){let{children:e,location:t}=n;return d1(Sf(e),t)}new Promise(()=>{});function Sf(n,e){e===void 0&&(e=[]);let t=[];return j.Children.forEach(n,(s,a)=>{if(!j.isValidElement(s))return;let l=[...e,a];if(s.type===j.Fragment){t.push.apply(t,Sf(s.props.children,l));return}s.type!==as&&cn(!1),!s.props.index||!s.props.children||cn(!1);let d={id:s.props.id||l.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(d.children=Sf(s.props.children,l)),t.push(d)}),t}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function bf(){return bf=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},bf.apply(this,arguments)}function I1(n,e){if(n==null)return{};var t={},s=Object.keys(n),a,l;for(l=0;l<s.length;l++)a=s[l],!(e.indexOf(a)>=0)&&(t[a]=n[a]);return t}function N1(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function P1(n,e){return n.button===0&&(!e||e==="_self")&&!N1(n)}function Cf(n){return n===void 0&&(n=""),new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((e,t)=>{let s=n[t];return e.concat(Array.isArray(s)?s.map(a=>[t,a]):[[t,s]])},[]))}function R1(n,e){let t=Cf(n);return e&&e.forEach((s,a)=>{t.has(a)||e.getAll(a).forEach(l=>{t.append(a,l)})}),t}const A1=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],j1="6";try{window.__reactRouterVersion=j1}catch{}const k1="startTransition",Ry=NE[k1];function D1(n){let{basename:e,children:t,future:s,window:a}=n,l=j.useRef();l.current==null&&(l.current=VE({window:a,v5Compat:!0}));let d=l.current,[f,m]=j.useState({action:d.action,location:d.location}),{v7_startTransition:y}=s||{},x=j.useCallback(E=>{y&&Ry?Ry(()=>m(E)):m(E)},[m,y]);return j.useLayoutEffect(()=>d.listen(x),[d,x]),j.useEffect(()=>S1(s),[s]),j.createElement(b1,{basename:e,children:t,location:f.location,navigationType:f.action,navigator:d,future:s})}const V1=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",L1=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ui=j.forwardRef(function(e,t){let{onClick:s,relative:a,reloadDocument:l,replace:d,state:f,target:m,to:y,preventScrollReset:x,viewTransition:E}=e,C=I1(e,A1),{basename:U}=j.useContext(oa),X,W=!1;if(typeof y=="string"&&L1.test(y)&&(X=y,V1))try{let _e=new URL(window.location.href),ve=y.startsWith("//")?new URL(_e.protocol+y):new URL(y),L=ip(ve.pathname,U);ve.origin===_e.origin&&L!=null?y=L+ve.search+ve.hash:W=!0}catch{}let z=c1(y,{relative:a}),se=M1(y,{replace:d,state:f,target:m,preventScrollReset:x,relative:a,viewTransition:E});function we(_e){s&&s(_e),_e.defaultPrevented||se(_e)}return j.createElement("a",bf({},C,{href:X||z,onClick:W||l?s:we,ref:t,target:m}))});var Ay;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(Ay||(Ay={}));var jy;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(jy||(jy={}));function M1(n,e){let{target:t,replace:s,state:a,preventScrollReset:l,relative:d,viewTransition:f}=e===void 0?{}:e,m=sc(),y=Ho(),x=L_(n,{relative:d});return j.useCallback(E=>{if(P1(E,t)){E.preventDefault();let C=s!==void 0?s:Uu(y)===Uu(x);m(n,{replace:C,state:a,preventScrollReset:l,relative:d,viewTransition:f})}},[y,m,x,s,a,t,n,l,d,f])}function O1(n){let e=j.useRef(Cf(n)),t=j.useRef(!1),s=Ho(),a=j.useMemo(()=>R1(s.search,t.current?null:e.current),[s.search]),l=sc(),d=j.useCallback((f,m)=>{const y=Cf(typeof f=="function"?f(a):f);t.current=!0,l("?"+y,m)},[l,a]);return[a,d]}const F1=()=>{};var ky={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U_=function(n){const e=[];let t=0;for(let s=0;s<n.length;s++){let a=n.charCodeAt(s);a<128?e[t++]=a:a<2048?(e[t++]=a>>6|192,e[t++]=a&63|128):(a&64512)===55296&&s+1<n.length&&(n.charCodeAt(s+1)&64512)===56320?(a=65536+((a&1023)<<10)+(n.charCodeAt(++s)&1023),e[t++]=a>>18|240,e[t++]=a>>12&63|128,e[t++]=a>>6&63|128,e[t++]=a&63|128):(e[t++]=a>>12|224,e[t++]=a>>6&63|128,e[t++]=a&63|128)}return e},U1=function(n){const e=[];let t=0,s=0;for(;t<n.length;){const a=n[t++];if(a<128)e[s++]=String.fromCharCode(a);else if(a>191&&a<224){const l=n[t++];e[s++]=String.fromCharCode((a&31)<<6|l&63)}else if(a>239&&a<365){const l=n[t++],d=n[t++],f=n[t++],m=((a&7)<<18|(l&63)<<12|(d&63)<<6|f&63)-65536;e[s++]=String.fromCharCode(55296+(m>>10)),e[s++]=String.fromCharCode(56320+(m&1023))}else{const l=n[t++],d=n[t++];e[s++]=String.fromCharCode((a&15)<<12|(l&63)<<6|d&63)}}return e.join("")},z_={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let a=0;a<n.length;a+=3){const l=n[a],d=a+1<n.length,f=d?n[a+1]:0,m=a+2<n.length,y=m?n[a+2]:0,x=l>>2,E=(l&3)<<4|f>>4;let C=(f&15)<<2|y>>6,U=y&63;m||(U=64,d||(C=64)),s.push(t[x],t[E],t[C],t[U])}return s.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(U_(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):U1(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let a=0;a<n.length;){const l=t[n.charAt(a++)],f=a<n.length?t[n.charAt(a)]:0;++a;const y=a<n.length?t[n.charAt(a)]:64;++a;const E=a<n.length?t[n.charAt(a)]:64;if(++a,l==null||f==null||y==null||E==null)throw new z1;const C=l<<2|f>>4;if(s.push(C),y!==64){const U=f<<4&240|y>>2;if(s.push(U),E!==64){const X=y<<6&192|E;s.push(X)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class z1 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const $1=function(n){const e=U_(n);return z_.encodeByteArray(e,!0)},zu=function(n){return $1(n).replace(/\./g,"")},$_=function(n){try{return z_.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B1(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W1=()=>B1().__FIREBASE_DEFAULTS__,G1=()=>{if(typeof process>"u"||typeof ky>"u")return;const n=ky.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},q1=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&$_(n[1]);return e&&JSON.parse(e)},ld=()=>{try{return F1()||W1()||G1()||q1()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},B_=n=>{var e,t;return(t=(e=ld())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},H1=n=>{const e=B_(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),s]:[e.substring(0,t),s]},W_=()=>{var n;return(n=ld())===null||n===void 0?void 0:n.config},G_=n=>{var e;return(e=ld())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K1{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,s)=>{t?this.reject(t):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,s))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ko(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function q_(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q1(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},s=e||"demo-project",a=n.iat||0,l=n.sub||n.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d=Object.assign({iss:`https://securetoken.google.com/${s}`,aud:s,iat:a,exp:a+3600,auth_time:a,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}}},n);return[zu(JSON.stringify(t)),zu(JSON.stringify(d)),""].join(".")}const Ml={};function Y1(){const n={prod:[],emulator:[]};for(const e of Object.keys(Ml))Ml[e]?n.emulator.push(e):n.prod.push(e);return n}function J1(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let Dy=!1;function H_(n,e){if(typeof window>"u"||typeof document>"u"||!Ko(window.location.host)||Ml[n]===e||Ml[n]||Dy)return;Ml[n]=e;function t(C){return`__firebase__banner__${C}`}const s="__firebase__banner",l=Y1().prod.length>0;function d(){const C=document.getElementById(s);C&&C.remove()}function f(C){C.style.display="flex",C.style.background="#7faaf0",C.style.position="fixed",C.style.bottom="5px",C.style.left="5px",C.style.padding=".5em",C.style.borderRadius="5px",C.style.alignItems="center"}function m(C,U){C.setAttribute("width","24"),C.setAttribute("id",U),C.setAttribute("height","24"),C.setAttribute("viewBox","0 0 24 24"),C.setAttribute("fill","none"),C.style.marginLeft="-6px"}function y(){const C=document.createElement("span");return C.style.cursor="pointer",C.style.marginLeft="16px",C.style.fontSize="24px",C.innerHTML=" &times;",C.onclick=()=>{Dy=!0,d()},C}function x(C,U){C.setAttribute("id",U),C.innerText="Learn more",C.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",C.setAttribute("target","__blank"),C.style.paddingLeft="5px",C.style.textDecoration="underline"}function E(){const C=J1(s),U=t("text"),X=document.getElementById(U)||document.createElement("span"),W=t("learnmore"),z=document.getElementById(W)||document.createElement("a"),se=t("preprendIcon"),we=document.getElementById(se)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(C.created){const _e=C.element;f(_e),x(z,W);const ve=y();m(we,se),_e.append(we,X,z,ve),document.body.appendChild(_e)}l?(X.innerText="Preview backend disconnected.",we.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(we.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,X.innerText="Preview backend running in this workspace."),X.setAttribute("id",U)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",E):E()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function or(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function X1(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(or())}function Z1(){var n;const e=(n=ld())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function eT(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function tT(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function nT(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function rT(){const n=or();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function sT(){return!Z1()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function iT(){try{return typeof indexedDB=="object"}catch{return!1}}function aT(){return new Promise((n,e)=>{try{let t=!0;const s="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(s);a.onsuccess=()=>{a.result.close(),t||self.indexedDB.deleteDatabase(s),n(!0)},a.onupgradeneeded=()=>{t=!1},a.onerror=()=>{var l;e(((l=a.error)===null||l===void 0?void 0:l.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oT="FirebaseError";class wi extends Error{constructor(e,t,s){super(t),this.code=e,this.customData=s,this.name=oT,Object.setPrototypeOf(this,wi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ic.prototype.create)}}class ic{constructor(e,t,s){this.service=e,this.serviceName=t,this.errors=s}create(e,...t){const s=t[0]||{},a=`${this.service}/${e}`,l=this.errors[e],d=l?lT(l,s):"Error",f=`${this.serviceName}: ${d} (${a}).`;return new wi(a,f,s)}}function lT(n,e){return n.replace(cT,(t,s)=>{const a=e[s];return a!=null?String(a):`<${s}?>`})}const cT=/\{\$([^}]+)}/g;function uT(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function $a(n,e){if(n===e)return!0;const t=Object.keys(n),s=Object.keys(e);for(const a of t){if(!s.includes(a))return!1;const l=n[a],d=e[a];if(Vy(l)&&Vy(d)){if(!$a(l,d))return!1}else if(l!==d)return!1}for(const a of s)if(!t.includes(a))return!1;return!0}function Vy(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ac(n){const e=[];for(const[t,s]of Object.entries(n))Array.isArray(s)?s.forEach(a=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function Al(n){const e={};return n.replace(/^\?/,"").split("&").forEach(s=>{if(s){const[a,l]=s.split("=");e[decodeURIComponent(a)]=decodeURIComponent(l)}}),e}function jl(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function dT(n,e){const t=new hT(n,e);return t.subscribe.bind(t)}class hT{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,s){let a;if(e===void 0&&t===void 0&&s===void 0)throw new Error("Missing Observer.");fT(e,["next","error","complete"])?a=e:a={next:e,error:t,complete:s},a.next===void 0&&(a.next=of),a.error===void 0&&(a.error=of),a.complete===void 0&&(a.complete=of);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function fT(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function of(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rn(n){return n&&n._delegate?n._delegate:n}class Ba{constructor(e,t,s){this.name=e,this.instanceFactory=t,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ka="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pT{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const s=new K1;if(this.instancesDeferred.set(t,s),this.isInitialized(t)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:t});a&&s.resolve(a)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const s=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),a=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(s)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:s})}catch(l){if(a)return null;throw l}else{if(a)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(gT(e))try{this.getOrInitializeService({instanceIdentifier:ka})}catch{}for(const[t,s]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(t);try{const l=this.getOrInitializeService({instanceIdentifier:a});s.resolve(l)}catch{}}}}clearInstance(e=ka){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ka){return this.instances.has(e)}getOptions(e=ka){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:s,options:t});for(const[l,d]of this.instancesDeferred.entries()){const f=this.normalizeInstanceIdentifier(l);s===f&&d.resolve(a)}return a}onInit(e,t){var s;const a=this.normalizeInstanceIdentifier(t),l=(s=this.onInitCallbacks.get(a))!==null&&s!==void 0?s:new Set;l.add(e),this.onInitCallbacks.set(a,l);const d=this.instances.get(a);return d&&e(d,a),()=>{l.delete(e)}}invokeOnInitCallbacks(e,t){const s=this.onInitCallbacks.get(t);if(s)for(const a of s)try{a(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:mT(e),options:t}),this.instances.set(e,s),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=ka){return this.component?this.component.multipleInstances?e:ka:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function mT(n){return n===ka?void 0:n}function gT(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yT{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new pT(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _t;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(_t||(_t={}));const vT={debug:_t.DEBUG,verbose:_t.VERBOSE,info:_t.INFO,warn:_t.WARN,error:_t.ERROR,silent:_t.SILENT},_T=_t.INFO,xT={[_t.DEBUG]:"log",[_t.VERBOSE]:"log",[_t.INFO]:"info",[_t.WARN]:"warn",[_t.ERROR]:"error"},wT=(n,e,...t)=>{if(e<n.logLevel)return;const s=new Date().toISOString(),a=xT[e];if(a)console[a](`[${s}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class cp{constructor(e){this.name=e,this._logLevel=_T,this._logHandler=wT,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in _t))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?vT[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,_t.DEBUG,...e),this._logHandler(this,_t.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,_t.VERBOSE,...e),this._logHandler(this,_t.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,_t.INFO,...e),this._logHandler(this,_t.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,_t.WARN,...e),this._logHandler(this,_t.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,_t.ERROR,...e),this._logHandler(this,_t.ERROR,...e)}}const ET=(n,e)=>e.some(t=>n instanceof t);let Ly,My;function TT(){return Ly||(Ly=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ST(){return My||(My=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const K_=new WeakMap,If=new WeakMap,Q_=new WeakMap,lf=new WeakMap,up=new WeakMap;function bT(n){const e=new Promise((t,s)=>{const a=()=>{n.removeEventListener("success",l),n.removeEventListener("error",d)},l=()=>{t(Qi(n.result)),a()},d=()=>{s(n.error),a()};n.addEventListener("success",l),n.addEventListener("error",d)});return e.then(t=>{t instanceof IDBCursor&&K_.set(t,n)}).catch(()=>{}),up.set(e,n),e}function CT(n){if(If.has(n))return;const e=new Promise((t,s)=>{const a=()=>{n.removeEventListener("complete",l),n.removeEventListener("error",d),n.removeEventListener("abort",d)},l=()=>{t(),a()},d=()=>{s(n.error||new DOMException("AbortError","AbortError")),a()};n.addEventListener("complete",l),n.addEventListener("error",d),n.addEventListener("abort",d)});If.set(n,e)}let Nf={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return If.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Q_.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Qi(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function IT(n){Nf=n(Nf)}function NT(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const s=n.call(cf(this),e,...t);return Q_.set(s,e.sort?e.sort():[e]),Qi(s)}:ST().includes(n)?function(...e){return n.apply(cf(this),e),Qi(K_.get(this))}:function(...e){return Qi(n.apply(cf(this),e))}}function PT(n){return typeof n=="function"?NT(n):(n instanceof IDBTransaction&&CT(n),ET(n,TT())?new Proxy(n,Nf):n)}function Qi(n){if(n instanceof IDBRequest)return bT(n);if(lf.has(n))return lf.get(n);const e=PT(n);return e!==n&&(lf.set(n,e),up.set(e,n)),e}const cf=n=>up.get(n);function RT(n,e,{blocked:t,upgrade:s,blocking:a,terminated:l}={}){const d=indexedDB.open(n,e),f=Qi(d);return s&&d.addEventListener("upgradeneeded",m=>{s(Qi(d.result),m.oldVersion,m.newVersion,Qi(d.transaction),m)}),t&&d.addEventListener("blocked",m=>t(m.oldVersion,m.newVersion,m)),f.then(m=>{l&&m.addEventListener("close",()=>l()),a&&m.addEventListener("versionchange",y=>a(y.oldVersion,y.newVersion,y))}).catch(()=>{}),f}const AT=["get","getKey","getAll","getAllKeys","count"],jT=["put","add","delete","clear"],uf=new Map;function Oy(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(uf.get(e))return uf.get(e);const t=e.replace(/FromIndex$/,""),s=e!==t,a=jT.includes(t);if(!(t in(s?IDBIndex:IDBObjectStore).prototype)||!(a||AT.includes(t)))return;const l=async function(d,...f){const m=this.transaction(d,a?"readwrite":"readonly");let y=m.store;return s&&(y=y.index(f.shift())),(await Promise.all([y[t](...f),a&&m.done]))[0]};return uf.set(e,l),l}IT(n=>({...n,get:(e,t,s)=>Oy(e,t)||n.get(e,t,s),has:(e,t)=>!!Oy(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kT{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(DT(t)){const s=t.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(t=>t).join(" ")}}function DT(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Pf="@firebase/app",Fy="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pi=new cp("@firebase/app"),VT="@firebase/app-compat",LT="@firebase/analytics-compat",MT="@firebase/analytics",OT="@firebase/app-check-compat",FT="@firebase/app-check",UT="@firebase/auth",zT="@firebase/auth-compat",$T="@firebase/database",BT="@firebase/data-connect",WT="@firebase/database-compat",GT="@firebase/functions",qT="@firebase/functions-compat",HT="@firebase/installations",KT="@firebase/installations-compat",QT="@firebase/messaging",YT="@firebase/messaging-compat",JT="@firebase/performance",XT="@firebase/performance-compat",ZT="@firebase/remote-config",eS="@firebase/remote-config-compat",tS="@firebase/storage",nS="@firebase/storage-compat",rS="@firebase/firestore",sS="@firebase/ai",iS="@firebase/firestore-compat",aS="firebase",oS="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rf="[DEFAULT]",lS={[Pf]:"fire-core",[VT]:"fire-core-compat",[MT]:"fire-analytics",[LT]:"fire-analytics-compat",[FT]:"fire-app-check",[OT]:"fire-app-check-compat",[UT]:"fire-auth",[zT]:"fire-auth-compat",[$T]:"fire-rtdb",[BT]:"fire-data-connect",[WT]:"fire-rtdb-compat",[GT]:"fire-fn",[qT]:"fire-fn-compat",[HT]:"fire-iid",[KT]:"fire-iid-compat",[QT]:"fire-fcm",[YT]:"fire-fcm-compat",[JT]:"fire-perf",[XT]:"fire-perf-compat",[ZT]:"fire-rc",[eS]:"fire-rc-compat",[tS]:"fire-gcs",[nS]:"fire-gcs-compat",[rS]:"fire-fst",[iS]:"fire-fst-compat",[sS]:"fire-vertex","fire-js":"fire-js",[aS]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $u=new Map,cS=new Map,Af=new Map;function Uy(n,e){try{n.container.addComponent(e)}catch(t){pi.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Oo(n){const e=n.name;if(Af.has(e))return pi.debug(`There were multiple attempts to register component ${e}.`),!1;Af.set(e,n);for(const t of $u.values())Uy(t,n);for(const t of cS.values())Uy(t,n);return!0}function dp(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function $r(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uS={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Yi=new ic("app","Firebase",uS);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dS{constructor(e,t,s){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new Ba("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Yi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qo=oS;function Y_(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const s=Object.assign({name:Rf,automaticDataCollectionEnabled:!0},e),a=s.name;if(typeof a!="string"||!a)throw Yi.create("bad-app-name",{appName:String(a)});if(t||(t=W_()),!t)throw Yi.create("no-options");const l=$u.get(a);if(l){if($a(t,l.options)&&$a(s,l.config))return l;throw Yi.create("duplicate-app",{appName:a})}const d=new yT(a);for(const m of Af.values())d.addComponent(m);const f=new dS(t,s,d);return $u.set(a,f),f}function J_(n=Rf){const e=$u.get(n);if(!e&&n===Rf&&W_())return Y_();if(!e)throw Yi.create("no-app",{appName:n});return e}function Ji(n,e,t){var s;let a=(s=lS[n])!==null&&s!==void 0?s:n;t&&(a+=`-${t}`);const l=a.match(/\s|\//),d=e.match(/\s|\//);if(l||d){const f=[`Unable to register library "${a}" with version "${e}":`];l&&f.push(`library name "${a}" contains illegal characters (whitespace or "/")`),l&&d&&f.push("and"),d&&f.push(`version name "${e}" contains illegal characters (whitespace or "/")`),pi.warn(f.join(" "));return}Oo(new Ba(`${a}-version`,()=>({library:a,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hS="firebase-heartbeat-database",fS=1,ql="firebase-heartbeat-store";let df=null;function X_(){return df||(df=RT(hS,fS,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(ql)}catch(t){console.warn(t)}}}}).catch(n=>{throw Yi.create("idb-open",{originalErrorMessage:n.message})})),df}async function pS(n){try{const t=(await X_()).transaction(ql),s=await t.objectStore(ql).get(Z_(n));return await t.done,s}catch(e){if(e instanceof wi)pi.warn(e.message);else{const t=Yi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});pi.warn(t.message)}}}async function zy(n,e){try{const s=(await X_()).transaction(ql,"readwrite");await s.objectStore(ql).put(e,Z_(n)),await s.done}catch(t){if(t instanceof wi)pi.warn(t.message);else{const s=Yi.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});pi.warn(s.message)}}}function Z_(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mS=1024,gS=30;class yS{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new _S(t),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){var e,t;try{const a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),l=$y();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===l||this._heartbeatsCache.heartbeats.some(d=>d.date===l))return;if(this._heartbeatsCache.heartbeats.push({date:l,agent:a}),this._heartbeatsCache.heartbeats.length>gS){const d=xS(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(d,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(s){pi.warn(s)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=$y(),{heartbeatsToSend:s,unsentEntries:a}=vS(this._heartbeatsCache.heartbeats),l=zu(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=t,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(t){return pi.warn(t),""}}}function $y(){return new Date().toISOString().substring(0,10)}function vS(n,e=mS){const t=[];let s=n.slice();for(const a of n){const l=t.find(d=>d.agent===a.agent);if(l){if(l.dates.push(a.date),By(t)>e){l.dates.pop();break}}else if(t.push({agent:a.agent,dates:[a.date]}),By(t)>e){t.pop();break}s=s.slice(1)}return{heartbeatsToSend:t,unsentEntries:s}}class _S{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return iT()?aT().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await pS(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const a=await this.read();return zy(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:a.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const a=await this.read();return zy(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:a.lastSentHeartbeatDate,heartbeats:[...a.heartbeats,...e.heartbeats]})}else return}}function By(n){return zu(JSON.stringify({version:2,heartbeats:n})).length}function xS(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let s=1;s<n.length;s++)n[s].date<t&&(t=n[s].date,e=s);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wS(n){Oo(new Ba("platform-logger",e=>new kT(e),"PRIVATE")),Oo(new Ba("heartbeat",e=>new yS(e),"PRIVATE")),Ji(Pf,Fy,n),Ji(Pf,Fy,"esm2017"),Ji("fire-js","")}wS("");var ES="firebase",TS="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ji(ES,TS,"app");function hp(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(n);a<s.length;a++)e.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(n,s[a])&&(t[s[a]]=n[s[a]]);return t}function e0(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const SS=e0,t0=new ic("auth","Firebase",e0());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bu=new cp("@firebase/auth");function bS(n,...e){Bu.logLevel<=_t.WARN&&Bu.warn(`Auth (${Qo}): ${n}`,...e)}function Iu(n,...e){Bu.logLevel<=_t.ERROR&&Bu.error(`Auth (${Qo}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function us(n,...e){throw pp(n,...e)}function Rs(n,...e){return pp(n,...e)}function fp(n,e,t){const s=Object.assign(Object.assign({},SS()),{[e]:t});return new ic("auth","Firebase",s).create(e,{appName:n.name})}function hi(n){return fp(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function n0(n,e,t){const s=t;if(!(e instanceof s))throw s.name!==e.constructor.name&&us(n,"argument-error"),fp(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function pp(n,...e){if(typeof n!="string"){const t=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=n.name),n._errorFactory.create(t,...s)}return t0.create(n,...e)}function tt(n,e,...t){if(!n)throw pp(e,...t)}function ui(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Iu(e),new Error(e)}function mi(n,e){n||ui(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jf(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function CS(){return Wy()==="http:"||Wy()==="https:"}function Wy(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IS(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(CS()||tT()||"connection"in navigator)?navigator.onLine:!0}function NS(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oc{constructor(e,t){this.shortDelay=e,this.longDelay=t,mi(t>e,"Short delay should be less than long delay!"),this.isMobile=X1()||nT()}get(){return IS()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mp(n,e){mi(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r0{static initialize(e,t,s){this.fetchImpl=e,t&&(this.headersImpl=t),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ui("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ui("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ui("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PS={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RS=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],AS=new oc(3e4,6e4);function ca(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function Zs(n,e,t,s,a={}){return s0(n,a,async()=>{let l={},d={};s&&(e==="GET"?d=s:l={body:JSON.stringify(s)});const f=ac(Object.assign({key:n.config.apiKey},d)).slice(1),m=await n._getAdditionalHeaders();m["Content-Type"]="application/json",n.languageCode&&(m["X-Firebase-Locale"]=n.languageCode);const y=Object.assign({method:e,headers:m},l);return eT()||(y.referrerPolicy="no-referrer"),n.emulatorConfig&&Ko(n.emulatorConfig.host)&&(y.credentials="include"),r0.fetch()(await i0(n,n.config.apiHost,t,f),y)})}async function s0(n,e,t){n._canInitEmulator=!1;const s=Object.assign(Object.assign({},PS),e);try{const a=new kS(n),l=await Promise.race([t(),a.promise]);a.clearNetworkTimeout();const d=await l.json();if("needConfirmation"in d)throw _u(n,"account-exists-with-different-credential",d);if(l.ok&&!("errorMessage"in d))return d;{const f=l.ok?d.errorMessage:d.error.message,[m,y]=f.split(" : ");if(m==="FEDERATED_USER_ID_ALREADY_LINKED")throw _u(n,"credential-already-in-use",d);if(m==="EMAIL_EXISTS")throw _u(n,"email-already-in-use",d);if(m==="USER_DISABLED")throw _u(n,"user-disabled",d);const x=s[m]||m.toLowerCase().replace(/[_\s]+/g,"-");if(y)throw fp(n,x,y);us(n,x)}}catch(a){if(a instanceof wi)throw a;us(n,"network-request-failed",{message:String(a)})}}async function lc(n,e,t,s,a={}){const l=await Zs(n,e,t,s,a);return"mfaPendingCredential"in l&&us(n,"multi-factor-auth-required",{_serverResponse:l}),l}async function i0(n,e,t,s){const a=`${e}${t}?${s}`,l=n,d=l.config.emulator?mp(n.config,a):`${n.config.apiScheme}://${a}`;return RS.includes(t)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(d).toString():d}function jS(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class kS{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,s)=>{this.timer=setTimeout(()=>s(Rs(this.auth,"network-request-failed")),AS.get())})}}function _u(n,e,t){const s={appName:n.name};t.email&&(s.email=t.email),t.phoneNumber&&(s.phoneNumber=t.phoneNumber);const a=Rs(n,e,s);return a.customData._tokenResponse=t,a}function Gy(n){return n!==void 0&&n.enterprise!==void 0}class DS{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return jS(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function VS(n,e){return Zs(n,"GET","/v2/recaptchaConfig",ca(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LS(n,e){return Zs(n,"POST","/v1/accounts:delete",e)}async function MS(n,e){return Zs(n,"POST","/v1/accounts:update",e)}async function Wu(n,e){return Zs(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ol(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function OS(n,e=!1){const t=rn(n),s=await t.getIdToken(e),a=gp(s);tt(a&&a.exp&&a.auth_time&&a.iat,t.auth,"internal-error");const l=typeof a.firebase=="object"?a.firebase:void 0,d=l==null?void 0:l.sign_in_provider;return{claims:a,token:s,authTime:Ol(hf(a.auth_time)),issuedAtTime:Ol(hf(a.iat)),expirationTime:Ol(hf(a.exp)),signInProvider:d||null,signInSecondFactor:(l==null?void 0:l.sign_in_second_factor)||null}}function hf(n){return Number(n)*1e3}function gp(n){const[e,t,s]=n.split(".");if(e===void 0||t===void 0||s===void 0)return Iu("JWT malformed, contained fewer than 3 sections"),null;try{const a=$_(t);return a?JSON.parse(a):(Iu("Failed to decode base64 JWT payload"),null)}catch(a){return Iu("Caught error parsing JWT payload as JSON",a==null?void 0:a.toString()),null}}function qy(n){const e=gp(n);return tt(e,"internal-error"),tt(typeof e.exp<"u","internal-error"),tt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Fo(n,e,t=!1){if(t)return e;try{return await e}catch(s){throw s instanceof wi&&FS(s)&&n.auth.currentUser===n&&await n.auth.signOut(),s}}function FS({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class US{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const s=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),s}else{this.errorBackoff=3e4;const a=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,a)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kf{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ol(this.lastLoginAt),this.creationTime=Ol(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Hl(n){var e;const t=n.auth,s=await n.getIdToken(),a=await Fo(n,Wu(t,{idToken:s}));tt(a==null?void 0:a.users.length,t,"internal-error");const l=a.users[0];n._notifyReloadListener(l);const d=!((e=l.providerUserInfo)===null||e===void 0)&&e.length?a0(l.providerUserInfo):[],f=$S(n.providerData,d),m=n.isAnonymous,y=!(n.email&&l.passwordHash)&&!(f!=null&&f.length),x=m?y:!1,E={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:f,metadata:new kf(l.createdAt,l.lastLoginAt),isAnonymous:x};Object.assign(n,E)}async function zS(n){const e=rn(n);await Hl(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function $S(n,e){return[...n.filter(s=>!e.some(a=>a.providerId===s.providerId)),...e]}function a0(n){return n.map(e=>{var{providerId:t}=e,s=hp(e,["providerId"]);return{providerId:t,uid:s.rawId||"",displayName:s.displayName||null,email:s.email||null,phoneNumber:s.phoneNumber||null,photoURL:s.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BS(n,e){const t=await s0(n,{},async()=>{const s=ac({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:l}=n.config,d=await i0(n,a,"/v1/token",`key=${l}`),f=await n._getAdditionalHeaders();f["Content-Type"]="application/x-www-form-urlencoded";const m={method:"POST",headers:f,body:s};return n.emulatorConfig&&Ko(n.emulatorConfig.host)&&(m.credentials="include"),r0.fetch()(d,m)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function WS(n,e){return Zs(n,"POST","/v2/accounts:revokeToken",ca(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Do{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){tt(e.idToken,"internal-error"),tt(typeof e.idToken<"u","internal-error"),tt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):qy(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){tt(e.length!==0,"internal-error");const t=qy(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(tt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:s,refreshToken:a,expiresIn:l}=await BS(e,t);this.updateTokensAndExpiration(s,a,Number(l))}updateTokensAndExpiration(e,t,s){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,t){const{refreshToken:s,accessToken:a,expirationTime:l}=t,d=new Do;return s&&(tt(typeof s=="string","internal-error",{appName:e}),d.refreshToken=s),a&&(tt(typeof a=="string","internal-error",{appName:e}),d.accessToken=a),l&&(tt(typeof l=="number","internal-error",{appName:e}),d.expirationTime=l),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Do,this.toJSON())}_performRefresh(){return ui("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zi(n,e){tt(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Ps{constructor(e){var{uid:t,auth:s,stsTokenManager:a}=e,l=hp(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new US(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=s,this.stsTokenManager=a,this.accessToken=a.accessToken,this.displayName=l.displayName||null,this.email=l.email||null,this.emailVerified=l.emailVerified||!1,this.phoneNumber=l.phoneNumber||null,this.photoURL=l.photoURL||null,this.isAnonymous=l.isAnonymous||!1,this.tenantId=l.tenantId||null,this.providerData=l.providerData?[...l.providerData]:[],this.metadata=new kf(l.createdAt||void 0,l.lastLoginAt||void 0)}async getIdToken(e){const t=await Fo(this,this.stsTokenManager.getToken(this.auth,e));return tt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return OS(this,e)}reload(){return zS(this)}_assign(e){this!==e&&(tt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Ps(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){tt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),t&&await Hl(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if($r(this.auth.app))return Promise.reject(hi(this.auth));const e=await this.getIdToken();return await Fo(this,LS(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var s,a,l,d,f,m,y,x;const E=(s=t.displayName)!==null&&s!==void 0?s:void 0,C=(a=t.email)!==null&&a!==void 0?a:void 0,U=(l=t.phoneNumber)!==null&&l!==void 0?l:void 0,X=(d=t.photoURL)!==null&&d!==void 0?d:void 0,W=(f=t.tenantId)!==null&&f!==void 0?f:void 0,z=(m=t._redirectEventId)!==null&&m!==void 0?m:void 0,se=(y=t.createdAt)!==null&&y!==void 0?y:void 0,we=(x=t.lastLoginAt)!==null&&x!==void 0?x:void 0,{uid:_e,emailVerified:ve,isAnonymous:L,providerData:ie,stsTokenManager:I}=t;tt(_e&&I,e,"internal-error");const N=Do.fromJSON(this.name,I);tt(typeof _e=="string",e,"internal-error"),zi(E,e.name),zi(C,e.name),tt(typeof ve=="boolean",e,"internal-error"),tt(typeof L=="boolean",e,"internal-error"),zi(U,e.name),zi(X,e.name),zi(W,e.name),zi(z,e.name),zi(se,e.name),zi(we,e.name);const A=new Ps({uid:_e,auth:e,email:C,emailVerified:ve,displayName:E,isAnonymous:L,photoURL:X,phoneNumber:U,tenantId:W,stsTokenManager:N,createdAt:se,lastLoginAt:we});return ie&&Array.isArray(ie)&&(A.providerData=ie.map(O=>Object.assign({},O))),z&&(A._redirectEventId=z),A}static async _fromIdTokenResponse(e,t,s=!1){const a=new Do;a.updateFromServerResponse(t);const l=new Ps({uid:t.localId,auth:e,stsTokenManager:a,isAnonymous:s});return await Hl(l),l}static async _fromGetAccountInfoResponse(e,t,s){const a=t.users[0];tt(a.localId!==void 0,"internal-error");const l=a.providerUserInfo!==void 0?a0(a.providerUserInfo):[],d=!(a.email&&a.passwordHash)&&!(l!=null&&l.length),f=new Do;f.updateFromIdToken(s);const m=new Ps({uid:a.localId,auth:e,stsTokenManager:f,isAnonymous:d}),y={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new kf(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!(l!=null&&l.length)};return Object.assign(m,y),m}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hy=new Map;function di(n){mi(n instanceof Function,"Expected a class definition");let e=Hy.get(n);return e?(mi(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Hy.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o0{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}o0.type="NONE";const Ky=o0;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nu(n,e,t){return`firebase:${n}:${e}:${t}`}class Vo{constructor(e,t,s){this.persistence=e,this.auth=t,this.userKey=s;const{config:a,name:l}=this.auth;this.fullUserKey=Nu(this.userKey,a.apiKey,l),this.fullPersistenceKey=Nu("persistence",a.apiKey,l),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Wu(this.auth,{idToken:e}).catch(()=>{});return t?Ps._fromGetAccountInfoResponse(this.auth,t,e):null}return Ps._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,s="authUser"){if(!t.length)return new Vo(di(Ky),e,s);const a=(await Promise.all(t.map(async y=>{if(await y._isAvailable())return y}))).filter(y=>y);let l=a[0]||di(Ky);const d=Nu(s,e.config.apiKey,e.name);let f=null;for(const y of t)try{const x=await y._get(d);if(x){let E;if(typeof x=="string"){const C=await Wu(e,{idToken:x}).catch(()=>{});if(!C)break;E=await Ps._fromGetAccountInfoResponse(e,C,x)}else E=Ps._fromJSON(e,x);y!==l&&(f=E),l=y;break}}catch{}const m=a.filter(y=>y._shouldAllowMigration);return!l._shouldAllowMigration||!m.length?new Vo(l,e,s):(l=m[0],f&&await l._set(d,f.toJSON()),await Promise.all(t.map(async y=>{if(y!==l)try{await y._remove(d)}catch{}})),new Vo(l,e,s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qy(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(d0(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(l0(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(f0(e))return"Blackberry";if(p0(e))return"Webos";if(c0(e))return"Safari";if((e.includes("chrome/")||u0(e))&&!e.includes("edge/"))return"Chrome";if(h0(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=n.match(t);if((s==null?void 0:s.length)===2)return s[1]}return"Other"}function l0(n=or()){return/firefox\//i.test(n)}function c0(n=or()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function u0(n=or()){return/crios\//i.test(n)}function d0(n=or()){return/iemobile/i.test(n)}function h0(n=or()){return/android/i.test(n)}function f0(n=or()){return/blackberry/i.test(n)}function p0(n=or()){return/webos/i.test(n)}function yp(n=or()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function GS(n=or()){var e;return yp(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function qS(){return rT()&&document.documentMode===10}function m0(n=or()){return yp(n)||h0(n)||p0(n)||f0(n)||/windows phone/i.test(n)||d0(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g0(n,e=[]){let t;switch(n){case"Browser":t=Qy(or());break;case"Worker":t=`${Qy(or())}-${n}`;break;default:t=n}const s=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Qo}/${s}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HS{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const s=l=>new Promise((d,f)=>{try{const m=e(l);d(m)}catch(m){f(m)}});s.onAbort=t,this.queue.push(s);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const s of this.queue)await s(e),s.onAbort&&t.push(s.onAbort)}catch(s){t.reverse();for(const a of t)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s==null?void 0:s.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function KS(n,e={}){return Zs(n,"GET","/v2/passwordPolicy",ca(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QS=6;class YS{constructor(e){var t,s,a,l;const d=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=d.minPasswordLength)!==null&&t!==void 0?t:QS,d.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=d.maxPasswordLength),d.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=d.containsLowercaseCharacter),d.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=d.containsUppercaseCharacter),d.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=d.containsNumericCharacter),d.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=d.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(a=(s=e.allowedNonAlphanumericCharacters)===null||s===void 0?void 0:s.join(""))!==null&&a!==void 0?a:"",this.forceUpgradeOnSignin=(l=e.forceUpgradeOnSignin)!==null&&l!==void 0?l:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,s,a,l,d,f;const m={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,m),this.validatePasswordCharacterOptions(e,m),m.isValid&&(m.isValid=(t=m.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),m.isValid&&(m.isValid=(s=m.meetsMaxPasswordLength)!==null&&s!==void 0?s:!0),m.isValid&&(m.isValid=(a=m.containsLowercaseLetter)!==null&&a!==void 0?a:!0),m.isValid&&(m.isValid=(l=m.containsUppercaseLetter)!==null&&l!==void 0?l:!0),m.isValid&&(m.isValid=(d=m.containsNumericCharacter)!==null&&d!==void 0?d:!0),m.isValid&&(m.isValid=(f=m.containsNonAlphanumericCharacter)!==null&&f!==void 0?f:!0),m}validatePasswordLengthOptions(e,t){const s=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;s&&(t.meetsMinPasswordLength=e.length>=s),a&&(t.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let s;for(let a=0;a<e.length;a++)s=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(t,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,t,s,a,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JS{constructor(e,t,s,a){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=s,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Yy(this),this.idTokenSubscription=new Yy(this),this.beforeStateQueue=new HS(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=t0,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=di(t)),this._initializationPromise=this.queue(async()=>{var s,a,l;if(!this._deleted&&(this.persistenceManager=await Vo.create(this,e),(s=this._resolvePersistenceManagerAvailable)===null||s===void 0||s.call(this),!this._deleted)){if(!((a=this._popupRedirectResolver)===null||a===void 0)&&a._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((l=this.currentUser)===null||l===void 0?void 0:l.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Wu(this,{idToken:e}),s=await Ps._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(s)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if($r(this.app)){const d=this.app.settings.authIdToken;return d?new Promise(f=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(d).then(f,f))}):this.directlySetCurrentUser(null)}const s=await this.assertedPersistence.getCurrentUser();let a=s,l=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const d=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,f=a==null?void 0:a._redirectEventId,m=await this.tryRedirectSignIn(e);(!d||d===f)&&(m!=null&&m.user)&&(a=m.user,l=!0)}if(!a)return this.directlySetCurrentUser(null);if(!a._redirectEventId){if(l)try{await this.beforeStateQueue.runMiddleware(a)}catch(d){a=s,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(d))}return a?this.reloadAndSetCurrentUserOrClear(a):this.directlySetCurrentUser(null)}return tt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===a._redirectEventId?this.directlySetCurrentUser(a):this.reloadAndSetCurrentUserOrClear(a)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Hl(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=NS()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if($r(this.app))return Promise.reject(hi(this));const t=e?rn(e):null;return t&&tt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&tt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return $r(this.app)?Promise.reject(hi(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return $r(this.app)?Promise.reject(hi(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(di(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await KS(this),t=new YS(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new ic("auth","Firebase",e())}onAuthStateChanged(e,t,s){return this.registerStateListener(this.authStateSubscription,e,t,s)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,s){return this.registerStateListener(this.idTokenSubscription,e,t,s)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(s.tenantId=this.tenantId),await WS(this,s)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const s=await this.getOrInitRedirectPersistenceManager(t);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&di(e)||this._popupRedirectResolver;tt(t,this,"argument-error"),this.redirectPersistenceManager=await Vo.create(this,[di(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,s;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((s=this.redirectUser)===null||s===void 0?void 0:s._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const s=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==s&&(this.lastNotifiedUid=s,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,s,a){if(this._deleted)return()=>{};const l=typeof t=="function"?t:t.next.bind(t);let d=!1;const f=this._isInitialized?Promise.resolve():this._initializationPromise;if(tt(f,this,"internal-error"),f.then(()=>{d||l(this.currentUser)}),typeof t=="function"){const m=e.addObserver(t,s,a);return()=>{d=!0,m()}}else{const m=e.addObserver(t);return()=>{d=!0,m()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return tt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=g0(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const s=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());s&&(t["X-Firebase-Client"]=s);const a=await this._getAppCheckToken();return a&&(t["X-Firebase-AppCheck"]=a),t}async _getAppCheckToken(){var e;if($r(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&bS(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function ua(n){return rn(n)}class Yy{constructor(e){this.auth=e,this.observer=null,this.addObserver=dT(t=>this.observer=t)}get next(){return tt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cd={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function XS(n){cd=n}function y0(n){return cd.loadJS(n)}function ZS(){return cd.recaptchaEnterpriseScript}function eb(){return cd.gapiScript}function tb(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class nb{constructor(){this.enterprise=new rb}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class rb{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const sb="recaptcha-enterprise",v0="NO_RECAPTCHA";class ib{constructor(e){this.type=sb,this.auth=ua(e)}async verify(e="verify",t=!1){async function s(l){if(!t){if(l.tenantId==null&&l._agentRecaptchaConfig!=null)return l._agentRecaptchaConfig.siteKey;if(l.tenantId!=null&&l._tenantRecaptchaConfigs[l.tenantId]!==void 0)return l._tenantRecaptchaConfigs[l.tenantId].siteKey}return new Promise(async(d,f)=>{VS(l,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(m=>{if(m.recaptchaKey===void 0)f(new Error("recaptcha Enterprise site key undefined"));else{const y=new DS(m);return l.tenantId==null?l._agentRecaptchaConfig=y:l._tenantRecaptchaConfigs[l.tenantId]=y,d(y.siteKey)}}).catch(m=>{f(m)})})}function a(l,d,f){const m=window.grecaptcha;Gy(m)?m.enterprise.ready(()=>{m.enterprise.execute(l,{action:e}).then(y=>{d(y)}).catch(()=>{d(v0)})}):f(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new nb().execute("siteKey",{action:"verify"}):new Promise((l,d)=>{s(this.auth).then(f=>{if(!t&&Gy(window.grecaptcha))a(f,l,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let m=ZS();m.length!==0&&(m+=f),y0(m).then(()=>{a(f,l,d)}).catch(y=>{d(y)})}}).catch(f=>{d(f)})})}}async function Jy(n,e,t,s=!1,a=!1){const l=new ib(n);let d;if(a)d=v0;else try{d=await l.verify(t)}catch{d=await l.verify(t,!0)}const f=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in f){const m=f.phoneEnrollmentInfo.phoneNumber,y=f.phoneEnrollmentInfo.recaptchaToken;Object.assign(f,{phoneEnrollmentInfo:{phoneNumber:m,recaptchaToken:y,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in f){const m=f.phoneSignInInfo.recaptchaToken;Object.assign(f,{phoneSignInInfo:{recaptchaToken:m,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return f}return s?Object.assign(f,{captchaResp:d}):Object.assign(f,{captchaResponse:d}),Object.assign(f,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(f,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),f}async function Df(n,e,t,s,a){var l;if(!((l=n._getRecaptchaConfig())===null||l===void 0)&&l.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const d=await Jy(n,e,t,t==="getOobCode");return s(n,d)}else return s(n,e).catch(async d=>{if(d.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const f=await Jy(n,e,t,t==="getOobCode");return s(n,f)}else return Promise.reject(d)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ab(n,e){const t=dp(n,"auth");if(t.isInitialized()){const a=t.getImmediate(),l=t.getOptions();if($a(l,e??{}))return a;us(a,"already-initialized")}return t.initialize({options:e})}function ob(n,e){const t=(e==null?void 0:e.persistence)||[],s=(Array.isArray(t)?t:[t]).map(di);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(s,e==null?void 0:e.popupRedirectResolver)}function lb(n,e,t){const s=ua(n);tt(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const a=!1,l=_0(e),{host:d,port:f}=cb(e),m=f===null?"":`:${f}`,y={url:`${l}//${d}${m}/`},x=Object.freeze({host:d,port:f,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!s._canInitEmulator){tt(s.config.emulator&&s.emulatorConfig,s,"emulator-config-failed"),tt($a(y,s.config.emulator)&&$a(x,s.emulatorConfig),s,"emulator-config-failed");return}s.config.emulator=y,s.emulatorConfig=x,s.settings.appVerificationDisabledForTesting=!0,Ko(d)?(q_(`${l}//${d}${m}`),H_("Auth",!0)):ub()}function _0(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function cb(n){const e=_0(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const s=t[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(s);if(a){const l=a[1];return{host:l,port:Xy(s.substr(l.length+1))}}else{const[l,d]=s.split(":");return{host:l,port:Xy(d)}}}function Xy(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function ub(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vp{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ui("not implemented")}_getIdTokenResponse(e){return ui("not implemented")}_linkToIdToken(e,t){return ui("not implemented")}_getReauthenticationResolver(e){return ui("not implemented")}}async function db(n,e){return Zs(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hb(n,e){return lc(n,"POST","/v1/accounts:signInWithPassword",ca(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fb(n,e){return lc(n,"POST","/v1/accounts:signInWithEmailLink",ca(n,e))}async function pb(n,e){return lc(n,"POST","/v1/accounts:signInWithEmailLink",ca(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kl extends vp{constructor(e,t,s,a=null){super("password",s),this._email=e,this._password=t,this._tenantId=a}static _fromEmailAndPassword(e,t){return new Kl(e,t,"password")}static _fromEmailAndCode(e,t,s=null){return new Kl(e,t,"emailLink",s)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Df(e,t,"signInWithPassword",hb);case"emailLink":return fb(e,{email:this._email,oobCode:this._password});default:us(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const s={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Df(e,s,"signUpPassword",db);case"emailLink":return pb(e,{idToken:t,email:this._email,oobCode:this._password});default:us(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Lo(n,e){return lc(n,"POST","/v1/accounts:signInWithIdp",ca(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mb="http://localhost";class gi extends vp{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new gi(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):us("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:a}=t,l=hp(t,["providerId","signInMethod"]);if(!s||!a)return null;const d=new gi(s,a);return d.idToken=l.idToken||void 0,d.accessToken=l.accessToken||void 0,d.secret=l.secret,d.nonce=l.nonce,d.pendingToken=l.pendingToken||null,d}_getIdTokenResponse(e){const t=this.buildRequest();return Lo(e,t)}_linkToIdToken(e,t){const s=this.buildRequest();return s.idToken=t,Lo(e,s)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Lo(e,t)}buildRequest(){const e={requestUri:mb,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=ac(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gb(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function yb(n){const e=Al(jl(n)).link,t=e?Al(jl(e)).deep_link_id:null,s=Al(jl(n)).deep_link_id;return(s?Al(jl(s)).link:null)||s||t||e||n}class _p{constructor(e){var t,s,a,l,d,f;const m=Al(jl(e)),y=(t=m.apiKey)!==null&&t!==void 0?t:null,x=(s=m.oobCode)!==null&&s!==void 0?s:null,E=gb((a=m.mode)!==null&&a!==void 0?a:null);tt(y&&x&&E,"argument-error"),this.apiKey=y,this.operation=E,this.code=x,this.continueUrl=(l=m.continueUrl)!==null&&l!==void 0?l:null,this.languageCode=(d=m.lang)!==null&&d!==void 0?d:null,this.tenantId=(f=m.tenantId)!==null&&f!==void 0?f:null}static parseLink(e){const t=yb(e);try{return new _p(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yo{constructor(){this.providerId=Yo.PROVIDER_ID}static credential(e,t){return Kl._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const s=_p.parseLink(t);return tt(s,"argument-error"),Kl._fromEmailAndCode(e,s.code,s.tenantId)}}Yo.PROVIDER_ID="password";Yo.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Yo.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ud{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jo extends ud{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Fl extends Jo{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return tt("providerId"in t&&"signInMethod"in t,"argument-error"),gi._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return tt(e.idToken||e.accessToken,"argument-error"),gi._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return Fl.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return Fl.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:s,oauthTokenSecret:a,pendingToken:l,nonce:d,providerId:f}=e;if(!s&&!a&&!t&&!l||!f)return null;try{return new Fl(f)._credential({idToken:t,accessToken:s,nonce:d,pendingToken:l})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $i extends Jo{constructor(){super("facebook.com")}static credential(e){return gi._fromParams({providerId:$i.PROVIDER_ID,signInMethod:$i.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return $i.credentialFromTaggedObject(e)}static credentialFromError(e){return $i.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return $i.credential(e.oauthAccessToken)}catch{return null}}}$i.FACEBOOK_SIGN_IN_METHOD="facebook.com";$i.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cs extends Jo{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return gi._fromParams({providerId:Cs.PROVIDER_ID,signInMethod:Cs.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Cs.credentialFromTaggedObject(e)}static credentialFromError(e){return Cs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:s}=e;if(!t&&!s)return null;try{return Cs.credential(t,s)}catch{return null}}}Cs.GOOGLE_SIGN_IN_METHOD="google.com";Cs.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bi extends Jo{constructor(){super("github.com")}static credential(e){return gi._fromParams({providerId:Bi.PROVIDER_ID,signInMethod:Bi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Bi.credentialFromTaggedObject(e)}static credentialFromError(e){return Bi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Bi.credential(e.oauthAccessToken)}catch{return null}}}Bi.GITHUB_SIGN_IN_METHOD="github.com";Bi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wi extends Jo{constructor(){super("twitter.com")}static credential(e,t){return gi._fromParams({providerId:Wi.PROVIDER_ID,signInMethod:Wi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Wi.credentialFromTaggedObject(e)}static credentialFromError(e){return Wi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:s}=e;if(!t||!s)return null;try{return Wi.credential(t,s)}catch{return null}}}Wi.TWITTER_SIGN_IN_METHOD="twitter.com";Wi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vb(n,e){return lc(n,"POST","/v1/accounts:signUp",ca(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wa{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,s,a=!1){const l=await Ps._fromIdTokenResponse(e,s,a),d=Zy(s);return new Wa({user:l,providerId:d,_tokenResponse:s,operationType:t})}static async _forOperation(e,t,s){await e._updateTokensIfNecessary(s,!0);const a=Zy(s);return new Wa({user:e,providerId:a,_tokenResponse:s,operationType:t})}}function Zy(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gu extends wi{constructor(e,t,s,a){var l;super(t.code,t.message),this.operationType=s,this.user=a,Object.setPrototypeOf(this,Gu.prototype),this.customData={appName:e.name,tenantId:(l=e.tenantId)!==null&&l!==void 0?l:void 0,_serverResponse:t.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,t,s,a){return new Gu(e,t,s,a)}}function x0(n,e,t,s){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?Gu._fromErrorAndOperation(n,l,e,s):l})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w0(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _b(n,e){const t=rn(n);await wb(!0,t,e);const{providerUserInfo:s}=await MS(t.auth,{idToken:await t.getIdToken(),deleteProvider:[e]}),a=w0(s||[]);return t.providerData=t.providerData.filter(l=>a.has(l.providerId)),a.has("phone")||(t.phoneNumber=null),await t.auth._persistUserIfCurrent(t),t}async function xb(n,e,t=!1){const s=await Fo(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Wa._forOperation(n,"link",s)}async function wb(n,e,t){await Hl(e);const s=w0(e.providerData);tt(s.has(t)===n,e.auth,"no-such-provider")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Eb(n,e,t=!1){const{auth:s}=n;if($r(s.app))return Promise.reject(hi(s));const a="reauthenticate";try{const l=await Fo(n,x0(s,a,e,n),t);tt(l.idToken,s,"internal-error");const d=gp(l.idToken);tt(d,s,"internal-error");const{sub:f}=d;return tt(n.uid===f,s,"user-mismatch"),Wa._forOperation(n,a,l)}catch(l){throw(l==null?void 0:l.code)==="auth/user-not-found"&&us(s,"user-mismatch"),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function E0(n,e,t=!1){if($r(n.app))return Promise.reject(hi(n));const s="signIn",a=await x0(n,s,e),l=await Wa._fromIdTokenResponse(n,s,a);return t||await n._updateCurrentUser(l.user),l}async function Tb(n,e){return E0(ua(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function T0(n){const e=ua(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function Sb(n,e,t){if($r(n.app))return Promise.reject(hi(n));const s=ua(n),d=await Df(s,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",vb).catch(m=>{throw m.code==="auth/password-does-not-meet-requirements"&&T0(n),m}),f=await Wa._fromIdTokenResponse(s,"signIn",d);return await s._updateCurrentUser(f.user),f}function S0(n,e,t){return $r(n.app)?Promise.reject(hi(n)):Tb(rn(n),Yo.credential(e,t)).catch(async s=>{throw s.code==="auth/password-does-not-meet-requirements"&&T0(n),s})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bb(n,e){return Zs(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Cb(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const s=rn(n),l={idToken:await s.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},d=await Fo(s,bb(s.auth,l));s.displayName=d.displayName||null,s.photoURL=d.photoUrl||null;const f=s.providerData.find(({providerId:m})=>m==="password");f&&(f.displayName=s.displayName,f.photoURL=s.photoURL),await s._updateTokensIfNecessary(d)}function Ib(n,e,t,s){return rn(n).onIdTokenChanged(e,t,s)}function Nb(n,e,t){return rn(n).beforeAuthStateChanged(e,t)}function Pb(n,e,t,s){return rn(n).onAuthStateChanged(e,t,s)}function b0(n){return rn(n).signOut()}const qu="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C0{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(qu,"1"),this.storage.removeItem(qu),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rb=1e3,Ab=10;class I0 extends C0{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=m0(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const s=this.storage.getItem(t),a=this.localCache[t];s!==a&&e(t,a,s)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((d,f,m)=>{this.notifyListeners(d,m)});return}const s=e.key;t?this.detachListener():this.stopPolling();const a=()=>{const d=this.storage.getItem(s);!t&&this.localCache[s]===d||this.notifyListeners(s,d)},l=this.storage.getItem(s);qS()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,Ab):a()}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const a of Array.from(s))a(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:s}),!0)})},Rb)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}I0.type="LOCAL";const jb=I0;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N0 extends C0{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}N0.type="SESSION";const P0=N0;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kb(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dd{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(a=>a.isListeningto(e));if(t)return t;const s=new dd(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:s,eventType:a,data:l}=t.data,d=this.handlersMap[a];if(!(d!=null&&d.size))return;t.ports[0].postMessage({status:"ack",eventId:s,eventType:a});const f=Array.from(d).map(async y=>y(t.origin,l)),m=await kb(f);t.ports[0].postMessage({status:"done",eventId:s,eventType:a,response:m})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}dd.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xp(n="",e=10){let t="";for(let s=0;s<e;s++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Db{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,s=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let l,d;return new Promise((f,m)=>{const y=xp("",20);a.port1.start();const x=setTimeout(()=>{m(new Error("unsupported_event"))},s);d={messageChannel:a,onMessage(E){const C=E;if(C.data.eventId===y)switch(C.data.status){case"ack":clearTimeout(x),l=setTimeout(()=>{m(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),f(C.data.response);break;default:clearTimeout(x),clearTimeout(l),m(new Error("invalid_response"));break}}},this.handlers.add(d),a.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:y,data:t},[a.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hs(){return window}function Vb(n){Hs().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R0(){return typeof Hs().WorkerGlobalScope<"u"&&typeof Hs().importScripts=="function"}async function Lb(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Mb(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function Ob(){return R0()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A0="firebaseLocalStorageDb",Fb=1,Hu="firebaseLocalStorage",j0="fbase_key";class cc{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function hd(n,e){return n.transaction([Hu],e?"readwrite":"readonly").objectStore(Hu)}function Ub(){const n=indexedDB.deleteDatabase(A0);return new cc(n).toPromise()}function Vf(){const n=indexedDB.open(A0,Fb);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const s=n.result;try{s.createObjectStore(Hu,{keyPath:j0})}catch(a){t(a)}}),n.addEventListener("success",async()=>{const s=n.result;s.objectStoreNames.contains(Hu)?e(s):(s.close(),await Ub(),e(await Vf()))})})}async function ev(n,e,t){const s=hd(n,!0).put({[j0]:e,value:t});return new cc(s).toPromise()}async function zb(n,e){const t=hd(n,!1).get(e),s=await new cc(t).toPromise();return s===void 0?null:s.value}function tv(n,e){const t=hd(n,!0).delete(e);return new cc(t).toPromise()}const $b=800,Bb=3;class k0{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Vf(),this.db)}async _withRetries(e){let t=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(t++>Bb)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return R0()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=dd._getInstance(Ob()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await Lb(),!this.activeServiceWorker)return;this.sender=new Db(this.activeServiceWorker);const s=await this.sender._send("ping",{},800);s&&!((e=s[0])===null||e===void 0)&&e.fulfilled&&!((t=s[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Mb()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Vf();return await ev(e,qu,"1"),await tv(e,qu),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(s=>ev(s,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(s=>zb(s,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>tv(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const l=hd(a,!1).getAll();return new cc(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],s=new Set;if(e.length!==0)for(const{fbase_key:a,value:l}of e)s.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(l)&&(this.notifyListeners(a,l),t.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!s.has(a)&&(this.notifyListeners(a,null),t.push(a));return t}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const a of Array.from(s))a(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),$b)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}k0.type="LOCAL";const Wb=k0;new oc(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wp(n,e){return e?di(e):(tt(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ep extends vp{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Lo(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Lo(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Lo(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Gb(n){return E0(n.auth,new Ep(n),n.bypassAuthState)}function qb(n){const{auth:e,user:t}=n;return tt(t,e,"internal-error"),Eb(t,new Ep(n),n.bypassAuthState)}async function Hb(n){const{auth:e,user:t}=n;return tt(t,e,"internal-error"),xb(t,new Ep(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D0{constructor(e,t,s,a,l=!1){this.auth=e,this.resolver=s,this.user=a,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:s,postBody:a,tenantId:l,error:d,type:f}=e;if(d){this.reject(d);return}const m={auth:this.auth,requestUri:t,sessionId:s,tenantId:l||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(f)(m))}catch(y){this.reject(y)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Gb;case"linkViaPopup":case"linkViaRedirect":return Hb;case"reauthViaPopup":case"reauthViaRedirect":return qb;default:us(this.auth,"internal-error")}}resolve(e){mi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){mi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kb=new oc(2e3,1e4);async function V0(n,e,t){if($r(n.app))return Promise.reject(Rs(n,"operation-not-supported-in-this-environment"));const s=ua(n);n0(n,e,ud);const a=wp(s,t);return new qi(s,"signInViaPopup",e,a).executeNotNull()}async function nv(n,e,t){const s=rn(n);n0(s.auth,e,ud);const a=wp(s.auth,t);return new qi(s.auth,"linkViaPopup",e,a,s).executeNotNull()}class qi extends D0{constructor(e,t,s,a,l){super(e,t,a,l),this.provider=s,this.authWindow=null,this.pollId=null,qi.currentPopupAction&&qi.currentPopupAction.cancel(),qi.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return tt(e,this.auth,"internal-error"),e}async onExecution(){mi(this.filter.length===1,"Popup operations only handle one event");const e=xp();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Rs(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Rs(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,qi.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,s;if(!((s=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||s===void 0)&&s.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Rs(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Kb.get())};e()}}qi.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qb="pendingRedirect",Pu=new Map;class Yb extends D0{constructor(e,t,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,s),this.eventId=null}async execute(){let e=Pu.get(this.auth._key());if(!e){try{const s=await Jb(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(t){e=()=>Promise.reject(t)}Pu.set(this.auth._key(),e)}return this.bypassAuthState||Pu.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Jb(n,e){const t=eC(e),s=Zb(n);if(!await s._isAvailable())return!1;const a=await s._get(t)==="true";return await s._remove(t),a}function Xb(n,e){Pu.set(n._key(),e)}function Zb(n){return di(n._redirectPersistence)}function eC(n){return Nu(Qb,n.config.apiKey,n.name)}async function tC(n,e,t=!1){if($r(n.app))return Promise.reject(hi(n));const s=ua(n),a=wp(s,e),d=await new Yb(s,a,t).execute();return d&&!t&&(delete d.user._redirectEventId,await s._persistUserIfCurrent(d.user),await s._setRedirectUser(null,e)),d}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nC=600*1e3;class rC{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(t=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!sC(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var s;if(e.error&&!L0(e)){const a=((s=e.error.code)===null||s===void 0?void 0:s.split("auth/")[1])||"internal-error";t.onError(Rs(this.auth,a))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const s=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=nC&&this.cachedEventUids.clear(),this.cachedEventUids.has(rv(e))}saveEventToCache(e){this.cachedEventUids.add(rv(e)),this.lastProcessedEventTime=Date.now()}}function rv(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function L0({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function sC(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return L0(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iC(n,e={}){return Zs(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aC=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,oC=/^https?/;async function lC(n){if(n.config.emulator)return;const{authorizedDomains:e}=await iC(n);for(const t of e)try{if(cC(t))return}catch{}us(n,"unauthorized-domain")}function cC(n){const e=jf(),{protocol:t,hostname:s}=new URL(e);if(n.startsWith("chrome-extension://")){const d=new URL(n);return d.hostname===""&&s===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&d.hostname===s}if(!oC.test(t))return!1;if(aC.test(n))return s===n;const a=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(s)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uC=new oc(3e4,6e4);function sv(){const n=Hs().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function dC(n){return new Promise((e,t)=>{var s,a,l;function d(){sv(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{sv(),t(Rs(n,"network-request-failed"))},timeout:uC.get()})}if(!((a=(s=Hs().gapi)===null||s===void 0?void 0:s.iframes)===null||a===void 0)&&a.Iframe)e(gapi.iframes.getContext());else if(!((l=Hs().gapi)===null||l===void 0)&&l.load)d();else{const f=tb("iframefcb");return Hs()[f]=()=>{gapi.load?d():t(Rs(n,"network-request-failed"))},y0(`${eb()}?onload=${f}`).catch(m=>t(m))}}).catch(e=>{throw Ru=null,e})}let Ru=null;function hC(n){return Ru=Ru||dC(n),Ru}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fC=new oc(5e3,15e3),pC="__/auth/iframe",mC="emulator/auth/iframe",gC={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},yC=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function vC(n){const e=n.config;tt(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?mp(e,mC):`https://${n.config.authDomain}/${pC}`,s={apiKey:e.apiKey,appName:n.name,v:Qo},a=yC.get(n.config.apiHost);a&&(s.eid=a);const l=n._getFrameworks();return l.length&&(s.fw=l.join(",")),`${t}?${ac(s).slice(1)}`}async function _C(n){const e=await hC(n),t=Hs().gapi;return tt(t,n,"internal-error"),e.open({where:document.body,url:vC(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:gC,dontclear:!0},s=>new Promise(async(a,l)=>{await s.restyle({setHideOnLeave:!1});const d=Rs(n,"network-request-failed"),f=Hs().setTimeout(()=>{l(d)},fC.get());function m(){Hs().clearTimeout(f),a(s)}s.ping(m).then(m,()=>{l(d)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xC={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},wC=500,EC=600,TC="_blank",SC="http://localhost";class iv{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function bC(n,e,t,s=wC,a=EC){const l=Math.max((window.screen.availHeight-a)/2,0).toString(),d=Math.max((window.screen.availWidth-s)/2,0).toString();let f="";const m=Object.assign(Object.assign({},xC),{width:s.toString(),height:a.toString(),top:l,left:d}),y=or().toLowerCase();t&&(f=u0(y)?TC:t),l0(y)&&(e=e||SC,m.scrollbars="yes");const x=Object.entries(m).reduce((C,[U,X])=>`${C}${U}=${X},`,"");if(GS(y)&&f!=="_self")return CC(e||"",f),new iv(null);const E=window.open(e||"",f,x);tt(E,n,"popup-blocked");try{E.focus()}catch{}return new iv(E)}function CC(n,e){const t=document.createElement("a");t.href=n,t.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IC="__/auth/handler",NC="emulator/auth/handler",PC=encodeURIComponent("fac");async function av(n,e,t,s,a,l){tt(n.config.authDomain,n,"auth-domain-config-required"),tt(n.config.apiKey,n,"invalid-api-key");const d={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:s,v:Qo,eventId:a};if(e instanceof ud){e.setDefaultLanguage(n.languageCode),d.providerId=e.providerId||"",uT(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[x,E]of Object.entries({}))d[x]=E}if(e instanceof Jo){const x=e.getScopes().filter(E=>E!=="");x.length>0&&(d.scopes=x.join(","))}n.tenantId&&(d.tid=n.tenantId);const f=d;for(const x of Object.keys(f))f[x]===void 0&&delete f[x];const m=await n._getAppCheckToken(),y=m?`#${PC}=${encodeURIComponent(m)}`:"";return`${RC(n)}?${ac(f).slice(1)}${y}`}function RC({config:n}){return n.emulator?mp(n,NC):`https://${n.authDomain}/${IC}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ff="webStorageSupport";class AC{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=P0,this._completeRedirectFn=tC,this._overrideRedirectResult=Xb}async _openPopup(e,t,s,a){var l;mi((l=this.eventManagers[e._key()])===null||l===void 0?void 0:l.manager,"_initialize() not called before _openPopup()");const d=await av(e,t,s,jf(),a);return bC(e,d,xp())}async _openRedirect(e,t,s,a){await this._originValidation(e);const l=await av(e,t,s,jf(),a);return Vb(l),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:a,promise:l}=this.eventManagers[t];return a?Promise.resolve(a):(mi(l,"If manager is not set, promise should be"),l)}const s=this.initAndGetManager(e);return this.eventManagers[t]={promise:s},s.catch(()=>{delete this.eventManagers[t]}),s}async initAndGetManager(e){const t=await _C(e),s=new rC(e);return t.register("authEvent",a=>(tt(a==null?void 0:a.authEvent,e,"invalid-auth-event"),{status:s.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=t,s}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(ff,{type:ff},a=>{var l;const d=(l=a==null?void 0:a[0])===null||l===void 0?void 0:l[ff];d!==void 0&&t(!!d),us(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=lC(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return m0()||c0()||yp()}}const jC=AC;var ov="@firebase/auth",lv="1.10.8";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kC{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(s=>{e((s==null?void 0:s.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){tt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DC(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function VC(n){Oo(new Ba("auth",(e,{options:t})=>{const s=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:d,authDomain:f}=s.options;tt(d&&!d.includes(":"),"invalid-api-key",{appName:s.name});const m={apiKey:d,authDomain:f,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:g0(n)},y=new JS(s,a,l,m);return ob(y,t),y},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,s)=>{e.getProvider("auth-internal").initialize()})),Oo(new Ba("auth-internal",e=>{const t=ua(e.getProvider("auth").getImmediate());return(s=>new kC(s))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ji(ov,lv,DC(n)),Ji(ov,lv,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LC=300,MC=G_("authIdTokenMaxAge")||LC;let cv=null;const OC=n=>async e=>{const t=e&&await e.getIdTokenResult(),s=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(s&&s>MC)return;const a=t==null?void 0:t.token;cv!==a&&(cv=a,await fetch(n,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function FC(n=J_()){const e=dp(n,"auth");if(e.isInitialized())return e.getImmediate();const t=ab(n,{popupRedirectResolver:jC,persistence:[Wb,jb,P0]}),s=G_("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const l=new URL(s,location.origin);if(location.origin===l.origin){const d=OC(l.toString());Nb(t,d,()=>d(t.currentUser)),Ib(t,f=>d(f))}}const a=B_("auth");return a&&lb(t,`http://${a}`),t}function UC(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}XS({loadJS(n){return new Promise((e,t)=>{const s=document.createElement("script");s.setAttribute("src",n),s.onload=e,s.onerror=a=>{const l=Rs("internal-error");l.customData=a,t(l)},s.type="text/javascript",s.charset="UTF-8",UC().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});VC("Browser");var uv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Xi,M0;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(I,N){function A(){}A.prototype=N.prototype,I.D=N.prototype,I.prototype=new A,I.prototype.constructor=I,I.C=function(O,D,P){for(var b=Array(arguments.length-2),J=2;J<arguments.length;J++)b[J-2]=arguments[J];return N.prototype[D].apply(O,b)}}function t(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(s,t),s.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(I,N,A){A||(A=0);var O=Array(16);if(typeof N=="string")for(var D=0;16>D;++D)O[D]=N.charCodeAt(A++)|N.charCodeAt(A++)<<8|N.charCodeAt(A++)<<16|N.charCodeAt(A++)<<24;else for(D=0;16>D;++D)O[D]=N[A++]|N[A++]<<8|N[A++]<<16|N[A++]<<24;N=I.g[0],A=I.g[1],D=I.g[2];var P=I.g[3],b=N+(P^A&(D^P))+O[0]+3614090360&4294967295;N=A+(b<<7&4294967295|b>>>25),b=P+(D^N&(A^D))+O[1]+3905402710&4294967295,P=N+(b<<12&4294967295|b>>>20),b=D+(A^P&(N^A))+O[2]+606105819&4294967295,D=P+(b<<17&4294967295|b>>>15),b=A+(N^D&(P^N))+O[3]+3250441966&4294967295,A=D+(b<<22&4294967295|b>>>10),b=N+(P^A&(D^P))+O[4]+4118548399&4294967295,N=A+(b<<7&4294967295|b>>>25),b=P+(D^N&(A^D))+O[5]+1200080426&4294967295,P=N+(b<<12&4294967295|b>>>20),b=D+(A^P&(N^A))+O[6]+2821735955&4294967295,D=P+(b<<17&4294967295|b>>>15),b=A+(N^D&(P^N))+O[7]+4249261313&4294967295,A=D+(b<<22&4294967295|b>>>10),b=N+(P^A&(D^P))+O[8]+1770035416&4294967295,N=A+(b<<7&4294967295|b>>>25),b=P+(D^N&(A^D))+O[9]+2336552879&4294967295,P=N+(b<<12&4294967295|b>>>20),b=D+(A^P&(N^A))+O[10]+4294925233&4294967295,D=P+(b<<17&4294967295|b>>>15),b=A+(N^D&(P^N))+O[11]+2304563134&4294967295,A=D+(b<<22&4294967295|b>>>10),b=N+(P^A&(D^P))+O[12]+1804603682&4294967295,N=A+(b<<7&4294967295|b>>>25),b=P+(D^N&(A^D))+O[13]+4254626195&4294967295,P=N+(b<<12&4294967295|b>>>20),b=D+(A^P&(N^A))+O[14]+2792965006&4294967295,D=P+(b<<17&4294967295|b>>>15),b=A+(N^D&(P^N))+O[15]+1236535329&4294967295,A=D+(b<<22&4294967295|b>>>10),b=N+(D^P&(A^D))+O[1]+4129170786&4294967295,N=A+(b<<5&4294967295|b>>>27),b=P+(A^D&(N^A))+O[6]+3225465664&4294967295,P=N+(b<<9&4294967295|b>>>23),b=D+(N^A&(P^N))+O[11]+643717713&4294967295,D=P+(b<<14&4294967295|b>>>18),b=A+(P^N&(D^P))+O[0]+3921069994&4294967295,A=D+(b<<20&4294967295|b>>>12),b=N+(D^P&(A^D))+O[5]+3593408605&4294967295,N=A+(b<<5&4294967295|b>>>27),b=P+(A^D&(N^A))+O[10]+38016083&4294967295,P=N+(b<<9&4294967295|b>>>23),b=D+(N^A&(P^N))+O[15]+3634488961&4294967295,D=P+(b<<14&4294967295|b>>>18),b=A+(P^N&(D^P))+O[4]+3889429448&4294967295,A=D+(b<<20&4294967295|b>>>12),b=N+(D^P&(A^D))+O[9]+568446438&4294967295,N=A+(b<<5&4294967295|b>>>27),b=P+(A^D&(N^A))+O[14]+3275163606&4294967295,P=N+(b<<9&4294967295|b>>>23),b=D+(N^A&(P^N))+O[3]+4107603335&4294967295,D=P+(b<<14&4294967295|b>>>18),b=A+(P^N&(D^P))+O[8]+1163531501&4294967295,A=D+(b<<20&4294967295|b>>>12),b=N+(D^P&(A^D))+O[13]+2850285829&4294967295,N=A+(b<<5&4294967295|b>>>27),b=P+(A^D&(N^A))+O[2]+4243563512&4294967295,P=N+(b<<9&4294967295|b>>>23),b=D+(N^A&(P^N))+O[7]+1735328473&4294967295,D=P+(b<<14&4294967295|b>>>18),b=A+(P^N&(D^P))+O[12]+2368359562&4294967295,A=D+(b<<20&4294967295|b>>>12),b=N+(A^D^P)+O[5]+4294588738&4294967295,N=A+(b<<4&4294967295|b>>>28),b=P+(N^A^D)+O[8]+2272392833&4294967295,P=N+(b<<11&4294967295|b>>>21),b=D+(P^N^A)+O[11]+1839030562&4294967295,D=P+(b<<16&4294967295|b>>>16),b=A+(D^P^N)+O[14]+4259657740&4294967295,A=D+(b<<23&4294967295|b>>>9),b=N+(A^D^P)+O[1]+2763975236&4294967295,N=A+(b<<4&4294967295|b>>>28),b=P+(N^A^D)+O[4]+1272893353&4294967295,P=N+(b<<11&4294967295|b>>>21),b=D+(P^N^A)+O[7]+4139469664&4294967295,D=P+(b<<16&4294967295|b>>>16),b=A+(D^P^N)+O[10]+3200236656&4294967295,A=D+(b<<23&4294967295|b>>>9),b=N+(A^D^P)+O[13]+681279174&4294967295,N=A+(b<<4&4294967295|b>>>28),b=P+(N^A^D)+O[0]+3936430074&4294967295,P=N+(b<<11&4294967295|b>>>21),b=D+(P^N^A)+O[3]+3572445317&4294967295,D=P+(b<<16&4294967295|b>>>16),b=A+(D^P^N)+O[6]+76029189&4294967295,A=D+(b<<23&4294967295|b>>>9),b=N+(A^D^P)+O[9]+3654602809&4294967295,N=A+(b<<4&4294967295|b>>>28),b=P+(N^A^D)+O[12]+3873151461&4294967295,P=N+(b<<11&4294967295|b>>>21),b=D+(P^N^A)+O[15]+530742520&4294967295,D=P+(b<<16&4294967295|b>>>16),b=A+(D^P^N)+O[2]+3299628645&4294967295,A=D+(b<<23&4294967295|b>>>9),b=N+(D^(A|~P))+O[0]+4096336452&4294967295,N=A+(b<<6&4294967295|b>>>26),b=P+(A^(N|~D))+O[7]+1126891415&4294967295,P=N+(b<<10&4294967295|b>>>22),b=D+(N^(P|~A))+O[14]+2878612391&4294967295,D=P+(b<<15&4294967295|b>>>17),b=A+(P^(D|~N))+O[5]+4237533241&4294967295,A=D+(b<<21&4294967295|b>>>11),b=N+(D^(A|~P))+O[12]+1700485571&4294967295,N=A+(b<<6&4294967295|b>>>26),b=P+(A^(N|~D))+O[3]+2399980690&4294967295,P=N+(b<<10&4294967295|b>>>22),b=D+(N^(P|~A))+O[10]+4293915773&4294967295,D=P+(b<<15&4294967295|b>>>17),b=A+(P^(D|~N))+O[1]+2240044497&4294967295,A=D+(b<<21&4294967295|b>>>11),b=N+(D^(A|~P))+O[8]+1873313359&4294967295,N=A+(b<<6&4294967295|b>>>26),b=P+(A^(N|~D))+O[15]+4264355552&4294967295,P=N+(b<<10&4294967295|b>>>22),b=D+(N^(P|~A))+O[6]+2734768916&4294967295,D=P+(b<<15&4294967295|b>>>17),b=A+(P^(D|~N))+O[13]+1309151649&4294967295,A=D+(b<<21&4294967295|b>>>11),b=N+(D^(A|~P))+O[4]+4149444226&4294967295,N=A+(b<<6&4294967295|b>>>26),b=P+(A^(N|~D))+O[11]+3174756917&4294967295,P=N+(b<<10&4294967295|b>>>22),b=D+(N^(P|~A))+O[2]+718787259&4294967295,D=P+(b<<15&4294967295|b>>>17),b=A+(P^(D|~N))+O[9]+3951481745&4294967295,I.g[0]=I.g[0]+N&4294967295,I.g[1]=I.g[1]+(D+(b<<21&4294967295|b>>>11))&4294967295,I.g[2]=I.g[2]+D&4294967295,I.g[3]=I.g[3]+P&4294967295}s.prototype.u=function(I,N){N===void 0&&(N=I.length);for(var A=N-this.blockSize,O=this.B,D=this.h,P=0;P<N;){if(D==0)for(;P<=A;)a(this,I,P),P+=this.blockSize;if(typeof I=="string"){for(;P<N;)if(O[D++]=I.charCodeAt(P++),D==this.blockSize){a(this,O),D=0;break}}else for(;P<N;)if(O[D++]=I[P++],D==this.blockSize){a(this,O),D=0;break}}this.h=D,this.o+=N},s.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var N=1;N<I.length-8;++N)I[N]=0;var A=8*this.o;for(N=I.length-8;N<I.length;++N)I[N]=A&255,A/=256;for(this.u(I),I=Array(16),N=A=0;4>N;++N)for(var O=0;32>O;O+=8)I[A++]=this.g[N]>>>O&255;return I};function l(I,N){var A=f;return Object.prototype.hasOwnProperty.call(A,I)?A[I]:A[I]=N(I)}function d(I,N){this.h=N;for(var A=[],O=!0,D=I.length-1;0<=D;D--){var P=I[D]|0;O&&P==N||(A[D]=P,O=!1)}this.g=A}var f={};function m(I){return-128<=I&&128>I?l(I,function(N){return new d([N|0],0>N?-1:0)}):new d([I|0],0>I?-1:0)}function y(I){if(isNaN(I)||!isFinite(I))return E;if(0>I)return z(y(-I));for(var N=[],A=1,O=0;I>=A;O++)N[O]=I/A|0,A*=4294967296;return new d(N,0)}function x(I,N){if(I.length==0)throw Error("number format error: empty string");if(N=N||10,2>N||36<N)throw Error("radix out of range: "+N);if(I.charAt(0)=="-")return z(x(I.substring(1),N));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var A=y(Math.pow(N,8)),O=E,D=0;D<I.length;D+=8){var P=Math.min(8,I.length-D),b=parseInt(I.substring(D,D+P),N);8>P?(P=y(Math.pow(N,P)),O=O.j(P).add(y(b))):(O=O.j(A),O=O.add(y(b)))}return O}var E=m(0),C=m(1),U=m(16777216);n=d.prototype,n.m=function(){if(W(this))return-z(this).m();for(var I=0,N=1,A=0;A<this.g.length;A++){var O=this.i(A);I+=(0<=O?O:4294967296+O)*N,N*=4294967296}return I},n.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(X(this))return"0";if(W(this))return"-"+z(this).toString(I);for(var N=y(Math.pow(I,6)),A=this,O="";;){var D=ve(A,N).g;A=se(A,D.j(N));var P=((0<A.g.length?A.g[0]:A.h)>>>0).toString(I);if(A=D,X(A))return P+O;for(;6>P.length;)P="0"+P;O=P+O}},n.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function X(I){if(I.h!=0)return!1;for(var N=0;N<I.g.length;N++)if(I.g[N]!=0)return!1;return!0}function W(I){return I.h==-1}n.l=function(I){return I=se(this,I),W(I)?-1:X(I)?0:1};function z(I){for(var N=I.g.length,A=[],O=0;O<N;O++)A[O]=~I.g[O];return new d(A,~I.h).add(C)}n.abs=function(){return W(this)?z(this):this},n.add=function(I){for(var N=Math.max(this.g.length,I.g.length),A=[],O=0,D=0;D<=N;D++){var P=O+(this.i(D)&65535)+(I.i(D)&65535),b=(P>>>16)+(this.i(D)>>>16)+(I.i(D)>>>16);O=b>>>16,P&=65535,b&=65535,A[D]=b<<16|P}return new d(A,A[A.length-1]&-2147483648?-1:0)};function se(I,N){return I.add(z(N))}n.j=function(I){if(X(this)||X(I))return E;if(W(this))return W(I)?z(this).j(z(I)):z(z(this).j(I));if(W(I))return z(this.j(z(I)));if(0>this.l(U)&&0>I.l(U))return y(this.m()*I.m());for(var N=this.g.length+I.g.length,A=[],O=0;O<2*N;O++)A[O]=0;for(O=0;O<this.g.length;O++)for(var D=0;D<I.g.length;D++){var P=this.i(O)>>>16,b=this.i(O)&65535,J=I.i(D)>>>16,re=I.i(D)&65535;A[2*O+2*D]+=b*re,we(A,2*O+2*D),A[2*O+2*D+1]+=P*re,we(A,2*O+2*D+1),A[2*O+2*D+1]+=b*J,we(A,2*O+2*D+1),A[2*O+2*D+2]+=P*J,we(A,2*O+2*D+2)}for(O=0;O<N;O++)A[O]=A[2*O+1]<<16|A[2*O];for(O=N;O<2*N;O++)A[O]=0;return new d(A,0)};function we(I,N){for(;(I[N]&65535)!=I[N];)I[N+1]+=I[N]>>>16,I[N]&=65535,N++}function _e(I,N){this.g=I,this.h=N}function ve(I,N){if(X(N))throw Error("division by zero");if(X(I))return new _e(E,E);if(W(I))return N=ve(z(I),N),new _e(z(N.g),z(N.h));if(W(N))return N=ve(I,z(N)),new _e(z(N.g),N.h);if(30<I.g.length){if(W(I)||W(N))throw Error("slowDivide_ only works with positive integers.");for(var A=C,O=N;0>=O.l(I);)A=L(A),O=L(O);var D=ie(A,1),P=ie(O,1);for(O=ie(O,2),A=ie(A,2);!X(O);){var b=P.add(O);0>=b.l(I)&&(D=D.add(A),P=b),O=ie(O,1),A=ie(A,1)}return N=se(I,D.j(N)),new _e(D,N)}for(D=E;0<=I.l(N);){for(A=Math.max(1,Math.floor(I.m()/N.m())),O=Math.ceil(Math.log(A)/Math.LN2),O=48>=O?1:Math.pow(2,O-48),P=y(A),b=P.j(N);W(b)||0<b.l(I);)A-=O,P=y(A),b=P.j(N);X(P)&&(P=C),D=D.add(P),I=se(I,b)}return new _e(D,I)}n.A=function(I){return ve(this,I).h},n.and=function(I){for(var N=Math.max(this.g.length,I.g.length),A=[],O=0;O<N;O++)A[O]=this.i(O)&I.i(O);return new d(A,this.h&I.h)},n.or=function(I){for(var N=Math.max(this.g.length,I.g.length),A=[],O=0;O<N;O++)A[O]=this.i(O)|I.i(O);return new d(A,this.h|I.h)},n.xor=function(I){for(var N=Math.max(this.g.length,I.g.length),A=[],O=0;O<N;O++)A[O]=this.i(O)^I.i(O);return new d(A,this.h^I.h)};function L(I){for(var N=I.g.length+1,A=[],O=0;O<N;O++)A[O]=I.i(O)<<1|I.i(O-1)>>>31;return new d(A,I.h)}function ie(I,N){var A=N>>5;N%=32;for(var O=I.g.length-A,D=[],P=0;P<O;P++)D[P]=0<N?I.i(P+A)>>>N|I.i(P+A+1)<<32-N:I.i(P+A);return new d(D,I.h)}s.prototype.digest=s.prototype.v,s.prototype.reset=s.prototype.s,s.prototype.update=s.prototype.u,M0=s,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.A,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=y,d.fromString=x,Xi=d}).apply(typeof uv<"u"?uv:typeof self<"u"?self:typeof window<"u"?window:{});var xu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var O0,kl,F0,Au,Lf,U0,z0,$0;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,g,_){return u==Array.prototype||u==Object.prototype||(u[g]=_.value),u};function t(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof xu=="object"&&xu];for(var g=0;g<u.length;++g){var _=u[g];if(_&&_.Math==Math)return _}throw Error("Cannot find global object")}var s=t(this);function a(u,g){if(g)e:{var _=s;u=u.split(".");for(var R=0;R<u.length-1;R++){var Z=u[R];if(!(Z in _))break e;_=_[Z]}u=u[u.length-1],R=_[u],g=g(R),g!=R&&g!=null&&e(_,u,{configurable:!0,writable:!0,value:g})}}function l(u,g){u instanceof String&&(u+="");var _=0,R=!1,Z={next:function(){if(!R&&_<u.length){var oe=_++;return{value:g(oe,u[oe]),done:!1}}return R=!0,{done:!0,value:void 0}}};return Z[Symbol.iterator]=function(){return Z},Z}a("Array.prototype.values",function(u){return u||function(){return l(this,function(g,_){return _})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var d=d||{},f=this||self;function m(u){var g=typeof u;return g=g!="object"?g:u?Array.isArray(u)?"array":g:"null",g=="array"||g=="object"&&typeof u.length=="number"}function y(u){var g=typeof u;return g=="object"&&u!=null||g=="function"}function x(u,g,_){return u.call.apply(u.bind,arguments)}function E(u,g,_){if(!u)throw Error();if(2<arguments.length){var R=Array.prototype.slice.call(arguments,2);return function(){var Z=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Z,R),u.apply(g,Z)}}return function(){return u.apply(g,arguments)}}function C(u,g,_){return C=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?x:E,C.apply(null,arguments)}function U(u,g){var _=Array.prototype.slice.call(arguments,1);return function(){var R=_.slice();return R.push.apply(R,arguments),u.apply(this,R)}}function X(u,g){function _(){}_.prototype=g.prototype,u.aa=g.prototype,u.prototype=new _,u.prototype.constructor=u,u.Qb=function(R,Z,oe){for(var Le=Array(arguments.length-2),Dt=2;Dt<arguments.length;Dt++)Le[Dt-2]=arguments[Dt];return g.prototype[Z].apply(R,Le)}}function W(u){const g=u.length;if(0<g){const _=Array(g);for(let R=0;R<g;R++)_[R]=u[R];return _}return[]}function z(u,g){for(let _=1;_<arguments.length;_++){const R=arguments[_];if(m(R)){const Z=u.length||0,oe=R.length||0;u.length=Z+oe;for(let Le=0;Le<oe;Le++)u[Z+Le]=R[Le]}else u.push(R)}}class se{constructor(g,_){this.i=g,this.j=_,this.h=0,this.g=null}get(){let g;return 0<this.h?(this.h--,g=this.g,this.g=g.next,g.next=null):g=this.i(),g}}function we(u){return/^[\s\xa0]*$/.test(u)}function _e(){var u=f.navigator;return u&&(u=u.userAgent)?u:""}function ve(u){return ve[" "](u),u}ve[" "]=function(){};var L=_e().indexOf("Gecko")!=-1&&!(_e().toLowerCase().indexOf("webkit")!=-1&&_e().indexOf("Edge")==-1)&&!(_e().indexOf("Trident")!=-1||_e().indexOf("MSIE")!=-1)&&_e().indexOf("Edge")==-1;function ie(u,g,_){for(const R in u)g.call(_,u[R],R,u)}function I(u,g){for(const _ in u)g.call(void 0,u[_],_,u)}function N(u){const g={};for(const _ in u)g[_]=u[_];return g}const A="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function O(u,g){let _,R;for(let Z=1;Z<arguments.length;Z++){R=arguments[Z];for(_ in R)u[_]=R[_];for(let oe=0;oe<A.length;oe++)_=A[oe],Object.prototype.hasOwnProperty.call(R,_)&&(u[_]=R[_])}}function D(u){var g=1;u=u.split(":");const _=[];for(;0<g&&u.length;)_.push(u.shift()),g--;return u.length&&_.push(u.join(":")),_}function P(u){f.setTimeout(()=>{throw u},0)}function b(){var u=Pe;let g=null;return u.g&&(g=u.g,u.g=u.g.next,u.g||(u.h=null),g.next=null),g}class J{constructor(){this.h=this.g=null}add(g,_){const R=re.get();R.set(g,_),this.h?this.h.next=R:this.g=R,this.h=R}}var re=new se(()=>new Ie,u=>u.reset());class Ie{constructor(){this.next=this.g=this.h=null}set(g,_){this.h=g,this.g=_,this.next=null}reset(){this.next=this.g=this.h=null}}let he,ce=!1,Pe=new J,xe=()=>{const u=f.Promise.resolve(void 0);he=()=>{u.then(Y)}};var Y=()=>{for(var u;u=b();){try{u.h.call(u.g)}catch(_){P(_)}var g=re;g.j(u),100>g.h&&(g.h++,u.next=g.g,g.g=u)}ce=!1};function k(){this.s=this.s,this.C=this.C}k.prototype.s=!1,k.prototype.ma=function(){this.s||(this.s=!0,this.N())},k.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function H(u,g){this.type=u,this.g=this.target=g,this.defaultPrevented=!1}H.prototype.h=function(){this.defaultPrevented=!0};var Te=(function(){if(!f.addEventListener||!Object.defineProperty)return!1;var u=!1,g=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const _=()=>{};f.addEventListener("test",_,g),f.removeEventListener("test",_,g)}catch{}return u})();function Ve(u,g){if(H.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var _=this.type=u.type,R=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=g,g=u.relatedTarget){if(L){e:{try{ve(g.nodeName);var Z=!0;break e}catch{}Z=!1}Z||(g=null)}}else _=="mouseover"?g=u.fromElement:_=="mouseout"&&(g=u.toElement);this.relatedTarget=g,R?(this.clientX=R.clientX!==void 0?R.clientX:R.pageX,this.clientY=R.clientY!==void 0?R.clientY:R.pageY,this.screenX=R.screenX||0,this.screenY=R.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:De[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&Ve.aa.h.call(this)}}X(Ve,H);var De={2:"touch",3:"pen",4:"mouse"};Ve.prototype.h=function(){Ve.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var Oe="closure_listenable_"+(1e6*Math.random()|0),Qe=0;function nt(u,g,_,R,Z){this.listener=u,this.proxy=null,this.src=g,this.type=_,this.capture=!!R,this.ha=Z,this.key=++Qe,this.da=this.fa=!1}function ge(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function le(u){this.src=u,this.g={},this.h=0}le.prototype.add=function(u,g,_,R,Z){var oe=u.toString();u=this.g[oe],u||(u=this.g[oe]=[],this.h++);var Le=pe(u,g,R,Z);return-1<Le?(g=u[Le],_||(g.fa=!1)):(g=new nt(g,this.src,oe,!!R,Z),g.fa=_,u.push(g)),g};function Me(u,g){var _=g.type;if(_ in u.g){var R=u.g[_],Z=Array.prototype.indexOf.call(R,g,void 0),oe;(oe=0<=Z)&&Array.prototype.splice.call(R,Z,1),oe&&(ge(g),u.g[_].length==0&&(delete u.g[_],u.h--))}}function pe(u,g,_,R){for(var Z=0;Z<u.length;++Z){var oe=u[Z];if(!oe.da&&oe.listener==g&&oe.capture==!!_&&oe.ha==R)return Z}return-1}var qe="closure_lm_"+(1e6*Math.random()|0),Ye={};function It(u,g,_,R,Z){if(Array.isArray(g)){for(var oe=0;oe<g.length;oe++)It(u,g[oe],_,R,Z);return null}return _=Kn(_),u&&u[Oe]?u.K(g,_,y(R)?!!R.capture:!1,Z):At(u,g,_,!1,R,Z)}function At(u,g,_,R,Z,oe){if(!g)throw Error("Invalid event type");var Le=y(Z)?!!Z.capture:!!Z,Dt=lr(u);if(Dt||(u[qe]=Dt=new le(u)),_=Dt.add(g,_,R,Le,oe),_.proxy)return _;if(R=wt(),_.proxy=R,R.src=u,R.listener=_,u.addEventListener)Te||(Z=Le),Z===void 0&&(Z=!1),u.addEventListener(g.toString(),R,Z);else if(u.attachEvent)u.attachEvent(un(g.toString()),R);else if(u.addListener&&u.removeListener)u.addListener(R);else throw Error("addEventListener and attachEvent are unavailable.");return _}function wt(){function u(_){return g.call(u.src,u.listener,_)}const g=Fn;return u}function jt(u,g,_,R,Z){if(Array.isArray(g))for(var oe=0;oe<g.length;oe++)jt(u,g[oe],_,R,Z);else R=y(R)?!!R.capture:!!R,_=Kn(_),u&&u[Oe]?(u=u.i,g=String(g).toString(),g in u.g&&(oe=u.g[g],_=pe(oe,_,R,Z),-1<_&&(ge(oe[_]),Array.prototype.splice.call(oe,_,1),oe.length==0&&(delete u.g[g],u.h--)))):u&&(u=lr(u))&&(g=u.g[g.toString()],u=-1,g&&(u=pe(g,_,R,Z)),(_=-1<u?g[u]:null)&&sn(_))}function sn(u){if(typeof u!="number"&&u&&!u.da){var g=u.src;if(g&&g[Oe])Me(g.i,u);else{var _=u.type,R=u.proxy;g.removeEventListener?g.removeEventListener(_,R,u.capture):g.detachEvent?g.detachEvent(un(_),R):g.addListener&&g.removeListener&&g.removeListener(R),(_=lr(g))?(Me(_,u),_.h==0&&(_.src=null,g[qe]=null)):ge(u)}}}function un(u){return u in Ye?Ye[u]:Ye[u]="on"+u}function Fn(u,g){if(u.da)u=!0;else{g=new Ve(g,this);var _=u.listener,R=u.ha||u.src;u.fa&&sn(u),u=_.call(R,g)}return u}function lr(u){return u=u[qe],u instanceof le?u:null}var Gt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Kn(u){return typeof u=="function"?u:(u[Gt]||(u[Gt]=function(g){return u.handleEvent(g)}),u[Gt])}function Ft(){k.call(this),this.i=new le(this),this.M=this,this.F=null}X(Ft,k),Ft.prototype[Oe]=!0,Ft.prototype.removeEventListener=function(u,g,_,R){jt(this,u,g,_,R)};function Ut(u,g){var _,R=u.F;if(R)for(_=[];R;R=R.F)_.push(R);if(u=u.M,R=g.type||g,typeof g=="string")g=new H(g,u);else if(g instanceof H)g.target=g.target||u;else{var Z=g;g=new H(R,u),O(g,Z)}if(Z=!0,_)for(var oe=_.length-1;0<=oe;oe--){var Le=g.g=_[oe];Z=dn(Le,R,!0,g)&&Z}if(Le=g.g=u,Z=dn(Le,R,!0,g)&&Z,Z=dn(Le,R,!1,g)&&Z,_)for(oe=0;oe<_.length;oe++)Le=g.g=_[oe],Z=dn(Le,R,!1,g)&&Z}Ft.prototype.N=function(){if(Ft.aa.N.call(this),this.i){var u=this.i,g;for(g in u.g){for(var _=u.g[g],R=0;R<_.length;R++)ge(_[R]);delete u.g[g],u.h--}}this.F=null},Ft.prototype.K=function(u,g,_,R){return this.i.add(String(u),g,!1,_,R)},Ft.prototype.L=function(u,g,_,R){return this.i.add(String(u),g,!0,_,R)};function dn(u,g,_,R){if(g=u.i.g[String(g)],!g)return!0;g=g.concat();for(var Z=!0,oe=0;oe<g.length;++oe){var Le=g[oe];if(Le&&!Le.da&&Le.capture==_){var Dt=Le.listener,En=Le.ha||Le.src;Le.fa&&Me(u.i,Le),Z=Dt.call(En,R)!==!1&&Z}}return Z&&!R.defaultPrevented}function Qn(u,g,_){if(typeof u=="function")_&&(u=C(u,_));else if(u&&typeof u.handleEvent=="function")u=C(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(g)?-1:f.setTimeout(u,g||0)}function In(u){u.g=Qn(()=>{u.g=null,u.i&&(u.i=!1,In(u))},u.l);const g=u.h;u.h=null,u.m.apply(null,g)}class Yn extends k{constructor(g,_){super(),this.m=g,this.l=_,this.h=null,this.i=!1,this.g=null}j(g){this.h=arguments,this.g?this.i=!0:In(this)}N(){super.N(),this.g&&(f.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Dr(u){k.call(this),this.h=u,this.g={}}X(Dr,k);var ds=[];function cr(u){ie(u.g,function(g,_){this.g.hasOwnProperty(_)&&sn(g)},u),u.g={}}Dr.prototype.N=function(){Dr.aa.N.call(this),cr(this)},Dr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Un=f.JSON.stringify,Vr=f.JSON.parse,_r=class{stringify(u){return f.JSON.stringify(u,void 0)}parse(u){return f.JSON.parse(u,void 0)}};function dt(){}dt.prototype.h=null;function Wr(u){return u.h||(u.h=u.i())}function Jn(){}var vn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function zn(){H.call(this,"d")}X(zn,H);function hs(){H.call(this,"c")}X(hs,H);var Nn={},xr=null;function Gr(){return xr=xr||new Ft}Nn.La="serverreachability";function qr(u){H.call(this,Nn.La,u)}X(qr,H);function wr(u){const g=Gr();Ut(g,new qr(g))}Nn.STAT_EVENT="statevent";function js(u,g){H.call(this,Nn.STAT_EVENT,u),this.stat=g}X(js,H);function ot(u){const g=Gr();Ut(g,new js(g,u))}Nn.Ma="timingevent";function Hr(u,g){H.call(this,Nn.Ma,u),this.size=g}X(Hr,H);function Pn(u,g){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return f.setTimeout(function(){u()},g)}function fs(){this.g=!0}fs.prototype.xa=function(){this.g=!1};function Xn(u,g,_,R,Z,oe){u.info(function(){if(u.g)if(oe)for(var Le="",Dt=oe.split("&"),En=0;En<Dt.length;En++){var Et=Dt[En].split("=");if(1<Et.length){var Dn=Et[0];Et=Et[1];var fn=Dn.split("_");Le=2<=fn.length&&fn[1]=="type"?Le+(Dn+"="+Et+"&"):Le+(Dn+"=redacted&")}}else Le=null;else Le=oe;return"XMLHTTP REQ ("+R+") [attempt "+Z+"]: "+g+`
`+_+`
`+Le})}function ks(u,g,_,R,Z,oe,Le){u.info(function(){return"XMLHTTP RESP ("+R+") [ attempt "+Z+"]: "+g+`
`+_+`
`+oe+" "+Le})}function ur(u,g,_,R){u.info(function(){return"XMLHTTP TEXT ("+g+"): "+an(u,_)+(R?" "+R:"")})}function Ti(u,g){u.info(function(){return"TIMEOUT: "+g})}fs.prototype.info=function(){};function an(u,g){if(!u.g)return g;if(!g)return null;try{var _=JSON.parse(g);if(_){for(u=0;u<_.length;u++)if(Array.isArray(_[u])){var R=_[u];if(!(2>R.length)){var Z=R[1];if(Array.isArray(Z)&&!(1>Z.length)){var oe=Z[0];if(oe!="noop"&&oe!="stop"&&oe!="close")for(var Le=1;Le<Z.length;Le++)Z[Le]=""}}}}return Un(_)}catch{return g}}var Zt={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Lr={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Rn;function $n(){}X($n,dt),$n.prototype.g=function(){return new XMLHttpRequest},$n.prototype.i=function(){return{}},Rn=new $n;function zt(u,g,_,R){this.j=u,this.i=g,this.l=_,this.R=R||1,this.U=new Dr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new ps}function ps(){this.i=null,this.g="",this.h=!1}var Ds={},ms={};function gs(u,g,_){u.L=1,u.v=Ms(xn(g)),u.m=_,u.P=!0,Kr(u,null)}function Kr(u,g){u.F=Date.now(),ft(u),u.A=xn(u.v);var _=u.A,R=u.R;Array.isArray(R)||(R=[String(R)]),ys(_.i,"t",R),u.C=0,_=u.j.J,u.h=new ps,u.g=Tc(u.j,_?g:null,!u.m),0<u.O&&(u.M=new Yn(C(u.Y,u,u.g),u.O)),g=u.U,_=u.g,R=u.ca;var Z="readystatechange";Array.isArray(Z)||(Z&&(ds[0]=Z.toString()),Z=ds);for(var oe=0;oe<Z.length;oe++){var Le=It(_,Z[oe],R||g.handleEvent,!1,g.h||g);if(!Le)break;g.g[Le.key]=Le}g=u.H?N(u.H):{},u.m?(u.u||(u.u="POST"),g["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,g)):(u.u="GET",u.g.ea(u.A,u.u,null,g)),wr(),Xn(u.i,u.u,u.A,u.l,u.R,u.m)}zt.prototype.ca=function(u){u=u.target;const g=this.M;g&&kn(u)==3?g.j():this.Y(u)},zt.prototype.Y=function(u){try{if(u==this.g)e:{const fn=kn(this.g);var g=this.g.Ba();const Zr=this.g.Z();if(!(3>fn)&&(fn!=3||this.g&&(this.h.h||this.g.oa()||va(this.g)))){this.J||fn!=4||g==7||(g==8||0>=Zr?wr(3):wr(2)),An(this);var _=this.g.Z();this.X=_;t:if(dr(this)){var R=va(this.g);u="";var Z=R.length,oe=kn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){w(this),en(this);var Le="";break t}this.h.i=new f.TextDecoder}for(g=0;g<Z;g++)this.h.h=!0,u+=this.h.i.decode(R[g],{stream:!(oe&&g==Z-1)});R.length=0,this.h.g+=u,this.C=0,Le=this.h.g}else Le=this.g.oa();if(this.o=_==200,ks(this.i,this.u,this.A,this.l,this.R,fn,_),this.o){if(this.T&&!this.K){t:{if(this.g){var Dt,En=this.g;if((Dt=En.g?En.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!we(Dt)){var Et=Dt;break t}}Et=null}if(_=Et)ur(this.i,this.l,_,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,B(this,_);else{this.o=!1,this.s=3,ot(12),w(this),en(this);break e}}if(this.P){_=!0;let Or;for(;!this.J&&this.C<Le.length;)if(Or=fa(this,Le),Or==ms){fn==4&&(this.s=4,ot(14),_=!1),ur(this.i,this.l,null,"[Incomplete Response]");break}else if(Or==Ds){this.s=4,ot(15),ur(this.i,this.l,Le,"[Invalid Chunk]"),_=!1;break}else ur(this.i,this.l,Or,null),B(this,Or);if(dr(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),fn!=4||Le.length!=0||this.h.h||(this.s=1,ot(16),_=!1),this.o=this.o&&_,!_)ur(this.i,this.l,Le,"[Invalid Chunked Response]"),w(this),en(this);else if(0<Le.length&&!this.W){this.W=!0;var Dn=this.j;Dn.g==this&&Dn.ba&&!Dn.M&&(Dn.j.info("Great, no buffering proxy detected. Bytes received: "+Le.length),rl(Dn),Dn.M=!0,ot(11))}}else ur(this.i,this.l,Le,null),B(this,Le);fn==4&&w(this),this.o&&!this.J&&(fn==4?ro(this.j,this):(this.o=!1,ft(this)))}else Si(this.g),_==400&&0<Le.indexOf("Unknown SID")?(this.s=3,ot(12)):(this.s=0,ot(13)),w(this),en(this)}}}catch{}finally{}};function dr(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function fa(u,g){var _=u.C,R=g.indexOf(`
`,_);return R==-1?ms:(_=Number(g.substring(_,R)),isNaN(_)?Ds:(R+=1,R+_>g.length?ms:(g=g.slice(R,R+_),u.C=R+_,g)))}zt.prototype.cancel=function(){this.J=!0,w(this)};function ft(u){u.S=Date.now()+u.I,_n(u,u.I)}function _n(u,g){if(u.B!=null)throw Error("WatchDog timer not null");u.B=Pn(C(u.ba,u),g)}function An(u){u.B&&(f.clearTimeout(u.B),u.B=null)}zt.prototype.ba=function(){this.B=null;const u=Date.now();0<=u-this.S?(Ti(this.i,this.A),this.L!=2&&(wr(),ot(17)),w(this),this.s=2,en(this)):_n(this,this.S-u)};function en(u){u.j.G==0||u.J||ro(u.j,u)}function w(u){An(u);var g=u.M;g&&typeof g.ma=="function"&&g.ma(),u.M=null,cr(u.U),u.g&&(g=u.g,u.g=null,g.abort(),g.ma())}function B(u,g){try{var _=u.j;if(_.G!=0&&(_.g==u||ne(_.h,u))){if(!u.K&&ne(_.h,u)&&_.G==3){try{var R=_.Da.g.parse(g)}catch{R=null}if(Array.isArray(R)&&R.length==3){var Z=R;if(Z[0]==0){e:if(!_.u){if(_.g)if(_.g.F+3e3<u.F)no(_),_s(_);else break e;to(_),ot(18)}}else _.za=Z[1],0<_.za-_.T&&37500>Z[2]&&_.F&&_.v==0&&!_.C&&(_.C=Pn(C(_.Za,_),6e3));if(1>=me(_.h)&&_.ca){try{_.ca()}catch{}_.ca=void 0}}else ti(_,11)}else if((u.K||_.g==u)&&no(_),!we(g))for(Z=_.Da.g.parse(g),g=0;g<Z.length;g++){let Et=Z[g];if(_.T=Et[0],Et=Et[1],_.G==2)if(Et[0]=="c"){_.K=Et[1],_.ia=Et[2];const Dn=Et[3];Dn!=null&&(_.la=Dn,_.j.info("VER="+_.la));const fn=Et[4];fn!=null&&(_.Aa=fn,_.j.info("SVER="+_.Aa));const Zr=Et[5];Zr!=null&&typeof Zr=="number"&&0<Zr&&(R=1.5*Zr,_.L=R,_.j.info("backChannelRequestTimeoutMs_="+R)),R=_;const Or=u.g;if(Or){const xa=Or.g?Or.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(xa){var oe=R.h;oe.g||xa.indexOf("spdy")==-1&&xa.indexOf("quic")==-1&&xa.indexOf("h2")==-1||(oe.j=oe.l,oe.g=new Set,oe.h&&(je(oe,oe.h),oe.h=null))}if(R.D){const io=Or.g?Or.g.getResponseHeader("X-HTTP-Session-Id"):null;io&&(R.ya=io,kt(R.I,R.D,io))}}_.G=3,_.l&&_.l.ua(),_.ba&&(_.R=Date.now()-u.F,_.j.info("Handshake RTT: "+_.R+"ms")),R=_;var Le=u;if(R.qa=Ec(R,R.J?R.ia:null,R.W),Le.K){Se(R.h,Le);var Dt=Le,En=R.L;En&&(Dt.I=En),Dt.B&&(An(Dt),ft(Dt)),R.g=Le}else _a(R);0<_.i.length&&Fs(_)}else Et[0]!="stop"&&Et[0]!="close"||ti(_,7);else _.G==3&&(Et[0]=="stop"||Et[0]=="close"?Et[0]=="stop"?ti(_,7):wn(_):Et[0]!="noop"&&_.l&&_.l.ta(Et),_.v=0)}}wr(4)}catch{}}var F=class{constructor(u,g){this.g=u,this.map=g}};function M(u){this.l=u||10,f.PerformanceNavigationTiming?(u=f.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(f.chrome&&f.chrome.loadTimes&&f.chrome.loadTimes()&&f.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function G(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function me(u){return u.h?1:u.g?u.g.size:0}function ne(u,g){return u.h?u.h==g:u.g?u.g.has(g):!1}function je(u,g){u.g?u.g.add(g):u.h=g}function Se(u,g){u.h&&u.h==g?u.h=null:u.g&&u.g.has(g)&&u.g.delete(g)}M.prototype.cancel=function(){if(this.i=We(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function We(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let g=u.i;for(const _ of u.g.values())g=g.concat(_.D);return g}return W(u.i)}function de(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(m(u)){for(var g=[],_=u.length,R=0;R<_;R++)g.push(u[R]);return g}g=[],_=0;for(R in u)g[_++]=u[R];return g}function Je(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(m(u)||typeof u=="string"){var g=[];u=u.length;for(var _=0;_<u;_++)g.push(_);return g}g=[],_=0;for(const R in u)g[_++]=R;return g}}}function Re(u,g){if(u.forEach&&typeof u.forEach=="function")u.forEach(g,void 0);else if(m(u)||typeof u=="string")Array.prototype.forEach.call(u,g,void 0);else for(var _=Je(u),R=de(u),Z=R.length,oe=0;oe<Z;oe++)g.call(void 0,R[oe],_&&_[oe],u)}var ht=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Vs(u,g){if(u){u=u.split("&");for(var _=0;_<u.length;_++){var R=u[_].indexOf("="),Z=null;if(0<=R){var oe=u[_].substring(0,R);Z=u[_].substring(R+1)}else oe=u[_];g(oe,Z?decodeURIComponent(Z.replace(/\+/g," ")):"")}}}function hr(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof hr){this.h=u.h,fr(this,u.j),this.o=u.o,this.g=u.g,Qr(this,u.s),this.l=u.l;var g=u.i,_=new jn;_.i=g.i,g.g&&(_.g=new Map(g.g),_.h=g.h),Ls(this,_),this.m=u.m}else u&&(g=String(u).match(ht))?(this.h=!1,fr(this,g[1]||"",!0),this.o=gt(g[2]||""),this.g=gt(g[3]||"",!0),Qr(this,g[4]),this.l=gt(g[5]||"",!0),Ls(this,g[6]||"",!0),this.m=gt(g[7]||"")):(this.h=!1,this.i=new jn(null,this.h))}hr.prototype.toString=function(){var u=[],g=this.j;g&&u.push(Nt(g,pr,!0),":");var _=this.g;return(_||g=="file")&&(u.push("//"),(g=this.o)&&u.push(Nt(g,pr,!0),"@"),u.push(encodeURIComponent(String(_)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_=this.s,_!=null&&u.push(":",String(_))),(_=this.l)&&(this.g&&_.charAt(0)!="/"&&u.push("/"),u.push(Nt(_,_.charAt(0)=="/"?ma:pa,!0))),(_=this.i.toString())&&u.push("?",_),(_=this.m)&&u.push("#",Nt(_,ya)),u.join("")};function xn(u){return new hr(u)}function fr(u,g,_){u.j=_?gt(g,!0):g,u.j&&(u.j=u.j.replace(/:$/,""))}function Qr(u,g){if(g){if(g=Number(g),isNaN(g)||0>g)throw Error("Bad port number "+g);u.s=g}else u.s=null}function Ls(u,g,_){g instanceof jn?(u.i=g,Yr(u.i,u.h)):(_||(g=Nt(g,ga)),u.i=new jn(g,u.h))}function kt(u,g,_){u.i.set(g,_)}function Ms(u){return kt(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function gt(u,g){return u?g?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function Nt(u,g,_){return typeof u=="string"?(u=encodeURI(u).replace(g,Os),_&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function Os(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var pr=/[#\/\?@]/g,pa=/[#\?:]/g,ma=/[#\?]/g,ga=/[#\?@]/g,ya=/#/g;function jn(u,g){this.h=this.g=null,this.i=u||null,this.j=!!g}function hn(u){u.g||(u.g=new Map,u.h=0,u.i&&Vs(u.i,function(g,_){u.add(decodeURIComponent(g.replace(/\+/g," ")),_)}))}n=jn.prototype,n.add=function(u,g){hn(this),this.i=null,u=mr(this,u);var _=this.g.get(u);return _||this.g.set(u,_=[]),_.push(g),this.h+=1,this};function Mr(u,g){hn(u),g=mr(u,g),u.g.has(g)&&(u.i=null,u.h-=u.g.get(g).length,u.g.delete(g))}function Er(u,g){return hn(u),g=mr(u,g),u.g.has(g)}n.forEach=function(u,g){hn(this),this.g.forEach(function(_,R){_.forEach(function(Z){u.call(g,Z,R,this)},this)},this)},n.na=function(){hn(this);const u=Array.from(this.g.values()),g=Array.from(this.g.keys()),_=[];for(let R=0;R<g.length;R++){const Z=u[R];for(let oe=0;oe<Z.length;oe++)_.push(g[R])}return _},n.V=function(u){hn(this);let g=[];if(typeof u=="string")Er(this,u)&&(g=g.concat(this.g.get(mr(this,u))));else{u=Array.from(this.g.values());for(let _=0;_<u.length;_++)g=g.concat(u[_])}return g},n.set=function(u,g){return hn(this),this.i=null,u=mr(this,u),Er(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[g]),this.h+=1,this},n.get=function(u,g){return u?(u=this.V(u),0<u.length?String(u[0]):g):g};function ys(u,g,_){Mr(u,g),0<_.length&&(u.i=null,u.g.set(mr(u,g),W(_)),u.h+=_.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],g=Array.from(this.g.keys());for(var _=0;_<g.length;_++){var R=g[_];const oe=encodeURIComponent(String(R)),Le=this.V(R);for(R=0;R<Le.length;R++){var Z=oe;Le[R]!==""&&(Z+="="+encodeURIComponent(String(Le[R]))),u.push(Z)}}return this.i=u.join("&")};function mr(u,g){return g=String(g),u.j&&(g=g.toLowerCase()),g}function Yr(u,g){g&&!u.j&&(hn(u),u.i=null,u.g.forEach(function(_,R){var Z=R.toLowerCase();R!=Z&&(Mr(this,R),ys(this,Z,_))},u)),u.j=g}function Ja(u,g){const _=new fs;if(f.Image){const R=new Image;R.onload=U(T,_,"TestLoadImage: loaded",!0,g,R),R.onerror=U(T,_,"TestLoadImage: error",!1,g,R),R.onabort=U(T,_,"TestLoadImage: abort",!1,g,R),R.ontimeout=U(T,_,"TestLoadImage: timeout",!1,g,R),f.setTimeout(function(){R.ontimeout&&R.ontimeout()},1e4),R.src=u}else g(!1)}function Xa(u,g){const _=new fs,R=new AbortController,Z=setTimeout(()=>{R.abort(),T(_,"TestPingServer: timeout",!1,g)},1e4);fetch(u,{signal:R.signal}).then(oe=>{clearTimeout(Z),oe.ok?T(_,"TestPingServer: ok",!0,g):T(_,"TestPingServer: server error",!1,g)}).catch(()=>{clearTimeout(Z),T(_,"TestPingServer: error",!1,g)})}function T(u,g,_,R,Z){try{Z&&(Z.onload=null,Z.onerror=null,Z.onabort=null,Z.ontimeout=null),R(_)}catch{}}function $(){this.g=new _r}function K(u,g,_){const R=_||"";try{Re(u,function(Z,oe){let Le=Z;y(Z)&&(Le=Un(Z)),g.push(R+oe+"="+encodeURIComponent(Le))})}catch(Z){throw g.push(R+"type="+encodeURIComponent("_badmap")),Z}}function ue(u){this.l=u.Ub||null,this.j=u.eb||!1}X(ue,dt),ue.prototype.g=function(){return new Ce(this.l,this.j)},ue.prototype.i=(function(u){return function(){return u}})({});function Ce(u,g){Ft.call(this),this.D=u,this.o=g,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}X(Ce,Ft),n=Ce.prototype,n.open=function(u,g){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=g,this.readyState=1,rt(this)},n.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const g={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(g.body=u),(this.D||f).fetch(new Request(this.A,g)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ae(this)),this.readyState=0},n.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,rt(this)),this.g&&(this.readyState=3,rt(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof f.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;He(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function He(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}n.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var g=u.value?u.value:new Uint8Array(0);(g=this.v.decode(g,{stream:!u.done}))&&(this.response=this.responseText+=g)}u.done?Ae(this):rt(this),this.readyState==3&&He(this)}},n.Ra=function(u){this.g&&(this.response=this.responseText=u,Ae(this))},n.Qa=function(u){this.g&&(this.response=u,Ae(this))},n.ga=function(){this.g&&Ae(this)};function Ae(u){u.readyState=4,u.l=null,u.j=null,u.v=null,rt(u)}n.setRequestHeader=function(u,g){this.u.append(u,g)},n.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],g=this.h.entries();for(var _=g.next();!_.done;)_=_.value,u.push(_[0]+": "+_[1]),_=g.next();return u.join(`\r
`)};function rt(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(Ce.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function pt(u){let g="";return ie(u,function(_,R){g+=R,g+=":",g+=_,g+=`\r
`}),g}function St(u,g,_){e:{for(R in _){var R=!1;break e}R=!0}R||(_=pt(_),typeof u=="string"?_!=null&&encodeURIComponent(String(_)):kt(u,g,_))}function ct(u){Ft.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}X(ct,Ft);var qt=/^https?$/i,Zn=["POST","PUT"];n=ct.prototype,n.Ha=function(u){this.J=u},n.ea=function(u,g,_,R){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);g=g?g.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Rn.g(),this.v=this.o?Wr(this.o):Wr(Rn),this.g.onreadystatechange=C(this.Ea,this);try{this.B=!0,this.g.open(g,String(u),!0),this.B=!1}catch(oe){Qt(this,oe);return}if(u=_||"",_=new Map(this.headers),R)if(Object.getPrototypeOf(R)===Object.prototype)for(var Z in R)_.set(Z,R[Z]);else if(typeof R.keys=="function"&&typeof R.get=="function")for(const oe of R.keys())_.set(oe,R.get(oe));else throw Error("Unknown input type for opt_headers: "+String(R));R=Array.from(_.keys()).find(oe=>oe.toLowerCase()=="content-type"),Z=f.FormData&&u instanceof f.FormData,!(0<=Array.prototype.indexOf.call(Zn,g,void 0))||R||Z||_.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[oe,Le]of _)this.g.setRequestHeader(oe,Le);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Tr(this),this.u=!0,this.g.send(u),this.u=!1}catch(oe){Qt(this,oe)}};function Qt(u,g){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=g,u.m=5,vt(u),Lt(u)}function vt(u){u.A||(u.A=!0,Ut(u,"complete"),Ut(u,"error"))}n.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,Ut(this,"complete"),Ut(this,"abort"),Lt(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Lt(this,!0)),ct.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Jr(this):this.bb())},n.bb=function(){Jr(this)};function Jr(u){if(u.h&&typeof d<"u"&&(!u.v[1]||kn(u)!=4||u.Z()!=2)){if(u.u&&kn(u)==4)Qn(u.Ea,0,u);else if(Ut(u,"readystatechange"),kn(u)==4){u.h=!1;try{const Le=u.Z();e:switch(Le){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var g=!0;break e;default:g=!1}var _;if(!(_=g)){var R;if(R=Le===0){var Z=String(u.D).match(ht)[1]||null;!Z&&f.self&&f.self.location&&(Z=f.self.location.protocol.slice(0,-1)),R=!qt.test(Z?Z.toLowerCase():"")}_=R}if(_)Ut(u,"complete"),Ut(u,"success");else{u.m=6;try{var oe=2<kn(u)?u.g.statusText:""}catch{oe=""}u.l=oe+" ["+u.Z()+"]",vt(u)}}finally{Lt(u)}}}}function Lt(u,g){if(u.g){Tr(u);const _=u.g,R=u.v[0]?()=>{}:null;u.g=null,u.v=null,g||Ut(u,"ready");try{_.onreadystatechange=R}catch{}}}function Tr(u){u.I&&(f.clearTimeout(u.I),u.I=null)}n.isActive=function(){return!!this.g};function kn(u){return u.g?u.g.readyState:0}n.Z=function(){try{return 2<kn(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(u){if(this.g){var g=this.g.responseText;return u&&g.indexOf(u)==0&&(g=g.substring(u.length)),Vr(g)}};function va(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function Si(u){const g={};u=(u.g&&2<=kn(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let R=0;R<u.length;R++){if(we(u[R]))continue;var _=D(u[R]);const Z=_[0];if(_=_[1],typeof _!="string")continue;_=_.trim();const oe=g[Z]||[];g[Z]=oe,oe.push(_)}I(g,function(R){return R.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Xr(u,g,_){return _&&_.internalChannelParams&&_.internalChannelParams[u]||g}function vs(u){this.Aa=0,this.i=[],this.j=new fs,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Xr("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Xr("baseRetryDelayMs",5e3,u),this.cb=Xr("retryDelaySeedMs",1e4,u),this.Wa=Xr("forwardChannelMaxRetries",2,u),this.wa=Xr("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new M(u&&u.concurrentRequestLimit),this.Da=new $,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=vs.prototype,n.la=8,n.G=1,n.connect=function(u,g,_,R){ot(0),this.W=u,this.H=g||{},_&&R!==void 0&&(this.H.OSID=_,this.H.OAID=R),this.F=this.X,this.I=Ec(this,null,this.W),Fs(this)};function wn(u){if(Za(u),u.G==3){var g=u.U++,_=xn(u.I);if(kt(_,"SID",u.K),kt(_,"RID",g),kt(_,"TYPE","terminate"),ei(u,_),g=new zt(u,u.j,g),g.L=2,g.v=Ms(xn(_)),_=!1,f.navigator&&f.navigator.sendBeacon)try{_=f.navigator.sendBeacon(g.v.toString(),"")}catch{}!_&&f.Image&&(new Image().src=g.v,_=!0),_||(g.g=Tc(g.j,null),g.g.ea(g.v)),g.F=Date.now(),ft(g)}wc(u)}function _s(u){u.g&&(rl(u),u.g.cancel(),u.g=null)}function Za(u){_s(u),u.u&&(f.clearTimeout(u.u),u.u=null),no(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&f.clearTimeout(u.s),u.s=null)}function Fs(u){if(!G(u.h)&&!u.s){u.s=!0;var g=u.Ga;he||xe(),ce||(he(),ce=!0),Pe.add(g,u),u.B=0}}function Dd(u,g){return me(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=g.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=Pn(C(u.Ga,u,g),xc(u,u.B)),u.B++,!0)}n.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;const Z=new zt(this,this.j,u);let oe=this.o;if(this.S&&(oe?(oe=N(oe),O(oe,this.S)):oe=this.S),this.m!==null||this.O||(Z.H=oe,oe=null),this.P)e:{for(var g=0,_=0;_<this.i.length;_++){t:{var R=this.i[_];if("__data__"in R.map&&(R=R.map.__data__,typeof R=="string")){R=R.length;break t}R=void 0}if(R===void 0)break;if(g+=R,4096<g){g=_;break e}if(g===4096||_===this.i.length-1){g=_+1;break e}}g=1e3}else g=1e3;g=bi(this,Z,g),_=xn(this.I),kt(_,"RID",u),kt(_,"CVER",22),this.D&&kt(_,"X-HTTP-Session-Id",this.D),ei(this,_),oe&&(this.O?g="headers="+encodeURIComponent(String(pt(oe)))+"&"+g:this.m&&St(_,this.m,oe)),je(this.h,Z),this.Ua&&kt(_,"TYPE","init"),this.P?(kt(_,"$req",g),kt(_,"SID","null"),Z.T=!0,gs(Z,_,null)):gs(Z,_,g),this.G=2}}else this.G==3&&(u?eo(this,u):this.i.length==0||G(this.h)||eo(this))};function eo(u,g){var _;g?_=g.l:_=u.U++;const R=xn(u.I);kt(R,"SID",u.K),kt(R,"RID",_),kt(R,"AID",u.T),ei(u,R),u.m&&u.o&&St(R,u.m,u.o),_=new zt(u,u.j,_,u.B+1),u.m===null&&(_.H=u.o),g&&(u.i=g.D.concat(u.i)),g=bi(u,_,1e3),_.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),je(u.h,_),gs(_,R,g)}function ei(u,g){u.H&&ie(u.H,function(_,R){kt(g,R,_)}),u.l&&Re({},function(_,R){kt(g,R,_)})}function bi(u,g,_){_=Math.min(u.i.length,_);var R=u.l?C(u.l.Na,u.l,u):null;e:{var Z=u.i;let oe=-1;for(;;){const Le=["count="+_];oe==-1?0<_?(oe=Z[0].g,Le.push("ofs="+oe)):oe=0:Le.push("ofs="+oe);let Dt=!0;for(let En=0;En<_;En++){let Et=Z[En].g;const Dn=Z[En].map;if(Et-=oe,0>Et)oe=Math.max(0,Z[En].g-100),Dt=!1;else try{K(Dn,Le,"req"+Et+"_")}catch{R&&R(Dn)}}if(Dt){R=Le.join("&");break e}}}return u=u.i.splice(0,_),g.D=u,R}function _a(u){if(!u.g&&!u.u){u.Y=1;var g=u.Fa;he||xe(),ce||(he(),ce=!0),Pe.add(g,u),u.v=0}}function to(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=Pn(C(u.Fa,u),xc(u,u.v)),u.v++,!0)}n.Fa=function(){if(this.u=null,_c(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=Pn(C(this.ab,this),u)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,ot(10),_s(this),_c(this))};function rl(u){u.A!=null&&(f.clearTimeout(u.A),u.A=null)}function _c(u){u.g=new zt(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var g=xn(u.qa);kt(g,"RID","rpc"),kt(g,"SID",u.K),kt(g,"AID",u.T),kt(g,"CI",u.F?"0":"1"),!u.F&&u.ja&&kt(g,"TO",u.ja),kt(g,"TYPE","xmlhttp"),ei(u,g),u.m&&u.o&&St(g,u.m,u.o),u.L&&(u.g.I=u.L);var _=u.g;u=u.ia,_.L=1,_.v=Ms(xn(g)),_.m=null,_.P=!0,Kr(_,u)}n.Za=function(){this.C!=null&&(this.C=null,_s(this),to(this),ot(19))};function no(u){u.C!=null&&(f.clearTimeout(u.C),u.C=null)}function ro(u,g){var _=null;if(u.g==g){no(u),rl(u),u.g=null;var R=2}else if(ne(u.h,g))_=g.D,Se(u.h,g),R=1;else return;if(u.G!=0){if(g.o)if(R==1){_=g.m?g.m.length:0,g=Date.now()-g.F;var Z=u.B;R=Gr(),Ut(R,new Hr(R,_)),Fs(u)}else _a(u);else if(Z=g.s,Z==3||Z==0&&0<g.X||!(R==1&&Dd(u,g)||R==2&&to(u)))switch(_&&0<_.length&&(g=u.h,g.i=g.i.concat(_)),Z){case 1:ti(u,5);break;case 4:ti(u,10);break;case 3:ti(u,6);break;default:ti(u,2)}}}function xc(u,g){let _=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(_*=2),_*g}function ti(u,g){if(u.j.info("Error code "+g),g==2){var _=C(u.fb,u),R=u.Xa;const Z=!R;R=new hr(R||"//www.google.com/images/cleardot.gif"),f.location&&f.location.protocol=="http"||fr(R,"https"),Ms(R),Z?Ja(R.toString(),_):Xa(R.toString(),_)}else ot(2);u.G=0,u.l&&u.l.sa(g),wc(u),Za(u)}n.fb=function(u){u?(this.j.info("Successfully pinged google.com"),ot(2)):(this.j.info("Failed to ping google.com"),ot(1))};function wc(u){if(u.G=0,u.ka=[],u.l){const g=We(u.h);(g.length!=0||u.i.length!=0)&&(z(u.ka,g),z(u.ka,u.i),u.h.i.length=0,W(u.i),u.i.length=0),u.l.ra()}}function Ec(u,g,_){var R=_ instanceof hr?xn(_):new hr(_);if(R.g!="")g&&(R.g=g+"."+R.g),Qr(R,R.s);else{var Z=f.location;R=Z.protocol,g=g?g+"."+Z.hostname:Z.hostname,Z=+Z.port;var oe=new hr(null);R&&fr(oe,R),g&&(oe.g=g),Z&&Qr(oe,Z),_&&(oe.l=_),R=oe}return _=u.D,g=u.ya,_&&g&&kt(R,_,g),kt(R,"VER",u.la),ei(u,R),R}function Tc(u,g,_){if(g&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return g=u.Ca&&!u.pa?new ct(new ue({eb:_})):new ct(u.pa),g.Ha(u.J),g}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function sl(){}n=sl.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function so(){}so.prototype.g=function(u,g){return new gr(u,g)};function gr(u,g){Ft.call(this),this.g=new vs(g),this.l=u,this.h=g&&g.messageUrlParams||null,u=g&&g.messageHeaders||null,g&&g.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=g&&g.initMessageHeaders||null,g&&g.messageContentType&&(u?u["X-WebChannel-Content-Type"]=g.messageContentType:u={"X-WebChannel-Content-Type":g.messageContentType}),g&&g.va&&(u?u["X-WebChannel-Client-Profile"]=g.va:u={"X-WebChannel-Client-Profile":g.va}),this.g.S=u,(u=g&&g.Sb)&&!we(u)&&(this.g.m=u),this.v=g&&g.supportsCrossDomainXhr||!1,this.u=g&&g.sendRawJson||!1,(g=g&&g.httpSessionIdParam)&&!we(g)&&(this.g.D=g,u=this.h,u!==null&&g in u&&(u=this.h,g in u&&delete u[g])),this.j=new Us(this)}X(gr,Ft),gr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},gr.prototype.close=function(){wn(this.g)},gr.prototype.o=function(u){var g=this.g;if(typeof u=="string"){var _={};_.__data__=u,u=_}else this.u&&(_={},_.__data__=Un(u),u=_);g.i.push(new F(g.Ya++,u)),g.G==3&&Fs(g)},gr.prototype.N=function(){this.g.l=null,delete this.j,wn(this.g),delete this.g,gr.aa.N.call(this)};function Sc(u){zn.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var g=u.__sm__;if(g){e:{for(const _ in g){u=_;break e}u=void 0}(this.i=u)&&(u=this.i,g=g!==null&&u in g?g[u]:void 0),this.data=g}else this.data=u}X(Sc,zn);function bc(){hs.call(this),this.status=1}X(bc,hs);function Us(u){this.g=u}X(Us,sl),Us.prototype.ua=function(){Ut(this.g,"a")},Us.prototype.ta=function(u){Ut(this.g,new Sc(u))},Us.prototype.sa=function(u){Ut(this.g,new bc)},Us.prototype.ra=function(){Ut(this.g,"b")},so.prototype.createWebChannel=so.prototype.g,gr.prototype.send=gr.prototype.o,gr.prototype.open=gr.prototype.m,gr.prototype.close=gr.prototype.close,$0=function(){return new so},z0=function(){return Gr()},U0=Nn,Lf={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Zt.NO_ERROR=0,Zt.TIMEOUT=8,Zt.HTTP_ERROR=6,Au=Zt,Lr.COMPLETE="complete",F0=Lr,Jn.EventType=vn,vn.OPEN="a",vn.CLOSE="b",vn.ERROR="c",vn.MESSAGE="d",Ft.prototype.listen=Ft.prototype.K,kl=Jn,ct.prototype.listenOnce=ct.prototype.L,ct.prototype.getLastError=ct.prototype.Ka,ct.prototype.getLastErrorCode=ct.prototype.Ba,ct.prototype.getStatus=ct.prototype.Z,ct.prototype.getResponseJson=ct.prototype.Oa,ct.prototype.getResponseText=ct.prototype.oa,ct.prototype.send=ct.prototype.ea,ct.prototype.setWithCredentials=ct.prototype.Ha,O0=ct}).apply(typeof xu<"u"?xu:typeof self<"u"?self:typeof window<"u"?window:{});const dv="@firebase/firestore",hv="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ir{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ir.UNAUTHENTICATED=new ir(null),ir.GOOGLE_CREDENTIALS=new ir("google-credentials-uid"),ir.FIRST_PARTY=new ir("first-party-uid"),ir.MOCK_USER=new ir("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Xo="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ga=new cp("@firebase/firestore");function Ro(){return Ga.logLevel}function ze(n,...e){if(Ga.logLevel<=_t.DEBUG){const t=e.map(Tp);Ga.debug(`Firestore (${Xo}): ${n}`,...t)}}function yi(n,...e){if(Ga.logLevel<=_t.ERROR){const t=e.map(Tp);Ga.error(`Firestore (${Xo}): ${n}`,...t)}}function ea(n,...e){if(Ga.logLevel<=_t.WARN){const t=e.map(Tp);Ga.warn(`Firestore (${Xo}): ${n}`,...t)}}function Tp(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function it(n,e,t){let s="Unexpected state";typeof e=="string"?s=e:t=e,B0(n,s,t)}function B0(n,e,t){let s=`FIRESTORE (${Xo}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{s+=" CONTEXT: "+JSON.stringify(t)}catch{s+=" CONTEXT: "+t}throw yi(s),new Error(s)}function Rt(n,e,t,s){let a="Unexpected state";typeof t=="string"?a=t:s=t,n||B0(e,a,s)}function ut(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Fe extends wi{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fi{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W0{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class zC{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(ir.UNAUTHENTICATED)))}shutdown(){}}class $C{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class BC{constructor(e){this.t=e,this.currentUser=ir.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Rt(this.o===void 0,42304);let s=this.i;const a=m=>this.i!==s?(s=this.i,t(m)):Promise.resolve();let l=new fi;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new fi,e.enqueueRetryable((()=>a(this.currentUser)))};const d=()=>{const m=l;e.enqueueRetryable((async()=>{await m.promise,await a(this.currentUser)}))},f=m=>{ze("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=m,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit((m=>f(m))),setTimeout((()=>{if(!this.auth){const m=this.t.getImmediate({optional:!0});m?f(m):(ze("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new fi)}}),0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((s=>this.i!==e?(ze("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(Rt(typeof s.accessToken=="string",31837,{l:s}),new W0(s.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Rt(e===null||typeof e=="string",2055,{h:e}),new ir(e)}}class WC{constructor(e,t,s){this.P=e,this.T=t,this.I=s,this.type="FirstParty",this.user=ir.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class GC{constructor(e,t,s){this.P=e,this.T=t,this.I=s}getToken(){return Promise.resolve(new WC(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(ir.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class fv{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class qC{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,$r(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Rt(this.o===void 0,3512);const s=l=>{l.error!=null&&ze("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const d=l.token!==this.m;return this.m=l.token,ze("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?t(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable((()=>s(l)))};const a=l=>{ze("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((l=>a(l))),setTimeout((()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?a(l):ze("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new fv(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Rt(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new fv(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HC(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let s=0;s<n;s++)t[s]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G0(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sp{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let s="";for(;s.length<20;){const a=HC(40);for(let l=0;l<a.length;++l)s.length<20&&a[l]<t&&(s+=e.charAt(a[l]%62))}return s}}function mt(n,e){return n<e?-1:n>e?1:0}function Mf(n,e){let t=0;for(;t<n.length&&t<e.length;){const s=n.codePointAt(t),a=e.codePointAt(t);if(s!==a){if(s<128&&a<128)return mt(s,a);{const l=G0(),d=KC(l.encode(pv(n,t)),l.encode(pv(e,t)));return d!==0?d:mt(s,a)}}t+=s>65535?2:1}return mt(n.length,e.length)}function pv(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function KC(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return mt(n[t],e[t]);return mt(n.length,e.length)}function Uo(n,e,t){return n.length===e.length&&n.every(((s,a)=>t(s,e[a])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mv="__name__";class Gs{constructor(e,t,s){t===void 0?t=0:t>e.length&&it(637,{offset:t,range:e.length}),s===void 0?s=e.length-t:s>e.length-t&&it(1746,{length:s,range:e.length-t}),this.segments=e,this.offset=t,this.len=s}get length(){return this.len}isEqual(e){return Gs.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Gs?e.forEach((s=>{t.push(s)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,s=this.limit();t<s;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const s=Math.min(e.length,t.length);for(let a=0;a<s;a++){const l=Gs.compareSegments(e.get(a),t.get(a));if(l!==0)return l}return mt(e.length,t.length)}static compareSegments(e,t){const s=Gs.isNumericId(e),a=Gs.isNumericId(t);return s&&!a?-1:!s&&a?1:s&&a?Gs.extractNumericId(e).compare(Gs.extractNumericId(t)):Mf(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Xi.fromString(e.substring(4,e.length-2))}}class Ot extends Gs{construct(e,t,s){return new Ot(e,t,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const s of e){if(s.indexOf("//")>=0)throw new Fe(fe.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);t.push(...s.split("/").filter((a=>a.length>0)))}return new Ot(t)}static emptyPath(){return new Ot([])}}const QC=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class qn extends Gs{construct(e,t,s){return new qn(e,t,s)}static isValidIdentifier(e){return QC.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),qn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===mv}static keyField(){return new qn([mv])}static fromServerFormat(e){const t=[];let s="",a=0;const l=()=>{if(s.length===0)throw new Fe(fe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(s),s=""};let d=!1;for(;a<e.length;){const f=e[a];if(f==="\\"){if(a+1===e.length)throw new Fe(fe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const m=e[a+1];if(m!=="\\"&&m!=="."&&m!=="`")throw new Fe(fe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=m,a+=2}else f==="`"?(d=!d,a++):f!=="."||d?(s+=f,a++):(l(),a++)}if(l(),d)throw new Fe(fe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new qn(t)}static emptyPath(){return new qn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xe{constructor(e){this.path=e}static fromPath(e){return new Xe(Ot.fromString(e))}static fromName(e){return new Xe(Ot.fromString(e).popFirst(5))}static empty(){return new Xe(Ot.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ot.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Ot.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Xe(new Ot(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q0(n,e,t){if(!t)throw new Fe(fe.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function YC(n,e,t,s){if(e===!0&&s===!0)throw new Fe(fe.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function gv(n){if(!Xe.isDocumentKey(n))throw new Fe(fe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function yv(n){if(Xe.isDocumentKey(n))throw new Fe(fe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function H0(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function fd(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(s){return s.constructor?s.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":it(12329,{type:typeof n})}function kr(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Fe(fe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=fd(n);throw new Fe(fe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yn(n,e){const t={typeString:n};return e&&(t.value=e),t}function uc(n,e){if(!H0(n))throw new Fe(fe.INVALID_ARGUMENT,"JSON must be an object");let t;for(const s in e)if(e[s]){const a=e[s].typeString,l="value"in e[s]?{value:e[s].value}:void 0;if(!(s in n)){t=`JSON missing required field: '${s}'`;break}const d=n[s];if(a&&typeof d!==a){t=`JSON field '${s}' must be a ${a}.`;break}if(l!==void 0&&d!==l.value){t=`Expected '${s}' field to equal '${l.value}'`;break}}if(t)throw new Fe(fe.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vv=-62135596800,_v=1e6;class Wt{static now(){return Wt.fromMillis(Date.now())}static fromDate(e){return Wt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),s=Math.floor((e-1e3*t)*_v);return new Wt(t,s)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Fe(fe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Fe(fe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<vv)throw new Fe(fe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Fe(fe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/_v}_compareTo(e){return this.seconds===e.seconds?mt(this.nanoseconds,e.nanoseconds):mt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Wt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(uc(e,Wt._jsonSchema))return new Wt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-vv;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Wt._jsonSchemaVersion="firestore/timestamp/1.0",Wt._jsonSchema={type:yn("string",Wt._jsonSchemaVersion),seconds:yn("number"),nanoseconds:yn("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lt{static fromTimestamp(e){return new lt(e)}static min(){return new lt(new Wt(0,0))}static max(){return new lt(new Wt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ql=-1;function JC(n,e){const t=n.toTimestamp().seconds,s=n.toTimestamp().nanoseconds+1,a=lt.fromTimestamp(s===1e9?new Wt(t+1,0):new Wt(t,s));return new ta(a,Xe.empty(),e)}function XC(n){return new ta(n.readTime,n.key,Ql)}class ta{constructor(e,t,s){this.readTime=e,this.documentKey=t,this.largestBatchId=s}static min(){return new ta(lt.min(),Xe.empty(),Ql)}static max(){return new ta(lt.max(),Xe.empty(),Ql)}}function ZC(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Xe.comparator(n.documentKey,e.documentKey),t!==0?t:mt(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eI="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class tI{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zo(n){if(n.code!==fe.FAILED_PRECONDITION||n.message!==eI)throw n;ze("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ye{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&it(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ye(((s,a)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(s,a)},this.catchCallback=l=>{this.wrapFailure(t,l).next(s,a)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof ye?t:ye.resolve(t)}catch(t){return ye.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):ye.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):ye.reject(t)}static resolve(e){return new ye(((t,s)=>{t(e)}))}static reject(e){return new ye(((t,s)=>{s(e)}))}static waitFor(e){return new ye(((t,s)=>{let a=0,l=0,d=!1;e.forEach((f=>{++a,f.next((()=>{++l,d&&l===a&&t()}),(m=>s(m)))})),d=!0,l===a&&t()}))}static or(e){let t=ye.resolve(!1);for(const s of e)t=t.next((a=>a?ye.resolve(a):s()));return t}static forEach(e,t){const s=[];return e.forEach(((a,l)=>{s.push(t.call(this,a,l))})),this.waitFor(s)}static mapArray(e,t){return new ye(((s,a)=>{const l=e.length,d=new Array(l);let f=0;for(let m=0;m<l;m++){const y=m;t(e[y]).next((x=>{d[y]=x,++f,f===l&&s(d)}),(x=>a(x)))}}))}static doWhile(e,t){return new ye(((s,a)=>{const l=()=>{e()===!0?t().next((()=>{l()}),a):s()};l()}))}}function nI(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function el(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pd{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=s=>this._e(s),this.ae=s=>t.writeSequenceNumber(s))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}}pd.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bp=-1;function md(n){return n==null}function Ku(n){return n===0&&1/n==-1/0}function rI(n){return typeof n=="number"&&Number.isInteger(n)&&!Ku(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K0="";function sI(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=xv(e)),e=iI(n.get(t),e);return xv(e)}function iI(n,e){let t=e;const s=n.length;for(let a=0;a<s;a++){const l=n.charAt(a);switch(l){case"\0":t+="";break;case K0:t+="";break;default:t+=l}}return t}function xv(n){return n+K0+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wv(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function da(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Q0(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xt{constructor(e,t){this.comparator=e,this.root=t||Gn.EMPTY}insert(e,t){return new Xt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Gn.BLACK,null,null))}remove(e){return new Xt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Gn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const s=this.comparator(e,t.key);if(s===0)return t.value;s<0?t=t.left:s>0&&(t=t.right)}return null}indexOf(e){let t=0,s=this.root;for(;!s.isEmpty();){const a=this.comparator(e,s.key);if(a===0)return t+s.left.size;a<0?s=s.left:(t+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,s)=>(e(t,s),!1)))}toString(){const e=[];return this.inorderTraversal(((t,s)=>(e.push(`${t}:${s}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new wu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new wu(this.root,e,this.comparator,!1)}getReverseIterator(){return new wu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new wu(this.root,e,this.comparator,!0)}}class wu{constructor(e,t,s,a){this.isReverse=a,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=t?s(e.key,t):1,t&&a&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Gn{constructor(e,t,s,a,l){this.key=e,this.value=t,this.color=s??Gn.RED,this.left=a??Gn.EMPTY,this.right=l??Gn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,s,a,l){return new Gn(e??this.key,t??this.value,s??this.color,a??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,s){let a=this;const l=s(e,a.key);return a=l<0?a.copy(null,null,null,a.left.insert(e,t,s),null):l===0?a.copy(null,t,null,null,null):a.copy(null,null,null,null,a.right.insert(e,t,s)),a.fixUp()}removeMin(){if(this.left.isEmpty())return Gn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let s,a=this;if(t(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,t),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),t(e,a.key)===0){if(a.right.isEmpty())return Gn.EMPTY;s=a.right.min(),a=a.copy(s.key,s.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,t))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Gn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Gn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw it(43730,{key:this.key,value:this.value});if(this.right.isRed())throw it(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw it(27949);return e+(this.isRed()?0:1)}}Gn.EMPTY=null,Gn.RED=!0,Gn.BLACK=!1;Gn.EMPTY=new class{constructor(){this.size=0}get key(){throw it(57766)}get value(){throw it(16141)}get color(){throw it(16727)}get left(){throw it(29726)}get right(){throw it(36894)}copy(e,t,s,a,l){return this}insert(e,t,s){return new Gn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cn{constructor(e){this.comparator=e,this.data=new Xt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,s)=>(e(t),!1)))}forEachInRange(e,t){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const a=s.getNext();if(this.comparator(a.key,e[1])>=0)return;t(a.key)}}forEachWhile(e,t){let s;for(s=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Ev(this.data.getIterator())}getIteratorFrom(e){return new Ev(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((s=>{t=t.add(s)})),t}isEqual(e){if(!(e instanceof Cn)||this.size!==e.size)return!1;const t=this.data.getIterator(),s=e.data.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=s.getNext().key;if(this.comparator(a,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Cn(this.comparator);return t.data=e,t}}class Ev{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Br{constructor(e){this.fields=e,e.sort(qn.comparator)}static empty(){return new Br([])}unionWith(e){let t=new Cn(qn.comparator);for(const s of this.fields)t=t.add(s);for(const s of e)t=t.add(s);return new Br(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Uo(this.fields,e.fields,((t,s)=>t.isEqual(s)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y0 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(a){try{return atob(a)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new Y0("Invalid base64 string: "+l):l}})(e);return new Hn(t)}static fromUint8Array(e){const t=(function(a){let l="";for(let d=0;d<a.length;++d)l+=String.fromCharCode(a[d]);return l})(e);return new Hn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const s=new Uint8Array(t.length);for(let a=0;a<t.length;a++)s[a]=t.charCodeAt(a);return s})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return mt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Hn.EMPTY_BYTE_STRING=new Hn("");const aI=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function na(n){if(Rt(!!n,39018),typeof n=="string"){let e=0;const t=aI.exec(n);if(Rt(!!t,46558,{timestamp:n}),t[1]){let a=t[1];a=(a+"000000000").substr(0,9),e=Number(a)}const s=new Date(n);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:ln(n.seconds),nanos:ln(n.nanos)}}function ln(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function ra(n){return typeof n=="string"?Hn.fromBase64String(n):Hn.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J0="server_timestamp",X0="__type__",Z0="__previous_value__",ex="__local_write_time__";function Cp(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[X0])===null||t===void 0?void 0:t.stringValue)===J0}function gd(n){const e=n.mapValue.fields[Z0];return Cp(e)?gd(e):e}function Yl(n){const e=na(n.mapValue.fields[ex].timestampValue);return new Wt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oI{constructor(e,t,s,a,l,d,f,m,y,x){this.databaseId=e,this.appId=t,this.persistenceKey=s,this.host=a,this.ssl=l,this.forceLongPolling=d,this.autoDetectLongPolling=f,this.longPollingOptions=m,this.useFetchStreams=y,this.isUsingEmulator=x}}const Qu="(default)";class Jl{constructor(e,t){this.projectId=e,this.database=t||Qu}static empty(){return new Jl("","")}get isDefaultDatabase(){return this.database===Qu}isEqual(e){return e instanceof Jl&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tx="__type__",lI="__max__",Eu={mapValue:{}},nx="__vector__",Yu="value";function sa(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Cp(n)?4:uI(n)?9007199254740991:cI(n)?10:11:it(28295,{value:n})}function Xs(n,e){if(n===e)return!0;const t=sa(n);if(t!==sa(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Yl(n).isEqual(Yl(e));case 3:return(function(a,l){if(typeof a.timestampValue=="string"&&typeof l.timestampValue=="string"&&a.timestampValue.length===l.timestampValue.length)return a.timestampValue===l.timestampValue;const d=na(a.timestampValue),f=na(l.timestampValue);return d.seconds===f.seconds&&d.nanos===f.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(a,l){return ra(a.bytesValue).isEqual(ra(l.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(a,l){return ln(a.geoPointValue.latitude)===ln(l.geoPointValue.latitude)&&ln(a.geoPointValue.longitude)===ln(l.geoPointValue.longitude)})(n,e);case 2:return(function(a,l){if("integerValue"in a&&"integerValue"in l)return ln(a.integerValue)===ln(l.integerValue);if("doubleValue"in a&&"doubleValue"in l){const d=ln(a.doubleValue),f=ln(l.doubleValue);return d===f?Ku(d)===Ku(f):isNaN(d)&&isNaN(f)}return!1})(n,e);case 9:return Uo(n.arrayValue.values||[],e.arrayValue.values||[],Xs);case 10:case 11:return(function(a,l){const d=a.mapValue.fields||{},f=l.mapValue.fields||{};if(wv(d)!==wv(f))return!1;for(const m in d)if(d.hasOwnProperty(m)&&(f[m]===void 0||!Xs(d[m],f[m])))return!1;return!0})(n,e);default:return it(52216,{left:n})}}function Xl(n,e){return(n.values||[]).find((t=>Xs(t,e)))!==void 0}function zo(n,e){if(n===e)return 0;const t=sa(n),s=sa(e);if(t!==s)return mt(t,s);switch(t){case 0:case 9007199254740991:return 0;case 1:return mt(n.booleanValue,e.booleanValue);case 2:return(function(l,d){const f=ln(l.integerValue||l.doubleValue),m=ln(d.integerValue||d.doubleValue);return f<m?-1:f>m?1:f===m?0:isNaN(f)?isNaN(m)?0:-1:1})(n,e);case 3:return Tv(n.timestampValue,e.timestampValue);case 4:return Tv(Yl(n),Yl(e));case 5:return Mf(n.stringValue,e.stringValue);case 6:return(function(l,d){const f=ra(l),m=ra(d);return f.compareTo(m)})(n.bytesValue,e.bytesValue);case 7:return(function(l,d){const f=l.split("/"),m=d.split("/");for(let y=0;y<f.length&&y<m.length;y++){const x=mt(f[y],m[y]);if(x!==0)return x}return mt(f.length,m.length)})(n.referenceValue,e.referenceValue);case 8:return(function(l,d){const f=mt(ln(l.latitude),ln(d.latitude));return f!==0?f:mt(ln(l.longitude),ln(d.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Sv(n.arrayValue,e.arrayValue);case 10:return(function(l,d){var f,m,y,x;const E=l.fields||{},C=d.fields||{},U=(f=E[Yu])===null||f===void 0?void 0:f.arrayValue,X=(m=C[Yu])===null||m===void 0?void 0:m.arrayValue,W=mt(((y=U==null?void 0:U.values)===null||y===void 0?void 0:y.length)||0,((x=X==null?void 0:X.values)===null||x===void 0?void 0:x.length)||0);return W!==0?W:Sv(U,X)})(n.mapValue,e.mapValue);case 11:return(function(l,d){if(l===Eu.mapValue&&d===Eu.mapValue)return 0;if(l===Eu.mapValue)return 1;if(d===Eu.mapValue)return-1;const f=l.fields||{},m=Object.keys(f),y=d.fields||{},x=Object.keys(y);m.sort(),x.sort();for(let E=0;E<m.length&&E<x.length;++E){const C=Mf(m[E],x[E]);if(C!==0)return C;const U=zo(f[m[E]],y[x[E]]);if(U!==0)return U}return mt(m.length,x.length)})(n.mapValue,e.mapValue);default:throw it(23264,{le:t})}}function Tv(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return mt(n,e);const t=na(n),s=na(e),a=mt(t.seconds,s.seconds);return a!==0?a:mt(t.nanos,s.nanos)}function Sv(n,e){const t=n.values||[],s=e.values||[];for(let a=0;a<t.length&&a<s.length;++a){const l=zo(t[a],s[a]);if(l)return l}return mt(t.length,s.length)}function $o(n){return Of(n)}function Of(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const s=na(t);return`time(${s.seconds},${s.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return ra(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Xe.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let s="[",a=!0;for(const l of t.values||[])a?a=!1:s+=",",s+=Of(l);return s+"]"})(n.arrayValue):"mapValue"in n?(function(t){const s=Object.keys(t.fields||{}).sort();let a="{",l=!0;for(const d of s)l?l=!1:a+=",",a+=`${d}:${Of(t.fields[d])}`;return a+"}"})(n.mapValue):it(61005,{value:n})}function ju(n){switch(sa(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=gd(n);return e?16+ju(e):16;case 5:return 2*n.stringValue.length;case 6:return ra(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(s){return(s.values||[]).reduce(((a,l)=>a+ju(l)),0)})(n.arrayValue);case 10:case 11:return(function(s){let a=0;return da(s.fields,((l,d)=>{a+=l.length+ju(d)})),a})(n.mapValue);default:throw it(13486,{value:n})}}function bv(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Ff(n){return!!n&&"integerValue"in n}function Ip(n){return!!n&&"arrayValue"in n}function Cv(n){return!!n&&"nullValue"in n}function Iv(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function ku(n){return!!n&&"mapValue"in n}function cI(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[tx])===null||t===void 0?void 0:t.stringValue)===nx}function Ul(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return da(n.mapValue.fields,((t,s)=>e.mapValue.fields[t]=Ul(s))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Ul(n.arrayValue.values[t]);return e}return Object.assign({},n)}function uI(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===lI}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jr{constructor(e){this.value=e}static empty(){return new jr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let s=0;s<e.length-1;++s)if(t=(t.mapValue.fields||{})[e.get(s)],!ku(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ul(t)}setAll(e){let t=qn.emptyPath(),s={},a=[];e.forEach(((d,f)=>{if(!t.isImmediateParentOf(f)){const m=this.getFieldsMap(t);this.applyChanges(m,s,a),s={},a=[],t=f.popLast()}d?s[f.lastSegment()]=Ul(d):a.push(f.lastSegment())}));const l=this.getFieldsMap(t);this.applyChanges(l,s,a)}delete(e){const t=this.field(e.popLast());ku(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Xs(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let s=0;s<e.length;++s){let a=t.mapValue.fields[e.get(s)];ku(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},t.mapValue.fields[e.get(s)]=a),t=a}return t.mapValue.fields}applyChanges(e,t,s){da(t,((a,l)=>e[a]=l));for(const a of s)delete e[a]}clone(){return new jr(Ul(this.value))}}function rx(n){const e=[];return da(n.fields,((t,s)=>{const a=new qn([t]);if(ku(s)){const l=rx(s.mapValue).fields;if(l.length===0)e.push(a);else for(const d of l)e.push(a.child(d))}else e.push(a)})),new Br(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ar{constructor(e,t,s,a,l,d,f){this.key=e,this.documentType=t,this.version=s,this.readTime=a,this.createTime=l,this.data=d,this.documentState=f}static newInvalidDocument(e){return new ar(e,0,lt.min(),lt.min(),lt.min(),jr.empty(),0)}static newFoundDocument(e,t,s,a){return new ar(e,1,t,lt.min(),s,a,0)}static newNoDocument(e,t){return new ar(e,2,t,lt.min(),lt.min(),jr.empty(),0)}static newUnknownDocument(e,t){return new ar(e,3,t,lt.min(),lt.min(),jr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(lt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=jr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=jr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=lt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ar&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ar(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ju{constructor(e,t){this.position=e,this.inclusive=t}}function Nv(n,e,t){let s=0;for(let a=0;a<n.position.length;a++){const l=e[a],d=n.position[a];if(l.field.isKeyField()?s=Xe.comparator(Xe.fromName(d.referenceValue),t.key):s=zo(d,t.data.field(l.field)),l.dir==="desc"&&(s*=-1),s!==0)break}return s}function Pv(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Xs(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zl{constructor(e,t="asc"){this.field=e,this.dir=t}}function dI(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sx{}class gn extends sx{constructor(e,t,s){super(),this.field=e,this.op=t,this.value=s}static create(e,t,s){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,s):new fI(e,t,s):t==="array-contains"?new gI(e,s):t==="in"?new yI(e,s):t==="not-in"?new vI(e,s):t==="array-contains-any"?new _I(e,s):new gn(e,t,s)}static createKeyFieldInFilter(e,t,s){return t==="in"?new pI(e,s):new mI(e,s)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(zo(t,this.value)):t!==null&&sa(this.value)===sa(t)&&this.matchesComparison(zo(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return it(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class As extends sx{constructor(e,t){super(),this.filters=e,this.op=t,this.he=null}static create(e,t){return new As(e,t)}matches(e){return ix(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function ix(n){return n.op==="and"}function ax(n){return hI(n)&&ix(n)}function hI(n){for(const e of n.filters)if(e instanceof As)return!1;return!0}function Uf(n){if(n instanceof gn)return n.field.canonicalString()+n.op.toString()+$o(n.value);if(ax(n))return n.filters.map((e=>Uf(e))).join(",");{const e=n.filters.map((t=>Uf(t))).join(",");return`${n.op}(${e})`}}function ox(n,e){return n instanceof gn?(function(s,a){return a instanceof gn&&s.op===a.op&&s.field.isEqual(a.field)&&Xs(s.value,a.value)})(n,e):n instanceof As?(function(s,a){return a instanceof As&&s.op===a.op&&s.filters.length===a.filters.length?s.filters.reduce(((l,d,f)=>l&&ox(d,a.filters[f])),!0):!1})(n,e):void it(19439)}function lx(n){return n instanceof gn?(function(t){return`${t.field.canonicalString()} ${t.op} ${$o(t.value)}`})(n):n instanceof As?(function(t){return t.op.toString()+" {"+t.getFilters().map(lx).join(" ,")+"}"})(n):"Filter"}class fI extends gn{constructor(e,t,s){super(e,t,s),this.key=Xe.fromName(s.referenceValue)}matches(e){const t=Xe.comparator(e.key,this.key);return this.matchesComparison(t)}}class pI extends gn{constructor(e,t){super(e,"in",t),this.keys=cx("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class mI extends gn{constructor(e,t){super(e,"not-in",t),this.keys=cx("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function cx(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map((s=>Xe.fromName(s.referenceValue)))}class gI extends gn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Ip(t)&&Xl(t.arrayValue,this.value)}}class yI extends gn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Xl(this.value.arrayValue,t)}}class vI extends gn{constructor(e,t){super(e,"not-in",t)}matches(e){if(Xl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Xl(this.value.arrayValue,t)}}class _I extends gn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Ip(t)||!t.arrayValue.values)&&t.arrayValue.values.some((s=>Xl(this.value.arrayValue,s)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xI{constructor(e,t=null,s=[],a=[],l=null,d=null,f=null){this.path=e,this.collectionGroup=t,this.orderBy=s,this.filters=a,this.limit=l,this.startAt=d,this.endAt=f,this.Pe=null}}function Rv(n,e=null,t=[],s=[],a=null,l=null,d=null){return new xI(n,e,t,s,a,l,d)}function Np(n){const e=ut(n);if(e.Pe===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((s=>Uf(s))).join(","),t+="|ob:",t+=e.orderBy.map((s=>(function(l){return l.field.canonicalString()+l.dir})(s))).join(","),md(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((s=>$o(s))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((s=>$o(s))).join(",")),e.Pe=t}return e.Pe}function Pp(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!dI(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!ox(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Pv(n.startAt,e.startAt)&&Pv(n.endAt,e.endAt)}function zf(n){return Xe.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tl{constructor(e,t=null,s=[],a=[],l=null,d="F",f=null,m=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=s,this.filters=a,this.limit=l,this.limitType=d,this.startAt=f,this.endAt=m,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function wI(n,e,t,s,a,l,d,f){return new tl(n,e,t,s,a,l,d,f)}function yd(n){return new tl(n)}function Av(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function ux(n){return n.collectionGroup!==null}function zl(n){const e=ut(n);if(e.Te===null){e.Te=[];const t=new Set;for(const l of e.explicitOrderBy)e.Te.push(l),t.add(l.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let f=new Cn(qn.comparator);return d.filters.forEach((m=>{m.getFlattenedFilters().forEach((y=>{y.isInequality()&&(f=f.add(y.field))}))})),f})(e).forEach((l=>{t.has(l.canonicalString())||l.isKeyField()||e.Te.push(new Zl(l,s))})),t.has(qn.keyField().canonicalString())||e.Te.push(new Zl(qn.keyField(),s))}return e.Te}function Ks(n){const e=ut(n);return e.Ie||(e.Ie=EI(e,zl(n))),e.Ie}function EI(n,e){if(n.limitType==="F")return Rv(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((a=>{const l=a.dir==="desc"?"asc":"desc";return new Zl(a.field,l)}));const t=n.endAt?new Ju(n.endAt.position,n.endAt.inclusive):null,s=n.startAt?new Ju(n.startAt.position,n.startAt.inclusive):null;return Rv(n.path,n.collectionGroup,e,n.filters,n.limit,t,s)}}function $f(n,e){const t=n.filters.concat([e]);return new tl(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Xu(n,e,t){return new tl(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function vd(n,e){return Pp(Ks(n),Ks(e))&&n.limitType===e.limitType}function dx(n){return`${Np(Ks(n))}|lt:${n.limitType}`}function Ao(n){return`Query(target=${(function(t){let s=t.path.canonicalString();return t.collectionGroup!==null&&(s+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(s+=`, filters: [${t.filters.map((a=>lx(a))).join(", ")}]`),md(t.limit)||(s+=", limit: "+t.limit),t.orderBy.length>0&&(s+=`, orderBy: [${t.orderBy.map((a=>(function(d){return`${d.field.canonicalString()} (${d.dir})`})(a))).join(", ")}]`),t.startAt&&(s+=", startAt: ",s+=t.startAt.inclusive?"b:":"a:",s+=t.startAt.position.map((a=>$o(a))).join(",")),t.endAt&&(s+=", endAt: ",s+=t.endAt.inclusive?"a:":"b:",s+=t.endAt.position.map((a=>$o(a))).join(",")),`Target(${s})`})(Ks(n))}; limitType=${n.limitType})`}function _d(n,e){return e.isFoundDocument()&&(function(s,a){const l=a.key.path;return s.collectionGroup!==null?a.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(l):Xe.isDocumentKey(s.path)?s.path.isEqual(l):s.path.isImmediateParentOf(l)})(n,e)&&(function(s,a){for(const l of zl(s))if(!l.field.isKeyField()&&a.data.field(l.field)===null)return!1;return!0})(n,e)&&(function(s,a){for(const l of s.filters)if(!l.matches(a))return!1;return!0})(n,e)&&(function(s,a){return!(s.startAt&&!(function(d,f,m){const y=Nv(d,f,m);return d.inclusive?y<=0:y<0})(s.startAt,zl(s),a)||s.endAt&&!(function(d,f,m){const y=Nv(d,f,m);return d.inclusive?y>=0:y>0})(s.endAt,zl(s),a))})(n,e)}function TI(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function hx(n){return(e,t)=>{let s=!1;for(const a of zl(n)){const l=SI(a,e,t);if(l!==0)return l;s=s||a.field.isKeyField()}return 0}}function SI(n,e,t){const s=n.field.isKeyField()?Xe.comparator(e.key,t.key):(function(l,d,f){const m=d.data.field(l),y=f.data.field(l);return m!==null&&y!==null?zo(m,y):it(42886)})(n.field,e,t);switch(n.dir){case"asc":return s;case"desc":return-1*s;default:return it(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ha{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s!==void 0){for(const[a,l]of s)if(this.equalsFn(a,e))return l}}has(e){return this.get(e)!==void 0}set(e,t){const s=this.mapKeyFn(e),a=this.inner[s];if(a===void 0)return this.inner[s]=[[e,t]],void this.innerSize++;for(let l=0;l<a.length;l++)if(this.equalsFn(a[l][0],e))return void(a[l]=[e,t]);a.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s===void 0)return!1;for(let a=0;a<s.length;a++)if(this.equalsFn(s[a][0],e))return s.length===1?delete this.inner[t]:s.splice(a,1),this.innerSize--,!0;return!1}forEach(e){da(this.inner,((t,s)=>{for(const[a,l]of s)e(a,l)}))}isEmpty(){return Q0(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bI=new Xt(Xe.comparator);function vi(){return bI}const fx=new Xt(Xe.comparator);function Dl(...n){let e=fx;for(const t of n)e=e.insert(t.key,t);return e}function px(n){let e=fx;return n.forEach(((t,s)=>e=e.insert(t,s.overlayedDocument))),e}function La(){return $l()}function mx(){return $l()}function $l(){return new Ha((n=>n.toString()),((n,e)=>n.isEqual(e)))}const CI=new Xt(Xe.comparator),II=new Cn(Xe.comparator);function xt(...n){let e=II;for(const t of n)e=e.add(t);return e}const NI=new Cn(mt);function PI(){return NI}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rp(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ku(e)?"-0":e}}function gx(n){return{integerValue:""+n}}function RI(n,e){return rI(e)?gx(e):Rp(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xd{constructor(){this._=void 0}}function AI(n,e,t){return n instanceof ec?(function(a,l){const d={fields:{[X0]:{stringValue:J0},[ex]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return l&&Cp(l)&&(l=gd(l)),l&&(d.fields[Z0]=l),{mapValue:d}})(t,e):n instanceof tc?vx(n,e):n instanceof nc?_x(n,e):(function(a,l){const d=yx(a,l),f=jv(d)+jv(a.Ee);return Ff(d)&&Ff(a.Ee)?gx(f):Rp(a.serializer,f)})(n,e)}function jI(n,e,t){return n instanceof tc?vx(n,e):n instanceof nc?_x(n,e):t}function yx(n,e){return n instanceof Zu?(function(s){return Ff(s)||(function(l){return!!l&&"doubleValue"in l})(s)})(e)?e:{integerValue:0}:null}class ec extends xd{}class tc extends xd{constructor(e){super(),this.elements=e}}function vx(n,e){const t=xx(e);for(const s of n.elements)t.some((a=>Xs(a,s)))||t.push(s);return{arrayValue:{values:t}}}class nc extends xd{constructor(e){super(),this.elements=e}}function _x(n,e){let t=xx(e);for(const s of n.elements)t=t.filter((a=>!Xs(a,s)));return{arrayValue:{values:t}}}class Zu extends xd{constructor(e,t){super(),this.serializer=e,this.Ee=t}}function jv(n){return ln(n.integerValue||n.doubleValue)}function xx(n){return Ip(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kI{constructor(e,t){this.field=e,this.transform=t}}function DI(n,e){return n.field.isEqual(e.field)&&(function(s,a){return s instanceof tc&&a instanceof tc||s instanceof nc&&a instanceof nc?Uo(s.elements,a.elements,Xs):s instanceof Zu&&a instanceof Zu?Xs(s.Ee,a.Ee):s instanceof ec&&a instanceof ec})(n.transform,e.transform)}class VI{constructor(e,t){this.version=e,this.transformResults=t}}class cs{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new cs}static exists(e){return new cs(void 0,e)}static updateTime(e){return new cs(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Du(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class wd{}function wx(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Ap(n.key,cs.none()):new dc(n.key,n.data,cs.none());{const t=n.data,s=jr.empty();let a=new Cn(qn.comparator);for(let l of e.fields)if(!a.has(l)){let d=t.field(l);d===null&&l.length>1&&(l=l.popLast(),d=t.field(l)),d===null?s.delete(l):s.set(l,d),a=a.add(l)}return new ha(n.key,s,new Br(a.toArray()),cs.none())}}function LI(n,e,t){n instanceof dc?(function(a,l,d){const f=a.value.clone(),m=Dv(a.fieldTransforms,l,d.transformResults);f.setAll(m),l.convertToFoundDocument(d.version,f).setHasCommittedMutations()})(n,e,t):n instanceof ha?(function(a,l,d){if(!Du(a.precondition,l))return void l.convertToUnknownDocument(d.version);const f=Dv(a.fieldTransforms,l,d.transformResults),m=l.data;m.setAll(Ex(a)),m.setAll(f),l.convertToFoundDocument(d.version,m).setHasCommittedMutations()})(n,e,t):(function(a,l,d){l.convertToNoDocument(d.version).setHasCommittedMutations()})(0,e,t)}function Bl(n,e,t,s){return n instanceof dc?(function(l,d,f,m){if(!Du(l.precondition,d))return f;const y=l.value.clone(),x=Vv(l.fieldTransforms,m,d);return y.setAll(x),d.convertToFoundDocument(d.version,y).setHasLocalMutations(),null})(n,e,t,s):n instanceof ha?(function(l,d,f,m){if(!Du(l.precondition,d))return f;const y=Vv(l.fieldTransforms,m,d),x=d.data;return x.setAll(Ex(l)),x.setAll(y),d.convertToFoundDocument(d.version,x).setHasLocalMutations(),f===null?null:f.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((E=>E.field)))})(n,e,t,s):(function(l,d,f){return Du(l.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):f})(n,e,t)}function MI(n,e){let t=null;for(const s of n.fieldTransforms){const a=e.data.field(s.field),l=yx(s.transform,a||null);l!=null&&(t===null&&(t=jr.empty()),t.set(s.field,l))}return t||null}function kv(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(s,a){return s===void 0&&a===void 0||!(!s||!a)&&Uo(s,a,((l,d)=>DI(l,d)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class dc extends wd{constructor(e,t,s,a=[]){super(),this.key=e,this.value=t,this.precondition=s,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class ha extends wd{constructor(e,t,s,a,l=[]){super(),this.key=e,this.data=t,this.fieldMask=s,this.precondition=a,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function Ex(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const s=n.data.field(t);e.set(t,s)}})),e}function Dv(n,e,t){const s=new Map;Rt(n.length===t.length,32656,{Ae:t.length,Re:n.length});for(let a=0;a<t.length;a++){const l=n[a],d=l.transform,f=e.data.field(l.field);s.set(l.field,jI(d,f,t[a]))}return s}function Vv(n,e,t){const s=new Map;for(const a of n){const l=a.transform,d=t.data.field(a.field);s.set(a.field,AI(l,d,e))}return s}class Ap extends wd{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class OI extends wd{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FI{constructor(e,t,s,a){this.batchId=e,this.localWriteTime=t,this.baseMutations=s,this.mutations=a}applyToRemoteDocument(e,t){const s=t.mutationResults;for(let a=0;a<this.mutations.length;a++){const l=this.mutations[a];l.key.isEqual(e.key)&&LI(l,e,s[a])}}applyToLocalView(e,t){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(t=Bl(s,e,t,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(t=Bl(s,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const s=mx();return this.mutations.forEach((a=>{const l=e.get(a.key),d=l.overlayedDocument;let f=this.applyToLocalView(d,l.mutatedFields);f=t.has(a.key)?null:f;const m=wx(d,f);m!==null&&s.set(a.key,m),d.isValidDocument()||d.convertToNoDocument(lt.min())})),s}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),xt())}isEqual(e){return this.batchId===e.batchId&&Uo(this.mutations,e.mutations,((t,s)=>kv(t,s)))&&Uo(this.baseMutations,e.baseMutations,((t,s)=>kv(t,s)))}}class jp{constructor(e,t,s,a){this.batch=e,this.commitVersion=t,this.mutationResults=s,this.docVersions=a}static from(e,t,s){Rt(e.mutations.length===s.length,58842,{Ve:e.mutations.length,me:s.length});let a=(function(){return CI})();const l=e.mutations;for(let d=0;d<l.length;d++)a=a.insert(l[d].key,s[d].version);return new jp(e,t,s,a)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UI{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zI{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var mn,Tt;function $I(n){switch(n){case fe.OK:return it(64938);case fe.CANCELLED:case fe.UNKNOWN:case fe.DEADLINE_EXCEEDED:case fe.RESOURCE_EXHAUSTED:case fe.INTERNAL:case fe.UNAVAILABLE:case fe.UNAUTHENTICATED:return!1;case fe.INVALID_ARGUMENT:case fe.NOT_FOUND:case fe.ALREADY_EXISTS:case fe.PERMISSION_DENIED:case fe.FAILED_PRECONDITION:case fe.ABORTED:case fe.OUT_OF_RANGE:case fe.UNIMPLEMENTED:case fe.DATA_LOSS:return!0;default:return it(15467,{code:n})}}function Tx(n){if(n===void 0)return yi("GRPC error has no .code"),fe.UNKNOWN;switch(n){case mn.OK:return fe.OK;case mn.CANCELLED:return fe.CANCELLED;case mn.UNKNOWN:return fe.UNKNOWN;case mn.DEADLINE_EXCEEDED:return fe.DEADLINE_EXCEEDED;case mn.RESOURCE_EXHAUSTED:return fe.RESOURCE_EXHAUSTED;case mn.INTERNAL:return fe.INTERNAL;case mn.UNAVAILABLE:return fe.UNAVAILABLE;case mn.UNAUTHENTICATED:return fe.UNAUTHENTICATED;case mn.INVALID_ARGUMENT:return fe.INVALID_ARGUMENT;case mn.NOT_FOUND:return fe.NOT_FOUND;case mn.ALREADY_EXISTS:return fe.ALREADY_EXISTS;case mn.PERMISSION_DENIED:return fe.PERMISSION_DENIED;case mn.FAILED_PRECONDITION:return fe.FAILED_PRECONDITION;case mn.ABORTED:return fe.ABORTED;case mn.OUT_OF_RANGE:return fe.OUT_OF_RANGE;case mn.UNIMPLEMENTED:return fe.UNIMPLEMENTED;case mn.DATA_LOSS:return fe.DATA_LOSS;default:return it(39323,{code:n})}}(Tt=mn||(mn={}))[Tt.OK=0]="OK",Tt[Tt.CANCELLED=1]="CANCELLED",Tt[Tt.UNKNOWN=2]="UNKNOWN",Tt[Tt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Tt[Tt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Tt[Tt.NOT_FOUND=5]="NOT_FOUND",Tt[Tt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Tt[Tt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Tt[Tt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Tt[Tt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Tt[Tt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Tt[Tt.ABORTED=10]="ABORTED",Tt[Tt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Tt[Tt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Tt[Tt.INTERNAL=13]="INTERNAL",Tt[Tt.UNAVAILABLE=14]="UNAVAILABLE",Tt[Tt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BI=new Xi([4294967295,4294967295],0);function Lv(n){const e=G0().encode(n),t=new M0;return t.update(e),new Uint8Array(t.digest())}function Mv(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),s=e.getUint32(4,!0),a=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new Xi([t,s],0),new Xi([a,l],0)]}class kp{constructor(e,t,s){if(this.bitmap=e,this.padding=t,this.hashCount=s,t<0||t>=8)throw new Vl(`Invalid padding: ${t}`);if(s<0)throw new Vl(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new Vl(`Invalid hash count: ${s}`);if(e.length===0&&t!==0)throw new Vl(`Invalid padding when bitmap length is 0: ${t}`);this.fe=8*e.length-t,this.ge=Xi.fromNumber(this.fe)}pe(e,t,s){let a=e.add(t.multiply(Xi.fromNumber(s)));return a.compare(BI)===1&&(a=new Xi([a.getBits(0),a.getBits(1)],0)),a.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;const t=Lv(e),[s,a]=Mv(t);for(let l=0;l<this.hashCount;l++){const d=this.pe(s,a,l);if(!this.ye(d))return!1}return!0}static create(e,t,s){const a=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),d=new kp(l,a,t);return s.forEach((f=>d.insert(f))),d}insert(e){if(this.fe===0)return;const t=Lv(e),[s,a]=Mv(t);for(let l=0;l<this.hashCount;l++){const d=this.pe(s,a,l);this.we(d)}}we(e){const t=Math.floor(e/8),s=e%8;this.bitmap[t]|=1<<s}}class Vl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ed{constructor(e,t,s,a,l){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=s,this.documentUpdates=a,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,t,s){const a=new Map;return a.set(e,hc.createSynthesizedTargetChangeForCurrentChange(e,t,s)),new Ed(lt.min(),a,new Xt(mt),vi(),xt())}}class hc{constructor(e,t,s,a,l){this.resumeToken=e,this.current=t,this.addedDocuments=s,this.modifiedDocuments=a,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,t,s){return new hc(s,t,xt(),xt(),xt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vu{constructor(e,t,s,a){this.Se=e,this.removedTargetIds=t,this.key=s,this.be=a}}class Sx{constructor(e,t){this.targetId=e,this.De=t}}class bx{constructor(e,t,s=Hn.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=t,this.resumeToken=s,this.cause=a}}class Ov{constructor(){this.ve=0,this.Ce=Fv(),this.Fe=Hn.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=xt(),t=xt(),s=xt();return this.Ce.forEach(((a,l)=>{switch(l){case 0:e=e.add(a);break;case 2:t=t.add(a);break;case 1:s=s.add(a);break;default:it(38017,{changeType:l})}})),new hc(this.Fe,this.Me,e,t,s)}ke(){this.xe=!1,this.Ce=Fv()}qe(e,t){this.xe=!0,this.Ce=this.Ce.insert(e,t)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,Rt(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class WI{constructor(e){this.We=e,this.Ge=new Map,this.ze=vi(),this.je=Tu(),this.Je=Tu(),this.He=new Xt(mt)}Ye(e){for(const t of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(t,e.be):this.Xe(t,e.key,e.be);for(const t of e.removedTargetIds)this.Xe(t,e.key,e.be)}et(e){this.forEachTarget(e,(t=>{const s=this.tt(t);switch(e.state){case 0:this.nt(t)&&s.Be(e.resumeToken);break;case 1:s.Ue(),s.Oe||s.ke(),s.Be(e.resumeToken);break;case 2:s.Ue(),s.Oe||this.removeTarget(t);break;case 3:this.nt(t)&&(s.Ke(),s.Be(e.resumeToken));break;case 4:this.nt(t)&&(this.rt(t),s.Be(e.resumeToken));break;default:it(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ge.forEach(((s,a)=>{this.nt(a)&&t(a)}))}it(e){const t=e.targetId,s=e.De.count,a=this.st(t);if(a){const l=a.target;if(zf(l))if(s===0){const d=new Xe(l.path);this.Xe(t,d,ar.newNoDocument(d,lt.min()))}else Rt(s===1,20013,{expectedCount:s});else{const d=this.ot(t);if(d!==s){const f=this._t(e),m=f?this.ut(f,e,d):1;if(m!==0){this.rt(t);const y=m===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(t,y)}}}}}_t(e){const t=e.De.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:s="",padding:a=0},hashCount:l=0}=t;let d,f;try{d=ra(s).toUint8Array()}catch(m){if(m instanceof Y0)return ea("Decoding the base64 bloom filter in existence filter failed ("+m.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw m}try{f=new kp(d,a,l)}catch(m){return ea(m instanceof Vl?"BloomFilter error: ":"Applying bloom filter failed: ",m),null}return f.fe===0?null:f}ut(e,t,s){return t.De.count===s-this.ht(e,t.targetId)?0:2}ht(e,t){const s=this.We.getRemoteKeysForTarget(t);let a=0;return s.forEach((l=>{const d=this.We.lt(),f=`projects/${d.projectId}/databases/${d.database}/documents/${l.path.canonicalString()}`;e.mightContain(f)||(this.Xe(t,l,null),a++)})),a}Pt(e){const t=new Map;this.Ge.forEach(((l,d)=>{const f=this.st(d);if(f){if(l.current&&zf(f.target)){const m=new Xe(f.target.path);this.Tt(m).has(d)||this.It(d,m)||this.Xe(d,m,ar.newNoDocument(m,e))}l.Ne&&(t.set(d,l.Le()),l.ke())}}));let s=xt();this.Je.forEach(((l,d)=>{let f=!0;d.forEachWhile((m=>{const y=this.st(m);return!y||y.purpose==="TargetPurposeLimboResolution"||(f=!1,!1)})),f&&(s=s.add(l))})),this.ze.forEach(((l,d)=>d.setReadTime(e)));const a=new Ed(e,t,this.He,this.ze,s);return this.ze=vi(),this.je=Tu(),this.Je=Tu(),this.He=new Xt(mt),a}Ze(e,t){if(!this.nt(e))return;const s=this.It(e,t.key)?2:0;this.tt(e).qe(t.key,s),this.ze=this.ze.insert(t.key,t),this.je=this.je.insert(t.key,this.Tt(t.key).add(e)),this.Je=this.Je.insert(t.key,this.dt(t.key).add(e))}Xe(e,t,s){if(!this.nt(e))return;const a=this.tt(e);this.It(e,t)?a.qe(t,1):a.Qe(t),this.Je=this.Je.insert(t,this.dt(t).delete(e)),this.Je=this.Je.insert(t,this.dt(t).add(e)),s&&(this.ze=this.ze.insert(t,s))}removeTarget(e){this.Ge.delete(e)}ot(e){const t=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let t=this.Ge.get(e);return t||(t=new Ov,this.Ge.set(e,t)),t}dt(e){let t=this.Je.get(e);return t||(t=new Cn(mt),this.Je=this.Je.insert(e,t)),t}Tt(e){let t=this.je.get(e);return t||(t=new Cn(mt),this.je=this.je.insert(e,t)),t}nt(e){const t=this.st(e)!==null;return t||ze("WatchChangeAggregator","Detected inactive target",e),t}st(e){const t=this.Ge.get(e);return t&&t.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new Ov),this.We.getRemoteKeysForTarget(e).forEach((t=>{this.Xe(e,t,null)}))}It(e,t){return this.We.getRemoteKeysForTarget(e).has(t)}}function Tu(){return new Xt(Xe.comparator)}function Fv(){return new Xt(Xe.comparator)}const GI={asc:"ASCENDING",desc:"DESCENDING"},qI={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},HI={and:"AND",or:"OR"};class KI{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Bf(n,e){return n.useProto3Json||md(e)?e:{value:e}}function ed(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Cx(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function QI(n,e){return ed(n,e.toTimestamp())}function Qs(n){return Rt(!!n,49232),lt.fromTimestamp((function(t){const s=na(t);return new Wt(s.seconds,s.nanos)})(n))}function Dp(n,e){return Wf(n,e).canonicalString()}function Wf(n,e){const t=(function(a){return new Ot(["projects",a.projectId,"databases",a.database])})(n).child("documents");return e===void 0?t:t.child(e)}function Ix(n){const e=Ot.fromString(n);return Rt(jx(e),10190,{key:e.toString()}),e}function Gf(n,e){return Dp(n.databaseId,e.path)}function pf(n,e){const t=Ix(e);if(t.get(1)!==n.databaseId.projectId)throw new Fe(fe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Fe(fe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Xe(Px(t))}function Nx(n,e){return Dp(n.databaseId,e)}function YI(n){const e=Ix(n);return e.length===4?Ot.emptyPath():Px(e)}function qf(n){return new Ot(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Px(n){return Rt(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function Uv(n,e,t){return{name:Gf(n,e),fields:t.value.mapValue.fields}}function JI(n,e){let t;if("targetChange"in e){e.targetChange;const s=(function(y){return y==="NO_CHANGE"?0:y==="ADD"?1:y==="REMOVE"?2:y==="CURRENT"?3:y==="RESET"?4:it(39313,{state:y})})(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],l=(function(y,x){return y.useProto3Json?(Rt(x===void 0||typeof x=="string",58123),Hn.fromBase64String(x||"")):(Rt(x===void 0||x instanceof Buffer||x instanceof Uint8Array,16193),Hn.fromUint8Array(x||new Uint8Array))})(n,e.targetChange.resumeToken),d=e.targetChange.cause,f=d&&(function(y){const x=y.code===void 0?fe.UNKNOWN:Tx(y.code);return new Fe(x,y.message||"")})(d);t=new bx(s,a,l,f||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const a=pf(n,s.document.name),l=Qs(s.document.updateTime),d=s.document.createTime?Qs(s.document.createTime):lt.min(),f=new jr({mapValue:{fields:s.document.fields}}),m=ar.newFoundDocument(a,l,d,f),y=s.targetIds||[],x=s.removedTargetIds||[];t=new Vu(y,x,m.key,m)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const a=pf(n,s.document),l=s.readTime?Qs(s.readTime):lt.min(),d=ar.newNoDocument(a,l),f=s.removedTargetIds||[];t=new Vu([],f,d.key,d)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const a=pf(n,s.document),l=s.removedTargetIds||[];t=new Vu([],l,a,null)}else{if(!("filter"in e))return it(11601,{At:e});{e.filter;const s=e.filter;s.targetId;const{count:a=0,unchangedNames:l}=s,d=new zI(a,l),f=s.targetId;t=new Sx(f,d)}}return t}function XI(n,e){let t;if(e instanceof dc)t={update:Uv(n,e.key,e.value)};else if(e instanceof Ap)t={delete:Gf(n,e.key)};else if(e instanceof ha)t={update:Uv(n,e.key,e.data),updateMask:oN(e.fieldMask)};else{if(!(e instanceof OI))return it(16599,{Rt:e.type});t={verify:Gf(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((s=>(function(l,d){const f=d.transform;if(f instanceof ec)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(f instanceof tc)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:f.elements}};if(f instanceof nc)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:f.elements}};if(f instanceof Zu)return{fieldPath:d.field.canonicalString(),increment:f.Ee};throw it(20930,{transform:d.transform})})(0,s)))),e.precondition.isNone||(t.currentDocument=(function(a,l){return l.updateTime!==void 0?{updateTime:QI(a,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:it(27497)})(n,e.precondition)),t}function ZI(n,e){return n&&n.length>0?(Rt(e!==void 0,14353),n.map((t=>(function(a,l){let d=a.updateTime?Qs(a.updateTime):Qs(l);return d.isEqual(lt.min())&&(d=Qs(l)),new VI(d,a.transformResults||[])})(t,e)))):[]}function eN(n,e){return{documents:[Nx(n,e.path)]}}function tN(n,e){const t={structuredQuery:{}},s=e.path;let a;e.collectionGroup!==null?(a=s,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=s.popLast(),t.structuredQuery.from=[{collectionId:s.lastSegment()}]),t.parent=Nx(n,a);const l=(function(y){if(y.length!==0)return Ax(As.create(y,"and"))})(e.filters);l&&(t.structuredQuery.where=l);const d=(function(y){if(y.length!==0)return y.map((x=>(function(C){return{field:jo(C.field),direction:sN(C.dir)}})(x)))})(e.orderBy);d&&(t.structuredQuery.orderBy=d);const f=Bf(n,e.limit);return f!==null&&(t.structuredQuery.limit=f),e.startAt&&(t.structuredQuery.startAt=(function(y){return{before:y.inclusive,values:y.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(y){return{before:!y.inclusive,values:y.position}})(e.endAt)),{Vt:t,parent:a}}function nN(n){let e=YI(n.parent);const t=n.structuredQuery,s=t.from?t.from.length:0;let a=null;if(s>0){Rt(s===1,65062);const x=t.from[0];x.allDescendants?a=x.collectionId:e=e.child(x.collectionId)}let l=[];t.where&&(l=(function(E){const C=Rx(E);return C instanceof As&&ax(C)?C.getFilters():[C]})(t.where));let d=[];t.orderBy&&(d=(function(E){return E.map((C=>(function(X){return new Zl(ko(X.field),(function(z){switch(z){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(X.direction))})(C)))})(t.orderBy));let f=null;t.limit&&(f=(function(E){let C;return C=typeof E=="object"?E.value:E,md(C)?null:C})(t.limit));let m=null;t.startAt&&(m=(function(E){const C=!!E.before,U=E.values||[];return new Ju(U,C)})(t.startAt));let y=null;return t.endAt&&(y=(function(E){const C=!E.before,U=E.values||[];return new Ju(U,C)})(t.endAt)),wI(e,a,d,l,f,"F",m,y)}function rN(n,e){const t=(function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return it(28987,{purpose:a})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Rx(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const s=ko(t.unaryFilter.field);return gn.create(s,"==",{doubleValue:NaN});case"IS_NULL":const a=ko(t.unaryFilter.field);return gn.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=ko(t.unaryFilter.field);return gn.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=ko(t.unaryFilter.field);return gn.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return it(61313);default:return it(60726)}})(n):n.fieldFilter!==void 0?(function(t){return gn.create(ko(t.fieldFilter.field),(function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return it(58110);default:return it(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return As.create(t.compositeFilter.filters.map((s=>Rx(s))),(function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return it(1026)}})(t.compositeFilter.op))})(n):it(30097,{filter:n})}function sN(n){return GI[n]}function iN(n){return qI[n]}function aN(n){return HI[n]}function jo(n){return{fieldPath:n.canonicalString()}}function ko(n){return qn.fromServerFormat(n.fieldPath)}function Ax(n){return n instanceof gn?(function(t){if(t.op==="=="){if(Iv(t.value))return{unaryFilter:{field:jo(t.field),op:"IS_NAN"}};if(Cv(t.value))return{unaryFilter:{field:jo(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Iv(t.value))return{unaryFilter:{field:jo(t.field),op:"IS_NOT_NAN"}};if(Cv(t.value))return{unaryFilter:{field:jo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:jo(t.field),op:iN(t.op),value:t.value}}})(n):n instanceof As?(function(t){const s=t.getFilters().map((a=>Ax(a)));return s.length===1?s[0]:{compositeFilter:{op:aN(t.op),filters:s}}})(n):it(54877,{filter:n})}function oN(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function jx(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hi{constructor(e,t,s,a,l=lt.min(),d=lt.min(),f=Hn.EMPTY_BYTE_STRING,m=null){this.target=e,this.targetId=t,this.purpose=s,this.sequenceNumber=a,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=f,this.expectedCount=m}withSequenceNumber(e){return new Hi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Hi(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Hi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Hi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lN{constructor(e){this.gt=e}}function cN(n){const e=nN({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Xu(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uN{constructor(){this.Dn=new dN}addToCollectionParentIndex(e,t){return this.Dn.add(t),ye.resolve()}getCollectionParents(e,t){return ye.resolve(this.Dn.getEntries(t))}addFieldIndex(e,t){return ye.resolve()}deleteFieldIndex(e,t){return ye.resolve()}deleteAllFieldIndexes(e){return ye.resolve()}createTargetIndexes(e,t){return ye.resolve()}getDocumentsMatchingTarget(e,t){return ye.resolve(null)}getIndexType(e,t){return ye.resolve(0)}getFieldIndexes(e,t){return ye.resolve([])}getNextCollectionGroupToUpdate(e){return ye.resolve(null)}getMinOffset(e,t){return ye.resolve(ta.min())}getMinOffsetFromCollectionGroup(e,t){return ye.resolve(ta.min())}updateCollectionGroup(e,t,s){return ye.resolve()}updateIndexEntries(e,t){return ye.resolve()}}class dN{constructor(){this.index={}}add(e){const t=e.lastSegment(),s=e.popLast(),a=this.index[t]||new Cn(Ot.comparator),l=!a.has(s);return this.index[t]=a.add(s),l}has(e){const t=e.lastSegment(),s=e.popLast(),a=this.index[t];return a&&a.has(s)}getEntries(e){return(this.index[e]||new Cn(Ot.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zv={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},kx=41943040;class Ar{static withCacheSize(e){return new Ar(e,Ar.DEFAULT_COLLECTION_PERCENTILE,Ar.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ar.DEFAULT_COLLECTION_PERCENTILE=10,Ar.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ar.DEFAULT=new Ar(kx,Ar.DEFAULT_COLLECTION_PERCENTILE,Ar.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ar.DISABLED=new Ar(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bo{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new Bo(0)}static ur(){return new Bo(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $v="LruGarbageCollector",hN=1048576;function Bv([n,e],[t,s]){const a=mt(n,t);return a===0?mt(e,s):a}class fN{constructor(e){this.Tr=e,this.buffer=new Cn(Bv),this.Ir=0}dr(){return++this.Ir}Er(e){const t=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(t);else{const s=this.buffer.last();Bv(t,s)<0&&(this.buffer=this.buffer.delete(s).add(t))}}get maxValue(){return this.buffer.last()[0]}}class pN{constructor(e,t,s){this.garbageCollector=e,this.asyncQueue=t,this.localStore=s,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){ze($v,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){el(t)?ze($v,"Ignoring IndexedDB error during garbage collection: ",t):await Zo(t)}await this.Rr(3e5)}))}}class mN{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.mr(e).next((s=>Math.floor(t/100*s)))}nthSequenceNumber(e,t){if(t===0)return ye.resolve(pd.ue);const s=new fN(t);return this.Vr.forEachTarget(e,(a=>s.Er(a.sequenceNumber))).next((()=>this.Vr.gr(e,(a=>s.Er(a))))).next((()=>s.maxValue))}removeTargets(e,t,s){return this.Vr.removeTargets(e,t,s)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ze("LruGarbageCollector","Garbage collection skipped; disabled"),ye.resolve(zv)):this.getCacheSize(e).next((s=>s<this.params.cacheSizeCollectionThreshold?(ze("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),zv):this.pr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,t){let s,a,l,d,f,m,y;const x=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((E=>(E>this.params.maximumSequenceNumbersToCollect?(ze("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${E}`),a=this.params.maximumSequenceNumbersToCollect):a=E,d=Date.now(),this.nthSequenceNumber(e,a)))).next((E=>(s=E,f=Date.now(),this.removeTargets(e,s,t)))).next((E=>(l=E,m=Date.now(),this.removeOrphanedDocuments(e,s)))).next((E=>(y=Date.now(),Ro()<=_t.DEBUG&&ze("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-x}ms
	Determined least recently used ${a} in `+(f-d)+`ms
	Removed ${l} targets in `+(m-f)+`ms
	Removed ${E} documents in `+(y-m)+`ms
Total Duration: ${y-x}ms`),ye.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:l,documentsRemoved:E}))))}}function gN(n,e){return new mN(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yN{constructor(){this.changes=new Ha((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ar.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const s=this.changes.get(t);return s!==void 0?ye.resolve(s):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vN{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _N{constructor(e,t,s,a){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=s,this.indexManager=a}getDocument(e,t){let s=null;return this.documentOverlayCache.getOverlay(e,t).next((a=>(s=a,this.remoteDocumentCache.getEntry(e,t)))).next((a=>(s!==null&&Bl(s.mutation,a,Br.empty(),Wt.now()),a)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((s=>this.getLocalViewOfDocuments(e,s,xt()).next((()=>s))))}getLocalViewOfDocuments(e,t,s=xt()){const a=La();return this.populateOverlays(e,a,t).next((()=>this.computeViews(e,t,a,s).next((l=>{let d=Dl();return l.forEach(((f,m)=>{d=d.insert(f,m.overlayedDocument)})),d}))))}getOverlayedDocuments(e,t){const s=La();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,xt())))}populateOverlays(e,t,s){const a=[];return s.forEach((l=>{t.has(l)||a.push(l)})),this.documentOverlayCache.getOverlays(e,a).next((l=>{l.forEach(((d,f)=>{t.set(d,f)}))}))}computeViews(e,t,s,a){let l=vi();const d=$l(),f=(function(){return $l()})();return t.forEach(((m,y)=>{const x=s.get(y.key);a.has(y.key)&&(x===void 0||x.mutation instanceof ha)?l=l.insert(y.key,y):x!==void 0?(d.set(y.key,x.mutation.getFieldMask()),Bl(x.mutation,y,x.mutation.getFieldMask(),Wt.now())):d.set(y.key,Br.empty())})),this.recalculateAndSaveOverlays(e,l).next((m=>(m.forEach(((y,x)=>d.set(y,x))),t.forEach(((y,x)=>{var E;return f.set(y,new vN(x,(E=d.get(y))!==null&&E!==void 0?E:null))})),f)))}recalculateAndSaveOverlays(e,t){const s=$l();let a=new Xt(((d,f)=>d-f)),l=xt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((d=>{for(const f of d)f.keys().forEach((m=>{const y=t.get(m);if(y===null)return;let x=s.get(m)||Br.empty();x=f.applyToLocalView(y,x),s.set(m,x);const E=(a.get(f.batchId)||xt()).add(m);a=a.insert(f.batchId,E)}))})).next((()=>{const d=[],f=a.getReverseIterator();for(;f.hasNext();){const m=f.getNext(),y=m.key,x=m.value,E=mx();x.forEach((C=>{if(!l.has(C)){const U=wx(t.get(C),s.get(C));U!==null&&E.set(C,U),l=l.add(C)}})),d.push(this.documentOverlayCache.saveOverlays(e,y,E))}return ye.waitFor(d)})).next((()=>s))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((s=>this.recalculateAndSaveOverlays(e,s)))}getDocumentsMatchingQuery(e,t,s,a){return(function(d){return Xe.isDocumentKey(d.path)&&d.collectionGroup===null&&d.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):ux(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,s,a):this.getDocumentsMatchingCollectionQuery(e,t,s,a)}getNextDocuments(e,t,s,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,s,a).next((l=>{const d=a-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,s.largestBatchId,a-l.size):ye.resolve(La());let f=Ql,m=l;return d.next((y=>ye.forEach(y,((x,E)=>(f<E.largestBatchId&&(f=E.largestBatchId),l.get(x)?ye.resolve():this.remoteDocumentCache.getEntry(e,x).next((C=>{m=m.insert(x,C)}))))).next((()=>this.populateOverlays(e,y,l))).next((()=>this.computeViews(e,m,y,xt()))).next((x=>({batchId:f,changes:px(x)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Xe(t)).next((s=>{let a=Dl();return s.isFoundDocument()&&(a=a.insert(s.key,s)),a}))}getDocumentsMatchingCollectionGroupQuery(e,t,s,a){const l=t.collectionGroup;let d=Dl();return this.indexManager.getCollectionParents(e,l).next((f=>ye.forEach(f,(m=>{const y=(function(E,C){return new tl(C,null,E.explicitOrderBy.slice(),E.filters.slice(),E.limit,E.limitType,E.startAt,E.endAt)})(t,m.child(l));return this.getDocumentsMatchingCollectionQuery(e,y,s,a).next((x=>{x.forEach(((E,C)=>{d=d.insert(E,C)}))}))})).next((()=>d))))}getDocumentsMatchingCollectionQuery(e,t,s,a){let l;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,s.largestBatchId).next((d=>(l=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,s,l,a)))).next((d=>{l.forEach(((m,y)=>{const x=y.getKey();d.get(x)===null&&(d=d.insert(x,ar.newInvalidDocument(x)))}));let f=Dl();return d.forEach(((m,y)=>{const x=l.get(m);x!==void 0&&Bl(x.mutation,y,Br.empty(),Wt.now()),_d(t,y)&&(f=f.insert(m,y))})),f}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xN{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,t){return ye.resolve(this.Br.get(t))}saveBundleMetadata(e,t){return this.Br.set(t.id,(function(a){return{id:a.id,version:a.version,createTime:Qs(a.createTime)}})(t)),ye.resolve()}getNamedQuery(e,t){return ye.resolve(this.Lr.get(t))}saveNamedQuery(e,t){return this.Lr.set(t.name,(function(a){return{name:a.name,query:cN(a.bundledQuery),readTime:Qs(a.readTime)}})(t)),ye.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wN{constructor(){this.overlays=new Xt(Xe.comparator),this.kr=new Map}getOverlay(e,t){return ye.resolve(this.overlays.get(t))}getOverlays(e,t){const s=La();return ye.forEach(t,(a=>this.getOverlay(e,a).next((l=>{l!==null&&s.set(a,l)})))).next((()=>s))}saveOverlays(e,t,s){return s.forEach(((a,l)=>{this.wt(e,t,l)})),ye.resolve()}removeOverlaysForBatchId(e,t,s){const a=this.kr.get(s);return a!==void 0&&(a.forEach((l=>this.overlays=this.overlays.remove(l))),this.kr.delete(s)),ye.resolve()}getOverlaysForCollection(e,t,s){const a=La(),l=t.length+1,d=new Xe(t.child("")),f=this.overlays.getIteratorFrom(d);for(;f.hasNext();){const m=f.getNext().value,y=m.getKey();if(!t.isPrefixOf(y.path))break;y.path.length===l&&m.largestBatchId>s&&a.set(m.getKey(),m)}return ye.resolve(a)}getOverlaysForCollectionGroup(e,t,s,a){let l=new Xt(((y,x)=>y-x));const d=this.overlays.getIterator();for(;d.hasNext();){const y=d.getNext().value;if(y.getKey().getCollectionGroup()===t&&y.largestBatchId>s){let x=l.get(y.largestBatchId);x===null&&(x=La(),l=l.insert(y.largestBatchId,x)),x.set(y.getKey(),y)}}const f=La(),m=l.getIterator();for(;m.hasNext()&&(m.getNext().value.forEach(((y,x)=>f.set(y,x))),!(f.size()>=a)););return ye.resolve(f)}wt(e,t,s){const a=this.overlays.get(s.key);if(a!==null){const d=this.kr.get(a.largestBatchId).delete(s.key);this.kr.set(a.largestBatchId,d)}this.overlays=this.overlays.insert(s.key,new UI(t,s));let l=this.kr.get(t);l===void 0&&(l=xt(),this.kr.set(t,l)),this.kr.set(t,l.add(s.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EN{constructor(){this.sessionToken=Hn.EMPTY_BYTE_STRING}getSessionToken(e){return ye.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ye.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vp{constructor(){this.qr=new Cn(On.Qr),this.$r=new Cn(On.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,t){const s=new On(e,t);this.qr=this.qr.add(s),this.$r=this.$r.add(s)}Kr(e,t){e.forEach((s=>this.addReference(s,t)))}removeReference(e,t){this.Wr(new On(e,t))}Gr(e,t){e.forEach((s=>this.removeReference(s,t)))}zr(e){const t=new Xe(new Ot([])),s=new On(t,e),a=new On(t,e+1),l=[];return this.$r.forEachInRange([s,a],(d=>{this.Wr(d),l.push(d.key)})),l}jr(){this.qr.forEach((e=>this.Wr(e)))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const t=new Xe(new Ot([])),s=new On(t,e),a=new On(t,e+1);let l=xt();return this.$r.forEachInRange([s,a],(d=>{l=l.add(d.key)})),l}containsKey(e){const t=new On(e,0),s=this.qr.firstAfterOrEqual(t);return s!==null&&e.isEqual(s.key)}}class On{constructor(e,t){this.key=e,this.Hr=t}static Qr(e,t){return Xe.comparator(e.key,t.key)||mt(e.Hr,t.Hr)}static Ur(e,t){return mt(e.Hr,t.Hr)||Xe.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TN{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.er=1,this.Yr=new Cn(On.Qr)}checkEmpty(e){return ye.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,s,a){const l=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new FI(l,t,s,a);this.mutationQueue.push(d);for(const f of a)this.Yr=this.Yr.add(new On(f.key,l)),this.indexManager.addToCollectionParentIndex(e,f.key.path.popLast());return ye.resolve(d)}lookupMutationBatch(e,t){return ye.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const s=t+1,a=this.Xr(s),l=a<0?0:a;return ye.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return ye.resolve(this.mutationQueue.length===0?bp:this.er-1)}getAllMutationBatches(e){return ye.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const s=new On(t,0),a=new On(t,Number.POSITIVE_INFINITY),l=[];return this.Yr.forEachInRange([s,a],(d=>{const f=this.Zr(d.Hr);l.push(f)})),ye.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new Cn(mt);return t.forEach((a=>{const l=new On(a,0),d=new On(a,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([l,d],(f=>{s=s.add(f.Hr)}))})),ye.resolve(this.ei(s))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,a=s.length+1;let l=s;Xe.isDocumentKey(l)||(l=l.child(""));const d=new On(new Xe(l),0);let f=new Cn(mt);return this.Yr.forEachWhile((m=>{const y=m.key.path;return!!s.isPrefixOf(y)&&(y.length===a&&(f=f.add(m.Hr)),!0)}),d),ye.resolve(this.ei(f))}ei(e){const t=[];return e.forEach((s=>{const a=this.Zr(s);a!==null&&t.push(a)})),t}removeMutationBatch(e,t){Rt(this.ti(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let s=this.Yr;return ye.forEach(t.mutations,(a=>{const l=new On(a.key,t.batchId);return s=s.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((()=>{this.Yr=s}))}rr(e){}containsKey(e,t){const s=new On(t,0),a=this.Yr.firstAfterOrEqual(s);return ye.resolve(t.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,ye.resolve()}ti(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SN{constructor(e){this.ni=e,this.docs=(function(){return new Xt(Xe.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const s=t.key,a=this.docs.get(s),l=a?a.size:0,d=this.ni(t);return this.docs=this.docs.insert(s,{document:t.mutableCopy(),size:d}),this.size+=d-l,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const s=this.docs.get(t);return ye.resolve(s?s.document.mutableCopy():ar.newInvalidDocument(t))}getEntries(e,t){let s=vi();return t.forEach((a=>{const l=this.docs.get(a);s=s.insert(a,l?l.document.mutableCopy():ar.newInvalidDocument(a))})),ye.resolve(s)}getDocumentsMatchingQuery(e,t,s,a){let l=vi();const d=t.path,f=new Xe(d.child("__id-9223372036854775808__")),m=this.docs.getIteratorFrom(f);for(;m.hasNext();){const{key:y,value:{document:x}}=m.getNext();if(!d.isPrefixOf(y.path))break;y.path.length>d.length+1||ZC(XC(x),s)<=0||(a.has(x.key)||_d(t,x))&&(l=l.insert(x.key,x.mutableCopy()))}return ye.resolve(l)}getAllFromCollectionGroup(e,t,s,a){it(9500)}ri(e,t){return ye.forEach(this.docs,(s=>t(s)))}newChangeBuffer(e){return new bN(this)}getSize(e){return ye.resolve(this.size)}}class bN extends yN{constructor(e){super(),this.Or=e}applyChanges(e){const t=[];return this.changes.forEach(((s,a)=>{a.isValidDocument()?t.push(this.Or.addEntry(e,a)):this.Or.removeEntry(s)})),ye.waitFor(t)}getFromCache(e,t){return this.Or.getEntry(e,t)}getAllFromCache(e,t){return this.Or.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CN{constructor(e){this.persistence=e,this.ii=new Ha((t=>Np(t)),Pp),this.lastRemoteSnapshotVersion=lt.min(),this.highestTargetId=0,this.si=0,this.oi=new Vp,this.targetCount=0,this._i=Bo.ar()}forEachTarget(e,t){return this.ii.forEach(((s,a)=>t(a))),ye.resolve()}getLastRemoteSnapshotVersion(e){return ye.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ye.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),ye.resolve(this.highestTargetId)}setTargetsMetadata(e,t,s){return s&&(this.lastRemoteSnapshotVersion=s),t>this.si&&(this.si=t),ye.resolve()}hr(e){this.ii.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this._i=new Bo(t),this.highestTargetId=t),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,t){return this.hr(t),this.targetCount+=1,ye.resolve()}updateTargetData(e,t){return this.hr(t),ye.resolve()}removeTargetData(e,t){return this.ii.delete(t.target),this.oi.zr(t.targetId),this.targetCount-=1,ye.resolve()}removeTargets(e,t,s){let a=0;const l=[];return this.ii.forEach(((d,f)=>{f.sequenceNumber<=t&&s.get(f.targetId)===null&&(this.ii.delete(d),l.push(this.removeMatchingKeysForTargetId(e,f.targetId)),a++)})),ye.waitFor(l).next((()=>a))}getTargetCount(e){return ye.resolve(this.targetCount)}getTargetData(e,t){const s=this.ii.get(t)||null;return ye.resolve(s)}addMatchingKeys(e,t,s){return this.oi.Kr(t,s),ye.resolve()}removeMatchingKeys(e,t,s){this.oi.Gr(t,s);const a=this.persistence.referenceDelegate,l=[];return a&&t.forEach((d=>{l.push(a.markPotentiallyOrphaned(e,d))})),ye.waitFor(l)}removeMatchingKeysForTargetId(e,t){return this.oi.zr(t),ye.resolve()}getMatchingKeysForTargetId(e,t){const s=this.oi.Jr(t);return ye.resolve(s)}containsKey(e,t){return ye.resolve(this.oi.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dx{constructor(e,t){this.ai={},this.overlays={},this.ui=new pd(0),this.ci=!1,this.ci=!0,this.li=new EN,this.referenceDelegate=e(this),this.hi=new CN(this),this.indexManager=new uN,this.remoteDocumentCache=(function(a){return new SN(a)})((s=>this.referenceDelegate.Pi(s))),this.serializer=new lN(t),this.Ti=new xN(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new wN,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let s=this.ai[e.toKey()];return s||(s=new TN(t,this.referenceDelegate),this.ai[e.toKey()]=s),s}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,t,s){ze("MemoryPersistence","Starting transaction:",e);const a=new IN(this.ui.next());return this.referenceDelegate.Ii(),s(a).next((l=>this.referenceDelegate.di(a).next((()=>l)))).toPromise().then((l=>(a.raiseOnCommittedEvent(),l)))}Ei(e,t){return ye.or(Object.values(this.ai).map((s=>()=>s.containsKey(e,t))))}}class IN extends tI{constructor(e){super(),this.currentSequenceNumber=e}}class Lp{constructor(e){this.persistence=e,this.Ai=new Vp,this.Ri=null}static Vi(e){return new Lp(e)}get mi(){if(this.Ri)return this.Ri;throw it(60996)}addReference(e,t,s){return this.Ai.addReference(s,t),this.mi.delete(s.toString()),ye.resolve()}removeReference(e,t,s){return this.Ai.removeReference(s,t),this.mi.add(s.toString()),ye.resolve()}markPotentiallyOrphaned(e,t){return this.mi.add(t.toString()),ye.resolve()}removeTarget(e,t){this.Ai.zr(t.targetId).forEach((a=>this.mi.add(a.toString())));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,t.targetId).next((a=>{a.forEach((l=>this.mi.add(l.toString())))})).next((()=>s.removeTargetData(e,t)))}Ii(){this.Ri=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ye.forEach(this.mi,(s=>{const a=Xe.fromPath(s);return this.fi(e,a).next((l=>{l||t.removeEntry(a,lt.min())}))})).next((()=>(this.Ri=null,t.apply(e))))}updateLimboDocument(e,t){return this.fi(e,t).next((s=>{s?this.mi.delete(t.toString()):this.mi.add(t.toString())}))}Pi(e){return 0}fi(e,t){return ye.or([()=>ye.resolve(this.Ai.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class td{constructor(e,t){this.persistence=e,this.gi=new Ha((s=>sI(s.path)),((s,a)=>s.isEqual(a))),this.garbageCollector=gN(this,t)}static Vi(e,t){return new td(e,t)}Ii(){}di(e){return ye.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}mr(e){const t=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next((s=>t.next((a=>s+a))))}yr(e){let t=0;return this.gr(e,(s=>{t++})).next((()=>t))}gr(e,t){return ye.forEach(this.gi,((s,a)=>this.Sr(e,s,a).next((l=>l?ye.resolve():t(a)))))}removeTargets(e,t,s){return this.persistence.getTargetCache().removeTargets(e,t,s)}removeOrphanedDocuments(e,t){let s=0;const a=this.persistence.getRemoteDocumentCache(),l=a.newChangeBuffer();return a.ri(e,(d=>this.Sr(e,d,t).next((f=>{f||(s++,l.removeEntry(d,lt.min()))})))).next((()=>l.apply(e))).next((()=>s))}markPotentiallyOrphaned(e,t){return this.gi.set(t,e.currentSequenceNumber),ye.resolve()}removeTarget(e,t){const s=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,s)}addReference(e,t,s){return this.gi.set(s,e.currentSequenceNumber),ye.resolve()}removeReference(e,t,s){return this.gi.set(s,e.currentSequenceNumber),ye.resolve()}updateLimboDocument(e,t){return this.gi.set(t,e.currentSequenceNumber),ye.resolve()}Pi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=ju(e.data.value)),t}Sr(e,t,s){return ye.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const a=this.gi.get(t);return ye.resolve(a!==void 0&&a>s)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mp{constructor(e,t,s,a){this.targetId=e,this.fromCache=t,this.Is=s,this.ds=a}static Es(e,t){let s=xt(),a=xt();for(const l of t.docChanges)switch(l.type){case 0:s=s.add(l.doc.key);break;case 1:a=a.add(l.doc.key)}return new Mp(e,t.fromCache,s,a)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NN{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PN{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=(function(){return sT()?8:nI(or())>0?6:4})()}initialize(e,t){this.gs=e,this.indexManager=t,this.As=!0}getDocumentsMatchingQuery(e,t,s,a){const l={result:null};return this.ps(e,t).next((d=>{l.result=d})).next((()=>{if(!l.result)return this.ys(e,t,a,s).next((d=>{l.result=d}))})).next((()=>{if(l.result)return;const d=new NN;return this.ws(e,t,d).next((f=>{if(l.result=f,this.Rs)return this.Ss(e,t,d,f.size)}))})).next((()=>l.result))}Ss(e,t,s,a){return s.documentReadCount<this.Vs?(Ro()<=_t.DEBUG&&ze("QueryEngine","SDK will not create cache indexes for query:",Ao(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),ye.resolve()):(Ro()<=_t.DEBUG&&ze("QueryEngine","Query:",Ao(t),"scans",s.documentReadCount,"local documents and returns",a,"documents as results."),s.documentReadCount>this.fs*a?(Ro()<=_t.DEBUG&&ze("QueryEngine","The SDK decides to create cache indexes for query:",Ao(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ks(t))):ye.resolve())}ps(e,t){if(Av(t))return ye.resolve(null);let s=Ks(t);return this.indexManager.getIndexType(e,s).next((a=>a===0?null:(t.limit!==null&&a===1&&(t=Xu(t,null,"F"),s=Ks(t)),this.indexManager.getDocumentsMatchingTarget(e,s).next((l=>{const d=xt(...l);return this.gs.getDocuments(e,d).next((f=>this.indexManager.getMinOffset(e,s).next((m=>{const y=this.bs(t,f);return this.Ds(t,y,d,m.readTime)?this.ps(e,Xu(t,null,"F")):this.vs(e,y,t,m)}))))})))))}ys(e,t,s,a){return Av(t)||a.isEqual(lt.min())?ye.resolve(null):this.gs.getDocuments(e,s).next((l=>{const d=this.bs(t,l);return this.Ds(t,d,s,a)?ye.resolve(null):(Ro()<=_t.DEBUG&&ze("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),Ao(t)),this.vs(e,d,t,JC(a,Ql)).next((f=>f)))}))}bs(e,t){let s=new Cn(hx(e));return t.forEach(((a,l)=>{_d(e,l)&&(s=s.add(l))})),s}Ds(e,t,s,a){if(e.limit===null)return!1;if(s.size!==t.size)return!0;const l=e.limitType==="F"?t.last():t.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(a)>0)}ws(e,t,s){return Ro()<=_t.DEBUG&&ze("QueryEngine","Using full collection scan to execute query:",Ao(t)),this.gs.getDocumentsMatchingQuery(e,t,ta.min(),s)}vs(e,t,s,a){return this.gs.getDocumentsMatchingQuery(e,s,a).next((l=>(t.forEach((d=>{l=l.insert(d.key,d)})),l)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Op="LocalStore",RN=3e8;class AN{constructor(e,t,s,a){this.persistence=e,this.Cs=t,this.serializer=a,this.Fs=new Xt(mt),this.Ms=new Ha((l=>Np(l)),Pp),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(s)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new _N(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Fs)))}}function jN(n,e,t,s){return new AN(n,e,t,s)}async function Vx(n,e){const t=ut(n);return await t.persistence.runTransaction("Handle user change","readonly",(s=>{let a;return t.mutationQueue.getAllMutationBatches(s).next((l=>(a=l,t.Ns(e),t.mutationQueue.getAllMutationBatches(s)))).next((l=>{const d=[],f=[];let m=xt();for(const y of a){d.push(y.batchId);for(const x of y.mutations)m=m.add(x.key)}for(const y of l){f.push(y.batchId);for(const x of y.mutations)m=m.add(x.key)}return t.localDocuments.getDocuments(s,m).next((y=>({Bs:y,removedBatchIds:d,addedBatchIds:f})))}))}))}function kN(n,e){const t=ut(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(s=>{const a=e.batch.keys(),l=t.Os.newChangeBuffer({trackRemovals:!0});return(function(f,m,y,x){const E=y.batch,C=E.keys();let U=ye.resolve();return C.forEach((X=>{U=U.next((()=>x.getEntry(m,X))).next((W=>{const z=y.docVersions.get(X);Rt(z!==null,48541),W.version.compareTo(z)<0&&(E.applyToRemoteDocument(W,y),W.isValidDocument()&&(W.setReadTime(y.commitVersion),x.addEntry(W)))}))})),U.next((()=>f.mutationQueue.removeMutationBatch(m,E)))})(t,s,e,l).next((()=>l.apply(s))).next((()=>t.mutationQueue.performConsistencyCheck(s))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(s,a,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,(function(f){let m=xt();for(let y=0;y<f.mutationResults.length;++y)f.mutationResults[y].transformResults.length>0&&(m=m.add(f.batch.mutations[y].key));return m})(e)))).next((()=>t.localDocuments.getDocuments(s,a)))}))}function Lx(n){const e=ut(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.hi.getLastRemoteSnapshotVersion(t)))}function DN(n,e){const t=ut(n),s=e.snapshotVersion;let a=t.Fs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const d=t.Os.newChangeBuffer({trackRemovals:!0});a=t.Fs;const f=[];e.targetChanges.forEach(((x,E)=>{const C=a.get(E);if(!C)return;f.push(t.hi.removeMatchingKeys(l,x.removedDocuments,E).next((()=>t.hi.addMatchingKeys(l,x.addedDocuments,E))));let U=C.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(E)!==null?U=U.withResumeToken(Hn.EMPTY_BYTE_STRING,lt.min()).withLastLimboFreeSnapshotVersion(lt.min()):x.resumeToken.approximateByteSize()>0&&(U=U.withResumeToken(x.resumeToken,s)),a=a.insert(E,U),(function(W,z,se){return W.resumeToken.approximateByteSize()===0||z.snapshotVersion.toMicroseconds()-W.snapshotVersion.toMicroseconds()>=RN?!0:se.addedDocuments.size+se.modifiedDocuments.size+se.removedDocuments.size>0})(C,U,x)&&f.push(t.hi.updateTargetData(l,U))}));let m=vi(),y=xt();if(e.documentUpdates.forEach((x=>{e.resolvedLimboDocuments.has(x)&&f.push(t.persistence.referenceDelegate.updateLimboDocument(l,x))})),f.push(VN(l,d,e.documentUpdates).next((x=>{m=x.Ls,y=x.ks}))),!s.isEqual(lt.min())){const x=t.hi.getLastRemoteSnapshotVersion(l).next((E=>t.hi.setTargetsMetadata(l,l.currentSequenceNumber,s)));f.push(x)}return ye.waitFor(f).next((()=>d.apply(l))).next((()=>t.localDocuments.getLocalViewOfDocuments(l,m,y))).next((()=>m))})).then((l=>(t.Fs=a,l)))}function VN(n,e,t){let s=xt(),a=xt();return t.forEach((l=>s=s.add(l))),e.getEntries(n,s).next((l=>{let d=vi();return t.forEach(((f,m)=>{const y=l.get(f);m.isFoundDocument()!==y.isFoundDocument()&&(a=a.add(f)),m.isNoDocument()&&m.version.isEqual(lt.min())?(e.removeEntry(f,m.readTime),d=d.insert(f,m)):!y.isValidDocument()||m.version.compareTo(y.version)>0||m.version.compareTo(y.version)===0&&y.hasPendingWrites?(e.addEntry(m),d=d.insert(f,m)):ze(Op,"Ignoring outdated watch update for ",f,". Current version:",y.version," Watch version:",m.version)})),{Ls:d,ks:a}}))}function LN(n,e){const t=ut(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(s=>(e===void 0&&(e=bp),t.mutationQueue.getNextMutationBatchAfterBatchId(s,e))))}function MN(n,e){const t=ut(n);return t.persistence.runTransaction("Allocate target","readwrite",(s=>{let a;return t.hi.getTargetData(s,e).next((l=>l?(a=l,ye.resolve(a)):t.hi.allocateTargetId(s).next((d=>(a=new Hi(e,d,"TargetPurposeListen",s.currentSequenceNumber),t.hi.addTargetData(s,a).next((()=>a)))))))})).then((s=>{const a=t.Fs.get(s.targetId);return(a===null||s.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(t.Fs=t.Fs.insert(s.targetId,s),t.Ms.set(e,s.targetId)),s}))}async function Hf(n,e,t){const s=ut(n),a=s.Fs.get(e),l=t?"readwrite":"readwrite-primary";try{t||await s.persistence.runTransaction("Release target",l,(d=>s.persistence.referenceDelegate.removeTarget(d,a)))}catch(d){if(!el(d))throw d;ze(Op,`Failed to update sequence numbers for target ${e}: ${d}`)}s.Fs=s.Fs.remove(e),s.Ms.delete(a.target)}function Wv(n,e,t){const s=ut(n);let a=lt.min(),l=xt();return s.persistence.runTransaction("Execute query","readwrite",(d=>(function(m,y,x){const E=ut(m),C=E.Ms.get(x);return C!==void 0?ye.resolve(E.Fs.get(C)):E.hi.getTargetData(y,x)})(s,d,Ks(e)).next((f=>{if(f)return a=f.lastLimboFreeSnapshotVersion,s.hi.getMatchingKeysForTargetId(d,f.targetId).next((m=>{l=m}))})).next((()=>s.Cs.getDocumentsMatchingQuery(d,e,t?a:lt.min(),t?l:xt()))).next((f=>(ON(s,TI(e),f),{documents:f,qs:l})))))}function ON(n,e,t){let s=n.xs.get(e)||lt.min();t.forEach(((a,l)=>{l.readTime.compareTo(s)>0&&(s=l.readTime)})),n.xs.set(e,s)}class Gv{constructor(){this.activeTargetIds=PI()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class FN{constructor(){this.Fo=new Gv,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,s){}addLocalQueryTarget(e,t=!0){return t&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,t,s){this.Mo[e]=t}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new Gv,Promise.resolve()}handleUserChange(e,t,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UN{xo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qv="ConnectivityMonitor";class Hv{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){ze(qv,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){ze(qv,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Su=null;function Kf(){return Su===null?Su=(function(){return 268435456+Math.round(2147483648*Math.random())})():Su++,"0x"+Su.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mf="RestConnection",zN={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class $N{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.$o=t+"://"+e.host,this.Uo=`projects/${s}/databases/${a}`,this.Ko=this.databaseId.database===Qu?`project_id=${s}`:`project_id=${s}&database_id=${a}`}Wo(e,t,s,a,l){const d=Kf(),f=this.Go(e,t.toUriEncodedString());ze(mf,`Sending RPC '${e}' ${d}:`,f,s);const m={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(m,a,l);const{host:y}=new URL(f),x=Ko(y);return this.jo(e,f,m,s,x).then((E=>(ze(mf,`Received RPC '${e}' ${d}: `,E),E)),(E=>{throw ea(mf,`RPC '${e}' ${d} failed with error: `,E,"url: ",f,"request:",s),E}))}Jo(e,t,s,a,l,d){return this.Wo(e,t,s,a,l)}zo(e,t,s){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Xo})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((a,l)=>e[l]=a)),s&&s.headers.forEach(((a,l)=>e[l]=a))}Go(e,t){const s=zN[e];return`${this.$o}/v1/${t}:${s}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BN{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sr="WebChannelConnection";class WN extends $N{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,t,s,a,l){const d=Kf();return new Promise(((f,m)=>{const y=new O0;y.setWithCredentials(!0),y.listenOnce(F0.COMPLETE,(()=>{try{switch(y.getLastErrorCode()){case Au.NO_ERROR:const E=y.getResponseJson();ze(sr,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(E)),f(E);break;case Au.TIMEOUT:ze(sr,`RPC '${e}' ${d} timed out`),m(new Fe(fe.DEADLINE_EXCEEDED,"Request time out"));break;case Au.HTTP_ERROR:const C=y.getStatus();if(ze(sr,`RPC '${e}' ${d} failed with status:`,C,"response text:",y.getResponseText()),C>0){let U=y.getResponseJson();Array.isArray(U)&&(U=U[0]);const X=U==null?void 0:U.error;if(X&&X.status&&X.message){const W=(function(se){const we=se.toLowerCase().replace(/_/g,"-");return Object.values(fe).indexOf(we)>=0?we:fe.UNKNOWN})(X.status);m(new Fe(W,X.message))}else m(new Fe(fe.UNKNOWN,"Server responded with status "+y.getStatus()))}else m(new Fe(fe.UNAVAILABLE,"Connection failed."));break;default:it(9055,{c_:e,streamId:d,l_:y.getLastErrorCode(),h_:y.getLastError()})}}finally{ze(sr,`RPC '${e}' ${d} completed.`)}}));const x=JSON.stringify(a);ze(sr,`RPC '${e}' ${d} sending request:`,a),y.send(t,"POST",x,s,15)}))}P_(e,t,s){const a=Kf(),l=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=$0(),f=z0(),m={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},y=this.longPollingOptions.timeoutSeconds;y!==void 0&&(m.longPollingTimeout=Math.round(1e3*y)),this.useFetchStreams&&(m.useFetchStreams=!0),this.zo(m.initMessageHeaders,t,s),m.encodeInitMessageHeaders=!0;const x=l.join("");ze(sr,`Creating RPC '${e}' stream ${a}: ${x}`,m);const E=d.createWebChannel(x,m);this.T_(E);let C=!1,U=!1;const X=new BN({Ho:z=>{U?ze(sr,`Not sending because RPC '${e}' stream ${a} is closed:`,z):(C||(ze(sr,`Opening RPC '${e}' stream ${a} transport.`),E.open(),C=!0),ze(sr,`RPC '${e}' stream ${a} sending:`,z),E.send(z))},Yo:()=>E.close()}),W=(z,se,we)=>{z.listen(se,(_e=>{try{we(_e)}catch(ve){setTimeout((()=>{throw ve}),0)}}))};return W(E,kl.EventType.OPEN,(()=>{U||(ze(sr,`RPC '${e}' stream ${a} transport opened.`),X.s_())})),W(E,kl.EventType.CLOSE,(()=>{U||(U=!0,ze(sr,`RPC '${e}' stream ${a} transport closed`),X.__(),this.I_(E))})),W(E,kl.EventType.ERROR,(z=>{U||(U=!0,ea(sr,`RPC '${e}' stream ${a} transport errored. Name:`,z.name,"Message:",z.message),X.__(new Fe(fe.UNAVAILABLE,"The operation could not be completed")))})),W(E,kl.EventType.MESSAGE,(z=>{var se;if(!U){const we=z.data[0];Rt(!!we,16349);const _e=we,ve=(_e==null?void 0:_e.error)||((se=_e[0])===null||se===void 0?void 0:se.error);if(ve){ze(sr,`RPC '${e}' stream ${a} received error:`,ve);const L=ve.status;let ie=(function(A){const O=mn[A];if(O!==void 0)return Tx(O)})(L),I=ve.message;ie===void 0&&(ie=fe.INTERNAL,I="Unknown error status: "+L+" with message "+ve.message),U=!0,X.__(new Fe(ie,I)),E.close()}else ze(sr,`RPC '${e}' stream ${a} received:`,we),X.a_(we)}})),W(f,U0.STAT_EVENT,(z=>{z.stat===Lf.PROXY?ze(sr,`RPC '${e}' stream ${a} detected buffering proxy`):z.stat===Lf.NOPROXY&&ze(sr,`RPC '${e}' stream ${a} detected no buffering proxy`)})),setTimeout((()=>{X.o_()}),0),X}terminate(){this.u_.forEach((e=>e.close())),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter((t=>t===e))}}function gf(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Td(n){return new KI(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mx{constructor(e,t,s=1e3,a=1.5,l=6e4){this.Fi=e,this.timerId=t,this.d_=s,this.E_=a,this.A_=l,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const t=Math.floor(this.R_+this.p_()),s=Math.max(0,Date.now()-this.m_),a=Math.max(0,t-s);a>0&&ze("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.R_} ms, delay with jitter: ${t} ms, last attempt: ${s} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,a,(()=>(this.m_=Date.now(),e()))),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kv="PersistentStream";class Ox{constructor(e,t,s,a,l,d,f,m){this.Fi=e,this.w_=s,this.S_=a,this.connection=l,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=f,this.listener=m,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new Mx(e,t)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,(()=>this.L_())))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():t&&t.code===fe.RESOURCE_EXHAUSTED?(yi(t.toString()),yi("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):t&&t.code===fe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(t)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),t=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([s,a])=>{this.b_===t&&this.W_(s,a)}),(s=>{e((()=>{const a=new Fe(fe.UNKNOWN,"Fetching auth token failed: "+s.message);return this.G_(a)}))}))}W_(e,t){const s=this.K_(this.b_);this.stream=this.z_(e,t),this.stream.Zo((()=>{s((()=>this.listener.Zo()))})),this.stream.e_((()=>{s((()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,(()=>(this.x_()&&(this.state=3),Promise.resolve()))),this.listener.e_())))})),this.stream.n_((a=>{s((()=>this.G_(a)))})),this.stream.onMessage((a=>{s((()=>++this.C_==1?this.j_(a):this.onNext(a)))}))}O_(){this.state=5,this.F_.g_((async()=>{this.state=0,this.start()}))}G_(e){return ze(Kv,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return t=>{this.Fi.enqueueAndForget((()=>this.b_===e?t():(ze(Kv,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class GN extends Ox{constructor(e,t,s,a,l,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,s,a,d),this.serializer=l}z_(e,t){return this.connection.P_("Listen",e,t)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const t=JI(this.serializer,e),s=(function(l){if(!("targetChange"in l))return lt.min();const d=l.targetChange;return d.targetIds&&d.targetIds.length?lt.min():d.readTime?Qs(d.readTime):lt.min()})(e);return this.listener.J_(t,s)}H_(e){const t={};t.database=qf(this.serializer),t.addTarget=(function(l,d){let f;const m=d.target;if(f=zf(m)?{documents:eN(l,m)}:{query:tN(l,m).Vt},f.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){f.resumeToken=Cx(l,d.resumeToken);const y=Bf(l,d.expectedCount);y!==null&&(f.expectedCount=y)}else if(d.snapshotVersion.compareTo(lt.min())>0){f.readTime=ed(l,d.snapshotVersion.toTimestamp());const y=Bf(l,d.expectedCount);y!==null&&(f.expectedCount=y)}return f})(this.serializer,e);const s=rN(this.serializer,e);s&&(t.labels=s),this.k_(t)}Y_(e){const t={};t.database=qf(this.serializer),t.removeTarget=e,this.k_(t)}}class qN extends Ox{constructor(e,t,s,a,l,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,s,a,d),this.serializer=l}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,t){return this.connection.P_("Write",e,t)}j_(e){return Rt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Rt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){Rt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();const t=ZI(e.writeResults,e.commitTime),s=Qs(e.commitTime);return this.listener.ta(s,t)}na(){const e={};e.database=qf(this.serializer),this.k_(e)}X_(e){const t={streamToken:this.lastStreamToken,writes:e.map((s=>XI(this.serializer,s)))};this.k_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HN{}class KN extends HN{constructor(e,t,s,a){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=s,this.serializer=a,this.ra=!1}ia(){if(this.ra)throw new Fe(fe.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,s,a){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,d])=>this.connection.Wo(e,Wf(t,s),a,l,d))).catch((l=>{throw l.name==="FirebaseError"?(l.code===fe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new Fe(fe.UNKNOWN,l.toString())}))}Jo(e,t,s,a,l){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([d,f])=>this.connection.Jo(e,Wf(t,s),a,d,f,l))).catch((d=>{throw d.name==="FirebaseError"?(d.code===fe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new Fe(fe.UNKNOWN,d.toString())}))}terminate(){this.ra=!0,this.connection.terminate()}}class QN{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve()))))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(yi(t),this._a=!1):ze("OnlineStateTracker",t)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qa="RemoteStore";class YN{constructor(e,t,s,a,l){this.localStore=e,this.datastore=t,this.asyncQueue=s,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=l,this.Ea.xo((d=>{s.enqueueAndForget((async()=>{Ka(this)&&(ze(qa,"Restarting streams for network reachability change."),await(async function(m){const y=ut(m);y.Ia.add(4),await fc(y),y.Aa.set("Unknown"),y.Ia.delete(4),await Sd(y)})(this))}))})),this.Aa=new QN(s,a)}}async function Sd(n){if(Ka(n))for(const e of n.da)await e(!0)}async function fc(n){for(const e of n.da)await e(!1)}function Fx(n,e){const t=ut(n);t.Ta.has(e.targetId)||(t.Ta.set(e.targetId,e),$p(t)?zp(t):nl(t).x_()&&Up(t,e))}function Fp(n,e){const t=ut(n),s=nl(t);t.Ta.delete(e),s.x_()&&Ux(t,e),t.Ta.size===0&&(s.x_()?s.B_():Ka(t)&&t.Aa.set("Unknown"))}function Up(n,e){if(n.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(lt.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}nl(n).H_(e)}function Ux(n,e){n.Ra.$e(e),nl(n).Y_(e)}function zp(n){n.Ra=new WI({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>n.Ta.get(e)||null,lt:()=>n.datastore.serializer.databaseId}),nl(n).start(),n.Aa.aa()}function $p(n){return Ka(n)&&!nl(n).M_()&&n.Ta.size>0}function Ka(n){return ut(n).Ia.size===0}function zx(n){n.Ra=void 0}async function JN(n){n.Aa.set("Online")}async function XN(n){n.Ta.forEach(((e,t)=>{Up(n,e)}))}async function ZN(n,e){zx(n),$p(n)?(n.Aa.la(e),zp(n)):n.Aa.set("Unknown")}async function eP(n,e,t){if(n.Aa.set("Online"),e instanceof bx&&e.state===2&&e.cause)try{await(async function(a,l){const d=l.cause;for(const f of l.targetIds)a.Ta.has(f)&&(await a.remoteSyncer.rejectListen(f,d),a.Ta.delete(f),a.Ra.removeTarget(f))})(n,e)}catch(s){ze(qa,"Failed to remove targets %s: %s ",e.targetIds.join(","),s),await nd(n,s)}else if(e instanceof Vu?n.Ra.Ye(e):e instanceof Sx?n.Ra.it(e):n.Ra.et(e),!t.isEqual(lt.min()))try{const s=await Lx(n.localStore);t.compareTo(s)>=0&&await(function(l,d){const f=l.Ra.Pt(d);return f.targetChanges.forEach(((m,y)=>{if(m.resumeToken.approximateByteSize()>0){const x=l.Ta.get(y);x&&l.Ta.set(y,x.withResumeToken(m.resumeToken,d))}})),f.targetMismatches.forEach(((m,y)=>{const x=l.Ta.get(m);if(!x)return;l.Ta.set(m,x.withResumeToken(Hn.EMPTY_BYTE_STRING,x.snapshotVersion)),Ux(l,m);const E=new Hi(x.target,m,y,x.sequenceNumber);Up(l,E)})),l.remoteSyncer.applyRemoteEvent(f)})(n,t)}catch(s){ze(qa,"Failed to raise snapshot:",s),await nd(n,s)}}async function nd(n,e,t){if(!el(e))throw e;n.Ia.add(1),await fc(n),n.Aa.set("Offline"),t||(t=()=>Lx(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{ze(qa,"Retrying IndexedDB access"),await t(),n.Ia.delete(1),await Sd(n)}))}function $x(n,e){return e().catch((t=>nd(n,t,e)))}async function bd(n){const e=ut(n),t=ia(e);let s=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:bp;for(;tP(e);)try{const a=await LN(e.localStore,s);if(a===null){e.Pa.length===0&&t.B_();break}s=a.batchId,nP(e,a)}catch(a){await nd(e,a)}Bx(e)&&Wx(e)}function tP(n){return Ka(n)&&n.Pa.length<10}function nP(n,e){n.Pa.push(e);const t=ia(n);t.x_()&&t.Z_&&t.X_(e.mutations)}function Bx(n){return Ka(n)&&!ia(n).M_()&&n.Pa.length>0}function Wx(n){ia(n).start()}async function rP(n){ia(n).na()}async function sP(n){const e=ia(n);for(const t of n.Pa)e.X_(t.mutations)}async function iP(n,e,t){const s=n.Pa.shift(),a=jp.from(s,e,t);await $x(n,(()=>n.remoteSyncer.applySuccessfulWrite(a))),await bd(n)}async function aP(n,e){e&&ia(n).Z_&&await(async function(s,a){if((function(d){return $I(d)&&d!==fe.ABORTED})(a.code)){const l=s.Pa.shift();ia(s).N_(),await $x(s,(()=>s.remoteSyncer.rejectFailedWrite(l.batchId,a))),await bd(s)}})(n,e),Bx(n)&&Wx(n)}async function Qv(n,e){const t=ut(n);t.asyncQueue.verifyOperationInProgress(),ze(qa,"RemoteStore received new credentials");const s=Ka(t);t.Ia.add(3),await fc(t),s&&t.Aa.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ia.delete(3),await Sd(t)}async function oP(n,e){const t=ut(n);e?(t.Ia.delete(2),await Sd(t)):e||(t.Ia.add(2),await fc(t),t.Aa.set("Unknown"))}function nl(n){return n.Va||(n.Va=(function(t,s,a){const l=ut(t);return l.ia(),new GN(s,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(n.datastore,n.asyncQueue,{Zo:JN.bind(null,n),e_:XN.bind(null,n),n_:ZN.bind(null,n),J_:eP.bind(null,n)}),n.da.push((async e=>{e?(n.Va.N_(),$p(n)?zp(n):n.Aa.set("Unknown")):(await n.Va.stop(),zx(n))}))),n.Va}function ia(n){return n.ma||(n.ma=(function(t,s,a){const l=ut(t);return l.ia(),new qN(s,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),e_:rP.bind(null,n),n_:aP.bind(null,n),ea:sP.bind(null,n),ta:iP.bind(null,n)}),n.da.push((async e=>{e?(n.ma.N_(),await bd(n)):(await n.ma.stop(),n.Pa.length>0&&(ze(qa,`Stopping write stream with ${n.Pa.length} pending writes`),n.Pa=[]))}))),n.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bp{constructor(e,t,s,a,l){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=s,this.op=a,this.removalCallback=l,this.deferred=new fi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((d=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,s,a,l){const d=Date.now()+s,f=new Bp(e,t,d,a,l);return f.start(s),f}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Fe(fe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Wp(n,e){if(yi("AsyncQueue",`${e}: ${n}`),el(n))return new Fe(fe.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mo{static emptySet(e){return new Mo(e.comparator)}constructor(e){this.comparator=e?(t,s)=>e(t,s)||Xe.comparator(t.key,s.key):(t,s)=>Xe.comparator(t.key,s.key),this.keyedMap=Dl(),this.sortedSet=new Xt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,s)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Mo)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=s.getNext().key;if(!a.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const s=new Mo;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=t,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yv{constructor(){this.fa=new Xt(Xe.comparator)}track(e){const t=e.doc.key,s=this.fa.get(t);s?e.type!==0&&s.type===3?this.fa=this.fa.insert(t,e):e.type===3&&s.type!==1?this.fa=this.fa.insert(t,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.fa=this.fa.insert(t,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.fa=this.fa.remove(t):e.type===1&&s.type===2?this.fa=this.fa.insert(t,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):it(63341,{At:e,ga:s}):this.fa=this.fa.insert(t,e)}pa(){const e=[];return this.fa.inorderTraversal(((t,s)=>{e.push(s)})),e}}class Wo{constructor(e,t,s,a,l,d,f,m,y){this.query=e,this.docs=t,this.oldDocs=s,this.docChanges=a,this.mutatedKeys=l,this.fromCache=d,this.syncStateChanged=f,this.excludesMetadataChanges=m,this.hasCachedResults=y}static fromInitialDocuments(e,t,s,a,l){const d=[];return t.forEach((f=>{d.push({type:0,doc:f})})),new Wo(e,t,Mo.emptySet(t),d,s,a,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&vd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,s=e.docChanges;if(t.length!==s.length)return!1;for(let a=0;a<t.length;a++)if(t[a].type!==s[a].type||!t[a].doc.isEqual(s[a].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lP{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some((e=>e.ba()))}}class cP{constructor(){this.queries=Jv(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(t,s){const a=ut(t),l=a.queries;a.queries=Jv(),l.forEach(((d,f)=>{for(const m of f.wa)m.onError(s)}))})(this,new Fe(fe.ABORTED,"Firestore shutting down"))}}function Jv(){return new Ha((n=>dx(n)),vd)}async function Gp(n,e){const t=ut(n);let s=3;const a=e.query;let l=t.queries.get(a);l?!l.Sa()&&e.ba()&&(s=2):(l=new lP,s=e.ba()?0:1);try{switch(s){case 0:l.ya=await t.onListen(a,!0);break;case 1:l.ya=await t.onListen(a,!1);break;case 2:await t.onFirstRemoteStoreListen(a)}}catch(d){const f=Wp(d,`Initialization of query '${Ao(e.query)}' failed`);return void e.onError(f)}t.queries.set(a,l),l.wa.push(e),e.va(t.onlineState),l.ya&&e.Ca(l.ya)&&Hp(t)}async function qp(n,e){const t=ut(n),s=e.query;let a=3;const l=t.queries.get(s);if(l){const d=l.wa.indexOf(e);d>=0&&(l.wa.splice(d,1),l.wa.length===0?a=e.ba()?0:1:!l.Sa()&&e.ba()&&(a=2))}switch(a){case 0:return t.queries.delete(s),t.onUnlisten(s,!0);case 1:return t.queries.delete(s),t.onUnlisten(s,!1);case 2:return t.onLastRemoteStoreUnlisten(s);default:return}}function uP(n,e){const t=ut(n);let s=!1;for(const a of e){const l=a.query,d=t.queries.get(l);if(d){for(const f of d.wa)f.Ca(a)&&(s=!0);d.ya=a}}s&&Hp(t)}function dP(n,e,t){const s=ut(n),a=s.queries.get(e);if(a)for(const l of a.wa)l.onError(t);s.queries.delete(e)}function Hp(n){n.Da.forEach((e=>{e.next()}))}var Qf,Xv;(Xv=Qf||(Qf={})).Fa="default",Xv.Cache="cache";class Kp{constructor(e,t,s){this.query=e,this.Ma=t,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=s||{}}Ca(e){if(!this.options.includeMetadataChanges){const s=[];for(const a of e.docChanges)a.type!==3&&s.push(a);e=new Wo(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),t=!0):this.Ba(e,this.onlineState)&&(this.La(e),t=!0),this.Oa=e,t}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let t=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),t=!0),t}Ba(e,t){if(!e.fromCache||!this.ba())return!0;const s=t!=="Offline";return(!this.options.ka||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Na(e){if(e.docChanges.length>0)return!0;const t=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}La(e){e=Wo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==Qf.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gx{constructor(e){this.key=e}}class qx{constructor(e){this.key=e}}class hP{constructor(e,t){this.query=e,this.Ha=t,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=xt(),this.mutatedKeys=xt(),this.Xa=hx(e),this.eu=new Mo(this.Xa)}get tu(){return this.Ha}nu(e,t){const s=t?t.ru:new Yv,a=t?t.eu:this.eu;let l=t?t.mutatedKeys:this.mutatedKeys,d=a,f=!1;const m=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,y=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal(((x,E)=>{const C=a.get(x),U=_d(this.query,E)?E:null,X=!!C&&this.mutatedKeys.has(C.key),W=!!U&&(U.hasLocalMutations||this.mutatedKeys.has(U.key)&&U.hasCommittedMutations);let z=!1;C&&U?C.data.isEqual(U.data)?X!==W&&(s.track({type:3,doc:U}),z=!0):this.iu(C,U)||(s.track({type:2,doc:U}),z=!0,(m&&this.Xa(U,m)>0||y&&this.Xa(U,y)<0)&&(f=!0)):!C&&U?(s.track({type:0,doc:U}),z=!0):C&&!U&&(s.track({type:1,doc:C}),z=!0,(m||y)&&(f=!0)),z&&(U?(d=d.add(U),l=W?l.add(x):l.delete(x)):(d=d.delete(x),l=l.delete(x)))})),this.query.limit!==null)for(;d.size>this.query.limit;){const x=this.query.limitType==="F"?d.last():d.first();d=d.delete(x.key),l=l.delete(x.key),s.track({type:1,doc:x})}return{eu:d,ru:s,Ds:f,mutatedKeys:l}}iu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,s,a){const l=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const d=e.ru.pa();d.sort(((x,E)=>(function(U,X){const W=z=>{switch(z){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return it(20277,{At:z})}};return W(U)-W(X)})(x.type,E.type)||this.Xa(x.doc,E.doc))),this.su(s),a=a!=null&&a;const f=t&&!a?this.ou():[],m=this.Za.size===0&&this.current&&!a?1:0,y=m!==this.Ya;return this.Ya=m,d.length!==0||y?{snapshot:new Wo(this.query,e.eu,l,d,e.mutatedKeys,m===0,y,!1,!!s&&s.resumeToken.approximateByteSize()>0),_u:f}:{_u:f}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new Yv,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach((t=>this.Ha=this.Ha.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ha=this.Ha.delete(t))),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=xt(),this.eu.forEach((s=>{this.au(s.key)&&(this.Za=this.Za.add(s.key))}));const t=[];return e.forEach((s=>{this.Za.has(s)||t.push(new qx(s))})),this.Za.forEach((s=>{e.has(s)||t.push(new Gx(s))})),t}uu(e){this.Ha=e.qs,this.Za=xt();const t=this.nu(e.documents);return this.applyChanges(t,!0)}cu(){return Wo.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const Qp="SyncEngine";class fP{constructor(e,t,s){this.query=e,this.targetId=t,this.view=s}}class pP{constructor(e){this.key=e,this.lu=!1}}class mP{constructor(e,t,s,a,l,d){this.localStore=e,this.remoteStore=t,this.eventManager=s,this.sharedClientState=a,this.currentUser=l,this.maxConcurrentLimboResolutions=d,this.hu={},this.Pu=new Ha((f=>dx(f)),vd),this.Tu=new Map,this.Iu=new Set,this.du=new Xt(Xe.comparator),this.Eu=new Map,this.Au=new Vp,this.Ru={},this.Vu=new Map,this.mu=Bo.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function gP(n,e,t=!0){const s=Xx(n);let a;const l=s.Pu.get(e);return l?(s.sharedClientState.addLocalQueryTarget(l.targetId),a=l.view.cu()):a=await Hx(s,e,t,!0),a}async function yP(n,e){const t=Xx(n);await Hx(t,e,!0,!1)}async function Hx(n,e,t,s){const a=await MN(n.localStore,Ks(e)),l=a.targetId,d=n.sharedClientState.addLocalQueryTarget(l,t);let f;return s&&(f=await vP(n,e,l,d==="current",a.resumeToken)),n.isPrimaryClient&&t&&Fx(n.remoteStore,a),f}async function vP(n,e,t,s,a){n.gu=(E,C,U)=>(async function(W,z,se,we){let _e=z.view.nu(se);_e.Ds&&(_e=await Wv(W.localStore,z.query,!1).then((({documents:I})=>z.view.nu(I,_e))));const ve=we&&we.targetChanges.get(z.targetId),L=we&&we.targetMismatches.get(z.targetId)!=null,ie=z.view.applyChanges(_e,W.isPrimaryClient,ve,L);return e_(W,z.targetId,ie._u),ie.snapshot})(n,E,C,U);const l=await Wv(n.localStore,e,!0),d=new hP(e,l.qs),f=d.nu(l.documents),m=hc.createSynthesizedTargetChangeForCurrentChange(t,s&&n.onlineState!=="Offline",a),y=d.applyChanges(f,n.isPrimaryClient,m);e_(n,t,y._u);const x=new fP(e,t,d);return n.Pu.set(e,x),n.Tu.has(t)?n.Tu.get(t).push(e):n.Tu.set(t,[e]),y.snapshot}async function _P(n,e,t){const s=ut(n),a=s.Pu.get(e),l=s.Tu.get(a.targetId);if(l.length>1)return s.Tu.set(a.targetId,l.filter((d=>!vd(d,e)))),void s.Pu.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(a.targetId),s.sharedClientState.isActiveQueryTarget(a.targetId)||await Hf(s.localStore,a.targetId,!1).then((()=>{s.sharedClientState.clearQueryState(a.targetId),t&&Fp(s.remoteStore,a.targetId),Yf(s,a.targetId)})).catch(Zo)):(Yf(s,a.targetId),await Hf(s.localStore,a.targetId,!0))}async function xP(n,e){const t=ut(n),s=t.Pu.get(e),a=t.Tu.get(s.targetId);t.isPrimaryClient&&a.length===1&&(t.sharedClientState.removeLocalQueryTarget(s.targetId),Fp(t.remoteStore,s.targetId))}async function wP(n,e,t){const s=NP(n);try{const a=await(function(d,f){const m=ut(d),y=Wt.now(),x=f.reduce(((U,X)=>U.add(X.key)),xt());let E,C;return m.persistence.runTransaction("Locally write mutations","readwrite",(U=>{let X=vi(),W=xt();return m.Os.getEntries(U,x).next((z=>{X=z,X.forEach(((se,we)=>{we.isValidDocument()||(W=W.add(se))}))})).next((()=>m.localDocuments.getOverlayedDocuments(U,X))).next((z=>{E=z;const se=[];for(const we of f){const _e=MI(we,E.get(we.key).overlayedDocument);_e!=null&&se.push(new ha(we.key,_e,rx(_e.value.mapValue),cs.exists(!0)))}return m.mutationQueue.addMutationBatch(U,y,se,f)})).next((z=>{C=z;const se=z.applyToLocalDocumentSet(E,W);return m.documentOverlayCache.saveOverlays(U,z.batchId,se)}))})).then((()=>({batchId:C.batchId,changes:px(E)})))})(s.localStore,e);s.sharedClientState.addPendingMutation(a.batchId),(function(d,f,m){let y=d.Ru[d.currentUser.toKey()];y||(y=new Xt(mt)),y=y.insert(f,m),d.Ru[d.currentUser.toKey()]=y})(s,a.batchId,t),await pc(s,a.changes),await bd(s.remoteStore)}catch(a){const l=Wp(a,"Failed to persist write");t.reject(l)}}async function Kx(n,e){const t=ut(n);try{const s=await DN(t.localStore,e);e.targetChanges.forEach(((a,l)=>{const d=t.Eu.get(l);d&&(Rt(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?d.lu=!0:a.modifiedDocuments.size>0?Rt(d.lu,14607):a.removedDocuments.size>0&&(Rt(d.lu,42227),d.lu=!1))})),await pc(t,s,e)}catch(s){await Zo(s)}}function Zv(n,e,t){const s=ut(n);if(s.isPrimaryClient&&t===0||!s.isPrimaryClient&&t===1){const a=[];s.Pu.forEach(((l,d)=>{const f=d.view.va(e);f.snapshot&&a.push(f.snapshot)})),(function(d,f){const m=ut(d);m.onlineState=f;let y=!1;m.queries.forEach(((x,E)=>{for(const C of E.wa)C.va(f)&&(y=!0)})),y&&Hp(m)})(s.eventManager,e),a.length&&s.hu.J_(a),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function EP(n,e,t){const s=ut(n);s.sharedClientState.updateQueryState(e,"rejected",t);const a=s.Eu.get(e),l=a&&a.key;if(l){let d=new Xt(Xe.comparator);d=d.insert(l,ar.newNoDocument(l,lt.min()));const f=xt().add(l),m=new Ed(lt.min(),new Map,new Xt(mt),d,f);await Kx(s,m),s.du=s.du.remove(l),s.Eu.delete(e),Yp(s)}else await Hf(s.localStore,e,!1).then((()=>Yf(s,e,t))).catch(Zo)}async function TP(n,e){const t=ut(n),s=e.batch.batchId;try{const a=await kN(t.localStore,e);Yx(t,s,null),Qx(t,s),t.sharedClientState.updateMutationState(s,"acknowledged"),await pc(t,a)}catch(a){await Zo(a)}}async function SP(n,e,t){const s=ut(n);try{const a=await(function(d,f){const m=ut(d);return m.persistence.runTransaction("Reject batch","readwrite-primary",(y=>{let x;return m.mutationQueue.lookupMutationBatch(y,f).next((E=>(Rt(E!==null,37113),x=E.keys(),m.mutationQueue.removeMutationBatch(y,E)))).next((()=>m.mutationQueue.performConsistencyCheck(y))).next((()=>m.documentOverlayCache.removeOverlaysForBatchId(y,x,f))).next((()=>m.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(y,x))).next((()=>m.localDocuments.getDocuments(y,x)))}))})(s.localStore,e);Yx(s,e,t),Qx(s,e),s.sharedClientState.updateMutationState(e,"rejected",t),await pc(s,a)}catch(a){await Zo(a)}}function Qx(n,e){(n.Vu.get(e)||[]).forEach((t=>{t.resolve()})),n.Vu.delete(e)}function Yx(n,e,t){const s=ut(n);let a=s.Ru[s.currentUser.toKey()];if(a){const l=a.get(e);l&&(t?l.reject(t):l.resolve(),a=a.remove(e)),s.Ru[s.currentUser.toKey()]=a}}function Yf(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const s of n.Tu.get(e))n.Pu.delete(s),t&&n.hu.pu(s,t);n.Tu.delete(e),n.isPrimaryClient&&n.Au.zr(e).forEach((s=>{n.Au.containsKey(s)||Jx(n,s)}))}function Jx(n,e){n.Iu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(Fp(n.remoteStore,t),n.du=n.du.remove(e),n.Eu.delete(t),Yp(n))}function e_(n,e,t){for(const s of t)s instanceof Gx?(n.Au.addReference(s.key,e),bP(n,s)):s instanceof qx?(ze(Qp,"Document no longer in limbo: "+s.key),n.Au.removeReference(s.key,e),n.Au.containsKey(s.key)||Jx(n,s.key)):it(19791,{yu:s})}function bP(n,e){const t=e.key,s=t.path.canonicalString();n.du.get(t)||n.Iu.has(s)||(ze(Qp,"New document in limbo: "+t),n.Iu.add(s),Yp(n))}function Yp(n){for(;n.Iu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Iu.values().next().value;n.Iu.delete(e);const t=new Xe(Ot.fromString(e)),s=n.mu.next();n.Eu.set(s,new pP(t)),n.du=n.du.insert(t,s),Fx(n.remoteStore,new Hi(Ks(yd(t.path)),s,"TargetPurposeLimboResolution",pd.ue))}}async function pc(n,e,t){const s=ut(n),a=[],l=[],d=[];s.Pu.isEmpty()||(s.Pu.forEach(((f,m)=>{d.push(s.gu(m,e,t).then((y=>{var x;if((y||t)&&s.isPrimaryClient){const E=y?!y.fromCache:(x=t==null?void 0:t.targetChanges.get(m.targetId))===null||x===void 0?void 0:x.current;s.sharedClientState.updateQueryState(m.targetId,E?"current":"not-current")}if(y){a.push(y);const E=Mp.Es(m.targetId,y);l.push(E)}})))})),await Promise.all(d),s.hu.J_(a),await(async function(m,y){const x=ut(m);try{await x.persistence.runTransaction("notifyLocalViewChanges","readwrite",(E=>ye.forEach(y,(C=>ye.forEach(C.Is,(U=>x.persistence.referenceDelegate.addReference(E,C.targetId,U))).next((()=>ye.forEach(C.ds,(U=>x.persistence.referenceDelegate.removeReference(E,C.targetId,U)))))))))}catch(E){if(!el(E))throw E;ze(Op,"Failed to update sequence numbers: "+E)}for(const E of y){const C=E.targetId;if(!E.fromCache){const U=x.Fs.get(C),X=U.snapshotVersion,W=U.withLastLimboFreeSnapshotVersion(X);x.Fs=x.Fs.insert(C,W)}}})(s.localStore,l))}async function CP(n,e){const t=ut(n);if(!t.currentUser.isEqual(e)){ze(Qp,"User change. New user:",e.toKey());const s=await Vx(t.localStore,e);t.currentUser=e,(function(l,d){l.Vu.forEach((f=>{f.forEach((m=>{m.reject(new Fe(fe.CANCELLED,d))}))})),l.Vu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await pc(t,s.Bs)}}function IP(n,e){const t=ut(n),s=t.Eu.get(e);if(s&&s.lu)return xt().add(s.key);{let a=xt();const l=t.Tu.get(e);if(!l)return a;for(const d of l){const f=t.Pu.get(d);a=a.unionWith(f.view.tu)}return a}}function Xx(n){const e=ut(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Kx.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=IP.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=EP.bind(null,e),e.hu.J_=uP.bind(null,e.eventManager),e.hu.pu=dP.bind(null,e.eventManager),e}function NP(n){const e=ut(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=TP.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=SP.bind(null,e),e}class rd{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Td(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,t){return null}Fu(e,t){return null}vu(e){return jN(this.persistence,new PN,e.initialUser,this.serializer)}Du(e){return new Dx(Lp.Vi,this.serializer)}bu(e){return new FN}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}rd.provider={build:()=>new rd};class PP extends rd{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,t){Rt(this.persistence.referenceDelegate instanceof td,46915);const s=this.persistence.referenceDelegate.garbageCollector;return new pN(s,e.asyncQueue,t)}Du(e){const t=this.cacheSizeBytes!==void 0?Ar.withCacheSize(this.cacheSizeBytes):Ar.DEFAULT;return new Dx((s=>td.Vi(s,t)),this.serializer)}}class Jf{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>Zv(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=CP.bind(null,this.syncEngine),await oP(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new cP})()}createDatastore(e){const t=Td(e.databaseInfo.databaseId),s=(function(l){return new WN(l)})(e.databaseInfo);return(function(l,d,f,m){return new KN(l,d,f,m)})(e.authCredentials,e.appCheckCredentials,s,t)}createRemoteStore(e){return(function(s,a,l,d,f){return new YN(s,a,l,d,f)})(this.localStore,this.datastore,e.asyncQueue,(t=>Zv(this.syncEngine,t,0)),(function(){return Hv.C()?new Hv:new UN})())}createSyncEngine(e,t){return(function(a,l,d,f,m,y,x){const E=new mP(a,l,d,f,m,y);return x&&(E.fu=!0),E})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(a){const l=ut(a);ze(qa,"RemoteStore shutting down."),l.Ia.add(5),await fc(l),l.Ea.shutdown(),l.Aa.set("Unknown")})(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}Jf.provider={build:()=>new Jf};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jp{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):yi("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aa="FirestoreClient";class RP{constructor(e,t,s,a,l){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=s,this.databaseInfo=a,this.user=ir.UNAUTHENTICATED,this.clientId=Sp.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(s,(async d=>{ze(aa,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d})),this.appCheckCredentials.start(s,(d=>(ze(aa,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new fi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const s=Wp(t,"Failed to shutdown persistence");e.reject(s)}})),e.promise}}async function yf(n,e){n.asyncQueue.verifyOperationInProgress(),ze(aa,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let s=t.initialUser;n.setCredentialChangeListener((async a=>{s.isEqual(a)||(await Vx(e.localStore,a),s=a)})),e.persistence.setDatabaseDeletedListener((()=>{ea("Terminating Firestore due to IndexedDb database deletion"),n.terminate().then((()=>{ze("Terminating Firestore due to IndexedDb database deletion completed successfully")})).catch((a=>{ea("Terminating Firestore due to IndexedDb database deletion failed",a)}))})),n._offlineComponents=e}async function t_(n,e){n.asyncQueue.verifyOperationInProgress();const t=await AP(n);ze(aa,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((s=>Qv(e.remoteStore,s))),n.setAppCheckTokenChangeListener(((s,a)=>Qv(e.remoteStore,a))),n._onlineComponents=e}async function AP(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){ze(aa,"Using user provided OfflineComponentProvider");try{await yf(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(a){return a.name==="FirebaseError"?a.code===fe.FAILED_PRECONDITION||a.code===fe.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11})(t))throw t;ea("Error using user provided cache. Falling back to memory cache: "+t),await yf(n,new rd)}}else ze(aa,"Using default OfflineComponentProvider"),await yf(n,new PP(void 0));return n._offlineComponents}async function Zx(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(ze(aa,"Using user provided OnlineComponentProvider"),await t_(n,n._uninitializedComponentsProvider._online)):(ze(aa,"Using default OnlineComponentProvider"),await t_(n,new Jf))),n._onlineComponents}function jP(n){return Zx(n).then((e=>e.syncEngine))}async function sd(n){const e=await Zx(n),t=e.eventManager;return t.onListen=gP.bind(null,e.syncEngine),t.onUnlisten=_P.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=yP.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=xP.bind(null,e.syncEngine),t}function kP(n,e,t={}){const s=new fi;return n.asyncQueue.enqueueAndForget((async()=>(function(l,d,f,m,y){const x=new Jp({next:C=>{x.Ou(),d.enqueueAndForget((()=>qp(l,E)));const U=C.docs.has(f);!U&&C.fromCache?y.reject(new Fe(fe.UNAVAILABLE,"Failed to get document because the client is offline.")):U&&C.fromCache&&m&&m.source==="server"?y.reject(new Fe(fe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):y.resolve(C)},error:C=>y.reject(C)}),E=new Kp(yd(f.path),x,{includeMetadataChanges:!0,ka:!0});return Gp(l,E)})(await sd(n),n.asyncQueue,e,t,s))),s.promise}function DP(n,e,t={}){const s=new fi;return n.asyncQueue.enqueueAndForget((async()=>(function(l,d,f,m,y){const x=new Jp({next:C=>{x.Ou(),d.enqueueAndForget((()=>qp(l,E))),C.fromCache&&m.source==="server"?y.reject(new Fe(fe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):y.resolve(C)},error:C=>y.reject(C)}),E=new Kp(f,x,{includeMetadataChanges:!0,ka:!0});return Gp(l,E)})(await sd(n),n.asyncQueue,e,t,s))),s.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ew(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n_=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tw="firestore.googleapis.com",r_=!0;class s_{constructor(e){var t,s;if(e.host===void 0){if(e.ssl!==void 0)throw new Fe(fe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=tw,this.ssl=r_}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:r_;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=kx;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<hN)throw new Fe(fe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}YC("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=ew((s=e.experimentalLongPollingOptions)!==null&&s!==void 0?s:{}),(function(l){if(l.timeoutSeconds!==void 0){if(isNaN(l.timeoutSeconds))throw new Fe(fe.INVALID_ARGUMENT,`invalid long polling timeout: ${l.timeoutSeconds} (must not be NaN)`);if(l.timeoutSeconds<5)throw new Fe(fe.INVALID_ARGUMENT,`invalid long polling timeout: ${l.timeoutSeconds} (minimum allowed value is 5)`);if(l.timeoutSeconds>30)throw new Fe(fe.INVALID_ARGUMENT,`invalid long polling timeout: ${l.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(s,a){return s.timeoutSeconds===a.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Cd{constructor(e,t,s,a){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=s,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new s_({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Fe(fe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Fe(fe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new s_(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(s){if(!s)return new zC;switch(s.type){case"firstParty":return new GC(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new Fe(fe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const s=n_.get(t);s&&(ze("ComponentProvider","Removing Datastore"),n_.delete(t),s.terminate())})(this),Promise.resolve()}}function VP(n,e,t,s={}){var a;n=kr(n,Cd);const l=Ko(e),d=n._getSettings(),f=Object.assign(Object.assign({},d),{emulatorOptions:n._getEmulatorOptions()}),m=`${e}:${t}`;l&&(q_(`https://${m}`),H_("Firestore",!0)),d.host!==tw&&d.host!==m&&ea("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const y=Object.assign(Object.assign({},d),{host:m,ssl:l,emulatorOptions:s});if(!$a(y,f)&&(n._setSettings(y),s.mockUserToken)){let x,E;if(typeof s.mockUserToken=="string")x=s.mockUserToken,E=ir.MOCK_USER;else{x=Q1(s.mockUserToken,(a=n._app)===null||a===void 0?void 0:a.options.projectId);const C=s.mockUserToken.sub||s.mockUserToken.user_id;if(!C)throw new Fe(fe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");E=new ir(C)}n._authCredentials=new $C(new W0(x,E))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ei{constructor(e,t,s){this.converter=t,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new Ei(this.firestore,e,this._query)}}class nn{constructor(e,t,s){this.converter=t,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Zi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new nn(this.firestore,e,this._key)}toJSON(){return{type:nn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,s){if(uc(t,nn._jsonSchema))return new nn(e,s||null,new Xe(Ot.fromString(t.referencePath)))}}nn._jsonSchemaVersion="firestore/documentReference/1.0",nn._jsonSchema={type:yn("string",nn._jsonSchemaVersion),referencePath:yn("string")};class Zi extends Ei{constructor(e,t,s){super(e,t,yd(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new nn(this.firestore,null,new Xe(e))}withConverter(e){return new Zi(this.firestore,e,this._path)}}function bn(n,e,...t){if(n=rn(n),q0("collection","path",e),n instanceof Cd){const s=Ot.fromString(e,...t);return yv(s),new Zi(n,null,s)}{if(!(n instanceof nn||n instanceof Zi))throw new Fe(fe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(Ot.fromString(e,...t));return yv(s),new Zi(n.firestore,null,s)}}function Pt(n,e,...t){if(n=rn(n),arguments.length===1&&(e=Sp.newId()),q0("doc","path",e),n instanceof Cd){const s=Ot.fromString(e,...t);return gv(s),new nn(n,null,new Xe(s))}{if(!(n instanceof nn||n instanceof Zi))throw new Fe(fe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(Ot.fromString(e,...t));return gv(s),new nn(n.firestore,n instanceof Zi?n.converter:null,new Xe(s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i_="AsyncQueue";class a_{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new Mx(this,"async_queue_retry"),this.oc=()=>{const s=gf();s&&ze(i_,"Visibility state changed to "+s.visibilityState),this.F_.y_()},this._c=e;const t=gf();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const t=gf();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise((()=>{}));const t=new fi;return this.uc((()=>this.Xu&&this.rc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Zu.push(e),this.cc())))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!el(e))throw e;ze(i_,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_((()=>this.cc()))}}uc(e){const t=this._c.then((()=>(this.nc=!0,e().catch((s=>{throw this.tc=s,this.nc=!1,yi("INTERNAL UNHANDLED ERROR: ",o_(s)),s})).then((s=>(this.nc=!1,s))))));return this._c=t,t}enqueueAfterDelay(e,t,s){this.ac(),this.sc.indexOf(e)>-1&&(t=0);const a=Bp.createAndSchedule(this,e,t,s,(l=>this.lc(l)));return this.ec.push(a),a}ac(){this.tc&&it(47125,{hc:o_(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(const t of this.ec)if(t.timerId===e)return!0;return!1}Ic(e){return this.Pc().then((()=>{this.ec.sort(((t,s)=>t.targetTimeMs-s.targetTimeMs));for(const t of this.ec)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Pc()}))}dc(e){this.sc.push(e)}lc(e){const t=this.ec.indexOf(e);this.ec.splice(t,1)}}function o_(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l_(n){return(function(t,s){if(typeof t!="object"||t===null)return!1;const a=t;for(const l of s)if(l in a&&typeof a[l]=="function")return!0;return!1})(n,["next","error","complete"])}class _i extends Cd{constructor(e,t,s,a){super(e,t,s,a),this.type="firestore",this._queue=new a_,this._persistenceKey=(a==null?void 0:a.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new a_(e),this._firestoreClient=void 0,await e}}}function LP(n,e){const t=typeof n=="object"?n:J_(),s=typeof n=="string"?n:Qu,a=dp(t,"firestore").getImmediate({identifier:s});if(!a._initialized){const l=H1("firestore");l&&VP(a,...l)}return a}function Id(n){if(n._terminated)throw new Fe(fe.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||MP(n),n._firestoreClient}function MP(n){var e,t,s;const a=n._freezeSettings(),l=(function(f,m,y,x){return new oI(f,m,y,x.host,x.ssl,x.experimentalForceLongPolling,x.experimentalAutoDetectLongPolling,ew(x.experimentalLongPollingOptions),x.useFetchStreams,x.isUsingEmulator)})(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,a);n._componentsProvider||!((t=a.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((s=a.localCache)===null||s===void 0)&&s._onlineComponentProvider)&&(n._componentsProvider={_offline:a.localCache._offlineComponentProvider,_online:a.localCache._onlineComponentProvider}),n._firestoreClient=new RP(n._authCredentials,n._appCheckCredentials,n._queue,l,n._componentsProvider&&(function(f){const m=f==null?void 0:f._online.build();return{_offline:f==null?void 0:f._offline.build(m),_online:m}})(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class os{constructor(e){this._byteString=e}static fromBase64String(e){try{return new os(Hn.fromBase64String(e))}catch(t){throw new Fe(fe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new os(Hn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:os._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(uc(e,os._jsonSchema))return os.fromBase64String(e.bytes)}}os._jsonSchemaVersion="firestore/bytes/1.0",os._jsonSchema={type:yn("string",os._jsonSchemaVersion),bytes:yn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nd{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Fe(fe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new qn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pd{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ys{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Fe(fe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Fe(fe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return mt(this._lat,e._lat)||mt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ys._jsonSchemaVersion}}static fromJSON(e){if(uc(e,Ys._jsonSchema))return new Ys(e.latitude,e.longitude)}}Ys._jsonSchemaVersion="firestore/geoPoint/1.0",Ys._jsonSchema={type:yn("string",Ys._jsonSchemaVersion),latitude:yn("number"),longitude:yn("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Js{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(s,a){if(s.length!==a.length)return!1;for(let l=0;l<s.length;++l)if(s[l]!==a[l])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Js._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(uc(e,Js._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Js(e.vectorValues);throw new Fe(fe.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Js._jsonSchemaVersion="firestore/vectorValue/1.0",Js._jsonSchema={type:yn("string",Js._jsonSchemaVersion),vectorValues:yn("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OP=/^__.*__$/;class FP{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return this.fieldMask!==null?new ha(e,this.data,this.fieldMask,t,this.fieldTransforms):new dc(e,this.data,t,this.fieldTransforms)}}class nw{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return new ha(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function rw(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw it(40011,{Ec:n})}}class Xp{constructor(e,t,s,a,l,d){this.settings=e,this.databaseId=t,this.serializer=s,this.ignoreUndefinedProperties=a,l===void 0&&this.Ac(),this.fieldTransforms=l||[],this.fieldMask=d||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new Xp(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var t;const s=(t=this.path)===null||t===void 0?void 0:t.child(e),a=this.Rc({path:s,mc:!1});return a.fc(e),a}gc(e){var t;const s=(t=this.path)===null||t===void 0?void 0:t.child(e),a=this.Rc({path:s,mc:!1});return a.Ac(),a}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return id(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(rw(this.Ec)&&OP.test(e))throw this.wc('Document fields cannot begin and end with "__"')}}class UP{constructor(e,t,s){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=s||Td(e)}Dc(e,t,s,a=!1){return new Xp({Ec:e,methodName:t,bc:s,path:qn.emptyPath(),mc:!1,Sc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Rd(n){const e=n._freezeSettings(),t=Td(n._databaseId);return new UP(n._databaseId,!!e.ignoreUndefinedProperties,t)}function sw(n,e,t,s,a,l={}){const d=n.Dc(l.merge||l.mergeFields?2:0,e,t,a);em("Data must be an object, but it was:",d,s);const f=iw(s,d);let m,y;if(l.merge)m=new Br(d.fieldMask),y=d.fieldTransforms;else if(l.mergeFields){const x=[];for(const E of l.mergeFields){const C=Xf(e,E,t);if(!d.contains(C))throw new Fe(fe.INVALID_ARGUMENT,`Field '${C}' is specified in your field mask but missing from your input data.`);ow(x,C)||x.push(C)}m=new Br(x),y=d.fieldTransforms.filter((E=>m.covers(E.field)))}else m=null,y=d.fieldTransforms;return new FP(new jr(f),m,y)}class mc extends Pd{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof mc}}class Zp extends Pd{_toFieldTransform(e){return new kI(e.path,new ec)}isEqual(e){return e instanceof Zp}}function zP(n,e,t,s){const a=n.Dc(1,e,t);em("Data must be an object, but it was:",a,s);const l=[],d=jr.empty();da(s,((m,y)=>{const x=tm(e,m,t);y=rn(y);const E=a.gc(x);if(y instanceof mc)l.push(x);else{const C=gc(y,E);C!=null&&(l.push(x),d.set(x,C))}}));const f=new Br(l);return new nw(d,f,a.fieldTransforms)}function $P(n,e,t,s,a,l){const d=n.Dc(1,e,t),f=[Xf(e,s,t)],m=[a];if(l.length%2!=0)throw new Fe(fe.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let C=0;C<l.length;C+=2)f.push(Xf(e,l[C])),m.push(l[C+1]);const y=[],x=jr.empty();for(let C=f.length-1;C>=0;--C)if(!ow(y,f[C])){const U=f[C];let X=m[C];X=rn(X);const W=d.gc(U);if(X instanceof mc)y.push(U);else{const z=gc(X,W);z!=null&&(y.push(U),x.set(U,z))}}const E=new Br(y);return new nw(x,E,d.fieldTransforms)}function BP(n,e,t,s=!1){return gc(t,n.Dc(s?4:3,e))}function gc(n,e){if(aw(n=rn(n)))return em("Unsupported field value:",e,n),iw(n,e);if(n instanceof Pd)return(function(s,a){if(!rw(a.Ec))throw a.wc(`${s._methodName}() can only be used with update() and set()`);if(!a.path)throw a.wc(`${s._methodName}() is not currently supported inside arrays`);const l=s._toFieldTransform(a);l&&a.fieldTransforms.push(l)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return(function(s,a){const l=[];let d=0;for(const f of s){let m=gc(f,a.yc(d));m==null&&(m={nullValue:"NULL_VALUE"}),l.push(m),d++}return{arrayValue:{values:l}}})(n,e)}return(function(s,a){if((s=rn(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return RI(a.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const l=Wt.fromDate(s);return{timestampValue:ed(a.serializer,l)}}if(s instanceof Wt){const l=new Wt(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:ed(a.serializer,l)}}if(s instanceof Ys)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof os)return{bytesValue:Cx(a.serializer,s._byteString)};if(s instanceof nn){const l=a.databaseId,d=s.firestore._databaseId;if(!d.isEqual(l))throw a.wc(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:Dp(s.firestore._databaseId||a.databaseId,s._key.path)}}if(s instanceof Js)return(function(d,f){return{mapValue:{fields:{[tx]:{stringValue:nx},[Yu]:{arrayValue:{values:d.toArray().map((y=>{if(typeof y!="number")throw f.wc("VectorValues must only contain numeric values.");return Rp(f.serializer,y)}))}}}}}})(s,a);throw a.wc(`Unsupported field value: ${fd(s)}`)})(n,e)}function iw(n,e){const t={};return Q0(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):da(n,((s,a)=>{const l=gc(a,e.Vc(s));l!=null&&(t[s]=l)})),{mapValue:{fields:t}}}function aw(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Wt||n instanceof Ys||n instanceof os||n instanceof nn||n instanceof Pd||n instanceof Js)}function em(n,e,t){if(!aw(t)||!H0(t)){const s=fd(t);throw s==="an object"?e.wc(n+" a custom object"):e.wc(n+" "+s)}}function Xf(n,e,t){if((e=rn(e))instanceof Nd)return e._internalPath;if(typeof e=="string")return tm(n,e);throw id("Field path arguments must be of type string or ",n,!1,void 0,t)}const WP=new RegExp("[~\\*/\\[\\]]");function tm(n,e,t){if(e.search(WP)>=0)throw id(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Nd(...e.split("."))._internalPath}catch{throw id(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function id(n,e,t,s,a){const l=s&&!s.isEmpty(),d=a!==void 0;let f=`Function ${e}() called with invalid data`;t&&(f+=" (via `toFirestore()`)"),f+=". ";let m="";return(l||d)&&(m+=" (found",l&&(m+=` in field ${s}`),d&&(m+=` in document ${a}`),m+=")"),new Fe(fe.INVALID_ARGUMENT,f+n+m)}function ow(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lw{constructor(e,t,s,a,l){this._firestore=e,this._userDataWriter=t,this._key=s,this._document=a,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new nn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new GP(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Ad("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class GP extends lw{data(){return super.data()}}function Ad(n,e){return typeof e=="string"?tm(n,e):e instanceof Nd?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cw(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Fe(fe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class nm{}class rm extends nm{}function Zf(n,e,...t){let s=[];e instanceof nm&&s.push(e),s=s.concat(t),(function(l){const d=l.filter((m=>m instanceof sm)).length,f=l.filter((m=>m instanceof jd)).length;if(d>1||d>0&&f>0)throw new Fe(fe.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(s);for(const a of s)n=a._apply(n);return n}class jd extends rm{constructor(e,t,s){super(),this._field=e,this._op=t,this._value=s,this.type="where"}static _create(e,t,s){return new jd(e,t,s)}_apply(e){const t=this._parse(e);return dw(e._query,t),new Ei(e.firestore,e.converter,$f(e._query,t))}_parse(e){const t=Rd(e.firestore);return(function(l,d,f,m,y,x,E){let C;if(y.isKeyField()){if(x==="array-contains"||x==="array-contains-any")throw new Fe(fe.INVALID_ARGUMENT,`Invalid Query. You can't perform '${x}' queries on documentId().`);if(x==="in"||x==="not-in"){u_(E,x);const X=[];for(const W of E)X.push(c_(m,l,W));C={arrayValue:{values:X}}}else C=c_(m,l,E)}else x!=="in"&&x!=="not-in"&&x!=="array-contains-any"||u_(E,x),C=BP(f,d,E,x==="in"||x==="not-in");return gn.create(y,x,C)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function uw(n,e,t){const s=e,a=Ad("where",n);return jd._create(a,s,t)}class sm extends nm{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new sm(e,t)}_parse(e){const t=this._queryConstraints.map((s=>s._parse(e))).filter((s=>s.getFilters().length>0));return t.length===1?t[0]:As.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(a,l){let d=a;const f=l.getFlattenedFilters();for(const m of f)dw(d,m),d=$f(d,m)})(e._query,t),new Ei(e.firestore,e.converter,$f(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class im extends rm{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new im(e,t)}_apply(e){const t=(function(a,l,d){if(a.startAt!==null)throw new Fe(fe.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(a.endAt!==null)throw new Fe(fe.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Zl(l,d)})(e._query,this._field,this._direction);return new Ei(e.firestore,e.converter,(function(a,l){const d=a.explicitOrderBy.concat([l]);return new tl(a.path,a.collectionGroup,d,a.filters.slice(),a.limit,a.limitType,a.startAt,a.endAt)})(e._query,t))}}function ep(n,e="asc"){const t=e,s=Ad("orderBy",n);return im._create(s,t)}class am extends rm{constructor(e,t,s){super(),this.type=e,this._limit=t,this._limitType=s}static _create(e,t,s){return new am(e,t,s)}_apply(e){return new Ei(e.firestore,e.converter,Xu(e._query,this._limit,this._limitType))}}function qP(n){return am._create("limit",n,"F")}function c_(n,e,t){if(typeof(t=rn(t))=="string"){if(t==="")throw new Fe(fe.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!ux(e)&&t.indexOf("/")!==-1)throw new Fe(fe.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const s=e.path.child(Ot.fromString(t));if(!Xe.isDocumentKey(s))throw new Fe(fe.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return bv(n,new Xe(s))}if(t instanceof nn)return bv(n,t._key);throw new Fe(fe.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${fd(t)}.`)}function u_(n,e){if(!Array.isArray(n)||n.length===0)throw new Fe(fe.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function dw(n,e){const t=(function(a,l){for(const d of a)for(const f of d.getFlattenedFilters())if(l.indexOf(f.op)>=0)return f.op;return null})(n.filters,(function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new Fe(fe.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Fe(fe.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class HP{convertValue(e,t="none"){switch(sa(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ln(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ra(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw it(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const s={};return da(e,((a,l)=>{s[a]=this.convertValue(l,t)})),s}convertVectorValue(e){var t,s,a;const l=(a=(s=(t=e.fields)===null||t===void 0?void 0:t[Yu].arrayValue)===null||s===void 0?void 0:s.values)===null||a===void 0?void 0:a.map((d=>ln(d.doubleValue)));return new Js(l)}convertGeoPoint(e){return new Ys(ln(e.latitude),ln(e.longitude))}convertArray(e,t){return(e.values||[]).map((s=>this.convertValue(s,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const s=gd(e);return s==null?null:this.convertValue(s,t);case"estimate":return this.convertTimestamp(Yl(e));default:return null}}convertTimestamp(e){const t=na(e);return new Wt(t.seconds,t.nanos)}convertDocumentKey(e,t){const s=Ot.fromString(e);Rt(jx(s),9688,{name:e});const a=new Jl(s.get(1),s.get(3)),l=new Xe(s.popFirst(5));return a.isEqual(t)||yi(`Document ${l} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hw(n,e,t){let s;return s=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,s}class Ll{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Fa extends lw{constructor(e,t,s,a,l,d){super(e,t,s,a,d),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Lu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const s=this._document.data.field(Ad("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Fe(fe.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Fa._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Fa._jsonSchemaVersion="firestore/documentSnapshot/1.0",Fa._jsonSchema={type:yn("string",Fa._jsonSchemaVersion),bundleSource:yn("string","DocumentSnapshot"),bundleName:yn("string"),bundle:yn("string")};class Lu extends Fa{data(e={}){return super.data(e)}}class Ua{constructor(e,t,s,a){this._firestore=e,this._userDataWriter=t,this._snapshot=a,this.metadata=new Ll(a.hasPendingWrites,a.fromCache),this.query=s}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((s=>{e.call(t,new Lu(this._firestore,this._userDataWriter,s.key,s,new Ll(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Fe(fe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(a,l){if(a._snapshot.oldDocs.isEmpty()){let d=0;return a._snapshot.docChanges.map((f=>{const m=new Lu(a._firestore,a._userDataWriter,f.doc.key,f.doc,new Ll(a._snapshot.mutatedKeys.has(f.doc.key),a._snapshot.fromCache),a.query.converter);return f.doc,{type:"added",doc:m,oldIndex:-1,newIndex:d++}}))}{let d=a._snapshot.oldDocs;return a._snapshot.docChanges.filter((f=>l||f.type!==3)).map((f=>{const m=new Lu(a._firestore,a._userDataWriter,f.doc.key,f.doc,new Ll(a._snapshot.mutatedKeys.has(f.doc.key),a._snapshot.fromCache),a.query.converter);let y=-1,x=-1;return f.type!==0&&(y=d.indexOf(f.doc.key),d=d.delete(f.doc.key)),f.type!==1&&(d=d.add(f.doc),x=d.indexOf(f.doc.key)),{type:KP(f.type),doc:m,oldIndex:y,newIndex:x}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Fe(fe.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Ua._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Sp.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],s=[],a=[];return this.docs.forEach((l=>{l._document!==null&&(t.push(l._document),s.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),a.push(l.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function KP(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return it(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rc(n){n=kr(n,nn);const e=kr(n.firestore,_i);return kP(Id(e),n._key).then((t=>fw(e,n,t)))}Ua._jsonSchemaVersion="firestore/querySnapshot/1.0",Ua._jsonSchema={type:yn("string",Ua._jsonSchemaVersion),bundleSource:yn("string","QuerySnapshot"),bundleName:yn("string"),bundle:yn("string")};class om extends HP{constructor(e){super(),this.firestore=e}convertBytes(e){return new os(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new nn(this.firestore,null,t)}}function Is(n){n=kr(n,Ei);const e=kr(n.firestore,_i),t=Id(e),s=new om(e);return cw(n._query),DP(t,n._query).then((a=>new Ua(e,s,n,a)))}function qs(n,e,t){n=kr(n,nn);const s=kr(n.firestore,_i),a=hw(n.converter,e,t);return kd(s,[sw(Rd(s),"setDoc",n._key,a,n.converter!==null,t).toMutation(n._key,cs.none())])}function Ns(n,e,t,...s){n=kr(n,nn);const a=kr(n.firestore,_i),l=Rd(a);let d;return d=typeof(e=rn(e))=="string"||e instanceof Nd?$P(l,"updateDoc",n._key,e,t,s):zP(l,"updateDoc",n._key,e),kd(a,[d.toMutation(n._key,cs.exists(!0))])}function Ma(n){return kd(kr(n.firestore,_i),[new Ap(n._key,cs.none())])}function Oa(n,e){const t=kr(n.firestore,_i),s=Pt(n),a=hw(n.converter,e);return kd(t,[sw(Rd(n.firestore),"addDoc",s._key,a,n.converter!==null,{}).toMutation(s._key,cs.exists(!1))]).then((()=>s))}function d_(n,...e){var t,s,a;n=rn(n);let l={includeMetadataChanges:!1,source:"default"},d=0;typeof e[d]!="object"||l_(e[d])||(l=e[d++]);const f={includeMetadataChanges:l.includeMetadataChanges,source:l.source};if(l_(e[d])){const E=e[d];e[d]=(t=E.next)===null||t===void 0?void 0:t.bind(E),e[d+1]=(s=E.error)===null||s===void 0?void 0:s.bind(E),e[d+2]=(a=E.complete)===null||a===void 0?void 0:a.bind(E)}let m,y,x;if(n instanceof nn)y=kr(n.firestore,_i),x=yd(n._key.path),m={next:E=>{e[d]&&e[d](fw(y,n,E))},error:e[d+1],complete:e[d+2]};else{const E=kr(n,Ei);y=kr(E.firestore,_i),x=E._query;const C=new om(y);m={next:U=>{e[d]&&e[d](new Ua(y,C,E,U))},error:e[d+1],complete:e[d+2]},cw(n._query)}return(function(C,U,X,W){const z=new Jp(W),se=new Kp(U,z,X);return C.asyncQueue.enqueueAndForget((async()=>Gp(await sd(C),se))),()=>{z.Ou(),C.asyncQueue.enqueueAndForget((async()=>qp(await sd(C),se)))}})(Id(y),x,f,m)}function kd(n,e){return(function(s,a){const l=new fi;return s.asyncQueue.enqueueAndForget((async()=>wP(await jP(s),a,l))),l.promise})(Id(n),e)}function fw(n,e,t){const s=t.docs.get(e._key),a=new om(n);return new Fa(n,a,e._key,s,new Ll(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QP(){return new mc("deleteField")}function za(){return new Zp("serverTimestamp")}(function(e,t=!0){(function(a){Xo=a})(Qo),Oo(new Ba("firestore",((s,{instanceIdentifier:a,options:l})=>{const d=s.getProvider("app").getImmediate(),f=new _i(new BC(s.getProvider("auth-internal")),new qC(d,s.getProvider("app-check-internal")),(function(y,x){if(!Object.prototype.hasOwnProperty.apply(y.options,["projectId"]))throw new Fe(fe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Jl(y.options.projectId,x)})(d,a),d);return l=Object.assign({useFetchStreams:t},l),f._setSettings(l),f}),"PUBLIC").setMultipleInstances(!0)),Ji(dv,hv,e),Ji(dv,hv,"esm2017")})();const YP={apiKey:"AIzaSyCOOnlmEcAcJywsS93LLfLSywy9ENqnppM",authDomain:"tyler-manga-library.firebaseapp.com",projectId:"tyler-manga-library",storageBucket:"tyler-manga-library.firebasestorage.app",messagingSenderId:"307412068362",appId:"1:307412068362:web:6cfe5666187439dfa757f3"},pw=Y_(YP),ls=FC(pw),st=LP(pw),mw=j.createContext(null);function JP({children:n}){const e="https://discord.com/api/webhooks/1451655828078723156/EA8QhLeiTT-7jOVQ6jFpV2he2zxVpAddAhlu8CiC6RtGFu9wTAOLdRjKeYHIV1OhVbmm",[t,s]=j.useState(null),[a,l]=j.useState(!1),[d,f]=j.useState("viewer"),[m,y]=j.useState(!0),x=async U=>{if(!U)return null;const X=Pt(st,"users",U.uid);let W=null;try{const se=await rc(X);se.exists()&&(W=se.data())}catch(se){console.warn("Failed to read user doc",se)}const z={role:((W==null?void 0:W.role)||"viewer").toLowerCase()==="admin"?"admin":"viewer",email:U.email||(W==null?void 0:W.email)||"",displayName:U.displayName||(W==null?void 0:W.displayName)||"",createdAt:(W==null?void 0:W.createdAt)||za()};try{if(await qs(X,z,{merge:!0}),!W&&e)try{const se=U.displayName||U.email||U.uid;await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:`New signup: ${se}`})})}catch(se){console.warn("Failed to send signup webhook",se)}}catch(se){console.error("Failed to ensure user doc",se)}return{...W,...z}};j.useEffect(()=>{const U=Pb(ls,async X=>{if(s(X),X)try{const W=await x(X),z=(W==null?void 0:W.role)||"viewer";f(z),l(z.toLowerCase()==="admin")}catch(W){console.error("Error checking role:",W),l(!1),f("viewer")}else l(!1),f("viewer");y(!1)});return()=>U()},[]);const E=async(U,X)=>{await S0(ls,U,X)},C=async()=>{await b0(ls)};return o.jsx(mw.Provider,{value:{user:t,admin:a,role:d,loading:m,login:E,logout:C},children:n})}function Qa(){return j.useContext(mw)}function XP({onClose:n}){const[e,t]=j.useState("login"),[s,a]=j.useState(""),[l,d]=j.useState("");async function f(){try{await V0(ls,new Cs),n()}catch(x){alert(x.message)}}async function m(x){x.preventDefault();try{await S0(ls,s,l),n()}catch(E){alert(E.message)}}async function y(x){x.preventDefault();try{await Sb(ls,s,l),n()}catch(E){alert(E.message)}}return o.jsx("div",{className:"auth-modal-backdrop",onClick:n,children:o.jsxs("div",{className:"auth-modal",onClick:x=>x.stopPropagation(),children:[o.jsx("h2",{className:"auth-title",children:e==="login"?"Sign In":"Create Account"}),o.jsxs("button",{className:"google-btn",onClick:f,children:[o.jsx("img",{src:"https://www.svgrepo.com/show/475656/google-color.svg",alt:"",className:"google-icon"}),"Continue with Google"]}),o.jsx("div",{className:"auth-divider",children:o.jsx("span",{children:"or"})}),o.jsxs("form",{onSubmit:e==="login"?m:y,className:"auth-form",children:[o.jsx("input",{type:"email",placeholder:"Email address",className:"auth-input",value:s,onChange:x=>a(x.target.value),required:!0}),o.jsx("input",{type:"password",placeholder:"Password",className:"auth-input",value:l,onChange:x=>d(x.target.value),required:!0}),o.jsx("button",{className:"auth-submit",children:e==="login"?"Sign In":"Create Account"})]}),o.jsx("div",{className:"auth-switcher",children:e==="login"?o.jsxs("p",{children:["No account?"," ",o.jsx("button",{onClick:()=>t("register"),children:"Register"})]}):o.jsxs("p",{children:["Already have an account?"," ",o.jsx("button",{onClick:()=>t("login"),children:"Sign in"})]})}),o.jsx("button",{className:"auth-close",onClick:n,"aria-label":"Close",children:"X"})]})})}var Mu={exports:{}},ZP=Mu.exports,h_;function eR(){return h_||(h_=1,(function(n){(function(e){function t(L,ie){var I=(L&65535)+(ie&65535),N=(L>>16)+(ie>>16)+(I>>16);return N<<16|I&65535}function s(L,ie){return L<<ie|L>>>32-ie}function a(L,ie,I,N,A,O){return t(s(t(t(ie,L),t(N,O)),A),I)}function l(L,ie,I,N,A,O,D){return a(ie&I|~ie&N,L,ie,A,O,D)}function d(L,ie,I,N,A,O,D){return a(ie&N|I&~N,L,ie,A,O,D)}function f(L,ie,I,N,A,O,D){return a(ie^I^N,L,ie,A,O,D)}function m(L,ie,I,N,A,O,D){return a(I^(ie|~N),L,ie,A,O,D)}function y(L,ie){L[ie>>5]|=128<<ie%32,L[(ie+64>>>9<<4)+14]=ie;var I,N,A,O,D,P=1732584193,b=-271733879,J=-1732584194,re=271733878;for(I=0;I<L.length;I+=16)N=P,A=b,O=J,D=re,P=l(P,b,J,re,L[I],7,-680876936),re=l(re,P,b,J,L[I+1],12,-389564586),J=l(J,re,P,b,L[I+2],17,606105819),b=l(b,J,re,P,L[I+3],22,-1044525330),P=l(P,b,J,re,L[I+4],7,-176418897),re=l(re,P,b,J,L[I+5],12,1200080426),J=l(J,re,P,b,L[I+6],17,-1473231341),b=l(b,J,re,P,L[I+7],22,-45705983),P=l(P,b,J,re,L[I+8],7,1770035416),re=l(re,P,b,J,L[I+9],12,-1958414417),J=l(J,re,P,b,L[I+10],17,-42063),b=l(b,J,re,P,L[I+11],22,-1990404162),P=l(P,b,J,re,L[I+12],7,1804603682),re=l(re,P,b,J,L[I+13],12,-40341101),J=l(J,re,P,b,L[I+14],17,-1502002290),b=l(b,J,re,P,L[I+15],22,1236535329),P=d(P,b,J,re,L[I+1],5,-165796510),re=d(re,P,b,J,L[I+6],9,-1069501632),J=d(J,re,P,b,L[I+11],14,643717713),b=d(b,J,re,P,L[I],20,-373897302),P=d(P,b,J,re,L[I+5],5,-701558691),re=d(re,P,b,J,L[I+10],9,38016083),J=d(J,re,P,b,L[I+15],14,-660478335),b=d(b,J,re,P,L[I+4],20,-405537848),P=d(P,b,J,re,L[I+9],5,568446438),re=d(re,P,b,J,L[I+14],9,-1019803690),J=d(J,re,P,b,L[I+3],14,-187363961),b=d(b,J,re,P,L[I+8],20,1163531501),P=d(P,b,J,re,L[I+13],5,-1444681467),re=d(re,P,b,J,L[I+2],9,-51403784),J=d(J,re,P,b,L[I+7],14,1735328473),b=d(b,J,re,P,L[I+12],20,-1926607734),P=f(P,b,J,re,L[I+5],4,-378558),re=f(re,P,b,J,L[I+8],11,-2022574463),J=f(J,re,P,b,L[I+11],16,1839030562),b=f(b,J,re,P,L[I+14],23,-35309556),P=f(P,b,J,re,L[I+1],4,-1530992060),re=f(re,P,b,J,L[I+4],11,1272893353),J=f(J,re,P,b,L[I+7],16,-155497632),b=f(b,J,re,P,L[I+10],23,-1094730640),P=f(P,b,J,re,L[I+13],4,681279174),re=f(re,P,b,J,L[I],11,-358537222),J=f(J,re,P,b,L[I+3],16,-722521979),b=f(b,J,re,P,L[I+6],23,76029189),P=f(P,b,J,re,L[I+9],4,-640364487),re=f(re,P,b,J,L[I+12],11,-421815835),J=f(J,re,P,b,L[I+15],16,530742520),b=f(b,J,re,P,L[I+2],23,-995338651),P=m(P,b,J,re,L[I],6,-198630844),re=m(re,P,b,J,L[I+7],10,1126891415),J=m(J,re,P,b,L[I+14],15,-1416354905),b=m(b,J,re,P,L[I+5],21,-57434055),P=m(P,b,J,re,L[I+12],6,1700485571),re=m(re,P,b,J,L[I+3],10,-1894986606),J=m(J,re,P,b,L[I+10],15,-1051523),b=m(b,J,re,P,L[I+1],21,-2054922799),P=m(P,b,J,re,L[I+8],6,1873313359),re=m(re,P,b,J,L[I+15],10,-30611744),J=m(J,re,P,b,L[I+6],15,-1560198380),b=m(b,J,re,P,L[I+13],21,1309151649),P=m(P,b,J,re,L[I+4],6,-145523070),re=m(re,P,b,J,L[I+11],10,-1120210379),J=m(J,re,P,b,L[I+2],15,718787259),b=m(b,J,re,P,L[I+9],21,-343485551),P=t(P,N),b=t(b,A),J=t(J,O),re=t(re,D);return[P,b,J,re]}function x(L){var ie,I="",N=L.length*32;for(ie=0;ie<N;ie+=8)I+=String.fromCharCode(L[ie>>5]>>>ie%32&255);return I}function E(L){var ie,I=[];for(I[(L.length>>2)-1]=void 0,ie=0;ie<I.length;ie+=1)I[ie]=0;var N=L.length*8;for(ie=0;ie<N;ie+=8)I[ie>>5]|=(L.charCodeAt(ie/8)&255)<<ie%32;return I}function C(L){return x(y(E(L),L.length*8))}function U(L,ie){var I,N=E(L),A=[],O=[],D;for(A[15]=O[15]=void 0,N.length>16&&(N=y(N,L.length*8)),I=0;I<16;I+=1)A[I]=N[I]^909522486,O[I]=N[I]^1549556828;return D=y(A.concat(E(ie)),512+ie.length*8),x(y(O.concat(D),640))}function X(L){var ie="0123456789abcdef",I="",N,A;for(A=0;A<L.length;A+=1)N=L.charCodeAt(A),I+=ie.charAt(N>>>4&15)+ie.charAt(N&15);return I}function W(L){return unescape(encodeURIComponent(L))}function z(L){return C(W(L))}function se(L){return X(z(L))}function we(L,ie){return U(W(L),W(ie))}function _e(L,ie){return X(we(L,ie))}function ve(L,ie,I){return ie?I?we(ie,L):_e(ie,L):I?z(L):se(L)}n.exports?n.exports=ve:e.md5=ve})(ZP)})(Mu)),Mu.exports}var tR=eR();const nR=tp(tR);function rR(){var Oe,Qe,nt;const n="google.com",e="oidc.discord",[t,s]=j.useState(!1),[a,l]=j.useState(!1),[d,f]=j.useState(!1),[m,y]=j.useState(!1),[x,E]=j.useState(""),[C,U]=j.useState(""),[X,W]=j.useState(""),[z,se]=j.useState({google:!1,discord:!1}),[we,_e]=j.useState(""),[ve,L]=j.useState(!1),[ie,I]=j.useState(!1),[N,A]=j.useState(null),O=j.useRef(null),{user:D,admin:P,role:b}=Qa(),J=sc();j.useEffect(()=>{var ge;f(!1),y(!1),U(""),W(""),I(!1),E((D==null?void 0:D.displayName)||((ge=D==null?void 0:D.email)==null?void 0:ge.split("@")[0])||"")},[D]),j.useEffect(()=>{const ge=((D==null?void 0:D.email)||"").trim().toLowerCase();if(!ge){_e("");return}const le=nR(ge),Me=Date.now();_e(`https://www.gravatar.com/avatar/${le}?s=160&d=identicon&r=g&cb=${Me}`)},[D==null?void 0:D.email]),j.useEffect(()=>{let ge=!1;const le=async()=>{var pe;try{const qe=Zf(bn(st,"blogPosts"),uw("status","==","published"),ep("publishedAt","desc"),qP(1)),Ye=await Is(qe);if(ge)return;if(Ye.empty){A(null);return}const It=Ye.docs[0],At=It.data(),wt=(pe=At.publishedAt)!=null&&pe.toDate?At.publishedAt.toDate():null;if(!wt){A(null);return}const jt=At.title||"New blog post",sn=wt.toISOString().slice(0,10),un=`blog-alert-${It.id}-${sn}`;if(!(Date.now()-wt.getTime()<=1440*60*1e3)){A(null);return}if(typeof localStorage<"u"&&localStorage.getItem(un)==="dismissed")return;A({id:It.id,title:jt,alertKey:un,publishedAt:wt})}catch(qe){(qe==null?void 0:qe.code)!=="permission-denied"&&console.error("Failed to load blog alert",qe)}};le();const Me=setInterval(le,6e4);return()=>{ge=!0,clearInterval(Me)}},[]);const re=ge=>{N!=null&&N.alertKey&&typeof localStorage<"u"&&localStorage.setItem(N.alertKey,"dismissed"),A(null),J(ge?`/blog?post=${ge}`:"/blog")},Ie=ge=>{ge!=null&&ge.stopPropagation&&ge.stopPropagation(),N!=null&&N.alertKey&&typeof localStorage<"u"&&localStorage.setItem(N.alertKey,"dismissed"),A(null)};async function he(){try{await b0(ls),s(!1),f(!1),J("/")}catch(ge){console.error(ge),alert("Logout failed.")}}const ce=()=>{if(!D){s(!1),l(!0);return}f(!1),U(""),W(""),I(!1),y(!0)},Pe=async()=>{if(!D){s(!1),l(!0);return}const ge=(x||"").trim();if(!ge){U("Display name is required.");return}L(!0),U(""),I(!1);try{await Cb(ls.currentUser,{displayName:ge}),await qs(Pt(st,"users",D.uid),{displayName:ge},{merge:!0}),U("Profile updated."),I(!1)}catch(le){console.error("Failed to update profile",le),U("Failed to update profile.")}finally{L(!1)}},xe=ge=>{var le;return!!((le=D==null?void 0:D.providerData)!=null&&le.some(Me=>Me.providerId===ge))},Y=async()=>{if(!D){s(!1),l(!0);return}if(xe(n)){W("Google is already connected.");return}se(ge=>({...ge,google:!0})),W("");try{const ge=new Cs,le=await nv(ls.currentUser,ge);await qs(Pt(st,"users",D.uid),{connections:{[n]:{email:le.user.email||"",connectedAt:za()}}},{merge:!0}),W("Google connected.")}catch(ge){console.error("Failed to link Google",ge);const le=(ge==null?void 0:ge.code)==="auth/credential-already-in-use"?"That Google account is already linked elsewhere. Sign in with it instead.":"Could not connect Google.";W(le)}finally{se(ge=>({...ge,google:!1}))}},k=async()=>{if(!D){s(!1),l(!0);return}if(xe(e)){W("Discord is already connected.");return}se(ge=>({...ge,discord:!0})),W("");try{const ge=new Fl(e);ge.addScope("identify"),ge.addScope("email");const Me=(await nv(ls.currentUser,ge)).user.providerData.find(pe=>pe.providerId===e);await qs(Pt(st,"users",D.uid),{connections:{[e]:{username:(Me==null?void 0:Me.displayName)||(Me==null?void 0:Me.uid)||"Discord",email:(Me==null?void 0:Me.email)||"",connectedAt:za()}}},{merge:!0}),W("Discord connected.")}catch(ge){console.error("Failed to link Discord",ge);const le=(ge==null?void 0:ge.code)==="auth/credential-already-in-use"?"That Discord account is already linked elsewhere. Sign in with it instead.":"Could not connect Discord.";W(le)}finally{se(ge=>({...ge,discord:!1}))}},H=async ge=>{if(!D)return;if(D.providerData.length<=1){W("You need at least one sign-in method.");return}const le=ge===n?"google":"discord";W(""),se(Me=>({...Me,[le]:!0}));try{await _b(ls.currentUser,ge),await qs(Pt(st,"users",D.uid),{connections:{[ge]:QP()}},{merge:!0}),W("Connection removed.")}catch(Me){console.error("Failed to unlink",Me),W("Could not remove connection.")}finally{se(Me=>({...Me,[le]:!1}))}},Te=D?(((Oe=D.displayName)==null?void 0:Oe[0])||((Qe=D.email)==null?void 0:Qe[0])||((nt=D.uid)==null?void 0:nt[0])||"?").toUpperCase():"?",Ve=(D==null?void 0:D.displayName)||(D==null?void 0:D.email)||"Guest",De=D?P?"admin":b||"viewer":"Not signed in";return o.jsxs(o.Fragment,{children:[N&&o.jsxs("div",{className:"blog-alert-banner",onClick:()=>re(N.id),role:"button",tabIndex:0,onKeyDown:ge=>{(ge.key==="Enter"||ge.key===" ")&&(ge.preventDefault(),re(N.id))},children:[o.jsx("div",{className:"blog-alert-dot"}),o.jsxs("div",{className:"blog-alert-text",children:["New blog post today: ",o.jsx("strong",{children:N.title})]}),o.jsxs("div",{className:"blog-alert-actions",children:[o.jsx("button",{type:"button",className:"blog-alert-btn",onClick:ge=>{ge.stopPropagation(),re(N.id)},children:"Read now"}),o.jsx("button",{type:"button",className:"blog-alert-dismiss",onClick:Ie,children:"Dismiss"})]})]}),o.jsxs("button",{className:`menu-toggle ${t?"active":""}`,onClick:()=>s(!t),children:[o.jsx("span",{}),o.jsx("span",{}),o.jsx("span",{})]}),o.jsxs("nav",{className:`menu-panel ${t?"open":""}`,onMouseLeave:()=>f(!1),children:[o.jsx(Ui,{to:"/",className:"menu-item",onClick:()=>s(!1),children:"Home"}),o.jsx(Ui,{to:"/manga",className:"menu-item",onClick:()=>s(!1),children:"Manga"}),o.jsx(Ui,{to:"/anime",className:"menu-item",onClick:()=>s(!1),children:"Anime"}),o.jsx(Ui,{to:"/tcg",className:"menu-item",onClick:()=>s(!1),children:"TCG"}),o.jsx(Ui,{to:"/music",className:"menu-item",onClick:()=>s(!1),children:"Music"}),o.jsx(Ui,{to:"/steam",className:"menu-item",onClick:()=>s(!1),children:"Gaming"}),P&&o.jsx(Ui,{to:"/blog",className:"menu-item",onClick:()=>s(!1),children:"Blog"}),P&&o.jsx(Ui,{to:"/dashboard",className:"menu-item",onClick:()=>s(!1),children:"Dashboard"}),o.jsxs("div",{className:"menu-footer",children:[o.jsx("div",{className:"profile-divider"}),o.jsxs("div",{className:"profile-card",onMouseEnter:()=>D&&f(!0),onMouseLeave:()=>f(!1),onClick:()=>{D?f(ge=>!ge):(f(!1),s(!1),l(!0))},role:"button",tabIndex:0,onKeyDown:ge=>{(ge.key==="Enter"||ge.key===" ")&&(ge.preventDefault(),D?f(le=>!le):(s(!1),l(!0)))},children:[o.jsx("div",{className:"profile-avatar",children:we?o.jsx("img",{src:we,alt:`${Ve} avatar`,onError:()=>_e("")}):Te}),o.jsxs("div",{className:"profile-meta",children:[o.jsx("div",{className:"profile-name",children:Ve}),o.jsx("div",{className:"profile-role",children:De})]}),D&&d&&o.jsxs("div",{className:"profile-menu",children:[o.jsx("button",{type:"button",className:"profile-menu-item",onClick:ce,children:"Edit profile"}),o.jsx("button",{type:"button",className:"profile-menu-item",onClick:he,children:"Sign out"})]})]})]})]}),a&&o.jsx(XP,{onClose:()=>l(!1)}),m&&o.jsx("div",{className:"profile-edit-backdrop",children:o.jsxs("div",{className:"profile-edit-card",children:[o.jsxs("div",{className:"profile-edit-header",children:[o.jsx("h3",{children:"Edit profile"}),o.jsx("button",{type:"button",className:"profile-edit-close",onClick:()=>{y(!1),U(""),W(""),I(!1)},children:""})]}),o.jsxs("div",{className:"profile-edit-body",children:[o.jsxs("a",{className:"profile-edit-avatar clickable",href:"https://gravatar.com/profile",target:"_blank",rel:"noreferrer",title:"Manage your picture on Gravatar (opens in new tab)",children:[we?o.jsx("img",{src:we,alt:`${Ve} avatar`,onError:()=>_e("")}):Te,o.jsx("span",{className:"profile-avatar-hover-hint",children:"Change on Gravatar"})]}),o.jsxs("div",{className:"profile-edit-field",children:[o.jsx("label",{className:"profile-edit-label",htmlFor:"displayName",children:"Display name"}),o.jsxs("div",{className:"profile-edit-input-row",children:[o.jsx("input",{id:"displayName",className:"profile-edit-input",type:"text",readOnly:!ie,value:x,onChange:ge=>E(ge.target.value),maxLength:40,placeholder:"Enter display name",ref:O,onBlur:()=>{ie&&Pe()},onKeyDown:ge=>{ge.key==="Enter"&&ie&&(ge.preventDefault(),Pe())}}),o.jsx("button",{type:"button",className:"profile-edit-pencil",onClick:()=>{I(!0),U(""),setTimeout(()=>{var ge;return(ge=O.current)==null?void 0:ge.focus()},50)},"aria-label":"Edit display name",children:""})]}),o.jsx("div",{className:"profile-edit-hint",children:"Click the pencil to edit. Changes save on blur or Enter."})]})]}),o.jsxs("div",{className:"profile-connections",children:[o.jsxs("div",{className:"profile-connections-header",children:[o.jsx("span",{children:"Connections"}),X&&o.jsx("span",{className:"profile-connection-status",children:X})]}),o.jsxs("div",{className:"profile-connection-row",children:[o.jsxs("div",{className:"profile-connection-meta",children:[o.jsx("div",{className:"profile-connection-title",children:"Google"}),o.jsx("div",{className:"profile-connection-sub",children:xe(n)?"Connected":"Not connected"})]}),o.jsx("div",{className:"profile-connection-actions",children:xe(n)?o.jsx("button",{type:"button",className:"profile-connection-btn secondary",onClick:()=>H(n),disabled:z.google,children:z.google?"Removing...":"Remove"}):o.jsx("button",{type:"button",className:"profile-connection-btn",onClick:Y,disabled:z.google,children:z.google?"Connecting...":"Connect"})})]}),o.jsxs("div",{className:"profile-connection-row",children:[o.jsxs("div",{className:"profile-connection-meta",children:[o.jsx("div",{className:"profile-connection-title",children:"Discord"}),o.jsx("div",{className:"profile-connection-sub",children:xe(e)?"Connected":"Not connected"})]}),o.jsx("div",{className:"profile-connection-actions",children:xe(e)?o.jsx("button",{type:"button",className:"profile-connection-btn secondary",onClick:()=>H(e),disabled:z.discord,children:z.discord?"Removing...":"Remove"}):o.jsx("button",{type:"button",className:"profile-connection-btn",onClick:k,disabled:z.discord,children:z.discord?"Connecting...":"Connect"})})]})]}),C&&o.jsx("div",{className:"profile-edit-status",children:C}),ve&&o.jsx("div",{className:"profile-edit-status saving",children:"Saving..."}),o.jsx("div",{className:"profile-gravatar-note",children:"Profile pictures are managed through Gravatarclick the avatar to update."})]})})]})}function f_(){const n="Tyler's Collection's and Hobbies",e="",[t,s]=j.useState(""),[a,l]=j.useState(!0),d=j.useRef(null),[f,m]=j.useState("jp"),[y,x]=j.useState(1);return j.useEffect(()=>{document.title="Tyler's Collection"},[]),j.useEffect(()=>(d.current=setInterval(()=>l(E=>!E),450),()=>{d.current&&clearInterval(d.current)}),[]),j.useEffect(()=>{let E=!1;const C=W=>new Promise(z=>setTimeout(z,W)),U=async(W,z=120)=>{for(let se=1;se<=W.length;se+=1){if(E)return;s(W.slice(0,se)),await C(z)}},X=async(W,z=70)=>{for(let se=W.length;se>=0;se-=1){if(E)return;s(W.slice(0,se)),await C(z)}};return(async()=>{if(localStorage.getItem("homeTitleTyped")==="1"){m("en"),s(n),l(!1),d.current&&clearInterval(d.current);return}await C(250),m("jp"),await U(e,140),await C(6e3),await X(e,80),await C(320);const z=n;for(let se=1;se<=z.length;se+=1){if(E)return;s(z.slice(0,se)),se===4&&m("en"),await C(110)}m("en"),await C(2e3),l(!1),localStorage.setItem("homeTitleTyped","1"),d.current&&clearInterval(d.current)})(),()=>{E=!0}},[]),o.jsxs("main",{className:"page",children:[o.jsxs("header",{style:{textAlign:"center",marginTop:"32px",marginBottom:"24px"},children:[o.jsxs("h1",{style:{margin:0,fontSize:"2.2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",display:"inline-flex",alignItems:"center",gap:"6px"},children:[o.jsx("span",{children:t||" "}),o.jsx("span",{style:{width:"6px",height:"1.1em",background:"#ffb6c1",opacity:a?1:0,transition:"opacity 0.15s ease"}})]}),o.jsx("p",{style:{margin:"6px 0 0",color:"var(--text-soft)",fontSize:"0.95rem",opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"TCG":"This is my personal webpage to see what is on my shelves, wishlists, and TCG collections."}),o.jsx("div",{style:{display:"inline-flex",alignItems:"center",gap:"10px",padding:"8px 14px",borderRadius:"999px",border:"1px solid rgba(255,182,193,0.5)",background:"linear-gradient(135deg, rgba(255,182,193,0.18), rgba(43,15,29,0.9))",boxShadow:"0 8px 24px rgba(0,0,0,0.55)",marginTop:"14px",fontSize:"0.78rem",color:"#ffe6ed",letterSpacing:"0.05em",textTransform:"uppercase",fontWeight:700,opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?o.jsx("span",{style:{letterSpacing:"0.06em"},children:"          TCG"}):o.jsx("span",{style:{letterSpacing:"0.06em"},children:" Manga   Anime   Music   TCG"})})]}),o.jsxs("section",{style:{display:"grid",gridTemplateColumns:"minmax(0, 2fr) minmax(0, 3fr)",gap:"20px",marginTop:"24px"},children:[o.jsxs("article",{className:"card",children:[o.jsx("h2",{style:{marginTop:0,marginBottom:"8px",fontSize:"1.2rem",color:"#ffb6c1"},children:o.jsx("span",{style:{opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"":"About Me"})}),o.jsx("p",{style:{margin:0,color:"var(--text-soft)",fontSize:"0.9rem",lineHeight:1.5,opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"im.okTCG":"Hey, I am Tyler and I go by im.ok. I hoard manga, binge anime, and collect trading cards."}),o.jsx("p",{style:{marginTop:"10px",color:"var(--text-soft)",fontSize:"0.9rem",opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"TCG":"This site is where I track everything: volumes on my shelves, finished shows, and my TCG collection as they all slowly grow."}),o.jsxs("div",{style:{marginTop:"12px",display:"flex",flexWrap:"wrap",gap:"6px",opacity:y,transition:"opacity 0.25s ease"},children:[o.jsx("span",{className:"pill",children:f==="jp"?"":"Manga library"}),o.jsx("span",{className:"pill",children:f==="jp"?"":"My Anime List (MAL)"}),o.jsx("span",{className:"pill",children:f==="jp"?" & TCG":"Pokemon & One Piece TCG"}),o.jsx("span",{className:"pill",children:f==="jp"?"":"Data Nerd"})]})]}),o.jsxs("article",{className:"card",children:[o.jsx("h2",{style:{marginTop:0,marginBottom:"8px",fontSize:"1.2rem",color:"#ffb6c1"},children:o.jsx("span",{style:{opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Explore these pages"})}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(210px, 1fr))",gap:"14px",marginTop:"10px"},children:[o.jsxs("a",{href:"/base/manga",className:"section-card",children:[o.jsx("h3",{style:{opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Manga Library"}),o.jsx("p",{style:{opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Full manga collection & wishlist."}),o.jsx("div",{className:"section-chip-row",children:o.jsx("span",{className:"section-chip accent",style:{opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Library & wishlist"})})]}),o.jsxs("a",{href:"/base/music",className:"section-card",style:{justifySelf:"end",alignSelf:"end",order:99},children:[o.jsx("h3",{style:{opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Music"}),o.jsx("p",{style:{opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"":"If you are here for my music, this is the page for you! Catch all the latest releases."}),o.jsxs("div",{className:"section-chip-row",children:[o.jsx("span",{className:"section-chip accent",style:{opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Latest tracks"}),o.jsx("span",{className:"section-chip",style:{opacity:y,transition:"opacity 0.25s ease"},children:"Spotify & SoundCloud"})]})]}),o.jsxs("a",{href:"/base/anime",className:"section-card",children:[o.jsx("h3",{style:{opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Anime Library"}),o.jsx("p",{style:{opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"MAL":"The entire watched, plan to watch, and watching list synced directly from MyAnimeList."}),o.jsxs("div",{className:"section-chip-row",children:[o.jsx("span",{className:"section-chip accent",style:{opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"MAL":"MAL synced"}),o.jsx("span",{className:"section-chip",style:{opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Status filters"}),o.jsx("span",{className:"section-chip",style:{opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Quick stats"})]})]}),o.jsxs("a",{href:"/base/tcg",className:"section-card",children:[o.jsx("h3",{style:{opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"TCG":"TCG Collection"}),o.jsx("p",{style:{opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"TCG":"Pokemon & One Piece TCG cards tracked with quantities, prices, and value."}),o.jsxs("div",{className:"section-chip-row",children:[o.jsx("span",{className:"section-chip accent",style:{opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Full Collection"}),o.jsx("span",{className:"section-chip",style:{opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Still Under-Construction"})]})]})]})]})]}),o.jsx("footer",{style:{marginTop:"28px",fontSize:"0.78rem",color:"var(--text-soft)",textAlign:"center"},children:"@ 2025 im.ok. All rights reserved."})]})}const sR="modulepreload",iR=function(n){return"/base/"+n},p_={},yc=function(e,t,s){let a=Promise.resolve();if(t&&t.length>0){let d=function(y){return Promise.all(y.map(x=>Promise.resolve(x).then(E=>({status:"fulfilled",value:E}),E=>({status:"rejected",reason:E}))))};document.getElementsByTagName("link");const f=document.querySelector("meta[property=csp-nonce]"),m=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));a=d(t.map(y=>{if(y=iR(y),y in p_)return;p_[y]=!0;const x=y.endsWith(".css"),E=x?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${y}"]${E}`))return;const C=document.createElement("link");if(C.rel=x?"stylesheet":sR,x||(C.as="script"),C.crossOrigin="",C.href=y,m&&C.setAttribute("nonce",m),document.head.appendChild(C),x)return new Promise((U,X)=>{C.addEventListener("load",U),C.addEventListener("error",()=>X(new Error(`Unable to preload CSS for ${y}`)))})}))}function l(d){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=d,window.dispatchEvent(f),!f.defaultPrevented)throw d}return a.then(d=>{for(const f of d||[])f.status==="rejected"&&l(f.reason);return e().catch(l)})};function gw({open:n,title:e,placeholder:t,value:s,status:a,loading:l,onChange:d,onSubmit:f,onClose:m}){if(!n)return null;const y=typeof a=="string"&&a.toLowerCase().startsWith("sent!")?"#a3f0cf":"#ffb6c1";return o.jsx("div",{className:"suggestion-backdrop",onClick:x=>{x.target===x.currentTarget&&m&&m()},children:o.jsxs("div",{className:"suggestion-modal",children:[o.jsxs("div",{className:"suggestion-modal-header",children:[o.jsx("h3",{children:e}),o.jsx("button",{className:"suggestion-close",type:"button",onClick:m,"aria-label":"Close",children:"X"})]}),o.jsx("p",{className:"suggestion-hint",children:"Tell me what to add next. Titles only is fine, but extra notes are welcome."}),o.jsx("textarea",{className:"suggestion-textarea",placeholder:t,value:s,onChange:x=>d==null?void 0:d(x.target.value),maxLength:500}),a&&o.jsx("div",{className:"suggestion-status",style:{color:y},children:a}),o.jsxs("div",{className:"suggestion-actions",children:[o.jsx("button",{className:"suggestion-send",type:"button",onClick:f,disabled:l,children:l?"Sending...":"Send Suggestion"}),o.jsx("button",{className:"suggestion-cancel",type:"button",onClick:m,children:"Cancel"})]})]})})}const lm="mangaLibraryActivityLog",Va="https://discord.com/api/webhooks/1448329790942613667/wsC8psNZ-Ax2D1O9Gl4sJi6ay7df2cr7IrIdxMPwGZTBnkSUIY2NDpeVd98qW_4plz82";let Io=null;function aR(n){return Array.isArray(n)?n.map(e=>({message:e.message,ts:e.ts?new Date(e.ts):new Date,user:e.user||e.email||"",context:e.context||"",details:Array.isArray(e.details)?e.details:[]})).filter(e=>e.message):[]}function oR(){if(typeof window>"u")return[];try{const n=localStorage.getItem(lm);if(!n)return[];const e=JSON.parse(n);return aR(e)}catch(n){return console.warn("Failed to read activity log",n),[]}}function yw(n){try{const e=(n||[]).slice(0,100).map(t=>({message:t.message,ts:t.ts instanceof Date?t.ts.toISOString():t.ts,user:t.user||"",context:t.context||"",details:t.details||[]}));typeof window<"u"&&localStorage.setItem(lm,JSON.stringify(e))}catch(e){console.warn("Failed to persist activity log",e)}}async function lR(){if(Io)return Io;try{const n=Pt(st,"settings","webhooks"),e=await rc(n);if(e.exists())return Io=e.data().activity||Va,Io}catch(n){console.warn("Failed to load activity webhook",n)}return Io=Va,Io}function m_(n){if(n==null)return"";if(typeof n=="object")try{return JSON.stringify(n)}catch{return String(n)}return String(n)}function cR(n){return n?typeof n=="string"?[n]:Array.isArray(n)?n.map(e=>m_(e)):typeof n=="object"?Object.entries(n).map(([e,t])=>`${e}: ${m_(t)}`):[]:[]}async function uR(n,e={}){if(n)try{const{email:t,name:s,webhookOverride:a,context:l,list:d,action:f,detailLines:m=[]}=e,y=a||await lR();if(!y)return;const x=(s||"").trim()||t||"anonymous",E=new Date,C=Intl.DateTimeFormat().resolvedOptions().timeZone||"local time",U=[];U.push(" **Library Activity**"),U.push(` ${n}`),U.push(` ${x}       ${E.toLocaleString()} (${C})`);const X=[];l&&X.push(`Context: ${l}`),d&&X.push(`List: ${d}`),f&&X.push(`Action: ${f}`),X.length&&U.push(X.join("      ")),m.length&&(U.push(" Details:"),m.forEach(W=>U.push(` ${W}`))),await fetch(y,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:U.join(`
`)})})}catch(t){console.warn("Activity webhook failed",t)}}async function vw(n,e={}){if(!n)return null;const{email:t,name:s,webhookOverride:a,persistLocal:l=!0,context:d="",list:f="",action:m="",details:y=null}=e,x=cR(y),E={message:n,ts:new Date,user:(s||"").trim()||t||"",context:d,details:x};if(l){const C=oR(),U=[E,...C].slice(0,100);yw(U)}return await uR(n,{email:t,name:s,webhookOverride:a,context:d,list:f,action:m,detailLines:x}),E}const g_=5,dR=3600*1e3,y_="mangaSuggestionsSent",v_="mangaViewMode";function Vt(n){let e=(n||"").trim();const t=e.match(/^(.*?)(?:,?\s*(?:Vol\.|Volume)\s*(\d+)(?:\s*[--]\s*\d+)?\s*)?(?:\s*\([^)]*\))?$/i),s=t?t[1].trim().toLowerCase():e.toLowerCase(),a=t&&t[2]?parseInt(t[2],10):0;return{name:s,vol:Number.isFinite(a)?a:0}}function hR(n){if(typeof n=="number")return n;if(n==null||n==="")return 0;const e=parseInt(n,10);return Number.isFinite(e)?e:0}function __(){const n=new Date,e=n.getFullYear(),t=String(n.getMonth()+1).padStart(2,"0"),s=String(n.getDate()).padStart(2,"0");return`${e}-${t}-${s}`}function No(n){const e=(n==null?void 0:n.pageCount)??(n==null?void 0:n.PageCount)??"",t=String(e??"").trim();if(!t)return!0;const s=hR(t);return!Number.isFinite(s)||s<=0}function Kt(n,e=!1){const t=(n??"").toString().trim();return!t||!e&&t.toLowerCase()==="unknown"}function bu(n,e={}){const t=e.includeIsbn??!1,s=e.includeFinance??!1,a=((n==null?void 0:n.specialType)||"").toLowerCase()==="collectible"||((n==null?void 0:n.SpecialType)||"").toLowerCase()==="collectible",l=Kt(n==null?void 0:n.authors),d=Kt(n==null?void 0:n.publisher),f=Kt(n==null?void 0:n.date),m=t?Kt(n==null?void 0:n.isbn):!1,y=s&&!a?Kt(n==null?void 0:n.amountPaid):!1,x=s&&a?Kt(n==null?void 0:n.collectiblePrice):!1,E=s?Kt((n==null?void 0:n.msrp)??(n==null?void 0:n.MSRP)):!1,C=s?Kt(n==null?void 0:n.datePurchased):!1;return{authorMissing:l,publisherMissing:d,dateMissing:f,isbnMissing:m,amountMissing:y,collectibleMissing:x,msrpMissing:E,purchaseMissing:C,any:l||d||f||m||y||x||E||C}}function Rr(n){if(!n)return"";const e=String(n).trim();if(/^\d{4}-\d{2}-\d{2}$/.test(e))return e;const t=new Date(e);if(Number.isNaN(t.getTime()))return"";const s=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),l=String(t.getDate()).padStart(2,"0");return`${s}-${a}-${l}`}const fR=(n,e)=>{const t=Vt(n.title||""),s=Vt(e.title||""),a=t.name.localeCompare(s.name);return a!==0?a:t.vol-s.vol};function pR(n){const t=(n||"").match(/vol(?:ume)?\.?\s*(\d+)(?:\s*[-]\s*(\d+))?/i);if(!t)return[];const s=parseInt(t[1],10),a=t[2]?parseInt(t[2],10):s;if(!Number.isFinite(s))return[];const l=Number.isFinite(a)&&a>=s?a:s,d=[];for(let f=s;f<=l;f+=1)d.push(f);return d}function mR(){const{admin:n,user:e,role:t}=Qa(),s=n,a=(w,B={})=>{w&&vw(w,{email:(e==null?void 0:e.email)||"anonymous",name:(e==null?void 0:e.displayName)||"",context:"Manga",...B})},[l,d]=j.useState("library"),[f,m]=j.useState(()=>typeof window>"u"?"series":localStorage.getItem(v_)==="individual"?"individual":"series");j.useEffect(()=>{ge("")},[e]),j.useEffect(()=>{try{localStorage.setItem(v_,f)}catch(w){console.warn("Failed to persist manga view mode",w)}},[f]);const y=async()=>{const w=Date.now(),F=(()=>{try{const M=localStorage.getItem(y_);return Array.isArray(JSON.parse(M))?JSON.parse(M):[]}catch{return[]}})().filter(M=>w-M<dR);if(F.length>=g_){ge("Rate limit: please wait a bit (max 5 suggestions per hour).");return}if(!Oe.trim()){ge("Please enter a manga title or note before sending.");return}Me(!0),ge("");try{const M=`**Manga Suggestion**
${Oe.trim()}
From: ${(e==null?void 0:e.displayName)||(e==null?void 0:e.email)||(e==null?void 0:e.uid)||"anonymous user"}`;await Oa(bn(st,"suggestions"),{content:Oe.trim(),type:"manga",from:(e==null?void 0:e.displayName)||(e==null?void 0:e.email)||(e==null?void 0:e.uid)||"anonymous user",createdAt:new Date().toISOString()}),ge("Sent! I'll review your suggestion soon."),Qe("");const G=[...F,w].slice(-g_);localStorage.setItem(y_,JSON.stringify(G))}catch(M){console.error("Failed to send suggestion",M),ge("Failed to send suggestion. Please try again later.")}finally{Me(!1)}},[x,E]=j.useState([]),[C,U]=j.useState([]),[X,W]=j.useState([]),[z,se]=j.useState([]),[we,_e]=j.useState(!1),[ve,L]=j.useState(!0),[ie,I]=j.useState(""),[N,A]=j.useState(""),[O,D]=j.useState(""),[P,b]=j.useState(!1),[J,re]=j.useState(()=>new Set);j.useEffect(()=>{f==="series"&&P&&(typeof Ye>"u"||Ye===null)&&(b(!1),re(new Set))},[f,P]);const[Ie,he]=j.useState({open:!1,mode:"add",list:"library",data:{title:"",authors:"",publisher:"",demographic:"",genre:"",subGenre:"",date:"",cover:"",isbn:"",pageCount:"",rating:"",amountPaid:"",dateRead:"",datePurchased:"",msrp:"",special:!1,specialType:"",specialVolumes:"",collectiblePrice:"",amazonURL:"",read:!1},editingId:null,multiAdd:!1,startVol:"",endVol:""}),[ce,Pe]=j.useState([]),[xe,Y]=j.useState(0),k=j.useMemo(()=>{const w=Ie.list==="library",B=w&&Ie.data.special&&Ie.data.specialType==="collectible",F=w&&!B;return{author:Kt(Ie.data.authors),publisher:Kt(Ie.data.publisher),date:Kt(Ie.data.date),purchaseDate:w?Kt(Ie.data.datePurchased):!1,page:No({pageCount:Ie.data.pageCount}),isbn:w?Kt(Ie.data.isbn):!1,amountPaid:F?Kt(Ie.data.amountPaid):!1,collectiblePrice:B?Kt(Ie.data.collectiblePrice):!1,msrp:w?Kt(Ie.data.msrp):!1}},[Ie.data,Ie.list]),[H,Te]=j.useState({open:!1,index:0,items:[]}),[Ve,De]=j.useState(!1),[Oe,Qe]=j.useState(""),[nt,ge]=j.useState(""),[le,Me]=j.useState(!1),[pe,qe]=j.useState(null),[Ye,It]=j.useState(null);j.useEffect(()=>{const w="Manga | Library";if(!s){document.title=w;return}const B=[...x,...C].reduce((F,M)=>{const G=No(M),me=bu(M,{includeIsbn:M.kind==="library",includeFinance:M.kind==="library"});return F+(G||me.any?1:0)},0);document.title=B>0?`(${B}) ${w}`:w},[s,x,C]),j.useEffect(()=>{if(!!pe||!!Ye||Ie.open||H.open||Ve){const B=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=B}}},[pe,Ye,Ie.open,H.open,Ve]);const At=!!e&&t==="viewer";async function wt(){const w=await Is(bn(st,"library")),B=[];w.forEach(F=>{const M=F.data();B.push({id:F.id,title:M.title||"",authors:M.authors||"Unknown",publisher:M.publisher||"Unknown",demographic:M.demographic||"",genre:M.genre||"",subGenre:M.subGenre||"",date:Rr(M.date)||M.date||"Unknown",cover:M.cover||"",isbn:M.isbn||"",pageCount:M.pageCount!==void 0&&M.pageCount!==null?M.pageCount:"",rating:M.rating!==void 0&&M.rating!==null?M.rating:"",amountPaid:M.amountPaid!==void 0&&M.amountPaid!==null?M.amountPaid:"",dateRead:Rr(M.dateRead)||M.dateRead||"",datePurchased:Rr(M.datePurchased)||M.datePurchased||"",msrp:M.msrp!==void 0&&M.msrp!==null?M.msrp:"",specialType:M.specialType||"",specialVolumes:M.specialVolumes!==void 0&&M.specialVolumes!==null?M.specialVolumes:"",collectiblePrice:M.collectiblePrice!==void 0&&M.collectiblePrice!==null?M.collectiblePrice:"",read:!!M.read,amazonURL:M.amazonURL||"",hidden:!!M.hidden,kind:"library"})}),B.sort((F,M)=>{const G=Vt(F.title),me=Vt(M.title),ne=G.name.localeCompare(me.name);return ne!==0?ne:G.vol-me.vol}),E(B),W(F=>{const M=new Set(F);return B.forEach(G=>M.add(G.title||"")),Array.from(M).filter(Boolean).sort()})}async function jt(){const w=await Is(bn(st,"wishlist")),B=[];w.forEach(F=>{const M=F.data();B.push({id:F.id,title:M.title||"",authors:M.authors||"Unknown",publisher:M.publisher||"Unknown",date:Rr(M.date)||M.date||"Unknown",cover:M.cover||"",isbn:M.isbn||"",pageCount:M.pageCount!==void 0&&M.pageCount!==null?M.pageCount:"",rating:M.rating!==void 0&&M.rating!==null?M.rating:"",amountPaid:M.amountPaid!==void 0&&M.amountPaid!==null?M.amountPaid:"",datePurchased:Rr(M.datePurchased)||M.datePurchased||"",specialType:M.specialType||"",specialVolumes:M.specialVolumes!==void 0&&M.specialVolumes!==null?M.specialVolumes:"",collectiblePrice:M.collectiblePrice!==void 0&&M.collectiblePrice!==null?M.collectiblePrice:"",amazonURL:M.amazonURL||"",hidden:!!M.hidden,kind:"wishlist"})}),B.sort((F,M)=>{const G=Vt(F.title),me=Vt(M.title),ne=G.name.localeCompare(me.name);return ne!==0?ne:G.vol-me.vol}),U(B),W(F=>{const M=new Set(F);return B.forEach(G=>M.add(G.title||"")),Array.from(M).filter(Boolean).sort()})}j.useEffect(()=>{let w=!1,B=!1,F=!1;const M=async()=>{if(!w)try{const Se=await fetch("/base/manga-library-wishlist.json",{cache:"no-cache"});if(!Se.ok)throw new Error("fallback fetch failed");const We=await Se.json(),de=Array.isArray(We.library)?We.library:[],Je=Array.isArray(We.wishlist)?We.wishlist:[];E(de.map((Re,ht)=>({id:Re.id||`offline-lib-${ht}`,title:Re.title||"",authors:Re.authors||"Unknown",publisher:Re.publisher||"Unknown",demographic:Re.demographic||"",genre:Re.genre||"",subGenre:Re.subGenre||"",date:Rr(Re.date)||Re.date||"Unknown",cover:Re.cover||"",isbn:Re.isbn||"",pageCount:Re.pageCount??"",rating:Re.rating??"",amountPaid:Re.amountPaid??"",dateRead:Rr(Re.dateRead)||Re.dateRead||"",datePurchased:Rr(Re.datePurchased)||Re.datePurchased||"",msrp:Re.msrp??"",specialType:Re.specialType||"",specialVolumes:Re.specialVolumes??"",collectiblePrice:Re.collectiblePrice??"",amazonURL:Re.amazonURL||"",read:!!Re.read,hidden:!!Re.hidden,kind:"library"}))),U(Je.map((Re,ht)=>({id:Re.id||`offline-wish-${ht}`,title:Re.title||"",authors:Re.authors||"Unknown",publisher:Re.publisher||"Unknown",demographic:Re.demographic||"",genre:Re.genre||"",subGenre:Re.subGenre||"",date:Rr(Re.date)||Re.date||"Unknown",cover:Re.cover||"",isbn:Re.isbn||"",pageCount:Re.pageCount??"",rating:Re.rating??"",amountPaid:Re.amountPaid??"",dateRead:Rr(Re.dateRead)||Re.dateRead||"",datePurchased:Rr(Re.datePurchased)||Re.datePurchased||"",msrp:Re.msrp??"",specialType:Re.specialType||"",specialVolumes:Re.specialVolumes??"",collectiblePrice:Re.collectiblePrice??"",amazonURL:Re.amazonURL||"",read:!!Re.read,hidden:!!Re.hidden,kind:"wishlist"}))),I("")}catch(je){console.error("Offline fallback failed",je),I("Failed to load manga data from Firestore.")}finally{w||L(!1)}},G=()=>{B&&F&&!w&&L(!1)};L(!0),I("");const me=d_(bn(st,"library"),je=>{if(w)return;const Se=[];je.forEach(We=>{const de=We.data();Se.push({id:We.id,title:de.title||"",authors:de.authors||"Unknown",publisher:de.publisher||"Unknown",demographic:de.demographic||"",genre:de.genre||"",subGenre:de.subGenre||"",date:de.date||"Unknown",cover:de.cover||"",isbn:de.isbn||"",pageCount:de.pageCount!==void 0&&de.pageCount!==null?de.pageCount:"",rating:de.rating!==void 0&&de.rating!==null?de.rating:"",amountPaid:de.amountPaid!==void 0&&de.amountPaid!==null?de.amountPaid:"",dateRead:de.dateRead||"",datePurchased:de.datePurchased||"",msrp:de.msrp!==void 0&&de.msrp!==null?de.msrp:"",specialType:de.specialType||"",specialVolumes:de.specialVolumes!==void 0&&de.specialVolumes!==null?de.specialVolumes:"",collectiblePrice:de.collectiblePrice!==void 0&&de.collectiblePrice!==null?de.collectiblePrice:"",read:!!de.read,amazonURL:de.amazonURL||"",hidden:!!de.hidden,kind:"library"})}),Se.sort((We,de)=>{const Je=Vt(We.title),Re=Vt(de.title),ht=Je.name.localeCompare(Re.name);return ht!==0?ht:Je.vol-Re.vol}),E(Se),W(We=>{const de=new Set(We);return Se.forEach(Je=>de.add(Je.title||"")),Array.from(de).filter(Boolean).sort()}),B=!0,G()},async je=>{console.error("Library listener failed",je),w||(I("Failed to load manga data from Firestore."),await M())}),ne=d_(bn(st,"wishlist"),je=>{if(w)return;const Se=[];je.forEach(We=>{const de=We.data();Se.push({id:We.id,title:de.title||"",authors:de.authors||"Unknown",publisher:de.publisher||"Unknown",demographic:de.demographic||"",genre:de.genre||"",subGenre:de.subGenre||"",date:de.date||"Unknown",cover:de.cover||"",isbn:de.isbn||"",pageCount:de.pageCount!==void 0&&de.pageCount!==null?de.pageCount:"",rating:de.rating!==void 0&&de.rating!==null?de.rating:"",amountPaid:de.amountPaid!==void 0&&de.amountPaid!==null?de.amountPaid:"",datePurchased:de.datePurchased||"",specialType:de.specialType||"",specialVolumes:de.specialVolumes!==void 0&&de.specialVolumes!==null?de.specialVolumes:"",collectiblePrice:de.collectiblePrice!==void 0&&de.collectiblePrice!==null?de.collectiblePrice:"",amazonURL:de.amazonURL||"",hidden:!!de.hidden,kind:"wishlist"})}),Se.sort((We,de)=>{const Je=Vt(We.title),Re=Vt(de.title),ht=Je.name.localeCompare(Re.name);return ht!==0?ht:Je.vol-Re.vol}),U(Se),W(We=>{const de=new Set(We);return Se.forEach(Je=>de.add(Je.title||"")),Array.from(de).filter(Boolean).sort()}),F=!0,G()},async je=>{console.error("Wishlist listener failed",je),w||(I("Failed to load manga data from Firestore."),await M())});return()=>{w=!0,me==null||me(),ne==null||ne()}},[e]);const sn=j.useMemo(()=>{const w=N.trim().toLowerCase();return w?x.filter(B=>[B.title,B.authors,B.publisher,B.isbn,B.date,String(B.pageCount??"")].join(" ").toLowerCase().includes(w)):x},[x,N]),un=j.useMemo(()=>s&&we?sn:sn.filter(w=>!w.hidden),[sn,s,we]),Fn=j.useMemo(()=>{const w=O.trim().toLowerCase();return w?C.filter(B=>[B.title,B.authors,B.publisher,B.isbn,B.date,String(B.pageCount??"")].join(" ").toLowerCase().includes(w)):C},[C,O]),lr=j.useMemo(()=>s&&we?Fn:Fn.filter(w=>!w.hidden),[Fn,s,we]),Gt=w=>{m(w==="individual"?"individual":"series"),re(new Set),b(!1)},Kn=w=>{if(!(w!=null&&w.length))return;const B=(F,M)=>{let G=[...F];return w.filter(me=>me.target===M).forEach(me=>{const ne=G.findIndex(Se=>Se.id===me.id),je={...ne>=0?G[ne]:{},...me.payload,id:me.id,kind:M};ne>=0?G[ne]=je:G.push(je)}),G.sort(fR),G};E(F=>B(F,"library")),U(F=>B(F,"wishlist"))},Ft=w=>{b(B=>{const F=!B;if(F){const M=new Set((w||[]).map(G=>G.id));re(G=>new Set([...G].filter(me=>M.has(me))))}else re(new Set);return F})};function Ut(){s&&(b(w=>!w),re(new Set))}function dn(w){re(B=>{const F=new Set(B);return F.has(w)?F.delete(w):F.add(w),F})}async function Qn(w,B=null){if(!s){alert("Multi-select actions require admin access.");return}const F=Array.from(J);if(!F.length){alert("Select at least one item first.");return}const M=l==="library"?"library":"wishlist",G=B||(M==="library"?"wishlist":"library"),me=M==="library";try{if(w==="move"){const ne=M==="library"?x:C;if(!window.confirm(`Move ${F.length} item(s) from ${M==="library"?"Library":"Wishlist"} to ${G==="library"?"Library":"Wishlist"}?`))return;for(const je of F){const Se=ne.find(de=>de.id===je);if(!Se)continue;const We=G==="library"?{title:Se.title,authors:Se.authors,publisher:Se.publisher,date:Se.date,pageCount:Se.pageCount||"",cover:Se.cover,amountPaid:"",read:!1,rating:"",msrp:"",collectiblePrice:"",specialType:"",specialVolumes:"",isbn:Se.isbn||"",demographic:Se.demographic||"",genre:Se.genre||"",subGenre:Se.subGenre||"",hidden:!!Se.hidden,datePurchased:Se.datePurchased||"",dateRead:Se.dateRead||""}:{title:Se.title,authors:Se.authors,publisher:Se.publisher,date:Se.date,pageCount:Se.pageCount||"",cover:Se.cover,amazonURL:Se.amazonURL||"",hidden:!!Se.hidden,datePurchased:"",read:!1,rating:"",msrp:"",collectiblePrice:"",specialType:"",specialVolumes:"",isbn:"",demographic:"",genre:"",subGenre:""};if(G==="library"&&(We.msrp===""||We.msrp===null)){const de=Kr(Se);de!==""&&de!==null&&de!==void 0&&(We.msrp=de)}await Oa(bn(st,G),We),await Ma(Pt(st,M,je))}a(`Moved ${F.length} item${F.length===1?"":"s"} from ${M==="library"?"Library":"Wishlist"} to ${G==="library"?"Library":"Wishlist"}`,{action:"move",list:M==="library"?"Library":"Wishlist",details:{count:F.length,from:M,to:G}})}else if(w==="markRead"&&me){for(const ne of F)await Ns(Pt(st,"library",ne),{read:!0,dateRead:__()});a(`Marked ${F.length} library book${F.length===1?"":"s"} as read`,{action:"markRead",list:"Library",details:{count:F.length}})}else if(w==="markUnread"&&me){for(const ne of F)await Ns(Pt(st,"library",ne),{read:!1,dateRead:"",rating:""});a(`Marked ${F.length} library book${F.length===1?"":"s"} as unread`,{action:"markUnread",list:"Library",details:{count:F.length}})}else if(w==="delete"){const ne=me?"library":"wishlist";if(!window.confirm(`Delete ${F.length} item(s) from ${me?"Library":"Wishlist"}?`))return;for(const je of F)await Ma(Pt(st,ne,je));a(`Deleted ${F.length} item${F.length===1?"":"s"} from ${ne==="library"?"Library":"Wishlist"}`,{action:"delete-multi",list:ne==="library"?"Library":"Wishlist",details:{count:F.length}})}await Promise.all([wt(),jt()]),re(new Set),b(!1)}catch(ne){console.error(ne),alert("Failed to apply multi-select action.")}}function In(w){qe(w)}function Yn(){qe(null)}function Dr(w){const B=Zt.filter(F=>(Vt(F.title||"").name||(F.title||"").toLowerCase()||F.id)===w.key).sort((F,M)=>Vt(F.title).vol-Vt(M.title).vol);It({series:w,volumes:B})}function ds(){It(null)}const cr=()=>{he(w=>({...w,open:!1,mode:"add",editingId:null,data:{title:"",authors:"",publisher:"",demographic:"",genre:"",subGenre:"",date:"",cover:"",isbn:"",pageCount:"",rating:"",amountPaid:"",dateRead:"",datePurchased:"",msrp:"",special:!1,specialType:"",specialVolumes:"",collectiblePrice:"",amazonURL:"",read:!1,hidden:!1},multiAdd:!1,startVol:"",endVol:""})),Pe([]),Y(0)},Un=j.useMemo(()=>{const w=new Map;return[...x,...C].forEach(B=>{const F=Vt(B.title||"");if(!F.name)return;const M=(B.title||"").replace(/,?\s*Vol\.?\s*\d+.*/i,"").trim()||B.title||F.name;if(!w.has(F.name))w.set(F.name,{display:M,maxVol:F.vol,authors:B.authors||"",publisher:B.publisher||"",demographic:B.demographic||""});else{const G=w.get(F.name);G.maxVol=Math.max(G.maxVol,F.vol),!G.authors&&B.authors&&(G.authors=B.authors),!G.publisher&&B.publisher&&(G.publisher=B.publisher),!G.demographic&&B.demographic&&(G.demographic=B.demographic)}}),w},[x,C]),Vr=w=>{he(B=>({...B,open:!0,mode:"add",list:w,editingId:null,data:{...B.data,title:"",list:w}})),Pe([{kind:"new",id:null,data:{title:"",authors:"",publisher:"",demographic:"",genre:"",subGenre:"",date:"",cover:"",isbn:"",pageCount:"",rating:"",amountPaid:"",dateRead:"",datePurchased:"",msrp:"",specialType:"",specialVolumes:"",collectiblePrice:"",amazonURL:"",read:!1}}]),Y(0)},_r=w=>{const B={open:!0,mode:"edit",list:w.kind==="wishlist"?"wishlist":"library",editingId:w.id,data:{title:w.title||"",authors:w.authors||"",publisher:w.publisher||"",demographic:w.demographic||"",genre:w.genre||"",subGenre:w.subGenre||"",date:w.date||"",cover:w.cover||"",isbn:w.isbn||"",pageCount:w.pageCount||"",rating:w.rating||"",amountPaid:w.amountPaid||"",dateRead:w.dateRead||"",datePurchased:w.datePurchased||"",msrp:w.msrp||"",special:!!(w.specialType||w.specialVolumes||w.collectiblePrice),specialType:w.specialType||"",specialVolumes:w.specialVolumes||"",collectiblePrice:w.collectiblePrice||"",amazonURL:w.amazonURL||"",read:!!w.read,hidden:!!w.hidden}};he(B),Pe([{kind:"edit",id:w.id,data:{...B.data}}]),Y(0)},dt=(w,B,F="text")=>{if(he(M=>{const G={...M.data,[w]:F==="checkbox"?!!B:B};if(w==="special"&&!B&&(G.specialType="",G.specialVolumes="",G.collectiblePrice=""),w==="specialType"&&(B==="collectible"?G.specialVolumes="":(B==="specialEdition"||(G.specialVolumes=""),G.collectiblePrice="")),w==="title"){const me=Vt(B||"");if(me.name&&Un.has(me.name)){const ne=Un.get(me.name);G.authors=ne.authors||G.authors,G.publisher=ne.publisher||G.publisher,G.demographic=ne.demographic||G.demographic}}return{...M,data:G}}),Pe(M=>{if(!M.length)return M;const G=[...M],me={...G[xe]};return me.data={...me.data,[w]:F==="checkbox"?!!B:B},G[xe]=me,G}),w==="title"){const M=String(B||"").trim().toLowerCase();if(!M)se([]);else{const G=[];Un.forEach(me=>{if(me.display.toLowerCase().includes(M)){const ne=me.maxVol>0?me.maxVol+1:1;G.push(`${me.display}, Vol. ${ne}`)}}),se(G.slice(0,6))}}},Wr=w=>{ce[w]&&(Y(w),he(B=>{const F=ce[w];return{...B,data:{...F.data}}}))},Jn=()=>{const w=Ie.data.title||"",B=Vt(w);if(!B.name){alert("Provide a title with a volume number first (e.g., Series, Vol. 1).");return}const F={kind:Ie.mode,id:Ie.editingId,data:{...Ie.data}},M=ce.length?[...ce]:[];M.length?M[xe]=F:M.push(F);const G=w.replace(/,?\s*Vol\.?\s*\d+.*/i,"").trim()||w;let me=B.vol||0;const ne=Un.get(B.name);ne&&ne.maxVol>me&&(me=ne.maxVol),M.forEach(de=>{const Je=Vt(de.data.title||"");Je.name===B.name&&(me=Math.max(me,Je.vol||0))});const je=(me||0)+1,We={title:`${G}, Vol. ${je}`,authors:Ie.data.authors,publisher:Ie.data.publisher,demographic:Ie.data.demographic,genre:Ie.data.genre,subGenre:Ie.data.subGenre,msrp:Ie.data.msrp,hidden:Ie.data.hidden,cover:"",isbn:"",pageCount:"",rating:"",amountPaid:"",date:"",dateRead:"",datePurchased:"",special:!1,specialType:"",specialVolumes:"",collectiblePrice:"",amazonURL:"",read:!1};M.push({kind:"new",id:null,data:We}),Pe(M),Y(M.length-1),he(de=>({...de,mode:"add",data:We}))};async function vn(){if(!s)return;const{list:w}=Ie,B=w||"library",F=ce.length>0?ce:[{kind:Ie.mode,id:Ie.editingId,data:Ie.data}],M=G=>{const me=(G.title||"").trim(),ne=Vt(me),je=Un.get(ne.name)||{},Se=(G.authors||"").trim()||je.authors||"",We=(G.publisher||"").trim()||je.publisher||"",de=(G.demographic||"").trim()||je.demographic||"",Je=(G.genre||"").trim()||je.genre||"",Re=(G.subGenre||"").trim()||je.subGenre||"";return{title:me,authors:Se,publisher:We,demographic:de,genre:Je,subGenre:Re,date:Rr(G.date||""),cover:(G.cover||"").trim(),isbn:B==="wishlist"?"":(G.isbn||"").trim(),pageCount:G.pageCount===""?"":Number(G.pageCount),rating:B==="wishlist"||G.rating===""?"":Math.max(.5,Math.min(5,Number(G.rating))),amountPaid:G.amountPaid===""?"":Number(G.amountPaid),dateRead:Rr(G.dateRead||""),datePurchased:Rr(G.datePurchased||""),msrp:B==="wishlist"||G.msrp===""?"":Number(G.msrp),special:B==="wishlist"?!1:!!(G.special&&(G.specialType||"").trim()),specialType:B==="wishlist"||!(G.special&&(G.specialType||"").trim())?"":(G.specialType||"").trim(),specialVolumes:B==="wishlist"?"":G.special&&G.specialType==="specialEdition"?G.specialVolumes===""?"":Number(G.specialVolumes):"",collectiblePrice:B==="wishlist"?"":G.special&&G.specialType==="collectible"?G.collectiblePrice===""?"":Number(G.collectiblePrice):"",amazonURL:(G.amazonURL||"").trim(),read:B==="wishlist"?!1:!!G.read,hidden:!!G.hidden,kind:w}};try{const G=await Promise.all(F.map(async me=>{const ne=M(me.data);if(B==="library"&&me.kind!=="edit"){const je=Vt(ne.title).name,Se=x.filter(de=>Vt(de.title||de.Title||"").name===je),We=Se[0];if(We&&(ne.demographic=ne.demographic||We.demographic||We.Demographic||"",ne.genre=ne.genre||We.genre||We.Genre||"",ne.subGenre=ne.subGenre||We.subGenre||We.SubGenre||"",ne.msrp==="")){const de=Se.map(Je=>Number(Je.msrp??Je.MSRP)).filter(Je=>Number.isFinite(Je));de.length>0&&de.every(Re=>Re===de[0])&&(ne.msrp=de[0])}}if(!ne.title)throw alert("Title is required for every entry."),new Error("missing title");if(me.kind==="edit"&&me.id)return await Ns(Pt(st,B,me.id),ne),{target:B,id:me.id,payload:ne};{const je=await Oa(bn(st,B),ne);return{target:B,id:je.id,payload:ne}}}));Kn(G.filter(Boolean)),await Promise.all([wt(),jt()]),a(`${Ie.mode==="add"?"Added":"Saved"} ${F.length} item${F.length===1?"":"s"} in ${B==="library"?"Library":"Wishlist"}`,{action:Ie.mode==="add"?"create":"update",list:B==="library"?"Library":"Wishlist",details:{entries:F.length,mode:Ie.mode}}),cr()}catch(G){console.error(G),alert("Failed to save entry.")}}async function zn(w,B){if(!s||!window.confirm("Delete this entry?"))return;const M=(B==="wishlist"?C:x).find(G=>G.id===w);try{await Ma(Pt(st,B,w)),await Promise.all([wt(),jt()]),a(`Deleted "${(M==null?void 0:M.title)||"Untitled"}" from ${B==="library"?"Library":"Wishlist"}`,{action:"delete-single",list:B==="library"?"Library":"Wishlist",details:{title:(M==null?void 0:M.title)||"Untitled"}})}catch(G){console.error(G),alert("Failed to delete entry.")}}const[hs,Nn]=j.useState(!1),xr=()=>Te({open:!1,index:0,items:[]});async function Gr(w,B,F={}){if(!(w!=null&&w.id))return;const M=w.kind==="wishlist"?"wishlist":"library";Nn(!0);try{await Ns(Pt(st,M,w.id),B),Kn([{target:M,id:w.id,payload:B}]),await Promise.all([wt(),jt()]),a(`Updated "${w.title||"Untitled"}" in ${M==="library"?"Library":"Wishlist"}`,{action:F.action||"inline-update",list:M==="library"?"Library":"Wishlist",details:F.details||{title:w.title||"Untitled",fields:Object.keys(B||{}).join(", "),rating:B.rating??void 0}}),qe(G=>G&&G.id===w.id?{...G,...B}:G)}catch(G){console.error(G),alert("Failed to update entry.")}finally{Nn(!1)}}const qr=(w,B)=>{const F=B===""?"":Math.max(.5,Math.min(5,Number(B)));Gr(w,{rating:F},{action:"rating",details:{title:w.title||"Untitled",rating:F}})},wr=(w,B)=>{if(!w)return;const F=B?{read:!0,dateRead:__(),rating:w.rating??""}:{read:!1,dateRead:"",rating:""};Gr(w,F,{action:B?"mark-read":"mark-unread",details:{title:w.title||"Untitled",dateRead:B?F.dateRead:"cleared",rating:w.rating||"not set"}})},js=()=>{if(!J.size){alert("Select at least one entry first.");return}const B=[...x,...C].filter(M=>J.has(M.id));if(!B.length){alert("No items selected.");return}const F=B.map(M=>({id:M.id,kind:M.kind||(l==="wishlist"?"wishlist":"library"),data:{title:M.title||"",authors:M.authors||"",publisher:M.publisher||"",demographic:M.demographic||"",genre:M.genre||"",subGenre:M.subGenre||"",date:M.date||"",cover:M.cover||"",isbn:M.isbn||"",pageCount:M.pageCount||"",rating:M.rating||"",amountPaid:M.amountPaid||"",dateRead:M.dateRead||"",datePurchased:M.datePurchased||"",msrp:M.msrp||"",special:!!(M.specialType||M.specialVolumes||M.collectiblePrice),specialType:M.specialType||"",specialVolumes:M.specialVolumes||"",collectiblePrice:M.collectiblePrice||"",amazonURL:M.amazonURL||"",read:!!M.read,hidden:!!M.hidden}}));Te({open:!0,index:0,items:F})},ot=(w,B,F="text")=>{Te(M=>{const G=[...M.items],me={...G[M.index]},ne={...me.data,[w]:F==="checkbox"?!!B:B};return w==="special"&&!B&&(ne.specialType="",ne.specialVolumes="",ne.collectiblePrice=""),w==="specialType"&&(B==="collectible"?ne.specialVolumes="":(B==="specialEdition"||(ne.specialVolumes=""),ne.collectiblePrice="")),me.data=ne,G[M.index]=me,{...M,items:G}})},Hr=()=>{Te(w=>({...w,index:Math.min(w.index+1,w.items.length-1)}))},Pn=()=>{Te(w=>({...w,index:Math.max(w.index-1,0)}))};async function fs(){if(!s)return;const w=H.items;if(!w.length){xr();return}try{const B=await Promise.all(w.map(async F=>{const G=!(F.kind==="wishlist")&&!!(F.data.special&&(F.data.specialType||"").trim()),me={...F.data,pageCount:F.data.pageCount===""?"":Number(F.data.pageCount),rating:F.data.rating===""?"":Math.max(.5,Math.min(5,Number(F.data.rating))),amountPaid:F.data.amountPaid===""?"":Number(F.data.amountPaid),msrp:F.data.msrp===""?"":Number(F.data.msrp),special:G,specialType:G?F.data.specialType:"",collectiblePrice:G&&F.data.specialType==="collectible"?F.data.collectiblePrice===""?"":Number(F.data.collectiblePrice):"",specialVolumes:G&&F.data.specialType==="specialEdition"?F.data.specialVolumes===""?"":Number(F.data.specialVolumes):"",datePurchased:F.data.datePurchased||"",amazonURL:F.data.amazonURL||"",read:!!F.data.read},ne=F.kind==="wishlist"?"wishlist":"library";return await Ns(Pt(st,ne,F.id),me),{target:ne,id:F.id,payload:me}}));Kn(B.filter(Boolean)),await Promise.all([wt(),jt()]),re(new Set),b(!1),a(`Bulk edited ${w.length} item${w.length===1?"":"s"} in Library/Wishlist`,{action:"bulk-edit",list:"Library/Wishlist",details:{count:w.length}}),xr()}catch(B){console.error(B),alert("Failed to save bulk edits.")}}const Xn=w=>{const B=new Map;return w.forEach(F=>{const M=Vt(F.title||""),G=M.name||(F.title||"").toLowerCase()||F.id,me=Un.get(M.name)||null,ne=(me==null?void 0:me.display)||(F.title||"").replace(/,?\s*Vol\.?\s*\d+.*/i,"").trim()||F.title||"Untitled",je=bu(F,{includeIsbn:F.kind==="library",includeFinance:F.kind==="library"}),Se=pR(F.title||""),We=Number.isFinite(M.vol)?M.vol:0,de=Se.length>0?Se:We>0?[We]:[],Je=de.length?de[0]:0,Re=No(F);if(!B.has(G))B.set(G,{id:`series-${G}`,key:G,title:ne,authors:F.authors&&F.authors!=="Unknown"?F.authors:(me==null?void 0:me.authors)||"",publisher:F.publisher&&F.publisher!=="Unknown"?F.publisher:(me==null?void 0:me.publisher)||"",demographic:(me==null?void 0:me.demographic)||F.demographic||"",cover:F.cover||"",count:1,readCount:F.read?1:0,minVol:Je,maxVol:Je,representative:F,volumes:[...de],missingPageCount:Re?1:0,missingMetaCount:je.any?1:0,missingVolumeCount:Re||je.any?1:0});else{const ht=B.get(G);if(ht.count+=1,F.read&&(ht.readCount+=1),Re&&(ht.missingPageCount+=1),je.any&&(ht.missingMetaCount+=1),(Re||je.any)&&(ht.missingVolumeCount+=1),de.length){const Vs=Math.min(...de),hr=Math.max(...de);ht.minVol=Math.min(ht.minVol,Vs),ht.maxVol=Math.max(ht.maxVol,hr),ht.volumes.push(...de)}!ht.cover&&F.cover&&(ht.cover=F.cover),!ht.authors&&F.authors&&F.authors!=="Unknown"&&(ht.authors=F.authors),!ht.publisher&&F.publisher&&F.publisher!=="Unknown"&&(ht.publisher=F.publisher)}}),Array.from(B.values())},ks=w=>{const B=Array.from(new Set((w||[]).filter(ne=>Number.isFinite(ne)&&ne>=0))).sort((ne,je)=>ne-je);if(!B.length)return null;const F=[];let M=B[0],G=B[0];for(let ne=1;ne<B.length;ne+=1){const je=B[ne];if(je===G+1){G=je;continue}F.push([M,G]),M=je,G=je}if(F.push([M,G]),F.length===1){const[ne,je]=F[0];return ne===je?`Vol. ${ne}`:`Vol. ${ne}-${je}`}return`Vols. ${F.map(([ne,je])=>ne===je?`${ne}`:`${ne}-${je}`).join(", ")}`};function ur(w){const B=J.has(w.id),F=w.kind==="library",M=s&&No(w),G=s?bu(w,{includeIsbn:F,includeFinance:F}):{any:!1,authorMissing:!1,publisherMissing:!1,dateMissing:!1,isbnMissing:!1},me=()=>{P&&s?dn(w.id):In(w)};return o.jsxs("div",{className:"manga-card"+(w.read&&F?" read":"")+(B?" multiselect-selected":"")+(M?" missing-page":"")+(G.any?" missing-meta":""),onClick:me,children:[o.jsx("div",{className:"manga-card-cover-wrap",children:o.jsx("img",{src:w.cover||"https://imgur.com/chUgq4W.png",alt:"Cover",loading:"lazy",decoding:"async"})}),o.jsxs("div",{className:"manga-card-body",children:[o.jsx("div",{className:"manga-card-title",children:w.title||"Untitled"}),o.jsxs("div",{className:"manga-card-meta",children:[o.jsx("span",{className:G.authorMissing?"missing-field":"",children:w.authors&&w.authors!=="Unknown"?w.authors:G.authorMissing?"Missing author":""}),o.jsx("br",{}),o.jsx("span",{className:G.publisherMissing?"missing-field":"",children:w.publisher&&w.publisher!=="Unknown"?w.publisher:G.publisherMissing?"Missing publisher":""}),o.jsx("br",{}),o.jsx("span",{className:G.dateMissing?"missing-field":"",children:w.date&&w.date!=="Unknown"?w.date:G.dateMissing?"Missing date":""})]}),w.isbn?o.jsxs("div",{className:"manga-card-isbn",children:["ISBN: ",w.isbn]}):F&&G.isbnMissing&&o.jsx("div",{className:"manga-card-isbn missing-field",children:"Missing ISBN"}),s&&o.jsxs("div",{className:"manga-card-actions",children:[o.jsx("button",{type:"button",className:"manga-btn mini",onClick:ne=>{ne.stopPropagation(),_r(w)},children:"Edit"}),o.jsx("button",{type:"button",className:"manga-btn mini danger",onClick:ne=>{ne.stopPropagation(),zn(w.id,w.kind==="wishlist"?"wishlist":"library")},children:"Delete"})]})]})]},w.id)}function Ti(w){var je;const B=ks(w.volumes),F=`${w.count} volume${w.count===1?"":"s"}`;w.readCount>=w.count&&w.count>0||`${w.readCount}${w.count}`;const M=w.readCount>=w.count&&w.count>0,G=s&&w.missingVolumeCount||0,me=G>0,ne=[w.authors&&w.authors!=="Unknown"?w.authors:null,w.publisher&&w.publisher!=="Unknown"?w.publisher:null,B?`${F} - ${B}`:F].filter(Boolean);return o.jsxs("div",{className:"manga-card series-view"+(M?" read":"")+(me?" missing-page missing-meta":""),onClick:()=>Dr(w),children:[me&&o.jsx("div",{className:"missing-page-badge",title:"Volumes missing required data",children:G}),o.jsx("div",{className:"manga-card-cover-wrap",children:o.jsx("img",{src:w.cover||((je=w.representative)==null?void 0:je.cover)||"https://imgur.com/chUgq4W.png",alt:"Cover",loading:"lazy",decoding:"async"})}),o.jsxs("div",{className:"manga-card-body",children:[o.jsx("div",{className:"manga-card-title",children:w.title||"Untitled Series"}),o.jsx("div",{className:"manga-card-meta",children:ne.map((Se,We)=>o.jsxs(rp.Fragment,{children:[Se,o.jsx("br",{})]},Se+We))}),o.jsx("div",{className:"manga-card-series-count",children:F})]})]},w.id)}const an=({value:w,onChange:B,interactive:F=!0})=>{const[M,G]=j.useState(null),me=Math.max(0,Math.min(5,Number(w)||0)),ne=F&&M!=null?M:me,je=Array.from({length:10},(Je,Re)=>(Re+1)*.5),Se=5,We=Array.from({length:Se},(Je,Re)=>Math.max(0,Math.min(1,ne-Re))),de=F&&typeof B=="function";return o.jsxs("div",{className:`star-shell${de?"":" read-only"}`,role:"group","aria-label":"Rating",children:[o.jsxs("div",{className:"star-visual",style:{"--star-count":Se},children:[o.jsx("div",{className:"star-row",children:We.map((Je,Re)=>o.jsxs("div",{className:"star-icon",children:[o.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",className:"star-base",children:o.jsx("path",{d:"M12 2.5l2.9 5.88 6.5.95-4.7 4.58 1.1 6.43L12 17.9l-5.8 3.44 1.1-6.43-4.7-4.58 6.5-.95L12 2.5z"})}),o.jsx("div",{className:"star-fill",style:{"--pct":`${(Math.max(0,Math.min(1,Je))*100).toFixed(1)}%`},children:o.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:o.jsx("path",{d:"M12 2.5l2.9 5.88 6.5.95-4.7 4.58 1.1 6.43L12 17.9l-5.8 3.44 1.1-6.43-4.7-4.58 6.5-.95L12 2.5z"})})})]},Re))}),de&&o.jsx("div",{className:"star-hit",children:je.map(Je=>o.jsx("button",{type:"button","aria-label":`${Je} stars`,onMouseEnter:()=>G(Je),onMouseLeave:()=>G(null),onClick:()=>B(Je)},Je))})]}),o.jsx("div",{className:"star-value",children:ne?ne.toFixed(1):"--"}),de&&o.jsx("button",{type:"button",className:"star-clear",onClick:()=>B(""),"aria-label":"Clear rating",children:"clear"})]})},Zt=l==="library"?un:lr,Lr=l==="library"?x:C,Rn=j.useMemo(()=>Xn(Zt),[Zt,Un]),$n=j.useMemo(()=>Xn(Lr),[Lr,Un]);j.useEffect(()=>{if(!pe&&!Ye)return;const w=[...x,...C];if(pe){const B=w.find(F=>F.id===pe.id);B?(B.title!==pe.title||B.isbn!==pe.isbn||B.publisher!==pe.publisher||B.authors!==pe.authors||B.date!==pe.date||B.pageCount!==pe.pageCount||B.amountPaid!==pe.amountPaid||B.msrp!==pe.msrp||B.rating!==pe.rating||B.read!==pe.read||B.amazonURL!==pe.amazonURL)&&qe(B):qe(null)}if(Ye){const B=Rn.find(ne=>ne.key===Ye.series.key);if(!B){It(null);return}const F=Zt.filter(ne=>(Vt(ne.title||"").name||(ne.title||"").toLowerCase()||ne.id)===B.key).sort((ne,je)=>Vt(ne.title).vol-Vt(je.title).vol),M=F.length===Ye.volumes.length&&F.every((ne,je)=>{var Se;return((Se=Ye.volumes[je])==null?void 0:Se.id)===ne.id}),G=F.length!==Ye.volumes.length||F.some((ne,je)=>{const Se=Ye.volumes[je];return!Se||Se.id!==ne.id?!0:Se.title!==ne.title||Se.authors!==ne.authors||Se.publisher!==ne.publisher||Se.date!==ne.date||Se.isbn!==ne.isbn||Se.cover!==ne.cover||Se.read!==ne.read||Se.pageCount!==ne.pageCount||Se.datePurchased!==ne.datePurchased||Se.amountPaid!==ne.amountPaid||Se.msrp!==ne.msrp||Se.rating!==ne.rating}),me=B.title!==Ye.series.title||B.authors!==Ye.series.authors||B.publisher!==Ye.series.publisher||B.count!==Ye.series.count;(G||me||!M)&&It({series:B,volumes:F})}},[x,C,pe,Ye,Zt,Rn]);const zt=f==="series"?Rn:Zt;f==="series"?Rn.length:Zt.length,f==="series"?$n.length:Lr.length;const ps=(w,B)=>{if(!w.length)return;const F=Array.from(w.reduce((Se,We)=>(Object.keys(We).forEach(de=>Se.add(de)),Se),new Set)),M=Se=>{const We=Se==null?"":String(Se);return/[",\n]/.test(We)?`"${We.replace(/"/g,'""')}"`:We},G=[F.join(",")].concat(w.map(Se=>F.map(We=>M(Se[We])).join(","))),me=new Blob([G.join(`
`)],{type:"text/csv"}),ne=URL.createObjectURL(me),je=document.createElement("a");je.href=ne,je.download=B,je.click(),URL.revokeObjectURL(ne)},Ds=async(w,B)=>{const F=(G,me="image")=>(G||"").toString().toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"").slice(0,100)||me,M=w.filter(G=>G.cover).map((G,me)=>({url:G.cover,name:F(G.title||`manga-${me+1}`,`manga-${me+1}`)}));if(!M.length){alert("No images found to download.");return}try{const G=(await yc(async()=>{const{default:Re}=await import("https://cdn.jsdelivr.net/npm/jszip@3.10.1/+esm");return{default:Re}},[])).default,me=new G,ne=me.folder("images"),je={},Se=M.map(async(Re,ht)=>{try{const hr=await(await fetch(Re.url)).blob(),xn=(Re.url.split(".").pop()||"jpg").split(/[?#]/)[0],fr=Re.name||`image-${ht+1}`;je[fr]=(je[fr]||0)+1;const Qr=je[fr]>1?`-${je[fr]}`:"";ne.file(`${fr}${Qr}.${xn}`,hr)}catch(Vs){console.warn("Failed to fetch image",Re.url,Vs)}});await Promise.all(Se);const We=await me.generateAsync({type:"blob"}),de=URL.createObjectURL(We),Je=document.createElement("a");Je.href=de,Je.download=B,Je.click(),URL.revokeObjectURL(de)}catch(G){console.error("Zip download failed",G),alert("Failed to create zip. Please try again.")}},ms=(w,B)=>{const F=new Blob([JSON.stringify(w,null,2)],{type:"application/json"}),M=URL.createObjectURL(F),G=document.createElement("a");G.href=M,G.download=B,G.click(),URL.revokeObjectURL(M)},gs=w=>({title:w.title||"",authors:w.authors||"",publisher:w.publisher||"",demographic:w.demographic||"",genre:w.genre||"",subGenre:w.subGenre||"",date:w.date||"",pageCount:w.pageCount??"",cover:w.cover||"",amountPaid:w.amountPaid??"",read:!!w.read,rating:w.rating??"",dateRead:w.dateRead||"",datePurchased:w.datePurchased||"",msrp:w.msrp??"",collectiblePrice:w.collectiblePrice??"",specialType:w.specialType||"",specialVolumes:w.specialVolumes??"",isbn:w.isbn||"",amazonURL:w.amazonURL||"",hidden:!!w.hidden}),Kr=w=>{const F=Vt(w.title||"").name;if(!F)return"";const G=[...x,...C].map(ne=>{const Se=Vt(ne.title||"").name===F,We=ne.msrp??ne.MSRP??"",de=String(We).trim();if(!Se||!de)return null;const Je=Number(de);return Number.isFinite(Je)?Je:null}).filter(ne=>ne!==null);if(!G.length)return"";const me=G[0];return G.every(ne=>ne===me)?me:""},dr=w=>{const F=Vt(w.title||"").name;if(!F)return{demographic:"",genre:"",subGenre:""};const G=[...x,...C].find(me=>Vt(me.title||"").name===F&&(me.demographic||me.genre||me.subGenre));return{demographic:(G==null?void 0:G.demographic)||"",genre:(G==null?void 0:G.genre)||"",subGenre:(G==null?void 0:G.subGenre)||""}},fa=async w=>{if(!s||!(w!=null&&w.id))return;const B=w.kind==="wishlist"?"wishlist":"library",F=B==="library"?"wishlist":"library";try{const M=gs(w);if(F==="library"){const G=Kr(w);(M.msrp===""||M.msrp===null||M.msrp===void 0)&&(M.msrp=G);const me=dr(w);M.demographic||(M.demographic=me.demographic),M.genre||(M.genre=me.genre),M.subGenre||(M.subGenre=me.subGenre)}await Oa(bn(st,F),M),await Ma(Pt(st,B,w.id)),await Promise.all([wt(),jt()]),It(G=>G&&{...G,volumes:G.volumes.filter(me=>me.id!==w.id)}),Yn()}catch(M){console.error("Move failed",M),alert("Failed to move item.")}},ft=Ie.list==="wishlist",_n=H.items[H.index]||null,An=(_n==null?void 0:_n.kind)==="wishlist",en=j.useMemo(()=>{if(!_n)return{author:!1,publisher:!1,date:!1,purchaseDate:!1,page:!1,isbn:!1,amountPaid:!1,collectiblePrice:!1,msrp:!1};const w=_n.data||{},B=_n.kind==="library",F=B&&w.special&&w.specialType==="collectible",M=B&&!F;return{author:Kt(w.authors),publisher:Kt(w.publisher),date:Kt(w.date),purchaseDate:B?Kt(w.datePurchased):!1,page:No({pageCount:w.pageCount}),isbn:B?Kt(w.isbn):!1,amountPaid:M?Kt(w.amountPaid):!1,collectiblePrice:F?Kt(w.collectiblePrice):!1,msrp:B?Kt(w.msrp):!1}},[_n]);return o.jsxs("div",{className:"manga-page",children:[o.jsxs("header",{className:"manga-header",style:{flexDirection:"column",alignItems:"center",textAlign:"center"},children:[o.jsx("div",{className:"manga-header-title",style:{justifyContent:"center",gap:"0.6rem",fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Tyler's Manga Library"}),o.jsx("div",{className:"manga-header-sub",style:{textAlign:"center"},children:"This is my Manga Library and Wishlist. Check and see all the Manga I have in my possession!"})]}),At&&o.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"6px"},children:o.jsx("button",{className:"suggestion-trigger",type:"button",onClick:()=>{ge(""),De(!0)},children:"+ Suggestion"})}),o.jsxs("div",{className:"manga-tabs",children:[o.jsx("button",{className:"manga-tab-btn"+(l==="library"?" active":""),onClick:()=>{d("library"),b(!1),re(new Set)},children:"Library"}),o.jsx("button",{className:"manga-tab-btn"+(l==="wishlist"?" active":""),onClick:()=>{d("wishlist"),b(!1),re(new Set)},children:"Wishlist"})]}),l!=="dashboard"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"manga-toolbar",children:[o.jsxs("div",{className:"manga-toolbar-left",children:[o.jsx("input",{type:"text",className:"manga-search-input",placeholder:l==="library"?"Search library by title, author, ISBN...":"Search wishlist...",value:l==="library"?N:O,onChange:w=>l==="library"?A(w.target.value):D(w.target.value)}),o.jsx("div",{className:"manga-counter",children:(()=>{const w=l==="library",B=(w?N:O).trim(),F=w?x.length:C.length,M=w?sn.length:Fn.length;return B?`${M} / ${F} Volumes`:`${F} Volumes`})()})]}),o.jsxs("div",{className:"manga-toolbar-right",children:[o.jsxs("div",{className:"manga-view-toggle",children:[o.jsx("button",{className:"manga-btn secondary"+(f==="series"?" active":""),type:"button","aria-pressed":f==="series","aria-label":"Series view",title:"Series View",onClick:()=>Gt("series"),children:""}),o.jsx("button",{className:"manga-btn secondary"+(f==="individual"?" active":""),type:"button","aria-pressed":f==="individual","aria-label":"Volume view",title:"Volume View",onClick:()=>Gt("individual"),children:""})]}),s&&o.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>_e(w=>!w),children:we?"Hide Hidden":"Show Hidden"}),s&&o.jsx("button",{className:"manga-btn secondary"+(P?" active":""),disabled:f==="series",onClick:Ut,children:P?"Exit Multi-select":"Multi-select"})]})]}),s&&P&&f==="individual"&&o.jsxs("div",{className:"manga-multiselect-bar",children:[o.jsxs("span",{children:["Selected: ",o.jsx("strong",{children:J.size})]}),o.jsx("button",{className:"manga-btn",onClick:js,children:"Bulk Edit"}),o.jsxs("button",{className:"manga-btn secondary",onClick:()=>Qn("move"),children:["Move to ",l==="library"?"Wishlist":"Library"]}),l==="library"&&o.jsxs(o.Fragment,{children:[o.jsx("button",{className:"manga-btn",onClick:()=>Qn("markRead"),children:"Mark Read"}),o.jsx("button",{className:"manga-btn secondary",onClick:()=>Qn("markUnread"),children:"Mark Unread"})]}),o.jsx("button",{className:"manga-btn danger",onClick:()=>Qn("delete"),children:"Delete"})]})]}),ve?o.jsx("div",{className:"manga-empty-state",children:"Loading manga from Firestore..."}):ie?o.jsx("div",{className:"manga-empty-state",children:ie}):zt.length===0?o.jsx("div",{className:"manga-empty-state",children:"No manga found. Try changing your search."}):o.jsx("div",{className:"manga-grid",children:zt.map(w=>f==="series"?Ti(w):ur(w))}),Ye&&o.jsx("div",{className:"manga-modal-backdrop visible",onClick:w=>{w.target===w.currentTarget&&ds()},children:o.jsx("div",{className:"manga-modal series",children:o.jsxs("div",{className:"manga-modal-body",children:[o.jsxs("div",{className:"manga-modal-header",children:[o.jsx("div",{className:"manga-modal-title",children:Ye.series.title||"Series"}),o.jsx("button",{className:"manga-modal-close",onClick:ds,type:"button","aria-label":"Close",children:"X"})]}),o.jsxs("div",{className:"manga-modal-subtitle",children:[Ye.series.count," volume",Ye.series.count===1?"":"s"," in this series"]}),s&&o.jsxs("div",{className:"series-bulk-controls",children:[o.jsx("button",{type:"button",className:"manga-btn mini secondary"+(P?" active":""),onClick:()=>Ft(Ye.volumes),children:P?"Exit Multi-select":"Multi-select"}),P&&o.jsxs(o.Fragment,{children:[o.jsx("button",{type:"button",className:"manga-btn mini secondary",onClick:()=>{const w=Ye.volumes.map(B=>B.id);re(new Set(w))},children:"Select All"}),o.jsx("button",{type:"button",className:"manga-btn mini secondary",onClick:()=>{re(new Set)},children:"Clear"}),l==="wishlist"?o.jsx("button",{type:"button",className:"manga-btn mini",disabled:!J.size,onClick:()=>{J.size&&Qn("move","library")},children:"Move to Library"}):o.jsx("button",{type:"button",className:"manga-btn mini",disabled:!J.size,onClick:()=>{J.size&&Qn("move","wishlist")},children:"Move to Wishlist"}),o.jsxs("button",{type:"button",className:"manga-btn mini",disabled:!J.size,onClick:()=>{if(!J.size)return;const w=new Set(Ye.volumes.map(B=>B.id));re(B=>new Set([...B].filter(F=>w.has(F)))),js()},children:["Bulk Edit Selected (",J.size||0,")"]})]})]}),o.jsx("div",{className:"manga-series-modal-grid",children:Ye.volumes.map(w=>{const B=bu(w,{includeIsbn:w.kind==="library",includeFinance:w.kind==="library"});return o.jsxs("div",{className:"manga-card mini-card"+(w.read?" read":"")+(s&&No(w)?" missing-page":"")+(s&&B.any?" missing-meta":""),onClick:()=>{if(!s){In(w);return}if(P){dn(w.id);return}In(w)},children:[o.jsxs("div",{className:"manga-card-cover-wrap",children:[P&&s&&o.jsx("div",{className:"mini-select-indicator"+(J.has(w.id)?" selected":""),children:J.has(w.id)?"X":""}),o.jsx("img",{src:w.cover||"https://imgur.com/chUgq4W.png",alt:w.title||"Cover",loading:"lazy",decoding:"async"})]}),o.jsxs("div",{className:"manga-card-body",children:[o.jsx("div",{className:"manga-card-title",children:w.title||"Untitled"}),o.jsxs("div",{className:"manga-card-meta",children:[o.jsx("span",{className:B.authorMissing?"missing-field":"",children:w.authors&&w.authors!=="Unknown"?w.authors:"Missing author"}),o.jsx("br",{}),o.jsx("span",{className:B.publisherMissing?"missing-field":"",children:w.publisher&&w.publisher!=="Unknown"?w.publisher:"Missing publisher"}),o.jsx("br",{}),o.jsx("span",{className:B.dateMissing?"missing-field":"",children:w.date&&w.date!=="Unknown"?w.date:"Missing date"})]}),w.isbn?o.jsxs("div",{className:"manga-card-isbn",children:["ISBN: ",w.isbn]}):w.kind==="library"&&B.isbnMissing&&o.jsx("div",{className:"manga-card-isbn missing-field",children:"Missing ISBN"})]})]},w.id)})})]})})}),s&&o.jsxs("div",{className:"manga-floating-actions",children:[o.jsxs("button",{className:"manga-btn",type:"button","aria-label":"Add item",onClick:()=>Vr(l==="wishlist"?"wishlist":"library"),children:["+ ",l==="wishlist"?"Wishlist":"Library"]}),o.jsxs("div",{className:"manga-export-actions",children:[n&&o.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>ms({library:x,wishlist:C},"manga-library-wishlist.json"),children:"Export JSON"}),o.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>ps(l==="library"?x:C,l==="library"?"manga-library.csv":"manga-wishlist.csv"),children:"Export CSV"}),o.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>Ds(l==="library"?x:C,l==="library"?"manga-library-images.zip":"manga-wishlist-images.zip"),children:"Download Images"})]})]}),pe&&o.jsx("div",{className:"manga-modal-backdrop visible",onClick:w=>{w.target===w.currentTarget&&Yn()},children:o.jsxs("div",{className:"manga-modal",children:[o.jsxs("div",{className:"manga-modal-cover-wrap",children:[pe.kind==="library"&&pe.read&&o.jsx("div",{className:"manga-modal-read-pill",children:"Read"}),o.jsx("img",{src:pe.cover||"https://imgur.com/chUgq4W.png",alt:"Cover"})]}),o.jsxs("div",{className:"manga-modal-body",children:[o.jsxs("div",{className:"manga-modal-header",children:[o.jsx("div",{className:"manga-modal-title",children:pe.title||"Untitled"}),o.jsx("button",{className:"manga-modal-close",onClick:Yn,type:"button","aria-label":"Close",children:"X"})]}),o.jsxs("div",{className:"manga-modal-meta",children:[pe.authors&&pe.authors!=="Unknown"&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"Author(s):"})," ",pe.authors,o.jsx("br",{})]}),pe.publisher&&pe.publisher!=="Unknown"&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"Publisher:"})," ",pe.publisher,o.jsx("br",{})]}),pe.date&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"Release:"})," ",pe.date,o.jsx("br",{})]}),pe.isbn&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"ISBN:"})," ",pe.isbn,o.jsx("br",{})]})]}),o.jsxs("div",{className:"manga-modal-details",children:[pe.pageCount&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"Pages:"})," ",pe.pageCount,o.jsx("br",{})]}),o.jsxs("div",{style:{margin:"6px 0"},children:[o.jsx("strong",{children:"Rating:"})," ",o.jsx(an,{value:pe.rating||"",onChange:s?w=>qr(pe,w):void 0,interactive:s})]}),pe.amountPaid&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"Amount Paid:"})," $",pe.amountPaid,o.jsx("br",{})]}),pe.msrp&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"MSRP:"})," $",pe.msrp,o.jsx("br",{})]}),pe.collectiblePrice&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"Collectible:"})," $",pe.collectiblePrice,o.jsx("br",{})]}),pe.read&&pe.dateRead&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"Date Read:"})," ",pe.dateRead,o.jsx("br",{})]}),pe.amazonURL&&o.jsx("div",{style:{marginTop:"6px"},children:o.jsx("a",{href:pe.amazonURL,target:"_blank",rel:"noreferrer",children:"View on Amazon"})})]}),o.jsxs("div",{className:"manga-modal-footer",style:{gap:"10px",alignItems:"center"},children:[o.jsx("div",{children:pe.kind==="library"&&pe.read?"Marked as read in your library.":pe.kind==="library"?"In your library (unread).":"Wishlist item - not in library yet."}),o.jsxs("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:[s&&o.jsx("button",{className:"manga-btn mini secondary",type:"button",onClick:()=>_r(pe),children:"Edit"}),pe.kind==="library"&&s&&o.jsx(o.Fragment,{children:pe.read?o.jsx("button",{className:"manga-btn mini secondary",disabled:hs,onClick:()=>wr(pe,!1),type:"button",children:"Mark as unread"}):o.jsx("button",{className:"manga-btn mini",disabled:hs,onClick:()=>wr(pe,!0),type:"button",children:"Mark as read"})}),s&&o.jsxs("button",{className:"manga-btn mini",type:"button",onClick:()=>fa(pe),children:["Move to ",pe.kind==="library"?"Wishlist":"Library"]}),s&&o.jsx("button",{className:"manga-btn mini danger",type:"button",onClick:()=>zn(pe.id,pe.kind==="library"?"library":"wishlist"),children:"Delete"})]})]})]})]})}),s&&Ie.open&&o.jsx("div",{className:"manga-modal-backdrop visible",onClick:w=>{w.target===w.currentTarget&&cr()},children:o.jsx("div",{className:"manga-modal admin",children:o.jsxs("div",{className:"manga-modal-body",children:[o.jsxs("div",{className:"manga-modal-header",children:[o.jsx("div",{className:"manga-modal-title",children:Ie.mode==="add"?"Add Entry":"Edit Entry"}),o.jsx("button",{className:"manga-modal-close",onClick:cr,type:"button","aria-label":"Close",children:"X"})]}),o.jsxs("div",{className:"admin-form-layout",children:[o.jsx("div",{className:"admin-cover-frame",children:o.jsx("img",{src:Ie.data.cover||"https://imgur.com/chUgq4W.png",alt:"Cover preview"})}),o.jsxs("div",{className:"admin-form-fields",children:[o.jsx("div",{className:"admin-row",children:o.jsxs("label",{children:["Title",o.jsx("input",{type:"text",value:Ie.data.title,onChange:w=>dt("title",w.target.value)})]})}),z.length>0&&o.jsx("div",{className:"title-suggestions",children:z.map((w,B)=>o.jsx("button",{type:"button",className:"manga-btn mini",onClick:()=>dt("title",w),children:w},w+B))}),o.jsxs("div",{className:"admin-row two",style:{alignItems:"flex-end",marginTop:"-8px"},children:[o.jsxs("div",{children:[o.jsxs("div",{className:"manga-modal-subtitle",style:{marginBottom:"6px"},children:["Entry ",xe+1," / ",Math.max(1,ce.length||1)]}),o.jsxs("div",{style:{display:"flex",gap:"8px"},children:[o.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>xe>0&&Wr(xe-1),disabled:xe===0,children:"Previous"}),o.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>ce.length&&xe<ce.length-1?Wr(xe+1):null,disabled:!ce.length||xe===ce.length-1,children:"Next"})]})]}),o.jsxs("div",{style:{textAlign:"right"},children:[o.jsx("button",{className:"manga-btn",type:"button",onClick:Jn,disabled:!Vt(Ie.data.title||"").vol,children:"Add New Volume"}),o.jsx("div",{className:"manga-stat-sub",style:{marginTop:"4px"},children:"Auto-fills the next volume number for this series."})]})]}),o.jsx("div",{className:"admin-row",children:o.jsxs("label",{className:k.author?"missing-field-input":"",children:["Authors",o.jsx("input",{type:"text",value:Ie.data.authors,onChange:w=>dt("authors",w.target.value)})]})}),o.jsx("div",{className:"admin-row",children:o.jsxs("label",{className:k.publisher?"missing-field-input":"",children:["Publisher",o.jsx("input",{type:"text",value:Ie.data.publisher,onChange:w=>dt("publisher",w.target.value)})]})}),o.jsxs("div",{className:"admin-row three",children:[o.jsxs("label",{className:k.date?"missing-field-input":"",children:["Release Date",o.jsx("input",{type:"date",value:Ie.data.date,onChange:w=>dt("date",w.target.value)})]}),o.jsxs("label",{className:k.purchaseDate?"missing-field-input":"",children:["Purchase Date",o.jsx("input",{type:"date",value:Ie.data.datePurchased,onChange:w=>dt("datePurchased",w.target.value)})]}),!ft&&o.jsxs("label",{children:["Date Read",o.jsx("input",{type:"date",value:Ie.data.dateRead,onChange:w=>dt("dateRead",w.target.value)})]})]}),o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{className:k.page?"missing-field-input":"",children:["Page Count",o.jsx("input",{type:"number",placeholder:"e.g. 192",value:Ie.data.pageCount,onChange:w=>dt("pageCount",w.target.value)})]}),!ft&&o.jsxs("label",{className:k.isbn?"missing-field-input":"",children:["ISBN (library only)",o.jsx("input",{type:"text",value:Ie.data.isbn,onChange:w=>dt("isbn",w.target.value)})]})]}),o.jsx("div",{className:"admin-row",children:o.jsxs("label",{children:["Cover URL",o.jsx("input",{type:"text",placeholder:"Paste image URL here",value:Ie.data.cover,onChange:w=>dt("cover",w.target.value)})]})}),!ft&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"admin-row two",children:[!(Ie.data.special&&Ie.data.specialType==="collectible")&&o.jsxs("label",{className:k.amountPaid?"missing-field-input":"",children:["Amount Paid",o.jsx("input",{type:"number",step:"0.01",value:Ie.data.amountPaid,onChange:w=>dt("amountPaid",w.target.value)})]}),o.jsxs("label",{className:k.msrp?"missing-field-input":"",children:["MSRP",o.jsx("input",{type:"number",step:"0.01",value:Ie.data.msrp,onChange:w=>dt("msrp",w.target.value)})]})]}),o.jsx("div",{className:"admin-row",children:o.jsxs("label",{className:"checkbox-row",children:[o.jsx("input",{type:"checkbox",checked:!!Ie.data.special,onChange:w=>dt("special",w.target.checked,"checkbox")}),o.jsx("span",{children:"Special item?"})]})}),Ie.data.special&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{children:["Special Type",o.jsxs("select",{value:Ie.data.specialType,onChange:w=>dt("specialType",w.target.value),children:[o.jsx("option",{value:"",children:"Select type"}),o.jsx("option",{value:"specialEdition",children:"Special Edition"}),o.jsx("option",{value:"collectible",children:"Collectible"})]})]}),Ie.data.specialType==="collectible"&&o.jsxs("label",{className:k.collectiblePrice?"missing-field-input":"",children:["Collectible Price",o.jsx("input",{type:"number",step:"0.01",value:Ie.data.collectiblePrice,onChange:w=>dt("collectiblePrice",w.target.value)})]})]}),Ie.data.specialType==="specialEdition"&&o.jsx("div",{className:"admin-row",children:o.jsxs("label",{children:["Special Volumes",o.jsx("input",{type:"number",min:"0",value:Ie.data.specialVolumes,onChange:w=>dt("specialVolumes",w.target.value)})]})})]})]}),ft&&o.jsx("div",{className:"admin-row",children:o.jsxs("label",{children:["Amazon URL",o.jsx("input",{type:"text",value:Ie.data.amazonURL,onChange:w=>dt("amazonURL",w.target.value)})]})}),!ft&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"admin-row",children:o.jsxs("label",{children:["Rating (1-5 stars)",o.jsx(an,{value:Ie.data.rating,onChange:w=>dt("rating",w)})]})}),o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{className:"checkbox-inline",children:[o.jsx("input",{type:"checkbox",checked:Ie.data.read,onChange:w=>dt("read",w.target.checked,"checkbox")}),o.jsx("span",{children:"Mark as read"})]}),o.jsxs("label",{className:"checkbox-inline",children:[o.jsx("input",{type:"checkbox",checked:!!Ie.data.hidden,onChange:w=>dt("hidden",w.target.checked,"checkbox")}),o.jsx("span",{children:"Hide from public"})]})]})]}),ft&&o.jsx("div",{className:"admin-row",children:o.jsxs("label",{className:"checkbox-inline",children:[o.jsx("input",{type:"checkbox",checked:!!Ie.data.hidden,onChange:w=>dt("hidden",w.target.checked,"checkbox")}),o.jsx("span",{children:"Hide from public"})]})})]})]}),o.jsxs("div",{className:"manga-modal-footer",style:{justifyContent:"flex-end",gap:"10px"},children:[o.jsx("button",{className:"manga-btn secondary",onClick:cr,type:"button",children:"Cancel"}),o.jsx("button",{className:"manga-btn",onClick:vn,type:"button",children:Ie.mode==="add"?"Add":"Save"})]})]})})}),s&&H.open&&o.jsx("div",{className:"manga-modal-backdrop visible",onClick:w=>{w.target===w.currentTarget&&xr()},children:o.jsx("div",{className:"manga-modal admin",children:o.jsxs("div",{className:"manga-modal-body",children:[o.jsxs("div",{className:"manga-modal-header",children:[o.jsxs("div",{className:"manga-modal-title",children:["Bulk Edit (",H.index+1," / ",H.items.length,")"]}),o.jsx("button",{className:"manga-modal-close",onClick:xr,type:"button","aria-label":"Close",children:"X"})]}),H.items.length>0&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"manga-modal-subtitle",children:["Editing: ",H.items[H.index].data.title||"Untitled"]}),o.jsxs("div",{className:"admin-form-grid two-col",children:[o.jsx("div",{className:"admin-cover",children:o.jsx("div",{className:"manga-card-cover-wrap",children:o.jsx("img",{src:H.items[H.index].data.cover||"https://imgur.com/chUgq4W.png",alt:H.items[H.index].data.title||"Cover",loading:"lazy",decoding:"async"})})}),o.jsxs("div",{className:"admin-fields",children:[o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{className:"full",children:["Title",o.jsx("input",{type:"text",value:H.items[H.index].data.title,onChange:w=>ot("title",w.target.value)})]}),o.jsxs("div",{className:"admin-entry-info",children:["Entry ",H.index+1," / ",H.items.length]})]}),o.jsx("div",{className:"admin-row",children:o.jsxs("label",{className:en.author?"missing-field-input":"",children:["Authors",o.jsx("input",{type:"text",value:H.items[H.index].data.authors,onChange:w=>ot("authors",w.target.value)})]})}),o.jsx("div",{className:"admin-row",children:o.jsxs("label",{className:en.publisher?"missing-field-input":"",children:["Publisher",o.jsx("input",{type:"text",value:H.items[H.index].data.publisher,onChange:w=>ot("publisher",w.target.value)})]})}),o.jsxs("div",{className:"admin-row three",children:[o.jsxs("label",{className:en.date?"missing-field-input":"",children:["Release Date",o.jsx("input",{type:"date",value:H.items[H.index].data.date,onChange:w=>ot("date",w.target.value)})]}),o.jsxs("label",{className:en.purchaseDate?"missing-field-input":"",children:["Purchase Date",o.jsx("input",{type:"date",value:H.items[H.index].data.datePurchased,onChange:w=>ot("datePurchased",w.target.value)})]}),!An&&o.jsxs("label",{children:["Date Read",o.jsx("input",{type:"date",value:H.items[H.index].data.dateRead,onChange:w=>ot("dateRead",w.target.value)})]})]}),o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{className:en.page?"missing-field-input":"",children:["Page Count",o.jsx("input",{type:"number",value:H.items[H.index].data.pageCount,onChange:w=>ot("pageCount",w.target.value)})]}),!An&&o.jsxs("label",{className:en.isbn?"missing-field-input":"",children:["ISBN (library only)",o.jsx("input",{type:"text",value:H.items[H.index].data.isbn,onChange:w=>ot("isbn",w.target.value)})]})]}),o.jsx("div",{className:"admin-row",children:o.jsxs("label",{children:["Cover URL",o.jsx("input",{type:"text",value:H.items[H.index].data.cover,onChange:w=>ot("cover",w.target.value)})]})}),!An&&o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{className:en.amountPaid?"missing-field-input":"",children:["Amount Paid",o.jsx("input",{type:"number",step:"0.01",value:H.items[H.index].data.amountPaid,onChange:w=>ot("amountPaid",w.target.value)})]}),o.jsxs("label",{className:en.msrp?"missing-field-input":"",children:["MSRP",o.jsx("input",{type:"number",step:"0.01",value:H.items[H.index].data.msrp,onChange:w=>ot("msrp",w.target.value)})]})]}),!An&&o.jsx("div",{className:"admin-row two",children:o.jsxs("div",{children:[o.jsx("div",{className:"star-label",children:"Rating (1-5 stars)"}),o.jsx(an,{value:H.items[H.index].data.rating,onChange:w=>ot("rating",w)})]})}),!An&&o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{className:"checkbox-row",children:[o.jsx("input",{type:"checkbox",checked:!!H.items[H.index].data.special,onChange:w=>ot("special",w.target.checked,"checkbox")}),o.jsx("span",{children:"Special item?"})]}),o.jsxs("label",{className:"checkbox-row",children:[o.jsx("input",{type:"checkbox",checked:H.items[H.index].data.read,onChange:w=>ot("read",w.target.checked,"checkbox")}),o.jsx("span",{children:"Mark as read"})]})]}),H.items[H.index].data.special&&!An&&o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{children:["Special Type",o.jsxs("select",{value:H.items[H.index].data.specialType,onChange:w=>ot("specialType",w.target.value),children:[o.jsx("option",{value:"",children:"Select type"}),o.jsx("option",{value:"specialEdition",children:"Special Edition"}),o.jsx("option",{value:"collectible",children:"Collectible"})]})]}),H.items[H.index].data.specialType==="specialEdition"&&o.jsxs("label",{children:["Special Volumes",o.jsx("input",{type:"number",value:H.items[H.index].data.specialVolumes,onChange:w=>ot("specialVolumes",w.target.value)})]}),H.items[H.index].data.specialType==="collectible"&&o.jsxs("label",{className:en.collectiblePrice?"missing-field-input":"",children:["Collectible Price",o.jsx("input",{type:"number",step:"0.01",value:H.items[H.index].data.collectiblePrice,onChange:w=>ot("collectiblePrice",w.target.value)})]})]}),An&&o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{children:["Amazon URL",o.jsx("input",{type:"text",value:H.items[H.index].data.amazonURL,onChange:w=>ot("amazonURL",w.target.value)})]}),o.jsxs("label",{className:"checkbox-row",children:[o.jsx("input",{type:"checkbox",checked:!!H.items[H.index].data.hidden,onChange:w=>ot("hidden",w.target.checked,"checkbox")}),o.jsx("span",{children:"Hidden from public"})]})]}),!An&&o.jsx("div",{className:"admin-row",children:o.jsxs("label",{className:"checkbox-row",children:[o.jsx("input",{type:"checkbox",checked:!!H.items[H.index].data.hidden,onChange:w=>ot("hidden",w.target.checked,"checkbox")}),o.jsx("span",{children:"Hidden from public"})]})})]})]}),o.jsxs("div",{className:"manga-modal-footer",style:{justifyContent:"space-between",gap:"10px"},children:[o.jsxs("div",{children:[o.jsx("button",{className:"manga-btn secondary",onClick:Pn,type:"button",disabled:H.index===0,children:"Previous"}),o.jsx("button",{className:"manga-btn secondary",onClick:Hr,type:"button",disabled:H.index===H.items.length-1,style:{marginLeft:"6px"},children:"Next"})]}),o.jsxs("div",{style:{display:"flex",gap:"8px"},children:[o.jsx("button",{className:"manga-btn secondary",onClick:xr,type:"button",children:"Cancel"}),o.jsx("button",{className:"manga-btn",onClick:fs,type:"button",children:"Save Edits"})]})]})]})]})})}),At&&o.jsx(gw,{open:Ve,title:"Suggest a Manga",placeholder:"Type a manga you'd like me to collect/read...",value:Oe,status:nt,loading:le,onChange:Qe,onSubmit:y,onClose:()=>De(!1)}),o.jsx("datalist",{id:"adminTitleSuggestions",children:X.map(w=>o.jsx("option",{value:w},w))})]})}const gR="https://imokmalworker.imokissick.workers.dev/?url=",_w="im_ok",x_=300,yR={1:"watching",2:"completed",3:"on_hold",4:"dropped",6:"plan_to_watch"};function vR(n){const e=n==null?void 0:n.title_localized,t=typeof e=="string"?e:(e==null?void 0:e.en)||(e==null?void 0:e.english);return(n==null?void 0:n.anime_title_eng)||(n==null?void 0:n.title_english)||t||(n==null?void 0:n.anime_title)||(n==null?void 0:n.title)||"Untitled"}function _R(n){const e=(n==null?void 0:n.updated_at)??(n==null?void 0:n.updatedAt)??(n==null?void 0:n.updated_at_ms)??null;if(e==null)return null;const t=Number(e);if(Number.isFinite(t))return t<1e12?t*1e3:t;const s=Date.parse(e);return Number.isNaN(s)?null:s}function xR(n){const e=yR[n.status]||(typeof n.status=="string"?n.status.toLowerCase():"unknown");return{id:n.anime_id||n.id,title:vR(n),updatedAt:_R(n),episodes:n.anime_num_episodes??n.episodes??null,watchedEpisodes:n.num_watched_episodes??n.my_watched_episodes??n.watched_episodes??n.num_watched??0,status:e,score:n.score??null,image:n.anime_image_path||n.image_url||n.anime_img||n.picture||null,synopsis:n.anime_synopsis||n.synopsis||null}}function w_(){const n=Date.now();return[{id:1,title:"Cowboy Bebop",episodes:26,status:"completed",score:10,updatedAt:n-1e3*60*60*24*3,synopsis:"In 2071, bounty hunters Spike and Jet roam the solar system looking for their next payout and a place to belong."},{id:2,title:"Fullmetal Alchemist: Brotherhood",episodes:64,status:"completed",score:10,updatedAt:n-1e3*60*60*24*6,synopsis:"Brothers Edward and Alphonse Elric search for the Philosopher's Stone to restore their bodies after a failed alchemy ritual."},{id:3,title:"Frieren: Beyond Journey's End",episodes:28,status:"watching",score:9,updatedAt:n-1e3*60*60*8,synopsis:"An elven mage retraces the steps of a past adventure to understand humanity and the passage of time."},{id:4,title:"One Piece",episodes:1e3,status:"on_hold",score:8,updatedAt:n-1e3*60*60*24*14,synopsis:"Monkey D. Luffy sails toward the Grand Line seeking the One Piece and a crew to make his dream real."},{id:5,title:"Kaiju No. 8",episodes:12,status:"plan_to_watch",score:null,updatedAt:n-1e3*60*30,synopsis:"A middle-aged worker gains kaiju powers and joins the Defense Force to fight monsters from the inside."}]}async function wR(n,e){const t=`https://myanimelist.net/animelist/${n}/load.json?status=7&offset=${e}`,s=await fetch(`${gR}${encodeURIComponent(t)}`);if(!s.ok)throw new Error(`Failed to fetch MAL list (offset ${e})`);return s.json()}async function ER(n=_w){const e=[];try{let t=0;for(;;){const s=await wR(n,t);if(!Array.isArray(s)||s.length===0||(e.push(...s),s.length<x_))break;t+=x_}}catch(t){return console.error("Failed to load MAL list; falling back to sample data.",t),w_()}return e.length?e.map(xR):w_()}async function TR(n){var e,t;if(!n)return null;try{const s=await fetch(`https://api.jikan.moe/v4/anime/${n}`);if(!s.ok)throw new Error(`Failed to fetch Jikan summary for id ${n}`);const a=await s.json();return((e=a==null?void 0:a.data)==null?void 0:e.synopsis)||((t=a==null?void 0:a.data)==null?void 0:t.background)||null}catch(s){return console.error("Failed to load anime synopsis",n,s),null}}async function SR(n=_w){var e;if(!n)return null;try{const t=await fetch(`https://api.jikan.moe/v4/users/${encodeURIComponent(n)}/statistics`);if(!t.ok)throw new Error(`Failed to fetch user stats for ${n}`);const s=await t.json(),a=((e=s==null?void 0:s.data)==null?void 0:e.anime)||{},l=Number(a.days_watched),d=Number(a.total_episodes??a.episodes_watched);return{daysWatched:Number.isFinite(l)?l:null,episodesWatched:Number.isFinite(d)?d:null}}catch(t){return console.error("Failed to load user stats",n,t),null}}const E_=5,bR=3600*1e3,T_="animeSuggestionsSent";function CR(){const{admin:n,user:e,role:t}=Qa(),s=le=>le?le.toString().replace(/_/g," ").replace(/\b\w/g,Me=>Me.toUpperCase()):"Unknown",[a,l]=j.useState([]),[d,f]=j.useState([]),[m,y]=j.useState(""),[x,E]=j.useState("all"),[C,U]=j.useState(!0),[X,W]=j.useState(""),[z,se]=j.useState(null),[we,_e]=j.useState({}),[ve,L]=j.useState(!1),[ie,I]=j.useState(!1),[N,A]=j.useState(null),[O,D]=j.useState(!1),[P,b]=j.useState(""),[J,re]=j.useState(""),[Ie,he]=j.useState(!1);j.useEffect(()=>{document.title="Anime | Library"},[]),j.useEffect(()=>{re("")},[e]);const ce=le=>{if(!le)return"";const Me=Date.now()-le,pe=Math.max(Me,0),qe=Math.floor(pe/6e4);if(qe<1)return"just now";if(qe<60)return`${qe}m ago`;const Ye=Math.floor(qe/60);if(Ye<48)return`${Ye}h ago`;const It=Math.floor(Ye/24);if(It<14)return`${It}d ago`;const At=Math.floor(It/7);return At<8?`${At}w ago`:`${Math.floor(It/30)}mo ago`},Pe=(le,Me="image")=>(le||"").toString().toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"").slice(0,80)||Me,xe=async()=>{const le=a.filter(Me=>Me.image).map((Me,pe)=>({url:Me.image,name:Pe(Me.title||`anime-${pe+1}`,`anime-${pe+1}`)}));if(!le.length){alert("No images found to download.");return}try{const Me=(await yc(async()=>{const{default:jt}=await import("https://cdn.jsdelivr.net/npm/jszip@3.10.1/+esm");return{default:jt}},[])).default,pe=new Me,qe=pe.folder("images"),Ye={};await Promise.all(le.map(async(jt,sn)=>{try{const Fn=await(await fetch(jt.url)).blob(),lr=(jt.url.split(".").pop()||"jpg").split(/[?#]/)[0],Gt=jt.name||`image-${sn+1}`;Ye[Gt]=(Ye[Gt]||0)+1;const Kn=Ye[Gt]>1?`-${Ye[Gt]}`:"";qe.file(`${Gt}${Kn}.${lr}`,Fn)}catch(un){console.warn("Failed to fetch image",jt.url,un)}}));const It=await pe.generateAsync({type:"blob"}),At=URL.createObjectURL(It),wt=document.createElement("a");wt.href=At,wt.download="anime-images.zip",wt.click(),URL.revokeObjectURL(At)}catch(Me){console.error("Zip download failed",Me),alert("Failed to create zip. Please try again.")}};j.useEffect(()=>{async function le(){try{const Me=await ER();l(Me),f(Me)}catch(Me){console.error(Me),W("Failed to load data from MAL.")}finally{U(!1)}}le()},[]),j.useEffect(()=>{SR().then(le=>{le&&A(le)}).catch(()=>{})},[]);const Y=le=>{switch((le||"unknown").toLowerCase()){case"watching":return 0;case"completed":return 1;case"on_hold":return 2;case"plan_to_watch":return 3;case"dropped":return 4;default:return 5}},k=le=>{const Me=Number.isFinite(Number(le.watchedEpisodes))?Number(le.watchedEpisodes):0,pe=Number.isFinite(Number(le.episodes))?Number(le.episodes):null;return pe?`${Math.min(Me,pe)}/${pe} eps`:Me?`${Me} eps`:"No progress"};j.useEffect(()=>{let le=[...a];if(x!=="all"&&(le=le.filter(Me=>(Me.status||"").toLowerCase()===x)),m){const Me=m.toLowerCase();le=le.filter(pe=>(pe.title||"").toLowerCase().includes(Me))}le.sort((Me,pe)=>{const qe=Y(Me.status),Ye=Y(pe.status);return qe!==Ye?qe-Ye:(Me.title||"").localeCompare(pe.title||"")}),f(le)},[a,x,m]);const H=j.useMemo(()=>[...a].filter(le=>Number.isFinite(le.updatedAt)).sort((le,Me)=>Me.updatedAt-le.updatedAt).slice(0,6),[a]),Te=!!e&&t==="viewer",Ve=async()=>{const le=Date.now(),pe=(()=>{try{const qe=localStorage.getItem(T_);return Array.isArray(JSON.parse(qe))?JSON.parse(qe):[]}catch{return[]}})().filter(qe=>le-qe<bR);if(pe.length>=E_){re("Rate limit: please wait a bit (max 5 suggestions per hour).");return}if(!P.trim()){re("Please enter a title or note before sending.");return}he(!0),re("");try{const qe=`**Anime Suggestion**
${P.trim()}
From: ${(e==null?void 0:e.displayName)||(e==null?void 0:e.email)||(e==null?void 0:e.uid)||"anonymous user"}`;await Oa(bn(st,"suggestions"),{content:P.trim(),type:"anime",from:(e==null?void 0:e.displayName)||(e==null?void 0:e.email)||(e==null?void 0:e.uid)||"anonymous user",createdAt:new Date().toISOString()}),re("Sent! I'll review your suggestion soon."),b("");const Ye=[...pe,le].slice(-E_);localStorage.setItem(T_,JSON.stringify(Ye))}catch(qe){console.error("Failed to send suggestion",qe),re("Failed to send suggestion. Please try again later.")}finally{he(!1)}};j.useEffect(()=>{if(!z){I(!1),L(!1);return}I(!!z.synopsis),L(!1)},[z==null?void 0:z.id]);const De=j.useMemo(()=>{const le=a.length,Me=a.reduce((At,wt)=>{const jt=Number(wt.watchedEpisodes);return Number.isFinite(jt)?At+jt:At},0),pe=Me*.4,qe=a.filter(At=>Number.isFinite(At.score)&&At.score>0),Ye=qe.reduce((At,wt)=>At+wt.score,0),It={watching:0,completed:0,on_hold:0,dropped:0,plan_to_watch:0,unknown:0};return a.forEach(At=>{const wt=(At.status||"unknown").toLowerCase();It[wt]!=null?It[wt]+=1:It.unknown+=1}),{total:le,totalWatchedEpisodes:Me,byStatus:It,avgScore:qe.length?Ye/qe.length:0,totalHours:pe}},[a]),Oe=(N==null?void 0:N.daysWatched)??(De.totalHours||0)/24,Qe=(N==null?void 0:N.episodesWatched)??De.totalWatchedEpisodes,nt=le=>{const Me=le.image||"https://imgur.com/chUgq4W.png",pe=Number.isFinite(Number(le.watchedEpisodes))?Number(le.watchedEpisodes):0,qe=Number.isFinite(Number(le.episodes))?Number(le.episodes):null,Ye=qe?`Episode ${Math.min(pe,qe)}/${qe}`:`Episode ${pe}`,It=Number.isFinite(Number(le.score))&&Number(le.score)>0?le.score:"Not rated";return o.jsxs("article",{className:"anime-card",onClick:()=>se(le.synopsis?le:{...le,synopsis:we[le.id]}),children:[o.jsxs("div",{className:"anime-cover-wrap",children:[o.jsx("img",{className:"anime-cover",src:Me,alt:le.title,loading:"lazy",decoding:"async"}),o.jsx("div",{className:`badge-status ${(le.status||"unknown").toLowerCase()}`,children:s(le.status)}),le.score!=null&&o.jsx("div",{className:"badge-score",children:It})]}),o.jsxs("div",{className:"anime-meta",children:[o.jsx("div",{className:"anime-title",title:le.title,children:le.title}),o.jsx("div",{className:"anime-sub",children:le.episodes?`${le.episodes} episodes`:"Episodes: ?"}),o.jsx("div",{className:"anime-progress",children:Ye}),o.jsxs("div",{className:"anime-progress",children:["Status: ",s(le.status)]})]})]},le.id||le.title)},ge=le=>o.jsxs("article",{className:"anime-update-card",children:[o.jsx("div",{className:"anime-update-title",title:le.title,children:le.title}),o.jsxs("div",{className:"anime-update-meta",children:[o.jsx("span",{className:"anime-update-progress",children:k(le)}),o.jsx("span",{className:"anime-update-dot","aria-hidden":"true",children:""}),o.jsx("span",{className:"anime-update-status",children:s(le.status)})]}),o.jsx("div",{className:"anime-update-time",children:ce(le.updatedAt)})]},`update-${le.id||le.title}`);return o.jsxs("main",{className:"anime-page",children:[o.jsxs("div",{className:"anime-content",children:[o.jsxs("header",{className:"anime-header",style:{position:"relative",display:"flex",justifyContent:"center",alignItems:"center",textAlign:"center",width:"100%"},children:[o.jsxs("div",{style:{textAlign:"center",margin:"0 auto",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"0 60px"},children:[o.jsx("h1",{className:"anime-title",style:{margin:0,fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Tyler's Anime Library"}),o.jsx("p",{className:"anime-sub",style:{textAlign:"center",margin:"6px 0 0"},children:"The Anime I've watched/watching synced directly from MAL (MyAnimeList)"})]}),(Te||n)&&o.jsxs("div",{style:{position:"absolute",right:0,top:"50%",transform:"translateY(-50%)",display:"flex",gap:"10px"},children:[Te&&o.jsx("button",{className:"suggestion-trigger",type:"button",onClick:()=>{re(""),D(!0)},children:"+ Suggestion"}),n&&o.jsx("button",{className:"stat-link",type:"button",onClick:xe,children:"Download Images"})]})]}),o.jsxs("div",{className:"anime-stats",children:[o.jsxs("div",{className:"anime-stat-card",children:[o.jsx("div",{className:"anime-stat-label",children:"Total Entries"}),o.jsx("div",{className:"anime-stat-value",children:De.total})]}),o.jsxs("div",{className:"anime-stat-card",children:[o.jsx("div",{className:"anime-stat-label",children:"Episodes Watched"}),o.jsx("div",{className:"anime-stat-value",children:Qe})]}),o.jsxs("div",{className:"anime-stat-card",children:[o.jsx("div",{className:"anime-stat-label",children:"Watching"}),o.jsx("div",{className:"anime-stat-value",children:De.byStatus.watching})]}),o.jsxs("div",{className:"anime-stat-card",children:[o.jsx("div",{className:"anime-stat-label",children:"Completed"}),o.jsx("div",{className:"anime-stat-value",children:De.byStatus.completed})]}),o.jsxs("div",{className:"anime-stat-card",children:[o.jsx("div",{className:"anime-stat-label",children:"Plan to Watch"}),o.jsx("div",{className:"anime-stat-value",children:De.byStatus.plan_to_watch})]}),o.jsxs("div",{className:"anime-stat-card",children:[o.jsx("div",{className:"anime-stat-label",children:"Avg. Score"}),o.jsx("div",{className:"anime-stat-value",children:De.avgScore?De.avgScore.toFixed(1):"0.0"})]}),o.jsxs("div",{className:"anime-stat-card",children:[o.jsx("div",{className:"anime-stat-label",children:"Days Watched"}),o.jsx("div",{className:"anime-stat-value",children:Oe.toFixed(1)})]})]}),o.jsxs("section",{className:"anime-toolbar",children:[o.jsx("input",{type:"text",placeholder:"Search anime by title...",value:m,onChange:le=>y(le.target.value),className:"anime-input"}),o.jsxs("select",{value:x,onChange:le=>E(le.target.value),className:"anime-select",children:[o.jsx("option",{value:"all",children:"All statuses"}),o.jsx("option",{value:"watching",children:"Watching"}),o.jsx("option",{value:"completed",children:"Completed"}),o.jsx("option",{value:"on_hold",children:"On Hold"}),o.jsx("option",{value:"plan_to_watch",children:"Plan to Watch"}),o.jsx("option",{value:"dropped",children:"Dropped"})]})]}),C&&o.jsx("div",{className:"loading",children:"Loading anime list from MAL..."}),X&&o.jsx("div",{className:"error-state",children:X}),!C&&!X&&o.jsx(o.Fragment,{children:d.length===0?o.jsx("div",{className:"empty-state",children:"No results match your filters yet."}):o.jsx("section",{className:"anime-grid",children:d.map(le=>nt(le))})})]}),H.length>0&&o.jsxs("aside",{className:"anime-updates-float",children:[o.jsxs("div",{className:"anime-updates-header",children:[o.jsx("h3",{children:"Recent Updates"}),o.jsx("span",{className:"anime-updates-caption",children:"Last list activity"})]}),o.jsx("div",{className:"anime-updates-list",children:H.map(le=>ge(le))})]}),Te&&o.jsx(gw,{open:O,title:"Suggest an Anime",placeholder:"Type an anime you'd like me to watch...",value:P,status:J,loading:Ie,onChange:b,onSubmit:Ve,onClose:()=>D(!1)}),z&&o.jsx("div",{className:"modal-backdrop visible",onClick:le=>{le.target===le.currentTarget&&se(null)},children:o.jsxs("div",{className:"anime-modal",children:[o.jsxs("div",{className:"anime-modal-header",children:[o.jsx("h2",{style:{color:"#ffb6c1",margin:0},children:z.title}),o.jsx("button",{className:"anime-modal-close",onClick:()=>se(null),type:"button","aria-label":"Close",children:"X"})]}),o.jsxs("div",{className:"anime-modal-body",children:[o.jsx("div",{children:o.jsx("img",{className:"anime-modal-cover",src:z.image||"https://imgur.com/chUgq4W.png",alt:z.title})}),o.jsxs("div",{className:"anime-modal-meta",children:[o.jsxs("div",{children:[o.jsx("strong",{children:"Status:"})," ",s(z.status)]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Episodes:"})," ",z.episodes?z.episodes:"Unknown"]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Progress:"})," ",Number.isFinite(Number(z.watchedEpisodes))?`Episode ${z.watchedEpisodes}${Number.isFinite(Number(z.episodes))?`/${z.episodes}`:""}`:"Unknown"]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Score:"})," ",Number.isFinite(Number(z.score))&&Number(z.score)>0?z.score:"Not rated"]})]}),o.jsx(IR,{modalItem:z,modalLoading:ve,modalSynopsisShown:ie,onReveal:async()=>{if(!z)return;I(!0);const le=z.id;if(!le)return;const Me=we[le];if(Me!==void 0){se(pe=>pe&&{...pe,synopsis:Me});return}L(!0);try{const pe=await TR(le);_e(qe=>({...qe,[le]:pe||""})),se(qe=>qe&&{...qe,synopsis:pe||""})}catch{_e(qe=>({...qe,[le]:""})),se(qe=>qe&&{...qe,synopsis:""})}finally{L(!1)}}})]})]})})]})}function IR({modalItem:n,modalLoading:e,modalSynopsisShown:t,onReveal:s}){var m;const a=((m=n==null?void 0:n.synopsis)==null?void 0:m.trim())||"",[l,d]=j.useState(0),f=j.useRef(null);return j.useEffect(()=>{if(t&&f.current){const y=f.current.scrollHeight+12;d(y)}else d(0)},[t,a]),o.jsxs("div",{className:"anime-modal-summary",children:[o.jsxs("div",{className:"anime-modal-summary-header",children:[o.jsx("h3",{children:"Synopsis"}),!t&&o.jsx("button",{className:"anime-synopsis-btn",type:"button",onClick:s,children:e?"Loading...":"Reveal Synopsis"})]}),o.jsx("div",{className:`anime-modal-summary-body ${t?"is-open":""}`,style:{maxHeight:t?`${l}px`:0,opacity:t?1:0},children:o.jsx("div",{ref:f,children:o.jsx("p",{className:"anime-modal-summary-text",children:e&&!a?"Loading synopsis...":a||"No synopsis available."})})}),!t&&o.jsx("p",{className:"anime-modal-summary-text anime-modal-summary-hint",children:"Synopsis hidden. Click reveal to view."})]})}function NR(){const n={game:"pokemon",name:"",setName:"",number:"",rarity:"",condition:"",quantity:1,pricePaid:"",estimatedValue:"",image:"",productURL:"",notes:""},{admin:e,user:t}=Qa(),[s,a]=j.useState(()=>localStorage.getItem("tcgLastGame")||n.game),[l,d]=j.useState([]),[f,m]=j.useState(!0),[y,x]=j.useState(""),[E,C]=j.useState("all"),[U,X]=j.useState("name"),[W,z]=j.useState(!1),[se,we]=j.useState([]),[_e,ve]=j.useState(""),[L,ie]=j.useState(null),[I,N]=j.useState(!1),[A,O]=j.useState(()=>({...n,game:s}));j.useEffect(()=>{document.title="TCG | Collection"},[]),j.useEffect(()=>{let k=!1;const H=async()=>{if(!k)try{const De=await fetch("/base/tcg-collection.json",{cache:"no-cache"});if(!De.ok)throw new Error("fallback fetch failed");const Oe=await De.json(),Qe=Array.isArray(Oe.tcg)?Oe.tcg:[];k||d(Qe.map((nt,ge)=>({id:nt.id||`offline-${ge}`,...nt})))}catch(Ve){console.error("TCG offline fallback failed",Ve)}finally{k||m(!1)}};async function Te(){m(!0);try{const Ve=bn(st,"tcg"),De=await Is(Ve),Oe=[];De.forEach(Qe=>Oe.push({id:Qe.id,...Qe.data()})),k||d(Oe)}catch(Ve){console.error("Error loading TCG:",Ve),await H()}finally{k||m(!1)}}return Te(),()=>{k=!0}},[t]);const D=l.filter(k=>{if(E!=="all"&&k.game!==E)return!1;if(!y)return!0;const H=y.toLowerCase();return(k.name||"").toLowerCase().includes(H)||(k.setName||"").toLowerCase().includes(H)||(k.number||"").toLowerCase().includes(H)}),P=[...D].sort((k,H)=>{const Te=(k.name||"").toLowerCase(),Ve=(H.name||"").toLowerCase(),De=(k.setName||"").toLowerCase(),Oe=(H.setName||"").toLowerCase(),Qe=(k.rarity||"").toLowerCase(),nt=(H.rarity||"").toLowerCase(),ge=Number(k.quantity||0),le=Number(H.quantity||0),Me=Number(k.estimatedValue||0)*Math.max(1,ge),pe=Number(H.estimatedValue||0)*Math.max(1,le);switch(U){case"set":return De.localeCompare(Oe)||Te.localeCompare(Ve);case"rarity":return Qe.localeCompare(nt)||Te.localeCompare(Ve);case"quantity":return le-ge||Te.localeCompare(Ve);case"value":return pe-Me||Te.localeCompare(Ve);case"name":default:return Te.localeCompare(Ve)}}),b=l.reduce((k,H)=>{const Te=Number(H.quantity||1),Ve=Number(H.pricePaid||0),De=Number(H.estimatedValue||0);k.totalCards+=Te,k.totalPaid+=Te*Ve,k.totalValue+=Te*De;const Oe=(H.game||"").toLowerCase(),Qe=Te*De;return Oe==="pokemon"?(k.pokemon+=Te,k.valueByGame.pokemon+=Qe):Oe==="onepiece"?(k.onepiece+=Te,k.valueByGame.onepiece+=Qe):Oe==="mtg"?(k.mtg+=Te,k.valueByGame.mtg+=Qe):k.valueByGame.other+=Qe,k},{totalCards:0,totalPaid:0,totalValue:0,pokemon:0,onepiece:0,mtg:0,valueByGame:{pokemon:0,onepiece:0,mtg:0,other:0}}),J=b.totalValue-b.totalPaid,re=[["Pokemon",b.valueByGame.pokemon],["One Piece",b.valueByGame.onepiece],["MTG",b.valueByGame.mtg],["Other",b.valueByGame.other]].filter(([,k])=>k>0).map(([k,H])=>`${k}: $${H.toFixed(2)}`),Ie=re.length?re.join(`
`):"No value data yet",he=(k,H)=>{if(k==="game"){a(H);try{localStorage.setItem("tcgLastGame",H)}catch{}}O(Te=>({...Te,[k]:H}))},ce=async()=>{if(!e)return;if(!A.name.trim()){alert("Card name is required.");return}const k={game:A.game,name:A.name.trim(),setName:A.setName.trim(),number:A.number.trim(),rarity:A.rarity.trim(),condition:A.condition.trim(),quantity:Number(A.quantity||1),pricePaid:Number(A.pricePaid||0),estimatedValue:Number(A.estimatedValue||0),image:A.image.trim(),productURL:A.productURL.trim(),notes:A.notes.trim()},H=De=>({game:(De.game||"").toLowerCase().trim(),name:(De.name||"").toLowerCase().trim(),setName:(De.setName||"").toLowerCase().trim(),number:(De.number||"").toLowerCase().trim(),rarity:(De.rarity||"").toLowerCase().trim(),condition:(De.condition||"").toLowerCase().trim(),pricePaid:Number(De.pricePaid||0),estimatedValue:Number(De.estimatedValue||0),image:(De.image||"").trim(),productURL:(De.productURL||"").trim(),notes:(De.notes||"").trim()}),Te=H(k),Ve=l.find(De=>{const Oe=H(De);return Oe.game===Te.game&&Oe.name===Te.name&&Oe.setName===Te.setName&&Oe.number===Te.number&&Oe.rarity===Te.rarity&&Oe.condition===Te.condition&&Oe.pricePaid===Te.pricePaid&&Oe.estimatedValue===Te.estimatedValue&&Oe.image===Te.image&&Oe.productURL===Te.productURL&&Oe.notes===Te.notes});try{const De=bn(st,"tcg");if(Ve!=null&&Ve.id){const Oe=Number(Ve.quantity||1)+k.quantity;await Ns(Pt(st,"tcg",Ve.id),{quantity:Oe}),d(Qe=>Qe.map(nt=>nt.id===Ve.id?{...nt,quantity:Oe}:nt))}else{await Oa(De,k);const Oe=await Is(De),Qe=[];Oe.forEach(nt=>Qe.push({id:nt.id,...nt.data()})),d(Qe)}O({...n,game:s}),N(!1)}catch(De){console.error("Error adding card:",De),alert("Failed to save card.")}},Pe=async()=>{if(!e||!L)return;if(!L.name.trim()){alert("Card name is required.");return}const k={game:L.game,name:L.name.trim(),setName:L.setName.trim(),number:L.number.trim(),rarity:L.rarity.trim(),condition:L.condition.trim(),quantity:Number(L.quantity||1),pricePaid:Number(L.pricePaid||0),estimatedValue:Number(L.estimatedValue||0),image:L.image?L.image.trim():"",productURL:L.productURL?L.productURL.trim():"",notes:L.notes?L.notes.trim():""};try{await Ns(Pt(st,"tcg",L.id),k),d(H=>H.map(Te=>Te.id===L.id?{...Te,...k}:Te)),ie(null)}catch(H){console.error("Error updating card:",H),alert("Failed to update card.")}},xe=async k=>{if(e&&window.confirm("Delete this card?"))try{await Ma(Pt(st,"tcg",k)),d(H=>H.filter(Te=>Te.id!==k))}catch(H){console.error("Delete error:",H),alert("Failed to delete card.")}},Y=()=>{if(!l.length){alert("No cards to export.");return}const k=new Blob([JSON.stringify({tcg:l},null,2)],{type:"application/json"}),H=URL.createObjectURL(k),Te=document.createElement("a");Te.href=H,Te.download="tcg-collection.json",Te.click(),URL.revokeObjectURL(H)};return o.jsxs("main",{className:"page",children:[o.jsxs("header",{style:{marginTop:"32px",marginBottom:"16px",display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",gap:"6px"},children:[o.jsx("h1",{style:{margin:0,fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Tyler's TCG Collection"}),o.jsx("p",{style:{margin:"6px 0 0",color:"var(--text-soft)",fontSize:"0.9rem"},children:"Check out my TCG Collection with all the data of how much I spent (Under construction) and how much my collection is worth in total!"}),e&&o.jsx("div",{style:{marginTop:"10px"},children:o.jsx("button",{className:"manga-btn secondary",type:"button",onClick:Y,children:"Export JSON"})})]}),e&&o.jsx("button",{className:"manga-btn",type:"button","aria-label":"Add card",onClick:()=>N(!0),style:{position:"fixed",bottom:"20px",right:"20px",zIndex:1e3,width:"56px",height:"56px",borderRadius:"50%",padding:0,fontSize:"28px",display:"flex",alignItems:"center",justifyContent:"center"},children:"+"}),e&&I&&o.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(8,1,10,0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,padding:"12px"},onClick:k=>{k.target===k.currentTarget&&N(!1)},children:o.jsxs("div",{style:{width:"min(720px, 95vw)",background:"#140710",border:"1px solid rgba(255,182,193,0.3)",borderRadius:"12px",padding:"14px",boxShadow:"0 24px 60px rgba(0,0,0,0.85)"},onClick:k=>k.stopPropagation(),children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx("h2",{style:{margin:0,color:"#ffb6c1"},children:"Add card"}),o.jsx("button",{className:"dashboard-close",onClick:()=>N(!1),type:"button","aria-label":"Close",children:"X"})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"180px 1fr",gap:"12px",alignItems:"flex-start",marginTop:"10px"},children:[o.jsx("div",{style:{width:"100%",maxWidth:"180px",borderRadius:"10px",border:"1px solid rgba(255,182,193,0.25)",background:"#1e0d14",overflow:"hidden",aspectRatio:"3 / 4",display:"flex",alignItems:"center",justifyContent:"center"},children:A.image?o.jsx("img",{src:A.image,alt:"Card preview",style:{width:"100%",height:"100%",objectFit:"cover"}}):o.jsx("div",{style:{color:"var(--text-soft)",fontSize:"0.8rem",padding:"6px"},children:"No image"})}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:"8px"},children:[o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Game",o.jsxs("select",{value:A.game,onChange:k=>he("game",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"},children:[o.jsx("option",{value:"pokemon",children:"Pokemon"}),o.jsx("option",{value:"onepiece",children:"One Piece"}),o.jsx("option",{value:"mtg",children:"MTG"})]})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Card name",o.jsx("input",{type:"text",value:A.name,onChange:k=>he("name",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Set name",o.jsx("input",{type:"text",value:A.setName,onChange:k=>he("setName",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Card number",o.jsx("input",{type:"text",value:A.number,onChange:k=>he("number",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Rarity",o.jsx("input",{type:"text",value:A.rarity,onChange:k=>he("rarity",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Condition",o.jsx("input",{type:"text",value:A.condition,onChange:k=>he("condition",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Quantity",o.jsx("input",{type:"number",min:"1",value:A.quantity,onChange:k=>he("quantity",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Price paid (per card)",o.jsx("input",{type:"number",step:"0.01",min:"0",value:A.pricePaid,onChange:k=>he("pricePaid",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Estimated value (per card)",o.jsx("input",{type:"number",step:"0.01",min:"0",value:A.estimatedValue,onChange:k=>he("estimatedValue",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Image URL",o.jsx("input",{type:"text",value:A.image||"",onChange:k=>he("image",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Product URL (backend only)",o.jsx("input",{type:"text",value:A.productURL||"",onChange:k=>he("productURL",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{gridColumn:"1 / -1",fontSize:"0.8rem",color:"var(--text-soft)"},children:["Notes",o.jsx("textarea",{value:A.notes,onChange:k=>he("notes",k.target.value),rows:3,style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff",resize:"vertical"}})]})]})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"12px"},children:[o.jsx("button",{onClick:()=>{O(n),N(!1)},style:{padding:"6px 12px",borderRadius:"999px",border:"1px solid rgba(255,182,193,0.5)",background:"transparent",color:"#ffb6c1",cursor:"pointer"},children:"Cancel"}),o.jsx("button",{onClick:ce,style:{padding:"6px 12px",borderRadius:"999px",border:"none",cursor:"pointer",fontWeight:600,background:"#ff69b4",color:"#1e0d14"},children:"Save card"})]})]})}),e&&L&&o.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(8,1,10,0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,padding:"12px"},onClick:k=>{k.target===k.currentTarget&&ie(null)},children:o.jsxs("div",{style:{width:"min(720px, 95vw)",background:"#140710",border:"1px solid rgba(255,182,193,0.3)",borderRadius:"12px",padding:"14px",boxShadow:"0 24px 60px rgba(0,0,0,0.85)"},onClick:k=>k.stopPropagation(),children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx("h2",{style:{margin:0,color:"#ffb6c1"},children:"Edit card"}),o.jsx("button",{className:"dashboard-close",onClick:()=>ie(null),type:"button","aria-label":"Close",children:"X"})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"180px 1fr",gap:"12px",alignItems:"flex-start",marginTop:"10px"},children:[o.jsx("div",{style:{width:"100%",maxWidth:"180px",borderRadius:"10px",border:"1px solid rgba(255,182,193,0.25)",background:"#1e0d14",overflow:"hidden",aspectRatio:"3 / 4",display:"flex",alignItems:"center",justifyContent:"center"},children:L.image?o.jsx("img",{src:L.image,alt:"Card preview",style:{width:"100%",height:"100%",objectFit:"cover"}}):o.jsx("div",{style:{color:"var(--text-soft)",fontSize:"0.8rem",padding:"6px"},children:"No image"})}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:"8px"},children:[o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Game",o.jsxs("select",{value:L.game,onChange:k=>ie(H=>({...H,game:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"},children:[o.jsx("option",{value:"pokemon",children:"Pokemon"}),o.jsx("option",{value:"onepiece",children:"One Piece"}),o.jsx("option",{value:"mtg",children:"MTG"})]})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Card name",o.jsx("input",{type:"text",value:L.name,onChange:k=>ie(H=>({...H,name:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Set name",o.jsx("input",{type:"text",value:L.setName,onChange:k=>ie(H=>({...H,setName:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Card number",o.jsx("input",{type:"text",value:L.number,onChange:k=>ie(H=>({...H,number:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Rarity",o.jsx("input",{type:"text",value:L.rarity,onChange:k=>ie(H=>({...H,rarity:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Condition",o.jsx("input",{type:"text",value:L.condition,onChange:k=>ie(H=>({...H,condition:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Quantity",o.jsx("input",{type:"number",value:L.quantity,onChange:k=>ie(H=>({...H,quantity:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Price paid (each)",o.jsx("input",{type:"number",value:L.pricePaid,onChange:k=>ie(H=>({...H,pricePaid:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Estimated value (each)",o.jsx("input",{type:"number",value:L.estimatedValue,onChange:k=>ie(H=>({...H,estimatedValue:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Image URL",o.jsx("input",{type:"text",value:L.image||"",onChange:k=>ie(H=>({...H,image:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Product URL (backend only)",o.jsx("input",{type:"text",value:L.productURL||"",onChange:k=>ie(H=>({...H,productURL:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{gridColumn:"1 / -1",fontSize:"0.8rem",color:"var(--text-soft)"},children:["Notes",o.jsx("textarea",{value:L.notes||"",onChange:k=>ie(H=>({...H,notes:k.target.value})),rows:3,style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff",resize:"vertical"}})]})]})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"12px"},children:[o.jsx("button",{onClick:()=>ie(null),style:{padding:"6px 12px",borderRadius:"999px",border:"1px solid rgba(255,182,193,0.5)",background:"transparent",color:"#ffb6c1",cursor:"pointer"},children:"Cancel"}),o.jsx("button",{onClick:Pe,style:{padding:"6px 12px",borderRadius:"999px",border:"none",cursor:"pointer",fontWeight:600,background:"#ff69b4",color:"#1e0d14"},children:"Save changes"})]})]})}),o.jsxs("section",{style:{display:"flex",flexWrap:"wrap",gap:"12px",marginTop:"18px",justifyContent:"center"},children:[o.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[o.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Total cards"}),o.jsx("div",{style:{fontSize:"1.1rem",fontWeight:700},children:b.totalCards})]}),b.totalPaid>0&&o.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[o.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Total paid"}),o.jsxs("div",{style:{fontSize:"1.1rem",fontWeight:700},children:["$",b.totalPaid.toFixed(2)]})]}),o.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},title:Ie,children:[o.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Total value"}),o.jsxs("div",{style:{fontSize:"1.1rem",fontWeight:700},children:["$",b.totalValue.toFixed(2)]})]}),b.totalPaid>0&&o.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[o.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Unrealized gain / loss"}),o.jsxs("div",{style:{fontSize:"1.1rem",fontWeight:700,color:J>=0?"#00e676":"#ff8a80"},children:[J>=0?"+":"-","$",Math.abs(J).toFixed(2)]})]}),o.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[o.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Pokemon cards"}),o.jsx("div",{style:{fontSize:"1.1rem",fontWeight:700},children:b.pokemon})]}),o.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[o.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"One Piece cards"}),o.jsx("div",{style:{fontSize:"1.1rem",fontWeight:700},children:b.onepiece})]}),o.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[o.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"MTG cards"}),o.jsx("div",{style:{fontSize:"1.1rem",fontWeight:700},children:b.mtg})]})]}),o.jsxs("section",{style:{display:"flex",flexWrap:"wrap",gap:"10px",marginTop:"16px"},children:[o.jsx("input",{type:"text",placeholder:"Search by name, set, or number...",value:y,onChange:k=>x(k.target.value),style:{flex:"1 1 220px",minWidth:"220px",padding:"8px 12px",borderRadius:"999px",border:"1px solid #bb7f8f",background:"#2b0f1d",color:"#fff"}}),o.jsxs("select",{value:E,onChange:k=>C(k.target.value),style:{flex:"0 0 220px",padding:"8px 12px",borderRadius:"999px",border:"1px solid #bb7f8f",background:"#2b0f1d",color:"#fff"},children:[o.jsx("option",{value:"all",children:"All games"}),o.jsx("option",{value:"pokemon",children:"Pokemon only"}),o.jsx("option",{value:"onepiece",children:"One Piece only"}),o.jsx("option",{value:"mtg",children:"MTG only"})]}),o.jsxs("select",{value:U,onChange:k=>X(k.target.value),style:{flex:"0 0 220px",padding:"8px 12px",borderRadius:"999px",border:"1px solid #bb7f8f",background:"#2b0f1d",color:"#fff"},children:[o.jsx("option",{value:"name",children:"Sort: Name (A-Z)"}),o.jsx("option",{value:"set",children:"Sort: Set (A-Z)"}),o.jsx("option",{value:"rarity",children:"Sort: Rarity (A-Z)"}),o.jsx("option",{value:"quantity",children:"Sort: Quantity (high to low)"}),o.jsx("option",{value:"value",children:"Sort: Value (high to low)"})]})]}),f?o.jsx("p",{style:{marginTop:"20px",color:"var(--text-soft)"},children:"Loading TCG collection..."}):D.length===0?o.jsx("p",{style:{marginTop:"20px",color:"var(--text-soft)"},children:"No cards found."}):o.jsx("section",{className:"grid",style:{gridTemplateColumns:"repeat(auto-fill, minmax(170px, 1fr))",marginTop:"20px"},children:P.map(k=>{const H=Number(k.quantity||1),Te=H*Number(k.pricePaid||0),Ve=H*Number(k.estimatedValue||0);return o.jsxs("article",{style:{background:"#2b0f1d",borderRadius:"12px",border:"1px solid rgba(255,182,193,0.25)",boxShadow:"0 4px 16px rgba(0,0,0,0.55)",padding:"10px",fontSize:"0.82rem",display:"flex",flexDirection:"column",gap:"6px"},children:[k.image&&o.jsx("div",{style:{width:"100%",paddingTop:"140%",position:"relative",overflow:"hidden",borderRadius:"10px",background:"#1e0d14"},children:o.jsx("img",{src:k.image,alt:k.name||"card image",style:{position:"absolute",inset:0,width:"100%",height:"100%",objectFit:"contain"}})}),o.jsx("div",{style:{fontWeight:700,color:"#ffb6c1",marginBottom:"4px"},children:k.name||"Unnamed card"}),o.jsx("div",{style:{color:"var(--text-soft)",marginBottom:"4px"},children:k.setName||""}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",color:"var(--text-soft)"},children:[o.jsxs("span",{children:["#",k.number||"-"]}),o.jsx("span",{children:k.rarity||""})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",color:"var(--text-soft)",marginTop:"4px"},children:[o.jsxs("span",{children:["Cond: ",k.condition||"N/A"]}),o.jsxs("span",{children:["Qty: ",H]})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",color:"var(--text-soft)",marginTop:"4px"},children:[o.jsxs("span",{children:["Paid: $",Te.toFixed(2)]}),o.jsxs("span",{children:["Value: $",Ve.toFixed(2)]})]}),k.notes&&o.jsxs("div",{style:{color:"#9c8fa6",fontSize:"0.72rem",fontStyle:"italic",textAlign:"center",marginTop:"6px"},children:['"',k.notes,'"']}),o.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"8px"},children:[o.jsx("span",{style:{padding:"2px 7px",borderRadius:"999px",background:"rgba(255,105,180,0.18)",border:"1px solid rgba(255,105,180,0.5)",color:"#ffb6c1",fontSize:"0.7rem",whiteSpace:"nowrap"},children:{pokemon:"Pokemon",onepiece:"One Piece",mtg:"MTG"}[k.game]||"Other"}),e&&o.jsxs("div",{style:{display:"flex",gap:"6px",alignItems:"center",marginLeft:"auto"},children:[o.jsx("button",{onClick:()=>ie({...k,pricePaid:k.pricePaid??"",estimatedValue:k.estimatedValue??"",quantity:k.quantity??1}),style:{padding:"3px 8px",borderRadius:"999px",border:"1px solid rgba(255,182,193,0.5)",background:"rgba(255,105,180,0.15)",color:"#ffb6c1",fontSize:"0.7rem",cursor:"pointer"},children:"Edit"}),o.jsx("button",{onClick:()=>xe(k.id),style:{padding:"3px 8px",borderRadius:"999px",border:"1px solid rgba(244,67,54,0.7)",background:"rgba(244,67,54,0.12)",color:"#ff8a80",fontSize:"0.7rem",cursor:"pointer"},children:"Delete"})]})]})]},k.id)})})]})}const Pl="https://discord.com/api/webhooks/1448287168845054004/cGWGPoH5LaTFlBZ1vxtgMjOfV9au6qyQ_9ZRnOWN9-AX0MNfwxKNWVcZYQHz0ESA7_4k",Rl="https://discord.com/api/webhooks/1448288240871276616/101WI-B2p8tDR34Hl9fZxxb0QG01f1Eo5w1IvbttlQmP2wWFNJ0OI7UnJfJujKRNWW2Q",S_="readNextState";function Ya(n){const e=n==null?"":String(n);return e.trim()?e.replace(/\s*,?\s*(?:vol(?:ume)?\.?)\s+\d+.*$/i,"").trim():""}function xi(n){if(!n)return null;if(n instanceof Date)return n;if(n&&typeof n.toDate=="function")return n.toDate();const e=String(n).trim();if(!e)return null;const t=e.match(/^(\d{4})-(\d{2})-(\d{2})$/);if(t){const[,l,d,f]=t;return new Date(Number(l),Number(d)-1,Number(f))}const s=e.match(/^(\d{1,2})\/(\d{1,2})\/(\d{2,4})$/);if(s){let[,l,d,f]=s;const m=f.length===2?+`20${f}`:Number(f);return new Date(m,Number(l)-1,Number(d))}const a=new Date(e);return isNaN(a.getTime())?null:a}function vc(n){const e=n.seriesKey||n.series||n.Series||n.title||n.Title||"",s=(Ya(e)||e).trim();return s?s.toLowerCase():""}function xw(n){const e=(n==null?void 0:n.series)||(n==null?void 0:n.Series)||(n==null?void 0:n.title)||(n==null?void 0:n.Title)||"Unknown Series";return Ya(e)||"Unknown Series"}function ad(n){const e=(n||"").trim(),t=e.match(/^(.*?)(?:,?\s*(?:vol\.|volume)\s*(\d+)(?:\s*[-]\s*\d+)?\s*)?(?:\s*\([^)]*\))?$/i),s=t?t[1].trim().toLowerCase():e.toLowerCase(),a=t&&t[2]?parseInt(t[2],10):0;return{name:s,vol:Number.isFinite(a)?a:0}}function PR(n,e){const t=(n==null?void 0:n.Title)||(n==null?void 0:n.title)||"",s=(e==null?void 0:e.Title)||(e==null?void 0:e.title)||"",a=ad(t),l=ad(s),d=a.name.localeCompare(l.name);return d!==0?d:a.vol!==l.vol?a.vol-l.vol:t.localeCompare(s)}function vf(){return{publisher:"",demographic:"",genre:"",subGenre:"",datePurchased:"",msrp:"",initialPublisher:"",initialDemographic:"",initialGenre:"",initialSubGenre:"",initialDatePurchased:"",initialMsrp:"",dateMixed:!1,readChecked:!1,readIndeterminate:!1}}function b_(){return{read:!1,datePurchased:"",dateRead:"",pageCount:"",msrp:"",amountPaid:"",rating:"",special:!1,specialType:"",specialVolumes:"",collectiblePrice:""}}function C_(n,e={}){const t=e.ignoreShared,s=(n==null?void 0:n.amountPaid)??(n==null?void 0:n.AmountPaid)??(n==null?void 0:n.paid)??(n==null?void 0:n.Paid)??"",a=(n==null?void 0:n.msrp)??(n==null?void 0:n.MSRP)??"",l=((n==null?void 0:n.datePurchased)||(n==null?void 0:n.DatePurchased)||"").trim(),d=((n==null?void 0:n.publisher)||(n==null?void 0:n.Publisher)||"").trim(),f=((n==null?void 0:n.demographic)||(n==null?void 0:n.Demographic)||"").trim(),m=((n==null?void 0:n.genre)||(n==null?void 0:n.Genre)||"").trim(),y=((n==null?void 0:n.specialType)||(n==null?void 0:n.SpecialType)||"").trim(),x=(n==null?void 0:n.specialVolumes)??(n==null?void 0:n.SpecialVolumes)??(n==null?void 0:n.volumesContained)??"",E=(n==null?void 0:n.collectiblePrice)??(n==null?void 0:n.CollectiblePrice)??"",C=!!y,U=(n==null?void 0:n.pageCount)??(n==null?void 0:n.PageCount)??(n==null?void 0:n.pages)??(n==null?void 0:n.Pages)??"",X=U==null?"":String(U).trim(),W=Number(X),z=!X||Number.isNaN(W)||W<=0;return!C&&(s===""||s===null)||z||!l||!t&&(a===""||!d||!f||!m)||C&&!y||C&&y.toLowerCase()==="collectible"&&(E===""||E===null)||C&&y.toLowerCase()==="specialedition"&&(x===""||x===null)}function RR(n){const e=(n==null?void 0:n.amountPaid)??"",t=((n==null?void 0:n.datePurchased)||"").trim(),s=!!(n!=null&&n.specialType)||!!(n!=null&&n.special),a=((n==null?void 0:n.specialType)||"").trim(),l=(n==null?void 0:n.specialVolumes)??"",d=(n==null?void 0:n.collectiblePrice)??"",f=(n==null?void 0:n.pageCount)??"",m=(n==null?void 0:n.msrp)??"",y=((n==null?void 0:n.publisher)||"").trim(),x=((n==null?void 0:n.demographic)||"").trim(),E=((n==null?void 0:n.genre)||"").trim(),C=!s&&(e===""||e===null),U=s&&!a,X=s&&a.toLowerCase()==="collectible"&&(d===""||d===null),W=s&&a.toLowerCase()==="specialedition"&&(l===""||l===null),z=(()=>{const se=(f??"").toString().trim();if(se==="")return!0;const we=Number(se);return Number.isNaN(we)||we<=0})();return{amountPaid:C,datePurchased:!t,specialType:U,collectiblePrice:X,specialVolumes:W,pageCount:z,msrp:m===""||m===null,publisher:!y,demographic:!x,genre:!E}}function AR(n){return!n||!n.books||!n.books.length?!1:n.books.some(e=>{const t=(e==null?void 0:e.msrp)??(e==null?void 0:e.MSRP)??"",s=((e==null?void 0:e.publisher)||(e==null?void 0:e.Publisher)||"").trim(),a=((e==null?void 0:e.demographic)||(e==null?void 0:e.Demographic)||"").trim(),l=((e==null?void 0:e.genre)||(e==null?void 0:e.Genre)||"").trim();return t===""||!s||!a||!l})}function jR(n){const e=new Map;for(const t of n){const s=vc(t)||t.id;if(!e.has(s)){const m=Ya(t.series||t.Series||t.title||t.Title||"Unknown Series")||"Unknown Series";e.set(s,{key:s,title:m,publisher:t.publisher||t.Publisher||"",genre:t.genre||t.Genre||"",demographic:t.demographic||t.Demographic||"",volumes:0,totalPages:0,readPages:0,readVolumes:0,ratingSum:0,ratingCount:0})}const a=e.get(s);a.volumes+=1;const l=Number(t.pages||t.Pages||t.pageCount||0)||0;a.totalPages+=l,(!!t.read||t.status==="Read"||t.Read===!0)&&(a.readVolumes+=1,a.readPages+=l);const f=Number(t.rating||t.Rating);!isNaN(f)&&f>0&&(a.ratingSum+=f,a.ratingCount+=1)}return e}function Po(n,e,t=5){const s=new Map;for(const a of n.values()){const l=(a[e]||"").trim();if(!l)continue;const d=l.split(/[\/,]/).map(f=>f.trim()).filter(Boolean);for(const f of d)s.set(f,(s.get(f)||0)+1)}return[...s.entries()].sort((a,l)=>l[1]-a[1]).slice(0,t).map(([a,l])=>({name:a,count:l}))}function I_(n,e){const t=Array.from({length:12},(s,a)=>{const l=new Date(e,a,1);return{key:`${e}-${a}`,label:l.toLocaleString("default",{month:"short"}),year:e,month:a,value:0}});for(const s of n){const a=xi(s.dateRead||s.DateRead);!a||a.getFullYear()!==e||(t[a.getMonth()].value+=1)}return t}function Da(n){const e=n.getFullYear(),t=`${n.getMonth()+1}`.padStart(2,"0"),s=`${n.getDate()}`.padStart(2,"0");return`${e}-${t}-${s}`}async function N_(n,e){try{await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:e})})}catch(t){console.error("Webhook post failed",t)}}function kR(n){const e=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],t=Array(7).fill(0);for(const l of n){const d=xi(l.dateRead||l.DateRead);d&&(t[d.getDay()]+=1)}if(!t.some(l=>l>0))return[];const a=t.reduce((l,d)=>Math.max(l,d),0)||1;return e.map((l,d)=>({label:l,value:t[d],pct:t[d]/a}))}function DR(n,e=8){const t=[...n.values()];t.sort((l,d)=>d.volumes-l.volumes);const s=t.slice(0,e),a=s.reduce((l,d)=>Math.max(l,d.volumes),0)||1;return s.map(l=>({label:l.title,value:l.volumes,pct:l.volumes/a}))}function VR(n,e){const t=(a,l)=>{const d=xi(a.releaseDate||a.ReleaseDate||a.date||a.Date);if(!d)return null;const f=(a.title||a.series||a.Title||"Unknown Title").trim(),m=ad(f),y=m!=null&&m.vol?m.vol:null,x=f,E=!!(a.datePurchased||a.DatePurchased||"").trim(),C=Ya(x||"").toLowerCase();return{date:d,title:x,purchased:E,source:l,seriesKey:C,volume:y}},s=[];return(e||[]).forEach(a=>{const l=t(a,"wishlist");l&&s.push(l)}),(n||[]).forEach(a=>{const l=t(a,"library");l&&s.push(l)}),s.sort((a,l)=>a.date-l.date),s}function LR(n){const e=new Date;for(const t of n)if(t.date>=e)return t;return n[n.length-1]||null}function MR(n){let e=0,t=0;for(const s of n){const a=xi(s.datePurchased||s.DatePurchased),l=xi(s.dateRead||s.DateRead);if(!a||!l)continue;const d=l-a;d<=0||(e+=d/(1e3*60*60*24),t+=1)}return t?e/t:null}function OR(n){const e=new Map;for(const t of n){const s=xi(t.datePurchased||t.DatePurchased),a=xi(t.dateRead||t.DateRead);if(!s||!a)continue;const l=a-s;if(l<=0)continue;const d=l/(1e3*60*60*24),f=vc(t)||t.id,m=Ya(t.series||t.Series||t.title||t.Title||"Untitled")||"Untitled";e.has(f)||e.set(f,{key:f,title:m,total:0,count:0,min:d,max:d});const y=e.get(f);y.total+=d,y.count+=1,y.min=Math.min(y.min,d),y.max=Math.max(y.max,d)}return[...e.values()].filter(t=>t.count>0).map(t=>({...t,avg:t.total/t.count})).sort((t,s)=>s.avg-t.avg)}function FR(n){let e=0,t=0,s=0;for(const a of n){const l=Number(a.msrp||a.MSRP||0)||0,d=Number(a.amountPaid||a.AmountPaid||a.pricePaid||0)||l||0,f=Number(a.collectiblePrice||a.CollectiblePrice||0)||0;e+=l,t+=d,s+=f}return{msrpTotal:e,paidTotal:t,collectibleTotal:s}}function UR(n){const e=new Map;let t=0,s=0;n.forEach(l=>{const d=vc(l)||l.id;if(!d)return;const m=ad(l.title||l.Title||l.series||"").vol||0;e.has(d)||e.set(d,{key:d,title:xw(l),highestOwnedVolume:0,lastReadVolume:0,unreadCount:0,total:0,msrpSum:0,msrpCount:0});const y=e.get(d);y.total+=1,y.highestOwnedVolume=Math.max(y.highestOwnedVolume,m),!!l.read||l.status==="Read"||l.Read===!0?y.lastReadVolume=Math.max(y.lastReadVolume,m):y.unreadCount+=1;const E=Number(l.msrp||l.MSRP);!Number.isNaN(E)&&E>0&&(y.msrpSum+=E,y.msrpCount+=1,t+=E,s+=1)}),e.forEach(l=>{l.avgMsrp=l.msrpCount?l.msrpSum/l.msrpCount:null});const a=s?t/s:null;return{map:e,globalAvgMsrp:a}}function zR(n,e,t={},s=0){if(!n||!n.size)return null;const a=new Date,l=new Map;(e||[]).forEach(E=>{if(!E||!E.date||E.date<a)return;const C=E.seriesKey||Ya(E.title||"").toLowerCase();if(!C)return;const U=l.get(C);(!U||E.date<U.date)&&l.set(C,E)});const d=[...n.values()].filter(E=>E.unreadCount>0);if(!d.length)return null;let f=0;for(const E of d){const C=t!=null&&t[E.key]?new Date(t[E.key]):null;if(C&&C>a){E.snoozedUntil=C,E.score=-1/0;continue}const U=l.get(E.key)||null,X=U?Math.round((U.date-a)/(1e3*60*60*24)):null,W=U&&Number.isFinite(U.volume)?U.volume:null,z=W?Math.max(0,W-E.highestOwnedVolume-1):0,se=W?Math.max(E.highestOwnedVolume||0,W-1):E.highestOwnedVolume||E.total,we=Math.max(0,se-E.lastReadVolume),_e=W?Math.max(0,W-1-E.lastReadVolume):0,ve=Math.max(E.unreadCount,we,_e),L=Math.min(ve,8)/8,ie=X!=null&&X>=0?Math.max(0,120-X)/120:0,I=X!=null&&X<=45?.8:0,N=W?Math.min(z,12)/12:0,A=z>=6?.6:0,O=.85+Math.abs(Math.sin(s+f+1))%.35,D=1+L*1.2+ie*1.4+I-N*1.6-A;E.score=Math.max(D,.05)*O,E.nextRelease=U,E.daysToRelease=X,E.catchUpTarget=se,E.behindCount=ve,E.upcomingVolume=W,E.ownedVolume=E.highestOwnedVolume,E.ownedVsUpcomingGap=z,f+=1}d.sort((E,C)=>C.score-E.score);const m=d.filter(E=>E.score>-1/0),y=m[0]||null,x=m.find((E,C)=>C>0&&E.unreadCount>0)||null;return{pick:y,backup:x}}function _f(n){const e={},t=Date.now();return!n||typeof n!="object"||Object.entries(n).forEach(([s,a])=>{const l=Number(a);Number.isFinite(l)&&l>t&&(e[s]=l)}),e}function $R(n,e,t){if(!n||!n.size)return null;const s=new Date,a=new Map;(e||[]).forEach(d=>{if(!d||!d.date||d.date<s)return;const f=d.seriesKey;if(!f)return;const m=a.get(f);(!m||d.date<m.date)&&a.set(f,d)});const l=[];return n.forEach(d=>{const f=a.get(d.key);if(!f)return;const m=f&&Number.isFinite(f.volume)?f.volume:null;if(!m)return;const y=Math.max(0,m-1-d.highestOwnedVolume);if(y<=0)return;const x=f.date instanceof Date?Math.round((f.date-s)/(1e3*60*60*24)):null,E=d.avgMsrp||t||0,C=E>0?E*y:0,U=E>0?1/(1+C/60):.7,X=x!=null&&x>=0?Math.max(0,120-x)/120:0,W=Math.min(y,12)/12,z=X*1.3+U*1.1+1/(1+y)-W*.9;l.push({...d,nextRelease:f,releaseVolume:m,daysToRelease:x,missingCount:y,costEstimate:C,avgMsrp:E,score:z})}),l.length?(l.sort((d,f)=>f.score-d.score),{pick:l[0],list:l}):null}function BR(n){const e=new Map;for(const t of n){const s=vc(t)||t.id;if(!e.has(s)){const E=t.series||t.Series||t.title||t.Title||"Untitled";e.set(s,{key:s,title:Ya(E)||E.trim()||"Untitled",msrp:0,paid:0,collectible:0,books:0,pages:0,readPages:0,ratings:[]})}const a=e.get(s);a.books+=1;const l=Number(t.msrp||t.MSRP||0)||0,d=Number(t.amountPaid||t.AmountPaid||t.pricePaid||0)||0,f=Number(t.collectiblePrice||t.CollectiblePrice||0)||0,m=Number(t.pages||t.Pages||t.pageCount||0)||0,y=!!t.read||t.status==="Read"||t.Read===!0;a.msrp+=l,a.paid+=d,a.collectible+=f,a.pages+=m,y&&(a.readPages+=m);const x=Number(t.rating||t.Rating);!isNaN(x)&&x>0&&a.ratings.push(x)}return[...e.values()]}function WR(n){let e=0,t=0;for(const s of n){const a=Number(s.pages||s.Pages||s.pageCount||0)||0;e+=a,(!!s.read||s.status==="Read"||s.Read===!0)&&(t+=a)}return{total:e,read:t}}function GR(n){let e=0,t=0;for(const s of n.values())s.ratingCount>0&&(e+=s.ratingSum/s.ratingCount,t+=1);return t?e/t:null}function qR({data:n}){if(!n||!n.length)return o.jsx("div",{className:"line-chart empty",children:"No reading data yet."});const e=n.reduce((y,x)=>Math.max(y,x.value),0)||1,t=480,s=230,a=30,l=s-a*2,d=t/Math.max(n.length-1,1),f=n.map((y,x)=>{const E=x*d,C=s-a-y.value/e*l;return{...y,x:E,y:C}}),m=f.map((y,x)=>x===0?`M ${y.x} ${y.y}`:`L ${y.x} ${y.y}`).join(" ");return o.jsx("div",{className:"line-chart",children:o.jsxs("svg",{viewBox:`0 0 ${t} ${s}`,width:"100%",height:"100%",preserveAspectRatio:"xMidYMid meet",children:[[0,.25,.5,.75,1].map((y,x)=>{const E=s-a-y*l;return o.jsx("line",{className:"line-grid",x1:"0",x2:t,y1:E,y2:E},`h-${x}`)}),f.map((y,x)=>o.jsx("line",{className:"line-grid",x1:y.x,x2:y.x,y1:a/2,y2:s-a/2},`v-${x}`)),o.jsx("path",{className:"line-path",d:m}),f.map((y,x)=>o.jsxs("g",{children:[o.jsx("circle",{className:"line-point",cx:y.x,cy:y.y,r:"1.5"}),o.jsx("text",{className:"line-value",x:y.x,y:y.y-3,children:y.value}),o.jsx("text",{className:"line-label",x:y.x,y:s-4,children:y.label})]},x))]})})}function HR({data:n}){return!n||!n.length?o.jsx("div",{className:"weekday-breakdown empty",children:"No reads recorded yet."}):o.jsx("div",{className:"weekday-bars",children:n.map(e=>o.jsxs("div",{className:"weekday-col",children:[o.jsx("div",{className:"weekday-count",children:e.value}),o.jsx("div",{className:"weekday-bar-vert",children:o.jsx("div",{className:"weekday-bar-vert-fill",style:{height:`${Math.max(e.pct*100,e.value?6:0)}%`}})}),o.jsx("div",{className:"weekday-label",children:e.label})]},e.label))})}function P_(n,e,t){const s=n.getFullYear(),a=n.getMonth(),d=new Date(s,a,1).getDay(),f=new Date(s,a+1,0).getDate(),m=new Map;for(const E of e){const C=E.date;if(C.getFullYear()===s&&C.getMonth()===a){const U=C.getDate();m.has(U)||m.set(U,[]),m.get(U).push(E)}}const y=[];for(let E=0;E<d;E++)y.push({type:"pad"});for(let E=1;E<=f;E++){const C=Da(new Date(s,a,E));y.push({type:"day",day:E,releases:m.get(E)||[],dateKey:C,isToday:C===t})}const x=Math.ceil(y.length/7)*7;for(;y.length<x;)y.push({type:"pad"});return y}function KR(){const{user:n,admin:e,loading:t}=Qa(),[s,a]=j.useState([]),[l,d]=j.useState([]),[f,m]=j.useState(!0),[y,x]=j.useState(null),[E,C]=j.useState("-"),[U,X]=j.useState({yearly:Pl,release:Rl,activity:Va}),[W,z]=j.useState(new Set),[se,we]=j.useState(null),[_e,ve]=j.useState(null),[L,ie]=j.useState(new Set),[I,N]=j.useState(null),[A,O]=j.useState(""),D=j.useRef(null),[P,b]=j.useState(()=>vf()),[J,re]=j.useState(()=>b_()),[Ie,he]=j.useState([]),[ce,Pe]=j.useState(!1),[xe,Y]=j.useState([]),[k,H]=j.useState(!1),[Te,Ve]=j.useState([]),[De,Oe]=j.useState(!1),[Qe,nt]=j.useState(""),[ge,le]=j.useState({}),[Me,pe]=j.useState(()=>Math.random()),[qe,Ye]=j.useState(!1),[It,At]=j.useState(null),[wt,jt]=j.useState(null),sn=async()=>{if(e)try{H(!0);const $=(await Is(bn(st,"users"))).docs.map(K=>({uid:K.id,...K.data()}));Y($)}catch(T){console.error("Failed to load users",T)}finally{H(!1)}},un=async(T,$)=>{const K=(T||"").trim();if(!K){alert("UID is required.");return}try{await qs(Pt(st,"users",K),{role:$,updatedBy:(n==null?void 0:n.uid)||"manual",updatedAt:new Date().toISOString()},{merge:!0}),await sn()}catch(ue){console.error("Failed to update role",ue),alert("Failed to update role.")}},[Fn,lr]=j.useState(!1),[Gt,Kn]=j.useState(()=>new Date),[Ft,Ut]=j.useState(!1),[dn,Qn]=j.useState(()=>new Date),[In,Yn]=j.useState(null),[Dr,ds]=j.useState(!1),[cr,Un]=j.useState(()=>{const T=new Date;return{year:T.getFullYear(),month:T.getMonth()}}),[Vr,_r]=j.useState(null),[dt,Wr]=j.useState({open:!1,type:null}),Jn=new Date().getFullYear(),vn=j.useRef(null),zn=j.useRef(null);j.useEffect(()=>{document.title="Dashboard"},[]),j.useEffect(()=>(Fn||dt.open||ce||!!wt||Ft||!!In||Dr||!!Vr?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[Fn,dt.open,ce,wt,Ft,In,Dr,Vr]),j.useEffect(()=>{typeof window>"u"||(vn.current=localStorage.getItem("dashboard-yearly-posted"),zn.current=localStorage.getItem("dashboard-release-posted"))},[]),j.useEffect(()=>{if(!e)return;const T=Pt(st,"settings","webhooks");(async()=>{try{const $=await rc(T);if($.exists()){const K=$.data();X({yearly:K.yearly||Pl,release:K.release||Rl,activity:K.activity||Va})}else await qs(T,{yearly:Pl,release:Rl,activity:Va}),X({yearly:Pl,release:Rl,activity:Va})}catch($){console.error("Failed to load webhook settings",$)}})()},[e]),j.useEffect(()=>{if(!e)return;let T=!1;return(async()=>await sn())(),()=>{T=!0}},[e]),j.useEffect(()=>{let T=!1;if(!n||!e){Ve([]),nt("");return}return(async()=>{try{Oe(!0);const K=(await Is(bn(st,"suggestions"))).docs.map(ue=>{var Ae;const Ce=ue.data();let He=null;if((Ae=Ce==null?void 0:Ce.createdAt)!=null&&Ae.toDate)He=Ce.createdAt.toDate();else if(Ce!=null&&Ce.createdAt){const rt=new Date(Ce.createdAt);He=isNaN(rt.getTime())?null:rt}return{id:ue.id,...Ce,createdAt:He}});K.sort((ue,Ce)=>{var He,Ae,rt,pt;return(((Ae=(He=Ce.createdAt)==null?void 0:He.getTime)==null?void 0:Ae.call(He))||0)-(((pt=(rt=ue.createdAt)==null?void 0:rt.getTime)==null?void 0:pt.call(rt))||0)}),T||(Ve(K),nt(""))}catch($){console.error("Failed to load suggestions",$),T||(nt("Failed to load suggestions."),Ve([]))}finally{T||Oe(!1)}})(),()=>{T=!0}},[n,e]);const hs=async T=>{if(!(!e||!T))try{await Ma(Pt(st,"suggestions",T)),Ve($=>$.filter(K=>K.id!==T))}catch($){console.error("Failed to delete suggestion",$),nt("Failed to delete suggestion.")}};j.useEffect(()=>{let T=!1;async function $(){if(!n||!e){a([]),d([]),x(null),m(!1);return}try{m(!0);const[K,ue]=await Promise.all([Is(bn(st,"library")),Is(bn(st,"wishlist"))]);if(T)return;a(K.docs.map(Ce=>({id:Ce.id,...Ce.data()}))),d(ue.docs.map(Ce=>({id:Ce.id,...Ce.data()}))),x(null)}catch(K){console.error(K),T||x("Failed to load dashboard data.")}finally{T||m(!1)}}return $(),()=>{T=!0}},[n,e]);const{map:Nn,globalAvgMsrp:xr}=j.useMemo(()=>UR(s),[s]),Gr=j.useMemo(()=>{const T=s.length,$=s.filter(vs=>!!vs.read||vs.status==="Read"||vs.Read===!0).length,K=T-$,ue=T?Math.round($/T*100):0,Ce=l.length,He=jR(s),Ae=I_(s,Jn),rt=I_(s,Jn-1),pt=Ae.reduce((vs,wn)=>vs+wn.value,0),St=kR(s),ct=DR(He),qt=VR(s,l),Zn=LR(qt),Qt=MR(s),vt=FR(s),Jr=WR(s),Lt=GR(He),Tr=OR(s),kn=Po(He,"publisher",5),va=Po(He,"genre",5),Si=Po(He,"demographic",5),Xr=BR(s);return{totalLibrary:T,readCount:$,unreadCount:K,readPct:ue,wishlistCount:Ce,seriesMap:He,monthlyReads:Ae,prevYearReads:rt,currentYearReadsTotal:pt,weekdayBreakdown:St,topSeriesBars:ct,releases:qt,nextRelease:Zn,avgDays:Qt,purchaseToReadSeries:Tr,collectionValue:vt,pages:Jr,avgRating:Lt,topPublishers:kn,topGenres:va,topDemographics:Si,seriesAggregates:Xr}},[s,l,Jn]),{totalLibrary:qr,readCount:wr,unreadCount:js,readPct:ot,wishlistCount:Hr,seriesMap:Pn,monthlyReads:fs,prevYearReads:Xn,currentYearReadsTotal:ks,weekdayBreakdown:ur,topSeriesBars:Ti,releases:an,nextRelease:Zt,avgDays:Lr,purchaseToReadSeries:Rn,collectionValue:$n,pages:zt,avgRating:ps,topPublishers:Ds,topGenres:ms,topDemographics:gs,seriesAggregates:Kr}=Gr,dr=Zt?Zt.date:null,fa=!!y,ft=Da(new Date),_n=j.useMemo(()=>s.map(T=>{const $=xi(T.dateRead||T.DateRead);return!$||!(T.read||T.status==="Read"||T.Read===!0)?null:{date:$,title:T.title||T.Title||"Untitled"}}).filter(Boolean).sort((T,$)=>T.date-$.date),[s]),An=j.useMemo(()=>P_(dn,_n,ft),[dn,_n,ft]),en=j.useMemo(()=>{const T=new Map;return[...s,...l].forEach(K=>{const ue=xi(K.datePurchased||K.DatePurchased);if(!ue)return;const Ce=Da(ue);T.has(Ce)||T.set(Ce,[]),T.get(Ce).push({id:K.id||K.Title||K.title||Ce,title:K.title||K.Title||"Untitled"})}),T.forEach(K=>K.sort((ue,Ce)=>(ue.title||"").localeCompare(Ce.title||""))),T},[s,l]),w=j.useMemo(()=>{const{year:T,month:$}=cr,ue=new Date(T,$,1).getDay(),Ce=new Date(T,$+1,0).getDate();let He=!1;const Ae=[];for(let pt=0;pt<ue;pt+=1)Ae.push({type:"pad"});for(let pt=1;pt<=Ce;pt+=1){const St=new Date(T,$,pt),ct=Da(St),qt=en.get(ct)||[];qt.length&&(He=!0),Ae.push({type:"day",day:pt,dateKey:ct,items:qt,releases:qt,isToday:ct===ft})}const rt=Math.ceil(Ae.length/7)*7;for(;Ae.length<rt;)Ae.push({type:"pad"});return{cells:Ae,hasItems:He}},[cr,en,ft]);j.useEffect(()=>{try{const T=localStorage.getItem("dashboard.readNextSnoozed");if(!T)return;const $=JSON.parse(T);$&&typeof $=="object"&&le(_f($))}catch(T){console.error("Failed to load read-next snoozed state",T)}},[]),j.useEffect(()=>{if(!n){Ye(!1),le({}),pe(Math.random());return}let T=!1;return(async()=>{try{const $=Pt(st,S_,n.uid),K=await rc($);if(T)return;if(K.exists()){const ue=K.data()||{};ue.snoozed&&le(_f(ue.snoozed)),Number.isFinite(ue.seed)&&pe(ue.seed)}}catch($){console.error("Failed to load read-next state",$)}finally{T||Ye(!0)}})(),()=>{T=!0}},[n]),j.useEffect(()=>{const T=_f(ge);if(JSON.stringify(T)!==JSON.stringify(ge)){le(T);return}try{localStorage.setItem("dashboard.readNextSnoozed",JSON.stringify(T))}catch(K){console.error("Failed to persist read-next snoozed state",K)}if(!n||!qe)return;const $=Pt(st,S_,n.uid);(async()=>{try{await qs($,{snoozed:T,seed:Me,updatedAt:new Date().toISOString()},{merge:!0})}catch(K){console.error("Failed to persist read-next state",K)}})()},[ge,Me,n,qe]);const B=j.useMemo(()=>zR(Nn,an,ge,Me),[Nn,an,ge,Me]),F=(B==null?void 0:B.pick)||null,M=(B==null?void 0:B.backup)||null,G=(F==null?void 0:F.snoozedUntil)||null,me=(T=7)=>{if(!(F!=null&&F.key))return;const $=Date.now()+T*24*60*60*1e3;le(K=>({...K,[F.key]:$})),pe(K=>K+1)},ne=j.useMemo(()=>$R(Nn,an,xr),[Nn,an,xr]),je=(ne==null?void 0:ne.pick)||null,Se=j.useMemo(()=>{if(!s||!s.length)return[];const T=new Map;s.forEach(K=>{const ue=vc(K)||K.id,Ce=xw(K);T.has(ue)||T.set(ue,{seriesKey:ue,displayName:Ce,books:[]}),T.get(ue).books.push(K)});const $=Array.from(T.values()).map(K=>({...K,books:[...K.books].sort(PR)}));return $.sort((K,ue)=>K.displayName.localeCompare(ue.displayName)),$},[s]),We=j.useMemo(()=>Se.flatMap(T=>T.books.map($=>$.id)),[Se]);j.useEffect(()=>{_e&&(s.some(T=>T.id===_e)||ve(null))},[s,_e]),j.useEffect(()=>{se&&(Se.some(T=>T.seriesKey===se)||we(null))},[Se,se]),j.useEffect(()=>{if(!L.size)return;const T=new Set(s.map(K=>K.id)),$=Array.from(L).filter(K=>!T.has(K));$.length&&ie(K=>{const ue=new Set(K);return $.forEach(Ce=>ue.delete(Ce)),ue})},[s,L]),j.useEffect(()=>{const T=Array.from(L);if(!T.length){O("");return}const $=Array.from(new Set(T.map(K=>s.find(ue=>ue.id===K)).filter(Boolean).map(K=>{const ue=K.amountPaid??K.AmountPaid??"";return ue==null?"":String(ue)})));O($.length===1?$[0]:"")},[L,s]),j.useEffect(()=>{const T=Se.find(vt=>vt.seriesKey===se);if(!T){b(vf());return}const $=T.books,K=vt=>{const Jr=Array.from(new Set($.map(Lt=>{const Tr=vt(Lt);return Tr==null?"":String(Tr).trim()})));return Jr.length===1?Jr[0]:""},ue=K(vt=>vt.publisher||vt.Publisher),Ce=K(vt=>vt.demographic||vt.Demographic),He=K(vt=>vt.genre||vt.Genre),Ae=K(vt=>vt.subGenre||vt.SubGenre),rt=K(vt=>vt.msrp??vt.MSRP),pt=Array.from(new Set($.map(vt=>(vt.datePurchased||vt.DatePurchased||"").trim()).filter(Boolean))),St=pt.length>1,ct=St?"":pt[0]||"",qt=$.filter(vt=>!!vt.read||vt.status==="Read"||vt.Read===!0).length,Zn=qt===$.length&&$.length>0;b({publisher:ue,demographic:Ce,genre:He,subGenre:Ae,datePurchased:ct,msrp:rt,initialPublisher:ue,initialDemographic:Ce,initialGenre:He,initialSubGenre:Ae,initialDatePurchased:ct,initialMsrp:rt,dateMixed:St,readChecked:Zn,readIndeterminate:!Zn&&!(qt===0)})},[Se,se]),j.useEffect(()=>{D.current&&(D.current.indeterminate=P.readIndeterminate)},[P.readIndeterminate]),j.useEffect(()=>{const T=s.find(K=>K.id===_e);if(!T){re(b_());return}const $=!!T.read||T.status==="Read"||T.Read===!0;re({read:$,datePurchased:T.datePurchased||T.DatePurchased||"",dateRead:$&&(T.dateRead||T.DateRead)||"",pageCount:T.pageCount??T.PageCount??T.pages??T.Pages??"",msrp:T.msrp??T.MSRP??"",amountPaid:T.amountPaid??T.AmountPaid??"",rating:$?T.rating??T.Rating??"":"",special:!!(T.specialType||T.SpecialType),specialType:T.specialType??T.SpecialType??"",specialVolumes:T.specialVolumes??T.SpecialVolumes??"",collectiblePrice:T.collectiblePrice??T.CollectiblePrice??"",publisher:T.publisher||T.Publisher||"",demographic:T.demographic||T.Demographic||"",genre:T.genre||T.Genre||""})},[_e,s]),j.useEffect(()=>{if(!Xn||!Xn.length)return;const T=Jn-1,$=Xn.reduce((He,Ae)=>He+Ae.value,0);if(!$||(vn.current?parseInt(vn.current,10):null)===T)return;const ue=Xn.map(He=>`${He.label}: ${He.value}`).join(", "),Ce=`Yearly reads summary for ${T}: ${$} total. Breakdown: ${ue}`;N_(U.yearly,Ce).then(()=>{vn.current=String(T),typeof window<"u"&&localStorage.setItem("dashboard-yearly-posted",String(T))})},[Xn,Jn]),j.useEffect(()=>{if(!Zt||!an.length)return;const T=Da(Zt.date),$=Da(new Date);if(T>$||zn.current===T)return;const K=an.filter(Ce=>Da(Ce.date)===T);if(!K.length)return;const ue=`Wishlist releases for ${T}:
${K.map(Ce=>`- ${Ce.title}`).join(`
`)}`;N_(U.release,ue).then(()=>{zn.current=T,typeof window<"u"&&localStorage.setItem("dashboard-release-posted",T)})},[Zt,an]),j.useEffect(()=>{if(!dr){C("-");return}const T=()=>{const K=dr-new Date;if(K<=0){C("Released");return}const ue=Math.floor(K/1e3),Ce=Math.floor(ue/86400),He=Math.floor(ue%86400/3600).toString().padStart(2,"0"),Ae=Math.floor(ue%3600/60).toString().padStart(2,"0"),rt=Math.floor(ue%60).toString().padStart(2,"0");C(`${Ce}d ${He}:${Ae}:${rt}`)};T();const $=setInterval(T,1e3);return()=>clearInterval($)},[dr]),j.useEffect(()=>{if(!(typeof window>"u"))try{const T=localStorage.getItem(lm);if(!T)return;const $=JSON.parse(T);if(!Array.isArray($))return;const K=$.map(ue=>({message:ue.message,ts:ue.ts?new Date(ue.ts):new Date})).filter(ue=>ue.message);K.length&&he(K)}catch(T){console.warn("Failed to load activity log",T)}},[]);const de=async()=>{try{const T=await Is(bn(st,"library"));a(T.docs.map($=>({id:$.id,...$.data()})))}catch(T){console.error("Failed to refresh library",T),x($=>$||"Failed to refresh library data.")}},Je=T=>{const $=(T??"").toString().trim();if($==="")return"";const K=parseFloat($);return Number.isFinite(K)?K:""},Re=T=>{const $=(T??"").toString().trim();if($==="")return"";const K=parseInt($,10);return Number.isFinite(K)?K:""},ht=T=>{if(!T)return;const $={message:T,ts:new Date};he(K=>{const ue=[$,...K].slice(0,100);return yw(ue),ue}),vw(T,{email:(n==null?void 0:n.email)||"anonymous",name:(n==null?void 0:n.displayName)||"",webhookOverride:U.activity,persistLocal:!1})},Vs=T=>{z($=>{const K=new Set($);return K.has(T)?K.delete(T):K.add(T),K}),we(T),ve(null)},hr=(T,$,K)=>{const ue=T.metaKey||T.ctrlKey,Ce=T.shiftKey,He=We.indexOf($);let Ae=new Set(L);if(Ce&&I!==null&&He!==-1){const rt=Math.min(I,He),pt=Math.max(I,He);for(let St=rt;St<=pt;St+=1){const ct=We[St];ct&&Ae.add(ct)}}else ue?Ae.has($)?Ae.delete($):Ae.add($):Ae=new Set;ie(Ae),N(He),ve($),we(K),z(rt=>{const pt=new Set(rt);return pt.add(K),pt})},xn=()=>{ie(new Set),N(null)},fr=async()=>{if(!e){alert("Dashboard is read-only for your account.");return}const T=Array.from(L);if(!T.length){alert("Select books in Library Manager (use Ctrl/Cmd or Shift) before bulk editing.");return}const $=(A||"").toString().trim(),K=$!=="",ue=Je($);if(K&&ue===""){alert("Enter a valid number for Amount Paid.");return}try{await Promise.all(T.map(Ce=>Ns(Pt(st,"library",Ce),{amountPaid:K?ue:""}))),await de(),xn(),ht(`Updated amount paid for ${T.length} book${T.length===1?"":"s"} in library`),alert(`Applied Amount Paid to ${T.length} selection${T.length===1?"":"s"}.`)}catch(Ce){console.error("Failed to apply Amount Paid",Ce),alert("Failed to apply Amount Paid to selection.")}},Qr=async()=>{if(!e){alert("Dashboard is read-only for your account.");return}const T=Se.find(qt=>qt.seriesKey===se);if(!T||!T.books.length)return;const $=!P.readIndeterminate,K=!!P.readChecked,ue=P.datePurchased!==P.initialDatePurchased,Ce=P.msrp!==P.initialMsrp,He=P.publisher!==P.initialPublisher,Ae=P.demographic!==P.initialDemographic,rt=P.genre!==P.initialGenre,pt=P.subGenre!==P.initialSubGenre;if(!$&&!ue&&!Ce&&!He&&!Ae&&!rt&&!pt)return;const St=String(P.msrp??"").trim(),ct=Ce?Je(St):"";if(Ce&&St!==""&&ct===""){alert("Enter a valid number for MSRP.");return}try{const qt=[];if(T.books.forEach(Zn=>{const Qt={};$&&(Qt.read=K,Qt.dateRead=K?Zn.dateRead||Zn.DateRead||new Date().toISOString().slice(0,10):""),ue&&(Qt.datePurchased=P.datePurchased||""),Ce&&(Qt.msrp=P.msrp===""?"":ct),He&&(Qt.publisher=P.publisher||""),Ae&&(Qt.demographic=P.demographic||""),rt&&(Qt.genre=P.genre||""),pt&&(Qt.subGenre=P.subGenre||""),Object.keys(Qt).length&&qt.push(Ns(Pt(st,"library",Zn.id),Qt))}),!qt.length)return;await Promise.all(qt),await de(),ve(null),ht(`Updated series "${T.displayName||"Series"}" (${T.books.length} book${T.books.length===1?"":"s"})`),alert("Series updated.")}catch(qt){console.error("Failed to save series changes",qt),alert("Failed to update series.")}},Ls=async()=>{if(!e){alert("Dashboard is read-only for your account.");return}if(!_e)return;const T=!!J.read,$=String(J.msrp??"").trim(),K=String(J.amountPaid??"").trim(),ue=String(J.pageCount??"").trim(),Ce=String(J.rating??"").trim(),He=Je($),Ae=Je(K),rt=Re(ue),pt=Je(Ce);if($!==""&&He===""){alert("Enter a valid number for MSRP.");return}if(K!==""&&Ae===""){alert("Enter a valid number for Amount Paid.");return}if(ue!==""&&rt===""){alert("Enter a valid page count.");return}if(T&&Ce!==""&&pt===""){alert("Enter a valid rating.");return}const St=!!J.special,ct=Re(J.specialVolumes),qt=Je(J.collectiblePrice),Zn=String(J.specialVolumes??"").trim(),Qt=String(J.collectiblePrice??"").trim();if(St&&J.specialType==="specialEdition"&&Zn!==""&&ct===""){alert("Enter a valid number for volumes contained.");return}if(St&&J.specialType==="collectible"&&Qt!==""&&qt===""){alert("Enter a valid collectible price.");return}const vt=T?J.dateRead||new Date().toISOString().slice(0,10):"",Jr={read:T,datePurchased:J.datePurchased||"",dateRead:vt,msrp:J.msrp===""?"":He,amountPaid:J.amountPaid===""?"":Ae,pageCount:J.pageCount===""?"":rt,rating:T?J.rating===""?"":pt:"",specialType:St&&J.specialType||"",specialVolumes:St&&J.specialType==="specialEdition"?J.specialVolumes===""?"":ct:"",collectiblePrice:St&&J.specialType==="collectible"?J.collectiblePrice===""?"":qt:""};try{await Ns(Pt(st,"library",_e),Jr),await de();const Lt=s.find(kn=>kn.id===_e)||Nt,Tr=(Lt==null?void 0:Lt.Title)||(Lt==null?void 0:Lt.title)||"Untitled";ht(`Updated "${Tr}" in library`),alert("Saved changes.")}catch(Lt){console.error("Failed to save book changes",Lt),alert("Failed to save changes.")}},kt=()=>{we(null),ve(null),xn(),b(vf())},Ms=()=>{ve(null),N(null)},gt=Se.find(T=>T.seriesKey===se)||null,Nt=s.find(T=>T.id===_e)||null,Os=se?{msrp:!P.msrp,datePurchased:!P.datePurchased&&!P.dateMixed,publisher:!P.publisher,demographic:!P.demographic,genre:!P.genre}:{},pr=_e?RR({amountPaid:J.amountPaid,msrp:J.msrp,datePurchased:J.datePurchased,publisher:(Nt==null?void 0:Nt.publisher)||(Nt==null?void 0:Nt.Publisher)||"",demographic:(Nt==null?void 0:Nt.demographic)||(Nt==null?void 0:Nt.Demographic)||"",genre:(Nt==null?void 0:Nt.genre)||(Nt==null?void 0:Nt.Genre)||"",special:J.special,specialType:J.specialType,specialVolumes:J.specialVolumes,collectiblePrice:J.collectiblePrice,pageCount:J.pageCount}):{};if(t)return o.jsx("div",{className:"page dashboard-page",children:o.jsxs("div",{className:"dashboard-loading",children:[o.jsx("h1",{children:"Dashboard"}),o.jsx("p",{children:"Checking permissions..."})]})});if(!n||!e)return o.jsx("div",{className:"page dashboard-page",children:o.jsxs("div",{className:"dashboard-locked",children:[o.jsx("h1",{children:"Dashboard"}),o.jsx("p",{children:"This area is restricted to admin accounts."})]})});if(f)return o.jsx("div",{className:"page dashboard-page",children:o.jsxs("div",{className:"dashboard-loading",children:[o.jsx("h1",{children:"Dashboard"}),y?o.jsx("p",{className:"error",children:y}):o.jsx("p",{children:"Loading stats..."})]})});const pa=qr+Hr,ma=pa?Math.round(qr/pa*100):0,ga=[...Pn.values()].filter(T=>T.ratingCount>0).map(T=>({title:T.title,avg:T.ratingSum/T.ratingCount,count:T.ratingCount})).sort((T,$)=>$.avg-T.avg||$.count-T.count).slice(0,3);function ya(){if(dr)Kn(new Date(dr.getFullYear(),dr.getMonth(),1));else if(an.length){const T=an[0].date;Kn(new Date(T.getFullYear(),T.getMonth(),1))}lr(!0)}function jn(T){Wr({open:!0,type:T})}function hn(){Wr({open:!1,type:null})}const Mr=P_(Gt,an,ft),Er=T=>{Un($=>{const K=new Date($.year,$.month+T,1);return{year:K.getFullYear(),month:K.getMonth()}})},ys=T=>{Qn($=>new Date($.getFullYear(),$.getMonth()+T,1))},mr=()=>{ds(!1),_r(null)},Yr=()=>{const T=Array.from(en.keys()).sort();if(T.length){const $=T[T.length-1],[K,ue]=$.split("-"),Ce=Number(K),He=Number(ue)-1;!Number.isNaN(Ce)&&!Number.isNaN(He)&&Un({year:Ce,month:He})}ds(!0)},Ja=()=>{if(_n.length){const T=_n[_n.length-1].date;Qn(new Date(T.getFullYear(),T.getMonth(),1))}else Qn(new Date);Ut(!0)};function Xa(){const T=dt.type;if(!T)return null;if(T==="publishers"){const $=[...Po(Pn,"publisher",100)];return o.jsxs(o.Fragment,{children:[o.jsx("h3",{children:"Top Publishers by Series"}),$.length===0?o.jsx("p",{children:"No publisher data yet."}):o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"#"}),o.jsx("th",{children:"Publisher"}),o.jsx("th",{children:"Series Count"})]})}),o.jsx("tbody",{children:$.map((K,ue)=>o.jsxs("tr",{children:[o.jsx("td",{children:ue+1}),o.jsx("td",{children:K.name}),o.jsx("td",{children:K.count})]},K.name+ue))})]})]})}if(T==="genres"){const $=[...Po(Pn,"genre",100)];return o.jsxs(o.Fragment,{children:[o.jsx("h3",{children:"Top Genres by Series"}),$.length===0?o.jsx("p",{children:"No genre data yet."}):o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"#"}),o.jsx("th",{children:"Genre"}),o.jsx("th",{children:"Series Count"})]})}),o.jsx("tbody",{children:$.map((K,ue)=>o.jsxs("tr",{children:[o.jsx("td",{children:ue+1}),o.jsx("td",{children:K.name}),o.jsx("td",{children:K.count})]},K.name+ue))})]})]})}if(T==="demographics"){const $=[...Po(Pn,"demographic",100)];return o.jsxs(o.Fragment,{children:[o.jsx("h3",{children:"Top Demographics by Series"}),$.length===0?o.jsx("p",{children:"No demographic data yet."}):o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"#"}),o.jsx("th",{children:"Demographic"}),o.jsx("th",{children:"Series Count"})]})}),o.jsx("tbody",{children:$.map((K,ue)=>o.jsxs("tr",{children:[o.jsx("td",{children:ue+1}),o.jsx("td",{children:K.name}),o.jsx("td",{children:K.count})]},K.name+ue))})]})]})}if(T==="timeToRead"){const $=Rn||[];return o.jsxs(o.Fragment,{children:[o.jsx("h3",{children:"Average Time From Purchase to Read"}),Lr==null?o.jsx("p",{children:"Not enough volumes have both purchase and read dates to calculate this yet."}):o.jsxs(o.Fragment,{children:[o.jsxs("p",{children:["On average, it takes"," ",o.jsxs("strong",{children:[Lr.toFixed(1)," days"]})," from purchase to finishing a volume."]}),$.length>0?o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Series"}),o.jsx("th",{children:"Avg Days"}),o.jsx("th",{children:"Longest"}),o.jsx("th",{children:"Shortest"}),o.jsx("th",{children:"Reads Count"})]})}),o.jsx("tbody",{children:$.map(K=>o.jsxs("tr",{children:[o.jsx("td",{children:K.title}),o.jsxs("td",{children:[K.avg.toFixed(1)," days"]}),o.jsxs("td",{children:[Math.round(K.max)," days"]}),o.jsxs("td",{children:[Math.round(K.min)," days"]}),o.jsx("td",{children:K.count})]},K.key))})]}):o.jsx("p",{style:{marginTop:8},children:"No series-level data yet."})]})]})}if(T==="collectionValue"){const{msrpTotal:$,paidTotal:K}=$n,ue=$-K,Ce=$>0?(K/$*100).toFixed(1):"-",He=[...Kr].filter(Ae=>Ae.msrp||Ae.paid||Ae.collectible).sort((Ae,rt)=>rt.msrp+rt.collectible-(Ae.msrp+Ae.collectible));return o.jsxs(o.Fragment,{children:[o.jsx("h3",{children:"Collection Value Breakdown"}),o.jsx("table",{children:o.jsxs("tbody",{children:[o.jsxs("tr",{children:[o.jsx("th",{children:"Total MSRP"}),o.jsxs("td",{children:["$",$.toFixed(2)]})]}),o.jsxs("tr",{children:[o.jsx("th",{children:"Total Paid"}),o.jsxs("td",{children:["$",K.toFixed(2)]})]}),o.jsxs("tr",{children:[o.jsx("th",{children:"Difference"}),o.jsxs("td",{children:["$",ue.toFixed(2)]})]}),o.jsxs("tr",{children:[o.jsx("th",{children:"Paid vs MSRP"}),o.jsx("td",{children:Ce==="-"?"-":`${Ce}%`})]})]})}),He.length>0&&o.jsxs(o.Fragment,{children:[o.jsx("h4",{style:{marginTop:"14px"},children:"Collection Pricing"}),o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Title"}),o.jsx("th",{children:"MSRP"}),o.jsx("th",{children:"Paid"}),o.jsx("th",{children:"Collectible"}),o.jsx("th",{children:"Books"})]})}),o.jsx("tbody",{children:He.map((Ae,rt)=>o.jsxs("tr",{children:[o.jsx("td",{children:Ae.title}),o.jsxs("td",{children:["$",Ae.msrp.toFixed(2)]}),o.jsxs("td",{children:["$",Ae.paid.toFixed(2)]}),o.jsx("td",{children:Ae.collectible?`$${Ae.collectible.toFixed(2)}`:"--"}),o.jsx("td",{children:Ae.books})]},Ae.title+rt))})]})]})]})}if(T==="pages"){const $=[...Kr].filter(K=>K.pages>0).map(K=>({...K,pct:K.pages?Math.round(K.readPages/K.pages*100):0})).sort((K,ue)=>ue.pages-K.pages);return o.jsxs(o.Fragment,{children:[o.jsx("h3",{children:"Pages Read vs Total"}),o.jsx("table",{children:o.jsxs("tbody",{children:[o.jsxs("tr",{children:[o.jsx("th",{children:"Total Pages"}),o.jsx("td",{children:zt.total.toLocaleString()})]}),o.jsxs("tr",{children:[o.jsx("th",{children:"Pages Read"}),o.jsx("td",{children:zt.read.toLocaleString()})]}),o.jsxs("tr",{children:[o.jsx("th",{children:"Completion"}),o.jsx("td",{children:zt.total?`${(zt.read/zt.total*100).toFixed(1)}%`:"-"})]})]})}),$.length>0&&o.jsxs(o.Fragment,{children:[o.jsx("h4",{style:{marginTop:"14px"},children:"Pages by Series"}),o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Title"}),o.jsx("th",{children:"Read Pages"}),o.jsx("th",{children:"Total Pages"}),o.jsx("th",{children:"% Read"}),o.jsx("th",{children:"Books"})]})}),o.jsx("tbody",{children:$.map((K,ue)=>o.jsxs("tr",{children:[o.jsx("td",{children:K.title}),o.jsx("td",{children:K.readPages.toLocaleString()}),o.jsx("td",{children:K.pages.toLocaleString()}),o.jsxs("td",{children:[K.pct,"%"]}),o.jsx("td",{children:K.books})]},K.title+ue))})]})]})]})}if(T==="ratings"){const $=[...Kr].map(K=>{if(!K.ratings.length)return null;const ue=K.ratings.reduce((Ce,He)=>Ce+He,0)/K.ratings.length;return{title:K.title,avg:ue,count:K.ratings.length}}).filter(Boolean).sort((K,ue)=>ue.avg-K.avg||ue.count-K.count);return o.jsxs(o.Fragment,{children:[o.jsx("h3",{children:"Ratings Overview"}),ps==null?o.jsx("p",{children:"No ratings have been recorded yet."}):o.jsxs("p",{children:["Average series rating across rated series is"," ",o.jsx("strong",{children:ps.toFixed(2)}),"."]}),$.length>0&&o.jsxs(o.Fragment,{children:[o.jsx("h4",{style:{marginTop:"14px"},children:"Series Averages"}),o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Title"}),o.jsx("th",{children:"Avg"}),o.jsx("th",{children:"Ratings"})]})}),o.jsx("tbody",{children:$.map((K,ue)=>o.jsxs("tr",{children:[o.jsx("td",{children:K.title}),o.jsx("td",{children:K.avg.toFixed(2)}),o.jsx("td",{children:K.count})]},K.title+ue))})]})]})]})}return T==="releases"?o.jsxs(o.Fragment,{children:[o.jsx("h3",{children:"Library & Wishlist Releases"}),an.length===0?o.jsx("p",{children:"No wishlist releases found."}):o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Date"}),o.jsx("th",{children:"Title"})]})}),o.jsx("tbody",{children:an.map(($,K)=>o.jsxs("tr",{children:[o.jsx("td",{children:$.date.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}),o.jsx("td",{children:$.title})]},K))})]})]}):null}return o.jsxs("div",{className:"page dashboard-page",children:[o.jsxs("header",{className:"dashboard-header",style:{display:"flex",alignItems:"center",justifyContent:"center",position:"relative",textAlign:"center",width:"100%"},children:[o.jsxs("div",{style:{textAlign:"center",margin:"0 auto",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"0 60px"},children:[o.jsx("h1",{style:{margin:0,fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Dashboard"}),o.jsx("p",{className:"dashboard-sub",style:{textAlign:"center",margin:"6px 0 0"},children:"My Entire Statistics dashboard for my Manga. I still use Excel though."})]}),e&&o.jsx("div",{style:{position:"absolute",right:0,top:"50%",transform:"translateY(-50%)"},children:o.jsx("button",{className:"stat-link",onClick:()=>Pe(!0),type:"button",children:"Admin Settings"})})]}),o.jsx("section",{id:"dashboardSection",className:"page-section active",children:o.jsxs("div",{className:"dashboard-grid",children:[o.jsxs("div",{className:"stat-stack",children:[o.jsxs("div",{className:"stat-card mini clickable",onClick:Yr,children:[o.jsx("h3",{children:"Total Library Books"}),o.jsx("div",{className:"stat-value",children:qr}),o.jsx("div",{className:"stat-sub",children:"Volumes in your library."})]}),o.jsxs("div",{className:"stat-card mini",children:[o.jsx("h3",{children:"Wishlist Items"}),o.jsx("div",{className:"stat-value",children:Hr}),o.jsx("div",{className:"stat-sub",children:"Tracked upcoming wants."})]})]}),o.jsxs("div",{className:"stat-card clickable",onClick:Ja,role:"button",tabIndex:0,onKeyDown:T=>{(T.key==="Enter"||T.key===" ")&&(T.preventDefault(),Ja())},children:[o.jsx("h3",{children:"Read / Unread"}),o.jsx("div",{className:"pie",style:{"--pct":`${ot*3.6}deg`},children:o.jsxs("div",{className:"pie-label",children:[ot,"%"]})}),o.jsxs("div",{className:"stat-value",children:[wr," read / ",js," unread"]})]}),o.jsxs("div",{className:"stat-card clickable",onClick:()=>jn("ratings"),children:[o.jsx("h3",{children:"Ratings"}),o.jsx("div",{className:"stat-value",children:ps==null?"-":ps.toFixed(2)}),o.jsx("div",{className:"stat-sub",children:"Average across rated series."}),o.jsx("div",{className:"stat-list compact",children:ga.length?ga.map((T,$)=>o.jsxs("div",{className:"stat-list-row",children:[o.jsx("span",{className:"stat-rank",children:$+1}),o.jsx("span",{className:"stat-name",children:T.title}),o.jsx("span",{className:"stat-count",children:T.avg.toFixed(2)})]},T.title+$)):o.jsx("div",{className:"stat-sub",children:"No ratings yet."})})]}),o.jsxs("div",{className:"stat-card clickable",onClick:()=>jn("pages"),children:[o.jsx("h3",{children:"Page Count Read / Total"}),o.jsxs("div",{className:"stat-value",children:[zt.read.toLocaleString()," / ",zt.total.toLocaleString()]}),o.jsx("div",{className:"stat-sub",children:zt.total?`${(zt.read/zt.total*100).toFixed(1)}% read`:"-"})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("h3",{children:"Library vs Wishlist"}),o.jsx("div",{className:"pie",style:{"--pct":`${ma*3.6}deg`},children:o.jsxs("div",{className:"pie-label",children:[ma,"%"]})}),o.jsxs("div",{className:"stat-value",children:[qr," / ",Hr]}),o.jsx("div",{className:"stat-sub",children:"Library vs wishlist share"})]}),o.jsxs("div",{className:"stat-card clickable",onClick:()=>jn("demographics"),children:[o.jsx("h3",{children:"Top Demographics"}),o.jsx("div",{className:"stat-list",children:gs.length?gs.slice(0,3).map((T,$)=>o.jsxs("div",{className:"stat-list-row",children:[o.jsx("span",{className:"stat-rank",children:$+1}),o.jsx("span",{className:"stat-name",children:T.name}),o.jsx("span",{className:"stat-count",children:T.count})]},T.name)):o.jsx("div",{className:"stat-sub",children:"No demographic data yet."})})]}),o.jsxs("div",{className:"stat-card clickable",onClick:()=>jn("publishers"),children:[o.jsx("h3",{children:"Top Publishers"}),o.jsx("div",{className:"stat-list",children:Ds.length?Ds.slice(0,3).map((T,$)=>o.jsxs("div",{className:"stat-list-row",children:[o.jsx("span",{className:"stat-rank",children:$+1}),o.jsx("span",{className:"stat-name",children:T.name}),o.jsx("span",{className:"stat-count",children:T.count})]},T.name)):o.jsx("div",{className:"stat-sub",children:"No publisher data yet."})})]}),o.jsxs("div",{className:"stat-card clickable",onClick:()=>jn("genres"),children:[o.jsx("h3",{children:"Top Genres"}),o.jsx("div",{className:"stat-list",children:ms.length?ms.slice(0,3).map((T,$)=>o.jsxs("div",{className:"stat-list-row",children:[o.jsx("span",{className:"stat-rank",children:$+1}),o.jsx("span",{className:"stat-name",children:T.name}),o.jsx("span",{className:"stat-count",children:T.count})]},T.name)):o.jsx("div",{className:"stat-sub",children:"No genre data yet."})})]}),o.jsxs("div",{className:"stat-card clickable",onClick:()=>{ya()},children:[o.jsx("h3",{children:"Next Wishlist Release"}),o.jsx("div",{className:"stat-value next-release",children:Zt?Zt.title:"No upcoming releases"}),o.jsxs("div",{className:"stat-sub",children:[dr?dr.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"}):"-",o.jsx("br",{}),o.jsx("span",{id:"statNextCountdown",children:E})]})]}),o.jsxs("div",{className:"stat-card clickable",onClick:()=>jn("collectionValue"),style:{textAlign:"center"},children:[o.jsx("h3",{children:"Collection Pricing"}),o.jsxs("div",{className:"stat-value stat-msrp",children:["$",$n.msrpTotal.toFixed(2)]}),o.jsxs("div",{className:"stat-value stat-paid",children:["$",$n.paidTotal.toFixed(2),$n.msrpTotal>0&&o.jsxs("span",{className:"stat-paid-pct",children:["(",((1-$n.paidTotal/$n.msrpTotal)*100).toFixed(1),"% off)"]})]}),o.jsxs("div",{className:"stat-value stat-collectible",children:["$",$n.collectibleTotal.toFixed(2)]}),o.jsx("div",{className:"stat-sub",children:"MSRP | Paid | Collectible overrides"})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("h3",{children:"Current Year Reads"}),o.jsx("div",{className:"stat-value",children:ks}),o.jsxs("div",{className:"stat-sub",children:["Reads in ",Jn]})]}),o.jsxs("div",{className:"stat-card clickable",onClick:()=>jn("timeToRead"),children:[o.jsx("h3",{children:"Avg Days From Purchase to Read"}),o.jsx("div",{className:"stat-value",children:Lr==null?"-":`${Lr.toFixed(1)} days`}),o.jsx("div",{className:"stat-sub",children:"When both dates exist"})]}),o.jsxs("div",{className:"stat-duo",children:[o.jsxs("div",{className:"stat-card tall",children:[o.jsxs("h3",{children:["Reads Per Month (",Jn,")"]}),o.jsx(qR,{data:fs})]}),o.jsxs("div",{className:"stat-card tall",children:[o.jsx("h3",{children:"Reads by Day of Week (Lifetime)"}),o.jsx(HR,{data:ur}),o.jsx("div",{className:"stat-sub",children:"Based on all entries with a read date."})]})]}),o.jsxs("div",{className:"stat-card wide",style:{position:"relative",overflow:"hidden",background:"linear-gradient(135deg, rgba(255,182,193,0.08), rgba(255,105,180,0.08)) , radial-gradient(120% 120% at 0% 0%, rgba(255,182,193,0.14), rgba(36,12,24,0.8))",border:"1px solid rgba(255,182,193,0.24)",boxShadow:"0 16px 50px rgba(0,0,0,0.52)",paddingTop:18,marginTop:12},children:[o.jsx("div",{style:{position:"absolute",right:-32,top:-32,width:180,height:180,background:"radial-gradient(circle, rgba(255,105,180,0.16), rgba(255,105,180,0))",pointerEvents:"none"}}),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:12},children:[o.jsx("div",{style:{width:6,height:40,borderRadius:999,background:"linear-gradient(180deg, #ff7fb0, #ffb6c1)"}}),o.jsxs("div",{style:{flex:1},children:[o.jsx("h3",{style:{marginBottom:4},children:"Read Next"}),o.jsx("div",{className:"stat-sub",style:{color:"#f7d0dc",fontSize:"0.9rem"},children:"Weighted pick that balances backlog and upcoming releases."})]}),o.jsx("span",{style:{background:"rgba(255,182,193,0.18)",border:"1px solid rgba(255,182,193,0.32)",color:"#ffb6c1",fontSize:"0.78rem",padding:"6px 11px",borderRadius:"999px",letterSpacing:"0.02em"},children:"Smart"})]}),F?o.jsxs(o.Fragment,{children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14,alignItems:"stretch",textAlign:"center"},children:[o.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:10},children:[o.jsxs("div",{style:{padding:"12px 14px",borderRadius:"14px",border:"1px solid rgba(255,255,255,0.08)",background:"rgba(255,255,255,0.04)",display:"grid",gridTemplateColumns:"1fr",gap:8,textAlign:"center"},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:10,flexWrap:"wrap"},children:[o.jsx("div",{className:"stat-value",style:{lineHeight:1.2},children:F.title}),G&&G>new Date&&o.jsxs("span",{className:"stat-sub",style:{padding:"4px 8px",borderRadius:"999px",border:"1px solid rgba(255,218,123,0.5)",background:"rgba(255,218,123,0.12)",color:"#ffda7b",fontSize:"0.75rem"},children:["Snoozed to ",G.toLocaleDateString(void 0,{month:"short",day:"numeric"})]})]}),o.jsxs("div",{className:"stat-sub",style:{color:"#f7d0dc"},children:["Catch up ",F.behindCount," volume",F.behindCount===1?"":"s"," to reach vol ",F.catchUpTarget,"."]}),F.upcomingVolume?o.jsxs("div",{className:"stat-sub",style:{color:"#c5b3bc"},children:["Own to vol ",F.ownedVolume||0,"; next release is vol ",F.upcomingVolume,F.ownedVsUpcomingGap>0?` (gap ${F.ownedVsUpcomingGap})`:"","."]}):null,o.jsxs("div",{className:"stat-sub",style:{color:"#b6a6af"},children:["Queued after:"," ",M?`${M.title} (${M.unreadCount} unread)`:"Shuffle for another option","."]})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,textAlign:"center"},children:[o.jsxs("div",{style:{padding:"10px",borderRadius:"12px",border:"1px solid rgba(255,182,193,0.22)",background:"rgba(255,182,193,0.08)"},children:[o.jsx("div",{className:"stat-sub",style:{marginBottom:4},children:"Next release"}),o.jsx("div",{style:{fontWeight:700,marginBottom:2},children:F.nextRelease?F.nextRelease.date.toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"}):"None scheduled"}),o.jsx("div",{className:"stat-sub",children:F.nextRelease?`${F.daysToRelease} days out`:"Backlog focus"})]}),o.jsxs("div",{style:{padding:"10px",borderRadius:"12px",border:"1px solid rgba(255,255,255,0.12)",background:"rgba(255,255,255,0.05)"},children:[o.jsx("div",{className:"stat-sub",style:{marginBottom:4},children:"Up next"}),o.jsx("div",{style:{fontWeight:700,marginBottom:2},children:M?M.title:"Shuffle for another pick"}),o.jsx("div",{className:"stat-sub",children:M?`${M.unreadCount} unread`:"Queue empty"})]})]})]}),o.jsxs("div",{style:{padding:"12px 14px",borderRadius:"14px",border:"1px solid rgba(255,182,193,0.24)",background:"rgba(255,182,193,0.08)",display:"flex",flexDirection:"column",gap:8,textAlign:"center"},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,justifyContent:"center",flexWrap:"wrap"},children:[o.jsx("h4",{style:{margin:0},children:"Purchase Next"}),o.jsx("span",{className:"stat-sub",style:{padding:"2px 8px",borderRadius:"999px",border:"1px solid rgba(255,255,255,0.18)",background:"rgba(255,255,255,0.06)",fontSize:"0.7rem"},children:"Catch-up buy"})]}),je?o.jsxs(o.Fragment,{children:[o.jsx("div",{style:{fontWeight:700,fontSize:"1rem"},children:je.title}),o.jsxs("div",{className:"stat-sub",style:{color:"#f7d0dc"},children:["Need ",je.missingCount," volume",je.missingCount===1?"":"s"," to reach vol ",je.releaseVolume,"."]}),o.jsxs("div",{className:"stat-sub",style:{color:"#c5b3bc"},children:["Own to vol ",je.highestOwnedVolume||0,"; est. catch-up cost"," ",je.costEstimate?`$${je.costEstimate.toFixed(2)}`:"n/a"," ",je.avgMsrp?`(avg $${je.avgMsrp.toFixed(2)})`:""]}),o.jsxs("div",{className:"stat-sub",children:["Next release:"," ",je.nextRelease?`${je.nextRelease.date.toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"})} (${je.daysToRelease} days)`:"No date"]})]}):o.jsx("div",{className:"stat-sub",children:"No purchase catch-ups needed right now."})]})]}),o.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",marginTop:12,justifyContent:"center"},children:[o.jsx("button",{className:"stat-link",type:"button",onClick:()=>pe(T=>T+1),children:"Shuffle pick"}),o.jsx("button",{type:"button",className:"stat-link",style:{background:"rgba(255,218,123,0.1)",borderColor:"rgba(255,218,123,0.4)",color:"#ffda7b"},onClick:()=>me(7),children:"Delay 7 days"}),o.jsx("button",{type:"button",className:"stat-link",style:{background:"rgba(255,255,255,0.08)",borderColor:"rgba(255,255,255,0.22)"},onClick:()=>le({}),children:"Clear delays"})]})]}):o.jsx("div",{className:"stat-sub",children:"Add some unread volumes to get a tailored pick."})]}),o.jsxs("div",{className:"stat-card wide",children:[o.jsx("h3",{children:"Activity Log"}),fa&&o.jsx("div",{className:"error",style:{textAlign:"center"},children:y}),o.jsx("div",{className:"activity-log scrollable",children:Ie.length?Ie.map((T,$)=>{const K=T.ts?new Date(T.ts):null;return o.jsxs("div",{className:"activity-row",children:[o.jsx("span",{className:"activity-title",children:T.message}),o.jsx("span",{className:"activity-date",children:K?K.toLocaleString(void 0,{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}):""})]},(T.message||"activity")+$)}):o.jsx("div",{className:"stat-sub",children:"No recent activity yet."})})]}),o.jsxs("div",{className:"stat-card wide",style:{minHeight:"340px",maxHeight:"480px"},children:[o.jsx("h3",{children:"Suggestions"}),Qe&&o.jsx("div",{className:"error",style:{textAlign:"center"},children:Qe}),o.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",alignItems:"stretch"},children:["anime","manga"].map(T=>{const $=Te.filter(K=>(K.type||"").toLowerCase()===T).sort((K,ue)=>{var Ce,He,Ae,rt;return(((He=(Ce=ue.createdAt)==null?void 0:Ce.getTime)==null?void 0:He.call(Ce))||0)-(((rt=(Ae=K.createdAt)==null?void 0:Ae.getTime)==null?void 0:rt.call(Ae))||0)});return o.jsxs("div",{style:{border:"1px solid rgba(255,182,193,0.18)",borderRadius:"16px",padding:"10px 12px",display:"flex",flexDirection:"column",background:"rgba(255,182,193,0.04)",minHeight:"240px"},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"8px",position:"relative"},children:[o.jsx("h4",{style:{margin:0,color:"#ffb6c1",textAlign:"center",flex:1},children:T==="anime"?"Anime":"Manga"}),o.jsxs("span",{className:"stat-sub",style:{position:"absolute",right:0},children:[$.length," suggestion",$.length===1?"":"s"]})]}),o.jsx("div",{className:"scrollable",style:{maxHeight:"280px",height:"280px",paddingRight:"4px",overflowY:"auto"},children:De?o.jsx("div",{className:"stat-sub",children:"Loading suggestions..."}):$.length?$.map(K=>{const ue=K.createdAt instanceof Date?K.createdAt:K.createdAt?new Date(K.createdAt):null;return o.jsxs("div",{style:{border:"1px solid rgba(255,182,193,0.25)",borderRadius:"12px",padding:"8px 10px",marginBottom:"8px",background:"rgba(255,182,193,0.06)",display:"grid",gridTemplateColumns:"1fr auto",gap:"6px",alignItems:"center"},children:[o.jsxs("div",{children:[o.jsx("div",{style:{fontWeight:600,color:"#f7d0dc"},children:K.content||"(no content)"}),o.jsxs("div",{className:"stat-sub",style:{fontSize:"0.8rem"},children:[ue?ue.toLocaleString(void 0,{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}):""," ",K.from?`| ${K.from}`:""]})]}),o.jsx("div",{style:{display:"flex",gap:"6px"},children:e&&o.jsx("button",{type:"button",className:"stat-link",onClick:()=>hs(K.id),children:"Delete"})})]},K.id)}):o.jsx("div",{className:"stat-sub",children:"No suggestions yet."})})]},T)})}),o.jsxs("div",{className:"stat-sub",style:{marginTop:"8px",textAlign:"center"},children:["Total suggestions: ",Te.length]})]}),o.jsxs("div",{className:"stat-card wide",children:[o.jsx("h3",{children:"Library Manager"}),Se.length?o.jsxs("div",{className:"dash-library",children:[o.jsxs("div",{className:"dash-library-list",children:[Se.map(T=>{const $=T.books.filter(Ae=>!!Ae.read||Ae.status==="Read"||Ae.Read===!0).length,K=W.has(T.seriesKey),ue=se===T.seriesKey&&!_e,Ce=AR(T),He=T.books.some(Ae=>C_(Ae));return o.jsxs("div",{style:{marginBottom:"8px"},children:[o.jsxs("button",{type:"button",onClick:()=>Vs(T.seriesKey),style:{width:"100%",textAlign:"left",background:Ce?"rgba(255,179,71,0.08)":"transparent",border:`1px solid ${ue?"#ff69b4":Ce?"rgba(255,179,71,0.6)":"rgba(255,182,193,0.25)"}`,color:"#ffb6c1",padding:"8px",borderRadius:"8px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"8px",position:"relative",boxShadow:Ce?"0 0 10px rgba(255,179,71,0.5)":ue?"0 0 8px rgba(255,105,180,0.5)":"none"},children:[o.jsx("span",{style:{transition:"transform 0.2s ease",transform:K?"rotate(90deg)":"none"},children:">"}),o.jsx("span",{style:{flex:1},children:T.displayName}),o.jsxs("span",{style:{fontSize:"11px",color:"#f8d1d8"},children:[T.books.length," book",T.books.length===1?"":"s",T.books.length?` | ${$} read`:""]}),He&&o.jsx("span",{title:"Some volumes are missing required data",style:{width:"12px",height:"12px",borderRadius:"999px",background:"#ffb347",border:"1px solid rgba(255,255,255,0.25)",boxShadow:"0 0 10px rgba(255,179,71,0.6)"}})]}),o.jsx("div",{style:{margin:"6px 0 10px 10px",paddingLeft:"10px",borderLeft:"1px solid rgba(255,182,193,0.25)",display:K?"block":"none"},children:T.books.map(Ae=>{const rt=_e===Ae.id,pt=L.has(Ae.id);Ae.read||Ae.status==="Read"||Ae.Read;const St=C_(Ae,{ignoreShared:!0});return o.jsxs("button",{type:"button",onClick:ct=>hr(ct,Ae.id,T.seriesKey),style:{width:"100%",textAlign:"left",background:St?"rgba(255,179,71,0.1)":"transparent",border:`1px solid ${rt?"#ff69b4":pt?"#fff59d":St?"rgba(255,179,71,0.6)":"rgba(255,182,193,0.25)"}`,color:"#ffb6c1",padding:"8px",borderRadius:"8px",marginBottom:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"8px",boxShadow:rt?"0 0 8px rgba(255,105,180,0.5)":pt?"0 0 10px rgba(255,255,180,0.65)":St?"0 0 10px rgba(255,179,71,0.5)":"none"},children:[o.jsx("span",{style:{flex:1,minWidth:0},children:Ae.Title||Ae.title||"Untitled"}),St&&o.jsx("span",{style:{flexShrink:0,padding:"2px 8px",borderRadius:"999px",background:"rgba(255,179,71,0.18)",border:"1px solid rgba(255,179,71,0.6)",color:"#ffd8a1",fontSize:"11px",fontWeight:700,whiteSpace:"nowrap"},children:"Missing data"})]},Ae.id)})})]},T.seriesKey)}),Se.length>0&&L.size>0&&o.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:o.jsx("button",{type:"button",style:{padding:"6px 12px",borderRadius:"999px",border:"1px solid #ffb6c1",background:"transparent",color:"#ffb6c1",cursor:"pointer"},onClick:xn,children:"Clear Selection"})})]}),o.jsxs("div",{className:"dash-library-details",children:[L.size>0&&o.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px",padding:"10px",marginBottom:"10px",border:"1px dashed rgba(255,182,193,0.45)",borderRadius:"10px",background:"rgba(255,182,193,0.08)"},children:[o.jsxs("div",{children:["Apply Amount Paid to ",L.size," selected book",L.size===1?"":"s"]}),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",flexWrap:"wrap"},children:[o.jsx("input",{type:"number",step:"0.01",min:"0",value:A,onChange:T=>O(T.target.value),style:{maxWidth:"140px"}}),o.jsx("button",{type:"button",className:"dash-btn primary",onClick:fr,children:"Apply to Selected"})]})]}),!se&&!_e&&o.jsx("div",{className:"stat-sub",style:{marginTop:6},children:"Select a series or book to edit"}),se&&!_e&&gt&&o.jsxs("div",{children:[o.jsx("div",{className:"dash-detail-title",children:gt.displayName}),o.jsx("div",{className:"dash-detail-row",children:o.jsxs("label",{className:"inline-checkbox",children:[o.jsx("input",{ref:D,type:"checkbox",checked:P.readChecked,onChange:T=>b($=>({...$,readChecked:T.target.checked,readIndeterminate:!1}))}),o.jsx("span",{children:"Mark series as read"})]})}),o.jsxs("div",{className:`dash-detail-row${Os.publisher?" missing-row":""}`,children:[o.jsx("span",{children:"Publisher"}),o.jsx("input",{type:"text",value:P.publisher,onChange:T=>b($=>({...$,publisher:T.target.value})),placeholder:"Set publisher for series"})]}),o.jsxs("div",{className:`dash-detail-row${Os.demographic?" missing-row":""}`,children:[o.jsx("span",{children:"Demographic"}),o.jsxs("select",{value:P.demographic,onChange:T=>b($=>({...$,demographic:T.target.value})),children:[o.jsx("option",{value:"",children:"Select Demographic"}),o.jsx("option",{value:"Shounen",children:"Shounen"}),o.jsx("option",{value:"Seinen",children:"Seinen"}),o.jsx("option",{value:"Shoujo",children:"Shoujo"}),o.jsx("option",{value:"Josei",children:"Josei"})]})]}),o.jsxs("div",{className:`dash-detail-row${Os.genre?" missing-row":""}`,children:[o.jsx("span",{children:"Genre"}),o.jsx("input",{type:"text",value:P.genre,onChange:T=>b($=>({...$,genre:T.target.value})),placeholder:"Primary genre"})]}),o.jsxs("div",{className:"dash-detail-row",children:[o.jsx("span",{children:"Sub-Genre"}),o.jsx("input",{type:"text",value:P.subGenre,onChange:T=>b($=>({...$,subGenre:T.target.value})),placeholder:"Secondary genre / theme"})]}),!P.dateMixed&&o.jsxs("div",{className:`dash-detail-row${Os.datePurchased?" missing-row":""}`,children:[o.jsx("span",{children:"Date Purchased"}),o.jsx("input",{type:"date",value:P.datePurchased,onChange:T=>b($=>({...$,datePurchased:T.target.value}))})]}),o.jsxs("div",{className:`dash-detail-row${Os.msrp?" missing-row":""}`,children:[o.jsx("span",{children:"MSRP (per book)"}),o.jsx("input",{type:"number",step:"0.01",min:"0",value:P.msrp,onChange:T=>b($=>({...$,msrp:T.target.value})),placeholder:"0.00"})]}),o.jsxs("div",{className:"dash-detail-actions",children:[o.jsx("button",{type:"button",className:"dash-btn secondary",onClick:kt,children:"Cancel"}),o.jsx("button",{type:"button",className:"dash-btn primary",onClick:Qr,children:"Save Series"})]})]}),_e&&Nt&&o.jsxs("div",{children:[o.jsx("div",{className:"dash-detail-title",children:Nt.Title||Nt.title||"Untitled"}),o.jsx("div",{className:"dash-detail-row",children:o.jsxs("label",{className:"inline-checkbox",children:[o.jsx("input",{type:"checkbox",checked:!!J.read,onChange:T=>re($=>({...$,read:T.target.checked,dateRead:T.target.checked?$.dateRead||new Date().toISOString().slice(0,10):"",rating:T.target.checked?$.rating:""}))}),o.jsx("span",{children:"Mark as read"})]})}),o.jsxs("div",{className:`dash-detail-row${pr.datePurchased?" missing-row":""}`,children:[o.jsx("span",{children:"Date Purchased"}),o.jsx("input",{type:"date",value:J.datePurchased,onChange:T=>re($=>({...$,datePurchased:T.target.value}))})]}),J.read&&o.jsxs("div",{className:"dash-detail-row",children:[o.jsx("span",{children:"Date Read"}),o.jsx("input",{type:"date",value:J.dateRead,onChange:T=>re($=>({...$,dateRead:T.target.value}))})]}),o.jsxs("div",{className:`dash-detail-row${pr.pageCount?" missing-row":""}`,children:[o.jsx("span",{children:"Page Count"}),o.jsx("input",{type:"number",min:"0",step:"1",value:J.pageCount,onChange:T=>re($=>({...$,pageCount:T.target.value}))})]}),o.jsxs("div",{className:`dash-detail-row${pr.msrp?" missing-row":""}`,children:[o.jsx("span",{children:"MSRP (per book)"}),o.jsx("input",{type:"number",step:"0.01",min:"0",value:J.msrp,onChange:T=>re($=>({...$,msrp:T.target.value})),placeholder:"0.00"})]}),!(J.special&&J.specialType==="collectible")&&o.jsxs("div",{className:`dash-detail-row${pr.amountPaid?" missing-row":""}`,children:[o.jsx("span",{children:"Amount Paid"}),o.jsx("input",{type:"number",step:"0.01",min:"0",value:J.amountPaid,onChange:T=>re($=>({...$,amountPaid:T.target.value})),placeholder:"0.00"})]}),J.read&&o.jsxs("div",{className:"dash-detail-row",children:[o.jsx("span",{children:"Star Rating"}),o.jsx("input",{type:"number",min:"0",max:"5",step:"0.5",value:J.rating,onChange:T=>re($=>({...$,rating:T.target.value})),placeholder:"0-5"})]}),o.jsx("div",{className:`dash-detail-row${pr.specialType?" missing-row":""}`,children:o.jsxs("label",{className:"inline-checkbox",style:{width:"100%"},children:[o.jsx("input",{type:"checkbox",checked:!!J.special,onChange:T=>re($=>({...$,special:T.target.checked,specialType:T.target.checked?$.specialType:"",specialVolumes:T.target.checked?$.specialVolumes:"",collectiblePrice:T.target.checked?$.collectiblePrice:""}))}),o.jsx("span",{children:"Special?"})]})}),J.special&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:`dash-detail-row${pr.specialType?" missing-row":""}`,children:[o.jsx("span",{children:"Special Type"}),o.jsxs("select",{value:J.specialType,onChange:T=>re($=>({...$,specialType:T.target.value,specialVolumes:T.target.value==="specialEdition"?$.specialVolumes:"",collectiblePrice:T.target.value==="collectible"?$.collectiblePrice:""})),children:[o.jsx("option",{value:"",children:"Select type"}),o.jsx("option",{value:"specialEdition",children:"Special Edition"}),o.jsx("option",{value:"collectible",children:"Collectible"})]})]}),J.specialType==="specialEdition"&&o.jsxs("div",{className:`dash-detail-row${pr.specialVolumes?" missing-row":""}`,children:[o.jsx("span",{children:"Volumes Contained"}),o.jsx("input",{type:"number",min:"1",step:"1",value:J.specialVolumes,onChange:T=>re($=>({...$,specialVolumes:T.target.value}))})]}),J.specialType==="collectible"&&o.jsxs("div",{className:`dash-detail-row${pr.collectiblePrice?" missing-row":""}`,children:[o.jsx("span",{children:"Collectible Price"}),o.jsx("input",{type:"number",min:"0",step:"0.01",value:J.collectiblePrice,onChange:T=>re($=>({...$,collectiblePrice:T.target.value})),placeholder:"0.00"})]})]}),o.jsxs("div",{className:"dash-detail-actions",children:[o.jsx("button",{type:"button",className:"dash-btn secondary",onClick:Ms,children:"Cancel"}),o.jsx("button",{type:"button",className:"dash-btn primary",onClick:Ls,children:"Save Changes"})]})]})]})]}):o.jsx("div",{className:"stat-sub",children:"No library items."})]})]})}),Dr&&o.jsx("div",{id:"calendarOverlay",onClick:T=>{T.target===T.currentTarget&&mr()},children:o.jsxs("div",{id:"calendarCard",onClick:T=>T.stopPropagation(),children:[o.jsxs("div",{className:"calendar-header",children:[o.jsx("div",{className:"calendar-title",children:new Date(cr.year,cr.month).toLocaleString(void 0,{month:"long",year:"numeric"})}),o.jsxs("div",{className:"calendar-nav",children:[o.jsx("button",{className:"calendar-nav-btn",onClick:()=>Er(-1),type:"button",children:"<"}),o.jsx("button",{className:"calendar-nav-btn",onClick:()=>Er(1),type:"button",children:">"})]})]}),o.jsxs("div",{className:"calendar-weekdays",children:[o.jsx("div",{children:"Sun"}),o.jsx("div",{children:"Mon"}),o.jsx("div",{children:"Tue"}),o.jsx("div",{children:"Wed"}),o.jsx("div",{children:"Thu"}),o.jsx("div",{children:"Fri"}),o.jsx("div",{children:"Sat"})]}),o.jsxs("div",{className:"calendar-grid",children:[w.cells.map((T,$)=>{if(T.type==="pad")return o.jsx("div",{className:"calendar-day pad"},`pad-${$}`);const{day:K,dateKey:ue,items:Ce,isToday:He}=T;return o.jsxs("div",{className:"calendar-day"+(Ce.length?" has-releases":"")+(He?" today":""),onClick:()=>{Ce.length&&_r({date:ue,items:Ce})},role:"button",tabIndex:0,onKeyDown:Ae=>{if(Ae.key==="Enter"||Ae.key===" "){if(Ae.preventDefault(),!Ce.length)return;_r({date:ue,items:Ce})}},children:[o.jsx("div",{className:"day-num",children:K}),o.jsxs("div",{className:"calendar-releases",children:[Ce.slice(0,2).map(Ae=>o.jsx("div",{className:"calendar-release purchased",children:Ae.title||"Untitled"},Ae.id)),Ce.length>2&&o.jsxs("div",{className:"calendar-release more",children:["+",Ce.length-2," more"]})]})]},ue)}),!w.hasItems&&o.jsx("div",{className:"calendar-empty",children:"No purchases for this month."})]}),o.jsx("button",{id:"calendarClose",onClick:mr,type:"button",children:"x"})]})}),Vr&&o.jsx("div",{className:"purchase-overlay",onClick:T=>{T.target===T.currentTarget&&_r(null)},children:o.jsxs("div",{className:"purchase-day-modal",onClick:T=>T.stopPropagation(),children:[o.jsxs("div",{className:"purchase-day-header",children:[o.jsx("div",{className:"purchase-day-title",children:new Date(Vr.date).toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"})}),o.jsx("button",{className:"manga-btn secondary",onClick:()=>_r(null),type:"button",children:"x"})]}),o.jsx("div",{className:"purchase-day-list",children:Vr.items.map(T=>o.jsx("div",{className:"purchase-day-item",children:T.title||"Untitled"},T.id))})]})}),Ft&&o.jsx("div",{id:"calendarOverlay",onClick:()=>Ut(!1),style:{zIndex:10060},children:o.jsxs("div",{id:"calendarCard",onClick:T=>T.stopPropagation(),children:[o.jsxs("div",{className:"calendar-header",children:[o.jsx("div",{className:"calendar-title",children:dn.toLocaleString(void 0,{month:"long",year:"numeric"})}),o.jsxs("div",{className:"calendar-nav",children:[o.jsx("button",{className:"calendar-nav-btn",onClick:()=>ys(-1),type:"button",children:"<"}),o.jsx("button",{className:"calendar-nav-btn",onClick:()=>ys(1),type:"button",children:">"})]})]}),o.jsxs("div",{className:"calendar-weekdays",children:[o.jsx("div",{children:"Sun"}),o.jsx("div",{children:"Mon"}),o.jsx("div",{children:"Tue"}),o.jsx("div",{children:"Wed"}),o.jsx("div",{children:"Thu"}),o.jsx("div",{children:"Fri"}),o.jsx("div",{children:"Sat"})]}),o.jsx("div",{className:"calendar-grid",children:An.map((T,$)=>{var K;return T.type==="pad"?o.jsx("div",{className:"calendar-day pad"},$):o.jsxs("div",{className:"calendar-day"+(T.isToday?" today":"")+((K=T.releases)!=null&&K.length?" has-releases":""),onClick:()=>{var Ce;if(!((Ce=T.releases)!=null&&Ce.length))return;const ue=new Date(dn.getFullYear(),dn.getMonth(),T.day);Yn({dateLabel:ue.toLocaleDateString(void 0,{month:"long",day:"numeric",year:"numeric"}),releases:T.releases})},role:"button",tabIndex:0,onKeyDown:ue=>{var Ce;if(ue.key==="Enter"||ue.key===" "){if(ue.preventDefault(),!((Ce=T.releases)!=null&&Ce.length))return;const He=new Date(dn.getFullYear(),dn.getMonth(),T.day);Yn({dateLabel:He.toLocaleDateString(void 0,{month:"long",day:"numeric",year:"numeric"}),releases:T.releases})}},children:[o.jsx("div",{className:"day-num",children:T.day}),o.jsxs("div",{className:"calendar-releases",children:[(T.releases||[]).slice(0,2).map((ue,Ce)=>o.jsx("div",{className:"calendar-release purchased",title:ue.title,children:ue.title},Ce)),(T.releases||[]).length>2&&o.jsxs("div",{className:"calendar-release more",children:["+",(T.releases||[]).length-2," more"]})]})]},T.dateKey||$)})}),!_n.length&&o.jsx("div",{className:"calendar-empty",children:"No reads recorded yet."}),o.jsx("button",{id:"calendarClose",onClick:()=>Ut(!1),type:"button",children:"x"})]})}),In&&o.jsx("div",{id:"calendarOverlay",onClick:()=>Yn(null),style:{zIndex:10080},children:o.jsxs("div",{id:"calendarCard",onClick:T=>T.stopPropagation(),style:{maxWidth:"520px"},children:[o.jsxs("div",{className:"calendar-header",children:[o.jsx("div",{className:"calendar-title",children:In.dateLabel}),o.jsx("button",{className:"calendar-close-btn",onClick:()=>Yn(null),type:"button",children:"x"})]}),o.jsx("div",{className:"calendar-releases modal-list",children:In.releases.map((T,$)=>o.jsx("div",{className:"calendar-release purchased",title:T.title,children:T.title},$))})]})}),Fn&&o.jsx("div",{id:"calendarOverlay",onClick:()=>lr(!1),children:o.jsxs("div",{id:"calendarCard",onClick:T=>T.stopPropagation(),children:[o.jsxs("div",{className:"calendar-header",children:[o.jsx("div",{className:"calendar-title",children:Gt.toLocaleString(void 0,{month:"long",year:"numeric"})}),o.jsxs("div",{className:"calendar-nav",children:[o.jsx("button",{className:"calendar-nav-btn",onClick:()=>Kn(new Date(Gt.getFullYear(),Gt.getMonth()-1,1)),children:"<"}),o.jsx("button",{className:"calendar-nav-btn",onClick:()=>Kn(new Date(Gt.getFullYear(),Gt.getMonth()+1,1)),children:">"})]})]}),o.jsxs("div",{className:"calendar-weekdays",children:[o.jsx("div",{children:"Sun"}),o.jsx("div",{children:"Mon"}),o.jsx("div",{children:"Tue"}),o.jsx("div",{children:"Wed"}),o.jsx("div",{children:"Thu"}),o.jsx("div",{children:"Fri"}),o.jsx("div",{children:"Sat"})]}),o.jsx("div",{className:"calendar-grid",id:"releaseCalendar",children:Mr.map((T,$)=>T.type==="pad"?o.jsx("div",{className:"calendar-day pad"},$):o.jsxs("div",{className:"calendar-day"+(T.isToday?" today":""),children:[o.jsx("div",{className:"day-num",children:T.day}),o.jsxs("div",{className:"calendar-releases",children:[(It===T.dateKey?T.releases:T.releases.slice(0,2)).map((K,ue)=>o.jsx("div",{className:"calendar-release"+(K.purchased?" purchased":""),title:K.title,children:K.title},ue)),T.releases.length>2&&o.jsxs("button",{className:"calendar-more-btn",onClick:()=>{const K=new Date(Gt.getFullYear(),Gt.getMonth(),T.day);jt({dateLabel:K.toLocaleDateString(void 0,{month:"long",day:"numeric",year:"numeric"}),releases:T.releases})},children:["+",T.releases.length-2," more"]})]})]},$))}),!an.length&&o.jsx("div",{className:"calendar-empty",children:"No wishlist releases found."}),o.jsx("button",{id:"calendarClose",onClick:()=>lr(!1),children:"x"})]})}),dt.open&&o.jsx("div",{id:"statDetailOverlay",onClick:hn,children:o.jsxs("div",{id:"statDetailCard",onClick:T=>T.stopPropagation(),children:[o.jsx("button",{id:"statDetailClose",onClick:hn,children:"x"}),o.jsxs("h2",{id:"statDetailTitle",children:[dt.type==="publishers"&&"Top Publishers",dt.type==="genres"&&"Top Genres",dt.type==="demographics"&&"Top Demographics",dt.type==="timeToRead"&&"Avg Time From Purchase to Read",dt.type==="collectionValue"&&"Collection Value",dt.type==="pages"&&"Pages Read vs Total",dt.type==="ratings"&&"Ratings",dt.type==="releases"&&"Library & Wishlist Releases"]}),o.jsx("div",{id:"statDetailBody",children:Xa()})]})}),wt&&o.jsx("div",{id:"calendarOverlay",onClick:()=>jt(null),style:{zIndex:10080},children:o.jsxs("div",{id:"calendarCard",onClick:T=>T.stopPropagation(),style:{maxWidth:"520px"},children:[o.jsxs("div",{className:"calendar-header",children:[o.jsx("div",{className:"calendar-title",children:wt.dateLabel}),o.jsx("button",{className:"calendar-close-btn",onClick:()=>jt(null),type:"button",children:"x"})]}),o.jsx("div",{className:"calendar-releases modal-list",children:wt.releases.map((T,$)=>o.jsx("div",{className:"calendar-release"+(T.purchased?" purchased":""),title:T.title,children:T.title},$))})]})}),e&&ce&&o.jsx("div",{className:"dashboard-modal-backdrop visible",onClick:T=>{T.target===T.currentTarget&&Pe(!1)},children:o.jsxs("div",{className:"dashboard-modal",children:[o.jsxs("div",{className:"dashboard-modal-header",children:[o.jsx("h3",{children:"Webhook Settings"}),o.jsx("button",{className:"dashboard-close",onClick:()=>Pe(!1),type:"button",children:"X"})]}),o.jsxs("div",{className:"dashboard-modal-body",children:[o.jsxs("label",{className:"dashboard-input",children:[o.jsx("span",{children:"Yearly summary webhook"}),o.jsx("input",{type:"text",value:U.yearly,onChange:T=>X($=>({...$,yearly:T.target.value}))})]}),o.jsxs("label",{className:"dashboard-input",children:[o.jsx("span",{children:"Release timer webhook"}),o.jsx("input",{type:"text",value:U.release,onChange:T=>X($=>({...$,release:T.target.value}))})]}),o.jsxs("label",{className:"dashboard-input",children:[o.jsx("span",{children:"Activity webhook"}),o.jsx("input",{type:"text",value:U.activity,onChange:T=>X($=>({...$,activity:T.target.value}))})]}),o.jsxs("div",{className:"dashboard-input",style:{borderTop:"1px solid rgba(255,182,193,0.2)",paddingTop:8},children:[o.jsx("span",{children:"User roles"}),o.jsx("div",{style:{marginTop:8,fontSize:"0.85rem",color:"var(--text-soft)"},children:k?o.jsx("span",{children:"Loading users"}):xe.length===0?o.jsx("span",{children:"No users found."}):o.jsx("ul",{style:{listStyle:"none",margin:"6px 0 0",padding:0,display:"flex",gap:6,flexDirection:"column"},children:xe.map(T=>o.jsxs("li",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:8,background:"rgba(24,5,18,0.7)",border:"1px solid rgba(255,182,193,0.18)",borderRadius:10,padding:"6px 8px",flexWrap:"wrap"},children:[o.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:2},children:[o.jsx("strong",{children:T.displayName||T.email||T.uid}),o.jsx("span",{style:{fontSize:"0.85rem",opacity:.8},children:T.email||T.uid})]}),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[o.jsx("span",{className:"role-pill",children:T.role||"viewer"}),T.role==="admin"?o.jsx("button",{className:"dashboard-close",type:"button",onClick:()=>un(T.uid,"viewer"),style:{padding:"4px 10px"},children:"Make viewer"}):o.jsx("button",{className:"stat-link",type:"button",onClick:()=>un(T.uid,"admin"),style:{padding:"4px 10px"},children:"Make admin"})]})]},T.uid))})})]})]}),o.jsxs("div",{className:"dashboard-modal-footer",children:[o.jsx("button",{className:"stat-link",type:"button",onClick:async()=>{try{await qs(Pt(st,"settings","webhooks"),{yearly:U.yearly||Pl,release:U.release||Rl,activity:U.activity||Va}),Pe(!1)}catch(T){console.error("Failed to save webhooks",T),alert("Failed to save webhooks.")}},children:"Save"}),o.jsx("button",{className:"stat-link danger",type:"button",onClick:()=>Pe(!1),children:"Cancel"})]})]})})]})}function QR(){const[n,e]=j.useState(!0),[t,s]=j.useState(""),[a,l]=j.useState(0),[d,f]=j.useState([]),[m,y]=j.useState(0),x=j.useRef(null);j.useEffect(()=>{document.title="Music | im.ok"},[]),j.useEffect(()=>{let ve=!1;async function L(){e(!0),s("");try{const ie=await fetch("https://music-api-worker.imokissick.workers.dev/music");if(!ie.ok)throw new Error("Worker fetch failed");const I=await ie.json();if(ve)return;const N=Array.isArray(I.combined)?I.combined:[],A=Array.isArray(I.spotify)?I.spotify:[],O=Array.isArray(I.soundcloud)?I.soundcloud:[],P=[...N,...A,...O].reduce((b,J)=>{const re=(J.title||"").toLowerCase().trim();if(!re)return b;const Ie=b.findIndex(he=>(he.title||"").toLowerCase().trim()===re);return Ie>=0?(b[Ie].source!=="spotify"&&J.source==="spotify"&&(b[Ie]=J),b):(b.push(J),b)},[]).map(b=>({...b,releaseDate:b.releaseDate?new Date(b.releaseDate):new Date}));f(P)}catch(ie){console.error(ie),ve||s("Failed to load music feeds.")}finally{ve||e(!1)}}return L(),()=>{ve=!0}},[]);const E=Math.min(4,Math.max(1,d.length)),C=E?Math.ceil(d.length/E):0,U=()=>{x.current&&clearInterval(x.current),d.length&&(y(ve=>ve+1),x.current=setInterval(()=>{l(ve=>(Math.floor(ve/E)+1)%C*E%d.length),y(ve=>ve+1)},15e3))};j.useEffect(()=>{if(d.length)return U(),()=>{x.current&&clearInterval(x.current)}},[d,E]);const X=ve=>{d.length&&(l(L=>(Math.floor(L/E)+ve+C)%C*E%d.length),U())},W=ve=>{d.length&&(l(ve*E%d.length),U())},z=ve=>L=>{L.preventDefault();const I=ve.source==="spotify"?`spotify:album:${ve.id}`:ve.url,N=ve.url;try{const A=setTimeout(()=>{window.open(N,"_blank","noopener,noreferrer")},600);window.location.href=I,setTimeout(()=>clearTimeout(A),800)}catch{window.open(N,"_blank","noopener,noreferrer")}},se=d[0],we=ve=>ve?{backgroundImage:`url(${ve})`,backgroundSize:"cover",backgroundPosition:"center"}:{},_e=se?se.source==="spotify"?"Spotify":"SoundCloud":"";return o.jsxs("main",{className:"page music-page",children:[o.jsxs("header",{className:"music-hero",children:[o.jsxs("div",{className:"music-hero-content",children:[o.jsx("p",{className:"music-pill",children:"im.ok  Artist"}),o.jsx("h1",{children:se?se.title:"Latest & Greatest"}),o.jsx("p",{className:"music-sub",children:"Check out my latest song. I know it's been almost a whole year since I've released. I have been on a much needed hiatus. I felt the whole world crumbling around me and had no time to breathe so this is why I took a break. Here's to 2026!"}),se&&o.jsx("div",{className:"music-badges",children:o.jsx("span",{children:_e})})]}),o.jsx("div",{className:"music-hero-embed",children:o.jsxs("div",{className:"music-hero-art",style:we(se==null?void 0:se.artwork),children:[!(se!=null&&se.artwork)&&o.jsx("div",{className:"music-hero-art-fallback",children:"Artwork"}),se&&o.jsx("button",{className:"music-link music-play hero-play","aria-label":`Play ${se.title}`,onClick:z(se)})]})})]}),o.jsxs("section",{className:"music-section",children:[o.jsx("div",{className:"music-section-header",children:o.jsx("h2",{children:"Releases"})}),t&&o.jsx("div",{className:"music-error",children:t}),n&&o.jsx("div",{className:"music-loading",children:"Loading music feeds..."}),!n&&d.length===0&&o.jsx("div",{className:"music-empty",children:"Connect Spotify/SoundCloud tokens to see live releases."}),!n&&d.length>0&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"music-carousel-wrap",children:[o.jsx("button",{className:"music-nav left",onClick:()=>X(-1),"aria-label":"Previous releases",children:""}),o.jsx("div",{className:"music-carousel",children:Array.from({length:E}).map((ve,L)=>{const ie=d[(a+L)%d.length];return ie?o.jsxs("div",{className:"music-card",children:[o.jsx("div",{className:"music-card-art",style:we(ie.artwork)}),o.jsxs("div",{className:"music-card-body",children:[o.jsx("div",{className:"music-card-title",children:ie.title}),o.jsx("div",{className:"music-card-actions",children:o.jsx("button",{className:"music-link music-play","aria-label":`Play ${ie.title}`,onClick:z(ie)})})]})]},`${ie.id}-${L}`):null})}),o.jsx("button",{className:"music-nav right",onClick:()=>X(1),"aria-label":"Next releases",children:""})]}),o.jsx("div",{className:"music-dots",children:Array.from({length:C}).map((ve,L)=>{const ie=Math.floor(a/E)===L,I=ie?`${L}-${m}`:`${L}-idle`;return o.jsx("button",{className:`dot ${ie?"active":""}`,onClick:()=>W(L),"aria-label":`Go to set ${L+1}`,children:o.jsx("span",{className:"dot-fill"},I)},L)})})]})]}),o.jsxs("div",{className:"music-feeds-row",children:[o.jsxs("section",{className:"music-section",children:[o.jsx("div",{className:"music-section-header",children:o.jsx("h2",{children:"Spotify"})}),o.jsx("div",{className:"music-embed-card",children:o.jsx("iframe",{title:"Spotify Artist",src:"https://open.spotify.com/embed/artist/00sbWLxYLDs8i5BLQL9Qdo?utm_source=generator&theme=0",width:"100%",height:"400",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy"})})]}),o.jsxs("section",{className:"music-section",children:[o.jsx("div",{className:"music-section-header",children:o.jsx("h2",{children:"SoundCloud"})}),o.jsx("div",{className:"music-embed-card",children:o.jsx("iframe",{title:"SoundCloud Player",width:"100%",height:"400",scrolling:"no",frameBorder:"no",allow:"autoplay",src:"https://w.soundcloud.com/player/?url=https%3A//soundcloud.com/imxk&color=%23ff69b4&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true&visual=true"})})]})]})]})}function YR(){const n=sc(),{user:e}=Qa(),t=async a=>{if(!(a!=null&&a.uid))return;const l=Pt(st,"users",a.uid);try{const d=await rc(l),f=d.exists()?d.data():null,m=(f==null?void 0:f.role)||"viewer";await qs(l,{role:m,email:a.email||(f==null?void 0:f.email)||"",displayName:a.displayName||(f==null?void 0:f.displayName)||"",createdAt:(f==null?void 0:f.createdAt)||za()},{merge:!0})}catch(d){console.warn("Failed to upsert user doc",d)}};j.useEffect(()=>{e!=null&&e.uid&&t(e).finally(()=>n("/"))},[e,n]);async function s(){try{const a=new Cs,l=await V0(ls,a);await t(l.user),n("/")}catch(a){console.error(a),alert("Google Sign-In failed.")}}return o.jsx("div",{className:"signin-page",children:o.jsxs("div",{className:"signin-card",children:[o.jsx("h2",{className:"signin-title",children:"Welcome Back"}),o.jsx("p",{className:"signin-sub",children:"Sign in to access the dashboard & edit collections."}),o.jsxs("button",{className:"google-btn",onClick:s,children:[o.jsx("img",{src:"https://www.svgrepo.com/show/475656/google-color.svg",alt:"",className:"google-icon"}),"Continue with Google"]}),o.jsxs("button",{className:"signin-cancel",onClick:()=>n("/"),children:["<"," Back to Home"]})]})})}const JR=j.lazy(()=>yc(()=>import("./SteamCard-DqsSF_Ok.js"),[])),XR=j.lazy(()=>yc(()=>import("./SteamRecents-B3lUcapc.js"),[])),ZR=j.lazy(()=>yc(()=>import("./SteamGames-DgsSfj_w.js"),[]));function eA(){return j.useEffect(()=>{document.title="Tyler's Gaming Lounge"},[]),o.jsxs("div",{className:"steam-page page",children:[o.jsxs("header",{style:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",gap:"6px"},children:[o.jsx("h1",{style:{margin:0,fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Tyler's Gaming Lounge"}),o.jsx("p",{style:{margin:"6px 0 0",color:"var(--text-soft)",fontSize:"0.9rem"},children:"This will be the home to all of my gaming collections, this is still being worked on, but thought it was cool with just steam for now."})]}),o.jsx(xf,{minHeight:260,children:o.jsx(j.Suspense,{fallback:o.jsx(Ou,{label:"Profile"}),children:o.jsx(JR,{})})}),o.jsx(xf,{minHeight:240,children:o.jsx(j.Suspense,{fallback:o.jsx(Ou,{label:"Recently played"}),children:o.jsx(XR,{})})}),o.jsx(xf,{minHeight:400,children:o.jsx(j.Suspense,{fallback:o.jsx(Ou,{label:"Library & Achievements"}),children:o.jsx(ZR,{})})})]})}function xf({children:n,minHeight:e=200}){const[t,s]=j.useState(!1),a=j.useRef(null);j.useEffect(()=>{const d=new IntersectionObserver(f=>{f[0].isIntersecting&&(s(!0),d.disconnect())},{rootMargin:"200px 0px"});return a.current&&d.observe(a.current),()=>d.disconnect()},[]);const l=t?void 0:{minHeight:e};return o.jsx("div",{ref:a,style:l,children:t?n:o.jsx(Ou,{})})}function Ou({label:n="Loading section"}){return o.jsxs("div",{className:"steam-skeleton",children:[o.jsx("div",{className:"steam-skeleton-bar"}),o.jsx("div",{className:"steam-skeleton-bar short"}),o.jsx("p",{className:"steam-skeleton-label",children:n})]})}const wf={id:null,title:"",summary:"",body:"",cover:"",tags:"",status:"draft",publishedAt:null};function Fu(n){return n?n instanceof Date?n:n!=null&&n.toDate?n.toDate():null:null}function Cu(n){const e=Fu(n);return e?e.toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"}):""}function tA(n=[]){return Array.isArray(n)?n.join(", "):""}function nA(n){return(n||"").split(",").map(e=>e.trim()).filter(Boolean)}function rA(){var Ie;const{admin:n,user:e,loading:t}=Qa(),[s,a]=O1(),[l,d]=j.useState([]),[f,m]=j.useState(!0),[y,x]=j.useState(!1),[E,C]=j.useState(!1),[U,X]=j.useState(""),[W,z]=j.useState(wf),[se,we]=j.useState(null),_e=j.useMemo(()=>l.filter(he=>he.status==="published"),[l]),ve=j.useMemo(()=>n?l:_e,[n,l,_e]),L=j.useMemo(()=>ve.find(he=>he.id===se)||null,[se,ve]);j.useEffect(()=>{document.title="Blog | Reviews"},[]),j.useEffect(()=>{t||N()},[n,t]),j.useEffect(()=>{const he=s.get("post");he&&we(he)},[s]),j.useEffect(()=>{var xe;if(f)return;const ce=s.get("post")||se,Pe=ce&&ve.some(Y=>Y.id===ce)?ce:((xe=ve[0])==null?void 0:xe.id)||null;A(Pe,{list:ve})},[f,ve]);const ie=!n&&!f&&_e.length===0;function I(he){return{id:he.id,title:he.title||"",summary:he.summary||"",body:he.body||"",cover:he.cover||"",tags:tA(he.tags),status:he.status||"draft",publishedAt:he.publishedAt||null}}async function N(he=null){var ce;if(!t){m(!0),X("");try{const Pe=bn(st,"blogPosts"),xe=n?Zf(Pe,ep("updatedAt","desc")):Zf(Pe,uw("status","==","published"),ep("publishedAt","desc")),k=(await Is(xe)).docs.map(Ve=>{const De=Ve.data();return{id:Ve.id,...De,createdAt:Fu(De.createdAt),updatedAt:Fu(De.updatedAt),publishedAt:Fu(De.publishedAt),tags:Array.isArray(De.tags)?De.tags:[]}});d(k);const H=n?k:k.filter(Ve=>Ve.status==="published"),Te=he||s.get("post")||(H.length?H[0].id:null);Te&&H.some(Ve=>Ve.id===Te)?A(Te,{list:H}):A(((ce=H[0])==null?void 0:ce.id)||null,{list:H})}catch(Pe){console.error("Failed to load blog posts",Pe);const xe=(Pe==null?void 0:Pe.code)==="permission-denied";X(xe?"You do not have permission to view these posts. Make sure you are signed in with an admin account.":"Failed to load posts. Try again shortly.")}finally{m(!1)}}}function A(he,{list:ce}={}){we(he||null),a(he?{post:he}:{});const Pe=ce||l;if(n){const xe=Pe.find(Y=>Y.id===he);z(xe?I(xe):wf)}}function O(he){A(he),window.scrollTo({top:0,behavior:"smooth"})}function D(){z(wf),we(null),a({})}function P(he){const ce=he||W.status||"draft",Pe=ce==="published"?W.publishedAt||za():null;return{title:W.title.trim(),summary:W.summary.trim(),body:W.body.trim(),cover:W.cover.trim(),tags:nA(W.tags),status:ce,publishedAt:Pe,updatedAt:za()}}async function b(he="draft"){if(!(!n||y)){if(!W.title.trim()||!W.body.trim()){X("Title and body are required.");return}x(!0),X("");try{const ce=P(he);let Pe=W.id;W.id?await Ns(Pt(st,"blogPosts",W.id),ce):Pe=(await Oa(bn(st,"blogPosts"),{...ce,createdAt:za()})).id,X(he==="published"?"Post published and visible to everyone.":"Draft saved."),await N(Pe)}catch(ce){console.error("Failed to save blog post",ce),X("Could not save the post. Try again.")}finally{x(!1)}}}async function J(he){if(!(!n||!he||E||!window.confirm("Delete this post? This cannot be undone."))){C(!0),X("");try{await Ma(Pt(st,"blogPosts",he)),X("Post deleted."),await N(),D()}catch(Pe){console.error("Failed to delete post",Pe),X("Could not delete the post.")}finally{C(!1)}}}const re=((L==null?void 0:L.body)||"").split(/\n{2,}/).map((he,ce)=>o.jsx("p",{className:"blog-body-paragraph",children:he},ce));return t?o.jsx("div",{className:"page blog-page",children:o.jsx("div",{className:"blog-guard-card",children:"Checking access..."})}):e?n?o.jsxs("div",{className:"page blog-page",children:[o.jsxs("header",{className:"blog-hero",children:[o.jsx("div",{className:"blog-pill",children:n?"Admin workspace":"Latest updates"}),o.jsx("h1",{children:"Blog & Reviews"}),o.jsx("p",{children:"Share reviews for anime or manga you have read. Draft privately, publish when ready, and keep visitors in the loop with new releases."})]}),U&&o.jsx("div",{className:"blog-status",children:U}),o.jsxs("div",{className:"blog-shell",children:[o.jsxs("aside",{className:"blog-sidebar",children:[o.jsxs("div",{className:"blog-sidebar-header",children:[o.jsxs("div",{children:[o.jsx("div",{className:"blog-sidebar-label",children:"Posts"}),o.jsxs("div",{className:"blog-sidebar-count",children:[ve.length," ",ve.length===1?"entry":"entries"]})]}),n&&o.jsx("button",{type:"button",className:"blog-btn solid",onClick:D,children:"+ New draft"})]}),o.jsxs("div",{className:"blog-list",children:[f&&o.jsx("div",{className:"blog-muted",children:"Loading posts..."}),!f&&!ve.length&&o.jsx("div",{className:"blog-muted",children:"No posts yet."}),ve.map(he=>o.jsxs("button",{className:"blog-list-item"+(se===he.id?" active":""),onClick:()=>O(he.id),children:[o.jsxs("div",{className:"blog-list-row",children:[o.jsx("span",{className:"blog-list-title",children:he.title||"Untitled"}),o.jsx("span",{className:"blog-chip "+(he.status==="published"?"success":"draft"),children:he.status==="published"?"Published":"Draft"})]}),o.jsx("div",{className:"blog-list-sub",children:he.status==="published"?`Published ${Cu(he.publishedAt)}`:`Last touched ${Cu(he.updatedAt)}`})]},he.id))]})]}),o.jsxs("section",{className:"blog-main",children:[ie?o.jsxs("div",{className:"blog-guard-card",children:[o.jsx("h3",{children:"Under construction"}),o.jsx("p",{children:"This blog page is being built. Once posts are published, they will appear here. Admins can already create and publish posts."})]}):L?o.jsxs("article",{className:"blog-article",children:[o.jsxs("div",{className:"blog-article-meta",children:[o.jsx("span",{className:"blog-chip "+(L.status==="published"?"success":"draft"),children:L.status==="published"?"Published":"Draft"}),o.jsx("span",{className:"blog-meta-text",children:L.status==="published"?`Published ${Cu(L.publishedAt)}`:`Last saved ${Cu(L.updatedAt)}`})]}),o.jsx("h2",{className:"blog-article-title",children:L.title||"Untitled"}),L.summary&&o.jsx("p",{className:"blog-article-summary",children:L.summary}),L.cover&&o.jsx("div",{className:"blog-cover",children:o.jsx("img",{src:L.cover,alt:""})}),o.jsx("div",{className:"blog-body",children:re}),(Ie=L.tags)!=null&&Ie.length?o.jsx("div",{className:"blog-tag-row",children:L.tags.map(he=>o.jsx("span",{className:"blog-chip ghost",children:he},he))}):null]}):o.jsxs("div",{className:"blog-guard-card",children:[o.jsx("h3",{children:"No post selected"}),o.jsx("p",{children:"Select a post from the left to read it."})]}),n&&o.jsxs("div",{className:"blog-editor-card",children:[o.jsxs("div",{className:"blog-editor-header",children:[o.jsxs("div",{children:[o.jsx("div",{className:"blog-sidebar-label",children:W.id?"Edit post":"New draft"}),o.jsx("div",{className:"blog-sidebar-count",children:W.id?"Update and publish when ready":"Fill in the details to create"})]}),W.id&&o.jsx("button",{type:"button",className:"blog-btn danger",onClick:()=>J(W.id),disabled:E,children:E?"Deleting...":"Delete"})]}),o.jsxs("div",{className:"blog-form",children:[o.jsxs("label",{className:"blog-field",children:[o.jsx("span",{children:"Title"}),o.jsx("input",{type:"text",value:W.title,onChange:he=>z(ce=>({...ce,title:he.target.value})),placeholder:"e.g., Chainsaw Man Volume 14 Review"})]}),o.jsxs("label",{className:"blog-field",children:[o.jsx("span",{children:"Summary"}),o.jsx("input",{type:"text",value:W.summary,onChange:he=>z(ce=>({...ce,summary:he.target.value})),placeholder:"One-liner that appears in previews"})]}),o.jsxs("label",{className:"blog-field",children:[o.jsx("span",{children:"Cover image URL (optional)"}),o.jsx("input",{type:"url",value:W.cover,onChange:he=>z(ce=>({...ce,cover:he.target.value})),placeholder:"https://..."})]}),o.jsxs("label",{className:"blog-field",children:[o.jsx("span",{children:"Tags (comma separated)"}),o.jsx("input",{type:"text",value:W.tags,onChange:he=>z(ce=>({...ce,tags:he.target.value})),placeholder:"anime, manga, review"})]}),o.jsxs("label",{className:"blog-field",children:[o.jsx("span",{children:"Body"}),o.jsx("textarea",{rows:8,value:W.body,onChange:he=>z(ce=>({...ce,body:he.target.value})),placeholder:"Write your review here. Separate paragraphs with blank lines."})]}),o.jsxs("div",{className:"blog-actions",children:[o.jsx("button",{type:"button",className:"blog-btn",onClick:()=>b("draft"),disabled:y,children:y?"Saving...":"Save draft"}),o.jsx("button",{type:"button",className:"blog-btn solid",onClick:()=>b("published"),disabled:y,children:y?"Publishing...":"Publish"}),W.status==="published"&&o.jsx("button",{type:"button",className:"blog-btn ghost",onClick:()=>b("draft"),disabled:y,children:"Move to draft"})]})]})]})]})]})]}):o.jsx(Tf,{to:"/home",replace:!0}):o.jsx(Tf,{to:"/signin",replace:!0})}function sA(){return o.jsxs(JP,{children:[o.jsx(rR,{}),o.jsxs(C1,{children:[o.jsx(as,{path:"/",element:o.jsx(f_,{})}),o.jsx(as,{path:"/home",element:o.jsx(f_,{})}),o.jsx(as,{path:"/manga",element:o.jsx(mR,{})}),o.jsx(as,{path:"/anime",element:o.jsx(CR,{})}),o.jsx(as,{path:"/tcg",element:o.jsx(NR,{})}),o.jsx(as,{path:"/music",element:o.jsx(QR,{})}),o.jsx(as,{path:"/blog",element:o.jsx(rA,{})}),o.jsx(as,{path:"/dashboard",element:o.jsx(KR,{})}),o.jsx(as,{path:"/signin",element:o.jsx(YR,{})}),o.jsx(as,{path:"/steam",element:o.jsx(eA,{})}),o.jsx(as,{path:"*",element:o.jsx(Tf,{to:"/home",replace:!0})})]})]})}DE.createRoot(document.getElementById("root")).render(o.jsx(rp.StrictMode,{children:o.jsx(D1,{basename:"/base",children:o.jsx(sA,{})})}));export{o as j,j as r};
