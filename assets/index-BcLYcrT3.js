function Wx(n,e){for(var t=0;t<e.length;t++){const s=e[t];if(typeof s!="string"&&!Array.isArray(s)){for(const a in s)if(a!=="default"&&!(a in n)){const l=Object.getOwnPropertyDescriptor(s,a);l&&Object.defineProperty(n,a,l.get?l:{enumerable:!0,get:()=>s[a]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const d of l.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&s(d)}).observe(document,{childList:!0,subtree:!0});function t(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(a){if(a.ep)return;a.ep=!0;const l=t(a);fetch(a.href,l)}})();function e_(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Uh={exports:{}},ml={},zh={exports:{}},lt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hg;function Gx(){if(Hg)return lt;Hg=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),d=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),v=Symbol.for("react.memo"),w=Symbol.for("react.lazy"),T=Symbol.iterator;function I(D){return D===null||typeof D!="object"?null:(D=T&&D[T]||D["@@iterator"],typeof D=="function"?D:null)}var B={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},X=Object.assign,K={};function M(D,N,se){this.props=D,this.context=N,this.refs=K,this.updater=se||B}M.prototype.isReactComponent={},M.prototype.setState=function(D,N){if(typeof D!="object"&&typeof D!="function"&&D!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,D,N,"setState")},M.prototype.forceUpdate=function(D){this.updater.enqueueForceUpdate(this,D,"forceUpdate")};function ne(){}ne.prototype=M.prototype;function be(D,N,se){this.props=D,this.context=N,this.refs=K,this.updater=se||B}var _e=be.prototype=new ne;_e.constructor=be,X(_e,M.prototype),_e.isPureReactComponent=!0;var we=Array.isArray,le=Object.prototype.hasOwnProperty,Ie={current:null},A={key:!0,ref:!0,__self:!0,__source:!0};function P(D,N,se){var te,Ee={},ve=null,Me=null;if(N!=null)for(te in N.ref!==void 0&&(Me=N.ref),N.key!==void 0&&(ve=""+N.key),N)le.call(N,te)&&!A.hasOwnProperty(te)&&(Ee[te]=N[te]);var He=arguments.length-2;if(He===1)Ee.children=se;else if(1<He){for(var et=Array(He),xt=0;xt<He;xt++)et[xt]=arguments[xt+2];Ee.children=et}if(D&&D.defaultProps)for(te in He=D.defaultProps,He)Ee[te]===void 0&&(Ee[te]=He[te]);return{$$typeof:n,type:D,key:ve,ref:Me,props:Ee,_owner:Ie.current}}function R(D,N){return{$$typeof:n,type:D.type,key:N,ref:D.ref,props:D.props,_owner:D._owner}}function F(D){return typeof D=="object"&&D!==null&&D.$$typeof===n}function z(D){var N={"=":"=0",":":"=2"};return"$"+D.replace(/[=:]/g,function(se){return N[se]})}var L=/\/+/g;function b(D,N){return typeof D=="object"&&D!==null&&D.key!=null?z(""+D.key):N.toString(36)}function he(D,N,se,te,Ee){var ve=typeof D;(ve==="undefined"||ve==="boolean")&&(D=null);var Me=!1;if(D===null)Me=!0;else switch(ve){case"string":case"number":Me=!0;break;case"object":switch(D.$$typeof){case n:case e:Me=!0}}if(Me)return Me=D,Ee=Ee(Me),D=te===""?"."+b(Me,0):te,we(Ee)?(se="",D!=null&&(se=D.replace(L,"$&/")+"/"),he(Ee,N,se,"",function(xt){return xt})):Ee!=null&&(F(Ee)&&(Ee=R(Ee,se+(!Ee.key||Me&&Me.key===Ee.key?"":(""+Ee.key).replace(L,"$&/")+"/")+D)),N.push(Ee)),1;if(Me=0,te=te===""?".":te+":",we(D))for(var He=0;He<D.length;He++){ve=D[He];var et=te+b(ve,He);Me+=he(ve,N,se,et,Ee)}else if(et=I(D),typeof et=="function")for(D=et.call(D),He=0;!(ve=D.next()).done;)ve=ve.value,et=te+b(ve,He++),Me+=he(ve,N,se,et,Ee);else if(ve==="object")throw N=String(D),Error("Objects are not valid as a React child (found: "+(N==="[object Object]"?"object with keys {"+Object.keys(D).join(", ")+"}":N)+"). If you meant to render a collection of children, use an array instead.");return Me}function xe(D,N,se){if(D==null)return D;var te=[],Ee=0;return he(D,te,"","",function(ve){return N.call(se,ve,Ee++)}),te}function ut(D){if(D._status===-1){var N=D._result;N=N(),N.then(function(se){(D._status===0||D._status===-1)&&(D._status=1,D._result=se)},function(se){(D._status===0||D._status===-1)&&(D._status=2,D._result=se)}),D._status===-1&&(D._status=0,D._result=N)}if(D._status===1)return D._result.default;throw D._result}var Be={current:null},ye={transition:null},je={ReactCurrentDispatcher:Be,ReactCurrentBatchConfig:ye,ReactCurrentOwner:Ie};function Pe(){throw Error("act(...) is not supported in production builds of React.")}return lt.Children={map:xe,forEach:function(D,N,se){xe(D,function(){N.apply(this,arguments)},se)},count:function(D){var N=0;return xe(D,function(){N++}),N},toArray:function(D){return xe(D,function(N){return N})||[]},only:function(D){if(!F(D))throw Error("React.Children.only expected to receive a single React element child.");return D}},lt.Component=M,lt.Fragment=t,lt.Profiler=a,lt.PureComponent=be,lt.StrictMode=s,lt.Suspense=m,lt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=je,lt.act=Pe,lt.cloneElement=function(D,N,se){if(D==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+D+".");var te=X({},D.props),Ee=D.key,ve=D.ref,Me=D._owner;if(N!=null){if(N.ref!==void 0&&(ve=N.ref,Me=Ie.current),N.key!==void 0&&(Ee=""+N.key),D.type&&D.type.defaultProps)var He=D.type.defaultProps;for(et in N)le.call(N,et)&&!A.hasOwnProperty(et)&&(te[et]=N[et]===void 0&&He!==void 0?He[et]:N[et])}var et=arguments.length-2;if(et===1)te.children=se;else if(1<et){He=Array(et);for(var xt=0;xt<et;xt++)He[xt]=arguments[xt+2];te.children=He}return{$$typeof:n,type:D.type,key:Ee,ref:ve,props:te,_owner:Me}},lt.createContext=function(D){return D={$$typeof:d,_currentValue:D,_currentValue2:D,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},D.Provider={$$typeof:l,_context:D},D.Consumer=D},lt.createElement=P,lt.createFactory=function(D){var N=P.bind(null,D);return N.type=D,N},lt.createRef=function(){return{current:null}},lt.forwardRef=function(D){return{$$typeof:f,render:D}},lt.isValidElement=F,lt.lazy=function(D){return{$$typeof:w,_payload:{_status:-1,_result:D},_init:ut}},lt.memo=function(D,N){return{$$typeof:v,type:D,compare:N===void 0?null:N}},lt.startTransition=function(D){var N=ye.transition;ye.transition={};try{D()}finally{ye.transition=N}},lt.unstable_act=Pe,lt.useCallback=function(D,N){return Be.current.useCallback(D,N)},lt.useContext=function(D){return Be.current.useContext(D)},lt.useDebugValue=function(){},lt.useDeferredValue=function(D){return Be.current.useDeferredValue(D)},lt.useEffect=function(D,N){return Be.current.useEffect(D,N)},lt.useId=function(){return Be.current.useId()},lt.useImperativeHandle=function(D,N,se){return Be.current.useImperativeHandle(D,N,se)},lt.useInsertionEffect=function(D,N){return Be.current.useInsertionEffect(D,N)},lt.useLayoutEffect=function(D,N){return Be.current.useLayoutEffect(D,N)},lt.useMemo=function(D,N){return Be.current.useMemo(D,N)},lt.useReducer=function(D,N,se){return Be.current.useReducer(D,N,se)},lt.useRef=function(D){return Be.current.useRef(D)},lt.useState=function(D){return Be.current.useState(D)},lt.useSyncExternalStore=function(D,N,se){return Be.current.useSyncExternalStore(D,N,se)},lt.useTransition=function(){return Be.current.useTransition()},lt.version="18.3.1",lt}var qg;function Lf(){return qg||(qg=1,zh.exports=Gx()),zh.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kg;function Hx(){if(Kg)return ml;Kg=1;var n=Lf(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,a=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function d(f,m,v){var w,T={},I=null,B=null;v!==void 0&&(I=""+v),m.key!==void 0&&(I=""+m.key),m.ref!==void 0&&(B=m.ref);for(w in m)s.call(m,w)&&!l.hasOwnProperty(w)&&(T[w]=m[w]);if(f&&f.defaultProps)for(w in m=f.defaultProps,m)T[w]===void 0&&(T[w]=m[w]);return{$$typeof:e,type:f,key:I,ref:B,props:T,_owner:a.current}}return ml.Fragment=t,ml.jsx=d,ml.jsxs=d,ml}var Qg;function qx(){return Qg||(Qg=1,Uh.exports=Hx()),Uh.exports}var c=qx(),k=Lf();const Of=e_(k),Kx=Wx({__proto__:null,default:Of},[k]);var au={},Bh={exports:{}},_r={},$h={exports:{}},Wh={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yg;function Qx(){return Yg||(Yg=1,(function(n){function e(ye,je){var Pe=ye.length;ye.push(je);e:for(;0<Pe;){var D=Pe-1>>>1,N=ye[D];if(0<a(N,je))ye[D]=je,ye[Pe]=N,Pe=D;else break e}}function t(ye){return ye.length===0?null:ye[0]}function s(ye){if(ye.length===0)return null;var je=ye[0],Pe=ye.pop();if(Pe!==je){ye[0]=Pe;e:for(var D=0,N=ye.length,se=N>>>1;D<se;){var te=2*(D+1)-1,Ee=ye[te],ve=te+1,Me=ye[ve];if(0>a(Ee,Pe))ve<N&&0>a(Me,Ee)?(ye[D]=Me,ye[ve]=Pe,D=ve):(ye[D]=Ee,ye[te]=Pe,D=te);else if(ve<N&&0>a(Me,Pe))ye[D]=Me,ye[ve]=Pe,D=ve;else break e}}return je}function a(ye,je){var Pe=ye.sortIndex-je.sortIndex;return Pe!==0?Pe:ye.id-je.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;n.unstable_now=function(){return l.now()}}else{var d=Date,f=d.now();n.unstable_now=function(){return d.now()-f}}var m=[],v=[],w=1,T=null,I=3,B=!1,X=!1,K=!1,M=typeof setTimeout=="function"?setTimeout:null,ne=typeof clearTimeout=="function"?clearTimeout:null,be=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _e(ye){for(var je=t(v);je!==null;){if(je.callback===null)s(v);else if(je.startTime<=ye)s(v),je.sortIndex=je.expirationTime,e(m,je);else break;je=t(v)}}function we(ye){if(K=!1,_e(ye),!X)if(t(m)!==null)X=!0,ut(le);else{var je=t(v);je!==null&&Be(we,je.startTime-ye)}}function le(ye,je){X=!1,K&&(K=!1,ne(P),P=-1),B=!0;var Pe=I;try{for(_e(je),T=t(m);T!==null&&(!(T.expirationTime>je)||ye&&!z());){var D=T.callback;if(typeof D=="function"){T.callback=null,I=T.priorityLevel;var N=D(T.expirationTime<=je);je=n.unstable_now(),typeof N=="function"?T.callback=N:T===t(m)&&s(m),_e(je)}else s(m);T=t(m)}if(T!==null)var se=!0;else{var te=t(v);te!==null&&Be(we,te.startTime-je),se=!1}return se}finally{T=null,I=Pe,B=!1}}var Ie=!1,A=null,P=-1,R=5,F=-1;function z(){return!(n.unstable_now()-F<R)}function L(){if(A!==null){var ye=n.unstable_now();F=ye;var je=!0;try{je=A(!0,ye)}finally{je?b():(Ie=!1,A=null)}}else Ie=!1}var b;if(typeof be=="function")b=function(){be(L)};else if(typeof MessageChannel<"u"){var he=new MessageChannel,xe=he.port2;he.port1.onmessage=L,b=function(){xe.postMessage(null)}}else b=function(){M(L,0)};function ut(ye){A=ye,Ie||(Ie=!0,b())}function Be(ye,je){P=M(function(){ye(n.unstable_now())},je)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ye){ye.callback=null},n.unstable_continueExecution=function(){X||B||(X=!0,ut(le))},n.unstable_forceFrameRate=function(ye){0>ye||125<ye?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<ye?Math.floor(1e3/ye):5},n.unstable_getCurrentPriorityLevel=function(){return I},n.unstable_getFirstCallbackNode=function(){return t(m)},n.unstable_next=function(ye){switch(I){case 1:case 2:case 3:var je=3;break;default:je=I}var Pe=I;I=je;try{return ye()}finally{I=Pe}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(ye,je){switch(ye){case 1:case 2:case 3:case 4:case 5:break;default:ye=3}var Pe=I;I=ye;try{return je()}finally{I=Pe}},n.unstable_scheduleCallback=function(ye,je,Pe){var D=n.unstable_now();switch(typeof Pe=="object"&&Pe!==null?(Pe=Pe.delay,Pe=typeof Pe=="number"&&0<Pe?D+Pe:D):Pe=D,ye){case 1:var N=-1;break;case 2:N=250;break;case 5:N=1073741823;break;case 4:N=1e4;break;default:N=5e3}return N=Pe+N,ye={id:w++,callback:je,priorityLevel:ye,startTime:Pe,expirationTime:N,sortIndex:-1},Pe>D?(ye.sortIndex=Pe,e(v,ye),t(m)===null&&ye===t(v)&&(K?(ne(P),P=-1):K=!0,Be(we,Pe-D))):(ye.sortIndex=N,e(m,ye),X||B||(X=!0,ut(le))),ye},n.unstable_shouldYield=z,n.unstable_wrapCallback=function(ye){var je=I;return function(){var Pe=I;I=je;try{return ye.apply(this,arguments)}finally{I=Pe}}}})(Wh)),Wh}var Jg;function Yx(){return Jg||(Jg=1,$h.exports=Qx()),$h.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xg;function Jx(){if(Xg)return _r;Xg=1;var n=Lf(),e=Yx();function t(r){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+r,o=1;o<arguments.length;o++)i+="&args[]="+encodeURIComponent(arguments[o]);return"Minified React error #"+r+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,a={};function l(r,i){d(r,i),d(r+"Capture",i)}function d(r,i){for(a[r]=i,r=0;r<i.length;r++)s.add(i[r])}var f=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),m=Object.prototype.hasOwnProperty,v=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,w={},T={};function I(r){return m.call(T,r)?!0:m.call(w,r)?!1:v.test(r)?T[r]=!0:(w[r]=!0,!1)}function B(r,i,o,h){if(o!==null&&o.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return h?!1:o!==null?!o.acceptsBooleans:(r=r.toLowerCase().slice(0,5),r!=="data-"&&r!=="aria-");default:return!1}}function X(r,i,o,h){if(i===null||typeof i>"u"||B(r,i,o,h))return!0;if(h)return!1;if(o!==null)switch(o.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function K(r,i,o,h,p,y,x){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=h,this.attributeNamespace=p,this.mustUseProperty=o,this.propertyName=r,this.type=i,this.sanitizeURL=y,this.removeEmptyString=x}var M={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(r){M[r]=new K(r,0,!1,r,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(r){var i=r[0];M[i]=new K(i,1,!1,r[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(r){M[r]=new K(r,2,!1,r.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(r){M[r]=new K(r,2,!1,r,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(r){M[r]=new K(r,3,!1,r.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(r){M[r]=new K(r,3,!0,r,null,!1,!1)}),["capture","download"].forEach(function(r){M[r]=new K(r,4,!1,r,null,!1,!1)}),["cols","rows","size","span"].forEach(function(r){M[r]=new K(r,6,!1,r,null,!1,!1)}),["rowSpan","start"].forEach(function(r){M[r]=new K(r,5,!1,r.toLowerCase(),null,!1,!1)});var ne=/[\-:]([a-z])/g;function be(r){return r[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(r){var i=r.replace(ne,be);M[i]=new K(i,1,!1,r,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(r){var i=r.replace(ne,be);M[i]=new K(i,1,!1,r,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(r){var i=r.replace(ne,be);M[i]=new K(i,1,!1,r,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(r){M[r]=new K(r,1,!1,r.toLowerCase(),null,!1,!1)}),M.xlinkHref=new K("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(r){M[r]=new K(r,1,!1,r.toLowerCase(),null,!0,!0)});function _e(r,i,o,h){var p=M.hasOwnProperty(i)?M[i]:null;(p!==null?p.type!==0:h||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(X(i,o,p,h)&&(o=null),h||p===null?I(i)&&(o===null?r.removeAttribute(i):r.setAttribute(i,""+o)):p.mustUseProperty?r[p.propertyName]=o===null?p.type===3?!1:"":o:(i=p.attributeName,h=p.attributeNamespace,o===null?r.removeAttribute(i):(p=p.type,o=p===3||p===4&&o===!0?"":""+o,h?r.setAttributeNS(h,i,o):r.setAttribute(i,o))))}var we=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,le=Symbol.for("react.element"),Ie=Symbol.for("react.portal"),A=Symbol.for("react.fragment"),P=Symbol.for("react.strict_mode"),R=Symbol.for("react.profiler"),F=Symbol.for("react.provider"),z=Symbol.for("react.context"),L=Symbol.for("react.forward_ref"),b=Symbol.for("react.suspense"),he=Symbol.for("react.suspense_list"),xe=Symbol.for("react.memo"),ut=Symbol.for("react.lazy"),Be=Symbol.for("react.offscreen"),ye=Symbol.iterator;function je(r){return r===null||typeof r!="object"?null:(r=ye&&r[ye]||r["@@iterator"],typeof r=="function"?r:null)}var Pe=Object.assign,D;function N(r){if(D===void 0)try{throw Error()}catch(o){var i=o.stack.trim().match(/\n( *(at )?)/);D=i&&i[1]||""}return`
`+D+r}var se=!1;function te(r,i){if(!r||se)return"";se=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(ee){var h=ee}Reflect.construct(r,[],i)}else{try{i.call()}catch(ee){h=ee}r.call(i.prototype)}else{try{throw Error()}catch(ee){h=ee}r()}}catch(ee){if(ee&&h&&typeof ee.stack=="string"){for(var p=ee.stack.split(`
`),y=h.stack.split(`
`),x=p.length-1,j=y.length-1;1<=x&&0<=j&&p[x]!==y[j];)j--;for(;1<=x&&0<=j;x--,j--)if(p[x]!==y[j]){if(x!==1||j!==1)do if(x--,j--,0>j||p[x]!==y[j]){var U=`
`+p[x].replace(" at new "," at ");return r.displayName&&U.includes("<anonymous>")&&(U=U.replace("<anonymous>",r.displayName)),U}while(1<=x&&0<=j);break}}}finally{se=!1,Error.prepareStackTrace=o}return(r=r?r.displayName||r.name:"")?N(r):""}function Ee(r){switch(r.tag){case 5:return N(r.type);case 16:return N("Lazy");case 13:return N("Suspense");case 19:return N("SuspenseList");case 0:case 2:case 15:return r=te(r.type,!1),r;case 11:return r=te(r.type.render,!1),r;case 1:return r=te(r.type,!0),r;default:return""}}function ve(r){if(r==null)return null;if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case A:return"Fragment";case Ie:return"Portal";case R:return"Profiler";case P:return"StrictMode";case b:return"Suspense";case he:return"SuspenseList"}if(typeof r=="object")switch(r.$$typeof){case z:return(r.displayName||"Context")+".Consumer";case F:return(r._context.displayName||"Context")+".Provider";case L:var i=r.render;return r=r.displayName,r||(r=i.displayName||i.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case xe:return i=r.displayName||null,i!==null?i:ve(r.type)||"Memo";case ut:i=r._payload,r=r._init;try{return ve(r(i))}catch{}}return null}function Me(r){var i=r.type;switch(r.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return r=i.render,r=r.displayName||r.name||"",i.displayName||(r!==""?"ForwardRef("+r+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ve(i);case 8:return i===P?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function He(r){switch(typeof r){case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function et(r){var i=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function xt(r){var i=et(r)?"checked":"value",o=Object.getOwnPropertyDescriptor(r.constructor.prototype,i),h=""+r[i];if(!r.hasOwnProperty(i)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var p=o.get,y=o.set;return Object.defineProperty(r,i,{configurable:!0,get:function(){return p.call(this)},set:function(x){h=""+x,y.call(this,x)}}),Object.defineProperty(r,i,{enumerable:o.enumerable}),{getValue:function(){return h},setValue:function(x){h=""+x},stopTracking:function(){r._valueTracker=null,delete r[i]}}}}function J(r){r._valueTracker||(r._valueTracker=xt(r))}function $e(r){if(!r)return!1;var i=r._valueTracker;if(!i)return!0;var o=i.getValue(),h="";return r&&(h=et(r)?r.checked?"true":"false":r.value),r=h,r!==o?(i.setValue(r),!0):!1}function Ve(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}function Ke(r,i){var o=i.checked;return Pe({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:o??r._wrapperState.initialChecked})}function Et(r,i){var o=i.defaultValue==null?"":i.defaultValue,h=i.checked!=null?i.checked:i.defaultChecked;o=He(i.value!=null?i.value:o),r._wrapperState={initialChecked:h,initialValue:o,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function Tt(r,i){i=i.checked,i!=null&&_e(r,"checked",i,!1)}function _t(r,i){Tt(r,i);var o=He(i.value),h=i.type;if(o!=null)h==="number"?(o===0&&r.value===""||r.value!=o)&&(r.value=""+o):r.value!==""+o&&(r.value=""+o);else if(h==="submit"||h==="reset"){r.removeAttribute("value");return}i.hasOwnProperty("value")?$t(r,i.type,o):i.hasOwnProperty("defaultValue")&&$t(r,i.type,He(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(r.defaultChecked=!!i.defaultChecked)}function St(r,i,o){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var h=i.type;if(!(h!=="submit"&&h!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+r._wrapperState.initialValue,o||i===r.value||(r.value=i),r.defaultValue=i}o=r.name,o!==""&&(r.name=""),r.defaultChecked=!!r._wrapperState.initialChecked,o!==""&&(r.name=o)}function $t(r,i,o){(i!=="number"||Ve(r.ownerDocument)!==r)&&(o==null?r.defaultValue=""+r._wrapperState.initialValue:r.defaultValue!==""+o&&(r.defaultValue=""+o))}var cn=Array.isArray;function Cn(r,i,o,h){if(r=r.options,i){i={};for(var p=0;p<o.length;p++)i["$"+o[p]]=!0;for(o=0;o<r.length;o++)p=i.hasOwnProperty("$"+r[o].value),r[o].selected!==p&&(r[o].selected=p),p&&h&&(r[o].defaultSelected=!0)}else{for(o=""+He(o),i=null,p=0;p<r.length;p++){if(r[p].value===o){r[p].selected=!0,h&&(r[p].defaultSelected=!0);return}i!==null||r[p].disabled||(i=r[p])}i!==null&&(i.selected=!0)}}function Qn(r,i){if(i.dangerouslySetInnerHTML!=null)throw Error(t(91));return Pe({},i,{value:void 0,defaultValue:void 0,children:""+r._wrapperState.initialValue})}function Yn(r,i){var o=i.value;if(o==null){if(o=i.children,i=i.defaultValue,o!=null){if(i!=null)throw Error(t(92));if(cn(o)){if(1<o.length)throw Error(t(93));o=o[0]}i=o}i==null&&(i=""),o=i}r._wrapperState={initialValue:He(o)}}function un(r,i){var o=He(i.value),h=He(i.defaultValue);o!=null&&(o=""+o,o!==r.value&&(r.value=o),i.defaultValue==null&&r.defaultValue!==o&&(r.defaultValue=o)),h!=null&&(r.defaultValue=""+h)}function Jn(r){var i=r.textContent;i===r._wrapperState.initialValue&&i!==""&&i!==null&&(r.value=i)}function ft(r){switch(r){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Pt(r,i){return r==null||r==="http://www.w3.org/1999/xhtml"?ft(i):r==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":r}var Jt,ar=(function(r){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,o,h,p){MSApp.execUnsafeLocalFunction(function(){return r(i,o,h,p)})}:r})(function(r,i){if(r.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in r)r.innerHTML=i;else{for(Jt=Jt||document.createElement("div"),Jt.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=Jt.firstChild;r.firstChild;)r.removeChild(r.firstChild);for(;i.firstChild;)r.appendChild(i.firstChild)}});function or(r,i){if(i){var o=r.firstChild;if(o&&o===r.lastChild&&o.nodeType===3){o.nodeValue=i;return}}r.textContent=i}var Vr={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},lr=["Webkit","ms","Moz","O"];Object.keys(Vr).forEach(function(r){lr.forEach(function(i){i=i+r.charAt(0).toUpperCase()+r.substring(1),Vr[i]=Vr[r]})});function yn(r,i,o){return i==null||typeof i=="boolean"||i===""?"":o||typeof i!="number"||i===0||Vr.hasOwnProperty(r)&&Vr[r]?(""+i).trim():i+"px"}function Fs(r,i){r=r.style;for(var o in i)if(i.hasOwnProperty(o)){var h=o.indexOf("--")===0,p=yn(o,i[o],h);o==="float"&&(o="cssFloat"),h?r.setProperty(o,p):r[o]=p}}var ms=Pe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ct(r,i){if(i){if(ms[r]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(t(137,r));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(t(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(t(61))}if(i.style!=null&&typeof i.style!="object")throw Error(t(62))}}function Lr(r,i){if(r.indexOf("-")===-1)return typeof i.is=="string";switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var cr=null;function gs(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var ur=null,In=null,Xn=null;function Sr(r){if(r=el(r)){if(typeof ur!="function")throw Error(t(280));var i=r.stateNode;i&&(i=xc(i),ur(r.stateNode,r.type,i))}}function Wt(r){In?Xn?Xn.push(r):Xn=[r]:In=r}function Zn(){if(In){var r=In,i=Xn;if(Xn=In=null,Sr(r),i)for(r=0;r<i.length;r++)Sr(i[r])}}function er(r,i){return r(i)}function ys(){}var ct=!1;function vn(r,i,o){if(ct)return r(i,o);ct=!0;try{return er(r,i,o)}finally{ct=!1,(In!==null||Xn!==null)&&(ys(),Zn())}}function At(r,i){var o=r.stateNode;if(o===null)return null;var h=xc(o);if(h===null)return null;o=h[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(r=r.type,h=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!h;break e;default:r=!1}if(r)return null;if(o&&typeof o!="function")throw Error(t(231,i,typeof o));return o}var Jr=!1;if(f)try{var bn={};Object.defineProperty(bn,"passive",{get:function(){Jr=!0}}),window.addEventListener("test",bn,bn),window.removeEventListener("test",bn,bn)}catch{Jr=!1}function Or(r,i,o,h,p,y,x,j,U){var ee=Array.prototype.slice.call(arguments,3);try{i.apply(o,ee)}catch(pe){this.onError(pe)}}var Cr=!1,Pn=null,Rn=!1,Nn=null,vs={onError:function(r){Cr=!0,Pn=r}};function Gt(r,i,o,h,p,y,x,j,U){Cr=!1,Pn=null,Or.apply(vs,arguments)}function Us(r,i,o,h,p,y,x,j,U){if(Gt.apply(this,arguments),Cr){if(Cr){var ee=Pn;Cr=!1,Pn=null}else throw Error(t(198));Rn||(Rn=!0,Nn=ee)}}function _n(r){var i=r,o=r;if(r.alternate)for(;i.return;)i=i.return;else{r=i;do i=r,(i.flags&4098)!==0&&(o=i.return),r=i.return;while(r)}return i.tag===3?o:null}function Mn(r){if(r.tag===13){var i=r.memoizedState;if(i===null&&(r=r.alternate,r!==null&&(i=r.memoizedState)),i!==null)return i.dehydrated}return null}function Fn(r){if(_n(r)!==r)throw Error(t(188))}function pi(r){var i=r.alternate;if(!i){if(i=_n(r),i===null)throw Error(t(188));return i!==r?null:r}for(var o=r,h=i;;){var p=o.return;if(p===null)break;var y=p.alternate;if(y===null){if(h=p.return,h!==null){o=h;continue}break}if(p.child===y.child){for(y=p.child;y;){if(y===o)return Fn(p),r;if(y===h)return Fn(p),i;y=y.sibling}throw Error(t(188))}if(o.return!==h.return)o=p,h=y;else{for(var x=!1,j=p.child;j;){if(j===o){x=!0,o=p,h=y;break}if(j===h){x=!0,h=p,o=y;break}j=j.sibling}if(!x){for(j=y.child;j;){if(j===o){x=!0,o=y,h=p;break}if(j===h){x=!0,h=y,o=p;break}j=j.sibling}if(!x)throw Error(t(189))}}if(o.alternate!==h)throw Error(t(190))}if(o.tag!==3)throw Error(t(188));return o.stateNode.current===o?r:i}function Xr(r){return r=pi(r),r!==null?_s(r):null}function _s(r){if(r.tag===5||r.tag===6)return r;for(r=r.child;r!==null;){var i=_s(r);if(i!==null)return i;r=r.sibling}return null}var ws=e.unstable_scheduleCallback,Zr=e.unstable_cancelCallback,Ir=e.unstable_shouldYield,zs=e.unstable_requestPaint,pt=e.unstable_now,E=e.unstable_getCurrentPriorityLevel,G=e.unstable_ImmediatePriority,H=e.unstable_UserBlockingPriority,V=e.unstable_NormalPriority,q=e.unstable_LowPriority,ae=e.unstable_IdlePriority,ie=null,Ne=null;function Se(r){if(Ne&&typeof Ne.onCommitFiberRoot=="function")try{Ne.onCommitFiberRoot(ie,r,void 0,(r.current.flags&128)===128)}catch{}}var ke=Math.clz32?Math.clz32:De,oe=Math.log,rt=Math.LN2;function De(r){return r>>>=0,r===0?32:31-(oe(r)/rt|0)|0}var Qt=64,Mr=4194304;function br(r){switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return r&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return r}}function es(r,i){var o=r.pendingLanes;if(o===0)return 0;var h=0,p=r.suspendedLanes,y=r.pingedLanes,x=o&268435455;if(x!==0){var j=x&~p;j!==0?h=br(j):(y&=x,y!==0&&(h=br(y)))}else x=o&~p,x!==0?h=br(x):y!==0&&(h=br(y));if(h===0)return 0;if(i!==0&&i!==h&&(i&p)===0&&(p=h&-h,y=i&-i,p>=y||p===16&&(y&4194240)!==0))return i;if((h&4)!==0&&(h|=o&16),i=r.entangledLanes,i!==0)for(r=r.entanglements,i&=h;0<i;)o=31-ke(i),p=1<<o,h|=r[o],i&=~p;return h}function ts(r,i){switch(r){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function S(r,i){for(var o=r.suspendedLanes,h=r.pingedLanes,p=r.expirationTimes,y=r.pendingLanes;0<y;){var x=31-ke(y),j=1<<x,U=p[x];U===-1?((j&o)===0||(j&h)!==0)&&(p[x]=ts(j,i)):U<=i&&(r.expiredLanes|=j),y&=~j}}function O(r){return r=r.pendingLanes&-1073741825,r!==0?r:r&1073741824?1073741824:0}function $(){var r=Qt;return Qt<<=1,(Qt&4194240)===0&&(Qt=64),r}function ce(r){for(var i=[],o=0;31>o;o++)i.push(r);return i}function me(r,i,o){r.pendingLanes|=i,i!==536870912&&(r.suspendedLanes=0,r.pingedLanes=0),r=r.eventTimes,i=31-ke(i),r[i]=o}function Te(r,i){var o=r.pendingLanes&~i;r.pendingLanes=i,r.suspendedLanes=0,r.pingedLanes=0,r.expiredLanes&=i,r.mutableReadLanes&=i,r.entangledLanes&=i,i=r.entanglements;var h=r.eventTimes;for(r=r.expirationTimes;0<o;){var p=31-ke(o),y=1<<p;i[p]=0,h[p]=-1,r[p]=-1,o&=~y}}function Ae(r,i){var o=r.entangledLanes|=i;for(r=r.entanglements;o;){var h=31-ke(o),p=1<<h;p&i|r[h]&i&&(r[h]|=i),o&=~p}}var Le=0;function ot(r){return r&=-r,1<r?4<r?(r&268435455)!==0?16:536870912:4:1}var Rt,Vt,Ut,tr,rn,mt=!1,An=[],It=null,dn=null,nr=null,xs=new Map,dr=new Map,Fr=[],Bs="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ja(r,i){switch(r){case"focusin":case"focusout":It=null;break;case"dragenter":case"dragleave":dn=null;break;case"mouseover":case"mouseout":nr=null;break;case"pointerover":case"pointerout":xs.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":dr.delete(i.pointerId)}}function hr(r,i,o,h,p,y){return r===null||r.nativeEvent!==y?(r={blockedOn:i,domEventName:o,eventSystemFlags:h,nativeEvent:y,targetContainers:[p]},i!==null&&(i=el(i),i!==null&&Vt(i)),r):(r.eventSystemFlags|=h,i=r.targetContainers,p!==null&&i.indexOf(p)===-1&&i.push(p),r)}function vd(r,i,o,h,p){switch(i){case"focusin":return It=hr(It,r,i,o,h,p),!0;case"dragenter":return dn=hr(dn,r,i,o,h,p),!0;case"mouseover":return nr=hr(nr,r,i,o,h,p),!0;case"pointerover":var y=p.pointerId;return xs.set(y,hr(xs.get(y)||null,r,i,o,h,p)),!0;case"gotpointercapture":return y=p.pointerId,dr.set(y,hr(dr.get(y)||null,r,i,o,h,p)),!0}return!1}function ic(r){var i=la(r.target);if(i!==null){var o=_n(i);if(o!==null){if(i=o.tag,i===13){if(i=Mn(o),i!==null){r.blockedOn=i,rn(r.priority,function(){Ut(o)});return}}else if(i===3&&o.stateNode.current.memoizedState.isDehydrated){r.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}r.blockedOn=null}function $s(r){if(r.blockedOn!==null)return!1;for(var i=r.targetContainers;0<i.length;){var o=Da(r.domEventName,r.eventSystemFlags,i[0],r.nativeEvent);if(o===null){o=r.nativeEvent;var h=new o.constructor(o.type,o);cr=h,o.target.dispatchEvent(h),cr=null}else return i=el(o),i!==null&&Vt(i),r.blockedOn=o,!1;i.shift()}return!0}function sa(r,i,o){$s(r)&&o.delete(i)}function ac(){mt=!1,It!==null&&$s(It)&&(It=null),dn!==null&&$s(dn)&&(dn=null),nr!==null&&$s(nr)&&(nr=null),xs.forEach(sa),dr.forEach(sa)}function ns(r,i){r.blockedOn===i&&(r.blockedOn=null,mt||(mt=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,ac)))}function rs(r){function i(p){return ns(p,r)}if(0<An.length){ns(An[0],r);for(var o=1;o<An.length;o++){var h=An[o];h.blockedOn===r&&(h.blockedOn=null)}}for(It!==null&&ns(It,r),dn!==null&&ns(dn,r),nr!==null&&ns(nr,r),xs.forEach(i),dr.forEach(i),o=0;o<Fr.length;o++)h=Fr[o],h.blockedOn===r&&(h.blockedOn=null);for(;0<Fr.length&&(o=Fr[0],o.blockedOn===null);)ic(o),o.blockedOn===null&&Fr.shift()}var Ws=we.ReactCurrentBatchConfig,mi=!0;function zt(r,i,o,h){var p=Le,y=Ws.transition;Ws.transition=null;try{Le=1,Uo(r,i,o,h)}finally{Le=p,Ws.transition=y}}function _d(r,i,o,h){var p=Le,y=Ws.transition;Ws.transition=null;try{Le=4,Uo(r,i,o,h)}finally{Le=p,Ws.transition=y}}function Uo(r,i,o,h){if(mi){var p=Da(r,i,o,h);if(p===null)Nd(r,i,h,ia,o),ja(r,h);else if(vd(p,r,i,o,h))h.stopPropagation();else if(ja(r,h),i&4&&-1<Bs.indexOf(r)){for(;p!==null;){var y=el(p);if(y!==null&&Rt(y),y=Da(r,i,o,h),y===null&&Nd(r,i,h,ia,o),y===p)break;p=y}p!==null&&h.stopPropagation()}else Nd(r,i,h,null,o)}}var ia=null;function Da(r,i,o,h){if(ia=null,r=gs(h),r=la(r),r!==null)if(i=_n(r),i===null)r=null;else if(o=i.tag,o===13){if(r=Mn(i),r!==null)return r;r=null}else if(o===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;r=null}else i!==r&&(r=null);return ia=r,null}function zo(r){switch(r){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(E()){case G:return 1;case H:return 4;case V:case q:return 16;case ae:return 536870912;default:return 16}default:return 16}}var Pr=null,Va=null,fr=null;function Bo(){if(fr)return fr;var r,i=Va,o=i.length,h,p="value"in Pr?Pr.value:Pr.textContent,y=p.length;for(r=0;r<o&&i[r]===p[r];r++);var x=o-r;for(h=1;h<=x&&i[o-h]===p[y-h];h++);return fr=p.slice(r,1<h?1-h:void 0)}function La(r){var i=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&i===13&&(r=13)):r=i,r===10&&(r=13),32<=r||r===13?r:0}function Es(){return!0}function $o(){return!1}function kn(r){function i(o,h,p,y,x){this._reactName=o,this._targetInst=p,this.type=h,this.nativeEvent=y,this.target=x,this.currentTarget=null;for(var j in r)r.hasOwnProperty(j)&&(o=r[j],this[j]=o?o(y):y[j]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?Es:$o,this.isPropagationStopped=$o,this}return Pe(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=Es)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=Es)},persist:function(){},isPersistent:Es}),i}var ss={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Oa=kn(ss),Ts=Pe({},ss,{view:0,detail:0}),wd=kn(Ts),Ma,Gs,gi,aa=Pe({},Ts,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ss,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==gi&&(gi&&r.type==="mousemove"?(Ma=r.screenX-gi.screenX,Gs=r.screenY-gi.screenY):Gs=Ma=0,gi=r),Ma)},movementY:function(r){return"movementY"in r?r.movementY:Gs}}),Fa=kn(aa),Wo=Pe({},aa,{dataTransfer:0}),oc=kn(Wo),Ua=Pe({},Ts,{relatedTarget:0}),za=kn(Ua),lc=Pe({},ss,{animationName:0,elapsedTime:0,pseudoElement:0}),Hs=kn(lc),cc=Pe({},ss,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),uc=kn(cc),dc=Pe({},ss,{data:0}),Go=kn(dc),Ba={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},rr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},hc={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function fc(r){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(r):(r=hc[r])?!!i[r]:!1}function Ss(){return fc}var u=Pe({},Ts,{key:function(r){if(r.key){var i=Ba[r.key]||r.key;if(i!=="Unidentified")return i}return r.type==="keypress"?(r=La(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?rr[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ss,charCode:function(r){return r.type==="keypress"?La(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?La(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),g=kn(u),_=Pe({},aa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),C=kn(_),Q=Pe({},Ts,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ss}),re=kn(Q),Re=Pe({},ss,{propertyName:0,elapsedTime:0,pseudoElement:0}),Nt=kn(Re),hn=Pe({},aa,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),gt=kn(hn),wn=[9,13,27,32],sn=f&&"CompositionEvent"in window,Ur=null;f&&"documentMode"in document&&(Ur=document.documentMode);var Rr=f&&"TextEvent"in window&&!Ur,oa=f&&(!sn||Ur&&8<Ur&&11>=Ur),$a=" ",Up=!1;function zp(r,i){switch(r){case"keyup":return wn.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Bp(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var Wa=!1;function zw(r,i){switch(r){case"compositionend":return Bp(i);case"keypress":return i.which!==32?null:(Up=!0,$a);case"textInput":return r=i.data,r===$a&&Up?null:r;default:return null}}function Bw(r,i){if(Wa)return r==="compositionend"||!sn&&zp(r,i)?(r=Bo(),fr=Va=Pr=null,Wa=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return oa&&i.locale!=="ko"?null:i.data;default:return null}}var $w={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $p(r){var i=r&&r.nodeName&&r.nodeName.toLowerCase();return i==="input"?!!$w[r.type]:i==="textarea"}function Wp(r,i,o,h){Wt(h),i=vc(i,"onChange"),0<i.length&&(o=new Oa("onChange","change",null,o,h),r.push({event:o,listeners:i}))}var Ho=null,qo=null;function Ww(r){lm(r,0)}function pc(r){var i=Qa(r);if($e(i))return r}function Gw(r,i){if(r==="change")return i}var Gp=!1;if(f){var xd;if(f){var Ed="oninput"in document;if(!Ed){var Hp=document.createElement("div");Hp.setAttribute("oninput","return;"),Ed=typeof Hp.oninput=="function"}xd=Ed}else xd=!1;Gp=xd&&(!document.documentMode||9<document.documentMode)}function qp(){Ho&&(Ho.detachEvent("onpropertychange",Kp),qo=Ho=null)}function Kp(r){if(r.propertyName==="value"&&pc(qo)){var i=[];Wp(i,qo,r,gs(r)),vn(Ww,i)}}function Hw(r,i,o){r==="focusin"?(qp(),Ho=i,qo=o,Ho.attachEvent("onpropertychange",Kp)):r==="focusout"&&qp()}function qw(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return pc(qo)}function Kw(r,i){if(r==="click")return pc(i)}function Qw(r,i){if(r==="input"||r==="change")return pc(i)}function Yw(r,i){return r===i&&(r!==0||1/r===1/i)||r!==r&&i!==i}var is=typeof Object.is=="function"?Object.is:Yw;function Ko(r,i){if(is(r,i))return!0;if(typeof r!="object"||r===null||typeof i!="object"||i===null)return!1;var o=Object.keys(r),h=Object.keys(i);if(o.length!==h.length)return!1;for(h=0;h<o.length;h++){var p=o[h];if(!m.call(i,p)||!is(r[p],i[p]))return!1}return!0}function Qp(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function Yp(r,i){var o=Qp(r);r=0;for(var h;o;){if(o.nodeType===3){if(h=r+o.textContent.length,r<=i&&h>=i)return{node:o,offset:i-r};r=h}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=Qp(o)}}function Jp(r,i){return r&&i?r===i?!0:r&&r.nodeType===3?!1:i&&i.nodeType===3?Jp(r,i.parentNode):"contains"in r?r.contains(i):r.compareDocumentPosition?!!(r.compareDocumentPosition(i)&16):!1:!1}function Xp(){for(var r=window,i=Ve();i instanceof r.HTMLIFrameElement;){try{var o=typeof i.contentWindow.location.href=="string"}catch{o=!1}if(o)r=i.contentWindow;else break;i=Ve(r.document)}return i}function Td(r){var i=r&&r.nodeName&&r.nodeName.toLowerCase();return i&&(i==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||i==="textarea"||r.contentEditable==="true")}function Jw(r){var i=Xp(),o=r.focusedElem,h=r.selectionRange;if(i!==o&&o&&o.ownerDocument&&Jp(o.ownerDocument.documentElement,o)){if(h!==null&&Td(o)){if(i=h.start,r=h.end,r===void 0&&(r=i),"selectionStart"in o)o.selectionStart=i,o.selectionEnd=Math.min(r,o.value.length);else if(r=(i=o.ownerDocument||document)&&i.defaultView||window,r.getSelection){r=r.getSelection();var p=o.textContent.length,y=Math.min(h.start,p);h=h.end===void 0?y:Math.min(h.end,p),!r.extend&&y>h&&(p=h,h=y,y=p),p=Yp(o,y);var x=Yp(o,h);p&&x&&(r.rangeCount!==1||r.anchorNode!==p.node||r.anchorOffset!==p.offset||r.focusNode!==x.node||r.focusOffset!==x.offset)&&(i=i.createRange(),i.setStart(p.node,p.offset),r.removeAllRanges(),y>h?(r.addRange(i),r.extend(x.node,x.offset)):(i.setEnd(x.node,x.offset),r.addRange(i)))}}for(i=[],r=o;r=r.parentNode;)r.nodeType===1&&i.push({element:r,left:r.scrollLeft,top:r.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<i.length;o++)r=i[o],r.element.scrollLeft=r.left,r.element.scrollTop=r.top}}var Xw=f&&"documentMode"in document&&11>=document.documentMode,Ga=null,Sd=null,Qo=null,Cd=!1;function Zp(r,i,o){var h=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Cd||Ga==null||Ga!==Ve(h)||(h=Ga,"selectionStart"in h&&Td(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),Qo&&Ko(Qo,h)||(Qo=h,h=vc(Sd,"onSelect"),0<h.length&&(i=new Oa("onSelect","select",null,i,o),r.push({event:i,listeners:h}),i.target=Ga)))}function mc(r,i){var o={};return o[r.toLowerCase()]=i.toLowerCase(),o["Webkit"+r]="webkit"+i,o["Moz"+r]="moz"+i,o}var Ha={animationend:mc("Animation","AnimationEnd"),animationiteration:mc("Animation","AnimationIteration"),animationstart:mc("Animation","AnimationStart"),transitionend:mc("Transition","TransitionEnd")},Id={},em={};f&&(em=document.createElement("div").style,"AnimationEvent"in window||(delete Ha.animationend.animation,delete Ha.animationiteration.animation,delete Ha.animationstart.animation),"TransitionEvent"in window||delete Ha.transitionend.transition);function gc(r){if(Id[r])return Id[r];if(!Ha[r])return r;var i=Ha[r],o;for(o in i)if(i.hasOwnProperty(o)&&o in em)return Id[r]=i[o];return r}var tm=gc("animationend"),nm=gc("animationiteration"),rm=gc("animationstart"),sm=gc("transitionend"),im=new Map,am="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function yi(r,i){im.set(r,i),l(i,[r])}for(var bd=0;bd<am.length;bd++){var Pd=am[bd],Zw=Pd.toLowerCase(),ex=Pd[0].toUpperCase()+Pd.slice(1);yi(Zw,"on"+ex)}yi(tm,"onAnimationEnd"),yi(nm,"onAnimationIteration"),yi(rm,"onAnimationStart"),yi("dblclick","onDoubleClick"),yi("focusin","onFocus"),yi("focusout","onBlur"),yi(sm,"onTransitionEnd"),d("onMouseEnter",["mouseout","mouseover"]),d("onMouseLeave",["mouseout","mouseover"]),d("onPointerEnter",["pointerout","pointerover"]),d("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Yo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),tx=new Set("cancel close invalid load scroll toggle".split(" ").concat(Yo));function om(r,i,o){var h=r.type||"unknown-event";r.currentTarget=o,Us(h,i,void 0,r),r.currentTarget=null}function lm(r,i){i=(i&4)!==0;for(var o=0;o<r.length;o++){var h=r[o],p=h.event;h=h.listeners;e:{var y=void 0;if(i)for(var x=h.length-1;0<=x;x--){var j=h[x],U=j.instance,ee=j.currentTarget;if(j=j.listener,U!==y&&p.isPropagationStopped())break e;om(p,j,ee),y=U}else for(x=0;x<h.length;x++){if(j=h[x],U=j.instance,ee=j.currentTarget,j=j.listener,U!==y&&p.isPropagationStopped())break e;om(p,j,ee),y=U}}}if(Rn)throw r=Nn,Rn=!1,Nn=null,r}function Lt(r,i){var o=i[Ld];o===void 0&&(o=i[Ld]=new Set);var h=r+"__bubble";o.has(h)||(cm(i,r,2,!1),o.add(h))}function Rd(r,i,o){var h=0;i&&(h|=4),cm(o,r,h,i)}var yc="_reactListening"+Math.random().toString(36).slice(2);function Jo(r){if(!r[yc]){r[yc]=!0,s.forEach(function(o){o!=="selectionchange"&&(tx.has(o)||Rd(o,!1,r),Rd(o,!0,r))});var i=r.nodeType===9?r:r.ownerDocument;i===null||i[yc]||(i[yc]=!0,Rd("selectionchange",!1,i))}}function cm(r,i,o,h){switch(zo(i)){case 1:var p=zt;break;case 4:p=_d;break;default:p=Uo}o=p.bind(null,i,o,r),p=void 0,!Jr||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(p=!0),h?p!==void 0?r.addEventListener(i,o,{capture:!0,passive:p}):r.addEventListener(i,o,!0):p!==void 0?r.addEventListener(i,o,{passive:p}):r.addEventListener(i,o,!1)}function Nd(r,i,o,h,p){var y=h;if((i&1)===0&&(i&2)===0&&h!==null)e:for(;;){if(h===null)return;var x=h.tag;if(x===3||x===4){var j=h.stateNode.containerInfo;if(j===p||j.nodeType===8&&j.parentNode===p)break;if(x===4)for(x=h.return;x!==null;){var U=x.tag;if((U===3||U===4)&&(U=x.stateNode.containerInfo,U===p||U.nodeType===8&&U.parentNode===p))return;x=x.return}for(;j!==null;){if(x=la(j),x===null)return;if(U=x.tag,U===5||U===6){h=y=x;continue e}j=j.parentNode}}h=h.return}vn(function(){var ee=y,pe=gs(o),ge=[];e:{var fe=im.get(r);if(fe!==void 0){var Oe=Oa,ze=r;switch(r){case"keypress":if(La(o)===0)break e;case"keydown":case"keyup":Oe=g;break;case"focusin":ze="focus",Oe=za;break;case"focusout":ze="blur",Oe=za;break;case"beforeblur":case"afterblur":Oe=za;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Oe=Fa;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Oe=oc;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Oe=re;break;case tm:case nm:case rm:Oe=Hs;break;case sm:Oe=Nt;break;case"scroll":Oe=wd;break;case"wheel":Oe=gt;break;case"copy":case"cut":case"paste":Oe=uc;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Oe=C}var We=(i&4)!==0,Xt=!We&&r==="scroll",Y=We?fe!==null?fe+"Capture":null:fe;We=[];for(var W=ee,Z;W!==null;){Z=W;var Ce=Z.stateNode;if(Z.tag===5&&Ce!==null&&(Z=Ce,Y!==null&&(Ce=At(W,Y),Ce!=null&&We.push(Xo(W,Ce,Z)))),Xt)break;W=W.return}0<We.length&&(fe=new Oe(fe,ze,null,o,pe),ge.push({event:fe,listeners:We}))}}if((i&7)===0){e:{if(fe=r==="mouseover"||r==="pointerover",Oe=r==="mouseout"||r==="pointerout",fe&&o!==cr&&(ze=o.relatedTarget||o.fromElement)&&(la(ze)||ze[qs]))break e;if((Oe||fe)&&(fe=pe.window===pe?pe:(fe=pe.ownerDocument)?fe.defaultView||fe.parentWindow:window,Oe?(ze=o.relatedTarget||o.toElement,Oe=ee,ze=ze?la(ze):null,ze!==null&&(Xt=_n(ze),ze!==Xt||ze.tag!==5&&ze.tag!==6)&&(ze=null)):(Oe=null,ze=ee),Oe!==ze)){if(We=Fa,Ce="onMouseLeave",Y="onMouseEnter",W="mouse",(r==="pointerout"||r==="pointerover")&&(We=C,Ce="onPointerLeave",Y="onPointerEnter",W="pointer"),Xt=Oe==null?fe:Qa(Oe),Z=ze==null?fe:Qa(ze),fe=new We(Ce,W+"leave",Oe,o,pe),fe.target=Xt,fe.relatedTarget=Z,Ce=null,la(pe)===ee&&(We=new We(Y,W+"enter",ze,o,pe),We.target=Z,We.relatedTarget=Xt,Ce=We),Xt=Ce,Oe&&ze)t:{for(We=Oe,Y=ze,W=0,Z=We;Z;Z=qa(Z))W++;for(Z=0,Ce=Y;Ce;Ce=qa(Ce))Z++;for(;0<W-Z;)We=qa(We),W--;for(;0<Z-W;)Y=qa(Y),Z--;for(;W--;){if(We===Y||Y!==null&&We===Y.alternate)break t;We=qa(We),Y=qa(Y)}We=null}else We=null;Oe!==null&&um(ge,fe,Oe,We,!1),ze!==null&&Xt!==null&&um(ge,Xt,ze,We,!0)}}e:{if(fe=ee?Qa(ee):window,Oe=fe.nodeName&&fe.nodeName.toLowerCase(),Oe==="select"||Oe==="input"&&fe.type==="file")var qe=Gw;else if($p(fe))if(Gp)qe=Qw;else{qe=qw;var Ye=Hw}else(Oe=fe.nodeName)&&Oe.toLowerCase()==="input"&&(fe.type==="checkbox"||fe.type==="radio")&&(qe=Kw);if(qe&&(qe=qe(r,ee))){Wp(ge,qe,o,pe);break e}Ye&&Ye(r,fe,ee),r==="focusout"&&(Ye=fe._wrapperState)&&Ye.controlled&&fe.type==="number"&&$t(fe,"number",fe.value)}switch(Ye=ee?Qa(ee):window,r){case"focusin":($p(Ye)||Ye.contentEditable==="true")&&(Ga=Ye,Sd=ee,Qo=null);break;case"focusout":Qo=Sd=Ga=null;break;case"mousedown":Cd=!0;break;case"contextmenu":case"mouseup":case"dragend":Cd=!1,Zp(ge,o,pe);break;case"selectionchange":if(Xw)break;case"keydown":case"keyup":Zp(ge,o,pe)}var Je;if(sn)e:{switch(r){case"compositionstart":var tt="onCompositionStart";break e;case"compositionend":tt="onCompositionEnd";break e;case"compositionupdate":tt="onCompositionUpdate";break e}tt=void 0}else Wa?zp(r,o)&&(tt="onCompositionEnd"):r==="keydown"&&o.keyCode===229&&(tt="onCompositionStart");tt&&(oa&&o.locale!=="ko"&&(Wa||tt!=="onCompositionStart"?tt==="onCompositionEnd"&&Wa&&(Je=Bo()):(Pr=pe,Va="value"in Pr?Pr.value:Pr.textContent,Wa=!0)),Ye=vc(ee,tt),0<Ye.length&&(tt=new Go(tt,r,null,o,pe),ge.push({event:tt,listeners:Ye}),Je?tt.data=Je:(Je=Bp(o),Je!==null&&(tt.data=Je)))),(Je=Rr?zw(r,o):Bw(r,o))&&(ee=vc(ee,"onBeforeInput"),0<ee.length&&(pe=new Go("onBeforeInput","beforeinput",null,o,pe),ge.push({event:pe,listeners:ee}),pe.data=Je))}lm(ge,i)})}function Xo(r,i,o){return{instance:r,listener:i,currentTarget:o}}function vc(r,i){for(var o=i+"Capture",h=[];r!==null;){var p=r,y=p.stateNode;p.tag===5&&y!==null&&(p=y,y=At(r,o),y!=null&&h.unshift(Xo(r,y,p)),y=At(r,i),y!=null&&h.push(Xo(r,y,p))),r=r.return}return h}function qa(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5);return r||null}function um(r,i,o,h,p){for(var y=i._reactName,x=[];o!==null&&o!==h;){var j=o,U=j.alternate,ee=j.stateNode;if(U!==null&&U===h)break;j.tag===5&&ee!==null&&(j=ee,p?(U=At(o,y),U!=null&&x.unshift(Xo(o,U,j))):p||(U=At(o,y),U!=null&&x.push(Xo(o,U,j)))),o=o.return}x.length!==0&&r.push({event:i,listeners:x})}var nx=/\r\n?/g,rx=/\u0000|\uFFFD/g;function dm(r){return(typeof r=="string"?r:""+r).replace(nx,`
`).replace(rx,"")}function _c(r,i,o){if(i=dm(i),dm(r)!==i&&o)throw Error(t(425))}function wc(){}var Ad=null,kd=null;function jd(r,i){return r==="textarea"||r==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Dd=typeof setTimeout=="function"?setTimeout:void 0,sx=typeof clearTimeout=="function"?clearTimeout:void 0,hm=typeof Promise=="function"?Promise:void 0,ix=typeof queueMicrotask=="function"?queueMicrotask:typeof hm<"u"?function(r){return hm.resolve(null).then(r).catch(ax)}:Dd;function ax(r){setTimeout(function(){throw r})}function Vd(r,i){var o=i,h=0;do{var p=o.nextSibling;if(r.removeChild(o),p&&p.nodeType===8)if(o=p.data,o==="/$"){if(h===0){r.removeChild(p),rs(i);return}h--}else o!=="$"&&o!=="$?"&&o!=="$!"||h++;o=p}while(o);rs(i)}function vi(r){for(;r!=null;r=r.nextSibling){var i=r.nodeType;if(i===1||i===3)break;if(i===8){if(i=r.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return r}function fm(r){r=r.previousSibling;for(var i=0;r;){if(r.nodeType===8){var o=r.data;if(o==="$"||o==="$!"||o==="$?"){if(i===0)return r;i--}else o==="/$"&&i++}r=r.previousSibling}return null}var Ka=Math.random().toString(36).slice(2),Cs="__reactFiber$"+Ka,Zo="__reactProps$"+Ka,qs="__reactContainer$"+Ka,Ld="__reactEvents$"+Ka,ox="__reactListeners$"+Ka,lx="__reactHandles$"+Ka;function la(r){var i=r[Cs];if(i)return i;for(var o=r.parentNode;o;){if(i=o[qs]||o[Cs]){if(o=i.alternate,i.child!==null||o!==null&&o.child!==null)for(r=fm(r);r!==null;){if(o=r[Cs])return o;r=fm(r)}return i}r=o,o=r.parentNode}return null}function el(r){return r=r[Cs]||r[qs],!r||r.tag!==5&&r.tag!==6&&r.tag!==13&&r.tag!==3?null:r}function Qa(r){if(r.tag===5||r.tag===6)return r.stateNode;throw Error(t(33))}function xc(r){return r[Zo]||null}var Od=[],Ya=-1;function _i(r){return{current:r}}function Ot(r){0>Ya||(r.current=Od[Ya],Od[Ya]=null,Ya--)}function jt(r,i){Ya++,Od[Ya]=r.current,r.current=i}var wi={},Un=_i(wi),pr=_i(!1),ca=wi;function Ja(r,i){var o=r.type.contextTypes;if(!o)return wi;var h=r.stateNode;if(h&&h.__reactInternalMemoizedUnmaskedChildContext===i)return h.__reactInternalMemoizedMaskedChildContext;var p={},y;for(y in o)p[y]=i[y];return h&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=i,r.__reactInternalMemoizedMaskedChildContext=p),p}function mr(r){return r=r.childContextTypes,r!=null}function Ec(){Ot(pr),Ot(Un)}function pm(r,i,o){if(Un.current!==wi)throw Error(t(168));jt(Un,i),jt(pr,o)}function mm(r,i,o){var h=r.stateNode;if(i=i.childContextTypes,typeof h.getChildContext!="function")return o;h=h.getChildContext();for(var p in h)if(!(p in i))throw Error(t(108,Me(r)||"Unknown",p));return Pe({},o,h)}function Tc(r){return r=(r=r.stateNode)&&r.__reactInternalMemoizedMergedChildContext||wi,ca=Un.current,jt(Un,r),jt(pr,pr.current),!0}function gm(r,i,o){var h=r.stateNode;if(!h)throw Error(t(169));o?(r=mm(r,i,ca),h.__reactInternalMemoizedMergedChildContext=r,Ot(pr),Ot(Un),jt(Un,r)):Ot(pr),jt(pr,o)}var Ks=null,Sc=!1,Md=!1;function ym(r){Ks===null?Ks=[r]:Ks.push(r)}function cx(r){Sc=!0,ym(r)}function xi(){if(!Md&&Ks!==null){Md=!0;var r=0,i=Le;try{var o=Ks;for(Le=1;r<o.length;r++){var h=o[r];do h=h(!0);while(h!==null)}Ks=null,Sc=!1}catch(p){throw Ks!==null&&(Ks=Ks.slice(r+1)),ws(G,xi),p}finally{Le=i,Md=!1}}return null}var Xa=[],Za=0,Cc=null,Ic=0,zr=[],Br=0,ua=null,Qs=1,Ys="";function da(r,i){Xa[Za++]=Ic,Xa[Za++]=Cc,Cc=r,Ic=i}function vm(r,i,o){zr[Br++]=Qs,zr[Br++]=Ys,zr[Br++]=ua,ua=r;var h=Qs;r=Ys;var p=32-ke(h)-1;h&=~(1<<p),o+=1;var y=32-ke(i)+p;if(30<y){var x=p-p%5;y=(h&(1<<x)-1).toString(32),h>>=x,p-=x,Qs=1<<32-ke(i)+p|o<<p|h,Ys=y+r}else Qs=1<<y|o<<p|h,Ys=r}function Fd(r){r.return!==null&&(da(r,1),vm(r,1,0))}function Ud(r){for(;r===Cc;)Cc=Xa[--Za],Xa[Za]=null,Ic=Xa[--Za],Xa[Za]=null;for(;r===ua;)ua=zr[--Br],zr[Br]=null,Ys=zr[--Br],zr[Br]=null,Qs=zr[--Br],zr[Br]=null}var Nr=null,Ar=null,Bt=!1,as=null;function _m(r,i){var o=Hr(5,null,null,0);o.elementType="DELETED",o.stateNode=i,o.return=r,i=r.deletions,i===null?(r.deletions=[o],r.flags|=16):i.push(o)}function wm(r,i){switch(r.tag){case 5:var o=r.type;return i=i.nodeType!==1||o.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(r.stateNode=i,Nr=r,Ar=vi(i.firstChild),!0):!1;case 6:return i=r.pendingProps===""||i.nodeType!==3?null:i,i!==null?(r.stateNode=i,Nr=r,Ar=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(o=ua!==null?{id:Qs,overflow:Ys}:null,r.memoizedState={dehydrated:i,treeContext:o,retryLane:1073741824},o=Hr(18,null,null,0),o.stateNode=i,o.return=r,r.child=o,Nr=r,Ar=null,!0):!1;default:return!1}}function zd(r){return(r.mode&1)!==0&&(r.flags&128)===0}function Bd(r){if(Bt){var i=Ar;if(i){var o=i;if(!wm(r,i)){if(zd(r))throw Error(t(418));i=vi(o.nextSibling);var h=Nr;i&&wm(r,i)?_m(h,o):(r.flags=r.flags&-4097|2,Bt=!1,Nr=r)}}else{if(zd(r))throw Error(t(418));r.flags=r.flags&-4097|2,Bt=!1,Nr=r}}}function xm(r){for(r=r.return;r!==null&&r.tag!==5&&r.tag!==3&&r.tag!==13;)r=r.return;Nr=r}function bc(r){if(r!==Nr)return!1;if(!Bt)return xm(r),Bt=!0,!1;var i;if((i=r.tag!==3)&&!(i=r.tag!==5)&&(i=r.type,i=i!=="head"&&i!=="body"&&!jd(r.type,r.memoizedProps)),i&&(i=Ar)){if(zd(r))throw Em(),Error(t(418));for(;i;)_m(r,i),i=vi(i.nextSibling)}if(xm(r),r.tag===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(t(317));e:{for(r=r.nextSibling,i=0;r;){if(r.nodeType===8){var o=r.data;if(o==="/$"){if(i===0){Ar=vi(r.nextSibling);break e}i--}else o!=="$"&&o!=="$!"&&o!=="$?"||i++}r=r.nextSibling}Ar=null}}else Ar=Nr?vi(r.stateNode.nextSibling):null;return!0}function Em(){for(var r=Ar;r;)r=vi(r.nextSibling)}function eo(){Ar=Nr=null,Bt=!1}function $d(r){as===null?as=[r]:as.push(r)}var ux=we.ReactCurrentBatchConfig;function tl(r,i,o){if(r=o.ref,r!==null&&typeof r!="function"&&typeof r!="object"){if(o._owner){if(o=o._owner,o){if(o.tag!==1)throw Error(t(309));var h=o.stateNode}if(!h)throw Error(t(147,r));var p=h,y=""+r;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===y?i.ref:(i=function(x){var j=p.refs;x===null?delete j[y]:j[y]=x},i._stringRef=y,i)}if(typeof r!="string")throw Error(t(284));if(!o._owner)throw Error(t(290,r))}return r}function Pc(r,i){throw r=Object.prototype.toString.call(i),Error(t(31,r==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":r))}function Tm(r){var i=r._init;return i(r._payload)}function Sm(r){function i(Y,W){if(r){var Z=Y.deletions;Z===null?(Y.deletions=[W],Y.flags|=16):Z.push(W)}}function o(Y,W){if(!r)return null;for(;W!==null;)i(Y,W),W=W.sibling;return null}function h(Y,W){for(Y=new Map;W!==null;)W.key!==null?Y.set(W.key,W):Y.set(W.index,W),W=W.sibling;return Y}function p(Y,W){return Y=Ri(Y,W),Y.index=0,Y.sibling=null,Y}function y(Y,W,Z){return Y.index=Z,r?(Z=Y.alternate,Z!==null?(Z=Z.index,Z<W?(Y.flags|=2,W):Z):(Y.flags|=2,W)):(Y.flags|=1048576,W)}function x(Y){return r&&Y.alternate===null&&(Y.flags|=2),Y}function j(Y,W,Z,Ce){return W===null||W.tag!==6?(W=Dh(Z,Y.mode,Ce),W.return=Y,W):(W=p(W,Z),W.return=Y,W)}function U(Y,W,Z,Ce){var qe=Z.type;return qe===A?pe(Y,W,Z.props.children,Ce,Z.key):W!==null&&(W.elementType===qe||typeof qe=="object"&&qe!==null&&qe.$$typeof===ut&&Tm(qe)===W.type)?(Ce=p(W,Z.props),Ce.ref=tl(Y,W,Z),Ce.return=Y,Ce):(Ce=Xc(Z.type,Z.key,Z.props,null,Y.mode,Ce),Ce.ref=tl(Y,W,Z),Ce.return=Y,Ce)}function ee(Y,W,Z,Ce){return W===null||W.tag!==4||W.stateNode.containerInfo!==Z.containerInfo||W.stateNode.implementation!==Z.implementation?(W=Vh(Z,Y.mode,Ce),W.return=Y,W):(W=p(W,Z.children||[]),W.return=Y,W)}function pe(Y,W,Z,Ce,qe){return W===null||W.tag!==7?(W=_a(Z,Y.mode,Ce,qe),W.return=Y,W):(W=p(W,Z),W.return=Y,W)}function ge(Y,W,Z){if(typeof W=="string"&&W!==""||typeof W=="number")return W=Dh(""+W,Y.mode,Z),W.return=Y,W;if(typeof W=="object"&&W!==null){switch(W.$$typeof){case le:return Z=Xc(W.type,W.key,W.props,null,Y.mode,Z),Z.ref=tl(Y,null,W),Z.return=Y,Z;case Ie:return W=Vh(W,Y.mode,Z),W.return=Y,W;case ut:var Ce=W._init;return ge(Y,Ce(W._payload),Z)}if(cn(W)||je(W))return W=_a(W,Y.mode,Z,null),W.return=Y,W;Pc(Y,W)}return null}function fe(Y,W,Z,Ce){var qe=W!==null?W.key:null;if(typeof Z=="string"&&Z!==""||typeof Z=="number")return qe!==null?null:j(Y,W,""+Z,Ce);if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case le:return Z.key===qe?U(Y,W,Z,Ce):null;case Ie:return Z.key===qe?ee(Y,W,Z,Ce):null;case ut:return qe=Z._init,fe(Y,W,qe(Z._payload),Ce)}if(cn(Z)||je(Z))return qe!==null?null:pe(Y,W,Z,Ce,null);Pc(Y,Z)}return null}function Oe(Y,W,Z,Ce,qe){if(typeof Ce=="string"&&Ce!==""||typeof Ce=="number")return Y=Y.get(Z)||null,j(W,Y,""+Ce,qe);if(typeof Ce=="object"&&Ce!==null){switch(Ce.$$typeof){case le:return Y=Y.get(Ce.key===null?Z:Ce.key)||null,U(W,Y,Ce,qe);case Ie:return Y=Y.get(Ce.key===null?Z:Ce.key)||null,ee(W,Y,Ce,qe);case ut:var Ye=Ce._init;return Oe(Y,W,Z,Ye(Ce._payload),qe)}if(cn(Ce)||je(Ce))return Y=Y.get(Z)||null,pe(W,Y,Ce,qe,null);Pc(W,Ce)}return null}function ze(Y,W,Z,Ce){for(var qe=null,Ye=null,Je=W,tt=W=0,Tn=null;Je!==null&&tt<Z.length;tt++){Je.index>tt?(Tn=Je,Je=null):Tn=Je.sibling;var wt=fe(Y,Je,Z[tt],Ce);if(wt===null){Je===null&&(Je=Tn);break}r&&Je&&wt.alternate===null&&i(Y,Je),W=y(wt,W,tt),Ye===null?qe=wt:Ye.sibling=wt,Ye=wt,Je=Tn}if(tt===Z.length)return o(Y,Je),Bt&&da(Y,tt),qe;if(Je===null){for(;tt<Z.length;tt++)Je=ge(Y,Z[tt],Ce),Je!==null&&(W=y(Je,W,tt),Ye===null?qe=Je:Ye.sibling=Je,Ye=Je);return Bt&&da(Y,tt),qe}for(Je=h(Y,Je);tt<Z.length;tt++)Tn=Oe(Je,Y,tt,Z[tt],Ce),Tn!==null&&(r&&Tn.alternate!==null&&Je.delete(Tn.key===null?tt:Tn.key),W=y(Tn,W,tt),Ye===null?qe=Tn:Ye.sibling=Tn,Ye=Tn);return r&&Je.forEach(function(Ni){return i(Y,Ni)}),Bt&&da(Y,tt),qe}function We(Y,W,Z,Ce){var qe=je(Z);if(typeof qe!="function")throw Error(t(150));if(Z=qe.call(Z),Z==null)throw Error(t(151));for(var Ye=qe=null,Je=W,tt=W=0,Tn=null,wt=Z.next();Je!==null&&!wt.done;tt++,wt=Z.next()){Je.index>tt?(Tn=Je,Je=null):Tn=Je.sibling;var Ni=fe(Y,Je,wt.value,Ce);if(Ni===null){Je===null&&(Je=Tn);break}r&&Je&&Ni.alternate===null&&i(Y,Je),W=y(Ni,W,tt),Ye===null?qe=Ni:Ye.sibling=Ni,Ye=Ni,Je=Tn}if(wt.done)return o(Y,Je),Bt&&da(Y,tt),qe;if(Je===null){for(;!wt.done;tt++,wt=Z.next())wt=ge(Y,wt.value,Ce),wt!==null&&(W=y(wt,W,tt),Ye===null?qe=wt:Ye.sibling=wt,Ye=wt);return Bt&&da(Y,tt),qe}for(Je=h(Y,Je);!wt.done;tt++,wt=Z.next())wt=Oe(Je,Y,tt,wt.value,Ce),wt!==null&&(r&&wt.alternate!==null&&Je.delete(wt.key===null?tt:wt.key),W=y(wt,W,tt),Ye===null?qe=wt:Ye.sibling=wt,Ye=wt);return r&&Je.forEach(function($x){return i(Y,$x)}),Bt&&da(Y,tt),qe}function Xt(Y,W,Z,Ce){if(typeof Z=="object"&&Z!==null&&Z.type===A&&Z.key===null&&(Z=Z.props.children),typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case le:e:{for(var qe=Z.key,Ye=W;Ye!==null;){if(Ye.key===qe){if(qe=Z.type,qe===A){if(Ye.tag===7){o(Y,Ye.sibling),W=p(Ye,Z.props.children),W.return=Y,Y=W;break e}}else if(Ye.elementType===qe||typeof qe=="object"&&qe!==null&&qe.$$typeof===ut&&Tm(qe)===Ye.type){o(Y,Ye.sibling),W=p(Ye,Z.props),W.ref=tl(Y,Ye,Z),W.return=Y,Y=W;break e}o(Y,Ye);break}else i(Y,Ye);Ye=Ye.sibling}Z.type===A?(W=_a(Z.props.children,Y.mode,Ce,Z.key),W.return=Y,Y=W):(Ce=Xc(Z.type,Z.key,Z.props,null,Y.mode,Ce),Ce.ref=tl(Y,W,Z),Ce.return=Y,Y=Ce)}return x(Y);case Ie:e:{for(Ye=Z.key;W!==null;){if(W.key===Ye)if(W.tag===4&&W.stateNode.containerInfo===Z.containerInfo&&W.stateNode.implementation===Z.implementation){o(Y,W.sibling),W=p(W,Z.children||[]),W.return=Y,Y=W;break e}else{o(Y,W);break}else i(Y,W);W=W.sibling}W=Vh(Z,Y.mode,Ce),W.return=Y,Y=W}return x(Y);case ut:return Ye=Z._init,Xt(Y,W,Ye(Z._payload),Ce)}if(cn(Z))return ze(Y,W,Z,Ce);if(je(Z))return We(Y,W,Z,Ce);Pc(Y,Z)}return typeof Z=="string"&&Z!==""||typeof Z=="number"?(Z=""+Z,W!==null&&W.tag===6?(o(Y,W.sibling),W=p(W,Z),W.return=Y,Y=W):(o(Y,W),W=Dh(Z,Y.mode,Ce),W.return=Y,Y=W),x(Y)):o(Y,W)}return Xt}var to=Sm(!0),Cm=Sm(!1),Rc=_i(null),Nc=null,no=null,Wd=null;function Gd(){Wd=no=Nc=null}function Hd(r){var i=Rc.current;Ot(Rc),r._currentValue=i}function qd(r,i,o){for(;r!==null;){var h=r.alternate;if((r.childLanes&i)!==i?(r.childLanes|=i,h!==null&&(h.childLanes|=i)):h!==null&&(h.childLanes&i)!==i&&(h.childLanes|=i),r===o)break;r=r.return}}function ro(r,i){Nc=r,Wd=no=null,r=r.dependencies,r!==null&&r.firstContext!==null&&((r.lanes&i)!==0&&(gr=!0),r.firstContext=null)}function $r(r){var i=r._currentValue;if(Wd!==r)if(r={context:r,memoizedValue:i,next:null},no===null){if(Nc===null)throw Error(t(308));no=r,Nc.dependencies={lanes:0,firstContext:r}}else no=no.next=r;return i}var ha=null;function Kd(r){ha===null?ha=[r]:ha.push(r)}function Im(r,i,o,h){var p=i.interleaved;return p===null?(o.next=o,Kd(i)):(o.next=p.next,p.next=o),i.interleaved=o,Js(r,h)}function Js(r,i){r.lanes|=i;var o=r.alternate;for(o!==null&&(o.lanes|=i),o=r,r=r.return;r!==null;)r.childLanes|=i,o=r.alternate,o!==null&&(o.childLanes|=i),o=r,r=r.return;return o.tag===3?o.stateNode:null}var Ei=!1;function Qd(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function bm(r,i){r=r.updateQueue,i.updateQueue===r&&(i.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,effects:r.effects})}function Xs(r,i){return{eventTime:r,lane:i,tag:0,payload:null,callback:null,next:null}}function Ti(r,i,o){var h=r.updateQueue;if(h===null)return null;if(h=h.shared,(vt&2)!==0){var p=h.pending;return p===null?i.next=i:(i.next=p.next,p.next=i),h.pending=i,Js(r,o)}return p=h.interleaved,p===null?(i.next=i,Kd(h)):(i.next=p.next,p.next=i),h.interleaved=i,Js(r,o)}function Ac(r,i,o){if(i=i.updateQueue,i!==null&&(i=i.shared,(o&4194240)!==0)){var h=i.lanes;h&=r.pendingLanes,o|=h,i.lanes=o,Ae(r,o)}}function Pm(r,i){var o=r.updateQueue,h=r.alternate;if(h!==null&&(h=h.updateQueue,o===h)){var p=null,y=null;if(o=o.firstBaseUpdate,o!==null){do{var x={eventTime:o.eventTime,lane:o.lane,tag:o.tag,payload:o.payload,callback:o.callback,next:null};y===null?p=y=x:y=y.next=x,o=o.next}while(o!==null);y===null?p=y=i:y=y.next=i}else p=y=i;o={baseState:h.baseState,firstBaseUpdate:p,lastBaseUpdate:y,shared:h.shared,effects:h.effects},r.updateQueue=o;return}r=o.lastBaseUpdate,r===null?o.firstBaseUpdate=i:r.next=i,o.lastBaseUpdate=i}function kc(r,i,o,h){var p=r.updateQueue;Ei=!1;var y=p.firstBaseUpdate,x=p.lastBaseUpdate,j=p.shared.pending;if(j!==null){p.shared.pending=null;var U=j,ee=U.next;U.next=null,x===null?y=ee:x.next=ee,x=U;var pe=r.alternate;pe!==null&&(pe=pe.updateQueue,j=pe.lastBaseUpdate,j!==x&&(j===null?pe.firstBaseUpdate=ee:j.next=ee,pe.lastBaseUpdate=U))}if(y!==null){var ge=p.baseState;x=0,pe=ee=U=null,j=y;do{var fe=j.lane,Oe=j.eventTime;if((h&fe)===fe){pe!==null&&(pe=pe.next={eventTime:Oe,lane:0,tag:j.tag,payload:j.payload,callback:j.callback,next:null});e:{var ze=r,We=j;switch(fe=i,Oe=o,We.tag){case 1:if(ze=We.payload,typeof ze=="function"){ge=ze.call(Oe,ge,fe);break e}ge=ze;break e;case 3:ze.flags=ze.flags&-65537|128;case 0:if(ze=We.payload,fe=typeof ze=="function"?ze.call(Oe,ge,fe):ze,fe==null)break e;ge=Pe({},ge,fe);break e;case 2:Ei=!0}}j.callback!==null&&j.lane!==0&&(r.flags|=64,fe=p.effects,fe===null?p.effects=[j]:fe.push(j))}else Oe={eventTime:Oe,lane:fe,tag:j.tag,payload:j.payload,callback:j.callback,next:null},pe===null?(ee=pe=Oe,U=ge):pe=pe.next=Oe,x|=fe;if(j=j.next,j===null){if(j=p.shared.pending,j===null)break;fe=j,j=fe.next,fe.next=null,p.lastBaseUpdate=fe,p.shared.pending=null}}while(!0);if(pe===null&&(U=ge),p.baseState=U,p.firstBaseUpdate=ee,p.lastBaseUpdate=pe,i=p.shared.interleaved,i!==null){p=i;do x|=p.lane,p=p.next;while(p!==i)}else y===null&&(p.shared.lanes=0);ma|=x,r.lanes=x,r.memoizedState=ge}}function Rm(r,i,o){if(r=i.effects,i.effects=null,r!==null)for(i=0;i<r.length;i++){var h=r[i],p=h.callback;if(p!==null){if(h.callback=null,h=o,typeof p!="function")throw Error(t(191,p));p.call(h)}}}var nl={},Is=_i(nl),rl=_i(nl),sl=_i(nl);function fa(r){if(r===nl)throw Error(t(174));return r}function Yd(r,i){switch(jt(sl,i),jt(rl,r),jt(Is,nl),r=i.nodeType,r){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:Pt(null,"");break;default:r=r===8?i.parentNode:i,i=r.namespaceURI||null,r=r.tagName,i=Pt(i,r)}Ot(Is),jt(Is,i)}function so(){Ot(Is),Ot(rl),Ot(sl)}function Nm(r){fa(sl.current);var i=fa(Is.current),o=Pt(i,r.type);i!==o&&(jt(rl,r),jt(Is,o))}function Jd(r){rl.current===r&&(Ot(Is),Ot(rl))}var Ht=_i(0);function jc(r){for(var i=r;i!==null;){if(i.tag===13){var o=i.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||o.data==="$?"||o.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===r)break;for(;i.sibling===null;){if(i.return===null||i.return===r)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var Xd=[];function Zd(){for(var r=0;r<Xd.length;r++)Xd[r]._workInProgressVersionPrimary=null;Xd.length=0}var Dc=we.ReactCurrentDispatcher,eh=we.ReactCurrentBatchConfig,pa=0,qt=null,fn=null,xn=null,Vc=!1,il=!1,al=0,dx=0;function zn(){throw Error(t(321))}function th(r,i){if(i===null)return!1;for(var o=0;o<i.length&&o<r.length;o++)if(!is(r[o],i[o]))return!1;return!0}function nh(r,i,o,h,p,y){if(pa=y,qt=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,Dc.current=r===null||r.memoizedState===null?mx:gx,r=o(h,p),il){y=0;do{if(il=!1,al=0,25<=y)throw Error(t(301));y+=1,xn=fn=null,i.updateQueue=null,Dc.current=yx,r=o(h,p)}while(il)}if(Dc.current=Mc,i=fn!==null&&fn.next!==null,pa=0,xn=fn=qt=null,Vc=!1,i)throw Error(t(300));return r}function rh(){var r=al!==0;return al=0,r}function bs(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xn===null?qt.memoizedState=xn=r:xn=xn.next=r,xn}function Wr(){if(fn===null){var r=qt.alternate;r=r!==null?r.memoizedState:null}else r=fn.next;var i=xn===null?qt.memoizedState:xn.next;if(i!==null)xn=i,fn=r;else{if(r===null)throw Error(t(310));fn=r,r={memoizedState:fn.memoizedState,baseState:fn.baseState,baseQueue:fn.baseQueue,queue:fn.queue,next:null},xn===null?qt.memoizedState=xn=r:xn=xn.next=r}return xn}function ol(r,i){return typeof i=="function"?i(r):i}function sh(r){var i=Wr(),o=i.queue;if(o===null)throw Error(t(311));o.lastRenderedReducer=r;var h=fn,p=h.baseQueue,y=o.pending;if(y!==null){if(p!==null){var x=p.next;p.next=y.next,y.next=x}h.baseQueue=p=y,o.pending=null}if(p!==null){y=p.next,h=h.baseState;var j=x=null,U=null,ee=y;do{var pe=ee.lane;if((pa&pe)===pe)U!==null&&(U=U.next={lane:0,action:ee.action,hasEagerState:ee.hasEagerState,eagerState:ee.eagerState,next:null}),h=ee.hasEagerState?ee.eagerState:r(h,ee.action);else{var ge={lane:pe,action:ee.action,hasEagerState:ee.hasEagerState,eagerState:ee.eagerState,next:null};U===null?(j=U=ge,x=h):U=U.next=ge,qt.lanes|=pe,ma|=pe}ee=ee.next}while(ee!==null&&ee!==y);U===null?x=h:U.next=j,is(h,i.memoizedState)||(gr=!0),i.memoizedState=h,i.baseState=x,i.baseQueue=U,o.lastRenderedState=h}if(r=o.interleaved,r!==null){p=r;do y=p.lane,qt.lanes|=y,ma|=y,p=p.next;while(p!==r)}else p===null&&(o.lanes=0);return[i.memoizedState,o.dispatch]}function ih(r){var i=Wr(),o=i.queue;if(o===null)throw Error(t(311));o.lastRenderedReducer=r;var h=o.dispatch,p=o.pending,y=i.memoizedState;if(p!==null){o.pending=null;var x=p=p.next;do y=r(y,x.action),x=x.next;while(x!==p);is(y,i.memoizedState)||(gr=!0),i.memoizedState=y,i.baseQueue===null&&(i.baseState=y),o.lastRenderedState=y}return[y,h]}function Am(){}function km(r,i){var o=qt,h=Wr(),p=i(),y=!is(h.memoizedState,p);if(y&&(h.memoizedState=p,gr=!0),h=h.queue,ah(Vm.bind(null,o,h,r),[r]),h.getSnapshot!==i||y||xn!==null&&xn.memoizedState.tag&1){if(o.flags|=2048,ll(9,Dm.bind(null,o,h,p,i),void 0,null),En===null)throw Error(t(349));(pa&30)!==0||jm(o,i,p)}return p}function jm(r,i,o){r.flags|=16384,r={getSnapshot:i,value:o},i=qt.updateQueue,i===null?(i={lastEffect:null,stores:null},qt.updateQueue=i,i.stores=[r]):(o=i.stores,o===null?i.stores=[r]:o.push(r))}function Dm(r,i,o,h){i.value=o,i.getSnapshot=h,Lm(i)&&Om(r)}function Vm(r,i,o){return o(function(){Lm(i)&&Om(r)})}function Lm(r){var i=r.getSnapshot;r=r.value;try{var o=i();return!is(r,o)}catch{return!0}}function Om(r){var i=Js(r,1);i!==null&&us(i,r,1,-1)}function Mm(r){var i=bs();return typeof r=="function"&&(r=r()),i.memoizedState=i.baseState=r,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ol,lastRenderedState:r},i.queue=r,r=r.dispatch=px.bind(null,qt,r),[i.memoizedState,r]}function ll(r,i,o,h){return r={tag:r,create:i,destroy:o,deps:h,next:null},i=qt.updateQueue,i===null?(i={lastEffect:null,stores:null},qt.updateQueue=i,i.lastEffect=r.next=r):(o=i.lastEffect,o===null?i.lastEffect=r.next=r:(h=o.next,o.next=r,r.next=h,i.lastEffect=r)),r}function Fm(){return Wr().memoizedState}function Lc(r,i,o,h){var p=bs();qt.flags|=r,p.memoizedState=ll(1|i,o,void 0,h===void 0?null:h)}function Oc(r,i,o,h){var p=Wr();h=h===void 0?null:h;var y=void 0;if(fn!==null){var x=fn.memoizedState;if(y=x.destroy,h!==null&&th(h,x.deps)){p.memoizedState=ll(i,o,y,h);return}}qt.flags|=r,p.memoizedState=ll(1|i,o,y,h)}function Um(r,i){return Lc(8390656,8,r,i)}function ah(r,i){return Oc(2048,8,r,i)}function zm(r,i){return Oc(4,2,r,i)}function Bm(r,i){return Oc(4,4,r,i)}function $m(r,i){if(typeof i=="function")return r=r(),i(r),function(){i(null)};if(i!=null)return r=r(),i.current=r,function(){i.current=null}}function Wm(r,i,o){return o=o!=null?o.concat([r]):null,Oc(4,4,$m.bind(null,i,r),o)}function oh(){}function Gm(r,i){var o=Wr();i=i===void 0?null:i;var h=o.memoizedState;return h!==null&&i!==null&&th(i,h[1])?h[0]:(o.memoizedState=[r,i],r)}function Hm(r,i){var o=Wr();i=i===void 0?null:i;var h=o.memoizedState;return h!==null&&i!==null&&th(i,h[1])?h[0]:(r=r(),o.memoizedState=[r,i],r)}function qm(r,i,o){return(pa&21)===0?(r.baseState&&(r.baseState=!1,gr=!0),r.memoizedState=o):(is(o,i)||(o=$(),qt.lanes|=o,ma|=o,r.baseState=!0),i)}function hx(r,i){var o=Le;Le=o!==0&&4>o?o:4,r(!0);var h=eh.transition;eh.transition={};try{r(!1),i()}finally{Le=o,eh.transition=h}}function Km(){return Wr().memoizedState}function fx(r,i,o){var h=bi(r);if(o={lane:h,action:o,hasEagerState:!1,eagerState:null,next:null},Qm(r))Ym(i,o);else if(o=Im(r,i,o,h),o!==null){var p=ir();us(o,r,h,p),Jm(o,i,h)}}function px(r,i,o){var h=bi(r),p={lane:h,action:o,hasEagerState:!1,eagerState:null,next:null};if(Qm(r))Ym(i,p);else{var y=r.alternate;if(r.lanes===0&&(y===null||y.lanes===0)&&(y=i.lastRenderedReducer,y!==null))try{var x=i.lastRenderedState,j=y(x,o);if(p.hasEagerState=!0,p.eagerState=j,is(j,x)){var U=i.interleaved;U===null?(p.next=p,Kd(i)):(p.next=U.next,U.next=p),i.interleaved=p;return}}catch{}finally{}o=Im(r,i,p,h),o!==null&&(p=ir(),us(o,r,h,p),Jm(o,i,h))}}function Qm(r){var i=r.alternate;return r===qt||i!==null&&i===qt}function Ym(r,i){il=Vc=!0;var o=r.pending;o===null?i.next=i:(i.next=o.next,o.next=i),r.pending=i}function Jm(r,i,o){if((o&4194240)!==0){var h=i.lanes;h&=r.pendingLanes,o|=h,i.lanes=o,Ae(r,o)}}var Mc={readContext:$r,useCallback:zn,useContext:zn,useEffect:zn,useImperativeHandle:zn,useInsertionEffect:zn,useLayoutEffect:zn,useMemo:zn,useReducer:zn,useRef:zn,useState:zn,useDebugValue:zn,useDeferredValue:zn,useTransition:zn,useMutableSource:zn,useSyncExternalStore:zn,useId:zn,unstable_isNewReconciler:!1},mx={readContext:$r,useCallback:function(r,i){return bs().memoizedState=[r,i===void 0?null:i],r},useContext:$r,useEffect:Um,useImperativeHandle:function(r,i,o){return o=o!=null?o.concat([r]):null,Lc(4194308,4,$m.bind(null,i,r),o)},useLayoutEffect:function(r,i){return Lc(4194308,4,r,i)},useInsertionEffect:function(r,i){return Lc(4,2,r,i)},useMemo:function(r,i){var o=bs();return i=i===void 0?null:i,r=r(),o.memoizedState=[r,i],r},useReducer:function(r,i,o){var h=bs();return i=o!==void 0?o(i):i,h.memoizedState=h.baseState=i,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:i},h.queue=r,r=r.dispatch=fx.bind(null,qt,r),[h.memoizedState,r]},useRef:function(r){var i=bs();return r={current:r},i.memoizedState=r},useState:Mm,useDebugValue:oh,useDeferredValue:function(r){return bs().memoizedState=r},useTransition:function(){var r=Mm(!1),i=r[0];return r=hx.bind(null,r[1]),bs().memoizedState=r,[i,r]},useMutableSource:function(){},useSyncExternalStore:function(r,i,o){var h=qt,p=bs();if(Bt){if(o===void 0)throw Error(t(407));o=o()}else{if(o=i(),En===null)throw Error(t(349));(pa&30)!==0||jm(h,i,o)}p.memoizedState=o;var y={value:o,getSnapshot:i};return p.queue=y,Um(Vm.bind(null,h,y,r),[r]),h.flags|=2048,ll(9,Dm.bind(null,h,y,o,i),void 0,null),o},useId:function(){var r=bs(),i=En.identifierPrefix;if(Bt){var o=Ys,h=Qs;o=(h&~(1<<32-ke(h)-1)).toString(32)+o,i=":"+i+"R"+o,o=al++,0<o&&(i+="H"+o.toString(32)),i+=":"}else o=dx++,i=":"+i+"r"+o.toString(32)+":";return r.memoizedState=i},unstable_isNewReconciler:!1},gx={readContext:$r,useCallback:Gm,useContext:$r,useEffect:ah,useImperativeHandle:Wm,useInsertionEffect:zm,useLayoutEffect:Bm,useMemo:Hm,useReducer:sh,useRef:Fm,useState:function(){return sh(ol)},useDebugValue:oh,useDeferredValue:function(r){var i=Wr();return qm(i,fn.memoizedState,r)},useTransition:function(){var r=sh(ol)[0],i=Wr().memoizedState;return[r,i]},useMutableSource:Am,useSyncExternalStore:km,useId:Km,unstable_isNewReconciler:!1},yx={readContext:$r,useCallback:Gm,useContext:$r,useEffect:ah,useImperativeHandle:Wm,useInsertionEffect:zm,useLayoutEffect:Bm,useMemo:Hm,useReducer:ih,useRef:Fm,useState:function(){return ih(ol)},useDebugValue:oh,useDeferredValue:function(r){var i=Wr();return fn===null?i.memoizedState=r:qm(i,fn.memoizedState,r)},useTransition:function(){var r=ih(ol)[0],i=Wr().memoizedState;return[r,i]},useMutableSource:Am,useSyncExternalStore:km,useId:Km,unstable_isNewReconciler:!1};function os(r,i){if(r&&r.defaultProps){i=Pe({},i),r=r.defaultProps;for(var o in r)i[o]===void 0&&(i[o]=r[o]);return i}return i}function lh(r,i,o,h){i=r.memoizedState,o=o(h,i),o=o==null?i:Pe({},i,o),r.memoizedState=o,r.lanes===0&&(r.updateQueue.baseState=o)}var Fc={isMounted:function(r){return(r=r._reactInternals)?_n(r)===r:!1},enqueueSetState:function(r,i,o){r=r._reactInternals;var h=ir(),p=bi(r),y=Xs(h,p);y.payload=i,o!=null&&(y.callback=o),i=Ti(r,y,p),i!==null&&(us(i,r,p,h),Ac(i,r,p))},enqueueReplaceState:function(r,i,o){r=r._reactInternals;var h=ir(),p=bi(r),y=Xs(h,p);y.tag=1,y.payload=i,o!=null&&(y.callback=o),i=Ti(r,y,p),i!==null&&(us(i,r,p,h),Ac(i,r,p))},enqueueForceUpdate:function(r,i){r=r._reactInternals;var o=ir(),h=bi(r),p=Xs(o,h);p.tag=2,i!=null&&(p.callback=i),i=Ti(r,p,h),i!==null&&(us(i,r,h,o),Ac(i,r,h))}};function Xm(r,i,o,h,p,y,x){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(h,y,x):i.prototype&&i.prototype.isPureReactComponent?!Ko(o,h)||!Ko(p,y):!0}function Zm(r,i,o){var h=!1,p=wi,y=i.contextType;return typeof y=="object"&&y!==null?y=$r(y):(p=mr(i)?ca:Un.current,h=i.contextTypes,y=(h=h!=null)?Ja(r,p):wi),i=new i(o,y),r.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=Fc,r.stateNode=i,i._reactInternals=r,h&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=p,r.__reactInternalMemoizedMaskedChildContext=y),i}function eg(r,i,o,h){r=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(o,h),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(o,h),i.state!==r&&Fc.enqueueReplaceState(i,i.state,null)}function ch(r,i,o,h){var p=r.stateNode;p.props=o,p.state=r.memoizedState,p.refs={},Qd(r);var y=i.contextType;typeof y=="object"&&y!==null?p.context=$r(y):(y=mr(i)?ca:Un.current,p.context=Ja(r,y)),p.state=r.memoizedState,y=i.getDerivedStateFromProps,typeof y=="function"&&(lh(r,i,y,o),p.state=r.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(i=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),i!==p.state&&Fc.enqueueReplaceState(p,p.state,null),kc(r,o,p,h),p.state=r.memoizedState),typeof p.componentDidMount=="function"&&(r.flags|=4194308)}function io(r,i){try{var o="",h=i;do o+=Ee(h),h=h.return;while(h);var p=o}catch(y){p=`
Error generating stack: `+y.message+`
`+y.stack}return{value:r,source:i,stack:p,digest:null}}function uh(r,i,o){return{value:r,source:null,stack:o??null,digest:i??null}}function dh(r,i){try{console.error(i.value)}catch(o){setTimeout(function(){throw o})}}var vx=typeof WeakMap=="function"?WeakMap:Map;function tg(r,i,o){o=Xs(-1,o),o.tag=3,o.payload={element:null};var h=i.value;return o.callback=function(){Hc||(Hc=!0,Ih=h),dh(r,i)},o}function ng(r,i,o){o=Xs(-1,o),o.tag=3;var h=r.type.getDerivedStateFromError;if(typeof h=="function"){var p=i.value;o.payload=function(){return h(p)},o.callback=function(){dh(r,i)}}var y=r.stateNode;return y!==null&&typeof y.componentDidCatch=="function"&&(o.callback=function(){dh(r,i),typeof h!="function"&&(Ci===null?Ci=new Set([this]):Ci.add(this));var x=i.stack;this.componentDidCatch(i.value,{componentStack:x!==null?x:""})}),o}function rg(r,i,o){var h=r.pingCache;if(h===null){h=r.pingCache=new vx;var p=new Set;h.set(i,p)}else p=h.get(i),p===void 0&&(p=new Set,h.set(i,p));p.has(o)||(p.add(o),r=kx.bind(null,r,i,o),i.then(r,r))}function sg(r){do{var i;if((i=r.tag===13)&&(i=r.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return r;r=r.return}while(r!==null);return null}function ig(r,i,o,h,p){return(r.mode&1)===0?(r===i?r.flags|=65536:(r.flags|=128,o.flags|=131072,o.flags&=-52805,o.tag===1&&(o.alternate===null?o.tag=17:(i=Xs(-1,1),i.tag=2,Ti(o,i,1))),o.lanes|=1),r):(r.flags|=65536,r.lanes=p,r)}var _x=we.ReactCurrentOwner,gr=!1;function sr(r,i,o,h){i.child=r===null?Cm(i,null,o,h):to(i,r.child,o,h)}function ag(r,i,o,h,p){o=o.render;var y=i.ref;return ro(i,p),h=nh(r,i,o,h,y,p),o=rh(),r!==null&&!gr?(i.updateQueue=r.updateQueue,i.flags&=-2053,r.lanes&=~p,Zs(r,i,p)):(Bt&&o&&Fd(i),i.flags|=1,sr(r,i,h,p),i.child)}function og(r,i,o,h,p){if(r===null){var y=o.type;return typeof y=="function"&&!jh(y)&&y.defaultProps===void 0&&o.compare===null&&o.defaultProps===void 0?(i.tag=15,i.type=y,lg(r,i,y,h,p)):(r=Xc(o.type,null,h,i,i.mode,p),r.ref=i.ref,r.return=i,i.child=r)}if(y=r.child,(r.lanes&p)===0){var x=y.memoizedProps;if(o=o.compare,o=o!==null?o:Ko,o(x,h)&&r.ref===i.ref)return Zs(r,i,p)}return i.flags|=1,r=Ri(y,h),r.ref=i.ref,r.return=i,i.child=r}function lg(r,i,o,h,p){if(r!==null){var y=r.memoizedProps;if(Ko(y,h)&&r.ref===i.ref)if(gr=!1,i.pendingProps=h=y,(r.lanes&p)!==0)(r.flags&131072)!==0&&(gr=!0);else return i.lanes=r.lanes,Zs(r,i,p)}return hh(r,i,o,h,p)}function cg(r,i,o){var h=i.pendingProps,p=h.children,y=r!==null?r.memoizedState:null;if(h.mode==="hidden")if((i.mode&1)===0)i.memoizedState={baseLanes:0,cachePool:null,transitions:null},jt(oo,kr),kr|=o;else{if((o&1073741824)===0)return r=y!==null?y.baseLanes|o:o,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:r,cachePool:null,transitions:null},i.updateQueue=null,jt(oo,kr),kr|=r,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},h=y!==null?y.baseLanes:o,jt(oo,kr),kr|=h}else y!==null?(h=y.baseLanes|o,i.memoizedState=null):h=o,jt(oo,kr),kr|=h;return sr(r,i,p,o),i.child}function ug(r,i){var o=i.ref;(r===null&&o!==null||r!==null&&r.ref!==o)&&(i.flags|=512,i.flags|=2097152)}function hh(r,i,o,h,p){var y=mr(o)?ca:Un.current;return y=Ja(i,y),ro(i,p),o=nh(r,i,o,h,y,p),h=rh(),r!==null&&!gr?(i.updateQueue=r.updateQueue,i.flags&=-2053,r.lanes&=~p,Zs(r,i,p)):(Bt&&h&&Fd(i),i.flags|=1,sr(r,i,o,p),i.child)}function dg(r,i,o,h,p){if(mr(o)){var y=!0;Tc(i)}else y=!1;if(ro(i,p),i.stateNode===null)zc(r,i),Zm(i,o,h),ch(i,o,h,p),h=!0;else if(r===null){var x=i.stateNode,j=i.memoizedProps;x.props=j;var U=x.context,ee=o.contextType;typeof ee=="object"&&ee!==null?ee=$r(ee):(ee=mr(o)?ca:Un.current,ee=Ja(i,ee));var pe=o.getDerivedStateFromProps,ge=typeof pe=="function"||typeof x.getSnapshotBeforeUpdate=="function";ge||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(j!==h||U!==ee)&&eg(i,x,h,ee),Ei=!1;var fe=i.memoizedState;x.state=fe,kc(i,h,x,p),U=i.memoizedState,j!==h||fe!==U||pr.current||Ei?(typeof pe=="function"&&(lh(i,o,pe,h),U=i.memoizedState),(j=Ei||Xm(i,o,j,h,fe,U,ee))?(ge||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(i.flags|=4194308)):(typeof x.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=h,i.memoizedState=U),x.props=h,x.state=U,x.context=ee,h=j):(typeof x.componentDidMount=="function"&&(i.flags|=4194308),h=!1)}else{x=i.stateNode,bm(r,i),j=i.memoizedProps,ee=i.type===i.elementType?j:os(i.type,j),x.props=ee,ge=i.pendingProps,fe=x.context,U=o.contextType,typeof U=="object"&&U!==null?U=$r(U):(U=mr(o)?ca:Un.current,U=Ja(i,U));var Oe=o.getDerivedStateFromProps;(pe=typeof Oe=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(j!==ge||fe!==U)&&eg(i,x,h,U),Ei=!1,fe=i.memoizedState,x.state=fe,kc(i,h,x,p);var ze=i.memoizedState;j!==ge||fe!==ze||pr.current||Ei?(typeof Oe=="function"&&(lh(i,o,Oe,h),ze=i.memoizedState),(ee=Ei||Xm(i,o,ee,h,fe,ze,U)||!1)?(pe||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(h,ze,U),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(h,ze,U)),typeof x.componentDidUpdate=="function"&&(i.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof x.componentDidUpdate!="function"||j===r.memoizedProps&&fe===r.memoizedState||(i.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||j===r.memoizedProps&&fe===r.memoizedState||(i.flags|=1024),i.memoizedProps=h,i.memoizedState=ze),x.props=h,x.state=ze,x.context=U,h=ee):(typeof x.componentDidUpdate!="function"||j===r.memoizedProps&&fe===r.memoizedState||(i.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||j===r.memoizedProps&&fe===r.memoizedState||(i.flags|=1024),h=!1)}return fh(r,i,o,h,y,p)}function fh(r,i,o,h,p,y){ug(r,i);var x=(i.flags&128)!==0;if(!h&&!x)return p&&gm(i,o,!1),Zs(r,i,y);h=i.stateNode,_x.current=i;var j=x&&typeof o.getDerivedStateFromError!="function"?null:h.render();return i.flags|=1,r!==null&&x?(i.child=to(i,r.child,null,y),i.child=to(i,null,j,y)):sr(r,i,j,y),i.memoizedState=h.state,p&&gm(i,o,!0),i.child}function hg(r){var i=r.stateNode;i.pendingContext?pm(r,i.pendingContext,i.pendingContext!==i.context):i.context&&pm(r,i.context,!1),Yd(r,i.containerInfo)}function fg(r,i,o,h,p){return eo(),$d(p),i.flags|=256,sr(r,i,o,h),i.child}var ph={dehydrated:null,treeContext:null,retryLane:0};function mh(r){return{baseLanes:r,cachePool:null,transitions:null}}function pg(r,i,o){var h=i.pendingProps,p=Ht.current,y=!1,x=(i.flags&128)!==0,j;if((j=x)||(j=r!==null&&r.memoizedState===null?!1:(p&2)!==0),j?(y=!0,i.flags&=-129):(r===null||r.memoizedState!==null)&&(p|=1),jt(Ht,p&1),r===null)return Bd(i),r=i.memoizedState,r!==null&&(r=r.dehydrated,r!==null)?((i.mode&1)===0?i.lanes=1:r.data==="$!"?i.lanes=8:i.lanes=1073741824,null):(x=h.children,r=h.fallback,y?(h=i.mode,y=i.child,x={mode:"hidden",children:x},(h&1)===0&&y!==null?(y.childLanes=0,y.pendingProps=x):y=Zc(x,h,0,null),r=_a(r,h,o,null),y.return=i,r.return=i,y.sibling=r,i.child=y,i.child.memoizedState=mh(o),i.memoizedState=ph,r):gh(i,x));if(p=r.memoizedState,p!==null&&(j=p.dehydrated,j!==null))return wx(r,i,x,h,j,p,o);if(y){y=h.fallback,x=i.mode,p=r.child,j=p.sibling;var U={mode:"hidden",children:h.children};return(x&1)===0&&i.child!==p?(h=i.child,h.childLanes=0,h.pendingProps=U,i.deletions=null):(h=Ri(p,U),h.subtreeFlags=p.subtreeFlags&14680064),j!==null?y=Ri(j,y):(y=_a(y,x,o,null),y.flags|=2),y.return=i,h.return=i,h.sibling=y,i.child=h,h=y,y=i.child,x=r.child.memoizedState,x=x===null?mh(o):{baseLanes:x.baseLanes|o,cachePool:null,transitions:x.transitions},y.memoizedState=x,y.childLanes=r.childLanes&~o,i.memoizedState=ph,h}return y=r.child,r=y.sibling,h=Ri(y,{mode:"visible",children:h.children}),(i.mode&1)===0&&(h.lanes=o),h.return=i,h.sibling=null,r!==null&&(o=i.deletions,o===null?(i.deletions=[r],i.flags|=16):o.push(r)),i.child=h,i.memoizedState=null,h}function gh(r,i){return i=Zc({mode:"visible",children:i},r.mode,0,null),i.return=r,r.child=i}function Uc(r,i,o,h){return h!==null&&$d(h),to(i,r.child,null,o),r=gh(i,i.pendingProps.children),r.flags|=2,i.memoizedState=null,r}function wx(r,i,o,h,p,y,x){if(o)return i.flags&256?(i.flags&=-257,h=uh(Error(t(422))),Uc(r,i,x,h)):i.memoizedState!==null?(i.child=r.child,i.flags|=128,null):(y=h.fallback,p=i.mode,h=Zc({mode:"visible",children:h.children},p,0,null),y=_a(y,p,x,null),y.flags|=2,h.return=i,y.return=i,h.sibling=y,i.child=h,(i.mode&1)!==0&&to(i,r.child,null,x),i.child.memoizedState=mh(x),i.memoizedState=ph,y);if((i.mode&1)===0)return Uc(r,i,x,null);if(p.data==="$!"){if(h=p.nextSibling&&p.nextSibling.dataset,h)var j=h.dgst;return h=j,y=Error(t(419)),h=uh(y,h,void 0),Uc(r,i,x,h)}if(j=(x&r.childLanes)!==0,gr||j){if(h=En,h!==null){switch(x&-x){case 4:p=2;break;case 16:p=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:p=32;break;case 536870912:p=268435456;break;default:p=0}p=(p&(h.suspendedLanes|x))!==0?0:p,p!==0&&p!==y.retryLane&&(y.retryLane=p,Js(r,p),us(h,r,p,-1))}return kh(),h=uh(Error(t(421))),Uc(r,i,x,h)}return p.data==="$?"?(i.flags|=128,i.child=r.child,i=jx.bind(null,r),p._reactRetry=i,null):(r=y.treeContext,Ar=vi(p.nextSibling),Nr=i,Bt=!0,as=null,r!==null&&(zr[Br++]=Qs,zr[Br++]=Ys,zr[Br++]=ua,Qs=r.id,Ys=r.overflow,ua=i),i=gh(i,h.children),i.flags|=4096,i)}function mg(r,i,o){r.lanes|=i;var h=r.alternate;h!==null&&(h.lanes|=i),qd(r.return,i,o)}function yh(r,i,o,h,p){var y=r.memoizedState;y===null?r.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:h,tail:o,tailMode:p}:(y.isBackwards=i,y.rendering=null,y.renderingStartTime=0,y.last=h,y.tail=o,y.tailMode=p)}function gg(r,i,o){var h=i.pendingProps,p=h.revealOrder,y=h.tail;if(sr(r,i,h.children,o),h=Ht.current,(h&2)!==0)h=h&1|2,i.flags|=128;else{if(r!==null&&(r.flags&128)!==0)e:for(r=i.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&mg(r,o,i);else if(r.tag===19)mg(r,o,i);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===i)break e;for(;r.sibling===null;){if(r.return===null||r.return===i)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}h&=1}if(jt(Ht,h),(i.mode&1)===0)i.memoizedState=null;else switch(p){case"forwards":for(o=i.child,p=null;o!==null;)r=o.alternate,r!==null&&jc(r)===null&&(p=o),o=o.sibling;o=p,o===null?(p=i.child,i.child=null):(p=o.sibling,o.sibling=null),yh(i,!1,p,o,y);break;case"backwards":for(o=null,p=i.child,i.child=null;p!==null;){if(r=p.alternate,r!==null&&jc(r)===null){i.child=p;break}r=p.sibling,p.sibling=o,o=p,p=r}yh(i,!0,o,null,y);break;case"together":yh(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function zc(r,i){(i.mode&1)===0&&r!==null&&(r.alternate=null,i.alternate=null,i.flags|=2)}function Zs(r,i,o){if(r!==null&&(i.dependencies=r.dependencies),ma|=i.lanes,(o&i.childLanes)===0)return null;if(r!==null&&i.child!==r.child)throw Error(t(153));if(i.child!==null){for(r=i.child,o=Ri(r,r.pendingProps),i.child=o,o.return=i;r.sibling!==null;)r=r.sibling,o=o.sibling=Ri(r,r.pendingProps),o.return=i;o.sibling=null}return i.child}function xx(r,i,o){switch(i.tag){case 3:hg(i),eo();break;case 5:Nm(i);break;case 1:mr(i.type)&&Tc(i);break;case 4:Yd(i,i.stateNode.containerInfo);break;case 10:var h=i.type._context,p=i.memoizedProps.value;jt(Rc,h._currentValue),h._currentValue=p;break;case 13:if(h=i.memoizedState,h!==null)return h.dehydrated!==null?(jt(Ht,Ht.current&1),i.flags|=128,null):(o&i.child.childLanes)!==0?pg(r,i,o):(jt(Ht,Ht.current&1),r=Zs(r,i,o),r!==null?r.sibling:null);jt(Ht,Ht.current&1);break;case 19:if(h=(o&i.childLanes)!==0,(r.flags&128)!==0){if(h)return gg(r,i,o);i.flags|=128}if(p=i.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),jt(Ht,Ht.current),h)break;return null;case 22:case 23:return i.lanes=0,cg(r,i,o)}return Zs(r,i,o)}var yg,vh,vg,_g;yg=function(r,i){for(var o=i.child;o!==null;){if(o.tag===5||o.tag===6)r.appendChild(o.stateNode);else if(o.tag!==4&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return;o=o.return}o.sibling.return=o.return,o=o.sibling}},vh=function(){},vg=function(r,i,o,h){var p=r.memoizedProps;if(p!==h){r=i.stateNode,fa(Is.current);var y=null;switch(o){case"input":p=Ke(r,p),h=Ke(r,h),y=[];break;case"select":p=Pe({},p,{value:void 0}),h=Pe({},h,{value:void 0}),y=[];break;case"textarea":p=Qn(r,p),h=Qn(r,h),y=[];break;default:typeof p.onClick!="function"&&typeof h.onClick=="function"&&(r.onclick=wc)}Ct(o,h);var x;o=null;for(ee in p)if(!h.hasOwnProperty(ee)&&p.hasOwnProperty(ee)&&p[ee]!=null)if(ee==="style"){var j=p[ee];for(x in j)j.hasOwnProperty(x)&&(o||(o={}),o[x]="")}else ee!=="dangerouslySetInnerHTML"&&ee!=="children"&&ee!=="suppressContentEditableWarning"&&ee!=="suppressHydrationWarning"&&ee!=="autoFocus"&&(a.hasOwnProperty(ee)?y||(y=[]):(y=y||[]).push(ee,null));for(ee in h){var U=h[ee];if(j=p!=null?p[ee]:void 0,h.hasOwnProperty(ee)&&U!==j&&(U!=null||j!=null))if(ee==="style")if(j){for(x in j)!j.hasOwnProperty(x)||U&&U.hasOwnProperty(x)||(o||(o={}),o[x]="");for(x in U)U.hasOwnProperty(x)&&j[x]!==U[x]&&(o||(o={}),o[x]=U[x])}else o||(y||(y=[]),y.push(ee,o)),o=U;else ee==="dangerouslySetInnerHTML"?(U=U?U.__html:void 0,j=j?j.__html:void 0,U!=null&&j!==U&&(y=y||[]).push(ee,U)):ee==="children"?typeof U!="string"&&typeof U!="number"||(y=y||[]).push(ee,""+U):ee!=="suppressContentEditableWarning"&&ee!=="suppressHydrationWarning"&&(a.hasOwnProperty(ee)?(U!=null&&ee==="onScroll"&&Lt("scroll",r),y||j===U||(y=[])):(y=y||[]).push(ee,U))}o&&(y=y||[]).push("style",o);var ee=y;(i.updateQueue=ee)&&(i.flags|=4)}},_g=function(r,i,o,h){o!==h&&(i.flags|=4)};function cl(r,i){if(!Bt)switch(r.tailMode){case"hidden":i=r.tail;for(var o=null;i!==null;)i.alternate!==null&&(o=i),i=i.sibling;o===null?r.tail=null:o.sibling=null;break;case"collapsed":o=r.tail;for(var h=null;o!==null;)o.alternate!==null&&(h=o),o=o.sibling;h===null?i||r.tail===null?r.tail=null:r.tail.sibling=null:h.sibling=null}}function Bn(r){var i=r.alternate!==null&&r.alternate.child===r.child,o=0,h=0;if(i)for(var p=r.child;p!==null;)o|=p.lanes|p.childLanes,h|=p.subtreeFlags&14680064,h|=p.flags&14680064,p.return=r,p=p.sibling;else for(p=r.child;p!==null;)o|=p.lanes|p.childLanes,h|=p.subtreeFlags,h|=p.flags,p.return=r,p=p.sibling;return r.subtreeFlags|=h,r.childLanes=o,i}function Ex(r,i,o){var h=i.pendingProps;switch(Ud(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Bn(i),null;case 1:return mr(i.type)&&Ec(),Bn(i),null;case 3:return h=i.stateNode,so(),Ot(pr),Ot(Un),Zd(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(r===null||r.child===null)&&(bc(i)?i.flags|=4:r===null||r.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,as!==null&&(Rh(as),as=null))),vh(r,i),Bn(i),null;case 5:Jd(i);var p=fa(sl.current);if(o=i.type,r!==null&&i.stateNode!=null)vg(r,i,o,h,p),r.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!h){if(i.stateNode===null)throw Error(t(166));return Bn(i),null}if(r=fa(Is.current),bc(i)){h=i.stateNode,o=i.type;var y=i.memoizedProps;switch(h[Cs]=i,h[Zo]=y,r=(i.mode&1)!==0,o){case"dialog":Lt("cancel",h),Lt("close",h);break;case"iframe":case"object":case"embed":Lt("load",h);break;case"video":case"audio":for(p=0;p<Yo.length;p++)Lt(Yo[p],h);break;case"source":Lt("error",h);break;case"img":case"image":case"link":Lt("error",h),Lt("load",h);break;case"details":Lt("toggle",h);break;case"input":Et(h,y),Lt("invalid",h);break;case"select":h._wrapperState={wasMultiple:!!y.multiple},Lt("invalid",h);break;case"textarea":Yn(h,y),Lt("invalid",h)}Ct(o,y),p=null;for(var x in y)if(y.hasOwnProperty(x)){var j=y[x];x==="children"?typeof j=="string"?h.textContent!==j&&(y.suppressHydrationWarning!==!0&&_c(h.textContent,j,r),p=["children",j]):typeof j=="number"&&h.textContent!==""+j&&(y.suppressHydrationWarning!==!0&&_c(h.textContent,j,r),p=["children",""+j]):a.hasOwnProperty(x)&&j!=null&&x==="onScroll"&&Lt("scroll",h)}switch(o){case"input":J(h),St(h,y,!0);break;case"textarea":J(h),Jn(h);break;case"select":case"option":break;default:typeof y.onClick=="function"&&(h.onclick=wc)}h=p,i.updateQueue=h,h!==null&&(i.flags|=4)}else{x=p.nodeType===9?p:p.ownerDocument,r==="http://www.w3.org/1999/xhtml"&&(r=ft(o)),r==="http://www.w3.org/1999/xhtml"?o==="script"?(r=x.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild)):typeof h.is=="string"?r=x.createElement(o,{is:h.is}):(r=x.createElement(o),o==="select"&&(x=r,h.multiple?x.multiple=!0:h.size&&(x.size=h.size))):r=x.createElementNS(r,o),r[Cs]=i,r[Zo]=h,yg(r,i,!1,!1),i.stateNode=r;e:{switch(x=Lr(o,h),o){case"dialog":Lt("cancel",r),Lt("close",r),p=h;break;case"iframe":case"object":case"embed":Lt("load",r),p=h;break;case"video":case"audio":for(p=0;p<Yo.length;p++)Lt(Yo[p],r);p=h;break;case"source":Lt("error",r),p=h;break;case"img":case"image":case"link":Lt("error",r),Lt("load",r),p=h;break;case"details":Lt("toggle",r),p=h;break;case"input":Et(r,h),p=Ke(r,h),Lt("invalid",r);break;case"option":p=h;break;case"select":r._wrapperState={wasMultiple:!!h.multiple},p=Pe({},h,{value:void 0}),Lt("invalid",r);break;case"textarea":Yn(r,h),p=Qn(r,h),Lt("invalid",r);break;default:p=h}Ct(o,p),j=p;for(y in j)if(j.hasOwnProperty(y)){var U=j[y];y==="style"?Fs(r,U):y==="dangerouslySetInnerHTML"?(U=U?U.__html:void 0,U!=null&&ar(r,U)):y==="children"?typeof U=="string"?(o!=="textarea"||U!=="")&&or(r,U):typeof U=="number"&&or(r,""+U):y!=="suppressContentEditableWarning"&&y!=="suppressHydrationWarning"&&y!=="autoFocus"&&(a.hasOwnProperty(y)?U!=null&&y==="onScroll"&&Lt("scroll",r):U!=null&&_e(r,y,U,x))}switch(o){case"input":J(r),St(r,h,!1);break;case"textarea":J(r),Jn(r);break;case"option":h.value!=null&&r.setAttribute("value",""+He(h.value));break;case"select":r.multiple=!!h.multiple,y=h.value,y!=null?Cn(r,!!h.multiple,y,!1):h.defaultValue!=null&&Cn(r,!!h.multiple,h.defaultValue,!0);break;default:typeof p.onClick=="function"&&(r.onclick=wc)}switch(o){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}}h&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return Bn(i),null;case 6:if(r&&i.stateNode!=null)_g(r,i,r.memoizedProps,h);else{if(typeof h!="string"&&i.stateNode===null)throw Error(t(166));if(o=fa(sl.current),fa(Is.current),bc(i)){if(h=i.stateNode,o=i.memoizedProps,h[Cs]=i,(y=h.nodeValue!==o)&&(r=Nr,r!==null))switch(r.tag){case 3:_c(h.nodeValue,o,(r.mode&1)!==0);break;case 5:r.memoizedProps.suppressHydrationWarning!==!0&&_c(h.nodeValue,o,(r.mode&1)!==0)}y&&(i.flags|=4)}else h=(o.nodeType===9?o:o.ownerDocument).createTextNode(h),h[Cs]=i,i.stateNode=h}return Bn(i),null;case 13:if(Ot(Ht),h=i.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(Bt&&Ar!==null&&(i.mode&1)!==0&&(i.flags&128)===0)Em(),eo(),i.flags|=98560,y=!1;else if(y=bc(i),h!==null&&h.dehydrated!==null){if(r===null){if(!y)throw Error(t(318));if(y=i.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(t(317));y[Cs]=i}else eo(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Bn(i),y=!1}else as!==null&&(Rh(as),as=null),y=!0;if(!y)return i.flags&65536?i:null}return(i.flags&128)!==0?(i.lanes=o,i):(h=h!==null,h!==(r!==null&&r.memoizedState!==null)&&h&&(i.child.flags|=8192,(i.mode&1)!==0&&(r===null||(Ht.current&1)!==0?pn===0&&(pn=3):kh())),i.updateQueue!==null&&(i.flags|=4),Bn(i),null);case 4:return so(),vh(r,i),r===null&&Jo(i.stateNode.containerInfo),Bn(i),null;case 10:return Hd(i.type._context),Bn(i),null;case 17:return mr(i.type)&&Ec(),Bn(i),null;case 19:if(Ot(Ht),y=i.memoizedState,y===null)return Bn(i),null;if(h=(i.flags&128)!==0,x=y.rendering,x===null)if(h)cl(y,!1);else{if(pn!==0||r!==null&&(r.flags&128)!==0)for(r=i.child;r!==null;){if(x=jc(r),x!==null){for(i.flags|=128,cl(y,!1),h=x.updateQueue,h!==null&&(i.updateQueue=h,i.flags|=4),i.subtreeFlags=0,h=o,o=i.child;o!==null;)y=o,r=h,y.flags&=14680066,x=y.alternate,x===null?(y.childLanes=0,y.lanes=r,y.child=null,y.subtreeFlags=0,y.memoizedProps=null,y.memoizedState=null,y.updateQueue=null,y.dependencies=null,y.stateNode=null):(y.childLanes=x.childLanes,y.lanes=x.lanes,y.child=x.child,y.subtreeFlags=0,y.deletions=null,y.memoizedProps=x.memoizedProps,y.memoizedState=x.memoizedState,y.updateQueue=x.updateQueue,y.type=x.type,r=x.dependencies,y.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),o=o.sibling;return jt(Ht,Ht.current&1|2),i.child}r=r.sibling}y.tail!==null&&pt()>lo&&(i.flags|=128,h=!0,cl(y,!1),i.lanes=4194304)}else{if(!h)if(r=jc(x),r!==null){if(i.flags|=128,h=!0,o=r.updateQueue,o!==null&&(i.updateQueue=o,i.flags|=4),cl(y,!0),y.tail===null&&y.tailMode==="hidden"&&!x.alternate&&!Bt)return Bn(i),null}else 2*pt()-y.renderingStartTime>lo&&o!==1073741824&&(i.flags|=128,h=!0,cl(y,!1),i.lanes=4194304);y.isBackwards?(x.sibling=i.child,i.child=x):(o=y.last,o!==null?o.sibling=x:i.child=x,y.last=x)}return y.tail!==null?(i=y.tail,y.rendering=i,y.tail=i.sibling,y.renderingStartTime=pt(),i.sibling=null,o=Ht.current,jt(Ht,h?o&1|2:o&1),i):(Bn(i),null);case 22:case 23:return Ah(),h=i.memoizedState!==null,r!==null&&r.memoizedState!==null!==h&&(i.flags|=8192),h&&(i.mode&1)!==0?(kr&1073741824)!==0&&(Bn(i),i.subtreeFlags&6&&(i.flags|=8192)):Bn(i),null;case 24:return null;case 25:return null}throw Error(t(156,i.tag))}function Tx(r,i){switch(Ud(i),i.tag){case 1:return mr(i.type)&&Ec(),r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 3:return so(),Ot(pr),Ot(Un),Zd(),r=i.flags,(r&65536)!==0&&(r&128)===0?(i.flags=r&-65537|128,i):null;case 5:return Jd(i),null;case 13:if(Ot(Ht),r=i.memoizedState,r!==null&&r.dehydrated!==null){if(i.alternate===null)throw Error(t(340));eo()}return r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 19:return Ot(Ht),null;case 4:return so(),null;case 10:return Hd(i.type._context),null;case 22:case 23:return Ah(),null;case 24:return null;default:return null}}var Bc=!1,$n=!1,Sx=typeof WeakSet=="function"?WeakSet:Set,Ue=null;function ao(r,i){var o=r.ref;if(o!==null)if(typeof o=="function")try{o(null)}catch(h){Yt(r,i,h)}else o.current=null}function _h(r,i,o){try{o()}catch(h){Yt(r,i,h)}}var wg=!1;function Cx(r,i){if(Ad=mi,r=Xp(),Td(r)){if("selectionStart"in r)var o={start:r.selectionStart,end:r.selectionEnd};else e:{o=(o=r.ownerDocument)&&o.defaultView||window;var h=o.getSelection&&o.getSelection();if(h&&h.rangeCount!==0){o=h.anchorNode;var p=h.anchorOffset,y=h.focusNode;h=h.focusOffset;try{o.nodeType,y.nodeType}catch{o=null;break e}var x=0,j=-1,U=-1,ee=0,pe=0,ge=r,fe=null;t:for(;;){for(var Oe;ge!==o||p!==0&&ge.nodeType!==3||(j=x+p),ge!==y||h!==0&&ge.nodeType!==3||(U=x+h),ge.nodeType===3&&(x+=ge.nodeValue.length),(Oe=ge.firstChild)!==null;)fe=ge,ge=Oe;for(;;){if(ge===r)break t;if(fe===o&&++ee===p&&(j=x),fe===y&&++pe===h&&(U=x),(Oe=ge.nextSibling)!==null)break;ge=fe,fe=ge.parentNode}ge=Oe}o=j===-1||U===-1?null:{start:j,end:U}}else o=null}o=o||{start:0,end:0}}else o=null;for(kd={focusedElem:r,selectionRange:o},mi=!1,Ue=i;Ue!==null;)if(i=Ue,r=i.child,(i.subtreeFlags&1028)!==0&&r!==null)r.return=i,Ue=r;else for(;Ue!==null;){i=Ue;try{var ze=i.alternate;if((i.flags&1024)!==0)switch(i.tag){case 0:case 11:case 15:break;case 1:if(ze!==null){var We=ze.memoizedProps,Xt=ze.memoizedState,Y=i.stateNode,W=Y.getSnapshotBeforeUpdate(i.elementType===i.type?We:os(i.type,We),Xt);Y.__reactInternalSnapshotBeforeUpdate=W}break;case 3:var Z=i.stateNode.containerInfo;Z.nodeType===1?Z.textContent="":Z.nodeType===9&&Z.documentElement&&Z.removeChild(Z.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Ce){Yt(i,i.return,Ce)}if(r=i.sibling,r!==null){r.return=i.return,Ue=r;break}Ue=i.return}return ze=wg,wg=!1,ze}function ul(r,i,o){var h=i.updateQueue;if(h=h!==null?h.lastEffect:null,h!==null){var p=h=h.next;do{if((p.tag&r)===r){var y=p.destroy;p.destroy=void 0,y!==void 0&&_h(i,o,y)}p=p.next}while(p!==h)}}function $c(r,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var o=i=i.next;do{if((o.tag&r)===r){var h=o.create;o.destroy=h()}o=o.next}while(o!==i)}}function wh(r){var i=r.ref;if(i!==null){var o=r.stateNode;switch(r.tag){case 5:r=o;break;default:r=o}typeof i=="function"?i(r):i.current=r}}function xg(r){var i=r.alternate;i!==null&&(r.alternate=null,xg(i)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(i=r.stateNode,i!==null&&(delete i[Cs],delete i[Zo],delete i[Ld],delete i[ox],delete i[lx])),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}function Eg(r){return r.tag===5||r.tag===3||r.tag===4}function Tg(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||Eg(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function xh(r,i,o){var h=r.tag;if(h===5||h===6)r=r.stateNode,i?o.nodeType===8?o.parentNode.insertBefore(r,i):o.insertBefore(r,i):(o.nodeType===8?(i=o.parentNode,i.insertBefore(r,o)):(i=o,i.appendChild(r)),o=o._reactRootContainer,o!=null||i.onclick!==null||(i.onclick=wc));else if(h!==4&&(r=r.child,r!==null))for(xh(r,i,o),r=r.sibling;r!==null;)xh(r,i,o),r=r.sibling}function Eh(r,i,o){var h=r.tag;if(h===5||h===6)r=r.stateNode,i?o.insertBefore(r,i):o.appendChild(r);else if(h!==4&&(r=r.child,r!==null))for(Eh(r,i,o),r=r.sibling;r!==null;)Eh(r,i,o),r=r.sibling}var jn=null,ls=!1;function Si(r,i,o){for(o=o.child;o!==null;)Sg(r,i,o),o=o.sibling}function Sg(r,i,o){if(Ne&&typeof Ne.onCommitFiberUnmount=="function")try{Ne.onCommitFiberUnmount(ie,o)}catch{}switch(o.tag){case 5:$n||ao(o,i);case 6:var h=jn,p=ls;jn=null,Si(r,i,o),jn=h,ls=p,jn!==null&&(ls?(r=jn,o=o.stateNode,r.nodeType===8?r.parentNode.removeChild(o):r.removeChild(o)):jn.removeChild(o.stateNode));break;case 18:jn!==null&&(ls?(r=jn,o=o.stateNode,r.nodeType===8?Vd(r.parentNode,o):r.nodeType===1&&Vd(r,o),rs(r)):Vd(jn,o.stateNode));break;case 4:h=jn,p=ls,jn=o.stateNode.containerInfo,ls=!0,Si(r,i,o),jn=h,ls=p;break;case 0:case 11:case 14:case 15:if(!$n&&(h=o.updateQueue,h!==null&&(h=h.lastEffect,h!==null))){p=h=h.next;do{var y=p,x=y.destroy;y=y.tag,x!==void 0&&((y&2)!==0||(y&4)!==0)&&_h(o,i,x),p=p.next}while(p!==h)}Si(r,i,o);break;case 1:if(!$n&&(ao(o,i),h=o.stateNode,typeof h.componentWillUnmount=="function"))try{h.props=o.memoizedProps,h.state=o.memoizedState,h.componentWillUnmount()}catch(j){Yt(o,i,j)}Si(r,i,o);break;case 21:Si(r,i,o);break;case 22:o.mode&1?($n=(h=$n)||o.memoizedState!==null,Si(r,i,o),$n=h):Si(r,i,o);break;default:Si(r,i,o)}}function Cg(r){var i=r.updateQueue;if(i!==null){r.updateQueue=null;var o=r.stateNode;o===null&&(o=r.stateNode=new Sx),i.forEach(function(h){var p=Dx.bind(null,r,h);o.has(h)||(o.add(h),h.then(p,p))})}}function cs(r,i){var o=i.deletions;if(o!==null)for(var h=0;h<o.length;h++){var p=o[h];try{var y=r,x=i,j=x;e:for(;j!==null;){switch(j.tag){case 5:jn=j.stateNode,ls=!1;break e;case 3:jn=j.stateNode.containerInfo,ls=!0;break e;case 4:jn=j.stateNode.containerInfo,ls=!0;break e}j=j.return}if(jn===null)throw Error(t(160));Sg(y,x,p),jn=null,ls=!1;var U=p.alternate;U!==null&&(U.return=null),p.return=null}catch(ee){Yt(p,i,ee)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)Ig(i,r),i=i.sibling}function Ig(r,i){var o=r.alternate,h=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:if(cs(i,r),Ps(r),h&4){try{ul(3,r,r.return),$c(3,r)}catch(We){Yt(r,r.return,We)}try{ul(5,r,r.return)}catch(We){Yt(r,r.return,We)}}break;case 1:cs(i,r),Ps(r),h&512&&o!==null&&ao(o,o.return);break;case 5:if(cs(i,r),Ps(r),h&512&&o!==null&&ao(o,o.return),r.flags&32){var p=r.stateNode;try{or(p,"")}catch(We){Yt(r,r.return,We)}}if(h&4&&(p=r.stateNode,p!=null)){var y=r.memoizedProps,x=o!==null?o.memoizedProps:y,j=r.type,U=r.updateQueue;if(r.updateQueue=null,U!==null)try{j==="input"&&y.type==="radio"&&y.name!=null&&Tt(p,y),Lr(j,x);var ee=Lr(j,y);for(x=0;x<U.length;x+=2){var pe=U[x],ge=U[x+1];pe==="style"?Fs(p,ge):pe==="dangerouslySetInnerHTML"?ar(p,ge):pe==="children"?or(p,ge):_e(p,pe,ge,ee)}switch(j){case"input":_t(p,y);break;case"textarea":un(p,y);break;case"select":var fe=p._wrapperState.wasMultiple;p._wrapperState.wasMultiple=!!y.multiple;var Oe=y.value;Oe!=null?Cn(p,!!y.multiple,Oe,!1):fe!==!!y.multiple&&(y.defaultValue!=null?Cn(p,!!y.multiple,y.defaultValue,!0):Cn(p,!!y.multiple,y.multiple?[]:"",!1))}p[Zo]=y}catch(We){Yt(r,r.return,We)}}break;case 6:if(cs(i,r),Ps(r),h&4){if(r.stateNode===null)throw Error(t(162));p=r.stateNode,y=r.memoizedProps;try{p.nodeValue=y}catch(We){Yt(r,r.return,We)}}break;case 3:if(cs(i,r),Ps(r),h&4&&o!==null&&o.memoizedState.isDehydrated)try{rs(i.containerInfo)}catch(We){Yt(r,r.return,We)}break;case 4:cs(i,r),Ps(r);break;case 13:cs(i,r),Ps(r),p=r.child,p.flags&8192&&(y=p.memoizedState!==null,p.stateNode.isHidden=y,!y||p.alternate!==null&&p.alternate.memoizedState!==null||(Ch=pt())),h&4&&Cg(r);break;case 22:if(pe=o!==null&&o.memoizedState!==null,r.mode&1?($n=(ee=$n)||pe,cs(i,r),$n=ee):cs(i,r),Ps(r),h&8192){if(ee=r.memoizedState!==null,(r.stateNode.isHidden=ee)&&!pe&&(r.mode&1)!==0)for(Ue=r,pe=r.child;pe!==null;){for(ge=Ue=pe;Ue!==null;){switch(fe=Ue,Oe=fe.child,fe.tag){case 0:case 11:case 14:case 15:ul(4,fe,fe.return);break;case 1:ao(fe,fe.return);var ze=fe.stateNode;if(typeof ze.componentWillUnmount=="function"){h=fe,o=fe.return;try{i=h,ze.props=i.memoizedProps,ze.state=i.memoizedState,ze.componentWillUnmount()}catch(We){Yt(h,o,We)}}break;case 5:ao(fe,fe.return);break;case 22:if(fe.memoizedState!==null){Rg(ge);continue}}Oe!==null?(Oe.return=fe,Ue=Oe):Rg(ge)}pe=pe.sibling}e:for(pe=null,ge=r;;){if(ge.tag===5){if(pe===null){pe=ge;try{p=ge.stateNode,ee?(y=p.style,typeof y.setProperty=="function"?y.setProperty("display","none","important"):y.display="none"):(j=ge.stateNode,U=ge.memoizedProps.style,x=U!=null&&U.hasOwnProperty("display")?U.display:null,j.style.display=yn("display",x))}catch(We){Yt(r,r.return,We)}}}else if(ge.tag===6){if(pe===null)try{ge.stateNode.nodeValue=ee?"":ge.memoizedProps}catch(We){Yt(r,r.return,We)}}else if((ge.tag!==22&&ge.tag!==23||ge.memoizedState===null||ge===r)&&ge.child!==null){ge.child.return=ge,ge=ge.child;continue}if(ge===r)break e;for(;ge.sibling===null;){if(ge.return===null||ge.return===r)break e;pe===ge&&(pe=null),ge=ge.return}pe===ge&&(pe=null),ge.sibling.return=ge.return,ge=ge.sibling}}break;case 19:cs(i,r),Ps(r),h&4&&Cg(r);break;case 21:break;default:cs(i,r),Ps(r)}}function Ps(r){var i=r.flags;if(i&2){try{e:{for(var o=r.return;o!==null;){if(Eg(o)){var h=o;break e}o=o.return}throw Error(t(160))}switch(h.tag){case 5:var p=h.stateNode;h.flags&32&&(or(p,""),h.flags&=-33);var y=Tg(r);Eh(r,y,p);break;case 3:case 4:var x=h.stateNode.containerInfo,j=Tg(r);xh(r,j,x);break;default:throw Error(t(161))}}catch(U){Yt(r,r.return,U)}r.flags&=-3}i&4096&&(r.flags&=-4097)}function Ix(r,i,o){Ue=r,bg(r)}function bg(r,i,o){for(var h=(r.mode&1)!==0;Ue!==null;){var p=Ue,y=p.child;if(p.tag===22&&h){var x=p.memoizedState!==null||Bc;if(!x){var j=p.alternate,U=j!==null&&j.memoizedState!==null||$n;j=Bc;var ee=$n;if(Bc=x,($n=U)&&!ee)for(Ue=p;Ue!==null;)x=Ue,U=x.child,x.tag===22&&x.memoizedState!==null?Ng(p):U!==null?(U.return=x,Ue=U):Ng(p);for(;y!==null;)Ue=y,bg(y),y=y.sibling;Ue=p,Bc=j,$n=ee}Pg(r)}else(p.subtreeFlags&8772)!==0&&y!==null?(y.return=p,Ue=y):Pg(r)}}function Pg(r){for(;Ue!==null;){var i=Ue;if((i.flags&8772)!==0){var o=i.alternate;try{if((i.flags&8772)!==0)switch(i.tag){case 0:case 11:case 15:$n||$c(5,i);break;case 1:var h=i.stateNode;if(i.flags&4&&!$n)if(o===null)h.componentDidMount();else{var p=i.elementType===i.type?o.memoizedProps:os(i.type,o.memoizedProps);h.componentDidUpdate(p,o.memoizedState,h.__reactInternalSnapshotBeforeUpdate)}var y=i.updateQueue;y!==null&&Rm(i,y,h);break;case 3:var x=i.updateQueue;if(x!==null){if(o=null,i.child!==null)switch(i.child.tag){case 5:o=i.child.stateNode;break;case 1:o=i.child.stateNode}Rm(i,x,o)}break;case 5:var j=i.stateNode;if(o===null&&i.flags&4){o=j;var U=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":U.autoFocus&&o.focus();break;case"img":U.src&&(o.src=U.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var ee=i.alternate;if(ee!==null){var pe=ee.memoizedState;if(pe!==null){var ge=pe.dehydrated;ge!==null&&rs(ge)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}$n||i.flags&512&&wh(i)}catch(fe){Yt(i,i.return,fe)}}if(i===r){Ue=null;break}if(o=i.sibling,o!==null){o.return=i.return,Ue=o;break}Ue=i.return}}function Rg(r){for(;Ue!==null;){var i=Ue;if(i===r){Ue=null;break}var o=i.sibling;if(o!==null){o.return=i.return,Ue=o;break}Ue=i.return}}function Ng(r){for(;Ue!==null;){var i=Ue;try{switch(i.tag){case 0:case 11:case 15:var o=i.return;try{$c(4,i)}catch(U){Yt(i,o,U)}break;case 1:var h=i.stateNode;if(typeof h.componentDidMount=="function"){var p=i.return;try{h.componentDidMount()}catch(U){Yt(i,p,U)}}var y=i.return;try{wh(i)}catch(U){Yt(i,y,U)}break;case 5:var x=i.return;try{wh(i)}catch(U){Yt(i,x,U)}}}catch(U){Yt(i,i.return,U)}if(i===r){Ue=null;break}var j=i.sibling;if(j!==null){j.return=i.return,Ue=j;break}Ue=i.return}}var bx=Math.ceil,Wc=we.ReactCurrentDispatcher,Th=we.ReactCurrentOwner,Gr=we.ReactCurrentBatchConfig,vt=0,En=null,an=null,Dn=0,kr=0,oo=_i(0),pn=0,dl=null,ma=0,Gc=0,Sh=0,hl=null,yr=null,Ch=0,lo=1/0,ei=null,Hc=!1,Ih=null,Ci=null,qc=!1,Ii=null,Kc=0,fl=0,bh=null,Qc=-1,Yc=0;function ir(){return(vt&6)!==0?pt():Qc!==-1?Qc:Qc=pt()}function bi(r){return(r.mode&1)===0?1:(vt&2)!==0&&Dn!==0?Dn&-Dn:ux.transition!==null?(Yc===0&&(Yc=$()),Yc):(r=Le,r!==0||(r=window.event,r=r===void 0?16:zo(r.type)),r)}function us(r,i,o,h){if(50<fl)throw fl=0,bh=null,Error(t(185));me(r,o,h),((vt&2)===0||r!==En)&&(r===En&&((vt&2)===0&&(Gc|=o),pn===4&&Pi(r,Dn)),vr(r,h),o===1&&vt===0&&(i.mode&1)===0&&(lo=pt()+500,Sc&&xi()))}function vr(r,i){var o=r.callbackNode;S(r,i);var h=es(r,r===En?Dn:0);if(h===0)o!==null&&Zr(o),r.callbackNode=null,r.callbackPriority=0;else if(i=h&-h,r.callbackPriority!==i){if(o!=null&&Zr(o),i===1)r.tag===0?cx(kg.bind(null,r)):ym(kg.bind(null,r)),ix(function(){(vt&6)===0&&xi()}),o=null;else{switch(ot(h)){case 1:o=G;break;case 4:o=H;break;case 16:o=V;break;case 536870912:o=ae;break;default:o=V}o=Ug(o,Ag.bind(null,r))}r.callbackPriority=i,r.callbackNode=o}}function Ag(r,i){if(Qc=-1,Yc=0,(vt&6)!==0)throw Error(t(327));var o=r.callbackNode;if(co()&&r.callbackNode!==o)return null;var h=es(r,r===En?Dn:0);if(h===0)return null;if((h&30)!==0||(h&r.expiredLanes)!==0||i)i=Jc(r,h);else{i=h;var p=vt;vt|=2;var y=Dg();(En!==r||Dn!==i)&&(ei=null,lo=pt()+500,ya(r,i));do try{Nx();break}catch(j){jg(r,j)}while(!0);Gd(),Wc.current=y,vt=p,an!==null?i=0:(En=null,Dn=0,i=pn)}if(i!==0){if(i===2&&(p=O(r),p!==0&&(h=p,i=Ph(r,p))),i===1)throw o=dl,ya(r,0),Pi(r,h),vr(r,pt()),o;if(i===6)Pi(r,h);else{if(p=r.current.alternate,(h&30)===0&&!Px(p)&&(i=Jc(r,h),i===2&&(y=O(r),y!==0&&(h=y,i=Ph(r,y))),i===1))throw o=dl,ya(r,0),Pi(r,h),vr(r,pt()),o;switch(r.finishedWork=p,r.finishedLanes=h,i){case 0:case 1:throw Error(t(345));case 2:va(r,yr,ei);break;case 3:if(Pi(r,h),(h&130023424)===h&&(i=Ch+500-pt(),10<i)){if(es(r,0)!==0)break;if(p=r.suspendedLanes,(p&h)!==h){ir(),r.pingedLanes|=r.suspendedLanes&p;break}r.timeoutHandle=Dd(va.bind(null,r,yr,ei),i);break}va(r,yr,ei);break;case 4:if(Pi(r,h),(h&4194240)===h)break;for(i=r.eventTimes,p=-1;0<h;){var x=31-ke(h);y=1<<x,x=i[x],x>p&&(p=x),h&=~y}if(h=p,h=pt()-h,h=(120>h?120:480>h?480:1080>h?1080:1920>h?1920:3e3>h?3e3:4320>h?4320:1960*bx(h/1960))-h,10<h){r.timeoutHandle=Dd(va.bind(null,r,yr,ei),h);break}va(r,yr,ei);break;case 5:va(r,yr,ei);break;default:throw Error(t(329))}}}return vr(r,pt()),r.callbackNode===o?Ag.bind(null,r):null}function Ph(r,i){var o=hl;return r.current.memoizedState.isDehydrated&&(ya(r,i).flags|=256),r=Jc(r,i),r!==2&&(i=yr,yr=o,i!==null&&Rh(i)),r}function Rh(r){yr===null?yr=r:yr.push.apply(yr,r)}function Px(r){for(var i=r;;){if(i.flags&16384){var o=i.updateQueue;if(o!==null&&(o=o.stores,o!==null))for(var h=0;h<o.length;h++){var p=o[h],y=p.getSnapshot;p=p.value;try{if(!is(y(),p))return!1}catch{return!1}}}if(o=i.child,i.subtreeFlags&16384&&o!==null)o.return=i,i=o;else{if(i===r)break;for(;i.sibling===null;){if(i.return===null||i.return===r)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Pi(r,i){for(i&=~Sh,i&=~Gc,r.suspendedLanes|=i,r.pingedLanes&=~i,r=r.expirationTimes;0<i;){var o=31-ke(i),h=1<<o;r[o]=-1,i&=~h}}function kg(r){if((vt&6)!==0)throw Error(t(327));co();var i=es(r,0);if((i&1)===0)return vr(r,pt()),null;var o=Jc(r,i);if(r.tag!==0&&o===2){var h=O(r);h!==0&&(i=h,o=Ph(r,h))}if(o===1)throw o=dl,ya(r,0),Pi(r,i),vr(r,pt()),o;if(o===6)throw Error(t(345));return r.finishedWork=r.current.alternate,r.finishedLanes=i,va(r,yr,ei),vr(r,pt()),null}function Nh(r,i){var o=vt;vt|=1;try{return r(i)}finally{vt=o,vt===0&&(lo=pt()+500,Sc&&xi())}}function ga(r){Ii!==null&&Ii.tag===0&&(vt&6)===0&&co();var i=vt;vt|=1;var o=Gr.transition,h=Le;try{if(Gr.transition=null,Le=1,r)return r()}finally{Le=h,Gr.transition=o,vt=i,(vt&6)===0&&xi()}}function Ah(){kr=oo.current,Ot(oo)}function ya(r,i){r.finishedWork=null,r.finishedLanes=0;var o=r.timeoutHandle;if(o!==-1&&(r.timeoutHandle=-1,sx(o)),an!==null)for(o=an.return;o!==null;){var h=o;switch(Ud(h),h.tag){case 1:h=h.type.childContextTypes,h!=null&&Ec();break;case 3:so(),Ot(pr),Ot(Un),Zd();break;case 5:Jd(h);break;case 4:so();break;case 13:Ot(Ht);break;case 19:Ot(Ht);break;case 10:Hd(h.type._context);break;case 22:case 23:Ah()}o=o.return}if(En=r,an=r=Ri(r.current,null),Dn=kr=i,pn=0,dl=null,Sh=Gc=ma=0,yr=hl=null,ha!==null){for(i=0;i<ha.length;i++)if(o=ha[i],h=o.interleaved,h!==null){o.interleaved=null;var p=h.next,y=o.pending;if(y!==null){var x=y.next;y.next=p,h.next=x}o.pending=h}ha=null}return r}function jg(r,i){do{var o=an;try{if(Gd(),Dc.current=Mc,Vc){for(var h=qt.memoizedState;h!==null;){var p=h.queue;p!==null&&(p.pending=null),h=h.next}Vc=!1}if(pa=0,xn=fn=qt=null,il=!1,al=0,Th.current=null,o===null||o.return===null){pn=1,dl=i,an=null;break}e:{var y=r,x=o.return,j=o,U=i;if(i=Dn,j.flags|=32768,U!==null&&typeof U=="object"&&typeof U.then=="function"){var ee=U,pe=j,ge=pe.tag;if((pe.mode&1)===0&&(ge===0||ge===11||ge===15)){var fe=pe.alternate;fe?(pe.updateQueue=fe.updateQueue,pe.memoizedState=fe.memoizedState,pe.lanes=fe.lanes):(pe.updateQueue=null,pe.memoizedState=null)}var Oe=sg(x);if(Oe!==null){Oe.flags&=-257,ig(Oe,x,j,y,i),Oe.mode&1&&rg(y,ee,i),i=Oe,U=ee;var ze=i.updateQueue;if(ze===null){var We=new Set;We.add(U),i.updateQueue=We}else ze.add(U);break e}else{if((i&1)===0){rg(y,ee,i),kh();break e}U=Error(t(426))}}else if(Bt&&j.mode&1){var Xt=sg(x);if(Xt!==null){(Xt.flags&65536)===0&&(Xt.flags|=256),ig(Xt,x,j,y,i),$d(io(U,j));break e}}y=U=io(U,j),pn!==4&&(pn=2),hl===null?hl=[y]:hl.push(y),y=x;do{switch(y.tag){case 3:y.flags|=65536,i&=-i,y.lanes|=i;var Y=tg(y,U,i);Pm(y,Y);break e;case 1:j=U;var W=y.type,Z=y.stateNode;if((y.flags&128)===0&&(typeof W.getDerivedStateFromError=="function"||Z!==null&&typeof Z.componentDidCatch=="function"&&(Ci===null||!Ci.has(Z)))){y.flags|=65536,i&=-i,y.lanes|=i;var Ce=ng(y,j,i);Pm(y,Ce);break e}}y=y.return}while(y!==null)}Lg(o)}catch(qe){i=qe,an===o&&o!==null&&(an=o=o.return);continue}break}while(!0)}function Dg(){var r=Wc.current;return Wc.current=Mc,r===null?Mc:r}function kh(){(pn===0||pn===3||pn===2)&&(pn=4),En===null||(ma&268435455)===0&&(Gc&268435455)===0||Pi(En,Dn)}function Jc(r,i){var o=vt;vt|=2;var h=Dg();(En!==r||Dn!==i)&&(ei=null,ya(r,i));do try{Rx();break}catch(p){jg(r,p)}while(!0);if(Gd(),vt=o,Wc.current=h,an!==null)throw Error(t(261));return En=null,Dn=0,pn}function Rx(){for(;an!==null;)Vg(an)}function Nx(){for(;an!==null&&!Ir();)Vg(an)}function Vg(r){var i=Fg(r.alternate,r,kr);r.memoizedProps=r.pendingProps,i===null?Lg(r):an=i,Th.current=null}function Lg(r){var i=r;do{var o=i.alternate;if(r=i.return,(i.flags&32768)===0){if(o=Ex(o,i,kr),o!==null){an=o;return}}else{if(o=Tx(o,i),o!==null){o.flags&=32767,an=o;return}if(r!==null)r.flags|=32768,r.subtreeFlags=0,r.deletions=null;else{pn=6,an=null;return}}if(i=i.sibling,i!==null){an=i;return}an=i=r}while(i!==null);pn===0&&(pn=5)}function va(r,i,o){var h=Le,p=Gr.transition;try{Gr.transition=null,Le=1,Ax(r,i,o,h)}finally{Gr.transition=p,Le=h}return null}function Ax(r,i,o,h){do co();while(Ii!==null);if((vt&6)!==0)throw Error(t(327));o=r.finishedWork;var p=r.finishedLanes;if(o===null)return null;if(r.finishedWork=null,r.finishedLanes=0,o===r.current)throw Error(t(177));r.callbackNode=null,r.callbackPriority=0;var y=o.lanes|o.childLanes;if(Te(r,y),r===En&&(an=En=null,Dn=0),(o.subtreeFlags&2064)===0&&(o.flags&2064)===0||qc||(qc=!0,Ug(V,function(){return co(),null})),y=(o.flags&15990)!==0,(o.subtreeFlags&15990)!==0||y){y=Gr.transition,Gr.transition=null;var x=Le;Le=1;var j=vt;vt|=4,Th.current=null,Cx(r,o),Ig(o,r),Jw(kd),mi=!!Ad,kd=Ad=null,r.current=o,Ix(o),zs(),vt=j,Le=x,Gr.transition=y}else r.current=o;if(qc&&(qc=!1,Ii=r,Kc=p),y=r.pendingLanes,y===0&&(Ci=null),Se(o.stateNode),vr(r,pt()),i!==null)for(h=r.onRecoverableError,o=0;o<i.length;o++)p=i[o],h(p.value,{componentStack:p.stack,digest:p.digest});if(Hc)throw Hc=!1,r=Ih,Ih=null,r;return(Kc&1)!==0&&r.tag!==0&&co(),y=r.pendingLanes,(y&1)!==0?r===bh?fl++:(fl=0,bh=r):fl=0,xi(),null}function co(){if(Ii!==null){var r=ot(Kc),i=Gr.transition,o=Le;try{if(Gr.transition=null,Le=16>r?16:r,Ii===null)var h=!1;else{if(r=Ii,Ii=null,Kc=0,(vt&6)!==0)throw Error(t(331));var p=vt;for(vt|=4,Ue=r.current;Ue!==null;){var y=Ue,x=y.child;if((Ue.flags&16)!==0){var j=y.deletions;if(j!==null){for(var U=0;U<j.length;U++){var ee=j[U];for(Ue=ee;Ue!==null;){var pe=Ue;switch(pe.tag){case 0:case 11:case 15:ul(8,pe,y)}var ge=pe.child;if(ge!==null)ge.return=pe,Ue=ge;else for(;Ue!==null;){pe=Ue;var fe=pe.sibling,Oe=pe.return;if(xg(pe),pe===ee){Ue=null;break}if(fe!==null){fe.return=Oe,Ue=fe;break}Ue=Oe}}}var ze=y.alternate;if(ze!==null){var We=ze.child;if(We!==null){ze.child=null;do{var Xt=We.sibling;We.sibling=null,We=Xt}while(We!==null)}}Ue=y}}if((y.subtreeFlags&2064)!==0&&x!==null)x.return=y,Ue=x;else e:for(;Ue!==null;){if(y=Ue,(y.flags&2048)!==0)switch(y.tag){case 0:case 11:case 15:ul(9,y,y.return)}var Y=y.sibling;if(Y!==null){Y.return=y.return,Ue=Y;break e}Ue=y.return}}var W=r.current;for(Ue=W;Ue!==null;){x=Ue;var Z=x.child;if((x.subtreeFlags&2064)!==0&&Z!==null)Z.return=x,Ue=Z;else e:for(x=W;Ue!==null;){if(j=Ue,(j.flags&2048)!==0)try{switch(j.tag){case 0:case 11:case 15:$c(9,j)}}catch(qe){Yt(j,j.return,qe)}if(j===x){Ue=null;break e}var Ce=j.sibling;if(Ce!==null){Ce.return=j.return,Ue=Ce;break e}Ue=j.return}}if(vt=p,xi(),Ne&&typeof Ne.onPostCommitFiberRoot=="function")try{Ne.onPostCommitFiberRoot(ie,r)}catch{}h=!0}return h}finally{Le=o,Gr.transition=i}}return!1}function Og(r,i,o){i=io(o,i),i=tg(r,i,1),r=Ti(r,i,1),i=ir(),r!==null&&(me(r,1,i),vr(r,i))}function Yt(r,i,o){if(r.tag===3)Og(r,r,o);else for(;i!==null;){if(i.tag===3){Og(i,r,o);break}else if(i.tag===1){var h=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(Ci===null||!Ci.has(h))){r=io(o,r),r=ng(i,r,1),i=Ti(i,r,1),r=ir(),i!==null&&(me(i,1,r),vr(i,r));break}}i=i.return}}function kx(r,i,o){var h=r.pingCache;h!==null&&h.delete(i),i=ir(),r.pingedLanes|=r.suspendedLanes&o,En===r&&(Dn&o)===o&&(pn===4||pn===3&&(Dn&130023424)===Dn&&500>pt()-Ch?ya(r,0):Sh|=o),vr(r,i)}function Mg(r,i){i===0&&((r.mode&1)===0?i=1:(i=Mr,Mr<<=1,(Mr&130023424)===0&&(Mr=4194304)));var o=ir();r=Js(r,i),r!==null&&(me(r,i,o),vr(r,o))}function jx(r){var i=r.memoizedState,o=0;i!==null&&(o=i.retryLane),Mg(r,o)}function Dx(r,i){var o=0;switch(r.tag){case 13:var h=r.stateNode,p=r.memoizedState;p!==null&&(o=p.retryLane);break;case 19:h=r.stateNode;break;default:throw Error(t(314))}h!==null&&h.delete(i),Mg(r,o)}var Fg;Fg=function(r,i,o){if(r!==null)if(r.memoizedProps!==i.pendingProps||pr.current)gr=!0;else{if((r.lanes&o)===0&&(i.flags&128)===0)return gr=!1,xx(r,i,o);gr=(r.flags&131072)!==0}else gr=!1,Bt&&(i.flags&1048576)!==0&&vm(i,Ic,i.index);switch(i.lanes=0,i.tag){case 2:var h=i.type;zc(r,i),r=i.pendingProps;var p=Ja(i,Un.current);ro(i,o),p=nh(null,i,h,r,p,o);var y=rh();return i.flags|=1,typeof p=="object"&&p!==null&&typeof p.render=="function"&&p.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,mr(h)?(y=!0,Tc(i)):y=!1,i.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,Qd(i),p.updater=Fc,i.stateNode=p,p._reactInternals=i,ch(i,h,r,o),i=fh(null,i,h,!0,y,o)):(i.tag=0,Bt&&y&&Fd(i),sr(null,i,p,o),i=i.child),i;case 16:h=i.elementType;e:{switch(zc(r,i),r=i.pendingProps,p=h._init,h=p(h._payload),i.type=h,p=i.tag=Lx(h),r=os(h,r),p){case 0:i=hh(null,i,h,r,o);break e;case 1:i=dg(null,i,h,r,o);break e;case 11:i=ag(null,i,h,r,o);break e;case 14:i=og(null,i,h,os(h.type,r),o);break e}throw Error(t(306,h,""))}return i;case 0:return h=i.type,p=i.pendingProps,p=i.elementType===h?p:os(h,p),hh(r,i,h,p,o);case 1:return h=i.type,p=i.pendingProps,p=i.elementType===h?p:os(h,p),dg(r,i,h,p,o);case 3:e:{if(hg(i),r===null)throw Error(t(387));h=i.pendingProps,y=i.memoizedState,p=y.element,bm(r,i),kc(i,h,null,o);var x=i.memoizedState;if(h=x.element,y.isDehydrated)if(y={element:h,isDehydrated:!1,cache:x.cache,pendingSuspenseBoundaries:x.pendingSuspenseBoundaries,transitions:x.transitions},i.updateQueue.baseState=y,i.memoizedState=y,i.flags&256){p=io(Error(t(423)),i),i=fg(r,i,h,o,p);break e}else if(h!==p){p=io(Error(t(424)),i),i=fg(r,i,h,o,p);break e}else for(Ar=vi(i.stateNode.containerInfo.firstChild),Nr=i,Bt=!0,as=null,o=Cm(i,null,h,o),i.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(eo(),h===p){i=Zs(r,i,o);break e}sr(r,i,h,o)}i=i.child}return i;case 5:return Nm(i),r===null&&Bd(i),h=i.type,p=i.pendingProps,y=r!==null?r.memoizedProps:null,x=p.children,jd(h,p)?x=null:y!==null&&jd(h,y)&&(i.flags|=32),ug(r,i),sr(r,i,x,o),i.child;case 6:return r===null&&Bd(i),null;case 13:return pg(r,i,o);case 4:return Yd(i,i.stateNode.containerInfo),h=i.pendingProps,r===null?i.child=to(i,null,h,o):sr(r,i,h,o),i.child;case 11:return h=i.type,p=i.pendingProps,p=i.elementType===h?p:os(h,p),ag(r,i,h,p,o);case 7:return sr(r,i,i.pendingProps,o),i.child;case 8:return sr(r,i,i.pendingProps.children,o),i.child;case 12:return sr(r,i,i.pendingProps.children,o),i.child;case 10:e:{if(h=i.type._context,p=i.pendingProps,y=i.memoizedProps,x=p.value,jt(Rc,h._currentValue),h._currentValue=x,y!==null)if(is(y.value,x)){if(y.children===p.children&&!pr.current){i=Zs(r,i,o);break e}}else for(y=i.child,y!==null&&(y.return=i);y!==null;){var j=y.dependencies;if(j!==null){x=y.child;for(var U=j.firstContext;U!==null;){if(U.context===h){if(y.tag===1){U=Xs(-1,o&-o),U.tag=2;var ee=y.updateQueue;if(ee!==null){ee=ee.shared;var pe=ee.pending;pe===null?U.next=U:(U.next=pe.next,pe.next=U),ee.pending=U}}y.lanes|=o,U=y.alternate,U!==null&&(U.lanes|=o),qd(y.return,o,i),j.lanes|=o;break}U=U.next}}else if(y.tag===10)x=y.type===i.type?null:y.child;else if(y.tag===18){if(x=y.return,x===null)throw Error(t(341));x.lanes|=o,j=x.alternate,j!==null&&(j.lanes|=o),qd(x,o,i),x=y.sibling}else x=y.child;if(x!==null)x.return=y;else for(x=y;x!==null;){if(x===i){x=null;break}if(y=x.sibling,y!==null){y.return=x.return,x=y;break}x=x.return}y=x}sr(r,i,p.children,o),i=i.child}return i;case 9:return p=i.type,h=i.pendingProps.children,ro(i,o),p=$r(p),h=h(p),i.flags|=1,sr(r,i,h,o),i.child;case 14:return h=i.type,p=os(h,i.pendingProps),p=os(h.type,p),og(r,i,h,p,o);case 15:return lg(r,i,i.type,i.pendingProps,o);case 17:return h=i.type,p=i.pendingProps,p=i.elementType===h?p:os(h,p),zc(r,i),i.tag=1,mr(h)?(r=!0,Tc(i)):r=!1,ro(i,o),Zm(i,h,p),ch(i,h,p,o),fh(null,i,h,!0,r,o);case 19:return gg(r,i,o);case 22:return cg(r,i,o)}throw Error(t(156,i.tag))};function Ug(r,i){return ws(r,i)}function Vx(r,i,o,h){this.tag=r,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Hr(r,i,o,h){return new Vx(r,i,o,h)}function jh(r){return r=r.prototype,!(!r||!r.isReactComponent)}function Lx(r){if(typeof r=="function")return jh(r)?1:0;if(r!=null){if(r=r.$$typeof,r===L)return 11;if(r===xe)return 14}return 2}function Ri(r,i){var o=r.alternate;return o===null?(o=Hr(r.tag,i,r.key,r.mode),o.elementType=r.elementType,o.type=r.type,o.stateNode=r.stateNode,o.alternate=r,r.alternate=o):(o.pendingProps=i,o.type=r.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=r.flags&14680064,o.childLanes=r.childLanes,o.lanes=r.lanes,o.child=r.child,o.memoizedProps=r.memoizedProps,o.memoizedState=r.memoizedState,o.updateQueue=r.updateQueue,i=r.dependencies,o.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},o.sibling=r.sibling,o.index=r.index,o.ref=r.ref,o}function Xc(r,i,o,h,p,y){var x=2;if(h=r,typeof r=="function")jh(r)&&(x=1);else if(typeof r=="string")x=5;else e:switch(r){case A:return _a(o.children,p,y,i);case P:x=8,p|=8;break;case R:return r=Hr(12,o,i,p|2),r.elementType=R,r.lanes=y,r;case b:return r=Hr(13,o,i,p),r.elementType=b,r.lanes=y,r;case he:return r=Hr(19,o,i,p),r.elementType=he,r.lanes=y,r;case Be:return Zc(o,p,y,i);default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case F:x=10;break e;case z:x=9;break e;case L:x=11;break e;case xe:x=14;break e;case ut:x=16,h=null;break e}throw Error(t(130,r==null?r:typeof r,""))}return i=Hr(x,o,i,p),i.elementType=r,i.type=h,i.lanes=y,i}function _a(r,i,o,h){return r=Hr(7,r,h,i),r.lanes=o,r}function Zc(r,i,o,h){return r=Hr(22,r,h,i),r.elementType=Be,r.lanes=o,r.stateNode={isHidden:!1},r}function Dh(r,i,o){return r=Hr(6,r,null,i),r.lanes=o,r}function Vh(r,i,o){return i=Hr(4,r.children!==null?r.children:[],r.key,i),i.lanes=o,i.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},i}function Ox(r,i,o,h,p){this.tag=i,this.containerInfo=r,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ce(0),this.expirationTimes=ce(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ce(0),this.identifierPrefix=h,this.onRecoverableError=p,this.mutableSourceEagerHydrationData=null}function Lh(r,i,o,h,p,y,x,j,U){return r=new Ox(r,i,o,j,U),i===1?(i=1,y===!0&&(i|=8)):i=0,y=Hr(3,null,null,i),r.current=y,y.stateNode=r,y.memoizedState={element:h,isDehydrated:o,cache:null,transitions:null,pendingSuspenseBoundaries:null},Qd(y),r}function Mx(r,i,o){var h=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ie,key:h==null?null:""+h,children:r,containerInfo:i,implementation:o}}function zg(r){if(!r)return wi;r=r._reactInternals;e:{if(_n(r)!==r||r.tag!==1)throw Error(t(170));var i=r;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(mr(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(t(171))}if(r.tag===1){var o=r.type;if(mr(o))return mm(r,o,i)}return i}function Bg(r,i,o,h,p,y,x,j,U){return r=Lh(o,h,!0,r,p,y,x,j,U),r.context=zg(null),o=r.current,h=ir(),p=bi(o),y=Xs(h,p),y.callback=i??null,Ti(o,y,p),r.current.lanes=p,me(r,p,h),vr(r,h),r}function eu(r,i,o,h){var p=i.current,y=ir(),x=bi(p);return o=zg(o),i.context===null?i.context=o:i.pendingContext=o,i=Xs(y,x),i.payload={element:r},h=h===void 0?null:h,h!==null&&(i.callback=h),r=Ti(p,i,x),r!==null&&(us(r,p,x,y),Ac(r,p,x)),x}function tu(r){if(r=r.current,!r.child)return null;switch(r.child.tag){case 5:return r.child.stateNode;default:return r.child.stateNode}}function $g(r,i){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var o=r.retryLane;r.retryLane=o!==0&&o<i?o:i}}function Oh(r,i){$g(r,i),(r=r.alternate)&&$g(r,i)}function Fx(){return null}var Wg=typeof reportError=="function"?reportError:function(r){console.error(r)};function Mh(r){this._internalRoot=r}nu.prototype.render=Mh.prototype.render=function(r){var i=this._internalRoot;if(i===null)throw Error(t(409));eu(r,i,null,null)},nu.prototype.unmount=Mh.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var i=r.containerInfo;ga(function(){eu(null,r,null,null)}),i[qs]=null}};function nu(r){this._internalRoot=r}nu.prototype.unstable_scheduleHydration=function(r){if(r){var i=tr();r={blockedOn:null,target:r,priority:i};for(var o=0;o<Fr.length&&i!==0&&i<Fr[o].priority;o++);Fr.splice(o,0,r),o===0&&ic(r)}};function Fh(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function ru(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11&&(r.nodeType!==8||r.nodeValue!==" react-mount-point-unstable "))}function Gg(){}function Ux(r,i,o,h,p){if(p){if(typeof h=="function"){var y=h;h=function(){var ee=tu(x);y.call(ee)}}var x=Bg(i,h,r,0,null,!1,!1,"",Gg);return r._reactRootContainer=x,r[qs]=x.current,Jo(r.nodeType===8?r.parentNode:r),ga(),x}for(;p=r.lastChild;)r.removeChild(p);if(typeof h=="function"){var j=h;h=function(){var ee=tu(U);j.call(ee)}}var U=Lh(r,0,!1,null,null,!1,!1,"",Gg);return r._reactRootContainer=U,r[qs]=U.current,Jo(r.nodeType===8?r.parentNode:r),ga(function(){eu(i,U,o,h)}),U}function su(r,i,o,h,p){var y=o._reactRootContainer;if(y){var x=y;if(typeof p=="function"){var j=p;p=function(){var U=tu(x);j.call(U)}}eu(i,x,r,p)}else x=Ux(o,i,r,p,h);return tu(x)}Rt=function(r){switch(r.tag){case 3:var i=r.stateNode;if(i.current.memoizedState.isDehydrated){var o=br(i.pendingLanes);o!==0&&(Ae(i,o|1),vr(i,pt()),(vt&6)===0&&(lo=pt()+500,xi()))}break;case 13:ga(function(){var h=Js(r,1);if(h!==null){var p=ir();us(h,r,1,p)}}),Oh(r,1)}},Vt=function(r){if(r.tag===13){var i=Js(r,134217728);if(i!==null){var o=ir();us(i,r,134217728,o)}Oh(r,134217728)}},Ut=function(r){if(r.tag===13){var i=bi(r),o=Js(r,i);if(o!==null){var h=ir();us(o,r,i,h)}Oh(r,i)}},tr=function(){return Le},rn=function(r,i){var o=Le;try{return Le=r,i()}finally{Le=o}},ur=function(r,i,o){switch(i){case"input":if(_t(r,o),i=o.name,o.type==="radio"&&i!=null){for(o=r;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<o.length;i++){var h=o[i];if(h!==r&&h.form===r.form){var p=xc(h);if(!p)throw Error(t(90));$e(h),_t(h,p)}}}break;case"textarea":un(r,o);break;case"select":i=o.value,i!=null&&Cn(r,!!o.multiple,i,!1)}},er=Nh,ys=ga;var zx={usingClientEntryPoint:!1,Events:[el,Qa,xc,Wt,Zn,Nh]},pl={findFiberByHostInstance:la,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Bx={bundleType:pl.bundleType,version:pl.version,rendererPackageName:pl.rendererPackageName,rendererConfig:pl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:we.ReactCurrentDispatcher,findHostInstanceByFiber:function(r){return r=Xr(r),r===null?null:r.stateNode},findFiberByHostInstance:pl.findFiberByHostInstance||Fx,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var iu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!iu.isDisabled&&iu.supportsFiber)try{ie=iu.inject(Bx),Ne=iu}catch{}}return _r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=zx,_r.createPortal=function(r,i){var o=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Fh(i))throw Error(t(200));return Mx(r,i,null,o)},_r.createRoot=function(r,i){if(!Fh(r))throw Error(t(299));var o=!1,h="",p=Wg;return i!=null&&(i.unstable_strictMode===!0&&(o=!0),i.identifierPrefix!==void 0&&(h=i.identifierPrefix),i.onRecoverableError!==void 0&&(p=i.onRecoverableError)),i=Lh(r,1,!1,null,null,o,!1,h,p),r[qs]=i.current,Jo(r.nodeType===8?r.parentNode:r),new Mh(i)},_r.findDOMNode=function(r){if(r==null)return null;if(r.nodeType===1)return r;var i=r._reactInternals;if(i===void 0)throw typeof r.render=="function"?Error(t(188)):(r=Object.keys(r).join(","),Error(t(268,r)));return r=Xr(i),r=r===null?null:r.stateNode,r},_r.flushSync=function(r){return ga(r)},_r.hydrate=function(r,i,o){if(!ru(i))throw Error(t(200));return su(null,r,i,!0,o)},_r.hydrateRoot=function(r,i,o){if(!Fh(r))throw Error(t(405));var h=o!=null&&o.hydratedSources||null,p=!1,y="",x=Wg;if(o!=null&&(o.unstable_strictMode===!0&&(p=!0),o.identifierPrefix!==void 0&&(y=o.identifierPrefix),o.onRecoverableError!==void 0&&(x=o.onRecoverableError)),i=Bg(i,null,r,1,o??null,p,!1,y,x),r[qs]=i.current,Jo(r),h)for(r=0;r<h.length;r++)o=h[r],p=o._getVersion,p=p(o._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[o,p]:i.mutableSourceEagerHydrationData.push(o,p);return new nu(i)},_r.render=function(r,i,o){if(!ru(i))throw Error(t(200));return su(null,r,i,!1,o)},_r.unmountComponentAtNode=function(r){if(!ru(r))throw Error(t(40));return r._reactRootContainer?(ga(function(){su(null,null,r,!1,function(){r._reactRootContainer=null,r[qs]=null})}),!0):!1},_r.unstable_batchedUpdates=Nh,_r.unstable_renderSubtreeIntoContainer=function(r,i,o,h){if(!ru(o))throw Error(t(200));if(r==null||r._reactInternals===void 0)throw Error(t(38));return su(r,i,o,!1,h)},_r.version="18.3.1-next-f1338f8080-20240426",_r}var Zg;function t_(){if(Zg)return Bh.exports;Zg=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Bh.exports=Jx(),Bh.exports}var ey;function Xx(){if(ey)return au;ey=1;var n=t_();return au.createRoot=n.createRoot,au.hydrateRoot=n.hydrateRoot,au}var Zx=Xx();const eE=e_(Zx);t_();/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function kl(){return kl=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},kl.apply(this,arguments)}var Vi;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(Vi||(Vi={}));const ty="popstate";function tE(n){n===void 0&&(n={});function e(s,a){let{pathname:l,search:d,hash:f}=s.location;return of("",{pathname:l,search:d,hash:f},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(s,a){return typeof a=="string"?a:Su(a)}return rE(e,t,null,n)}function tn(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Mf(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function nE(){return Math.random().toString(36).substr(2,8)}function ny(n,e){return{usr:n.state,key:n.key,idx:e}}function of(n,e,t,s){return t===void 0&&(t=null),kl({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?Ro(e):e,{state:t,key:e&&e.key||s||nE()})}function Su(n){let{pathname:e="/",search:t="",hash:s=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),s&&s!=="#"&&(e+=s.charAt(0)==="#"?s:"#"+s),e}function Ro(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let s=n.indexOf("?");s>=0&&(e.search=n.substr(s),n=n.substr(0,s)),n&&(e.pathname=n)}return e}function rE(n,e,t,s){s===void 0&&(s={});let{window:a=document.defaultView,v5Compat:l=!1}=s,d=a.history,f=Vi.Pop,m=null,v=w();v==null&&(v=0,d.replaceState(kl({},d.state,{idx:v}),""));function w(){return(d.state||{idx:null}).idx}function T(){f=Vi.Pop;let M=w(),ne=M==null?null:M-v;v=M,m&&m({action:f,location:K.location,delta:ne})}function I(M,ne){f=Vi.Push;let be=of(K.location,M,ne);v=w()+1;let _e=ny(be,v),we=K.createHref(be);try{d.pushState(_e,"",we)}catch(le){if(le instanceof DOMException&&le.name==="DataCloneError")throw le;a.location.assign(we)}l&&m&&m({action:f,location:K.location,delta:1})}function B(M,ne){f=Vi.Replace;let be=of(K.location,M,ne);v=w();let _e=ny(be,v),we=K.createHref(be);d.replaceState(_e,"",we),l&&m&&m({action:f,location:K.location,delta:0})}function X(M){let ne=a.location.origin!=="null"?a.location.origin:a.location.href,be=typeof M=="string"?M:Su(M);return be=be.replace(/ $/,"%20"),tn(ne,"No window.location.(origin|href) available to create URL for href: "+be),new URL(be,ne)}let K={get action(){return f},get location(){return n(a,d)},listen(M){if(m)throw new Error("A history only accepts one active listener");return a.addEventListener(ty,T),m=M,()=>{a.removeEventListener(ty,T),m=null}},createHref(M){return e(a,M)},createURL:X,encodeLocation(M){let ne=X(M);return{pathname:ne.pathname,search:ne.search,hash:ne.hash}},push:I,replace:B,go(M){return d.go(M)}};return K}var ry;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(ry||(ry={}));function sE(n,e,t){return t===void 0&&(t="/"),iE(n,e,t)}function iE(n,e,t,s){let a=typeof e=="string"?Ro(e):e,l=Ff(a.pathname||"/",t);if(l==null)return null;let d=n_(n);aE(d);let f=null;for(let m=0;f==null&&m<d.length;++m){let v=vE(l);f=mE(d[m],v)}return f}function n_(n,e,t,s){e===void 0&&(e=[]),t===void 0&&(t=[]),s===void 0&&(s="");let a=(l,d,f)=>{let m={relativePath:f===void 0?l.path||"":f,caseSensitive:l.caseSensitive===!0,childrenIndex:d,route:l};m.relativePath.startsWith("/")&&(tn(m.relativePath.startsWith(s),'Absolute route path "'+m.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),m.relativePath=m.relativePath.slice(s.length));let v=Mi([s,m.relativePath]),w=t.concat(m);l.children&&l.children.length>0&&(tn(l.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+v+'".')),n_(l.children,e,w,v)),!(l.path==null&&!l.index)&&e.push({path:v,score:fE(v,l.index),routesMeta:w})};return n.forEach((l,d)=>{var f;if(l.path===""||!((f=l.path)!=null&&f.includes("?")))a(l,d);else for(let m of r_(l.path))a(l,d,m)}),e}function r_(n){let e=n.split("/");if(e.length===0)return[];let[t,...s]=e,a=t.endsWith("?"),l=t.replace(/\?$/,"");if(s.length===0)return a?[l,""]:[l];let d=r_(s.join("/")),f=[];return f.push(...d.map(m=>m===""?l:[l,m].join("/"))),a&&f.push(...d),f.map(m=>n.startsWith("/")&&m===""?"/":m)}function aE(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:pE(e.routesMeta.map(s=>s.childrenIndex),t.routesMeta.map(s=>s.childrenIndex)))}const oE=/^:[\w-]+$/,lE=3,cE=2,uE=1,dE=10,hE=-2,sy=n=>n==="*";function fE(n,e){let t=n.split("/"),s=t.length;return t.some(sy)&&(s+=hE),e&&(s+=cE),t.filter(a=>!sy(a)).reduce((a,l)=>a+(oE.test(l)?lE:l===""?uE:dE),s)}function pE(n,e){return n.length===e.length&&n.slice(0,-1).every((s,a)=>s===e[a])?n[n.length-1]-e[e.length-1]:0}function mE(n,e,t){let{routesMeta:s}=n,a={},l="/",d=[];for(let f=0;f<s.length;++f){let m=s[f],v=f===s.length-1,w=l==="/"?e:e.slice(l.length)||"/",T=gE({path:m.relativePath,caseSensitive:m.caseSensitive,end:v},w),I=m.route;if(!T)return null;Object.assign(a,T.params),d.push({params:a,pathname:Mi([l,T.pathname]),pathnameBase:TE(Mi([l,T.pathnameBase])),route:I}),T.pathnameBase!=="/"&&(l=Mi([l,T.pathnameBase]))}return d}function gE(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,s]=yE(n.path,n.caseSensitive,n.end),a=e.match(t);if(!a)return null;let l=a[0],d=l.replace(/(.)\/+$/,"$1"),f=a.slice(1);return{params:s.reduce((v,w,T)=>{let{paramName:I,isOptional:B}=w;if(I==="*"){let K=f[T]||"";d=l.slice(0,l.length-K.length).replace(/(.)\/+$/,"$1")}const X=f[T];return B&&!X?v[I]=void 0:v[I]=(X||"").replace(/%2F/g,"/"),v},{}),pathname:l,pathnameBase:d,pattern:n}}function yE(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),Mf(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let s=[],a="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,f,m)=>(s.push({paramName:f,isOptional:m!=null}),m?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(s.push({paramName:"*"}),a+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?a+="\\/*$":n!==""&&n!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),s]}function vE(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Mf(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function Ff(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,s=n.charAt(t);return s&&s!=="/"?null:n.slice(t)||"/"}const _E=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,wE=n=>_E.test(n);function xE(n,e){e===void 0&&(e="/");let{pathname:t,search:s="",hash:a=""}=typeof n=="string"?Ro(n):n,l;if(t)if(wE(t))l=t;else{if(t.includes("//")){let d=t;t=t.replace(/\/\/+/g,"/"),Mf(!1,"Pathnames cannot have embedded double slashes - normalizing "+(d+" -> "+t))}t.startsWith("/")?l=iy(t.substring(1),"/"):l=iy(t,e)}else l=e;return{pathname:l,search:SE(s),hash:CE(a)}}function iy(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(a=>{a===".."?t.length>1&&t.pop():a!=="."&&t.push(a)}),t.length>1?t.join("/"):"/"}function Gh(n,e,t,s){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function EE(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Uf(n,e){let t=EE(n);return e?t.map((s,a)=>a===t.length-1?s.pathname:s.pathnameBase):t.map(s=>s.pathnameBase)}function zf(n,e,t,s){s===void 0&&(s=!1);let a;typeof n=="string"?a=Ro(n):(a=kl({},n),tn(!a.pathname||!a.pathname.includes("?"),Gh("?","pathname","search",a)),tn(!a.pathname||!a.pathname.includes("#"),Gh("#","pathname","hash",a)),tn(!a.search||!a.search.includes("#"),Gh("#","search","hash",a)));let l=n===""||a.pathname==="",d=l?"/":a.pathname,f;if(d==null)f=t;else{let T=e.length-1;if(!s&&d.startsWith("..")){let I=d.split("/");for(;I[0]==="..";)I.shift(),T-=1;a.pathname=I.join("/")}f=T>=0?e[T]:"/"}let m=xE(a,f),v=d&&d!=="/"&&d.endsWith("/"),w=(l||d===".")&&t.endsWith("/");return!m.pathname.endsWith("/")&&(v||w)&&(m.pathname+="/"),m}const Mi=n=>n.join("/").replace(/\/\/+/g,"/"),TE=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),SE=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,CE=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function IE(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const s_=["post","put","patch","delete"];new Set(s_);const bE=["get",...s_];new Set(bE);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function jl(){return jl=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},jl.apply(this,arguments)}const Bf=k.createContext(null),PE=k.createContext(null),Xi=k.createContext(null),Gu=k.createContext(null),Zi=k.createContext({outlet:null,matches:[],isDataRoute:!1}),i_=k.createContext(null);function RE(n,e){let{relative:t}=e===void 0?{}:e;No()||tn(!1);let{basename:s,navigator:a}=k.useContext(Xi),{hash:l,pathname:d,search:f}=o_(n,{relative:t}),m=d;return s!=="/"&&(m=d==="/"?s:Mi([s,d])),a.createHref({pathname:m,search:f,hash:l})}function No(){return k.useContext(Gu)!=null}function Wl(){return No()||tn(!1),k.useContext(Gu).location}function a_(n){k.useContext(Xi).static||k.useLayoutEffect(n)}function Hu(){let{isDataRoute:n}=k.useContext(Zi);return n?BE():NE()}function NE(){No()||tn(!1);let n=k.useContext(Bf),{basename:e,future:t,navigator:s}=k.useContext(Xi),{matches:a}=k.useContext(Zi),{pathname:l}=Wl(),d=JSON.stringify(Uf(a,t.v7_relativeSplatPath)),f=k.useRef(!1);return a_(()=>{f.current=!0}),k.useCallback(function(v,w){if(w===void 0&&(w={}),!f.current)return;if(typeof v=="number"){s.go(v);return}let T=zf(v,JSON.parse(d),l,w.relative==="path");n==null&&e!=="/"&&(T.pathname=T.pathname==="/"?e:Mi([e,T.pathname])),(w.replace?s.replace:s.push)(T,w.state,w)},[e,s,d,l,n])}function o_(n,e){let{relative:t}=e===void 0?{}:e,{future:s}=k.useContext(Xi),{matches:a}=k.useContext(Zi),{pathname:l}=Wl(),d=JSON.stringify(Uf(a,s.v7_relativeSplatPath));return k.useMemo(()=>zf(n,JSON.parse(d),l,t==="path"),[n,d,l,t])}function AE(n,e){return kE(n,e)}function kE(n,e,t,s){No()||tn(!1);let{navigator:a}=k.useContext(Xi),{matches:l}=k.useContext(Zi),d=l[l.length-1],f=d?d.params:{};d&&d.pathname;let m=d?d.pathnameBase:"/";d&&d.route;let v=Wl(),w;if(e){var T;let M=typeof e=="string"?Ro(e):e;m==="/"||(T=M.pathname)!=null&&T.startsWith(m)||tn(!1),w=M}else w=v;let I=w.pathname||"/",B=I;if(m!=="/"){let M=m.replace(/^\//,"").split("/");B="/"+I.replace(/^\//,"").split("/").slice(M.length).join("/")}let X=sE(n,{pathname:B}),K=OE(X&&X.map(M=>Object.assign({},M,{params:Object.assign({},f,M.params),pathname:Mi([m,a.encodeLocation?a.encodeLocation(M.pathname).pathname:M.pathname]),pathnameBase:M.pathnameBase==="/"?m:Mi([m,a.encodeLocation?a.encodeLocation(M.pathnameBase).pathname:M.pathnameBase])})),l,t,s);return e&&K?k.createElement(Gu.Provider,{value:{location:jl({pathname:"/",search:"",hash:"",state:null,key:"default"},w),navigationType:Vi.Pop}},K):K}function jE(){let n=zE(),e=IE(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return k.createElement(k.Fragment,null,k.createElement("h2",null,"Unexpected Application Error!"),k.createElement("h3",{style:{fontStyle:"italic"}},e),t?k.createElement("pre",{style:a},t):null,null)}const DE=k.createElement(jE,null);class VE extends k.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?k.createElement(Zi.Provider,{value:this.props.routeContext},k.createElement(i_.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function LE(n){let{routeContext:e,match:t,children:s}=n,a=k.useContext(Bf);return a&&a.static&&a.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=t.route.id),k.createElement(Zi.Provider,{value:e},s)}function OE(n,e,t,s){var a;if(e===void 0&&(e=[]),t===void 0&&(t=null),s===void 0&&(s=null),n==null){var l;if(!t)return null;if(t.errors)n=t.matches;else if((l=s)!=null&&l.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let d=n,f=(a=t)==null?void 0:a.errors;if(f!=null){let w=d.findIndex(T=>T.route.id&&(f==null?void 0:f[T.route.id])!==void 0);w>=0||tn(!1),d=d.slice(0,Math.min(d.length,w+1))}let m=!1,v=-1;if(t&&s&&s.v7_partialHydration)for(let w=0;w<d.length;w++){let T=d[w];if((T.route.HydrateFallback||T.route.hydrateFallbackElement)&&(v=w),T.route.id){let{loaderData:I,errors:B}=t,X=T.route.loader&&I[T.route.id]===void 0&&(!B||B[T.route.id]===void 0);if(T.route.lazy||X){m=!0,v>=0?d=d.slice(0,v+1):d=[d[0]];break}}}return d.reduceRight((w,T,I)=>{let B,X=!1,K=null,M=null;t&&(B=f&&T.route.id?f[T.route.id]:void 0,K=T.route.errorElement||DE,m&&(v<0&&I===0?($E("route-fallback"),X=!0,M=null):v===I&&(X=!0,M=T.route.hydrateFallbackElement||null)));let ne=e.concat(d.slice(0,I+1)),be=()=>{let _e;return B?_e=K:X?_e=M:T.route.Component?_e=k.createElement(T.route.Component,null):T.route.element?_e=T.route.element:_e=w,k.createElement(LE,{match:T,routeContext:{outlet:w,matches:ne,isDataRoute:t!=null},children:_e})};return t&&(T.route.ErrorBoundary||T.route.errorElement||I===0)?k.createElement(VE,{location:t.location,revalidation:t.revalidation,component:K,error:B,children:be(),routeContext:{outlet:null,matches:ne,isDataRoute:!0}}):be()},null)}var l_=(function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n})(l_||{}),c_=(function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n})(c_||{});function ME(n){let e=k.useContext(Bf);return e||tn(!1),e}function FE(n){let e=k.useContext(PE);return e||tn(!1),e}function UE(n){let e=k.useContext(Zi);return e||tn(!1),e}function u_(n){let e=UE(),t=e.matches[e.matches.length-1];return t.route.id||tn(!1),t.route.id}function zE(){var n;let e=k.useContext(i_),t=FE(),s=u_();return e!==void 0?e:(n=t.errors)==null?void 0:n[s]}function BE(){let{router:n}=ME(l_.UseNavigateStable),e=u_(c_.UseNavigateStable),t=k.useRef(!1);return a_(()=>{t.current=!0}),k.useCallback(function(a,l){l===void 0&&(l={}),t.current&&(typeof a=="number"?n.navigate(a):n.navigate(a,jl({fromRouteId:e},l)))},[n,e])}const ay={};function $E(n,e,t){ay[n]||(ay[n]=!0)}function WE(n,e){n==null||n.v7_startTransition,n==null||n.v7_relativeSplatPath}function GE(n){let{to:e,replace:t,state:s,relative:a}=n;No()||tn(!1);let{future:l,static:d}=k.useContext(Xi),{matches:f}=k.useContext(Zi),{pathname:m}=Wl(),v=Hu(),w=zf(e,Uf(f,l.v7_relativeSplatPath),m,a==="path"),T=JSON.stringify(w);return k.useEffect(()=>v(JSON.parse(T),{replace:t,state:s,relative:a}),[v,T,a,t,s]),null}function ds(n){tn(!1)}function HE(n){let{basename:e="/",children:t=null,location:s,navigationType:a=Vi.Pop,navigator:l,static:d=!1,future:f}=n;No()&&tn(!1);let m=e.replace(/^\/*/,"/"),v=k.useMemo(()=>({basename:m,navigator:l,static:d,future:jl({v7_relativeSplatPath:!1},f)}),[m,f,l,d]);typeof s=="string"&&(s=Ro(s));let{pathname:w="/",search:T="",hash:I="",state:B=null,key:X="default"}=s,K=k.useMemo(()=>{let M=Ff(w,m);return M==null?null:{location:{pathname:M,search:T,hash:I,state:B,key:X},navigationType:a}},[m,w,T,I,B,X,a]);return K==null?null:k.createElement(Xi.Provider,{value:v},k.createElement(Gu.Provider,{children:t,value:K}))}function qE(n){let{children:e,location:t}=n;return AE(lf(e),t)}new Promise(()=>{});function lf(n,e){e===void 0&&(e=[]);let t=[];return k.Children.forEach(n,(s,a)=>{if(!k.isValidElement(s))return;let l=[...e,a];if(s.type===k.Fragment){t.push.apply(t,lf(s.props.children,l));return}s.type!==ds&&tn(!1),!s.props.index||!s.props.children||tn(!1);let d={id:s.props.id||l.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(d.children=lf(s.props.children,l)),t.push(d)}),t}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function cf(){return cf=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},cf.apply(this,arguments)}function KE(n,e){if(n==null)return{};var t={},s=Object.keys(n),a,l;for(l=0;l<s.length;l++)a=s[l],!(e.indexOf(a)>=0)&&(t[a]=n[a]);return t}function QE(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function YE(n,e){return n.button===0&&(!e||e==="_self")&&!QE(n)}const JE=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],XE="6";try{window.__reactRouterVersion=XE}catch{}const ZE="startTransition",oy=Kx[ZE];function eT(n){let{basename:e,children:t,future:s,window:a}=n,l=k.useRef();l.current==null&&(l.current=tE({window:a,v5Compat:!0}));let d=l.current,[f,m]=k.useState({action:d.action,location:d.location}),{v7_startTransition:v}=s||{},w=k.useCallback(T=>{v&&oy?oy(()=>m(T)):m(T)},[m,v]);return k.useLayoutEffect(()=>d.listen(w),[d,w]),k.useEffect(()=>WE(s),[s]),k.createElement(HE,{basename:e,children:t,location:f.location,navigationType:f.action,navigator:d,future:s})}const tT=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",nT=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,wa=k.forwardRef(function(e,t){let{onClick:s,relative:a,reloadDocument:l,replace:d,state:f,target:m,to:v,preventScrollReset:w,viewTransition:T}=e,I=KE(e,JE),{basename:B}=k.useContext(Xi),X,K=!1;if(typeof v=="string"&&nT.test(v)&&(X=v,tT))try{let _e=new URL(window.location.href),we=v.startsWith("//")?new URL(_e.protocol+v):new URL(v),le=Ff(we.pathname,B);we.origin===_e.origin&&le!=null?v=le+we.search+we.hash:K=!0}catch{}let M=RE(v,{relative:a}),ne=rT(v,{replace:d,state:f,target:m,preventScrollReset:w,relative:a,viewTransition:T});function be(_e){s&&s(_e),_e.defaultPrevented||ne(_e)}return k.createElement("a",cf({},I,{href:X||M,onClick:K||l?s:be,ref:t,target:m}))});var ly;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(ly||(ly={}));var cy;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(cy||(cy={}));function rT(n,e){let{target:t,replace:s,state:a,preventScrollReset:l,relative:d,viewTransition:f}=e===void 0?{}:e,m=Hu(),v=Wl(),w=o_(n,{relative:d});return k.useCallback(T=>{if(YE(T,t)){T.preventDefault();let I=s!==void 0?s:Su(v)===Su(w);m(n,{replace:I,state:a,preventScrollReset:l,relative:d,viewTransition:f})}},[v,m,w,s,a,t,n,l,d,f])}const sT=()=>{};var uy={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d_=function(n){const e=[];let t=0;for(let s=0;s<n.length;s++){let a=n.charCodeAt(s);a<128?e[t++]=a:a<2048?(e[t++]=a>>6|192,e[t++]=a&63|128):(a&64512)===55296&&s+1<n.length&&(n.charCodeAt(s+1)&64512)===56320?(a=65536+((a&1023)<<10)+(n.charCodeAt(++s)&1023),e[t++]=a>>18|240,e[t++]=a>>12&63|128,e[t++]=a>>6&63|128,e[t++]=a&63|128):(e[t++]=a>>12|224,e[t++]=a>>6&63|128,e[t++]=a&63|128)}return e},iT=function(n){const e=[];let t=0,s=0;for(;t<n.length;){const a=n[t++];if(a<128)e[s++]=String.fromCharCode(a);else if(a>191&&a<224){const l=n[t++];e[s++]=String.fromCharCode((a&31)<<6|l&63)}else if(a>239&&a<365){const l=n[t++],d=n[t++],f=n[t++],m=((a&7)<<18|(l&63)<<12|(d&63)<<6|f&63)-65536;e[s++]=String.fromCharCode(55296+(m>>10)),e[s++]=String.fromCharCode(56320+(m&1023))}else{const l=n[t++],d=n[t++];e[s++]=String.fromCharCode((a&15)<<12|(l&63)<<6|d&63)}}return e.join("")},h_={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let a=0;a<n.length;a+=3){const l=n[a],d=a+1<n.length,f=d?n[a+1]:0,m=a+2<n.length,v=m?n[a+2]:0,w=l>>2,T=(l&3)<<4|f>>4;let I=(f&15)<<2|v>>6,B=v&63;m||(B=64,d||(I=64)),s.push(t[w],t[T],t[I],t[B])}return s.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(d_(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):iT(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let a=0;a<n.length;){const l=t[n.charAt(a++)],f=a<n.length?t[n.charAt(a)]:0;++a;const v=a<n.length?t[n.charAt(a)]:64;++a;const T=a<n.length?t[n.charAt(a)]:64;if(++a,l==null||f==null||v==null||T==null)throw new aT;const I=l<<2|f>>4;if(s.push(I),v!==64){const B=f<<4&240|v>>2;if(s.push(B),T!==64){const X=v<<6&192|T;s.push(X)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class aT extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const oT=function(n){const e=d_(n);return h_.encodeByteArray(e,!0)},Cu=function(n){return oT(n).replace(/\./g,"")},f_=function(n){try{return h_.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lT(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cT=()=>lT().__FIREBASE_DEFAULTS__,uT=()=>{if(typeof process>"u"||typeof uy>"u")return;const n=uy.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},dT=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&f_(n[1]);return e&&JSON.parse(e)},qu=()=>{try{return sT()||cT()||uT()||dT()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},p_=n=>{var e,t;return(t=(e=qu())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},hT=n=>{const e=p_(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),s]:[e.substring(0,t),s]},m_=()=>{var n;return(n=qu())===null||n===void 0?void 0:n.config},g_=n=>{var e;return(e=qu())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fT{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,s)=>{t?this.reject(t):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,s))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ao(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function y_(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pT(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},s=e||"demo-project",a=n.iat||0,l=n.sub||n.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d=Object.assign({iss:`https://securetoken.google.com/${s}`,aud:s,iat:a,exp:a+3600,auth_time:a,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Cu(JSON.stringify(t)),Cu(JSON.stringify(d)),""].join(".")}const Cl={};function mT(){const n={prod:[],emulator:[]};for(const e of Object.keys(Cl))Cl[e]?n.emulator.push(e):n.prod.push(e);return n}function gT(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let dy=!1;function v_(n,e){if(typeof window>"u"||typeof document>"u"||!Ao(window.location.host)||Cl[n]===e||Cl[n]||dy)return;Cl[n]=e;function t(I){return`__firebase__banner__${I}`}const s="__firebase__banner",l=mT().prod.length>0;function d(){const I=document.getElementById(s);I&&I.remove()}function f(I){I.style.display="flex",I.style.background="#7faaf0",I.style.position="fixed",I.style.bottom="5px",I.style.left="5px",I.style.padding=".5em",I.style.borderRadius="5px",I.style.alignItems="center"}function m(I,B){I.setAttribute("width","24"),I.setAttribute("id",B),I.setAttribute("height","24"),I.setAttribute("viewBox","0 0 24 24"),I.setAttribute("fill","none"),I.style.marginLeft="-6px"}function v(){const I=document.createElement("span");return I.style.cursor="pointer",I.style.marginLeft="16px",I.style.fontSize="24px",I.innerHTML=" &times;",I.onclick=()=>{dy=!0,d()},I}function w(I,B){I.setAttribute("id",B),I.innerText="Learn more",I.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",I.setAttribute("target","__blank"),I.style.paddingLeft="5px",I.style.textDecoration="underline"}function T(){const I=gT(s),B=t("text"),X=document.getElementById(B)||document.createElement("span"),K=t("learnmore"),M=document.getElementById(K)||document.createElement("a"),ne=t("preprendIcon"),be=document.getElementById(ne)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(I.created){const _e=I.element;f(_e),w(M,K);const we=v();m(be,ne),_e.append(be,X,M,we),document.body.appendChild(_e)}l?(X.innerText="Preview backend disconnected.",be.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(be.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,X.innerText="Preview backend running in this workspace."),X.setAttribute("id",B)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",T):T()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function yT(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Kn())}function vT(){var n;const e=(n=qu())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function _T(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function wT(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function xT(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function ET(){const n=Kn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function TT(){return!vT()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function ST(){try{return typeof indexedDB=="object"}catch{return!1}}function CT(){return new Promise((n,e)=>{try{let t=!0;const s="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(s);a.onsuccess=()=>{a.result.close(),t||self.indexedDB.deleteDatabase(s),n(!0)},a.onupgradeneeded=()=>{t=!1},a.onerror=()=>{var l;e(((l=a.error)===null||l===void 0?void 0:l.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IT="FirebaseError";class fi extends Error{constructor(e,t,s){super(t),this.code=e,this.customData=s,this.name=IT,Object.setPrototypeOf(this,fi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Gl.prototype.create)}}class Gl{constructor(e,t,s){this.service=e,this.serviceName=t,this.errors=s}create(e,...t){const s=t[0]||{},a=`${this.service}/${e}`,l=this.errors[e],d=l?bT(l,s):"Error",f=`${this.serviceName}: ${d} (${a}).`;return new fi(a,f,s)}}function bT(n,e){return n.replace(PT,(t,s)=>{const a=e[s];return a!=null?String(a):`<${s}?>`})}const PT=/\{\$([^}]+)}/g;function RT(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Ia(n,e){if(n===e)return!0;const t=Object.keys(n),s=Object.keys(e);for(const a of t){if(!s.includes(a))return!1;const l=n[a],d=e[a];if(hy(l)&&hy(d)){if(!Ia(l,d))return!1}else if(l!==d)return!1}for(const a of s)if(!t.includes(a))return!1;return!0}function hy(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hl(n){const e=[];for(const[t,s]of Object.entries(n))Array.isArray(s)?s.forEach(a=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function _l(n){const e={};return n.replace(/^\?/,"").split("&").forEach(s=>{if(s){const[a,l]=s.split("=");e[decodeURIComponent(a)]=decodeURIComponent(l)}}),e}function wl(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function NT(n,e){const t=new AT(n,e);return t.subscribe.bind(t)}class AT{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,s){let a;if(e===void 0&&t===void 0&&s===void 0)throw new Error("Missing Observer.");kT(e,["next","error","complete"])?a=e:a={next:e,error:t,complete:s},a.next===void 0&&(a.next=Hh),a.error===void 0&&(a.error=Hh),a.complete===void 0&&(a.complete=Hh);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function kT(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Hh(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nn(n){return n&&n._delegate?n._delegate:n}class ba{constructor(e,t,s){this.name=e,this.instanceFactory=t,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xa="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jT{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const s=new fT;if(this.instancesDeferred.set(t,s),this.isInitialized(t)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:t});a&&s.resolve(a)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const s=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),a=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(s)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:s})}catch(l){if(a)return null;throw l}else{if(a)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(VT(e))try{this.getOrInitializeService({instanceIdentifier:xa})}catch{}for(const[t,s]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(t);try{const l=this.getOrInitializeService({instanceIdentifier:a});s.resolve(l)}catch{}}}}clearInstance(e=xa){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=xa){return this.instances.has(e)}getOptions(e=xa){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:s,options:t});for(const[l,d]of this.instancesDeferred.entries()){const f=this.normalizeInstanceIdentifier(l);s===f&&d.resolve(a)}return a}onInit(e,t){var s;const a=this.normalizeInstanceIdentifier(t),l=(s=this.onInitCallbacks.get(a))!==null&&s!==void 0?s:new Set;l.add(e),this.onInitCallbacks.set(a,l);const d=this.instances.get(a);return d&&e(d,a),()=>{l.delete(e)}}invokeOnInitCallbacks(e,t){const s=this.onInitCallbacks.get(t);if(s)for(const a of s)try{a(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:DT(e),options:t}),this.instances.set(e,s),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=xa){return this.component?this.component.multipleInstances?e:xa:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function DT(n){return n===xa?void 0:n}function VT(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LT{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new jT(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var dt;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(dt||(dt={}));const OT={debug:dt.DEBUG,verbose:dt.VERBOSE,info:dt.INFO,warn:dt.WARN,error:dt.ERROR,silent:dt.SILENT},MT=dt.INFO,FT={[dt.DEBUG]:"log",[dt.VERBOSE]:"log",[dt.INFO]:"info",[dt.WARN]:"warn",[dt.ERROR]:"error"},UT=(n,e,...t)=>{if(e<n.logLevel)return;const s=new Date().toISOString(),a=FT[e];if(a)console[a](`[${s}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class $f{constructor(e){this.name=e,this._logLevel=MT,this._logHandler=UT,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in dt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?OT[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,dt.DEBUG,...e),this._logHandler(this,dt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,dt.VERBOSE,...e),this._logHandler(this,dt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,dt.INFO,...e),this._logHandler(this,dt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,dt.WARN,...e),this._logHandler(this,dt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,dt.ERROR,...e),this._logHandler(this,dt.ERROR,...e)}}const zT=(n,e)=>e.some(t=>n instanceof t);let fy,py;function BT(){return fy||(fy=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function $T(){return py||(py=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const __=new WeakMap,uf=new WeakMap,w_=new WeakMap,qh=new WeakMap,Wf=new WeakMap;function WT(n){const e=new Promise((t,s)=>{const a=()=>{n.removeEventListener("success",l),n.removeEventListener("error",d)},l=()=>{t(Fi(n.result)),a()},d=()=>{s(n.error),a()};n.addEventListener("success",l),n.addEventListener("error",d)});return e.then(t=>{t instanceof IDBCursor&&__.set(t,n)}).catch(()=>{}),Wf.set(e,n),e}function GT(n){if(uf.has(n))return;const e=new Promise((t,s)=>{const a=()=>{n.removeEventListener("complete",l),n.removeEventListener("error",d),n.removeEventListener("abort",d)},l=()=>{t(),a()},d=()=>{s(n.error||new DOMException("AbortError","AbortError")),a()};n.addEventListener("complete",l),n.addEventListener("error",d),n.addEventListener("abort",d)});uf.set(n,e)}let df={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return uf.get(n);if(e==="objectStoreNames")return n.objectStoreNames||w_.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Fi(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function HT(n){df=n(df)}function qT(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const s=n.call(Kh(this),e,...t);return w_.set(s,e.sort?e.sort():[e]),Fi(s)}:$T().includes(n)?function(...e){return n.apply(Kh(this),e),Fi(__.get(this))}:function(...e){return Fi(n.apply(Kh(this),e))}}function KT(n){return typeof n=="function"?qT(n):(n instanceof IDBTransaction&&GT(n),zT(n,BT())?new Proxy(n,df):n)}function Fi(n){if(n instanceof IDBRequest)return WT(n);if(qh.has(n))return qh.get(n);const e=KT(n);return e!==n&&(qh.set(n,e),Wf.set(e,n)),e}const Kh=n=>Wf.get(n);function QT(n,e,{blocked:t,upgrade:s,blocking:a,terminated:l}={}){const d=indexedDB.open(n,e),f=Fi(d);return s&&d.addEventListener("upgradeneeded",m=>{s(Fi(d.result),m.oldVersion,m.newVersion,Fi(d.transaction),m)}),t&&d.addEventListener("blocked",m=>t(m.oldVersion,m.newVersion,m)),f.then(m=>{l&&m.addEventListener("close",()=>l()),a&&m.addEventListener("versionchange",v=>a(v.oldVersion,v.newVersion,v))}).catch(()=>{}),f}const YT=["get","getKey","getAll","getAllKeys","count"],JT=["put","add","delete","clear"],Qh=new Map;function my(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Qh.get(e))return Qh.get(e);const t=e.replace(/FromIndex$/,""),s=e!==t,a=JT.includes(t);if(!(t in(s?IDBIndex:IDBObjectStore).prototype)||!(a||YT.includes(t)))return;const l=async function(d,...f){const m=this.transaction(d,a?"readwrite":"readonly");let v=m.store;return s&&(v=v.index(f.shift())),(await Promise.all([v[t](...f),a&&m.done]))[0]};return Qh.set(e,l),l}HT(n=>({...n,get:(e,t,s)=>my(e,t)||n.get(e,t,s),has:(e,t)=>!!my(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XT{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(ZT(t)){const s=t.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(t=>t).join(" ")}}function ZT(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const hf="@firebase/app",gy="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oi=new $f("@firebase/app"),eS="@firebase/app-compat",tS="@firebase/analytics-compat",nS="@firebase/analytics",rS="@firebase/app-check-compat",sS="@firebase/app-check",iS="@firebase/auth",aS="@firebase/auth-compat",oS="@firebase/database",lS="@firebase/data-connect",cS="@firebase/database-compat",uS="@firebase/functions",dS="@firebase/functions-compat",hS="@firebase/installations",fS="@firebase/installations-compat",pS="@firebase/messaging",mS="@firebase/messaging-compat",gS="@firebase/performance",yS="@firebase/performance-compat",vS="@firebase/remote-config",_S="@firebase/remote-config-compat",wS="@firebase/storage",xS="@firebase/storage-compat",ES="@firebase/firestore",TS="@firebase/ai",SS="@firebase/firestore-compat",CS="firebase",IS="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ff="[DEFAULT]",bS={[hf]:"fire-core",[eS]:"fire-core-compat",[nS]:"fire-analytics",[tS]:"fire-analytics-compat",[sS]:"fire-app-check",[rS]:"fire-app-check-compat",[iS]:"fire-auth",[aS]:"fire-auth-compat",[oS]:"fire-rtdb",[lS]:"fire-data-connect",[cS]:"fire-rtdb-compat",[uS]:"fire-fn",[dS]:"fire-fn-compat",[hS]:"fire-iid",[fS]:"fire-iid-compat",[pS]:"fire-fcm",[mS]:"fire-fcm-compat",[gS]:"fire-perf",[yS]:"fire-perf-compat",[vS]:"fire-rc",[_S]:"fire-rc-compat",[wS]:"fire-gcs",[xS]:"fire-gcs-compat",[ES]:"fire-fst",[SS]:"fire-fst-compat",[TS]:"fire-vertex","fire-js":"fire-js",[CS]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iu=new Map,PS=new Map,pf=new Map;function yy(n,e){try{n.container.addComponent(e)}catch(t){oi.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Eo(n){const e=n.name;if(pf.has(e))return oi.debug(`There were multiple attempts to register component ${e}.`),!1;pf.set(e,n);for(const t of Iu.values())yy(t,n);for(const t of PS.values())yy(t,n);return!0}function Gf(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function jr(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RS={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ui=new Gl("app","Firebase",RS);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NS{constructor(e,t,s){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new ba("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ui.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ko=IS;function x_(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const s=Object.assign({name:ff,automaticDataCollectionEnabled:!0},e),a=s.name;if(typeof a!="string"||!a)throw Ui.create("bad-app-name",{appName:String(a)});if(t||(t=m_()),!t)throw Ui.create("no-options");const l=Iu.get(a);if(l){if(Ia(t,l.options)&&Ia(s,l.config))return l;throw Ui.create("duplicate-app",{appName:a})}const d=new LT(a);for(const m of pf.values())d.addComponent(m);const f=new NS(t,s,d);return Iu.set(a,f),f}function E_(n=ff){const e=Iu.get(n);if(!e&&n===ff&&m_())return x_();if(!e)throw Ui.create("no-app",{appName:n});return e}function zi(n,e,t){var s;let a=(s=bS[n])!==null&&s!==void 0?s:n;t&&(a+=`-${t}`);const l=a.match(/\s|\//),d=e.match(/\s|\//);if(l||d){const f=[`Unable to register library "${a}" with version "${e}":`];l&&f.push(`library name "${a}" contains illegal characters (whitespace or "/")`),l&&d&&f.push("and"),d&&f.push(`version name "${e}" contains illegal characters (whitespace or "/")`),oi.warn(f.join(" "));return}Eo(new ba(`${a}-version`,()=>({library:a,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AS="firebase-heartbeat-database",kS=1,Dl="firebase-heartbeat-store";let Yh=null;function T_(){return Yh||(Yh=QT(AS,kS,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Dl)}catch(t){console.warn(t)}}}}).catch(n=>{throw Ui.create("idb-open",{originalErrorMessage:n.message})})),Yh}async function jS(n){try{const t=(await T_()).transaction(Dl),s=await t.objectStore(Dl).get(S_(n));return await t.done,s}catch(e){if(e instanceof fi)oi.warn(e.message);else{const t=Ui.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});oi.warn(t.message)}}}async function vy(n,e){try{const s=(await T_()).transaction(Dl,"readwrite");await s.objectStore(Dl).put(e,S_(n)),await s.done}catch(t){if(t instanceof fi)oi.warn(t.message);else{const s=Ui.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});oi.warn(s.message)}}}function S_(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DS=1024,VS=30;class LS{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new MS(t),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){var e,t;try{const a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),l=_y();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===l||this._heartbeatsCache.heartbeats.some(d=>d.date===l))return;if(this._heartbeatsCache.heartbeats.push({date:l,agent:a}),this._heartbeatsCache.heartbeats.length>VS){const d=FS(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(d,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(s){oi.warn(s)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=_y(),{heartbeatsToSend:s,unsentEntries:a}=OS(this._heartbeatsCache.heartbeats),l=Cu(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=t,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(t){return oi.warn(t),""}}}function _y(){return new Date().toISOString().substring(0,10)}function OS(n,e=DS){const t=[];let s=n.slice();for(const a of n){const l=t.find(d=>d.agent===a.agent);if(l){if(l.dates.push(a.date),wy(t)>e){l.dates.pop();break}}else if(t.push({agent:a.agent,dates:[a.date]}),wy(t)>e){t.pop();break}s=s.slice(1)}return{heartbeatsToSend:t,unsentEntries:s}}class MS{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return ST()?CT().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await jS(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const a=await this.read();return vy(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:a.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const a=await this.read();return vy(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:a.lastSentHeartbeatDate,heartbeats:[...a.heartbeats,...e.heartbeats]})}else return}}function wy(n){return Cu(JSON.stringify({version:2,heartbeats:n})).length}function FS(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let s=1;s<n.length;s++)n[s].date<t&&(t=n[s].date,e=s);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function US(n){Eo(new ba("platform-logger",e=>new XT(e),"PRIVATE")),Eo(new ba("heartbeat",e=>new LS(e),"PRIVATE")),zi(hf,gy,n),zi(hf,gy,"esm2017"),zi("fire-js","")}US("");var zS="firebase",BS="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */zi(zS,BS,"app");function Hf(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(n);a<s.length;a++)e.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(n,s[a])&&(t[s[a]]=n[s[a]]);return t}function C_(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const $S=C_,I_=new Gl("auth","Firebase",C_());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bu=new $f("@firebase/auth");function WS(n,...e){bu.logLevel<=dt.WARN&&bu.warn(`Auth (${ko}): ${n}`,...e)}function fu(n,...e){bu.logLevel<=dt.ERROR&&bu.error(`Auth (${ko}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yr(n,...e){throw Kf(n,...e)}function ps(n,...e){return Kf(n,...e)}function qf(n,e,t){const s=Object.assign(Object.assign({},$S()),{[e]:t});return new Gl("auth","Firebase",s).create(e,{appName:n.name})}function ii(n){return qf(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function b_(n,e,t){const s=t;if(!(e instanceof s))throw s.name!==e.constructor.name&&Yr(n,"argument-error"),qf(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Kf(n,...e){if(typeof n!="string"){const t=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=n.name),n._errorFactory.create(t,...s)}return I_.create(n,...e)}function Xe(n,e,...t){if(!n)throw Kf(e,...t)}function ni(n){const e="INTERNAL ASSERTION FAILED: "+n;throw fu(e),new Error(e)}function li(n,e){n||ni(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mf(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function GS(){return xy()==="http:"||xy()==="https:"}function xy(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HS(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(GS()||wT()||"connection"in navigator)?navigator.onLine:!0}function qS(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ql{constructor(e,t){this.shortDelay=e,this.longDelay=t,li(t>e,"Short delay should be less than long delay!"),this.isMobile=yT()||xT()}get(){return HS()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qf(n,e){li(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P_{static initialize(e,t,s){this.fetchImpl=e,t&&(this.headersImpl=t),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ni("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ni("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ni("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KS={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QS=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],YS=new ql(3e4,6e4);function ea(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function Ms(n,e,t,s,a={}){return R_(n,a,async()=>{let l={},d={};s&&(e==="GET"?d=s:l={body:JSON.stringify(s)});const f=Hl(Object.assign({key:n.config.apiKey},d)).slice(1),m=await n._getAdditionalHeaders();m["Content-Type"]="application/json",n.languageCode&&(m["X-Firebase-Locale"]=n.languageCode);const v=Object.assign({method:e,headers:m},l);return _T()||(v.referrerPolicy="no-referrer"),n.emulatorConfig&&Ao(n.emulatorConfig.host)&&(v.credentials="include"),P_.fetch()(await N_(n,n.config.apiHost,t,f),v)})}async function R_(n,e,t){n._canInitEmulator=!1;const s=Object.assign(Object.assign({},KS),e);try{const a=new XS(n),l=await Promise.race([t(),a.promise]);a.clearNetworkTimeout();const d=await l.json();if("needConfirmation"in d)throw ou(n,"account-exists-with-different-credential",d);if(l.ok&&!("errorMessage"in d))return d;{const f=l.ok?d.errorMessage:d.error.message,[m,v]=f.split(" : ");if(m==="FEDERATED_USER_ID_ALREADY_LINKED")throw ou(n,"credential-already-in-use",d);if(m==="EMAIL_EXISTS")throw ou(n,"email-already-in-use",d);if(m==="USER_DISABLED")throw ou(n,"user-disabled",d);const w=s[m]||m.toLowerCase().replace(/[_\s]+/g,"-");if(v)throw qf(n,w,v);Yr(n,w)}}catch(a){if(a instanceof fi)throw a;Yr(n,"network-request-failed",{message:String(a)})}}async function Kl(n,e,t,s,a={}){const l=await Ms(n,e,t,s,a);return"mfaPendingCredential"in l&&Yr(n,"multi-factor-auth-required",{_serverResponse:l}),l}async function N_(n,e,t,s){const a=`${e}${t}?${s}`,l=n,d=l.config.emulator?Qf(n.config,a):`${n.config.apiScheme}://${a}`;return QS.includes(t)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(d).toString():d}function JS(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class XS{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,s)=>{this.timer=setTimeout(()=>s(ps(this.auth,"network-request-failed")),YS.get())})}}function ou(n,e,t){const s={appName:n.name};t.email&&(s.email=t.email),t.phoneNumber&&(s.phoneNumber=t.phoneNumber);const a=ps(n,e,s);return a.customData._tokenResponse=t,a}function Ey(n){return n!==void 0&&n.enterprise!==void 0}class ZS{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return JS(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function e1(n,e){return Ms(n,"GET","/v2/recaptchaConfig",ea(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function t1(n,e){return Ms(n,"POST","/v1/accounts:delete",e)}async function n1(n,e){return Ms(n,"POST","/v1/accounts:update",e)}async function Pu(n,e){return Ms(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Il(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function r1(n,e=!1){const t=nn(n),s=await t.getIdToken(e),a=Yf(s);Xe(a&&a.exp&&a.auth_time&&a.iat,t.auth,"internal-error");const l=typeof a.firebase=="object"?a.firebase:void 0,d=l==null?void 0:l.sign_in_provider;return{claims:a,token:s,authTime:Il(Jh(a.auth_time)),issuedAtTime:Il(Jh(a.iat)),expirationTime:Il(Jh(a.exp)),signInProvider:d||null,signInSecondFactor:(l==null?void 0:l.sign_in_second_factor)||null}}function Jh(n){return Number(n)*1e3}function Yf(n){const[e,t,s]=n.split(".");if(e===void 0||t===void 0||s===void 0)return fu("JWT malformed, contained fewer than 3 sections"),null;try{const a=f_(t);return a?JSON.parse(a):(fu("Failed to decode base64 JWT payload"),null)}catch(a){return fu("Caught error parsing JWT payload as JSON",a==null?void 0:a.toString()),null}}function Ty(n){const e=Yf(n);return Xe(e,"internal-error"),Xe(typeof e.exp<"u","internal-error"),Xe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function To(n,e,t=!1){if(t)return e;try{return await e}catch(s){throw s instanceof fi&&s1(s)&&n.auth.currentUser===n&&await n.auth.signOut(),s}}function s1({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i1{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const s=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),s}else{this.errorBackoff=3e4;const a=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,a)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gf{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Il(this.lastLoginAt),this.creationTime=Il(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vl(n){var e;const t=n.auth,s=await n.getIdToken(),a=await To(n,Pu(t,{idToken:s}));Xe(a==null?void 0:a.users.length,t,"internal-error");const l=a.users[0];n._notifyReloadListener(l);const d=!((e=l.providerUserInfo)===null||e===void 0)&&e.length?A_(l.providerUserInfo):[],f=o1(n.providerData,d),m=n.isAnonymous,v=!(n.email&&l.passwordHash)&&!(f!=null&&f.length),w=m?v:!1,T={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:f,metadata:new gf(l.createdAt,l.lastLoginAt),isAnonymous:w};Object.assign(n,T)}async function a1(n){const e=nn(n);await Vl(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function o1(n,e){return[...n.filter(s=>!e.some(a=>a.providerId===s.providerId)),...e]}function A_(n){return n.map(e=>{var{providerId:t}=e,s=Hf(e,["providerId"]);return{providerId:t,uid:s.rawId||"",displayName:s.displayName||null,email:s.email||null,phoneNumber:s.phoneNumber||null,photoURL:s.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function l1(n,e){const t=await R_(n,{},async()=>{const s=Hl({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:l}=n.config,d=await N_(n,a,"/v1/token",`key=${l}`),f=await n._getAdditionalHeaders();f["Content-Type"]="application/x-www-form-urlencoded";const m={method:"POST",headers:f,body:s};return n.emulatorConfig&&Ao(n.emulatorConfig.host)&&(m.credentials="include"),P_.fetch()(d,m)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function c1(n,e){return Ms(n,"POST","/v2/accounts:revokeToken",ea(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Xe(e.idToken,"internal-error"),Xe(typeof e.idToken<"u","internal-error"),Xe(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Ty(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Xe(e.length!==0,"internal-error");const t=Ty(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Xe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:s,refreshToken:a,expiresIn:l}=await l1(e,t);this.updateTokensAndExpiration(s,a,Number(l))}updateTokensAndExpiration(e,t,s){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,t){const{refreshToken:s,accessToken:a,expirationTime:l}=t,d=new vo;return s&&(Xe(typeof s=="string","internal-error",{appName:e}),d.refreshToken=s),a&&(Xe(typeof a=="string","internal-error",{appName:e}),d.accessToken=a),l&&(Xe(typeof l=="number","internal-error",{appName:e}),d.expirationTime=l),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new vo,this.toJSON())}_performRefresh(){return ni("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ai(n,e){Xe(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class fs{constructor(e){var{uid:t,auth:s,stsTokenManager:a}=e,l=Hf(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new i1(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=s,this.stsTokenManager=a,this.accessToken=a.accessToken,this.displayName=l.displayName||null,this.email=l.email||null,this.emailVerified=l.emailVerified||!1,this.phoneNumber=l.phoneNumber||null,this.photoURL=l.photoURL||null,this.isAnonymous=l.isAnonymous||!1,this.tenantId=l.tenantId||null,this.providerData=l.providerData?[...l.providerData]:[],this.metadata=new gf(l.createdAt||void 0,l.lastLoginAt||void 0)}async getIdToken(e){const t=await To(this,this.stsTokenManager.getToken(this.auth,e));return Xe(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return r1(this,e)}reload(){return a1(this)}_assign(e){this!==e&&(Xe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new fs(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Xe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),t&&await Vl(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(jr(this.auth.app))return Promise.reject(ii(this.auth));const e=await this.getIdToken();return await To(this,t1(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var s,a,l,d,f,m,v,w;const T=(s=t.displayName)!==null&&s!==void 0?s:void 0,I=(a=t.email)!==null&&a!==void 0?a:void 0,B=(l=t.phoneNumber)!==null&&l!==void 0?l:void 0,X=(d=t.photoURL)!==null&&d!==void 0?d:void 0,K=(f=t.tenantId)!==null&&f!==void 0?f:void 0,M=(m=t._redirectEventId)!==null&&m!==void 0?m:void 0,ne=(v=t.createdAt)!==null&&v!==void 0?v:void 0,be=(w=t.lastLoginAt)!==null&&w!==void 0?w:void 0,{uid:_e,emailVerified:we,isAnonymous:le,providerData:Ie,stsTokenManager:A}=t;Xe(_e&&A,e,"internal-error");const P=vo.fromJSON(this.name,A);Xe(typeof _e=="string",e,"internal-error"),Ai(T,e.name),Ai(I,e.name),Xe(typeof we=="boolean",e,"internal-error"),Xe(typeof le=="boolean",e,"internal-error"),Ai(B,e.name),Ai(X,e.name),Ai(K,e.name),Ai(M,e.name),Ai(ne,e.name),Ai(be,e.name);const R=new fs({uid:_e,auth:e,email:I,emailVerified:we,displayName:T,isAnonymous:le,photoURL:X,phoneNumber:B,tenantId:K,stsTokenManager:P,createdAt:ne,lastLoginAt:be});return Ie&&Array.isArray(Ie)&&(R.providerData=Ie.map(F=>Object.assign({},F))),M&&(R._redirectEventId=M),R}static async _fromIdTokenResponse(e,t,s=!1){const a=new vo;a.updateFromServerResponse(t);const l=new fs({uid:t.localId,auth:e,stsTokenManager:a,isAnonymous:s});return await Vl(l),l}static async _fromGetAccountInfoResponse(e,t,s){const a=t.users[0];Xe(a.localId!==void 0,"internal-error");const l=a.providerUserInfo!==void 0?A_(a.providerUserInfo):[],d=!(a.email&&a.passwordHash)&&!(l!=null&&l.length),f=new vo;f.updateFromIdToken(s);const m=new fs({uid:a.localId,auth:e,stsTokenManager:f,isAnonymous:d}),v={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new gf(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!(l!=null&&l.length)};return Object.assign(m,v),m}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sy=new Map;function ri(n){li(n instanceof Function,"Expected a class definition");let e=Sy.get(n);return e?(li(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Sy.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k_{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}k_.type="NONE";const Cy=k_;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pu(n,e,t){return`firebase:${n}:${e}:${t}`}class _o{constructor(e,t,s){this.persistence=e,this.auth=t,this.userKey=s;const{config:a,name:l}=this.auth;this.fullUserKey=pu(this.userKey,a.apiKey,l),this.fullPersistenceKey=pu("persistence",a.apiKey,l),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Pu(this.auth,{idToken:e}).catch(()=>{});return t?fs._fromGetAccountInfoResponse(this.auth,t,e):null}return fs._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,s="authUser"){if(!t.length)return new _o(ri(Cy),e,s);const a=(await Promise.all(t.map(async v=>{if(await v._isAvailable())return v}))).filter(v=>v);let l=a[0]||ri(Cy);const d=pu(s,e.config.apiKey,e.name);let f=null;for(const v of t)try{const w=await v._get(d);if(w){let T;if(typeof w=="string"){const I=await Pu(e,{idToken:w}).catch(()=>{});if(!I)break;T=await fs._fromGetAccountInfoResponse(e,I,w)}else T=fs._fromJSON(e,w);v!==l&&(f=T),l=v;break}}catch{}const m=a.filter(v=>v._shouldAllowMigration);return!l._shouldAllowMigration||!m.length?new _o(l,e,s):(l=m[0],f&&await l._set(d,f.toJSON()),await Promise.all(t.map(async v=>{if(v!==l)try{await v._remove(d)}catch{}})),new _o(l,e,s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iy(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(L_(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(j_(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(M_(e))return"Blackberry";if(F_(e))return"Webos";if(D_(e))return"Safari";if((e.includes("chrome/")||V_(e))&&!e.includes("edge/"))return"Chrome";if(O_(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=n.match(t);if((s==null?void 0:s.length)===2)return s[1]}return"Other"}function j_(n=Kn()){return/firefox\//i.test(n)}function D_(n=Kn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function V_(n=Kn()){return/crios\//i.test(n)}function L_(n=Kn()){return/iemobile/i.test(n)}function O_(n=Kn()){return/android/i.test(n)}function M_(n=Kn()){return/blackberry/i.test(n)}function F_(n=Kn()){return/webos/i.test(n)}function Jf(n=Kn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function u1(n=Kn()){var e;return Jf(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function d1(){return ET()&&document.documentMode===10}function U_(n=Kn()){return Jf(n)||O_(n)||F_(n)||M_(n)||/windows phone/i.test(n)||L_(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z_(n,e=[]){let t;switch(n){case"Browser":t=Iy(Kn());break;case"Worker":t=`${Iy(Kn())}-${n}`;break;default:t=n}const s=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${ko}/${s}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h1{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const s=l=>new Promise((d,f)=>{try{const m=e(l);d(m)}catch(m){f(m)}});s.onAbort=t,this.queue.push(s);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const s of this.queue)await s(e),s.onAbort&&t.push(s.onAbort)}catch(s){t.reverse();for(const a of t)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s==null?void 0:s.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function f1(n,e={}){return Ms(n,"GET","/v2/passwordPolicy",ea(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p1=6;class m1{constructor(e){var t,s,a,l;const d=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=d.minPasswordLength)!==null&&t!==void 0?t:p1,d.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=d.maxPasswordLength),d.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=d.containsLowercaseCharacter),d.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=d.containsUppercaseCharacter),d.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=d.containsNumericCharacter),d.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=d.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(a=(s=e.allowedNonAlphanumericCharacters)===null||s===void 0?void 0:s.join(""))!==null&&a!==void 0?a:"",this.forceUpgradeOnSignin=(l=e.forceUpgradeOnSignin)!==null&&l!==void 0?l:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,s,a,l,d,f;const m={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,m),this.validatePasswordCharacterOptions(e,m),m.isValid&&(m.isValid=(t=m.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),m.isValid&&(m.isValid=(s=m.meetsMaxPasswordLength)!==null&&s!==void 0?s:!0),m.isValid&&(m.isValid=(a=m.containsLowercaseLetter)!==null&&a!==void 0?a:!0),m.isValid&&(m.isValid=(l=m.containsUppercaseLetter)!==null&&l!==void 0?l:!0),m.isValid&&(m.isValid=(d=m.containsNumericCharacter)!==null&&d!==void 0?d:!0),m.isValid&&(m.isValid=(f=m.containsNonAlphanumericCharacter)!==null&&f!==void 0?f:!0),m}validatePasswordLengthOptions(e,t){const s=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;s&&(t.meetsMinPasswordLength=e.length>=s),a&&(t.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let s;for(let a=0;a<e.length;a++)s=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(t,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,t,s,a,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g1{constructor(e,t,s,a){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=s,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new by(this),this.idTokenSubscription=new by(this),this.beforeStateQueue=new h1(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=I_,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ri(t)),this._initializationPromise=this.queue(async()=>{var s,a,l;if(!this._deleted&&(this.persistenceManager=await _o.create(this,e),(s=this._resolvePersistenceManagerAvailable)===null||s===void 0||s.call(this),!this._deleted)){if(!((a=this._popupRedirectResolver)===null||a===void 0)&&a._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((l=this.currentUser)===null||l===void 0?void 0:l.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Pu(this,{idToken:e}),s=await fs._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(s)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(jr(this.app)){const d=this.app.settings.authIdToken;return d?new Promise(f=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(d).then(f,f))}):this.directlySetCurrentUser(null)}const s=await this.assertedPersistence.getCurrentUser();let a=s,l=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const d=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,f=a==null?void 0:a._redirectEventId,m=await this.tryRedirectSignIn(e);(!d||d===f)&&(m!=null&&m.user)&&(a=m.user,l=!0)}if(!a)return this.directlySetCurrentUser(null);if(!a._redirectEventId){if(l)try{await this.beforeStateQueue.runMiddleware(a)}catch(d){a=s,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(d))}return a?this.reloadAndSetCurrentUserOrClear(a):this.directlySetCurrentUser(null)}return Xe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===a._redirectEventId?this.directlySetCurrentUser(a):this.reloadAndSetCurrentUserOrClear(a)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Vl(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=qS()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(jr(this.app))return Promise.reject(ii(this));const t=e?nn(e):null;return t&&Xe(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Xe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return jr(this.app)?Promise.reject(ii(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return jr(this.app)?Promise.reject(ii(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ri(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await f1(this),t=new m1(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Gl("auth","Firebase",e())}onAuthStateChanged(e,t,s){return this.registerStateListener(this.authStateSubscription,e,t,s)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,s){return this.registerStateListener(this.idTokenSubscription,e,t,s)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(s.tenantId=this.tenantId),await c1(this,s)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const s=await this.getOrInitRedirectPersistenceManager(t);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&ri(e)||this._popupRedirectResolver;Xe(t,this,"argument-error"),this.redirectPersistenceManager=await _o.create(this,[ri(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,s;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((s=this.redirectUser)===null||s===void 0?void 0:s._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const s=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==s&&(this.lastNotifiedUid=s,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,s,a){if(this._deleted)return()=>{};const l=typeof t=="function"?t:t.next.bind(t);let d=!1;const f=this._isInitialized?Promise.resolve():this._initializationPromise;if(Xe(f,this,"internal-error"),f.then(()=>{d||l(this.currentUser)}),typeof t=="function"){const m=e.addObserver(t,s,a);return()=>{d=!0,m()}}else{const m=e.addObserver(t);return()=>{d=!0,m()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Xe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=z_(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const s=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());s&&(t["X-Firebase-Client"]=s);const a=await this._getAppCheckToken();return a&&(t["X-Firebase-AppCheck"]=a),t}async _getAppCheckToken(){var e;if(jr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&WS(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function ta(n){return nn(n)}class by{constructor(e){this.auth=e,this.observer=null,this.addObserver=NT(t=>this.observer=t)}get next(){return Xe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ku={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function y1(n){Ku=n}function B_(n){return Ku.loadJS(n)}function v1(){return Ku.recaptchaEnterpriseScript}function _1(){return Ku.gapiScript}function w1(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class x1{constructor(){this.enterprise=new E1}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class E1{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const T1="recaptcha-enterprise",$_="NO_RECAPTCHA";class S1{constructor(e){this.type=T1,this.auth=ta(e)}async verify(e="verify",t=!1){async function s(l){if(!t){if(l.tenantId==null&&l._agentRecaptchaConfig!=null)return l._agentRecaptchaConfig.siteKey;if(l.tenantId!=null&&l._tenantRecaptchaConfigs[l.tenantId]!==void 0)return l._tenantRecaptchaConfigs[l.tenantId].siteKey}return new Promise(async(d,f)=>{e1(l,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(m=>{if(m.recaptchaKey===void 0)f(new Error("recaptcha Enterprise site key undefined"));else{const v=new ZS(m);return l.tenantId==null?l._agentRecaptchaConfig=v:l._tenantRecaptchaConfigs[l.tenantId]=v,d(v.siteKey)}}).catch(m=>{f(m)})})}function a(l,d,f){const m=window.grecaptcha;Ey(m)?m.enterprise.ready(()=>{m.enterprise.execute(l,{action:e}).then(v=>{d(v)}).catch(()=>{d($_)})}):f(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new x1().execute("siteKey",{action:"verify"}):new Promise((l,d)=>{s(this.auth).then(f=>{if(!t&&Ey(window.grecaptcha))a(f,l,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let m=v1();m.length!==0&&(m+=f),B_(m).then(()=>{a(f,l,d)}).catch(v=>{d(v)})}}).catch(f=>{d(f)})})}}async function Py(n,e,t,s=!1,a=!1){const l=new S1(n);let d;if(a)d=$_;else try{d=await l.verify(t)}catch{d=await l.verify(t,!0)}const f=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in f){const m=f.phoneEnrollmentInfo.phoneNumber,v=f.phoneEnrollmentInfo.recaptchaToken;Object.assign(f,{phoneEnrollmentInfo:{phoneNumber:m,recaptchaToken:v,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in f){const m=f.phoneSignInInfo.recaptchaToken;Object.assign(f,{phoneSignInInfo:{recaptchaToken:m,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return f}return s?Object.assign(f,{captchaResp:d}):Object.assign(f,{captchaResponse:d}),Object.assign(f,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(f,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),f}async function yf(n,e,t,s,a){var l;if(!((l=n._getRecaptchaConfig())===null||l===void 0)&&l.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const d=await Py(n,e,t,t==="getOobCode");return s(n,d)}else return s(n,e).catch(async d=>{if(d.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const f=await Py(n,e,t,t==="getOobCode");return s(n,f)}else return Promise.reject(d)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C1(n,e){const t=Gf(n,"auth");if(t.isInitialized()){const a=t.getImmediate(),l=t.getOptions();if(Ia(l,e??{}))return a;Yr(a,"already-initialized")}return t.initialize({options:e})}function I1(n,e){const t=(e==null?void 0:e.persistence)||[],s=(Array.isArray(t)?t:[t]).map(ri);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(s,e==null?void 0:e.popupRedirectResolver)}function b1(n,e,t){const s=ta(n);Xe(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const a=!1,l=W_(e),{host:d,port:f}=P1(e),m=f===null?"":`:${f}`,v={url:`${l}//${d}${m}/`},w=Object.freeze({host:d,port:f,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!s._canInitEmulator){Xe(s.config.emulator&&s.emulatorConfig,s,"emulator-config-failed"),Xe(Ia(v,s.config.emulator)&&Ia(w,s.emulatorConfig),s,"emulator-config-failed");return}s.config.emulator=v,s.emulatorConfig=w,s.settings.appVerificationDisabledForTesting=!0,Ao(d)?(y_(`${l}//${d}${m}`),v_("Auth",!0)):R1()}function W_(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function P1(n){const e=W_(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const s=t[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(s);if(a){const l=a[1];return{host:l,port:Ry(s.substr(l.length+1))}}else{const[l,d]=s.split(":");return{host:l,port:Ry(d)}}}function Ry(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function R1(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xf{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ni("not implemented")}_getIdTokenResponse(e){return ni("not implemented")}_linkToIdToken(e,t){return ni("not implemented")}_getReauthenticationResolver(e){return ni("not implemented")}}async function N1(n,e){return Ms(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function A1(n,e){return Kl(n,"POST","/v1/accounts:signInWithPassword",ea(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function k1(n,e){return Kl(n,"POST","/v1/accounts:signInWithEmailLink",ea(n,e))}async function j1(n,e){return Kl(n,"POST","/v1/accounts:signInWithEmailLink",ea(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ll extends Xf{constructor(e,t,s,a=null){super("password",s),this._email=e,this._password=t,this._tenantId=a}static _fromEmailAndPassword(e,t){return new Ll(e,t,"password")}static _fromEmailAndCode(e,t,s=null){return new Ll(e,t,"emailLink",s)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return yf(e,t,"signInWithPassword",A1);case"emailLink":return k1(e,{email:this._email,oobCode:this._password});default:Yr(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const s={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return yf(e,s,"signUpPassword",N1);case"emailLink":return j1(e,{idToken:t,email:this._email,oobCode:this._password});default:Yr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wo(n,e){return Kl(n,"POST","/v1/accounts:signInWithIdp",ea(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D1="http://localhost";class ci extends Xf{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new ci(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Yr("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:a}=t,l=Hf(t,["providerId","signInMethod"]);if(!s||!a)return null;const d=new ci(s,a);return d.idToken=l.idToken||void 0,d.accessToken=l.accessToken||void 0,d.secret=l.secret,d.nonce=l.nonce,d.pendingToken=l.pendingToken||null,d}_getIdTokenResponse(e){const t=this.buildRequest();return wo(e,t)}_linkToIdToken(e,t){const s=this.buildRequest();return s.idToken=t,wo(e,s)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,wo(e,t)}buildRequest(){const e={requestUri:D1,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Hl(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V1(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function L1(n){const e=_l(wl(n)).link,t=e?_l(wl(e)).deep_link_id:null,s=_l(wl(n)).deep_link_id;return(s?_l(wl(s)).link:null)||s||t||e||n}class Zf{constructor(e){var t,s,a,l,d,f;const m=_l(wl(e)),v=(t=m.apiKey)!==null&&t!==void 0?t:null,w=(s=m.oobCode)!==null&&s!==void 0?s:null,T=V1((a=m.mode)!==null&&a!==void 0?a:null);Xe(v&&w&&T,"argument-error"),this.apiKey=v,this.operation=T,this.code=w,this.continueUrl=(l=m.continueUrl)!==null&&l!==void 0?l:null,this.languageCode=(d=m.lang)!==null&&d!==void 0?d:null,this.tenantId=(f=m.tenantId)!==null&&f!==void 0?f:null}static parseLink(e){const t=L1(e);try{return new Zf(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jo{constructor(){this.providerId=jo.PROVIDER_ID}static credential(e,t){return Ll._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const s=Zf.parseLink(t);return Xe(s,"argument-error"),Ll._fromEmailAndCode(e,s.code,s.tenantId)}}jo.PROVIDER_ID="password";jo.EMAIL_PASSWORD_SIGN_IN_METHOD="password";jo.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qu{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Do extends Qu{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class bl extends Do{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return Xe("providerId"in t&&"signInMethod"in t,"argument-error"),ci._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return Xe(e.idToken||e.accessToken,"argument-error"),ci._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return bl.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return bl.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:s,oauthTokenSecret:a,pendingToken:l,nonce:d,providerId:f}=e;if(!s&&!a&&!t&&!l||!f)return null;try{return new bl(f)._credential({idToken:t,accessToken:s,nonce:d,pendingToken:l})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ki extends Do{constructor(){super("facebook.com")}static credential(e){return ci._fromParams({providerId:ki.PROVIDER_ID,signInMethod:ki.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ki.credentialFromTaggedObject(e)}static credentialFromError(e){return ki.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ki.credential(e.oauthAccessToken)}catch{return null}}}ki.FACEBOOK_SIGN_IN_METHOD="facebook.com";ki.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hs extends Do{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return ci._fromParams({providerId:hs.PROVIDER_ID,signInMethod:hs.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return hs.credentialFromTaggedObject(e)}static credentialFromError(e){return hs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:s}=e;if(!t&&!s)return null;try{return hs.credential(t,s)}catch{return null}}}hs.GOOGLE_SIGN_IN_METHOD="google.com";hs.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ji extends Do{constructor(){super("github.com")}static credential(e){return ci._fromParams({providerId:ji.PROVIDER_ID,signInMethod:ji.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ji.credentialFromTaggedObject(e)}static credentialFromError(e){return ji.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ji.credential(e.oauthAccessToken)}catch{return null}}}ji.GITHUB_SIGN_IN_METHOD="github.com";ji.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Di extends Do{constructor(){super("twitter.com")}static credential(e,t){return ci._fromParams({providerId:Di.PROVIDER_ID,signInMethod:Di.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Di.credentialFromTaggedObject(e)}static credentialFromError(e){return Di.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:s}=e;if(!t||!s)return null;try{return Di.credential(t,s)}catch{return null}}}Di.TWITTER_SIGN_IN_METHOD="twitter.com";Di.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function O1(n,e){return Kl(n,"POST","/v1/accounts:signUp",ea(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pa{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,s,a=!1){const l=await fs._fromIdTokenResponse(e,s,a),d=Ny(s);return new Pa({user:l,providerId:d,_tokenResponse:s,operationType:t})}static async _forOperation(e,t,s){await e._updateTokensIfNecessary(s,!0);const a=Ny(s);return new Pa({user:e,providerId:a,_tokenResponse:s,operationType:t})}}function Ny(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ru extends fi{constructor(e,t,s,a){var l;super(t.code,t.message),this.operationType=s,this.user=a,Object.setPrototypeOf(this,Ru.prototype),this.customData={appName:e.name,tenantId:(l=e.tenantId)!==null&&l!==void 0?l:void 0,_serverResponse:t.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,t,s,a){return new Ru(e,t,s,a)}}function G_(n,e,t,s){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?Ru._fromErrorAndOperation(n,l,e,s):l})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H_(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function M1(n,e){const t=nn(n);await U1(!0,t,e);const{providerUserInfo:s}=await n1(t.auth,{idToken:await t.getIdToken(),deleteProvider:[e]}),a=H_(s||[]);return t.providerData=t.providerData.filter(l=>a.has(l.providerId)),a.has("phone")||(t.phoneNumber=null),await t.auth._persistUserIfCurrent(t),t}async function F1(n,e,t=!1){const s=await To(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Pa._forOperation(n,"link",s)}async function U1(n,e,t){await Vl(e);const s=H_(e.providerData);Xe(s.has(t)===n,e.auth,"no-such-provider")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function z1(n,e,t=!1){const{auth:s}=n;if(jr(s.app))return Promise.reject(ii(s));const a="reauthenticate";try{const l=await To(n,G_(s,a,e,n),t);Xe(l.idToken,s,"internal-error");const d=Yf(l.idToken);Xe(d,s,"internal-error");const{sub:f}=d;return Xe(n.uid===f,s,"user-mismatch"),Pa._forOperation(n,a,l)}catch(l){throw(l==null?void 0:l.code)==="auth/user-not-found"&&Yr(s,"user-mismatch"),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function q_(n,e,t=!1){if(jr(n.app))return Promise.reject(ii(n));const s="signIn",a=await G_(n,s,e),l=await Pa._fromIdTokenResponse(n,s,a);return t||await n._updateCurrentUser(l.user),l}async function B1(n,e){return q_(ta(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function K_(n){const e=ta(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function $1(n,e,t){if(jr(n.app))return Promise.reject(ii(n));const s=ta(n),d=await yf(s,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",O1).catch(m=>{throw m.code==="auth/password-does-not-meet-requirements"&&K_(n),m}),f=await Pa._fromIdTokenResponse(s,"signIn",d);return await s._updateCurrentUser(f.user),f}function Q_(n,e,t){return jr(n.app)?Promise.reject(ii(n)):B1(nn(n),jo.credential(e,t)).catch(async s=>{throw s.code==="auth/password-does-not-meet-requirements"&&K_(n),s})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function W1(n,e){return Ms(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function G1(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const s=nn(n),l={idToken:await s.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},d=await To(s,W1(s.auth,l));s.displayName=d.displayName||null,s.photoURL=d.photoUrl||null;const f=s.providerData.find(({providerId:m})=>m==="password");f&&(f.displayName=s.displayName,f.photoURL=s.photoURL),await s._updateTokensIfNecessary(d)}function H1(n,e,t,s){return nn(n).onIdTokenChanged(e,t,s)}function q1(n,e,t){return nn(n).beforeAuthStateChanged(e,t)}function K1(n,e,t,s){return nn(n).onAuthStateChanged(e,t,s)}function Y_(n){return nn(n).signOut()}const Nu="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J_{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Nu,"1"),this.storage.removeItem(Nu),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q1=1e3,Y1=10;class X_ extends J_{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=U_(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const s=this.storage.getItem(t),a=this.localCache[t];s!==a&&e(t,a,s)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((d,f,m)=>{this.notifyListeners(d,m)});return}const s=e.key;t?this.detachListener():this.stopPolling();const a=()=>{const d=this.storage.getItem(s);!t&&this.localCache[s]===d||this.notifyListeners(s,d)},l=this.storage.getItem(s);d1()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,Y1):a()}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const a of Array.from(s))a(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:s}),!0)})},Q1)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}X_.type="LOCAL";const J1=X_;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z_ extends J_{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Z_.type="SESSION";const e0=Z_;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X1(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yu{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(a=>a.isListeningto(e));if(t)return t;const s=new Yu(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:s,eventType:a,data:l}=t.data,d=this.handlersMap[a];if(!(d!=null&&d.size))return;t.ports[0].postMessage({status:"ack",eventId:s,eventType:a});const f=Array.from(d).map(async v=>v(t.origin,l)),m=await X1(f);t.ports[0].postMessage({status:"done",eventId:s,eventType:a,response:m})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Yu.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ep(n="",e=10){let t="";for(let s=0;s<e;s++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z1{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,s=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let l,d;return new Promise((f,m)=>{const v=ep("",20);a.port1.start();const w=setTimeout(()=>{m(new Error("unsupported_event"))},s);d={messageChannel:a,onMessage(T){const I=T;if(I.data.eventId===v)switch(I.data.status){case"ack":clearTimeout(w),l=setTimeout(()=>{m(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),f(I.data.response);break;default:clearTimeout(w),clearTimeout(l),m(new Error("invalid_response"));break}}},this.handlers.add(d),a.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:v,data:t},[a.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function As(){return window}function eC(n){As().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t0(){return typeof As().WorkerGlobalScope<"u"&&typeof As().importScripts=="function"}async function tC(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function nC(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function rC(){return t0()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n0="firebaseLocalStorageDb",sC=1,Au="firebaseLocalStorage",r0="fbase_key";class Ql{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Ju(n,e){return n.transaction([Au],e?"readwrite":"readonly").objectStore(Au)}function iC(){const n=indexedDB.deleteDatabase(n0);return new Ql(n).toPromise()}function vf(){const n=indexedDB.open(n0,sC);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const s=n.result;try{s.createObjectStore(Au,{keyPath:r0})}catch(a){t(a)}}),n.addEventListener("success",async()=>{const s=n.result;s.objectStoreNames.contains(Au)?e(s):(s.close(),await iC(),e(await vf()))})})}async function Ay(n,e,t){const s=Ju(n,!0).put({[r0]:e,value:t});return new Ql(s).toPromise()}async function aC(n,e){const t=Ju(n,!1).get(e),s=await new Ql(t).toPromise();return s===void 0?null:s.value}function ky(n,e){const t=Ju(n,!0).delete(e);return new Ql(t).toPromise()}const oC=800,lC=3;class s0{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await vf(),this.db)}async _withRetries(e){let t=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(t++>lC)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return t0()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Yu._getInstance(rC()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await tC(),!this.activeServiceWorker)return;this.sender=new Z1(this.activeServiceWorker);const s=await this.sender._send("ping",{},800);s&&!((e=s[0])===null||e===void 0)&&e.fulfilled&&!((t=s[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||nC()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await vf();return await Ay(e,Nu,"1"),await ky(e,Nu),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(s=>Ay(s,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(s=>aC(s,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>ky(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const l=Ju(a,!1).getAll();return new Ql(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],s=new Set;if(e.length!==0)for(const{fbase_key:a,value:l}of e)s.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(l)&&(this.notifyListeners(a,l),t.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!s.has(a)&&(this.notifyListeners(a,null),t.push(a));return t}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const a of Array.from(s))a(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),oC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}s0.type="LOCAL";const cC=s0;new ql(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tp(n,e){return e?ri(e):(Xe(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class np extends Xf{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return wo(e,this._buildIdpRequest())}_linkToIdToken(e,t){return wo(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return wo(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function uC(n){return q_(n.auth,new np(n),n.bypassAuthState)}function dC(n){const{auth:e,user:t}=n;return Xe(t,e,"internal-error"),z1(t,new np(n),n.bypassAuthState)}async function hC(n){const{auth:e,user:t}=n;return Xe(t,e,"internal-error"),F1(t,new np(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i0{constructor(e,t,s,a,l=!1){this.auth=e,this.resolver=s,this.user=a,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:s,postBody:a,tenantId:l,error:d,type:f}=e;if(d){this.reject(d);return}const m={auth:this.auth,requestUri:t,sessionId:s,tenantId:l||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(f)(m))}catch(v){this.reject(v)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return uC;case"linkViaPopup":case"linkViaRedirect":return hC;case"reauthViaPopup":case"reauthViaRedirect":return dC;default:Yr(this.auth,"internal-error")}}resolve(e){li(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){li(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fC=new ql(2e3,1e4);async function a0(n,e,t){if(jr(n.app))return Promise.reject(ps(n,"operation-not-supported-in-this-environment"));const s=ta(n);b_(n,e,Qu);const a=tp(s,t);return new Li(s,"signInViaPopup",e,a).executeNotNull()}async function jy(n,e,t){const s=nn(n);b_(s.auth,e,Qu);const a=tp(s.auth,t);return new Li(s.auth,"linkViaPopup",e,a,s).executeNotNull()}class Li extends i0{constructor(e,t,s,a,l){super(e,t,a,l),this.provider=s,this.authWindow=null,this.pollId=null,Li.currentPopupAction&&Li.currentPopupAction.cancel(),Li.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Xe(e,this.auth,"internal-error"),e}async onExecution(){li(this.filter.length===1,"Popup operations only handle one event");const e=ep();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(ps(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(ps(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Li.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,s;if(!((s=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||s===void 0)&&s.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ps(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,fC.get())};e()}}Li.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pC="pendingRedirect",mu=new Map;class mC extends i0{constructor(e,t,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,s),this.eventId=null}async execute(){let e=mu.get(this.auth._key());if(!e){try{const s=await gC(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(t){e=()=>Promise.reject(t)}mu.set(this.auth._key(),e)}return this.bypassAuthState||mu.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function gC(n,e){const t=_C(e),s=vC(n);if(!await s._isAvailable())return!1;const a=await s._get(t)==="true";return await s._remove(t),a}function yC(n,e){mu.set(n._key(),e)}function vC(n){return ri(n._redirectPersistence)}function _C(n){return pu(pC,n.config.apiKey,n.name)}async function wC(n,e,t=!1){if(jr(n.app))return Promise.reject(ii(n));const s=ta(n),a=tp(s,e),d=await new mC(s,a,t).execute();return d&&!t&&(delete d.user._redirectEventId,await s._persistUserIfCurrent(d.user),await s._setRedirectUser(null,e)),d}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xC=600*1e3;class EC{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(t=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!TC(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var s;if(e.error&&!o0(e)){const a=((s=e.error.code)===null||s===void 0?void 0:s.split("auth/")[1])||"internal-error";t.onError(ps(this.auth,a))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const s=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=xC&&this.cachedEventUids.clear(),this.cachedEventUids.has(Dy(e))}saveEventToCache(e){this.cachedEventUids.add(Dy(e)),this.lastProcessedEventTime=Date.now()}}function Dy(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function o0({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function TC(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return o0(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SC(n,e={}){return Ms(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CC=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,IC=/^https?/;async function bC(n){if(n.config.emulator)return;const{authorizedDomains:e}=await SC(n);for(const t of e)try{if(PC(t))return}catch{}Yr(n,"unauthorized-domain")}function PC(n){const e=mf(),{protocol:t,hostname:s}=new URL(e);if(n.startsWith("chrome-extension://")){const d=new URL(n);return d.hostname===""&&s===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&d.hostname===s}if(!IC.test(t))return!1;if(CC.test(n))return s===n;const a=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(s)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RC=new ql(3e4,6e4);function Vy(){const n=As().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function NC(n){return new Promise((e,t)=>{var s,a,l;function d(){Vy(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Vy(),t(ps(n,"network-request-failed"))},timeout:RC.get()})}if(!((a=(s=As().gapi)===null||s===void 0?void 0:s.iframes)===null||a===void 0)&&a.Iframe)e(gapi.iframes.getContext());else if(!((l=As().gapi)===null||l===void 0)&&l.load)d();else{const f=w1("iframefcb");return As()[f]=()=>{gapi.load?d():t(ps(n,"network-request-failed"))},B_(`${_1()}?onload=${f}`).catch(m=>t(m))}}).catch(e=>{throw gu=null,e})}let gu=null;function AC(n){return gu=gu||NC(n),gu}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kC=new ql(5e3,15e3),jC="__/auth/iframe",DC="emulator/auth/iframe",VC={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},LC=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function OC(n){const e=n.config;Xe(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Qf(e,DC):`https://${n.config.authDomain}/${jC}`,s={apiKey:e.apiKey,appName:n.name,v:ko},a=LC.get(n.config.apiHost);a&&(s.eid=a);const l=n._getFrameworks();return l.length&&(s.fw=l.join(",")),`${t}?${Hl(s).slice(1)}`}async function MC(n){const e=await AC(n),t=As().gapi;return Xe(t,n,"internal-error"),e.open({where:document.body,url:OC(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:VC,dontclear:!0},s=>new Promise(async(a,l)=>{await s.restyle({setHideOnLeave:!1});const d=ps(n,"network-request-failed"),f=As().setTimeout(()=>{l(d)},kC.get());function m(){As().clearTimeout(f),a(s)}s.ping(m).then(m,()=>{l(d)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FC={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},UC=500,zC=600,BC="_blank",$C="http://localhost";class Ly{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function WC(n,e,t,s=UC,a=zC){const l=Math.max((window.screen.availHeight-a)/2,0).toString(),d=Math.max((window.screen.availWidth-s)/2,0).toString();let f="";const m=Object.assign(Object.assign({},FC),{width:s.toString(),height:a.toString(),top:l,left:d}),v=Kn().toLowerCase();t&&(f=V_(v)?BC:t),j_(v)&&(e=e||$C,m.scrollbars="yes");const w=Object.entries(m).reduce((I,[B,X])=>`${I}${B}=${X},`,"");if(u1(v)&&f!=="_self")return GC(e||"",f),new Ly(null);const T=window.open(e||"",f,w);Xe(T,n,"popup-blocked");try{T.focus()}catch{}return new Ly(T)}function GC(n,e){const t=document.createElement("a");t.href=n,t.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HC="__/auth/handler",qC="emulator/auth/handler",KC=encodeURIComponent("fac");async function Oy(n,e,t,s,a,l){Xe(n.config.authDomain,n,"auth-domain-config-required"),Xe(n.config.apiKey,n,"invalid-api-key");const d={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:s,v:ko,eventId:a};if(e instanceof Qu){e.setDefaultLanguage(n.languageCode),d.providerId=e.providerId||"",RT(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[w,T]of Object.entries({}))d[w]=T}if(e instanceof Do){const w=e.getScopes().filter(T=>T!=="");w.length>0&&(d.scopes=w.join(","))}n.tenantId&&(d.tid=n.tenantId);const f=d;for(const w of Object.keys(f))f[w]===void 0&&delete f[w];const m=await n._getAppCheckToken(),v=m?`#${KC}=${encodeURIComponent(m)}`:"";return`${QC(n)}?${Hl(f).slice(1)}${v}`}function QC({config:n}){return n.emulator?Qf(n,qC):`https://${n.authDomain}/${HC}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xh="webStorageSupport";class YC{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=e0,this._completeRedirectFn=wC,this._overrideRedirectResult=yC}async _openPopup(e,t,s,a){var l;li((l=this.eventManagers[e._key()])===null||l===void 0?void 0:l.manager,"_initialize() not called before _openPopup()");const d=await Oy(e,t,s,mf(),a);return WC(e,d,ep())}async _openRedirect(e,t,s,a){await this._originValidation(e);const l=await Oy(e,t,s,mf(),a);return eC(l),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:a,promise:l}=this.eventManagers[t];return a?Promise.resolve(a):(li(l,"If manager is not set, promise should be"),l)}const s=this.initAndGetManager(e);return this.eventManagers[t]={promise:s},s.catch(()=>{delete this.eventManagers[t]}),s}async initAndGetManager(e){const t=await MC(e),s=new EC(e);return t.register("authEvent",a=>(Xe(a==null?void 0:a.authEvent,e,"invalid-auth-event"),{status:s.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=t,s}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Xh,{type:Xh},a=>{var l;const d=(l=a==null?void 0:a[0])===null||l===void 0?void 0:l[Xh];d!==void 0&&t(!!d),Yr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=bC(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return U_()||D_()||Jf()}}const JC=YC;var My="@firebase/auth",Fy="1.10.8";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XC{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(s=>{e((s==null?void 0:s.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Xe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZC(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function eI(n){Eo(new ba("auth",(e,{options:t})=>{const s=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:d,authDomain:f}=s.options;Xe(d&&!d.includes(":"),"invalid-api-key",{appName:s.name});const m={apiKey:d,authDomain:f,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:z_(n)},v=new g1(s,a,l,m);return I1(v,t),v},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,s)=>{e.getProvider("auth-internal").initialize()})),Eo(new ba("auth-internal",e=>{const t=ta(e.getProvider("auth").getImmediate());return(s=>new XC(s))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),zi(My,Fy,ZC(n)),zi(My,Fy,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tI=300,nI=g_("authIdTokenMaxAge")||tI;let Uy=null;const rI=n=>async e=>{const t=e&&await e.getIdTokenResult(),s=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(s&&s>nI)return;const a=t==null?void 0:t.token;Uy!==a&&(Uy=a,await fetch(n,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function sI(n=E_()){const e=Gf(n,"auth");if(e.isInitialized())return e.getImmediate();const t=C1(n,{popupRedirectResolver:JC,persistence:[cC,J1,e0]}),s=g_("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const l=new URL(s,location.origin);if(location.origin===l.origin){const d=rI(l.toString());q1(t,d,()=>d(t.currentUser)),H1(t,f=>d(f))}}const a=p_("auth");return a&&b1(t,`http://${a}`),t}function iI(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}y1({loadJS(n){return new Promise((e,t)=>{const s=document.createElement("script");s.setAttribute("src",n),s.onload=e,s.onerror=a=>{const l=ps("internal-error");l.customData=a,t(l)},s.type="text/javascript",s.charset="UTF-8",iI().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});eI("Browser");var zy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Bi,l0;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(A,P){function R(){}R.prototype=P.prototype,A.D=P.prototype,A.prototype=new R,A.prototype.constructor=A,A.C=function(F,z,L){for(var b=Array(arguments.length-2),he=2;he<arguments.length;he++)b[he-2]=arguments[he];return P.prototype[z].apply(F,b)}}function t(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(s,t),s.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(A,P,R){R||(R=0);var F=Array(16);if(typeof P=="string")for(var z=0;16>z;++z)F[z]=P.charCodeAt(R++)|P.charCodeAt(R++)<<8|P.charCodeAt(R++)<<16|P.charCodeAt(R++)<<24;else for(z=0;16>z;++z)F[z]=P[R++]|P[R++]<<8|P[R++]<<16|P[R++]<<24;P=A.g[0],R=A.g[1],z=A.g[2];var L=A.g[3],b=P+(L^R&(z^L))+F[0]+3614090360&4294967295;P=R+(b<<7&4294967295|b>>>25),b=L+(z^P&(R^z))+F[1]+3905402710&4294967295,L=P+(b<<12&4294967295|b>>>20),b=z+(R^L&(P^R))+F[2]+606105819&4294967295,z=L+(b<<17&4294967295|b>>>15),b=R+(P^z&(L^P))+F[3]+3250441966&4294967295,R=z+(b<<22&4294967295|b>>>10),b=P+(L^R&(z^L))+F[4]+4118548399&4294967295,P=R+(b<<7&4294967295|b>>>25),b=L+(z^P&(R^z))+F[5]+1200080426&4294967295,L=P+(b<<12&4294967295|b>>>20),b=z+(R^L&(P^R))+F[6]+2821735955&4294967295,z=L+(b<<17&4294967295|b>>>15),b=R+(P^z&(L^P))+F[7]+4249261313&4294967295,R=z+(b<<22&4294967295|b>>>10),b=P+(L^R&(z^L))+F[8]+1770035416&4294967295,P=R+(b<<7&4294967295|b>>>25),b=L+(z^P&(R^z))+F[9]+2336552879&4294967295,L=P+(b<<12&4294967295|b>>>20),b=z+(R^L&(P^R))+F[10]+4294925233&4294967295,z=L+(b<<17&4294967295|b>>>15),b=R+(P^z&(L^P))+F[11]+2304563134&4294967295,R=z+(b<<22&4294967295|b>>>10),b=P+(L^R&(z^L))+F[12]+1804603682&4294967295,P=R+(b<<7&4294967295|b>>>25),b=L+(z^P&(R^z))+F[13]+4254626195&4294967295,L=P+(b<<12&4294967295|b>>>20),b=z+(R^L&(P^R))+F[14]+2792965006&4294967295,z=L+(b<<17&4294967295|b>>>15),b=R+(P^z&(L^P))+F[15]+1236535329&4294967295,R=z+(b<<22&4294967295|b>>>10),b=P+(z^L&(R^z))+F[1]+4129170786&4294967295,P=R+(b<<5&4294967295|b>>>27),b=L+(R^z&(P^R))+F[6]+3225465664&4294967295,L=P+(b<<9&4294967295|b>>>23),b=z+(P^R&(L^P))+F[11]+643717713&4294967295,z=L+(b<<14&4294967295|b>>>18),b=R+(L^P&(z^L))+F[0]+3921069994&4294967295,R=z+(b<<20&4294967295|b>>>12),b=P+(z^L&(R^z))+F[5]+3593408605&4294967295,P=R+(b<<5&4294967295|b>>>27),b=L+(R^z&(P^R))+F[10]+38016083&4294967295,L=P+(b<<9&4294967295|b>>>23),b=z+(P^R&(L^P))+F[15]+3634488961&4294967295,z=L+(b<<14&4294967295|b>>>18),b=R+(L^P&(z^L))+F[4]+3889429448&4294967295,R=z+(b<<20&4294967295|b>>>12),b=P+(z^L&(R^z))+F[9]+568446438&4294967295,P=R+(b<<5&4294967295|b>>>27),b=L+(R^z&(P^R))+F[14]+3275163606&4294967295,L=P+(b<<9&4294967295|b>>>23),b=z+(P^R&(L^P))+F[3]+4107603335&4294967295,z=L+(b<<14&4294967295|b>>>18),b=R+(L^P&(z^L))+F[8]+1163531501&4294967295,R=z+(b<<20&4294967295|b>>>12),b=P+(z^L&(R^z))+F[13]+2850285829&4294967295,P=R+(b<<5&4294967295|b>>>27),b=L+(R^z&(P^R))+F[2]+4243563512&4294967295,L=P+(b<<9&4294967295|b>>>23),b=z+(P^R&(L^P))+F[7]+1735328473&4294967295,z=L+(b<<14&4294967295|b>>>18),b=R+(L^P&(z^L))+F[12]+2368359562&4294967295,R=z+(b<<20&4294967295|b>>>12),b=P+(R^z^L)+F[5]+4294588738&4294967295,P=R+(b<<4&4294967295|b>>>28),b=L+(P^R^z)+F[8]+2272392833&4294967295,L=P+(b<<11&4294967295|b>>>21),b=z+(L^P^R)+F[11]+1839030562&4294967295,z=L+(b<<16&4294967295|b>>>16),b=R+(z^L^P)+F[14]+4259657740&4294967295,R=z+(b<<23&4294967295|b>>>9),b=P+(R^z^L)+F[1]+2763975236&4294967295,P=R+(b<<4&4294967295|b>>>28),b=L+(P^R^z)+F[4]+1272893353&4294967295,L=P+(b<<11&4294967295|b>>>21),b=z+(L^P^R)+F[7]+4139469664&4294967295,z=L+(b<<16&4294967295|b>>>16),b=R+(z^L^P)+F[10]+3200236656&4294967295,R=z+(b<<23&4294967295|b>>>9),b=P+(R^z^L)+F[13]+681279174&4294967295,P=R+(b<<4&4294967295|b>>>28),b=L+(P^R^z)+F[0]+3936430074&4294967295,L=P+(b<<11&4294967295|b>>>21),b=z+(L^P^R)+F[3]+3572445317&4294967295,z=L+(b<<16&4294967295|b>>>16),b=R+(z^L^P)+F[6]+76029189&4294967295,R=z+(b<<23&4294967295|b>>>9),b=P+(R^z^L)+F[9]+3654602809&4294967295,P=R+(b<<4&4294967295|b>>>28),b=L+(P^R^z)+F[12]+3873151461&4294967295,L=P+(b<<11&4294967295|b>>>21),b=z+(L^P^R)+F[15]+530742520&4294967295,z=L+(b<<16&4294967295|b>>>16),b=R+(z^L^P)+F[2]+3299628645&4294967295,R=z+(b<<23&4294967295|b>>>9),b=P+(z^(R|~L))+F[0]+4096336452&4294967295,P=R+(b<<6&4294967295|b>>>26),b=L+(R^(P|~z))+F[7]+1126891415&4294967295,L=P+(b<<10&4294967295|b>>>22),b=z+(P^(L|~R))+F[14]+2878612391&4294967295,z=L+(b<<15&4294967295|b>>>17),b=R+(L^(z|~P))+F[5]+4237533241&4294967295,R=z+(b<<21&4294967295|b>>>11),b=P+(z^(R|~L))+F[12]+1700485571&4294967295,P=R+(b<<6&4294967295|b>>>26),b=L+(R^(P|~z))+F[3]+2399980690&4294967295,L=P+(b<<10&4294967295|b>>>22),b=z+(P^(L|~R))+F[10]+4293915773&4294967295,z=L+(b<<15&4294967295|b>>>17),b=R+(L^(z|~P))+F[1]+2240044497&4294967295,R=z+(b<<21&4294967295|b>>>11),b=P+(z^(R|~L))+F[8]+1873313359&4294967295,P=R+(b<<6&4294967295|b>>>26),b=L+(R^(P|~z))+F[15]+4264355552&4294967295,L=P+(b<<10&4294967295|b>>>22),b=z+(P^(L|~R))+F[6]+2734768916&4294967295,z=L+(b<<15&4294967295|b>>>17),b=R+(L^(z|~P))+F[13]+1309151649&4294967295,R=z+(b<<21&4294967295|b>>>11),b=P+(z^(R|~L))+F[4]+4149444226&4294967295,P=R+(b<<6&4294967295|b>>>26),b=L+(R^(P|~z))+F[11]+3174756917&4294967295,L=P+(b<<10&4294967295|b>>>22),b=z+(P^(L|~R))+F[2]+718787259&4294967295,z=L+(b<<15&4294967295|b>>>17),b=R+(L^(z|~P))+F[9]+3951481745&4294967295,A.g[0]=A.g[0]+P&4294967295,A.g[1]=A.g[1]+(z+(b<<21&4294967295|b>>>11))&4294967295,A.g[2]=A.g[2]+z&4294967295,A.g[3]=A.g[3]+L&4294967295}s.prototype.u=function(A,P){P===void 0&&(P=A.length);for(var R=P-this.blockSize,F=this.B,z=this.h,L=0;L<P;){if(z==0)for(;L<=R;)a(this,A,L),L+=this.blockSize;if(typeof A=="string"){for(;L<P;)if(F[z++]=A.charCodeAt(L++),z==this.blockSize){a(this,F),z=0;break}}else for(;L<P;)if(F[z++]=A[L++],z==this.blockSize){a(this,F),z=0;break}}this.h=z,this.o+=P},s.prototype.v=function(){var A=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);A[0]=128;for(var P=1;P<A.length-8;++P)A[P]=0;var R=8*this.o;for(P=A.length-8;P<A.length;++P)A[P]=R&255,R/=256;for(this.u(A),A=Array(16),P=R=0;4>P;++P)for(var F=0;32>F;F+=8)A[R++]=this.g[P]>>>F&255;return A};function l(A,P){var R=f;return Object.prototype.hasOwnProperty.call(R,A)?R[A]:R[A]=P(A)}function d(A,P){this.h=P;for(var R=[],F=!0,z=A.length-1;0<=z;z--){var L=A[z]|0;F&&L==P||(R[z]=L,F=!1)}this.g=R}var f={};function m(A){return-128<=A&&128>A?l(A,function(P){return new d([P|0],0>P?-1:0)}):new d([A|0],0>A?-1:0)}function v(A){if(isNaN(A)||!isFinite(A))return T;if(0>A)return M(v(-A));for(var P=[],R=1,F=0;A>=R;F++)P[F]=A/R|0,R*=4294967296;return new d(P,0)}function w(A,P){if(A.length==0)throw Error("number format error: empty string");if(P=P||10,2>P||36<P)throw Error("radix out of range: "+P);if(A.charAt(0)=="-")return M(w(A.substring(1),P));if(0<=A.indexOf("-"))throw Error('number format error: interior "-" character');for(var R=v(Math.pow(P,8)),F=T,z=0;z<A.length;z+=8){var L=Math.min(8,A.length-z),b=parseInt(A.substring(z,z+L),P);8>L?(L=v(Math.pow(P,L)),F=F.j(L).add(v(b))):(F=F.j(R),F=F.add(v(b)))}return F}var T=m(0),I=m(1),B=m(16777216);n=d.prototype,n.m=function(){if(K(this))return-M(this).m();for(var A=0,P=1,R=0;R<this.g.length;R++){var F=this.i(R);A+=(0<=F?F:4294967296+F)*P,P*=4294967296}return A},n.toString=function(A){if(A=A||10,2>A||36<A)throw Error("radix out of range: "+A);if(X(this))return"0";if(K(this))return"-"+M(this).toString(A);for(var P=v(Math.pow(A,6)),R=this,F="";;){var z=we(R,P).g;R=ne(R,z.j(P));var L=((0<R.g.length?R.g[0]:R.h)>>>0).toString(A);if(R=z,X(R))return L+F;for(;6>L.length;)L="0"+L;F=L+F}},n.i=function(A){return 0>A?0:A<this.g.length?this.g[A]:this.h};function X(A){if(A.h!=0)return!1;for(var P=0;P<A.g.length;P++)if(A.g[P]!=0)return!1;return!0}function K(A){return A.h==-1}n.l=function(A){return A=ne(this,A),K(A)?-1:X(A)?0:1};function M(A){for(var P=A.g.length,R=[],F=0;F<P;F++)R[F]=~A.g[F];return new d(R,~A.h).add(I)}n.abs=function(){return K(this)?M(this):this},n.add=function(A){for(var P=Math.max(this.g.length,A.g.length),R=[],F=0,z=0;z<=P;z++){var L=F+(this.i(z)&65535)+(A.i(z)&65535),b=(L>>>16)+(this.i(z)>>>16)+(A.i(z)>>>16);F=b>>>16,L&=65535,b&=65535,R[z]=b<<16|L}return new d(R,R[R.length-1]&-2147483648?-1:0)};function ne(A,P){return A.add(M(P))}n.j=function(A){if(X(this)||X(A))return T;if(K(this))return K(A)?M(this).j(M(A)):M(M(this).j(A));if(K(A))return M(this.j(M(A)));if(0>this.l(B)&&0>A.l(B))return v(this.m()*A.m());for(var P=this.g.length+A.g.length,R=[],F=0;F<2*P;F++)R[F]=0;for(F=0;F<this.g.length;F++)for(var z=0;z<A.g.length;z++){var L=this.i(F)>>>16,b=this.i(F)&65535,he=A.i(z)>>>16,xe=A.i(z)&65535;R[2*F+2*z]+=b*xe,be(R,2*F+2*z),R[2*F+2*z+1]+=L*xe,be(R,2*F+2*z+1),R[2*F+2*z+1]+=b*he,be(R,2*F+2*z+1),R[2*F+2*z+2]+=L*he,be(R,2*F+2*z+2)}for(F=0;F<P;F++)R[F]=R[2*F+1]<<16|R[2*F];for(F=P;F<2*P;F++)R[F]=0;return new d(R,0)};function be(A,P){for(;(A[P]&65535)!=A[P];)A[P+1]+=A[P]>>>16,A[P]&=65535,P++}function _e(A,P){this.g=A,this.h=P}function we(A,P){if(X(P))throw Error("division by zero");if(X(A))return new _e(T,T);if(K(A))return P=we(M(A),P),new _e(M(P.g),M(P.h));if(K(P))return P=we(A,M(P)),new _e(M(P.g),P.h);if(30<A.g.length){if(K(A)||K(P))throw Error("slowDivide_ only works with positive integers.");for(var R=I,F=P;0>=F.l(A);)R=le(R),F=le(F);var z=Ie(R,1),L=Ie(F,1);for(F=Ie(F,2),R=Ie(R,2);!X(F);){var b=L.add(F);0>=b.l(A)&&(z=z.add(R),L=b),F=Ie(F,1),R=Ie(R,1)}return P=ne(A,z.j(P)),new _e(z,P)}for(z=T;0<=A.l(P);){for(R=Math.max(1,Math.floor(A.m()/P.m())),F=Math.ceil(Math.log(R)/Math.LN2),F=48>=F?1:Math.pow(2,F-48),L=v(R),b=L.j(P);K(b)||0<b.l(A);)R-=F,L=v(R),b=L.j(P);X(L)&&(L=I),z=z.add(L),A=ne(A,b)}return new _e(z,A)}n.A=function(A){return we(this,A).h},n.and=function(A){for(var P=Math.max(this.g.length,A.g.length),R=[],F=0;F<P;F++)R[F]=this.i(F)&A.i(F);return new d(R,this.h&A.h)},n.or=function(A){for(var P=Math.max(this.g.length,A.g.length),R=[],F=0;F<P;F++)R[F]=this.i(F)|A.i(F);return new d(R,this.h|A.h)},n.xor=function(A){for(var P=Math.max(this.g.length,A.g.length),R=[],F=0;F<P;F++)R[F]=this.i(F)^A.i(F);return new d(R,this.h^A.h)};function le(A){for(var P=A.g.length+1,R=[],F=0;F<P;F++)R[F]=A.i(F)<<1|A.i(F-1)>>>31;return new d(R,A.h)}function Ie(A,P){var R=P>>5;P%=32;for(var F=A.g.length-R,z=[],L=0;L<F;L++)z[L]=0<P?A.i(L+R)>>>P|A.i(L+R+1)<<32-P:A.i(L+R);return new d(z,A.h)}s.prototype.digest=s.prototype.v,s.prototype.reset=s.prototype.s,s.prototype.update=s.prototype.u,l0=s,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.A,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=v,d.fromString=w,Bi=d}).apply(typeof zy<"u"?zy:typeof self<"u"?self:typeof window<"u"?window:{});var lu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var c0,xl,u0,yu,_f,d0,h0,f0;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,g,_){return u==Array.prototype||u==Object.prototype||(u[g]=_.value),u};function t(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof lu=="object"&&lu];for(var g=0;g<u.length;++g){var _=u[g];if(_&&_.Math==Math)return _}throw Error("Cannot find global object")}var s=t(this);function a(u,g){if(g)e:{var _=s;u=u.split(".");for(var C=0;C<u.length-1;C++){var Q=u[C];if(!(Q in _))break e;_=_[Q]}u=u[u.length-1],C=_[u],g=g(C),g!=C&&g!=null&&e(_,u,{configurable:!0,writable:!0,value:g})}}function l(u,g){u instanceof String&&(u+="");var _=0,C=!1,Q={next:function(){if(!C&&_<u.length){var re=_++;return{value:g(re,u[re]),done:!1}}return C=!0,{done:!0,value:void 0}}};return Q[Symbol.iterator]=function(){return Q},Q}a("Array.prototype.values",function(u){return u||function(){return l(this,function(g,_){return _})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var d=d||{},f=this||self;function m(u){var g=typeof u;return g=g!="object"?g:u?Array.isArray(u)?"array":g:"null",g=="array"||g=="object"&&typeof u.length=="number"}function v(u){var g=typeof u;return g=="object"&&u!=null||g=="function"}function w(u,g,_){return u.call.apply(u.bind,arguments)}function T(u,g,_){if(!u)throw Error();if(2<arguments.length){var C=Array.prototype.slice.call(arguments,2);return function(){var Q=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Q,C),u.apply(g,Q)}}return function(){return u.apply(g,arguments)}}function I(u,g,_){return I=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?w:T,I.apply(null,arguments)}function B(u,g){var _=Array.prototype.slice.call(arguments,1);return function(){var C=_.slice();return C.push.apply(C,arguments),u.apply(this,C)}}function X(u,g){function _(){}_.prototype=g.prototype,u.aa=g.prototype,u.prototype=new _,u.prototype.constructor=u,u.Qb=function(C,Q,re){for(var Re=Array(arguments.length-2),Nt=2;Nt<arguments.length;Nt++)Re[Nt-2]=arguments[Nt];return g.prototype[Q].apply(C,Re)}}function K(u){const g=u.length;if(0<g){const _=Array(g);for(let C=0;C<g;C++)_[C]=u[C];return _}return[]}function M(u,g){for(let _=1;_<arguments.length;_++){const C=arguments[_];if(m(C)){const Q=u.length||0,re=C.length||0;u.length=Q+re;for(let Re=0;Re<re;Re++)u[Q+Re]=C[Re]}else u.push(C)}}class ne{constructor(g,_){this.i=g,this.j=_,this.h=0,this.g=null}get(){let g;return 0<this.h?(this.h--,g=this.g,this.g=g.next,g.next=null):g=this.i(),g}}function be(u){return/^[\s\xa0]*$/.test(u)}function _e(){var u=f.navigator;return u&&(u=u.userAgent)?u:""}function we(u){return we[" "](u),u}we[" "]=function(){};var le=_e().indexOf("Gecko")!=-1&&!(_e().toLowerCase().indexOf("webkit")!=-1&&_e().indexOf("Edge")==-1)&&!(_e().indexOf("Trident")!=-1||_e().indexOf("MSIE")!=-1)&&_e().indexOf("Edge")==-1;function Ie(u,g,_){for(const C in u)g.call(_,u[C],C,u)}function A(u,g){for(const _ in u)g.call(void 0,u[_],_,u)}function P(u){const g={};for(const _ in u)g[_]=u[_];return g}const R="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function F(u,g){let _,C;for(let Q=1;Q<arguments.length;Q++){C=arguments[Q];for(_ in C)u[_]=C[_];for(let re=0;re<R.length;re++)_=R[re],Object.prototype.hasOwnProperty.call(C,_)&&(u[_]=C[_])}}function z(u){var g=1;u=u.split(":");const _=[];for(;0<g&&u.length;)_.push(u.shift()),g--;return u.length&&_.push(u.join(":")),_}function L(u){f.setTimeout(()=>{throw u},0)}function b(){var u=je;let g=null;return u.g&&(g=u.g,u.g=u.g.next,u.g||(u.h=null),g.next=null),g}class he{constructor(){this.h=this.g=null}add(g,_){const C=xe.get();C.set(g,_),this.h?this.h.next=C:this.g=C,this.h=C}}var xe=new ne(()=>new ut,u=>u.reset());class ut{constructor(){this.next=this.g=this.h=null}set(g,_){this.h=g,this.g=_,this.next=null}reset(){this.next=this.g=this.h=null}}let Be,ye=!1,je=new he,Pe=()=>{const u=f.Promise.resolve(void 0);Be=()=>{u.then(D)}};var D=()=>{for(var u;u=b();){try{u.h.call(u.g)}catch(_){L(_)}var g=xe;g.j(u),100>g.h&&(g.h++,u.next=g.g,g.g=u)}ye=!1};function N(){this.s=this.s,this.C=this.C}N.prototype.s=!1,N.prototype.ma=function(){this.s||(this.s=!0,this.N())},N.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function se(u,g){this.type=u,this.g=this.target=g,this.defaultPrevented=!1}se.prototype.h=function(){this.defaultPrevented=!0};var te=(function(){if(!f.addEventListener||!Object.defineProperty)return!1;var u=!1,g=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const _=()=>{};f.addEventListener("test",_,g),f.removeEventListener("test",_,g)}catch{}return u})();function Ee(u,g){if(se.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var _=this.type=u.type,C=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=g,g=u.relatedTarget){if(le){e:{try{we(g.nodeName);var Q=!0;break e}catch{}Q=!1}Q||(g=null)}}else _=="mouseover"?g=u.fromElement:_=="mouseout"&&(g=u.toElement);this.relatedTarget=g,C?(this.clientX=C.clientX!==void 0?C.clientX:C.pageX,this.clientY=C.clientY!==void 0?C.clientY:C.pageY,this.screenX=C.screenX||0,this.screenY=C.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:ve[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&Ee.aa.h.call(this)}}X(Ee,se);var ve={2:"touch",3:"pen",4:"mouse"};Ee.prototype.h=function(){Ee.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var Me="closure_listenable_"+(1e6*Math.random()|0),He=0;function et(u,g,_,C,Q){this.listener=u,this.proxy=null,this.src=g,this.type=_,this.capture=!!C,this.ha=Q,this.key=++He,this.da=this.fa=!1}function xt(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function J(u){this.src=u,this.g={},this.h=0}J.prototype.add=function(u,g,_,C,Q){var re=u.toString();u=this.g[re],u||(u=this.g[re]=[],this.h++);var Re=Ve(u,g,C,Q);return-1<Re?(g=u[Re],_||(g.fa=!1)):(g=new et(g,this.src,re,!!C,Q),g.fa=_,u.push(g)),g};function $e(u,g){var _=g.type;if(_ in u.g){var C=u.g[_],Q=Array.prototype.indexOf.call(C,g,void 0),re;(re=0<=Q)&&Array.prototype.splice.call(C,Q,1),re&&(xt(g),u.g[_].length==0&&(delete u.g[_],u.h--))}}function Ve(u,g,_,C){for(var Q=0;Q<u.length;++Q){var re=u[Q];if(!re.da&&re.listener==g&&re.capture==!!_&&re.ha==C)return Q}return-1}var Ke="closure_lm_"+(1e6*Math.random()|0),Et={};function Tt(u,g,_,C,Q){if(Array.isArray(g)){for(var re=0;re<g.length;re++)Tt(u,g[re],_,C,Q);return null}return _=Jn(_),u&&u[Me]?u.K(g,_,v(C)?!!C.capture:!1,Q):_t(u,g,_,!1,C,Q)}function _t(u,g,_,C,Q,re){if(!g)throw Error("Invalid event type");var Re=v(Q)?!!Q.capture:!!Q,Nt=Yn(u);if(Nt||(u[Ke]=Nt=new J(u)),_=Nt.add(g,_,C,Re,re),_.proxy)return _;if(C=St(),_.proxy=C,C.src=u,C.listener=_,u.addEventListener)te||(Q=Re),Q===void 0&&(Q=!1),u.addEventListener(g.toString(),C,Q);else if(u.attachEvent)u.attachEvent(Cn(g.toString()),C);else if(u.addListener&&u.removeListener)u.addListener(C);else throw Error("addEventListener and attachEvent are unavailable.");return _}function St(){function u(_){return g.call(u.src,u.listener,_)}const g=Qn;return u}function $t(u,g,_,C,Q){if(Array.isArray(g))for(var re=0;re<g.length;re++)$t(u,g[re],_,C,Q);else C=v(C)?!!C.capture:!!C,_=Jn(_),u&&u[Me]?(u=u.i,g=String(g).toString(),g in u.g&&(re=u.g[g],_=Ve(re,_,C,Q),-1<_&&(xt(re[_]),Array.prototype.splice.call(re,_,1),re.length==0&&(delete u.g[g],u.h--)))):u&&(u=Yn(u))&&(g=u.g[g.toString()],u=-1,g&&(u=Ve(g,_,C,Q)),(_=-1<u?g[u]:null)&&cn(_))}function cn(u){if(typeof u!="number"&&u&&!u.da){var g=u.src;if(g&&g[Me])$e(g.i,u);else{var _=u.type,C=u.proxy;g.removeEventListener?g.removeEventListener(_,C,u.capture):g.detachEvent?g.detachEvent(Cn(_),C):g.addListener&&g.removeListener&&g.removeListener(C),(_=Yn(g))?($e(_,u),_.h==0&&(_.src=null,g[Ke]=null)):xt(u)}}}function Cn(u){return u in Et?Et[u]:Et[u]="on"+u}function Qn(u,g){if(u.da)u=!0;else{g=new Ee(g,this);var _=u.listener,C=u.ha||u.src;u.fa&&cn(u),u=_.call(C,g)}return u}function Yn(u){return u=u[Ke],u instanceof J?u:null}var un="__closure_events_fn_"+(1e9*Math.random()>>>0);function Jn(u){return typeof u=="function"?u:(u[un]||(u[un]=function(g){return u.handleEvent(g)}),u[un])}function ft(){N.call(this),this.i=new J(this),this.M=this,this.F=null}X(ft,N),ft.prototype[Me]=!0,ft.prototype.removeEventListener=function(u,g,_,C){$t(this,u,g,_,C)};function Pt(u,g){var _,C=u.F;if(C)for(_=[];C;C=C.F)_.push(C);if(u=u.M,C=g.type||g,typeof g=="string")g=new se(g,u);else if(g instanceof se)g.target=g.target||u;else{var Q=g;g=new se(C,u),F(g,Q)}if(Q=!0,_)for(var re=_.length-1;0<=re;re--){var Re=g.g=_[re];Q=Jt(Re,C,!0,g)&&Q}if(Re=g.g=u,Q=Jt(Re,C,!0,g)&&Q,Q=Jt(Re,C,!1,g)&&Q,_)for(re=0;re<_.length;re++)Re=g.g=_[re],Q=Jt(Re,C,!1,g)&&Q}ft.prototype.N=function(){if(ft.aa.N.call(this),this.i){var u=this.i,g;for(g in u.g){for(var _=u.g[g],C=0;C<_.length;C++)xt(_[C]);delete u.g[g],u.h--}}this.F=null},ft.prototype.K=function(u,g,_,C){return this.i.add(String(u),g,!1,_,C)},ft.prototype.L=function(u,g,_,C){return this.i.add(String(u),g,!0,_,C)};function Jt(u,g,_,C){if(g=u.i.g[String(g)],!g)return!0;g=g.concat();for(var Q=!0,re=0;re<g.length;++re){var Re=g[re];if(Re&&!Re.da&&Re.capture==_){var Nt=Re.listener,hn=Re.ha||Re.src;Re.fa&&$e(u.i,Re),Q=Nt.call(hn,C)!==!1&&Q}}return Q&&!C.defaultPrevented}function ar(u,g,_){if(typeof u=="function")_&&(u=I(u,_));else if(u&&typeof u.handleEvent=="function")u=I(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(g)?-1:f.setTimeout(u,g||0)}function or(u){u.g=ar(()=>{u.g=null,u.i&&(u.i=!1,or(u))},u.l);const g=u.h;u.h=null,u.m.apply(null,g)}class Vr extends N{constructor(g,_){super(),this.m=g,this.l=_,this.h=null,this.i=!1,this.g=null}j(g){this.h=arguments,this.g?this.i=!0:or(this)}N(){super.N(),this.g&&(f.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function lr(u){N.call(this),this.h=u,this.g={}}X(lr,N);var yn=[];function Fs(u){Ie(u.g,function(g,_){this.g.hasOwnProperty(_)&&cn(g)},u),u.g={}}lr.prototype.N=function(){lr.aa.N.call(this),Fs(this)},lr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ms=f.JSON.stringify,Ct=f.JSON.parse,Lr=class{stringify(u){return f.JSON.stringify(u,void 0)}parse(u){return f.JSON.parse(u,void 0)}};function cr(){}cr.prototype.h=null;function gs(u){return u.h||(u.h=u.i())}function ur(){}var In={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Xn(){se.call(this,"d")}X(Xn,se);function Sr(){se.call(this,"c")}X(Sr,se);var Wt={},Zn=null;function er(){return Zn=Zn||new ft}Wt.La="serverreachability";function ys(u){se.call(this,Wt.La,u)}X(ys,se);function ct(u){const g=er();Pt(g,new ys(g))}Wt.STAT_EVENT="statevent";function vn(u,g){se.call(this,Wt.STAT_EVENT,u),this.stat=g}X(vn,se);function At(u){const g=er();Pt(g,new vn(g,u))}Wt.Ma="timingevent";function Jr(u,g){se.call(this,Wt.Ma,u),this.size=g}X(Jr,se);function bn(u,g){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return f.setTimeout(function(){u()},g)}function Or(){this.g=!0}Or.prototype.xa=function(){this.g=!1};function Cr(u,g,_,C,Q,re){u.info(function(){if(u.g)if(re)for(var Re="",Nt=re.split("&"),hn=0;hn<Nt.length;hn++){var gt=Nt[hn].split("=");if(1<gt.length){var wn=gt[0];gt=gt[1];var sn=wn.split("_");Re=2<=sn.length&&sn[1]=="type"?Re+(wn+"="+gt+"&"):Re+(wn+"=redacted&")}}else Re=null;else Re=re;return"XMLHTTP REQ ("+C+") [attempt "+Q+"]: "+g+`
`+_+`
`+Re})}function Pn(u,g,_,C,Q,re,Re){u.info(function(){return"XMLHTTP RESP ("+C+") [ attempt "+Q+"]: "+g+`
`+_+`
`+re+" "+Re})}function Rn(u,g,_,C){u.info(function(){return"XMLHTTP TEXT ("+g+"): "+vs(u,_)+(C?" "+C:"")})}function Nn(u,g){u.info(function(){return"TIMEOUT: "+g})}Or.prototype.info=function(){};function vs(u,g){if(!u.g)return g;if(!g)return null;try{var _=JSON.parse(g);if(_){for(u=0;u<_.length;u++)if(Array.isArray(_[u])){var C=_[u];if(!(2>C.length)){var Q=C[1];if(Array.isArray(Q)&&!(1>Q.length)){var re=Q[0];if(re!="noop"&&re!="stop"&&re!="close")for(var Re=1;Re<Q.length;Re++)Q[Re]=""}}}}return ms(_)}catch{return g}}var Gt={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Us={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},_n;function Mn(){}X(Mn,cr),Mn.prototype.g=function(){return new XMLHttpRequest},Mn.prototype.i=function(){return{}},_n=new Mn;function Fn(u,g,_,C){this.j=u,this.i=g,this.l=_,this.R=C||1,this.U=new lr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new pi}function pi(){this.i=null,this.g="",this.h=!1}var Xr={},_s={};function ws(u,g,_){u.L=1,u.v=Ae(O(g)),u.m=_,u.P=!0,Zr(u,null)}function Zr(u,g){u.F=Date.now(),pt(u),u.A=O(u.v);var _=u.A,C=u.R;Array.isArray(C)||(C=[String(C)]),xs(_.i,"t",C),u.C=0,_=u.j.J,u.h=new pi,u.g=dc(u.j,_?g:null,!u.m),0<u.O&&(u.M=new Vr(I(u.Y,u,u.g),u.O)),g=u.U,_=u.g,C=u.ca;var Q="readystatechange";Array.isArray(Q)||(Q&&(yn[0]=Q.toString()),Q=yn);for(var re=0;re<Q.length;re++){var Re=Tt(_,Q[re],C||g.handleEvent,!1,g.h||g);if(!Re)break;g.g[Re.key]=Re}g=u.H?P(u.H):{},u.m?(u.u||(u.u="POST"),g["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,g)):(u.u="GET",u.g.ea(u.A,u.u,null,g)),ct(),Cr(u.i,u.u,u.A,u.l,u.R,u.m)}Fn.prototype.ca=function(u){u=u.target;const g=this.M;g&&fr(u)==3?g.j():this.Y(u)},Fn.prototype.Y=function(u){try{if(u==this.g)e:{const sn=fr(this.g);var g=this.g.Ba();const Ur=this.g.Z();if(!(3>sn)&&(sn!=3||this.g&&(this.h.h||this.g.oa()||Bo(this.g)))){this.J||sn!=4||g==7||(g==8||0>=Ur?ct(3):ct(2)),G(this);var _=this.g.Z();this.X=_;t:if(Ir(this)){var C=Bo(this.g);u="";var Q=C.length,re=fr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){V(this),H(this);var Re="";break t}this.h.i=new f.TextDecoder}for(g=0;g<Q;g++)this.h.h=!0,u+=this.h.i.decode(C[g],{stream:!(re&&g==Q-1)});C.length=0,this.h.g+=u,this.C=0,Re=this.h.g}else Re=this.g.oa();if(this.o=_==200,Pn(this.i,this.u,this.A,this.l,this.R,sn,_),this.o){if(this.T&&!this.K){t:{if(this.g){var Nt,hn=this.g;if((Nt=hn.g?hn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!be(Nt)){var gt=Nt;break t}}gt=null}if(_=gt)Rn(this.i,this.l,_,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,q(this,_);else{this.o=!1,this.s=3,At(12),V(this),H(this);break e}}if(this.P){_=!0;let Rr;for(;!this.J&&this.C<Re.length;)if(Rr=zs(this,Re),Rr==_s){sn==4&&(this.s=4,At(14),_=!1),Rn(this.i,this.l,null,"[Incomplete Response]");break}else if(Rr==Xr){this.s=4,At(15),Rn(this.i,this.l,Re,"[Invalid Chunk]"),_=!1;break}else Rn(this.i,this.l,Rr,null),q(this,Rr);if(Ir(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),sn!=4||Re.length!=0||this.h.h||(this.s=1,At(16),_=!1),this.o=this.o&&_,!_)Rn(this.i,this.l,Re,"[Invalid Chunked Response]"),V(this),H(this);else if(0<Re.length&&!this.W){this.W=!0;var wn=this.j;wn.g==this&&wn.ba&&!wn.M&&(wn.j.info("Great, no buffering proxy detected. Bytes received: "+Re.length),Wo(wn),wn.M=!0,At(11))}}else Rn(this.i,this.l,Re,null),q(this,Re);sn==4&&V(this),this.o&&!this.J&&(sn==4?za(this.j,this):(this.o=!1,pt(this)))}else La(this.g),_==400&&0<Re.indexOf("Unknown SID")?(this.s=3,At(12)):(this.s=0,At(13)),V(this),H(this)}}}catch{}finally{}};function Ir(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function zs(u,g){var _=u.C,C=g.indexOf(`
`,_);return C==-1?_s:(_=Number(g.substring(_,C)),isNaN(_)?Xr:(C+=1,C+_>g.length?_s:(g=g.slice(C,C+_),u.C=C+_,g)))}Fn.prototype.cancel=function(){this.J=!0,V(this)};function pt(u){u.S=Date.now()+u.I,E(u,u.I)}function E(u,g){if(u.B!=null)throw Error("WatchDog timer not null");u.B=bn(I(u.ba,u),g)}function G(u){u.B&&(f.clearTimeout(u.B),u.B=null)}Fn.prototype.ba=function(){this.B=null;const u=Date.now();0<=u-this.S?(Nn(this.i,this.A),this.L!=2&&(ct(),At(17)),V(this),this.s=2,H(this)):E(this,this.S-u)};function H(u){u.j.G==0||u.J||za(u.j,u)}function V(u){G(u);var g=u.M;g&&typeof g.ma=="function"&&g.ma(),u.M=null,Fs(u.U),u.g&&(g=u.g,u.g=null,g.abort(),g.ma())}function q(u,g){try{var _=u.j;if(_.G!=0&&(_.g==u||ke(_.h,u))){if(!u.K&&ke(_.h,u)&&_.G==3){try{var C=_.Da.g.parse(g)}catch{C=null}if(Array.isArray(C)&&C.length==3){var Q=C;if(Q[0]==0){e:if(!_.u){if(_.g)if(_.g.F+3e3<u.F)Ua(_),ss(_);else break e;Fa(_),At(18)}}else _.za=Q[1],0<_.za-_.T&&37500>Q[2]&&_.F&&_.v==0&&!_.C&&(_.C=bn(I(_.Za,_),6e3));if(1>=Se(_.h)&&_.ca){try{_.ca()}catch{}_.ca=void 0}}else Hs(_,11)}else if((u.K||_.g==u)&&Ua(_),!be(g))for(Q=_.Da.g.parse(g),g=0;g<Q.length;g++){let gt=Q[g];if(_.T=gt[0],gt=gt[1],_.G==2)if(gt[0]=="c"){_.K=gt[1],_.ia=gt[2];const wn=gt[3];wn!=null&&(_.la=wn,_.j.info("VER="+_.la));const sn=gt[4];sn!=null&&(_.Aa=sn,_.j.info("SVER="+_.Aa));const Ur=gt[5];Ur!=null&&typeof Ur=="number"&&0<Ur&&(C=1.5*Ur,_.L=C,_.j.info("backChannelRequestTimeoutMs_="+C)),C=_;const Rr=u.g;if(Rr){const oa=Rr.g?Rr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(oa){var re=C.h;re.g||oa.indexOf("spdy")==-1&&oa.indexOf("quic")==-1&&oa.indexOf("h2")==-1||(re.j=re.l,re.g=new Set,re.h&&(oe(re,re.h),re.h=null))}if(C.D){const $a=Rr.g?Rr.g.getResponseHeader("X-HTTP-Session-Id"):null;$a&&(C.ya=$a,Te(C.I,C.D,$a))}}_.G=3,_.l&&_.l.ua(),_.ba&&(_.R=Date.now()-u.F,_.j.info("Handshake RTT: "+_.R+"ms")),C=_;var Re=u;if(C.qa=uc(C,C.J?C.ia:null,C.W),Re.K){rt(C.h,Re);var Nt=Re,hn=C.L;hn&&(Nt.I=hn),Nt.B&&(G(Nt),pt(Nt)),C.g=Re}else aa(C);0<_.i.length&&Ts(_)}else gt[0]!="stop"&&gt[0]!="close"||Hs(_,7);else _.G==3&&(gt[0]=="stop"||gt[0]=="close"?gt[0]=="stop"?Hs(_,7):kn(_):gt[0]!="noop"&&_.l&&_.l.ta(gt),_.v=0)}}ct(4)}catch{}}var ae=class{constructor(u,g){this.g=u,this.map=g}};function ie(u){this.l=u||10,f.PerformanceNavigationTiming?(u=f.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(f.chrome&&f.chrome.loadTimes&&f.chrome.loadTimes()&&f.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Ne(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function Se(u){return u.h?1:u.g?u.g.size:0}function ke(u,g){return u.h?u.h==g:u.g?u.g.has(g):!1}function oe(u,g){u.g?u.g.add(g):u.h=g}function rt(u,g){u.h&&u.h==g?u.h=null:u.g&&u.g.has(g)&&u.g.delete(g)}ie.prototype.cancel=function(){if(this.i=De(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function De(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let g=u.i;for(const _ of u.g.values())g=g.concat(_.D);return g}return K(u.i)}function Qt(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(m(u)){for(var g=[],_=u.length,C=0;C<_;C++)g.push(u[C]);return g}g=[],_=0;for(C in u)g[_++]=u[C];return g}function Mr(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(m(u)||typeof u=="string"){var g=[];u=u.length;for(var _=0;_<u;_++)g.push(_);return g}g=[],_=0;for(const C in u)g[_++]=C;return g}}}function br(u,g){if(u.forEach&&typeof u.forEach=="function")u.forEach(g,void 0);else if(m(u)||typeof u=="string")Array.prototype.forEach.call(u,g,void 0);else for(var _=Mr(u),C=Qt(u),Q=C.length,re=0;re<Q;re++)g.call(void 0,C[re],_&&_[re],u)}var es=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ts(u,g){if(u){u=u.split("&");for(var _=0;_<u.length;_++){var C=u[_].indexOf("="),Q=null;if(0<=C){var re=u[_].substring(0,C);Q=u[_].substring(C+1)}else re=u[_];g(re,Q?decodeURIComponent(Q.replace(/\+/g," ")):"")}}}function S(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof S){this.h=u.h,$(this,u.j),this.o=u.o,this.g=u.g,ce(this,u.s),this.l=u.l;var g=u.i,_=new An;_.i=g.i,g.g&&(_.g=new Map(g.g),_.h=g.h),me(this,_),this.m=u.m}else u&&(g=String(u).match(es))?(this.h=!1,$(this,g[1]||"",!0),this.o=Le(g[2]||""),this.g=Le(g[3]||"",!0),ce(this,g[4]),this.l=Le(g[5]||"",!0),me(this,g[6]||"",!0),this.m=Le(g[7]||"")):(this.h=!1,this.i=new An(null,this.h))}S.prototype.toString=function(){var u=[],g=this.j;g&&u.push(ot(g,Vt,!0),":");var _=this.g;return(_||g=="file")&&(u.push("//"),(g=this.o)&&u.push(ot(g,Vt,!0),"@"),u.push(encodeURIComponent(String(_)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_=this.s,_!=null&&u.push(":",String(_))),(_=this.l)&&(this.g&&_.charAt(0)!="/"&&u.push("/"),u.push(ot(_,_.charAt(0)=="/"?tr:Ut,!0))),(_=this.i.toString())&&u.push("?",_),(_=this.m)&&u.push("#",ot(_,mt)),u.join("")};function O(u){return new S(u)}function $(u,g,_){u.j=_?Le(g,!0):g,u.j&&(u.j=u.j.replace(/:$/,""))}function ce(u,g){if(g){if(g=Number(g),isNaN(g)||0>g)throw Error("Bad port number "+g);u.s=g}else u.s=null}function me(u,g,_){g instanceof An?(u.i=g,Fr(u.i,u.h)):(_||(g=ot(g,rn)),u.i=new An(g,u.h))}function Te(u,g,_){u.i.set(g,_)}function Ae(u){return Te(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function Le(u,g){return u?g?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function ot(u,g,_){return typeof u=="string"?(u=encodeURI(u).replace(g,Rt),_&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function Rt(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var Vt=/[#\/\?@]/g,Ut=/[#\?:]/g,tr=/[#\?]/g,rn=/[#\?@]/g,mt=/#/g;function An(u,g){this.h=this.g=null,this.i=u||null,this.j=!!g}function It(u){u.g||(u.g=new Map,u.h=0,u.i&&ts(u.i,function(g,_){u.add(decodeURIComponent(g.replace(/\+/g," ")),_)}))}n=An.prototype,n.add=function(u,g){It(this),this.i=null,u=dr(this,u);var _=this.g.get(u);return _||this.g.set(u,_=[]),_.push(g),this.h+=1,this};function dn(u,g){It(u),g=dr(u,g),u.g.has(g)&&(u.i=null,u.h-=u.g.get(g).length,u.g.delete(g))}function nr(u,g){return It(u),g=dr(u,g),u.g.has(g)}n.forEach=function(u,g){It(this),this.g.forEach(function(_,C){_.forEach(function(Q){u.call(g,Q,C,this)},this)},this)},n.na=function(){It(this);const u=Array.from(this.g.values()),g=Array.from(this.g.keys()),_=[];for(let C=0;C<g.length;C++){const Q=u[C];for(let re=0;re<Q.length;re++)_.push(g[C])}return _},n.V=function(u){It(this);let g=[];if(typeof u=="string")nr(this,u)&&(g=g.concat(this.g.get(dr(this,u))));else{u=Array.from(this.g.values());for(let _=0;_<u.length;_++)g=g.concat(u[_])}return g},n.set=function(u,g){return It(this),this.i=null,u=dr(this,u),nr(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[g]),this.h+=1,this},n.get=function(u,g){return u?(u=this.V(u),0<u.length?String(u[0]):g):g};function xs(u,g,_){dn(u,g),0<_.length&&(u.i=null,u.g.set(dr(u,g),K(_)),u.h+=_.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],g=Array.from(this.g.keys());for(var _=0;_<g.length;_++){var C=g[_];const re=encodeURIComponent(String(C)),Re=this.V(C);for(C=0;C<Re.length;C++){var Q=re;Re[C]!==""&&(Q+="="+encodeURIComponent(String(Re[C]))),u.push(Q)}}return this.i=u.join("&")};function dr(u,g){return g=String(g),u.j&&(g=g.toLowerCase()),g}function Fr(u,g){g&&!u.j&&(It(u),u.i=null,u.g.forEach(function(_,C){var Q=C.toLowerCase();C!=Q&&(dn(this,C),xs(this,Q,_))},u)),u.j=g}function Bs(u,g){const _=new Or;if(f.Image){const C=new Image;C.onload=B(hr,_,"TestLoadImage: loaded",!0,g,C),C.onerror=B(hr,_,"TestLoadImage: error",!1,g,C),C.onabort=B(hr,_,"TestLoadImage: abort",!1,g,C),C.ontimeout=B(hr,_,"TestLoadImage: timeout",!1,g,C),f.setTimeout(function(){C.ontimeout&&C.ontimeout()},1e4),C.src=u}else g(!1)}function ja(u,g){const _=new Or,C=new AbortController,Q=setTimeout(()=>{C.abort(),hr(_,"TestPingServer: timeout",!1,g)},1e4);fetch(u,{signal:C.signal}).then(re=>{clearTimeout(Q),re.ok?hr(_,"TestPingServer: ok",!0,g):hr(_,"TestPingServer: server error",!1,g)}).catch(()=>{clearTimeout(Q),hr(_,"TestPingServer: error",!1,g)})}function hr(u,g,_,C,Q){try{Q&&(Q.onload=null,Q.onerror=null,Q.onabort=null,Q.ontimeout=null),C(_)}catch{}}function vd(){this.g=new Lr}function ic(u,g,_){const C=_||"";try{br(u,function(Q,re){let Re=Q;v(Q)&&(Re=ms(Q)),g.push(C+re+"="+encodeURIComponent(Re))})}catch(Q){throw g.push(C+"type="+encodeURIComponent("_badmap")),Q}}function $s(u){this.l=u.Ub||null,this.j=u.eb||!1}X($s,cr),$s.prototype.g=function(){return new sa(this.l,this.j)},$s.prototype.i=(function(u){return function(){return u}})({});function sa(u,g){ft.call(this),this.D=u,this.o=g,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}X(sa,ft),n=sa.prototype,n.open=function(u,g){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=g,this.readyState=1,rs(this)},n.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const g={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(g.body=u),(this.D||f).fetch(new Request(this.A,g)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ns(this)),this.readyState=0},n.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,rs(this)),this.g&&(this.readyState=3,rs(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof f.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;ac(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function ac(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}n.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var g=u.value?u.value:new Uint8Array(0);(g=this.v.decode(g,{stream:!u.done}))&&(this.response=this.responseText+=g)}u.done?ns(this):rs(this),this.readyState==3&&ac(this)}},n.Ra=function(u){this.g&&(this.response=this.responseText=u,ns(this))},n.Qa=function(u){this.g&&(this.response=u,ns(this))},n.ga=function(){this.g&&ns(this)};function ns(u){u.readyState=4,u.l=null,u.j=null,u.v=null,rs(u)}n.setRequestHeader=function(u,g){this.u.append(u,g)},n.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],g=this.h.entries();for(var _=g.next();!_.done;)_=_.value,u.push(_[0]+": "+_[1]),_=g.next();return u.join(`\r
`)};function rs(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(sa.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function Ws(u){let g="";return Ie(u,function(_,C){g+=C,g+=":",g+=_,g+=`\r
`}),g}function mi(u,g,_){e:{for(C in _){var C=!1;break e}C=!0}C||(_=Ws(_),typeof u=="string"?_!=null&&encodeURIComponent(String(_)):Te(u,g,_))}function zt(u){ft.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}X(zt,ft);var _d=/^https?$/i,Uo=["POST","PUT"];n=zt.prototype,n.Ha=function(u){this.J=u},n.ea=function(u,g,_,C){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);g=g?g.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():_n.g(),this.v=this.o?gs(this.o):gs(_n),this.g.onreadystatechange=I(this.Ea,this);try{this.B=!0,this.g.open(g,String(u),!0),this.B=!1}catch(re){ia(this,re);return}if(u=_||"",_=new Map(this.headers),C)if(Object.getPrototypeOf(C)===Object.prototype)for(var Q in C)_.set(Q,C[Q]);else if(typeof C.keys=="function"&&typeof C.get=="function")for(const re of C.keys())_.set(re,C.get(re));else throw Error("Unknown input type for opt_headers: "+String(C));C=Array.from(_.keys()).find(re=>re.toLowerCase()=="content-type"),Q=f.FormData&&u instanceof f.FormData,!(0<=Array.prototype.indexOf.call(Uo,g,void 0))||C||Q||_.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[re,Re]of _)this.g.setRequestHeader(re,Re);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Va(this),this.u=!0,this.g.send(u),this.u=!1}catch(re){ia(this,re)}};function ia(u,g){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=g,u.m=5,Da(u),Pr(u)}function Da(u){u.A||(u.A=!0,Pt(u,"complete"),Pt(u,"error"))}n.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,Pt(this,"complete"),Pt(this,"abort"),Pr(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Pr(this,!0)),zt.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?zo(this):this.bb())},n.bb=function(){zo(this)};function zo(u){if(u.h&&typeof d<"u"&&(!u.v[1]||fr(u)!=4||u.Z()!=2)){if(u.u&&fr(u)==4)ar(u.Ea,0,u);else if(Pt(u,"readystatechange"),fr(u)==4){u.h=!1;try{const Re=u.Z();e:switch(Re){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var g=!0;break e;default:g=!1}var _;if(!(_=g)){var C;if(C=Re===0){var Q=String(u.D).match(es)[1]||null;!Q&&f.self&&f.self.location&&(Q=f.self.location.protocol.slice(0,-1)),C=!_d.test(Q?Q.toLowerCase():"")}_=C}if(_)Pt(u,"complete"),Pt(u,"success");else{u.m=6;try{var re=2<fr(u)?u.g.statusText:""}catch{re=""}u.l=re+" ["+u.Z()+"]",Da(u)}}finally{Pr(u)}}}}function Pr(u,g){if(u.g){Va(u);const _=u.g,C=u.v[0]?()=>{}:null;u.g=null,u.v=null,g||Pt(u,"ready");try{_.onreadystatechange=C}catch{}}}function Va(u){u.I&&(f.clearTimeout(u.I),u.I=null)}n.isActive=function(){return!!this.g};function fr(u){return u.g?u.g.readyState:0}n.Z=function(){try{return 2<fr(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(u){if(this.g){var g=this.g.responseText;return u&&g.indexOf(u)==0&&(g=g.substring(u.length)),Ct(g)}};function Bo(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function La(u){const g={};u=(u.g&&2<=fr(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let C=0;C<u.length;C++){if(be(u[C]))continue;var _=z(u[C]);const Q=_[0];if(_=_[1],typeof _!="string")continue;_=_.trim();const re=g[Q]||[];g[Q]=re,re.push(_)}A(g,function(C){return C.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Es(u,g,_){return _&&_.internalChannelParams&&_.internalChannelParams[u]||g}function $o(u){this.Aa=0,this.i=[],this.j=new Or,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Es("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Es("baseRetryDelayMs",5e3,u),this.cb=Es("retryDelaySeedMs",1e4,u),this.Wa=Es("forwardChannelMaxRetries",2,u),this.wa=Es("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new ie(u&&u.concurrentRequestLimit),this.Da=new vd,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=$o.prototype,n.la=8,n.G=1,n.connect=function(u,g,_,C){At(0),this.W=u,this.H=g||{},_&&C!==void 0&&(this.H.OSID=_,this.H.OAID=C),this.F=this.X,this.I=uc(this,null,this.W),Ts(this)};function kn(u){if(Oa(u),u.G==3){var g=u.U++,_=O(u.I);if(Te(_,"SID",u.K),Te(_,"RID",g),Te(_,"TYPE","terminate"),Gs(u,_),g=new Fn(u,u.j,g),g.L=2,g.v=Ae(O(_)),_=!1,f.navigator&&f.navigator.sendBeacon)try{_=f.navigator.sendBeacon(g.v.toString(),"")}catch{}!_&&f.Image&&(new Image().src=g.v,_=!0),_||(g.g=dc(g.j,null),g.g.ea(g.v)),g.F=Date.now(),pt(g)}cc(u)}function ss(u){u.g&&(Wo(u),u.g.cancel(),u.g=null)}function Oa(u){ss(u),u.u&&(f.clearTimeout(u.u),u.u=null),Ua(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&f.clearTimeout(u.s),u.s=null)}function Ts(u){if(!Ne(u.h)&&!u.s){u.s=!0;var g=u.Ga;Be||Pe(),ye||(Be(),ye=!0),je.add(g,u),u.B=0}}function wd(u,g){return Se(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=g.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=bn(I(u.Ga,u,g),lc(u,u.B)),u.B++,!0)}n.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;const Q=new Fn(this,this.j,u);let re=this.o;if(this.S&&(re?(re=P(re),F(re,this.S)):re=this.S),this.m!==null||this.O||(Q.H=re,re=null),this.P)e:{for(var g=0,_=0;_<this.i.length;_++){t:{var C=this.i[_];if("__data__"in C.map&&(C=C.map.__data__,typeof C=="string")){C=C.length;break t}C=void 0}if(C===void 0)break;if(g+=C,4096<g){g=_;break e}if(g===4096||_===this.i.length-1){g=_+1;break e}}g=1e3}else g=1e3;g=gi(this,Q,g),_=O(this.I),Te(_,"RID",u),Te(_,"CVER",22),this.D&&Te(_,"X-HTTP-Session-Id",this.D),Gs(this,_),re&&(this.O?g="headers="+encodeURIComponent(String(Ws(re)))+"&"+g:this.m&&mi(_,this.m,re)),oe(this.h,Q),this.Ua&&Te(_,"TYPE","init"),this.P?(Te(_,"$req",g),Te(_,"SID","null"),Q.T=!0,ws(Q,_,null)):ws(Q,_,g),this.G=2}}else this.G==3&&(u?Ma(this,u):this.i.length==0||Ne(this.h)||Ma(this))};function Ma(u,g){var _;g?_=g.l:_=u.U++;const C=O(u.I);Te(C,"SID",u.K),Te(C,"RID",_),Te(C,"AID",u.T),Gs(u,C),u.m&&u.o&&mi(C,u.m,u.o),_=new Fn(u,u.j,_,u.B+1),u.m===null&&(_.H=u.o),g&&(u.i=g.D.concat(u.i)),g=gi(u,_,1e3),_.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),oe(u.h,_),ws(_,C,g)}function Gs(u,g){u.H&&Ie(u.H,function(_,C){Te(g,C,_)}),u.l&&br({},function(_,C){Te(g,C,_)})}function gi(u,g,_){_=Math.min(u.i.length,_);var C=u.l?I(u.l.Na,u.l,u):null;e:{var Q=u.i;let re=-1;for(;;){const Re=["count="+_];re==-1?0<_?(re=Q[0].g,Re.push("ofs="+re)):re=0:Re.push("ofs="+re);let Nt=!0;for(let hn=0;hn<_;hn++){let gt=Q[hn].g;const wn=Q[hn].map;if(gt-=re,0>gt)re=Math.max(0,Q[hn].g-100),Nt=!1;else try{ic(wn,Re,"req"+gt+"_")}catch{C&&C(wn)}}if(Nt){C=Re.join("&");break e}}}return u=u.i.splice(0,_),g.D=u,C}function aa(u){if(!u.g&&!u.u){u.Y=1;var g=u.Fa;Be||Pe(),ye||(Be(),ye=!0),je.add(g,u),u.v=0}}function Fa(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=bn(I(u.Fa,u),lc(u,u.v)),u.v++,!0)}n.Fa=function(){if(this.u=null,oc(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=bn(I(this.ab,this),u)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,At(10),ss(this),oc(this))};function Wo(u){u.A!=null&&(f.clearTimeout(u.A),u.A=null)}function oc(u){u.g=new Fn(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var g=O(u.qa);Te(g,"RID","rpc"),Te(g,"SID",u.K),Te(g,"AID",u.T),Te(g,"CI",u.F?"0":"1"),!u.F&&u.ja&&Te(g,"TO",u.ja),Te(g,"TYPE","xmlhttp"),Gs(u,g),u.m&&u.o&&mi(g,u.m,u.o),u.L&&(u.g.I=u.L);var _=u.g;u=u.ia,_.L=1,_.v=Ae(O(g)),_.m=null,_.P=!0,Zr(_,u)}n.Za=function(){this.C!=null&&(this.C=null,ss(this),Fa(this),At(19))};function Ua(u){u.C!=null&&(f.clearTimeout(u.C),u.C=null)}function za(u,g){var _=null;if(u.g==g){Ua(u),Wo(u),u.g=null;var C=2}else if(ke(u.h,g))_=g.D,rt(u.h,g),C=1;else return;if(u.G!=0){if(g.o)if(C==1){_=g.m?g.m.length:0,g=Date.now()-g.F;var Q=u.B;C=er(),Pt(C,new Jr(C,_)),Ts(u)}else aa(u);else if(Q=g.s,Q==3||Q==0&&0<g.X||!(C==1&&wd(u,g)||C==2&&Fa(u)))switch(_&&0<_.length&&(g=u.h,g.i=g.i.concat(_)),Q){case 1:Hs(u,5);break;case 4:Hs(u,10);break;case 3:Hs(u,6);break;default:Hs(u,2)}}}function lc(u,g){let _=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(_*=2),_*g}function Hs(u,g){if(u.j.info("Error code "+g),g==2){var _=I(u.fb,u),C=u.Xa;const Q=!C;C=new S(C||"//www.google.com/images/cleardot.gif"),f.location&&f.location.protocol=="http"||$(C,"https"),Ae(C),Q?Bs(C.toString(),_):ja(C.toString(),_)}else At(2);u.G=0,u.l&&u.l.sa(g),cc(u),Oa(u)}n.fb=function(u){u?(this.j.info("Successfully pinged google.com"),At(2)):(this.j.info("Failed to ping google.com"),At(1))};function cc(u){if(u.G=0,u.ka=[],u.l){const g=De(u.h);(g.length!=0||u.i.length!=0)&&(M(u.ka,g),M(u.ka,u.i),u.h.i.length=0,K(u.i),u.i.length=0),u.l.ra()}}function uc(u,g,_){var C=_ instanceof S?O(_):new S(_);if(C.g!="")g&&(C.g=g+"."+C.g),ce(C,C.s);else{var Q=f.location;C=Q.protocol,g=g?g+"."+Q.hostname:Q.hostname,Q=+Q.port;var re=new S(null);C&&$(re,C),g&&(re.g=g),Q&&ce(re,Q),_&&(re.l=_),C=re}return _=u.D,g=u.ya,_&&g&&Te(C,_,g),Te(C,"VER",u.la),Gs(u,C),C}function dc(u,g,_){if(g&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return g=u.Ca&&!u.pa?new zt(new $s({eb:_})):new zt(u.pa),g.Ha(u.J),g}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Go(){}n=Go.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Ba(){}Ba.prototype.g=function(u,g){return new rr(u,g)};function rr(u,g){ft.call(this),this.g=new $o(g),this.l=u,this.h=g&&g.messageUrlParams||null,u=g&&g.messageHeaders||null,g&&g.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=g&&g.initMessageHeaders||null,g&&g.messageContentType&&(u?u["X-WebChannel-Content-Type"]=g.messageContentType:u={"X-WebChannel-Content-Type":g.messageContentType}),g&&g.va&&(u?u["X-WebChannel-Client-Profile"]=g.va:u={"X-WebChannel-Client-Profile":g.va}),this.g.S=u,(u=g&&g.Sb)&&!be(u)&&(this.g.m=u),this.v=g&&g.supportsCrossDomainXhr||!1,this.u=g&&g.sendRawJson||!1,(g=g&&g.httpSessionIdParam)&&!be(g)&&(this.g.D=g,u=this.h,u!==null&&g in u&&(u=this.h,g in u&&delete u[g])),this.j=new Ss(this)}X(rr,ft),rr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},rr.prototype.close=function(){kn(this.g)},rr.prototype.o=function(u){var g=this.g;if(typeof u=="string"){var _={};_.__data__=u,u=_}else this.u&&(_={},_.__data__=ms(u),u=_);g.i.push(new ae(g.Ya++,u)),g.G==3&&Ts(g)},rr.prototype.N=function(){this.g.l=null,delete this.j,kn(this.g),delete this.g,rr.aa.N.call(this)};function hc(u){Xn.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var g=u.__sm__;if(g){e:{for(const _ in g){u=_;break e}u=void 0}(this.i=u)&&(u=this.i,g=g!==null&&u in g?g[u]:void 0),this.data=g}else this.data=u}X(hc,Xn);function fc(){Sr.call(this),this.status=1}X(fc,Sr);function Ss(u){this.g=u}X(Ss,Go),Ss.prototype.ua=function(){Pt(this.g,"a")},Ss.prototype.ta=function(u){Pt(this.g,new hc(u))},Ss.prototype.sa=function(u){Pt(this.g,new fc)},Ss.prototype.ra=function(){Pt(this.g,"b")},Ba.prototype.createWebChannel=Ba.prototype.g,rr.prototype.send=rr.prototype.o,rr.prototype.open=rr.prototype.m,rr.prototype.close=rr.prototype.close,f0=function(){return new Ba},h0=function(){return er()},d0=Wt,_f={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Gt.NO_ERROR=0,Gt.TIMEOUT=8,Gt.HTTP_ERROR=6,yu=Gt,Us.COMPLETE="complete",u0=Us,ur.EventType=In,In.OPEN="a",In.CLOSE="b",In.ERROR="c",In.MESSAGE="d",ft.prototype.listen=ft.prototype.K,xl=ur,zt.prototype.listenOnce=zt.prototype.L,zt.prototype.getLastError=zt.prototype.Ka,zt.prototype.getLastErrorCode=zt.prototype.Ba,zt.prototype.getStatus=zt.prototype.Z,zt.prototype.getResponseJson=zt.prototype.Oa,zt.prototype.getResponseText=zt.prototype.oa,zt.prototype.send=zt.prototype.ea,zt.prototype.setWithCredentials=zt.prototype.Ha,c0=zt}).apply(typeof lu<"u"?lu:typeof self<"u"?self:typeof window<"u"?window:{});const By="@firebase/firestore",$y="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Gn.UNAUTHENTICATED=new Gn(null),Gn.GOOGLE_CREDENTIALS=new Gn("google-credentials-uid"),Gn.FIRST_PARTY=new Gn("first-party-uid"),Gn.MOCK_USER=new Gn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Vo="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ra=new $f("@firebase/firestore");function ho(){return Ra.logLevel}function Fe(n,...e){if(Ra.logLevel<=dt.DEBUG){const t=e.map(rp);Ra.debug(`Firestore (${Vo}): ${n}`,...t)}}function ui(n,...e){if(Ra.logLevel<=dt.ERROR){const t=e.map(rp);Ra.error(`Firestore (${Vo}): ${n}`,...t)}}function Wi(n,...e){if(Ra.logLevel<=dt.WARN){const t=e.map(rp);Ra.warn(`Firestore (${Vo}): ${n}`,...t)}}function rp(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ze(n,e,t){let s="Unexpected state";typeof e=="string"?s=e:t=e,p0(n,s,t)}function p0(n,e,t){let s=`FIRESTORE (${Vo}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{s+=" CONTEXT: "+JSON.stringify(t)}catch{s+=" CONTEXT: "+t}throw ui(s),new Error(s)}function bt(n,e,t,s){let a="Unexpected state";typeof t=="string"?a=t:s=t,n||p0(e,a,s)}function st(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const de={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ge extends fi{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ai{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m0{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class aI{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Gn.UNAUTHENTICATED)))}shutdown(){}}class oI{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class lI{constructor(e){this.t=e,this.currentUser=Gn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){bt(this.o===void 0,42304);let s=this.i;const a=m=>this.i!==s?(s=this.i,t(m)):Promise.resolve();let l=new ai;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new ai,e.enqueueRetryable((()=>a(this.currentUser)))};const d=()=>{const m=l;e.enqueueRetryable((async()=>{await m.promise,await a(this.currentUser)}))},f=m=>{Fe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=m,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit((m=>f(m))),setTimeout((()=>{if(!this.auth){const m=this.t.getImmediate({optional:!0});m?f(m):(Fe("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new ai)}}),0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((s=>this.i!==e?(Fe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(bt(typeof s.accessToken=="string",31837,{l:s}),new m0(s.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return bt(e===null||typeof e=="string",2055,{h:e}),new Gn(e)}}class cI{constructor(e,t,s){this.P=e,this.T=t,this.I=s,this.type="FirstParty",this.user=Gn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class uI{constructor(e,t,s){this.P=e,this.T=t,this.I=s}getToken(){return Promise.resolve(new cI(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Gn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Wy{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class dI{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,jr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){bt(this.o===void 0,3512);const s=l=>{l.error!=null&&Fe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const d=l.token!==this.m;return this.m=l.token,Fe("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?t(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable((()=>s(l)))};const a=l=>{Fe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((l=>a(l))),setTimeout((()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?a(l):Fe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new Wy(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(bt(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Wy(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hI(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let s=0;s<n;s++)t[s]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g0(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sp{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let s="";for(;s.length<20;){const a=hI(40);for(let l=0;l<a.length;++l)s.length<20&&a[l]<t&&(s+=e.charAt(a[l]%62))}return s}}function at(n,e){return n<e?-1:n>e?1:0}function wf(n,e){let t=0;for(;t<n.length&&t<e.length;){const s=n.codePointAt(t),a=e.codePointAt(t);if(s!==a){if(s<128&&a<128)return at(s,a);{const l=g0(),d=fI(l.encode(Gy(n,t)),l.encode(Gy(e,t)));return d!==0?d:at(s,a)}}t+=s>65535?2:1}return at(n.length,e.length)}function Gy(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function fI(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return at(n[t],e[t]);return at(n.length,e.length)}function So(n,e,t){return n.length===e.length&&n.every(((s,a)=>t(s,e[a])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hy="__name__";class Rs{constructor(e,t,s){t===void 0?t=0:t>e.length&&Ze(637,{offset:t,range:e.length}),s===void 0?s=e.length-t:s>e.length-t&&Ze(1746,{length:s,range:e.length-t}),this.segments=e,this.offset=t,this.len=s}get length(){return this.len}isEqual(e){return Rs.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Rs?e.forEach((s=>{t.push(s)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,s=this.limit();t<s;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const s=Math.min(e.length,t.length);for(let a=0;a<s;a++){const l=Rs.compareSegments(e.get(a),t.get(a));if(l!==0)return l}return at(e.length,t.length)}static compareSegments(e,t){const s=Rs.isNumericId(e),a=Rs.isNumericId(t);return s&&!a?-1:!s&&a?1:s&&a?Rs.extractNumericId(e).compare(Rs.extractNumericId(t)):wf(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Bi.fromString(e.substring(4,e.length-2))}}class Mt extends Rs{construct(e,t,s){return new Mt(e,t,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const s of e){if(s.indexOf("//")>=0)throw new Ge(de.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);t.push(...s.split("/").filter((a=>a.length>0)))}return new Mt(t)}static emptyPath(){return new Mt([])}}const pI=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ln extends Rs{construct(e,t,s){return new Ln(e,t,s)}static isValidIdentifier(e){return pI.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ln.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Hy}static keyField(){return new Ln([Hy])}static fromServerFormat(e){const t=[];let s="",a=0;const l=()=>{if(s.length===0)throw new Ge(de.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(s),s=""};let d=!1;for(;a<e.length;){const f=e[a];if(f==="\\"){if(a+1===e.length)throw new Ge(de.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const m=e[a+1];if(m!=="\\"&&m!=="."&&m!=="`")throw new Ge(de.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=m,a+=2}else f==="`"?(d=!d,a++):f!=="."||d?(s+=f,a++):(l(),a++)}if(l(),d)throw new Ge(de.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ln(t)}static emptyPath(){return new Ln([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qe{constructor(e){this.path=e}static fromPath(e){return new Qe(Mt.fromString(e))}static fromName(e){return new Qe(Mt.fromString(e).popFirst(5))}static empty(){return new Qe(Mt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Mt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Mt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Qe(new Mt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y0(n,e,t){if(!t)throw new Ge(de.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function mI(n,e,t,s){if(e===!0&&s===!0)throw new Ge(de.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function qy(n){if(!Qe.isDocumentKey(n))throw new Ge(de.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Ky(n){if(Qe.isDocumentKey(n))throw new Ge(de.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function v0(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function ip(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(s){return s.constructor?s.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Ze(12329,{type:typeof n})}function Tr(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Ge(de.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=ip(n);throw new Ge(de.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ln(n,e){const t={typeString:n};return e&&(t.value=e),t}function Yl(n,e){if(!v0(n))throw new Ge(de.INVALID_ARGUMENT,"JSON must be an object");let t;for(const s in e)if(e[s]){const a=e[s].typeString,l="value"in e[s]?{value:e[s].value}:void 0;if(!(s in n)){t=`JSON missing required field: '${s}'`;break}const d=n[s];if(a&&typeof d!==a){t=`JSON field '${s}' must be a ${a}.`;break}if(l!==void 0&&d!==l.value){t=`Expected '${s}' field to equal '${l.value}'`;break}}if(t)throw new Ge(de.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qy=-62135596800,Yy=1e6;class Ft{static now(){return Ft.fromMillis(Date.now())}static fromDate(e){return Ft.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),s=Math.floor((e-1e3*t)*Yy);return new Ft(t,s)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ge(de.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ge(de.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Qy)throw new Ge(de.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ge(de.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Yy}_compareTo(e){return this.seconds===e.seconds?at(this.nanoseconds,e.nanoseconds):at(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Ft._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Yl(e,Ft._jsonSchema))return new Ft(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Qy;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Ft._jsonSchemaVersion="firestore/timestamp/1.0",Ft._jsonSchema={type:ln("string",Ft._jsonSchemaVersion),seconds:ln("number"),nanoseconds:ln("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nt{static fromTimestamp(e){return new nt(e)}static min(){return new nt(new Ft(0,0))}static max(){return new nt(new Ft(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ol=-1;function gI(n,e){const t=n.toTimestamp().seconds,s=n.toTimestamp().nanoseconds+1,a=nt.fromTimestamp(s===1e9?new Ft(t+1,0):new Ft(t,s));return new Gi(a,Qe.empty(),e)}function yI(n){return new Gi(n.readTime,n.key,Ol)}class Gi{constructor(e,t,s){this.readTime=e,this.documentKey=t,this.largestBatchId=s}static min(){return new Gi(nt.min(),Qe.empty(),Ol)}static max(){return new Gi(nt.max(),Qe.empty(),Ol)}}function vI(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Qe.comparator(n.documentKey,e.documentKey),t!==0?t:at(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _I="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class wI{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Lo(n){if(n.code!==de.FAILED_PRECONDITION||n.message!==_I)throw n;Fe("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ue{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ze(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ue(((s,a)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(s,a)},this.catchCallback=l=>{this.wrapFailure(t,l).next(s,a)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof ue?t:ue.resolve(t)}catch(t){return ue.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):ue.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):ue.reject(t)}static resolve(e){return new ue(((t,s)=>{t(e)}))}static reject(e){return new ue(((t,s)=>{s(e)}))}static waitFor(e){return new ue(((t,s)=>{let a=0,l=0,d=!1;e.forEach((f=>{++a,f.next((()=>{++l,d&&l===a&&t()}),(m=>s(m)))})),d=!0,l===a&&t()}))}static or(e){let t=ue.resolve(!1);for(const s of e)t=t.next((a=>a?ue.resolve(a):s()));return t}static forEach(e,t){const s=[];return e.forEach(((a,l)=>{s.push(t.call(this,a,l))})),this.waitFor(s)}static mapArray(e,t){return new ue(((s,a)=>{const l=e.length,d=new Array(l);let f=0;for(let m=0;m<l;m++){const v=m;t(e[v]).next((w=>{d[v]=w,++f,f===l&&s(d)}),(w=>a(w)))}}))}static doWhile(e,t){return new ue(((s,a)=>{const l=()=>{e()===!0?t().next((()=>{l()}),a):s()};l()}))}}function xI(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Oo(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xu{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=s=>this._e(s),this.ae=s=>t.writeSequenceNumber(s))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}}Xu.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ap=-1;function Zu(n){return n==null}function ku(n){return n===0&&1/n==-1/0}function EI(n){return typeof n=="number"&&Number.isInteger(n)&&!ku(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _0="";function TI(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Jy(e)),e=SI(n.get(t),e);return Jy(e)}function SI(n,e){let t=e;const s=n.length;for(let a=0;a<s;a++){const l=n.charAt(a);switch(l){case"\0":t+="";break;case _0:t+="";break;default:t+=l}}return t}function Jy(n){return n+_0+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xy(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function na(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function w0(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kt{constructor(e,t){this.comparator=e,this.root=t||Vn.EMPTY}insert(e,t){return new Kt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Vn.BLACK,null,null))}remove(e){return new Kt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Vn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const s=this.comparator(e,t.key);if(s===0)return t.value;s<0?t=t.left:s>0&&(t=t.right)}return null}indexOf(e){let t=0,s=this.root;for(;!s.isEmpty();){const a=this.comparator(e,s.key);if(a===0)return t+s.left.size;a<0?s=s.left:(t+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,s)=>(e(t,s),!1)))}toString(){const e=[];return this.inorderTraversal(((t,s)=>(e.push(`${t}:${s}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new cu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new cu(this.root,e,this.comparator,!1)}getReverseIterator(){return new cu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new cu(this.root,e,this.comparator,!0)}}class cu{constructor(e,t,s,a){this.isReverse=a,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=t?s(e.key,t):1,t&&a&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Vn{constructor(e,t,s,a,l){this.key=e,this.value=t,this.color=s??Vn.RED,this.left=a??Vn.EMPTY,this.right=l??Vn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,s,a,l){return new Vn(e??this.key,t??this.value,s??this.color,a??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,s){let a=this;const l=s(e,a.key);return a=l<0?a.copy(null,null,null,a.left.insert(e,t,s),null):l===0?a.copy(null,t,null,null,null):a.copy(null,null,null,null,a.right.insert(e,t,s)),a.fixUp()}removeMin(){if(this.left.isEmpty())return Vn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let s,a=this;if(t(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,t),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),t(e,a.key)===0){if(a.right.isEmpty())return Vn.EMPTY;s=a.right.min(),a=a.copy(s.key,s.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,t))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Vn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Vn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ze(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ze(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ze(27949);return e+(this.isRed()?0:1)}}Vn.EMPTY=null,Vn.RED=!0,Vn.BLACK=!1;Vn.EMPTY=new class{constructor(){this.size=0}get key(){throw Ze(57766)}get value(){throw Ze(16141)}get color(){throw Ze(16727)}get left(){throw Ze(29726)}get right(){throw Ze(36894)}copy(e,t,s,a,l){return this}insert(e,t,s){return new Vn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gn{constructor(e){this.comparator=e,this.data=new Kt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,s)=>(e(t),!1)))}forEachInRange(e,t){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const a=s.getNext();if(this.comparator(a.key,e[1])>=0)return;t(a.key)}}forEachWhile(e,t){let s;for(s=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Zy(this.data.getIterator())}getIteratorFrom(e){return new Zy(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((s=>{t=t.add(s)})),t}isEqual(e){if(!(e instanceof gn)||this.size!==e.size)return!1;const t=this.data.getIterator(),s=e.data.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=s.getNext().key;if(this.comparator(a,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new gn(this.comparator);return t.data=e,t}}class Zy{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr{constructor(e){this.fields=e,e.sort(Ln.comparator)}static empty(){return new Dr([])}unionWith(e){let t=new gn(Ln.comparator);for(const s of this.fields)t=t.add(s);for(const s of e)t=t.add(s);return new Dr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return So(this.fields,e.fields,((t,s)=>t.isEqual(s)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x0 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class On{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(a){try{return atob(a)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new x0("Invalid base64 string: "+l):l}})(e);return new On(t)}static fromUint8Array(e){const t=(function(a){let l="";for(let d=0;d<a.length;++d)l+=String.fromCharCode(a[d]);return l})(e);return new On(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const s=new Uint8Array(t.length);for(let a=0;a<t.length;a++)s[a]=t.charCodeAt(a);return s})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return at(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}On.EMPTY_BYTE_STRING=new On("");const CI=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Hi(n){if(bt(!!n,39018),typeof n=="string"){let e=0;const t=CI.exec(n);if(bt(!!t,46558,{timestamp:n}),t[1]){let a=t[1];a=(a+"000000000").substr(0,9),e=Number(a)}const s=new Date(n);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:Zt(n.seconds),nanos:Zt(n.nanos)}}function Zt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function qi(n){return typeof n=="string"?On.fromBase64String(n):On.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E0="server_timestamp",T0="__type__",S0="__previous_value__",C0="__local_write_time__";function op(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[T0])===null||t===void 0?void 0:t.stringValue)===E0}function ed(n){const e=n.mapValue.fields[S0];return op(e)?ed(e):e}function Ml(n){const e=Hi(n.mapValue.fields[C0].timestampValue);return new Ft(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class II{constructor(e,t,s,a,l,d,f,m,v,w){this.databaseId=e,this.appId=t,this.persistenceKey=s,this.host=a,this.ssl=l,this.forceLongPolling=d,this.autoDetectLongPolling=f,this.longPollingOptions=m,this.useFetchStreams=v,this.isUsingEmulator=w}}const ju="(default)";class Fl{constructor(e,t){this.projectId=e,this.database=t||ju}static empty(){return new Fl("","")}get isDefaultDatabase(){return this.database===ju}isEqual(e){return e instanceof Fl&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I0="__type__",bI="__max__",uu={mapValue:{}},b0="__vector__",Du="value";function Ki(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?op(n)?4:RI(n)?9007199254740991:PI(n)?10:11:Ze(28295,{value:n})}function Ls(n,e){if(n===e)return!0;const t=Ki(n);if(t!==Ki(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Ml(n).isEqual(Ml(e));case 3:return(function(a,l){if(typeof a.timestampValue=="string"&&typeof l.timestampValue=="string"&&a.timestampValue.length===l.timestampValue.length)return a.timestampValue===l.timestampValue;const d=Hi(a.timestampValue),f=Hi(l.timestampValue);return d.seconds===f.seconds&&d.nanos===f.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(a,l){return qi(a.bytesValue).isEqual(qi(l.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(a,l){return Zt(a.geoPointValue.latitude)===Zt(l.geoPointValue.latitude)&&Zt(a.geoPointValue.longitude)===Zt(l.geoPointValue.longitude)})(n,e);case 2:return(function(a,l){if("integerValue"in a&&"integerValue"in l)return Zt(a.integerValue)===Zt(l.integerValue);if("doubleValue"in a&&"doubleValue"in l){const d=Zt(a.doubleValue),f=Zt(l.doubleValue);return d===f?ku(d)===ku(f):isNaN(d)&&isNaN(f)}return!1})(n,e);case 9:return So(n.arrayValue.values||[],e.arrayValue.values||[],Ls);case 10:case 11:return(function(a,l){const d=a.mapValue.fields||{},f=l.mapValue.fields||{};if(Xy(d)!==Xy(f))return!1;for(const m in d)if(d.hasOwnProperty(m)&&(f[m]===void 0||!Ls(d[m],f[m])))return!1;return!0})(n,e);default:return Ze(52216,{left:n})}}function Ul(n,e){return(n.values||[]).find((t=>Ls(t,e)))!==void 0}function Co(n,e){if(n===e)return 0;const t=Ki(n),s=Ki(e);if(t!==s)return at(t,s);switch(t){case 0:case 9007199254740991:return 0;case 1:return at(n.booleanValue,e.booleanValue);case 2:return(function(l,d){const f=Zt(l.integerValue||l.doubleValue),m=Zt(d.integerValue||d.doubleValue);return f<m?-1:f>m?1:f===m?0:isNaN(f)?isNaN(m)?0:-1:1})(n,e);case 3:return ev(n.timestampValue,e.timestampValue);case 4:return ev(Ml(n),Ml(e));case 5:return wf(n.stringValue,e.stringValue);case 6:return(function(l,d){const f=qi(l),m=qi(d);return f.compareTo(m)})(n.bytesValue,e.bytesValue);case 7:return(function(l,d){const f=l.split("/"),m=d.split("/");for(let v=0;v<f.length&&v<m.length;v++){const w=at(f[v],m[v]);if(w!==0)return w}return at(f.length,m.length)})(n.referenceValue,e.referenceValue);case 8:return(function(l,d){const f=at(Zt(l.latitude),Zt(d.latitude));return f!==0?f:at(Zt(l.longitude),Zt(d.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return tv(n.arrayValue,e.arrayValue);case 10:return(function(l,d){var f,m,v,w;const T=l.fields||{},I=d.fields||{},B=(f=T[Du])===null||f===void 0?void 0:f.arrayValue,X=(m=I[Du])===null||m===void 0?void 0:m.arrayValue,K=at(((v=B==null?void 0:B.values)===null||v===void 0?void 0:v.length)||0,((w=X==null?void 0:X.values)===null||w===void 0?void 0:w.length)||0);return K!==0?K:tv(B,X)})(n.mapValue,e.mapValue);case 11:return(function(l,d){if(l===uu.mapValue&&d===uu.mapValue)return 0;if(l===uu.mapValue)return 1;if(d===uu.mapValue)return-1;const f=l.fields||{},m=Object.keys(f),v=d.fields||{},w=Object.keys(v);m.sort(),w.sort();for(let T=0;T<m.length&&T<w.length;++T){const I=wf(m[T],w[T]);if(I!==0)return I;const B=Co(f[m[T]],v[w[T]]);if(B!==0)return B}return at(m.length,w.length)})(n.mapValue,e.mapValue);default:throw Ze(23264,{le:t})}}function ev(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return at(n,e);const t=Hi(n),s=Hi(e),a=at(t.seconds,s.seconds);return a!==0?a:at(t.nanos,s.nanos)}function tv(n,e){const t=n.values||[],s=e.values||[];for(let a=0;a<t.length&&a<s.length;++a){const l=Co(t[a],s[a]);if(l)return l}return at(t.length,s.length)}function Io(n){return xf(n)}function xf(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const s=Hi(t);return`time(${s.seconds},${s.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return qi(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Qe.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let s="[",a=!0;for(const l of t.values||[])a?a=!1:s+=",",s+=xf(l);return s+"]"})(n.arrayValue):"mapValue"in n?(function(t){const s=Object.keys(t.fields||{}).sort();let a="{",l=!0;for(const d of s)l?l=!1:a+=",",a+=`${d}:${xf(t.fields[d])}`;return a+"}"})(n.mapValue):Ze(61005,{value:n})}function vu(n){switch(Ki(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=ed(n);return e?16+vu(e):16;case 5:return 2*n.stringValue.length;case 6:return qi(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(s){return(s.values||[]).reduce(((a,l)=>a+vu(l)),0)})(n.arrayValue);case 10:case 11:return(function(s){let a=0;return na(s.fields,((l,d)=>{a+=l.length+vu(d)})),a})(n.mapValue);default:throw Ze(13486,{value:n})}}function Ef(n){return!!n&&"integerValue"in n}function lp(n){return!!n&&"arrayValue"in n}function nv(n){return!!n&&"nullValue"in n}function rv(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function _u(n){return!!n&&"mapValue"in n}function PI(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[I0])===null||t===void 0?void 0:t.stringValue)===b0}function Pl(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return na(n.mapValue.fields,((t,s)=>e.mapValue.fields[t]=Pl(s))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Pl(n.arrayValue.values[t]);return e}return Object.assign({},n)}function RI(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===bI}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Er{constructor(e){this.value=e}static empty(){return new Er({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let s=0;s<e.length-1;++s)if(t=(t.mapValue.fields||{})[e.get(s)],!_u(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Pl(t)}setAll(e){let t=Ln.emptyPath(),s={},a=[];e.forEach(((d,f)=>{if(!t.isImmediateParentOf(f)){const m=this.getFieldsMap(t);this.applyChanges(m,s,a),s={},a=[],t=f.popLast()}d?s[f.lastSegment()]=Pl(d):a.push(f.lastSegment())}));const l=this.getFieldsMap(t);this.applyChanges(l,s,a)}delete(e){const t=this.field(e.popLast());_u(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ls(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let s=0;s<e.length;++s){let a=t.mapValue.fields[e.get(s)];_u(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},t.mapValue.fields[e.get(s)]=a),t=a}return t.mapValue.fields}applyChanges(e,t,s){na(t,((a,l)=>e[a]=l));for(const a of s)delete e[a]}clone(){return new Er(Pl(this.value))}}function P0(n){const e=[];return na(n.fields,((t,s)=>{const a=new Ln([t]);if(_u(s)){const l=P0(s.mapValue).fields;if(l.length===0)e.push(a);else for(const d of l)e.push(a.child(d))}else e.push(a)})),new Dr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qn{constructor(e,t,s,a,l,d,f){this.key=e,this.documentType=t,this.version=s,this.readTime=a,this.createTime=l,this.data=d,this.documentState=f}static newInvalidDocument(e){return new qn(e,0,nt.min(),nt.min(),nt.min(),Er.empty(),0)}static newFoundDocument(e,t,s,a){return new qn(e,1,t,nt.min(),s,a,0)}static newNoDocument(e,t){return new qn(e,2,t,nt.min(),nt.min(),Er.empty(),0)}static newUnknownDocument(e,t){return new qn(e,3,t,nt.min(),nt.min(),Er.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(nt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Er.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Er.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=nt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof qn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new qn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vu{constructor(e,t){this.position=e,this.inclusive=t}}function sv(n,e,t){let s=0;for(let a=0;a<n.position.length;a++){const l=e[a],d=n.position[a];if(l.field.isKeyField()?s=Qe.comparator(Qe.fromName(d.referenceValue),t.key):s=Co(d,t.data.field(l.field)),l.dir==="desc"&&(s*=-1),s!==0)break}return s}function iv(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Ls(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lu{constructor(e,t="asc"){this.field=e,this.dir=t}}function NI(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R0{}class mn extends R0{constructor(e,t,s){super(),this.field=e,this.op=t,this.value=s}static create(e,t,s){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,s):new kI(e,t,s):t==="array-contains"?new VI(e,s):t==="in"?new LI(e,s):t==="not-in"?new OI(e,s):t==="array-contains-any"?new MI(e,s):new mn(e,t,s)}static createKeyFieldInFilter(e,t,s){return t==="in"?new jI(e,s):new DI(e,s)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Co(t,this.value)):t!==null&&Ki(this.value)===Ki(t)&&this.matchesComparison(Co(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ze(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Os extends R0{constructor(e,t){super(),this.filters=e,this.op=t,this.he=null}static create(e,t){return new Os(e,t)}matches(e){return N0(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function N0(n){return n.op==="and"}function A0(n){return AI(n)&&N0(n)}function AI(n){for(const e of n.filters)if(e instanceof Os)return!1;return!0}function Tf(n){if(n instanceof mn)return n.field.canonicalString()+n.op.toString()+Io(n.value);if(A0(n))return n.filters.map((e=>Tf(e))).join(",");{const e=n.filters.map((t=>Tf(t))).join(",");return`${n.op}(${e})`}}function k0(n,e){return n instanceof mn?(function(s,a){return a instanceof mn&&s.op===a.op&&s.field.isEqual(a.field)&&Ls(s.value,a.value)})(n,e):n instanceof Os?(function(s,a){return a instanceof Os&&s.op===a.op&&s.filters.length===a.filters.length?s.filters.reduce(((l,d,f)=>l&&k0(d,a.filters[f])),!0):!1})(n,e):void Ze(19439)}function j0(n){return n instanceof mn?(function(t){return`${t.field.canonicalString()} ${t.op} ${Io(t.value)}`})(n):n instanceof Os?(function(t){return t.op.toString()+" {"+t.getFilters().map(j0).join(" ,")+"}"})(n):"Filter"}class kI extends mn{constructor(e,t,s){super(e,t,s),this.key=Qe.fromName(s.referenceValue)}matches(e){const t=Qe.comparator(e.key,this.key);return this.matchesComparison(t)}}class jI extends mn{constructor(e,t){super(e,"in",t),this.keys=D0("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class DI extends mn{constructor(e,t){super(e,"not-in",t),this.keys=D0("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function D0(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map((s=>Qe.fromName(s.referenceValue)))}class VI extends mn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return lp(t)&&Ul(t.arrayValue,this.value)}}class LI extends mn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Ul(this.value.arrayValue,t)}}class OI extends mn{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ul(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Ul(this.value.arrayValue,t)}}class MI extends mn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!lp(t)||!t.arrayValue.values)&&t.arrayValue.values.some((s=>Ul(this.value.arrayValue,s)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FI{constructor(e,t=null,s=[],a=[],l=null,d=null,f=null){this.path=e,this.collectionGroup=t,this.orderBy=s,this.filters=a,this.limit=l,this.startAt=d,this.endAt=f,this.Pe=null}}function av(n,e=null,t=[],s=[],a=null,l=null,d=null){return new FI(n,e,t,s,a,l,d)}function cp(n){const e=st(n);if(e.Pe===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((s=>Tf(s))).join(","),t+="|ob:",t+=e.orderBy.map((s=>(function(l){return l.field.canonicalString()+l.dir})(s))).join(","),Zu(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((s=>Io(s))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((s=>Io(s))).join(",")),e.Pe=t}return e.Pe}function up(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!NI(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!k0(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!iv(n.startAt,e.startAt)&&iv(n.endAt,e.endAt)}function Sf(n){return Qe.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class td{constructor(e,t=null,s=[],a=[],l=null,d="F",f=null,m=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=s,this.filters=a,this.limit=l,this.limitType=d,this.startAt=f,this.endAt=m,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function UI(n,e,t,s,a,l,d,f){return new td(n,e,t,s,a,l,d,f)}function nd(n){return new td(n)}function ov(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function zI(n){return n.collectionGroup!==null}function Rl(n){const e=st(n);if(e.Te===null){e.Te=[];const t=new Set;for(const l of e.explicitOrderBy)e.Te.push(l),t.add(l.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let f=new gn(Ln.comparator);return d.filters.forEach((m=>{m.getFlattenedFilters().forEach((v=>{v.isInequality()&&(f=f.add(v.field))}))})),f})(e).forEach((l=>{t.has(l.canonicalString())||l.isKeyField()||e.Te.push(new Lu(l,s))})),t.has(Ln.keyField().canonicalString())||e.Te.push(new Lu(Ln.keyField(),s))}return e.Te}function ks(n){const e=st(n);return e.Ie||(e.Ie=BI(e,Rl(n))),e.Ie}function BI(n,e){if(n.limitType==="F")return av(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((a=>{const l=a.dir==="desc"?"asc":"desc";return new Lu(a.field,l)}));const t=n.endAt?new Vu(n.endAt.position,n.endAt.inclusive):null,s=n.startAt?new Vu(n.startAt.position,n.startAt.inclusive):null;return av(n.path,n.collectionGroup,e,n.filters,n.limit,t,s)}}function Cf(n,e,t){return new td(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function rd(n,e){return up(ks(n),ks(e))&&n.limitType===e.limitType}function V0(n){return`${cp(ks(n))}|lt:${n.limitType}`}function fo(n){return`Query(target=${(function(t){let s=t.path.canonicalString();return t.collectionGroup!==null&&(s+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(s+=`, filters: [${t.filters.map((a=>j0(a))).join(", ")}]`),Zu(t.limit)||(s+=", limit: "+t.limit),t.orderBy.length>0&&(s+=`, orderBy: [${t.orderBy.map((a=>(function(d){return`${d.field.canonicalString()} (${d.dir})`})(a))).join(", ")}]`),t.startAt&&(s+=", startAt: ",s+=t.startAt.inclusive?"b:":"a:",s+=t.startAt.position.map((a=>Io(a))).join(",")),t.endAt&&(s+=", endAt: ",s+=t.endAt.inclusive?"a:":"b:",s+=t.endAt.position.map((a=>Io(a))).join(",")),`Target(${s})`})(ks(n))}; limitType=${n.limitType})`}function sd(n,e){return e.isFoundDocument()&&(function(s,a){const l=a.key.path;return s.collectionGroup!==null?a.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(l):Qe.isDocumentKey(s.path)?s.path.isEqual(l):s.path.isImmediateParentOf(l)})(n,e)&&(function(s,a){for(const l of Rl(s))if(!l.field.isKeyField()&&a.data.field(l.field)===null)return!1;return!0})(n,e)&&(function(s,a){for(const l of s.filters)if(!l.matches(a))return!1;return!0})(n,e)&&(function(s,a){return!(s.startAt&&!(function(d,f,m){const v=sv(d,f,m);return d.inclusive?v<=0:v<0})(s.startAt,Rl(s),a)||s.endAt&&!(function(d,f,m){const v=sv(d,f,m);return d.inclusive?v>=0:v>0})(s.endAt,Rl(s),a))})(n,e)}function $I(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function L0(n){return(e,t)=>{let s=!1;for(const a of Rl(n)){const l=WI(a,e,t);if(l!==0)return l;s=s||a.field.isKeyField()}return 0}}function WI(n,e,t){const s=n.field.isKeyField()?Qe.comparator(e.key,t.key):(function(l,d,f){const m=d.data.field(l),v=f.data.field(l);return m!==null&&v!==null?Co(m,v):Ze(42886)})(n.field,e,t);switch(n.dir){case"asc":return s;case"desc":return-1*s;default:return Ze(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aa{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s!==void 0){for(const[a,l]of s)if(this.equalsFn(a,e))return l}}has(e){return this.get(e)!==void 0}set(e,t){const s=this.mapKeyFn(e),a=this.inner[s];if(a===void 0)return this.inner[s]=[[e,t]],void this.innerSize++;for(let l=0;l<a.length;l++)if(this.equalsFn(a[l][0],e))return void(a[l]=[e,t]);a.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s===void 0)return!1;for(let a=0;a<s.length;a++)if(this.equalsFn(s[a][0],e))return s.length===1?delete this.inner[t]:s.splice(a,1),this.innerSize--,!0;return!1}forEach(e){na(this.inner,((t,s)=>{for(const[a,l]of s)e(a,l)}))}isEmpty(){return w0(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GI=new Kt(Qe.comparator);function di(){return GI}const O0=new Kt(Qe.comparator);function El(...n){let e=O0;for(const t of n)e=e.insert(t.key,t);return e}function M0(n){let e=O0;return n.forEach(((t,s)=>e=e.insert(t,s.overlayedDocument))),e}function Ta(){return Nl()}function F0(){return Nl()}function Nl(){return new Aa((n=>n.toString()),((n,e)=>n.isEqual(e)))}const HI=new Kt(Qe.comparator),qI=new gn(Qe.comparator);function ht(...n){let e=qI;for(const t of n)e=e.add(t);return e}const KI=new gn(at);function QI(){return KI}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dp(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ku(e)?"-0":e}}function U0(n){return{integerValue:""+n}}function YI(n,e){return EI(e)?U0(e):dp(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class id{constructor(){this._=void 0}}function JI(n,e,t){return n instanceof zl?(function(a,l){const d={fields:{[T0]:{stringValue:E0},[C0]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return l&&op(l)&&(l=ed(l)),l&&(d.fields[S0]=l),{mapValue:d}})(t,e):n instanceof Bl?B0(n,e):n instanceof $l?$0(n,e):(function(a,l){const d=z0(a,l),f=lv(d)+lv(a.Ee);return Ef(d)&&Ef(a.Ee)?U0(f):dp(a.serializer,f)})(n,e)}function XI(n,e,t){return n instanceof Bl?B0(n,e):n instanceof $l?$0(n,e):t}function z0(n,e){return n instanceof Ou?(function(s){return Ef(s)||(function(l){return!!l&&"doubleValue"in l})(s)})(e)?e:{integerValue:0}:null}class zl extends id{}class Bl extends id{constructor(e){super(),this.elements=e}}function B0(n,e){const t=W0(e);for(const s of n.elements)t.some((a=>Ls(a,s)))||t.push(s);return{arrayValue:{values:t}}}class $l extends id{constructor(e){super(),this.elements=e}}function $0(n,e){let t=W0(e);for(const s of n.elements)t=t.filter((a=>!Ls(a,s)));return{arrayValue:{values:t}}}class Ou extends id{constructor(e,t){super(),this.serializer=e,this.Ee=t}}function lv(n){return Zt(n.integerValue||n.doubleValue)}function W0(n){return lp(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZI{constructor(e,t){this.field=e,this.transform=t}}function eb(n,e){return n.field.isEqual(e.field)&&(function(s,a){return s instanceof Bl&&a instanceof Bl||s instanceof $l&&a instanceof $l?So(s.elements,a.elements,Ls):s instanceof Ou&&a instanceof Ou?Ls(s.Ee,a.Ee):s instanceof zl&&a instanceof zl})(n.transform,e.transform)}class tb{constructor(e,t){this.version=e,this.transformResults=t}}class Qr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Qr}static exists(e){return new Qr(void 0,e)}static updateTime(e){return new Qr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function wu(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class ad{}function G0(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new hp(n.key,Qr.none()):new Jl(n.key,n.data,Qr.none());{const t=n.data,s=Er.empty();let a=new gn(Ln.comparator);for(let l of e.fields)if(!a.has(l)){let d=t.field(l);d===null&&l.length>1&&(l=l.popLast(),d=t.field(l)),d===null?s.delete(l):s.set(l,d),a=a.add(l)}return new ra(n.key,s,new Dr(a.toArray()),Qr.none())}}function nb(n,e,t){n instanceof Jl?(function(a,l,d){const f=a.value.clone(),m=uv(a.fieldTransforms,l,d.transformResults);f.setAll(m),l.convertToFoundDocument(d.version,f).setHasCommittedMutations()})(n,e,t):n instanceof ra?(function(a,l,d){if(!wu(a.precondition,l))return void l.convertToUnknownDocument(d.version);const f=uv(a.fieldTransforms,l,d.transformResults),m=l.data;m.setAll(H0(a)),m.setAll(f),l.convertToFoundDocument(d.version,m).setHasCommittedMutations()})(n,e,t):(function(a,l,d){l.convertToNoDocument(d.version).setHasCommittedMutations()})(0,e,t)}function Al(n,e,t,s){return n instanceof Jl?(function(l,d,f,m){if(!wu(l.precondition,d))return f;const v=l.value.clone(),w=dv(l.fieldTransforms,m,d);return v.setAll(w),d.convertToFoundDocument(d.version,v).setHasLocalMutations(),null})(n,e,t,s):n instanceof ra?(function(l,d,f,m){if(!wu(l.precondition,d))return f;const v=dv(l.fieldTransforms,m,d),w=d.data;return w.setAll(H0(l)),w.setAll(v),d.convertToFoundDocument(d.version,w).setHasLocalMutations(),f===null?null:f.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((T=>T.field)))})(n,e,t,s):(function(l,d,f){return wu(l.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):f})(n,e,t)}function rb(n,e){let t=null;for(const s of n.fieldTransforms){const a=e.data.field(s.field),l=z0(s.transform,a||null);l!=null&&(t===null&&(t=Er.empty()),t.set(s.field,l))}return t||null}function cv(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(s,a){return s===void 0&&a===void 0||!(!s||!a)&&So(s,a,((l,d)=>eb(l,d)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Jl extends ad{constructor(e,t,s,a=[]){super(),this.key=e,this.value=t,this.precondition=s,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class ra extends ad{constructor(e,t,s,a,l=[]){super(),this.key=e,this.data=t,this.fieldMask=s,this.precondition=a,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function H0(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const s=n.data.field(t);e.set(t,s)}})),e}function uv(n,e,t){const s=new Map;bt(n.length===t.length,32656,{Ae:t.length,Re:n.length});for(let a=0;a<t.length;a++){const l=n[a],d=l.transform,f=e.data.field(l.field);s.set(l.field,XI(d,f,t[a]))}return s}function dv(n,e,t){const s=new Map;for(const a of n){const l=a.transform,d=t.data.field(a.field);s.set(a.field,JI(l,d,e))}return s}class hp extends ad{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class sb extends ad{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ib{constructor(e,t,s,a){this.batchId=e,this.localWriteTime=t,this.baseMutations=s,this.mutations=a}applyToRemoteDocument(e,t){const s=t.mutationResults;for(let a=0;a<this.mutations.length;a++){const l=this.mutations[a];l.key.isEqual(e.key)&&nb(l,e,s[a])}}applyToLocalView(e,t){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(t=Al(s,e,t,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(t=Al(s,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const s=F0();return this.mutations.forEach((a=>{const l=e.get(a.key),d=l.overlayedDocument;let f=this.applyToLocalView(d,l.mutatedFields);f=t.has(a.key)?null:f;const m=G0(d,f);m!==null&&s.set(a.key,m),d.isValidDocument()||d.convertToNoDocument(nt.min())})),s}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),ht())}isEqual(e){return this.batchId===e.batchId&&So(this.mutations,e.mutations,((t,s)=>cv(t,s)))&&So(this.baseMutations,e.baseMutations,((t,s)=>cv(t,s)))}}class fp{constructor(e,t,s,a){this.batch=e,this.commitVersion=t,this.mutationResults=s,this.docVersions=a}static from(e,t,s){bt(e.mutations.length===s.length,58842,{Ve:e.mutations.length,me:s.length});let a=(function(){return HI})();const l=e.mutations;for(let d=0;d<l.length;d++)a=a.insert(l[d].key,s[d].version);return new fp(e,t,s,a)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ab{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ob{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var on,yt;function lb(n){switch(n){case de.OK:return Ze(64938);case de.CANCELLED:case de.UNKNOWN:case de.DEADLINE_EXCEEDED:case de.RESOURCE_EXHAUSTED:case de.INTERNAL:case de.UNAVAILABLE:case de.UNAUTHENTICATED:return!1;case de.INVALID_ARGUMENT:case de.NOT_FOUND:case de.ALREADY_EXISTS:case de.PERMISSION_DENIED:case de.FAILED_PRECONDITION:case de.ABORTED:case de.OUT_OF_RANGE:case de.UNIMPLEMENTED:case de.DATA_LOSS:return!0;default:return Ze(15467,{code:n})}}function q0(n){if(n===void 0)return ui("GRPC error has no .code"),de.UNKNOWN;switch(n){case on.OK:return de.OK;case on.CANCELLED:return de.CANCELLED;case on.UNKNOWN:return de.UNKNOWN;case on.DEADLINE_EXCEEDED:return de.DEADLINE_EXCEEDED;case on.RESOURCE_EXHAUSTED:return de.RESOURCE_EXHAUSTED;case on.INTERNAL:return de.INTERNAL;case on.UNAVAILABLE:return de.UNAVAILABLE;case on.UNAUTHENTICATED:return de.UNAUTHENTICATED;case on.INVALID_ARGUMENT:return de.INVALID_ARGUMENT;case on.NOT_FOUND:return de.NOT_FOUND;case on.ALREADY_EXISTS:return de.ALREADY_EXISTS;case on.PERMISSION_DENIED:return de.PERMISSION_DENIED;case on.FAILED_PRECONDITION:return de.FAILED_PRECONDITION;case on.ABORTED:return de.ABORTED;case on.OUT_OF_RANGE:return de.OUT_OF_RANGE;case on.UNIMPLEMENTED:return de.UNIMPLEMENTED;case on.DATA_LOSS:return de.DATA_LOSS;default:return Ze(39323,{code:n})}}(yt=on||(on={}))[yt.OK=0]="OK",yt[yt.CANCELLED=1]="CANCELLED",yt[yt.UNKNOWN=2]="UNKNOWN",yt[yt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",yt[yt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",yt[yt.NOT_FOUND=5]="NOT_FOUND",yt[yt.ALREADY_EXISTS=6]="ALREADY_EXISTS",yt[yt.PERMISSION_DENIED=7]="PERMISSION_DENIED",yt[yt.UNAUTHENTICATED=16]="UNAUTHENTICATED",yt[yt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",yt[yt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",yt[yt.ABORTED=10]="ABORTED",yt[yt.OUT_OF_RANGE=11]="OUT_OF_RANGE",yt[yt.UNIMPLEMENTED=12]="UNIMPLEMENTED",yt[yt.INTERNAL=13]="INTERNAL",yt[yt.UNAVAILABLE=14]="UNAVAILABLE",yt[yt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cb=new Bi([4294967295,4294967295],0);function hv(n){const e=g0().encode(n),t=new l0;return t.update(e),new Uint8Array(t.digest())}function fv(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),s=e.getUint32(4,!0),a=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new Bi([t,s],0),new Bi([a,l],0)]}class pp{constructor(e,t,s){if(this.bitmap=e,this.padding=t,this.hashCount=s,t<0||t>=8)throw new Tl(`Invalid padding: ${t}`);if(s<0)throw new Tl(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new Tl(`Invalid hash count: ${s}`);if(e.length===0&&t!==0)throw new Tl(`Invalid padding when bitmap length is 0: ${t}`);this.fe=8*e.length-t,this.ge=Bi.fromNumber(this.fe)}pe(e,t,s){let a=e.add(t.multiply(Bi.fromNumber(s)));return a.compare(cb)===1&&(a=new Bi([a.getBits(0),a.getBits(1)],0)),a.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;const t=hv(e),[s,a]=fv(t);for(let l=0;l<this.hashCount;l++){const d=this.pe(s,a,l);if(!this.ye(d))return!1}return!0}static create(e,t,s){const a=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),d=new pp(l,a,t);return s.forEach((f=>d.insert(f))),d}insert(e){if(this.fe===0)return;const t=hv(e),[s,a]=fv(t);for(let l=0;l<this.hashCount;l++){const d=this.pe(s,a,l);this.we(d)}}we(e){const t=Math.floor(e/8),s=e%8;this.bitmap[t]|=1<<s}}class Tl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class od{constructor(e,t,s,a,l){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=s,this.documentUpdates=a,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,t,s){const a=new Map;return a.set(e,Xl.createSynthesizedTargetChangeForCurrentChange(e,t,s)),new od(nt.min(),a,new Kt(at),di(),ht())}}class Xl{constructor(e,t,s,a,l){this.resumeToken=e,this.current=t,this.addedDocuments=s,this.modifiedDocuments=a,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,t,s){return new Xl(s,t,ht(),ht(),ht())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xu{constructor(e,t,s,a){this.Se=e,this.removedTargetIds=t,this.key=s,this.be=a}}class K0{constructor(e,t){this.targetId=e,this.De=t}}class Q0{constructor(e,t,s=On.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=t,this.resumeToken=s,this.cause=a}}class pv{constructor(){this.ve=0,this.Ce=mv(),this.Fe=On.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=ht(),t=ht(),s=ht();return this.Ce.forEach(((a,l)=>{switch(l){case 0:e=e.add(a);break;case 2:t=t.add(a);break;case 1:s=s.add(a);break;default:Ze(38017,{changeType:l})}})),new Xl(this.Fe,this.Me,e,t,s)}ke(){this.xe=!1,this.Ce=mv()}qe(e,t){this.xe=!0,this.Ce=this.Ce.insert(e,t)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,bt(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class ub{constructor(e){this.We=e,this.Ge=new Map,this.ze=di(),this.je=du(),this.Je=du(),this.He=new Kt(at)}Ye(e){for(const t of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(t,e.be):this.Xe(t,e.key,e.be);for(const t of e.removedTargetIds)this.Xe(t,e.key,e.be)}et(e){this.forEachTarget(e,(t=>{const s=this.tt(t);switch(e.state){case 0:this.nt(t)&&s.Be(e.resumeToken);break;case 1:s.Ue(),s.Oe||s.ke(),s.Be(e.resumeToken);break;case 2:s.Ue(),s.Oe||this.removeTarget(t);break;case 3:this.nt(t)&&(s.Ke(),s.Be(e.resumeToken));break;case 4:this.nt(t)&&(this.rt(t),s.Be(e.resumeToken));break;default:Ze(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ge.forEach(((s,a)=>{this.nt(a)&&t(a)}))}it(e){const t=e.targetId,s=e.De.count,a=this.st(t);if(a){const l=a.target;if(Sf(l))if(s===0){const d=new Qe(l.path);this.Xe(t,d,qn.newNoDocument(d,nt.min()))}else bt(s===1,20013,{expectedCount:s});else{const d=this.ot(t);if(d!==s){const f=this._t(e),m=f?this.ut(f,e,d):1;if(m!==0){this.rt(t);const v=m===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(t,v)}}}}}_t(e){const t=e.De.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:s="",padding:a=0},hashCount:l=0}=t;let d,f;try{d=qi(s).toUint8Array()}catch(m){if(m instanceof x0)return Wi("Decoding the base64 bloom filter in existence filter failed ("+m.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw m}try{f=new pp(d,a,l)}catch(m){return Wi(m instanceof Tl?"BloomFilter error: ":"Applying bloom filter failed: ",m),null}return f.fe===0?null:f}ut(e,t,s){return t.De.count===s-this.ht(e,t.targetId)?0:2}ht(e,t){const s=this.We.getRemoteKeysForTarget(t);let a=0;return s.forEach((l=>{const d=this.We.lt(),f=`projects/${d.projectId}/databases/${d.database}/documents/${l.path.canonicalString()}`;e.mightContain(f)||(this.Xe(t,l,null),a++)})),a}Pt(e){const t=new Map;this.Ge.forEach(((l,d)=>{const f=this.st(d);if(f){if(l.current&&Sf(f.target)){const m=new Qe(f.target.path);this.Tt(m).has(d)||this.It(d,m)||this.Xe(d,m,qn.newNoDocument(m,e))}l.Ne&&(t.set(d,l.Le()),l.ke())}}));let s=ht();this.Je.forEach(((l,d)=>{let f=!0;d.forEachWhile((m=>{const v=this.st(m);return!v||v.purpose==="TargetPurposeLimboResolution"||(f=!1,!1)})),f&&(s=s.add(l))})),this.ze.forEach(((l,d)=>d.setReadTime(e)));const a=new od(e,t,this.He,this.ze,s);return this.ze=di(),this.je=du(),this.Je=du(),this.He=new Kt(at),a}Ze(e,t){if(!this.nt(e))return;const s=this.It(e,t.key)?2:0;this.tt(e).qe(t.key,s),this.ze=this.ze.insert(t.key,t),this.je=this.je.insert(t.key,this.Tt(t.key).add(e)),this.Je=this.Je.insert(t.key,this.dt(t.key).add(e))}Xe(e,t,s){if(!this.nt(e))return;const a=this.tt(e);this.It(e,t)?a.qe(t,1):a.Qe(t),this.Je=this.Je.insert(t,this.dt(t).delete(e)),this.Je=this.Je.insert(t,this.dt(t).add(e)),s&&(this.ze=this.ze.insert(t,s))}removeTarget(e){this.Ge.delete(e)}ot(e){const t=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let t=this.Ge.get(e);return t||(t=new pv,this.Ge.set(e,t)),t}dt(e){let t=this.Je.get(e);return t||(t=new gn(at),this.Je=this.Je.insert(e,t)),t}Tt(e){let t=this.je.get(e);return t||(t=new gn(at),this.je=this.je.insert(e,t)),t}nt(e){const t=this.st(e)!==null;return t||Fe("WatchChangeAggregator","Detected inactive target",e),t}st(e){const t=this.Ge.get(e);return t&&t.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new pv),this.We.getRemoteKeysForTarget(e).forEach((t=>{this.Xe(e,t,null)}))}It(e,t){return this.We.getRemoteKeysForTarget(e).has(t)}}function du(){return new Kt(Qe.comparator)}function mv(){return new Kt(Qe.comparator)}const db={asc:"ASCENDING",desc:"DESCENDING"},hb={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},fb={and:"AND",or:"OR"};class pb{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function If(n,e){return n.useProto3Json||Zu(e)?e:{value:e}}function Mu(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Y0(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function mb(n,e){return Mu(n,e.toTimestamp())}function js(n){return bt(!!n,49232),nt.fromTimestamp((function(t){const s=Hi(t);return new Ft(s.seconds,s.nanos)})(n))}function mp(n,e){return bf(n,e).canonicalString()}function bf(n,e){const t=(function(a){return new Mt(["projects",a.projectId,"databases",a.database])})(n).child("documents");return e===void 0?t:t.child(e)}function J0(n){const e=Mt.fromString(n);return bt(nw(e),10190,{key:e.toString()}),e}function Pf(n,e){return mp(n.databaseId,e.path)}function Zh(n,e){const t=J0(e);if(t.get(1)!==n.databaseId.projectId)throw new Ge(de.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Ge(de.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Qe(Z0(t))}function X0(n,e){return mp(n.databaseId,e)}function gb(n){const e=J0(n);return e.length===4?Mt.emptyPath():Z0(e)}function Rf(n){return new Mt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Z0(n){return bt(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function gv(n,e,t){return{name:Pf(n,e),fields:t.value.mapValue.fields}}function yb(n,e){let t;if("targetChange"in e){e.targetChange;const s=(function(v){return v==="NO_CHANGE"?0:v==="ADD"?1:v==="REMOVE"?2:v==="CURRENT"?3:v==="RESET"?4:Ze(39313,{state:v})})(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],l=(function(v,w){return v.useProto3Json?(bt(w===void 0||typeof w=="string",58123),On.fromBase64String(w||"")):(bt(w===void 0||w instanceof Buffer||w instanceof Uint8Array,16193),On.fromUint8Array(w||new Uint8Array))})(n,e.targetChange.resumeToken),d=e.targetChange.cause,f=d&&(function(v){const w=v.code===void 0?de.UNKNOWN:q0(v.code);return new Ge(w,v.message||"")})(d);t=new Q0(s,a,l,f||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const a=Zh(n,s.document.name),l=js(s.document.updateTime),d=s.document.createTime?js(s.document.createTime):nt.min(),f=new Er({mapValue:{fields:s.document.fields}}),m=qn.newFoundDocument(a,l,d,f),v=s.targetIds||[],w=s.removedTargetIds||[];t=new xu(v,w,m.key,m)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const a=Zh(n,s.document),l=s.readTime?js(s.readTime):nt.min(),d=qn.newNoDocument(a,l),f=s.removedTargetIds||[];t=new xu([],f,d.key,d)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const a=Zh(n,s.document),l=s.removedTargetIds||[];t=new xu([],l,a,null)}else{if(!("filter"in e))return Ze(11601,{At:e});{e.filter;const s=e.filter;s.targetId;const{count:a=0,unchangedNames:l}=s,d=new ob(a,l),f=s.targetId;t=new K0(f,d)}}return t}function vb(n,e){let t;if(e instanceof Jl)t={update:gv(n,e.key,e.value)};else if(e instanceof hp)t={delete:Pf(n,e.key)};else if(e instanceof ra)t={update:gv(n,e.key,e.data),updateMask:bb(e.fieldMask)};else{if(!(e instanceof sb))return Ze(16599,{Rt:e.type});t={verify:Pf(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((s=>(function(l,d){const f=d.transform;if(f instanceof zl)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(f instanceof Bl)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:f.elements}};if(f instanceof $l)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:f.elements}};if(f instanceof Ou)return{fieldPath:d.field.canonicalString(),increment:f.Ee};throw Ze(20930,{transform:d.transform})})(0,s)))),e.precondition.isNone||(t.currentDocument=(function(a,l){return l.updateTime!==void 0?{updateTime:mb(a,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:Ze(27497)})(n,e.precondition)),t}function _b(n,e){return n&&n.length>0?(bt(e!==void 0,14353),n.map((t=>(function(a,l){let d=a.updateTime?js(a.updateTime):js(l);return d.isEqual(nt.min())&&(d=js(l)),new tb(d,a.transformResults||[])})(t,e)))):[]}function wb(n,e){return{documents:[X0(n,e.path)]}}function xb(n,e){const t={structuredQuery:{}},s=e.path;let a;e.collectionGroup!==null?(a=s,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=s.popLast(),t.structuredQuery.from=[{collectionId:s.lastSegment()}]),t.parent=X0(n,a);const l=(function(v){if(v.length!==0)return tw(Os.create(v,"and"))})(e.filters);l&&(t.structuredQuery.where=l);const d=(function(v){if(v.length!==0)return v.map((w=>(function(I){return{field:po(I.field),direction:Sb(I.dir)}})(w)))})(e.orderBy);d&&(t.structuredQuery.orderBy=d);const f=If(n,e.limit);return f!==null&&(t.structuredQuery.limit=f),e.startAt&&(t.structuredQuery.startAt=(function(v){return{before:v.inclusive,values:v.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(v){return{before:!v.inclusive,values:v.position}})(e.endAt)),{Vt:t,parent:a}}function Eb(n){let e=gb(n.parent);const t=n.structuredQuery,s=t.from?t.from.length:0;let a=null;if(s>0){bt(s===1,65062);const w=t.from[0];w.allDescendants?a=w.collectionId:e=e.child(w.collectionId)}let l=[];t.where&&(l=(function(T){const I=ew(T);return I instanceof Os&&A0(I)?I.getFilters():[I]})(t.where));let d=[];t.orderBy&&(d=(function(T){return T.map((I=>(function(X){return new Lu(mo(X.field),(function(M){switch(M){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(X.direction))})(I)))})(t.orderBy));let f=null;t.limit&&(f=(function(T){let I;return I=typeof T=="object"?T.value:T,Zu(I)?null:I})(t.limit));let m=null;t.startAt&&(m=(function(T){const I=!!T.before,B=T.values||[];return new Vu(B,I)})(t.startAt));let v=null;return t.endAt&&(v=(function(T){const I=!T.before,B=T.values||[];return new Vu(B,I)})(t.endAt)),UI(e,a,d,l,f,"F",m,v)}function Tb(n,e){const t=(function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ze(28987,{purpose:a})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function ew(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const s=mo(t.unaryFilter.field);return mn.create(s,"==",{doubleValue:NaN});case"IS_NULL":const a=mo(t.unaryFilter.field);return mn.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=mo(t.unaryFilter.field);return mn.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=mo(t.unaryFilter.field);return mn.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ze(61313);default:return Ze(60726)}})(n):n.fieldFilter!==void 0?(function(t){return mn.create(mo(t.fieldFilter.field),(function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ze(58110);default:return Ze(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Os.create(t.compositeFilter.filters.map((s=>ew(s))),(function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return Ze(1026)}})(t.compositeFilter.op))})(n):Ze(30097,{filter:n})}function Sb(n){return db[n]}function Cb(n){return hb[n]}function Ib(n){return fb[n]}function po(n){return{fieldPath:n.canonicalString()}}function mo(n){return Ln.fromServerFormat(n.fieldPath)}function tw(n){return n instanceof mn?(function(t){if(t.op==="=="){if(rv(t.value))return{unaryFilter:{field:po(t.field),op:"IS_NAN"}};if(nv(t.value))return{unaryFilter:{field:po(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(rv(t.value))return{unaryFilter:{field:po(t.field),op:"IS_NOT_NAN"}};if(nv(t.value))return{unaryFilter:{field:po(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:po(t.field),op:Cb(t.op),value:t.value}}})(n):n instanceof Os?(function(t){const s=t.getFilters().map((a=>tw(a)));return s.length===1?s[0]:{compositeFilter:{op:Ib(t.op),filters:s}}})(n):Ze(54877,{filter:n})}function bb(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function nw(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oi{constructor(e,t,s,a,l=nt.min(),d=nt.min(),f=On.EMPTY_BYTE_STRING,m=null){this.target=e,this.targetId=t,this.purpose=s,this.sequenceNumber=a,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=f,this.expectedCount=m}withSequenceNumber(e){return new Oi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Oi(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Oi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Oi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pb{constructor(e){this.gt=e}}function Rb(n){const e=Eb({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Cf(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nb{constructor(){this.Dn=new Ab}addToCollectionParentIndex(e,t){return this.Dn.add(t),ue.resolve()}getCollectionParents(e,t){return ue.resolve(this.Dn.getEntries(t))}addFieldIndex(e,t){return ue.resolve()}deleteFieldIndex(e,t){return ue.resolve()}deleteAllFieldIndexes(e){return ue.resolve()}createTargetIndexes(e,t){return ue.resolve()}getDocumentsMatchingTarget(e,t){return ue.resolve(null)}getIndexType(e,t){return ue.resolve(0)}getFieldIndexes(e,t){return ue.resolve([])}getNextCollectionGroupToUpdate(e){return ue.resolve(null)}getMinOffset(e,t){return ue.resolve(Gi.min())}getMinOffsetFromCollectionGroup(e,t){return ue.resolve(Gi.min())}updateCollectionGroup(e,t,s){return ue.resolve()}updateIndexEntries(e,t){return ue.resolve()}}class Ab{constructor(){this.index={}}add(e){const t=e.lastSegment(),s=e.popLast(),a=this.index[t]||new gn(Mt.comparator),l=!a.has(s);return this.index[t]=a.add(s),l}has(e){const t=e.lastSegment(),s=e.popLast(),a=this.index[t];return a&&a.has(s)}getEntries(e){return(this.index[e]||new gn(Mt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yv={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},rw=41943040;class xr{static withCacheSize(e){return new xr(e,xr.DEFAULT_COLLECTION_PERCENTILE,xr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */xr.DEFAULT_COLLECTION_PERCENTILE=10,xr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,xr.DEFAULT=new xr(rw,xr.DEFAULT_COLLECTION_PERCENTILE,xr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),xr.DISABLED=new xr(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bo{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new bo(0)}static ur(){return new bo(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vv="LruGarbageCollector",kb=1048576;function _v([n,e],[t,s]){const a=at(n,t);return a===0?at(e,s):a}class jb{constructor(e){this.Tr=e,this.buffer=new gn(_v),this.Ir=0}dr(){return++this.Ir}Er(e){const t=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(t);else{const s=this.buffer.last();_v(t,s)<0&&(this.buffer=this.buffer.delete(s).add(t))}}get maxValue(){return this.buffer.last()[0]}}class Db{constructor(e,t,s){this.garbageCollector=e,this.asyncQueue=t,this.localStore=s,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){Fe(vv,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Oo(t)?Fe(vv,"Ignoring IndexedDB error during garbage collection: ",t):await Lo(t)}await this.Rr(3e5)}))}}class Vb{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.mr(e).next((s=>Math.floor(t/100*s)))}nthSequenceNumber(e,t){if(t===0)return ue.resolve(Xu.ue);const s=new jb(t);return this.Vr.forEachTarget(e,(a=>s.Er(a.sequenceNumber))).next((()=>this.Vr.gr(e,(a=>s.Er(a))))).next((()=>s.maxValue))}removeTargets(e,t,s){return this.Vr.removeTargets(e,t,s)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Fe("LruGarbageCollector","Garbage collection skipped; disabled"),ue.resolve(yv)):this.getCacheSize(e).next((s=>s<this.params.cacheSizeCollectionThreshold?(Fe("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),yv):this.pr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,t){let s,a,l,d,f,m,v;const w=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((T=>(T>this.params.maximumSequenceNumbersToCollect?(Fe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${T}`),a=this.params.maximumSequenceNumbersToCollect):a=T,d=Date.now(),this.nthSequenceNumber(e,a)))).next((T=>(s=T,f=Date.now(),this.removeTargets(e,s,t)))).next((T=>(l=T,m=Date.now(),this.removeOrphanedDocuments(e,s)))).next((T=>(v=Date.now(),ho()<=dt.DEBUG&&Fe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-w}ms
	Determined least recently used ${a} in `+(f-d)+`ms
	Removed ${l} targets in `+(m-f)+`ms
	Removed ${T} documents in `+(v-m)+`ms
Total Duration: ${v-w}ms`),ue.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:l,documentsRemoved:T}))))}}function Lb(n,e){return new Vb(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ob{constructor(){this.changes=new Aa((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,qn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const s=this.changes.get(t);return s!==void 0?ue.resolve(s):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mb{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fb{constructor(e,t,s,a){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=s,this.indexManager=a}getDocument(e,t){let s=null;return this.documentOverlayCache.getOverlay(e,t).next((a=>(s=a,this.remoteDocumentCache.getEntry(e,t)))).next((a=>(s!==null&&Al(s.mutation,a,Dr.empty(),Ft.now()),a)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((s=>this.getLocalViewOfDocuments(e,s,ht()).next((()=>s))))}getLocalViewOfDocuments(e,t,s=ht()){const a=Ta();return this.populateOverlays(e,a,t).next((()=>this.computeViews(e,t,a,s).next((l=>{let d=El();return l.forEach(((f,m)=>{d=d.insert(f,m.overlayedDocument)})),d}))))}getOverlayedDocuments(e,t){const s=Ta();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,ht())))}populateOverlays(e,t,s){const a=[];return s.forEach((l=>{t.has(l)||a.push(l)})),this.documentOverlayCache.getOverlays(e,a).next((l=>{l.forEach(((d,f)=>{t.set(d,f)}))}))}computeViews(e,t,s,a){let l=di();const d=Nl(),f=(function(){return Nl()})();return t.forEach(((m,v)=>{const w=s.get(v.key);a.has(v.key)&&(w===void 0||w.mutation instanceof ra)?l=l.insert(v.key,v):w!==void 0?(d.set(v.key,w.mutation.getFieldMask()),Al(w.mutation,v,w.mutation.getFieldMask(),Ft.now())):d.set(v.key,Dr.empty())})),this.recalculateAndSaveOverlays(e,l).next((m=>(m.forEach(((v,w)=>d.set(v,w))),t.forEach(((v,w)=>{var T;return f.set(v,new Mb(w,(T=d.get(v))!==null&&T!==void 0?T:null))})),f)))}recalculateAndSaveOverlays(e,t){const s=Nl();let a=new Kt(((d,f)=>d-f)),l=ht();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((d=>{for(const f of d)f.keys().forEach((m=>{const v=t.get(m);if(v===null)return;let w=s.get(m)||Dr.empty();w=f.applyToLocalView(v,w),s.set(m,w);const T=(a.get(f.batchId)||ht()).add(m);a=a.insert(f.batchId,T)}))})).next((()=>{const d=[],f=a.getReverseIterator();for(;f.hasNext();){const m=f.getNext(),v=m.key,w=m.value,T=F0();w.forEach((I=>{if(!l.has(I)){const B=G0(t.get(I),s.get(I));B!==null&&T.set(I,B),l=l.add(I)}})),d.push(this.documentOverlayCache.saveOverlays(e,v,T))}return ue.waitFor(d)})).next((()=>s))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((s=>this.recalculateAndSaveOverlays(e,s)))}getDocumentsMatchingQuery(e,t,s,a){return(function(d){return Qe.isDocumentKey(d.path)&&d.collectionGroup===null&&d.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):zI(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,s,a):this.getDocumentsMatchingCollectionQuery(e,t,s,a)}getNextDocuments(e,t,s,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,s,a).next((l=>{const d=a-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,s.largestBatchId,a-l.size):ue.resolve(Ta());let f=Ol,m=l;return d.next((v=>ue.forEach(v,((w,T)=>(f<T.largestBatchId&&(f=T.largestBatchId),l.get(w)?ue.resolve():this.remoteDocumentCache.getEntry(e,w).next((I=>{m=m.insert(w,I)}))))).next((()=>this.populateOverlays(e,v,l))).next((()=>this.computeViews(e,m,v,ht()))).next((w=>({batchId:f,changes:M0(w)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Qe(t)).next((s=>{let a=El();return s.isFoundDocument()&&(a=a.insert(s.key,s)),a}))}getDocumentsMatchingCollectionGroupQuery(e,t,s,a){const l=t.collectionGroup;let d=El();return this.indexManager.getCollectionParents(e,l).next((f=>ue.forEach(f,(m=>{const v=(function(T,I){return new td(I,null,T.explicitOrderBy.slice(),T.filters.slice(),T.limit,T.limitType,T.startAt,T.endAt)})(t,m.child(l));return this.getDocumentsMatchingCollectionQuery(e,v,s,a).next((w=>{w.forEach(((T,I)=>{d=d.insert(T,I)}))}))})).next((()=>d))))}getDocumentsMatchingCollectionQuery(e,t,s,a){let l;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,s.largestBatchId).next((d=>(l=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,s,l,a)))).next((d=>{l.forEach(((m,v)=>{const w=v.getKey();d.get(w)===null&&(d=d.insert(w,qn.newInvalidDocument(w)))}));let f=El();return d.forEach(((m,v)=>{const w=l.get(m);w!==void 0&&Al(w.mutation,v,Dr.empty(),Ft.now()),sd(t,v)&&(f=f.insert(m,v))})),f}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ub{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,t){return ue.resolve(this.Br.get(t))}saveBundleMetadata(e,t){return this.Br.set(t.id,(function(a){return{id:a.id,version:a.version,createTime:js(a.createTime)}})(t)),ue.resolve()}getNamedQuery(e,t){return ue.resolve(this.Lr.get(t))}saveNamedQuery(e,t){return this.Lr.set(t.name,(function(a){return{name:a.name,query:Rb(a.bundledQuery),readTime:js(a.readTime)}})(t)),ue.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zb{constructor(){this.overlays=new Kt(Qe.comparator),this.kr=new Map}getOverlay(e,t){return ue.resolve(this.overlays.get(t))}getOverlays(e,t){const s=Ta();return ue.forEach(t,(a=>this.getOverlay(e,a).next((l=>{l!==null&&s.set(a,l)})))).next((()=>s))}saveOverlays(e,t,s){return s.forEach(((a,l)=>{this.wt(e,t,l)})),ue.resolve()}removeOverlaysForBatchId(e,t,s){const a=this.kr.get(s);return a!==void 0&&(a.forEach((l=>this.overlays=this.overlays.remove(l))),this.kr.delete(s)),ue.resolve()}getOverlaysForCollection(e,t,s){const a=Ta(),l=t.length+1,d=new Qe(t.child("")),f=this.overlays.getIteratorFrom(d);for(;f.hasNext();){const m=f.getNext().value,v=m.getKey();if(!t.isPrefixOf(v.path))break;v.path.length===l&&m.largestBatchId>s&&a.set(m.getKey(),m)}return ue.resolve(a)}getOverlaysForCollectionGroup(e,t,s,a){let l=new Kt(((v,w)=>v-w));const d=this.overlays.getIterator();for(;d.hasNext();){const v=d.getNext().value;if(v.getKey().getCollectionGroup()===t&&v.largestBatchId>s){let w=l.get(v.largestBatchId);w===null&&(w=Ta(),l=l.insert(v.largestBatchId,w)),w.set(v.getKey(),v)}}const f=Ta(),m=l.getIterator();for(;m.hasNext()&&(m.getNext().value.forEach(((v,w)=>f.set(v,w))),!(f.size()>=a)););return ue.resolve(f)}wt(e,t,s){const a=this.overlays.get(s.key);if(a!==null){const d=this.kr.get(a.largestBatchId).delete(s.key);this.kr.set(a.largestBatchId,d)}this.overlays=this.overlays.insert(s.key,new ab(t,s));let l=this.kr.get(t);l===void 0&&(l=ht(),this.kr.set(t,l)),this.kr.set(t,l.add(s.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bb{constructor(){this.sessionToken=On.EMPTY_BYTE_STRING}getSessionToken(e){return ue.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ue.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gp{constructor(){this.qr=new gn(Sn.Qr),this.$r=new gn(Sn.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,t){const s=new Sn(e,t);this.qr=this.qr.add(s),this.$r=this.$r.add(s)}Kr(e,t){e.forEach((s=>this.addReference(s,t)))}removeReference(e,t){this.Wr(new Sn(e,t))}Gr(e,t){e.forEach((s=>this.removeReference(s,t)))}zr(e){const t=new Qe(new Mt([])),s=new Sn(t,e),a=new Sn(t,e+1),l=[];return this.$r.forEachInRange([s,a],(d=>{this.Wr(d),l.push(d.key)})),l}jr(){this.qr.forEach((e=>this.Wr(e)))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const t=new Qe(new Mt([])),s=new Sn(t,e),a=new Sn(t,e+1);let l=ht();return this.$r.forEachInRange([s,a],(d=>{l=l.add(d.key)})),l}containsKey(e){const t=new Sn(e,0),s=this.qr.firstAfterOrEqual(t);return s!==null&&e.isEqual(s.key)}}class Sn{constructor(e,t){this.key=e,this.Hr=t}static Qr(e,t){return Qe.comparator(e.key,t.key)||at(e.Hr,t.Hr)}static Ur(e,t){return at(e.Hr,t.Hr)||Qe.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $b{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.er=1,this.Yr=new gn(Sn.Qr)}checkEmpty(e){return ue.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,s,a){const l=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new ib(l,t,s,a);this.mutationQueue.push(d);for(const f of a)this.Yr=this.Yr.add(new Sn(f.key,l)),this.indexManager.addToCollectionParentIndex(e,f.key.path.popLast());return ue.resolve(d)}lookupMutationBatch(e,t){return ue.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const s=t+1,a=this.Xr(s),l=a<0?0:a;return ue.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return ue.resolve(this.mutationQueue.length===0?ap:this.er-1)}getAllMutationBatches(e){return ue.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const s=new Sn(t,0),a=new Sn(t,Number.POSITIVE_INFINITY),l=[];return this.Yr.forEachInRange([s,a],(d=>{const f=this.Zr(d.Hr);l.push(f)})),ue.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new gn(at);return t.forEach((a=>{const l=new Sn(a,0),d=new Sn(a,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([l,d],(f=>{s=s.add(f.Hr)}))})),ue.resolve(this.ei(s))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,a=s.length+1;let l=s;Qe.isDocumentKey(l)||(l=l.child(""));const d=new Sn(new Qe(l),0);let f=new gn(at);return this.Yr.forEachWhile((m=>{const v=m.key.path;return!!s.isPrefixOf(v)&&(v.length===a&&(f=f.add(m.Hr)),!0)}),d),ue.resolve(this.ei(f))}ei(e){const t=[];return e.forEach((s=>{const a=this.Zr(s);a!==null&&t.push(a)})),t}removeMutationBatch(e,t){bt(this.ti(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let s=this.Yr;return ue.forEach(t.mutations,(a=>{const l=new Sn(a.key,t.batchId);return s=s.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((()=>{this.Yr=s}))}rr(e){}containsKey(e,t){const s=new Sn(t,0),a=this.Yr.firstAfterOrEqual(s);return ue.resolve(t.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,ue.resolve()}ti(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wb{constructor(e){this.ni=e,this.docs=(function(){return new Kt(Qe.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const s=t.key,a=this.docs.get(s),l=a?a.size:0,d=this.ni(t);return this.docs=this.docs.insert(s,{document:t.mutableCopy(),size:d}),this.size+=d-l,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const s=this.docs.get(t);return ue.resolve(s?s.document.mutableCopy():qn.newInvalidDocument(t))}getEntries(e,t){let s=di();return t.forEach((a=>{const l=this.docs.get(a);s=s.insert(a,l?l.document.mutableCopy():qn.newInvalidDocument(a))})),ue.resolve(s)}getDocumentsMatchingQuery(e,t,s,a){let l=di();const d=t.path,f=new Qe(d.child("__id-9223372036854775808__")),m=this.docs.getIteratorFrom(f);for(;m.hasNext();){const{key:v,value:{document:w}}=m.getNext();if(!d.isPrefixOf(v.path))break;v.path.length>d.length+1||vI(yI(w),s)<=0||(a.has(w.key)||sd(t,w))&&(l=l.insert(w.key,w.mutableCopy()))}return ue.resolve(l)}getAllFromCollectionGroup(e,t,s,a){Ze(9500)}ri(e,t){return ue.forEach(this.docs,(s=>t(s)))}newChangeBuffer(e){return new Gb(this)}getSize(e){return ue.resolve(this.size)}}class Gb extends Ob{constructor(e){super(),this.Or=e}applyChanges(e){const t=[];return this.changes.forEach(((s,a)=>{a.isValidDocument()?t.push(this.Or.addEntry(e,a)):this.Or.removeEntry(s)})),ue.waitFor(t)}getFromCache(e,t){return this.Or.getEntry(e,t)}getAllFromCache(e,t){return this.Or.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hb{constructor(e){this.persistence=e,this.ii=new Aa((t=>cp(t)),up),this.lastRemoteSnapshotVersion=nt.min(),this.highestTargetId=0,this.si=0,this.oi=new gp,this.targetCount=0,this._i=bo.ar()}forEachTarget(e,t){return this.ii.forEach(((s,a)=>t(a))),ue.resolve()}getLastRemoteSnapshotVersion(e){return ue.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ue.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),ue.resolve(this.highestTargetId)}setTargetsMetadata(e,t,s){return s&&(this.lastRemoteSnapshotVersion=s),t>this.si&&(this.si=t),ue.resolve()}hr(e){this.ii.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this._i=new bo(t),this.highestTargetId=t),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,t){return this.hr(t),this.targetCount+=1,ue.resolve()}updateTargetData(e,t){return this.hr(t),ue.resolve()}removeTargetData(e,t){return this.ii.delete(t.target),this.oi.zr(t.targetId),this.targetCount-=1,ue.resolve()}removeTargets(e,t,s){let a=0;const l=[];return this.ii.forEach(((d,f)=>{f.sequenceNumber<=t&&s.get(f.targetId)===null&&(this.ii.delete(d),l.push(this.removeMatchingKeysForTargetId(e,f.targetId)),a++)})),ue.waitFor(l).next((()=>a))}getTargetCount(e){return ue.resolve(this.targetCount)}getTargetData(e,t){const s=this.ii.get(t)||null;return ue.resolve(s)}addMatchingKeys(e,t,s){return this.oi.Kr(t,s),ue.resolve()}removeMatchingKeys(e,t,s){this.oi.Gr(t,s);const a=this.persistence.referenceDelegate,l=[];return a&&t.forEach((d=>{l.push(a.markPotentiallyOrphaned(e,d))})),ue.waitFor(l)}removeMatchingKeysForTargetId(e,t){return this.oi.zr(t),ue.resolve()}getMatchingKeysForTargetId(e,t){const s=this.oi.Jr(t);return ue.resolve(s)}containsKey(e,t){return ue.resolve(this.oi.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sw{constructor(e,t){this.ai={},this.overlays={},this.ui=new Xu(0),this.ci=!1,this.ci=!0,this.li=new Bb,this.referenceDelegate=e(this),this.hi=new Hb(this),this.indexManager=new Nb,this.remoteDocumentCache=(function(a){return new Wb(a)})((s=>this.referenceDelegate.Pi(s))),this.serializer=new Pb(t),this.Ti=new Ub(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new zb,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let s=this.ai[e.toKey()];return s||(s=new $b(t,this.referenceDelegate),this.ai[e.toKey()]=s),s}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,t,s){Fe("MemoryPersistence","Starting transaction:",e);const a=new qb(this.ui.next());return this.referenceDelegate.Ii(),s(a).next((l=>this.referenceDelegate.di(a).next((()=>l)))).toPromise().then((l=>(a.raiseOnCommittedEvent(),l)))}Ei(e,t){return ue.or(Object.values(this.ai).map((s=>()=>s.containsKey(e,t))))}}class qb extends wI{constructor(e){super(),this.currentSequenceNumber=e}}class yp{constructor(e){this.persistence=e,this.Ai=new gp,this.Ri=null}static Vi(e){return new yp(e)}get mi(){if(this.Ri)return this.Ri;throw Ze(60996)}addReference(e,t,s){return this.Ai.addReference(s,t),this.mi.delete(s.toString()),ue.resolve()}removeReference(e,t,s){return this.Ai.removeReference(s,t),this.mi.add(s.toString()),ue.resolve()}markPotentiallyOrphaned(e,t){return this.mi.add(t.toString()),ue.resolve()}removeTarget(e,t){this.Ai.zr(t.targetId).forEach((a=>this.mi.add(a.toString())));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,t.targetId).next((a=>{a.forEach((l=>this.mi.add(l.toString())))})).next((()=>s.removeTargetData(e,t)))}Ii(){this.Ri=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ue.forEach(this.mi,(s=>{const a=Qe.fromPath(s);return this.fi(e,a).next((l=>{l||t.removeEntry(a,nt.min())}))})).next((()=>(this.Ri=null,t.apply(e))))}updateLimboDocument(e,t){return this.fi(e,t).next((s=>{s?this.mi.delete(t.toString()):this.mi.add(t.toString())}))}Pi(e){return 0}fi(e,t){return ue.or([()=>ue.resolve(this.Ai.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class Fu{constructor(e,t){this.persistence=e,this.gi=new Aa((s=>TI(s.path)),((s,a)=>s.isEqual(a))),this.garbageCollector=Lb(this,t)}static Vi(e,t){return new Fu(e,t)}Ii(){}di(e){return ue.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}mr(e){const t=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next((s=>t.next((a=>s+a))))}yr(e){let t=0;return this.gr(e,(s=>{t++})).next((()=>t))}gr(e,t){return ue.forEach(this.gi,((s,a)=>this.Sr(e,s,a).next((l=>l?ue.resolve():t(a)))))}removeTargets(e,t,s){return this.persistence.getTargetCache().removeTargets(e,t,s)}removeOrphanedDocuments(e,t){let s=0;const a=this.persistence.getRemoteDocumentCache(),l=a.newChangeBuffer();return a.ri(e,(d=>this.Sr(e,d,t).next((f=>{f||(s++,l.removeEntry(d,nt.min()))})))).next((()=>l.apply(e))).next((()=>s))}markPotentiallyOrphaned(e,t){return this.gi.set(t,e.currentSequenceNumber),ue.resolve()}removeTarget(e,t){const s=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,s)}addReference(e,t,s){return this.gi.set(s,e.currentSequenceNumber),ue.resolve()}removeReference(e,t,s){return this.gi.set(s,e.currentSequenceNumber),ue.resolve()}updateLimboDocument(e,t){return this.gi.set(t,e.currentSequenceNumber),ue.resolve()}Pi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=vu(e.data.value)),t}Sr(e,t,s){return ue.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const a=this.gi.get(t);return ue.resolve(a!==void 0&&a>s)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vp{constructor(e,t,s,a){this.targetId=e,this.fromCache=t,this.Is=s,this.ds=a}static Es(e,t){let s=ht(),a=ht();for(const l of t.docChanges)switch(l.type){case 0:s=s.add(l.doc.key);break;case 1:a=a.add(l.doc.key)}return new vp(e,t.fromCache,s,a)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kb{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qb{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=(function(){return TT()?8:xI(Kn())>0?6:4})()}initialize(e,t){this.gs=e,this.indexManager=t,this.As=!0}getDocumentsMatchingQuery(e,t,s,a){const l={result:null};return this.ps(e,t).next((d=>{l.result=d})).next((()=>{if(!l.result)return this.ys(e,t,a,s).next((d=>{l.result=d}))})).next((()=>{if(l.result)return;const d=new Kb;return this.ws(e,t,d).next((f=>{if(l.result=f,this.Rs)return this.Ss(e,t,d,f.size)}))})).next((()=>l.result))}Ss(e,t,s,a){return s.documentReadCount<this.Vs?(ho()<=dt.DEBUG&&Fe("QueryEngine","SDK will not create cache indexes for query:",fo(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),ue.resolve()):(ho()<=dt.DEBUG&&Fe("QueryEngine","Query:",fo(t),"scans",s.documentReadCount,"local documents and returns",a,"documents as results."),s.documentReadCount>this.fs*a?(ho()<=dt.DEBUG&&Fe("QueryEngine","The SDK decides to create cache indexes for query:",fo(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ks(t))):ue.resolve())}ps(e,t){if(ov(t))return ue.resolve(null);let s=ks(t);return this.indexManager.getIndexType(e,s).next((a=>a===0?null:(t.limit!==null&&a===1&&(t=Cf(t,null,"F"),s=ks(t)),this.indexManager.getDocumentsMatchingTarget(e,s).next((l=>{const d=ht(...l);return this.gs.getDocuments(e,d).next((f=>this.indexManager.getMinOffset(e,s).next((m=>{const v=this.bs(t,f);return this.Ds(t,v,d,m.readTime)?this.ps(e,Cf(t,null,"F")):this.vs(e,v,t,m)}))))})))))}ys(e,t,s,a){return ov(t)||a.isEqual(nt.min())?ue.resolve(null):this.gs.getDocuments(e,s).next((l=>{const d=this.bs(t,l);return this.Ds(t,d,s,a)?ue.resolve(null):(ho()<=dt.DEBUG&&Fe("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),fo(t)),this.vs(e,d,t,gI(a,Ol)).next((f=>f)))}))}bs(e,t){let s=new gn(L0(e));return t.forEach(((a,l)=>{sd(e,l)&&(s=s.add(l))})),s}Ds(e,t,s,a){if(e.limit===null)return!1;if(s.size!==t.size)return!0;const l=e.limitType==="F"?t.last():t.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(a)>0)}ws(e,t,s){return ho()<=dt.DEBUG&&Fe("QueryEngine","Using full collection scan to execute query:",fo(t)),this.gs.getDocumentsMatchingQuery(e,t,Gi.min(),s)}vs(e,t,s,a){return this.gs.getDocumentsMatchingQuery(e,s,a).next((l=>(t.forEach((d=>{l=l.insert(d.key,d)})),l)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _p="LocalStore",Yb=3e8;class Jb{constructor(e,t,s,a){this.persistence=e,this.Cs=t,this.serializer=a,this.Fs=new Kt(at),this.Ms=new Aa((l=>cp(l)),up),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(s)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Fb(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Fs)))}}function Xb(n,e,t,s){return new Jb(n,e,t,s)}async function iw(n,e){const t=st(n);return await t.persistence.runTransaction("Handle user change","readonly",(s=>{let a;return t.mutationQueue.getAllMutationBatches(s).next((l=>(a=l,t.Ns(e),t.mutationQueue.getAllMutationBatches(s)))).next((l=>{const d=[],f=[];let m=ht();for(const v of a){d.push(v.batchId);for(const w of v.mutations)m=m.add(w.key)}for(const v of l){f.push(v.batchId);for(const w of v.mutations)m=m.add(w.key)}return t.localDocuments.getDocuments(s,m).next((v=>({Bs:v,removedBatchIds:d,addedBatchIds:f})))}))}))}function Zb(n,e){const t=st(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(s=>{const a=e.batch.keys(),l=t.Os.newChangeBuffer({trackRemovals:!0});return(function(f,m,v,w){const T=v.batch,I=T.keys();let B=ue.resolve();return I.forEach((X=>{B=B.next((()=>w.getEntry(m,X))).next((K=>{const M=v.docVersions.get(X);bt(M!==null,48541),K.version.compareTo(M)<0&&(T.applyToRemoteDocument(K,v),K.isValidDocument()&&(K.setReadTime(v.commitVersion),w.addEntry(K)))}))})),B.next((()=>f.mutationQueue.removeMutationBatch(m,T)))})(t,s,e,l).next((()=>l.apply(s))).next((()=>t.mutationQueue.performConsistencyCheck(s))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(s,a,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,(function(f){let m=ht();for(let v=0;v<f.mutationResults.length;++v)f.mutationResults[v].transformResults.length>0&&(m=m.add(f.batch.mutations[v].key));return m})(e)))).next((()=>t.localDocuments.getDocuments(s,a)))}))}function aw(n){const e=st(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.hi.getLastRemoteSnapshotVersion(t)))}function eP(n,e){const t=st(n),s=e.snapshotVersion;let a=t.Fs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const d=t.Os.newChangeBuffer({trackRemovals:!0});a=t.Fs;const f=[];e.targetChanges.forEach(((w,T)=>{const I=a.get(T);if(!I)return;f.push(t.hi.removeMatchingKeys(l,w.removedDocuments,T).next((()=>t.hi.addMatchingKeys(l,w.addedDocuments,T))));let B=I.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(T)!==null?B=B.withResumeToken(On.EMPTY_BYTE_STRING,nt.min()).withLastLimboFreeSnapshotVersion(nt.min()):w.resumeToken.approximateByteSize()>0&&(B=B.withResumeToken(w.resumeToken,s)),a=a.insert(T,B),(function(K,M,ne){return K.resumeToken.approximateByteSize()===0||M.snapshotVersion.toMicroseconds()-K.snapshotVersion.toMicroseconds()>=Yb?!0:ne.addedDocuments.size+ne.modifiedDocuments.size+ne.removedDocuments.size>0})(I,B,w)&&f.push(t.hi.updateTargetData(l,B))}));let m=di(),v=ht();if(e.documentUpdates.forEach((w=>{e.resolvedLimboDocuments.has(w)&&f.push(t.persistence.referenceDelegate.updateLimboDocument(l,w))})),f.push(tP(l,d,e.documentUpdates).next((w=>{m=w.Ls,v=w.ks}))),!s.isEqual(nt.min())){const w=t.hi.getLastRemoteSnapshotVersion(l).next((T=>t.hi.setTargetsMetadata(l,l.currentSequenceNumber,s)));f.push(w)}return ue.waitFor(f).next((()=>d.apply(l))).next((()=>t.localDocuments.getLocalViewOfDocuments(l,m,v))).next((()=>m))})).then((l=>(t.Fs=a,l)))}function tP(n,e,t){let s=ht(),a=ht();return t.forEach((l=>s=s.add(l))),e.getEntries(n,s).next((l=>{let d=di();return t.forEach(((f,m)=>{const v=l.get(f);m.isFoundDocument()!==v.isFoundDocument()&&(a=a.add(f)),m.isNoDocument()&&m.version.isEqual(nt.min())?(e.removeEntry(f,m.readTime),d=d.insert(f,m)):!v.isValidDocument()||m.version.compareTo(v.version)>0||m.version.compareTo(v.version)===0&&v.hasPendingWrites?(e.addEntry(m),d=d.insert(f,m)):Fe(_p,"Ignoring outdated watch update for ",f,". Current version:",v.version," Watch version:",m.version)})),{Ls:d,ks:a}}))}function nP(n,e){const t=st(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(s=>(e===void 0&&(e=ap),t.mutationQueue.getNextMutationBatchAfterBatchId(s,e))))}function rP(n,e){const t=st(n);return t.persistence.runTransaction("Allocate target","readwrite",(s=>{let a;return t.hi.getTargetData(s,e).next((l=>l?(a=l,ue.resolve(a)):t.hi.allocateTargetId(s).next((d=>(a=new Oi(e,d,"TargetPurposeListen",s.currentSequenceNumber),t.hi.addTargetData(s,a).next((()=>a)))))))})).then((s=>{const a=t.Fs.get(s.targetId);return(a===null||s.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(t.Fs=t.Fs.insert(s.targetId,s),t.Ms.set(e,s.targetId)),s}))}async function Nf(n,e,t){const s=st(n),a=s.Fs.get(e),l=t?"readwrite":"readwrite-primary";try{t||await s.persistence.runTransaction("Release target",l,(d=>s.persistence.referenceDelegate.removeTarget(d,a)))}catch(d){if(!Oo(d))throw d;Fe(_p,`Failed to update sequence numbers for target ${e}: ${d}`)}s.Fs=s.Fs.remove(e),s.Ms.delete(a.target)}function wv(n,e,t){const s=st(n);let a=nt.min(),l=ht();return s.persistence.runTransaction("Execute query","readwrite",(d=>(function(m,v,w){const T=st(m),I=T.Ms.get(w);return I!==void 0?ue.resolve(T.Fs.get(I)):T.hi.getTargetData(v,w)})(s,d,ks(e)).next((f=>{if(f)return a=f.lastLimboFreeSnapshotVersion,s.hi.getMatchingKeysForTargetId(d,f.targetId).next((m=>{l=m}))})).next((()=>s.Cs.getDocumentsMatchingQuery(d,e,t?a:nt.min(),t?l:ht()))).next((f=>(sP(s,$I(e),f),{documents:f,qs:l})))))}function sP(n,e,t){let s=n.xs.get(e)||nt.min();t.forEach(((a,l)=>{l.readTime.compareTo(s)>0&&(s=l.readTime)})),n.xs.set(e,s)}class xv{constructor(){this.activeTargetIds=QI()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class iP{constructor(){this.Fo=new xv,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,s){}addLocalQueryTarget(e,t=!0){return t&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,t,s){this.Mo[e]=t}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new xv,Promise.resolve()}handleUserChange(e,t,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aP{xo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ev="ConnectivityMonitor";class Tv{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){Fe(Ev,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){Fe(Ev,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hu=null;function Af(){return hu===null?hu=(function(){return 268435456+Math.round(2147483648*Math.random())})():hu++,"0x"+hu.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ef="RestConnection",oP={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class lP{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.$o=t+"://"+e.host,this.Uo=`projects/${s}/databases/${a}`,this.Ko=this.databaseId.database===ju?`project_id=${s}`:`project_id=${s}&database_id=${a}`}Wo(e,t,s,a,l){const d=Af(),f=this.Go(e,t.toUriEncodedString());Fe(ef,`Sending RPC '${e}' ${d}:`,f,s);const m={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(m,a,l);const{host:v}=new URL(f),w=Ao(v);return this.jo(e,f,m,s,w).then((T=>(Fe(ef,`Received RPC '${e}' ${d}: `,T),T)),(T=>{throw Wi(ef,`RPC '${e}' ${d} failed with error: `,T,"url: ",f,"request:",s),T}))}Jo(e,t,s,a,l,d){return this.Wo(e,t,s,a,l)}zo(e,t,s){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Vo})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((a,l)=>e[l]=a)),s&&s.headers.forEach(((a,l)=>e[l]=a))}Go(e,t){const s=oP[e];return`${this.$o}/v1/${t}:${s}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cP{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wn="WebChannelConnection";class uP extends lP{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,t,s,a,l){const d=Af();return new Promise(((f,m)=>{const v=new c0;v.setWithCredentials(!0),v.listenOnce(u0.COMPLETE,(()=>{try{switch(v.getLastErrorCode()){case yu.NO_ERROR:const T=v.getResponseJson();Fe(Wn,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(T)),f(T);break;case yu.TIMEOUT:Fe(Wn,`RPC '${e}' ${d} timed out`),m(new Ge(de.DEADLINE_EXCEEDED,"Request time out"));break;case yu.HTTP_ERROR:const I=v.getStatus();if(Fe(Wn,`RPC '${e}' ${d} failed with status:`,I,"response text:",v.getResponseText()),I>0){let B=v.getResponseJson();Array.isArray(B)&&(B=B[0]);const X=B==null?void 0:B.error;if(X&&X.status&&X.message){const K=(function(ne){const be=ne.toLowerCase().replace(/_/g,"-");return Object.values(de).indexOf(be)>=0?be:de.UNKNOWN})(X.status);m(new Ge(K,X.message))}else m(new Ge(de.UNKNOWN,"Server responded with status "+v.getStatus()))}else m(new Ge(de.UNAVAILABLE,"Connection failed."));break;default:Ze(9055,{c_:e,streamId:d,l_:v.getLastErrorCode(),h_:v.getLastError()})}}finally{Fe(Wn,`RPC '${e}' ${d} completed.`)}}));const w=JSON.stringify(a);Fe(Wn,`RPC '${e}' ${d} sending request:`,a),v.send(t,"POST",w,s,15)}))}P_(e,t,s){const a=Af(),l=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=f0(),f=h0(),m={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},v=this.longPollingOptions.timeoutSeconds;v!==void 0&&(m.longPollingTimeout=Math.round(1e3*v)),this.useFetchStreams&&(m.useFetchStreams=!0),this.zo(m.initMessageHeaders,t,s),m.encodeInitMessageHeaders=!0;const w=l.join("");Fe(Wn,`Creating RPC '${e}' stream ${a}: ${w}`,m);const T=d.createWebChannel(w,m);this.T_(T);let I=!1,B=!1;const X=new cP({Ho:M=>{B?Fe(Wn,`Not sending because RPC '${e}' stream ${a} is closed:`,M):(I||(Fe(Wn,`Opening RPC '${e}' stream ${a} transport.`),T.open(),I=!0),Fe(Wn,`RPC '${e}' stream ${a} sending:`,M),T.send(M))},Yo:()=>T.close()}),K=(M,ne,be)=>{M.listen(ne,(_e=>{try{be(_e)}catch(we){setTimeout((()=>{throw we}),0)}}))};return K(T,xl.EventType.OPEN,(()=>{B||(Fe(Wn,`RPC '${e}' stream ${a} transport opened.`),X.s_())})),K(T,xl.EventType.CLOSE,(()=>{B||(B=!0,Fe(Wn,`RPC '${e}' stream ${a} transport closed`),X.__(),this.I_(T))})),K(T,xl.EventType.ERROR,(M=>{B||(B=!0,Wi(Wn,`RPC '${e}' stream ${a} transport errored. Name:`,M.name,"Message:",M.message),X.__(new Ge(de.UNAVAILABLE,"The operation could not be completed")))})),K(T,xl.EventType.MESSAGE,(M=>{var ne;if(!B){const be=M.data[0];bt(!!be,16349);const _e=be,we=(_e==null?void 0:_e.error)||((ne=_e[0])===null||ne===void 0?void 0:ne.error);if(we){Fe(Wn,`RPC '${e}' stream ${a} received error:`,we);const le=we.status;let Ie=(function(R){const F=on[R];if(F!==void 0)return q0(F)})(le),A=we.message;Ie===void 0&&(Ie=de.INTERNAL,A="Unknown error status: "+le+" with message "+we.message),B=!0,X.__(new Ge(Ie,A)),T.close()}else Fe(Wn,`RPC '${e}' stream ${a} received:`,be),X.a_(be)}})),K(f,d0.STAT_EVENT,(M=>{M.stat===_f.PROXY?Fe(Wn,`RPC '${e}' stream ${a} detected buffering proxy`):M.stat===_f.NOPROXY&&Fe(Wn,`RPC '${e}' stream ${a} detected no buffering proxy`)})),setTimeout((()=>{X.o_()}),0),X}terminate(){this.u_.forEach((e=>e.close())),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter((t=>t===e))}}function tf(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ld(n){return new pb(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ow{constructor(e,t,s=1e3,a=1.5,l=6e4){this.Fi=e,this.timerId=t,this.d_=s,this.E_=a,this.A_=l,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const t=Math.floor(this.R_+this.p_()),s=Math.max(0,Date.now()-this.m_),a=Math.max(0,t-s);a>0&&Fe("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.R_} ms, delay with jitter: ${t} ms, last attempt: ${s} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,a,(()=>(this.m_=Date.now(),e()))),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sv="PersistentStream";class lw{constructor(e,t,s,a,l,d,f,m){this.Fi=e,this.w_=s,this.S_=a,this.connection=l,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=f,this.listener=m,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new ow(e,t)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,(()=>this.L_())))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():t&&t.code===de.RESOURCE_EXHAUSTED?(ui(t.toString()),ui("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):t&&t.code===de.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(t)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),t=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([s,a])=>{this.b_===t&&this.W_(s,a)}),(s=>{e((()=>{const a=new Ge(de.UNKNOWN,"Fetching auth token failed: "+s.message);return this.G_(a)}))}))}W_(e,t){const s=this.K_(this.b_);this.stream=this.z_(e,t),this.stream.Zo((()=>{s((()=>this.listener.Zo()))})),this.stream.e_((()=>{s((()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,(()=>(this.x_()&&(this.state=3),Promise.resolve()))),this.listener.e_())))})),this.stream.n_((a=>{s((()=>this.G_(a)))})),this.stream.onMessage((a=>{s((()=>++this.C_==1?this.j_(a):this.onNext(a)))}))}O_(){this.state=5,this.F_.g_((async()=>{this.state=0,this.start()}))}G_(e){return Fe(Sv,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return t=>{this.Fi.enqueueAndForget((()=>this.b_===e?t():(Fe(Sv,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class dP extends lw{constructor(e,t,s,a,l,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,s,a,d),this.serializer=l}z_(e,t){return this.connection.P_("Listen",e,t)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const t=yb(this.serializer,e),s=(function(l){if(!("targetChange"in l))return nt.min();const d=l.targetChange;return d.targetIds&&d.targetIds.length?nt.min():d.readTime?js(d.readTime):nt.min()})(e);return this.listener.J_(t,s)}H_(e){const t={};t.database=Rf(this.serializer),t.addTarget=(function(l,d){let f;const m=d.target;if(f=Sf(m)?{documents:wb(l,m)}:{query:xb(l,m).Vt},f.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){f.resumeToken=Y0(l,d.resumeToken);const v=If(l,d.expectedCount);v!==null&&(f.expectedCount=v)}else if(d.snapshotVersion.compareTo(nt.min())>0){f.readTime=Mu(l,d.snapshotVersion.toTimestamp());const v=If(l,d.expectedCount);v!==null&&(f.expectedCount=v)}return f})(this.serializer,e);const s=Tb(this.serializer,e);s&&(t.labels=s),this.k_(t)}Y_(e){const t={};t.database=Rf(this.serializer),t.removeTarget=e,this.k_(t)}}class hP extends lw{constructor(e,t,s,a,l,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,s,a,d),this.serializer=l}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,t){return this.connection.P_("Write",e,t)}j_(e){return bt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,bt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){bt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();const t=_b(e.writeResults,e.commitTime),s=js(e.commitTime);return this.listener.ta(s,t)}na(){const e={};e.database=Rf(this.serializer),this.k_(e)}X_(e){const t={streamToken:this.lastStreamToken,writes:e.map((s=>vb(this.serializer,s)))};this.k_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fP{}class pP extends fP{constructor(e,t,s,a){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=s,this.serializer=a,this.ra=!1}ia(){if(this.ra)throw new Ge(de.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,s,a){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,d])=>this.connection.Wo(e,bf(t,s),a,l,d))).catch((l=>{throw l.name==="FirebaseError"?(l.code===de.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new Ge(de.UNKNOWN,l.toString())}))}Jo(e,t,s,a,l){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([d,f])=>this.connection.Jo(e,bf(t,s),a,d,f,l))).catch((d=>{throw d.name==="FirebaseError"?(d.code===de.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new Ge(de.UNKNOWN,d.toString())}))}terminate(){this.ra=!0,this.connection.terminate()}}class mP{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve()))))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(ui(t),this._a=!1):Fe("OnlineStateTracker",t)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Na="RemoteStore";class gP{constructor(e,t,s,a,l){this.localStore=e,this.datastore=t,this.asyncQueue=s,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=l,this.Ea.xo((d=>{s.enqueueAndForget((async()=>{ka(this)&&(Fe(Na,"Restarting streams for network reachability change."),await(async function(m){const v=st(m);v.Ia.add(4),await Zl(v),v.Aa.set("Unknown"),v.Ia.delete(4),await cd(v)})(this))}))})),this.Aa=new mP(s,a)}}async function cd(n){if(ka(n))for(const e of n.da)await e(!0)}async function Zl(n){for(const e of n.da)await e(!1)}function cw(n,e){const t=st(n);t.Ta.has(e.targetId)||(t.Ta.set(e.targetId,e),Tp(t)?Ep(t):Mo(t).x_()&&xp(t,e))}function wp(n,e){const t=st(n),s=Mo(t);t.Ta.delete(e),s.x_()&&uw(t,e),t.Ta.size===0&&(s.x_()?s.B_():ka(t)&&t.Aa.set("Unknown"))}function xp(n,e){if(n.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(nt.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Mo(n).H_(e)}function uw(n,e){n.Ra.$e(e),Mo(n).Y_(e)}function Ep(n){n.Ra=new ub({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>n.Ta.get(e)||null,lt:()=>n.datastore.serializer.databaseId}),Mo(n).start(),n.Aa.aa()}function Tp(n){return ka(n)&&!Mo(n).M_()&&n.Ta.size>0}function ka(n){return st(n).Ia.size===0}function dw(n){n.Ra=void 0}async function yP(n){n.Aa.set("Online")}async function vP(n){n.Ta.forEach(((e,t)=>{xp(n,e)}))}async function _P(n,e){dw(n),Tp(n)?(n.Aa.la(e),Ep(n)):n.Aa.set("Unknown")}async function wP(n,e,t){if(n.Aa.set("Online"),e instanceof Q0&&e.state===2&&e.cause)try{await(async function(a,l){const d=l.cause;for(const f of l.targetIds)a.Ta.has(f)&&(await a.remoteSyncer.rejectListen(f,d),a.Ta.delete(f),a.Ra.removeTarget(f))})(n,e)}catch(s){Fe(Na,"Failed to remove targets %s: %s ",e.targetIds.join(","),s),await Uu(n,s)}else if(e instanceof xu?n.Ra.Ye(e):e instanceof K0?n.Ra.it(e):n.Ra.et(e),!t.isEqual(nt.min()))try{const s=await aw(n.localStore);t.compareTo(s)>=0&&await(function(l,d){const f=l.Ra.Pt(d);return f.targetChanges.forEach(((m,v)=>{if(m.resumeToken.approximateByteSize()>0){const w=l.Ta.get(v);w&&l.Ta.set(v,w.withResumeToken(m.resumeToken,d))}})),f.targetMismatches.forEach(((m,v)=>{const w=l.Ta.get(m);if(!w)return;l.Ta.set(m,w.withResumeToken(On.EMPTY_BYTE_STRING,w.snapshotVersion)),uw(l,m);const T=new Oi(w.target,m,v,w.sequenceNumber);xp(l,T)})),l.remoteSyncer.applyRemoteEvent(f)})(n,t)}catch(s){Fe(Na,"Failed to raise snapshot:",s),await Uu(n,s)}}async function Uu(n,e,t){if(!Oo(e))throw e;n.Ia.add(1),await Zl(n),n.Aa.set("Offline"),t||(t=()=>aw(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{Fe(Na,"Retrying IndexedDB access"),await t(),n.Ia.delete(1),await cd(n)}))}function hw(n,e){return e().catch((t=>Uu(n,t,e)))}async function ud(n){const e=st(n),t=Qi(e);let s=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:ap;for(;xP(e);)try{const a=await nP(e.localStore,s);if(a===null){e.Pa.length===0&&t.B_();break}s=a.batchId,EP(e,a)}catch(a){await Uu(e,a)}fw(e)&&pw(e)}function xP(n){return ka(n)&&n.Pa.length<10}function EP(n,e){n.Pa.push(e);const t=Qi(n);t.x_()&&t.Z_&&t.X_(e.mutations)}function fw(n){return ka(n)&&!Qi(n).M_()&&n.Pa.length>0}function pw(n){Qi(n).start()}async function TP(n){Qi(n).na()}async function SP(n){const e=Qi(n);for(const t of n.Pa)e.X_(t.mutations)}async function CP(n,e,t){const s=n.Pa.shift(),a=fp.from(s,e,t);await hw(n,(()=>n.remoteSyncer.applySuccessfulWrite(a))),await ud(n)}async function IP(n,e){e&&Qi(n).Z_&&await(async function(s,a){if((function(d){return lb(d)&&d!==de.ABORTED})(a.code)){const l=s.Pa.shift();Qi(s).N_(),await hw(s,(()=>s.remoteSyncer.rejectFailedWrite(l.batchId,a))),await ud(s)}})(n,e),fw(n)&&pw(n)}async function Cv(n,e){const t=st(n);t.asyncQueue.verifyOperationInProgress(),Fe(Na,"RemoteStore received new credentials");const s=ka(t);t.Ia.add(3),await Zl(t),s&&t.Aa.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ia.delete(3),await cd(t)}async function bP(n,e){const t=st(n);e?(t.Ia.delete(2),await cd(t)):e||(t.Ia.add(2),await Zl(t),t.Aa.set("Unknown"))}function Mo(n){return n.Va||(n.Va=(function(t,s,a){const l=st(t);return l.ia(),new dP(s,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(n.datastore,n.asyncQueue,{Zo:yP.bind(null,n),e_:vP.bind(null,n),n_:_P.bind(null,n),J_:wP.bind(null,n)}),n.da.push((async e=>{e?(n.Va.N_(),Tp(n)?Ep(n):n.Aa.set("Unknown")):(await n.Va.stop(),dw(n))}))),n.Va}function Qi(n){return n.ma||(n.ma=(function(t,s,a){const l=st(t);return l.ia(),new hP(s,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),e_:TP.bind(null,n),n_:IP.bind(null,n),ea:SP.bind(null,n),ta:CP.bind(null,n)}),n.da.push((async e=>{e?(n.ma.N_(),await ud(n)):(await n.ma.stop(),n.Pa.length>0&&(Fe(Na,`Stopping write stream with ${n.Pa.length} pending writes`),n.Pa=[]))}))),n.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sp{constructor(e,t,s,a,l){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=s,this.op=a,this.removalCallback=l,this.deferred=new ai,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((d=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,s,a,l){const d=Date.now()+s,f=new Sp(e,t,d,a,l);return f.start(s),f}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ge(de.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Cp(n,e){if(ui("AsyncQueue",`${e}: ${n}`),Oo(n))return new Ge(de.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xo{static emptySet(e){return new xo(e.comparator)}constructor(e){this.comparator=e?(t,s)=>e(t,s)||Qe.comparator(t.key,s.key):(t,s)=>Qe.comparator(t.key,s.key),this.keyedMap=El(),this.sortedSet=new Kt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,s)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof xo)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=s.getNext().key;if(!a.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const s=new xo;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=t,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iv{constructor(){this.fa=new Kt(Qe.comparator)}track(e){const t=e.doc.key,s=this.fa.get(t);s?e.type!==0&&s.type===3?this.fa=this.fa.insert(t,e):e.type===3&&s.type!==1?this.fa=this.fa.insert(t,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.fa=this.fa.insert(t,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.fa=this.fa.remove(t):e.type===1&&s.type===2?this.fa=this.fa.insert(t,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):Ze(63341,{At:e,ga:s}):this.fa=this.fa.insert(t,e)}pa(){const e=[];return this.fa.inorderTraversal(((t,s)=>{e.push(s)})),e}}class Po{constructor(e,t,s,a,l,d,f,m,v){this.query=e,this.docs=t,this.oldDocs=s,this.docChanges=a,this.mutatedKeys=l,this.fromCache=d,this.syncStateChanged=f,this.excludesMetadataChanges=m,this.hasCachedResults=v}static fromInitialDocuments(e,t,s,a,l){const d=[];return t.forEach((f=>{d.push({type:0,doc:f})})),new Po(e,t,xo.emptySet(t),d,s,a,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&rd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,s=e.docChanges;if(t.length!==s.length)return!1;for(let a=0;a<t.length;a++)if(t[a].type!==s[a].type||!t[a].doc.isEqual(s[a].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PP{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some((e=>e.ba()))}}class RP{constructor(){this.queries=bv(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(t,s){const a=st(t),l=a.queries;a.queries=bv(),l.forEach(((d,f)=>{for(const m of f.wa)m.onError(s)}))})(this,new Ge(de.ABORTED,"Firestore shutting down"))}}function bv(){return new Aa((n=>V0(n)),rd)}async function Ip(n,e){const t=st(n);let s=3;const a=e.query;let l=t.queries.get(a);l?!l.Sa()&&e.ba()&&(s=2):(l=new PP,s=e.ba()?0:1);try{switch(s){case 0:l.ya=await t.onListen(a,!0);break;case 1:l.ya=await t.onListen(a,!1);break;case 2:await t.onFirstRemoteStoreListen(a)}}catch(d){const f=Cp(d,`Initialization of query '${fo(e.query)}' failed`);return void e.onError(f)}t.queries.set(a,l),l.wa.push(e),e.va(t.onlineState),l.ya&&e.Ca(l.ya)&&Pp(t)}async function bp(n,e){const t=st(n),s=e.query;let a=3;const l=t.queries.get(s);if(l){const d=l.wa.indexOf(e);d>=0&&(l.wa.splice(d,1),l.wa.length===0?a=e.ba()?0:1:!l.Sa()&&e.ba()&&(a=2))}switch(a){case 0:return t.queries.delete(s),t.onUnlisten(s,!0);case 1:return t.queries.delete(s),t.onUnlisten(s,!1);case 2:return t.onLastRemoteStoreUnlisten(s);default:return}}function NP(n,e){const t=st(n);let s=!1;for(const a of e){const l=a.query,d=t.queries.get(l);if(d){for(const f of d.wa)f.Ca(a)&&(s=!0);d.ya=a}}s&&Pp(t)}function AP(n,e,t){const s=st(n),a=s.queries.get(e);if(a)for(const l of a.wa)l.onError(t);s.queries.delete(e)}function Pp(n){n.Da.forEach((e=>{e.next()}))}var kf,Pv;(Pv=kf||(kf={})).Fa="default",Pv.Cache="cache";class Rp{constructor(e,t,s){this.query=e,this.Ma=t,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=s||{}}Ca(e){if(!this.options.includeMetadataChanges){const s=[];for(const a of e.docChanges)a.type!==3&&s.push(a);e=new Po(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),t=!0):this.Ba(e,this.onlineState)&&(this.La(e),t=!0),this.Oa=e,t}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let t=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),t=!0),t}Ba(e,t){if(!e.fromCache||!this.ba())return!0;const s=t!=="Offline";return(!this.options.ka||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Na(e){if(e.docChanges.length>0)return!0;const t=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}La(e){e=Po.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==kf.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mw{constructor(e){this.key=e}}class gw{constructor(e){this.key=e}}class kP{constructor(e,t){this.query=e,this.Ha=t,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=ht(),this.mutatedKeys=ht(),this.Xa=L0(e),this.eu=new xo(this.Xa)}get tu(){return this.Ha}nu(e,t){const s=t?t.ru:new Iv,a=t?t.eu:this.eu;let l=t?t.mutatedKeys:this.mutatedKeys,d=a,f=!1;const m=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,v=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal(((w,T)=>{const I=a.get(w),B=sd(this.query,T)?T:null,X=!!I&&this.mutatedKeys.has(I.key),K=!!B&&(B.hasLocalMutations||this.mutatedKeys.has(B.key)&&B.hasCommittedMutations);let M=!1;I&&B?I.data.isEqual(B.data)?X!==K&&(s.track({type:3,doc:B}),M=!0):this.iu(I,B)||(s.track({type:2,doc:B}),M=!0,(m&&this.Xa(B,m)>0||v&&this.Xa(B,v)<0)&&(f=!0)):!I&&B?(s.track({type:0,doc:B}),M=!0):I&&!B&&(s.track({type:1,doc:I}),M=!0,(m||v)&&(f=!0)),M&&(B?(d=d.add(B),l=K?l.add(w):l.delete(w)):(d=d.delete(w),l=l.delete(w)))})),this.query.limit!==null)for(;d.size>this.query.limit;){const w=this.query.limitType==="F"?d.last():d.first();d=d.delete(w.key),l=l.delete(w.key),s.track({type:1,doc:w})}return{eu:d,ru:s,Ds:f,mutatedKeys:l}}iu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,s,a){const l=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const d=e.ru.pa();d.sort(((w,T)=>(function(B,X){const K=M=>{switch(M){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ze(20277,{At:M})}};return K(B)-K(X)})(w.type,T.type)||this.Xa(w.doc,T.doc))),this.su(s),a=a!=null&&a;const f=t&&!a?this.ou():[],m=this.Za.size===0&&this.current&&!a?1:0,v=m!==this.Ya;return this.Ya=m,d.length!==0||v?{snapshot:new Po(this.query,e.eu,l,d,e.mutatedKeys,m===0,v,!1,!!s&&s.resumeToken.approximateByteSize()>0),_u:f}:{_u:f}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new Iv,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach((t=>this.Ha=this.Ha.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ha=this.Ha.delete(t))),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=ht(),this.eu.forEach((s=>{this.au(s.key)&&(this.Za=this.Za.add(s.key))}));const t=[];return e.forEach((s=>{this.Za.has(s)||t.push(new gw(s))})),this.Za.forEach((s=>{e.has(s)||t.push(new mw(s))})),t}uu(e){this.Ha=e.qs,this.Za=ht();const t=this.nu(e.documents);return this.applyChanges(t,!0)}cu(){return Po.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const Np="SyncEngine";class jP{constructor(e,t,s){this.query=e,this.targetId=t,this.view=s}}class DP{constructor(e){this.key=e,this.lu=!1}}class VP{constructor(e,t,s,a,l,d){this.localStore=e,this.remoteStore=t,this.eventManager=s,this.sharedClientState=a,this.currentUser=l,this.maxConcurrentLimboResolutions=d,this.hu={},this.Pu=new Aa((f=>V0(f)),rd),this.Tu=new Map,this.Iu=new Set,this.du=new Kt(Qe.comparator),this.Eu=new Map,this.Au=new gp,this.Ru={},this.Vu=new Map,this.mu=bo.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function LP(n,e,t=!0){const s=Ew(n);let a;const l=s.Pu.get(e);return l?(s.sharedClientState.addLocalQueryTarget(l.targetId),a=l.view.cu()):a=await yw(s,e,t,!0),a}async function OP(n,e){const t=Ew(n);await yw(t,e,!0,!1)}async function yw(n,e,t,s){const a=await rP(n.localStore,ks(e)),l=a.targetId,d=n.sharedClientState.addLocalQueryTarget(l,t);let f;return s&&(f=await MP(n,e,l,d==="current",a.resumeToken)),n.isPrimaryClient&&t&&cw(n.remoteStore,a),f}async function MP(n,e,t,s,a){n.gu=(T,I,B)=>(async function(K,M,ne,be){let _e=M.view.nu(ne);_e.Ds&&(_e=await wv(K.localStore,M.query,!1).then((({documents:A})=>M.view.nu(A,_e))));const we=be&&be.targetChanges.get(M.targetId),le=be&&be.targetMismatches.get(M.targetId)!=null,Ie=M.view.applyChanges(_e,K.isPrimaryClient,we,le);return Nv(K,M.targetId,Ie._u),Ie.snapshot})(n,T,I,B);const l=await wv(n.localStore,e,!0),d=new kP(e,l.qs),f=d.nu(l.documents),m=Xl.createSynthesizedTargetChangeForCurrentChange(t,s&&n.onlineState!=="Offline",a),v=d.applyChanges(f,n.isPrimaryClient,m);Nv(n,t,v._u);const w=new jP(e,t,d);return n.Pu.set(e,w),n.Tu.has(t)?n.Tu.get(t).push(e):n.Tu.set(t,[e]),v.snapshot}async function FP(n,e,t){const s=st(n),a=s.Pu.get(e),l=s.Tu.get(a.targetId);if(l.length>1)return s.Tu.set(a.targetId,l.filter((d=>!rd(d,e)))),void s.Pu.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(a.targetId),s.sharedClientState.isActiveQueryTarget(a.targetId)||await Nf(s.localStore,a.targetId,!1).then((()=>{s.sharedClientState.clearQueryState(a.targetId),t&&wp(s.remoteStore,a.targetId),jf(s,a.targetId)})).catch(Lo)):(jf(s,a.targetId),await Nf(s.localStore,a.targetId,!0))}async function UP(n,e){const t=st(n),s=t.Pu.get(e),a=t.Tu.get(s.targetId);t.isPrimaryClient&&a.length===1&&(t.sharedClientState.removeLocalQueryTarget(s.targetId),wp(t.remoteStore,s.targetId))}async function zP(n,e,t){const s=KP(n);try{const a=await(function(d,f){const m=st(d),v=Ft.now(),w=f.reduce(((B,X)=>B.add(X.key)),ht());let T,I;return m.persistence.runTransaction("Locally write mutations","readwrite",(B=>{let X=di(),K=ht();return m.Os.getEntries(B,w).next((M=>{X=M,X.forEach(((ne,be)=>{be.isValidDocument()||(K=K.add(ne))}))})).next((()=>m.localDocuments.getOverlayedDocuments(B,X))).next((M=>{T=M;const ne=[];for(const be of f){const _e=rb(be,T.get(be.key).overlayedDocument);_e!=null&&ne.push(new ra(be.key,_e,P0(_e.value.mapValue),Qr.exists(!0)))}return m.mutationQueue.addMutationBatch(B,v,ne,f)})).next((M=>{I=M;const ne=M.applyToLocalDocumentSet(T,K);return m.documentOverlayCache.saveOverlays(B,M.batchId,ne)}))})).then((()=>({batchId:I.batchId,changes:M0(T)})))})(s.localStore,e);s.sharedClientState.addPendingMutation(a.batchId),(function(d,f,m){let v=d.Ru[d.currentUser.toKey()];v||(v=new Kt(at)),v=v.insert(f,m),d.Ru[d.currentUser.toKey()]=v})(s,a.batchId,t),await ec(s,a.changes),await ud(s.remoteStore)}catch(a){const l=Cp(a,"Failed to persist write");t.reject(l)}}async function vw(n,e){const t=st(n);try{const s=await eP(t.localStore,e);e.targetChanges.forEach(((a,l)=>{const d=t.Eu.get(l);d&&(bt(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?d.lu=!0:a.modifiedDocuments.size>0?bt(d.lu,14607):a.removedDocuments.size>0&&(bt(d.lu,42227),d.lu=!1))})),await ec(t,s,e)}catch(s){await Lo(s)}}function Rv(n,e,t){const s=st(n);if(s.isPrimaryClient&&t===0||!s.isPrimaryClient&&t===1){const a=[];s.Pu.forEach(((l,d)=>{const f=d.view.va(e);f.snapshot&&a.push(f.snapshot)})),(function(d,f){const m=st(d);m.onlineState=f;let v=!1;m.queries.forEach(((w,T)=>{for(const I of T.wa)I.va(f)&&(v=!0)})),v&&Pp(m)})(s.eventManager,e),a.length&&s.hu.J_(a),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function BP(n,e,t){const s=st(n);s.sharedClientState.updateQueryState(e,"rejected",t);const a=s.Eu.get(e),l=a&&a.key;if(l){let d=new Kt(Qe.comparator);d=d.insert(l,qn.newNoDocument(l,nt.min()));const f=ht().add(l),m=new od(nt.min(),new Map,new Kt(at),d,f);await vw(s,m),s.du=s.du.remove(l),s.Eu.delete(e),Ap(s)}else await Nf(s.localStore,e,!1).then((()=>jf(s,e,t))).catch(Lo)}async function $P(n,e){const t=st(n),s=e.batch.batchId;try{const a=await Zb(t.localStore,e);ww(t,s,null),_w(t,s),t.sharedClientState.updateMutationState(s,"acknowledged"),await ec(t,a)}catch(a){await Lo(a)}}async function WP(n,e,t){const s=st(n);try{const a=await(function(d,f){const m=st(d);return m.persistence.runTransaction("Reject batch","readwrite-primary",(v=>{let w;return m.mutationQueue.lookupMutationBatch(v,f).next((T=>(bt(T!==null,37113),w=T.keys(),m.mutationQueue.removeMutationBatch(v,T)))).next((()=>m.mutationQueue.performConsistencyCheck(v))).next((()=>m.documentOverlayCache.removeOverlaysForBatchId(v,w,f))).next((()=>m.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(v,w))).next((()=>m.localDocuments.getDocuments(v,w)))}))})(s.localStore,e);ww(s,e,t),_w(s,e),s.sharedClientState.updateMutationState(e,"rejected",t),await ec(s,a)}catch(a){await Lo(a)}}function _w(n,e){(n.Vu.get(e)||[]).forEach((t=>{t.resolve()})),n.Vu.delete(e)}function ww(n,e,t){const s=st(n);let a=s.Ru[s.currentUser.toKey()];if(a){const l=a.get(e);l&&(t?l.reject(t):l.resolve(),a=a.remove(e)),s.Ru[s.currentUser.toKey()]=a}}function jf(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const s of n.Tu.get(e))n.Pu.delete(s),t&&n.hu.pu(s,t);n.Tu.delete(e),n.isPrimaryClient&&n.Au.zr(e).forEach((s=>{n.Au.containsKey(s)||xw(n,s)}))}function xw(n,e){n.Iu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(wp(n.remoteStore,t),n.du=n.du.remove(e),n.Eu.delete(t),Ap(n))}function Nv(n,e,t){for(const s of t)s instanceof mw?(n.Au.addReference(s.key,e),GP(n,s)):s instanceof gw?(Fe(Np,"Document no longer in limbo: "+s.key),n.Au.removeReference(s.key,e),n.Au.containsKey(s.key)||xw(n,s.key)):Ze(19791,{yu:s})}function GP(n,e){const t=e.key,s=t.path.canonicalString();n.du.get(t)||n.Iu.has(s)||(Fe(Np,"New document in limbo: "+t),n.Iu.add(s),Ap(n))}function Ap(n){for(;n.Iu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Iu.values().next().value;n.Iu.delete(e);const t=new Qe(Mt.fromString(e)),s=n.mu.next();n.Eu.set(s,new DP(t)),n.du=n.du.insert(t,s),cw(n.remoteStore,new Oi(ks(nd(t.path)),s,"TargetPurposeLimboResolution",Xu.ue))}}async function ec(n,e,t){const s=st(n),a=[],l=[],d=[];s.Pu.isEmpty()||(s.Pu.forEach(((f,m)=>{d.push(s.gu(m,e,t).then((v=>{var w;if((v||t)&&s.isPrimaryClient){const T=v?!v.fromCache:(w=t==null?void 0:t.targetChanges.get(m.targetId))===null||w===void 0?void 0:w.current;s.sharedClientState.updateQueryState(m.targetId,T?"current":"not-current")}if(v){a.push(v);const T=vp.Es(m.targetId,v);l.push(T)}})))})),await Promise.all(d),s.hu.J_(a),await(async function(m,v){const w=st(m);try{await w.persistence.runTransaction("notifyLocalViewChanges","readwrite",(T=>ue.forEach(v,(I=>ue.forEach(I.Is,(B=>w.persistence.referenceDelegate.addReference(T,I.targetId,B))).next((()=>ue.forEach(I.ds,(B=>w.persistence.referenceDelegate.removeReference(T,I.targetId,B)))))))))}catch(T){if(!Oo(T))throw T;Fe(_p,"Failed to update sequence numbers: "+T)}for(const T of v){const I=T.targetId;if(!T.fromCache){const B=w.Fs.get(I),X=B.snapshotVersion,K=B.withLastLimboFreeSnapshotVersion(X);w.Fs=w.Fs.insert(I,K)}}})(s.localStore,l))}async function HP(n,e){const t=st(n);if(!t.currentUser.isEqual(e)){Fe(Np,"User change. New user:",e.toKey());const s=await iw(t.localStore,e);t.currentUser=e,(function(l,d){l.Vu.forEach((f=>{f.forEach((m=>{m.reject(new Ge(de.CANCELLED,d))}))})),l.Vu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await ec(t,s.Bs)}}function qP(n,e){const t=st(n),s=t.Eu.get(e);if(s&&s.lu)return ht().add(s.key);{let a=ht();const l=t.Tu.get(e);if(!l)return a;for(const d of l){const f=t.Pu.get(d);a=a.unionWith(f.view.tu)}return a}}function Ew(n){const e=st(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=vw.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=qP.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=BP.bind(null,e),e.hu.J_=NP.bind(null,e.eventManager),e.hu.pu=AP.bind(null,e.eventManager),e}function KP(n){const e=st(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=$P.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=WP.bind(null,e),e}class zu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=ld(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,t){return null}Fu(e,t){return null}vu(e){return Xb(this.persistence,new Qb,e.initialUser,this.serializer)}Du(e){return new sw(yp.Vi,this.serializer)}bu(e){return new iP}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}zu.provider={build:()=>new zu};class QP extends zu{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,t){bt(this.persistence.referenceDelegate instanceof Fu,46915);const s=this.persistence.referenceDelegate.garbageCollector;return new Db(s,e.asyncQueue,t)}Du(e){const t=this.cacheSizeBytes!==void 0?xr.withCacheSize(this.cacheSizeBytes):xr.DEFAULT;return new sw((s=>Fu.Vi(s,t)),this.serializer)}}class Df{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>Rv(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=HP.bind(null,this.syncEngine),await bP(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new RP})()}createDatastore(e){const t=ld(e.databaseInfo.databaseId),s=(function(l){return new uP(l)})(e.databaseInfo);return(function(l,d,f,m){return new pP(l,d,f,m)})(e.authCredentials,e.appCheckCredentials,s,t)}createRemoteStore(e){return(function(s,a,l,d,f){return new gP(s,a,l,d,f)})(this.localStore,this.datastore,e.asyncQueue,(t=>Rv(this.syncEngine,t,0)),(function(){return Tv.C()?new Tv:new aP})())}createSyncEngine(e,t){return(function(a,l,d,f,m,v,w){const T=new VP(a,l,d,f,m,v);return w&&(T.fu=!0),T})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(a){const l=st(a);Fe(Na,"RemoteStore shutting down."),l.Ia.add(5),await Zl(l),l.Ea.shutdown(),l.Aa.set("Unknown")})(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}Df.provider={build:()=>new Df};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kp{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):ui("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yi="FirestoreClient";class YP{constructor(e,t,s,a,l){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=s,this.databaseInfo=a,this.user=Gn.UNAUTHENTICATED,this.clientId=sp.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(s,(async d=>{Fe(Yi,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d})),this.appCheckCredentials.start(s,(d=>(Fe(Yi,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ai;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const s=Cp(t,"Failed to shutdown persistence");e.reject(s)}})),e.promise}}async function nf(n,e){n.asyncQueue.verifyOperationInProgress(),Fe(Yi,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let s=t.initialUser;n.setCredentialChangeListener((async a=>{s.isEqual(a)||(await iw(e.localStore,a),s=a)})),e.persistence.setDatabaseDeletedListener((()=>{Wi("Terminating Firestore due to IndexedDb database deletion"),n.terminate().then((()=>{Fe("Terminating Firestore due to IndexedDb database deletion completed successfully")})).catch((a=>{Wi("Terminating Firestore due to IndexedDb database deletion failed",a)}))})),n._offlineComponents=e}async function Av(n,e){n.asyncQueue.verifyOperationInProgress();const t=await JP(n);Fe(Yi,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((s=>Cv(e.remoteStore,s))),n.setAppCheckTokenChangeListener(((s,a)=>Cv(e.remoteStore,a))),n._onlineComponents=e}async function JP(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Fe(Yi,"Using user provided OfflineComponentProvider");try{await nf(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(a){return a.name==="FirebaseError"?a.code===de.FAILED_PRECONDITION||a.code===de.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11})(t))throw t;Wi("Error using user provided cache. Falling back to memory cache: "+t),await nf(n,new zu)}}else Fe(Yi,"Using default OfflineComponentProvider"),await nf(n,new QP(void 0));return n._offlineComponents}async function Tw(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Fe(Yi,"Using user provided OnlineComponentProvider"),await Av(n,n._uninitializedComponentsProvider._online)):(Fe(Yi,"Using default OnlineComponentProvider"),await Av(n,new Df))),n._onlineComponents}function XP(n){return Tw(n).then((e=>e.syncEngine))}async function Bu(n){const e=await Tw(n),t=e.eventManager;return t.onListen=LP.bind(null,e.syncEngine),t.onUnlisten=FP.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=OP.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=UP.bind(null,e.syncEngine),t}function ZP(n,e,t={}){const s=new ai;return n.asyncQueue.enqueueAndForget((async()=>(function(l,d,f,m,v){const w=new kp({next:I=>{w.Ou(),d.enqueueAndForget((()=>bp(l,T)));const B=I.docs.has(f);!B&&I.fromCache?v.reject(new Ge(de.UNAVAILABLE,"Failed to get document because the client is offline.")):B&&I.fromCache&&m&&m.source==="server"?v.reject(new Ge(de.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):v.resolve(I)},error:I=>v.reject(I)}),T=new Rp(nd(f.path),w,{includeMetadataChanges:!0,ka:!0});return Ip(l,T)})(await Bu(n),n.asyncQueue,e,t,s))),s.promise}function eR(n,e,t={}){const s=new ai;return n.asyncQueue.enqueueAndForget((async()=>(function(l,d,f,m,v){const w=new kp({next:I=>{w.Ou(),d.enqueueAndForget((()=>bp(l,T))),I.fromCache&&m.source==="server"?v.reject(new Ge(de.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):v.resolve(I)},error:I=>v.reject(I)}),T=new Rp(f,w,{includeMetadataChanges:!0,ka:!0});return Ip(l,T)})(await Bu(n),n.asyncQueue,e,t,s))),s.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sw(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kv=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cw="firestore.googleapis.com",jv=!0;class Dv{constructor(e){var t,s;if(e.host===void 0){if(e.ssl!==void 0)throw new Ge(de.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Cw,this.ssl=jv}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:jv;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=rw;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<kb)throw new Ge(de.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}mI("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Sw((s=e.experimentalLongPollingOptions)!==null&&s!==void 0?s:{}),(function(l){if(l.timeoutSeconds!==void 0){if(isNaN(l.timeoutSeconds))throw new Ge(de.INVALID_ARGUMENT,`invalid long polling timeout: ${l.timeoutSeconds} (must not be NaN)`);if(l.timeoutSeconds<5)throw new Ge(de.INVALID_ARGUMENT,`invalid long polling timeout: ${l.timeoutSeconds} (minimum allowed value is 5)`);if(l.timeoutSeconds>30)throw new Ge(de.INVALID_ARGUMENT,`invalid long polling timeout: ${l.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(s,a){return s.timeoutSeconds===a.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class dd{constructor(e,t,s,a){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=s,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Dv({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ge(de.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ge(de.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Dv(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(s){if(!s)return new aI;switch(s.type){case"firstParty":return new uI(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new Ge(de.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const s=kv.get(t);s&&(Fe("ComponentProvider","Removing Datastore"),kv.delete(t),s.terminate())})(this),Promise.resolve()}}function tR(n,e,t,s={}){var a;n=Tr(n,dd);const l=Ao(e),d=n._getSettings(),f=Object.assign(Object.assign({},d),{emulatorOptions:n._getEmulatorOptions()}),m=`${e}:${t}`;l&&(y_(`https://${m}`),v_("Firestore",!0)),d.host!==Cw&&d.host!==m&&Wi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const v=Object.assign(Object.assign({},d),{host:m,ssl:l,emulatorOptions:s});if(!Ia(v,f)&&(n._setSettings(v),s.mockUserToken)){let w,T;if(typeof s.mockUserToken=="string")w=s.mockUserToken,T=Gn.MOCK_USER;else{w=pT(s.mockUserToken,(a=n._app)===null||a===void 0?void 0:a.options.projectId);const I=s.mockUserToken.sub||s.mockUserToken.user_id;if(!I)throw new Ge(de.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");T=new Gn(I)}n._authCredentials=new oI(new m0(w,T))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tc{constructor(e,t,s){this.converter=t,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new tc(this.firestore,e,this._query)}}class en{constructor(e,t,s){this.converter=t,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new $i(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new en(this.firestore,e,this._key)}toJSON(){return{type:en._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,s){if(Yl(t,en._jsonSchema))return new en(e,s||null,new Qe(Mt.fromString(t.referencePath)))}}en._jsonSchemaVersion="firestore/documentReference/1.0",en._jsonSchema={type:ln("string",en._jsonSchemaVersion),referencePath:ln("string")};class $i extends tc{constructor(e,t,s){super(e,t,nd(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new en(this.firestore,null,new Qe(e))}withConverter(e){return new $i(this.firestore,e,this._path)}}function Hn(n,e,...t){if(n=nn(n),y0("collection","path",e),n instanceof dd){const s=Mt.fromString(e,...t);return Ky(s),new $i(n,null,s)}{if(!(n instanceof en||n instanceof $i))throw new Ge(de.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(Mt.fromString(e,...t));return Ky(s),new $i(n.firestore,null,s)}}function Dt(n,e,...t){if(n=nn(n),arguments.length===1&&(e=sp.newId()),y0("doc","path",e),n instanceof dd){const s=Mt.fromString(e,...t);return qy(s),new en(n,null,new Qe(s))}{if(!(n instanceof en||n instanceof $i))throw new Ge(de.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(Mt.fromString(e,...t));return qy(s),new en(n.firestore,n instanceof $i?n.converter:null,new Qe(s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vv="AsyncQueue";class Lv{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new ow(this,"async_queue_retry"),this.oc=()=>{const s=tf();s&&Fe(Vv,"Visibility state changed to "+s.visibilityState),this.F_.y_()},this._c=e;const t=tf();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const t=tf();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise((()=>{}));const t=new ai;return this.uc((()=>this.Xu&&this.rc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Zu.push(e),this.cc())))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!Oo(e))throw e;Fe(Vv,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_((()=>this.cc()))}}uc(e){const t=this._c.then((()=>(this.nc=!0,e().catch((s=>{throw this.tc=s,this.nc=!1,ui("INTERNAL UNHANDLED ERROR: ",Ov(s)),s})).then((s=>(this.nc=!1,s))))));return this._c=t,t}enqueueAfterDelay(e,t,s){this.ac(),this.sc.indexOf(e)>-1&&(t=0);const a=Sp.createAndSchedule(this,e,t,s,(l=>this.lc(l)));return this.ec.push(a),a}ac(){this.tc&&Ze(47125,{hc:Ov(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(const t of this.ec)if(t.timerId===e)return!0;return!1}Ic(e){return this.Pc().then((()=>{this.ec.sort(((t,s)=>t.targetTimeMs-s.targetTimeMs));for(const t of this.ec)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Pc()}))}dc(e){this.sc.push(e)}lc(e){const t=this.ec.indexOf(e);this.ec.splice(t,1)}}function Ov(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mv(n){return(function(t,s){if(typeof t!="object"||t===null)return!1;const a=t;for(const l of s)if(l in a&&typeof a[l]=="function")return!0;return!1})(n,["next","error","complete"])}class hi extends dd{constructor(e,t,s,a){super(e,t,s,a),this.type="firestore",this._queue=new Lv,this._persistenceKey=(a==null?void 0:a.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Lv(e),this._firestoreClient=void 0,await e}}}function nR(n,e){const t=typeof n=="object"?n:E_(),s=typeof n=="string"?n:ju,a=Gf(t,"firestore").getImmediate({identifier:s});if(!a._initialized){const l=hT("firestore");l&&tR(a,...l)}return a}function hd(n){if(n._terminated)throw new Ge(de.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||rR(n),n._firestoreClient}function rR(n){var e,t,s;const a=n._freezeSettings(),l=(function(f,m,v,w){return new II(f,m,v,w.host,w.ssl,w.experimentalForceLongPolling,w.experimentalAutoDetectLongPolling,Sw(w.experimentalLongPollingOptions),w.useFetchStreams,w.isUsingEmulator)})(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,a);n._componentsProvider||!((t=a.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((s=a.localCache)===null||s===void 0)&&s._onlineComponentProvider)&&(n._componentsProvider={_offline:a.localCache._offlineComponentProvider,_online:a.localCache._onlineComponentProvider}),n._firestoreClient=new YP(n._authCredentials,n._appCheckCredentials,n._queue,l,n._componentsProvider&&(function(f){const m=f==null?void 0:f._online.build();return{_offline:f==null?void 0:f._offline.build(m),_online:m}})(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new qr(On.fromBase64String(e))}catch(t){throw new Ge(de.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new qr(On.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:qr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Yl(e,qr._jsonSchema))return qr.fromBase64String(e.bytes)}}qr._jsonSchemaVersion="firestore/bytes/1.0",qr._jsonSchema={type:ln("string",qr._jsonSchemaVersion),bytes:ln("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fd{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ge(de.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ln(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pd{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ds{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ge(de.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ge(de.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return at(this._lat,e._lat)||at(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ds._jsonSchemaVersion}}static fromJSON(e){if(Yl(e,Ds._jsonSchema))return new Ds(e.latitude,e.longitude)}}Ds._jsonSchemaVersion="firestore/geoPoint/1.0",Ds._jsonSchema={type:ln("string",Ds._jsonSchemaVersion),latitude:ln("number"),longitude:ln("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vs{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(s,a){if(s.length!==a.length)return!1;for(let l=0;l<s.length;++l)if(s[l]!==a[l])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Vs._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Yl(e,Vs._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Vs(e.vectorValues);throw new Ge(de.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Vs._jsonSchemaVersion="firestore/vectorValue/1.0",Vs._jsonSchema={type:ln("string",Vs._jsonSchemaVersion),vectorValues:ln("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sR=/^__.*__$/;class iR{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return this.fieldMask!==null?new ra(e,this.data,this.fieldMask,t,this.fieldTransforms):new Jl(e,this.data,t,this.fieldTransforms)}}class Iw{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return new ra(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function bw(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ze(40011,{Ec:n})}}class jp{constructor(e,t,s,a,l,d){this.settings=e,this.databaseId=t,this.serializer=s,this.ignoreUndefinedProperties=a,l===void 0&&this.Ac(),this.fieldTransforms=l||[],this.fieldMask=d||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new jp(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var t;const s=(t=this.path)===null||t===void 0?void 0:t.child(e),a=this.Rc({path:s,mc:!1});return a.fc(e),a}gc(e){var t;const s=(t=this.path)===null||t===void 0?void 0:t.child(e),a=this.Rc({path:s,mc:!1});return a.Ac(),a}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return $u(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(bw(this.Ec)&&sR.test(e))throw this.wc('Document fields cannot begin and end with "__"')}}class aR{constructor(e,t,s){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=s||ld(e)}Dc(e,t,s,a=!1){return new jp({Ec:e,methodName:t,bc:s,path:Ln.emptyPath(),mc:!1,Sc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Dp(n){const e=n._freezeSettings(),t=ld(n._databaseId);return new aR(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Pw(n,e,t,s,a,l={}){const d=n.Dc(l.merge||l.mergeFields?2:0,e,t,a);Lp("Data must be an object, but it was:",d,s);const f=Rw(s,d);let m,v;if(l.merge)m=new Dr(d.fieldMask),v=d.fieldTransforms;else if(l.mergeFields){const w=[];for(const T of l.mergeFields){const I=Vf(e,T,t);if(!d.contains(I))throw new Ge(de.INVALID_ARGUMENT,`Field '${I}' is specified in your field mask but missing from your input data.`);Aw(w,I)||w.push(I)}m=new Dr(w),v=d.fieldTransforms.filter((T=>m.covers(T.field)))}else m=null,v=d.fieldTransforms;return new iR(new Er(f),m,v)}class nc extends pd{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof nc}}class Vp extends pd{_toFieldTransform(e){return new ZI(e.path,new zl)}isEqual(e){return e instanceof Vp}}function oR(n,e,t,s){const a=n.Dc(1,e,t);Lp("Data must be an object, but it was:",a,s);const l=[],d=Er.empty();na(s,((m,v)=>{const w=Op(e,m,t);v=nn(v);const T=a.gc(w);if(v instanceof nc)l.push(w);else{const I=md(v,T);I!=null&&(l.push(w),d.set(w,I))}}));const f=new Dr(l);return new Iw(d,f,a.fieldTransforms)}function lR(n,e,t,s,a,l){const d=n.Dc(1,e,t),f=[Vf(e,s,t)],m=[a];if(l.length%2!=0)throw new Ge(de.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let I=0;I<l.length;I+=2)f.push(Vf(e,l[I])),m.push(l[I+1]);const v=[],w=Er.empty();for(let I=f.length-1;I>=0;--I)if(!Aw(v,f[I])){const B=f[I];let X=m[I];X=nn(X);const K=d.gc(B);if(X instanceof nc)v.push(B);else{const M=md(X,K);M!=null&&(v.push(B),w.set(B,M))}}const T=new Dr(v);return new Iw(w,T,d.fieldTransforms)}function md(n,e){if(Nw(n=nn(n)))return Lp("Unsupported field value:",e,n),Rw(n,e);if(n instanceof pd)return(function(s,a){if(!bw(a.Ec))throw a.wc(`${s._methodName}() can only be used with update() and set()`);if(!a.path)throw a.wc(`${s._methodName}() is not currently supported inside arrays`);const l=s._toFieldTransform(a);l&&a.fieldTransforms.push(l)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return(function(s,a){const l=[];let d=0;for(const f of s){let m=md(f,a.yc(d));m==null&&(m={nullValue:"NULL_VALUE"}),l.push(m),d++}return{arrayValue:{values:l}}})(n,e)}return(function(s,a){if((s=nn(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return YI(a.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const l=Ft.fromDate(s);return{timestampValue:Mu(a.serializer,l)}}if(s instanceof Ft){const l=new Ft(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:Mu(a.serializer,l)}}if(s instanceof Ds)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof qr)return{bytesValue:Y0(a.serializer,s._byteString)};if(s instanceof en){const l=a.databaseId,d=s.firestore._databaseId;if(!d.isEqual(l))throw a.wc(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:mp(s.firestore._databaseId||a.databaseId,s._key.path)}}if(s instanceof Vs)return(function(d,f){return{mapValue:{fields:{[I0]:{stringValue:b0},[Du]:{arrayValue:{values:d.toArray().map((v=>{if(typeof v!="number")throw f.wc("VectorValues must only contain numeric values.");return dp(f.serializer,v)}))}}}}}})(s,a);throw a.wc(`Unsupported field value: ${ip(s)}`)})(n,e)}function Rw(n,e){const t={};return w0(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):na(n,((s,a)=>{const l=md(a,e.Vc(s));l!=null&&(t[s]=l)})),{mapValue:{fields:t}}}function Nw(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Ft||n instanceof Ds||n instanceof qr||n instanceof en||n instanceof pd||n instanceof Vs)}function Lp(n,e,t){if(!Nw(t)||!v0(t)){const s=ip(t);throw s==="an object"?e.wc(n+" a custom object"):e.wc(n+" "+s)}}function Vf(n,e,t){if((e=nn(e))instanceof fd)return e._internalPath;if(typeof e=="string")return Op(n,e);throw $u("Field path arguments must be of type string or ",n,!1,void 0,t)}const cR=new RegExp("[~\\*/\\[\\]]");function Op(n,e,t){if(e.search(cR)>=0)throw $u(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new fd(...e.split("."))._internalPath}catch{throw $u(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function $u(n,e,t,s,a){const l=s&&!s.isEmpty(),d=a!==void 0;let f=`Function ${e}() called with invalid data`;t&&(f+=" (via `toFirestore()`)"),f+=". ";let m="";return(l||d)&&(m+=" (found",l&&(m+=` in field ${s}`),d&&(m+=` in document ${a}`),m+=")"),new Ge(de.INVALID_ARGUMENT,f+n+m)}function Aw(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kw{constructor(e,t,s,a,l){this._firestore=e,this._userDataWriter=t,this._key=s,this._document=a,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new en(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new uR(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(jw("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class uR extends kw{data(){return super.data()}}function jw(n,e){return typeof e=="string"?Op(n,e):e instanceof fd?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dw(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Ge(de.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class dR{convertValue(e,t="none"){switch(Ki(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Zt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(qi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ze(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const s={};return na(e,((a,l)=>{s[a]=this.convertValue(l,t)})),s}convertVectorValue(e){var t,s,a;const l=(a=(s=(t=e.fields)===null||t===void 0?void 0:t[Du].arrayValue)===null||s===void 0?void 0:s.values)===null||a===void 0?void 0:a.map((d=>Zt(d.doubleValue)));return new Vs(l)}convertGeoPoint(e){return new Ds(Zt(e.latitude),Zt(e.longitude))}convertArray(e,t){return(e.values||[]).map((s=>this.convertValue(s,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const s=ed(e);return s==null?null:this.convertValue(s,t);case"estimate":return this.convertTimestamp(Ml(e));default:return null}}convertTimestamp(e){const t=Hi(e);return new Ft(t.seconds,t.nanos)}convertDocumentKey(e,t){const s=Mt.fromString(e);bt(nw(s),9688,{name:e});const a=new Fl(s.get(1),s.get(3)),l=new Qe(s.popFirst(5));return a.isEqual(t)||ui(`Document ${l} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vw(n,e,t){let s;return s=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,s}class Sl{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Sa extends kw{constructor(e,t,s,a,l,d){super(e,t,s,a,d),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Eu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const s=this._document.data.field(jw("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ge(de.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Sa._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Sa._jsonSchemaVersion="firestore/documentSnapshot/1.0",Sa._jsonSchema={type:ln("string",Sa._jsonSchemaVersion),bundleSource:ln("string","DocumentSnapshot"),bundleName:ln("string"),bundle:ln("string")};class Eu extends Sa{data(e={}){return super.data(e)}}class Ca{constructor(e,t,s,a){this._firestore=e,this._userDataWriter=t,this._snapshot=a,this.metadata=new Sl(a.hasPendingWrites,a.fromCache),this.query=s}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((s=>{e.call(t,new Eu(this._firestore,this._userDataWriter,s.key,s,new Sl(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ge(de.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(a,l){if(a._snapshot.oldDocs.isEmpty()){let d=0;return a._snapshot.docChanges.map((f=>{const m=new Eu(a._firestore,a._userDataWriter,f.doc.key,f.doc,new Sl(a._snapshot.mutatedKeys.has(f.doc.key),a._snapshot.fromCache),a.query.converter);return f.doc,{type:"added",doc:m,oldIndex:-1,newIndex:d++}}))}{let d=a._snapshot.oldDocs;return a._snapshot.docChanges.filter((f=>l||f.type!==3)).map((f=>{const m=new Eu(a._firestore,a._userDataWriter,f.doc.key,f.doc,new Sl(a._snapshot.mutatedKeys.has(f.doc.key),a._snapshot.fromCache),a.query.converter);let v=-1,w=-1;return f.type!==0&&(v=d.indexOf(f.doc.key),d=d.delete(f.doc.key)),f.type!==1&&(d=d.add(f.doc),w=d.indexOf(f.doc.key)),{type:hR(f.type),doc:m,oldIndex:v,newIndex:w}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ge(de.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Ca._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=sp.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],s=[],a=[];return this.docs.forEach((l=>{l._document!==null&&(t.push(l._document),s.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),a.push(l.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function hR(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ze(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mp(n){n=Tr(n,en);const e=Tr(n.firestore,hi);return ZP(hd(e),n._key).then((t=>Lw(e,n,t)))}Ca._jsonSchemaVersion="firestore/querySnapshot/1.0",Ca._jsonSchema={type:ln("string",Ca._jsonSchemaVersion),bundleSource:ln("string","QuerySnapshot"),bundleName:ln("string"),bundle:ln("string")};class Fp extends dR{constructor(e){super(),this.firestore=e}convertBytes(e){return new qr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new en(this.firestore,null,t)}}function ti(n){n=Tr(n,tc);const e=Tr(n.firestore,hi),t=hd(e),s=new Fp(e);return Dw(n._query),eR(t,n._query).then((a=>new Ca(e,s,n,a)))}function si(n,e,t){n=Tr(n,en);const s=Tr(n.firestore,hi),a=Vw(n.converter,e,t);return gd(s,[Pw(Dp(s),"setDoc",n._key,a,n.converter!==null,t).toMutation(n._key,Qr.none())])}function Ns(n,e,t,...s){n=Tr(n,en);const a=Tr(n.firestore,hi),l=Dp(a);let d;return d=typeof(e=nn(e))=="string"||e instanceof fd?lR(l,"updateDoc",n._key,e,t,s):oR(l,"updateDoc",n._key,e),gd(a,[d.toMutation(n._key,Qr.exists(!0))])}function go(n){return gd(Tr(n.firestore,hi),[new hp(n._key,Qr.none())])}function yo(n,e){const t=Tr(n.firestore,hi),s=Dt(n),a=Vw(n.converter,e);return gd(t,[Pw(Dp(n.firestore),"addDoc",s._key,a,n.converter!==null,{}).toMutation(s._key,Qr.exists(!1))]).then((()=>s))}function Fv(n,...e){var t,s,a;n=nn(n);let l={includeMetadataChanges:!1,source:"default"},d=0;typeof e[d]!="object"||Mv(e[d])||(l=e[d++]);const f={includeMetadataChanges:l.includeMetadataChanges,source:l.source};if(Mv(e[d])){const T=e[d];e[d]=(t=T.next)===null||t===void 0?void 0:t.bind(T),e[d+1]=(s=T.error)===null||s===void 0?void 0:s.bind(T),e[d+2]=(a=T.complete)===null||a===void 0?void 0:a.bind(T)}let m,v,w;if(n instanceof en)v=Tr(n.firestore,hi),w=nd(n._key.path),m={next:T=>{e[d]&&e[d](Lw(v,n,T))},error:e[d+1],complete:e[d+2]};else{const T=Tr(n,tc);v=Tr(T.firestore,hi),w=T._query;const I=new Fp(v);m={next:B=>{e[d]&&e[d](new Ca(v,I,T,B))},error:e[d+1],complete:e[d+2]},Dw(n._query)}return(function(I,B,X,K){const M=new kp(K),ne=new Rp(B,M,X);return I.asyncQueue.enqueueAndForget((async()=>Ip(await Bu(I),ne))),()=>{M.Ou(),I.asyncQueue.enqueueAndForget((async()=>bp(await Bu(I),ne)))}})(hd(v),w,f,m)}function gd(n,e){return(function(s,a){const l=new ai;return s.asyncQueue.enqueueAndForget((async()=>zP(await XP(s),a,l))),l.promise})(hd(n),e)}function Lw(n,e,t){const s=t.docs.get(e._key),a=new Fp(n);return new Sa(n,a,e._key,s,new Sl(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fR(){return new nc("deleteField")}function Wu(){return new Vp("serverTimestamp")}(function(e,t=!0){(function(a){Vo=a})(ko),Eo(new ba("firestore",((s,{instanceIdentifier:a,options:l})=>{const d=s.getProvider("app").getImmediate(),f=new hi(new lI(s.getProvider("auth-internal")),new dI(d,s.getProvider("app-check-internal")),(function(v,w){if(!Object.prototype.hasOwnProperty.apply(v.options,["projectId"]))throw new Ge(de.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Fl(v.options.projectId,w)})(d,a),d);return l=Object.assign({useFetchStreams:t},l),f._setSettings(l),f}),"PUBLIC").setMultipleInstances(!0)),zi(By,$y,e),zi(By,$y,"esm2017")})();const pR={apiKey:"AIzaSyCOOnlmEcAcJywsS93LLfLSywy9ENqnppM",authDomain:"tyler-manga-library.firebaseapp.com",projectId:"tyler-manga-library",storageBucket:"tyler-manga-library.firebasestorage.app",messagingSenderId:"307412068362",appId:"1:307412068362:web:6cfe5666187439dfa757f3"},Ow=x_(pR),Kr=sI(Ow),it=nR(Ow),Mw=k.createContext(null);function mR({children:n}){const e="https://discord.com/api/webhooks/1451655828078723156/EA8QhLeiTT-7jOVQ6jFpV2he2zxVpAddAhlu8CiC6RtGFu9wTAOLdRjKeYHIV1OhVbmm",[t,s]=k.useState(null),[a,l]=k.useState(!1),[d,f]=k.useState("viewer"),[m,v]=k.useState(!0),w=async B=>{if(!B)return null;const X=Dt(it,"users",B.uid);let K=null;try{const ne=await Mp(X);ne.exists()&&(K=ne.data())}catch(ne){console.warn("Failed to read user doc",ne)}const M={role:((K==null?void 0:K.role)||"viewer").toLowerCase()==="admin"?"admin":"viewer",email:B.email||(K==null?void 0:K.email)||"",displayName:B.displayName||(K==null?void 0:K.displayName)||"",createdAt:(K==null?void 0:K.createdAt)||Wu()};try{if(await si(X,M,{merge:!0}),!K&&e)try{const ne=B.displayName||B.email||B.uid;await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:`New signup: ${ne}`})})}catch(ne){console.warn("Failed to send signup webhook",ne)}}catch(ne){console.error("Failed to ensure user doc",ne)}return{...K,...M}};k.useEffect(()=>{const B=K1(Kr,async X=>{if(s(X),X)try{const K=await w(X),M=(K==null?void 0:K.role)||"viewer";f(M),l(M.toLowerCase()==="admin")}catch(K){console.error("Error checking role:",K),l(!1),f("viewer")}else l(!1),f("viewer");v(!1)});return()=>B()},[]);const T=async(B,X)=>{await Q_(Kr,B,X)},I=async()=>{await Y_(Kr)};return c.jsx(Mw.Provider,{value:{user:t,admin:a,role:d,loading:m,login:T,logout:I},children:n})}function Fo(){return k.useContext(Mw)}function gR({onClose:n}){const[e,t]=k.useState("login"),[s,a]=k.useState(""),[l,d]=k.useState("");async function f(){try{await a0(Kr,new hs),n()}catch(w){alert(w.message)}}async function m(w){w.preventDefault();try{await Q_(Kr,s,l),n()}catch(T){alert(T.message)}}async function v(w){w.preventDefault();try{await $1(Kr,s,l),n()}catch(T){alert(T.message)}}return c.jsx("div",{className:"auth-modal-backdrop",onClick:n,children:c.jsxs("div",{className:"auth-modal",onClick:w=>w.stopPropagation(),children:[c.jsx("h2",{className:"auth-title",children:e==="login"?"Sign In":"Create Account"}),c.jsxs("button",{className:"google-btn",onClick:f,children:[c.jsx("img",{src:"https://www.svgrepo.com/show/475656/google-color.svg",alt:"",className:"google-icon"}),"Continue with Google"]}),c.jsx("div",{className:"auth-divider",children:c.jsx("span",{children:"or"})}),c.jsxs("form",{onSubmit:e==="login"?m:v,className:"auth-form",children:[c.jsx("input",{type:"email",placeholder:"Email address",className:"auth-input",value:s,onChange:w=>a(w.target.value),required:!0}),c.jsx("input",{type:"password",placeholder:"Password",className:"auth-input",value:l,onChange:w=>d(w.target.value),required:!0}),c.jsx("button",{className:"auth-submit",children:e==="login"?"Sign In":"Create Account"})]}),c.jsx("div",{className:"auth-switcher",children:e==="login"?c.jsxs("p",{children:["No account?"," ",c.jsx("button",{onClick:()=>t("register"),children:"Register"})]}):c.jsxs("p",{children:["Already have an account?"," ",c.jsx("button",{onClick:()=>t("login"),children:"Sign in"})]})}),c.jsx("button",{className:"auth-close",onClick:n,children:"Close"})]})})}function yR(){var ye,je,Pe,D,N,se;const n="google.com",e="oidc.discord",[t,s]=k.useState(!1),[a,l]=k.useState(!1),[d,f]=k.useState(!1),[m,v]=k.useState(!1),[w,T]=k.useState(""),[I,B]=k.useState(""),[X,K]=k.useState(""),[M,ne]=k.useState({google:!1,discord:!1}),[be,_e]=k.useState(!1),[we,le]=k.useState(!1),Ie=k.useRef(null),{user:A,admin:P,role:R}=Fo(),F=Hu();k.useEffect(()=>{var te;f(!1),v(!1),B(""),K(""),le(!1),T((A==null?void 0:A.displayName)||((te=A==null?void 0:A.email)==null?void 0:te.split("@")[0])||"")},[A]);async function z(){try{await Y_(Kr),s(!1),f(!1),F("/")}catch(te){console.error(te),alert("Logout failed.")}}const L=()=>{if(!A){s(!1),l(!0);return}f(!1),B(""),K(""),le(!1),v(!0)},b=async()=>{if(!A){s(!1),l(!0);return}const te=(w||"").trim();if(!te){B("Display name is required.");return}_e(!0),B(""),le(!1);try{await G1(Kr.currentUser,{displayName:te}),await si(Dt(it,"users",A.uid),{displayName:te},{merge:!0}),B("Profile updated."),le(!1)}catch(Ee){console.error("Failed to update profile",Ee),B("Failed to update profile.")}finally{_e(!1)}},he=te=>{var Ee;return!!((Ee=A==null?void 0:A.providerData)!=null&&Ee.some(ve=>ve.providerId===te))},xe=async()=>{if(!A){s(!1),l(!0);return}if(he(n)){K("Google is already connected.");return}ne(te=>({...te,google:!0})),K("");try{const te=new hs,Ee=await jy(Kr.currentUser,te);await si(Dt(it,"users",A.uid),{connections:{[n]:{email:Ee.user.email||"",connectedAt:Wu()}}},{merge:!0}),K("Google connected.")}catch(te){console.error("Failed to link Google",te);const Ee=(te==null?void 0:te.code)==="auth/credential-already-in-use"?"That Google account is already linked elsewhere. Sign in with it instead.":"Could not connect Google.";K(Ee)}finally{ne(te=>({...te,google:!1}))}},ut=async()=>{if(!A){s(!1),l(!0);return}if(he(e)){K("Discord is already connected.");return}ne(te=>({...te,discord:!0})),K("");try{const te=new bl(e);te.addScope("identify"),te.addScope("email");const ve=(await jy(Kr.currentUser,te)).user.providerData.find(Me=>Me.providerId===e);await si(Dt(it,"users",A.uid),{connections:{[e]:{username:(ve==null?void 0:ve.displayName)||(ve==null?void 0:ve.uid)||"Discord",email:(ve==null?void 0:ve.email)||"",connectedAt:Wu()}}},{merge:!0}),K("Discord connected.")}catch(te){console.error("Failed to link Discord",te);const Ee=(te==null?void 0:te.code)==="auth/credential-already-in-use"?"That Discord account is already linked elsewhere. Sign in with it instead.":"Could not connect Discord.";K(Ee)}finally{ne(te=>({...te,discord:!1}))}},Be=async te=>{if(!A)return;if(A.providerData.length<=1){K("You need at least one sign-in method.");return}const Ee=te===n?"google":"discord";K(""),ne(ve=>({...ve,[Ee]:!0}));try{await M1(Kr.currentUser,te),await si(Dt(it,"users",A.uid),{connections:{[te]:fR()}},{merge:!0}),K("Connection removed.")}catch(ve){console.error("Failed to unlink",ve),K("Could not remove connection.")}finally{ne(ve=>({...ve,[Ee]:!1}))}};return c.jsxs(c.Fragment,{children:[c.jsxs("button",{className:`menu-toggle ${t?"active":""}`,onClick:()=>s(!t),children:[c.jsx("span",{}),c.jsx("span",{}),c.jsx("span",{})]}),c.jsxs("nav",{className:`menu-panel ${t?"open":""}`,onMouseLeave:()=>f(!1),children:[c.jsx(wa,{to:"/",className:"menu-item",onClick:()=>s(!1),children:"Home"}),c.jsx(wa,{to:"/manga",className:"menu-item",onClick:()=>s(!1),children:"Manga"}),c.jsx(wa,{to:"/anime",className:"menu-item",onClick:()=>s(!1),children:"Anime"}),c.jsx(wa,{to:"/tcg",className:"menu-item",onClick:()=>s(!1),children:"TCG"}),c.jsx(wa,{to:"/music",className:"menu-item",onClick:()=>s(!1),children:"Music"}),c.jsx(wa,{to:"/steam",className:"menu-item",onClick:()=>s(!1),children:"Gaming"}),P&&c.jsx(wa,{to:"/dashboard",className:"menu-item",onClick:()=>s(!1),children:"Dashboard"}),c.jsxs("div",{className:"menu-footer",children:[c.jsx("div",{className:"profile-divider"}),c.jsxs("div",{className:"profile-card",onMouseEnter:()=>A&&f(!0),onMouseLeave:()=>f(!1),onClick:()=>{A?f(te=>!te):(f(!1),s(!1),l(!0))},role:"button",tabIndex:0,onKeyDown:te=>{(te.key==="Enter"||te.key===" ")&&(te.preventDefault(),A?f(Ee=>!Ee):(s(!1),l(!0)))},children:[c.jsx("div",{className:"profile-avatar",children:A?(((ye=A.displayName)==null?void 0:ye[0])||((je=A.email)==null?void 0:je[0])||((Pe=A.uid)==null?void 0:Pe[0])||"?").toUpperCase():"?"}),c.jsxs("div",{className:"profile-meta",children:[c.jsx("div",{className:"profile-name",children:(A==null?void 0:A.displayName)||(A==null?void 0:A.email)||"Guest"}),c.jsx("div",{className:"profile-role",children:A?P?"admin":R||"viewer":"Not signed in"})]}),A&&d&&c.jsxs("div",{className:"profile-menu",children:[c.jsx("button",{type:"button",className:"profile-menu-item",onClick:L,children:"Edit profile"}),c.jsx("button",{type:"button",className:"profile-menu-item",onClick:z,children:"Sign out"})]})]})]})]}),a&&c.jsx(gR,{onClose:()=>l(!1)}),m&&c.jsx("div",{className:"profile-edit-backdrop",children:c.jsxs("div",{className:"profile-edit-card",children:[c.jsxs("div",{className:"profile-edit-header",children:[c.jsx("h3",{children:"Edit profile"}),c.jsx("button",{type:"button",className:"profile-edit-close",onClick:()=>{v(!1),B(""),K(""),le(!1)},children:""})]}),c.jsxs("div",{className:"profile-edit-body",children:[c.jsx("div",{className:"profile-edit-avatar",children:A?(((D=A.displayName)==null?void 0:D[0])||((N=A.email)==null?void 0:N[0])||((se=A.uid)==null?void 0:se[0])||"?").toUpperCase():"?"}),c.jsxs("div",{className:"profile-edit-field",children:[c.jsx("label",{className:"profile-edit-label",htmlFor:"displayName",children:"Display name"}),c.jsxs("div",{className:"profile-edit-input-row",children:[c.jsx("input",{id:"displayName",className:"profile-edit-input",type:"text",readOnly:!we,value:w,onChange:te=>T(te.target.value),maxLength:40,placeholder:"Enter display name",ref:Ie,onBlur:()=>{we&&b()},onKeyDown:te=>{te.key==="Enter"&&we&&(te.preventDefault(),b())}}),c.jsx("button",{type:"button",className:"profile-edit-pencil",onClick:()=>{le(!0),B(""),setTimeout(()=>{var te;return(te=Ie.current)==null?void 0:te.focus()},50)},"aria-label":"Edit display name",children:""})]}),c.jsx("div",{className:"profile-edit-hint",children:"Click the pencil to edit. Changes save on blur or Enter."})]})]}),c.jsxs("div",{className:"profile-connections",children:[c.jsxs("div",{className:"profile-connections-header",children:[c.jsx("span",{children:"Connections"}),X&&c.jsx("span",{className:"profile-connection-status",children:X})]}),c.jsxs("div",{className:"profile-connection-row",children:[c.jsxs("div",{className:"profile-connection-meta",children:[c.jsx("div",{className:"profile-connection-title",children:"Google"}),c.jsx("div",{className:"profile-connection-sub",children:he(n)?"Connected":"Not connected"})]}),c.jsx("div",{className:"profile-connection-actions",children:he(n)?c.jsx("button",{type:"button",className:"profile-connection-btn secondary",onClick:()=>Be(n),disabled:M.google,children:M.google?"Removing...":"Remove"}):c.jsx("button",{type:"button",className:"profile-connection-btn",onClick:xe,disabled:M.google,children:M.google?"Connecting...":"Connect"})})]}),c.jsxs("div",{className:"profile-connection-row",children:[c.jsxs("div",{className:"profile-connection-meta",children:[c.jsx("div",{className:"profile-connection-title",children:"Discord"}),c.jsx("div",{className:"profile-connection-sub",children:he(e)?"Connected":"Not connected"})]}),c.jsx("div",{className:"profile-connection-actions",children:he(e)?c.jsx("button",{type:"button",className:"profile-connection-btn secondary",onClick:()=>Be(e),disabled:M.discord,children:M.discord?"Removing...":"Remove"}):c.jsx("button",{type:"button",className:"profile-connection-btn",onClick:ut,disabled:M.discord,children:M.discord?"Connecting...":"Connect"})})]})]}),I&&c.jsx("div",{className:"profile-edit-status",children:I}),be&&c.jsx("div",{className:"profile-edit-status saving",children:"Saving..."})]})})]})}function Uv(){const n="Tyler's Collection's and Hobbies",e="",[t,s]=k.useState(""),[a,l]=k.useState(!0),d=k.useRef(null),[f,m]=k.useState("jp"),[v,w]=k.useState(1);return k.useEffect(()=>{document.title="Tyler's Collection"},[]),k.useEffect(()=>(d.current=setInterval(()=>l(T=>!T),450),()=>{d.current&&clearInterval(d.current)}),[]),k.useEffect(()=>{let T=!1;const I=K=>new Promise(M=>setTimeout(M,K)),B=async(K,M=120)=>{for(let ne=1;ne<=K.length;ne+=1){if(T)return;s(K.slice(0,ne)),await I(M)}},X=async(K,M=70)=>{for(let ne=K.length;ne>=0;ne-=1){if(T)return;s(K.slice(0,ne)),await I(M)}};return(async()=>{if(localStorage.getItem("homeTitleTyped")==="1"){m("en"),s(n),l(!1),d.current&&clearInterval(d.current);return}await I(250),m("jp"),await B(e,140),await I(6e3),await X(e,80),await I(320);const M=n;for(let ne=1;ne<=M.length;ne+=1){if(T)return;s(M.slice(0,ne)),ne===4&&m("en"),await I(110)}m("en"),await I(2e3),l(!1),localStorage.setItem("homeTitleTyped","1"),d.current&&clearInterval(d.current)})(),()=>{T=!0}},[]),c.jsxs("main",{className:"page",children:[c.jsxs("header",{style:{textAlign:"center",marginTop:"32px",marginBottom:"24px"},children:[c.jsxs("h1",{style:{margin:0,fontSize:"2.2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",display:"inline-flex",alignItems:"center",gap:"6px"},children:[c.jsx("span",{children:t||" "}),c.jsx("span",{style:{width:"6px",height:"1.1em",background:"#ffb6c1",opacity:a?1:0,transition:"opacity 0.15s ease"}})]}),c.jsx("p",{style:{margin:"6px 0 0",color:"var(--text-soft)",fontSize:"0.95rem",opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"TCG":"This is my personal webpage to see what is on my shelves, wishlists, and TCG collections."}),c.jsx("div",{style:{display:"inline-flex",alignItems:"center",gap:"10px",padding:"8px 14px",borderRadius:"999px",border:"1px solid rgba(255,182,193,0.5)",background:"linear-gradient(135deg, rgba(255,182,193,0.18), rgba(43,15,29,0.9))",boxShadow:"0 8px 24px rgba(0,0,0,0.55)",marginTop:"14px",fontSize:"0.78rem",color:"#ffe6ed",letterSpacing:"0.05em",textTransform:"uppercase",fontWeight:700,opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?c.jsx("span",{style:{letterSpacing:"0.06em"},children:"          TCG"}):c.jsx("span",{style:{letterSpacing:"0.06em"},children:" Manga   Anime   Music   TCG"})})]}),c.jsxs("section",{style:{display:"grid",gridTemplateColumns:"minmax(0, 2fr) minmax(0, 3fr)",gap:"20px",marginTop:"24px"},children:[c.jsxs("article",{className:"card",children:[c.jsx("h2",{style:{marginTop:0,marginBottom:"8px",fontSize:"1.2rem",color:"#ffb6c1"},children:c.jsx("span",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"About Me"})}),c.jsx("p",{style:{margin:0,color:"var(--text-soft)",fontSize:"0.9rem",lineHeight:1.5,opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"im.okTCG":"Hey, I am Tyler and I go by im.ok. I hoard manga, binge anime, and collect trading cards."}),c.jsx("p",{style:{marginTop:"10px",color:"var(--text-soft)",fontSize:"0.9rem",opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"TCG":"This site is where I track everything: volumes on my shelves, finished shows, and my TCG collection as they all slowly grow."}),c.jsxs("div",{style:{marginTop:"12px",display:"flex",flexWrap:"wrap",gap:"6px",opacity:v,transition:"opacity 0.25s ease"},children:[c.jsx("span",{className:"pill",children:f==="jp"?"":"Manga library"}),c.jsx("span",{className:"pill",children:f==="jp"?"":"My Anime List (MAL)"}),c.jsx("span",{className:"pill",children:f==="jp"?" & TCG":"Pokemon & One Piece TCG"}),c.jsx("span",{className:"pill",children:f==="jp"?"":"Data Nerd"})]})]}),c.jsxs("article",{className:"card",children:[c.jsx("h2",{style:{marginTop:0,marginBottom:"8px",fontSize:"1.2rem",color:"#ffb6c1"},children:c.jsx("span",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Explore these pages"})}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(210px, 1fr))",gap:"14px",marginTop:"10px"},children:[c.jsxs("a",{href:"/base/manga",className:"section-card",children:[c.jsx("h3",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Manga Library"}),c.jsx("p",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Full manga collection & wishlist."}),c.jsx("div",{className:"section-chip-row",children:c.jsx("span",{className:"section-chip accent",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Library & wishlist"})})]}),c.jsxs("a",{href:"/base/music",className:"section-card",style:{justifySelf:"end",alignSelf:"end",order:99},children:[c.jsx("h3",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Music"}),c.jsx("p",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"If you are here for my music, this is the page for you! Catch all the latest releases."}),c.jsxs("div",{className:"section-chip-row",children:[c.jsx("span",{className:"section-chip accent",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Latest tracks"}),c.jsx("span",{className:"section-chip",style:{opacity:v,transition:"opacity 0.25s ease"},children:"Spotify & SoundCloud"})]})]}),c.jsxs("a",{href:"/base/anime",className:"section-card",children:[c.jsx("h3",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Anime Library"}),c.jsx("p",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"MAL":"The entire watched, plan to watch, and watching list synced directly from MyAnimeList."}),c.jsxs("div",{className:"section-chip-row",children:[c.jsx("span",{className:"section-chip accent",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"MAL":"MAL synced"}),c.jsx("span",{className:"section-chip",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Status filters"}),c.jsx("span",{className:"section-chip",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Quick stats"})]})]}),c.jsxs("a",{href:"/base/tcg",className:"section-card",children:[c.jsx("h3",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"TCG":"TCG Collection"}),c.jsx("p",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"TCG":"Pokemon & One Piece TCG cards tracked with quantities, prices, and value."}),c.jsxs("div",{className:"section-chip-row",children:[c.jsx("span",{className:"section-chip accent",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Full Collection"}),c.jsx("span",{className:"section-chip",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Still Under-Construction"})]})]})]})]})]}),c.jsx("footer",{style:{marginTop:"28px",fontSize:"0.78rem",color:"var(--text-soft)",textAlign:"center"},children:"@ 2025 im.ok. All rights reserved."})]})}const vR="modulepreload",_R=function(n){return"/base/"+n},zv={},rc=function(e,t,s){let a=Promise.resolve();if(t&&t.length>0){let d=function(v){return Promise.all(v.map(w=>Promise.resolve(w).then(T=>({status:"fulfilled",value:T}),T=>({status:"rejected",reason:T}))))};document.getElementsByTagName("link");const f=document.querySelector("meta[property=csp-nonce]"),m=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));a=d(t.map(v=>{if(v=_R(v),v in zv)return;zv[v]=!0;const w=v.endsWith(".css"),T=w?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${v}"]${T}`))return;const I=document.createElement("link");if(I.rel=w?"stylesheet":vR,w||(I.as="script"),I.crossOrigin="",I.href=v,m&&I.setAttribute("nonce",m),document.head.appendChild(I),w)return new Promise((B,X)=>{I.addEventListener("load",B),I.addEventListener("error",()=>X(new Error(`Unable to preload CSS for ${v}`)))})}))}function l(d){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=d,window.dispatchEvent(f),!f.defaultPrevented)throw d}return a.then(d=>{for(const f of d||[])f.status==="rejected"&&l(f.reason);return e().catch(l)})};function Fw({open:n,title:e,placeholder:t,value:s,status:a,loading:l,onChange:d,onSubmit:f,onClose:m}){if(!n)return null;const v=typeof a=="string"&&a.toLowerCase().startsWith("sent!")?"#a3f0cf":"#ffb6c1";return c.jsx("div",{className:"suggestion-backdrop",onClick:w=>{w.target===w.currentTarget&&m&&m()},children:c.jsxs("div",{className:"suggestion-modal",children:[c.jsxs("div",{className:"suggestion-modal-header",children:[c.jsx("h3",{children:e}),c.jsx("button",{className:"suggestion-close",type:"button",onClick:m,children:"Close"})]}),c.jsx("p",{className:"suggestion-hint",children:"Tell me what to add next. Titles only is fine, but extra notes are welcome."}),c.jsx("textarea",{className:"suggestion-textarea",placeholder:t,value:s,onChange:w=>d==null?void 0:d(w.target.value),maxLength:500}),a&&c.jsx("div",{className:"suggestion-status",style:{color:v},children:a}),c.jsxs("div",{className:"suggestion-actions",children:[c.jsx("button",{className:"suggestion-send",type:"button",onClick:f,disabled:l,children:l?"Sending...":"Send Suggestion"}),c.jsx("button",{className:"suggestion-cancel",type:"button",onClick:m,children:"Cancel"})]})]})})}const Bv=5,wR=3600*1e3,$v="mangaSuggestionsSent",Wv="mangaViewMode";function kt(n){let e=(n||"").trim();const t=e.match(/^(.*?)(?:,?\s*(?:Vol\.|Volume)\s*(\d+)(?:\s*[--]\s*\d+)?\s*)?(?:\s*\([^)]*\))?$/i),s=t?t[1].trim().toLowerCase():e.toLowerCase(),a=t&&t[2]?parseInt(t[2],10):0;return{name:s,vol:Number.isFinite(a)?a:0}}function wr(n){if(!n)return"";const e=String(n).trim();if(/^\d{4}-\d{2}-\d{2}$/.test(e))return e;const t=new Date(e);if(Number.isNaN(t.getTime()))return"";const s=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),l=String(t.getDate()).padStart(2,"0");return`${s}-${a}-${l}`}const xR=(n,e)=>{const t=kt(n.title||""),s=kt(e.title||""),a=t.name.localeCompare(s.name);return a!==0?a:t.vol-s.vol};function ER(n){const t=(n||"").match(/vol(?:ume)?\.?\s*(\d+)(?:\s*[-]\s*(\d+))?/i);if(!t)return[];const s=parseInt(t[1],10),a=t[2]?parseInt(t[2],10):s;if(!Number.isFinite(s))return[];const l=Number.isFinite(a)&&a>=s?a:s,d=[];for(let f=s;f<=l;f+=1)d.push(f);return d}function TR(){const{admin:n,user:e,role:t}=Fo(),s=n,[a,l]=k.useState("library"),[d,f]=k.useState(()=>typeof window>"u"?"series":localStorage.getItem(Wv)==="individual"?"individual":"series");k.useEffect(()=>{document.title="Manga | Library"},[]),k.useEffect(()=>{He("")},[e]),k.useEffect(()=>{try{localStorage.setItem(Wv,d)}catch(E){console.warn("Failed to persist manga view mode",E)}},[d]);const m=async()=>{const E=Date.now(),H=(()=>{try{const V=localStorage.getItem($v);return Array.isArray(JSON.parse(V))?JSON.parse(V):[]}catch{return[]}})().filter(V=>E-V<wR);if(H.length>=Bv){He("Rate limit: please wait a bit (max 5 suggestions per hour).");return}if(!Ee.trim()){He("Please enter a manga title or note before sending.");return}xt(!0),He("");try{const V=`**Manga Suggestion**
${Ee.trim()}
From: ${(e==null?void 0:e.displayName)||(e==null?void 0:e.email)||(e==null?void 0:e.uid)||"anonymous user"}`;await yo(Hn(it,"suggestions"),{content:Ee.trim(),type:"manga",from:(e==null?void 0:e.displayName)||(e==null?void 0:e.email)||(e==null?void 0:e.uid)||"anonymous user",createdAt:new Date().toISOString()}),He("Sent! I'll review your suggestion soon."),ve("");const q=[...H,E].slice(-Bv);localStorage.setItem($v,JSON.stringify(q))}catch(V){console.error("Failed to send suggestion",V),He("Failed to send suggestion. Please try again later.")}finally{xt(!1)}},[v,w]=k.useState([]),[T,I]=k.useState([]),[B,X]=k.useState([]),[K,M]=k.useState([]),[ne,be]=k.useState(!1),[_e,we]=k.useState(!0),[le,Ie]=k.useState(""),[A,P]=k.useState(""),[R,F]=k.useState(""),[z,L]=k.useState(!1),[b,he]=k.useState(()=>new Set);k.useEffect(()=>{d==="series"&&z&&(typeof Ve>"u"||Ve===null)&&(L(!1),he(new Set))},[d,z]);const[xe,ut]=k.useState({open:!1,mode:"add",list:"library",data:{title:"",authors:"",publisher:"",demographic:"",genre:"",subGenre:"",date:"",cover:"",isbn:"",pageCount:"",rating:"",amountPaid:"",dateRead:"",datePurchased:"",msrp:"",special:!1,specialType:"",specialVolumes:"",collectiblePrice:"",amazonURL:"",read:!1},editingId:null,multiAdd:!1,startVol:"",endVol:""}),[Be,ye]=k.useState([]),[je,Pe]=k.useState(0),[D,N]=k.useState({open:!1,index:0,items:[]}),[se,te]=k.useState(!1),[Ee,ve]=k.useState(""),[Me,He]=k.useState(""),[et,xt]=k.useState(!1),[J,$e]=k.useState(null),[Ve,Ke]=k.useState(null);k.useEffect(()=>{if(!!J||!!Ve||xe.open||D.open||se){const G=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=G}}},[J,Ve,xe.open,D.open,se]);const Et=!!e&&t==="viewer";async function Tt(){const E=await ti(Hn(it,"library")),G=[];E.forEach(H=>{const V=H.data();G.push({id:H.id,title:V.title||"",authors:V.authors||"Unknown",publisher:V.publisher||"Unknown",demographic:V.demographic||"",genre:V.genre||"",subGenre:V.subGenre||"",date:wr(V.date)||V.date||"Unknown",cover:V.cover||"",isbn:V.isbn||"",pageCount:V.pageCount!==void 0&&V.pageCount!==null?V.pageCount:"",rating:V.rating!==void 0&&V.rating!==null?V.rating:"",amountPaid:V.amountPaid!==void 0&&V.amountPaid!==null?V.amountPaid:"",dateRead:wr(V.dateRead)||V.dateRead||"",datePurchased:wr(V.datePurchased)||V.datePurchased||"",msrp:V.msrp!==void 0&&V.msrp!==null?V.msrp:"",specialType:V.specialType||"",specialVolumes:V.specialVolumes!==void 0&&V.specialVolumes!==null?V.specialVolumes:"",collectiblePrice:V.collectiblePrice!==void 0&&V.collectiblePrice!==null?V.collectiblePrice:"",read:!!V.read,amazonURL:V.amazonURL||"",hidden:!!V.hidden,kind:"library"})}),G.sort((H,V)=>{const q=kt(H.title),ae=kt(V.title),ie=q.name.localeCompare(ae.name);return ie!==0?ie:q.vol-ae.vol}),w(G),X(H=>{const V=new Set(H);return G.forEach(q=>V.add(q.title||"")),Array.from(V).filter(Boolean).sort()})}async function _t(){const E=await ti(Hn(it,"wishlist")),G=[];E.forEach(H=>{const V=H.data();G.push({id:H.id,title:V.title||"",authors:V.authors||"Unknown",publisher:V.publisher||"Unknown",date:wr(V.date)||V.date||"Unknown",cover:V.cover||"",isbn:V.isbn||"",pageCount:V.pageCount!==void 0&&V.pageCount!==null?V.pageCount:"",rating:V.rating!==void 0&&V.rating!==null?V.rating:"",amountPaid:V.amountPaid!==void 0&&V.amountPaid!==null?V.amountPaid:"",datePurchased:wr(V.datePurchased)||V.datePurchased||"",specialType:V.specialType||"",specialVolumes:V.specialVolumes!==void 0&&V.specialVolumes!==null?V.specialVolumes:"",collectiblePrice:V.collectiblePrice!==void 0&&V.collectiblePrice!==null?V.collectiblePrice:"",amazonURL:V.amazonURL||"",hidden:!!V.hidden,kind:"wishlist"})}),G.sort((H,V)=>{const q=kt(H.title),ae=kt(V.title),ie=q.name.localeCompare(ae.name);return ie!==0?ie:q.vol-ae.vol}),I(G),X(H=>{const V=new Set(H);return G.forEach(q=>V.add(q.title||"")),Array.from(V).filter(Boolean).sort()})}k.useEffect(()=>{let E=!1,G=!1,H=!1;const V=async()=>{if(!E)try{const Se=await fetch("/base/manga-library-wishlist.json",{cache:"no-cache"});if(!Se.ok)throw new Error("fallback fetch failed");const ke=await Se.json(),oe=Array.isArray(ke.library)?ke.library:[],rt=Array.isArray(ke.wishlist)?ke.wishlist:[];w(oe.map((De,Qt)=>({id:De.id||`offline-lib-${Qt}`,title:De.title||"",authors:De.authors||"Unknown",publisher:De.publisher||"Unknown",demographic:De.demographic||"",genre:De.genre||"",subGenre:De.subGenre||"",date:wr(De.date)||De.date||"Unknown",cover:De.cover||"",isbn:De.isbn||"",pageCount:De.pageCount??"",rating:De.rating??"",amountPaid:De.amountPaid??"",dateRead:wr(De.dateRead)||De.dateRead||"",datePurchased:wr(De.datePurchased)||De.datePurchased||"",msrp:De.msrp??"",specialType:De.specialType||"",specialVolumes:De.specialVolumes??"",collectiblePrice:De.collectiblePrice??"",amazonURL:De.amazonURL||"",read:!!De.read,hidden:!!De.hidden,kind:"library"}))),I(rt.map((De,Qt)=>({id:De.id||`offline-wish-${Qt}`,title:De.title||"",authors:De.authors||"Unknown",publisher:De.publisher||"Unknown",demographic:De.demographic||"",genre:De.genre||"",subGenre:De.subGenre||"",date:wr(De.date)||De.date||"Unknown",cover:De.cover||"",isbn:De.isbn||"",pageCount:De.pageCount??"",rating:De.rating??"",amountPaid:De.amountPaid??"",dateRead:wr(De.dateRead)||De.dateRead||"",datePurchased:wr(De.datePurchased)||De.datePurchased||"",msrp:De.msrp??"",specialType:De.specialType||"",specialVolumes:De.specialVolumes??"",collectiblePrice:De.collectiblePrice??"",amazonURL:De.amazonURL||"",read:!!De.read,hidden:!!De.hidden,kind:"wishlist"}))),Ie("")}catch(Ne){console.error("Offline fallback failed",Ne),Ie("Failed to load manga data from Firestore.")}finally{E||we(!1)}},q=()=>{G&&H&&!E&&we(!1)};if(!e)return;we(!0),Ie("");const ae=Fv(Hn(it,"library"),Ne=>{if(E)return;const Se=[];Ne.forEach(ke=>{const oe=ke.data();Se.push({id:ke.id,title:oe.title||"",authors:oe.authors||"Unknown",publisher:oe.publisher||"Unknown",demographic:oe.demographic||"",genre:oe.genre||"",subGenre:oe.subGenre||"",date:oe.date||"Unknown",cover:oe.cover||"",isbn:oe.isbn||"",pageCount:oe.pageCount!==void 0&&oe.pageCount!==null?oe.pageCount:"",rating:oe.rating!==void 0&&oe.rating!==null?oe.rating:"",amountPaid:oe.amountPaid!==void 0&&oe.amountPaid!==null?oe.amountPaid:"",dateRead:oe.dateRead||"",datePurchased:oe.datePurchased||"",msrp:oe.msrp!==void 0&&oe.msrp!==null?oe.msrp:"",specialType:oe.specialType||"",specialVolumes:oe.specialVolumes!==void 0&&oe.specialVolumes!==null?oe.specialVolumes:"",collectiblePrice:oe.collectiblePrice!==void 0&&oe.collectiblePrice!==null?oe.collectiblePrice:"",read:!!oe.read,amazonURL:oe.amazonURL||"",hidden:!!oe.hidden,kind:"library"})}),Se.sort((ke,oe)=>{const rt=kt(ke.title),De=kt(oe.title),Qt=rt.name.localeCompare(De.name);return Qt!==0?Qt:rt.vol-De.vol}),w(Se),X(ke=>{const oe=new Set(ke);return Se.forEach(rt=>oe.add(rt.title||"")),Array.from(oe).filter(Boolean).sort()}),G=!0,q()},async Ne=>{console.error("Library listener failed",Ne),E||(Ie("Failed to load manga data from Firestore."),await V())}),ie=Fv(Hn(it,"wishlist"),Ne=>{if(E)return;const Se=[];Ne.forEach(ke=>{const oe=ke.data();Se.push({id:ke.id,title:oe.title||"",authors:oe.authors||"Unknown",publisher:oe.publisher||"Unknown",demographic:oe.demographic||"",genre:oe.genre||"",subGenre:oe.subGenre||"",date:oe.date||"Unknown",cover:oe.cover||"",isbn:oe.isbn||"",pageCount:oe.pageCount!==void 0&&oe.pageCount!==null?oe.pageCount:"",rating:oe.rating!==void 0&&oe.rating!==null?oe.rating:"",amountPaid:oe.amountPaid!==void 0&&oe.amountPaid!==null?oe.amountPaid:"",datePurchased:oe.datePurchased||"",specialType:oe.specialType||"",specialVolumes:oe.specialVolumes!==void 0&&oe.specialVolumes!==null?oe.specialVolumes:"",collectiblePrice:oe.collectiblePrice!==void 0&&oe.collectiblePrice!==null?oe.collectiblePrice:"",amazonURL:oe.amazonURL||"",hidden:!!oe.hidden,kind:"wishlist"})}),Se.sort((ke,oe)=>{const rt=kt(ke.title),De=kt(oe.title),Qt=rt.name.localeCompare(De.name);return Qt!==0?Qt:rt.vol-De.vol}),I(Se),X(ke=>{const oe=new Set(ke);return Se.forEach(rt=>oe.add(rt.title||"")),Array.from(oe).filter(Boolean).sort()}),H=!0,q()},async Ne=>{console.error("Wishlist listener failed",Ne),E||(Ie("Failed to load manga data from Firestore."),await V())});return()=>{E=!0,ae==null||ae(),ie==null||ie()}},[e]);const St=k.useMemo(()=>{const E=A.trim().toLowerCase();return E?v.filter(G=>[G.title,G.authors,G.publisher,G.isbn,G.date,String(G.pageCount??"")].join(" ").toLowerCase().includes(E)):v},[v,A]),$t=k.useMemo(()=>s&&ne?St:St.filter(E=>!E.hidden),[St,s,ne]),cn=k.useMemo(()=>{const E=R.trim().toLowerCase();return E?T.filter(G=>[G.title,G.authors,G.publisher,G.isbn,G.date,String(G.pageCount??"")].join(" ").toLowerCase().includes(E)):T},[T,R]),Cn=k.useMemo(()=>s&&ne?cn:cn.filter(E=>!E.hidden),[cn,s,ne]),Qn=E=>{f(E==="individual"?"individual":"series"),he(new Set),L(!1)},Yn=E=>{if(!(E!=null&&E.length))return;const G=(H,V)=>{let q=[...H];return E.filter(ae=>ae.target===V).forEach(ae=>{const ie=q.findIndex(Se=>Se.id===ae.id),Ne={...ie>=0?q[ie]:{},...ae.payload,id:ae.id,kind:V};ie>=0?q[ie]=Ne:q.push(Ne)}),q.sort(xR),q};w(H=>G(H,"library")),I(H=>G(H,"wishlist"))},un=E=>{L(G=>{const H=!G;if(H){const V=new Set((E||[]).map(q=>q.id));he(q=>new Set([...q].filter(ae=>V.has(ae))))}else he(new Set);return H})};function Jn(){s&&(L(E=>!E),he(new Set))}function ft(E){he(G=>{const H=new Set(G);return H.has(E)?H.delete(E):H.add(E),H})}async function Pt(E,G=null){if(!s){alert("Multi-select actions require admin access.");return}const H=Array.from(b);if(!H.length){alert("Select at least one item first.");return}const V=a==="library"?"library":"wishlist",q=G||(V==="library"?"wishlist":"library"),ae=V==="library";try{if(E==="move"){const ie=V==="library"?v:T;if(!window.confirm(`Move ${H.length} item(s) from ${V==="library"?"Library":"Wishlist"} to ${q==="library"?"Library":"Wishlist"}?`))return;for(const Ne of H){const Se=ie.find(oe=>oe.id===Ne);if(!Se)continue;const ke=q==="library"?{title:Se.title,authors:Se.authors,publisher:Se.publisher,date:Se.date,pageCount:Se.pageCount||"",cover:Se.cover,amountPaid:"",read:!1,rating:"",msrp:"",collectiblePrice:"",specialType:"",specialVolumes:"",isbn:Se.isbn||"",demographic:Se.demographic||"",genre:Se.genre||"",subGenre:Se.subGenre||"",hidden:!!Se.hidden,datePurchased:Se.datePurchased||"",dateRead:Se.dateRead||""}:{title:Se.title,authors:Se.authors,publisher:Se.publisher,date:Se.date,pageCount:Se.pageCount||"",cover:Se.cover,amazonURL:Se.amazonURL||"",hidden:!!Se.hidden,datePurchased:"",read:!1,rating:"",msrp:"",collectiblePrice:"",specialType:"",specialVolumes:"",isbn:"",demographic:"",genre:"",subGenre:""};await yo(Hn(it,q),ke),await go(Dt(it,V,Ne))}}else if(E==="markRead"&&ae)for(const ie of H)await Ns(Dt(it,"library",ie),{read:!0,dateRead:new Date().toISOString().slice(0,10)});else if(E==="markUnread"&&ae)for(const ie of H)await Ns(Dt(it,"library",ie),{read:!1,dateRead:"",rating:""});else if(E==="delete"){const ie=ae?"library":"wishlist";if(!window.confirm(`Delete ${H.length} item(s) from ${ae?"Library":"Wishlist"}?`))return;for(const Ne of H)await go(Dt(it,ie,Ne))}await Promise.all([Tt(),_t()]),he(new Set),L(!1)}catch(ie){console.error(ie),alert("Failed to apply multi-select action.")}}function Jt(E){$e(E)}function ar(){$e(null)}function or(E){const G=Nn.filter(H=>(kt(H.title||"").name||(H.title||"").toLowerCase()||H.id)===E.key).sort((H,V)=>kt(H.title).vol-kt(V.title).vol);Ke({series:E,volumes:G})}function Vr(){Ke(null)}const lr=()=>{ut(E=>({...E,open:!1,mode:"add",editingId:null,data:{title:"",authors:"",publisher:"",demographic:"",genre:"",subGenre:"",date:"",cover:"",isbn:"",pageCount:"",rating:"",amountPaid:"",dateRead:"",datePurchased:"",msrp:"",special:!1,specialType:"",specialVolumes:"",collectiblePrice:"",amazonURL:"",read:!1,hidden:!1},multiAdd:!1,startVol:"",endVol:""})),ye([]),Pe(0)},yn=k.useMemo(()=>{const E=new Map;return[...v,...T].forEach(G=>{const H=kt(G.title||"");if(!H.name)return;const V=(G.title||"").replace(/,?\s*Vol\.?\s*\d+.*/i,"").trim()||G.title||H.name;if(!E.has(H.name))E.set(H.name,{display:V,maxVol:H.vol,authors:G.authors||"",publisher:G.publisher||"",demographic:G.demographic||""});else{const q=E.get(H.name);q.maxVol=Math.max(q.maxVol,H.vol),!q.authors&&G.authors&&(q.authors=G.authors),!q.publisher&&G.publisher&&(q.publisher=G.publisher),!q.demographic&&G.demographic&&(q.demographic=G.demographic)}}),E},[v,T]),Fs=E=>{ut(G=>({...G,open:!0,mode:"add",list:E,editingId:null,data:{...G.data,title:"",list:E}})),ye([{kind:"new",id:null,data:{title:"",authors:"",publisher:"",demographic:"",genre:"",subGenre:"",date:"",cover:"",isbn:"",pageCount:"",rating:"",amountPaid:"",dateRead:"",datePurchased:"",msrp:"",specialType:"",specialVolumes:"",collectiblePrice:"",amazonURL:"",read:!1}}]),Pe(0)},ms=E=>{const G={open:!0,mode:"edit",list:E.kind==="wishlist"?"wishlist":"library",editingId:E.id,data:{title:E.title||"",authors:E.authors||"",publisher:E.publisher||"",demographic:E.demographic||"",genre:E.genre||"",subGenre:E.subGenre||"",date:E.date||"",cover:E.cover||"",isbn:E.isbn||"",pageCount:E.pageCount||"",rating:E.rating||"",amountPaid:E.amountPaid||"",dateRead:E.dateRead||"",datePurchased:E.datePurchased||"",msrp:E.msrp||"",special:!!(E.specialType||E.specialVolumes||E.collectiblePrice),specialType:E.specialType||"",specialVolumes:E.specialVolumes||"",collectiblePrice:E.collectiblePrice||"",amazonURL:E.amazonURL||"",read:!!E.read,hidden:!!E.hidden}};ut(G),ye([{kind:"edit",id:E.id,data:{...G.data}}]),Pe(0)},Ct=(E,G,H="text")=>{if(ut(V=>{const q={...V.data,[E]:H==="checkbox"?!!G:G};if(E==="special"&&!G&&(q.specialType="",q.specialVolumes="",q.collectiblePrice=""),E==="specialType"&&(G==="collectible"?q.specialVolumes="":(G==="specialEdition"||(q.specialVolumes=""),q.collectiblePrice="")),E==="title"){const ae=kt(G||"");if(ae.name&&yn.has(ae.name)){const ie=yn.get(ae.name);q.authors=ie.authors||q.authors,q.publisher=ie.publisher||q.publisher,q.demographic=ie.demographic||q.demographic}}return{...V,data:q}}),ye(V=>{if(!V.length)return V;const q=[...V],ae={...q[je]};return ae.data={...ae.data,[E]:H==="checkbox"?!!G:G},q[je]=ae,q}),E==="title"){const V=String(G||"").trim().toLowerCase();if(!V)M([]);else{const q=[];yn.forEach(ae=>{if(ae.display.toLowerCase().includes(V)){const ie=ae.maxVol>0?ae.maxVol+1:1;q.push(`${ae.display}, Vol. ${ie}`)}}),M(q.slice(0,6))}}},Lr=E=>{Be[E]&&(Pe(E),ut(G=>{const H=Be[E];return{...G,data:{...H.data}}}))},cr=()=>{const E=xe.data.title||"",G=kt(E);if(!G.name){alert("Provide a title with a volume number first (e.g., Series, Vol. 1).");return}const H=E.replace(/,?\s*Vol\.?\s*\d+.*/i,"").trim()||E;let V=G.vol||0;const q=yn.get(G.name);q&&q.maxVol>V&&(V=q.maxVol),Be.forEach(Se=>{const ke=kt(Se.data.title||"");ke.name===G.name&&(V=Math.max(V,ke.vol||0))});const ae=(V||0)+1,Ne={title:`${H}, Vol. ${ae}`,authors:xe.data.authors,publisher:xe.data.publisher,demographic:xe.data.demographic,genre:xe.data.genre,subGenre:xe.data.subGenre,msrp:xe.data.msrp,hidden:xe.data.hidden,cover:"",isbn:"",pageCount:"",rating:"",amountPaid:"",date:"",dateRead:"",datePurchased:"",special:!1,specialType:"",specialVolumes:"",collectiblePrice:"",amazonURL:"",read:!1};ye(Se=>{const ke=[...Se,{kind:"new",id:null,data:Ne}];return Pe(ke.length-1),ke}),ut(Se=>({...Se,mode:"add",data:Ne}))};async function gs(){if(!s)return;const{list:E}=xe,G=E||"library",H=Be.length>0?Be:[{kind:xe.mode,id:xe.editingId,data:xe.data}],V=q=>({title:(q.title||"").trim(),authors:(q.authors||"").trim(),publisher:(q.publisher||"").trim(),demographic:(q.demographic||"").trim(),genre:(q.genre||"").trim(),subGenre:(q.subGenre||"").trim(),date:wr(q.date||""),cover:(q.cover||"").trim(),isbn:G==="wishlist"?"":(q.isbn||"").trim(),pageCount:q.pageCount===""?"":Number(q.pageCount),rating:G==="wishlist"||q.rating===""?"":Math.max(.5,Math.min(5,Number(q.rating))),amountPaid:q.amountPaid===""?"":Number(q.amountPaid),dateRead:wr(q.dateRead||""),datePurchased:wr(q.datePurchased||""),msrp:G==="wishlist"||q.msrp===""?"":Number(q.msrp),special:G==="wishlist"?!1:!!(q.special&&(q.specialType||"").trim()),specialType:G==="wishlist"||!(q.special&&(q.specialType||"").trim())?"":(q.specialType||"").trim(),specialVolumes:G==="wishlist"?"":q.special&&q.specialType==="specialEdition"?q.specialVolumes===""?"":Number(q.specialVolumes):"",collectiblePrice:G==="wishlist"?"":q.special&&q.specialType==="collectible"?q.collectiblePrice===""?"":Number(q.collectiblePrice):"",amazonURL:(q.amazonURL||"").trim(),read:G==="wishlist"?!1:!!q.read,hidden:!!q.hidden,kind:E});try{const q=await Promise.all(H.map(async ae=>{const ie=V(ae.data);if(G==="library"&&ae.kind!=="edit"){const Ne=kt(ie.title).name,Se=v.filter(oe=>kt(oe.title||oe.Title||"").name===Ne),ke=Se[0];if(ke&&(ie.demographic=ie.demographic||ke.demographic||ke.Demographic||"",ie.genre=ie.genre||ke.genre||ke.Genre||"",ie.subGenre=ie.subGenre||ke.subGenre||ke.SubGenre||"",ie.msrp==="")){const oe=Se.map(rt=>Number(rt.msrp??rt.MSRP)).filter(rt=>Number.isFinite(rt));oe.length>0&&oe.every(De=>De===oe[0])&&(ie.msrp=oe[0])}}if(!ie.title)throw alert("Title is required for every entry."),new Error("missing title");if(ae.kind==="edit"&&ae.id)return await Ns(Dt(it,G,ae.id),ie),{target:G,id:ae.id,payload:ie};{const Ne=await yo(Hn(it,G),ie);return{target:G,id:Ne.id,payload:ie}}}));Yn(q.filter(Boolean)),await Promise.all([Tt(),_t()]),lr()}catch(q){console.error(q),alert("Failed to save entry.")}}async function ur(E,G){if(s&&window.confirm("Delete this entry?"))try{await go(Dt(it,G,E)),await Promise.all([Tt(),_t()])}catch(H){console.error(H),alert("Failed to delete entry.")}}const[In,Xn]=k.useState(!1),Sr=()=>N({open:!1,index:0,items:[]});async function Wt(E,G){if(!(E!=null&&E.id))return;const H=E.kind==="wishlist"?"wishlist":"library";Xn(!0);try{await Ns(Dt(it,H,E.id),G),Yn([{target:H,id:E.id,payload:G}]),await Promise.all([Tt(),_t()]),$e(V=>V&&V.id===E.id?{...V,...G}:V)}catch(V){console.error(V),alert("Failed to update entry.")}finally{Xn(!1)}}const Zn=(E,G)=>{const H=G===""?"":Math.max(.5,Math.min(5,Number(G)));Wt(E,{rating:H})},er=(E,G)=>{if(!E)return;const H=G?{read:!0,dateRead:new Date().toISOString().slice(0,10)}:{read:!1,dateRead:""};Wt(E,H)},ys=()=>{if(!b.size){alert("Select at least one entry first.");return}const G=[...v,...T].filter(V=>b.has(V.id));if(!G.length){alert("No items selected.");return}const H=G.map(V=>({id:V.id,kind:V.kind||(a==="wishlist"?"wishlist":"library"),data:{title:V.title||"",authors:V.authors||"",publisher:V.publisher||"",demographic:V.demographic||"",genre:V.genre||"",subGenre:V.subGenre||"",date:V.date||"",cover:V.cover||"",isbn:V.isbn||"",pageCount:V.pageCount||"",rating:V.rating||"",amountPaid:V.amountPaid||"",dateRead:V.dateRead||"",datePurchased:V.datePurchased||"",msrp:V.msrp||"",special:!!(V.specialType||V.specialVolumes||V.collectiblePrice),specialType:V.specialType||"",specialVolumes:V.specialVolumes||"",collectiblePrice:V.collectiblePrice||"",amazonURL:V.amazonURL||"",read:!!V.read,hidden:!!V.hidden}}));N({open:!0,index:0,items:H})},ct=(E,G,H="text")=>{N(V=>{const q=[...V.items],ae={...q[V.index]},ie={...ae.data,[E]:H==="checkbox"?!!G:G};return E==="special"&&!G&&(ie.specialType="",ie.specialVolumes="",ie.collectiblePrice=""),E==="specialType"&&(G==="collectible"?ie.specialVolumes="":(G==="specialEdition"||(ie.specialVolumes=""),ie.collectiblePrice="")),ae.data=ie,q[V.index]=ae,{...V,items:q}})},vn=()=>{N(E=>({...E,index:Math.min(E.index+1,E.items.length-1)}))},At=()=>{N(E=>({...E,index:Math.max(E.index-1,0)}))};async function Jr(){if(!s)return;const E=D.items;if(!E.length){Sr();return}try{const G=await Promise.all(E.map(async H=>{const q=!(H.kind==="wishlist")&&!!(H.data.special&&(H.data.specialType||"").trim()),ae={...H.data,pageCount:H.data.pageCount===""?"":Number(H.data.pageCount),rating:H.data.rating===""?"":Math.max(.5,Math.min(5,Number(H.data.rating))),amountPaid:H.data.amountPaid===""?"":Number(H.data.amountPaid),msrp:H.data.msrp===""?"":Number(H.data.msrp),special:q,specialType:q?H.data.specialType:"",collectiblePrice:q&&H.data.specialType==="collectible"?H.data.collectiblePrice===""?"":Number(H.data.collectiblePrice):"",specialVolumes:q&&H.data.specialType==="specialEdition"?H.data.specialVolumes===""?"":Number(H.data.specialVolumes):"",datePurchased:H.data.datePurchased||"",amazonURL:H.data.amazonURL||"",read:!!H.data.read},ie=H.kind==="wishlist"?"wishlist":"library";return await Ns(Dt(it,ie,H.id),ae),{target:ie,id:H.id,payload:ae}}));Yn(G.filter(Boolean)),await Promise.all([Tt(),_t()]),he(new Set),L(!1),Sr()}catch(G){console.error(G),alert("Failed to save bulk edits.")}}const bn=E=>{const G=new Map;return E.forEach(H=>{const V=kt(H.title||""),q=V.name||(H.title||"").toLowerCase()||H.id,ae=yn.get(V.name)||null,ie=(ae==null?void 0:ae.display)||(H.title||"").replace(/,?\s*Vol\.?\s*\d+.*/i,"").trim()||H.title||"Untitled",Ne=ER(H.title||""),Se=Number.isFinite(V.vol)?V.vol:0,ke=Ne.length>0?Ne:Se>0?[Se]:[],oe=ke.length?ke[0]:0;if(!G.has(q))G.set(q,{id:`series-${q}`,key:q,title:ie,authors:H.authors&&H.authors!=="Unknown"?H.authors:(ae==null?void 0:ae.authors)||"",publisher:H.publisher&&H.publisher!=="Unknown"?H.publisher:(ae==null?void 0:ae.publisher)||"",demographic:(ae==null?void 0:ae.demographic)||H.demographic||"",cover:H.cover||"",count:1,readCount:H.read?1:0,minVol:oe,maxVol:oe,representative:H,volumes:[...ke]});else{const rt=G.get(q);if(rt.count+=1,H.read&&(rt.readCount+=1),ke.length){const De=Math.min(...ke),Qt=Math.max(...ke);rt.minVol=Math.min(rt.minVol,De),rt.maxVol=Math.max(rt.maxVol,Qt),rt.volumes.push(...ke)}!rt.cover&&H.cover&&(rt.cover=H.cover),!rt.authors&&H.authors&&H.authors!=="Unknown"&&(rt.authors=H.authors),!rt.publisher&&H.publisher&&H.publisher!=="Unknown"&&(rt.publisher=H.publisher)}}),Array.from(G.values())},Or=E=>{const G=Array.from(new Set((E||[]).filter(ie=>Number.isFinite(ie)&&ie>0))).sort((ie,Ne)=>ie-Ne);if(!G.length)return null;const H=[];let V=G[0],q=G[0];for(let ie=1;ie<G.length;ie+=1){const Ne=G[ie];if(Ne===q+1){q=Ne;continue}H.push([V,q]),V=Ne,q=Ne}if(H.push([V,q]),H.length===1){const[ie,Ne]=H[0];return ie===Ne?`Vol. ${ie}`:`Vol. ${ie}-${Ne}`}return`Vols. ${H.map(([ie,Ne])=>ie===Ne?`${ie}`:`${ie}-${Ne}`).join(", ")}`};function Cr(E){const G=b.has(E.id),H=E.kind==="library",V=()=>{z&&s?ft(E.id):Jt(E)};return c.jsxs("div",{className:"manga-card"+(E.read&&H?" read":"")+(G?" multiselect-selected":""),onClick:V,children:[c.jsx("div",{className:"manga-card-cover-wrap",children:c.jsx("img",{src:E.cover||"https://imgur.com/chUgq4W.png",alt:"Cover",loading:"lazy",decoding:"async"})}),c.jsxs("div",{className:"manga-card-body",children:[c.jsx("div",{className:"manga-card-title",children:E.title||"Untitled"}),c.jsxs("div",{className:"manga-card-meta",children:[E.authors&&E.authors!=="Unknown"&&c.jsxs(c.Fragment,{children:[E.authors,c.jsx("br",{})]}),E.publisher&&E.publisher!=="Unknown"&&c.jsxs(c.Fragment,{children:[E.publisher,c.jsx("br",{})]}),E.date&&E.date!=="Unknown"&&E.date]}),E.isbn&&c.jsxs("div",{className:"manga-card-isbn",children:["ISBN: ",E.isbn]}),s&&c.jsxs("div",{className:"manga-card-actions",children:[c.jsx("button",{type:"button",className:"manga-btn mini",onClick:q=>{q.stopPropagation(),ms(E)},children:"Edit"}),c.jsx("button",{type:"button",className:"manga-btn mini danger",onClick:q=>{q.stopPropagation(),ur(E.id,E.kind==="wishlist"?"wishlist":"library")},children:"Delete"})]})]})]},E.id)}function Pn(E){var ae;const G=Or(E.volumes),H=`${E.count} volume${E.count===1?"":"s"}`;E.readCount>=E.count&&E.count>0||`${E.readCount}${E.count}`;const V=E.readCount>=E.count&&E.count>0,q=[E.authors&&E.authors!=="Unknown"?E.authors:null,E.publisher&&E.publisher!=="Unknown"?E.publisher:null,G?`${H} - ${G}`:H].filter(Boolean);return c.jsxs("div",{className:"manga-card series-view"+(V?" read":""),onClick:()=>or(E),children:[c.jsx("div",{className:"manga-card-cover-wrap",children:c.jsx("img",{src:E.cover||((ae=E.representative)==null?void 0:ae.cover)||"https://imgur.com/chUgq4W.png",alt:"Cover",loading:"lazy",decoding:"async"})}),c.jsxs("div",{className:"manga-card-body",children:[c.jsx("div",{className:"manga-card-title",children:E.title||"Untitled Series"}),c.jsx("div",{className:"manga-card-meta",children:q.map((ie,Ne)=>c.jsxs(Of.Fragment,{children:[ie,c.jsx("br",{})]},ie+Ne))}),c.jsx("div",{className:"manga-card-series-count",children:H})]})]},E.id)}const Rn=({value:E,onChange:G})=>{const[H,V]=k.useState(null),q=Math.max(0,Math.min(5,Number(E)||0)),ae=H??q,ie=Array.from({length:10},(ke,oe)=>(oe+1)*.5),Ne=5,Se=Array.from({length:Ne},(ke,oe)=>Math.max(0,Math.min(1,ae-oe)));return c.jsxs("div",{className:"star-shell",role:"group","aria-label":"Rating",children:[c.jsxs("div",{className:"star-visual",style:{"--star-count":Ne},children:[c.jsx("div",{className:"star-row",children:Se.map((ke,oe)=>c.jsxs("div",{className:"star-icon",children:[c.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",className:"star-base",children:c.jsx("path",{d:"M12 2.5l2.9 5.88 6.5.95-4.7 4.58 1.1 6.43L12 17.9l-5.8 3.44 1.1-6.43-4.7-4.58 6.5-.95L12 2.5z"})}),c.jsx("div",{className:"star-fill",style:{"--pct":`${(Math.max(0,Math.min(1,ke))*100).toFixed(1)}%`},children:c.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:c.jsx("path",{d:"M12 2.5l2.9 5.88 6.5.95-4.7 4.58 1.1 6.43L12 17.9l-5.8 3.44 1.1-6.43-4.7-4.58 6.5-.95L12 2.5z"})})})]},oe))}),c.jsx("div",{className:"star-hit",children:ie.map(ke=>c.jsx("button",{type:"button","aria-label":`${ke} stars`,onMouseEnter:()=>V(ke),onMouseLeave:()=>V(null),onClick:()=>G(ke)},ke))})]}),c.jsx("div",{className:"star-value",children:ae?ae.toFixed(1):"--"}),c.jsx("button",{type:"button",className:"star-clear",onClick:()=>G(""),"aria-label":"Clear rating",children:"clear"})]})},Nn=a==="library"?$t:Cn,vs=a==="library"?v:T,Gt=k.useMemo(()=>bn(Nn),[Nn,yn]),Us=k.useMemo(()=>bn(vs),[vs,yn]);k.useEffect(()=>{if(!J&&!Ve)return;const E=[...v,...T];if(J){const G=E.find(H=>H.id===J.id);G?(G.title!==J.title||G.isbn!==J.isbn||G.publisher!==J.publisher||G.authors!==J.authors||G.date!==J.date||G.pageCount!==J.pageCount||G.amountPaid!==J.amountPaid||G.msrp!==J.msrp||G.rating!==J.rating||G.read!==J.read||G.amazonURL!==J.amazonURL)&&$e(G):$e(null)}if(Ve){const G=Gt.find(ie=>ie.key===Ve.series.key);if(!G){Ke(null);return}const H=Nn.filter(ie=>(kt(ie.title||"").name||(ie.title||"").toLowerCase()||ie.id)===G.key).sort((ie,Ne)=>kt(ie.title).vol-kt(Ne.title).vol),V=H.length===Ve.volumes.length&&H.every((ie,Ne)=>{var Se;return((Se=Ve.volumes[Ne])==null?void 0:Se.id)===ie.id}),q=H.length!==Ve.volumes.length||H.some((ie,Ne)=>{const Se=Ve.volumes[Ne];return!Se||Se.id!==ie.id?!0:Se.title!==ie.title||Se.authors!==ie.authors||Se.publisher!==ie.publisher||Se.date!==ie.date||Se.isbn!==ie.isbn||Se.cover!==ie.cover||Se.read!==ie.read||Se.pageCount!==ie.pageCount||Se.amountPaid!==ie.amountPaid||Se.msrp!==ie.msrp||Se.rating!==ie.rating}),ae=G.title!==Ve.series.title||G.authors!==Ve.series.authors||G.publisher!==Ve.series.publisher||G.count!==Ve.series.count;(q||ae||!V)&&Ke({series:G,volumes:H})}},[v,T,J,Ve,Nn,Gt]);const _n=d==="series"?Gt:Nn;d==="series"?Gt.length:Nn.length,d==="series"?Us.length:vs.length;const Mn=(E,G)=>{if(!E.length)return;const H=Array.from(E.reduce((Se,ke)=>(Object.keys(ke).forEach(oe=>Se.add(oe)),Se),new Set)),V=Se=>{const ke=Se==null?"":String(Se);return/[",\n]/.test(ke)?`"${ke.replace(/"/g,'""')}"`:ke},q=[H.join(",")].concat(E.map(Se=>H.map(ke=>V(Se[ke])).join(","))),ae=new Blob([q.join(`
`)],{type:"text/csv"}),ie=URL.createObjectURL(ae),Ne=document.createElement("a");Ne.href=ie,Ne.download=G,Ne.click(),URL.revokeObjectURL(ie)},Fn=async(E,G)=>{const H=(q,ae="image")=>(q||"").toString().toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"").slice(0,100)||ae,V=E.filter(q=>q.cover).map((q,ae)=>({url:q.cover,name:H(q.title||`manga-${ae+1}`,`manga-${ae+1}`)}));if(!V.length){alert("No images found to download.");return}try{const q=(await rc(async()=>{const{default:De}=await import("https://cdn.jsdelivr.net/npm/jszip@3.10.1/+esm");return{default:De}},[])).default,ae=new q,ie=ae.folder("images"),Ne={},Se=V.map(async(De,Qt)=>{try{const br=await(await fetch(De.url)).blob(),es=(De.url.split(".").pop()||"jpg").split(/[?#]/)[0],ts=De.name||`image-${Qt+1}`;Ne[ts]=(Ne[ts]||0)+1;const S=Ne[ts]>1?`-${Ne[ts]}`:"";ie.file(`${ts}${S}.${es}`,br)}catch(Mr){console.warn("Failed to fetch image",De.url,Mr)}});await Promise.all(Se);const ke=await ae.generateAsync({type:"blob"}),oe=URL.createObjectURL(ke),rt=document.createElement("a");rt.href=oe,rt.download=G,rt.click(),URL.revokeObjectURL(oe)}catch(q){console.error("Zip download failed",q),alert("Failed to create zip. Please try again.")}},pi=(E,G)=>{const H=new Blob([JSON.stringify(E,null,2)],{type:"application/json"}),V=URL.createObjectURL(H),q=document.createElement("a");q.href=V,q.download=G,q.click(),URL.revokeObjectURL(V)},Xr=E=>({title:E.title||"",authors:E.authors||"",publisher:E.publisher||"",demographic:E.demographic||"",genre:E.genre||"",subGenre:E.subGenre||"",date:E.date||"",pageCount:E.pageCount??"",cover:E.cover||"",amountPaid:E.amountPaid??"",read:!!E.read,rating:E.rating??"",dateRead:E.dateRead||"",datePurchased:E.datePurchased||"",msrp:E.msrp??"",collectiblePrice:E.collectiblePrice??"",specialType:E.specialType||"",specialVolumes:E.specialVolumes??"",isbn:E.isbn||"",amazonURL:E.amazonURL||"",hidden:!!E.hidden}),_s=E=>{const H=kt(E.title||"").name;if(!H)return"";const q=[...v,...T].find(ae=>{const Ne=kt(ae.title||"").name===H,Se=ae.msrp!==void 0&&ae.msrp!==null&&ae.msrp!=="";return Ne&&Se});return q?q.msrp:""},ws=E=>{const H=kt(E.title||"").name;if(!H)return{demographic:"",genre:"",subGenre:""};const q=[...v,...T].find(ae=>kt(ae.title||"").name===H&&(ae.demographic||ae.genre||ae.subGenre));return{demographic:(q==null?void 0:q.demographic)||"",genre:(q==null?void 0:q.genre)||"",subGenre:(q==null?void 0:q.subGenre)||""}},Zr=async E=>{if(!s||!(E!=null&&E.id))return;const G=E.kind==="wishlist"?"wishlist":"library",H=G==="library"?"wishlist":"library";try{const V=Xr(E);if(H==="library"){const q=_s(E);(V.msrp===""||V.msrp===null||V.msrp===void 0)&&(V.msrp=q);const ae=ws(E);V.demographic||(V.demographic=ae.demographic),V.genre||(V.genre=ae.genre),V.subGenre||(V.subGenre=ae.subGenre)}await yo(Hn(it,H),V),await go(Dt(it,G,E.id)),await Promise.all([Tt(),_t()]),Ke(q=>q&&{...q,volumes:q.volumes.filter(ae=>ae.id!==E.id)}),ar()}catch(V){console.error("Move failed",V),alert("Failed to move item.")}},Ir=xe.list==="wishlist",zs=D.items[D.index]||null,pt=(zs==null?void 0:zs.kind)==="wishlist";return c.jsxs("div",{className:"manga-page",children:[c.jsxs("header",{className:"manga-header",style:{flexDirection:"column",alignItems:"center",textAlign:"center"},children:[c.jsx("div",{className:"manga-header-title",style:{justifyContent:"center",gap:"0.6rem",fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Tyler's Manga Library"}),c.jsx("div",{className:"manga-header-sub",style:{textAlign:"center"},children:"This is my Manga Library and Wishlist. Check and see all the Manga I have in my possession!"})]}),Et&&c.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"6px"},children:c.jsx("button",{className:"suggestion-trigger",type:"button",onClick:()=>{He(""),te(!0)},children:"+ Suggestion"})}),c.jsxs("div",{className:"manga-tabs",children:[c.jsx("button",{className:"manga-tab-btn"+(a==="library"?" active":""),onClick:()=>{l("library"),L(!1),he(new Set)},children:"Library"}),c.jsx("button",{className:"manga-tab-btn"+(a==="wishlist"?" active":""),onClick:()=>{l("wishlist"),L(!1),he(new Set)},children:"Wishlist"})]}),a!=="dashboard"&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"manga-toolbar",children:[c.jsxs("div",{className:"manga-toolbar-left",children:[c.jsx("input",{type:"text",className:"manga-search-input",placeholder:a==="library"?"Search library by title, author, ISBN...":"Search wishlist...",value:a==="library"?A:R,onChange:E=>a==="library"?P(E.target.value):F(E.target.value)}),c.jsx("div",{className:"manga-counter",children:(()=>{const E=a==="library",G=(E?A:R).trim(),H=E?v.length:T.length,V=E?St.length:cn.length;return G?`${V} / ${H} Volumes`:`${H} Volumes`})()})]}),c.jsxs("div",{className:"manga-toolbar-right",children:[c.jsxs("div",{className:"manga-view-toggle",children:[c.jsx("button",{className:"manga-btn secondary"+(d==="series"?" active":""),type:"button","aria-pressed":d==="series","aria-label":"Series view",title:"Series View",onClick:()=>Qn("series"),children:""}),c.jsx("button",{className:"manga-btn secondary"+(d==="individual"?" active":""),type:"button","aria-pressed":d==="individual","aria-label":"Volume view",title:"Volume View",onClick:()=>Qn("individual"),children:""})]}),s&&c.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>be(E=>!E),children:ne?"Hide Hidden":"Show Hidden"}),s&&c.jsx("button",{className:"manga-btn secondary"+(z?" active":""),disabled:d==="series",onClick:Jn,children:z?"Exit Multi-select":"Multi-select"})]})]}),s&&z&&d==="individual"&&c.jsxs("div",{className:"manga-multiselect-bar",children:[c.jsxs("span",{children:["Selected: ",c.jsx("strong",{children:b.size})]}),c.jsx("button",{className:"manga-btn",onClick:ys,children:"Bulk Edit"}),c.jsxs("button",{className:"manga-btn secondary",onClick:()=>Pt("move"),children:["Move to ",a==="library"?"Wishlist":"Library"]}),a==="library"&&c.jsxs(c.Fragment,{children:[c.jsx("button",{className:"manga-btn",onClick:()=>Pt("markRead"),children:"Mark Read"}),c.jsx("button",{className:"manga-btn secondary",onClick:()=>Pt("markUnread"),children:"Mark Unread"})]}),c.jsx("button",{className:"manga-btn danger",onClick:()=>Pt("delete"),children:"Delete"})]})]}),_e?c.jsx("div",{className:"manga-empty-state",children:"Loading manga from Firestore..."}):le?c.jsx("div",{className:"manga-empty-state",children:le}):_n.length===0?c.jsx("div",{className:"manga-empty-state",children:"No manga found. Try changing your search."}):c.jsx("div",{className:"manga-grid",children:_n.map(E=>d==="series"?Pn(E):Cr(E))}),Ve&&c.jsx("div",{className:"manga-modal-backdrop visible",onClick:E=>{E.target===E.currentTarget&&Vr()},children:c.jsx("div",{className:"manga-modal series",children:c.jsxs("div",{className:"manga-modal-body",children:[c.jsxs("div",{className:"manga-modal-header",children:[c.jsx("div",{className:"manga-modal-title",children:Ve.series.title||"Series"}),c.jsx("button",{className:"manga-modal-close",onClick:Vr,type:"button",children:"Close"})]}),c.jsxs("div",{className:"manga-modal-subtitle",children:[Ve.series.count," volume",Ve.series.count===1?"":"s"," in this series"]}),s&&c.jsxs("div",{className:"series-bulk-controls",children:[c.jsx("button",{type:"button",className:"manga-btn mini secondary"+(z?" active":""),onClick:()=>un(Ve.volumes),children:z?"Exit Multi-select":"Multi-select"}),z&&c.jsxs(c.Fragment,{children:[c.jsx("button",{type:"button",className:"manga-btn mini secondary",onClick:()=>{const E=Ve.volumes.map(G=>G.id);he(new Set(E))},children:"Select All"}),c.jsx("button",{type:"button",className:"manga-btn mini secondary",onClick:()=>{he(new Set)},children:"Clear"}),a==="wishlist"?c.jsx("button",{type:"button",className:"manga-btn mini",disabled:!b.size,onClick:()=>{b.size&&Pt("move","library")},children:"Move to Library"}):c.jsx("button",{type:"button",className:"manga-btn mini",disabled:!b.size,onClick:()=>{b.size&&Pt("move","wishlist")},children:"Move to Wishlist"}),c.jsxs("button",{type:"button",className:"manga-btn mini",disabled:!b.size,onClick:()=>{if(!b.size)return;const E=new Set(Ve.volumes.map(G=>G.id));he(G=>new Set([...G].filter(H=>E.has(H)))),ys()},children:["Bulk Edit Selected (",b.size||0,")"]})]})]}),c.jsx("div",{className:"manga-series-modal-grid",children:Ve.volumes.map(E=>c.jsxs("div",{className:"manga-card mini-card"+(E.read?" read":""),onClick:()=>{if(!s){Jt(E);return}if(z){ft(E.id);return}Jt(E)},children:[c.jsxs("div",{className:"manga-card-cover-wrap",children:[z&&s&&c.jsx("div",{className:"mini-select-indicator"+(b.has(E.id)?" selected":""),children:b.has(E.id)?"":""}),c.jsx("img",{src:E.cover||"https://imgur.com/chUgq4W.png",alt:E.title||"Cover",loading:"lazy",decoding:"async"})]}),c.jsxs("div",{className:"manga-card-body",children:[c.jsx("div",{className:"manga-card-title",children:E.title||"Untitled"}),c.jsxs("div",{className:"manga-card-meta",children:[E.authors&&E.authors!=="Unknown"&&c.jsxs(c.Fragment,{children:[E.authors,c.jsx("br",{})]}),E.publisher&&E.publisher!=="Unknown"&&c.jsxs(c.Fragment,{children:[E.publisher,c.jsx("br",{})]}),E.date&&E.date!=="Unknown"&&E.date]}),E.isbn&&c.jsxs("div",{className:"manga-card-isbn",children:["ISBN: ",E.isbn]})]})]},E.id))})]})})}),s&&c.jsxs("div",{className:"manga-floating-actions",children:[c.jsxs("button",{className:"manga-btn",type:"button","aria-label":"Add item",onClick:()=>Fs(a==="wishlist"?"wishlist":"library"),children:["+ ",a==="wishlist"?"Wishlist":"Library"]}),c.jsxs("div",{className:"manga-export-actions",children:[n&&c.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>pi({library:v,wishlist:T},"manga-library-wishlist.json"),children:"Export JSON"}),c.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>Mn(a==="library"?v:T,a==="library"?"manga-library.csv":"manga-wishlist.csv"),children:"Export CSV"}),c.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>Fn(a==="library"?v:T,a==="library"?"manga-library-images.zip":"manga-wishlist-images.zip"),children:"Download Images"})]})]}),J&&c.jsx("div",{className:"manga-modal-backdrop visible",onClick:E=>{E.target===E.currentTarget&&ar()},children:c.jsxs("div",{className:"manga-modal",children:[c.jsxs("div",{className:"manga-modal-cover-wrap",children:[J.kind==="library"&&J.read&&c.jsx("div",{className:"manga-modal-read-pill",children:"Read"}),c.jsx("img",{src:J.cover||"https://imgur.com/chUgq4W.png",alt:"Cover"})]}),c.jsxs("div",{className:"manga-modal-body",children:[c.jsxs("div",{className:"manga-modal-header",children:[c.jsx("div",{className:"manga-modal-title",children:J.title||"Untitled"}),c.jsx("button",{className:"manga-modal-close",onClick:ar,type:"button",children:"Close"})]}),c.jsxs("div",{className:"manga-modal-meta",children:[J.authors&&J.authors!=="Unknown"&&c.jsxs(c.Fragment,{children:[c.jsx("strong",{children:"Author(s):"})," ",J.authors,c.jsx("br",{})]}),J.publisher&&J.publisher!=="Unknown"&&c.jsxs(c.Fragment,{children:[c.jsx("strong",{children:"Publisher:"})," ",J.publisher,c.jsx("br",{})]}),J.date&&c.jsxs(c.Fragment,{children:[c.jsx("strong",{children:"Release:"})," ",J.date,c.jsx("br",{})]}),J.isbn&&c.jsxs(c.Fragment,{children:[c.jsx("strong",{children:"ISBN:"})," ",J.isbn,c.jsx("br",{})]})]}),c.jsxs("div",{className:"manga-modal-details",children:[J.pageCount&&c.jsxs(c.Fragment,{children:[c.jsx("strong",{children:"Pages:"})," ",J.pageCount,c.jsx("br",{})]}),c.jsxs("div",{style:{margin:"6px 0"},children:[c.jsx("strong",{children:"Rating:"})," ",c.jsx(Rn,{value:J.rating||"",onChange:E=>Zn(J,E)})]}),J.amountPaid&&c.jsxs(c.Fragment,{children:[c.jsx("strong",{children:"Amount Paid:"})," $",J.amountPaid,c.jsx("br",{})]}),J.msrp&&c.jsxs(c.Fragment,{children:[c.jsx("strong",{children:"MSRP:"})," $",J.msrp,c.jsx("br",{})]}),J.collectiblePrice&&c.jsxs(c.Fragment,{children:[c.jsx("strong",{children:"Collectible:"})," $",J.collectiblePrice,c.jsx("br",{})]}),J.read&&J.dateRead&&c.jsxs(c.Fragment,{children:[c.jsx("strong",{children:"Date Read:"})," ",J.dateRead,c.jsx("br",{})]}),J.amazonURL&&c.jsx("div",{style:{marginTop:"6px"},children:c.jsx("a",{href:J.amazonURL,target:"_blank",rel:"noreferrer",children:"View on Amazon"})})]}),c.jsxs("div",{className:"manga-modal-footer",style:{gap:"10px",alignItems:"center"},children:[c.jsx("div",{children:J.kind==="library"&&J.read?"Marked as read in your library.":J.kind==="library"?"In your library (unread).":"Wishlist item - not in library yet."}),c.jsxs("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:[s&&c.jsx("button",{className:"manga-btn mini secondary",type:"button",onClick:()=>ms(J),children:"Edit"}),J.kind==="library"&&c.jsx(c.Fragment,{children:J.read?c.jsx("button",{className:"manga-btn mini secondary",disabled:In,onClick:()=>er(J,!1),type:"button",children:"Mark as unread"}):c.jsx("button",{className:"manga-btn mini",disabled:In,onClick:()=>er(J,!0),type:"button",children:"Mark as read"})}),s&&c.jsxs("button",{className:"manga-btn mini",type:"button",onClick:()=>Zr(J),children:["Move to ",J.kind==="library"?"Wishlist":"Library"]})]})]})]})]})}),s&&xe.open&&c.jsx("div",{className:"manga-modal-backdrop visible",onClick:E=>{E.target===E.currentTarget&&lr()},children:c.jsx("div",{className:"manga-modal admin",children:c.jsxs("div",{className:"manga-modal-body",children:[c.jsxs("div",{className:"manga-modal-header",children:[c.jsx("div",{className:"manga-modal-title",children:xe.mode==="add"?"Add Entry":"Edit Entry"}),c.jsx("button",{className:"manga-modal-close",onClick:lr,type:"button",children:"Close"})]}),c.jsxs("div",{className:"admin-form-layout",children:[c.jsx("div",{className:"admin-cover-frame",children:c.jsx("img",{src:xe.data.cover||"https://imgur.com/chUgq4W.png",alt:"Cover preview"})}),c.jsxs("div",{className:"admin-form-fields",children:[c.jsx("div",{className:"admin-row",children:c.jsxs("label",{children:["Title",c.jsx("input",{type:"text",value:xe.data.title,onChange:E=>Ct("title",E.target.value)})]})}),K.length>0&&c.jsx("div",{className:"title-suggestions",children:K.map((E,G)=>c.jsx("button",{type:"button",className:"manga-btn mini",onClick:()=>Ct("title",E),children:E},E+G))}),c.jsxs("div",{className:"admin-row two",style:{alignItems:"flex-end",marginTop:"-8px"},children:[c.jsxs("div",{children:[c.jsxs("div",{className:"manga-modal-subtitle",style:{marginBottom:"6px"},children:["Entry ",je+1," / ",Math.max(1,Be.length||1)]}),c.jsxs("div",{style:{display:"flex",gap:"8px"},children:[c.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>je>0&&Lr(je-1),disabled:je===0,children:"Previous"}),c.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>Be.length&&je<Be.length-1?Lr(je+1):null,disabled:!Be.length||je===Be.length-1,children:"Next"})]})]}),c.jsxs("div",{style:{textAlign:"right"},children:[c.jsx("button",{className:"manga-btn",type:"button",onClick:cr,disabled:!kt(xe.data.title||"").vol,children:"Add New Volume"}),c.jsx("div",{className:"manga-stat-sub",style:{marginTop:"4px"},children:"Auto-fills the next volume number for this series."})]})]}),c.jsx("div",{className:"admin-row",children:c.jsxs("label",{children:["Authors",c.jsx("input",{type:"text",value:xe.data.authors,onChange:E=>Ct("authors",E.target.value)})]})}),c.jsx("div",{className:"admin-row",children:c.jsxs("label",{children:["Publisher",c.jsx("input",{type:"text",value:xe.data.publisher,onChange:E=>Ct("publisher",E.target.value)})]})}),c.jsxs("div",{className:"admin-row three",children:[c.jsxs("label",{children:["Release Date",c.jsx("input",{type:"date",value:xe.data.date,onChange:E=>Ct("date",E.target.value)})]}),c.jsxs("label",{children:["Purchase Date",c.jsx("input",{type:"date",value:xe.data.datePurchased,onChange:E=>Ct("datePurchased",E.target.value)})]}),!Ir&&c.jsxs("label",{children:["Date Read",c.jsx("input",{type:"date",value:xe.data.dateRead,onChange:E=>Ct("dateRead",E.target.value)})]})]}),c.jsxs("div",{className:"admin-row two",children:[c.jsxs("label",{children:["Page Count",c.jsx("input",{type:"number",placeholder:"e.g. 192",value:xe.data.pageCount,onChange:E=>Ct("pageCount",E.target.value)})]}),!Ir&&c.jsxs("label",{children:["ISBN (library only)",c.jsx("input",{type:"text",value:xe.data.isbn,onChange:E=>Ct("isbn",E.target.value)})]})]}),c.jsx("div",{className:"admin-row",children:c.jsxs("label",{children:["Cover URL",c.jsx("input",{type:"text",placeholder:"Paste image URL here",value:xe.data.cover,onChange:E=>Ct("cover",E.target.value)})]})}),!Ir&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"admin-row two",children:[!(xe.data.special&&xe.data.specialType==="collectible")&&c.jsxs("label",{children:["Amount Paid",c.jsx("input",{type:"number",step:"0.01",value:xe.data.amountPaid,onChange:E=>Ct("amountPaid",E.target.value)})]}),c.jsxs("label",{children:["MSRP",c.jsx("input",{type:"number",step:"0.01",value:xe.data.msrp,onChange:E=>Ct("msrp",E.target.value)})]})]}),c.jsx("div",{className:"admin-row",children:c.jsxs("label",{className:"checkbox-row",children:[c.jsx("input",{type:"checkbox",checked:!!xe.data.special,onChange:E=>Ct("special",E.target.checked,"checkbox")}),c.jsx("span",{children:"Special item?"})]})}),xe.data.special&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"admin-row two",children:[c.jsxs("label",{children:["Special Type",c.jsxs("select",{value:xe.data.specialType,onChange:E=>Ct("specialType",E.target.value),children:[c.jsx("option",{value:"",children:"Select type"}),c.jsx("option",{value:"specialEdition",children:"Special Edition"}),c.jsx("option",{value:"collectible",children:"Collectible"})]})]}),xe.data.specialType==="collectible"&&c.jsxs("label",{children:["Collectible Price",c.jsx("input",{type:"number",step:"0.01",value:xe.data.collectiblePrice,onChange:E=>Ct("collectiblePrice",E.target.value)})]})]}),xe.data.specialType==="specialEdition"&&c.jsx("div",{className:"admin-row",children:c.jsxs("label",{children:["Special Volumes",c.jsx("input",{type:"number",min:"0",value:xe.data.specialVolumes,onChange:E=>Ct("specialVolumes",E.target.value)})]})})]})]}),Ir&&c.jsx("div",{className:"admin-row",children:c.jsxs("label",{children:["Amazon URL",c.jsx("input",{type:"text",value:xe.data.amazonURL,onChange:E=>Ct("amazonURL",E.target.value)})]})}),!Ir&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"admin-row",children:c.jsxs("label",{children:["Rating (1-5 stars)",c.jsx(Rn,{value:xe.data.rating,onChange:E=>Ct("rating",E)})]})}),c.jsxs("div",{className:"admin-row two",children:[c.jsxs("label",{className:"checkbox-inline",children:[c.jsx("input",{type:"checkbox",checked:xe.data.read,onChange:E=>Ct("read",E.target.checked,"checkbox")}),c.jsx("span",{children:"Mark as read"})]}),c.jsxs("label",{className:"checkbox-inline",children:[c.jsx("input",{type:"checkbox",checked:!!xe.data.hidden,onChange:E=>Ct("hidden",E.target.checked,"checkbox")}),c.jsx("span",{children:"Hide from public"})]})]})]}),Ir&&c.jsx("div",{className:"admin-row",children:c.jsxs("label",{className:"checkbox-inline",children:[c.jsx("input",{type:"checkbox",checked:!!xe.data.hidden,onChange:E=>Ct("hidden",E.target.checked,"checkbox")}),c.jsx("span",{children:"Hide from public"})]})})]})]}),c.jsxs("div",{className:"manga-modal-footer",style:{justifyContent:"flex-end",gap:"10px"},children:[c.jsx("button",{className:"manga-btn secondary",onClick:lr,type:"button",children:"Cancel"}),c.jsx("button",{className:"manga-btn",onClick:gs,type:"button",children:xe.mode==="add"?"Add":"Save"})]})]})})}),s&&D.open&&c.jsx("div",{className:"manga-modal-backdrop visible",onClick:E=>{E.target===E.currentTarget&&Sr()},children:c.jsx("div",{className:"manga-modal admin",children:c.jsxs("div",{className:"manga-modal-body",children:[c.jsxs("div",{className:"manga-modal-header",children:[c.jsxs("div",{className:"manga-modal-title",children:["Bulk Edit (",D.index+1," / ",D.items.length,")"]}),c.jsx("button",{className:"manga-modal-close",onClick:Sr,type:"button",children:"Close"})]}),D.items.length>0&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"manga-modal-subtitle",children:["Editing: ",D.items[D.index].data.title||"Untitled"]}),c.jsxs("div",{className:"admin-form-grid two-col",children:[c.jsx("div",{className:"admin-cover",children:c.jsx("div",{className:"manga-card-cover-wrap",children:c.jsx("img",{src:D.items[D.index].data.cover||"https://imgur.com/chUgq4W.png",alt:D.items[D.index].data.title||"Cover",loading:"lazy",decoding:"async"})})}),c.jsxs("div",{className:"admin-fields",children:[c.jsxs("div",{className:"admin-row two",children:[c.jsxs("label",{className:"full",children:["Title",c.jsx("input",{type:"text",value:D.items[D.index].data.title,onChange:E=>ct("title",E.target.value)})]}),c.jsxs("div",{className:"admin-entry-info",children:["Entry ",D.index+1," / ",D.items.length]})]}),c.jsx("div",{className:"admin-row",children:c.jsxs("label",{children:["Authors",c.jsx("input",{type:"text",value:D.items[D.index].data.authors,onChange:E=>ct("authors",E.target.value)})]})}),c.jsx("div",{className:"admin-row",children:c.jsxs("label",{children:["Publisher",c.jsx("input",{type:"text",value:D.items[D.index].data.publisher,onChange:E=>ct("publisher",E.target.value)})]})}),c.jsxs("div",{className:"admin-row three",children:[c.jsxs("label",{children:["Release Date",c.jsx("input",{type:"date",value:D.items[D.index].data.date,onChange:E=>ct("date",E.target.value)})]}),c.jsxs("label",{children:["Purchase Date",c.jsx("input",{type:"date",value:D.items[D.index].data.datePurchased,onChange:E=>ct("datePurchased",E.target.value)})]}),!pt&&c.jsxs("label",{children:["Date Read",c.jsx("input",{type:"date",value:D.items[D.index].data.dateRead,onChange:E=>ct("dateRead",E.target.value)})]})]}),c.jsxs("div",{className:"admin-row two",children:[c.jsxs("label",{children:["Page Count",c.jsx("input",{type:"number",value:D.items[D.index].data.pageCount,onChange:E=>ct("pageCount",E.target.value)})]}),!pt&&c.jsxs("label",{children:["ISBN (library only)",c.jsx("input",{type:"text",value:D.items[D.index].data.isbn,onChange:E=>ct("isbn",E.target.value)})]})]}),c.jsx("div",{className:"admin-row",children:c.jsxs("label",{children:["Cover URL",c.jsx("input",{type:"text",value:D.items[D.index].data.cover,onChange:E=>ct("cover",E.target.value)})]})}),!pt&&c.jsxs("div",{className:"admin-row two",children:[c.jsxs("label",{children:["Amount Paid",c.jsx("input",{type:"number",step:"0.01",value:D.items[D.index].data.amountPaid,onChange:E=>ct("amountPaid",E.target.value)})]}),c.jsxs("label",{children:["MSRP",c.jsx("input",{type:"number",step:"0.01",value:D.items[D.index].data.msrp,onChange:E=>ct("msrp",E.target.value)})]})]}),!pt&&c.jsx("div",{className:"admin-row two",children:c.jsxs("div",{children:[c.jsx("div",{className:"star-label",children:"Rating (1-5 stars)"}),c.jsx(Rn,{value:D.items[D.index].data.rating,onChange:E=>ct("rating",E)})]})}),!pt&&c.jsxs("div",{className:"admin-row two",children:[c.jsxs("label",{className:"checkbox-row",children:[c.jsx("input",{type:"checkbox",checked:!!D.items[D.index].data.special,onChange:E=>ct("special",E.target.checked,"checkbox")}),c.jsx("span",{children:"Special item?"})]}),c.jsxs("label",{className:"checkbox-row",children:[c.jsx("input",{type:"checkbox",checked:D.items[D.index].data.read,onChange:E=>ct("read",E.target.checked,"checkbox")}),c.jsx("span",{children:"Mark as read"})]})]}),D.items[D.index].data.special&&!pt&&c.jsxs("div",{className:"admin-row two",children:[c.jsxs("label",{children:["Special Type",c.jsxs("select",{value:D.items[D.index].data.specialType,onChange:E=>ct("specialType",E.target.value),children:[c.jsx("option",{value:"",children:"Select type"}),c.jsx("option",{value:"specialEdition",children:"Special Edition"}),c.jsx("option",{value:"collectible",children:"Collectible"})]})]}),D.items[D.index].data.specialType==="specialEdition"&&c.jsxs("label",{children:["Special Volumes",c.jsx("input",{type:"number",value:D.items[D.index].data.specialVolumes,onChange:E=>ct("specialVolumes",E.target.value)})]}),D.items[D.index].data.specialType==="collectible"&&c.jsxs("label",{children:["Collectible Price",c.jsx("input",{type:"number",step:"0.01",value:D.items[D.index].data.collectiblePrice,onChange:E=>ct("collectiblePrice",E.target.value)})]})]}),c.jsxs("div",{className:"admin-row two",children:[c.jsxs("label",{children:["Amazon URL",c.jsx("input",{type:"text",value:D.items[D.index].data.amazonURL,onChange:E=>ct("amazonURL",E.target.value)})]}),c.jsxs("label",{className:"checkbox-row",children:[c.jsx("input",{type:"checkbox",checked:!!D.items[D.index].data.hidden,onChange:E=>ct("hidden",E.target.checked,"checkbox")}),c.jsx("span",{children:"Hidden from public"})]})]})]})]}),c.jsxs("div",{className:"manga-modal-footer",style:{justifyContent:"space-between",gap:"10px"},children:[c.jsxs("div",{children:[c.jsx("button",{className:"manga-btn secondary",onClick:At,type:"button",disabled:D.index===0,children:"Previous"}),c.jsx("button",{className:"manga-btn secondary",onClick:vn,type:"button",disabled:D.index===D.items.length-1,style:{marginLeft:"6px"},children:"Next"})]}),c.jsxs("div",{style:{display:"flex",gap:"8px"},children:[c.jsx("button",{className:"manga-btn secondary",onClick:Sr,type:"button",children:"Cancel"}),c.jsx("button",{className:"manga-btn",onClick:Jr,type:"button",children:"Save Edits"})]})]})]})]})})}),Et&&c.jsx(Fw,{open:se,title:"Suggest a Manga",placeholder:"Type a manga you'd like me to collect/read...",value:Ee,status:Me,loading:et,onChange:ve,onSubmit:m,onClose:()=>te(!1)}),c.jsx("datalist",{id:"adminTitleSuggestions",children:B.map(E=>c.jsx("option",{value:E},E))})]})}const SR="https://imokmalworker.imokissick.workers.dev/?url=",Uw="im_ok",Gv=300,CR={1:"watching",2:"completed",3:"on_hold",4:"dropped",6:"plan_to_watch"};function IR(n){const e=n==null?void 0:n.title_localized,t=typeof e=="string"?e:(e==null?void 0:e.en)||(e==null?void 0:e.english);return(n==null?void 0:n.anime_title_eng)||(n==null?void 0:n.title_english)||t||(n==null?void 0:n.anime_title)||(n==null?void 0:n.title)||"Untitled"}function bR(n){const e=(n==null?void 0:n.updated_at)??(n==null?void 0:n.updatedAt)??(n==null?void 0:n.updated_at_ms)??null;if(e==null)return null;const t=Number(e);if(Number.isFinite(t))return t<1e12?t*1e3:t;const s=Date.parse(e);return Number.isNaN(s)?null:s}function PR(n){const e=CR[n.status]||(typeof n.status=="string"?n.status.toLowerCase():"unknown");return{id:n.anime_id||n.id,title:IR(n),updatedAt:bR(n),episodes:n.anime_num_episodes??n.episodes??null,watchedEpisodes:n.num_watched_episodes??n.my_watched_episodes??n.watched_episodes??n.num_watched??0,status:e,score:n.score??null,image:n.anime_image_path||n.image_url||n.anime_img||n.picture||null,synopsis:n.anime_synopsis||n.synopsis||null}}function Hv(){const n=Date.now();return[{id:1,title:"Cowboy Bebop",episodes:26,status:"completed",score:10,updatedAt:n-1e3*60*60*24*3,synopsis:"In 2071, bounty hunters Spike and Jet roam the solar system looking for their next payout and a place to belong."},{id:2,title:"Fullmetal Alchemist: Brotherhood",episodes:64,status:"completed",score:10,updatedAt:n-1e3*60*60*24*6,synopsis:"Brothers Edward and Alphonse Elric search for the Philosopher's Stone to restore their bodies after a failed alchemy ritual."},{id:3,title:"Frieren: Beyond Journey's End",episodes:28,status:"watching",score:9,updatedAt:n-1e3*60*60*8,synopsis:"An elven mage retraces the steps of a past adventure to understand humanity and the passage of time."},{id:4,title:"One Piece",episodes:1e3,status:"on_hold",score:8,updatedAt:n-1e3*60*60*24*14,synopsis:"Monkey D. Luffy sails toward the Grand Line seeking the One Piece and a crew to make his dream real."},{id:5,title:"Kaiju No. 8",episodes:12,status:"plan_to_watch",score:null,updatedAt:n-1e3*60*30,synopsis:"A middle-aged worker gains kaiju powers and joins the Defense Force to fight monsters from the inside."}]}async function RR(n,e){const t=`https://myanimelist.net/animelist/${n}/load.json?status=7&offset=${e}`,s=await fetch(`${SR}${encodeURIComponent(t)}`);if(!s.ok)throw new Error(`Failed to fetch MAL list (offset ${e})`);return s.json()}async function NR(n=Uw){const e=[];try{let t=0;for(;;){const s=await RR(n,t);if(!Array.isArray(s)||s.length===0||(e.push(...s),s.length<Gv))break;t+=Gv}}catch(t){return console.error("Failed to load MAL list; falling back to sample data.",t),Hv()}return e.length?e.map(PR):Hv()}async function AR(n){var e,t;if(!n)return null;try{const s=await fetch(`https://api.jikan.moe/v4/anime/${n}`);if(!s.ok)throw new Error(`Failed to fetch Jikan summary for id ${n}`);const a=await s.json();return((e=a==null?void 0:a.data)==null?void 0:e.synopsis)||((t=a==null?void 0:a.data)==null?void 0:t.background)||null}catch(s){return console.error("Failed to load anime synopsis",n,s),null}}async function kR(n=Uw){var e;if(!n)return null;try{const t=await fetch(`https://api.jikan.moe/v4/users/${encodeURIComponent(n)}/statistics`);if(!t.ok)throw new Error(`Failed to fetch user stats for ${n}`);const s=await t.json(),a=((e=s==null?void 0:s.data)==null?void 0:e.anime)||{},l=Number(a.days_watched),d=Number(a.total_episodes??a.episodes_watched);return{daysWatched:Number.isFinite(l)?l:null,episodesWatched:Number.isFinite(d)?d:null}}catch(t){return console.error("Failed to load user stats",n,t),null}}const qv=5,jR=3600*1e3,Kv="animeSuggestionsSent";function DR(){const{admin:n,user:e,role:t}=Fo(),s=J=>J?J.toString().replace(/_/g," ").replace(/\b\w/g,$e=>$e.toUpperCase()):"Unknown",[a,l]=k.useState([]),[d,f]=k.useState([]),[m,v]=k.useState(""),[w,T]=k.useState("all"),[I,B]=k.useState(!0),[X,K]=k.useState(""),[M,ne]=k.useState(null),[be,_e]=k.useState({}),[we,le]=k.useState(!1),[Ie,A]=k.useState(!1),[P,R]=k.useState(null),[F,z]=k.useState(!1),[L,b]=k.useState(""),[he,xe]=k.useState(""),[ut,Be]=k.useState(!1);k.useEffect(()=>{document.title="Anime | Library"},[]),k.useEffect(()=>{xe("")},[e]);const ye=J=>{if(!J)return"";const $e=Date.now()-J,Ve=Math.max($e,0),Ke=Math.floor(Ve/6e4);if(Ke<1)return"just now";if(Ke<60)return`${Ke}m ago`;const Et=Math.floor(Ke/60);if(Et<48)return`${Et}h ago`;const Tt=Math.floor(Et/24);if(Tt<14)return`${Tt}d ago`;const _t=Math.floor(Tt/7);return _t<8?`${_t}w ago`:`${Math.floor(Tt/30)}mo ago`},je=(J,$e="image")=>(J||"").toString().toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"").slice(0,80)||$e,Pe=async()=>{const J=a.filter($e=>$e.image).map(($e,Ve)=>({url:$e.image,name:je($e.title||`anime-${Ve+1}`,`anime-${Ve+1}`)}));if(!J.length){alert("No images found to download.");return}try{const $e=(await rc(async()=>{const{default:$t}=await import("https://cdn.jsdelivr.net/npm/jszip@3.10.1/+esm");return{default:$t}},[])).default,Ve=new $e,Ke=Ve.folder("images"),Et={};await Promise.all(J.map(async($t,cn)=>{try{const Qn=await(await fetch($t.url)).blob(),Yn=($t.url.split(".").pop()||"jpg").split(/[?#]/)[0],un=$t.name||`image-${cn+1}`;Et[un]=(Et[un]||0)+1;const Jn=Et[un]>1?`-${Et[un]}`:"";Ke.file(`${un}${Jn}.${Yn}`,Qn)}catch(Cn){console.warn("Failed to fetch image",$t.url,Cn)}}));const Tt=await Ve.generateAsync({type:"blob"}),_t=URL.createObjectURL(Tt),St=document.createElement("a");St.href=_t,St.download="anime-images.zip",St.click(),URL.revokeObjectURL(_t)}catch($e){console.error("Zip download failed",$e),alert("Failed to create zip. Please try again.")}};k.useEffect(()=>{async function J(){try{const $e=await NR();l($e),f($e)}catch($e){console.error($e),K("Failed to load data from MAL.")}finally{B(!1)}}J()},[]),k.useEffect(()=>{kR().then(J=>{J&&R(J)}).catch(()=>{})},[]);const D=J=>{switch((J||"unknown").toLowerCase()){case"watching":return 0;case"completed":return 1;case"on_hold":return 2;case"plan_to_watch":return 3;case"dropped":return 4;default:return 5}},N=J=>{const $e=Number.isFinite(Number(J.watchedEpisodes))?Number(J.watchedEpisodes):0,Ve=Number.isFinite(Number(J.episodes))?Number(J.episodes):null;return Ve?`${Math.min($e,Ve)}/${Ve} eps`:$e?`${$e} eps`:"No progress"};k.useEffect(()=>{let J=[...a];if(w!=="all"&&(J=J.filter($e=>($e.status||"").toLowerCase()===w)),m){const $e=m.toLowerCase();J=J.filter(Ve=>(Ve.title||"").toLowerCase().includes($e))}J.sort(($e,Ve)=>{const Ke=D($e.status),Et=D(Ve.status);return Ke!==Et?Ke-Et:($e.title||"").localeCompare(Ve.title||"")}),f(J)},[a,w,m]);const se=k.useMemo(()=>[...a].filter(J=>Number.isFinite(J.updatedAt)).sort((J,$e)=>$e.updatedAt-J.updatedAt).slice(0,6),[a]),te=!!e&&t==="viewer",Ee=async()=>{const J=Date.now(),Ve=(()=>{try{const Ke=localStorage.getItem(Kv);return Array.isArray(JSON.parse(Ke))?JSON.parse(Ke):[]}catch{return[]}})().filter(Ke=>J-Ke<jR);if(Ve.length>=qv){xe("Rate limit: please wait a bit (max 5 suggestions per hour).");return}if(!L.trim()){xe("Please enter a title or note before sending.");return}Be(!0),xe("");try{const Ke=`**Anime Suggestion**
${L.trim()}
From: ${(e==null?void 0:e.displayName)||(e==null?void 0:e.email)||(e==null?void 0:e.uid)||"anonymous user"}`;await yo(Hn(it,"suggestions"),{content:L.trim(),type:"anime",from:(e==null?void 0:e.displayName)||(e==null?void 0:e.email)||(e==null?void 0:e.uid)||"anonymous user",createdAt:new Date().toISOString()}),xe("Sent! I'll review your suggestion soon."),b("");const Et=[...Ve,J].slice(-qv);localStorage.setItem(Kv,JSON.stringify(Et))}catch(Ke){console.error("Failed to send suggestion",Ke),xe("Failed to send suggestion. Please try again later.")}finally{Be(!1)}};k.useEffect(()=>{if(!M){A(!1),le(!1);return}A(!!M.synopsis),le(!1)},[M==null?void 0:M.id]);const ve=k.useMemo(()=>{const J=a.length,$e=a.reduce((_t,St)=>{const $t=Number(St.watchedEpisodes);return Number.isFinite($t)?_t+$t:_t},0),Ve=$e*.4,Ke=a.filter(_t=>Number.isFinite(_t.score)&&_t.score>0),Et=Ke.reduce((_t,St)=>_t+St.score,0),Tt={watching:0,completed:0,on_hold:0,dropped:0,plan_to_watch:0,unknown:0};return a.forEach(_t=>{const St=(_t.status||"unknown").toLowerCase();Tt[St]!=null?Tt[St]+=1:Tt.unknown+=1}),{total:J,totalWatchedEpisodes:$e,byStatus:Tt,avgScore:Ke.length?Et/Ke.length:0,totalHours:Ve}},[a]),Me=(P==null?void 0:P.daysWatched)??(ve.totalHours||0)/24,He=(P==null?void 0:P.episodesWatched)??ve.totalWatchedEpisodes,et=J=>{const $e=J.image||"https://imgur.com/chUgq4W.png",Ve=Number.isFinite(Number(J.watchedEpisodes))?Number(J.watchedEpisodes):0,Ke=Number.isFinite(Number(J.episodes))?Number(J.episodes):null,Et=Ke?`Episode ${Math.min(Ve,Ke)}/${Ke}`:`Episode ${Ve}`,Tt=Number.isFinite(Number(J.score))&&Number(J.score)>0?J.score:"Not rated";return c.jsxs("article",{className:"anime-card",onClick:()=>ne(J.synopsis?J:{...J,synopsis:be[J.id]}),children:[c.jsxs("div",{className:"anime-cover-wrap",children:[c.jsx("img",{className:"anime-cover",src:$e,alt:J.title,loading:"lazy",decoding:"async"}),c.jsx("div",{className:`badge-status ${(J.status||"unknown").toLowerCase()}`,children:s(J.status)}),J.score!=null&&c.jsx("div",{className:"badge-score",children:Tt})]}),c.jsxs("div",{className:"anime-meta",children:[c.jsx("div",{className:"anime-title",title:J.title,children:J.title}),c.jsx("div",{className:"anime-sub",children:J.episodes?`${J.episodes} episodes`:"Episodes: ?"}),c.jsx("div",{className:"anime-progress",children:Et}),c.jsxs("div",{className:"anime-progress",children:["Status: ",s(J.status)]})]})]},J.id||J.title)},xt=J=>c.jsxs("article",{className:"anime-update-card",children:[c.jsx("div",{className:"anime-update-title",title:J.title,children:J.title}),c.jsxs("div",{className:"anime-update-meta",children:[c.jsx("span",{className:"anime-update-progress",children:N(J)}),c.jsx("span",{className:"anime-update-dot","aria-hidden":"true",children:""}),c.jsx("span",{className:"anime-update-status",children:s(J.status)})]}),c.jsx("div",{className:"anime-update-time",children:ye(J.updatedAt)})]},`update-${J.id||J.title}`);return c.jsxs("main",{className:"anime-page",children:[c.jsxs("div",{className:"anime-content",children:[c.jsxs("header",{className:"anime-header",style:{position:"relative",display:"flex",justifyContent:"center",alignItems:"center",textAlign:"center",width:"100%"},children:[c.jsxs("div",{style:{textAlign:"center",margin:"0 auto",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"0 60px"},children:[c.jsx("h1",{className:"anime-title",style:{margin:0,fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Tyler's Anime Library"}),c.jsx("p",{className:"anime-sub",style:{textAlign:"center",margin:"6px 0 0"},children:"The Anime I've watched/watching synced directly from MAL (MyAnimeList)"})]}),(te||n)&&c.jsxs("div",{style:{position:"absolute",right:0,top:"50%",transform:"translateY(-50%)",display:"flex",gap:"10px"},children:[te&&c.jsx("button",{className:"suggestion-trigger",type:"button",onClick:()=>{xe(""),z(!0)},children:"+ Suggestion"}),n&&c.jsx("button",{className:"stat-link",type:"button",onClick:Pe,children:"Download Images"})]})]}),c.jsxs("div",{className:"anime-stats",children:[c.jsxs("div",{className:"anime-stat-card",children:[c.jsx("div",{className:"anime-stat-label",children:"Total Entries"}),c.jsx("div",{className:"anime-stat-value",children:ve.total})]}),c.jsxs("div",{className:"anime-stat-card",children:[c.jsx("div",{className:"anime-stat-label",children:"Episodes Watched"}),c.jsx("div",{className:"anime-stat-value",children:He})]}),c.jsxs("div",{className:"anime-stat-card",children:[c.jsx("div",{className:"anime-stat-label",children:"Watching"}),c.jsx("div",{className:"anime-stat-value",children:ve.byStatus.watching})]}),c.jsxs("div",{className:"anime-stat-card",children:[c.jsx("div",{className:"anime-stat-label",children:"Completed"}),c.jsx("div",{className:"anime-stat-value",children:ve.byStatus.completed})]}),c.jsxs("div",{className:"anime-stat-card",children:[c.jsx("div",{className:"anime-stat-label",children:"Plan to Watch"}),c.jsx("div",{className:"anime-stat-value",children:ve.byStatus.plan_to_watch})]}),c.jsxs("div",{className:"anime-stat-card",children:[c.jsx("div",{className:"anime-stat-label",children:"Avg. Score"}),c.jsx("div",{className:"anime-stat-value",children:ve.avgScore?ve.avgScore.toFixed(1):"0.0"})]}),c.jsxs("div",{className:"anime-stat-card",children:[c.jsx("div",{className:"anime-stat-label",children:"Days Watched"}),c.jsx("div",{className:"anime-stat-value",children:Me.toFixed(1)})]})]}),c.jsxs("section",{className:"anime-toolbar",children:[c.jsx("input",{type:"text",placeholder:"Search anime by title...",value:m,onChange:J=>v(J.target.value),className:"anime-input"}),c.jsxs("select",{value:w,onChange:J=>T(J.target.value),className:"anime-select",children:[c.jsx("option",{value:"all",children:"All statuses"}),c.jsx("option",{value:"watching",children:"Watching"}),c.jsx("option",{value:"completed",children:"Completed"}),c.jsx("option",{value:"on_hold",children:"On Hold"}),c.jsx("option",{value:"plan_to_watch",children:"Plan to Watch"}),c.jsx("option",{value:"dropped",children:"Dropped"})]})]}),I&&c.jsx("div",{className:"loading",children:"Loading anime list from MAL..."}),X&&c.jsx("div",{className:"error-state",children:X}),!I&&!X&&c.jsx(c.Fragment,{children:d.length===0?c.jsx("div",{className:"empty-state",children:"No results match your filters yet."}):c.jsx("section",{className:"anime-grid",children:d.map(J=>et(J))})})]}),se.length>0&&c.jsxs("aside",{className:"anime-updates-float",children:[c.jsxs("div",{className:"anime-updates-header",children:[c.jsx("h3",{children:"Recent Updates"}),c.jsx("span",{className:"anime-updates-caption",children:"Last list activity"})]}),c.jsx("div",{className:"anime-updates-list",children:se.map(J=>xt(J))})]}),te&&c.jsx(Fw,{open:F,title:"Suggest an Anime",placeholder:"Type an anime you'd like me to watch...",value:L,status:he,loading:ut,onChange:b,onSubmit:Ee,onClose:()=>z(!1)}),M&&c.jsx("div",{className:"modal-backdrop visible",onClick:J=>{J.target===J.currentTarget&&ne(null)},children:c.jsxs("div",{className:"anime-modal",children:[c.jsxs("div",{className:"anime-modal-header",children:[c.jsx("h2",{style:{color:"#ffb6c1",margin:0},children:M.title}),c.jsx("button",{className:"anime-modal-close",onClick:()=>ne(null),type:"button",children:"Close"})]}),c.jsxs("div",{className:"anime-modal-body",children:[c.jsx("div",{children:c.jsx("img",{className:"anime-modal-cover",src:M.image||"https://imgur.com/chUgq4W.png",alt:M.title})}),c.jsxs("div",{className:"anime-modal-meta",children:[c.jsxs("div",{children:[c.jsx("strong",{children:"Status:"})," ",s(M.status)]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Episodes:"})," ",M.episodes?M.episodes:"Unknown"]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Progress:"})," ",Number.isFinite(Number(M.watchedEpisodes))?`Episode ${M.watchedEpisodes}${Number.isFinite(Number(M.episodes))?`/${M.episodes}`:""}`:"Unknown"]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Score:"})," ",Number.isFinite(Number(M.score))&&Number(M.score)>0?M.score:"Not rated"]})]}),c.jsx(VR,{modalItem:M,modalLoading:we,modalSynopsisShown:Ie,onReveal:async()=>{if(!M)return;A(!0);const J=M.id;if(!J)return;const $e=be[J];if($e!==void 0){ne(Ve=>Ve&&{...Ve,synopsis:$e});return}le(!0);try{const Ve=await AR(J);_e(Ke=>({...Ke,[J]:Ve||""})),ne(Ke=>Ke&&{...Ke,synopsis:Ve||""})}catch{_e(Ke=>({...Ke,[J]:""})),ne(Ke=>Ke&&{...Ke,synopsis:""})}finally{le(!1)}}})]})]})})]})}function VR({modalItem:n,modalLoading:e,modalSynopsisShown:t,onReveal:s}){var m;const a=((m=n==null?void 0:n.synopsis)==null?void 0:m.trim())||"",[l,d]=k.useState(0),f=k.useRef(null);return k.useEffect(()=>{if(t&&f.current){const v=f.current.scrollHeight+12;d(v)}else d(0)},[t,a]),c.jsxs("div",{className:"anime-modal-summary",children:[c.jsxs("div",{className:"anime-modal-summary-header",children:[c.jsx("h3",{children:"Synopsis"}),!t&&c.jsx("button",{className:"anime-synopsis-btn",type:"button",onClick:s,children:e?"Loading...":"Reveal Synopsis"})]}),c.jsx("div",{className:`anime-modal-summary-body ${t?"is-open":""}`,style:{maxHeight:t?`${l}px`:0,opacity:t?1:0},children:c.jsx("div",{ref:f,children:c.jsx("p",{className:"anime-modal-summary-text",children:e&&!a?"Loading synopsis...":a||"No synopsis available."})})}),!t&&c.jsx("p",{className:"anime-modal-summary-text anime-modal-summary-hint",children:"Synopsis hidden. Click reveal to view."})]})}function LR(){const n={game:"pokemon",name:"",setName:"",number:"",rarity:"",condition:"",quantity:1,pricePaid:"",estimatedValue:"",image:"",productURL:"",notes:""},{admin:e,user:t}=Fo(),[s,a]=k.useState(()=>localStorage.getItem("tcgLastGame")||n.game),[l,d]=k.useState([]),[f,m]=k.useState(!0),[v,w]=k.useState(""),[T,I]=k.useState("all"),[B,X]=k.useState("name"),[K,M]=k.useState(!1),[ne,be]=k.useState([]),[_e,we]=k.useState(""),[le,Ie]=k.useState(null),[A,P]=k.useState(!1),[R,F]=k.useState(()=>({...n,game:s}));k.useEffect(()=>{document.title="TCG | Collection"},[]),k.useEffect(()=>{let N=!1;const se=async()=>{if(!N)try{const ve=await fetch("/base/tcg-collection.json",{cache:"no-cache"});if(!ve.ok)throw new Error("fallback fetch failed");const Me=await ve.json(),He=Array.isArray(Me.tcg)?Me.tcg:[];N||d(He.map((et,xt)=>({id:et.id||`offline-${xt}`,...et})))}catch(Ee){console.error("TCG offline fallback failed",Ee)}finally{N||m(!1)}};async function te(){m(!0);try{const Ee=Hn(it,"tcg"),ve=await ti(Ee),Me=[];ve.forEach(He=>Me.push({id:He.id,...He.data()})),N||d(Me)}catch(Ee){console.error("Error loading TCG:",Ee),await se()}finally{N||m(!1)}}return te(),()=>{N=!0}},[t]);const z=l.filter(N=>{if(T!=="all"&&N.game!==T)return!1;if(!v)return!0;const se=v.toLowerCase();return(N.name||"").toLowerCase().includes(se)||(N.setName||"").toLowerCase().includes(se)||(N.number||"").toLowerCase().includes(se)}),L=[...z].sort((N,se)=>{const te=(N.name||"").toLowerCase(),Ee=(se.name||"").toLowerCase(),ve=(N.setName||"").toLowerCase(),Me=(se.setName||"").toLowerCase(),He=(N.rarity||"").toLowerCase(),et=(se.rarity||"").toLowerCase(),xt=Number(N.quantity||0),J=Number(se.quantity||0),$e=Number(N.estimatedValue||0)*Math.max(1,xt),Ve=Number(se.estimatedValue||0)*Math.max(1,J);switch(B){case"set":return ve.localeCompare(Me)||te.localeCompare(Ee);case"rarity":return He.localeCompare(et)||te.localeCompare(Ee);case"quantity":return J-xt||te.localeCompare(Ee);case"value":return Ve-$e||te.localeCompare(Ee);case"name":default:return te.localeCompare(Ee)}}),b=l.reduce((N,se)=>{const te=Number(se.quantity||1),Ee=Number(se.pricePaid||0),ve=Number(se.estimatedValue||0);N.totalCards+=te,N.totalPaid+=te*Ee,N.totalValue+=te*ve;const Me=(se.game||"").toLowerCase(),He=te*ve;return Me==="pokemon"?(N.pokemon+=te,N.valueByGame.pokemon+=He):Me==="onepiece"?(N.onepiece+=te,N.valueByGame.onepiece+=He):Me==="mtg"?(N.mtg+=te,N.valueByGame.mtg+=He):N.valueByGame.other+=He,N},{totalCards:0,totalPaid:0,totalValue:0,pokemon:0,onepiece:0,mtg:0,valueByGame:{pokemon:0,onepiece:0,mtg:0,other:0}}),he=b.totalValue-b.totalPaid,xe=[["Pokemon",b.valueByGame.pokemon],["One Piece",b.valueByGame.onepiece],["MTG",b.valueByGame.mtg],["Other",b.valueByGame.other]].filter(([,N])=>N>0).map(([N,se])=>`${N}: $${se.toFixed(2)}`),ut=xe.length?xe.join(`
`):"No value data yet",Be=(N,se)=>{if(N==="game"){a(se);try{localStorage.setItem("tcgLastGame",se)}catch{}}F(te=>({...te,[N]:se}))},ye=async()=>{if(!e)return;if(!R.name.trim()){alert("Card name is required.");return}const N={game:R.game,name:R.name.trim(),setName:R.setName.trim(),number:R.number.trim(),rarity:R.rarity.trim(),condition:R.condition.trim(),quantity:Number(R.quantity||1),pricePaid:Number(R.pricePaid||0),estimatedValue:Number(R.estimatedValue||0),image:R.image.trim(),productURL:R.productURL.trim(),notes:R.notes.trim()},se=ve=>({game:(ve.game||"").toLowerCase().trim(),name:(ve.name||"").toLowerCase().trim(),setName:(ve.setName||"").toLowerCase().trim(),number:(ve.number||"").toLowerCase().trim(),rarity:(ve.rarity||"").toLowerCase().trim(),condition:(ve.condition||"").toLowerCase().trim(),pricePaid:Number(ve.pricePaid||0),estimatedValue:Number(ve.estimatedValue||0),image:(ve.image||"").trim(),productURL:(ve.productURL||"").trim(),notes:(ve.notes||"").trim()}),te=se(N),Ee=l.find(ve=>{const Me=se(ve);return Me.game===te.game&&Me.name===te.name&&Me.setName===te.setName&&Me.number===te.number&&Me.rarity===te.rarity&&Me.condition===te.condition&&Me.pricePaid===te.pricePaid&&Me.estimatedValue===te.estimatedValue&&Me.image===te.image&&Me.productURL===te.productURL&&Me.notes===te.notes});try{const ve=Hn(it,"tcg");if(Ee!=null&&Ee.id){const Me=Number(Ee.quantity||1)+N.quantity;await Ns(Dt(it,"tcg",Ee.id),{quantity:Me}),d(He=>He.map(et=>et.id===Ee.id?{...et,quantity:Me}:et))}else{await yo(ve,N);const Me=await ti(ve),He=[];Me.forEach(et=>He.push({id:et.id,...et.data()})),d(He)}F({...n,game:s}),P(!1)}catch(ve){console.error("Error adding card:",ve),alert("Failed to save card.")}},je=async()=>{if(!e||!le)return;if(!le.name.trim()){alert("Card name is required.");return}const N={game:le.game,name:le.name.trim(),setName:le.setName.trim(),number:le.number.trim(),rarity:le.rarity.trim(),condition:le.condition.trim(),quantity:Number(le.quantity||1),pricePaid:Number(le.pricePaid||0),estimatedValue:Number(le.estimatedValue||0),image:le.image?le.image.trim():"",productURL:le.productURL?le.productURL.trim():"",notes:le.notes?le.notes.trim():""};try{await Ns(Dt(it,"tcg",le.id),N),d(se=>se.map(te=>te.id===le.id?{...te,...N}:te)),Ie(null)}catch(se){console.error("Error updating card:",se),alert("Failed to update card.")}},Pe=async N=>{if(e&&window.confirm("Delete this card?"))try{await go(Dt(it,"tcg",N)),d(se=>se.filter(te=>te.id!==N))}catch(se){console.error("Delete error:",se),alert("Failed to delete card.")}},D=()=>{if(!l.length){alert("No cards to export.");return}const N=new Blob([JSON.stringify({tcg:l},null,2)],{type:"application/json"}),se=URL.createObjectURL(N),te=document.createElement("a");te.href=se,te.download="tcg-collection.json",te.click(),URL.revokeObjectURL(se)};return c.jsxs("main",{className:"page",children:[c.jsxs("header",{style:{marginTop:"32px",marginBottom:"16px",display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",gap:"6px"},children:[c.jsx("h1",{style:{margin:0,fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Tyler's TCG Collection"}),c.jsx("p",{style:{margin:"6px 0 0",color:"var(--text-soft)",fontSize:"0.9rem"},children:"Check out my TCG Collection with all the data of how much I spent (Under construction) and how much my collection is worth in total!"}),e&&c.jsx("div",{style:{marginTop:"10px"},children:c.jsx("button",{className:"manga-btn secondary",type:"button",onClick:D,children:"Export JSON"})})]}),e&&c.jsx("button",{className:"manga-btn",type:"button","aria-label":"Add card",onClick:()=>P(!0),style:{position:"fixed",bottom:"20px",right:"20px",zIndex:1e3,width:"56px",height:"56px",borderRadius:"50%",padding:0,fontSize:"28px",display:"flex",alignItems:"center",justifyContent:"center"},children:"+"}),e&&A&&c.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(8,1,10,0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,padding:"12px"},onClick:N=>{N.target===N.currentTarget&&P(!1)},children:c.jsxs("div",{style:{width:"min(720px, 95vw)",background:"#140710",border:"1px solid rgba(255,182,193,0.3)",borderRadius:"12px",padding:"14px",boxShadow:"0 24px 60px rgba(0,0,0,0.85)"},onClick:N=>N.stopPropagation(),children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[c.jsx("h2",{style:{margin:0,color:"#ffb6c1"},children:"Add card"}),c.jsx("button",{className:"dashboard-close",onClick:()=>P(!1),type:"button",children:"Close"})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"180px 1fr",gap:"12px",alignItems:"flex-start",marginTop:"10px"},children:[c.jsx("div",{style:{width:"100%",maxWidth:"180px",borderRadius:"10px",border:"1px solid rgba(255,182,193,0.25)",background:"#1e0d14",overflow:"hidden",aspectRatio:"3 / 4",display:"flex",alignItems:"center",justifyContent:"center"},children:R.image?c.jsx("img",{src:R.image,alt:"Card preview",style:{width:"100%",height:"100%",objectFit:"cover"}}):c.jsx("div",{style:{color:"var(--text-soft)",fontSize:"0.8rem",padding:"6px"},children:"No image"})}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:"8px"},children:[c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Game",c.jsxs("select",{value:R.game,onChange:N=>Be("game",N.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"},children:[c.jsx("option",{value:"pokemon",children:"Pokemon"}),c.jsx("option",{value:"onepiece",children:"One Piece"}),c.jsx("option",{value:"mtg",children:"MTG"})]})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Card name",c.jsx("input",{type:"text",value:R.name,onChange:N=>Be("name",N.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Set name",c.jsx("input",{type:"text",value:R.setName,onChange:N=>Be("setName",N.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Card number",c.jsx("input",{type:"text",value:R.number,onChange:N=>Be("number",N.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Rarity",c.jsx("input",{type:"text",value:R.rarity,onChange:N=>Be("rarity",N.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Condition",c.jsx("input",{type:"text",value:R.condition,onChange:N=>Be("condition",N.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Quantity",c.jsx("input",{type:"number",min:"1",value:R.quantity,onChange:N=>Be("quantity",N.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Price paid (per card)",c.jsx("input",{type:"number",step:"0.01",min:"0",value:R.pricePaid,onChange:N=>Be("pricePaid",N.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Estimated value (per card)",c.jsx("input",{type:"number",step:"0.01",min:"0",value:R.estimatedValue,onChange:N=>Be("estimatedValue",N.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Image URL",c.jsx("input",{type:"text",value:R.image||"",onChange:N=>Be("image",N.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Product URL (backend only)",c.jsx("input",{type:"text",value:R.productURL||"",onChange:N=>Be("productURL",N.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{gridColumn:"1 / -1",fontSize:"0.8rem",color:"var(--text-soft)"},children:["Notes",c.jsx("textarea",{value:R.notes,onChange:N=>Be("notes",N.target.value),rows:3,style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff",resize:"vertical"}})]})]})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"12px"},children:[c.jsx("button",{onClick:()=>{F(n),P(!1)},style:{padding:"6px 12px",borderRadius:"999px",border:"1px solid rgba(255,182,193,0.5)",background:"transparent",color:"#ffb6c1",cursor:"pointer"},children:"Cancel"}),c.jsx("button",{onClick:ye,style:{padding:"6px 12px",borderRadius:"999px",border:"none",cursor:"pointer",fontWeight:600,background:"#ff69b4",color:"#1e0d14"},children:"Save card"})]})]})}),e&&le&&c.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(8,1,10,0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,padding:"12px"},onClick:N=>{N.target===N.currentTarget&&Ie(null)},children:c.jsxs("div",{style:{width:"min(720px, 95vw)",background:"#140710",border:"1px solid rgba(255,182,193,0.3)",borderRadius:"12px",padding:"14px",boxShadow:"0 24px 60px rgba(0,0,0,0.85)"},onClick:N=>N.stopPropagation(),children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[c.jsx("h2",{style:{margin:0,color:"#ffb6c1"},children:"Edit card"}),c.jsx("button",{className:"dashboard-close",onClick:()=>Ie(null),type:"button",children:"Close"})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"180px 1fr",gap:"12px",alignItems:"flex-start",marginTop:"10px"},children:[c.jsx("div",{style:{width:"100%",maxWidth:"180px",borderRadius:"10px",border:"1px solid rgba(255,182,193,0.25)",background:"#1e0d14",overflow:"hidden",aspectRatio:"3 / 4",display:"flex",alignItems:"center",justifyContent:"center"},children:le.image?c.jsx("img",{src:le.image,alt:"Card preview",style:{width:"100%",height:"100%",objectFit:"cover"}}):c.jsx("div",{style:{color:"var(--text-soft)",fontSize:"0.8rem",padding:"6px"},children:"No image"})}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:"8px"},children:[c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Game",c.jsxs("select",{value:le.game,onChange:N=>Ie(se=>({...se,game:N.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"},children:[c.jsx("option",{value:"pokemon",children:"Pokemon"}),c.jsx("option",{value:"onepiece",children:"One Piece"}),c.jsx("option",{value:"mtg",children:"MTG"})]})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Card name",c.jsx("input",{type:"text",value:le.name,onChange:N=>Ie(se=>({...se,name:N.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Set name",c.jsx("input",{type:"text",value:le.setName,onChange:N=>Ie(se=>({...se,setName:N.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Card number",c.jsx("input",{type:"text",value:le.number,onChange:N=>Ie(se=>({...se,number:N.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Rarity",c.jsx("input",{type:"text",value:le.rarity,onChange:N=>Ie(se=>({...se,rarity:N.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Condition",c.jsx("input",{type:"text",value:le.condition,onChange:N=>Ie(se=>({...se,condition:N.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Quantity",c.jsx("input",{type:"number",value:le.quantity,onChange:N=>Ie(se=>({...se,quantity:N.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Price paid (each)",c.jsx("input",{type:"number",value:le.pricePaid,onChange:N=>Ie(se=>({...se,pricePaid:N.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Estimated value (each)",c.jsx("input",{type:"number",value:le.estimatedValue,onChange:N=>Ie(se=>({...se,estimatedValue:N.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Image URL",c.jsx("input",{type:"text",value:le.image||"",onChange:N=>Ie(se=>({...se,image:N.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Product URL (backend only)",c.jsx("input",{type:"text",value:le.productURL||"",onChange:N=>Ie(se=>({...se,productURL:N.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{gridColumn:"1 / -1",fontSize:"0.8rem",color:"var(--text-soft)"},children:["Notes",c.jsx("textarea",{value:le.notes||"",onChange:N=>Ie(se=>({...se,notes:N.target.value})),rows:3,style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff",resize:"vertical"}})]})]})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"12px"},children:[c.jsx("button",{onClick:()=>Ie(null),style:{padding:"6px 12px",borderRadius:"999px",border:"1px solid rgba(255,182,193,0.5)",background:"transparent",color:"#ffb6c1",cursor:"pointer"},children:"Cancel"}),c.jsx("button",{onClick:je,style:{padding:"6px 12px",borderRadius:"999px",border:"none",cursor:"pointer",fontWeight:600,background:"#ff69b4",color:"#1e0d14"},children:"Save changes"})]})]})}),c.jsxs("section",{style:{display:"flex",flexWrap:"wrap",gap:"12px",marginTop:"18px",justifyContent:"center"},children:[c.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[c.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Total cards"}),c.jsx("div",{style:{fontSize:"1.1rem",fontWeight:700},children:b.totalCards})]}),b.totalPaid>0&&c.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[c.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Total paid"}),c.jsxs("div",{style:{fontSize:"1.1rem",fontWeight:700},children:["$",b.totalPaid.toFixed(2)]})]}),c.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},title:ut,children:[c.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Total value"}),c.jsxs("div",{style:{fontSize:"1.1rem",fontWeight:700},children:["$",b.totalValue.toFixed(2)]})]}),c.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[c.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Unrealized gain / loss"}),c.jsxs("div",{style:{fontSize:"1.1rem",fontWeight:700,color:he>=0?"#00e676":"#ff8a80"},children:[he>=0?"+":"-","$",Math.abs(he).toFixed(2)]})]}),c.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[c.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Pokemon cards"}),c.jsx("div",{style:{fontSize:"1.1rem",fontWeight:700},children:b.pokemon})]}),c.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[c.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"One Piece cards"}),c.jsx("div",{style:{fontSize:"1.1rem",fontWeight:700},children:b.onepiece})]}),c.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[c.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"MTG cards"}),c.jsx("div",{style:{fontSize:"1.1rem",fontWeight:700},children:b.mtg})]})]}),c.jsxs("section",{style:{display:"flex",flexWrap:"wrap",gap:"10px",marginTop:"16px"},children:[c.jsx("input",{type:"text",placeholder:"Search by name, set, or number...",value:v,onChange:N=>w(N.target.value),style:{flex:"1 1 220px",minWidth:"220px",padding:"8px 12px",borderRadius:"999px",border:"1px solid #bb7f8f",background:"#2b0f1d",color:"#fff"}}),c.jsxs("select",{value:T,onChange:N=>I(N.target.value),style:{flex:"0 0 220px",padding:"8px 12px",borderRadius:"999px",border:"1px solid #bb7f8f",background:"#2b0f1d",color:"#fff"},children:[c.jsx("option",{value:"all",children:"All games"}),c.jsx("option",{value:"pokemon",children:"Pokemon only"}),c.jsx("option",{value:"onepiece",children:"One Piece only"}),c.jsx("option",{value:"mtg",children:"MTG only"})]}),c.jsxs("select",{value:B,onChange:N=>X(N.target.value),style:{flex:"0 0 220px",padding:"8px 12px",borderRadius:"999px",border:"1px solid #bb7f8f",background:"#2b0f1d",color:"#fff"},children:[c.jsx("option",{value:"name",children:"Sort: Name (A-Z)"}),c.jsx("option",{value:"set",children:"Sort: Set (A-Z)"}),c.jsx("option",{value:"rarity",children:"Sort: Rarity (A-Z)"}),c.jsx("option",{value:"quantity",children:"Sort: Quantity (high to low)"}),c.jsx("option",{value:"value",children:"Sort: Value (high to low)"})]})]}),f?c.jsx("p",{style:{marginTop:"20px",color:"var(--text-soft)"},children:"Loading TCG collection..."}):z.length===0?c.jsx("p",{style:{marginTop:"20px",color:"var(--text-soft)"},children:"No cards found."}):c.jsx("section",{className:"grid",style:{gridTemplateColumns:"repeat(auto-fill, minmax(170px, 1fr))",marginTop:"20px"},children:L.map(N=>{const se=Number(N.quantity||1),te=se*Number(N.pricePaid||0),Ee=se*Number(N.estimatedValue||0);return c.jsxs("article",{style:{background:"#2b0f1d",borderRadius:"12px",border:"1px solid rgba(255,182,193,0.25)",boxShadow:"0 4px 16px rgba(0,0,0,0.55)",padding:"10px",fontSize:"0.82rem",display:"flex",flexDirection:"column",gap:"6px"},children:[N.image&&c.jsx("div",{style:{width:"100%",paddingTop:"140%",position:"relative",overflow:"hidden",borderRadius:"10px",background:"#1e0d14"},children:c.jsx("img",{src:N.image,alt:N.name||"card image",style:{position:"absolute",inset:0,width:"100%",height:"100%",objectFit:"contain"}})}),c.jsx("div",{style:{fontWeight:700,color:"#ffb6c1",marginBottom:"4px"},children:N.name||"Unnamed card"}),c.jsx("div",{style:{color:"var(--text-soft)",marginBottom:"4px"},children:N.setName||""}),c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",color:"var(--text-soft)"},children:[c.jsxs("span",{children:["#",N.number||"-"]}),c.jsx("span",{children:N.rarity||""})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",color:"var(--text-soft)",marginTop:"4px"},children:[c.jsxs("span",{children:["Cond: ",N.condition||"N/A"]}),c.jsxs("span",{children:["Qty: ",se]})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",color:"var(--text-soft)",marginTop:"4px"},children:[c.jsxs("span",{children:["Paid: $",te.toFixed(2)]}),c.jsxs("span",{children:["Value: $",Ee.toFixed(2)]})]}),N.notes&&c.jsxs("div",{style:{color:"#9c8fa6",fontSize:"0.72rem",fontStyle:"italic",textAlign:"center",marginTop:"6px"},children:['"',N.notes,'"']}),c.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"8px"},children:[c.jsx("span",{style:{padding:"2px 7px",borderRadius:"999px",background:"rgba(255,105,180,0.18)",border:"1px solid rgba(255,105,180,0.5)",color:"#ffb6c1",fontSize:"0.7rem",whiteSpace:"nowrap"},children:{pokemon:"Pokemon",onepiece:"One Piece",mtg:"MTG"}[N.game]||"Other"}),e&&c.jsxs("div",{style:{display:"flex",gap:"6px",alignItems:"center",marginLeft:"auto"},children:[c.jsx("button",{onClick:()=>Ie({...N,pricePaid:N.pricePaid??"",estimatedValue:N.estimatedValue??"",quantity:N.quantity??1}),style:{padding:"3px 8px",borderRadius:"999px",border:"1px solid rgba(255,182,193,0.5)",background:"rgba(255,105,180,0.15)",color:"#ffb6c1",fontSize:"0.7rem",cursor:"pointer"},children:"Edit"}),c.jsx("button",{onClick:()=>Pe(N.id),style:{padding:"3px 8px",borderRadius:"999px",border:"1px solid rgba(244,67,54,0.7)",background:"rgba(244,67,54,0.12)",color:"#ff8a80",fontSize:"0.7rem",cursor:"pointer"},children:"Delete"})]})]})]},N.id)})})]})}const gl="https://discord.com/api/webhooks/1448287168845054004/cGWGPoH5LaTFlBZ1vxtgMjOfV9au6qyQ_9ZRnOWN9-AX0MNfwxKNWVcZYQHz0ESA7_4k",yl="https://discord.com/api/webhooks/1448288240871276616/101WI-B2p8tDR34Hl9fZxxb0QG01f1Eo5w1IvbttlQmP2wWFNJ0OI7UnJfJujKRNWW2Q",vl="https://discord.com/api/webhooks/1448329790942613667/wsC8psNZ-Ax2D1O9Gl4sJi6ay7df2cr7IrIdxMPwGZTBnkSUIY2NDpeVd98qW_4plz82",Qv="mangaLibraryActivityLog";function sc(n){const e=n==null?"":String(n);return e.trim()?e.replace(/\s*,?\s*(?:vol(?:ume)?\.?)\s+\d+.*$/i,"").trim():""}function Ji(n){if(!n)return null;if(n instanceof Date)return n;if(n&&typeof n.toDate=="function")return n.toDate();const e=String(n).trim();if(!e)return null;const t=e.match(/^(\d{4})-(\d{2})-(\d{2})$/);if(t){const[,l,d,f]=t;return new Date(Number(l),Number(d)-1,Number(f))}const s=e.match(/^(\d{1,2})\/(\d{1,2})\/(\d{2,4})$/);if(s){let[,l,d,f]=s;const m=f.length===2?+`20${f}`:Number(f);return new Date(m,Number(l)-1,Number(d))}const a=new Date(e);return isNaN(a.getTime())?null:a}function yd(n){const e=n.seriesKey||n.series||n.Series||n.title||n.Title||"",s=(sc(e)||e).trim();return s?s.toLowerCase():""}function OR(n){const e=(n==null?void 0:n.series)||(n==null?void 0:n.Series)||(n==null?void 0:n.title)||(n==null?void 0:n.Title)||"Unknown Series";return sc(e)||"Unknown Series"}function Yv(n){const e=(n||"").trim(),t=e.match(/^(.*?)(?:,?\s*(?:vol\.|volume)\s*(\d+)(?:\s*[-]\s*\d+)?\s*)?(?:\s*\([^)]*\))?$/i),s=t?t[1].trim().toLowerCase():e.toLowerCase(),a=t&&t[2]?parseInt(t[2],10):0;return{name:s,vol:Number.isFinite(a)?a:0}}function MR(n,e){const t=(n==null?void 0:n.Title)||(n==null?void 0:n.title)||"",s=(e==null?void 0:e.Title)||(e==null?void 0:e.title)||"",a=Yv(t),l=Yv(s),d=a.name.localeCompare(l.name);return d!==0?d:a.vol!==l.vol?a.vol-l.vol:t.localeCompare(s)}function rf(){return{publisher:"",demographic:"",genre:"",subGenre:"",datePurchased:"",msrp:"",initialPublisher:"",initialDemographic:"",initialGenre:"",initialSubGenre:"",initialDatePurchased:"",initialMsrp:"",dateMixed:!1,readChecked:!1,readIndeterminate:!1}}function Jv(){return{read:!1,datePurchased:"",dateRead:"",pageCount:"",msrp:"",amountPaid:"",rating:"",special:!1,specialType:"",specialVolumes:"",collectiblePrice:""}}function Xv(n,e={}){const t=e.ignoreShared,s=(n==null?void 0:n.amountPaid)??(n==null?void 0:n.AmountPaid)??(n==null?void 0:n.paid)??(n==null?void 0:n.Paid)??"",a=(n==null?void 0:n.msrp)??(n==null?void 0:n.MSRP)??"",l=((n==null?void 0:n.datePurchased)||(n==null?void 0:n.DatePurchased)||"").trim(),d=((n==null?void 0:n.publisher)||(n==null?void 0:n.Publisher)||"").trim(),f=((n==null?void 0:n.demographic)||(n==null?void 0:n.Demographic)||"").trim(),m=((n==null?void 0:n.genre)||(n==null?void 0:n.Genre)||"").trim(),v=((n==null?void 0:n.specialType)||(n==null?void 0:n.SpecialType)||"").trim(),w=(n==null?void 0:n.specialVolumes)??(n==null?void 0:n.SpecialVolumes)??(n==null?void 0:n.volumesContained)??"",T=(n==null?void 0:n.collectiblePrice)??(n==null?void 0:n.CollectiblePrice)??"",I=!!v,B=(n==null?void 0:n.pageCount)??(n==null?void 0:n.PageCount)??(n==null?void 0:n.pages)??(n==null?void 0:n.Pages)??"",X=B==null?"":String(B).trim(),K=Number(X),M=!X||Number.isNaN(K)||K<=0;return!I&&(s===""||s===null)||M||!l||!t&&(a===""||!d||!f||!m)||I&&!v||I&&v.toLowerCase()==="collectible"&&(T===""||T===null)||I&&v.toLowerCase()==="specialedition"&&(w===""||w===null)}function FR(n){const e=(n==null?void 0:n.amountPaid)??"",t=((n==null?void 0:n.datePurchased)||"").trim(),s=!!(n!=null&&n.specialType)||!!(n!=null&&n.special),a=((n==null?void 0:n.specialType)||"").trim(),l=(n==null?void 0:n.specialVolumes)??"",d=(n==null?void 0:n.collectiblePrice)??"",f=(n==null?void 0:n.pageCount)??"",m=(n==null?void 0:n.msrp)??"",v=((n==null?void 0:n.publisher)||"").trim(),w=((n==null?void 0:n.demographic)||"").trim(),T=((n==null?void 0:n.genre)||"").trim(),I=!s&&(e===""||e===null),B=s&&!a,X=s&&a.toLowerCase()==="collectible"&&(d===""||d===null),K=s&&a.toLowerCase()==="specialedition"&&(l===""||l===null),M=(()=>{const ne=(f??"").toString().trim();if(ne==="")return!0;const be=Number(ne);return Number.isNaN(be)||be<=0})();return{amountPaid:I,datePurchased:!t,specialType:B,collectiblePrice:X,specialVolumes:K,pageCount:M,msrp:m===""||m===null,publisher:!v,demographic:!w,genre:!T}}function UR(n){return!n||!n.books||!n.books.length?!1:n.books.some(e=>{const t=(e==null?void 0:e.msrp)??(e==null?void 0:e.MSRP)??"",s=((e==null?void 0:e.publisher)||(e==null?void 0:e.Publisher)||"").trim(),a=((e==null?void 0:e.demographic)||(e==null?void 0:e.Demographic)||"").trim(),l=((e==null?void 0:e.genre)||(e==null?void 0:e.Genre)||"").trim();return t===""||!s||!a||!l})}function zR(n){const e=new Map;for(const t of n){const s=yd(t)||t.id;if(!e.has(s)){const m=sc(t.series||t.Series||t.title||t.Title||"Unknown Series")||"Unknown Series";e.set(s,{key:s,title:m,publisher:t.publisher||t.Publisher||"",genre:t.genre||t.Genre||"",demographic:t.demographic||t.Demographic||"",volumes:0,totalPages:0,readPages:0,readVolumes:0,ratingSum:0,ratingCount:0})}const a=e.get(s);a.volumes+=1;const l=Number(t.pages||t.Pages||t.pageCount||0)||0;a.totalPages+=l,(!!t.read||t.status==="Read"||t.Read===!0)&&(a.readVolumes+=1,a.readPages+=l);const f=Number(t.rating||t.Rating);!isNaN(f)&&f>0&&(a.ratingSum+=f,a.ratingCount+=1)}return e}function uo(n,e,t=5){const s=new Map;for(const a of n.values()){const l=(a[e]||"").trim();if(!l)continue;const d=l.split(/[\/,]/).map(f=>f.trim()).filter(Boolean);for(const f of d)s.set(f,(s.get(f)||0)+1)}return[...s.entries()].sort((a,l)=>l[1]-a[1]).slice(0,t).map(([a,l])=>({name:a,count:l}))}function Zv(n,e){const t=Array.from({length:12},(s,a)=>{const l=new Date(e,a,1);return{key:`${e}-${a}`,label:l.toLocaleString("default",{month:"short"}),year:e,month:a,value:0}});for(const s of n){const a=Ji(s.dateRead||s.DateRead);!a||a.getFullYear()!==e||(t[a.getMonth()].value+=1)}return t}function Ea(n){const e=n.getFullYear(),t=`${n.getMonth()+1}`.padStart(2,"0"),s=`${n.getDate()}`.padStart(2,"0");return`${e}-${t}-${s}`}async function sf(n,e){try{await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:e})})}catch(t){console.error("Webhook post failed",t)}}function BR(n){const e=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],t=Array(7).fill(0);for(const l of n){const d=Ji(l.dateRead||l.DateRead);d&&(t[d.getDay()]+=1)}if(!t.some(l=>l>0))return[];const a=t.reduce((l,d)=>Math.max(l,d),0)||1;return e.map((l,d)=>({label:l,value:t[d],pct:t[d]/a}))}function $R(n,e=8){const t=[...n.values()];t.sort((l,d)=>d.volumes-l.volumes);const s=t.slice(0,e),a=s.reduce((l,d)=>Math.max(l,d.volumes),0)||1;return s.map(l=>({label:l.title,value:l.volumes,pct:l.volumes/a}))}function WR(n,e){const t=(a,l)=>{const d=Ji(a.releaseDate||a.ReleaseDate||a.date||a.Date);if(!d)return null;const f=(a.title||a.series||a.Title||"Unknown Title").trim(),m=!!(a.datePurchased||a.DatePurchased||"").trim();return{date:d,title:f,purchased:m,source:l}},s=[];return(e||[]).forEach(a=>{const l=t(a,"wishlist");l&&s.push(l)}),(n||[]).forEach(a=>{const l=t(a,"library");l&&s.push(l)}),s.sort((a,l)=>a.date-l.date),s}function GR(n){const e=new Date;for(const t of n)if(t.date>=e)return t;return n[n.length-1]||null}function HR(n){let e=0,t=0;for(const s of n){const a=Ji(s.datePurchased||s.DatePurchased),l=Ji(s.dateRead||s.DateRead);if(!a||!l)continue;const d=l-a;d<=0||(e+=d/(1e3*60*60*24),t+=1)}return t?e/t:null}function qR(n){const e=new Map;for(const t of n){const s=Ji(t.datePurchased||t.DatePurchased),a=Ji(t.dateRead||t.DateRead);if(!s||!a)continue;const l=a-s;if(l<=0)continue;const d=l/(1e3*60*60*24),f=yd(t)||t.id,m=sc(t.series||t.Series||t.title||t.Title||"Untitled")||"Untitled";e.has(f)||e.set(f,{key:f,title:m,total:0,count:0,min:d,max:d});const v=e.get(f);v.total+=d,v.count+=1,v.min=Math.min(v.min,d),v.max=Math.max(v.max,d)}return[...e.values()].filter(t=>t.count>0).map(t=>({...t,avg:t.total/t.count})).sort((t,s)=>s.avg-t.avg)}function KR(n){let e=0,t=0,s=0;for(const a of n){const l=Number(a.msrp||a.MSRP||0)||0,d=Number(a.amountPaid||a.AmountPaid||a.pricePaid||0)||l||0,f=Number(a.collectiblePrice||a.CollectiblePrice||0)||0;e+=l,t+=d,s+=f}return{msrpTotal:e,paidTotal:t,collectibleTotal:s}}function QR(n){const e=new Map;for(const t of n){const s=yd(t)||t.id;if(!e.has(s)){const T=t.series||t.Series||t.title||t.Title||"Untitled";e.set(s,{key:s,title:sc(T)||T.trim()||"Untitled",msrp:0,paid:0,collectible:0,books:0,pages:0,readPages:0,ratings:[]})}const a=e.get(s);a.books+=1;const l=Number(t.msrp||t.MSRP||0)||0,d=Number(t.amountPaid||t.AmountPaid||t.pricePaid||0)||0,f=Number(t.collectiblePrice||t.CollectiblePrice||0)||0,m=Number(t.pages||t.Pages||t.pageCount||0)||0,v=!!t.read||t.status==="Read"||t.Read===!0;a.msrp+=l,a.paid+=d,a.collectible+=f,a.pages+=m,v&&(a.readPages+=m);const w=Number(t.rating||t.Rating);!isNaN(w)&&w>0&&a.ratings.push(w)}return[...e.values()]}function YR(n){let e=0,t=0;for(const s of n){const a=Number(s.pages||s.Pages||s.pageCount||0)||0;e+=a,(!!s.read||s.status==="Read"||s.Read===!0)&&(t+=a)}return{total:e,read:t}}function JR(n){let e=0,t=0;for(const s of n.values())s.ratingCount>0&&(e+=s.ratingSum/s.ratingCount,t+=1);return t?e/t:null}function XR({data:n}){if(!n||!n.length)return c.jsx("div",{className:"line-chart empty",children:"No reading data yet."});const e=n.reduce((v,w)=>Math.max(v,w.value),0)||1,t=480,s=230,a=30,l=s-a*2,d=t/Math.max(n.length-1,1),f=n.map((v,w)=>{const T=w*d,I=s-a-v.value/e*l;return{...v,x:T,y:I}}),m=f.map((v,w)=>w===0?`M ${v.x} ${v.y}`:`L ${v.x} ${v.y}`).join(" ");return c.jsx("div",{className:"line-chart",children:c.jsxs("svg",{viewBox:`0 0 ${t} ${s}`,width:"100%",height:"100%",preserveAspectRatio:"xMidYMid meet",children:[[0,.25,.5,.75,1].map((v,w)=>{const T=s-a-v*l;return c.jsx("line",{className:"line-grid",x1:"0",x2:t,y1:T,y2:T},`h-${w}`)}),f.map((v,w)=>c.jsx("line",{className:"line-grid",x1:v.x,x2:v.x,y1:a/2,y2:s-a/2},`v-${w}`)),c.jsx("path",{className:"line-path",d:m}),f.map((v,w)=>c.jsxs("g",{children:[c.jsx("circle",{className:"line-point",cx:v.x,cy:v.y,r:"1.5"}),c.jsx("text",{className:"line-value",x:v.x,y:v.y-3,children:v.value}),c.jsx("text",{className:"line-label",x:v.x,y:s-4,children:v.label})]},w))]})})}function ZR({data:n}){return!n||!n.length?c.jsx("div",{className:"weekday-breakdown empty",children:"No reads recorded yet."}):c.jsx("div",{className:"weekday-bars",children:n.map(e=>c.jsxs("div",{className:"weekday-col",children:[c.jsx("div",{className:"weekday-count",children:e.value}),c.jsx("div",{className:"weekday-bar-vert",children:c.jsx("div",{className:"weekday-bar-vert-fill",style:{height:`${Math.max(e.pct*100,e.value?6:0)}%`}})}),c.jsx("div",{className:"weekday-label",children:e.label})]},e.label))})}function eN(n,e,t){const s=n.getFullYear(),a=n.getMonth(),d=new Date(s,a,1).getDay(),f=new Date(s,a+1,0).getDate(),m=new Map;for(const T of e){const I=T.date;if(I.getFullYear()===s&&I.getMonth()===a){const B=I.getDate();m.has(B)||m.set(B,[]),m.get(B).push(T)}}const v=[];for(let T=0;T<d;T++)v.push({type:"pad"});for(let T=1;T<=f;T++){const I=Ea(new Date(s,a,T));v.push({type:"day",day:T,releases:m.get(T)||[],dateKey:I,isToday:I===t})}const w=Math.ceil(v.length/7)*7;for(;v.length<w;)v.push({type:"pad"});return v}function tN(){const{user:n,admin:e,loading:t}=Fo(),[s,a]=k.useState([]),[l,d]=k.useState([]),[f,m]=k.useState(!0),[v,w]=k.useState(null),[T,I]=k.useState("-"),[B,X]=k.useState({yearly:gl,release:yl,activity:vl}),[K,M]=k.useState(new Set),[ne,be]=k.useState(null),[_e,we]=k.useState(null),[le,Ie]=k.useState(new Set),[A,P]=k.useState(null),[R,F]=k.useState(""),z=k.useRef(null),[L,b]=k.useState(()=>rf()),[he,xe]=k.useState(()=>Jv()),[ut,Be]=k.useState([]),[ye,je]=k.useState(!1),[Pe,D]=k.useState([]),[N,se]=k.useState(!1),[te,Ee]=k.useState([]),[ve,Me]=k.useState(!1),[He,et]=k.useState(""),[xt,J]=k.useState(null),[$e,Ve]=k.useState(null),Ke=async()=>{if(e)try{se(!0);const O=(await ti(Hn(it,"users"))).docs.map($=>({uid:$.id,...$.data()}));D(O)}catch(S){console.error("Failed to load users",S)}finally{se(!1)}},Et=async(S,O)=>{const $=(S||"").trim();if(!$){alert("UID is required.");return}try{await si(Dt(it,"users",$),{role:O,updatedBy:(n==null?void 0:n.uid)||"manual",updatedAt:new Date().toISOString()},{merge:!0}),await Ke()}catch(ce){console.error("Failed to update role",ce),alert("Failed to update role.")}},[Tt,_t]=k.useState(!1),[St,$t]=k.useState(()=>new Date),[cn,Cn]=k.useState(!1),[Qn,Yn]=k.useState(()=>{const S=new Date;return{year:S.getFullYear(),month:S.getMonth()}}),[un,Jn]=k.useState(null),[ft,Pt]=k.useState({open:!1,type:null}),Jt=new Date().getFullYear(),ar=k.useRef(null),or=k.useRef(null);k.useEffect(()=>{document.title="Dashboard"},[]),k.useEffect(()=>(Tt||ft.open||ye||!!$e||cn||!!un?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[Tt,ft.open,ye,$e]),k.useEffect(()=>{typeof window>"u"||(ar.current=localStorage.getItem("dashboard-yearly-posted"),or.current=localStorage.getItem("dashboard-release-posted"))},[]),k.useEffect(()=>{if(!e)return;const S=Dt(it,"settings","webhooks");(async()=>{try{const O=await Mp(S);if(O.exists()){const $=O.data();X({yearly:$.yearly||gl,release:$.release||yl,activity:$.activity||vl})}else await si(S,{yearly:gl,release:yl,activity:vl}),X({yearly:gl,release:yl,activity:vl})}catch(O){console.error("Failed to load webhook settings",O)}})()},[e]),k.useEffect(()=>{if(!e)return;let S=!1;return(async()=>await Ke())(),()=>{S=!0}},[e]),k.useEffect(()=>{let S=!1;if(!n||!e){Ee([]),et("");return}return(async()=>{try{Me(!0);const $=(await ti(Hn(it,"suggestions"))).docs.map(ce=>{var Ae;const me=ce.data();let Te=null;if((Ae=me==null?void 0:me.createdAt)!=null&&Ae.toDate)Te=me.createdAt.toDate();else if(me!=null&&me.createdAt){const Le=new Date(me.createdAt);Te=isNaN(Le.getTime())?null:Le}return{id:ce.id,...me,createdAt:Te}});$.sort((ce,me)=>{var Te,Ae,Le,ot;return(((Ae=(Te=me.createdAt)==null?void 0:Te.getTime)==null?void 0:Ae.call(Te))||0)-(((ot=(Le=ce.createdAt)==null?void 0:Le.getTime)==null?void 0:ot.call(Le))||0)}),S||(Ee($),et(""))}catch(O){console.error("Failed to load suggestions",O),S||(et("Failed to load suggestions."),Ee([]))}finally{S||Me(!1)}})(),()=>{S=!0}},[n,e]);const Vr=async S=>{if(!(!e||!S))try{await go(Dt(it,"suggestions",S)),Ee(O=>O.filter($=>$.id!==S))}catch(O){console.error("Failed to delete suggestion",O),et("Failed to delete suggestion.")}};k.useEffect(()=>{let S=!1;async function O(){if(!n||!e){a([]),d([]),w(null),m(!1);return}try{m(!0);const[$,ce]=await Promise.all([ti(Hn(it,"library")),ti(Hn(it,"wishlist"))]);if(S)return;a($.docs.map(me=>({id:me.id,...me.data()}))),d(ce.docs.map(me=>({id:me.id,...me.data()}))),w(null)}catch($){console.error($),S||w("Failed to load dashboard data.")}finally{S||m(!1)}}return O(),()=>{S=!0}},[n,e]);const lr=k.useMemo(()=>{const S=s.length,O=s.filter(Bs=>!!Bs.read||Bs.status==="Read"||Bs.Read===!0).length,$=S-O,ce=S?Math.round(O/S*100):0,me=l.length,Te=zR(s),Ae=Zv(s,Jt),Le=Zv(s,Jt-1),ot=Ae.reduce((Bs,ja)=>Bs+ja.value,0),Rt=BR(s),Vt=$R(Te),Ut=WR(s,l),tr=GR(Ut),rn=HR(s),mt=KR(s),An=YR(s),It=JR(Te),dn=qR(s),nr=uo(Te,"publisher",5),xs=uo(Te,"genre",5),dr=uo(Te,"demographic",5),Fr=QR(s);return{totalLibrary:S,readCount:O,unreadCount:$,readPct:ce,wishlistCount:me,seriesMap:Te,monthlyReads:Ae,prevYearReads:Le,currentYearReadsTotal:ot,weekdayBreakdown:Rt,topSeriesBars:Vt,releases:Ut,nextRelease:tr,avgDays:rn,purchaseToReadSeries:dn,collectionValue:mt,pages:An,avgRating:It,topPublishers:nr,topGenres:xs,topDemographics:dr,seriesAggregates:Fr}},[s,l,Jt]),{totalLibrary:yn,readCount:Fs,unreadCount:ms,readPct:Ct,wishlistCount:Lr,seriesMap:cr,monthlyReads:gs,prevYearReads:ur,currentYearReadsTotal:In,weekdayBreakdown:Xn,topSeriesBars:Sr,releases:Wt,nextRelease:Zn,avgDays:er,purchaseToReadSeries:ys,collectionValue:ct,pages:vn,avgRating:At,topPublishers:Jr,topGenres:bn,topDemographics:Or,seriesAggregates:Cr}=lr,Pn=Zn?Zn.date:null,Rn=!!v,Nn=k.useMemo(()=>{const S=new Map;return[...s,...l].forEach($=>{const ce=Ji($.datePurchased||$.DatePurchased);if(!ce)return;const me=Ea(ce);S.has(me)||S.set(me,[]),S.get(me).push({id:$.id||$.Title||$.title||me,title:$.title||$.Title||"Untitled"})}),S.forEach($=>$.sort((ce,me)=>(ce.title||"").localeCompare(me.title||""))),S},[s,l]),vs=k.useMemo(()=>{const{year:S,month:O}=Qn,ce=new Date(S,O,1).getDay(),me=new Date(S,O+1,0).getDate();let Te=!1;const Ae=[];for(let ot=0;ot<ce;ot+=1)Ae.push({type:"pad"});for(let ot=1;ot<=me;ot+=1){const Rt=new Date(S,O,ot),Vt=Ea(Rt),Ut=Nn.get(Vt)||[];Ut.length&&(Te=!0),Ae.push({type:"day",day:ot,dateKey:Vt,items:Ut})}const Le=Math.ceil(Ae.length/7)*7;for(;Ae.length<Le;)Ae.push({type:"pad"});return{cells:Ae,hasItems:Te}},[Qn,Nn]),Gt=k.useMemo(()=>{if(!s||!s.length)return[];const S=new Map;s.forEach($=>{const ce=yd($)||$.id,me=OR($);S.has(ce)||S.set(ce,{seriesKey:ce,displayName:me,books:[]}),S.get(ce).books.push($)});const O=Array.from(S.values()).map($=>({...$,books:[...$.books].sort(MR)}));return O.sort(($,ce)=>$.displayName.localeCompare(ce.displayName)),O},[s]),Us=k.useMemo(()=>Gt.flatMap(S=>S.books.map(O=>O.id)),[Gt]);k.useEffect(()=>{_e&&(s.some(S=>S.id===_e)||we(null))},[s,_e]),k.useEffect(()=>{ne&&(Gt.some(S=>S.seriesKey===ne)||be(null))},[Gt,ne]),k.useEffect(()=>{if(!le.size)return;const S=new Set(s.map($=>$.id)),O=Array.from(le).filter($=>!S.has($));O.length&&Ie($=>{const ce=new Set($);return O.forEach(me=>ce.delete(me)),ce})},[s,le]),k.useEffect(()=>{const S=Array.from(le);if(!S.length){F("");return}const O=Array.from(new Set(S.map($=>s.find(ce=>ce.id===$)).filter(Boolean).map($=>{const ce=$.amountPaid??$.AmountPaid??"";return ce==null?"":String(ce)})));F(O.length===1?O[0]:"")},[le,s]),k.useEffect(()=>{const S=Gt.find(mt=>mt.seriesKey===ne);if(!S){b(rf());return}const O=S.books,$=mt=>{const An=Array.from(new Set(O.map(It=>{const dn=mt(It);return dn==null?"":String(dn).trim()})));return An.length===1?An[0]:""},ce=$(mt=>mt.publisher||mt.Publisher),me=$(mt=>mt.demographic||mt.Demographic),Te=$(mt=>mt.genre||mt.Genre),Ae=$(mt=>mt.subGenre||mt.SubGenre),Le=$(mt=>mt.msrp??mt.MSRP),ot=Array.from(new Set(O.map(mt=>(mt.datePurchased||mt.DatePurchased||"").trim()).filter(Boolean))),Rt=ot.length>1,Vt=Rt?"":ot[0]||"",Ut=O.filter(mt=>!!mt.read||mt.status==="Read"||mt.Read===!0).length,tr=Ut===O.length&&O.length>0;b({publisher:ce,demographic:me,genre:Te,subGenre:Ae,datePurchased:Vt,msrp:Le,initialPublisher:ce,initialDemographic:me,initialGenre:Te,initialSubGenre:Ae,initialDatePurchased:Vt,initialMsrp:Le,dateMixed:Rt,readChecked:tr,readIndeterminate:!tr&&!(Ut===0)})},[Gt,ne]),k.useEffect(()=>{z.current&&(z.current.indeterminate=L.readIndeterminate)},[L.readIndeterminate]),k.useEffect(()=>{const S=s.find($=>$.id===_e);if(!S){xe(Jv());return}const O=!!S.read||S.status==="Read"||S.Read===!0;xe({read:O,datePurchased:S.datePurchased||S.DatePurchased||"",dateRead:O&&(S.dateRead||S.DateRead)||"",pageCount:S.pageCount??S.PageCount??S.pages??S.Pages??"",msrp:S.msrp??S.MSRP??"",amountPaid:S.amountPaid??S.AmountPaid??"",rating:O?S.rating??S.Rating??"":"",special:!!(S.specialType||S.SpecialType),specialType:S.specialType??S.SpecialType??"",specialVolumes:S.specialVolumes??S.SpecialVolumes??"",collectiblePrice:S.collectiblePrice??S.CollectiblePrice??"",publisher:S.publisher||S.Publisher||"",demographic:S.demographic||S.Demographic||"",genre:S.genre||S.Genre||""})},[_e,s]),k.useEffect(()=>{if(!ur||!ur.length)return;const S=Jt-1,O=ur.reduce((Te,Ae)=>Te+Ae.value,0);if(!O||(ar.current?parseInt(ar.current,10):null)===S)return;const ce=ur.map(Te=>`${Te.label}: ${Te.value}`).join(", "),me=`Yearly reads summary for ${S}: ${O} total. Breakdown: ${ce}`;sf(B.yearly,me).then(()=>{ar.current=String(S),typeof window<"u"&&localStorage.setItem("dashboard-yearly-posted",String(S))})},[ur,Jt]),k.useEffect(()=>{if(!Zn||!Wt.length)return;const S=Ea(Zn.date),O=Ea(new Date);if(S>O||or.current===S)return;const $=Wt.filter(me=>Ea(me.date)===S);if(!$.length)return;const ce=`Wishlist releases for ${S}:
${$.map(me=>`- ${me.title}`).join(`
`)}`;sf(B.release,ce).then(()=>{or.current=S,typeof window<"u"&&localStorage.setItem("dashboard-release-posted",S)})},[Zn,Wt]),k.useEffect(()=>{if(!Pn){I("-");return}const S=()=>{const $=Pn-new Date;if($<=0){I("Released");return}const ce=Math.floor($/1e3),me=Math.floor(ce/86400),Te=Math.floor(ce%86400/3600).toString().padStart(2,"0"),Ae=Math.floor(ce%3600/60).toString().padStart(2,"0"),Le=Math.floor(ce%60).toString().padStart(2,"0");I(`${me}d ${Te}:${Ae}:${Le}`)};S();const O=setInterval(S,1e3);return()=>clearInterval(O)},[Pn]),k.useEffect(()=>{if(!(typeof window>"u"))try{const S=localStorage.getItem(Qv);if(!S)return;const O=JSON.parse(S);if(!Array.isArray(O))return;const $=O.map(ce=>({message:ce.message,ts:ce.ts?new Date(ce.ts):new Date})).filter(ce=>ce.message);$.length&&Be($)}catch(S){console.warn("Failed to load activity log",S)}},[]);const _n=async()=>{try{const S=await ti(Hn(it,"library"));a(S.docs.map(O=>({id:O.id,...O.data()})))}catch(S){console.error("Failed to refresh library",S),w(O=>O||"Failed to refresh library data.")}},Mn=S=>{const O=(S??"").toString().trim();if(O==="")return"";const $=parseFloat(O);return Number.isFinite($)?$:""},Fn=S=>{const O=(S??"").toString().trim();if(O==="")return"";const $=parseInt(O,10);return Number.isFinite($)?$:""},pi=S=>{try{const O=S.slice(0,100).map($=>({message:$.message,ts:$.ts instanceof Date?$.ts.toISOString():$.ts}));typeof window<"u"&&localStorage.setItem(Qv,JSON.stringify(O))}catch(O){console.warn("Failed to persist activity log",O)}},Xr=S=>{if(!S)return;const O={message:S,ts:new Date};Be(me=>{const Te=[O,...me].slice(0,100);return pi(Te),Te});const $=(n==null?void 0:n.email)||"anonymous",ce=`Activity: ${S}
User: ${$}
Time: ${new Date().toLocaleString()}`;sf(B.activity,ce).catch(me=>console.warn("Activity webhook failed",me))},_s=S=>{M(O=>{const $=new Set(O);return $.has(S)?$.delete(S):$.add(S),$}),be(S),we(null)},ws=(S,O,$)=>{const ce=S.metaKey||S.ctrlKey,me=S.shiftKey,Te=Us.indexOf(O);let Ae=new Set(le);if(me&&A!==null&&Te!==-1){const Le=Math.min(A,Te),ot=Math.max(A,Te);for(let Rt=Le;Rt<=ot;Rt+=1){const Vt=Us[Rt];Vt&&Ae.add(Vt)}}else ce?Ae.has(O)?Ae.delete(O):Ae.add(O):Ae=new Set;Ie(Ae),P(Te),we(O),be($),M(Le=>{const ot=new Set(Le);return ot.add($),ot})},Zr=()=>{Ie(new Set),P(null)},Ir=async()=>{if(!e){alert("Dashboard is read-only for your account.");return}const S=Array.from(le);if(!S.length){alert("Select books in Library Manager (use Ctrl/Cmd or Shift) before bulk editing.");return}const O=(R||"").toString().trim(),$=O!=="",ce=Mn(O);if($&&ce===""){alert("Enter a valid number for Amount Paid.");return}try{await Promise.all(S.map(me=>Ns(Dt(it,"library",me),{amountPaid:$?ce:""}))),await _n(),Zr(),Xr(`Updated amount paid for ${S.length} book${S.length===1?"":"s"} in library`),alert(`Applied Amount Paid to ${S.length} selection${S.length===1?"":"s"}.`)}catch(me){console.error("Failed to apply Amount Paid",me),alert("Failed to apply Amount Paid to selection.")}},zs=async()=>{if(!e){alert("Dashboard is read-only for your account.");return}const S=Gt.find(Ut=>Ut.seriesKey===ne);if(!S||!S.books.length)return;const O=!L.readIndeterminate,$=!!L.readChecked,ce=L.datePurchased!==L.initialDatePurchased,me=L.msrp!==L.initialMsrp,Te=L.publisher!==L.initialPublisher,Ae=L.demographic!==L.initialDemographic,Le=L.genre!==L.initialGenre,ot=L.subGenre!==L.initialSubGenre;if(!O&&!ce&&!me&&!Te&&!Ae&&!Le&&!ot)return;const Rt=String(L.msrp??"").trim(),Vt=me?Mn(Rt):"";if(me&&Rt!==""&&Vt===""){alert("Enter a valid number for MSRP.");return}try{const Ut=[];if(S.books.forEach(tr=>{const rn={};O&&(rn.read=$,rn.dateRead=$?tr.dateRead||tr.DateRead||new Date().toISOString().slice(0,10):""),ce&&(rn.datePurchased=L.datePurchased||""),me&&(rn.msrp=L.msrp===""?"":Vt),Te&&(rn.publisher=L.publisher||""),Ae&&(rn.demographic=L.demographic||""),Le&&(rn.genre=L.genre||""),ot&&(rn.subGenre=L.subGenre||""),Object.keys(rn).length&&Ut.push(Ns(Dt(it,"library",tr.id),rn))}),!Ut.length)return;await Promise.all(Ut),await _n(),we(null),Xr(`Updated series "${S.displayName||"Series"}" (${S.books.length} book${S.books.length===1?"":"s"})`),alert("Series updated.")}catch(Ut){console.error("Failed to save series changes",Ut),alert("Failed to update series.")}},pt=async()=>{if(!e){alert("Dashboard is read-only for your account.");return}if(!_e)return;const S=!!he.read,O=String(he.msrp??"").trim(),$=String(he.amountPaid??"").trim(),ce=String(he.pageCount??"").trim(),me=String(he.rating??"").trim(),Te=Mn(O),Ae=Mn($),Le=Fn(ce),ot=Mn(me);if(O!==""&&Te===""){alert("Enter a valid number for MSRP.");return}if($!==""&&Ae===""){alert("Enter a valid number for Amount Paid.");return}if(ce!==""&&Le===""){alert("Enter a valid page count.");return}if(S&&me!==""&&ot===""){alert("Enter a valid rating.");return}const Rt=!!he.special,Vt=Fn(he.specialVolumes),Ut=Mn(he.collectiblePrice),tr=String(he.specialVolumes??"").trim(),rn=String(he.collectiblePrice??"").trim();if(Rt&&he.specialType==="specialEdition"&&tr!==""&&Vt===""){alert("Enter a valid number for volumes contained.");return}if(Rt&&he.specialType==="collectible"&&rn!==""&&Ut===""){alert("Enter a valid collectible price.");return}const mt=S?he.dateRead||new Date().toISOString().slice(0,10):"",An={read:S,datePurchased:he.datePurchased||"",dateRead:mt,msrp:he.msrp===""?"":Te,amountPaid:he.amountPaid===""?"":Ae,pageCount:he.pageCount===""?"":Le,rating:S?he.rating===""?"":ot:"",specialType:Rt&&he.specialType||"",specialVolumes:Rt&&he.specialType==="specialEdition"?he.specialVolumes===""?"":Vt:"",collectiblePrice:Rt&&he.specialType==="collectible"?he.collectiblePrice===""?"":Ut:""};try{await Ns(Dt(it,"library",_e),An),await _n();const It=s.find(nr=>nr.id===_e)||V,dn=(It==null?void 0:It.Title)||(It==null?void 0:It.title)||"Untitled";Xr(`Updated "${dn}" in library`),alert("Saved changes.")}catch(It){console.error("Failed to save book changes",It),alert("Failed to save changes.")}},E=()=>{be(null),we(null),Zr(),b(rf())},G=()=>{we(null),P(null)},H=Gt.find(S=>S.seriesKey===ne)||null,V=s.find(S=>S.id===_e)||null,q=ne?{msrp:!L.msrp,datePurchased:!L.datePurchased&&!L.dateMixed,publisher:!L.publisher,demographic:!L.demographic,genre:!L.genre}:{},ae=_e?FR({amountPaid:he.amountPaid,msrp:he.msrp,datePurchased:he.datePurchased,publisher:(V==null?void 0:V.publisher)||(V==null?void 0:V.Publisher)||"",demographic:(V==null?void 0:V.demographic)||(V==null?void 0:V.Demographic)||"",genre:(V==null?void 0:V.genre)||(V==null?void 0:V.Genre)||"",special:he.special,specialType:he.specialType,specialVolumes:he.specialVolumes,collectiblePrice:he.collectiblePrice,pageCount:he.pageCount}):{};if(t)return c.jsx("div",{className:"page dashboard-page",children:c.jsxs("div",{className:"dashboard-loading",children:[c.jsx("h1",{children:"Dashboard"}),c.jsx("p",{children:"Checking permissions..."})]})});if(!n||!e)return c.jsx("div",{className:"page dashboard-page",children:c.jsxs("div",{className:"dashboard-locked",children:[c.jsx("h1",{children:"Dashboard"}),c.jsx("p",{children:"This area is restricted to admin accounts."})]})});if(f)return c.jsx("div",{className:"page dashboard-page",children:c.jsxs("div",{className:"dashboard-loading",children:[c.jsx("h1",{children:"Dashboard"}),v?c.jsx("p",{className:"error",children:v}):c.jsx("p",{children:"Loading stats..."})]})});const ie=yn+Lr,Ne=ie?Math.round(yn/ie*100):0,Se=[...cr.values()].filter(S=>S.ratingCount>0).map(S=>({title:S.title,avg:S.ratingSum/S.ratingCount,count:S.ratingCount})).sort((S,O)=>O.avg-S.avg||O.count-S.count).slice(0,3);function ke(){if(Pn)$t(new Date(Pn.getFullYear(),Pn.getMonth(),1));else if(Wt.length){const S=Wt[0].date;$t(new Date(S.getFullYear(),S.getMonth(),1))}_t(!0)}function oe(S){Pt({open:!0,type:S})}function rt(){Pt({open:!1,type:null})}const De=Ea(new Date),Qt=eN(St,Wt,De),Mr=S=>{Yn(O=>{const $=new Date(O.year,O.month+S,1);return{year:$.getFullYear(),month:$.getMonth()}})},br=()=>{Cn(!1),Jn(null)},es=()=>{const S=Array.from(Nn.keys()).sort();if(S.length){const O=S[S.length-1],[$,ce]=O.split("-"),me=Number($),Te=Number(ce)-1;!Number.isNaN(me)&&!Number.isNaN(Te)&&Yn({year:me,month:Te})}Cn(!0)};function ts(){const S=ft.type;if(!S)return null;if(S==="publishers"){const O=[...uo(cr,"publisher",100)];return c.jsxs(c.Fragment,{children:[c.jsx("h3",{children:"Top Publishers by Series"}),O.length===0?c.jsx("p",{children:"No publisher data yet."}):c.jsxs("table",{children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"#"}),c.jsx("th",{children:"Publisher"}),c.jsx("th",{children:"Series Count"})]})}),c.jsx("tbody",{children:O.map(($,ce)=>c.jsxs("tr",{children:[c.jsx("td",{children:ce+1}),c.jsx("td",{children:$.name}),c.jsx("td",{children:$.count})]},$.name+ce))})]})]})}if(S==="genres"){const O=[...uo(cr,"genre",100)];return c.jsxs(c.Fragment,{children:[c.jsx("h3",{children:"Top Genres by Series"}),O.length===0?c.jsx("p",{children:"No genre data yet."}):c.jsxs("table",{children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"#"}),c.jsx("th",{children:"Genre"}),c.jsx("th",{children:"Series Count"})]})}),c.jsx("tbody",{children:O.map(($,ce)=>c.jsxs("tr",{children:[c.jsx("td",{children:ce+1}),c.jsx("td",{children:$.name}),c.jsx("td",{children:$.count})]},$.name+ce))})]})]})}if(S==="demographics"){const O=[...uo(cr,"demographic",100)];return c.jsxs(c.Fragment,{children:[c.jsx("h3",{children:"Top Demographics by Series"}),O.length===0?c.jsx("p",{children:"No demographic data yet."}):c.jsxs("table",{children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"#"}),c.jsx("th",{children:"Demographic"}),c.jsx("th",{children:"Series Count"})]})}),c.jsx("tbody",{children:O.map(($,ce)=>c.jsxs("tr",{children:[c.jsx("td",{children:ce+1}),c.jsx("td",{children:$.name}),c.jsx("td",{children:$.count})]},$.name+ce))})]})]})}if(S==="timeToRead"){const O=ys||[];return c.jsxs(c.Fragment,{children:[c.jsx("h3",{children:"Average Time From Purchase to Read"}),er==null?c.jsx("p",{children:"Not enough volumes have both purchase and read dates to calculate this yet."}):c.jsxs(c.Fragment,{children:[c.jsxs("p",{children:["On average, it takes"," ",c.jsxs("strong",{children:[er.toFixed(1)," days"]})," from purchase to finishing a volume."]}),O.length>0?c.jsxs("table",{children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"Series"}),c.jsx("th",{children:"Avg Days"}),c.jsx("th",{children:"Longest"}),c.jsx("th",{children:"Shortest"}),c.jsx("th",{children:"Reads Count"})]})}),c.jsx("tbody",{children:O.map($=>c.jsxs("tr",{children:[c.jsx("td",{children:$.title}),c.jsxs("td",{children:[$.avg.toFixed(1)," days"]}),c.jsxs("td",{children:[Math.round($.max)," days"]}),c.jsxs("td",{children:[Math.round($.min)," days"]}),c.jsx("td",{children:$.count})]},$.key))})]}):c.jsx("p",{style:{marginTop:8},children:"No series-level data yet."})]})]})}if(S==="collectionValue"){const{msrpTotal:O,paidTotal:$}=ct,ce=O-$,me=O>0?($/O*100).toFixed(1):"-",Te=[...Cr].filter(Ae=>Ae.msrp||Ae.paid||Ae.collectible).sort((Ae,Le)=>Le.msrp+Le.collectible-(Ae.msrp+Ae.collectible));return c.jsxs(c.Fragment,{children:[c.jsx("h3",{children:"Collection Value Breakdown"}),c.jsx("table",{children:c.jsxs("tbody",{children:[c.jsxs("tr",{children:[c.jsx("th",{children:"Total MSRP"}),c.jsxs("td",{children:["$",O.toFixed(2)]})]}),c.jsxs("tr",{children:[c.jsx("th",{children:"Total Paid"}),c.jsxs("td",{children:["$",$.toFixed(2)]})]}),c.jsxs("tr",{children:[c.jsx("th",{children:"Difference"}),c.jsxs("td",{children:["$",ce.toFixed(2)]})]}),c.jsxs("tr",{children:[c.jsx("th",{children:"Paid vs MSRP"}),c.jsx("td",{children:me==="-"?"-":`${me}%`})]})]})}),Te.length>0&&c.jsxs(c.Fragment,{children:[c.jsx("h4",{style:{marginTop:"14px"},children:"Collection Pricing"}),c.jsxs("table",{children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"Title"}),c.jsx("th",{children:"MSRP"}),c.jsx("th",{children:"Paid"}),c.jsx("th",{children:"Collectible"}),c.jsx("th",{children:"Books"})]})}),c.jsx("tbody",{children:Te.map((Ae,Le)=>c.jsxs("tr",{children:[c.jsx("td",{children:Ae.title}),c.jsxs("td",{children:["$",Ae.msrp.toFixed(2)]}),c.jsxs("td",{children:["$",Ae.paid.toFixed(2)]}),c.jsx("td",{children:Ae.collectible?`$${Ae.collectible.toFixed(2)}`:"--"}),c.jsx("td",{children:Ae.books})]},Ae.title+Le))})]})]})]})}if(S==="pages"){const O=[...Cr].filter($=>$.pages>0).map($=>({...$,pct:$.pages?Math.round($.readPages/$.pages*100):0})).sort(($,ce)=>ce.pages-$.pages);return c.jsxs(c.Fragment,{children:[c.jsx("h3",{children:"Pages Read vs Total"}),c.jsx("table",{children:c.jsxs("tbody",{children:[c.jsxs("tr",{children:[c.jsx("th",{children:"Total Pages"}),c.jsx("td",{children:vn.total.toLocaleString()})]}),c.jsxs("tr",{children:[c.jsx("th",{children:"Pages Read"}),c.jsx("td",{children:vn.read.toLocaleString()})]}),c.jsxs("tr",{children:[c.jsx("th",{children:"Completion"}),c.jsx("td",{children:vn.total?`${(vn.read/vn.total*100).toFixed(1)}%`:"-"})]})]})}),O.length>0&&c.jsxs(c.Fragment,{children:[c.jsx("h4",{style:{marginTop:"14px"},children:"Pages by Series"}),c.jsxs("table",{children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"Title"}),c.jsx("th",{children:"Read Pages"}),c.jsx("th",{children:"Total Pages"}),c.jsx("th",{children:"% Read"}),c.jsx("th",{children:"Books"})]})}),c.jsx("tbody",{children:O.map(($,ce)=>c.jsxs("tr",{children:[c.jsx("td",{children:$.title}),c.jsx("td",{children:$.readPages.toLocaleString()}),c.jsx("td",{children:$.pages.toLocaleString()}),c.jsxs("td",{children:[$.pct,"%"]}),c.jsx("td",{children:$.books})]},$.title+ce))})]})]})]})}if(S==="ratings"){const O=[...Cr].map($=>{if(!$.ratings.length)return null;const ce=$.ratings.reduce((me,Te)=>me+Te,0)/$.ratings.length;return{title:$.title,avg:ce,count:$.ratings.length}}).filter(Boolean).sort(($,ce)=>ce.avg-$.avg||ce.count-$.count);return c.jsxs(c.Fragment,{children:[c.jsx("h3",{children:"Ratings Overview"}),At==null?c.jsx("p",{children:"No ratings have been recorded yet."}):c.jsxs("p",{children:["Average series rating across rated series is"," ",c.jsx("strong",{children:At.toFixed(2)}),"."]}),O.length>0&&c.jsxs(c.Fragment,{children:[c.jsx("h4",{style:{marginTop:"14px"},children:"Series Averages"}),c.jsxs("table",{children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"Title"}),c.jsx("th",{children:"Avg"}),c.jsx("th",{children:"Ratings"})]})}),c.jsx("tbody",{children:O.map(($,ce)=>c.jsxs("tr",{children:[c.jsx("td",{children:$.title}),c.jsx("td",{children:$.avg.toFixed(2)}),c.jsx("td",{children:$.count})]},$.title+ce))})]})]})]})}return S==="releases"?c.jsxs(c.Fragment,{children:[c.jsx("h3",{children:"Library & Wishlist Releases"}),Wt.length===0?c.jsx("p",{children:"No wishlist releases found."}):c.jsxs("table",{children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"Date"}),c.jsx("th",{children:"Title"})]})}),c.jsx("tbody",{children:Wt.map((O,$)=>c.jsxs("tr",{children:[c.jsx("td",{children:O.date.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}),c.jsx("td",{children:O.title})]},$))})]})]}):null}return c.jsxs("div",{className:"page dashboard-page",children:[c.jsxs("header",{className:"dashboard-header",style:{display:"flex",alignItems:"center",justifyContent:"center",position:"relative",textAlign:"center",width:"100%"},children:[c.jsxs("div",{style:{textAlign:"center",margin:"0 auto",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"0 60px"},children:[c.jsx("h1",{style:{margin:0,fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Dashboard"}),c.jsx("p",{className:"dashboard-sub",style:{textAlign:"center",margin:"6px 0 0"},children:"My Entire Statistics dashboard for my Manga. I still use Excel though."})]}),e&&c.jsx("div",{style:{position:"absolute",right:0,top:"50%",transform:"translateY(-50%)"},children:c.jsx("button",{className:"stat-link",onClick:()=>je(!0),type:"button",children:"Admin Settings"})})]}),c.jsx("section",{id:"dashboardSection",className:"page-section active",children:c.jsxs("div",{className:"dashboard-grid",children:[c.jsxs("div",{className:"stat-stack",children:[c.jsxs("div",{className:"stat-card mini clickable",onClick:es,children:[c.jsx("h3",{children:"Total Library Books"}),c.jsx("div",{className:"stat-value",children:yn}),c.jsx("div",{className:"stat-sub",children:"Volumes in your library."})]}),c.jsxs("div",{className:"stat-card mini",children:[c.jsx("h3",{children:"Wishlist Items"}),c.jsx("div",{className:"stat-value",children:Lr}),c.jsx("div",{className:"stat-sub",children:"Tracked upcoming wants."})]})]}),c.jsxs("div",{className:"stat-card",children:[c.jsx("h3",{children:"Read / Unread"}),c.jsx("div",{className:"pie",style:{"--pct":`${Ct*3.6}deg`},children:c.jsxs("div",{className:"pie-label",children:[Ct,"%"]})}),c.jsxs("div",{className:"stat-value",children:[Fs," read / ",ms," unread"]})]}),c.jsxs("div",{className:"stat-card clickable",onClick:()=>oe("ratings"),children:[c.jsx("h3",{children:"Ratings"}),c.jsx("div",{className:"stat-value",children:At==null?"-":At.toFixed(2)}),c.jsx("div",{className:"stat-sub",children:"Average across rated series."}),c.jsx("div",{className:"stat-list compact",children:Se.length?Se.map((S,O)=>c.jsxs("div",{className:"stat-list-row",children:[c.jsx("span",{className:"stat-rank",children:O+1}),c.jsx("span",{className:"stat-name",children:S.title}),c.jsx("span",{className:"stat-count",children:S.avg.toFixed(2)})]},S.title+O)):c.jsx("div",{className:"stat-sub",children:"No ratings yet."})})]}),c.jsxs("div",{className:"stat-card clickable",onClick:()=>oe("pages"),children:[c.jsx("h3",{children:"Page Count Read / Total"}),c.jsxs("div",{className:"stat-value",children:[vn.read.toLocaleString()," / ",vn.total.toLocaleString()]}),c.jsx("div",{className:"stat-sub",children:vn.total?`${(vn.read/vn.total*100).toFixed(1)}% read`:"-"})]}),c.jsxs("div",{className:"stat-card",children:[c.jsx("h3",{children:"Library vs Wishlist"}),c.jsx("div",{className:"pie",style:{"--pct":`${Ne*3.6}deg`},children:c.jsxs("div",{className:"pie-label",children:[Ne,"%"]})}),c.jsxs("div",{className:"stat-value",children:[yn," / ",Lr]}),c.jsx("div",{className:"stat-sub",children:"Library vs wishlist share"})]}),c.jsxs("div",{className:"stat-card clickable",onClick:()=>oe("demographics"),children:[c.jsx("h3",{children:"Top Demographics"}),c.jsx("div",{className:"stat-list",children:Or.length?Or.slice(0,3).map((S,O)=>c.jsxs("div",{className:"stat-list-row",children:[c.jsx("span",{className:"stat-rank",children:O+1}),c.jsx("span",{className:"stat-name",children:S.name}),c.jsx("span",{className:"stat-count",children:S.count})]},S.name)):c.jsx("div",{className:"stat-sub",children:"No demographic data yet."})})]}),c.jsxs("div",{className:"stat-card clickable",onClick:()=>oe("publishers"),children:[c.jsx("h3",{children:"Top Publishers"}),c.jsx("div",{className:"stat-list",children:Jr.length?Jr.slice(0,3).map((S,O)=>c.jsxs("div",{className:"stat-list-row",children:[c.jsx("span",{className:"stat-rank",children:O+1}),c.jsx("span",{className:"stat-name",children:S.name}),c.jsx("span",{className:"stat-count",children:S.count})]},S.name)):c.jsx("div",{className:"stat-sub",children:"No publisher data yet."})})]}),c.jsxs("div",{className:"stat-card clickable",onClick:()=>oe("genres"),children:[c.jsx("h3",{children:"Top Genres"}),c.jsx("div",{className:"stat-list",children:bn.length?bn.slice(0,3).map((S,O)=>c.jsxs("div",{className:"stat-list-row",children:[c.jsx("span",{className:"stat-rank",children:O+1}),c.jsx("span",{className:"stat-name",children:S.name}),c.jsx("span",{className:"stat-count",children:S.count})]},S.name)):c.jsx("div",{className:"stat-sub",children:"No genre data yet."})})]}),c.jsxs("div",{className:"stat-card clickable",onClick:()=>{ke()},children:[c.jsx("h3",{children:"Next Wishlist Release"}),c.jsx("div",{className:"stat-value next-release",children:Zn?Zn.title:"No upcoming releases"}),c.jsxs("div",{className:"stat-sub",children:[Pn?Pn.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"}):"-",c.jsx("br",{}),c.jsx("span",{id:"statNextCountdown",children:T})]})]}),c.jsxs("div",{className:"stat-card clickable",onClick:()=>oe("collectionValue"),style:{textAlign:"center"},children:[c.jsx("h3",{children:"Collection Pricing"}),c.jsxs("div",{className:"stat-value stat-msrp",children:["$",ct.msrpTotal.toFixed(2)]}),c.jsxs("div",{className:"stat-value stat-paid",children:["$",ct.paidTotal.toFixed(2),ct.msrpTotal>0&&c.jsxs("span",{className:"stat-paid-pct",children:["(",((1-ct.paidTotal/ct.msrpTotal)*100).toFixed(1),"% off)"]})]}),c.jsxs("div",{className:"stat-value stat-collectible",children:["$",ct.collectibleTotal.toFixed(2)]}),c.jsx("div",{className:"stat-sub",children:"MSRP  Paid  Collectible overrides"})]}),c.jsxs("div",{className:"stat-card",children:[c.jsx("h3",{children:"Current Year Reads"}),c.jsx("div",{className:"stat-value",children:In}),c.jsxs("div",{className:"stat-sub",children:["Reads in ",Jt]})]}),c.jsxs("div",{className:"stat-card clickable",onClick:()=>oe("timeToRead"),children:[c.jsx("h3",{children:"Avg Days From Purchase to Read"}),c.jsx("div",{className:"stat-value",children:er==null?"-":`${er.toFixed(1)} days`}),c.jsx("div",{className:"stat-sub",children:"When both dates exist"})]}),c.jsxs("div",{className:"stat-duo",children:[c.jsxs("div",{className:"stat-card tall",children:[c.jsxs("h3",{children:["Reads Per Month (",Jt,")"]}),c.jsx(XR,{data:gs})]}),c.jsxs("div",{className:"stat-card tall",children:[c.jsx("h3",{children:"Reads by Day of Week (Lifetime)"}),c.jsx(ZR,{data:Xn}),c.jsx("div",{className:"stat-sub",children:"Based on all entries with a read date."})]})]}),c.jsxs("div",{className:"stat-card wide",children:[c.jsx("h3",{children:"Activity Log"}),Rn&&c.jsx("div",{className:"error",style:{textAlign:"center"},children:v}),c.jsx("div",{className:"activity-log scrollable",children:ut.length?ut.map((S,O)=>{const $=S.ts?new Date(S.ts):null;return c.jsxs("div",{className:"activity-row",children:[c.jsx("span",{className:"activity-title",children:S.message}),c.jsx("span",{className:"activity-date",children:$?$.toLocaleString(void 0,{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}):""})]},(S.message||"activity")+O)}):c.jsx("div",{className:"stat-sub",children:"No recent activity yet."})})]}),c.jsxs("div",{className:"stat-card wide",style:{minHeight:"340px",maxHeight:"480px"},children:[c.jsx("h3",{children:"Suggestions"}),He&&c.jsx("div",{className:"error",style:{textAlign:"center"},children:He}),c.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",alignItems:"stretch"},children:["anime","manga"].map(S=>{const O=te.filter($=>($.type||"").toLowerCase()===S).sort(($,ce)=>{var me,Te,Ae,Le;return(((Te=(me=ce.createdAt)==null?void 0:me.getTime)==null?void 0:Te.call(me))||0)-(((Le=(Ae=$.createdAt)==null?void 0:Ae.getTime)==null?void 0:Le.call(Ae))||0)});return c.jsxs("div",{style:{border:"1px solid rgba(255,182,193,0.18)",borderRadius:"16px",padding:"10px 12px",display:"flex",flexDirection:"column",background:"rgba(255,182,193,0.04)",minHeight:"240px"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"8px",position:"relative"},children:[c.jsx("h4",{style:{margin:0,color:"#ffb6c1",textAlign:"center",flex:1},children:S==="anime"?"Anime":"Manga"}),c.jsxs("span",{className:"stat-sub",style:{position:"absolute",right:0},children:[O.length," suggestion",O.length===1?"":"s"]})]}),c.jsx("div",{className:"scrollable",style:{maxHeight:"280px",height:"280px",paddingRight:"4px",overflowY:"auto"},children:ve?c.jsx("div",{className:"stat-sub",children:"Loading suggestions..."}):O.length?O.map($=>{const ce=$.createdAt instanceof Date?$.createdAt:$.createdAt?new Date($.createdAt):null;return c.jsxs("div",{style:{border:"1px solid rgba(255,182,193,0.25)",borderRadius:"12px",padding:"8px 10px",marginBottom:"8px",background:"rgba(255,182,193,0.06)",display:"grid",gridTemplateColumns:"1fr auto",gap:"6px",alignItems:"center"},children:[c.jsxs("div",{children:[c.jsx("div",{style:{fontWeight:600,color:"#f7d0dc"},children:$.content||"(no content)"}),c.jsxs("div",{className:"stat-sub",style:{fontSize:"0.8rem"},children:[ce?ce.toLocaleString(void 0,{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}):""," ",$.from?` ${$.from}`:""]})]}),c.jsx("div",{style:{display:"flex",gap:"6px"},children:e&&c.jsx("button",{type:"button",className:"stat-link",onClick:()=>Vr($.id),children:"Delete"})})]},$.id)}):c.jsx("div",{className:"stat-sub",children:"No suggestions yet."})})]},S)})}),c.jsxs("div",{className:"stat-sub",style:{marginTop:"8px",textAlign:"center"},children:["Total suggestions: ",te.length]})]}),c.jsxs("div",{className:"stat-card wide",children:[c.jsx("h3",{children:"Library Manager"}),Gt.length?c.jsxs("div",{className:"dash-library",children:[c.jsxs("div",{className:"dash-library-list",children:[Gt.map(S=>{const O=S.books.filter(Ae=>!!Ae.read||Ae.status==="Read"||Ae.Read===!0).length,$=K.has(S.seriesKey),ce=ne===S.seriesKey&&!_e,me=UR(S),Te=S.books.some(Ae=>Xv(Ae));return c.jsxs("div",{style:{marginBottom:"8px"},children:[c.jsxs("button",{type:"button",onClick:()=>_s(S.seriesKey),style:{width:"100%",textAlign:"left",background:me?"rgba(255,179,71,0.08)":"transparent",border:`1px solid ${ce?"#ff69b4":me?"rgba(255,179,71,0.6)":"rgba(255,182,193,0.25)"}`,color:"#ffb6c1",padding:"8px",borderRadius:"8px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"8px",position:"relative",boxShadow:me?"0 0 10px rgba(255,179,71,0.5)":ce?"0 0 8px rgba(255,105,180,0.5)":"none"},children:[c.jsx("span",{style:{transition:"transform 0.2s ease",transform:$?"rotate(90deg)":"none"},children:">"}),c.jsx("span",{style:{flex:1},children:S.displayName}),c.jsxs("span",{style:{fontSize:"11px",color:"#f8d1d8"},children:[S.books.length," book",S.books.length===1?"":"s",S.books.length?`  ${O} read`:""]}),Te&&c.jsx("span",{title:"Some volumes are missing required data",style:{width:"12px",height:"12px",borderRadius:"999px",background:"#ffb347",border:"1px solid rgba(255,255,255,0.25)",boxShadow:"0 0 10px rgba(255,179,71,0.6)"}})]}),c.jsx("div",{style:{margin:"6px 0 10px 10px",paddingLeft:"10px",borderLeft:"1px solid rgba(255,182,193,0.25)",display:$?"block":"none"},children:S.books.map(Ae=>{const Le=_e===Ae.id,ot=le.has(Ae.id);Ae.read||Ae.status==="Read"||Ae.Read;const Rt=Xv(Ae,{ignoreShared:!0});return c.jsxs("button",{type:"button",onClick:Vt=>ws(Vt,Ae.id,S.seriesKey),style:{width:"100%",textAlign:"left",background:Rt?"rgba(255,179,71,0.1)":"transparent",border:`1px solid ${Le?"#ff69b4":ot?"#fff59d":Rt?"rgba(255,179,71,0.6)":"rgba(255,182,193,0.25)"}`,color:"#ffb6c1",padding:"8px",borderRadius:"8px",marginBottom:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"8px",boxShadow:Le?"0 0 8px rgba(255,105,180,0.5)":ot?"0 0 10px rgba(255,255,180,0.65)":Rt?"0 0 10px rgba(255,179,71,0.5)":"none"},children:[c.jsx("span",{style:{flex:1,minWidth:0},children:Ae.Title||Ae.title||"Untitled"}),Rt&&c.jsx("span",{style:{flexShrink:0,padding:"2px 8px",borderRadius:"999px",background:"rgba(255,179,71,0.18)",border:"1px solid rgba(255,179,71,0.6)",color:"#ffd8a1",fontSize:"11px",fontWeight:700,whiteSpace:"nowrap"},children:"Missing data"})]},Ae.id)})})]},S.seriesKey)}),Gt.length>0&&le.size>0&&c.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:c.jsx("button",{type:"button",style:{padding:"6px 12px",borderRadius:"999px",border:"1px solid #ffb6c1",background:"transparent",color:"#ffb6c1",cursor:"pointer"},onClick:Zr,children:"Clear Selection"})})]}),c.jsxs("div",{className:"dash-library-details",children:[le.size>0&&c.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px",padding:"10px",marginBottom:"10px",border:"1px dashed rgba(255,182,193,0.45)",borderRadius:"10px",background:"rgba(255,182,193,0.08)"},children:[c.jsxs("div",{children:["Apply Amount Paid to ",le.size," selected book",le.size===1?"":"s"]}),c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",flexWrap:"wrap"},children:[c.jsx("input",{type:"number",step:"0.01",min:"0",value:R,onChange:S=>F(S.target.value),style:{maxWidth:"140px"}}),c.jsx("button",{type:"button",className:"dash-btn primary",onClick:Ir,children:"Apply to Selected"})]})]}),!ne&&!_e&&c.jsx("div",{className:"stat-sub",style:{marginTop:6},children:"Select a series or book to edit"}),ne&&!_e&&H&&c.jsxs("div",{children:[c.jsx("div",{className:"dash-detail-title",children:H.displayName}),c.jsx("div",{className:"dash-detail-row",children:c.jsxs("label",{className:"inline-checkbox",children:[c.jsx("input",{ref:z,type:"checkbox",checked:L.readChecked,onChange:S=>b(O=>({...O,readChecked:S.target.checked,readIndeterminate:!1}))}),c.jsx("span",{children:"Mark series as read"})]})}),c.jsxs("div",{className:`dash-detail-row${q.publisher?" missing-row":""}`,children:[c.jsx("span",{children:"Publisher"}),c.jsx("input",{type:"text",value:L.publisher,onChange:S=>b(O=>({...O,publisher:S.target.value})),placeholder:"Set publisher for series"})]}),c.jsxs("div",{className:`dash-detail-row${q.demographic?" missing-row":""}`,children:[c.jsx("span",{children:"Demographic"}),c.jsxs("select",{value:L.demographic,onChange:S=>b(O=>({...O,demographic:S.target.value})),children:[c.jsx("option",{value:"",children:"Select Demographic"}),c.jsx("option",{value:"Shounen",children:"Shounen"}),c.jsx("option",{value:"Seinen",children:"Seinen"}),c.jsx("option",{value:"Shoujo",children:"Shoujo"}),c.jsx("option",{value:"Josei",children:"Josei"})]})]}),c.jsxs("div",{className:`dash-detail-row${q.genre?" missing-row":""}`,children:[c.jsx("span",{children:"Genre"}),c.jsx("input",{type:"text",value:L.genre,onChange:S=>b(O=>({...O,genre:S.target.value})),placeholder:"Primary genre"})]}),c.jsxs("div",{className:"dash-detail-row",children:[c.jsx("span",{children:"Sub-Genre"}),c.jsx("input",{type:"text",value:L.subGenre,onChange:S=>b(O=>({...O,subGenre:S.target.value})),placeholder:"Secondary genre / theme"})]}),!L.dateMixed&&c.jsxs("div",{className:`dash-detail-row${q.datePurchased?" missing-row":""}`,children:[c.jsx("span",{children:"Date Purchased"}),c.jsx("input",{type:"date",value:L.datePurchased,onChange:S=>b(O=>({...O,datePurchased:S.target.value}))})]}),c.jsxs("div",{className:`dash-detail-row${q.msrp?" missing-row":""}`,children:[c.jsx("span",{children:"MSRP (per book)"}),c.jsx("input",{type:"number",step:"0.01",min:"0",value:L.msrp,onChange:S=>b(O=>({...O,msrp:S.target.value})),placeholder:"0.00"})]}),c.jsxs("div",{className:"dash-detail-actions",children:[c.jsx("button",{type:"button",className:"dash-btn secondary",onClick:E,children:"Cancel"}),c.jsx("button",{type:"button",className:"dash-btn primary",onClick:zs,children:"Save Series"})]})]}),_e&&V&&c.jsxs("div",{children:[c.jsx("div",{className:"dash-detail-title",children:V.Title||V.title||"Untitled"}),c.jsx("div",{className:"dash-detail-row",children:c.jsxs("label",{className:"inline-checkbox",children:[c.jsx("input",{type:"checkbox",checked:!!he.read,onChange:S=>xe(O=>({...O,read:S.target.checked,dateRead:S.target.checked?O.dateRead||new Date().toISOString().slice(0,10):"",rating:S.target.checked?O.rating:""}))}),c.jsx("span",{children:"Mark as read"})]})}),c.jsxs("div",{className:`dash-detail-row${ae.datePurchased?" missing-row":""}`,children:[c.jsx("span",{children:"Date Purchased"}),c.jsx("input",{type:"date",value:he.datePurchased,onChange:S=>xe(O=>({...O,datePurchased:S.target.value}))})]}),he.read&&c.jsxs("div",{className:"dash-detail-row",children:[c.jsx("span",{children:"Date Read"}),c.jsx("input",{type:"date",value:he.dateRead,onChange:S=>xe(O=>({...O,dateRead:S.target.value}))})]}),c.jsxs("div",{className:`dash-detail-row${ae.pageCount?" missing-row":""}`,children:[c.jsx("span",{children:"Page Count"}),c.jsx("input",{type:"number",min:"0",step:"1",value:he.pageCount,onChange:S=>xe(O=>({...O,pageCount:S.target.value}))})]}),c.jsxs("div",{className:`dash-detail-row${ae.msrp?" missing-row":""}`,children:[c.jsx("span",{children:"MSRP (per book)"}),c.jsx("input",{type:"number",step:"0.01",min:"0",value:he.msrp,onChange:S=>xe(O=>({...O,msrp:S.target.value})),placeholder:"0.00"})]}),!(he.special&&he.specialType==="collectible")&&c.jsxs("div",{className:`dash-detail-row${ae.amountPaid?" missing-row":""}`,children:[c.jsx("span",{children:"Amount Paid"}),c.jsx("input",{type:"number",step:"0.01",min:"0",value:he.amountPaid,onChange:S=>xe(O=>({...O,amountPaid:S.target.value})),placeholder:"0.00"})]}),he.read&&c.jsxs("div",{className:"dash-detail-row",children:[c.jsx("span",{children:"Star Rating"}),c.jsx("input",{type:"number",min:"0",max:"5",step:"0.5",value:he.rating,onChange:S=>xe(O=>({...O,rating:S.target.value})),placeholder:"0-5"})]}),c.jsx("div",{className:`dash-detail-row${ae.specialType?" missing-row":""}`,children:c.jsxs("label",{className:"inline-checkbox",style:{width:"100%"},children:[c.jsx("input",{type:"checkbox",checked:!!he.special,onChange:S=>xe(O=>({...O,special:S.target.checked,specialType:S.target.checked?O.specialType:"",specialVolumes:S.target.checked?O.specialVolumes:"",collectiblePrice:S.target.checked?O.collectiblePrice:""}))}),c.jsx("span",{children:"Special?"})]})}),he.special&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:`dash-detail-row${ae.specialType?" missing-row":""}`,children:[c.jsx("span",{children:"Special Type"}),c.jsxs("select",{value:he.specialType,onChange:S=>xe(O=>({...O,specialType:S.target.value,specialVolumes:S.target.value==="specialEdition"?O.specialVolumes:"",collectiblePrice:S.target.value==="collectible"?O.collectiblePrice:""})),children:[c.jsx("option",{value:"",children:"Select type"}),c.jsx("option",{value:"specialEdition",children:"Special Edition"}),c.jsx("option",{value:"collectible",children:"Collectible"})]})]}),he.specialType==="specialEdition"&&c.jsxs("div",{className:`dash-detail-row${ae.specialVolumes?" missing-row":""}`,children:[c.jsx("span",{children:"Volumes Contained"}),c.jsx("input",{type:"number",min:"1",step:"1",value:he.specialVolumes,onChange:S=>xe(O=>({...O,specialVolumes:S.target.value}))})]}),he.specialType==="collectible"&&c.jsxs("div",{className:`dash-detail-row${ae.collectiblePrice?" missing-row":""}`,children:[c.jsx("span",{children:"Collectible Price"}),c.jsx("input",{type:"number",min:"0",step:"0.01",value:he.collectiblePrice,onChange:S=>xe(O=>({...O,collectiblePrice:S.target.value})),placeholder:"0.00"})]})]}),c.jsxs("div",{className:"dash-detail-actions",children:[c.jsx("button",{type:"button",className:"dash-btn secondary",onClick:G,children:"Cancel"}),c.jsx("button",{type:"button",className:"dash-btn primary",onClick:pt,children:"Save Changes"})]})]})]})]}):c.jsx("div",{className:"stat-sub",children:"No library items."})]})]})}),cn&&c.jsx("div",{className:"purchase-overlay",onClick:S=>{S.target===S.currentTarget&&br()},children:c.jsxs("div",{className:"purchase-calendar-modal",onClick:S=>S.stopPropagation(),children:[c.jsxs("div",{className:"purchase-calendar-header",children:[c.jsxs("div",{children:[c.jsx("div",{className:"purchase-calendar-title",children:new Date(Qn.year,Qn.month).toLocaleString(void 0,{month:"long",year:"numeric"})}),c.jsx("div",{className:"purchase-calendar-sub",children:"Purchased volumes by date"})]}),c.jsxs("div",{className:"purchase-calendar-controls",children:[c.jsx("button",{type:"button",className:"manga-btn secondary mini",onClick:()=>Mr(-1),children:""}),c.jsx("button",{type:"button",className:"manga-btn secondary mini",onClick:()=>Mr(1),children:""}),c.jsx("button",{type:"button",className:"manga-btn secondary",onClick:br,children:"Close"})]})]}),c.jsxs("div",{className:"purchase-calendar-grid",children:[vs.cells.map((S,O)=>{if(S.type==="pad")return c.jsx("div",{className:"purchase-day pad"},`pad-${O}`);const{day:$,dateKey:ce,items:me}=S;return c.jsxs("div",{className:"purchase-day"+(me.length?" has-items":""),onClick:()=>{me.length&&Jn({date:ce,items:me})},role:"button",tabIndex:0,onKeyDown:Te=>{if(Te.key==="Enter"||Te.key===" "){if(Te.preventDefault(),!me.length)return;Jn({date:ce,items:me})}},children:[c.jsx("div",{className:"purchase-day-num",children:$}),c.jsxs("div",{className:"purchase-day-chips",children:[me.slice(0,2).map(Te=>c.jsx("div",{className:"purchase-chip",children:Te.title||"Untitled"},Te.id)),me.length>2&&c.jsxs("div",{className:"purchase-chip more",children:["+",me.length-2," more"]})]})]},ce)}),!vs.hasItems&&c.jsx("div",{className:"purchase-empty",children:"No purchases for this month."})]})]})}),un&&c.jsx("div",{className:"purchase-overlay",onClick:S=>{S.target===S.currentTarget&&Jn(null)},children:c.jsxs("div",{className:"purchase-day-modal",onClick:S=>S.stopPropagation(),children:[c.jsxs("div",{className:"purchase-day-header",children:[c.jsx("div",{className:"purchase-day-title",children:new Date(un.date).toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"})}),c.jsx("button",{className:"manga-btn secondary",onClick:()=>Jn(null),type:"button",children:"Close"})]}),c.jsx("div",{className:"purchase-day-list",children:un.items.map(S=>c.jsx("div",{className:"purchase-day-item",children:S.title||"Untitled"},S.id))})]})}),Tt&&c.jsx("div",{id:"calendarOverlay",onClick:()=>_t(!1),children:c.jsxs("div",{id:"calendarCard",onClick:S=>S.stopPropagation(),children:[c.jsxs("div",{className:"calendar-header",children:[c.jsx("div",{className:"calendar-title",children:St.toLocaleString(void 0,{month:"long",year:"numeric"})}),c.jsxs("div",{className:"calendar-nav",children:[c.jsx("button",{className:"calendar-nav-btn",onClick:()=>$t(new Date(St.getFullYear(),St.getMonth()-1,1)),children:"<"}),c.jsx("button",{className:"calendar-nav-btn",onClick:()=>$t(new Date(St.getFullYear(),St.getMonth()+1,1)),children:">"})]})]}),c.jsxs("div",{className:"calendar-weekdays",children:[c.jsx("div",{children:"Sun"}),c.jsx("div",{children:"Mon"}),c.jsx("div",{children:"Tue"}),c.jsx("div",{children:"Wed"}),c.jsx("div",{children:"Thu"}),c.jsx("div",{children:"Fri"}),c.jsx("div",{children:"Sat"})]}),c.jsx("div",{className:"calendar-grid",id:"releaseCalendar",children:Qt.map((S,O)=>S.type==="pad"?c.jsx("div",{className:"calendar-day pad"},O):c.jsxs("div",{className:"calendar-day"+(S.isToday?" today":""),children:[c.jsx("div",{className:"day-num",children:S.day}),c.jsxs("div",{className:"calendar-releases",children:[(xt===S.dateKey?S.releases:S.releases.slice(0,2)).map(($,ce)=>c.jsx("div",{className:"calendar-release"+($.purchased?" purchased":""),title:$.title,children:$.title},ce)),S.releases.length>2&&c.jsxs("button",{className:"calendar-more-btn",onClick:()=>{const $=new Date(St.getFullYear(),St.getMonth(),S.day);Ve({dateLabel:$.toLocaleDateString(void 0,{month:"long",day:"numeric",year:"numeric"}),releases:S.releases})},children:["+",S.releases.length-2," more"]})]})]},O))}),!Wt.length&&c.jsx("div",{className:"calendar-empty",children:"No wishlist releases found."}),c.jsx("button",{id:"calendarClose",onClick:()=>_t(!1),children:"x"})]})}),ft.open&&c.jsx("div",{id:"statDetailOverlay",onClick:rt,children:c.jsxs("div",{id:"statDetailCard",onClick:S=>S.stopPropagation(),children:[c.jsx("button",{id:"statDetailClose",onClick:rt,children:"x"}),c.jsxs("h2",{id:"statDetailTitle",children:[ft.type==="publishers"&&"Top Publishers",ft.type==="genres"&&"Top Genres",ft.type==="demographics"&&"Top Demographics",ft.type==="timeToRead"&&"Avg Time From Purchase to Read",ft.type==="collectionValue"&&"Collection Value",ft.type==="pages"&&"Pages Read vs Total",ft.type==="ratings"&&"Ratings",ft.type==="releases"&&"Library & Wishlist Releases"]}),c.jsx("div",{id:"statDetailBody",children:ts()})]})}),$e&&c.jsx("div",{id:"calendarOverlay",onClick:()=>Ve(null),style:{zIndex:10080},children:c.jsxs("div",{id:"calendarCard",onClick:S=>S.stopPropagation(),style:{maxWidth:"520px"},children:[c.jsxs("div",{className:"calendar-header",children:[c.jsx("div",{className:"calendar-title",children:$e.dateLabel}),c.jsx("button",{className:"calendar-close-btn",onClick:()=>Ve(null),type:"button",children:"Close"})]}),c.jsx("div",{className:"calendar-releases",children:$e.releases.map((S,O)=>c.jsx("div",{className:"calendar-release"+(S.purchased?" purchased":""),title:S.title,children:S.title},O))})]})}),e&&ye&&c.jsx("div",{className:"dashboard-modal-backdrop visible",onClick:S=>{S.target===S.currentTarget&&je(!1)},children:c.jsxs("div",{className:"dashboard-modal",children:[c.jsxs("div",{className:"dashboard-modal-header",children:[c.jsx("h3",{children:"Webhook Settings"}),c.jsx("button",{className:"dashboard-close",onClick:()=>je(!1),type:"button",children:"Close"})]}),c.jsxs("div",{className:"dashboard-modal-body",children:[c.jsxs("label",{className:"dashboard-input",children:[c.jsx("span",{children:"Yearly summary webhook"}),c.jsx("input",{type:"text",value:B.yearly,onChange:S=>X(O=>({...O,yearly:S.target.value}))})]}),c.jsxs("label",{className:"dashboard-input",children:[c.jsx("span",{children:"Release timer webhook"}),c.jsx("input",{type:"text",value:B.release,onChange:S=>X(O=>({...O,release:S.target.value}))})]}),c.jsxs("label",{className:"dashboard-input",children:[c.jsx("span",{children:"Activity webhook"}),c.jsx("input",{type:"text",value:B.activity,onChange:S=>X(O=>({...O,activity:S.target.value}))})]}),c.jsxs("div",{className:"dashboard-input",style:{borderTop:"1px solid rgba(255,182,193,0.2)",paddingTop:8},children:[c.jsx("span",{children:"User roles"}),c.jsx("div",{style:{marginTop:8,fontSize:"0.85rem",color:"var(--text-soft)"},children:N?c.jsx("span",{children:"Loading users"}):Pe.length===0?c.jsx("span",{children:"No users found."}):c.jsx("ul",{style:{listStyle:"none",margin:"6px 0 0",padding:0,display:"flex",gap:6,flexDirection:"column"},children:Pe.map(S=>c.jsxs("li",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:8,background:"rgba(24,5,18,0.7)",border:"1px solid rgba(255,182,193,0.18)",borderRadius:10,padding:"6px 8px",flexWrap:"wrap"},children:[c.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:2},children:[c.jsx("strong",{children:S.displayName||S.email||S.uid}),c.jsx("span",{style:{fontSize:"0.85rem",opacity:.8},children:S.email||S.uid})]}),c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[c.jsx("span",{className:"role-pill",children:S.role||"viewer"}),S.role==="admin"?c.jsx("button",{className:"dashboard-close",type:"button",onClick:()=>Et(S.uid,"viewer"),style:{padding:"4px 10px"},children:"Make viewer"}):c.jsx("button",{className:"stat-link",type:"button",onClick:()=>Et(S.uid,"admin"),style:{padding:"4px 10px"},children:"Make admin"})]})]},S.uid))})})]})]}),c.jsxs("div",{className:"dashboard-modal-footer",children:[c.jsx("button",{className:"stat-link",type:"button",onClick:async()=>{try{await si(Dt(it,"settings","webhooks"),{yearly:B.yearly||gl,release:B.release||yl,activity:B.activity||vl}),je(!1)}catch(S){console.error("Failed to save webhooks",S),alert("Failed to save webhooks.")}},children:"Save"}),c.jsx("button",{className:"stat-link danger",type:"button",onClick:()=>je(!1),children:"Cancel"})]})]})})]})}function nN(){const[n,e]=k.useState(!0),[t,s]=k.useState(""),[a,l]=k.useState(0),[d,f]=k.useState([]),[m,v]=k.useState(0),w=k.useRef(null);k.useEffect(()=>{document.title="Music | im.ok"},[]),k.useEffect(()=>{let we=!1;async function le(){e(!0),s("");try{const Ie=await fetch("https://music-api-worker.imokissick.workers.dev/music");if(!Ie.ok)throw new Error("Worker fetch failed");const A=await Ie.json();if(we)return;const P=Array.isArray(A.combined)?A.combined:[],R=Array.isArray(A.spotify)?A.spotify:[],F=Array.isArray(A.soundcloud)?A.soundcloud:[],L=[...P,...R,...F].reduce((b,he)=>{const xe=(he.title||"").toLowerCase().trim();if(!xe)return b;const ut=b.findIndex(Be=>(Be.title||"").toLowerCase().trim()===xe);return ut>=0?(b[ut].source!=="spotify"&&he.source==="spotify"&&(b[ut]=he),b):(b.push(he),b)},[]).map(b=>({...b,releaseDate:b.releaseDate?new Date(b.releaseDate):new Date}));f(L)}catch(Ie){console.error(Ie),we||s("Failed to load music feeds.")}finally{we||e(!1)}}return le(),()=>{we=!0}},[]);const T=Math.min(4,Math.max(1,d.length)),I=T?Math.ceil(d.length/T):0,B=()=>{w.current&&clearInterval(w.current),d.length&&(v(we=>we+1),w.current=setInterval(()=>{l(we=>(Math.floor(we/T)+1)%I*T%d.length),v(we=>we+1)},15e3))};k.useEffect(()=>{if(d.length)return B(),()=>{w.current&&clearInterval(w.current)}},[d,T]);const X=we=>{d.length&&(l(le=>(Math.floor(le/T)+we+I)%I*T%d.length),B())},K=we=>{d.length&&(l(we*T%d.length),B())},M=we=>le=>{le.preventDefault();const A=we.source==="spotify"?`spotify:album:${we.id}`:we.url,P=we.url;try{const R=setTimeout(()=>{window.open(P,"_blank","noopener,noreferrer")},600);window.location.href=A,setTimeout(()=>clearTimeout(R),800)}catch{window.open(P,"_blank","noopener,noreferrer")}},ne=d[0],be=we=>we?{backgroundImage:`url(${we})`,backgroundSize:"cover",backgroundPosition:"center"}:{},_e=ne?ne.source==="spotify"?"Spotify":"SoundCloud":"";return c.jsxs("main",{className:"page music-page",children:[c.jsxs("header",{className:"music-hero",children:[c.jsxs("div",{className:"music-hero-content",children:[c.jsx("p",{className:"music-pill",children:"im.ok  Artist"}),c.jsx("h1",{children:ne?ne.title:"Latest & Greatest"}),c.jsx("p",{className:"music-sub",children:"Check out my latest song. I know it's been almost a whole year since I've released. I have been on a much needed hiatus. I felt the whole world crumbling around me and had no time to breathe so this is why I took a break. Here's to 2026!"}),ne&&c.jsx("div",{className:"music-badges",children:c.jsx("span",{children:_e})})]}),c.jsx("div",{className:"music-hero-embed",children:c.jsxs("div",{className:"music-hero-art",style:be(ne==null?void 0:ne.artwork),children:[!(ne!=null&&ne.artwork)&&c.jsx("div",{className:"music-hero-art-fallback",children:"Artwork"}),ne&&c.jsx("button",{className:"music-link music-play hero-play","aria-label":`Play ${ne.title}`,onClick:M(ne)})]})})]}),c.jsxs("section",{className:"music-section",children:[c.jsx("div",{className:"music-section-header",children:c.jsx("h2",{children:"Releases"})}),t&&c.jsx("div",{className:"music-error",children:t}),n&&c.jsx("div",{className:"music-loading",children:"Loading music feeds..."}),!n&&d.length===0&&c.jsx("div",{className:"music-empty",children:"Connect Spotify/SoundCloud tokens to see live releases."}),!n&&d.length>0&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"music-carousel-wrap",children:[c.jsx("button",{className:"music-nav left",onClick:()=>X(-1),"aria-label":"Previous releases",children:""}),c.jsx("div",{className:"music-carousel",children:Array.from({length:T}).map((we,le)=>{const Ie=d[(a+le)%d.length];return Ie?c.jsxs("div",{className:"music-card",children:[c.jsx("div",{className:"music-card-art",style:be(Ie.artwork)}),c.jsxs("div",{className:"music-card-body",children:[c.jsx("div",{className:"music-card-title",children:Ie.title}),c.jsx("div",{className:"music-card-actions",children:c.jsx("button",{className:"music-link music-play","aria-label":`Play ${Ie.title}`,onClick:M(Ie)})})]})]},`${Ie.id}-${le}`):null})}),c.jsx("button",{className:"music-nav right",onClick:()=>X(1),"aria-label":"Next releases",children:""})]}),c.jsx("div",{className:"music-dots",children:Array.from({length:I}).map((we,le)=>{const Ie=Math.floor(a/T)===le,A=Ie?`${le}-${m}`:`${le}-idle`;return c.jsx("button",{className:`dot ${Ie?"active":""}`,onClick:()=>K(le),"aria-label":`Go to set ${le+1}`,children:c.jsx("span",{className:"dot-fill"},A)},le)})})]})]}),c.jsxs("div",{className:"music-feeds-row",children:[c.jsxs("section",{className:"music-section",children:[c.jsx("div",{className:"music-section-header",children:c.jsx("h2",{children:"Spotify"})}),c.jsx("div",{className:"music-embed-card",children:c.jsx("iframe",{title:"Spotify Artist",src:"https://open.spotify.com/embed/artist/00sbWLxYLDs8i5BLQL9Qdo?utm_source=generator&theme=0",width:"100%",height:"400",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy"})})]}),c.jsxs("section",{className:"music-section",children:[c.jsx("div",{className:"music-section-header",children:c.jsx("h2",{children:"SoundCloud"})}),c.jsx("div",{className:"music-embed-card",children:c.jsx("iframe",{title:"SoundCloud Player",width:"100%",height:"400",scrolling:"no",frameBorder:"no",allow:"autoplay",src:"https://w.soundcloud.com/player/?url=https%3A//soundcloud.com/imxk&color=%23ff69b4&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true&visual=true"})})]})]})]})}function rN(){const n=Hu(),{user:e}=Fo(),t=async a=>{if(!(a!=null&&a.uid))return;const l=Dt(it,"users",a.uid);try{const d=await Mp(l),f=d.exists()?d.data():null,m=(f==null?void 0:f.role)||"viewer";await si(l,{role:m,email:a.email||(f==null?void 0:f.email)||"",displayName:a.displayName||(f==null?void 0:f.displayName)||"",createdAt:(f==null?void 0:f.createdAt)||Wu()},{merge:!0})}catch(d){console.warn("Failed to upsert user doc",d)}};k.useEffect(()=>{e!=null&&e.uid&&t(e).finally(()=>n("/"))},[e,n]);async function s(){try{const a=new hs,l=await a0(Kr,a);await t(l.user),n("/")}catch(a){console.error(a),alert("Google Sign-In failed.")}}return c.jsx("div",{className:"signin-page",children:c.jsxs("div",{className:"signin-card",children:[c.jsx("h2",{className:"signin-title",children:"Welcome Back"}),c.jsx("p",{className:"signin-sub",children:"Sign in to access the dashboard & edit collections."}),c.jsxs("button",{className:"google-btn",onClick:s,children:[c.jsx("img",{src:"https://www.svgrepo.com/show/475656/google-color.svg",alt:"",className:"google-icon"}),"Continue with Google"]}),c.jsxs("button",{className:"signin-cancel",onClick:()=>n("/"),children:["<"," Back to Home"]})]})})}const sN=k.lazy(()=>rc(()=>import("./SteamCard-CrQGX8Oq.js"),[])),iN=k.lazy(()=>rc(()=>import("./SteamRecents-VBPLhTvY.js"),[])),aN=k.lazy(()=>rc(()=>import("./SteamGames-tv6eEiLD.js"),[]));function oN(){return k.useEffect(()=>{document.title="Tyler's Gaming Lounge"},[]),c.jsxs("div",{className:"steam-page page",children:[c.jsxs("header",{style:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",gap:"6px"},children:[c.jsx("h1",{style:{margin:0,fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Tyler's Gaming Lounge"}),c.jsx("p",{style:{margin:"6px 0 0",color:"var(--text-soft)",fontSize:"0.9rem"},children:"This will be the home to all of my gaming collections, this is still being worked on, but thought it was cool with just steam for now."})]}),c.jsx(af,{minHeight:260,children:c.jsx(k.Suspense,{fallback:c.jsx(Tu,{label:"Profile"}),children:c.jsx(sN,{})})}),c.jsx(af,{minHeight:240,children:c.jsx(k.Suspense,{fallback:c.jsx(Tu,{label:"Recently played"}),children:c.jsx(iN,{})})}),c.jsx(af,{minHeight:400,children:c.jsx(k.Suspense,{fallback:c.jsx(Tu,{label:"Library & Achievements"}),children:c.jsx(aN,{})})})]})}function af({children:n,minHeight:e=200}){const[t,s]=k.useState(!1),a=k.useRef(null);k.useEffect(()=>{const d=new IntersectionObserver(f=>{f[0].isIntersecting&&(s(!0),d.disconnect())},{rootMargin:"200px 0px"});return a.current&&d.observe(a.current),()=>d.disconnect()},[]);const l=t?void 0:{minHeight:e};return c.jsx("div",{ref:a,style:l,children:t?n:c.jsx(Tu,{})})}function Tu({label:n="Loading section"}){return c.jsxs("div",{className:"steam-skeleton",children:[c.jsx("div",{className:"steam-skeleton-bar"}),c.jsx("div",{className:"steam-skeleton-bar short"}),c.jsx("p",{className:"steam-skeleton-label",children:n})]})}function lN(){return c.jsxs(mR,{children:[c.jsx(yR,{}),c.jsxs(qE,{children:[c.jsx(ds,{path:"/",element:c.jsx(Uv,{})}),c.jsx(ds,{path:"/home",element:c.jsx(Uv,{})}),c.jsx(ds,{path:"/manga",element:c.jsx(TR,{})}),c.jsx(ds,{path:"/anime",element:c.jsx(DR,{})}),c.jsx(ds,{path:"/tcg",element:c.jsx(LR,{})}),c.jsx(ds,{path:"/music",element:c.jsx(nN,{})}),c.jsx(ds,{path:"/dashboard",element:c.jsx(tN,{})}),c.jsx(ds,{path:"/signin",element:c.jsx(rN,{})}),c.jsx(ds,{path:"/steam",element:c.jsx(oN,{})}),c.jsx(ds,{path:"*",element:c.jsx(GE,{to:"/home",replace:!0})})]})]})}eE.createRoot(document.getElementById("root")).render(c.jsx(Of.StrictMode,{children:c.jsx(eT,{basename:"/base",children:c.jsx(lN,{})})}));export{c as j,k as r};
