function Mx(n,e){for(var t=0;t<e.length;t++){const s=e[t];if(typeof s!="string"&&!Array.isArray(s)){for(const a in s)if(a!=="default"&&!(a in n)){const l=Object.getOwnPropertyDescriptor(s,a);l&&Object.defineProperty(n,a,l.get?l:{enumerable:!0,get:()=>s[a]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const d of l.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&s(d)}).observe(document,{childList:!0,subtree:!0});function t(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(a){if(a.ep)return;a.ep=!0;const l=t(a);fetch(a.href,l)}})();function $v(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Vh={exports:{}},ul={},Oh={exports:{}},at={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mg;function Fx(){if(Mg)return at;Mg=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),d=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),v=Symbol.for("react.memo"),w=Symbol.for("react.lazy"),E=Symbol.iterator;function C(R){return R===null||typeof R!="object"?null:(R=E&&R[E]||R["@@iterator"],typeof R=="function"?R:null)}var U={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},G=Object.assign,K={};function O(R,J,me){this.props=R,this.context=J,this.refs=K,this.updater=me||U}O.prototype.isReactComponent={},O.prototype.setState=function(R,J){if(typeof R!="object"&&typeof R!="function"&&R!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,R,J,"setState")},O.prototype.forceUpdate=function(R){this.updater.enqueueForceUpdate(this,R,"forceUpdate")};function re(){}re.prototype=O.prototype;function ye(R,J,me){this.props=R,this.context=J,this.refs=K,this.updater=me||U}var ne=ye.prototype=new re;ne.constructor=ye,G(ne,O.prototype),ne.isPureReactComponent=!0;var oe=Array.isArray,Ee=Object.prototype.hasOwnProperty,Se={current:null},b={key:!0,ref:!0,__self:!0,__source:!0};function A(R,J,me){var ie,Te={},Ce=null,Ze=null;if(J!=null)for(ie in J.ref!==void 0&&(Ze=J.ref),J.key!==void 0&&(Ce=""+J.key),J)Ee.call(J,ie)&&!b.hasOwnProperty(ie)&&(Te[ie]=J[ie]);var Ke=arguments.length-2;if(Ke===1)Te.children=me;else if(1<Ke){for(var ot=Array(Ke),jt=0;jt<Ke;jt++)ot[jt]=arguments[jt+2];Te.children=ot}if(R&&R.defaultProps)for(ie in Ke=R.defaultProps,Ke)Te[ie]===void 0&&(Te[ie]=Ke[ie]);return{$$typeof:n,type:R,key:Ce,ref:Ze,props:Te,_owner:Se.current}}function k(R,J){return{$$typeof:n,type:R.type,key:J,ref:R.ref,props:R.props,_owner:R._owner}}function V(R){return typeof R=="object"&&R!==null&&R.$$typeof===n}function F(R){var J={"=":"=0",":":"=2"};return"$"+R.replace(/[=:]/g,function(me){return J[me]})}var D=/\/+/g;function I(R,J){return typeof R=="object"&&R!==null&&R.key!=null?F(""+R.key):J.toString(36)}function ge(R,J,me,ie,Te){var Ce=typeof R;(Ce==="undefined"||Ce==="boolean")&&(R=null);var Ze=!1;if(R===null)Ze=!0;else switch(Ce){case"string":case"number":Ze=!0;break;case"object":switch(R.$$typeof){case n:case e:Ze=!0}}if(Ze)return Ze=R,Te=Te(Ze),R=ie===""?"."+I(Ze,0):ie,oe(Te)?(me="",R!=null&&(me=R.replace(D,"$&/")+"/"),ge(Te,J,me,"",function(jt){return jt})):Te!=null&&(V(Te)&&(Te=k(Te,me+(!Te.key||Ze&&Ze.key===Te.key?"":(""+Te.key).replace(D,"$&/")+"/")+R)),J.push(Te)),1;if(Ze=0,ie=ie===""?".":ie+":",oe(R))for(var Ke=0;Ke<R.length;Ke++){Ce=R[Ke];var ot=ie+I(Ce,Ke);Ze+=ge(Ce,J,me,ot,Te)}else if(ot=C(R),typeof ot=="function")for(R=ot.call(R),Ke=0;!(Ce=R.next()).done;)Ce=Ce.value,ot=ie+I(Ce,Ke++),Ze+=ge(Ce,J,me,ot,Te);else if(Ce==="object")throw J=String(R),Error("Objects are not valid as a React child (found: "+(J==="[object Object]"?"object with keys {"+Object.keys(R).join(", ")+"}":J)+"). If you meant to render a collection of children, use an array instead.");return Ze}function ve(R,J,me){if(R==null)return R;var ie=[],Te=0;return ge(R,ie,"","",function(Ce){return J.call(me,Ce,Te++)}),ie}function lt(R){if(R._status===-1){var J=R._result;J=J(),J.then(function(me){(R._status===0||R._status===-1)&&(R._status=1,R._result=me)},function(me){(R._status===0||R._status===-1)&&(R._status=2,R._result=me)}),R._status===-1&&(R._status=0,R._result=J)}if(R._status===1)return R._result.default;throw R._result}var Be={current:null},L={transition:null},ee={ReactCurrentDispatcher:Be,ReactCurrentBatchConfig:L,ReactCurrentOwner:Se};function se(){throw Error("act(...) is not supported in production builds of React.")}return at.Children={map:ve,forEach:function(R,J,me){ve(R,function(){J.apply(this,arguments)},me)},count:function(R){var J=0;return ve(R,function(){J++}),J},toArray:function(R){return ve(R,function(J){return J})||[]},only:function(R){if(!V(R))throw Error("React.Children.only expected to receive a single React element child.");return R}},at.Component=O,at.Fragment=t,at.Profiler=a,at.PureComponent=ye,at.StrictMode=s,at.Suspense=m,at.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ee,at.act=se,at.cloneElement=function(R,J,me){if(R==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+R+".");var ie=G({},R.props),Te=R.key,Ce=R.ref,Ze=R._owner;if(J!=null){if(J.ref!==void 0&&(Ce=J.ref,Ze=Se.current),J.key!==void 0&&(Te=""+J.key),R.type&&R.type.defaultProps)var Ke=R.type.defaultProps;for(ot in J)Ee.call(J,ot)&&!b.hasOwnProperty(ot)&&(ie[ot]=J[ot]===void 0&&Ke!==void 0?Ke[ot]:J[ot])}var ot=arguments.length-2;if(ot===1)ie.children=me;else if(1<ot){Ke=Array(ot);for(var jt=0;jt<ot;jt++)Ke[jt]=arguments[jt+2];ie.children=Ke}return{$$typeof:n,type:R.type,key:Te,ref:Ce,props:ie,_owner:Ze}},at.createContext=function(R){return R={$$typeof:d,_currentValue:R,_currentValue2:R,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},R.Provider={$$typeof:l,_context:R},R.Consumer=R},at.createElement=A,at.createFactory=function(R){var J=A.bind(null,R);return J.type=R,J},at.createRef=function(){return{current:null}},at.forwardRef=function(R){return{$$typeof:f,render:R}},at.isValidElement=V,at.lazy=function(R){return{$$typeof:w,_payload:{_status:-1,_result:R},_init:lt}},at.memo=function(R,J){return{$$typeof:v,type:R,compare:J===void 0?null:J}},at.startTransition=function(R){var J=L.transition;L.transition={};try{R()}finally{L.transition=J}},at.unstable_act=se,at.useCallback=function(R,J){return Be.current.useCallback(R,J)},at.useContext=function(R){return Be.current.useContext(R)},at.useDebugValue=function(){},at.useDeferredValue=function(R){return Be.current.useDeferredValue(R)},at.useEffect=function(R,J){return Be.current.useEffect(R,J)},at.useId=function(){return Be.current.useId()},at.useImperativeHandle=function(R,J,me){return Be.current.useImperativeHandle(R,J,me)},at.useInsertionEffect=function(R,J){return Be.current.useInsertionEffect(R,J)},at.useLayoutEffect=function(R,J){return Be.current.useLayoutEffect(R,J)},at.useMemo=function(R,J){return Be.current.useMemo(R,J)},at.useReducer=function(R,J,me){return Be.current.useReducer(R,J,me)},at.useRef=function(R){return Be.current.useRef(R)},at.useState=function(R){return Be.current.useState(R)},at.useSyncExternalStore=function(R,J,me){return Be.current.useSyncExternalStore(R,J,me)},at.useTransition=function(){return Be.current.useTransition()},at.version="18.3.1",at}var Fg;function kf(){return Fg||(Fg=1,Oh.exports=Fx()),Oh.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ug;function Ux(){if(Ug)return ul;Ug=1;var n=kf(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,a=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function d(f,m,v){var w,E={},C=null,U=null;v!==void 0&&(C=""+v),m.key!==void 0&&(C=""+m.key),m.ref!==void 0&&(U=m.ref);for(w in m)s.call(m,w)&&!l.hasOwnProperty(w)&&(E[w]=m[w]);if(f&&f.defaultProps)for(w in m=f.defaultProps,m)E[w]===void 0&&(E[w]=m[w]);return{$$typeof:e,type:f,key:C,ref:U,props:E,_owner:a.current}}return ul.Fragment=t,ul.jsx=d,ul.jsxs=d,ul}var zg;function zx(){return zg||(zg=1,Vh.exports=Ux()),Vh.exports}var c=zx(),j=kf();const Wv=$v(j),Bx=Mx({__proto__:null,default:Wv},[j]);var ru={},Mh={exports:{}},ur={},Fh={exports:{}},Uh={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bg;function $x(){return Bg||(Bg=1,(function(n){function e(L,ee){var se=L.length;L.push(ee);e:for(;0<se;){var R=se-1>>>1,J=L[R];if(0<a(J,ee))L[R]=ee,L[se]=J,se=R;else break e}}function t(L){return L.length===0?null:L[0]}function s(L){if(L.length===0)return null;var ee=L[0],se=L.pop();if(se!==ee){L[0]=se;e:for(var R=0,J=L.length,me=J>>>1;R<me;){var ie=2*(R+1)-1,Te=L[ie],Ce=ie+1,Ze=L[Ce];if(0>a(Te,se))Ce<J&&0>a(Ze,Te)?(L[R]=Ze,L[Ce]=se,R=Ce):(L[R]=Te,L[ie]=se,R=ie);else if(Ce<J&&0>a(Ze,se))L[R]=Ze,L[Ce]=se,R=Ce;else break e}}return ee}function a(L,ee){var se=L.sortIndex-ee.sortIndex;return se!==0?se:L.id-ee.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;n.unstable_now=function(){return l.now()}}else{var d=Date,f=d.now();n.unstable_now=function(){return d.now()-f}}var m=[],v=[],w=1,E=null,C=3,U=!1,G=!1,K=!1,O=typeof setTimeout=="function"?setTimeout:null,re=typeof clearTimeout=="function"?clearTimeout:null,ye=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function ne(L){for(var ee=t(v);ee!==null;){if(ee.callback===null)s(v);else if(ee.startTime<=L)s(v),ee.sortIndex=ee.expirationTime,e(m,ee);else break;ee=t(v)}}function oe(L){if(K=!1,ne(L),!G)if(t(m)!==null)G=!0,lt(Ee);else{var ee=t(v);ee!==null&&Be(oe,ee.startTime-L)}}function Ee(L,ee){G=!1,K&&(K=!1,re(A),A=-1),U=!0;var se=C;try{for(ne(ee),E=t(m);E!==null&&(!(E.expirationTime>ee)||L&&!F());){var R=E.callback;if(typeof R=="function"){E.callback=null,C=E.priorityLevel;var J=R(E.expirationTime<=ee);ee=n.unstable_now(),typeof J=="function"?E.callback=J:E===t(m)&&s(m),ne(ee)}else s(m);E=t(m)}if(E!==null)var me=!0;else{var ie=t(v);ie!==null&&Be(oe,ie.startTime-ee),me=!1}return me}finally{E=null,C=se,U=!1}}var Se=!1,b=null,A=-1,k=5,V=-1;function F(){return!(n.unstable_now()-V<k)}function D(){if(b!==null){var L=n.unstable_now();V=L;var ee=!0;try{ee=b(!0,L)}finally{ee?I():(Se=!1,b=null)}}else Se=!1}var I;if(typeof ye=="function")I=function(){ye(D)};else if(typeof MessageChannel<"u"){var ge=new MessageChannel,ve=ge.port2;ge.port1.onmessage=D,I=function(){ve.postMessage(null)}}else I=function(){O(D,0)};function lt(L){b=L,Se||(Se=!0,I())}function Be(L,ee){A=O(function(){L(n.unstable_now())},ee)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(L){L.callback=null},n.unstable_continueExecution=function(){G||U||(G=!0,lt(Ee))},n.unstable_forceFrameRate=function(L){0>L||125<L?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<L?Math.floor(1e3/L):5},n.unstable_getCurrentPriorityLevel=function(){return C},n.unstable_getFirstCallbackNode=function(){return t(m)},n.unstable_next=function(L){switch(C){case 1:case 2:case 3:var ee=3;break;default:ee=C}var se=C;C=ee;try{return L()}finally{C=se}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(L,ee){switch(L){case 1:case 2:case 3:case 4:case 5:break;default:L=3}var se=C;C=L;try{return ee()}finally{C=se}},n.unstable_scheduleCallback=function(L,ee,se){var R=n.unstable_now();switch(typeof se=="object"&&se!==null?(se=se.delay,se=typeof se=="number"&&0<se?R+se:R):se=R,L){case 1:var J=-1;break;case 2:J=250;break;case 5:J=1073741823;break;case 4:J=1e4;break;default:J=5e3}return J=se+J,L={id:w++,callback:ee,priorityLevel:L,startTime:se,expirationTime:J,sortIndex:-1},se>R?(L.sortIndex=se,e(v,L),t(m)===null&&L===t(v)&&(K?(re(A),A=-1):K=!0,Be(oe,se-R))):(L.sortIndex=J,e(m,L),G||U||(G=!0,lt(Ee))),L},n.unstable_shouldYield=F,n.unstable_wrapCallback=function(L){var ee=C;return function(){var se=C;C=ee;try{return L.apply(this,arguments)}finally{C=se}}}})(Uh)),Uh}var $g;function Wx(){return $g||($g=1,Fh.exports=$x()),Fh.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wg;function Hx(){if(Wg)return ur;Wg=1;var n=kf(),e=Wx();function t(r){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+r,o=1;o<arguments.length;o++)i+="&args[]="+encodeURIComponent(arguments[o]);return"Minified React error #"+r+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,a={};function l(r,i){d(r,i),d(r+"Capture",i)}function d(r,i){for(a[r]=i,r=0;r<i.length;r++)s.add(i[r])}var f=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),m=Object.prototype.hasOwnProperty,v=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,w={},E={};function C(r){return m.call(E,r)?!0:m.call(w,r)?!1:v.test(r)?E[r]=!0:(w[r]=!0,!1)}function U(r,i,o,h){if(o!==null&&o.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return h?!1:o!==null?!o.acceptsBooleans:(r=r.toLowerCase().slice(0,5),r!=="data-"&&r!=="aria-");default:return!1}}function G(r,i,o,h){if(i===null||typeof i>"u"||U(r,i,o,h))return!0;if(h)return!1;if(o!==null)switch(o.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function K(r,i,o,h,p,y,x){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=h,this.attributeNamespace=p,this.mustUseProperty=o,this.propertyName=r,this.type=i,this.sanitizeURL=y,this.removeEmptyString=x}var O={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(r){O[r]=new K(r,0,!1,r,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(r){var i=r[0];O[i]=new K(i,1,!1,r[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(r){O[r]=new K(r,2,!1,r.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(r){O[r]=new K(r,2,!1,r,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(r){O[r]=new K(r,3,!1,r.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(r){O[r]=new K(r,3,!0,r,null,!1,!1)}),["capture","download"].forEach(function(r){O[r]=new K(r,4,!1,r,null,!1,!1)}),["cols","rows","size","span"].forEach(function(r){O[r]=new K(r,6,!1,r,null,!1,!1)}),["rowSpan","start"].forEach(function(r){O[r]=new K(r,5,!1,r.toLowerCase(),null,!1,!1)});var re=/[\-:]([a-z])/g;function ye(r){return r[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(r){var i=r.replace(re,ye);O[i]=new K(i,1,!1,r,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(r){var i=r.replace(re,ye);O[i]=new K(i,1,!1,r,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(r){var i=r.replace(re,ye);O[i]=new K(i,1,!1,r,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(r){O[r]=new K(r,1,!1,r.toLowerCase(),null,!1,!1)}),O.xlinkHref=new K("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(r){O[r]=new K(r,1,!1,r.toLowerCase(),null,!0,!0)});function ne(r,i,o,h){var p=O.hasOwnProperty(i)?O[i]:null;(p!==null?p.type!==0:h||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(G(i,o,p,h)&&(o=null),h||p===null?C(i)&&(o===null?r.removeAttribute(i):r.setAttribute(i,""+o)):p.mustUseProperty?r[p.propertyName]=o===null?p.type===3?!1:"":o:(i=p.attributeName,h=p.attributeNamespace,o===null?r.removeAttribute(i):(p=p.type,o=p===3||p===4&&o===!0?"":""+o,h?r.setAttributeNS(h,i,o):r.setAttribute(i,o))))}var oe=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ee=Symbol.for("react.element"),Se=Symbol.for("react.portal"),b=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),V=Symbol.for("react.provider"),F=Symbol.for("react.context"),D=Symbol.for("react.forward_ref"),I=Symbol.for("react.suspense"),ge=Symbol.for("react.suspense_list"),ve=Symbol.for("react.memo"),lt=Symbol.for("react.lazy"),Be=Symbol.for("react.offscreen"),L=Symbol.iterator;function ee(r){return r===null||typeof r!="object"?null:(r=L&&r[L]||r["@@iterator"],typeof r=="function"?r:null)}var se=Object.assign,R;function J(r){if(R===void 0)try{throw Error()}catch(o){var i=o.stack.trim().match(/\n( *(at )?)/);R=i&&i[1]||""}return`
`+R+r}var me=!1;function ie(r,i){if(!r||me)return"";me=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(X){var h=X}Reflect.construct(r,[],i)}else{try{i.call()}catch(X){h=X}r.call(i.prototype)}else{try{throw Error()}catch(X){h=X}r()}}catch(X){if(X&&h&&typeof X.stack=="string"){for(var p=X.stack.split(`
`),y=h.stack.split(`
`),x=p.length-1,N=y.length-1;1<=x&&0<=N&&p[x]!==y[N];)N--;for(;1<=x&&0<=N;x--,N--)if(p[x]!==y[N]){if(x!==1||N!==1)do if(x--,N--,0>N||p[x]!==y[N]){var M=`
`+p[x].replace(" at new "," at ");return r.displayName&&M.includes("<anonymous>")&&(M=M.replace("<anonymous>",r.displayName)),M}while(1<=x&&0<=N);break}}}finally{me=!1,Error.prepareStackTrace=o}return(r=r?r.displayName||r.name:"")?J(r):""}function Te(r){switch(r.tag){case 5:return J(r.type);case 16:return J("Lazy");case 13:return J("Suspense");case 19:return J("SuspenseList");case 0:case 2:case 15:return r=ie(r.type,!1),r;case 11:return r=ie(r.type.render,!1),r;case 1:return r=ie(r.type,!0),r;default:return""}}function Ce(r){if(r==null)return null;if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case b:return"Fragment";case Se:return"Portal";case k:return"Profiler";case A:return"StrictMode";case I:return"Suspense";case ge:return"SuspenseList"}if(typeof r=="object")switch(r.$$typeof){case F:return(r.displayName||"Context")+".Consumer";case V:return(r._context.displayName||"Context")+".Provider";case D:var i=r.render;return r=r.displayName,r||(r=i.displayName||i.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case ve:return i=r.displayName||null,i!==null?i:Ce(r.type)||"Memo";case lt:i=r._payload,r=r._init;try{return Ce(r(i))}catch{}}return null}function Ze(r){var i=r.type;switch(r.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return r=i.render,r=r.displayName||r.name||"",i.displayName||(r!==""?"ForwardRef("+r+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ce(i);case 8:return i===A?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function Ke(r){switch(typeof r){case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function ot(r){var i=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function jt(r){var i=ot(r)?"checked":"value",o=Object.getOwnPropertyDescriptor(r.constructor.prototype,i),h=""+r[i];if(!r.hasOwnProperty(i)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var p=o.get,y=o.set;return Object.defineProperty(r,i,{configurable:!0,get:function(){return p.call(this)},set:function(x){h=""+x,y.call(this,x)}}),Object.defineProperty(r,i,{enumerable:o.enumerable}),{getValue:function(){return h},setValue:function(x){h=""+x},stopTracking:function(){r._valueTracker=null,delete r[i]}}}}function de(r){r._valueTracker||(r._valueTracker=jt(r))}function ke(r){if(!r)return!1;var i=r._valueTracker;if(!i)return!0;var o=i.getValue(),h="";return r&&(h=ot(r)?r.checked?"true":"false":r.value),r=h,r!==o?(i.setValue(r),!0):!1}function Me(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}function Ue(r,i){var o=i.checked;return se({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:o??r._wrapperState.initialChecked})}function Tt(r,i){var o=i.defaultValue==null?"":i.defaultValue,h=i.checked!=null?i.checked:i.defaultChecked;o=Ke(i.value!=null?i.value:o),r._wrapperState={initialChecked:h,initialValue:o,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function Ct(r,i){i=i.checked,i!=null&&ne(r,"checked",i,!1)}function Pt(r,i){Ct(r,i);var o=Ke(i.value),h=i.type;if(o!=null)h==="number"?(o===0&&r.value===""||r.value!=o)&&(r.value=""+o):r.value!==""+o&&(r.value=""+o);else if(h==="submit"||h==="reset"){r.removeAttribute("value");return}i.hasOwnProperty("value")?zt(r,i.type,o):i.hasOwnProperty("defaultValue")&&zt(r,i.type,Ke(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(r.defaultChecked=!!i.defaultChecked)}function bt(r,i,o){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var h=i.type;if(!(h!=="submit"&&h!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+r._wrapperState.initialValue,o||i===r.value||(r.value=i),r.defaultValue=i}o=r.name,o!==""&&(r.name=""),r.defaultChecked=!!r._wrapperState.initialChecked,o!==""&&(r.name=o)}function zt(r,i,o){(i!=="number"||Me(r.ownerDocument)!==r)&&(o==null?r.defaultValue=""+r._wrapperState.initialValue:r.defaultValue!==""+o&&(r.defaultValue=""+o))}var St=Array.isArray;function Sn(r,i,o,h){if(r=r.options,i){i={};for(var p=0;p<o.length;p++)i["$"+o[p]]=!0;for(o=0;o<r.length;o++)p=i.hasOwnProperty("$"+r[o].value),r[o].selected!==p&&(r[o].selected=p),p&&h&&(r[o].defaultSelected=!0)}else{for(o=""+Ke(o),i=null,p=0;p<r.length;p++){if(r[p].value===o){r[p].selected=!0,h&&(r[p].defaultSelected=!0);return}i!==null||r[p].disabled||(i=r[p])}i!==null&&(i.selected=!0)}}function ln(r,i){if(i.dangerouslySetInnerHTML!=null)throw Error(t(91));return se({},i,{value:void 0,defaultValue:void 0,children:""+r._wrapperState.initialValue})}function vn(r,i){var o=i.value;if(o==null){if(o=i.children,i=i.defaultValue,o!=null){if(i!=null)throw Error(t(92));if(St(o)){if(1<o.length)throw Error(t(93));o=o[0]}i=o}i==null&&(i=""),o=i}r._wrapperState={initialValue:Ke(o)}}function Qt(r,i){var o=Ke(i.value),h=Ke(i.defaultValue);o!=null&&(o=""+o,o!==r.value&&(r.value=o),i.defaultValue==null&&r.defaultValue!==o&&(r.defaultValue=o)),h!=null&&(r.defaultValue=""+h)}function Mr(r){var i=r.textContent;i===r._wrapperState.initialValue&&i!==""&&i!==null&&(r.value=i)}function Bt(r){switch(r){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Qe(r,i){return r==null||r==="http://www.w3.org/1999/xhtml"?Bt(i):r==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":r}var nr,bs=(function(r){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,o,h,p){MSApp.execUnsafeLocalFunction(function(){return r(i,o,h,p)})}:r})(function(r,i){if(r.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in r)r.innerHTML=i;else{for(nr=nr||document.createElement("div"),nr.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=nr.firstChild;r.firstChild;)r.removeChild(r.firstChild);for(;i.firstChild;)r.appendChild(i.firstChild)}});function fr(r,i){if(i){var o=r.firstChild;if(o&&o===r.lastChild&&o.nodeType===3){o.nodeValue=i;return}}r.textContent=i}var pr={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Kn=["Webkit","ms","Moz","O"];Object.keys(pr).forEach(function(r){Kn.forEach(function(i){i=i+r.charAt(0).toUpperCase()+r.substring(1),pr[i]=pr[r]})});function ss(r,i,o){return i==null||typeof i=="boolean"||i===""?"":o||typeof i!="number"||i===0||pr.hasOwnProperty(r)&&pr[r]?(""+i).trim():i+"px"}function In(r,i){r=r.style;for(var o in i)if(i.hasOwnProperty(o)){var h=o.indexOf("--")===0,p=ss(o,i[o],h);o==="float"&&(o="cssFloat"),h?r.setProperty(o,p):r[o]=p}}var is=se({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Rs(r,i){if(i){if(is[r]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(t(137,r));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(t(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(t(61))}if(i.style!=null&&typeof i.style!="object")throw Error(t(62))}}function As(r,i){if(r.indexOf("-")===-1)return typeof i.is=="string";switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var cn=null;function ct(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var mr=null,Dn=null,en=null;function un(r){if(r=Qo(r)){if(typeof mr!="function")throw Error(t(280));var i=r.stateNode;i&&(i=vc(i),mr(r.stateNode,r.type,i))}}function dn(r){Dn?en?en.push(r):en=[r]:Dn=r}function Fr(){if(Dn){var r=Dn,i=en;if(en=Dn=null,un(r),i)for(r=0;r<i.length;r++)un(i[r])}}function Sr(r,i){return r(i)}function as(){}var Qn=!1;function Ln(r,i,o){if(Qn)return r(i,o);Qn=!0;try{return Sr(r,i,o)}finally{Qn=!1,(Dn!==null||en!==null)&&(as(),Fr())}}function _t(r,i){var o=r.stateNode;if(o===null)return null;var h=vc(o);if(h===null)return null;o=h[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(r=r.type,h=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!h;break e;default:r=!1}if(r)return null;if(o&&typeof o!="function")throw Error(t(231,i,typeof o));return o}var qt=!1;if(f)try{var Yt={};Object.defineProperty(Yt,"passive",{get:function(){qt=!0}}),window.addEventListener("test",Yt,Yt),window.removeEventListener("test",Yt,Yt)}catch{qt=!1}function P(r,i,o,h,p,y,x,N,M){var X=Array.prototype.slice.call(arguments,3);try{i.apply(o,X)}catch(he){this.onError(he)}}var Z=!1,le=null,$=!1,Y=null,Le={onError:function(r){Z=!0,le=r}};function Oe(r,i,o,h,p,y,x,N,M){Z=!1,le=null,P.apply(Le,arguments)}function Rt(r,i,o,h,p,y,x,N,M){if(Oe.apply(this,arguments),Z){if(Z){var X=le;Z=!1,le=null}else throw Error(t(198));$||($=!0,Y=X)}}function xe(r){var i=r,o=r;if(r.alternate)for(;i.return;)i=i.return;else{r=i;do i=r,(i.flags&4098)!==0&&(o=i.return),r=i.return;while(r)}return i.tag===3?o:null}function Ye(r){if(r.tag===13){var i=r.memoizedState;if(i===null&&(r=r.alternate,r!==null&&(i=r.memoizedState)),i!==null)return i.dehydrated}return null}function mt(r){if(xe(r)!==r)throw Error(t(188))}function Cn(r){var i=r.alternate;if(!i){if(i=xe(r),i===null)throw Error(t(188));return i!==r?null:r}for(var o=r,h=i;;){var p=o.return;if(p===null)break;var y=p.alternate;if(y===null){if(h=p.return,h!==null){o=h;continue}break}if(p.child===y.child){for(y=p.child;y;){if(y===o)return mt(p),r;if(y===h)return mt(p),i;y=y.sibling}throw Error(t(188))}if(o.return!==h.return)o=p,h=y;else{for(var x=!1,N=p.child;N;){if(N===o){x=!0,o=p,h=y;break}if(N===h){x=!0,h=p,o=y;break}N=N.sibling}if(!x){for(N=y.child;N;){if(N===o){x=!0,o=y,h=p;break}if(N===h){x=!0,h=y,o=p;break}N=N.sibling}if(!x)throw Error(t(189))}}if(o.alternate!==h)throw Error(t(190))}if(o.tag!==3)throw Error(t(188));return o.stateNode.current===o?r:i}function Vn(r){return r=Cn(r),r!==null?Ur(r):null}function Ur(r){if(r.tag===5||r.tag===6)return r;for(r=r.child;r!==null;){var i=Ur(r);if(i!==null)return i;r=r.sibling}return null}var gt=e.unstable_scheduleCallback,gr=e.unstable_cancelCallback,Yn=e.unstable_shouldYield,Ir=e.unstable_requestPaint,vt=e.unstable_now,Ki=e.unstable_getCurrentPriorityLevel,Ns=e.unstable_ImmediatePriority,On=e.unstable_UserBlockingPriority,Jn=e.unstable_NormalPriority,Qi=e.unstable_LowPriority,Ca=e.unstable_IdlePriority,ks=null,S=null;function B(r){if(S&&typeof S.onCommitFiberRoot=="function")try{S.onCommitFiberRoot(ks,r,void 0,(r.current.flags&128)===128)}catch{}}var W=Math.clz32?Math.clz32:Fe,pe=Math.log,Pe=Math.LN2;function Fe(r){return r>>>=0,r===0?32:31-(pe(r)/Pe|0)|0}var Ie=64,et=4194304;function wt(r){switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return r&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return r}}function xt(r,i){var o=r.pendingLanes;if(o===0)return 0;var h=0,p=r.suspendedLanes,y=r.pingedLanes,x=o&268435455;if(x!==0){var N=x&~p;N!==0?h=wt(N):(y&=x,y!==0&&(h=wt(y)))}else x=o&~p,x!==0?h=wt(x):y!==0&&(h=wt(y));if(h===0)return 0;if(i!==0&&i!==h&&(i&p)===0&&(p=h&-h,y=i&-i,p>=y||p===16&&(y&4194240)!==0))return i;if((h&4)!==0&&(h|=o&16),i=r.entangledLanes,i!==0)for(r=r.entanglements,i&=h;0<i;)o=31-W(i),p=1<<o,h|=r[o],i&=~p;return h}function hn(r,i){switch(r){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Nt(r,i){for(var o=r.suspendedLanes,h=r.pingedLanes,p=r.expirationTimes,y=r.pendingLanes;0<y;){var x=31-W(y),N=1<<x,M=p[x];M===-1?((N&o)===0||(N&h)!==0)&&(p[x]=hn(N,i)):M<=i&&(r.expiredLanes|=N),y&=~N}}function Mt(r){return r=r.pendingLanes&-1073741825,r!==0?r:r&1073741824?1073741824:0}function $t(){var r=Ie;return Ie<<=1,(Ie&4194240)===0&&(Ie=64),r}function it(r){for(var i=[],o=0;31>o;o++)i.push(r);return i}function Xn(r,i,o){r.pendingLanes|=i,i!==536870912&&(r.suspendedLanes=0,r.pingedLanes=0),r=r.eventTimes,i=31-W(i),r[i]=o}function nt(r,i){var o=r.pendingLanes&~i;r.pendingLanes=i,r.suspendedLanes=0,r.pingedLanes=0,r.expiredLanes&=i,r.mutableReadLanes&=i,r.entangledLanes&=i,i=r.entanglements;var h=r.eventTimes;for(r=r.expirationTimes;0<o;){var p=31-W(o),y=1<<p;i[p]=0,h[p]=-1,r[p]=-1,o&=~y}}function Mn(r,i){var o=r.entangledLanes|=i;for(r=r.entanglements;o;){var h=31-W(o),p=1<<h;p&i|r[h]&i&&(r[h]|=i),o&=~p}}var rt=0;function os(r){return r&=-r,1<r?4<r?(r&268435455)!==0?16:536870912:4:1}var Pa,ri,ls,ba,ec,Do=!1,cs=[],Pn=null,zr=null,Br=null,si=new Map,Cr=new Map,us=[],fd="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function tc(r,i){switch(r){case"focusin":case"focusout":Pn=null;break;case"dragenter":case"dragleave":zr=null;break;case"mouseover":case"mouseout":Br=null;break;case"pointerover":case"pointerout":si.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Cr.delete(i.pointerId)}}function rr(r,i,o,h,p,y){return r===null||r.nativeEvent!==y?(r={blockedOn:i,domEventName:o,eventSystemFlags:h,nativeEvent:y,targetContainers:[p]},i!==null&&(i=Qo(i),i!==null&&ri(i)),r):(r.eventSystemFlags|=h,i=r.targetContainers,p!==null&&i.indexOf(p)===-1&&i.push(p),r)}function pd(r,i,o,h,p){switch(i){case"focusin":return Pn=rr(Pn,r,i,o,h,p),!0;case"dragenter":return zr=rr(zr,r,i,o,h,p),!0;case"mouseover":return Br=rr(Br,r,i,o,h,p),!0;case"pointerover":var y=p.pointerId;return si.set(y,rr(si.get(y)||null,r,i,o,h,p)),!0;case"gotpointercapture":return y=p.pointerId,Cr.set(y,rr(Cr.get(y)||null,r,i,o,h,p)),!0}return!1}function nc(r){var i=ea(r.target);if(i!==null){var o=xe(i);if(o!==null){if(i=o.tag,i===13){if(i=Ye(o),i!==null){r.blockedOn=i,ec(r.priority,function(){ls(o)});return}}else if(i===3&&o.stateNode.current.memoizedState.isDehydrated){r.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}r.blockedOn=null}function js(r){if(r.blockedOn!==null)return!1;for(var i=r.targetContainers;0<i.length;){var o=Ra(r.domEventName,r.eventSystemFlags,i[0],r.nativeEvent);if(o===null){o=r.nativeEvent;var h=new o.constructor(o.type,o);cn=h,o.target.dispatchEvent(h),cn=null}else return i=Qo(o),i!==null&&ri(i),r.blockedOn=o,!1;i.shift()}return!0}function Yi(r,i,o){js(r)&&o.delete(i)}function rc(){Do=!1,Pn!==null&&js(Pn)&&(Pn=null),zr!==null&&js(zr)&&(zr=null),Br!==null&&js(Br)&&(Br=null),si.forEach(Yi),Cr.forEach(Yi)}function $r(r,i){r.blockedOn===i&&(r.blockedOn=null,Do||(Do=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,rc)))}function Wr(r){function i(p){return $r(p,r)}if(0<cs.length){$r(cs[0],r);for(var o=1;o<cs.length;o++){var h=cs[o];h.blockedOn===r&&(h.blockedOn=null)}}for(Pn!==null&&$r(Pn,r),zr!==null&&$r(zr,r),Br!==null&&$r(Br,r),si.forEach(i),Cr.forEach(i),o=0;o<us.length;o++)h=us[o],h.blockedOn===r&&(h.blockedOn=null);for(;0<us.length&&(o=us[0],o.blockedOn===null);)nc(o),o.blockedOn===null&&us.shift()}var Ds=oe.ReactCurrentBatchConfig,ii=!0;function Ft(r,i,o,h){var p=rt,y=Ds.transition;Ds.transition=null;try{rt=1,Lo(r,i,o,h)}finally{rt=p,Ds.transition=y}}function md(r,i,o,h){var p=rt,y=Ds.transition;Ds.transition=null;try{rt=4,Lo(r,i,o,h)}finally{rt=p,Ds.transition=y}}function Lo(r,i,o,h){if(ii){var p=Ra(r,i,o,h);if(p===null)Cd(r,i,h,Ji,o),tc(r,h);else if(pd(p,r,i,o,h))h.stopPropagation();else if(tc(r,h),i&4&&-1<fd.indexOf(r)){for(;p!==null;){var y=Qo(p);if(y!==null&&Pa(y),y=Ra(r,i,o,h),y===null&&Cd(r,i,h,Ji,o),y===p)break;p=y}p!==null&&h.stopPropagation()}else Cd(r,i,h,null,o)}}var Ji=null;function Ra(r,i,o,h){if(Ji=null,r=ct(h),r=ea(r),r!==null)if(i=xe(r),i===null)r=null;else if(o=i.tag,o===13){if(r=Ye(i),r!==null)return r;r=null}else if(o===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;r=null}else i!==r&&(r=null);return Ji=r,null}function Vo(r){switch(r){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ki()){case Ns:return 1;case On:return 4;case Jn:case Qi:return 16;case Ca:return 536870912;default:return 16}default:return 16}}var yr=null,Aa=null,sr=null;function Oo(){if(sr)return sr;var r,i=Aa,o=i.length,h,p="value"in yr?yr.value:yr.textContent,y=p.length;for(r=0;r<o&&i[r]===p[r];r++);var x=o-r;for(h=1;h<=x&&i[o-h]===p[y-h];h++);return sr=p.slice(r,1<h?1-h:void 0)}function Na(r){var i=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&i===13&&(r=13)):r=i,r===10&&(r=13),32<=r||r===13?r:0}function ds(){return!0}function Mo(){return!1}function bn(r){function i(o,h,p,y,x){this._reactName=o,this._targetInst=p,this.type=h,this.nativeEvent=y,this.target=x,this.currentTarget=null;for(var N in r)r.hasOwnProperty(N)&&(o=r[N],this[N]=o?o(y):y[N]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?ds:Mo,this.isPropagationStopped=Mo,this}return se(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=ds)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=ds)},persist:function(){},isPersistent:ds}),i}var Hr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ka=bn(Hr),hs=se({},Hr,{view:0,detail:0}),gd=bn(hs),ja,Ls,ai,Xi=se({},hs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:fs,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==ai&&(ai&&r.type==="mousemove"?(ja=r.screenX-ai.screenX,Ls=r.screenY-ai.screenY):Ls=ja=0,ai=r),ja)},movementY:function(r){return"movementY"in r?r.movementY:Ls}}),Da=bn(Xi),Fo=se({},Xi,{dataTransfer:0}),sc=bn(Fo),La=se({},hs,{relatedTarget:0}),Va=bn(La),ic=se({},Hr,{animationName:0,elapsedTime:0,pseudoElement:0}),Vs=bn(ic),ac=se({},Hr,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),oc=bn(ac),lc=se({},Hr,{data:0}),Uo=bn(lc),Oa={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Zn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},cc={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function uc(r){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(r):(r=cc[r])?!!i[r]:!1}function fs(){return uc}var u=se({},hs,{key:function(r){if(r.key){var i=Oa[r.key]||r.key;if(i!=="Unidentified")return i}return r.type==="keypress"?(r=Na(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?Zn[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:fs,charCode:function(r){return r.type==="keypress"?Na(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?Na(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),g=bn(u),_=se({},Xi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),T=bn(_),H=se({},hs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:fs}),te=bn(H),we=se({},Hr,{propertyName:0,elapsedTime:0,pseudoElement:0}),It=bn(we),fn=se({},Xi,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),ht=bn(fn),_n=[9,13,27,32],tn=f&&"CompositionEvent"in window,Pr=null;f&&"documentMode"in document&&(Pr=document.documentMode);var vr=f&&"TextEvent"in window&&!Pr,Zi=f&&(!tn||Pr&&8<Pr&&11>=Pr),Ma=" ",kp=!1;function jp(r,i){switch(r){case"keyup":return _n.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Dp(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var Fa=!1;function Lw(r,i){switch(r){case"compositionend":return Dp(i);case"keypress":return i.which!==32?null:(kp=!0,Ma);case"textInput":return r=i.data,r===Ma&&kp?null:r;default:return null}}function Vw(r,i){if(Fa)return r==="compositionend"||!tn&&jp(r,i)?(r=Oo(),sr=Aa=yr=null,Fa=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return Zi&&i.locale!=="ko"?null:i.data;default:return null}}var Ow={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Lp(r){var i=r&&r.nodeName&&r.nodeName.toLowerCase();return i==="input"?!!Ow[r.type]:i==="textarea"}function Vp(r,i,o,h){dn(h),i=mc(i,"onChange"),0<i.length&&(o=new ka("onChange","change",null,o,h),r.push({event:o,listeners:i}))}var zo=null,Bo=null;function Mw(r){em(r,0)}function dc(r){var i=Wa(r);if(ke(i))return r}function Fw(r,i){if(r==="change")return i}var Op=!1;if(f){var yd;if(f){var vd="oninput"in document;if(!vd){var Mp=document.createElement("div");Mp.setAttribute("oninput","return;"),vd=typeof Mp.oninput=="function"}yd=vd}else yd=!1;Op=yd&&(!document.documentMode||9<document.documentMode)}function Fp(){zo&&(zo.detachEvent("onpropertychange",Up),Bo=zo=null)}function Up(r){if(r.propertyName==="value"&&dc(Bo)){var i=[];Vp(i,Bo,r,ct(r)),Ln(Mw,i)}}function Uw(r,i,o){r==="focusin"?(Fp(),zo=i,Bo=o,zo.attachEvent("onpropertychange",Up)):r==="focusout"&&Fp()}function zw(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return dc(Bo)}function Bw(r,i){if(r==="click")return dc(i)}function $w(r,i){if(r==="input"||r==="change")return dc(i)}function Ww(r,i){return r===i&&(r!==0||1/r===1/i)||r!==r&&i!==i}var Gr=typeof Object.is=="function"?Object.is:Ww;function $o(r,i){if(Gr(r,i))return!0;if(typeof r!="object"||r===null||typeof i!="object"||i===null)return!1;var o=Object.keys(r),h=Object.keys(i);if(o.length!==h.length)return!1;for(h=0;h<o.length;h++){var p=o[h];if(!m.call(i,p)||!Gr(r[p],i[p]))return!1}return!0}function zp(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function Bp(r,i){var o=zp(r);r=0;for(var h;o;){if(o.nodeType===3){if(h=r+o.textContent.length,r<=i&&h>=i)return{node:o,offset:i-r};r=h}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=zp(o)}}function $p(r,i){return r&&i?r===i?!0:r&&r.nodeType===3?!1:i&&i.nodeType===3?$p(r,i.parentNode):"contains"in r?r.contains(i):r.compareDocumentPosition?!!(r.compareDocumentPosition(i)&16):!1:!1}function Wp(){for(var r=window,i=Me();i instanceof r.HTMLIFrameElement;){try{var o=typeof i.contentWindow.location.href=="string"}catch{o=!1}if(o)r=i.contentWindow;else break;i=Me(r.document)}return i}function _d(r){var i=r&&r.nodeName&&r.nodeName.toLowerCase();return i&&(i==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||i==="textarea"||r.contentEditable==="true")}function Hw(r){var i=Wp(),o=r.focusedElem,h=r.selectionRange;if(i!==o&&o&&o.ownerDocument&&$p(o.ownerDocument.documentElement,o)){if(h!==null&&_d(o)){if(i=h.start,r=h.end,r===void 0&&(r=i),"selectionStart"in o)o.selectionStart=i,o.selectionEnd=Math.min(r,o.value.length);else if(r=(i=o.ownerDocument||document)&&i.defaultView||window,r.getSelection){r=r.getSelection();var p=o.textContent.length,y=Math.min(h.start,p);h=h.end===void 0?y:Math.min(h.end,p),!r.extend&&y>h&&(p=h,h=y,y=p),p=Bp(o,y);var x=Bp(o,h);p&&x&&(r.rangeCount!==1||r.anchorNode!==p.node||r.anchorOffset!==p.offset||r.focusNode!==x.node||r.focusOffset!==x.offset)&&(i=i.createRange(),i.setStart(p.node,p.offset),r.removeAllRanges(),y>h?(r.addRange(i),r.extend(x.node,x.offset)):(i.setEnd(x.node,x.offset),r.addRange(i)))}}for(i=[],r=o;r=r.parentNode;)r.nodeType===1&&i.push({element:r,left:r.scrollLeft,top:r.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<i.length;o++)r=i[o],r.element.scrollLeft=r.left,r.element.scrollTop=r.top}}var Gw=f&&"documentMode"in document&&11>=document.documentMode,Ua=null,wd=null,Wo=null,xd=!1;function Hp(r,i,o){var h=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;xd||Ua==null||Ua!==Me(h)||(h=Ua,"selectionStart"in h&&_d(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),Wo&&$o(Wo,h)||(Wo=h,h=mc(wd,"onSelect"),0<h.length&&(i=new ka("onSelect","select",null,i,o),r.push({event:i,listeners:h}),i.target=Ua)))}function hc(r,i){var o={};return o[r.toLowerCase()]=i.toLowerCase(),o["Webkit"+r]="webkit"+i,o["Moz"+r]="moz"+i,o}var za={animationend:hc("Animation","AnimationEnd"),animationiteration:hc("Animation","AnimationIteration"),animationstart:hc("Animation","AnimationStart"),transitionend:hc("Transition","TransitionEnd")},Ed={},Gp={};f&&(Gp=document.createElement("div").style,"AnimationEvent"in window||(delete za.animationend.animation,delete za.animationiteration.animation,delete za.animationstart.animation),"TransitionEvent"in window||delete za.transitionend.transition);function fc(r){if(Ed[r])return Ed[r];if(!za[r])return r;var i=za[r],o;for(o in i)if(i.hasOwnProperty(o)&&o in Gp)return Ed[r]=i[o];return r}var qp=fc("animationend"),Kp=fc("animationiteration"),Qp=fc("animationstart"),Yp=fc("transitionend"),Jp=new Map,Xp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function oi(r,i){Jp.set(r,i),l(i,[r])}for(var Td=0;Td<Xp.length;Td++){var Sd=Xp[Td],qw=Sd.toLowerCase(),Kw=Sd[0].toUpperCase()+Sd.slice(1);oi(qw,"on"+Kw)}oi(qp,"onAnimationEnd"),oi(Kp,"onAnimationIteration"),oi(Qp,"onAnimationStart"),oi("dblclick","onDoubleClick"),oi("focusin","onFocus"),oi("focusout","onBlur"),oi(Yp,"onTransitionEnd"),d("onMouseEnter",["mouseout","mouseover"]),d("onMouseLeave",["mouseout","mouseover"]),d("onPointerEnter",["pointerout","pointerover"]),d("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ho="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Qw=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ho));function Zp(r,i,o){var h=r.type||"unknown-event";r.currentTarget=o,Rt(h,i,void 0,r),r.currentTarget=null}function em(r,i){i=(i&4)!==0;for(var o=0;o<r.length;o++){var h=r[o],p=h.event;h=h.listeners;e:{var y=void 0;if(i)for(var x=h.length-1;0<=x;x--){var N=h[x],M=N.instance,X=N.currentTarget;if(N=N.listener,M!==y&&p.isPropagationStopped())break e;Zp(p,N,X),y=M}else for(x=0;x<h.length;x++){if(N=h[x],M=N.instance,X=N.currentTarget,N=N.listener,M!==y&&p.isPropagationStopped())break e;Zp(p,N,X),y=M}}}if($)throw r=Y,$=!1,Y=null,r}function Dt(r,i){var o=i[kd];o===void 0&&(o=i[kd]=new Set);var h=r+"__bubble";o.has(h)||(tm(i,r,2,!1),o.add(h))}function Id(r,i,o){var h=0;i&&(h|=4),tm(o,r,h,i)}var pc="_reactListening"+Math.random().toString(36).slice(2);function Go(r){if(!r[pc]){r[pc]=!0,s.forEach(function(o){o!=="selectionchange"&&(Qw.has(o)||Id(o,!1,r),Id(o,!0,r))});var i=r.nodeType===9?r:r.ownerDocument;i===null||i[pc]||(i[pc]=!0,Id("selectionchange",!1,i))}}function tm(r,i,o,h){switch(Vo(i)){case 1:var p=Ft;break;case 4:p=md;break;default:p=Lo}o=p.bind(null,i,o,r),p=void 0,!qt||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(p=!0),h?p!==void 0?r.addEventListener(i,o,{capture:!0,passive:p}):r.addEventListener(i,o,!0):p!==void 0?r.addEventListener(i,o,{passive:p}):r.addEventListener(i,o,!1)}function Cd(r,i,o,h,p){var y=h;if((i&1)===0&&(i&2)===0&&h!==null)e:for(;;){if(h===null)return;var x=h.tag;if(x===3||x===4){var N=h.stateNode.containerInfo;if(N===p||N.nodeType===8&&N.parentNode===p)break;if(x===4)for(x=h.return;x!==null;){var M=x.tag;if((M===3||M===4)&&(M=x.stateNode.containerInfo,M===p||M.nodeType===8&&M.parentNode===p))return;x=x.return}for(;N!==null;){if(x=ea(N),x===null)return;if(M=x.tag,M===5||M===6){h=y=x;continue e}N=N.parentNode}}h=h.return}Ln(function(){var X=y,he=ct(o),fe=[];e:{var ue=Jp.get(r);if(ue!==void 0){var be=ka,Ne=r;switch(r){case"keypress":if(Na(o)===0)break e;case"keydown":case"keyup":be=g;break;case"focusin":Ne="focus",be=Va;break;case"focusout":Ne="blur",be=Va;break;case"beforeblur":case"afterblur":be=Va;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":be=Da;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":be=sc;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":be=te;break;case qp:case Kp:case Qp:be=Vs;break;case Yp:be=It;break;case"scroll":be=gd;break;case"wheel":be=ht;break;case"copy":case"cut":case"paste":be=oc;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":be=T}var je=(i&4)!==0,Jt=!je&&r==="scroll",q=je?ue!==null?ue+"Capture":null:ue;je=[];for(var z=X,Q;z!==null;){Q=z;var _e=Q.stateNode;if(Q.tag===5&&_e!==null&&(Q=_e,q!==null&&(_e=_t(z,q),_e!=null&&je.push(qo(z,_e,Q)))),Jt)break;z=z.return}0<je.length&&(ue=new be(ue,Ne,null,o,he),fe.push({event:ue,listeners:je}))}}if((i&7)===0){e:{if(ue=r==="mouseover"||r==="pointerover",be=r==="mouseout"||r==="pointerout",ue&&o!==cn&&(Ne=o.relatedTarget||o.fromElement)&&(ea(Ne)||Ne[Os]))break e;if((be||ue)&&(ue=he.window===he?he:(ue=he.ownerDocument)?ue.defaultView||ue.parentWindow:window,be?(Ne=o.relatedTarget||o.toElement,be=X,Ne=Ne?ea(Ne):null,Ne!==null&&(Jt=xe(Ne),Ne!==Jt||Ne.tag!==5&&Ne.tag!==6)&&(Ne=null)):(be=null,Ne=X),be!==Ne)){if(je=Da,_e="onMouseLeave",q="onMouseEnter",z="mouse",(r==="pointerout"||r==="pointerover")&&(je=T,_e="onPointerLeave",q="onPointerEnter",z="pointer"),Jt=be==null?ue:Wa(be),Q=Ne==null?ue:Wa(Ne),ue=new je(_e,z+"leave",be,o,he),ue.target=Jt,ue.relatedTarget=Q,_e=null,ea(he)===X&&(je=new je(q,z+"enter",Ne,o,he),je.target=Q,je.relatedTarget=Jt,_e=je),Jt=_e,be&&Ne)t:{for(je=be,q=Ne,z=0,Q=je;Q;Q=Ba(Q))z++;for(Q=0,_e=q;_e;_e=Ba(_e))Q++;for(;0<z-Q;)je=Ba(je),z--;for(;0<Q-z;)q=Ba(q),Q--;for(;z--;){if(je===q||q!==null&&je===q.alternate)break t;je=Ba(je),q=Ba(q)}je=null}else je=null;be!==null&&nm(fe,ue,be,je,!1),Ne!==null&&Jt!==null&&nm(fe,Jt,Ne,je,!0)}}e:{if(ue=X?Wa(X):window,be=ue.nodeName&&ue.nodeName.toLowerCase(),be==="select"||be==="input"&&ue.type==="file")var Ve=Fw;else if(Lp(ue))if(Op)Ve=$w;else{Ve=zw;var $e=Uw}else(be=ue.nodeName)&&be.toLowerCase()==="input"&&(ue.type==="checkbox"||ue.type==="radio")&&(Ve=Bw);if(Ve&&(Ve=Ve(r,X))){Vp(fe,Ve,o,he);break e}$e&&$e(r,ue,X),r==="focusout"&&($e=ue._wrapperState)&&$e.controlled&&ue.type==="number"&&zt(ue,"number",ue.value)}switch($e=X?Wa(X):window,r){case"focusin":(Lp($e)||$e.contentEditable==="true")&&(Ua=$e,wd=X,Wo=null);break;case"focusout":Wo=wd=Ua=null;break;case"mousedown":xd=!0;break;case"contextmenu":case"mouseup":case"dragend":xd=!1,Hp(fe,o,he);break;case"selectionchange":if(Gw)break;case"keydown":case"keyup":Hp(fe,o,he)}var We;if(tn)e:{switch(r){case"compositionstart":var qe="onCompositionStart";break e;case"compositionend":qe="onCompositionEnd";break e;case"compositionupdate":qe="onCompositionUpdate";break e}qe=void 0}else Fa?jp(r,o)&&(qe="onCompositionEnd"):r==="keydown"&&o.keyCode===229&&(qe="onCompositionStart");qe&&(Zi&&o.locale!=="ko"&&(Fa||qe!=="onCompositionStart"?qe==="onCompositionEnd"&&Fa&&(We=Oo()):(yr=he,Aa="value"in yr?yr.value:yr.textContent,Fa=!0)),$e=mc(X,qe),0<$e.length&&(qe=new Uo(qe,r,null,o,he),fe.push({event:qe,listeners:$e}),We?qe.data=We:(We=Dp(o),We!==null&&(qe.data=We)))),(We=vr?Lw(r,o):Vw(r,o))&&(X=mc(X,"onBeforeInput"),0<X.length&&(he=new Uo("onBeforeInput","beforeinput",null,o,he),fe.push({event:he,listeners:X}),he.data=We))}em(fe,i)})}function qo(r,i,o){return{instance:r,listener:i,currentTarget:o}}function mc(r,i){for(var o=i+"Capture",h=[];r!==null;){var p=r,y=p.stateNode;p.tag===5&&y!==null&&(p=y,y=_t(r,o),y!=null&&h.unshift(qo(r,y,p)),y=_t(r,i),y!=null&&h.push(qo(r,y,p))),r=r.return}return h}function Ba(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5);return r||null}function nm(r,i,o,h,p){for(var y=i._reactName,x=[];o!==null&&o!==h;){var N=o,M=N.alternate,X=N.stateNode;if(M!==null&&M===h)break;N.tag===5&&X!==null&&(N=X,p?(M=_t(o,y),M!=null&&x.unshift(qo(o,M,N))):p||(M=_t(o,y),M!=null&&x.push(qo(o,M,N)))),o=o.return}x.length!==0&&r.push({event:i,listeners:x})}var Yw=/\r\n?/g,Jw=/\u0000|\uFFFD/g;function rm(r){return(typeof r=="string"?r:""+r).replace(Yw,`
`).replace(Jw,"")}function gc(r,i,o){if(i=rm(i),rm(r)!==i&&o)throw Error(t(425))}function yc(){}var Pd=null,bd=null;function Rd(r,i){return r==="textarea"||r==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Ad=typeof setTimeout=="function"?setTimeout:void 0,Xw=typeof clearTimeout=="function"?clearTimeout:void 0,sm=typeof Promise=="function"?Promise:void 0,Zw=typeof queueMicrotask=="function"?queueMicrotask:typeof sm<"u"?function(r){return sm.resolve(null).then(r).catch(ex)}:Ad;function ex(r){setTimeout(function(){throw r})}function Nd(r,i){var o=i,h=0;do{var p=o.nextSibling;if(r.removeChild(o),p&&p.nodeType===8)if(o=p.data,o==="/$"){if(h===0){r.removeChild(p),Wr(i);return}h--}else o!=="$"&&o!=="$?"&&o!=="$!"||h++;o=p}while(o);Wr(i)}function li(r){for(;r!=null;r=r.nextSibling){var i=r.nodeType;if(i===1||i===3)break;if(i===8){if(i=r.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return r}function im(r){r=r.previousSibling;for(var i=0;r;){if(r.nodeType===8){var o=r.data;if(o==="$"||o==="$!"||o==="$?"){if(i===0)return r;i--}else o==="/$"&&i++}r=r.previousSibling}return null}var $a=Math.random().toString(36).slice(2),ps="__reactFiber$"+$a,Ko="__reactProps$"+$a,Os="__reactContainer$"+$a,kd="__reactEvents$"+$a,tx="__reactListeners$"+$a,nx="__reactHandles$"+$a;function ea(r){var i=r[ps];if(i)return i;for(var o=r.parentNode;o;){if(i=o[Os]||o[ps]){if(o=i.alternate,i.child!==null||o!==null&&o.child!==null)for(r=im(r);r!==null;){if(o=r[ps])return o;r=im(r)}return i}r=o,o=r.parentNode}return null}function Qo(r){return r=r[ps]||r[Os],!r||r.tag!==5&&r.tag!==6&&r.tag!==13&&r.tag!==3?null:r}function Wa(r){if(r.tag===5||r.tag===6)return r.stateNode;throw Error(t(33))}function vc(r){return r[Ko]||null}var jd=[],Ha=-1;function ci(r){return{current:r}}function Lt(r){0>Ha||(r.current=jd[Ha],jd[Ha]=null,Ha--)}function kt(r,i){Ha++,jd[Ha]=r.current,r.current=i}var ui={},Fn=ci(ui),ir=ci(!1),ta=ui;function Ga(r,i){var o=r.type.contextTypes;if(!o)return ui;var h=r.stateNode;if(h&&h.__reactInternalMemoizedUnmaskedChildContext===i)return h.__reactInternalMemoizedMaskedChildContext;var p={},y;for(y in o)p[y]=i[y];return h&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=i,r.__reactInternalMemoizedMaskedChildContext=p),p}function ar(r){return r=r.childContextTypes,r!=null}function _c(){Lt(ir),Lt(Fn)}function am(r,i,o){if(Fn.current!==ui)throw Error(t(168));kt(Fn,i),kt(ir,o)}function om(r,i,o){var h=r.stateNode;if(i=i.childContextTypes,typeof h.getChildContext!="function")return o;h=h.getChildContext();for(var p in h)if(!(p in i))throw Error(t(108,Ze(r)||"Unknown",p));return se({},o,h)}function wc(r){return r=(r=r.stateNode)&&r.__reactInternalMemoizedMergedChildContext||ui,ta=Fn.current,kt(Fn,r),kt(ir,ir.current),!0}function lm(r,i,o){var h=r.stateNode;if(!h)throw Error(t(169));o?(r=om(r,i,ta),h.__reactInternalMemoizedMergedChildContext=r,Lt(ir),Lt(Fn),kt(Fn,r)):Lt(ir),kt(ir,o)}var Ms=null,xc=!1,Dd=!1;function cm(r){Ms===null?Ms=[r]:Ms.push(r)}function rx(r){xc=!0,cm(r)}function di(){if(!Dd&&Ms!==null){Dd=!0;var r=0,i=rt;try{var o=Ms;for(rt=1;r<o.length;r++){var h=o[r];do h=h(!0);while(h!==null)}Ms=null,xc=!1}catch(p){throw Ms!==null&&(Ms=Ms.slice(r+1)),gt(Ns,di),p}finally{rt=i,Dd=!1}}return null}var qa=[],Ka=0,Ec=null,Tc=0,br=[],Rr=0,na=null,Fs=1,Us="";function ra(r,i){qa[Ka++]=Tc,qa[Ka++]=Ec,Ec=r,Tc=i}function um(r,i,o){br[Rr++]=Fs,br[Rr++]=Us,br[Rr++]=na,na=r;var h=Fs;r=Us;var p=32-W(h)-1;h&=~(1<<p),o+=1;var y=32-W(i)+p;if(30<y){var x=p-p%5;y=(h&(1<<x)-1).toString(32),h>>=x,p-=x,Fs=1<<32-W(i)+p|o<<p|h,Us=y+r}else Fs=1<<y|o<<p|h,Us=r}function Ld(r){r.return!==null&&(ra(r,1),um(r,1,0))}function Vd(r){for(;r===Ec;)Ec=qa[--Ka],qa[Ka]=null,Tc=qa[--Ka],qa[Ka]=null;for(;r===na;)na=br[--Rr],br[Rr]=null,Us=br[--Rr],br[Rr]=null,Fs=br[--Rr],br[Rr]=null}var _r=null,wr=null,Ut=!1,qr=null;function dm(r,i){var o=jr(5,null,null,0);o.elementType="DELETED",o.stateNode=i,o.return=r,i=r.deletions,i===null?(r.deletions=[o],r.flags|=16):i.push(o)}function hm(r,i){switch(r.tag){case 5:var o=r.type;return i=i.nodeType!==1||o.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(r.stateNode=i,_r=r,wr=li(i.firstChild),!0):!1;case 6:return i=r.pendingProps===""||i.nodeType!==3?null:i,i!==null?(r.stateNode=i,_r=r,wr=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(o=na!==null?{id:Fs,overflow:Us}:null,r.memoizedState={dehydrated:i,treeContext:o,retryLane:1073741824},o=jr(18,null,null,0),o.stateNode=i,o.return=r,r.child=o,_r=r,wr=null,!0):!1;default:return!1}}function Od(r){return(r.mode&1)!==0&&(r.flags&128)===0}function Md(r){if(Ut){var i=wr;if(i){var o=i;if(!hm(r,i)){if(Od(r))throw Error(t(418));i=li(o.nextSibling);var h=_r;i&&hm(r,i)?dm(h,o):(r.flags=r.flags&-4097|2,Ut=!1,_r=r)}}else{if(Od(r))throw Error(t(418));r.flags=r.flags&-4097|2,Ut=!1,_r=r}}}function fm(r){for(r=r.return;r!==null&&r.tag!==5&&r.tag!==3&&r.tag!==13;)r=r.return;_r=r}function Sc(r){if(r!==_r)return!1;if(!Ut)return fm(r),Ut=!0,!1;var i;if((i=r.tag!==3)&&!(i=r.tag!==5)&&(i=r.type,i=i!=="head"&&i!=="body"&&!Rd(r.type,r.memoizedProps)),i&&(i=wr)){if(Od(r))throw pm(),Error(t(418));for(;i;)dm(r,i),i=li(i.nextSibling)}if(fm(r),r.tag===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(t(317));e:{for(r=r.nextSibling,i=0;r;){if(r.nodeType===8){var o=r.data;if(o==="/$"){if(i===0){wr=li(r.nextSibling);break e}i--}else o!=="$"&&o!=="$!"&&o!=="$?"||i++}r=r.nextSibling}wr=null}}else wr=_r?li(r.stateNode.nextSibling):null;return!0}function pm(){for(var r=wr;r;)r=li(r.nextSibling)}function Qa(){wr=_r=null,Ut=!1}function Fd(r){qr===null?qr=[r]:qr.push(r)}var sx=oe.ReactCurrentBatchConfig;function Yo(r,i,o){if(r=o.ref,r!==null&&typeof r!="function"&&typeof r!="object"){if(o._owner){if(o=o._owner,o){if(o.tag!==1)throw Error(t(309));var h=o.stateNode}if(!h)throw Error(t(147,r));var p=h,y=""+r;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===y?i.ref:(i=function(x){var N=p.refs;x===null?delete N[y]:N[y]=x},i._stringRef=y,i)}if(typeof r!="string")throw Error(t(284));if(!o._owner)throw Error(t(290,r))}return r}function Ic(r,i){throw r=Object.prototype.toString.call(i),Error(t(31,r==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":r))}function mm(r){var i=r._init;return i(r._payload)}function gm(r){function i(q,z){if(r){var Q=q.deletions;Q===null?(q.deletions=[z],q.flags|=16):Q.push(z)}}function o(q,z){if(!r)return null;for(;z!==null;)i(q,z),z=z.sibling;return null}function h(q,z){for(q=new Map;z!==null;)z.key!==null?q.set(z.key,z):q.set(z.index,z),z=z.sibling;return q}function p(q,z){return q=_i(q,z),q.index=0,q.sibling=null,q}function y(q,z,Q){return q.index=Q,r?(Q=q.alternate,Q!==null?(Q=Q.index,Q<z?(q.flags|=2,z):Q):(q.flags|=2,z)):(q.flags|=1048576,z)}function x(q){return r&&q.alternate===null&&(q.flags|=2),q}function N(q,z,Q,_e){return z===null||z.tag!==6?(z=Ah(Q,q.mode,_e),z.return=q,z):(z=p(z,Q),z.return=q,z)}function M(q,z,Q,_e){var Ve=Q.type;return Ve===b?he(q,z,Q.props.children,_e,Q.key):z!==null&&(z.elementType===Ve||typeof Ve=="object"&&Ve!==null&&Ve.$$typeof===lt&&mm(Ve)===z.type)?(_e=p(z,Q.props),_e.ref=Yo(q,z,Q),_e.return=q,_e):(_e=Qc(Q.type,Q.key,Q.props,null,q.mode,_e),_e.ref=Yo(q,z,Q),_e.return=q,_e)}function X(q,z,Q,_e){return z===null||z.tag!==4||z.stateNode.containerInfo!==Q.containerInfo||z.stateNode.implementation!==Q.implementation?(z=Nh(Q,q.mode,_e),z.return=q,z):(z=p(z,Q.children||[]),z.return=q,z)}function he(q,z,Q,_e,Ve){return z===null||z.tag!==7?(z=da(Q,q.mode,_e,Ve),z.return=q,z):(z=p(z,Q),z.return=q,z)}function fe(q,z,Q){if(typeof z=="string"&&z!==""||typeof z=="number")return z=Ah(""+z,q.mode,Q),z.return=q,z;if(typeof z=="object"&&z!==null){switch(z.$$typeof){case Ee:return Q=Qc(z.type,z.key,z.props,null,q.mode,Q),Q.ref=Yo(q,null,z),Q.return=q,Q;case Se:return z=Nh(z,q.mode,Q),z.return=q,z;case lt:var _e=z._init;return fe(q,_e(z._payload),Q)}if(St(z)||ee(z))return z=da(z,q.mode,Q,null),z.return=q,z;Ic(q,z)}return null}function ue(q,z,Q,_e){var Ve=z!==null?z.key:null;if(typeof Q=="string"&&Q!==""||typeof Q=="number")return Ve!==null?null:N(q,z,""+Q,_e);if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case Ee:return Q.key===Ve?M(q,z,Q,_e):null;case Se:return Q.key===Ve?X(q,z,Q,_e):null;case lt:return Ve=Q._init,ue(q,z,Ve(Q._payload),_e)}if(St(Q)||ee(Q))return Ve!==null?null:he(q,z,Q,_e,null);Ic(q,Q)}return null}function be(q,z,Q,_e,Ve){if(typeof _e=="string"&&_e!==""||typeof _e=="number")return q=q.get(Q)||null,N(z,q,""+_e,Ve);if(typeof _e=="object"&&_e!==null){switch(_e.$$typeof){case Ee:return q=q.get(_e.key===null?Q:_e.key)||null,M(z,q,_e,Ve);case Se:return q=q.get(_e.key===null?Q:_e.key)||null,X(z,q,_e,Ve);case lt:var $e=_e._init;return be(q,z,Q,$e(_e._payload),Ve)}if(St(_e)||ee(_e))return q=q.get(Q)||null,he(z,q,_e,Ve,null);Ic(z,_e)}return null}function Ne(q,z,Q,_e){for(var Ve=null,$e=null,We=z,qe=z=0,En=null;We!==null&&qe<Q.length;qe++){We.index>qe?(En=We,We=null):En=We.sibling;var yt=ue(q,We,Q[qe],_e);if(yt===null){We===null&&(We=En);break}r&&We&&yt.alternate===null&&i(q,We),z=y(yt,z,qe),$e===null?Ve=yt:$e.sibling=yt,$e=yt,We=En}if(qe===Q.length)return o(q,We),Ut&&ra(q,qe),Ve;if(We===null){for(;qe<Q.length;qe++)We=fe(q,Q[qe],_e),We!==null&&(z=y(We,z,qe),$e===null?Ve=We:$e.sibling=We,$e=We);return Ut&&ra(q,qe),Ve}for(We=h(q,We);qe<Q.length;qe++)En=be(We,q,qe,Q[qe],_e),En!==null&&(r&&En.alternate!==null&&We.delete(En.key===null?qe:En.key),z=y(En,z,qe),$e===null?Ve=En:$e.sibling=En,$e=En);return r&&We.forEach(function(wi){return i(q,wi)}),Ut&&ra(q,qe),Ve}function je(q,z,Q,_e){var Ve=ee(Q);if(typeof Ve!="function")throw Error(t(150));if(Q=Ve.call(Q),Q==null)throw Error(t(151));for(var $e=Ve=null,We=z,qe=z=0,En=null,yt=Q.next();We!==null&&!yt.done;qe++,yt=Q.next()){We.index>qe?(En=We,We=null):En=We.sibling;var wi=ue(q,We,yt.value,_e);if(wi===null){We===null&&(We=En);break}r&&We&&wi.alternate===null&&i(q,We),z=y(wi,z,qe),$e===null?Ve=wi:$e.sibling=wi,$e=wi,We=En}if(yt.done)return o(q,We),Ut&&ra(q,qe),Ve;if(We===null){for(;!yt.done;qe++,yt=Q.next())yt=fe(q,yt.value,_e),yt!==null&&(z=y(yt,z,qe),$e===null?Ve=yt:$e.sibling=yt,$e=yt);return Ut&&ra(q,qe),Ve}for(We=h(q,We);!yt.done;qe++,yt=Q.next())yt=be(We,q,qe,yt.value,_e),yt!==null&&(r&&yt.alternate!==null&&We.delete(yt.key===null?qe:yt.key),z=y(yt,z,qe),$e===null?Ve=yt:$e.sibling=yt,$e=yt);return r&&We.forEach(function(Ox){return i(q,Ox)}),Ut&&ra(q,qe),Ve}function Jt(q,z,Q,_e){if(typeof Q=="object"&&Q!==null&&Q.type===b&&Q.key===null&&(Q=Q.props.children),typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case Ee:e:{for(var Ve=Q.key,$e=z;$e!==null;){if($e.key===Ve){if(Ve=Q.type,Ve===b){if($e.tag===7){o(q,$e.sibling),z=p($e,Q.props.children),z.return=q,q=z;break e}}else if($e.elementType===Ve||typeof Ve=="object"&&Ve!==null&&Ve.$$typeof===lt&&mm(Ve)===$e.type){o(q,$e.sibling),z=p($e,Q.props),z.ref=Yo(q,$e,Q),z.return=q,q=z;break e}o(q,$e);break}else i(q,$e);$e=$e.sibling}Q.type===b?(z=da(Q.props.children,q.mode,_e,Q.key),z.return=q,q=z):(_e=Qc(Q.type,Q.key,Q.props,null,q.mode,_e),_e.ref=Yo(q,z,Q),_e.return=q,q=_e)}return x(q);case Se:e:{for($e=Q.key;z!==null;){if(z.key===$e)if(z.tag===4&&z.stateNode.containerInfo===Q.containerInfo&&z.stateNode.implementation===Q.implementation){o(q,z.sibling),z=p(z,Q.children||[]),z.return=q,q=z;break e}else{o(q,z);break}else i(q,z);z=z.sibling}z=Nh(Q,q.mode,_e),z.return=q,q=z}return x(q);case lt:return $e=Q._init,Jt(q,z,$e(Q._payload),_e)}if(St(Q))return Ne(q,z,Q,_e);if(ee(Q))return je(q,z,Q,_e);Ic(q,Q)}return typeof Q=="string"&&Q!==""||typeof Q=="number"?(Q=""+Q,z!==null&&z.tag===6?(o(q,z.sibling),z=p(z,Q),z.return=q,q=z):(o(q,z),z=Ah(Q,q.mode,_e),z.return=q,q=z),x(q)):o(q,z)}return Jt}var Ya=gm(!0),ym=gm(!1),Cc=ci(null),Pc=null,Ja=null,Ud=null;function zd(){Ud=Ja=Pc=null}function Bd(r){var i=Cc.current;Lt(Cc),r._currentValue=i}function $d(r,i,o){for(;r!==null;){var h=r.alternate;if((r.childLanes&i)!==i?(r.childLanes|=i,h!==null&&(h.childLanes|=i)):h!==null&&(h.childLanes&i)!==i&&(h.childLanes|=i),r===o)break;r=r.return}}function Xa(r,i){Pc=r,Ud=Ja=null,r=r.dependencies,r!==null&&r.firstContext!==null&&((r.lanes&i)!==0&&(or=!0),r.firstContext=null)}function Ar(r){var i=r._currentValue;if(Ud!==r)if(r={context:r,memoizedValue:i,next:null},Ja===null){if(Pc===null)throw Error(t(308));Ja=r,Pc.dependencies={lanes:0,firstContext:r}}else Ja=Ja.next=r;return i}var sa=null;function Wd(r){sa===null?sa=[r]:sa.push(r)}function vm(r,i,o,h){var p=i.interleaved;return p===null?(o.next=o,Wd(i)):(o.next=p.next,p.next=o),i.interleaved=o,zs(r,h)}function zs(r,i){r.lanes|=i;var o=r.alternate;for(o!==null&&(o.lanes|=i),o=r,r=r.return;r!==null;)r.childLanes|=i,o=r.alternate,o!==null&&(o.childLanes|=i),o=r,r=r.return;return o.tag===3?o.stateNode:null}var hi=!1;function Hd(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function _m(r,i){r=r.updateQueue,i.updateQueue===r&&(i.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,effects:r.effects})}function Bs(r,i){return{eventTime:r,lane:i,tag:0,payload:null,callback:null,next:null}}function fi(r,i,o){var h=r.updateQueue;if(h===null)return null;if(h=h.shared,(pt&2)!==0){var p=h.pending;return p===null?i.next=i:(i.next=p.next,p.next=i),h.pending=i,zs(r,o)}return p=h.interleaved,p===null?(i.next=i,Wd(h)):(i.next=p.next,p.next=i),h.interleaved=i,zs(r,o)}function bc(r,i,o){if(i=i.updateQueue,i!==null&&(i=i.shared,(o&4194240)!==0)){var h=i.lanes;h&=r.pendingLanes,o|=h,i.lanes=o,Mn(r,o)}}function wm(r,i){var o=r.updateQueue,h=r.alternate;if(h!==null&&(h=h.updateQueue,o===h)){var p=null,y=null;if(o=o.firstBaseUpdate,o!==null){do{var x={eventTime:o.eventTime,lane:o.lane,tag:o.tag,payload:o.payload,callback:o.callback,next:null};y===null?p=y=x:y=y.next=x,o=o.next}while(o!==null);y===null?p=y=i:y=y.next=i}else p=y=i;o={baseState:h.baseState,firstBaseUpdate:p,lastBaseUpdate:y,shared:h.shared,effects:h.effects},r.updateQueue=o;return}r=o.lastBaseUpdate,r===null?o.firstBaseUpdate=i:r.next=i,o.lastBaseUpdate=i}function Rc(r,i,o,h){var p=r.updateQueue;hi=!1;var y=p.firstBaseUpdate,x=p.lastBaseUpdate,N=p.shared.pending;if(N!==null){p.shared.pending=null;var M=N,X=M.next;M.next=null,x===null?y=X:x.next=X,x=M;var he=r.alternate;he!==null&&(he=he.updateQueue,N=he.lastBaseUpdate,N!==x&&(N===null?he.firstBaseUpdate=X:N.next=X,he.lastBaseUpdate=M))}if(y!==null){var fe=p.baseState;x=0,he=X=M=null,N=y;do{var ue=N.lane,be=N.eventTime;if((h&ue)===ue){he!==null&&(he=he.next={eventTime:be,lane:0,tag:N.tag,payload:N.payload,callback:N.callback,next:null});e:{var Ne=r,je=N;switch(ue=i,be=o,je.tag){case 1:if(Ne=je.payload,typeof Ne=="function"){fe=Ne.call(be,fe,ue);break e}fe=Ne;break e;case 3:Ne.flags=Ne.flags&-65537|128;case 0:if(Ne=je.payload,ue=typeof Ne=="function"?Ne.call(be,fe,ue):Ne,ue==null)break e;fe=se({},fe,ue);break e;case 2:hi=!0}}N.callback!==null&&N.lane!==0&&(r.flags|=64,ue=p.effects,ue===null?p.effects=[N]:ue.push(N))}else be={eventTime:be,lane:ue,tag:N.tag,payload:N.payload,callback:N.callback,next:null},he===null?(X=he=be,M=fe):he=he.next=be,x|=ue;if(N=N.next,N===null){if(N=p.shared.pending,N===null)break;ue=N,N=ue.next,ue.next=null,p.lastBaseUpdate=ue,p.shared.pending=null}}while(!0);if(he===null&&(M=fe),p.baseState=M,p.firstBaseUpdate=X,p.lastBaseUpdate=he,i=p.shared.interleaved,i!==null){p=i;do x|=p.lane,p=p.next;while(p!==i)}else y===null&&(p.shared.lanes=0);oa|=x,r.lanes=x,r.memoizedState=fe}}function xm(r,i,o){if(r=i.effects,i.effects=null,r!==null)for(i=0;i<r.length;i++){var h=r[i],p=h.callback;if(p!==null){if(h.callback=null,h=o,typeof p!="function")throw Error(t(191,p));p.call(h)}}}var Jo={},ms=ci(Jo),Xo=ci(Jo),Zo=ci(Jo);function ia(r){if(r===Jo)throw Error(t(174));return r}function Gd(r,i){switch(kt(Zo,i),kt(Xo,r),kt(ms,Jo),r=i.nodeType,r){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:Qe(null,"");break;default:r=r===8?i.parentNode:i,i=r.namespaceURI||null,r=r.tagName,i=Qe(i,r)}Lt(ms),kt(ms,i)}function Za(){Lt(ms),Lt(Xo),Lt(Zo)}function Em(r){ia(Zo.current);var i=ia(ms.current),o=Qe(i,r.type);i!==o&&(kt(Xo,r),kt(ms,o))}function qd(r){Xo.current===r&&(Lt(ms),Lt(Xo))}var Wt=ci(0);function Ac(r){for(var i=r;i!==null;){if(i.tag===13){var o=i.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||o.data==="$?"||o.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===r)break;for(;i.sibling===null;){if(i.return===null||i.return===r)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var Kd=[];function Qd(){for(var r=0;r<Kd.length;r++)Kd[r]._workInProgressVersionPrimary=null;Kd.length=0}var Nc=oe.ReactCurrentDispatcher,Yd=oe.ReactCurrentBatchConfig,aa=0,Ht=null,pn=null,wn=null,kc=!1,el=!1,tl=0,ix=0;function Un(){throw Error(t(321))}function Jd(r,i){if(i===null)return!1;for(var o=0;o<i.length&&o<r.length;o++)if(!Gr(r[o],i[o]))return!1;return!0}function Xd(r,i,o,h,p,y){if(aa=y,Ht=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,Nc.current=r===null||r.memoizedState===null?cx:ux,r=o(h,p),el){y=0;do{if(el=!1,tl=0,25<=y)throw Error(t(301));y+=1,wn=pn=null,i.updateQueue=null,Nc.current=dx,r=o(h,p)}while(el)}if(Nc.current=Lc,i=pn!==null&&pn.next!==null,aa=0,wn=pn=Ht=null,kc=!1,i)throw Error(t(300));return r}function Zd(){var r=tl!==0;return tl=0,r}function gs(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return wn===null?Ht.memoizedState=wn=r:wn=wn.next=r,wn}function Nr(){if(pn===null){var r=Ht.alternate;r=r!==null?r.memoizedState:null}else r=pn.next;var i=wn===null?Ht.memoizedState:wn.next;if(i!==null)wn=i,pn=r;else{if(r===null)throw Error(t(310));pn=r,r={memoizedState:pn.memoizedState,baseState:pn.baseState,baseQueue:pn.baseQueue,queue:pn.queue,next:null},wn===null?Ht.memoizedState=wn=r:wn=wn.next=r}return wn}function nl(r,i){return typeof i=="function"?i(r):i}function eh(r){var i=Nr(),o=i.queue;if(o===null)throw Error(t(311));o.lastRenderedReducer=r;var h=pn,p=h.baseQueue,y=o.pending;if(y!==null){if(p!==null){var x=p.next;p.next=y.next,y.next=x}h.baseQueue=p=y,o.pending=null}if(p!==null){y=p.next,h=h.baseState;var N=x=null,M=null,X=y;do{var he=X.lane;if((aa&he)===he)M!==null&&(M=M.next={lane:0,action:X.action,hasEagerState:X.hasEagerState,eagerState:X.eagerState,next:null}),h=X.hasEagerState?X.eagerState:r(h,X.action);else{var fe={lane:he,action:X.action,hasEagerState:X.hasEagerState,eagerState:X.eagerState,next:null};M===null?(N=M=fe,x=h):M=M.next=fe,Ht.lanes|=he,oa|=he}X=X.next}while(X!==null&&X!==y);M===null?x=h:M.next=N,Gr(h,i.memoizedState)||(or=!0),i.memoizedState=h,i.baseState=x,i.baseQueue=M,o.lastRenderedState=h}if(r=o.interleaved,r!==null){p=r;do y=p.lane,Ht.lanes|=y,oa|=y,p=p.next;while(p!==r)}else p===null&&(o.lanes=0);return[i.memoizedState,o.dispatch]}function th(r){var i=Nr(),o=i.queue;if(o===null)throw Error(t(311));o.lastRenderedReducer=r;var h=o.dispatch,p=o.pending,y=i.memoizedState;if(p!==null){o.pending=null;var x=p=p.next;do y=r(y,x.action),x=x.next;while(x!==p);Gr(y,i.memoizedState)||(or=!0),i.memoizedState=y,i.baseQueue===null&&(i.baseState=y),o.lastRenderedState=y}return[y,h]}function Tm(){}function Sm(r,i){var o=Ht,h=Nr(),p=i(),y=!Gr(h.memoizedState,p);if(y&&(h.memoizedState=p,or=!0),h=h.queue,nh(Pm.bind(null,o,h,r),[r]),h.getSnapshot!==i||y||wn!==null&&wn.memoizedState.tag&1){if(o.flags|=2048,rl(9,Cm.bind(null,o,h,p,i),void 0,null),xn===null)throw Error(t(349));(aa&30)!==0||Im(o,i,p)}return p}function Im(r,i,o){r.flags|=16384,r={getSnapshot:i,value:o},i=Ht.updateQueue,i===null?(i={lastEffect:null,stores:null},Ht.updateQueue=i,i.stores=[r]):(o=i.stores,o===null?i.stores=[r]:o.push(r))}function Cm(r,i,o,h){i.value=o,i.getSnapshot=h,bm(i)&&Rm(r)}function Pm(r,i,o){return o(function(){bm(i)&&Rm(r)})}function bm(r){var i=r.getSnapshot;r=r.value;try{var o=i();return!Gr(r,o)}catch{return!0}}function Rm(r){var i=zs(r,1);i!==null&&Jr(i,r,1,-1)}function Am(r){var i=gs();return typeof r=="function"&&(r=r()),i.memoizedState=i.baseState=r,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:nl,lastRenderedState:r},i.queue=r,r=r.dispatch=lx.bind(null,Ht,r),[i.memoizedState,r]}function rl(r,i,o,h){return r={tag:r,create:i,destroy:o,deps:h,next:null},i=Ht.updateQueue,i===null?(i={lastEffect:null,stores:null},Ht.updateQueue=i,i.lastEffect=r.next=r):(o=i.lastEffect,o===null?i.lastEffect=r.next=r:(h=o.next,o.next=r,r.next=h,i.lastEffect=r)),r}function Nm(){return Nr().memoizedState}function jc(r,i,o,h){var p=gs();Ht.flags|=r,p.memoizedState=rl(1|i,o,void 0,h===void 0?null:h)}function Dc(r,i,o,h){var p=Nr();h=h===void 0?null:h;var y=void 0;if(pn!==null){var x=pn.memoizedState;if(y=x.destroy,h!==null&&Jd(h,x.deps)){p.memoizedState=rl(i,o,y,h);return}}Ht.flags|=r,p.memoizedState=rl(1|i,o,y,h)}function km(r,i){return jc(8390656,8,r,i)}function nh(r,i){return Dc(2048,8,r,i)}function jm(r,i){return Dc(4,2,r,i)}function Dm(r,i){return Dc(4,4,r,i)}function Lm(r,i){if(typeof i=="function")return r=r(),i(r),function(){i(null)};if(i!=null)return r=r(),i.current=r,function(){i.current=null}}function Vm(r,i,o){return o=o!=null?o.concat([r]):null,Dc(4,4,Lm.bind(null,i,r),o)}function rh(){}function Om(r,i){var o=Nr();i=i===void 0?null:i;var h=o.memoizedState;return h!==null&&i!==null&&Jd(i,h[1])?h[0]:(o.memoizedState=[r,i],r)}function Mm(r,i){var o=Nr();i=i===void 0?null:i;var h=o.memoizedState;return h!==null&&i!==null&&Jd(i,h[1])?h[0]:(r=r(),o.memoizedState=[r,i],r)}function Fm(r,i,o){return(aa&21)===0?(r.baseState&&(r.baseState=!1,or=!0),r.memoizedState=o):(Gr(o,i)||(o=$t(),Ht.lanes|=o,oa|=o,r.baseState=!0),i)}function ax(r,i){var o=rt;rt=o!==0&&4>o?o:4,r(!0);var h=Yd.transition;Yd.transition={};try{r(!1),i()}finally{rt=o,Yd.transition=h}}function Um(){return Nr().memoizedState}function ox(r,i,o){var h=yi(r);if(o={lane:h,action:o,hasEagerState:!1,eagerState:null,next:null},zm(r))Bm(i,o);else if(o=vm(r,i,o,h),o!==null){var p=tr();Jr(o,r,h,p),$m(o,i,h)}}function lx(r,i,o){var h=yi(r),p={lane:h,action:o,hasEagerState:!1,eagerState:null,next:null};if(zm(r))Bm(i,p);else{var y=r.alternate;if(r.lanes===0&&(y===null||y.lanes===0)&&(y=i.lastRenderedReducer,y!==null))try{var x=i.lastRenderedState,N=y(x,o);if(p.hasEagerState=!0,p.eagerState=N,Gr(N,x)){var M=i.interleaved;M===null?(p.next=p,Wd(i)):(p.next=M.next,M.next=p),i.interleaved=p;return}}catch{}finally{}o=vm(r,i,p,h),o!==null&&(p=tr(),Jr(o,r,h,p),$m(o,i,h))}}function zm(r){var i=r.alternate;return r===Ht||i!==null&&i===Ht}function Bm(r,i){el=kc=!0;var o=r.pending;o===null?i.next=i:(i.next=o.next,o.next=i),r.pending=i}function $m(r,i,o){if((o&4194240)!==0){var h=i.lanes;h&=r.pendingLanes,o|=h,i.lanes=o,Mn(r,o)}}var Lc={readContext:Ar,useCallback:Un,useContext:Un,useEffect:Un,useImperativeHandle:Un,useInsertionEffect:Un,useLayoutEffect:Un,useMemo:Un,useReducer:Un,useRef:Un,useState:Un,useDebugValue:Un,useDeferredValue:Un,useTransition:Un,useMutableSource:Un,useSyncExternalStore:Un,useId:Un,unstable_isNewReconciler:!1},cx={readContext:Ar,useCallback:function(r,i){return gs().memoizedState=[r,i===void 0?null:i],r},useContext:Ar,useEffect:km,useImperativeHandle:function(r,i,o){return o=o!=null?o.concat([r]):null,jc(4194308,4,Lm.bind(null,i,r),o)},useLayoutEffect:function(r,i){return jc(4194308,4,r,i)},useInsertionEffect:function(r,i){return jc(4,2,r,i)},useMemo:function(r,i){var o=gs();return i=i===void 0?null:i,r=r(),o.memoizedState=[r,i],r},useReducer:function(r,i,o){var h=gs();return i=o!==void 0?o(i):i,h.memoizedState=h.baseState=i,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:i},h.queue=r,r=r.dispatch=ox.bind(null,Ht,r),[h.memoizedState,r]},useRef:function(r){var i=gs();return r={current:r},i.memoizedState=r},useState:Am,useDebugValue:rh,useDeferredValue:function(r){return gs().memoizedState=r},useTransition:function(){var r=Am(!1),i=r[0];return r=ax.bind(null,r[1]),gs().memoizedState=r,[i,r]},useMutableSource:function(){},useSyncExternalStore:function(r,i,o){var h=Ht,p=gs();if(Ut){if(o===void 0)throw Error(t(407));o=o()}else{if(o=i(),xn===null)throw Error(t(349));(aa&30)!==0||Im(h,i,o)}p.memoizedState=o;var y={value:o,getSnapshot:i};return p.queue=y,km(Pm.bind(null,h,y,r),[r]),h.flags|=2048,rl(9,Cm.bind(null,h,y,o,i),void 0,null),o},useId:function(){var r=gs(),i=xn.identifierPrefix;if(Ut){var o=Us,h=Fs;o=(h&~(1<<32-W(h)-1)).toString(32)+o,i=":"+i+"R"+o,o=tl++,0<o&&(i+="H"+o.toString(32)),i+=":"}else o=ix++,i=":"+i+"r"+o.toString(32)+":";return r.memoizedState=i},unstable_isNewReconciler:!1},ux={readContext:Ar,useCallback:Om,useContext:Ar,useEffect:nh,useImperativeHandle:Vm,useInsertionEffect:jm,useLayoutEffect:Dm,useMemo:Mm,useReducer:eh,useRef:Nm,useState:function(){return eh(nl)},useDebugValue:rh,useDeferredValue:function(r){var i=Nr();return Fm(i,pn.memoizedState,r)},useTransition:function(){var r=eh(nl)[0],i=Nr().memoizedState;return[r,i]},useMutableSource:Tm,useSyncExternalStore:Sm,useId:Um,unstable_isNewReconciler:!1},dx={readContext:Ar,useCallback:Om,useContext:Ar,useEffect:nh,useImperativeHandle:Vm,useInsertionEffect:jm,useLayoutEffect:Dm,useMemo:Mm,useReducer:th,useRef:Nm,useState:function(){return th(nl)},useDebugValue:rh,useDeferredValue:function(r){var i=Nr();return pn===null?i.memoizedState=r:Fm(i,pn.memoizedState,r)},useTransition:function(){var r=th(nl)[0],i=Nr().memoizedState;return[r,i]},useMutableSource:Tm,useSyncExternalStore:Sm,useId:Um,unstable_isNewReconciler:!1};function Kr(r,i){if(r&&r.defaultProps){i=se({},i),r=r.defaultProps;for(var o in r)i[o]===void 0&&(i[o]=r[o]);return i}return i}function sh(r,i,o,h){i=r.memoizedState,o=o(h,i),o=o==null?i:se({},i,o),r.memoizedState=o,r.lanes===0&&(r.updateQueue.baseState=o)}var Vc={isMounted:function(r){return(r=r._reactInternals)?xe(r)===r:!1},enqueueSetState:function(r,i,o){r=r._reactInternals;var h=tr(),p=yi(r),y=Bs(h,p);y.payload=i,o!=null&&(y.callback=o),i=fi(r,y,p),i!==null&&(Jr(i,r,p,h),bc(i,r,p))},enqueueReplaceState:function(r,i,o){r=r._reactInternals;var h=tr(),p=yi(r),y=Bs(h,p);y.tag=1,y.payload=i,o!=null&&(y.callback=o),i=fi(r,y,p),i!==null&&(Jr(i,r,p,h),bc(i,r,p))},enqueueForceUpdate:function(r,i){r=r._reactInternals;var o=tr(),h=yi(r),p=Bs(o,h);p.tag=2,i!=null&&(p.callback=i),i=fi(r,p,h),i!==null&&(Jr(i,r,h,o),bc(i,r,h))}};function Wm(r,i,o,h,p,y,x){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(h,y,x):i.prototype&&i.prototype.isPureReactComponent?!$o(o,h)||!$o(p,y):!0}function Hm(r,i,o){var h=!1,p=ui,y=i.contextType;return typeof y=="object"&&y!==null?y=Ar(y):(p=ar(i)?ta:Fn.current,h=i.contextTypes,y=(h=h!=null)?Ga(r,p):ui),i=new i(o,y),r.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=Vc,r.stateNode=i,i._reactInternals=r,h&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=p,r.__reactInternalMemoizedMaskedChildContext=y),i}function Gm(r,i,o,h){r=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(o,h),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(o,h),i.state!==r&&Vc.enqueueReplaceState(i,i.state,null)}function ih(r,i,o,h){var p=r.stateNode;p.props=o,p.state=r.memoizedState,p.refs={},Hd(r);var y=i.contextType;typeof y=="object"&&y!==null?p.context=Ar(y):(y=ar(i)?ta:Fn.current,p.context=Ga(r,y)),p.state=r.memoizedState,y=i.getDerivedStateFromProps,typeof y=="function"&&(sh(r,i,y,o),p.state=r.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(i=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),i!==p.state&&Vc.enqueueReplaceState(p,p.state,null),Rc(r,o,p,h),p.state=r.memoizedState),typeof p.componentDidMount=="function"&&(r.flags|=4194308)}function eo(r,i){try{var o="",h=i;do o+=Te(h),h=h.return;while(h);var p=o}catch(y){p=`
Error generating stack: `+y.message+`
`+y.stack}return{value:r,source:i,stack:p,digest:null}}function ah(r,i,o){return{value:r,source:null,stack:o??null,digest:i??null}}function oh(r,i){try{console.error(i.value)}catch(o){setTimeout(function(){throw o})}}var hx=typeof WeakMap=="function"?WeakMap:Map;function qm(r,i,o){o=Bs(-1,o),o.tag=3,o.payload={element:null};var h=i.value;return o.callback=function(){$c||($c=!0,Eh=h),oh(r,i)},o}function Km(r,i,o){o=Bs(-1,o),o.tag=3;var h=r.type.getDerivedStateFromError;if(typeof h=="function"){var p=i.value;o.payload=function(){return h(p)},o.callback=function(){oh(r,i)}}var y=r.stateNode;return y!==null&&typeof y.componentDidCatch=="function"&&(o.callback=function(){oh(r,i),typeof h!="function"&&(mi===null?mi=new Set([this]):mi.add(this));var x=i.stack;this.componentDidCatch(i.value,{componentStack:x!==null?x:""})}),o}function Qm(r,i,o){var h=r.pingCache;if(h===null){h=r.pingCache=new hx;var p=new Set;h.set(i,p)}else p=h.get(i),p===void 0&&(p=new Set,h.set(i,p));p.has(o)||(p.add(o),r=Cx.bind(null,r,i,o),i.then(r,r))}function Ym(r){do{var i;if((i=r.tag===13)&&(i=r.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return r;r=r.return}while(r!==null);return null}function Jm(r,i,o,h,p){return(r.mode&1)===0?(r===i?r.flags|=65536:(r.flags|=128,o.flags|=131072,o.flags&=-52805,o.tag===1&&(o.alternate===null?o.tag=17:(i=Bs(-1,1),i.tag=2,fi(o,i,1))),o.lanes|=1),r):(r.flags|=65536,r.lanes=p,r)}var fx=oe.ReactCurrentOwner,or=!1;function er(r,i,o,h){i.child=r===null?ym(i,null,o,h):Ya(i,r.child,o,h)}function Xm(r,i,o,h,p){o=o.render;var y=i.ref;return Xa(i,p),h=Xd(r,i,o,h,y,p),o=Zd(),r!==null&&!or?(i.updateQueue=r.updateQueue,i.flags&=-2053,r.lanes&=~p,$s(r,i,p)):(Ut&&o&&Ld(i),i.flags|=1,er(r,i,h,p),i.child)}function Zm(r,i,o,h,p){if(r===null){var y=o.type;return typeof y=="function"&&!Rh(y)&&y.defaultProps===void 0&&o.compare===null&&o.defaultProps===void 0?(i.tag=15,i.type=y,eg(r,i,y,h,p)):(r=Qc(o.type,null,h,i,i.mode,p),r.ref=i.ref,r.return=i,i.child=r)}if(y=r.child,(r.lanes&p)===0){var x=y.memoizedProps;if(o=o.compare,o=o!==null?o:$o,o(x,h)&&r.ref===i.ref)return $s(r,i,p)}return i.flags|=1,r=_i(y,h),r.ref=i.ref,r.return=i,i.child=r}function eg(r,i,o,h,p){if(r!==null){var y=r.memoizedProps;if($o(y,h)&&r.ref===i.ref)if(or=!1,i.pendingProps=h=y,(r.lanes&p)!==0)(r.flags&131072)!==0&&(or=!0);else return i.lanes=r.lanes,$s(r,i,p)}return lh(r,i,o,h,p)}function tg(r,i,o){var h=i.pendingProps,p=h.children,y=r!==null?r.memoizedState:null;if(h.mode==="hidden")if((i.mode&1)===0)i.memoizedState={baseLanes:0,cachePool:null,transitions:null},kt(no,xr),xr|=o;else{if((o&1073741824)===0)return r=y!==null?y.baseLanes|o:o,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:r,cachePool:null,transitions:null},i.updateQueue=null,kt(no,xr),xr|=r,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},h=y!==null?y.baseLanes:o,kt(no,xr),xr|=h}else y!==null?(h=y.baseLanes|o,i.memoizedState=null):h=o,kt(no,xr),xr|=h;return er(r,i,p,o),i.child}function ng(r,i){var o=i.ref;(r===null&&o!==null||r!==null&&r.ref!==o)&&(i.flags|=512,i.flags|=2097152)}function lh(r,i,o,h,p){var y=ar(o)?ta:Fn.current;return y=Ga(i,y),Xa(i,p),o=Xd(r,i,o,h,y,p),h=Zd(),r!==null&&!or?(i.updateQueue=r.updateQueue,i.flags&=-2053,r.lanes&=~p,$s(r,i,p)):(Ut&&h&&Ld(i),i.flags|=1,er(r,i,o,p),i.child)}function rg(r,i,o,h,p){if(ar(o)){var y=!0;wc(i)}else y=!1;if(Xa(i,p),i.stateNode===null)Mc(r,i),Hm(i,o,h),ih(i,o,h,p),h=!0;else if(r===null){var x=i.stateNode,N=i.memoizedProps;x.props=N;var M=x.context,X=o.contextType;typeof X=="object"&&X!==null?X=Ar(X):(X=ar(o)?ta:Fn.current,X=Ga(i,X));var he=o.getDerivedStateFromProps,fe=typeof he=="function"||typeof x.getSnapshotBeforeUpdate=="function";fe||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(N!==h||M!==X)&&Gm(i,x,h,X),hi=!1;var ue=i.memoizedState;x.state=ue,Rc(i,h,x,p),M=i.memoizedState,N!==h||ue!==M||ir.current||hi?(typeof he=="function"&&(sh(i,o,he,h),M=i.memoizedState),(N=hi||Wm(i,o,N,h,ue,M,X))?(fe||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(i.flags|=4194308)):(typeof x.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=h,i.memoizedState=M),x.props=h,x.state=M,x.context=X,h=N):(typeof x.componentDidMount=="function"&&(i.flags|=4194308),h=!1)}else{x=i.stateNode,_m(r,i),N=i.memoizedProps,X=i.type===i.elementType?N:Kr(i.type,N),x.props=X,fe=i.pendingProps,ue=x.context,M=o.contextType,typeof M=="object"&&M!==null?M=Ar(M):(M=ar(o)?ta:Fn.current,M=Ga(i,M));var be=o.getDerivedStateFromProps;(he=typeof be=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(N!==fe||ue!==M)&&Gm(i,x,h,M),hi=!1,ue=i.memoizedState,x.state=ue,Rc(i,h,x,p);var Ne=i.memoizedState;N!==fe||ue!==Ne||ir.current||hi?(typeof be=="function"&&(sh(i,o,be,h),Ne=i.memoizedState),(X=hi||Wm(i,o,X,h,ue,Ne,M)||!1)?(he||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(h,Ne,M),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(h,Ne,M)),typeof x.componentDidUpdate=="function"&&(i.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof x.componentDidUpdate!="function"||N===r.memoizedProps&&ue===r.memoizedState||(i.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||N===r.memoizedProps&&ue===r.memoizedState||(i.flags|=1024),i.memoizedProps=h,i.memoizedState=Ne),x.props=h,x.state=Ne,x.context=M,h=X):(typeof x.componentDidUpdate!="function"||N===r.memoizedProps&&ue===r.memoizedState||(i.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||N===r.memoizedProps&&ue===r.memoizedState||(i.flags|=1024),h=!1)}return ch(r,i,o,h,y,p)}function ch(r,i,o,h,p,y){ng(r,i);var x=(i.flags&128)!==0;if(!h&&!x)return p&&lm(i,o,!1),$s(r,i,y);h=i.stateNode,fx.current=i;var N=x&&typeof o.getDerivedStateFromError!="function"?null:h.render();return i.flags|=1,r!==null&&x?(i.child=Ya(i,r.child,null,y),i.child=Ya(i,null,N,y)):er(r,i,N,y),i.memoizedState=h.state,p&&lm(i,o,!0),i.child}function sg(r){var i=r.stateNode;i.pendingContext?am(r,i.pendingContext,i.pendingContext!==i.context):i.context&&am(r,i.context,!1),Gd(r,i.containerInfo)}function ig(r,i,o,h,p){return Qa(),Fd(p),i.flags|=256,er(r,i,o,h),i.child}var uh={dehydrated:null,treeContext:null,retryLane:0};function dh(r){return{baseLanes:r,cachePool:null,transitions:null}}function ag(r,i,o){var h=i.pendingProps,p=Wt.current,y=!1,x=(i.flags&128)!==0,N;if((N=x)||(N=r!==null&&r.memoizedState===null?!1:(p&2)!==0),N?(y=!0,i.flags&=-129):(r===null||r.memoizedState!==null)&&(p|=1),kt(Wt,p&1),r===null)return Md(i),r=i.memoizedState,r!==null&&(r=r.dehydrated,r!==null)?((i.mode&1)===0?i.lanes=1:r.data==="$!"?i.lanes=8:i.lanes=1073741824,null):(x=h.children,r=h.fallback,y?(h=i.mode,y=i.child,x={mode:"hidden",children:x},(h&1)===0&&y!==null?(y.childLanes=0,y.pendingProps=x):y=Yc(x,h,0,null),r=da(r,h,o,null),y.return=i,r.return=i,y.sibling=r,i.child=y,i.child.memoizedState=dh(o),i.memoizedState=uh,r):hh(i,x));if(p=r.memoizedState,p!==null&&(N=p.dehydrated,N!==null))return px(r,i,x,h,N,p,o);if(y){y=h.fallback,x=i.mode,p=r.child,N=p.sibling;var M={mode:"hidden",children:h.children};return(x&1)===0&&i.child!==p?(h=i.child,h.childLanes=0,h.pendingProps=M,i.deletions=null):(h=_i(p,M),h.subtreeFlags=p.subtreeFlags&14680064),N!==null?y=_i(N,y):(y=da(y,x,o,null),y.flags|=2),y.return=i,h.return=i,h.sibling=y,i.child=h,h=y,y=i.child,x=r.child.memoizedState,x=x===null?dh(o):{baseLanes:x.baseLanes|o,cachePool:null,transitions:x.transitions},y.memoizedState=x,y.childLanes=r.childLanes&~o,i.memoizedState=uh,h}return y=r.child,r=y.sibling,h=_i(y,{mode:"visible",children:h.children}),(i.mode&1)===0&&(h.lanes=o),h.return=i,h.sibling=null,r!==null&&(o=i.deletions,o===null?(i.deletions=[r],i.flags|=16):o.push(r)),i.child=h,i.memoizedState=null,h}function hh(r,i){return i=Yc({mode:"visible",children:i},r.mode,0,null),i.return=r,r.child=i}function Oc(r,i,o,h){return h!==null&&Fd(h),Ya(i,r.child,null,o),r=hh(i,i.pendingProps.children),r.flags|=2,i.memoizedState=null,r}function px(r,i,o,h,p,y,x){if(o)return i.flags&256?(i.flags&=-257,h=ah(Error(t(422))),Oc(r,i,x,h)):i.memoizedState!==null?(i.child=r.child,i.flags|=128,null):(y=h.fallback,p=i.mode,h=Yc({mode:"visible",children:h.children},p,0,null),y=da(y,p,x,null),y.flags|=2,h.return=i,y.return=i,h.sibling=y,i.child=h,(i.mode&1)!==0&&Ya(i,r.child,null,x),i.child.memoizedState=dh(x),i.memoizedState=uh,y);if((i.mode&1)===0)return Oc(r,i,x,null);if(p.data==="$!"){if(h=p.nextSibling&&p.nextSibling.dataset,h)var N=h.dgst;return h=N,y=Error(t(419)),h=ah(y,h,void 0),Oc(r,i,x,h)}if(N=(x&r.childLanes)!==0,or||N){if(h=xn,h!==null){switch(x&-x){case 4:p=2;break;case 16:p=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:p=32;break;case 536870912:p=268435456;break;default:p=0}p=(p&(h.suspendedLanes|x))!==0?0:p,p!==0&&p!==y.retryLane&&(y.retryLane=p,zs(r,p),Jr(h,r,p,-1))}return bh(),h=ah(Error(t(421))),Oc(r,i,x,h)}return p.data==="$?"?(i.flags|=128,i.child=r.child,i=Px.bind(null,r),p._reactRetry=i,null):(r=y.treeContext,wr=li(p.nextSibling),_r=i,Ut=!0,qr=null,r!==null&&(br[Rr++]=Fs,br[Rr++]=Us,br[Rr++]=na,Fs=r.id,Us=r.overflow,na=i),i=hh(i,h.children),i.flags|=4096,i)}function og(r,i,o){r.lanes|=i;var h=r.alternate;h!==null&&(h.lanes|=i),$d(r.return,i,o)}function fh(r,i,o,h,p){var y=r.memoizedState;y===null?r.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:h,tail:o,tailMode:p}:(y.isBackwards=i,y.rendering=null,y.renderingStartTime=0,y.last=h,y.tail=o,y.tailMode=p)}function lg(r,i,o){var h=i.pendingProps,p=h.revealOrder,y=h.tail;if(er(r,i,h.children,o),h=Wt.current,(h&2)!==0)h=h&1|2,i.flags|=128;else{if(r!==null&&(r.flags&128)!==0)e:for(r=i.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&og(r,o,i);else if(r.tag===19)og(r,o,i);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===i)break e;for(;r.sibling===null;){if(r.return===null||r.return===i)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}h&=1}if(kt(Wt,h),(i.mode&1)===0)i.memoizedState=null;else switch(p){case"forwards":for(o=i.child,p=null;o!==null;)r=o.alternate,r!==null&&Ac(r)===null&&(p=o),o=o.sibling;o=p,o===null?(p=i.child,i.child=null):(p=o.sibling,o.sibling=null),fh(i,!1,p,o,y);break;case"backwards":for(o=null,p=i.child,i.child=null;p!==null;){if(r=p.alternate,r!==null&&Ac(r)===null){i.child=p;break}r=p.sibling,p.sibling=o,o=p,p=r}fh(i,!0,o,null,y);break;case"together":fh(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function Mc(r,i){(i.mode&1)===0&&r!==null&&(r.alternate=null,i.alternate=null,i.flags|=2)}function $s(r,i,o){if(r!==null&&(i.dependencies=r.dependencies),oa|=i.lanes,(o&i.childLanes)===0)return null;if(r!==null&&i.child!==r.child)throw Error(t(153));if(i.child!==null){for(r=i.child,o=_i(r,r.pendingProps),i.child=o,o.return=i;r.sibling!==null;)r=r.sibling,o=o.sibling=_i(r,r.pendingProps),o.return=i;o.sibling=null}return i.child}function mx(r,i,o){switch(i.tag){case 3:sg(i),Qa();break;case 5:Em(i);break;case 1:ar(i.type)&&wc(i);break;case 4:Gd(i,i.stateNode.containerInfo);break;case 10:var h=i.type._context,p=i.memoizedProps.value;kt(Cc,h._currentValue),h._currentValue=p;break;case 13:if(h=i.memoizedState,h!==null)return h.dehydrated!==null?(kt(Wt,Wt.current&1),i.flags|=128,null):(o&i.child.childLanes)!==0?ag(r,i,o):(kt(Wt,Wt.current&1),r=$s(r,i,o),r!==null?r.sibling:null);kt(Wt,Wt.current&1);break;case 19:if(h=(o&i.childLanes)!==0,(r.flags&128)!==0){if(h)return lg(r,i,o);i.flags|=128}if(p=i.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),kt(Wt,Wt.current),h)break;return null;case 22:case 23:return i.lanes=0,tg(r,i,o)}return $s(r,i,o)}var cg,ph,ug,dg;cg=function(r,i){for(var o=i.child;o!==null;){if(o.tag===5||o.tag===6)r.appendChild(o.stateNode);else if(o.tag!==4&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return;o=o.return}o.sibling.return=o.return,o=o.sibling}},ph=function(){},ug=function(r,i,o,h){var p=r.memoizedProps;if(p!==h){r=i.stateNode,ia(ms.current);var y=null;switch(o){case"input":p=Ue(r,p),h=Ue(r,h),y=[];break;case"select":p=se({},p,{value:void 0}),h=se({},h,{value:void 0}),y=[];break;case"textarea":p=ln(r,p),h=ln(r,h),y=[];break;default:typeof p.onClick!="function"&&typeof h.onClick=="function"&&(r.onclick=yc)}Rs(o,h);var x;o=null;for(X in p)if(!h.hasOwnProperty(X)&&p.hasOwnProperty(X)&&p[X]!=null)if(X==="style"){var N=p[X];for(x in N)N.hasOwnProperty(x)&&(o||(o={}),o[x]="")}else X!=="dangerouslySetInnerHTML"&&X!=="children"&&X!=="suppressContentEditableWarning"&&X!=="suppressHydrationWarning"&&X!=="autoFocus"&&(a.hasOwnProperty(X)?y||(y=[]):(y=y||[]).push(X,null));for(X in h){var M=h[X];if(N=p!=null?p[X]:void 0,h.hasOwnProperty(X)&&M!==N&&(M!=null||N!=null))if(X==="style")if(N){for(x in N)!N.hasOwnProperty(x)||M&&M.hasOwnProperty(x)||(o||(o={}),o[x]="");for(x in M)M.hasOwnProperty(x)&&N[x]!==M[x]&&(o||(o={}),o[x]=M[x])}else o||(y||(y=[]),y.push(X,o)),o=M;else X==="dangerouslySetInnerHTML"?(M=M?M.__html:void 0,N=N?N.__html:void 0,M!=null&&N!==M&&(y=y||[]).push(X,M)):X==="children"?typeof M!="string"&&typeof M!="number"||(y=y||[]).push(X,""+M):X!=="suppressContentEditableWarning"&&X!=="suppressHydrationWarning"&&(a.hasOwnProperty(X)?(M!=null&&X==="onScroll"&&Dt("scroll",r),y||N===M||(y=[])):(y=y||[]).push(X,M))}o&&(y=y||[]).push("style",o);var X=y;(i.updateQueue=X)&&(i.flags|=4)}},dg=function(r,i,o,h){o!==h&&(i.flags|=4)};function sl(r,i){if(!Ut)switch(r.tailMode){case"hidden":i=r.tail;for(var o=null;i!==null;)i.alternate!==null&&(o=i),i=i.sibling;o===null?r.tail=null:o.sibling=null;break;case"collapsed":o=r.tail;for(var h=null;o!==null;)o.alternate!==null&&(h=o),o=o.sibling;h===null?i||r.tail===null?r.tail=null:r.tail.sibling=null:h.sibling=null}}function zn(r){var i=r.alternate!==null&&r.alternate.child===r.child,o=0,h=0;if(i)for(var p=r.child;p!==null;)o|=p.lanes|p.childLanes,h|=p.subtreeFlags&14680064,h|=p.flags&14680064,p.return=r,p=p.sibling;else for(p=r.child;p!==null;)o|=p.lanes|p.childLanes,h|=p.subtreeFlags,h|=p.flags,p.return=r,p=p.sibling;return r.subtreeFlags|=h,r.childLanes=o,i}function gx(r,i,o){var h=i.pendingProps;switch(Vd(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return zn(i),null;case 1:return ar(i.type)&&_c(),zn(i),null;case 3:return h=i.stateNode,Za(),Lt(ir),Lt(Fn),Qd(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(r===null||r.child===null)&&(Sc(i)?i.flags|=4:r===null||r.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,qr!==null&&(Ih(qr),qr=null))),ph(r,i),zn(i),null;case 5:qd(i);var p=ia(Zo.current);if(o=i.type,r!==null&&i.stateNode!=null)ug(r,i,o,h,p),r.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!h){if(i.stateNode===null)throw Error(t(166));return zn(i),null}if(r=ia(ms.current),Sc(i)){h=i.stateNode,o=i.type;var y=i.memoizedProps;switch(h[ps]=i,h[Ko]=y,r=(i.mode&1)!==0,o){case"dialog":Dt("cancel",h),Dt("close",h);break;case"iframe":case"object":case"embed":Dt("load",h);break;case"video":case"audio":for(p=0;p<Ho.length;p++)Dt(Ho[p],h);break;case"source":Dt("error",h);break;case"img":case"image":case"link":Dt("error",h),Dt("load",h);break;case"details":Dt("toggle",h);break;case"input":Tt(h,y),Dt("invalid",h);break;case"select":h._wrapperState={wasMultiple:!!y.multiple},Dt("invalid",h);break;case"textarea":vn(h,y),Dt("invalid",h)}Rs(o,y),p=null;for(var x in y)if(y.hasOwnProperty(x)){var N=y[x];x==="children"?typeof N=="string"?h.textContent!==N&&(y.suppressHydrationWarning!==!0&&gc(h.textContent,N,r),p=["children",N]):typeof N=="number"&&h.textContent!==""+N&&(y.suppressHydrationWarning!==!0&&gc(h.textContent,N,r),p=["children",""+N]):a.hasOwnProperty(x)&&N!=null&&x==="onScroll"&&Dt("scroll",h)}switch(o){case"input":de(h),bt(h,y,!0);break;case"textarea":de(h),Mr(h);break;case"select":case"option":break;default:typeof y.onClick=="function"&&(h.onclick=yc)}h=p,i.updateQueue=h,h!==null&&(i.flags|=4)}else{x=p.nodeType===9?p:p.ownerDocument,r==="http://www.w3.org/1999/xhtml"&&(r=Bt(o)),r==="http://www.w3.org/1999/xhtml"?o==="script"?(r=x.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild)):typeof h.is=="string"?r=x.createElement(o,{is:h.is}):(r=x.createElement(o),o==="select"&&(x=r,h.multiple?x.multiple=!0:h.size&&(x.size=h.size))):r=x.createElementNS(r,o),r[ps]=i,r[Ko]=h,cg(r,i,!1,!1),i.stateNode=r;e:{switch(x=As(o,h),o){case"dialog":Dt("cancel",r),Dt("close",r),p=h;break;case"iframe":case"object":case"embed":Dt("load",r),p=h;break;case"video":case"audio":for(p=0;p<Ho.length;p++)Dt(Ho[p],r);p=h;break;case"source":Dt("error",r),p=h;break;case"img":case"image":case"link":Dt("error",r),Dt("load",r),p=h;break;case"details":Dt("toggle",r),p=h;break;case"input":Tt(r,h),p=Ue(r,h),Dt("invalid",r);break;case"option":p=h;break;case"select":r._wrapperState={wasMultiple:!!h.multiple},p=se({},h,{value:void 0}),Dt("invalid",r);break;case"textarea":vn(r,h),p=ln(r,h),Dt("invalid",r);break;default:p=h}Rs(o,p),N=p;for(y in N)if(N.hasOwnProperty(y)){var M=N[y];y==="style"?In(r,M):y==="dangerouslySetInnerHTML"?(M=M?M.__html:void 0,M!=null&&bs(r,M)):y==="children"?typeof M=="string"?(o!=="textarea"||M!=="")&&fr(r,M):typeof M=="number"&&fr(r,""+M):y!=="suppressContentEditableWarning"&&y!=="suppressHydrationWarning"&&y!=="autoFocus"&&(a.hasOwnProperty(y)?M!=null&&y==="onScroll"&&Dt("scroll",r):M!=null&&ne(r,y,M,x))}switch(o){case"input":de(r),bt(r,h,!1);break;case"textarea":de(r),Mr(r);break;case"option":h.value!=null&&r.setAttribute("value",""+Ke(h.value));break;case"select":r.multiple=!!h.multiple,y=h.value,y!=null?Sn(r,!!h.multiple,y,!1):h.defaultValue!=null&&Sn(r,!!h.multiple,h.defaultValue,!0);break;default:typeof p.onClick=="function"&&(r.onclick=yc)}switch(o){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}}h&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return zn(i),null;case 6:if(r&&i.stateNode!=null)dg(r,i,r.memoizedProps,h);else{if(typeof h!="string"&&i.stateNode===null)throw Error(t(166));if(o=ia(Zo.current),ia(ms.current),Sc(i)){if(h=i.stateNode,o=i.memoizedProps,h[ps]=i,(y=h.nodeValue!==o)&&(r=_r,r!==null))switch(r.tag){case 3:gc(h.nodeValue,o,(r.mode&1)!==0);break;case 5:r.memoizedProps.suppressHydrationWarning!==!0&&gc(h.nodeValue,o,(r.mode&1)!==0)}y&&(i.flags|=4)}else h=(o.nodeType===9?o:o.ownerDocument).createTextNode(h),h[ps]=i,i.stateNode=h}return zn(i),null;case 13:if(Lt(Wt),h=i.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(Ut&&wr!==null&&(i.mode&1)!==0&&(i.flags&128)===0)pm(),Qa(),i.flags|=98560,y=!1;else if(y=Sc(i),h!==null&&h.dehydrated!==null){if(r===null){if(!y)throw Error(t(318));if(y=i.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(t(317));y[ps]=i}else Qa(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;zn(i),y=!1}else qr!==null&&(Ih(qr),qr=null),y=!0;if(!y)return i.flags&65536?i:null}return(i.flags&128)!==0?(i.lanes=o,i):(h=h!==null,h!==(r!==null&&r.memoizedState!==null)&&h&&(i.child.flags|=8192,(i.mode&1)!==0&&(r===null||(Wt.current&1)!==0?mn===0&&(mn=3):bh())),i.updateQueue!==null&&(i.flags|=4),zn(i),null);case 4:return Za(),ph(r,i),r===null&&Go(i.stateNode.containerInfo),zn(i),null;case 10:return Bd(i.type._context),zn(i),null;case 17:return ar(i.type)&&_c(),zn(i),null;case 19:if(Lt(Wt),y=i.memoizedState,y===null)return zn(i),null;if(h=(i.flags&128)!==0,x=y.rendering,x===null)if(h)sl(y,!1);else{if(mn!==0||r!==null&&(r.flags&128)!==0)for(r=i.child;r!==null;){if(x=Ac(r),x!==null){for(i.flags|=128,sl(y,!1),h=x.updateQueue,h!==null&&(i.updateQueue=h,i.flags|=4),i.subtreeFlags=0,h=o,o=i.child;o!==null;)y=o,r=h,y.flags&=14680066,x=y.alternate,x===null?(y.childLanes=0,y.lanes=r,y.child=null,y.subtreeFlags=0,y.memoizedProps=null,y.memoizedState=null,y.updateQueue=null,y.dependencies=null,y.stateNode=null):(y.childLanes=x.childLanes,y.lanes=x.lanes,y.child=x.child,y.subtreeFlags=0,y.deletions=null,y.memoizedProps=x.memoizedProps,y.memoizedState=x.memoizedState,y.updateQueue=x.updateQueue,y.type=x.type,r=x.dependencies,y.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),o=o.sibling;return kt(Wt,Wt.current&1|2),i.child}r=r.sibling}y.tail!==null&&vt()>ro&&(i.flags|=128,h=!0,sl(y,!1),i.lanes=4194304)}else{if(!h)if(r=Ac(x),r!==null){if(i.flags|=128,h=!0,o=r.updateQueue,o!==null&&(i.updateQueue=o,i.flags|=4),sl(y,!0),y.tail===null&&y.tailMode==="hidden"&&!x.alternate&&!Ut)return zn(i),null}else 2*vt()-y.renderingStartTime>ro&&o!==1073741824&&(i.flags|=128,h=!0,sl(y,!1),i.lanes=4194304);y.isBackwards?(x.sibling=i.child,i.child=x):(o=y.last,o!==null?o.sibling=x:i.child=x,y.last=x)}return y.tail!==null?(i=y.tail,y.rendering=i,y.tail=i.sibling,y.renderingStartTime=vt(),i.sibling=null,o=Wt.current,kt(Wt,h?o&1|2:o&1),i):(zn(i),null);case 22:case 23:return Ph(),h=i.memoizedState!==null,r!==null&&r.memoizedState!==null!==h&&(i.flags|=8192),h&&(i.mode&1)!==0?(xr&1073741824)!==0&&(zn(i),i.subtreeFlags&6&&(i.flags|=8192)):zn(i),null;case 24:return null;case 25:return null}throw Error(t(156,i.tag))}function yx(r,i){switch(Vd(i),i.tag){case 1:return ar(i.type)&&_c(),r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 3:return Za(),Lt(ir),Lt(Fn),Qd(),r=i.flags,(r&65536)!==0&&(r&128)===0?(i.flags=r&-65537|128,i):null;case 5:return qd(i),null;case 13:if(Lt(Wt),r=i.memoizedState,r!==null&&r.dehydrated!==null){if(i.alternate===null)throw Error(t(340));Qa()}return r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 19:return Lt(Wt),null;case 4:return Za(),null;case 10:return Bd(i.type._context),null;case 22:case 23:return Ph(),null;case 24:return null;default:return null}}var Fc=!1,Bn=!1,vx=typeof WeakSet=="function"?WeakSet:Set,Ae=null;function to(r,i){var o=r.ref;if(o!==null)if(typeof o=="function")try{o(null)}catch(h){Kt(r,i,h)}else o.current=null}function mh(r,i,o){try{o()}catch(h){Kt(r,i,h)}}var hg=!1;function _x(r,i){if(Pd=ii,r=Wp(),_d(r)){if("selectionStart"in r)var o={start:r.selectionStart,end:r.selectionEnd};else e:{o=(o=r.ownerDocument)&&o.defaultView||window;var h=o.getSelection&&o.getSelection();if(h&&h.rangeCount!==0){o=h.anchorNode;var p=h.anchorOffset,y=h.focusNode;h=h.focusOffset;try{o.nodeType,y.nodeType}catch{o=null;break e}var x=0,N=-1,M=-1,X=0,he=0,fe=r,ue=null;t:for(;;){for(var be;fe!==o||p!==0&&fe.nodeType!==3||(N=x+p),fe!==y||h!==0&&fe.nodeType!==3||(M=x+h),fe.nodeType===3&&(x+=fe.nodeValue.length),(be=fe.firstChild)!==null;)ue=fe,fe=be;for(;;){if(fe===r)break t;if(ue===o&&++X===p&&(N=x),ue===y&&++he===h&&(M=x),(be=fe.nextSibling)!==null)break;fe=ue,ue=fe.parentNode}fe=be}o=N===-1||M===-1?null:{start:N,end:M}}else o=null}o=o||{start:0,end:0}}else o=null;for(bd={focusedElem:r,selectionRange:o},ii=!1,Ae=i;Ae!==null;)if(i=Ae,r=i.child,(i.subtreeFlags&1028)!==0&&r!==null)r.return=i,Ae=r;else for(;Ae!==null;){i=Ae;try{var Ne=i.alternate;if((i.flags&1024)!==0)switch(i.tag){case 0:case 11:case 15:break;case 1:if(Ne!==null){var je=Ne.memoizedProps,Jt=Ne.memoizedState,q=i.stateNode,z=q.getSnapshotBeforeUpdate(i.elementType===i.type?je:Kr(i.type,je),Jt);q.__reactInternalSnapshotBeforeUpdate=z}break;case 3:var Q=i.stateNode.containerInfo;Q.nodeType===1?Q.textContent="":Q.nodeType===9&&Q.documentElement&&Q.removeChild(Q.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(_e){Kt(i,i.return,_e)}if(r=i.sibling,r!==null){r.return=i.return,Ae=r;break}Ae=i.return}return Ne=hg,hg=!1,Ne}function il(r,i,o){var h=i.updateQueue;if(h=h!==null?h.lastEffect:null,h!==null){var p=h=h.next;do{if((p.tag&r)===r){var y=p.destroy;p.destroy=void 0,y!==void 0&&mh(i,o,y)}p=p.next}while(p!==h)}}function Uc(r,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var o=i=i.next;do{if((o.tag&r)===r){var h=o.create;o.destroy=h()}o=o.next}while(o!==i)}}function gh(r){var i=r.ref;if(i!==null){var o=r.stateNode;switch(r.tag){case 5:r=o;break;default:r=o}typeof i=="function"?i(r):i.current=r}}function fg(r){var i=r.alternate;i!==null&&(r.alternate=null,fg(i)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(i=r.stateNode,i!==null&&(delete i[ps],delete i[Ko],delete i[kd],delete i[tx],delete i[nx])),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}function pg(r){return r.tag===5||r.tag===3||r.tag===4}function mg(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||pg(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function yh(r,i,o){var h=r.tag;if(h===5||h===6)r=r.stateNode,i?o.nodeType===8?o.parentNode.insertBefore(r,i):o.insertBefore(r,i):(o.nodeType===8?(i=o.parentNode,i.insertBefore(r,o)):(i=o,i.appendChild(r)),o=o._reactRootContainer,o!=null||i.onclick!==null||(i.onclick=yc));else if(h!==4&&(r=r.child,r!==null))for(yh(r,i,o),r=r.sibling;r!==null;)yh(r,i,o),r=r.sibling}function vh(r,i,o){var h=r.tag;if(h===5||h===6)r=r.stateNode,i?o.insertBefore(r,i):o.appendChild(r);else if(h!==4&&(r=r.child,r!==null))for(vh(r,i,o),r=r.sibling;r!==null;)vh(r,i,o),r=r.sibling}var Rn=null,Qr=!1;function pi(r,i,o){for(o=o.child;o!==null;)gg(r,i,o),o=o.sibling}function gg(r,i,o){if(S&&typeof S.onCommitFiberUnmount=="function")try{S.onCommitFiberUnmount(ks,o)}catch{}switch(o.tag){case 5:Bn||to(o,i);case 6:var h=Rn,p=Qr;Rn=null,pi(r,i,o),Rn=h,Qr=p,Rn!==null&&(Qr?(r=Rn,o=o.stateNode,r.nodeType===8?r.parentNode.removeChild(o):r.removeChild(o)):Rn.removeChild(o.stateNode));break;case 18:Rn!==null&&(Qr?(r=Rn,o=o.stateNode,r.nodeType===8?Nd(r.parentNode,o):r.nodeType===1&&Nd(r,o),Wr(r)):Nd(Rn,o.stateNode));break;case 4:h=Rn,p=Qr,Rn=o.stateNode.containerInfo,Qr=!0,pi(r,i,o),Rn=h,Qr=p;break;case 0:case 11:case 14:case 15:if(!Bn&&(h=o.updateQueue,h!==null&&(h=h.lastEffect,h!==null))){p=h=h.next;do{var y=p,x=y.destroy;y=y.tag,x!==void 0&&((y&2)!==0||(y&4)!==0)&&mh(o,i,x),p=p.next}while(p!==h)}pi(r,i,o);break;case 1:if(!Bn&&(to(o,i),h=o.stateNode,typeof h.componentWillUnmount=="function"))try{h.props=o.memoizedProps,h.state=o.memoizedState,h.componentWillUnmount()}catch(N){Kt(o,i,N)}pi(r,i,o);break;case 21:pi(r,i,o);break;case 22:o.mode&1?(Bn=(h=Bn)||o.memoizedState!==null,pi(r,i,o),Bn=h):pi(r,i,o);break;default:pi(r,i,o)}}function yg(r){var i=r.updateQueue;if(i!==null){r.updateQueue=null;var o=r.stateNode;o===null&&(o=r.stateNode=new vx),i.forEach(function(h){var p=bx.bind(null,r,h);o.has(h)||(o.add(h),h.then(p,p))})}}function Yr(r,i){var o=i.deletions;if(o!==null)for(var h=0;h<o.length;h++){var p=o[h];try{var y=r,x=i,N=x;e:for(;N!==null;){switch(N.tag){case 5:Rn=N.stateNode,Qr=!1;break e;case 3:Rn=N.stateNode.containerInfo,Qr=!0;break e;case 4:Rn=N.stateNode.containerInfo,Qr=!0;break e}N=N.return}if(Rn===null)throw Error(t(160));gg(y,x,p),Rn=null,Qr=!1;var M=p.alternate;M!==null&&(M.return=null),p.return=null}catch(X){Kt(p,i,X)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)vg(i,r),i=i.sibling}function vg(r,i){var o=r.alternate,h=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:if(Yr(i,r),ys(r),h&4){try{il(3,r,r.return),Uc(3,r)}catch(je){Kt(r,r.return,je)}try{il(5,r,r.return)}catch(je){Kt(r,r.return,je)}}break;case 1:Yr(i,r),ys(r),h&512&&o!==null&&to(o,o.return);break;case 5:if(Yr(i,r),ys(r),h&512&&o!==null&&to(o,o.return),r.flags&32){var p=r.stateNode;try{fr(p,"")}catch(je){Kt(r,r.return,je)}}if(h&4&&(p=r.stateNode,p!=null)){var y=r.memoizedProps,x=o!==null?o.memoizedProps:y,N=r.type,M=r.updateQueue;if(r.updateQueue=null,M!==null)try{N==="input"&&y.type==="radio"&&y.name!=null&&Ct(p,y),As(N,x);var X=As(N,y);for(x=0;x<M.length;x+=2){var he=M[x],fe=M[x+1];he==="style"?In(p,fe):he==="dangerouslySetInnerHTML"?bs(p,fe):he==="children"?fr(p,fe):ne(p,he,fe,X)}switch(N){case"input":Pt(p,y);break;case"textarea":Qt(p,y);break;case"select":var ue=p._wrapperState.wasMultiple;p._wrapperState.wasMultiple=!!y.multiple;var be=y.value;be!=null?Sn(p,!!y.multiple,be,!1):ue!==!!y.multiple&&(y.defaultValue!=null?Sn(p,!!y.multiple,y.defaultValue,!0):Sn(p,!!y.multiple,y.multiple?[]:"",!1))}p[Ko]=y}catch(je){Kt(r,r.return,je)}}break;case 6:if(Yr(i,r),ys(r),h&4){if(r.stateNode===null)throw Error(t(162));p=r.stateNode,y=r.memoizedProps;try{p.nodeValue=y}catch(je){Kt(r,r.return,je)}}break;case 3:if(Yr(i,r),ys(r),h&4&&o!==null&&o.memoizedState.isDehydrated)try{Wr(i.containerInfo)}catch(je){Kt(r,r.return,je)}break;case 4:Yr(i,r),ys(r);break;case 13:Yr(i,r),ys(r),p=r.child,p.flags&8192&&(y=p.memoizedState!==null,p.stateNode.isHidden=y,!y||p.alternate!==null&&p.alternate.memoizedState!==null||(xh=vt())),h&4&&yg(r);break;case 22:if(he=o!==null&&o.memoizedState!==null,r.mode&1?(Bn=(X=Bn)||he,Yr(i,r),Bn=X):Yr(i,r),ys(r),h&8192){if(X=r.memoizedState!==null,(r.stateNode.isHidden=X)&&!he&&(r.mode&1)!==0)for(Ae=r,he=r.child;he!==null;){for(fe=Ae=he;Ae!==null;){switch(ue=Ae,be=ue.child,ue.tag){case 0:case 11:case 14:case 15:il(4,ue,ue.return);break;case 1:to(ue,ue.return);var Ne=ue.stateNode;if(typeof Ne.componentWillUnmount=="function"){h=ue,o=ue.return;try{i=h,Ne.props=i.memoizedProps,Ne.state=i.memoizedState,Ne.componentWillUnmount()}catch(je){Kt(h,o,je)}}break;case 5:to(ue,ue.return);break;case 22:if(ue.memoizedState!==null){xg(fe);continue}}be!==null?(be.return=ue,Ae=be):xg(fe)}he=he.sibling}e:for(he=null,fe=r;;){if(fe.tag===5){if(he===null){he=fe;try{p=fe.stateNode,X?(y=p.style,typeof y.setProperty=="function"?y.setProperty("display","none","important"):y.display="none"):(N=fe.stateNode,M=fe.memoizedProps.style,x=M!=null&&M.hasOwnProperty("display")?M.display:null,N.style.display=ss("display",x))}catch(je){Kt(r,r.return,je)}}}else if(fe.tag===6){if(he===null)try{fe.stateNode.nodeValue=X?"":fe.memoizedProps}catch(je){Kt(r,r.return,je)}}else if((fe.tag!==22&&fe.tag!==23||fe.memoizedState===null||fe===r)&&fe.child!==null){fe.child.return=fe,fe=fe.child;continue}if(fe===r)break e;for(;fe.sibling===null;){if(fe.return===null||fe.return===r)break e;he===fe&&(he=null),fe=fe.return}he===fe&&(he=null),fe.sibling.return=fe.return,fe=fe.sibling}}break;case 19:Yr(i,r),ys(r),h&4&&yg(r);break;case 21:break;default:Yr(i,r),ys(r)}}function ys(r){var i=r.flags;if(i&2){try{e:{for(var o=r.return;o!==null;){if(pg(o)){var h=o;break e}o=o.return}throw Error(t(160))}switch(h.tag){case 5:var p=h.stateNode;h.flags&32&&(fr(p,""),h.flags&=-33);var y=mg(r);vh(r,y,p);break;case 3:case 4:var x=h.stateNode.containerInfo,N=mg(r);yh(r,N,x);break;default:throw Error(t(161))}}catch(M){Kt(r,r.return,M)}r.flags&=-3}i&4096&&(r.flags&=-4097)}function wx(r,i,o){Ae=r,_g(r)}function _g(r,i,o){for(var h=(r.mode&1)!==0;Ae!==null;){var p=Ae,y=p.child;if(p.tag===22&&h){var x=p.memoizedState!==null||Fc;if(!x){var N=p.alternate,M=N!==null&&N.memoizedState!==null||Bn;N=Fc;var X=Bn;if(Fc=x,(Bn=M)&&!X)for(Ae=p;Ae!==null;)x=Ae,M=x.child,x.tag===22&&x.memoizedState!==null?Eg(p):M!==null?(M.return=x,Ae=M):Eg(p);for(;y!==null;)Ae=y,_g(y),y=y.sibling;Ae=p,Fc=N,Bn=X}wg(r)}else(p.subtreeFlags&8772)!==0&&y!==null?(y.return=p,Ae=y):wg(r)}}function wg(r){for(;Ae!==null;){var i=Ae;if((i.flags&8772)!==0){var o=i.alternate;try{if((i.flags&8772)!==0)switch(i.tag){case 0:case 11:case 15:Bn||Uc(5,i);break;case 1:var h=i.stateNode;if(i.flags&4&&!Bn)if(o===null)h.componentDidMount();else{var p=i.elementType===i.type?o.memoizedProps:Kr(i.type,o.memoizedProps);h.componentDidUpdate(p,o.memoizedState,h.__reactInternalSnapshotBeforeUpdate)}var y=i.updateQueue;y!==null&&xm(i,y,h);break;case 3:var x=i.updateQueue;if(x!==null){if(o=null,i.child!==null)switch(i.child.tag){case 5:o=i.child.stateNode;break;case 1:o=i.child.stateNode}xm(i,x,o)}break;case 5:var N=i.stateNode;if(o===null&&i.flags&4){o=N;var M=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":M.autoFocus&&o.focus();break;case"img":M.src&&(o.src=M.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var X=i.alternate;if(X!==null){var he=X.memoizedState;if(he!==null){var fe=he.dehydrated;fe!==null&&Wr(fe)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Bn||i.flags&512&&gh(i)}catch(ue){Kt(i,i.return,ue)}}if(i===r){Ae=null;break}if(o=i.sibling,o!==null){o.return=i.return,Ae=o;break}Ae=i.return}}function xg(r){for(;Ae!==null;){var i=Ae;if(i===r){Ae=null;break}var o=i.sibling;if(o!==null){o.return=i.return,Ae=o;break}Ae=i.return}}function Eg(r){for(;Ae!==null;){var i=Ae;try{switch(i.tag){case 0:case 11:case 15:var o=i.return;try{Uc(4,i)}catch(M){Kt(i,o,M)}break;case 1:var h=i.stateNode;if(typeof h.componentDidMount=="function"){var p=i.return;try{h.componentDidMount()}catch(M){Kt(i,p,M)}}var y=i.return;try{gh(i)}catch(M){Kt(i,y,M)}break;case 5:var x=i.return;try{gh(i)}catch(M){Kt(i,x,M)}}}catch(M){Kt(i,i.return,M)}if(i===r){Ae=null;break}var N=i.sibling;if(N!==null){N.return=i.return,Ae=N;break}Ae=i.return}}var xx=Math.ceil,zc=oe.ReactCurrentDispatcher,_h=oe.ReactCurrentOwner,kr=oe.ReactCurrentBatchConfig,pt=0,xn=null,nn=null,An=0,xr=0,no=ci(0),mn=0,al=null,oa=0,Bc=0,wh=0,ol=null,lr=null,xh=0,ro=1/0,Ws=null,$c=!1,Eh=null,mi=null,Wc=!1,gi=null,Hc=0,ll=0,Th=null,Gc=-1,qc=0;function tr(){return(pt&6)!==0?vt():Gc!==-1?Gc:Gc=vt()}function yi(r){return(r.mode&1)===0?1:(pt&2)!==0&&An!==0?An&-An:sx.transition!==null?(qc===0&&(qc=$t()),qc):(r=rt,r!==0||(r=window.event,r=r===void 0?16:Vo(r.type)),r)}function Jr(r,i,o,h){if(50<ll)throw ll=0,Th=null,Error(t(185));Xn(r,o,h),((pt&2)===0||r!==xn)&&(r===xn&&((pt&2)===0&&(Bc|=o),mn===4&&vi(r,An)),cr(r,h),o===1&&pt===0&&(i.mode&1)===0&&(ro=vt()+500,xc&&di()))}function cr(r,i){var o=r.callbackNode;Nt(r,i);var h=xt(r,r===xn?An:0);if(h===0)o!==null&&gr(o),r.callbackNode=null,r.callbackPriority=0;else if(i=h&-h,r.callbackPriority!==i){if(o!=null&&gr(o),i===1)r.tag===0?rx(Sg.bind(null,r)):cm(Sg.bind(null,r)),Zw(function(){(pt&6)===0&&di()}),o=null;else{switch(os(h)){case 1:o=Ns;break;case 4:o=On;break;case 16:o=Jn;break;case 536870912:o=Ca;break;default:o=Jn}o=kg(o,Tg.bind(null,r))}r.callbackPriority=i,r.callbackNode=o}}function Tg(r,i){if(Gc=-1,qc=0,(pt&6)!==0)throw Error(t(327));var o=r.callbackNode;if(so()&&r.callbackNode!==o)return null;var h=xt(r,r===xn?An:0);if(h===0)return null;if((h&30)!==0||(h&r.expiredLanes)!==0||i)i=Kc(r,h);else{i=h;var p=pt;pt|=2;var y=Cg();(xn!==r||An!==i)&&(Ws=null,ro=vt()+500,ca(r,i));do try{Sx();break}catch(N){Ig(r,N)}while(!0);zd(),zc.current=y,pt=p,nn!==null?i=0:(xn=null,An=0,i=mn)}if(i!==0){if(i===2&&(p=Mt(r),p!==0&&(h=p,i=Sh(r,p))),i===1)throw o=al,ca(r,0),vi(r,h),cr(r,vt()),o;if(i===6)vi(r,h);else{if(p=r.current.alternate,(h&30)===0&&!Ex(p)&&(i=Kc(r,h),i===2&&(y=Mt(r),y!==0&&(h=y,i=Sh(r,y))),i===1))throw o=al,ca(r,0),vi(r,h),cr(r,vt()),o;switch(r.finishedWork=p,r.finishedLanes=h,i){case 0:case 1:throw Error(t(345));case 2:ua(r,lr,Ws);break;case 3:if(vi(r,h),(h&130023424)===h&&(i=xh+500-vt(),10<i)){if(xt(r,0)!==0)break;if(p=r.suspendedLanes,(p&h)!==h){tr(),r.pingedLanes|=r.suspendedLanes&p;break}r.timeoutHandle=Ad(ua.bind(null,r,lr,Ws),i);break}ua(r,lr,Ws);break;case 4:if(vi(r,h),(h&4194240)===h)break;for(i=r.eventTimes,p=-1;0<h;){var x=31-W(h);y=1<<x,x=i[x],x>p&&(p=x),h&=~y}if(h=p,h=vt()-h,h=(120>h?120:480>h?480:1080>h?1080:1920>h?1920:3e3>h?3e3:4320>h?4320:1960*xx(h/1960))-h,10<h){r.timeoutHandle=Ad(ua.bind(null,r,lr,Ws),h);break}ua(r,lr,Ws);break;case 5:ua(r,lr,Ws);break;default:throw Error(t(329))}}}return cr(r,vt()),r.callbackNode===o?Tg.bind(null,r):null}function Sh(r,i){var o=ol;return r.current.memoizedState.isDehydrated&&(ca(r,i).flags|=256),r=Kc(r,i),r!==2&&(i=lr,lr=o,i!==null&&Ih(i)),r}function Ih(r){lr===null?lr=r:lr.push.apply(lr,r)}function Ex(r){for(var i=r;;){if(i.flags&16384){var o=i.updateQueue;if(o!==null&&(o=o.stores,o!==null))for(var h=0;h<o.length;h++){var p=o[h],y=p.getSnapshot;p=p.value;try{if(!Gr(y(),p))return!1}catch{return!1}}}if(o=i.child,i.subtreeFlags&16384&&o!==null)o.return=i,i=o;else{if(i===r)break;for(;i.sibling===null;){if(i.return===null||i.return===r)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function vi(r,i){for(i&=~wh,i&=~Bc,r.suspendedLanes|=i,r.pingedLanes&=~i,r=r.expirationTimes;0<i;){var o=31-W(i),h=1<<o;r[o]=-1,i&=~h}}function Sg(r){if((pt&6)!==0)throw Error(t(327));so();var i=xt(r,0);if((i&1)===0)return cr(r,vt()),null;var o=Kc(r,i);if(r.tag!==0&&o===2){var h=Mt(r);h!==0&&(i=h,o=Sh(r,h))}if(o===1)throw o=al,ca(r,0),vi(r,i),cr(r,vt()),o;if(o===6)throw Error(t(345));return r.finishedWork=r.current.alternate,r.finishedLanes=i,ua(r,lr,Ws),cr(r,vt()),null}function Ch(r,i){var o=pt;pt|=1;try{return r(i)}finally{pt=o,pt===0&&(ro=vt()+500,xc&&di())}}function la(r){gi!==null&&gi.tag===0&&(pt&6)===0&&so();var i=pt;pt|=1;var o=kr.transition,h=rt;try{if(kr.transition=null,rt=1,r)return r()}finally{rt=h,kr.transition=o,pt=i,(pt&6)===0&&di()}}function Ph(){xr=no.current,Lt(no)}function ca(r,i){r.finishedWork=null,r.finishedLanes=0;var o=r.timeoutHandle;if(o!==-1&&(r.timeoutHandle=-1,Xw(o)),nn!==null)for(o=nn.return;o!==null;){var h=o;switch(Vd(h),h.tag){case 1:h=h.type.childContextTypes,h!=null&&_c();break;case 3:Za(),Lt(ir),Lt(Fn),Qd();break;case 5:qd(h);break;case 4:Za();break;case 13:Lt(Wt);break;case 19:Lt(Wt);break;case 10:Bd(h.type._context);break;case 22:case 23:Ph()}o=o.return}if(xn=r,nn=r=_i(r.current,null),An=xr=i,mn=0,al=null,wh=Bc=oa=0,lr=ol=null,sa!==null){for(i=0;i<sa.length;i++)if(o=sa[i],h=o.interleaved,h!==null){o.interleaved=null;var p=h.next,y=o.pending;if(y!==null){var x=y.next;y.next=p,h.next=x}o.pending=h}sa=null}return r}function Ig(r,i){do{var o=nn;try{if(zd(),Nc.current=Lc,kc){for(var h=Ht.memoizedState;h!==null;){var p=h.queue;p!==null&&(p.pending=null),h=h.next}kc=!1}if(aa=0,wn=pn=Ht=null,el=!1,tl=0,_h.current=null,o===null||o.return===null){mn=1,al=i,nn=null;break}e:{var y=r,x=o.return,N=o,M=i;if(i=An,N.flags|=32768,M!==null&&typeof M=="object"&&typeof M.then=="function"){var X=M,he=N,fe=he.tag;if((he.mode&1)===0&&(fe===0||fe===11||fe===15)){var ue=he.alternate;ue?(he.updateQueue=ue.updateQueue,he.memoizedState=ue.memoizedState,he.lanes=ue.lanes):(he.updateQueue=null,he.memoizedState=null)}var be=Ym(x);if(be!==null){be.flags&=-257,Jm(be,x,N,y,i),be.mode&1&&Qm(y,X,i),i=be,M=X;var Ne=i.updateQueue;if(Ne===null){var je=new Set;je.add(M),i.updateQueue=je}else Ne.add(M);break e}else{if((i&1)===0){Qm(y,X,i),bh();break e}M=Error(t(426))}}else if(Ut&&N.mode&1){var Jt=Ym(x);if(Jt!==null){(Jt.flags&65536)===0&&(Jt.flags|=256),Jm(Jt,x,N,y,i),Fd(eo(M,N));break e}}y=M=eo(M,N),mn!==4&&(mn=2),ol===null?ol=[y]:ol.push(y),y=x;do{switch(y.tag){case 3:y.flags|=65536,i&=-i,y.lanes|=i;var q=qm(y,M,i);wm(y,q);break e;case 1:N=M;var z=y.type,Q=y.stateNode;if((y.flags&128)===0&&(typeof z.getDerivedStateFromError=="function"||Q!==null&&typeof Q.componentDidCatch=="function"&&(mi===null||!mi.has(Q)))){y.flags|=65536,i&=-i,y.lanes|=i;var _e=Km(y,N,i);wm(y,_e);break e}}y=y.return}while(y!==null)}bg(o)}catch(Ve){i=Ve,nn===o&&o!==null&&(nn=o=o.return);continue}break}while(!0)}function Cg(){var r=zc.current;return zc.current=Lc,r===null?Lc:r}function bh(){(mn===0||mn===3||mn===2)&&(mn=4),xn===null||(oa&268435455)===0&&(Bc&268435455)===0||vi(xn,An)}function Kc(r,i){var o=pt;pt|=2;var h=Cg();(xn!==r||An!==i)&&(Ws=null,ca(r,i));do try{Tx();break}catch(p){Ig(r,p)}while(!0);if(zd(),pt=o,zc.current=h,nn!==null)throw Error(t(261));return xn=null,An=0,mn}function Tx(){for(;nn!==null;)Pg(nn)}function Sx(){for(;nn!==null&&!Yn();)Pg(nn)}function Pg(r){var i=Ng(r.alternate,r,xr);r.memoizedProps=r.pendingProps,i===null?bg(r):nn=i,_h.current=null}function bg(r){var i=r;do{var o=i.alternate;if(r=i.return,(i.flags&32768)===0){if(o=gx(o,i,xr),o!==null){nn=o;return}}else{if(o=yx(o,i),o!==null){o.flags&=32767,nn=o;return}if(r!==null)r.flags|=32768,r.subtreeFlags=0,r.deletions=null;else{mn=6,nn=null;return}}if(i=i.sibling,i!==null){nn=i;return}nn=i=r}while(i!==null);mn===0&&(mn=5)}function ua(r,i,o){var h=rt,p=kr.transition;try{kr.transition=null,rt=1,Ix(r,i,o,h)}finally{kr.transition=p,rt=h}return null}function Ix(r,i,o,h){do so();while(gi!==null);if((pt&6)!==0)throw Error(t(327));o=r.finishedWork;var p=r.finishedLanes;if(o===null)return null;if(r.finishedWork=null,r.finishedLanes=0,o===r.current)throw Error(t(177));r.callbackNode=null,r.callbackPriority=0;var y=o.lanes|o.childLanes;if(nt(r,y),r===xn&&(nn=xn=null,An=0),(o.subtreeFlags&2064)===0&&(o.flags&2064)===0||Wc||(Wc=!0,kg(Jn,function(){return so(),null})),y=(o.flags&15990)!==0,(o.subtreeFlags&15990)!==0||y){y=kr.transition,kr.transition=null;var x=rt;rt=1;var N=pt;pt|=4,_h.current=null,_x(r,o),vg(o,r),Hw(bd),ii=!!Pd,bd=Pd=null,r.current=o,wx(o),Ir(),pt=N,rt=x,kr.transition=y}else r.current=o;if(Wc&&(Wc=!1,gi=r,Hc=p),y=r.pendingLanes,y===0&&(mi=null),B(o.stateNode),cr(r,vt()),i!==null)for(h=r.onRecoverableError,o=0;o<i.length;o++)p=i[o],h(p.value,{componentStack:p.stack,digest:p.digest});if($c)throw $c=!1,r=Eh,Eh=null,r;return(Hc&1)!==0&&r.tag!==0&&so(),y=r.pendingLanes,(y&1)!==0?r===Th?ll++:(ll=0,Th=r):ll=0,di(),null}function so(){if(gi!==null){var r=os(Hc),i=kr.transition,o=rt;try{if(kr.transition=null,rt=16>r?16:r,gi===null)var h=!1;else{if(r=gi,gi=null,Hc=0,(pt&6)!==0)throw Error(t(331));var p=pt;for(pt|=4,Ae=r.current;Ae!==null;){var y=Ae,x=y.child;if((Ae.flags&16)!==0){var N=y.deletions;if(N!==null){for(var M=0;M<N.length;M++){var X=N[M];for(Ae=X;Ae!==null;){var he=Ae;switch(he.tag){case 0:case 11:case 15:il(8,he,y)}var fe=he.child;if(fe!==null)fe.return=he,Ae=fe;else for(;Ae!==null;){he=Ae;var ue=he.sibling,be=he.return;if(fg(he),he===X){Ae=null;break}if(ue!==null){ue.return=be,Ae=ue;break}Ae=be}}}var Ne=y.alternate;if(Ne!==null){var je=Ne.child;if(je!==null){Ne.child=null;do{var Jt=je.sibling;je.sibling=null,je=Jt}while(je!==null)}}Ae=y}}if((y.subtreeFlags&2064)!==0&&x!==null)x.return=y,Ae=x;else e:for(;Ae!==null;){if(y=Ae,(y.flags&2048)!==0)switch(y.tag){case 0:case 11:case 15:il(9,y,y.return)}var q=y.sibling;if(q!==null){q.return=y.return,Ae=q;break e}Ae=y.return}}var z=r.current;for(Ae=z;Ae!==null;){x=Ae;var Q=x.child;if((x.subtreeFlags&2064)!==0&&Q!==null)Q.return=x,Ae=Q;else e:for(x=z;Ae!==null;){if(N=Ae,(N.flags&2048)!==0)try{switch(N.tag){case 0:case 11:case 15:Uc(9,N)}}catch(Ve){Kt(N,N.return,Ve)}if(N===x){Ae=null;break e}var _e=N.sibling;if(_e!==null){_e.return=N.return,Ae=_e;break e}Ae=N.return}}if(pt=p,di(),S&&typeof S.onPostCommitFiberRoot=="function")try{S.onPostCommitFiberRoot(ks,r)}catch{}h=!0}return h}finally{rt=o,kr.transition=i}}return!1}function Rg(r,i,o){i=eo(o,i),i=qm(r,i,1),r=fi(r,i,1),i=tr(),r!==null&&(Xn(r,1,i),cr(r,i))}function Kt(r,i,o){if(r.tag===3)Rg(r,r,o);else for(;i!==null;){if(i.tag===3){Rg(i,r,o);break}else if(i.tag===1){var h=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(mi===null||!mi.has(h))){r=eo(o,r),r=Km(i,r,1),i=fi(i,r,1),r=tr(),i!==null&&(Xn(i,1,r),cr(i,r));break}}i=i.return}}function Cx(r,i,o){var h=r.pingCache;h!==null&&h.delete(i),i=tr(),r.pingedLanes|=r.suspendedLanes&o,xn===r&&(An&o)===o&&(mn===4||mn===3&&(An&130023424)===An&&500>vt()-xh?ca(r,0):wh|=o),cr(r,i)}function Ag(r,i){i===0&&((r.mode&1)===0?i=1:(i=et,et<<=1,(et&130023424)===0&&(et=4194304)));var o=tr();r=zs(r,i),r!==null&&(Xn(r,i,o),cr(r,o))}function Px(r){var i=r.memoizedState,o=0;i!==null&&(o=i.retryLane),Ag(r,o)}function bx(r,i){var o=0;switch(r.tag){case 13:var h=r.stateNode,p=r.memoizedState;p!==null&&(o=p.retryLane);break;case 19:h=r.stateNode;break;default:throw Error(t(314))}h!==null&&h.delete(i),Ag(r,o)}var Ng;Ng=function(r,i,o){if(r!==null)if(r.memoizedProps!==i.pendingProps||ir.current)or=!0;else{if((r.lanes&o)===0&&(i.flags&128)===0)return or=!1,mx(r,i,o);or=(r.flags&131072)!==0}else or=!1,Ut&&(i.flags&1048576)!==0&&um(i,Tc,i.index);switch(i.lanes=0,i.tag){case 2:var h=i.type;Mc(r,i),r=i.pendingProps;var p=Ga(i,Fn.current);Xa(i,o),p=Xd(null,i,h,r,p,o);var y=Zd();return i.flags|=1,typeof p=="object"&&p!==null&&typeof p.render=="function"&&p.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,ar(h)?(y=!0,wc(i)):y=!1,i.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,Hd(i),p.updater=Vc,i.stateNode=p,p._reactInternals=i,ih(i,h,r,o),i=ch(null,i,h,!0,y,o)):(i.tag=0,Ut&&y&&Ld(i),er(null,i,p,o),i=i.child),i;case 16:h=i.elementType;e:{switch(Mc(r,i),r=i.pendingProps,p=h._init,h=p(h._payload),i.type=h,p=i.tag=Ax(h),r=Kr(h,r),p){case 0:i=lh(null,i,h,r,o);break e;case 1:i=rg(null,i,h,r,o);break e;case 11:i=Xm(null,i,h,r,o);break e;case 14:i=Zm(null,i,h,Kr(h.type,r),o);break e}throw Error(t(306,h,""))}return i;case 0:return h=i.type,p=i.pendingProps,p=i.elementType===h?p:Kr(h,p),lh(r,i,h,p,o);case 1:return h=i.type,p=i.pendingProps,p=i.elementType===h?p:Kr(h,p),rg(r,i,h,p,o);case 3:e:{if(sg(i),r===null)throw Error(t(387));h=i.pendingProps,y=i.memoizedState,p=y.element,_m(r,i),Rc(i,h,null,o);var x=i.memoizedState;if(h=x.element,y.isDehydrated)if(y={element:h,isDehydrated:!1,cache:x.cache,pendingSuspenseBoundaries:x.pendingSuspenseBoundaries,transitions:x.transitions},i.updateQueue.baseState=y,i.memoizedState=y,i.flags&256){p=eo(Error(t(423)),i),i=ig(r,i,h,o,p);break e}else if(h!==p){p=eo(Error(t(424)),i),i=ig(r,i,h,o,p);break e}else for(wr=li(i.stateNode.containerInfo.firstChild),_r=i,Ut=!0,qr=null,o=ym(i,null,h,o),i.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(Qa(),h===p){i=$s(r,i,o);break e}er(r,i,h,o)}i=i.child}return i;case 5:return Em(i),r===null&&Md(i),h=i.type,p=i.pendingProps,y=r!==null?r.memoizedProps:null,x=p.children,Rd(h,p)?x=null:y!==null&&Rd(h,y)&&(i.flags|=32),ng(r,i),er(r,i,x,o),i.child;case 6:return r===null&&Md(i),null;case 13:return ag(r,i,o);case 4:return Gd(i,i.stateNode.containerInfo),h=i.pendingProps,r===null?i.child=Ya(i,null,h,o):er(r,i,h,o),i.child;case 11:return h=i.type,p=i.pendingProps,p=i.elementType===h?p:Kr(h,p),Xm(r,i,h,p,o);case 7:return er(r,i,i.pendingProps,o),i.child;case 8:return er(r,i,i.pendingProps.children,o),i.child;case 12:return er(r,i,i.pendingProps.children,o),i.child;case 10:e:{if(h=i.type._context,p=i.pendingProps,y=i.memoizedProps,x=p.value,kt(Cc,h._currentValue),h._currentValue=x,y!==null)if(Gr(y.value,x)){if(y.children===p.children&&!ir.current){i=$s(r,i,o);break e}}else for(y=i.child,y!==null&&(y.return=i);y!==null;){var N=y.dependencies;if(N!==null){x=y.child;for(var M=N.firstContext;M!==null;){if(M.context===h){if(y.tag===1){M=Bs(-1,o&-o),M.tag=2;var X=y.updateQueue;if(X!==null){X=X.shared;var he=X.pending;he===null?M.next=M:(M.next=he.next,he.next=M),X.pending=M}}y.lanes|=o,M=y.alternate,M!==null&&(M.lanes|=o),$d(y.return,o,i),N.lanes|=o;break}M=M.next}}else if(y.tag===10)x=y.type===i.type?null:y.child;else if(y.tag===18){if(x=y.return,x===null)throw Error(t(341));x.lanes|=o,N=x.alternate,N!==null&&(N.lanes|=o),$d(x,o,i),x=y.sibling}else x=y.child;if(x!==null)x.return=y;else for(x=y;x!==null;){if(x===i){x=null;break}if(y=x.sibling,y!==null){y.return=x.return,x=y;break}x=x.return}y=x}er(r,i,p.children,o),i=i.child}return i;case 9:return p=i.type,h=i.pendingProps.children,Xa(i,o),p=Ar(p),h=h(p),i.flags|=1,er(r,i,h,o),i.child;case 14:return h=i.type,p=Kr(h,i.pendingProps),p=Kr(h.type,p),Zm(r,i,h,p,o);case 15:return eg(r,i,i.type,i.pendingProps,o);case 17:return h=i.type,p=i.pendingProps,p=i.elementType===h?p:Kr(h,p),Mc(r,i),i.tag=1,ar(h)?(r=!0,wc(i)):r=!1,Xa(i,o),Hm(i,h,p),ih(i,h,p,o),ch(null,i,h,!0,r,o);case 19:return lg(r,i,o);case 22:return tg(r,i,o)}throw Error(t(156,i.tag))};function kg(r,i){return gt(r,i)}function Rx(r,i,o,h){this.tag=r,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function jr(r,i,o,h){return new Rx(r,i,o,h)}function Rh(r){return r=r.prototype,!(!r||!r.isReactComponent)}function Ax(r){if(typeof r=="function")return Rh(r)?1:0;if(r!=null){if(r=r.$$typeof,r===D)return 11;if(r===ve)return 14}return 2}function _i(r,i){var o=r.alternate;return o===null?(o=jr(r.tag,i,r.key,r.mode),o.elementType=r.elementType,o.type=r.type,o.stateNode=r.stateNode,o.alternate=r,r.alternate=o):(o.pendingProps=i,o.type=r.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=r.flags&14680064,o.childLanes=r.childLanes,o.lanes=r.lanes,o.child=r.child,o.memoizedProps=r.memoizedProps,o.memoizedState=r.memoizedState,o.updateQueue=r.updateQueue,i=r.dependencies,o.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},o.sibling=r.sibling,o.index=r.index,o.ref=r.ref,o}function Qc(r,i,o,h,p,y){var x=2;if(h=r,typeof r=="function")Rh(r)&&(x=1);else if(typeof r=="string")x=5;else e:switch(r){case b:return da(o.children,p,y,i);case A:x=8,p|=8;break;case k:return r=jr(12,o,i,p|2),r.elementType=k,r.lanes=y,r;case I:return r=jr(13,o,i,p),r.elementType=I,r.lanes=y,r;case ge:return r=jr(19,o,i,p),r.elementType=ge,r.lanes=y,r;case Be:return Yc(o,p,y,i);default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case V:x=10;break e;case F:x=9;break e;case D:x=11;break e;case ve:x=14;break e;case lt:x=16,h=null;break e}throw Error(t(130,r==null?r:typeof r,""))}return i=jr(x,o,i,p),i.elementType=r,i.type=h,i.lanes=y,i}function da(r,i,o,h){return r=jr(7,r,h,i),r.lanes=o,r}function Yc(r,i,o,h){return r=jr(22,r,h,i),r.elementType=Be,r.lanes=o,r.stateNode={isHidden:!1},r}function Ah(r,i,o){return r=jr(6,r,null,i),r.lanes=o,r}function Nh(r,i,o){return i=jr(4,r.children!==null?r.children:[],r.key,i),i.lanes=o,i.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},i}function Nx(r,i,o,h,p){this.tag=i,this.containerInfo=r,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=it(0),this.expirationTimes=it(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=it(0),this.identifierPrefix=h,this.onRecoverableError=p,this.mutableSourceEagerHydrationData=null}function kh(r,i,o,h,p,y,x,N,M){return r=new Nx(r,i,o,N,M),i===1?(i=1,y===!0&&(i|=8)):i=0,y=jr(3,null,null,i),r.current=y,y.stateNode=r,y.memoizedState={element:h,isDehydrated:o,cache:null,transitions:null,pendingSuspenseBoundaries:null},Hd(y),r}function kx(r,i,o){var h=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Se,key:h==null?null:""+h,children:r,containerInfo:i,implementation:o}}function jg(r){if(!r)return ui;r=r._reactInternals;e:{if(xe(r)!==r||r.tag!==1)throw Error(t(170));var i=r;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(ar(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(t(171))}if(r.tag===1){var o=r.type;if(ar(o))return om(r,o,i)}return i}function Dg(r,i,o,h,p,y,x,N,M){return r=kh(o,h,!0,r,p,y,x,N,M),r.context=jg(null),o=r.current,h=tr(),p=yi(o),y=Bs(h,p),y.callback=i??null,fi(o,y,p),r.current.lanes=p,Xn(r,p,h),cr(r,h),r}function Jc(r,i,o,h){var p=i.current,y=tr(),x=yi(p);return o=jg(o),i.context===null?i.context=o:i.pendingContext=o,i=Bs(y,x),i.payload={element:r},h=h===void 0?null:h,h!==null&&(i.callback=h),r=fi(p,i,x),r!==null&&(Jr(r,p,x,y),bc(r,p,x)),x}function Xc(r){if(r=r.current,!r.child)return null;switch(r.child.tag){case 5:return r.child.stateNode;default:return r.child.stateNode}}function Lg(r,i){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var o=r.retryLane;r.retryLane=o!==0&&o<i?o:i}}function jh(r,i){Lg(r,i),(r=r.alternate)&&Lg(r,i)}function jx(){return null}var Vg=typeof reportError=="function"?reportError:function(r){console.error(r)};function Dh(r){this._internalRoot=r}Zc.prototype.render=Dh.prototype.render=function(r){var i=this._internalRoot;if(i===null)throw Error(t(409));Jc(r,i,null,null)},Zc.prototype.unmount=Dh.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var i=r.containerInfo;la(function(){Jc(null,r,null,null)}),i[Os]=null}};function Zc(r){this._internalRoot=r}Zc.prototype.unstable_scheduleHydration=function(r){if(r){var i=ba();r={blockedOn:null,target:r,priority:i};for(var o=0;o<us.length&&i!==0&&i<us[o].priority;o++);us.splice(o,0,r),o===0&&nc(r)}};function Lh(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function eu(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11&&(r.nodeType!==8||r.nodeValue!==" react-mount-point-unstable "))}function Og(){}function Dx(r,i,o,h,p){if(p){if(typeof h=="function"){var y=h;h=function(){var X=Xc(x);y.call(X)}}var x=Dg(i,h,r,0,null,!1,!1,"",Og);return r._reactRootContainer=x,r[Os]=x.current,Go(r.nodeType===8?r.parentNode:r),la(),x}for(;p=r.lastChild;)r.removeChild(p);if(typeof h=="function"){var N=h;h=function(){var X=Xc(M);N.call(X)}}var M=kh(r,0,!1,null,null,!1,!1,"",Og);return r._reactRootContainer=M,r[Os]=M.current,Go(r.nodeType===8?r.parentNode:r),la(function(){Jc(i,M,o,h)}),M}function tu(r,i,o,h,p){var y=o._reactRootContainer;if(y){var x=y;if(typeof p=="function"){var N=p;p=function(){var M=Xc(x);N.call(M)}}Jc(i,x,r,p)}else x=Dx(o,i,r,p,h);return Xc(x)}Pa=function(r){switch(r.tag){case 3:var i=r.stateNode;if(i.current.memoizedState.isDehydrated){var o=wt(i.pendingLanes);o!==0&&(Mn(i,o|1),cr(i,vt()),(pt&6)===0&&(ro=vt()+500,di()))}break;case 13:la(function(){var h=zs(r,1);if(h!==null){var p=tr();Jr(h,r,1,p)}}),jh(r,1)}},ri=function(r){if(r.tag===13){var i=zs(r,134217728);if(i!==null){var o=tr();Jr(i,r,134217728,o)}jh(r,134217728)}},ls=function(r){if(r.tag===13){var i=yi(r),o=zs(r,i);if(o!==null){var h=tr();Jr(o,r,i,h)}jh(r,i)}},ba=function(){return rt},ec=function(r,i){var o=rt;try{return rt=r,i()}finally{rt=o}},mr=function(r,i,o){switch(i){case"input":if(Pt(r,o),i=o.name,o.type==="radio"&&i!=null){for(o=r;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<o.length;i++){var h=o[i];if(h!==r&&h.form===r.form){var p=vc(h);if(!p)throw Error(t(90));ke(h),Pt(h,p)}}}break;case"textarea":Qt(r,o);break;case"select":i=o.value,i!=null&&Sn(r,!!o.multiple,i,!1)}},Sr=Ch,as=la;var Lx={usingClientEntryPoint:!1,Events:[Qo,Wa,vc,dn,Fr,Ch]},cl={findFiberByHostInstance:ea,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Vx={bundleType:cl.bundleType,version:cl.version,rendererPackageName:cl.rendererPackageName,rendererConfig:cl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:oe.ReactCurrentDispatcher,findHostInstanceByFiber:function(r){return r=Vn(r),r===null?null:r.stateNode},findFiberByHostInstance:cl.findFiberByHostInstance||jx,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var nu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nu.isDisabled&&nu.supportsFiber)try{ks=nu.inject(Vx),S=nu}catch{}}return ur.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Lx,ur.createPortal=function(r,i){var o=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Lh(i))throw Error(t(200));return kx(r,i,null,o)},ur.createRoot=function(r,i){if(!Lh(r))throw Error(t(299));var o=!1,h="",p=Vg;return i!=null&&(i.unstable_strictMode===!0&&(o=!0),i.identifierPrefix!==void 0&&(h=i.identifierPrefix),i.onRecoverableError!==void 0&&(p=i.onRecoverableError)),i=kh(r,1,!1,null,null,o,!1,h,p),r[Os]=i.current,Go(r.nodeType===8?r.parentNode:r),new Dh(i)},ur.findDOMNode=function(r){if(r==null)return null;if(r.nodeType===1)return r;var i=r._reactInternals;if(i===void 0)throw typeof r.render=="function"?Error(t(188)):(r=Object.keys(r).join(","),Error(t(268,r)));return r=Vn(i),r=r===null?null:r.stateNode,r},ur.flushSync=function(r){return la(r)},ur.hydrate=function(r,i,o){if(!eu(i))throw Error(t(200));return tu(null,r,i,!0,o)},ur.hydrateRoot=function(r,i,o){if(!Lh(r))throw Error(t(405));var h=o!=null&&o.hydratedSources||null,p=!1,y="",x=Vg;if(o!=null&&(o.unstable_strictMode===!0&&(p=!0),o.identifierPrefix!==void 0&&(y=o.identifierPrefix),o.onRecoverableError!==void 0&&(x=o.onRecoverableError)),i=Dg(i,null,r,1,o??null,p,!1,y,x),r[Os]=i.current,Go(r),h)for(r=0;r<h.length;r++)o=h[r],p=o._getVersion,p=p(o._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[o,p]:i.mutableSourceEagerHydrationData.push(o,p);return new Zc(i)},ur.render=function(r,i,o){if(!eu(i))throw Error(t(200));return tu(null,r,i,!1,o)},ur.unmountComponentAtNode=function(r){if(!eu(r))throw Error(t(40));return r._reactRootContainer?(la(function(){tu(null,null,r,!1,function(){r._reactRootContainer=null,r[Os]=null})}),!0):!1},ur.unstable_batchedUpdates=Ch,ur.unstable_renderSubtreeIntoContainer=function(r,i,o,h){if(!eu(o))throw Error(t(200));if(r==null||r._reactInternals===void 0)throw Error(t(38));return tu(r,i,o,!1,h)},ur.version="18.3.1-next-f1338f8080-20240426",ur}var Hg;function Hv(){if(Hg)return Mh.exports;Hg=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Mh.exports=Hx(),Mh.exports}var Gg;function Gx(){if(Gg)return ru;Gg=1;var n=Hv();return ru.createRoot=n.createRoot,ru.hydrateRoot=n.hydrateRoot,ru}var qx=Gx();const Kx=$v(qx);Hv();/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function bl(){return bl=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},bl.apply(this,arguments)}var Ci;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(Ci||(Ci={}));const qg="popstate";function Qx(n){n===void 0&&(n={});function e(s,a){let{pathname:l,search:d,hash:f}=s.location;return nf("",{pathname:l,search:d,hash:f},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(s,a){return typeof a=="string"?a:xu(a)}return Jx(e,t,null,n)}function Zt(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function jf(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Yx(){return Math.random().toString(36).substr(2,8)}function Kg(n,e){return{usr:n.state,key:n.key,idx:e}}function nf(n,e,t,s){return t===void 0&&(t=null),bl({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?To(e):e,{state:t,key:e&&e.key||s||Yx()})}function xu(n){let{pathname:e="/",search:t="",hash:s=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),s&&s!=="#"&&(e+=s.charAt(0)==="#"?s:"#"+s),e}function To(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let s=n.indexOf("?");s>=0&&(e.search=n.substr(s),n=n.substr(0,s)),n&&(e.pathname=n)}return e}function Jx(n,e,t,s){s===void 0&&(s={});let{window:a=document.defaultView,v5Compat:l=!1}=s,d=a.history,f=Ci.Pop,m=null,v=w();v==null&&(v=0,d.replaceState(bl({},d.state,{idx:v}),""));function w(){return(d.state||{idx:null}).idx}function E(){f=Ci.Pop;let O=w(),re=O==null?null:O-v;v=O,m&&m({action:f,location:K.location,delta:re})}function C(O,re){f=Ci.Push;let ye=nf(K.location,O,re);v=w()+1;let ne=Kg(ye,v),oe=K.createHref(ye);try{d.pushState(ne,"",oe)}catch(Ee){if(Ee instanceof DOMException&&Ee.name==="DataCloneError")throw Ee;a.location.assign(oe)}l&&m&&m({action:f,location:K.location,delta:1})}function U(O,re){f=Ci.Replace;let ye=nf(K.location,O,re);v=w();let ne=Kg(ye,v),oe=K.createHref(ye);d.replaceState(ne,"",oe),l&&m&&m({action:f,location:K.location,delta:0})}function G(O){let re=a.location.origin!=="null"?a.location.origin:a.location.href,ye=typeof O=="string"?O:xu(O);return ye=ye.replace(/ $/,"%20"),Zt(re,"No window.location.(origin|href) available to create URL for href: "+ye),new URL(ye,re)}let K={get action(){return f},get location(){return n(a,d)},listen(O){if(m)throw new Error("A history only accepts one active listener");return a.addEventListener(qg,E),m=O,()=>{a.removeEventListener(qg,E),m=null}},createHref(O){return e(a,O)},createURL:G,encodeLocation(O){let re=G(O);return{pathname:re.pathname,search:re.search,hash:re.hash}},push:C,replace:U,go(O){return d.go(O)}};return K}var Qg;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(Qg||(Qg={}));function Xx(n,e,t){return t===void 0&&(t="/"),Zx(n,e,t)}function Zx(n,e,t,s){let a=typeof e=="string"?To(e):e,l=Df(a.pathname||"/",t);if(l==null)return null;let d=Gv(n);eE(d);let f=null;for(let m=0;f==null&&m<d.length;++m){let v=hE(l);f=cE(d[m],v)}return f}function Gv(n,e,t,s){e===void 0&&(e=[]),t===void 0&&(t=[]),s===void 0&&(s="");let a=(l,d,f)=>{let m={relativePath:f===void 0?l.path||"":f,caseSensitive:l.caseSensitive===!0,childrenIndex:d,route:l};m.relativePath.startsWith("/")&&(Zt(m.relativePath.startsWith(s),'Absolute route path "'+m.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),m.relativePath=m.relativePath.slice(s.length));let v=Ri([s,m.relativePath]),w=t.concat(m);l.children&&l.children.length>0&&(Zt(l.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+v+'".')),Gv(l.children,e,w,v)),!(l.path==null&&!l.index)&&e.push({path:v,score:oE(v,l.index),routesMeta:w})};return n.forEach((l,d)=>{var f;if(l.path===""||!((f=l.path)!=null&&f.includes("?")))a(l,d);else for(let m of qv(l.path))a(l,d,m)}),e}function qv(n){let e=n.split("/");if(e.length===0)return[];let[t,...s]=e,a=t.endsWith("?"),l=t.replace(/\?$/,"");if(s.length===0)return a?[l,""]:[l];let d=qv(s.join("/")),f=[];return f.push(...d.map(m=>m===""?l:[l,m].join("/"))),a&&f.push(...d),f.map(m=>n.startsWith("/")&&m===""?"/":m)}function eE(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:lE(e.routesMeta.map(s=>s.childrenIndex),t.routesMeta.map(s=>s.childrenIndex)))}const tE=/^:[\w-]+$/,nE=3,rE=2,sE=1,iE=10,aE=-2,Yg=n=>n==="*";function oE(n,e){let t=n.split("/"),s=t.length;return t.some(Yg)&&(s+=aE),e&&(s+=rE),t.filter(a=>!Yg(a)).reduce((a,l)=>a+(tE.test(l)?nE:l===""?sE:iE),s)}function lE(n,e){return n.length===e.length&&n.slice(0,-1).every((s,a)=>s===e[a])?n[n.length-1]-e[e.length-1]:0}function cE(n,e,t){let{routesMeta:s}=n,a={},l="/",d=[];for(let f=0;f<s.length;++f){let m=s[f],v=f===s.length-1,w=l==="/"?e:e.slice(l.length)||"/",E=uE({path:m.relativePath,caseSensitive:m.caseSensitive,end:v},w),C=m.route;if(!E)return null;Object.assign(a,E.params),d.push({params:a,pathname:Ri([l,E.pathname]),pathnameBase:yE(Ri([l,E.pathnameBase])),route:C}),E.pathnameBase!=="/"&&(l=Ri([l,E.pathnameBase]))}return d}function uE(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,s]=dE(n.path,n.caseSensitive,n.end),a=e.match(t);if(!a)return null;let l=a[0],d=l.replace(/(.)\/+$/,"$1"),f=a.slice(1);return{params:s.reduce((v,w,E)=>{let{paramName:C,isOptional:U}=w;if(C==="*"){let K=f[E]||"";d=l.slice(0,l.length-K.length).replace(/(.)\/+$/,"$1")}const G=f[E];return U&&!G?v[C]=void 0:v[C]=(G||"").replace(/%2F/g,"/"),v},{}),pathname:l,pathnameBase:d,pattern:n}}function dE(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),jf(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let s=[],a="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,f,m)=>(s.push({paramName:f,isOptional:m!=null}),m?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(s.push({paramName:"*"}),a+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?a+="\\/*$":n!==""&&n!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),s]}function hE(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return jf(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function Df(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,s=n.charAt(t);return s&&s!=="/"?null:n.slice(t)||"/"}const fE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,pE=n=>fE.test(n);function mE(n,e){e===void 0&&(e="/");let{pathname:t,search:s="",hash:a=""}=typeof n=="string"?To(n):n,l;if(t)if(pE(t))l=t;else{if(t.includes("//")){let d=t;t=t.replace(/\/\/+/g,"/"),jf(!1,"Pathnames cannot have embedded double slashes - normalizing "+(d+" -> "+t))}t.startsWith("/")?l=Jg(t.substring(1),"/"):l=Jg(t,e)}else l=e;return{pathname:l,search:vE(s),hash:_E(a)}}function Jg(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(a=>{a===".."?t.length>1&&t.pop():a!=="."&&t.push(a)}),t.length>1?t.join("/"):"/"}function zh(n,e,t,s){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function gE(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Lf(n,e){let t=gE(n);return e?t.map((s,a)=>a===t.length-1?s.pathname:s.pathnameBase):t.map(s=>s.pathnameBase)}function Vf(n,e,t,s){s===void 0&&(s=!1);let a;typeof n=="string"?a=To(n):(a=bl({},n),Zt(!a.pathname||!a.pathname.includes("?"),zh("?","pathname","search",a)),Zt(!a.pathname||!a.pathname.includes("#"),zh("#","pathname","hash",a)),Zt(!a.search||!a.search.includes("#"),zh("#","search","hash",a)));let l=n===""||a.pathname==="",d=l?"/":a.pathname,f;if(d==null)f=t;else{let E=e.length-1;if(!s&&d.startsWith("..")){let C=d.split("/");for(;C[0]==="..";)C.shift(),E-=1;a.pathname=C.join("/")}f=E>=0?e[E]:"/"}let m=mE(a,f),v=d&&d!=="/"&&d.endsWith("/"),w=(l||d===".")&&t.endsWith("/");return!m.pathname.endsWith("/")&&(v||w)&&(m.pathname+="/"),m}const Ri=n=>n.join("/").replace(/\/\/+/g,"/"),yE=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),vE=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,_E=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function wE(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const Kv=["post","put","patch","delete"];new Set(Kv);const xE=["get",...Kv];new Set(xE);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Rl(){return Rl=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},Rl.apply(this,arguments)}const Of=j.createContext(null),EE=j.createContext(null),Bi=j.createContext(null),zu=j.createContext(null),$i=j.createContext({outlet:null,matches:[],isDataRoute:!1}),Qv=j.createContext(null);function TE(n,e){let{relative:t}=e===void 0?{}:e;So()||Zt(!1);let{basename:s,navigator:a}=j.useContext(Bi),{hash:l,pathname:d,search:f}=Jv(n,{relative:t}),m=d;return s!=="/"&&(m=d==="/"?s:Ri([s,d])),a.createHref({pathname:m,search:f,hash:l})}function So(){return j.useContext(zu)!=null}function Ul(){return So()||Zt(!1),j.useContext(zu).location}function Yv(n){j.useContext(Bi).static||j.useLayoutEffect(n)}function Bu(){let{isDataRoute:n}=j.useContext($i);return n?VE():SE()}function SE(){So()||Zt(!1);let n=j.useContext(Of),{basename:e,future:t,navigator:s}=j.useContext(Bi),{matches:a}=j.useContext($i),{pathname:l}=Ul(),d=JSON.stringify(Lf(a,t.v7_relativeSplatPath)),f=j.useRef(!1);return Yv(()=>{f.current=!0}),j.useCallback(function(v,w){if(w===void 0&&(w={}),!f.current)return;if(typeof v=="number"){s.go(v);return}let E=Vf(v,JSON.parse(d),l,w.relative==="path");n==null&&e!=="/"&&(E.pathname=E.pathname==="/"?e:Ri([e,E.pathname])),(w.replace?s.replace:s.push)(E,w.state,w)},[e,s,d,l,n])}function Jv(n,e){let{relative:t}=e===void 0?{}:e,{future:s}=j.useContext(Bi),{matches:a}=j.useContext($i),{pathname:l}=Ul(),d=JSON.stringify(Lf(a,s.v7_relativeSplatPath));return j.useMemo(()=>Vf(n,JSON.parse(d),l,t==="path"),[n,d,l,t])}function IE(n,e){return CE(n,e)}function CE(n,e,t,s){So()||Zt(!1);let{navigator:a}=j.useContext(Bi),{matches:l}=j.useContext($i),d=l[l.length-1],f=d?d.params:{};d&&d.pathname;let m=d?d.pathnameBase:"/";d&&d.route;let v=Ul(),w;if(e){var E;let O=typeof e=="string"?To(e):e;m==="/"||(E=O.pathname)!=null&&E.startsWith(m)||Zt(!1),w=O}else w=v;let C=w.pathname||"/",U=C;if(m!=="/"){let O=m.replace(/^\//,"").split("/");U="/"+C.replace(/^\//,"").split("/").slice(O.length).join("/")}let G=Xx(n,{pathname:U}),K=NE(G&&G.map(O=>Object.assign({},O,{params:Object.assign({},f,O.params),pathname:Ri([m,a.encodeLocation?a.encodeLocation(O.pathname).pathname:O.pathname]),pathnameBase:O.pathnameBase==="/"?m:Ri([m,a.encodeLocation?a.encodeLocation(O.pathnameBase).pathname:O.pathnameBase])})),l,t,s);return e&&K?j.createElement(zu.Provider,{value:{location:Rl({pathname:"/",search:"",hash:"",state:null,key:"default"},w),navigationType:Ci.Pop}},K):K}function PE(){let n=LE(),e=wE(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return j.createElement(j.Fragment,null,j.createElement("h2",null,"Unexpected Application Error!"),j.createElement("h3",{style:{fontStyle:"italic"}},e),t?j.createElement("pre",{style:a},t):null,null)}const bE=j.createElement(PE,null);class RE extends j.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?j.createElement($i.Provider,{value:this.props.routeContext},j.createElement(Qv.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function AE(n){let{routeContext:e,match:t,children:s}=n,a=j.useContext(Of);return a&&a.static&&a.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=t.route.id),j.createElement($i.Provider,{value:e},s)}function NE(n,e,t,s){var a;if(e===void 0&&(e=[]),t===void 0&&(t=null),s===void 0&&(s=null),n==null){var l;if(!t)return null;if(t.errors)n=t.matches;else if((l=s)!=null&&l.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let d=n,f=(a=t)==null?void 0:a.errors;if(f!=null){let w=d.findIndex(E=>E.route.id&&(f==null?void 0:f[E.route.id])!==void 0);w>=0||Zt(!1),d=d.slice(0,Math.min(d.length,w+1))}let m=!1,v=-1;if(t&&s&&s.v7_partialHydration)for(let w=0;w<d.length;w++){let E=d[w];if((E.route.HydrateFallback||E.route.hydrateFallbackElement)&&(v=w),E.route.id){let{loaderData:C,errors:U}=t,G=E.route.loader&&C[E.route.id]===void 0&&(!U||U[E.route.id]===void 0);if(E.route.lazy||G){m=!0,v>=0?d=d.slice(0,v+1):d=[d[0]];break}}}return d.reduceRight((w,E,C)=>{let U,G=!1,K=null,O=null;t&&(U=f&&E.route.id?f[E.route.id]:void 0,K=E.route.errorElement||bE,m&&(v<0&&C===0?(OE("route-fallback"),G=!0,O=null):v===C&&(G=!0,O=E.route.hydrateFallbackElement||null)));let re=e.concat(d.slice(0,C+1)),ye=()=>{let ne;return U?ne=K:G?ne=O:E.route.Component?ne=j.createElement(E.route.Component,null):E.route.element?ne=E.route.element:ne=w,j.createElement(AE,{match:E,routeContext:{outlet:w,matches:re,isDataRoute:t!=null},children:ne})};return t&&(E.route.ErrorBoundary||E.route.errorElement||C===0)?j.createElement(RE,{location:t.location,revalidation:t.revalidation,component:K,error:U,children:ye(),routeContext:{outlet:null,matches:re,isDataRoute:!0}}):ye()},null)}var Xv=(function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n})(Xv||{}),Zv=(function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n})(Zv||{});function kE(n){let e=j.useContext(Of);return e||Zt(!1),e}function jE(n){let e=j.useContext(EE);return e||Zt(!1),e}function DE(n){let e=j.useContext($i);return e||Zt(!1),e}function e_(n){let e=DE(),t=e.matches[e.matches.length-1];return t.route.id||Zt(!1),t.route.id}function LE(){var n;let e=j.useContext(Qv),t=jE(),s=e_();return e!==void 0?e:(n=t.errors)==null?void 0:n[s]}function VE(){let{router:n}=kE(Xv.UseNavigateStable),e=e_(Zv.UseNavigateStable),t=j.useRef(!1);return Yv(()=>{t.current=!0}),j.useCallback(function(a,l){l===void 0&&(l={}),t.current&&(typeof a=="number"?n.navigate(a):n.navigate(a,Rl({fromRouteId:e},l)))},[n,e])}const Xg={};function OE(n,e,t){Xg[n]||(Xg[n]=!0)}function ME(n,e){n==null||n.v7_startTransition,n==null||n.v7_relativeSplatPath}function FE(n){let{to:e,replace:t,state:s,relative:a}=n;So()||Zt(!1);let{future:l,static:d}=j.useContext(Bi),{matches:f}=j.useContext($i),{pathname:m}=Ul(),v=Bu(),w=Vf(e,Lf(f,l.v7_relativeSplatPath),m,a==="path"),E=JSON.stringify(w);return j.useEffect(()=>v(JSON.parse(E),{replace:t,state:s,relative:a}),[v,E,a,t,s]),null}function Zr(n){Zt(!1)}function UE(n){let{basename:e="/",children:t=null,location:s,navigationType:a=Ci.Pop,navigator:l,static:d=!1,future:f}=n;So()&&Zt(!1);let m=e.replace(/^\/*/,"/"),v=j.useMemo(()=>({basename:m,navigator:l,static:d,future:Rl({v7_relativeSplatPath:!1},f)}),[m,f,l,d]);typeof s=="string"&&(s=To(s));let{pathname:w="/",search:E="",hash:C="",state:U=null,key:G="default"}=s,K=j.useMemo(()=>{let O=Df(w,m);return O==null?null:{location:{pathname:O,search:E,hash:C,state:U,key:G},navigationType:a}},[m,w,E,C,U,G,a]);return K==null?null:j.createElement(Bi.Provider,{value:v},j.createElement(zu.Provider,{children:t,value:K}))}function zE(n){let{children:e,location:t}=n;return IE(rf(e),t)}new Promise(()=>{});function rf(n,e){e===void 0&&(e=[]);let t=[];return j.Children.forEach(n,(s,a)=>{if(!j.isValidElement(s))return;let l=[...e,a];if(s.type===j.Fragment){t.push.apply(t,rf(s.props.children,l));return}s.type!==Zr&&Zt(!1),!s.props.index||!s.props.children||Zt(!1);let d={id:s.props.id||l.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(d.children=rf(s.props.children,l)),t.push(d)}),t}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function sf(){return sf=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},sf.apply(this,arguments)}function BE(n,e){if(n==null)return{};var t={},s=Object.keys(n),a,l;for(l=0;l<s.length;l++)a=s[l],!(e.indexOf(a)>=0)&&(t[a]=n[a]);return t}function $E(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function WE(n,e){return n.button===0&&(!e||e==="_self")&&!$E(n)}const HE=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],GE="6";try{window.__reactRouterVersion=GE}catch{}const qE="startTransition",Zg=Bx[qE];function KE(n){let{basename:e,children:t,future:s,window:a}=n,l=j.useRef();l.current==null&&(l.current=Qx({window:a,v5Compat:!0}));let d=l.current,[f,m]=j.useState({action:d.action,location:d.location}),{v7_startTransition:v}=s||{},w=j.useCallback(E=>{v&&Zg?Zg(()=>m(E)):m(E)},[m,v]);return j.useLayoutEffect(()=>d.listen(w),[d,w]),j.useEffect(()=>ME(s),[s]),j.createElement(UE,{basename:e,children:t,location:f.location,navigationType:f.action,navigator:d,future:s})}const QE=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",YE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ha=j.forwardRef(function(e,t){let{onClick:s,relative:a,reloadDocument:l,replace:d,state:f,target:m,to:v,preventScrollReset:w,viewTransition:E}=e,C=BE(e,HE),{basename:U}=j.useContext(Bi),G,K=!1;if(typeof v=="string"&&YE.test(v)&&(G=v,QE))try{let ne=new URL(window.location.href),oe=v.startsWith("//")?new URL(ne.protocol+v):new URL(v),Ee=Df(oe.pathname,U);oe.origin===ne.origin&&Ee!=null?v=Ee+oe.search+oe.hash:K=!0}catch{}let O=TE(v,{relative:a}),re=JE(v,{replace:d,state:f,target:m,preventScrollReset:w,relative:a,viewTransition:E});function ye(ne){s&&s(ne),ne.defaultPrevented||re(ne)}return j.createElement("a",sf({},C,{href:G||O,onClick:K||l?s:ye,ref:t,target:m}))});var ey;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(ey||(ey={}));var ty;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(ty||(ty={}));function JE(n,e){let{target:t,replace:s,state:a,preventScrollReset:l,relative:d,viewTransition:f}=e===void 0?{}:e,m=Bu(),v=Ul(),w=Jv(n,{relative:d});return j.useCallback(E=>{if(WE(E,t)){E.preventDefault();let C=s!==void 0?s:xu(v)===xu(w);m(n,{replace:C,state:a,preventScrollReset:l,relative:d,viewTransition:f})}},[v,m,w,s,a,t,n,l,d,f])}const XE=()=>{};var ny={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t_=function(n){const e=[];let t=0;for(let s=0;s<n.length;s++){let a=n.charCodeAt(s);a<128?e[t++]=a:a<2048?(e[t++]=a>>6|192,e[t++]=a&63|128):(a&64512)===55296&&s+1<n.length&&(n.charCodeAt(s+1)&64512)===56320?(a=65536+((a&1023)<<10)+(n.charCodeAt(++s)&1023),e[t++]=a>>18|240,e[t++]=a>>12&63|128,e[t++]=a>>6&63|128,e[t++]=a&63|128):(e[t++]=a>>12|224,e[t++]=a>>6&63|128,e[t++]=a&63|128)}return e},ZE=function(n){const e=[];let t=0,s=0;for(;t<n.length;){const a=n[t++];if(a<128)e[s++]=String.fromCharCode(a);else if(a>191&&a<224){const l=n[t++];e[s++]=String.fromCharCode((a&31)<<6|l&63)}else if(a>239&&a<365){const l=n[t++],d=n[t++],f=n[t++],m=((a&7)<<18|(l&63)<<12|(d&63)<<6|f&63)-65536;e[s++]=String.fromCharCode(55296+(m>>10)),e[s++]=String.fromCharCode(56320+(m&1023))}else{const l=n[t++],d=n[t++];e[s++]=String.fromCharCode((a&15)<<12|(l&63)<<6|d&63)}}return e.join("")},n_={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let a=0;a<n.length;a+=3){const l=n[a],d=a+1<n.length,f=d?n[a+1]:0,m=a+2<n.length,v=m?n[a+2]:0,w=l>>2,E=(l&3)<<4|f>>4;let C=(f&15)<<2|v>>6,U=v&63;m||(U=64,d||(C=64)),s.push(t[w],t[E],t[C],t[U])}return s.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(t_(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):ZE(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let a=0;a<n.length;){const l=t[n.charAt(a++)],f=a<n.length?t[n.charAt(a)]:0;++a;const v=a<n.length?t[n.charAt(a)]:64;++a;const E=a<n.length?t[n.charAt(a)]:64;if(++a,l==null||f==null||v==null||E==null)throw new eT;const C=l<<2|f>>4;if(s.push(C),v!==64){const U=f<<4&240|v>>2;if(s.push(U),E!==64){const G=v<<6&192|E;s.push(G)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class eT extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const tT=function(n){const e=t_(n);return n_.encodeByteArray(e,!0)},Eu=function(n){return tT(n).replace(/\./g,"")},r_=function(n){try{return n_.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nT(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rT=()=>nT().__FIREBASE_DEFAULTS__,sT=()=>{if(typeof process>"u"||typeof ny>"u")return;const n=ny.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},iT=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&r_(n[1]);return e&&JSON.parse(e)},$u=()=>{try{return XE()||rT()||sT()||iT()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},s_=n=>{var e,t;return(t=(e=$u())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},aT=n=>{const e=s_(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),s]:[e.substring(0,t),s]},i_=()=>{var n;return(n=$u())===null||n===void 0?void 0:n.config},a_=n=>{var e;return(e=$u())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oT{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,s)=>{t?this.reject(t):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,s))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Io(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function o_(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lT(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},s=e||"demo-project",a=n.iat||0,l=n.sub||n.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d=Object.assign({iss:`https://securetoken.google.com/${s}`,aud:s,iat:a,exp:a+3600,auth_time:a,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Eu(JSON.stringify(t)),Eu(JSON.stringify(d)),""].join(".")}const xl={};function cT(){const n={prod:[],emulator:[]};for(const e of Object.keys(xl))xl[e]?n.emulator.push(e):n.prod.push(e);return n}function uT(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let ry=!1;function l_(n,e){if(typeof window>"u"||typeof document>"u"||!Io(window.location.host)||xl[n]===e||xl[n]||ry)return;xl[n]=e;function t(C){return`__firebase__banner__${C}`}const s="__firebase__banner",l=cT().prod.length>0;function d(){const C=document.getElementById(s);C&&C.remove()}function f(C){C.style.display="flex",C.style.background="#7faaf0",C.style.position="fixed",C.style.bottom="5px",C.style.left="5px",C.style.padding=".5em",C.style.borderRadius="5px",C.style.alignItems="center"}function m(C,U){C.setAttribute("width","24"),C.setAttribute("id",U),C.setAttribute("height","24"),C.setAttribute("viewBox","0 0 24 24"),C.setAttribute("fill","none"),C.style.marginLeft="-6px"}function v(){const C=document.createElement("span");return C.style.cursor="pointer",C.style.marginLeft="16px",C.style.fontSize="24px",C.innerHTML=" &times;",C.onclick=()=>{ry=!0,d()},C}function w(C,U){C.setAttribute("id",U),C.innerText="Learn more",C.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",C.setAttribute("target","__blank"),C.style.paddingLeft="5px",C.style.textDecoration="underline"}function E(){const C=uT(s),U=t("text"),G=document.getElementById(U)||document.createElement("span"),K=t("learnmore"),O=document.getElementById(K)||document.createElement("a"),re=t("preprendIcon"),ye=document.getElementById(re)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(C.created){const ne=C.element;f(ne),w(O,K);const oe=v();m(ye,re),ne.append(ye,G,O,oe),document.body.appendChild(ne)}l?(G.innerText="Preview backend disconnected.",ye.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(ye.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,G.innerText="Preview backend running in this workspace."),G.setAttribute("id",U)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",E):E()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function dT(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(qn())}function hT(){var n;const e=(n=$u())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function fT(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function pT(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function mT(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function gT(){const n=qn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function yT(){return!hT()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function vT(){try{return typeof indexedDB=="object"}catch{return!1}}function _T(){return new Promise((n,e)=>{try{let t=!0;const s="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(s);a.onsuccess=()=>{a.result.close(),t||self.indexedDB.deleteDatabase(s),n(!0)},a.onupgradeneeded=()=>{t=!1},a.onerror=()=>{var l;e(((l=a.error)===null||l===void 0?void 0:l.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wT="FirebaseError";class ni extends Error{constructor(e,t,s){super(t),this.code=e,this.customData=s,this.name=wT,Object.setPrototypeOf(this,ni.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,zl.prototype.create)}}class zl{constructor(e,t,s){this.service=e,this.serviceName=t,this.errors=s}create(e,...t){const s=t[0]||{},a=`${this.service}/${e}`,l=this.errors[e],d=l?xT(l,s):"Error",f=`${this.serviceName}: ${d} (${a}).`;return new ni(a,f,s)}}function xT(n,e){return n.replace(ET,(t,s)=>{const a=e[s];return a!=null?String(a):`<${s}?>`})}const ET=/\{\$([^}]+)}/g;function TT(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function ya(n,e){if(n===e)return!0;const t=Object.keys(n),s=Object.keys(e);for(const a of t){if(!s.includes(a))return!1;const l=n[a],d=e[a];if(sy(l)&&sy(d)){if(!ya(l,d))return!1}else if(l!==d)return!1}for(const a of s)if(!t.includes(a))return!1;return!0}function sy(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bl(n){const e=[];for(const[t,s]of Object.entries(n))Array.isArray(s)?s.forEach(a=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function pl(n){const e={};return n.replace(/^\?/,"").split("&").forEach(s=>{if(s){const[a,l]=s.split("=");e[decodeURIComponent(a)]=decodeURIComponent(l)}}),e}function ml(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function ST(n,e){const t=new IT(n,e);return t.subscribe.bind(t)}class IT{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,s){let a;if(e===void 0&&t===void 0&&s===void 0)throw new Error("Missing Observer.");CT(e,["next","error","complete"])?a=e:a={next:e,error:t,complete:s},a.next===void 0&&(a.next=Bh),a.error===void 0&&(a.error=Bh),a.complete===void 0&&(a.complete=Bh);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function CT(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Bh(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function on(n){return n&&n._delegate?n._delegate:n}class va{constructor(e,t,s){this.name=e,this.instanceFactory=t,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fa="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PT{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const s=new oT;if(this.instancesDeferred.set(t,s),this.isInitialized(t)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:t});a&&s.resolve(a)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const s=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),a=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(s)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:s})}catch(l){if(a)return null;throw l}else{if(a)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(RT(e))try{this.getOrInitializeService({instanceIdentifier:fa})}catch{}for(const[t,s]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(t);try{const l=this.getOrInitializeService({instanceIdentifier:a});s.resolve(l)}catch{}}}}clearInstance(e=fa){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=fa){return this.instances.has(e)}getOptions(e=fa){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:s,options:t});for(const[l,d]of this.instancesDeferred.entries()){const f=this.normalizeInstanceIdentifier(l);s===f&&d.resolve(a)}return a}onInit(e,t){var s;const a=this.normalizeInstanceIdentifier(t),l=(s=this.onInitCallbacks.get(a))!==null&&s!==void 0?s:new Set;l.add(e),this.onInitCallbacks.set(a,l);const d=this.instances.get(a);return d&&e(d,a),()=>{l.delete(e)}}invokeOnInitCallbacks(e,t){const s=this.onInitCallbacks.get(t);if(s)for(const a of s)try{a(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:bT(e),options:t}),this.instances.set(e,s),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=fa){return this.component?this.component.multipleInstances?e:fa:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function bT(n){return n===fa?void 0:n}function RT(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AT{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new PT(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ut;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(ut||(ut={}));const NT={debug:ut.DEBUG,verbose:ut.VERBOSE,info:ut.INFO,warn:ut.WARN,error:ut.ERROR,silent:ut.SILENT},kT=ut.INFO,jT={[ut.DEBUG]:"log",[ut.VERBOSE]:"log",[ut.INFO]:"info",[ut.WARN]:"warn",[ut.ERROR]:"error"},DT=(n,e,...t)=>{if(e<n.logLevel)return;const s=new Date().toISOString(),a=jT[e];if(a)console[a](`[${s}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Mf{constructor(e){this.name=e,this._logLevel=kT,this._logHandler=DT,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ut))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?NT[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ut.DEBUG,...e),this._logHandler(this,ut.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ut.VERBOSE,...e),this._logHandler(this,ut.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ut.INFO,...e),this._logHandler(this,ut.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ut.WARN,...e),this._logHandler(this,ut.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ut.ERROR,...e),this._logHandler(this,ut.ERROR,...e)}}const LT=(n,e)=>e.some(t=>n instanceof t);let iy,ay;function VT(){return iy||(iy=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function OT(){return ay||(ay=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const c_=new WeakMap,af=new WeakMap,u_=new WeakMap,$h=new WeakMap,Ff=new WeakMap;function MT(n){const e=new Promise((t,s)=>{const a=()=>{n.removeEventListener("success",l),n.removeEventListener("error",d)},l=()=>{t(Ai(n.result)),a()},d=()=>{s(n.error),a()};n.addEventListener("success",l),n.addEventListener("error",d)});return e.then(t=>{t instanceof IDBCursor&&c_.set(t,n)}).catch(()=>{}),Ff.set(e,n),e}function FT(n){if(af.has(n))return;const e=new Promise((t,s)=>{const a=()=>{n.removeEventListener("complete",l),n.removeEventListener("error",d),n.removeEventListener("abort",d)},l=()=>{t(),a()},d=()=>{s(n.error||new DOMException("AbortError","AbortError")),a()};n.addEventListener("complete",l),n.addEventListener("error",d),n.addEventListener("abort",d)});af.set(n,e)}let of={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return af.get(n);if(e==="objectStoreNames")return n.objectStoreNames||u_.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Ai(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function UT(n){of=n(of)}function zT(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const s=n.call(Wh(this),e,...t);return u_.set(s,e.sort?e.sort():[e]),Ai(s)}:OT().includes(n)?function(...e){return n.apply(Wh(this),e),Ai(c_.get(this))}:function(...e){return Ai(n.apply(Wh(this),e))}}function BT(n){return typeof n=="function"?zT(n):(n instanceof IDBTransaction&&FT(n),LT(n,VT())?new Proxy(n,of):n)}function Ai(n){if(n instanceof IDBRequest)return MT(n);if($h.has(n))return $h.get(n);const e=BT(n);return e!==n&&($h.set(n,e),Ff.set(e,n)),e}const Wh=n=>Ff.get(n);function $T(n,e,{blocked:t,upgrade:s,blocking:a,terminated:l}={}){const d=indexedDB.open(n,e),f=Ai(d);return s&&d.addEventListener("upgradeneeded",m=>{s(Ai(d.result),m.oldVersion,m.newVersion,Ai(d.transaction),m)}),t&&d.addEventListener("blocked",m=>t(m.oldVersion,m.newVersion,m)),f.then(m=>{l&&m.addEventListener("close",()=>l()),a&&m.addEventListener("versionchange",v=>a(v.oldVersion,v.newVersion,v))}).catch(()=>{}),f}const WT=["get","getKey","getAll","getAllKeys","count"],HT=["put","add","delete","clear"],Hh=new Map;function oy(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Hh.get(e))return Hh.get(e);const t=e.replace(/FromIndex$/,""),s=e!==t,a=HT.includes(t);if(!(t in(s?IDBIndex:IDBObjectStore).prototype)||!(a||WT.includes(t)))return;const l=async function(d,...f){const m=this.transaction(d,a?"readwrite":"readonly");let v=m.store;return s&&(v=v.index(f.shift())),(await Promise.all([v[t](...f),a&&m.done]))[0]};return Hh.set(e,l),l}UT(n=>({...n,get:(e,t,s)=>oy(e,t)||n.get(e,t,s),has:(e,t)=>!!oy(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GT{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(qT(t)){const s=t.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(t=>t).join(" ")}}function qT(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const lf="@firebase/app",ly="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Js=new Mf("@firebase/app"),KT="@firebase/app-compat",QT="@firebase/analytics-compat",YT="@firebase/analytics",JT="@firebase/app-check-compat",XT="@firebase/app-check",ZT="@firebase/auth",eS="@firebase/auth-compat",tS="@firebase/database",nS="@firebase/data-connect",rS="@firebase/database-compat",sS="@firebase/functions",iS="@firebase/functions-compat",aS="@firebase/installations",oS="@firebase/installations-compat",lS="@firebase/messaging",cS="@firebase/messaging-compat",uS="@firebase/performance",dS="@firebase/performance-compat",hS="@firebase/remote-config",fS="@firebase/remote-config-compat",pS="@firebase/storage",mS="@firebase/storage-compat",gS="@firebase/firestore",yS="@firebase/ai",vS="@firebase/firestore-compat",_S="firebase",wS="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cf="[DEFAULT]",xS={[lf]:"fire-core",[KT]:"fire-core-compat",[YT]:"fire-analytics",[QT]:"fire-analytics-compat",[XT]:"fire-app-check",[JT]:"fire-app-check-compat",[ZT]:"fire-auth",[eS]:"fire-auth-compat",[tS]:"fire-rtdb",[nS]:"fire-data-connect",[rS]:"fire-rtdb-compat",[sS]:"fire-fn",[iS]:"fire-fn-compat",[aS]:"fire-iid",[oS]:"fire-iid-compat",[lS]:"fire-fcm",[cS]:"fire-fcm-compat",[uS]:"fire-perf",[dS]:"fire-perf-compat",[hS]:"fire-rc",[fS]:"fire-rc-compat",[pS]:"fire-gcs",[mS]:"fire-gcs-compat",[gS]:"fire-fst",[vS]:"fire-fst-compat",[yS]:"fire-vertex","fire-js":"fire-js",[_S]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tu=new Map,ES=new Map,uf=new Map;function cy(n,e){try{n.container.addComponent(e)}catch(t){Js.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function go(n){const e=n.name;if(uf.has(e))return Js.debug(`There were multiple attempts to register component ${e}.`),!1;uf.set(e,n);for(const t of Tu.values())cy(t,n);for(const t of ES.values())cy(t,n);return!0}function Uf(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Er(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TS={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ni=new zl("app","Firebase",TS);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SS{constructor(e,t,s){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new va("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ni.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Co=wS;function d_(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const s=Object.assign({name:cf,automaticDataCollectionEnabled:!0},e),a=s.name;if(typeof a!="string"||!a)throw Ni.create("bad-app-name",{appName:String(a)});if(t||(t=i_()),!t)throw Ni.create("no-options");const l=Tu.get(a);if(l){if(ya(t,l.options)&&ya(s,l.config))return l;throw Ni.create("duplicate-app",{appName:a})}const d=new AT(a);for(const m of uf.values())d.addComponent(m);const f=new SS(t,s,d);return Tu.set(a,f),f}function h_(n=cf){const e=Tu.get(n);if(!e&&n===cf&&i_())return d_();if(!e)throw Ni.create("no-app",{appName:n});return e}function ki(n,e,t){var s;let a=(s=xS[n])!==null&&s!==void 0?s:n;t&&(a+=`-${t}`);const l=a.match(/\s|\//),d=e.match(/\s|\//);if(l||d){const f=[`Unable to register library "${a}" with version "${e}":`];l&&f.push(`library name "${a}" contains illegal characters (whitespace or "/")`),l&&d&&f.push("and"),d&&f.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Js.warn(f.join(" "));return}go(new va(`${a}-version`,()=>({library:a,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IS="firebase-heartbeat-database",CS=1,Al="firebase-heartbeat-store";let Gh=null;function f_(){return Gh||(Gh=$T(IS,CS,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Al)}catch(t){console.warn(t)}}}}).catch(n=>{throw Ni.create("idb-open",{originalErrorMessage:n.message})})),Gh}async function PS(n){try{const t=(await f_()).transaction(Al),s=await t.objectStore(Al).get(p_(n));return await t.done,s}catch(e){if(e instanceof ni)Js.warn(e.message);else{const t=Ni.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Js.warn(t.message)}}}async function uy(n,e){try{const s=(await f_()).transaction(Al,"readwrite");await s.objectStore(Al).put(e,p_(n)),await s.done}catch(t){if(t instanceof ni)Js.warn(t.message);else{const s=Ni.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Js.warn(s.message)}}}function p_(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bS=1024,RS=30;class AS{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new kS(t),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){var e,t;try{const a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),l=dy();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===l||this._heartbeatsCache.heartbeats.some(d=>d.date===l))return;if(this._heartbeatsCache.heartbeats.push({date:l,agent:a}),this._heartbeatsCache.heartbeats.length>RS){const d=jS(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(d,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(s){Js.warn(s)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=dy(),{heartbeatsToSend:s,unsentEntries:a}=NS(this._heartbeatsCache.heartbeats),l=Eu(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=t,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(t){return Js.warn(t),""}}}function dy(){return new Date().toISOString().substring(0,10)}function NS(n,e=bS){const t=[];let s=n.slice();for(const a of n){const l=t.find(d=>d.agent===a.agent);if(l){if(l.dates.push(a.date),hy(t)>e){l.dates.pop();break}}else if(t.push({agent:a.agent,dates:[a.date]}),hy(t)>e){t.pop();break}s=s.slice(1)}return{heartbeatsToSend:t,unsentEntries:s}}class kS{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return vT()?_T().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await PS(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const a=await this.read();return uy(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:a.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const a=await this.read();return uy(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:a.lastSentHeartbeatDate,heartbeats:[...a.heartbeats,...e.heartbeats]})}else return}}function hy(n){return Eu(JSON.stringify({version:2,heartbeats:n})).length}function jS(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let s=1;s<n.length;s++)n[s].date<t&&(t=n[s].date,e=s);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DS(n){go(new va("platform-logger",e=>new GT(e),"PRIVATE")),go(new va("heartbeat",e=>new AS(e),"PRIVATE")),ki(lf,ly,n),ki(lf,ly,"esm2017"),ki("fire-js","")}DS("");var LS="firebase",VS="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ki(LS,VS,"app");function zf(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(n);a<s.length;a++)e.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(n,s[a])&&(t[s[a]]=n[s[a]]);return t}function m_(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const OS=m_,g_=new zl("auth","Firebase",m_());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Su=new Mf("@firebase/auth");function MS(n,...e){Su.logLevel<=ut.WARN&&Su.warn(`Auth (${Co}): ${n}`,...e)}function uu(n,...e){Su.logLevel<=ut.ERROR&&Su.error(`Auth (${Co}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Or(n,...e){throw $f(n,...e)}function ns(n,...e){return $f(n,...e)}function Bf(n,e,t){const s=Object.assign(Object.assign({},OS()),{[e]:t});return new zl("auth","Firebase",s).create(e,{appName:n.name})}function Qs(n){return Bf(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function y_(n,e,t){const s=t;if(!(e instanceof s))throw s.name!==e.constructor.name&&Or(n,"argument-error"),Bf(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function $f(n,...e){if(typeof n!="string"){const t=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=n.name),n._errorFactory.create(t,...s)}return g_.create(n,...e)}function He(n,e,...t){if(!n)throw $f(e,...t)}function Gs(n){const e="INTERNAL ASSERTION FAILED: "+n;throw uu(e),new Error(e)}function Xs(n,e){n||Gs(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function df(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function FS(){return fy()==="http:"||fy()==="https:"}function fy(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function US(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(FS()||pT()||"connection"in navigator)?navigator.onLine:!0}function zS(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $l{constructor(e,t){this.shortDelay=e,this.longDelay=t,Xs(t>e,"Short delay should be less than long delay!"),this.isMobile=dT()||mT()}get(){return US()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wf(n,e){Xs(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v_{static initialize(e,t,s){this.fetchImpl=e,t&&(this.headersImpl=t),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Gs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Gs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Gs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BS={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $S=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],WS=new $l(3e4,6e4);function Wi(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function Ps(n,e,t,s,a={}){return __(n,a,async()=>{let l={},d={};s&&(e==="GET"?d=s:l={body:JSON.stringify(s)});const f=Bl(Object.assign({key:n.config.apiKey},d)).slice(1),m=await n._getAdditionalHeaders();m["Content-Type"]="application/json",n.languageCode&&(m["X-Firebase-Locale"]=n.languageCode);const v=Object.assign({method:e,headers:m},l);return fT()||(v.referrerPolicy="no-referrer"),n.emulatorConfig&&Io(n.emulatorConfig.host)&&(v.credentials="include"),v_.fetch()(await w_(n,n.config.apiHost,t,f),v)})}async function __(n,e,t){n._canInitEmulator=!1;const s=Object.assign(Object.assign({},BS),e);try{const a=new GS(n),l=await Promise.race([t(),a.promise]);a.clearNetworkTimeout();const d=await l.json();if("needConfirmation"in d)throw su(n,"account-exists-with-different-credential",d);if(l.ok&&!("errorMessage"in d))return d;{const f=l.ok?d.errorMessage:d.error.message,[m,v]=f.split(" : ");if(m==="FEDERATED_USER_ID_ALREADY_LINKED")throw su(n,"credential-already-in-use",d);if(m==="EMAIL_EXISTS")throw su(n,"email-already-in-use",d);if(m==="USER_DISABLED")throw su(n,"user-disabled",d);const w=s[m]||m.toLowerCase().replace(/[_\s]+/g,"-");if(v)throw Bf(n,w,v);Or(n,w)}}catch(a){if(a instanceof ni)throw a;Or(n,"network-request-failed",{message:String(a)})}}async function Wl(n,e,t,s,a={}){const l=await Ps(n,e,t,s,a);return"mfaPendingCredential"in l&&Or(n,"multi-factor-auth-required",{_serverResponse:l}),l}async function w_(n,e,t,s){const a=`${e}${t}?${s}`,l=n,d=l.config.emulator?Wf(n.config,a):`${n.config.apiScheme}://${a}`;return $S.includes(t)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(d).toString():d}function HS(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class GS{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,s)=>{this.timer=setTimeout(()=>s(ns(this.auth,"network-request-failed")),WS.get())})}}function su(n,e,t){const s={appName:n.name};t.email&&(s.email=t.email),t.phoneNumber&&(s.phoneNumber=t.phoneNumber);const a=ns(n,e,s);return a.customData._tokenResponse=t,a}function py(n){return n!==void 0&&n.enterprise!==void 0}class qS{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return HS(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function KS(n,e){return Ps(n,"GET","/v2/recaptchaConfig",Wi(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function QS(n,e){return Ps(n,"POST","/v1/accounts:delete",e)}async function YS(n,e){return Ps(n,"POST","/v1/accounts:update",e)}async function Iu(n,e){return Ps(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function El(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function JS(n,e=!1){const t=on(n),s=await t.getIdToken(e),a=Hf(s);He(a&&a.exp&&a.auth_time&&a.iat,t.auth,"internal-error");const l=typeof a.firebase=="object"?a.firebase:void 0,d=l==null?void 0:l.sign_in_provider;return{claims:a,token:s,authTime:El(qh(a.auth_time)),issuedAtTime:El(qh(a.iat)),expirationTime:El(qh(a.exp)),signInProvider:d||null,signInSecondFactor:(l==null?void 0:l.sign_in_second_factor)||null}}function qh(n){return Number(n)*1e3}function Hf(n){const[e,t,s]=n.split(".");if(e===void 0||t===void 0||s===void 0)return uu("JWT malformed, contained fewer than 3 sections"),null;try{const a=r_(t);return a?JSON.parse(a):(uu("Failed to decode base64 JWT payload"),null)}catch(a){return uu("Caught error parsing JWT payload as JSON",a==null?void 0:a.toString()),null}}function my(n){const e=Hf(n);return He(e,"internal-error"),He(typeof e.exp<"u","internal-error"),He(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yo(n,e,t=!1){if(t)return e;try{return await e}catch(s){throw s instanceof ni&&XS(s)&&n.auth.currentUser===n&&await n.auth.signOut(),s}}function XS({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZS{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const s=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),s}else{this.errorBackoff=3e4;const a=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,a)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hf{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=El(this.lastLoginAt),this.creationTime=El(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Nl(n){var e;const t=n.auth,s=await n.getIdToken(),a=await yo(n,Iu(t,{idToken:s}));He(a==null?void 0:a.users.length,t,"internal-error");const l=a.users[0];n._notifyReloadListener(l);const d=!((e=l.providerUserInfo)===null||e===void 0)&&e.length?x_(l.providerUserInfo):[],f=t1(n.providerData,d),m=n.isAnonymous,v=!(n.email&&l.passwordHash)&&!(f!=null&&f.length),w=m?v:!1,E={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:f,metadata:new hf(l.createdAt,l.lastLoginAt),isAnonymous:w};Object.assign(n,E)}async function e1(n){const e=on(n);await Nl(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function t1(n,e){return[...n.filter(s=>!e.some(a=>a.providerId===s.providerId)),...e]}function x_(n){return n.map(e=>{var{providerId:t}=e,s=zf(e,["providerId"]);return{providerId:t,uid:s.rawId||"",displayName:s.displayName||null,email:s.email||null,phoneNumber:s.phoneNumber||null,photoURL:s.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function n1(n,e){const t=await __(n,{},async()=>{const s=Bl({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:l}=n.config,d=await w_(n,a,"/v1/token",`key=${l}`),f=await n._getAdditionalHeaders();f["Content-Type"]="application/x-www-form-urlencoded";const m={method:"POST",headers:f,body:s};return n.emulatorConfig&&Io(n.emulatorConfig.host)&&(m.credentials="include"),v_.fetch()(d,m)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function r1(n,e){return Ps(n,"POST","/v2/accounts:revokeToken",Wi(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){He(e.idToken,"internal-error"),He(typeof e.idToken<"u","internal-error"),He(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):my(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){He(e.length!==0,"internal-error");const t=my(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(He(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:s,refreshToken:a,expiresIn:l}=await n1(e,t);this.updateTokensAndExpiration(s,a,Number(l))}updateTokensAndExpiration(e,t,s){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,t){const{refreshToken:s,accessToken:a,expirationTime:l}=t,d=new uo;return s&&(He(typeof s=="string","internal-error",{appName:e}),d.refreshToken=s),a&&(He(typeof a=="string","internal-error",{appName:e}),d.accessToken=a),l&&(He(typeof l=="number","internal-error",{appName:e}),d.expirationTime=l),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new uo,this.toJSON())}_performRefresh(){return Gs("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xi(n,e){He(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class ts{constructor(e){var{uid:t,auth:s,stsTokenManager:a}=e,l=zf(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new ZS(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=s,this.stsTokenManager=a,this.accessToken=a.accessToken,this.displayName=l.displayName||null,this.email=l.email||null,this.emailVerified=l.emailVerified||!1,this.phoneNumber=l.phoneNumber||null,this.photoURL=l.photoURL||null,this.isAnonymous=l.isAnonymous||!1,this.tenantId=l.tenantId||null,this.providerData=l.providerData?[...l.providerData]:[],this.metadata=new hf(l.createdAt||void 0,l.lastLoginAt||void 0)}async getIdToken(e){const t=await yo(this,this.stsTokenManager.getToken(this.auth,e));return He(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return JS(this,e)}reload(){return e1(this)}_assign(e){this!==e&&(He(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new ts(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){He(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),t&&await Nl(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Er(this.auth.app))return Promise.reject(Qs(this.auth));const e=await this.getIdToken();return await yo(this,QS(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var s,a,l,d,f,m,v,w;const E=(s=t.displayName)!==null&&s!==void 0?s:void 0,C=(a=t.email)!==null&&a!==void 0?a:void 0,U=(l=t.phoneNumber)!==null&&l!==void 0?l:void 0,G=(d=t.photoURL)!==null&&d!==void 0?d:void 0,K=(f=t.tenantId)!==null&&f!==void 0?f:void 0,O=(m=t._redirectEventId)!==null&&m!==void 0?m:void 0,re=(v=t.createdAt)!==null&&v!==void 0?v:void 0,ye=(w=t.lastLoginAt)!==null&&w!==void 0?w:void 0,{uid:ne,emailVerified:oe,isAnonymous:Ee,providerData:Se,stsTokenManager:b}=t;He(ne&&b,e,"internal-error");const A=uo.fromJSON(this.name,b);He(typeof ne=="string",e,"internal-error"),xi(E,e.name),xi(C,e.name),He(typeof oe=="boolean",e,"internal-error"),He(typeof Ee=="boolean",e,"internal-error"),xi(U,e.name),xi(G,e.name),xi(K,e.name),xi(O,e.name),xi(re,e.name),xi(ye,e.name);const k=new ts({uid:ne,auth:e,email:C,emailVerified:oe,displayName:E,isAnonymous:Ee,photoURL:G,phoneNumber:U,tenantId:K,stsTokenManager:A,createdAt:re,lastLoginAt:ye});return Se&&Array.isArray(Se)&&(k.providerData=Se.map(V=>Object.assign({},V))),O&&(k._redirectEventId=O),k}static async _fromIdTokenResponse(e,t,s=!1){const a=new uo;a.updateFromServerResponse(t);const l=new ts({uid:t.localId,auth:e,stsTokenManager:a,isAnonymous:s});return await Nl(l),l}static async _fromGetAccountInfoResponse(e,t,s){const a=t.users[0];He(a.localId!==void 0,"internal-error");const l=a.providerUserInfo!==void 0?x_(a.providerUserInfo):[],d=!(a.email&&a.passwordHash)&&!(l!=null&&l.length),f=new uo;f.updateFromIdToken(s);const m=new ts({uid:a.localId,auth:e,stsTokenManager:f,isAnonymous:d}),v={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new hf(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!(l!=null&&l.length)};return Object.assign(m,v),m}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gy=new Map;function qs(n){Xs(n instanceof Function,"Expected a class definition");let e=gy.get(n);return e?(Xs(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,gy.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E_{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}E_.type="NONE";const yy=E_;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function du(n,e,t){return`firebase:${n}:${e}:${t}`}class ho{constructor(e,t,s){this.persistence=e,this.auth=t,this.userKey=s;const{config:a,name:l}=this.auth;this.fullUserKey=du(this.userKey,a.apiKey,l),this.fullPersistenceKey=du("persistence",a.apiKey,l),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Iu(this.auth,{idToken:e}).catch(()=>{});return t?ts._fromGetAccountInfoResponse(this.auth,t,e):null}return ts._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,s="authUser"){if(!t.length)return new ho(qs(yy),e,s);const a=(await Promise.all(t.map(async v=>{if(await v._isAvailable())return v}))).filter(v=>v);let l=a[0]||qs(yy);const d=du(s,e.config.apiKey,e.name);let f=null;for(const v of t)try{const w=await v._get(d);if(w){let E;if(typeof w=="string"){const C=await Iu(e,{idToken:w}).catch(()=>{});if(!C)break;E=await ts._fromGetAccountInfoResponse(e,C,w)}else E=ts._fromJSON(e,w);v!==l&&(f=E),l=v;break}}catch{}const m=a.filter(v=>v._shouldAllowMigration);return!l._shouldAllowMigration||!m.length?new ho(l,e,s):(l=m[0],f&&await l._set(d,f.toJSON()),await Promise.all(t.map(async v=>{if(v!==l)try{await v._remove(d)}catch{}})),new ho(l,e,s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vy(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(C_(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(T_(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(b_(e))return"Blackberry";if(R_(e))return"Webos";if(S_(e))return"Safari";if((e.includes("chrome/")||I_(e))&&!e.includes("edge/"))return"Chrome";if(P_(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=n.match(t);if((s==null?void 0:s.length)===2)return s[1]}return"Other"}function T_(n=qn()){return/firefox\//i.test(n)}function S_(n=qn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function I_(n=qn()){return/crios\//i.test(n)}function C_(n=qn()){return/iemobile/i.test(n)}function P_(n=qn()){return/android/i.test(n)}function b_(n=qn()){return/blackberry/i.test(n)}function R_(n=qn()){return/webos/i.test(n)}function Gf(n=qn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function s1(n=qn()){var e;return Gf(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function i1(){return gT()&&document.documentMode===10}function A_(n=qn()){return Gf(n)||P_(n)||R_(n)||b_(n)||/windows phone/i.test(n)||C_(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N_(n,e=[]){let t;switch(n){case"Browser":t=vy(qn());break;case"Worker":t=`${vy(qn())}-${n}`;break;default:t=n}const s=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Co}/${s}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a1{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const s=l=>new Promise((d,f)=>{try{const m=e(l);d(m)}catch(m){f(m)}});s.onAbort=t,this.queue.push(s);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const s of this.queue)await s(e),s.onAbort&&t.push(s.onAbort)}catch(s){t.reverse();for(const a of t)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s==null?void 0:s.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function o1(n,e={}){return Ps(n,"GET","/v2/passwordPolicy",Wi(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l1=6;class c1{constructor(e){var t,s,a,l;const d=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=d.minPasswordLength)!==null&&t!==void 0?t:l1,d.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=d.maxPasswordLength),d.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=d.containsLowercaseCharacter),d.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=d.containsUppercaseCharacter),d.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=d.containsNumericCharacter),d.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=d.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(a=(s=e.allowedNonAlphanumericCharacters)===null||s===void 0?void 0:s.join(""))!==null&&a!==void 0?a:"",this.forceUpgradeOnSignin=(l=e.forceUpgradeOnSignin)!==null&&l!==void 0?l:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,s,a,l,d,f;const m={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,m),this.validatePasswordCharacterOptions(e,m),m.isValid&&(m.isValid=(t=m.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),m.isValid&&(m.isValid=(s=m.meetsMaxPasswordLength)!==null&&s!==void 0?s:!0),m.isValid&&(m.isValid=(a=m.containsLowercaseLetter)!==null&&a!==void 0?a:!0),m.isValid&&(m.isValid=(l=m.containsUppercaseLetter)!==null&&l!==void 0?l:!0),m.isValid&&(m.isValid=(d=m.containsNumericCharacter)!==null&&d!==void 0?d:!0),m.isValid&&(m.isValid=(f=m.containsNonAlphanumericCharacter)!==null&&f!==void 0?f:!0),m}validatePasswordLengthOptions(e,t){const s=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;s&&(t.meetsMinPasswordLength=e.length>=s),a&&(t.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let s;for(let a=0;a<e.length;a++)s=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(t,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,t,s,a,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u1{constructor(e,t,s,a){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=s,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new _y(this),this.idTokenSubscription=new _y(this),this.beforeStateQueue=new a1(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=g_,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=qs(t)),this._initializationPromise=this.queue(async()=>{var s,a,l;if(!this._deleted&&(this.persistenceManager=await ho.create(this,e),(s=this._resolvePersistenceManagerAvailable)===null||s===void 0||s.call(this),!this._deleted)){if(!((a=this._popupRedirectResolver)===null||a===void 0)&&a._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((l=this.currentUser)===null||l===void 0?void 0:l.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Iu(this,{idToken:e}),s=await ts._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(s)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Er(this.app)){const d=this.app.settings.authIdToken;return d?new Promise(f=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(d).then(f,f))}):this.directlySetCurrentUser(null)}const s=await this.assertedPersistence.getCurrentUser();let a=s,l=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const d=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,f=a==null?void 0:a._redirectEventId,m=await this.tryRedirectSignIn(e);(!d||d===f)&&(m!=null&&m.user)&&(a=m.user,l=!0)}if(!a)return this.directlySetCurrentUser(null);if(!a._redirectEventId){if(l)try{await this.beforeStateQueue.runMiddleware(a)}catch(d){a=s,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(d))}return a?this.reloadAndSetCurrentUserOrClear(a):this.directlySetCurrentUser(null)}return He(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===a._redirectEventId?this.directlySetCurrentUser(a):this.reloadAndSetCurrentUserOrClear(a)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Nl(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=zS()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Er(this.app))return Promise.reject(Qs(this));const t=e?on(e):null;return t&&He(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&He(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Er(this.app)?Promise.reject(Qs(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Er(this.app)?Promise.reject(Qs(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(qs(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await o1(this),t=new c1(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new zl("auth","Firebase",e())}onAuthStateChanged(e,t,s){return this.registerStateListener(this.authStateSubscription,e,t,s)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,s){return this.registerStateListener(this.idTokenSubscription,e,t,s)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(s.tenantId=this.tenantId),await r1(this,s)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const s=await this.getOrInitRedirectPersistenceManager(t);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&qs(e)||this._popupRedirectResolver;He(t,this,"argument-error"),this.redirectPersistenceManager=await ho.create(this,[qs(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,s;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((s=this.redirectUser)===null||s===void 0?void 0:s._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const s=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==s&&(this.lastNotifiedUid=s,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,s,a){if(this._deleted)return()=>{};const l=typeof t=="function"?t:t.next.bind(t);let d=!1;const f=this._isInitialized?Promise.resolve():this._initializationPromise;if(He(f,this,"internal-error"),f.then(()=>{d||l(this.currentUser)}),typeof t=="function"){const m=e.addObserver(t,s,a);return()=>{d=!0,m()}}else{const m=e.addObserver(t);return()=>{d=!0,m()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return He(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=N_(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const s=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());s&&(t["X-Firebase-Client"]=s);const a=await this._getAppCheckToken();return a&&(t["X-Firebase-AppCheck"]=a),t}async _getAppCheckToken(){var e;if(Er(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&MS(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function Hi(n){return on(n)}class _y{constructor(e){this.auth=e,this.observer=null,this.addObserver=ST(t=>this.observer=t)}get next(){return He(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Wu={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function d1(n){Wu=n}function k_(n){return Wu.loadJS(n)}function h1(){return Wu.recaptchaEnterpriseScript}function f1(){return Wu.gapiScript}function p1(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class m1{constructor(){this.enterprise=new g1}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class g1{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const y1="recaptcha-enterprise",j_="NO_RECAPTCHA";class v1{constructor(e){this.type=y1,this.auth=Hi(e)}async verify(e="verify",t=!1){async function s(l){if(!t){if(l.tenantId==null&&l._agentRecaptchaConfig!=null)return l._agentRecaptchaConfig.siteKey;if(l.tenantId!=null&&l._tenantRecaptchaConfigs[l.tenantId]!==void 0)return l._tenantRecaptchaConfigs[l.tenantId].siteKey}return new Promise(async(d,f)=>{KS(l,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(m=>{if(m.recaptchaKey===void 0)f(new Error("recaptcha Enterprise site key undefined"));else{const v=new qS(m);return l.tenantId==null?l._agentRecaptchaConfig=v:l._tenantRecaptchaConfigs[l.tenantId]=v,d(v.siteKey)}}).catch(m=>{f(m)})})}function a(l,d,f){const m=window.grecaptcha;py(m)?m.enterprise.ready(()=>{m.enterprise.execute(l,{action:e}).then(v=>{d(v)}).catch(()=>{d(j_)})}):f(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new m1().execute("siteKey",{action:"verify"}):new Promise((l,d)=>{s(this.auth).then(f=>{if(!t&&py(window.grecaptcha))a(f,l,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let m=h1();m.length!==0&&(m+=f),k_(m).then(()=>{a(f,l,d)}).catch(v=>{d(v)})}}).catch(f=>{d(f)})})}}async function wy(n,e,t,s=!1,a=!1){const l=new v1(n);let d;if(a)d=j_;else try{d=await l.verify(t)}catch{d=await l.verify(t,!0)}const f=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in f){const m=f.phoneEnrollmentInfo.phoneNumber,v=f.phoneEnrollmentInfo.recaptchaToken;Object.assign(f,{phoneEnrollmentInfo:{phoneNumber:m,recaptchaToken:v,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in f){const m=f.phoneSignInInfo.recaptchaToken;Object.assign(f,{phoneSignInInfo:{recaptchaToken:m,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return f}return s?Object.assign(f,{captchaResp:d}):Object.assign(f,{captchaResponse:d}),Object.assign(f,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(f,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),f}async function ff(n,e,t,s,a){var l;if(!((l=n._getRecaptchaConfig())===null||l===void 0)&&l.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const d=await wy(n,e,t,t==="getOobCode");return s(n,d)}else return s(n,e).catch(async d=>{if(d.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const f=await wy(n,e,t,t==="getOobCode");return s(n,f)}else return Promise.reject(d)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _1(n,e){const t=Uf(n,"auth");if(t.isInitialized()){const a=t.getImmediate(),l=t.getOptions();if(ya(l,e??{}))return a;Or(a,"already-initialized")}return t.initialize({options:e})}function w1(n,e){const t=(e==null?void 0:e.persistence)||[],s=(Array.isArray(t)?t:[t]).map(qs);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(s,e==null?void 0:e.popupRedirectResolver)}function x1(n,e,t){const s=Hi(n);He(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const a=!1,l=D_(e),{host:d,port:f}=E1(e),m=f===null?"":`:${f}`,v={url:`${l}//${d}${m}/`},w=Object.freeze({host:d,port:f,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!s._canInitEmulator){He(s.config.emulator&&s.emulatorConfig,s,"emulator-config-failed"),He(ya(v,s.config.emulator)&&ya(w,s.emulatorConfig),s,"emulator-config-failed");return}s.config.emulator=v,s.emulatorConfig=w,s.settings.appVerificationDisabledForTesting=!0,Io(d)?(o_(`${l}//${d}${m}`),l_("Auth",!0)):T1()}function D_(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function E1(n){const e=D_(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const s=t[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(s);if(a){const l=a[1];return{host:l,port:xy(s.substr(l.length+1))}}else{const[l,d]=s.split(":");return{host:l,port:xy(d)}}}function xy(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function T1(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qf{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Gs("not implemented")}_getIdTokenResponse(e){return Gs("not implemented")}_linkToIdToken(e,t){return Gs("not implemented")}_getReauthenticationResolver(e){return Gs("not implemented")}}async function S1(n,e){return Ps(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function I1(n,e){return Wl(n,"POST","/v1/accounts:signInWithPassword",Wi(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function C1(n,e){return Wl(n,"POST","/v1/accounts:signInWithEmailLink",Wi(n,e))}async function P1(n,e){return Wl(n,"POST","/v1/accounts:signInWithEmailLink",Wi(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kl extends qf{constructor(e,t,s,a=null){super("password",s),this._email=e,this._password=t,this._tenantId=a}static _fromEmailAndPassword(e,t){return new kl(e,t,"password")}static _fromEmailAndCode(e,t,s=null){return new kl(e,t,"emailLink",s)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return ff(e,t,"signInWithPassword",I1);case"emailLink":return C1(e,{email:this._email,oobCode:this._password});default:Or(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const s={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return ff(e,s,"signUpPassword",S1);case"emailLink":return P1(e,{idToken:t,email:this._email,oobCode:this._password});default:Or(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fo(n,e){return Wl(n,"POST","/v1/accounts:signInWithIdp",Wi(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b1="http://localhost";class Zs extends qf{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Zs(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Or("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:a}=t,l=zf(t,["providerId","signInMethod"]);if(!s||!a)return null;const d=new Zs(s,a);return d.idToken=l.idToken||void 0,d.accessToken=l.accessToken||void 0,d.secret=l.secret,d.nonce=l.nonce,d.pendingToken=l.pendingToken||null,d}_getIdTokenResponse(e){const t=this.buildRequest();return fo(e,t)}_linkToIdToken(e,t){const s=this.buildRequest();return s.idToken=t,fo(e,s)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,fo(e,t)}buildRequest(){const e={requestUri:b1,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Bl(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R1(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function A1(n){const e=pl(ml(n)).link,t=e?pl(ml(e)).deep_link_id:null,s=pl(ml(n)).deep_link_id;return(s?pl(ml(s)).link:null)||s||t||e||n}class Kf{constructor(e){var t,s,a,l,d,f;const m=pl(ml(e)),v=(t=m.apiKey)!==null&&t!==void 0?t:null,w=(s=m.oobCode)!==null&&s!==void 0?s:null,E=R1((a=m.mode)!==null&&a!==void 0?a:null);He(v&&w&&E,"argument-error"),this.apiKey=v,this.operation=E,this.code=w,this.continueUrl=(l=m.continueUrl)!==null&&l!==void 0?l:null,this.languageCode=(d=m.lang)!==null&&d!==void 0?d:null,this.tenantId=(f=m.tenantId)!==null&&f!==void 0?f:null}static parseLink(e){const t=A1(e);try{return new Kf(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Po{constructor(){this.providerId=Po.PROVIDER_ID}static credential(e,t){return kl._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const s=Kf.parseLink(t);return He(s,"argument-error"),kl._fromEmailAndCode(e,s.code,s.tenantId)}}Po.PROVIDER_ID="password";Po.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Po.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hu{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bo extends Hu{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Tl extends bo{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return He("providerId"in t&&"signInMethod"in t,"argument-error"),Zs._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return He(e.idToken||e.accessToken,"argument-error"),Zs._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return Tl.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return Tl.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:s,oauthTokenSecret:a,pendingToken:l,nonce:d,providerId:f}=e;if(!s&&!a&&!t&&!l||!f)return null;try{return new Tl(f)._credential({idToken:t,accessToken:s,nonce:d,pendingToken:l})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ti extends bo{constructor(){super("facebook.com")}static credential(e){return Zs._fromParams({providerId:Ti.PROVIDER_ID,signInMethod:Ti.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ti.credentialFromTaggedObject(e)}static credentialFromError(e){return Ti.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ti.credential(e.oauthAccessToken)}catch{return null}}}Ti.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ti.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class es extends bo{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Zs._fromParams({providerId:es.PROVIDER_ID,signInMethod:es.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return es.credentialFromTaggedObject(e)}static credentialFromError(e){return es.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:s}=e;if(!t&&!s)return null;try{return es.credential(t,s)}catch{return null}}}es.GOOGLE_SIGN_IN_METHOD="google.com";es.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Si extends bo{constructor(){super("github.com")}static credential(e){return Zs._fromParams({providerId:Si.PROVIDER_ID,signInMethod:Si.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Si.credentialFromTaggedObject(e)}static credentialFromError(e){return Si.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Si.credential(e.oauthAccessToken)}catch{return null}}}Si.GITHUB_SIGN_IN_METHOD="github.com";Si.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ii extends bo{constructor(){super("twitter.com")}static credential(e,t){return Zs._fromParams({providerId:Ii.PROVIDER_ID,signInMethod:Ii.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ii.credentialFromTaggedObject(e)}static credentialFromError(e){return Ii.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:s}=e;if(!t||!s)return null;try{return Ii.credential(t,s)}catch{return null}}}Ii.TWITTER_SIGN_IN_METHOD="twitter.com";Ii.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function N1(n,e){return Wl(n,"POST","/v1/accounts:signUp",Wi(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _a{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,s,a=!1){const l=await ts._fromIdTokenResponse(e,s,a),d=Ey(s);return new _a({user:l,providerId:d,_tokenResponse:s,operationType:t})}static async _forOperation(e,t,s){await e._updateTokensIfNecessary(s,!0);const a=Ey(s);return new _a({user:e,providerId:a,_tokenResponse:s,operationType:t})}}function Ey(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cu extends ni{constructor(e,t,s,a){var l;super(t.code,t.message),this.operationType=s,this.user=a,Object.setPrototypeOf(this,Cu.prototype),this.customData={appName:e.name,tenantId:(l=e.tenantId)!==null&&l!==void 0?l:void 0,_serverResponse:t.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,t,s,a){return new Cu(e,t,s,a)}}function L_(n,e,t,s){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?Cu._fromErrorAndOperation(n,l,e,s):l})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V_(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function k1(n,e){const t=on(n);await D1(!0,t,e);const{providerUserInfo:s}=await YS(t.auth,{idToken:await t.getIdToken(),deleteProvider:[e]}),a=V_(s||[]);return t.providerData=t.providerData.filter(l=>a.has(l.providerId)),a.has("phone")||(t.phoneNumber=null),await t.auth._persistUserIfCurrent(t),t}async function j1(n,e,t=!1){const s=await yo(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return _a._forOperation(n,"link",s)}async function D1(n,e,t){await Nl(e);const s=V_(e.providerData);He(s.has(t)===n,e.auth,"no-such-provider")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function L1(n,e,t=!1){const{auth:s}=n;if(Er(s.app))return Promise.reject(Qs(s));const a="reauthenticate";try{const l=await yo(n,L_(s,a,e,n),t);He(l.idToken,s,"internal-error");const d=Hf(l.idToken);He(d,s,"internal-error");const{sub:f}=d;return He(n.uid===f,s,"user-mismatch"),_a._forOperation(n,a,l)}catch(l){throw(l==null?void 0:l.code)==="auth/user-not-found"&&Or(s,"user-mismatch"),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function O_(n,e,t=!1){if(Er(n.app))return Promise.reject(Qs(n));const s="signIn",a=await L_(n,s,e),l=await _a._fromIdTokenResponse(n,s,a);return t||await n._updateCurrentUser(l.user),l}async function V1(n,e){return O_(Hi(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function M_(n){const e=Hi(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function O1(n,e,t){if(Er(n.app))return Promise.reject(Qs(n));const s=Hi(n),d=await ff(s,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",N1).catch(m=>{throw m.code==="auth/password-does-not-meet-requirements"&&M_(n),m}),f=await _a._fromIdTokenResponse(s,"signIn",d);return await s._updateCurrentUser(f.user),f}function F_(n,e,t){return Er(n.app)?Promise.reject(Qs(n)):V1(on(n),Po.credential(e,t)).catch(async s=>{throw s.code==="auth/password-does-not-meet-requirements"&&M_(n),s})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function M1(n,e){return Ps(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function F1(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const s=on(n),l={idToken:await s.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},d=await yo(s,M1(s.auth,l));s.displayName=d.displayName||null,s.photoURL=d.photoUrl||null;const f=s.providerData.find(({providerId:m})=>m==="password");f&&(f.displayName=s.displayName,f.photoURL=s.photoURL),await s._updateTokensIfNecessary(d)}function U1(n,e,t,s){return on(n).onIdTokenChanged(e,t,s)}function z1(n,e,t){return on(n).beforeAuthStateChanged(e,t)}function B1(n,e,t,s){return on(n).onAuthStateChanged(e,t,s)}function U_(n){return on(n).signOut()}const Pu="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z_{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Pu,"1"),this.storage.removeItem(Pu),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $1=1e3,W1=10;class B_ extends z_{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=A_(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const s=this.storage.getItem(t),a=this.localCache[t];s!==a&&e(t,a,s)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((d,f,m)=>{this.notifyListeners(d,m)});return}const s=e.key;t?this.detachListener():this.stopPolling();const a=()=>{const d=this.storage.getItem(s);!t&&this.localCache[s]===d||this.notifyListeners(s,d)},l=this.storage.getItem(s);i1()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,W1):a()}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const a of Array.from(s))a(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:s}),!0)})},$1)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}B_.type="LOCAL";const H1=B_;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $_ extends z_{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}$_.type="SESSION";const W_=$_;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G1(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gu{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(a=>a.isListeningto(e));if(t)return t;const s=new Gu(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:s,eventType:a,data:l}=t.data,d=this.handlersMap[a];if(!(d!=null&&d.size))return;t.ports[0].postMessage({status:"ack",eventId:s,eventType:a});const f=Array.from(d).map(async v=>v(t.origin,l)),m=await G1(f);t.ports[0].postMessage({status:"done",eventId:s,eventType:a,response:m})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Gu.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qf(n="",e=10){let t="";for(let s=0;s<e;s++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q1{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,s=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let l,d;return new Promise((f,m)=>{const v=Qf("",20);a.port1.start();const w=setTimeout(()=>{m(new Error("unsupported_event"))},s);d={messageChannel:a,onMessage(E){const C=E;if(C.data.eventId===v)switch(C.data.status){case"ack":clearTimeout(w),l=setTimeout(()=>{m(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),f(C.data.response);break;default:clearTimeout(w),clearTimeout(l),m(new Error("invalid_response"));break}}},this.handlers.add(d),a.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:v,data:t},[a.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ws(){return window}function K1(n){ws().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H_(){return typeof ws().WorkerGlobalScope<"u"&&typeof ws().importScripts=="function"}async function Q1(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Y1(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function J1(){return H_()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G_="firebaseLocalStorageDb",X1=1,bu="firebaseLocalStorage",q_="fbase_key";class Hl{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function qu(n,e){return n.transaction([bu],e?"readwrite":"readonly").objectStore(bu)}function Z1(){const n=indexedDB.deleteDatabase(G_);return new Hl(n).toPromise()}function pf(){const n=indexedDB.open(G_,X1);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const s=n.result;try{s.createObjectStore(bu,{keyPath:q_})}catch(a){t(a)}}),n.addEventListener("success",async()=>{const s=n.result;s.objectStoreNames.contains(bu)?e(s):(s.close(),await Z1(),e(await pf()))})})}async function Ty(n,e,t){const s=qu(n,!0).put({[q_]:e,value:t});return new Hl(s).toPromise()}async function eI(n,e){const t=qu(n,!1).get(e),s=await new Hl(t).toPromise();return s===void 0?null:s.value}function Sy(n,e){const t=qu(n,!0).delete(e);return new Hl(t).toPromise()}const tI=800,nI=3;class K_{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await pf(),this.db)}async _withRetries(e){let t=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(t++>nI)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return H_()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Gu._getInstance(J1()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await Q1(),!this.activeServiceWorker)return;this.sender=new q1(this.activeServiceWorker);const s=await this.sender._send("ping",{},800);s&&!((e=s[0])===null||e===void 0)&&e.fulfilled&&!((t=s[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Y1()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await pf();return await Ty(e,Pu,"1"),await Sy(e,Pu),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(s=>Ty(s,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(s=>eI(s,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Sy(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const l=qu(a,!1).getAll();return new Hl(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],s=new Set;if(e.length!==0)for(const{fbase_key:a,value:l}of e)s.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(l)&&(this.notifyListeners(a,l),t.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!s.has(a)&&(this.notifyListeners(a,null),t.push(a));return t}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const a of Array.from(s))a(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),tI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}K_.type="LOCAL";const rI=K_;new $l(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yf(n,e){return e?qs(e):(He(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jf extends qf{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return fo(e,this._buildIdpRequest())}_linkToIdToken(e,t){return fo(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return fo(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function sI(n){return O_(n.auth,new Jf(n),n.bypassAuthState)}function iI(n){const{auth:e,user:t}=n;return He(t,e,"internal-error"),L1(t,new Jf(n),n.bypassAuthState)}async function aI(n){const{auth:e,user:t}=n;return He(t,e,"internal-error"),j1(t,new Jf(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q_{constructor(e,t,s,a,l=!1){this.auth=e,this.resolver=s,this.user=a,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:s,postBody:a,tenantId:l,error:d,type:f}=e;if(d){this.reject(d);return}const m={auth:this.auth,requestUri:t,sessionId:s,tenantId:l||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(f)(m))}catch(v){this.reject(v)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return sI;case"linkViaPopup":case"linkViaRedirect":return aI;case"reauthViaPopup":case"reauthViaRedirect":return iI;default:Or(this.auth,"internal-error")}}resolve(e){Xs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Xs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oI=new $l(2e3,1e4);async function Y_(n,e,t){if(Er(n.app))return Promise.reject(ns(n,"operation-not-supported-in-this-environment"));const s=Hi(n);y_(n,e,Hu);const a=Yf(s,t);return new Pi(s,"signInViaPopup",e,a).executeNotNull()}async function Iy(n,e,t){const s=on(n);y_(s.auth,e,Hu);const a=Yf(s.auth,t);return new Pi(s.auth,"linkViaPopup",e,a,s).executeNotNull()}class Pi extends Q_{constructor(e,t,s,a,l){super(e,t,a,l),this.provider=s,this.authWindow=null,this.pollId=null,Pi.currentPopupAction&&Pi.currentPopupAction.cancel(),Pi.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return He(e,this.auth,"internal-error"),e}async onExecution(){Xs(this.filter.length===1,"Popup operations only handle one event");const e=Qf();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(ns(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(ns(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Pi.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,s;if(!((s=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||s===void 0)&&s.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ns(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,oI.get())};e()}}Pi.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lI="pendingRedirect",hu=new Map;class cI extends Q_{constructor(e,t,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,s),this.eventId=null}async execute(){let e=hu.get(this.auth._key());if(!e){try{const s=await uI(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(t){e=()=>Promise.reject(t)}hu.set(this.auth._key(),e)}return this.bypassAuthState||hu.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function uI(n,e){const t=fI(e),s=hI(n);if(!await s._isAvailable())return!1;const a=await s._get(t)==="true";return await s._remove(t),a}function dI(n,e){hu.set(n._key(),e)}function hI(n){return qs(n._redirectPersistence)}function fI(n){return du(lI,n.config.apiKey,n.name)}async function pI(n,e,t=!1){if(Er(n.app))return Promise.reject(Qs(n));const s=Hi(n),a=Yf(s,e),d=await new cI(s,a,t).execute();return d&&!t&&(delete d.user._redirectEventId,await s._persistUserIfCurrent(d.user),await s._setRedirectUser(null,e)),d}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mI=600*1e3;class gI{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(t=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!yI(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var s;if(e.error&&!J_(e)){const a=((s=e.error.code)===null||s===void 0?void 0:s.split("auth/")[1])||"internal-error";t.onError(ns(this.auth,a))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const s=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=mI&&this.cachedEventUids.clear(),this.cachedEventUids.has(Cy(e))}saveEventToCache(e){this.cachedEventUids.add(Cy(e)),this.lastProcessedEventTime=Date.now()}}function Cy(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function J_({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function yI(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return J_(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vI(n,e={}){return Ps(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _I=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,wI=/^https?/;async function xI(n){if(n.config.emulator)return;const{authorizedDomains:e}=await vI(n);for(const t of e)try{if(EI(t))return}catch{}Or(n,"unauthorized-domain")}function EI(n){const e=df(),{protocol:t,hostname:s}=new URL(e);if(n.startsWith("chrome-extension://")){const d=new URL(n);return d.hostname===""&&s===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&d.hostname===s}if(!wI.test(t))return!1;if(_I.test(n))return s===n;const a=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(s)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TI=new $l(3e4,6e4);function Py(){const n=ws().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function SI(n){return new Promise((e,t)=>{var s,a,l;function d(){Py(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Py(),t(ns(n,"network-request-failed"))},timeout:TI.get()})}if(!((a=(s=ws().gapi)===null||s===void 0?void 0:s.iframes)===null||a===void 0)&&a.Iframe)e(gapi.iframes.getContext());else if(!((l=ws().gapi)===null||l===void 0)&&l.load)d();else{const f=p1("iframefcb");return ws()[f]=()=>{gapi.load?d():t(ns(n,"network-request-failed"))},k_(`${f1()}?onload=${f}`).catch(m=>t(m))}}).catch(e=>{throw fu=null,e})}let fu=null;function II(n){return fu=fu||SI(n),fu}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CI=new $l(5e3,15e3),PI="__/auth/iframe",bI="emulator/auth/iframe",RI={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},AI=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function NI(n){const e=n.config;He(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Wf(e,bI):`https://${n.config.authDomain}/${PI}`,s={apiKey:e.apiKey,appName:n.name,v:Co},a=AI.get(n.config.apiHost);a&&(s.eid=a);const l=n._getFrameworks();return l.length&&(s.fw=l.join(",")),`${t}?${Bl(s).slice(1)}`}async function kI(n){const e=await II(n),t=ws().gapi;return He(t,n,"internal-error"),e.open({where:document.body,url:NI(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:RI,dontclear:!0},s=>new Promise(async(a,l)=>{await s.restyle({setHideOnLeave:!1});const d=ns(n,"network-request-failed"),f=ws().setTimeout(()=>{l(d)},CI.get());function m(){ws().clearTimeout(f),a(s)}s.ping(m).then(m,()=>{l(d)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jI={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},DI=500,LI=600,VI="_blank",OI="http://localhost";class by{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function MI(n,e,t,s=DI,a=LI){const l=Math.max((window.screen.availHeight-a)/2,0).toString(),d=Math.max((window.screen.availWidth-s)/2,0).toString();let f="";const m=Object.assign(Object.assign({},jI),{width:s.toString(),height:a.toString(),top:l,left:d}),v=qn().toLowerCase();t&&(f=I_(v)?VI:t),T_(v)&&(e=e||OI,m.scrollbars="yes");const w=Object.entries(m).reduce((C,[U,G])=>`${C}${U}=${G},`,"");if(s1(v)&&f!=="_self")return FI(e||"",f),new by(null);const E=window.open(e||"",f,w);He(E,n,"popup-blocked");try{E.focus()}catch{}return new by(E)}function FI(n,e){const t=document.createElement("a");t.href=n,t.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UI="__/auth/handler",zI="emulator/auth/handler",BI=encodeURIComponent("fac");async function Ry(n,e,t,s,a,l){He(n.config.authDomain,n,"auth-domain-config-required"),He(n.config.apiKey,n,"invalid-api-key");const d={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:s,v:Co,eventId:a};if(e instanceof Hu){e.setDefaultLanguage(n.languageCode),d.providerId=e.providerId||"",TT(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[w,E]of Object.entries({}))d[w]=E}if(e instanceof bo){const w=e.getScopes().filter(E=>E!=="");w.length>0&&(d.scopes=w.join(","))}n.tenantId&&(d.tid=n.tenantId);const f=d;for(const w of Object.keys(f))f[w]===void 0&&delete f[w];const m=await n._getAppCheckToken(),v=m?`#${BI}=${encodeURIComponent(m)}`:"";return`${$I(n)}?${Bl(f).slice(1)}${v}`}function $I({config:n}){return n.emulator?Wf(n,zI):`https://${n.authDomain}/${UI}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kh="webStorageSupport";class WI{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=W_,this._completeRedirectFn=pI,this._overrideRedirectResult=dI}async _openPopup(e,t,s,a){var l;Xs((l=this.eventManagers[e._key()])===null||l===void 0?void 0:l.manager,"_initialize() not called before _openPopup()");const d=await Ry(e,t,s,df(),a);return MI(e,d,Qf())}async _openRedirect(e,t,s,a){await this._originValidation(e);const l=await Ry(e,t,s,df(),a);return K1(l),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:a,promise:l}=this.eventManagers[t];return a?Promise.resolve(a):(Xs(l,"If manager is not set, promise should be"),l)}const s=this.initAndGetManager(e);return this.eventManagers[t]={promise:s},s.catch(()=>{delete this.eventManagers[t]}),s}async initAndGetManager(e){const t=await kI(e),s=new gI(e);return t.register("authEvent",a=>(He(a==null?void 0:a.authEvent,e,"invalid-auth-event"),{status:s.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=t,s}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Kh,{type:Kh},a=>{var l;const d=(l=a==null?void 0:a[0])===null||l===void 0?void 0:l[Kh];d!==void 0&&t(!!d),Or(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=xI(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return A_()||S_()||Gf()}}const HI=WI;var Ay="@firebase/auth",Ny="1.10.8";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GI{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(s=>{e((s==null?void 0:s.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){He(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qI(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function KI(n){go(new va("auth",(e,{options:t})=>{const s=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:d,authDomain:f}=s.options;He(d&&!d.includes(":"),"invalid-api-key",{appName:s.name});const m={apiKey:d,authDomain:f,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:N_(n)},v=new u1(s,a,l,m);return w1(v,t),v},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,s)=>{e.getProvider("auth-internal").initialize()})),go(new va("auth-internal",e=>{const t=Hi(e.getProvider("auth").getImmediate());return(s=>new GI(s))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),ki(Ay,Ny,qI(n)),ki(Ay,Ny,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QI=300,YI=a_("authIdTokenMaxAge")||QI;let ky=null;const JI=n=>async e=>{const t=e&&await e.getIdTokenResult(),s=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(s&&s>YI)return;const a=t==null?void 0:t.token;ky!==a&&(ky=a,await fetch(n,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function XI(n=h_()){const e=Uf(n,"auth");if(e.isInitialized())return e.getImmediate();const t=_1(n,{popupRedirectResolver:HI,persistence:[rI,H1,W_]}),s=a_("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const l=new URL(s,location.origin);if(location.origin===l.origin){const d=JI(l.toString());z1(t,d,()=>d(t.currentUser)),U1(t,f=>d(f))}}const a=s_("auth");return a&&x1(t,`http://${a}`),t}function ZI(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}d1({loadJS(n){return new Promise((e,t)=>{const s=document.createElement("script");s.setAttribute("src",n),s.onload=e,s.onerror=a=>{const l=ns("internal-error");l.customData=a,t(l)},s.type="text/javascript",s.charset="UTF-8",ZI().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});KI("Browser");var jy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ji,X_;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(b,A){function k(){}k.prototype=A.prototype,b.D=A.prototype,b.prototype=new k,b.prototype.constructor=b,b.C=function(V,F,D){for(var I=Array(arguments.length-2),ge=2;ge<arguments.length;ge++)I[ge-2]=arguments[ge];return A.prototype[F].apply(V,I)}}function t(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(s,t),s.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(b,A,k){k||(k=0);var V=Array(16);if(typeof A=="string")for(var F=0;16>F;++F)V[F]=A.charCodeAt(k++)|A.charCodeAt(k++)<<8|A.charCodeAt(k++)<<16|A.charCodeAt(k++)<<24;else for(F=0;16>F;++F)V[F]=A[k++]|A[k++]<<8|A[k++]<<16|A[k++]<<24;A=b.g[0],k=b.g[1],F=b.g[2];var D=b.g[3],I=A+(D^k&(F^D))+V[0]+3614090360&4294967295;A=k+(I<<7&4294967295|I>>>25),I=D+(F^A&(k^F))+V[1]+3905402710&4294967295,D=A+(I<<12&4294967295|I>>>20),I=F+(k^D&(A^k))+V[2]+606105819&4294967295,F=D+(I<<17&4294967295|I>>>15),I=k+(A^F&(D^A))+V[3]+3250441966&4294967295,k=F+(I<<22&4294967295|I>>>10),I=A+(D^k&(F^D))+V[4]+4118548399&4294967295,A=k+(I<<7&4294967295|I>>>25),I=D+(F^A&(k^F))+V[5]+1200080426&4294967295,D=A+(I<<12&4294967295|I>>>20),I=F+(k^D&(A^k))+V[6]+2821735955&4294967295,F=D+(I<<17&4294967295|I>>>15),I=k+(A^F&(D^A))+V[7]+4249261313&4294967295,k=F+(I<<22&4294967295|I>>>10),I=A+(D^k&(F^D))+V[8]+1770035416&4294967295,A=k+(I<<7&4294967295|I>>>25),I=D+(F^A&(k^F))+V[9]+2336552879&4294967295,D=A+(I<<12&4294967295|I>>>20),I=F+(k^D&(A^k))+V[10]+4294925233&4294967295,F=D+(I<<17&4294967295|I>>>15),I=k+(A^F&(D^A))+V[11]+2304563134&4294967295,k=F+(I<<22&4294967295|I>>>10),I=A+(D^k&(F^D))+V[12]+1804603682&4294967295,A=k+(I<<7&4294967295|I>>>25),I=D+(F^A&(k^F))+V[13]+4254626195&4294967295,D=A+(I<<12&4294967295|I>>>20),I=F+(k^D&(A^k))+V[14]+2792965006&4294967295,F=D+(I<<17&4294967295|I>>>15),I=k+(A^F&(D^A))+V[15]+1236535329&4294967295,k=F+(I<<22&4294967295|I>>>10),I=A+(F^D&(k^F))+V[1]+4129170786&4294967295,A=k+(I<<5&4294967295|I>>>27),I=D+(k^F&(A^k))+V[6]+3225465664&4294967295,D=A+(I<<9&4294967295|I>>>23),I=F+(A^k&(D^A))+V[11]+643717713&4294967295,F=D+(I<<14&4294967295|I>>>18),I=k+(D^A&(F^D))+V[0]+3921069994&4294967295,k=F+(I<<20&4294967295|I>>>12),I=A+(F^D&(k^F))+V[5]+3593408605&4294967295,A=k+(I<<5&4294967295|I>>>27),I=D+(k^F&(A^k))+V[10]+38016083&4294967295,D=A+(I<<9&4294967295|I>>>23),I=F+(A^k&(D^A))+V[15]+3634488961&4294967295,F=D+(I<<14&4294967295|I>>>18),I=k+(D^A&(F^D))+V[4]+3889429448&4294967295,k=F+(I<<20&4294967295|I>>>12),I=A+(F^D&(k^F))+V[9]+568446438&4294967295,A=k+(I<<5&4294967295|I>>>27),I=D+(k^F&(A^k))+V[14]+3275163606&4294967295,D=A+(I<<9&4294967295|I>>>23),I=F+(A^k&(D^A))+V[3]+4107603335&4294967295,F=D+(I<<14&4294967295|I>>>18),I=k+(D^A&(F^D))+V[8]+1163531501&4294967295,k=F+(I<<20&4294967295|I>>>12),I=A+(F^D&(k^F))+V[13]+2850285829&4294967295,A=k+(I<<5&4294967295|I>>>27),I=D+(k^F&(A^k))+V[2]+4243563512&4294967295,D=A+(I<<9&4294967295|I>>>23),I=F+(A^k&(D^A))+V[7]+1735328473&4294967295,F=D+(I<<14&4294967295|I>>>18),I=k+(D^A&(F^D))+V[12]+2368359562&4294967295,k=F+(I<<20&4294967295|I>>>12),I=A+(k^F^D)+V[5]+4294588738&4294967295,A=k+(I<<4&4294967295|I>>>28),I=D+(A^k^F)+V[8]+2272392833&4294967295,D=A+(I<<11&4294967295|I>>>21),I=F+(D^A^k)+V[11]+1839030562&4294967295,F=D+(I<<16&4294967295|I>>>16),I=k+(F^D^A)+V[14]+4259657740&4294967295,k=F+(I<<23&4294967295|I>>>9),I=A+(k^F^D)+V[1]+2763975236&4294967295,A=k+(I<<4&4294967295|I>>>28),I=D+(A^k^F)+V[4]+1272893353&4294967295,D=A+(I<<11&4294967295|I>>>21),I=F+(D^A^k)+V[7]+4139469664&4294967295,F=D+(I<<16&4294967295|I>>>16),I=k+(F^D^A)+V[10]+3200236656&4294967295,k=F+(I<<23&4294967295|I>>>9),I=A+(k^F^D)+V[13]+681279174&4294967295,A=k+(I<<4&4294967295|I>>>28),I=D+(A^k^F)+V[0]+3936430074&4294967295,D=A+(I<<11&4294967295|I>>>21),I=F+(D^A^k)+V[3]+3572445317&4294967295,F=D+(I<<16&4294967295|I>>>16),I=k+(F^D^A)+V[6]+76029189&4294967295,k=F+(I<<23&4294967295|I>>>9),I=A+(k^F^D)+V[9]+3654602809&4294967295,A=k+(I<<4&4294967295|I>>>28),I=D+(A^k^F)+V[12]+3873151461&4294967295,D=A+(I<<11&4294967295|I>>>21),I=F+(D^A^k)+V[15]+530742520&4294967295,F=D+(I<<16&4294967295|I>>>16),I=k+(F^D^A)+V[2]+3299628645&4294967295,k=F+(I<<23&4294967295|I>>>9),I=A+(F^(k|~D))+V[0]+4096336452&4294967295,A=k+(I<<6&4294967295|I>>>26),I=D+(k^(A|~F))+V[7]+1126891415&4294967295,D=A+(I<<10&4294967295|I>>>22),I=F+(A^(D|~k))+V[14]+2878612391&4294967295,F=D+(I<<15&4294967295|I>>>17),I=k+(D^(F|~A))+V[5]+4237533241&4294967295,k=F+(I<<21&4294967295|I>>>11),I=A+(F^(k|~D))+V[12]+1700485571&4294967295,A=k+(I<<6&4294967295|I>>>26),I=D+(k^(A|~F))+V[3]+2399980690&4294967295,D=A+(I<<10&4294967295|I>>>22),I=F+(A^(D|~k))+V[10]+4293915773&4294967295,F=D+(I<<15&4294967295|I>>>17),I=k+(D^(F|~A))+V[1]+2240044497&4294967295,k=F+(I<<21&4294967295|I>>>11),I=A+(F^(k|~D))+V[8]+1873313359&4294967295,A=k+(I<<6&4294967295|I>>>26),I=D+(k^(A|~F))+V[15]+4264355552&4294967295,D=A+(I<<10&4294967295|I>>>22),I=F+(A^(D|~k))+V[6]+2734768916&4294967295,F=D+(I<<15&4294967295|I>>>17),I=k+(D^(F|~A))+V[13]+1309151649&4294967295,k=F+(I<<21&4294967295|I>>>11),I=A+(F^(k|~D))+V[4]+4149444226&4294967295,A=k+(I<<6&4294967295|I>>>26),I=D+(k^(A|~F))+V[11]+3174756917&4294967295,D=A+(I<<10&4294967295|I>>>22),I=F+(A^(D|~k))+V[2]+718787259&4294967295,F=D+(I<<15&4294967295|I>>>17),I=k+(D^(F|~A))+V[9]+3951481745&4294967295,b.g[0]=b.g[0]+A&4294967295,b.g[1]=b.g[1]+(F+(I<<21&4294967295|I>>>11))&4294967295,b.g[2]=b.g[2]+F&4294967295,b.g[3]=b.g[3]+D&4294967295}s.prototype.u=function(b,A){A===void 0&&(A=b.length);for(var k=A-this.blockSize,V=this.B,F=this.h,D=0;D<A;){if(F==0)for(;D<=k;)a(this,b,D),D+=this.blockSize;if(typeof b=="string"){for(;D<A;)if(V[F++]=b.charCodeAt(D++),F==this.blockSize){a(this,V),F=0;break}}else for(;D<A;)if(V[F++]=b[D++],F==this.blockSize){a(this,V),F=0;break}}this.h=F,this.o+=A},s.prototype.v=function(){var b=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);b[0]=128;for(var A=1;A<b.length-8;++A)b[A]=0;var k=8*this.o;for(A=b.length-8;A<b.length;++A)b[A]=k&255,k/=256;for(this.u(b),b=Array(16),A=k=0;4>A;++A)for(var V=0;32>V;V+=8)b[k++]=this.g[A]>>>V&255;return b};function l(b,A){var k=f;return Object.prototype.hasOwnProperty.call(k,b)?k[b]:k[b]=A(b)}function d(b,A){this.h=A;for(var k=[],V=!0,F=b.length-1;0<=F;F--){var D=b[F]|0;V&&D==A||(k[F]=D,V=!1)}this.g=k}var f={};function m(b){return-128<=b&&128>b?l(b,function(A){return new d([A|0],0>A?-1:0)}):new d([b|0],0>b?-1:0)}function v(b){if(isNaN(b)||!isFinite(b))return E;if(0>b)return O(v(-b));for(var A=[],k=1,V=0;b>=k;V++)A[V]=b/k|0,k*=4294967296;return new d(A,0)}function w(b,A){if(b.length==0)throw Error("number format error: empty string");if(A=A||10,2>A||36<A)throw Error("radix out of range: "+A);if(b.charAt(0)=="-")return O(w(b.substring(1),A));if(0<=b.indexOf("-"))throw Error('number format error: interior "-" character');for(var k=v(Math.pow(A,8)),V=E,F=0;F<b.length;F+=8){var D=Math.min(8,b.length-F),I=parseInt(b.substring(F,F+D),A);8>D?(D=v(Math.pow(A,D)),V=V.j(D).add(v(I))):(V=V.j(k),V=V.add(v(I)))}return V}var E=m(0),C=m(1),U=m(16777216);n=d.prototype,n.m=function(){if(K(this))return-O(this).m();for(var b=0,A=1,k=0;k<this.g.length;k++){var V=this.i(k);b+=(0<=V?V:4294967296+V)*A,A*=4294967296}return b},n.toString=function(b){if(b=b||10,2>b||36<b)throw Error("radix out of range: "+b);if(G(this))return"0";if(K(this))return"-"+O(this).toString(b);for(var A=v(Math.pow(b,6)),k=this,V="";;){var F=oe(k,A).g;k=re(k,F.j(A));var D=((0<k.g.length?k.g[0]:k.h)>>>0).toString(b);if(k=F,G(k))return D+V;for(;6>D.length;)D="0"+D;V=D+V}},n.i=function(b){return 0>b?0:b<this.g.length?this.g[b]:this.h};function G(b){if(b.h!=0)return!1;for(var A=0;A<b.g.length;A++)if(b.g[A]!=0)return!1;return!0}function K(b){return b.h==-1}n.l=function(b){return b=re(this,b),K(b)?-1:G(b)?0:1};function O(b){for(var A=b.g.length,k=[],V=0;V<A;V++)k[V]=~b.g[V];return new d(k,~b.h).add(C)}n.abs=function(){return K(this)?O(this):this},n.add=function(b){for(var A=Math.max(this.g.length,b.g.length),k=[],V=0,F=0;F<=A;F++){var D=V+(this.i(F)&65535)+(b.i(F)&65535),I=(D>>>16)+(this.i(F)>>>16)+(b.i(F)>>>16);V=I>>>16,D&=65535,I&=65535,k[F]=I<<16|D}return new d(k,k[k.length-1]&-2147483648?-1:0)};function re(b,A){return b.add(O(A))}n.j=function(b){if(G(this)||G(b))return E;if(K(this))return K(b)?O(this).j(O(b)):O(O(this).j(b));if(K(b))return O(this.j(O(b)));if(0>this.l(U)&&0>b.l(U))return v(this.m()*b.m());for(var A=this.g.length+b.g.length,k=[],V=0;V<2*A;V++)k[V]=0;for(V=0;V<this.g.length;V++)for(var F=0;F<b.g.length;F++){var D=this.i(V)>>>16,I=this.i(V)&65535,ge=b.i(F)>>>16,ve=b.i(F)&65535;k[2*V+2*F]+=I*ve,ye(k,2*V+2*F),k[2*V+2*F+1]+=D*ve,ye(k,2*V+2*F+1),k[2*V+2*F+1]+=I*ge,ye(k,2*V+2*F+1),k[2*V+2*F+2]+=D*ge,ye(k,2*V+2*F+2)}for(V=0;V<A;V++)k[V]=k[2*V+1]<<16|k[2*V];for(V=A;V<2*A;V++)k[V]=0;return new d(k,0)};function ye(b,A){for(;(b[A]&65535)!=b[A];)b[A+1]+=b[A]>>>16,b[A]&=65535,A++}function ne(b,A){this.g=b,this.h=A}function oe(b,A){if(G(A))throw Error("division by zero");if(G(b))return new ne(E,E);if(K(b))return A=oe(O(b),A),new ne(O(A.g),O(A.h));if(K(A))return A=oe(b,O(A)),new ne(O(A.g),A.h);if(30<b.g.length){if(K(b)||K(A))throw Error("slowDivide_ only works with positive integers.");for(var k=C,V=A;0>=V.l(b);)k=Ee(k),V=Ee(V);var F=Se(k,1),D=Se(V,1);for(V=Se(V,2),k=Se(k,2);!G(V);){var I=D.add(V);0>=I.l(b)&&(F=F.add(k),D=I),V=Se(V,1),k=Se(k,1)}return A=re(b,F.j(A)),new ne(F,A)}for(F=E;0<=b.l(A);){for(k=Math.max(1,Math.floor(b.m()/A.m())),V=Math.ceil(Math.log(k)/Math.LN2),V=48>=V?1:Math.pow(2,V-48),D=v(k),I=D.j(A);K(I)||0<I.l(b);)k-=V,D=v(k),I=D.j(A);G(D)&&(D=C),F=F.add(D),b=re(b,I)}return new ne(F,b)}n.A=function(b){return oe(this,b).h},n.and=function(b){for(var A=Math.max(this.g.length,b.g.length),k=[],V=0;V<A;V++)k[V]=this.i(V)&b.i(V);return new d(k,this.h&b.h)},n.or=function(b){for(var A=Math.max(this.g.length,b.g.length),k=[],V=0;V<A;V++)k[V]=this.i(V)|b.i(V);return new d(k,this.h|b.h)},n.xor=function(b){for(var A=Math.max(this.g.length,b.g.length),k=[],V=0;V<A;V++)k[V]=this.i(V)^b.i(V);return new d(k,this.h^b.h)};function Ee(b){for(var A=b.g.length+1,k=[],V=0;V<A;V++)k[V]=b.i(V)<<1|b.i(V-1)>>>31;return new d(k,b.h)}function Se(b,A){var k=A>>5;A%=32;for(var V=b.g.length-k,F=[],D=0;D<V;D++)F[D]=0<A?b.i(D+k)>>>A|b.i(D+k+1)<<32-A:b.i(D+k);return new d(F,b.h)}s.prototype.digest=s.prototype.v,s.prototype.reset=s.prototype.s,s.prototype.update=s.prototype.u,X_=s,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.A,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=v,d.fromString=w,ji=d}).apply(typeof jy<"u"?jy:typeof self<"u"?self:typeof window<"u"?window:{});var iu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Z_,gl,e0,pu,mf,t0,n0,r0;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,g,_){return u==Array.prototype||u==Object.prototype||(u[g]=_.value),u};function t(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof iu=="object"&&iu];for(var g=0;g<u.length;++g){var _=u[g];if(_&&_.Math==Math)return _}throw Error("Cannot find global object")}var s=t(this);function a(u,g){if(g)e:{var _=s;u=u.split(".");for(var T=0;T<u.length-1;T++){var H=u[T];if(!(H in _))break e;_=_[H]}u=u[u.length-1],T=_[u],g=g(T),g!=T&&g!=null&&e(_,u,{configurable:!0,writable:!0,value:g})}}function l(u,g){u instanceof String&&(u+="");var _=0,T=!1,H={next:function(){if(!T&&_<u.length){var te=_++;return{value:g(te,u[te]),done:!1}}return T=!0,{done:!0,value:void 0}}};return H[Symbol.iterator]=function(){return H},H}a("Array.prototype.values",function(u){return u||function(){return l(this,function(g,_){return _})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var d=d||{},f=this||self;function m(u){var g=typeof u;return g=g!="object"?g:u?Array.isArray(u)?"array":g:"null",g=="array"||g=="object"&&typeof u.length=="number"}function v(u){var g=typeof u;return g=="object"&&u!=null||g=="function"}function w(u,g,_){return u.call.apply(u.bind,arguments)}function E(u,g,_){if(!u)throw Error();if(2<arguments.length){var T=Array.prototype.slice.call(arguments,2);return function(){var H=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(H,T),u.apply(g,H)}}return function(){return u.apply(g,arguments)}}function C(u,g,_){return C=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?w:E,C.apply(null,arguments)}function U(u,g){var _=Array.prototype.slice.call(arguments,1);return function(){var T=_.slice();return T.push.apply(T,arguments),u.apply(this,T)}}function G(u,g){function _(){}_.prototype=g.prototype,u.aa=g.prototype,u.prototype=new _,u.prototype.constructor=u,u.Qb=function(T,H,te){for(var we=Array(arguments.length-2),It=2;It<arguments.length;It++)we[It-2]=arguments[It];return g.prototype[H].apply(T,we)}}function K(u){const g=u.length;if(0<g){const _=Array(g);for(let T=0;T<g;T++)_[T]=u[T];return _}return[]}function O(u,g){for(let _=1;_<arguments.length;_++){const T=arguments[_];if(m(T)){const H=u.length||0,te=T.length||0;u.length=H+te;for(let we=0;we<te;we++)u[H+we]=T[we]}else u.push(T)}}class re{constructor(g,_){this.i=g,this.j=_,this.h=0,this.g=null}get(){let g;return 0<this.h?(this.h--,g=this.g,this.g=g.next,g.next=null):g=this.i(),g}}function ye(u){return/^[\s\xa0]*$/.test(u)}function ne(){var u=f.navigator;return u&&(u=u.userAgent)?u:""}function oe(u){return oe[" "](u),u}oe[" "]=function(){};var Ee=ne().indexOf("Gecko")!=-1&&!(ne().toLowerCase().indexOf("webkit")!=-1&&ne().indexOf("Edge")==-1)&&!(ne().indexOf("Trident")!=-1||ne().indexOf("MSIE")!=-1)&&ne().indexOf("Edge")==-1;function Se(u,g,_){for(const T in u)g.call(_,u[T],T,u)}function b(u,g){for(const _ in u)g.call(void 0,u[_],_,u)}function A(u){const g={};for(const _ in u)g[_]=u[_];return g}const k="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function V(u,g){let _,T;for(let H=1;H<arguments.length;H++){T=arguments[H];for(_ in T)u[_]=T[_];for(let te=0;te<k.length;te++)_=k[te],Object.prototype.hasOwnProperty.call(T,_)&&(u[_]=T[_])}}function F(u){var g=1;u=u.split(":");const _=[];for(;0<g&&u.length;)_.push(u.shift()),g--;return u.length&&_.push(u.join(":")),_}function D(u){f.setTimeout(()=>{throw u},0)}function I(){var u=ee;let g=null;return u.g&&(g=u.g,u.g=u.g.next,u.g||(u.h=null),g.next=null),g}class ge{constructor(){this.h=this.g=null}add(g,_){const T=ve.get();T.set(g,_),this.h?this.h.next=T:this.g=T,this.h=T}}var ve=new re(()=>new lt,u=>u.reset());class lt{constructor(){this.next=this.g=this.h=null}set(g,_){this.h=g,this.g=_,this.next=null}reset(){this.next=this.g=this.h=null}}let Be,L=!1,ee=new ge,se=()=>{const u=f.Promise.resolve(void 0);Be=()=>{u.then(R)}};var R=()=>{for(var u;u=I();){try{u.h.call(u.g)}catch(_){D(_)}var g=ve;g.j(u),100>g.h&&(g.h++,u.next=g.g,g.g=u)}L=!1};function J(){this.s=this.s,this.C=this.C}J.prototype.s=!1,J.prototype.ma=function(){this.s||(this.s=!0,this.N())},J.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function me(u,g){this.type=u,this.g=this.target=g,this.defaultPrevented=!1}me.prototype.h=function(){this.defaultPrevented=!0};var ie=(function(){if(!f.addEventListener||!Object.defineProperty)return!1;var u=!1,g=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const _=()=>{};f.addEventListener("test",_,g),f.removeEventListener("test",_,g)}catch{}return u})();function Te(u,g){if(me.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var _=this.type=u.type,T=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=g,g=u.relatedTarget){if(Ee){e:{try{oe(g.nodeName);var H=!0;break e}catch{}H=!1}H||(g=null)}}else _=="mouseover"?g=u.fromElement:_=="mouseout"&&(g=u.toElement);this.relatedTarget=g,T?(this.clientX=T.clientX!==void 0?T.clientX:T.pageX,this.clientY=T.clientY!==void 0?T.clientY:T.pageY,this.screenX=T.screenX||0,this.screenY=T.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:Ce[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&Te.aa.h.call(this)}}G(Te,me);var Ce={2:"touch",3:"pen",4:"mouse"};Te.prototype.h=function(){Te.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var Ze="closure_listenable_"+(1e6*Math.random()|0),Ke=0;function ot(u,g,_,T,H){this.listener=u,this.proxy=null,this.src=g,this.type=_,this.capture=!!T,this.ha=H,this.key=++Ke,this.da=this.fa=!1}function jt(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function de(u){this.src=u,this.g={},this.h=0}de.prototype.add=function(u,g,_,T,H){var te=u.toString();u=this.g[te],u||(u=this.g[te]=[],this.h++);var we=Me(u,g,T,H);return-1<we?(g=u[we],_||(g.fa=!1)):(g=new ot(g,this.src,te,!!T,H),g.fa=_,u.push(g)),g};function ke(u,g){var _=g.type;if(_ in u.g){var T=u.g[_],H=Array.prototype.indexOf.call(T,g,void 0),te;(te=0<=H)&&Array.prototype.splice.call(T,H,1),te&&(jt(g),u.g[_].length==0&&(delete u.g[_],u.h--))}}function Me(u,g,_,T){for(var H=0;H<u.length;++H){var te=u[H];if(!te.da&&te.listener==g&&te.capture==!!_&&te.ha==T)return H}return-1}var Ue="closure_lm_"+(1e6*Math.random()|0),Tt={};function Ct(u,g,_,T,H){if(Array.isArray(g)){for(var te=0;te<g.length;te++)Ct(u,g[te],_,T,H);return null}return _=Mr(_),u&&u[Ze]?u.K(g,_,v(T)?!!T.capture:!1,H):Pt(u,g,_,!1,T,H)}function Pt(u,g,_,T,H,te){if(!g)throw Error("Invalid event type");var we=v(H)?!!H.capture:!!H,It=vn(u);if(It||(u[Ue]=It=new de(u)),_=It.add(g,_,T,we,te),_.proxy)return _;if(T=bt(),_.proxy=T,T.src=u,T.listener=_,u.addEventListener)ie||(H=we),H===void 0&&(H=!1),u.addEventListener(g.toString(),T,H);else if(u.attachEvent)u.attachEvent(Sn(g.toString()),T);else if(u.addListener&&u.removeListener)u.addListener(T);else throw Error("addEventListener and attachEvent are unavailable.");return _}function bt(){function u(_){return g.call(u.src,u.listener,_)}const g=ln;return u}function zt(u,g,_,T,H){if(Array.isArray(g))for(var te=0;te<g.length;te++)zt(u,g[te],_,T,H);else T=v(T)?!!T.capture:!!T,_=Mr(_),u&&u[Ze]?(u=u.i,g=String(g).toString(),g in u.g&&(te=u.g[g],_=Me(te,_,T,H),-1<_&&(jt(te[_]),Array.prototype.splice.call(te,_,1),te.length==0&&(delete u.g[g],u.h--)))):u&&(u=vn(u))&&(g=u.g[g.toString()],u=-1,g&&(u=Me(g,_,T,H)),(_=-1<u?g[u]:null)&&St(_))}function St(u){if(typeof u!="number"&&u&&!u.da){var g=u.src;if(g&&g[Ze])ke(g.i,u);else{var _=u.type,T=u.proxy;g.removeEventListener?g.removeEventListener(_,T,u.capture):g.detachEvent?g.detachEvent(Sn(_),T):g.addListener&&g.removeListener&&g.removeListener(T),(_=vn(g))?(ke(_,u),_.h==0&&(_.src=null,g[Ue]=null)):jt(u)}}}function Sn(u){return u in Tt?Tt[u]:Tt[u]="on"+u}function ln(u,g){if(u.da)u=!0;else{g=new Te(g,this);var _=u.listener,T=u.ha||u.src;u.fa&&St(u),u=_.call(T,g)}return u}function vn(u){return u=u[Ue],u instanceof de?u:null}var Qt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Mr(u){return typeof u=="function"?u:(u[Qt]||(u[Qt]=function(g){return u.handleEvent(g)}),u[Qt])}function Bt(){J.call(this),this.i=new de(this),this.M=this,this.F=null}G(Bt,J),Bt.prototype[Ze]=!0,Bt.prototype.removeEventListener=function(u,g,_,T){zt(this,u,g,_,T)};function Qe(u,g){var _,T=u.F;if(T)for(_=[];T;T=T.F)_.push(T);if(u=u.M,T=g.type||g,typeof g=="string")g=new me(g,u);else if(g instanceof me)g.target=g.target||u;else{var H=g;g=new me(T,u),V(g,H)}if(H=!0,_)for(var te=_.length-1;0<=te;te--){var we=g.g=_[te];H=nr(we,T,!0,g)&&H}if(we=g.g=u,H=nr(we,T,!0,g)&&H,H=nr(we,T,!1,g)&&H,_)for(te=0;te<_.length;te++)we=g.g=_[te],H=nr(we,T,!1,g)&&H}Bt.prototype.N=function(){if(Bt.aa.N.call(this),this.i){var u=this.i,g;for(g in u.g){for(var _=u.g[g],T=0;T<_.length;T++)jt(_[T]);delete u.g[g],u.h--}}this.F=null},Bt.prototype.K=function(u,g,_,T){return this.i.add(String(u),g,!1,_,T)},Bt.prototype.L=function(u,g,_,T){return this.i.add(String(u),g,!0,_,T)};function nr(u,g,_,T){if(g=u.i.g[String(g)],!g)return!0;g=g.concat();for(var H=!0,te=0;te<g.length;++te){var we=g[te];if(we&&!we.da&&we.capture==_){var It=we.listener,fn=we.ha||we.src;we.fa&&ke(u.i,we),H=It.call(fn,T)!==!1&&H}}return H&&!T.defaultPrevented}function bs(u,g,_){if(typeof u=="function")_&&(u=C(u,_));else if(u&&typeof u.handleEvent=="function")u=C(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(g)?-1:f.setTimeout(u,g||0)}function fr(u){u.g=bs(()=>{u.g=null,u.i&&(u.i=!1,fr(u))},u.l);const g=u.h;u.h=null,u.m.apply(null,g)}class pr extends J{constructor(g,_){super(),this.m=g,this.l=_,this.h=null,this.i=!1,this.g=null}j(g){this.h=arguments,this.g?this.i=!0:fr(this)}N(){super.N(),this.g&&(f.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Kn(u){J.call(this),this.h=u,this.g={}}G(Kn,J);var ss=[];function In(u){Se(u.g,function(g,_){this.g.hasOwnProperty(_)&&St(g)},u),u.g={}}Kn.prototype.N=function(){Kn.aa.N.call(this),In(this)},Kn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var is=f.JSON.stringify,Rs=f.JSON.parse,As=class{stringify(u){return f.JSON.stringify(u,void 0)}parse(u){return f.JSON.parse(u,void 0)}};function cn(){}cn.prototype.h=null;function ct(u){return u.h||(u.h=u.i())}function mr(){}var Dn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function en(){me.call(this,"d")}G(en,me);function un(){me.call(this,"c")}G(un,me);var dn={},Fr=null;function Sr(){return Fr=Fr||new Bt}dn.La="serverreachability";function as(u){me.call(this,dn.La,u)}G(as,me);function Qn(u){const g=Sr();Qe(g,new as(g))}dn.STAT_EVENT="statevent";function Ln(u,g){me.call(this,dn.STAT_EVENT,u),this.stat=g}G(Ln,me);function _t(u){const g=Sr();Qe(g,new Ln(g,u))}dn.Ma="timingevent";function qt(u,g){me.call(this,dn.Ma,u),this.size=g}G(qt,me);function Yt(u,g){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return f.setTimeout(function(){u()},g)}function P(){this.g=!0}P.prototype.xa=function(){this.g=!1};function Z(u,g,_,T,H,te){u.info(function(){if(u.g)if(te)for(var we="",It=te.split("&"),fn=0;fn<It.length;fn++){var ht=It[fn].split("=");if(1<ht.length){var _n=ht[0];ht=ht[1];var tn=_n.split("_");we=2<=tn.length&&tn[1]=="type"?we+(_n+"="+ht+"&"):we+(_n+"=redacted&")}}else we=null;else we=te;return"XMLHTTP REQ ("+T+") [attempt "+H+"]: "+g+`
`+_+`
`+we})}function le(u,g,_,T,H,te,we){u.info(function(){return"XMLHTTP RESP ("+T+") [ attempt "+H+"]: "+g+`
`+_+`
`+te+" "+we})}function $(u,g,_,T){u.info(function(){return"XMLHTTP TEXT ("+g+"): "+Le(u,_)+(T?" "+T:"")})}function Y(u,g){u.info(function(){return"TIMEOUT: "+g})}P.prototype.info=function(){};function Le(u,g){if(!u.g)return g;if(!g)return null;try{var _=JSON.parse(g);if(_){for(u=0;u<_.length;u++)if(Array.isArray(_[u])){var T=_[u];if(!(2>T.length)){var H=T[1];if(Array.isArray(H)&&!(1>H.length)){var te=H[0];if(te!="noop"&&te!="stop"&&te!="close")for(var we=1;we<H.length;we++)H[we]=""}}}}return is(_)}catch{return g}}var Oe={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Rt={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},xe;function Ye(){}G(Ye,cn),Ye.prototype.g=function(){return new XMLHttpRequest},Ye.prototype.i=function(){return{}},xe=new Ye;function mt(u,g,_,T){this.j=u,this.i=g,this.l=_,this.R=T||1,this.U=new Kn(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Cn}function Cn(){this.i=null,this.g="",this.h=!1}var Vn={},Ur={};function gt(u,g,_){u.L=1,u.v=Mn(Mt(g)),u.m=_,u.P=!0,gr(u,null)}function gr(u,g){u.F=Date.now(),vt(u),u.A=Mt(u.v);var _=u.A,T=u.R;Array.isArray(T)||(T=[String(T)]),si(_.i,"t",T),u.C=0,_=u.j.J,u.h=new Cn,u.g=lc(u.j,_?g:null,!u.m),0<u.O&&(u.M=new pr(C(u.Y,u,u.g),u.O)),g=u.U,_=u.g,T=u.ca;var H="readystatechange";Array.isArray(H)||(H&&(ss[0]=H.toString()),H=ss);for(var te=0;te<H.length;te++){var we=Ct(_,H[te],T||g.handleEvent,!1,g.h||g);if(!we)break;g.g[we.key]=we}g=u.H?A(u.H):{},u.m?(u.u||(u.u="POST"),g["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,g)):(u.u="GET",u.g.ea(u.A,u.u,null,g)),Qn(),Z(u.i,u.u,u.A,u.l,u.R,u.m)}mt.prototype.ca=function(u){u=u.target;const g=this.M;g&&sr(u)==3?g.j():this.Y(u)},mt.prototype.Y=function(u){try{if(u==this.g)e:{const tn=sr(this.g);var g=this.g.Ba();const Pr=this.g.Z();if(!(3>tn)&&(tn!=3||this.g&&(this.h.h||this.g.oa()||Oo(this.g)))){this.J||tn!=4||g==7||(g==8||0>=Pr?Qn(3):Qn(2)),Ns(this);var _=this.g.Z();this.X=_;t:if(Yn(this)){var T=Oo(this.g);u="";var H=T.length,te=sr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Jn(this),On(this);var we="";break t}this.h.i=new f.TextDecoder}for(g=0;g<H;g++)this.h.h=!0,u+=this.h.i.decode(T[g],{stream:!(te&&g==H-1)});T.length=0,this.h.g+=u,this.C=0,we=this.h.g}else we=this.g.oa();if(this.o=_==200,le(this.i,this.u,this.A,this.l,this.R,tn,_),this.o){if(this.T&&!this.K){t:{if(this.g){var It,fn=this.g;if((It=fn.g?fn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!ye(It)){var ht=It;break t}}ht=null}if(_=ht)$(this.i,this.l,_,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Qi(this,_);else{this.o=!1,this.s=3,_t(12),Jn(this),On(this);break e}}if(this.P){_=!0;let vr;for(;!this.J&&this.C<we.length;)if(vr=Ir(this,we),vr==Ur){tn==4&&(this.s=4,_t(14),_=!1),$(this.i,this.l,null,"[Incomplete Response]");break}else if(vr==Vn){this.s=4,_t(15),$(this.i,this.l,we,"[Invalid Chunk]"),_=!1;break}else $(this.i,this.l,vr,null),Qi(this,vr);if(Yn(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),tn!=4||we.length!=0||this.h.h||(this.s=1,_t(16),_=!1),this.o=this.o&&_,!_)$(this.i,this.l,we,"[Invalid Chunked Response]"),Jn(this),On(this);else if(0<we.length&&!this.W){this.W=!0;var _n=this.j;_n.g==this&&_n.ba&&!_n.M&&(_n.j.info("Great, no buffering proxy detected. Bytes received: "+we.length),Fo(_n),_n.M=!0,_t(11))}}else $(this.i,this.l,we,null),Qi(this,we);tn==4&&Jn(this),this.o&&!this.J&&(tn==4?Va(this.j,this):(this.o=!1,vt(this)))}else Na(this.g),_==400&&0<we.indexOf("Unknown SID")?(this.s=3,_t(12)):(this.s=0,_t(13)),Jn(this),On(this)}}}catch{}finally{}};function Yn(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function Ir(u,g){var _=u.C,T=g.indexOf(`
`,_);return T==-1?Ur:(_=Number(g.substring(_,T)),isNaN(_)?Vn:(T+=1,T+_>g.length?Ur:(g=g.slice(T,T+_),u.C=T+_,g)))}mt.prototype.cancel=function(){this.J=!0,Jn(this)};function vt(u){u.S=Date.now()+u.I,Ki(u,u.I)}function Ki(u,g){if(u.B!=null)throw Error("WatchDog timer not null");u.B=Yt(C(u.ba,u),g)}function Ns(u){u.B&&(f.clearTimeout(u.B),u.B=null)}mt.prototype.ba=function(){this.B=null;const u=Date.now();0<=u-this.S?(Y(this.i,this.A),this.L!=2&&(Qn(),_t(17)),Jn(this),this.s=2,On(this)):Ki(this,this.S-u)};function On(u){u.j.G==0||u.J||Va(u.j,u)}function Jn(u){Ns(u);var g=u.M;g&&typeof g.ma=="function"&&g.ma(),u.M=null,In(u.U),u.g&&(g=u.g,u.g=null,g.abort(),g.ma())}function Qi(u,g){try{var _=u.j;if(_.G!=0&&(_.g==u||W(_.h,u))){if(!u.K&&W(_.h,u)&&_.G==3){try{var T=_.Da.g.parse(g)}catch{T=null}if(Array.isArray(T)&&T.length==3){var H=T;if(H[0]==0){e:if(!_.u){if(_.g)if(_.g.F+3e3<u.F)La(_),Hr(_);else break e;Da(_),_t(18)}}else _.za=H[1],0<_.za-_.T&&37500>H[2]&&_.F&&_.v==0&&!_.C&&(_.C=Yt(C(_.Za,_),6e3));if(1>=B(_.h)&&_.ca){try{_.ca()}catch{}_.ca=void 0}}else Vs(_,11)}else if((u.K||_.g==u)&&La(_),!ye(g))for(H=_.Da.g.parse(g),g=0;g<H.length;g++){let ht=H[g];if(_.T=ht[0],ht=ht[1],_.G==2)if(ht[0]=="c"){_.K=ht[1],_.ia=ht[2];const _n=ht[3];_n!=null&&(_.la=_n,_.j.info("VER="+_.la));const tn=ht[4];tn!=null&&(_.Aa=tn,_.j.info("SVER="+_.Aa));const Pr=ht[5];Pr!=null&&typeof Pr=="number"&&0<Pr&&(T=1.5*Pr,_.L=T,_.j.info("backChannelRequestTimeoutMs_="+T)),T=_;const vr=u.g;if(vr){const Zi=vr.g?vr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Zi){var te=T.h;te.g||Zi.indexOf("spdy")==-1&&Zi.indexOf("quic")==-1&&Zi.indexOf("h2")==-1||(te.j=te.l,te.g=new Set,te.h&&(pe(te,te.h),te.h=null))}if(T.D){const Ma=vr.g?vr.g.getResponseHeader("X-HTTP-Session-Id"):null;Ma&&(T.ya=Ma,nt(T.I,T.D,Ma))}}_.G=3,_.l&&_.l.ua(),_.ba&&(_.R=Date.now()-u.F,_.j.info("Handshake RTT: "+_.R+"ms")),T=_;var we=u;if(T.qa=oc(T,T.J?T.ia:null,T.W),we.K){Pe(T.h,we);var It=we,fn=T.L;fn&&(It.I=fn),It.B&&(Ns(It),vt(It)),T.g=we}else Xi(T);0<_.i.length&&hs(_)}else ht[0]!="stop"&&ht[0]!="close"||Vs(_,7);else _.G==3&&(ht[0]=="stop"||ht[0]=="close"?ht[0]=="stop"?Vs(_,7):bn(_):ht[0]!="noop"&&_.l&&_.l.ta(ht),_.v=0)}}Qn(4)}catch{}}var Ca=class{constructor(u,g){this.g=u,this.map=g}};function ks(u){this.l=u||10,f.PerformanceNavigationTiming?(u=f.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(f.chrome&&f.chrome.loadTimes&&f.chrome.loadTimes()&&f.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function S(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function B(u){return u.h?1:u.g?u.g.size:0}function W(u,g){return u.h?u.h==g:u.g?u.g.has(g):!1}function pe(u,g){u.g?u.g.add(g):u.h=g}function Pe(u,g){u.h&&u.h==g?u.h=null:u.g&&u.g.has(g)&&u.g.delete(g)}ks.prototype.cancel=function(){if(this.i=Fe(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function Fe(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let g=u.i;for(const _ of u.g.values())g=g.concat(_.D);return g}return K(u.i)}function Ie(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(m(u)){for(var g=[],_=u.length,T=0;T<_;T++)g.push(u[T]);return g}g=[],_=0;for(T in u)g[_++]=u[T];return g}function et(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(m(u)||typeof u=="string"){var g=[];u=u.length;for(var _=0;_<u;_++)g.push(_);return g}g=[],_=0;for(const T in u)g[_++]=T;return g}}}function wt(u,g){if(u.forEach&&typeof u.forEach=="function")u.forEach(g,void 0);else if(m(u)||typeof u=="string")Array.prototype.forEach.call(u,g,void 0);else for(var _=et(u),T=Ie(u),H=T.length,te=0;te<H;te++)g.call(void 0,T[te],_&&_[te],u)}var xt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function hn(u,g){if(u){u=u.split("&");for(var _=0;_<u.length;_++){var T=u[_].indexOf("="),H=null;if(0<=T){var te=u[_].substring(0,T);H=u[_].substring(T+1)}else te=u[_];g(te,H?decodeURIComponent(H.replace(/\+/g," ")):"")}}}function Nt(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof Nt){this.h=u.h,$t(this,u.j),this.o=u.o,this.g=u.g,it(this,u.s),this.l=u.l;var g=u.i,_=new cs;_.i=g.i,g.g&&(_.g=new Map(g.g),_.h=g.h),Xn(this,_),this.m=u.m}else u&&(g=String(u).match(xt))?(this.h=!1,$t(this,g[1]||"",!0),this.o=rt(g[2]||""),this.g=rt(g[3]||"",!0),it(this,g[4]),this.l=rt(g[5]||"",!0),Xn(this,g[6]||"",!0),this.m=rt(g[7]||"")):(this.h=!1,this.i=new cs(null,this.h))}Nt.prototype.toString=function(){var u=[],g=this.j;g&&u.push(os(g,ri,!0),":");var _=this.g;return(_||g=="file")&&(u.push("//"),(g=this.o)&&u.push(os(g,ri,!0),"@"),u.push(encodeURIComponent(String(_)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_=this.s,_!=null&&u.push(":",String(_))),(_=this.l)&&(this.g&&_.charAt(0)!="/"&&u.push("/"),u.push(os(_,_.charAt(0)=="/"?ba:ls,!0))),(_=this.i.toString())&&u.push("?",_),(_=this.m)&&u.push("#",os(_,Do)),u.join("")};function Mt(u){return new Nt(u)}function $t(u,g,_){u.j=_?rt(g,!0):g,u.j&&(u.j=u.j.replace(/:$/,""))}function it(u,g){if(g){if(g=Number(g),isNaN(g)||0>g)throw Error("Bad port number "+g);u.s=g}else u.s=null}function Xn(u,g,_){g instanceof cs?(u.i=g,us(u.i,u.h)):(_||(g=os(g,ec)),u.i=new cs(g,u.h))}function nt(u,g,_){u.i.set(g,_)}function Mn(u){return nt(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function rt(u,g){return u?g?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function os(u,g,_){return typeof u=="string"?(u=encodeURI(u).replace(g,Pa),_&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function Pa(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var ri=/[#\/\?@]/g,ls=/[#\?:]/g,ba=/[#\?]/g,ec=/[#\?@]/g,Do=/#/g;function cs(u,g){this.h=this.g=null,this.i=u||null,this.j=!!g}function Pn(u){u.g||(u.g=new Map,u.h=0,u.i&&hn(u.i,function(g,_){u.add(decodeURIComponent(g.replace(/\+/g," ")),_)}))}n=cs.prototype,n.add=function(u,g){Pn(this),this.i=null,u=Cr(this,u);var _=this.g.get(u);return _||this.g.set(u,_=[]),_.push(g),this.h+=1,this};function zr(u,g){Pn(u),g=Cr(u,g),u.g.has(g)&&(u.i=null,u.h-=u.g.get(g).length,u.g.delete(g))}function Br(u,g){return Pn(u),g=Cr(u,g),u.g.has(g)}n.forEach=function(u,g){Pn(this),this.g.forEach(function(_,T){_.forEach(function(H){u.call(g,H,T,this)},this)},this)},n.na=function(){Pn(this);const u=Array.from(this.g.values()),g=Array.from(this.g.keys()),_=[];for(let T=0;T<g.length;T++){const H=u[T];for(let te=0;te<H.length;te++)_.push(g[T])}return _},n.V=function(u){Pn(this);let g=[];if(typeof u=="string")Br(this,u)&&(g=g.concat(this.g.get(Cr(this,u))));else{u=Array.from(this.g.values());for(let _=0;_<u.length;_++)g=g.concat(u[_])}return g},n.set=function(u,g){return Pn(this),this.i=null,u=Cr(this,u),Br(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[g]),this.h+=1,this},n.get=function(u,g){return u?(u=this.V(u),0<u.length?String(u[0]):g):g};function si(u,g,_){zr(u,g),0<_.length&&(u.i=null,u.g.set(Cr(u,g),K(_)),u.h+=_.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],g=Array.from(this.g.keys());for(var _=0;_<g.length;_++){var T=g[_];const te=encodeURIComponent(String(T)),we=this.V(T);for(T=0;T<we.length;T++){var H=te;we[T]!==""&&(H+="="+encodeURIComponent(String(we[T]))),u.push(H)}}return this.i=u.join("&")};function Cr(u,g){return g=String(g),u.j&&(g=g.toLowerCase()),g}function us(u,g){g&&!u.j&&(Pn(u),u.i=null,u.g.forEach(function(_,T){var H=T.toLowerCase();T!=H&&(zr(this,T),si(this,H,_))},u)),u.j=g}function fd(u,g){const _=new P;if(f.Image){const T=new Image;T.onload=U(rr,_,"TestLoadImage: loaded",!0,g,T),T.onerror=U(rr,_,"TestLoadImage: error",!1,g,T),T.onabort=U(rr,_,"TestLoadImage: abort",!1,g,T),T.ontimeout=U(rr,_,"TestLoadImage: timeout",!1,g,T),f.setTimeout(function(){T.ontimeout&&T.ontimeout()},1e4),T.src=u}else g(!1)}function tc(u,g){const _=new P,T=new AbortController,H=setTimeout(()=>{T.abort(),rr(_,"TestPingServer: timeout",!1,g)},1e4);fetch(u,{signal:T.signal}).then(te=>{clearTimeout(H),te.ok?rr(_,"TestPingServer: ok",!0,g):rr(_,"TestPingServer: server error",!1,g)}).catch(()=>{clearTimeout(H),rr(_,"TestPingServer: error",!1,g)})}function rr(u,g,_,T,H){try{H&&(H.onload=null,H.onerror=null,H.onabort=null,H.ontimeout=null),T(_)}catch{}}function pd(){this.g=new As}function nc(u,g,_){const T=_||"";try{wt(u,function(H,te){let we=H;v(H)&&(we=is(H)),g.push(T+te+"="+encodeURIComponent(we))})}catch(H){throw g.push(T+"type="+encodeURIComponent("_badmap")),H}}function js(u){this.l=u.Ub||null,this.j=u.eb||!1}G(js,cn),js.prototype.g=function(){return new Yi(this.l,this.j)},js.prototype.i=(function(u){return function(){return u}})({});function Yi(u,g){Bt.call(this),this.D=u,this.o=g,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}G(Yi,Bt),n=Yi.prototype,n.open=function(u,g){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=g,this.readyState=1,Wr(this)},n.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const g={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(g.body=u),(this.D||f).fetch(new Request(this.A,g)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,$r(this)),this.readyState=0},n.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,Wr(this)),this.g&&(this.readyState=3,Wr(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof f.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;rc(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function rc(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}n.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var g=u.value?u.value:new Uint8Array(0);(g=this.v.decode(g,{stream:!u.done}))&&(this.response=this.responseText+=g)}u.done?$r(this):Wr(this),this.readyState==3&&rc(this)}},n.Ra=function(u){this.g&&(this.response=this.responseText=u,$r(this))},n.Qa=function(u){this.g&&(this.response=u,$r(this))},n.ga=function(){this.g&&$r(this)};function $r(u){u.readyState=4,u.l=null,u.j=null,u.v=null,Wr(u)}n.setRequestHeader=function(u,g){this.u.append(u,g)},n.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],g=this.h.entries();for(var _=g.next();!_.done;)_=_.value,u.push(_[0]+": "+_[1]),_=g.next();return u.join(`\r
`)};function Wr(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(Yi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function Ds(u){let g="";return Se(u,function(_,T){g+=T,g+=":",g+=_,g+=`\r
`}),g}function ii(u,g,_){e:{for(T in _){var T=!1;break e}T=!0}T||(_=Ds(_),typeof u=="string"?_!=null&&encodeURIComponent(String(_)):nt(u,g,_))}function Ft(u){Bt.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}G(Ft,Bt);var md=/^https?$/i,Lo=["POST","PUT"];n=Ft.prototype,n.Ha=function(u){this.J=u},n.ea=function(u,g,_,T){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);g=g?g.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():xe.g(),this.v=this.o?ct(this.o):ct(xe),this.g.onreadystatechange=C(this.Ea,this);try{this.B=!0,this.g.open(g,String(u),!0),this.B=!1}catch(te){Ji(this,te);return}if(u=_||"",_=new Map(this.headers),T)if(Object.getPrototypeOf(T)===Object.prototype)for(var H in T)_.set(H,T[H]);else if(typeof T.keys=="function"&&typeof T.get=="function")for(const te of T.keys())_.set(te,T.get(te));else throw Error("Unknown input type for opt_headers: "+String(T));T=Array.from(_.keys()).find(te=>te.toLowerCase()=="content-type"),H=f.FormData&&u instanceof f.FormData,!(0<=Array.prototype.indexOf.call(Lo,g,void 0))||T||H||_.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[te,we]of _)this.g.setRequestHeader(te,we);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Aa(this),this.u=!0,this.g.send(u),this.u=!1}catch(te){Ji(this,te)}};function Ji(u,g){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=g,u.m=5,Ra(u),yr(u)}function Ra(u){u.A||(u.A=!0,Qe(u,"complete"),Qe(u,"error"))}n.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,Qe(this,"complete"),Qe(this,"abort"),yr(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),yr(this,!0)),Ft.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Vo(this):this.bb())},n.bb=function(){Vo(this)};function Vo(u){if(u.h&&typeof d<"u"&&(!u.v[1]||sr(u)!=4||u.Z()!=2)){if(u.u&&sr(u)==4)bs(u.Ea,0,u);else if(Qe(u,"readystatechange"),sr(u)==4){u.h=!1;try{const we=u.Z();e:switch(we){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var g=!0;break e;default:g=!1}var _;if(!(_=g)){var T;if(T=we===0){var H=String(u.D).match(xt)[1]||null;!H&&f.self&&f.self.location&&(H=f.self.location.protocol.slice(0,-1)),T=!md.test(H?H.toLowerCase():"")}_=T}if(_)Qe(u,"complete"),Qe(u,"success");else{u.m=6;try{var te=2<sr(u)?u.g.statusText:""}catch{te=""}u.l=te+" ["+u.Z()+"]",Ra(u)}}finally{yr(u)}}}}function yr(u,g){if(u.g){Aa(u);const _=u.g,T=u.v[0]?()=>{}:null;u.g=null,u.v=null,g||Qe(u,"ready");try{_.onreadystatechange=T}catch{}}}function Aa(u){u.I&&(f.clearTimeout(u.I),u.I=null)}n.isActive=function(){return!!this.g};function sr(u){return u.g?u.g.readyState:0}n.Z=function(){try{return 2<sr(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(u){if(this.g){var g=this.g.responseText;return u&&g.indexOf(u)==0&&(g=g.substring(u.length)),Rs(g)}};function Oo(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function Na(u){const g={};u=(u.g&&2<=sr(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let T=0;T<u.length;T++){if(ye(u[T]))continue;var _=F(u[T]);const H=_[0];if(_=_[1],typeof _!="string")continue;_=_.trim();const te=g[H]||[];g[H]=te,te.push(_)}b(g,function(T){return T.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ds(u,g,_){return _&&_.internalChannelParams&&_.internalChannelParams[u]||g}function Mo(u){this.Aa=0,this.i=[],this.j=new P,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ds("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ds("baseRetryDelayMs",5e3,u),this.cb=ds("retryDelaySeedMs",1e4,u),this.Wa=ds("forwardChannelMaxRetries",2,u),this.wa=ds("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new ks(u&&u.concurrentRequestLimit),this.Da=new pd,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Mo.prototype,n.la=8,n.G=1,n.connect=function(u,g,_,T){_t(0),this.W=u,this.H=g||{},_&&T!==void 0&&(this.H.OSID=_,this.H.OAID=T),this.F=this.X,this.I=oc(this,null,this.W),hs(this)};function bn(u){if(ka(u),u.G==3){var g=u.U++,_=Mt(u.I);if(nt(_,"SID",u.K),nt(_,"RID",g),nt(_,"TYPE","terminate"),Ls(u,_),g=new mt(u,u.j,g),g.L=2,g.v=Mn(Mt(_)),_=!1,f.navigator&&f.navigator.sendBeacon)try{_=f.navigator.sendBeacon(g.v.toString(),"")}catch{}!_&&f.Image&&(new Image().src=g.v,_=!0),_||(g.g=lc(g.j,null),g.g.ea(g.v)),g.F=Date.now(),vt(g)}ac(u)}function Hr(u){u.g&&(Fo(u),u.g.cancel(),u.g=null)}function ka(u){Hr(u),u.u&&(f.clearTimeout(u.u),u.u=null),La(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&f.clearTimeout(u.s),u.s=null)}function hs(u){if(!S(u.h)&&!u.s){u.s=!0;var g=u.Ga;Be||se(),L||(Be(),L=!0),ee.add(g,u),u.B=0}}function gd(u,g){return B(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=g.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=Yt(C(u.Ga,u,g),ic(u,u.B)),u.B++,!0)}n.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;const H=new mt(this,this.j,u);let te=this.o;if(this.S&&(te?(te=A(te),V(te,this.S)):te=this.S),this.m!==null||this.O||(H.H=te,te=null),this.P)e:{for(var g=0,_=0;_<this.i.length;_++){t:{var T=this.i[_];if("__data__"in T.map&&(T=T.map.__data__,typeof T=="string")){T=T.length;break t}T=void 0}if(T===void 0)break;if(g+=T,4096<g){g=_;break e}if(g===4096||_===this.i.length-1){g=_+1;break e}}g=1e3}else g=1e3;g=ai(this,H,g),_=Mt(this.I),nt(_,"RID",u),nt(_,"CVER",22),this.D&&nt(_,"X-HTTP-Session-Id",this.D),Ls(this,_),te&&(this.O?g="headers="+encodeURIComponent(String(Ds(te)))+"&"+g:this.m&&ii(_,this.m,te)),pe(this.h,H),this.Ua&&nt(_,"TYPE","init"),this.P?(nt(_,"$req",g),nt(_,"SID","null"),H.T=!0,gt(H,_,null)):gt(H,_,g),this.G=2}}else this.G==3&&(u?ja(this,u):this.i.length==0||S(this.h)||ja(this))};function ja(u,g){var _;g?_=g.l:_=u.U++;const T=Mt(u.I);nt(T,"SID",u.K),nt(T,"RID",_),nt(T,"AID",u.T),Ls(u,T),u.m&&u.o&&ii(T,u.m,u.o),_=new mt(u,u.j,_,u.B+1),u.m===null&&(_.H=u.o),g&&(u.i=g.D.concat(u.i)),g=ai(u,_,1e3),_.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),pe(u.h,_),gt(_,T,g)}function Ls(u,g){u.H&&Se(u.H,function(_,T){nt(g,T,_)}),u.l&&wt({},function(_,T){nt(g,T,_)})}function ai(u,g,_){_=Math.min(u.i.length,_);var T=u.l?C(u.l.Na,u.l,u):null;e:{var H=u.i;let te=-1;for(;;){const we=["count="+_];te==-1?0<_?(te=H[0].g,we.push("ofs="+te)):te=0:we.push("ofs="+te);let It=!0;for(let fn=0;fn<_;fn++){let ht=H[fn].g;const _n=H[fn].map;if(ht-=te,0>ht)te=Math.max(0,H[fn].g-100),It=!1;else try{nc(_n,we,"req"+ht+"_")}catch{T&&T(_n)}}if(It){T=we.join("&");break e}}}return u=u.i.splice(0,_),g.D=u,T}function Xi(u){if(!u.g&&!u.u){u.Y=1;var g=u.Fa;Be||se(),L||(Be(),L=!0),ee.add(g,u),u.v=0}}function Da(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=Yt(C(u.Fa,u),ic(u,u.v)),u.v++,!0)}n.Fa=function(){if(this.u=null,sc(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=Yt(C(this.ab,this),u)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,_t(10),Hr(this),sc(this))};function Fo(u){u.A!=null&&(f.clearTimeout(u.A),u.A=null)}function sc(u){u.g=new mt(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var g=Mt(u.qa);nt(g,"RID","rpc"),nt(g,"SID",u.K),nt(g,"AID",u.T),nt(g,"CI",u.F?"0":"1"),!u.F&&u.ja&&nt(g,"TO",u.ja),nt(g,"TYPE","xmlhttp"),Ls(u,g),u.m&&u.o&&ii(g,u.m,u.o),u.L&&(u.g.I=u.L);var _=u.g;u=u.ia,_.L=1,_.v=Mn(Mt(g)),_.m=null,_.P=!0,gr(_,u)}n.Za=function(){this.C!=null&&(this.C=null,Hr(this),Da(this),_t(19))};function La(u){u.C!=null&&(f.clearTimeout(u.C),u.C=null)}function Va(u,g){var _=null;if(u.g==g){La(u),Fo(u),u.g=null;var T=2}else if(W(u.h,g))_=g.D,Pe(u.h,g),T=1;else return;if(u.G!=0){if(g.o)if(T==1){_=g.m?g.m.length:0,g=Date.now()-g.F;var H=u.B;T=Sr(),Qe(T,new qt(T,_)),hs(u)}else Xi(u);else if(H=g.s,H==3||H==0&&0<g.X||!(T==1&&gd(u,g)||T==2&&Da(u)))switch(_&&0<_.length&&(g=u.h,g.i=g.i.concat(_)),H){case 1:Vs(u,5);break;case 4:Vs(u,10);break;case 3:Vs(u,6);break;default:Vs(u,2)}}}function ic(u,g){let _=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(_*=2),_*g}function Vs(u,g){if(u.j.info("Error code "+g),g==2){var _=C(u.fb,u),T=u.Xa;const H=!T;T=new Nt(T||"//www.google.com/images/cleardot.gif"),f.location&&f.location.protocol=="http"||$t(T,"https"),Mn(T),H?fd(T.toString(),_):tc(T.toString(),_)}else _t(2);u.G=0,u.l&&u.l.sa(g),ac(u),ka(u)}n.fb=function(u){u?(this.j.info("Successfully pinged google.com"),_t(2)):(this.j.info("Failed to ping google.com"),_t(1))};function ac(u){if(u.G=0,u.ka=[],u.l){const g=Fe(u.h);(g.length!=0||u.i.length!=0)&&(O(u.ka,g),O(u.ka,u.i),u.h.i.length=0,K(u.i),u.i.length=0),u.l.ra()}}function oc(u,g,_){var T=_ instanceof Nt?Mt(_):new Nt(_);if(T.g!="")g&&(T.g=g+"."+T.g),it(T,T.s);else{var H=f.location;T=H.protocol,g=g?g+"."+H.hostname:H.hostname,H=+H.port;var te=new Nt(null);T&&$t(te,T),g&&(te.g=g),H&&it(te,H),_&&(te.l=_),T=te}return _=u.D,g=u.ya,_&&g&&nt(T,_,g),nt(T,"VER",u.la),Ls(u,T),T}function lc(u,g,_){if(g&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return g=u.Ca&&!u.pa?new Ft(new js({eb:_})):new Ft(u.pa),g.Ha(u.J),g}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Uo(){}n=Uo.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Oa(){}Oa.prototype.g=function(u,g){return new Zn(u,g)};function Zn(u,g){Bt.call(this),this.g=new Mo(g),this.l=u,this.h=g&&g.messageUrlParams||null,u=g&&g.messageHeaders||null,g&&g.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=g&&g.initMessageHeaders||null,g&&g.messageContentType&&(u?u["X-WebChannel-Content-Type"]=g.messageContentType:u={"X-WebChannel-Content-Type":g.messageContentType}),g&&g.va&&(u?u["X-WebChannel-Client-Profile"]=g.va:u={"X-WebChannel-Client-Profile":g.va}),this.g.S=u,(u=g&&g.Sb)&&!ye(u)&&(this.g.m=u),this.v=g&&g.supportsCrossDomainXhr||!1,this.u=g&&g.sendRawJson||!1,(g=g&&g.httpSessionIdParam)&&!ye(g)&&(this.g.D=g,u=this.h,u!==null&&g in u&&(u=this.h,g in u&&delete u[g])),this.j=new fs(this)}G(Zn,Bt),Zn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Zn.prototype.close=function(){bn(this.g)},Zn.prototype.o=function(u){var g=this.g;if(typeof u=="string"){var _={};_.__data__=u,u=_}else this.u&&(_={},_.__data__=is(u),u=_);g.i.push(new Ca(g.Ya++,u)),g.G==3&&hs(g)},Zn.prototype.N=function(){this.g.l=null,delete this.j,bn(this.g),delete this.g,Zn.aa.N.call(this)};function cc(u){en.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var g=u.__sm__;if(g){e:{for(const _ in g){u=_;break e}u=void 0}(this.i=u)&&(u=this.i,g=g!==null&&u in g?g[u]:void 0),this.data=g}else this.data=u}G(cc,en);function uc(){un.call(this),this.status=1}G(uc,un);function fs(u){this.g=u}G(fs,Uo),fs.prototype.ua=function(){Qe(this.g,"a")},fs.prototype.ta=function(u){Qe(this.g,new cc(u))},fs.prototype.sa=function(u){Qe(this.g,new uc)},fs.prototype.ra=function(){Qe(this.g,"b")},Oa.prototype.createWebChannel=Oa.prototype.g,Zn.prototype.send=Zn.prototype.o,Zn.prototype.open=Zn.prototype.m,Zn.prototype.close=Zn.prototype.close,r0=function(){return new Oa},n0=function(){return Sr()},t0=dn,mf={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Oe.NO_ERROR=0,Oe.TIMEOUT=8,Oe.HTTP_ERROR=6,pu=Oe,Rt.COMPLETE="complete",e0=Rt,mr.EventType=Dn,Dn.OPEN="a",Dn.CLOSE="b",Dn.ERROR="c",Dn.MESSAGE="d",Bt.prototype.listen=Bt.prototype.K,gl=mr,Ft.prototype.listenOnce=Ft.prototype.L,Ft.prototype.getLastError=Ft.prototype.Ka,Ft.prototype.getLastErrorCode=Ft.prototype.Ba,Ft.prototype.getStatus=Ft.prototype.Z,Ft.prototype.getResponseJson=Ft.prototype.Oa,Ft.prototype.getResponseText=Ft.prototype.oa,Ft.prototype.send=Ft.prototype.ea,Ft.prototype.setWithCredentials=Ft.prototype.Ha,Z_=Ft}).apply(typeof iu<"u"?iu:typeof self<"u"?self:typeof window<"u"?window:{});const Dy="@firebase/firestore",Ly="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Wn.UNAUTHENTICATED=new Wn(null),Wn.GOOGLE_CREDENTIALS=new Wn("google-credentials-uid"),Wn.FIRST_PARTY=new Wn("first-party-uid"),Wn.MOCK_USER=new Wn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ro="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wa=new Mf("@firebase/firestore");function ao(){return wa.logLevel}function Re(n,...e){if(wa.logLevel<=ut.DEBUG){const t=e.map(Xf);wa.debug(`Firestore (${Ro}): ${n}`,...t)}}function ei(n,...e){if(wa.logLevel<=ut.ERROR){const t=e.map(Xf);wa.error(`Firestore (${Ro}): ${n}`,...t)}}function Li(n,...e){if(wa.logLevel<=ut.WARN){const t=e.map(Xf);wa.warn(`Firestore (${Ro}): ${n}`,...t)}}function Xf(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ge(n,e,t){let s="Unexpected state";typeof e=="string"?s=e:t=e,s0(n,s,t)}function s0(n,e,t){let s=`FIRESTORE (${Ro}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{s+=" CONTEXT: "+JSON.stringify(t)}catch{s+=" CONTEXT: "+t}throw ei(s),new Error(s)}function Et(n,e,t,s){let a="Unexpected state";typeof t=="string"?a=t:s=t,n||s0(e,a,s)}function Xe(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ce={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class De extends ni{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ys{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i0{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class eC{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Wn.UNAUTHENTICATED)))}shutdown(){}}class tC{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class nC{constructor(e){this.t=e,this.currentUser=Wn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Et(this.o===void 0,42304);let s=this.i;const a=m=>this.i!==s?(s=this.i,t(m)):Promise.resolve();let l=new Ys;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new Ys,e.enqueueRetryable((()=>a(this.currentUser)))};const d=()=>{const m=l;e.enqueueRetryable((async()=>{await m.promise,await a(this.currentUser)}))},f=m=>{Re("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=m,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit((m=>f(m))),setTimeout((()=>{if(!this.auth){const m=this.t.getImmediate({optional:!0});m?f(m):(Re("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new Ys)}}),0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((s=>this.i!==e?(Re("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(Et(typeof s.accessToken=="string",31837,{l:s}),new i0(s.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Et(e===null||typeof e=="string",2055,{h:e}),new Wn(e)}}class rC{constructor(e,t,s){this.P=e,this.T=t,this.I=s,this.type="FirstParty",this.user=Wn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class sC{constructor(e,t,s){this.P=e,this.T=t,this.I=s}getToken(){return Promise.resolve(new rC(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Wn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Vy{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class iC{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Er(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Et(this.o===void 0,3512);const s=l=>{l.error!=null&&Re("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const d=l.token!==this.m;return this.m=l.token,Re("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?t(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable((()=>s(l)))};const a=l=>{Re("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((l=>a(l))),setTimeout((()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?a(l):Re("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new Vy(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Et(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Vy(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aC(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let s=0;s<n;s++)t[s]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a0(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zf{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let s="";for(;s.length<20;){const a=aC(40);for(let l=0;l<a.length;++l)s.length<20&&a[l]<t&&(s+=e.charAt(a[l]%62))}return s}}function st(n,e){return n<e?-1:n>e?1:0}function gf(n,e){let t=0;for(;t<n.length&&t<e.length;){const s=n.codePointAt(t),a=e.codePointAt(t);if(s!==a){if(s<128&&a<128)return st(s,a);{const l=a0(),d=oC(l.encode(Oy(n,t)),l.encode(Oy(e,t)));return d!==0?d:st(s,a)}}t+=s>65535?2:1}return st(n.length,e.length)}function Oy(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function oC(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return st(n[t],e[t]);return st(n.length,e.length)}function vo(n,e,t){return n.length===e.length&&n.every(((s,a)=>t(s,e[a])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const My="__name__";class vs{constructor(e,t,s){t===void 0?t=0:t>e.length&&Ge(637,{offset:t,range:e.length}),s===void 0?s=e.length-t:s>e.length-t&&Ge(1746,{length:s,range:e.length-t}),this.segments=e,this.offset=t,this.len=s}get length(){return this.len}isEqual(e){return vs.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof vs?e.forEach((s=>{t.push(s)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,s=this.limit();t<s;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const s=Math.min(e.length,t.length);for(let a=0;a<s;a++){const l=vs.compareSegments(e.get(a),t.get(a));if(l!==0)return l}return st(e.length,t.length)}static compareSegments(e,t){const s=vs.isNumericId(e),a=vs.isNumericId(t);return s&&!a?-1:!s&&a?1:s&&a?vs.extractNumericId(e).compare(vs.extractNumericId(t)):gf(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ji.fromString(e.substring(4,e.length-2))}}class Vt extends vs{construct(e,t,s){return new Vt(e,t,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const s of e){if(s.indexOf("//")>=0)throw new De(ce.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);t.push(...s.split("/").filter((a=>a.length>0)))}return new Vt(t)}static emptyPath(){return new Vt([])}}const lC=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class kn extends vs{construct(e,t,s){return new kn(e,t,s)}static isValidIdentifier(e){return lC.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),kn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===My}static keyField(){return new kn([My])}static fromServerFormat(e){const t=[];let s="",a=0;const l=()=>{if(s.length===0)throw new De(ce.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(s),s=""};let d=!1;for(;a<e.length;){const f=e[a];if(f==="\\"){if(a+1===e.length)throw new De(ce.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const m=e[a+1];if(m!=="\\"&&m!=="."&&m!=="`")throw new De(ce.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=m,a+=2}else f==="`"?(d=!d,a++):f!=="."||d?(s+=f,a++):(l(),a++)}if(l(),d)throw new De(ce.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new kn(t)}static emptyPath(){return new kn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ze{constructor(e){this.path=e}static fromPath(e){return new ze(Vt.fromString(e))}static fromName(e){return new ze(Vt.fromString(e).popFirst(5))}static empty(){return new ze(Vt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Vt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Vt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ze(new Vt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o0(n,e,t){if(!t)throw new De(ce.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function cC(n,e,t,s){if(e===!0&&s===!0)throw new De(ce.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Fy(n){if(!ze.isDocumentKey(n))throw new De(ce.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Uy(n){if(ze.isDocumentKey(n))throw new De(ce.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function l0(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function ep(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(s){return s.constructor?s.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Ge(12329,{type:typeof n})}function rs(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new De(ce.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=ep(n);throw new De(ce.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sn(n,e){const t={typeString:n};return e&&(t.value=e),t}function Gl(n,e){if(!l0(n))throw new De(ce.INVALID_ARGUMENT,"JSON must be an object");let t;for(const s in e)if(e[s]){const a=e[s].typeString,l="value"in e[s]?{value:e[s].value}:void 0;if(!(s in n)){t=`JSON missing required field: '${s}'`;break}const d=n[s];if(a&&typeof d!==a){t=`JSON field '${s}' must be a ${a}.`;break}if(l!==void 0&&d!==l.value){t=`Expected '${s}' field to equal '${l.value}'`;break}}if(t)throw new De(ce.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zy=-62135596800,By=1e6;class Ot{static now(){return Ot.fromMillis(Date.now())}static fromDate(e){return Ot.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),s=Math.floor((e-1e3*t)*By);return new Ot(t,s)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new De(ce.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new De(ce.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<zy)throw new De(ce.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new De(ce.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/By}_compareTo(e){return this.seconds===e.seconds?st(this.nanoseconds,e.nanoseconds):st(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Ot._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Gl(e,Ot._jsonSchema))return new Ot(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-zy;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Ot._jsonSchemaVersion="firestore/timestamp/1.0",Ot._jsonSchema={type:sn("string",Ot._jsonSchemaVersion),seconds:sn("number"),nanoseconds:sn("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Je{static fromTimestamp(e){return new Je(e)}static min(){return new Je(new Ot(0,0))}static max(){return new Je(new Ot(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jl=-1;function uC(n,e){const t=n.toTimestamp().seconds,s=n.toTimestamp().nanoseconds+1,a=Je.fromTimestamp(s===1e9?new Ot(t+1,0):new Ot(t,s));return new Vi(a,ze.empty(),e)}function dC(n){return new Vi(n.readTime,n.key,jl)}class Vi{constructor(e,t,s){this.readTime=e,this.documentKey=t,this.largestBatchId=s}static min(){return new Vi(Je.min(),ze.empty(),jl)}static max(){return new Vi(Je.max(),ze.empty(),jl)}}function hC(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=ze.comparator(n.documentKey,e.documentKey),t!==0?t:st(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fC="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class pC{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ao(n){if(n.code!==ce.FAILED_PRECONDITION||n.message!==fC)throw n;Re("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ae{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ge(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ae(((s,a)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(s,a)},this.catchCallback=l=>{this.wrapFailure(t,l).next(s,a)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof ae?t:ae.resolve(t)}catch(t){return ae.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):ae.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):ae.reject(t)}static resolve(e){return new ae(((t,s)=>{t(e)}))}static reject(e){return new ae(((t,s)=>{s(e)}))}static waitFor(e){return new ae(((t,s)=>{let a=0,l=0,d=!1;e.forEach((f=>{++a,f.next((()=>{++l,d&&l===a&&t()}),(m=>s(m)))})),d=!0,l===a&&t()}))}static or(e){let t=ae.resolve(!1);for(const s of e)t=t.next((a=>a?ae.resolve(a):s()));return t}static forEach(e,t){const s=[];return e.forEach(((a,l)=>{s.push(t.call(this,a,l))})),this.waitFor(s)}static mapArray(e,t){return new ae(((s,a)=>{const l=e.length,d=new Array(l);let f=0;for(let m=0;m<l;m++){const v=m;t(e[v]).next((w=>{d[v]=w,++f,f===l&&s(d)}),(w=>a(w)))}}))}static doWhile(e,t){return new ae(((s,a)=>{const l=()=>{e()===!0?t().next((()=>{l()}),a):s()};l()}))}}function mC(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function No(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ku{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=s=>this._e(s),this.ae=s=>t.writeSequenceNumber(s))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}}Ku.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tp=-1;function Qu(n){return n==null}function Ru(n){return n===0&&1/n==-1/0}function gC(n){return typeof n=="number"&&Number.isInteger(n)&&!Ru(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c0="";function yC(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=$y(e)),e=vC(n.get(t),e);return $y(e)}function vC(n,e){let t=e;const s=n.length;for(let a=0;a<s;a++){const l=n.charAt(a);switch(l){case"\0":t+="";break;case c0:t+="";break;default:t+=l}}return t}function $y(n){return n+c0+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wy(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Gi(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function u0(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gt{constructor(e,t){this.comparator=e,this.root=t||Nn.EMPTY}insert(e,t){return new Gt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Nn.BLACK,null,null))}remove(e){return new Gt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Nn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const s=this.comparator(e,t.key);if(s===0)return t.value;s<0?t=t.left:s>0&&(t=t.right)}return null}indexOf(e){let t=0,s=this.root;for(;!s.isEmpty();){const a=this.comparator(e,s.key);if(a===0)return t+s.left.size;a<0?s=s.left:(t+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,s)=>(e(t,s),!1)))}toString(){const e=[];return this.inorderTraversal(((t,s)=>(e.push(`${t}:${s}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new au(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new au(this.root,e,this.comparator,!1)}getReverseIterator(){return new au(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new au(this.root,e,this.comparator,!0)}}class au{constructor(e,t,s,a){this.isReverse=a,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=t?s(e.key,t):1,t&&a&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Nn{constructor(e,t,s,a,l){this.key=e,this.value=t,this.color=s??Nn.RED,this.left=a??Nn.EMPTY,this.right=l??Nn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,s,a,l){return new Nn(e??this.key,t??this.value,s??this.color,a??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,s){let a=this;const l=s(e,a.key);return a=l<0?a.copy(null,null,null,a.left.insert(e,t,s),null):l===0?a.copy(null,t,null,null,null):a.copy(null,null,null,null,a.right.insert(e,t,s)),a.fixUp()}removeMin(){if(this.left.isEmpty())return Nn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let s,a=this;if(t(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,t),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),t(e,a.key)===0){if(a.right.isEmpty())return Nn.EMPTY;s=a.right.min(),a=a.copy(s.key,s.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,t))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Nn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Nn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ge(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ge(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ge(27949);return e+(this.isRed()?0:1)}}Nn.EMPTY=null,Nn.RED=!0,Nn.BLACK=!1;Nn.EMPTY=new class{constructor(){this.size=0}get key(){throw Ge(57766)}get value(){throw Ge(16141)}get color(){throw Ge(16727)}get left(){throw Ge(29726)}get right(){throw Ge(36894)}copy(e,t,s,a,l){return this}insert(e,t,s){return new Nn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yn{constructor(e){this.comparator=e,this.data=new Gt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,s)=>(e(t),!1)))}forEachInRange(e,t){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const a=s.getNext();if(this.comparator(a.key,e[1])>=0)return;t(a.key)}}forEachWhile(e,t){let s;for(s=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Hy(this.data.getIterator())}getIteratorFrom(e){return new Hy(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((s=>{t=t.add(s)})),t}isEqual(e){if(!(e instanceof yn)||this.size!==e.size)return!1;const t=this.data.getIterator(),s=e.data.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=s.getNext().key;if(this.comparator(a,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new yn(this.comparator);return t.data=e,t}}class Hy{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tr{constructor(e){this.fields=e,e.sort(kn.comparator)}static empty(){return new Tr([])}unionWith(e){let t=new yn(kn.comparator);for(const s of this.fields)t=t.add(s);for(const s of e)t=t.add(s);return new Tr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return vo(this.fields,e.fields,((t,s)=>t.isEqual(s)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d0 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(a){try{return atob(a)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new d0("Invalid base64 string: "+l):l}})(e);return new jn(t)}static fromUint8Array(e){const t=(function(a){let l="";for(let d=0;d<a.length;++d)l+=String.fromCharCode(a[d]);return l})(e);return new jn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const s=new Uint8Array(t.length);for(let a=0;a<t.length;a++)s[a]=t.charCodeAt(a);return s})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return st(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}jn.EMPTY_BYTE_STRING=new jn("");const _C=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Oi(n){if(Et(!!n,39018),typeof n=="string"){let e=0;const t=_C.exec(n);if(Et(!!t,46558,{timestamp:n}),t[1]){let a=t[1];a=(a+"000000000").substr(0,9),e=Number(a)}const s=new Date(n);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:Xt(n.seconds),nanos:Xt(n.nanos)}}function Xt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Mi(n){return typeof n=="string"?jn.fromBase64String(n):jn.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h0="server_timestamp",f0="__type__",p0="__previous_value__",m0="__local_write_time__";function np(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[f0])===null||t===void 0?void 0:t.stringValue)===h0}function Yu(n){const e=n.mapValue.fields[p0];return np(e)?Yu(e):e}function Dl(n){const e=Oi(n.mapValue.fields[m0].timestampValue);return new Ot(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wC{constructor(e,t,s,a,l,d,f,m,v,w){this.databaseId=e,this.appId=t,this.persistenceKey=s,this.host=a,this.ssl=l,this.forceLongPolling=d,this.autoDetectLongPolling=f,this.longPollingOptions=m,this.useFetchStreams=v,this.isUsingEmulator=w}}const Au="(default)";class Ll{constructor(e,t){this.projectId=e,this.database=t||Au}static empty(){return new Ll("","")}get isDefaultDatabase(){return this.database===Au}isEqual(e){return e instanceof Ll&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g0="__type__",xC="__max__",ou={mapValue:{}},y0="__vector__",Nu="value";function Fi(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?np(n)?4:TC(n)?9007199254740991:EC(n)?10:11:Ge(28295,{value:n})}function Is(n,e){if(n===e)return!0;const t=Fi(n);if(t!==Fi(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Dl(n).isEqual(Dl(e));case 3:return(function(a,l){if(typeof a.timestampValue=="string"&&typeof l.timestampValue=="string"&&a.timestampValue.length===l.timestampValue.length)return a.timestampValue===l.timestampValue;const d=Oi(a.timestampValue),f=Oi(l.timestampValue);return d.seconds===f.seconds&&d.nanos===f.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(a,l){return Mi(a.bytesValue).isEqual(Mi(l.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(a,l){return Xt(a.geoPointValue.latitude)===Xt(l.geoPointValue.latitude)&&Xt(a.geoPointValue.longitude)===Xt(l.geoPointValue.longitude)})(n,e);case 2:return(function(a,l){if("integerValue"in a&&"integerValue"in l)return Xt(a.integerValue)===Xt(l.integerValue);if("doubleValue"in a&&"doubleValue"in l){const d=Xt(a.doubleValue),f=Xt(l.doubleValue);return d===f?Ru(d)===Ru(f):isNaN(d)&&isNaN(f)}return!1})(n,e);case 9:return vo(n.arrayValue.values||[],e.arrayValue.values||[],Is);case 10:case 11:return(function(a,l){const d=a.mapValue.fields||{},f=l.mapValue.fields||{};if(Wy(d)!==Wy(f))return!1;for(const m in d)if(d.hasOwnProperty(m)&&(f[m]===void 0||!Is(d[m],f[m])))return!1;return!0})(n,e);default:return Ge(52216,{left:n})}}function Vl(n,e){return(n.values||[]).find((t=>Is(t,e)))!==void 0}function _o(n,e){if(n===e)return 0;const t=Fi(n),s=Fi(e);if(t!==s)return st(t,s);switch(t){case 0:case 9007199254740991:return 0;case 1:return st(n.booleanValue,e.booleanValue);case 2:return(function(l,d){const f=Xt(l.integerValue||l.doubleValue),m=Xt(d.integerValue||d.doubleValue);return f<m?-1:f>m?1:f===m?0:isNaN(f)?isNaN(m)?0:-1:1})(n,e);case 3:return Gy(n.timestampValue,e.timestampValue);case 4:return Gy(Dl(n),Dl(e));case 5:return gf(n.stringValue,e.stringValue);case 6:return(function(l,d){const f=Mi(l),m=Mi(d);return f.compareTo(m)})(n.bytesValue,e.bytesValue);case 7:return(function(l,d){const f=l.split("/"),m=d.split("/");for(let v=0;v<f.length&&v<m.length;v++){const w=st(f[v],m[v]);if(w!==0)return w}return st(f.length,m.length)})(n.referenceValue,e.referenceValue);case 8:return(function(l,d){const f=st(Xt(l.latitude),Xt(d.latitude));return f!==0?f:st(Xt(l.longitude),Xt(d.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return qy(n.arrayValue,e.arrayValue);case 10:return(function(l,d){var f,m,v,w;const E=l.fields||{},C=d.fields||{},U=(f=E[Nu])===null||f===void 0?void 0:f.arrayValue,G=(m=C[Nu])===null||m===void 0?void 0:m.arrayValue,K=st(((v=U==null?void 0:U.values)===null||v===void 0?void 0:v.length)||0,((w=G==null?void 0:G.values)===null||w===void 0?void 0:w.length)||0);return K!==0?K:qy(U,G)})(n.mapValue,e.mapValue);case 11:return(function(l,d){if(l===ou.mapValue&&d===ou.mapValue)return 0;if(l===ou.mapValue)return 1;if(d===ou.mapValue)return-1;const f=l.fields||{},m=Object.keys(f),v=d.fields||{},w=Object.keys(v);m.sort(),w.sort();for(let E=0;E<m.length&&E<w.length;++E){const C=gf(m[E],w[E]);if(C!==0)return C;const U=_o(f[m[E]],v[w[E]]);if(U!==0)return U}return st(m.length,w.length)})(n.mapValue,e.mapValue);default:throw Ge(23264,{le:t})}}function Gy(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return st(n,e);const t=Oi(n),s=Oi(e),a=st(t.seconds,s.seconds);return a!==0?a:st(t.nanos,s.nanos)}function qy(n,e){const t=n.values||[],s=e.values||[];for(let a=0;a<t.length&&a<s.length;++a){const l=_o(t[a],s[a]);if(l)return l}return st(t.length,s.length)}function wo(n){return yf(n)}function yf(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const s=Oi(t);return`time(${s.seconds},${s.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Mi(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return ze.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let s="[",a=!0;for(const l of t.values||[])a?a=!1:s+=",",s+=yf(l);return s+"]"})(n.arrayValue):"mapValue"in n?(function(t){const s=Object.keys(t.fields||{}).sort();let a="{",l=!0;for(const d of s)l?l=!1:a+=",",a+=`${d}:${yf(t.fields[d])}`;return a+"}"})(n.mapValue):Ge(61005,{value:n})}function mu(n){switch(Fi(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Yu(n);return e?16+mu(e):16;case 5:return 2*n.stringValue.length;case 6:return Mi(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(s){return(s.values||[]).reduce(((a,l)=>a+mu(l)),0)})(n.arrayValue);case 10:case 11:return(function(s){let a=0;return Gi(s.fields,((l,d)=>{a+=l.length+mu(d)})),a})(n.mapValue);default:throw Ge(13486,{value:n})}}function vf(n){return!!n&&"integerValue"in n}function rp(n){return!!n&&"arrayValue"in n}function Ky(n){return!!n&&"nullValue"in n}function Qy(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function gu(n){return!!n&&"mapValue"in n}function EC(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[g0])===null||t===void 0?void 0:t.stringValue)===y0}function Sl(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Gi(n.mapValue.fields,((t,s)=>e.mapValue.fields[t]=Sl(s))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Sl(n.arrayValue.values[t]);return e}return Object.assign({},n)}function TC(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===xC}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hr{constructor(e){this.value=e}static empty(){return new hr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let s=0;s<e.length-1;++s)if(t=(t.mapValue.fields||{})[e.get(s)],!gu(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Sl(t)}setAll(e){let t=kn.emptyPath(),s={},a=[];e.forEach(((d,f)=>{if(!t.isImmediateParentOf(f)){const m=this.getFieldsMap(t);this.applyChanges(m,s,a),s={},a=[],t=f.popLast()}d?s[f.lastSegment()]=Sl(d):a.push(f.lastSegment())}));const l=this.getFieldsMap(t);this.applyChanges(l,s,a)}delete(e){const t=this.field(e.popLast());gu(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Is(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let s=0;s<e.length;++s){let a=t.mapValue.fields[e.get(s)];gu(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},t.mapValue.fields[e.get(s)]=a),t=a}return t.mapValue.fields}applyChanges(e,t,s){Gi(t,((a,l)=>e[a]=l));for(const a of s)delete e[a]}clone(){return new hr(Sl(this.value))}}function v0(n){const e=[];return Gi(n.fields,((t,s)=>{const a=new kn([t]);if(gu(s)){const l=v0(s.mapValue).fields;if(l.length===0)e.push(a);else for(const d of l)e.push(a.child(d))}else e.push(a)})),new Tr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gn{constructor(e,t,s,a,l,d,f){this.key=e,this.documentType=t,this.version=s,this.readTime=a,this.createTime=l,this.data=d,this.documentState=f}static newInvalidDocument(e){return new Gn(e,0,Je.min(),Je.min(),Je.min(),hr.empty(),0)}static newFoundDocument(e,t,s,a){return new Gn(e,1,t,Je.min(),s,a,0)}static newNoDocument(e,t){return new Gn(e,2,t,Je.min(),Je.min(),hr.empty(),0)}static newUnknownDocument(e,t){return new Gn(e,3,t,Je.min(),Je.min(),hr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Je.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=hr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=hr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Je.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Gn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Gn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ku{constructor(e,t){this.position=e,this.inclusive=t}}function Yy(n,e,t){let s=0;for(let a=0;a<n.position.length;a++){const l=e[a],d=n.position[a];if(l.field.isKeyField()?s=ze.comparator(ze.fromName(d.referenceValue),t.key):s=_o(d,t.data.field(l.field)),l.dir==="desc"&&(s*=-1),s!==0)break}return s}function Jy(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Is(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ju{constructor(e,t="asc"){this.field=e,this.dir=t}}function SC(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _0{}class gn extends _0{constructor(e,t,s){super(),this.field=e,this.op=t,this.value=s}static create(e,t,s){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,s):new CC(e,t,s):t==="array-contains"?new RC(e,s):t==="in"?new AC(e,s):t==="not-in"?new NC(e,s):t==="array-contains-any"?new kC(e,s):new gn(e,t,s)}static createKeyFieldInFilter(e,t,s){return t==="in"?new PC(e,s):new bC(e,s)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(_o(t,this.value)):t!==null&&Fi(this.value)===Fi(t)&&this.matchesComparison(_o(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ge(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Cs extends _0{constructor(e,t){super(),this.filters=e,this.op=t,this.he=null}static create(e,t){return new Cs(e,t)}matches(e){return w0(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function w0(n){return n.op==="and"}function x0(n){return IC(n)&&w0(n)}function IC(n){for(const e of n.filters)if(e instanceof Cs)return!1;return!0}function _f(n){if(n instanceof gn)return n.field.canonicalString()+n.op.toString()+wo(n.value);if(x0(n))return n.filters.map((e=>_f(e))).join(",");{const e=n.filters.map((t=>_f(t))).join(",");return`${n.op}(${e})`}}function E0(n,e){return n instanceof gn?(function(s,a){return a instanceof gn&&s.op===a.op&&s.field.isEqual(a.field)&&Is(s.value,a.value)})(n,e):n instanceof Cs?(function(s,a){return a instanceof Cs&&s.op===a.op&&s.filters.length===a.filters.length?s.filters.reduce(((l,d,f)=>l&&E0(d,a.filters[f])),!0):!1})(n,e):void Ge(19439)}function T0(n){return n instanceof gn?(function(t){return`${t.field.canonicalString()} ${t.op} ${wo(t.value)}`})(n):n instanceof Cs?(function(t){return t.op.toString()+" {"+t.getFilters().map(T0).join(" ,")+"}"})(n):"Filter"}class CC extends gn{constructor(e,t,s){super(e,t,s),this.key=ze.fromName(s.referenceValue)}matches(e){const t=ze.comparator(e.key,this.key);return this.matchesComparison(t)}}class PC extends gn{constructor(e,t){super(e,"in",t),this.keys=S0("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class bC extends gn{constructor(e,t){super(e,"not-in",t),this.keys=S0("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function S0(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map((s=>ze.fromName(s.referenceValue)))}class RC extends gn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return rp(t)&&Vl(t.arrayValue,this.value)}}class AC extends gn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Vl(this.value.arrayValue,t)}}class NC extends gn{constructor(e,t){super(e,"not-in",t)}matches(e){if(Vl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Vl(this.value.arrayValue,t)}}class kC extends gn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!rp(t)||!t.arrayValue.values)&&t.arrayValue.values.some((s=>Vl(this.value.arrayValue,s)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jC{constructor(e,t=null,s=[],a=[],l=null,d=null,f=null){this.path=e,this.collectionGroup=t,this.orderBy=s,this.filters=a,this.limit=l,this.startAt=d,this.endAt=f,this.Pe=null}}function Xy(n,e=null,t=[],s=[],a=null,l=null,d=null){return new jC(n,e,t,s,a,l,d)}function sp(n){const e=Xe(n);if(e.Pe===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((s=>_f(s))).join(","),t+="|ob:",t+=e.orderBy.map((s=>(function(l){return l.field.canonicalString()+l.dir})(s))).join(","),Qu(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((s=>wo(s))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((s=>wo(s))).join(",")),e.Pe=t}return e.Pe}function ip(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!SC(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!E0(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Jy(n.startAt,e.startAt)&&Jy(n.endAt,e.endAt)}function wf(n){return ze.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ju{constructor(e,t=null,s=[],a=[],l=null,d="F",f=null,m=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=s,this.filters=a,this.limit=l,this.limitType=d,this.startAt=f,this.endAt=m,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function DC(n,e,t,s,a,l,d,f){return new Ju(n,e,t,s,a,l,d,f)}function ap(n){return new Ju(n)}function Zy(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function LC(n){return n.collectionGroup!==null}function Il(n){const e=Xe(n);if(e.Te===null){e.Te=[];const t=new Set;for(const l of e.explicitOrderBy)e.Te.push(l),t.add(l.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let f=new yn(kn.comparator);return d.filters.forEach((m=>{m.getFlattenedFilters().forEach((v=>{v.isInequality()&&(f=f.add(v.field))}))})),f})(e).forEach((l=>{t.has(l.canonicalString())||l.isKeyField()||e.Te.push(new ju(l,s))})),t.has(kn.keyField().canonicalString())||e.Te.push(new ju(kn.keyField(),s))}return e.Te}function xs(n){const e=Xe(n);return e.Ie||(e.Ie=VC(e,Il(n))),e.Ie}function VC(n,e){if(n.limitType==="F")return Xy(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((a=>{const l=a.dir==="desc"?"asc":"desc";return new ju(a.field,l)}));const t=n.endAt?new ku(n.endAt.position,n.endAt.inclusive):null,s=n.startAt?new ku(n.startAt.position,n.startAt.inclusive):null;return Xy(n.path,n.collectionGroup,e,n.filters,n.limit,t,s)}}function xf(n,e,t){return new Ju(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Xu(n,e){return ip(xs(n),xs(e))&&n.limitType===e.limitType}function I0(n){return`${sp(xs(n))}|lt:${n.limitType}`}function oo(n){return`Query(target=${(function(t){let s=t.path.canonicalString();return t.collectionGroup!==null&&(s+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(s+=`, filters: [${t.filters.map((a=>T0(a))).join(", ")}]`),Qu(t.limit)||(s+=", limit: "+t.limit),t.orderBy.length>0&&(s+=`, orderBy: [${t.orderBy.map((a=>(function(d){return`${d.field.canonicalString()} (${d.dir})`})(a))).join(", ")}]`),t.startAt&&(s+=", startAt: ",s+=t.startAt.inclusive?"b:":"a:",s+=t.startAt.position.map((a=>wo(a))).join(",")),t.endAt&&(s+=", endAt: ",s+=t.endAt.inclusive?"a:":"b:",s+=t.endAt.position.map((a=>wo(a))).join(",")),`Target(${s})`})(xs(n))}; limitType=${n.limitType})`}function Zu(n,e){return e.isFoundDocument()&&(function(s,a){const l=a.key.path;return s.collectionGroup!==null?a.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(l):ze.isDocumentKey(s.path)?s.path.isEqual(l):s.path.isImmediateParentOf(l)})(n,e)&&(function(s,a){for(const l of Il(s))if(!l.field.isKeyField()&&a.data.field(l.field)===null)return!1;return!0})(n,e)&&(function(s,a){for(const l of s.filters)if(!l.matches(a))return!1;return!0})(n,e)&&(function(s,a){return!(s.startAt&&!(function(d,f,m){const v=Yy(d,f,m);return d.inclusive?v<=0:v<0})(s.startAt,Il(s),a)||s.endAt&&!(function(d,f,m){const v=Yy(d,f,m);return d.inclusive?v>=0:v>0})(s.endAt,Il(s),a))})(n,e)}function OC(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function C0(n){return(e,t)=>{let s=!1;for(const a of Il(n)){const l=MC(a,e,t);if(l!==0)return l;s=s||a.field.isKeyField()}return 0}}function MC(n,e,t){const s=n.field.isKeyField()?ze.comparator(e.key,t.key):(function(l,d,f){const m=d.data.field(l),v=f.data.field(l);return m!==null&&v!==null?_o(m,v):Ge(42886)})(n.field,e,t);switch(n.dir){case"asc":return s;case"desc":return-1*s;default:return Ge(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ta{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s!==void 0){for(const[a,l]of s)if(this.equalsFn(a,e))return l}}has(e){return this.get(e)!==void 0}set(e,t){const s=this.mapKeyFn(e),a=this.inner[s];if(a===void 0)return this.inner[s]=[[e,t]],void this.innerSize++;for(let l=0;l<a.length;l++)if(this.equalsFn(a[l][0],e))return void(a[l]=[e,t]);a.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s===void 0)return!1;for(let a=0;a<s.length;a++)if(this.equalsFn(s[a][0],e))return s.length===1?delete this.inner[t]:s.splice(a,1),this.innerSize--,!0;return!1}forEach(e){Gi(this.inner,((t,s)=>{for(const[a,l]of s)e(a,l)}))}isEmpty(){return u0(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FC=new Gt(ze.comparator);function ti(){return FC}const P0=new Gt(ze.comparator);function yl(...n){let e=P0;for(const t of n)e=e.insert(t.key,t);return e}function b0(n){let e=P0;return n.forEach(((t,s)=>e=e.insert(t,s.overlayedDocument))),e}function ma(){return Cl()}function R0(){return Cl()}function Cl(){return new Ta((n=>n.toString()),((n,e)=>n.isEqual(e)))}const UC=new Gt(ze.comparator),zC=new yn(ze.comparator);function dt(...n){let e=zC;for(const t of n)e=e.add(t);return e}const BC=new yn(st);function $C(){return BC}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function op(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ru(e)?"-0":e}}function A0(n){return{integerValue:""+n}}function WC(n,e){return gC(e)?A0(e):op(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ed{constructor(){this._=void 0}}function HC(n,e,t){return n instanceof Ol?(function(a,l){const d={fields:{[f0]:{stringValue:h0},[m0]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return l&&np(l)&&(l=Yu(l)),l&&(d.fields[p0]=l),{mapValue:d}})(t,e):n instanceof Ml?k0(n,e):n instanceof Fl?j0(n,e):(function(a,l){const d=N0(a,l),f=ev(d)+ev(a.Ee);return vf(d)&&vf(a.Ee)?A0(f):op(a.serializer,f)})(n,e)}function GC(n,e,t){return n instanceof Ml?k0(n,e):n instanceof Fl?j0(n,e):t}function N0(n,e){return n instanceof Du?(function(s){return vf(s)||(function(l){return!!l&&"doubleValue"in l})(s)})(e)?e:{integerValue:0}:null}class Ol extends ed{}class Ml extends ed{constructor(e){super(),this.elements=e}}function k0(n,e){const t=D0(e);for(const s of n.elements)t.some((a=>Is(a,s)))||t.push(s);return{arrayValue:{values:t}}}class Fl extends ed{constructor(e){super(),this.elements=e}}function j0(n,e){let t=D0(e);for(const s of n.elements)t=t.filter((a=>!Is(a,s)));return{arrayValue:{values:t}}}class Du extends ed{constructor(e,t){super(),this.serializer=e,this.Ee=t}}function ev(n){return Xt(n.integerValue||n.doubleValue)}function D0(n){return rp(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qC{constructor(e,t){this.field=e,this.transform=t}}function KC(n,e){return n.field.isEqual(e.field)&&(function(s,a){return s instanceof Ml&&a instanceof Ml||s instanceof Fl&&a instanceof Fl?vo(s.elements,a.elements,Is):s instanceof Du&&a instanceof Du?Is(s.Ee,a.Ee):s instanceof Ol&&a instanceof Ol})(n.transform,e.transform)}class QC{constructor(e,t){this.version=e,this.transformResults=t}}class Vr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Vr}static exists(e){return new Vr(void 0,e)}static updateTime(e){return new Vr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function yu(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class td{}function L0(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new lp(n.key,Vr.none()):new ql(n.key,n.data,Vr.none());{const t=n.data,s=hr.empty();let a=new yn(kn.comparator);for(let l of e.fields)if(!a.has(l)){let d=t.field(l);d===null&&l.length>1&&(l=l.popLast(),d=t.field(l)),d===null?s.delete(l):s.set(l,d),a=a.add(l)}return new qi(n.key,s,new Tr(a.toArray()),Vr.none())}}function YC(n,e,t){n instanceof ql?(function(a,l,d){const f=a.value.clone(),m=nv(a.fieldTransforms,l,d.transformResults);f.setAll(m),l.convertToFoundDocument(d.version,f).setHasCommittedMutations()})(n,e,t):n instanceof qi?(function(a,l,d){if(!yu(a.precondition,l))return void l.convertToUnknownDocument(d.version);const f=nv(a.fieldTransforms,l,d.transformResults),m=l.data;m.setAll(V0(a)),m.setAll(f),l.convertToFoundDocument(d.version,m).setHasCommittedMutations()})(n,e,t):(function(a,l,d){l.convertToNoDocument(d.version).setHasCommittedMutations()})(0,e,t)}function Pl(n,e,t,s){return n instanceof ql?(function(l,d,f,m){if(!yu(l.precondition,d))return f;const v=l.value.clone(),w=rv(l.fieldTransforms,m,d);return v.setAll(w),d.convertToFoundDocument(d.version,v).setHasLocalMutations(),null})(n,e,t,s):n instanceof qi?(function(l,d,f,m){if(!yu(l.precondition,d))return f;const v=rv(l.fieldTransforms,m,d),w=d.data;return w.setAll(V0(l)),w.setAll(v),d.convertToFoundDocument(d.version,w).setHasLocalMutations(),f===null?null:f.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((E=>E.field)))})(n,e,t,s):(function(l,d,f){return yu(l.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):f})(n,e,t)}function JC(n,e){let t=null;for(const s of n.fieldTransforms){const a=e.data.field(s.field),l=N0(s.transform,a||null);l!=null&&(t===null&&(t=hr.empty()),t.set(s.field,l))}return t||null}function tv(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(s,a){return s===void 0&&a===void 0||!(!s||!a)&&vo(s,a,((l,d)=>KC(l,d)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class ql extends td{constructor(e,t,s,a=[]){super(),this.key=e,this.value=t,this.precondition=s,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class qi extends td{constructor(e,t,s,a,l=[]){super(),this.key=e,this.data=t,this.fieldMask=s,this.precondition=a,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function V0(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const s=n.data.field(t);e.set(t,s)}})),e}function nv(n,e,t){const s=new Map;Et(n.length===t.length,32656,{Ae:t.length,Re:n.length});for(let a=0;a<t.length;a++){const l=n[a],d=l.transform,f=e.data.field(l.field);s.set(l.field,GC(d,f,t[a]))}return s}function rv(n,e,t){const s=new Map;for(const a of n){const l=a.transform,d=t.data.field(a.field);s.set(a.field,HC(l,d,e))}return s}class lp extends td{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class XC extends td{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZC{constructor(e,t,s,a){this.batchId=e,this.localWriteTime=t,this.baseMutations=s,this.mutations=a}applyToRemoteDocument(e,t){const s=t.mutationResults;for(let a=0;a<this.mutations.length;a++){const l=this.mutations[a];l.key.isEqual(e.key)&&YC(l,e,s[a])}}applyToLocalView(e,t){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(t=Pl(s,e,t,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(t=Pl(s,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const s=R0();return this.mutations.forEach((a=>{const l=e.get(a.key),d=l.overlayedDocument;let f=this.applyToLocalView(d,l.mutatedFields);f=t.has(a.key)?null:f;const m=L0(d,f);m!==null&&s.set(a.key,m),d.isValidDocument()||d.convertToNoDocument(Je.min())})),s}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),dt())}isEqual(e){return this.batchId===e.batchId&&vo(this.mutations,e.mutations,((t,s)=>tv(t,s)))&&vo(this.baseMutations,e.baseMutations,((t,s)=>tv(t,s)))}}class cp{constructor(e,t,s,a){this.batch=e,this.commitVersion=t,this.mutationResults=s,this.docVersions=a}static from(e,t,s){Et(e.mutations.length===s.length,58842,{Ve:e.mutations.length,me:s.length});let a=(function(){return UC})();const l=e.mutations;for(let d=0;d<l.length;d++)a=a.insert(l[d].key,s[d].version);return new cp(e,t,s,a)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eP{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tP{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var rn,ft;function nP(n){switch(n){case ce.OK:return Ge(64938);case ce.CANCELLED:case ce.UNKNOWN:case ce.DEADLINE_EXCEEDED:case ce.RESOURCE_EXHAUSTED:case ce.INTERNAL:case ce.UNAVAILABLE:case ce.UNAUTHENTICATED:return!1;case ce.INVALID_ARGUMENT:case ce.NOT_FOUND:case ce.ALREADY_EXISTS:case ce.PERMISSION_DENIED:case ce.FAILED_PRECONDITION:case ce.ABORTED:case ce.OUT_OF_RANGE:case ce.UNIMPLEMENTED:case ce.DATA_LOSS:return!0;default:return Ge(15467,{code:n})}}function O0(n){if(n===void 0)return ei("GRPC error has no .code"),ce.UNKNOWN;switch(n){case rn.OK:return ce.OK;case rn.CANCELLED:return ce.CANCELLED;case rn.UNKNOWN:return ce.UNKNOWN;case rn.DEADLINE_EXCEEDED:return ce.DEADLINE_EXCEEDED;case rn.RESOURCE_EXHAUSTED:return ce.RESOURCE_EXHAUSTED;case rn.INTERNAL:return ce.INTERNAL;case rn.UNAVAILABLE:return ce.UNAVAILABLE;case rn.UNAUTHENTICATED:return ce.UNAUTHENTICATED;case rn.INVALID_ARGUMENT:return ce.INVALID_ARGUMENT;case rn.NOT_FOUND:return ce.NOT_FOUND;case rn.ALREADY_EXISTS:return ce.ALREADY_EXISTS;case rn.PERMISSION_DENIED:return ce.PERMISSION_DENIED;case rn.FAILED_PRECONDITION:return ce.FAILED_PRECONDITION;case rn.ABORTED:return ce.ABORTED;case rn.OUT_OF_RANGE:return ce.OUT_OF_RANGE;case rn.UNIMPLEMENTED:return ce.UNIMPLEMENTED;case rn.DATA_LOSS:return ce.DATA_LOSS;default:return Ge(39323,{code:n})}}(ft=rn||(rn={}))[ft.OK=0]="OK",ft[ft.CANCELLED=1]="CANCELLED",ft[ft.UNKNOWN=2]="UNKNOWN",ft[ft.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ft[ft.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ft[ft.NOT_FOUND=5]="NOT_FOUND",ft[ft.ALREADY_EXISTS=6]="ALREADY_EXISTS",ft[ft.PERMISSION_DENIED=7]="PERMISSION_DENIED",ft[ft.UNAUTHENTICATED=16]="UNAUTHENTICATED",ft[ft.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ft[ft.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ft[ft.ABORTED=10]="ABORTED",ft[ft.OUT_OF_RANGE=11]="OUT_OF_RANGE",ft[ft.UNIMPLEMENTED=12]="UNIMPLEMENTED",ft[ft.INTERNAL=13]="INTERNAL",ft[ft.UNAVAILABLE=14]="UNAVAILABLE",ft[ft.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rP=new ji([4294967295,4294967295],0);function sv(n){const e=a0().encode(n),t=new X_;return t.update(e),new Uint8Array(t.digest())}function iv(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),s=e.getUint32(4,!0),a=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new ji([t,s],0),new ji([a,l],0)]}class up{constructor(e,t,s){if(this.bitmap=e,this.padding=t,this.hashCount=s,t<0||t>=8)throw new vl(`Invalid padding: ${t}`);if(s<0)throw new vl(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new vl(`Invalid hash count: ${s}`);if(e.length===0&&t!==0)throw new vl(`Invalid padding when bitmap length is 0: ${t}`);this.fe=8*e.length-t,this.ge=ji.fromNumber(this.fe)}pe(e,t,s){let a=e.add(t.multiply(ji.fromNumber(s)));return a.compare(rP)===1&&(a=new ji([a.getBits(0),a.getBits(1)],0)),a.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;const t=sv(e),[s,a]=iv(t);for(let l=0;l<this.hashCount;l++){const d=this.pe(s,a,l);if(!this.ye(d))return!1}return!0}static create(e,t,s){const a=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),d=new up(l,a,t);return s.forEach((f=>d.insert(f))),d}insert(e){if(this.fe===0)return;const t=sv(e),[s,a]=iv(t);for(let l=0;l<this.hashCount;l++){const d=this.pe(s,a,l);this.we(d)}}we(e){const t=Math.floor(e/8),s=e%8;this.bitmap[t]|=1<<s}}class vl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nd{constructor(e,t,s,a,l){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=s,this.documentUpdates=a,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,t,s){const a=new Map;return a.set(e,Kl.createSynthesizedTargetChangeForCurrentChange(e,t,s)),new nd(Je.min(),a,new Gt(st),ti(),dt())}}class Kl{constructor(e,t,s,a,l){this.resumeToken=e,this.current=t,this.addedDocuments=s,this.modifiedDocuments=a,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,t,s){return new Kl(s,t,dt(),dt(),dt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vu{constructor(e,t,s,a){this.Se=e,this.removedTargetIds=t,this.key=s,this.be=a}}class M0{constructor(e,t){this.targetId=e,this.De=t}}class F0{constructor(e,t,s=jn.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=t,this.resumeToken=s,this.cause=a}}class av{constructor(){this.ve=0,this.Ce=ov(),this.Fe=jn.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=dt(),t=dt(),s=dt();return this.Ce.forEach(((a,l)=>{switch(l){case 0:e=e.add(a);break;case 2:t=t.add(a);break;case 1:s=s.add(a);break;default:Ge(38017,{changeType:l})}})),new Kl(this.Fe,this.Me,e,t,s)}ke(){this.xe=!1,this.Ce=ov()}qe(e,t){this.xe=!0,this.Ce=this.Ce.insert(e,t)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,Et(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class sP{constructor(e){this.We=e,this.Ge=new Map,this.ze=ti(),this.je=lu(),this.Je=lu(),this.He=new Gt(st)}Ye(e){for(const t of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(t,e.be):this.Xe(t,e.key,e.be);for(const t of e.removedTargetIds)this.Xe(t,e.key,e.be)}et(e){this.forEachTarget(e,(t=>{const s=this.tt(t);switch(e.state){case 0:this.nt(t)&&s.Be(e.resumeToken);break;case 1:s.Ue(),s.Oe||s.ke(),s.Be(e.resumeToken);break;case 2:s.Ue(),s.Oe||this.removeTarget(t);break;case 3:this.nt(t)&&(s.Ke(),s.Be(e.resumeToken));break;case 4:this.nt(t)&&(this.rt(t),s.Be(e.resumeToken));break;default:Ge(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ge.forEach(((s,a)=>{this.nt(a)&&t(a)}))}it(e){const t=e.targetId,s=e.De.count,a=this.st(t);if(a){const l=a.target;if(wf(l))if(s===0){const d=new ze(l.path);this.Xe(t,d,Gn.newNoDocument(d,Je.min()))}else Et(s===1,20013,{expectedCount:s});else{const d=this.ot(t);if(d!==s){const f=this._t(e),m=f?this.ut(f,e,d):1;if(m!==0){this.rt(t);const v=m===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(t,v)}}}}}_t(e){const t=e.De.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:s="",padding:a=0},hashCount:l=0}=t;let d,f;try{d=Mi(s).toUint8Array()}catch(m){if(m instanceof d0)return Li("Decoding the base64 bloom filter in existence filter failed ("+m.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw m}try{f=new up(d,a,l)}catch(m){return Li(m instanceof vl?"BloomFilter error: ":"Applying bloom filter failed: ",m),null}return f.fe===0?null:f}ut(e,t,s){return t.De.count===s-this.ht(e,t.targetId)?0:2}ht(e,t){const s=this.We.getRemoteKeysForTarget(t);let a=0;return s.forEach((l=>{const d=this.We.lt(),f=`projects/${d.projectId}/databases/${d.database}/documents/${l.path.canonicalString()}`;e.mightContain(f)||(this.Xe(t,l,null),a++)})),a}Pt(e){const t=new Map;this.Ge.forEach(((l,d)=>{const f=this.st(d);if(f){if(l.current&&wf(f.target)){const m=new ze(f.target.path);this.Tt(m).has(d)||this.It(d,m)||this.Xe(d,m,Gn.newNoDocument(m,e))}l.Ne&&(t.set(d,l.Le()),l.ke())}}));let s=dt();this.Je.forEach(((l,d)=>{let f=!0;d.forEachWhile((m=>{const v=this.st(m);return!v||v.purpose==="TargetPurposeLimboResolution"||(f=!1,!1)})),f&&(s=s.add(l))})),this.ze.forEach(((l,d)=>d.setReadTime(e)));const a=new nd(e,t,this.He,this.ze,s);return this.ze=ti(),this.je=lu(),this.Je=lu(),this.He=new Gt(st),a}Ze(e,t){if(!this.nt(e))return;const s=this.It(e,t.key)?2:0;this.tt(e).qe(t.key,s),this.ze=this.ze.insert(t.key,t),this.je=this.je.insert(t.key,this.Tt(t.key).add(e)),this.Je=this.Je.insert(t.key,this.dt(t.key).add(e))}Xe(e,t,s){if(!this.nt(e))return;const a=this.tt(e);this.It(e,t)?a.qe(t,1):a.Qe(t),this.Je=this.Je.insert(t,this.dt(t).delete(e)),this.Je=this.Je.insert(t,this.dt(t).add(e)),s&&(this.ze=this.ze.insert(t,s))}removeTarget(e){this.Ge.delete(e)}ot(e){const t=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let t=this.Ge.get(e);return t||(t=new av,this.Ge.set(e,t)),t}dt(e){let t=this.Je.get(e);return t||(t=new yn(st),this.Je=this.Je.insert(e,t)),t}Tt(e){let t=this.je.get(e);return t||(t=new yn(st),this.je=this.je.insert(e,t)),t}nt(e){const t=this.st(e)!==null;return t||Re("WatchChangeAggregator","Detected inactive target",e),t}st(e){const t=this.Ge.get(e);return t&&t.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new av),this.We.getRemoteKeysForTarget(e).forEach((t=>{this.Xe(e,t,null)}))}It(e,t){return this.We.getRemoteKeysForTarget(e).has(t)}}function lu(){return new Gt(ze.comparator)}function ov(){return new Gt(ze.comparator)}const iP={asc:"ASCENDING",desc:"DESCENDING"},aP={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},oP={and:"AND",or:"OR"};class lP{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Ef(n,e){return n.useProto3Json||Qu(e)?e:{value:e}}function Lu(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function U0(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function cP(n,e){return Lu(n,e.toTimestamp())}function Es(n){return Et(!!n,49232),Je.fromTimestamp((function(t){const s=Oi(t);return new Ot(s.seconds,s.nanos)})(n))}function dp(n,e){return Tf(n,e).canonicalString()}function Tf(n,e){const t=(function(a){return new Vt(["projects",a.projectId,"databases",a.database])})(n).child("documents");return e===void 0?t:t.child(e)}function z0(n){const e=Vt.fromString(n);return Et(G0(e),10190,{key:e.toString()}),e}function Sf(n,e){return dp(n.databaseId,e.path)}function Qh(n,e){const t=z0(e);if(t.get(1)!==n.databaseId.projectId)throw new De(ce.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new De(ce.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new ze($0(t))}function B0(n,e){return dp(n.databaseId,e)}function uP(n){const e=z0(n);return e.length===4?Vt.emptyPath():$0(e)}function If(n){return new Vt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function $0(n){return Et(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function lv(n,e,t){return{name:Sf(n,e),fields:t.value.mapValue.fields}}function dP(n,e){let t;if("targetChange"in e){e.targetChange;const s=(function(v){return v==="NO_CHANGE"?0:v==="ADD"?1:v==="REMOVE"?2:v==="CURRENT"?3:v==="RESET"?4:Ge(39313,{state:v})})(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],l=(function(v,w){return v.useProto3Json?(Et(w===void 0||typeof w=="string",58123),jn.fromBase64String(w||"")):(Et(w===void 0||w instanceof Buffer||w instanceof Uint8Array,16193),jn.fromUint8Array(w||new Uint8Array))})(n,e.targetChange.resumeToken),d=e.targetChange.cause,f=d&&(function(v){const w=v.code===void 0?ce.UNKNOWN:O0(v.code);return new De(w,v.message||"")})(d);t=new F0(s,a,l,f||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const a=Qh(n,s.document.name),l=Es(s.document.updateTime),d=s.document.createTime?Es(s.document.createTime):Je.min(),f=new hr({mapValue:{fields:s.document.fields}}),m=Gn.newFoundDocument(a,l,d,f),v=s.targetIds||[],w=s.removedTargetIds||[];t=new vu(v,w,m.key,m)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const a=Qh(n,s.document),l=s.readTime?Es(s.readTime):Je.min(),d=Gn.newNoDocument(a,l),f=s.removedTargetIds||[];t=new vu([],f,d.key,d)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const a=Qh(n,s.document),l=s.removedTargetIds||[];t=new vu([],l,a,null)}else{if(!("filter"in e))return Ge(11601,{At:e});{e.filter;const s=e.filter;s.targetId;const{count:a=0,unchangedNames:l}=s,d=new tP(a,l),f=s.targetId;t=new M0(f,d)}}return t}function hP(n,e){let t;if(e instanceof ql)t={update:lv(n,e.key,e.value)};else if(e instanceof lp)t={delete:Sf(n,e.key)};else if(e instanceof qi)t={update:lv(n,e.key,e.data),updateMask:xP(e.fieldMask)};else{if(!(e instanceof XC))return Ge(16599,{Rt:e.type});t={verify:Sf(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((s=>(function(l,d){const f=d.transform;if(f instanceof Ol)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(f instanceof Ml)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:f.elements}};if(f instanceof Fl)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:f.elements}};if(f instanceof Du)return{fieldPath:d.field.canonicalString(),increment:f.Ee};throw Ge(20930,{transform:d.transform})})(0,s)))),e.precondition.isNone||(t.currentDocument=(function(a,l){return l.updateTime!==void 0?{updateTime:cP(a,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:Ge(27497)})(n,e.precondition)),t}function fP(n,e){return n&&n.length>0?(Et(e!==void 0,14353),n.map((t=>(function(a,l){let d=a.updateTime?Es(a.updateTime):Es(l);return d.isEqual(Je.min())&&(d=Es(l)),new QC(d,a.transformResults||[])})(t,e)))):[]}function pP(n,e){return{documents:[B0(n,e.path)]}}function mP(n,e){const t={structuredQuery:{}},s=e.path;let a;e.collectionGroup!==null?(a=s,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=s.popLast(),t.structuredQuery.from=[{collectionId:s.lastSegment()}]),t.parent=B0(n,a);const l=(function(v){if(v.length!==0)return H0(Cs.create(v,"and"))})(e.filters);l&&(t.structuredQuery.where=l);const d=(function(v){if(v.length!==0)return v.map((w=>(function(C){return{field:lo(C.field),direction:vP(C.dir)}})(w)))})(e.orderBy);d&&(t.structuredQuery.orderBy=d);const f=Ef(n,e.limit);return f!==null&&(t.structuredQuery.limit=f),e.startAt&&(t.structuredQuery.startAt=(function(v){return{before:v.inclusive,values:v.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(v){return{before:!v.inclusive,values:v.position}})(e.endAt)),{Vt:t,parent:a}}function gP(n){let e=uP(n.parent);const t=n.structuredQuery,s=t.from?t.from.length:0;let a=null;if(s>0){Et(s===1,65062);const w=t.from[0];w.allDescendants?a=w.collectionId:e=e.child(w.collectionId)}let l=[];t.where&&(l=(function(E){const C=W0(E);return C instanceof Cs&&x0(C)?C.getFilters():[C]})(t.where));let d=[];t.orderBy&&(d=(function(E){return E.map((C=>(function(G){return new ju(co(G.field),(function(O){switch(O){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(G.direction))})(C)))})(t.orderBy));let f=null;t.limit&&(f=(function(E){let C;return C=typeof E=="object"?E.value:E,Qu(C)?null:C})(t.limit));let m=null;t.startAt&&(m=(function(E){const C=!!E.before,U=E.values||[];return new ku(U,C)})(t.startAt));let v=null;return t.endAt&&(v=(function(E){const C=!E.before,U=E.values||[];return new ku(U,C)})(t.endAt)),DC(e,a,d,l,f,"F",m,v)}function yP(n,e){const t=(function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ge(28987,{purpose:a})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function W0(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const s=co(t.unaryFilter.field);return gn.create(s,"==",{doubleValue:NaN});case"IS_NULL":const a=co(t.unaryFilter.field);return gn.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=co(t.unaryFilter.field);return gn.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=co(t.unaryFilter.field);return gn.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ge(61313);default:return Ge(60726)}})(n):n.fieldFilter!==void 0?(function(t){return gn.create(co(t.fieldFilter.field),(function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ge(58110);default:return Ge(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Cs.create(t.compositeFilter.filters.map((s=>W0(s))),(function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return Ge(1026)}})(t.compositeFilter.op))})(n):Ge(30097,{filter:n})}function vP(n){return iP[n]}function _P(n){return aP[n]}function wP(n){return oP[n]}function lo(n){return{fieldPath:n.canonicalString()}}function co(n){return kn.fromServerFormat(n.fieldPath)}function H0(n){return n instanceof gn?(function(t){if(t.op==="=="){if(Qy(t.value))return{unaryFilter:{field:lo(t.field),op:"IS_NAN"}};if(Ky(t.value))return{unaryFilter:{field:lo(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Qy(t.value))return{unaryFilter:{field:lo(t.field),op:"IS_NOT_NAN"}};if(Ky(t.value))return{unaryFilter:{field:lo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:lo(t.field),op:_P(t.op),value:t.value}}})(n):n instanceof Cs?(function(t){const s=t.getFilters().map((a=>H0(a)));return s.length===1?s[0]:{compositeFilter:{op:wP(t.op),filters:s}}})(n):Ge(54877,{filter:n})}function xP(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function G0(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bi{constructor(e,t,s,a,l=Je.min(),d=Je.min(),f=jn.EMPTY_BYTE_STRING,m=null){this.target=e,this.targetId=t,this.purpose=s,this.sequenceNumber=a,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=f,this.expectedCount=m}withSequenceNumber(e){return new bi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new bi(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new bi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new bi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EP{constructor(e){this.gt=e}}function TP(n){const e=gP({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?xf(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SP{constructor(){this.Dn=new IP}addToCollectionParentIndex(e,t){return this.Dn.add(t),ae.resolve()}getCollectionParents(e,t){return ae.resolve(this.Dn.getEntries(t))}addFieldIndex(e,t){return ae.resolve()}deleteFieldIndex(e,t){return ae.resolve()}deleteAllFieldIndexes(e){return ae.resolve()}createTargetIndexes(e,t){return ae.resolve()}getDocumentsMatchingTarget(e,t){return ae.resolve(null)}getIndexType(e,t){return ae.resolve(0)}getFieldIndexes(e,t){return ae.resolve([])}getNextCollectionGroupToUpdate(e){return ae.resolve(null)}getMinOffset(e,t){return ae.resolve(Vi.min())}getMinOffsetFromCollectionGroup(e,t){return ae.resolve(Vi.min())}updateCollectionGroup(e,t,s){return ae.resolve()}updateIndexEntries(e,t){return ae.resolve()}}class IP{constructor(){this.index={}}add(e){const t=e.lastSegment(),s=e.popLast(),a=this.index[t]||new yn(Vt.comparator),l=!a.has(s);return this.index[t]=a.add(s),l}has(e){const t=e.lastSegment(),s=e.popLast(),a=this.index[t];return a&&a.has(s)}getEntries(e){return(this.index[e]||new yn(Vt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cv={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},q0=41943040;class dr{static withCacheSize(e){return new dr(e,dr.DEFAULT_COLLECTION_PERCENTILE,dr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */dr.DEFAULT_COLLECTION_PERCENTILE=10,dr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,dr.DEFAULT=new dr(q0,dr.DEFAULT_COLLECTION_PERCENTILE,dr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),dr.DISABLED=new dr(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xo{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new xo(0)}static ur(){return new xo(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uv="LruGarbageCollector",CP=1048576;function dv([n,e],[t,s]){const a=st(n,t);return a===0?st(e,s):a}class PP{constructor(e){this.Tr=e,this.buffer=new yn(dv),this.Ir=0}dr(){return++this.Ir}Er(e){const t=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(t);else{const s=this.buffer.last();dv(t,s)<0&&(this.buffer=this.buffer.delete(s).add(t))}}get maxValue(){return this.buffer.last()[0]}}class bP{constructor(e,t,s){this.garbageCollector=e,this.asyncQueue=t,this.localStore=s,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){Re(uv,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){No(t)?Re(uv,"Ignoring IndexedDB error during garbage collection: ",t):await Ao(t)}await this.Rr(3e5)}))}}class RP{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.mr(e).next((s=>Math.floor(t/100*s)))}nthSequenceNumber(e,t){if(t===0)return ae.resolve(Ku.ue);const s=new PP(t);return this.Vr.forEachTarget(e,(a=>s.Er(a.sequenceNumber))).next((()=>this.Vr.gr(e,(a=>s.Er(a))))).next((()=>s.maxValue))}removeTargets(e,t,s){return this.Vr.removeTargets(e,t,s)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Re("LruGarbageCollector","Garbage collection skipped; disabled"),ae.resolve(cv)):this.getCacheSize(e).next((s=>s<this.params.cacheSizeCollectionThreshold?(Re("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),cv):this.pr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,t){let s,a,l,d,f,m,v;const w=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((E=>(E>this.params.maximumSequenceNumbersToCollect?(Re("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${E}`),a=this.params.maximumSequenceNumbersToCollect):a=E,d=Date.now(),this.nthSequenceNumber(e,a)))).next((E=>(s=E,f=Date.now(),this.removeTargets(e,s,t)))).next((E=>(l=E,m=Date.now(),this.removeOrphanedDocuments(e,s)))).next((E=>(v=Date.now(),ao()<=ut.DEBUG&&Re("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-w}ms
	Determined least recently used ${a} in `+(f-d)+`ms
	Removed ${l} targets in `+(m-f)+`ms
	Removed ${E} documents in `+(v-m)+`ms
Total Duration: ${v-w}ms`),ae.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:l,documentsRemoved:E}))))}}function AP(n,e){return new RP(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NP{constructor(){this.changes=new Ta((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Gn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const s=this.changes.get(t);return s!==void 0?ae.resolve(s):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kP{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jP{constructor(e,t,s,a){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=s,this.indexManager=a}getDocument(e,t){let s=null;return this.documentOverlayCache.getOverlay(e,t).next((a=>(s=a,this.remoteDocumentCache.getEntry(e,t)))).next((a=>(s!==null&&Pl(s.mutation,a,Tr.empty(),Ot.now()),a)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((s=>this.getLocalViewOfDocuments(e,s,dt()).next((()=>s))))}getLocalViewOfDocuments(e,t,s=dt()){const a=ma();return this.populateOverlays(e,a,t).next((()=>this.computeViews(e,t,a,s).next((l=>{let d=yl();return l.forEach(((f,m)=>{d=d.insert(f,m.overlayedDocument)})),d}))))}getOverlayedDocuments(e,t){const s=ma();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,dt())))}populateOverlays(e,t,s){const a=[];return s.forEach((l=>{t.has(l)||a.push(l)})),this.documentOverlayCache.getOverlays(e,a).next((l=>{l.forEach(((d,f)=>{t.set(d,f)}))}))}computeViews(e,t,s,a){let l=ti();const d=Cl(),f=(function(){return Cl()})();return t.forEach(((m,v)=>{const w=s.get(v.key);a.has(v.key)&&(w===void 0||w.mutation instanceof qi)?l=l.insert(v.key,v):w!==void 0?(d.set(v.key,w.mutation.getFieldMask()),Pl(w.mutation,v,w.mutation.getFieldMask(),Ot.now())):d.set(v.key,Tr.empty())})),this.recalculateAndSaveOverlays(e,l).next((m=>(m.forEach(((v,w)=>d.set(v,w))),t.forEach(((v,w)=>{var E;return f.set(v,new kP(w,(E=d.get(v))!==null&&E!==void 0?E:null))})),f)))}recalculateAndSaveOverlays(e,t){const s=Cl();let a=new Gt(((d,f)=>d-f)),l=dt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((d=>{for(const f of d)f.keys().forEach((m=>{const v=t.get(m);if(v===null)return;let w=s.get(m)||Tr.empty();w=f.applyToLocalView(v,w),s.set(m,w);const E=(a.get(f.batchId)||dt()).add(m);a=a.insert(f.batchId,E)}))})).next((()=>{const d=[],f=a.getReverseIterator();for(;f.hasNext();){const m=f.getNext(),v=m.key,w=m.value,E=R0();w.forEach((C=>{if(!l.has(C)){const U=L0(t.get(C),s.get(C));U!==null&&E.set(C,U),l=l.add(C)}})),d.push(this.documentOverlayCache.saveOverlays(e,v,E))}return ae.waitFor(d)})).next((()=>s))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((s=>this.recalculateAndSaveOverlays(e,s)))}getDocumentsMatchingQuery(e,t,s,a){return(function(d){return ze.isDocumentKey(d.path)&&d.collectionGroup===null&&d.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):LC(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,s,a):this.getDocumentsMatchingCollectionQuery(e,t,s,a)}getNextDocuments(e,t,s,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,s,a).next((l=>{const d=a-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,s.largestBatchId,a-l.size):ae.resolve(ma());let f=jl,m=l;return d.next((v=>ae.forEach(v,((w,E)=>(f<E.largestBatchId&&(f=E.largestBatchId),l.get(w)?ae.resolve():this.remoteDocumentCache.getEntry(e,w).next((C=>{m=m.insert(w,C)}))))).next((()=>this.populateOverlays(e,v,l))).next((()=>this.computeViews(e,m,v,dt()))).next((w=>({batchId:f,changes:b0(w)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ze(t)).next((s=>{let a=yl();return s.isFoundDocument()&&(a=a.insert(s.key,s)),a}))}getDocumentsMatchingCollectionGroupQuery(e,t,s,a){const l=t.collectionGroup;let d=yl();return this.indexManager.getCollectionParents(e,l).next((f=>ae.forEach(f,(m=>{const v=(function(E,C){return new Ju(C,null,E.explicitOrderBy.slice(),E.filters.slice(),E.limit,E.limitType,E.startAt,E.endAt)})(t,m.child(l));return this.getDocumentsMatchingCollectionQuery(e,v,s,a).next((w=>{w.forEach(((E,C)=>{d=d.insert(E,C)}))}))})).next((()=>d))))}getDocumentsMatchingCollectionQuery(e,t,s,a){let l;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,s.largestBatchId).next((d=>(l=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,s,l,a)))).next((d=>{l.forEach(((m,v)=>{const w=v.getKey();d.get(w)===null&&(d=d.insert(w,Gn.newInvalidDocument(w)))}));let f=yl();return d.forEach(((m,v)=>{const w=l.get(m);w!==void 0&&Pl(w.mutation,v,Tr.empty(),Ot.now()),Zu(t,v)&&(f=f.insert(m,v))})),f}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DP{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,t){return ae.resolve(this.Br.get(t))}saveBundleMetadata(e,t){return this.Br.set(t.id,(function(a){return{id:a.id,version:a.version,createTime:Es(a.createTime)}})(t)),ae.resolve()}getNamedQuery(e,t){return ae.resolve(this.Lr.get(t))}saveNamedQuery(e,t){return this.Lr.set(t.name,(function(a){return{name:a.name,query:TP(a.bundledQuery),readTime:Es(a.readTime)}})(t)),ae.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LP{constructor(){this.overlays=new Gt(ze.comparator),this.kr=new Map}getOverlay(e,t){return ae.resolve(this.overlays.get(t))}getOverlays(e,t){const s=ma();return ae.forEach(t,(a=>this.getOverlay(e,a).next((l=>{l!==null&&s.set(a,l)})))).next((()=>s))}saveOverlays(e,t,s){return s.forEach(((a,l)=>{this.wt(e,t,l)})),ae.resolve()}removeOverlaysForBatchId(e,t,s){const a=this.kr.get(s);return a!==void 0&&(a.forEach((l=>this.overlays=this.overlays.remove(l))),this.kr.delete(s)),ae.resolve()}getOverlaysForCollection(e,t,s){const a=ma(),l=t.length+1,d=new ze(t.child("")),f=this.overlays.getIteratorFrom(d);for(;f.hasNext();){const m=f.getNext().value,v=m.getKey();if(!t.isPrefixOf(v.path))break;v.path.length===l&&m.largestBatchId>s&&a.set(m.getKey(),m)}return ae.resolve(a)}getOverlaysForCollectionGroup(e,t,s,a){let l=new Gt(((v,w)=>v-w));const d=this.overlays.getIterator();for(;d.hasNext();){const v=d.getNext().value;if(v.getKey().getCollectionGroup()===t&&v.largestBatchId>s){let w=l.get(v.largestBatchId);w===null&&(w=ma(),l=l.insert(v.largestBatchId,w)),w.set(v.getKey(),v)}}const f=ma(),m=l.getIterator();for(;m.hasNext()&&(m.getNext().value.forEach(((v,w)=>f.set(v,w))),!(f.size()>=a)););return ae.resolve(f)}wt(e,t,s){const a=this.overlays.get(s.key);if(a!==null){const d=this.kr.get(a.largestBatchId).delete(s.key);this.kr.set(a.largestBatchId,d)}this.overlays=this.overlays.insert(s.key,new eP(t,s));let l=this.kr.get(t);l===void 0&&(l=dt(),this.kr.set(t,l)),this.kr.set(t,l.add(s.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VP{constructor(){this.sessionToken=jn.EMPTY_BYTE_STRING}getSessionToken(e){return ae.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ae.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hp{constructor(){this.qr=new yn(Tn.Qr),this.$r=new yn(Tn.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,t){const s=new Tn(e,t);this.qr=this.qr.add(s),this.$r=this.$r.add(s)}Kr(e,t){e.forEach((s=>this.addReference(s,t)))}removeReference(e,t){this.Wr(new Tn(e,t))}Gr(e,t){e.forEach((s=>this.removeReference(s,t)))}zr(e){const t=new ze(new Vt([])),s=new Tn(t,e),a=new Tn(t,e+1),l=[];return this.$r.forEachInRange([s,a],(d=>{this.Wr(d),l.push(d.key)})),l}jr(){this.qr.forEach((e=>this.Wr(e)))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const t=new ze(new Vt([])),s=new Tn(t,e),a=new Tn(t,e+1);let l=dt();return this.$r.forEachInRange([s,a],(d=>{l=l.add(d.key)})),l}containsKey(e){const t=new Tn(e,0),s=this.qr.firstAfterOrEqual(t);return s!==null&&e.isEqual(s.key)}}class Tn{constructor(e,t){this.key=e,this.Hr=t}static Qr(e,t){return ze.comparator(e.key,t.key)||st(e.Hr,t.Hr)}static Ur(e,t){return st(e.Hr,t.Hr)||ze.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OP{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.er=1,this.Yr=new yn(Tn.Qr)}checkEmpty(e){return ae.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,s,a){const l=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new ZC(l,t,s,a);this.mutationQueue.push(d);for(const f of a)this.Yr=this.Yr.add(new Tn(f.key,l)),this.indexManager.addToCollectionParentIndex(e,f.key.path.popLast());return ae.resolve(d)}lookupMutationBatch(e,t){return ae.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const s=t+1,a=this.Xr(s),l=a<0?0:a;return ae.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return ae.resolve(this.mutationQueue.length===0?tp:this.er-1)}getAllMutationBatches(e){return ae.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const s=new Tn(t,0),a=new Tn(t,Number.POSITIVE_INFINITY),l=[];return this.Yr.forEachInRange([s,a],(d=>{const f=this.Zr(d.Hr);l.push(f)})),ae.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new yn(st);return t.forEach((a=>{const l=new Tn(a,0),d=new Tn(a,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([l,d],(f=>{s=s.add(f.Hr)}))})),ae.resolve(this.ei(s))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,a=s.length+1;let l=s;ze.isDocumentKey(l)||(l=l.child(""));const d=new Tn(new ze(l),0);let f=new yn(st);return this.Yr.forEachWhile((m=>{const v=m.key.path;return!!s.isPrefixOf(v)&&(v.length===a&&(f=f.add(m.Hr)),!0)}),d),ae.resolve(this.ei(f))}ei(e){const t=[];return e.forEach((s=>{const a=this.Zr(s);a!==null&&t.push(a)})),t}removeMutationBatch(e,t){Et(this.ti(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let s=this.Yr;return ae.forEach(t.mutations,(a=>{const l=new Tn(a.key,t.batchId);return s=s.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((()=>{this.Yr=s}))}rr(e){}containsKey(e,t){const s=new Tn(t,0),a=this.Yr.firstAfterOrEqual(s);return ae.resolve(t.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,ae.resolve()}ti(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MP{constructor(e){this.ni=e,this.docs=(function(){return new Gt(ze.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const s=t.key,a=this.docs.get(s),l=a?a.size:0,d=this.ni(t);return this.docs=this.docs.insert(s,{document:t.mutableCopy(),size:d}),this.size+=d-l,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const s=this.docs.get(t);return ae.resolve(s?s.document.mutableCopy():Gn.newInvalidDocument(t))}getEntries(e,t){let s=ti();return t.forEach((a=>{const l=this.docs.get(a);s=s.insert(a,l?l.document.mutableCopy():Gn.newInvalidDocument(a))})),ae.resolve(s)}getDocumentsMatchingQuery(e,t,s,a){let l=ti();const d=t.path,f=new ze(d.child("__id-9223372036854775808__")),m=this.docs.getIteratorFrom(f);for(;m.hasNext();){const{key:v,value:{document:w}}=m.getNext();if(!d.isPrefixOf(v.path))break;v.path.length>d.length+1||hC(dC(w),s)<=0||(a.has(w.key)||Zu(t,w))&&(l=l.insert(w.key,w.mutableCopy()))}return ae.resolve(l)}getAllFromCollectionGroup(e,t,s,a){Ge(9500)}ri(e,t){return ae.forEach(this.docs,(s=>t(s)))}newChangeBuffer(e){return new FP(this)}getSize(e){return ae.resolve(this.size)}}class FP extends NP{constructor(e){super(),this.Or=e}applyChanges(e){const t=[];return this.changes.forEach(((s,a)=>{a.isValidDocument()?t.push(this.Or.addEntry(e,a)):this.Or.removeEntry(s)})),ae.waitFor(t)}getFromCache(e,t){return this.Or.getEntry(e,t)}getAllFromCache(e,t){return this.Or.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UP{constructor(e){this.persistence=e,this.ii=new Ta((t=>sp(t)),ip),this.lastRemoteSnapshotVersion=Je.min(),this.highestTargetId=0,this.si=0,this.oi=new hp,this.targetCount=0,this._i=xo.ar()}forEachTarget(e,t){return this.ii.forEach(((s,a)=>t(a))),ae.resolve()}getLastRemoteSnapshotVersion(e){return ae.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ae.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),ae.resolve(this.highestTargetId)}setTargetsMetadata(e,t,s){return s&&(this.lastRemoteSnapshotVersion=s),t>this.si&&(this.si=t),ae.resolve()}hr(e){this.ii.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this._i=new xo(t),this.highestTargetId=t),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,t){return this.hr(t),this.targetCount+=1,ae.resolve()}updateTargetData(e,t){return this.hr(t),ae.resolve()}removeTargetData(e,t){return this.ii.delete(t.target),this.oi.zr(t.targetId),this.targetCount-=1,ae.resolve()}removeTargets(e,t,s){let a=0;const l=[];return this.ii.forEach(((d,f)=>{f.sequenceNumber<=t&&s.get(f.targetId)===null&&(this.ii.delete(d),l.push(this.removeMatchingKeysForTargetId(e,f.targetId)),a++)})),ae.waitFor(l).next((()=>a))}getTargetCount(e){return ae.resolve(this.targetCount)}getTargetData(e,t){const s=this.ii.get(t)||null;return ae.resolve(s)}addMatchingKeys(e,t,s){return this.oi.Kr(t,s),ae.resolve()}removeMatchingKeys(e,t,s){this.oi.Gr(t,s);const a=this.persistence.referenceDelegate,l=[];return a&&t.forEach((d=>{l.push(a.markPotentiallyOrphaned(e,d))})),ae.waitFor(l)}removeMatchingKeysForTargetId(e,t){return this.oi.zr(t),ae.resolve()}getMatchingKeysForTargetId(e,t){const s=this.oi.Jr(t);return ae.resolve(s)}containsKey(e,t){return ae.resolve(this.oi.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K0{constructor(e,t){this.ai={},this.overlays={},this.ui=new Ku(0),this.ci=!1,this.ci=!0,this.li=new VP,this.referenceDelegate=e(this),this.hi=new UP(this),this.indexManager=new SP,this.remoteDocumentCache=(function(a){return new MP(a)})((s=>this.referenceDelegate.Pi(s))),this.serializer=new EP(t),this.Ti=new DP(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new LP,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let s=this.ai[e.toKey()];return s||(s=new OP(t,this.referenceDelegate),this.ai[e.toKey()]=s),s}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,t,s){Re("MemoryPersistence","Starting transaction:",e);const a=new zP(this.ui.next());return this.referenceDelegate.Ii(),s(a).next((l=>this.referenceDelegate.di(a).next((()=>l)))).toPromise().then((l=>(a.raiseOnCommittedEvent(),l)))}Ei(e,t){return ae.or(Object.values(this.ai).map((s=>()=>s.containsKey(e,t))))}}class zP extends pC{constructor(e){super(),this.currentSequenceNumber=e}}class fp{constructor(e){this.persistence=e,this.Ai=new hp,this.Ri=null}static Vi(e){return new fp(e)}get mi(){if(this.Ri)return this.Ri;throw Ge(60996)}addReference(e,t,s){return this.Ai.addReference(s,t),this.mi.delete(s.toString()),ae.resolve()}removeReference(e,t,s){return this.Ai.removeReference(s,t),this.mi.add(s.toString()),ae.resolve()}markPotentiallyOrphaned(e,t){return this.mi.add(t.toString()),ae.resolve()}removeTarget(e,t){this.Ai.zr(t.targetId).forEach((a=>this.mi.add(a.toString())));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,t.targetId).next((a=>{a.forEach((l=>this.mi.add(l.toString())))})).next((()=>s.removeTargetData(e,t)))}Ii(){this.Ri=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ae.forEach(this.mi,(s=>{const a=ze.fromPath(s);return this.fi(e,a).next((l=>{l||t.removeEntry(a,Je.min())}))})).next((()=>(this.Ri=null,t.apply(e))))}updateLimboDocument(e,t){return this.fi(e,t).next((s=>{s?this.mi.delete(t.toString()):this.mi.add(t.toString())}))}Pi(e){return 0}fi(e,t){return ae.or([()=>ae.resolve(this.Ai.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class Vu{constructor(e,t){this.persistence=e,this.gi=new Ta((s=>yC(s.path)),((s,a)=>s.isEqual(a))),this.garbageCollector=AP(this,t)}static Vi(e,t){return new Vu(e,t)}Ii(){}di(e){return ae.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}mr(e){const t=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next((s=>t.next((a=>s+a))))}yr(e){let t=0;return this.gr(e,(s=>{t++})).next((()=>t))}gr(e,t){return ae.forEach(this.gi,((s,a)=>this.Sr(e,s,a).next((l=>l?ae.resolve():t(a)))))}removeTargets(e,t,s){return this.persistence.getTargetCache().removeTargets(e,t,s)}removeOrphanedDocuments(e,t){let s=0;const a=this.persistence.getRemoteDocumentCache(),l=a.newChangeBuffer();return a.ri(e,(d=>this.Sr(e,d,t).next((f=>{f||(s++,l.removeEntry(d,Je.min()))})))).next((()=>l.apply(e))).next((()=>s))}markPotentiallyOrphaned(e,t){return this.gi.set(t,e.currentSequenceNumber),ae.resolve()}removeTarget(e,t){const s=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,s)}addReference(e,t,s){return this.gi.set(s,e.currentSequenceNumber),ae.resolve()}removeReference(e,t,s){return this.gi.set(s,e.currentSequenceNumber),ae.resolve()}updateLimboDocument(e,t){return this.gi.set(t,e.currentSequenceNumber),ae.resolve()}Pi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=mu(e.data.value)),t}Sr(e,t,s){return ae.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const a=this.gi.get(t);return ae.resolve(a!==void 0&&a>s)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pp{constructor(e,t,s,a){this.targetId=e,this.fromCache=t,this.Is=s,this.ds=a}static Es(e,t){let s=dt(),a=dt();for(const l of t.docChanges)switch(l.type){case 0:s=s.add(l.doc.key);break;case 1:a=a.add(l.doc.key)}return new pp(e,t.fromCache,s,a)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BP{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $P{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=(function(){return yT()?8:mC(qn())>0?6:4})()}initialize(e,t){this.gs=e,this.indexManager=t,this.As=!0}getDocumentsMatchingQuery(e,t,s,a){const l={result:null};return this.ps(e,t).next((d=>{l.result=d})).next((()=>{if(!l.result)return this.ys(e,t,a,s).next((d=>{l.result=d}))})).next((()=>{if(l.result)return;const d=new BP;return this.ws(e,t,d).next((f=>{if(l.result=f,this.Rs)return this.Ss(e,t,d,f.size)}))})).next((()=>l.result))}Ss(e,t,s,a){return s.documentReadCount<this.Vs?(ao()<=ut.DEBUG&&Re("QueryEngine","SDK will not create cache indexes for query:",oo(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),ae.resolve()):(ao()<=ut.DEBUG&&Re("QueryEngine","Query:",oo(t),"scans",s.documentReadCount,"local documents and returns",a,"documents as results."),s.documentReadCount>this.fs*a?(ao()<=ut.DEBUG&&Re("QueryEngine","The SDK decides to create cache indexes for query:",oo(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,xs(t))):ae.resolve())}ps(e,t){if(Zy(t))return ae.resolve(null);let s=xs(t);return this.indexManager.getIndexType(e,s).next((a=>a===0?null:(t.limit!==null&&a===1&&(t=xf(t,null,"F"),s=xs(t)),this.indexManager.getDocumentsMatchingTarget(e,s).next((l=>{const d=dt(...l);return this.gs.getDocuments(e,d).next((f=>this.indexManager.getMinOffset(e,s).next((m=>{const v=this.bs(t,f);return this.Ds(t,v,d,m.readTime)?this.ps(e,xf(t,null,"F")):this.vs(e,v,t,m)}))))})))))}ys(e,t,s,a){return Zy(t)||a.isEqual(Je.min())?ae.resolve(null):this.gs.getDocuments(e,s).next((l=>{const d=this.bs(t,l);return this.Ds(t,d,s,a)?ae.resolve(null):(ao()<=ut.DEBUG&&Re("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),oo(t)),this.vs(e,d,t,uC(a,jl)).next((f=>f)))}))}bs(e,t){let s=new yn(C0(e));return t.forEach(((a,l)=>{Zu(e,l)&&(s=s.add(l))})),s}Ds(e,t,s,a){if(e.limit===null)return!1;if(s.size!==t.size)return!0;const l=e.limitType==="F"?t.last():t.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(a)>0)}ws(e,t,s){return ao()<=ut.DEBUG&&Re("QueryEngine","Using full collection scan to execute query:",oo(t)),this.gs.getDocumentsMatchingQuery(e,t,Vi.min(),s)}vs(e,t,s,a){return this.gs.getDocumentsMatchingQuery(e,s,a).next((l=>(t.forEach((d=>{l=l.insert(d.key,d)})),l)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mp="LocalStore",WP=3e8;class HP{constructor(e,t,s,a){this.persistence=e,this.Cs=t,this.serializer=a,this.Fs=new Gt(st),this.Ms=new Ta((l=>sp(l)),ip),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(s)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new jP(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Fs)))}}function GP(n,e,t,s){return new HP(n,e,t,s)}async function Q0(n,e){const t=Xe(n);return await t.persistence.runTransaction("Handle user change","readonly",(s=>{let a;return t.mutationQueue.getAllMutationBatches(s).next((l=>(a=l,t.Ns(e),t.mutationQueue.getAllMutationBatches(s)))).next((l=>{const d=[],f=[];let m=dt();for(const v of a){d.push(v.batchId);for(const w of v.mutations)m=m.add(w.key)}for(const v of l){f.push(v.batchId);for(const w of v.mutations)m=m.add(w.key)}return t.localDocuments.getDocuments(s,m).next((v=>({Bs:v,removedBatchIds:d,addedBatchIds:f})))}))}))}function qP(n,e){const t=Xe(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(s=>{const a=e.batch.keys(),l=t.Os.newChangeBuffer({trackRemovals:!0});return(function(f,m,v,w){const E=v.batch,C=E.keys();let U=ae.resolve();return C.forEach((G=>{U=U.next((()=>w.getEntry(m,G))).next((K=>{const O=v.docVersions.get(G);Et(O!==null,48541),K.version.compareTo(O)<0&&(E.applyToRemoteDocument(K,v),K.isValidDocument()&&(K.setReadTime(v.commitVersion),w.addEntry(K)))}))})),U.next((()=>f.mutationQueue.removeMutationBatch(m,E)))})(t,s,e,l).next((()=>l.apply(s))).next((()=>t.mutationQueue.performConsistencyCheck(s))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(s,a,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,(function(f){let m=dt();for(let v=0;v<f.mutationResults.length;++v)f.mutationResults[v].transformResults.length>0&&(m=m.add(f.batch.mutations[v].key));return m})(e)))).next((()=>t.localDocuments.getDocuments(s,a)))}))}function Y0(n){const e=Xe(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.hi.getLastRemoteSnapshotVersion(t)))}function KP(n,e){const t=Xe(n),s=e.snapshotVersion;let a=t.Fs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const d=t.Os.newChangeBuffer({trackRemovals:!0});a=t.Fs;const f=[];e.targetChanges.forEach(((w,E)=>{const C=a.get(E);if(!C)return;f.push(t.hi.removeMatchingKeys(l,w.removedDocuments,E).next((()=>t.hi.addMatchingKeys(l,w.addedDocuments,E))));let U=C.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(E)!==null?U=U.withResumeToken(jn.EMPTY_BYTE_STRING,Je.min()).withLastLimboFreeSnapshotVersion(Je.min()):w.resumeToken.approximateByteSize()>0&&(U=U.withResumeToken(w.resumeToken,s)),a=a.insert(E,U),(function(K,O,re){return K.resumeToken.approximateByteSize()===0||O.snapshotVersion.toMicroseconds()-K.snapshotVersion.toMicroseconds()>=WP?!0:re.addedDocuments.size+re.modifiedDocuments.size+re.removedDocuments.size>0})(C,U,w)&&f.push(t.hi.updateTargetData(l,U))}));let m=ti(),v=dt();if(e.documentUpdates.forEach((w=>{e.resolvedLimboDocuments.has(w)&&f.push(t.persistence.referenceDelegate.updateLimboDocument(l,w))})),f.push(QP(l,d,e.documentUpdates).next((w=>{m=w.Ls,v=w.ks}))),!s.isEqual(Je.min())){const w=t.hi.getLastRemoteSnapshotVersion(l).next((E=>t.hi.setTargetsMetadata(l,l.currentSequenceNumber,s)));f.push(w)}return ae.waitFor(f).next((()=>d.apply(l))).next((()=>t.localDocuments.getLocalViewOfDocuments(l,m,v))).next((()=>m))})).then((l=>(t.Fs=a,l)))}function QP(n,e,t){let s=dt(),a=dt();return t.forEach((l=>s=s.add(l))),e.getEntries(n,s).next((l=>{let d=ti();return t.forEach(((f,m)=>{const v=l.get(f);m.isFoundDocument()!==v.isFoundDocument()&&(a=a.add(f)),m.isNoDocument()&&m.version.isEqual(Je.min())?(e.removeEntry(f,m.readTime),d=d.insert(f,m)):!v.isValidDocument()||m.version.compareTo(v.version)>0||m.version.compareTo(v.version)===0&&v.hasPendingWrites?(e.addEntry(m),d=d.insert(f,m)):Re(mp,"Ignoring outdated watch update for ",f,". Current version:",v.version," Watch version:",m.version)})),{Ls:d,ks:a}}))}function YP(n,e){const t=Xe(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(s=>(e===void 0&&(e=tp),t.mutationQueue.getNextMutationBatchAfterBatchId(s,e))))}function JP(n,e){const t=Xe(n);return t.persistence.runTransaction("Allocate target","readwrite",(s=>{let a;return t.hi.getTargetData(s,e).next((l=>l?(a=l,ae.resolve(a)):t.hi.allocateTargetId(s).next((d=>(a=new bi(e,d,"TargetPurposeListen",s.currentSequenceNumber),t.hi.addTargetData(s,a).next((()=>a)))))))})).then((s=>{const a=t.Fs.get(s.targetId);return(a===null||s.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(t.Fs=t.Fs.insert(s.targetId,s),t.Ms.set(e,s.targetId)),s}))}async function Cf(n,e,t){const s=Xe(n),a=s.Fs.get(e),l=t?"readwrite":"readwrite-primary";try{t||await s.persistence.runTransaction("Release target",l,(d=>s.persistence.referenceDelegate.removeTarget(d,a)))}catch(d){if(!No(d))throw d;Re(mp,`Failed to update sequence numbers for target ${e}: ${d}`)}s.Fs=s.Fs.remove(e),s.Ms.delete(a.target)}function hv(n,e,t){const s=Xe(n);let a=Je.min(),l=dt();return s.persistence.runTransaction("Execute query","readwrite",(d=>(function(m,v,w){const E=Xe(m),C=E.Ms.get(w);return C!==void 0?ae.resolve(E.Fs.get(C)):E.hi.getTargetData(v,w)})(s,d,xs(e)).next((f=>{if(f)return a=f.lastLimboFreeSnapshotVersion,s.hi.getMatchingKeysForTargetId(d,f.targetId).next((m=>{l=m}))})).next((()=>s.Cs.getDocumentsMatchingQuery(d,e,t?a:Je.min(),t?l:dt()))).next((f=>(XP(s,OC(e),f),{documents:f,qs:l})))))}function XP(n,e,t){let s=n.xs.get(e)||Je.min();t.forEach(((a,l)=>{l.readTime.compareTo(s)>0&&(s=l.readTime)})),n.xs.set(e,s)}class fv{constructor(){this.activeTargetIds=$C()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class ZP{constructor(){this.Fo=new fv,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,s){}addLocalQueryTarget(e,t=!0){return t&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,t,s){this.Mo[e]=t}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new fv,Promise.resolve()}handleUserChange(e,t,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eb{xo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pv="ConnectivityMonitor";class mv{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){Re(pv,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){Re(pv,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cu=null;function Pf(){return cu===null?cu=(function(){return 268435456+Math.round(2147483648*Math.random())})():cu++,"0x"+cu.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yh="RestConnection",tb={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class nb{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.$o=t+"://"+e.host,this.Uo=`projects/${s}/databases/${a}`,this.Ko=this.databaseId.database===Au?`project_id=${s}`:`project_id=${s}&database_id=${a}`}Wo(e,t,s,a,l){const d=Pf(),f=this.Go(e,t.toUriEncodedString());Re(Yh,`Sending RPC '${e}' ${d}:`,f,s);const m={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(m,a,l);const{host:v}=new URL(f),w=Io(v);return this.jo(e,f,m,s,w).then((E=>(Re(Yh,`Received RPC '${e}' ${d}: `,E),E)),(E=>{throw Li(Yh,`RPC '${e}' ${d} failed with error: `,E,"url: ",f,"request:",s),E}))}Jo(e,t,s,a,l,d){return this.Wo(e,t,s,a,l)}zo(e,t,s){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Ro})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((a,l)=>e[l]=a)),s&&s.headers.forEach(((a,l)=>e[l]=a))}Go(e,t){const s=tb[e];return`${this.$o}/v1/${t}:${s}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rb{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $n="WebChannelConnection";class sb extends nb{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,t,s,a,l){const d=Pf();return new Promise(((f,m)=>{const v=new Z_;v.setWithCredentials(!0),v.listenOnce(e0.COMPLETE,(()=>{try{switch(v.getLastErrorCode()){case pu.NO_ERROR:const E=v.getResponseJson();Re($n,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(E)),f(E);break;case pu.TIMEOUT:Re($n,`RPC '${e}' ${d} timed out`),m(new De(ce.DEADLINE_EXCEEDED,"Request time out"));break;case pu.HTTP_ERROR:const C=v.getStatus();if(Re($n,`RPC '${e}' ${d} failed with status:`,C,"response text:",v.getResponseText()),C>0){let U=v.getResponseJson();Array.isArray(U)&&(U=U[0]);const G=U==null?void 0:U.error;if(G&&G.status&&G.message){const K=(function(re){const ye=re.toLowerCase().replace(/_/g,"-");return Object.values(ce).indexOf(ye)>=0?ye:ce.UNKNOWN})(G.status);m(new De(K,G.message))}else m(new De(ce.UNKNOWN,"Server responded with status "+v.getStatus()))}else m(new De(ce.UNAVAILABLE,"Connection failed."));break;default:Ge(9055,{c_:e,streamId:d,l_:v.getLastErrorCode(),h_:v.getLastError()})}}finally{Re($n,`RPC '${e}' ${d} completed.`)}}));const w=JSON.stringify(a);Re($n,`RPC '${e}' ${d} sending request:`,a),v.send(t,"POST",w,s,15)}))}P_(e,t,s){const a=Pf(),l=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=r0(),f=n0(),m={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},v=this.longPollingOptions.timeoutSeconds;v!==void 0&&(m.longPollingTimeout=Math.round(1e3*v)),this.useFetchStreams&&(m.useFetchStreams=!0),this.zo(m.initMessageHeaders,t,s),m.encodeInitMessageHeaders=!0;const w=l.join("");Re($n,`Creating RPC '${e}' stream ${a}: ${w}`,m);const E=d.createWebChannel(w,m);this.T_(E);let C=!1,U=!1;const G=new rb({Ho:O=>{U?Re($n,`Not sending because RPC '${e}' stream ${a} is closed:`,O):(C||(Re($n,`Opening RPC '${e}' stream ${a} transport.`),E.open(),C=!0),Re($n,`RPC '${e}' stream ${a} sending:`,O),E.send(O))},Yo:()=>E.close()}),K=(O,re,ye)=>{O.listen(re,(ne=>{try{ye(ne)}catch(oe){setTimeout((()=>{throw oe}),0)}}))};return K(E,gl.EventType.OPEN,(()=>{U||(Re($n,`RPC '${e}' stream ${a} transport opened.`),G.s_())})),K(E,gl.EventType.CLOSE,(()=>{U||(U=!0,Re($n,`RPC '${e}' stream ${a} transport closed`),G.__(),this.I_(E))})),K(E,gl.EventType.ERROR,(O=>{U||(U=!0,Li($n,`RPC '${e}' stream ${a} transport errored. Name:`,O.name,"Message:",O.message),G.__(new De(ce.UNAVAILABLE,"The operation could not be completed")))})),K(E,gl.EventType.MESSAGE,(O=>{var re;if(!U){const ye=O.data[0];Et(!!ye,16349);const ne=ye,oe=(ne==null?void 0:ne.error)||((re=ne[0])===null||re===void 0?void 0:re.error);if(oe){Re($n,`RPC '${e}' stream ${a} received error:`,oe);const Ee=oe.status;let Se=(function(k){const V=rn[k];if(V!==void 0)return O0(V)})(Ee),b=oe.message;Se===void 0&&(Se=ce.INTERNAL,b="Unknown error status: "+Ee+" with message "+oe.message),U=!0,G.__(new De(Se,b)),E.close()}else Re($n,`RPC '${e}' stream ${a} received:`,ye),G.a_(ye)}})),K(f,t0.STAT_EVENT,(O=>{O.stat===mf.PROXY?Re($n,`RPC '${e}' stream ${a} detected buffering proxy`):O.stat===mf.NOPROXY&&Re($n,`RPC '${e}' stream ${a} detected no buffering proxy`)})),setTimeout((()=>{G.o_()}),0),G}terminate(){this.u_.forEach((e=>e.close())),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter((t=>t===e))}}function Jh(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rd(n){return new lP(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J0{constructor(e,t,s=1e3,a=1.5,l=6e4){this.Fi=e,this.timerId=t,this.d_=s,this.E_=a,this.A_=l,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const t=Math.floor(this.R_+this.p_()),s=Math.max(0,Date.now()-this.m_),a=Math.max(0,t-s);a>0&&Re("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.R_} ms, delay with jitter: ${t} ms, last attempt: ${s} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,a,(()=>(this.m_=Date.now(),e()))),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gv="PersistentStream";class X0{constructor(e,t,s,a,l,d,f,m){this.Fi=e,this.w_=s,this.S_=a,this.connection=l,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=f,this.listener=m,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new J0(e,t)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,(()=>this.L_())))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():t&&t.code===ce.RESOURCE_EXHAUSTED?(ei(t.toString()),ei("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):t&&t.code===ce.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(t)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),t=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([s,a])=>{this.b_===t&&this.W_(s,a)}),(s=>{e((()=>{const a=new De(ce.UNKNOWN,"Fetching auth token failed: "+s.message);return this.G_(a)}))}))}W_(e,t){const s=this.K_(this.b_);this.stream=this.z_(e,t),this.stream.Zo((()=>{s((()=>this.listener.Zo()))})),this.stream.e_((()=>{s((()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,(()=>(this.x_()&&(this.state=3),Promise.resolve()))),this.listener.e_())))})),this.stream.n_((a=>{s((()=>this.G_(a)))})),this.stream.onMessage((a=>{s((()=>++this.C_==1?this.j_(a):this.onNext(a)))}))}O_(){this.state=5,this.F_.g_((async()=>{this.state=0,this.start()}))}G_(e){return Re(gv,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return t=>{this.Fi.enqueueAndForget((()=>this.b_===e?t():(Re(gv,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class ib extends X0{constructor(e,t,s,a,l,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,s,a,d),this.serializer=l}z_(e,t){return this.connection.P_("Listen",e,t)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const t=dP(this.serializer,e),s=(function(l){if(!("targetChange"in l))return Je.min();const d=l.targetChange;return d.targetIds&&d.targetIds.length?Je.min():d.readTime?Es(d.readTime):Je.min()})(e);return this.listener.J_(t,s)}H_(e){const t={};t.database=If(this.serializer),t.addTarget=(function(l,d){let f;const m=d.target;if(f=wf(m)?{documents:pP(l,m)}:{query:mP(l,m).Vt},f.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){f.resumeToken=U0(l,d.resumeToken);const v=Ef(l,d.expectedCount);v!==null&&(f.expectedCount=v)}else if(d.snapshotVersion.compareTo(Je.min())>0){f.readTime=Lu(l,d.snapshotVersion.toTimestamp());const v=Ef(l,d.expectedCount);v!==null&&(f.expectedCount=v)}return f})(this.serializer,e);const s=yP(this.serializer,e);s&&(t.labels=s),this.k_(t)}Y_(e){const t={};t.database=If(this.serializer),t.removeTarget=e,this.k_(t)}}class ab extends X0{constructor(e,t,s,a,l,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,s,a,d),this.serializer=l}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,t){return this.connection.P_("Write",e,t)}j_(e){return Et(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Et(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){Et(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();const t=fP(e.writeResults,e.commitTime),s=Es(e.commitTime);return this.listener.ta(s,t)}na(){const e={};e.database=If(this.serializer),this.k_(e)}X_(e){const t={streamToken:this.lastStreamToken,writes:e.map((s=>hP(this.serializer,s)))};this.k_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ob{}class lb extends ob{constructor(e,t,s,a){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=s,this.serializer=a,this.ra=!1}ia(){if(this.ra)throw new De(ce.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,s,a){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,d])=>this.connection.Wo(e,Tf(t,s),a,l,d))).catch((l=>{throw l.name==="FirebaseError"?(l.code===ce.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new De(ce.UNKNOWN,l.toString())}))}Jo(e,t,s,a,l){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([d,f])=>this.connection.Jo(e,Tf(t,s),a,d,f,l))).catch((d=>{throw d.name==="FirebaseError"?(d.code===ce.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new De(ce.UNKNOWN,d.toString())}))}terminate(){this.ra=!0,this.connection.terminate()}}class cb{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve()))))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(ei(t),this._a=!1):Re("OnlineStateTracker",t)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xa="RemoteStore";class ub{constructor(e,t,s,a,l){this.localStore=e,this.datastore=t,this.asyncQueue=s,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=l,this.Ea.xo((d=>{s.enqueueAndForget((async()=>{Sa(this)&&(Re(xa,"Restarting streams for network reachability change."),await(async function(m){const v=Xe(m);v.Ia.add(4),await Ql(v),v.Aa.set("Unknown"),v.Ia.delete(4),await sd(v)})(this))}))})),this.Aa=new cb(s,a)}}async function sd(n){if(Sa(n))for(const e of n.da)await e(!0)}async function Ql(n){for(const e of n.da)await e(!1)}function Z0(n,e){const t=Xe(n);t.Ta.has(e.targetId)||(t.Ta.set(e.targetId,e),_p(t)?vp(t):ko(t).x_()&&yp(t,e))}function gp(n,e){const t=Xe(n),s=ko(t);t.Ta.delete(e),s.x_()&&ew(t,e),t.Ta.size===0&&(s.x_()?s.B_():Sa(t)&&t.Aa.set("Unknown"))}function yp(n,e){if(n.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Je.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}ko(n).H_(e)}function ew(n,e){n.Ra.$e(e),ko(n).Y_(e)}function vp(n){n.Ra=new sP({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>n.Ta.get(e)||null,lt:()=>n.datastore.serializer.databaseId}),ko(n).start(),n.Aa.aa()}function _p(n){return Sa(n)&&!ko(n).M_()&&n.Ta.size>0}function Sa(n){return Xe(n).Ia.size===0}function tw(n){n.Ra=void 0}async function db(n){n.Aa.set("Online")}async function hb(n){n.Ta.forEach(((e,t)=>{yp(n,e)}))}async function fb(n,e){tw(n),_p(n)?(n.Aa.la(e),vp(n)):n.Aa.set("Unknown")}async function pb(n,e,t){if(n.Aa.set("Online"),e instanceof F0&&e.state===2&&e.cause)try{await(async function(a,l){const d=l.cause;for(const f of l.targetIds)a.Ta.has(f)&&(await a.remoteSyncer.rejectListen(f,d),a.Ta.delete(f),a.Ra.removeTarget(f))})(n,e)}catch(s){Re(xa,"Failed to remove targets %s: %s ",e.targetIds.join(","),s),await Ou(n,s)}else if(e instanceof vu?n.Ra.Ye(e):e instanceof M0?n.Ra.it(e):n.Ra.et(e),!t.isEqual(Je.min()))try{const s=await Y0(n.localStore);t.compareTo(s)>=0&&await(function(l,d){const f=l.Ra.Pt(d);return f.targetChanges.forEach(((m,v)=>{if(m.resumeToken.approximateByteSize()>0){const w=l.Ta.get(v);w&&l.Ta.set(v,w.withResumeToken(m.resumeToken,d))}})),f.targetMismatches.forEach(((m,v)=>{const w=l.Ta.get(m);if(!w)return;l.Ta.set(m,w.withResumeToken(jn.EMPTY_BYTE_STRING,w.snapshotVersion)),ew(l,m);const E=new bi(w.target,m,v,w.sequenceNumber);yp(l,E)})),l.remoteSyncer.applyRemoteEvent(f)})(n,t)}catch(s){Re(xa,"Failed to raise snapshot:",s),await Ou(n,s)}}async function Ou(n,e,t){if(!No(e))throw e;n.Ia.add(1),await Ql(n),n.Aa.set("Offline"),t||(t=()=>Y0(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{Re(xa,"Retrying IndexedDB access"),await t(),n.Ia.delete(1),await sd(n)}))}function nw(n,e){return e().catch((t=>Ou(n,t,e)))}async function id(n){const e=Xe(n),t=Ui(e);let s=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:tp;for(;mb(e);)try{const a=await YP(e.localStore,s);if(a===null){e.Pa.length===0&&t.B_();break}s=a.batchId,gb(e,a)}catch(a){await Ou(e,a)}rw(e)&&sw(e)}function mb(n){return Sa(n)&&n.Pa.length<10}function gb(n,e){n.Pa.push(e);const t=Ui(n);t.x_()&&t.Z_&&t.X_(e.mutations)}function rw(n){return Sa(n)&&!Ui(n).M_()&&n.Pa.length>0}function sw(n){Ui(n).start()}async function yb(n){Ui(n).na()}async function vb(n){const e=Ui(n);for(const t of n.Pa)e.X_(t.mutations)}async function _b(n,e,t){const s=n.Pa.shift(),a=cp.from(s,e,t);await nw(n,(()=>n.remoteSyncer.applySuccessfulWrite(a))),await id(n)}async function wb(n,e){e&&Ui(n).Z_&&await(async function(s,a){if((function(d){return nP(d)&&d!==ce.ABORTED})(a.code)){const l=s.Pa.shift();Ui(s).N_(),await nw(s,(()=>s.remoteSyncer.rejectFailedWrite(l.batchId,a))),await id(s)}})(n,e),rw(n)&&sw(n)}async function yv(n,e){const t=Xe(n);t.asyncQueue.verifyOperationInProgress(),Re(xa,"RemoteStore received new credentials");const s=Sa(t);t.Ia.add(3),await Ql(t),s&&t.Aa.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ia.delete(3),await sd(t)}async function xb(n,e){const t=Xe(n);e?(t.Ia.delete(2),await sd(t)):e||(t.Ia.add(2),await Ql(t),t.Aa.set("Unknown"))}function ko(n){return n.Va||(n.Va=(function(t,s,a){const l=Xe(t);return l.ia(),new ib(s,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(n.datastore,n.asyncQueue,{Zo:db.bind(null,n),e_:hb.bind(null,n),n_:fb.bind(null,n),J_:pb.bind(null,n)}),n.da.push((async e=>{e?(n.Va.N_(),_p(n)?vp(n):n.Aa.set("Unknown")):(await n.Va.stop(),tw(n))}))),n.Va}function Ui(n){return n.ma||(n.ma=(function(t,s,a){const l=Xe(t);return l.ia(),new ab(s,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),e_:yb.bind(null,n),n_:wb.bind(null,n),ea:vb.bind(null,n),ta:_b.bind(null,n)}),n.da.push((async e=>{e?(n.ma.N_(),await id(n)):(await n.ma.stop(),n.Pa.length>0&&(Re(xa,`Stopping write stream with ${n.Pa.length} pending writes`),n.Pa=[]))}))),n.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wp{constructor(e,t,s,a,l){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=s,this.op=a,this.removalCallback=l,this.deferred=new Ys,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((d=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,s,a,l){const d=Date.now()+s,f=new wp(e,t,d,a,l);return f.start(s),f}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new De(ce.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function xp(n,e){if(ei("AsyncQueue",`${e}: ${n}`),No(n))return new De(ce.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class po{static emptySet(e){return new po(e.comparator)}constructor(e){this.comparator=e?(t,s)=>e(t,s)||ze.comparator(t.key,s.key):(t,s)=>ze.comparator(t.key,s.key),this.keyedMap=yl(),this.sortedSet=new Gt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,s)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof po)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=s.getNext().key;if(!a.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const s=new po;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=t,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vv{constructor(){this.fa=new Gt(ze.comparator)}track(e){const t=e.doc.key,s=this.fa.get(t);s?e.type!==0&&s.type===3?this.fa=this.fa.insert(t,e):e.type===3&&s.type!==1?this.fa=this.fa.insert(t,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.fa=this.fa.insert(t,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.fa=this.fa.remove(t):e.type===1&&s.type===2?this.fa=this.fa.insert(t,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):Ge(63341,{At:e,ga:s}):this.fa=this.fa.insert(t,e)}pa(){const e=[];return this.fa.inorderTraversal(((t,s)=>{e.push(s)})),e}}class Eo{constructor(e,t,s,a,l,d,f,m,v){this.query=e,this.docs=t,this.oldDocs=s,this.docChanges=a,this.mutatedKeys=l,this.fromCache=d,this.syncStateChanged=f,this.excludesMetadataChanges=m,this.hasCachedResults=v}static fromInitialDocuments(e,t,s,a,l){const d=[];return t.forEach((f=>{d.push({type:0,doc:f})})),new Eo(e,t,po.emptySet(t),d,s,a,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Xu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,s=e.docChanges;if(t.length!==s.length)return!1;for(let a=0;a<t.length;a++)if(t[a].type!==s[a].type||!t[a].doc.isEqual(s[a].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eb{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some((e=>e.ba()))}}class Tb{constructor(){this.queries=_v(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(t,s){const a=Xe(t),l=a.queries;a.queries=_v(),l.forEach(((d,f)=>{for(const m of f.wa)m.onError(s)}))})(this,new De(ce.ABORTED,"Firestore shutting down"))}}function _v(){return new Ta((n=>I0(n)),Xu)}async function iw(n,e){const t=Xe(n);let s=3;const a=e.query;let l=t.queries.get(a);l?!l.Sa()&&e.ba()&&(s=2):(l=new Eb,s=e.ba()?0:1);try{switch(s){case 0:l.ya=await t.onListen(a,!0);break;case 1:l.ya=await t.onListen(a,!1);break;case 2:await t.onFirstRemoteStoreListen(a)}}catch(d){const f=xp(d,`Initialization of query '${oo(e.query)}' failed`);return void e.onError(f)}t.queries.set(a,l),l.wa.push(e),e.va(t.onlineState),l.ya&&e.Ca(l.ya)&&Ep(t)}async function aw(n,e){const t=Xe(n),s=e.query;let a=3;const l=t.queries.get(s);if(l){const d=l.wa.indexOf(e);d>=0&&(l.wa.splice(d,1),l.wa.length===0?a=e.ba()?0:1:!l.Sa()&&e.ba()&&(a=2))}switch(a){case 0:return t.queries.delete(s),t.onUnlisten(s,!0);case 1:return t.queries.delete(s),t.onUnlisten(s,!1);case 2:return t.onLastRemoteStoreUnlisten(s);default:return}}function Sb(n,e){const t=Xe(n);let s=!1;for(const a of e){const l=a.query,d=t.queries.get(l);if(d){for(const f of d.wa)f.Ca(a)&&(s=!0);d.ya=a}}s&&Ep(t)}function Ib(n,e,t){const s=Xe(n),a=s.queries.get(e);if(a)for(const l of a.wa)l.onError(t);s.queries.delete(e)}function Ep(n){n.Da.forEach((e=>{e.next()}))}var bf,wv;(wv=bf||(bf={})).Fa="default",wv.Cache="cache";class ow{constructor(e,t,s){this.query=e,this.Ma=t,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=s||{}}Ca(e){if(!this.options.includeMetadataChanges){const s=[];for(const a of e.docChanges)a.type!==3&&s.push(a);e=new Eo(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),t=!0):this.Ba(e,this.onlineState)&&(this.La(e),t=!0),this.Oa=e,t}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let t=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),t=!0),t}Ba(e,t){if(!e.fromCache||!this.ba())return!0;const s=t!=="Offline";return(!this.options.ka||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Na(e){if(e.docChanges.length>0)return!0;const t=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}La(e){e=Eo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==bf.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lw{constructor(e){this.key=e}}class cw{constructor(e){this.key=e}}class Cb{constructor(e,t){this.query=e,this.Ha=t,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=dt(),this.mutatedKeys=dt(),this.Xa=C0(e),this.eu=new po(this.Xa)}get tu(){return this.Ha}nu(e,t){const s=t?t.ru:new vv,a=t?t.eu:this.eu;let l=t?t.mutatedKeys:this.mutatedKeys,d=a,f=!1;const m=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,v=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal(((w,E)=>{const C=a.get(w),U=Zu(this.query,E)?E:null,G=!!C&&this.mutatedKeys.has(C.key),K=!!U&&(U.hasLocalMutations||this.mutatedKeys.has(U.key)&&U.hasCommittedMutations);let O=!1;C&&U?C.data.isEqual(U.data)?G!==K&&(s.track({type:3,doc:U}),O=!0):this.iu(C,U)||(s.track({type:2,doc:U}),O=!0,(m&&this.Xa(U,m)>0||v&&this.Xa(U,v)<0)&&(f=!0)):!C&&U?(s.track({type:0,doc:U}),O=!0):C&&!U&&(s.track({type:1,doc:C}),O=!0,(m||v)&&(f=!0)),O&&(U?(d=d.add(U),l=K?l.add(w):l.delete(w)):(d=d.delete(w),l=l.delete(w)))})),this.query.limit!==null)for(;d.size>this.query.limit;){const w=this.query.limitType==="F"?d.last():d.first();d=d.delete(w.key),l=l.delete(w.key),s.track({type:1,doc:w})}return{eu:d,ru:s,Ds:f,mutatedKeys:l}}iu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,s,a){const l=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const d=e.ru.pa();d.sort(((w,E)=>(function(U,G){const K=O=>{switch(O){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ge(20277,{At:O})}};return K(U)-K(G)})(w.type,E.type)||this.Xa(w.doc,E.doc))),this.su(s),a=a!=null&&a;const f=t&&!a?this.ou():[],m=this.Za.size===0&&this.current&&!a?1:0,v=m!==this.Ya;return this.Ya=m,d.length!==0||v?{snapshot:new Eo(this.query,e.eu,l,d,e.mutatedKeys,m===0,v,!1,!!s&&s.resumeToken.approximateByteSize()>0),_u:f}:{_u:f}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new vv,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach((t=>this.Ha=this.Ha.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ha=this.Ha.delete(t))),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=dt(),this.eu.forEach((s=>{this.au(s.key)&&(this.Za=this.Za.add(s.key))}));const t=[];return e.forEach((s=>{this.Za.has(s)||t.push(new cw(s))})),this.Za.forEach((s=>{e.has(s)||t.push(new lw(s))})),t}uu(e){this.Ha=e.qs,this.Za=dt();const t=this.nu(e.documents);return this.applyChanges(t,!0)}cu(){return Eo.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const Tp="SyncEngine";class Pb{constructor(e,t,s){this.query=e,this.targetId=t,this.view=s}}class bb{constructor(e){this.key=e,this.lu=!1}}class Rb{constructor(e,t,s,a,l,d){this.localStore=e,this.remoteStore=t,this.eventManager=s,this.sharedClientState=a,this.currentUser=l,this.maxConcurrentLimboResolutions=d,this.hu={},this.Pu=new Ta((f=>I0(f)),Xu),this.Tu=new Map,this.Iu=new Set,this.du=new Gt(ze.comparator),this.Eu=new Map,this.Au=new hp,this.Ru={},this.Vu=new Map,this.mu=xo.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function Ab(n,e,t=!0){const s=mw(n);let a;const l=s.Pu.get(e);return l?(s.sharedClientState.addLocalQueryTarget(l.targetId),a=l.view.cu()):a=await uw(s,e,t,!0),a}async function Nb(n,e){const t=mw(n);await uw(t,e,!0,!1)}async function uw(n,e,t,s){const a=await JP(n.localStore,xs(e)),l=a.targetId,d=n.sharedClientState.addLocalQueryTarget(l,t);let f;return s&&(f=await kb(n,e,l,d==="current",a.resumeToken)),n.isPrimaryClient&&t&&Z0(n.remoteStore,a),f}async function kb(n,e,t,s,a){n.gu=(E,C,U)=>(async function(K,O,re,ye){let ne=O.view.nu(re);ne.Ds&&(ne=await hv(K.localStore,O.query,!1).then((({documents:b})=>O.view.nu(b,ne))));const oe=ye&&ye.targetChanges.get(O.targetId),Ee=ye&&ye.targetMismatches.get(O.targetId)!=null,Se=O.view.applyChanges(ne,K.isPrimaryClient,oe,Ee);return Ev(K,O.targetId,Se._u),Se.snapshot})(n,E,C,U);const l=await hv(n.localStore,e,!0),d=new Cb(e,l.qs),f=d.nu(l.documents),m=Kl.createSynthesizedTargetChangeForCurrentChange(t,s&&n.onlineState!=="Offline",a),v=d.applyChanges(f,n.isPrimaryClient,m);Ev(n,t,v._u);const w=new Pb(e,t,d);return n.Pu.set(e,w),n.Tu.has(t)?n.Tu.get(t).push(e):n.Tu.set(t,[e]),v.snapshot}async function jb(n,e,t){const s=Xe(n),a=s.Pu.get(e),l=s.Tu.get(a.targetId);if(l.length>1)return s.Tu.set(a.targetId,l.filter((d=>!Xu(d,e)))),void s.Pu.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(a.targetId),s.sharedClientState.isActiveQueryTarget(a.targetId)||await Cf(s.localStore,a.targetId,!1).then((()=>{s.sharedClientState.clearQueryState(a.targetId),t&&gp(s.remoteStore,a.targetId),Rf(s,a.targetId)})).catch(Ao)):(Rf(s,a.targetId),await Cf(s.localStore,a.targetId,!0))}async function Db(n,e){const t=Xe(n),s=t.Pu.get(e),a=t.Tu.get(s.targetId);t.isPrimaryClient&&a.length===1&&(t.sharedClientState.removeLocalQueryTarget(s.targetId),gp(t.remoteStore,s.targetId))}async function Lb(n,e,t){const s=Bb(n);try{const a=await(function(d,f){const m=Xe(d),v=Ot.now(),w=f.reduce(((U,G)=>U.add(G.key)),dt());let E,C;return m.persistence.runTransaction("Locally write mutations","readwrite",(U=>{let G=ti(),K=dt();return m.Os.getEntries(U,w).next((O=>{G=O,G.forEach(((re,ye)=>{ye.isValidDocument()||(K=K.add(re))}))})).next((()=>m.localDocuments.getOverlayedDocuments(U,G))).next((O=>{E=O;const re=[];for(const ye of f){const ne=JC(ye,E.get(ye.key).overlayedDocument);ne!=null&&re.push(new qi(ye.key,ne,v0(ne.value.mapValue),Vr.exists(!0)))}return m.mutationQueue.addMutationBatch(U,v,re,f)})).next((O=>{C=O;const re=O.applyToLocalDocumentSet(E,K);return m.documentOverlayCache.saveOverlays(U,O.batchId,re)}))})).then((()=>({batchId:C.batchId,changes:b0(E)})))})(s.localStore,e);s.sharedClientState.addPendingMutation(a.batchId),(function(d,f,m){let v=d.Ru[d.currentUser.toKey()];v||(v=new Gt(st)),v=v.insert(f,m),d.Ru[d.currentUser.toKey()]=v})(s,a.batchId,t),await Yl(s,a.changes),await id(s.remoteStore)}catch(a){const l=xp(a,"Failed to persist write");t.reject(l)}}async function dw(n,e){const t=Xe(n);try{const s=await KP(t.localStore,e);e.targetChanges.forEach(((a,l)=>{const d=t.Eu.get(l);d&&(Et(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?d.lu=!0:a.modifiedDocuments.size>0?Et(d.lu,14607):a.removedDocuments.size>0&&(Et(d.lu,42227),d.lu=!1))})),await Yl(t,s,e)}catch(s){await Ao(s)}}function xv(n,e,t){const s=Xe(n);if(s.isPrimaryClient&&t===0||!s.isPrimaryClient&&t===1){const a=[];s.Pu.forEach(((l,d)=>{const f=d.view.va(e);f.snapshot&&a.push(f.snapshot)})),(function(d,f){const m=Xe(d);m.onlineState=f;let v=!1;m.queries.forEach(((w,E)=>{for(const C of E.wa)C.va(f)&&(v=!0)})),v&&Ep(m)})(s.eventManager,e),a.length&&s.hu.J_(a),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function Vb(n,e,t){const s=Xe(n);s.sharedClientState.updateQueryState(e,"rejected",t);const a=s.Eu.get(e),l=a&&a.key;if(l){let d=new Gt(ze.comparator);d=d.insert(l,Gn.newNoDocument(l,Je.min()));const f=dt().add(l),m=new nd(Je.min(),new Map,new Gt(st),d,f);await dw(s,m),s.du=s.du.remove(l),s.Eu.delete(e),Sp(s)}else await Cf(s.localStore,e,!1).then((()=>Rf(s,e,t))).catch(Ao)}async function Ob(n,e){const t=Xe(n),s=e.batch.batchId;try{const a=await qP(t.localStore,e);fw(t,s,null),hw(t,s),t.sharedClientState.updateMutationState(s,"acknowledged"),await Yl(t,a)}catch(a){await Ao(a)}}async function Mb(n,e,t){const s=Xe(n);try{const a=await(function(d,f){const m=Xe(d);return m.persistence.runTransaction("Reject batch","readwrite-primary",(v=>{let w;return m.mutationQueue.lookupMutationBatch(v,f).next((E=>(Et(E!==null,37113),w=E.keys(),m.mutationQueue.removeMutationBatch(v,E)))).next((()=>m.mutationQueue.performConsistencyCheck(v))).next((()=>m.documentOverlayCache.removeOverlaysForBatchId(v,w,f))).next((()=>m.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(v,w))).next((()=>m.localDocuments.getDocuments(v,w)))}))})(s.localStore,e);fw(s,e,t),hw(s,e),s.sharedClientState.updateMutationState(e,"rejected",t),await Yl(s,a)}catch(a){await Ao(a)}}function hw(n,e){(n.Vu.get(e)||[]).forEach((t=>{t.resolve()})),n.Vu.delete(e)}function fw(n,e,t){const s=Xe(n);let a=s.Ru[s.currentUser.toKey()];if(a){const l=a.get(e);l&&(t?l.reject(t):l.resolve(),a=a.remove(e)),s.Ru[s.currentUser.toKey()]=a}}function Rf(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const s of n.Tu.get(e))n.Pu.delete(s),t&&n.hu.pu(s,t);n.Tu.delete(e),n.isPrimaryClient&&n.Au.zr(e).forEach((s=>{n.Au.containsKey(s)||pw(n,s)}))}function pw(n,e){n.Iu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(gp(n.remoteStore,t),n.du=n.du.remove(e),n.Eu.delete(t),Sp(n))}function Ev(n,e,t){for(const s of t)s instanceof lw?(n.Au.addReference(s.key,e),Fb(n,s)):s instanceof cw?(Re(Tp,"Document no longer in limbo: "+s.key),n.Au.removeReference(s.key,e),n.Au.containsKey(s.key)||pw(n,s.key)):Ge(19791,{yu:s})}function Fb(n,e){const t=e.key,s=t.path.canonicalString();n.du.get(t)||n.Iu.has(s)||(Re(Tp,"New document in limbo: "+t),n.Iu.add(s),Sp(n))}function Sp(n){for(;n.Iu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Iu.values().next().value;n.Iu.delete(e);const t=new ze(Vt.fromString(e)),s=n.mu.next();n.Eu.set(s,new bb(t)),n.du=n.du.insert(t,s),Z0(n.remoteStore,new bi(xs(ap(t.path)),s,"TargetPurposeLimboResolution",Ku.ue))}}async function Yl(n,e,t){const s=Xe(n),a=[],l=[],d=[];s.Pu.isEmpty()||(s.Pu.forEach(((f,m)=>{d.push(s.gu(m,e,t).then((v=>{var w;if((v||t)&&s.isPrimaryClient){const E=v?!v.fromCache:(w=t==null?void 0:t.targetChanges.get(m.targetId))===null||w===void 0?void 0:w.current;s.sharedClientState.updateQueryState(m.targetId,E?"current":"not-current")}if(v){a.push(v);const E=pp.Es(m.targetId,v);l.push(E)}})))})),await Promise.all(d),s.hu.J_(a),await(async function(m,v){const w=Xe(m);try{await w.persistence.runTransaction("notifyLocalViewChanges","readwrite",(E=>ae.forEach(v,(C=>ae.forEach(C.Is,(U=>w.persistence.referenceDelegate.addReference(E,C.targetId,U))).next((()=>ae.forEach(C.ds,(U=>w.persistence.referenceDelegate.removeReference(E,C.targetId,U)))))))))}catch(E){if(!No(E))throw E;Re(mp,"Failed to update sequence numbers: "+E)}for(const E of v){const C=E.targetId;if(!E.fromCache){const U=w.Fs.get(C),G=U.snapshotVersion,K=U.withLastLimboFreeSnapshotVersion(G);w.Fs=w.Fs.insert(C,K)}}})(s.localStore,l))}async function Ub(n,e){const t=Xe(n);if(!t.currentUser.isEqual(e)){Re(Tp,"User change. New user:",e.toKey());const s=await Q0(t.localStore,e);t.currentUser=e,(function(l,d){l.Vu.forEach((f=>{f.forEach((m=>{m.reject(new De(ce.CANCELLED,d))}))})),l.Vu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await Yl(t,s.Bs)}}function zb(n,e){const t=Xe(n),s=t.Eu.get(e);if(s&&s.lu)return dt().add(s.key);{let a=dt();const l=t.Tu.get(e);if(!l)return a;for(const d of l){const f=t.Pu.get(d);a=a.unionWith(f.view.tu)}return a}}function mw(n){const e=Xe(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=dw.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=zb.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Vb.bind(null,e),e.hu.J_=Sb.bind(null,e.eventManager),e.hu.pu=Ib.bind(null,e.eventManager),e}function Bb(n){const e=Xe(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Ob.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Mb.bind(null,e),e}class Mu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=rd(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,t){return null}Fu(e,t){return null}vu(e){return GP(this.persistence,new $P,e.initialUser,this.serializer)}Du(e){return new K0(fp.Vi,this.serializer)}bu(e){return new ZP}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Mu.provider={build:()=>new Mu};class $b extends Mu{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,t){Et(this.persistence.referenceDelegate instanceof Vu,46915);const s=this.persistence.referenceDelegate.garbageCollector;return new bP(s,e.asyncQueue,t)}Du(e){const t=this.cacheSizeBytes!==void 0?dr.withCacheSize(this.cacheSizeBytes):dr.DEFAULT;return new K0((s=>Vu.Vi(s,t)),this.serializer)}}class Af{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>xv(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=Ub.bind(null,this.syncEngine),await xb(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new Tb})()}createDatastore(e){const t=rd(e.databaseInfo.databaseId),s=(function(l){return new sb(l)})(e.databaseInfo);return(function(l,d,f,m){return new lb(l,d,f,m)})(e.authCredentials,e.appCheckCredentials,s,t)}createRemoteStore(e){return(function(s,a,l,d,f){return new ub(s,a,l,d,f)})(this.localStore,this.datastore,e.asyncQueue,(t=>xv(this.syncEngine,t,0)),(function(){return mv.C()?new mv:new eb})())}createSyncEngine(e,t){return(function(a,l,d,f,m,v,w){const E=new Rb(a,l,d,f,m,v);return w&&(E.fu=!0),E})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(a){const l=Xe(a);Re(xa,"RemoteStore shutting down."),l.Ia.add(5),await Ql(l),l.Ea.shutdown(),l.Aa.set("Unknown")})(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}Af.provider={build:()=>new Af};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gw{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):ei("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zi="FirestoreClient";class Wb{constructor(e,t,s,a,l){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=s,this.databaseInfo=a,this.user=Wn.UNAUTHENTICATED,this.clientId=Zf.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(s,(async d=>{Re(zi,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d})),this.appCheckCredentials.start(s,(d=>(Re(zi,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ys;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const s=xp(t,"Failed to shutdown persistence");e.reject(s)}})),e.promise}}async function Xh(n,e){n.asyncQueue.verifyOperationInProgress(),Re(zi,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let s=t.initialUser;n.setCredentialChangeListener((async a=>{s.isEqual(a)||(await Q0(e.localStore,a),s=a)})),e.persistence.setDatabaseDeletedListener((()=>{Li("Terminating Firestore due to IndexedDb database deletion"),n.terminate().then((()=>{Re("Terminating Firestore due to IndexedDb database deletion completed successfully")})).catch((a=>{Li("Terminating Firestore due to IndexedDb database deletion failed",a)}))})),n._offlineComponents=e}async function Tv(n,e){n.asyncQueue.verifyOperationInProgress();const t=await Hb(n);Re(zi,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((s=>yv(e.remoteStore,s))),n.setAppCheckTokenChangeListener(((s,a)=>yv(e.remoteStore,a))),n._onlineComponents=e}async function Hb(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Re(zi,"Using user provided OfflineComponentProvider");try{await Xh(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(a){return a.name==="FirebaseError"?a.code===ce.FAILED_PRECONDITION||a.code===ce.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11})(t))throw t;Li("Error using user provided cache. Falling back to memory cache: "+t),await Xh(n,new Mu)}}else Re(zi,"Using default OfflineComponentProvider"),await Xh(n,new $b(void 0));return n._offlineComponents}async function yw(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Re(zi,"Using user provided OnlineComponentProvider"),await Tv(n,n._uninitializedComponentsProvider._online)):(Re(zi,"Using default OnlineComponentProvider"),await Tv(n,new Af))),n._onlineComponents}function Gb(n){return yw(n).then((e=>e.syncEngine))}async function vw(n){const e=await yw(n),t=e.eventManager;return t.onListen=Ab.bind(null,e.syncEngine),t.onUnlisten=jb.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=Nb.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=Db.bind(null,e.syncEngine),t}function qb(n,e,t={}){const s=new Ys;return n.asyncQueue.enqueueAndForget((async()=>(function(l,d,f,m,v){const w=new gw({next:C=>{w.Ou(),d.enqueueAndForget((()=>aw(l,E)));const U=C.docs.has(f);!U&&C.fromCache?v.reject(new De(ce.UNAVAILABLE,"Failed to get document because the client is offline.")):U&&C.fromCache&&m&&m.source==="server"?v.reject(new De(ce.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):v.resolve(C)},error:C=>v.reject(C)}),E=new ow(ap(f.path),w,{includeMetadataChanges:!0,ka:!0});return iw(l,E)})(await vw(n),n.asyncQueue,e,t,s))),s.promise}function Kb(n,e,t={}){const s=new Ys;return n.asyncQueue.enqueueAndForget((async()=>(function(l,d,f,m,v){const w=new gw({next:C=>{w.Ou(),d.enqueueAndForget((()=>aw(l,E))),C.fromCache&&m.source==="server"?v.reject(new De(ce.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):v.resolve(C)},error:C=>v.reject(C)}),E=new ow(f,w,{includeMetadataChanges:!0,ka:!0});return iw(l,E)})(await vw(n),n.asyncQueue,e,t,s))),s.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _w(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sv=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ww="firestore.googleapis.com",Iv=!0;class Cv{constructor(e){var t,s;if(e.host===void 0){if(e.ssl!==void 0)throw new De(ce.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=ww,this.ssl=Iv}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:Iv;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=q0;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<CP)throw new De(ce.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}cC("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=_w((s=e.experimentalLongPollingOptions)!==null&&s!==void 0?s:{}),(function(l){if(l.timeoutSeconds!==void 0){if(isNaN(l.timeoutSeconds))throw new De(ce.INVALID_ARGUMENT,`invalid long polling timeout: ${l.timeoutSeconds} (must not be NaN)`);if(l.timeoutSeconds<5)throw new De(ce.INVALID_ARGUMENT,`invalid long polling timeout: ${l.timeoutSeconds} (minimum allowed value is 5)`);if(l.timeoutSeconds>30)throw new De(ce.INVALID_ARGUMENT,`invalid long polling timeout: ${l.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(s,a){return s.timeoutSeconds===a.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class ad{constructor(e,t,s,a){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=s,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Cv({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new De(ce.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new De(ce.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Cv(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(s){if(!s)return new eC;switch(s.type){case"firstParty":return new sC(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new De(ce.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const s=Sv.get(t);s&&(Re("ComponentProvider","Removing Datastore"),Sv.delete(t),s.terminate())})(this),Promise.resolve()}}function Qb(n,e,t,s={}){var a;n=rs(n,ad);const l=Io(e),d=n._getSettings(),f=Object.assign(Object.assign({},d),{emulatorOptions:n._getEmulatorOptions()}),m=`${e}:${t}`;l&&(o_(`https://${m}`),l_("Firestore",!0)),d.host!==ww&&d.host!==m&&Li("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const v=Object.assign(Object.assign({},d),{host:m,ssl:l,emulatorOptions:s});if(!ya(v,f)&&(n._setSettings(v),s.mockUserToken)){let w,E;if(typeof s.mockUserToken=="string")w=s.mockUserToken,E=Wn.MOCK_USER;else{w=lT(s.mockUserToken,(a=n._app)===null||a===void 0?void 0:a.options.projectId);const C=s.mockUserToken.sub||s.mockUserToken.user_id;if(!C)throw new De(ce.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");E=new Wn(C)}n._authCredentials=new tC(new i0(w,E))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class od{constructor(e,t,s){this.converter=t,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new od(this.firestore,e,this._query)}}class an{constructor(e,t,s){this.converter=t,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Di(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new an(this.firestore,e,this._key)}toJSON(){return{type:an._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,s){if(Gl(t,an._jsonSchema))return new an(e,s||null,new ze(Vt.fromString(t.referencePath)))}}an._jsonSchemaVersion="firestore/documentReference/1.0",an._jsonSchema={type:sn("string",an._jsonSchemaVersion),referencePath:sn("string")};class Di extends od{constructor(e,t,s){super(e,t,ap(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new an(this.firestore,null,new ze(e))}withConverter(e){return new Di(this.firestore,e,this._path)}}function Hn(n,e,...t){if(n=on(n),o0("collection","path",e),n instanceof ad){const s=Vt.fromString(e,...t);return Uy(s),new Di(n,null,s)}{if(!(n instanceof an||n instanceof Di))throw new De(ce.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(Vt.fromString(e,...t));return Uy(s),new Di(n.firestore,null,s)}}function At(n,e,...t){if(n=on(n),arguments.length===1&&(e=Zf.newId()),o0("doc","path",e),n instanceof ad){const s=Vt.fromString(e,...t);return Fy(s),new an(n,null,new ze(s))}{if(!(n instanceof an||n instanceof Di))throw new De(ce.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(Vt.fromString(e,...t));return Fy(s),new an(n.firestore,n instanceof Di?n.converter:null,new ze(s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pv="AsyncQueue";class bv{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new J0(this,"async_queue_retry"),this.oc=()=>{const s=Jh();s&&Re(Pv,"Visibility state changed to "+s.visibilityState),this.F_.y_()},this._c=e;const t=Jh();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const t=Jh();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise((()=>{}));const t=new Ys;return this.uc((()=>this.Xu&&this.rc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Zu.push(e),this.cc())))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!No(e))throw e;Re(Pv,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_((()=>this.cc()))}}uc(e){const t=this._c.then((()=>(this.nc=!0,e().catch((s=>{throw this.tc=s,this.nc=!1,ei("INTERNAL UNHANDLED ERROR: ",Rv(s)),s})).then((s=>(this.nc=!1,s))))));return this._c=t,t}enqueueAfterDelay(e,t,s){this.ac(),this.sc.indexOf(e)>-1&&(t=0);const a=wp.createAndSchedule(this,e,t,s,(l=>this.lc(l)));return this.ec.push(a),a}ac(){this.tc&&Ge(47125,{hc:Rv(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(const t of this.ec)if(t.timerId===e)return!0;return!1}Ic(e){return this.Pc().then((()=>{this.ec.sort(((t,s)=>t.targetTimeMs-s.targetTimeMs));for(const t of this.ec)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Pc()}))}dc(e){this.sc.push(e)}lc(e){const t=this.ec.indexOf(e);this.ec.splice(t,1)}}function Rv(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class Ia extends ad{constructor(e,t,s,a){super(e,t,s,a),this.type="firestore",this._queue=new bv,this._persistenceKey=(a==null?void 0:a.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new bv(e),this._firestoreClient=void 0,await e}}}function Yb(n,e){const t=typeof n=="object"?n:h_(),s=typeof n=="string"?n:Au,a=Uf(t,"firestore").getImmediate({identifier:s});if(!a._initialized){const l=aT("firestore");l&&Qb(a,...l)}return a}function Ip(n){if(n._terminated)throw new De(ce.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||Jb(n),n._firestoreClient}function Jb(n){var e,t,s;const a=n._freezeSettings(),l=(function(f,m,v,w){return new wC(f,m,v,w.host,w.ssl,w.experimentalForceLongPolling,w.experimentalAutoDetectLongPolling,_w(w.experimentalLongPollingOptions),w.useFetchStreams,w.isUsingEmulator)})(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,a);n._componentsProvider||!((t=a.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((s=a.localCache)===null||s===void 0)&&s._onlineComponentProvider)&&(n._componentsProvider={_offline:a.localCache._offlineComponentProvider,_online:a.localCache._onlineComponentProvider}),n._firestoreClient=new Wb(n._authCredentials,n._appCheckCredentials,n._queue,l,n._componentsProvider&&(function(f){const m=f==null?void 0:f._online.build();return{_offline:f==null?void 0:f._offline.build(m),_online:m}})(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Dr(jn.fromBase64String(e))}catch(t){throw new De(ce.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Dr(jn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Dr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Gl(e,Dr._jsonSchema))return Dr.fromBase64String(e.bytes)}}Dr._jsonSchemaVersion="firestore/bytes/1.0",Dr._jsonSchema={type:sn("string",Dr._jsonSchemaVersion),bytes:sn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ld{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new De(ce.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new kn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cd{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ts{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new De(ce.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new De(ce.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return st(this._lat,e._lat)||st(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ts._jsonSchemaVersion}}static fromJSON(e){if(Gl(e,Ts._jsonSchema))return new Ts(e.latitude,e.longitude)}}Ts._jsonSchemaVersion="firestore/geoPoint/1.0",Ts._jsonSchema={type:sn("string",Ts._jsonSchemaVersion),latitude:sn("number"),longitude:sn("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ss{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(s,a){if(s.length!==a.length)return!1;for(let l=0;l<s.length;++l)if(s[l]!==a[l])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Ss._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Gl(e,Ss._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Ss(e.vectorValues);throw new De(ce.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Ss._jsonSchemaVersion="firestore/vectorValue/1.0",Ss._jsonSchema={type:sn("string",Ss._jsonSchemaVersion),vectorValues:sn("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xb=/^__.*__$/;class Zb{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return this.fieldMask!==null?new qi(e,this.data,this.fieldMask,t,this.fieldTransforms):new ql(e,this.data,t,this.fieldTransforms)}}class xw{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return new qi(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Ew(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ge(40011,{Ec:n})}}class Cp{constructor(e,t,s,a,l,d){this.settings=e,this.databaseId=t,this.serializer=s,this.ignoreUndefinedProperties=a,l===void 0&&this.Ac(),this.fieldTransforms=l||[],this.fieldMask=d||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new Cp(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var t;const s=(t=this.path)===null||t===void 0?void 0:t.child(e),a=this.Rc({path:s,mc:!1});return a.fc(e),a}gc(e){var t;const s=(t=this.path)===null||t===void 0?void 0:t.child(e),a=this.Rc({path:s,mc:!1});return a.Ac(),a}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return Fu(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(Ew(this.Ec)&&Xb.test(e))throw this.wc('Document fields cannot begin and end with "__"')}}class eR{constructor(e,t,s){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=s||rd(e)}Dc(e,t,s,a=!1){return new Cp({Ec:e,methodName:t,bc:s,path:kn.emptyPath(),mc:!1,Sc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Pp(n){const e=n._freezeSettings(),t=rd(n._databaseId);return new eR(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Tw(n,e,t,s,a,l={}){const d=n.Dc(l.merge||l.mergeFields?2:0,e,t,a);Rp("Data must be an object, but it was:",d,s);const f=Sw(s,d);let m,v;if(l.merge)m=new Tr(d.fieldMask),v=d.fieldTransforms;else if(l.mergeFields){const w=[];for(const E of l.mergeFields){const C=Nf(e,E,t);if(!d.contains(C))throw new De(ce.INVALID_ARGUMENT,`Field '${C}' is specified in your field mask but missing from your input data.`);Cw(w,C)||w.push(C)}m=new Tr(w),v=d.fieldTransforms.filter((E=>m.covers(E.field)))}else m=null,v=d.fieldTransforms;return new Zb(new hr(f),m,v)}class Jl extends cd{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Jl}}class bp extends cd{_toFieldTransform(e){return new qC(e.path,new Ol)}isEqual(e){return e instanceof bp}}function tR(n,e,t,s){const a=n.Dc(1,e,t);Rp("Data must be an object, but it was:",a,s);const l=[],d=hr.empty();Gi(s,((m,v)=>{const w=Ap(e,m,t);v=on(v);const E=a.gc(w);if(v instanceof Jl)l.push(w);else{const C=ud(v,E);C!=null&&(l.push(w),d.set(w,C))}}));const f=new Tr(l);return new xw(d,f,a.fieldTransforms)}function nR(n,e,t,s,a,l){const d=n.Dc(1,e,t),f=[Nf(e,s,t)],m=[a];if(l.length%2!=0)throw new De(ce.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let C=0;C<l.length;C+=2)f.push(Nf(e,l[C])),m.push(l[C+1]);const v=[],w=hr.empty();for(let C=f.length-1;C>=0;--C)if(!Cw(v,f[C])){const U=f[C];let G=m[C];G=on(G);const K=d.gc(U);if(G instanceof Jl)v.push(U);else{const O=ud(G,K);O!=null&&(v.push(U),w.set(U,O))}}const E=new Tr(v);return new xw(w,E,d.fieldTransforms)}function ud(n,e){if(Iw(n=on(n)))return Rp("Unsupported field value:",e,n),Sw(n,e);if(n instanceof cd)return(function(s,a){if(!Ew(a.Ec))throw a.wc(`${s._methodName}() can only be used with update() and set()`);if(!a.path)throw a.wc(`${s._methodName}() is not currently supported inside arrays`);const l=s._toFieldTransform(a);l&&a.fieldTransforms.push(l)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return(function(s,a){const l=[];let d=0;for(const f of s){let m=ud(f,a.yc(d));m==null&&(m={nullValue:"NULL_VALUE"}),l.push(m),d++}return{arrayValue:{values:l}}})(n,e)}return(function(s,a){if((s=on(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return WC(a.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const l=Ot.fromDate(s);return{timestampValue:Lu(a.serializer,l)}}if(s instanceof Ot){const l=new Ot(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:Lu(a.serializer,l)}}if(s instanceof Ts)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof Dr)return{bytesValue:U0(a.serializer,s._byteString)};if(s instanceof an){const l=a.databaseId,d=s.firestore._databaseId;if(!d.isEqual(l))throw a.wc(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:dp(s.firestore._databaseId||a.databaseId,s._key.path)}}if(s instanceof Ss)return(function(d,f){return{mapValue:{fields:{[g0]:{stringValue:y0},[Nu]:{arrayValue:{values:d.toArray().map((v=>{if(typeof v!="number")throw f.wc("VectorValues must only contain numeric values.");return op(f.serializer,v)}))}}}}}})(s,a);throw a.wc(`Unsupported field value: ${ep(s)}`)})(n,e)}function Sw(n,e){const t={};return u0(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Gi(n,((s,a)=>{const l=ud(a,e.Vc(s));l!=null&&(t[s]=l)})),{mapValue:{fields:t}}}function Iw(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Ot||n instanceof Ts||n instanceof Dr||n instanceof an||n instanceof cd||n instanceof Ss)}function Rp(n,e,t){if(!Iw(t)||!l0(t)){const s=ep(t);throw s==="an object"?e.wc(n+" a custom object"):e.wc(n+" "+s)}}function Nf(n,e,t){if((e=on(e))instanceof ld)return e._internalPath;if(typeof e=="string")return Ap(n,e);throw Fu("Field path arguments must be of type string or ",n,!1,void 0,t)}const rR=new RegExp("[~\\*/\\[\\]]");function Ap(n,e,t){if(e.search(rR)>=0)throw Fu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new ld(...e.split("."))._internalPath}catch{throw Fu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Fu(n,e,t,s,a){const l=s&&!s.isEmpty(),d=a!==void 0;let f=`Function ${e}() called with invalid data`;t&&(f+=" (via `toFirestore()`)"),f+=". ";let m="";return(l||d)&&(m+=" (found",l&&(m+=` in field ${s}`),d&&(m+=` in document ${a}`),m+=")"),new De(ce.INVALID_ARGUMENT,f+n+m)}function Cw(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pw{constructor(e,t,s,a,l){this._firestore=e,this._userDataWriter=t,this._key=s,this._document=a,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new an(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new sR(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(bw("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class sR extends Pw{data(){return super.data()}}function bw(n,e){return typeof e=="string"?Ap(n,e):e instanceof ld?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iR(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new De(ce.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class aR{convertValue(e,t="none"){switch(Fi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Xt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Mi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ge(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const s={};return Gi(e,((a,l)=>{s[a]=this.convertValue(l,t)})),s}convertVectorValue(e){var t,s,a;const l=(a=(s=(t=e.fields)===null||t===void 0?void 0:t[Nu].arrayValue)===null||s===void 0?void 0:s.values)===null||a===void 0?void 0:a.map((d=>Xt(d.doubleValue)));return new Ss(l)}convertGeoPoint(e){return new Ts(Xt(e.latitude),Xt(e.longitude))}convertArray(e,t){return(e.values||[]).map((s=>this.convertValue(s,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const s=Yu(e);return s==null?null:this.convertValue(s,t);case"estimate":return this.convertTimestamp(Dl(e));default:return null}}convertTimestamp(e){const t=Oi(e);return new Ot(t.seconds,t.nanos)}convertDocumentKey(e,t){const s=Vt.fromString(e);Et(G0(s),9688,{name:e});const a=new Ll(s.get(1),s.get(3)),l=new ze(s.popFirst(5));return a.isEqual(t)||ei(`Document ${l} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rw(n,e,t){let s;return s=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,s}class _l{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ga extends Pw{constructor(e,t,s,a,l,d){super(e,t,s,a,d),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new _u(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const s=this._document.data.field(bw("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new De(ce.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=ga._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}ga._jsonSchemaVersion="firestore/documentSnapshot/1.0",ga._jsonSchema={type:sn("string",ga._jsonSchemaVersion),bundleSource:sn("string","DocumentSnapshot"),bundleName:sn("string"),bundle:sn("string")};class _u extends ga{data(e={}){return super.data(e)}}class mo{constructor(e,t,s,a){this._firestore=e,this._userDataWriter=t,this._snapshot=a,this.metadata=new _l(a.hasPendingWrites,a.fromCache),this.query=s}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((s=>{e.call(t,new _u(this._firestore,this._userDataWriter,s.key,s,new _l(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new De(ce.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(a,l){if(a._snapshot.oldDocs.isEmpty()){let d=0;return a._snapshot.docChanges.map((f=>{const m=new _u(a._firestore,a._userDataWriter,f.doc.key,f.doc,new _l(a._snapshot.mutatedKeys.has(f.doc.key),a._snapshot.fromCache),a.query.converter);return f.doc,{type:"added",doc:m,oldIndex:-1,newIndex:d++}}))}{let d=a._snapshot.oldDocs;return a._snapshot.docChanges.filter((f=>l||f.type!==3)).map((f=>{const m=new _u(a._firestore,a._userDataWriter,f.doc.key,f.doc,new _l(a._snapshot.mutatedKeys.has(f.doc.key),a._snapshot.fromCache),a.query.converter);let v=-1,w=-1;return f.type!==0&&(v=d.indexOf(f.doc.key),d=d.delete(f.doc.key)),f.type!==1&&(d=d.add(f.doc),w=d.indexOf(f.doc.key)),{type:oR(f.type),doc:m,oldIndex:v,newIndex:w}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new De(ce.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=mo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Zf.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],s=[],a=[];return this.docs.forEach((l=>{l._document!==null&&(t.push(l._document),s.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),a.push(l.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function oR(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ge(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Np(n){n=rs(n,an);const e=rs(n.firestore,Ia);return qb(Ip(e),n._key).then((t=>lR(e,n,t)))}mo._jsonSchemaVersion="firestore/querySnapshot/1.0",mo._jsonSchema={type:sn("string",mo._jsonSchemaVersion),bundleSource:sn("string","QuerySnapshot"),bundleName:sn("string"),bundle:sn("string")};class Aw extends aR{constructor(e){super(),this.firestore=e}convertBytes(e){return new Dr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new an(this.firestore,null,t)}}function Hs(n){n=rs(n,od);const e=rs(n.firestore,Ia),t=Ip(e),s=new Aw(e);return iR(n._query),Kb(t,n._query).then((a=>new mo(e,s,n,a)))}function Ks(n,e,t){n=rs(n,an);const s=rs(n.firestore,Ia),a=Rw(n.converter,e,t);return dd(s,[Tw(Pp(s),"setDoc",n._key,a,n.converter!==null,t).toMutation(n._key,Vr.none())])}function _s(n,e,t,...s){n=rs(n,an);const a=rs(n.firestore,Ia),l=Pp(a);let d;return d=typeof(e=on(e))=="string"||e instanceof ld?nR(l,"updateDoc",n._key,e,t,s):tR(l,"updateDoc",n._key,e),dd(a,[d.toMutation(n._key,Vr.exists(!0))])}function pa(n){return dd(rs(n.firestore,Ia),[new lp(n._key,Vr.none())])}function Ei(n,e){const t=rs(n.firestore,Ia),s=At(n),a=Rw(n.converter,e);return dd(t,[Tw(Pp(n.firestore),"addDoc",s._key,a,n.converter!==null,{}).toMutation(s._key,Vr.exists(!1))]).then((()=>s))}function dd(n,e){return(function(s,a){const l=new Ys;return s.asyncQueue.enqueueAndForget((async()=>Lb(await Gb(s),a,l))),l.promise})(Ip(n),e)}function lR(n,e,t){const s=t.docs.get(e._key),a=new Aw(n);return new ga(n,a,e._key,s,new _l(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cR(){return new Jl("deleteField")}function Uu(){return new bp("serverTimestamp")}(function(e,t=!0){(function(a){Ro=a})(Co),go(new va("firestore",((s,{instanceIdentifier:a,options:l})=>{const d=s.getProvider("app").getImmediate(),f=new Ia(new nC(s.getProvider("auth-internal")),new iC(d,s.getProvider("app-check-internal")),(function(v,w){if(!Object.prototype.hasOwnProperty.apply(v.options,["projectId"]))throw new De(ce.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ll(v.options.projectId,w)})(d,a),d);return l=Object.assign({useFetchStreams:t},l),f._setSettings(l),f}),"PUBLIC").setMultipleInstances(!0)),ki(Dy,Ly,e),ki(Dy,Ly,"esm2017")})();const uR={apiKey:"AIzaSyCOOnlmEcAcJywsS93LLfLSywy9ENqnppM",authDomain:"tyler-manga-library.firebaseapp.com",projectId:"tyler-manga-library",storageBucket:"tyler-manga-library.firebasestorage.app",messagingSenderId:"307412068362",appId:"1:307412068362:web:6cfe5666187439dfa757f3"},Nw=d_(uR),Lr=XI(Nw),tt=Yb(Nw),kw=j.createContext(null);function dR({children:n}){const[e,t]=j.useState(null),[s,a]=j.useState(!1),[l,d]=j.useState("viewer"),[f,m]=j.useState(!0),v=async C=>{if(!C)return null;const U=At(tt,"users",C.uid);let G=null;try{const O=await Np(U);O.exists()&&(G=O.data())}catch(O){console.warn("Failed to read user doc",O)}const K={role:((G==null?void 0:G.role)||"viewer").toLowerCase()==="admin"?"admin":"viewer",email:C.email||(G==null?void 0:G.email)||"",displayName:C.displayName||(G==null?void 0:G.displayName)||"",createdAt:(G==null?void 0:G.createdAt)||Uu()};try{await Ks(U,K,{merge:!0})}catch(O){console.error("Failed to ensure user doc",O)}return{...G,...K}};j.useEffect(()=>{const C=B1(Lr,async U=>{if(t(U),U)try{const G=await v(U),K=(G==null?void 0:G.role)||"viewer";d(K),a(K.toLowerCase()==="admin")}catch(G){console.error("Error checking role:",G),a(!1),d("viewer")}else a(!1),d("viewer");m(!1)});return()=>C()},[]);const w=async(C,U)=>{await F_(Lr,C,U)},E=async()=>{await U_(Lr)};return c.jsx(kw.Provider,{value:{user:e,admin:s,role:l,loading:f,login:w,logout:E},children:n})}function jo(){return j.useContext(kw)}function hR({onClose:n}){const[e,t]=j.useState("login"),[s,a]=j.useState(""),[l,d]=j.useState("");async function f(){try{await Y_(Lr,new es),n()}catch(w){alert(w.message)}}async function m(w){w.preventDefault();try{await F_(Lr,s,l),n()}catch(E){alert(E.message)}}async function v(w){w.preventDefault();try{await O1(Lr,s,l),n()}catch(E){alert(E.message)}}return c.jsx("div",{className:"auth-modal-backdrop",onClick:n,children:c.jsxs("div",{className:"auth-modal",onClick:w=>w.stopPropagation(),children:[c.jsx("h2",{className:"auth-title",children:e==="login"?"Sign In":"Create Account"}),c.jsxs("button",{className:"google-btn",onClick:f,children:[c.jsx("img",{src:"https://www.svgrepo.com/show/475656/google-color.svg",alt:"",className:"google-icon"}),"Continue with Google"]}),c.jsx("div",{className:"auth-divider",children:c.jsx("span",{children:"or"})}),c.jsxs("form",{onSubmit:e==="login"?m:v,className:"auth-form",children:[c.jsx("input",{type:"email",placeholder:"Email address",className:"auth-input",value:s,onChange:w=>a(w.target.value),required:!0}),c.jsx("input",{type:"password",placeholder:"Password",className:"auth-input",value:l,onChange:w=>d(w.target.value),required:!0}),c.jsx("button",{className:"auth-submit",children:e==="login"?"Sign In":"Create Account"})]}),c.jsx("div",{className:"auth-switcher",children:e==="login"?c.jsxs("p",{children:["No account?"," ",c.jsx("button",{onClick:()=>t("register"),children:"Register"})]}):c.jsxs("p",{children:["Already have an account?"," ",c.jsx("button",{onClick:()=>t("login"),children:"Sign in"})]})}),c.jsx("button",{className:"auth-close",onClick:n,children:"Close"})]})})}function fR(){var L,ee,se,R,J,me;const n="google.com",e="oidc.discord",[t,s]=j.useState(!1),[a,l]=j.useState(!1),[d,f]=j.useState(!1),[m,v]=j.useState(!1),[w,E]=j.useState(""),[C,U]=j.useState(""),[G,K]=j.useState(""),[O,re]=j.useState({google:!1,discord:!1}),[ye,ne]=j.useState(!1),[oe,Ee]=j.useState(!1),Se=j.useRef(null),{user:b,admin:A,role:k}=jo(),V=Bu();j.useEffect(()=>{var ie;f(!1),v(!1),U(""),K(""),Ee(!1),E((b==null?void 0:b.displayName)||((ie=b==null?void 0:b.email)==null?void 0:ie.split("@")[0])||"")},[b]);async function F(){try{await U_(Lr),s(!1),f(!1),V("/")}catch(ie){console.error(ie),alert("Logout failed.")}}const D=()=>{if(!b){s(!1),l(!0);return}f(!1),U(""),K(""),Ee(!1),v(!0)},I=async()=>{if(!b){s(!1),l(!0);return}const ie=(w||"").trim();if(!ie){U("Display name is required.");return}ne(!0),U(""),Ee(!1);try{await F1(Lr.currentUser,{displayName:ie}),await Ks(At(tt,"users",b.uid),{displayName:ie},{merge:!0}),U("Profile updated."),Ee(!1)}catch(Te){console.error("Failed to update profile",Te),U("Failed to update profile.")}finally{ne(!1)}},ge=ie=>{var Te;return!!((Te=b==null?void 0:b.providerData)!=null&&Te.some(Ce=>Ce.providerId===ie))},ve=async()=>{if(!b){s(!1),l(!0);return}if(ge(n)){K("Google is already connected.");return}re(ie=>({...ie,google:!0})),K("");try{const ie=new es,Te=await Iy(Lr.currentUser,ie);await Ks(At(tt,"users",b.uid),{connections:{[n]:{email:Te.user.email||"",connectedAt:Uu()}}},{merge:!0}),K("Google connected.")}catch(ie){console.error("Failed to link Google",ie);const Te=(ie==null?void 0:ie.code)==="auth/credential-already-in-use"?"That Google account is already linked elsewhere. Sign in with it instead.":"Could not connect Google.";K(Te)}finally{re(ie=>({...ie,google:!1}))}},lt=async()=>{if(!b){s(!1),l(!0);return}if(ge(e)){K("Discord is already connected.");return}re(ie=>({...ie,discord:!0})),K("");try{const ie=new Tl(e);ie.addScope("identify"),ie.addScope("email");const Ce=(await Iy(Lr.currentUser,ie)).user.providerData.find(Ze=>Ze.providerId===e);await Ks(At(tt,"users",b.uid),{connections:{[e]:{username:(Ce==null?void 0:Ce.displayName)||(Ce==null?void 0:Ce.uid)||"Discord",email:(Ce==null?void 0:Ce.email)||"",connectedAt:Uu()}}},{merge:!0}),K("Discord connected.")}catch(ie){console.error("Failed to link Discord",ie);const Te=(ie==null?void 0:ie.code)==="auth/credential-already-in-use"?"That Discord account is already linked elsewhere. Sign in with it instead.":"Could not connect Discord.";K(Te)}finally{re(ie=>({...ie,discord:!1}))}},Be=async ie=>{if(!b)return;if(b.providerData.length<=1){K("You need at least one sign-in method.");return}const Te=ie===n?"google":"discord";K(""),re(Ce=>({...Ce,[Te]:!0}));try{await k1(Lr.currentUser,ie),await Ks(At(tt,"users",b.uid),{connections:{[ie]:cR()}},{merge:!0}),K("Connection removed.")}catch(Ce){console.error("Failed to unlink",Ce),K("Could not remove connection.")}finally{re(Ce=>({...Ce,[Te]:!1}))}};return c.jsxs(c.Fragment,{children:[c.jsxs("button",{className:`menu-toggle ${t?"active":""}`,onClick:()=>s(!t),children:[c.jsx("span",{}),c.jsx("span",{}),c.jsx("span",{})]}),c.jsxs("nav",{className:`menu-panel ${t?"open":""}`,onMouseLeave:()=>f(!1),children:[c.jsx(ha,{to:"/",className:"menu-item",onClick:()=>s(!1),children:"Home"}),c.jsx(ha,{to:"/manga",className:"menu-item",onClick:()=>s(!1),children:"Manga"}),c.jsx(ha,{to:"/anime",className:"menu-item",onClick:()=>s(!1),children:"Anime"}),c.jsx(ha,{to:"/tcg",className:"menu-item",onClick:()=>s(!1),children:"TCG"}),c.jsx(ha,{to:"/music",className:"menu-item",onClick:()=>s(!1),children:"Music"}),c.jsx(ha,{to:"/steam",className:"menu-item",onClick:()=>s(!1),children:"Gaming"}),A&&c.jsx(ha,{to:"/dashboard",className:"menu-item",onClick:()=>s(!1),children:"Dashboard"}),c.jsxs("div",{className:"menu-footer",children:[c.jsx("div",{className:"profile-divider"}),c.jsxs("div",{className:"profile-card",onMouseEnter:()=>b&&f(!0),onMouseLeave:()=>f(!1),onClick:()=>{b?f(ie=>!ie):(f(!1),s(!1),l(!0))},role:"button",tabIndex:0,onKeyDown:ie=>{(ie.key==="Enter"||ie.key===" ")&&(ie.preventDefault(),b?f(Te=>!Te):(s(!1),l(!0)))},children:[c.jsx("div",{className:"profile-avatar",children:b?(((L=b.displayName)==null?void 0:L[0])||((ee=b.email)==null?void 0:ee[0])||((se=b.uid)==null?void 0:se[0])||"?").toUpperCase():"?"}),c.jsxs("div",{className:"profile-meta",children:[c.jsx("div",{className:"profile-name",children:(b==null?void 0:b.displayName)||(b==null?void 0:b.email)||"Guest"}),c.jsx("div",{className:"profile-role",children:b?A?"admin":k||"viewer":"Not signed in"})]}),b&&d&&c.jsxs("div",{className:"profile-menu",children:[c.jsx("button",{type:"button",className:"profile-menu-item",onClick:D,children:"Edit profile"}),c.jsx("button",{type:"button",className:"profile-menu-item",onClick:F,children:"Sign out"})]})]})]})]}),a&&c.jsx(hR,{onClose:()=>l(!1)}),m&&c.jsx("div",{className:"profile-edit-backdrop",children:c.jsxs("div",{className:"profile-edit-card",children:[c.jsxs("div",{className:"profile-edit-header",children:[c.jsx("h3",{children:"Edit profile"}),c.jsx("button",{type:"button",className:"profile-edit-close",onClick:()=>{v(!1),U(""),K(""),Ee(!1)},children:""})]}),c.jsxs("div",{className:"profile-edit-body",children:[c.jsx("div",{className:"profile-edit-avatar",children:b?(((R=b.displayName)==null?void 0:R[0])||((J=b.email)==null?void 0:J[0])||((me=b.uid)==null?void 0:me[0])||"?").toUpperCase():"?"}),c.jsxs("div",{className:"profile-edit-field",children:[c.jsx("label",{className:"profile-edit-label",htmlFor:"displayName",children:"Display name"}),c.jsxs("div",{className:"profile-edit-input-row",children:[c.jsx("input",{id:"displayName",className:"profile-edit-input",type:"text",readOnly:!oe,value:w,onChange:ie=>E(ie.target.value),maxLength:40,placeholder:"Enter display name",ref:Se,onBlur:()=>{oe&&I()},onKeyDown:ie=>{ie.key==="Enter"&&oe&&(ie.preventDefault(),I())}}),c.jsx("button",{type:"button",className:"profile-edit-pencil",onClick:()=>{Ee(!0),U(""),setTimeout(()=>{var ie;return(ie=Se.current)==null?void 0:ie.focus()},50)},"aria-label":"Edit display name",children:""})]}),c.jsx("div",{className:"profile-edit-hint",children:"Click the pencil to edit. Changes save on blur or Enter."})]})]}),c.jsxs("div",{className:"profile-connections",children:[c.jsxs("div",{className:"profile-connections-header",children:[c.jsx("span",{children:"Connections"}),G&&c.jsx("span",{className:"profile-connection-status",children:G})]}),c.jsxs("div",{className:"profile-connection-row",children:[c.jsxs("div",{className:"profile-connection-meta",children:[c.jsx("div",{className:"profile-connection-title",children:"Google"}),c.jsx("div",{className:"profile-connection-sub",children:ge(n)?"Connected":"Not connected"})]}),c.jsx("div",{className:"profile-connection-actions",children:ge(n)?c.jsx("button",{type:"button",className:"profile-connection-btn secondary",onClick:()=>Be(n),disabled:O.google,children:O.google?"Removing...":"Remove"}):c.jsx("button",{type:"button",className:"profile-connection-btn",onClick:ve,disabled:O.google,children:O.google?"Connecting...":"Connect"})})]}),c.jsxs("div",{className:"profile-connection-row",children:[c.jsxs("div",{className:"profile-connection-meta",children:[c.jsx("div",{className:"profile-connection-title",children:"Discord"}),c.jsx("div",{className:"profile-connection-sub",children:ge(e)?"Connected":"Not connected"})]}),c.jsx("div",{className:"profile-connection-actions",children:ge(e)?c.jsx("button",{type:"button",className:"profile-connection-btn secondary",onClick:()=>Be(e),disabled:O.discord,children:O.discord?"Removing...":"Remove"}):c.jsx("button",{type:"button",className:"profile-connection-btn",onClick:lt,disabled:O.discord,children:O.discord?"Connecting...":"Connect"})})]})]}),C&&c.jsx("div",{className:"profile-edit-status",children:C}),ye&&c.jsx("div",{className:"profile-edit-status saving",children:"Saving..."})]})})]})}function Av(){const n="Tyler's Collection's and Hobbies",e="",[t,s]=j.useState(""),[a,l]=j.useState(!0),d=j.useRef(null),[f,m]=j.useState("jp"),[v,w]=j.useState(1);return j.useEffect(()=>{document.title="Tyler's Collection"},[]),j.useEffect(()=>(d.current=setInterval(()=>l(E=>!E),450),()=>{d.current&&clearInterval(d.current)}),[]),j.useEffect(()=>{let E=!1;const C=K=>new Promise(O=>setTimeout(O,K)),U=async(K,O=120)=>{for(let re=1;re<=K.length;re+=1){if(E)return;s(K.slice(0,re)),await C(O)}},G=async(K,O=70)=>{for(let re=K.length;re>=0;re-=1){if(E)return;s(K.slice(0,re)),await C(O)}};return(async()=>{if(localStorage.getItem("homeTitleTyped")==="1"){m("en"),s(n),l(!1),d.current&&clearInterval(d.current);return}await C(250),m("jp"),await U(e,140),await C(6e3),await G(e,80),await C(320);const O=n;for(let re=1;re<=O.length;re+=1){if(E)return;s(O.slice(0,re)),re===4&&m("en"),await C(110)}m("en"),await C(2e3),l(!1),localStorage.setItem("homeTitleTyped","1"),d.current&&clearInterval(d.current)})(),()=>{E=!0}},[]),c.jsxs("main",{className:"page",children:[c.jsxs("header",{style:{textAlign:"center",marginTop:"32px",marginBottom:"24px"},children:[c.jsxs("h1",{style:{margin:0,fontSize:"2.2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",display:"inline-flex",alignItems:"center",gap:"6px"},children:[c.jsx("span",{children:t||" "}),c.jsx("span",{style:{width:"6px",height:"1.1em",background:"#ffb6c1",opacity:a?1:0,transition:"opacity 0.15s ease"}})]}),c.jsx("p",{style:{margin:"6px 0 0",color:"var(--text-soft)",fontSize:"0.95rem",opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"TCG":"This is my personal webpage to see what is on my shelves, wishlists, and TCG collections."}),c.jsx("div",{style:{display:"inline-flex",alignItems:"center",gap:"10px",padding:"8px 14px",borderRadius:"999px",border:"1px solid rgba(255,182,193,0.5)",background:"linear-gradient(135deg, rgba(255,182,193,0.18), rgba(43,15,29,0.9))",boxShadow:"0 8px 24px rgba(0,0,0,0.55)",marginTop:"14px",fontSize:"0.78rem",color:"#ffe6ed",letterSpacing:"0.05em",textTransform:"uppercase",fontWeight:700,opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?c.jsx("span",{style:{letterSpacing:"0.06em"},children:"    TCG"}):c.jsx("span",{style:{letterSpacing:"0.06em"},children:"Manga  Anime  TCG"})})]}),c.jsxs("section",{style:{display:"grid",gridTemplateColumns:"minmax(0, 2fr) minmax(0, 3fr)",gap:"20px",marginTop:"24px"},children:[c.jsxs("article",{className:"card",children:[c.jsx("h2",{style:{marginTop:0,marginBottom:"8px",fontSize:"1.2rem",color:"#ffb6c1"},children:c.jsx("span",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"About Me"})}),c.jsx("p",{style:{margin:0,color:"var(--text-soft)",fontSize:"0.9rem",lineHeight:1.5,opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"im.okTCG":"Hey, I am Tyler and I go by im.ok. I hoard manga, binge anime, and collect trading cards."}),c.jsx("p",{style:{marginTop:"10px",color:"var(--text-soft)",fontSize:"0.9rem",opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"TCG":"This site is where I track everything: volumes on my shelves, finished shows, and my TCG collection as they all slowly grow."}),c.jsxs("div",{style:{marginTop:"12px",display:"flex",flexWrap:"wrap",gap:"6px",opacity:v,transition:"opacity 0.25s ease"},children:[c.jsx("span",{className:"pill",children:f==="jp"?"":"Manga library"}),c.jsx("span",{className:"pill",children:f==="jp"?"":"My Anime List (MAL)"}),c.jsx("span",{className:"pill",children:f==="jp"?" & TCG":"Pokemon & One Piece TCG"}),c.jsx("span",{className:"pill",children:f==="jp"?"":"Data Nerd"})]})]}),c.jsxs("article",{className:"card",children:[c.jsx("h2",{style:{marginTop:0,marginBottom:"8px",fontSize:"1.2rem",color:"#ffb6c1"},children:c.jsx("span",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Explore these pages"})}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(210px, 1fr))",gap:"14px",marginTop:"10px"},children:[c.jsxs("a",{href:"/base/manga",className:"section-card",children:[c.jsx("h3",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Manga Library"}),c.jsx("p",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Full manga collection & wishlist."}),c.jsx("div",{className:"section-chip-row",children:c.jsx("span",{className:"section-chip accent",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Library & wishlist"})})]}),c.jsxs("a",{href:"/base/music",className:"section-card",style:{justifySelf:"end",alignSelf:"end",order:99},children:[c.jsx("h3",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Music"}),c.jsx("p",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"If you are here for my music, this is the page for you! Catch all the latest releases."}),c.jsxs("div",{className:"section-chip-row",children:[c.jsx("span",{className:"section-chip accent",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Latest tracks"}),c.jsx("span",{className:"section-chip",style:{opacity:v,transition:"opacity 0.25s ease"},children:"Spotify & SoundCloud"})]})]}),c.jsxs("a",{href:"/base/anime",className:"section-card",children:[c.jsx("h3",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Anime Library"}),c.jsx("p",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"MAL":"The entire watched, plan to watch, and watching list synced directly from MyAnimeList."}),c.jsxs("div",{className:"section-chip-row",children:[c.jsx("span",{className:"section-chip accent",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"MAL":"MAL synced"}),c.jsx("span",{className:"section-chip",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Status filters"}),c.jsx("span",{className:"section-chip",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Quick stats"})]})]}),c.jsxs("a",{href:"/base/tcg",className:"section-card",children:[c.jsx("h3",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"TCG":"TCG Collection"}),c.jsx("p",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"TCG":"Pokemon & One Piece TCG cards tracked with quantities, prices, and value."}),c.jsxs("div",{className:"section-chip-row",children:[c.jsx("span",{className:"section-chip accent",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Full Collection"}),c.jsx("span",{className:"section-chip",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Still Under-Construction"})]})]})]})]})]}),c.jsx("footer",{style:{marginTop:"28px",fontSize:"0.78rem",color:"var(--text-soft)",textAlign:"center"},children:"@ 2025 im.ok. All rights reserved."})]})}const pR="modulepreload",mR=function(n){return"/base/"+n},Nv={},Xl=function(e,t,s){let a=Promise.resolve();if(t&&t.length>0){let d=function(v){return Promise.all(v.map(w=>Promise.resolve(w).then(E=>({status:"fulfilled",value:E}),E=>({status:"rejected",reason:E}))))};document.getElementsByTagName("link");const f=document.querySelector("meta[property=csp-nonce]"),m=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));a=d(t.map(v=>{if(v=mR(v),v in Nv)return;Nv[v]=!0;const w=v.endsWith(".css"),E=w?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${v}"]${E}`))return;const C=document.createElement("link");if(C.rel=w?"stylesheet":pR,w||(C.as="script"),C.crossOrigin="",C.href=v,m&&C.setAttribute("nonce",m),document.head.appendChild(C),w)return new Promise((U,G)=>{C.addEventListener("load",U),C.addEventListener("error",()=>G(new Error(`Unable to preload CSS for ${v}`)))})}))}function l(d){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=d,window.dispatchEvent(f),!f.defaultPrevented)throw d}return a.then(d=>{for(const f of d||[])f.status==="rejected"&&l(f.reason);return e().catch(l)})};function jw({open:n,title:e,placeholder:t,value:s,status:a,loading:l,onChange:d,onSubmit:f,onClose:m}){if(!n)return null;const v=typeof a=="string"&&a.toLowerCase().startsWith("sent!")?"#a3f0cf":"#ffb6c1";return c.jsx("div",{className:"suggestion-backdrop",onClick:w=>{w.target===w.currentTarget&&m&&m()},children:c.jsxs("div",{className:"suggestion-modal",children:[c.jsxs("div",{className:"suggestion-modal-header",children:[c.jsx("h3",{children:e}),c.jsx("button",{className:"suggestion-close",type:"button",onClick:m,children:"Close"})]}),c.jsx("p",{className:"suggestion-hint",children:"Tell me what to add next. Titles only is fine, but extra notes are welcome."}),c.jsx("textarea",{className:"suggestion-textarea",placeholder:t,value:s,onChange:w=>d==null?void 0:d(w.target.value),maxLength:500}),a&&c.jsx("div",{className:"suggestion-status",style:{color:v},children:a}),c.jsxs("div",{className:"suggestion-actions",children:[c.jsx("button",{className:"suggestion-send",type:"button",onClick:f,disabled:l,children:l?"Sending...":"Send Suggestion"}),c.jsx("button",{className:"suggestion-cancel",type:"button",onClick:m,children:"Cancel"})]})]})})}const kv=5,gR=3600*1e3,jv="mangaSuggestionsSent";function Xr(n){let e=(n||"").trim();const t=e.match(/^(.*?)(?:,?\s*(?:Vol\.|Volume)\s*(\d+)(?:\s*[--]\s*\d+)?\s*)?(?:\s*\([^)]*\))?$/i),s=t?t[1].trim().toLowerCase():e.toLowerCase(),a=t&&t[2]?parseInt(t[2],10):0;return{name:s,vol:Number.isFinite(a)?a:0}}function yR(){const{admin:n,user:e,role:t}=jo(),s=n,[a,l]=j.useState("library");j.useEffect(()=>{document.title="Manga | Library"},[]),j.useEffect(()=>{Ke("")},[e]);const d=async()=>{const P=Date.now(),le=(()=>{try{const $=localStorage.getItem(jv);return Array.isArray(JSON.parse($))?JSON.parse($):[]}catch{return[]}})().filter($=>P-$<gR);if(le.length>=kv){Ke("Rate limit: please wait a bit (max 5 suggestions per hour).");return}if(!Te.trim()){Ke("Please enter a manga title or note before sending.");return}jt(!0),Ke("");try{const $=`**Manga Suggestion**
${Te.trim()}
From: ${(e==null?void 0:e.displayName)||(e==null?void 0:e.email)||(e==null?void 0:e.uid)||"anonymous user"}`;await Ei(Hn(tt,"suggestions"),{content:Te.trim(),type:"manga",from:(e==null?void 0:e.displayName)||(e==null?void 0:e.email)||(e==null?void 0:e.uid)||"anonymous user",createdAt:new Date().toISOString()}),Ke("Sent! I'll review your suggestion soon."),Ce("");const Y=[...le,P].slice(-kv);localStorage.setItem(jv,JSON.stringify(Y))}catch($){console.error("Failed to send suggestion",$),Ke("Failed to send suggestion. Please try again later.")}finally{jt(!1)}},[f,m]=j.useState([]),[v,w]=j.useState([]),[E,C]=j.useState([]),[U,G]=j.useState([]),[K,O]=j.useState(!1),[re,ye]=j.useState(!0),[ne,oe]=j.useState(""),[Ee,Se]=j.useState(""),[b,A]=j.useState(""),[k,V]=j.useState(!1),[F,D]=j.useState(()=>new Set),[I,ge]=j.useState(null),[ve,lt]=j.useState({open:!1,mode:"add",list:"library",data:{title:"",authors:"",publisher:"",demographic:"",genre:"",subGenre:"",date:"",cover:"",isbn:"",pageCount:"",rating:"",amountPaid:"",dateRead:"",datePurchased:"",msrp:"",special:!1,specialType:"",specialVolumes:"",collectiblePrice:"",amazonURL:"",read:!1},editingId:null,multiAdd:!1,startVol:"",endVol:""}),[Be,L]=j.useState([]),[ee,se]=j.useState(0),[R,J]=j.useState({open:!1,index:0,items:[]}),[me,ie]=j.useState(!1),[Te,Ce]=j.useState(""),[Ze,Ke]=j.useState(""),[ot,jt]=j.useState(!1),de=!!e&&t==="viewer";async function ke(){const P=await Hs(Hn(tt,"library")),Z=[];P.forEach(le=>{const $=le.data();Z.push({id:le.id,title:$.title||"",authors:$.authors||"Unknown",publisher:$.publisher||"Unknown",demographic:$.demographic||"",genre:$.genre||"",subGenre:$.subGenre||"",date:$.date||"Unknown",cover:$.cover||"",isbn:$.isbn||"",pageCount:$.pageCount!==void 0&&$.pageCount!==null?$.pageCount:"",rating:$.rating!==void 0&&$.rating!==null?$.rating:"",amountPaid:$.amountPaid!==void 0&&$.amountPaid!==null?$.amountPaid:"",dateRead:$.dateRead||"",datePurchased:$.datePurchased||"",msrp:$.msrp!==void 0&&$.msrp!==null?$.msrp:"",specialType:$.specialType||"",specialVolumes:$.specialVolumes!==void 0&&$.specialVolumes!==null?$.specialVolumes:"",collectiblePrice:$.collectiblePrice!==void 0&&$.collectiblePrice!==null?$.collectiblePrice:"",read:!!$.read,amazonURL:$.amazonURL||"",hidden:!!$.hidden,kind:"library"})}),Z.sort((le,$)=>{const Y=Xr(le.title),Le=Xr($.title),Oe=Y.name.localeCompare(Le.name);return Oe!==0?Oe:Y.vol-Le.vol}),m(Z),C(le=>{const $=new Set(le);return Z.forEach(Y=>$.add(Y.title||"")),Array.from($).filter(Boolean).sort()})}async function Me(){const P=await Hs(Hn(tt,"wishlist")),Z=[];P.forEach(le=>{const $=le.data();Z.push({id:le.id,title:$.title||"",authors:$.authors||"Unknown",publisher:$.publisher||"Unknown",date:$.date||"Unknown",cover:$.cover||"",isbn:$.isbn||"",pageCount:$.pageCount!==void 0&&$.pageCount!==null?$.pageCount:"",rating:$.rating!==void 0&&$.rating!==null?$.rating:"",amountPaid:$.amountPaid!==void 0&&$.amountPaid!==null?$.amountPaid:"",specialType:$.specialType||"",specialVolumes:$.specialVolumes!==void 0&&$.specialVolumes!==null?$.specialVolumes:"",collectiblePrice:$.collectiblePrice!==void 0&&$.collectiblePrice!==null?$.collectiblePrice:"",amazonURL:$.amazonURL||"",hidden:!!$.hidden,kind:"wishlist"})}),Z.sort((le,$)=>{const Y=Xr(le.title),Le=Xr($.title),Oe=Y.name.localeCompare(Le.name);return Oe!==0?Oe:Y.vol-Le.vol}),w(Z),C(le=>{const $=new Set(le);return Z.forEach(Y=>$.add(Y.title||"")),Array.from($).filter(Boolean).sort()})}j.useEffect(()=>{let P=!1;const Z=async()=>{if(!P)try{const Y=await fetch("/base/manga-library-wishlist.json",{cache:"no-cache"});if(!Y.ok)throw new Error("fallback fetch failed");const Le=await Y.json(),Oe=Array.isArray(Le.library)?Le.library:[],Rt=Array.isArray(Le.wishlist)?Le.wishlist:[];m(Oe.map((xe,Ye)=>({id:xe.id||`offline-lib-${Ye}`,title:xe.title||"",authors:xe.authors||"Unknown",publisher:xe.publisher||"Unknown",demographic:xe.demographic||"",genre:xe.genre||"",subGenre:xe.subGenre||"",date:xe.date||"Unknown",cover:xe.cover||"",isbn:xe.isbn||"",pageCount:xe.pageCount??"",rating:xe.rating??"",amountPaid:xe.amountPaid??"",dateRead:xe.dateRead||"",datePurchased:xe.datePurchased||"",msrp:xe.msrp??"",specialType:xe.specialType||"",specialVolumes:xe.specialVolumes??"",collectiblePrice:xe.collectiblePrice??"",amazonURL:xe.amazonURL||"",read:!!xe.read,hidden:!!xe.hidden,kind:"library"}))),w(Rt.map((xe,Ye)=>({id:xe.id||`offline-wish-${Ye}`,title:xe.title||"",authors:xe.authors||"Unknown",publisher:xe.publisher||"Unknown",demographic:xe.demographic||"",genre:xe.genre||"",subGenre:xe.subGenre||"",date:xe.date||"Unknown",cover:xe.cover||"",isbn:xe.isbn||"",pageCount:xe.pageCount??"",rating:xe.rating??"",amountPaid:xe.amountPaid??"",dateRead:xe.dateRead||"",datePurchased:xe.datePurchased||"",msrp:xe.msrp??"",specialType:xe.specialType||"",specialVolumes:xe.specialVolumes??"",collectiblePrice:xe.collectiblePrice??"",amazonURL:xe.amazonURL||"",read:!!xe.read,hidden:!!xe.hidden,kind:"wishlist"}))),oe("")}catch($){console.error("Offline fallback failed",$),oe("Failed to load manga data from Firestore.")}finally{P||ye(!1)}};async function le(){ye(!0),oe("");try{await Promise.all([ke(),Me()]),P||ye(!1)}catch($){console.error($),P||(console.warn("Falling back to offline JSON for manga."),await Z())}}return le(),()=>{P=!0}},[e]);const Ue=j.useMemo(()=>{const P=Ee.trim().toLowerCase();return P?f.filter(Z=>[Z.title,Z.authors,Z.publisher,Z.isbn,Z.date,String(Z.pageCount??"")].join(" ").toLowerCase().includes(P)):f},[f,Ee]),Tt=j.useMemo(()=>s&&K?Ue:Ue.filter(P=>!P.hidden),[Ue,s,K]),Ct=j.useMemo(()=>{const P=b.trim().toLowerCase();return P?v.filter(Z=>[Z.title,Z.authors,Z.publisher,Z.isbn,Z.date,String(Z.pageCount??"")].join(" ").toLowerCase().includes(P)):v},[v,b]),Pt=j.useMemo(()=>s&&K?Ct:Ct.filter(P=>!P.hidden),[Ct,s,K]);function bt(){s&&(V(P=>!P),D(new Set))}function zt(P){D(Z=>{const le=new Set(Z);return le.has(P)?le.delete(P):le.add(P),le})}async function St(P){if(!s){alert("Multi-select actions require admin access.");return}const Z=Array.from(F);if(!Z.length){alert("Select at least one item first.");return}const le=a==="library";try{if(P==="move")if(le){if(!window.confirm(`Move ${Z.length} item(s) to Wishlist?`))return;for(const $ of Z){const Y=f.find(Oe=>Oe.id===$);if(!Y)continue;const Le={title:Y.title,authors:Y.authors,publisher:Y.publisher,date:Y.date,pageCount:Y.pageCount||"",cover:Y.cover,amazonURL:Y.amazonURL||"",hidden:!!Y.hidden};await Ei(Hn(tt,"wishlist"),Le),await pa(At(tt,"library",$))}}else{if(!window.confirm(`Move ${Z.length} item(s) to Library?`))return;for(const $ of Z){const Y=v.find(Oe=>Oe.id===$);if(!Y)continue;const Le={title:Y.title,authors:Y.authors,publisher:Y.publisher,date:Y.date,pageCount:Y.pageCount||"",cover:Y.cover,amountPaid:"",read:!1,rating:"",msrp:"",collectiblePrice:"",specialType:"",specialVolumes:"",isbn:"",demographic:"",genre:"",subGenre:"",hidden:!!Y.hidden};await Ei(Hn(tt,"library"),Le),await pa(At(tt,"wishlist",$))}}else if(P==="markRead"&&le)for(const $ of Z)await _s(At(tt,"library",$),{read:!0,dateRead:new Date().toISOString().slice(0,10)});else if(P==="markUnread"&&le)for(const $ of Z)await _s(At(tt,"library",$),{read:!1,dateRead:"",rating:""});else if(P==="delete"){const $=le?"library":"wishlist";if(!window.confirm(`Delete ${Z.length} item(s) from ${le?"Library":"Wishlist"}?`))return;for(const Y of Z)await pa(At(tt,$,Y))}await Promise.all([ke(),Me()]),D(new Set),V(!1)}catch($){console.error($),alert("Failed to apply multi-select action.")}}function Sn(P){ge(P)}function ln(){ge(null)}const vn=()=>{lt(P=>({...P,open:!1,mode:"add",editingId:null,data:{title:"",authors:"",publisher:"",demographic:"",genre:"",subGenre:"",date:"",cover:"",isbn:"",pageCount:"",rating:"",amountPaid:"",dateRead:"",datePurchased:"",msrp:"",special:!1,specialType:"",specialVolumes:"",collectiblePrice:"",amazonURL:"",read:!1,hidden:!1},multiAdd:!1,startVol:"",endVol:""})),L([]),se(0)},Qt=j.useMemo(()=>{const P=new Map;return[...f,...v].forEach(Z=>{const le=Xr(Z.title||"");if(!le.name)return;const $=(Z.title||"").replace(/,?\s*Vol\.?\s*\d+.*/i,"").trim()||Z.title||le.name;if(!P.has(le.name))P.set(le.name,{display:$,maxVol:le.vol,authors:Z.authors||"",publisher:Z.publisher||"",demographic:Z.demographic||""});else{const Y=P.get(le.name);Y.maxVol=Math.max(Y.maxVol,le.vol),!Y.authors&&Z.authors&&(Y.authors=Z.authors),!Y.publisher&&Z.publisher&&(Y.publisher=Z.publisher),!Y.demographic&&Z.demographic&&(Y.demographic=Z.demographic)}}),P},[f,v]),Mr=P=>{lt(Z=>({...Z,open:!0,mode:"add",list:P,editingId:null,data:{...Z.data,title:"",list:P}})),L([{kind:"new",id:null,data:{title:"",authors:"",publisher:"",demographic:"",genre:"",subGenre:"",date:"",cover:"",isbn:"",pageCount:"",rating:"",amountPaid:"",dateRead:"",datePurchased:"",msrp:"",specialType:"",specialVolumes:"",collectiblePrice:"",amazonURL:"",read:!1}}]),se(0)},Bt=P=>{const Z={open:!0,mode:"edit",list:P.kind==="wishlist"?"wishlist":"library",editingId:P.id,data:{title:P.title||"",authors:P.authors||"",publisher:P.publisher||"",demographic:P.demographic||"",genre:P.genre||"",subGenre:P.subGenre||"",date:P.date||"",cover:P.cover||"",isbn:P.isbn||"",pageCount:P.pageCount||"",rating:P.rating||"",amountPaid:P.amountPaid||"",dateRead:P.dateRead||"",datePurchased:P.datePurchased||"",msrp:P.msrp||"",special:!!(P.specialType||P.specialVolumes||P.collectiblePrice),specialType:P.specialType||"",specialVolumes:P.specialVolumes||"",collectiblePrice:P.collectiblePrice||"",amazonURL:P.amazonURL||"",read:!!P.read,hidden:!!P.hidden}};lt(Z),L([{kind:"edit",id:P.id,data:{...Z.data}}]),se(0)},Qe=(P,Z,le="text")=>{if(lt($=>{const Y={...$.data,[P]:le==="checkbox"?!!Z:Z};if(P==="special"&&!Z&&(Y.specialType="",Y.specialVolumes="",Y.collectiblePrice=""),P==="specialType"&&(Z==="collectible"?Y.specialVolumes="":(Z==="specialEdition"||(Y.specialVolumes=""),Y.collectiblePrice="")),P==="title"){const Le=Xr(Z||"");if(Le.name&&Qt.has(Le.name)){const Oe=Qt.get(Le.name);Y.authors=Oe.authors||Y.authors,Y.publisher=Oe.publisher||Y.publisher,Y.demographic=Oe.demographic||Y.demographic}}return{...$,data:Y}}),L($=>{if(!$.length)return $;const Y=[...$],Le={...Y[ee]};return Le.data={...Le.data,[P]:le==="checkbox"?!!Z:Z},Y[ee]=Le,Y}),P==="title"){const $=String(Z||"").trim().toLowerCase();if(!$)G([]);else{const Y=[];Qt.forEach(Le=>{if(Le.display.toLowerCase().includes($)){const Oe=Le.maxVol>0?Le.maxVol+1:1;Y.push(`${Le.display}, Vol. ${Oe}`)}}),G(Y.slice(0,6))}}},nr=P=>{Be[P]&&(se(P),lt(Z=>{const le=Be[P];return{...Z,data:{...le.data}}}))},bs=()=>{const P=ve.data.title||"",Z=Xr(P);if(!Z.name){alert("Provide a title with a volume number first (e.g., Series, Vol. 1).");return}const le=P.replace(/,?\s*Vol\.?\s*\d+.*/i,"").trim()||P;let $=Z.vol||0;const Y=Qt.get(Z.name);Y&&Y.maxVol>$&&($=Y.maxVol),Be.forEach(xe=>{const Ye=Xr(xe.data.title||"");Ye.name===Z.name&&($=Math.max($,Ye.vol||0))});const Le=($||0)+1,Rt={title:`${le}, Vol. ${Le}`,authors:ve.data.authors,publisher:ve.data.publisher,demographic:ve.data.demographic,genre:ve.data.genre,subGenre:ve.data.subGenre,msrp:ve.data.msrp,hidden:ve.data.hidden,cover:"",isbn:"",pageCount:"",rating:"",amountPaid:"",date:"",dateRead:"",datePurchased:"",special:!1,specialType:"",specialVolumes:"",collectiblePrice:"",amazonURL:"",read:!1};L(xe=>{const Ye=[...xe,{kind:"new",id:null,data:Rt}];return se(Ye.length-1),Ye}),lt(xe=>({...xe,mode:"add",data:Rt}))};async function fr(){if(!s)return;const{list:P}=ve,Z=P||"library",le=Be.length>0?Be:[{kind:ve.mode,id:ve.editingId,data:ve.data}],$=Y=>({title:(Y.title||"").trim(),authors:(Y.authors||"").trim(),publisher:(Y.publisher||"").trim(),demographic:(Y.demographic||"").trim(),genre:(Y.genre||"").trim(),subGenre:(Y.subGenre||"").trim(),date:(Y.date||"").trim(),cover:(Y.cover||"").trim(),isbn:Z==="wishlist"?"":(Y.isbn||"").trim(),pageCount:Y.pageCount===""?"":Number(Y.pageCount),rating:Z==="wishlist"||Y.rating===""?"":Math.max(.5,Math.min(5,Number(Y.rating))),amountPaid:Y.amountPaid===""?"":Number(Y.amountPaid),dateRead:(Y.dateRead||"").trim(),datePurchased:(Y.datePurchased||"").trim(),msrp:Z==="wishlist"||Y.msrp===""?"":Number(Y.msrp),special:Z==="wishlist"?!1:!!(Y.special&&(Y.specialType||"").trim()),specialType:Z==="wishlist"||!(Y.special&&(Y.specialType||"").trim())?"":(Y.specialType||"").trim(),specialVolumes:Z==="wishlist"?"":Y.special&&Y.specialType==="specialEdition"?Y.specialVolumes===""?"":Number(Y.specialVolumes):"",collectiblePrice:Z==="wishlist"?"":Y.special&&Y.specialType==="collectible"?Y.collectiblePrice===""?"":Number(Y.collectiblePrice):"",amazonURL:(Y.amazonURL||"").trim(),read:Z==="wishlist"?!1:!!Y.read,hidden:!!Y.hidden,kind:P});try{const Y=[];for(const Le of le){const Oe=$(Le.data);if(Z==="library"&&Le.kind!=="edit"){const Rt=Xr(Oe.title).name,xe=f.filter(mt=>Xr(mt.title||mt.Title||"").name===Rt),Ye=xe[0];if(Ye&&(Oe.demographic=Oe.demographic||Ye.demographic||Ye.Demographic||"",Oe.genre=Oe.genre||Ye.genre||Ye.Genre||"",Oe.subGenre=Oe.subGenre||Ye.subGenre||Ye.SubGenre||"",Oe.msrp==="")){const mt=xe.map(Cn=>Number(Cn.msrp??Cn.MSRP)).filter(Cn=>Number.isFinite(Cn));mt.length>0&&mt.every(Vn=>Vn===mt[0])&&(Oe.msrp=mt[0])}}if(!Oe.title){alert("Title is required for every entry.");return}Le.kind==="edit"&&Le.id?Y.push(_s(At(tt,Z,Le.id),Oe)):Y.push(Ei(Hn(tt,Z),Oe))}await Promise.all(Y),await Promise.all([ke(),Me()]),vn()}catch(Y){console.error(Y),alert("Failed to save entry.")}}async function pr(P,Z){if(s&&window.confirm("Delete this entry?"))try{await pa(At(tt,Z,P)),await Promise.all([ke(),Me()])}catch(le){console.error(le),alert("Failed to delete entry.")}}const[Kn,ss]=j.useState(!1),In=()=>J({open:!1,index:0,items:[]});async function is(P,Z){if(!(P!=null&&P.id))return;const le=P.kind==="wishlist"?"wishlist":"library";ss(!0);try{await _s(At(tt,le,P.id),Z),await Promise.all([ke(),Me()]),ge($=>$&&$.id===P.id?{...$,...Z}:$)}catch($){console.error($),alert("Failed to update entry.")}finally{ss(!1)}}const Rs=(P,Z)=>{const le=Z===""?"":Math.max(.5,Math.min(5,Number(Z)));is(P,{rating:le})},As=(P,Z)=>{if(!P)return;const le=Z?{read:!0,dateRead:new Date().toISOString().slice(0,10)}:{read:!1,dateRead:""};is(P,le)},cn=()=>{if(!F.size){alert("Select at least one entry first.");return}const Z=[...f,...v].filter($=>F.has($.id));if(!Z.length){alert("No items selected.");return}const le=Z.map($=>({id:$.id,kind:$.kind||(a==="wishlist"?"wishlist":"library"),data:{title:$.title||"",authors:$.authors||"",publisher:$.publisher||"",demographic:$.demographic||"",genre:$.genre||"",subGenre:$.subGenre||"",date:$.date||"",cover:$.cover||"",isbn:$.isbn||"",pageCount:$.pageCount||"",rating:$.rating||"",amountPaid:$.amountPaid||"",dateRead:$.dateRead||"",datePurchased:$.datePurchased||"",msrp:$.msrp||"",special:!!($.specialType||$.specialVolumes||$.collectiblePrice),specialType:$.specialType||"",specialVolumes:$.specialVolumes||"",collectiblePrice:$.collectiblePrice||"",amazonURL:$.amazonURL||"",read:!!$.read,hidden:!!$.hidden}}));J({open:!0,index:0,items:le})},ct=(P,Z,le="text")=>{J($=>{const Y=[...$.items],Le={...Y[$.index]},Oe={...Le.data,[P]:le==="checkbox"?!!Z:Z};return P==="special"&&!Z&&(Oe.specialType="",Oe.specialVolumes="",Oe.collectiblePrice=""),P==="specialType"&&(Z==="collectible"?Oe.specialVolumes="":(Z==="specialEdition"||(Oe.specialVolumes=""),Oe.collectiblePrice="")),Le.data=Oe,Y[$.index]=Le,{...$,items:Y}})},mr=()=>{J(P=>({...P,index:Math.min(P.index+1,P.items.length-1)}))},Dn=()=>{J(P=>({...P,index:Math.max(P.index-1,0)}))};async function en(){if(!s)return;const P=R.items;if(!P.length){In();return}try{const Z=P.map(le=>{const Y=!(le.kind==="wishlist")&&!!(le.data.special&&(le.data.specialType||"").trim()),Le={...le.data,pageCount:le.data.pageCount===""?"":Number(le.data.pageCount),rating:le.data.rating===""?"":Math.max(.5,Math.min(5,Number(le.data.rating))),amountPaid:le.data.amountPaid===""?"":Number(le.data.amountPaid),msrp:le.data.msrp===""?"":Number(le.data.msrp),special:Y,specialType:Y?le.data.specialType:"",collectiblePrice:Y&&le.data.specialType==="collectible"?le.data.collectiblePrice===""?"":Number(le.data.collectiblePrice):"",specialVolumes:Y&&le.data.specialType==="specialEdition"?le.data.specialVolumes===""?"":Number(le.data.specialVolumes):"",amazonURL:le.data.amazonURL||"",read:!!le.data.read},Oe=le.kind==="wishlist"?"wishlist":"library";return _s(At(tt,Oe,le.id),Le)});await Promise.all(Z),await Promise.all([ke(),Me()]),D(new Set),V(!1),In()}catch(Z){console.error(Z),alert("Failed to save bulk edits.")}}function un(P){const Z=F.has(P.id),le=P.kind==="library",$=()=>{k&&s?zt(P.id):Sn(P)};return c.jsxs("div",{className:"manga-card"+(P.read&&le?" read":"")+(Z?" multiselect-selected":""),onClick:$,children:[c.jsx("div",{className:"manga-card-cover-wrap",children:c.jsx("img",{src:P.cover||"https://imgur.com/chUgq4W.png",alt:"Cover",loading:"lazy",decoding:"async"})}),c.jsxs("div",{className:"manga-card-body",children:[c.jsx("div",{className:"manga-card-title",children:P.title||"Untitled"}),c.jsxs("div",{className:"manga-card-meta",children:[P.authors&&P.authors!=="Unknown"&&c.jsxs(c.Fragment,{children:[P.authors,c.jsx("br",{})]}),P.publisher&&P.publisher!=="Unknown"&&c.jsxs(c.Fragment,{children:[P.publisher,c.jsx("br",{})]}),P.date&&P.date!=="Unknown"&&P.date]}),P.isbn&&c.jsxs("div",{className:"manga-card-isbn",children:["ISBN: ",P.isbn]}),s&&c.jsxs("div",{className:"manga-card-actions",children:[c.jsx("button",{type:"button",className:"manga-btn mini",onClick:Y=>{Y.stopPropagation(),Bt(P)},children:"Edit"}),c.jsx("button",{type:"button",className:"manga-btn mini danger",onClick:Y=>{Y.stopPropagation(),pr(P.id,P.kind==="wishlist"?"wishlist":"library")},children:"Delete"})]})]})]},P.id)}const dn=({value:P,onChange:Z})=>{const[le,$]=j.useState(null),Y=Math.max(0,Math.min(5,Number(P)||0)),Le=le??Y,Oe=Array.from({length:10},(Ye,mt)=>(mt+1)*.5),Rt=5,xe=Array.from({length:Rt},(Ye,mt)=>Math.max(0,Math.min(1,Le-mt)));return c.jsxs("div",{className:"star-shell",role:"group","aria-label":"Rating",children:[c.jsxs("div",{className:"star-visual",style:{"--star-count":Rt},children:[c.jsx("div",{className:"star-row",children:xe.map((Ye,mt)=>c.jsxs("div",{className:"star-icon",children:[c.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",className:"star-base",children:c.jsx("path",{d:"M12 2.5l2.9 5.88 6.5.95-4.7 4.58 1.1 6.43L12 17.9l-5.8 3.44 1.1-6.43-4.7-4.58 6.5-.95L12 2.5z"})}),c.jsx("div",{className:"star-fill",style:{"--pct":`${(Math.max(0,Math.min(1,Ye))*100).toFixed(1)}%`},children:c.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:c.jsx("path",{d:"M12 2.5l2.9 5.88 6.5.95-4.7 4.58 1.1 6.43L12 17.9l-5.8 3.44 1.1-6.43-4.7-4.58 6.5-.95L12 2.5z"})})})]},mt))}),c.jsx("div",{className:"star-hit",children:Oe.map(Ye=>c.jsx("button",{type:"button","aria-label":`${Ye} stars`,onMouseEnter:()=>$(Ye),onMouseLeave:()=>$(null),onClick:()=>Z(Ye)},Ye))})]}),c.jsx("div",{className:"star-value",children:Le?Le.toFixed(1):"--"}),c.jsx("button",{type:"button",className:"star-clear",onClick:()=>Z(""),"aria-label":"Clear rating",children:"clear"})]})},Fr=a==="library"?Tt:Pt,Sr=(P,Z)=>{if(!P.length)return;const le=Array.from(P.reduce((xe,Ye)=>(Object.keys(Ye).forEach(mt=>xe.add(mt)),xe),new Set)),$=xe=>{const Ye=xe==null?"":String(xe);return/[",\n]/.test(Ye)?`"${Ye.replace(/"/g,'""')}"`:Ye},Y=[le.join(",")].concat(P.map(xe=>le.map(Ye=>$(xe[Ye])).join(","))),Le=new Blob([Y.join(`
`)],{type:"text/csv"}),Oe=URL.createObjectURL(Le),Rt=document.createElement("a");Rt.href=Oe,Rt.download=Z,Rt.click(),URL.revokeObjectURL(Oe)},as=async(P,Z)=>{const le=(Y,Le="image")=>(Y||"").toString().toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"").slice(0,100)||Le,$=P.filter(Y=>Y.cover).map((Y,Le)=>({url:Y.cover,name:le(Y.title||`manga-${Le+1}`,`manga-${Le+1}`)}));if(!$.length){alert("No images found to download.");return}try{const Y=(await Xl(async()=>{const{default:Vn}=await import("https://cdn.jsdelivr.net/npm/jszip@3.10.1/+esm");return{default:Vn}},[])).default,Le=new Y,Oe=Le.folder("images"),Rt={},xe=$.map(async(Vn,Ur)=>{try{const gr=await(await fetch(Vn.url)).blob(),Yn=(Vn.url.split(".").pop()||"jpg").split(/[?#]/)[0],Ir=Vn.name||`image-${Ur+1}`;Rt[Ir]=(Rt[Ir]||0)+1;const vt=Rt[Ir]>1?`-${Rt[Ir]}`:"";Oe.file(`${Ir}${vt}.${Yn}`,gr)}catch(gt){console.warn("Failed to fetch image",Vn.url,gt)}});await Promise.all(xe);const Ye=await Le.generateAsync({type:"blob"}),mt=URL.createObjectURL(Ye),Cn=document.createElement("a");Cn.href=mt,Cn.download=Z,Cn.click(),URL.revokeObjectURL(mt)}catch(Y){console.error("Zip download failed",Y),alert("Failed to create zip. Please try again.")}},Qn=(P,Z)=>{const le=new Blob([JSON.stringify(P,null,2)],{type:"application/json"}),$=URL.createObjectURL(le),Y=document.createElement("a");Y.href=$,Y.download=Z,Y.click(),URL.revokeObjectURL($)},Ln=async P=>{if(!s||!(P!=null&&P.id))return;const Z=P.kind==="wishlist"?"wishlist":"library",le=Z==="library"?"wishlist":"library";try{if(Z==="library"){const $={title:P.title,authors:P.authors,publisher:P.publisher,date:P.date,pageCount:P.pageCount||"",cover:P.cover||"",amazonURL:P.amazonURL||"",hidden:!!P.hidden};await Ei(Hn(tt,le),$)}else{const $={title:P.title,authors:P.authors,publisher:P.publisher,date:P.date,pageCount:P.pageCount||"",cover:P.cover||"",amountPaid:"",read:!1,rating:"",msrp:"",collectiblePrice:"",specialType:"",specialVolumes:"",isbn:"",demographic:"",genre:"",subGenre:"",amazonURL:P.amazonURL||"",hidden:!!P.hidden};await Ei(Hn(tt,le),$)}await pa(At(tt,Z,P.id)),await Promise.all([ke(),Me()]),ln()}catch($){console.error("Move failed",$),alert("Failed to move item.")}},_t=ve.list==="wishlist",qt=R.items[R.index]||null,Yt=(qt==null?void 0:qt.kind)==="wishlist";return c.jsxs("div",{className:"manga-page",children:[c.jsxs("header",{className:"manga-header",style:{flexDirection:"column",alignItems:"center",textAlign:"center"},children:[c.jsx("div",{className:"manga-header-title",style:{justifyContent:"center",gap:"0.6rem",fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Tyler's Manga Library"}),c.jsx("div",{className:"manga-header-sub",style:{textAlign:"center"},children:"This is my Manga Library and Wishlist. Check and see all the Manga I have in my possession!"})]}),de&&c.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"6px"},children:c.jsx("button",{className:"suggestion-trigger",type:"button",onClick:()=>{Ke(""),ie(!0)},children:"+ Suggestion"})}),c.jsxs("div",{className:"manga-tabs",children:[c.jsx("button",{className:"manga-tab-btn"+(a==="library"?" active":""),onClick:()=>{l("library"),V(!1),D(new Set)},children:"Library"}),c.jsx("button",{className:"manga-tab-btn"+(a==="wishlist"?" active":""),onClick:()=>{l("wishlist"),V(!1),D(new Set)},children:"Wishlist"})]}),a!=="dashboard"&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"manga-toolbar",children:[c.jsxs("div",{className:"manga-toolbar-left",children:[c.jsx("input",{type:"text",className:"manga-search-input",placeholder:a==="library"?"Search library by title, author, ISBN...":"Search wishlist...",value:a==="library"?Ee:b,onChange:P=>a==="library"?Se(P.target.value):A(P.target.value)}),c.jsx("div",{className:"manga-counter",children:a==="library"?c.jsxs(c.Fragment,{children:["Library: ",Ue.length," / ",f.length]}):c.jsxs(c.Fragment,{children:["Wishlist: ",Ct.length," / ",v.length]})})]}),c.jsxs("div",{className:"manga-toolbar-right",children:[s&&c.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>O(P=>!P),children:K?"Hide Hidden":"Show Hidden"}),s&&c.jsx("button",{className:"manga-btn secondary"+(k?" active":""),onClick:bt,children:k?"Exit Multi-select":"Multi-select"})]})]}),s&&k&&c.jsxs("div",{className:"manga-multiselect-bar",children:[c.jsxs("span",{children:["Selected: ",c.jsx("strong",{children:F.size})]}),c.jsx("button",{className:"manga-btn",onClick:cn,children:"Bulk Edit"}),c.jsxs("button",{className:"manga-btn secondary",onClick:()=>St("move"),children:["Move to ",a==="library"?"Wishlist":"Library"]}),a==="library"&&c.jsxs(c.Fragment,{children:[c.jsx("button",{className:"manga-btn",onClick:()=>St("markRead"),children:"Mark Read"}),c.jsx("button",{className:"manga-btn secondary",onClick:()=>St("markUnread"),children:"Mark Unread"})]}),c.jsx("button",{className:"manga-btn danger",onClick:()=>St("delete"),children:"Delete"})]})]}),re?c.jsx("div",{className:"manga-empty-state",children:"Loading manga from Firestore..."}):ne?c.jsx("div",{className:"manga-empty-state",children:ne}):Fr.length===0?c.jsx("div",{className:"manga-empty-state",children:"No manga found. Try changing your search."}):c.jsx("div",{className:"manga-grid",children:Fr.map(P=>un(P))}),s&&c.jsxs("div",{className:"manga-floating-actions",children:[c.jsxs("button",{className:"manga-btn",type:"button","aria-label":"Add item",onClick:()=>Mr(a==="wishlist"?"wishlist":"library"),children:["+ ",a==="wishlist"?"Wishlist":"Library"]}),c.jsxs("div",{className:"manga-export-actions",children:[n&&c.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>Qn({library:f,wishlist:v},"manga-library-wishlist.json"),children:"Export JSON"}),c.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>Sr(a==="library"?f:v,a==="library"?"manga-library.csv":"manga-wishlist.csv"),children:"Export CSV"}),c.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>as(a==="library"?f:v,a==="library"?"manga-library-images.zip":"manga-wishlist-images.zip"),children:"Download Images"})]})]}),I&&c.jsx("div",{className:"manga-modal-backdrop visible",onClick:P=>{P.target===P.currentTarget&&ln()},children:c.jsxs("div",{className:"manga-modal",children:[c.jsx("div",{className:"manga-modal-cover-wrap",children:c.jsx("img",{src:I.cover||"https://imgur.com/chUgq4W.png",alt:"Cover"})}),c.jsxs("div",{className:"manga-modal-body",children:[c.jsxs("div",{className:"manga-modal-header",children:[c.jsx("div",{className:"manga-modal-title",children:I.title||"Untitled"}),c.jsx("button",{className:"manga-modal-close",onClick:ln,type:"button",children:"Close"})]}),c.jsxs("div",{className:"manga-modal-meta",children:[I.authors&&I.authors!=="Unknown"&&c.jsxs(c.Fragment,{children:[c.jsx("strong",{children:"Author(s):"})," ",I.authors,c.jsx("br",{})]}),I.publisher&&I.publisher!=="Unknown"&&c.jsxs(c.Fragment,{children:[c.jsx("strong",{children:"Publisher:"})," ",I.publisher,c.jsx("br",{})]}),I.date&&c.jsxs(c.Fragment,{children:[c.jsx("strong",{children:"Release:"})," ",I.date,c.jsx("br",{})]}),I.isbn&&c.jsxs(c.Fragment,{children:[c.jsx("strong",{children:"ISBN:"})," ",I.isbn,c.jsx("br",{})]})]}),c.jsxs("div",{className:"manga-modal-details",children:[I.pageCount&&c.jsxs(c.Fragment,{children:[c.jsx("strong",{children:"Pages:"})," ",I.pageCount,c.jsx("br",{})]}),c.jsxs("div",{style:{margin:"6px 0"},children:[c.jsx("strong",{children:"Rating:"})," ",c.jsx(dn,{value:I.rating||"",onChange:P=>Rs(I,P)})]}),I.amountPaid&&c.jsxs(c.Fragment,{children:[c.jsx("strong",{children:"Amount Paid:"})," $",I.amountPaid,c.jsx("br",{})]}),I.msrp&&c.jsxs(c.Fragment,{children:[c.jsx("strong",{children:"MSRP:"})," $",I.msrp,c.jsx("br",{})]}),I.collectiblePrice&&c.jsxs(c.Fragment,{children:[c.jsx("strong",{children:"Collectible:"})," $",I.collectiblePrice,c.jsx("br",{})]}),I.read&&I.dateRead&&c.jsxs(c.Fragment,{children:[c.jsx("strong",{children:"Date Read:"})," ",I.dateRead,c.jsx("br",{})]}),I.amazonURL&&c.jsx("div",{style:{marginTop:"6px"},children:c.jsx("a",{href:I.amazonURL,target:"_blank",rel:"noreferrer",children:"View on Amazon"})})]}),c.jsxs("div",{className:"manga-modal-footer",style:{gap:"10px",alignItems:"center"},children:[c.jsx("div",{children:I.kind==="library"&&I.read?"Marked as read in your library.":I.kind==="library"?"In your library (unread).":"Wishlist item - not in library yet."}),c.jsxs("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:[I.kind==="library"&&c.jsx(c.Fragment,{children:I.read?c.jsx("button",{className:"manga-btn mini secondary",disabled:Kn,onClick:()=>As(I,!1),type:"button",children:"Mark as unread"}):c.jsx("button",{className:"manga-btn mini",disabled:Kn,onClick:()=>As(I,!0),type:"button",children:"Mark as read"})}),s&&c.jsxs("button",{className:"manga-btn mini",type:"button",onClick:()=>Ln(I),children:["Move to ",I.kind==="library"?"Wishlist":"Library"]})]})]})]})]})}),s&&ve.open&&c.jsx("div",{className:"manga-modal-backdrop visible",onClick:P=>{P.target===P.currentTarget&&vn()},children:c.jsx("div",{className:"manga-modal admin",children:c.jsxs("div",{className:"manga-modal-body",children:[c.jsxs("div",{className:"manga-modal-header",children:[c.jsx("div",{className:"manga-modal-title",children:ve.mode==="add"?"Add Entry":"Edit Entry"}),c.jsx("button",{className:"manga-modal-close",onClick:vn,type:"button",children:"Close"})]}),c.jsxs("div",{className:"admin-form-layout",children:[c.jsx("div",{className:"admin-cover-frame",children:c.jsx("img",{src:ve.data.cover||"https://imgur.com/chUgq4W.png",alt:"Cover preview"})}),c.jsxs("div",{className:"admin-form-fields",children:[c.jsx("div",{className:"admin-row",children:c.jsxs("label",{children:["Title",c.jsx("input",{type:"text",value:ve.data.title,onChange:P=>Qe("title",P.target.value)})]})}),U.length>0&&c.jsx("div",{className:"title-suggestions",children:U.map((P,Z)=>c.jsx("button",{type:"button",className:"manga-btn mini",onClick:()=>Qe("title",P),children:P},P+Z))}),c.jsxs("div",{className:"admin-row two",style:{alignItems:"flex-end",marginTop:"-8px"},children:[c.jsxs("div",{children:[c.jsxs("div",{className:"manga-modal-subtitle",style:{marginBottom:"6px"},children:["Entry ",ee+1," / ",Math.max(1,Be.length||1)]}),c.jsxs("div",{style:{display:"flex",gap:"8px"},children:[c.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>ee>0&&nr(ee-1),disabled:ee===0,children:"Previous"}),c.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>Be.length&&ee<Be.length-1?nr(ee+1):null,disabled:!Be.length||ee===Be.length-1,children:"Next"})]})]}),c.jsxs("div",{style:{textAlign:"right"},children:[c.jsx("button",{className:"manga-btn",type:"button",onClick:bs,disabled:!Xr(ve.data.title||"").vol,children:"Add New Volume"}),c.jsx("div",{className:"manga-stat-sub",style:{marginTop:"4px"},children:"Auto-fills the next volume number for this series."})]})]}),c.jsx("div",{className:"admin-row",children:c.jsxs("label",{children:["Authors",c.jsx("input",{type:"text",value:ve.data.authors,onChange:P=>Qe("authors",P.target.value)})]})}),c.jsx("div",{className:"admin-row",children:c.jsxs("label",{children:["Publisher",c.jsx("input",{type:"text",value:ve.data.publisher,onChange:P=>Qe("publisher",P.target.value)})]})}),c.jsxs("div",{className:"admin-row three",children:[c.jsxs("label",{children:["Release Date",c.jsx("input",{type:"date",value:ve.data.date,onChange:P=>Qe("date",P.target.value)})]}),!_t&&c.jsxs(c.Fragment,{children:[c.jsxs("label",{children:["Date Purchased",c.jsx("input",{type:"date",value:ve.data.datePurchased,onChange:P=>Qe("datePurchased",P.target.value)})]}),c.jsxs("label",{children:["Date Read",c.jsx("input",{type:"date",value:ve.data.dateRead,onChange:P=>Qe("dateRead",P.target.value)})]})]})]}),c.jsxs("div",{className:"admin-row two",children:[c.jsxs("label",{children:["Page Count",c.jsx("input",{type:"number",placeholder:"e.g. 192",value:ve.data.pageCount,onChange:P=>Qe("pageCount",P.target.value)})]}),!_t&&c.jsxs("label",{children:["ISBN (library only)",c.jsx("input",{type:"text",value:ve.data.isbn,onChange:P=>Qe("isbn",P.target.value)})]})]}),c.jsx("div",{className:"admin-row",children:c.jsxs("label",{children:["Cover URL",c.jsx("input",{type:"text",placeholder:"Paste image URL here",value:ve.data.cover,onChange:P=>Qe("cover",P.target.value)})]})}),!_t&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"admin-row two",children:[!(ve.data.special&&ve.data.specialType==="collectible")&&c.jsxs("label",{children:["Amount Paid",c.jsx("input",{type:"number",step:"0.01",value:ve.data.amountPaid,onChange:P=>Qe("amountPaid",P.target.value)})]}),c.jsxs("label",{children:["MSRP",c.jsx("input",{type:"number",step:"0.01",value:ve.data.msrp,onChange:P=>Qe("msrp",P.target.value)})]})]}),c.jsx("div",{className:"admin-row",children:c.jsxs("label",{className:"checkbox-row",children:[c.jsx("input",{type:"checkbox",checked:!!ve.data.special,onChange:P=>Qe("special",P.target.checked,"checkbox")}),c.jsx("span",{children:"Special item?"})]})}),ve.data.special&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"admin-row two",children:[c.jsxs("label",{children:["Special Type",c.jsxs("select",{value:ve.data.specialType,onChange:P=>Qe("specialType",P.target.value),children:[c.jsx("option",{value:"",children:"Select type"}),c.jsx("option",{value:"specialEdition",children:"Special Edition"}),c.jsx("option",{value:"collectible",children:"Collectible"})]})]}),ve.data.specialType==="collectible"&&c.jsxs("label",{children:["Collectible Price",c.jsx("input",{type:"number",step:"0.01",value:ve.data.collectiblePrice,onChange:P=>Qe("collectiblePrice",P.target.value)})]})]}),ve.data.specialType==="specialEdition"&&c.jsx("div",{className:"admin-row",children:c.jsxs("label",{children:["Special Volumes",c.jsx("input",{type:"number",min:"0",value:ve.data.specialVolumes,onChange:P=>Qe("specialVolumes",P.target.value)})]})})]})]}),_t&&c.jsx("div",{className:"admin-row",children:c.jsxs("label",{children:["Amazon URL",c.jsx("input",{type:"text",value:ve.data.amazonURL,onChange:P=>Qe("amazonURL",P.target.value)})]})}),!_t&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"admin-row",children:c.jsxs("label",{children:["Rating (1-5 stars)",c.jsx(dn,{value:ve.data.rating,onChange:P=>Qe("rating",P)})]})}),c.jsxs("div",{className:"admin-row two",children:[c.jsxs("label",{className:"checkbox-inline",children:[c.jsx("input",{type:"checkbox",checked:ve.data.read,onChange:P=>Qe("read",P.target.checked,"checkbox")}),c.jsx("span",{children:"Mark as read"})]}),c.jsxs("label",{className:"checkbox-inline",children:[c.jsx("input",{type:"checkbox",checked:!!ve.data.hidden,onChange:P=>Qe("hidden",P.target.checked,"checkbox")}),c.jsx("span",{children:"Hide from public"})]})]})]}),_t&&c.jsx("div",{className:"admin-row",children:c.jsxs("label",{className:"checkbox-inline",children:[c.jsx("input",{type:"checkbox",checked:!!ve.data.hidden,onChange:P=>Qe("hidden",P.target.checked,"checkbox")}),c.jsx("span",{children:"Hide from public"})]})})]})]}),c.jsxs("div",{className:"manga-modal-footer",style:{justifyContent:"flex-end",gap:"10px"},children:[c.jsx("button",{className:"manga-btn secondary",onClick:vn,type:"button",children:"Cancel"}),c.jsx("button",{className:"manga-btn",onClick:fr,type:"button",children:ve.mode==="add"?"Add":"Save"})]})]})})}),s&&R.open&&c.jsx("div",{className:"manga-modal-backdrop visible",onClick:P=>{P.target===P.currentTarget&&In()},children:c.jsx("div",{className:"manga-modal admin",children:c.jsxs("div",{className:"manga-modal-body",children:[c.jsxs("div",{className:"manga-modal-header",children:[c.jsxs("div",{className:"manga-modal-title",children:["Bulk Edit (",R.index+1," / ",R.items.length,")"]}),c.jsx("button",{className:"manga-modal-close",onClick:In,type:"button",children:"Close"})]}),R.items.length>0&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"manga-modal-subtitle",children:["Editing: ",R.items[R.index].data.title||"Untitled"]}),c.jsxs("div",{className:"admin-form-grid",children:[c.jsxs("label",{children:["Title",c.jsx("input",{type:"text",value:R.items[R.index].data.title,onChange:P=>ct("title",P.target.value)})]}),c.jsxs("label",{children:["Authors",c.jsx("input",{type:"text",value:R.items[R.index].data.authors,onChange:P=>ct("authors",P.target.value)})]}),c.jsxs("label",{children:["Publisher",c.jsx("input",{type:"text",value:R.items[R.index].data.publisher,onChange:P=>ct("publisher",P.target.value)})]}),c.jsxs("label",{children:["Release Date",c.jsx("input",{type:"date",value:R.items[R.index].data.date,onChange:P=>ct("date",P.target.value)})]}),!Yt&&c.jsxs("label",{children:["ISBN",c.jsx("input",{type:"text",value:R.items[R.index].data.isbn,onChange:P=>ct("isbn",P.target.value)})]}),c.jsxs("label",{children:["Cover URL",c.jsx("input",{type:"text",value:R.items[R.index].data.cover,onChange:P=>ct("cover",P.target.value)})]}),c.jsxs("label",{children:["Page Count",c.jsx("input",{type:"number",value:R.items[R.index].data.pageCount,onChange:P=>ct("pageCount",P.target.value)})]}),!Yt&&c.jsxs(c.Fragment,{children:[c.jsxs("label",{children:["Rating (1-5 stars)",c.jsx(dn,{value:R.items[R.index].data.rating,onChange:P=>ct("rating",P)})]}),!(R.items[R.index].data.special&&R.items[R.index].data.specialType==="collectible")&&c.jsxs("label",{children:["Amount Paid",c.jsx("input",{type:"number",step:"0.01",value:R.items[R.index].data.amountPaid,onChange:P=>ct("amountPaid",P.target.value)})]}),!(R.items[R.index].data.special&&R.items[R.index].data.specialType==="collectible")&&c.jsxs("label",{children:["Amount Paid",c.jsx("input",{type:"number",step:"0.01",value:R.items[R.index].data.amountPaid,onChange:P=>ct("amountPaid",P.target.value)})]}),c.jsxs("label",{children:["MSRP",c.jsx("input",{type:"number",step:"0.01",value:R.items[R.index].data.msrp,onChange:P=>ct("msrp",P.target.value)})]}),R.items[R.index].data.special&&R.items[R.index].data.specialType==="collectible"&&c.jsxs("label",{children:["Collectible Price",c.jsx("input",{type:"number",step:"0.01",value:R.items[R.index].data.collectiblePrice,onChange:P=>ct("collectiblePrice",P.target.value)})]})]}),!Yt&&c.jsxs(c.Fragment,{children:[c.jsxs("label",{children:["Date Purchased",c.jsx("input",{type:"date",value:R.items[R.index].data.datePurchased,onChange:P=>ct("datePurchased",P.target.value)})]}),c.jsxs("label",{children:["Date Read",c.jsx("input",{type:"date",value:R.items[R.index].data.dateRead,onChange:P=>ct("dateRead",P.target.value)})]})]}),!Yt&&c.jsxs(c.Fragment,{children:[c.jsxs("label",{className:"checkbox-row",children:[c.jsx("input",{type:"checkbox",checked:!!R.items[R.index].data.special,onChange:P=>ct("special",P.target.checked,"checkbox")}),c.jsx("span",{children:"Special item?"})]}),R.items[R.index].data.special&&c.jsxs(c.Fragment,{children:[c.jsxs("label",{children:["Special Type",c.jsxs("select",{value:R.items[R.index].data.specialType,onChange:P=>ct("specialType",P.target.value),children:[c.jsx("option",{value:"",children:"Select type"}),c.jsx("option",{value:"specialEdition",children:"Special Edition"}),c.jsx("option",{value:"collectible",children:"Collectible"})]})]}),R.items[R.index].data.specialType==="specialEdition"&&c.jsxs("label",{children:["Special Volumes",c.jsx("input",{type:"number",value:R.items[R.index].data.specialVolumes,onChange:P=>ct("specialVolumes",P.target.value)})]}),R.items[R.index].data.specialType==="collectible"&&c.jsxs("label",{children:["Collectible Price",c.jsx("input",{type:"number",step:"0.01",value:R.items[R.index].data.collectiblePrice,onChange:P=>ct("collectiblePrice",P.target.value)})]})]})]}),Yt&&c.jsxs("label",{children:["Amazon URL",c.jsx("input",{type:"text",value:R.items[R.index].data.amazonURL,onChange:P=>ct("amazonURL",P.target.value)})]}),!Yt&&c.jsxs("label",{className:"checkbox-row",children:[c.jsx("input",{type:"checkbox",checked:R.items[R.index].data.read,onChange:P=>ct("read",P.target.checked,"checkbox")}),c.jsx("span",{children:"Marked as read"})]}),c.jsxs("label",{className:"checkbox-row",children:[c.jsx("input",{type:"checkbox",checked:!!R.items[R.index].data.hidden,onChange:P=>ct("hidden",P.target.checked,"checkbox")}),c.jsx("span",{children:"Hidden from public"})]})]}),c.jsxs("div",{className:"manga-modal-footer",style:{justifyContent:"space-between",gap:"10px"},children:[c.jsxs("div",{children:[c.jsx("button",{className:"manga-btn secondary",onClick:Dn,type:"button",disabled:R.index===0,children:"Previous"}),c.jsx("button",{className:"manga-btn secondary",onClick:mr,type:"button",disabled:R.index===R.items.length-1,style:{marginLeft:"6px"},children:"Next"})]}),c.jsxs("div",{style:{display:"flex",gap:"8px"},children:[c.jsx("button",{className:"manga-btn secondary",onClick:In,type:"button",children:"Cancel"}),c.jsx("button",{className:"manga-btn",onClick:en,type:"button",children:"Save Edits"})]})]})]})]})})}),de&&c.jsx(jw,{open:me,title:"Suggest a Manga",placeholder:"Type a manga you'd like me to collect/read...",value:Te,status:Ze,loading:ot,onChange:Ce,onSubmit:d,onClose:()=>ie(!1)}),c.jsx("datalist",{id:"adminTitleSuggestions",children:E.map(P=>c.jsx("option",{value:P},P))})]})}const vR="https://imokmalworker.imokissick.workers.dev/?url=",Dw="im_ok",Dv=300,_R={1:"watching",2:"completed",3:"on_hold",4:"dropped",6:"plan_to_watch"};function wR(n){const e=n==null?void 0:n.title_localized,t=typeof e=="string"?e:(e==null?void 0:e.en)||(e==null?void 0:e.english);return(n==null?void 0:n.anime_title_eng)||(n==null?void 0:n.title_english)||t||(n==null?void 0:n.anime_title)||(n==null?void 0:n.title)||"Untitled"}function xR(n){const e=(n==null?void 0:n.updated_at)??(n==null?void 0:n.updatedAt)??(n==null?void 0:n.updated_at_ms)??null;if(e==null)return null;const t=Number(e);if(Number.isFinite(t))return t<1e12?t*1e3:t;const s=Date.parse(e);return Number.isNaN(s)?null:s}function ER(n){const e=_R[n.status]||(typeof n.status=="string"?n.status.toLowerCase():"unknown");return{id:n.anime_id||n.id,title:wR(n),updatedAt:xR(n),episodes:n.anime_num_episodes??n.episodes??null,watchedEpisodes:n.num_watched_episodes??n.my_watched_episodes??n.watched_episodes??n.num_watched??0,status:e,score:n.score??null,image:n.anime_image_path||n.image_url||n.anime_img||n.picture||null,synopsis:n.anime_synopsis||n.synopsis||null}}function Lv(){const n=Date.now();return[{id:1,title:"Cowboy Bebop",episodes:26,status:"completed",score:10,updatedAt:n-1e3*60*60*24*3,synopsis:"In 2071, bounty hunters Spike and Jet roam the solar system looking for their next payout and a place to belong."},{id:2,title:"Fullmetal Alchemist: Brotherhood",episodes:64,status:"completed",score:10,updatedAt:n-1e3*60*60*24*6,synopsis:"Brothers Edward and Alphonse Elric search for the Philosopher's Stone to restore their bodies after a failed alchemy ritual."},{id:3,title:"Frieren: Beyond Journey's End",episodes:28,status:"watching",score:9,updatedAt:n-1e3*60*60*8,synopsis:"An elven mage retraces the steps of a past adventure to understand humanity and the passage of time."},{id:4,title:"One Piece",episodes:1e3,status:"on_hold",score:8,updatedAt:n-1e3*60*60*24*14,synopsis:"Monkey D. Luffy sails toward the Grand Line seeking the One Piece and a crew to make his dream real."},{id:5,title:"Kaiju No. 8",episodes:12,status:"plan_to_watch",score:null,updatedAt:n-1e3*60*30,synopsis:"A middle-aged worker gains kaiju powers and joins the Defense Force to fight monsters from the inside."}]}async function TR(n,e){const t=`https://myanimelist.net/animelist/${n}/load.json?status=7&offset=${e}`,s=await fetch(`${vR}${encodeURIComponent(t)}`);if(!s.ok)throw new Error(`Failed to fetch MAL list (offset ${e})`);return s.json()}async function SR(n=Dw){const e=[];try{let t=0;for(;;){const s=await TR(n,t);if(!Array.isArray(s)||s.length===0||(e.push(...s),s.length<Dv))break;t+=Dv}}catch(t){return console.error("Failed to load MAL list; falling back to sample data.",t),Lv()}return e.length?e.map(ER):Lv()}async function IR(n){var e,t;if(!n)return null;try{const s=await fetch(`https://api.jikan.moe/v4/anime/${n}`);if(!s.ok)throw new Error(`Failed to fetch Jikan summary for id ${n}`);const a=await s.json();return((e=a==null?void 0:a.data)==null?void 0:e.synopsis)||((t=a==null?void 0:a.data)==null?void 0:t.background)||null}catch(s){return console.error("Failed to load anime synopsis",n,s),null}}async function CR(n=Dw){var e;if(!n)return null;try{const t=await fetch(`https://api.jikan.moe/v4/users/${encodeURIComponent(n)}/statistics`);if(!t.ok)throw new Error(`Failed to fetch user stats for ${n}`);const s=await t.json(),a=((e=s==null?void 0:s.data)==null?void 0:e.anime)||{},l=Number(a.days_watched),d=Number(a.total_episodes??a.episodes_watched);return{daysWatched:Number.isFinite(l)?l:null,episodesWatched:Number.isFinite(d)?d:null}}catch(t){return console.error("Failed to load user stats",n,t),null}}const Vv=5,PR=3600*1e3,Ov="animeSuggestionsSent";function bR(){const{admin:n,user:e,role:t}=jo(),s=de=>de?de.toString().replace(/_/g," ").replace(/\b\w/g,ke=>ke.toUpperCase()):"Unknown",[a,l]=j.useState([]),[d,f]=j.useState([]),[m,v]=j.useState(""),[w,E]=j.useState("all"),[C,U]=j.useState(!0),[G,K]=j.useState(""),[O,re]=j.useState(null),[ye,ne]=j.useState({}),[oe,Ee]=j.useState(!1),[Se,b]=j.useState(!1),[A,k]=j.useState(null),[V,F]=j.useState(!1),[D,I]=j.useState(""),[ge,ve]=j.useState(""),[lt,Be]=j.useState(!1);j.useEffect(()=>{document.title="Anime | Library"},[]),j.useEffect(()=>{ve("")},[e]);const L=de=>{if(!de)return"";const ke=Date.now()-de,Me=Math.max(ke,0),Ue=Math.floor(Me/6e4);if(Ue<1)return"just now";if(Ue<60)return`${Ue}m ago`;const Tt=Math.floor(Ue/60);if(Tt<48)return`${Tt}h ago`;const Ct=Math.floor(Tt/24);if(Ct<14)return`${Ct}d ago`;const Pt=Math.floor(Ct/7);return Pt<8?`${Pt}w ago`:`${Math.floor(Ct/30)}mo ago`},ee=(de,ke="image")=>(de||"").toString().toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"").slice(0,80)||ke,se=async()=>{const de=a.filter(ke=>ke.image).map((ke,Me)=>({url:ke.image,name:ee(ke.title||`anime-${Me+1}`,`anime-${Me+1}`)}));if(!de.length){alert("No images found to download.");return}try{const ke=(await Xl(async()=>{const{default:zt}=await import("https://cdn.jsdelivr.net/npm/jszip@3.10.1/+esm");return{default:zt}},[])).default,Me=new ke,Ue=Me.folder("images"),Tt={};await Promise.all(de.map(async(zt,St)=>{try{const ln=await(await fetch(zt.url)).blob(),vn=(zt.url.split(".").pop()||"jpg").split(/[?#]/)[0],Qt=zt.name||`image-${St+1}`;Tt[Qt]=(Tt[Qt]||0)+1;const Mr=Tt[Qt]>1?`-${Tt[Qt]}`:"";Ue.file(`${Qt}${Mr}.${vn}`,ln)}catch(Sn){console.warn("Failed to fetch image",zt.url,Sn)}}));const Ct=await Me.generateAsync({type:"blob"}),Pt=URL.createObjectURL(Ct),bt=document.createElement("a");bt.href=Pt,bt.download="anime-images.zip",bt.click(),URL.revokeObjectURL(Pt)}catch(ke){console.error("Zip download failed",ke),alert("Failed to create zip. Please try again.")}};j.useEffect(()=>{async function de(){try{const ke=await SR();l(ke),f(ke)}catch(ke){console.error(ke),K("Failed to load data from MAL.")}finally{U(!1)}}de()},[]),j.useEffect(()=>{CR().then(de=>{de&&k(de)}).catch(()=>{})},[]);const R=de=>{switch((de||"unknown").toLowerCase()){case"watching":return 0;case"completed":return 1;case"on_hold":return 2;case"plan_to_watch":return 3;case"dropped":return 4;default:return 5}},J=de=>{const ke=Number.isFinite(Number(de.watchedEpisodes))?Number(de.watchedEpisodes):0,Me=Number.isFinite(Number(de.episodes))?Number(de.episodes):null;return Me?`${Math.min(ke,Me)}/${Me} eps`:ke?`${ke} eps`:"No progress"};j.useEffect(()=>{let de=[...a];if(w!=="all"&&(de=de.filter(ke=>(ke.status||"").toLowerCase()===w)),m){const ke=m.toLowerCase();de=de.filter(Me=>(Me.title||"").toLowerCase().includes(ke))}de.sort((ke,Me)=>{const Ue=R(ke.status),Tt=R(Me.status);return Ue!==Tt?Ue-Tt:(ke.title||"").localeCompare(Me.title||"")}),f(de)},[a,w,m]);const me=j.useMemo(()=>[...a].filter(de=>Number.isFinite(de.updatedAt)).sort((de,ke)=>ke.updatedAt-de.updatedAt).slice(0,6),[a]),ie=!!e&&t==="viewer",Te=async()=>{const de=Date.now(),Me=(()=>{try{const Ue=localStorage.getItem(Ov);return Array.isArray(JSON.parse(Ue))?JSON.parse(Ue):[]}catch{return[]}})().filter(Ue=>de-Ue<PR);if(Me.length>=Vv){ve("Rate limit: please wait a bit (max 5 suggestions per hour).");return}if(!D.trim()){ve("Please enter a title or note before sending.");return}Be(!0),ve("");try{const Ue=`**Anime Suggestion**
${D.trim()}
From: ${(e==null?void 0:e.displayName)||(e==null?void 0:e.email)||(e==null?void 0:e.uid)||"anonymous user"}`;await Ei(Hn(tt,"suggestions"),{content:D.trim(),type:"anime",from:(e==null?void 0:e.displayName)||(e==null?void 0:e.email)||(e==null?void 0:e.uid)||"anonymous user",createdAt:new Date().toISOString()}),ve("Sent! I'll review your suggestion soon."),I("");const Tt=[...Me,de].slice(-Vv);localStorage.setItem(Ov,JSON.stringify(Tt))}catch(Ue){console.error("Failed to send suggestion",Ue),ve("Failed to send suggestion. Please try again later.")}finally{Be(!1)}};j.useEffect(()=>{if(!O){b(!1),Ee(!1);return}b(!!O.synopsis),Ee(!1)},[O==null?void 0:O.id]);const Ce=j.useMemo(()=>{const de=a.length,ke=a.reduce((Pt,bt)=>{const zt=Number(bt.watchedEpisodes);return Number.isFinite(zt)?Pt+zt:Pt},0),Me=ke*.4,Ue=a.filter(Pt=>Number.isFinite(Pt.score)&&Pt.score>0),Tt=Ue.reduce((Pt,bt)=>Pt+bt.score,0),Ct={watching:0,completed:0,on_hold:0,dropped:0,plan_to_watch:0,unknown:0};return a.forEach(Pt=>{const bt=(Pt.status||"unknown").toLowerCase();Ct[bt]!=null?Ct[bt]+=1:Ct.unknown+=1}),{total:de,totalWatchedEpisodes:ke,byStatus:Ct,avgScore:Ue.length?Tt/Ue.length:0,totalHours:Me}},[a]),Ze=(A==null?void 0:A.daysWatched)??(Ce.totalHours||0)/24,Ke=(A==null?void 0:A.episodesWatched)??Ce.totalWatchedEpisodes,ot=de=>{const ke=de.image||"https://imgur.com/chUgq4W.png",Me=Number.isFinite(Number(de.watchedEpisodes))?Number(de.watchedEpisodes):0,Ue=Number.isFinite(Number(de.episodes))?Number(de.episodes):null,Tt=Ue?`Episode ${Math.min(Me,Ue)}/${Ue}`:`Episode ${Me}`,Ct=Number.isFinite(Number(de.score))&&Number(de.score)>0?de.score:"Not rated";return c.jsxs("article",{className:"anime-card",onClick:()=>re(de.synopsis?de:{...de,synopsis:ye[de.id]}),children:[c.jsxs("div",{className:"anime-cover-wrap",children:[c.jsx("img",{className:"anime-cover",src:ke,alt:de.title,loading:"lazy",decoding:"async"}),c.jsx("div",{className:`badge-status ${(de.status||"unknown").toLowerCase()}`,children:s(de.status)}),de.score!=null&&c.jsx("div",{className:"badge-score",children:Ct})]}),c.jsxs("div",{className:"anime-meta",children:[c.jsx("div",{className:"anime-title",title:de.title,children:de.title}),c.jsx("div",{className:"anime-sub",children:de.episodes?`${de.episodes} episodes`:"Episodes: ?"}),c.jsx("div",{className:"anime-progress",children:Tt}),c.jsxs("div",{className:"anime-progress",children:["Status: ",s(de.status)]})]})]},de.id||de.title)},jt=de=>c.jsxs("article",{className:"anime-update-card",children:[c.jsx("div",{className:"anime-update-title",title:de.title,children:de.title}),c.jsxs("div",{className:"anime-update-meta",children:[c.jsx("span",{className:"anime-update-progress",children:J(de)}),c.jsx("span",{className:"anime-update-dot","aria-hidden":"true",children:""}),c.jsx("span",{className:"anime-update-status",children:s(de.status)})]}),c.jsx("div",{className:"anime-update-time",children:L(de.updatedAt)})]},`update-${de.id||de.title}`);return c.jsxs("main",{className:"anime-page",children:[c.jsxs("div",{className:"anime-content",children:[c.jsxs("header",{className:"anime-header",style:{position:"relative",display:"flex",justifyContent:"center",alignItems:"center",textAlign:"center",width:"100%"},children:[c.jsxs("div",{style:{textAlign:"center",margin:"0 auto",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"0 60px"},children:[c.jsx("h1",{className:"anime-title",style:{margin:0,fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Tyler's Anime Library"}),c.jsx("p",{className:"anime-sub",style:{textAlign:"center",margin:"6px 0 0"},children:"The Anime I've watched/watching synced directly from MAL (MyAnimeList)"})]}),(ie||n)&&c.jsxs("div",{style:{position:"absolute",right:0,top:"50%",transform:"translateY(-50%)",display:"flex",gap:"10px"},children:[ie&&c.jsx("button",{className:"suggestion-trigger",type:"button",onClick:()=>{ve(""),F(!0)},children:"+ Suggestion"}),n&&c.jsx("button",{className:"stat-link",type:"button",onClick:se,children:"Download Images"})]})]}),c.jsxs("div",{className:"anime-stats",children:[c.jsxs("div",{className:"anime-stat-card",children:[c.jsx("div",{className:"anime-stat-label",children:"Total Entries"}),c.jsx("div",{className:"anime-stat-value",children:Ce.total})]}),c.jsxs("div",{className:"anime-stat-card",children:[c.jsx("div",{className:"anime-stat-label",children:"Episodes Watched"}),c.jsx("div",{className:"anime-stat-value",children:Ke})]}),c.jsxs("div",{className:"anime-stat-card",children:[c.jsx("div",{className:"anime-stat-label",children:"Watching"}),c.jsx("div",{className:"anime-stat-value",children:Ce.byStatus.watching})]}),c.jsxs("div",{className:"anime-stat-card",children:[c.jsx("div",{className:"anime-stat-label",children:"Completed"}),c.jsx("div",{className:"anime-stat-value",children:Ce.byStatus.completed})]}),c.jsxs("div",{className:"anime-stat-card",children:[c.jsx("div",{className:"anime-stat-label",children:"Plan to Watch"}),c.jsx("div",{className:"anime-stat-value",children:Ce.byStatus.plan_to_watch})]}),c.jsxs("div",{className:"anime-stat-card",children:[c.jsx("div",{className:"anime-stat-label",children:"Avg. Score"}),c.jsx("div",{className:"anime-stat-value",children:Ce.avgScore?Ce.avgScore.toFixed(1):"0.0"})]}),c.jsxs("div",{className:"anime-stat-card",children:[c.jsx("div",{className:"anime-stat-label",children:"Days Watched"}),c.jsx("div",{className:"anime-stat-value",children:Ze.toFixed(1)})]})]}),c.jsxs("section",{className:"anime-toolbar",children:[c.jsx("input",{type:"text",placeholder:"Search anime by title...",value:m,onChange:de=>v(de.target.value),className:"anime-input"}),c.jsxs("select",{value:w,onChange:de=>E(de.target.value),className:"anime-select",children:[c.jsx("option",{value:"all",children:"All statuses"}),c.jsx("option",{value:"watching",children:"Watching"}),c.jsx("option",{value:"completed",children:"Completed"}),c.jsx("option",{value:"on_hold",children:"On Hold"}),c.jsx("option",{value:"plan_to_watch",children:"Plan to Watch"}),c.jsx("option",{value:"dropped",children:"Dropped"})]})]}),C&&c.jsx("div",{className:"loading",children:"Loading anime list from MAL..."}),G&&c.jsx("div",{className:"error-state",children:G}),!C&&!G&&c.jsx(c.Fragment,{children:d.length===0?c.jsx("div",{className:"empty-state",children:"No results match your filters yet."}):c.jsx("section",{className:"anime-grid",children:d.map(de=>ot(de))})})]}),me.length>0&&c.jsxs("aside",{className:"anime-updates-float",children:[c.jsxs("div",{className:"anime-updates-header",children:[c.jsx("h3",{children:"Recent Updates"}),c.jsx("span",{className:"anime-updates-caption",children:"Last list activity"})]}),c.jsx("div",{className:"anime-updates-list",children:me.map(de=>jt(de))})]}),ie&&c.jsx(jw,{open:V,title:"Suggest an Anime",placeholder:"Type an anime you'd like me to watch...",value:D,status:ge,loading:lt,onChange:I,onSubmit:Te,onClose:()=>F(!1)}),O&&c.jsx("div",{className:"modal-backdrop visible",onClick:de=>{de.target===de.currentTarget&&re(null)},children:c.jsxs("div",{className:"anime-modal",children:[c.jsxs("div",{className:"anime-modal-header",children:[c.jsx("h2",{style:{color:"#ffb6c1",margin:0},children:O.title}),c.jsx("button",{className:"anime-modal-close",onClick:()=>re(null),type:"button",children:"Close"})]}),c.jsxs("div",{className:"anime-modal-body",children:[c.jsx("div",{children:c.jsx("img",{className:"anime-modal-cover",src:O.image||"https://imgur.com/chUgq4W.png",alt:O.title})}),c.jsxs("div",{className:"anime-modal-meta",children:[c.jsxs("div",{children:[c.jsx("strong",{children:"Status:"})," ",s(O.status)]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Episodes:"})," ",O.episodes?O.episodes:"Unknown"]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Progress:"})," ",Number.isFinite(Number(O.watchedEpisodes))?`Episode ${O.watchedEpisodes}${Number.isFinite(Number(O.episodes))?`/${O.episodes}`:""}`:"Unknown"]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Score:"})," ",Number.isFinite(Number(O.score))&&Number(O.score)>0?O.score:"Not rated"]})]}),c.jsx(RR,{modalItem:O,modalLoading:oe,modalSynopsisShown:Se,onReveal:async()=>{if(!O)return;b(!0);const de=O.id;if(!de)return;const ke=ye[de];if(ke!==void 0){re(Me=>Me&&{...Me,synopsis:ke});return}Ee(!0);try{const Me=await IR(de);ne(Ue=>({...Ue,[de]:Me||""})),re(Ue=>Ue&&{...Ue,synopsis:Me||""})}catch{ne(Ue=>({...Ue,[de]:""})),re(Ue=>Ue&&{...Ue,synopsis:""})}finally{Ee(!1)}}})]})]})})]})}function RR({modalItem:n,modalLoading:e,modalSynopsisShown:t,onReveal:s}){var m;const a=((m=n==null?void 0:n.synopsis)==null?void 0:m.trim())||"",[l,d]=j.useState(0),f=j.useRef(null);return j.useEffect(()=>{if(t&&f.current){const v=f.current.scrollHeight+12;d(v)}else d(0)},[t,a]),c.jsxs("div",{className:"anime-modal-summary",children:[c.jsxs("div",{className:"anime-modal-summary-header",children:[c.jsx("h3",{children:"Synopsis"}),!t&&c.jsx("button",{className:"anime-synopsis-btn",type:"button",onClick:s,children:e?"Loading...":"Reveal Synopsis"})]}),c.jsx("div",{className:`anime-modal-summary-body ${t?"is-open":""}`,style:{maxHeight:t?`${l}px`:0,opacity:t?1:0},children:c.jsx("div",{ref:f,children:c.jsx("p",{className:"anime-modal-summary-text",children:e&&!a?"Loading synopsis...":a||"No synopsis available."})})}),!t&&c.jsx("p",{className:"anime-modal-summary-text anime-modal-summary-hint",children:"Synopsis hidden. Click reveal to view."})]})}function AR(){const n={game:"pokemon",name:"",setName:"",number:"",rarity:"",condition:"",quantity:1,pricePaid:"",estimatedValue:"",image:"",productURL:"",notes:""},{admin:e,user:t}=jo(),[s,a]=j.useState([]),[l,d]=j.useState(!0),[f,m]=j.useState(""),[v,w]=j.useState("all"),[E,C]=j.useState("name"),[U,G]=j.useState(!1),[K,O]=j.useState([]),[re,ye]=j.useState(""),[ne,oe]=j.useState(null),[Ee,Se]=j.useState(!1),[b,A]=j.useState(n);j.useEffect(()=>{document.title="TCG | Collection"},[]),j.useEffect(()=>{let L=!1;const ee=async()=>{if(!L)try{const J=await fetch("/base/tcg-collection.json",{cache:"no-cache"});if(!J.ok)throw new Error("fallback fetch failed");const me=await J.json(),ie=Array.isArray(me.tcg)?me.tcg:[];L||a(ie.map((Te,Ce)=>({id:Te.id||`offline-${Ce}`,...Te})))}catch(R){console.error("TCG offline fallback failed",R)}finally{L||d(!1)}};async function se(){d(!0);try{const R=Hn(tt,"tcg"),J=await Hs(R),me=[];J.forEach(ie=>me.push({id:ie.id,...ie.data()})),L||a(me)}catch(R){console.error("Error loading TCG:",R),await ee()}finally{L||d(!1)}}return se(),()=>{L=!0}},[t]);const k=s.filter(L=>{if(v!=="all"&&L.game!==v)return!1;if(!f)return!0;const ee=f.toLowerCase();return(L.name||"").toLowerCase().includes(ee)||(L.setName||"").toLowerCase().includes(ee)||(L.number||"").toLowerCase().includes(ee)}),V=[...k].sort((L,ee)=>{const se=(L.name||"").toLowerCase(),R=(ee.name||"").toLowerCase(),J=(L.setName||"").toLowerCase(),me=(ee.setName||"").toLowerCase(),ie=(L.rarity||"").toLowerCase(),Te=(ee.rarity||"").toLowerCase(),Ce=Number(L.quantity||0),Ze=Number(ee.quantity||0),Ke=Number(L.estimatedValue||0)*Math.max(1,Ce),ot=Number(ee.estimatedValue||0)*Math.max(1,Ze);switch(E){case"set":return J.localeCompare(me)||se.localeCompare(R);case"rarity":return ie.localeCompare(Te)||se.localeCompare(R);case"quantity":return Ze-Ce||se.localeCompare(R);case"value":return ot-Ke||se.localeCompare(R);case"name":default:return se.localeCompare(R)}}),F=s.reduce((L,ee)=>{const se=Number(ee.quantity||1),R=Number(ee.pricePaid||0),J=Number(ee.estimatedValue||0);return L.totalCards+=se,L.totalPaid+=se*R,L.totalValue+=se*J,ee.game==="pokemon"&&(L.pokemon+=se),ee.game==="onepiece"&&(L.onepiece+=se),ee.game==="mtg"&&(L.mtg+=se),L},{totalCards:0,totalPaid:0,totalValue:0,pokemon:0,onepiece:0,mtg:0}),D=F.totalValue-F.totalPaid,I=(L,ee)=>{A(se=>({...se,[L]:ee}))},ge=async()=>{if(!e)return;if(!b.name.trim()){alert("Card name is required.");return}const L={game:b.game,name:b.name.trim(),setName:b.setName.trim(),number:b.number.trim(),rarity:b.rarity.trim(),condition:b.condition.trim(),quantity:Number(b.quantity||1),pricePaid:Number(b.pricePaid||0),estimatedValue:Number(b.estimatedValue||0),image:b.image.trim(),productURL:b.productURL.trim(),notes:b.notes.trim()},ee=J=>({game:(J.game||"").toLowerCase().trim(),name:(J.name||"").toLowerCase().trim(),setName:(J.setName||"").toLowerCase().trim(),number:(J.number||"").toLowerCase().trim(),rarity:(J.rarity||"").toLowerCase().trim(),condition:(J.condition||"").toLowerCase().trim(),pricePaid:Number(J.pricePaid||0),estimatedValue:Number(J.estimatedValue||0),image:(J.image||"").trim(),productURL:(J.productURL||"").trim(),notes:(J.notes||"").trim()}),se=ee(L),R=s.find(J=>{const me=ee(J);return me.game===se.game&&me.name===se.name&&me.setName===se.setName&&me.number===se.number&&me.rarity===se.rarity&&me.condition===se.condition&&me.pricePaid===se.pricePaid&&me.estimatedValue===se.estimatedValue&&me.image===se.image&&me.productURL===se.productURL&&me.notes===se.notes});try{const J=Hn(tt,"tcg");if(R!=null&&R.id){const me=Number(R.quantity||1)+L.quantity;await _s(At(tt,"tcg",R.id),{quantity:me}),a(ie=>ie.map(Te=>Te.id===R.id?{...Te,quantity:me}:Te))}else{await Ei(J,L);const me=await Hs(J),ie=[];me.forEach(Te=>ie.push({id:Te.id,...Te.data()})),a(ie)}A(n),Se(!1)}catch(J){console.error("Error adding card:",J),alert("Failed to save card.")}},ve=async()=>{if(!e||!ne)return;if(!ne.name.trim()){alert("Card name is required.");return}const L={game:ne.game,name:ne.name.trim(),setName:ne.setName.trim(),number:ne.number.trim(),rarity:ne.rarity.trim(),condition:ne.condition.trim(),quantity:Number(ne.quantity||1),pricePaid:Number(ne.pricePaid||0),estimatedValue:Number(ne.estimatedValue||0),image:ne.image?ne.image.trim():"",productURL:ne.productURL?ne.productURL.trim():"",notes:ne.notes?ne.notes.trim():""};try{await _s(At(tt,"tcg",ne.id),L),a(ee=>ee.map(se=>se.id===ne.id?{...se,...L}:se)),oe(null)}catch(ee){console.error("Error updating card:",ee),alert("Failed to update card.")}},lt=async L=>{if(e&&window.confirm("Delete this card?"))try{await pa(At(tt,"tcg",L)),a(ee=>ee.filter(se=>se.id!==L))}catch(ee){console.error("Delete error:",ee),alert("Failed to delete card.")}},Be=()=>{if(!s.length){alert("No cards to export.");return}const L=new Blob([JSON.stringify({tcg:s},null,2)],{type:"application/json"}),ee=URL.createObjectURL(L),se=document.createElement("a");se.href=ee,se.download="tcg-collection.json",se.click(),URL.revokeObjectURL(ee)};return c.jsxs("main",{className:"page",children:[c.jsxs("header",{style:{marginTop:"32px",marginBottom:"16px",display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",gap:"6px"},children:[c.jsx("h1",{style:{margin:0,fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Tyler's TCG Collection"}),c.jsx("p",{style:{margin:"6px 0 0",color:"var(--text-soft)",fontSize:"0.9rem"},children:"Check out my TCG Collection with all the data of how much I spent (Under construction) and how much my collection is worth in total!"}),e&&c.jsx("div",{style:{marginTop:"10px"},children:c.jsx("button",{className:"manga-btn secondary",type:"button",onClick:Be,children:"Export JSON"})})]}),e&&c.jsx("button",{className:"manga-btn",type:"button","aria-label":"Add card",onClick:()=>Se(!0),style:{position:"fixed",bottom:"20px",right:"20px",zIndex:1e3,width:"56px",height:"56px",borderRadius:"50%",padding:0,fontSize:"28px",display:"flex",alignItems:"center",justifyContent:"center"},children:"+"}),e&&Ee&&c.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(8,1,10,0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,padding:"12px"},onClick:L=>{L.target===L.currentTarget&&Se(!1)},children:c.jsxs("div",{style:{width:"min(720px, 95vw)",background:"#140710",border:"1px solid rgba(255,182,193,0.3)",borderRadius:"12px",padding:"14px",boxShadow:"0 24px 60px rgba(0,0,0,0.85)"},onClick:L=>L.stopPropagation(),children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[c.jsx("h2",{style:{margin:0,color:"#ffb6c1"},children:"Add card"}),c.jsx("button",{className:"dashboard-close",onClick:()=>Se(!1),type:"button",children:"Close"})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"180px 1fr",gap:"12px",alignItems:"flex-start",marginTop:"10px"},children:[c.jsx("div",{style:{width:"100%",maxWidth:"180px",borderRadius:"10px",border:"1px solid rgba(255,182,193,0.25)",background:"#1e0d14",overflow:"hidden",aspectRatio:"3 / 4",display:"flex",alignItems:"center",justifyContent:"center"},children:b.image?c.jsx("img",{src:b.image,alt:"Card preview",style:{width:"100%",height:"100%",objectFit:"cover"}}):c.jsx("div",{style:{color:"var(--text-soft)",fontSize:"0.8rem",padding:"6px"},children:"No image"})}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:"8px"},children:[c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Game",c.jsxs("select",{value:b.game,onChange:L=>I("game",L.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"},children:[c.jsx("option",{value:"pokemon",children:"Pokemon"}),c.jsx("option",{value:"onepiece",children:"One Piece"}),c.jsx("option",{value:"mtg",children:"MTG"})]})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Card name",c.jsx("input",{type:"text",value:b.name,onChange:L=>I("name",L.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Set name",c.jsx("input",{type:"text",value:b.setName,onChange:L=>I("setName",L.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Card number",c.jsx("input",{type:"text",value:b.number,onChange:L=>I("number",L.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Rarity",c.jsx("input",{type:"text",value:b.rarity,onChange:L=>I("rarity",L.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Condition",c.jsx("input",{type:"text",value:b.condition,onChange:L=>I("condition",L.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Quantity",c.jsx("input",{type:"number",min:"1",value:b.quantity,onChange:L=>I("quantity",L.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Price paid (per card)",c.jsx("input",{type:"number",step:"0.01",min:"0",value:b.pricePaid,onChange:L=>I("pricePaid",L.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Estimated value (per card)",c.jsx("input",{type:"number",step:"0.01",min:"0",value:b.estimatedValue,onChange:L=>I("estimatedValue",L.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Image URL",c.jsx("input",{type:"text",value:b.image||"",onChange:L=>I("image",L.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Product URL (backend only)",c.jsx("input",{type:"text",value:b.productURL||"",onChange:L=>I("productURL",L.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{gridColumn:"1 / -1",fontSize:"0.8rem",color:"var(--text-soft)"},children:["Notes",c.jsx("textarea",{value:b.notes,onChange:L=>I("notes",L.target.value),rows:3,style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff",resize:"vertical"}})]})]})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"12px"},children:[c.jsx("button",{onClick:()=>{A(n),Se(!1)},style:{padding:"6px 12px",borderRadius:"999px",border:"1px solid rgba(255,182,193,0.5)",background:"transparent",color:"#ffb6c1",cursor:"pointer"},children:"Cancel"}),c.jsx("button",{onClick:ge,style:{padding:"6px 12px",borderRadius:"999px",border:"none",cursor:"pointer",fontWeight:600,background:"#ff69b4",color:"#1e0d14"},children:"Save card"})]})]})}),e&&ne&&c.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(8,1,10,0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,padding:"12px"},onClick:L=>{L.target===L.currentTarget&&oe(null)},children:c.jsxs("div",{style:{width:"min(720px, 95vw)",background:"#140710",border:"1px solid rgba(255,182,193,0.3)",borderRadius:"12px",padding:"14px",boxShadow:"0 24px 60px rgba(0,0,0,0.85)"},onClick:L=>L.stopPropagation(),children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[c.jsx("h2",{style:{margin:0,color:"#ffb6c1"},children:"Edit card"}),c.jsx("button",{className:"dashboard-close",onClick:()=>oe(null),type:"button",children:"Close"})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"180px 1fr",gap:"12px",alignItems:"flex-start",marginTop:"10px"},children:[c.jsx("div",{style:{width:"100%",maxWidth:"180px",borderRadius:"10px",border:"1px solid rgba(255,182,193,0.25)",background:"#1e0d14",overflow:"hidden",aspectRatio:"3 / 4",display:"flex",alignItems:"center",justifyContent:"center"},children:ne.image?c.jsx("img",{src:ne.image,alt:"Card preview",style:{width:"100%",height:"100%",objectFit:"cover"}}):c.jsx("div",{style:{color:"var(--text-soft)",fontSize:"0.8rem",padding:"6px"},children:"No image"})}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:"8px"},children:[c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Game",c.jsxs("select",{value:ne.game,onChange:L=>oe(ee=>({...ee,game:L.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"},children:[c.jsx("option",{value:"pokemon",children:"Pokemon"}),c.jsx("option",{value:"onepiece",children:"One Piece"}),c.jsx("option",{value:"mtg",children:"MTG"})]})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Card name",c.jsx("input",{type:"text",value:ne.name,onChange:L=>oe(ee=>({...ee,name:L.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Set name",c.jsx("input",{type:"text",value:ne.setName,onChange:L=>oe(ee=>({...ee,setName:L.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Card number",c.jsx("input",{type:"text",value:ne.number,onChange:L=>oe(ee=>({...ee,number:L.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Rarity",c.jsx("input",{type:"text",value:ne.rarity,onChange:L=>oe(ee=>({...ee,rarity:L.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Condition",c.jsx("input",{type:"text",value:ne.condition,onChange:L=>oe(ee=>({...ee,condition:L.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Quantity",c.jsx("input",{type:"number",value:ne.quantity,onChange:L=>oe(ee=>({...ee,quantity:L.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Price paid (each)",c.jsx("input",{type:"number",value:ne.pricePaid,onChange:L=>oe(ee=>({...ee,pricePaid:L.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Estimated value (each)",c.jsx("input",{type:"number",value:ne.estimatedValue,onChange:L=>oe(ee=>({...ee,estimatedValue:L.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Image URL",c.jsx("input",{type:"text",value:ne.image||"",onChange:L=>oe(ee=>({...ee,image:L.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Product URL (backend only)",c.jsx("input",{type:"text",value:ne.productURL||"",onChange:L=>oe(ee=>({...ee,productURL:L.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{gridColumn:"1 / -1",fontSize:"0.8rem",color:"var(--text-soft)"},children:["Notes",c.jsx("textarea",{value:ne.notes||"",onChange:L=>oe(ee=>({...ee,notes:L.target.value})),rows:3,style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff",resize:"vertical"}})]})]})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"12px"},children:[c.jsx("button",{onClick:()=>oe(null),style:{padding:"6px 12px",borderRadius:"999px",border:"1px solid rgba(255,182,193,0.5)",background:"transparent",color:"#ffb6c1",cursor:"pointer"},children:"Cancel"}),c.jsx("button",{onClick:ve,style:{padding:"6px 12px",borderRadius:"999px",border:"none",cursor:"pointer",fontWeight:600,background:"#ff69b4",color:"#1e0d14"},children:"Save changes"})]})]})}),c.jsxs("section",{style:{display:"flex",flexWrap:"wrap",gap:"12px",marginTop:"18px",justifyContent:"center"},children:[c.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[c.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Total cards"}),c.jsx("div",{style:{fontSize:"1.1rem",fontWeight:700},children:F.totalCards})]}),c.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[c.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Total paid"}),c.jsxs("div",{style:{fontSize:"1.1rem",fontWeight:700},children:["$",F.totalPaid.toFixed(2)]})]}),c.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[c.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Total value"}),c.jsxs("div",{style:{fontSize:"1.1rem",fontWeight:700},children:["$",F.totalValue.toFixed(2)]})]}),c.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[c.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Unrealized gain / loss"}),c.jsxs("div",{style:{fontSize:"1.1rem",fontWeight:700,color:D>=0?"#00e676":"#ff8a80"},children:[D>=0?"+":"-","$",Math.abs(D).toFixed(2)]})]}),c.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[c.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Pokemon cards"}),c.jsx("div",{style:{fontSize:"1.1rem",fontWeight:700},children:F.pokemon})]}),c.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[c.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"One Piece cards"}),c.jsx("div",{style:{fontSize:"1.1rem",fontWeight:700},children:F.onepiece})]}),c.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[c.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"MTG cards"}),c.jsx("div",{style:{fontSize:"1.1rem",fontWeight:700},children:F.mtg})]})]}),c.jsxs("section",{style:{display:"flex",flexWrap:"wrap",gap:"10px",marginTop:"16px"},children:[c.jsx("input",{type:"text",placeholder:"Search by name, set, or number...",value:f,onChange:L=>m(L.target.value),style:{flex:"1 1 220px",minWidth:"220px",padding:"8px 12px",borderRadius:"999px",border:"1px solid #bb7f8f",background:"#2b0f1d",color:"#fff"}}),c.jsxs("select",{value:v,onChange:L=>w(L.target.value),style:{flex:"0 0 220px",padding:"8px 12px",borderRadius:"999px",border:"1px solid #bb7f8f",background:"#2b0f1d",color:"#fff"},children:[c.jsx("option",{value:"all",children:"All games"}),c.jsx("option",{value:"pokemon",children:"Pokemon only"}),c.jsx("option",{value:"onepiece",children:"One Piece only"}),c.jsx("option",{value:"mtg",children:"MTG only"})]}),c.jsxs("select",{value:E,onChange:L=>C(L.target.value),style:{flex:"0 0 220px",padding:"8px 12px",borderRadius:"999px",border:"1px solid #bb7f8f",background:"#2b0f1d",color:"#fff"},children:[c.jsx("option",{value:"name",children:"Sort: Name (A-Z)"}),c.jsx("option",{value:"set",children:"Sort: Set (A-Z)"}),c.jsx("option",{value:"rarity",children:"Sort: Rarity (A-Z)"}),c.jsx("option",{value:"quantity",children:"Sort: Quantity (high to low)"}),c.jsx("option",{value:"value",children:"Sort: Value (high to low)"})]})]}),l?c.jsx("p",{style:{marginTop:"20px",color:"var(--text-soft)"},children:"Loading TCG collection..."}):k.length===0?c.jsx("p",{style:{marginTop:"20px",color:"var(--text-soft)"},children:"No cards found."}):c.jsx("section",{className:"grid",style:{gridTemplateColumns:"repeat(auto-fill, minmax(170px, 1fr))",marginTop:"20px"},children:V.map(L=>{const ee=Number(L.quantity||1),se=ee*Number(L.pricePaid||0),R=ee*Number(L.estimatedValue||0);return c.jsxs("article",{style:{background:"#2b0f1d",borderRadius:"12px",border:"1px solid rgba(255,182,193,0.25)",boxShadow:"0 4px 16px rgba(0,0,0,0.55)",padding:"10px",fontSize:"0.82rem",display:"flex",flexDirection:"column",gap:"6px"},children:[L.image&&c.jsx("div",{style:{width:"100%",paddingTop:"140%",position:"relative",overflow:"hidden",borderRadius:"10px",background:"#1e0d14"},children:c.jsx("img",{src:L.image,alt:L.name||"card image",style:{position:"absolute",inset:0,width:"100%",height:"100%",objectFit:"contain"}})}),c.jsx("div",{style:{fontWeight:700,color:"#ffb6c1",marginBottom:"4px"},children:L.name||"Unnamed card"}),c.jsx("div",{style:{color:"var(--text-soft)",marginBottom:"4px"},children:L.setName||""}),c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",color:"var(--text-soft)"},children:[c.jsxs("span",{children:["#",L.number||"-"]}),c.jsx("span",{children:L.rarity||""})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",color:"var(--text-soft)",marginTop:"4px"},children:[c.jsxs("span",{children:["Cond: ",L.condition||"N/A"]}),c.jsxs("span",{children:["Qty: ",ee]})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",color:"var(--text-soft)",marginTop:"4px"},children:[c.jsxs("span",{children:["Paid: $",se.toFixed(2)]}),c.jsxs("span",{children:["Value: $",R.toFixed(2)]})]}),L.notes&&c.jsxs("div",{style:{color:"#9c8fa6",fontSize:"0.72rem",fontStyle:"italic",textAlign:"center",marginTop:"6px"},children:['"',L.notes,'"']}),c.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"8px"},children:[c.jsx("span",{style:{padding:"2px 7px",borderRadius:"999px",background:"rgba(255,105,180,0.18)",border:"1px solid rgba(255,105,180,0.5)",color:"#ffb6c1",fontSize:"0.7rem",whiteSpace:"nowrap"},children:{pokemon:"Pokemon",onepiece:"One Piece",mtg:"MTG"}[L.game]||"Other"}),e&&c.jsxs("div",{style:{display:"flex",gap:"6px",alignItems:"center",marginLeft:"auto"},children:[c.jsx("button",{onClick:()=>oe({...L,pricePaid:L.pricePaid??"",estimatedValue:L.estimatedValue??"",quantity:L.quantity??1}),style:{padding:"3px 8px",borderRadius:"999px",border:"1px solid rgba(255,182,193,0.5)",background:"rgba(255,105,180,0.15)",color:"#ffb6c1",fontSize:"0.7rem",cursor:"pointer"},children:"Edit"}),c.jsx("button",{onClick:()=>lt(L.id),style:{padding:"3px 8px",borderRadius:"999px",border:"1px solid rgba(244,67,54,0.7)",background:"rgba(244,67,54,0.12)",color:"#ff8a80",fontSize:"0.7rem",cursor:"pointer"},children:"Delete"})]})]})]},L.id)})})]})}const dl="https://discord.com/api/webhooks/1448287168845054004/cGWGPoH5LaTFlBZ1vxtgMjOfV9au6qyQ_9ZRnOWN9-AX0MNfwxKNWVcZYQHz0ESA7_4k",hl="https://discord.com/api/webhooks/1448288240871276616/101WI-B2p8tDR34Hl9fZxxb0QG01f1Eo5w1IvbttlQmP2wWFNJ0OI7UnJfJujKRNWW2Q",fl="https://discord.com/api/webhooks/1448329790942613667/wsC8psNZ-Ax2D1O9Gl4sJi6ay7df2cr7IrIdxMPwGZTBnkSUIY2NDpeVd98qW_4plz82",Mv="mangaLibraryActivityLog";function Zl(n){const e=n==null?"":String(n);return e.trim()?e.replace(/\s*,?\s*(?:vol(?:ume)?\.?)\s+\d+.*$/i,"").trim():""}function Ea(n){if(!n)return null;if(n instanceof Date)return n;if(n&&typeof n.toDate=="function")return n.toDate();const e=String(n).trim();if(!e)return null;const t=e.match(/^(\d{4})-(\d{2})-(\d{2})$/);if(t){const[,l,d,f]=t;return new Date(Number(l),Number(d)-1,Number(f))}const s=e.match(/^(\d{1,2})\/(\d{1,2})\/(\d{2,4})$/);if(s){let[,l,d,f]=s;const m=f.length===2?+`20${f}`:Number(f);return new Date(m,Number(l)-1,Number(d))}const a=new Date(e);return isNaN(a.getTime())?null:a}function hd(n){const e=n.seriesKey||n.series||n.Series||n.title||n.Title||"",s=(Zl(e)||e).trim();return s?s.toLowerCase():""}function NR(n){const e=(n==null?void 0:n.series)||(n==null?void 0:n.Series)||(n==null?void 0:n.title)||(n==null?void 0:n.Title)||"Unknown Series";return Zl(e)||"Unknown Series"}function Fv(n){const e=(n||"").trim(),t=e.match(/^(.*?)(?:,?\s*(?:vol\.|volume)\s*(\d+)(?:\s*[-]\s*\d+)?\s*)?(?:\s*\([^)]*\))?$/i),s=t?t[1].trim().toLowerCase():e.toLowerCase(),a=t&&t[2]?parseInt(t[2],10):0;return{name:s,vol:Number.isFinite(a)?a:0}}function kR(n,e){const t=(n==null?void 0:n.Title)||(n==null?void 0:n.title)||"",s=(e==null?void 0:e.Title)||(e==null?void 0:e.title)||"",a=Fv(t),l=Fv(s),d=a.name.localeCompare(l.name);return d!==0?d:a.vol!==l.vol?a.vol-l.vol:t.localeCompare(s)}function Zh(){return{publisher:"",demographic:"",genre:"",subGenre:"",datePurchased:"",msrp:"",initialPublisher:"",initialDemographic:"",initialGenre:"",initialSubGenre:"",initialDatePurchased:"",initialMsrp:"",dateMixed:!1,readChecked:!1,readIndeterminate:!1}}function Uv(){return{read:!1,datePurchased:"",dateRead:"",pageCount:"",msrp:"",amountPaid:"",rating:"",special:!1,specialType:"",specialVolumes:"",collectiblePrice:""}}function zv(n,e={}){const t=e.ignoreShared,s=(n==null?void 0:n.amountPaid)??(n==null?void 0:n.AmountPaid)??(n==null?void 0:n.paid)??(n==null?void 0:n.Paid)??"",a=(n==null?void 0:n.msrp)??(n==null?void 0:n.MSRP)??"",l=((n==null?void 0:n.datePurchased)||(n==null?void 0:n.DatePurchased)||"").trim(),d=((n==null?void 0:n.publisher)||(n==null?void 0:n.Publisher)||"").trim(),f=((n==null?void 0:n.demographic)||(n==null?void 0:n.Demographic)||"").trim(),m=((n==null?void 0:n.genre)||(n==null?void 0:n.Genre)||"").trim(),v=((n==null?void 0:n.specialType)||(n==null?void 0:n.SpecialType)||"").trim(),w=(n==null?void 0:n.specialVolumes)??(n==null?void 0:n.SpecialVolumes)??(n==null?void 0:n.volumesContained)??"",E=(n==null?void 0:n.collectiblePrice)??(n==null?void 0:n.CollectiblePrice)??"",C=!!v,U=(n==null?void 0:n.pageCount)??(n==null?void 0:n.PageCount)??(n==null?void 0:n.pages)??(n==null?void 0:n.Pages)??"",G=U==null?"":String(U).trim(),K=Number(G),O=!G||Number.isNaN(K)||K<=0;return!C&&(s===""||s===null)||O||!l||!t&&(a===""||!d||!f||!m)||C&&!v||C&&v.toLowerCase()==="collectible"&&(E===""||E===null)||C&&v.toLowerCase()==="specialedition"&&(w===""||w===null)}function jR(n){const e=(n==null?void 0:n.amountPaid)??"",t=((n==null?void 0:n.datePurchased)||"").trim(),s=!!(n!=null&&n.specialType)||!!(n!=null&&n.special),a=((n==null?void 0:n.specialType)||"").trim(),l=(n==null?void 0:n.specialVolumes)??"",d=(n==null?void 0:n.collectiblePrice)??"",f=(n==null?void 0:n.pageCount)??"",m=(n==null?void 0:n.msrp)??"",v=((n==null?void 0:n.publisher)||"").trim(),w=((n==null?void 0:n.demographic)||"").trim(),E=((n==null?void 0:n.genre)||"").trim(),C=!s&&(e===""||e===null),U=s&&!a,G=s&&a.toLowerCase()==="collectible"&&(d===""||d===null),K=s&&a.toLowerCase()==="specialedition"&&(l===""||l===null),O=(()=>{const re=(f??"").toString().trim();if(re==="")return!0;const ye=Number(re);return Number.isNaN(ye)||ye<=0})();return{amountPaid:C,datePurchased:!t,specialType:U,collectiblePrice:G,specialVolumes:K,pageCount:O,msrp:m===""||m===null,publisher:!v,demographic:!w,genre:!E}}function DR(n){return!n||!n.books||!n.books.length?!1:n.books.some(e=>{const t=(e==null?void 0:e.msrp)??(e==null?void 0:e.MSRP)??"",s=((e==null?void 0:e.publisher)||(e==null?void 0:e.Publisher)||"").trim(),a=((e==null?void 0:e.demographic)||(e==null?void 0:e.Demographic)||"").trim(),l=((e==null?void 0:e.genre)||(e==null?void 0:e.Genre)||"").trim();return t===""||!s||!a||!l})}function LR(n){const e=new Map;for(const t of n){const s=hd(t)||t.id;if(!e.has(s)){const m=Zl(t.series||t.Series||t.title||t.Title||"Unknown Series")||"Unknown Series";e.set(s,{key:s,title:m,publisher:t.publisher||t.Publisher||"",genre:t.genre||t.Genre||"",demographic:t.demographic||t.Demographic||"",volumes:0,totalPages:0,readPages:0,readVolumes:0,ratingSum:0,ratingCount:0})}const a=e.get(s);a.volumes+=1;const l=Number(t.pages||t.Pages||t.pageCount||0)||0;a.totalPages+=l,(!!t.read||t.status==="Read"||t.Read===!0)&&(a.readVolumes+=1,a.readPages+=l);const f=Number(t.rating||t.Rating);!isNaN(f)&&f>0&&(a.ratingSum+=f,a.ratingCount+=1)}return e}function io(n,e,t=5){const s=new Map;for(const a of n.values()){const l=(a[e]||"").trim();if(!l)continue;const d=l.split(/[\/,]/).map(f=>f.trim()).filter(Boolean);for(const f of d)s.set(f,(s.get(f)||0)+1)}return[...s.entries()].sort((a,l)=>l[1]-a[1]).slice(0,t).map(([a,l])=>({name:a,count:l}))}function Bv(n,e){const t=Array.from({length:12},(s,a)=>{const l=new Date(e,a,1);return{key:`${e}-${a}`,label:l.toLocaleString("default",{month:"short"}),year:e,month:a,value:0}});for(const s of n){const a=Ea(s.dateRead||s.DateRead);!a||a.getFullYear()!==e||(t[a.getMonth()].value+=1)}return t}function wl(n){const e=n.getFullYear(),t=`${n.getMonth()+1}`.padStart(2,"0"),s=`${n.getDate()}`.padStart(2,"0");return`${e}-${t}-${s}`}async function ef(n,e){try{await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:e})})}catch(t){console.error("Webhook post failed",t)}}function VR(n){const e=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],t=Array(7).fill(0);for(const l of n){const d=Ea(l.dateRead||l.DateRead);d&&(t[d.getDay()]+=1)}if(!t.some(l=>l>0))return[];const a=t.reduce((l,d)=>Math.max(l,d),0)||1;return e.map((l,d)=>({label:l,value:t[d],pct:t[d]/a}))}function OR(n,e=8){const t=[...n.values()];t.sort((l,d)=>d.volumes-l.volumes);const s=t.slice(0,e),a=s.reduce((l,d)=>Math.max(l,d.volumes),0)||1;return s.map(l=>({label:l.title,value:l.volumes,pct:l.volumes/a}))}function MR(n){const e=[];for(const t of n){const s=Ea(t.releaseDate||t.ReleaseDate||t.date||t.Date)||null;if(!s)continue;const a=(t.title||t.series||t.Title||"Unknown Title").trim();e.push({date:s,title:a})}return e.sort((t,s)=>t.date-s.date),e}function FR(n){const e=new Date;for(const t of n)if(t.date>=e)return t;return n[n.length-1]||null}function UR(n){let e=0,t=0;for(const s of n){const a=Ea(s.datePurchased||s.DatePurchased),l=Ea(s.dateRead||s.DateRead);if(!a||!l)continue;const d=l-a;d<=0||(e+=d/(1e3*60*60*24),t+=1)}return t?e/t:null}function zR(n){const e=new Map;for(const t of n){const s=Ea(t.datePurchased||t.DatePurchased),a=Ea(t.dateRead||t.DateRead);if(!s||!a)continue;const l=a-s;if(l<=0)continue;const d=l/(1e3*60*60*24),f=hd(t)||t.id,m=Zl(t.series||t.Series||t.title||t.Title||"Untitled")||"Untitled";e.has(f)||e.set(f,{key:f,title:m,total:0,count:0,min:d,max:d});const v=e.get(f);v.total+=d,v.count+=1,v.min=Math.min(v.min,d),v.max=Math.max(v.max,d)}return[...e.values()].filter(t=>t.count>0).map(t=>({...t,avg:t.total/t.count})).sort((t,s)=>s.avg-t.avg)}function BR(n){let e=0,t=0,s=0;for(const a of n){const l=Number(a.msrp||a.MSRP||0)||0,d=Number(a.amountPaid||a.AmountPaid||a.pricePaid||0)||l||0,f=Number(a.collectiblePrice||a.CollectiblePrice||0)||0;e+=l,t+=d,s+=f}return{msrpTotal:e,paidTotal:t,collectibleTotal:s}}function $R(n){const e=new Map;for(const t of n){const s=hd(t)||t.id;if(!e.has(s)){const E=t.series||t.Series||t.title||t.Title||"Untitled";e.set(s,{key:s,title:Zl(E)||E.trim()||"Untitled",msrp:0,paid:0,collectible:0,books:0,pages:0,readPages:0,ratings:[]})}const a=e.get(s);a.books+=1;const l=Number(t.msrp||t.MSRP||0)||0,d=Number(t.amountPaid||t.AmountPaid||t.pricePaid||0)||0,f=Number(t.collectiblePrice||t.CollectiblePrice||0)||0,m=Number(t.pages||t.Pages||t.pageCount||0)||0,v=!!t.read||t.status==="Read"||t.Read===!0;a.msrp+=l,a.paid+=d,a.collectible+=f,a.pages+=m,v&&(a.readPages+=m);const w=Number(t.rating||t.Rating);!isNaN(w)&&w>0&&a.ratings.push(w)}return[...e.values()]}function WR(n){let e=0,t=0;for(const s of n){const a=Number(s.pages||s.Pages||s.pageCount||0)||0;e+=a,(!!s.read||s.status==="Read"||s.Read===!0)&&(t+=a)}return{total:e,read:t}}function HR(n){let e=0,t=0;for(const s of n.values())s.ratingCount>0&&(e+=s.ratingSum/s.ratingCount,t+=1);return t?e/t:null}function GR({data:n}){if(!n||!n.length)return c.jsx("div",{className:"line-chart empty",children:"No reading data yet."});const e=n.reduce((v,w)=>Math.max(v,w.value),0)||1,t=480,s=230,a=30,l=s-a*2,d=t/Math.max(n.length-1,1),f=n.map((v,w)=>{const E=w*d,C=s-a-v.value/e*l;return{...v,x:E,y:C}}),m=f.map((v,w)=>w===0?`M ${v.x} ${v.y}`:`L ${v.x} ${v.y}`).join(" ");return c.jsx("div",{className:"line-chart",children:c.jsxs("svg",{viewBox:`0 0 ${t} ${s}`,width:"100%",height:"100%",preserveAspectRatio:"xMidYMid meet",children:[[0,.25,.5,.75,1].map((v,w)=>{const E=s-a-v*l;return c.jsx("line",{className:"line-grid",x1:"0",x2:t,y1:E,y2:E},`h-${w}`)}),f.map((v,w)=>c.jsx("line",{className:"line-grid",x1:v.x,x2:v.x,y1:a/2,y2:s-a/2},`v-${w}`)),c.jsx("path",{className:"line-path",d:m}),f.map((v,w)=>c.jsxs("g",{children:[c.jsx("circle",{className:"line-point",cx:v.x,cy:v.y,r:"1.5"}),c.jsx("text",{className:"line-value",x:v.x,y:v.y-3,children:v.value}),c.jsx("text",{className:"line-label",x:v.x,y:s-4,children:v.label})]},w))]})})}function qR({data:n}){return!n||!n.length?c.jsx("div",{className:"weekday-breakdown empty",children:"No reads recorded yet."}):c.jsx("div",{className:"weekday-bars",children:n.map(e=>c.jsxs("div",{className:"weekday-col",children:[c.jsx("div",{className:"weekday-count",children:e.value}),c.jsx("div",{className:"weekday-bar-vert",children:c.jsx("div",{className:"weekday-bar-vert-fill",style:{height:`${Math.max(e.pct*100,e.value?6:0)}%`}})}),c.jsx("div",{className:"weekday-label",children:e.label})]},e.label))})}function KR(n,e,t){const s=n.getFullYear(),a=n.getMonth(),d=new Date(s,a,1).getDay(),f=new Date(s,a+1,0).getDate(),m=new Map;for(const E of e){const C=E.date;if(C.getFullYear()===s&&C.getMonth()===a){const U=C.getDate();m.has(U)||m.set(U,[]),m.get(U).push(E)}}const v=[];for(let E=0;E<d;E++)v.push({type:"pad"});for(let E=1;E<=f;E++){const C=wl(new Date(s,a,E));v.push({type:"day",day:E,releases:m.get(E)||[],dateKey:C,isToday:C===t})}const w=Math.ceil(v.length/7)*7;for(;v.length<w;)v.push({type:"pad"});return v}function QR(){const{user:n,admin:e,loading:t}=jo(),[s,a]=j.useState([]),[l,d]=j.useState([]),[f,m]=j.useState(!0),[v,w]=j.useState(null),[E,C]=j.useState("-"),[U,G]=j.useState({yearly:dl,release:hl,activity:fl}),[K,O]=j.useState(new Set),[re,ye]=j.useState(null),[ne,oe]=j.useState(null),[Ee,Se]=j.useState(new Set),[b,A]=j.useState(null),[k,V]=j.useState(""),F=j.useRef(null),[D,I]=j.useState(()=>Zh()),[ge,ve]=j.useState(()=>Uv()),[lt,Be]=j.useState([]),[L,ee]=j.useState(!1),[se,R]=j.useState([]),[J,me]=j.useState(!1),[ie,Te]=j.useState([]),[Ce,Ze]=j.useState(!1),[Ke,ot]=j.useState(""),[jt,de]=j.useState(null),[ke,Me]=j.useState(null),Ue=async()=>{if(e)try{me(!0);const B=(await Hs(Hn(tt,"users"))).docs.map(W=>({uid:W.id,...W.data()}));R(B)}catch(S){console.error("Failed to load users",S)}finally{me(!1)}},Tt=async(S,B)=>{const W=(S||"").trim();if(!W){alert("UID is required.");return}try{await Ks(At(tt,"users",W),{role:B,updatedBy:(n==null?void 0:n.uid)||"manual",updatedAt:new Date().toISOString()},{merge:!0}),await Ue()}catch(pe){console.error("Failed to update role",pe),alert("Failed to update role.")}},[Ct,Pt]=j.useState(!1),[bt,zt]=j.useState(()=>new Date),[St,Sn]=j.useState({open:!1,type:null}),ln=new Date().getFullYear(),vn=j.useRef(null),Qt=j.useRef(null);j.useEffect(()=>{document.title="Dashboard"},[]),j.useEffect(()=>(Ct||St.open||L||!!ke?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[Ct,St.open,L,ke]),j.useEffect(()=>{typeof window>"u"||(vn.current=localStorage.getItem("dashboard-yearly-posted"),Qt.current=localStorage.getItem("dashboard-release-posted"))},[]),j.useEffect(()=>{if(!e)return;const S=At(tt,"settings","webhooks");(async()=>{try{const B=await Np(S);if(B.exists()){const W=B.data();G({yearly:W.yearly||dl,release:W.release||hl,activity:W.activity||fl})}else await Ks(S,{yearly:dl,release:hl,activity:fl}),G({yearly:dl,release:hl,activity:fl})}catch(B){console.error("Failed to load webhook settings",B)}})()},[e]),j.useEffect(()=>{if(!e)return;let S=!1;return(async()=>await Ue())(),()=>{S=!0}},[e]),j.useEffect(()=>{let S=!1;if(!n||!e){Te([]),ot("");return}return(async()=>{try{Ze(!0);const W=(await Hs(Hn(tt,"suggestions"))).docs.map(pe=>{var Ie;const Pe=pe.data();let Fe=null;if((Ie=Pe==null?void 0:Pe.createdAt)!=null&&Ie.toDate)Fe=Pe.createdAt.toDate();else if(Pe!=null&&Pe.createdAt){const et=new Date(Pe.createdAt);Fe=isNaN(et.getTime())?null:et}return{id:pe.id,...Pe,createdAt:Fe}});W.sort((pe,Pe)=>{var Fe,Ie,et,wt;return(((Ie=(Fe=Pe.createdAt)==null?void 0:Fe.getTime)==null?void 0:Ie.call(Fe))||0)-(((wt=(et=pe.createdAt)==null?void 0:et.getTime)==null?void 0:wt.call(et))||0)}),S||(Te(W),ot(""))}catch(B){console.error("Failed to load suggestions",B),S||(ot("Failed to load suggestions."),Te([]))}finally{S||Ze(!1)}})(),()=>{S=!0}},[n,e]);const Mr=async S=>{if(!(!e||!S))try{await pa(At(tt,"suggestions",S)),Te(B=>B.filter(W=>W.id!==S))}catch(B){console.error("Failed to delete suggestion",B),ot("Failed to delete suggestion.")}};j.useEffect(()=>{let S=!1;async function B(){if(!n||!e){a([]),d([]),w(null),m(!1);return}try{m(!0);const[W,pe]=await Promise.all([Hs(Hn(tt,"library")),Hs(Hn(tt,"wishlist"))]);if(S)return;a(W.docs.map(Pe=>({id:Pe.id,...Pe.data()}))),d(pe.docs.map(Pe=>({id:Pe.id,...Pe.data()}))),w(null)}catch(W){console.error(W),S||w("Failed to load dashboard data.")}finally{S||m(!1)}}return B(),()=>{S=!0}},[n,e]);const Bt=j.useMemo(()=>{const S=s.length,B=s.filter(ls=>!!ls.read||ls.status==="Read"||ls.Read===!0).length,W=S-B,pe=S?Math.round(B/S*100):0,Pe=l.length,Fe=LR(s),Ie=Bv(s,ln),et=Bv(s,ln-1),wt=Ie.reduce((ls,ba)=>ls+ba.value,0),xt=VR(s),hn=OR(Fe),Nt=MR(l),Mt=FR(Nt),$t=UR(s),it=BR(s),Xn=WR(s),nt=HR(Fe),Mn=zR(s),rt=io(Fe,"publisher",5),os=io(Fe,"genre",5),Pa=io(Fe,"demographic",5),ri=$R(s);return{totalLibrary:S,readCount:B,unreadCount:W,readPct:pe,wishlistCount:Pe,seriesMap:Fe,monthlyReads:Ie,prevYearReads:et,currentYearReadsTotal:wt,weekdayBreakdown:xt,topSeriesBars:hn,releases:Nt,nextRelease:Mt,avgDays:$t,purchaseToReadSeries:Mn,collectionValue:it,pages:Xn,avgRating:nt,topPublishers:rt,topGenres:os,topDemographics:Pa,seriesAggregates:ri}},[s,l,ln]),{totalLibrary:Qe,readCount:nr,unreadCount:bs,readPct:fr,wishlistCount:pr,seriesMap:Kn,monthlyReads:ss,prevYearReads:In,currentYearReadsTotal:is,weekdayBreakdown:Rs,topSeriesBars:As,releases:cn,nextRelease:ct,avgDays:mr,purchaseToReadSeries:Dn,collectionValue:en,pages:un,avgRating:dn,topPublishers:Fr,topGenres:Sr,topDemographics:as,seriesAggregates:Qn}=Bt,Ln=ct?ct.date:null,_t=!!v,qt=j.useMemo(()=>{if(!s||!s.length)return[];const S=new Map;s.forEach(W=>{const pe=hd(W)||W.id,Pe=NR(W);S.has(pe)||S.set(pe,{seriesKey:pe,displayName:Pe,books:[]}),S.get(pe).books.push(W)});const B=Array.from(S.values()).map(W=>({...W,books:[...W.books].sort(kR)}));return B.sort((W,pe)=>W.displayName.localeCompare(pe.displayName)),B},[s]),Yt=j.useMemo(()=>qt.flatMap(S=>S.books.map(B=>B.id)),[qt]);j.useEffect(()=>{ne&&(s.some(S=>S.id===ne)||oe(null))},[s,ne]),j.useEffect(()=>{re&&(qt.some(S=>S.seriesKey===re)||ye(null))},[qt,re]),j.useEffect(()=>{if(!Ee.size)return;const S=new Set(s.map(W=>W.id)),B=Array.from(Ee).filter(W=>!S.has(W));B.length&&Se(W=>{const pe=new Set(W);return B.forEach(Pe=>pe.delete(Pe)),pe})},[s,Ee]),j.useEffect(()=>{const S=Array.from(Ee);if(!S.length){V("");return}const B=Array.from(new Set(S.map(W=>s.find(pe=>pe.id===W)).filter(Boolean).map(W=>{const pe=W.amountPaid??W.AmountPaid??"";return pe==null?"":String(pe)})));V(B.length===1?B[0]:"")},[Ee,s]),j.useEffect(()=>{const S=qt.find(it=>it.seriesKey===re);if(!S){I(Zh());return}const B=S.books,W=it=>{const Xn=Array.from(new Set(B.map(nt=>{const Mn=it(nt);return Mn==null?"":String(Mn).trim()})));return Xn.length===1?Xn[0]:""},pe=W(it=>it.publisher||it.Publisher),Pe=W(it=>it.demographic||it.Demographic),Fe=W(it=>it.genre||it.Genre),Ie=W(it=>it.subGenre||it.SubGenre),et=W(it=>it.msrp??it.MSRP),wt=Array.from(new Set(B.map(it=>(it.datePurchased||it.DatePurchased||"").trim()).filter(Boolean))),xt=wt.length>1,hn=xt?"":wt[0]||"",Nt=B.filter(it=>!!it.read||it.status==="Read"||it.Read===!0).length,Mt=Nt===B.length&&B.length>0;I({publisher:pe,demographic:Pe,genre:Fe,subGenre:Ie,datePurchased:hn,msrp:et,initialPublisher:pe,initialDemographic:Pe,initialGenre:Fe,initialSubGenre:Ie,initialDatePurchased:hn,initialMsrp:et,dateMixed:xt,readChecked:Mt,readIndeterminate:!Mt&&!(Nt===0)})},[qt,re]),j.useEffect(()=>{F.current&&(F.current.indeterminate=D.readIndeterminate)},[D.readIndeterminate]),j.useEffect(()=>{const S=s.find(W=>W.id===ne);if(!S){ve(Uv());return}const B=!!S.read||S.status==="Read"||S.Read===!0;ve({read:B,datePurchased:S.datePurchased||S.DatePurchased||"",dateRead:B&&(S.dateRead||S.DateRead)||"",pageCount:S.pageCount??S.PageCount??S.pages??S.Pages??"",msrp:S.msrp??S.MSRP??"",amountPaid:S.amountPaid??S.AmountPaid??"",rating:B?S.rating??S.Rating??"":"",special:!!(S.specialType||S.SpecialType),specialType:S.specialType??S.SpecialType??"",specialVolumes:S.specialVolumes??S.SpecialVolumes??"",collectiblePrice:S.collectiblePrice??S.CollectiblePrice??"",publisher:S.publisher||S.Publisher||"",demographic:S.demographic||S.Demographic||"",genre:S.genre||S.Genre||""})},[ne,s]),j.useEffect(()=>{if(!In||!In.length)return;const S=ln-1,B=In.reduce((Fe,Ie)=>Fe+Ie.value,0);if(!B||(vn.current?parseInt(vn.current,10):null)===S)return;const pe=In.map(Fe=>`${Fe.label}: ${Fe.value}`).join(", "),Pe=`Yearly reads summary for ${S}: ${B} total. Breakdown: ${pe}`;ef(U.yearly,Pe).then(()=>{vn.current=String(S),typeof window<"u"&&localStorage.setItem("dashboard-yearly-posted",String(S))})},[In,ln]),j.useEffect(()=>{if(!ct||!cn.length)return;const S=wl(ct.date),B=wl(new Date);if(S>B||Qt.current===S)return;const W=cn.filter(Pe=>wl(Pe.date)===S);if(!W.length)return;const pe=`Wishlist releases for ${S}:
${W.map(Pe=>`- ${Pe.title}`).join(`
`)}`;ef(U.release,pe).then(()=>{Qt.current=S,typeof window<"u"&&localStorage.setItem("dashboard-release-posted",S)})},[ct,cn]),j.useEffect(()=>{if(!Ln){C("-");return}const S=()=>{const W=Ln-new Date;if(W<=0){C("Released");return}const pe=Math.floor(W/1e3),Pe=Math.floor(pe/86400),Fe=Math.floor(pe%86400/3600).toString().padStart(2,"0"),Ie=Math.floor(pe%3600/60).toString().padStart(2,"0"),et=Math.floor(pe%60).toString().padStart(2,"0");C(`${Pe}d ${Fe}:${Ie}:${et}`)};S();const B=setInterval(S,1e3);return()=>clearInterval(B)},[Ln]),j.useEffect(()=>{if(!(typeof window>"u"))try{const S=localStorage.getItem(Mv);if(!S)return;const B=JSON.parse(S);if(!Array.isArray(B))return;const W=B.map(pe=>({message:pe.message,ts:pe.ts?new Date(pe.ts):new Date})).filter(pe=>pe.message);W.length&&Be(W)}catch(S){console.warn("Failed to load activity log",S)}},[]);const P=async()=>{try{const S=await Hs(Hn(tt,"library"));a(S.docs.map(B=>({id:B.id,...B.data()})))}catch(S){console.error("Failed to refresh library",S),w(B=>B||"Failed to refresh library data.")}},Z=S=>{const B=(S??"").toString().trim();if(B==="")return"";const W=parseFloat(B);return Number.isFinite(W)?W:""},le=S=>{const B=(S??"").toString().trim();if(B==="")return"";const W=parseInt(B,10);return Number.isFinite(W)?W:""},$=S=>{try{const B=S.slice(0,100).map(W=>({message:W.message,ts:W.ts instanceof Date?W.ts.toISOString():W.ts}));typeof window<"u"&&localStorage.setItem(Mv,JSON.stringify(B))}catch(B){console.warn("Failed to persist activity log",B)}},Y=S=>{if(!S)return;const B={message:S,ts:new Date};Be(Pe=>{const Fe=[B,...Pe].slice(0,100);return $(Fe),Fe});const W=(n==null?void 0:n.email)||"anonymous",pe=`Activity: ${S}
User: ${W}
Time: ${new Date().toLocaleString()}`;ef(U.activity,pe).catch(Pe=>console.warn("Activity webhook failed",Pe))},Le=S=>{O(B=>{const W=new Set(B);return W.has(S)?W.delete(S):W.add(S),W}),ye(S),oe(null)},Oe=(S,B,W)=>{const pe=S.metaKey||S.ctrlKey,Pe=S.shiftKey,Fe=Yt.indexOf(B);let Ie=new Set(Ee);if(Pe&&b!==null&&Fe!==-1){const et=Math.min(b,Fe),wt=Math.max(b,Fe);for(let xt=et;xt<=wt;xt+=1){const hn=Yt[xt];hn&&Ie.add(hn)}}else pe?Ie.has(B)?Ie.delete(B):Ie.add(B):Ie=new Set;Se(Ie),A(Fe),oe(B),ye(W),O(et=>{const wt=new Set(et);return wt.add(W),wt})},Rt=()=>{Se(new Set),A(null)},xe=async()=>{if(!e){alert("Dashboard is read-only for your account.");return}const S=Array.from(Ee);if(!S.length){alert("Select books in Library Manager (use Ctrl/Cmd or Shift) before bulk editing.");return}const B=(k||"").toString().trim(),W=B!=="",pe=Z(B);if(W&&pe===""){alert("Enter a valid number for Amount Paid.");return}try{await Promise.all(S.map(Pe=>_s(At(tt,"library",Pe),{amountPaid:W?pe:""}))),await P(),Rt(),Y(`Updated amount paid for ${S.length} book${S.length===1?"":"s"} in library`),alert(`Applied Amount Paid to ${S.length} selection${S.length===1?"":"s"}.`)}catch(Pe){console.error("Failed to apply Amount Paid",Pe),alert("Failed to apply Amount Paid to selection.")}},Ye=async()=>{if(!e){alert("Dashboard is read-only for your account.");return}const S=qt.find(Nt=>Nt.seriesKey===re);if(!S||!S.books.length)return;const B=!D.readIndeterminate,W=!!D.readChecked,pe=D.datePurchased!==D.initialDatePurchased,Pe=D.msrp!==D.initialMsrp,Fe=D.publisher!==D.initialPublisher,Ie=D.demographic!==D.initialDemographic,et=D.genre!==D.initialGenre,wt=D.subGenre!==D.initialSubGenre;if(!B&&!pe&&!Pe&&!Fe&&!Ie&&!et&&!wt)return;const xt=String(D.msrp??"").trim(),hn=Pe?Z(xt):"";if(Pe&&xt!==""&&hn===""){alert("Enter a valid number for MSRP.");return}try{const Nt=[];if(S.books.forEach(Mt=>{const $t={};B&&($t.read=W,$t.dateRead=W?Mt.dateRead||Mt.DateRead||new Date().toISOString().slice(0,10):""),pe&&($t.datePurchased=D.datePurchased||""),Pe&&($t.msrp=D.msrp===""?"":hn),Fe&&($t.publisher=D.publisher||""),Ie&&($t.demographic=D.demographic||""),et&&($t.genre=D.genre||""),wt&&($t.subGenre=D.subGenre||""),Object.keys($t).length&&Nt.push(_s(At(tt,"library",Mt.id),$t))}),!Nt.length)return;await Promise.all(Nt),await P(),oe(null),Y(`Updated series "${S.displayName||"Series"}" (${S.books.length} book${S.books.length===1?"":"s"})`),alert("Series updated.")}catch(Nt){console.error("Failed to save series changes",Nt),alert("Failed to update series.")}},mt=async()=>{if(!e){alert("Dashboard is read-only for your account.");return}if(!ne)return;const S=!!ge.read,B=String(ge.msrp??"").trim(),W=String(ge.amountPaid??"").trim(),pe=String(ge.pageCount??"").trim(),Pe=String(ge.rating??"").trim(),Fe=Z(B),Ie=Z(W),et=le(pe),wt=Z(Pe);if(B!==""&&Fe===""){alert("Enter a valid number for MSRP.");return}if(W!==""&&Ie===""){alert("Enter a valid number for Amount Paid.");return}if(pe!==""&&et===""){alert("Enter a valid page count.");return}if(S&&Pe!==""&&wt===""){alert("Enter a valid rating.");return}const xt=!!ge.special,hn=le(ge.specialVolumes),Nt=Z(ge.collectiblePrice),Mt=String(ge.specialVolumes??"").trim(),$t=String(ge.collectiblePrice??"").trim();if(xt&&ge.specialType==="specialEdition"&&Mt!==""&&hn===""){alert("Enter a valid number for volumes contained.");return}if(xt&&ge.specialType==="collectible"&&$t!==""&&Nt===""){alert("Enter a valid collectible price.");return}const it=S?ge.dateRead||new Date().toISOString().slice(0,10):"",Xn={read:S,datePurchased:ge.datePurchased||"",dateRead:it,msrp:ge.msrp===""?"":Fe,amountPaid:ge.amountPaid===""?"":Ie,pageCount:ge.pageCount===""?"":et,rating:S?ge.rating===""?"":wt:"",specialType:xt&&ge.specialType||"",specialVolumes:xt&&ge.specialType==="specialEdition"?ge.specialVolumes===""?"":hn:"",collectiblePrice:xt&&ge.specialType==="collectible"?ge.collectiblePrice===""?"":Nt:""};try{await _s(At(tt,"library",ne),Xn),await P();const nt=s.find(rt=>rt.id===ne)||gt,Mn=(nt==null?void 0:nt.Title)||(nt==null?void 0:nt.title)||"Untitled";Y(`Updated "${Mn}" in library`),alert("Saved changes.")}catch(nt){console.error("Failed to save book changes",nt),alert("Failed to save changes.")}},Cn=()=>{ye(null),oe(null),Rt(),I(Zh())},Vn=()=>{oe(null),A(null)},Ur=qt.find(S=>S.seriesKey===re)||null,gt=s.find(S=>S.id===ne)||null,gr=re?{msrp:!D.msrp,datePurchased:!D.datePurchased&&!D.dateMixed,publisher:!D.publisher,demographic:!D.demographic,genre:!D.genre}:{},Yn=ne?jR({amountPaid:ge.amountPaid,msrp:ge.msrp,datePurchased:ge.datePurchased,publisher:(gt==null?void 0:gt.publisher)||(gt==null?void 0:gt.Publisher)||"",demographic:(gt==null?void 0:gt.demographic)||(gt==null?void 0:gt.Demographic)||"",genre:(gt==null?void 0:gt.genre)||(gt==null?void 0:gt.Genre)||"",special:ge.special,specialType:ge.specialType,specialVolumes:ge.specialVolumes,collectiblePrice:ge.collectiblePrice,pageCount:ge.pageCount}):{};if(t)return c.jsx("div",{className:"page dashboard-page",children:c.jsxs("div",{className:"dashboard-loading",children:[c.jsx("h1",{children:"Dashboard"}),c.jsx("p",{children:"Checking permissions..."})]})});if(!n||!e)return c.jsx("div",{className:"page dashboard-page",children:c.jsxs("div",{className:"dashboard-locked",children:[c.jsx("h1",{children:"Dashboard"}),c.jsx("p",{children:"This area is restricted to admin accounts."})]})});if(f)return c.jsx("div",{className:"page dashboard-page",children:c.jsxs("div",{className:"dashboard-loading",children:[c.jsx("h1",{children:"Dashboard"}),v?c.jsx("p",{className:"error",children:v}):c.jsx("p",{children:"Loading stats..."})]})});const Ir=Qe+pr,vt=Ir?Math.round(Qe/Ir*100):0,Ki=[...Kn.values()].filter(S=>S.ratingCount>0).map(S=>({title:S.title,avg:S.ratingSum/S.ratingCount,count:S.ratingCount})).sort((S,B)=>B.avg-S.avg||B.count-S.count).slice(0,3);function Ns(){if(Ln)zt(new Date(Ln.getFullYear(),Ln.getMonth(),1));else if(cn.length){const S=cn[0].date;zt(new Date(S.getFullYear(),S.getMonth(),1))}Pt(!0)}function On(S){Sn({open:!0,type:S})}function Jn(){Sn({open:!1,type:null})}const Qi=wl(new Date),Ca=KR(bt,cn,Qi);function ks(){const S=St.type;if(!S)return null;if(S==="publishers"){const B=[...io(Kn,"publisher",100)];return c.jsxs(c.Fragment,{children:[c.jsx("h3",{children:"Top Publishers by Series"}),B.length===0?c.jsx("p",{children:"No publisher data yet."}):c.jsxs("table",{children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"#"}),c.jsx("th",{children:"Publisher"}),c.jsx("th",{children:"Series Count"})]})}),c.jsx("tbody",{children:B.map((W,pe)=>c.jsxs("tr",{children:[c.jsx("td",{children:pe+1}),c.jsx("td",{children:W.name}),c.jsx("td",{children:W.count})]},W.name+pe))})]})]})}if(S==="genres"){const B=[...io(Kn,"genre",100)];return c.jsxs(c.Fragment,{children:[c.jsx("h3",{children:"Top Genres by Series"}),B.length===0?c.jsx("p",{children:"No genre data yet."}):c.jsxs("table",{children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"#"}),c.jsx("th",{children:"Genre"}),c.jsx("th",{children:"Series Count"})]})}),c.jsx("tbody",{children:B.map((W,pe)=>c.jsxs("tr",{children:[c.jsx("td",{children:pe+1}),c.jsx("td",{children:W.name}),c.jsx("td",{children:W.count})]},W.name+pe))})]})]})}if(S==="demographics"){const B=[...io(Kn,"demographic",100)];return c.jsxs(c.Fragment,{children:[c.jsx("h3",{children:"Top Demographics by Series"}),B.length===0?c.jsx("p",{children:"No demographic data yet."}):c.jsxs("table",{children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"#"}),c.jsx("th",{children:"Demographic"}),c.jsx("th",{children:"Series Count"})]})}),c.jsx("tbody",{children:B.map((W,pe)=>c.jsxs("tr",{children:[c.jsx("td",{children:pe+1}),c.jsx("td",{children:W.name}),c.jsx("td",{children:W.count})]},W.name+pe))})]})]})}if(S==="timeToRead"){const B=Dn||[];return c.jsxs(c.Fragment,{children:[c.jsx("h3",{children:"Average Time From Purchase to Read"}),mr==null?c.jsx("p",{children:"Not enough volumes have both purchase and read dates to calculate this yet."}):c.jsxs(c.Fragment,{children:[c.jsxs("p",{children:["On average, it takes"," ",c.jsxs("strong",{children:[mr.toFixed(1)," days"]})," from purchase to finishing a volume."]}),B.length>0?c.jsxs("table",{children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"Series"}),c.jsx("th",{children:"Avg Days"}),c.jsx("th",{children:"Longest"}),c.jsx("th",{children:"Shortest"}),c.jsx("th",{children:"Reads Count"})]})}),c.jsx("tbody",{children:B.map(W=>c.jsxs("tr",{children:[c.jsx("td",{children:W.title}),c.jsxs("td",{children:[W.avg.toFixed(1)," days"]}),c.jsxs("td",{children:[Math.round(W.max)," days"]}),c.jsxs("td",{children:[Math.round(W.min)," days"]}),c.jsx("td",{children:W.count})]},W.key))})]}):c.jsx("p",{style:{marginTop:8},children:"No series-level data yet."})]})]})}if(S==="collectionValue"){const{msrpTotal:B,paidTotal:W}=en,pe=B-W,Pe=B>0?(W/B*100).toFixed(1):"-",Fe=[...Qn].filter(Ie=>Ie.msrp||Ie.paid||Ie.collectible).sort((Ie,et)=>et.msrp+et.collectible-(Ie.msrp+Ie.collectible));return c.jsxs(c.Fragment,{children:[c.jsx("h3",{children:"Collection Value Breakdown"}),c.jsx("table",{children:c.jsxs("tbody",{children:[c.jsxs("tr",{children:[c.jsx("th",{children:"Total MSRP"}),c.jsxs("td",{children:["$",B.toFixed(2)]})]}),c.jsxs("tr",{children:[c.jsx("th",{children:"Total Paid"}),c.jsxs("td",{children:["$",W.toFixed(2)]})]}),c.jsxs("tr",{children:[c.jsx("th",{children:"Difference"}),c.jsxs("td",{children:["$",pe.toFixed(2)]})]}),c.jsxs("tr",{children:[c.jsx("th",{children:"Paid vs MSRP"}),c.jsx("td",{children:Pe==="-"?"-":`${Pe}%`})]})]})}),Fe.length>0&&c.jsxs(c.Fragment,{children:[c.jsx("h4",{style:{marginTop:"14px"},children:"Collection Pricing"}),c.jsxs("table",{children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"Title"}),c.jsx("th",{children:"MSRP"}),c.jsx("th",{children:"Paid"}),c.jsx("th",{children:"Collectible"}),c.jsx("th",{children:"Books"})]})}),c.jsx("tbody",{children:Fe.map((Ie,et)=>c.jsxs("tr",{children:[c.jsx("td",{children:Ie.title}),c.jsxs("td",{children:["$",Ie.msrp.toFixed(2)]}),c.jsxs("td",{children:["$",Ie.paid.toFixed(2)]}),c.jsx("td",{children:Ie.collectible?`$${Ie.collectible.toFixed(2)}`:"--"}),c.jsx("td",{children:Ie.books})]},Ie.title+et))})]})]})]})}if(S==="pages"){const B=[...Qn].filter(W=>W.pages>0).map(W=>({...W,pct:W.pages?Math.round(W.readPages/W.pages*100):0})).sort((W,pe)=>pe.pages-W.pages);return c.jsxs(c.Fragment,{children:[c.jsx("h3",{children:"Pages Read vs Total"}),c.jsx("table",{children:c.jsxs("tbody",{children:[c.jsxs("tr",{children:[c.jsx("th",{children:"Total Pages"}),c.jsx("td",{children:un.total.toLocaleString()})]}),c.jsxs("tr",{children:[c.jsx("th",{children:"Pages Read"}),c.jsx("td",{children:un.read.toLocaleString()})]}),c.jsxs("tr",{children:[c.jsx("th",{children:"Completion"}),c.jsx("td",{children:un.total?`${(un.read/un.total*100).toFixed(1)}%`:"-"})]})]})}),B.length>0&&c.jsxs(c.Fragment,{children:[c.jsx("h4",{style:{marginTop:"14px"},children:"Pages by Series"}),c.jsxs("table",{children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"Title"}),c.jsx("th",{children:"Read Pages"}),c.jsx("th",{children:"Total Pages"}),c.jsx("th",{children:"% Read"}),c.jsx("th",{children:"Books"})]})}),c.jsx("tbody",{children:B.map((W,pe)=>c.jsxs("tr",{children:[c.jsx("td",{children:W.title}),c.jsx("td",{children:W.readPages.toLocaleString()}),c.jsx("td",{children:W.pages.toLocaleString()}),c.jsxs("td",{children:[W.pct,"%"]}),c.jsx("td",{children:W.books})]},W.title+pe))})]})]})]})}if(S==="ratings"){const B=[...Qn].map(W=>{if(!W.ratings.length)return null;const pe=W.ratings.reduce((Pe,Fe)=>Pe+Fe,0)/W.ratings.length;return{title:W.title,avg:pe,count:W.ratings.length}}).filter(Boolean).sort((W,pe)=>pe.avg-W.avg||pe.count-W.count);return c.jsxs(c.Fragment,{children:[c.jsx("h3",{children:"Ratings Overview"}),dn==null?c.jsx("p",{children:"No ratings have been recorded yet."}):c.jsxs("p",{children:["Average series rating across rated series is"," ",c.jsx("strong",{children:dn.toFixed(2)}),"."]}),B.length>0&&c.jsxs(c.Fragment,{children:[c.jsx("h4",{style:{marginTop:"14px"},children:"Series Averages"}),c.jsxs("table",{children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"Title"}),c.jsx("th",{children:"Avg"}),c.jsx("th",{children:"Ratings"})]})}),c.jsx("tbody",{children:B.map((W,pe)=>c.jsxs("tr",{children:[c.jsx("td",{children:W.title}),c.jsx("td",{children:W.avg.toFixed(2)}),c.jsx("td",{children:W.count})]},W.title+pe))})]})]})]})}return S==="releases"?c.jsxs(c.Fragment,{children:[c.jsx("h3",{children:"Wishlist Releases"}),cn.length===0?c.jsx("p",{children:"No wishlist releases found."}):c.jsxs("table",{children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"Date"}),c.jsx("th",{children:"Title"})]})}),c.jsx("tbody",{children:cn.map((B,W)=>c.jsxs("tr",{children:[c.jsx("td",{children:B.date.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}),c.jsx("td",{children:B.title})]},W))})]})]}):null}return c.jsxs("div",{className:"page dashboard-page",children:[c.jsxs("header",{className:"dashboard-header",style:{display:"flex",alignItems:"center",justifyContent:"center",position:"relative",textAlign:"center",width:"100%"},children:[c.jsxs("div",{style:{textAlign:"center",margin:"0 auto",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"0 60px"},children:[c.jsx("h1",{style:{margin:0,fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Dashboard"}),c.jsx("p",{className:"dashboard-sub",style:{textAlign:"center",margin:"6px 0 0"},children:"My Entire Statistics dashboard for my Manga. I still use Excel though."})]}),e&&c.jsx("div",{style:{position:"absolute",right:0,top:"50%",transform:"translateY(-50%)"},children:c.jsx("button",{className:"stat-link",onClick:()=>ee(!0),type:"button",children:"Admin Settings"})})]}),c.jsx("section",{id:"dashboardSection",className:"page-section active",children:c.jsxs("div",{className:"dashboard-grid",children:[c.jsxs("div",{className:"stat-stack",children:[c.jsxs("div",{className:"stat-card mini",children:[c.jsx("h3",{children:"Total Library Books"}),c.jsx("div",{className:"stat-value",children:Qe}),c.jsx("div",{className:"stat-sub",children:"Volumes in your library."})]}),c.jsxs("div",{className:"stat-card mini",children:[c.jsx("h3",{children:"Wishlist Items"}),c.jsx("div",{className:"stat-value",children:pr}),c.jsx("div",{className:"stat-sub",children:"Tracked upcoming wants."})]})]}),c.jsxs("div",{className:"stat-card",children:[c.jsx("h3",{children:"Read / Unread"}),c.jsx("div",{className:"pie",style:{"--pct":`${fr*3.6}deg`},children:c.jsxs("div",{className:"pie-label",children:[fr,"%"]})}),c.jsxs("div",{className:"stat-value",children:[nr," read / ",bs," unread"]})]}),c.jsxs("div",{className:"stat-card clickable",onClick:()=>On("ratings"),children:[c.jsx("h3",{children:"Ratings"}),c.jsx("div",{className:"stat-value",children:dn==null?"-":dn.toFixed(2)}),c.jsx("div",{className:"stat-sub",children:"Average across rated series."}),c.jsx("div",{className:"stat-list compact",children:Ki.length?Ki.map((S,B)=>c.jsxs("div",{className:"stat-list-row",children:[c.jsx("span",{className:"stat-rank",children:B+1}),c.jsx("span",{className:"stat-name",children:S.title}),c.jsx("span",{className:"stat-count",children:S.avg.toFixed(2)})]},S.title+B)):c.jsx("div",{className:"stat-sub",children:"No ratings yet."})})]}),c.jsxs("div",{className:"stat-card clickable",onClick:()=>On("pages"),children:[c.jsx("h3",{children:"Page Count Read / Total"}),c.jsxs("div",{className:"stat-value",children:[un.read.toLocaleString()," / ",un.total.toLocaleString()]}),c.jsx("div",{className:"stat-sub",children:un.total?`${(un.read/un.total*100).toFixed(1)}% read`:"-"})]}),c.jsxs("div",{className:"stat-card",children:[c.jsx("h3",{children:"Library vs Wishlist"}),c.jsx("div",{className:"pie",style:{"--pct":`${vt*3.6}deg`},children:c.jsxs("div",{className:"pie-label",children:[vt,"%"]})}),c.jsxs("div",{className:"stat-value",children:[Qe," / ",pr]}),c.jsx("div",{className:"stat-sub",children:"Library vs wishlist share"})]}),c.jsxs("div",{className:"stat-card clickable",onClick:()=>On("demographics"),children:[c.jsx("h3",{children:"Top Demographics"}),c.jsx("div",{className:"stat-list",children:as.length?as.slice(0,3).map((S,B)=>c.jsxs("div",{className:"stat-list-row",children:[c.jsx("span",{className:"stat-rank",children:B+1}),c.jsx("span",{className:"stat-name",children:S.name}),c.jsx("span",{className:"stat-count",children:S.count})]},S.name)):c.jsx("div",{className:"stat-sub",children:"No demographic data yet."})})]}),c.jsxs("div",{className:"stat-card clickable",onClick:()=>On("publishers"),children:[c.jsx("h3",{children:"Top Publishers"}),c.jsx("div",{className:"stat-list",children:Fr.length?Fr.slice(0,3).map((S,B)=>c.jsxs("div",{className:"stat-list-row",children:[c.jsx("span",{className:"stat-rank",children:B+1}),c.jsx("span",{className:"stat-name",children:S.name}),c.jsx("span",{className:"stat-count",children:S.count})]},S.name)):c.jsx("div",{className:"stat-sub",children:"No publisher data yet."})})]}),c.jsxs("div",{className:"stat-card clickable",onClick:()=>On("genres"),children:[c.jsx("h3",{children:"Top Genres"}),c.jsx("div",{className:"stat-list",children:Sr.length?Sr.slice(0,3).map((S,B)=>c.jsxs("div",{className:"stat-list-row",children:[c.jsx("span",{className:"stat-rank",children:B+1}),c.jsx("span",{className:"stat-name",children:S.name}),c.jsx("span",{className:"stat-count",children:S.count})]},S.name)):c.jsx("div",{className:"stat-sub",children:"No genre data yet."})})]}),c.jsxs("div",{className:"stat-card clickable",onClick:()=>{Ns()},children:[c.jsx("h3",{children:"Next Wishlist Release"}),c.jsx("div",{className:"stat-value next-release",children:ct?ct.title:"No upcoming releases"}),c.jsxs("div",{className:"stat-sub",children:[Ln?Ln.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"}):"-",c.jsx("br",{}),c.jsx("span",{id:"statNextCountdown",children:E})]})]}),c.jsxs("div",{className:"stat-card clickable",onClick:()=>On("collectionValue"),style:{textAlign:"center"},children:[c.jsx("h3",{children:"Collection Pricing"}),c.jsxs("div",{className:"stat-value stat-msrp",children:["$",en.msrpTotal.toFixed(2)]}),c.jsxs("div",{className:"stat-value stat-paid",children:["$",en.paidTotal.toFixed(2),en.msrpTotal>0&&c.jsxs("span",{className:"stat-paid-pct",children:["(",((1-en.paidTotal/en.msrpTotal)*100).toFixed(1),"% off)"]})]}),c.jsxs("div",{className:"stat-value stat-collectible",children:["$",en.collectibleTotal.toFixed(2)]}),c.jsx("div",{className:"stat-sub",children:"MSRP  Paid  Collectible overrides"})]}),c.jsxs("div",{className:"stat-card",children:[c.jsx("h3",{children:"Current Year Reads"}),c.jsx("div",{className:"stat-value",children:is}),c.jsxs("div",{className:"stat-sub",children:["Reads in ",ln]})]}),c.jsxs("div",{className:"stat-card clickable",onClick:()=>On("timeToRead"),children:[c.jsx("h3",{children:"Avg Days From Purchase to Read"}),c.jsx("div",{className:"stat-value",children:mr==null?"-":`${mr.toFixed(1)} days`}),c.jsx("div",{className:"stat-sub",children:"When both dates exist"})]}),c.jsxs("div",{className:"stat-duo",children:[c.jsxs("div",{className:"stat-card tall",children:[c.jsxs("h3",{children:["Reads Per Month (",ln,")"]}),c.jsx(GR,{data:ss})]}),c.jsxs("div",{className:"stat-card tall",children:[c.jsx("h3",{children:"Reads by Day of Week (Lifetime)"}),c.jsx(qR,{data:Rs}),c.jsx("div",{className:"stat-sub",children:"Based on all entries with a read date."})]})]}),c.jsxs("div",{className:"stat-card wide",children:[c.jsx("h3",{children:"Activity Log"}),_t&&c.jsx("div",{className:"error",style:{textAlign:"center"},children:v}),c.jsx("div",{className:"activity-log scrollable",children:lt.length?lt.map((S,B)=>{const W=S.ts?new Date(S.ts):null;return c.jsxs("div",{className:"activity-row",children:[c.jsx("span",{className:"activity-title",children:S.message}),c.jsx("span",{className:"activity-date",children:W?W.toLocaleString(void 0,{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}):""})]},(S.message||"activity")+B)}):c.jsx("div",{className:"stat-sub",children:"No recent activity yet."})})]}),c.jsxs("div",{className:"stat-card wide",style:{minHeight:"340px",maxHeight:"480px"},children:[c.jsx("h3",{children:"Suggestions"}),Ke&&c.jsx("div",{className:"error",style:{textAlign:"center"},children:Ke}),c.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",alignItems:"stretch"},children:["anime","manga"].map(S=>{const B=ie.filter(W=>(W.type||"").toLowerCase()===S).sort((W,pe)=>{var Pe,Fe,Ie,et;return(((Fe=(Pe=pe.createdAt)==null?void 0:Pe.getTime)==null?void 0:Fe.call(Pe))||0)-(((et=(Ie=W.createdAt)==null?void 0:Ie.getTime)==null?void 0:et.call(Ie))||0)});return c.jsxs("div",{style:{border:"1px solid rgba(255,182,193,0.18)",borderRadius:"16px",padding:"10px 12px",display:"flex",flexDirection:"column",background:"rgba(255,182,193,0.04)",minHeight:"240px"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"8px",position:"relative"},children:[c.jsx("h4",{style:{margin:0,color:"#ffb6c1",textAlign:"center",flex:1},children:S==="anime"?"Anime":"Manga"}),c.jsxs("span",{className:"stat-sub",style:{position:"absolute",right:0},children:[B.length," suggestion",B.length===1?"":"s"]})]}),c.jsx("div",{className:"scrollable",style:{maxHeight:"280px",height:"280px",paddingRight:"4px",overflowY:"auto"},children:Ce?c.jsx("div",{className:"stat-sub",children:"Loading suggestions..."}):B.length?B.map(W=>{const pe=W.createdAt instanceof Date?W.createdAt:W.createdAt?new Date(W.createdAt):null;return c.jsxs("div",{style:{border:"1px solid rgba(255,182,193,0.25)",borderRadius:"12px",padding:"8px 10px",marginBottom:"8px",background:"rgba(255,182,193,0.06)",display:"grid",gridTemplateColumns:"1fr auto",gap:"6px",alignItems:"center"},children:[c.jsxs("div",{children:[c.jsx("div",{style:{fontWeight:600,color:"#f7d0dc"},children:W.content||"(no content)"}),c.jsxs("div",{className:"stat-sub",style:{fontSize:"0.8rem"},children:[pe?pe.toLocaleString(void 0,{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}):""," ",W.from?` ${W.from}`:""]})]}),c.jsx("div",{style:{display:"flex",gap:"6px"},children:e&&c.jsx("button",{type:"button",className:"stat-link",onClick:()=>Mr(W.id),children:"Delete"})})]},W.id)}):c.jsx("div",{className:"stat-sub",children:"No suggestions yet."})})]},S)})}),c.jsxs("div",{className:"stat-sub",style:{marginTop:"8px",textAlign:"center"},children:["Total suggestions: ",ie.length]})]}),c.jsxs("div",{className:"stat-card wide",children:[c.jsx("h3",{children:"Library Manager"}),qt.length?c.jsxs("div",{className:"dash-library",children:[c.jsxs("div",{className:"dash-library-list",children:[qt.map(S=>{const B=S.books.filter(Ie=>!!Ie.read||Ie.status==="Read"||Ie.Read===!0).length,W=K.has(S.seriesKey),pe=re===S.seriesKey&&!ne,Pe=DR(S),Fe=S.books.some(Ie=>zv(Ie));return c.jsxs("div",{style:{marginBottom:"8px"},children:[c.jsxs("button",{type:"button",onClick:()=>Le(S.seriesKey),style:{width:"100%",textAlign:"left",background:Pe?"rgba(255,179,71,0.08)":"transparent",border:`1px solid ${pe?"#ff69b4":Pe?"rgba(255,179,71,0.6)":"rgba(255,182,193,0.25)"}`,color:"#ffb6c1",padding:"8px",borderRadius:"8px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"8px",position:"relative",boxShadow:Pe?"0 0 10px rgba(255,179,71,0.5)":pe?"0 0 8px rgba(255,105,180,0.5)":"none"},children:[c.jsx("span",{style:{transition:"transform 0.2s ease",transform:W?"rotate(90deg)":"none"},children:">"}),c.jsx("span",{style:{flex:1},children:S.displayName}),c.jsxs("span",{style:{fontSize:"11px",color:"#f8d1d8"},children:[S.books.length," book",S.books.length===1?"":"s",S.books.length?`  ${B} read`:""]}),Fe&&c.jsx("span",{title:"Some volumes are missing required data",style:{width:"12px",height:"12px",borderRadius:"999px",background:"#ffb347",border:"1px solid rgba(255,255,255,0.25)",boxShadow:"0 0 10px rgba(255,179,71,0.6)"}})]}),c.jsx("div",{style:{margin:"6px 0 10px 10px",paddingLeft:"10px",borderLeft:"1px solid rgba(255,182,193,0.25)",display:W?"block":"none"},children:S.books.map(Ie=>{const et=ne===Ie.id,wt=Ee.has(Ie.id);Ie.read||Ie.status==="Read"||Ie.Read;const xt=zv(Ie,{ignoreShared:!0});return c.jsxs("button",{type:"button",onClick:hn=>Oe(hn,Ie.id,S.seriesKey),style:{width:"100%",textAlign:"left",background:xt?"rgba(255,179,71,0.1)":"transparent",border:`1px solid ${et?"#ff69b4":wt?"#fff59d":xt?"rgba(255,179,71,0.6)":"rgba(255,182,193,0.25)"}`,color:"#ffb6c1",padding:"8px",borderRadius:"8px",marginBottom:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"8px",boxShadow:et?"0 0 8px rgba(255,105,180,0.5)":wt?"0 0 10px rgba(255,255,180,0.65)":xt?"0 0 10px rgba(255,179,71,0.5)":"none"},children:[c.jsx("span",{style:{flex:1,minWidth:0},children:Ie.Title||Ie.title||"Untitled"}),xt&&c.jsx("span",{style:{flexShrink:0,padding:"2px 8px",borderRadius:"999px",background:"rgba(255,179,71,0.18)",border:"1px solid rgba(255,179,71,0.6)",color:"#ffd8a1",fontSize:"11px",fontWeight:700,whiteSpace:"nowrap"},children:"Missing data"})]},Ie.id)})})]},S.seriesKey)}),qt.length>0&&Ee.size>0&&c.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:c.jsx("button",{type:"button",style:{padding:"6px 12px",borderRadius:"999px",border:"1px solid #ffb6c1",background:"transparent",color:"#ffb6c1",cursor:"pointer"},onClick:Rt,children:"Clear Selection"})})]}),c.jsxs("div",{className:"dash-library-details",children:[Ee.size>0&&c.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px",padding:"10px",marginBottom:"10px",border:"1px dashed rgba(255,182,193,0.45)",borderRadius:"10px",background:"rgba(255,182,193,0.08)"},children:[c.jsxs("div",{children:["Apply Amount Paid to ",Ee.size," selected book",Ee.size===1?"":"s"]}),c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",flexWrap:"wrap"},children:[c.jsx("input",{type:"number",step:"0.01",min:"0",value:k,onChange:S=>V(S.target.value),style:{maxWidth:"140px"}}),c.jsx("button",{type:"button",className:"dash-btn primary",onClick:xe,children:"Apply to Selected"})]})]}),!re&&!ne&&c.jsx("div",{className:"stat-sub",style:{marginTop:6},children:"Select a series or book to edit"}),re&&!ne&&Ur&&c.jsxs("div",{children:[c.jsx("div",{className:"dash-detail-title",children:Ur.displayName}),c.jsx("div",{className:"dash-detail-row",children:c.jsxs("label",{className:"inline-checkbox",children:[c.jsx("input",{ref:F,type:"checkbox",checked:D.readChecked,onChange:S=>I(B=>({...B,readChecked:S.target.checked,readIndeterminate:!1}))}),c.jsx("span",{children:"Mark series as read"})]})}),c.jsxs("div",{className:`dash-detail-row${gr.publisher?" missing-row":""}`,children:[c.jsx("span",{children:"Publisher"}),c.jsx("input",{type:"text",value:D.publisher,onChange:S=>I(B=>({...B,publisher:S.target.value})),placeholder:"Set publisher for series"})]}),c.jsxs("div",{className:`dash-detail-row${gr.demographic?" missing-row":""}`,children:[c.jsx("span",{children:"Demographic"}),c.jsxs("select",{value:D.demographic,onChange:S=>I(B=>({...B,demographic:S.target.value})),children:[c.jsx("option",{value:"",children:"Select Demographic"}),c.jsx("option",{value:"Shounen",children:"Shounen"}),c.jsx("option",{value:"Seinen",children:"Seinen"}),c.jsx("option",{value:"Shoujo",children:"Shoujo"}),c.jsx("option",{value:"Josei",children:"Josei"})]})]}),c.jsxs("div",{className:`dash-detail-row${gr.genre?" missing-row":""}`,children:[c.jsx("span",{children:"Genre"}),c.jsx("input",{type:"text",value:D.genre,onChange:S=>I(B=>({...B,genre:S.target.value})),placeholder:"Primary genre"})]}),c.jsxs("div",{className:"dash-detail-row",children:[c.jsx("span",{children:"Sub-Genre"}),c.jsx("input",{type:"text",value:D.subGenre,onChange:S=>I(B=>({...B,subGenre:S.target.value})),placeholder:"Secondary genre / theme"})]}),!D.dateMixed&&c.jsxs("div",{className:`dash-detail-row${gr.datePurchased?" missing-row":""}`,children:[c.jsx("span",{children:"Date Purchased"}),c.jsx("input",{type:"date",value:D.datePurchased,onChange:S=>I(B=>({...B,datePurchased:S.target.value}))})]}),c.jsxs("div",{className:`dash-detail-row${gr.msrp?" missing-row":""}`,children:[c.jsx("span",{children:"MSRP (per book)"}),c.jsx("input",{type:"number",step:"0.01",min:"0",value:D.msrp,onChange:S=>I(B=>({...B,msrp:S.target.value})),placeholder:"0.00"})]}),c.jsxs("div",{className:"dash-detail-actions",children:[c.jsx("button",{type:"button",className:"dash-btn secondary",onClick:Cn,children:"Cancel"}),c.jsx("button",{type:"button",className:"dash-btn primary",onClick:Ye,children:"Save Series"})]})]}),ne&&gt&&c.jsxs("div",{children:[c.jsx("div",{className:"dash-detail-title",children:gt.Title||gt.title||"Untitled"}),c.jsx("div",{className:"dash-detail-row",children:c.jsxs("label",{className:"inline-checkbox",children:[c.jsx("input",{type:"checkbox",checked:!!ge.read,onChange:S=>ve(B=>({...B,read:S.target.checked,dateRead:S.target.checked?B.dateRead||new Date().toISOString().slice(0,10):"",rating:S.target.checked?B.rating:""}))}),c.jsx("span",{children:"Mark as read"})]})}),c.jsxs("div",{className:`dash-detail-row${Yn.datePurchased?" missing-row":""}`,children:[c.jsx("span",{children:"Date Purchased"}),c.jsx("input",{type:"date",value:ge.datePurchased,onChange:S=>ve(B=>({...B,datePurchased:S.target.value}))})]}),ge.read&&c.jsxs("div",{className:"dash-detail-row",children:[c.jsx("span",{children:"Date Read"}),c.jsx("input",{type:"date",value:ge.dateRead,onChange:S=>ve(B=>({...B,dateRead:S.target.value}))})]}),c.jsxs("div",{className:`dash-detail-row${Yn.pageCount?" missing-row":""}`,children:[c.jsx("span",{children:"Page Count"}),c.jsx("input",{type:"number",min:"0",step:"1",value:ge.pageCount,onChange:S=>ve(B=>({...B,pageCount:S.target.value}))})]}),c.jsxs("div",{className:`dash-detail-row${Yn.msrp?" missing-row":""}`,children:[c.jsx("span",{children:"MSRP (per book)"}),c.jsx("input",{type:"number",step:"0.01",min:"0",value:ge.msrp,onChange:S=>ve(B=>({...B,msrp:S.target.value})),placeholder:"0.00"})]}),!(ge.special&&ge.specialType==="collectible")&&c.jsxs("div",{className:`dash-detail-row${Yn.amountPaid?" missing-row":""}`,children:[c.jsx("span",{children:"Amount Paid"}),c.jsx("input",{type:"number",step:"0.01",min:"0",value:ge.amountPaid,onChange:S=>ve(B=>({...B,amountPaid:S.target.value})),placeholder:"0.00"})]}),ge.read&&c.jsxs("div",{className:"dash-detail-row",children:[c.jsx("span",{children:"Star Rating"}),c.jsx("input",{type:"number",min:"0",max:"5",step:"0.5",value:ge.rating,onChange:S=>ve(B=>({...B,rating:S.target.value})),placeholder:"0-5"})]}),c.jsx("div",{className:`dash-detail-row${Yn.specialType?" missing-row":""}`,children:c.jsxs("label",{className:"inline-checkbox",style:{width:"100%"},children:[c.jsx("input",{type:"checkbox",checked:!!ge.special,onChange:S=>ve(B=>({...B,special:S.target.checked,specialType:S.target.checked?B.specialType:"",specialVolumes:S.target.checked?B.specialVolumes:"",collectiblePrice:S.target.checked?B.collectiblePrice:""}))}),c.jsx("span",{children:"Special?"})]})}),ge.special&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:`dash-detail-row${Yn.specialType?" missing-row":""}`,children:[c.jsx("span",{children:"Special Type"}),c.jsxs("select",{value:ge.specialType,onChange:S=>ve(B=>({...B,specialType:S.target.value,specialVolumes:S.target.value==="specialEdition"?B.specialVolumes:"",collectiblePrice:S.target.value==="collectible"?B.collectiblePrice:""})),children:[c.jsx("option",{value:"",children:"Select type"}),c.jsx("option",{value:"specialEdition",children:"Special Edition"}),c.jsx("option",{value:"collectible",children:"Collectible"})]})]}),ge.specialType==="specialEdition"&&c.jsxs("div",{className:`dash-detail-row${Yn.specialVolumes?" missing-row":""}`,children:[c.jsx("span",{children:"Volumes Contained"}),c.jsx("input",{type:"number",min:"1",step:"1",value:ge.specialVolumes,onChange:S=>ve(B=>({...B,specialVolumes:S.target.value}))})]}),ge.specialType==="collectible"&&c.jsxs("div",{className:`dash-detail-row${Yn.collectiblePrice?" missing-row":""}`,children:[c.jsx("span",{children:"Collectible Price"}),c.jsx("input",{type:"number",min:"0",step:"0.01",value:ge.collectiblePrice,onChange:S=>ve(B=>({...B,collectiblePrice:S.target.value})),placeholder:"0.00"})]})]}),c.jsxs("div",{className:"dash-detail-actions",children:[c.jsx("button",{type:"button",className:"dash-btn secondary",onClick:Vn,children:"Cancel"}),c.jsx("button",{type:"button",className:"dash-btn primary",onClick:mt,children:"Save Changes"})]})]})]})]}):c.jsx("div",{className:"stat-sub",children:"No library items."})]})]})}),Ct&&c.jsx("div",{id:"calendarOverlay",onClick:()=>Pt(!1),children:c.jsxs("div",{id:"calendarCard",onClick:S=>S.stopPropagation(),children:[c.jsxs("div",{className:"calendar-header",children:[c.jsx("div",{className:"calendar-title",children:bt.toLocaleString(void 0,{month:"long",year:"numeric"})}),c.jsxs("div",{className:"calendar-nav",children:[c.jsx("button",{className:"calendar-nav-btn",onClick:()=>zt(new Date(bt.getFullYear(),bt.getMonth()-1,1)),children:"<"}),c.jsx("button",{className:"calendar-nav-btn",onClick:()=>zt(new Date(bt.getFullYear(),bt.getMonth()+1,1)),children:">"})]})]}),c.jsxs("div",{className:"calendar-weekdays",children:[c.jsx("div",{children:"Sun"}),c.jsx("div",{children:"Mon"}),c.jsx("div",{children:"Tue"}),c.jsx("div",{children:"Wed"}),c.jsx("div",{children:"Thu"}),c.jsx("div",{children:"Fri"}),c.jsx("div",{children:"Sat"})]}),c.jsx("div",{className:"calendar-grid",id:"releaseCalendar",children:Ca.map((S,B)=>S.type==="pad"?c.jsx("div",{className:"calendar-day pad"},B):c.jsxs("div",{className:"calendar-day"+(S.isToday?" today":""),children:[c.jsx("div",{className:"day-num",children:S.day}),c.jsxs("div",{className:"calendar-releases",children:[(jt===S.dateKey?S.releases:S.releases.slice(0,2)).map((W,pe)=>c.jsx("div",{className:"calendar-release",title:W.title,children:W.title},pe)),S.releases.length>2&&c.jsxs("button",{className:"calendar-more-btn",onClick:()=>{const W=new Date(bt.getFullYear(),bt.getMonth(),S.day);Me({dateLabel:W.toLocaleDateString(void 0,{month:"long",day:"numeric",year:"numeric"}),releases:S.releases})},children:["+",S.releases.length-2," more"]})]})]},B))}),!cn.length&&c.jsx("div",{className:"calendar-empty",children:"No wishlist releases found."}),c.jsx("button",{id:"calendarClose",onClick:()=>Pt(!1),children:"x"})]})}),St.open&&c.jsx("div",{id:"statDetailOverlay",onClick:Jn,children:c.jsxs("div",{id:"statDetailCard",onClick:S=>S.stopPropagation(),children:[c.jsx("button",{id:"statDetailClose",onClick:Jn,children:"x"}),c.jsxs("h2",{id:"statDetailTitle",children:[St.type==="publishers"&&"Top Publishers",St.type==="genres"&&"Top Genres",St.type==="demographics"&&"Top Demographics",St.type==="timeToRead"&&"Avg Time From Purchase to Read",St.type==="collectionValue"&&"Collection Value",St.type==="pages"&&"Pages Read vs Total",St.type==="ratings"&&"Ratings",St.type==="releases"&&"Wishlist Releases"]}),c.jsx("div",{id:"statDetailBody",children:ks()})]})}),ke&&c.jsx("div",{id:"calendarOverlay",onClick:()=>Me(null),style:{zIndex:10080},children:c.jsxs("div",{id:"calendarCard",onClick:S=>S.stopPropagation(),style:{maxWidth:"520px"},children:[c.jsxs("div",{className:"calendar-header",children:[c.jsx("div",{className:"calendar-title",children:ke.dateLabel}),c.jsx("button",{className:"calendar-close-btn",onClick:()=>Me(null),type:"button",children:"Close"})]}),c.jsx("div",{className:"calendar-releases",children:ke.releases.map((S,B)=>c.jsx("div",{className:"calendar-release",title:S.title,children:S.title},B))})]})}),e&&L&&c.jsx("div",{className:"dashboard-modal-backdrop visible",onClick:S=>{S.target===S.currentTarget&&ee(!1)},children:c.jsxs("div",{className:"dashboard-modal",children:[c.jsxs("div",{className:"dashboard-modal-header",children:[c.jsx("h3",{children:"Webhook Settings"}),c.jsx("button",{className:"dashboard-close",onClick:()=>ee(!1),type:"button",children:"Close"})]}),c.jsxs("div",{className:"dashboard-modal-body",children:[c.jsxs("label",{className:"dashboard-input",children:[c.jsx("span",{children:"Yearly summary webhook"}),c.jsx("input",{type:"text",value:U.yearly,onChange:S=>G(B=>({...B,yearly:S.target.value}))})]}),c.jsxs("label",{className:"dashboard-input",children:[c.jsx("span",{children:"Release timer webhook"}),c.jsx("input",{type:"text",value:U.release,onChange:S=>G(B=>({...B,release:S.target.value}))})]}),c.jsxs("label",{className:"dashboard-input",children:[c.jsx("span",{children:"Activity webhook"}),c.jsx("input",{type:"text",value:U.activity,onChange:S=>G(B=>({...B,activity:S.target.value}))})]}),c.jsxs("div",{className:"dashboard-input",style:{borderTop:"1px solid rgba(255,182,193,0.2)",paddingTop:8},children:[c.jsx("span",{children:"User roles"}),c.jsx("div",{style:{marginTop:8,fontSize:"0.85rem",color:"var(--text-soft)"},children:J?c.jsx("span",{children:"Loading users"}):se.length===0?c.jsx("span",{children:"No users found."}):c.jsx("ul",{style:{listStyle:"none",margin:"6px 0 0",padding:0,display:"flex",gap:6,flexDirection:"column"},children:se.map(S=>c.jsxs("li",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:8,background:"rgba(24,5,18,0.7)",border:"1px solid rgba(255,182,193,0.18)",borderRadius:10,padding:"6px 8px",flexWrap:"wrap"},children:[c.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:2},children:[c.jsx("strong",{children:S.displayName||S.email||S.uid}),c.jsx("span",{style:{fontSize:"0.85rem",opacity:.8},children:S.email||S.uid})]}),c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[c.jsx("span",{className:"role-pill",children:S.role||"viewer"}),S.role==="admin"?c.jsx("button",{className:"dashboard-close",type:"button",onClick:()=>Tt(S.uid,"viewer"),style:{padding:"4px 10px"},children:"Make viewer"}):c.jsx("button",{className:"stat-link",type:"button",onClick:()=>Tt(S.uid,"admin"),style:{padding:"4px 10px"},children:"Make admin"})]})]},S.uid))})})]})]}),c.jsxs("div",{className:"dashboard-modal-footer",children:[c.jsx("button",{className:"stat-link",type:"button",onClick:async()=>{try{await Ks(At(tt,"settings","webhooks"),{yearly:U.yearly||dl,release:U.release||hl,activity:U.activity||fl}),ee(!1)}catch(S){console.error("Failed to save webhooks",S),alert("Failed to save webhooks.")}},children:"Save"}),c.jsx("button",{className:"stat-link danger",type:"button",onClick:()=>ee(!1),children:"Cancel"})]})]})})]})}function YR(){const[n,e]=j.useState(!0),[t,s]=j.useState(""),[a,l]=j.useState(0),[d,f]=j.useState([]),[m,v]=j.useState(0),w=j.useRef(null);j.useEffect(()=>{document.title="Music | im.ok"},[]),j.useEffect(()=>{let oe=!1;async function Ee(){e(!0),s("");try{const Se=await fetch("https://music-api-worker.imokissick.workers.dev/music");if(!Se.ok)throw new Error("Worker fetch failed");const b=await Se.json();if(oe)return;const A=Array.isArray(b.combined)?b.combined:[],k=Array.isArray(b.spotify)?b.spotify:[],V=Array.isArray(b.soundcloud)?b.soundcloud:[],D=[...A,...k,...V].reduce((I,ge)=>{const ve=(ge.title||"").toLowerCase().trim();if(!ve)return I;const lt=I.findIndex(Be=>(Be.title||"").toLowerCase().trim()===ve);return lt>=0?(I[lt].source!=="spotify"&&ge.source==="spotify"&&(I[lt]=ge),I):(I.push(ge),I)},[]).map(I=>({...I,releaseDate:I.releaseDate?new Date(I.releaseDate):new Date}));f(D)}catch(Se){console.error(Se),oe||s("Failed to load music feeds.")}finally{oe||e(!1)}}return Ee(),()=>{oe=!0}},[]);const E=Math.min(4,Math.max(1,d.length)),C=E?Math.ceil(d.length/E):0,U=()=>{w.current&&clearInterval(w.current),d.length&&(v(oe=>oe+1),w.current=setInterval(()=>{l(oe=>(Math.floor(oe/E)+1)%C*E%d.length),v(oe=>oe+1)},15e3))};j.useEffect(()=>{if(d.length)return U(),()=>{w.current&&clearInterval(w.current)}},[d,E]);const G=oe=>{d.length&&(l(Ee=>(Math.floor(Ee/E)+oe+C)%C*E%d.length),U())},K=oe=>{d.length&&(l(oe*E%d.length),U())},O=oe=>Ee=>{Ee.preventDefault();const b=oe.source==="spotify"?`spotify:album:${oe.id}`:oe.url,A=oe.url;try{const k=setTimeout(()=>{window.open(A,"_blank","noopener,noreferrer")},600);window.location.href=b,setTimeout(()=>clearTimeout(k),800)}catch{window.open(A,"_blank","noopener,noreferrer")}},re=d[0],ye=oe=>oe?{backgroundImage:`url(${oe})`,backgroundSize:"cover",backgroundPosition:"center"}:{},ne=re?re.source==="spotify"?"Spotify":"SoundCloud":"";return c.jsxs("main",{className:"page music-page",children:[c.jsxs("header",{className:"music-hero",children:[c.jsxs("div",{className:"music-hero-content",children:[c.jsx("p",{className:"music-pill",children:"im.ok  Artist"}),c.jsx("h1",{children:re?re.title:"Latest & Greatest"}),c.jsx("p",{className:"music-sub",children:"Check out my latest song. I know it's been almost a whole year since I've released. I have been on a much needed hiatus. I felt the whole world crumbling around me and had no time to breathe so this is why I took a break. Here's to 2026!"}),re&&c.jsx("div",{className:"music-badges",children:c.jsx("span",{children:ne})})]}),c.jsx("div",{className:"music-hero-embed",children:c.jsxs("div",{className:"music-hero-art",style:ye(re==null?void 0:re.artwork),children:[!(re!=null&&re.artwork)&&c.jsx("div",{className:"music-hero-art-fallback",children:"Artwork"}),re&&c.jsx("button",{className:"music-link music-play hero-play","aria-label":`Play ${re.title}`,onClick:O(re)})]})})]}),c.jsxs("section",{className:"music-section",children:[c.jsx("div",{className:"music-section-header",children:c.jsx("h2",{children:"Releases"})}),t&&c.jsx("div",{className:"music-error",children:t}),n&&c.jsx("div",{className:"music-loading",children:"Loading music feeds..."}),!n&&d.length===0&&c.jsx("div",{className:"music-empty",children:"Connect Spotify/SoundCloud tokens to see live releases."}),!n&&d.length>0&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"music-carousel-wrap",children:[c.jsx("button",{className:"music-nav left",onClick:()=>G(-1),"aria-label":"Previous releases",children:""}),c.jsx("div",{className:"music-carousel",children:Array.from({length:E}).map((oe,Ee)=>{const Se=d[(a+Ee)%d.length];return Se?c.jsxs("div",{className:"music-card",children:[c.jsx("div",{className:"music-card-art",style:ye(Se.artwork)}),c.jsxs("div",{className:"music-card-body",children:[c.jsx("div",{className:"music-card-title",children:Se.title}),c.jsx("div",{className:"music-card-actions",children:c.jsx("button",{className:"music-link music-play","aria-label":`Play ${Se.title}`,onClick:O(Se)})})]})]},`${Se.id}-${Ee}`):null})}),c.jsx("button",{className:"music-nav right",onClick:()=>G(1),"aria-label":"Next releases",children:""})]}),c.jsx("div",{className:"music-dots",children:Array.from({length:C}).map((oe,Ee)=>{const Se=Math.floor(a/E)===Ee,b=Se?`${Ee}-${m}`:`${Ee}-idle`;return c.jsx("button",{className:`dot ${Se?"active":""}`,onClick:()=>K(Ee),"aria-label":`Go to set ${Ee+1}`,children:c.jsx("span",{className:"dot-fill"},b)},Ee)})})]})]}),c.jsxs("div",{className:"music-feeds-row",children:[c.jsxs("section",{className:"music-section",children:[c.jsx("div",{className:"music-section-header",children:c.jsx("h2",{children:"Spotify"})}),c.jsx("div",{className:"music-embed-card",children:c.jsx("iframe",{title:"Spotify Artist",src:"https://open.spotify.com/embed/artist/00sbWLxYLDs8i5BLQL9Qdo?utm_source=generator&theme=0",width:"100%",height:"400",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy"})})]}),c.jsxs("section",{className:"music-section",children:[c.jsx("div",{className:"music-section-header",children:c.jsx("h2",{children:"SoundCloud"})}),c.jsx("div",{className:"music-embed-card",children:c.jsx("iframe",{title:"SoundCloud Player",width:"100%",height:"400",scrolling:"no",frameBorder:"no",allow:"autoplay",src:"https://w.soundcloud.com/player/?url=https%3A//soundcloud.com/imxk&color=%23ff69b4&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true&visual=true"})})]})]})]})}function JR(){const n=Bu(),{user:e}=jo(),t=async a=>{if(!(a!=null&&a.uid))return;const l=At(tt,"users",a.uid);try{const d=await Np(l),f=d.exists()?d.data():null,m=(f==null?void 0:f.role)||"viewer";await Ks(l,{role:m,email:a.email||(f==null?void 0:f.email)||"",displayName:a.displayName||(f==null?void 0:f.displayName)||"",createdAt:(f==null?void 0:f.createdAt)||Uu()},{merge:!0})}catch(d){console.warn("Failed to upsert user doc",d)}};j.useEffect(()=>{e!=null&&e.uid&&t(e).finally(()=>n("/"))},[e,n]);async function s(){try{const a=new es,l=await Y_(Lr,a);await t(l.user),n("/")}catch(a){console.error(a),alert("Google Sign-In failed.")}}return c.jsx("div",{className:"signin-page",children:c.jsxs("div",{className:"signin-card",children:[c.jsx("h2",{className:"signin-title",children:"Welcome Back"}),c.jsx("p",{className:"signin-sub",children:"Sign in to access the dashboard & edit collections."}),c.jsxs("button",{className:"google-btn",onClick:s,children:[c.jsx("img",{src:"https://www.svgrepo.com/show/475656/google-color.svg",alt:"",className:"google-icon"}),"Continue with Google"]}),c.jsxs("button",{className:"signin-cancel",onClick:()=>n("/"),children:["<"," Back to Home"]})]})})}const XR=j.lazy(()=>Xl(()=>import("./SteamCard-ZnWzKFVb.js"),[])),ZR=j.lazy(()=>Xl(()=>import("./SteamRecents-rcnqKN8J.js"),[])),eA=j.lazy(()=>Xl(()=>import("./SteamGames-DF_0Y1-H.js"),[]));function tA(){return j.useEffect(()=>{document.title="Tyler's Gaming Lounge"},[]),c.jsxs("div",{className:"steam-page page",children:[c.jsxs("header",{style:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",gap:"6px"},children:[c.jsx("h1",{style:{margin:0,fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Tyler's Gaming Lounge"}),c.jsx("p",{style:{margin:"6px 0 0",color:"var(--text-soft)",fontSize:"0.9rem"},children:"This will be the home to all of my gaming collections, this is still being worked on, but thought it was cool with just steam for now."})]}),c.jsx(tf,{minHeight:260,children:c.jsx(j.Suspense,{fallback:c.jsx(wu,{label:"Profile"}),children:c.jsx(XR,{})})}),c.jsx(tf,{minHeight:240,children:c.jsx(j.Suspense,{fallback:c.jsx(wu,{label:"Recently played"}),children:c.jsx(ZR,{})})}),c.jsx(tf,{minHeight:400,children:c.jsx(j.Suspense,{fallback:c.jsx(wu,{label:"Library & Achievements"}),children:c.jsx(eA,{})})})]})}function tf({children:n,minHeight:e=200}){const[t,s]=j.useState(!1),a=j.useRef(null);j.useEffect(()=>{const d=new IntersectionObserver(f=>{f[0].isIntersecting&&(s(!0),d.disconnect())},{rootMargin:"200px 0px"});return a.current&&d.observe(a.current),()=>d.disconnect()},[]);const l=t?void 0:{minHeight:e};return c.jsx("div",{ref:a,style:l,children:t?n:c.jsx(wu,{})})}function wu({label:n="Loading section"}){return c.jsxs("div",{className:"steam-skeleton",children:[c.jsx("div",{className:"steam-skeleton-bar"}),c.jsx("div",{className:"steam-skeleton-bar short"}),c.jsx("p",{className:"steam-skeleton-label",children:n})]})}function nA(){return c.jsxs(dR,{children:[c.jsx(fR,{}),c.jsxs(zE,{children:[c.jsx(Zr,{path:"/",element:c.jsx(Av,{})}),c.jsx(Zr,{path:"/home",element:c.jsx(Av,{})}),c.jsx(Zr,{path:"/manga",element:c.jsx(yR,{})}),c.jsx(Zr,{path:"/anime",element:c.jsx(bR,{})}),c.jsx(Zr,{path:"/tcg",element:c.jsx(AR,{})}),c.jsx(Zr,{path:"/music",element:c.jsx(YR,{})}),c.jsx(Zr,{path:"/dashboard",element:c.jsx(QR,{})}),c.jsx(Zr,{path:"/signin",element:c.jsx(JR,{})}),c.jsx(Zr,{path:"/steam",element:c.jsx(tA,{})}),c.jsx(Zr,{path:"*",element:c.jsx(FE,{to:"/home",replace:!0})})]})]})}Kx.createRoot(document.getElementById("root")).render(c.jsx(Wv.StrictMode,{children:c.jsx(KE,{basename:"/base",children:c.jsx(nA,{})})}));export{c as j,j as r};
