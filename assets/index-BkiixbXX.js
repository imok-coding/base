function Wx(n,e){for(var t=0;t<e.length;t++){const s=e[t];if(typeof s!="string"&&!Array.isArray(s)){for(const a in s)if(a!=="default"&&!(a in n)){const l=Object.getOwnPropertyDescriptor(s,a);l&&Object.defineProperty(n,a,l.get?l:{enumerable:!0,get:()=>s[a]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const d of l.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&s(d)}).observe(document,{childList:!0,subtree:!0});function t(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(a){if(a.ep)return;a.ep=!0;const l=t(a);fetch(a.href,l)}})();function Kv(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Oh={exports:{}},dl={},Mh={exports:{}},at={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zg;function qx(){if(zg)return at;zg=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),d=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),v=Symbol.for("react.memo"),w=Symbol.for("react.lazy"),E=Symbol.iterator;function C(b){return b===null||typeof b!="object"?null:(b=E&&b[E]||b["@@iterator"],typeof b=="function"?b:null)}var $={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},q=Object.assign,Y={};function F(b,J,ye){this.props=b,this.context=J,this.refs=Y,this.updater=ye||$}F.prototype.isReactComponent={},F.prototype.setState=function(b,J){if(typeof b!="object"&&typeof b!="function"&&b!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,b,J,"setState")},F.prototype.forceUpdate=function(b){this.updater.enqueueForceUpdate(this,b,"forceUpdate")};function X(){}X.prototype=F.prototype;function ge(b,J,ye){this.props=b,this.context=J,this.refs=Y,this.updater=ye||$}var re=ge.prototype=new X;re.constructor=ge,q(re,F.prototype),re.isPureReactComponent=!0;var le=Array.isArray,xe=Object.prototype.hasOwnProperty,Se={current:null},N={key:!0,ref:!0,__self:!0,__source:!0};function R(b,J,ye){var je,Ae={},Ue=null,Ze=null;if(J!=null)for(je in J.ref!==void 0&&(Ze=J.ref),J.key!==void 0&&(Ue=""+J.key),J)xe.call(J,je)&&!N.hasOwnProperty(je)&&(Ae[je]=J[je]);var Qe=arguments.length-2;if(Qe===1)Ae.children=ye;else if(1<Qe){for(var ut=Array(Qe),bt=0;bt<Qe;bt++)ut[bt]=arguments[bt+2];Ae.children=ut}if(b&&b.defaultProps)for(je in Qe=b.defaultProps,Qe)Ae[je]===void 0&&(Ae[je]=Qe[je]);return{$$typeof:n,type:b,key:Ue,ref:Ze,props:Ae,_owner:Se.current}}function k(b,J){return{$$typeof:n,type:b.type,key:J,ref:b.ref,props:b.props,_owner:b._owner}}function L(b){return typeof b=="object"&&b!==null&&b.$$typeof===n}function M(b){var J={"=":"=0",":":"=2"};return"$"+b.replace(/[=:]/g,function(ye){return J[ye]})}var D=/\/+/g;function S(b,J){return typeof b=="object"&&b!==null&&b.key!=null?M(""+b.key):J.toString(36)}function ce(b,J,ye,je,Ae){var Ue=typeof b;(Ue==="undefined"||Ue==="boolean")&&(b=null);var Ze=!1;if(b===null)Ze=!0;else switch(Ue){case"string":case"number":Ze=!0;break;case"object":switch(b.$$typeof){case n:case e:Ze=!0}}if(Ze)return Ze=b,Ae=Ae(Ze),b=je===""?"."+S(Ze,0):je,le(Ae)?(ye="",b!=null&&(ye=b.replace(D,"$&/")+"/"),ce(Ae,J,ye,"",function(bt){return bt})):Ae!=null&&(L(Ae)&&(Ae=k(Ae,ye+(!Ae.key||Ze&&Ze.key===Ae.key?"":(""+Ae.key).replace(D,"$&/")+"/")+b)),J.push(Ae)),1;if(Ze=0,je=je===""?".":je+":",le(b))for(var Qe=0;Qe<b.length;Qe++){Ue=b[Qe];var ut=je+S(Ue,Qe);Ze+=ce(Ue,J,ye,ut,Ae)}else if(ut=C(b),typeof ut=="function")for(b=ut.call(b),Qe=0;!(Ue=b.next()).done;)Ue=Ue.value,ut=je+S(Ue,Qe++),Ze+=ce(Ue,J,ye,ut,Ae);else if(Ue==="object")throw J=String(b),Error("Objects are not valid as a React child (found: "+(J==="[object Object]"?"object with keys {"+Object.keys(b).join(", ")+"}":J)+"). If you meant to render a collection of children, use an array instead.");return Ze}function me(b,J,ye){if(b==null)return b;var je=[],Ae=0;return ce(b,je,"","",function(Ue){return J.call(ye,Ue,Ae++)}),je}function dt(b){if(b._status===-1){var J=b._result;J=J(),J.then(function(ye){(b._status===0||b._status===-1)&&(b._status=1,b._result=ye)},function(ye){(b._status===0||b._status===-1)&&(b._status=2,b._result=ye)}),b._status===-1&&(b._status=0,b._result=J)}if(b._status===1)return b._result.default;throw b._result}var We={current:null},V={transition:null},ne={ReactCurrentDispatcher:We,ReactCurrentBatchConfig:V,ReactCurrentOwner:Se};function se(){throw Error("act(...) is not supported in production builds of React.")}return at.Children={map:me,forEach:function(b,J,ye){me(b,function(){J.apply(this,arguments)},ye)},count:function(b){var J=0;return me(b,function(){J++}),J},toArray:function(b){return me(b,function(J){return J})||[]},only:function(b){if(!L(b))throw Error("React.Children.only expected to receive a single React element child.");return b}},at.Component=F,at.Fragment=t,at.Profiler=a,at.PureComponent=ge,at.StrictMode=s,at.Suspense=m,at.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ne,at.act=se,at.cloneElement=function(b,J,ye){if(b==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+b+".");var je=q({},b.props),Ae=b.key,Ue=b.ref,Ze=b._owner;if(J!=null){if(J.ref!==void 0&&(Ue=J.ref,Ze=Se.current),J.key!==void 0&&(Ae=""+J.key),b.type&&b.type.defaultProps)var Qe=b.type.defaultProps;for(ut in J)xe.call(J,ut)&&!N.hasOwnProperty(ut)&&(je[ut]=J[ut]===void 0&&Qe!==void 0?Qe[ut]:J[ut])}var ut=arguments.length-2;if(ut===1)je.children=ye;else if(1<ut){Qe=Array(ut);for(var bt=0;bt<ut;bt++)Qe[bt]=arguments[bt+2];je.children=Qe}return{$$typeof:n,type:b.type,key:Ae,ref:Ue,props:je,_owner:Ze}},at.createContext=function(b){return b={$$typeof:d,_currentValue:b,_currentValue2:b,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},b.Provider={$$typeof:l,_context:b},b.Consumer=b},at.createElement=R,at.createFactory=function(b){var J=R.bind(null,b);return J.type=b,J},at.createRef=function(){return{current:null}},at.forwardRef=function(b){return{$$typeof:f,render:b}},at.isValidElement=L,at.lazy=function(b){return{$$typeof:w,_payload:{_status:-1,_result:b},_init:dt}},at.memo=function(b,J){return{$$typeof:v,type:b,compare:J===void 0?null:J}},at.startTransition=function(b){var J=V.transition;V.transition={};try{b()}finally{V.transition=J}},at.unstable_act=se,at.useCallback=function(b,J){return We.current.useCallback(b,J)},at.useContext=function(b){return We.current.useContext(b)},at.useDebugValue=function(){},at.useDeferredValue=function(b){return We.current.useDeferredValue(b)},at.useEffect=function(b,J){return We.current.useEffect(b,J)},at.useId=function(){return We.current.useId()},at.useImperativeHandle=function(b,J,ye){return We.current.useImperativeHandle(b,J,ye)},at.useInsertionEffect=function(b,J){return We.current.useInsertionEffect(b,J)},at.useLayoutEffect=function(b,J){return We.current.useLayoutEffect(b,J)},at.useMemo=function(b,J){return We.current.useMemo(b,J)},at.useReducer=function(b,J,ye){return We.current.useReducer(b,J,ye)},at.useRef=function(b){return We.current.useRef(b)},at.useState=function(b){return We.current.useState(b)},at.useSyncExternalStore=function(b,J,ye){return We.current.useSyncExternalStore(b,J,ye)},at.useTransition=function(){return We.current.useTransition()},at.version="18.3.1",at}var Bg;function Df(){return Bg||(Bg=1,Mh.exports=qx()),Mh.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $g;function Hx(){if($g)return dl;$g=1;var n=Df(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,a=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function d(f,m,v){var w,E={},C=null,$=null;v!==void 0&&(C=""+v),m.key!==void 0&&(C=""+m.key),m.ref!==void 0&&($=m.ref);for(w in m)s.call(m,w)&&!l.hasOwnProperty(w)&&(E[w]=m[w]);if(f&&f.defaultProps)for(w in m=f.defaultProps,m)E[w]===void 0&&(E[w]=m[w]);return{$$typeof:e,type:f,key:C,ref:$,props:E,_owner:a.current}}return dl.Fragment=t,dl.jsx=d,dl.jsxs=d,dl}var Wg;function Gx(){return Wg||(Wg=1,Oh.exports=Hx()),Oh.exports}var c=Gx(),j=Df();const Qv=Kv(j),Kx=Wx({__proto__:null,default:Qv},[j]);var su={},Fh={exports:{}},cr={},Uh={exports:{}},zh={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qg;function Qx(){return qg||(qg=1,(function(n){function e(V,ne){var se=V.length;V.push(ne);e:for(;0<se;){var b=se-1>>>1,J=V[b];if(0<a(J,ne))V[b]=ne,V[se]=J,se=b;else break e}}function t(V){return V.length===0?null:V[0]}function s(V){if(V.length===0)return null;var ne=V[0],se=V.pop();if(se!==ne){V[0]=se;e:for(var b=0,J=V.length,ye=J>>>1;b<ye;){var je=2*(b+1)-1,Ae=V[je],Ue=je+1,Ze=V[Ue];if(0>a(Ae,se))Ue<J&&0>a(Ze,Ae)?(V[b]=Ze,V[Ue]=se,b=Ue):(V[b]=Ae,V[je]=se,b=je);else if(Ue<J&&0>a(Ze,se))V[b]=Ze,V[Ue]=se,b=Ue;else break e}}return ne}function a(V,ne){var se=V.sortIndex-ne.sortIndex;return se!==0?se:V.id-ne.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;n.unstable_now=function(){return l.now()}}else{var d=Date,f=d.now();n.unstable_now=function(){return d.now()-f}}var m=[],v=[],w=1,E=null,C=3,$=!1,q=!1,Y=!1,F=typeof setTimeout=="function"?setTimeout:null,X=typeof clearTimeout=="function"?clearTimeout:null,ge=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function re(V){for(var ne=t(v);ne!==null;){if(ne.callback===null)s(v);else if(ne.startTime<=V)s(v),ne.sortIndex=ne.expirationTime,e(m,ne);else break;ne=t(v)}}function le(V){if(Y=!1,re(V),!q)if(t(m)!==null)q=!0,dt(xe);else{var ne=t(v);ne!==null&&We(le,ne.startTime-V)}}function xe(V,ne){q=!1,Y&&(Y=!1,X(R),R=-1),$=!0;var se=C;try{for(re(ne),E=t(m);E!==null&&(!(E.expirationTime>ne)||V&&!M());){var b=E.callback;if(typeof b=="function"){E.callback=null,C=E.priorityLevel;var J=b(E.expirationTime<=ne);ne=n.unstable_now(),typeof J=="function"?E.callback=J:E===t(m)&&s(m),re(ne)}else s(m);E=t(m)}if(E!==null)var ye=!0;else{var je=t(v);je!==null&&We(le,je.startTime-ne),ye=!1}return ye}finally{E=null,C=se,$=!1}}var Se=!1,N=null,R=-1,k=5,L=-1;function M(){return!(n.unstable_now()-L<k)}function D(){if(N!==null){var V=n.unstable_now();L=V;var ne=!0;try{ne=N(!0,V)}finally{ne?S():(Se=!1,N=null)}}else Se=!1}var S;if(typeof ge=="function")S=function(){ge(D)};else if(typeof MessageChannel<"u"){var ce=new MessageChannel,me=ce.port2;ce.port1.onmessage=D,S=function(){me.postMessage(null)}}else S=function(){F(D,0)};function dt(V){N=V,Se||(Se=!0,S())}function We(V,ne){R=F(function(){V(n.unstable_now())},ne)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(V){V.callback=null},n.unstable_continueExecution=function(){q||$||(q=!0,dt(xe))},n.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<V?Math.floor(1e3/V):5},n.unstable_getCurrentPriorityLevel=function(){return C},n.unstable_getFirstCallbackNode=function(){return t(m)},n.unstable_next=function(V){switch(C){case 1:case 2:case 3:var ne=3;break;default:ne=C}var se=C;C=ne;try{return V()}finally{C=se}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(V,ne){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var se=C;C=V;try{return ne()}finally{C=se}},n.unstable_scheduleCallback=function(V,ne,se){var b=n.unstable_now();switch(typeof se=="object"&&se!==null?(se=se.delay,se=typeof se=="number"&&0<se?b+se:b):se=b,V){case 1:var J=-1;break;case 2:J=250;break;case 5:J=1073741823;break;case 4:J=1e4;break;default:J=5e3}return J=se+J,V={id:w++,callback:ne,priorityLevel:V,startTime:se,expirationTime:J,sortIndex:-1},se>b?(V.sortIndex=se,e(v,V),t(m)===null&&V===t(v)&&(Y?(X(R),R=-1):Y=!0,We(le,se-b))):(V.sortIndex=J,e(m,V),q||$||(q=!0,dt(xe))),V},n.unstable_shouldYield=M,n.unstable_wrapCallback=function(V){var ne=C;return function(){var se=C;C=ne;try{return V.apply(this,arguments)}finally{C=se}}}})(zh)),zh}var Hg;function Yx(){return Hg||(Hg=1,Uh.exports=Qx()),Uh.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gg;function Jx(){if(Gg)return cr;Gg=1;var n=Df(),e=Yx();function t(r){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+r,o=1;o<arguments.length;o++)i+="&args[]="+encodeURIComponent(arguments[o]);return"Minified React error #"+r+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,a={};function l(r,i){d(r,i),d(r+"Capture",i)}function d(r,i){for(a[r]=i,r=0;r<i.length;r++)s.add(i[r])}var f=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),m=Object.prototype.hasOwnProperty,v=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,w={},E={};function C(r){return m.call(E,r)?!0:m.call(w,r)?!1:v.test(r)?E[r]=!0:(w[r]=!0,!1)}function $(r,i,o,h){if(o!==null&&o.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return h?!1:o!==null?!o.acceptsBooleans:(r=r.toLowerCase().slice(0,5),r!=="data-"&&r!=="aria-");default:return!1}}function q(r,i,o,h){if(i===null||typeof i>"u"||$(r,i,o,h))return!0;if(h)return!1;if(o!==null)switch(o.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function Y(r,i,o,h,p,y,x){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=h,this.attributeNamespace=p,this.mustUseProperty=o,this.propertyName=r,this.type=i,this.sanitizeURL=y,this.removeEmptyString=x}var F={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(r){F[r]=new Y(r,0,!1,r,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(r){var i=r[0];F[i]=new Y(i,1,!1,r[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(r){F[r]=new Y(r,2,!1,r.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(r){F[r]=new Y(r,2,!1,r,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(r){F[r]=new Y(r,3,!1,r.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(r){F[r]=new Y(r,3,!0,r,null,!1,!1)}),["capture","download"].forEach(function(r){F[r]=new Y(r,4,!1,r,null,!1,!1)}),["cols","rows","size","span"].forEach(function(r){F[r]=new Y(r,6,!1,r,null,!1,!1)}),["rowSpan","start"].forEach(function(r){F[r]=new Y(r,5,!1,r.toLowerCase(),null,!1,!1)});var X=/[\-:]([a-z])/g;function ge(r){return r[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(r){var i=r.replace(X,ge);F[i]=new Y(i,1,!1,r,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(r){var i=r.replace(X,ge);F[i]=new Y(i,1,!1,r,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(r){var i=r.replace(X,ge);F[i]=new Y(i,1,!1,r,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(r){F[r]=new Y(r,1,!1,r.toLowerCase(),null,!1,!1)}),F.xlinkHref=new Y("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(r){F[r]=new Y(r,1,!1,r.toLowerCase(),null,!0,!0)});function re(r,i,o,h){var p=F.hasOwnProperty(i)?F[i]:null;(p!==null?p.type!==0:h||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(q(i,o,p,h)&&(o=null),h||p===null?C(i)&&(o===null?r.removeAttribute(i):r.setAttribute(i,""+o)):p.mustUseProperty?r[p.propertyName]=o===null?p.type===3?!1:"":o:(i=p.attributeName,h=p.attributeNamespace,o===null?r.removeAttribute(i):(p=p.type,o=p===3||p===4&&o===!0?"":""+o,h?r.setAttributeNS(h,i,o):r.setAttribute(i,o))))}var le=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,xe=Symbol.for("react.element"),Se=Symbol.for("react.portal"),N=Symbol.for("react.fragment"),R=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),L=Symbol.for("react.provider"),M=Symbol.for("react.context"),D=Symbol.for("react.forward_ref"),S=Symbol.for("react.suspense"),ce=Symbol.for("react.suspense_list"),me=Symbol.for("react.memo"),dt=Symbol.for("react.lazy"),We=Symbol.for("react.offscreen"),V=Symbol.iterator;function ne(r){return r===null||typeof r!="object"?null:(r=V&&r[V]||r["@@iterator"],typeof r=="function"?r:null)}var se=Object.assign,b;function J(r){if(b===void 0)try{throw Error()}catch(o){var i=o.stack.trim().match(/\n( *(at )?)/);b=i&&i[1]||""}return`
`+b+r}var ye=!1;function je(r,i){if(!r||ye)return"";ye=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(ee){var h=ee}Reflect.construct(r,[],i)}else{try{i.call()}catch(ee){h=ee}r.call(i.prototype)}else{try{throw Error()}catch(ee){h=ee}r()}}catch(ee){if(ee&&h&&typeof ee.stack=="string"){for(var p=ee.stack.split(`
`),y=h.stack.split(`
`),x=p.length-1,A=y.length-1;1<=x&&0<=A&&p[x]!==y[A];)A--;for(;1<=x&&0<=A;x--,A--)if(p[x]!==y[A]){if(x!==1||A!==1)do if(x--,A--,0>A||p[x]!==y[A]){var O=`
`+p[x].replace(" at new "," at ");return r.displayName&&O.includes("<anonymous>")&&(O=O.replace("<anonymous>",r.displayName)),O}while(1<=x&&0<=A);break}}}finally{ye=!1,Error.prepareStackTrace=o}return(r=r?r.displayName||r.name:"")?J(r):""}function Ae(r){switch(r.tag){case 5:return J(r.type);case 16:return J("Lazy");case 13:return J("Suspense");case 19:return J("SuspenseList");case 0:case 2:case 15:return r=je(r.type,!1),r;case 11:return r=je(r.type.render,!1),r;case 1:return r=je(r.type,!0),r;default:return""}}function Ue(r){if(r==null)return null;if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case N:return"Fragment";case Se:return"Portal";case k:return"Profiler";case R:return"StrictMode";case S:return"Suspense";case ce:return"SuspenseList"}if(typeof r=="object")switch(r.$$typeof){case M:return(r.displayName||"Context")+".Consumer";case L:return(r._context.displayName||"Context")+".Provider";case D:var i=r.render;return r=r.displayName,r||(r=i.displayName||i.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case me:return i=r.displayName||null,i!==null?i:Ue(r.type)||"Memo";case dt:i=r._payload,r=r._init;try{return Ue(r(i))}catch{}}return null}function Ze(r){var i=r.type;switch(r.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return r=i.render,r=r.displayName||r.name||"",i.displayName||(r!==""?"ForwardRef("+r+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ue(i);case 8:return i===R?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function Qe(r){switch(typeof r){case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function ut(r){var i=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function bt(r){var i=ut(r)?"checked":"value",o=Object.getOwnPropertyDescriptor(r.constructor.prototype,i),h=""+r[i];if(!r.hasOwnProperty(i)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var p=o.get,y=o.set;return Object.defineProperty(r,i,{configurable:!0,get:function(){return p.call(this)},set:function(x){h=""+x,y.call(this,x)}}),Object.defineProperty(r,i,{enumerable:o.enumerable}),{getValue:function(){return h},setValue:function(x){h=""+x},stopTracking:function(){r._valueTracker=null,delete r[i]}}}}function ue(r){r._valueTracker||(r._valueTracker=bt(r))}function Ve(r){if(!r)return!1;var i=r._valueTracker;if(!i)return!0;var o=i.getValue(),h="";return r&&(h=ut(r)?r.checked?"true":"false":r.value),r=h,r!==o?(i.setValue(r),!0):!1}function $e(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}function Me(r,i){var o=i.checked;return se({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:o??r._wrapperState.initialChecked})}function xt(r,i){var o=i.defaultValue==null?"":i.defaultValue,h=i.checked!=null?i.checked:i.defaultChecked;o=Qe(i.value!=null?i.value:o),r._wrapperState={initialChecked:h,initialValue:o,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function It(r,i){i=i.checked,i!=null&&re(r,"checked",i,!1)}function jt(r,i){It(r,i);var o=Qe(i.value),h=i.type;if(o!=null)h==="number"?(o===0&&r.value===""||r.value!=o)&&(r.value=""+o):r.value!==""+o&&(r.value=""+o);else if(h==="submit"||h==="reset"){r.removeAttribute("value");return}i.hasOwnProperty("value")?Gt(r,i.type,o):i.hasOwnProperty("defaultValue")&&Gt(r,i.type,Qe(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(r.defaultChecked=!!i.defaultChecked)}function Qt(r,i,o){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var h=i.type;if(!(h!=="submit"&&h!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+r._wrapperState.initialValue,o||i===r.value||(r.value=i),r.defaultValue=i}o=r.name,o!==""&&(r.name=""),r.defaultChecked=!!r._wrapperState.initialChecked,o!==""&&(r.name=o)}function Gt(r,i,o){(i!=="number"||$e(r.ownerDocument)!==r)&&(o==null?r.defaultValue=""+r._wrapperState.initialValue:r.defaultValue!==""+o&&(r.defaultValue=""+o))}var tn=Array.isArray;function Bt(r,i,o,h){if(r=r.options,i){i={};for(var p=0;p<o.length;p++)i["$"+o[p]]=!0;for(o=0;o<r.length;o++)p=i.hasOwnProperty("$"+r[o].value),r[o].selected!==p&&(r[o].selected=p),p&&h&&(r[o].defaultSelected=!0)}else{for(o=""+Qe(o),i=null,p=0;p<r.length;p++){if(r[p].value===o){r[p].selected=!0,h&&(r[p].defaultSelected=!0);return}i!==null||r[p].disabled||(i=r[p])}i!==null&&(i.selected=!0)}}function jn(r,i){if(i.dangerouslySetInnerHTML!=null)throw Error(t(91));return se({},i,{value:void 0,defaultValue:void 0,children:""+r._wrapperState.initialValue})}function Rt(r,i){var o=i.value;if(o==null){if(o=i.children,i=i.defaultValue,o!=null){if(i!=null)throw Error(t(92));if(tn(o)){if(1<o.length)throw Error(t(93));o=o[0]}i=o}i==null&&(i=""),o=i}r._wrapperState={initialValue:Qe(o)}}function nn(r,i){var o=Qe(i.value),h=Qe(i.defaultValue);o!=null&&(o=""+o,o!==r.value&&(r.value=o),i.defaultValue==null&&r.defaultValue!==o&&(r.defaultValue=o)),h!=null&&(r.defaultValue=""+h)}function En(r){var i=r.textContent;i===r._wrapperState.initialValue&&i!==""&&i!==null&&(r.value=i)}function At(r){switch(r){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ye(r,i){return r==null||r==="http://www.w3.org/1999/xhtml"?At(i):r==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":r}var Xn,As=(function(r){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,o,h,p){MSApp.execUnsafeLocalFunction(function(){return r(i,o,h,p)})}:r})(function(r,i){if(r.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in r)r.innerHTML=i;else{for(Xn=Xn||document.createElement("div"),Xn.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=Xn.firstChild;r.firstChild;)r.removeChild(r.firstChild);for(;i.firstChild;)r.appendChild(i.firstChild)}});function qn(r,i){if(i){var o=r.firstChild;if(o&&o===r.lastChild&&o.nodeType===3){o.nodeValue=i;return}}r.textContent=i}var Mr={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Er=["Webkit","ms","Moz","O"];Object.keys(Mr).forEach(function(r){Er.forEach(function(i){i=i+r.charAt(0).toUpperCase()+r.substring(1),Mr[i]=Mr[r]})});function Fr(r,i,o){return i==null||typeof i=="boolean"||i===""?"":o||typeof i!="number"||i===0||Mr.hasOwnProperty(r)&&Mr[r]?(""+i).trim():i+"px"}function Hn(r,i){r=r.style;for(var o in i)if(i.hasOwnProperty(o)){var h=o.indexOf("--")===0,p=Fr(o,i[o],h);o==="float"&&(o="cssFloat"),h?r.setProperty(o,p):r[o]=p}}var hr=se({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ns(r,i){if(i){if(hr[r]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(t(137,r));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(t(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(t(61))}if(i.style!=null&&typeof i.style!="object")throw Error(t(62))}}function Zn(r,i){if(r.indexOf("-")===-1)return typeof i.is=="string";switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ur=null;function Et(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var ks=null,Ft=null,rn=null;function fr(r){if(r=Yo(r)){if(typeof ks!="function")throw Error(t(280));var i=r.stateNode;i&&(i=_c(i),ks(r.stateNode,r.type,i))}}function Dn(r){Ft?rn?rn.push(r):rn=[r]:Ft=r}function Vn(){if(Ft){var r=Ft,i=rn;if(rn=Ft=null,fr(r),i)for(r=0;r<i.length;r++)fr(i[r])}}function sn(r,i){return r(i)}function Tr(){}var er=!1;function os(r,i,o){if(er)return r(i,o);er=!0;try{return sn(r,i,o)}finally{er=!1,(Ft!==null||rn!==null)&&(Tr(),Vn())}}function _t(r,i){var o=r.stateNode;if(o===null)return null;var h=_c(o);if(h===null)return null;o=h[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(r=r.type,h=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!h;break e;default:r=!1}if(r)return null;if(o&&typeof o!="function")throw Error(t(231,i,typeof o));return o}var tr=!1;if(f)try{var Ct={};Object.defineProperty(Ct,"passive",{get:function(){tr=!0}}),window.addEventListener("test",Ct,Ct),window.removeEventListener("test",Ct,Ct)}catch{tr=!1}function P(r,i,o,h,p,y,x,A,O){var ee=Array.prototype.slice.call(arguments,3);try{i.apply(o,ee)}catch(he){this.onError(he)}}var Z=!1,oe=null,B=!1,K=null,Ne={onError:function(r){Z=!0,oe=r}};function Le(r,i,o,h,p,y,x,A,O){Z=!1,oe=null,P.apply(Ne,arguments)}function Pt(r,i,o,h,p,y,x,A,O){if(Le.apply(this,arguments),Z){if(Z){var ee=oe;Z=!1,oe=null}else throw Error(t(198));B||(B=!0,K=ee)}}function we(r){var i=r,o=r;if(r.alternate)for(;i.return;)i=i.return;else{r=i;do i=r,(i.flags&4098)!==0&&(o=i.return),r=i.return;while(r)}return i.tag===3?o:null}function Ke(r){if(r.tag===13){var i=r.memoizedState;if(i===null&&(r=r.alternate,r!==null&&(i=r.memoizedState)),i!==null)return i.dehydrated}return null}function ht(r){if(we(r)!==r)throw Error(t(188))}function Tn(r){var i=r.alternate;if(!i){if(i=we(r),i===null)throw Error(t(188));return i!==r?null:r}for(var o=r,h=i;;){var p=o.return;if(p===null)break;var y=p.alternate;if(y===null){if(h=p.return,h!==null){o=h;continue}break}if(p.child===y.child){for(y=p.child;y;){if(y===o)return ht(p),r;if(y===h)return ht(p),i;y=y.sibling}throw Error(t(188))}if(o.return!==h.return)o=p,h=y;else{for(var x=!1,A=p.child;A;){if(A===o){x=!0,o=p,h=y;break}if(A===h){x=!0,h=p,o=y;break}A=A.sibling}if(!x){for(A=y.child;A;){if(A===o){x=!0,o=y,h=p;break}if(A===h){x=!0,h=y,o=p;break}A=A.sibling}if(!x)throw Error(t(189))}}if(o.alternate!==h)throw Error(t(190))}if(o.tag!==3)throw Error(t(188));return o.stateNode.current===o?r:i}function Ln(r){return r=Tn(r),r!==null?ls(r):null}function ls(r){if(r.tag===5||r.tag===6)return r;for(r=r.child;r!==null;){var i=ls(r);if(i!==null)return i;r=r.sibling}return null}var zr=e.unstable_scheduleCallback,js=e.unstable_cancelCallback,Ds=e.unstable_shouldYield,yt=e.unstable_requestPaint,ft=e.unstable_now,pr=e.unstable_getCurrentPriorityLevel,cs=e.unstable_ImmediatePriority,Br=e.unstable_UserBlockingPriority,Gn=e.unstable_NormalPriority,Gi=e.unstable_LowPriority,Sr=e.unstable_IdlePriority,us=null,Kn=null;function Pa(r){if(Kn&&typeof Kn.onCommitFiberRoot=="function")try{Kn.onCommitFiberRoot(us,r,void 0,(r.current.flags&128)===128)}catch{}}var Sn=Math.clz32?Math.clz32:W,I=Math.log,U=Math.LN2;function W(r){return r>>>=0,r===0?32:31-(I(r)/U|0)|0}var fe=64,Ee=4194304;function Oe(r){switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return r&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return r}}function Te(r,i){var o=r.pendingLanes;if(o===0)return 0;var h=0,p=r.suspendedLanes,y=r.pingedLanes,x=o&268435455;if(x!==0){var A=x&~p;A!==0?h=Oe(A):(y&=x,y!==0&&(h=Oe(y)))}else x=o&~p,x!==0?h=Oe(x):y!==0&&(h=Oe(y));if(h===0)return 0;if(i!==0&&i!==h&&(i&p)===0&&(p=h&-h,y=i&-i,p>=y||p===16&&(y&4194240)!==0))return i;if((h&4)!==0&&(h|=o&16),i=r.entangledLanes,i!==0)for(r=r.entanglements,i&=h;0<i;)o=31-Sn(i),p=1<<o,h|=r[o],i&=~p;return h}function rt(r,i){switch(r){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wt(r,i){for(var o=r.suspendedLanes,h=r.pingedLanes,p=r.expirationTimes,y=r.pendingLanes;0<y;){var x=31-Sn(y),A=1<<x,O=p[x];O===-1?((A&o)===0||(A&h)!==0)&&(p[x]=rt(A,i)):O<=i&&(r.expiredLanes|=A),y&=~A}}function ot(r){return r=r.pendingLanes&-1073741825,r!==0?r:r&1073741824?1073741824:0}function $t(){var r=fe;return fe<<=1,(fe&4194240)===0&&(fe=64),r}function Dt(r){for(var i=[],o=0;31>o;o++)i.push(r);return i}function dn(r,i,o){r.pendingLanes|=i,i!==536870912&&(r.suspendedLanes=0,r.pingedLanes=0),r=r.eventTimes,i=31-Sn(i),r[i]=o}function et(r,i){var o=r.pendingLanes&~i;r.pendingLanes=i,r.suspendedLanes=0,r.pingedLanes=0,r.expiredLanes&=i,r.mutableReadLanes&=i,r.entangledLanes&=i,i=r.entanglements;var h=r.eventTimes;for(r=r.expirationTimes;0<o;){var p=31-Sn(o),y=1<<p;i[p]=0,h[p]=-1,r[p]=-1,o&=~y}}function it(r,i){var o=r.entangledLanes|=i;for(r=r.entanglements;o;){var h=31-Sn(o),p=1<<h;p&i|r[h]&i&&(r[h]|=i),o&=~p}}var tt=0;function Yt(r){return r&=-r,1<r?4<r?(r&268435455)!==0?16:536870912:4:1}var Ir,ds,ba,Ra,Aa,$r=!1,Cr=[],In=null,Wr=null,qr=null,si=new Map,Pr=new Map,hs=[],pd="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function nc(r,i){switch(r){case"focusin":case"focusout":In=null;break;case"dragenter":case"dragleave":Wr=null;break;case"mouseover":case"mouseout":qr=null;break;case"pointerover":case"pointerout":si.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pr.delete(i.pointerId)}}function nr(r,i,o,h,p,y){return r===null||r.nativeEvent!==y?(r={blockedOn:i,domEventName:o,eventSystemFlags:h,nativeEvent:y,targetContainers:[p]},i!==null&&(i=Yo(i),i!==null&&ds(i)),r):(r.eventSystemFlags|=h,i=r.targetContainers,p!==null&&i.indexOf(p)===-1&&i.push(p),r)}function md(r,i,o,h,p){switch(i){case"focusin":return In=nr(In,r,i,o,h,p),!0;case"dragenter":return Wr=nr(Wr,r,i,o,h,p),!0;case"mouseover":return qr=nr(qr,r,i,o,h,p),!0;case"pointerover":var y=p.pointerId;return si.set(y,nr(si.get(y)||null,r,i,o,h,p)),!0;case"gotpointercapture":return y=p.pointerId,Pr.set(y,nr(Pr.get(y)||null,r,i,o,h,p)),!0}return!1}function rc(r){var i=Xi(r.target);if(i!==null){var o=we(i);if(o!==null){if(i=o.tag,i===13){if(i=Ke(o),i!==null){r.blockedOn=i,Aa(r.priority,function(){ba(o)});return}}else if(i===3&&o.stateNode.current.memoizedState.isDehydrated){r.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Vs(r){if(r.blockedOn!==null)return!1;for(var i=r.targetContainers;0<i.length;){var o=Na(r.domEventName,r.eventSystemFlags,i[0],r.nativeEvent);if(o===null){o=r.nativeEvent;var h=new o.constructor(o.type,o);Ur=h,o.target.dispatchEvent(h),Ur=null}else return i=Yo(o),i!==null&&ds(i),r.blockedOn=o,!1;i.shift()}return!0}function Ki(r,i,o){Vs(r)&&o.delete(i)}function sc(){$r=!1,In!==null&&Vs(In)&&(In=null),Wr!==null&&Vs(Wr)&&(Wr=null),qr!==null&&Vs(qr)&&(qr=null),si.forEach(Ki),Pr.forEach(Ki)}function Hr(r,i){r.blockedOn===i&&(r.blockedOn=null,$r||($r=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,sc)))}function Gr(r){function i(p){return Hr(p,r)}if(0<Cr.length){Hr(Cr[0],r);for(var o=1;o<Cr.length;o++){var h=Cr[o];h.blockedOn===r&&(h.blockedOn=null)}}for(In!==null&&Hr(In,r),Wr!==null&&Hr(Wr,r),qr!==null&&Hr(qr,r),si.forEach(i),Pr.forEach(i),o=0;o<hs.length;o++)h=hs[o],h.blockedOn===r&&(h.blockedOn=null);for(;0<hs.length&&(o=hs[0],o.blockedOn===null);)rc(o),o.blockedOn===null&&hs.shift()}var Ls=le.ReactCurrentBatchConfig,ii=!0;function Ut(r,i,o,h){var p=tt,y=Ls.transition;Ls.transition=null;try{tt=1,Lo(r,i,o,h)}finally{tt=p,Ls.transition=y}}function gd(r,i,o,h){var p=tt,y=Ls.transition;Ls.transition=null;try{tt=4,Lo(r,i,o,h)}finally{tt=p,Ls.transition=y}}function Lo(r,i,o,h){if(ii){var p=Na(r,i,o,h);if(p===null)Pd(r,i,h,Qi,o),nc(r,h);else if(md(p,r,i,o,h))h.stopPropagation();else if(nc(r,h),i&4&&-1<pd.indexOf(r)){for(;p!==null;){var y=Yo(p);if(y!==null&&Ir(y),y=Na(r,i,o,h),y===null&&Pd(r,i,h,Qi,o),y===p)break;p=y}p!==null&&h.stopPropagation()}else Pd(r,i,h,null,o)}}var Qi=null;function Na(r,i,o,h){if(Qi=null,r=Et(h),r=Xi(r),r!==null)if(i=we(r),i===null)r=null;else if(o=i.tag,o===13){if(r=Ke(i),r!==null)return r;r=null}else if(o===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;r=null}else i!==r&&(r=null);return Qi=r,null}function Oo(r){switch(r){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(pr()){case cs:return 1;case Br:return 4;case Gn:case Gi:return 16;case Sr:return 536870912;default:return 16}default:return 16}}var mr=null,ka=null,rr=null;function Mo(){if(rr)return rr;var r,i=ka,o=i.length,h,p="value"in mr?mr.value:mr.textContent,y=p.length;for(r=0;r<o&&i[r]===p[r];r++);var x=o-r;for(h=1;h<=x&&i[o-h]===p[y-h];h++);return rr=p.slice(r,1<h?1-h:void 0)}function ja(r){var i=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&i===13&&(r=13)):r=i,r===10&&(r=13),32<=r||r===13?r:0}function fs(){return!0}function Fo(){return!1}function Cn(r){function i(o,h,p,y,x){this._reactName=o,this._targetInst=p,this.type=h,this.nativeEvent=y,this.target=x,this.currentTarget=null;for(var A in r)r.hasOwnProperty(A)&&(o=r[A],this[A]=o?o(y):y[A]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?fs:Fo,this.isPropagationStopped=Fo,this}return se(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=fs)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=fs)},persist:function(){},isPersistent:fs}),i}var Kr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Da=Cn(Kr),ps=se({},Kr,{view:0,detail:0}),yd=Cn(ps),Va,Os,ai,Yi=se({},ps,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ms,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==ai&&(ai&&r.type==="mousemove"?(Va=r.screenX-ai.screenX,Os=r.screenY-ai.screenY):Os=Va=0,ai=r),Va)},movementY:function(r){return"movementY"in r?r.movementY:Os}}),La=Cn(Yi),Uo=se({},Yi,{dataTransfer:0}),ic=Cn(Uo),Oa=se({},ps,{relatedTarget:0}),Ma=Cn(Oa),ac=se({},Kr,{animationName:0,elapsedTime:0,pseudoElement:0}),Ms=Cn(ac),oc=se({},Kr,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),lc=Cn(oc),cc=se({},Kr,{data:0}),zo=Cn(cc),Fa={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Qn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},uc={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function dc(r){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(r):(r=uc[r])?!!i[r]:!1}function ms(){return dc}var u=se({},ps,{key:function(r){if(r.key){var i=Fa[r.key]||r.key;if(i!=="Unidentified")return i}return r.type==="keypress"?(r=ja(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?Qn[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ms,charCode:function(r){return r.type==="keypress"?ja(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?ja(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),g=Cn(u),_=se({},Yi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),T=Cn(_),H=se({},ps,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ms}),te=Cn(H),_e=se({},Kr,{propertyName:0,elapsedTime:0,pseudoElement:0}),St=Cn(_e),hn=se({},Yi,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),pt=Cn(hn),yn=[9,13,27,32],an=f&&"CompositionEvent"in window,br=null;f&&"documentMode"in document&&(br=document.documentMode);var gr=f&&"TextEvent"in window&&!br,Ji=f&&(!an||br&&8<br&&11>=br),Ua=" ",Vp=!1;function Lp(r,i){switch(r){case"keyup":return yn.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Op(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var za=!1;function zw(r,i){switch(r){case"compositionend":return Op(i);case"keypress":return i.which!==32?null:(Vp=!0,Ua);case"textInput":return r=i.data,r===Ua&&Vp?null:r;default:return null}}function Bw(r,i){if(za)return r==="compositionend"||!an&&Lp(r,i)?(r=Mo(),rr=ka=mr=null,za=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return Ji&&i.locale!=="ko"?null:i.data;default:return null}}var $w={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Mp(r){var i=r&&r.nodeName&&r.nodeName.toLowerCase();return i==="input"?!!$w[r.type]:i==="textarea"}function Fp(r,i,o,h){Dn(h),i=gc(i,"onChange"),0<i.length&&(o=new Da("onChange","change",null,o,h),r.push({event:o,listeners:i}))}var Bo=null,$o=null;function Ww(r){rm(r,0)}function hc(r){var i=Ha(r);if(Ve(i))return r}function qw(r,i){if(r==="change")return i}var Up=!1;if(f){var vd;if(f){var _d="oninput"in document;if(!_d){var zp=document.createElement("div");zp.setAttribute("oninput","return;"),_d=typeof zp.oninput=="function"}vd=_d}else vd=!1;Up=vd&&(!document.documentMode||9<document.documentMode)}function Bp(){Bo&&(Bo.detachEvent("onpropertychange",$p),$o=Bo=null)}function $p(r){if(r.propertyName==="value"&&hc($o)){var i=[];Fp(i,$o,r,Et(r)),os(Ww,i)}}function Hw(r,i,o){r==="focusin"?(Bp(),Bo=i,$o=o,Bo.attachEvent("onpropertychange",$p)):r==="focusout"&&Bp()}function Gw(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return hc($o)}function Kw(r,i){if(r==="click")return hc(i)}function Qw(r,i){if(r==="input"||r==="change")return hc(i)}function Yw(r,i){return r===i&&(r!==0||1/r===1/i)||r!==r&&i!==i}var Qr=typeof Object.is=="function"?Object.is:Yw;function Wo(r,i){if(Qr(r,i))return!0;if(typeof r!="object"||r===null||typeof i!="object"||i===null)return!1;var o=Object.keys(r),h=Object.keys(i);if(o.length!==h.length)return!1;for(h=0;h<o.length;h++){var p=o[h];if(!m.call(i,p)||!Qr(r[p],i[p]))return!1}return!0}function Wp(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function qp(r,i){var o=Wp(r);r=0;for(var h;o;){if(o.nodeType===3){if(h=r+o.textContent.length,r<=i&&h>=i)return{node:o,offset:i-r};r=h}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=Wp(o)}}function Hp(r,i){return r&&i?r===i?!0:r&&r.nodeType===3?!1:i&&i.nodeType===3?Hp(r,i.parentNode):"contains"in r?r.contains(i):r.compareDocumentPosition?!!(r.compareDocumentPosition(i)&16):!1:!1}function Gp(){for(var r=window,i=$e();i instanceof r.HTMLIFrameElement;){try{var o=typeof i.contentWindow.location.href=="string"}catch{o=!1}if(o)r=i.contentWindow;else break;i=$e(r.document)}return i}function wd(r){var i=r&&r.nodeName&&r.nodeName.toLowerCase();return i&&(i==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||i==="textarea"||r.contentEditable==="true")}function Jw(r){var i=Gp(),o=r.focusedElem,h=r.selectionRange;if(i!==o&&o&&o.ownerDocument&&Hp(o.ownerDocument.documentElement,o)){if(h!==null&&wd(o)){if(i=h.start,r=h.end,r===void 0&&(r=i),"selectionStart"in o)o.selectionStart=i,o.selectionEnd=Math.min(r,o.value.length);else if(r=(i=o.ownerDocument||document)&&i.defaultView||window,r.getSelection){r=r.getSelection();var p=o.textContent.length,y=Math.min(h.start,p);h=h.end===void 0?y:Math.min(h.end,p),!r.extend&&y>h&&(p=h,h=y,y=p),p=qp(o,y);var x=qp(o,h);p&&x&&(r.rangeCount!==1||r.anchorNode!==p.node||r.anchorOffset!==p.offset||r.focusNode!==x.node||r.focusOffset!==x.offset)&&(i=i.createRange(),i.setStart(p.node,p.offset),r.removeAllRanges(),y>h?(r.addRange(i),r.extend(x.node,x.offset)):(i.setEnd(x.node,x.offset),r.addRange(i)))}}for(i=[],r=o;r=r.parentNode;)r.nodeType===1&&i.push({element:r,left:r.scrollLeft,top:r.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<i.length;o++)r=i[o],r.element.scrollLeft=r.left,r.element.scrollTop=r.top}}var Xw=f&&"documentMode"in document&&11>=document.documentMode,Ba=null,xd=null,qo=null,Ed=!1;function Kp(r,i,o){var h=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Ed||Ba==null||Ba!==$e(h)||(h=Ba,"selectionStart"in h&&wd(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),qo&&Wo(qo,h)||(qo=h,h=gc(xd,"onSelect"),0<h.length&&(i=new Da("onSelect","select",null,i,o),r.push({event:i,listeners:h}),i.target=Ba)))}function fc(r,i){var o={};return o[r.toLowerCase()]=i.toLowerCase(),o["Webkit"+r]="webkit"+i,o["Moz"+r]="moz"+i,o}var $a={animationend:fc("Animation","AnimationEnd"),animationiteration:fc("Animation","AnimationIteration"),animationstart:fc("Animation","AnimationStart"),transitionend:fc("Transition","TransitionEnd")},Td={},Qp={};f&&(Qp=document.createElement("div").style,"AnimationEvent"in window||(delete $a.animationend.animation,delete $a.animationiteration.animation,delete $a.animationstart.animation),"TransitionEvent"in window||delete $a.transitionend.transition);function pc(r){if(Td[r])return Td[r];if(!$a[r])return r;var i=$a[r],o;for(o in i)if(i.hasOwnProperty(o)&&o in Qp)return Td[r]=i[o];return r}var Yp=pc("animationend"),Jp=pc("animationiteration"),Xp=pc("animationstart"),Zp=pc("transitionend"),em=new Map,tm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function oi(r,i){em.set(r,i),l(i,[r])}for(var Sd=0;Sd<tm.length;Sd++){var Id=tm[Sd],Zw=Id.toLowerCase(),ex=Id[0].toUpperCase()+Id.slice(1);oi(Zw,"on"+ex)}oi(Yp,"onAnimationEnd"),oi(Jp,"onAnimationIteration"),oi(Xp,"onAnimationStart"),oi("dblclick","onDoubleClick"),oi("focusin","onFocus"),oi("focusout","onBlur"),oi(Zp,"onTransitionEnd"),d("onMouseEnter",["mouseout","mouseover"]),d("onMouseLeave",["mouseout","mouseover"]),d("onPointerEnter",["pointerout","pointerover"]),d("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ho="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),tx=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ho));function nm(r,i,o){var h=r.type||"unknown-event";r.currentTarget=o,Pt(h,i,void 0,r),r.currentTarget=null}function rm(r,i){i=(i&4)!==0;for(var o=0;o<r.length;o++){var h=r[o],p=h.event;h=h.listeners;e:{var y=void 0;if(i)for(var x=h.length-1;0<=x;x--){var A=h[x],O=A.instance,ee=A.currentTarget;if(A=A.listener,O!==y&&p.isPropagationStopped())break e;nm(p,A,ee),y=O}else for(x=0;x<h.length;x++){if(A=h[x],O=A.instance,ee=A.currentTarget,A=A.listener,O!==y&&p.isPropagationStopped())break e;nm(p,A,ee),y=O}}}if(B)throw r=K,B=!1,K=null,r}function Vt(r,i){var o=i[jd];o===void 0&&(o=i[jd]=new Set);var h=r+"__bubble";o.has(h)||(sm(i,r,2,!1),o.add(h))}function Cd(r,i,o){var h=0;i&&(h|=4),sm(o,r,h,i)}var mc="_reactListening"+Math.random().toString(36).slice(2);function Go(r){if(!r[mc]){r[mc]=!0,s.forEach(function(o){o!=="selectionchange"&&(tx.has(o)||Cd(o,!1,r),Cd(o,!0,r))});var i=r.nodeType===9?r:r.ownerDocument;i===null||i[mc]||(i[mc]=!0,Cd("selectionchange",!1,i))}}function sm(r,i,o,h){switch(Oo(i)){case 1:var p=Ut;break;case 4:p=gd;break;default:p=Lo}o=p.bind(null,i,o,r),p=void 0,!tr||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(p=!0),h?p!==void 0?r.addEventListener(i,o,{capture:!0,passive:p}):r.addEventListener(i,o,!0):p!==void 0?r.addEventListener(i,o,{passive:p}):r.addEventListener(i,o,!1)}function Pd(r,i,o,h,p){var y=h;if((i&1)===0&&(i&2)===0&&h!==null)e:for(;;){if(h===null)return;var x=h.tag;if(x===3||x===4){var A=h.stateNode.containerInfo;if(A===p||A.nodeType===8&&A.parentNode===p)break;if(x===4)for(x=h.return;x!==null;){var O=x.tag;if((O===3||O===4)&&(O=x.stateNode.containerInfo,O===p||O.nodeType===8&&O.parentNode===p))return;x=x.return}for(;A!==null;){if(x=Xi(A),x===null)return;if(O=x.tag,O===5||O===6){h=y=x;continue e}A=A.parentNode}}h=h.return}os(function(){var ee=y,he=Et(o),pe=[];e:{var de=em.get(r);if(de!==void 0){var Ce=Da,Re=r;switch(r){case"keypress":if(ja(o)===0)break e;case"keydown":case"keyup":Ce=g;break;case"focusin":Re="focus",Ce=Ma;break;case"focusout":Re="blur",Ce=Ma;break;case"beforeblur":case"afterblur":Ce=Ma;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ce=La;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ce=ic;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ce=te;break;case Yp:case Jp:case Xp:Ce=Ms;break;case Zp:Ce=St;break;case"scroll":Ce=yd;break;case"wheel":Ce=pt;break;case"copy":case"cut":case"paste":Ce=lc;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ce=T}var ke=(i&4)!==0,Jt=!ke&&r==="scroll",G=ke?de!==null?de+"Capture":null:de;ke=[];for(var z=ee,Q;z!==null;){Q=z;var ve=Q.stateNode;if(Q.tag===5&&ve!==null&&(Q=ve,G!==null&&(ve=_t(z,G),ve!=null&&ke.push(Ko(z,ve,Q)))),Jt)break;z=z.return}0<ke.length&&(de=new Ce(de,Re,null,o,he),pe.push({event:de,listeners:ke}))}}if((i&7)===0){e:{if(de=r==="mouseover"||r==="pointerover",Ce=r==="mouseout"||r==="pointerout",de&&o!==Ur&&(Re=o.relatedTarget||o.fromElement)&&(Xi(Re)||Re[Fs]))break e;if((Ce||de)&&(de=he.window===he?he:(de=he.ownerDocument)?de.defaultView||de.parentWindow:window,Ce?(Re=o.relatedTarget||o.toElement,Ce=ee,Re=Re?Xi(Re):null,Re!==null&&(Jt=we(Re),Re!==Jt||Re.tag!==5&&Re.tag!==6)&&(Re=null)):(Ce=null,Re=ee),Ce!==Re)){if(ke=La,ve="onMouseLeave",G="onMouseEnter",z="mouse",(r==="pointerout"||r==="pointerover")&&(ke=T,ve="onPointerLeave",G="onPointerEnter",z="pointer"),Jt=Ce==null?de:Ha(Ce),Q=Re==null?de:Ha(Re),de=new ke(ve,z+"leave",Ce,o,he),de.target=Jt,de.relatedTarget=Q,ve=null,Xi(he)===ee&&(ke=new ke(G,z+"enter",Re,o,he),ke.target=Q,ke.relatedTarget=Jt,ve=ke),Jt=ve,Ce&&Re)t:{for(ke=Ce,G=Re,z=0,Q=ke;Q;Q=Wa(Q))z++;for(Q=0,ve=G;ve;ve=Wa(ve))Q++;for(;0<z-Q;)ke=Wa(ke),z--;for(;0<Q-z;)G=Wa(G),Q--;for(;z--;){if(ke===G||G!==null&&ke===G.alternate)break t;ke=Wa(ke),G=Wa(G)}ke=null}else ke=null;Ce!==null&&im(pe,de,Ce,ke,!1),Re!==null&&Jt!==null&&im(pe,Jt,Re,ke,!0)}}e:{if(de=ee?Ha(ee):window,Ce=de.nodeName&&de.nodeName.toLowerCase(),Ce==="select"||Ce==="input"&&de.type==="file")var De=qw;else if(Mp(de))if(Up)De=Qw;else{De=Gw;var ze=Hw}else(Ce=de.nodeName)&&Ce.toLowerCase()==="input"&&(de.type==="checkbox"||de.type==="radio")&&(De=Kw);if(De&&(De=De(r,ee))){Fp(pe,De,o,he);break e}ze&&ze(r,de,ee),r==="focusout"&&(ze=de._wrapperState)&&ze.controlled&&de.type==="number"&&Gt(de,"number",de.value)}switch(ze=ee?Ha(ee):window,r){case"focusin":(Mp(ze)||ze.contentEditable==="true")&&(Ba=ze,xd=ee,qo=null);break;case"focusout":qo=xd=Ba=null;break;case"mousedown":Ed=!0;break;case"contextmenu":case"mouseup":case"dragend":Ed=!1,Kp(pe,o,he);break;case"selectionchange":if(Xw)break;case"keydown":case"keyup":Kp(pe,o,he)}var Be;if(an)e:{switch(r){case"compositionstart":var Ge="onCompositionStart";break e;case"compositionend":Ge="onCompositionEnd";break e;case"compositionupdate":Ge="onCompositionUpdate";break e}Ge=void 0}else za?Lp(r,o)&&(Ge="onCompositionEnd"):r==="keydown"&&o.keyCode===229&&(Ge="onCompositionStart");Ge&&(Ji&&o.locale!=="ko"&&(za||Ge!=="onCompositionStart"?Ge==="onCompositionEnd"&&za&&(Be=Mo()):(mr=he,ka="value"in mr?mr.value:mr.textContent,za=!0)),ze=gc(ee,Ge),0<ze.length&&(Ge=new zo(Ge,r,null,o,he),pe.push({event:Ge,listeners:ze}),Be?Ge.data=Be:(Be=Op(o),Be!==null&&(Ge.data=Be)))),(Be=gr?zw(r,o):Bw(r,o))&&(ee=gc(ee,"onBeforeInput"),0<ee.length&&(he=new zo("onBeforeInput","beforeinput",null,o,he),pe.push({event:he,listeners:ee}),he.data=Be))}rm(pe,i)})}function Ko(r,i,o){return{instance:r,listener:i,currentTarget:o}}function gc(r,i){for(var o=i+"Capture",h=[];r!==null;){var p=r,y=p.stateNode;p.tag===5&&y!==null&&(p=y,y=_t(r,o),y!=null&&h.unshift(Ko(r,y,p)),y=_t(r,i),y!=null&&h.push(Ko(r,y,p))),r=r.return}return h}function Wa(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5);return r||null}function im(r,i,o,h,p){for(var y=i._reactName,x=[];o!==null&&o!==h;){var A=o,O=A.alternate,ee=A.stateNode;if(O!==null&&O===h)break;A.tag===5&&ee!==null&&(A=ee,p?(O=_t(o,y),O!=null&&x.unshift(Ko(o,O,A))):p||(O=_t(o,y),O!=null&&x.push(Ko(o,O,A)))),o=o.return}x.length!==0&&r.push({event:i,listeners:x})}var nx=/\r\n?/g,rx=/\u0000|\uFFFD/g;function am(r){return(typeof r=="string"?r:""+r).replace(nx,`
`).replace(rx,"")}function yc(r,i,o){if(i=am(i),am(r)!==i&&o)throw Error(t(425))}function vc(){}var bd=null,Rd=null;function Ad(r,i){return r==="textarea"||r==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Nd=typeof setTimeout=="function"?setTimeout:void 0,sx=typeof clearTimeout=="function"?clearTimeout:void 0,om=typeof Promise=="function"?Promise:void 0,ix=typeof queueMicrotask=="function"?queueMicrotask:typeof om<"u"?function(r){return om.resolve(null).then(r).catch(ax)}:Nd;function ax(r){setTimeout(function(){throw r})}function kd(r,i){var o=i,h=0;do{var p=o.nextSibling;if(r.removeChild(o),p&&p.nodeType===8)if(o=p.data,o==="/$"){if(h===0){r.removeChild(p),Gr(i);return}h--}else o!=="$"&&o!=="$?"&&o!=="$!"||h++;o=p}while(o);Gr(i)}function li(r){for(;r!=null;r=r.nextSibling){var i=r.nodeType;if(i===1||i===3)break;if(i===8){if(i=r.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return r}function lm(r){r=r.previousSibling;for(var i=0;r;){if(r.nodeType===8){var o=r.data;if(o==="$"||o==="$!"||o==="$?"){if(i===0)return r;i--}else o==="/$"&&i++}r=r.previousSibling}return null}var qa=Math.random().toString(36).slice(2),gs="__reactFiber$"+qa,Qo="__reactProps$"+qa,Fs="__reactContainer$"+qa,jd="__reactEvents$"+qa,ox="__reactListeners$"+qa,lx="__reactHandles$"+qa;function Xi(r){var i=r[gs];if(i)return i;for(var o=r.parentNode;o;){if(i=o[Fs]||o[gs]){if(o=i.alternate,i.child!==null||o!==null&&o.child!==null)for(r=lm(r);r!==null;){if(o=r[gs])return o;r=lm(r)}return i}r=o,o=r.parentNode}return null}function Yo(r){return r=r[gs]||r[Fs],!r||r.tag!==5&&r.tag!==6&&r.tag!==13&&r.tag!==3?null:r}function Ha(r){if(r.tag===5||r.tag===6)return r.stateNode;throw Error(t(33))}function _c(r){return r[Qo]||null}var Dd=[],Ga=-1;function ci(r){return{current:r}}function Lt(r){0>Ga||(r.current=Dd[Ga],Dd[Ga]=null,Ga--)}function Nt(r,i){Ga++,Dd[Ga]=r.current,r.current=i}var ui={},On=ci(ui),sr=ci(!1),Zi=ui;function Ka(r,i){var o=r.type.contextTypes;if(!o)return ui;var h=r.stateNode;if(h&&h.__reactInternalMemoizedUnmaskedChildContext===i)return h.__reactInternalMemoizedMaskedChildContext;var p={},y;for(y in o)p[y]=i[y];return h&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=i,r.__reactInternalMemoizedMaskedChildContext=p),p}function ir(r){return r=r.childContextTypes,r!=null}function wc(){Lt(sr),Lt(On)}function cm(r,i,o){if(On.current!==ui)throw Error(t(168));Nt(On,i),Nt(sr,o)}function um(r,i,o){var h=r.stateNode;if(i=i.childContextTypes,typeof h.getChildContext!="function")return o;h=h.getChildContext();for(var p in h)if(!(p in i))throw Error(t(108,Ze(r)||"Unknown",p));return se({},o,h)}function xc(r){return r=(r=r.stateNode)&&r.__reactInternalMemoizedMergedChildContext||ui,Zi=On.current,Nt(On,r),Nt(sr,sr.current),!0}function dm(r,i,o){var h=r.stateNode;if(!h)throw Error(t(169));o?(r=um(r,i,Zi),h.__reactInternalMemoizedMergedChildContext=r,Lt(sr),Lt(On),Nt(On,r)):Lt(sr),Nt(sr,o)}var Us=null,Ec=!1,Vd=!1;function hm(r){Us===null?Us=[r]:Us.push(r)}function cx(r){Ec=!0,hm(r)}function di(){if(!Vd&&Us!==null){Vd=!0;var r=0,i=tt;try{var o=Us;for(tt=1;r<o.length;r++){var h=o[r];do h=h(!0);while(h!==null)}Us=null,Ec=!1}catch(p){throw Us!==null&&(Us=Us.slice(r+1)),zr(cs,di),p}finally{tt=i,Vd=!1}}return null}var Qa=[],Ya=0,Tc=null,Sc=0,Rr=[],Ar=0,ea=null,zs=1,Bs="";function ta(r,i){Qa[Ya++]=Sc,Qa[Ya++]=Tc,Tc=r,Sc=i}function fm(r,i,o){Rr[Ar++]=zs,Rr[Ar++]=Bs,Rr[Ar++]=ea,ea=r;var h=zs;r=Bs;var p=32-Sn(h)-1;h&=~(1<<p),o+=1;var y=32-Sn(i)+p;if(30<y){var x=p-p%5;y=(h&(1<<x)-1).toString(32),h>>=x,p-=x,zs=1<<32-Sn(i)+p|o<<p|h,Bs=y+r}else zs=1<<y|o<<p|h,Bs=r}function Ld(r){r.return!==null&&(ta(r,1),fm(r,1,0))}function Od(r){for(;r===Tc;)Tc=Qa[--Ya],Qa[Ya]=null,Sc=Qa[--Ya],Qa[Ya]=null;for(;r===ea;)ea=Rr[--Ar],Rr[Ar]=null,Bs=Rr[--Ar],Rr[Ar]=null,zs=Rr[--Ar],Rr[Ar]=null}var yr=null,vr=null,zt=!1,Yr=null;function pm(r,i){var o=Dr(5,null,null,0);o.elementType="DELETED",o.stateNode=i,o.return=r,i=r.deletions,i===null?(r.deletions=[o],r.flags|=16):i.push(o)}function mm(r,i){switch(r.tag){case 5:var o=r.type;return i=i.nodeType!==1||o.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(r.stateNode=i,yr=r,vr=li(i.firstChild),!0):!1;case 6:return i=r.pendingProps===""||i.nodeType!==3?null:i,i!==null?(r.stateNode=i,yr=r,vr=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(o=ea!==null?{id:zs,overflow:Bs}:null,r.memoizedState={dehydrated:i,treeContext:o,retryLane:1073741824},o=Dr(18,null,null,0),o.stateNode=i,o.return=r,r.child=o,yr=r,vr=null,!0):!1;default:return!1}}function Md(r){return(r.mode&1)!==0&&(r.flags&128)===0}function Fd(r){if(zt){var i=vr;if(i){var o=i;if(!mm(r,i)){if(Md(r))throw Error(t(418));i=li(o.nextSibling);var h=yr;i&&mm(r,i)?pm(h,o):(r.flags=r.flags&-4097|2,zt=!1,yr=r)}}else{if(Md(r))throw Error(t(418));r.flags=r.flags&-4097|2,zt=!1,yr=r}}}function gm(r){for(r=r.return;r!==null&&r.tag!==5&&r.tag!==3&&r.tag!==13;)r=r.return;yr=r}function Ic(r){if(r!==yr)return!1;if(!zt)return gm(r),zt=!0,!1;var i;if((i=r.tag!==3)&&!(i=r.tag!==5)&&(i=r.type,i=i!=="head"&&i!=="body"&&!Ad(r.type,r.memoizedProps)),i&&(i=vr)){if(Md(r))throw ym(),Error(t(418));for(;i;)pm(r,i),i=li(i.nextSibling)}if(gm(r),r.tag===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(t(317));e:{for(r=r.nextSibling,i=0;r;){if(r.nodeType===8){var o=r.data;if(o==="/$"){if(i===0){vr=li(r.nextSibling);break e}i--}else o!=="$"&&o!=="$!"&&o!=="$?"||i++}r=r.nextSibling}vr=null}}else vr=yr?li(r.stateNode.nextSibling):null;return!0}function ym(){for(var r=vr;r;)r=li(r.nextSibling)}function Ja(){vr=yr=null,zt=!1}function Ud(r){Yr===null?Yr=[r]:Yr.push(r)}var ux=le.ReactCurrentBatchConfig;function Jo(r,i,o){if(r=o.ref,r!==null&&typeof r!="function"&&typeof r!="object"){if(o._owner){if(o=o._owner,o){if(o.tag!==1)throw Error(t(309));var h=o.stateNode}if(!h)throw Error(t(147,r));var p=h,y=""+r;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===y?i.ref:(i=function(x){var A=p.refs;x===null?delete A[y]:A[y]=x},i._stringRef=y,i)}if(typeof r!="string")throw Error(t(284));if(!o._owner)throw Error(t(290,r))}return r}function Cc(r,i){throw r=Object.prototype.toString.call(i),Error(t(31,r==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":r))}function vm(r){var i=r._init;return i(r._payload)}function _m(r){function i(G,z){if(r){var Q=G.deletions;Q===null?(G.deletions=[z],G.flags|=16):Q.push(z)}}function o(G,z){if(!r)return null;for(;z!==null;)i(G,z),z=z.sibling;return null}function h(G,z){for(G=new Map;z!==null;)z.key!==null?G.set(z.key,z):G.set(z.index,z),z=z.sibling;return G}function p(G,z){return G=_i(G,z),G.index=0,G.sibling=null,G}function y(G,z,Q){return G.index=Q,r?(Q=G.alternate,Q!==null?(Q=Q.index,Q<z?(G.flags|=2,z):Q):(G.flags|=2,z)):(G.flags|=1048576,z)}function x(G){return r&&G.alternate===null&&(G.flags|=2),G}function A(G,z,Q,ve){return z===null||z.tag!==6?(z=Nh(Q,G.mode,ve),z.return=G,z):(z=p(z,Q),z.return=G,z)}function O(G,z,Q,ve){var De=Q.type;return De===N?he(G,z,Q.props.children,ve,Q.key):z!==null&&(z.elementType===De||typeof De=="object"&&De!==null&&De.$$typeof===dt&&vm(De)===z.type)?(ve=p(z,Q.props),ve.ref=Jo(G,z,Q),ve.return=G,ve):(ve=Yc(Q.type,Q.key,Q.props,null,G.mode,ve),ve.ref=Jo(G,z,Q),ve.return=G,ve)}function ee(G,z,Q,ve){return z===null||z.tag!==4||z.stateNode.containerInfo!==Q.containerInfo||z.stateNode.implementation!==Q.implementation?(z=kh(Q,G.mode,ve),z.return=G,z):(z=p(z,Q.children||[]),z.return=G,z)}function he(G,z,Q,ve,De){return z===null||z.tag!==7?(z=ca(Q,G.mode,ve,De),z.return=G,z):(z=p(z,Q),z.return=G,z)}function pe(G,z,Q){if(typeof z=="string"&&z!==""||typeof z=="number")return z=Nh(""+z,G.mode,Q),z.return=G,z;if(typeof z=="object"&&z!==null){switch(z.$$typeof){case xe:return Q=Yc(z.type,z.key,z.props,null,G.mode,Q),Q.ref=Jo(G,null,z),Q.return=G,Q;case Se:return z=kh(z,G.mode,Q),z.return=G,z;case dt:var ve=z._init;return pe(G,ve(z._payload),Q)}if(tn(z)||ne(z))return z=ca(z,G.mode,Q,null),z.return=G,z;Cc(G,z)}return null}function de(G,z,Q,ve){var De=z!==null?z.key:null;if(typeof Q=="string"&&Q!==""||typeof Q=="number")return De!==null?null:A(G,z,""+Q,ve);if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case xe:return Q.key===De?O(G,z,Q,ve):null;case Se:return Q.key===De?ee(G,z,Q,ve):null;case dt:return De=Q._init,de(G,z,De(Q._payload),ve)}if(tn(Q)||ne(Q))return De!==null?null:he(G,z,Q,ve,null);Cc(G,Q)}return null}function Ce(G,z,Q,ve,De){if(typeof ve=="string"&&ve!==""||typeof ve=="number")return G=G.get(Q)||null,A(z,G,""+ve,De);if(typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case xe:return G=G.get(ve.key===null?Q:ve.key)||null,O(z,G,ve,De);case Se:return G=G.get(ve.key===null?Q:ve.key)||null,ee(z,G,ve,De);case dt:var ze=ve._init;return Ce(G,z,Q,ze(ve._payload),De)}if(tn(ve)||ne(ve))return G=G.get(Q)||null,he(z,G,ve,De,null);Cc(z,ve)}return null}function Re(G,z,Q,ve){for(var De=null,ze=null,Be=z,Ge=z=0,wn=null;Be!==null&&Ge<Q.length;Ge++){Be.index>Ge?(wn=Be,Be=null):wn=Be.sibling;var vt=de(G,Be,Q[Ge],ve);if(vt===null){Be===null&&(Be=wn);break}r&&Be&&vt.alternate===null&&i(G,Be),z=y(vt,z,Ge),ze===null?De=vt:ze.sibling=vt,ze=vt,Be=wn}if(Ge===Q.length)return o(G,Be),zt&&ta(G,Ge),De;if(Be===null){for(;Ge<Q.length;Ge++)Be=pe(G,Q[Ge],ve),Be!==null&&(z=y(Be,z,Ge),ze===null?De=Be:ze.sibling=Be,ze=Be);return zt&&ta(G,Ge),De}for(Be=h(G,Be);Ge<Q.length;Ge++)wn=Ce(Be,G,Ge,Q[Ge],ve),wn!==null&&(r&&wn.alternate!==null&&Be.delete(wn.key===null?Ge:wn.key),z=y(wn,z,Ge),ze===null?De=wn:ze.sibling=wn,ze=wn);return r&&Be.forEach(function(wi){return i(G,wi)}),zt&&ta(G,Ge),De}function ke(G,z,Q,ve){var De=ne(Q);if(typeof De!="function")throw Error(t(150));if(Q=De.call(Q),Q==null)throw Error(t(151));for(var ze=De=null,Be=z,Ge=z=0,wn=null,vt=Q.next();Be!==null&&!vt.done;Ge++,vt=Q.next()){Be.index>Ge?(wn=Be,Be=null):wn=Be.sibling;var wi=de(G,Be,vt.value,ve);if(wi===null){Be===null&&(Be=wn);break}r&&Be&&wi.alternate===null&&i(G,Be),z=y(wi,z,Ge),ze===null?De=wi:ze.sibling=wi,ze=wi,Be=wn}if(vt.done)return o(G,Be),zt&&ta(G,Ge),De;if(Be===null){for(;!vt.done;Ge++,vt=Q.next())vt=pe(G,vt.value,ve),vt!==null&&(z=y(vt,z,Ge),ze===null?De=vt:ze.sibling=vt,ze=vt);return zt&&ta(G,Ge),De}for(Be=h(G,Be);!vt.done;Ge++,vt=Q.next())vt=Ce(Be,G,Ge,vt.value,ve),vt!==null&&(r&&vt.alternate!==null&&Be.delete(vt.key===null?Ge:vt.key),z=y(vt,z,Ge),ze===null?De=vt:ze.sibling=vt,ze=vt);return r&&Be.forEach(function($x){return i(G,$x)}),zt&&ta(G,Ge),De}function Jt(G,z,Q,ve){if(typeof Q=="object"&&Q!==null&&Q.type===N&&Q.key===null&&(Q=Q.props.children),typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case xe:e:{for(var De=Q.key,ze=z;ze!==null;){if(ze.key===De){if(De=Q.type,De===N){if(ze.tag===7){o(G,ze.sibling),z=p(ze,Q.props.children),z.return=G,G=z;break e}}else if(ze.elementType===De||typeof De=="object"&&De!==null&&De.$$typeof===dt&&vm(De)===ze.type){o(G,ze.sibling),z=p(ze,Q.props),z.ref=Jo(G,ze,Q),z.return=G,G=z;break e}o(G,ze);break}else i(G,ze);ze=ze.sibling}Q.type===N?(z=ca(Q.props.children,G.mode,ve,Q.key),z.return=G,G=z):(ve=Yc(Q.type,Q.key,Q.props,null,G.mode,ve),ve.ref=Jo(G,z,Q),ve.return=G,G=ve)}return x(G);case Se:e:{for(ze=Q.key;z!==null;){if(z.key===ze)if(z.tag===4&&z.stateNode.containerInfo===Q.containerInfo&&z.stateNode.implementation===Q.implementation){o(G,z.sibling),z=p(z,Q.children||[]),z.return=G,G=z;break e}else{o(G,z);break}else i(G,z);z=z.sibling}z=kh(Q,G.mode,ve),z.return=G,G=z}return x(G);case dt:return ze=Q._init,Jt(G,z,ze(Q._payload),ve)}if(tn(Q))return Re(G,z,Q,ve);if(ne(Q))return ke(G,z,Q,ve);Cc(G,Q)}return typeof Q=="string"&&Q!==""||typeof Q=="number"?(Q=""+Q,z!==null&&z.tag===6?(o(G,z.sibling),z=p(z,Q),z.return=G,G=z):(o(G,z),z=Nh(Q,G.mode,ve),z.return=G,G=z),x(G)):o(G,z)}return Jt}var Xa=_m(!0),wm=_m(!1),Pc=ci(null),bc=null,Za=null,zd=null;function Bd(){zd=Za=bc=null}function $d(r){var i=Pc.current;Lt(Pc),r._currentValue=i}function Wd(r,i,o){for(;r!==null;){var h=r.alternate;if((r.childLanes&i)!==i?(r.childLanes|=i,h!==null&&(h.childLanes|=i)):h!==null&&(h.childLanes&i)!==i&&(h.childLanes|=i),r===o)break;r=r.return}}function eo(r,i){bc=r,zd=Za=null,r=r.dependencies,r!==null&&r.firstContext!==null&&((r.lanes&i)!==0&&(ar=!0),r.firstContext=null)}function Nr(r){var i=r._currentValue;if(zd!==r)if(r={context:r,memoizedValue:i,next:null},Za===null){if(bc===null)throw Error(t(308));Za=r,bc.dependencies={lanes:0,firstContext:r}}else Za=Za.next=r;return i}var na=null;function qd(r){na===null?na=[r]:na.push(r)}function xm(r,i,o,h){var p=i.interleaved;return p===null?(o.next=o,qd(i)):(o.next=p.next,p.next=o),i.interleaved=o,$s(r,h)}function $s(r,i){r.lanes|=i;var o=r.alternate;for(o!==null&&(o.lanes|=i),o=r,r=r.return;r!==null;)r.childLanes|=i,o=r.alternate,o!==null&&(o.childLanes|=i),o=r,r=r.return;return o.tag===3?o.stateNode:null}var hi=!1;function Hd(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Em(r,i){r=r.updateQueue,i.updateQueue===r&&(i.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,effects:r.effects})}function Ws(r,i){return{eventTime:r,lane:i,tag:0,payload:null,callback:null,next:null}}function fi(r,i,o){var h=r.updateQueue;if(h===null)return null;if(h=h.shared,(gt&2)!==0){var p=h.pending;return p===null?i.next=i:(i.next=p.next,p.next=i),h.pending=i,$s(r,o)}return p=h.interleaved,p===null?(i.next=i,qd(h)):(i.next=p.next,p.next=i),h.interleaved=i,$s(r,o)}function Rc(r,i,o){if(i=i.updateQueue,i!==null&&(i=i.shared,(o&4194240)!==0)){var h=i.lanes;h&=r.pendingLanes,o|=h,i.lanes=o,it(r,o)}}function Tm(r,i){var o=r.updateQueue,h=r.alternate;if(h!==null&&(h=h.updateQueue,o===h)){var p=null,y=null;if(o=o.firstBaseUpdate,o!==null){do{var x={eventTime:o.eventTime,lane:o.lane,tag:o.tag,payload:o.payload,callback:o.callback,next:null};y===null?p=y=x:y=y.next=x,o=o.next}while(o!==null);y===null?p=y=i:y=y.next=i}else p=y=i;o={baseState:h.baseState,firstBaseUpdate:p,lastBaseUpdate:y,shared:h.shared,effects:h.effects},r.updateQueue=o;return}r=o.lastBaseUpdate,r===null?o.firstBaseUpdate=i:r.next=i,o.lastBaseUpdate=i}function Ac(r,i,o,h){var p=r.updateQueue;hi=!1;var y=p.firstBaseUpdate,x=p.lastBaseUpdate,A=p.shared.pending;if(A!==null){p.shared.pending=null;var O=A,ee=O.next;O.next=null,x===null?y=ee:x.next=ee,x=O;var he=r.alternate;he!==null&&(he=he.updateQueue,A=he.lastBaseUpdate,A!==x&&(A===null?he.firstBaseUpdate=ee:A.next=ee,he.lastBaseUpdate=O))}if(y!==null){var pe=p.baseState;x=0,he=ee=O=null,A=y;do{var de=A.lane,Ce=A.eventTime;if((h&de)===de){he!==null&&(he=he.next={eventTime:Ce,lane:0,tag:A.tag,payload:A.payload,callback:A.callback,next:null});e:{var Re=r,ke=A;switch(de=i,Ce=o,ke.tag){case 1:if(Re=ke.payload,typeof Re=="function"){pe=Re.call(Ce,pe,de);break e}pe=Re;break e;case 3:Re.flags=Re.flags&-65537|128;case 0:if(Re=ke.payload,de=typeof Re=="function"?Re.call(Ce,pe,de):Re,de==null)break e;pe=se({},pe,de);break e;case 2:hi=!0}}A.callback!==null&&A.lane!==0&&(r.flags|=64,de=p.effects,de===null?p.effects=[A]:de.push(A))}else Ce={eventTime:Ce,lane:de,tag:A.tag,payload:A.payload,callback:A.callback,next:null},he===null?(ee=he=Ce,O=pe):he=he.next=Ce,x|=de;if(A=A.next,A===null){if(A=p.shared.pending,A===null)break;de=A,A=de.next,de.next=null,p.lastBaseUpdate=de,p.shared.pending=null}}while(!0);if(he===null&&(O=pe),p.baseState=O,p.firstBaseUpdate=ee,p.lastBaseUpdate=he,i=p.shared.interleaved,i!==null){p=i;do x|=p.lane,p=p.next;while(p!==i)}else y===null&&(p.shared.lanes=0);ia|=x,r.lanes=x,r.memoizedState=pe}}function Sm(r,i,o){if(r=i.effects,i.effects=null,r!==null)for(i=0;i<r.length;i++){var h=r[i],p=h.callback;if(p!==null){if(h.callback=null,h=o,typeof p!="function")throw Error(t(191,p));p.call(h)}}}var Xo={},ys=ci(Xo),Zo=ci(Xo),el=ci(Xo);function ra(r){if(r===Xo)throw Error(t(174));return r}function Gd(r,i){switch(Nt(el,i),Nt(Zo,r),Nt(ys,Xo),r=i.nodeType,r){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:Ye(null,"");break;default:r=r===8?i.parentNode:i,i=r.namespaceURI||null,r=r.tagName,i=Ye(i,r)}Lt(ys),Nt(ys,i)}function to(){Lt(ys),Lt(Zo),Lt(el)}function Im(r){ra(el.current);var i=ra(ys.current),o=Ye(i,r.type);i!==o&&(Nt(Zo,r),Nt(ys,o))}function Kd(r){Zo.current===r&&(Lt(ys),Lt(Zo))}var Wt=ci(0);function Nc(r){for(var i=r;i!==null;){if(i.tag===13){var o=i.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||o.data==="$?"||o.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===r)break;for(;i.sibling===null;){if(i.return===null||i.return===r)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var Qd=[];function Yd(){for(var r=0;r<Qd.length;r++)Qd[r]._workInProgressVersionPrimary=null;Qd.length=0}var kc=le.ReactCurrentDispatcher,Jd=le.ReactCurrentBatchConfig,sa=0,qt=null,fn=null,vn=null,jc=!1,tl=!1,nl=0,dx=0;function Mn(){throw Error(t(321))}function Xd(r,i){if(i===null)return!1;for(var o=0;o<i.length&&o<r.length;o++)if(!Qr(r[o],i[o]))return!1;return!0}function Zd(r,i,o,h,p,y){if(sa=y,qt=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,kc.current=r===null||r.memoizedState===null?mx:gx,r=o(h,p),tl){y=0;do{if(tl=!1,nl=0,25<=y)throw Error(t(301));y+=1,vn=fn=null,i.updateQueue=null,kc.current=yx,r=o(h,p)}while(tl)}if(kc.current=Lc,i=fn!==null&&fn.next!==null,sa=0,vn=fn=qt=null,jc=!1,i)throw Error(t(300));return r}function eh(){var r=nl!==0;return nl=0,r}function vs(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return vn===null?qt.memoizedState=vn=r:vn=vn.next=r,vn}function kr(){if(fn===null){var r=qt.alternate;r=r!==null?r.memoizedState:null}else r=fn.next;var i=vn===null?qt.memoizedState:vn.next;if(i!==null)vn=i,fn=r;else{if(r===null)throw Error(t(310));fn=r,r={memoizedState:fn.memoizedState,baseState:fn.baseState,baseQueue:fn.baseQueue,queue:fn.queue,next:null},vn===null?qt.memoizedState=vn=r:vn=vn.next=r}return vn}function rl(r,i){return typeof i=="function"?i(r):i}function th(r){var i=kr(),o=i.queue;if(o===null)throw Error(t(311));o.lastRenderedReducer=r;var h=fn,p=h.baseQueue,y=o.pending;if(y!==null){if(p!==null){var x=p.next;p.next=y.next,y.next=x}h.baseQueue=p=y,o.pending=null}if(p!==null){y=p.next,h=h.baseState;var A=x=null,O=null,ee=y;do{var he=ee.lane;if((sa&he)===he)O!==null&&(O=O.next={lane:0,action:ee.action,hasEagerState:ee.hasEagerState,eagerState:ee.eagerState,next:null}),h=ee.hasEagerState?ee.eagerState:r(h,ee.action);else{var pe={lane:he,action:ee.action,hasEagerState:ee.hasEagerState,eagerState:ee.eagerState,next:null};O===null?(A=O=pe,x=h):O=O.next=pe,qt.lanes|=he,ia|=he}ee=ee.next}while(ee!==null&&ee!==y);O===null?x=h:O.next=A,Qr(h,i.memoizedState)||(ar=!0),i.memoizedState=h,i.baseState=x,i.baseQueue=O,o.lastRenderedState=h}if(r=o.interleaved,r!==null){p=r;do y=p.lane,qt.lanes|=y,ia|=y,p=p.next;while(p!==r)}else p===null&&(o.lanes=0);return[i.memoizedState,o.dispatch]}function nh(r){var i=kr(),o=i.queue;if(o===null)throw Error(t(311));o.lastRenderedReducer=r;var h=o.dispatch,p=o.pending,y=i.memoizedState;if(p!==null){o.pending=null;var x=p=p.next;do y=r(y,x.action),x=x.next;while(x!==p);Qr(y,i.memoizedState)||(ar=!0),i.memoizedState=y,i.baseQueue===null&&(i.baseState=y),o.lastRenderedState=y}return[y,h]}function Cm(){}function Pm(r,i){var o=qt,h=kr(),p=i(),y=!Qr(h.memoizedState,p);if(y&&(h.memoizedState=p,ar=!0),h=h.queue,rh(Am.bind(null,o,h,r),[r]),h.getSnapshot!==i||y||vn!==null&&vn.memoizedState.tag&1){if(o.flags|=2048,sl(9,Rm.bind(null,o,h,p,i),void 0,null),_n===null)throw Error(t(349));(sa&30)!==0||bm(o,i,p)}return p}function bm(r,i,o){r.flags|=16384,r={getSnapshot:i,value:o},i=qt.updateQueue,i===null?(i={lastEffect:null,stores:null},qt.updateQueue=i,i.stores=[r]):(o=i.stores,o===null?i.stores=[r]:o.push(r))}function Rm(r,i,o,h){i.value=o,i.getSnapshot=h,Nm(i)&&km(r)}function Am(r,i,o){return o(function(){Nm(i)&&km(r)})}function Nm(r){var i=r.getSnapshot;r=r.value;try{var o=i();return!Qr(r,o)}catch{return!0}}function km(r){var i=$s(r,1);i!==null&&es(i,r,1,-1)}function jm(r){var i=vs();return typeof r=="function"&&(r=r()),i.memoizedState=i.baseState=r,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:rl,lastRenderedState:r},i.queue=r,r=r.dispatch=px.bind(null,qt,r),[i.memoizedState,r]}function sl(r,i,o,h){return r={tag:r,create:i,destroy:o,deps:h,next:null},i=qt.updateQueue,i===null?(i={lastEffect:null,stores:null},qt.updateQueue=i,i.lastEffect=r.next=r):(o=i.lastEffect,o===null?i.lastEffect=r.next=r:(h=o.next,o.next=r,r.next=h,i.lastEffect=r)),r}function Dm(){return kr().memoizedState}function Dc(r,i,o,h){var p=vs();qt.flags|=r,p.memoizedState=sl(1|i,o,void 0,h===void 0?null:h)}function Vc(r,i,o,h){var p=kr();h=h===void 0?null:h;var y=void 0;if(fn!==null){var x=fn.memoizedState;if(y=x.destroy,h!==null&&Xd(h,x.deps)){p.memoizedState=sl(i,o,y,h);return}}qt.flags|=r,p.memoizedState=sl(1|i,o,y,h)}function Vm(r,i){return Dc(8390656,8,r,i)}function rh(r,i){return Vc(2048,8,r,i)}function Lm(r,i){return Vc(4,2,r,i)}function Om(r,i){return Vc(4,4,r,i)}function Mm(r,i){if(typeof i=="function")return r=r(),i(r),function(){i(null)};if(i!=null)return r=r(),i.current=r,function(){i.current=null}}function Fm(r,i,o){return o=o!=null?o.concat([r]):null,Vc(4,4,Mm.bind(null,i,r),o)}function sh(){}function Um(r,i){var o=kr();i=i===void 0?null:i;var h=o.memoizedState;return h!==null&&i!==null&&Xd(i,h[1])?h[0]:(o.memoizedState=[r,i],r)}function zm(r,i){var o=kr();i=i===void 0?null:i;var h=o.memoizedState;return h!==null&&i!==null&&Xd(i,h[1])?h[0]:(r=r(),o.memoizedState=[r,i],r)}function Bm(r,i,o){return(sa&21)===0?(r.baseState&&(r.baseState=!1,ar=!0),r.memoizedState=o):(Qr(o,i)||(o=$t(),qt.lanes|=o,ia|=o,r.baseState=!0),i)}function hx(r,i){var o=tt;tt=o!==0&&4>o?o:4,r(!0);var h=Jd.transition;Jd.transition={};try{r(!1),i()}finally{tt=o,Jd.transition=h}}function $m(){return kr().memoizedState}function fx(r,i,o){var h=yi(r);if(o={lane:h,action:o,hasEagerState:!1,eagerState:null,next:null},Wm(r))qm(i,o);else if(o=xm(r,i,o,h),o!==null){var p=Jn();es(o,r,h,p),Hm(o,i,h)}}function px(r,i,o){var h=yi(r),p={lane:h,action:o,hasEagerState:!1,eagerState:null,next:null};if(Wm(r))qm(i,p);else{var y=r.alternate;if(r.lanes===0&&(y===null||y.lanes===0)&&(y=i.lastRenderedReducer,y!==null))try{var x=i.lastRenderedState,A=y(x,o);if(p.hasEagerState=!0,p.eagerState=A,Qr(A,x)){var O=i.interleaved;O===null?(p.next=p,qd(i)):(p.next=O.next,O.next=p),i.interleaved=p;return}}catch{}finally{}o=xm(r,i,p,h),o!==null&&(p=Jn(),es(o,r,h,p),Hm(o,i,h))}}function Wm(r){var i=r.alternate;return r===qt||i!==null&&i===qt}function qm(r,i){tl=jc=!0;var o=r.pending;o===null?i.next=i:(i.next=o.next,o.next=i),r.pending=i}function Hm(r,i,o){if((o&4194240)!==0){var h=i.lanes;h&=r.pendingLanes,o|=h,i.lanes=o,it(r,o)}}var Lc={readContext:Nr,useCallback:Mn,useContext:Mn,useEffect:Mn,useImperativeHandle:Mn,useInsertionEffect:Mn,useLayoutEffect:Mn,useMemo:Mn,useReducer:Mn,useRef:Mn,useState:Mn,useDebugValue:Mn,useDeferredValue:Mn,useTransition:Mn,useMutableSource:Mn,useSyncExternalStore:Mn,useId:Mn,unstable_isNewReconciler:!1},mx={readContext:Nr,useCallback:function(r,i){return vs().memoizedState=[r,i===void 0?null:i],r},useContext:Nr,useEffect:Vm,useImperativeHandle:function(r,i,o){return o=o!=null?o.concat([r]):null,Dc(4194308,4,Mm.bind(null,i,r),o)},useLayoutEffect:function(r,i){return Dc(4194308,4,r,i)},useInsertionEffect:function(r,i){return Dc(4,2,r,i)},useMemo:function(r,i){var o=vs();return i=i===void 0?null:i,r=r(),o.memoizedState=[r,i],r},useReducer:function(r,i,o){var h=vs();return i=o!==void 0?o(i):i,h.memoizedState=h.baseState=i,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:i},h.queue=r,r=r.dispatch=fx.bind(null,qt,r),[h.memoizedState,r]},useRef:function(r){var i=vs();return r={current:r},i.memoizedState=r},useState:jm,useDebugValue:sh,useDeferredValue:function(r){return vs().memoizedState=r},useTransition:function(){var r=jm(!1),i=r[0];return r=hx.bind(null,r[1]),vs().memoizedState=r,[i,r]},useMutableSource:function(){},useSyncExternalStore:function(r,i,o){var h=qt,p=vs();if(zt){if(o===void 0)throw Error(t(407));o=o()}else{if(o=i(),_n===null)throw Error(t(349));(sa&30)!==0||bm(h,i,o)}p.memoizedState=o;var y={value:o,getSnapshot:i};return p.queue=y,Vm(Am.bind(null,h,y,r),[r]),h.flags|=2048,sl(9,Rm.bind(null,h,y,o,i),void 0,null),o},useId:function(){var r=vs(),i=_n.identifierPrefix;if(zt){var o=Bs,h=zs;o=(h&~(1<<32-Sn(h)-1)).toString(32)+o,i=":"+i+"R"+o,o=nl++,0<o&&(i+="H"+o.toString(32)),i+=":"}else o=dx++,i=":"+i+"r"+o.toString(32)+":";return r.memoizedState=i},unstable_isNewReconciler:!1},gx={readContext:Nr,useCallback:Um,useContext:Nr,useEffect:rh,useImperativeHandle:Fm,useInsertionEffect:Lm,useLayoutEffect:Om,useMemo:zm,useReducer:th,useRef:Dm,useState:function(){return th(rl)},useDebugValue:sh,useDeferredValue:function(r){var i=kr();return Bm(i,fn.memoizedState,r)},useTransition:function(){var r=th(rl)[0],i=kr().memoizedState;return[r,i]},useMutableSource:Cm,useSyncExternalStore:Pm,useId:$m,unstable_isNewReconciler:!1},yx={readContext:Nr,useCallback:Um,useContext:Nr,useEffect:rh,useImperativeHandle:Fm,useInsertionEffect:Lm,useLayoutEffect:Om,useMemo:zm,useReducer:nh,useRef:Dm,useState:function(){return nh(rl)},useDebugValue:sh,useDeferredValue:function(r){var i=kr();return fn===null?i.memoizedState=r:Bm(i,fn.memoizedState,r)},useTransition:function(){var r=nh(rl)[0],i=kr().memoizedState;return[r,i]},useMutableSource:Cm,useSyncExternalStore:Pm,useId:$m,unstable_isNewReconciler:!1};function Jr(r,i){if(r&&r.defaultProps){i=se({},i),r=r.defaultProps;for(var o in r)i[o]===void 0&&(i[o]=r[o]);return i}return i}function ih(r,i,o,h){i=r.memoizedState,o=o(h,i),o=o==null?i:se({},i,o),r.memoizedState=o,r.lanes===0&&(r.updateQueue.baseState=o)}var Oc={isMounted:function(r){return(r=r._reactInternals)?we(r)===r:!1},enqueueSetState:function(r,i,o){r=r._reactInternals;var h=Jn(),p=yi(r),y=Ws(h,p);y.payload=i,o!=null&&(y.callback=o),i=fi(r,y,p),i!==null&&(es(i,r,p,h),Rc(i,r,p))},enqueueReplaceState:function(r,i,o){r=r._reactInternals;var h=Jn(),p=yi(r),y=Ws(h,p);y.tag=1,y.payload=i,o!=null&&(y.callback=o),i=fi(r,y,p),i!==null&&(es(i,r,p,h),Rc(i,r,p))},enqueueForceUpdate:function(r,i){r=r._reactInternals;var o=Jn(),h=yi(r),p=Ws(o,h);p.tag=2,i!=null&&(p.callback=i),i=fi(r,p,h),i!==null&&(es(i,r,h,o),Rc(i,r,h))}};function Gm(r,i,o,h,p,y,x){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(h,y,x):i.prototype&&i.prototype.isPureReactComponent?!Wo(o,h)||!Wo(p,y):!0}function Km(r,i,o){var h=!1,p=ui,y=i.contextType;return typeof y=="object"&&y!==null?y=Nr(y):(p=ir(i)?Zi:On.current,h=i.contextTypes,y=(h=h!=null)?Ka(r,p):ui),i=new i(o,y),r.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=Oc,r.stateNode=i,i._reactInternals=r,h&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=p,r.__reactInternalMemoizedMaskedChildContext=y),i}function Qm(r,i,o,h){r=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(o,h),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(o,h),i.state!==r&&Oc.enqueueReplaceState(i,i.state,null)}function ah(r,i,o,h){var p=r.stateNode;p.props=o,p.state=r.memoizedState,p.refs={},Hd(r);var y=i.contextType;typeof y=="object"&&y!==null?p.context=Nr(y):(y=ir(i)?Zi:On.current,p.context=Ka(r,y)),p.state=r.memoizedState,y=i.getDerivedStateFromProps,typeof y=="function"&&(ih(r,i,y,o),p.state=r.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(i=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),i!==p.state&&Oc.enqueueReplaceState(p,p.state,null),Ac(r,o,p,h),p.state=r.memoizedState),typeof p.componentDidMount=="function"&&(r.flags|=4194308)}function no(r,i){try{var o="",h=i;do o+=Ae(h),h=h.return;while(h);var p=o}catch(y){p=`
Error generating stack: `+y.message+`
`+y.stack}return{value:r,source:i,stack:p,digest:null}}function oh(r,i,o){return{value:r,source:null,stack:o??null,digest:i??null}}function lh(r,i){try{console.error(i.value)}catch(o){setTimeout(function(){throw o})}}var vx=typeof WeakMap=="function"?WeakMap:Map;function Ym(r,i,o){o=Ws(-1,o),o.tag=3,o.payload={element:null};var h=i.value;return o.callback=function(){Wc||(Wc=!0,Th=h),lh(r,i)},o}function Jm(r,i,o){o=Ws(-1,o),o.tag=3;var h=r.type.getDerivedStateFromError;if(typeof h=="function"){var p=i.value;o.payload=function(){return h(p)},o.callback=function(){lh(r,i)}}var y=r.stateNode;return y!==null&&typeof y.componentDidCatch=="function"&&(o.callback=function(){lh(r,i),typeof h!="function"&&(mi===null?mi=new Set([this]):mi.add(this));var x=i.stack;this.componentDidCatch(i.value,{componentStack:x!==null?x:""})}),o}function Xm(r,i,o){var h=r.pingCache;if(h===null){h=r.pingCache=new vx;var p=new Set;h.set(i,p)}else p=h.get(i),p===void 0&&(p=new Set,h.set(i,p));p.has(o)||(p.add(o),r=kx.bind(null,r,i,o),i.then(r,r))}function Zm(r){do{var i;if((i=r.tag===13)&&(i=r.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return r;r=r.return}while(r!==null);return null}function eg(r,i,o,h,p){return(r.mode&1)===0?(r===i?r.flags|=65536:(r.flags|=128,o.flags|=131072,o.flags&=-52805,o.tag===1&&(o.alternate===null?o.tag=17:(i=Ws(-1,1),i.tag=2,fi(o,i,1))),o.lanes|=1),r):(r.flags|=65536,r.lanes=p,r)}var _x=le.ReactCurrentOwner,ar=!1;function Yn(r,i,o,h){i.child=r===null?wm(i,null,o,h):Xa(i,r.child,o,h)}function tg(r,i,o,h,p){o=o.render;var y=i.ref;return eo(i,p),h=Zd(r,i,o,h,y,p),o=eh(),r!==null&&!ar?(i.updateQueue=r.updateQueue,i.flags&=-2053,r.lanes&=~p,qs(r,i,p)):(zt&&o&&Ld(i),i.flags|=1,Yn(r,i,h,p),i.child)}function ng(r,i,o,h,p){if(r===null){var y=o.type;return typeof y=="function"&&!Ah(y)&&y.defaultProps===void 0&&o.compare===null&&o.defaultProps===void 0?(i.tag=15,i.type=y,rg(r,i,y,h,p)):(r=Yc(o.type,null,h,i,i.mode,p),r.ref=i.ref,r.return=i,i.child=r)}if(y=r.child,(r.lanes&p)===0){var x=y.memoizedProps;if(o=o.compare,o=o!==null?o:Wo,o(x,h)&&r.ref===i.ref)return qs(r,i,p)}return i.flags|=1,r=_i(y,h),r.ref=i.ref,r.return=i,i.child=r}function rg(r,i,o,h,p){if(r!==null){var y=r.memoizedProps;if(Wo(y,h)&&r.ref===i.ref)if(ar=!1,i.pendingProps=h=y,(r.lanes&p)!==0)(r.flags&131072)!==0&&(ar=!0);else return i.lanes=r.lanes,qs(r,i,p)}return ch(r,i,o,h,p)}function sg(r,i,o){var h=i.pendingProps,p=h.children,y=r!==null?r.memoizedState:null;if(h.mode==="hidden")if((i.mode&1)===0)i.memoizedState={baseLanes:0,cachePool:null,transitions:null},Nt(so,_r),_r|=o;else{if((o&1073741824)===0)return r=y!==null?y.baseLanes|o:o,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:r,cachePool:null,transitions:null},i.updateQueue=null,Nt(so,_r),_r|=r,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},h=y!==null?y.baseLanes:o,Nt(so,_r),_r|=h}else y!==null?(h=y.baseLanes|o,i.memoizedState=null):h=o,Nt(so,_r),_r|=h;return Yn(r,i,p,o),i.child}function ig(r,i){var o=i.ref;(r===null&&o!==null||r!==null&&r.ref!==o)&&(i.flags|=512,i.flags|=2097152)}function ch(r,i,o,h,p){var y=ir(o)?Zi:On.current;return y=Ka(i,y),eo(i,p),o=Zd(r,i,o,h,y,p),h=eh(),r!==null&&!ar?(i.updateQueue=r.updateQueue,i.flags&=-2053,r.lanes&=~p,qs(r,i,p)):(zt&&h&&Ld(i),i.flags|=1,Yn(r,i,o,p),i.child)}function ag(r,i,o,h,p){if(ir(o)){var y=!0;xc(i)}else y=!1;if(eo(i,p),i.stateNode===null)Fc(r,i),Km(i,o,h),ah(i,o,h,p),h=!0;else if(r===null){var x=i.stateNode,A=i.memoizedProps;x.props=A;var O=x.context,ee=o.contextType;typeof ee=="object"&&ee!==null?ee=Nr(ee):(ee=ir(o)?Zi:On.current,ee=Ka(i,ee));var he=o.getDerivedStateFromProps,pe=typeof he=="function"||typeof x.getSnapshotBeforeUpdate=="function";pe||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(A!==h||O!==ee)&&Qm(i,x,h,ee),hi=!1;var de=i.memoizedState;x.state=de,Ac(i,h,x,p),O=i.memoizedState,A!==h||de!==O||sr.current||hi?(typeof he=="function"&&(ih(i,o,he,h),O=i.memoizedState),(A=hi||Gm(i,o,A,h,de,O,ee))?(pe||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(i.flags|=4194308)):(typeof x.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=h,i.memoizedState=O),x.props=h,x.state=O,x.context=ee,h=A):(typeof x.componentDidMount=="function"&&(i.flags|=4194308),h=!1)}else{x=i.stateNode,Em(r,i),A=i.memoizedProps,ee=i.type===i.elementType?A:Jr(i.type,A),x.props=ee,pe=i.pendingProps,de=x.context,O=o.contextType,typeof O=="object"&&O!==null?O=Nr(O):(O=ir(o)?Zi:On.current,O=Ka(i,O));var Ce=o.getDerivedStateFromProps;(he=typeof Ce=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(A!==pe||de!==O)&&Qm(i,x,h,O),hi=!1,de=i.memoizedState,x.state=de,Ac(i,h,x,p);var Re=i.memoizedState;A!==pe||de!==Re||sr.current||hi?(typeof Ce=="function"&&(ih(i,o,Ce,h),Re=i.memoizedState),(ee=hi||Gm(i,o,ee,h,de,Re,O)||!1)?(he||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(h,Re,O),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(h,Re,O)),typeof x.componentDidUpdate=="function"&&(i.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof x.componentDidUpdate!="function"||A===r.memoizedProps&&de===r.memoizedState||(i.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||A===r.memoizedProps&&de===r.memoizedState||(i.flags|=1024),i.memoizedProps=h,i.memoizedState=Re),x.props=h,x.state=Re,x.context=O,h=ee):(typeof x.componentDidUpdate!="function"||A===r.memoizedProps&&de===r.memoizedState||(i.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||A===r.memoizedProps&&de===r.memoizedState||(i.flags|=1024),h=!1)}return uh(r,i,o,h,y,p)}function uh(r,i,o,h,p,y){ig(r,i);var x=(i.flags&128)!==0;if(!h&&!x)return p&&dm(i,o,!1),qs(r,i,y);h=i.stateNode,_x.current=i;var A=x&&typeof o.getDerivedStateFromError!="function"?null:h.render();return i.flags|=1,r!==null&&x?(i.child=Xa(i,r.child,null,y),i.child=Xa(i,null,A,y)):Yn(r,i,A,y),i.memoizedState=h.state,p&&dm(i,o,!0),i.child}function og(r){var i=r.stateNode;i.pendingContext?cm(r,i.pendingContext,i.pendingContext!==i.context):i.context&&cm(r,i.context,!1),Gd(r,i.containerInfo)}function lg(r,i,o,h,p){return Ja(),Ud(p),i.flags|=256,Yn(r,i,o,h),i.child}var dh={dehydrated:null,treeContext:null,retryLane:0};function hh(r){return{baseLanes:r,cachePool:null,transitions:null}}function cg(r,i,o){var h=i.pendingProps,p=Wt.current,y=!1,x=(i.flags&128)!==0,A;if((A=x)||(A=r!==null&&r.memoizedState===null?!1:(p&2)!==0),A?(y=!0,i.flags&=-129):(r===null||r.memoizedState!==null)&&(p|=1),Nt(Wt,p&1),r===null)return Fd(i),r=i.memoizedState,r!==null&&(r=r.dehydrated,r!==null)?((i.mode&1)===0?i.lanes=1:r.data==="$!"?i.lanes=8:i.lanes=1073741824,null):(x=h.children,r=h.fallback,y?(h=i.mode,y=i.child,x={mode:"hidden",children:x},(h&1)===0&&y!==null?(y.childLanes=0,y.pendingProps=x):y=Jc(x,h,0,null),r=ca(r,h,o,null),y.return=i,r.return=i,y.sibling=r,i.child=y,i.child.memoizedState=hh(o),i.memoizedState=dh,r):fh(i,x));if(p=r.memoizedState,p!==null&&(A=p.dehydrated,A!==null))return wx(r,i,x,h,A,p,o);if(y){y=h.fallback,x=i.mode,p=r.child,A=p.sibling;var O={mode:"hidden",children:h.children};return(x&1)===0&&i.child!==p?(h=i.child,h.childLanes=0,h.pendingProps=O,i.deletions=null):(h=_i(p,O),h.subtreeFlags=p.subtreeFlags&14680064),A!==null?y=_i(A,y):(y=ca(y,x,o,null),y.flags|=2),y.return=i,h.return=i,h.sibling=y,i.child=h,h=y,y=i.child,x=r.child.memoizedState,x=x===null?hh(o):{baseLanes:x.baseLanes|o,cachePool:null,transitions:x.transitions},y.memoizedState=x,y.childLanes=r.childLanes&~o,i.memoizedState=dh,h}return y=r.child,r=y.sibling,h=_i(y,{mode:"visible",children:h.children}),(i.mode&1)===0&&(h.lanes=o),h.return=i,h.sibling=null,r!==null&&(o=i.deletions,o===null?(i.deletions=[r],i.flags|=16):o.push(r)),i.child=h,i.memoizedState=null,h}function fh(r,i){return i=Jc({mode:"visible",children:i},r.mode,0,null),i.return=r,r.child=i}function Mc(r,i,o,h){return h!==null&&Ud(h),Xa(i,r.child,null,o),r=fh(i,i.pendingProps.children),r.flags|=2,i.memoizedState=null,r}function wx(r,i,o,h,p,y,x){if(o)return i.flags&256?(i.flags&=-257,h=oh(Error(t(422))),Mc(r,i,x,h)):i.memoizedState!==null?(i.child=r.child,i.flags|=128,null):(y=h.fallback,p=i.mode,h=Jc({mode:"visible",children:h.children},p,0,null),y=ca(y,p,x,null),y.flags|=2,h.return=i,y.return=i,h.sibling=y,i.child=h,(i.mode&1)!==0&&Xa(i,r.child,null,x),i.child.memoizedState=hh(x),i.memoizedState=dh,y);if((i.mode&1)===0)return Mc(r,i,x,null);if(p.data==="$!"){if(h=p.nextSibling&&p.nextSibling.dataset,h)var A=h.dgst;return h=A,y=Error(t(419)),h=oh(y,h,void 0),Mc(r,i,x,h)}if(A=(x&r.childLanes)!==0,ar||A){if(h=_n,h!==null){switch(x&-x){case 4:p=2;break;case 16:p=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:p=32;break;case 536870912:p=268435456;break;default:p=0}p=(p&(h.suspendedLanes|x))!==0?0:p,p!==0&&p!==y.retryLane&&(y.retryLane=p,$s(r,p),es(h,r,p,-1))}return Rh(),h=oh(Error(t(421))),Mc(r,i,x,h)}return p.data==="$?"?(i.flags|=128,i.child=r.child,i=jx.bind(null,r),p._reactRetry=i,null):(r=y.treeContext,vr=li(p.nextSibling),yr=i,zt=!0,Yr=null,r!==null&&(Rr[Ar++]=zs,Rr[Ar++]=Bs,Rr[Ar++]=ea,zs=r.id,Bs=r.overflow,ea=i),i=fh(i,h.children),i.flags|=4096,i)}function ug(r,i,o){r.lanes|=i;var h=r.alternate;h!==null&&(h.lanes|=i),Wd(r.return,i,o)}function ph(r,i,o,h,p){var y=r.memoizedState;y===null?r.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:h,tail:o,tailMode:p}:(y.isBackwards=i,y.rendering=null,y.renderingStartTime=0,y.last=h,y.tail=o,y.tailMode=p)}function dg(r,i,o){var h=i.pendingProps,p=h.revealOrder,y=h.tail;if(Yn(r,i,h.children,o),h=Wt.current,(h&2)!==0)h=h&1|2,i.flags|=128;else{if(r!==null&&(r.flags&128)!==0)e:for(r=i.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&ug(r,o,i);else if(r.tag===19)ug(r,o,i);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===i)break e;for(;r.sibling===null;){if(r.return===null||r.return===i)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}h&=1}if(Nt(Wt,h),(i.mode&1)===0)i.memoizedState=null;else switch(p){case"forwards":for(o=i.child,p=null;o!==null;)r=o.alternate,r!==null&&Nc(r)===null&&(p=o),o=o.sibling;o=p,o===null?(p=i.child,i.child=null):(p=o.sibling,o.sibling=null),ph(i,!1,p,o,y);break;case"backwards":for(o=null,p=i.child,i.child=null;p!==null;){if(r=p.alternate,r!==null&&Nc(r)===null){i.child=p;break}r=p.sibling,p.sibling=o,o=p,p=r}ph(i,!0,o,null,y);break;case"together":ph(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function Fc(r,i){(i.mode&1)===0&&r!==null&&(r.alternate=null,i.alternate=null,i.flags|=2)}function qs(r,i,o){if(r!==null&&(i.dependencies=r.dependencies),ia|=i.lanes,(o&i.childLanes)===0)return null;if(r!==null&&i.child!==r.child)throw Error(t(153));if(i.child!==null){for(r=i.child,o=_i(r,r.pendingProps),i.child=o,o.return=i;r.sibling!==null;)r=r.sibling,o=o.sibling=_i(r,r.pendingProps),o.return=i;o.sibling=null}return i.child}function xx(r,i,o){switch(i.tag){case 3:og(i),Ja();break;case 5:Im(i);break;case 1:ir(i.type)&&xc(i);break;case 4:Gd(i,i.stateNode.containerInfo);break;case 10:var h=i.type._context,p=i.memoizedProps.value;Nt(Pc,h._currentValue),h._currentValue=p;break;case 13:if(h=i.memoizedState,h!==null)return h.dehydrated!==null?(Nt(Wt,Wt.current&1),i.flags|=128,null):(o&i.child.childLanes)!==0?cg(r,i,o):(Nt(Wt,Wt.current&1),r=qs(r,i,o),r!==null?r.sibling:null);Nt(Wt,Wt.current&1);break;case 19:if(h=(o&i.childLanes)!==0,(r.flags&128)!==0){if(h)return dg(r,i,o);i.flags|=128}if(p=i.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),Nt(Wt,Wt.current),h)break;return null;case 22:case 23:return i.lanes=0,sg(r,i,o)}return qs(r,i,o)}var hg,mh,fg,pg;hg=function(r,i){for(var o=i.child;o!==null;){if(o.tag===5||o.tag===6)r.appendChild(o.stateNode);else if(o.tag!==4&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return;o=o.return}o.sibling.return=o.return,o=o.sibling}},mh=function(){},fg=function(r,i,o,h){var p=r.memoizedProps;if(p!==h){r=i.stateNode,ra(ys.current);var y=null;switch(o){case"input":p=Me(r,p),h=Me(r,h),y=[];break;case"select":p=se({},p,{value:void 0}),h=se({},h,{value:void 0}),y=[];break;case"textarea":p=jn(r,p),h=jn(r,h),y=[];break;default:typeof p.onClick!="function"&&typeof h.onClick=="function"&&(r.onclick=vc)}Ns(o,h);var x;o=null;for(ee in p)if(!h.hasOwnProperty(ee)&&p.hasOwnProperty(ee)&&p[ee]!=null)if(ee==="style"){var A=p[ee];for(x in A)A.hasOwnProperty(x)&&(o||(o={}),o[x]="")}else ee!=="dangerouslySetInnerHTML"&&ee!=="children"&&ee!=="suppressContentEditableWarning"&&ee!=="suppressHydrationWarning"&&ee!=="autoFocus"&&(a.hasOwnProperty(ee)?y||(y=[]):(y=y||[]).push(ee,null));for(ee in h){var O=h[ee];if(A=p!=null?p[ee]:void 0,h.hasOwnProperty(ee)&&O!==A&&(O!=null||A!=null))if(ee==="style")if(A){for(x in A)!A.hasOwnProperty(x)||O&&O.hasOwnProperty(x)||(o||(o={}),o[x]="");for(x in O)O.hasOwnProperty(x)&&A[x]!==O[x]&&(o||(o={}),o[x]=O[x])}else o||(y||(y=[]),y.push(ee,o)),o=O;else ee==="dangerouslySetInnerHTML"?(O=O?O.__html:void 0,A=A?A.__html:void 0,O!=null&&A!==O&&(y=y||[]).push(ee,O)):ee==="children"?typeof O!="string"&&typeof O!="number"||(y=y||[]).push(ee,""+O):ee!=="suppressContentEditableWarning"&&ee!=="suppressHydrationWarning"&&(a.hasOwnProperty(ee)?(O!=null&&ee==="onScroll"&&Vt("scroll",r),y||A===O||(y=[])):(y=y||[]).push(ee,O))}o&&(y=y||[]).push("style",o);var ee=y;(i.updateQueue=ee)&&(i.flags|=4)}},pg=function(r,i,o,h){o!==h&&(i.flags|=4)};function il(r,i){if(!zt)switch(r.tailMode){case"hidden":i=r.tail;for(var o=null;i!==null;)i.alternate!==null&&(o=i),i=i.sibling;o===null?r.tail=null:o.sibling=null;break;case"collapsed":o=r.tail;for(var h=null;o!==null;)o.alternate!==null&&(h=o),o=o.sibling;h===null?i||r.tail===null?r.tail=null:r.tail.sibling=null:h.sibling=null}}function Fn(r){var i=r.alternate!==null&&r.alternate.child===r.child,o=0,h=0;if(i)for(var p=r.child;p!==null;)o|=p.lanes|p.childLanes,h|=p.subtreeFlags&14680064,h|=p.flags&14680064,p.return=r,p=p.sibling;else for(p=r.child;p!==null;)o|=p.lanes|p.childLanes,h|=p.subtreeFlags,h|=p.flags,p.return=r,p=p.sibling;return r.subtreeFlags|=h,r.childLanes=o,i}function Ex(r,i,o){var h=i.pendingProps;switch(Od(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Fn(i),null;case 1:return ir(i.type)&&wc(),Fn(i),null;case 3:return h=i.stateNode,to(),Lt(sr),Lt(On),Yd(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(r===null||r.child===null)&&(Ic(i)?i.flags|=4:r===null||r.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Yr!==null&&(Ch(Yr),Yr=null))),mh(r,i),Fn(i),null;case 5:Kd(i);var p=ra(el.current);if(o=i.type,r!==null&&i.stateNode!=null)fg(r,i,o,h,p),r.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!h){if(i.stateNode===null)throw Error(t(166));return Fn(i),null}if(r=ra(ys.current),Ic(i)){h=i.stateNode,o=i.type;var y=i.memoizedProps;switch(h[gs]=i,h[Qo]=y,r=(i.mode&1)!==0,o){case"dialog":Vt("cancel",h),Vt("close",h);break;case"iframe":case"object":case"embed":Vt("load",h);break;case"video":case"audio":for(p=0;p<Ho.length;p++)Vt(Ho[p],h);break;case"source":Vt("error",h);break;case"img":case"image":case"link":Vt("error",h),Vt("load",h);break;case"details":Vt("toggle",h);break;case"input":xt(h,y),Vt("invalid",h);break;case"select":h._wrapperState={wasMultiple:!!y.multiple},Vt("invalid",h);break;case"textarea":Rt(h,y),Vt("invalid",h)}Ns(o,y),p=null;for(var x in y)if(y.hasOwnProperty(x)){var A=y[x];x==="children"?typeof A=="string"?h.textContent!==A&&(y.suppressHydrationWarning!==!0&&yc(h.textContent,A,r),p=["children",A]):typeof A=="number"&&h.textContent!==""+A&&(y.suppressHydrationWarning!==!0&&yc(h.textContent,A,r),p=["children",""+A]):a.hasOwnProperty(x)&&A!=null&&x==="onScroll"&&Vt("scroll",h)}switch(o){case"input":ue(h),Qt(h,y,!0);break;case"textarea":ue(h),En(h);break;case"select":case"option":break;default:typeof y.onClick=="function"&&(h.onclick=vc)}h=p,i.updateQueue=h,h!==null&&(i.flags|=4)}else{x=p.nodeType===9?p:p.ownerDocument,r==="http://www.w3.org/1999/xhtml"&&(r=At(o)),r==="http://www.w3.org/1999/xhtml"?o==="script"?(r=x.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild)):typeof h.is=="string"?r=x.createElement(o,{is:h.is}):(r=x.createElement(o),o==="select"&&(x=r,h.multiple?x.multiple=!0:h.size&&(x.size=h.size))):r=x.createElementNS(r,o),r[gs]=i,r[Qo]=h,hg(r,i,!1,!1),i.stateNode=r;e:{switch(x=Zn(o,h),o){case"dialog":Vt("cancel",r),Vt("close",r),p=h;break;case"iframe":case"object":case"embed":Vt("load",r),p=h;break;case"video":case"audio":for(p=0;p<Ho.length;p++)Vt(Ho[p],r);p=h;break;case"source":Vt("error",r),p=h;break;case"img":case"image":case"link":Vt("error",r),Vt("load",r),p=h;break;case"details":Vt("toggle",r),p=h;break;case"input":xt(r,h),p=Me(r,h),Vt("invalid",r);break;case"option":p=h;break;case"select":r._wrapperState={wasMultiple:!!h.multiple},p=se({},h,{value:void 0}),Vt("invalid",r);break;case"textarea":Rt(r,h),p=jn(r,h),Vt("invalid",r);break;default:p=h}Ns(o,p),A=p;for(y in A)if(A.hasOwnProperty(y)){var O=A[y];y==="style"?Hn(r,O):y==="dangerouslySetInnerHTML"?(O=O?O.__html:void 0,O!=null&&As(r,O)):y==="children"?typeof O=="string"?(o!=="textarea"||O!=="")&&qn(r,O):typeof O=="number"&&qn(r,""+O):y!=="suppressContentEditableWarning"&&y!=="suppressHydrationWarning"&&y!=="autoFocus"&&(a.hasOwnProperty(y)?O!=null&&y==="onScroll"&&Vt("scroll",r):O!=null&&re(r,y,O,x))}switch(o){case"input":ue(r),Qt(r,h,!1);break;case"textarea":ue(r),En(r);break;case"option":h.value!=null&&r.setAttribute("value",""+Qe(h.value));break;case"select":r.multiple=!!h.multiple,y=h.value,y!=null?Bt(r,!!h.multiple,y,!1):h.defaultValue!=null&&Bt(r,!!h.multiple,h.defaultValue,!0);break;default:typeof p.onClick=="function"&&(r.onclick=vc)}switch(o){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}}h&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return Fn(i),null;case 6:if(r&&i.stateNode!=null)pg(r,i,r.memoizedProps,h);else{if(typeof h!="string"&&i.stateNode===null)throw Error(t(166));if(o=ra(el.current),ra(ys.current),Ic(i)){if(h=i.stateNode,o=i.memoizedProps,h[gs]=i,(y=h.nodeValue!==o)&&(r=yr,r!==null))switch(r.tag){case 3:yc(h.nodeValue,o,(r.mode&1)!==0);break;case 5:r.memoizedProps.suppressHydrationWarning!==!0&&yc(h.nodeValue,o,(r.mode&1)!==0)}y&&(i.flags|=4)}else h=(o.nodeType===9?o:o.ownerDocument).createTextNode(h),h[gs]=i,i.stateNode=h}return Fn(i),null;case 13:if(Lt(Wt),h=i.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(zt&&vr!==null&&(i.mode&1)!==0&&(i.flags&128)===0)ym(),Ja(),i.flags|=98560,y=!1;else if(y=Ic(i),h!==null&&h.dehydrated!==null){if(r===null){if(!y)throw Error(t(318));if(y=i.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(t(317));y[gs]=i}else Ja(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Fn(i),y=!1}else Yr!==null&&(Ch(Yr),Yr=null),y=!0;if(!y)return i.flags&65536?i:null}return(i.flags&128)!==0?(i.lanes=o,i):(h=h!==null,h!==(r!==null&&r.memoizedState!==null)&&h&&(i.child.flags|=8192,(i.mode&1)!==0&&(r===null||(Wt.current&1)!==0?pn===0&&(pn=3):Rh())),i.updateQueue!==null&&(i.flags|=4),Fn(i),null);case 4:return to(),mh(r,i),r===null&&Go(i.stateNode.containerInfo),Fn(i),null;case 10:return $d(i.type._context),Fn(i),null;case 17:return ir(i.type)&&wc(),Fn(i),null;case 19:if(Lt(Wt),y=i.memoizedState,y===null)return Fn(i),null;if(h=(i.flags&128)!==0,x=y.rendering,x===null)if(h)il(y,!1);else{if(pn!==0||r!==null&&(r.flags&128)!==0)for(r=i.child;r!==null;){if(x=Nc(r),x!==null){for(i.flags|=128,il(y,!1),h=x.updateQueue,h!==null&&(i.updateQueue=h,i.flags|=4),i.subtreeFlags=0,h=o,o=i.child;o!==null;)y=o,r=h,y.flags&=14680066,x=y.alternate,x===null?(y.childLanes=0,y.lanes=r,y.child=null,y.subtreeFlags=0,y.memoizedProps=null,y.memoizedState=null,y.updateQueue=null,y.dependencies=null,y.stateNode=null):(y.childLanes=x.childLanes,y.lanes=x.lanes,y.child=x.child,y.subtreeFlags=0,y.deletions=null,y.memoizedProps=x.memoizedProps,y.memoizedState=x.memoizedState,y.updateQueue=x.updateQueue,y.type=x.type,r=x.dependencies,y.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),o=o.sibling;return Nt(Wt,Wt.current&1|2),i.child}r=r.sibling}y.tail!==null&&ft()>io&&(i.flags|=128,h=!0,il(y,!1),i.lanes=4194304)}else{if(!h)if(r=Nc(x),r!==null){if(i.flags|=128,h=!0,o=r.updateQueue,o!==null&&(i.updateQueue=o,i.flags|=4),il(y,!0),y.tail===null&&y.tailMode==="hidden"&&!x.alternate&&!zt)return Fn(i),null}else 2*ft()-y.renderingStartTime>io&&o!==1073741824&&(i.flags|=128,h=!0,il(y,!1),i.lanes=4194304);y.isBackwards?(x.sibling=i.child,i.child=x):(o=y.last,o!==null?o.sibling=x:i.child=x,y.last=x)}return y.tail!==null?(i=y.tail,y.rendering=i,y.tail=i.sibling,y.renderingStartTime=ft(),i.sibling=null,o=Wt.current,Nt(Wt,h?o&1|2:o&1),i):(Fn(i),null);case 22:case 23:return bh(),h=i.memoizedState!==null,r!==null&&r.memoizedState!==null!==h&&(i.flags|=8192),h&&(i.mode&1)!==0?(_r&1073741824)!==0&&(Fn(i),i.subtreeFlags&6&&(i.flags|=8192)):Fn(i),null;case 24:return null;case 25:return null}throw Error(t(156,i.tag))}function Tx(r,i){switch(Od(i),i.tag){case 1:return ir(i.type)&&wc(),r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 3:return to(),Lt(sr),Lt(On),Yd(),r=i.flags,(r&65536)!==0&&(r&128)===0?(i.flags=r&-65537|128,i):null;case 5:return Kd(i),null;case 13:if(Lt(Wt),r=i.memoizedState,r!==null&&r.dehydrated!==null){if(i.alternate===null)throw Error(t(340));Ja()}return r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 19:return Lt(Wt),null;case 4:return to(),null;case 10:return $d(i.type._context),null;case 22:case 23:return bh(),null;case 24:return null;default:return null}}var Uc=!1,Un=!1,Sx=typeof WeakSet=="function"?WeakSet:Set,be=null;function ro(r,i){var o=r.ref;if(o!==null)if(typeof o=="function")try{o(null)}catch(h){Kt(r,i,h)}else o.current=null}function gh(r,i,o){try{o()}catch(h){Kt(r,i,h)}}var mg=!1;function Ix(r,i){if(bd=ii,r=Gp(),wd(r)){if("selectionStart"in r)var o={start:r.selectionStart,end:r.selectionEnd};else e:{o=(o=r.ownerDocument)&&o.defaultView||window;var h=o.getSelection&&o.getSelection();if(h&&h.rangeCount!==0){o=h.anchorNode;var p=h.anchorOffset,y=h.focusNode;h=h.focusOffset;try{o.nodeType,y.nodeType}catch{o=null;break e}var x=0,A=-1,O=-1,ee=0,he=0,pe=r,de=null;t:for(;;){for(var Ce;pe!==o||p!==0&&pe.nodeType!==3||(A=x+p),pe!==y||h!==0&&pe.nodeType!==3||(O=x+h),pe.nodeType===3&&(x+=pe.nodeValue.length),(Ce=pe.firstChild)!==null;)de=pe,pe=Ce;for(;;){if(pe===r)break t;if(de===o&&++ee===p&&(A=x),de===y&&++he===h&&(O=x),(Ce=pe.nextSibling)!==null)break;pe=de,de=pe.parentNode}pe=Ce}o=A===-1||O===-1?null:{start:A,end:O}}else o=null}o=o||{start:0,end:0}}else o=null;for(Rd={focusedElem:r,selectionRange:o},ii=!1,be=i;be!==null;)if(i=be,r=i.child,(i.subtreeFlags&1028)!==0&&r!==null)r.return=i,be=r;else for(;be!==null;){i=be;try{var Re=i.alternate;if((i.flags&1024)!==0)switch(i.tag){case 0:case 11:case 15:break;case 1:if(Re!==null){var ke=Re.memoizedProps,Jt=Re.memoizedState,G=i.stateNode,z=G.getSnapshotBeforeUpdate(i.elementType===i.type?ke:Jr(i.type,ke),Jt);G.__reactInternalSnapshotBeforeUpdate=z}break;case 3:var Q=i.stateNode.containerInfo;Q.nodeType===1?Q.textContent="":Q.nodeType===9&&Q.documentElement&&Q.removeChild(Q.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(ve){Kt(i,i.return,ve)}if(r=i.sibling,r!==null){r.return=i.return,be=r;break}be=i.return}return Re=mg,mg=!1,Re}function al(r,i,o){var h=i.updateQueue;if(h=h!==null?h.lastEffect:null,h!==null){var p=h=h.next;do{if((p.tag&r)===r){var y=p.destroy;p.destroy=void 0,y!==void 0&&gh(i,o,y)}p=p.next}while(p!==h)}}function zc(r,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var o=i=i.next;do{if((o.tag&r)===r){var h=o.create;o.destroy=h()}o=o.next}while(o!==i)}}function yh(r){var i=r.ref;if(i!==null){var o=r.stateNode;switch(r.tag){case 5:r=o;break;default:r=o}typeof i=="function"?i(r):i.current=r}}function gg(r){var i=r.alternate;i!==null&&(r.alternate=null,gg(i)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(i=r.stateNode,i!==null&&(delete i[gs],delete i[Qo],delete i[jd],delete i[ox],delete i[lx])),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}function yg(r){return r.tag===5||r.tag===3||r.tag===4}function vg(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||yg(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function vh(r,i,o){var h=r.tag;if(h===5||h===6)r=r.stateNode,i?o.nodeType===8?o.parentNode.insertBefore(r,i):o.insertBefore(r,i):(o.nodeType===8?(i=o.parentNode,i.insertBefore(r,o)):(i=o,i.appendChild(r)),o=o._reactRootContainer,o!=null||i.onclick!==null||(i.onclick=vc));else if(h!==4&&(r=r.child,r!==null))for(vh(r,i,o),r=r.sibling;r!==null;)vh(r,i,o),r=r.sibling}function _h(r,i,o){var h=r.tag;if(h===5||h===6)r=r.stateNode,i?o.insertBefore(r,i):o.appendChild(r);else if(h!==4&&(r=r.child,r!==null))for(_h(r,i,o),r=r.sibling;r!==null;)_h(r,i,o),r=r.sibling}var Pn=null,Xr=!1;function pi(r,i,o){for(o=o.child;o!==null;)_g(r,i,o),o=o.sibling}function _g(r,i,o){if(Kn&&typeof Kn.onCommitFiberUnmount=="function")try{Kn.onCommitFiberUnmount(us,o)}catch{}switch(o.tag){case 5:Un||ro(o,i);case 6:var h=Pn,p=Xr;Pn=null,pi(r,i,o),Pn=h,Xr=p,Pn!==null&&(Xr?(r=Pn,o=o.stateNode,r.nodeType===8?r.parentNode.removeChild(o):r.removeChild(o)):Pn.removeChild(o.stateNode));break;case 18:Pn!==null&&(Xr?(r=Pn,o=o.stateNode,r.nodeType===8?kd(r.parentNode,o):r.nodeType===1&&kd(r,o),Gr(r)):kd(Pn,o.stateNode));break;case 4:h=Pn,p=Xr,Pn=o.stateNode.containerInfo,Xr=!0,pi(r,i,o),Pn=h,Xr=p;break;case 0:case 11:case 14:case 15:if(!Un&&(h=o.updateQueue,h!==null&&(h=h.lastEffect,h!==null))){p=h=h.next;do{var y=p,x=y.destroy;y=y.tag,x!==void 0&&((y&2)!==0||(y&4)!==0)&&gh(o,i,x),p=p.next}while(p!==h)}pi(r,i,o);break;case 1:if(!Un&&(ro(o,i),h=o.stateNode,typeof h.componentWillUnmount=="function"))try{h.props=o.memoizedProps,h.state=o.memoizedState,h.componentWillUnmount()}catch(A){Kt(o,i,A)}pi(r,i,o);break;case 21:pi(r,i,o);break;case 22:o.mode&1?(Un=(h=Un)||o.memoizedState!==null,pi(r,i,o),Un=h):pi(r,i,o);break;default:pi(r,i,o)}}function wg(r){var i=r.updateQueue;if(i!==null){r.updateQueue=null;var o=r.stateNode;o===null&&(o=r.stateNode=new Sx),i.forEach(function(h){var p=Dx.bind(null,r,h);o.has(h)||(o.add(h),h.then(p,p))})}}function Zr(r,i){var o=i.deletions;if(o!==null)for(var h=0;h<o.length;h++){var p=o[h];try{var y=r,x=i,A=x;e:for(;A!==null;){switch(A.tag){case 5:Pn=A.stateNode,Xr=!1;break e;case 3:Pn=A.stateNode.containerInfo,Xr=!0;break e;case 4:Pn=A.stateNode.containerInfo,Xr=!0;break e}A=A.return}if(Pn===null)throw Error(t(160));_g(y,x,p),Pn=null,Xr=!1;var O=p.alternate;O!==null&&(O.return=null),p.return=null}catch(ee){Kt(p,i,ee)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)xg(i,r),i=i.sibling}function xg(r,i){var o=r.alternate,h=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:if(Zr(i,r),_s(r),h&4){try{al(3,r,r.return),zc(3,r)}catch(ke){Kt(r,r.return,ke)}try{al(5,r,r.return)}catch(ke){Kt(r,r.return,ke)}}break;case 1:Zr(i,r),_s(r),h&512&&o!==null&&ro(o,o.return);break;case 5:if(Zr(i,r),_s(r),h&512&&o!==null&&ro(o,o.return),r.flags&32){var p=r.stateNode;try{qn(p,"")}catch(ke){Kt(r,r.return,ke)}}if(h&4&&(p=r.stateNode,p!=null)){var y=r.memoizedProps,x=o!==null?o.memoizedProps:y,A=r.type,O=r.updateQueue;if(r.updateQueue=null,O!==null)try{A==="input"&&y.type==="radio"&&y.name!=null&&It(p,y),Zn(A,x);var ee=Zn(A,y);for(x=0;x<O.length;x+=2){var he=O[x],pe=O[x+1];he==="style"?Hn(p,pe):he==="dangerouslySetInnerHTML"?As(p,pe):he==="children"?qn(p,pe):re(p,he,pe,ee)}switch(A){case"input":jt(p,y);break;case"textarea":nn(p,y);break;case"select":var de=p._wrapperState.wasMultiple;p._wrapperState.wasMultiple=!!y.multiple;var Ce=y.value;Ce!=null?Bt(p,!!y.multiple,Ce,!1):de!==!!y.multiple&&(y.defaultValue!=null?Bt(p,!!y.multiple,y.defaultValue,!0):Bt(p,!!y.multiple,y.multiple?[]:"",!1))}p[Qo]=y}catch(ke){Kt(r,r.return,ke)}}break;case 6:if(Zr(i,r),_s(r),h&4){if(r.stateNode===null)throw Error(t(162));p=r.stateNode,y=r.memoizedProps;try{p.nodeValue=y}catch(ke){Kt(r,r.return,ke)}}break;case 3:if(Zr(i,r),_s(r),h&4&&o!==null&&o.memoizedState.isDehydrated)try{Gr(i.containerInfo)}catch(ke){Kt(r,r.return,ke)}break;case 4:Zr(i,r),_s(r);break;case 13:Zr(i,r),_s(r),p=r.child,p.flags&8192&&(y=p.memoizedState!==null,p.stateNode.isHidden=y,!y||p.alternate!==null&&p.alternate.memoizedState!==null||(Eh=ft())),h&4&&wg(r);break;case 22:if(he=o!==null&&o.memoizedState!==null,r.mode&1?(Un=(ee=Un)||he,Zr(i,r),Un=ee):Zr(i,r),_s(r),h&8192){if(ee=r.memoizedState!==null,(r.stateNode.isHidden=ee)&&!he&&(r.mode&1)!==0)for(be=r,he=r.child;he!==null;){for(pe=be=he;be!==null;){switch(de=be,Ce=de.child,de.tag){case 0:case 11:case 14:case 15:al(4,de,de.return);break;case 1:ro(de,de.return);var Re=de.stateNode;if(typeof Re.componentWillUnmount=="function"){h=de,o=de.return;try{i=h,Re.props=i.memoizedProps,Re.state=i.memoizedState,Re.componentWillUnmount()}catch(ke){Kt(h,o,ke)}}break;case 5:ro(de,de.return);break;case 22:if(de.memoizedState!==null){Sg(pe);continue}}Ce!==null?(Ce.return=de,be=Ce):Sg(pe)}he=he.sibling}e:for(he=null,pe=r;;){if(pe.tag===5){if(he===null){he=pe;try{p=pe.stateNode,ee?(y=p.style,typeof y.setProperty=="function"?y.setProperty("display","none","important"):y.display="none"):(A=pe.stateNode,O=pe.memoizedProps.style,x=O!=null&&O.hasOwnProperty("display")?O.display:null,A.style.display=Fr("display",x))}catch(ke){Kt(r,r.return,ke)}}}else if(pe.tag===6){if(he===null)try{pe.stateNode.nodeValue=ee?"":pe.memoizedProps}catch(ke){Kt(r,r.return,ke)}}else if((pe.tag!==22&&pe.tag!==23||pe.memoizedState===null||pe===r)&&pe.child!==null){pe.child.return=pe,pe=pe.child;continue}if(pe===r)break e;for(;pe.sibling===null;){if(pe.return===null||pe.return===r)break e;he===pe&&(he=null),pe=pe.return}he===pe&&(he=null),pe.sibling.return=pe.return,pe=pe.sibling}}break;case 19:Zr(i,r),_s(r),h&4&&wg(r);break;case 21:break;default:Zr(i,r),_s(r)}}function _s(r){var i=r.flags;if(i&2){try{e:{for(var o=r.return;o!==null;){if(yg(o)){var h=o;break e}o=o.return}throw Error(t(160))}switch(h.tag){case 5:var p=h.stateNode;h.flags&32&&(qn(p,""),h.flags&=-33);var y=vg(r);_h(r,y,p);break;case 3:case 4:var x=h.stateNode.containerInfo,A=vg(r);vh(r,A,x);break;default:throw Error(t(161))}}catch(O){Kt(r,r.return,O)}r.flags&=-3}i&4096&&(r.flags&=-4097)}function Cx(r,i,o){be=r,Eg(r)}function Eg(r,i,o){for(var h=(r.mode&1)!==0;be!==null;){var p=be,y=p.child;if(p.tag===22&&h){var x=p.memoizedState!==null||Uc;if(!x){var A=p.alternate,O=A!==null&&A.memoizedState!==null||Un;A=Uc;var ee=Un;if(Uc=x,(Un=O)&&!ee)for(be=p;be!==null;)x=be,O=x.child,x.tag===22&&x.memoizedState!==null?Ig(p):O!==null?(O.return=x,be=O):Ig(p);for(;y!==null;)be=y,Eg(y),y=y.sibling;be=p,Uc=A,Un=ee}Tg(r)}else(p.subtreeFlags&8772)!==0&&y!==null?(y.return=p,be=y):Tg(r)}}function Tg(r){for(;be!==null;){var i=be;if((i.flags&8772)!==0){var o=i.alternate;try{if((i.flags&8772)!==0)switch(i.tag){case 0:case 11:case 15:Un||zc(5,i);break;case 1:var h=i.stateNode;if(i.flags&4&&!Un)if(o===null)h.componentDidMount();else{var p=i.elementType===i.type?o.memoizedProps:Jr(i.type,o.memoizedProps);h.componentDidUpdate(p,o.memoizedState,h.__reactInternalSnapshotBeforeUpdate)}var y=i.updateQueue;y!==null&&Sm(i,y,h);break;case 3:var x=i.updateQueue;if(x!==null){if(o=null,i.child!==null)switch(i.child.tag){case 5:o=i.child.stateNode;break;case 1:o=i.child.stateNode}Sm(i,x,o)}break;case 5:var A=i.stateNode;if(o===null&&i.flags&4){o=A;var O=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":O.autoFocus&&o.focus();break;case"img":O.src&&(o.src=O.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var ee=i.alternate;if(ee!==null){var he=ee.memoizedState;if(he!==null){var pe=he.dehydrated;pe!==null&&Gr(pe)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Un||i.flags&512&&yh(i)}catch(de){Kt(i,i.return,de)}}if(i===r){be=null;break}if(o=i.sibling,o!==null){o.return=i.return,be=o;break}be=i.return}}function Sg(r){for(;be!==null;){var i=be;if(i===r){be=null;break}var o=i.sibling;if(o!==null){o.return=i.return,be=o;break}be=i.return}}function Ig(r){for(;be!==null;){var i=be;try{switch(i.tag){case 0:case 11:case 15:var o=i.return;try{zc(4,i)}catch(O){Kt(i,o,O)}break;case 1:var h=i.stateNode;if(typeof h.componentDidMount=="function"){var p=i.return;try{h.componentDidMount()}catch(O){Kt(i,p,O)}}var y=i.return;try{yh(i)}catch(O){Kt(i,y,O)}break;case 5:var x=i.return;try{yh(i)}catch(O){Kt(i,x,O)}}}catch(O){Kt(i,i.return,O)}if(i===r){be=null;break}var A=i.sibling;if(A!==null){A.return=i.return,be=A;break}be=i.return}}var Px=Math.ceil,Bc=le.ReactCurrentDispatcher,wh=le.ReactCurrentOwner,jr=le.ReactCurrentBatchConfig,gt=0,_n=null,on=null,bn=0,_r=0,so=ci(0),pn=0,ol=null,ia=0,$c=0,xh=0,ll=null,or=null,Eh=0,io=1/0,Hs=null,Wc=!1,Th=null,mi=null,qc=!1,gi=null,Hc=0,cl=0,Sh=null,Gc=-1,Kc=0;function Jn(){return(gt&6)!==0?ft():Gc!==-1?Gc:Gc=ft()}function yi(r){return(r.mode&1)===0?1:(gt&2)!==0&&bn!==0?bn&-bn:ux.transition!==null?(Kc===0&&(Kc=$t()),Kc):(r=tt,r!==0||(r=window.event,r=r===void 0?16:Oo(r.type)),r)}function es(r,i,o,h){if(50<cl)throw cl=0,Sh=null,Error(t(185));dn(r,o,h),((gt&2)===0||r!==_n)&&(r===_n&&((gt&2)===0&&($c|=o),pn===4&&vi(r,bn)),lr(r,h),o===1&&gt===0&&(i.mode&1)===0&&(io=ft()+500,Ec&&di()))}function lr(r,i){var o=r.callbackNode;wt(r,i);var h=Te(r,r===_n?bn:0);if(h===0)o!==null&&js(o),r.callbackNode=null,r.callbackPriority=0;else if(i=h&-h,r.callbackPriority!==i){if(o!=null&&js(o),i===1)r.tag===0?cx(Pg.bind(null,r)):hm(Pg.bind(null,r)),ix(function(){(gt&6)===0&&di()}),o=null;else{switch(Yt(h)){case 1:o=cs;break;case 4:o=Br;break;case 16:o=Gn;break;case 536870912:o=Sr;break;default:o=Gn}o=Vg(o,Cg.bind(null,r))}r.callbackPriority=i,r.callbackNode=o}}function Cg(r,i){if(Gc=-1,Kc=0,(gt&6)!==0)throw Error(t(327));var o=r.callbackNode;if(ao()&&r.callbackNode!==o)return null;var h=Te(r,r===_n?bn:0);if(h===0)return null;if((h&30)!==0||(h&r.expiredLanes)!==0||i)i=Qc(r,h);else{i=h;var p=gt;gt|=2;var y=Rg();(_n!==r||bn!==i)&&(Hs=null,io=ft()+500,oa(r,i));do try{Ax();break}catch(A){bg(r,A)}while(!0);Bd(),Bc.current=y,gt=p,on!==null?i=0:(_n=null,bn=0,i=pn)}if(i!==0){if(i===2&&(p=ot(r),p!==0&&(h=p,i=Ih(r,p))),i===1)throw o=ol,oa(r,0),vi(r,h),lr(r,ft()),o;if(i===6)vi(r,h);else{if(p=r.current.alternate,(h&30)===0&&!bx(p)&&(i=Qc(r,h),i===2&&(y=ot(r),y!==0&&(h=y,i=Ih(r,y))),i===1))throw o=ol,oa(r,0),vi(r,h),lr(r,ft()),o;switch(r.finishedWork=p,r.finishedLanes=h,i){case 0:case 1:throw Error(t(345));case 2:la(r,or,Hs);break;case 3:if(vi(r,h),(h&130023424)===h&&(i=Eh+500-ft(),10<i)){if(Te(r,0)!==0)break;if(p=r.suspendedLanes,(p&h)!==h){Jn(),r.pingedLanes|=r.suspendedLanes&p;break}r.timeoutHandle=Nd(la.bind(null,r,or,Hs),i);break}la(r,or,Hs);break;case 4:if(vi(r,h),(h&4194240)===h)break;for(i=r.eventTimes,p=-1;0<h;){var x=31-Sn(h);y=1<<x,x=i[x],x>p&&(p=x),h&=~y}if(h=p,h=ft()-h,h=(120>h?120:480>h?480:1080>h?1080:1920>h?1920:3e3>h?3e3:4320>h?4320:1960*Px(h/1960))-h,10<h){r.timeoutHandle=Nd(la.bind(null,r,or,Hs),h);break}la(r,or,Hs);break;case 5:la(r,or,Hs);break;default:throw Error(t(329))}}}return lr(r,ft()),r.callbackNode===o?Cg.bind(null,r):null}function Ih(r,i){var o=ll;return r.current.memoizedState.isDehydrated&&(oa(r,i).flags|=256),r=Qc(r,i),r!==2&&(i=or,or=o,i!==null&&Ch(i)),r}function Ch(r){or===null?or=r:or.push.apply(or,r)}function bx(r){for(var i=r;;){if(i.flags&16384){var o=i.updateQueue;if(o!==null&&(o=o.stores,o!==null))for(var h=0;h<o.length;h++){var p=o[h],y=p.getSnapshot;p=p.value;try{if(!Qr(y(),p))return!1}catch{return!1}}}if(o=i.child,i.subtreeFlags&16384&&o!==null)o.return=i,i=o;else{if(i===r)break;for(;i.sibling===null;){if(i.return===null||i.return===r)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function vi(r,i){for(i&=~xh,i&=~$c,r.suspendedLanes|=i,r.pingedLanes&=~i,r=r.expirationTimes;0<i;){var o=31-Sn(i),h=1<<o;r[o]=-1,i&=~h}}function Pg(r){if((gt&6)!==0)throw Error(t(327));ao();var i=Te(r,0);if((i&1)===0)return lr(r,ft()),null;var o=Qc(r,i);if(r.tag!==0&&o===2){var h=ot(r);h!==0&&(i=h,o=Ih(r,h))}if(o===1)throw o=ol,oa(r,0),vi(r,i),lr(r,ft()),o;if(o===6)throw Error(t(345));return r.finishedWork=r.current.alternate,r.finishedLanes=i,la(r,or,Hs),lr(r,ft()),null}function Ph(r,i){var o=gt;gt|=1;try{return r(i)}finally{gt=o,gt===0&&(io=ft()+500,Ec&&di())}}function aa(r){gi!==null&&gi.tag===0&&(gt&6)===0&&ao();var i=gt;gt|=1;var o=jr.transition,h=tt;try{if(jr.transition=null,tt=1,r)return r()}finally{tt=h,jr.transition=o,gt=i,(gt&6)===0&&di()}}function bh(){_r=so.current,Lt(so)}function oa(r,i){r.finishedWork=null,r.finishedLanes=0;var o=r.timeoutHandle;if(o!==-1&&(r.timeoutHandle=-1,sx(o)),on!==null)for(o=on.return;o!==null;){var h=o;switch(Od(h),h.tag){case 1:h=h.type.childContextTypes,h!=null&&wc();break;case 3:to(),Lt(sr),Lt(On),Yd();break;case 5:Kd(h);break;case 4:to();break;case 13:Lt(Wt);break;case 19:Lt(Wt);break;case 10:$d(h.type._context);break;case 22:case 23:bh()}o=o.return}if(_n=r,on=r=_i(r.current,null),bn=_r=i,pn=0,ol=null,xh=$c=ia=0,or=ll=null,na!==null){for(i=0;i<na.length;i++)if(o=na[i],h=o.interleaved,h!==null){o.interleaved=null;var p=h.next,y=o.pending;if(y!==null){var x=y.next;y.next=p,h.next=x}o.pending=h}na=null}return r}function bg(r,i){do{var o=on;try{if(Bd(),kc.current=Lc,jc){for(var h=qt.memoizedState;h!==null;){var p=h.queue;p!==null&&(p.pending=null),h=h.next}jc=!1}if(sa=0,vn=fn=qt=null,tl=!1,nl=0,wh.current=null,o===null||o.return===null){pn=1,ol=i,on=null;break}e:{var y=r,x=o.return,A=o,O=i;if(i=bn,A.flags|=32768,O!==null&&typeof O=="object"&&typeof O.then=="function"){var ee=O,he=A,pe=he.tag;if((he.mode&1)===0&&(pe===0||pe===11||pe===15)){var de=he.alternate;de?(he.updateQueue=de.updateQueue,he.memoizedState=de.memoizedState,he.lanes=de.lanes):(he.updateQueue=null,he.memoizedState=null)}var Ce=Zm(x);if(Ce!==null){Ce.flags&=-257,eg(Ce,x,A,y,i),Ce.mode&1&&Xm(y,ee,i),i=Ce,O=ee;var Re=i.updateQueue;if(Re===null){var ke=new Set;ke.add(O),i.updateQueue=ke}else Re.add(O);break e}else{if((i&1)===0){Xm(y,ee,i),Rh();break e}O=Error(t(426))}}else if(zt&&A.mode&1){var Jt=Zm(x);if(Jt!==null){(Jt.flags&65536)===0&&(Jt.flags|=256),eg(Jt,x,A,y,i),Ud(no(O,A));break e}}y=O=no(O,A),pn!==4&&(pn=2),ll===null?ll=[y]:ll.push(y),y=x;do{switch(y.tag){case 3:y.flags|=65536,i&=-i,y.lanes|=i;var G=Ym(y,O,i);Tm(y,G);break e;case 1:A=O;var z=y.type,Q=y.stateNode;if((y.flags&128)===0&&(typeof z.getDerivedStateFromError=="function"||Q!==null&&typeof Q.componentDidCatch=="function"&&(mi===null||!mi.has(Q)))){y.flags|=65536,i&=-i,y.lanes|=i;var ve=Jm(y,A,i);Tm(y,ve);break e}}y=y.return}while(y!==null)}Ng(o)}catch(De){i=De,on===o&&o!==null&&(on=o=o.return);continue}break}while(!0)}function Rg(){var r=Bc.current;return Bc.current=Lc,r===null?Lc:r}function Rh(){(pn===0||pn===3||pn===2)&&(pn=4),_n===null||(ia&268435455)===0&&($c&268435455)===0||vi(_n,bn)}function Qc(r,i){var o=gt;gt|=2;var h=Rg();(_n!==r||bn!==i)&&(Hs=null,oa(r,i));do try{Rx();break}catch(p){bg(r,p)}while(!0);if(Bd(),gt=o,Bc.current=h,on!==null)throw Error(t(261));return _n=null,bn=0,pn}function Rx(){for(;on!==null;)Ag(on)}function Ax(){for(;on!==null&&!Ds();)Ag(on)}function Ag(r){var i=Dg(r.alternate,r,_r);r.memoizedProps=r.pendingProps,i===null?Ng(r):on=i,wh.current=null}function Ng(r){var i=r;do{var o=i.alternate;if(r=i.return,(i.flags&32768)===0){if(o=Ex(o,i,_r),o!==null){on=o;return}}else{if(o=Tx(o,i),o!==null){o.flags&=32767,on=o;return}if(r!==null)r.flags|=32768,r.subtreeFlags=0,r.deletions=null;else{pn=6,on=null;return}}if(i=i.sibling,i!==null){on=i;return}on=i=r}while(i!==null);pn===0&&(pn=5)}function la(r,i,o){var h=tt,p=jr.transition;try{jr.transition=null,tt=1,Nx(r,i,o,h)}finally{jr.transition=p,tt=h}return null}function Nx(r,i,o,h){do ao();while(gi!==null);if((gt&6)!==0)throw Error(t(327));o=r.finishedWork;var p=r.finishedLanes;if(o===null)return null;if(r.finishedWork=null,r.finishedLanes=0,o===r.current)throw Error(t(177));r.callbackNode=null,r.callbackPriority=0;var y=o.lanes|o.childLanes;if(et(r,y),r===_n&&(on=_n=null,bn=0),(o.subtreeFlags&2064)===0&&(o.flags&2064)===0||qc||(qc=!0,Vg(Gn,function(){return ao(),null})),y=(o.flags&15990)!==0,(o.subtreeFlags&15990)!==0||y){y=jr.transition,jr.transition=null;var x=tt;tt=1;var A=gt;gt|=4,wh.current=null,Ix(r,o),xg(o,r),Jw(Rd),ii=!!bd,Rd=bd=null,r.current=o,Cx(o),yt(),gt=A,tt=x,jr.transition=y}else r.current=o;if(qc&&(qc=!1,gi=r,Hc=p),y=r.pendingLanes,y===0&&(mi=null),Pa(o.stateNode),lr(r,ft()),i!==null)for(h=r.onRecoverableError,o=0;o<i.length;o++)p=i[o],h(p.value,{componentStack:p.stack,digest:p.digest});if(Wc)throw Wc=!1,r=Th,Th=null,r;return(Hc&1)!==0&&r.tag!==0&&ao(),y=r.pendingLanes,(y&1)!==0?r===Sh?cl++:(cl=0,Sh=r):cl=0,di(),null}function ao(){if(gi!==null){var r=Yt(Hc),i=jr.transition,o=tt;try{if(jr.transition=null,tt=16>r?16:r,gi===null)var h=!1;else{if(r=gi,gi=null,Hc=0,(gt&6)!==0)throw Error(t(331));var p=gt;for(gt|=4,be=r.current;be!==null;){var y=be,x=y.child;if((be.flags&16)!==0){var A=y.deletions;if(A!==null){for(var O=0;O<A.length;O++){var ee=A[O];for(be=ee;be!==null;){var he=be;switch(he.tag){case 0:case 11:case 15:al(8,he,y)}var pe=he.child;if(pe!==null)pe.return=he,be=pe;else for(;be!==null;){he=be;var de=he.sibling,Ce=he.return;if(gg(he),he===ee){be=null;break}if(de!==null){de.return=Ce,be=de;break}be=Ce}}}var Re=y.alternate;if(Re!==null){var ke=Re.child;if(ke!==null){Re.child=null;do{var Jt=ke.sibling;ke.sibling=null,ke=Jt}while(ke!==null)}}be=y}}if((y.subtreeFlags&2064)!==0&&x!==null)x.return=y,be=x;else e:for(;be!==null;){if(y=be,(y.flags&2048)!==0)switch(y.tag){case 0:case 11:case 15:al(9,y,y.return)}var G=y.sibling;if(G!==null){G.return=y.return,be=G;break e}be=y.return}}var z=r.current;for(be=z;be!==null;){x=be;var Q=x.child;if((x.subtreeFlags&2064)!==0&&Q!==null)Q.return=x,be=Q;else e:for(x=z;be!==null;){if(A=be,(A.flags&2048)!==0)try{switch(A.tag){case 0:case 11:case 15:zc(9,A)}}catch(De){Kt(A,A.return,De)}if(A===x){be=null;break e}var ve=A.sibling;if(ve!==null){ve.return=A.return,be=ve;break e}be=A.return}}if(gt=p,di(),Kn&&typeof Kn.onPostCommitFiberRoot=="function")try{Kn.onPostCommitFiberRoot(us,r)}catch{}h=!0}return h}finally{tt=o,jr.transition=i}}return!1}function kg(r,i,o){i=no(o,i),i=Ym(r,i,1),r=fi(r,i,1),i=Jn(),r!==null&&(dn(r,1,i),lr(r,i))}function Kt(r,i,o){if(r.tag===3)kg(r,r,o);else for(;i!==null;){if(i.tag===3){kg(i,r,o);break}else if(i.tag===1){var h=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(mi===null||!mi.has(h))){r=no(o,r),r=Jm(i,r,1),i=fi(i,r,1),r=Jn(),i!==null&&(dn(i,1,r),lr(i,r));break}}i=i.return}}function kx(r,i,o){var h=r.pingCache;h!==null&&h.delete(i),i=Jn(),r.pingedLanes|=r.suspendedLanes&o,_n===r&&(bn&o)===o&&(pn===4||pn===3&&(bn&130023424)===bn&&500>ft()-Eh?oa(r,0):xh|=o),lr(r,i)}function jg(r,i){i===0&&((r.mode&1)===0?i=1:(i=Ee,Ee<<=1,(Ee&130023424)===0&&(Ee=4194304)));var o=Jn();r=$s(r,i),r!==null&&(dn(r,i,o),lr(r,o))}function jx(r){var i=r.memoizedState,o=0;i!==null&&(o=i.retryLane),jg(r,o)}function Dx(r,i){var o=0;switch(r.tag){case 13:var h=r.stateNode,p=r.memoizedState;p!==null&&(o=p.retryLane);break;case 19:h=r.stateNode;break;default:throw Error(t(314))}h!==null&&h.delete(i),jg(r,o)}var Dg;Dg=function(r,i,o){if(r!==null)if(r.memoizedProps!==i.pendingProps||sr.current)ar=!0;else{if((r.lanes&o)===0&&(i.flags&128)===0)return ar=!1,xx(r,i,o);ar=(r.flags&131072)!==0}else ar=!1,zt&&(i.flags&1048576)!==0&&fm(i,Sc,i.index);switch(i.lanes=0,i.tag){case 2:var h=i.type;Fc(r,i),r=i.pendingProps;var p=Ka(i,On.current);eo(i,o),p=Zd(null,i,h,r,p,o);var y=eh();return i.flags|=1,typeof p=="object"&&p!==null&&typeof p.render=="function"&&p.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,ir(h)?(y=!0,xc(i)):y=!1,i.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,Hd(i),p.updater=Oc,i.stateNode=p,p._reactInternals=i,ah(i,h,r,o),i=uh(null,i,h,!0,y,o)):(i.tag=0,zt&&y&&Ld(i),Yn(null,i,p,o),i=i.child),i;case 16:h=i.elementType;e:{switch(Fc(r,i),r=i.pendingProps,p=h._init,h=p(h._payload),i.type=h,p=i.tag=Lx(h),r=Jr(h,r),p){case 0:i=ch(null,i,h,r,o);break e;case 1:i=ag(null,i,h,r,o);break e;case 11:i=tg(null,i,h,r,o);break e;case 14:i=ng(null,i,h,Jr(h.type,r),o);break e}throw Error(t(306,h,""))}return i;case 0:return h=i.type,p=i.pendingProps,p=i.elementType===h?p:Jr(h,p),ch(r,i,h,p,o);case 1:return h=i.type,p=i.pendingProps,p=i.elementType===h?p:Jr(h,p),ag(r,i,h,p,o);case 3:e:{if(og(i),r===null)throw Error(t(387));h=i.pendingProps,y=i.memoizedState,p=y.element,Em(r,i),Ac(i,h,null,o);var x=i.memoizedState;if(h=x.element,y.isDehydrated)if(y={element:h,isDehydrated:!1,cache:x.cache,pendingSuspenseBoundaries:x.pendingSuspenseBoundaries,transitions:x.transitions},i.updateQueue.baseState=y,i.memoizedState=y,i.flags&256){p=no(Error(t(423)),i),i=lg(r,i,h,o,p);break e}else if(h!==p){p=no(Error(t(424)),i),i=lg(r,i,h,o,p);break e}else for(vr=li(i.stateNode.containerInfo.firstChild),yr=i,zt=!0,Yr=null,o=wm(i,null,h,o),i.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(Ja(),h===p){i=qs(r,i,o);break e}Yn(r,i,h,o)}i=i.child}return i;case 5:return Im(i),r===null&&Fd(i),h=i.type,p=i.pendingProps,y=r!==null?r.memoizedProps:null,x=p.children,Ad(h,p)?x=null:y!==null&&Ad(h,y)&&(i.flags|=32),ig(r,i),Yn(r,i,x,o),i.child;case 6:return r===null&&Fd(i),null;case 13:return cg(r,i,o);case 4:return Gd(i,i.stateNode.containerInfo),h=i.pendingProps,r===null?i.child=Xa(i,null,h,o):Yn(r,i,h,o),i.child;case 11:return h=i.type,p=i.pendingProps,p=i.elementType===h?p:Jr(h,p),tg(r,i,h,p,o);case 7:return Yn(r,i,i.pendingProps,o),i.child;case 8:return Yn(r,i,i.pendingProps.children,o),i.child;case 12:return Yn(r,i,i.pendingProps.children,o),i.child;case 10:e:{if(h=i.type._context,p=i.pendingProps,y=i.memoizedProps,x=p.value,Nt(Pc,h._currentValue),h._currentValue=x,y!==null)if(Qr(y.value,x)){if(y.children===p.children&&!sr.current){i=qs(r,i,o);break e}}else for(y=i.child,y!==null&&(y.return=i);y!==null;){var A=y.dependencies;if(A!==null){x=y.child;for(var O=A.firstContext;O!==null;){if(O.context===h){if(y.tag===1){O=Ws(-1,o&-o),O.tag=2;var ee=y.updateQueue;if(ee!==null){ee=ee.shared;var he=ee.pending;he===null?O.next=O:(O.next=he.next,he.next=O),ee.pending=O}}y.lanes|=o,O=y.alternate,O!==null&&(O.lanes|=o),Wd(y.return,o,i),A.lanes|=o;break}O=O.next}}else if(y.tag===10)x=y.type===i.type?null:y.child;else if(y.tag===18){if(x=y.return,x===null)throw Error(t(341));x.lanes|=o,A=x.alternate,A!==null&&(A.lanes|=o),Wd(x,o,i),x=y.sibling}else x=y.child;if(x!==null)x.return=y;else for(x=y;x!==null;){if(x===i){x=null;break}if(y=x.sibling,y!==null){y.return=x.return,x=y;break}x=x.return}y=x}Yn(r,i,p.children,o),i=i.child}return i;case 9:return p=i.type,h=i.pendingProps.children,eo(i,o),p=Nr(p),h=h(p),i.flags|=1,Yn(r,i,h,o),i.child;case 14:return h=i.type,p=Jr(h,i.pendingProps),p=Jr(h.type,p),ng(r,i,h,p,o);case 15:return rg(r,i,i.type,i.pendingProps,o);case 17:return h=i.type,p=i.pendingProps,p=i.elementType===h?p:Jr(h,p),Fc(r,i),i.tag=1,ir(h)?(r=!0,xc(i)):r=!1,eo(i,o),Km(i,h,p),ah(i,h,p,o),uh(null,i,h,!0,r,o);case 19:return dg(r,i,o);case 22:return sg(r,i,o)}throw Error(t(156,i.tag))};function Vg(r,i){return zr(r,i)}function Vx(r,i,o,h){this.tag=r,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Dr(r,i,o,h){return new Vx(r,i,o,h)}function Ah(r){return r=r.prototype,!(!r||!r.isReactComponent)}function Lx(r){if(typeof r=="function")return Ah(r)?1:0;if(r!=null){if(r=r.$$typeof,r===D)return 11;if(r===me)return 14}return 2}function _i(r,i){var o=r.alternate;return o===null?(o=Dr(r.tag,i,r.key,r.mode),o.elementType=r.elementType,o.type=r.type,o.stateNode=r.stateNode,o.alternate=r,r.alternate=o):(o.pendingProps=i,o.type=r.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=r.flags&14680064,o.childLanes=r.childLanes,o.lanes=r.lanes,o.child=r.child,o.memoizedProps=r.memoizedProps,o.memoizedState=r.memoizedState,o.updateQueue=r.updateQueue,i=r.dependencies,o.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},o.sibling=r.sibling,o.index=r.index,o.ref=r.ref,o}function Yc(r,i,o,h,p,y){var x=2;if(h=r,typeof r=="function")Ah(r)&&(x=1);else if(typeof r=="string")x=5;else e:switch(r){case N:return ca(o.children,p,y,i);case R:x=8,p|=8;break;case k:return r=Dr(12,o,i,p|2),r.elementType=k,r.lanes=y,r;case S:return r=Dr(13,o,i,p),r.elementType=S,r.lanes=y,r;case ce:return r=Dr(19,o,i,p),r.elementType=ce,r.lanes=y,r;case We:return Jc(o,p,y,i);default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case L:x=10;break e;case M:x=9;break e;case D:x=11;break e;case me:x=14;break e;case dt:x=16,h=null;break e}throw Error(t(130,r==null?r:typeof r,""))}return i=Dr(x,o,i,p),i.elementType=r,i.type=h,i.lanes=y,i}function ca(r,i,o,h){return r=Dr(7,r,h,i),r.lanes=o,r}function Jc(r,i,o,h){return r=Dr(22,r,h,i),r.elementType=We,r.lanes=o,r.stateNode={isHidden:!1},r}function Nh(r,i,o){return r=Dr(6,r,null,i),r.lanes=o,r}function kh(r,i,o){return i=Dr(4,r.children!==null?r.children:[],r.key,i),i.lanes=o,i.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},i}function Ox(r,i,o,h,p){this.tag=i,this.containerInfo=r,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Dt(0),this.expirationTimes=Dt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Dt(0),this.identifierPrefix=h,this.onRecoverableError=p,this.mutableSourceEagerHydrationData=null}function jh(r,i,o,h,p,y,x,A,O){return r=new Ox(r,i,o,A,O),i===1?(i=1,y===!0&&(i|=8)):i=0,y=Dr(3,null,null,i),r.current=y,y.stateNode=r,y.memoizedState={element:h,isDehydrated:o,cache:null,transitions:null,pendingSuspenseBoundaries:null},Hd(y),r}function Mx(r,i,o){var h=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Se,key:h==null?null:""+h,children:r,containerInfo:i,implementation:o}}function Lg(r){if(!r)return ui;r=r._reactInternals;e:{if(we(r)!==r||r.tag!==1)throw Error(t(170));var i=r;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(ir(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(t(171))}if(r.tag===1){var o=r.type;if(ir(o))return um(r,o,i)}return i}function Og(r,i,o,h,p,y,x,A,O){return r=jh(o,h,!0,r,p,y,x,A,O),r.context=Lg(null),o=r.current,h=Jn(),p=yi(o),y=Ws(h,p),y.callback=i??null,fi(o,y,p),r.current.lanes=p,dn(r,p,h),lr(r,h),r}function Xc(r,i,o,h){var p=i.current,y=Jn(),x=yi(p);return o=Lg(o),i.context===null?i.context=o:i.pendingContext=o,i=Ws(y,x),i.payload={element:r},h=h===void 0?null:h,h!==null&&(i.callback=h),r=fi(p,i,x),r!==null&&(es(r,p,x,y),Rc(r,p,x)),x}function Zc(r){if(r=r.current,!r.child)return null;switch(r.child.tag){case 5:return r.child.stateNode;default:return r.child.stateNode}}function Mg(r,i){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var o=r.retryLane;r.retryLane=o!==0&&o<i?o:i}}function Dh(r,i){Mg(r,i),(r=r.alternate)&&Mg(r,i)}function Fx(){return null}var Fg=typeof reportError=="function"?reportError:function(r){console.error(r)};function Vh(r){this._internalRoot=r}eu.prototype.render=Vh.prototype.render=function(r){var i=this._internalRoot;if(i===null)throw Error(t(409));Xc(r,i,null,null)},eu.prototype.unmount=Vh.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var i=r.containerInfo;aa(function(){Xc(null,r,null,null)}),i[Fs]=null}};function eu(r){this._internalRoot=r}eu.prototype.unstable_scheduleHydration=function(r){if(r){var i=Ra();r={blockedOn:null,target:r,priority:i};for(var o=0;o<hs.length&&i!==0&&i<hs[o].priority;o++);hs.splice(o,0,r),o===0&&rc(r)}};function Lh(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function tu(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11&&(r.nodeType!==8||r.nodeValue!==" react-mount-point-unstable "))}function Ug(){}function Ux(r,i,o,h,p){if(p){if(typeof h=="function"){var y=h;h=function(){var ee=Zc(x);y.call(ee)}}var x=Og(i,h,r,0,null,!1,!1,"",Ug);return r._reactRootContainer=x,r[Fs]=x.current,Go(r.nodeType===8?r.parentNode:r),aa(),x}for(;p=r.lastChild;)r.removeChild(p);if(typeof h=="function"){var A=h;h=function(){var ee=Zc(O);A.call(ee)}}var O=jh(r,0,!1,null,null,!1,!1,"",Ug);return r._reactRootContainer=O,r[Fs]=O.current,Go(r.nodeType===8?r.parentNode:r),aa(function(){Xc(i,O,o,h)}),O}function nu(r,i,o,h,p){var y=o._reactRootContainer;if(y){var x=y;if(typeof p=="function"){var A=p;p=function(){var O=Zc(x);A.call(O)}}Xc(i,x,r,p)}else x=Ux(o,i,r,p,h);return Zc(x)}Ir=function(r){switch(r.tag){case 3:var i=r.stateNode;if(i.current.memoizedState.isDehydrated){var o=Oe(i.pendingLanes);o!==0&&(it(i,o|1),lr(i,ft()),(gt&6)===0&&(io=ft()+500,di()))}break;case 13:aa(function(){var h=$s(r,1);if(h!==null){var p=Jn();es(h,r,1,p)}}),Dh(r,1)}},ds=function(r){if(r.tag===13){var i=$s(r,134217728);if(i!==null){var o=Jn();es(i,r,134217728,o)}Dh(r,134217728)}},ba=function(r){if(r.tag===13){var i=yi(r),o=$s(r,i);if(o!==null){var h=Jn();es(o,r,i,h)}Dh(r,i)}},Ra=function(){return tt},Aa=function(r,i){var o=tt;try{return tt=r,i()}finally{tt=o}},ks=function(r,i,o){switch(i){case"input":if(jt(r,o),i=o.name,o.type==="radio"&&i!=null){for(o=r;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<o.length;i++){var h=o[i];if(h!==r&&h.form===r.form){var p=_c(h);if(!p)throw Error(t(90));Ve(h),jt(h,p)}}}break;case"textarea":nn(r,o);break;case"select":i=o.value,i!=null&&Bt(r,!!o.multiple,i,!1)}},sn=Ph,Tr=aa;var zx={usingClientEntryPoint:!1,Events:[Yo,Ha,_c,Dn,Vn,Ph]},ul={findFiberByHostInstance:Xi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Bx={bundleType:ul.bundleType,version:ul.version,rendererPackageName:ul.rendererPackageName,rendererConfig:ul.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:le.ReactCurrentDispatcher,findHostInstanceByFiber:function(r){return r=Ln(r),r===null?null:r.stateNode},findFiberByHostInstance:ul.findFiberByHostInstance||Fx,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ru=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ru.isDisabled&&ru.supportsFiber)try{us=ru.inject(Bx),Kn=ru}catch{}}return cr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=zx,cr.createPortal=function(r,i){var o=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Lh(i))throw Error(t(200));return Mx(r,i,null,o)},cr.createRoot=function(r,i){if(!Lh(r))throw Error(t(299));var o=!1,h="",p=Fg;return i!=null&&(i.unstable_strictMode===!0&&(o=!0),i.identifierPrefix!==void 0&&(h=i.identifierPrefix),i.onRecoverableError!==void 0&&(p=i.onRecoverableError)),i=jh(r,1,!1,null,null,o,!1,h,p),r[Fs]=i.current,Go(r.nodeType===8?r.parentNode:r),new Vh(i)},cr.findDOMNode=function(r){if(r==null)return null;if(r.nodeType===1)return r;var i=r._reactInternals;if(i===void 0)throw typeof r.render=="function"?Error(t(188)):(r=Object.keys(r).join(","),Error(t(268,r)));return r=Ln(i),r=r===null?null:r.stateNode,r},cr.flushSync=function(r){return aa(r)},cr.hydrate=function(r,i,o){if(!tu(i))throw Error(t(200));return nu(null,r,i,!0,o)},cr.hydrateRoot=function(r,i,o){if(!Lh(r))throw Error(t(405));var h=o!=null&&o.hydratedSources||null,p=!1,y="",x=Fg;if(o!=null&&(o.unstable_strictMode===!0&&(p=!0),o.identifierPrefix!==void 0&&(y=o.identifierPrefix),o.onRecoverableError!==void 0&&(x=o.onRecoverableError)),i=Og(i,null,r,1,o??null,p,!1,y,x),r[Fs]=i.current,Go(r),h)for(r=0;r<h.length;r++)o=h[r],p=o._getVersion,p=p(o._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[o,p]:i.mutableSourceEagerHydrationData.push(o,p);return new eu(i)},cr.render=function(r,i,o){if(!tu(i))throw Error(t(200));return nu(null,r,i,!1,o)},cr.unmountComponentAtNode=function(r){if(!tu(r))throw Error(t(40));return r._reactRootContainer?(aa(function(){nu(null,null,r,!1,function(){r._reactRootContainer=null,r[Fs]=null})}),!0):!1},cr.unstable_batchedUpdates=Ph,cr.unstable_renderSubtreeIntoContainer=function(r,i,o,h){if(!tu(o))throw Error(t(200));if(r==null||r._reactInternals===void 0)throw Error(t(38));return nu(r,i,o,!1,h)},cr.version="18.3.1-next-f1338f8080-20240426",cr}var Kg;function Yv(){if(Kg)return Fh.exports;Kg=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Fh.exports=Jx(),Fh.exports}var Qg;function Xx(){if(Qg)return su;Qg=1;var n=Yv();return su.createRoot=n.createRoot,su.hydrateRoot=n.hydrateRoot,su}var Zx=Xx();const eE=Kv(Zx);Yv();/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Rl(){return Rl=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},Rl.apply(this,arguments)}var Ci;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(Ci||(Ci={}));const Yg="popstate";function tE(n){n===void 0&&(n={});function e(s,a){let{pathname:l,search:d,hash:f}=s.location;return rf("",{pathname:l,search:d,hash:f},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(s,a){return typeof a=="string"?a:Eu(a)}return rE(e,t,null,n)}function en(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Vf(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function nE(){return Math.random().toString(36).substr(2,8)}function Jg(n,e){return{usr:n.state,key:n.key,idx:e}}function rf(n,e,t,s){return t===void 0&&(t=null),Rl({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?Io(e):e,{state:t,key:e&&e.key||s||nE()})}function Eu(n){let{pathname:e="/",search:t="",hash:s=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),s&&s!=="#"&&(e+=s.charAt(0)==="#"?s:"#"+s),e}function Io(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let s=n.indexOf("?");s>=0&&(e.search=n.substr(s),n=n.substr(0,s)),n&&(e.pathname=n)}return e}function rE(n,e,t,s){s===void 0&&(s={});let{window:a=document.defaultView,v5Compat:l=!1}=s,d=a.history,f=Ci.Pop,m=null,v=w();v==null&&(v=0,d.replaceState(Rl({},d.state,{idx:v}),""));function w(){return(d.state||{idx:null}).idx}function E(){f=Ci.Pop;let F=w(),X=F==null?null:F-v;v=F,m&&m({action:f,location:Y.location,delta:X})}function C(F,X){f=Ci.Push;let ge=rf(Y.location,F,X);v=w()+1;let re=Jg(ge,v),le=Y.createHref(ge);try{d.pushState(re,"",le)}catch(xe){if(xe instanceof DOMException&&xe.name==="DataCloneError")throw xe;a.location.assign(le)}l&&m&&m({action:f,location:Y.location,delta:1})}function $(F,X){f=Ci.Replace;let ge=rf(Y.location,F,X);v=w();let re=Jg(ge,v),le=Y.createHref(ge);d.replaceState(re,"",le),l&&m&&m({action:f,location:Y.location,delta:0})}function q(F){let X=a.location.origin!=="null"?a.location.origin:a.location.href,ge=typeof F=="string"?F:Eu(F);return ge=ge.replace(/ $/,"%20"),en(X,"No window.location.(origin|href) available to create URL for href: "+ge),new URL(ge,X)}let Y={get action(){return f},get location(){return n(a,d)},listen(F){if(m)throw new Error("A history only accepts one active listener");return a.addEventListener(Yg,E),m=F,()=>{a.removeEventListener(Yg,E),m=null}},createHref(F){return e(a,F)},createURL:q,encodeLocation(F){let X=q(F);return{pathname:X.pathname,search:X.search,hash:X.hash}},push:C,replace:$,go(F){return d.go(F)}};return Y}var Xg;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(Xg||(Xg={}));function sE(n,e,t){return t===void 0&&(t="/"),iE(n,e,t)}function iE(n,e,t,s){let a=typeof e=="string"?Io(e):e,l=Lf(a.pathname||"/",t);if(l==null)return null;let d=Jv(n);aE(d);let f=null;for(let m=0;f==null&&m<d.length;++m){let v=vE(l);f=mE(d[m],v)}return f}function Jv(n,e,t,s){e===void 0&&(e=[]),t===void 0&&(t=[]),s===void 0&&(s="");let a=(l,d,f)=>{let m={relativePath:f===void 0?l.path||"":f,caseSensitive:l.caseSensitive===!0,childrenIndex:d,route:l};m.relativePath.startsWith("/")&&(en(m.relativePath.startsWith(s),'Absolute route path "'+m.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),m.relativePath=m.relativePath.slice(s.length));let v=bi([s,m.relativePath]),w=t.concat(m);l.children&&l.children.length>0&&(en(l.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+v+'".')),Jv(l.children,e,w,v)),!(l.path==null&&!l.index)&&e.push({path:v,score:fE(v,l.index),routesMeta:w})};return n.forEach((l,d)=>{var f;if(l.path===""||!((f=l.path)!=null&&f.includes("?")))a(l,d);else for(let m of Xv(l.path))a(l,d,m)}),e}function Xv(n){let e=n.split("/");if(e.length===0)return[];let[t,...s]=e,a=t.endsWith("?"),l=t.replace(/\?$/,"");if(s.length===0)return a?[l,""]:[l];let d=Xv(s.join("/")),f=[];return f.push(...d.map(m=>m===""?l:[l,m].join("/"))),a&&f.push(...d),f.map(m=>n.startsWith("/")&&m===""?"/":m)}function aE(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:pE(e.routesMeta.map(s=>s.childrenIndex),t.routesMeta.map(s=>s.childrenIndex)))}const oE=/^:[\w-]+$/,lE=3,cE=2,uE=1,dE=10,hE=-2,Zg=n=>n==="*";function fE(n,e){let t=n.split("/"),s=t.length;return t.some(Zg)&&(s+=hE),e&&(s+=cE),t.filter(a=>!Zg(a)).reduce((a,l)=>a+(oE.test(l)?lE:l===""?uE:dE),s)}function pE(n,e){return n.length===e.length&&n.slice(0,-1).every((s,a)=>s===e[a])?n[n.length-1]-e[e.length-1]:0}function mE(n,e,t){let{routesMeta:s}=n,a={},l="/",d=[];for(let f=0;f<s.length;++f){let m=s[f],v=f===s.length-1,w=l==="/"?e:e.slice(l.length)||"/",E=gE({path:m.relativePath,caseSensitive:m.caseSensitive,end:v},w),C=m.route;if(!E)return null;Object.assign(a,E.params),d.push({params:a,pathname:bi([l,E.pathname]),pathnameBase:TE(bi([l,E.pathnameBase])),route:C}),E.pathnameBase!=="/"&&(l=bi([l,E.pathnameBase]))}return d}function gE(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,s]=yE(n.path,n.caseSensitive,n.end),a=e.match(t);if(!a)return null;let l=a[0],d=l.replace(/(.)\/+$/,"$1"),f=a.slice(1);return{params:s.reduce((v,w,E)=>{let{paramName:C,isOptional:$}=w;if(C==="*"){let Y=f[E]||"";d=l.slice(0,l.length-Y.length).replace(/(.)\/+$/,"$1")}const q=f[E];return $&&!q?v[C]=void 0:v[C]=(q||"").replace(/%2F/g,"/"),v},{}),pathname:l,pathnameBase:d,pattern:n}}function yE(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),Vf(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let s=[],a="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,f,m)=>(s.push({paramName:f,isOptional:m!=null}),m?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(s.push({paramName:"*"}),a+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?a+="\\/*$":n!==""&&n!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),s]}function vE(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Vf(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function Lf(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,s=n.charAt(t);return s&&s!=="/"?null:n.slice(t)||"/"}const _E=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,wE=n=>_E.test(n);function xE(n,e){e===void 0&&(e="/");let{pathname:t,search:s="",hash:a=""}=typeof n=="string"?Io(n):n,l;if(t)if(wE(t))l=t;else{if(t.includes("//")){let d=t;t=t.replace(/\/\/+/g,"/"),Vf(!1,"Pathnames cannot have embedded double slashes - normalizing "+(d+" -> "+t))}t.startsWith("/")?l=ey(t.substring(1),"/"):l=ey(t,e)}else l=e;return{pathname:l,search:SE(s),hash:IE(a)}}function ey(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(a=>{a===".."?t.length>1&&t.pop():a!=="."&&t.push(a)}),t.length>1?t.join("/"):"/"}function Bh(n,e,t,s){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function EE(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Of(n,e){let t=EE(n);return e?t.map((s,a)=>a===t.length-1?s.pathname:s.pathnameBase):t.map(s=>s.pathnameBase)}function Mf(n,e,t,s){s===void 0&&(s=!1);let a;typeof n=="string"?a=Io(n):(a=Rl({},n),en(!a.pathname||!a.pathname.includes("?"),Bh("?","pathname","search",a)),en(!a.pathname||!a.pathname.includes("#"),Bh("#","pathname","hash",a)),en(!a.search||!a.search.includes("#"),Bh("#","search","hash",a)));let l=n===""||a.pathname==="",d=l?"/":a.pathname,f;if(d==null)f=t;else{let E=e.length-1;if(!s&&d.startsWith("..")){let C=d.split("/");for(;C[0]==="..";)C.shift(),E-=1;a.pathname=C.join("/")}f=E>=0?e[E]:"/"}let m=xE(a,f),v=d&&d!=="/"&&d.endsWith("/"),w=(l||d===".")&&t.endsWith("/");return!m.pathname.endsWith("/")&&(v||w)&&(m.pathname+="/"),m}const bi=n=>n.join("/").replace(/\/\/+/g,"/"),TE=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),SE=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,IE=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function CE(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const Zv=["post","put","patch","delete"];new Set(Zv);const PE=["get",...Zv];new Set(PE);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Al(){return Al=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},Al.apply(this,arguments)}const Ff=j.createContext(null),bE=j.createContext(null),zi=j.createContext(null),Bu=j.createContext(null),Bi=j.createContext({outlet:null,matches:[],isDataRoute:!1}),e_=j.createContext(null);function RE(n,e){let{relative:t}=e===void 0?{}:e;Co()||en(!1);let{basename:s,navigator:a}=j.useContext(zi),{hash:l,pathname:d,search:f}=n_(n,{relative:t}),m=d;return s!=="/"&&(m=d==="/"?s:bi([s,d])),a.createHref({pathname:m,search:f,hash:l})}function Co(){return j.useContext(Bu)!=null}function Ul(){return Co()||en(!1),j.useContext(Bu).location}function t_(n){j.useContext(zi).static||j.useLayoutEffect(n)}function $u(){let{isDataRoute:n}=j.useContext(Bi);return n?BE():AE()}function AE(){Co()||en(!1);let n=j.useContext(Ff),{basename:e,future:t,navigator:s}=j.useContext(zi),{matches:a}=j.useContext(Bi),{pathname:l}=Ul(),d=JSON.stringify(Of(a,t.v7_relativeSplatPath)),f=j.useRef(!1);return t_(()=>{f.current=!0}),j.useCallback(function(v,w){if(w===void 0&&(w={}),!f.current)return;if(typeof v=="number"){s.go(v);return}let E=Mf(v,JSON.parse(d),l,w.relative==="path");n==null&&e!=="/"&&(E.pathname=E.pathname==="/"?e:bi([e,E.pathname])),(w.replace?s.replace:s.push)(E,w.state,w)},[e,s,d,l,n])}function n_(n,e){let{relative:t}=e===void 0?{}:e,{future:s}=j.useContext(zi),{matches:a}=j.useContext(Bi),{pathname:l}=Ul(),d=JSON.stringify(Of(a,s.v7_relativeSplatPath));return j.useMemo(()=>Mf(n,JSON.parse(d),l,t==="path"),[n,d,l,t])}function NE(n,e){return kE(n,e)}function kE(n,e,t,s){Co()||en(!1);let{navigator:a}=j.useContext(zi),{matches:l}=j.useContext(Bi),d=l[l.length-1],f=d?d.params:{};d&&d.pathname;let m=d?d.pathnameBase:"/";d&&d.route;let v=Ul(),w;if(e){var E;let F=typeof e=="string"?Io(e):e;m==="/"||(E=F.pathname)!=null&&E.startsWith(m)||en(!1),w=F}else w=v;let C=w.pathname||"/",$=C;if(m!=="/"){let F=m.replace(/^\//,"").split("/");$="/"+C.replace(/^\//,"").split("/").slice(F.length).join("/")}let q=sE(n,{pathname:$}),Y=OE(q&&q.map(F=>Object.assign({},F,{params:Object.assign({},f,F.params),pathname:bi([m,a.encodeLocation?a.encodeLocation(F.pathname).pathname:F.pathname]),pathnameBase:F.pathnameBase==="/"?m:bi([m,a.encodeLocation?a.encodeLocation(F.pathnameBase).pathname:F.pathnameBase])})),l,t,s);return e&&Y?j.createElement(Bu.Provider,{value:{location:Al({pathname:"/",search:"",hash:"",state:null,key:"default"},w),navigationType:Ci.Pop}},Y):Y}function jE(){let n=zE(),e=CE(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return j.createElement(j.Fragment,null,j.createElement("h2",null,"Unexpected Application Error!"),j.createElement("h3",{style:{fontStyle:"italic"}},e),t?j.createElement("pre",{style:a},t):null,null)}const DE=j.createElement(jE,null);class VE extends j.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?j.createElement(Bi.Provider,{value:this.props.routeContext},j.createElement(e_.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function LE(n){let{routeContext:e,match:t,children:s}=n,a=j.useContext(Ff);return a&&a.static&&a.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=t.route.id),j.createElement(Bi.Provider,{value:e},s)}function OE(n,e,t,s){var a;if(e===void 0&&(e=[]),t===void 0&&(t=null),s===void 0&&(s=null),n==null){var l;if(!t)return null;if(t.errors)n=t.matches;else if((l=s)!=null&&l.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let d=n,f=(a=t)==null?void 0:a.errors;if(f!=null){let w=d.findIndex(E=>E.route.id&&(f==null?void 0:f[E.route.id])!==void 0);w>=0||en(!1),d=d.slice(0,Math.min(d.length,w+1))}let m=!1,v=-1;if(t&&s&&s.v7_partialHydration)for(let w=0;w<d.length;w++){let E=d[w];if((E.route.HydrateFallback||E.route.hydrateFallbackElement)&&(v=w),E.route.id){let{loaderData:C,errors:$}=t,q=E.route.loader&&C[E.route.id]===void 0&&(!$||$[E.route.id]===void 0);if(E.route.lazy||q){m=!0,v>=0?d=d.slice(0,v+1):d=[d[0]];break}}}return d.reduceRight((w,E,C)=>{let $,q=!1,Y=null,F=null;t&&($=f&&E.route.id?f[E.route.id]:void 0,Y=E.route.errorElement||DE,m&&(v<0&&C===0?($E("route-fallback"),q=!0,F=null):v===C&&(q=!0,F=E.route.hydrateFallbackElement||null)));let X=e.concat(d.slice(0,C+1)),ge=()=>{let re;return $?re=Y:q?re=F:E.route.Component?re=j.createElement(E.route.Component,null):E.route.element?re=E.route.element:re=w,j.createElement(LE,{match:E,routeContext:{outlet:w,matches:X,isDataRoute:t!=null},children:re})};return t&&(E.route.ErrorBoundary||E.route.errorElement||C===0)?j.createElement(VE,{location:t.location,revalidation:t.revalidation,component:Y,error:$,children:ge(),routeContext:{outlet:null,matches:X,isDataRoute:!0}}):ge()},null)}var r_=(function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n})(r_||{}),s_=(function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n})(s_||{});function ME(n){let e=j.useContext(Ff);return e||en(!1),e}function FE(n){let e=j.useContext(bE);return e||en(!1),e}function UE(n){let e=j.useContext(Bi);return e||en(!1),e}function i_(n){let e=UE(),t=e.matches[e.matches.length-1];return t.route.id||en(!1),t.route.id}function zE(){var n;let e=j.useContext(e_),t=FE(),s=i_();return e!==void 0?e:(n=t.errors)==null?void 0:n[s]}function BE(){let{router:n}=ME(r_.UseNavigateStable),e=i_(s_.UseNavigateStable),t=j.useRef(!1);return t_(()=>{t.current=!0}),j.useCallback(function(a,l){l===void 0&&(l={}),t.current&&(typeof a=="number"?n.navigate(a):n.navigate(a,Al({fromRouteId:e},l)))},[n,e])}const ty={};function $E(n,e,t){ty[n]||(ty[n]=!0)}function WE(n,e){n==null||n.v7_startTransition,n==null||n.v7_relativeSplatPath}function qE(n){let{to:e,replace:t,state:s,relative:a}=n;Co()||en(!1);let{future:l,static:d}=j.useContext(zi),{matches:f}=j.useContext(Bi),{pathname:m}=Ul(),v=$u(),w=Mf(e,Of(f,l.v7_relativeSplatPath),m,a==="path"),E=JSON.stringify(w);return j.useEffect(()=>v(JSON.parse(E),{replace:t,state:s,relative:a}),[v,E,a,t,s]),null}function ns(n){en(!1)}function HE(n){let{basename:e="/",children:t=null,location:s,navigationType:a=Ci.Pop,navigator:l,static:d=!1,future:f}=n;Co()&&en(!1);let m=e.replace(/^\/*/,"/"),v=j.useMemo(()=>({basename:m,navigator:l,static:d,future:Al({v7_relativeSplatPath:!1},f)}),[m,f,l,d]);typeof s=="string"&&(s=Io(s));let{pathname:w="/",search:E="",hash:C="",state:$=null,key:q="default"}=s,Y=j.useMemo(()=>{let F=Lf(w,m);return F==null?null:{location:{pathname:F,search:E,hash:C,state:$,key:q},navigationType:a}},[m,w,E,C,$,q,a]);return Y==null?null:j.createElement(zi.Provider,{value:v},j.createElement(Bu.Provider,{children:t,value:Y}))}function GE(n){let{children:e,location:t}=n;return NE(sf(e),t)}new Promise(()=>{});function sf(n,e){e===void 0&&(e=[]);let t=[];return j.Children.forEach(n,(s,a)=>{if(!j.isValidElement(s))return;let l=[...e,a];if(s.type===j.Fragment){t.push.apply(t,sf(s.props.children,l));return}s.type!==ns&&en(!1),!s.props.index||!s.props.children||en(!1);let d={id:s.props.id||l.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(d.children=sf(s.props.children,l)),t.push(d)}),t}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function af(){return af=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},af.apply(this,arguments)}function KE(n,e){if(n==null)return{};var t={},s=Object.keys(n),a,l;for(l=0;l<s.length;l++)a=s[l],!(e.indexOf(a)>=0)&&(t[a]=n[a]);return t}function QE(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function YE(n,e){return n.button===0&&(!e||e==="_self")&&!QE(n)}const JE=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],XE="6";try{window.__reactRouterVersion=XE}catch{}const ZE="startTransition",ny=Kx[ZE];function eT(n){let{basename:e,children:t,future:s,window:a}=n,l=j.useRef();l.current==null&&(l.current=tE({window:a,v5Compat:!0}));let d=l.current,[f,m]=j.useState({action:d.action,location:d.location}),{v7_startTransition:v}=s||{},w=j.useCallback(E=>{v&&ny?ny(()=>m(E)):m(E)},[m,v]);return j.useLayoutEffect(()=>d.listen(w),[d,w]),j.useEffect(()=>WE(s),[s]),j.createElement(HE,{basename:e,children:t,location:f.location,navigationType:f.action,navigator:d,future:s})}const tT=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",nT=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ua=j.forwardRef(function(e,t){let{onClick:s,relative:a,reloadDocument:l,replace:d,state:f,target:m,to:v,preventScrollReset:w,viewTransition:E}=e,C=KE(e,JE),{basename:$}=j.useContext(zi),q,Y=!1;if(typeof v=="string"&&nT.test(v)&&(q=v,tT))try{let re=new URL(window.location.href),le=v.startsWith("//")?new URL(re.protocol+v):new URL(v),xe=Lf(le.pathname,$);le.origin===re.origin&&xe!=null?v=xe+le.search+le.hash:Y=!0}catch{}let F=RE(v,{relative:a}),X=rT(v,{replace:d,state:f,target:m,preventScrollReset:w,relative:a,viewTransition:E});function ge(re){s&&s(re),re.defaultPrevented||X(re)}return j.createElement("a",af({},C,{href:q||F,onClick:Y||l?s:ge,ref:t,target:m}))});var ry;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(ry||(ry={}));var sy;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(sy||(sy={}));function rT(n,e){let{target:t,replace:s,state:a,preventScrollReset:l,relative:d,viewTransition:f}=e===void 0?{}:e,m=$u(),v=Ul(),w=n_(n,{relative:d});return j.useCallback(E=>{if(YE(E,t)){E.preventDefault();let C=s!==void 0?s:Eu(v)===Eu(w);m(n,{replace:C,state:a,preventScrollReset:l,relative:d,viewTransition:f})}},[v,m,w,s,a,t,n,l,d,f])}const sT=()=>{};var iy={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a_=function(n){const e=[];let t=0;for(let s=0;s<n.length;s++){let a=n.charCodeAt(s);a<128?e[t++]=a:a<2048?(e[t++]=a>>6|192,e[t++]=a&63|128):(a&64512)===55296&&s+1<n.length&&(n.charCodeAt(s+1)&64512)===56320?(a=65536+((a&1023)<<10)+(n.charCodeAt(++s)&1023),e[t++]=a>>18|240,e[t++]=a>>12&63|128,e[t++]=a>>6&63|128,e[t++]=a&63|128):(e[t++]=a>>12|224,e[t++]=a>>6&63|128,e[t++]=a&63|128)}return e},iT=function(n){const e=[];let t=0,s=0;for(;t<n.length;){const a=n[t++];if(a<128)e[s++]=String.fromCharCode(a);else if(a>191&&a<224){const l=n[t++];e[s++]=String.fromCharCode((a&31)<<6|l&63)}else if(a>239&&a<365){const l=n[t++],d=n[t++],f=n[t++],m=((a&7)<<18|(l&63)<<12|(d&63)<<6|f&63)-65536;e[s++]=String.fromCharCode(55296+(m>>10)),e[s++]=String.fromCharCode(56320+(m&1023))}else{const l=n[t++],d=n[t++];e[s++]=String.fromCharCode((a&15)<<12|(l&63)<<6|d&63)}}return e.join("")},o_={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let a=0;a<n.length;a+=3){const l=n[a],d=a+1<n.length,f=d?n[a+1]:0,m=a+2<n.length,v=m?n[a+2]:0,w=l>>2,E=(l&3)<<4|f>>4;let C=(f&15)<<2|v>>6,$=v&63;m||($=64,d||(C=64)),s.push(t[w],t[E],t[C],t[$])}return s.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(a_(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):iT(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let a=0;a<n.length;){const l=t[n.charAt(a++)],f=a<n.length?t[n.charAt(a)]:0;++a;const v=a<n.length?t[n.charAt(a)]:64;++a;const E=a<n.length?t[n.charAt(a)]:64;if(++a,l==null||f==null||v==null||E==null)throw new aT;const C=l<<2|f>>4;if(s.push(C),v!==64){const $=f<<4&240|v>>2;if(s.push($),E!==64){const q=v<<6&192|E;s.push(q)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class aT extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const oT=function(n){const e=a_(n);return o_.encodeByteArray(e,!0)},Tu=function(n){return oT(n).replace(/\./g,"")},l_=function(n){try{return o_.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lT(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cT=()=>lT().__FIREBASE_DEFAULTS__,uT=()=>{if(typeof process>"u"||typeof iy>"u")return;const n=iy.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},dT=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&l_(n[1]);return e&&JSON.parse(e)},Wu=()=>{try{return sT()||cT()||uT()||dT()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},c_=n=>{var e,t;return(t=(e=Wu())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},hT=n=>{const e=c_(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),s]:[e.substring(0,t),s]},u_=()=>{var n;return(n=Wu())===null||n===void 0?void 0:n.config},d_=n=>{var e;return(e=Wu())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fT{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,s)=>{t?this.reject(t):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,s))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Po(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function h_(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pT(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},s=e||"demo-project",a=n.iat||0,l=n.sub||n.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d=Object.assign({iss:`https://securetoken.google.com/${s}`,aud:s,iat:a,exp:a+3600,auth_time:a,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Tu(JSON.stringify(t)),Tu(JSON.stringify(d)),""].join(".")}const Tl={};function mT(){const n={prod:[],emulator:[]};for(const e of Object.keys(Tl))Tl[e]?n.emulator.push(e):n.prod.push(e);return n}function gT(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let ay=!1;function f_(n,e){if(typeof window>"u"||typeof document>"u"||!Po(window.location.host)||Tl[n]===e||Tl[n]||ay)return;Tl[n]=e;function t(C){return`__firebase__banner__${C}`}const s="__firebase__banner",l=mT().prod.length>0;function d(){const C=document.getElementById(s);C&&C.remove()}function f(C){C.style.display="flex",C.style.background="#7faaf0",C.style.position="fixed",C.style.bottom="5px",C.style.left="5px",C.style.padding=".5em",C.style.borderRadius="5px",C.style.alignItems="center"}function m(C,$){C.setAttribute("width","24"),C.setAttribute("id",$),C.setAttribute("height","24"),C.setAttribute("viewBox","0 0 24 24"),C.setAttribute("fill","none"),C.style.marginLeft="-6px"}function v(){const C=document.createElement("span");return C.style.cursor="pointer",C.style.marginLeft="16px",C.style.fontSize="24px",C.innerHTML=" &times;",C.onclick=()=>{ay=!0,d()},C}function w(C,$){C.setAttribute("id",$),C.innerText="Learn more",C.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",C.setAttribute("target","__blank"),C.style.paddingLeft="5px",C.style.textDecoration="underline"}function E(){const C=gT(s),$=t("text"),q=document.getElementById($)||document.createElement("span"),Y=t("learnmore"),F=document.getElementById(Y)||document.createElement("a"),X=t("preprendIcon"),ge=document.getElementById(X)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(C.created){const re=C.element;f(re),w(F,Y);const le=v();m(ge,X),re.append(ge,q,F,le),document.body.appendChild(re)}l?(q.innerText="Preview backend disconnected.",ge.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(ge.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,q.innerText="Preview backend running in this workspace."),q.setAttribute("id",$)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",E):E()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function yT(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Wn())}function vT(){var n;const e=(n=Wu())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function _T(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function wT(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function xT(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function ET(){const n=Wn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function TT(){return!vT()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function ST(){try{return typeof indexedDB=="object"}catch{return!1}}function IT(){return new Promise((n,e)=>{try{let t=!0;const s="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(s);a.onsuccess=()=>{a.result.close(),t||self.indexedDB.deleteDatabase(s),n(!0)},a.onupgradeneeded=()=>{t=!1},a.onerror=()=>{var l;e(((l=a.error)===null||l===void 0?void 0:l.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CT="FirebaseError";class ni extends Error{constructor(e,t,s){super(t),this.code=e,this.customData=s,this.name=CT,Object.setPrototypeOf(this,ni.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,zl.prototype.create)}}class zl{constructor(e,t,s){this.service=e,this.serviceName=t,this.errors=s}create(e,...t){const s=t[0]||{},a=`${this.service}/${e}`,l=this.errors[e],d=l?PT(l,s):"Error",f=`${this.serviceName}: ${d} (${a}).`;return new ni(a,f,s)}}function PT(n,e){return n.replace(bT,(t,s)=>{const a=e[s];return a!=null?String(a):`<${s}?>`})}const bT=/\{\$([^}]+)}/g;function RT(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function ya(n,e){if(n===e)return!0;const t=Object.keys(n),s=Object.keys(e);for(const a of t){if(!s.includes(a))return!1;const l=n[a],d=e[a];if(oy(l)&&oy(d)){if(!ya(l,d))return!1}else if(l!==d)return!1}for(const a of s)if(!t.includes(a))return!1;return!0}function oy(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bl(n){const e=[];for(const[t,s]of Object.entries(n))Array.isArray(s)?s.forEach(a=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function gl(n){const e={};return n.replace(/^\?/,"").split("&").forEach(s=>{if(s){const[a,l]=s.split("=");e[decodeURIComponent(a)]=decodeURIComponent(l)}}),e}function yl(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function AT(n,e){const t=new NT(n,e);return t.subscribe.bind(t)}class NT{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,s){let a;if(e===void 0&&t===void 0&&s===void 0)throw new Error("Missing Observer.");kT(e,["next","error","complete"])?a=e:a={next:e,error:t,complete:s},a.next===void 0&&(a.next=$h),a.error===void 0&&(a.error=$h),a.complete===void 0&&(a.complete=$h);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function kT(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function $h(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gn(n){return n&&n._delegate?n._delegate:n}class va{constructor(e,t,s){this.name=e,this.instanceFactory=t,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const da="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jT{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const s=new fT;if(this.instancesDeferred.set(t,s),this.isInitialized(t)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:t});a&&s.resolve(a)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const s=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),a=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(s)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:s})}catch(l){if(a)return null;throw l}else{if(a)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(VT(e))try{this.getOrInitializeService({instanceIdentifier:da})}catch{}for(const[t,s]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(t);try{const l=this.getOrInitializeService({instanceIdentifier:a});s.resolve(l)}catch{}}}}clearInstance(e=da){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=da){return this.instances.has(e)}getOptions(e=da){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:s,options:t});for(const[l,d]of this.instancesDeferred.entries()){const f=this.normalizeInstanceIdentifier(l);s===f&&d.resolve(a)}return a}onInit(e,t){var s;const a=this.normalizeInstanceIdentifier(t),l=(s=this.onInitCallbacks.get(a))!==null&&s!==void 0?s:new Set;l.add(e),this.onInitCallbacks.set(a,l);const d=this.instances.get(a);return d&&e(d,a),()=>{l.delete(e)}}invokeOnInitCallbacks(e,t){const s=this.onInitCallbacks.get(t);if(s)for(const a of s)try{a(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:DT(e),options:t}),this.instances.set(e,s),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=da){return this.component?this.component.multipleInstances?e:da:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function DT(n){return n===da?void 0:n}function VT(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LT{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new jT(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var lt;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(lt||(lt={}));const OT={debug:lt.DEBUG,verbose:lt.VERBOSE,info:lt.INFO,warn:lt.WARN,error:lt.ERROR,silent:lt.SILENT},MT=lt.INFO,FT={[lt.DEBUG]:"log",[lt.VERBOSE]:"log",[lt.INFO]:"info",[lt.WARN]:"warn",[lt.ERROR]:"error"},UT=(n,e,...t)=>{if(e<n.logLevel)return;const s=new Date().toISOString(),a=FT[e];if(a)console[a](`[${s}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Uf{constructor(e){this.name=e,this._logLevel=MT,this._logHandler=UT,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in lt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?OT[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,lt.DEBUG,...e),this._logHandler(this,lt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,lt.VERBOSE,...e),this._logHandler(this,lt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,lt.INFO,...e),this._logHandler(this,lt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,lt.WARN,...e),this._logHandler(this,lt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,lt.ERROR,...e),this._logHandler(this,lt.ERROR,...e)}}const zT=(n,e)=>e.some(t=>n instanceof t);let ly,cy;function BT(){return ly||(ly=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function $T(){return cy||(cy=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const p_=new WeakMap,of=new WeakMap,m_=new WeakMap,Wh=new WeakMap,zf=new WeakMap;function WT(n){const e=new Promise((t,s)=>{const a=()=>{n.removeEventListener("success",l),n.removeEventListener("error",d)},l=()=>{t(Ri(n.result)),a()},d=()=>{s(n.error),a()};n.addEventListener("success",l),n.addEventListener("error",d)});return e.then(t=>{t instanceof IDBCursor&&p_.set(t,n)}).catch(()=>{}),zf.set(e,n),e}function qT(n){if(of.has(n))return;const e=new Promise((t,s)=>{const a=()=>{n.removeEventListener("complete",l),n.removeEventListener("error",d),n.removeEventListener("abort",d)},l=()=>{t(),a()},d=()=>{s(n.error||new DOMException("AbortError","AbortError")),a()};n.addEventListener("complete",l),n.addEventListener("error",d),n.addEventListener("abort",d)});of.set(n,e)}let lf={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return of.get(n);if(e==="objectStoreNames")return n.objectStoreNames||m_.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Ri(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function HT(n){lf=n(lf)}function GT(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const s=n.call(qh(this),e,...t);return m_.set(s,e.sort?e.sort():[e]),Ri(s)}:$T().includes(n)?function(...e){return n.apply(qh(this),e),Ri(p_.get(this))}:function(...e){return Ri(n.apply(qh(this),e))}}function KT(n){return typeof n=="function"?GT(n):(n instanceof IDBTransaction&&qT(n),zT(n,BT())?new Proxy(n,lf):n)}function Ri(n){if(n instanceof IDBRequest)return WT(n);if(Wh.has(n))return Wh.get(n);const e=KT(n);return e!==n&&(Wh.set(n,e),zf.set(e,n)),e}const qh=n=>zf.get(n);function QT(n,e,{blocked:t,upgrade:s,blocking:a,terminated:l}={}){const d=indexedDB.open(n,e),f=Ri(d);return s&&d.addEventListener("upgradeneeded",m=>{s(Ri(d.result),m.oldVersion,m.newVersion,Ri(d.transaction),m)}),t&&d.addEventListener("blocked",m=>t(m.oldVersion,m.newVersion,m)),f.then(m=>{l&&m.addEventListener("close",()=>l()),a&&m.addEventListener("versionchange",v=>a(v.oldVersion,v.newVersion,v))}).catch(()=>{}),f}const YT=["get","getKey","getAll","getAllKeys","count"],JT=["put","add","delete","clear"],Hh=new Map;function uy(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Hh.get(e))return Hh.get(e);const t=e.replace(/FromIndex$/,""),s=e!==t,a=JT.includes(t);if(!(t in(s?IDBIndex:IDBObjectStore).prototype)||!(a||YT.includes(t)))return;const l=async function(d,...f){const m=this.transaction(d,a?"readwrite":"readonly");let v=m.store;return s&&(v=v.index(f.shift())),(await Promise.all([v[t](...f),a&&m.done]))[0]};return Hh.set(e,l),l}HT(n=>({...n,get:(e,t,s)=>uy(e,t)||n.get(e,t,s),has:(e,t)=>!!uy(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XT{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(ZT(t)){const s=t.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(t=>t).join(" ")}}function ZT(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const cf="@firebase/app",dy="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xs=new Uf("@firebase/app"),eS="@firebase/app-compat",tS="@firebase/analytics-compat",nS="@firebase/analytics",rS="@firebase/app-check-compat",sS="@firebase/app-check",iS="@firebase/auth",aS="@firebase/auth-compat",oS="@firebase/database",lS="@firebase/data-connect",cS="@firebase/database-compat",uS="@firebase/functions",dS="@firebase/functions-compat",hS="@firebase/installations",fS="@firebase/installations-compat",pS="@firebase/messaging",mS="@firebase/messaging-compat",gS="@firebase/performance",yS="@firebase/performance-compat",vS="@firebase/remote-config",_S="@firebase/remote-config-compat",wS="@firebase/storage",xS="@firebase/storage-compat",ES="@firebase/firestore",TS="@firebase/ai",SS="@firebase/firestore-compat",IS="firebase",CS="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uf="[DEFAULT]",PS={[cf]:"fire-core",[eS]:"fire-core-compat",[nS]:"fire-analytics",[tS]:"fire-analytics-compat",[sS]:"fire-app-check",[rS]:"fire-app-check-compat",[iS]:"fire-auth",[aS]:"fire-auth-compat",[oS]:"fire-rtdb",[lS]:"fire-data-connect",[cS]:"fire-rtdb-compat",[uS]:"fire-fn",[dS]:"fire-fn-compat",[hS]:"fire-iid",[fS]:"fire-iid-compat",[pS]:"fire-fcm",[mS]:"fire-fcm-compat",[gS]:"fire-perf",[yS]:"fire-perf-compat",[vS]:"fire-rc",[_S]:"fire-rc-compat",[wS]:"fire-gcs",[xS]:"fire-gcs-compat",[ES]:"fire-fst",[SS]:"fire-fst-compat",[TS]:"fire-vertex","fire-js":"fire-js",[IS]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Su=new Map,bS=new Map,df=new Map;function hy(n,e){try{n.container.addComponent(e)}catch(t){Xs.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function vo(n){const e=n.name;if(df.has(e))return Xs.debug(`There were multiple attempts to register component ${e}.`),!1;df.set(e,n);for(const t of Su.values())hy(t,n);for(const t of bS.values())hy(t,n);return!0}function Bf(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function wr(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RS={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ai=new zl("app","Firebase",RS);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AS{constructor(e,t,s){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new va("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ai.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bo=CS;function g_(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const s=Object.assign({name:uf,automaticDataCollectionEnabled:!0},e),a=s.name;if(typeof a!="string"||!a)throw Ai.create("bad-app-name",{appName:String(a)});if(t||(t=u_()),!t)throw Ai.create("no-options");const l=Su.get(a);if(l){if(ya(t,l.options)&&ya(s,l.config))return l;throw Ai.create("duplicate-app",{appName:a})}const d=new LT(a);for(const m of df.values())d.addComponent(m);const f=new AS(t,s,d);return Su.set(a,f),f}function y_(n=uf){const e=Su.get(n);if(!e&&n===uf&&u_())return g_();if(!e)throw Ai.create("no-app",{appName:n});return e}function Ni(n,e,t){var s;let a=(s=PS[n])!==null&&s!==void 0?s:n;t&&(a+=`-${t}`);const l=a.match(/\s|\//),d=e.match(/\s|\//);if(l||d){const f=[`Unable to register library "${a}" with version "${e}":`];l&&f.push(`library name "${a}" contains illegal characters (whitespace or "/")`),l&&d&&f.push("and"),d&&f.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Xs.warn(f.join(" "));return}vo(new va(`${a}-version`,()=>({library:a,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NS="firebase-heartbeat-database",kS=1,Nl="firebase-heartbeat-store";let Gh=null;function v_(){return Gh||(Gh=QT(NS,kS,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Nl)}catch(t){console.warn(t)}}}}).catch(n=>{throw Ai.create("idb-open",{originalErrorMessage:n.message})})),Gh}async function jS(n){try{const t=(await v_()).transaction(Nl),s=await t.objectStore(Nl).get(__(n));return await t.done,s}catch(e){if(e instanceof ni)Xs.warn(e.message);else{const t=Ai.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Xs.warn(t.message)}}}async function fy(n,e){try{const s=(await v_()).transaction(Nl,"readwrite");await s.objectStore(Nl).put(e,__(n)),await s.done}catch(t){if(t instanceof ni)Xs.warn(t.message);else{const s=Ai.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Xs.warn(s.message)}}}function __(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DS=1024,VS=30;class LS{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new MS(t),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){var e,t;try{const a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),l=py();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===l||this._heartbeatsCache.heartbeats.some(d=>d.date===l))return;if(this._heartbeatsCache.heartbeats.push({date:l,agent:a}),this._heartbeatsCache.heartbeats.length>VS){const d=FS(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(d,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(s){Xs.warn(s)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=py(),{heartbeatsToSend:s,unsentEntries:a}=OS(this._heartbeatsCache.heartbeats),l=Tu(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=t,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(t){return Xs.warn(t),""}}}function py(){return new Date().toISOString().substring(0,10)}function OS(n,e=DS){const t=[];let s=n.slice();for(const a of n){const l=t.find(d=>d.agent===a.agent);if(l){if(l.dates.push(a.date),my(t)>e){l.dates.pop();break}}else if(t.push({agent:a.agent,dates:[a.date]}),my(t)>e){t.pop();break}s=s.slice(1)}return{heartbeatsToSend:t,unsentEntries:s}}class MS{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return ST()?IT().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await jS(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const a=await this.read();return fy(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:a.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const a=await this.read();return fy(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:a.lastSentHeartbeatDate,heartbeats:[...a.heartbeats,...e.heartbeats]})}else return}}function my(n){return Tu(JSON.stringify({version:2,heartbeats:n})).length}function FS(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let s=1;s<n.length;s++)n[s].date<t&&(t=n[s].date,e=s);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function US(n){vo(new va("platform-logger",e=>new XT(e),"PRIVATE")),vo(new va("heartbeat",e=>new LS(e),"PRIVATE")),Ni(cf,dy,n),Ni(cf,dy,"esm2017"),Ni("fire-js","")}US("");var zS="firebase",BS="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ni(zS,BS,"app");function $f(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(n);a<s.length;a++)e.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(n,s[a])&&(t[s[a]]=n[s[a]]);return t}function w_(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const $S=w_,x_=new zl("auth","Firebase",w_());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iu=new Uf("@firebase/auth");function WS(n,...e){Iu.logLevel<=lt.WARN&&Iu.warn(`Auth (${bo}): ${n}`,...e)}function du(n,...e){Iu.logLevel<=lt.ERROR&&Iu.error(`Auth (${bo}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Or(n,...e){throw qf(n,...e)}function ss(n,...e){return qf(n,...e)}function Wf(n,e,t){const s=Object.assign(Object.assign({},$S()),{[e]:t});return new zl("auth","Firebase",s).create(e,{appName:n.name})}function Qs(n){return Wf(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function qS(n,e,t){const s=t;if(!(e instanceof s))throw s.name!==e.constructor.name&&Or(n,"argument-error"),Wf(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function qf(n,...e){if(typeof n!="string"){const t=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=n.name),n._errorFactory.create(t,...s)}return x_.create(n,...e)}function qe(n,e,...t){if(!n)throw qf(e,...t)}function Gs(n){const e="INTERNAL ASSERTION FAILED: "+n;throw du(e),new Error(e)}function Zs(n,e){n||Gs(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hf(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function HS(){return gy()==="http:"||gy()==="https:"}function gy(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GS(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(HS()||wT()||"connection"in navigator)?navigator.onLine:!0}function KS(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $l{constructor(e,t){this.shortDelay=e,this.longDelay=t,Zs(t>e,"Short delay should be less than long delay!"),this.isMobile=yT()||xT()}get(){return GS()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hf(n,e){Zs(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E_{static initialize(e,t,s){this.fetchImpl=e,t&&(this.headersImpl=t),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Gs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Gs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Gs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QS={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YS=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],JS=new $l(3e4,6e4);function $i(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function ri(n,e,t,s,a={}){return T_(n,a,async()=>{let l={},d={};s&&(e==="GET"?d=s:l={body:JSON.stringify(s)});const f=Bl(Object.assign({key:n.config.apiKey},d)).slice(1),m=await n._getAdditionalHeaders();m["Content-Type"]="application/json",n.languageCode&&(m["X-Firebase-Locale"]=n.languageCode);const v=Object.assign({method:e,headers:m},l);return _T()||(v.referrerPolicy="no-referrer"),n.emulatorConfig&&Po(n.emulatorConfig.host)&&(v.credentials="include"),E_.fetch()(await S_(n,n.config.apiHost,t,f),v)})}async function T_(n,e,t){n._canInitEmulator=!1;const s=Object.assign(Object.assign({},QS),e);try{const a=new ZS(n),l=await Promise.race([t(),a.promise]);a.clearNetworkTimeout();const d=await l.json();if("needConfirmation"in d)throw iu(n,"account-exists-with-different-credential",d);if(l.ok&&!("errorMessage"in d))return d;{const f=l.ok?d.errorMessage:d.error.message,[m,v]=f.split(" : ");if(m==="FEDERATED_USER_ID_ALREADY_LINKED")throw iu(n,"credential-already-in-use",d);if(m==="EMAIL_EXISTS")throw iu(n,"email-already-in-use",d);if(m==="USER_DISABLED")throw iu(n,"user-disabled",d);const w=s[m]||m.toLowerCase().replace(/[_\s]+/g,"-");if(v)throw Wf(n,w,v);Or(n,w)}}catch(a){if(a instanceof ni)throw a;Or(n,"network-request-failed",{message:String(a)})}}async function Wl(n,e,t,s,a={}){const l=await ri(n,e,t,s,a);return"mfaPendingCredential"in l&&Or(n,"multi-factor-auth-required",{_serverResponse:l}),l}async function S_(n,e,t,s){const a=`${e}${t}?${s}`,l=n,d=l.config.emulator?Hf(n.config,a):`${n.config.apiScheme}://${a}`;return YS.includes(t)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(d).toString():d}function XS(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class ZS{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,s)=>{this.timer=setTimeout(()=>s(ss(this.auth,"network-request-failed")),JS.get())})}}function iu(n,e,t){const s={appName:n.name};t.email&&(s.email=t.email),t.phoneNumber&&(s.phoneNumber=t.phoneNumber);const a=ss(n,e,s);return a.customData._tokenResponse=t,a}function yy(n){return n!==void 0&&n.enterprise!==void 0}class e1{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return XS(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function t1(n,e){return ri(n,"GET","/v2/recaptchaConfig",$i(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function n1(n,e){return ri(n,"POST","/v1/accounts:delete",e)}async function Cu(n,e){return ri(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sl(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function r1(n,e=!1){const t=gn(n),s=await t.getIdToken(e),a=Gf(s);qe(a&&a.exp&&a.auth_time&&a.iat,t.auth,"internal-error");const l=typeof a.firebase=="object"?a.firebase:void 0,d=l==null?void 0:l.sign_in_provider;return{claims:a,token:s,authTime:Sl(Kh(a.auth_time)),issuedAtTime:Sl(Kh(a.iat)),expirationTime:Sl(Kh(a.exp)),signInProvider:d||null,signInSecondFactor:(l==null?void 0:l.sign_in_second_factor)||null}}function Kh(n){return Number(n)*1e3}function Gf(n){const[e,t,s]=n.split(".");if(e===void 0||t===void 0||s===void 0)return du("JWT malformed, contained fewer than 3 sections"),null;try{const a=l_(t);return a?JSON.parse(a):(du("Failed to decode base64 JWT payload"),null)}catch(a){return du("Caught error parsing JWT payload as JSON",a==null?void 0:a.toString()),null}}function vy(n){const e=Gf(n);return qe(e,"internal-error"),qe(typeof e.exp<"u","internal-error"),qe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _o(n,e,t=!1){if(t)return e;try{return await e}catch(s){throw s instanceof ni&&s1(s)&&n.auth.currentUser===n&&await n.auth.signOut(),s}}function s1({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i1{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const s=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),s}else{this.errorBackoff=3e4;const a=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,a)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ff{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Sl(this.lastLoginAt),this.creationTime=Sl(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Pu(n){var e;const t=n.auth,s=await n.getIdToken(),a=await _o(n,Cu(t,{idToken:s}));qe(a==null?void 0:a.users.length,t,"internal-error");const l=a.users[0];n._notifyReloadListener(l);const d=!((e=l.providerUserInfo)===null||e===void 0)&&e.length?I_(l.providerUserInfo):[],f=o1(n.providerData,d),m=n.isAnonymous,v=!(n.email&&l.passwordHash)&&!(f!=null&&f.length),w=m?v:!1,E={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:f,metadata:new ff(l.createdAt,l.lastLoginAt),isAnonymous:w};Object.assign(n,E)}async function a1(n){const e=gn(n);await Pu(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function o1(n,e){return[...n.filter(s=>!e.some(a=>a.providerId===s.providerId)),...e]}function I_(n){return n.map(e=>{var{providerId:t}=e,s=$f(e,["providerId"]);return{providerId:t,uid:s.rawId||"",displayName:s.displayName||null,email:s.email||null,phoneNumber:s.phoneNumber||null,photoURL:s.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function l1(n,e){const t=await T_(n,{},async()=>{const s=Bl({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:l}=n.config,d=await S_(n,a,"/v1/token",`key=${l}`),f=await n._getAdditionalHeaders();f["Content-Type"]="application/x-www-form-urlencoded";const m={method:"POST",headers:f,body:s};return n.emulatorConfig&&Po(n.emulatorConfig.host)&&(m.credentials="include"),E_.fetch()(d,m)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function c1(n,e){return ri(n,"POST","/v2/accounts:revokeToken",$i(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){qe(e.idToken,"internal-error"),qe(typeof e.idToken<"u","internal-error"),qe(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):vy(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){qe(e.length!==0,"internal-error");const t=vy(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(qe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:s,refreshToken:a,expiresIn:l}=await l1(e,t);this.updateTokensAndExpiration(s,a,Number(l))}updateTokensAndExpiration(e,t,s){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,t){const{refreshToken:s,accessToken:a,expirationTime:l}=t,d=new fo;return s&&(qe(typeof s=="string","internal-error",{appName:e}),d.refreshToken=s),a&&(qe(typeof a=="string","internal-error",{appName:e}),d.accessToken=a),l&&(qe(typeof l=="number","internal-error",{appName:e}),d.expirationTime=l),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new fo,this.toJSON())}_performRefresh(){return Gs("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xi(n,e){qe(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class rs{constructor(e){var{uid:t,auth:s,stsTokenManager:a}=e,l=$f(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new i1(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=s,this.stsTokenManager=a,this.accessToken=a.accessToken,this.displayName=l.displayName||null,this.email=l.email||null,this.emailVerified=l.emailVerified||!1,this.phoneNumber=l.phoneNumber||null,this.photoURL=l.photoURL||null,this.isAnonymous=l.isAnonymous||!1,this.tenantId=l.tenantId||null,this.providerData=l.providerData?[...l.providerData]:[],this.metadata=new ff(l.createdAt||void 0,l.lastLoginAt||void 0)}async getIdToken(e){const t=await _o(this,this.stsTokenManager.getToken(this.auth,e));return qe(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return r1(this,e)}reload(){return a1(this)}_assign(e){this!==e&&(qe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new rs(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){qe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),t&&await Pu(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(wr(this.auth.app))return Promise.reject(Qs(this.auth));const e=await this.getIdToken();return await _o(this,n1(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var s,a,l,d,f,m,v,w;const E=(s=t.displayName)!==null&&s!==void 0?s:void 0,C=(a=t.email)!==null&&a!==void 0?a:void 0,$=(l=t.phoneNumber)!==null&&l!==void 0?l:void 0,q=(d=t.photoURL)!==null&&d!==void 0?d:void 0,Y=(f=t.tenantId)!==null&&f!==void 0?f:void 0,F=(m=t._redirectEventId)!==null&&m!==void 0?m:void 0,X=(v=t.createdAt)!==null&&v!==void 0?v:void 0,ge=(w=t.lastLoginAt)!==null&&w!==void 0?w:void 0,{uid:re,emailVerified:le,isAnonymous:xe,providerData:Se,stsTokenManager:N}=t;qe(re&&N,e,"internal-error");const R=fo.fromJSON(this.name,N);qe(typeof re=="string",e,"internal-error"),xi(E,e.name),xi(C,e.name),qe(typeof le=="boolean",e,"internal-error"),qe(typeof xe=="boolean",e,"internal-error"),xi($,e.name),xi(q,e.name),xi(Y,e.name),xi(F,e.name),xi(X,e.name),xi(ge,e.name);const k=new rs({uid:re,auth:e,email:C,emailVerified:le,displayName:E,isAnonymous:xe,photoURL:q,phoneNumber:$,tenantId:Y,stsTokenManager:R,createdAt:X,lastLoginAt:ge});return Se&&Array.isArray(Se)&&(k.providerData=Se.map(L=>Object.assign({},L))),F&&(k._redirectEventId=F),k}static async _fromIdTokenResponse(e,t,s=!1){const a=new fo;a.updateFromServerResponse(t);const l=new rs({uid:t.localId,auth:e,stsTokenManager:a,isAnonymous:s});return await Pu(l),l}static async _fromGetAccountInfoResponse(e,t,s){const a=t.users[0];qe(a.localId!==void 0,"internal-error");const l=a.providerUserInfo!==void 0?I_(a.providerUserInfo):[],d=!(a.email&&a.passwordHash)&&!(l!=null&&l.length),f=new fo;f.updateFromIdToken(s);const m=new rs({uid:a.localId,auth:e,stsTokenManager:f,isAnonymous:d}),v={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new ff(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!(l!=null&&l.length)};return Object.assign(m,v),m}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _y=new Map;function Ks(n){Zs(n instanceof Function,"Expected a class definition");let e=_y.get(n);return e?(Zs(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,_y.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C_{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}C_.type="NONE";const wy=C_;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hu(n,e,t){return`firebase:${n}:${e}:${t}`}class po{constructor(e,t,s){this.persistence=e,this.auth=t,this.userKey=s;const{config:a,name:l}=this.auth;this.fullUserKey=hu(this.userKey,a.apiKey,l),this.fullPersistenceKey=hu("persistence",a.apiKey,l),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Cu(this.auth,{idToken:e}).catch(()=>{});return t?rs._fromGetAccountInfoResponse(this.auth,t,e):null}return rs._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,s="authUser"){if(!t.length)return new po(Ks(wy),e,s);const a=(await Promise.all(t.map(async v=>{if(await v._isAvailable())return v}))).filter(v=>v);let l=a[0]||Ks(wy);const d=hu(s,e.config.apiKey,e.name);let f=null;for(const v of t)try{const w=await v._get(d);if(w){let E;if(typeof w=="string"){const C=await Cu(e,{idToken:w}).catch(()=>{});if(!C)break;E=await rs._fromGetAccountInfoResponse(e,C,w)}else E=rs._fromJSON(e,w);v!==l&&(f=E),l=v;break}}catch{}const m=a.filter(v=>v._shouldAllowMigration);return!l._shouldAllowMigration||!m.length?new po(l,e,s):(l=m[0],f&&await l._set(d,f.toJSON()),await Promise.all(t.map(async v=>{if(v!==l)try{await v._remove(d)}catch{}})),new po(l,e,s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xy(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(A_(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(P_(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(k_(e))return"Blackberry";if(j_(e))return"Webos";if(b_(e))return"Safari";if((e.includes("chrome/")||R_(e))&&!e.includes("edge/"))return"Chrome";if(N_(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=n.match(t);if((s==null?void 0:s.length)===2)return s[1]}return"Other"}function P_(n=Wn()){return/firefox\//i.test(n)}function b_(n=Wn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function R_(n=Wn()){return/crios\//i.test(n)}function A_(n=Wn()){return/iemobile/i.test(n)}function N_(n=Wn()){return/android/i.test(n)}function k_(n=Wn()){return/blackberry/i.test(n)}function j_(n=Wn()){return/webos/i.test(n)}function Kf(n=Wn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function u1(n=Wn()){var e;return Kf(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function d1(){return ET()&&document.documentMode===10}function D_(n=Wn()){return Kf(n)||N_(n)||j_(n)||k_(n)||/windows phone/i.test(n)||A_(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V_(n,e=[]){let t;switch(n){case"Browser":t=xy(Wn());break;case"Worker":t=`${xy(Wn())}-${n}`;break;default:t=n}const s=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${bo}/${s}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h1{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const s=l=>new Promise((d,f)=>{try{const m=e(l);d(m)}catch(m){f(m)}});s.onAbort=t,this.queue.push(s);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const s of this.queue)await s(e),s.onAbort&&t.push(s.onAbort)}catch(s){t.reverse();for(const a of t)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s==null?void 0:s.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function f1(n,e={}){return ri(n,"GET","/v2/passwordPolicy",$i(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p1=6;class m1{constructor(e){var t,s,a,l;const d=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=d.minPasswordLength)!==null&&t!==void 0?t:p1,d.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=d.maxPasswordLength),d.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=d.containsLowercaseCharacter),d.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=d.containsUppercaseCharacter),d.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=d.containsNumericCharacter),d.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=d.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(a=(s=e.allowedNonAlphanumericCharacters)===null||s===void 0?void 0:s.join(""))!==null&&a!==void 0?a:"",this.forceUpgradeOnSignin=(l=e.forceUpgradeOnSignin)!==null&&l!==void 0?l:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,s,a,l,d,f;const m={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,m),this.validatePasswordCharacterOptions(e,m),m.isValid&&(m.isValid=(t=m.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),m.isValid&&(m.isValid=(s=m.meetsMaxPasswordLength)!==null&&s!==void 0?s:!0),m.isValid&&(m.isValid=(a=m.containsLowercaseLetter)!==null&&a!==void 0?a:!0),m.isValid&&(m.isValid=(l=m.containsUppercaseLetter)!==null&&l!==void 0?l:!0),m.isValid&&(m.isValid=(d=m.containsNumericCharacter)!==null&&d!==void 0?d:!0),m.isValid&&(m.isValid=(f=m.containsNonAlphanumericCharacter)!==null&&f!==void 0?f:!0),m}validatePasswordLengthOptions(e,t){const s=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;s&&(t.meetsMinPasswordLength=e.length>=s),a&&(t.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let s;for(let a=0;a<e.length;a++)s=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(t,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,t,s,a,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g1{constructor(e,t,s,a){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=s,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ey(this),this.idTokenSubscription=new Ey(this),this.beforeStateQueue=new h1(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=x_,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Ks(t)),this._initializationPromise=this.queue(async()=>{var s,a,l;if(!this._deleted&&(this.persistenceManager=await po.create(this,e),(s=this._resolvePersistenceManagerAvailable)===null||s===void 0||s.call(this),!this._deleted)){if(!((a=this._popupRedirectResolver)===null||a===void 0)&&a._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((l=this.currentUser)===null||l===void 0?void 0:l.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Cu(this,{idToken:e}),s=await rs._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(s)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(wr(this.app)){const d=this.app.settings.authIdToken;return d?new Promise(f=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(d).then(f,f))}):this.directlySetCurrentUser(null)}const s=await this.assertedPersistence.getCurrentUser();let a=s,l=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const d=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,f=a==null?void 0:a._redirectEventId,m=await this.tryRedirectSignIn(e);(!d||d===f)&&(m!=null&&m.user)&&(a=m.user,l=!0)}if(!a)return this.directlySetCurrentUser(null);if(!a._redirectEventId){if(l)try{await this.beforeStateQueue.runMiddleware(a)}catch(d){a=s,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(d))}return a?this.reloadAndSetCurrentUserOrClear(a):this.directlySetCurrentUser(null)}return qe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===a._redirectEventId?this.directlySetCurrentUser(a):this.reloadAndSetCurrentUserOrClear(a)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Pu(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=KS()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(wr(this.app))return Promise.reject(Qs(this));const t=e?gn(e):null;return t&&qe(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&qe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return wr(this.app)?Promise.reject(Qs(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return wr(this.app)?Promise.reject(Qs(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ks(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await f1(this),t=new m1(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new zl("auth","Firebase",e())}onAuthStateChanged(e,t,s){return this.registerStateListener(this.authStateSubscription,e,t,s)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,s){return this.registerStateListener(this.idTokenSubscription,e,t,s)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(s.tenantId=this.tenantId),await c1(this,s)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const s=await this.getOrInitRedirectPersistenceManager(t);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Ks(e)||this._popupRedirectResolver;qe(t,this,"argument-error"),this.redirectPersistenceManager=await po.create(this,[Ks(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,s;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((s=this.redirectUser)===null||s===void 0?void 0:s._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const s=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==s&&(this.lastNotifiedUid=s,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,s,a){if(this._deleted)return()=>{};const l=typeof t=="function"?t:t.next.bind(t);let d=!1;const f=this._isInitialized?Promise.resolve():this._initializationPromise;if(qe(f,this,"internal-error"),f.then(()=>{d||l(this.currentUser)}),typeof t=="function"){const m=e.addObserver(t,s,a);return()=>{d=!0,m()}}else{const m=e.addObserver(t);return()=>{d=!0,m()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return qe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=V_(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const s=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());s&&(t["X-Firebase-Client"]=s);const a=await this._getAppCheckToken();return a&&(t["X-Firebase-AppCheck"]=a),t}async _getAppCheckToken(){var e;if(wr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&WS(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function Wi(n){return gn(n)}class Ey{constructor(e){this.auth=e,this.observer=null,this.addObserver=AT(t=>this.observer=t)}get next(){return qe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let qu={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function y1(n){qu=n}function L_(n){return qu.loadJS(n)}function v1(){return qu.recaptchaEnterpriseScript}function _1(){return qu.gapiScript}function w1(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class x1{constructor(){this.enterprise=new E1}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class E1{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const T1="recaptcha-enterprise",O_="NO_RECAPTCHA";class S1{constructor(e){this.type=T1,this.auth=Wi(e)}async verify(e="verify",t=!1){async function s(l){if(!t){if(l.tenantId==null&&l._agentRecaptchaConfig!=null)return l._agentRecaptchaConfig.siteKey;if(l.tenantId!=null&&l._tenantRecaptchaConfigs[l.tenantId]!==void 0)return l._tenantRecaptchaConfigs[l.tenantId].siteKey}return new Promise(async(d,f)=>{t1(l,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(m=>{if(m.recaptchaKey===void 0)f(new Error("recaptcha Enterprise site key undefined"));else{const v=new e1(m);return l.tenantId==null?l._agentRecaptchaConfig=v:l._tenantRecaptchaConfigs[l.tenantId]=v,d(v.siteKey)}}).catch(m=>{f(m)})})}function a(l,d,f){const m=window.grecaptcha;yy(m)?m.enterprise.ready(()=>{m.enterprise.execute(l,{action:e}).then(v=>{d(v)}).catch(()=>{d(O_)})}):f(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new x1().execute("siteKey",{action:"verify"}):new Promise((l,d)=>{s(this.auth).then(f=>{if(!t&&yy(window.grecaptcha))a(f,l,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let m=v1();m.length!==0&&(m+=f),L_(m).then(()=>{a(f,l,d)}).catch(v=>{d(v)})}}).catch(f=>{d(f)})})}}async function Ty(n,e,t,s=!1,a=!1){const l=new S1(n);let d;if(a)d=O_;else try{d=await l.verify(t)}catch{d=await l.verify(t,!0)}const f=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in f){const m=f.phoneEnrollmentInfo.phoneNumber,v=f.phoneEnrollmentInfo.recaptchaToken;Object.assign(f,{phoneEnrollmentInfo:{phoneNumber:m,recaptchaToken:v,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in f){const m=f.phoneSignInInfo.recaptchaToken;Object.assign(f,{phoneSignInInfo:{recaptchaToken:m,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return f}return s?Object.assign(f,{captchaResp:d}):Object.assign(f,{captchaResponse:d}),Object.assign(f,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(f,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),f}async function pf(n,e,t,s,a){var l;if(!((l=n._getRecaptchaConfig())===null||l===void 0)&&l.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const d=await Ty(n,e,t,t==="getOobCode");return s(n,d)}else return s(n,e).catch(async d=>{if(d.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const f=await Ty(n,e,t,t==="getOobCode");return s(n,f)}else return Promise.reject(d)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I1(n,e){const t=Bf(n,"auth");if(t.isInitialized()){const a=t.getImmediate(),l=t.getOptions();if(ya(l,e??{}))return a;Or(a,"already-initialized")}return t.initialize({options:e})}function C1(n,e){const t=(e==null?void 0:e.persistence)||[],s=(Array.isArray(t)?t:[t]).map(Ks);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(s,e==null?void 0:e.popupRedirectResolver)}function P1(n,e,t){const s=Wi(n);qe(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const a=!1,l=M_(e),{host:d,port:f}=b1(e),m=f===null?"":`:${f}`,v={url:`${l}//${d}${m}/`},w=Object.freeze({host:d,port:f,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!s._canInitEmulator){qe(s.config.emulator&&s.emulatorConfig,s,"emulator-config-failed"),qe(ya(v,s.config.emulator)&&ya(w,s.emulatorConfig),s,"emulator-config-failed");return}s.config.emulator=v,s.emulatorConfig=w,s.settings.appVerificationDisabledForTesting=!0,Po(d)?(h_(`${l}//${d}${m}`),f_("Auth",!0)):R1()}function M_(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function b1(n){const e=M_(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const s=t[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(s);if(a){const l=a[1];return{host:l,port:Sy(s.substr(l.length+1))}}else{const[l,d]=s.split(":");return{host:l,port:Sy(d)}}}function Sy(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function R1(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qf{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Gs("not implemented")}_getIdTokenResponse(e){return Gs("not implemented")}_linkToIdToken(e,t){return Gs("not implemented")}_getReauthenticationResolver(e){return Gs("not implemented")}}async function A1(n,e){return ri(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function N1(n,e){return Wl(n,"POST","/v1/accounts:signInWithPassword",$i(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function k1(n,e){return Wl(n,"POST","/v1/accounts:signInWithEmailLink",$i(n,e))}async function j1(n,e){return Wl(n,"POST","/v1/accounts:signInWithEmailLink",$i(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kl extends Qf{constructor(e,t,s,a=null){super("password",s),this._email=e,this._password=t,this._tenantId=a}static _fromEmailAndPassword(e,t){return new kl(e,t,"password")}static _fromEmailAndCode(e,t,s=null){return new kl(e,t,"emailLink",s)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return pf(e,t,"signInWithPassword",N1);case"emailLink":return k1(e,{email:this._email,oobCode:this._password});default:Or(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const s={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return pf(e,s,"signUpPassword",A1);case"emailLink":return j1(e,{idToken:t,email:this._email,oobCode:this._password});default:Or(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mo(n,e){return Wl(n,"POST","/v1/accounts:signInWithIdp",$i(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D1="http://localhost";class _a extends Qf{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new _a(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Or("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:a}=t,l=$f(t,["providerId","signInMethod"]);if(!s||!a)return null;const d=new _a(s,a);return d.idToken=l.idToken||void 0,d.accessToken=l.accessToken||void 0,d.secret=l.secret,d.nonce=l.nonce,d.pendingToken=l.pendingToken||null,d}_getIdTokenResponse(e){const t=this.buildRequest();return mo(e,t)}_linkToIdToken(e,t){const s=this.buildRequest();return s.idToken=t,mo(e,s)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,mo(e,t)}buildRequest(){const e={requestUri:D1,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Bl(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V1(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function L1(n){const e=gl(yl(n)).link,t=e?gl(yl(e)).deep_link_id:null,s=gl(yl(n)).deep_link_id;return(s?gl(yl(s)).link:null)||s||t||e||n}class Yf{constructor(e){var t,s,a,l,d,f;const m=gl(yl(e)),v=(t=m.apiKey)!==null&&t!==void 0?t:null,w=(s=m.oobCode)!==null&&s!==void 0?s:null,E=V1((a=m.mode)!==null&&a!==void 0?a:null);qe(v&&w&&E,"argument-error"),this.apiKey=v,this.operation=E,this.code=w,this.continueUrl=(l=m.continueUrl)!==null&&l!==void 0?l:null,this.languageCode=(d=m.lang)!==null&&d!==void 0?d:null,this.tenantId=(f=m.tenantId)!==null&&f!==void 0?f:null}static parseLink(e){const t=L1(e);try{return new Yf(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ro{constructor(){this.providerId=Ro.PROVIDER_ID}static credential(e,t){return kl._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const s=Yf.parseLink(t);return qe(s,"argument-error"),kl._fromEmailAndCode(e,s.code,s.tenantId)}}Ro.PROVIDER_ID="password";Ro.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Ro.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jf{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ql extends Jf{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ti extends ql{constructor(){super("facebook.com")}static credential(e){return _a._fromParams({providerId:Ti.PROVIDER_ID,signInMethod:Ti.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ti.credentialFromTaggedObject(e)}static credentialFromError(e){return Ti.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ti.credential(e.oauthAccessToken)}catch{return null}}}Ti.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ti.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Es extends ql{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return _a._fromParams({providerId:Es.PROVIDER_ID,signInMethod:Es.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Es.credentialFromTaggedObject(e)}static credentialFromError(e){return Es.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:s}=e;if(!t&&!s)return null;try{return Es.credential(t,s)}catch{return null}}}Es.GOOGLE_SIGN_IN_METHOD="google.com";Es.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Si extends ql{constructor(){super("github.com")}static credential(e){return _a._fromParams({providerId:Si.PROVIDER_ID,signInMethod:Si.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Si.credentialFromTaggedObject(e)}static credentialFromError(e){return Si.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Si.credential(e.oauthAccessToken)}catch{return null}}}Si.GITHUB_SIGN_IN_METHOD="github.com";Si.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ii extends ql{constructor(){super("twitter.com")}static credential(e,t){return _a._fromParams({providerId:Ii.PROVIDER_ID,signInMethod:Ii.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ii.credentialFromTaggedObject(e)}static credentialFromError(e){return Ii.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:s}=e;if(!t||!s)return null;try{return Ii.credential(t,s)}catch{return null}}}Ii.TWITTER_SIGN_IN_METHOD="twitter.com";Ii.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function O1(n,e){return Wl(n,"POST","/v1/accounts:signUp",$i(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wa{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,s,a=!1){const l=await rs._fromIdTokenResponse(e,s,a),d=Iy(s);return new wa({user:l,providerId:d,_tokenResponse:s,operationType:t})}static async _forOperation(e,t,s){await e._updateTokensIfNecessary(s,!0);const a=Iy(s);return new wa({user:e,providerId:a,_tokenResponse:s,operationType:t})}}function Iy(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bu extends ni{constructor(e,t,s,a){var l;super(t.code,t.message),this.operationType=s,this.user=a,Object.setPrototypeOf(this,bu.prototype),this.customData={appName:e.name,tenantId:(l=e.tenantId)!==null&&l!==void 0?l:void 0,_serverResponse:t.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,t,s,a){return new bu(e,t,s,a)}}function F_(n,e,t,s){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?bu._fromErrorAndOperation(n,l,e,s):l})}async function M1(n,e,t=!1){const s=await _o(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return wa._forOperation(n,"link",s)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function F1(n,e,t=!1){const{auth:s}=n;if(wr(s.app))return Promise.reject(Qs(s));const a="reauthenticate";try{const l=await _o(n,F_(s,a,e,n),t);qe(l.idToken,s,"internal-error");const d=Gf(l.idToken);qe(d,s,"internal-error");const{sub:f}=d;return qe(n.uid===f,s,"user-mismatch"),wa._forOperation(n,a,l)}catch(l){throw(l==null?void 0:l.code)==="auth/user-not-found"&&Or(s,"user-mismatch"),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function U_(n,e,t=!1){if(wr(n.app))return Promise.reject(Qs(n));const s="signIn",a=await F_(n,s,e),l=await wa._fromIdTokenResponse(n,s,a);return t||await n._updateCurrentUser(l.user),l}async function U1(n,e){return U_(Wi(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function z_(n){const e=Wi(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function z1(n,e,t){if(wr(n.app))return Promise.reject(Qs(n));const s=Wi(n),d=await pf(s,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",O1).catch(m=>{throw m.code==="auth/password-does-not-meet-requirements"&&z_(n),m}),f=await wa._fromIdTokenResponse(s,"signIn",d);return await s._updateCurrentUser(f.user),f}function B_(n,e,t){return wr(n.app)?Promise.reject(Qs(n)):U1(gn(n),Ro.credential(e,t)).catch(async s=>{throw s.code==="auth/password-does-not-meet-requirements"&&z_(n),s})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function B1(n,e){return ri(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $1(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const s=gn(n),l={idToken:await s.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},d=await _o(s,B1(s.auth,l));s.displayName=d.displayName||null,s.photoURL=d.photoUrl||null;const f=s.providerData.find(({providerId:m})=>m==="password");f&&(f.displayName=s.displayName,f.photoURL=s.photoURL),await s._updateTokensIfNecessary(d)}function W1(n,e,t,s){return gn(n).onIdTokenChanged(e,t,s)}function q1(n,e,t){return gn(n).beforeAuthStateChanged(e,t)}function H1(n,e,t,s){return gn(n).onAuthStateChanged(e,t,s)}function $_(n){return gn(n).signOut()}const Ru="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W_{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Ru,"1"),this.storage.removeItem(Ru),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G1=1e3,K1=10;class q_ extends W_{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=D_(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const s=this.storage.getItem(t),a=this.localCache[t];s!==a&&e(t,a,s)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((d,f,m)=>{this.notifyListeners(d,m)});return}const s=e.key;t?this.detachListener():this.stopPolling();const a=()=>{const d=this.storage.getItem(s);!t&&this.localCache[s]===d||this.notifyListeners(s,d)},l=this.storage.getItem(s);d1()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,K1):a()}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const a of Array.from(s))a(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:s}),!0)})},G1)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}q_.type="LOCAL";const Q1=q_;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H_ extends W_{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}H_.type="SESSION";const G_=H_;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y1(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hu{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(a=>a.isListeningto(e));if(t)return t;const s=new Hu(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:s,eventType:a,data:l}=t.data,d=this.handlersMap[a];if(!(d!=null&&d.size))return;t.ports[0].postMessage({status:"ack",eventId:s,eventType:a});const f=Array.from(d).map(async v=>v(t.origin,l)),m=await Y1(f);t.ports[0].postMessage({status:"done",eventId:s,eventType:a,response:m})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Hu.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xf(n="",e=10){let t="";for(let s=0;s<e;s++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J1{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,s=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let l,d;return new Promise((f,m)=>{const v=Xf("",20);a.port1.start();const w=setTimeout(()=>{m(new Error("unsupported_event"))},s);d={messageChannel:a,onMessage(E){const C=E;if(C.data.eventId===v)switch(C.data.status){case"ack":clearTimeout(w),l=setTimeout(()=>{m(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),f(C.data.response);break;default:clearTimeout(w),clearTimeout(l),m(new Error("invalid_response"));break}}},this.handlers.add(d),a.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:v,data:t},[a.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ss(){return window}function X1(n){Ss().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K_(){return typeof Ss().WorkerGlobalScope<"u"&&typeof Ss().importScripts=="function"}async function Z1(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function eI(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function tI(){return K_()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q_="firebaseLocalStorageDb",nI=1,Au="firebaseLocalStorage",Y_="fbase_key";class Hl{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Gu(n,e){return n.transaction([Au],e?"readwrite":"readonly").objectStore(Au)}function rI(){const n=indexedDB.deleteDatabase(Q_);return new Hl(n).toPromise()}function mf(){const n=indexedDB.open(Q_,nI);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const s=n.result;try{s.createObjectStore(Au,{keyPath:Y_})}catch(a){t(a)}}),n.addEventListener("success",async()=>{const s=n.result;s.objectStoreNames.contains(Au)?e(s):(s.close(),await rI(),e(await mf()))})})}async function Cy(n,e,t){const s=Gu(n,!0).put({[Y_]:e,value:t});return new Hl(s).toPromise()}async function sI(n,e){const t=Gu(n,!1).get(e),s=await new Hl(t).toPromise();return s===void 0?null:s.value}function Py(n,e){const t=Gu(n,!0).delete(e);return new Hl(t).toPromise()}const iI=800,aI=3;class J_{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await mf(),this.db)}async _withRetries(e){let t=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(t++>aI)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return K_()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Hu._getInstance(tI()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await Z1(),!this.activeServiceWorker)return;this.sender=new J1(this.activeServiceWorker);const s=await this.sender._send("ping",{},800);s&&!((e=s[0])===null||e===void 0)&&e.fulfilled&&!((t=s[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||eI()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await mf();return await Cy(e,Ru,"1"),await Py(e,Ru),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(s=>Cy(s,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(s=>sI(s,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Py(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const l=Gu(a,!1).getAll();return new Hl(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],s=new Set;if(e.length!==0)for(const{fbase_key:a,value:l}of e)s.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(l)&&(this.notifyListeners(a,l),t.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!s.has(a)&&(this.notifyListeners(a,null),t.push(a));return t}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const a of Array.from(s))a(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),iI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}J_.type="LOCAL";const oI=J_;new $l(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X_(n,e){return e?Ks(e):(qe(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zf extends Qf{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return mo(e,this._buildIdpRequest())}_linkToIdToken(e,t){return mo(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return mo(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function lI(n){return U_(n.auth,new Zf(n),n.bypassAuthState)}function cI(n){const{auth:e,user:t}=n;return qe(t,e,"internal-error"),F1(t,new Zf(n),n.bypassAuthState)}async function uI(n){const{auth:e,user:t}=n;return qe(t,e,"internal-error"),M1(t,new Zf(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z_{constructor(e,t,s,a,l=!1){this.auth=e,this.resolver=s,this.user=a,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:s,postBody:a,tenantId:l,error:d,type:f}=e;if(d){this.reject(d);return}const m={auth:this.auth,requestUri:t,sessionId:s,tenantId:l||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(f)(m))}catch(v){this.reject(v)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return lI;case"linkViaPopup":case"linkViaRedirect":return uI;case"reauthViaPopup":case"reauthViaRedirect":return cI;default:Or(this.auth,"internal-error")}}resolve(e){Zs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Zs(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dI=new $l(2e3,1e4);async function e0(n,e,t){if(wr(n.app))return Promise.reject(ss(n,"operation-not-supported-in-this-environment"));const s=Wi(n);qS(n,e,Jf);const a=X_(s,t);return new fa(s,"signInViaPopup",e,a).executeNotNull()}class fa extends Z_{constructor(e,t,s,a,l){super(e,t,a,l),this.provider=s,this.authWindow=null,this.pollId=null,fa.currentPopupAction&&fa.currentPopupAction.cancel(),fa.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return qe(e,this.auth,"internal-error"),e}async onExecution(){Zs(this.filter.length===1,"Popup operations only handle one event");const e=Xf();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(ss(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(ss(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,fa.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,s;if(!((s=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||s===void 0)&&s.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ss(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,dI.get())};e()}}fa.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hI="pendingRedirect",fu=new Map;class fI extends Z_{constructor(e,t,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,s),this.eventId=null}async execute(){let e=fu.get(this.auth._key());if(!e){try{const s=await pI(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(t){e=()=>Promise.reject(t)}fu.set(this.auth._key(),e)}return this.bypassAuthState||fu.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function pI(n,e){const t=yI(e),s=gI(n);if(!await s._isAvailable())return!1;const a=await s._get(t)==="true";return await s._remove(t),a}function mI(n,e){fu.set(n._key(),e)}function gI(n){return Ks(n._redirectPersistence)}function yI(n){return hu(hI,n.config.apiKey,n.name)}async function vI(n,e,t=!1){if(wr(n.app))return Promise.reject(Qs(n));const s=Wi(n),a=X_(s,e),d=await new fI(s,a,t).execute();return d&&!t&&(delete d.user._redirectEventId,await s._persistUserIfCurrent(d.user),await s._setRedirectUser(null,e)),d}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _I=600*1e3;class wI{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(t=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!xI(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var s;if(e.error&&!t0(e)){const a=((s=e.error.code)===null||s===void 0?void 0:s.split("auth/")[1])||"internal-error";t.onError(ss(this.auth,a))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const s=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=_I&&this.cachedEventUids.clear(),this.cachedEventUids.has(by(e))}saveEventToCache(e){this.cachedEventUids.add(by(e)),this.lastProcessedEventTime=Date.now()}}function by(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function t0({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function xI(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return t0(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function EI(n,e={}){return ri(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TI=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,SI=/^https?/;async function II(n){if(n.config.emulator)return;const{authorizedDomains:e}=await EI(n);for(const t of e)try{if(CI(t))return}catch{}Or(n,"unauthorized-domain")}function CI(n){const e=hf(),{protocol:t,hostname:s}=new URL(e);if(n.startsWith("chrome-extension://")){const d=new URL(n);return d.hostname===""&&s===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&d.hostname===s}if(!SI.test(t))return!1;if(TI.test(n))return s===n;const a=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(s)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PI=new $l(3e4,6e4);function Ry(){const n=Ss().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function bI(n){return new Promise((e,t)=>{var s,a,l;function d(){Ry(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Ry(),t(ss(n,"network-request-failed"))},timeout:PI.get()})}if(!((a=(s=Ss().gapi)===null||s===void 0?void 0:s.iframes)===null||a===void 0)&&a.Iframe)e(gapi.iframes.getContext());else if(!((l=Ss().gapi)===null||l===void 0)&&l.load)d();else{const f=w1("iframefcb");return Ss()[f]=()=>{gapi.load?d():t(ss(n,"network-request-failed"))},L_(`${_1()}?onload=${f}`).catch(m=>t(m))}}).catch(e=>{throw pu=null,e})}let pu=null;function RI(n){return pu=pu||bI(n),pu}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AI=new $l(5e3,15e3),NI="__/auth/iframe",kI="emulator/auth/iframe",jI={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},DI=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function VI(n){const e=n.config;qe(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Hf(e,kI):`https://${n.config.authDomain}/${NI}`,s={apiKey:e.apiKey,appName:n.name,v:bo},a=DI.get(n.config.apiHost);a&&(s.eid=a);const l=n._getFrameworks();return l.length&&(s.fw=l.join(",")),`${t}?${Bl(s).slice(1)}`}async function LI(n){const e=await RI(n),t=Ss().gapi;return qe(t,n,"internal-error"),e.open({where:document.body,url:VI(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:jI,dontclear:!0},s=>new Promise(async(a,l)=>{await s.restyle({setHideOnLeave:!1});const d=ss(n,"network-request-failed"),f=Ss().setTimeout(()=>{l(d)},AI.get());function m(){Ss().clearTimeout(f),a(s)}s.ping(m).then(m,()=>{l(d)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OI={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},MI=500,FI=600,UI="_blank",zI="http://localhost";class Ay{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function BI(n,e,t,s=MI,a=FI){const l=Math.max((window.screen.availHeight-a)/2,0).toString(),d=Math.max((window.screen.availWidth-s)/2,0).toString();let f="";const m=Object.assign(Object.assign({},OI),{width:s.toString(),height:a.toString(),top:l,left:d}),v=Wn().toLowerCase();t&&(f=R_(v)?UI:t),P_(v)&&(e=e||zI,m.scrollbars="yes");const w=Object.entries(m).reduce((C,[$,q])=>`${C}${$}=${q},`,"");if(u1(v)&&f!=="_self")return $I(e||"",f),new Ay(null);const E=window.open(e||"",f,w);qe(E,n,"popup-blocked");try{E.focus()}catch{}return new Ay(E)}function $I(n,e){const t=document.createElement("a");t.href=n,t.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WI="__/auth/handler",qI="emulator/auth/handler",HI=encodeURIComponent("fac");async function Ny(n,e,t,s,a,l){qe(n.config.authDomain,n,"auth-domain-config-required"),qe(n.config.apiKey,n,"invalid-api-key");const d={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:s,v:bo,eventId:a};if(e instanceof Jf){e.setDefaultLanguage(n.languageCode),d.providerId=e.providerId||"",RT(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[w,E]of Object.entries({}))d[w]=E}if(e instanceof ql){const w=e.getScopes().filter(E=>E!=="");w.length>0&&(d.scopes=w.join(","))}n.tenantId&&(d.tid=n.tenantId);const f=d;for(const w of Object.keys(f))f[w]===void 0&&delete f[w];const m=await n._getAppCheckToken(),v=m?`#${HI}=${encodeURIComponent(m)}`:"";return`${GI(n)}?${Bl(f).slice(1)}${v}`}function GI({config:n}){return n.emulator?Hf(n,qI):`https://${n.authDomain}/${WI}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qh="webStorageSupport";class KI{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=G_,this._completeRedirectFn=vI,this._overrideRedirectResult=mI}async _openPopup(e,t,s,a){var l;Zs((l=this.eventManagers[e._key()])===null||l===void 0?void 0:l.manager,"_initialize() not called before _openPopup()");const d=await Ny(e,t,s,hf(),a);return BI(e,d,Xf())}async _openRedirect(e,t,s,a){await this._originValidation(e);const l=await Ny(e,t,s,hf(),a);return X1(l),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:a,promise:l}=this.eventManagers[t];return a?Promise.resolve(a):(Zs(l,"If manager is not set, promise should be"),l)}const s=this.initAndGetManager(e);return this.eventManagers[t]={promise:s},s.catch(()=>{delete this.eventManagers[t]}),s}async initAndGetManager(e){const t=await LI(e),s=new wI(e);return t.register("authEvent",a=>(qe(a==null?void 0:a.authEvent,e,"invalid-auth-event"),{status:s.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=t,s}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Qh,{type:Qh},a=>{var l;const d=(l=a==null?void 0:a[0])===null||l===void 0?void 0:l[Qh];d!==void 0&&t(!!d),Or(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=II(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return D_()||b_()||Kf()}}const QI=KI;var ky="@firebase/auth",jy="1.10.8";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YI{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(s=>{e((s==null?void 0:s.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){qe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JI(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function XI(n){vo(new va("auth",(e,{options:t})=>{const s=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:d,authDomain:f}=s.options;qe(d&&!d.includes(":"),"invalid-api-key",{appName:s.name});const m={apiKey:d,authDomain:f,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:V_(n)},v=new g1(s,a,l,m);return C1(v,t),v},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,s)=>{e.getProvider("auth-internal").initialize()})),vo(new va("auth-internal",e=>{const t=Wi(e.getProvider("auth").getImmediate());return(s=>new YI(s))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ni(ky,jy,JI(n)),Ni(ky,jy,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZI=300,eC=d_("authIdTokenMaxAge")||ZI;let Dy=null;const tC=n=>async e=>{const t=e&&await e.getIdTokenResult(),s=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(s&&s>eC)return;const a=t==null?void 0:t.token;Dy!==a&&(Dy=a,await fetch(n,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function nC(n=y_()){const e=Bf(n,"auth");if(e.isInitialized())return e.getImmediate();const t=I1(n,{popupRedirectResolver:QI,persistence:[oI,Q1,G_]}),s=d_("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const l=new URL(s,location.origin);if(location.origin===l.origin){const d=tC(l.toString());q1(t,d,()=>d(t.currentUser)),W1(t,f=>d(f))}}const a=c_("auth");return a&&P1(t,`http://${a}`),t}function rC(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}y1({loadJS(n){return new Promise((e,t)=>{const s=document.createElement("script");s.setAttribute("src",n),s.onload=e,s.onerror=a=>{const l=ss("internal-error");l.customData=a,t(l)},s.type="text/javascript",s.charset="UTF-8",rC().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});XI("Browser");var Vy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ki,n0;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(N,R){function k(){}k.prototype=R.prototype,N.D=R.prototype,N.prototype=new k,N.prototype.constructor=N,N.C=function(L,M,D){for(var S=Array(arguments.length-2),ce=2;ce<arguments.length;ce++)S[ce-2]=arguments[ce];return R.prototype[M].apply(L,S)}}function t(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(s,t),s.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(N,R,k){k||(k=0);var L=Array(16);if(typeof R=="string")for(var M=0;16>M;++M)L[M]=R.charCodeAt(k++)|R.charCodeAt(k++)<<8|R.charCodeAt(k++)<<16|R.charCodeAt(k++)<<24;else for(M=0;16>M;++M)L[M]=R[k++]|R[k++]<<8|R[k++]<<16|R[k++]<<24;R=N.g[0],k=N.g[1],M=N.g[2];var D=N.g[3],S=R+(D^k&(M^D))+L[0]+3614090360&4294967295;R=k+(S<<7&4294967295|S>>>25),S=D+(M^R&(k^M))+L[1]+3905402710&4294967295,D=R+(S<<12&4294967295|S>>>20),S=M+(k^D&(R^k))+L[2]+606105819&4294967295,M=D+(S<<17&4294967295|S>>>15),S=k+(R^M&(D^R))+L[3]+3250441966&4294967295,k=M+(S<<22&4294967295|S>>>10),S=R+(D^k&(M^D))+L[4]+4118548399&4294967295,R=k+(S<<7&4294967295|S>>>25),S=D+(M^R&(k^M))+L[5]+1200080426&4294967295,D=R+(S<<12&4294967295|S>>>20),S=M+(k^D&(R^k))+L[6]+2821735955&4294967295,M=D+(S<<17&4294967295|S>>>15),S=k+(R^M&(D^R))+L[7]+4249261313&4294967295,k=M+(S<<22&4294967295|S>>>10),S=R+(D^k&(M^D))+L[8]+1770035416&4294967295,R=k+(S<<7&4294967295|S>>>25),S=D+(M^R&(k^M))+L[9]+2336552879&4294967295,D=R+(S<<12&4294967295|S>>>20),S=M+(k^D&(R^k))+L[10]+4294925233&4294967295,M=D+(S<<17&4294967295|S>>>15),S=k+(R^M&(D^R))+L[11]+2304563134&4294967295,k=M+(S<<22&4294967295|S>>>10),S=R+(D^k&(M^D))+L[12]+1804603682&4294967295,R=k+(S<<7&4294967295|S>>>25),S=D+(M^R&(k^M))+L[13]+4254626195&4294967295,D=R+(S<<12&4294967295|S>>>20),S=M+(k^D&(R^k))+L[14]+2792965006&4294967295,M=D+(S<<17&4294967295|S>>>15),S=k+(R^M&(D^R))+L[15]+1236535329&4294967295,k=M+(S<<22&4294967295|S>>>10),S=R+(M^D&(k^M))+L[1]+4129170786&4294967295,R=k+(S<<5&4294967295|S>>>27),S=D+(k^M&(R^k))+L[6]+3225465664&4294967295,D=R+(S<<9&4294967295|S>>>23),S=M+(R^k&(D^R))+L[11]+643717713&4294967295,M=D+(S<<14&4294967295|S>>>18),S=k+(D^R&(M^D))+L[0]+3921069994&4294967295,k=M+(S<<20&4294967295|S>>>12),S=R+(M^D&(k^M))+L[5]+3593408605&4294967295,R=k+(S<<5&4294967295|S>>>27),S=D+(k^M&(R^k))+L[10]+38016083&4294967295,D=R+(S<<9&4294967295|S>>>23),S=M+(R^k&(D^R))+L[15]+3634488961&4294967295,M=D+(S<<14&4294967295|S>>>18),S=k+(D^R&(M^D))+L[4]+3889429448&4294967295,k=M+(S<<20&4294967295|S>>>12),S=R+(M^D&(k^M))+L[9]+568446438&4294967295,R=k+(S<<5&4294967295|S>>>27),S=D+(k^M&(R^k))+L[14]+3275163606&4294967295,D=R+(S<<9&4294967295|S>>>23),S=M+(R^k&(D^R))+L[3]+4107603335&4294967295,M=D+(S<<14&4294967295|S>>>18),S=k+(D^R&(M^D))+L[8]+1163531501&4294967295,k=M+(S<<20&4294967295|S>>>12),S=R+(M^D&(k^M))+L[13]+2850285829&4294967295,R=k+(S<<5&4294967295|S>>>27),S=D+(k^M&(R^k))+L[2]+4243563512&4294967295,D=R+(S<<9&4294967295|S>>>23),S=M+(R^k&(D^R))+L[7]+1735328473&4294967295,M=D+(S<<14&4294967295|S>>>18),S=k+(D^R&(M^D))+L[12]+2368359562&4294967295,k=M+(S<<20&4294967295|S>>>12),S=R+(k^M^D)+L[5]+4294588738&4294967295,R=k+(S<<4&4294967295|S>>>28),S=D+(R^k^M)+L[8]+2272392833&4294967295,D=R+(S<<11&4294967295|S>>>21),S=M+(D^R^k)+L[11]+1839030562&4294967295,M=D+(S<<16&4294967295|S>>>16),S=k+(M^D^R)+L[14]+4259657740&4294967295,k=M+(S<<23&4294967295|S>>>9),S=R+(k^M^D)+L[1]+2763975236&4294967295,R=k+(S<<4&4294967295|S>>>28),S=D+(R^k^M)+L[4]+1272893353&4294967295,D=R+(S<<11&4294967295|S>>>21),S=M+(D^R^k)+L[7]+4139469664&4294967295,M=D+(S<<16&4294967295|S>>>16),S=k+(M^D^R)+L[10]+3200236656&4294967295,k=M+(S<<23&4294967295|S>>>9),S=R+(k^M^D)+L[13]+681279174&4294967295,R=k+(S<<4&4294967295|S>>>28),S=D+(R^k^M)+L[0]+3936430074&4294967295,D=R+(S<<11&4294967295|S>>>21),S=M+(D^R^k)+L[3]+3572445317&4294967295,M=D+(S<<16&4294967295|S>>>16),S=k+(M^D^R)+L[6]+76029189&4294967295,k=M+(S<<23&4294967295|S>>>9),S=R+(k^M^D)+L[9]+3654602809&4294967295,R=k+(S<<4&4294967295|S>>>28),S=D+(R^k^M)+L[12]+3873151461&4294967295,D=R+(S<<11&4294967295|S>>>21),S=M+(D^R^k)+L[15]+530742520&4294967295,M=D+(S<<16&4294967295|S>>>16),S=k+(M^D^R)+L[2]+3299628645&4294967295,k=M+(S<<23&4294967295|S>>>9),S=R+(M^(k|~D))+L[0]+4096336452&4294967295,R=k+(S<<6&4294967295|S>>>26),S=D+(k^(R|~M))+L[7]+1126891415&4294967295,D=R+(S<<10&4294967295|S>>>22),S=M+(R^(D|~k))+L[14]+2878612391&4294967295,M=D+(S<<15&4294967295|S>>>17),S=k+(D^(M|~R))+L[5]+4237533241&4294967295,k=M+(S<<21&4294967295|S>>>11),S=R+(M^(k|~D))+L[12]+1700485571&4294967295,R=k+(S<<6&4294967295|S>>>26),S=D+(k^(R|~M))+L[3]+2399980690&4294967295,D=R+(S<<10&4294967295|S>>>22),S=M+(R^(D|~k))+L[10]+4293915773&4294967295,M=D+(S<<15&4294967295|S>>>17),S=k+(D^(M|~R))+L[1]+2240044497&4294967295,k=M+(S<<21&4294967295|S>>>11),S=R+(M^(k|~D))+L[8]+1873313359&4294967295,R=k+(S<<6&4294967295|S>>>26),S=D+(k^(R|~M))+L[15]+4264355552&4294967295,D=R+(S<<10&4294967295|S>>>22),S=M+(R^(D|~k))+L[6]+2734768916&4294967295,M=D+(S<<15&4294967295|S>>>17),S=k+(D^(M|~R))+L[13]+1309151649&4294967295,k=M+(S<<21&4294967295|S>>>11),S=R+(M^(k|~D))+L[4]+4149444226&4294967295,R=k+(S<<6&4294967295|S>>>26),S=D+(k^(R|~M))+L[11]+3174756917&4294967295,D=R+(S<<10&4294967295|S>>>22),S=M+(R^(D|~k))+L[2]+718787259&4294967295,M=D+(S<<15&4294967295|S>>>17),S=k+(D^(M|~R))+L[9]+3951481745&4294967295,N.g[0]=N.g[0]+R&4294967295,N.g[1]=N.g[1]+(M+(S<<21&4294967295|S>>>11))&4294967295,N.g[2]=N.g[2]+M&4294967295,N.g[3]=N.g[3]+D&4294967295}s.prototype.u=function(N,R){R===void 0&&(R=N.length);for(var k=R-this.blockSize,L=this.B,M=this.h,D=0;D<R;){if(M==0)for(;D<=k;)a(this,N,D),D+=this.blockSize;if(typeof N=="string"){for(;D<R;)if(L[M++]=N.charCodeAt(D++),M==this.blockSize){a(this,L),M=0;break}}else for(;D<R;)if(L[M++]=N[D++],M==this.blockSize){a(this,L),M=0;break}}this.h=M,this.o+=R},s.prototype.v=function(){var N=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);N[0]=128;for(var R=1;R<N.length-8;++R)N[R]=0;var k=8*this.o;for(R=N.length-8;R<N.length;++R)N[R]=k&255,k/=256;for(this.u(N),N=Array(16),R=k=0;4>R;++R)for(var L=0;32>L;L+=8)N[k++]=this.g[R]>>>L&255;return N};function l(N,R){var k=f;return Object.prototype.hasOwnProperty.call(k,N)?k[N]:k[N]=R(N)}function d(N,R){this.h=R;for(var k=[],L=!0,M=N.length-1;0<=M;M--){var D=N[M]|0;L&&D==R||(k[M]=D,L=!1)}this.g=k}var f={};function m(N){return-128<=N&&128>N?l(N,function(R){return new d([R|0],0>R?-1:0)}):new d([N|0],0>N?-1:0)}function v(N){if(isNaN(N)||!isFinite(N))return E;if(0>N)return F(v(-N));for(var R=[],k=1,L=0;N>=k;L++)R[L]=N/k|0,k*=4294967296;return new d(R,0)}function w(N,R){if(N.length==0)throw Error("number format error: empty string");if(R=R||10,2>R||36<R)throw Error("radix out of range: "+R);if(N.charAt(0)=="-")return F(w(N.substring(1),R));if(0<=N.indexOf("-"))throw Error('number format error: interior "-" character');for(var k=v(Math.pow(R,8)),L=E,M=0;M<N.length;M+=8){var D=Math.min(8,N.length-M),S=parseInt(N.substring(M,M+D),R);8>D?(D=v(Math.pow(R,D)),L=L.j(D).add(v(S))):(L=L.j(k),L=L.add(v(S)))}return L}var E=m(0),C=m(1),$=m(16777216);n=d.prototype,n.m=function(){if(Y(this))return-F(this).m();for(var N=0,R=1,k=0;k<this.g.length;k++){var L=this.i(k);N+=(0<=L?L:4294967296+L)*R,R*=4294967296}return N},n.toString=function(N){if(N=N||10,2>N||36<N)throw Error("radix out of range: "+N);if(q(this))return"0";if(Y(this))return"-"+F(this).toString(N);for(var R=v(Math.pow(N,6)),k=this,L="";;){var M=le(k,R).g;k=X(k,M.j(R));var D=((0<k.g.length?k.g[0]:k.h)>>>0).toString(N);if(k=M,q(k))return D+L;for(;6>D.length;)D="0"+D;L=D+L}},n.i=function(N){return 0>N?0:N<this.g.length?this.g[N]:this.h};function q(N){if(N.h!=0)return!1;for(var R=0;R<N.g.length;R++)if(N.g[R]!=0)return!1;return!0}function Y(N){return N.h==-1}n.l=function(N){return N=X(this,N),Y(N)?-1:q(N)?0:1};function F(N){for(var R=N.g.length,k=[],L=0;L<R;L++)k[L]=~N.g[L];return new d(k,~N.h).add(C)}n.abs=function(){return Y(this)?F(this):this},n.add=function(N){for(var R=Math.max(this.g.length,N.g.length),k=[],L=0,M=0;M<=R;M++){var D=L+(this.i(M)&65535)+(N.i(M)&65535),S=(D>>>16)+(this.i(M)>>>16)+(N.i(M)>>>16);L=S>>>16,D&=65535,S&=65535,k[M]=S<<16|D}return new d(k,k[k.length-1]&-2147483648?-1:0)};function X(N,R){return N.add(F(R))}n.j=function(N){if(q(this)||q(N))return E;if(Y(this))return Y(N)?F(this).j(F(N)):F(F(this).j(N));if(Y(N))return F(this.j(F(N)));if(0>this.l($)&&0>N.l($))return v(this.m()*N.m());for(var R=this.g.length+N.g.length,k=[],L=0;L<2*R;L++)k[L]=0;for(L=0;L<this.g.length;L++)for(var M=0;M<N.g.length;M++){var D=this.i(L)>>>16,S=this.i(L)&65535,ce=N.i(M)>>>16,me=N.i(M)&65535;k[2*L+2*M]+=S*me,ge(k,2*L+2*M),k[2*L+2*M+1]+=D*me,ge(k,2*L+2*M+1),k[2*L+2*M+1]+=S*ce,ge(k,2*L+2*M+1),k[2*L+2*M+2]+=D*ce,ge(k,2*L+2*M+2)}for(L=0;L<R;L++)k[L]=k[2*L+1]<<16|k[2*L];for(L=R;L<2*R;L++)k[L]=0;return new d(k,0)};function ge(N,R){for(;(N[R]&65535)!=N[R];)N[R+1]+=N[R]>>>16,N[R]&=65535,R++}function re(N,R){this.g=N,this.h=R}function le(N,R){if(q(R))throw Error("division by zero");if(q(N))return new re(E,E);if(Y(N))return R=le(F(N),R),new re(F(R.g),F(R.h));if(Y(R))return R=le(N,F(R)),new re(F(R.g),R.h);if(30<N.g.length){if(Y(N)||Y(R))throw Error("slowDivide_ only works with positive integers.");for(var k=C,L=R;0>=L.l(N);)k=xe(k),L=xe(L);var M=Se(k,1),D=Se(L,1);for(L=Se(L,2),k=Se(k,2);!q(L);){var S=D.add(L);0>=S.l(N)&&(M=M.add(k),D=S),L=Se(L,1),k=Se(k,1)}return R=X(N,M.j(R)),new re(M,R)}for(M=E;0<=N.l(R);){for(k=Math.max(1,Math.floor(N.m()/R.m())),L=Math.ceil(Math.log(k)/Math.LN2),L=48>=L?1:Math.pow(2,L-48),D=v(k),S=D.j(R);Y(S)||0<S.l(N);)k-=L,D=v(k),S=D.j(R);q(D)&&(D=C),M=M.add(D),N=X(N,S)}return new re(M,N)}n.A=function(N){return le(this,N).h},n.and=function(N){for(var R=Math.max(this.g.length,N.g.length),k=[],L=0;L<R;L++)k[L]=this.i(L)&N.i(L);return new d(k,this.h&N.h)},n.or=function(N){for(var R=Math.max(this.g.length,N.g.length),k=[],L=0;L<R;L++)k[L]=this.i(L)|N.i(L);return new d(k,this.h|N.h)},n.xor=function(N){for(var R=Math.max(this.g.length,N.g.length),k=[],L=0;L<R;L++)k[L]=this.i(L)^N.i(L);return new d(k,this.h^N.h)};function xe(N){for(var R=N.g.length+1,k=[],L=0;L<R;L++)k[L]=N.i(L)<<1|N.i(L-1)>>>31;return new d(k,N.h)}function Se(N,R){var k=R>>5;R%=32;for(var L=N.g.length-k,M=[],D=0;D<L;D++)M[D]=0<R?N.i(D+k)>>>R|N.i(D+k+1)<<32-R:N.i(D+k);return new d(M,N.h)}s.prototype.digest=s.prototype.v,s.prototype.reset=s.prototype.s,s.prototype.update=s.prototype.u,n0=s,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.A,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=v,d.fromString=w,ki=d}).apply(typeof Vy<"u"?Vy:typeof self<"u"?self:typeof window<"u"?window:{});var au=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var r0,vl,s0,mu,gf,i0,a0,o0;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,g,_){return u==Array.prototype||u==Object.prototype||(u[g]=_.value),u};function t(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof au=="object"&&au];for(var g=0;g<u.length;++g){var _=u[g];if(_&&_.Math==Math)return _}throw Error("Cannot find global object")}var s=t(this);function a(u,g){if(g)e:{var _=s;u=u.split(".");for(var T=0;T<u.length-1;T++){var H=u[T];if(!(H in _))break e;_=_[H]}u=u[u.length-1],T=_[u],g=g(T),g!=T&&g!=null&&e(_,u,{configurable:!0,writable:!0,value:g})}}function l(u,g){u instanceof String&&(u+="");var _=0,T=!1,H={next:function(){if(!T&&_<u.length){var te=_++;return{value:g(te,u[te]),done:!1}}return T=!0,{done:!0,value:void 0}}};return H[Symbol.iterator]=function(){return H},H}a("Array.prototype.values",function(u){return u||function(){return l(this,function(g,_){return _})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var d=d||{},f=this||self;function m(u){var g=typeof u;return g=g!="object"?g:u?Array.isArray(u)?"array":g:"null",g=="array"||g=="object"&&typeof u.length=="number"}function v(u){var g=typeof u;return g=="object"&&u!=null||g=="function"}function w(u,g,_){return u.call.apply(u.bind,arguments)}function E(u,g,_){if(!u)throw Error();if(2<arguments.length){var T=Array.prototype.slice.call(arguments,2);return function(){var H=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(H,T),u.apply(g,H)}}return function(){return u.apply(g,arguments)}}function C(u,g,_){return C=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?w:E,C.apply(null,arguments)}function $(u,g){var _=Array.prototype.slice.call(arguments,1);return function(){var T=_.slice();return T.push.apply(T,arguments),u.apply(this,T)}}function q(u,g){function _(){}_.prototype=g.prototype,u.aa=g.prototype,u.prototype=new _,u.prototype.constructor=u,u.Qb=function(T,H,te){for(var _e=Array(arguments.length-2),St=2;St<arguments.length;St++)_e[St-2]=arguments[St];return g.prototype[H].apply(T,_e)}}function Y(u){const g=u.length;if(0<g){const _=Array(g);for(let T=0;T<g;T++)_[T]=u[T];return _}return[]}function F(u,g){for(let _=1;_<arguments.length;_++){const T=arguments[_];if(m(T)){const H=u.length||0,te=T.length||0;u.length=H+te;for(let _e=0;_e<te;_e++)u[H+_e]=T[_e]}else u.push(T)}}class X{constructor(g,_){this.i=g,this.j=_,this.h=0,this.g=null}get(){let g;return 0<this.h?(this.h--,g=this.g,this.g=g.next,g.next=null):g=this.i(),g}}function ge(u){return/^[\s\xa0]*$/.test(u)}function re(){var u=f.navigator;return u&&(u=u.userAgent)?u:""}function le(u){return le[" "](u),u}le[" "]=function(){};var xe=re().indexOf("Gecko")!=-1&&!(re().toLowerCase().indexOf("webkit")!=-1&&re().indexOf("Edge")==-1)&&!(re().indexOf("Trident")!=-1||re().indexOf("MSIE")!=-1)&&re().indexOf("Edge")==-1;function Se(u,g,_){for(const T in u)g.call(_,u[T],T,u)}function N(u,g){for(const _ in u)g.call(void 0,u[_],_,u)}function R(u){const g={};for(const _ in u)g[_]=u[_];return g}const k="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function L(u,g){let _,T;for(let H=1;H<arguments.length;H++){T=arguments[H];for(_ in T)u[_]=T[_];for(let te=0;te<k.length;te++)_=k[te],Object.prototype.hasOwnProperty.call(T,_)&&(u[_]=T[_])}}function M(u){var g=1;u=u.split(":");const _=[];for(;0<g&&u.length;)_.push(u.shift()),g--;return u.length&&_.push(u.join(":")),_}function D(u){f.setTimeout(()=>{throw u},0)}function S(){var u=ne;let g=null;return u.g&&(g=u.g,u.g=u.g.next,u.g||(u.h=null),g.next=null),g}class ce{constructor(){this.h=this.g=null}add(g,_){const T=me.get();T.set(g,_),this.h?this.h.next=T:this.g=T,this.h=T}}var me=new X(()=>new dt,u=>u.reset());class dt{constructor(){this.next=this.g=this.h=null}set(g,_){this.h=g,this.g=_,this.next=null}reset(){this.next=this.g=this.h=null}}let We,V=!1,ne=new ce,se=()=>{const u=f.Promise.resolve(void 0);We=()=>{u.then(b)}};var b=()=>{for(var u;u=S();){try{u.h.call(u.g)}catch(_){D(_)}var g=me;g.j(u),100>g.h&&(g.h++,u.next=g.g,g.g=u)}V=!1};function J(){this.s=this.s,this.C=this.C}J.prototype.s=!1,J.prototype.ma=function(){this.s||(this.s=!0,this.N())},J.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ye(u,g){this.type=u,this.g=this.target=g,this.defaultPrevented=!1}ye.prototype.h=function(){this.defaultPrevented=!0};var je=(function(){if(!f.addEventListener||!Object.defineProperty)return!1;var u=!1,g=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const _=()=>{};f.addEventListener("test",_,g),f.removeEventListener("test",_,g)}catch{}return u})();function Ae(u,g){if(ye.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var _=this.type=u.type,T=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=g,g=u.relatedTarget){if(xe){e:{try{le(g.nodeName);var H=!0;break e}catch{}H=!1}H||(g=null)}}else _=="mouseover"?g=u.fromElement:_=="mouseout"&&(g=u.toElement);this.relatedTarget=g,T?(this.clientX=T.clientX!==void 0?T.clientX:T.pageX,this.clientY=T.clientY!==void 0?T.clientY:T.pageY,this.screenX=T.screenX||0,this.screenY=T.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:Ue[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&Ae.aa.h.call(this)}}q(Ae,ye);var Ue={2:"touch",3:"pen",4:"mouse"};Ae.prototype.h=function(){Ae.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var Ze="closure_listenable_"+(1e6*Math.random()|0),Qe=0;function ut(u,g,_,T,H){this.listener=u,this.proxy=null,this.src=g,this.type=_,this.capture=!!T,this.ha=H,this.key=++Qe,this.da=this.fa=!1}function bt(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function ue(u){this.src=u,this.g={},this.h=0}ue.prototype.add=function(u,g,_,T,H){var te=u.toString();u=this.g[te],u||(u=this.g[te]=[],this.h++);var _e=$e(u,g,T,H);return-1<_e?(g=u[_e],_||(g.fa=!1)):(g=new ut(g,this.src,te,!!T,H),g.fa=_,u.push(g)),g};function Ve(u,g){var _=g.type;if(_ in u.g){var T=u.g[_],H=Array.prototype.indexOf.call(T,g,void 0),te;(te=0<=H)&&Array.prototype.splice.call(T,H,1),te&&(bt(g),u.g[_].length==0&&(delete u.g[_],u.h--))}}function $e(u,g,_,T){for(var H=0;H<u.length;++H){var te=u[H];if(!te.da&&te.listener==g&&te.capture==!!_&&te.ha==T)return H}return-1}var Me="closure_lm_"+(1e6*Math.random()|0),xt={};function It(u,g,_,T,H){if(Array.isArray(g)){for(var te=0;te<g.length;te++)It(u,g[te],_,T,H);return null}return _=En(_),u&&u[Ze]?u.K(g,_,v(T)?!!T.capture:!1,H):jt(u,g,_,!1,T,H)}function jt(u,g,_,T,H,te){if(!g)throw Error("Invalid event type");var _e=v(H)?!!H.capture:!!H,St=Rt(u);if(St||(u[Me]=St=new ue(u)),_=St.add(g,_,T,_e,te),_.proxy)return _;if(T=Qt(),_.proxy=T,T.src=u,T.listener=_,u.addEventListener)je||(H=_e),H===void 0&&(H=!1),u.addEventListener(g.toString(),T,H);else if(u.attachEvent)u.attachEvent(Bt(g.toString()),T);else if(u.addListener&&u.removeListener)u.addListener(T);else throw Error("addEventListener and attachEvent are unavailable.");return _}function Qt(){function u(_){return g.call(u.src,u.listener,_)}const g=jn;return u}function Gt(u,g,_,T,H){if(Array.isArray(g))for(var te=0;te<g.length;te++)Gt(u,g[te],_,T,H);else T=v(T)?!!T.capture:!!T,_=En(_),u&&u[Ze]?(u=u.i,g=String(g).toString(),g in u.g&&(te=u.g[g],_=$e(te,_,T,H),-1<_&&(bt(te[_]),Array.prototype.splice.call(te,_,1),te.length==0&&(delete u.g[g],u.h--)))):u&&(u=Rt(u))&&(g=u.g[g.toString()],u=-1,g&&(u=$e(g,_,T,H)),(_=-1<u?g[u]:null)&&tn(_))}function tn(u){if(typeof u!="number"&&u&&!u.da){var g=u.src;if(g&&g[Ze])Ve(g.i,u);else{var _=u.type,T=u.proxy;g.removeEventListener?g.removeEventListener(_,T,u.capture):g.detachEvent?g.detachEvent(Bt(_),T):g.addListener&&g.removeListener&&g.removeListener(T),(_=Rt(g))?(Ve(_,u),_.h==0&&(_.src=null,g[Me]=null)):bt(u)}}}function Bt(u){return u in xt?xt[u]:xt[u]="on"+u}function jn(u,g){if(u.da)u=!0;else{g=new Ae(g,this);var _=u.listener,T=u.ha||u.src;u.fa&&tn(u),u=_.call(T,g)}return u}function Rt(u){return u=u[Me],u instanceof ue?u:null}var nn="__closure_events_fn_"+(1e9*Math.random()>>>0);function En(u){return typeof u=="function"?u:(u[nn]||(u[nn]=function(g){return u.handleEvent(g)}),u[nn])}function At(){J.call(this),this.i=new ue(this),this.M=this,this.F=null}q(At,J),At.prototype[Ze]=!0,At.prototype.removeEventListener=function(u,g,_,T){Gt(this,u,g,_,T)};function Ye(u,g){var _,T=u.F;if(T)for(_=[];T;T=T.F)_.push(T);if(u=u.M,T=g.type||g,typeof g=="string")g=new ye(g,u);else if(g instanceof ye)g.target=g.target||u;else{var H=g;g=new ye(T,u),L(g,H)}if(H=!0,_)for(var te=_.length-1;0<=te;te--){var _e=g.g=_[te];H=Xn(_e,T,!0,g)&&H}if(_e=g.g=u,H=Xn(_e,T,!0,g)&&H,H=Xn(_e,T,!1,g)&&H,_)for(te=0;te<_.length;te++)_e=g.g=_[te],H=Xn(_e,T,!1,g)&&H}At.prototype.N=function(){if(At.aa.N.call(this),this.i){var u=this.i,g;for(g in u.g){for(var _=u.g[g],T=0;T<_.length;T++)bt(_[T]);delete u.g[g],u.h--}}this.F=null},At.prototype.K=function(u,g,_,T){return this.i.add(String(u),g,!1,_,T)},At.prototype.L=function(u,g,_,T){return this.i.add(String(u),g,!0,_,T)};function Xn(u,g,_,T){if(g=u.i.g[String(g)],!g)return!0;g=g.concat();for(var H=!0,te=0;te<g.length;++te){var _e=g[te];if(_e&&!_e.da&&_e.capture==_){var St=_e.listener,hn=_e.ha||_e.src;_e.fa&&Ve(u.i,_e),H=St.call(hn,T)!==!1&&H}}return H&&!T.defaultPrevented}function As(u,g,_){if(typeof u=="function")_&&(u=C(u,_));else if(u&&typeof u.handleEvent=="function")u=C(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(g)?-1:f.setTimeout(u,g||0)}function qn(u){u.g=As(()=>{u.g=null,u.i&&(u.i=!1,qn(u))},u.l);const g=u.h;u.h=null,u.m.apply(null,g)}class Mr extends J{constructor(g,_){super(),this.m=g,this.l=_,this.h=null,this.i=!1,this.g=null}j(g){this.h=arguments,this.g?this.i=!0:qn(this)}N(){super.N(),this.g&&(f.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Er(u){J.call(this),this.h=u,this.g={}}q(Er,J);var Fr=[];function Hn(u){Se(u.g,function(g,_){this.g.hasOwnProperty(_)&&tn(g)},u),u.g={}}Er.prototype.N=function(){Er.aa.N.call(this),Hn(this)},Er.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var hr=f.JSON.stringify,Ns=f.JSON.parse,Zn=class{stringify(u){return f.JSON.stringify(u,void 0)}parse(u){return f.JSON.parse(u,void 0)}};function Ur(){}Ur.prototype.h=null;function Et(u){return u.h||(u.h=u.i())}function ks(){}var Ft={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function rn(){ye.call(this,"d")}q(rn,ye);function fr(){ye.call(this,"c")}q(fr,ye);var Dn={},Vn=null;function sn(){return Vn=Vn||new At}Dn.La="serverreachability";function Tr(u){ye.call(this,Dn.La,u)}q(Tr,ye);function er(u){const g=sn();Ye(g,new Tr(g))}Dn.STAT_EVENT="statevent";function os(u,g){ye.call(this,Dn.STAT_EVENT,u),this.stat=g}q(os,ye);function _t(u){const g=sn();Ye(g,new os(g,u))}Dn.Ma="timingevent";function tr(u,g){ye.call(this,Dn.Ma,u),this.size=g}q(tr,ye);function Ct(u,g){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return f.setTimeout(function(){u()},g)}function P(){this.g=!0}P.prototype.xa=function(){this.g=!1};function Z(u,g,_,T,H,te){u.info(function(){if(u.g)if(te)for(var _e="",St=te.split("&"),hn=0;hn<St.length;hn++){var pt=St[hn].split("=");if(1<pt.length){var yn=pt[0];pt=pt[1];var an=yn.split("_");_e=2<=an.length&&an[1]=="type"?_e+(yn+"="+pt+"&"):_e+(yn+"=redacted&")}}else _e=null;else _e=te;return"XMLHTTP REQ ("+T+") [attempt "+H+"]: "+g+`
`+_+`
`+_e})}function oe(u,g,_,T,H,te,_e){u.info(function(){return"XMLHTTP RESP ("+T+") [ attempt "+H+"]: "+g+`
`+_+`
`+te+" "+_e})}function B(u,g,_,T){u.info(function(){return"XMLHTTP TEXT ("+g+"): "+Ne(u,_)+(T?" "+T:"")})}function K(u,g){u.info(function(){return"TIMEOUT: "+g})}P.prototype.info=function(){};function Ne(u,g){if(!u.g)return g;if(!g)return null;try{var _=JSON.parse(g);if(_){for(u=0;u<_.length;u++)if(Array.isArray(_[u])){var T=_[u];if(!(2>T.length)){var H=T[1];if(Array.isArray(H)&&!(1>H.length)){var te=H[0];if(te!="noop"&&te!="stop"&&te!="close")for(var _e=1;_e<H.length;_e++)H[_e]=""}}}}return hr(_)}catch{return g}}var Le={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Pt={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},we;function Ke(){}q(Ke,Ur),Ke.prototype.g=function(){return new XMLHttpRequest},Ke.prototype.i=function(){return{}},we=new Ke;function ht(u,g,_,T){this.j=u,this.i=g,this.l=_,this.R=T||1,this.U=new Er(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Tn}function Tn(){this.i=null,this.g="",this.h=!1}var Ln={},ls={};function zr(u,g,_){u.L=1,u.v=it(ot(g)),u.m=_,u.P=!0,js(u,null)}function js(u,g){u.F=Date.now(),ft(u),u.A=ot(u.v);var _=u.A,T=u.R;Array.isArray(T)||(T=[String(T)]),si(_.i,"t",T),u.C=0,_=u.j.J,u.h=new Tn,u.g=cc(u.j,_?g:null,!u.m),0<u.O&&(u.M=new Mr(C(u.Y,u,u.g),u.O)),g=u.U,_=u.g,T=u.ca;var H="readystatechange";Array.isArray(H)||(H&&(Fr[0]=H.toString()),H=Fr);for(var te=0;te<H.length;te++){var _e=It(_,H[te],T||g.handleEvent,!1,g.h||g);if(!_e)break;g.g[_e.key]=_e}g=u.H?R(u.H):{},u.m?(u.u||(u.u="POST"),g["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,g)):(u.u="GET",u.g.ea(u.A,u.u,null,g)),er(),Z(u.i,u.u,u.A,u.l,u.R,u.m)}ht.prototype.ca=function(u){u=u.target;const g=this.M;g&&rr(u)==3?g.j():this.Y(u)},ht.prototype.Y=function(u){try{if(u==this.g)e:{const an=rr(this.g);var g=this.g.Ba();const br=this.g.Z();if(!(3>an)&&(an!=3||this.g&&(this.h.h||this.g.oa()||Mo(this.g)))){this.J||an!=4||g==7||(g==8||0>=br?er(3):er(2)),cs(this);var _=this.g.Z();this.X=_;t:if(Ds(this)){var T=Mo(this.g);u="";var H=T.length,te=rr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Gn(this),Br(this);var _e="";break t}this.h.i=new f.TextDecoder}for(g=0;g<H;g++)this.h.h=!0,u+=this.h.i.decode(T[g],{stream:!(te&&g==H-1)});T.length=0,this.h.g+=u,this.C=0,_e=this.h.g}else _e=this.g.oa();if(this.o=_==200,oe(this.i,this.u,this.A,this.l,this.R,an,_),this.o){if(this.T&&!this.K){t:{if(this.g){var St,hn=this.g;if((St=hn.g?hn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!ge(St)){var pt=St;break t}}pt=null}if(_=pt)B(this.i,this.l,_,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Gi(this,_);else{this.o=!1,this.s=3,_t(12),Gn(this),Br(this);break e}}if(this.P){_=!0;let gr;for(;!this.J&&this.C<_e.length;)if(gr=yt(this,_e),gr==ls){an==4&&(this.s=4,_t(14),_=!1),B(this.i,this.l,null,"[Incomplete Response]");break}else if(gr==Ln){this.s=4,_t(15),B(this.i,this.l,_e,"[Invalid Chunk]"),_=!1;break}else B(this.i,this.l,gr,null),Gi(this,gr);if(Ds(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),an!=4||_e.length!=0||this.h.h||(this.s=1,_t(16),_=!1),this.o=this.o&&_,!_)B(this.i,this.l,_e,"[Invalid Chunked Response]"),Gn(this),Br(this);else if(0<_e.length&&!this.W){this.W=!0;var yn=this.j;yn.g==this&&yn.ba&&!yn.M&&(yn.j.info("Great, no buffering proxy detected. Bytes received: "+_e.length),Uo(yn),yn.M=!0,_t(11))}}else B(this.i,this.l,_e,null),Gi(this,_e);an==4&&Gn(this),this.o&&!this.J&&(an==4?Ma(this.j,this):(this.o=!1,ft(this)))}else ja(this.g),_==400&&0<_e.indexOf("Unknown SID")?(this.s=3,_t(12)):(this.s=0,_t(13)),Gn(this),Br(this)}}}catch{}finally{}};function Ds(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function yt(u,g){var _=u.C,T=g.indexOf(`
`,_);return T==-1?ls:(_=Number(g.substring(_,T)),isNaN(_)?Ln:(T+=1,T+_>g.length?ls:(g=g.slice(T,T+_),u.C=T+_,g)))}ht.prototype.cancel=function(){this.J=!0,Gn(this)};function ft(u){u.S=Date.now()+u.I,pr(u,u.I)}function pr(u,g){if(u.B!=null)throw Error("WatchDog timer not null");u.B=Ct(C(u.ba,u),g)}function cs(u){u.B&&(f.clearTimeout(u.B),u.B=null)}ht.prototype.ba=function(){this.B=null;const u=Date.now();0<=u-this.S?(K(this.i,this.A),this.L!=2&&(er(),_t(17)),Gn(this),this.s=2,Br(this)):pr(this,this.S-u)};function Br(u){u.j.G==0||u.J||Ma(u.j,u)}function Gn(u){cs(u);var g=u.M;g&&typeof g.ma=="function"&&g.ma(),u.M=null,Hn(u.U),u.g&&(g=u.g,u.g=null,g.abort(),g.ma())}function Gi(u,g){try{var _=u.j;if(_.G!=0&&(_.g==u||Sn(_.h,u))){if(!u.K&&Sn(_.h,u)&&_.G==3){try{var T=_.Da.g.parse(g)}catch{T=null}if(Array.isArray(T)&&T.length==3){var H=T;if(H[0]==0){e:if(!_.u){if(_.g)if(_.g.F+3e3<u.F)Oa(_),Kr(_);else break e;La(_),_t(18)}}else _.za=H[1],0<_.za-_.T&&37500>H[2]&&_.F&&_.v==0&&!_.C&&(_.C=Ct(C(_.Za,_),6e3));if(1>=Pa(_.h)&&_.ca){try{_.ca()}catch{}_.ca=void 0}}else Ms(_,11)}else if((u.K||_.g==u)&&Oa(_),!ge(g))for(H=_.Da.g.parse(g),g=0;g<H.length;g++){let pt=H[g];if(_.T=pt[0],pt=pt[1],_.G==2)if(pt[0]=="c"){_.K=pt[1],_.ia=pt[2];const yn=pt[3];yn!=null&&(_.la=yn,_.j.info("VER="+_.la));const an=pt[4];an!=null&&(_.Aa=an,_.j.info("SVER="+_.Aa));const br=pt[5];br!=null&&typeof br=="number"&&0<br&&(T=1.5*br,_.L=T,_.j.info("backChannelRequestTimeoutMs_="+T)),T=_;const gr=u.g;if(gr){const Ji=gr.g?gr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ji){var te=T.h;te.g||Ji.indexOf("spdy")==-1&&Ji.indexOf("quic")==-1&&Ji.indexOf("h2")==-1||(te.j=te.l,te.g=new Set,te.h&&(I(te,te.h),te.h=null))}if(T.D){const Ua=gr.g?gr.g.getResponseHeader("X-HTTP-Session-Id"):null;Ua&&(T.ya=Ua,et(T.I,T.D,Ua))}}_.G=3,_.l&&_.l.ua(),_.ba&&(_.R=Date.now()-u.F,_.j.info("Handshake RTT: "+_.R+"ms")),T=_;var _e=u;if(T.qa=lc(T,T.J?T.ia:null,T.W),_e.K){U(T.h,_e);var St=_e,hn=T.L;hn&&(St.I=hn),St.B&&(cs(St),ft(St)),T.g=_e}else Yi(T);0<_.i.length&&ps(_)}else pt[0]!="stop"&&pt[0]!="close"||Ms(_,7);else _.G==3&&(pt[0]=="stop"||pt[0]=="close"?pt[0]=="stop"?Ms(_,7):Cn(_):pt[0]!="noop"&&_.l&&_.l.ta(pt),_.v=0)}}er(4)}catch{}}var Sr=class{constructor(u,g){this.g=u,this.map=g}};function us(u){this.l=u||10,f.PerformanceNavigationTiming?(u=f.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(f.chrome&&f.chrome.loadTimes&&f.chrome.loadTimes()&&f.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Kn(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function Pa(u){return u.h?1:u.g?u.g.size:0}function Sn(u,g){return u.h?u.h==g:u.g?u.g.has(g):!1}function I(u,g){u.g?u.g.add(g):u.h=g}function U(u,g){u.h&&u.h==g?u.h=null:u.g&&u.g.has(g)&&u.g.delete(g)}us.prototype.cancel=function(){if(this.i=W(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function W(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let g=u.i;for(const _ of u.g.values())g=g.concat(_.D);return g}return Y(u.i)}function fe(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(m(u)){for(var g=[],_=u.length,T=0;T<_;T++)g.push(u[T]);return g}g=[],_=0;for(T in u)g[_++]=u[T];return g}function Ee(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(m(u)||typeof u=="string"){var g=[];u=u.length;for(var _=0;_<u;_++)g.push(_);return g}g=[],_=0;for(const T in u)g[_++]=T;return g}}}function Oe(u,g){if(u.forEach&&typeof u.forEach=="function")u.forEach(g,void 0);else if(m(u)||typeof u=="string")Array.prototype.forEach.call(u,g,void 0);else for(var _=Ee(u),T=fe(u),H=T.length,te=0;te<H;te++)g.call(void 0,T[te],_&&_[te],u)}var Te=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function rt(u,g){if(u){u=u.split("&");for(var _=0;_<u.length;_++){var T=u[_].indexOf("="),H=null;if(0<=T){var te=u[_].substring(0,T);H=u[_].substring(T+1)}else te=u[_];g(te,H?decodeURIComponent(H.replace(/\+/g," ")):"")}}}function wt(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof wt){this.h=u.h,$t(this,u.j),this.o=u.o,this.g=u.g,Dt(this,u.s),this.l=u.l;var g=u.i,_=new Cr;_.i=g.i,g.g&&(_.g=new Map(g.g),_.h=g.h),dn(this,_),this.m=u.m}else u&&(g=String(u).match(Te))?(this.h=!1,$t(this,g[1]||"",!0),this.o=tt(g[2]||""),this.g=tt(g[3]||"",!0),Dt(this,g[4]),this.l=tt(g[5]||"",!0),dn(this,g[6]||"",!0),this.m=tt(g[7]||"")):(this.h=!1,this.i=new Cr(null,this.h))}wt.prototype.toString=function(){var u=[],g=this.j;g&&u.push(Yt(g,ds,!0),":");var _=this.g;return(_||g=="file")&&(u.push("//"),(g=this.o)&&u.push(Yt(g,ds,!0),"@"),u.push(encodeURIComponent(String(_)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_=this.s,_!=null&&u.push(":",String(_))),(_=this.l)&&(this.g&&_.charAt(0)!="/"&&u.push("/"),u.push(Yt(_,_.charAt(0)=="/"?Ra:ba,!0))),(_=this.i.toString())&&u.push("?",_),(_=this.m)&&u.push("#",Yt(_,$r)),u.join("")};function ot(u){return new wt(u)}function $t(u,g,_){u.j=_?tt(g,!0):g,u.j&&(u.j=u.j.replace(/:$/,""))}function Dt(u,g){if(g){if(g=Number(g),isNaN(g)||0>g)throw Error("Bad port number "+g);u.s=g}else u.s=null}function dn(u,g,_){g instanceof Cr?(u.i=g,hs(u.i,u.h)):(_||(g=Yt(g,Aa)),u.i=new Cr(g,u.h))}function et(u,g,_){u.i.set(g,_)}function it(u){return et(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function tt(u,g){return u?g?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function Yt(u,g,_){return typeof u=="string"?(u=encodeURI(u).replace(g,Ir),_&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function Ir(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var ds=/[#\/\?@]/g,ba=/[#\?:]/g,Ra=/[#\?]/g,Aa=/[#\?@]/g,$r=/#/g;function Cr(u,g){this.h=this.g=null,this.i=u||null,this.j=!!g}function In(u){u.g||(u.g=new Map,u.h=0,u.i&&rt(u.i,function(g,_){u.add(decodeURIComponent(g.replace(/\+/g," ")),_)}))}n=Cr.prototype,n.add=function(u,g){In(this),this.i=null,u=Pr(this,u);var _=this.g.get(u);return _||this.g.set(u,_=[]),_.push(g),this.h+=1,this};function Wr(u,g){In(u),g=Pr(u,g),u.g.has(g)&&(u.i=null,u.h-=u.g.get(g).length,u.g.delete(g))}function qr(u,g){return In(u),g=Pr(u,g),u.g.has(g)}n.forEach=function(u,g){In(this),this.g.forEach(function(_,T){_.forEach(function(H){u.call(g,H,T,this)},this)},this)},n.na=function(){In(this);const u=Array.from(this.g.values()),g=Array.from(this.g.keys()),_=[];for(let T=0;T<g.length;T++){const H=u[T];for(let te=0;te<H.length;te++)_.push(g[T])}return _},n.V=function(u){In(this);let g=[];if(typeof u=="string")qr(this,u)&&(g=g.concat(this.g.get(Pr(this,u))));else{u=Array.from(this.g.values());for(let _=0;_<u.length;_++)g=g.concat(u[_])}return g},n.set=function(u,g){return In(this),this.i=null,u=Pr(this,u),qr(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[g]),this.h+=1,this},n.get=function(u,g){return u?(u=this.V(u),0<u.length?String(u[0]):g):g};function si(u,g,_){Wr(u,g),0<_.length&&(u.i=null,u.g.set(Pr(u,g),Y(_)),u.h+=_.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],g=Array.from(this.g.keys());for(var _=0;_<g.length;_++){var T=g[_];const te=encodeURIComponent(String(T)),_e=this.V(T);for(T=0;T<_e.length;T++){var H=te;_e[T]!==""&&(H+="="+encodeURIComponent(String(_e[T]))),u.push(H)}}return this.i=u.join("&")};function Pr(u,g){return g=String(g),u.j&&(g=g.toLowerCase()),g}function hs(u,g){g&&!u.j&&(In(u),u.i=null,u.g.forEach(function(_,T){var H=T.toLowerCase();T!=H&&(Wr(this,T),si(this,H,_))},u)),u.j=g}function pd(u,g){const _=new P;if(f.Image){const T=new Image;T.onload=$(nr,_,"TestLoadImage: loaded",!0,g,T),T.onerror=$(nr,_,"TestLoadImage: error",!1,g,T),T.onabort=$(nr,_,"TestLoadImage: abort",!1,g,T),T.ontimeout=$(nr,_,"TestLoadImage: timeout",!1,g,T),f.setTimeout(function(){T.ontimeout&&T.ontimeout()},1e4),T.src=u}else g(!1)}function nc(u,g){const _=new P,T=new AbortController,H=setTimeout(()=>{T.abort(),nr(_,"TestPingServer: timeout",!1,g)},1e4);fetch(u,{signal:T.signal}).then(te=>{clearTimeout(H),te.ok?nr(_,"TestPingServer: ok",!0,g):nr(_,"TestPingServer: server error",!1,g)}).catch(()=>{clearTimeout(H),nr(_,"TestPingServer: error",!1,g)})}function nr(u,g,_,T,H){try{H&&(H.onload=null,H.onerror=null,H.onabort=null,H.ontimeout=null),T(_)}catch{}}function md(){this.g=new Zn}function rc(u,g,_){const T=_||"";try{Oe(u,function(H,te){let _e=H;v(H)&&(_e=hr(H)),g.push(T+te+"="+encodeURIComponent(_e))})}catch(H){throw g.push(T+"type="+encodeURIComponent("_badmap")),H}}function Vs(u){this.l=u.Ub||null,this.j=u.eb||!1}q(Vs,Ur),Vs.prototype.g=function(){return new Ki(this.l,this.j)},Vs.prototype.i=(function(u){return function(){return u}})({});function Ki(u,g){At.call(this),this.D=u,this.o=g,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}q(Ki,At),n=Ki.prototype,n.open=function(u,g){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=g,this.readyState=1,Gr(this)},n.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const g={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(g.body=u),(this.D||f).fetch(new Request(this.A,g)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Hr(this)),this.readyState=0},n.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,Gr(this)),this.g&&(this.readyState=3,Gr(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof f.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;sc(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function sc(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}n.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var g=u.value?u.value:new Uint8Array(0);(g=this.v.decode(g,{stream:!u.done}))&&(this.response=this.responseText+=g)}u.done?Hr(this):Gr(this),this.readyState==3&&sc(this)}},n.Ra=function(u){this.g&&(this.response=this.responseText=u,Hr(this))},n.Qa=function(u){this.g&&(this.response=u,Hr(this))},n.ga=function(){this.g&&Hr(this)};function Hr(u){u.readyState=4,u.l=null,u.j=null,u.v=null,Gr(u)}n.setRequestHeader=function(u,g){this.u.append(u,g)},n.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],g=this.h.entries();for(var _=g.next();!_.done;)_=_.value,u.push(_[0]+": "+_[1]),_=g.next();return u.join(`\r
`)};function Gr(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(Ki.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function Ls(u){let g="";return Se(u,function(_,T){g+=T,g+=":",g+=_,g+=`\r
`}),g}function ii(u,g,_){e:{for(T in _){var T=!1;break e}T=!0}T||(_=Ls(_),typeof u=="string"?_!=null&&encodeURIComponent(String(_)):et(u,g,_))}function Ut(u){At.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}q(Ut,At);var gd=/^https?$/i,Lo=["POST","PUT"];n=Ut.prototype,n.Ha=function(u){this.J=u},n.ea=function(u,g,_,T){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);g=g?g.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():we.g(),this.v=this.o?Et(this.o):Et(we),this.g.onreadystatechange=C(this.Ea,this);try{this.B=!0,this.g.open(g,String(u),!0),this.B=!1}catch(te){Qi(this,te);return}if(u=_||"",_=new Map(this.headers),T)if(Object.getPrototypeOf(T)===Object.prototype)for(var H in T)_.set(H,T[H]);else if(typeof T.keys=="function"&&typeof T.get=="function")for(const te of T.keys())_.set(te,T.get(te));else throw Error("Unknown input type for opt_headers: "+String(T));T=Array.from(_.keys()).find(te=>te.toLowerCase()=="content-type"),H=f.FormData&&u instanceof f.FormData,!(0<=Array.prototype.indexOf.call(Lo,g,void 0))||T||H||_.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[te,_e]of _)this.g.setRequestHeader(te,_e);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{ka(this),this.u=!0,this.g.send(u),this.u=!1}catch(te){Qi(this,te)}};function Qi(u,g){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=g,u.m=5,Na(u),mr(u)}function Na(u){u.A||(u.A=!0,Ye(u,"complete"),Ye(u,"error"))}n.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,Ye(this,"complete"),Ye(this,"abort"),mr(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),mr(this,!0)),Ut.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Oo(this):this.bb())},n.bb=function(){Oo(this)};function Oo(u){if(u.h&&typeof d<"u"&&(!u.v[1]||rr(u)!=4||u.Z()!=2)){if(u.u&&rr(u)==4)As(u.Ea,0,u);else if(Ye(u,"readystatechange"),rr(u)==4){u.h=!1;try{const _e=u.Z();e:switch(_e){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var g=!0;break e;default:g=!1}var _;if(!(_=g)){var T;if(T=_e===0){var H=String(u.D).match(Te)[1]||null;!H&&f.self&&f.self.location&&(H=f.self.location.protocol.slice(0,-1)),T=!gd.test(H?H.toLowerCase():"")}_=T}if(_)Ye(u,"complete"),Ye(u,"success");else{u.m=6;try{var te=2<rr(u)?u.g.statusText:""}catch{te=""}u.l=te+" ["+u.Z()+"]",Na(u)}}finally{mr(u)}}}}function mr(u,g){if(u.g){ka(u);const _=u.g,T=u.v[0]?()=>{}:null;u.g=null,u.v=null,g||Ye(u,"ready");try{_.onreadystatechange=T}catch{}}}function ka(u){u.I&&(f.clearTimeout(u.I),u.I=null)}n.isActive=function(){return!!this.g};function rr(u){return u.g?u.g.readyState:0}n.Z=function(){try{return 2<rr(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(u){if(this.g){var g=this.g.responseText;return u&&g.indexOf(u)==0&&(g=g.substring(u.length)),Ns(g)}};function Mo(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function ja(u){const g={};u=(u.g&&2<=rr(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let T=0;T<u.length;T++){if(ge(u[T]))continue;var _=M(u[T]);const H=_[0];if(_=_[1],typeof _!="string")continue;_=_.trim();const te=g[H]||[];g[H]=te,te.push(_)}N(g,function(T){return T.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function fs(u,g,_){return _&&_.internalChannelParams&&_.internalChannelParams[u]||g}function Fo(u){this.Aa=0,this.i=[],this.j=new P,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=fs("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=fs("baseRetryDelayMs",5e3,u),this.cb=fs("retryDelaySeedMs",1e4,u),this.Wa=fs("forwardChannelMaxRetries",2,u),this.wa=fs("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new us(u&&u.concurrentRequestLimit),this.Da=new md,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Fo.prototype,n.la=8,n.G=1,n.connect=function(u,g,_,T){_t(0),this.W=u,this.H=g||{},_&&T!==void 0&&(this.H.OSID=_,this.H.OAID=T),this.F=this.X,this.I=lc(this,null,this.W),ps(this)};function Cn(u){if(Da(u),u.G==3){var g=u.U++,_=ot(u.I);if(et(_,"SID",u.K),et(_,"RID",g),et(_,"TYPE","terminate"),Os(u,_),g=new ht(u,u.j,g),g.L=2,g.v=it(ot(_)),_=!1,f.navigator&&f.navigator.sendBeacon)try{_=f.navigator.sendBeacon(g.v.toString(),"")}catch{}!_&&f.Image&&(new Image().src=g.v,_=!0),_||(g.g=cc(g.j,null),g.g.ea(g.v)),g.F=Date.now(),ft(g)}oc(u)}function Kr(u){u.g&&(Uo(u),u.g.cancel(),u.g=null)}function Da(u){Kr(u),u.u&&(f.clearTimeout(u.u),u.u=null),Oa(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&f.clearTimeout(u.s),u.s=null)}function ps(u){if(!Kn(u.h)&&!u.s){u.s=!0;var g=u.Ga;We||se(),V||(We(),V=!0),ne.add(g,u),u.B=0}}function yd(u,g){return Pa(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=g.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=Ct(C(u.Ga,u,g),ac(u,u.B)),u.B++,!0)}n.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;const H=new ht(this,this.j,u);let te=this.o;if(this.S&&(te?(te=R(te),L(te,this.S)):te=this.S),this.m!==null||this.O||(H.H=te,te=null),this.P)e:{for(var g=0,_=0;_<this.i.length;_++){t:{var T=this.i[_];if("__data__"in T.map&&(T=T.map.__data__,typeof T=="string")){T=T.length;break t}T=void 0}if(T===void 0)break;if(g+=T,4096<g){g=_;break e}if(g===4096||_===this.i.length-1){g=_+1;break e}}g=1e3}else g=1e3;g=ai(this,H,g),_=ot(this.I),et(_,"RID",u),et(_,"CVER",22),this.D&&et(_,"X-HTTP-Session-Id",this.D),Os(this,_),te&&(this.O?g="headers="+encodeURIComponent(String(Ls(te)))+"&"+g:this.m&&ii(_,this.m,te)),I(this.h,H),this.Ua&&et(_,"TYPE","init"),this.P?(et(_,"$req",g),et(_,"SID","null"),H.T=!0,zr(H,_,null)):zr(H,_,g),this.G=2}}else this.G==3&&(u?Va(this,u):this.i.length==0||Kn(this.h)||Va(this))};function Va(u,g){var _;g?_=g.l:_=u.U++;const T=ot(u.I);et(T,"SID",u.K),et(T,"RID",_),et(T,"AID",u.T),Os(u,T),u.m&&u.o&&ii(T,u.m,u.o),_=new ht(u,u.j,_,u.B+1),u.m===null&&(_.H=u.o),g&&(u.i=g.D.concat(u.i)),g=ai(u,_,1e3),_.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),I(u.h,_),zr(_,T,g)}function Os(u,g){u.H&&Se(u.H,function(_,T){et(g,T,_)}),u.l&&Oe({},function(_,T){et(g,T,_)})}function ai(u,g,_){_=Math.min(u.i.length,_);var T=u.l?C(u.l.Na,u.l,u):null;e:{var H=u.i;let te=-1;for(;;){const _e=["count="+_];te==-1?0<_?(te=H[0].g,_e.push("ofs="+te)):te=0:_e.push("ofs="+te);let St=!0;for(let hn=0;hn<_;hn++){let pt=H[hn].g;const yn=H[hn].map;if(pt-=te,0>pt)te=Math.max(0,H[hn].g-100),St=!1;else try{rc(yn,_e,"req"+pt+"_")}catch{T&&T(yn)}}if(St){T=_e.join("&");break e}}}return u=u.i.splice(0,_),g.D=u,T}function Yi(u){if(!u.g&&!u.u){u.Y=1;var g=u.Fa;We||se(),V||(We(),V=!0),ne.add(g,u),u.v=0}}function La(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=Ct(C(u.Fa,u),ac(u,u.v)),u.v++,!0)}n.Fa=function(){if(this.u=null,ic(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=Ct(C(this.ab,this),u)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,_t(10),Kr(this),ic(this))};function Uo(u){u.A!=null&&(f.clearTimeout(u.A),u.A=null)}function ic(u){u.g=new ht(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var g=ot(u.qa);et(g,"RID","rpc"),et(g,"SID",u.K),et(g,"AID",u.T),et(g,"CI",u.F?"0":"1"),!u.F&&u.ja&&et(g,"TO",u.ja),et(g,"TYPE","xmlhttp"),Os(u,g),u.m&&u.o&&ii(g,u.m,u.o),u.L&&(u.g.I=u.L);var _=u.g;u=u.ia,_.L=1,_.v=it(ot(g)),_.m=null,_.P=!0,js(_,u)}n.Za=function(){this.C!=null&&(this.C=null,Kr(this),La(this),_t(19))};function Oa(u){u.C!=null&&(f.clearTimeout(u.C),u.C=null)}function Ma(u,g){var _=null;if(u.g==g){Oa(u),Uo(u),u.g=null;var T=2}else if(Sn(u.h,g))_=g.D,U(u.h,g),T=1;else return;if(u.G!=0){if(g.o)if(T==1){_=g.m?g.m.length:0,g=Date.now()-g.F;var H=u.B;T=sn(),Ye(T,new tr(T,_)),ps(u)}else Yi(u);else if(H=g.s,H==3||H==0&&0<g.X||!(T==1&&yd(u,g)||T==2&&La(u)))switch(_&&0<_.length&&(g=u.h,g.i=g.i.concat(_)),H){case 1:Ms(u,5);break;case 4:Ms(u,10);break;case 3:Ms(u,6);break;default:Ms(u,2)}}}function ac(u,g){let _=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(_*=2),_*g}function Ms(u,g){if(u.j.info("Error code "+g),g==2){var _=C(u.fb,u),T=u.Xa;const H=!T;T=new wt(T||"//www.google.com/images/cleardot.gif"),f.location&&f.location.protocol=="http"||$t(T,"https"),it(T),H?pd(T.toString(),_):nc(T.toString(),_)}else _t(2);u.G=0,u.l&&u.l.sa(g),oc(u),Da(u)}n.fb=function(u){u?(this.j.info("Successfully pinged google.com"),_t(2)):(this.j.info("Failed to ping google.com"),_t(1))};function oc(u){if(u.G=0,u.ka=[],u.l){const g=W(u.h);(g.length!=0||u.i.length!=0)&&(F(u.ka,g),F(u.ka,u.i),u.h.i.length=0,Y(u.i),u.i.length=0),u.l.ra()}}function lc(u,g,_){var T=_ instanceof wt?ot(_):new wt(_);if(T.g!="")g&&(T.g=g+"."+T.g),Dt(T,T.s);else{var H=f.location;T=H.protocol,g=g?g+"."+H.hostname:H.hostname,H=+H.port;var te=new wt(null);T&&$t(te,T),g&&(te.g=g),H&&Dt(te,H),_&&(te.l=_),T=te}return _=u.D,g=u.ya,_&&g&&et(T,_,g),et(T,"VER",u.la),Os(u,T),T}function cc(u,g,_){if(g&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return g=u.Ca&&!u.pa?new Ut(new Vs({eb:_})):new Ut(u.pa),g.Ha(u.J),g}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function zo(){}n=zo.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Fa(){}Fa.prototype.g=function(u,g){return new Qn(u,g)};function Qn(u,g){At.call(this),this.g=new Fo(g),this.l=u,this.h=g&&g.messageUrlParams||null,u=g&&g.messageHeaders||null,g&&g.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=g&&g.initMessageHeaders||null,g&&g.messageContentType&&(u?u["X-WebChannel-Content-Type"]=g.messageContentType:u={"X-WebChannel-Content-Type":g.messageContentType}),g&&g.va&&(u?u["X-WebChannel-Client-Profile"]=g.va:u={"X-WebChannel-Client-Profile":g.va}),this.g.S=u,(u=g&&g.Sb)&&!ge(u)&&(this.g.m=u),this.v=g&&g.supportsCrossDomainXhr||!1,this.u=g&&g.sendRawJson||!1,(g=g&&g.httpSessionIdParam)&&!ge(g)&&(this.g.D=g,u=this.h,u!==null&&g in u&&(u=this.h,g in u&&delete u[g])),this.j=new ms(this)}q(Qn,At),Qn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Qn.prototype.close=function(){Cn(this.g)},Qn.prototype.o=function(u){var g=this.g;if(typeof u=="string"){var _={};_.__data__=u,u=_}else this.u&&(_={},_.__data__=hr(u),u=_);g.i.push(new Sr(g.Ya++,u)),g.G==3&&ps(g)},Qn.prototype.N=function(){this.g.l=null,delete this.j,Cn(this.g),delete this.g,Qn.aa.N.call(this)};function uc(u){rn.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var g=u.__sm__;if(g){e:{for(const _ in g){u=_;break e}u=void 0}(this.i=u)&&(u=this.i,g=g!==null&&u in g?g[u]:void 0),this.data=g}else this.data=u}q(uc,rn);function dc(){fr.call(this),this.status=1}q(dc,fr);function ms(u){this.g=u}q(ms,zo),ms.prototype.ua=function(){Ye(this.g,"a")},ms.prototype.ta=function(u){Ye(this.g,new uc(u))},ms.prototype.sa=function(u){Ye(this.g,new dc)},ms.prototype.ra=function(){Ye(this.g,"b")},Fa.prototype.createWebChannel=Fa.prototype.g,Qn.prototype.send=Qn.prototype.o,Qn.prototype.open=Qn.prototype.m,Qn.prototype.close=Qn.prototype.close,o0=function(){return new Fa},a0=function(){return sn()},i0=Dn,gf={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Le.NO_ERROR=0,Le.TIMEOUT=8,Le.HTTP_ERROR=6,mu=Le,Pt.COMPLETE="complete",s0=Pt,ks.EventType=Ft,Ft.OPEN="a",Ft.CLOSE="b",Ft.ERROR="c",Ft.MESSAGE="d",At.prototype.listen=At.prototype.K,vl=ks,Ut.prototype.listenOnce=Ut.prototype.L,Ut.prototype.getLastError=Ut.prototype.Ka,Ut.prototype.getLastErrorCode=Ut.prototype.Ba,Ut.prototype.getStatus=Ut.prototype.Z,Ut.prototype.getResponseJson=Ut.prototype.Oa,Ut.prototype.getResponseText=Ut.prototype.oa,Ut.prototype.send=Ut.prototype.ea,Ut.prototype.setWithCredentials=Ut.prototype.Ha,r0=Ut}).apply(typeof au<"u"?au:typeof self<"u"?self:typeof window<"u"?window:{});const Ly="@firebase/firestore",Oy="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Bn.UNAUTHENTICATED=new Bn(null),Bn.GOOGLE_CREDENTIALS=new Bn("google-credentials-uid"),Bn.FIRST_PARTY=new Bn("first-party-uid"),Bn.MOCK_USER=new Bn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ao="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xa=new Uf("@firebase/firestore");function lo(){return xa.logLevel}function Pe(n,...e){if(xa.logLevel<=lt.DEBUG){const t=e.map(ep);xa.debug(`Firestore (${Ao}): ${n}`,...t)}}function ei(n,...e){if(xa.logLevel<=lt.ERROR){const t=e.map(ep);xa.error(`Firestore (${Ao}): ${n}`,...t)}}function Di(n,...e){if(xa.logLevel<=lt.WARN){const t=e.map(ep);xa.warn(`Firestore (${Ao}): ${n}`,...t)}}function ep(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function He(n,e,t){let s="Unexpected state";typeof e=="string"?s=e:t=e,l0(n,s,t)}function l0(n,e,t){let s=`FIRESTORE (${Ao}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{s+=" CONTEXT: "+JSON.stringify(t)}catch{s+=" CONTEXT: "+t}throw ei(s),new Error(s)}function Tt(n,e,t,s){let a="Unexpected state";typeof t=="string"?a=t:s=t,n||l0(e,a,s)}function Xe(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ie={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ie extends ni{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ys{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c0{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class sC{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Bn.UNAUTHENTICATED)))}shutdown(){}}class iC{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class aC{constructor(e){this.t=e,this.currentUser=Bn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Tt(this.o===void 0,42304);let s=this.i;const a=m=>this.i!==s?(s=this.i,t(m)):Promise.resolve();let l=new Ys;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new Ys,e.enqueueRetryable((()=>a(this.currentUser)))};const d=()=>{const m=l;e.enqueueRetryable((async()=>{await m.promise,await a(this.currentUser)}))},f=m=>{Pe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=m,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit((m=>f(m))),setTimeout((()=>{if(!this.auth){const m=this.t.getImmediate({optional:!0});m?f(m):(Pe("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new Ys)}}),0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((s=>this.i!==e?(Pe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(Tt(typeof s.accessToken=="string",31837,{l:s}),new c0(s.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Tt(e===null||typeof e=="string",2055,{h:e}),new Bn(e)}}class oC{constructor(e,t,s){this.P=e,this.T=t,this.I=s,this.type="FirstParty",this.user=Bn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class lC{constructor(e,t,s){this.P=e,this.T=t,this.I=s}getToken(){return Promise.resolve(new oC(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Bn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class My{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class cC{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,wr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Tt(this.o===void 0,3512);const s=l=>{l.error!=null&&Pe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const d=l.token!==this.m;return this.m=l.token,Pe("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?t(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable((()=>s(l)))};const a=l=>{Pe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((l=>a(l))),setTimeout((()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?a(l):Pe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new My(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Tt(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new My(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uC(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let s=0;s<n;s++)t[s]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u0(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tp{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let s="";for(;s.length<20;){const a=uC(40);for(let l=0;l<a.length;++l)s.length<20&&a[l]<t&&(s+=e.charAt(a[l]%62))}return s}}function st(n,e){return n<e?-1:n>e?1:0}function yf(n,e){let t=0;for(;t<n.length&&t<e.length;){const s=n.codePointAt(t),a=e.codePointAt(t);if(s!==a){if(s<128&&a<128)return st(s,a);{const l=u0(),d=dC(l.encode(Fy(n,t)),l.encode(Fy(e,t)));return d!==0?d:st(s,a)}}t+=s>65535?2:1}return st(n.length,e.length)}function Fy(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function dC(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return st(n[t],e[t]);return st(n.length,e.length)}function wo(n,e,t){return n.length===e.length&&n.every(((s,a)=>t(s,e[a])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uy="__name__";class ws{constructor(e,t,s){t===void 0?t=0:t>e.length&&He(637,{offset:t,range:e.length}),s===void 0?s=e.length-t:s>e.length-t&&He(1746,{length:s,range:e.length-t}),this.segments=e,this.offset=t,this.len=s}get length(){return this.len}isEqual(e){return ws.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof ws?e.forEach((s=>{t.push(s)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,s=this.limit();t<s;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const s=Math.min(e.length,t.length);for(let a=0;a<s;a++){const l=ws.compareSegments(e.get(a),t.get(a));if(l!==0)return l}return st(e.length,t.length)}static compareSegments(e,t){const s=ws.isNumericId(e),a=ws.isNumericId(t);return s&&!a?-1:!s&&a?1:s&&a?ws.extractNumericId(e).compare(ws.extractNumericId(t)):yf(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ki.fromString(e.substring(4,e.length-2))}}class kt extends ws{construct(e,t,s){return new kt(e,t,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const s of e){if(s.indexOf("//")>=0)throw new Ie(ie.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);t.push(...s.split("/").filter((a=>a.length>0)))}return new kt(t)}static emptyPath(){return new kt([])}}const hC=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Nn extends ws{construct(e,t,s){return new Nn(e,t,s)}static isValidIdentifier(e){return hC.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Nn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Uy}static keyField(){return new Nn([Uy])}static fromServerFormat(e){const t=[];let s="",a=0;const l=()=>{if(s.length===0)throw new Ie(ie.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(s),s=""};let d=!1;for(;a<e.length;){const f=e[a];if(f==="\\"){if(a+1===e.length)throw new Ie(ie.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const m=e[a+1];if(m!=="\\"&&m!=="."&&m!=="`")throw new Ie(ie.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=m,a+=2}else f==="`"?(d=!d,a++):f!=="."||d?(s+=f,a++):(l(),a++)}if(l(),d)throw new Ie(ie.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Nn(t)}static emptyPath(){return new Nn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fe{constructor(e){this.path=e}static fromPath(e){return new Fe(kt.fromString(e))}static fromName(e){return new Fe(kt.fromString(e).popFirst(5))}static empty(){return new Fe(kt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&kt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return kt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Fe(new kt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d0(n,e,t){if(!t)throw new Ie(ie.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function fC(n,e,t,s){if(e===!0&&s===!0)throw new Ie(ie.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function zy(n){if(!Fe.isDocumentKey(n))throw new Ie(ie.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function By(n){if(Fe.isDocumentKey(n))throw new Ie(ie.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function h0(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Ku(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(s){return s.constructor?s.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":He(12329,{type:typeof n})}function is(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Ie(ie.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Ku(n);throw new Ie(ie.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function un(n,e){const t={typeString:n};return e&&(t.value=e),t}function Gl(n,e){if(!h0(n))throw new Ie(ie.INVALID_ARGUMENT,"JSON must be an object");let t;for(const s in e)if(e[s]){const a=e[s].typeString,l="value"in e[s]?{value:e[s].value}:void 0;if(!(s in n)){t=`JSON missing required field: '${s}'`;break}const d=n[s];if(a&&typeof d!==a){t=`JSON field '${s}' must be a ${a}.`;break}if(l!==void 0&&d!==l.value){t=`Expected '${s}' field to equal '${l.value}'`;break}}if(t)throw new Ie(ie.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $y=-62135596800,Wy=1e6;class Mt{static now(){return Mt.fromMillis(Date.now())}static fromDate(e){return Mt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),s=Math.floor((e-1e3*t)*Wy);return new Mt(t,s)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ie(ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ie(ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<$y)throw new Ie(ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ie(ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Wy}_compareTo(e){return this.seconds===e.seconds?st(this.nanoseconds,e.nanoseconds):st(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Mt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Gl(e,Mt._jsonSchema))return new Mt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-$y;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Mt._jsonSchemaVersion="firestore/timestamp/1.0",Mt._jsonSchema={type:un("string",Mt._jsonSchemaVersion),seconds:un("number"),nanoseconds:un("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Je{static fromTimestamp(e){return new Je(e)}static min(){return new Je(new Mt(0,0))}static max(){return new Je(new Mt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jl=-1;function pC(n,e){const t=n.toTimestamp().seconds,s=n.toTimestamp().nanoseconds+1,a=Je.fromTimestamp(s===1e9?new Mt(t+1,0):new Mt(t,s));return new Vi(a,Fe.empty(),e)}function mC(n){return new Vi(n.readTime,n.key,jl)}class Vi{constructor(e,t,s){this.readTime=e,this.documentKey=t,this.largestBatchId=s}static min(){return new Vi(Je.min(),Fe.empty(),jl)}static max(){return new Vi(Je.max(),Fe.empty(),jl)}}function gC(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Fe.comparator(n.documentKey,e.documentKey),t!==0?t:st(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yC="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class vC{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function No(n){if(n.code!==ie.FAILED_PRECONDITION||n.message!==yC)throw n;Pe("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ae{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&He(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ae(((s,a)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(s,a)},this.catchCallback=l=>{this.wrapFailure(t,l).next(s,a)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof ae?t:ae.resolve(t)}catch(t){return ae.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):ae.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):ae.reject(t)}static resolve(e){return new ae(((t,s)=>{t(e)}))}static reject(e){return new ae(((t,s)=>{s(e)}))}static waitFor(e){return new ae(((t,s)=>{let a=0,l=0,d=!1;e.forEach((f=>{++a,f.next((()=>{++l,d&&l===a&&t()}),(m=>s(m)))})),d=!0,l===a&&t()}))}static or(e){let t=ae.resolve(!1);for(const s of e)t=t.next((a=>a?ae.resolve(a):s()));return t}static forEach(e,t){const s=[];return e.forEach(((a,l)=>{s.push(t.call(this,a,l))})),this.waitFor(s)}static mapArray(e,t){return new ae(((s,a)=>{const l=e.length,d=new Array(l);let f=0;for(let m=0;m<l;m++){const v=m;t(e[v]).next((w=>{d[v]=w,++f,f===l&&s(d)}),(w=>a(w)))}}))}static doWhile(e,t){return new ae(((s,a)=>{const l=()=>{e()===!0?t().next((()=>{l()}),a):s()};l()}))}}function _C(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function ko(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qu{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=s=>this._e(s),this.ae=s=>t.writeSequenceNumber(s))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}}Qu.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const np=-1;function Yu(n){return n==null}function Nu(n){return n===0&&1/n==-1/0}function wC(n){return typeof n=="number"&&Number.isInteger(n)&&!Nu(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f0="";function xC(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=qy(e)),e=EC(n.get(t),e);return qy(e)}function EC(n,e){let t=e;const s=n.length;for(let a=0;a<s;a++){const l=n.charAt(a);switch(l){case"\0":t+="";break;case f0:t+="";break;default:t+=l}}return t}function qy(n){return n+f0+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hy(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function qi(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function p0(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ht{constructor(e,t){this.comparator=e,this.root=t||Rn.EMPTY}insert(e,t){return new Ht(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Rn.BLACK,null,null))}remove(e){return new Ht(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Rn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const s=this.comparator(e,t.key);if(s===0)return t.value;s<0?t=t.left:s>0&&(t=t.right)}return null}indexOf(e){let t=0,s=this.root;for(;!s.isEmpty();){const a=this.comparator(e,s.key);if(a===0)return t+s.left.size;a<0?s=s.left:(t+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,s)=>(e(t,s),!1)))}toString(){const e=[];return this.inorderTraversal(((t,s)=>(e.push(`${t}:${s}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ou(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ou(this.root,e,this.comparator,!1)}getReverseIterator(){return new ou(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ou(this.root,e,this.comparator,!0)}}class ou{constructor(e,t,s,a){this.isReverse=a,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=t?s(e.key,t):1,t&&a&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Rn{constructor(e,t,s,a,l){this.key=e,this.value=t,this.color=s??Rn.RED,this.left=a??Rn.EMPTY,this.right=l??Rn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,s,a,l){return new Rn(e??this.key,t??this.value,s??this.color,a??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,s){let a=this;const l=s(e,a.key);return a=l<0?a.copy(null,null,null,a.left.insert(e,t,s),null):l===0?a.copy(null,t,null,null,null):a.copy(null,null,null,null,a.right.insert(e,t,s)),a.fixUp()}removeMin(){if(this.left.isEmpty())return Rn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let s,a=this;if(t(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,t),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),t(e,a.key)===0){if(a.right.isEmpty())return Rn.EMPTY;s=a.right.min(),a=a.copy(s.key,s.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,t))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Rn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Rn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw He(43730,{key:this.key,value:this.value});if(this.right.isRed())throw He(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw He(27949);return e+(this.isRed()?0:1)}}Rn.EMPTY=null,Rn.RED=!0,Rn.BLACK=!1;Rn.EMPTY=new class{constructor(){this.size=0}get key(){throw He(57766)}get value(){throw He(16141)}get color(){throw He(16727)}get left(){throw He(29726)}get right(){throw He(36894)}copy(e,t,s,a,l){return this}insert(e,t,s){return new Rn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mn{constructor(e){this.comparator=e,this.data=new Ht(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,s)=>(e(t),!1)))}forEachInRange(e,t){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const a=s.getNext();if(this.comparator(a.key,e[1])>=0)return;t(a.key)}}forEachWhile(e,t){let s;for(s=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Gy(this.data.getIterator())}getIteratorFrom(e){return new Gy(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((s=>{t=t.add(s)})),t}isEqual(e){if(!(e instanceof mn)||this.size!==e.size)return!1;const t=this.data.getIterator(),s=e.data.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=s.getNext().key;if(this.comparator(a,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new mn(this.comparator);return t.data=e,t}}class Gy{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xr{constructor(e){this.fields=e,e.sort(Nn.comparator)}static empty(){return new xr([])}unionWith(e){let t=new mn(Nn.comparator);for(const s of this.fields)t=t.add(s);for(const s of e)t=t.add(s);return new xr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return wo(this.fields,e.fields,((t,s)=>t.isEqual(s)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m0 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(a){try{return atob(a)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new m0("Invalid base64 string: "+l):l}})(e);return new kn(t)}static fromUint8Array(e){const t=(function(a){let l="";for(let d=0;d<a.length;++d)l+=String.fromCharCode(a[d]);return l})(e);return new kn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const s=new Uint8Array(t.length);for(let a=0;a<t.length;a++)s[a]=t.charCodeAt(a);return s})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return st(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}kn.EMPTY_BYTE_STRING=new kn("");const TC=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Li(n){if(Tt(!!n,39018),typeof n=="string"){let e=0;const t=TC.exec(n);if(Tt(!!t,46558,{timestamp:n}),t[1]){let a=t[1];a=(a+"000000000").substr(0,9),e=Number(a)}const s=new Date(n);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:Xt(n.seconds),nanos:Xt(n.nanos)}}function Xt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Oi(n){return typeof n=="string"?kn.fromBase64String(n):kn.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g0="server_timestamp",y0="__type__",v0="__previous_value__",_0="__local_write_time__";function rp(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[y0])===null||t===void 0?void 0:t.stringValue)===g0}function Ju(n){const e=n.mapValue.fields[v0];return rp(e)?Ju(e):e}function Dl(n){const e=Li(n.mapValue.fields[_0].timestampValue);return new Mt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SC{constructor(e,t,s,a,l,d,f,m,v,w){this.databaseId=e,this.appId=t,this.persistenceKey=s,this.host=a,this.ssl=l,this.forceLongPolling=d,this.autoDetectLongPolling=f,this.longPollingOptions=m,this.useFetchStreams=v,this.isUsingEmulator=w}}const ku="(default)";class Vl{constructor(e,t){this.projectId=e,this.database=t||ku}static empty(){return new Vl("","")}get isDefaultDatabase(){return this.database===ku}isEqual(e){return e instanceof Vl&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w0="__type__",IC="__max__",lu={mapValue:{}},x0="__vector__",ju="value";function Mi(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?rp(n)?4:PC(n)?9007199254740991:CC(n)?10:11:He(28295,{value:n})}function Rs(n,e){if(n===e)return!0;const t=Mi(n);if(t!==Mi(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Dl(n).isEqual(Dl(e));case 3:return(function(a,l){if(typeof a.timestampValue=="string"&&typeof l.timestampValue=="string"&&a.timestampValue.length===l.timestampValue.length)return a.timestampValue===l.timestampValue;const d=Li(a.timestampValue),f=Li(l.timestampValue);return d.seconds===f.seconds&&d.nanos===f.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(a,l){return Oi(a.bytesValue).isEqual(Oi(l.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(a,l){return Xt(a.geoPointValue.latitude)===Xt(l.geoPointValue.latitude)&&Xt(a.geoPointValue.longitude)===Xt(l.geoPointValue.longitude)})(n,e);case 2:return(function(a,l){if("integerValue"in a&&"integerValue"in l)return Xt(a.integerValue)===Xt(l.integerValue);if("doubleValue"in a&&"doubleValue"in l){const d=Xt(a.doubleValue),f=Xt(l.doubleValue);return d===f?Nu(d)===Nu(f):isNaN(d)&&isNaN(f)}return!1})(n,e);case 9:return wo(n.arrayValue.values||[],e.arrayValue.values||[],Rs);case 10:case 11:return(function(a,l){const d=a.mapValue.fields||{},f=l.mapValue.fields||{};if(Hy(d)!==Hy(f))return!1;for(const m in d)if(d.hasOwnProperty(m)&&(f[m]===void 0||!Rs(d[m],f[m])))return!1;return!0})(n,e);default:return He(52216,{left:n})}}function Ll(n,e){return(n.values||[]).find((t=>Rs(t,e)))!==void 0}function xo(n,e){if(n===e)return 0;const t=Mi(n),s=Mi(e);if(t!==s)return st(t,s);switch(t){case 0:case 9007199254740991:return 0;case 1:return st(n.booleanValue,e.booleanValue);case 2:return(function(l,d){const f=Xt(l.integerValue||l.doubleValue),m=Xt(d.integerValue||d.doubleValue);return f<m?-1:f>m?1:f===m?0:isNaN(f)?isNaN(m)?0:-1:1})(n,e);case 3:return Ky(n.timestampValue,e.timestampValue);case 4:return Ky(Dl(n),Dl(e));case 5:return yf(n.stringValue,e.stringValue);case 6:return(function(l,d){const f=Oi(l),m=Oi(d);return f.compareTo(m)})(n.bytesValue,e.bytesValue);case 7:return(function(l,d){const f=l.split("/"),m=d.split("/");for(let v=0;v<f.length&&v<m.length;v++){const w=st(f[v],m[v]);if(w!==0)return w}return st(f.length,m.length)})(n.referenceValue,e.referenceValue);case 8:return(function(l,d){const f=st(Xt(l.latitude),Xt(d.latitude));return f!==0?f:st(Xt(l.longitude),Xt(d.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Qy(n.arrayValue,e.arrayValue);case 10:return(function(l,d){var f,m,v,w;const E=l.fields||{},C=d.fields||{},$=(f=E[ju])===null||f===void 0?void 0:f.arrayValue,q=(m=C[ju])===null||m===void 0?void 0:m.arrayValue,Y=st(((v=$==null?void 0:$.values)===null||v===void 0?void 0:v.length)||0,((w=q==null?void 0:q.values)===null||w===void 0?void 0:w.length)||0);return Y!==0?Y:Qy($,q)})(n.mapValue,e.mapValue);case 11:return(function(l,d){if(l===lu.mapValue&&d===lu.mapValue)return 0;if(l===lu.mapValue)return 1;if(d===lu.mapValue)return-1;const f=l.fields||{},m=Object.keys(f),v=d.fields||{},w=Object.keys(v);m.sort(),w.sort();for(let E=0;E<m.length&&E<w.length;++E){const C=yf(m[E],w[E]);if(C!==0)return C;const $=xo(f[m[E]],v[w[E]]);if($!==0)return $}return st(m.length,w.length)})(n.mapValue,e.mapValue);default:throw He(23264,{le:t})}}function Ky(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return st(n,e);const t=Li(n),s=Li(e),a=st(t.seconds,s.seconds);return a!==0?a:st(t.nanos,s.nanos)}function Qy(n,e){const t=n.values||[],s=e.values||[];for(let a=0;a<t.length&&a<s.length;++a){const l=xo(t[a],s[a]);if(l)return l}return st(t.length,s.length)}function Eo(n){return vf(n)}function vf(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const s=Li(t);return`time(${s.seconds},${s.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Oi(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Fe.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let s="[",a=!0;for(const l of t.values||[])a?a=!1:s+=",",s+=vf(l);return s+"]"})(n.arrayValue):"mapValue"in n?(function(t){const s=Object.keys(t.fields||{}).sort();let a="{",l=!0;for(const d of s)l?l=!1:a+=",",a+=`${d}:${vf(t.fields[d])}`;return a+"}"})(n.mapValue):He(61005,{value:n})}function gu(n){switch(Mi(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Ju(n);return e?16+gu(e):16;case 5:return 2*n.stringValue.length;case 6:return Oi(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(s){return(s.values||[]).reduce(((a,l)=>a+gu(l)),0)})(n.arrayValue);case 10:case 11:return(function(s){let a=0;return qi(s.fields,((l,d)=>{a+=l.length+gu(d)})),a})(n.mapValue);default:throw He(13486,{value:n})}}function Yy(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function _f(n){return!!n&&"integerValue"in n}function sp(n){return!!n&&"arrayValue"in n}function Jy(n){return!!n&&"nullValue"in n}function Xy(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function yu(n){return!!n&&"mapValue"in n}function CC(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[w0])===null||t===void 0?void 0:t.stringValue)===x0}function Il(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return qi(n.mapValue.fields,((t,s)=>e.mapValue.fields[t]=Il(s))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Il(n.arrayValue.values[t]);return e}return Object.assign({},n)}function PC(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===IC}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dr{constructor(e){this.value=e}static empty(){return new dr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let s=0;s<e.length-1;++s)if(t=(t.mapValue.fields||{})[e.get(s)],!yu(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Il(t)}setAll(e){let t=Nn.emptyPath(),s={},a=[];e.forEach(((d,f)=>{if(!t.isImmediateParentOf(f)){const m=this.getFieldsMap(t);this.applyChanges(m,s,a),s={},a=[],t=f.popLast()}d?s[f.lastSegment()]=Il(d):a.push(f.lastSegment())}));const l=this.getFieldsMap(t);this.applyChanges(l,s,a)}delete(e){const t=this.field(e.popLast());yu(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Rs(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let s=0;s<e.length;++s){let a=t.mapValue.fields[e.get(s)];yu(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},t.mapValue.fields[e.get(s)]=a),t=a}return t.mapValue.fields}applyChanges(e,t,s){qi(t,((a,l)=>e[a]=l));for(const a of s)delete e[a]}clone(){return new dr(Il(this.value))}}function E0(n){const e=[];return qi(n.fields,((t,s)=>{const a=new Nn([t]);if(yu(s)){const l=E0(s.mapValue).fields;if(l.length===0)e.push(a);else for(const d of l)e.push(a.child(d))}else e.push(a)})),new xr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $n{constructor(e,t,s,a,l,d,f){this.key=e,this.documentType=t,this.version=s,this.readTime=a,this.createTime=l,this.data=d,this.documentState=f}static newInvalidDocument(e){return new $n(e,0,Je.min(),Je.min(),Je.min(),dr.empty(),0)}static newFoundDocument(e,t,s,a){return new $n(e,1,t,Je.min(),s,a,0)}static newNoDocument(e,t){return new $n(e,2,t,Je.min(),Je.min(),dr.empty(),0)}static newUnknownDocument(e,t){return new $n(e,3,t,Je.min(),Je.min(),dr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Je.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=dr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=dr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Je.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof $n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new $n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Du{constructor(e,t){this.position=e,this.inclusive=t}}function Zy(n,e,t){let s=0;for(let a=0;a<n.position.length;a++){const l=e[a],d=n.position[a];if(l.field.isKeyField()?s=Fe.comparator(Fe.fromName(d.referenceValue),t.key):s=xo(d,t.data.field(l.field)),l.dir==="desc"&&(s*=-1),s!==0)break}return s}function ev(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Rs(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vu{constructor(e,t="asc"){this.field=e,this.dir=t}}function bC(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T0{}class cn extends T0{constructor(e,t,s){super(),this.field=e,this.op=t,this.value=s}static create(e,t,s){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,s):new AC(e,t,s):t==="array-contains"?new jC(e,s):t==="in"?new DC(e,s):t==="not-in"?new VC(e,s):t==="array-contains-any"?new LC(e,s):new cn(e,t,s)}static createKeyFieldInFilter(e,t,s){return t==="in"?new NC(e,s):new kC(e,s)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(xo(t,this.value)):t!==null&&Mi(this.value)===Mi(t)&&this.matchesComparison(xo(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return He(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class as extends T0{constructor(e,t){super(),this.filters=e,this.op=t,this.he=null}static create(e,t){return new as(e,t)}matches(e){return S0(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function S0(n){return n.op==="and"}function I0(n){return RC(n)&&S0(n)}function RC(n){for(const e of n.filters)if(e instanceof as)return!1;return!0}function wf(n){if(n instanceof cn)return n.field.canonicalString()+n.op.toString()+Eo(n.value);if(I0(n))return n.filters.map((e=>wf(e))).join(",");{const e=n.filters.map((t=>wf(t))).join(",");return`${n.op}(${e})`}}function C0(n,e){return n instanceof cn?(function(s,a){return a instanceof cn&&s.op===a.op&&s.field.isEqual(a.field)&&Rs(s.value,a.value)})(n,e):n instanceof as?(function(s,a){return a instanceof as&&s.op===a.op&&s.filters.length===a.filters.length?s.filters.reduce(((l,d,f)=>l&&C0(d,a.filters[f])),!0):!1})(n,e):void He(19439)}function P0(n){return n instanceof cn?(function(t){return`${t.field.canonicalString()} ${t.op} ${Eo(t.value)}`})(n):n instanceof as?(function(t){return t.op.toString()+" {"+t.getFilters().map(P0).join(" ,")+"}"})(n):"Filter"}class AC extends cn{constructor(e,t,s){super(e,t,s),this.key=Fe.fromName(s.referenceValue)}matches(e){const t=Fe.comparator(e.key,this.key);return this.matchesComparison(t)}}class NC extends cn{constructor(e,t){super(e,"in",t),this.keys=b0("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class kC extends cn{constructor(e,t){super(e,"not-in",t),this.keys=b0("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function b0(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map((s=>Fe.fromName(s.referenceValue)))}class jC extends cn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return sp(t)&&Ll(t.arrayValue,this.value)}}class DC extends cn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Ll(this.value.arrayValue,t)}}class VC extends cn{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ll(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Ll(this.value.arrayValue,t)}}class LC extends cn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!sp(t)||!t.arrayValue.values)&&t.arrayValue.values.some((s=>Ll(this.value.arrayValue,s)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OC{constructor(e,t=null,s=[],a=[],l=null,d=null,f=null){this.path=e,this.collectionGroup=t,this.orderBy=s,this.filters=a,this.limit=l,this.startAt=d,this.endAt=f,this.Pe=null}}function tv(n,e=null,t=[],s=[],a=null,l=null,d=null){return new OC(n,e,t,s,a,l,d)}function ip(n){const e=Xe(n);if(e.Pe===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((s=>wf(s))).join(","),t+="|ob:",t+=e.orderBy.map((s=>(function(l){return l.field.canonicalString()+l.dir})(s))).join(","),Yu(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((s=>Eo(s))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((s=>Eo(s))).join(",")),e.Pe=t}return e.Pe}function ap(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!bC(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!C0(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!ev(n.startAt,e.startAt)&&ev(n.endAt,e.endAt)}function xf(n){return Fe.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kl{constructor(e,t=null,s=[],a=[],l=null,d="F",f=null,m=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=s,this.filters=a,this.limit=l,this.limitType=d,this.startAt=f,this.endAt=m,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function MC(n,e,t,s,a,l,d,f){return new Kl(n,e,t,s,a,l,d,f)}function op(n){return new Kl(n)}function nv(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function R0(n){return n.collectionGroup!==null}function Cl(n){const e=Xe(n);if(e.Te===null){e.Te=[];const t=new Set;for(const l of e.explicitOrderBy)e.Te.push(l),t.add(l.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let f=new mn(Nn.comparator);return d.filters.forEach((m=>{m.getFlattenedFilters().forEach((v=>{v.isInequality()&&(f=f.add(v.field))}))})),f})(e).forEach((l=>{t.has(l.canonicalString())||l.isKeyField()||e.Te.push(new Vu(l,s))})),t.has(Nn.keyField().canonicalString())||e.Te.push(new Vu(Nn.keyField(),s))}return e.Te}function Is(n){const e=Xe(n);return e.Ie||(e.Ie=FC(e,Cl(n))),e.Ie}function FC(n,e){if(n.limitType==="F")return tv(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((a=>{const l=a.dir==="desc"?"asc":"desc";return new Vu(a.field,l)}));const t=n.endAt?new Du(n.endAt.position,n.endAt.inclusive):null,s=n.startAt?new Du(n.startAt.position,n.startAt.inclusive):null;return tv(n.path,n.collectionGroup,e,n.filters,n.limit,t,s)}}function Ef(n,e){const t=n.filters.concat([e]);return new Kl(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Tf(n,e,t){return new Kl(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Xu(n,e){return ap(Is(n),Is(e))&&n.limitType===e.limitType}function A0(n){return`${ip(Is(n))}|lt:${n.limitType}`}function co(n){return`Query(target=${(function(t){let s=t.path.canonicalString();return t.collectionGroup!==null&&(s+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(s+=`, filters: [${t.filters.map((a=>P0(a))).join(", ")}]`),Yu(t.limit)||(s+=", limit: "+t.limit),t.orderBy.length>0&&(s+=`, orderBy: [${t.orderBy.map((a=>(function(d){return`${d.field.canonicalString()} (${d.dir})`})(a))).join(", ")}]`),t.startAt&&(s+=", startAt: ",s+=t.startAt.inclusive?"b:":"a:",s+=t.startAt.position.map((a=>Eo(a))).join(",")),t.endAt&&(s+=", endAt: ",s+=t.endAt.inclusive?"a:":"b:",s+=t.endAt.position.map((a=>Eo(a))).join(",")),`Target(${s})`})(Is(n))}; limitType=${n.limitType})`}function Zu(n,e){return e.isFoundDocument()&&(function(s,a){const l=a.key.path;return s.collectionGroup!==null?a.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(l):Fe.isDocumentKey(s.path)?s.path.isEqual(l):s.path.isImmediateParentOf(l)})(n,e)&&(function(s,a){for(const l of Cl(s))if(!l.field.isKeyField()&&a.data.field(l.field)===null)return!1;return!0})(n,e)&&(function(s,a){for(const l of s.filters)if(!l.matches(a))return!1;return!0})(n,e)&&(function(s,a){return!(s.startAt&&!(function(d,f,m){const v=Zy(d,f,m);return d.inclusive?v<=0:v<0})(s.startAt,Cl(s),a)||s.endAt&&!(function(d,f,m){const v=Zy(d,f,m);return d.inclusive?v>=0:v>0})(s.endAt,Cl(s),a))})(n,e)}function UC(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function N0(n){return(e,t)=>{let s=!1;for(const a of Cl(n)){const l=zC(a,e,t);if(l!==0)return l;s=s||a.field.isKeyField()}return 0}}function zC(n,e,t){const s=n.field.isKeyField()?Fe.comparator(e.key,t.key):(function(l,d,f){const m=d.data.field(l),v=f.data.field(l);return m!==null&&v!==null?xo(m,v):He(42886)})(n.field,e,t);switch(n.dir){case"asc":return s;case"desc":return-1*s;default:return He(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sa{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s!==void 0){for(const[a,l]of s)if(this.equalsFn(a,e))return l}}has(e){return this.get(e)!==void 0}set(e,t){const s=this.mapKeyFn(e),a=this.inner[s];if(a===void 0)return this.inner[s]=[[e,t]],void this.innerSize++;for(let l=0;l<a.length;l++)if(this.equalsFn(a[l][0],e))return void(a[l]=[e,t]);a.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s===void 0)return!1;for(let a=0;a<s.length;a++)if(this.equalsFn(s[a][0],e))return s.length===1?delete this.inner[t]:s.splice(a,1),this.innerSize--,!0;return!1}forEach(e){qi(this.inner,((t,s)=>{for(const[a,l]of s)e(a,l)}))}isEmpty(){return p0(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BC=new Ht(Fe.comparator);function ti(){return BC}const k0=new Ht(Fe.comparator);function _l(...n){let e=k0;for(const t of n)e=e.insert(t.key,t);return e}function j0(n){let e=k0;return n.forEach(((t,s)=>e=e.insert(t,s.overlayedDocument))),e}function pa(){return Pl()}function D0(){return Pl()}function Pl(){return new Sa((n=>n.toString()),((n,e)=>n.isEqual(e)))}const $C=new Ht(Fe.comparator),WC=new mn(Fe.comparator);function ct(...n){let e=WC;for(const t of n)e=e.add(t);return e}const qC=new mn(st);function HC(){return qC}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lp(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Nu(e)?"-0":e}}function V0(n){return{integerValue:""+n}}function GC(n,e){return wC(e)?V0(e):lp(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ed{constructor(){this._=void 0}}function KC(n,e,t){return n instanceof Ol?(function(a,l){const d={fields:{[y0]:{stringValue:g0},[_0]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return l&&rp(l)&&(l=Ju(l)),l&&(d.fields[v0]=l),{mapValue:d}})(t,e):n instanceof Ml?O0(n,e):n instanceof Fl?M0(n,e):(function(a,l){const d=L0(a,l),f=rv(d)+rv(a.Ee);return _f(d)&&_f(a.Ee)?V0(f):lp(a.serializer,f)})(n,e)}function QC(n,e,t){return n instanceof Ml?O0(n,e):n instanceof Fl?M0(n,e):t}function L0(n,e){return n instanceof Lu?(function(s){return _f(s)||(function(l){return!!l&&"doubleValue"in l})(s)})(e)?e:{integerValue:0}:null}class Ol extends ed{}class Ml extends ed{constructor(e){super(),this.elements=e}}function O0(n,e){const t=F0(e);for(const s of n.elements)t.some((a=>Rs(a,s)))||t.push(s);return{arrayValue:{values:t}}}class Fl extends ed{constructor(e){super(),this.elements=e}}function M0(n,e){let t=F0(e);for(const s of n.elements)t=t.filter((a=>!Rs(a,s)));return{arrayValue:{values:t}}}class Lu extends ed{constructor(e,t){super(),this.serializer=e,this.Ee=t}}function rv(n){return Xt(n.integerValue||n.doubleValue)}function F0(n){return sp(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YC{constructor(e,t){this.field=e,this.transform=t}}function JC(n,e){return n.field.isEqual(e.field)&&(function(s,a){return s instanceof Ml&&a instanceof Ml||s instanceof Fl&&a instanceof Fl?wo(s.elements,a.elements,Rs):s instanceof Lu&&a instanceof Lu?Rs(s.Ee,a.Ee):s instanceof Ol&&a instanceof Ol})(n.transform,e.transform)}class XC{constructor(e,t){this.version=e,this.transformResults=t}}class Lr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Lr}static exists(e){return new Lr(void 0,e)}static updateTime(e){return new Lr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function vu(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class td{}function U0(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new cp(n.key,Lr.none()):new Ql(n.key,n.data,Lr.none());{const t=n.data,s=dr.empty();let a=new mn(Nn.comparator);for(let l of e.fields)if(!a.has(l)){let d=t.field(l);d===null&&l.length>1&&(l=l.popLast(),d=t.field(l)),d===null?s.delete(l):s.set(l,d),a=a.add(l)}return new Hi(n.key,s,new xr(a.toArray()),Lr.none())}}function ZC(n,e,t){n instanceof Ql?(function(a,l,d){const f=a.value.clone(),m=iv(a.fieldTransforms,l,d.transformResults);f.setAll(m),l.convertToFoundDocument(d.version,f).setHasCommittedMutations()})(n,e,t):n instanceof Hi?(function(a,l,d){if(!vu(a.precondition,l))return void l.convertToUnknownDocument(d.version);const f=iv(a.fieldTransforms,l,d.transformResults),m=l.data;m.setAll(z0(a)),m.setAll(f),l.convertToFoundDocument(d.version,m).setHasCommittedMutations()})(n,e,t):(function(a,l,d){l.convertToNoDocument(d.version).setHasCommittedMutations()})(0,e,t)}function bl(n,e,t,s){return n instanceof Ql?(function(l,d,f,m){if(!vu(l.precondition,d))return f;const v=l.value.clone(),w=av(l.fieldTransforms,m,d);return v.setAll(w),d.convertToFoundDocument(d.version,v).setHasLocalMutations(),null})(n,e,t,s):n instanceof Hi?(function(l,d,f,m){if(!vu(l.precondition,d))return f;const v=av(l.fieldTransforms,m,d),w=d.data;return w.setAll(z0(l)),w.setAll(v),d.convertToFoundDocument(d.version,w).setHasLocalMutations(),f===null?null:f.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((E=>E.field)))})(n,e,t,s):(function(l,d,f){return vu(l.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):f})(n,e,t)}function eP(n,e){let t=null;for(const s of n.fieldTransforms){const a=e.data.field(s.field),l=L0(s.transform,a||null);l!=null&&(t===null&&(t=dr.empty()),t.set(s.field,l))}return t||null}function sv(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(s,a){return s===void 0&&a===void 0||!(!s||!a)&&wo(s,a,((l,d)=>JC(l,d)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Ql extends td{constructor(e,t,s,a=[]){super(),this.key=e,this.value=t,this.precondition=s,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class Hi extends td{constructor(e,t,s,a,l=[]){super(),this.key=e,this.data=t,this.fieldMask=s,this.precondition=a,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function z0(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const s=n.data.field(t);e.set(t,s)}})),e}function iv(n,e,t){const s=new Map;Tt(n.length===t.length,32656,{Ae:t.length,Re:n.length});for(let a=0;a<t.length;a++){const l=n[a],d=l.transform,f=e.data.field(l.field);s.set(l.field,QC(d,f,t[a]))}return s}function av(n,e,t){const s=new Map;for(const a of n){const l=a.transform,d=t.data.field(a.field);s.set(a.field,KC(l,d,e))}return s}class cp extends td{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class tP extends td{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nP{constructor(e,t,s,a){this.batchId=e,this.localWriteTime=t,this.baseMutations=s,this.mutations=a}applyToRemoteDocument(e,t){const s=t.mutationResults;for(let a=0;a<this.mutations.length;a++){const l=this.mutations[a];l.key.isEqual(e.key)&&ZC(l,e,s[a])}}applyToLocalView(e,t){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(t=bl(s,e,t,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(t=bl(s,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const s=D0();return this.mutations.forEach((a=>{const l=e.get(a.key),d=l.overlayedDocument;let f=this.applyToLocalView(d,l.mutatedFields);f=t.has(a.key)?null:f;const m=U0(d,f);m!==null&&s.set(a.key,m),d.isValidDocument()||d.convertToNoDocument(Je.min())})),s}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),ct())}isEqual(e){return this.batchId===e.batchId&&wo(this.mutations,e.mutations,((t,s)=>sv(t,s)))&&wo(this.baseMutations,e.baseMutations,((t,s)=>sv(t,s)))}}class up{constructor(e,t,s,a){this.batch=e,this.commitVersion=t,this.mutationResults=s,this.docVersions=a}static from(e,t,s){Tt(e.mutations.length===s.length,58842,{Ve:e.mutations.length,me:s.length});let a=(function(){return $C})();const l=e.mutations;for(let d=0;d<l.length;d++)a=a.insert(l[d].key,s[d].version);return new up(e,t,s,a)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rP{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sP{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ln,mt;function iP(n){switch(n){case ie.OK:return He(64938);case ie.CANCELLED:case ie.UNKNOWN:case ie.DEADLINE_EXCEEDED:case ie.RESOURCE_EXHAUSTED:case ie.INTERNAL:case ie.UNAVAILABLE:case ie.UNAUTHENTICATED:return!1;case ie.INVALID_ARGUMENT:case ie.NOT_FOUND:case ie.ALREADY_EXISTS:case ie.PERMISSION_DENIED:case ie.FAILED_PRECONDITION:case ie.ABORTED:case ie.OUT_OF_RANGE:case ie.UNIMPLEMENTED:case ie.DATA_LOSS:return!0;default:return He(15467,{code:n})}}function B0(n){if(n===void 0)return ei("GRPC error has no .code"),ie.UNKNOWN;switch(n){case ln.OK:return ie.OK;case ln.CANCELLED:return ie.CANCELLED;case ln.UNKNOWN:return ie.UNKNOWN;case ln.DEADLINE_EXCEEDED:return ie.DEADLINE_EXCEEDED;case ln.RESOURCE_EXHAUSTED:return ie.RESOURCE_EXHAUSTED;case ln.INTERNAL:return ie.INTERNAL;case ln.UNAVAILABLE:return ie.UNAVAILABLE;case ln.UNAUTHENTICATED:return ie.UNAUTHENTICATED;case ln.INVALID_ARGUMENT:return ie.INVALID_ARGUMENT;case ln.NOT_FOUND:return ie.NOT_FOUND;case ln.ALREADY_EXISTS:return ie.ALREADY_EXISTS;case ln.PERMISSION_DENIED:return ie.PERMISSION_DENIED;case ln.FAILED_PRECONDITION:return ie.FAILED_PRECONDITION;case ln.ABORTED:return ie.ABORTED;case ln.OUT_OF_RANGE:return ie.OUT_OF_RANGE;case ln.UNIMPLEMENTED:return ie.UNIMPLEMENTED;case ln.DATA_LOSS:return ie.DATA_LOSS;default:return He(39323,{code:n})}}(mt=ln||(ln={}))[mt.OK=0]="OK",mt[mt.CANCELLED=1]="CANCELLED",mt[mt.UNKNOWN=2]="UNKNOWN",mt[mt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",mt[mt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",mt[mt.NOT_FOUND=5]="NOT_FOUND",mt[mt.ALREADY_EXISTS=6]="ALREADY_EXISTS",mt[mt.PERMISSION_DENIED=7]="PERMISSION_DENIED",mt[mt.UNAUTHENTICATED=16]="UNAUTHENTICATED",mt[mt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",mt[mt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",mt[mt.ABORTED=10]="ABORTED",mt[mt.OUT_OF_RANGE=11]="OUT_OF_RANGE",mt[mt.UNIMPLEMENTED=12]="UNIMPLEMENTED",mt[mt.INTERNAL=13]="INTERNAL",mt[mt.UNAVAILABLE=14]="UNAVAILABLE",mt[mt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aP=new ki([4294967295,4294967295],0);function ov(n){const e=u0().encode(n),t=new n0;return t.update(e),new Uint8Array(t.digest())}function lv(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),s=e.getUint32(4,!0),a=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new ki([t,s],0),new ki([a,l],0)]}class dp{constructor(e,t,s){if(this.bitmap=e,this.padding=t,this.hashCount=s,t<0||t>=8)throw new wl(`Invalid padding: ${t}`);if(s<0)throw new wl(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new wl(`Invalid hash count: ${s}`);if(e.length===0&&t!==0)throw new wl(`Invalid padding when bitmap length is 0: ${t}`);this.fe=8*e.length-t,this.ge=ki.fromNumber(this.fe)}pe(e,t,s){let a=e.add(t.multiply(ki.fromNumber(s)));return a.compare(aP)===1&&(a=new ki([a.getBits(0),a.getBits(1)],0)),a.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;const t=ov(e),[s,a]=lv(t);for(let l=0;l<this.hashCount;l++){const d=this.pe(s,a,l);if(!this.ye(d))return!1}return!0}static create(e,t,s){const a=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),d=new dp(l,a,t);return s.forEach((f=>d.insert(f))),d}insert(e){if(this.fe===0)return;const t=ov(e),[s,a]=lv(t);for(let l=0;l<this.hashCount;l++){const d=this.pe(s,a,l);this.we(d)}}we(e){const t=Math.floor(e/8),s=e%8;this.bitmap[t]|=1<<s}}class wl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nd{constructor(e,t,s,a,l){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=s,this.documentUpdates=a,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,t,s){const a=new Map;return a.set(e,Yl.createSynthesizedTargetChangeForCurrentChange(e,t,s)),new nd(Je.min(),a,new Ht(st),ti(),ct())}}class Yl{constructor(e,t,s,a,l){this.resumeToken=e,this.current=t,this.addedDocuments=s,this.modifiedDocuments=a,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,t,s){return new Yl(s,t,ct(),ct(),ct())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _u{constructor(e,t,s,a){this.Se=e,this.removedTargetIds=t,this.key=s,this.be=a}}class $0{constructor(e,t){this.targetId=e,this.De=t}}class W0{constructor(e,t,s=kn.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=t,this.resumeToken=s,this.cause=a}}class cv{constructor(){this.ve=0,this.Ce=uv(),this.Fe=kn.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=ct(),t=ct(),s=ct();return this.Ce.forEach(((a,l)=>{switch(l){case 0:e=e.add(a);break;case 2:t=t.add(a);break;case 1:s=s.add(a);break;default:He(38017,{changeType:l})}})),new Yl(this.Fe,this.Me,e,t,s)}ke(){this.xe=!1,this.Ce=uv()}qe(e,t){this.xe=!0,this.Ce=this.Ce.insert(e,t)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,Tt(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class oP{constructor(e){this.We=e,this.Ge=new Map,this.ze=ti(),this.je=cu(),this.Je=cu(),this.He=new Ht(st)}Ye(e){for(const t of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(t,e.be):this.Xe(t,e.key,e.be);for(const t of e.removedTargetIds)this.Xe(t,e.key,e.be)}et(e){this.forEachTarget(e,(t=>{const s=this.tt(t);switch(e.state){case 0:this.nt(t)&&s.Be(e.resumeToken);break;case 1:s.Ue(),s.Oe||s.ke(),s.Be(e.resumeToken);break;case 2:s.Ue(),s.Oe||this.removeTarget(t);break;case 3:this.nt(t)&&(s.Ke(),s.Be(e.resumeToken));break;case 4:this.nt(t)&&(this.rt(t),s.Be(e.resumeToken));break;default:He(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ge.forEach(((s,a)=>{this.nt(a)&&t(a)}))}it(e){const t=e.targetId,s=e.De.count,a=this.st(t);if(a){const l=a.target;if(xf(l))if(s===0){const d=new Fe(l.path);this.Xe(t,d,$n.newNoDocument(d,Je.min()))}else Tt(s===1,20013,{expectedCount:s});else{const d=this.ot(t);if(d!==s){const f=this._t(e),m=f?this.ut(f,e,d):1;if(m!==0){this.rt(t);const v=m===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(t,v)}}}}}_t(e){const t=e.De.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:s="",padding:a=0},hashCount:l=0}=t;let d,f;try{d=Oi(s).toUint8Array()}catch(m){if(m instanceof m0)return Di("Decoding the base64 bloom filter in existence filter failed ("+m.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw m}try{f=new dp(d,a,l)}catch(m){return Di(m instanceof wl?"BloomFilter error: ":"Applying bloom filter failed: ",m),null}return f.fe===0?null:f}ut(e,t,s){return t.De.count===s-this.ht(e,t.targetId)?0:2}ht(e,t){const s=this.We.getRemoteKeysForTarget(t);let a=0;return s.forEach((l=>{const d=this.We.lt(),f=`projects/${d.projectId}/databases/${d.database}/documents/${l.path.canonicalString()}`;e.mightContain(f)||(this.Xe(t,l,null),a++)})),a}Pt(e){const t=new Map;this.Ge.forEach(((l,d)=>{const f=this.st(d);if(f){if(l.current&&xf(f.target)){const m=new Fe(f.target.path);this.Tt(m).has(d)||this.It(d,m)||this.Xe(d,m,$n.newNoDocument(m,e))}l.Ne&&(t.set(d,l.Le()),l.ke())}}));let s=ct();this.Je.forEach(((l,d)=>{let f=!0;d.forEachWhile((m=>{const v=this.st(m);return!v||v.purpose==="TargetPurposeLimboResolution"||(f=!1,!1)})),f&&(s=s.add(l))})),this.ze.forEach(((l,d)=>d.setReadTime(e)));const a=new nd(e,t,this.He,this.ze,s);return this.ze=ti(),this.je=cu(),this.Je=cu(),this.He=new Ht(st),a}Ze(e,t){if(!this.nt(e))return;const s=this.It(e,t.key)?2:0;this.tt(e).qe(t.key,s),this.ze=this.ze.insert(t.key,t),this.je=this.je.insert(t.key,this.Tt(t.key).add(e)),this.Je=this.Je.insert(t.key,this.dt(t.key).add(e))}Xe(e,t,s){if(!this.nt(e))return;const a=this.tt(e);this.It(e,t)?a.qe(t,1):a.Qe(t),this.Je=this.Je.insert(t,this.dt(t).delete(e)),this.Je=this.Je.insert(t,this.dt(t).add(e)),s&&(this.ze=this.ze.insert(t,s))}removeTarget(e){this.Ge.delete(e)}ot(e){const t=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let t=this.Ge.get(e);return t||(t=new cv,this.Ge.set(e,t)),t}dt(e){let t=this.Je.get(e);return t||(t=new mn(st),this.Je=this.Je.insert(e,t)),t}Tt(e){let t=this.je.get(e);return t||(t=new mn(st),this.je=this.je.insert(e,t)),t}nt(e){const t=this.st(e)!==null;return t||Pe("WatchChangeAggregator","Detected inactive target",e),t}st(e){const t=this.Ge.get(e);return t&&t.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new cv),this.We.getRemoteKeysForTarget(e).forEach((t=>{this.Xe(e,t,null)}))}It(e,t){return this.We.getRemoteKeysForTarget(e).has(t)}}function cu(){return new Ht(Fe.comparator)}function uv(){return new Ht(Fe.comparator)}const lP={asc:"ASCENDING",desc:"DESCENDING"},cP={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},uP={and:"AND",or:"OR"};class dP{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Sf(n,e){return n.useProto3Json||Yu(e)?e:{value:e}}function Ou(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function q0(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function hP(n,e){return Ou(n,e.toTimestamp())}function Cs(n){return Tt(!!n,49232),Je.fromTimestamp((function(t){const s=Li(t);return new Mt(s.seconds,s.nanos)})(n))}function hp(n,e){return If(n,e).canonicalString()}function If(n,e){const t=(function(a){return new kt(["projects",a.projectId,"databases",a.database])})(n).child("documents");return e===void 0?t:t.child(e)}function H0(n){const e=kt.fromString(n);return Tt(J0(e),10190,{key:e.toString()}),e}function Cf(n,e){return hp(n.databaseId,e.path)}function Yh(n,e){const t=H0(e);if(t.get(1)!==n.databaseId.projectId)throw new Ie(ie.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Ie(ie.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Fe(K0(t))}function G0(n,e){return hp(n.databaseId,e)}function fP(n){const e=H0(n);return e.length===4?kt.emptyPath():K0(e)}function Pf(n){return new kt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function K0(n){return Tt(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function dv(n,e,t){return{name:Cf(n,e),fields:t.value.mapValue.fields}}function pP(n,e){let t;if("targetChange"in e){e.targetChange;const s=(function(v){return v==="NO_CHANGE"?0:v==="ADD"?1:v==="REMOVE"?2:v==="CURRENT"?3:v==="RESET"?4:He(39313,{state:v})})(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],l=(function(v,w){return v.useProto3Json?(Tt(w===void 0||typeof w=="string",58123),kn.fromBase64String(w||"")):(Tt(w===void 0||w instanceof Buffer||w instanceof Uint8Array,16193),kn.fromUint8Array(w||new Uint8Array))})(n,e.targetChange.resumeToken),d=e.targetChange.cause,f=d&&(function(v){const w=v.code===void 0?ie.UNKNOWN:B0(v.code);return new Ie(w,v.message||"")})(d);t=new W0(s,a,l,f||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const a=Yh(n,s.document.name),l=Cs(s.document.updateTime),d=s.document.createTime?Cs(s.document.createTime):Je.min(),f=new dr({mapValue:{fields:s.document.fields}}),m=$n.newFoundDocument(a,l,d,f),v=s.targetIds||[],w=s.removedTargetIds||[];t=new _u(v,w,m.key,m)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const a=Yh(n,s.document),l=s.readTime?Cs(s.readTime):Je.min(),d=$n.newNoDocument(a,l),f=s.removedTargetIds||[];t=new _u([],f,d.key,d)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const a=Yh(n,s.document),l=s.removedTargetIds||[];t=new _u([],l,a,null)}else{if(!("filter"in e))return He(11601,{At:e});{e.filter;const s=e.filter;s.targetId;const{count:a=0,unchangedNames:l}=s,d=new sP(a,l),f=s.targetId;t=new $0(f,d)}}return t}function mP(n,e){let t;if(e instanceof Ql)t={update:dv(n,e.key,e.value)};else if(e instanceof cp)t={delete:Cf(n,e.key)};else if(e instanceof Hi)t={update:dv(n,e.key,e.data),updateMask:SP(e.fieldMask)};else{if(!(e instanceof tP))return He(16599,{Rt:e.type});t={verify:Cf(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((s=>(function(l,d){const f=d.transform;if(f instanceof Ol)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(f instanceof Ml)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:f.elements}};if(f instanceof Fl)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:f.elements}};if(f instanceof Lu)return{fieldPath:d.field.canonicalString(),increment:f.Ee};throw He(20930,{transform:d.transform})})(0,s)))),e.precondition.isNone||(t.currentDocument=(function(a,l){return l.updateTime!==void 0?{updateTime:hP(a,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:He(27497)})(n,e.precondition)),t}function gP(n,e){return n&&n.length>0?(Tt(e!==void 0,14353),n.map((t=>(function(a,l){let d=a.updateTime?Cs(a.updateTime):Cs(l);return d.isEqual(Je.min())&&(d=Cs(l)),new XC(d,a.transformResults||[])})(t,e)))):[]}function yP(n,e){return{documents:[G0(n,e.path)]}}function vP(n,e){const t={structuredQuery:{}},s=e.path;let a;e.collectionGroup!==null?(a=s,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=s.popLast(),t.structuredQuery.from=[{collectionId:s.lastSegment()}]),t.parent=G0(n,a);const l=(function(v){if(v.length!==0)return Y0(as.create(v,"and"))})(e.filters);l&&(t.structuredQuery.where=l);const d=(function(v){if(v.length!==0)return v.map((w=>(function(C){return{field:uo(C.field),direction:xP(C.dir)}})(w)))})(e.orderBy);d&&(t.structuredQuery.orderBy=d);const f=Sf(n,e.limit);return f!==null&&(t.structuredQuery.limit=f),e.startAt&&(t.structuredQuery.startAt=(function(v){return{before:v.inclusive,values:v.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(v){return{before:!v.inclusive,values:v.position}})(e.endAt)),{Vt:t,parent:a}}function _P(n){let e=fP(n.parent);const t=n.structuredQuery,s=t.from?t.from.length:0;let a=null;if(s>0){Tt(s===1,65062);const w=t.from[0];w.allDescendants?a=w.collectionId:e=e.child(w.collectionId)}let l=[];t.where&&(l=(function(E){const C=Q0(E);return C instanceof as&&I0(C)?C.getFilters():[C]})(t.where));let d=[];t.orderBy&&(d=(function(E){return E.map((C=>(function(q){return new Vu(ho(q.field),(function(F){switch(F){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(q.direction))})(C)))})(t.orderBy));let f=null;t.limit&&(f=(function(E){let C;return C=typeof E=="object"?E.value:E,Yu(C)?null:C})(t.limit));let m=null;t.startAt&&(m=(function(E){const C=!!E.before,$=E.values||[];return new Du($,C)})(t.startAt));let v=null;return t.endAt&&(v=(function(E){const C=!E.before,$=E.values||[];return new Du($,C)})(t.endAt)),MC(e,a,d,l,f,"F",m,v)}function wP(n,e){const t=(function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return He(28987,{purpose:a})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Q0(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const s=ho(t.unaryFilter.field);return cn.create(s,"==",{doubleValue:NaN});case"IS_NULL":const a=ho(t.unaryFilter.field);return cn.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=ho(t.unaryFilter.field);return cn.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=ho(t.unaryFilter.field);return cn.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return He(61313);default:return He(60726)}})(n):n.fieldFilter!==void 0?(function(t){return cn.create(ho(t.fieldFilter.field),(function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return He(58110);default:return He(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return as.create(t.compositeFilter.filters.map((s=>Q0(s))),(function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return He(1026)}})(t.compositeFilter.op))})(n):He(30097,{filter:n})}function xP(n){return lP[n]}function EP(n){return cP[n]}function TP(n){return uP[n]}function uo(n){return{fieldPath:n.canonicalString()}}function ho(n){return Nn.fromServerFormat(n.fieldPath)}function Y0(n){return n instanceof cn?(function(t){if(t.op==="=="){if(Xy(t.value))return{unaryFilter:{field:uo(t.field),op:"IS_NAN"}};if(Jy(t.value))return{unaryFilter:{field:uo(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Xy(t.value))return{unaryFilter:{field:uo(t.field),op:"IS_NOT_NAN"}};if(Jy(t.value))return{unaryFilter:{field:uo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:uo(t.field),op:EP(t.op),value:t.value}}})(n):n instanceof as?(function(t){const s=t.getFilters().map((a=>Y0(a)));return s.length===1?s[0]:{compositeFilter:{op:TP(t.op),filters:s}}})(n):He(54877,{filter:n})}function SP(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function J0(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pi{constructor(e,t,s,a,l=Je.min(),d=Je.min(),f=kn.EMPTY_BYTE_STRING,m=null){this.target=e,this.targetId=t,this.purpose=s,this.sequenceNumber=a,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=f,this.expectedCount=m}withSequenceNumber(e){return new Pi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Pi(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Pi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Pi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IP{constructor(e){this.gt=e}}function CP(n){const e=_P({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Tf(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PP{constructor(){this.Dn=new bP}addToCollectionParentIndex(e,t){return this.Dn.add(t),ae.resolve()}getCollectionParents(e,t){return ae.resolve(this.Dn.getEntries(t))}addFieldIndex(e,t){return ae.resolve()}deleteFieldIndex(e,t){return ae.resolve()}deleteAllFieldIndexes(e){return ae.resolve()}createTargetIndexes(e,t){return ae.resolve()}getDocumentsMatchingTarget(e,t){return ae.resolve(null)}getIndexType(e,t){return ae.resolve(0)}getFieldIndexes(e,t){return ae.resolve([])}getNextCollectionGroupToUpdate(e){return ae.resolve(null)}getMinOffset(e,t){return ae.resolve(Vi.min())}getMinOffsetFromCollectionGroup(e,t){return ae.resolve(Vi.min())}updateCollectionGroup(e,t,s){return ae.resolve()}updateIndexEntries(e,t){return ae.resolve()}}class bP{constructor(){this.index={}}add(e){const t=e.lastSegment(),s=e.popLast(),a=this.index[t]||new mn(kt.comparator),l=!a.has(s);return this.index[t]=a.add(s),l}has(e){const t=e.lastSegment(),s=e.popLast(),a=this.index[t];return a&&a.has(s)}getEntries(e){return(this.index[e]||new mn(kt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hv={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},X0=41943040;class ur{static withCacheSize(e){return new ur(e,ur.DEFAULT_COLLECTION_PERCENTILE,ur.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ur.DEFAULT_COLLECTION_PERCENTILE=10,ur.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ur.DEFAULT=new ur(X0,ur.DEFAULT_COLLECTION_PERCENTILE,ur.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ur.DISABLED=new ur(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class To{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new To(0)}static ur(){return new To(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fv="LruGarbageCollector",RP=1048576;function pv([n,e],[t,s]){const a=st(n,t);return a===0?st(e,s):a}class AP{constructor(e){this.Tr=e,this.buffer=new mn(pv),this.Ir=0}dr(){return++this.Ir}Er(e){const t=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(t);else{const s=this.buffer.last();pv(t,s)<0&&(this.buffer=this.buffer.delete(s).add(t))}}get maxValue(){return this.buffer.last()[0]}}class NP{constructor(e,t,s){this.garbageCollector=e,this.asyncQueue=t,this.localStore=s,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){Pe(fv,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){ko(t)?Pe(fv,"Ignoring IndexedDB error during garbage collection: ",t):await No(t)}await this.Rr(3e5)}))}}class kP{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.mr(e).next((s=>Math.floor(t/100*s)))}nthSequenceNumber(e,t){if(t===0)return ae.resolve(Qu.ue);const s=new AP(t);return this.Vr.forEachTarget(e,(a=>s.Er(a.sequenceNumber))).next((()=>this.Vr.gr(e,(a=>s.Er(a))))).next((()=>s.maxValue))}removeTargets(e,t,s){return this.Vr.removeTargets(e,t,s)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Pe("LruGarbageCollector","Garbage collection skipped; disabled"),ae.resolve(hv)):this.getCacheSize(e).next((s=>s<this.params.cacheSizeCollectionThreshold?(Pe("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),hv):this.pr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,t){let s,a,l,d,f,m,v;const w=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((E=>(E>this.params.maximumSequenceNumbersToCollect?(Pe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${E}`),a=this.params.maximumSequenceNumbersToCollect):a=E,d=Date.now(),this.nthSequenceNumber(e,a)))).next((E=>(s=E,f=Date.now(),this.removeTargets(e,s,t)))).next((E=>(l=E,m=Date.now(),this.removeOrphanedDocuments(e,s)))).next((E=>(v=Date.now(),lo()<=lt.DEBUG&&Pe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-w}ms
	Determined least recently used ${a} in `+(f-d)+`ms
	Removed ${l} targets in `+(m-f)+`ms
	Removed ${E} documents in `+(v-m)+`ms
Total Duration: ${v-w}ms`),ae.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:l,documentsRemoved:E}))))}}function jP(n,e){return new kP(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DP{constructor(){this.changes=new Sa((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,$n.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const s=this.changes.get(t);return s!==void 0?ae.resolve(s):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VP{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LP{constructor(e,t,s,a){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=s,this.indexManager=a}getDocument(e,t){let s=null;return this.documentOverlayCache.getOverlay(e,t).next((a=>(s=a,this.remoteDocumentCache.getEntry(e,t)))).next((a=>(s!==null&&bl(s.mutation,a,xr.empty(),Mt.now()),a)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((s=>this.getLocalViewOfDocuments(e,s,ct()).next((()=>s))))}getLocalViewOfDocuments(e,t,s=ct()){const a=pa();return this.populateOverlays(e,a,t).next((()=>this.computeViews(e,t,a,s).next((l=>{let d=_l();return l.forEach(((f,m)=>{d=d.insert(f,m.overlayedDocument)})),d}))))}getOverlayedDocuments(e,t){const s=pa();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,ct())))}populateOverlays(e,t,s){const a=[];return s.forEach((l=>{t.has(l)||a.push(l)})),this.documentOverlayCache.getOverlays(e,a).next((l=>{l.forEach(((d,f)=>{t.set(d,f)}))}))}computeViews(e,t,s,a){let l=ti();const d=Pl(),f=(function(){return Pl()})();return t.forEach(((m,v)=>{const w=s.get(v.key);a.has(v.key)&&(w===void 0||w.mutation instanceof Hi)?l=l.insert(v.key,v):w!==void 0?(d.set(v.key,w.mutation.getFieldMask()),bl(w.mutation,v,w.mutation.getFieldMask(),Mt.now())):d.set(v.key,xr.empty())})),this.recalculateAndSaveOverlays(e,l).next((m=>(m.forEach(((v,w)=>d.set(v,w))),t.forEach(((v,w)=>{var E;return f.set(v,new VP(w,(E=d.get(v))!==null&&E!==void 0?E:null))})),f)))}recalculateAndSaveOverlays(e,t){const s=Pl();let a=new Ht(((d,f)=>d-f)),l=ct();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((d=>{for(const f of d)f.keys().forEach((m=>{const v=t.get(m);if(v===null)return;let w=s.get(m)||xr.empty();w=f.applyToLocalView(v,w),s.set(m,w);const E=(a.get(f.batchId)||ct()).add(m);a=a.insert(f.batchId,E)}))})).next((()=>{const d=[],f=a.getReverseIterator();for(;f.hasNext();){const m=f.getNext(),v=m.key,w=m.value,E=D0();w.forEach((C=>{if(!l.has(C)){const $=U0(t.get(C),s.get(C));$!==null&&E.set(C,$),l=l.add(C)}})),d.push(this.documentOverlayCache.saveOverlays(e,v,E))}return ae.waitFor(d)})).next((()=>s))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((s=>this.recalculateAndSaveOverlays(e,s)))}getDocumentsMatchingQuery(e,t,s,a){return(function(d){return Fe.isDocumentKey(d.path)&&d.collectionGroup===null&&d.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):R0(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,s,a):this.getDocumentsMatchingCollectionQuery(e,t,s,a)}getNextDocuments(e,t,s,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,s,a).next((l=>{const d=a-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,s.largestBatchId,a-l.size):ae.resolve(pa());let f=jl,m=l;return d.next((v=>ae.forEach(v,((w,E)=>(f<E.largestBatchId&&(f=E.largestBatchId),l.get(w)?ae.resolve():this.remoteDocumentCache.getEntry(e,w).next((C=>{m=m.insert(w,C)}))))).next((()=>this.populateOverlays(e,v,l))).next((()=>this.computeViews(e,m,v,ct()))).next((w=>({batchId:f,changes:j0(w)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Fe(t)).next((s=>{let a=_l();return s.isFoundDocument()&&(a=a.insert(s.key,s)),a}))}getDocumentsMatchingCollectionGroupQuery(e,t,s,a){const l=t.collectionGroup;let d=_l();return this.indexManager.getCollectionParents(e,l).next((f=>ae.forEach(f,(m=>{const v=(function(E,C){return new Kl(C,null,E.explicitOrderBy.slice(),E.filters.slice(),E.limit,E.limitType,E.startAt,E.endAt)})(t,m.child(l));return this.getDocumentsMatchingCollectionQuery(e,v,s,a).next((w=>{w.forEach(((E,C)=>{d=d.insert(E,C)}))}))})).next((()=>d))))}getDocumentsMatchingCollectionQuery(e,t,s,a){let l;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,s.largestBatchId).next((d=>(l=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,s,l,a)))).next((d=>{l.forEach(((m,v)=>{const w=v.getKey();d.get(w)===null&&(d=d.insert(w,$n.newInvalidDocument(w)))}));let f=_l();return d.forEach(((m,v)=>{const w=l.get(m);w!==void 0&&bl(w.mutation,v,xr.empty(),Mt.now()),Zu(t,v)&&(f=f.insert(m,v))})),f}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OP{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,t){return ae.resolve(this.Br.get(t))}saveBundleMetadata(e,t){return this.Br.set(t.id,(function(a){return{id:a.id,version:a.version,createTime:Cs(a.createTime)}})(t)),ae.resolve()}getNamedQuery(e,t){return ae.resolve(this.Lr.get(t))}saveNamedQuery(e,t){return this.Lr.set(t.name,(function(a){return{name:a.name,query:CP(a.bundledQuery),readTime:Cs(a.readTime)}})(t)),ae.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MP{constructor(){this.overlays=new Ht(Fe.comparator),this.kr=new Map}getOverlay(e,t){return ae.resolve(this.overlays.get(t))}getOverlays(e,t){const s=pa();return ae.forEach(t,(a=>this.getOverlay(e,a).next((l=>{l!==null&&s.set(a,l)})))).next((()=>s))}saveOverlays(e,t,s){return s.forEach(((a,l)=>{this.wt(e,t,l)})),ae.resolve()}removeOverlaysForBatchId(e,t,s){const a=this.kr.get(s);return a!==void 0&&(a.forEach((l=>this.overlays=this.overlays.remove(l))),this.kr.delete(s)),ae.resolve()}getOverlaysForCollection(e,t,s){const a=pa(),l=t.length+1,d=new Fe(t.child("")),f=this.overlays.getIteratorFrom(d);for(;f.hasNext();){const m=f.getNext().value,v=m.getKey();if(!t.isPrefixOf(v.path))break;v.path.length===l&&m.largestBatchId>s&&a.set(m.getKey(),m)}return ae.resolve(a)}getOverlaysForCollectionGroup(e,t,s,a){let l=new Ht(((v,w)=>v-w));const d=this.overlays.getIterator();for(;d.hasNext();){const v=d.getNext().value;if(v.getKey().getCollectionGroup()===t&&v.largestBatchId>s){let w=l.get(v.largestBatchId);w===null&&(w=pa(),l=l.insert(v.largestBatchId,w)),w.set(v.getKey(),v)}}const f=pa(),m=l.getIterator();for(;m.hasNext()&&(m.getNext().value.forEach(((v,w)=>f.set(v,w))),!(f.size()>=a)););return ae.resolve(f)}wt(e,t,s){const a=this.overlays.get(s.key);if(a!==null){const d=this.kr.get(a.largestBatchId).delete(s.key);this.kr.set(a.largestBatchId,d)}this.overlays=this.overlays.insert(s.key,new rP(t,s));let l=this.kr.get(t);l===void 0&&(l=ct(),this.kr.set(t,l)),this.kr.set(t,l.add(s.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FP{constructor(){this.sessionToken=kn.EMPTY_BYTE_STRING}getSessionToken(e){return ae.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ae.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fp{constructor(){this.qr=new mn(xn.Qr),this.$r=new mn(xn.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,t){const s=new xn(e,t);this.qr=this.qr.add(s),this.$r=this.$r.add(s)}Kr(e,t){e.forEach((s=>this.addReference(s,t)))}removeReference(e,t){this.Wr(new xn(e,t))}Gr(e,t){e.forEach((s=>this.removeReference(s,t)))}zr(e){const t=new Fe(new kt([])),s=new xn(t,e),a=new xn(t,e+1),l=[];return this.$r.forEachInRange([s,a],(d=>{this.Wr(d),l.push(d.key)})),l}jr(){this.qr.forEach((e=>this.Wr(e)))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const t=new Fe(new kt([])),s=new xn(t,e),a=new xn(t,e+1);let l=ct();return this.$r.forEachInRange([s,a],(d=>{l=l.add(d.key)})),l}containsKey(e){const t=new xn(e,0),s=this.qr.firstAfterOrEqual(t);return s!==null&&e.isEqual(s.key)}}class xn{constructor(e,t){this.key=e,this.Hr=t}static Qr(e,t){return Fe.comparator(e.key,t.key)||st(e.Hr,t.Hr)}static Ur(e,t){return st(e.Hr,t.Hr)||Fe.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UP{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.er=1,this.Yr=new mn(xn.Qr)}checkEmpty(e){return ae.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,s,a){const l=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new nP(l,t,s,a);this.mutationQueue.push(d);for(const f of a)this.Yr=this.Yr.add(new xn(f.key,l)),this.indexManager.addToCollectionParentIndex(e,f.key.path.popLast());return ae.resolve(d)}lookupMutationBatch(e,t){return ae.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const s=t+1,a=this.Xr(s),l=a<0?0:a;return ae.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return ae.resolve(this.mutationQueue.length===0?np:this.er-1)}getAllMutationBatches(e){return ae.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const s=new xn(t,0),a=new xn(t,Number.POSITIVE_INFINITY),l=[];return this.Yr.forEachInRange([s,a],(d=>{const f=this.Zr(d.Hr);l.push(f)})),ae.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new mn(st);return t.forEach((a=>{const l=new xn(a,0),d=new xn(a,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([l,d],(f=>{s=s.add(f.Hr)}))})),ae.resolve(this.ei(s))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,a=s.length+1;let l=s;Fe.isDocumentKey(l)||(l=l.child(""));const d=new xn(new Fe(l),0);let f=new mn(st);return this.Yr.forEachWhile((m=>{const v=m.key.path;return!!s.isPrefixOf(v)&&(v.length===a&&(f=f.add(m.Hr)),!0)}),d),ae.resolve(this.ei(f))}ei(e){const t=[];return e.forEach((s=>{const a=this.Zr(s);a!==null&&t.push(a)})),t}removeMutationBatch(e,t){Tt(this.ti(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let s=this.Yr;return ae.forEach(t.mutations,(a=>{const l=new xn(a.key,t.batchId);return s=s.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((()=>{this.Yr=s}))}rr(e){}containsKey(e,t){const s=new xn(t,0),a=this.Yr.firstAfterOrEqual(s);return ae.resolve(t.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,ae.resolve()}ti(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zP{constructor(e){this.ni=e,this.docs=(function(){return new Ht(Fe.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const s=t.key,a=this.docs.get(s),l=a?a.size:0,d=this.ni(t);return this.docs=this.docs.insert(s,{document:t.mutableCopy(),size:d}),this.size+=d-l,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const s=this.docs.get(t);return ae.resolve(s?s.document.mutableCopy():$n.newInvalidDocument(t))}getEntries(e,t){let s=ti();return t.forEach((a=>{const l=this.docs.get(a);s=s.insert(a,l?l.document.mutableCopy():$n.newInvalidDocument(a))})),ae.resolve(s)}getDocumentsMatchingQuery(e,t,s,a){let l=ti();const d=t.path,f=new Fe(d.child("__id-9223372036854775808__")),m=this.docs.getIteratorFrom(f);for(;m.hasNext();){const{key:v,value:{document:w}}=m.getNext();if(!d.isPrefixOf(v.path))break;v.path.length>d.length+1||gC(mC(w),s)<=0||(a.has(w.key)||Zu(t,w))&&(l=l.insert(w.key,w.mutableCopy()))}return ae.resolve(l)}getAllFromCollectionGroup(e,t,s,a){He(9500)}ri(e,t){return ae.forEach(this.docs,(s=>t(s)))}newChangeBuffer(e){return new BP(this)}getSize(e){return ae.resolve(this.size)}}class BP extends DP{constructor(e){super(),this.Or=e}applyChanges(e){const t=[];return this.changes.forEach(((s,a)=>{a.isValidDocument()?t.push(this.Or.addEntry(e,a)):this.Or.removeEntry(s)})),ae.waitFor(t)}getFromCache(e,t){return this.Or.getEntry(e,t)}getAllFromCache(e,t){return this.Or.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $P{constructor(e){this.persistence=e,this.ii=new Sa((t=>ip(t)),ap),this.lastRemoteSnapshotVersion=Je.min(),this.highestTargetId=0,this.si=0,this.oi=new fp,this.targetCount=0,this._i=To.ar()}forEachTarget(e,t){return this.ii.forEach(((s,a)=>t(a))),ae.resolve()}getLastRemoteSnapshotVersion(e){return ae.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ae.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),ae.resolve(this.highestTargetId)}setTargetsMetadata(e,t,s){return s&&(this.lastRemoteSnapshotVersion=s),t>this.si&&(this.si=t),ae.resolve()}hr(e){this.ii.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this._i=new To(t),this.highestTargetId=t),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,t){return this.hr(t),this.targetCount+=1,ae.resolve()}updateTargetData(e,t){return this.hr(t),ae.resolve()}removeTargetData(e,t){return this.ii.delete(t.target),this.oi.zr(t.targetId),this.targetCount-=1,ae.resolve()}removeTargets(e,t,s){let a=0;const l=[];return this.ii.forEach(((d,f)=>{f.sequenceNumber<=t&&s.get(f.targetId)===null&&(this.ii.delete(d),l.push(this.removeMatchingKeysForTargetId(e,f.targetId)),a++)})),ae.waitFor(l).next((()=>a))}getTargetCount(e){return ae.resolve(this.targetCount)}getTargetData(e,t){const s=this.ii.get(t)||null;return ae.resolve(s)}addMatchingKeys(e,t,s){return this.oi.Kr(t,s),ae.resolve()}removeMatchingKeys(e,t,s){this.oi.Gr(t,s);const a=this.persistence.referenceDelegate,l=[];return a&&t.forEach((d=>{l.push(a.markPotentiallyOrphaned(e,d))})),ae.waitFor(l)}removeMatchingKeysForTargetId(e,t){return this.oi.zr(t),ae.resolve()}getMatchingKeysForTargetId(e,t){const s=this.oi.Jr(t);return ae.resolve(s)}containsKey(e,t){return ae.resolve(this.oi.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z0{constructor(e,t){this.ai={},this.overlays={},this.ui=new Qu(0),this.ci=!1,this.ci=!0,this.li=new FP,this.referenceDelegate=e(this),this.hi=new $P(this),this.indexManager=new PP,this.remoteDocumentCache=(function(a){return new zP(a)})((s=>this.referenceDelegate.Pi(s))),this.serializer=new IP(t),this.Ti=new OP(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new MP,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let s=this.ai[e.toKey()];return s||(s=new UP(t,this.referenceDelegate),this.ai[e.toKey()]=s),s}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,t,s){Pe("MemoryPersistence","Starting transaction:",e);const a=new WP(this.ui.next());return this.referenceDelegate.Ii(),s(a).next((l=>this.referenceDelegate.di(a).next((()=>l)))).toPromise().then((l=>(a.raiseOnCommittedEvent(),l)))}Ei(e,t){return ae.or(Object.values(this.ai).map((s=>()=>s.containsKey(e,t))))}}class WP extends vC{constructor(e){super(),this.currentSequenceNumber=e}}class pp{constructor(e){this.persistence=e,this.Ai=new fp,this.Ri=null}static Vi(e){return new pp(e)}get mi(){if(this.Ri)return this.Ri;throw He(60996)}addReference(e,t,s){return this.Ai.addReference(s,t),this.mi.delete(s.toString()),ae.resolve()}removeReference(e,t,s){return this.Ai.removeReference(s,t),this.mi.add(s.toString()),ae.resolve()}markPotentiallyOrphaned(e,t){return this.mi.add(t.toString()),ae.resolve()}removeTarget(e,t){this.Ai.zr(t.targetId).forEach((a=>this.mi.add(a.toString())));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,t.targetId).next((a=>{a.forEach((l=>this.mi.add(l.toString())))})).next((()=>s.removeTargetData(e,t)))}Ii(){this.Ri=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ae.forEach(this.mi,(s=>{const a=Fe.fromPath(s);return this.fi(e,a).next((l=>{l||t.removeEntry(a,Je.min())}))})).next((()=>(this.Ri=null,t.apply(e))))}updateLimboDocument(e,t){return this.fi(e,t).next((s=>{s?this.mi.delete(t.toString()):this.mi.add(t.toString())}))}Pi(e){return 0}fi(e,t){return ae.or([()=>ae.resolve(this.Ai.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class Mu{constructor(e,t){this.persistence=e,this.gi=new Sa((s=>xC(s.path)),((s,a)=>s.isEqual(a))),this.garbageCollector=jP(this,t)}static Vi(e,t){return new Mu(e,t)}Ii(){}di(e){return ae.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}mr(e){const t=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next((s=>t.next((a=>s+a))))}yr(e){let t=0;return this.gr(e,(s=>{t++})).next((()=>t))}gr(e,t){return ae.forEach(this.gi,((s,a)=>this.Sr(e,s,a).next((l=>l?ae.resolve():t(a)))))}removeTargets(e,t,s){return this.persistence.getTargetCache().removeTargets(e,t,s)}removeOrphanedDocuments(e,t){let s=0;const a=this.persistence.getRemoteDocumentCache(),l=a.newChangeBuffer();return a.ri(e,(d=>this.Sr(e,d,t).next((f=>{f||(s++,l.removeEntry(d,Je.min()))})))).next((()=>l.apply(e))).next((()=>s))}markPotentiallyOrphaned(e,t){return this.gi.set(t,e.currentSequenceNumber),ae.resolve()}removeTarget(e,t){const s=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,s)}addReference(e,t,s){return this.gi.set(s,e.currentSequenceNumber),ae.resolve()}removeReference(e,t,s){return this.gi.set(s,e.currentSequenceNumber),ae.resolve()}updateLimboDocument(e,t){return this.gi.set(t,e.currentSequenceNumber),ae.resolve()}Pi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=gu(e.data.value)),t}Sr(e,t,s){return ae.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const a=this.gi.get(t);return ae.resolve(a!==void 0&&a>s)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mp{constructor(e,t,s,a){this.targetId=e,this.fromCache=t,this.Is=s,this.ds=a}static Es(e,t){let s=ct(),a=ct();for(const l of t.docChanges)switch(l.type){case 0:s=s.add(l.doc.key);break;case 1:a=a.add(l.doc.key)}return new mp(e,t.fromCache,s,a)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qP{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HP{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=(function(){return TT()?8:_C(Wn())>0?6:4})()}initialize(e,t){this.gs=e,this.indexManager=t,this.As=!0}getDocumentsMatchingQuery(e,t,s,a){const l={result:null};return this.ps(e,t).next((d=>{l.result=d})).next((()=>{if(!l.result)return this.ys(e,t,a,s).next((d=>{l.result=d}))})).next((()=>{if(l.result)return;const d=new qP;return this.ws(e,t,d).next((f=>{if(l.result=f,this.Rs)return this.Ss(e,t,d,f.size)}))})).next((()=>l.result))}Ss(e,t,s,a){return s.documentReadCount<this.Vs?(lo()<=lt.DEBUG&&Pe("QueryEngine","SDK will not create cache indexes for query:",co(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),ae.resolve()):(lo()<=lt.DEBUG&&Pe("QueryEngine","Query:",co(t),"scans",s.documentReadCount,"local documents and returns",a,"documents as results."),s.documentReadCount>this.fs*a?(lo()<=lt.DEBUG&&Pe("QueryEngine","The SDK decides to create cache indexes for query:",co(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Is(t))):ae.resolve())}ps(e,t){if(nv(t))return ae.resolve(null);let s=Is(t);return this.indexManager.getIndexType(e,s).next((a=>a===0?null:(t.limit!==null&&a===1&&(t=Tf(t,null,"F"),s=Is(t)),this.indexManager.getDocumentsMatchingTarget(e,s).next((l=>{const d=ct(...l);return this.gs.getDocuments(e,d).next((f=>this.indexManager.getMinOffset(e,s).next((m=>{const v=this.bs(t,f);return this.Ds(t,v,d,m.readTime)?this.ps(e,Tf(t,null,"F")):this.vs(e,v,t,m)}))))})))))}ys(e,t,s,a){return nv(t)||a.isEqual(Je.min())?ae.resolve(null):this.gs.getDocuments(e,s).next((l=>{const d=this.bs(t,l);return this.Ds(t,d,s,a)?ae.resolve(null):(lo()<=lt.DEBUG&&Pe("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),co(t)),this.vs(e,d,t,pC(a,jl)).next((f=>f)))}))}bs(e,t){let s=new mn(N0(e));return t.forEach(((a,l)=>{Zu(e,l)&&(s=s.add(l))})),s}Ds(e,t,s,a){if(e.limit===null)return!1;if(s.size!==t.size)return!0;const l=e.limitType==="F"?t.last():t.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(a)>0)}ws(e,t,s){return lo()<=lt.DEBUG&&Pe("QueryEngine","Using full collection scan to execute query:",co(t)),this.gs.getDocumentsMatchingQuery(e,t,Vi.min(),s)}vs(e,t,s,a){return this.gs.getDocumentsMatchingQuery(e,s,a).next((l=>(t.forEach((d=>{l=l.insert(d.key,d)})),l)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gp="LocalStore",GP=3e8;class KP{constructor(e,t,s,a){this.persistence=e,this.Cs=t,this.serializer=a,this.Fs=new Ht(st),this.Ms=new Sa((l=>ip(l)),ap),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(s)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new LP(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Fs)))}}function QP(n,e,t,s){return new KP(n,e,t,s)}async function ew(n,e){const t=Xe(n);return await t.persistence.runTransaction("Handle user change","readonly",(s=>{let a;return t.mutationQueue.getAllMutationBatches(s).next((l=>(a=l,t.Ns(e),t.mutationQueue.getAllMutationBatches(s)))).next((l=>{const d=[],f=[];let m=ct();for(const v of a){d.push(v.batchId);for(const w of v.mutations)m=m.add(w.key)}for(const v of l){f.push(v.batchId);for(const w of v.mutations)m=m.add(w.key)}return t.localDocuments.getDocuments(s,m).next((v=>({Bs:v,removedBatchIds:d,addedBatchIds:f})))}))}))}function YP(n,e){const t=Xe(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(s=>{const a=e.batch.keys(),l=t.Os.newChangeBuffer({trackRemovals:!0});return(function(f,m,v,w){const E=v.batch,C=E.keys();let $=ae.resolve();return C.forEach((q=>{$=$.next((()=>w.getEntry(m,q))).next((Y=>{const F=v.docVersions.get(q);Tt(F!==null,48541),Y.version.compareTo(F)<0&&(E.applyToRemoteDocument(Y,v),Y.isValidDocument()&&(Y.setReadTime(v.commitVersion),w.addEntry(Y)))}))})),$.next((()=>f.mutationQueue.removeMutationBatch(m,E)))})(t,s,e,l).next((()=>l.apply(s))).next((()=>t.mutationQueue.performConsistencyCheck(s))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(s,a,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,(function(f){let m=ct();for(let v=0;v<f.mutationResults.length;++v)f.mutationResults[v].transformResults.length>0&&(m=m.add(f.batch.mutations[v].key));return m})(e)))).next((()=>t.localDocuments.getDocuments(s,a)))}))}function tw(n){const e=Xe(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.hi.getLastRemoteSnapshotVersion(t)))}function JP(n,e){const t=Xe(n),s=e.snapshotVersion;let a=t.Fs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const d=t.Os.newChangeBuffer({trackRemovals:!0});a=t.Fs;const f=[];e.targetChanges.forEach(((w,E)=>{const C=a.get(E);if(!C)return;f.push(t.hi.removeMatchingKeys(l,w.removedDocuments,E).next((()=>t.hi.addMatchingKeys(l,w.addedDocuments,E))));let $=C.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(E)!==null?$=$.withResumeToken(kn.EMPTY_BYTE_STRING,Je.min()).withLastLimboFreeSnapshotVersion(Je.min()):w.resumeToken.approximateByteSize()>0&&($=$.withResumeToken(w.resumeToken,s)),a=a.insert(E,$),(function(Y,F,X){return Y.resumeToken.approximateByteSize()===0||F.snapshotVersion.toMicroseconds()-Y.snapshotVersion.toMicroseconds()>=GP?!0:X.addedDocuments.size+X.modifiedDocuments.size+X.removedDocuments.size>0})(C,$,w)&&f.push(t.hi.updateTargetData(l,$))}));let m=ti(),v=ct();if(e.documentUpdates.forEach((w=>{e.resolvedLimboDocuments.has(w)&&f.push(t.persistence.referenceDelegate.updateLimboDocument(l,w))})),f.push(XP(l,d,e.documentUpdates).next((w=>{m=w.Ls,v=w.ks}))),!s.isEqual(Je.min())){const w=t.hi.getLastRemoteSnapshotVersion(l).next((E=>t.hi.setTargetsMetadata(l,l.currentSequenceNumber,s)));f.push(w)}return ae.waitFor(f).next((()=>d.apply(l))).next((()=>t.localDocuments.getLocalViewOfDocuments(l,m,v))).next((()=>m))})).then((l=>(t.Fs=a,l)))}function XP(n,e,t){let s=ct(),a=ct();return t.forEach((l=>s=s.add(l))),e.getEntries(n,s).next((l=>{let d=ti();return t.forEach(((f,m)=>{const v=l.get(f);m.isFoundDocument()!==v.isFoundDocument()&&(a=a.add(f)),m.isNoDocument()&&m.version.isEqual(Je.min())?(e.removeEntry(f,m.readTime),d=d.insert(f,m)):!v.isValidDocument()||m.version.compareTo(v.version)>0||m.version.compareTo(v.version)===0&&v.hasPendingWrites?(e.addEntry(m),d=d.insert(f,m)):Pe(gp,"Ignoring outdated watch update for ",f,". Current version:",v.version," Watch version:",m.version)})),{Ls:d,ks:a}}))}function ZP(n,e){const t=Xe(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(s=>(e===void 0&&(e=np),t.mutationQueue.getNextMutationBatchAfterBatchId(s,e))))}function eb(n,e){const t=Xe(n);return t.persistence.runTransaction("Allocate target","readwrite",(s=>{let a;return t.hi.getTargetData(s,e).next((l=>l?(a=l,ae.resolve(a)):t.hi.allocateTargetId(s).next((d=>(a=new Pi(e,d,"TargetPurposeListen",s.currentSequenceNumber),t.hi.addTargetData(s,a).next((()=>a)))))))})).then((s=>{const a=t.Fs.get(s.targetId);return(a===null||s.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(t.Fs=t.Fs.insert(s.targetId,s),t.Ms.set(e,s.targetId)),s}))}async function bf(n,e,t){const s=Xe(n),a=s.Fs.get(e),l=t?"readwrite":"readwrite-primary";try{t||await s.persistence.runTransaction("Release target",l,(d=>s.persistence.referenceDelegate.removeTarget(d,a)))}catch(d){if(!ko(d))throw d;Pe(gp,`Failed to update sequence numbers for target ${e}: ${d}`)}s.Fs=s.Fs.remove(e),s.Ms.delete(a.target)}function mv(n,e,t){const s=Xe(n);let a=Je.min(),l=ct();return s.persistence.runTransaction("Execute query","readwrite",(d=>(function(m,v,w){const E=Xe(m),C=E.Ms.get(w);return C!==void 0?ae.resolve(E.Fs.get(C)):E.hi.getTargetData(v,w)})(s,d,Is(e)).next((f=>{if(f)return a=f.lastLimboFreeSnapshotVersion,s.hi.getMatchingKeysForTargetId(d,f.targetId).next((m=>{l=m}))})).next((()=>s.Cs.getDocumentsMatchingQuery(d,e,t?a:Je.min(),t?l:ct()))).next((f=>(tb(s,UC(e),f),{documents:f,qs:l})))))}function tb(n,e,t){let s=n.xs.get(e)||Je.min();t.forEach(((a,l)=>{l.readTime.compareTo(s)>0&&(s=l.readTime)})),n.xs.set(e,s)}class gv{constructor(){this.activeTargetIds=HC()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class nb{constructor(){this.Fo=new gv,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,s){}addLocalQueryTarget(e,t=!0){return t&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,t,s){this.Mo[e]=t}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new gv,Promise.resolve()}handleUserChange(e,t,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rb{xo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yv="ConnectivityMonitor";class vv{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){Pe(yv,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){Pe(yv,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let uu=null;function Rf(){return uu===null?uu=(function(){return 268435456+Math.round(2147483648*Math.random())})():uu++,"0x"+uu.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jh="RestConnection",sb={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class ib{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.$o=t+"://"+e.host,this.Uo=`projects/${s}/databases/${a}`,this.Ko=this.databaseId.database===ku?`project_id=${s}`:`project_id=${s}&database_id=${a}`}Wo(e,t,s,a,l){const d=Rf(),f=this.Go(e,t.toUriEncodedString());Pe(Jh,`Sending RPC '${e}' ${d}:`,f,s);const m={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(m,a,l);const{host:v}=new URL(f),w=Po(v);return this.jo(e,f,m,s,w).then((E=>(Pe(Jh,`Received RPC '${e}' ${d}: `,E),E)),(E=>{throw Di(Jh,`RPC '${e}' ${d} failed with error: `,E,"url: ",f,"request:",s),E}))}Jo(e,t,s,a,l,d){return this.Wo(e,t,s,a,l)}zo(e,t,s){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Ao})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((a,l)=>e[l]=a)),s&&s.headers.forEach(((a,l)=>e[l]=a))}Go(e,t){const s=sb[e];return`${this.$o}/v1/${t}:${s}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ab{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zn="WebChannelConnection";class ob extends ib{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,t,s,a,l){const d=Rf();return new Promise(((f,m)=>{const v=new r0;v.setWithCredentials(!0),v.listenOnce(s0.COMPLETE,(()=>{try{switch(v.getLastErrorCode()){case mu.NO_ERROR:const E=v.getResponseJson();Pe(zn,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(E)),f(E);break;case mu.TIMEOUT:Pe(zn,`RPC '${e}' ${d} timed out`),m(new Ie(ie.DEADLINE_EXCEEDED,"Request time out"));break;case mu.HTTP_ERROR:const C=v.getStatus();if(Pe(zn,`RPC '${e}' ${d} failed with status:`,C,"response text:",v.getResponseText()),C>0){let $=v.getResponseJson();Array.isArray($)&&($=$[0]);const q=$==null?void 0:$.error;if(q&&q.status&&q.message){const Y=(function(X){const ge=X.toLowerCase().replace(/_/g,"-");return Object.values(ie).indexOf(ge)>=0?ge:ie.UNKNOWN})(q.status);m(new Ie(Y,q.message))}else m(new Ie(ie.UNKNOWN,"Server responded with status "+v.getStatus()))}else m(new Ie(ie.UNAVAILABLE,"Connection failed."));break;default:He(9055,{c_:e,streamId:d,l_:v.getLastErrorCode(),h_:v.getLastError()})}}finally{Pe(zn,`RPC '${e}' ${d} completed.`)}}));const w=JSON.stringify(a);Pe(zn,`RPC '${e}' ${d} sending request:`,a),v.send(t,"POST",w,s,15)}))}P_(e,t,s){const a=Rf(),l=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=o0(),f=a0(),m={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},v=this.longPollingOptions.timeoutSeconds;v!==void 0&&(m.longPollingTimeout=Math.round(1e3*v)),this.useFetchStreams&&(m.useFetchStreams=!0),this.zo(m.initMessageHeaders,t,s),m.encodeInitMessageHeaders=!0;const w=l.join("");Pe(zn,`Creating RPC '${e}' stream ${a}: ${w}`,m);const E=d.createWebChannel(w,m);this.T_(E);let C=!1,$=!1;const q=new ab({Ho:F=>{$?Pe(zn,`Not sending because RPC '${e}' stream ${a} is closed:`,F):(C||(Pe(zn,`Opening RPC '${e}' stream ${a} transport.`),E.open(),C=!0),Pe(zn,`RPC '${e}' stream ${a} sending:`,F),E.send(F))},Yo:()=>E.close()}),Y=(F,X,ge)=>{F.listen(X,(re=>{try{ge(re)}catch(le){setTimeout((()=>{throw le}),0)}}))};return Y(E,vl.EventType.OPEN,(()=>{$||(Pe(zn,`RPC '${e}' stream ${a} transport opened.`),q.s_())})),Y(E,vl.EventType.CLOSE,(()=>{$||($=!0,Pe(zn,`RPC '${e}' stream ${a} transport closed`),q.__(),this.I_(E))})),Y(E,vl.EventType.ERROR,(F=>{$||($=!0,Di(zn,`RPC '${e}' stream ${a} transport errored. Name:`,F.name,"Message:",F.message),q.__(new Ie(ie.UNAVAILABLE,"The operation could not be completed")))})),Y(E,vl.EventType.MESSAGE,(F=>{var X;if(!$){const ge=F.data[0];Tt(!!ge,16349);const re=ge,le=(re==null?void 0:re.error)||((X=re[0])===null||X===void 0?void 0:X.error);if(le){Pe(zn,`RPC '${e}' stream ${a} received error:`,le);const xe=le.status;let Se=(function(k){const L=ln[k];if(L!==void 0)return B0(L)})(xe),N=le.message;Se===void 0&&(Se=ie.INTERNAL,N="Unknown error status: "+xe+" with message "+le.message),$=!0,q.__(new Ie(Se,N)),E.close()}else Pe(zn,`RPC '${e}' stream ${a} received:`,ge),q.a_(ge)}})),Y(f,i0.STAT_EVENT,(F=>{F.stat===gf.PROXY?Pe(zn,`RPC '${e}' stream ${a} detected buffering proxy`):F.stat===gf.NOPROXY&&Pe(zn,`RPC '${e}' stream ${a} detected no buffering proxy`)})),setTimeout((()=>{q.o_()}),0),q}terminate(){this.u_.forEach((e=>e.close())),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter((t=>t===e))}}function Xh(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rd(n){return new dP(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nw{constructor(e,t,s=1e3,a=1.5,l=6e4){this.Fi=e,this.timerId=t,this.d_=s,this.E_=a,this.A_=l,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const t=Math.floor(this.R_+this.p_()),s=Math.max(0,Date.now()-this.m_),a=Math.max(0,t-s);a>0&&Pe("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.R_} ms, delay with jitter: ${t} ms, last attempt: ${s} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,a,(()=>(this.m_=Date.now(),e()))),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _v="PersistentStream";class rw{constructor(e,t,s,a,l,d,f,m){this.Fi=e,this.w_=s,this.S_=a,this.connection=l,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=f,this.listener=m,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new nw(e,t)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,(()=>this.L_())))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():t&&t.code===ie.RESOURCE_EXHAUSTED?(ei(t.toString()),ei("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):t&&t.code===ie.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(t)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),t=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([s,a])=>{this.b_===t&&this.W_(s,a)}),(s=>{e((()=>{const a=new Ie(ie.UNKNOWN,"Fetching auth token failed: "+s.message);return this.G_(a)}))}))}W_(e,t){const s=this.K_(this.b_);this.stream=this.z_(e,t),this.stream.Zo((()=>{s((()=>this.listener.Zo()))})),this.stream.e_((()=>{s((()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,(()=>(this.x_()&&(this.state=3),Promise.resolve()))),this.listener.e_())))})),this.stream.n_((a=>{s((()=>this.G_(a)))})),this.stream.onMessage((a=>{s((()=>++this.C_==1?this.j_(a):this.onNext(a)))}))}O_(){this.state=5,this.F_.g_((async()=>{this.state=0,this.start()}))}G_(e){return Pe(_v,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return t=>{this.Fi.enqueueAndForget((()=>this.b_===e?t():(Pe(_v,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class lb extends rw{constructor(e,t,s,a,l,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,s,a,d),this.serializer=l}z_(e,t){return this.connection.P_("Listen",e,t)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const t=pP(this.serializer,e),s=(function(l){if(!("targetChange"in l))return Je.min();const d=l.targetChange;return d.targetIds&&d.targetIds.length?Je.min():d.readTime?Cs(d.readTime):Je.min()})(e);return this.listener.J_(t,s)}H_(e){const t={};t.database=Pf(this.serializer),t.addTarget=(function(l,d){let f;const m=d.target;if(f=xf(m)?{documents:yP(l,m)}:{query:vP(l,m).Vt},f.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){f.resumeToken=q0(l,d.resumeToken);const v=Sf(l,d.expectedCount);v!==null&&(f.expectedCount=v)}else if(d.snapshotVersion.compareTo(Je.min())>0){f.readTime=Ou(l,d.snapshotVersion.toTimestamp());const v=Sf(l,d.expectedCount);v!==null&&(f.expectedCount=v)}return f})(this.serializer,e);const s=wP(this.serializer,e);s&&(t.labels=s),this.k_(t)}Y_(e){const t={};t.database=Pf(this.serializer),t.removeTarget=e,this.k_(t)}}class cb extends rw{constructor(e,t,s,a,l,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,s,a,d),this.serializer=l}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,t){return this.connection.P_("Write",e,t)}j_(e){return Tt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Tt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){Tt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();const t=gP(e.writeResults,e.commitTime),s=Cs(e.commitTime);return this.listener.ta(s,t)}na(){const e={};e.database=Pf(this.serializer),this.k_(e)}X_(e){const t={streamToken:this.lastStreamToken,writes:e.map((s=>mP(this.serializer,s)))};this.k_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ub{}class db extends ub{constructor(e,t,s,a){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=s,this.serializer=a,this.ra=!1}ia(){if(this.ra)throw new Ie(ie.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,s,a){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,d])=>this.connection.Wo(e,If(t,s),a,l,d))).catch((l=>{throw l.name==="FirebaseError"?(l.code===ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new Ie(ie.UNKNOWN,l.toString())}))}Jo(e,t,s,a,l){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([d,f])=>this.connection.Jo(e,If(t,s),a,d,f,l))).catch((d=>{throw d.name==="FirebaseError"?(d.code===ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new Ie(ie.UNKNOWN,d.toString())}))}terminate(){this.ra=!0,this.connection.terminate()}}class hb{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve()))))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(ei(t),this._a=!1):Pe("OnlineStateTracker",t)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ea="RemoteStore";class fb{constructor(e,t,s,a,l){this.localStore=e,this.datastore=t,this.asyncQueue=s,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=l,this.Ea.xo((d=>{s.enqueueAndForget((async()=>{Ia(this)&&(Pe(Ea,"Restarting streams for network reachability change."),await(async function(m){const v=Xe(m);v.Ia.add(4),await Jl(v),v.Aa.set("Unknown"),v.Ia.delete(4),await sd(v)})(this))}))})),this.Aa=new hb(s,a)}}async function sd(n){if(Ia(n))for(const e of n.da)await e(!0)}async function Jl(n){for(const e of n.da)await e(!1)}function sw(n,e){const t=Xe(n);t.Ta.has(e.targetId)||(t.Ta.set(e.targetId,e),wp(t)?_p(t):jo(t).x_()&&vp(t,e))}function yp(n,e){const t=Xe(n),s=jo(t);t.Ta.delete(e),s.x_()&&iw(t,e),t.Ta.size===0&&(s.x_()?s.B_():Ia(t)&&t.Aa.set("Unknown"))}function vp(n,e){if(n.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Je.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}jo(n).H_(e)}function iw(n,e){n.Ra.$e(e),jo(n).Y_(e)}function _p(n){n.Ra=new oP({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>n.Ta.get(e)||null,lt:()=>n.datastore.serializer.databaseId}),jo(n).start(),n.Aa.aa()}function wp(n){return Ia(n)&&!jo(n).M_()&&n.Ta.size>0}function Ia(n){return Xe(n).Ia.size===0}function aw(n){n.Ra=void 0}async function pb(n){n.Aa.set("Online")}async function mb(n){n.Ta.forEach(((e,t)=>{vp(n,e)}))}async function gb(n,e){aw(n),wp(n)?(n.Aa.la(e),_p(n)):n.Aa.set("Unknown")}async function yb(n,e,t){if(n.Aa.set("Online"),e instanceof W0&&e.state===2&&e.cause)try{await(async function(a,l){const d=l.cause;for(const f of l.targetIds)a.Ta.has(f)&&(await a.remoteSyncer.rejectListen(f,d),a.Ta.delete(f),a.Ra.removeTarget(f))})(n,e)}catch(s){Pe(Ea,"Failed to remove targets %s: %s ",e.targetIds.join(","),s),await Fu(n,s)}else if(e instanceof _u?n.Ra.Ye(e):e instanceof $0?n.Ra.it(e):n.Ra.et(e),!t.isEqual(Je.min()))try{const s=await tw(n.localStore);t.compareTo(s)>=0&&await(function(l,d){const f=l.Ra.Pt(d);return f.targetChanges.forEach(((m,v)=>{if(m.resumeToken.approximateByteSize()>0){const w=l.Ta.get(v);w&&l.Ta.set(v,w.withResumeToken(m.resumeToken,d))}})),f.targetMismatches.forEach(((m,v)=>{const w=l.Ta.get(m);if(!w)return;l.Ta.set(m,w.withResumeToken(kn.EMPTY_BYTE_STRING,w.snapshotVersion)),iw(l,m);const E=new Pi(w.target,m,v,w.sequenceNumber);vp(l,E)})),l.remoteSyncer.applyRemoteEvent(f)})(n,t)}catch(s){Pe(Ea,"Failed to raise snapshot:",s),await Fu(n,s)}}async function Fu(n,e,t){if(!ko(e))throw e;n.Ia.add(1),await Jl(n),n.Aa.set("Offline"),t||(t=()=>tw(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{Pe(Ea,"Retrying IndexedDB access"),await t(),n.Ia.delete(1),await sd(n)}))}function ow(n,e){return e().catch((t=>Fu(n,t,e)))}async function id(n){const e=Xe(n),t=Fi(e);let s=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:np;for(;vb(e);)try{const a=await ZP(e.localStore,s);if(a===null){e.Pa.length===0&&t.B_();break}s=a.batchId,_b(e,a)}catch(a){await Fu(e,a)}lw(e)&&cw(e)}function vb(n){return Ia(n)&&n.Pa.length<10}function _b(n,e){n.Pa.push(e);const t=Fi(n);t.x_()&&t.Z_&&t.X_(e.mutations)}function lw(n){return Ia(n)&&!Fi(n).M_()&&n.Pa.length>0}function cw(n){Fi(n).start()}async function wb(n){Fi(n).na()}async function xb(n){const e=Fi(n);for(const t of n.Pa)e.X_(t.mutations)}async function Eb(n,e,t){const s=n.Pa.shift(),a=up.from(s,e,t);await ow(n,(()=>n.remoteSyncer.applySuccessfulWrite(a))),await id(n)}async function Tb(n,e){e&&Fi(n).Z_&&await(async function(s,a){if((function(d){return iP(d)&&d!==ie.ABORTED})(a.code)){const l=s.Pa.shift();Fi(s).N_(),await ow(s,(()=>s.remoteSyncer.rejectFailedWrite(l.batchId,a))),await id(s)}})(n,e),lw(n)&&cw(n)}async function wv(n,e){const t=Xe(n);t.asyncQueue.verifyOperationInProgress(),Pe(Ea,"RemoteStore received new credentials");const s=Ia(t);t.Ia.add(3),await Jl(t),s&&t.Aa.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ia.delete(3),await sd(t)}async function Sb(n,e){const t=Xe(n);e?(t.Ia.delete(2),await sd(t)):e||(t.Ia.add(2),await Jl(t),t.Aa.set("Unknown"))}function jo(n){return n.Va||(n.Va=(function(t,s,a){const l=Xe(t);return l.ia(),new lb(s,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(n.datastore,n.asyncQueue,{Zo:pb.bind(null,n),e_:mb.bind(null,n),n_:gb.bind(null,n),J_:yb.bind(null,n)}),n.da.push((async e=>{e?(n.Va.N_(),wp(n)?_p(n):n.Aa.set("Unknown")):(await n.Va.stop(),aw(n))}))),n.Va}function Fi(n){return n.ma||(n.ma=(function(t,s,a){const l=Xe(t);return l.ia(),new cb(s,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),e_:wb.bind(null,n),n_:Tb.bind(null,n),ea:xb.bind(null,n),ta:Eb.bind(null,n)}),n.da.push((async e=>{e?(n.ma.N_(),await id(n)):(await n.ma.stop(),n.Pa.length>0&&(Pe(Ea,`Stopping write stream with ${n.Pa.length} pending writes`),n.Pa=[]))}))),n.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xp{constructor(e,t,s,a,l){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=s,this.op=a,this.removalCallback=l,this.deferred=new Ys,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((d=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,s,a,l){const d=Date.now()+s,f=new xp(e,t,d,a,l);return f.start(s),f}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ie(ie.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ep(n,e){if(ei("AsyncQueue",`${e}: ${n}`),ko(n))return new Ie(ie.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class go{static emptySet(e){return new go(e.comparator)}constructor(e){this.comparator=e?(t,s)=>e(t,s)||Fe.comparator(t.key,s.key):(t,s)=>Fe.comparator(t.key,s.key),this.keyedMap=_l(),this.sortedSet=new Ht(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,s)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof go)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=s.getNext().key;if(!a.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const s=new go;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=t,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xv{constructor(){this.fa=new Ht(Fe.comparator)}track(e){const t=e.doc.key,s=this.fa.get(t);s?e.type!==0&&s.type===3?this.fa=this.fa.insert(t,e):e.type===3&&s.type!==1?this.fa=this.fa.insert(t,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.fa=this.fa.insert(t,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.fa=this.fa.remove(t):e.type===1&&s.type===2?this.fa=this.fa.insert(t,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):He(63341,{At:e,ga:s}):this.fa=this.fa.insert(t,e)}pa(){const e=[];return this.fa.inorderTraversal(((t,s)=>{e.push(s)})),e}}class So{constructor(e,t,s,a,l,d,f,m,v){this.query=e,this.docs=t,this.oldDocs=s,this.docChanges=a,this.mutatedKeys=l,this.fromCache=d,this.syncStateChanged=f,this.excludesMetadataChanges=m,this.hasCachedResults=v}static fromInitialDocuments(e,t,s,a,l){const d=[];return t.forEach((f=>{d.push({type:0,doc:f})})),new So(e,t,go.emptySet(t),d,s,a,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Xu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,s=e.docChanges;if(t.length!==s.length)return!1;for(let a=0;a<t.length;a++)if(t[a].type!==s[a].type||!t[a].doc.isEqual(s[a].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ib{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some((e=>e.ba()))}}class Cb{constructor(){this.queries=Ev(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(t,s){const a=Xe(t),l=a.queries;a.queries=Ev(),l.forEach(((d,f)=>{for(const m of f.wa)m.onError(s)}))})(this,new Ie(ie.ABORTED,"Firestore shutting down"))}}function Ev(){return new Sa((n=>A0(n)),Xu)}async function uw(n,e){const t=Xe(n);let s=3;const a=e.query;let l=t.queries.get(a);l?!l.Sa()&&e.ba()&&(s=2):(l=new Ib,s=e.ba()?0:1);try{switch(s){case 0:l.ya=await t.onListen(a,!0);break;case 1:l.ya=await t.onListen(a,!1);break;case 2:await t.onFirstRemoteStoreListen(a)}}catch(d){const f=Ep(d,`Initialization of query '${co(e.query)}' failed`);return void e.onError(f)}t.queries.set(a,l),l.wa.push(e),e.va(t.onlineState),l.ya&&e.Ca(l.ya)&&Tp(t)}async function dw(n,e){const t=Xe(n),s=e.query;let a=3;const l=t.queries.get(s);if(l){const d=l.wa.indexOf(e);d>=0&&(l.wa.splice(d,1),l.wa.length===0?a=e.ba()?0:1:!l.Sa()&&e.ba()&&(a=2))}switch(a){case 0:return t.queries.delete(s),t.onUnlisten(s,!0);case 1:return t.queries.delete(s),t.onUnlisten(s,!1);case 2:return t.onLastRemoteStoreUnlisten(s);default:return}}function Pb(n,e){const t=Xe(n);let s=!1;for(const a of e){const l=a.query,d=t.queries.get(l);if(d){for(const f of d.wa)f.Ca(a)&&(s=!0);d.ya=a}}s&&Tp(t)}function bb(n,e,t){const s=Xe(n),a=s.queries.get(e);if(a)for(const l of a.wa)l.onError(t);s.queries.delete(e)}function Tp(n){n.Da.forEach((e=>{e.next()}))}var Af,Tv;(Tv=Af||(Af={})).Fa="default",Tv.Cache="cache";class hw{constructor(e,t,s){this.query=e,this.Ma=t,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=s||{}}Ca(e){if(!this.options.includeMetadataChanges){const s=[];for(const a of e.docChanges)a.type!==3&&s.push(a);e=new So(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),t=!0):this.Ba(e,this.onlineState)&&(this.La(e),t=!0),this.Oa=e,t}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let t=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),t=!0),t}Ba(e,t){if(!e.fromCache||!this.ba())return!0;const s=t!=="Offline";return(!this.options.ka||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Na(e){if(e.docChanges.length>0)return!0;const t=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}La(e){e=So.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==Af.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fw{constructor(e){this.key=e}}class pw{constructor(e){this.key=e}}class Rb{constructor(e,t){this.query=e,this.Ha=t,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=ct(),this.mutatedKeys=ct(),this.Xa=N0(e),this.eu=new go(this.Xa)}get tu(){return this.Ha}nu(e,t){const s=t?t.ru:new xv,a=t?t.eu:this.eu;let l=t?t.mutatedKeys:this.mutatedKeys,d=a,f=!1;const m=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,v=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal(((w,E)=>{const C=a.get(w),$=Zu(this.query,E)?E:null,q=!!C&&this.mutatedKeys.has(C.key),Y=!!$&&($.hasLocalMutations||this.mutatedKeys.has($.key)&&$.hasCommittedMutations);let F=!1;C&&$?C.data.isEqual($.data)?q!==Y&&(s.track({type:3,doc:$}),F=!0):this.iu(C,$)||(s.track({type:2,doc:$}),F=!0,(m&&this.Xa($,m)>0||v&&this.Xa($,v)<0)&&(f=!0)):!C&&$?(s.track({type:0,doc:$}),F=!0):C&&!$&&(s.track({type:1,doc:C}),F=!0,(m||v)&&(f=!0)),F&&($?(d=d.add($),l=Y?l.add(w):l.delete(w)):(d=d.delete(w),l=l.delete(w)))})),this.query.limit!==null)for(;d.size>this.query.limit;){const w=this.query.limitType==="F"?d.last():d.first();d=d.delete(w.key),l=l.delete(w.key),s.track({type:1,doc:w})}return{eu:d,ru:s,Ds:f,mutatedKeys:l}}iu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,s,a){const l=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const d=e.ru.pa();d.sort(((w,E)=>(function($,q){const Y=F=>{switch(F){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return He(20277,{At:F})}};return Y($)-Y(q)})(w.type,E.type)||this.Xa(w.doc,E.doc))),this.su(s),a=a!=null&&a;const f=t&&!a?this.ou():[],m=this.Za.size===0&&this.current&&!a?1:0,v=m!==this.Ya;return this.Ya=m,d.length!==0||v?{snapshot:new So(this.query,e.eu,l,d,e.mutatedKeys,m===0,v,!1,!!s&&s.resumeToken.approximateByteSize()>0),_u:f}:{_u:f}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new xv,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach((t=>this.Ha=this.Ha.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ha=this.Ha.delete(t))),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=ct(),this.eu.forEach((s=>{this.au(s.key)&&(this.Za=this.Za.add(s.key))}));const t=[];return e.forEach((s=>{this.Za.has(s)||t.push(new pw(s))})),this.Za.forEach((s=>{e.has(s)||t.push(new fw(s))})),t}uu(e){this.Ha=e.qs,this.Za=ct();const t=this.nu(e.documents);return this.applyChanges(t,!0)}cu(){return So.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const Sp="SyncEngine";class Ab{constructor(e,t,s){this.query=e,this.targetId=t,this.view=s}}class Nb{constructor(e){this.key=e,this.lu=!1}}class kb{constructor(e,t,s,a,l,d){this.localStore=e,this.remoteStore=t,this.eventManager=s,this.sharedClientState=a,this.currentUser=l,this.maxConcurrentLimboResolutions=d,this.hu={},this.Pu=new Sa((f=>A0(f)),Xu),this.Tu=new Map,this.Iu=new Set,this.du=new Ht(Fe.comparator),this.Eu=new Map,this.Au=new fp,this.Ru={},this.Vu=new Map,this.mu=To.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function jb(n,e,t=!0){const s=ww(n);let a;const l=s.Pu.get(e);return l?(s.sharedClientState.addLocalQueryTarget(l.targetId),a=l.view.cu()):a=await mw(s,e,t,!0),a}async function Db(n,e){const t=ww(n);await mw(t,e,!0,!1)}async function mw(n,e,t,s){const a=await eb(n.localStore,Is(e)),l=a.targetId,d=n.sharedClientState.addLocalQueryTarget(l,t);let f;return s&&(f=await Vb(n,e,l,d==="current",a.resumeToken)),n.isPrimaryClient&&t&&sw(n.remoteStore,a),f}async function Vb(n,e,t,s,a){n.gu=(E,C,$)=>(async function(Y,F,X,ge){let re=F.view.nu(X);re.Ds&&(re=await mv(Y.localStore,F.query,!1).then((({documents:N})=>F.view.nu(N,re))));const le=ge&&ge.targetChanges.get(F.targetId),xe=ge&&ge.targetMismatches.get(F.targetId)!=null,Se=F.view.applyChanges(re,Y.isPrimaryClient,le,xe);return Iv(Y,F.targetId,Se._u),Se.snapshot})(n,E,C,$);const l=await mv(n.localStore,e,!0),d=new Rb(e,l.qs),f=d.nu(l.documents),m=Yl.createSynthesizedTargetChangeForCurrentChange(t,s&&n.onlineState!=="Offline",a),v=d.applyChanges(f,n.isPrimaryClient,m);Iv(n,t,v._u);const w=new Ab(e,t,d);return n.Pu.set(e,w),n.Tu.has(t)?n.Tu.get(t).push(e):n.Tu.set(t,[e]),v.snapshot}async function Lb(n,e,t){const s=Xe(n),a=s.Pu.get(e),l=s.Tu.get(a.targetId);if(l.length>1)return s.Tu.set(a.targetId,l.filter((d=>!Xu(d,e)))),void s.Pu.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(a.targetId),s.sharedClientState.isActiveQueryTarget(a.targetId)||await bf(s.localStore,a.targetId,!1).then((()=>{s.sharedClientState.clearQueryState(a.targetId),t&&yp(s.remoteStore,a.targetId),Nf(s,a.targetId)})).catch(No)):(Nf(s,a.targetId),await bf(s.localStore,a.targetId,!0))}async function Ob(n,e){const t=Xe(n),s=t.Pu.get(e),a=t.Tu.get(s.targetId);t.isPrimaryClient&&a.length===1&&(t.sharedClientState.removeLocalQueryTarget(s.targetId),yp(t.remoteStore,s.targetId))}async function Mb(n,e,t){const s=qb(n);try{const a=await(function(d,f){const m=Xe(d),v=Mt.now(),w=f.reduce((($,q)=>$.add(q.key)),ct());let E,C;return m.persistence.runTransaction("Locally write mutations","readwrite",($=>{let q=ti(),Y=ct();return m.Os.getEntries($,w).next((F=>{q=F,q.forEach(((X,ge)=>{ge.isValidDocument()||(Y=Y.add(X))}))})).next((()=>m.localDocuments.getOverlayedDocuments($,q))).next((F=>{E=F;const X=[];for(const ge of f){const re=eP(ge,E.get(ge.key).overlayedDocument);re!=null&&X.push(new Hi(ge.key,re,E0(re.value.mapValue),Lr.exists(!0)))}return m.mutationQueue.addMutationBatch($,v,X,f)})).next((F=>{C=F;const X=F.applyToLocalDocumentSet(E,Y);return m.documentOverlayCache.saveOverlays($,F.batchId,X)}))})).then((()=>({batchId:C.batchId,changes:j0(E)})))})(s.localStore,e);s.sharedClientState.addPendingMutation(a.batchId),(function(d,f,m){let v=d.Ru[d.currentUser.toKey()];v||(v=new Ht(st)),v=v.insert(f,m),d.Ru[d.currentUser.toKey()]=v})(s,a.batchId,t),await Xl(s,a.changes),await id(s.remoteStore)}catch(a){const l=Ep(a,"Failed to persist write");t.reject(l)}}async function gw(n,e){const t=Xe(n);try{const s=await JP(t.localStore,e);e.targetChanges.forEach(((a,l)=>{const d=t.Eu.get(l);d&&(Tt(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?d.lu=!0:a.modifiedDocuments.size>0?Tt(d.lu,14607):a.removedDocuments.size>0&&(Tt(d.lu,42227),d.lu=!1))})),await Xl(t,s,e)}catch(s){await No(s)}}function Sv(n,e,t){const s=Xe(n);if(s.isPrimaryClient&&t===0||!s.isPrimaryClient&&t===1){const a=[];s.Pu.forEach(((l,d)=>{const f=d.view.va(e);f.snapshot&&a.push(f.snapshot)})),(function(d,f){const m=Xe(d);m.onlineState=f;let v=!1;m.queries.forEach(((w,E)=>{for(const C of E.wa)C.va(f)&&(v=!0)})),v&&Tp(m)})(s.eventManager,e),a.length&&s.hu.J_(a),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function Fb(n,e,t){const s=Xe(n);s.sharedClientState.updateQueryState(e,"rejected",t);const a=s.Eu.get(e),l=a&&a.key;if(l){let d=new Ht(Fe.comparator);d=d.insert(l,$n.newNoDocument(l,Je.min()));const f=ct().add(l),m=new nd(Je.min(),new Map,new Ht(st),d,f);await gw(s,m),s.du=s.du.remove(l),s.Eu.delete(e),Ip(s)}else await bf(s.localStore,e,!1).then((()=>Nf(s,e,t))).catch(No)}async function Ub(n,e){const t=Xe(n),s=e.batch.batchId;try{const a=await YP(t.localStore,e);vw(t,s,null),yw(t,s),t.sharedClientState.updateMutationState(s,"acknowledged"),await Xl(t,a)}catch(a){await No(a)}}async function zb(n,e,t){const s=Xe(n);try{const a=await(function(d,f){const m=Xe(d);return m.persistence.runTransaction("Reject batch","readwrite-primary",(v=>{let w;return m.mutationQueue.lookupMutationBatch(v,f).next((E=>(Tt(E!==null,37113),w=E.keys(),m.mutationQueue.removeMutationBatch(v,E)))).next((()=>m.mutationQueue.performConsistencyCheck(v))).next((()=>m.documentOverlayCache.removeOverlaysForBatchId(v,w,f))).next((()=>m.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(v,w))).next((()=>m.localDocuments.getDocuments(v,w)))}))})(s.localStore,e);vw(s,e,t),yw(s,e),s.sharedClientState.updateMutationState(e,"rejected",t),await Xl(s,a)}catch(a){await No(a)}}function yw(n,e){(n.Vu.get(e)||[]).forEach((t=>{t.resolve()})),n.Vu.delete(e)}function vw(n,e,t){const s=Xe(n);let a=s.Ru[s.currentUser.toKey()];if(a){const l=a.get(e);l&&(t?l.reject(t):l.resolve(),a=a.remove(e)),s.Ru[s.currentUser.toKey()]=a}}function Nf(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const s of n.Tu.get(e))n.Pu.delete(s),t&&n.hu.pu(s,t);n.Tu.delete(e),n.isPrimaryClient&&n.Au.zr(e).forEach((s=>{n.Au.containsKey(s)||_w(n,s)}))}function _w(n,e){n.Iu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(yp(n.remoteStore,t),n.du=n.du.remove(e),n.Eu.delete(t),Ip(n))}function Iv(n,e,t){for(const s of t)s instanceof fw?(n.Au.addReference(s.key,e),Bb(n,s)):s instanceof pw?(Pe(Sp,"Document no longer in limbo: "+s.key),n.Au.removeReference(s.key,e),n.Au.containsKey(s.key)||_w(n,s.key)):He(19791,{yu:s})}function Bb(n,e){const t=e.key,s=t.path.canonicalString();n.du.get(t)||n.Iu.has(s)||(Pe(Sp,"New document in limbo: "+t),n.Iu.add(s),Ip(n))}function Ip(n){for(;n.Iu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Iu.values().next().value;n.Iu.delete(e);const t=new Fe(kt.fromString(e)),s=n.mu.next();n.Eu.set(s,new Nb(t)),n.du=n.du.insert(t,s),sw(n.remoteStore,new Pi(Is(op(t.path)),s,"TargetPurposeLimboResolution",Qu.ue))}}async function Xl(n,e,t){const s=Xe(n),a=[],l=[],d=[];s.Pu.isEmpty()||(s.Pu.forEach(((f,m)=>{d.push(s.gu(m,e,t).then((v=>{var w;if((v||t)&&s.isPrimaryClient){const E=v?!v.fromCache:(w=t==null?void 0:t.targetChanges.get(m.targetId))===null||w===void 0?void 0:w.current;s.sharedClientState.updateQueryState(m.targetId,E?"current":"not-current")}if(v){a.push(v);const E=mp.Es(m.targetId,v);l.push(E)}})))})),await Promise.all(d),s.hu.J_(a),await(async function(m,v){const w=Xe(m);try{await w.persistence.runTransaction("notifyLocalViewChanges","readwrite",(E=>ae.forEach(v,(C=>ae.forEach(C.Is,($=>w.persistence.referenceDelegate.addReference(E,C.targetId,$))).next((()=>ae.forEach(C.ds,($=>w.persistence.referenceDelegate.removeReference(E,C.targetId,$)))))))))}catch(E){if(!ko(E))throw E;Pe(gp,"Failed to update sequence numbers: "+E)}for(const E of v){const C=E.targetId;if(!E.fromCache){const $=w.Fs.get(C),q=$.snapshotVersion,Y=$.withLastLimboFreeSnapshotVersion(q);w.Fs=w.Fs.insert(C,Y)}}})(s.localStore,l))}async function $b(n,e){const t=Xe(n);if(!t.currentUser.isEqual(e)){Pe(Sp,"User change. New user:",e.toKey());const s=await ew(t.localStore,e);t.currentUser=e,(function(l,d){l.Vu.forEach((f=>{f.forEach((m=>{m.reject(new Ie(ie.CANCELLED,d))}))})),l.Vu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await Xl(t,s.Bs)}}function Wb(n,e){const t=Xe(n),s=t.Eu.get(e);if(s&&s.lu)return ct().add(s.key);{let a=ct();const l=t.Tu.get(e);if(!l)return a;for(const d of l){const f=t.Pu.get(d);a=a.unionWith(f.view.tu)}return a}}function ww(n){const e=Xe(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=gw.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Wb.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Fb.bind(null,e),e.hu.J_=Pb.bind(null,e.eventManager),e.hu.pu=bb.bind(null,e.eventManager),e}function qb(n){const e=Xe(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Ub.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=zb.bind(null,e),e}class Uu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=rd(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,t){return null}Fu(e,t){return null}vu(e){return QP(this.persistence,new HP,e.initialUser,this.serializer)}Du(e){return new Z0(pp.Vi,this.serializer)}bu(e){return new nb}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Uu.provider={build:()=>new Uu};class Hb extends Uu{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,t){Tt(this.persistence.referenceDelegate instanceof Mu,46915);const s=this.persistence.referenceDelegate.garbageCollector;return new NP(s,e.asyncQueue,t)}Du(e){const t=this.cacheSizeBytes!==void 0?ur.withCacheSize(this.cacheSizeBytes):ur.DEFAULT;return new Z0((s=>Mu.Vi(s,t)),this.serializer)}}class kf{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>Sv(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=$b.bind(null,this.syncEngine),await Sb(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new Cb})()}createDatastore(e){const t=rd(e.databaseInfo.databaseId),s=(function(l){return new ob(l)})(e.databaseInfo);return(function(l,d,f,m){return new db(l,d,f,m)})(e.authCredentials,e.appCheckCredentials,s,t)}createRemoteStore(e){return(function(s,a,l,d,f){return new fb(s,a,l,d,f)})(this.localStore,this.datastore,e.asyncQueue,(t=>Sv(this.syncEngine,t,0)),(function(){return vv.C()?new vv:new rb})())}createSyncEngine(e,t){return(function(a,l,d,f,m,v,w){const E=new kb(a,l,d,f,m,v);return w&&(E.fu=!0),E})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(a){const l=Xe(a);Pe(Ea,"RemoteStore shutting down."),l.Ia.add(5),await Jl(l),l.Ea.shutdown(),l.Aa.set("Unknown")})(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}kf.provider={build:()=>new kf};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xw{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):ei("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ui="FirestoreClient";class Gb{constructor(e,t,s,a,l){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=s,this.databaseInfo=a,this.user=Bn.UNAUTHENTICATED,this.clientId=tp.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(s,(async d=>{Pe(Ui,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d})),this.appCheckCredentials.start(s,(d=>(Pe(Ui,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ys;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const s=Ep(t,"Failed to shutdown persistence");e.reject(s)}})),e.promise}}async function Zh(n,e){n.asyncQueue.verifyOperationInProgress(),Pe(Ui,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let s=t.initialUser;n.setCredentialChangeListener((async a=>{s.isEqual(a)||(await ew(e.localStore,a),s=a)})),e.persistence.setDatabaseDeletedListener((()=>{Di("Terminating Firestore due to IndexedDb database deletion"),n.terminate().then((()=>{Pe("Terminating Firestore due to IndexedDb database deletion completed successfully")})).catch((a=>{Di("Terminating Firestore due to IndexedDb database deletion failed",a)}))})),n._offlineComponents=e}async function Cv(n,e){n.asyncQueue.verifyOperationInProgress();const t=await Kb(n);Pe(Ui,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((s=>wv(e.remoteStore,s))),n.setAppCheckTokenChangeListener(((s,a)=>wv(e.remoteStore,a))),n._onlineComponents=e}async function Kb(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Pe(Ui,"Using user provided OfflineComponentProvider");try{await Zh(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(a){return a.name==="FirebaseError"?a.code===ie.FAILED_PRECONDITION||a.code===ie.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11})(t))throw t;Di("Error using user provided cache. Falling back to memory cache: "+t),await Zh(n,new Uu)}}else Pe(Ui,"Using default OfflineComponentProvider"),await Zh(n,new Hb(void 0));return n._offlineComponents}async function Ew(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Pe(Ui,"Using user provided OnlineComponentProvider"),await Cv(n,n._uninitializedComponentsProvider._online)):(Pe(Ui,"Using default OnlineComponentProvider"),await Cv(n,new kf))),n._onlineComponents}function Qb(n){return Ew(n).then((e=>e.syncEngine))}async function Tw(n){const e=await Ew(n),t=e.eventManager;return t.onListen=jb.bind(null,e.syncEngine),t.onUnlisten=Lb.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=Db.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=Ob.bind(null,e.syncEngine),t}function Yb(n,e,t={}){const s=new Ys;return n.asyncQueue.enqueueAndForget((async()=>(function(l,d,f,m,v){const w=new xw({next:C=>{w.Ou(),d.enqueueAndForget((()=>dw(l,E)));const $=C.docs.has(f);!$&&C.fromCache?v.reject(new Ie(ie.UNAVAILABLE,"Failed to get document because the client is offline.")):$&&C.fromCache&&m&&m.source==="server"?v.reject(new Ie(ie.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):v.resolve(C)},error:C=>v.reject(C)}),E=new hw(op(f.path),w,{includeMetadataChanges:!0,ka:!0});return uw(l,E)})(await Tw(n),n.asyncQueue,e,t,s))),s.promise}function Jb(n,e,t={}){const s=new Ys;return n.asyncQueue.enqueueAndForget((async()=>(function(l,d,f,m,v){const w=new xw({next:C=>{w.Ou(),d.enqueueAndForget((()=>dw(l,E))),C.fromCache&&m.source==="server"?v.reject(new Ie(ie.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):v.resolve(C)},error:C=>v.reject(C)}),E=new hw(f,w,{includeMetadataChanges:!0,ka:!0});return uw(l,E)})(await Tw(n),n.asyncQueue,e,t,s))),s.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sw(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pv=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Iw="firestore.googleapis.com",bv=!0;class Rv{constructor(e){var t,s;if(e.host===void 0){if(e.ssl!==void 0)throw new Ie(ie.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Iw,this.ssl=bv}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:bv;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=X0;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<RP)throw new Ie(ie.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}fC("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Sw((s=e.experimentalLongPollingOptions)!==null&&s!==void 0?s:{}),(function(l){if(l.timeoutSeconds!==void 0){if(isNaN(l.timeoutSeconds))throw new Ie(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${l.timeoutSeconds} (must not be NaN)`);if(l.timeoutSeconds<5)throw new Ie(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${l.timeoutSeconds} (minimum allowed value is 5)`);if(l.timeoutSeconds>30)throw new Ie(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${l.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(s,a){return s.timeoutSeconds===a.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class ad{constructor(e,t,s,a){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=s,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Rv({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ie(ie.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ie(ie.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Rv(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(s){if(!s)return new sC;switch(s.type){case"firstParty":return new lC(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new Ie(ie.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const s=Pv.get(t);s&&(Pe("ComponentProvider","Removing Datastore"),Pv.delete(t),s.terminate())})(this),Promise.resolve()}}function Xb(n,e,t,s={}){var a;n=is(n,ad);const l=Po(e),d=n._getSettings(),f=Object.assign(Object.assign({},d),{emulatorOptions:n._getEmulatorOptions()}),m=`${e}:${t}`;l&&(h_(`https://${m}`),f_("Firestore",!0)),d.host!==Iw&&d.host!==m&&Di("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const v=Object.assign(Object.assign({},d),{host:m,ssl:l,emulatorOptions:s});if(!ya(v,f)&&(n._setSettings(v),s.mockUserToken)){let w,E;if(typeof s.mockUserToken=="string")w=s.mockUserToken,E=Bn.MOCK_USER;else{w=pT(s.mockUserToken,(a=n._app)===null||a===void 0?void 0:a.options.projectId);const C=s.mockUserToken.sub||s.mockUserToken.user_id;if(!C)throw new Ie(ie.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");E=new Bn(C)}n._authCredentials=new iC(new c0(w,E))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Do{constructor(e,t,s){this.converter=t,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new Do(this.firestore,e,this._query)}}class Zt{constructor(e,t,s){this.converter=t,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ji(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Zt(this.firestore,e,this._key)}toJSON(){return{type:Zt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,s){if(Gl(t,Zt._jsonSchema))return new Zt(e,s||null,new Fe(kt.fromString(t.referencePath)))}}Zt._jsonSchemaVersion="firestore/documentReference/1.0",Zt._jsonSchema={type:un("string",Zt._jsonSchemaVersion),referencePath:un("string")};class ji extends Do{constructor(e,t,s){super(e,t,op(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Zt(this.firestore,null,new Fe(e))}withConverter(e){return new ji(this.firestore,e,this._path)}}function An(n,e,...t){if(n=gn(n),d0("collection","path",e),n instanceof ad){const s=kt.fromString(e,...t);return By(s),new ji(n,null,s)}{if(!(n instanceof Zt||n instanceof ji))throw new Ie(ie.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(kt.fromString(e,...t));return By(s),new ji(n.firestore,null,s)}}function Ot(n,e,...t){if(n=gn(n),arguments.length===1&&(e=tp.newId()),d0("doc","path",e),n instanceof ad){const s=kt.fromString(e,...t);return zy(s),new Zt(n,null,new Fe(s))}{if(!(n instanceof Zt||n instanceof ji))throw new Ie(ie.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(kt.fromString(e,...t));return zy(s),new Zt(n.firestore,n instanceof ji?n.converter:null,new Fe(s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Av="AsyncQueue";class Nv{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new nw(this,"async_queue_retry"),this.oc=()=>{const s=Xh();s&&Pe(Av,"Visibility state changed to "+s.visibilityState),this.F_.y_()},this._c=e;const t=Xh();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const t=Xh();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise((()=>{}));const t=new Ys;return this.uc((()=>this.Xu&&this.rc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Zu.push(e),this.cc())))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!ko(e))throw e;Pe(Av,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_((()=>this.cc()))}}uc(e){const t=this._c.then((()=>(this.nc=!0,e().catch((s=>{throw this.tc=s,this.nc=!1,ei("INTERNAL UNHANDLED ERROR: ",kv(s)),s})).then((s=>(this.nc=!1,s))))));return this._c=t,t}enqueueAfterDelay(e,t,s){this.ac(),this.sc.indexOf(e)>-1&&(t=0);const a=xp.createAndSchedule(this,e,t,s,(l=>this.lc(l)));return this.ec.push(a),a}ac(){this.tc&&He(47125,{hc:kv(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(const t of this.ec)if(t.timerId===e)return!0;return!1}Ic(e){return this.Pc().then((()=>{this.ec.sort(((t,s)=>t.targetTimeMs-s.targetTimeMs));for(const t of this.ec)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Pc()}))}dc(e){this.sc.push(e)}lc(e){const t=this.ec.indexOf(e);this.ec.splice(t,1)}}function kv(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class Ca extends ad{constructor(e,t,s,a){super(e,t,s,a),this.type="firestore",this._queue=new Nv,this._persistenceKey=(a==null?void 0:a.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Nv(e),this._firestoreClient=void 0,await e}}}function Zb(n,e){const t=typeof n=="object"?n:y_(),s=typeof n=="string"?n:ku,a=Bf(t,"firestore").getImmediate({identifier:s});if(!a._initialized){const l=hT("firestore");l&&Xb(a,...l)}return a}function Cp(n){if(n._terminated)throw new Ie(ie.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||eR(n),n._firestoreClient}function eR(n){var e,t,s;const a=n._freezeSettings(),l=(function(f,m,v,w){return new SC(f,m,v,w.host,w.ssl,w.experimentalForceLongPolling,w.experimentalAutoDetectLongPolling,Sw(w.experimentalLongPollingOptions),w.useFetchStreams,w.isUsingEmulator)})(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,a);n._componentsProvider||!((t=a.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((s=a.localCache)===null||s===void 0)&&s._onlineComponentProvider)&&(n._componentsProvider={_offline:a.localCache._offlineComponentProvider,_online:a.localCache._onlineComponentProvider}),n._firestoreClient=new Gb(n._authCredentials,n._appCheckCredentials,n._queue,l,n._componentsProvider&&(function(f){const m=f==null?void 0:f._online.build();return{_offline:f==null?void 0:f._offline.build(m),_online:m}})(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Vr(kn.fromBase64String(e))}catch(t){throw new Ie(ie.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Vr(kn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Vr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Gl(e,Vr._jsonSchema))return Vr.fromBase64String(e.bytes)}}Vr._jsonSchemaVersion="firestore/bytes/1.0",Vr._jsonSchema={type:un("string",Vr._jsonSchemaVersion),bytes:un("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class od{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ie(ie.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Nn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ld{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ps{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ie(ie.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ie(ie.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return st(this._lat,e._lat)||st(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ps._jsonSchemaVersion}}static fromJSON(e){if(Gl(e,Ps._jsonSchema))return new Ps(e.latitude,e.longitude)}}Ps._jsonSchemaVersion="firestore/geoPoint/1.0",Ps._jsonSchema={type:un("string",Ps._jsonSchemaVersion),latitude:un("number"),longitude:un("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bs{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(s,a){if(s.length!==a.length)return!1;for(let l=0;l<s.length;++l)if(s[l]!==a[l])return!1;return!0})(this._values,e._values)}toJSON(){return{type:bs._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Gl(e,bs._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new bs(e.vectorValues);throw new Ie(ie.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}bs._jsonSchemaVersion="firestore/vectorValue/1.0",bs._jsonSchema={type:un("string",bs._jsonSchemaVersion),vectorValues:un("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tR=/^__.*__$/;class nR{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return this.fieldMask!==null?new Hi(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ql(e,this.data,t,this.fieldTransforms)}}class Cw{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return new Hi(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Pw(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw He(40011,{Ec:n})}}class Pp{constructor(e,t,s,a,l,d){this.settings=e,this.databaseId=t,this.serializer=s,this.ignoreUndefinedProperties=a,l===void 0&&this.Ac(),this.fieldTransforms=l||[],this.fieldMask=d||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new Pp(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var t;const s=(t=this.path)===null||t===void 0?void 0:t.child(e),a=this.Rc({path:s,mc:!1});return a.fc(e),a}gc(e){var t;const s=(t=this.path)===null||t===void 0?void 0:t.child(e),a=this.Rc({path:s,mc:!1});return a.Ac(),a}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return zu(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(Pw(this.Ec)&&tR.test(e))throw this.wc('Document fields cannot begin and end with "__"')}}class rR{constructor(e,t,s){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=s||rd(e)}Dc(e,t,s,a=!1){return new Pp({Ec:e,methodName:t,bc:s,path:Nn.emptyPath(),mc:!1,Sc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function cd(n){const e=n._freezeSettings(),t=rd(n._databaseId);return new rR(n._databaseId,!!e.ignoreUndefinedProperties,t)}function bw(n,e,t,s,a,l={}){const d=n.Dc(l.merge||l.mergeFields?2:0,e,t,a);Rp("Data must be an object, but it was:",d,s);const f=Rw(s,d);let m,v;if(l.merge)m=new xr(d.fieldMask),v=d.fieldTransforms;else if(l.mergeFields){const w=[];for(const E of l.mergeFields){const C=jf(e,E,t);if(!d.contains(C))throw new Ie(ie.INVALID_ARGUMENT,`Field '${C}' is specified in your field mask but missing from your input data.`);Nw(w,C)||w.push(C)}m=new xr(w),v=d.fieldTransforms.filter((E=>m.covers(E.field)))}else m=null,v=d.fieldTransforms;return new nR(new dr(f),m,v)}class ud extends ld{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof ud}}class bp extends ld{_toFieldTransform(e){return new YC(e.path,new Ol)}isEqual(e){return e instanceof bp}}function sR(n,e,t,s){const a=n.Dc(1,e,t);Rp("Data must be an object, but it was:",a,s);const l=[],d=dr.empty();qi(s,((m,v)=>{const w=Ap(e,m,t);v=gn(v);const E=a.gc(w);if(v instanceof ud)l.push(w);else{const C=Zl(v,E);C!=null&&(l.push(w),d.set(w,C))}}));const f=new xr(l);return new Cw(d,f,a.fieldTransforms)}function iR(n,e,t,s,a,l){const d=n.Dc(1,e,t),f=[jf(e,s,t)],m=[a];if(l.length%2!=0)throw new Ie(ie.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let C=0;C<l.length;C+=2)f.push(jf(e,l[C])),m.push(l[C+1]);const v=[],w=dr.empty();for(let C=f.length-1;C>=0;--C)if(!Nw(v,f[C])){const $=f[C];let q=m[C];q=gn(q);const Y=d.gc($);if(q instanceof ud)v.push($);else{const F=Zl(q,Y);F!=null&&(v.push($),w.set($,F))}}const E=new xr(v);return new Cw(w,E,d.fieldTransforms)}function aR(n,e,t,s=!1){return Zl(t,n.Dc(s?4:3,e))}function Zl(n,e){if(Aw(n=gn(n)))return Rp("Unsupported field value:",e,n),Rw(n,e);if(n instanceof ld)return(function(s,a){if(!Pw(a.Ec))throw a.wc(`${s._methodName}() can only be used with update() and set()`);if(!a.path)throw a.wc(`${s._methodName}() is not currently supported inside arrays`);const l=s._toFieldTransform(a);l&&a.fieldTransforms.push(l)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return(function(s,a){const l=[];let d=0;for(const f of s){let m=Zl(f,a.yc(d));m==null&&(m={nullValue:"NULL_VALUE"}),l.push(m),d++}return{arrayValue:{values:l}}})(n,e)}return(function(s,a){if((s=gn(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return GC(a.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const l=Mt.fromDate(s);return{timestampValue:Ou(a.serializer,l)}}if(s instanceof Mt){const l=new Mt(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:Ou(a.serializer,l)}}if(s instanceof Ps)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof Vr)return{bytesValue:q0(a.serializer,s._byteString)};if(s instanceof Zt){const l=a.databaseId,d=s.firestore._databaseId;if(!d.isEqual(l))throw a.wc(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:hp(s.firestore._databaseId||a.databaseId,s._key.path)}}if(s instanceof bs)return(function(d,f){return{mapValue:{fields:{[w0]:{stringValue:x0},[ju]:{arrayValue:{values:d.toArray().map((v=>{if(typeof v!="number")throw f.wc("VectorValues must only contain numeric values.");return lp(f.serializer,v)}))}}}}}})(s,a);throw a.wc(`Unsupported field value: ${Ku(s)}`)})(n,e)}function Rw(n,e){const t={};return p0(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):qi(n,((s,a)=>{const l=Zl(a,e.Vc(s));l!=null&&(t[s]=l)})),{mapValue:{fields:t}}}function Aw(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Mt||n instanceof Ps||n instanceof Vr||n instanceof Zt||n instanceof ld||n instanceof bs)}function Rp(n,e,t){if(!Aw(t)||!h0(t)){const s=Ku(t);throw s==="an object"?e.wc(n+" a custom object"):e.wc(n+" "+s)}}function jf(n,e,t){if((e=gn(e))instanceof od)return e._internalPath;if(typeof e=="string")return Ap(n,e);throw zu("Field path arguments must be of type string or ",n,!1,void 0,t)}const oR=new RegExp("[~\\*/\\[\\]]");function Ap(n,e,t){if(e.search(oR)>=0)throw zu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new od(...e.split("."))._internalPath}catch{throw zu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function zu(n,e,t,s,a){const l=s&&!s.isEmpty(),d=a!==void 0;let f=`Function ${e}() called with invalid data`;t&&(f+=" (via `toFirestore()`)"),f+=". ";let m="";return(l||d)&&(m+=" (found",l&&(m+=` in field ${s}`),d&&(m+=` in document ${a}`),m+=")"),new Ie(ie.INVALID_ARGUMENT,f+n+m)}function Nw(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kw{constructor(e,t,s,a,l){this._firestore=e,this._userDataWriter=t,this._key=s,this._document=a,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new Zt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new lR(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Np("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class lR extends kw{data(){return super.data()}}function Np(n,e){return typeof e=="string"?Ap(n,e):e instanceof od?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cR(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Ie(ie.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class kp{}class uR extends kp{}function dR(n,e,...t){let s=[];e instanceof kp&&s.push(e),s=s.concat(t),(function(l){const d=l.filter((m=>m instanceof jp)).length,f=l.filter((m=>m instanceof dd)).length;if(d>1||d>0&&f>0)throw new Ie(ie.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(s);for(const a of s)n=a._apply(n);return n}class dd extends uR{constructor(e,t,s){super(),this._field=e,this._op=t,this._value=s,this.type="where"}static _create(e,t,s){return new dd(e,t,s)}_apply(e){const t=this._parse(e);return jw(e._query,t),new Do(e.firestore,e.converter,Ef(e._query,t))}_parse(e){const t=cd(e.firestore);return(function(l,d,f,m,v,w,E){let C;if(v.isKeyField()){if(w==="array-contains"||w==="array-contains-any")throw new Ie(ie.INVALID_ARGUMENT,`Invalid Query. You can't perform '${w}' queries on documentId().`);if(w==="in"||w==="not-in"){Dv(E,w);const q=[];for(const Y of E)q.push(jv(m,l,Y));C={arrayValue:{values:q}}}else C=jv(m,l,E)}else w!=="in"&&w!=="not-in"&&w!=="array-contains-any"||Dv(E,w),C=aR(f,d,E,w==="in"||w==="not-in");return cn.create(v,w,C)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function hR(n,e,t){const s=e,a=Np("where",n);return dd._create(a,s,t)}class jp extends kp{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new jp(e,t)}_parse(e){const t=this._queryConstraints.map((s=>s._parse(e))).filter((s=>s.getFilters().length>0));return t.length===1?t[0]:as.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(a,l){let d=a;const f=l.getFlattenedFilters();for(const m of f)jw(d,m),d=Ef(d,m)})(e._query,t),new Do(e.firestore,e.converter,Ef(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function jv(n,e,t){if(typeof(t=gn(t))=="string"){if(t==="")throw new Ie(ie.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!R0(e)&&t.indexOf("/")!==-1)throw new Ie(ie.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const s=e.path.child(kt.fromString(t));if(!Fe.isDocumentKey(s))throw new Ie(ie.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return Yy(n,new Fe(s))}if(t instanceof Zt)return Yy(n,t._key);throw new Ie(ie.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Ku(t)}.`)}function Dv(n,e){if(!Array.isArray(n)||n.length===0)throw new Ie(ie.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function jw(n,e){const t=(function(a,l){for(const d of a)for(const f of d.getFlattenedFilters())if(l.indexOf(f.op)>=0)return f.op;return null})(n.filters,(function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new Ie(ie.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ie(ie.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class fR{convertValue(e,t="none"){switch(Mi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Xt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Oi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw He(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const s={};return qi(e,((a,l)=>{s[a]=this.convertValue(l,t)})),s}convertVectorValue(e){var t,s,a;const l=(a=(s=(t=e.fields)===null||t===void 0?void 0:t[ju].arrayValue)===null||s===void 0?void 0:s.values)===null||a===void 0?void 0:a.map((d=>Xt(d.doubleValue)));return new bs(l)}convertGeoPoint(e){return new Ps(Xt(e.latitude),Xt(e.longitude))}convertArray(e,t){return(e.values||[]).map((s=>this.convertValue(s,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const s=Ju(e);return s==null?null:this.convertValue(s,t);case"estimate":return this.convertTimestamp(Dl(e));default:return null}}convertTimestamp(e){const t=Li(e);return new Mt(t.seconds,t.nanos)}convertDocumentKey(e,t){const s=kt.fromString(e);Tt(J0(s),9688,{name:e});const a=new Vl(s.get(1),s.get(3)),l=new Fe(s.popFirst(5));return a.isEqual(t)||ei(`Document ${l} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dw(n,e,t){let s;return s=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,s}class xl{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ga extends kw{constructor(e,t,s,a,l,d){super(e,t,s,a,d),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new wu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const s=this._document.data.field(Np("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ie(ie.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=ga._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}ga._jsonSchemaVersion="firestore/documentSnapshot/1.0",ga._jsonSchema={type:un("string",ga._jsonSchemaVersion),bundleSource:un("string","DocumentSnapshot"),bundleName:un("string"),bundle:un("string")};class wu extends ga{data(e={}){return super.data(e)}}class yo{constructor(e,t,s,a){this._firestore=e,this._userDataWriter=t,this._snapshot=a,this.metadata=new xl(a.hasPendingWrites,a.fromCache),this.query=s}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((s=>{e.call(t,new wu(this._firestore,this._userDataWriter,s.key,s,new xl(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ie(ie.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(a,l){if(a._snapshot.oldDocs.isEmpty()){let d=0;return a._snapshot.docChanges.map((f=>{const m=new wu(a._firestore,a._userDataWriter,f.doc.key,f.doc,new xl(a._snapshot.mutatedKeys.has(f.doc.key),a._snapshot.fromCache),a.query.converter);return f.doc,{type:"added",doc:m,oldIndex:-1,newIndex:d++}}))}{let d=a._snapshot.oldDocs;return a._snapshot.docChanges.filter((f=>l||f.type!==3)).map((f=>{const m=new wu(a._firestore,a._userDataWriter,f.doc.key,f.doc,new xl(a._snapshot.mutatedKeys.has(f.doc.key),a._snapshot.fromCache),a.query.converter);let v=-1,w=-1;return f.type!==0&&(v=d.indexOf(f.doc.key),d=d.delete(f.doc.key)),f.type!==1&&(d=d.add(f.doc),w=d.indexOf(f.doc.key)),{type:pR(f.type),doc:m,oldIndex:v,newIndex:w}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ie(ie.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=yo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=tp.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],s=[],a=[];return this.docs.forEach((l=>{l._document!==null&&(t.push(l._document),s.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),a.push(l.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function pR(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return He(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dp(n){n=is(n,Zt);const e=is(n.firestore,Ca);return Yb(Cp(e),n._key).then((t=>mR(e,n,t)))}yo._jsonSchemaVersion="firestore/querySnapshot/1.0",yo._jsonSchema={type:un("string",yo._jsonSchemaVersion),bundleSource:un("string","QuerySnapshot"),bundleName:un("string"),bundle:un("string")};class Vw extends fR{constructor(e){super(),this.firestore=e}convertBytes(e){return new Vr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Zt(this.firestore,null,t)}}function xs(n){n=is(n,Do);const e=is(n.firestore,Ca),t=Cp(e),s=new Vw(e);return cR(n._query),Jb(t,n._query).then((a=>new yo(e,s,n,a)))}function ma(n,e,t){n=is(n,Zt);const s=is(n.firestore,Ca),a=Dw(n.converter,e,t);return hd(s,[bw(cd(s),"setDoc",n._key,a,n.converter!==null,t).toMutation(n._key,Lr.none())])}function Ts(n,e,t,...s){n=is(n,Zt);const a=is(n.firestore,Ca),l=cd(a);let d;return d=typeof(e=gn(e))=="string"||e instanceof od?iR(l,"updateDoc",n._key,e,t,s):sR(l,"updateDoc",n._key,e),hd(a,[d.toMutation(n._key,Lr.exists(!0))])}function ha(n){return hd(is(n.firestore,Ca),[new cp(n._key,Lr.none())])}function Ei(n,e){const t=is(n.firestore,Ca),s=Ot(n),a=Dw(n.converter,e);return hd(t,[bw(cd(n.firestore),"addDoc",s._key,a,n.converter!==null,{}).toMutation(s._key,Lr.exists(!1))]).then((()=>s))}function hd(n,e){return(function(s,a){const l=new Ys;return s.asyncQueue.enqueueAndForget((async()=>Mb(await Qb(s),a,l))),l.promise})(Cp(n),e)}function mR(n,e,t){const s=t.docs.get(e._key),a=new Vw(n);return new ga(n,a,e._key,s,new xl(t.hasPendingWrites,t.fromCache),e.converter)}function Lw(){return new bp("serverTimestamp")}(function(e,t=!0){(function(a){Ao=a})(bo),vo(new va("firestore",((s,{instanceIdentifier:a,options:l})=>{const d=s.getProvider("app").getImmediate(),f=new Ca(new aC(s.getProvider("auth-internal")),new cC(d,s.getProvider("app-check-internal")),(function(v,w){if(!Object.prototype.hasOwnProperty.apply(v.options,["projectId"]))throw new Ie(ie.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Vl(v.options.projectId,w)})(d,a),d);return l=Object.assign({useFetchStreams:t},l),f._setSettings(l),f}),"PUBLIC").setMultipleInstances(!0)),Ni(Ly,Oy,e),Ni(Ly,Oy,"esm2017")})();const gR={apiKey:"AIzaSyCOOnlmEcAcJywsS93LLfLSywy9ENqnppM",authDomain:"tyler-manga-library.firebaseapp.com",projectId:"tyler-manga-library",storageBucket:"tyler-manga-library.firebasestorage.app",messagingSenderId:"307412068362",appId:"1:307412068362:web:6cfe5666187439dfa757f3"},Ow=g_(gR),Js=nC(Ow),nt=Zb(Ow),Mw=j.createContext(null);function yR({children:n}){const[e,t]=j.useState(null),[s,a]=j.useState(!1),[l,d]=j.useState("viewer"),[f,m]=j.useState(!0),v=async C=>{if(!C)return null;const $=Ot(nt,"users",C.uid);let q=null;try{const F=await Dp($);F.exists()&&(q=F.data())}catch(F){console.warn("Failed to read user doc",F)}const Y={role:((q==null?void 0:q.role)||"viewer").toLowerCase()==="admin"?"admin":"viewer",email:C.email||(q==null?void 0:q.email)||"",displayName:C.displayName||(q==null?void 0:q.displayName)||"",createdAt:(q==null?void 0:q.createdAt)||Lw()};try{await ma($,Y,{merge:!0})}catch(F){console.error("Failed to ensure user doc",F)}return{...q,...Y}};j.useEffect(()=>{const C=H1(Js,async $=>{if(t($),$)try{const q=await v($),Y=(q==null?void 0:q.role)||"viewer";d(Y),a(Y.toLowerCase()==="admin")}catch(q){console.error("Error checking role:",q),a(!1),d("viewer")}else a(!1),d("viewer");m(!1)});return()=>C()},[]);const w=async(C,$)=>{await B_(Js,C,$)},E=async()=>{await $_(Js)};return c.jsx(Mw.Provider,{value:{user:e,admin:s,role:l,loading:f,login:w,logout:E},children:n})}function Vo(){return j.useContext(Mw)}function vR({onClose:n}){const[e,t]=j.useState("login"),[s,a]=j.useState(""),[l,d]=j.useState("");async function f(){try{await e0(Js,new Es),n()}catch(w){alert(w.message)}}async function m(w){w.preventDefault();try{await B_(Js,s,l),n()}catch(E){alert(E.message)}}async function v(w){w.preventDefault();try{await z1(Js,s,l),n()}catch(E){alert(E.message)}}return c.jsx("div",{className:"auth-modal-backdrop",onClick:n,children:c.jsxs("div",{className:"auth-modal",onClick:w=>w.stopPropagation(),children:[c.jsx("h2",{className:"auth-title",children:e==="login"?"Sign In":"Create Account"}),c.jsxs("button",{className:"google-btn",onClick:f,children:[c.jsx("img",{src:"https://www.svgrepo.com/show/475656/google-color.svg",alt:"",className:"google-icon"}),"Continue with Google"]}),c.jsx("div",{className:"auth-divider",children:c.jsx("span",{children:"or"})}),c.jsxs("form",{onSubmit:e==="login"?m:v,className:"auth-form",children:[c.jsx("input",{type:"email",placeholder:"Email address",className:"auth-input",value:s,onChange:w=>a(w.target.value),required:!0}),c.jsx("input",{type:"password",placeholder:"Password",className:"auth-input",value:l,onChange:w=>d(w.target.value),required:!0}),c.jsx("button",{className:"auth-submit",children:e==="login"?"Sign In":"Create Account"})]}),c.jsx("div",{className:"auth-switcher",children:e==="login"?c.jsxs("p",{children:["No account?"," ",c.jsx("button",{onClick:()=>t("register"),children:"Register"})]}):c.jsxs("p",{children:["Already have an account?"," ",c.jsx("button",{onClick:()=>t("login"),children:"Sign in"})]})}),c.jsx("button",{className:"auth-close",onClick:n,children:"Close"})]})})}function _R(){var R,k,L,M,D,S;const[n,e]=j.useState(!1),[t,s]=j.useState(!1),[a,l]=j.useState(!1),[d,f]=j.useState(!1),[m,v]=j.useState(""),[w,E]=j.useState(""),[C,$]=j.useState(!1),[q,Y]=j.useState(!1),F=j.useRef(null),{user:X,admin:ge,role:re}=Vo(),le=$u();j.useEffect(()=>{var ce;l(!1),f(!1),E(""),Y(!1),v((X==null?void 0:X.displayName)||((ce=X==null?void 0:X.email)==null?void 0:ce.split("@")[0])||"")},[X]);async function xe(){try{await $_(Js),e(!1),l(!1),le("/")}catch(ce){console.error(ce),alert("Logout failed.")}}const Se=()=>{if(!X){e(!1),s(!0);return}l(!1),E(""),Y(!1),f(!0)},N=async()=>{if(!X){e(!1),s(!0);return}const ce=(m||"").trim();if(!ce){E("Display name is required.");return}$(!0),E(""),Y(!1);try{await $1(Js.currentUser,{displayName:ce}),await ma(Ot(nt,"users",X.uid),{displayName:ce},{merge:!0}),E("Profile updated."),Y(!1)}catch(me){console.error("Failed to update profile",me),E("Failed to update profile.")}finally{$(!1)}};return c.jsxs(c.Fragment,{children:[c.jsxs("button",{className:`menu-toggle ${n?"active":""}`,onClick:()=>e(!n),children:[c.jsx("span",{}),c.jsx("span",{}),c.jsx("span",{})]}),c.jsxs("nav",{className:`menu-panel ${n?"open":""}`,onMouseLeave:()=>l(!1),children:[c.jsx(ua,{to:"/",className:"menu-item",onClick:()=>e(!1),children:"Home"}),c.jsx(ua,{to:"/manga",className:"menu-item",onClick:()=>e(!1),children:"Manga"}),c.jsx(ua,{to:"/anime",className:"menu-item",onClick:()=>e(!1),children:"Anime"}),c.jsx(ua,{to:"/tcg",className:"menu-item",onClick:()=>e(!1),children:"TCG"}),c.jsx(ua,{to:"/music",className:"menu-item",onClick:()=>e(!1),children:"Music"}),c.jsx(ua,{to:"/steam",className:"menu-item",onClick:()=>e(!1),children:"Gaming"}),ge&&c.jsx(ua,{to:"/dashboard",className:"menu-item",onClick:()=>e(!1),children:"Dashboard"}),c.jsxs("div",{className:"menu-footer",children:[c.jsx("div",{className:"profile-divider"}),c.jsxs("div",{className:"profile-card",onMouseEnter:()=>X&&l(!0),onMouseLeave:()=>l(!1),onClick:()=>{X?l(ce=>!ce):(l(!1),e(!1),s(!0))},role:"button",tabIndex:0,onKeyDown:ce=>{(ce.key==="Enter"||ce.key===" ")&&(ce.preventDefault(),X?l(me=>!me):(e(!1),s(!0)))},children:[c.jsx("div",{className:"profile-avatar",children:X?(((R=X.displayName)==null?void 0:R[0])||((k=X.email)==null?void 0:k[0])||((L=X.uid)==null?void 0:L[0])||"?").toUpperCase():"?"}),c.jsxs("div",{className:"profile-meta",children:[c.jsx("div",{className:"profile-name",children:(X==null?void 0:X.displayName)||(X==null?void 0:X.email)||"Guest"}),c.jsx("div",{className:"profile-role",children:X?ge?"admin":re||"viewer":"Not signed in"})]}),X&&a&&c.jsxs("div",{className:"profile-menu",children:[c.jsx("button",{type:"button",className:"profile-menu-item",onClick:Se,children:"Edit profile"}),c.jsx("button",{type:"button",className:"profile-menu-item",onClick:xe,children:"Sign out"})]})]})]})]}),t&&c.jsx(vR,{onClose:()=>s(!1)}),d&&c.jsx("div",{className:"profile-edit-backdrop",children:c.jsxs("div",{className:"profile-edit-card",children:[c.jsxs("div",{className:"profile-edit-header",children:[c.jsx("h3",{children:"Edit profile"}),c.jsx("button",{type:"button",className:"profile-edit-close",onClick:()=>{f(!1),E(""),Y(!1)},children:""})]}),c.jsxs("div",{className:"profile-edit-body",children:[c.jsx("div",{className:"profile-edit-avatar",children:X?(((M=X.displayName)==null?void 0:M[0])||((D=X.email)==null?void 0:D[0])||((S=X.uid)==null?void 0:S[0])||"?").toUpperCase():"?"}),c.jsxs("div",{className:"profile-edit-field",children:[c.jsx("label",{className:"profile-edit-label",htmlFor:"displayName",children:"Display name"}),c.jsxs("div",{className:"profile-edit-input-row",children:[c.jsx("input",{id:"displayName",className:"profile-edit-input",type:"text",readOnly:!q,value:m,onChange:ce=>v(ce.target.value),maxLength:40,placeholder:"Enter display name",ref:F,onBlur:()=>{q&&N()},onKeyDown:ce=>{ce.key==="Enter"&&q&&(ce.preventDefault(),N())}}),c.jsx("button",{type:"button",className:"profile-edit-pencil",onClick:()=>{Y(!0),E(""),setTimeout(()=>{var ce;return(ce=F.current)==null?void 0:ce.focus()},50)},"aria-label":"Edit display name",children:""})]}),c.jsx("div",{className:"profile-edit-hint",children:"Click the pencil to edit. Changes save on blur or Enter."})]})]}),w&&c.jsx("div",{className:"profile-edit-status",children:w}),C&&c.jsx("div",{className:"profile-edit-status saving",children:"Saving..."})]})})]})}function Vv(){const n="Tyler's Collection's and Hobbies",e="",[t,s]=j.useState(""),[a,l]=j.useState(!0),d=j.useRef(null),[f,m]=j.useState("jp"),[v,w]=j.useState(1);return j.useEffect(()=>{document.title="Tyler's Collection"},[]),j.useEffect(()=>(d.current=setInterval(()=>l(E=>!E),450),()=>{d.current&&clearInterval(d.current)}),[]),j.useEffect(()=>{let E=!1;const C=Y=>new Promise(F=>setTimeout(F,Y)),$=async(Y,F=120)=>{for(let X=1;X<=Y.length;X+=1){if(E)return;s(Y.slice(0,X)),await C(F)}},q=async(Y,F=70)=>{for(let X=Y.length;X>=0;X-=1){if(E)return;s(Y.slice(0,X)),await C(F)}};return(async()=>{if(localStorage.getItem("homeTitleTyped")==="1"){m("en"),s(n),l(!1),d.current&&clearInterval(d.current);return}await C(250),m("jp"),await $(e,140),await C(6e3),await q(e,80),await C(320);const F=n;for(let X=1;X<=F.length;X+=1){if(E)return;s(F.slice(0,X)),X===4&&m("en"),await C(110)}m("en"),await C(2e3),l(!1),localStorage.setItem("homeTitleTyped","1"),d.current&&clearInterval(d.current)})(),()=>{E=!0}},[]),c.jsxs("main",{className:"page",children:[c.jsxs("header",{style:{textAlign:"center",marginTop:"32px",marginBottom:"24px"},children:[c.jsxs("h1",{style:{margin:0,fontSize:"2.2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",display:"inline-flex",alignItems:"center",gap:"6px"},children:[c.jsx("span",{children:t||" "}),c.jsx("span",{style:{width:"6px",height:"1.1em",background:"#ffb6c1",opacity:a?1:0,transition:"opacity 0.15s ease"}})]}),c.jsx("p",{style:{margin:"6px 0 0",color:"var(--text-soft)",fontSize:"0.95rem",opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"TCG":"This is my personal webpage to see what is on my shelves, wishlists, and TCG collections."}),c.jsx("div",{style:{display:"inline-flex",alignItems:"center",gap:"10px",padding:"8px 14px",borderRadius:"999px",border:"1px solid rgba(255,182,193,0.5)",background:"linear-gradient(135deg, rgba(255,182,193,0.18), rgba(43,15,29,0.9))",boxShadow:"0 8px 24px rgba(0,0,0,0.55)",marginTop:"14px",fontSize:"0.78rem",color:"#ffe6ed",letterSpacing:"0.05em",textTransform:"uppercase",fontWeight:700,opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?c.jsxs(c.Fragment,{children:[c.jsx("span",{role:"img","aria-label":"manga",children:""})," ",c.jsx("span",{style:{color:"rgba(255,182,193,0.6)"},children:""}),c.jsx("span",{role:"img","aria-label":"anime",children:""})," ",c.jsx("span",{style:{color:"rgba(255,182,193,0.6)"},children:""}),c.jsx("span",{role:"img","aria-label":"tcg",children:""})," TCG"]}):c.jsxs(c.Fragment,{children:[c.jsx("span",{role:"img","aria-label":"manga",children:""})," Manga",c.jsx("span",{style:{color:"rgba(255,182,193,0.6)"},children:""}),c.jsx("span",{role:"img","aria-label":"anime",children:""})," Anime",c.jsx("span",{style:{color:"rgba(255,182,193,0.6)"},children:""}),c.jsx("span",{role:"img","aria-label":"tcg",children:""})," TCG"]})})]}),c.jsxs("section",{style:{display:"grid",gridTemplateColumns:"minmax(0, 2fr) minmax(0, 3fr)",gap:"20px",marginTop:"24px"},children:[c.jsxs("article",{className:"card",children:[c.jsx("h2",{style:{marginTop:0,marginBottom:"8px",fontSize:"1.2rem",color:"#ffb6c1"},children:c.jsx("span",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"About Me"})}),c.jsx("p",{style:{margin:0,color:"var(--text-soft)",fontSize:"0.9rem",lineHeight:1.5,opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"im.okTCG":"Hey, I am Tyler and I go by im.ok. I hoard manga, binge anime, and collect trading cards."}),c.jsx("p",{style:{marginTop:"10px",color:"var(--text-soft)",fontSize:"0.9rem",opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"TCG":"This site is where I track everything: volumes on my shelves, finished shows, and my TCG collection as they all slowly grow."}),c.jsxs("div",{style:{marginTop:"12px",display:"flex",flexWrap:"wrap",gap:"6px",opacity:v,transition:"opacity 0.25s ease"},children:[c.jsx("span",{className:"pill",children:f==="jp"?"":"Manga library"}),c.jsx("span",{className:"pill",children:f==="jp"?"":"My Anime List (MAL)"}),c.jsx("span",{className:"pill",children:f==="jp"?" & TCG":"Pokemon & One Piece TCG"}),c.jsx("span",{className:"pill",children:f==="jp"?"":"Data Nerd"})]})]}),c.jsxs("article",{className:"card",children:[c.jsx("h2",{style:{marginTop:0,marginBottom:"8px",fontSize:"1.2rem",color:"#ffb6c1"},children:c.jsx("span",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Explore these pages"})}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(210px, 1fr))",gap:"14px",marginTop:"10px"},children:[c.jsxs("a",{href:"/base/manga",className:"section-card",children:[c.jsx("h3",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Manga Library"}),c.jsx("p",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Full manga collection & wishlist."}),c.jsx("div",{className:"section-chip-row",children:c.jsx("span",{className:"section-chip accent",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Library & wishlist"})})]}),c.jsxs("a",{href:"/base/music",className:"section-card",style:{justifySelf:"end",alignSelf:"end",order:99},children:[c.jsx("h3",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Music"}),c.jsx("p",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"If you are here for my music, this is the page for you! Catch all the latest releases."}),c.jsxs("div",{className:"section-chip-row",children:[c.jsx("span",{className:"section-chip accent",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Latest tracks"}),c.jsx("span",{className:"section-chip",style:{opacity:v,transition:"opacity 0.25s ease"},children:"Spotify & SoundCloud"})]})]}),c.jsxs("a",{href:"/base/anime",className:"section-card",children:[c.jsx("h3",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Anime Library"}),c.jsx("p",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"MAL":"The entire watched, plan to watch, and watching list synced directly from MyAnimeList."}),c.jsxs("div",{className:"section-chip-row",children:[c.jsx("span",{className:"section-chip accent",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"MAL":"MAL synced"}),c.jsx("span",{className:"section-chip",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Status filters"}),c.jsx("span",{className:"section-chip",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Quick stats"})]})]}),c.jsxs("a",{href:"/base/tcg",className:"section-card",children:[c.jsx("h3",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"TCG":"TCG Collection"}),c.jsx("p",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"TCG":"Pokemon & One Piece TCG cards tracked with quantities, prices, and value."}),c.jsxs("div",{className:"section-chip-row",children:[c.jsx("span",{className:"section-chip accent",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Full Collection"}),c.jsx("span",{className:"section-chip",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Still Under-Construction"})]})]})]})]})]}),c.jsx("footer",{style:{marginTop:"28px",fontSize:"0.78rem",color:"var(--text-soft)",textAlign:"center"},children:"@ 2025 im.ok. All rights reserved."})]})}const wR="modulepreload",xR=function(n){return"/base/"+n},Lv={},ec=function(e,t,s){let a=Promise.resolve();if(t&&t.length>0){let d=function(v){return Promise.all(v.map(w=>Promise.resolve(w).then(E=>({status:"fulfilled",value:E}),E=>({status:"rejected",reason:E}))))};document.getElementsByTagName("link");const f=document.querySelector("meta[property=csp-nonce]"),m=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));a=d(t.map(v=>{if(v=xR(v),v in Lv)return;Lv[v]=!0;const w=v.endsWith(".css"),E=w?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${v}"]${E}`))return;const C=document.createElement("link");if(C.rel=w?"stylesheet":wR,w||(C.as="script"),C.crossOrigin="",C.href=v,m&&C.setAttribute("nonce",m),document.head.appendChild(C),w)return new Promise(($,q)=>{C.addEventListener("load",$),C.addEventListener("error",()=>q(new Error(`Unable to preload CSS for ${v}`)))})}))}function l(d){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=d,window.dispatchEvent(f),!f.defaultPrevented)throw d}return a.then(d=>{for(const f of d||[])f.status==="rejected"&&l(f.reason);return e().catch(l)})};function Fw({open:n,title:e,placeholder:t,value:s,status:a,loading:l,onChange:d,onSubmit:f,onClose:m}){if(!n)return null;const v=typeof a=="string"&&a.toLowerCase().startsWith("sent!")?"#a3f0cf":"#ffb6c1";return c.jsx("div",{className:"suggestion-backdrop",onClick:w=>{w.target===w.currentTarget&&m&&m()},children:c.jsxs("div",{className:"suggestion-modal",children:[c.jsxs("div",{className:"suggestion-modal-header",children:[c.jsx("h3",{children:e}),c.jsx("button",{className:"suggestion-close",type:"button",onClick:m,children:"Close"})]}),c.jsx("p",{className:"suggestion-hint",children:"Tell me what to add next. Titles only is fine, but extra notes are welcome."}),c.jsx("textarea",{className:"suggestion-textarea",placeholder:t,value:s,onChange:w=>d==null?void 0:d(w.target.value),maxLength:500}),a&&c.jsx("div",{className:"suggestion-status",style:{color:v},children:a}),c.jsxs("div",{className:"suggestion-actions",children:[c.jsx("button",{className:"suggestion-send",type:"button",onClick:f,disabled:l,children:l?"Sending...":"Send Suggestion"}),c.jsx("button",{className:"suggestion-cancel",type:"button",onClick:m,children:"Cancel"})]})]})})}const Ov=5,ER=3600*1e3,Mv="mangaSuggestionsSent";function ts(n){let e=(n||"").trim();const t=e.match(/^(.*?)(?:,?\s*(?:Vol\.|Volume)\s*(\d+)(?:\s*[--]\s*\d+)?\s*)?(?:\s*\([^)]*\))?$/i),s=t?t[1].trim().toLowerCase():e.toLowerCase(),a=t&&t[2]?parseInt(t[2],10):0;return{name:s,vol:Number.isFinite(a)?a:0}}function TR(){const{admin:n,user:e,role:t}=Vo(),s=n,[a,l]=j.useState("library");j.useEffect(()=>{document.title="Manga | Library"},[]),j.useEffect(()=>{Qe("")},[e]);const d=async()=>{const P=Date.now(),oe=(()=>{try{const B=localStorage.getItem(Mv);return Array.isArray(JSON.parse(B))?JSON.parse(B):[]}catch{return[]}})().filter(B=>P-B<ER);if(oe.length>=Ov){Qe("Rate limit: please wait a bit (max 5 suggestions per hour).");return}if(!Ae.trim()){Qe("Please enter a manga title or note before sending.");return}bt(!0),Qe("");try{const B=`**Manga Suggestion**
${Ae.trim()}
From: ${(e==null?void 0:e.displayName)||(e==null?void 0:e.email)||(e==null?void 0:e.uid)||"anonymous user"}`;await Ei(An(nt,"suggestions"),{content:Ae.trim(),type:"manga",from:(e==null?void 0:e.displayName)||(e==null?void 0:e.email)||(e==null?void 0:e.uid)||"anonymous user",createdAt:new Date().toISOString()}),Qe("Sent! I'll review your suggestion soon."),Ue("");const K=[...oe,P].slice(-Ov);localStorage.setItem(Mv,JSON.stringify(K))}catch(B){console.error("Failed to send suggestion",B),Qe("Failed to send suggestion. Please try again later.")}finally{bt(!1)}},[f,m]=j.useState([]),[v,w]=j.useState([]),[E,C]=j.useState([]),[$,q]=j.useState([]),[Y,F]=j.useState(!1),[X,ge]=j.useState(!0),[re,le]=j.useState(""),[xe,Se]=j.useState(""),[N,R]=j.useState(""),[k,L]=j.useState(!1),[M,D]=j.useState(()=>new Set),[S,ce]=j.useState(null),[me,dt]=j.useState({open:!1,mode:"add",list:"library",data:{title:"",authors:"",publisher:"",demographic:"",genre:"",subGenre:"",date:"",cover:"",isbn:"",pageCount:"",rating:"",amountPaid:"",dateRead:"",datePurchased:"",msrp:"",special:!1,specialType:"",specialVolumes:"",collectiblePrice:"",amazonURL:"",read:!1},editingId:null,multiAdd:!1,startVol:"",endVol:""}),[We,V]=j.useState([]),[ne,se]=j.useState(0),[b,J]=j.useState({open:!1,index:0,items:[]}),[ye,je]=j.useState(!1),[Ae,Ue]=j.useState(""),[Ze,Qe]=j.useState(""),[ut,bt]=j.useState(!1),ue=!!e&&t==="viewer";async function Ve(){const P=await xs(An(nt,"library")),Z=[];P.forEach(oe=>{const B=oe.data();Z.push({id:oe.id,title:B.title||"",authors:B.authors||"Unknown",publisher:B.publisher||"Unknown",demographic:B.demographic||"",genre:B.genre||"",subGenre:B.subGenre||"",date:B.date||"Unknown",cover:B.cover||"",isbn:B.isbn||"",pageCount:B.pageCount!==void 0&&B.pageCount!==null?B.pageCount:"",rating:B.rating!==void 0&&B.rating!==null?B.rating:"",amountPaid:B.amountPaid!==void 0&&B.amountPaid!==null?B.amountPaid:"",dateRead:B.dateRead||"",datePurchased:B.datePurchased||"",msrp:B.msrp!==void 0&&B.msrp!==null?B.msrp:"",specialType:B.specialType||"",specialVolumes:B.specialVolumes!==void 0&&B.specialVolumes!==null?B.specialVolumes:"",collectiblePrice:B.collectiblePrice!==void 0&&B.collectiblePrice!==null?B.collectiblePrice:"",read:!!B.read,amazonURL:B.amazonURL||"",hidden:!!B.hidden,kind:"library"})}),Z.sort((oe,B)=>{const K=ts(oe.title),Ne=ts(B.title),Le=K.name.localeCompare(Ne.name);return Le!==0?Le:K.vol-Ne.vol}),m(Z),C(oe=>{const B=new Set(oe);return Z.forEach(K=>B.add(K.title||"")),Array.from(B).filter(Boolean).sort()})}async function $e(){const P=await xs(An(nt,"wishlist")),Z=[];P.forEach(oe=>{const B=oe.data();Z.push({id:oe.id,title:B.title||"",authors:B.authors||"Unknown",publisher:B.publisher||"Unknown",date:B.date||"Unknown",cover:B.cover||"",isbn:B.isbn||"",pageCount:B.pageCount!==void 0&&B.pageCount!==null?B.pageCount:"",rating:B.rating!==void 0&&B.rating!==null?B.rating:"",amountPaid:B.amountPaid!==void 0&&B.amountPaid!==null?B.amountPaid:"",specialType:B.specialType||"",specialVolumes:B.specialVolumes!==void 0&&B.specialVolumes!==null?B.specialVolumes:"",collectiblePrice:B.collectiblePrice!==void 0&&B.collectiblePrice!==null?B.collectiblePrice:"",amazonURL:B.amazonURL||"",hidden:!!B.hidden,kind:"wishlist"})}),Z.sort((oe,B)=>{const K=ts(oe.title),Ne=ts(B.title),Le=K.name.localeCompare(Ne.name);return Le!==0?Le:K.vol-Ne.vol}),w(Z),C(oe=>{const B=new Set(oe);return Z.forEach(K=>B.add(K.title||"")),Array.from(B).filter(Boolean).sort()})}j.useEffect(()=>{let P=!1;const Z=async()=>{if(!P)try{const K=await fetch("/base/manga-library-wishlist.json",{cache:"no-cache"});if(!K.ok)throw new Error("fallback fetch failed");const Ne=await K.json(),Le=Array.isArray(Ne.library)?Ne.library:[],Pt=Array.isArray(Ne.wishlist)?Ne.wishlist:[];m(Le.map((we,Ke)=>({id:we.id||`offline-lib-${Ke}`,title:we.title||"",authors:we.authors||"Unknown",publisher:we.publisher||"Unknown",demographic:we.demographic||"",genre:we.genre||"",subGenre:we.subGenre||"",date:we.date||"Unknown",cover:we.cover||"",isbn:we.isbn||"",pageCount:we.pageCount??"",rating:we.rating??"",amountPaid:we.amountPaid??"",dateRead:we.dateRead||"",datePurchased:we.datePurchased||"",msrp:we.msrp??"",specialType:we.specialType||"",specialVolumes:we.specialVolumes??"",collectiblePrice:we.collectiblePrice??"",amazonURL:we.amazonURL||"",read:!!we.read,hidden:!!we.hidden,kind:"library"}))),w(Pt.map((we,Ke)=>({id:we.id||`offline-wish-${Ke}`,title:we.title||"",authors:we.authors||"Unknown",publisher:we.publisher||"Unknown",demographic:we.demographic||"",genre:we.genre||"",subGenre:we.subGenre||"",date:we.date||"Unknown",cover:we.cover||"",isbn:we.isbn||"",pageCount:we.pageCount??"",rating:we.rating??"",amountPaid:we.amountPaid??"",dateRead:we.dateRead||"",datePurchased:we.datePurchased||"",msrp:we.msrp??"",specialType:we.specialType||"",specialVolumes:we.specialVolumes??"",collectiblePrice:we.collectiblePrice??"",amazonURL:we.amazonURL||"",read:!!we.read,hidden:!!we.hidden,kind:"wishlist"}))),le("")}catch(B){console.error("Offline fallback failed",B),le("Failed to load manga data from Firestore.")}finally{P||ge(!1)}};async function oe(){ge(!0),le("");try{await Promise.all([Ve(),$e()]),P||ge(!1)}catch(B){console.error(B),P||(console.warn("Falling back to offline JSON for manga."),await Z())}}return oe(),()=>{P=!0}},[e]);const Me=j.useMemo(()=>{const P=xe.trim().toLowerCase();return P?f.filter(Z=>[Z.title,Z.authors,Z.publisher,Z.isbn,Z.date,String(Z.pageCount??"")].join(" ").toLowerCase().includes(P)):f},[f,xe]),xt=j.useMemo(()=>s&&Y?Me:Me.filter(P=>!P.hidden),[Me,s,Y]),It=j.useMemo(()=>{const P=N.trim().toLowerCase();return P?v.filter(Z=>[Z.title,Z.authors,Z.publisher,Z.isbn,Z.date,String(Z.pageCount??"")].join(" ").toLowerCase().includes(P)):v},[v,N]),jt=j.useMemo(()=>s&&Y?It:It.filter(P=>!P.hidden),[It,s,Y]);function Qt(){s&&(L(P=>!P),D(new Set))}function Gt(P){D(Z=>{const oe=new Set(Z);return oe.has(P)?oe.delete(P):oe.add(P),oe})}async function tn(P){if(!s){alert("Multi-select actions require admin access.");return}const Z=Array.from(M);if(!Z.length){alert("Select at least one item first.");return}const oe=a==="library";try{if(P==="move")if(oe){if(!window.confirm(`Move ${Z.length} item(s) to Wishlist?`))return;for(const B of Z){const K=f.find(Le=>Le.id===B);if(!K)continue;const Ne={title:K.title,authors:K.authors,publisher:K.publisher,date:K.date,pageCount:K.pageCount||"",cover:K.cover,amazonURL:K.amazonURL||"",hidden:!!K.hidden};await Ei(An(nt,"wishlist"),Ne),await ha(Ot(nt,"library",B))}}else{if(!window.confirm(`Move ${Z.length} item(s) to Library?`))return;for(const B of Z){const K=v.find(Le=>Le.id===B);if(!K)continue;const Ne={title:K.title,authors:K.authors,publisher:K.publisher,date:K.date,pageCount:K.pageCount||"",cover:K.cover,amountPaid:"",read:!1,rating:"",msrp:"",collectiblePrice:"",specialType:"",specialVolumes:"",isbn:"",demographic:"",genre:"",subGenre:"",hidden:!!K.hidden};await Ei(An(nt,"library"),Ne),await ha(Ot(nt,"wishlist",B))}}else if(P==="markRead"&&oe)for(const B of Z)await Ts(Ot(nt,"library",B),{read:!0,dateRead:new Date().toISOString().slice(0,10)});else if(P==="markUnread"&&oe)for(const B of Z)await Ts(Ot(nt,"library",B),{read:!1,dateRead:"",rating:""});else if(P==="delete"){const B=oe?"library":"wishlist";if(!window.confirm(`Delete ${Z.length} item(s) from ${oe?"Library":"Wishlist"}?`))return;for(const K of Z)await ha(Ot(nt,B,K))}await Promise.all([Ve(),$e()]),D(new Set),L(!1)}catch(B){console.error(B),alert("Failed to apply multi-select action.")}}function Bt(P){ce(P)}function jn(){ce(null)}const Rt=()=>{dt(P=>({...P,open:!1,mode:"add",editingId:null,data:{title:"",authors:"",publisher:"",demographic:"",genre:"",subGenre:"",date:"",cover:"",isbn:"",pageCount:"",rating:"",amountPaid:"",dateRead:"",datePurchased:"",msrp:"",special:!1,specialType:"",specialVolumes:"",collectiblePrice:"",amazonURL:"",read:!1,hidden:!1},multiAdd:!1,startVol:"",endVol:""})),V([]),se(0)},nn=j.useMemo(()=>{const P=new Map;return[...f,...v].forEach(Z=>{const oe=ts(Z.title||"");if(!oe.name)return;const B=(Z.title||"").replace(/,?\s*Vol\.?\s*\d+.*/i,"").trim()||Z.title||oe.name;if(!P.has(oe.name))P.set(oe.name,{display:B,maxVol:oe.vol,authors:Z.authors||"",publisher:Z.publisher||"",demographic:Z.demographic||""});else{const K=P.get(oe.name);K.maxVol=Math.max(K.maxVol,oe.vol),!K.authors&&Z.authors&&(K.authors=Z.authors),!K.publisher&&Z.publisher&&(K.publisher=Z.publisher),!K.demographic&&Z.demographic&&(K.demographic=Z.demographic)}}),P},[f,v]),En=P=>{dt(Z=>({...Z,open:!0,mode:"add",list:P,editingId:null,data:{...Z.data,title:"",list:P}})),V([{kind:"new",id:null,data:{title:"",authors:"",publisher:"",demographic:"",genre:"",subGenre:"",date:"",cover:"",isbn:"",pageCount:"",rating:"",amountPaid:"",dateRead:"",datePurchased:"",msrp:"",specialType:"",specialVolumes:"",collectiblePrice:"",amazonURL:"",read:!1}}]),se(0)},At=P=>{const Z={open:!0,mode:"edit",list:P.kind==="wishlist"?"wishlist":"library",editingId:P.id,data:{title:P.title||"",authors:P.authors||"",publisher:P.publisher||"",demographic:P.demographic||"",genre:P.genre||"",subGenre:P.subGenre||"",date:P.date||"",cover:P.cover||"",isbn:P.isbn||"",pageCount:P.pageCount||"",rating:P.rating||"",amountPaid:P.amountPaid||"",dateRead:P.dateRead||"",datePurchased:P.datePurchased||"",msrp:P.msrp||"",special:!!(P.specialType||P.specialVolumes||P.collectiblePrice),specialType:P.specialType||"",specialVolumes:P.specialVolumes||"",collectiblePrice:P.collectiblePrice||"",amazonURL:P.amazonURL||"",read:!!P.read,hidden:!!P.hidden}};dt(Z),V([{kind:"edit",id:P.id,data:{...Z.data}}]),se(0)},Ye=(P,Z,oe="text")=>{if(dt(B=>{const K={...B.data,[P]:oe==="checkbox"?!!Z:Z};if(P==="special"&&!Z&&(K.specialType="",K.specialVolumes="",K.collectiblePrice=""),P==="specialType"&&(Z==="collectible"?K.specialVolumes="":(Z==="specialEdition"||(K.specialVolumes=""),K.collectiblePrice="")),P==="title"){const Ne=ts(Z||"");if(Ne.name&&nn.has(Ne.name)){const Le=nn.get(Ne.name);K.authors=Le.authors||K.authors,K.publisher=Le.publisher||K.publisher,K.demographic=Le.demographic||K.demographic}}return{...B,data:K}}),V(B=>{if(!B.length)return B;const K=[...B],Ne={...K[ne]};return Ne.data={...Ne.data,[P]:oe==="checkbox"?!!Z:Z},K[ne]=Ne,K}),P==="title"){const B=String(Z||"").trim().toLowerCase();if(!B)q([]);else{const K=[];nn.forEach(Ne=>{if(Ne.display.toLowerCase().includes(B)){const Le=Ne.maxVol>0?Ne.maxVol+1:1;K.push(`${Ne.display}, Vol. ${Le}`)}}),q(K.slice(0,6))}}},Xn=P=>{We[P]&&(se(P),dt(Z=>{const oe=We[P];return{...Z,data:{...oe.data}}}))},As=()=>{const P=me.data.title||"",Z=ts(P);if(!Z.name){alert("Provide a title with a volume number first (e.g., Series, Vol. 1).");return}const oe=P.replace(/,?\s*Vol\.?\s*\d+.*/i,"").trim()||P;let B=Z.vol||0;const K=nn.get(Z.name);K&&K.maxVol>B&&(B=K.maxVol),We.forEach(we=>{const Ke=ts(we.data.title||"");Ke.name===Z.name&&(B=Math.max(B,Ke.vol||0))});const Ne=(B||0)+1,Pt={title:`${oe}, Vol. ${Ne}`,authors:me.data.authors,publisher:me.data.publisher,demographic:me.data.demographic,genre:me.data.genre,subGenre:me.data.subGenre,msrp:me.data.msrp,hidden:me.data.hidden,cover:"",isbn:"",pageCount:"",rating:"",amountPaid:"",date:"",dateRead:"",datePurchased:"",special:!1,specialType:"",specialVolumes:"",collectiblePrice:"",amazonURL:"",read:!1};V(we=>{const Ke=[...we,{kind:"new",id:null,data:Pt}];return se(Ke.length-1),Ke}),dt(we=>({...we,mode:"add",data:Pt}))};async function qn(){if(!s)return;const{list:P}=me,Z=P||"library",oe=We.length>0?We:[{kind:me.mode,id:me.editingId,data:me.data}],B=K=>({title:(K.title||"").trim(),authors:(K.authors||"").trim(),publisher:(K.publisher||"").trim(),demographic:(K.demographic||"").trim(),genre:(K.genre||"").trim(),subGenre:(K.subGenre||"").trim(),date:(K.date||"").trim(),cover:(K.cover||"").trim(),isbn:Z==="wishlist"?"":(K.isbn||"").trim(),pageCount:K.pageCount===""?"":Number(K.pageCount),rating:Z==="wishlist"||K.rating===""?"":Math.max(.5,Math.min(5,Number(K.rating))),amountPaid:K.amountPaid===""?"":Number(K.amountPaid),dateRead:(K.dateRead||"").trim(),datePurchased:(K.datePurchased||"").trim(),msrp:Z==="wishlist"||K.msrp===""?"":Number(K.msrp),special:Z==="wishlist"?!1:!!(K.special&&(K.specialType||"").trim()),specialType:Z==="wishlist"||!(K.special&&(K.specialType||"").trim())?"":(K.specialType||"").trim(),specialVolumes:Z==="wishlist"?"":K.special&&K.specialType==="specialEdition"?K.specialVolumes===""?"":Number(K.specialVolumes):"",collectiblePrice:Z==="wishlist"?"":K.special&&K.specialType==="collectible"?K.collectiblePrice===""?"":Number(K.collectiblePrice):"",amazonURL:(K.amazonURL||"").trim(),read:Z==="wishlist"?!1:!!K.read,hidden:!!K.hidden,kind:P});try{const K=[];for(const Ne of oe){const Le=B(Ne.data);if(Z==="library"&&Ne.kind!=="edit"){const Pt=ts(Le.title).name,we=f.filter(ht=>ts(ht.title||ht.Title||"").name===Pt),Ke=we[0];if(Ke&&(Le.demographic=Le.demographic||Ke.demographic||Ke.Demographic||"",Le.genre=Le.genre||Ke.genre||Ke.Genre||"",Le.subGenre=Le.subGenre||Ke.subGenre||Ke.SubGenre||"",Le.msrp==="")){const ht=we.map(Tn=>Number(Tn.msrp??Tn.MSRP)).filter(Tn=>Number.isFinite(Tn));ht.length>0&&ht.every(Ln=>Ln===ht[0])&&(Le.msrp=ht[0])}}if(!Le.title){alert("Title is required for every entry.");return}Ne.kind==="edit"&&Ne.id?K.push(Ts(Ot(nt,Z,Ne.id),Le)):K.push(Ei(An(nt,Z),Le))}await Promise.all(K),await Promise.all([Ve(),$e()]),Rt()}catch(K){console.error(K),alert("Failed to save entry.")}}async function Mr(P,Z){if(s&&window.confirm("Delete this entry?"))try{await ha(Ot(nt,Z,P)),await Promise.all([Ve(),$e()])}catch(oe){console.error(oe),alert("Failed to delete entry.")}}const[Er,Fr]=j.useState(!1),Hn=()=>J({open:!1,index:0,items:[]});async function hr(P,Z){if(!(P!=null&&P.id))return;const oe=P.kind==="wishlist"?"wishlist":"library";Fr(!0);try{await Ts(Ot(nt,oe,P.id),Z),await Promise.all([Ve(),$e()]),ce(B=>B&&B.id===P.id?{...B,...Z}:B)}catch(B){console.error(B),alert("Failed to update entry.")}finally{Fr(!1)}}const Ns=(P,Z)=>{const oe=Z===""?"":Math.max(.5,Math.min(5,Number(Z)));hr(P,{rating:oe})},Zn=(P,Z)=>{if(!P)return;const oe=Z?{read:!0,dateRead:new Date().toISOString().slice(0,10)}:{read:!1,dateRead:""};hr(P,oe)},Ur=()=>{if(!M.size){alert("Select at least one entry first.");return}const Z=[...f,...v].filter(B=>M.has(B.id));if(!Z.length){alert("No items selected.");return}const oe=Z.map(B=>({id:B.id,kind:B.kind||(a==="wishlist"?"wishlist":"library"),data:{title:B.title||"",authors:B.authors||"",publisher:B.publisher||"",demographic:B.demographic||"",genre:B.genre||"",subGenre:B.subGenre||"",date:B.date||"",cover:B.cover||"",isbn:B.isbn||"",pageCount:B.pageCount||"",rating:B.rating||"",amountPaid:B.amountPaid||"",dateRead:B.dateRead||"",datePurchased:B.datePurchased||"",msrp:B.msrp||"",special:!!(B.specialType||B.specialVolumes||B.collectiblePrice),specialType:B.specialType||"",specialVolumes:B.specialVolumes||"",collectiblePrice:B.collectiblePrice||"",amazonURL:B.amazonURL||"",read:!!B.read,hidden:!!B.hidden}}));J({open:!0,index:0,items:oe})},Et=(P,Z,oe="text")=>{J(B=>{const K=[...B.items],Ne={...K[B.index]},Le={...Ne.data,[P]:oe==="checkbox"?!!Z:Z};return P==="special"&&!Z&&(Le.specialType="",Le.specialVolumes="",Le.collectiblePrice=""),P==="specialType"&&(Z==="collectible"?Le.specialVolumes="":(Z==="specialEdition"||(Le.specialVolumes=""),Le.collectiblePrice="")),Ne.data=Le,K[B.index]=Ne,{...B,items:K}})},ks=()=>{J(P=>({...P,index:Math.min(P.index+1,P.items.length-1)}))},Ft=()=>{J(P=>({...P,index:Math.max(P.index-1,0)}))};async function rn(){if(!s)return;const P=b.items;if(!P.length){Hn();return}try{const Z=P.map(oe=>{const K=!(oe.kind==="wishlist")&&!!(oe.data.special&&(oe.data.specialType||"").trim()),Ne={...oe.data,pageCount:oe.data.pageCount===""?"":Number(oe.data.pageCount),rating:oe.data.rating===""?"":Math.max(.5,Math.min(5,Number(oe.data.rating))),amountPaid:oe.data.amountPaid===""?"":Number(oe.data.amountPaid),msrp:oe.data.msrp===""?"":Number(oe.data.msrp),special:K,specialType:K?oe.data.specialType:"",collectiblePrice:K&&oe.data.specialType==="collectible"?oe.data.collectiblePrice===""?"":Number(oe.data.collectiblePrice):"",specialVolumes:K&&oe.data.specialType==="specialEdition"?oe.data.specialVolumes===""?"":Number(oe.data.specialVolumes):"",amazonURL:oe.data.amazonURL||"",read:!!oe.data.read},Le=oe.kind==="wishlist"?"wishlist":"library";return Ts(Ot(nt,Le,oe.id),Ne)});await Promise.all(Z),await Promise.all([Ve(),$e()]),D(new Set),L(!1),Hn()}catch(Z){console.error(Z),alert("Failed to save bulk edits.")}}function fr(P){const Z=M.has(P.id),oe=P.kind==="library",B=()=>{k&&s?Gt(P.id):Bt(P)};return c.jsxs("div",{className:"manga-card"+(P.read&&oe?" read":"")+(Z?" multiselect-selected":""),onClick:B,children:[c.jsx("div",{className:"manga-card-cover-wrap",children:c.jsx("img",{src:P.cover||"https://imgur.com/chUgq4W.png",alt:"Cover",loading:"lazy",decoding:"async"})}),c.jsxs("div",{className:"manga-card-body",children:[c.jsx("div",{className:"manga-card-title",children:P.title||"Untitled"}),c.jsxs("div",{className:"manga-card-meta",children:[P.authors&&P.authors!=="Unknown"&&c.jsxs(c.Fragment,{children:[P.authors,c.jsx("br",{})]}),P.publisher&&P.publisher!=="Unknown"&&c.jsxs(c.Fragment,{children:[P.publisher,c.jsx("br",{})]}),P.date&&P.date!=="Unknown"&&P.date]}),P.isbn&&c.jsxs("div",{className:"manga-card-isbn",children:["ISBN: ",P.isbn]}),s&&c.jsxs("div",{className:"manga-card-actions",children:[c.jsx("button",{type:"button",className:"manga-btn mini",onClick:K=>{K.stopPropagation(),At(P)},children:"Edit"}),c.jsx("button",{type:"button",className:"manga-btn mini danger",onClick:K=>{K.stopPropagation(),Mr(P.id,P.kind==="wishlist"?"wishlist":"library")},children:"Delete"})]})]})]},P.id)}const Dn=({value:P,onChange:Z})=>{const[oe,B]=j.useState(null),K=Math.max(0,Math.min(5,Number(P)||0)),Ne=oe??K,Le=Array.from({length:10},(Ke,ht)=>(ht+1)*.5),Pt=5,we=Array.from({length:Pt},(Ke,ht)=>Math.max(0,Math.min(1,Ne-ht)));return c.jsxs("div",{className:"star-shell",role:"group","aria-label":"Rating",children:[c.jsxs("div",{className:"star-visual",style:{"--star-count":Pt},children:[c.jsx("div",{className:"star-row",children:we.map((Ke,ht)=>c.jsxs("div",{className:"star-icon",children:[c.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",className:"star-base",children:c.jsx("path",{d:"M12 2.5l2.9 5.88 6.5.95-4.7 4.58 1.1 6.43L12 17.9l-5.8 3.44 1.1-6.43-4.7-4.58 6.5-.95L12 2.5z"})}),c.jsx("div",{className:"star-fill",style:{"--pct":`${(Math.max(0,Math.min(1,Ke))*100).toFixed(1)}%`},children:c.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:c.jsx("path",{d:"M12 2.5l2.9 5.88 6.5.95-4.7 4.58 1.1 6.43L12 17.9l-5.8 3.44 1.1-6.43-4.7-4.58 6.5-.95L12 2.5z"})})})]},ht))}),c.jsx("div",{className:"star-hit",children:Le.map(Ke=>c.jsx("button",{type:"button","aria-label":`${Ke} stars`,onMouseEnter:()=>B(Ke),onMouseLeave:()=>B(null),onClick:()=>Z(Ke)},Ke))})]}),c.jsx("div",{className:"star-value",children:Ne?Ne.toFixed(1):"--"}),c.jsx("button",{type:"button",className:"star-clear",onClick:()=>Z(""),"aria-label":"Clear rating",children:"clear"})]})},Vn=a==="library"?xt:jt,sn=(P,Z)=>{if(!P.length)return;const oe=Array.from(P.reduce((we,Ke)=>(Object.keys(Ke).forEach(ht=>we.add(ht)),we),new Set)),B=we=>{const Ke=we==null?"":String(we);return/[",\n]/.test(Ke)?`"${Ke.replace(/"/g,'""')}"`:Ke},K=[oe.join(",")].concat(P.map(we=>oe.map(Ke=>B(we[Ke])).join(","))),Ne=new Blob([K.join(`
`)],{type:"text/csv"}),Le=URL.createObjectURL(Ne),Pt=document.createElement("a");Pt.href=Le,Pt.download=Z,Pt.click(),URL.revokeObjectURL(Le)},Tr=async(P,Z)=>{const oe=(K,Ne="image")=>(K||"").toString().toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"").slice(0,100)||Ne,B=P.filter(K=>K.cover).map((K,Ne)=>({url:K.cover,name:oe(K.title||`manga-${Ne+1}`,`manga-${Ne+1}`)}));if(!B.length){alert("No images found to download.");return}try{const K=(await ec(async()=>{const{default:Ln}=await import("https://cdn.jsdelivr.net/npm/jszip@3.10.1/+esm");return{default:Ln}},[])).default,Ne=new K,Le=Ne.folder("images"),Pt={},we=B.map(async(Ln,ls)=>{try{const js=await(await fetch(Ln.url)).blob(),Ds=(Ln.url.split(".").pop()||"jpg").split(/[?#]/)[0],yt=Ln.name||`image-${ls+1}`;Pt[yt]=(Pt[yt]||0)+1;const ft=Pt[yt]>1?`-${Pt[yt]}`:"";Le.file(`${yt}${ft}.${Ds}`,js)}catch(zr){console.warn("Failed to fetch image",Ln.url,zr)}});await Promise.all(we);const Ke=await Ne.generateAsync({type:"blob"}),ht=URL.createObjectURL(Ke),Tn=document.createElement("a");Tn.href=ht,Tn.download=Z,Tn.click(),URL.revokeObjectURL(ht)}catch(K){console.error("Zip download failed",K),alert("Failed to create zip. Please try again.")}},er=(P,Z)=>{const oe=new Blob([JSON.stringify(P,null,2)],{type:"application/json"}),B=URL.createObjectURL(oe),K=document.createElement("a");K.href=B,K.download=Z,K.click(),URL.revokeObjectURL(B)},os=async P=>{if(!s||!(P!=null&&P.id))return;const Z=P.kind==="wishlist"?"wishlist":"library",oe=Z==="library"?"wishlist":"library";try{if(Z==="library"){const B={title:P.title,authors:P.authors,publisher:P.publisher,date:P.date,pageCount:P.pageCount||"",cover:P.cover||"",amazonURL:P.amazonURL||"",hidden:!!P.hidden};await Ei(An(nt,oe),B)}else{const B={title:P.title,authors:P.authors,publisher:P.publisher,date:P.date,pageCount:P.pageCount||"",cover:P.cover||"",amountPaid:"",read:!1,rating:"",msrp:"",collectiblePrice:"",specialType:"",specialVolumes:"",isbn:"",demographic:"",genre:"",subGenre:"",amazonURL:P.amazonURL||"",hidden:!!P.hidden};await Ei(An(nt,oe),B)}await ha(Ot(nt,Z,P.id)),await Promise.all([Ve(),$e()]),jn()}catch(B){console.error("Move failed",B),alert("Failed to move item.")}},_t=me.list==="wishlist",tr=b.items[b.index]||null,Ct=(tr==null?void 0:tr.kind)==="wishlist";return c.jsxs("div",{className:"manga-page",children:[c.jsxs("header",{className:"manga-header",style:{flexDirection:"column",alignItems:"center",textAlign:"center"},children:[c.jsx("div",{className:"manga-header-title",style:{justifyContent:"center",gap:"0.6rem",fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Tyler's Manga Library"}),c.jsx("div",{className:"manga-header-sub",style:{textAlign:"center"},children:"This is my Manga Library and Wishlist. Check and see all the Manga I have in my possession!"})]}),ue&&c.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"6px"},children:c.jsx("button",{className:"suggestion-trigger",type:"button",onClick:()=>{Qe(""),je(!0)},children:"+ Suggestion"})}),c.jsxs("div",{className:"manga-tabs",children:[c.jsx("button",{className:"manga-tab-btn"+(a==="library"?" active":""),onClick:()=>{l("library"),L(!1),D(new Set)},children:"Library"}),c.jsx("button",{className:"manga-tab-btn"+(a==="wishlist"?" active":""),onClick:()=>{l("wishlist"),L(!1),D(new Set)},children:"Wishlist"})]}),a!=="dashboard"&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"manga-toolbar",children:[c.jsxs("div",{className:"manga-toolbar-left",children:[c.jsx("input",{type:"text",className:"manga-search-input",placeholder:a==="library"?"Search library by title, author, ISBN...":"Search wishlist...",value:a==="library"?xe:N,onChange:P=>a==="library"?Se(P.target.value):R(P.target.value)}),c.jsx("div",{className:"manga-counter",children:a==="library"?c.jsxs(c.Fragment,{children:["Library: ",Me.length," / ",f.length]}):c.jsxs(c.Fragment,{children:["Wishlist: ",It.length," / ",v.length]})})]}),c.jsxs("div",{className:"manga-toolbar-right",children:[s&&c.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>F(P=>!P),children:Y?"Hide Hidden":"Show Hidden"}),s&&c.jsx("button",{className:"manga-btn secondary"+(k?" active":""),onClick:Qt,children:k?"Exit Multi-select":"Multi-select"})]})]}),s&&k&&c.jsxs("div",{className:"manga-multiselect-bar",children:[c.jsxs("span",{children:["Selected: ",c.jsx("strong",{children:M.size})]}),c.jsx("button",{className:"manga-btn",onClick:Ur,children:"Bulk Edit"}),c.jsxs("button",{className:"manga-btn secondary",onClick:()=>tn("move"),children:["Move to ",a==="library"?"Wishlist":"Library"]}),a==="library"&&c.jsxs(c.Fragment,{children:[c.jsx("button",{className:"manga-btn",onClick:()=>tn("markRead"),children:"Mark Read"}),c.jsx("button",{className:"manga-btn secondary",onClick:()=>tn("markUnread"),children:"Mark Unread"})]}),c.jsx("button",{className:"manga-btn danger",onClick:()=>tn("delete"),children:"Delete"})]})]}),X?c.jsx("div",{className:"manga-empty-state",children:"Loading manga from Firestore..."}):re?c.jsx("div",{className:"manga-empty-state",children:re}):Vn.length===0?c.jsx("div",{className:"manga-empty-state",children:"No manga found. Try changing your search."}):c.jsx("div",{className:"manga-grid",children:Vn.map(P=>fr(P))}),s&&c.jsxs("div",{className:"manga-floating-actions",children:[c.jsxs("button",{className:"manga-btn",type:"button","aria-label":"Add item",onClick:()=>En(a==="wishlist"?"wishlist":"library"),children:["+ ",a==="wishlist"?"Wishlist":"Library"]}),c.jsxs("div",{className:"manga-export-actions",children:[c.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>er({library:f,wishlist:v},"manga-library-wishlist.json"),children:"Export JSON"}),c.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>sn(a==="library"?f:v,a==="library"?"manga-library.csv":"manga-wishlist.csv"),children:"Export CSV"}),c.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>Tr(a==="library"?f:v,a==="library"?"manga-library-images.zip":"manga-wishlist-images.zip"),children:"Download Images"})]})]}),S&&c.jsx("div",{className:"manga-modal-backdrop visible",onClick:P=>{P.target===P.currentTarget&&jn()},children:c.jsxs("div",{className:"manga-modal",children:[c.jsx("div",{className:"manga-modal-cover-wrap",children:c.jsx("img",{src:S.cover||"https://imgur.com/chUgq4W.png",alt:"Cover"})}),c.jsxs("div",{className:"manga-modal-body",children:[c.jsxs("div",{className:"manga-modal-header",children:[c.jsx("div",{className:"manga-modal-title",children:S.title||"Untitled"}),c.jsx("button",{className:"manga-modal-close",onClick:jn,type:"button",children:"Close"})]}),c.jsxs("div",{className:"manga-modal-meta",children:[S.authors&&S.authors!=="Unknown"&&c.jsxs(c.Fragment,{children:[c.jsx("strong",{children:"Author(s):"})," ",S.authors,c.jsx("br",{})]}),S.publisher&&S.publisher!=="Unknown"&&c.jsxs(c.Fragment,{children:[c.jsx("strong",{children:"Publisher:"})," ",S.publisher,c.jsx("br",{})]}),S.date&&c.jsxs(c.Fragment,{children:[c.jsx("strong",{children:"Release:"})," ",S.date,c.jsx("br",{})]}),S.isbn&&c.jsxs(c.Fragment,{children:[c.jsx("strong",{children:"ISBN:"})," ",S.isbn,c.jsx("br",{})]})]}),c.jsxs("div",{className:"manga-modal-details",children:[S.pageCount&&c.jsxs(c.Fragment,{children:[c.jsx("strong",{children:"Pages:"})," ",S.pageCount,c.jsx("br",{})]}),c.jsxs("div",{style:{margin:"6px 0"},children:[c.jsx("strong",{children:"Rating:"})," ",c.jsx(Dn,{value:S.rating||"",onChange:P=>Ns(S,P)})]}),S.amountPaid&&c.jsxs(c.Fragment,{children:[c.jsx("strong",{children:"Amount Paid:"})," $",S.amountPaid,c.jsx("br",{})]}),S.msrp&&c.jsxs(c.Fragment,{children:[c.jsx("strong",{children:"MSRP:"})," $",S.msrp,c.jsx("br",{})]}),S.collectiblePrice&&c.jsxs(c.Fragment,{children:[c.jsx("strong",{children:"Collectible:"})," $",S.collectiblePrice,c.jsx("br",{})]}),S.read&&S.dateRead&&c.jsxs(c.Fragment,{children:[c.jsx("strong",{children:"Date Read:"})," ",S.dateRead,c.jsx("br",{})]}),S.amazonURL&&c.jsx("div",{style:{marginTop:"6px"},children:c.jsx("a",{href:S.amazonURL,target:"_blank",rel:"noreferrer",children:"View on Amazon"})})]}),c.jsxs("div",{className:"manga-modal-footer",style:{gap:"10px",alignItems:"center"},children:[c.jsx("div",{children:S.kind==="library"&&S.read?"Marked as read in your library.":S.kind==="library"?"In your library (unread).":"Wishlist item - not in library yet."}),c.jsxs("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:[S.kind==="library"&&c.jsx(c.Fragment,{children:S.read?c.jsx("button",{className:"manga-btn mini secondary",disabled:Er,onClick:()=>Zn(S,!1),type:"button",children:"Mark as unread"}):c.jsx("button",{className:"manga-btn mini",disabled:Er,onClick:()=>Zn(S,!0),type:"button",children:"Mark as read"})}),s&&c.jsxs("button",{className:"manga-btn mini",type:"button",onClick:()=>os(S),children:["Move to ",S.kind==="library"?"Wishlist":"Library"]})]})]})]})]})}),s&&me.open&&c.jsx("div",{className:"manga-modal-backdrop visible",onClick:P=>{P.target===P.currentTarget&&Rt()},children:c.jsx("div",{className:"manga-modal admin",children:c.jsxs("div",{className:"manga-modal-body",children:[c.jsxs("div",{className:"manga-modal-header",children:[c.jsx("div",{className:"manga-modal-title",children:me.mode==="add"?"Add Entry":"Edit Entry"}),c.jsx("button",{className:"manga-modal-close",onClick:Rt,type:"button",children:"Close"})]}),c.jsxs("div",{className:"admin-form-layout",children:[c.jsx("div",{className:"admin-cover-frame",children:c.jsx("img",{src:me.data.cover||"https://imgur.com/chUgq4W.png",alt:"Cover preview"})}),c.jsxs("div",{className:"admin-form-fields",children:[c.jsx("div",{className:"admin-row",children:c.jsxs("label",{children:["Title",c.jsx("input",{type:"text",value:me.data.title,onChange:P=>Ye("title",P.target.value)})]})}),$.length>0&&c.jsx("div",{className:"title-suggestions",children:$.map((P,Z)=>c.jsx("button",{type:"button",className:"manga-btn mini",onClick:()=>Ye("title",P),children:P},P+Z))}),c.jsxs("div",{className:"admin-row two",style:{alignItems:"flex-end",marginTop:"-8px"},children:[c.jsxs("div",{children:[c.jsxs("div",{className:"manga-modal-subtitle",style:{marginBottom:"6px"},children:["Entry ",ne+1," / ",Math.max(1,We.length||1)]}),c.jsxs("div",{style:{display:"flex",gap:"8px"},children:[c.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>ne>0&&Xn(ne-1),disabled:ne===0,children:"Previous"}),c.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>We.length&&ne<We.length-1?Xn(ne+1):null,disabled:!We.length||ne===We.length-1,children:"Next"})]})]}),c.jsxs("div",{style:{textAlign:"right"},children:[c.jsx("button",{className:"manga-btn",type:"button",onClick:As,disabled:!ts(me.data.title||"").vol,children:"Add New Volume"}),c.jsx("div",{className:"manga-stat-sub",style:{marginTop:"4px"},children:"Auto-fills the next volume number for this series."})]})]}),c.jsx("div",{className:"admin-row",children:c.jsxs("label",{children:["Authors",c.jsx("input",{type:"text",value:me.data.authors,onChange:P=>Ye("authors",P.target.value)})]})}),c.jsx("div",{className:"admin-row",children:c.jsxs("label",{children:["Publisher",c.jsx("input",{type:"text",value:me.data.publisher,onChange:P=>Ye("publisher",P.target.value)})]})}),c.jsxs("div",{className:"admin-row three",children:[c.jsxs("label",{children:["Release Date",c.jsx("input",{type:"date",value:me.data.date,onChange:P=>Ye("date",P.target.value)})]}),!_t&&c.jsxs(c.Fragment,{children:[c.jsxs("label",{children:["Date Purchased",c.jsx("input",{type:"date",value:me.data.datePurchased,onChange:P=>Ye("datePurchased",P.target.value)})]}),c.jsxs("label",{children:["Date Read",c.jsx("input",{type:"date",value:me.data.dateRead,onChange:P=>Ye("dateRead",P.target.value)})]})]})]}),c.jsxs("div",{className:"admin-row two",children:[c.jsxs("label",{children:["Page Count",c.jsx("input",{type:"number",placeholder:"e.g. 192",value:me.data.pageCount,onChange:P=>Ye("pageCount",P.target.value)})]}),!_t&&c.jsxs("label",{children:["ISBN (library only)",c.jsx("input",{type:"text",value:me.data.isbn,onChange:P=>Ye("isbn",P.target.value)})]})]}),c.jsx("div",{className:"admin-row",children:c.jsxs("label",{children:["Cover URL",c.jsx("input",{type:"text",placeholder:"Paste image URL here",value:me.data.cover,onChange:P=>Ye("cover",P.target.value)})]})}),!_t&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"admin-row two",children:[!(me.data.special&&me.data.specialType==="collectible")&&c.jsxs("label",{children:["Amount Paid",c.jsx("input",{type:"number",step:"0.01",value:me.data.amountPaid,onChange:P=>Ye("amountPaid",P.target.value)})]}),c.jsxs("label",{children:["MSRP",c.jsx("input",{type:"number",step:"0.01",value:me.data.msrp,onChange:P=>Ye("msrp",P.target.value)})]})]}),c.jsx("div",{className:"admin-row",children:c.jsxs("label",{className:"checkbox-row",children:[c.jsx("input",{type:"checkbox",checked:!!me.data.special,onChange:P=>Ye("special",P.target.checked,"checkbox")}),c.jsx("span",{children:"Special item?"})]})}),me.data.special&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"admin-row two",children:[c.jsxs("label",{children:["Special Type",c.jsxs("select",{value:me.data.specialType,onChange:P=>Ye("specialType",P.target.value),children:[c.jsx("option",{value:"",children:"Select type"}),c.jsx("option",{value:"specialEdition",children:"Special Edition"}),c.jsx("option",{value:"collectible",children:"Collectible"})]})]}),me.data.specialType==="collectible"&&c.jsxs("label",{children:["Collectible Price",c.jsx("input",{type:"number",step:"0.01",value:me.data.collectiblePrice,onChange:P=>Ye("collectiblePrice",P.target.value)})]})]}),me.data.specialType==="specialEdition"&&c.jsx("div",{className:"admin-row",children:c.jsxs("label",{children:["Special Volumes",c.jsx("input",{type:"number",min:"0",value:me.data.specialVolumes,onChange:P=>Ye("specialVolumes",P.target.value)})]})})]})]}),_t&&c.jsx("div",{className:"admin-row",children:c.jsxs("label",{children:["Amazon URL",c.jsx("input",{type:"text",value:me.data.amazonURL,onChange:P=>Ye("amazonURL",P.target.value)})]})}),!_t&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"admin-row",children:c.jsxs("label",{children:["Rating (1-5 stars)",c.jsx(Dn,{value:me.data.rating,onChange:P=>Ye("rating",P)})]})}),c.jsxs("div",{className:"admin-row two",children:[c.jsxs("label",{className:"checkbox-inline",children:[c.jsx("input",{type:"checkbox",checked:me.data.read,onChange:P=>Ye("read",P.target.checked,"checkbox")}),c.jsx("span",{children:"Mark as read"})]}),c.jsxs("label",{className:"checkbox-inline",children:[c.jsx("input",{type:"checkbox",checked:!!me.data.hidden,onChange:P=>Ye("hidden",P.target.checked,"checkbox")}),c.jsx("span",{children:"Hide from public"})]})]})]}),_t&&c.jsx("div",{className:"admin-row",children:c.jsxs("label",{className:"checkbox-inline",children:[c.jsx("input",{type:"checkbox",checked:!!me.data.hidden,onChange:P=>Ye("hidden",P.target.checked,"checkbox")}),c.jsx("span",{children:"Hide from public"})]})})]})]}),c.jsxs("div",{className:"manga-modal-footer",style:{justifyContent:"flex-end",gap:"10px"},children:[c.jsx("button",{className:"manga-btn secondary",onClick:Rt,type:"button",children:"Cancel"}),c.jsx("button",{className:"manga-btn",onClick:qn,type:"button",children:me.mode==="add"?"Add":"Save"})]})]})})}),s&&b.open&&c.jsx("div",{className:"manga-modal-backdrop visible",onClick:P=>{P.target===P.currentTarget&&Hn()},children:c.jsx("div",{className:"manga-modal admin",children:c.jsxs("div",{className:"manga-modal-body",children:[c.jsxs("div",{className:"manga-modal-header",children:[c.jsxs("div",{className:"manga-modal-title",children:["Bulk Edit (",b.index+1," / ",b.items.length,")"]}),c.jsx("button",{className:"manga-modal-close",onClick:Hn,type:"button",children:"Close"})]}),b.items.length>0&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"manga-modal-subtitle",children:["Editing: ",b.items[b.index].data.title||"Untitled"]}),c.jsxs("div",{className:"admin-form-grid",children:[c.jsxs("label",{children:["Title",c.jsx("input",{type:"text",value:b.items[b.index].data.title,onChange:P=>Et("title",P.target.value)})]}),c.jsxs("label",{children:["Authors",c.jsx("input",{type:"text",value:b.items[b.index].data.authors,onChange:P=>Et("authors",P.target.value)})]}),c.jsxs("label",{children:["Publisher",c.jsx("input",{type:"text",value:b.items[b.index].data.publisher,onChange:P=>Et("publisher",P.target.value)})]}),c.jsxs("label",{children:["Release Date",c.jsx("input",{type:"date",value:b.items[b.index].data.date,onChange:P=>Et("date",P.target.value)})]}),!Ct&&c.jsxs("label",{children:["ISBN",c.jsx("input",{type:"text",value:b.items[b.index].data.isbn,onChange:P=>Et("isbn",P.target.value)})]}),c.jsxs("label",{children:["Cover URL",c.jsx("input",{type:"text",value:b.items[b.index].data.cover,onChange:P=>Et("cover",P.target.value)})]}),c.jsxs("label",{children:["Page Count",c.jsx("input",{type:"number",value:b.items[b.index].data.pageCount,onChange:P=>Et("pageCount",P.target.value)})]}),!Ct&&c.jsxs(c.Fragment,{children:[c.jsxs("label",{children:["Rating (1-5 stars)",c.jsx(Dn,{value:b.items[b.index].data.rating,onChange:P=>Et("rating",P)})]}),!(b.items[b.index].data.special&&b.items[b.index].data.specialType==="collectible")&&c.jsxs("label",{children:["Amount Paid",c.jsx("input",{type:"number",step:"0.01",value:b.items[b.index].data.amountPaid,onChange:P=>Et("amountPaid",P.target.value)})]}),!(b.items[b.index].data.special&&b.items[b.index].data.specialType==="collectible")&&c.jsxs("label",{children:["Amount Paid",c.jsx("input",{type:"number",step:"0.01",value:b.items[b.index].data.amountPaid,onChange:P=>Et("amountPaid",P.target.value)})]}),c.jsxs("label",{children:["MSRP",c.jsx("input",{type:"number",step:"0.01",value:b.items[b.index].data.msrp,onChange:P=>Et("msrp",P.target.value)})]}),b.items[b.index].data.special&&b.items[b.index].data.specialType==="collectible"&&c.jsxs("label",{children:["Collectible Price",c.jsx("input",{type:"number",step:"0.01",value:b.items[b.index].data.collectiblePrice,onChange:P=>Et("collectiblePrice",P.target.value)})]})]}),!Ct&&c.jsxs(c.Fragment,{children:[c.jsxs("label",{children:["Date Purchased",c.jsx("input",{type:"date",value:b.items[b.index].data.datePurchased,onChange:P=>Et("datePurchased",P.target.value)})]}),c.jsxs("label",{children:["Date Read",c.jsx("input",{type:"date",value:b.items[b.index].data.dateRead,onChange:P=>Et("dateRead",P.target.value)})]})]}),!Ct&&c.jsxs(c.Fragment,{children:[c.jsxs("label",{className:"checkbox-row",children:[c.jsx("input",{type:"checkbox",checked:!!b.items[b.index].data.special,onChange:P=>Et("special",P.target.checked,"checkbox")}),c.jsx("span",{children:"Special item?"})]}),b.items[b.index].data.special&&c.jsxs(c.Fragment,{children:[c.jsxs("label",{children:["Special Type",c.jsxs("select",{value:b.items[b.index].data.specialType,onChange:P=>Et("specialType",P.target.value),children:[c.jsx("option",{value:"",children:"Select type"}),c.jsx("option",{value:"specialEdition",children:"Special Edition"}),c.jsx("option",{value:"collectible",children:"Collectible"})]})]}),b.items[b.index].data.specialType==="specialEdition"&&c.jsxs("label",{children:["Special Volumes",c.jsx("input",{type:"number",value:b.items[b.index].data.specialVolumes,onChange:P=>Et("specialVolumes",P.target.value)})]}),b.items[b.index].data.specialType==="collectible"&&c.jsxs("label",{children:["Collectible Price",c.jsx("input",{type:"number",step:"0.01",value:b.items[b.index].data.collectiblePrice,onChange:P=>Et("collectiblePrice",P.target.value)})]})]})]}),Ct&&c.jsxs("label",{children:["Amazon URL",c.jsx("input",{type:"text",value:b.items[b.index].data.amazonURL,onChange:P=>Et("amazonURL",P.target.value)})]}),!Ct&&c.jsxs("label",{className:"checkbox-row",children:[c.jsx("input",{type:"checkbox",checked:b.items[b.index].data.read,onChange:P=>Et("read",P.target.checked,"checkbox")}),c.jsx("span",{children:"Marked as read"})]}),c.jsxs("label",{className:"checkbox-row",children:[c.jsx("input",{type:"checkbox",checked:!!b.items[b.index].data.hidden,onChange:P=>Et("hidden",P.target.checked,"checkbox")}),c.jsx("span",{children:"Hidden from public"})]})]}),c.jsxs("div",{className:"manga-modal-footer",style:{justifyContent:"space-between",gap:"10px"},children:[c.jsxs("div",{children:[c.jsx("button",{className:"manga-btn secondary",onClick:Ft,type:"button",disabled:b.index===0,children:"Previous"}),c.jsx("button",{className:"manga-btn secondary",onClick:ks,type:"button",disabled:b.index===b.items.length-1,style:{marginLeft:"6px"},children:"Next"})]}),c.jsxs("div",{style:{display:"flex",gap:"8px"},children:[c.jsx("button",{className:"manga-btn secondary",onClick:Hn,type:"button",children:"Cancel"}),c.jsx("button",{className:"manga-btn",onClick:rn,type:"button",children:"Save Edits"})]})]})]})]})})}),ue&&c.jsx(Fw,{open:ye,title:"Suggest a Manga",placeholder:"Type a manga you'd like me to collect/read...",value:Ae,status:Ze,loading:ut,onChange:Ue,onSubmit:d,onClose:()=>je(!1)}),c.jsx("datalist",{id:"adminTitleSuggestions",children:E.map(P=>c.jsx("option",{value:P},P))})]})}const SR="https://imokmalworker.imokissick.workers.dev/?url=",Uw="im_ok",Fv=300,IR={1:"watching",2:"completed",3:"on_hold",4:"dropped",6:"plan_to_watch"};function CR(n){const e=n==null?void 0:n.title_localized,t=typeof e=="string"?e:(e==null?void 0:e.en)||(e==null?void 0:e.english);return(n==null?void 0:n.anime_title_eng)||(n==null?void 0:n.title_english)||t||(n==null?void 0:n.anime_title)||(n==null?void 0:n.title)||"Untitled"}function PR(n){const e=(n==null?void 0:n.updated_at)??(n==null?void 0:n.updatedAt)??(n==null?void 0:n.updated_at_ms)??null;if(e==null)return null;const t=Number(e);if(Number.isFinite(t))return t<1e12?t*1e3:t;const s=Date.parse(e);return Number.isNaN(s)?null:s}function bR(n){const e=IR[n.status]||(typeof n.status=="string"?n.status.toLowerCase():"unknown");return{id:n.anime_id||n.id,title:CR(n),updatedAt:PR(n),episodes:n.anime_num_episodes??n.episodes??null,watchedEpisodes:n.num_watched_episodes??n.my_watched_episodes??n.watched_episodes??n.num_watched??0,status:e,score:n.score??null,image:n.anime_image_path||n.image_url||n.anime_img||n.picture||null,synopsis:n.anime_synopsis||n.synopsis||null}}function Uv(){const n=Date.now();return[{id:1,title:"Cowboy Bebop",episodes:26,status:"completed",score:10,updatedAt:n-1e3*60*60*24*3,synopsis:"In 2071, bounty hunters Spike and Jet roam the solar system looking for their next payout and a place to belong."},{id:2,title:"Fullmetal Alchemist: Brotherhood",episodes:64,status:"completed",score:10,updatedAt:n-1e3*60*60*24*6,synopsis:"Brothers Edward and Alphonse Elric search for the Philosopher's Stone to restore their bodies after a failed alchemy ritual."},{id:3,title:"Frieren: Beyond Journey's End",episodes:28,status:"watching",score:9,updatedAt:n-1e3*60*60*8,synopsis:"An elven mage retraces the steps of a past adventure to understand humanity and the passage of time."},{id:4,title:"One Piece",episodes:1e3,status:"on_hold",score:8,updatedAt:n-1e3*60*60*24*14,synopsis:"Monkey D. Luffy sails toward the Grand Line seeking the One Piece and a crew to make his dream real."},{id:5,title:"Kaiju No. 8",episodes:12,status:"plan_to_watch",score:null,updatedAt:n-1e3*60*30,synopsis:"A middle-aged worker gains kaiju powers and joins the Defense Force to fight monsters from the inside."}]}async function RR(n,e){const t=`https://myanimelist.net/animelist/${n}/load.json?status=7&offset=${e}`,s=await fetch(`${SR}${encodeURIComponent(t)}`);if(!s.ok)throw new Error(`Failed to fetch MAL list (offset ${e})`);return s.json()}async function AR(n=Uw){const e=[];try{let t=0;for(;;){const s=await RR(n,t);if(!Array.isArray(s)||s.length===0||(e.push(...s),s.length<Fv))break;t+=Fv}}catch(t){return console.error("Failed to load MAL list; falling back to sample data.",t),Uv()}return e.length?e.map(bR):Uv()}async function NR(n){var e,t;if(!n)return null;try{const s=await fetch(`https://api.jikan.moe/v4/anime/${n}`);if(!s.ok)throw new Error(`Failed to fetch Jikan summary for id ${n}`);const a=await s.json();return((e=a==null?void 0:a.data)==null?void 0:e.synopsis)||((t=a==null?void 0:a.data)==null?void 0:t.background)||null}catch(s){return console.error("Failed to load anime synopsis",n,s),null}}async function kR(n=Uw){var e;if(!n)return null;try{const t=await fetch(`https://api.jikan.moe/v4/users/${encodeURIComponent(n)}/statistics`);if(!t.ok)throw new Error(`Failed to fetch user stats for ${n}`);const s=await t.json(),a=((e=s==null?void 0:s.data)==null?void 0:e.anime)||{},l=Number(a.days_watched),d=Number(a.total_episodes??a.episodes_watched);return{daysWatched:Number.isFinite(l)?l:null,episodesWatched:Number.isFinite(d)?d:null}}catch(t){return console.error("Failed to load user stats",n,t),null}}const zv=5,jR=3600*1e3,Bv="animeSuggestionsSent";function DR(){const{admin:n,user:e,role:t}=Vo(),s=ue=>ue?ue.toString().replace(/_/g," ").replace(/\b\w/g,Ve=>Ve.toUpperCase()):"Unknown",[a,l]=j.useState([]),[d,f]=j.useState([]),[m,v]=j.useState(""),[w,E]=j.useState("all"),[C,$]=j.useState(!0),[q,Y]=j.useState(""),[F,X]=j.useState(null),[ge,re]=j.useState({}),[le,xe]=j.useState(!1),[Se,N]=j.useState(!1),[R,k]=j.useState(null),[L,M]=j.useState(!1),[D,S]=j.useState(""),[ce,me]=j.useState(""),[dt,We]=j.useState(!1);j.useEffect(()=>{document.title="Anime | Library"},[]),j.useEffect(()=>{me("")},[e]);const V=ue=>{if(!ue)return"";const Ve=Date.now()-ue,$e=Math.max(Ve,0),Me=Math.floor($e/6e4);if(Me<1)return"just now";if(Me<60)return`${Me}m ago`;const xt=Math.floor(Me/60);if(xt<48)return`${xt}h ago`;const It=Math.floor(xt/24);if(It<14)return`${It}d ago`;const jt=Math.floor(It/7);return jt<8?`${jt}w ago`:`${Math.floor(It/30)}mo ago`},ne=(ue,Ve="image")=>(ue||"").toString().toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"").slice(0,80)||Ve,se=async()=>{const ue=a.filter(Ve=>Ve.image).map((Ve,$e)=>({url:Ve.image,name:ne(Ve.title||`anime-${$e+1}`,`anime-${$e+1}`)}));if(!ue.length){alert("No images found to download.");return}try{const Ve=(await ec(async()=>{const{default:Gt}=await import("https://cdn.jsdelivr.net/npm/jszip@3.10.1/+esm");return{default:Gt}},[])).default,$e=new Ve,Me=$e.folder("images"),xt={};await Promise.all(ue.map(async(Gt,tn)=>{try{const jn=await(await fetch(Gt.url)).blob(),Rt=(Gt.url.split(".").pop()||"jpg").split(/[?#]/)[0],nn=Gt.name||`image-${tn+1}`;xt[nn]=(xt[nn]||0)+1;const En=xt[nn]>1?`-${xt[nn]}`:"";Me.file(`${nn}${En}.${Rt}`,jn)}catch(Bt){console.warn("Failed to fetch image",Gt.url,Bt)}}));const It=await $e.generateAsync({type:"blob"}),jt=URL.createObjectURL(It),Qt=document.createElement("a");Qt.href=jt,Qt.download="anime-images.zip",Qt.click(),URL.revokeObjectURL(jt)}catch(Ve){console.error("Zip download failed",Ve),alert("Failed to create zip. Please try again.")}};j.useEffect(()=>{async function ue(){try{const Ve=await AR();l(Ve),f(Ve)}catch(Ve){console.error(Ve),Y("Failed to load data from MAL.")}finally{$(!1)}}ue()},[]),j.useEffect(()=>{kR().then(ue=>{ue&&k(ue)}).catch(()=>{})},[]);const b=ue=>{switch((ue||"unknown").toLowerCase()){case"watching":return 0;case"completed":return 1;case"on_hold":return 2;case"plan_to_watch":return 3;case"dropped":return 4;default:return 5}},J=ue=>{const Ve=Number.isFinite(Number(ue.watchedEpisodes))?Number(ue.watchedEpisodes):0,$e=Number.isFinite(Number(ue.episodes))?Number(ue.episodes):null;return $e?`${Math.min(Ve,$e)}/${$e} eps`:Ve?`${Ve} eps`:"No progress"};j.useEffect(()=>{let ue=[...a];if(w!=="all"&&(ue=ue.filter(Ve=>(Ve.status||"").toLowerCase()===w)),m){const Ve=m.toLowerCase();ue=ue.filter($e=>($e.title||"").toLowerCase().includes(Ve))}ue.sort((Ve,$e)=>{const Me=b(Ve.status),xt=b($e.status);return Me!==xt?Me-xt:(Ve.title||"").localeCompare($e.title||"")}),f(ue)},[a,w,m]);const ye=j.useMemo(()=>[...a].filter(ue=>Number.isFinite(ue.updatedAt)).sort((ue,Ve)=>Ve.updatedAt-ue.updatedAt).slice(0,6),[a]),je=!!e&&t==="viewer",Ae=async()=>{const ue=Date.now(),$e=(()=>{try{const Me=localStorage.getItem(Bv);return Array.isArray(JSON.parse(Me))?JSON.parse(Me):[]}catch{return[]}})().filter(Me=>ue-Me<jR);if($e.length>=zv){me("Rate limit: please wait a bit (max 5 suggestions per hour).");return}if(!D.trim()){me("Please enter a title or note before sending.");return}We(!0),me("");try{const Me=`**Anime Suggestion**
${D.trim()}
From: ${(e==null?void 0:e.displayName)||(e==null?void 0:e.email)||(e==null?void 0:e.uid)||"anonymous user"}`;await Ei(An(nt,"suggestions"),{content:D.trim(),type:"anime",from:(e==null?void 0:e.displayName)||(e==null?void 0:e.email)||(e==null?void 0:e.uid)||"anonymous user",createdAt:new Date().toISOString()}),me("Sent! I'll review your suggestion soon."),S("");const xt=[...$e,ue].slice(-zv);localStorage.setItem(Bv,JSON.stringify(xt))}catch(Me){console.error("Failed to send suggestion",Me),me("Failed to send suggestion. Please try again later.")}finally{We(!1)}};j.useEffect(()=>{if(!F){N(!1),xe(!1);return}N(!!F.synopsis),xe(!1)},[F==null?void 0:F.id]);const Ue=j.useMemo(()=>{const ue=a.length,Ve=a.reduce((jt,Qt)=>{const Gt=Number(Qt.watchedEpisodes);return Number.isFinite(Gt)?jt+Gt:jt},0),$e=Ve*.4,Me=a.filter(jt=>Number.isFinite(jt.score)&&jt.score>0),xt=Me.reduce((jt,Qt)=>jt+Qt.score,0),It={watching:0,completed:0,on_hold:0,dropped:0,plan_to_watch:0,unknown:0};return a.forEach(jt=>{const Qt=(jt.status||"unknown").toLowerCase();It[Qt]!=null?It[Qt]+=1:It.unknown+=1}),{total:ue,totalWatchedEpisodes:Ve,byStatus:It,avgScore:Me.length?xt/Me.length:0,totalHours:$e}},[a]),Ze=(R==null?void 0:R.daysWatched)??(Ue.totalHours||0)/24,Qe=(R==null?void 0:R.episodesWatched)??Ue.totalWatchedEpisodes,ut=ue=>{const Ve=ue.image||"https://imgur.com/chUgq4W.png",$e=Number.isFinite(Number(ue.watchedEpisodes))?Number(ue.watchedEpisodes):0,Me=Number.isFinite(Number(ue.episodes))?Number(ue.episodes):null,xt=Me?`Episode ${Math.min($e,Me)}/${Me}`:`Episode ${$e}`,It=Number.isFinite(Number(ue.score))&&Number(ue.score)>0?ue.score:"Not rated";return c.jsxs("article",{className:"anime-card",onClick:()=>X(ue.synopsis?ue:{...ue,synopsis:ge[ue.id]}),children:[c.jsxs("div",{className:"anime-cover-wrap",children:[c.jsx("img",{className:"anime-cover",src:Ve,alt:ue.title,loading:"lazy",decoding:"async"}),c.jsx("div",{className:`badge-status ${(ue.status||"unknown").toLowerCase()}`,children:s(ue.status)}),ue.score!=null&&c.jsx("div",{className:"badge-score",children:It})]}),c.jsxs("div",{className:"anime-meta",children:[c.jsx("div",{className:"anime-title",title:ue.title,children:ue.title}),c.jsx("div",{className:"anime-sub",children:ue.episodes?`${ue.episodes} episodes`:"Episodes: ?"}),c.jsx("div",{className:"anime-progress",children:xt}),c.jsxs("div",{className:"anime-progress",children:["Status: ",s(ue.status)]})]})]},ue.id||ue.title)},bt=ue=>c.jsxs("article",{className:"anime-update-card",children:[c.jsx("div",{className:"anime-update-title",title:ue.title,children:ue.title}),c.jsxs("div",{className:"anime-update-meta",children:[c.jsx("span",{className:"anime-update-progress",children:J(ue)}),c.jsx("span",{className:"anime-update-dot","aria-hidden":"true",children:""}),c.jsx("span",{className:"anime-update-status",children:s(ue.status)})]}),c.jsx("div",{className:"anime-update-time",children:V(ue.updatedAt)})]},`update-${ue.id||ue.title}`);return c.jsxs("main",{className:"anime-page",children:[c.jsxs("div",{className:"anime-content",children:[c.jsxs("header",{className:"anime-header",style:{position:"relative",display:"flex",justifyContent:"center",alignItems:"center",textAlign:"center",width:"100%"},children:[c.jsxs("div",{style:{textAlign:"center",margin:"0 auto",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"0 60px"},children:[c.jsx("h1",{className:"anime-title",style:{margin:0,fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Tyler's Anime Library"}),c.jsx("p",{className:"anime-sub",style:{textAlign:"center",margin:"6px 0 0"},children:"The Anime I've watched/watching synced directly from MAL (MyAnimeList)"})]}),(je||n)&&c.jsxs("div",{style:{position:"absolute",right:0,top:"50%",transform:"translateY(-50%)",display:"flex",gap:"10px"},children:[je&&c.jsx("button",{className:"suggestion-trigger",type:"button",onClick:()=>{me(""),M(!0)},children:"+ Suggestion"}),n&&c.jsx("button",{className:"stat-link",type:"button",onClick:se,children:"Download Images"})]})]}),c.jsxs("div",{className:"anime-stats",children:[c.jsxs("div",{className:"anime-stat-card",children:[c.jsx("div",{className:"anime-stat-label",children:"Total Entries"}),c.jsx("div",{className:"anime-stat-value",children:Ue.total})]}),c.jsxs("div",{className:"anime-stat-card",children:[c.jsx("div",{className:"anime-stat-label",children:"Episodes Watched"}),c.jsx("div",{className:"anime-stat-value",children:Qe})]}),c.jsxs("div",{className:"anime-stat-card",children:[c.jsx("div",{className:"anime-stat-label",children:"Watching"}),c.jsx("div",{className:"anime-stat-value",children:Ue.byStatus.watching})]}),c.jsxs("div",{className:"anime-stat-card",children:[c.jsx("div",{className:"anime-stat-label",children:"Completed"}),c.jsx("div",{className:"anime-stat-value",children:Ue.byStatus.completed})]}),c.jsxs("div",{className:"anime-stat-card",children:[c.jsx("div",{className:"anime-stat-label",children:"Plan to Watch"}),c.jsx("div",{className:"anime-stat-value",children:Ue.byStatus.plan_to_watch})]}),c.jsxs("div",{className:"anime-stat-card",children:[c.jsx("div",{className:"anime-stat-label",children:"Avg. Score"}),c.jsx("div",{className:"anime-stat-value",children:Ue.avgScore?Ue.avgScore.toFixed(1):"0.0"})]}),c.jsxs("div",{className:"anime-stat-card",children:[c.jsx("div",{className:"anime-stat-label",children:"Days Watched"}),c.jsx("div",{className:"anime-stat-value",children:Ze.toFixed(1)})]})]}),c.jsxs("section",{className:"anime-toolbar",children:[c.jsx("input",{type:"text",placeholder:"Search anime by title...",value:m,onChange:ue=>v(ue.target.value),className:"anime-input"}),c.jsxs("select",{value:w,onChange:ue=>E(ue.target.value),className:"anime-select",children:[c.jsx("option",{value:"all",children:"All statuses"}),c.jsx("option",{value:"watching",children:"Watching"}),c.jsx("option",{value:"completed",children:"Completed"}),c.jsx("option",{value:"on_hold",children:"On Hold"}),c.jsx("option",{value:"plan_to_watch",children:"Plan to Watch"}),c.jsx("option",{value:"dropped",children:"Dropped"})]})]}),C&&c.jsx("div",{className:"loading",children:"Loading anime list from MAL..."}),q&&c.jsx("div",{className:"error-state",children:q}),!C&&!q&&c.jsx(c.Fragment,{children:d.length===0?c.jsx("div",{className:"empty-state",children:"No results match your filters yet."}):c.jsx("section",{className:"anime-grid",children:d.map(ue=>ut(ue))})})]}),ye.length>0&&c.jsxs("aside",{className:"anime-updates-float",children:[c.jsxs("div",{className:"anime-updates-header",children:[c.jsx("h3",{children:"Recent Updates"}),c.jsx("span",{className:"anime-updates-caption",children:"Last list activity"})]}),c.jsx("div",{className:"anime-updates-list",children:ye.map(ue=>bt(ue))})]}),je&&c.jsx(Fw,{open:L,title:"Suggest an Anime",placeholder:"Type an anime you'd like me to watch...",value:D,status:ce,loading:dt,onChange:S,onSubmit:Ae,onClose:()=>M(!1)}),F&&c.jsx("div",{className:"modal-backdrop visible",onClick:ue=>{ue.target===ue.currentTarget&&X(null)},children:c.jsxs("div",{className:"anime-modal",children:[c.jsxs("div",{className:"anime-modal-header",children:[c.jsx("h2",{style:{color:"#ffb6c1",margin:0},children:F.title}),c.jsx("button",{className:"anime-modal-close",onClick:()=>X(null),type:"button",children:"Close"})]}),c.jsxs("div",{className:"anime-modal-body",children:[c.jsx("div",{children:c.jsx("img",{className:"anime-modal-cover",src:F.image||"https://imgur.com/chUgq4W.png",alt:F.title})}),c.jsxs("div",{className:"anime-modal-meta",children:[c.jsxs("div",{children:[c.jsx("strong",{children:"Status:"})," ",s(F.status)]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Episodes:"})," ",F.episodes?F.episodes:"Unknown"]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Progress:"})," ",Number.isFinite(Number(F.watchedEpisodes))?`Episode ${F.watchedEpisodes}${Number.isFinite(Number(F.episodes))?`/${F.episodes}`:""}`:"Unknown"]}),c.jsxs("div",{children:[c.jsx("strong",{children:"Score:"})," ",Number.isFinite(Number(F.score))&&Number(F.score)>0?F.score:"Not rated"]})]}),c.jsx(VR,{modalItem:F,modalLoading:le,modalSynopsisShown:Se,onReveal:async()=>{if(!F)return;N(!0);const ue=F.id;if(!ue)return;const Ve=ge[ue];if(Ve!==void 0){X($e=>$e&&{...$e,synopsis:Ve});return}xe(!0);try{const $e=await NR(ue);re(Me=>({...Me,[ue]:$e||""})),X(Me=>Me&&{...Me,synopsis:$e||""})}catch{re(Me=>({...Me,[ue]:""})),X(Me=>Me&&{...Me,synopsis:""})}finally{xe(!1)}}})]})]})})]})}function VR({modalItem:n,modalLoading:e,modalSynopsisShown:t,onReveal:s}){var m;const a=((m=n==null?void 0:n.synopsis)==null?void 0:m.trim())||"",[l,d]=j.useState(0),f=j.useRef(null);return j.useEffect(()=>{if(t&&f.current){const v=f.current.scrollHeight+12;d(v)}else d(0)},[t,a]),c.jsxs("div",{className:"anime-modal-summary",children:[c.jsxs("div",{className:"anime-modal-summary-header",children:[c.jsx("h3",{children:"Synopsis"}),!t&&c.jsx("button",{className:"anime-synopsis-btn",type:"button",onClick:s,children:e?"Loading...":"Reveal Synopsis"})]}),c.jsx("div",{className:`anime-modal-summary-body ${t?"is-open":""}`,style:{maxHeight:t?`${l}px`:0,opacity:t?1:0},children:c.jsx("div",{ref:f,children:c.jsx("p",{className:"anime-modal-summary-text",children:e&&!a?"Loading synopsis...":a||"No synopsis available."})})}),!t&&c.jsx("p",{className:"anime-modal-summary-text anime-modal-summary-hint",children:"Synopsis hidden. Click reveal to view."})]})}function LR(){const n={game:"pokemon",name:"",setName:"",number:"",rarity:"",condition:"",quantity:1,pricePaid:"",estimatedValue:"",image:"",productURL:"",notes:""},{admin:e,user:t}=Vo(),[s,a]=j.useState([]),[l,d]=j.useState(!0),[f,m]=j.useState(""),[v,w]=j.useState("all"),[E,C]=j.useState("name"),[$,q]=j.useState(!1),[Y,F]=j.useState([]),[X,ge]=j.useState(""),[re,le]=j.useState(null),[xe,Se]=j.useState(!1),[N,R]=j.useState(n);j.useEffect(()=>{document.title="TCG | Collection"},[]),j.useEffect(()=>{let V=!1;const ne=async()=>{if(!V)try{const J=await fetch("/base/tcg-collection.json",{cache:"no-cache"});if(!J.ok)throw new Error("fallback fetch failed");const ye=await J.json(),je=Array.isArray(ye.tcg)?ye.tcg:[];V||a(je.map((Ae,Ue)=>({id:Ae.id||`offline-${Ue}`,...Ae})))}catch(b){console.error("TCG offline fallback failed",b)}finally{V||d(!1)}};async function se(){d(!0);try{const b=An(nt,"tcg"),J=await xs(b),ye=[];J.forEach(je=>ye.push({id:je.id,...je.data()})),V||a(ye)}catch(b){console.error("Error loading TCG:",b),await ne()}finally{V||d(!1)}}return se(),()=>{V=!0}},[t]);const k=s.filter(V=>{if(v!=="all"&&V.game!==v)return!1;if(!f)return!0;const ne=f.toLowerCase();return(V.name||"").toLowerCase().includes(ne)||(V.setName||"").toLowerCase().includes(ne)||(V.number||"").toLowerCase().includes(ne)}),L=[...k].sort((V,ne)=>{const se=(V.name||"").toLowerCase(),b=(ne.name||"").toLowerCase(),J=(V.setName||"").toLowerCase(),ye=(ne.setName||"").toLowerCase(),je=(V.rarity||"").toLowerCase(),Ae=(ne.rarity||"").toLowerCase(),Ue=Number(V.quantity||0),Ze=Number(ne.quantity||0),Qe=Number(V.estimatedValue||0)*Math.max(1,Ue),ut=Number(ne.estimatedValue||0)*Math.max(1,Ze);switch(E){case"set":return J.localeCompare(ye)||se.localeCompare(b);case"rarity":return je.localeCompare(Ae)||se.localeCompare(b);case"quantity":return Ze-Ue||se.localeCompare(b);case"value":return ut-Qe||se.localeCompare(b);case"name":default:return se.localeCompare(b)}}),M=s.reduce((V,ne)=>{const se=Number(ne.quantity||1),b=Number(ne.pricePaid||0),J=Number(ne.estimatedValue||0);return V.totalCards+=se,V.totalPaid+=se*b,V.totalValue+=se*J,ne.game==="pokemon"&&(V.pokemon+=se),ne.game==="onepiece"&&(V.onepiece+=se),V},{totalCards:0,totalPaid:0,totalValue:0,pokemon:0,onepiece:0}),D=M.totalValue-M.totalPaid,S=(V,ne)=>{R(se=>({...se,[V]:ne}))},ce=async()=>{if(!e)return;if(!N.name.trim()){alert("Card name is required.");return}const V={game:N.game,name:N.name.trim(),setName:N.setName.trim(),number:N.number.trim(),rarity:N.rarity.trim(),condition:N.condition.trim(),quantity:Number(N.quantity||1),pricePaid:Number(N.pricePaid||0),estimatedValue:Number(N.estimatedValue||0),image:N.image.trim(),productURL:N.productURL.trim(),notes:N.notes.trim()},ne=J=>({game:(J.game||"").toLowerCase().trim(),name:(J.name||"").toLowerCase().trim(),setName:(J.setName||"").toLowerCase().trim(),number:(J.number||"").toLowerCase().trim(),rarity:(J.rarity||"").toLowerCase().trim(),condition:(J.condition||"").toLowerCase().trim(),pricePaid:Number(J.pricePaid||0),estimatedValue:Number(J.estimatedValue||0),image:(J.image||"").trim(),productURL:(J.productURL||"").trim(),notes:(J.notes||"").trim()}),se=ne(V),b=s.find(J=>{const ye=ne(J);return ye.game===se.game&&ye.name===se.name&&ye.setName===se.setName&&ye.number===se.number&&ye.rarity===se.rarity&&ye.condition===se.condition&&ye.pricePaid===se.pricePaid&&ye.estimatedValue===se.estimatedValue&&ye.image===se.image&&ye.productURL===se.productURL&&ye.notes===se.notes});try{const J=An(nt,"tcg");if(b!=null&&b.id){const ye=Number(b.quantity||1)+V.quantity;await Ts(Ot(nt,"tcg",b.id),{quantity:ye}),a(je=>je.map(Ae=>Ae.id===b.id?{...Ae,quantity:ye}:Ae))}else{await Ei(J,V);const ye=await xs(J),je=[];ye.forEach(Ae=>je.push({id:Ae.id,...Ae.data()})),a(je)}R(n),Se(!1)}catch(J){console.error("Error adding card:",J),alert("Failed to save card.")}},me=async()=>{if(!e||!re)return;if(!re.name.trim()){alert("Card name is required.");return}const V={game:re.game,name:re.name.trim(),setName:re.setName.trim(),number:re.number.trim(),rarity:re.rarity.trim(),condition:re.condition.trim(),quantity:Number(re.quantity||1),pricePaid:Number(re.pricePaid||0),estimatedValue:Number(re.estimatedValue||0),image:re.image?re.image.trim():"",productURL:re.productURL?re.productURL.trim():"",notes:re.notes?re.notes.trim():""};try{await Ts(Ot(nt,"tcg",re.id),V),a(ne=>ne.map(se=>se.id===re.id?{...se,...V}:se)),le(null)}catch(ne){console.error("Error updating card:",ne),alert("Failed to update card.")}},dt=async V=>{if(e&&window.confirm("Delete this card?"))try{await ha(Ot(nt,"tcg",V)),a(ne=>ne.filter(se=>se.id!==V))}catch(ne){console.error("Delete error:",ne),alert("Failed to delete card.")}},We=()=>{if(!s.length){alert("No cards to export.");return}const V=new Blob([JSON.stringify({tcg:s},null,2)],{type:"application/json"}),ne=URL.createObjectURL(V),se=document.createElement("a");se.href=ne,se.download="tcg-collection.json",se.click(),URL.revokeObjectURL(ne)};return c.jsxs("main",{className:"page",children:[c.jsxs("header",{style:{marginTop:"32px",marginBottom:"16px",display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",gap:"6px"},children:[c.jsx("h1",{style:{margin:0,fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Tyler's TCG Collection"}),c.jsx("p",{style:{margin:"6px 0 0",color:"var(--text-soft)",fontSize:"0.9rem"},children:"Check out my TCG Collection with all the data of how much I spent (Under construction) and how much my collection is worth in total!"}),c.jsx("div",{style:{marginTop:"10px"},children:c.jsx("button",{className:"manga-btn secondary",type:"button",onClick:We,children:"Export JSON"})})]}),e&&c.jsx("button",{className:"manga-btn",type:"button","aria-label":"Add card",onClick:()=>Se(!0),style:{position:"fixed",bottom:"20px",right:"20px",zIndex:1e3,width:"56px",height:"56px",borderRadius:"50%",padding:0,fontSize:"28px",display:"flex",alignItems:"center",justifyContent:"center"},children:"+"}),e&&xe&&c.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(8,1,10,0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,padding:"12px"},onClick:V=>{V.target===V.currentTarget&&Se(!1)},children:c.jsxs("div",{style:{width:"min(720px, 95vw)",background:"#140710",border:"1px solid rgba(255,182,193,0.3)",borderRadius:"12px",padding:"14px",boxShadow:"0 24px 60px rgba(0,0,0,0.85)"},onClick:V=>V.stopPropagation(),children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[c.jsx("h2",{style:{margin:0,color:"#ffb6c1"},children:"Add card"}),c.jsx("button",{className:"dashboard-close",onClick:()=>Se(!1),type:"button",children:"Close"})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"180px 1fr",gap:"12px",alignItems:"flex-start",marginTop:"10px"},children:[c.jsx("div",{style:{width:"100%",maxWidth:"180px",borderRadius:"10px",border:"1px solid rgba(255,182,193,0.25)",background:"#1e0d14",overflow:"hidden",aspectRatio:"3 / 4",display:"flex",alignItems:"center",justifyContent:"center"},children:N.image?c.jsx("img",{src:N.image,alt:"Card preview",style:{width:"100%",height:"100%",objectFit:"cover"}}):c.jsx("div",{style:{color:"var(--text-soft)",fontSize:"0.8rem",padding:"6px"},children:"No image"})}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:"8px"},children:[c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Game",c.jsxs("select",{value:N.game,onChange:V=>S("game",V.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"},children:[c.jsx("option",{value:"pokemon",children:"Pokemon"}),c.jsx("option",{value:"onepiece",children:"One Piece"})]})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Card name",c.jsx("input",{type:"text",value:N.name,onChange:V=>S("name",V.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Set name",c.jsx("input",{type:"text",value:N.setName,onChange:V=>S("setName",V.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Card number",c.jsx("input",{type:"text",value:N.number,onChange:V=>S("number",V.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Rarity",c.jsx("input",{type:"text",value:N.rarity,onChange:V=>S("rarity",V.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Condition",c.jsx("input",{type:"text",value:N.condition,onChange:V=>S("condition",V.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Quantity",c.jsx("input",{type:"number",min:"1",value:N.quantity,onChange:V=>S("quantity",V.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Price paid (per card)",c.jsx("input",{type:"number",step:"0.01",min:"0",value:N.pricePaid,onChange:V=>S("pricePaid",V.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Estimated value (per card)",c.jsx("input",{type:"number",step:"0.01",min:"0",value:N.estimatedValue,onChange:V=>S("estimatedValue",V.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Image URL",c.jsx("input",{type:"text",value:N.image||"",onChange:V=>S("image",V.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Product URL (backend only)",c.jsx("input",{type:"text",value:N.productURL||"",onChange:V=>S("productURL",V.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{gridColumn:"1 / -1",fontSize:"0.8rem",color:"var(--text-soft)"},children:["Notes",c.jsx("textarea",{value:N.notes,onChange:V=>S("notes",V.target.value),rows:3,style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff",resize:"vertical"}})]})]})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"12px"},children:[c.jsx("button",{onClick:()=>{R(n),Se(!1)},style:{padding:"6px 12px",borderRadius:"999px",border:"1px solid rgba(255,182,193,0.5)",background:"transparent",color:"#ffb6c1",cursor:"pointer"},children:"Cancel"}),c.jsx("button",{onClick:ce,style:{padding:"6px 12px",borderRadius:"999px",border:"none",cursor:"pointer",fontWeight:600,background:"#ff69b4",color:"#1e0d14"},children:"Save card"})]})]})}),e&&re&&c.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(8,1,10,0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,padding:"12px"},onClick:V=>{V.target===V.currentTarget&&le(null)},children:c.jsxs("div",{style:{width:"min(720px, 95vw)",background:"#140710",border:"1px solid rgba(255,182,193,0.3)",borderRadius:"12px",padding:"14px",boxShadow:"0 24px 60px rgba(0,0,0,0.85)"},onClick:V=>V.stopPropagation(),children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[c.jsx("h2",{style:{margin:0,color:"#ffb6c1"},children:"Edit card"}),c.jsx("button",{className:"dashboard-close",onClick:()=>le(null),type:"button",children:"Close"})]}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"180px 1fr",gap:"12px",alignItems:"flex-start",marginTop:"10px"},children:[c.jsx("div",{style:{width:"100%",maxWidth:"180px",borderRadius:"10px",border:"1px solid rgba(255,182,193,0.25)",background:"#1e0d14",overflow:"hidden",aspectRatio:"3 / 4",display:"flex",alignItems:"center",justifyContent:"center"},children:re.image?c.jsx("img",{src:re.image,alt:"Card preview",style:{width:"100%",height:"100%",objectFit:"cover"}}):c.jsx("div",{style:{color:"var(--text-soft)",fontSize:"0.8rem",padding:"6px"},children:"No image"})}),c.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:"8px"},children:[c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Game",c.jsxs("select",{value:re.game,onChange:V=>le(ne=>({...ne,game:V.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"},children:[c.jsx("option",{value:"pokemon",children:"Pokemon"}),c.jsx("option",{value:"onepiece",children:"One Piece"})]})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Card name",c.jsx("input",{type:"text",value:re.name,onChange:V=>le(ne=>({...ne,name:V.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Set name",c.jsx("input",{type:"text",value:re.setName,onChange:V=>le(ne=>({...ne,setName:V.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Card number",c.jsx("input",{type:"text",value:re.number,onChange:V=>le(ne=>({...ne,number:V.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Rarity",c.jsx("input",{type:"text",value:re.rarity,onChange:V=>le(ne=>({...ne,rarity:V.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Condition",c.jsx("input",{type:"text",value:re.condition,onChange:V=>le(ne=>({...ne,condition:V.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Quantity",c.jsx("input",{type:"number",value:re.quantity,onChange:V=>le(ne=>({...ne,quantity:V.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Price paid (each)",c.jsx("input",{type:"number",value:re.pricePaid,onChange:V=>le(ne=>({...ne,pricePaid:V.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Estimated value (each)",c.jsx("input",{type:"number",value:re.estimatedValue,onChange:V=>le(ne=>({...ne,estimatedValue:V.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Image URL",c.jsx("input",{type:"text",value:re.image||"",onChange:V=>le(ne=>({...ne,image:V.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Product URL (backend only)",c.jsx("input",{type:"text",value:re.productURL||"",onChange:V=>le(ne=>({...ne,productURL:V.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),c.jsxs("label",{style:{gridColumn:"1 / -1",fontSize:"0.8rem",color:"var(--text-soft)"},children:["Notes",c.jsx("textarea",{value:re.notes||"",onChange:V=>le(ne=>({...ne,notes:V.target.value})),rows:3,style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff",resize:"vertical"}})]})]})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"12px"},children:[c.jsx("button",{onClick:()=>le(null),style:{padding:"6px 12px",borderRadius:"999px",border:"1px solid rgba(255,182,193,0.5)",background:"transparent",color:"#ffb6c1",cursor:"pointer"},children:"Cancel"}),c.jsx("button",{onClick:me,style:{padding:"6px 12px",borderRadius:"999px",border:"none",cursor:"pointer",fontWeight:600,background:"#ff69b4",color:"#1e0d14"},children:"Save changes"})]})]})}),c.jsxs("section",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:"12px",marginTop:"18px"},children:[c.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center"},children:[c.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Total cards"}),c.jsx("div",{style:{fontSize:"1.1rem",fontWeight:700},children:M.totalCards})]}),c.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center"},children:[c.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Total paid"}),c.jsxs("div",{style:{fontSize:"1.1rem",fontWeight:700},children:["$",M.totalPaid.toFixed(2)]})]}),c.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center"},children:[c.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Total value"}),c.jsxs("div",{style:{fontSize:"1.1rem",fontWeight:700},children:["$",M.totalValue.toFixed(2)]})]}),c.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center"},children:[c.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Unrealized gain / loss"}),c.jsxs("div",{style:{fontSize:"1.1rem",fontWeight:700,color:D>=0?"#00e676":"#ff8a80"},children:[D>=0?"+":"-","$",Math.abs(D).toFixed(2)]})]}),c.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center"},children:[c.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Pokemon cards"}),c.jsx("div",{style:{fontSize:"1.1rem",fontWeight:700},children:M.pokemon})]}),c.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center"},children:[c.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"One Piece cards"}),c.jsx("div",{style:{fontSize:"1.1rem",fontWeight:700},children:M.onepiece})]})]}),c.jsxs("section",{style:{display:"flex",flexWrap:"wrap",gap:"10px",marginTop:"16px"},children:[c.jsx("input",{type:"text",placeholder:"Search by name, set, or number...",value:f,onChange:V=>m(V.target.value),style:{flex:"1 1 220px",minWidth:"220px",padding:"8px 12px",borderRadius:"999px",border:"1px solid #bb7f8f",background:"#2b0f1d",color:"#fff"}}),c.jsxs("select",{value:v,onChange:V=>w(V.target.value),style:{flex:"0 0 220px",padding:"8px 12px",borderRadius:"999px",border:"1px solid #bb7f8f",background:"#2b0f1d",color:"#fff"},children:[c.jsx("option",{value:"all",children:"All games"}),c.jsx("option",{value:"pokemon",children:"Pokemon only"}),c.jsx("option",{value:"onepiece",children:"One Piece only"})]}),c.jsxs("select",{value:E,onChange:V=>C(V.target.value),style:{flex:"0 0 220px",padding:"8px 12px",borderRadius:"999px",border:"1px solid #bb7f8f",background:"#2b0f1d",color:"#fff"},children:[c.jsx("option",{value:"name",children:"Sort: Name (A-Z)"}),c.jsx("option",{value:"set",children:"Sort: Set (A-Z)"}),c.jsx("option",{value:"rarity",children:"Sort: Rarity (A-Z)"}),c.jsx("option",{value:"quantity",children:"Sort: Quantity (high to low)"}),c.jsx("option",{value:"value",children:"Sort: Value (high to low)"})]})]}),l?c.jsx("p",{style:{marginTop:"20px",color:"var(--text-soft)"},children:"Loading TCG collection..."}):k.length===0?c.jsx("p",{style:{marginTop:"20px",color:"var(--text-soft)"},children:"No cards found."}):c.jsx("section",{className:"grid",style:{gridTemplateColumns:"repeat(auto-fill, minmax(170px, 1fr))",marginTop:"20px"},children:L.map(V=>{const ne=Number(V.quantity||1),se=ne*Number(V.pricePaid||0),b=ne*Number(V.estimatedValue||0);return c.jsxs("article",{style:{background:"#2b0f1d",borderRadius:"12px",border:"1px solid rgba(255,182,193,0.25)",boxShadow:"0 4px 16px rgba(0,0,0,0.55)",padding:"10px",fontSize:"0.82rem",display:"flex",flexDirection:"column",gap:"6px"},children:[V.image&&c.jsx("div",{style:{width:"100%",paddingTop:"140%",position:"relative",overflow:"hidden",borderRadius:"10px",background:"#1e0d14"},children:c.jsx("img",{src:V.image,alt:V.name||"card image",style:{position:"absolute",inset:0,width:"100%",height:"100%",objectFit:"contain"}})}),c.jsx("div",{style:{fontWeight:700,color:"#ffb6c1",marginBottom:"4px"},children:V.name||"Unnamed card"}),c.jsx("div",{style:{color:"var(--text-soft)",marginBottom:"4px"},children:V.setName||""}),c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",color:"var(--text-soft)"},children:[c.jsxs("span",{children:["#",V.number||"-"]}),c.jsx("span",{children:V.rarity||""})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",color:"var(--text-soft)",marginTop:"4px"},children:[c.jsxs("span",{children:["Cond: ",V.condition||"N/A"]}),c.jsxs("span",{children:["Qty: ",ne]})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",color:"var(--text-soft)",marginTop:"4px"},children:[c.jsxs("span",{children:["Paid: $",se.toFixed(2)]}),c.jsxs("span",{children:["Value: $",b.toFixed(2)]})]}),V.notes&&c.jsxs("div",{style:{color:"#9c8fa6",fontSize:"0.72rem",fontStyle:"italic",textAlign:"center",marginTop:"6px"},children:['"',V.notes,'"']}),c.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"8px"},children:[c.jsx("span",{style:{padding:"2px 7px",borderRadius:"999px",background:"rgba(255,105,180,0.18)",border:"1px solid rgba(255,105,180,0.5)",color:"#ffb6c1",fontSize:"0.7rem",whiteSpace:"nowrap"},children:V.game==="pokemon"?"Pokemon":"One Piece"}),e&&c.jsxs("div",{style:{display:"flex",gap:"6px",alignItems:"center",marginLeft:"auto"},children:[c.jsx("button",{onClick:()=>le({...V,pricePaid:V.pricePaid??"",estimatedValue:V.estimatedValue??"",quantity:V.quantity??1}),style:{padding:"3px 8px",borderRadius:"999px",border:"1px solid rgba(255,182,193,0.5)",background:"rgba(255,105,180,0.15)",color:"#ffb6c1",fontSize:"0.7rem",cursor:"pointer"},children:"Edit"}),c.jsx("button",{onClick:()=>dt(V.id),style:{padding:"3px 8px",borderRadius:"999px",border:"1px solid rgba(244,67,54,0.7)",background:"rgba(244,67,54,0.12)",color:"#ff8a80",fontSize:"0.7rem",cursor:"pointer"},children:"Delete"})]})]})]},V.id)})})]})}const hl="https://discord.com/api/webhooks/1448287168845054004/cGWGPoH5LaTFlBZ1vxtgMjOfV9au6qyQ_9ZRnOWN9-AX0MNfwxKNWVcZYQHz0ESA7_4k",fl="https://discord.com/api/webhooks/1448288240871276616/101WI-B2p8tDR34Hl9fZxxb0QG01f1Eo5w1IvbttlQmP2wWFNJ0OI7UnJfJujKRNWW2Q",pl="https://discord.com/api/webhooks/1448329790942613667/wsC8psNZ-Ax2D1O9Gl4sJi6ay7df2cr7IrIdxMPwGZTBnkSUIY2NDpeVd98qW_4plz82",ml="",$v="mangaLibraryActivityLog";function tc(n){const e=n==null?"":String(n);return e.trim()?e.replace(/\s*,?\s*(?:vol(?:ume)?\.?)\s+\d+.*$/i,"").trim():""}function Ta(n){if(!n)return null;if(n instanceof Date)return n;if(n&&typeof n.toDate=="function")return n.toDate();const e=String(n).trim();if(!e)return null;const t=e.match(/^(\d{4})-(\d{2})-(\d{2})$/);if(t){const[,l,d,f]=t;return new Date(Number(l),Number(d)-1,Number(f))}const s=e.match(/^(\d{1,2})\/(\d{1,2})\/(\d{2,4})$/);if(s){let[,l,d,f]=s;const m=f.length===2?+`20${f}`:Number(f);return new Date(m,Number(l)-1,Number(d))}const a=new Date(e);return isNaN(a.getTime())?null:a}function fd(n){const e=n.seriesKey||n.series||n.Series||n.title||n.Title||"",s=(tc(e)||e).trim();return s?s.toLowerCase():""}function OR(n){const e=(n==null?void 0:n.series)||(n==null?void 0:n.Series)||(n==null?void 0:n.title)||(n==null?void 0:n.Title)||"Unknown Series";return tc(e)||"Unknown Series"}function Wv(n){const e=(n||"").trim(),t=e.match(/^(.*?)(?:,?\s*(?:vol\.|volume)\s*(\d+)(?:\s*[-]\s*\d+)?\s*)?(?:\s*\([^)]*\))?$/i),s=t?t[1].trim().toLowerCase():e.toLowerCase(),a=t&&t[2]?parseInt(t[2],10):0;return{name:s,vol:Number.isFinite(a)?a:0}}function MR(n,e){const t=(n==null?void 0:n.Title)||(n==null?void 0:n.title)||"",s=(e==null?void 0:e.Title)||(e==null?void 0:e.title)||"",a=Wv(t),l=Wv(s),d=a.name.localeCompare(l.name);return d!==0?d:a.vol!==l.vol?a.vol-l.vol:t.localeCompare(s)}function ef(){return{publisher:"",demographic:"",genre:"",subGenre:"",datePurchased:"",msrp:"",initialPublisher:"",initialDemographic:"",initialGenre:"",initialSubGenre:"",initialDatePurchased:"",initialMsrp:"",dateMixed:!1,readChecked:!1,readIndeterminate:!1}}function qv(){return{read:!1,datePurchased:"",dateRead:"",pageCount:"",msrp:"",amountPaid:"",rating:"",special:!1,specialType:"",specialVolumes:"",collectiblePrice:""}}function Hv(n,e={}){const t=e.ignoreShared,s=(n==null?void 0:n.amountPaid)??(n==null?void 0:n.AmountPaid)??(n==null?void 0:n.paid)??(n==null?void 0:n.Paid)??"",a=(n==null?void 0:n.msrp)??(n==null?void 0:n.MSRP)??"",l=((n==null?void 0:n.datePurchased)||(n==null?void 0:n.DatePurchased)||"").trim(),d=((n==null?void 0:n.publisher)||(n==null?void 0:n.Publisher)||"").trim(),f=((n==null?void 0:n.demographic)||(n==null?void 0:n.Demographic)||"").trim(),m=((n==null?void 0:n.genre)||(n==null?void 0:n.Genre)||"").trim(),v=((n==null?void 0:n.specialType)||(n==null?void 0:n.SpecialType)||"").trim(),w=(n==null?void 0:n.specialVolumes)??(n==null?void 0:n.SpecialVolumes)??(n==null?void 0:n.volumesContained)??"",E=(n==null?void 0:n.collectiblePrice)??(n==null?void 0:n.CollectiblePrice)??"",C=!!v,$=(n==null?void 0:n.pageCount)??(n==null?void 0:n.PageCount)??(n==null?void 0:n.pages)??(n==null?void 0:n.Pages)??"",q=$==null?"":String($).trim(),Y=Number(q),F=!q||Number.isNaN(Y)||Y<=0;return!C&&(s===""||s===null)||F||!l||!t&&(a===""||!d||!f||!m)||C&&!v||C&&v.toLowerCase()==="collectible"&&(E===""||E===null)||C&&v.toLowerCase()==="specialedition"&&(w===""||w===null)}function FR(n){const e=(n==null?void 0:n.amountPaid)??"",t=((n==null?void 0:n.datePurchased)||"").trim(),s=!!(n!=null&&n.specialType)||!!(n!=null&&n.special),a=((n==null?void 0:n.specialType)||"").trim(),l=(n==null?void 0:n.specialVolumes)??"",d=(n==null?void 0:n.collectiblePrice)??"",f=(n==null?void 0:n.pageCount)??"",m=(n==null?void 0:n.msrp)??"",v=((n==null?void 0:n.publisher)||"").trim(),w=((n==null?void 0:n.demographic)||"").trim(),E=((n==null?void 0:n.genre)||"").trim(),C=!s&&(e===""||e===null),$=s&&!a,q=s&&a.toLowerCase()==="collectible"&&(d===""||d===null),Y=s&&a.toLowerCase()==="specialedition"&&(l===""||l===null),F=(()=>{const X=(f??"").toString().trim();if(X==="")return!0;const ge=Number(X);return Number.isNaN(ge)||ge<=0})();return{amountPaid:C,datePurchased:!t,specialType:$,collectiblePrice:q,specialVolumes:Y,pageCount:F,msrp:m===""||m===null,publisher:!v,demographic:!w,genre:!E}}function UR(n){return!n||!n.books||!n.books.length?!1:n.books.some(e=>{const t=(e==null?void 0:e.msrp)??(e==null?void 0:e.MSRP)??"",s=((e==null?void 0:e.publisher)||(e==null?void 0:e.Publisher)||"").trim(),a=((e==null?void 0:e.demographic)||(e==null?void 0:e.Demographic)||"").trim(),l=((e==null?void 0:e.genre)||(e==null?void 0:e.Genre)||"").trim();return t===""||!s||!a||!l})}function zR(n){const e=new Map;for(const t of n){const s=fd(t)||t.id;if(!e.has(s)){const m=tc(t.series||t.Series||t.title||t.Title||"Unknown Series")||"Unknown Series";e.set(s,{key:s,title:m,publisher:t.publisher||t.Publisher||"",genre:t.genre||t.Genre||"",demographic:t.demographic||t.Demographic||"",volumes:0,totalPages:0,readPages:0,readVolumes:0,ratingSum:0,ratingCount:0})}const a=e.get(s);a.volumes+=1;const l=Number(t.pages||t.Pages||t.pageCount||0)||0;a.totalPages+=l,(!!t.read||t.status==="Read"||t.Read===!0)&&(a.readVolumes+=1,a.readPages+=l);const f=Number(t.rating||t.Rating);!isNaN(f)&&f>0&&(a.ratingSum+=f,a.ratingCount+=1)}return e}function oo(n,e,t=5){const s=new Map;for(const a of n.values()){const l=(a[e]||"").trim();if(!l)continue;const d=l.split(/[\/,]/).map(f=>f.trim()).filter(Boolean);for(const f of d)s.set(f,(s.get(f)||0)+1)}return[...s.entries()].sort((a,l)=>l[1]-a[1]).slice(0,t).map(([a,l])=>({name:a,count:l}))}function Gv(n,e){const t=Array.from({length:12},(s,a)=>{const l=new Date(e,a,1);return{key:`${e}-${a}`,label:l.toLocaleString("default",{month:"short"}),year:e,month:a,value:0}});for(const s of n){const a=Ta(s.dateRead||s.DateRead);!a||a.getFullYear()!==e||(t[a.getMonth()].value+=1)}return t}function El(n){const e=n.getFullYear(),t=`${n.getMonth()+1}`.padStart(2,"0"),s=`${n.getDate()}`.padStart(2,"0");return`${e}-${t}-${s}`}async function tf(n,e){try{await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:e})})}catch(t){console.error("Webhook post failed",t)}}function BR(n){const e=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],t=Array(7).fill(0);for(const l of n){const d=Ta(l.dateRead||l.DateRead);d&&(t[d.getDay()]+=1)}if(!t.some(l=>l>0))return[];const a=t.reduce((l,d)=>Math.max(l,d),0)||1;return e.map((l,d)=>({label:l,value:t[d],pct:t[d]/a}))}function $R(n,e=8){const t=[...n.values()];t.sort((l,d)=>d.volumes-l.volumes);const s=t.slice(0,e),a=s.reduce((l,d)=>Math.max(l,d.volumes),0)||1;return s.map(l=>({label:l.title,value:l.volumes,pct:l.volumes/a}))}function WR(n){const e=[];for(const t of n){const s=Ta(t.releaseDate||t.ReleaseDate||t.date||t.Date)||null;if(!s)continue;const a=(t.title||t.series||t.Title||"Unknown Title").trim();e.push({date:s,title:a})}return e.sort((t,s)=>t.date-s.date),e}function qR(n){const e=new Date;for(const t of n)if(t.date>=e)return t;return n[n.length-1]||null}function HR(n){let e=0,t=0;for(const s of n){const a=Ta(s.datePurchased||s.DatePurchased),l=Ta(s.dateRead||s.DateRead);if(!a||!l)continue;const d=l-a;d<=0||(e+=d/(1e3*60*60*24),t+=1)}return t?e/t:null}function GR(n){const e=new Map;for(const t of n){const s=Ta(t.datePurchased||t.DatePurchased),a=Ta(t.dateRead||t.DateRead);if(!s||!a)continue;const l=a-s;if(l<=0)continue;const d=l/(1e3*60*60*24),f=fd(t)||t.id,m=tc(t.series||t.Series||t.title||t.Title||"Untitled")||"Untitled";e.has(f)||e.set(f,{key:f,title:m,total:0,count:0,min:d,max:d});const v=e.get(f);v.total+=d,v.count+=1,v.min=Math.min(v.min,d),v.max=Math.max(v.max,d)}return[...e.values()].filter(t=>t.count>0).map(t=>({...t,avg:t.total/t.count})).sort((t,s)=>s.avg-t.avg)}function KR(n){let e=0,t=0,s=0;for(const a of n){const l=Number(a.msrp||a.MSRP||0)||0,d=Number(a.amountPaid||a.AmountPaid||a.pricePaid||0)||l||0,f=Number(a.collectiblePrice||a.CollectiblePrice||0)||0;e+=l,t+=d,s+=f}return{msrpTotal:e,paidTotal:t,collectibleTotal:s}}function QR(n){const e=new Map;for(const t of n){const s=fd(t)||t.id;if(!e.has(s)){const E=t.series||t.Series||t.title||t.Title||"Untitled";e.set(s,{key:s,title:tc(E)||E.trim()||"Untitled",msrp:0,paid:0,collectible:0,books:0,pages:0,readPages:0,ratings:[]})}const a=e.get(s);a.books+=1;const l=Number(t.msrp||t.MSRP||0)||0,d=Number(t.amountPaid||t.AmountPaid||t.pricePaid||0)||0,f=Number(t.collectiblePrice||t.CollectiblePrice||0)||0,m=Number(t.pages||t.Pages||t.pageCount||0)||0,v=!!t.read||t.status==="Read"||t.Read===!0;a.msrp+=l,a.paid+=d,a.collectible+=f,a.pages+=m,v&&(a.readPages+=m);const w=Number(t.rating||t.Rating);!isNaN(w)&&w>0&&a.ratings.push(w)}return[...e.values()]}function YR(n){let e=0,t=0;for(const s of n){const a=Number(s.pages||s.Pages||s.pageCount||0)||0;e+=a,(!!s.read||s.status==="Read"||s.Read===!0)&&(t+=a)}return{total:e,read:t}}function JR(n){let e=0,t=0;for(const s of n.values())s.ratingCount>0&&(e+=s.ratingSum/s.ratingCount,t+=1);return t?e/t:null}function XR({data:n}){if(!n||!n.length)return c.jsx("div",{className:"line-chart empty",children:"No reading data yet."});const e=n.reduce((v,w)=>Math.max(v,w.value),0)||1,t=480,s=230,a=30,l=s-a*2,d=t/Math.max(n.length-1,1),f=n.map((v,w)=>{const E=w*d,C=s-a-v.value/e*l;return{...v,x:E,y:C}}),m=f.map((v,w)=>w===0?`M ${v.x} ${v.y}`:`L ${v.x} ${v.y}`).join(" ");return c.jsx("div",{className:"line-chart",children:c.jsxs("svg",{viewBox:`0 0 ${t} ${s}`,width:"100%",height:"100%",preserveAspectRatio:"xMidYMid meet",children:[[0,.25,.5,.75,1].map((v,w)=>{const E=s-a-v*l;return c.jsx("line",{className:"line-grid",x1:"0",x2:t,y1:E,y2:E},`h-${w}`)}),f.map((v,w)=>c.jsx("line",{className:"line-grid",x1:v.x,x2:v.x,y1:a/2,y2:s-a/2},`v-${w}`)),c.jsx("path",{className:"line-path",d:m}),f.map((v,w)=>c.jsxs("g",{children:[c.jsx("circle",{className:"line-point",cx:v.x,cy:v.y,r:"1.5"}),c.jsx("text",{className:"line-value",x:v.x,y:v.y-3,children:v.value}),c.jsx("text",{className:"line-label",x:v.x,y:s-4,children:v.label})]},w))]})})}function ZR({data:n}){return!n||!n.length?c.jsx("div",{className:"weekday-breakdown empty",children:"No reads recorded yet."}):c.jsx("div",{className:"weekday-bars",children:n.map(e=>c.jsxs("div",{className:"weekday-col",children:[c.jsx("div",{className:"weekday-count",children:e.value}),c.jsx("div",{className:"weekday-bar-vert",children:c.jsx("div",{className:"weekday-bar-vert-fill",style:{height:`${Math.max(e.pct*100,e.value?6:0)}%`}})}),c.jsx("div",{className:"weekday-label",children:e.label})]},e.label))})}function eA(n,e,t){const s=n.getFullYear(),a=n.getMonth(),d=new Date(s,a,1).getDay(),f=new Date(s,a+1,0).getDate(),m=new Map;for(const E of e){const C=E.date;if(C.getFullYear()===s&&C.getMonth()===a){const $=C.getDate();m.has($)||m.set($,[]),m.get($).push(E)}}const v=[];for(let E=0;E<d;E++)v.push({type:"pad"});for(let E=1;E<=f;E++){const C=El(new Date(s,a,E));v.push({type:"day",day:E,releases:m.get(E)||[],dateKey:C,isToday:C===t})}const w=Math.ceil(v.length/7)*7;for(;v.length<w;)v.push({type:"pad"});return v}function tA(){const{user:n,admin:e,loading:t}=Vo(),[s,a]=j.useState([]),[l,d]=j.useState([]),[f,m]=j.useState(!0),[v,w]=j.useState(null),[E,C]=j.useState("-"),[$,q]=j.useState({yearly:hl,release:fl,activity:pl,suggestion:ml}),[Y,F]=j.useState(new Set),[X,ge]=j.useState(null),[re,le]=j.useState(null),[xe,Se]=j.useState(new Set),[N,R]=j.useState(null),[k,L]=j.useState(""),M=j.useRef(null),[D,S]=j.useState(()=>ef()),[ce,me]=j.useState(()=>qv()),[dt,We]=j.useState([]),[V,ne]=j.useState(!1),[se,b]=j.useState(""),[J,ye]=j.useState([]),[je,Ae]=j.useState(!1),[Ue,Ze]=j.useState([]),[Qe,ut]=j.useState(!1),[bt,ue]=j.useState(""),[Ve,$e]=j.useState(null),[Me,xt]=j.useState(null),It=async()=>{if(e)try{Ae(!0);const I=dR(An(nt,"users"),hR("role","==","admin")),W=(await xs(I)).docs.map(fe=>({uid:fe.id,...fe.data()}));ye(W)}catch(I){console.error("Failed to refresh admins",I)}finally{Ae(!1)}},jt=async()=>{const I=se.trim();if(!I){alert("Enter a UID to grant admin.");return}try{await ma(Ot(nt,"users",I),{role:"admin",grantedBy:(n==null?void 0:n.uid)||"manual",grantedAt:new Date().toISOString()},{merge:!0}),b(""),await It()}catch(U){console.error("Grant admin failed",U),alert("Failed to grant admin.")}},Qt=async I=>{const U=(I||se).trim();if(!U){alert("Enter a UID to revoke admin.");return}try{await ma(Ot(nt,"users",U),{role:"viewer",revokedBy:(n==null?void 0:n.uid)||"manual",revokedAt:new Date().toISOString()},{merge:!0}),I||b(""),await It()}catch(W){console.error("Revoke admin failed",W),alert("Failed to revoke admin.")}},[Gt,tn]=j.useState(!1),[Bt,jn]=j.useState(()=>new Date),[Rt,nn]=j.useState({open:!1,type:null}),En=new Date().getFullYear(),At=j.useRef(null),Ye=j.useRef(null);j.useEffect(()=>{document.title="Dashboard"},[]),j.useEffect(()=>(Gt||Rt.open||V||!!Me?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[Gt,Rt.open,V,Me]),j.useEffect(()=>{typeof window>"u"||(At.current=localStorage.getItem("dashboard-yearly-posted"),Ye.current=localStorage.getItem("dashboard-release-posted"))},[]),j.useEffect(()=>{if(!e)return;const I=Ot(nt,"settings","webhooks");(async()=>{try{const U=await Dp(I);if(U.exists()){const W=U.data();q({yearly:W.yearly||hl,release:W.release||fl,activity:W.activity||pl,suggestion:W.suggestion||ml})}else await ma(I,{yearly:hl,release:fl,activity:pl,suggestion:ml}),q({yearly:hl,release:fl,activity:pl,suggestion:ml})}catch(U){console.error("Failed to load webhook settings",U)}})()},[e]),j.useEffect(()=>{if(!e)return;let I=!1;return(async()=>{try{Ae(!0);const U=await xs(An(nt,"admins"));if(I)return;const W=U.docs.map(fe=>({uid:fe.id,...fe.data()}));ye(W)}catch(U){console.error("Failed to load admins",U)}finally{I||Ae(!1)}})(),()=>{I=!0}},[e]),j.useEffect(()=>{let I=!1;if(!n||!e){Ze([]),ue("");return}return(async()=>{try{ut(!0);const W=(await xs(An(nt,"suggestions"))).docs.map(fe=>{var Te;const Ee=fe.data();let Oe=null;if((Te=Ee==null?void 0:Ee.createdAt)!=null&&Te.toDate)Oe=Ee.createdAt.toDate();else if(Ee!=null&&Ee.createdAt){const rt=new Date(Ee.createdAt);Oe=isNaN(rt.getTime())?null:rt}return{id:fe.id,...Ee,createdAt:Oe}});W.sort((fe,Ee)=>{var Oe,Te,rt,wt;return(((Te=(Oe=Ee.createdAt)==null?void 0:Oe.getTime)==null?void 0:Te.call(Oe))||0)-(((wt=(rt=fe.createdAt)==null?void 0:rt.getTime)==null?void 0:wt.call(rt))||0)}),I||(Ze(W),ue(""))}catch(U){console.error("Failed to load suggestions",U),I||(ue("Failed to load suggestions."),Ze([]))}finally{I||ut(!1)}})(),()=>{I=!0}},[n,e]);const Xn=async I=>{if(!(!e||!I))try{await ha(Ot(nt,"suggestions",I)),Ze(U=>U.filter(W=>W.id!==I))}catch(U){console.error("Failed to delete suggestion",U),ue("Failed to delete suggestion.")}};j.useEffect(()=>{let I=!1;async function U(){if(!n||!e){a([]),d([]),w(null),m(!1);return}try{m(!0);const[W,fe]=await Promise.all([xs(An(nt,"library")),xs(An(nt,"wishlist"))]);if(I)return;a(W.docs.map(Ee=>({id:Ee.id,...Ee.data()}))),d(fe.docs.map(Ee=>({id:Ee.id,...Ee.data()}))),w(null)}catch(W){console.error(W),I||w("Failed to load dashboard data.")}finally{I||m(!1)}}return U(),()=>{I=!0}},[n,e]);const As=j.useMemo(()=>{const I=s.length,U=s.filter($r=>!!$r.read||$r.status==="Read"||$r.Read===!0).length,W=I-U,fe=I?Math.round(U/I*100):0,Ee=l.length,Oe=zR(s),Te=Gv(s,En),rt=Gv(s,En-1),wt=Te.reduce(($r,Cr)=>$r+Cr.value,0),ot=BR(s),$t=$R(Oe),Dt=WR(l),dn=qR(Dt),et=HR(s),it=KR(s),tt=YR(s),Yt=JR(Oe),Ir=GR(s),ds=oo(Oe,"publisher",5),ba=oo(Oe,"genre",5),Ra=oo(Oe,"demographic",5),Aa=QR(s);return{totalLibrary:I,readCount:U,unreadCount:W,readPct:fe,wishlistCount:Ee,seriesMap:Oe,monthlyReads:Te,prevYearReads:rt,currentYearReadsTotal:wt,weekdayBreakdown:ot,topSeriesBars:$t,releases:Dt,nextRelease:dn,avgDays:et,purchaseToReadSeries:Ir,collectionValue:it,pages:tt,avgRating:Yt,topPublishers:ds,topGenres:ba,topDemographics:Ra,seriesAggregates:Aa}},[s,l,En]),{totalLibrary:qn,readCount:Mr,unreadCount:Er,readPct:Fr,wishlistCount:Hn,seriesMap:hr,monthlyReads:Ns,prevYearReads:Zn,currentYearReadsTotal:Ur,weekdayBreakdown:Et,topSeriesBars:ks,releases:Ft,nextRelease:rn,avgDays:fr,purchaseToReadSeries:Dn,collectionValue:Vn,pages:sn,avgRating:Tr,topPublishers:er,topGenres:os,topDemographics:_t,seriesAggregates:tr}=As,Ct=rn?rn.date:null,P=!!v,Z=j.useMemo(()=>{if(!s||!s.length)return[];const I=new Map;s.forEach(W=>{const fe=fd(W)||W.id,Ee=OR(W);I.has(fe)||I.set(fe,{seriesKey:fe,displayName:Ee,books:[]}),I.get(fe).books.push(W)});const U=Array.from(I.values()).map(W=>({...W,books:[...W.books].sort(MR)}));return U.sort((W,fe)=>W.displayName.localeCompare(fe.displayName)),U},[s]),oe=j.useMemo(()=>Z.flatMap(I=>I.books.map(U=>U.id)),[Z]);j.useEffect(()=>{re&&(s.some(I=>I.id===re)||le(null))},[s,re]),j.useEffect(()=>{X&&(Z.some(I=>I.seriesKey===X)||ge(null))},[Z,X]),j.useEffect(()=>{if(!xe.size)return;const I=new Set(s.map(W=>W.id)),U=Array.from(xe).filter(W=>!I.has(W));U.length&&Se(W=>{const fe=new Set(W);return U.forEach(Ee=>fe.delete(Ee)),fe})},[s,xe]),j.useEffect(()=>{const I=Array.from(xe);if(!I.length){L("");return}const U=Array.from(new Set(I.map(W=>s.find(fe=>fe.id===W)).filter(Boolean).map(W=>{const fe=W.amountPaid??W.AmountPaid??"";return fe==null?"":String(fe)})));L(U.length===1?U[0]:"")},[xe,s]),j.useEffect(()=>{const I=Z.find(it=>it.seriesKey===X);if(!I){S(ef());return}const U=I.books,W=it=>{const tt=Array.from(new Set(U.map(Yt=>{const Ir=it(Yt);return Ir==null?"":String(Ir).trim()})));return tt.length===1?tt[0]:""},fe=W(it=>it.publisher||it.Publisher),Ee=W(it=>it.demographic||it.Demographic),Oe=W(it=>it.genre||it.Genre),Te=W(it=>it.subGenre||it.SubGenre),rt=W(it=>it.msrp??it.MSRP),wt=Array.from(new Set(U.map(it=>(it.datePurchased||it.DatePurchased||"").trim()).filter(Boolean))),ot=wt.length>1,$t=ot?"":wt[0]||"",Dt=U.filter(it=>!!it.read||it.status==="Read"||it.Read===!0).length,dn=Dt===U.length&&U.length>0;S({publisher:fe,demographic:Ee,genre:Oe,subGenre:Te,datePurchased:$t,msrp:rt,initialPublisher:fe,initialDemographic:Ee,initialGenre:Oe,initialSubGenre:Te,initialDatePurchased:$t,initialMsrp:rt,dateMixed:ot,readChecked:dn,readIndeterminate:!dn&&!(Dt===0)})},[Z,X]),j.useEffect(()=>{M.current&&(M.current.indeterminate=D.readIndeterminate)},[D.readIndeterminate]),j.useEffect(()=>{const I=s.find(W=>W.id===re);if(!I){me(qv());return}const U=!!I.read||I.status==="Read"||I.Read===!0;me({read:U,datePurchased:I.datePurchased||I.DatePurchased||"",dateRead:U&&(I.dateRead||I.DateRead)||"",pageCount:I.pageCount??I.PageCount??I.pages??I.Pages??"",msrp:I.msrp??I.MSRP??"",amountPaid:I.amountPaid??I.AmountPaid??"",rating:U?I.rating??I.Rating??"":"",special:!!(I.specialType||I.SpecialType),specialType:I.specialType??I.SpecialType??"",specialVolumes:I.specialVolumes??I.SpecialVolumes??"",collectiblePrice:I.collectiblePrice??I.CollectiblePrice??"",publisher:I.publisher||I.Publisher||"",demographic:I.demographic||I.Demographic||"",genre:I.genre||I.Genre||""})},[re,s]),j.useEffect(()=>{if(!Zn||!Zn.length)return;const I=En-1,U=Zn.reduce((Oe,Te)=>Oe+Te.value,0);if(!U||(At.current?parseInt(At.current,10):null)===I)return;const fe=Zn.map(Oe=>`${Oe.label}: ${Oe.value}`).join(", "),Ee=`Yearly reads summary for ${I}: ${U} total. Breakdown: ${fe}`;tf($.yearly,Ee).then(()=>{At.current=String(I),typeof window<"u"&&localStorage.setItem("dashboard-yearly-posted",String(I))})},[Zn,En]),j.useEffect(()=>{if(!rn||!Ft.length)return;const I=El(rn.date),U=El(new Date);if(I>U||Ye.current===I)return;const W=Ft.filter(Ee=>El(Ee.date)===I);if(!W.length)return;const fe=`Wishlist releases for ${I}:
${W.map(Ee=>`- ${Ee.title}`).join(`
`)}`;tf($.release,fe).then(()=>{Ye.current=I,typeof window<"u"&&localStorage.setItem("dashboard-release-posted",I)})},[rn,Ft]),j.useEffect(()=>{if(!Ct){C("-");return}const I=()=>{const W=Ct-new Date;if(W<=0){C("Released");return}const fe=Math.floor(W/1e3),Ee=Math.floor(fe/86400),Oe=Math.floor(fe%86400/3600).toString().padStart(2,"0"),Te=Math.floor(fe%3600/60).toString().padStart(2,"0"),rt=Math.floor(fe%60).toString().padStart(2,"0");C(`${Ee}d ${Oe}:${Te}:${rt}`)};I();const U=setInterval(I,1e3);return()=>clearInterval(U)},[Ct]),j.useEffect(()=>{if(!(typeof window>"u"))try{const I=localStorage.getItem($v);if(!I)return;const U=JSON.parse(I);if(!Array.isArray(U))return;const W=U.map(fe=>({message:fe.message,ts:fe.ts?new Date(fe.ts):new Date})).filter(fe=>fe.message);W.length&&We(W)}catch(I){console.warn("Failed to load activity log",I)}},[]);const B=async()=>{try{const I=await xs(An(nt,"library"));a(I.docs.map(U=>({id:U.id,...U.data()})))}catch(I){console.error("Failed to refresh library",I),w(U=>U||"Failed to refresh library data.")}},K=I=>{const U=(I??"").toString().trim();if(U==="")return"";const W=parseFloat(U);return Number.isFinite(W)?W:""},Ne=I=>{const U=(I??"").toString().trim();if(U==="")return"";const W=parseInt(U,10);return Number.isFinite(W)?W:""},Le=I=>{try{const U=I.slice(0,100).map(W=>({message:W.message,ts:W.ts instanceof Date?W.ts.toISOString():W.ts}));typeof window<"u"&&localStorage.setItem($v,JSON.stringify(U))}catch(U){console.warn("Failed to persist activity log",U)}},Pt=I=>{if(!I)return;const U={message:I,ts:new Date};We(Ee=>{const Oe=[U,...Ee].slice(0,100);return Le(Oe),Oe});const W=(n==null?void 0:n.email)||"anonymous",fe=`Activity: ${I}
User: ${W}
Time: ${new Date().toLocaleString()}`;tf($.activity,fe).catch(Ee=>console.warn("Activity webhook failed",Ee))},we=I=>{F(U=>{const W=new Set(U);return W.has(I)?W.delete(I):W.add(I),W}),ge(I),le(null)},Ke=(I,U,W)=>{const fe=I.metaKey||I.ctrlKey,Ee=I.shiftKey,Oe=oe.indexOf(U);let Te=new Set(xe);if(Ee&&N!==null&&Oe!==-1){const rt=Math.min(N,Oe),wt=Math.max(N,Oe);for(let ot=rt;ot<=wt;ot+=1){const $t=oe[ot];$t&&Te.add($t)}}else fe?Te.has(U)?Te.delete(U):Te.add(U):Te=new Set;Se(Te),R(Oe),le(U),ge(W),F(rt=>{const wt=new Set(rt);return wt.add(W),wt})},ht=()=>{Se(new Set),R(null)},Tn=async()=>{if(!e){alert("Dashboard is read-only for your account.");return}const I=Array.from(xe);if(!I.length){alert("Select books in Library Manager (use Ctrl/Cmd or Shift) before bulk editing.");return}const U=(k||"").toString().trim(),W=U!=="",fe=K(U);if(W&&fe===""){alert("Enter a valid number for Amount Paid.");return}try{await Promise.all(I.map(Ee=>Ts(Ot(nt,"library",Ee),{amountPaid:W?fe:""}))),await B(),ht(),Pt(`Updated amount paid for ${I.length} book${I.length===1?"":"s"} in library`),alert(`Applied Amount Paid to ${I.length} selection${I.length===1?"":"s"}.`)}catch(Ee){console.error("Failed to apply Amount Paid",Ee),alert("Failed to apply Amount Paid to selection.")}},Ln=async()=>{if(!e){alert("Dashboard is read-only for your account.");return}const I=Z.find(Dt=>Dt.seriesKey===X);if(!I||!I.books.length)return;const U=!D.readIndeterminate,W=!!D.readChecked,fe=D.datePurchased!==D.initialDatePurchased,Ee=D.msrp!==D.initialMsrp,Oe=D.publisher!==D.initialPublisher,Te=D.demographic!==D.initialDemographic,rt=D.genre!==D.initialGenre,wt=D.subGenre!==D.initialSubGenre;if(!U&&!fe&&!Ee&&!Oe&&!Te&&!rt&&!wt)return;const ot=String(D.msrp??"").trim(),$t=Ee?K(ot):"";if(Ee&&ot!==""&&$t===""){alert("Enter a valid number for MSRP.");return}try{const Dt=[];if(I.books.forEach(dn=>{const et={};U&&(et.read=W,et.dateRead=W?dn.dateRead||dn.DateRead||new Date().toISOString().slice(0,10):""),fe&&(et.datePurchased=D.datePurchased||""),Ee&&(et.msrp=D.msrp===""?"":$t),Oe&&(et.publisher=D.publisher||""),Te&&(et.demographic=D.demographic||""),rt&&(et.genre=D.genre||""),wt&&(et.subGenre=D.subGenre||""),Object.keys(et).length&&Dt.push(Ts(Ot(nt,"library",dn.id),et))}),!Dt.length)return;await Promise.all(Dt),await B(),le(null),Pt(`Updated series "${I.displayName||"Series"}" (${I.books.length} book${I.books.length===1?"":"s"})`),alert("Series updated.")}catch(Dt){console.error("Failed to save series changes",Dt),alert("Failed to update series.")}},ls=async()=>{if(!e){alert("Dashboard is read-only for your account.");return}if(!re)return;const I=!!ce.read,U=String(ce.msrp??"").trim(),W=String(ce.amountPaid??"").trim(),fe=String(ce.pageCount??"").trim(),Ee=String(ce.rating??"").trim(),Oe=K(U),Te=K(W),rt=Ne(fe),wt=K(Ee);if(U!==""&&Oe===""){alert("Enter a valid number for MSRP.");return}if(W!==""&&Te===""){alert("Enter a valid number for Amount Paid.");return}if(fe!==""&&rt===""){alert("Enter a valid page count.");return}if(I&&Ee!==""&&wt===""){alert("Enter a valid rating.");return}const ot=!!ce.special,$t=Ne(ce.specialVolumes),Dt=K(ce.collectiblePrice),dn=String(ce.specialVolumes??"").trim(),et=String(ce.collectiblePrice??"").trim();if(ot&&ce.specialType==="specialEdition"&&dn!==""&&$t===""){alert("Enter a valid number for volumes contained.");return}if(ot&&ce.specialType==="collectible"&&et!==""&&Dt===""){alert("Enter a valid collectible price.");return}const it=I?ce.dateRead||new Date().toISOString().slice(0,10):"",tt={read:I,datePurchased:ce.datePurchased||"",dateRead:it,msrp:ce.msrp===""?"":Oe,amountPaid:ce.amountPaid===""?"":Te,pageCount:ce.pageCount===""?"":rt,rating:I?ce.rating===""?"":wt:"",specialType:ot&&ce.specialType||"",specialVolumes:ot&&ce.specialType==="specialEdition"?ce.specialVolumes===""?"":$t:"",collectiblePrice:ot&&ce.specialType==="collectible"?ce.collectiblePrice===""?"":Dt:""};try{await Ts(Ot(nt,"library",re),tt),await B();const Yt=s.find(ds=>ds.id===re)||yt,Ir=(Yt==null?void 0:Yt.Title)||(Yt==null?void 0:Yt.title)||"Untitled";Pt(`Updated "${Ir}" in library`),alert("Saved changes.")}catch(Yt){console.error("Failed to save book changes",Yt),alert("Failed to save changes.")}},zr=()=>{ge(null),le(null),ht(),S(ef())},js=()=>{le(null),R(null)},Ds=Z.find(I=>I.seriesKey===X)||null,yt=s.find(I=>I.id===re)||null,ft=X?{msrp:!D.msrp,datePurchased:!D.datePurchased&&!D.dateMixed,publisher:!D.publisher,demographic:!D.demographic,genre:!D.genre}:{},pr=re?FR({amountPaid:ce.amountPaid,msrp:ce.msrp,datePurchased:ce.datePurchased,publisher:(yt==null?void 0:yt.publisher)||(yt==null?void 0:yt.Publisher)||"",demographic:(yt==null?void 0:yt.demographic)||(yt==null?void 0:yt.Demographic)||"",genre:(yt==null?void 0:yt.genre)||(yt==null?void 0:yt.Genre)||"",special:ce.special,specialType:ce.specialType,specialVolumes:ce.specialVolumes,collectiblePrice:ce.collectiblePrice,pageCount:ce.pageCount}):{};if(t)return c.jsx("div",{className:"page dashboard-page",children:c.jsxs("div",{className:"dashboard-loading",children:[c.jsx("h1",{children:"Dashboard"}),c.jsx("p",{children:"Checking permissions..."})]})});if(!n||!e)return c.jsx("div",{className:"page dashboard-page",children:c.jsxs("div",{className:"dashboard-locked",children:[c.jsx("h1",{children:"Dashboard"}),c.jsx("p",{children:"This area is restricted to admin accounts."})]})});if(f)return c.jsx("div",{className:"page dashboard-page",children:c.jsxs("div",{className:"dashboard-loading",children:[c.jsx("h1",{children:"Dashboard"}),v?c.jsx("p",{className:"error",children:v}):c.jsx("p",{children:"Loading stats..."})]})});const cs=qn+Hn,Br=cs?Math.round(qn/cs*100):0,Gn=[...hr.values()].filter(I=>I.ratingCount>0).map(I=>({title:I.title,avg:I.ratingSum/I.ratingCount,count:I.ratingCount})).sort((I,U)=>U.avg-I.avg||U.count-I.count).slice(0,3);function Gi(){if(Ct)jn(new Date(Ct.getFullYear(),Ct.getMonth(),1));else if(Ft.length){const I=Ft[0].date;jn(new Date(I.getFullYear(),I.getMonth(),1))}tn(!0)}function Sr(I){nn({open:!0,type:I})}function us(){nn({open:!1,type:null})}const Kn=El(new Date),Pa=eA(Bt,Ft,Kn);function Sn(){const I=Rt.type;if(!I)return null;if(I==="publishers"){const U=[...oo(hr,"publisher",100)];return c.jsxs(c.Fragment,{children:[c.jsx("h3",{children:"Top Publishers by Series"}),U.length===0?c.jsx("p",{children:"No publisher data yet."}):c.jsxs("table",{children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"#"}),c.jsx("th",{children:"Publisher"}),c.jsx("th",{children:"Series Count"})]})}),c.jsx("tbody",{children:U.map((W,fe)=>c.jsxs("tr",{children:[c.jsx("td",{children:fe+1}),c.jsx("td",{children:W.name}),c.jsx("td",{children:W.count})]},W.name+fe))})]})]})}if(I==="genres"){const U=[...oo(hr,"genre",100)];return c.jsxs(c.Fragment,{children:[c.jsx("h3",{children:"Top Genres by Series"}),U.length===0?c.jsx("p",{children:"No genre data yet."}):c.jsxs("table",{children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"#"}),c.jsx("th",{children:"Genre"}),c.jsx("th",{children:"Series Count"})]})}),c.jsx("tbody",{children:U.map((W,fe)=>c.jsxs("tr",{children:[c.jsx("td",{children:fe+1}),c.jsx("td",{children:W.name}),c.jsx("td",{children:W.count})]},W.name+fe))})]})]})}if(I==="demographics"){const U=[...oo(hr,"demographic",100)];return c.jsxs(c.Fragment,{children:[c.jsx("h3",{children:"Top Demographics by Series"}),U.length===0?c.jsx("p",{children:"No demographic data yet."}):c.jsxs("table",{children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"#"}),c.jsx("th",{children:"Demographic"}),c.jsx("th",{children:"Series Count"})]})}),c.jsx("tbody",{children:U.map((W,fe)=>c.jsxs("tr",{children:[c.jsx("td",{children:fe+1}),c.jsx("td",{children:W.name}),c.jsx("td",{children:W.count})]},W.name+fe))})]})]})}if(I==="timeToRead"){const U=Dn||[];return c.jsxs(c.Fragment,{children:[c.jsx("h3",{children:"Average Time From Purchase to Read"}),fr==null?c.jsx("p",{children:"Not enough volumes have both purchase and read dates to calculate this yet."}):c.jsxs(c.Fragment,{children:[c.jsxs("p",{children:["On average, it takes"," ",c.jsxs("strong",{children:[fr.toFixed(1)," days"]})," from purchase to finishing a volume."]}),U.length>0?c.jsxs("table",{children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"Series"}),c.jsx("th",{children:"Avg Days"}),c.jsx("th",{children:"Longest"}),c.jsx("th",{children:"Shortest"}),c.jsx("th",{children:"Reads Count"})]})}),c.jsx("tbody",{children:U.map(W=>c.jsxs("tr",{children:[c.jsx("td",{children:W.title}),c.jsxs("td",{children:[W.avg.toFixed(1)," days"]}),c.jsxs("td",{children:[Math.round(W.max)," days"]}),c.jsxs("td",{children:[Math.round(W.min)," days"]}),c.jsx("td",{children:W.count})]},W.key))})]}):c.jsx("p",{style:{marginTop:8},children:"No series-level data yet."})]})]})}if(I==="collectionValue"){const{msrpTotal:U,paidTotal:W}=Vn,fe=U-W,Ee=U>0?(W/U*100).toFixed(1):"-",Oe=[...tr].filter(Te=>Te.msrp||Te.paid||Te.collectible).sort((Te,rt)=>rt.msrp+rt.collectible-(Te.msrp+Te.collectible));return c.jsxs(c.Fragment,{children:[c.jsx("h3",{children:"Collection Value Breakdown"}),c.jsx("table",{children:c.jsxs("tbody",{children:[c.jsxs("tr",{children:[c.jsx("th",{children:"Total MSRP"}),c.jsxs("td",{children:["$",U.toFixed(2)]})]}),c.jsxs("tr",{children:[c.jsx("th",{children:"Total Paid"}),c.jsxs("td",{children:["$",W.toFixed(2)]})]}),c.jsxs("tr",{children:[c.jsx("th",{children:"Difference"}),c.jsxs("td",{children:["$",fe.toFixed(2)]})]}),c.jsxs("tr",{children:[c.jsx("th",{children:"Paid vs MSRP"}),c.jsx("td",{children:Ee==="-"?"-":`${Ee}%`})]})]})}),Oe.length>0&&c.jsxs(c.Fragment,{children:[c.jsx("h4",{style:{marginTop:"14px"},children:"Collection Pricing"}),c.jsxs("table",{children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"Title"}),c.jsx("th",{children:"MSRP"}),c.jsx("th",{children:"Paid"}),c.jsx("th",{children:"Collectible"}),c.jsx("th",{children:"Books"})]})}),c.jsx("tbody",{children:Oe.map((Te,rt)=>c.jsxs("tr",{children:[c.jsx("td",{children:Te.title}),c.jsxs("td",{children:["$",Te.msrp.toFixed(2)]}),c.jsxs("td",{children:["$",Te.paid.toFixed(2)]}),c.jsx("td",{children:Te.collectible?`$${Te.collectible.toFixed(2)}`:"--"}),c.jsx("td",{children:Te.books})]},Te.title+rt))})]})]})]})}if(I==="pages"){const U=[...tr].filter(W=>W.pages>0).map(W=>({...W,pct:W.pages?Math.round(W.readPages/W.pages*100):0})).sort((W,fe)=>fe.pages-W.pages);return c.jsxs(c.Fragment,{children:[c.jsx("h3",{children:"Pages Read vs Total"}),c.jsx("table",{children:c.jsxs("tbody",{children:[c.jsxs("tr",{children:[c.jsx("th",{children:"Total Pages"}),c.jsx("td",{children:sn.total.toLocaleString()})]}),c.jsxs("tr",{children:[c.jsx("th",{children:"Pages Read"}),c.jsx("td",{children:sn.read.toLocaleString()})]}),c.jsxs("tr",{children:[c.jsx("th",{children:"Completion"}),c.jsx("td",{children:sn.total?`${(sn.read/sn.total*100).toFixed(1)}%`:"-"})]})]})}),U.length>0&&c.jsxs(c.Fragment,{children:[c.jsx("h4",{style:{marginTop:"14px"},children:"Pages by Series"}),c.jsxs("table",{children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"Title"}),c.jsx("th",{children:"Read Pages"}),c.jsx("th",{children:"Total Pages"}),c.jsx("th",{children:"% Read"}),c.jsx("th",{children:"Books"})]})}),c.jsx("tbody",{children:U.map((W,fe)=>c.jsxs("tr",{children:[c.jsx("td",{children:W.title}),c.jsx("td",{children:W.readPages.toLocaleString()}),c.jsx("td",{children:W.pages.toLocaleString()}),c.jsxs("td",{children:[W.pct,"%"]}),c.jsx("td",{children:W.books})]},W.title+fe))})]})]})]})}if(I==="ratings"){const U=[...tr].map(W=>{if(!W.ratings.length)return null;const fe=W.ratings.reduce((Ee,Oe)=>Ee+Oe,0)/W.ratings.length;return{title:W.title,avg:fe,count:W.ratings.length}}).filter(Boolean).sort((W,fe)=>fe.avg-W.avg||fe.count-W.count);return c.jsxs(c.Fragment,{children:[c.jsx("h3",{children:"Ratings Overview"}),Tr==null?c.jsx("p",{children:"No ratings have been recorded yet."}):c.jsxs("p",{children:["Average series rating across rated series is"," ",c.jsx("strong",{children:Tr.toFixed(2)}),"."]}),U.length>0&&c.jsxs(c.Fragment,{children:[c.jsx("h4",{style:{marginTop:"14px"},children:"Series Averages"}),c.jsxs("table",{children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"Title"}),c.jsx("th",{children:"Avg"}),c.jsx("th",{children:"Ratings"})]})}),c.jsx("tbody",{children:U.map((W,fe)=>c.jsxs("tr",{children:[c.jsx("td",{children:W.title}),c.jsx("td",{children:W.avg.toFixed(2)}),c.jsx("td",{children:W.count})]},W.title+fe))})]})]})]})}return I==="releases"?c.jsxs(c.Fragment,{children:[c.jsx("h3",{children:"Wishlist Releases"}),Ft.length===0?c.jsx("p",{children:"No wishlist releases found."}):c.jsxs("table",{children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"Date"}),c.jsx("th",{children:"Title"})]})}),c.jsx("tbody",{children:Ft.map((U,W)=>c.jsxs("tr",{children:[c.jsx("td",{children:U.date.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}),c.jsx("td",{children:U.title})]},W))})]})]}):null}return c.jsxs("div",{className:"page dashboard-page",children:[c.jsxs("header",{className:"dashboard-header",style:{display:"flex",alignItems:"center",justifyContent:"center",position:"relative",textAlign:"center",width:"100%"},children:[c.jsxs("div",{style:{textAlign:"center",margin:"0 auto",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"0 60px"},children:[c.jsx("h1",{style:{margin:0,fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Dashboard"}),c.jsx("p",{className:"dashboard-sub",style:{textAlign:"center",margin:"6px 0 0"},children:"My Entire Statistics dashboard for my Manga. I still use Excel though."})]}),e&&c.jsx("div",{style:{position:"absolute",right:0,top:"50%",transform:"translateY(-50%)"},children:c.jsx("button",{className:"stat-link",onClick:()=>ne(!0),type:"button",children:"Admin Settings"})})]}),c.jsx("section",{id:"dashboardSection",className:"page-section active",children:c.jsxs("div",{className:"dashboard-grid",children:[c.jsxs("div",{className:"stat-stack",children:[c.jsxs("div",{className:"stat-card mini",children:[c.jsx("h3",{children:"Total Library Books"}),c.jsx("div",{className:"stat-value",children:qn}),c.jsx("div",{className:"stat-sub",children:"Volumes in your library."})]}),c.jsxs("div",{className:"stat-card mini",children:[c.jsx("h3",{children:"Wishlist Items"}),c.jsx("div",{className:"stat-value",children:Hn}),c.jsx("div",{className:"stat-sub",children:"Tracked upcoming wants."})]})]}),c.jsxs("div",{className:"stat-card",children:[c.jsx("h3",{children:"Read / Unread"}),c.jsx("div",{className:"pie",style:{"--pct":`${Fr*3.6}deg`},children:c.jsxs("div",{className:"pie-label",children:[Fr,"%"]})}),c.jsxs("div",{className:"stat-value",children:[Mr," read / ",Er," unread"]})]}),c.jsxs("div",{className:"stat-card clickable",onClick:()=>Sr("ratings"),children:[c.jsx("h3",{children:"Ratings"}),c.jsx("div",{className:"stat-value",children:Tr==null?"-":Tr.toFixed(2)}),c.jsx("div",{className:"stat-sub",children:"Average across rated series."}),c.jsx("div",{className:"stat-list compact",children:Gn.length?Gn.map((I,U)=>c.jsxs("div",{className:"stat-list-row",children:[c.jsx("span",{className:"stat-rank",children:U+1}),c.jsx("span",{className:"stat-name",children:I.title}),c.jsx("span",{className:"stat-count",children:I.avg.toFixed(2)})]},I.title+U)):c.jsx("div",{className:"stat-sub",children:"No ratings yet."})})]}),c.jsxs("div",{className:"stat-card clickable",onClick:()=>Sr("pages"),children:[c.jsx("h3",{children:"Page Count Read / Total"}),c.jsxs("div",{className:"stat-value",children:[sn.read.toLocaleString()," / ",sn.total.toLocaleString()]}),c.jsx("div",{className:"stat-sub",children:sn.total?`${(sn.read/sn.total*100).toFixed(1)}% read`:"-"})]}),c.jsxs("div",{className:"stat-card",children:[c.jsx("h3",{children:"Library vs Wishlist"}),c.jsx("div",{className:"pie",style:{"--pct":`${Br*3.6}deg`},children:c.jsxs("div",{className:"pie-label",children:[Br,"%"]})}),c.jsxs("div",{className:"stat-value",children:[qn," / ",Hn]}),c.jsx("div",{className:"stat-sub",children:"Library vs wishlist share"})]}),c.jsxs("div",{className:"stat-card clickable",onClick:()=>Sr("demographics"),children:[c.jsx("h3",{children:"Top Demographics"}),c.jsx("div",{className:"stat-list",children:_t.length?_t.slice(0,3).map((I,U)=>c.jsxs("div",{className:"stat-list-row",children:[c.jsx("span",{className:"stat-rank",children:U+1}),c.jsx("span",{className:"stat-name",children:I.name}),c.jsx("span",{className:"stat-count",children:I.count})]},I.name)):c.jsx("div",{className:"stat-sub",children:"No demographic data yet."})})]}),c.jsxs("div",{className:"stat-card clickable",onClick:()=>Sr("publishers"),children:[c.jsx("h3",{children:"Top Publishers"}),c.jsx("div",{className:"stat-list",children:er.length?er.slice(0,3).map((I,U)=>c.jsxs("div",{className:"stat-list-row",children:[c.jsx("span",{className:"stat-rank",children:U+1}),c.jsx("span",{className:"stat-name",children:I.name}),c.jsx("span",{className:"stat-count",children:I.count})]},I.name)):c.jsx("div",{className:"stat-sub",children:"No publisher data yet."})})]}),c.jsxs("div",{className:"stat-card clickable",onClick:()=>Sr("genres"),children:[c.jsx("h3",{children:"Top Genres"}),c.jsx("div",{className:"stat-list",children:os.length?os.slice(0,3).map((I,U)=>c.jsxs("div",{className:"stat-list-row",children:[c.jsx("span",{className:"stat-rank",children:U+1}),c.jsx("span",{className:"stat-name",children:I.name}),c.jsx("span",{className:"stat-count",children:I.count})]},I.name)):c.jsx("div",{className:"stat-sub",children:"No genre data yet."})})]}),c.jsxs("div",{className:"stat-card clickable",onClick:()=>{Gi()},children:[c.jsx("h3",{children:"Next Wishlist Release"}),c.jsx("div",{className:"stat-value next-release",children:rn?rn.title:"No upcoming releases"}),c.jsxs("div",{className:"stat-sub",children:[Ct?Ct.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"}):"-",c.jsx("br",{}),c.jsx("span",{id:"statNextCountdown",children:E})]})]}),c.jsxs("div",{className:"stat-card clickable",onClick:()=>Sr("collectionValue"),style:{textAlign:"center"},children:[c.jsx("h3",{children:"Collection Pricing"}),c.jsxs("div",{className:"stat-value stat-msrp",children:["$",Vn.msrpTotal.toFixed(2)]}),c.jsxs("div",{className:"stat-value stat-paid",children:["$",Vn.paidTotal.toFixed(2),Vn.msrpTotal>0&&c.jsxs("span",{className:"stat-paid-pct",children:["(",((1-Vn.paidTotal/Vn.msrpTotal)*100).toFixed(1),"% off)"]})]}),c.jsxs("div",{className:"stat-value stat-collectible",children:["$",Vn.collectibleTotal.toFixed(2)]}),c.jsx("div",{className:"stat-sub",children:"MSRP  Paid  Collectible overrides"})]}),c.jsxs("div",{className:"stat-card",children:[c.jsx("h3",{children:"Current Year Reads"}),c.jsx("div",{className:"stat-value",children:Ur}),c.jsxs("div",{className:"stat-sub",children:["Reads in ",En]})]}),c.jsxs("div",{className:"stat-card clickable",onClick:()=>Sr("timeToRead"),children:[c.jsx("h3",{children:"Avg Days From Purchase to Read"}),c.jsx("div",{className:"stat-value",children:fr==null?"-":`${fr.toFixed(1)} days`}),c.jsx("div",{className:"stat-sub",children:"When both dates exist"})]}),c.jsxs("div",{className:"stat-duo",children:[c.jsxs("div",{className:"stat-card tall",children:[c.jsxs("h3",{children:["Reads Per Month (",En,")"]}),c.jsx(XR,{data:Ns})]}),c.jsxs("div",{className:"stat-card tall",children:[c.jsx("h3",{children:"Reads by Day of Week (Lifetime)"}),c.jsx(ZR,{data:Et}),c.jsx("div",{className:"stat-sub",children:"Based on all entries with a read date."})]})]}),c.jsxs("div",{className:"stat-card wide",children:[c.jsx("h3",{children:"Activity Log"}),P&&c.jsx("div",{className:"error",style:{textAlign:"center"},children:v}),c.jsx("div",{className:"activity-log scrollable",children:dt.length?dt.map((I,U)=>{const W=I.ts?new Date(I.ts):null;return c.jsxs("div",{className:"activity-row",children:[c.jsx("span",{className:"activity-title",children:I.message}),c.jsx("span",{className:"activity-date",children:W?W.toLocaleString(void 0,{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}):""})]},(I.message||"activity")+U)}):c.jsx("div",{className:"stat-sub",children:"No recent activity yet."})})]}),c.jsxs("div",{className:"stat-card wide",style:{minHeight:"340px",maxHeight:"480px"},children:[c.jsx("h3",{children:"Suggestions"}),bt&&c.jsx("div",{className:"error",style:{textAlign:"center"},children:bt}),c.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",alignItems:"stretch"},children:["anime","manga"].map(I=>{const U=Ue.filter(W=>(W.type||"").toLowerCase()===I).sort((W,fe)=>{var Ee,Oe,Te,rt;return(((Oe=(Ee=fe.createdAt)==null?void 0:Ee.getTime)==null?void 0:Oe.call(Ee))||0)-(((rt=(Te=W.createdAt)==null?void 0:Te.getTime)==null?void 0:rt.call(Te))||0)});return c.jsxs("div",{style:{border:"1px solid rgba(255,182,193,0.18)",borderRadius:"16px",padding:"10px 12px",display:"flex",flexDirection:"column",background:"rgba(255,182,193,0.04)",minHeight:"240px"},children:[c.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"8px",position:"relative"},children:[c.jsx("h4",{style:{margin:0,color:"#ffb6c1",textAlign:"center",flex:1},children:I==="anime"?"Anime":"Manga"}),c.jsxs("span",{className:"stat-sub",style:{position:"absolute",right:0},children:[U.length," suggestion",U.length===1?"":"s"]})]}),c.jsx("div",{className:"scrollable",style:{maxHeight:"280px",height:"280px",paddingRight:"4px",overflowY:"auto"},children:Qe?c.jsx("div",{className:"stat-sub",children:"Loading suggestions..."}):U.length?U.map(W=>{const fe=W.createdAt instanceof Date?W.createdAt:W.createdAt?new Date(W.createdAt):null;return c.jsxs("div",{style:{border:"1px solid rgba(255,182,193,0.25)",borderRadius:"12px",padding:"8px 10px",marginBottom:"8px",background:"rgba(255,182,193,0.06)",display:"grid",gridTemplateColumns:"1fr auto",gap:"6px",alignItems:"center"},children:[c.jsxs("div",{children:[c.jsx("div",{style:{fontWeight:600,color:"#f7d0dc"},children:W.content||"(no content)"}),c.jsxs("div",{className:"stat-sub",style:{fontSize:"0.8rem"},children:[fe?fe.toLocaleString(void 0,{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}):""," ",W.from?` ${W.from}`:""]})]}),c.jsx("div",{style:{display:"flex",gap:"6px"},children:e&&c.jsx("button",{type:"button",className:"stat-link",onClick:()=>Xn(W.id),children:"Delete"})})]},W.id)}):c.jsx("div",{className:"stat-sub",children:"No suggestions yet."})})]},I)})}),c.jsxs("div",{className:"stat-sub",style:{marginTop:"8px",textAlign:"center"},children:["Total suggestions: ",Ue.length]})]}),c.jsxs("div",{className:"stat-card wide",children:[c.jsx("h3",{children:"Library Manager"}),Z.length?c.jsxs("div",{className:"dash-library",children:[c.jsxs("div",{className:"dash-library-list",children:[Z.map(I=>{const U=I.books.filter(Te=>!!Te.read||Te.status==="Read"||Te.Read===!0).length,W=Y.has(I.seriesKey),fe=X===I.seriesKey&&!re,Ee=UR(I),Oe=I.books.some(Te=>Hv(Te));return c.jsxs("div",{style:{marginBottom:"8px"},children:[c.jsxs("button",{type:"button",onClick:()=>we(I.seriesKey),style:{width:"100%",textAlign:"left",background:Ee?"rgba(255,179,71,0.08)":"transparent",border:`1px solid ${fe?"#ff69b4":Ee?"rgba(255,179,71,0.6)":"rgba(255,182,193,0.25)"}`,color:"#ffb6c1",padding:"8px",borderRadius:"8px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"8px",position:"relative",boxShadow:Ee?"0 0 10px rgba(255,179,71,0.5)":fe?"0 0 8px rgba(255,105,180,0.5)":"none"},children:[c.jsx("span",{style:{transition:"transform 0.2s ease",transform:W?"rotate(90deg)":"none"},children:">"}),c.jsx("span",{style:{flex:1},children:I.displayName}),c.jsxs("span",{style:{fontSize:"11px",color:"#f8d1d8"},children:[I.books.length," book",I.books.length===1?"":"s",I.books.length?`  ${U} read`:""]}),Oe&&c.jsx("span",{title:"Some volumes are missing required data",style:{width:"12px",height:"12px",borderRadius:"999px",background:"#ffb347",border:"1px solid rgba(255,255,255,0.25)",boxShadow:"0 0 10px rgba(255,179,71,0.6)"}})]}),c.jsx("div",{style:{margin:"6px 0 10px 10px",paddingLeft:"10px",borderLeft:"1px solid rgba(255,182,193,0.25)",display:W?"block":"none"},children:I.books.map(Te=>{const rt=re===Te.id,wt=xe.has(Te.id);Te.read||Te.status==="Read"||Te.Read;const ot=Hv(Te,{ignoreShared:!0});return c.jsxs("button",{type:"button",onClick:$t=>Ke($t,Te.id,I.seriesKey),style:{width:"100%",textAlign:"left",background:ot?"rgba(255,179,71,0.1)":"transparent",border:`1px solid ${rt?"#ff69b4":wt?"#fff59d":ot?"rgba(255,179,71,0.6)":"rgba(255,182,193,0.25)"}`,color:"#ffb6c1",padding:"8px",borderRadius:"8px",marginBottom:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"8px",boxShadow:rt?"0 0 8px rgba(255,105,180,0.5)":wt?"0 0 10px rgba(255,255,180,0.65)":ot?"0 0 10px rgba(255,179,71,0.5)":"none"},children:[c.jsx("span",{style:{flex:1,minWidth:0},children:Te.Title||Te.title||"Untitled"}),ot&&c.jsx("span",{style:{flexShrink:0,padding:"2px 8px",borderRadius:"999px",background:"rgba(255,179,71,0.18)",border:"1px solid rgba(255,179,71,0.6)",color:"#ffd8a1",fontSize:"11px",fontWeight:700,whiteSpace:"nowrap"},children:"Missing data"})]},Te.id)})})]},I.seriesKey)}),Z.length>0&&xe.size>0&&c.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:c.jsx("button",{type:"button",style:{padding:"6px 12px",borderRadius:"999px",border:"1px solid #ffb6c1",background:"transparent",color:"#ffb6c1",cursor:"pointer"},onClick:ht,children:"Clear Selection"})})]}),c.jsxs("div",{className:"dash-library-details",children:[xe.size>0&&c.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px",padding:"10px",marginBottom:"10px",border:"1px dashed rgba(255,182,193,0.45)",borderRadius:"10px",background:"rgba(255,182,193,0.08)"},children:[c.jsxs("div",{children:["Apply Amount Paid to ",xe.size," selected book",xe.size===1?"":"s"]}),c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",flexWrap:"wrap"},children:[c.jsx("input",{type:"number",step:"0.01",min:"0",value:k,onChange:I=>L(I.target.value),style:{maxWidth:"140px"}}),c.jsx("button",{type:"button",className:"dash-btn primary",onClick:Tn,children:"Apply to Selected"})]})]}),!X&&!re&&c.jsx("div",{className:"stat-sub",style:{marginTop:6},children:"Select a series or book to edit"}),X&&!re&&Ds&&c.jsxs("div",{children:[c.jsx("div",{className:"dash-detail-title",children:Ds.displayName}),c.jsx("div",{className:"dash-detail-row",children:c.jsxs("label",{className:"inline-checkbox",children:[c.jsx("input",{ref:M,type:"checkbox",checked:D.readChecked,onChange:I=>S(U=>({...U,readChecked:I.target.checked,readIndeterminate:!1}))}),c.jsx("span",{children:"Mark series as read"})]})}),c.jsxs("div",{className:`dash-detail-row${ft.publisher?" missing-row":""}`,children:[c.jsx("span",{children:"Publisher"}),c.jsx("input",{type:"text",value:D.publisher,onChange:I=>S(U=>({...U,publisher:I.target.value})),placeholder:"Set publisher for series"})]}),c.jsxs("div",{className:`dash-detail-row${ft.demographic?" missing-row":""}`,children:[c.jsx("span",{children:"Demographic"}),c.jsxs("select",{value:D.demographic,onChange:I=>S(U=>({...U,demographic:I.target.value})),children:[c.jsx("option",{value:"",children:"Select Demographic"}),c.jsx("option",{value:"Shounen",children:"Shounen"}),c.jsx("option",{value:"Seinen",children:"Seinen"}),c.jsx("option",{value:"Shoujo",children:"Shoujo"}),c.jsx("option",{value:"Josei",children:"Josei"})]})]}),c.jsxs("div",{className:`dash-detail-row${ft.genre?" missing-row":""}`,children:[c.jsx("span",{children:"Genre"}),c.jsx("input",{type:"text",value:D.genre,onChange:I=>S(U=>({...U,genre:I.target.value})),placeholder:"Primary genre"})]}),c.jsxs("div",{className:"dash-detail-row",children:[c.jsx("span",{children:"Sub-Genre"}),c.jsx("input",{type:"text",value:D.subGenre,onChange:I=>S(U=>({...U,subGenre:I.target.value})),placeholder:"Secondary genre / theme"})]}),!D.dateMixed&&c.jsxs("div",{className:`dash-detail-row${ft.datePurchased?" missing-row":""}`,children:[c.jsx("span",{children:"Date Purchased"}),c.jsx("input",{type:"date",value:D.datePurchased,onChange:I=>S(U=>({...U,datePurchased:I.target.value}))})]}),c.jsxs("div",{className:`dash-detail-row${ft.msrp?" missing-row":""}`,children:[c.jsx("span",{children:"MSRP (per book)"}),c.jsx("input",{type:"number",step:"0.01",min:"0",value:D.msrp,onChange:I=>S(U=>({...U,msrp:I.target.value})),placeholder:"0.00"})]}),c.jsxs("div",{className:"dash-detail-actions",children:[c.jsx("button",{type:"button",className:"dash-btn secondary",onClick:zr,children:"Cancel"}),c.jsx("button",{type:"button",className:"dash-btn primary",onClick:Ln,children:"Save Series"})]})]}),re&&yt&&c.jsxs("div",{children:[c.jsx("div",{className:"dash-detail-title",children:yt.Title||yt.title||"Untitled"}),c.jsx("div",{className:"dash-detail-row",children:c.jsxs("label",{className:"inline-checkbox",children:[c.jsx("input",{type:"checkbox",checked:!!ce.read,onChange:I=>me(U=>({...U,read:I.target.checked,dateRead:I.target.checked?U.dateRead||new Date().toISOString().slice(0,10):"",rating:I.target.checked?U.rating:""}))}),c.jsx("span",{children:"Mark as read"})]})}),c.jsxs("div",{className:`dash-detail-row${pr.datePurchased?" missing-row":""}`,children:[c.jsx("span",{children:"Date Purchased"}),c.jsx("input",{type:"date",value:ce.datePurchased,onChange:I=>me(U=>({...U,datePurchased:I.target.value}))})]}),ce.read&&c.jsxs("div",{className:"dash-detail-row",children:[c.jsx("span",{children:"Date Read"}),c.jsx("input",{type:"date",value:ce.dateRead,onChange:I=>me(U=>({...U,dateRead:I.target.value}))})]}),c.jsxs("div",{className:`dash-detail-row${pr.pageCount?" missing-row":""}`,children:[c.jsx("span",{children:"Page Count"}),c.jsx("input",{type:"number",min:"0",step:"1",value:ce.pageCount,onChange:I=>me(U=>({...U,pageCount:I.target.value}))})]}),c.jsxs("div",{className:`dash-detail-row${pr.msrp?" missing-row":""}`,children:[c.jsx("span",{children:"MSRP (per book)"}),c.jsx("input",{type:"number",step:"0.01",min:"0",value:ce.msrp,onChange:I=>me(U=>({...U,msrp:I.target.value})),placeholder:"0.00"})]}),!(ce.special&&ce.specialType==="collectible")&&c.jsxs("div",{className:`dash-detail-row${pr.amountPaid?" missing-row":""}`,children:[c.jsx("span",{children:"Amount Paid"}),c.jsx("input",{type:"number",step:"0.01",min:"0",value:ce.amountPaid,onChange:I=>me(U=>({...U,amountPaid:I.target.value})),placeholder:"0.00"})]}),ce.read&&c.jsxs("div",{className:"dash-detail-row",children:[c.jsx("span",{children:"Star Rating"}),c.jsx("input",{type:"number",min:"0",max:"5",step:"0.5",value:ce.rating,onChange:I=>me(U=>({...U,rating:I.target.value})),placeholder:"0-5"})]}),c.jsx("div",{className:`dash-detail-row${pr.specialType?" missing-row":""}`,children:c.jsxs("label",{className:"inline-checkbox",style:{width:"100%"},children:[c.jsx("input",{type:"checkbox",checked:!!ce.special,onChange:I=>me(U=>({...U,special:I.target.checked,specialType:I.target.checked?U.specialType:"",specialVolumes:I.target.checked?U.specialVolumes:"",collectiblePrice:I.target.checked?U.collectiblePrice:""}))}),c.jsx("span",{children:"Special?"})]})}),ce.special&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:`dash-detail-row${pr.specialType?" missing-row":""}`,children:[c.jsx("span",{children:"Special Type"}),c.jsxs("select",{value:ce.specialType,onChange:I=>me(U=>({...U,specialType:I.target.value,specialVolumes:I.target.value==="specialEdition"?U.specialVolumes:"",collectiblePrice:I.target.value==="collectible"?U.collectiblePrice:""})),children:[c.jsx("option",{value:"",children:"Select type"}),c.jsx("option",{value:"specialEdition",children:"Special Edition"}),c.jsx("option",{value:"collectible",children:"Collectible"})]})]}),ce.specialType==="specialEdition"&&c.jsxs("div",{className:`dash-detail-row${pr.specialVolumes?" missing-row":""}`,children:[c.jsx("span",{children:"Volumes Contained"}),c.jsx("input",{type:"number",min:"1",step:"1",value:ce.specialVolumes,onChange:I=>me(U=>({...U,specialVolumes:I.target.value}))})]}),ce.specialType==="collectible"&&c.jsxs("div",{className:`dash-detail-row${pr.collectiblePrice?" missing-row":""}`,children:[c.jsx("span",{children:"Collectible Price"}),c.jsx("input",{type:"number",min:"0",step:"0.01",value:ce.collectiblePrice,onChange:I=>me(U=>({...U,collectiblePrice:I.target.value})),placeholder:"0.00"})]})]}),c.jsxs("div",{className:"dash-detail-actions",children:[c.jsx("button",{type:"button",className:"dash-btn secondary",onClick:js,children:"Cancel"}),c.jsx("button",{type:"button",className:"dash-btn primary",onClick:ls,children:"Save Changes"})]})]})]})]}):c.jsx("div",{className:"stat-sub",children:"No library items."})]})]})}),Gt&&c.jsx("div",{id:"calendarOverlay",onClick:()=>tn(!1),children:c.jsxs("div",{id:"calendarCard",onClick:I=>I.stopPropagation(),children:[c.jsxs("div",{className:"calendar-header",children:[c.jsx("div",{className:"calendar-title",children:Bt.toLocaleString(void 0,{month:"long",year:"numeric"})}),c.jsxs("div",{className:"calendar-nav",children:[c.jsx("button",{className:"calendar-nav-btn",onClick:()=>jn(new Date(Bt.getFullYear(),Bt.getMonth()-1,1)),children:"<"}),c.jsx("button",{className:"calendar-nav-btn",onClick:()=>jn(new Date(Bt.getFullYear(),Bt.getMonth()+1,1)),children:">"})]})]}),c.jsxs("div",{className:"calendar-weekdays",children:[c.jsx("div",{children:"Sun"}),c.jsx("div",{children:"Mon"}),c.jsx("div",{children:"Tue"}),c.jsx("div",{children:"Wed"}),c.jsx("div",{children:"Thu"}),c.jsx("div",{children:"Fri"}),c.jsx("div",{children:"Sat"})]}),c.jsx("div",{className:"calendar-grid",id:"releaseCalendar",children:Pa.map((I,U)=>I.type==="pad"?c.jsx("div",{className:"calendar-day pad"},U):c.jsxs("div",{className:"calendar-day"+(I.isToday?" today":""),children:[c.jsx("div",{className:"day-num",children:I.day}),c.jsxs("div",{className:"calendar-releases",children:[(Ve===I.dateKey?I.releases:I.releases.slice(0,2)).map((W,fe)=>c.jsx("div",{className:"calendar-release",title:W.title,children:W.title},fe)),I.releases.length>2&&c.jsxs("button",{className:"calendar-more-btn",onClick:()=>{const W=new Date(Bt.getFullYear(),Bt.getMonth(),I.day);xt({dateLabel:W.toLocaleDateString(void 0,{month:"long",day:"numeric",year:"numeric"}),releases:I.releases})},children:["+",I.releases.length-2," more"]})]})]},U))}),!Ft.length&&c.jsx("div",{className:"calendar-empty",children:"No wishlist releases found."}),c.jsx("button",{id:"calendarClose",onClick:()=>tn(!1),children:"x"})]})}),Rt.open&&c.jsx("div",{id:"statDetailOverlay",onClick:us,children:c.jsxs("div",{id:"statDetailCard",onClick:I=>I.stopPropagation(),children:[c.jsx("button",{id:"statDetailClose",onClick:us,children:"x"}),c.jsxs("h2",{id:"statDetailTitle",children:[Rt.type==="publishers"&&"Top Publishers",Rt.type==="genres"&&"Top Genres",Rt.type==="demographics"&&"Top Demographics",Rt.type==="timeToRead"&&"Avg Time From Purchase to Read",Rt.type==="collectionValue"&&"Collection Value",Rt.type==="pages"&&"Pages Read vs Total",Rt.type==="ratings"&&"Ratings",Rt.type==="releases"&&"Wishlist Releases"]}),c.jsx("div",{id:"statDetailBody",children:Sn()})]})}),Me&&c.jsx("div",{id:"calendarOverlay",onClick:()=>xt(null),style:{zIndex:10080},children:c.jsxs("div",{id:"calendarCard",onClick:I=>I.stopPropagation(),style:{maxWidth:"520px"},children:[c.jsxs("div",{className:"calendar-header",children:[c.jsx("div",{className:"calendar-title",children:Me.dateLabel}),c.jsx("button",{className:"calendar-close-btn",onClick:()=>xt(null),type:"button",children:"Close"})]}),c.jsx("div",{className:"calendar-releases",children:Me.releases.map((I,U)=>c.jsx("div",{className:"calendar-release",title:I.title,children:I.title},U))})]})}),e&&V&&c.jsx("div",{className:"dashboard-modal-backdrop visible",onClick:I=>{I.target===I.currentTarget&&ne(!1)},children:c.jsxs("div",{className:"dashboard-modal",children:[c.jsxs("div",{className:"dashboard-modal-header",children:[c.jsx("h3",{children:"Webhook Settings"}),c.jsx("button",{className:"dashboard-close",onClick:()=>ne(!1),type:"button",children:"Close"})]}),c.jsxs("div",{className:"dashboard-modal-body",children:[c.jsxs("label",{className:"dashboard-input",children:[c.jsx("span",{children:"Yearly summary webhook"}),c.jsx("input",{type:"text",value:$.yearly,onChange:I=>q(U=>({...U,yearly:I.target.value}))})]}),c.jsxs("label",{className:"dashboard-input",children:[c.jsx("span",{children:"Release timer webhook"}),c.jsx("input",{type:"text",value:$.release,onChange:I=>q(U=>({...U,release:I.target.value}))})]}),c.jsxs("label",{className:"dashboard-input",children:[c.jsx("span",{children:"Activity webhook"}),c.jsx("input",{type:"text",value:$.activity,onChange:I=>q(U=>({...U,activity:I.target.value}))})]}),c.jsxs("label",{className:"dashboard-input",children:[c.jsx("span",{children:"Suggestion webhook"}),c.jsx("input",{type:"text",value:$.suggestion,onChange:I=>q(U=>({...U,suggestion:I.target.value}))})]}),c.jsxs("div",{className:"dashboard-input",style:{borderTop:"1px solid rgba(255,182,193,0.2)",paddingTop:8},children:[c.jsx("span",{children:"Admin UIDs"}),c.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:[c.jsx("input",{type:"text",placeholder:"Enter UID",value:se,onChange:I=>b(I.target.value),style:{flex:"1 1 220px",padding:"8px 10px",borderRadius:"10px",border:"1px solid rgba(255,182,193,0.35)",background:"rgba(43,15,29,0.75)",color:"#ffffff"}}),c.jsx("button",{className:"stat-link",type:"button",onClick:jt,children:"Grant"}),c.jsx("button",{className:"stat-link danger",type:"button",onClick:()=>Qt(),children:"Revoke"})]}),c.jsx("div",{style:{marginTop:8,fontSize:"0.85rem",color:"var(--text-soft)"},children:je?c.jsx("span",{children:"Loading admins"}):J.length===0?c.jsx("span",{children:"No admins found."}):c.jsx("ul",{style:{listStyle:"none",margin:"6px 0 0",padding:0,display:"flex",gap:6,flexDirection:"column"},children:J.map(I=>c.jsxs("li",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:8,background:"rgba(24,5,18,0.7)",border:"1px solid rgba(255,182,193,0.18)",borderRadius:10,padding:"6px 8px"},children:[c.jsx("span",{style:{wordBreak:"break-all"},children:I.uid}),c.jsx("button",{className:"dashboard-close",type:"button",onClick:()=>Qt(I.uid),style:{padding:"4px 10px"},children:"Revoke"})]},I.uid))})})]})]}),c.jsxs("div",{className:"dashboard-modal-footer",children:[c.jsx("button",{className:"stat-link",type:"button",onClick:async()=>{try{await ma(Ot(nt,"settings","webhooks"),{yearly:$.yearly||hl,release:$.release||fl,activity:$.activity||pl,suggestion:$.suggestion||ml}),ne(!1)}catch(I){console.error("Failed to save webhooks",I),alert("Failed to save webhooks.")}},children:"Save"}),c.jsx("button",{className:"stat-link danger",type:"button",onClick:()=>ne(!1),children:"Cancel"})]})]})})]})}function nA(){const[n,e]=j.useState(!0),[t,s]=j.useState(""),[a,l]=j.useState(0),[d,f]=j.useState([]),[m,v]=j.useState(0),w=j.useRef(null);j.useEffect(()=>{document.title="Music | im.ok"},[]),j.useEffect(()=>{let le=!1;async function xe(){e(!0),s("");try{const Se=await fetch("https://music-api-worker.imokissick.workers.dev/music");if(!Se.ok)throw new Error("Worker fetch failed");const N=await Se.json();if(le)return;const R=Array.isArray(N.combined)?N.combined:[],k=Array.isArray(N.spotify)?N.spotify:[],L=Array.isArray(N.soundcloud)?N.soundcloud:[],D=[...R,...k,...L].reduce((S,ce)=>{const me=(ce.title||"").toLowerCase().trim();if(!me)return S;const dt=S.findIndex(We=>(We.title||"").toLowerCase().trim()===me);return dt>=0?(S[dt].source!=="spotify"&&ce.source==="spotify"&&(S[dt]=ce),S):(S.push(ce),S)},[]).map(S=>({...S,releaseDate:S.releaseDate?new Date(S.releaseDate):new Date}));f(D)}catch(Se){console.error(Se),le||s("Failed to load music feeds.")}finally{le||e(!1)}}return xe(),()=>{le=!0}},[]);const E=Math.min(4,Math.max(1,d.length)),C=E?Math.ceil(d.length/E):0,$=()=>{w.current&&clearInterval(w.current),d.length&&(v(le=>le+1),w.current=setInterval(()=>{l(le=>(Math.floor(le/E)+1)%C*E%d.length),v(le=>le+1)},15e3))};j.useEffect(()=>{if(d.length)return $(),()=>{w.current&&clearInterval(w.current)}},[d,E]);const q=le=>{d.length&&(l(xe=>(Math.floor(xe/E)+le+C)%C*E%d.length),$())},Y=le=>{d.length&&(l(le*E%d.length),$())},F=le=>xe=>{xe.preventDefault();const N=le.source==="spotify"?`spotify:album:${le.id}`:le.url,R=le.url;try{const k=setTimeout(()=>{window.open(R,"_blank","noopener,noreferrer")},600);window.location.href=N,setTimeout(()=>clearTimeout(k),800)}catch{window.open(R,"_blank","noopener,noreferrer")}},X=d[0],ge=le=>le?{backgroundImage:`url(${le})`,backgroundSize:"cover",backgroundPosition:"center"}:{},re=X?X.source==="spotify"?"Spotify":"SoundCloud":"";return c.jsxs("main",{className:"page music-page",children:[c.jsxs("header",{className:"music-hero",children:[c.jsxs("div",{className:"music-hero-content",children:[c.jsx("p",{className:"music-pill",children:"im.ok  Artist"}),c.jsx("h1",{children:X?X.title:"Latest & Greatest"}),c.jsx("p",{className:"music-sub",children:"Check out my latest song. I know it's been almost a whole year since I've released. I have been on a much needed hiatus. I felt the whole world crumbling around me and had no time to breathe so this is why I took a break. Here's to 2026!"}),X&&c.jsx("div",{className:"music-badges",children:c.jsx("span",{children:re})})]}),c.jsx("div",{className:"music-hero-embed",children:c.jsxs("div",{className:"music-hero-art",style:ge(X==null?void 0:X.artwork),children:[!(X!=null&&X.artwork)&&c.jsx("div",{className:"music-hero-art-fallback",children:"Artwork"}),X&&c.jsx("button",{className:"music-link music-play hero-play","aria-label":`Play ${X.title}`,onClick:F(X)})]})})]}),c.jsxs("section",{className:"music-section",children:[c.jsx("div",{className:"music-section-header",children:c.jsx("h2",{children:"Releases"})}),t&&c.jsx("div",{className:"music-error",children:t}),n&&c.jsx("div",{className:"music-loading",children:"Loading music feeds..."}),!n&&d.length===0&&c.jsx("div",{className:"music-empty",children:"Connect Spotify/SoundCloud tokens to see live releases."}),!n&&d.length>0&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"music-carousel-wrap",children:[c.jsx("button",{className:"music-nav left",onClick:()=>q(-1),"aria-label":"Previous releases",children:""}),c.jsx("div",{className:"music-carousel",children:Array.from({length:E}).map((le,xe)=>{const Se=d[(a+xe)%d.length];return Se?c.jsxs("div",{className:"music-card",children:[c.jsx("div",{className:"music-card-art",style:ge(Se.artwork)}),c.jsxs("div",{className:"music-card-body",children:[c.jsx("div",{className:"music-card-title",children:Se.title}),c.jsx("div",{className:"music-card-actions",children:c.jsx("button",{className:"music-link music-play","aria-label":`Play ${Se.title}`,onClick:F(Se)})})]})]},`${Se.id}-${xe}`):null})}),c.jsx("button",{className:"music-nav right",onClick:()=>q(1),"aria-label":"Next releases",children:""})]}),c.jsx("div",{className:"music-dots",children:Array.from({length:C}).map((le,xe)=>{const Se=Math.floor(a/E)===xe,N=Se?`${xe}-${m}`:`${xe}-idle`;return c.jsx("button",{className:`dot ${Se?"active":""}`,onClick:()=>Y(xe),"aria-label":`Go to set ${xe+1}`,children:c.jsx("span",{className:"dot-fill"},N)},xe)})})]})]}),c.jsxs("div",{className:"music-feeds-row",children:[c.jsxs("section",{className:"music-section",children:[c.jsx("div",{className:"music-section-header",children:c.jsx("h2",{children:"Spotify"})}),c.jsx("div",{className:"music-embed-card",children:c.jsx("iframe",{title:"Spotify Artist",src:"https://open.spotify.com/embed/artist/00sbWLxYLDs8i5BLQL9Qdo?utm_source=generator&theme=0",width:"100%",height:"400",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy"})})]}),c.jsxs("section",{className:"music-section",children:[c.jsx("div",{className:"music-section-header",children:c.jsx("h2",{children:"SoundCloud"})}),c.jsx("div",{className:"music-embed-card",children:c.jsx("iframe",{title:"SoundCloud Player",width:"100%",height:"400",scrolling:"no",frameBorder:"no",allow:"autoplay",src:"https://w.soundcloud.com/player/?url=https%3A//soundcloud.com/imxk&color=%23ff69b4&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true&visual=true"})})]})]})]})}function rA(){const n=$u(),{user:e}=Vo(),t=async a=>{if(!(a!=null&&a.uid))return;const l=Ot(nt,"users",a.uid);try{const d=await Dp(l),f=d.exists()?d.data():null,m=(f==null?void 0:f.role)||"viewer";await ma(l,{role:m,email:a.email||(f==null?void 0:f.email)||"",displayName:a.displayName||(f==null?void 0:f.displayName)||"",createdAt:(f==null?void 0:f.createdAt)||Lw()},{merge:!0})}catch(d){console.warn("Failed to upsert user doc",d)}};j.useEffect(()=>{e!=null&&e.uid&&t(e).finally(()=>n("/"))},[e,n]);async function s(){try{const a=new Es,l=await e0(Js,a);await t(l.user),n("/")}catch(a){console.error(a),alert("Google Sign-In failed.")}}return c.jsx("div",{className:"signin-page",children:c.jsxs("div",{className:"signin-card",children:[c.jsx("h2",{className:"signin-title",children:"Welcome Back"}),c.jsx("p",{className:"signin-sub",children:"Sign in to access the dashboard & edit collections."}),c.jsxs("button",{className:"google-btn",onClick:s,children:[c.jsx("img",{src:"https://www.svgrepo.com/show/475656/google-color.svg",alt:"",className:"google-icon"}),"Continue with Google"]}),c.jsxs("button",{className:"signin-cancel",onClick:()=>n("/"),children:["<"," Back to Home"]})]})})}const sA=j.lazy(()=>ec(()=>import("./SteamCard-BuuJoBbX.js"),[])),iA=j.lazy(()=>ec(()=>import("./SteamRecents-BWaVyNbb.js"),[])),aA=j.lazy(()=>ec(()=>import("./SteamGames-9jd1JunM.js"),[]));function oA(){return j.useEffect(()=>{document.title="Tyler's Gaming Lounge"},[]),c.jsxs("div",{className:"steam-page page",children:[c.jsxs("header",{style:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",gap:"6px"},children:[c.jsx("h1",{style:{margin:0,fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Tyler's Gaming Lounge"}),c.jsx("p",{style:{margin:"6px 0 0",color:"var(--text-soft)",fontSize:"0.9rem"},children:"This will be the home to all of my gaming collections, this is still being worked on, but thought it was cool with just steam for now."})]}),c.jsx(nf,{minHeight:260,children:c.jsx(j.Suspense,{fallback:c.jsx(xu,{label:"Profile"}),children:c.jsx(sA,{})})}),c.jsx(nf,{minHeight:240,children:c.jsx(j.Suspense,{fallback:c.jsx(xu,{label:"Recently played"}),children:c.jsx(iA,{})})}),c.jsx(nf,{minHeight:400,children:c.jsx(j.Suspense,{fallback:c.jsx(xu,{label:"Library & Achievements"}),children:c.jsx(aA,{})})})]})}function nf({children:n,minHeight:e=200}){const[t,s]=j.useState(!1),a=j.useRef(null);j.useEffect(()=>{const d=new IntersectionObserver(f=>{f[0].isIntersecting&&(s(!0),d.disconnect())},{rootMargin:"200px 0px"});return a.current&&d.observe(a.current),()=>d.disconnect()},[]);const l=t?void 0:{minHeight:e};return c.jsx("div",{ref:a,style:l,children:t?n:c.jsx(xu,{})})}function xu({label:n="Loading section"}){return c.jsxs("div",{className:"steam-skeleton",children:[c.jsx("div",{className:"steam-skeleton-bar"}),c.jsx("div",{className:"steam-skeleton-bar short"}),c.jsx("p",{className:"steam-skeleton-label",children:n})]})}function lA(){return c.jsxs(yR,{children:[c.jsx(_R,{}),c.jsxs(GE,{children:[c.jsx(ns,{path:"/",element:c.jsx(Vv,{})}),c.jsx(ns,{path:"/home",element:c.jsx(Vv,{})}),c.jsx(ns,{path:"/manga",element:c.jsx(TR,{})}),c.jsx(ns,{path:"/anime",element:c.jsx(DR,{})}),c.jsx(ns,{path:"/tcg",element:c.jsx(LR,{})}),c.jsx(ns,{path:"/music",element:c.jsx(nA,{})}),c.jsx(ns,{path:"/dashboard",element:c.jsx(tA,{})}),c.jsx(ns,{path:"/signin",element:c.jsx(rA,{})}),c.jsx(ns,{path:"/steam",element:c.jsx(oA,{})}),c.jsx(ns,{path:"*",element:c.jsx(qE,{to:"/home",replace:!0})})]})]})}eE.createRoot(document.getElementById("root")).render(c.jsx(Qv.StrictMode,{children:c.jsx(eT,{basename:"/base",children:c.jsx(lA,{})})}));export{c as j,j as r};
