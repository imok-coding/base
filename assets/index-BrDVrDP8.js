function bE(n,e){for(var t=0;t<e.length;t++){const s=e[t];if(typeof s!="string"&&!Array.isArray(s)){for(const a in s)if(a!=="default"&&!(a in n)){const l=Object.getOwnPropertyDescriptor(s,a);l&&Object.defineProperty(n,a,l.get?l:{enumerable:!0,get:()=>s[a]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const u of l.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&s(u)}).observe(document,{childList:!0,subtree:!0});function t(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(a){if(a.ep)return;a.ep=!0;const l=t(a);fetch(a.href,l)}})();function sp(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var tf={exports:{}},Rl={},nf={exports:{}},mt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vy;function CE(){if(vy)return mt;vy=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),u=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),y=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),T=Symbol.iterator;function S(Q){return Q===null||typeof Q!="object"?null:(Q=T&&Q[T]||Q["@@iterator"],typeof Q=="function"?Q:null)}var F={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},J=Object.assign,$={};function B(Q,k,H){this.props=Q,this.context=k,this.refs=$,this.updater=H||F}B.prototype.isReactComponent={},B.prototype.setState=function(Q,k){if(typeof Q!="object"&&typeof Q!="function"&&Q!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Q,k,"setState")},B.prototype.forceUpdate=function(Q){this.updater.enqueueForceUpdate(this,Q,"forceUpdate")};function se(){}se.prototype=B.prototype;function _e(Q,k,H){this.props=Q,this.context=k,this.refs=$,this.updater=H||F}var ye=_e.prototype=new se;ye.constructor=_e,J(ye,B.prototype),ye.isPureReactComponent=!0;var we=Array.isArray,O=Object.prototype.hasOwnProperty,ae={current:null},I={key:!0,ref:!0,__self:!0,__source:!0};function N(Q,k,H){var be,Le={},Ve=null,Fe=null;if(k!=null)for(be in k.ref!==void 0&&(Fe=k.ref),k.key!==void 0&&(Ve=""+k.key),k)O.call(k,be)&&!I.hasOwnProperty(be)&&(Le[be]=k[be]);var Qe=arguments.length-2;if(Qe===1)Le.children=H;else if(1<Qe){for(var st=Array(Qe),ve=0;ve<Qe;ve++)st[ve]=arguments[ve+2];Le.children=st}if(Q&&Q.defaultProps)for(be in Qe=Q.defaultProps,Qe)Le[be]===void 0&&(Le[be]=Qe[be]);return{$$typeof:n,type:Q,key:Ve,ref:Fe,props:Le,_owner:ae.current}}function A(Q,k){return{$$typeof:n,type:Q.type,key:k,ref:Q.ref,props:Q.props,_owner:Q._owner}}function U(Q){return typeof Q=="object"&&Q!==null&&Q.$$typeof===n}function V(Q){var k={"=":"=0",":":"=2"};return"$"+Q.replace(/[=:]/g,function(H){return k[H]})}var P=/\/+/g;function C(Q,k){return typeof Q=="object"&&Q!==null&&Q.key!=null?V(""+Q.key):k.toString(36)}function Y(Q,k,H,be,Le){var Ve=typeof Q;(Ve==="undefined"||Ve==="boolean")&&(Q=null);var Fe=!1;if(Q===null)Fe=!0;else switch(Ve){case"string":case"number":Fe=!0;break;case"object":switch(Q.$$typeof){case n:case e:Fe=!0}}if(Fe)return Fe=Q,Le=Le(Fe),Q=be===""?"."+C(Fe,0):be,we(Le)?(H="",Q!=null&&(H=Q.replace(P,"$&/")+"/"),Y(Le,k,H,"",function(ve){return ve})):Le!=null&&(U(Le)&&(Le=A(Le,H+(!Le.key||Fe&&Fe.key===Le.key?"":(""+Le.key).replace(P,"$&/")+"/")+Q)),k.push(Le)),1;if(Fe=0,be=be===""?".":be+":",we(Q))for(var Qe=0;Qe<Q.length;Qe++){Ve=Q[Qe];var st=be+C(Ve,Qe);Fe+=Y(Ve,k,H,st,Le)}else if(st=S(Q),typeof st=="function")for(Q=st.call(Q),Qe=0;!(Ve=Q.next()).done;)Ve=Ve.value,st=be+C(Ve,Qe++),Fe+=Y(Ve,k,H,st,Le);else if(Ve==="object")throw k=String(Q),Error("Objects are not valid as a React child (found: "+(k==="[object Object]"?"object with keys {"+Object.keys(Q).join(", ")+"}":k)+"). If you meant to render a collection of children, use an array instead.");return Fe}function ie(Q,k,H){if(Q==null)return Q;var be=[],Le=0;return Y(Q,be,"","",function(Ve){return k.call(H,Ve,Le++)}),be}function Ce(Q){if(Q._status===-1){var k=Q._result;k=k(),k.then(function(H){(Q._status===0||Q._status===-1)&&(Q._status=1,Q._result=H)},function(H){(Q._status===0||Q._status===-1)&&(Q._status=2,Q._result=H)}),Q._status===-1&&(Q._status=0,Q._result=k)}if(Q._status===1)return Q._result.default;throw Q._result}var fe={current:null},ce={transition:null},Re={ReactCurrentDispatcher:fe,ReactCurrentBatchConfig:ce,ReactCurrentOwner:ae};function Ee(){throw Error("act(...) is not supported in production builds of React.")}return mt.Children={map:ie,forEach:function(Q,k,H){ie(Q,function(){k.apply(this,arguments)},H)},count:function(Q){var k=0;return ie(Q,function(){k++}),k},toArray:function(Q){return ie(Q,function(k){return k})||[]},only:function(Q){if(!U(Q))throw Error("React.Children.only expected to receive a single React element child.");return Q}},mt.Component=B,mt.Fragment=t,mt.Profiler=a,mt.PureComponent=_e,mt.StrictMode=s,mt.Suspense=m,mt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Re,mt.act=Ee,mt.cloneElement=function(Q,k,H){if(Q==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+Q+".");var be=J({},Q.props),Le=Q.key,Ve=Q.ref,Fe=Q._owner;if(k!=null){if(k.ref!==void 0&&(Ve=k.ref,Fe=ae.current),k.key!==void 0&&(Le=""+k.key),Q.type&&Q.type.defaultProps)var Qe=Q.type.defaultProps;for(st in k)O.call(k,st)&&!I.hasOwnProperty(st)&&(be[st]=k[st]===void 0&&Qe!==void 0?Qe[st]:k[st])}var st=arguments.length-2;if(st===1)be.children=H;else if(1<st){Qe=Array(st);for(var ve=0;ve<st;ve++)Qe[ve]=arguments[ve+2];be.children=Qe}return{$$typeof:n,type:Q.type,key:Le,ref:Ve,props:be,_owner:Fe}},mt.createContext=function(Q){return Q={$$typeof:u,_currentValue:Q,_currentValue2:Q,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},Q.Provider={$$typeof:l,_context:Q},Q.Consumer=Q},mt.createElement=N,mt.createFactory=function(Q){var k=N.bind(null,Q);return k.type=Q,k},mt.createRef=function(){return{current:null}},mt.forwardRef=function(Q){return{$$typeof:f,render:Q}},mt.isValidElement=U,mt.lazy=function(Q){return{$$typeof:_,_payload:{_status:-1,_result:Q},_init:Ce}},mt.memo=function(Q,k){return{$$typeof:y,type:Q,compare:k===void 0?null:k}},mt.startTransition=function(Q){var k=ce.transition;ce.transition={};try{Q()}finally{ce.transition=k}},mt.unstable_act=Ee,mt.useCallback=function(Q,k){return fe.current.useCallback(Q,k)},mt.useContext=function(Q){return fe.current.useContext(Q)},mt.useDebugValue=function(){},mt.useDeferredValue=function(Q){return fe.current.useDeferredValue(Q)},mt.useEffect=function(Q,k){return fe.current.useEffect(Q,k)},mt.useId=function(){return fe.current.useId()},mt.useImperativeHandle=function(Q,k,H){return fe.current.useImperativeHandle(Q,k,H)},mt.useInsertionEffect=function(Q,k){return fe.current.useInsertionEffect(Q,k)},mt.useLayoutEffect=function(Q,k){return fe.current.useLayoutEffect(Q,k)},mt.useMemo=function(Q,k){return fe.current.useMemo(Q,k)},mt.useReducer=function(Q,k,H){return fe.current.useReducer(Q,k,H)},mt.useRef=function(Q){return fe.current.useRef(Q)},mt.useState=function(Q){return fe.current.useState(Q)},mt.useSyncExternalStore=function(Q,k,H){return fe.current.useSyncExternalStore(Q,k,H)},mt.useTransition=function(){return fe.current.useTransition()},mt.version="18.3.1",mt}var _y;function ip(){return _y||(_y=1,nf.exports=CE()),nf.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xy;function IE(){if(xy)return Rl;xy=1;var n=ip(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,a=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function u(f,m,y){var _,T={},S=null,F=null;y!==void 0&&(S=""+y),m.key!==void 0&&(S=""+m.key),m.ref!==void 0&&(F=m.ref);for(_ in m)s.call(m,_)&&!l.hasOwnProperty(_)&&(T[_]=m[_]);if(f&&f.defaultProps)for(_ in m=f.defaultProps,m)T[_]===void 0&&(T[_]=m[_]);return{$$typeof:e,type:f,key:S,ref:F,props:T,_owner:a.current}}return Rl.Fragment=t,Rl.jsx=u,Rl.jsxs=u,Rl}var wy;function NE(){return wy||(wy=1,tf.exports=IE()),tf.exports}var o=NE(),j=ip();const ap=sp(j),PE=bE({__proto__:null,default:ap},[j]);var vu={},rf={exports:{}},Pr={},sf={exports:{}},af={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ey;function RE(){return Ey||(Ey=1,(function(n){function e(ce,Re){var Ee=ce.length;ce.push(Re);e:for(;0<Ee;){var Q=Ee-1>>>1,k=ce[Q];if(0<a(k,Re))ce[Q]=Re,ce[Ee]=k,Ee=Q;else break e}}function t(ce){return ce.length===0?null:ce[0]}function s(ce){if(ce.length===0)return null;var Re=ce[0],Ee=ce.pop();if(Ee!==Re){ce[0]=Ee;e:for(var Q=0,k=ce.length,H=k>>>1;Q<H;){var be=2*(Q+1)-1,Le=ce[be],Ve=be+1,Fe=ce[Ve];if(0>a(Le,Ee))Ve<k&&0>a(Fe,Le)?(ce[Q]=Fe,ce[Ve]=Ee,Q=Ve):(ce[Q]=Le,ce[be]=Ee,Q=be);else if(Ve<k&&0>a(Fe,Ee))ce[Q]=Fe,ce[Ve]=Ee,Q=Ve;else break e}}return Re}function a(ce,Re){var Ee=ce.sortIndex-Re.sortIndex;return Ee!==0?Ee:ce.id-Re.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;n.unstable_now=function(){return l.now()}}else{var u=Date,f=u.now();n.unstable_now=function(){return u.now()-f}}var m=[],y=[],_=1,T=null,S=3,F=!1,J=!1,$=!1,B=typeof setTimeout=="function"?setTimeout:null,se=typeof clearTimeout=="function"?clearTimeout:null,_e=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function ye(ce){for(var Re=t(y);Re!==null;){if(Re.callback===null)s(y);else if(Re.startTime<=ce)s(y),Re.sortIndex=Re.expirationTime,e(m,Re);else break;Re=t(y)}}function we(ce){if($=!1,ye(ce),!J)if(t(m)!==null)J=!0,Ce(O);else{var Re=t(y);Re!==null&&fe(we,Re.startTime-ce)}}function O(ce,Re){J=!1,$&&($=!1,se(N),N=-1),F=!0;var Ee=S;try{for(ye(Re),T=t(m);T!==null&&(!(T.expirationTime>Re)||ce&&!V());){var Q=T.callback;if(typeof Q=="function"){T.callback=null,S=T.priorityLevel;var k=Q(T.expirationTime<=Re);Re=n.unstable_now(),typeof k=="function"?T.callback=k:T===t(m)&&s(m),ye(Re)}else s(m);T=t(m)}if(T!==null)var H=!0;else{var be=t(y);be!==null&&fe(we,be.startTime-Re),H=!1}return H}finally{T=null,S=Ee,F=!1}}var ae=!1,I=null,N=-1,A=5,U=-1;function V(){return!(n.unstable_now()-U<A)}function P(){if(I!==null){var ce=n.unstable_now();U=ce;var Re=!0;try{Re=I(!0,ce)}finally{Re?C():(ae=!1,I=null)}}else ae=!1}var C;if(typeof _e=="function")C=function(){_e(P)};else if(typeof MessageChannel<"u"){var Y=new MessageChannel,ie=Y.port2;Y.port1.onmessage=P,C=function(){ie.postMessage(null)}}else C=function(){B(P,0)};function Ce(ce){I=ce,ae||(ae=!0,C())}function fe(ce,Re){N=B(function(){ce(n.unstable_now())},Re)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ce){ce.callback=null},n.unstable_continueExecution=function(){J||F||(J=!0,Ce(O))},n.unstable_forceFrameRate=function(ce){0>ce||125<ce?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<ce?Math.floor(1e3/ce):5},n.unstable_getCurrentPriorityLevel=function(){return S},n.unstable_getFirstCallbackNode=function(){return t(m)},n.unstable_next=function(ce){switch(S){case 1:case 2:case 3:var Re=3;break;default:Re=S}var Ee=S;S=Re;try{return ce()}finally{S=Ee}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(ce,Re){switch(ce){case 1:case 2:case 3:case 4:case 5:break;default:ce=3}var Ee=S;S=ce;try{return Re()}finally{S=Ee}},n.unstable_scheduleCallback=function(ce,Re,Ee){var Q=n.unstable_now();switch(typeof Ee=="object"&&Ee!==null?(Ee=Ee.delay,Ee=typeof Ee=="number"&&0<Ee?Q+Ee:Q):Ee=Q,ce){case 1:var k=-1;break;case 2:k=250;break;case 5:k=1073741823;break;case 4:k=1e4;break;default:k=5e3}return k=Ee+k,ce={id:_++,callback:Re,priorityLevel:ce,startTime:Ee,expirationTime:k,sortIndex:-1},Ee>Q?(ce.sortIndex=Ee,e(y,ce),t(m)===null&&ce===t(y)&&($?(se(N),N=-1):$=!0,fe(we,Ee-Q))):(ce.sortIndex=k,e(m,ce),J||F||(J=!0,Ce(O))),ce},n.unstable_shouldYield=V,n.unstable_wrapCallback=function(ce){var Re=S;return function(){var Ee=S;S=Re;try{return ce.apply(this,arguments)}finally{S=Ee}}}})(af)),af}var Ty;function AE(){return Ty||(Ty=1,sf.exports=RE()),sf.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sy;function jE(){if(Sy)return Pr;Sy=1;var n=ip(),e=AE();function t(r){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+r,c=1;c<arguments.length;c++)i+="&args[]="+encodeURIComponent(arguments[c]);return"Minified React error #"+r+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,a={};function l(r,i){u(r,i),u(r+"Capture",i)}function u(r,i){for(a[r]=i,r=0;r<i.length;r++)s.add(i[r])}var f=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),m=Object.prototype.hasOwnProperty,y=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,_={},T={};function S(r){return m.call(T,r)?!0:m.call(_,r)?!1:y.test(r)?T[r]=!0:(_[r]=!0,!1)}function F(r,i,c,h){if(c!==null&&c.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return h?!1:c!==null?!c.acceptsBooleans:(r=r.toLowerCase().slice(0,5),r!=="data-"&&r!=="aria-");default:return!1}}function J(r,i,c,h){if(i===null||typeof i>"u"||F(r,i,c,h))return!0;if(h)return!1;if(c!==null)switch(c.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function $(r,i,c,h,p,v,b){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=h,this.attributeNamespace=p,this.mustUseProperty=c,this.propertyName=r,this.type=i,this.sanitizeURL=v,this.removeEmptyString=b}var B={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(r){B[r]=new $(r,0,!1,r,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(r){var i=r[0];B[i]=new $(i,1,!1,r[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(r){B[r]=new $(r,2,!1,r.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(r){B[r]=new $(r,2,!1,r,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(r){B[r]=new $(r,3,!1,r.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(r){B[r]=new $(r,3,!0,r,null,!1,!1)}),["capture","download"].forEach(function(r){B[r]=new $(r,4,!1,r,null,!1,!1)}),["cols","rows","size","span"].forEach(function(r){B[r]=new $(r,6,!1,r,null,!1,!1)}),["rowSpan","start"].forEach(function(r){B[r]=new $(r,5,!1,r.toLowerCase(),null,!1,!1)});var se=/[\-:]([a-z])/g;function _e(r){return r[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(r){var i=r.replace(se,_e);B[i]=new $(i,1,!1,r,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(r){var i=r.replace(se,_e);B[i]=new $(i,1,!1,r,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(r){var i=r.replace(se,_e);B[i]=new $(i,1,!1,r,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(r){B[r]=new $(r,1,!1,r.toLowerCase(),null,!1,!1)}),B.xlinkHref=new $("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(r){B[r]=new $(r,1,!1,r.toLowerCase(),null,!0,!0)});function ye(r,i,c,h){var p=B.hasOwnProperty(i)?B[i]:null;(p!==null?p.type!==0:h||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(J(i,c,p,h)&&(c=null),h||p===null?S(i)&&(c===null?r.removeAttribute(i):r.setAttribute(i,""+c)):p.mustUseProperty?r[p.propertyName]=c===null?p.type===3?!1:"":c:(i=p.attributeName,h=p.attributeNamespace,c===null?r.removeAttribute(i):(p=p.type,c=p===3||p===4&&c===!0?"":""+c,h?r.setAttributeNS(h,i,c):r.setAttribute(i,c))))}var we=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,O=Symbol.for("react.element"),ae=Symbol.for("react.portal"),I=Symbol.for("react.fragment"),N=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),U=Symbol.for("react.provider"),V=Symbol.for("react.context"),P=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),Y=Symbol.for("react.suspense_list"),ie=Symbol.for("react.memo"),Ce=Symbol.for("react.lazy"),fe=Symbol.for("react.offscreen"),ce=Symbol.iterator;function Re(r){return r===null||typeof r!="object"?null:(r=ce&&r[ce]||r["@@iterator"],typeof r=="function"?r:null)}var Ee=Object.assign,Q;function k(r){if(Q===void 0)try{throw Error()}catch(c){var i=c.stack.trim().match(/\n( *(at )?)/);Q=i&&i[1]||""}return`
`+Q+r}var H=!1;function be(r,i){if(!r||H)return"";H=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(oe){var h=oe}Reflect.construct(r,[],i)}else{try{i.call()}catch(oe){h=oe}r.call(i.prototype)}else{try{throw Error()}catch(oe){h=oe}r()}}catch(oe){if(oe&&h&&typeof oe.stack=="string"){for(var p=oe.stack.split(`
`),v=h.stack.split(`
`),b=p.length-1,M=v.length-1;1<=b&&0<=M&&p[b]!==v[M];)M--;for(;1<=b&&0<=M;b--,M--)if(p[b]!==v[M]){if(b!==1||M!==1)do if(b--,M--,0>M||p[b]!==v[M]){var G=`
`+p[b].replace(" at new "," at ");return r.displayName&&G.includes("<anonymous>")&&(G=G.replace("<anonymous>",r.displayName)),G}while(1<=b&&0<=M);break}}}finally{H=!1,Error.prepareStackTrace=c}return(r=r?r.displayName||r.name:"")?k(r):""}function Le(r){switch(r.tag){case 5:return k(r.type);case 16:return k("Lazy");case 13:return k("Suspense");case 19:return k("SuspenseList");case 0:case 2:case 15:return r=be(r.type,!1),r;case 11:return r=be(r.type.render,!1),r;case 1:return r=be(r.type,!0),r;default:return""}}function Ve(r){if(r==null)return null;if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case I:return"Fragment";case ae:return"Portal";case A:return"Profiler";case N:return"StrictMode";case C:return"Suspense";case Y:return"SuspenseList"}if(typeof r=="object")switch(r.$$typeof){case V:return(r.displayName||"Context")+".Consumer";case U:return(r._context.displayName||"Context")+".Provider";case P:var i=r.render;return r=r.displayName,r||(r=i.displayName||i.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case ie:return i=r.displayName||null,i!==null?i:Ve(r.type)||"Memo";case Ce:i=r._payload,r=r._init;try{return Ve(r(i))}catch{}}return null}function Fe(r){var i=r.type;switch(r.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return r=i.render,r=r.displayName||r.name||"",i.displayName||(r!==""?"ForwardRef("+r+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ve(i);case 8:return i===N?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function Qe(r){switch(typeof r){case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function st(r){var i=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function ve(r){var i=st(r)?"checked":"value",c=Object.getOwnPropertyDescriptor(r.constructor.prototype,i),h=""+r[i];if(!r.hasOwnProperty(i)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var p=c.get,v=c.set;return Object.defineProperty(r,i,{configurable:!0,get:function(){return p.call(this)},set:function(b){h=""+b,v.call(this,b)}}),Object.defineProperty(r,i,{enumerable:c.enumerable}),{getValue:function(){return h},setValue:function(b){h=""+b},stopTracking:function(){r._valueTracker=null,delete r[i]}}}}function ue(r){r._valueTracker||(r._valueTracker=ve(r))}function Oe(r){if(!r)return!1;var i=r._valueTracker;if(!i)return!0;var c=i.getValue(),h="";return r&&(h=st(r)?r.checked?"true":"false":r.value),r=h,r!==c?(i.setValue(r),!0):!1}function ge(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}function qe(r,i){var c=i.checked;return Ee({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:c??r._wrapperState.initialChecked})}function Ye(r,i){var c=i.defaultValue==null?"":i.defaultValue,h=i.checked!=null?i.checked:i.defaultChecked;c=Qe(i.value!=null?i.value:c),r._wrapperState={initialChecked:h,initialValue:c,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function Et(r,i){i=i.checked,i!=null&&ye(r,"checked",i,!1)}function Nt(r,i){Et(r,i);var c=Qe(i.value),h=i.type;if(c!=null)h==="number"?(c===0&&r.value===""||r.value!=c)&&(r.value=""+c):r.value!==""+c&&(r.value=""+c);else if(h==="submit"||h==="reset"){r.removeAttribute("value");return}i.hasOwnProperty("value")?It(r,i.type,c):i.hasOwnProperty("defaultValue")&&It(r,i.type,Qe(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(r.defaultChecked=!!i.defaultChecked)}function At(r,i,c){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var h=i.type;if(!(h!=="submit"&&h!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+r._wrapperState.initialValue,c||i===r.value||(r.value=i),r.defaultValue=i}c=r.name,c!==""&&(r.name=""),r.defaultChecked=!!r._wrapperState.initialChecked,c!==""&&(r.name=c)}function It(r,i,c){(i!=="number"||ge(r.ownerDocument)!==r)&&(c==null?r.defaultValue=""+r._wrapperState.initialValue:r.defaultValue!==""+c&&(r.defaultValue=""+c))}var cn=Array.isArray;function Kt(r,i,c,h){if(r=r.options,i){i={};for(var p=0;p<c.length;p++)i["$"+c[p]]=!0;for(c=0;c<r.length;c++)p=i.hasOwnProperty("$"+r[c].value),r[c].selected!==p&&(r[c].selected=p),p&&h&&(r[c].defaultSelected=!0)}else{for(c=""+Qe(c),i=null,p=0;p<r.length;p++){if(r[p].value===c){r[p].selected=!0,h&&(r[p].defaultSelected=!0);return}i!==null||r[p].disabled||(i=r[p])}i!==null&&(i.selected=!0)}}function yr(r,i){if(i.dangerouslySetInnerHTML!=null)throw Error(t(91));return Ee({},i,{value:void 0,defaultValue:void 0,children:""+r._wrapperState.initialValue})}function cr(r,i){var c=i.value;if(c==null){if(c=i.children,i=i.defaultValue,c!=null){if(i!=null)throw Error(t(92));if(cn(c)){if(1<c.length)throw Error(t(93));c=c[0]}i=c}i==null&&(i=""),c=i}r._wrapperState={initialValue:Qe(c)}}function un(r,i){var c=Qe(i.value),h=Qe(i.defaultValue);c!=null&&(c=""+c,c!==r.value&&(r.value=c),i.defaultValue==null&&r.defaultValue!==c&&(r.defaultValue=c)),h!=null&&(r.defaultValue=""+h)}function kn(r){var i=r.textContent;i===r._wrapperState.initialValue&&i!==""&&i!==null&&(r.value=i)}function Mt(r){switch(r){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Dt(r,i){return r==null||r==="http://www.w3.org/1999/xhtml"?Mt(i):r==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":r}var Xn,ur=(function(r){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,c,h,p){MSApp.execUnsafeLocalFunction(function(){return r(i,c,h,p)})}:r})(function(r,i){if(r.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in r)r.innerHTML=i;else{for(Xn=Xn||document.createElement("div"),Xn.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=Xn.firstChild;r.firstChild;)r.removeChild(r.firstChild);for(;i.firstChild;)r.appendChild(i.firstChild)}});function vr(r,i){if(i){var c=r.firstChild;if(c&&c===r.lastChild&&c.nodeType===3){c.nodeValue=i;return}}r.textContent=i}var Zn={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Sn=["Webkit","ms","Moz","O"];Object.keys(Zn).forEach(function(r){Sn.forEach(function(i){i=i+r.charAt(0).toUpperCase()+r.substring(1),Zn[i]=Zn[r]})});function Dr(r,i,c){return i==null||typeof i=="boolean"||i===""?"":c||typeof i!="number"||i===0||Zn.hasOwnProperty(r)&&Zn[r]?(""+i).trim():i+"px"}function Qr(r,i){r=r.style;for(var c in i)if(i.hasOwnProperty(c)){var h=c.indexOf("--")===0,p=Dr(c,i[c],h);c==="float"&&(c="cssFloat"),h?r.setProperty(c,p):r[c]=p}}var Yr=Ee({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function vs(r,i){if(i){if(Yr[r]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(t(137,r));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(t(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(t(61))}if(i.style!=null&&typeof i.style!="object")throw Error(t(62))}}function er(r,i){if(r.indexOf("-")===-1)return typeof i.is=="string";switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Zt=null;function dn(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Jr=null,ht=null,Dn=null;function Xr(r){if(r=ml(r)){if(typeof Jr!="function")throw Error(t(280));var i=r.stateNode;i&&(i=kc(i),Jr(r.stateNode,r.type,i))}}function _r(r){ht?Dn?Dn.push(r):Dn=[r]:ht=r}function Vr(){if(ht){var r=ht,i=Dn;if(Dn=ht=null,Xr(r),i)for(r=0;r<i.length;r++)Xr(i[r])}}function Lr(r,i){return r(i)}function Ds(){}var gn=!1;function Vs(r,i,c){if(gn)return r(i,c);gn=!0;try{return Lr(r,i,c)}finally{gn=!1,(ht!==null||Dn!==null)&&(Ds(),Vr())}}function zt(r,i){var c=r.stateNode;if(c===null)return null;var h=kc(c);if(h===null)return null;c=h[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(r=r.type,h=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!h;break e;default:r=!1}if(r)return null;if(c&&typeof c!="function")throw Error(t(231,i,typeof c));return c}var Zr=!1;if(f)try{var Vn={};Object.defineProperty(Vn,"passive",{get:function(){Zr=!0}}),window.addEventListener("test",Vn,Vn),window.removeEventListener("test",Vn,Vn)}catch{Zr=!1}function Tt(r,i,c,h,p,v,b,M,G){var oe=Array.prototype.slice.call(arguments,3);try{i.apply(c,oe)}catch(Ie){this.onError(Ie)}}var _s=!1,xr=null,dr=!1,Ls=null,Ja={onError:function(r){_s=!0,xr=r}};function en(r,i,c,h,p,v,b,M,G){_s=!1,xr=null,Tt.apply(Ja,arguments)}function wr(r,i,c,h,p,v,b,M,G){if(en.apply(this,arguments),_s){if(_s){var oe=xr;_s=!1,xr=null}else throw Error(t(198));dr||(dr=!0,Ls=oe)}}function yn(r){var i=r,c=r;if(r.alternate)for(;i.return;)i=i.return;else{r=i;do i=r,(i.flags&4098)!==0&&(c=i.return),r=i.return;while(r)}return i.tag===3?c:null}function $n(r){if(r.tag===13){var i=r.memoizedState;if(i===null&&(r=r.alternate,r!==null&&(i=r.memoizedState)),i!==null)return i.dehydrated}return null}function Qt(r){if(yn(r)!==r)throw Error(t(188))}function vn(r){var i=r.alternate;if(!i){if(i=yn(r),i===null)throw Error(t(188));return i!==r?null:r}for(var c=r,h=i;;){var p=c.return;if(p===null)break;var v=p.alternate;if(v===null){if(h=p.return,h!==null){c=h;continue}break}if(p.child===v.child){for(v=p.child;v;){if(v===c)return Qt(p),r;if(v===h)return Qt(p),i;v=v.sibling}throw Error(t(188))}if(c.return!==h.return)c=p,h=v;else{for(var b=!1,M=p.child;M;){if(M===c){b=!0,c=p,h=v;break}if(M===h){b=!0,h=p,c=v;break}M=M.sibling}if(!b){for(M=v.child;M;){if(M===c){b=!0,c=v,h=p;break}if(M===h){b=!0,h=v,c=p;break}M=M.sibling}if(!b)throw Error(t(189))}}if(c.alternate!==h)throw Error(t(190))}if(c.tag!==3)throw Error(t(188));return c.stateNode.current===c?r:i}function es(r){return r=vn(r),r!==null?Ln(r):null}function Ln(r){if(r.tag===5||r.tag===6)return r;for(r=r.child;r!==null;){var i=Ln(r);if(i!==null)return i;r=r.sibling}return null}var xs=e.unstable_scheduleCallback,Ms=e.unstable_cancelCallback,ti=e.unstable_shouldYield,ni=e.unstable_requestPaint,pt=e.unstable_now,bi=e.unstable_getCurrentPriorityLevel,hr=e.unstable_ImmediatePriority,tn=e.unstable_UserBlockingPriority,nn=e.unstable_NormalPriority,Mn=e.unstable_LowPriority,Wn=e.unstable_IdlePriority,w=null,D=null;function q(r){if(D&&typeof D.onCommitFiberRoot=="function")try{D.onCommitFiberRoot(w,r,void 0,(r.current.flags&128)===128)}catch{}}var L=Math.clz32?Math.clz32:ne,ee=Math.log,X=Math.LN2;function ne(r){return r>>>=0,r===0?32:31-(ee(r)/X|0)|0}var Ae=64,me=4194304;function De(r){switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return r&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return r}}function de(r,i){var c=r.pendingLanes;if(c===0)return 0;var h=0,p=r.suspendedLanes,v=r.pingedLanes,b=c&268435455;if(b!==0){var M=b&~p;M!==0?h=De(M):(v&=b,v!==0&&(h=De(v)))}else b=c&~p,b!==0?h=De(b):v!==0&&(h=De(v));if(h===0)return 0;if(i!==0&&i!==h&&(i&p)===0&&(p=h&-h,v=i&-i,p>=v||p===16&&(v&4194240)!==0))return i;if((h&4)!==0&&(h|=c&16),i=r.entangledLanes,i!==0)for(r=r.entanglements,i&=h;0<i;)c=31-L(i),p=1<<c,h|=r[c],i&=~p;return h}function ot(r,i){switch(r){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Pe(r,i){for(var c=r.suspendedLanes,h=r.pingedLanes,p=r.expirationTimes,v=r.pendingLanes;0<v;){var b=31-L(v),M=1<<b,G=p[b];G===-1?((M&c)===0||(M&h)!==0)&&(p[b]=ot(M,i)):G<=i&&(r.expiredLanes|=M),v&=~M}}function Je(r){return r=r.pendingLanes&-1073741825,r!==0?r:r&1073741824?1073741824:0}function rn(){var r=Ae;return Ae<<=1,(Ae&4194240)===0&&(Ae=64),r}function sn(r){for(var i=[],c=0;31>c;c++)i.push(r);return i}function Er(r,i,c){r.pendingLanes|=i,i!==536870912&&(r.suspendedLanes=0,r.pingedLanes=0),r=r.eventTimes,i=31-L(i),r[i]=c}function _t(r,i){var c=r.pendingLanes&~i;r.pendingLanes=i,r.suspendedLanes=0,r.pingedLanes=0,r.expiredLanes&=i,r.mutableReadLanes&=i,r.entangledLanes&=i,i=r.entanglements;var h=r.eventTimes;for(r=r.expirationTimes;0<c;){var p=31-L(c),v=1<<p;i[p]=0,h[p]=-1,r[p]=-1,c&=~v}}function ts(r,i){var c=r.entangledLanes|=i;for(r=r.entanglements;c;){var h=31-L(c),p=1<<h;p&i|r[h]&i&&(r[h]|=i),c&=~p}}var gt=0;function Os(r){return r&=-r,1<r?4<r?(r&268435455)!==0?16:536870912:4:1}var ma,jt,Fs,Mr,ga,Ci=!1,Or=[],bn=null,Cn=null,Tr=null,Us=new Map,fr=new Map,Fr=[],Xa="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Za(r,i){switch(r){case"focusin":case"focusout":bn=null;break;case"dragenter":case"dragleave":Cn=null;break;case"mouseover":case"mouseout":Tr=null;break;case"pointerover":case"pointerout":Us.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":fr.delete(i.pointerId)}}function Gn(r,i,c,h,p,v){return r===null||r.nativeEvent!==v?(r={blockedOn:i,domEventName:c,eventSystemFlags:h,nativeEvent:v,targetContainers:[p]},i!==null&&(i=ml(i),i!==null&&jt(i)),r):(r.eventSystemFlags|=h,i=r.targetContainers,p!==null&&i.indexOf(p)===-1&&i.push(p),r)}function sl(r,i,c,h,p){switch(i){case"focusin":return bn=Gn(bn,r,i,c,h,p),!0;case"dragenter":return Cn=Gn(Cn,r,i,c,h,p),!0;case"mouseover":return Tr=Gn(Tr,r,i,c,h,p),!0;case"pointerover":var v=p.pointerId;return Us.set(v,Gn(Us.get(v)||null,r,i,c,h,p)),!0;case"gotpointercapture":return v=p.pointerId,fr.set(v,Gn(fr.get(v)||null,r,i,c,h,p)),!0}return!1}function E(r){var i=xa(r.target);if(i!==null){var c=yn(i);if(c!==null){if(i=c.tag,i===13){if(i=$n(c),i!==null){r.blockedOn=i,ga(r.priority,function(){Fs(c)});return}}else if(i===3&&c.stateNode.current.memoizedState.isDehydrated){r.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}r.blockedOn=null}function z(r){if(r.blockedOn!==null)return!1;for(var i=r.targetContainers;0<i.length;){var c=qn(r.domEventName,r.eventSystemFlags,i[0],r.nativeEvent);if(c===null){c=r.nativeEvent;var h=new c.constructor(c.type,c);Zt=h,c.target.dispatchEvent(h),Zt=null}else return i=ml(c),i!==null&&jt(i),r.blockedOn=c,!1;i.shift()}return!0}function W(r,i,c){z(r)&&c.delete(i)}function he(){Ci=!1,bn!==null&&z(bn)&&(bn=null),Cn!==null&&z(Cn)&&(Cn=null),Tr!==null&&z(Tr)&&(Tr=null),Us.forEach(W),fr.forEach(W)}function Te(r,i){r.blockedOn===i&&(r.blockedOn=null,Ci||(Ci=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,he)))}function $e(r){function i(p){return Te(p,r)}if(0<Or.length){Te(Or[0],r);for(var c=1;c<Or.length;c++){var h=Or[c];h.blockedOn===r&&(h.blockedOn=null)}}for(bn!==null&&Te(bn,r),Cn!==null&&Te(Cn,r),Tr!==null&&Te(Tr,r),Us.forEach(i),fr.forEach(i),c=0;c<Fr.length;c++)h=Fr[c],h.blockedOn===r&&(h.blockedOn=null);for(;0<Fr.length&&(c=Fr[0],c.blockedOn===null);)E(c),c.blockedOn===null&&Fr.shift()}var je=we.ReactCurrentBatchConfig,lt=!0;function Ze(r,i,c,h){var p=gt,v=je.transition;je.transition=null;try{gt=1,Bt(r,i,c,h)}finally{gt=p,je.transition=v}}function Vt(r,i,c,h){var p=gt,v=je.transition;je.transition=null;try{gt=4,Bt(r,i,c,h)}finally{gt=p,je.transition=v}}function Bt(r,i,c,h){if(lt){var p=qn(r,i,c,h);if(p===null)Gd(r,i,h,Lt,c),Za(r,h);else if(sl(p,r,i,c,h))h.stopPropagation();else if(Za(r,h),i&4&&-1<Xa.indexOf(r)){for(;p!==null;){var v=ml(p);if(v!==null&&ma(v),v=qn(r,i,c,h),v===null&&Gd(r,i,h,Lt,c),v===p)break;p=v}p!==null&&h.stopPropagation()}else Gd(r,i,h,null,c)}}var Lt=null;function qn(r,i,c,h){if(Lt=null,r=dn(h),r=xa(r),r!==null)if(i=yn(r),i===null)r=null;else if(c=i.tag,c===13){if(r=$n(i),r!==null)return r;r=null}else if(c===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;r=null}else i!==r&&(r=null);return Lt=r,null}function hn(r){switch(r){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(bi()){case hr:return 1;case tn:return 4;case nn:case Mn:return 16;case Wn:return 536870912;default:return 16}default:return 16}}var dt=null,Ur=null,Ot=null;function zr(){if(Ot)return Ot;var r,i=Ur,c=i.length,h,p="value"in dt?dt.value:dt.textContent,v=p.length;for(r=0;r<c&&i[r]===p[r];r++);var b=c-r;for(h=1;h<=b&&i[c-h]===p[v-h];h++);return Ot=p.slice(r,1<h?1-h:void 0)}function zs(r){var i=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&i===13&&(r=13)):r=i,r===10&&(r=13),32<=r||r===13?r:0}function ns(){return!0}function ya(){return!1}function In(r){function i(c,h,p,v,b){this._reactName=c,this._targetInst=p,this.type=h,this.nativeEvent=v,this.target=b,this.currentTarget=null;for(var M in r)r.hasOwnProperty(M)&&(c=r[M],this[M]=c?c(v):v[M]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?ns:ya,this.isPropagationStopped=ya,this}return Ee(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=ns)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=ns)},persist:function(){},isPersistent:ns}),i}var Br={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},rs=In(Br),ss=Ee({},Br,{view:0,detail:0}),Vd=In(ss),eo,ri,Ii,va=Ee({},ss,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Bs,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Ii&&(Ii&&r.type==="mousemove"?(eo=r.screenX-Ii.screenX,ri=r.screenY-Ii.screenY):ri=eo=0,Ii=r),eo)},movementY:function(r){return"movementY"in r?r.movementY:ri}}),to=In(va),il=Ee({},va,{dataTransfer:0}),_c=In(il),no=Ee({},ss,{relatedTarget:0}),ro=In(no),xc=Ee({},Br,{animationName:0,elapsedTime:0,pseudoElement:0}),si=In(xc),wc=Ee({},Br,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),Ec=In(wc),Tc=Ee({},Br,{data:0}),al=In(Tc),so={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},pr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Sc={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function bc(r){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(r):(r=Sc[r])?!!i[r]:!1}function Bs(){return bc}var d=Ee({},ss,{key:function(r){if(r.key){var i=so[r.key]||r.key;if(i!=="Unidentified")return i}return r.type==="keypress"?(r=zs(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?pr[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Bs,charCode:function(r){return r.type==="keypress"?zs(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?zs(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),g=In(d),x=Ee({},va,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),R=In(x),Z=Ee({},ss,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Bs}),le=In(Z),Me=Ee({},Br,{propertyName:0,elapsedTime:0,pseudoElement:0}),kt=In(Me),Nn=Ee({},va,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),xt=In(Nn),On=[9,13,27,32],_n=f&&"CompositionEvent"in window,is=null;f&&"documentMode"in document&&(is=document.documentMode);var $r=f&&"TextEvent"in window&&!is,_a=f&&(!_n||is&&8<is&&11>=is),io=" ",hm=!1;function fm(r,i){switch(r){case"keyup":return On.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function pm(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var ao=!1;function Ew(r,i){switch(r){case"compositionend":return pm(i);case"keypress":return i.which!==32?null:(hm=!0,io);case"textInput":return r=i.data,r===io&&hm?null:r;default:return null}}function Tw(r,i){if(ao)return r==="compositionend"||!_n&&fm(r,i)?(r=zr(),Ot=Ur=dt=null,ao=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return _a&&i.locale!=="ko"?null:i.data;default:return null}}var Sw={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function mm(r){var i=r&&r.nodeName&&r.nodeName.toLowerCase();return i==="input"?!!Sw[r.type]:i==="textarea"}function gm(r,i,c,h){_r(h),i=Rc(i,"onChange"),0<i.length&&(c=new rs("onChange","change",null,c,h),r.push({event:c,listeners:i}))}var ol=null,ll=null;function bw(r){Dm(r,0)}function Cc(r){var i=ho(r);if(Oe(i))return r}function Cw(r,i){if(r==="change")return i}var ym=!1;if(f){var Ld;if(f){var Md="oninput"in document;if(!Md){var vm=document.createElement("div");vm.setAttribute("oninput","return;"),Md=typeof vm.oninput=="function"}Ld=Md}else Ld=!1;ym=Ld&&(!document.documentMode||9<document.documentMode)}function _m(){ol&&(ol.detachEvent("onpropertychange",xm),ll=ol=null)}function xm(r){if(r.propertyName==="value"&&Cc(ll)){var i=[];gm(i,ll,r,dn(r)),Vs(bw,i)}}function Iw(r,i,c){r==="focusin"?(_m(),ol=i,ll=c,ol.attachEvent("onpropertychange",xm)):r==="focusout"&&_m()}function Nw(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Cc(ll)}function Pw(r,i){if(r==="click")return Cc(i)}function Rw(r,i){if(r==="input"||r==="change")return Cc(i)}function Aw(r,i){return r===i&&(r!==0||1/r===1/i)||r!==r&&i!==i}var ws=typeof Object.is=="function"?Object.is:Aw;function cl(r,i){if(ws(r,i))return!0;if(typeof r!="object"||r===null||typeof i!="object"||i===null)return!1;var c=Object.keys(r),h=Object.keys(i);if(c.length!==h.length)return!1;for(h=0;h<c.length;h++){var p=c[h];if(!m.call(i,p)||!ws(r[p],i[p]))return!1}return!0}function wm(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function Em(r,i){var c=wm(r);r=0;for(var h;c;){if(c.nodeType===3){if(h=r+c.textContent.length,r<=i&&h>=i)return{node:c,offset:i-r};r=h}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=wm(c)}}function Tm(r,i){return r&&i?r===i?!0:r&&r.nodeType===3?!1:i&&i.nodeType===3?Tm(r,i.parentNode):"contains"in r?r.contains(i):r.compareDocumentPosition?!!(r.compareDocumentPosition(i)&16):!1:!1}function Sm(){for(var r=window,i=ge();i instanceof r.HTMLIFrameElement;){try{var c=typeof i.contentWindow.location.href=="string"}catch{c=!1}if(c)r=i.contentWindow;else break;i=ge(r.document)}return i}function Od(r){var i=r&&r.nodeName&&r.nodeName.toLowerCase();return i&&(i==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||i==="textarea"||r.contentEditable==="true")}function jw(r){var i=Sm(),c=r.focusedElem,h=r.selectionRange;if(i!==c&&c&&c.ownerDocument&&Tm(c.ownerDocument.documentElement,c)){if(h!==null&&Od(c)){if(i=h.start,r=h.end,r===void 0&&(r=i),"selectionStart"in c)c.selectionStart=i,c.selectionEnd=Math.min(r,c.value.length);else if(r=(i=c.ownerDocument||document)&&i.defaultView||window,r.getSelection){r=r.getSelection();var p=c.textContent.length,v=Math.min(h.start,p);h=h.end===void 0?v:Math.min(h.end,p),!r.extend&&v>h&&(p=h,h=v,v=p),p=Em(c,v);var b=Em(c,h);p&&b&&(r.rangeCount!==1||r.anchorNode!==p.node||r.anchorOffset!==p.offset||r.focusNode!==b.node||r.focusOffset!==b.offset)&&(i=i.createRange(),i.setStart(p.node,p.offset),r.removeAllRanges(),v>h?(r.addRange(i),r.extend(b.node,b.offset)):(i.setEnd(b.node,b.offset),r.addRange(i)))}}for(i=[],r=c;r=r.parentNode;)r.nodeType===1&&i.push({element:r,left:r.scrollLeft,top:r.scrollTop});for(typeof c.focus=="function"&&c.focus(),c=0;c<i.length;c++)r=i[c],r.element.scrollLeft=r.left,r.element.scrollTop=r.top}}var kw=f&&"documentMode"in document&&11>=document.documentMode,oo=null,Fd=null,ul=null,Ud=!1;function bm(r,i,c){var h=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Ud||oo==null||oo!==ge(h)||(h=oo,"selectionStart"in h&&Od(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),ul&&cl(ul,h)||(ul=h,h=Rc(Fd,"onSelect"),0<h.length&&(i=new rs("onSelect","select",null,i,c),r.push({event:i,listeners:h}),i.target=oo)))}function Ic(r,i){var c={};return c[r.toLowerCase()]=i.toLowerCase(),c["Webkit"+r]="webkit"+i,c["Moz"+r]="moz"+i,c}var lo={animationend:Ic("Animation","AnimationEnd"),animationiteration:Ic("Animation","AnimationIteration"),animationstart:Ic("Animation","AnimationStart"),transitionend:Ic("Transition","TransitionEnd")},zd={},Cm={};f&&(Cm=document.createElement("div").style,"AnimationEvent"in window||(delete lo.animationend.animation,delete lo.animationiteration.animation,delete lo.animationstart.animation),"TransitionEvent"in window||delete lo.transitionend.transition);function Nc(r){if(zd[r])return zd[r];if(!lo[r])return r;var i=lo[r],c;for(c in i)if(i.hasOwnProperty(c)&&c in Cm)return zd[r]=i[c];return r}var Im=Nc("animationend"),Nm=Nc("animationiteration"),Pm=Nc("animationstart"),Rm=Nc("transitionend"),Am=new Map,jm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ni(r,i){Am.set(r,i),l(i,[r])}for(var Bd=0;Bd<jm.length;Bd++){var $d=jm[Bd],Dw=$d.toLowerCase(),Vw=$d[0].toUpperCase()+$d.slice(1);Ni(Dw,"on"+Vw)}Ni(Im,"onAnimationEnd"),Ni(Nm,"onAnimationIteration"),Ni(Pm,"onAnimationStart"),Ni("dblclick","onDoubleClick"),Ni("focusin","onFocus"),Ni("focusout","onBlur"),Ni(Rm,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var dl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Lw=new Set("cancel close invalid load scroll toggle".split(" ").concat(dl));function km(r,i,c){var h=r.type||"unknown-event";r.currentTarget=c,wr(h,i,void 0,r),r.currentTarget=null}function Dm(r,i){i=(i&4)!==0;for(var c=0;c<r.length;c++){var h=r[c],p=h.event;h=h.listeners;e:{var v=void 0;if(i)for(var b=h.length-1;0<=b;b--){var M=h[b],G=M.instance,oe=M.currentTarget;if(M=M.listener,G!==v&&p.isPropagationStopped())break e;km(p,M,oe),v=G}else for(b=0;b<h.length;b++){if(M=h[b],G=M.instance,oe=M.currentTarget,M=M.listener,G!==v&&p.isPropagationStopped())break e;km(p,M,oe),v=G}}}if(dr)throw r=Ls,dr=!1,Ls=null,r}function $t(r,i){var c=i[Jd];c===void 0&&(c=i[Jd]=new Set);var h=r+"__bubble";c.has(h)||(Vm(i,r,2,!1),c.add(h))}function Wd(r,i,c){var h=0;i&&(h|=4),Vm(c,r,h,i)}var Pc="_reactListening"+Math.random().toString(36).slice(2);function hl(r){if(!r[Pc]){r[Pc]=!0,s.forEach(function(c){c!=="selectionchange"&&(Lw.has(c)||Wd(c,!1,r),Wd(c,!0,r))});var i=r.nodeType===9?r:r.ownerDocument;i===null||i[Pc]||(i[Pc]=!0,Wd("selectionchange",!1,i))}}function Vm(r,i,c,h){switch(hn(i)){case 1:var p=Ze;break;case 4:p=Vt;break;default:p=Bt}c=p.bind(null,i,c,r),p=void 0,!Zr||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(p=!0),h?p!==void 0?r.addEventListener(i,c,{capture:!0,passive:p}):r.addEventListener(i,c,!0):p!==void 0?r.addEventListener(i,c,{passive:p}):r.addEventListener(i,c,!1)}function Gd(r,i,c,h,p){var v=h;if((i&1)===0&&(i&2)===0&&h!==null)e:for(;;){if(h===null)return;var b=h.tag;if(b===3||b===4){var M=h.stateNode.containerInfo;if(M===p||M.nodeType===8&&M.parentNode===p)break;if(b===4)for(b=h.return;b!==null;){var G=b.tag;if((G===3||G===4)&&(G=b.stateNode.containerInfo,G===p||G.nodeType===8&&G.parentNode===p))return;b=b.return}for(;M!==null;){if(b=xa(M),b===null)return;if(G=b.tag,G===5||G===6){h=v=b;continue e}M=M.parentNode}}h=h.return}Vs(function(){var oe=v,Ie=dn(c),Ne=[];e:{var Se=Am.get(r);if(Se!==void 0){var ze=rs,Ge=r;switch(r){case"keypress":if(zs(c)===0)break e;case"keydown":case"keyup":ze=g;break;case"focusin":Ge="focus",ze=ro;break;case"focusout":Ge="blur",ze=ro;break;case"beforeblur":case"afterblur":ze=ro;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ze=to;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ze=_c;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ze=le;break;case Im:case Nm:case Pm:ze=si;break;case Rm:ze=kt;break;case"scroll":ze=Vd;break;case"wheel":ze=xt;break;case"copy":case"cut":case"paste":ze=Ec;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ze=R}var He=(i&4)!==0,fn=!He&&r==="scroll",te=He?Se!==null?Se+"Capture":null:Se;He=[];for(var K=oe,re;K!==null;){re=K;var ke=re.stateNode;if(re.tag===5&&ke!==null&&(re=ke,te!==null&&(ke=zt(K,te),ke!=null&&He.push(fl(K,ke,re)))),fn)break;K=K.return}0<He.length&&(Se=new ze(Se,Ge,null,c,Ie),Ne.push({event:Se,listeners:He}))}}if((i&7)===0){e:{if(Se=r==="mouseover"||r==="pointerover",ze=r==="mouseout"||r==="pointerout",Se&&c!==Zt&&(Ge=c.relatedTarget||c.fromElement)&&(xa(Ge)||Ge[ii]))break e;if((ze||Se)&&(Se=Ie.window===Ie?Ie:(Se=Ie.ownerDocument)?Se.defaultView||Se.parentWindow:window,ze?(Ge=c.relatedTarget||c.toElement,ze=oe,Ge=Ge?xa(Ge):null,Ge!==null&&(fn=yn(Ge),Ge!==fn||Ge.tag!==5&&Ge.tag!==6)&&(Ge=null)):(ze=null,Ge=oe),ze!==Ge)){if(He=to,ke="onMouseLeave",te="onMouseEnter",K="mouse",(r==="pointerout"||r==="pointerover")&&(He=R,ke="onPointerLeave",te="onPointerEnter",K="pointer"),fn=ze==null?Se:ho(ze),re=Ge==null?Se:ho(Ge),Se=new He(ke,K+"leave",ze,c,Ie),Se.target=fn,Se.relatedTarget=re,ke=null,xa(Ie)===oe&&(He=new He(te,K+"enter",Ge,c,Ie),He.target=re,He.relatedTarget=fn,ke=He),fn=ke,ze&&Ge)t:{for(He=ze,te=Ge,K=0,re=He;re;re=co(re))K++;for(re=0,ke=te;ke;ke=co(ke))re++;for(;0<K-re;)He=co(He),K--;for(;0<re-K;)te=co(te),re--;for(;K--;){if(He===te||te!==null&&He===te.alternate)break t;He=co(He),te=co(te)}He=null}else He=null;ze!==null&&Lm(Ne,Se,ze,He,!1),Ge!==null&&fn!==null&&Lm(Ne,fn,Ge,He,!0)}}e:{if(Se=oe?ho(oe):window,ze=Se.nodeName&&Se.nodeName.toLowerCase(),ze==="select"||ze==="input"&&Se.type==="file")var Ke=Cw;else if(mm(Se))if(ym)Ke=Rw;else{Ke=Nw;var et=Iw}else(ze=Se.nodeName)&&ze.toLowerCase()==="input"&&(Se.type==="checkbox"||Se.type==="radio")&&(Ke=Pw);if(Ke&&(Ke=Ke(r,oe))){gm(Ne,Ke,c,Ie);break e}et&&et(r,Se,oe),r==="focusout"&&(et=Se._wrapperState)&&et.controlled&&Se.type==="number"&&It(Se,"number",Se.value)}switch(et=oe?ho(oe):window,r){case"focusin":(mm(et)||et.contentEditable==="true")&&(oo=et,Fd=oe,ul=null);break;case"focusout":ul=Fd=oo=null;break;case"mousedown":Ud=!0;break;case"contextmenu":case"mouseup":case"dragend":Ud=!1,bm(Ne,c,Ie);break;case"selectionchange":if(kw)break;case"keydown":case"keyup":bm(Ne,c,Ie)}var tt;if(_n)e:{switch(r){case"compositionstart":var at="onCompositionStart";break e;case"compositionend":at="onCompositionEnd";break e;case"compositionupdate":at="onCompositionUpdate";break e}at=void 0}else ao?fm(r,c)&&(at="onCompositionEnd"):r==="keydown"&&c.keyCode===229&&(at="onCompositionStart");at&&(_a&&c.locale!=="ko"&&(ao||at!=="onCompositionStart"?at==="onCompositionEnd"&&ao&&(tt=zr()):(dt=Ie,Ur="value"in dt?dt.value:dt.textContent,ao=!0)),et=Rc(oe,at),0<et.length&&(at=new al(at,r,null,c,Ie),Ne.push({event:at,listeners:et}),tt?at.data=tt:(tt=pm(c),tt!==null&&(at.data=tt)))),(tt=$r?Ew(r,c):Tw(r,c))&&(oe=Rc(oe,"onBeforeInput"),0<oe.length&&(Ie=new al("onBeforeInput","beforeinput",null,c,Ie),Ne.push({event:Ie,listeners:oe}),Ie.data=tt))}Dm(Ne,i)})}function fl(r,i,c){return{instance:r,listener:i,currentTarget:c}}function Rc(r,i){for(var c=i+"Capture",h=[];r!==null;){var p=r,v=p.stateNode;p.tag===5&&v!==null&&(p=v,v=zt(r,c),v!=null&&h.unshift(fl(r,v,p)),v=zt(r,i),v!=null&&h.push(fl(r,v,p))),r=r.return}return h}function co(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5);return r||null}function Lm(r,i,c,h,p){for(var v=i._reactName,b=[];c!==null&&c!==h;){var M=c,G=M.alternate,oe=M.stateNode;if(G!==null&&G===h)break;M.tag===5&&oe!==null&&(M=oe,p?(G=zt(c,v),G!=null&&b.unshift(fl(c,G,M))):p||(G=zt(c,v),G!=null&&b.push(fl(c,G,M)))),c=c.return}b.length!==0&&r.push({event:i,listeners:b})}var Mw=/\r\n?/g,Ow=/\u0000|\uFFFD/g;function Mm(r){return(typeof r=="string"?r:""+r).replace(Mw,`
`).replace(Ow,"")}function Ac(r,i,c){if(i=Mm(i),Mm(r)!==i&&c)throw Error(t(425))}function jc(){}var qd=null,Hd=null;function Kd(r,i){return r==="textarea"||r==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Qd=typeof setTimeout=="function"?setTimeout:void 0,Fw=typeof clearTimeout=="function"?clearTimeout:void 0,Om=typeof Promise=="function"?Promise:void 0,Uw=typeof queueMicrotask=="function"?queueMicrotask:typeof Om<"u"?function(r){return Om.resolve(null).then(r).catch(zw)}:Qd;function zw(r){setTimeout(function(){throw r})}function Yd(r,i){var c=i,h=0;do{var p=c.nextSibling;if(r.removeChild(c),p&&p.nodeType===8)if(c=p.data,c==="/$"){if(h===0){r.removeChild(p),$e(i);return}h--}else c!=="$"&&c!=="$?"&&c!=="$!"||h++;c=p}while(c);$e(i)}function Pi(r){for(;r!=null;r=r.nextSibling){var i=r.nodeType;if(i===1||i===3)break;if(i===8){if(i=r.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return r}function Fm(r){r=r.previousSibling;for(var i=0;r;){if(r.nodeType===8){var c=r.data;if(c==="$"||c==="$!"||c==="$?"){if(i===0)return r;i--}else c==="/$"&&i++}r=r.previousSibling}return null}var uo=Math.random().toString(36).slice(2),$s="__reactFiber$"+uo,pl="__reactProps$"+uo,ii="__reactContainer$"+uo,Jd="__reactEvents$"+uo,Bw="__reactListeners$"+uo,$w="__reactHandles$"+uo;function xa(r){var i=r[$s];if(i)return i;for(var c=r.parentNode;c;){if(i=c[ii]||c[$s]){if(c=i.alternate,i.child!==null||c!==null&&c.child!==null)for(r=Fm(r);r!==null;){if(c=r[$s])return c;r=Fm(r)}return i}r=c,c=r.parentNode}return null}function ml(r){return r=r[$s]||r[ii],!r||r.tag!==5&&r.tag!==6&&r.tag!==13&&r.tag!==3?null:r}function ho(r){if(r.tag===5||r.tag===6)return r.stateNode;throw Error(t(33))}function kc(r){return r[pl]||null}var Xd=[],fo=-1;function Ri(r){return{current:r}}function Wt(r){0>fo||(r.current=Xd[fo],Xd[fo]=null,fo--)}function Ft(r,i){fo++,Xd[fo]=r.current,r.current=i}var Ai={},tr=Ri(Ai),Sr=Ri(!1),wa=Ai;function po(r,i){var c=r.type.contextTypes;if(!c)return Ai;var h=r.stateNode;if(h&&h.__reactInternalMemoizedUnmaskedChildContext===i)return h.__reactInternalMemoizedMaskedChildContext;var p={},v;for(v in c)p[v]=i[v];return h&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=i,r.__reactInternalMemoizedMaskedChildContext=p),p}function br(r){return r=r.childContextTypes,r!=null}function Dc(){Wt(Sr),Wt(tr)}function Um(r,i,c){if(tr.current!==Ai)throw Error(t(168));Ft(tr,i),Ft(Sr,c)}function zm(r,i,c){var h=r.stateNode;if(i=i.childContextTypes,typeof h.getChildContext!="function")return c;h=h.getChildContext();for(var p in h)if(!(p in i))throw Error(t(108,Fe(r)||"Unknown",p));return Ee({},c,h)}function Vc(r){return r=(r=r.stateNode)&&r.__reactInternalMemoizedMergedChildContext||Ai,wa=tr.current,Ft(tr,r),Ft(Sr,Sr.current),!0}function Bm(r,i,c){var h=r.stateNode;if(!h)throw Error(t(169));c?(r=zm(r,i,wa),h.__reactInternalMemoizedMergedChildContext=r,Wt(Sr),Wt(tr),Ft(tr,r)):Wt(Sr),Ft(Sr,c)}var ai=null,Lc=!1,Zd=!1;function $m(r){ai===null?ai=[r]:ai.push(r)}function Ww(r){Lc=!0,$m(r)}function ji(){if(!Zd&&ai!==null){Zd=!0;var r=0,i=gt;try{var c=ai;for(gt=1;r<c.length;r++){var h=c[r];do h=h(!0);while(h!==null)}ai=null,Lc=!1}catch(p){throw ai!==null&&(ai=ai.slice(r+1)),xs(hr,ji),p}finally{gt=i,Zd=!1}}return null}var mo=[],go=0,Mc=null,Oc=0,as=[],os=0,Ea=null,oi=1,li="";function Ta(r,i){mo[go++]=Oc,mo[go++]=Mc,Mc=r,Oc=i}function Wm(r,i,c){as[os++]=oi,as[os++]=li,as[os++]=Ea,Ea=r;var h=oi;r=li;var p=32-L(h)-1;h&=~(1<<p),c+=1;var v=32-L(i)+p;if(30<v){var b=p-p%5;v=(h&(1<<b)-1).toString(32),h>>=b,p-=b,oi=1<<32-L(i)+p|c<<p|h,li=v+r}else oi=1<<v|c<<p|h,li=r}function eh(r){r.return!==null&&(Ta(r,1),Wm(r,1,0))}function th(r){for(;r===Mc;)Mc=mo[--go],mo[go]=null,Oc=mo[--go],mo[go]=null;for(;r===Ea;)Ea=as[--os],as[os]=null,li=as[--os],as[os]=null,oi=as[--os],as[os]=null}var Wr=null,Gr=null,qt=!1,Es=null;function Gm(r,i){var c=ds(5,null,null,0);c.elementType="DELETED",c.stateNode=i,c.return=r,i=r.deletions,i===null?(r.deletions=[c],r.flags|=16):i.push(c)}function qm(r,i){switch(r.tag){case 5:var c=r.type;return i=i.nodeType!==1||c.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(r.stateNode=i,Wr=r,Gr=Pi(i.firstChild),!0):!1;case 6:return i=r.pendingProps===""||i.nodeType!==3?null:i,i!==null?(r.stateNode=i,Wr=r,Gr=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(c=Ea!==null?{id:oi,overflow:li}:null,r.memoizedState={dehydrated:i,treeContext:c,retryLane:1073741824},c=ds(18,null,null,0),c.stateNode=i,c.return=r,r.child=c,Wr=r,Gr=null,!0):!1;default:return!1}}function nh(r){return(r.mode&1)!==0&&(r.flags&128)===0}function rh(r){if(qt){var i=Gr;if(i){var c=i;if(!qm(r,i)){if(nh(r))throw Error(t(418));i=Pi(c.nextSibling);var h=Wr;i&&qm(r,i)?Gm(h,c):(r.flags=r.flags&-4097|2,qt=!1,Wr=r)}}else{if(nh(r))throw Error(t(418));r.flags=r.flags&-4097|2,qt=!1,Wr=r}}}function Hm(r){for(r=r.return;r!==null&&r.tag!==5&&r.tag!==3&&r.tag!==13;)r=r.return;Wr=r}function Fc(r){if(r!==Wr)return!1;if(!qt)return Hm(r),qt=!0,!1;var i;if((i=r.tag!==3)&&!(i=r.tag!==5)&&(i=r.type,i=i!=="head"&&i!=="body"&&!Kd(r.type,r.memoizedProps)),i&&(i=Gr)){if(nh(r))throw Km(),Error(t(418));for(;i;)Gm(r,i),i=Pi(i.nextSibling)}if(Hm(r),r.tag===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(t(317));e:{for(r=r.nextSibling,i=0;r;){if(r.nodeType===8){var c=r.data;if(c==="/$"){if(i===0){Gr=Pi(r.nextSibling);break e}i--}else c!=="$"&&c!=="$!"&&c!=="$?"||i++}r=r.nextSibling}Gr=null}}else Gr=Wr?Pi(r.stateNode.nextSibling):null;return!0}function Km(){for(var r=Gr;r;)r=Pi(r.nextSibling)}function yo(){Gr=Wr=null,qt=!1}function sh(r){Es===null?Es=[r]:Es.push(r)}var Gw=we.ReactCurrentBatchConfig;function gl(r,i,c){if(r=c.ref,r!==null&&typeof r!="function"&&typeof r!="object"){if(c._owner){if(c=c._owner,c){if(c.tag!==1)throw Error(t(309));var h=c.stateNode}if(!h)throw Error(t(147,r));var p=h,v=""+r;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===v?i.ref:(i=function(b){var M=p.refs;b===null?delete M[v]:M[v]=b},i._stringRef=v,i)}if(typeof r!="string")throw Error(t(284));if(!c._owner)throw Error(t(290,r))}return r}function Uc(r,i){throw r=Object.prototype.toString.call(i),Error(t(31,r==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":r))}function Qm(r){var i=r._init;return i(r._payload)}function Ym(r){function i(te,K){if(r){var re=te.deletions;re===null?(te.deletions=[K],te.flags|=16):re.push(K)}}function c(te,K){if(!r)return null;for(;K!==null;)i(te,K),K=K.sibling;return null}function h(te,K){for(te=new Map;K!==null;)K.key!==null?te.set(K.key,K):te.set(K.index,K),K=K.sibling;return te}function p(te,K){return te=Ui(te,K),te.index=0,te.sibling=null,te}function v(te,K,re){return te.index=re,r?(re=te.alternate,re!==null?(re=re.index,re<K?(te.flags|=2,K):re):(te.flags|=2,K)):(te.flags|=1048576,K)}function b(te){return r&&te.alternate===null&&(te.flags|=2),te}function M(te,K,re,ke){return K===null||K.tag!==6?(K=Qh(re,te.mode,ke),K.return=te,K):(K=p(K,re),K.return=te,K)}function G(te,K,re,ke){var Ke=re.type;return Ke===I?Ie(te,K,re.props.children,ke,re.key):K!==null&&(K.elementType===Ke||typeof Ke=="object"&&Ke!==null&&Ke.$$typeof===Ce&&Qm(Ke)===K.type)?(ke=p(K,re.props),ke.ref=gl(te,K,re),ke.return=te,ke):(ke=uu(re.type,re.key,re.props,null,te.mode,ke),ke.ref=gl(te,K,re),ke.return=te,ke)}function oe(te,K,re,ke){return K===null||K.tag!==4||K.stateNode.containerInfo!==re.containerInfo||K.stateNode.implementation!==re.implementation?(K=Yh(re,te.mode,ke),K.return=te,K):(K=p(K,re.children||[]),K.return=te,K)}function Ie(te,K,re,ke,Ke){return K===null||K.tag!==7?(K=Aa(re,te.mode,ke,Ke),K.return=te,K):(K=p(K,re),K.return=te,K)}function Ne(te,K,re){if(typeof K=="string"&&K!==""||typeof K=="number")return K=Qh(""+K,te.mode,re),K.return=te,K;if(typeof K=="object"&&K!==null){switch(K.$$typeof){case O:return re=uu(K.type,K.key,K.props,null,te.mode,re),re.ref=gl(te,null,K),re.return=te,re;case ae:return K=Yh(K,te.mode,re),K.return=te,K;case Ce:var ke=K._init;return Ne(te,ke(K._payload),re)}if(cn(K)||Re(K))return K=Aa(K,te.mode,re,null),K.return=te,K;Uc(te,K)}return null}function Se(te,K,re,ke){var Ke=K!==null?K.key:null;if(typeof re=="string"&&re!==""||typeof re=="number")return Ke!==null?null:M(te,K,""+re,ke);if(typeof re=="object"&&re!==null){switch(re.$$typeof){case O:return re.key===Ke?G(te,K,re,ke):null;case ae:return re.key===Ke?oe(te,K,re,ke):null;case Ce:return Ke=re._init,Se(te,K,Ke(re._payload),ke)}if(cn(re)||Re(re))return Ke!==null?null:Ie(te,K,re,ke,null);Uc(te,re)}return null}function ze(te,K,re,ke,Ke){if(typeof ke=="string"&&ke!==""||typeof ke=="number")return te=te.get(re)||null,M(K,te,""+ke,Ke);if(typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case O:return te=te.get(ke.key===null?re:ke.key)||null,G(K,te,ke,Ke);case ae:return te=te.get(ke.key===null?re:ke.key)||null,oe(K,te,ke,Ke);case Ce:var et=ke._init;return ze(te,K,re,et(ke._payload),Ke)}if(cn(ke)||Re(ke))return te=te.get(re)||null,Ie(K,te,ke,Ke,null);Uc(K,ke)}return null}function Ge(te,K,re,ke){for(var Ke=null,et=null,tt=K,at=K=0,zn=null;tt!==null&&at<re.length;at++){tt.index>at?(zn=tt,tt=null):zn=tt.sibling;var Ct=Se(te,tt,re[at],ke);if(Ct===null){tt===null&&(tt=zn);break}r&&tt&&Ct.alternate===null&&i(te,tt),K=v(Ct,K,at),et===null?Ke=Ct:et.sibling=Ct,et=Ct,tt=zn}if(at===re.length)return c(te,tt),qt&&Ta(te,at),Ke;if(tt===null){for(;at<re.length;at++)tt=Ne(te,re[at],ke),tt!==null&&(K=v(tt,K,at),et===null?Ke=tt:et.sibling=tt,et=tt);return qt&&Ta(te,at),Ke}for(tt=h(te,tt);at<re.length;at++)zn=ze(tt,te,at,re[at],ke),zn!==null&&(r&&zn.alternate!==null&&tt.delete(zn.key===null?at:zn.key),K=v(zn,K,at),et===null?Ke=zn:et.sibling=zn,et=zn);return r&&tt.forEach(function(zi){return i(te,zi)}),qt&&Ta(te,at),Ke}function He(te,K,re,ke){var Ke=Re(re);if(typeof Ke!="function")throw Error(t(150));if(re=Ke.call(re),re==null)throw Error(t(151));for(var et=Ke=null,tt=K,at=K=0,zn=null,Ct=re.next();tt!==null&&!Ct.done;at++,Ct=re.next()){tt.index>at?(zn=tt,tt=null):zn=tt.sibling;var zi=Se(te,tt,Ct.value,ke);if(zi===null){tt===null&&(tt=zn);break}r&&tt&&zi.alternate===null&&i(te,tt),K=v(zi,K,at),et===null?Ke=zi:et.sibling=zi,et=zi,tt=zn}if(Ct.done)return c(te,tt),qt&&Ta(te,at),Ke;if(tt===null){for(;!Ct.done;at++,Ct=re.next())Ct=Ne(te,Ct.value,ke),Ct!==null&&(K=v(Ct,K,at),et===null?Ke=Ct:et.sibling=Ct,et=Ct);return qt&&Ta(te,at),Ke}for(tt=h(te,tt);!Ct.done;at++,Ct=re.next())Ct=ze(tt,te,at,Ct.value,ke),Ct!==null&&(r&&Ct.alternate!==null&&tt.delete(Ct.key===null?at:Ct.key),K=v(Ct,K,at),et===null?Ke=Ct:et.sibling=Ct,et=Ct);return r&&tt.forEach(function(SE){return i(te,SE)}),qt&&Ta(te,at),Ke}function fn(te,K,re,ke){if(typeof re=="object"&&re!==null&&re.type===I&&re.key===null&&(re=re.props.children),typeof re=="object"&&re!==null){switch(re.$$typeof){case O:e:{for(var Ke=re.key,et=K;et!==null;){if(et.key===Ke){if(Ke=re.type,Ke===I){if(et.tag===7){c(te,et.sibling),K=p(et,re.props.children),K.return=te,te=K;break e}}else if(et.elementType===Ke||typeof Ke=="object"&&Ke!==null&&Ke.$$typeof===Ce&&Qm(Ke)===et.type){c(te,et.sibling),K=p(et,re.props),K.ref=gl(te,et,re),K.return=te,te=K;break e}c(te,et);break}else i(te,et);et=et.sibling}re.type===I?(K=Aa(re.props.children,te.mode,ke,re.key),K.return=te,te=K):(ke=uu(re.type,re.key,re.props,null,te.mode,ke),ke.ref=gl(te,K,re),ke.return=te,te=ke)}return b(te);case ae:e:{for(et=re.key;K!==null;){if(K.key===et)if(K.tag===4&&K.stateNode.containerInfo===re.containerInfo&&K.stateNode.implementation===re.implementation){c(te,K.sibling),K=p(K,re.children||[]),K.return=te,te=K;break e}else{c(te,K);break}else i(te,K);K=K.sibling}K=Yh(re,te.mode,ke),K.return=te,te=K}return b(te);case Ce:return et=re._init,fn(te,K,et(re._payload),ke)}if(cn(re))return Ge(te,K,re,ke);if(Re(re))return He(te,K,re,ke);Uc(te,re)}return typeof re=="string"&&re!==""||typeof re=="number"?(re=""+re,K!==null&&K.tag===6?(c(te,K.sibling),K=p(K,re),K.return=te,te=K):(c(te,K),K=Qh(re,te.mode,ke),K.return=te,te=K),b(te)):c(te,K)}return fn}var vo=Ym(!0),Jm=Ym(!1),zc=Ri(null),Bc=null,_o=null,ih=null;function ah(){ih=_o=Bc=null}function oh(r){var i=zc.current;Wt(zc),r._currentValue=i}function lh(r,i,c){for(;r!==null;){var h=r.alternate;if((r.childLanes&i)!==i?(r.childLanes|=i,h!==null&&(h.childLanes|=i)):h!==null&&(h.childLanes&i)!==i&&(h.childLanes|=i),r===c)break;r=r.return}}function xo(r,i){Bc=r,ih=_o=null,r=r.dependencies,r!==null&&r.firstContext!==null&&((r.lanes&i)!==0&&(Cr=!0),r.firstContext=null)}function ls(r){var i=r._currentValue;if(ih!==r)if(r={context:r,memoizedValue:i,next:null},_o===null){if(Bc===null)throw Error(t(308));_o=r,Bc.dependencies={lanes:0,firstContext:r}}else _o=_o.next=r;return i}var Sa=null;function ch(r){Sa===null?Sa=[r]:Sa.push(r)}function Xm(r,i,c,h){var p=i.interleaved;return p===null?(c.next=c,ch(i)):(c.next=p.next,p.next=c),i.interleaved=c,ci(r,h)}function ci(r,i){r.lanes|=i;var c=r.alternate;for(c!==null&&(c.lanes|=i),c=r,r=r.return;r!==null;)r.childLanes|=i,c=r.alternate,c!==null&&(c.childLanes|=i),c=r,r=r.return;return c.tag===3?c.stateNode:null}var ki=!1;function uh(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Zm(r,i){r=r.updateQueue,i.updateQueue===r&&(i.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,effects:r.effects})}function ui(r,i){return{eventTime:r,lane:i,tag:0,payload:null,callback:null,next:null}}function Di(r,i,c){var h=r.updateQueue;if(h===null)return null;if(h=h.shared,(St&2)!==0){var p=h.pending;return p===null?i.next=i:(i.next=p.next,p.next=i),h.pending=i,ci(r,c)}return p=h.interleaved,p===null?(i.next=i,ch(h)):(i.next=p.next,p.next=i),h.interleaved=i,ci(r,c)}function $c(r,i,c){if(i=i.updateQueue,i!==null&&(i=i.shared,(c&4194240)!==0)){var h=i.lanes;h&=r.pendingLanes,c|=h,i.lanes=c,ts(r,c)}}function eg(r,i){var c=r.updateQueue,h=r.alternate;if(h!==null&&(h=h.updateQueue,c===h)){var p=null,v=null;if(c=c.firstBaseUpdate,c!==null){do{var b={eventTime:c.eventTime,lane:c.lane,tag:c.tag,payload:c.payload,callback:c.callback,next:null};v===null?p=v=b:v=v.next=b,c=c.next}while(c!==null);v===null?p=v=i:v=v.next=i}else p=v=i;c={baseState:h.baseState,firstBaseUpdate:p,lastBaseUpdate:v,shared:h.shared,effects:h.effects},r.updateQueue=c;return}r=c.lastBaseUpdate,r===null?c.firstBaseUpdate=i:r.next=i,c.lastBaseUpdate=i}function Wc(r,i,c,h){var p=r.updateQueue;ki=!1;var v=p.firstBaseUpdate,b=p.lastBaseUpdate,M=p.shared.pending;if(M!==null){p.shared.pending=null;var G=M,oe=G.next;G.next=null,b===null?v=oe:b.next=oe,b=G;var Ie=r.alternate;Ie!==null&&(Ie=Ie.updateQueue,M=Ie.lastBaseUpdate,M!==b&&(M===null?Ie.firstBaseUpdate=oe:M.next=oe,Ie.lastBaseUpdate=G))}if(v!==null){var Ne=p.baseState;b=0,Ie=oe=G=null,M=v;do{var Se=M.lane,ze=M.eventTime;if((h&Se)===Se){Ie!==null&&(Ie=Ie.next={eventTime:ze,lane:0,tag:M.tag,payload:M.payload,callback:M.callback,next:null});e:{var Ge=r,He=M;switch(Se=i,ze=c,He.tag){case 1:if(Ge=He.payload,typeof Ge=="function"){Ne=Ge.call(ze,Ne,Se);break e}Ne=Ge;break e;case 3:Ge.flags=Ge.flags&-65537|128;case 0:if(Ge=He.payload,Se=typeof Ge=="function"?Ge.call(ze,Ne,Se):Ge,Se==null)break e;Ne=Ee({},Ne,Se);break e;case 2:ki=!0}}M.callback!==null&&M.lane!==0&&(r.flags|=64,Se=p.effects,Se===null?p.effects=[M]:Se.push(M))}else ze={eventTime:ze,lane:Se,tag:M.tag,payload:M.payload,callback:M.callback,next:null},Ie===null?(oe=Ie=ze,G=Ne):Ie=Ie.next=ze,b|=Se;if(M=M.next,M===null){if(M=p.shared.pending,M===null)break;Se=M,M=Se.next,Se.next=null,p.lastBaseUpdate=Se,p.shared.pending=null}}while(!0);if(Ie===null&&(G=Ne),p.baseState=G,p.firstBaseUpdate=oe,p.lastBaseUpdate=Ie,i=p.shared.interleaved,i!==null){p=i;do b|=p.lane,p=p.next;while(p!==i)}else v===null&&(p.shared.lanes=0);Ia|=b,r.lanes=b,r.memoizedState=Ne}}function tg(r,i,c){if(r=i.effects,i.effects=null,r!==null)for(i=0;i<r.length;i++){var h=r[i],p=h.callback;if(p!==null){if(h.callback=null,h=c,typeof p!="function")throw Error(t(191,p));p.call(h)}}}var yl={},Ws=Ri(yl),vl=Ri(yl),_l=Ri(yl);function ba(r){if(r===yl)throw Error(t(174));return r}function dh(r,i){switch(Ft(_l,i),Ft(vl,r),Ft(Ws,yl),r=i.nodeType,r){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:Dt(null,"");break;default:r=r===8?i.parentNode:i,i=r.namespaceURI||null,r=r.tagName,i=Dt(i,r)}Wt(Ws),Ft(Ws,i)}function wo(){Wt(Ws),Wt(vl),Wt(_l)}function ng(r){ba(_l.current);var i=ba(Ws.current),c=Dt(i,r.type);i!==c&&(Ft(vl,r),Ft(Ws,c))}function hh(r){vl.current===r&&(Wt(Ws),Wt(vl))}var Yt=Ri(0);function Gc(r){for(var i=r;i!==null;){if(i.tag===13){var c=i.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||c.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===r)break;for(;i.sibling===null;){if(i.return===null||i.return===r)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var fh=[];function ph(){for(var r=0;r<fh.length;r++)fh[r]._workInProgressVersionPrimary=null;fh.length=0}var qc=we.ReactCurrentDispatcher,mh=we.ReactCurrentBatchConfig,Ca=0,Jt=null,Pn=null,Fn=null,Hc=!1,xl=!1,wl=0,qw=0;function nr(){throw Error(t(321))}function gh(r,i){if(i===null)return!1;for(var c=0;c<i.length&&c<r.length;c++)if(!ws(r[c],i[c]))return!1;return!0}function yh(r,i,c,h,p,v){if(Ca=v,Jt=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,qc.current=r===null||r.memoizedState===null?Yw:Jw,r=c(h,p),xl){v=0;do{if(xl=!1,wl=0,25<=v)throw Error(t(301));v+=1,Fn=Pn=null,i.updateQueue=null,qc.current=Xw,r=c(h,p)}while(xl)}if(qc.current=Yc,i=Pn!==null&&Pn.next!==null,Ca=0,Fn=Pn=Jt=null,Hc=!1,i)throw Error(t(300));return r}function vh(){var r=wl!==0;return wl=0,r}function Gs(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Fn===null?Jt.memoizedState=Fn=r:Fn=Fn.next=r,Fn}function cs(){if(Pn===null){var r=Jt.alternate;r=r!==null?r.memoizedState:null}else r=Pn.next;var i=Fn===null?Jt.memoizedState:Fn.next;if(i!==null)Fn=i,Pn=r;else{if(r===null)throw Error(t(310));Pn=r,r={memoizedState:Pn.memoizedState,baseState:Pn.baseState,baseQueue:Pn.baseQueue,queue:Pn.queue,next:null},Fn===null?Jt.memoizedState=Fn=r:Fn=Fn.next=r}return Fn}function El(r,i){return typeof i=="function"?i(r):i}function _h(r){var i=cs(),c=i.queue;if(c===null)throw Error(t(311));c.lastRenderedReducer=r;var h=Pn,p=h.baseQueue,v=c.pending;if(v!==null){if(p!==null){var b=p.next;p.next=v.next,v.next=b}h.baseQueue=p=v,c.pending=null}if(p!==null){v=p.next,h=h.baseState;var M=b=null,G=null,oe=v;do{var Ie=oe.lane;if((Ca&Ie)===Ie)G!==null&&(G=G.next={lane:0,action:oe.action,hasEagerState:oe.hasEagerState,eagerState:oe.eagerState,next:null}),h=oe.hasEagerState?oe.eagerState:r(h,oe.action);else{var Ne={lane:Ie,action:oe.action,hasEagerState:oe.hasEagerState,eagerState:oe.eagerState,next:null};G===null?(M=G=Ne,b=h):G=G.next=Ne,Jt.lanes|=Ie,Ia|=Ie}oe=oe.next}while(oe!==null&&oe!==v);G===null?b=h:G.next=M,ws(h,i.memoizedState)||(Cr=!0),i.memoizedState=h,i.baseState=b,i.baseQueue=G,c.lastRenderedState=h}if(r=c.interleaved,r!==null){p=r;do v=p.lane,Jt.lanes|=v,Ia|=v,p=p.next;while(p!==r)}else p===null&&(c.lanes=0);return[i.memoizedState,c.dispatch]}function xh(r){var i=cs(),c=i.queue;if(c===null)throw Error(t(311));c.lastRenderedReducer=r;var h=c.dispatch,p=c.pending,v=i.memoizedState;if(p!==null){c.pending=null;var b=p=p.next;do v=r(v,b.action),b=b.next;while(b!==p);ws(v,i.memoizedState)||(Cr=!0),i.memoizedState=v,i.baseQueue===null&&(i.baseState=v),c.lastRenderedState=v}return[v,h]}function rg(){}function sg(r,i){var c=Jt,h=cs(),p=i(),v=!ws(h.memoizedState,p);if(v&&(h.memoizedState=p,Cr=!0),h=h.queue,wh(og.bind(null,c,h,r),[r]),h.getSnapshot!==i||v||Fn!==null&&Fn.memoizedState.tag&1){if(c.flags|=2048,Tl(9,ag.bind(null,c,h,p,i),void 0,null),Un===null)throw Error(t(349));(Ca&30)!==0||ig(c,i,p)}return p}function ig(r,i,c){r.flags|=16384,r={getSnapshot:i,value:c},i=Jt.updateQueue,i===null?(i={lastEffect:null,stores:null},Jt.updateQueue=i,i.stores=[r]):(c=i.stores,c===null?i.stores=[r]:c.push(r))}function ag(r,i,c,h){i.value=c,i.getSnapshot=h,lg(i)&&cg(r)}function og(r,i,c){return c(function(){lg(i)&&cg(r)})}function lg(r){var i=r.getSnapshot;r=r.value;try{var c=i();return!ws(r,c)}catch{return!0}}function cg(r){var i=ci(r,1);i!==null&&Cs(i,r,1,-1)}function ug(r){var i=Gs();return typeof r=="function"&&(r=r()),i.memoizedState=i.baseState=r,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:El,lastRenderedState:r},i.queue=r,r=r.dispatch=Qw.bind(null,Jt,r),[i.memoizedState,r]}function Tl(r,i,c,h){return r={tag:r,create:i,destroy:c,deps:h,next:null},i=Jt.updateQueue,i===null?(i={lastEffect:null,stores:null},Jt.updateQueue=i,i.lastEffect=r.next=r):(c=i.lastEffect,c===null?i.lastEffect=r.next=r:(h=c.next,c.next=r,r.next=h,i.lastEffect=r)),r}function dg(){return cs().memoizedState}function Kc(r,i,c,h){var p=Gs();Jt.flags|=r,p.memoizedState=Tl(1|i,c,void 0,h===void 0?null:h)}function Qc(r,i,c,h){var p=cs();h=h===void 0?null:h;var v=void 0;if(Pn!==null){var b=Pn.memoizedState;if(v=b.destroy,h!==null&&gh(h,b.deps)){p.memoizedState=Tl(i,c,v,h);return}}Jt.flags|=r,p.memoizedState=Tl(1|i,c,v,h)}function hg(r,i){return Kc(8390656,8,r,i)}function wh(r,i){return Qc(2048,8,r,i)}function fg(r,i){return Qc(4,2,r,i)}function pg(r,i){return Qc(4,4,r,i)}function mg(r,i){if(typeof i=="function")return r=r(),i(r),function(){i(null)};if(i!=null)return r=r(),i.current=r,function(){i.current=null}}function gg(r,i,c){return c=c!=null?c.concat([r]):null,Qc(4,4,mg.bind(null,i,r),c)}function Eh(){}function yg(r,i){var c=cs();i=i===void 0?null:i;var h=c.memoizedState;return h!==null&&i!==null&&gh(i,h[1])?h[0]:(c.memoizedState=[r,i],r)}function vg(r,i){var c=cs();i=i===void 0?null:i;var h=c.memoizedState;return h!==null&&i!==null&&gh(i,h[1])?h[0]:(r=r(),c.memoizedState=[r,i],r)}function _g(r,i,c){return(Ca&21)===0?(r.baseState&&(r.baseState=!1,Cr=!0),r.memoizedState=c):(ws(c,i)||(c=rn(),Jt.lanes|=c,Ia|=c,r.baseState=!0),i)}function Hw(r,i){var c=gt;gt=c!==0&&4>c?c:4,r(!0);var h=mh.transition;mh.transition={};try{r(!1),i()}finally{gt=c,mh.transition=h}}function xg(){return cs().memoizedState}function Kw(r,i,c){var h=Oi(r);if(c={lane:h,action:c,hasEagerState:!1,eagerState:null,next:null},wg(r))Eg(i,c);else if(c=Xm(r,i,c,h),c!==null){var p=gr();Cs(c,r,h,p),Tg(c,i,h)}}function Qw(r,i,c){var h=Oi(r),p={lane:h,action:c,hasEagerState:!1,eagerState:null,next:null};if(wg(r))Eg(i,p);else{var v=r.alternate;if(r.lanes===0&&(v===null||v.lanes===0)&&(v=i.lastRenderedReducer,v!==null))try{var b=i.lastRenderedState,M=v(b,c);if(p.hasEagerState=!0,p.eagerState=M,ws(M,b)){var G=i.interleaved;G===null?(p.next=p,ch(i)):(p.next=G.next,G.next=p),i.interleaved=p;return}}catch{}finally{}c=Xm(r,i,p,h),c!==null&&(p=gr(),Cs(c,r,h,p),Tg(c,i,h))}}function wg(r){var i=r.alternate;return r===Jt||i!==null&&i===Jt}function Eg(r,i){xl=Hc=!0;var c=r.pending;c===null?i.next=i:(i.next=c.next,c.next=i),r.pending=i}function Tg(r,i,c){if((c&4194240)!==0){var h=i.lanes;h&=r.pendingLanes,c|=h,i.lanes=c,ts(r,c)}}var Yc={readContext:ls,useCallback:nr,useContext:nr,useEffect:nr,useImperativeHandle:nr,useInsertionEffect:nr,useLayoutEffect:nr,useMemo:nr,useReducer:nr,useRef:nr,useState:nr,useDebugValue:nr,useDeferredValue:nr,useTransition:nr,useMutableSource:nr,useSyncExternalStore:nr,useId:nr,unstable_isNewReconciler:!1},Yw={readContext:ls,useCallback:function(r,i){return Gs().memoizedState=[r,i===void 0?null:i],r},useContext:ls,useEffect:hg,useImperativeHandle:function(r,i,c){return c=c!=null?c.concat([r]):null,Kc(4194308,4,mg.bind(null,i,r),c)},useLayoutEffect:function(r,i){return Kc(4194308,4,r,i)},useInsertionEffect:function(r,i){return Kc(4,2,r,i)},useMemo:function(r,i){var c=Gs();return i=i===void 0?null:i,r=r(),c.memoizedState=[r,i],r},useReducer:function(r,i,c){var h=Gs();return i=c!==void 0?c(i):i,h.memoizedState=h.baseState=i,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:i},h.queue=r,r=r.dispatch=Kw.bind(null,Jt,r),[h.memoizedState,r]},useRef:function(r){var i=Gs();return r={current:r},i.memoizedState=r},useState:ug,useDebugValue:Eh,useDeferredValue:function(r){return Gs().memoizedState=r},useTransition:function(){var r=ug(!1),i=r[0];return r=Hw.bind(null,r[1]),Gs().memoizedState=r,[i,r]},useMutableSource:function(){},useSyncExternalStore:function(r,i,c){var h=Jt,p=Gs();if(qt){if(c===void 0)throw Error(t(407));c=c()}else{if(c=i(),Un===null)throw Error(t(349));(Ca&30)!==0||ig(h,i,c)}p.memoizedState=c;var v={value:c,getSnapshot:i};return p.queue=v,hg(og.bind(null,h,v,r),[r]),h.flags|=2048,Tl(9,ag.bind(null,h,v,c,i),void 0,null),c},useId:function(){var r=Gs(),i=Un.identifierPrefix;if(qt){var c=li,h=oi;c=(h&~(1<<32-L(h)-1)).toString(32)+c,i=":"+i+"R"+c,c=wl++,0<c&&(i+="H"+c.toString(32)),i+=":"}else c=qw++,i=":"+i+"r"+c.toString(32)+":";return r.memoizedState=i},unstable_isNewReconciler:!1},Jw={readContext:ls,useCallback:yg,useContext:ls,useEffect:wh,useImperativeHandle:gg,useInsertionEffect:fg,useLayoutEffect:pg,useMemo:vg,useReducer:_h,useRef:dg,useState:function(){return _h(El)},useDebugValue:Eh,useDeferredValue:function(r){var i=cs();return _g(i,Pn.memoizedState,r)},useTransition:function(){var r=_h(El)[0],i=cs().memoizedState;return[r,i]},useMutableSource:rg,useSyncExternalStore:sg,useId:xg,unstable_isNewReconciler:!1},Xw={readContext:ls,useCallback:yg,useContext:ls,useEffect:wh,useImperativeHandle:gg,useInsertionEffect:fg,useLayoutEffect:pg,useMemo:vg,useReducer:xh,useRef:dg,useState:function(){return xh(El)},useDebugValue:Eh,useDeferredValue:function(r){var i=cs();return Pn===null?i.memoizedState=r:_g(i,Pn.memoizedState,r)},useTransition:function(){var r=xh(El)[0],i=cs().memoizedState;return[r,i]},useMutableSource:rg,useSyncExternalStore:sg,useId:xg,unstable_isNewReconciler:!1};function Ts(r,i){if(r&&r.defaultProps){i=Ee({},i),r=r.defaultProps;for(var c in r)i[c]===void 0&&(i[c]=r[c]);return i}return i}function Th(r,i,c,h){i=r.memoizedState,c=c(h,i),c=c==null?i:Ee({},i,c),r.memoizedState=c,r.lanes===0&&(r.updateQueue.baseState=c)}var Jc={isMounted:function(r){return(r=r._reactInternals)?yn(r)===r:!1},enqueueSetState:function(r,i,c){r=r._reactInternals;var h=gr(),p=Oi(r),v=ui(h,p);v.payload=i,c!=null&&(v.callback=c),i=Di(r,v,p),i!==null&&(Cs(i,r,p,h),$c(i,r,p))},enqueueReplaceState:function(r,i,c){r=r._reactInternals;var h=gr(),p=Oi(r),v=ui(h,p);v.tag=1,v.payload=i,c!=null&&(v.callback=c),i=Di(r,v,p),i!==null&&(Cs(i,r,p,h),$c(i,r,p))},enqueueForceUpdate:function(r,i){r=r._reactInternals;var c=gr(),h=Oi(r),p=ui(c,h);p.tag=2,i!=null&&(p.callback=i),i=Di(r,p,h),i!==null&&(Cs(i,r,h,c),$c(i,r,h))}};function Sg(r,i,c,h,p,v,b){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(h,v,b):i.prototype&&i.prototype.isPureReactComponent?!cl(c,h)||!cl(p,v):!0}function bg(r,i,c){var h=!1,p=Ai,v=i.contextType;return typeof v=="object"&&v!==null?v=ls(v):(p=br(i)?wa:tr.current,h=i.contextTypes,v=(h=h!=null)?po(r,p):Ai),i=new i(c,v),r.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=Jc,r.stateNode=i,i._reactInternals=r,h&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=p,r.__reactInternalMemoizedMaskedChildContext=v),i}function Cg(r,i,c,h){r=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(c,h),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(c,h),i.state!==r&&Jc.enqueueReplaceState(i,i.state,null)}function Sh(r,i,c,h){var p=r.stateNode;p.props=c,p.state=r.memoizedState,p.refs={},uh(r);var v=i.contextType;typeof v=="object"&&v!==null?p.context=ls(v):(v=br(i)?wa:tr.current,p.context=po(r,v)),p.state=r.memoizedState,v=i.getDerivedStateFromProps,typeof v=="function"&&(Th(r,i,v,c),p.state=r.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(i=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),i!==p.state&&Jc.enqueueReplaceState(p,p.state,null),Wc(r,c,p,h),p.state=r.memoizedState),typeof p.componentDidMount=="function"&&(r.flags|=4194308)}function Eo(r,i){try{var c="",h=i;do c+=Le(h),h=h.return;while(h);var p=c}catch(v){p=`
Error generating stack: `+v.message+`
`+v.stack}return{value:r,source:i,stack:p,digest:null}}function bh(r,i,c){return{value:r,source:null,stack:c??null,digest:i??null}}function Ch(r,i){try{console.error(i.value)}catch(c){setTimeout(function(){throw c})}}var Zw=typeof WeakMap=="function"?WeakMap:Map;function Ig(r,i,c){c=ui(-1,c),c.tag=3,c.payload={element:null};var h=i.value;return c.callback=function(){su||(su=!0,zh=h),Ch(r,i)},c}function Ng(r,i,c){c=ui(-1,c),c.tag=3;var h=r.type.getDerivedStateFromError;if(typeof h=="function"){var p=i.value;c.payload=function(){return h(p)},c.callback=function(){Ch(r,i)}}var v=r.stateNode;return v!==null&&typeof v.componentDidCatch=="function"&&(c.callback=function(){Ch(r,i),typeof h!="function"&&(Li===null?Li=new Set([this]):Li.add(this));var b=i.stack;this.componentDidCatch(i.value,{componentStack:b!==null?b:""})}),c}function Pg(r,i,c){var h=r.pingCache;if(h===null){h=r.pingCache=new Zw;var p=new Set;h.set(i,p)}else p=h.get(i),p===void 0&&(p=new Set,h.set(i,p));p.has(c)||(p.add(c),r=fE.bind(null,r,i,c),i.then(r,r))}function Rg(r){do{var i;if((i=r.tag===13)&&(i=r.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return r;r=r.return}while(r!==null);return null}function Ag(r,i,c,h,p){return(r.mode&1)===0?(r===i?r.flags|=65536:(r.flags|=128,c.flags|=131072,c.flags&=-52805,c.tag===1&&(c.alternate===null?c.tag=17:(i=ui(-1,1),i.tag=2,Di(c,i,1))),c.lanes|=1),r):(r.flags|=65536,r.lanes=p,r)}var eE=we.ReactCurrentOwner,Cr=!1;function mr(r,i,c,h){i.child=r===null?Jm(i,null,c,h):vo(i,r.child,c,h)}function jg(r,i,c,h,p){c=c.render;var v=i.ref;return xo(i,p),h=yh(r,i,c,h,v,p),c=vh(),r!==null&&!Cr?(i.updateQueue=r.updateQueue,i.flags&=-2053,r.lanes&=~p,di(r,i,p)):(qt&&c&&eh(i),i.flags|=1,mr(r,i,h,p),i.child)}function kg(r,i,c,h,p){if(r===null){var v=c.type;return typeof v=="function"&&!Kh(v)&&v.defaultProps===void 0&&c.compare===null&&c.defaultProps===void 0?(i.tag=15,i.type=v,Dg(r,i,v,h,p)):(r=uu(c.type,null,h,i,i.mode,p),r.ref=i.ref,r.return=i,i.child=r)}if(v=r.child,(r.lanes&p)===0){var b=v.memoizedProps;if(c=c.compare,c=c!==null?c:cl,c(b,h)&&r.ref===i.ref)return di(r,i,p)}return i.flags|=1,r=Ui(v,h),r.ref=i.ref,r.return=i,i.child=r}function Dg(r,i,c,h,p){if(r!==null){var v=r.memoizedProps;if(cl(v,h)&&r.ref===i.ref)if(Cr=!1,i.pendingProps=h=v,(r.lanes&p)!==0)(r.flags&131072)!==0&&(Cr=!0);else return i.lanes=r.lanes,di(r,i,p)}return Ih(r,i,c,h,p)}function Vg(r,i,c){var h=i.pendingProps,p=h.children,v=r!==null?r.memoizedState:null;if(h.mode==="hidden")if((i.mode&1)===0)i.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ft(So,qr),qr|=c;else{if((c&1073741824)===0)return r=v!==null?v.baseLanes|c:c,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:r,cachePool:null,transitions:null},i.updateQueue=null,Ft(So,qr),qr|=r,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},h=v!==null?v.baseLanes:c,Ft(So,qr),qr|=h}else v!==null?(h=v.baseLanes|c,i.memoizedState=null):h=c,Ft(So,qr),qr|=h;return mr(r,i,p,c),i.child}function Lg(r,i){var c=i.ref;(r===null&&c!==null||r!==null&&r.ref!==c)&&(i.flags|=512,i.flags|=2097152)}function Ih(r,i,c,h,p){var v=br(c)?wa:tr.current;return v=po(i,v),xo(i,p),c=yh(r,i,c,h,v,p),h=vh(),r!==null&&!Cr?(i.updateQueue=r.updateQueue,i.flags&=-2053,r.lanes&=~p,di(r,i,p)):(qt&&h&&eh(i),i.flags|=1,mr(r,i,c,p),i.child)}function Mg(r,i,c,h,p){if(br(c)){var v=!0;Vc(i)}else v=!1;if(xo(i,p),i.stateNode===null)Zc(r,i),bg(i,c,h),Sh(i,c,h,p),h=!0;else if(r===null){var b=i.stateNode,M=i.memoizedProps;b.props=M;var G=b.context,oe=c.contextType;typeof oe=="object"&&oe!==null?oe=ls(oe):(oe=br(c)?wa:tr.current,oe=po(i,oe));var Ie=c.getDerivedStateFromProps,Ne=typeof Ie=="function"||typeof b.getSnapshotBeforeUpdate=="function";Ne||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(M!==h||G!==oe)&&Cg(i,b,h,oe),ki=!1;var Se=i.memoizedState;b.state=Se,Wc(i,h,b,p),G=i.memoizedState,M!==h||Se!==G||Sr.current||ki?(typeof Ie=="function"&&(Th(i,c,Ie,h),G=i.memoizedState),(M=ki||Sg(i,c,M,h,Se,G,oe))?(Ne||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount()),typeof b.componentDidMount=="function"&&(i.flags|=4194308)):(typeof b.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=h,i.memoizedState=G),b.props=h,b.state=G,b.context=oe,h=M):(typeof b.componentDidMount=="function"&&(i.flags|=4194308),h=!1)}else{b=i.stateNode,Zm(r,i),M=i.memoizedProps,oe=i.type===i.elementType?M:Ts(i.type,M),b.props=oe,Ne=i.pendingProps,Se=b.context,G=c.contextType,typeof G=="object"&&G!==null?G=ls(G):(G=br(c)?wa:tr.current,G=po(i,G));var ze=c.getDerivedStateFromProps;(Ie=typeof ze=="function"||typeof b.getSnapshotBeforeUpdate=="function")||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(M!==Ne||Se!==G)&&Cg(i,b,h,G),ki=!1,Se=i.memoizedState,b.state=Se,Wc(i,h,b,p);var Ge=i.memoizedState;M!==Ne||Se!==Ge||Sr.current||ki?(typeof ze=="function"&&(Th(i,c,ze,h),Ge=i.memoizedState),(oe=ki||Sg(i,c,oe,h,Se,Ge,G)||!1)?(Ie||typeof b.UNSAFE_componentWillUpdate!="function"&&typeof b.componentWillUpdate!="function"||(typeof b.componentWillUpdate=="function"&&b.componentWillUpdate(h,Ge,G),typeof b.UNSAFE_componentWillUpdate=="function"&&b.UNSAFE_componentWillUpdate(h,Ge,G)),typeof b.componentDidUpdate=="function"&&(i.flags|=4),typeof b.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof b.componentDidUpdate!="function"||M===r.memoizedProps&&Se===r.memoizedState||(i.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||M===r.memoizedProps&&Se===r.memoizedState||(i.flags|=1024),i.memoizedProps=h,i.memoizedState=Ge),b.props=h,b.state=Ge,b.context=G,h=oe):(typeof b.componentDidUpdate!="function"||M===r.memoizedProps&&Se===r.memoizedState||(i.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||M===r.memoizedProps&&Se===r.memoizedState||(i.flags|=1024),h=!1)}return Nh(r,i,c,h,v,p)}function Nh(r,i,c,h,p,v){Lg(r,i);var b=(i.flags&128)!==0;if(!h&&!b)return p&&Bm(i,c,!1),di(r,i,v);h=i.stateNode,eE.current=i;var M=b&&typeof c.getDerivedStateFromError!="function"?null:h.render();return i.flags|=1,r!==null&&b?(i.child=vo(i,r.child,null,v),i.child=vo(i,null,M,v)):mr(r,i,M,v),i.memoizedState=h.state,p&&Bm(i,c,!0),i.child}function Og(r){var i=r.stateNode;i.pendingContext?Um(r,i.pendingContext,i.pendingContext!==i.context):i.context&&Um(r,i.context,!1),dh(r,i.containerInfo)}function Fg(r,i,c,h,p){return yo(),sh(p),i.flags|=256,mr(r,i,c,h),i.child}var Ph={dehydrated:null,treeContext:null,retryLane:0};function Rh(r){return{baseLanes:r,cachePool:null,transitions:null}}function Ug(r,i,c){var h=i.pendingProps,p=Yt.current,v=!1,b=(i.flags&128)!==0,M;if((M=b)||(M=r!==null&&r.memoizedState===null?!1:(p&2)!==0),M?(v=!0,i.flags&=-129):(r===null||r.memoizedState!==null)&&(p|=1),Ft(Yt,p&1),r===null)return rh(i),r=i.memoizedState,r!==null&&(r=r.dehydrated,r!==null)?((i.mode&1)===0?i.lanes=1:r.data==="$!"?i.lanes=8:i.lanes=1073741824,null):(b=h.children,r=h.fallback,v?(h=i.mode,v=i.child,b={mode:"hidden",children:b},(h&1)===0&&v!==null?(v.childLanes=0,v.pendingProps=b):v=du(b,h,0,null),r=Aa(r,h,c,null),v.return=i,r.return=i,v.sibling=r,i.child=v,i.child.memoizedState=Rh(c),i.memoizedState=Ph,r):Ah(i,b));if(p=r.memoizedState,p!==null&&(M=p.dehydrated,M!==null))return tE(r,i,b,h,M,p,c);if(v){v=h.fallback,b=i.mode,p=r.child,M=p.sibling;var G={mode:"hidden",children:h.children};return(b&1)===0&&i.child!==p?(h=i.child,h.childLanes=0,h.pendingProps=G,i.deletions=null):(h=Ui(p,G),h.subtreeFlags=p.subtreeFlags&14680064),M!==null?v=Ui(M,v):(v=Aa(v,b,c,null),v.flags|=2),v.return=i,h.return=i,h.sibling=v,i.child=h,h=v,v=i.child,b=r.child.memoizedState,b=b===null?Rh(c):{baseLanes:b.baseLanes|c,cachePool:null,transitions:b.transitions},v.memoizedState=b,v.childLanes=r.childLanes&~c,i.memoizedState=Ph,h}return v=r.child,r=v.sibling,h=Ui(v,{mode:"visible",children:h.children}),(i.mode&1)===0&&(h.lanes=c),h.return=i,h.sibling=null,r!==null&&(c=i.deletions,c===null?(i.deletions=[r],i.flags|=16):c.push(r)),i.child=h,i.memoizedState=null,h}function Ah(r,i){return i=du({mode:"visible",children:i},r.mode,0,null),i.return=r,r.child=i}function Xc(r,i,c,h){return h!==null&&sh(h),vo(i,r.child,null,c),r=Ah(i,i.pendingProps.children),r.flags|=2,i.memoizedState=null,r}function tE(r,i,c,h,p,v,b){if(c)return i.flags&256?(i.flags&=-257,h=bh(Error(t(422))),Xc(r,i,b,h)):i.memoizedState!==null?(i.child=r.child,i.flags|=128,null):(v=h.fallback,p=i.mode,h=du({mode:"visible",children:h.children},p,0,null),v=Aa(v,p,b,null),v.flags|=2,h.return=i,v.return=i,h.sibling=v,i.child=h,(i.mode&1)!==0&&vo(i,r.child,null,b),i.child.memoizedState=Rh(b),i.memoizedState=Ph,v);if((i.mode&1)===0)return Xc(r,i,b,null);if(p.data==="$!"){if(h=p.nextSibling&&p.nextSibling.dataset,h)var M=h.dgst;return h=M,v=Error(t(419)),h=bh(v,h,void 0),Xc(r,i,b,h)}if(M=(b&r.childLanes)!==0,Cr||M){if(h=Un,h!==null){switch(b&-b){case 4:p=2;break;case 16:p=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:p=32;break;case 536870912:p=268435456;break;default:p=0}p=(p&(h.suspendedLanes|b))!==0?0:p,p!==0&&p!==v.retryLane&&(v.retryLane=p,ci(r,p),Cs(h,r,p,-1))}return Hh(),h=bh(Error(t(421))),Xc(r,i,b,h)}return p.data==="$?"?(i.flags|=128,i.child=r.child,i=pE.bind(null,r),p._reactRetry=i,null):(r=v.treeContext,Gr=Pi(p.nextSibling),Wr=i,qt=!0,Es=null,r!==null&&(as[os++]=oi,as[os++]=li,as[os++]=Ea,oi=r.id,li=r.overflow,Ea=i),i=Ah(i,h.children),i.flags|=4096,i)}function zg(r,i,c){r.lanes|=i;var h=r.alternate;h!==null&&(h.lanes|=i),lh(r.return,i,c)}function jh(r,i,c,h,p){var v=r.memoizedState;v===null?r.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:h,tail:c,tailMode:p}:(v.isBackwards=i,v.rendering=null,v.renderingStartTime=0,v.last=h,v.tail=c,v.tailMode=p)}function Bg(r,i,c){var h=i.pendingProps,p=h.revealOrder,v=h.tail;if(mr(r,i,h.children,c),h=Yt.current,(h&2)!==0)h=h&1|2,i.flags|=128;else{if(r!==null&&(r.flags&128)!==0)e:for(r=i.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&zg(r,c,i);else if(r.tag===19)zg(r,c,i);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===i)break e;for(;r.sibling===null;){if(r.return===null||r.return===i)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}h&=1}if(Ft(Yt,h),(i.mode&1)===0)i.memoizedState=null;else switch(p){case"forwards":for(c=i.child,p=null;c!==null;)r=c.alternate,r!==null&&Gc(r)===null&&(p=c),c=c.sibling;c=p,c===null?(p=i.child,i.child=null):(p=c.sibling,c.sibling=null),jh(i,!1,p,c,v);break;case"backwards":for(c=null,p=i.child,i.child=null;p!==null;){if(r=p.alternate,r!==null&&Gc(r)===null){i.child=p;break}r=p.sibling,p.sibling=c,c=p,p=r}jh(i,!0,c,null,v);break;case"together":jh(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function Zc(r,i){(i.mode&1)===0&&r!==null&&(r.alternate=null,i.alternate=null,i.flags|=2)}function di(r,i,c){if(r!==null&&(i.dependencies=r.dependencies),Ia|=i.lanes,(c&i.childLanes)===0)return null;if(r!==null&&i.child!==r.child)throw Error(t(153));if(i.child!==null){for(r=i.child,c=Ui(r,r.pendingProps),i.child=c,c.return=i;r.sibling!==null;)r=r.sibling,c=c.sibling=Ui(r,r.pendingProps),c.return=i;c.sibling=null}return i.child}function nE(r,i,c){switch(i.tag){case 3:Og(i),yo();break;case 5:ng(i);break;case 1:br(i.type)&&Vc(i);break;case 4:dh(i,i.stateNode.containerInfo);break;case 10:var h=i.type._context,p=i.memoizedProps.value;Ft(zc,h._currentValue),h._currentValue=p;break;case 13:if(h=i.memoizedState,h!==null)return h.dehydrated!==null?(Ft(Yt,Yt.current&1),i.flags|=128,null):(c&i.child.childLanes)!==0?Ug(r,i,c):(Ft(Yt,Yt.current&1),r=di(r,i,c),r!==null?r.sibling:null);Ft(Yt,Yt.current&1);break;case 19:if(h=(c&i.childLanes)!==0,(r.flags&128)!==0){if(h)return Bg(r,i,c);i.flags|=128}if(p=i.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),Ft(Yt,Yt.current),h)break;return null;case 22:case 23:return i.lanes=0,Vg(r,i,c)}return di(r,i,c)}var $g,kh,Wg,Gg;$g=function(r,i){for(var c=i.child;c!==null;){if(c.tag===5||c.tag===6)r.appendChild(c.stateNode);else if(c.tag!==4&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===i)break;for(;c.sibling===null;){if(c.return===null||c.return===i)return;c=c.return}c.sibling.return=c.return,c=c.sibling}},kh=function(){},Wg=function(r,i,c,h){var p=r.memoizedProps;if(p!==h){r=i.stateNode,ba(Ws.current);var v=null;switch(c){case"input":p=qe(r,p),h=qe(r,h),v=[];break;case"select":p=Ee({},p,{value:void 0}),h=Ee({},h,{value:void 0}),v=[];break;case"textarea":p=yr(r,p),h=yr(r,h),v=[];break;default:typeof p.onClick!="function"&&typeof h.onClick=="function"&&(r.onclick=jc)}vs(c,h);var b;c=null;for(oe in p)if(!h.hasOwnProperty(oe)&&p.hasOwnProperty(oe)&&p[oe]!=null)if(oe==="style"){var M=p[oe];for(b in M)M.hasOwnProperty(b)&&(c||(c={}),c[b]="")}else oe!=="dangerouslySetInnerHTML"&&oe!=="children"&&oe!=="suppressContentEditableWarning"&&oe!=="suppressHydrationWarning"&&oe!=="autoFocus"&&(a.hasOwnProperty(oe)?v||(v=[]):(v=v||[]).push(oe,null));for(oe in h){var G=h[oe];if(M=p!=null?p[oe]:void 0,h.hasOwnProperty(oe)&&G!==M&&(G!=null||M!=null))if(oe==="style")if(M){for(b in M)!M.hasOwnProperty(b)||G&&G.hasOwnProperty(b)||(c||(c={}),c[b]="");for(b in G)G.hasOwnProperty(b)&&M[b]!==G[b]&&(c||(c={}),c[b]=G[b])}else c||(v||(v=[]),v.push(oe,c)),c=G;else oe==="dangerouslySetInnerHTML"?(G=G?G.__html:void 0,M=M?M.__html:void 0,G!=null&&M!==G&&(v=v||[]).push(oe,G)):oe==="children"?typeof G!="string"&&typeof G!="number"||(v=v||[]).push(oe,""+G):oe!=="suppressContentEditableWarning"&&oe!=="suppressHydrationWarning"&&(a.hasOwnProperty(oe)?(G!=null&&oe==="onScroll"&&$t("scroll",r),v||M===G||(v=[])):(v=v||[]).push(oe,G))}c&&(v=v||[]).push("style",c);var oe=v;(i.updateQueue=oe)&&(i.flags|=4)}},Gg=function(r,i,c,h){c!==h&&(i.flags|=4)};function Sl(r,i){if(!qt)switch(r.tailMode){case"hidden":i=r.tail;for(var c=null;i!==null;)i.alternate!==null&&(c=i),i=i.sibling;c===null?r.tail=null:c.sibling=null;break;case"collapsed":c=r.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?i||r.tail===null?r.tail=null:r.tail.sibling=null:h.sibling=null}}function rr(r){var i=r.alternate!==null&&r.alternate.child===r.child,c=0,h=0;if(i)for(var p=r.child;p!==null;)c|=p.lanes|p.childLanes,h|=p.subtreeFlags&14680064,h|=p.flags&14680064,p.return=r,p=p.sibling;else for(p=r.child;p!==null;)c|=p.lanes|p.childLanes,h|=p.subtreeFlags,h|=p.flags,p.return=r,p=p.sibling;return r.subtreeFlags|=h,r.childLanes=c,i}function rE(r,i,c){var h=i.pendingProps;switch(th(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return rr(i),null;case 1:return br(i.type)&&Dc(),rr(i),null;case 3:return h=i.stateNode,wo(),Wt(Sr),Wt(tr),ph(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(r===null||r.child===null)&&(Fc(i)?i.flags|=4:r===null||r.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Es!==null&&(Wh(Es),Es=null))),kh(r,i),rr(i),null;case 5:hh(i);var p=ba(_l.current);if(c=i.type,r!==null&&i.stateNode!=null)Wg(r,i,c,h,p),r.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!h){if(i.stateNode===null)throw Error(t(166));return rr(i),null}if(r=ba(Ws.current),Fc(i)){h=i.stateNode,c=i.type;var v=i.memoizedProps;switch(h[$s]=i,h[pl]=v,r=(i.mode&1)!==0,c){case"dialog":$t("cancel",h),$t("close",h);break;case"iframe":case"object":case"embed":$t("load",h);break;case"video":case"audio":for(p=0;p<dl.length;p++)$t(dl[p],h);break;case"source":$t("error",h);break;case"img":case"image":case"link":$t("error",h),$t("load",h);break;case"details":$t("toggle",h);break;case"input":Ye(h,v),$t("invalid",h);break;case"select":h._wrapperState={wasMultiple:!!v.multiple},$t("invalid",h);break;case"textarea":cr(h,v),$t("invalid",h)}vs(c,v),p=null;for(var b in v)if(v.hasOwnProperty(b)){var M=v[b];b==="children"?typeof M=="string"?h.textContent!==M&&(v.suppressHydrationWarning!==!0&&Ac(h.textContent,M,r),p=["children",M]):typeof M=="number"&&h.textContent!==""+M&&(v.suppressHydrationWarning!==!0&&Ac(h.textContent,M,r),p=["children",""+M]):a.hasOwnProperty(b)&&M!=null&&b==="onScroll"&&$t("scroll",h)}switch(c){case"input":ue(h),At(h,v,!0);break;case"textarea":ue(h),kn(h);break;case"select":case"option":break;default:typeof v.onClick=="function"&&(h.onclick=jc)}h=p,i.updateQueue=h,h!==null&&(i.flags|=4)}else{b=p.nodeType===9?p:p.ownerDocument,r==="http://www.w3.org/1999/xhtml"&&(r=Mt(c)),r==="http://www.w3.org/1999/xhtml"?c==="script"?(r=b.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild)):typeof h.is=="string"?r=b.createElement(c,{is:h.is}):(r=b.createElement(c),c==="select"&&(b=r,h.multiple?b.multiple=!0:h.size&&(b.size=h.size))):r=b.createElementNS(r,c),r[$s]=i,r[pl]=h,$g(r,i,!1,!1),i.stateNode=r;e:{switch(b=er(c,h),c){case"dialog":$t("cancel",r),$t("close",r),p=h;break;case"iframe":case"object":case"embed":$t("load",r),p=h;break;case"video":case"audio":for(p=0;p<dl.length;p++)$t(dl[p],r);p=h;break;case"source":$t("error",r),p=h;break;case"img":case"image":case"link":$t("error",r),$t("load",r),p=h;break;case"details":$t("toggle",r),p=h;break;case"input":Ye(r,h),p=qe(r,h),$t("invalid",r);break;case"option":p=h;break;case"select":r._wrapperState={wasMultiple:!!h.multiple},p=Ee({},h,{value:void 0}),$t("invalid",r);break;case"textarea":cr(r,h),p=yr(r,h),$t("invalid",r);break;default:p=h}vs(c,p),M=p;for(v in M)if(M.hasOwnProperty(v)){var G=M[v];v==="style"?Qr(r,G):v==="dangerouslySetInnerHTML"?(G=G?G.__html:void 0,G!=null&&ur(r,G)):v==="children"?typeof G=="string"?(c!=="textarea"||G!=="")&&vr(r,G):typeof G=="number"&&vr(r,""+G):v!=="suppressContentEditableWarning"&&v!=="suppressHydrationWarning"&&v!=="autoFocus"&&(a.hasOwnProperty(v)?G!=null&&v==="onScroll"&&$t("scroll",r):G!=null&&ye(r,v,G,b))}switch(c){case"input":ue(r),At(r,h,!1);break;case"textarea":ue(r),kn(r);break;case"option":h.value!=null&&r.setAttribute("value",""+Qe(h.value));break;case"select":r.multiple=!!h.multiple,v=h.value,v!=null?Kt(r,!!h.multiple,v,!1):h.defaultValue!=null&&Kt(r,!!h.multiple,h.defaultValue,!0);break;default:typeof p.onClick=="function"&&(r.onclick=jc)}switch(c){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}}h&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return rr(i),null;case 6:if(r&&i.stateNode!=null)Gg(r,i,r.memoizedProps,h);else{if(typeof h!="string"&&i.stateNode===null)throw Error(t(166));if(c=ba(_l.current),ba(Ws.current),Fc(i)){if(h=i.stateNode,c=i.memoizedProps,h[$s]=i,(v=h.nodeValue!==c)&&(r=Wr,r!==null))switch(r.tag){case 3:Ac(h.nodeValue,c,(r.mode&1)!==0);break;case 5:r.memoizedProps.suppressHydrationWarning!==!0&&Ac(h.nodeValue,c,(r.mode&1)!==0)}v&&(i.flags|=4)}else h=(c.nodeType===9?c:c.ownerDocument).createTextNode(h),h[$s]=i,i.stateNode=h}return rr(i),null;case 13:if(Wt(Yt),h=i.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(qt&&Gr!==null&&(i.mode&1)!==0&&(i.flags&128)===0)Km(),yo(),i.flags|=98560,v=!1;else if(v=Fc(i),h!==null&&h.dehydrated!==null){if(r===null){if(!v)throw Error(t(318));if(v=i.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(t(317));v[$s]=i}else yo(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;rr(i),v=!1}else Es!==null&&(Wh(Es),Es=null),v=!0;if(!v)return i.flags&65536?i:null}return(i.flags&128)!==0?(i.lanes=c,i):(h=h!==null,h!==(r!==null&&r.memoizedState!==null)&&h&&(i.child.flags|=8192,(i.mode&1)!==0&&(r===null||(Yt.current&1)!==0?Rn===0&&(Rn=3):Hh())),i.updateQueue!==null&&(i.flags|=4),rr(i),null);case 4:return wo(),kh(r,i),r===null&&hl(i.stateNode.containerInfo),rr(i),null;case 10:return oh(i.type._context),rr(i),null;case 17:return br(i.type)&&Dc(),rr(i),null;case 19:if(Wt(Yt),v=i.memoizedState,v===null)return rr(i),null;if(h=(i.flags&128)!==0,b=v.rendering,b===null)if(h)Sl(v,!1);else{if(Rn!==0||r!==null&&(r.flags&128)!==0)for(r=i.child;r!==null;){if(b=Gc(r),b!==null){for(i.flags|=128,Sl(v,!1),h=b.updateQueue,h!==null&&(i.updateQueue=h,i.flags|=4),i.subtreeFlags=0,h=c,c=i.child;c!==null;)v=c,r=h,v.flags&=14680066,b=v.alternate,b===null?(v.childLanes=0,v.lanes=r,v.child=null,v.subtreeFlags=0,v.memoizedProps=null,v.memoizedState=null,v.updateQueue=null,v.dependencies=null,v.stateNode=null):(v.childLanes=b.childLanes,v.lanes=b.lanes,v.child=b.child,v.subtreeFlags=0,v.deletions=null,v.memoizedProps=b.memoizedProps,v.memoizedState=b.memoizedState,v.updateQueue=b.updateQueue,v.type=b.type,r=b.dependencies,v.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),c=c.sibling;return Ft(Yt,Yt.current&1|2),i.child}r=r.sibling}v.tail!==null&&pt()>bo&&(i.flags|=128,h=!0,Sl(v,!1),i.lanes=4194304)}else{if(!h)if(r=Gc(b),r!==null){if(i.flags|=128,h=!0,c=r.updateQueue,c!==null&&(i.updateQueue=c,i.flags|=4),Sl(v,!0),v.tail===null&&v.tailMode==="hidden"&&!b.alternate&&!qt)return rr(i),null}else 2*pt()-v.renderingStartTime>bo&&c!==1073741824&&(i.flags|=128,h=!0,Sl(v,!1),i.lanes=4194304);v.isBackwards?(b.sibling=i.child,i.child=b):(c=v.last,c!==null?c.sibling=b:i.child=b,v.last=b)}return v.tail!==null?(i=v.tail,v.rendering=i,v.tail=i.sibling,v.renderingStartTime=pt(),i.sibling=null,c=Yt.current,Ft(Yt,h?c&1|2:c&1),i):(rr(i),null);case 22:case 23:return qh(),h=i.memoizedState!==null,r!==null&&r.memoizedState!==null!==h&&(i.flags|=8192),h&&(i.mode&1)!==0?(qr&1073741824)!==0&&(rr(i),i.subtreeFlags&6&&(i.flags|=8192)):rr(i),null;case 24:return null;case 25:return null}throw Error(t(156,i.tag))}function sE(r,i){switch(th(i),i.tag){case 1:return br(i.type)&&Dc(),r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 3:return wo(),Wt(Sr),Wt(tr),ph(),r=i.flags,(r&65536)!==0&&(r&128)===0?(i.flags=r&-65537|128,i):null;case 5:return hh(i),null;case 13:if(Wt(Yt),r=i.memoizedState,r!==null&&r.dehydrated!==null){if(i.alternate===null)throw Error(t(340));yo()}return r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 19:return Wt(Yt),null;case 4:return wo(),null;case 10:return oh(i.type._context),null;case 22:case 23:return qh(),null;case 24:return null;default:return null}}var eu=!1,sr=!1,iE=typeof WeakSet=="function"?WeakSet:Set,We=null;function To(r,i){var c=r.ref;if(c!==null)if(typeof c=="function")try{c(null)}catch(h){an(r,i,h)}else c.current=null}function Dh(r,i,c){try{c()}catch(h){an(r,i,h)}}var qg=!1;function aE(r,i){if(qd=lt,r=Sm(),Od(r)){if("selectionStart"in r)var c={start:r.selectionStart,end:r.selectionEnd};else e:{c=(c=r.ownerDocument)&&c.defaultView||window;var h=c.getSelection&&c.getSelection();if(h&&h.rangeCount!==0){c=h.anchorNode;var p=h.anchorOffset,v=h.focusNode;h=h.focusOffset;try{c.nodeType,v.nodeType}catch{c=null;break e}var b=0,M=-1,G=-1,oe=0,Ie=0,Ne=r,Se=null;t:for(;;){for(var ze;Ne!==c||p!==0&&Ne.nodeType!==3||(M=b+p),Ne!==v||h!==0&&Ne.nodeType!==3||(G=b+h),Ne.nodeType===3&&(b+=Ne.nodeValue.length),(ze=Ne.firstChild)!==null;)Se=Ne,Ne=ze;for(;;){if(Ne===r)break t;if(Se===c&&++oe===p&&(M=b),Se===v&&++Ie===h&&(G=b),(ze=Ne.nextSibling)!==null)break;Ne=Se,Se=Ne.parentNode}Ne=ze}c=M===-1||G===-1?null:{start:M,end:G}}else c=null}c=c||{start:0,end:0}}else c=null;for(Hd={focusedElem:r,selectionRange:c},lt=!1,We=i;We!==null;)if(i=We,r=i.child,(i.subtreeFlags&1028)!==0&&r!==null)r.return=i,We=r;else for(;We!==null;){i=We;try{var Ge=i.alternate;if((i.flags&1024)!==0)switch(i.tag){case 0:case 11:case 15:break;case 1:if(Ge!==null){var He=Ge.memoizedProps,fn=Ge.memoizedState,te=i.stateNode,K=te.getSnapshotBeforeUpdate(i.elementType===i.type?He:Ts(i.type,He),fn);te.__reactInternalSnapshotBeforeUpdate=K}break;case 3:var re=i.stateNode.containerInfo;re.nodeType===1?re.textContent="":re.nodeType===9&&re.documentElement&&re.removeChild(re.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(ke){an(i,i.return,ke)}if(r=i.sibling,r!==null){r.return=i.return,We=r;break}We=i.return}return Ge=qg,qg=!1,Ge}function bl(r,i,c){var h=i.updateQueue;if(h=h!==null?h.lastEffect:null,h!==null){var p=h=h.next;do{if((p.tag&r)===r){var v=p.destroy;p.destroy=void 0,v!==void 0&&Dh(i,c,v)}p=p.next}while(p!==h)}}function tu(r,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var c=i=i.next;do{if((c.tag&r)===r){var h=c.create;c.destroy=h()}c=c.next}while(c!==i)}}function Vh(r){var i=r.ref;if(i!==null){var c=r.stateNode;switch(r.tag){case 5:r=c;break;default:r=c}typeof i=="function"?i(r):i.current=r}}function Hg(r){var i=r.alternate;i!==null&&(r.alternate=null,Hg(i)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(i=r.stateNode,i!==null&&(delete i[$s],delete i[pl],delete i[Jd],delete i[Bw],delete i[$w])),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}function Kg(r){return r.tag===5||r.tag===3||r.tag===4}function Qg(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||Kg(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Lh(r,i,c){var h=r.tag;if(h===5||h===6)r=r.stateNode,i?c.nodeType===8?c.parentNode.insertBefore(r,i):c.insertBefore(r,i):(c.nodeType===8?(i=c.parentNode,i.insertBefore(r,c)):(i=c,i.appendChild(r)),c=c._reactRootContainer,c!=null||i.onclick!==null||(i.onclick=jc));else if(h!==4&&(r=r.child,r!==null))for(Lh(r,i,c),r=r.sibling;r!==null;)Lh(r,i,c),r=r.sibling}function Mh(r,i,c){var h=r.tag;if(h===5||h===6)r=r.stateNode,i?c.insertBefore(r,i):c.appendChild(r);else if(h!==4&&(r=r.child,r!==null))for(Mh(r,i,c),r=r.sibling;r!==null;)Mh(r,i,c),r=r.sibling}var Hn=null,Ss=!1;function Vi(r,i,c){for(c=c.child;c!==null;)Yg(r,i,c),c=c.sibling}function Yg(r,i,c){if(D&&typeof D.onCommitFiberUnmount=="function")try{D.onCommitFiberUnmount(w,c)}catch{}switch(c.tag){case 5:sr||To(c,i);case 6:var h=Hn,p=Ss;Hn=null,Vi(r,i,c),Hn=h,Ss=p,Hn!==null&&(Ss?(r=Hn,c=c.stateNode,r.nodeType===8?r.parentNode.removeChild(c):r.removeChild(c)):Hn.removeChild(c.stateNode));break;case 18:Hn!==null&&(Ss?(r=Hn,c=c.stateNode,r.nodeType===8?Yd(r.parentNode,c):r.nodeType===1&&Yd(r,c),$e(r)):Yd(Hn,c.stateNode));break;case 4:h=Hn,p=Ss,Hn=c.stateNode.containerInfo,Ss=!0,Vi(r,i,c),Hn=h,Ss=p;break;case 0:case 11:case 14:case 15:if(!sr&&(h=c.updateQueue,h!==null&&(h=h.lastEffect,h!==null))){p=h=h.next;do{var v=p,b=v.destroy;v=v.tag,b!==void 0&&((v&2)!==0||(v&4)!==0)&&Dh(c,i,b),p=p.next}while(p!==h)}Vi(r,i,c);break;case 1:if(!sr&&(To(c,i),h=c.stateNode,typeof h.componentWillUnmount=="function"))try{h.props=c.memoizedProps,h.state=c.memoizedState,h.componentWillUnmount()}catch(M){an(c,i,M)}Vi(r,i,c);break;case 21:Vi(r,i,c);break;case 22:c.mode&1?(sr=(h=sr)||c.memoizedState!==null,Vi(r,i,c),sr=h):Vi(r,i,c);break;default:Vi(r,i,c)}}function Jg(r){var i=r.updateQueue;if(i!==null){r.updateQueue=null;var c=r.stateNode;c===null&&(c=r.stateNode=new iE),i.forEach(function(h){var p=mE.bind(null,r,h);c.has(h)||(c.add(h),h.then(p,p))})}}function bs(r,i){var c=i.deletions;if(c!==null)for(var h=0;h<c.length;h++){var p=c[h];try{var v=r,b=i,M=b;e:for(;M!==null;){switch(M.tag){case 5:Hn=M.stateNode,Ss=!1;break e;case 3:Hn=M.stateNode.containerInfo,Ss=!0;break e;case 4:Hn=M.stateNode.containerInfo,Ss=!0;break e}M=M.return}if(Hn===null)throw Error(t(160));Yg(v,b,p),Hn=null,Ss=!1;var G=p.alternate;G!==null&&(G.return=null),p.return=null}catch(oe){an(p,i,oe)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)Xg(i,r),i=i.sibling}function Xg(r,i){var c=r.alternate,h=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:if(bs(i,r),qs(r),h&4){try{bl(3,r,r.return),tu(3,r)}catch(He){an(r,r.return,He)}try{bl(5,r,r.return)}catch(He){an(r,r.return,He)}}break;case 1:bs(i,r),qs(r),h&512&&c!==null&&To(c,c.return);break;case 5:if(bs(i,r),qs(r),h&512&&c!==null&&To(c,c.return),r.flags&32){var p=r.stateNode;try{vr(p,"")}catch(He){an(r,r.return,He)}}if(h&4&&(p=r.stateNode,p!=null)){var v=r.memoizedProps,b=c!==null?c.memoizedProps:v,M=r.type,G=r.updateQueue;if(r.updateQueue=null,G!==null)try{M==="input"&&v.type==="radio"&&v.name!=null&&Et(p,v),er(M,b);var oe=er(M,v);for(b=0;b<G.length;b+=2){var Ie=G[b],Ne=G[b+1];Ie==="style"?Qr(p,Ne):Ie==="dangerouslySetInnerHTML"?ur(p,Ne):Ie==="children"?vr(p,Ne):ye(p,Ie,Ne,oe)}switch(M){case"input":Nt(p,v);break;case"textarea":un(p,v);break;case"select":var Se=p._wrapperState.wasMultiple;p._wrapperState.wasMultiple=!!v.multiple;var ze=v.value;ze!=null?Kt(p,!!v.multiple,ze,!1):Se!==!!v.multiple&&(v.defaultValue!=null?Kt(p,!!v.multiple,v.defaultValue,!0):Kt(p,!!v.multiple,v.multiple?[]:"",!1))}p[pl]=v}catch(He){an(r,r.return,He)}}break;case 6:if(bs(i,r),qs(r),h&4){if(r.stateNode===null)throw Error(t(162));p=r.stateNode,v=r.memoizedProps;try{p.nodeValue=v}catch(He){an(r,r.return,He)}}break;case 3:if(bs(i,r),qs(r),h&4&&c!==null&&c.memoizedState.isDehydrated)try{$e(i.containerInfo)}catch(He){an(r,r.return,He)}break;case 4:bs(i,r),qs(r);break;case 13:bs(i,r),qs(r),p=r.child,p.flags&8192&&(v=p.memoizedState!==null,p.stateNode.isHidden=v,!v||p.alternate!==null&&p.alternate.memoizedState!==null||(Uh=pt())),h&4&&Jg(r);break;case 22:if(Ie=c!==null&&c.memoizedState!==null,r.mode&1?(sr=(oe=sr)||Ie,bs(i,r),sr=oe):bs(i,r),qs(r),h&8192){if(oe=r.memoizedState!==null,(r.stateNode.isHidden=oe)&&!Ie&&(r.mode&1)!==0)for(We=r,Ie=r.child;Ie!==null;){for(Ne=We=Ie;We!==null;){switch(Se=We,ze=Se.child,Se.tag){case 0:case 11:case 14:case 15:bl(4,Se,Se.return);break;case 1:To(Se,Se.return);var Ge=Se.stateNode;if(typeof Ge.componentWillUnmount=="function"){h=Se,c=Se.return;try{i=h,Ge.props=i.memoizedProps,Ge.state=i.memoizedState,Ge.componentWillUnmount()}catch(He){an(h,c,He)}}break;case 5:To(Se,Se.return);break;case 22:if(Se.memoizedState!==null){ty(Ne);continue}}ze!==null?(ze.return=Se,We=ze):ty(Ne)}Ie=Ie.sibling}e:for(Ie=null,Ne=r;;){if(Ne.tag===5){if(Ie===null){Ie=Ne;try{p=Ne.stateNode,oe?(v=p.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none"):(M=Ne.stateNode,G=Ne.memoizedProps.style,b=G!=null&&G.hasOwnProperty("display")?G.display:null,M.style.display=Dr("display",b))}catch(He){an(r,r.return,He)}}}else if(Ne.tag===6){if(Ie===null)try{Ne.stateNode.nodeValue=oe?"":Ne.memoizedProps}catch(He){an(r,r.return,He)}}else if((Ne.tag!==22&&Ne.tag!==23||Ne.memoizedState===null||Ne===r)&&Ne.child!==null){Ne.child.return=Ne,Ne=Ne.child;continue}if(Ne===r)break e;for(;Ne.sibling===null;){if(Ne.return===null||Ne.return===r)break e;Ie===Ne&&(Ie=null),Ne=Ne.return}Ie===Ne&&(Ie=null),Ne.sibling.return=Ne.return,Ne=Ne.sibling}}break;case 19:bs(i,r),qs(r),h&4&&Jg(r);break;case 21:break;default:bs(i,r),qs(r)}}function qs(r){var i=r.flags;if(i&2){try{e:{for(var c=r.return;c!==null;){if(Kg(c)){var h=c;break e}c=c.return}throw Error(t(160))}switch(h.tag){case 5:var p=h.stateNode;h.flags&32&&(vr(p,""),h.flags&=-33);var v=Qg(r);Mh(r,v,p);break;case 3:case 4:var b=h.stateNode.containerInfo,M=Qg(r);Lh(r,M,b);break;default:throw Error(t(161))}}catch(G){an(r,r.return,G)}r.flags&=-3}i&4096&&(r.flags&=-4097)}function oE(r,i,c){We=r,Zg(r)}function Zg(r,i,c){for(var h=(r.mode&1)!==0;We!==null;){var p=We,v=p.child;if(p.tag===22&&h){var b=p.memoizedState!==null||eu;if(!b){var M=p.alternate,G=M!==null&&M.memoizedState!==null||sr;M=eu;var oe=sr;if(eu=b,(sr=G)&&!oe)for(We=p;We!==null;)b=We,G=b.child,b.tag===22&&b.memoizedState!==null?ny(p):G!==null?(G.return=b,We=G):ny(p);for(;v!==null;)We=v,Zg(v),v=v.sibling;We=p,eu=M,sr=oe}ey(r)}else(p.subtreeFlags&8772)!==0&&v!==null?(v.return=p,We=v):ey(r)}}function ey(r){for(;We!==null;){var i=We;if((i.flags&8772)!==0){var c=i.alternate;try{if((i.flags&8772)!==0)switch(i.tag){case 0:case 11:case 15:sr||tu(5,i);break;case 1:var h=i.stateNode;if(i.flags&4&&!sr)if(c===null)h.componentDidMount();else{var p=i.elementType===i.type?c.memoizedProps:Ts(i.type,c.memoizedProps);h.componentDidUpdate(p,c.memoizedState,h.__reactInternalSnapshotBeforeUpdate)}var v=i.updateQueue;v!==null&&tg(i,v,h);break;case 3:var b=i.updateQueue;if(b!==null){if(c=null,i.child!==null)switch(i.child.tag){case 5:c=i.child.stateNode;break;case 1:c=i.child.stateNode}tg(i,b,c)}break;case 5:var M=i.stateNode;if(c===null&&i.flags&4){c=M;var G=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":G.autoFocus&&c.focus();break;case"img":G.src&&(c.src=G.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var oe=i.alternate;if(oe!==null){var Ie=oe.memoizedState;if(Ie!==null){var Ne=Ie.dehydrated;Ne!==null&&$e(Ne)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}sr||i.flags&512&&Vh(i)}catch(Se){an(i,i.return,Se)}}if(i===r){We=null;break}if(c=i.sibling,c!==null){c.return=i.return,We=c;break}We=i.return}}function ty(r){for(;We!==null;){var i=We;if(i===r){We=null;break}var c=i.sibling;if(c!==null){c.return=i.return,We=c;break}We=i.return}}function ny(r){for(;We!==null;){var i=We;try{switch(i.tag){case 0:case 11:case 15:var c=i.return;try{tu(4,i)}catch(G){an(i,c,G)}break;case 1:var h=i.stateNode;if(typeof h.componentDidMount=="function"){var p=i.return;try{h.componentDidMount()}catch(G){an(i,p,G)}}var v=i.return;try{Vh(i)}catch(G){an(i,v,G)}break;case 5:var b=i.return;try{Vh(i)}catch(G){an(i,b,G)}}}catch(G){an(i,i.return,G)}if(i===r){We=null;break}var M=i.sibling;if(M!==null){M.return=i.return,We=M;break}We=i.return}}var lE=Math.ceil,nu=we.ReactCurrentDispatcher,Oh=we.ReactCurrentOwner,us=we.ReactCurrentBatchConfig,St=0,Un=null,xn=null,Kn=0,qr=0,So=Ri(0),Rn=0,Cl=null,Ia=0,ru=0,Fh=0,Il=null,Ir=null,Uh=0,bo=1/0,hi=null,su=!1,zh=null,Li=null,iu=!1,Mi=null,au=0,Nl=0,Bh=null,ou=-1,lu=0;function gr(){return(St&6)!==0?pt():ou!==-1?ou:ou=pt()}function Oi(r){return(r.mode&1)===0?1:(St&2)!==0&&Kn!==0?Kn&-Kn:Gw.transition!==null?(lu===0&&(lu=rn()),lu):(r=gt,r!==0||(r=window.event,r=r===void 0?16:hn(r.type)),r)}function Cs(r,i,c,h){if(50<Nl)throw Nl=0,Bh=null,Error(t(185));Er(r,c,h),((St&2)===0||r!==Un)&&(r===Un&&((St&2)===0&&(ru|=c),Rn===4&&Fi(r,Kn)),Nr(r,h),c===1&&St===0&&(i.mode&1)===0&&(bo=pt()+500,Lc&&ji()))}function Nr(r,i){var c=r.callbackNode;Pe(r,i);var h=de(r,r===Un?Kn:0);if(h===0)c!==null&&Ms(c),r.callbackNode=null,r.callbackPriority=0;else if(i=h&-h,r.callbackPriority!==i){if(c!=null&&Ms(c),i===1)r.tag===0?Ww(sy.bind(null,r)):$m(sy.bind(null,r)),Uw(function(){(St&6)===0&&ji()}),c=null;else{switch(Os(h)){case 1:c=hr;break;case 4:c=tn;break;case 16:c=nn;break;case 536870912:c=Wn;break;default:c=nn}c=hy(c,ry.bind(null,r))}r.callbackPriority=i,r.callbackNode=c}}function ry(r,i){if(ou=-1,lu=0,(St&6)!==0)throw Error(t(327));var c=r.callbackNode;if(Co()&&r.callbackNode!==c)return null;var h=de(r,r===Un?Kn:0);if(h===0)return null;if((h&30)!==0||(h&r.expiredLanes)!==0||i)i=cu(r,h);else{i=h;var p=St;St|=2;var v=ay();(Un!==r||Kn!==i)&&(hi=null,bo=pt()+500,Pa(r,i));do try{dE();break}catch(M){iy(r,M)}while(!0);ah(),nu.current=v,St=p,xn!==null?i=0:(Un=null,Kn=0,i=Rn)}if(i!==0){if(i===2&&(p=Je(r),p!==0&&(h=p,i=$h(r,p))),i===1)throw c=Cl,Pa(r,0),Fi(r,h),Nr(r,pt()),c;if(i===6)Fi(r,h);else{if(p=r.current.alternate,(h&30)===0&&!cE(p)&&(i=cu(r,h),i===2&&(v=Je(r),v!==0&&(h=v,i=$h(r,v))),i===1))throw c=Cl,Pa(r,0),Fi(r,h),Nr(r,pt()),c;switch(r.finishedWork=p,r.finishedLanes=h,i){case 0:case 1:throw Error(t(345));case 2:Ra(r,Ir,hi);break;case 3:if(Fi(r,h),(h&130023424)===h&&(i=Uh+500-pt(),10<i)){if(de(r,0)!==0)break;if(p=r.suspendedLanes,(p&h)!==h){gr(),r.pingedLanes|=r.suspendedLanes&p;break}r.timeoutHandle=Qd(Ra.bind(null,r,Ir,hi),i);break}Ra(r,Ir,hi);break;case 4:if(Fi(r,h),(h&4194240)===h)break;for(i=r.eventTimes,p=-1;0<h;){var b=31-L(h);v=1<<b,b=i[b],b>p&&(p=b),h&=~v}if(h=p,h=pt()-h,h=(120>h?120:480>h?480:1080>h?1080:1920>h?1920:3e3>h?3e3:4320>h?4320:1960*lE(h/1960))-h,10<h){r.timeoutHandle=Qd(Ra.bind(null,r,Ir,hi),h);break}Ra(r,Ir,hi);break;case 5:Ra(r,Ir,hi);break;default:throw Error(t(329))}}}return Nr(r,pt()),r.callbackNode===c?ry.bind(null,r):null}function $h(r,i){var c=Il;return r.current.memoizedState.isDehydrated&&(Pa(r,i).flags|=256),r=cu(r,i),r!==2&&(i=Ir,Ir=c,i!==null&&Wh(i)),r}function Wh(r){Ir===null?Ir=r:Ir.push.apply(Ir,r)}function cE(r){for(var i=r;;){if(i.flags&16384){var c=i.updateQueue;if(c!==null&&(c=c.stores,c!==null))for(var h=0;h<c.length;h++){var p=c[h],v=p.getSnapshot;p=p.value;try{if(!ws(v(),p))return!1}catch{return!1}}}if(c=i.child,i.subtreeFlags&16384&&c!==null)c.return=i,i=c;else{if(i===r)break;for(;i.sibling===null;){if(i.return===null||i.return===r)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Fi(r,i){for(i&=~Fh,i&=~ru,r.suspendedLanes|=i,r.pingedLanes&=~i,r=r.expirationTimes;0<i;){var c=31-L(i),h=1<<c;r[c]=-1,i&=~h}}function sy(r){if((St&6)!==0)throw Error(t(327));Co();var i=de(r,0);if((i&1)===0)return Nr(r,pt()),null;var c=cu(r,i);if(r.tag!==0&&c===2){var h=Je(r);h!==0&&(i=h,c=$h(r,h))}if(c===1)throw c=Cl,Pa(r,0),Fi(r,i),Nr(r,pt()),c;if(c===6)throw Error(t(345));return r.finishedWork=r.current.alternate,r.finishedLanes=i,Ra(r,Ir,hi),Nr(r,pt()),null}function Gh(r,i){var c=St;St|=1;try{return r(i)}finally{St=c,St===0&&(bo=pt()+500,Lc&&ji())}}function Na(r){Mi!==null&&Mi.tag===0&&(St&6)===0&&Co();var i=St;St|=1;var c=us.transition,h=gt;try{if(us.transition=null,gt=1,r)return r()}finally{gt=h,us.transition=c,St=i,(St&6)===0&&ji()}}function qh(){qr=So.current,Wt(So)}function Pa(r,i){r.finishedWork=null,r.finishedLanes=0;var c=r.timeoutHandle;if(c!==-1&&(r.timeoutHandle=-1,Fw(c)),xn!==null)for(c=xn.return;c!==null;){var h=c;switch(th(h),h.tag){case 1:h=h.type.childContextTypes,h!=null&&Dc();break;case 3:wo(),Wt(Sr),Wt(tr),ph();break;case 5:hh(h);break;case 4:wo();break;case 13:Wt(Yt);break;case 19:Wt(Yt);break;case 10:oh(h.type._context);break;case 22:case 23:qh()}c=c.return}if(Un=r,xn=r=Ui(r.current,null),Kn=qr=i,Rn=0,Cl=null,Fh=ru=Ia=0,Ir=Il=null,Sa!==null){for(i=0;i<Sa.length;i++)if(c=Sa[i],h=c.interleaved,h!==null){c.interleaved=null;var p=h.next,v=c.pending;if(v!==null){var b=v.next;v.next=p,h.next=b}c.pending=h}Sa=null}return r}function iy(r,i){do{var c=xn;try{if(ah(),qc.current=Yc,Hc){for(var h=Jt.memoizedState;h!==null;){var p=h.queue;p!==null&&(p.pending=null),h=h.next}Hc=!1}if(Ca=0,Fn=Pn=Jt=null,xl=!1,wl=0,Oh.current=null,c===null||c.return===null){Rn=1,Cl=i,xn=null;break}e:{var v=r,b=c.return,M=c,G=i;if(i=Kn,M.flags|=32768,G!==null&&typeof G=="object"&&typeof G.then=="function"){var oe=G,Ie=M,Ne=Ie.tag;if((Ie.mode&1)===0&&(Ne===0||Ne===11||Ne===15)){var Se=Ie.alternate;Se?(Ie.updateQueue=Se.updateQueue,Ie.memoizedState=Se.memoizedState,Ie.lanes=Se.lanes):(Ie.updateQueue=null,Ie.memoizedState=null)}var ze=Rg(b);if(ze!==null){ze.flags&=-257,Ag(ze,b,M,v,i),ze.mode&1&&Pg(v,oe,i),i=ze,G=oe;var Ge=i.updateQueue;if(Ge===null){var He=new Set;He.add(G),i.updateQueue=He}else Ge.add(G);break e}else{if((i&1)===0){Pg(v,oe,i),Hh();break e}G=Error(t(426))}}else if(qt&&M.mode&1){var fn=Rg(b);if(fn!==null){(fn.flags&65536)===0&&(fn.flags|=256),Ag(fn,b,M,v,i),sh(Eo(G,M));break e}}v=G=Eo(G,M),Rn!==4&&(Rn=2),Il===null?Il=[v]:Il.push(v),v=b;do{switch(v.tag){case 3:v.flags|=65536,i&=-i,v.lanes|=i;var te=Ig(v,G,i);eg(v,te);break e;case 1:M=G;var K=v.type,re=v.stateNode;if((v.flags&128)===0&&(typeof K.getDerivedStateFromError=="function"||re!==null&&typeof re.componentDidCatch=="function"&&(Li===null||!Li.has(re)))){v.flags|=65536,i&=-i,v.lanes|=i;var ke=Ng(v,M,i);eg(v,ke);break e}}v=v.return}while(v!==null)}ly(c)}catch(Ke){i=Ke,xn===c&&c!==null&&(xn=c=c.return);continue}break}while(!0)}function ay(){var r=nu.current;return nu.current=Yc,r===null?Yc:r}function Hh(){(Rn===0||Rn===3||Rn===2)&&(Rn=4),Un===null||(Ia&268435455)===0&&(ru&268435455)===0||Fi(Un,Kn)}function cu(r,i){var c=St;St|=2;var h=ay();(Un!==r||Kn!==i)&&(hi=null,Pa(r,i));do try{uE();break}catch(p){iy(r,p)}while(!0);if(ah(),St=c,nu.current=h,xn!==null)throw Error(t(261));return Un=null,Kn=0,Rn}function uE(){for(;xn!==null;)oy(xn)}function dE(){for(;xn!==null&&!ti();)oy(xn)}function oy(r){var i=dy(r.alternate,r,qr);r.memoizedProps=r.pendingProps,i===null?ly(r):xn=i,Oh.current=null}function ly(r){var i=r;do{var c=i.alternate;if(r=i.return,(i.flags&32768)===0){if(c=rE(c,i,qr),c!==null){xn=c;return}}else{if(c=sE(c,i),c!==null){c.flags&=32767,xn=c;return}if(r!==null)r.flags|=32768,r.subtreeFlags=0,r.deletions=null;else{Rn=6,xn=null;return}}if(i=i.sibling,i!==null){xn=i;return}xn=i=r}while(i!==null);Rn===0&&(Rn=5)}function Ra(r,i,c){var h=gt,p=us.transition;try{us.transition=null,gt=1,hE(r,i,c,h)}finally{us.transition=p,gt=h}return null}function hE(r,i,c,h){do Co();while(Mi!==null);if((St&6)!==0)throw Error(t(327));c=r.finishedWork;var p=r.finishedLanes;if(c===null)return null;if(r.finishedWork=null,r.finishedLanes=0,c===r.current)throw Error(t(177));r.callbackNode=null,r.callbackPriority=0;var v=c.lanes|c.childLanes;if(_t(r,v),r===Un&&(xn=Un=null,Kn=0),(c.subtreeFlags&2064)===0&&(c.flags&2064)===0||iu||(iu=!0,hy(nn,function(){return Co(),null})),v=(c.flags&15990)!==0,(c.subtreeFlags&15990)!==0||v){v=us.transition,us.transition=null;var b=gt;gt=1;var M=St;St|=4,Oh.current=null,aE(r,c),Xg(c,r),jw(Hd),lt=!!qd,Hd=qd=null,r.current=c,oE(c),ni(),St=M,gt=b,us.transition=v}else r.current=c;if(iu&&(iu=!1,Mi=r,au=p),v=r.pendingLanes,v===0&&(Li=null),q(c.stateNode),Nr(r,pt()),i!==null)for(h=r.onRecoverableError,c=0;c<i.length;c++)p=i[c],h(p.value,{componentStack:p.stack,digest:p.digest});if(su)throw su=!1,r=zh,zh=null,r;return(au&1)!==0&&r.tag!==0&&Co(),v=r.pendingLanes,(v&1)!==0?r===Bh?Nl++:(Nl=0,Bh=r):Nl=0,ji(),null}function Co(){if(Mi!==null){var r=Os(au),i=us.transition,c=gt;try{if(us.transition=null,gt=16>r?16:r,Mi===null)var h=!1;else{if(r=Mi,Mi=null,au=0,(St&6)!==0)throw Error(t(331));var p=St;for(St|=4,We=r.current;We!==null;){var v=We,b=v.child;if((We.flags&16)!==0){var M=v.deletions;if(M!==null){for(var G=0;G<M.length;G++){var oe=M[G];for(We=oe;We!==null;){var Ie=We;switch(Ie.tag){case 0:case 11:case 15:bl(8,Ie,v)}var Ne=Ie.child;if(Ne!==null)Ne.return=Ie,We=Ne;else for(;We!==null;){Ie=We;var Se=Ie.sibling,ze=Ie.return;if(Hg(Ie),Ie===oe){We=null;break}if(Se!==null){Se.return=ze,We=Se;break}We=ze}}}var Ge=v.alternate;if(Ge!==null){var He=Ge.child;if(He!==null){Ge.child=null;do{var fn=He.sibling;He.sibling=null,He=fn}while(He!==null)}}We=v}}if((v.subtreeFlags&2064)!==0&&b!==null)b.return=v,We=b;else e:for(;We!==null;){if(v=We,(v.flags&2048)!==0)switch(v.tag){case 0:case 11:case 15:bl(9,v,v.return)}var te=v.sibling;if(te!==null){te.return=v.return,We=te;break e}We=v.return}}var K=r.current;for(We=K;We!==null;){b=We;var re=b.child;if((b.subtreeFlags&2064)!==0&&re!==null)re.return=b,We=re;else e:for(b=K;We!==null;){if(M=We,(M.flags&2048)!==0)try{switch(M.tag){case 0:case 11:case 15:tu(9,M)}}catch(Ke){an(M,M.return,Ke)}if(M===b){We=null;break e}var ke=M.sibling;if(ke!==null){ke.return=M.return,We=ke;break e}We=M.return}}if(St=p,ji(),D&&typeof D.onPostCommitFiberRoot=="function")try{D.onPostCommitFiberRoot(w,r)}catch{}h=!0}return h}finally{gt=c,us.transition=i}}return!1}function cy(r,i,c){i=Eo(c,i),i=Ig(r,i,1),r=Di(r,i,1),i=gr(),r!==null&&(Er(r,1,i),Nr(r,i))}function an(r,i,c){if(r.tag===3)cy(r,r,c);else for(;i!==null;){if(i.tag===3){cy(i,r,c);break}else if(i.tag===1){var h=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(Li===null||!Li.has(h))){r=Eo(c,r),r=Ng(i,r,1),i=Di(i,r,1),r=gr(),i!==null&&(Er(i,1,r),Nr(i,r));break}}i=i.return}}function fE(r,i,c){var h=r.pingCache;h!==null&&h.delete(i),i=gr(),r.pingedLanes|=r.suspendedLanes&c,Un===r&&(Kn&c)===c&&(Rn===4||Rn===3&&(Kn&130023424)===Kn&&500>pt()-Uh?Pa(r,0):Fh|=c),Nr(r,i)}function uy(r,i){i===0&&((r.mode&1)===0?i=1:(i=me,me<<=1,(me&130023424)===0&&(me=4194304)));var c=gr();r=ci(r,i),r!==null&&(Er(r,i,c),Nr(r,c))}function pE(r){var i=r.memoizedState,c=0;i!==null&&(c=i.retryLane),uy(r,c)}function mE(r,i){var c=0;switch(r.tag){case 13:var h=r.stateNode,p=r.memoizedState;p!==null&&(c=p.retryLane);break;case 19:h=r.stateNode;break;default:throw Error(t(314))}h!==null&&h.delete(i),uy(r,c)}var dy;dy=function(r,i,c){if(r!==null)if(r.memoizedProps!==i.pendingProps||Sr.current)Cr=!0;else{if((r.lanes&c)===0&&(i.flags&128)===0)return Cr=!1,nE(r,i,c);Cr=(r.flags&131072)!==0}else Cr=!1,qt&&(i.flags&1048576)!==0&&Wm(i,Oc,i.index);switch(i.lanes=0,i.tag){case 2:var h=i.type;Zc(r,i),r=i.pendingProps;var p=po(i,tr.current);xo(i,c),p=yh(null,i,h,r,p,c);var v=vh();return i.flags|=1,typeof p=="object"&&p!==null&&typeof p.render=="function"&&p.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,br(h)?(v=!0,Vc(i)):v=!1,i.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,uh(i),p.updater=Jc,i.stateNode=p,p._reactInternals=i,Sh(i,h,r,c),i=Nh(null,i,h,!0,v,c)):(i.tag=0,qt&&v&&eh(i),mr(null,i,p,c),i=i.child),i;case 16:h=i.elementType;e:{switch(Zc(r,i),r=i.pendingProps,p=h._init,h=p(h._payload),i.type=h,p=i.tag=yE(h),r=Ts(h,r),p){case 0:i=Ih(null,i,h,r,c);break e;case 1:i=Mg(null,i,h,r,c);break e;case 11:i=jg(null,i,h,r,c);break e;case 14:i=kg(null,i,h,Ts(h.type,r),c);break e}throw Error(t(306,h,""))}return i;case 0:return h=i.type,p=i.pendingProps,p=i.elementType===h?p:Ts(h,p),Ih(r,i,h,p,c);case 1:return h=i.type,p=i.pendingProps,p=i.elementType===h?p:Ts(h,p),Mg(r,i,h,p,c);case 3:e:{if(Og(i),r===null)throw Error(t(387));h=i.pendingProps,v=i.memoizedState,p=v.element,Zm(r,i),Wc(i,h,null,c);var b=i.memoizedState;if(h=b.element,v.isDehydrated)if(v={element:h,isDehydrated:!1,cache:b.cache,pendingSuspenseBoundaries:b.pendingSuspenseBoundaries,transitions:b.transitions},i.updateQueue.baseState=v,i.memoizedState=v,i.flags&256){p=Eo(Error(t(423)),i),i=Fg(r,i,h,c,p);break e}else if(h!==p){p=Eo(Error(t(424)),i),i=Fg(r,i,h,c,p);break e}else for(Gr=Pi(i.stateNode.containerInfo.firstChild),Wr=i,qt=!0,Es=null,c=Jm(i,null,h,c),i.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{if(yo(),h===p){i=di(r,i,c);break e}mr(r,i,h,c)}i=i.child}return i;case 5:return ng(i),r===null&&rh(i),h=i.type,p=i.pendingProps,v=r!==null?r.memoizedProps:null,b=p.children,Kd(h,p)?b=null:v!==null&&Kd(h,v)&&(i.flags|=32),Lg(r,i),mr(r,i,b,c),i.child;case 6:return r===null&&rh(i),null;case 13:return Ug(r,i,c);case 4:return dh(i,i.stateNode.containerInfo),h=i.pendingProps,r===null?i.child=vo(i,null,h,c):mr(r,i,h,c),i.child;case 11:return h=i.type,p=i.pendingProps,p=i.elementType===h?p:Ts(h,p),jg(r,i,h,p,c);case 7:return mr(r,i,i.pendingProps,c),i.child;case 8:return mr(r,i,i.pendingProps.children,c),i.child;case 12:return mr(r,i,i.pendingProps.children,c),i.child;case 10:e:{if(h=i.type._context,p=i.pendingProps,v=i.memoizedProps,b=p.value,Ft(zc,h._currentValue),h._currentValue=b,v!==null)if(ws(v.value,b)){if(v.children===p.children&&!Sr.current){i=di(r,i,c);break e}}else for(v=i.child,v!==null&&(v.return=i);v!==null;){var M=v.dependencies;if(M!==null){b=v.child;for(var G=M.firstContext;G!==null;){if(G.context===h){if(v.tag===1){G=ui(-1,c&-c),G.tag=2;var oe=v.updateQueue;if(oe!==null){oe=oe.shared;var Ie=oe.pending;Ie===null?G.next=G:(G.next=Ie.next,Ie.next=G),oe.pending=G}}v.lanes|=c,G=v.alternate,G!==null&&(G.lanes|=c),lh(v.return,c,i),M.lanes|=c;break}G=G.next}}else if(v.tag===10)b=v.type===i.type?null:v.child;else if(v.tag===18){if(b=v.return,b===null)throw Error(t(341));b.lanes|=c,M=b.alternate,M!==null&&(M.lanes|=c),lh(b,c,i),b=v.sibling}else b=v.child;if(b!==null)b.return=v;else for(b=v;b!==null;){if(b===i){b=null;break}if(v=b.sibling,v!==null){v.return=b.return,b=v;break}b=b.return}v=b}mr(r,i,p.children,c),i=i.child}return i;case 9:return p=i.type,h=i.pendingProps.children,xo(i,c),p=ls(p),h=h(p),i.flags|=1,mr(r,i,h,c),i.child;case 14:return h=i.type,p=Ts(h,i.pendingProps),p=Ts(h.type,p),kg(r,i,h,p,c);case 15:return Dg(r,i,i.type,i.pendingProps,c);case 17:return h=i.type,p=i.pendingProps,p=i.elementType===h?p:Ts(h,p),Zc(r,i),i.tag=1,br(h)?(r=!0,Vc(i)):r=!1,xo(i,c),bg(i,h,p),Sh(i,h,p,c),Nh(null,i,h,!0,r,c);case 19:return Bg(r,i,c);case 22:return Vg(r,i,c)}throw Error(t(156,i.tag))};function hy(r,i){return xs(r,i)}function gE(r,i,c,h){this.tag=r,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ds(r,i,c,h){return new gE(r,i,c,h)}function Kh(r){return r=r.prototype,!(!r||!r.isReactComponent)}function yE(r){if(typeof r=="function")return Kh(r)?1:0;if(r!=null){if(r=r.$$typeof,r===P)return 11;if(r===ie)return 14}return 2}function Ui(r,i){var c=r.alternate;return c===null?(c=ds(r.tag,i,r.key,r.mode),c.elementType=r.elementType,c.type=r.type,c.stateNode=r.stateNode,c.alternate=r,r.alternate=c):(c.pendingProps=i,c.type=r.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=r.flags&14680064,c.childLanes=r.childLanes,c.lanes=r.lanes,c.child=r.child,c.memoizedProps=r.memoizedProps,c.memoizedState=r.memoizedState,c.updateQueue=r.updateQueue,i=r.dependencies,c.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},c.sibling=r.sibling,c.index=r.index,c.ref=r.ref,c}function uu(r,i,c,h,p,v){var b=2;if(h=r,typeof r=="function")Kh(r)&&(b=1);else if(typeof r=="string")b=5;else e:switch(r){case I:return Aa(c.children,p,v,i);case N:b=8,p|=8;break;case A:return r=ds(12,c,i,p|2),r.elementType=A,r.lanes=v,r;case C:return r=ds(13,c,i,p),r.elementType=C,r.lanes=v,r;case Y:return r=ds(19,c,i,p),r.elementType=Y,r.lanes=v,r;case fe:return du(c,p,v,i);default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case U:b=10;break e;case V:b=9;break e;case P:b=11;break e;case ie:b=14;break e;case Ce:b=16,h=null;break e}throw Error(t(130,r==null?r:typeof r,""))}return i=ds(b,c,i,p),i.elementType=r,i.type=h,i.lanes=v,i}function Aa(r,i,c,h){return r=ds(7,r,h,i),r.lanes=c,r}function du(r,i,c,h){return r=ds(22,r,h,i),r.elementType=fe,r.lanes=c,r.stateNode={isHidden:!1},r}function Qh(r,i,c){return r=ds(6,r,null,i),r.lanes=c,r}function Yh(r,i,c){return i=ds(4,r.children!==null?r.children:[],r.key,i),i.lanes=c,i.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},i}function vE(r,i,c,h,p){this.tag=i,this.containerInfo=r,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=sn(0),this.expirationTimes=sn(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=sn(0),this.identifierPrefix=h,this.onRecoverableError=p,this.mutableSourceEagerHydrationData=null}function Jh(r,i,c,h,p,v,b,M,G){return r=new vE(r,i,c,M,G),i===1?(i=1,v===!0&&(i|=8)):i=0,v=ds(3,null,null,i),r.current=v,v.stateNode=r,v.memoizedState={element:h,isDehydrated:c,cache:null,transitions:null,pendingSuspenseBoundaries:null},uh(v),r}function _E(r,i,c){var h=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ae,key:h==null?null:""+h,children:r,containerInfo:i,implementation:c}}function fy(r){if(!r)return Ai;r=r._reactInternals;e:{if(yn(r)!==r||r.tag!==1)throw Error(t(170));var i=r;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(br(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(t(171))}if(r.tag===1){var c=r.type;if(br(c))return zm(r,c,i)}return i}function py(r,i,c,h,p,v,b,M,G){return r=Jh(c,h,!0,r,p,v,b,M,G),r.context=fy(null),c=r.current,h=gr(),p=Oi(c),v=ui(h,p),v.callback=i??null,Di(c,v,p),r.current.lanes=p,Er(r,p,h),Nr(r,h),r}function hu(r,i,c,h){var p=i.current,v=gr(),b=Oi(p);return c=fy(c),i.context===null?i.context=c:i.pendingContext=c,i=ui(v,b),i.payload={element:r},h=h===void 0?null:h,h!==null&&(i.callback=h),r=Di(p,i,b),r!==null&&(Cs(r,p,b,v),$c(r,p,b)),b}function fu(r){if(r=r.current,!r.child)return null;switch(r.child.tag){case 5:return r.child.stateNode;default:return r.child.stateNode}}function my(r,i){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var c=r.retryLane;r.retryLane=c!==0&&c<i?c:i}}function Xh(r,i){my(r,i),(r=r.alternate)&&my(r,i)}function xE(){return null}var gy=typeof reportError=="function"?reportError:function(r){console.error(r)};function Zh(r){this._internalRoot=r}pu.prototype.render=Zh.prototype.render=function(r){var i=this._internalRoot;if(i===null)throw Error(t(409));hu(r,i,null,null)},pu.prototype.unmount=Zh.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var i=r.containerInfo;Na(function(){hu(null,r,null,null)}),i[ii]=null}};function pu(r){this._internalRoot=r}pu.prototype.unstable_scheduleHydration=function(r){if(r){var i=Mr();r={blockedOn:null,target:r,priority:i};for(var c=0;c<Fr.length&&i!==0&&i<Fr[c].priority;c++);Fr.splice(c,0,r),c===0&&E(r)}};function ef(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function mu(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11&&(r.nodeType!==8||r.nodeValue!==" react-mount-point-unstable "))}function yy(){}function wE(r,i,c,h,p){if(p){if(typeof h=="function"){var v=h;h=function(){var oe=fu(b);v.call(oe)}}var b=py(i,h,r,0,null,!1,!1,"",yy);return r._reactRootContainer=b,r[ii]=b.current,hl(r.nodeType===8?r.parentNode:r),Na(),b}for(;p=r.lastChild;)r.removeChild(p);if(typeof h=="function"){var M=h;h=function(){var oe=fu(G);M.call(oe)}}var G=Jh(r,0,!1,null,null,!1,!1,"",yy);return r._reactRootContainer=G,r[ii]=G.current,hl(r.nodeType===8?r.parentNode:r),Na(function(){hu(i,G,c,h)}),G}function gu(r,i,c,h,p){var v=c._reactRootContainer;if(v){var b=v;if(typeof p=="function"){var M=p;p=function(){var G=fu(b);M.call(G)}}hu(i,b,r,p)}else b=wE(c,i,r,p,h);return fu(b)}ma=function(r){switch(r.tag){case 3:var i=r.stateNode;if(i.current.memoizedState.isDehydrated){var c=De(i.pendingLanes);c!==0&&(ts(i,c|1),Nr(i,pt()),(St&6)===0&&(bo=pt()+500,ji()))}break;case 13:Na(function(){var h=ci(r,1);if(h!==null){var p=gr();Cs(h,r,1,p)}}),Xh(r,1)}},jt=function(r){if(r.tag===13){var i=ci(r,134217728);if(i!==null){var c=gr();Cs(i,r,134217728,c)}Xh(r,134217728)}},Fs=function(r){if(r.tag===13){var i=Oi(r),c=ci(r,i);if(c!==null){var h=gr();Cs(c,r,i,h)}Xh(r,i)}},Mr=function(){return gt},ga=function(r,i){var c=gt;try{return gt=r,i()}finally{gt=c}},Jr=function(r,i,c){switch(i){case"input":if(Nt(r,c),i=c.name,c.type==="radio"&&i!=null){for(c=r;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<c.length;i++){var h=c[i];if(h!==r&&h.form===r.form){var p=kc(h);if(!p)throw Error(t(90));Oe(h),Nt(h,p)}}}break;case"textarea":un(r,c);break;case"select":i=c.value,i!=null&&Kt(r,!!c.multiple,i,!1)}},Lr=Gh,Ds=Na;var EE={usingClientEntryPoint:!1,Events:[ml,ho,kc,_r,Vr,Gh]},Pl={findFiberByHostInstance:xa,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},TE={bundleType:Pl.bundleType,version:Pl.version,rendererPackageName:Pl.rendererPackageName,rendererConfig:Pl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:we.ReactCurrentDispatcher,findHostInstanceByFiber:function(r){return r=es(r),r===null?null:r.stateNode},findFiberByHostInstance:Pl.findFiberByHostInstance||xE,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var yu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!yu.isDisabled&&yu.supportsFiber)try{w=yu.inject(TE),D=yu}catch{}}return Pr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=EE,Pr.createPortal=function(r,i){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ef(i))throw Error(t(200));return _E(r,i,null,c)},Pr.createRoot=function(r,i){if(!ef(r))throw Error(t(299));var c=!1,h="",p=gy;return i!=null&&(i.unstable_strictMode===!0&&(c=!0),i.identifierPrefix!==void 0&&(h=i.identifierPrefix),i.onRecoverableError!==void 0&&(p=i.onRecoverableError)),i=Jh(r,1,!1,null,null,c,!1,h,p),r[ii]=i.current,hl(r.nodeType===8?r.parentNode:r),new Zh(i)},Pr.findDOMNode=function(r){if(r==null)return null;if(r.nodeType===1)return r;var i=r._reactInternals;if(i===void 0)throw typeof r.render=="function"?Error(t(188)):(r=Object.keys(r).join(","),Error(t(268,r)));return r=es(i),r=r===null?null:r.stateNode,r},Pr.flushSync=function(r){return Na(r)},Pr.hydrate=function(r,i,c){if(!mu(i))throw Error(t(200));return gu(null,r,i,!0,c)},Pr.hydrateRoot=function(r,i,c){if(!ef(r))throw Error(t(405));var h=c!=null&&c.hydratedSources||null,p=!1,v="",b=gy;if(c!=null&&(c.unstable_strictMode===!0&&(p=!0),c.identifierPrefix!==void 0&&(v=c.identifierPrefix),c.onRecoverableError!==void 0&&(b=c.onRecoverableError)),i=py(i,null,r,1,c??null,p,!1,v,b),r[ii]=i.current,hl(r),h)for(r=0;r<h.length;r++)c=h[r],p=c._getVersion,p=p(c._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[c,p]:i.mutableSourceEagerHydrationData.push(c,p);return new pu(i)},Pr.render=function(r,i,c){if(!mu(i))throw Error(t(200));return gu(null,r,i,!1,c)},Pr.unmountComponentAtNode=function(r){if(!mu(r))throw Error(t(40));return r._reactRootContainer?(Na(function(){gu(null,null,r,!1,function(){r._reactRootContainer=null,r[ii]=null})}),!0):!1},Pr.unstable_batchedUpdates=Gh,Pr.unstable_renderSubtreeIntoContainer=function(r,i,c,h){if(!mu(c))throw Error(t(200));if(r==null||r._reactInternals===void 0)throw Error(t(38));return gu(r,i,c,!1,h)},Pr.version="18.3.1-next-f1338f8080-20240426",Pr}var by;function A_(){if(by)return rf.exports;by=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),rf.exports=jE(),rf.exports}var Cy;function kE(){if(Cy)return vu;Cy=1;var n=A_();return vu.createRoot=n.createRoot,vu.hydrateRoot=n.hydrateRoot,vu}var DE=kE();const VE=sp(DE);A_();/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ql(){return ql=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},ql.apply(this,arguments)}var Hi;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(Hi||(Hi={}));const Iy="popstate";function LE(n){n===void 0&&(n={});function e(s,a){let{pathname:l,search:u,hash:f}=s.location;return Sf("",{pathname:l,search:u,hash:f},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(s,a){return typeof a=="string"?a:Uu(a)}return OE(e,t,null,n)}function mn(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function op(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function ME(){return Math.random().toString(36).substr(2,8)}function Ny(n,e){return{usr:n.state,key:n.key,idx:e}}function Sf(n,e,t,s){return t===void 0&&(t=null),ql({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?qo(e):e,{state:t,key:e&&e.key||s||ME()})}function Uu(n){let{pathname:e="/",search:t="",hash:s=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),s&&s!=="#"&&(e+=s.charAt(0)==="#"?s:"#"+s),e}function qo(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let s=n.indexOf("?");s>=0&&(e.search=n.substr(s),n=n.substr(0,s)),n&&(e.pathname=n)}return e}function OE(n,e,t,s){s===void 0&&(s={});let{window:a=document.defaultView,v5Compat:l=!1}=s,u=a.history,f=Hi.Pop,m=null,y=_();y==null&&(y=0,u.replaceState(ql({},u.state,{idx:y}),""));function _(){return(u.state||{idx:null}).idx}function T(){f=Hi.Pop;let B=_(),se=B==null?null:B-y;y=B,m&&m({action:f,location:$.location,delta:se})}function S(B,se){f=Hi.Push;let _e=Sf($.location,B,se);y=_()+1;let ye=Ny(_e,y),we=$.createHref(_e);try{u.pushState(ye,"",we)}catch(O){if(O instanceof DOMException&&O.name==="DataCloneError")throw O;a.location.assign(we)}l&&m&&m({action:f,location:$.location,delta:1})}function F(B,se){f=Hi.Replace;let _e=Sf($.location,B,se);y=_();let ye=Ny(_e,y),we=$.createHref(_e);u.replaceState(ye,"",we),l&&m&&m({action:f,location:$.location,delta:0})}function J(B){let se=a.location.origin!=="null"?a.location.origin:a.location.href,_e=typeof B=="string"?B:Uu(B);return _e=_e.replace(/ $/,"%20"),mn(se,"No window.location.(origin|href) available to create URL for href: "+_e),new URL(_e,se)}let $={get action(){return f},get location(){return n(a,u)},listen(B){if(m)throw new Error("A history only accepts one active listener");return a.addEventListener(Iy,T),m=B,()=>{a.removeEventListener(Iy,T),m=null}},createHref(B){return e(a,B)},createURL:J,encodeLocation(B){let se=J(B);return{pathname:se.pathname,search:se.search,hash:se.hash}},push:S,replace:F,go(B){return u.go(B)}};return $}var Py;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(Py||(Py={}));function FE(n,e,t){return t===void 0&&(t="/"),UE(n,e,t)}function UE(n,e,t,s){let a=typeof e=="string"?qo(e):e,l=lp(a.pathname||"/",t);if(l==null)return null;let u=j_(n);zE(u);let f=null;for(let m=0;f==null&&m<u.length;++m){let y=ZE(l);f=YE(u[m],y)}return f}function j_(n,e,t,s){e===void 0&&(e=[]),t===void 0&&(t=[]),s===void 0&&(s="");let a=(l,u,f)=>{let m={relativePath:f===void 0?l.path||"":f,caseSensitive:l.caseSensitive===!0,childrenIndex:u,route:l};m.relativePath.startsWith("/")&&(mn(m.relativePath.startsWith(s),'Absolute route path "'+m.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),m.relativePath=m.relativePath.slice(s.length));let y=Yi([s,m.relativePath]),_=t.concat(m);l.children&&l.children.length>0&&(mn(l.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+y+'".')),j_(l.children,e,_,y)),!(l.path==null&&!l.index)&&e.push({path:y,score:KE(y,l.index),routesMeta:_})};return n.forEach((l,u)=>{var f;if(l.path===""||!((f=l.path)!=null&&f.includes("?")))a(l,u);else for(let m of k_(l.path))a(l,u,m)}),e}function k_(n){let e=n.split("/");if(e.length===0)return[];let[t,...s]=e,a=t.endsWith("?"),l=t.replace(/\?$/,"");if(s.length===0)return a?[l,""]:[l];let u=k_(s.join("/")),f=[];return f.push(...u.map(m=>m===""?l:[l,m].join("/"))),a&&f.push(...u),f.map(m=>n.startsWith("/")&&m===""?"/":m)}function zE(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:QE(e.routesMeta.map(s=>s.childrenIndex),t.routesMeta.map(s=>s.childrenIndex)))}const BE=/^:[\w-]+$/,$E=3,WE=2,GE=1,qE=10,HE=-2,Ry=n=>n==="*";function KE(n,e){let t=n.split("/"),s=t.length;return t.some(Ry)&&(s+=HE),e&&(s+=WE),t.filter(a=>!Ry(a)).reduce((a,l)=>a+(BE.test(l)?$E:l===""?GE:qE),s)}function QE(n,e){return n.length===e.length&&n.slice(0,-1).every((s,a)=>s===e[a])?n[n.length-1]-e[e.length-1]:0}function YE(n,e,t){let{routesMeta:s}=n,a={},l="/",u=[];for(let f=0;f<s.length;++f){let m=s[f],y=f===s.length-1,_=l==="/"?e:e.slice(l.length)||"/",T=JE({path:m.relativePath,caseSensitive:m.caseSensitive,end:y},_),S=m.route;if(!T)return null;Object.assign(a,T.params),u.push({params:a,pathname:Yi([l,T.pathname]),pathnameBase:s1(Yi([l,T.pathnameBase])),route:S}),T.pathnameBase!=="/"&&(l=Yi([l,T.pathnameBase]))}return u}function JE(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,s]=XE(n.path,n.caseSensitive,n.end),a=e.match(t);if(!a)return null;let l=a[0],u=l.replace(/(.)\/+$/,"$1"),f=a.slice(1);return{params:s.reduce((y,_,T)=>{let{paramName:S,isOptional:F}=_;if(S==="*"){let $=f[T]||"";u=l.slice(0,l.length-$.length).replace(/(.)\/+$/,"$1")}const J=f[T];return F&&!J?y[S]=void 0:y[S]=(J||"").replace(/%2F/g,"/"),y},{}),pathname:l,pathnameBase:u,pattern:n}}function XE(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),op(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let s=[],a="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(u,f,m)=>(s.push({paramName:f,isOptional:m!=null}),m?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(s.push({paramName:"*"}),a+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?a+="\\/*$":n!==""&&n!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),s]}function ZE(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return op(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function lp(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,s=n.charAt(t);return s&&s!=="/"?null:n.slice(t)||"/"}const e1=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,t1=n=>e1.test(n);function n1(n,e){e===void 0&&(e="/");let{pathname:t,search:s="",hash:a=""}=typeof n=="string"?qo(n):n,l;if(t)if(t1(t))l=t;else{if(t.includes("//")){let u=t;t=t.replace(/\/\/+/g,"/"),op(!1,"Pathnames cannot have embedded double slashes - normalizing "+(u+" -> "+t))}t.startsWith("/")?l=Ay(t.substring(1),"/"):l=Ay(t,e)}else l=e;return{pathname:l,search:i1(s),hash:a1(a)}}function Ay(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(a=>{a===".."?t.length>1&&t.pop():a!=="."&&t.push(a)}),t.length>1?t.join("/"):"/"}function of(n,e,t,s){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function r1(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function cp(n,e){let t=r1(n);return e?t.map((s,a)=>a===t.length-1?s.pathname:s.pathnameBase):t.map(s=>s.pathnameBase)}function up(n,e,t,s){s===void 0&&(s=!1);let a;typeof n=="string"?a=qo(n):(a=ql({},n),mn(!a.pathname||!a.pathname.includes("?"),of("?","pathname","search",a)),mn(!a.pathname||!a.pathname.includes("#"),of("#","pathname","hash",a)),mn(!a.search||!a.search.includes("#"),of("#","search","hash",a)));let l=n===""||a.pathname==="",u=l?"/":a.pathname,f;if(u==null)f=t;else{let T=e.length-1;if(!s&&u.startsWith("..")){let S=u.split("/");for(;S[0]==="..";)S.shift(),T-=1;a.pathname=S.join("/")}f=T>=0?e[T]:"/"}let m=n1(a,f),y=u&&u!=="/"&&u.endsWith("/"),_=(l||u===".")&&t.endsWith("/");return!m.pathname.endsWith("/")&&(y||_)&&(m.pathname+="/"),m}const Yi=n=>n.join("/").replace(/\/\/+/g,"/"),s1=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),i1=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,a1=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function o1(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const D_=["post","put","patch","delete"];new Set(D_);const l1=["get",...D_];new Set(l1);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Hl(){return Hl=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},Hl.apply(this,arguments)}const dp=j.createContext(null),c1=j.createContext(null),ca=j.createContext(null),od=j.createContext(null),ua=j.createContext({outlet:null,matches:[],isDataRoute:!1}),V_=j.createContext(null);function u1(n,e){let{relative:t}=e===void 0?{}:e;Ho()||mn(!1);let{basename:s,navigator:a}=j.useContext(ca),{hash:l,pathname:u,search:f}=M_(n,{relative:t}),m=u;return s!=="/"&&(m=u==="/"?s:Yi([s,u])),a.createHref({pathname:m,search:f,hash:l})}function Ho(){return j.useContext(od)!=null}function Ko(){return Ho()||mn(!1),j.useContext(od).location}function L_(n){j.useContext(ca).static||j.useLayoutEffect(n)}function ic(){let{isDataRoute:n}=j.useContext(ua);return n?T1():d1()}function d1(){Ho()||mn(!1);let n=j.useContext(dp),{basename:e,future:t,navigator:s}=j.useContext(ca),{matches:a}=j.useContext(ua),{pathname:l}=Ko(),u=JSON.stringify(cp(a,t.v7_relativeSplatPath)),f=j.useRef(!1);return L_(()=>{f.current=!0}),j.useCallback(function(y,_){if(_===void 0&&(_={}),!f.current)return;if(typeof y=="number"){s.go(y);return}let T=up(y,JSON.parse(u),l,_.relative==="path");n==null&&e!=="/"&&(T.pathname=T.pathname==="/"?e:Yi([e,T.pathname])),(_.replace?s.replace:s.push)(T,_.state,_)},[e,s,u,l,n])}function M_(n,e){let{relative:t}=e===void 0?{}:e,{future:s}=j.useContext(ca),{matches:a}=j.useContext(ua),{pathname:l}=Ko(),u=JSON.stringify(cp(a,s.v7_relativeSplatPath));return j.useMemo(()=>up(n,JSON.parse(u),l,t==="path"),[n,u,l,t])}function h1(n,e){return f1(n,e)}function f1(n,e,t,s){Ho()||mn(!1);let{navigator:a}=j.useContext(ca),{matches:l}=j.useContext(ua),u=l[l.length-1],f=u?u.params:{};u&&u.pathname;let m=u?u.pathnameBase:"/";u&&u.route;let y=Ko(),_;if(e){var T;let B=typeof e=="string"?qo(e):e;m==="/"||(T=B.pathname)!=null&&T.startsWith(m)||mn(!1),_=B}else _=y;let S=_.pathname||"/",F=S;if(m!=="/"){let B=m.replace(/^\//,"").split("/");F="/"+S.replace(/^\//,"").split("/").slice(B.length).join("/")}let J=FE(n,{pathname:F}),$=v1(J&&J.map(B=>Object.assign({},B,{params:Object.assign({},f,B.params),pathname:Yi([m,a.encodeLocation?a.encodeLocation(B.pathname).pathname:B.pathname]),pathnameBase:B.pathnameBase==="/"?m:Yi([m,a.encodeLocation?a.encodeLocation(B.pathnameBase).pathname:B.pathnameBase])})),l,t,s);return e&&$?j.createElement(od.Provider,{value:{location:Hl({pathname:"/",search:"",hash:"",state:null,key:"default"},_),navigationType:Hi.Pop}},$):$}function p1(){let n=E1(),e=o1(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return j.createElement(j.Fragment,null,j.createElement("h2",null,"Unexpected Application Error!"),j.createElement("h3",{style:{fontStyle:"italic"}},e),t?j.createElement("pre",{style:a},t):null,null)}const m1=j.createElement(p1,null);class g1 extends j.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?j.createElement(ua.Provider,{value:this.props.routeContext},j.createElement(V_.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function y1(n){let{routeContext:e,match:t,children:s}=n,a=j.useContext(dp);return a&&a.static&&a.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=t.route.id),j.createElement(ua.Provider,{value:e},s)}function v1(n,e,t,s){var a;if(e===void 0&&(e=[]),t===void 0&&(t=null),s===void 0&&(s=null),n==null){var l;if(!t)return null;if(t.errors)n=t.matches;else if((l=s)!=null&&l.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let u=n,f=(a=t)==null?void 0:a.errors;if(f!=null){let _=u.findIndex(T=>T.route.id&&(f==null?void 0:f[T.route.id])!==void 0);_>=0||mn(!1),u=u.slice(0,Math.min(u.length,_+1))}let m=!1,y=-1;if(t&&s&&s.v7_partialHydration)for(let _=0;_<u.length;_++){let T=u[_];if((T.route.HydrateFallback||T.route.hydrateFallbackElement)&&(y=_),T.route.id){let{loaderData:S,errors:F}=t,J=T.route.loader&&S[T.route.id]===void 0&&(!F||F[T.route.id]===void 0);if(T.route.lazy||J){m=!0,y>=0?u=u.slice(0,y+1):u=[u[0]];break}}}return u.reduceRight((_,T,S)=>{let F,J=!1,$=null,B=null;t&&(F=f&&T.route.id?f[T.route.id]:void 0,$=T.route.errorElement||m1,m&&(y<0&&S===0?(S1("route-fallback"),J=!0,B=null):y===S&&(J=!0,B=T.route.hydrateFallbackElement||null)));let se=e.concat(u.slice(0,S+1)),_e=()=>{let ye;return F?ye=$:J?ye=B:T.route.Component?ye=j.createElement(T.route.Component,null):T.route.element?ye=T.route.element:ye=_,j.createElement(y1,{match:T,routeContext:{outlet:_,matches:se,isDataRoute:t!=null},children:ye})};return t&&(T.route.ErrorBoundary||T.route.errorElement||S===0)?j.createElement(g1,{location:t.location,revalidation:t.revalidation,component:$,error:F,children:_e(),routeContext:{outlet:null,matches:se,isDataRoute:!0}}):_e()},null)}var O_=(function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n})(O_||{}),F_=(function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n})(F_||{});function _1(n){let e=j.useContext(dp);return e||mn(!1),e}function x1(n){let e=j.useContext(c1);return e||mn(!1),e}function w1(n){let e=j.useContext(ua);return e||mn(!1),e}function U_(n){let e=w1(),t=e.matches[e.matches.length-1];return t.route.id||mn(!1),t.route.id}function E1(){var n;let e=j.useContext(V_),t=x1(),s=U_();return e!==void 0?e:(n=t.errors)==null?void 0:n[s]}function T1(){let{router:n}=_1(O_.UseNavigateStable),e=U_(F_.UseNavigateStable),t=j.useRef(!1);return L_(()=>{t.current=!0}),j.useCallback(function(a,l){l===void 0&&(l={}),t.current&&(typeof a=="number"?n.navigate(a):n.navigate(a,Hl({fromRouteId:e},l)))},[n,e])}const jy={};function S1(n,e,t){jy[n]||(jy[n]=!0)}function b1(n,e){n==null||n.v7_startTransition,n==null||n.v7_relativeSplatPath}function bf(n){let{to:e,replace:t,state:s,relative:a}=n;Ho()||mn(!1);let{future:l,static:u}=j.useContext(ca),{matches:f}=j.useContext(ua),{pathname:m}=Ko(),y=ic(),_=up(e,cp(f,l.v7_relativeSplatPath),m,a==="path"),T=JSON.stringify(_);return j.useEffect(()=>y(JSON.parse(T),{replace:t,state:s,relative:a}),[y,T,a,t,s]),null}function hs(n){mn(!1)}function C1(n){let{basename:e="/",children:t=null,location:s,navigationType:a=Hi.Pop,navigator:l,static:u=!1,future:f}=n;Ho()&&mn(!1);let m=e.replace(/^\/*/,"/"),y=j.useMemo(()=>({basename:m,navigator:l,static:u,future:Hl({v7_relativeSplatPath:!1},f)}),[m,f,l,u]);typeof s=="string"&&(s=qo(s));let{pathname:_="/",search:T="",hash:S="",state:F=null,key:J="default"}=s,$=j.useMemo(()=>{let B=lp(_,m);return B==null?null:{location:{pathname:B,search:T,hash:S,state:F,key:J},navigationType:a}},[m,_,T,S,F,J,a]);return $==null?null:j.createElement(ca.Provider,{value:y},j.createElement(od.Provider,{children:t,value:$}))}function I1(n){let{children:e,location:t}=n;return h1(Cf(e),t)}new Promise(()=>{});function Cf(n,e){e===void 0&&(e=[]);let t=[];return j.Children.forEach(n,(s,a)=>{if(!j.isValidElement(s))return;let l=[...e,a];if(s.type===j.Fragment){t.push.apply(t,Cf(s.props.children,l));return}s.type!==hs&&mn(!1),!s.props.index||!s.props.children||mn(!1);let u={id:s.props.id||l.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(u.children=Cf(s.props.children,l)),t.push(u)}),t}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function If(){return If=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},If.apply(this,arguments)}function N1(n,e){if(n==null)return{};var t={},s=Object.keys(n),a,l;for(l=0;l<s.length;l++)a=s[l],!(e.indexOf(a)>=0)&&(t[a]=n[a]);return t}function P1(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function R1(n,e){return n.button===0&&(!e||e==="_self")&&!P1(n)}function Nf(n){return n===void 0&&(n=""),new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((e,t)=>{let s=n[t];return e.concat(Array.isArray(s)?s.map(a=>[t,a]):[[t,s]])},[]))}function A1(n,e){let t=Nf(n);return e&&e.forEach((s,a)=>{t.has(a)||e.getAll(a).forEach(l=>{t.append(a,l)})}),t}const j1=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],k1="6";try{window.__reactRouterVersion=k1}catch{}const D1="startTransition",ky=PE[D1];function V1(n){let{basename:e,children:t,future:s,window:a}=n,l=j.useRef();l.current==null&&(l.current=LE({window:a,v5Compat:!0}));let u=l.current,[f,m]=j.useState({action:u.action,location:u.location}),{v7_startTransition:y}=s||{},_=j.useCallback(T=>{y&&ky?ky(()=>m(T)):m(T)},[m,y]);return j.useLayoutEffect(()=>u.listen(_),[u,_]),j.useEffect(()=>b1(s),[s]),j.createElement(C1,{basename:e,children:t,location:f.location,navigationType:f.action,navigator:u,future:s})}const L1=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",M1=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Bi=j.forwardRef(function(e,t){let{onClick:s,relative:a,reloadDocument:l,replace:u,state:f,target:m,to:y,preventScrollReset:_,viewTransition:T}=e,S=N1(e,j1),{basename:F}=j.useContext(ca),J,$=!1;if(typeof y=="string"&&M1.test(y)&&(J=y,L1))try{let ye=new URL(window.location.href),we=y.startsWith("//")?new URL(ye.protocol+y):new URL(y),O=lp(we.pathname,F);we.origin===ye.origin&&O!=null?y=O+we.search+we.hash:$=!0}catch{}let B=u1(y,{relative:a}),se=O1(y,{replace:u,state:f,target:m,preventScrollReset:_,relative:a,viewTransition:T});function _e(ye){s&&s(ye),ye.defaultPrevented||se(ye)}return j.createElement("a",If({},S,{href:J||B,onClick:$||l?s:_e,ref:t,target:m}))});var Dy;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(Dy||(Dy={}));var Vy;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(Vy||(Vy={}));function O1(n,e){let{target:t,replace:s,state:a,preventScrollReset:l,relative:u,viewTransition:f}=e===void 0?{}:e,m=ic(),y=Ko(),_=M_(n,{relative:u});return j.useCallback(T=>{if(R1(T,t)){T.preventDefault();let S=s!==void 0?s:Uu(y)===Uu(_);m(n,{replace:S,state:a,preventScrollReset:l,relative:u,viewTransition:f})}},[y,m,_,s,a,t,n,l,u,f])}function F1(n){let e=j.useRef(Nf(n)),t=j.useRef(!1),s=Ko(),a=j.useMemo(()=>A1(s.search,t.current?null:e.current),[s.search]),l=ic(),u=j.useCallback((f,m)=>{const y=Nf(typeof f=="function"?f(a):f);t.current=!0,l("?"+y,m)},[l,a]);return[a,u]}const U1=()=>{};var Ly={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z_=function(n){const e=[];let t=0;for(let s=0;s<n.length;s++){let a=n.charCodeAt(s);a<128?e[t++]=a:a<2048?(e[t++]=a>>6|192,e[t++]=a&63|128):(a&64512)===55296&&s+1<n.length&&(n.charCodeAt(s+1)&64512)===56320?(a=65536+((a&1023)<<10)+(n.charCodeAt(++s)&1023),e[t++]=a>>18|240,e[t++]=a>>12&63|128,e[t++]=a>>6&63|128,e[t++]=a&63|128):(e[t++]=a>>12|224,e[t++]=a>>6&63|128,e[t++]=a&63|128)}return e},z1=function(n){const e=[];let t=0,s=0;for(;t<n.length;){const a=n[t++];if(a<128)e[s++]=String.fromCharCode(a);else if(a>191&&a<224){const l=n[t++];e[s++]=String.fromCharCode((a&31)<<6|l&63)}else if(a>239&&a<365){const l=n[t++],u=n[t++],f=n[t++],m=((a&7)<<18|(l&63)<<12|(u&63)<<6|f&63)-65536;e[s++]=String.fromCharCode(55296+(m>>10)),e[s++]=String.fromCharCode(56320+(m&1023))}else{const l=n[t++],u=n[t++];e[s++]=String.fromCharCode((a&15)<<12|(l&63)<<6|u&63)}}return e.join("")},B_={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let a=0;a<n.length;a+=3){const l=n[a],u=a+1<n.length,f=u?n[a+1]:0,m=a+2<n.length,y=m?n[a+2]:0,_=l>>2,T=(l&3)<<4|f>>4;let S=(f&15)<<2|y>>6,F=y&63;m||(F=64,u||(S=64)),s.push(t[_],t[T],t[S],t[F])}return s.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(z_(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):z1(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let a=0;a<n.length;){const l=t[n.charAt(a++)],f=a<n.length?t[n.charAt(a)]:0;++a;const y=a<n.length?t[n.charAt(a)]:64;++a;const T=a<n.length?t[n.charAt(a)]:64;if(++a,l==null||f==null||y==null||T==null)throw new B1;const S=l<<2|f>>4;if(s.push(S),y!==64){const F=f<<4&240|y>>2;if(s.push(F),T!==64){const J=y<<6&192|T;s.push(J)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class B1 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const $1=function(n){const e=z_(n);return B_.encodeByteArray(e,!0)},zu=function(n){return $1(n).replace(/\./g,"")},$_=function(n){try{return B_.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W1(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G1=()=>W1().__FIREBASE_DEFAULTS__,q1=()=>{if(typeof process>"u"||typeof Ly>"u")return;const n=Ly.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},H1=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&$_(n[1]);return e&&JSON.parse(e)},ld=()=>{try{return U1()||G1()||q1()||H1()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},W_=n=>{var e,t;return(t=(e=ld())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},K1=n=>{const e=W_(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),s]:[e.substring(0,t),s]},G_=()=>{var n;return(n=ld())===null||n===void 0?void 0:n.config},q_=n=>{var e;return(e=ld())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q1{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,s)=>{t?this.reject(t):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,s))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qo(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function H_(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y1(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},s=e||"demo-project",a=n.iat||0,l=n.sub||n.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const u=Object.assign({iss:`https://securetoken.google.com/${s}`,aud:s,iat:a,exp:a+3600,auth_time:a,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}}},n);return[zu(JSON.stringify(t)),zu(JSON.stringify(u)),""].join(".")}const Fl={};function J1(){const n={prod:[],emulator:[]};for(const e of Object.keys(Fl))Fl[e]?n.emulator.push(e):n.prod.push(e);return n}function X1(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let My=!1;function K_(n,e){if(typeof window>"u"||typeof document>"u"||!Qo(window.location.host)||Fl[n]===e||Fl[n]||My)return;Fl[n]=e;function t(S){return`__firebase__banner__${S}`}const s="__firebase__banner",l=J1().prod.length>0;function u(){const S=document.getElementById(s);S&&S.remove()}function f(S){S.style.display="flex",S.style.background="#7faaf0",S.style.position="fixed",S.style.bottom="5px",S.style.left="5px",S.style.padding=".5em",S.style.borderRadius="5px",S.style.alignItems="center"}function m(S,F){S.setAttribute("width","24"),S.setAttribute("id",F),S.setAttribute("height","24"),S.setAttribute("viewBox","0 0 24 24"),S.setAttribute("fill","none"),S.style.marginLeft="-6px"}function y(){const S=document.createElement("span");return S.style.cursor="pointer",S.style.marginLeft="16px",S.style.fontSize="24px",S.innerHTML=" &times;",S.onclick=()=>{My=!0,u()},S}function _(S,F){S.setAttribute("id",F),S.innerText="Learn more",S.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",S.setAttribute("target","__blank"),S.style.paddingLeft="5px",S.style.textDecoration="underline"}function T(){const S=X1(s),F=t("text"),J=document.getElementById(F)||document.createElement("span"),$=t("learnmore"),B=document.getElementById($)||document.createElement("a"),se=t("preprendIcon"),_e=document.getElementById(se)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(S.created){const ye=S.element;f(ye),_(B,$);const we=y();m(_e,se),ye.append(_e,J,B,we),document.body.appendChild(ye)}l?(J.innerText="Preview backend disconnected.",_e.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(_e.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,J.innerText="Preview backend running in this workspace."),J.setAttribute("id",F)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",T):T()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Z1(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(lr())}function eT(){var n;const e=(n=ld())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function tT(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function nT(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function rT(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function sT(){const n=lr();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function iT(){return!eT()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function aT(){try{return typeof indexedDB=="object"}catch{return!1}}function oT(){return new Promise((n,e)=>{try{let t=!0;const s="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(s);a.onsuccess=()=>{a.result.close(),t||self.indexedDB.deleteDatabase(s),n(!0)},a.onupgradeneeded=()=>{t=!1},a.onerror=()=>{var l;e(((l=a.error)===null||l===void 0?void 0:l.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lT="FirebaseError";class Ti extends Error{constructor(e,t,s){super(t),this.code=e,this.customData=s,this.name=lT,Object.setPrototypeOf(this,Ti.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ac.prototype.create)}}class ac{constructor(e,t,s){this.service=e,this.serviceName=t,this.errors=s}create(e,...t){const s=t[0]||{},a=`${this.service}/${e}`,l=this.errors[e],u=l?cT(l,s):"Error",f=`${this.serviceName}: ${u} (${a}).`;return new Ti(a,f,s)}}function cT(n,e){return n.replace(uT,(t,s)=>{const a=e[s];return a!=null?String(a):`<${s}?>`})}const uT=/\{\$([^}]+)}/g;function dT(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Ba(n,e){if(n===e)return!0;const t=Object.keys(n),s=Object.keys(e);for(const a of t){if(!s.includes(a))return!1;const l=n[a],u=e[a];if(Oy(l)&&Oy(u)){if(!Ba(l,u))return!1}else if(l!==u)return!1}for(const a of s)if(!t.includes(a))return!1;return!0}function Oy(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oc(n){const e=[];for(const[t,s]of Object.entries(n))Array.isArray(s)?s.forEach(a=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function kl(n){const e={};return n.replace(/^\?/,"").split("&").forEach(s=>{if(s){const[a,l]=s.split("=");e[decodeURIComponent(a)]=decodeURIComponent(l)}}),e}function Dl(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function hT(n,e){const t=new fT(n,e);return t.subscribe.bind(t)}class fT{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,s){let a;if(e===void 0&&t===void 0&&s===void 0)throw new Error("Missing Observer.");pT(e,["next","error","complete"])?a=e:a={next:e,error:t,complete:s},a.next===void 0&&(a.next=lf),a.error===void 0&&(a.error=lf),a.complete===void 0&&(a.complete=lf);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function pT(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function lf(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ln(n){return n&&n._delegate?n._delegate:n}class $a{constructor(e,t,s){this.name=e,this.instanceFactory=t,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ja="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mT{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const s=new Q1;if(this.instancesDeferred.set(t,s),this.isInitialized(t)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:t});a&&s.resolve(a)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const s=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),a=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(s)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:s})}catch(l){if(a)return null;throw l}else{if(a)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(yT(e))try{this.getOrInitializeService({instanceIdentifier:ja})}catch{}for(const[t,s]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(t);try{const l=this.getOrInitializeService({instanceIdentifier:a});s.resolve(l)}catch{}}}}clearInstance(e=ja){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ja){return this.instances.has(e)}getOptions(e=ja){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:s,options:t});for(const[l,u]of this.instancesDeferred.entries()){const f=this.normalizeInstanceIdentifier(l);s===f&&u.resolve(a)}return a}onInit(e,t){var s;const a=this.normalizeInstanceIdentifier(t),l=(s=this.onInitCallbacks.get(a))!==null&&s!==void 0?s:new Set;l.add(e),this.onInitCallbacks.set(a,l);const u=this.instances.get(a);return u&&e(u,a),()=>{l.delete(e)}}invokeOnInitCallbacks(e,t){const s=this.onInitCallbacks.get(t);if(s)for(const a of s)try{a(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:gT(e),options:t}),this.instances.set(e,s),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=ja){return this.component?this.component.multipleInstances?e:ja:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function gT(n){return n===ja?void 0:n}function yT(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vT{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new mT(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var yt;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(yt||(yt={}));const _T={debug:yt.DEBUG,verbose:yt.VERBOSE,info:yt.INFO,warn:yt.WARN,error:yt.ERROR,silent:yt.SILENT},xT=yt.INFO,wT={[yt.DEBUG]:"log",[yt.VERBOSE]:"log",[yt.INFO]:"info",[yt.WARN]:"warn",[yt.ERROR]:"error"},ET=(n,e,...t)=>{if(e<n.logLevel)return;const s=new Date().toISOString(),a=wT[e];if(a)console[a](`[${s}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class hp{constructor(e){this.name=e,this._logLevel=xT,this._logHandler=ET,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in yt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?_T[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,yt.DEBUG,...e),this._logHandler(this,yt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,yt.VERBOSE,...e),this._logHandler(this,yt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,yt.INFO,...e),this._logHandler(this,yt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,yt.WARN,...e),this._logHandler(this,yt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,yt.ERROR,...e),this._logHandler(this,yt.ERROR,...e)}}const TT=(n,e)=>e.some(t=>n instanceof t);let Fy,Uy;function ST(){return Fy||(Fy=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function bT(){return Uy||(Uy=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Q_=new WeakMap,Pf=new WeakMap,Y_=new WeakMap,cf=new WeakMap,fp=new WeakMap;function CT(n){const e=new Promise((t,s)=>{const a=()=>{n.removeEventListener("success",l),n.removeEventListener("error",u)},l=()=>{t(Ji(n.result)),a()},u=()=>{s(n.error),a()};n.addEventListener("success",l),n.addEventListener("error",u)});return e.then(t=>{t instanceof IDBCursor&&Q_.set(t,n)}).catch(()=>{}),fp.set(e,n),e}function IT(n){if(Pf.has(n))return;const e=new Promise((t,s)=>{const a=()=>{n.removeEventListener("complete",l),n.removeEventListener("error",u),n.removeEventListener("abort",u)},l=()=>{t(),a()},u=()=>{s(n.error||new DOMException("AbortError","AbortError")),a()};n.addEventListener("complete",l),n.addEventListener("error",u),n.addEventListener("abort",u)});Pf.set(n,e)}let Rf={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Pf.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Y_.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Ji(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function NT(n){Rf=n(Rf)}function PT(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const s=n.call(uf(this),e,...t);return Y_.set(s,e.sort?e.sort():[e]),Ji(s)}:bT().includes(n)?function(...e){return n.apply(uf(this),e),Ji(Q_.get(this))}:function(...e){return Ji(n.apply(uf(this),e))}}function RT(n){return typeof n=="function"?PT(n):(n instanceof IDBTransaction&&IT(n),TT(n,ST())?new Proxy(n,Rf):n)}function Ji(n){if(n instanceof IDBRequest)return CT(n);if(cf.has(n))return cf.get(n);const e=RT(n);return e!==n&&(cf.set(n,e),fp.set(e,n)),e}const uf=n=>fp.get(n);function AT(n,e,{blocked:t,upgrade:s,blocking:a,terminated:l}={}){const u=indexedDB.open(n,e),f=Ji(u);return s&&u.addEventListener("upgradeneeded",m=>{s(Ji(u.result),m.oldVersion,m.newVersion,Ji(u.transaction),m)}),t&&u.addEventListener("blocked",m=>t(m.oldVersion,m.newVersion,m)),f.then(m=>{l&&m.addEventListener("close",()=>l()),a&&m.addEventListener("versionchange",y=>a(y.oldVersion,y.newVersion,y))}).catch(()=>{}),f}const jT=["get","getKey","getAll","getAllKeys","count"],kT=["put","add","delete","clear"],df=new Map;function zy(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(df.get(e))return df.get(e);const t=e.replace(/FromIndex$/,""),s=e!==t,a=kT.includes(t);if(!(t in(s?IDBIndex:IDBObjectStore).prototype)||!(a||jT.includes(t)))return;const l=async function(u,...f){const m=this.transaction(u,a?"readwrite":"readonly");let y=m.store;return s&&(y=y.index(f.shift())),(await Promise.all([y[t](...f),a&&m.done]))[0]};return df.set(e,l),l}NT(n=>({...n,get:(e,t,s)=>zy(e,t)||n.get(e,t,s),has:(e,t)=>!!zy(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DT{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(VT(t)){const s=t.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(t=>t).join(" ")}}function VT(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Af="@firebase/app",By="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yi=new hp("@firebase/app"),LT="@firebase/app-compat",MT="@firebase/analytics-compat",OT="@firebase/analytics",FT="@firebase/app-check-compat",UT="@firebase/app-check",zT="@firebase/auth",BT="@firebase/auth-compat",$T="@firebase/database",WT="@firebase/data-connect",GT="@firebase/database-compat",qT="@firebase/functions",HT="@firebase/functions-compat",KT="@firebase/installations",QT="@firebase/installations-compat",YT="@firebase/messaging",JT="@firebase/messaging-compat",XT="@firebase/performance",ZT="@firebase/performance-compat",eS="@firebase/remote-config",tS="@firebase/remote-config-compat",nS="@firebase/storage",rS="@firebase/storage-compat",sS="@firebase/firestore",iS="@firebase/ai",aS="@firebase/firestore-compat",oS="firebase",lS="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jf="[DEFAULT]",cS={[Af]:"fire-core",[LT]:"fire-core-compat",[OT]:"fire-analytics",[MT]:"fire-analytics-compat",[UT]:"fire-app-check",[FT]:"fire-app-check-compat",[zT]:"fire-auth",[BT]:"fire-auth-compat",[$T]:"fire-rtdb",[WT]:"fire-data-connect",[GT]:"fire-rtdb-compat",[qT]:"fire-fn",[HT]:"fire-fn-compat",[KT]:"fire-iid",[QT]:"fire-iid-compat",[YT]:"fire-fcm",[JT]:"fire-fcm-compat",[XT]:"fire-perf",[ZT]:"fire-perf-compat",[eS]:"fire-rc",[tS]:"fire-rc-compat",[nS]:"fire-gcs",[rS]:"fire-gcs-compat",[sS]:"fire-fst",[aS]:"fire-fst-compat",[iS]:"fire-vertex","fire-js":"fire-js",[oS]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bu=new Map,uS=new Map,kf=new Map;function $y(n,e){try{n.container.addComponent(e)}catch(t){yi.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Oo(n){const e=n.name;if(kf.has(e))return yi.debug(`There were multiple attempts to register component ${e}.`),!1;kf.set(e,n);for(const t of Bu.values())$y(t,n);for(const t of uS.values())$y(t,n);return!0}function pp(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Hr(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dS={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Xi=new ac("app","Firebase",dS);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hS{constructor(e,t,s){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new $a("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Xi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yo=lS;function J_(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const s=Object.assign({name:jf,automaticDataCollectionEnabled:!0},e),a=s.name;if(typeof a!="string"||!a)throw Xi.create("bad-app-name",{appName:String(a)});if(t||(t=G_()),!t)throw Xi.create("no-options");const l=Bu.get(a);if(l){if(Ba(t,l.options)&&Ba(s,l.config))return l;throw Xi.create("duplicate-app",{appName:a})}const u=new vT(a);for(const m of kf.values())u.addComponent(m);const f=new hS(t,s,u);return Bu.set(a,f),f}function X_(n=jf){const e=Bu.get(n);if(!e&&n===jf&&G_())return J_();if(!e)throw Xi.create("no-app",{appName:n});return e}function Zi(n,e,t){var s;let a=(s=cS[n])!==null&&s!==void 0?s:n;t&&(a+=`-${t}`);const l=a.match(/\s|\//),u=e.match(/\s|\//);if(l||u){const f=[`Unable to register library "${a}" with version "${e}":`];l&&f.push(`library name "${a}" contains illegal characters (whitespace or "/")`),l&&u&&f.push("and"),u&&f.push(`version name "${e}" contains illegal characters (whitespace or "/")`),yi.warn(f.join(" "));return}Oo(new $a(`${a}-version`,()=>({library:a,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fS="firebase-heartbeat-database",pS=1,Kl="firebase-heartbeat-store";let hf=null;function Z_(){return hf||(hf=AT(fS,pS,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Kl)}catch(t){console.warn(t)}}}}).catch(n=>{throw Xi.create("idb-open",{originalErrorMessage:n.message})})),hf}async function mS(n){try{const t=(await Z_()).transaction(Kl),s=await t.objectStore(Kl).get(e0(n));return await t.done,s}catch(e){if(e instanceof Ti)yi.warn(e.message);else{const t=Xi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});yi.warn(t.message)}}}async function Wy(n,e){try{const s=(await Z_()).transaction(Kl,"readwrite");await s.objectStore(Kl).put(e,e0(n)),await s.done}catch(t){if(t instanceof Ti)yi.warn(t.message);else{const s=Xi.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});yi.warn(s.message)}}}function e0(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gS=1024,yS=30;class vS{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new xS(t),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){var e,t;try{const a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),l=Gy();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===l||this._heartbeatsCache.heartbeats.some(u=>u.date===l))return;if(this._heartbeatsCache.heartbeats.push({date:l,agent:a}),this._heartbeatsCache.heartbeats.length>yS){const u=wS(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(u,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(s){yi.warn(s)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Gy(),{heartbeatsToSend:s,unsentEntries:a}=_S(this._heartbeatsCache.heartbeats),l=zu(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=t,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(t){return yi.warn(t),""}}}function Gy(){return new Date().toISOString().substring(0,10)}function _S(n,e=gS){const t=[];let s=n.slice();for(const a of n){const l=t.find(u=>u.agent===a.agent);if(l){if(l.dates.push(a.date),qy(t)>e){l.dates.pop();break}}else if(t.push({agent:a.agent,dates:[a.date]}),qy(t)>e){t.pop();break}s=s.slice(1)}return{heartbeatsToSend:t,unsentEntries:s}}class xS{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return aT()?oT().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await mS(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const a=await this.read();return Wy(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:a.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const a=await this.read();return Wy(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:a.lastSentHeartbeatDate,heartbeats:[...a.heartbeats,...e.heartbeats]})}else return}}function qy(n){return zu(JSON.stringify({version:2,heartbeats:n})).length}function wS(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let s=1;s<n.length;s++)n[s].date<t&&(t=n[s].date,e=s);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ES(n){Oo(new $a("platform-logger",e=>new DT(e),"PRIVATE")),Oo(new $a("heartbeat",e=>new vS(e),"PRIVATE")),Zi(Af,By,n),Zi(Af,By,"esm2017"),Zi("fire-js","")}ES("");var TS="firebase",SS="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Zi(TS,SS,"app");function mp(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(n);a<s.length;a++)e.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(n,s[a])&&(t[s[a]]=n[s[a]]);return t}function t0(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const bS=t0,n0=new ac("auth","Firebase",t0());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $u=new hp("@firebase/auth");function CS(n,...e){$u.logLevel<=yt.WARN&&$u.warn(`Auth (${Yo}): ${n}`,...e)}function Iu(n,...e){$u.logLevel<=yt.ERROR&&$u.error(`Auth (${Yo}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ys(n,...e){throw yp(n,...e)}function As(n,...e){return yp(n,...e)}function gp(n,e,t){const s=Object.assign(Object.assign({},bS()),{[e]:t});return new ac("auth","Firebase",s).create(e,{appName:n.name})}function mi(n){return gp(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function r0(n,e,t){const s=t;if(!(e instanceof s))throw s.name!==e.constructor.name&&ys(n,"argument-error"),gp(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function yp(n,...e){if(typeof n!="string"){const t=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=n.name),n._errorFactory.create(t,...s)}return n0.create(n,...e)}function nt(n,e,...t){if(!n)throw yp(e,...t)}function fi(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Iu(e),new Error(e)}function vi(n,e){n||fi(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Df(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function IS(){return Hy()==="http:"||Hy()==="https:"}function Hy(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NS(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(IS()||nT()||"connection"in navigator)?navigator.onLine:!0}function PS(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lc{constructor(e,t){this.shortDelay=e,this.longDelay=t,vi(t>e,"Short delay should be less than long delay!"),this.isMobile=Z1()||rT()}get(){return NS()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vp(n,e){vi(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s0{static initialize(e,t,s){this.fetchImpl=e,t&&(this.headersImpl=t),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;fi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;fi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;fi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RS={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AS=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],jS=new lc(3e4,6e4);function da(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function ei(n,e,t,s,a={}){return i0(n,a,async()=>{let l={},u={};s&&(e==="GET"?u=s:l={body:JSON.stringify(s)});const f=oc(Object.assign({key:n.config.apiKey},u)).slice(1),m=await n._getAdditionalHeaders();m["Content-Type"]="application/json",n.languageCode&&(m["X-Firebase-Locale"]=n.languageCode);const y=Object.assign({method:e,headers:m},l);return tT()||(y.referrerPolicy="no-referrer"),n.emulatorConfig&&Qo(n.emulatorConfig.host)&&(y.credentials="include"),s0.fetch()(await a0(n,n.config.apiHost,t,f),y)})}async function i0(n,e,t){n._canInitEmulator=!1;const s=Object.assign(Object.assign({},RS),e);try{const a=new DS(n),l=await Promise.race([t(),a.promise]);a.clearNetworkTimeout();const u=await l.json();if("needConfirmation"in u)throw _u(n,"account-exists-with-different-credential",u);if(l.ok&&!("errorMessage"in u))return u;{const f=l.ok?u.errorMessage:u.error.message,[m,y]=f.split(" : ");if(m==="FEDERATED_USER_ID_ALREADY_LINKED")throw _u(n,"credential-already-in-use",u);if(m==="EMAIL_EXISTS")throw _u(n,"email-already-in-use",u);if(m==="USER_DISABLED")throw _u(n,"user-disabled",u);const _=s[m]||m.toLowerCase().replace(/[_\s]+/g,"-");if(y)throw gp(n,_,y);ys(n,_)}}catch(a){if(a instanceof Ti)throw a;ys(n,"network-request-failed",{message:String(a)})}}async function cc(n,e,t,s,a={}){const l=await ei(n,e,t,s,a);return"mfaPendingCredential"in l&&ys(n,"multi-factor-auth-required",{_serverResponse:l}),l}async function a0(n,e,t,s){const a=`${e}${t}?${s}`,l=n,u=l.config.emulator?vp(n.config,a):`${n.config.apiScheme}://${a}`;return AS.includes(t)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(u).toString():u}function kS(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class DS{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,s)=>{this.timer=setTimeout(()=>s(As(this.auth,"network-request-failed")),jS.get())})}}function _u(n,e,t){const s={appName:n.name};t.email&&(s.email=t.email),t.phoneNumber&&(s.phoneNumber=t.phoneNumber);const a=As(n,e,s);return a.customData._tokenResponse=t,a}function Ky(n){return n!==void 0&&n.enterprise!==void 0}class VS{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return kS(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function LS(n,e){return ei(n,"GET","/v2/recaptchaConfig",da(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MS(n,e){return ei(n,"POST","/v1/accounts:delete",e)}async function OS(n,e){return ei(n,"POST","/v1/accounts:update",e)}async function Wu(n,e){return ei(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ul(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function FS(n,e=!1){const t=ln(n),s=await t.getIdToken(e),a=_p(s);nt(a&&a.exp&&a.auth_time&&a.iat,t.auth,"internal-error");const l=typeof a.firebase=="object"?a.firebase:void 0,u=l==null?void 0:l.sign_in_provider;return{claims:a,token:s,authTime:Ul(ff(a.auth_time)),issuedAtTime:Ul(ff(a.iat)),expirationTime:Ul(ff(a.exp)),signInProvider:u||null,signInSecondFactor:(l==null?void 0:l.sign_in_second_factor)||null}}function ff(n){return Number(n)*1e3}function _p(n){const[e,t,s]=n.split(".");if(e===void 0||t===void 0||s===void 0)return Iu("JWT malformed, contained fewer than 3 sections"),null;try{const a=$_(t);return a?JSON.parse(a):(Iu("Failed to decode base64 JWT payload"),null)}catch(a){return Iu("Caught error parsing JWT payload as JSON",a==null?void 0:a.toString()),null}}function Qy(n){const e=_p(n);return nt(e,"internal-error"),nt(typeof e.exp<"u","internal-error"),nt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Fo(n,e,t=!1){if(t)return e;try{return await e}catch(s){throw s instanceof Ti&&US(s)&&n.auth.currentUser===n&&await n.auth.signOut(),s}}function US({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zS{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const s=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),s}else{this.errorBackoff=3e4;const a=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,a)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vf{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ul(this.lastLoginAt),this.creationTime=Ul(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ql(n){var e;const t=n.auth,s=await n.getIdToken(),a=await Fo(n,Wu(t,{idToken:s}));nt(a==null?void 0:a.users.length,t,"internal-error");const l=a.users[0];n._notifyReloadListener(l);const u=!((e=l.providerUserInfo)===null||e===void 0)&&e.length?o0(l.providerUserInfo):[],f=$S(n.providerData,u),m=n.isAnonymous,y=!(n.email&&l.passwordHash)&&!(f!=null&&f.length),_=m?y:!1,T={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:f,metadata:new Vf(l.createdAt,l.lastLoginAt),isAnonymous:_};Object.assign(n,T)}async function BS(n){const e=ln(n);await Ql(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function $S(n,e){return[...n.filter(s=>!e.some(a=>a.providerId===s.providerId)),...e]}function o0(n){return n.map(e=>{var{providerId:t}=e,s=mp(e,["providerId"]);return{providerId:t,uid:s.rawId||"",displayName:s.displayName||null,email:s.email||null,phoneNumber:s.phoneNumber||null,photoURL:s.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WS(n,e){const t=await i0(n,{},async()=>{const s=oc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:l}=n.config,u=await a0(n,a,"/v1/token",`key=${l}`),f=await n._getAdditionalHeaders();f["Content-Type"]="application/x-www-form-urlencoded";const m={method:"POST",headers:f,body:s};return n.emulatorConfig&&Qo(n.emulatorConfig.host)&&(m.credentials="include"),s0.fetch()(u,m)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function GS(n,e){return ei(n,"POST","/v2/accounts:revokeToken",da(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Do{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){nt(e.idToken,"internal-error"),nt(typeof e.idToken<"u","internal-error"),nt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Qy(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){nt(e.length!==0,"internal-error");const t=Qy(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(nt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:s,refreshToken:a,expiresIn:l}=await WS(e,t);this.updateTokensAndExpiration(s,a,Number(l))}updateTokensAndExpiration(e,t,s){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,t){const{refreshToken:s,accessToken:a,expirationTime:l}=t,u=new Do;return s&&(nt(typeof s=="string","internal-error",{appName:e}),u.refreshToken=s),a&&(nt(typeof a=="string","internal-error",{appName:e}),u.accessToken=a),l&&(nt(typeof l=="number","internal-error",{appName:e}),u.expirationTime=l),u}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Do,this.toJSON())}_performRefresh(){return fi("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $i(n,e){nt(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Rs{constructor(e){var{uid:t,auth:s,stsTokenManager:a}=e,l=mp(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new zS(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=s,this.stsTokenManager=a,this.accessToken=a.accessToken,this.displayName=l.displayName||null,this.email=l.email||null,this.emailVerified=l.emailVerified||!1,this.phoneNumber=l.phoneNumber||null,this.photoURL=l.photoURL||null,this.isAnonymous=l.isAnonymous||!1,this.tenantId=l.tenantId||null,this.providerData=l.providerData?[...l.providerData]:[],this.metadata=new Vf(l.createdAt||void 0,l.lastLoginAt||void 0)}async getIdToken(e){const t=await Fo(this,this.stsTokenManager.getToken(this.auth,e));return nt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return FS(this,e)}reload(){return BS(this)}_assign(e){this!==e&&(nt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Rs(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){nt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),t&&await Ql(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Hr(this.auth.app))return Promise.reject(mi(this.auth));const e=await this.getIdToken();return await Fo(this,MS(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var s,a,l,u,f,m,y,_;const T=(s=t.displayName)!==null&&s!==void 0?s:void 0,S=(a=t.email)!==null&&a!==void 0?a:void 0,F=(l=t.phoneNumber)!==null&&l!==void 0?l:void 0,J=(u=t.photoURL)!==null&&u!==void 0?u:void 0,$=(f=t.tenantId)!==null&&f!==void 0?f:void 0,B=(m=t._redirectEventId)!==null&&m!==void 0?m:void 0,se=(y=t.createdAt)!==null&&y!==void 0?y:void 0,_e=(_=t.lastLoginAt)!==null&&_!==void 0?_:void 0,{uid:ye,emailVerified:we,isAnonymous:O,providerData:ae,stsTokenManager:I}=t;nt(ye&&I,e,"internal-error");const N=Do.fromJSON(this.name,I);nt(typeof ye=="string",e,"internal-error"),$i(T,e.name),$i(S,e.name),nt(typeof we=="boolean",e,"internal-error"),nt(typeof O=="boolean",e,"internal-error"),$i(F,e.name),$i(J,e.name),$i($,e.name),$i(B,e.name),$i(se,e.name),$i(_e,e.name);const A=new Rs({uid:ye,auth:e,email:S,emailVerified:we,displayName:T,isAnonymous:O,photoURL:J,phoneNumber:F,tenantId:$,stsTokenManager:N,createdAt:se,lastLoginAt:_e});return ae&&Array.isArray(ae)&&(A.providerData=ae.map(U=>Object.assign({},U))),B&&(A._redirectEventId=B),A}static async _fromIdTokenResponse(e,t,s=!1){const a=new Do;a.updateFromServerResponse(t);const l=new Rs({uid:t.localId,auth:e,stsTokenManager:a,isAnonymous:s});return await Ql(l),l}static async _fromGetAccountInfoResponse(e,t,s){const a=t.users[0];nt(a.localId!==void 0,"internal-error");const l=a.providerUserInfo!==void 0?o0(a.providerUserInfo):[],u=!(a.email&&a.passwordHash)&&!(l!=null&&l.length),f=new Do;f.updateFromIdToken(s);const m=new Rs({uid:a.localId,auth:e,stsTokenManager:f,isAnonymous:u}),y={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new Vf(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!(l!=null&&l.length)};return Object.assign(m,y),m}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yy=new Map;function pi(n){vi(n instanceof Function,"Expected a class definition");let e=Yy.get(n);return e?(vi(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Yy.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l0{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}l0.type="NONE";const Jy=l0;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nu(n,e,t){return`firebase:${n}:${e}:${t}`}class Vo{constructor(e,t,s){this.persistence=e,this.auth=t,this.userKey=s;const{config:a,name:l}=this.auth;this.fullUserKey=Nu(this.userKey,a.apiKey,l),this.fullPersistenceKey=Nu("persistence",a.apiKey,l),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Wu(this.auth,{idToken:e}).catch(()=>{});return t?Rs._fromGetAccountInfoResponse(this.auth,t,e):null}return Rs._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,s="authUser"){if(!t.length)return new Vo(pi(Jy),e,s);const a=(await Promise.all(t.map(async y=>{if(await y._isAvailable())return y}))).filter(y=>y);let l=a[0]||pi(Jy);const u=Nu(s,e.config.apiKey,e.name);let f=null;for(const y of t)try{const _=await y._get(u);if(_){let T;if(typeof _=="string"){const S=await Wu(e,{idToken:_}).catch(()=>{});if(!S)break;T=await Rs._fromGetAccountInfoResponse(e,S,_)}else T=Rs._fromJSON(e,_);y!==l&&(f=T),l=y;break}}catch{}const m=a.filter(y=>y._shouldAllowMigration);return!l._shouldAllowMigration||!m.length?new Vo(l,e,s):(l=m[0],f&&await l._set(u,f.toJSON()),await Promise.all(t.map(async y=>{if(y!==l)try{await y._remove(u)}catch{}})),new Vo(l,e,s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xy(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(h0(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(c0(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(p0(e))return"Blackberry";if(m0(e))return"Webos";if(u0(e))return"Safari";if((e.includes("chrome/")||d0(e))&&!e.includes("edge/"))return"Chrome";if(f0(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=n.match(t);if((s==null?void 0:s.length)===2)return s[1]}return"Other"}function c0(n=lr()){return/firefox\//i.test(n)}function u0(n=lr()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function d0(n=lr()){return/crios\//i.test(n)}function h0(n=lr()){return/iemobile/i.test(n)}function f0(n=lr()){return/android/i.test(n)}function p0(n=lr()){return/blackberry/i.test(n)}function m0(n=lr()){return/webos/i.test(n)}function xp(n=lr()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function qS(n=lr()){var e;return xp(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function HS(){return sT()&&document.documentMode===10}function g0(n=lr()){return xp(n)||f0(n)||m0(n)||p0(n)||/windows phone/i.test(n)||h0(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y0(n,e=[]){let t;switch(n){case"Browser":t=Xy(lr());break;case"Worker":t=`${Xy(lr())}-${n}`;break;default:t=n}const s=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Yo}/${s}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KS{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const s=l=>new Promise((u,f)=>{try{const m=e(l);u(m)}catch(m){f(m)}});s.onAbort=t,this.queue.push(s);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const s of this.queue)await s(e),s.onAbort&&t.push(s.onAbort)}catch(s){t.reverse();for(const a of t)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s==null?void 0:s.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function QS(n,e={}){return ei(n,"GET","/v2/passwordPolicy",da(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YS=6;class JS{constructor(e){var t,s,a,l;const u=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=u.minPasswordLength)!==null&&t!==void 0?t:YS,u.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=u.maxPasswordLength),u.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=u.containsLowercaseCharacter),u.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=u.containsUppercaseCharacter),u.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=u.containsNumericCharacter),u.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=u.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(a=(s=e.allowedNonAlphanumericCharacters)===null||s===void 0?void 0:s.join(""))!==null&&a!==void 0?a:"",this.forceUpgradeOnSignin=(l=e.forceUpgradeOnSignin)!==null&&l!==void 0?l:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,s,a,l,u,f;const m={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,m),this.validatePasswordCharacterOptions(e,m),m.isValid&&(m.isValid=(t=m.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),m.isValid&&(m.isValid=(s=m.meetsMaxPasswordLength)!==null&&s!==void 0?s:!0),m.isValid&&(m.isValid=(a=m.containsLowercaseLetter)!==null&&a!==void 0?a:!0),m.isValid&&(m.isValid=(l=m.containsUppercaseLetter)!==null&&l!==void 0?l:!0),m.isValid&&(m.isValid=(u=m.containsNumericCharacter)!==null&&u!==void 0?u:!0),m.isValid&&(m.isValid=(f=m.containsNonAlphanumericCharacter)!==null&&f!==void 0?f:!0),m}validatePasswordLengthOptions(e,t){const s=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;s&&(t.meetsMinPasswordLength=e.length>=s),a&&(t.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let s;for(let a=0;a<e.length;a++)s=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(t,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,t,s,a,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XS{constructor(e,t,s,a){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=s,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Zy(this),this.idTokenSubscription=new Zy(this),this.beforeStateQueue=new KS(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=n0,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=pi(t)),this._initializationPromise=this.queue(async()=>{var s,a,l;if(!this._deleted&&(this.persistenceManager=await Vo.create(this,e),(s=this._resolvePersistenceManagerAvailable)===null||s===void 0||s.call(this),!this._deleted)){if(!((a=this._popupRedirectResolver)===null||a===void 0)&&a._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((l=this.currentUser)===null||l===void 0?void 0:l.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Wu(this,{idToken:e}),s=await Rs._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(s)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Hr(this.app)){const u=this.app.settings.authIdToken;return u?new Promise(f=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(u).then(f,f))}):this.directlySetCurrentUser(null)}const s=await this.assertedPersistence.getCurrentUser();let a=s,l=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const u=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,f=a==null?void 0:a._redirectEventId,m=await this.tryRedirectSignIn(e);(!u||u===f)&&(m!=null&&m.user)&&(a=m.user,l=!0)}if(!a)return this.directlySetCurrentUser(null);if(!a._redirectEventId){if(l)try{await this.beforeStateQueue.runMiddleware(a)}catch(u){a=s,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(u))}return a?this.reloadAndSetCurrentUserOrClear(a):this.directlySetCurrentUser(null)}return nt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===a._redirectEventId?this.directlySetCurrentUser(a):this.reloadAndSetCurrentUserOrClear(a)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Ql(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=PS()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Hr(this.app))return Promise.reject(mi(this));const t=e?ln(e):null;return t&&nt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&nt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Hr(this.app)?Promise.reject(mi(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Hr(this.app)?Promise.reject(mi(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(pi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await QS(this),t=new JS(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new ac("auth","Firebase",e())}onAuthStateChanged(e,t,s){return this.registerStateListener(this.authStateSubscription,e,t,s)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,s){return this.registerStateListener(this.idTokenSubscription,e,t,s)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(s.tenantId=this.tenantId),await GS(this,s)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const s=await this.getOrInitRedirectPersistenceManager(t);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&pi(e)||this._popupRedirectResolver;nt(t,this,"argument-error"),this.redirectPersistenceManager=await Vo.create(this,[pi(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,s;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((s=this.redirectUser)===null||s===void 0?void 0:s._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const s=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==s&&(this.lastNotifiedUid=s,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,s,a){if(this._deleted)return()=>{};const l=typeof t=="function"?t:t.next.bind(t);let u=!1;const f=this._isInitialized?Promise.resolve():this._initializationPromise;if(nt(f,this,"internal-error"),f.then(()=>{u||l(this.currentUser)}),typeof t=="function"){const m=e.addObserver(t,s,a);return()=>{u=!0,m()}}else{const m=e.addObserver(t);return()=>{u=!0,m()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return nt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=y0(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const s=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());s&&(t["X-Firebase-Client"]=s);const a=await this._getAppCheckToken();return a&&(t["X-Firebase-AppCheck"]=a),t}async _getAppCheckToken(){var e;if(Hr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&CS(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function ha(n){return ln(n)}class Zy{constructor(e){this.auth=e,this.observer=null,this.addObserver=hT(t=>this.observer=t)}get next(){return nt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cd={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function ZS(n){cd=n}function v0(n){return cd.loadJS(n)}function eb(){return cd.recaptchaEnterpriseScript}function tb(){return cd.gapiScript}function nb(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class rb{constructor(){this.enterprise=new sb}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class sb{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const ib="recaptcha-enterprise",_0="NO_RECAPTCHA";class ab{constructor(e){this.type=ib,this.auth=ha(e)}async verify(e="verify",t=!1){async function s(l){if(!t){if(l.tenantId==null&&l._agentRecaptchaConfig!=null)return l._agentRecaptchaConfig.siteKey;if(l.tenantId!=null&&l._tenantRecaptchaConfigs[l.tenantId]!==void 0)return l._tenantRecaptchaConfigs[l.tenantId].siteKey}return new Promise(async(u,f)=>{LS(l,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(m=>{if(m.recaptchaKey===void 0)f(new Error("recaptcha Enterprise site key undefined"));else{const y=new VS(m);return l.tenantId==null?l._agentRecaptchaConfig=y:l._tenantRecaptchaConfigs[l.tenantId]=y,u(y.siteKey)}}).catch(m=>{f(m)})})}function a(l,u,f){const m=window.grecaptcha;Ky(m)?m.enterprise.ready(()=>{m.enterprise.execute(l,{action:e}).then(y=>{u(y)}).catch(()=>{u(_0)})}):f(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new rb().execute("siteKey",{action:"verify"}):new Promise((l,u)=>{s(this.auth).then(f=>{if(!t&&Ky(window.grecaptcha))a(f,l,u);else{if(typeof window>"u"){u(new Error("RecaptchaVerifier is only supported in browser"));return}let m=eb();m.length!==0&&(m+=f),v0(m).then(()=>{a(f,l,u)}).catch(y=>{u(y)})}}).catch(f=>{u(f)})})}}async function ev(n,e,t,s=!1,a=!1){const l=new ab(n);let u;if(a)u=_0;else try{u=await l.verify(t)}catch{u=await l.verify(t,!0)}const f=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in f){const m=f.phoneEnrollmentInfo.phoneNumber,y=f.phoneEnrollmentInfo.recaptchaToken;Object.assign(f,{phoneEnrollmentInfo:{phoneNumber:m,recaptchaToken:y,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in f){const m=f.phoneSignInInfo.recaptchaToken;Object.assign(f,{phoneSignInInfo:{recaptchaToken:m,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return f}return s?Object.assign(f,{captchaResp:u}):Object.assign(f,{captchaResponse:u}),Object.assign(f,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(f,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),f}async function Lf(n,e,t,s,a){var l;if(!((l=n._getRecaptchaConfig())===null||l===void 0)&&l.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const u=await ev(n,e,t,t==="getOobCode");return s(n,u)}else return s(n,e).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const f=await ev(n,e,t,t==="getOobCode");return s(n,f)}else return Promise.reject(u)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ob(n,e){const t=pp(n,"auth");if(t.isInitialized()){const a=t.getImmediate(),l=t.getOptions();if(Ba(l,e??{}))return a;ys(a,"already-initialized")}return t.initialize({options:e})}function lb(n,e){const t=(e==null?void 0:e.persistence)||[],s=(Array.isArray(t)?t:[t]).map(pi);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(s,e==null?void 0:e.popupRedirectResolver)}function cb(n,e,t){const s=ha(n);nt(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const a=!1,l=x0(e),{host:u,port:f}=ub(e),m=f===null?"":`:${f}`,y={url:`${l}//${u}${m}/`},_=Object.freeze({host:u,port:f,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!s._canInitEmulator){nt(s.config.emulator&&s.emulatorConfig,s,"emulator-config-failed"),nt(Ba(y,s.config.emulator)&&Ba(_,s.emulatorConfig),s,"emulator-config-failed");return}s.config.emulator=y,s.emulatorConfig=_,s.settings.appVerificationDisabledForTesting=!0,Qo(u)?(H_(`${l}//${u}${m}`),K_("Auth",!0)):db()}function x0(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function ub(n){const e=x0(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const s=t[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(s);if(a){const l=a[1];return{host:l,port:tv(s.substr(l.length+1))}}else{const[l,u]=s.split(":");return{host:l,port:tv(u)}}}function tv(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function db(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wp{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return fi("not implemented")}_getIdTokenResponse(e){return fi("not implemented")}_linkToIdToken(e,t){return fi("not implemented")}_getReauthenticationResolver(e){return fi("not implemented")}}async function hb(n,e){return ei(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fb(n,e){return cc(n,"POST","/v1/accounts:signInWithPassword",da(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pb(n,e){return cc(n,"POST","/v1/accounts:signInWithEmailLink",da(n,e))}async function mb(n,e){return cc(n,"POST","/v1/accounts:signInWithEmailLink",da(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yl extends wp{constructor(e,t,s,a=null){super("password",s),this._email=e,this._password=t,this._tenantId=a}static _fromEmailAndPassword(e,t){return new Yl(e,t,"password")}static _fromEmailAndCode(e,t,s=null){return new Yl(e,t,"emailLink",s)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Lf(e,t,"signInWithPassword",fb);case"emailLink":return pb(e,{email:this._email,oobCode:this._password});default:ys(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const s={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Lf(e,s,"signUpPassword",hb);case"emailLink":return mb(e,{idToken:t,email:this._email,oobCode:this._password});default:ys(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Lo(n,e){return cc(n,"POST","/v1/accounts:signInWithIdp",da(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gb="http://localhost";class _i extends wp{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new _i(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ys("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:a}=t,l=mp(t,["providerId","signInMethod"]);if(!s||!a)return null;const u=new _i(s,a);return u.idToken=l.idToken||void 0,u.accessToken=l.accessToken||void 0,u.secret=l.secret,u.nonce=l.nonce,u.pendingToken=l.pendingToken||null,u}_getIdTokenResponse(e){const t=this.buildRequest();return Lo(e,t)}_linkToIdToken(e,t){const s=this.buildRequest();return s.idToken=t,Lo(e,s)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Lo(e,t)}buildRequest(){const e={requestUri:gb,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=oc(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yb(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function vb(n){const e=kl(Dl(n)).link,t=e?kl(Dl(e)).deep_link_id:null,s=kl(Dl(n)).deep_link_id;return(s?kl(Dl(s)).link:null)||s||t||e||n}class Ep{constructor(e){var t,s,a,l,u,f;const m=kl(Dl(e)),y=(t=m.apiKey)!==null&&t!==void 0?t:null,_=(s=m.oobCode)!==null&&s!==void 0?s:null,T=yb((a=m.mode)!==null&&a!==void 0?a:null);nt(y&&_&&T,"argument-error"),this.apiKey=y,this.operation=T,this.code=_,this.continueUrl=(l=m.continueUrl)!==null&&l!==void 0?l:null,this.languageCode=(u=m.lang)!==null&&u!==void 0?u:null,this.tenantId=(f=m.tenantId)!==null&&f!==void 0?f:null}static parseLink(e){const t=vb(e);try{return new Ep(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jo{constructor(){this.providerId=Jo.PROVIDER_ID}static credential(e,t){return Yl._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const s=Ep.parseLink(t);return nt(s,"argument-error"),Yl._fromEmailAndCode(e,s.code,s.tenantId)}}Jo.PROVIDER_ID="password";Jo.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Jo.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ud{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xo extends ud{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class zl extends Xo{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return nt("providerId"in t&&"signInMethod"in t,"argument-error"),_i._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return nt(e.idToken||e.accessToken,"argument-error"),_i._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return zl.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return zl.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:s,oauthTokenSecret:a,pendingToken:l,nonce:u,providerId:f}=e;if(!s&&!a&&!t&&!l||!f)return null;try{return new zl(f)._credential({idToken:t,accessToken:s,nonce:u,pendingToken:l})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wi extends Xo{constructor(){super("facebook.com")}static credential(e){return _i._fromParams({providerId:Wi.PROVIDER_ID,signInMethod:Wi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Wi.credentialFromTaggedObject(e)}static credentialFromError(e){return Wi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Wi.credential(e.oauthAccessToken)}catch{return null}}}Wi.FACEBOOK_SIGN_IN_METHOD="facebook.com";Wi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Is extends Xo{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return _i._fromParams({providerId:Is.PROVIDER_ID,signInMethod:Is.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Is.credentialFromTaggedObject(e)}static credentialFromError(e){return Is.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:s}=e;if(!t&&!s)return null;try{return Is.credential(t,s)}catch{return null}}}Is.GOOGLE_SIGN_IN_METHOD="google.com";Is.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gi extends Xo{constructor(){super("github.com")}static credential(e){return _i._fromParams({providerId:Gi.PROVIDER_ID,signInMethod:Gi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Gi.credentialFromTaggedObject(e)}static credentialFromError(e){return Gi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Gi.credential(e.oauthAccessToken)}catch{return null}}}Gi.GITHUB_SIGN_IN_METHOD="github.com";Gi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qi extends Xo{constructor(){super("twitter.com")}static credential(e,t){return _i._fromParams({providerId:qi.PROVIDER_ID,signInMethod:qi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return qi.credentialFromTaggedObject(e)}static credentialFromError(e){return qi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:s}=e;if(!t||!s)return null;try{return qi.credential(t,s)}catch{return null}}}qi.TWITTER_SIGN_IN_METHOD="twitter.com";qi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _b(n,e){return cc(n,"POST","/v1/accounts:signUp",da(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wa{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,s,a=!1){const l=await Rs._fromIdTokenResponse(e,s,a),u=nv(s);return new Wa({user:l,providerId:u,_tokenResponse:s,operationType:t})}static async _forOperation(e,t,s){await e._updateTokensIfNecessary(s,!0);const a=nv(s);return new Wa({user:e,providerId:a,_tokenResponse:s,operationType:t})}}function nv(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gu extends Ti{constructor(e,t,s,a){var l;super(t.code,t.message),this.operationType=s,this.user=a,Object.setPrototypeOf(this,Gu.prototype),this.customData={appName:e.name,tenantId:(l=e.tenantId)!==null&&l!==void 0?l:void 0,_serverResponse:t.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,t,s,a){return new Gu(e,t,s,a)}}function w0(n,e,t,s){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?Gu._fromErrorAndOperation(n,l,e,s):l})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E0(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xb(n,e){const t=ln(n);await Eb(!0,t,e);const{providerUserInfo:s}=await OS(t.auth,{idToken:await t.getIdToken(),deleteProvider:[e]}),a=E0(s||[]);return t.providerData=t.providerData.filter(l=>a.has(l.providerId)),a.has("phone")||(t.phoneNumber=null),await t.auth._persistUserIfCurrent(t),t}async function wb(n,e,t=!1){const s=await Fo(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Wa._forOperation(n,"link",s)}async function Eb(n,e,t){await Ql(e);const s=E0(e.providerData);nt(s.has(t)===n,e.auth,"no-such-provider")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Tb(n,e,t=!1){const{auth:s}=n;if(Hr(s.app))return Promise.reject(mi(s));const a="reauthenticate";try{const l=await Fo(n,w0(s,a,e,n),t);nt(l.idToken,s,"internal-error");const u=_p(l.idToken);nt(u,s,"internal-error");const{sub:f}=u;return nt(n.uid===f,s,"user-mismatch"),Wa._forOperation(n,a,l)}catch(l){throw(l==null?void 0:l.code)==="auth/user-not-found"&&ys(s,"user-mismatch"),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function T0(n,e,t=!1){if(Hr(n.app))return Promise.reject(mi(n));const s="signIn",a=await w0(n,s,e),l=await Wa._fromIdTokenResponse(n,s,a);return t||await n._updateCurrentUser(l.user),l}async function Sb(n,e){return T0(ha(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function S0(n){const e=ha(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function bb(n,e,t){if(Hr(n.app))return Promise.reject(mi(n));const s=ha(n),u=await Lf(s,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",_b).catch(m=>{throw m.code==="auth/password-does-not-meet-requirements"&&S0(n),m}),f=await Wa._fromIdTokenResponse(s,"signIn",u);return await s._updateCurrentUser(f.user),f}function b0(n,e,t){return Hr(n.app)?Promise.reject(mi(n)):Sb(ln(n),Jo.credential(e,t)).catch(async s=>{throw s.code==="auth/password-does-not-meet-requirements"&&S0(n),s})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Cb(n,e){return ei(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ib(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const s=ln(n),l={idToken:await s.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},u=await Fo(s,Cb(s.auth,l));s.displayName=u.displayName||null,s.photoURL=u.photoUrl||null;const f=s.providerData.find(({providerId:m})=>m==="password");f&&(f.displayName=s.displayName,f.photoURL=s.photoURL),await s._updateTokensIfNecessary(u)}function Nb(n,e,t,s){return ln(n).onIdTokenChanged(e,t,s)}function Pb(n,e,t){return ln(n).beforeAuthStateChanged(e,t)}function Rb(n,e,t,s){return ln(n).onAuthStateChanged(e,t,s)}function C0(n){return ln(n).signOut()}const qu="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I0{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(qu,"1"),this.storage.removeItem(qu),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ab=1e3,jb=10;class N0 extends I0{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=g0(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const s=this.storage.getItem(t),a=this.localCache[t];s!==a&&e(t,a,s)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((u,f,m)=>{this.notifyListeners(u,m)});return}const s=e.key;t?this.detachListener():this.stopPolling();const a=()=>{const u=this.storage.getItem(s);!t&&this.localCache[s]===u||this.notifyListeners(s,u)},l=this.storage.getItem(s);HS()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,jb):a()}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const a of Array.from(s))a(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:s}),!0)})},Ab)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}N0.type="LOCAL";const kb=N0;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P0 extends I0{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}P0.type="SESSION";const R0=P0;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Db(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dd{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(a=>a.isListeningto(e));if(t)return t;const s=new dd(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:s,eventType:a,data:l}=t.data,u=this.handlersMap[a];if(!(u!=null&&u.size))return;t.ports[0].postMessage({status:"ack",eventId:s,eventType:a});const f=Array.from(u).map(async y=>y(t.origin,l)),m=await Db(f);t.ports[0].postMessage({status:"done",eventId:s,eventType:a,response:m})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}dd.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tp(n="",e=10){let t="";for(let s=0;s<e;s++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vb{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,s=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let l,u;return new Promise((f,m)=>{const y=Tp("",20);a.port1.start();const _=setTimeout(()=>{m(new Error("unsupported_event"))},s);u={messageChannel:a,onMessage(T){const S=T;if(S.data.eventId===y)switch(S.data.status){case"ack":clearTimeout(_),l=setTimeout(()=>{m(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),f(S.data.response);break;default:clearTimeout(_),clearTimeout(l),m(new Error("invalid_response"));break}}},this.handlers.add(u),a.port1.addEventListener("message",u.onMessage),this.target.postMessage({eventType:e,eventId:y,data:t},[a.port2])}).finally(()=>{u&&this.removeMessageHandler(u)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ks(){return window}function Lb(n){Ks().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A0(){return typeof Ks().WorkerGlobalScope<"u"&&typeof Ks().importScripts=="function"}async function Mb(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Ob(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function Fb(){return A0()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j0="firebaseLocalStorageDb",Ub=1,Hu="firebaseLocalStorage",k0="fbase_key";class uc{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function hd(n,e){return n.transaction([Hu],e?"readwrite":"readonly").objectStore(Hu)}function zb(){const n=indexedDB.deleteDatabase(j0);return new uc(n).toPromise()}function Mf(){const n=indexedDB.open(j0,Ub);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const s=n.result;try{s.createObjectStore(Hu,{keyPath:k0})}catch(a){t(a)}}),n.addEventListener("success",async()=>{const s=n.result;s.objectStoreNames.contains(Hu)?e(s):(s.close(),await zb(),e(await Mf()))})})}async function rv(n,e,t){const s=hd(n,!0).put({[k0]:e,value:t});return new uc(s).toPromise()}async function Bb(n,e){const t=hd(n,!1).get(e),s=await new uc(t).toPromise();return s===void 0?null:s.value}function sv(n,e){const t=hd(n,!0).delete(e);return new uc(t).toPromise()}const $b=800,Wb=3;class D0{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Mf(),this.db)}async _withRetries(e){let t=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(t++>Wb)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return A0()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=dd._getInstance(Fb()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await Mb(),!this.activeServiceWorker)return;this.sender=new Vb(this.activeServiceWorker);const s=await this.sender._send("ping",{},800);s&&!((e=s[0])===null||e===void 0)&&e.fulfilled&&!((t=s[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Ob()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Mf();return await rv(e,qu,"1"),await sv(e,qu),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(s=>rv(s,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(s=>Bb(s,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>sv(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const l=hd(a,!1).getAll();return new uc(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],s=new Set;if(e.length!==0)for(const{fbase_key:a,value:l}of e)s.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(l)&&(this.notifyListeners(a,l),t.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!s.has(a)&&(this.notifyListeners(a,null),t.push(a));return t}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const a of Array.from(s))a(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),$b)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}D0.type="LOCAL";const Gb=D0;new lc(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sp(n,e){return e?pi(e):(nt(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bp extends wp{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Lo(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Lo(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Lo(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function qb(n){return T0(n.auth,new bp(n),n.bypassAuthState)}function Hb(n){const{auth:e,user:t}=n;return nt(t,e,"internal-error"),Tb(t,new bp(n),n.bypassAuthState)}async function Kb(n){const{auth:e,user:t}=n;return nt(t,e,"internal-error"),wb(t,new bp(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V0{constructor(e,t,s,a,l=!1){this.auth=e,this.resolver=s,this.user=a,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:s,postBody:a,tenantId:l,error:u,type:f}=e;if(u){this.reject(u);return}const m={auth:this.auth,requestUri:t,sessionId:s,tenantId:l||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(f)(m))}catch(y){this.reject(y)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return qb;case"linkViaPopup":case"linkViaRedirect":return Kb;case"reauthViaPopup":case"reauthViaRedirect":return Hb;default:ys(this.auth,"internal-error")}}resolve(e){vi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){vi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qb=new lc(2e3,1e4);async function L0(n,e,t){if(Hr(n.app))return Promise.reject(As(n,"operation-not-supported-in-this-environment"));const s=ha(n);r0(n,e,ud);const a=Sp(s,t);return new Ki(s,"signInViaPopup",e,a).executeNotNull()}async function iv(n,e,t){const s=ln(n);r0(s.auth,e,ud);const a=Sp(s.auth,t);return new Ki(s.auth,"linkViaPopup",e,a,s).executeNotNull()}class Ki extends V0{constructor(e,t,s,a,l){super(e,t,a,l),this.provider=s,this.authWindow=null,this.pollId=null,Ki.currentPopupAction&&Ki.currentPopupAction.cancel(),Ki.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return nt(e,this.auth,"internal-error"),e}async onExecution(){vi(this.filter.length===1,"Popup operations only handle one event");const e=Tp();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(As(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(As(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ki.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,s;if(!((s=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||s===void 0)&&s.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(As(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Qb.get())};e()}}Ki.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yb="pendingRedirect",Pu=new Map;class Jb extends V0{constructor(e,t,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,s),this.eventId=null}async execute(){let e=Pu.get(this.auth._key());if(!e){try{const s=await Xb(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(t){e=()=>Promise.reject(t)}Pu.set(this.auth._key(),e)}return this.bypassAuthState||Pu.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Xb(n,e){const t=tC(e),s=eC(n);if(!await s._isAvailable())return!1;const a=await s._get(t)==="true";return await s._remove(t),a}function Zb(n,e){Pu.set(n._key(),e)}function eC(n){return pi(n._redirectPersistence)}function tC(n){return Nu(Yb,n.config.apiKey,n.name)}async function nC(n,e,t=!1){if(Hr(n.app))return Promise.reject(mi(n));const s=ha(n),a=Sp(s,e),u=await new Jb(s,a,t).execute();return u&&!t&&(delete u.user._redirectEventId,await s._persistUserIfCurrent(u.user),await s._setRedirectUser(null,e)),u}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rC=600*1e3;class sC{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(t=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!iC(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var s;if(e.error&&!M0(e)){const a=((s=e.error.code)===null||s===void 0?void 0:s.split("auth/")[1])||"internal-error";t.onError(As(this.auth,a))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const s=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=rC&&this.cachedEventUids.clear(),this.cachedEventUids.has(av(e))}saveEventToCache(e){this.cachedEventUids.add(av(e)),this.lastProcessedEventTime=Date.now()}}function av(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function M0({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function iC(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return M0(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aC(n,e={}){return ei(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oC=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,lC=/^https?/;async function cC(n){if(n.config.emulator)return;const{authorizedDomains:e}=await aC(n);for(const t of e)try{if(uC(t))return}catch{}ys(n,"unauthorized-domain")}function uC(n){const e=Df(),{protocol:t,hostname:s}=new URL(e);if(n.startsWith("chrome-extension://")){const u=new URL(n);return u.hostname===""&&s===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&u.hostname===s}if(!lC.test(t))return!1;if(oC.test(n))return s===n;const a=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(s)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dC=new lc(3e4,6e4);function ov(){const n=Ks().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function hC(n){return new Promise((e,t)=>{var s,a,l;function u(){ov(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{ov(),t(As(n,"network-request-failed"))},timeout:dC.get()})}if(!((a=(s=Ks().gapi)===null||s===void 0?void 0:s.iframes)===null||a===void 0)&&a.Iframe)e(gapi.iframes.getContext());else if(!((l=Ks().gapi)===null||l===void 0)&&l.load)u();else{const f=nb("iframefcb");return Ks()[f]=()=>{gapi.load?u():t(As(n,"network-request-failed"))},v0(`${tb()}?onload=${f}`).catch(m=>t(m))}}).catch(e=>{throw Ru=null,e})}let Ru=null;function fC(n){return Ru=Ru||hC(n),Ru}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pC=new lc(5e3,15e3),mC="__/auth/iframe",gC="emulator/auth/iframe",yC={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},vC=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function _C(n){const e=n.config;nt(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?vp(e,gC):`https://${n.config.authDomain}/${mC}`,s={apiKey:e.apiKey,appName:n.name,v:Yo},a=vC.get(n.config.apiHost);a&&(s.eid=a);const l=n._getFrameworks();return l.length&&(s.fw=l.join(",")),`${t}?${oc(s).slice(1)}`}async function xC(n){const e=await fC(n),t=Ks().gapi;return nt(t,n,"internal-error"),e.open({where:document.body,url:_C(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:yC,dontclear:!0},s=>new Promise(async(a,l)=>{await s.restyle({setHideOnLeave:!1});const u=As(n,"network-request-failed"),f=Ks().setTimeout(()=>{l(u)},pC.get());function m(){Ks().clearTimeout(f),a(s)}s.ping(m).then(m,()=>{l(u)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wC={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},EC=500,TC=600,SC="_blank",bC="http://localhost";class lv{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function CC(n,e,t,s=EC,a=TC){const l=Math.max((window.screen.availHeight-a)/2,0).toString(),u=Math.max((window.screen.availWidth-s)/2,0).toString();let f="";const m=Object.assign(Object.assign({},wC),{width:s.toString(),height:a.toString(),top:l,left:u}),y=lr().toLowerCase();t&&(f=d0(y)?SC:t),c0(y)&&(e=e||bC,m.scrollbars="yes");const _=Object.entries(m).reduce((S,[F,J])=>`${S}${F}=${J},`,"");if(qS(y)&&f!=="_self")return IC(e||"",f),new lv(null);const T=window.open(e||"",f,_);nt(T,n,"popup-blocked");try{T.focus()}catch{}return new lv(T)}function IC(n,e){const t=document.createElement("a");t.href=n,t.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NC="__/auth/handler",PC="emulator/auth/handler",RC=encodeURIComponent("fac");async function cv(n,e,t,s,a,l){nt(n.config.authDomain,n,"auth-domain-config-required"),nt(n.config.apiKey,n,"invalid-api-key");const u={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:s,v:Yo,eventId:a};if(e instanceof ud){e.setDefaultLanguage(n.languageCode),u.providerId=e.providerId||"",dT(e.getCustomParameters())||(u.customParameters=JSON.stringify(e.getCustomParameters()));for(const[_,T]of Object.entries({}))u[_]=T}if(e instanceof Xo){const _=e.getScopes().filter(T=>T!=="");_.length>0&&(u.scopes=_.join(","))}n.tenantId&&(u.tid=n.tenantId);const f=u;for(const _ of Object.keys(f))f[_]===void 0&&delete f[_];const m=await n._getAppCheckToken(),y=m?`#${RC}=${encodeURIComponent(m)}`:"";return`${AC(n)}?${oc(f).slice(1)}${y}`}function AC({config:n}){return n.emulator?vp(n,PC):`https://${n.authDomain}/${NC}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pf="webStorageSupport";class jC{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=R0,this._completeRedirectFn=nC,this._overrideRedirectResult=Zb}async _openPopup(e,t,s,a){var l;vi((l=this.eventManagers[e._key()])===null||l===void 0?void 0:l.manager,"_initialize() not called before _openPopup()");const u=await cv(e,t,s,Df(),a);return CC(e,u,Tp())}async _openRedirect(e,t,s,a){await this._originValidation(e);const l=await cv(e,t,s,Df(),a);return Lb(l),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:a,promise:l}=this.eventManagers[t];return a?Promise.resolve(a):(vi(l,"If manager is not set, promise should be"),l)}const s=this.initAndGetManager(e);return this.eventManagers[t]={promise:s},s.catch(()=>{delete this.eventManagers[t]}),s}async initAndGetManager(e){const t=await xC(e),s=new sC(e);return t.register("authEvent",a=>(nt(a==null?void 0:a.authEvent,e,"invalid-auth-event"),{status:s.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=t,s}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(pf,{type:pf},a=>{var l;const u=(l=a==null?void 0:a[0])===null||l===void 0?void 0:l[pf];u!==void 0&&t(!!u),ys(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=cC(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return g0()||u0()||xp()}}const kC=jC;var uv="@firebase/auth",dv="1.10.8";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DC{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(s=>{e((s==null?void 0:s.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){nt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VC(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function LC(n){Oo(new $a("auth",(e,{options:t})=>{const s=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:u,authDomain:f}=s.options;nt(u&&!u.includes(":"),"invalid-api-key",{appName:s.name});const m={apiKey:u,authDomain:f,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:y0(n)},y=new XS(s,a,l,m);return lb(y,t),y},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,s)=>{e.getProvider("auth-internal").initialize()})),Oo(new $a("auth-internal",e=>{const t=ha(e.getProvider("auth").getImmediate());return(s=>new DC(s))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Zi(uv,dv,VC(n)),Zi(uv,dv,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MC=300,OC=q_("authIdTokenMaxAge")||MC;let hv=null;const FC=n=>async e=>{const t=e&&await e.getIdTokenResult(),s=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(s&&s>OC)return;const a=t==null?void 0:t.token;hv!==a&&(hv=a,await fetch(n,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function UC(n=X_()){const e=pp(n,"auth");if(e.isInitialized())return e.getImmediate();const t=ob(n,{popupRedirectResolver:kC,persistence:[Gb,kb,R0]}),s=q_("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const l=new URL(s,location.origin);if(location.origin===l.origin){const u=FC(l.toString());Pb(t,u,()=>u(t.currentUser)),Nb(t,f=>u(f))}}const a=W_("auth");return a&&cb(t,`http://${a}`),t}function zC(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}ZS({loadJS(n){return new Promise((e,t)=>{const s=document.createElement("script");s.setAttribute("src",n),s.onload=e,s.onerror=a=>{const l=As("internal-error");l.customData=a,t(l)},s.type="text/javascript",s.charset="UTF-8",zC().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});LC("Browser");var fv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ea,O0;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(I,N){function A(){}A.prototype=N.prototype,I.D=N.prototype,I.prototype=new A,I.prototype.constructor=I,I.C=function(U,V,P){for(var C=Array(arguments.length-2),Y=2;Y<arguments.length;Y++)C[Y-2]=arguments[Y];return N.prototype[V].apply(U,C)}}function t(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(s,t),s.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(I,N,A){A||(A=0);var U=Array(16);if(typeof N=="string")for(var V=0;16>V;++V)U[V]=N.charCodeAt(A++)|N.charCodeAt(A++)<<8|N.charCodeAt(A++)<<16|N.charCodeAt(A++)<<24;else for(V=0;16>V;++V)U[V]=N[A++]|N[A++]<<8|N[A++]<<16|N[A++]<<24;N=I.g[0],A=I.g[1],V=I.g[2];var P=I.g[3],C=N+(P^A&(V^P))+U[0]+3614090360&4294967295;N=A+(C<<7&4294967295|C>>>25),C=P+(V^N&(A^V))+U[1]+3905402710&4294967295,P=N+(C<<12&4294967295|C>>>20),C=V+(A^P&(N^A))+U[2]+606105819&4294967295,V=P+(C<<17&4294967295|C>>>15),C=A+(N^V&(P^N))+U[3]+3250441966&4294967295,A=V+(C<<22&4294967295|C>>>10),C=N+(P^A&(V^P))+U[4]+4118548399&4294967295,N=A+(C<<7&4294967295|C>>>25),C=P+(V^N&(A^V))+U[5]+1200080426&4294967295,P=N+(C<<12&4294967295|C>>>20),C=V+(A^P&(N^A))+U[6]+2821735955&4294967295,V=P+(C<<17&4294967295|C>>>15),C=A+(N^V&(P^N))+U[7]+4249261313&4294967295,A=V+(C<<22&4294967295|C>>>10),C=N+(P^A&(V^P))+U[8]+1770035416&4294967295,N=A+(C<<7&4294967295|C>>>25),C=P+(V^N&(A^V))+U[9]+2336552879&4294967295,P=N+(C<<12&4294967295|C>>>20),C=V+(A^P&(N^A))+U[10]+4294925233&4294967295,V=P+(C<<17&4294967295|C>>>15),C=A+(N^V&(P^N))+U[11]+2304563134&4294967295,A=V+(C<<22&4294967295|C>>>10),C=N+(P^A&(V^P))+U[12]+1804603682&4294967295,N=A+(C<<7&4294967295|C>>>25),C=P+(V^N&(A^V))+U[13]+4254626195&4294967295,P=N+(C<<12&4294967295|C>>>20),C=V+(A^P&(N^A))+U[14]+2792965006&4294967295,V=P+(C<<17&4294967295|C>>>15),C=A+(N^V&(P^N))+U[15]+1236535329&4294967295,A=V+(C<<22&4294967295|C>>>10),C=N+(V^P&(A^V))+U[1]+4129170786&4294967295,N=A+(C<<5&4294967295|C>>>27),C=P+(A^V&(N^A))+U[6]+3225465664&4294967295,P=N+(C<<9&4294967295|C>>>23),C=V+(N^A&(P^N))+U[11]+643717713&4294967295,V=P+(C<<14&4294967295|C>>>18),C=A+(P^N&(V^P))+U[0]+3921069994&4294967295,A=V+(C<<20&4294967295|C>>>12),C=N+(V^P&(A^V))+U[5]+3593408605&4294967295,N=A+(C<<5&4294967295|C>>>27),C=P+(A^V&(N^A))+U[10]+38016083&4294967295,P=N+(C<<9&4294967295|C>>>23),C=V+(N^A&(P^N))+U[15]+3634488961&4294967295,V=P+(C<<14&4294967295|C>>>18),C=A+(P^N&(V^P))+U[4]+3889429448&4294967295,A=V+(C<<20&4294967295|C>>>12),C=N+(V^P&(A^V))+U[9]+568446438&4294967295,N=A+(C<<5&4294967295|C>>>27),C=P+(A^V&(N^A))+U[14]+3275163606&4294967295,P=N+(C<<9&4294967295|C>>>23),C=V+(N^A&(P^N))+U[3]+4107603335&4294967295,V=P+(C<<14&4294967295|C>>>18),C=A+(P^N&(V^P))+U[8]+1163531501&4294967295,A=V+(C<<20&4294967295|C>>>12),C=N+(V^P&(A^V))+U[13]+2850285829&4294967295,N=A+(C<<5&4294967295|C>>>27),C=P+(A^V&(N^A))+U[2]+4243563512&4294967295,P=N+(C<<9&4294967295|C>>>23),C=V+(N^A&(P^N))+U[7]+1735328473&4294967295,V=P+(C<<14&4294967295|C>>>18),C=A+(P^N&(V^P))+U[12]+2368359562&4294967295,A=V+(C<<20&4294967295|C>>>12),C=N+(A^V^P)+U[5]+4294588738&4294967295,N=A+(C<<4&4294967295|C>>>28),C=P+(N^A^V)+U[8]+2272392833&4294967295,P=N+(C<<11&4294967295|C>>>21),C=V+(P^N^A)+U[11]+1839030562&4294967295,V=P+(C<<16&4294967295|C>>>16),C=A+(V^P^N)+U[14]+4259657740&4294967295,A=V+(C<<23&4294967295|C>>>9),C=N+(A^V^P)+U[1]+2763975236&4294967295,N=A+(C<<4&4294967295|C>>>28),C=P+(N^A^V)+U[4]+1272893353&4294967295,P=N+(C<<11&4294967295|C>>>21),C=V+(P^N^A)+U[7]+4139469664&4294967295,V=P+(C<<16&4294967295|C>>>16),C=A+(V^P^N)+U[10]+3200236656&4294967295,A=V+(C<<23&4294967295|C>>>9),C=N+(A^V^P)+U[13]+681279174&4294967295,N=A+(C<<4&4294967295|C>>>28),C=P+(N^A^V)+U[0]+3936430074&4294967295,P=N+(C<<11&4294967295|C>>>21),C=V+(P^N^A)+U[3]+3572445317&4294967295,V=P+(C<<16&4294967295|C>>>16),C=A+(V^P^N)+U[6]+76029189&4294967295,A=V+(C<<23&4294967295|C>>>9),C=N+(A^V^P)+U[9]+3654602809&4294967295,N=A+(C<<4&4294967295|C>>>28),C=P+(N^A^V)+U[12]+3873151461&4294967295,P=N+(C<<11&4294967295|C>>>21),C=V+(P^N^A)+U[15]+530742520&4294967295,V=P+(C<<16&4294967295|C>>>16),C=A+(V^P^N)+U[2]+3299628645&4294967295,A=V+(C<<23&4294967295|C>>>9),C=N+(V^(A|~P))+U[0]+4096336452&4294967295,N=A+(C<<6&4294967295|C>>>26),C=P+(A^(N|~V))+U[7]+1126891415&4294967295,P=N+(C<<10&4294967295|C>>>22),C=V+(N^(P|~A))+U[14]+2878612391&4294967295,V=P+(C<<15&4294967295|C>>>17),C=A+(P^(V|~N))+U[5]+4237533241&4294967295,A=V+(C<<21&4294967295|C>>>11),C=N+(V^(A|~P))+U[12]+1700485571&4294967295,N=A+(C<<6&4294967295|C>>>26),C=P+(A^(N|~V))+U[3]+2399980690&4294967295,P=N+(C<<10&4294967295|C>>>22),C=V+(N^(P|~A))+U[10]+4293915773&4294967295,V=P+(C<<15&4294967295|C>>>17),C=A+(P^(V|~N))+U[1]+2240044497&4294967295,A=V+(C<<21&4294967295|C>>>11),C=N+(V^(A|~P))+U[8]+1873313359&4294967295,N=A+(C<<6&4294967295|C>>>26),C=P+(A^(N|~V))+U[15]+4264355552&4294967295,P=N+(C<<10&4294967295|C>>>22),C=V+(N^(P|~A))+U[6]+2734768916&4294967295,V=P+(C<<15&4294967295|C>>>17),C=A+(P^(V|~N))+U[13]+1309151649&4294967295,A=V+(C<<21&4294967295|C>>>11),C=N+(V^(A|~P))+U[4]+4149444226&4294967295,N=A+(C<<6&4294967295|C>>>26),C=P+(A^(N|~V))+U[11]+3174756917&4294967295,P=N+(C<<10&4294967295|C>>>22),C=V+(N^(P|~A))+U[2]+718787259&4294967295,V=P+(C<<15&4294967295|C>>>17),C=A+(P^(V|~N))+U[9]+3951481745&4294967295,I.g[0]=I.g[0]+N&4294967295,I.g[1]=I.g[1]+(V+(C<<21&4294967295|C>>>11))&4294967295,I.g[2]=I.g[2]+V&4294967295,I.g[3]=I.g[3]+P&4294967295}s.prototype.u=function(I,N){N===void 0&&(N=I.length);for(var A=N-this.blockSize,U=this.B,V=this.h,P=0;P<N;){if(V==0)for(;P<=A;)a(this,I,P),P+=this.blockSize;if(typeof I=="string"){for(;P<N;)if(U[V++]=I.charCodeAt(P++),V==this.blockSize){a(this,U),V=0;break}}else for(;P<N;)if(U[V++]=I[P++],V==this.blockSize){a(this,U),V=0;break}}this.h=V,this.o+=N},s.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var N=1;N<I.length-8;++N)I[N]=0;var A=8*this.o;for(N=I.length-8;N<I.length;++N)I[N]=A&255,A/=256;for(this.u(I),I=Array(16),N=A=0;4>N;++N)for(var U=0;32>U;U+=8)I[A++]=this.g[N]>>>U&255;return I};function l(I,N){var A=f;return Object.prototype.hasOwnProperty.call(A,I)?A[I]:A[I]=N(I)}function u(I,N){this.h=N;for(var A=[],U=!0,V=I.length-1;0<=V;V--){var P=I[V]|0;U&&P==N||(A[V]=P,U=!1)}this.g=A}var f={};function m(I){return-128<=I&&128>I?l(I,function(N){return new u([N|0],0>N?-1:0)}):new u([I|0],0>I?-1:0)}function y(I){if(isNaN(I)||!isFinite(I))return T;if(0>I)return B(y(-I));for(var N=[],A=1,U=0;I>=A;U++)N[U]=I/A|0,A*=4294967296;return new u(N,0)}function _(I,N){if(I.length==0)throw Error("number format error: empty string");if(N=N||10,2>N||36<N)throw Error("radix out of range: "+N);if(I.charAt(0)=="-")return B(_(I.substring(1),N));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var A=y(Math.pow(N,8)),U=T,V=0;V<I.length;V+=8){var P=Math.min(8,I.length-V),C=parseInt(I.substring(V,V+P),N);8>P?(P=y(Math.pow(N,P)),U=U.j(P).add(y(C))):(U=U.j(A),U=U.add(y(C)))}return U}var T=m(0),S=m(1),F=m(16777216);n=u.prototype,n.m=function(){if($(this))return-B(this).m();for(var I=0,N=1,A=0;A<this.g.length;A++){var U=this.i(A);I+=(0<=U?U:4294967296+U)*N,N*=4294967296}return I},n.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(J(this))return"0";if($(this))return"-"+B(this).toString(I);for(var N=y(Math.pow(I,6)),A=this,U="";;){var V=we(A,N).g;A=se(A,V.j(N));var P=((0<A.g.length?A.g[0]:A.h)>>>0).toString(I);if(A=V,J(A))return P+U;for(;6>P.length;)P="0"+P;U=P+U}},n.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function J(I){if(I.h!=0)return!1;for(var N=0;N<I.g.length;N++)if(I.g[N]!=0)return!1;return!0}function $(I){return I.h==-1}n.l=function(I){return I=se(this,I),$(I)?-1:J(I)?0:1};function B(I){for(var N=I.g.length,A=[],U=0;U<N;U++)A[U]=~I.g[U];return new u(A,~I.h).add(S)}n.abs=function(){return $(this)?B(this):this},n.add=function(I){for(var N=Math.max(this.g.length,I.g.length),A=[],U=0,V=0;V<=N;V++){var P=U+(this.i(V)&65535)+(I.i(V)&65535),C=(P>>>16)+(this.i(V)>>>16)+(I.i(V)>>>16);U=C>>>16,P&=65535,C&=65535,A[V]=C<<16|P}return new u(A,A[A.length-1]&-2147483648?-1:0)};function se(I,N){return I.add(B(N))}n.j=function(I){if(J(this)||J(I))return T;if($(this))return $(I)?B(this).j(B(I)):B(B(this).j(I));if($(I))return B(this.j(B(I)));if(0>this.l(F)&&0>I.l(F))return y(this.m()*I.m());for(var N=this.g.length+I.g.length,A=[],U=0;U<2*N;U++)A[U]=0;for(U=0;U<this.g.length;U++)for(var V=0;V<I.g.length;V++){var P=this.i(U)>>>16,C=this.i(U)&65535,Y=I.i(V)>>>16,ie=I.i(V)&65535;A[2*U+2*V]+=C*ie,_e(A,2*U+2*V),A[2*U+2*V+1]+=P*ie,_e(A,2*U+2*V+1),A[2*U+2*V+1]+=C*Y,_e(A,2*U+2*V+1),A[2*U+2*V+2]+=P*Y,_e(A,2*U+2*V+2)}for(U=0;U<N;U++)A[U]=A[2*U+1]<<16|A[2*U];for(U=N;U<2*N;U++)A[U]=0;return new u(A,0)};function _e(I,N){for(;(I[N]&65535)!=I[N];)I[N+1]+=I[N]>>>16,I[N]&=65535,N++}function ye(I,N){this.g=I,this.h=N}function we(I,N){if(J(N))throw Error("division by zero");if(J(I))return new ye(T,T);if($(I))return N=we(B(I),N),new ye(B(N.g),B(N.h));if($(N))return N=we(I,B(N)),new ye(B(N.g),N.h);if(30<I.g.length){if($(I)||$(N))throw Error("slowDivide_ only works with positive integers.");for(var A=S,U=N;0>=U.l(I);)A=O(A),U=O(U);var V=ae(A,1),P=ae(U,1);for(U=ae(U,2),A=ae(A,2);!J(U);){var C=P.add(U);0>=C.l(I)&&(V=V.add(A),P=C),U=ae(U,1),A=ae(A,1)}return N=se(I,V.j(N)),new ye(V,N)}for(V=T;0<=I.l(N);){for(A=Math.max(1,Math.floor(I.m()/N.m())),U=Math.ceil(Math.log(A)/Math.LN2),U=48>=U?1:Math.pow(2,U-48),P=y(A),C=P.j(N);$(C)||0<C.l(I);)A-=U,P=y(A),C=P.j(N);J(P)&&(P=S),V=V.add(P),I=se(I,C)}return new ye(V,I)}n.A=function(I){return we(this,I).h},n.and=function(I){for(var N=Math.max(this.g.length,I.g.length),A=[],U=0;U<N;U++)A[U]=this.i(U)&I.i(U);return new u(A,this.h&I.h)},n.or=function(I){for(var N=Math.max(this.g.length,I.g.length),A=[],U=0;U<N;U++)A[U]=this.i(U)|I.i(U);return new u(A,this.h|I.h)},n.xor=function(I){for(var N=Math.max(this.g.length,I.g.length),A=[],U=0;U<N;U++)A[U]=this.i(U)^I.i(U);return new u(A,this.h^I.h)};function O(I){for(var N=I.g.length+1,A=[],U=0;U<N;U++)A[U]=I.i(U)<<1|I.i(U-1)>>>31;return new u(A,I.h)}function ae(I,N){var A=N>>5;N%=32;for(var U=I.g.length-A,V=[],P=0;P<U;P++)V[P]=0<N?I.i(P+A)>>>N|I.i(P+A+1)<<32-N:I.i(P+A);return new u(V,I.h)}s.prototype.digest=s.prototype.v,s.prototype.reset=s.prototype.s,s.prototype.update=s.prototype.u,O0=s,u.prototype.add=u.prototype.add,u.prototype.multiply=u.prototype.j,u.prototype.modulo=u.prototype.A,u.prototype.compare=u.prototype.l,u.prototype.toNumber=u.prototype.m,u.prototype.toString=u.prototype.toString,u.prototype.getBits=u.prototype.i,u.fromNumber=y,u.fromString=_,ea=u}).apply(typeof fv<"u"?fv:typeof self<"u"?self:typeof window<"u"?window:{});var xu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var F0,Vl,U0,Au,Of,z0,B0,$0;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(d,g,x){return d==Array.prototype||d==Object.prototype||(d[g]=x.value),d};function t(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof xu=="object"&&xu];for(var g=0;g<d.length;++g){var x=d[g];if(x&&x.Math==Math)return x}throw Error("Cannot find global object")}var s=t(this);function a(d,g){if(g)e:{var x=s;d=d.split(".");for(var R=0;R<d.length-1;R++){var Z=d[R];if(!(Z in x))break e;x=x[Z]}d=d[d.length-1],R=x[d],g=g(R),g!=R&&g!=null&&e(x,d,{configurable:!0,writable:!0,value:g})}}function l(d,g){d instanceof String&&(d+="");var x=0,R=!1,Z={next:function(){if(!R&&x<d.length){var le=x++;return{value:g(le,d[le]),done:!1}}return R=!0,{done:!0,value:void 0}}};return Z[Symbol.iterator]=function(){return Z},Z}a("Array.prototype.values",function(d){return d||function(){return l(this,function(g,x){return x})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var u=u||{},f=this||self;function m(d){var g=typeof d;return g=g!="object"?g:d?Array.isArray(d)?"array":g:"null",g=="array"||g=="object"&&typeof d.length=="number"}function y(d){var g=typeof d;return g=="object"&&d!=null||g=="function"}function _(d,g,x){return d.call.apply(d.bind,arguments)}function T(d,g,x){if(!d)throw Error();if(2<arguments.length){var R=Array.prototype.slice.call(arguments,2);return function(){var Z=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Z,R),d.apply(g,Z)}}return function(){return d.apply(g,arguments)}}function S(d,g,x){return S=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?_:T,S.apply(null,arguments)}function F(d,g){var x=Array.prototype.slice.call(arguments,1);return function(){var R=x.slice();return R.push.apply(R,arguments),d.apply(this,R)}}function J(d,g){function x(){}x.prototype=g.prototype,d.aa=g.prototype,d.prototype=new x,d.prototype.constructor=d,d.Qb=function(R,Z,le){for(var Me=Array(arguments.length-2),kt=2;kt<arguments.length;kt++)Me[kt-2]=arguments[kt];return g.prototype[Z].apply(R,Me)}}function $(d){const g=d.length;if(0<g){const x=Array(g);for(let R=0;R<g;R++)x[R]=d[R];return x}return[]}function B(d,g){for(let x=1;x<arguments.length;x++){const R=arguments[x];if(m(R)){const Z=d.length||0,le=R.length||0;d.length=Z+le;for(let Me=0;Me<le;Me++)d[Z+Me]=R[Me]}else d.push(R)}}class se{constructor(g,x){this.i=g,this.j=x,this.h=0,this.g=null}get(){let g;return 0<this.h?(this.h--,g=this.g,this.g=g.next,g.next=null):g=this.i(),g}}function _e(d){return/^[\s\xa0]*$/.test(d)}function ye(){var d=f.navigator;return d&&(d=d.userAgent)?d:""}function we(d){return we[" "](d),d}we[" "]=function(){};var O=ye().indexOf("Gecko")!=-1&&!(ye().toLowerCase().indexOf("webkit")!=-1&&ye().indexOf("Edge")==-1)&&!(ye().indexOf("Trident")!=-1||ye().indexOf("MSIE")!=-1)&&ye().indexOf("Edge")==-1;function ae(d,g,x){for(const R in d)g.call(x,d[R],R,d)}function I(d,g){for(const x in d)g.call(void 0,d[x],x,d)}function N(d){const g={};for(const x in d)g[x]=d[x];return g}const A="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function U(d,g){let x,R;for(let Z=1;Z<arguments.length;Z++){R=arguments[Z];for(x in R)d[x]=R[x];for(let le=0;le<A.length;le++)x=A[le],Object.prototype.hasOwnProperty.call(R,x)&&(d[x]=R[x])}}function V(d){var g=1;d=d.split(":");const x=[];for(;0<g&&d.length;)x.push(d.shift()),g--;return d.length&&x.push(d.join(":")),x}function P(d){f.setTimeout(()=>{throw d},0)}function C(){var d=Re;let g=null;return d.g&&(g=d.g,d.g=d.g.next,d.g||(d.h=null),g.next=null),g}class Y{constructor(){this.h=this.g=null}add(g,x){const R=ie.get();R.set(g,x),this.h?this.h.next=R:this.g=R,this.h=R}}var ie=new se(()=>new Ce,d=>d.reset());class Ce{constructor(){this.next=this.g=this.h=null}set(g,x){this.h=g,this.g=x,this.next=null}reset(){this.next=this.g=this.h=null}}let fe,ce=!1,Re=new Y,Ee=()=>{const d=f.Promise.resolve(void 0);fe=()=>{d.then(Q)}};var Q=()=>{for(var d;d=C();){try{d.h.call(d.g)}catch(x){P(x)}var g=ie;g.j(d),100>g.h&&(g.h++,d.next=g.g,g.g=d)}ce=!1};function k(){this.s=this.s,this.C=this.C}k.prototype.s=!1,k.prototype.ma=function(){this.s||(this.s=!0,this.N())},k.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function H(d,g){this.type=d,this.g=this.target=g,this.defaultPrevented=!1}H.prototype.h=function(){this.defaultPrevented=!0};var be=(function(){if(!f.addEventListener||!Object.defineProperty)return!1;var d=!1,g=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const x=()=>{};f.addEventListener("test",x,g),f.removeEventListener("test",x,g)}catch{}return d})();function Le(d,g){if(H.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d){var x=this.type=d.type,R=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;if(this.target=d.target||d.srcElement,this.g=g,g=d.relatedTarget){if(O){e:{try{we(g.nodeName);var Z=!0;break e}catch{}Z=!1}Z||(g=null)}}else x=="mouseover"?g=d.fromElement:x=="mouseout"&&(g=d.toElement);this.relatedTarget=g,R?(this.clientX=R.clientX!==void 0?R.clientX:R.pageX,this.clientY=R.clientY!==void 0?R.clientY:R.pageY,this.screenX=R.screenX||0,this.screenY=R.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=typeof d.pointerType=="string"?d.pointerType:Ve[d.pointerType]||"",this.state=d.state,this.i=d,d.defaultPrevented&&Le.aa.h.call(this)}}J(Le,H);var Ve={2:"touch",3:"pen",4:"mouse"};Le.prototype.h=function(){Le.aa.h.call(this);var d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var Fe="closure_listenable_"+(1e6*Math.random()|0),Qe=0;function st(d,g,x,R,Z){this.listener=d,this.proxy=null,this.src=g,this.type=x,this.capture=!!R,this.ha=Z,this.key=++Qe,this.da=this.fa=!1}function ve(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function ue(d){this.src=d,this.g={},this.h=0}ue.prototype.add=function(d,g,x,R,Z){var le=d.toString();d=this.g[le],d||(d=this.g[le]=[],this.h++);var Me=ge(d,g,R,Z);return-1<Me?(g=d[Me],x||(g.fa=!1)):(g=new st(g,this.src,le,!!R,Z),g.fa=x,d.push(g)),g};function Oe(d,g){var x=g.type;if(x in d.g){var R=d.g[x],Z=Array.prototype.indexOf.call(R,g,void 0),le;(le=0<=Z)&&Array.prototype.splice.call(R,Z,1),le&&(ve(g),d.g[x].length==0&&(delete d.g[x],d.h--))}}function ge(d,g,x,R){for(var Z=0;Z<d.length;++Z){var le=d[Z];if(!le.da&&le.listener==g&&le.capture==!!x&&le.ha==R)return Z}return-1}var qe="closure_lm_"+(1e6*Math.random()|0),Ye={};function Et(d,g,x,R,Z){if(Array.isArray(g)){for(var le=0;le<g.length;le++)Et(d,g[le],x,R,Z);return null}return x=kn(x),d&&d[Fe]?d.K(g,x,y(R)?!!R.capture:!1,Z):Nt(d,g,x,!1,R,Z)}function Nt(d,g,x,R,Z,le){if(!g)throw Error("Invalid event type");var Me=y(Z)?!!Z.capture:!!Z,kt=cr(d);if(kt||(d[qe]=kt=new ue(d)),x=kt.add(g,x,R,Me,le),x.proxy)return x;if(R=At(),x.proxy=R,R.src=d,R.listener=x,d.addEventListener)be||(Z=Me),Z===void 0&&(Z=!1),d.addEventListener(g.toString(),R,Z);else if(d.attachEvent)d.attachEvent(Kt(g.toString()),R);else if(d.addListener&&d.removeListener)d.addListener(R);else throw Error("addEventListener and attachEvent are unavailable.");return x}function At(){function d(x){return g.call(d.src,d.listener,x)}const g=yr;return d}function It(d,g,x,R,Z){if(Array.isArray(g))for(var le=0;le<g.length;le++)It(d,g[le],x,R,Z);else R=y(R)?!!R.capture:!!R,x=kn(x),d&&d[Fe]?(d=d.i,g=String(g).toString(),g in d.g&&(le=d.g[g],x=ge(le,x,R,Z),-1<x&&(ve(le[x]),Array.prototype.splice.call(le,x,1),le.length==0&&(delete d.g[g],d.h--)))):d&&(d=cr(d))&&(g=d.g[g.toString()],d=-1,g&&(d=ge(g,x,R,Z)),(x=-1<d?g[d]:null)&&cn(x))}function cn(d){if(typeof d!="number"&&d&&!d.da){var g=d.src;if(g&&g[Fe])Oe(g.i,d);else{var x=d.type,R=d.proxy;g.removeEventListener?g.removeEventListener(x,R,d.capture):g.detachEvent?g.detachEvent(Kt(x),R):g.addListener&&g.removeListener&&g.removeListener(R),(x=cr(g))?(Oe(x,d),x.h==0&&(x.src=null,g[qe]=null)):ve(d)}}}function Kt(d){return d in Ye?Ye[d]:Ye[d]="on"+d}function yr(d,g){if(d.da)d=!0;else{g=new Le(g,this);var x=d.listener,R=d.ha||d.src;d.fa&&cn(d),d=x.call(R,g)}return d}function cr(d){return d=d[qe],d instanceof ue?d:null}var un="__closure_events_fn_"+(1e9*Math.random()>>>0);function kn(d){return typeof d=="function"?d:(d[un]||(d[un]=function(g){return d.handleEvent(g)}),d[un])}function Mt(){k.call(this),this.i=new ue(this),this.M=this,this.F=null}J(Mt,k),Mt.prototype[Fe]=!0,Mt.prototype.removeEventListener=function(d,g,x,R){It(this,d,g,x,R)};function Dt(d,g){var x,R=d.F;if(R)for(x=[];R;R=R.F)x.push(R);if(d=d.M,R=g.type||g,typeof g=="string")g=new H(g,d);else if(g instanceof H)g.target=g.target||d;else{var Z=g;g=new H(R,d),U(g,Z)}if(Z=!0,x)for(var le=x.length-1;0<=le;le--){var Me=g.g=x[le];Z=Xn(Me,R,!0,g)&&Z}if(Me=g.g=d,Z=Xn(Me,R,!0,g)&&Z,Z=Xn(Me,R,!1,g)&&Z,x)for(le=0;le<x.length;le++)Me=g.g=x[le],Z=Xn(Me,R,!1,g)&&Z}Mt.prototype.N=function(){if(Mt.aa.N.call(this),this.i){var d=this.i,g;for(g in d.g){for(var x=d.g[g],R=0;R<x.length;R++)ve(x[R]);delete d.g[g],d.h--}}this.F=null},Mt.prototype.K=function(d,g,x,R){return this.i.add(String(d),g,!1,x,R)},Mt.prototype.L=function(d,g,x,R){return this.i.add(String(d),g,!0,x,R)};function Xn(d,g,x,R){if(g=d.i.g[String(g)],!g)return!0;g=g.concat();for(var Z=!0,le=0;le<g.length;++le){var Me=g[le];if(Me&&!Me.da&&Me.capture==x){var kt=Me.listener,Nn=Me.ha||Me.src;Me.fa&&Oe(d.i,Me),Z=kt.call(Nn,R)!==!1&&Z}}return Z&&!R.defaultPrevented}function ur(d,g,x){if(typeof d=="function")x&&(d=S(d,x));else if(d&&typeof d.handleEvent=="function")d=S(d.handleEvent,d);else throw Error("Invalid listener argument");return 2147483647<Number(g)?-1:f.setTimeout(d,g||0)}function vr(d){d.g=ur(()=>{d.g=null,d.i&&(d.i=!1,vr(d))},d.l);const g=d.h;d.h=null,d.m.apply(null,g)}class Zn extends k{constructor(g,x){super(),this.m=g,this.l=x,this.h=null,this.i=!1,this.g=null}j(g){this.h=arguments,this.g?this.i=!0:vr(this)}N(){super.N(),this.g&&(f.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Sn(d){k.call(this),this.h=d,this.g={}}J(Sn,k);var Dr=[];function Qr(d){ae(d.g,function(g,x){this.g.hasOwnProperty(x)&&cn(g)},d),d.g={}}Sn.prototype.N=function(){Sn.aa.N.call(this),Qr(this)},Sn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Yr=f.JSON.stringify,vs=f.JSON.parse,er=class{stringify(d){return f.JSON.stringify(d,void 0)}parse(d){return f.JSON.parse(d,void 0)}};function Zt(){}Zt.prototype.h=null;function dn(d){return d.h||(d.h=d.i())}function Jr(){}var ht={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Dn(){H.call(this,"d")}J(Dn,H);function Xr(){H.call(this,"c")}J(Xr,H);var _r={},Vr=null;function Lr(){return Vr=Vr||new Mt}_r.La="serverreachability";function Ds(d){H.call(this,_r.La,d)}J(Ds,H);function gn(d){const g=Lr();Dt(g,new Ds(g))}_r.STAT_EVENT="statevent";function Vs(d,g){H.call(this,_r.STAT_EVENT,d),this.stat=g}J(Vs,H);function zt(d){const g=Lr();Dt(g,new Vs(g,d))}_r.Ma="timingevent";function Zr(d,g){H.call(this,_r.Ma,d),this.size=g}J(Zr,H);function Vn(d,g){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return f.setTimeout(function(){d()},g)}function Tt(){this.g=!0}Tt.prototype.xa=function(){this.g=!1};function _s(d,g,x,R,Z,le){d.info(function(){if(d.g)if(le)for(var Me="",kt=le.split("&"),Nn=0;Nn<kt.length;Nn++){var xt=kt[Nn].split("=");if(1<xt.length){var On=xt[0];xt=xt[1];var _n=On.split("_");Me=2<=_n.length&&_n[1]=="type"?Me+(On+"="+xt+"&"):Me+(On+"=redacted&")}}else Me=null;else Me=le;return"XMLHTTP REQ ("+R+") [attempt "+Z+"]: "+g+`
`+x+`
`+Me})}function xr(d,g,x,R,Z,le,Me){d.info(function(){return"XMLHTTP RESP ("+R+") [ attempt "+Z+"]: "+g+`
`+x+`
`+le+" "+Me})}function dr(d,g,x,R){d.info(function(){return"XMLHTTP TEXT ("+g+"): "+Ja(d,x)+(R?" "+R:"")})}function Ls(d,g){d.info(function(){return"TIMEOUT: "+g})}Tt.prototype.info=function(){};function Ja(d,g){if(!d.g)return g;if(!g)return null;try{var x=JSON.parse(g);if(x){for(d=0;d<x.length;d++)if(Array.isArray(x[d])){var R=x[d];if(!(2>R.length)){var Z=R[1];if(Array.isArray(Z)&&!(1>Z.length)){var le=Z[0];if(le!="noop"&&le!="stop"&&le!="close")for(var Me=1;Me<Z.length;Me++)Z[Me]=""}}}}return Yr(x)}catch{return g}}var en={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},wr={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},yn;function $n(){}J($n,Zt),$n.prototype.g=function(){return new XMLHttpRequest},$n.prototype.i=function(){return{}},yn=new $n;function Qt(d,g,x,R){this.j=d,this.i=g,this.l=x,this.R=R||1,this.U=new Sn(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new vn}function vn(){this.i=null,this.g="",this.h=!1}var es={},Ln={};function xs(d,g,x){d.L=1,d.v=ts(Je(g)),d.m=x,d.P=!0,Ms(d,null)}function Ms(d,g){d.F=Date.now(),pt(d),d.A=Je(d.v);var x=d.A,R=d.R;Array.isArray(R)||(R=[String(R)]),Us(x.i,"t",R),d.C=0,x=d.j.J,d.h=new vn,d.g=Tc(d.j,x?g:null,!d.m),0<d.O&&(d.M=new Zn(S(d.Y,d,d.g),d.O)),g=d.U,x=d.g,R=d.ca;var Z="readystatechange";Array.isArray(Z)||(Z&&(Dr[0]=Z.toString()),Z=Dr);for(var le=0;le<Z.length;le++){var Me=Et(x,Z[le],R||g.handleEvent,!1,g.h||g);if(!Me)break;g.g[Me.key]=Me}g=d.H?N(d.H):{},d.m?(d.u||(d.u="POST"),g["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.A,d.u,d.m,g)):(d.u="GET",d.g.ea(d.A,d.u,null,g)),gn(),_s(d.i,d.u,d.A,d.l,d.R,d.m)}Qt.prototype.ca=function(d){d=d.target;const g=this.M;g&&Ot(d)==3?g.j():this.Y(d)},Qt.prototype.Y=function(d){try{if(d==this.g)e:{const _n=Ot(this.g);var g=this.g.Ba();const is=this.g.Z();if(!(3>_n)&&(_n!=3||this.g&&(this.h.h||this.g.oa()||zr(this.g)))){this.J||_n!=4||g==7||(g==8||0>=is?gn(3):gn(2)),hr(this);var x=this.g.Z();this.X=x;t:if(ti(this)){var R=zr(this.g);d="";var Z=R.length,le=Ot(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){nn(this),tn(this);var Me="";break t}this.h.i=new f.TextDecoder}for(g=0;g<Z;g++)this.h.h=!0,d+=this.h.i.decode(R[g],{stream:!(le&&g==Z-1)});R.length=0,this.h.g+=d,this.C=0,Me=this.h.g}else Me=this.g.oa();if(this.o=x==200,xr(this.i,this.u,this.A,this.l,this.R,_n,x),this.o){if(this.T&&!this.K){t:{if(this.g){var kt,Nn=this.g;if((kt=Nn.g?Nn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!_e(kt)){var xt=kt;break t}}xt=null}if(x=xt)dr(this.i,this.l,x,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Mn(this,x);else{this.o=!1,this.s=3,zt(12),nn(this),tn(this);break e}}if(this.P){x=!0;let $r;for(;!this.J&&this.C<Me.length;)if($r=ni(this,Me),$r==Ln){_n==4&&(this.s=4,zt(14),x=!1),dr(this.i,this.l,null,"[Incomplete Response]");break}else if($r==es){this.s=4,zt(15),dr(this.i,this.l,Me,"[Invalid Chunk]"),x=!1;break}else dr(this.i,this.l,$r,null),Mn(this,$r);if(ti(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),_n!=4||Me.length!=0||this.h.h||(this.s=1,zt(16),x=!1),this.o=this.o&&x,!x)dr(this.i,this.l,Me,"[Invalid Chunked Response]"),nn(this),tn(this);else if(0<Me.length&&!this.W){this.W=!0;var On=this.j;On.g==this&&On.ba&&!On.M&&(On.j.info("Great, no buffering proxy detected. Bytes received: "+Me.length),il(On),On.M=!0,zt(11))}}else dr(this.i,this.l,Me,null),Mn(this,Me);_n==4&&nn(this),this.o&&!this.J&&(_n==4?ro(this.j,this):(this.o=!1,pt(this)))}else zs(this.g),x==400&&0<Me.indexOf("Unknown SID")?(this.s=3,zt(12)):(this.s=0,zt(13)),nn(this),tn(this)}}}catch{}finally{}};function ti(d){return d.g?d.u=="GET"&&d.L!=2&&d.j.Ca:!1}function ni(d,g){var x=d.C,R=g.indexOf(`
`,x);return R==-1?Ln:(x=Number(g.substring(x,R)),isNaN(x)?es:(R+=1,R+x>g.length?Ln:(g=g.slice(R,R+x),d.C=R+x,g)))}Qt.prototype.cancel=function(){this.J=!0,nn(this)};function pt(d){d.S=Date.now()+d.I,bi(d,d.I)}function bi(d,g){if(d.B!=null)throw Error("WatchDog timer not null");d.B=Vn(S(d.ba,d),g)}function hr(d){d.B&&(f.clearTimeout(d.B),d.B=null)}Qt.prototype.ba=function(){this.B=null;const d=Date.now();0<=d-this.S?(Ls(this.i,this.A),this.L!=2&&(gn(),zt(17)),nn(this),this.s=2,tn(this)):bi(this,this.S-d)};function tn(d){d.j.G==0||d.J||ro(d.j,d)}function nn(d){hr(d);var g=d.M;g&&typeof g.ma=="function"&&g.ma(),d.M=null,Qr(d.U),d.g&&(g=d.g,d.g=null,g.abort(),g.ma())}function Mn(d,g){try{var x=d.j;if(x.G!=0&&(x.g==d||L(x.h,d))){if(!d.K&&L(x.h,d)&&x.G==3){try{var R=x.Da.g.parse(g)}catch{R=null}if(Array.isArray(R)&&R.length==3){var Z=R;if(Z[0]==0){e:if(!x.u){if(x.g)if(x.g.F+3e3<d.F)no(x),Br(x);else break e;to(x),zt(18)}}else x.za=Z[1],0<x.za-x.T&&37500>Z[2]&&x.F&&x.v==0&&!x.C&&(x.C=Vn(S(x.Za,x),6e3));if(1>=q(x.h)&&x.ca){try{x.ca()}catch{}x.ca=void 0}}else si(x,11)}else if((d.K||x.g==d)&&no(x),!_e(g))for(Z=x.Da.g.parse(g),g=0;g<Z.length;g++){let xt=Z[g];if(x.T=xt[0],xt=xt[1],x.G==2)if(xt[0]=="c"){x.K=xt[1],x.ia=xt[2];const On=xt[3];On!=null&&(x.la=On,x.j.info("VER="+x.la));const _n=xt[4];_n!=null&&(x.Aa=_n,x.j.info("SVER="+x.Aa));const is=xt[5];is!=null&&typeof is=="number"&&0<is&&(R=1.5*is,x.L=R,x.j.info("backChannelRequestTimeoutMs_="+R)),R=x;const $r=d.g;if($r){const _a=$r.g?$r.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(_a){var le=R.h;le.g||_a.indexOf("spdy")==-1&&_a.indexOf("quic")==-1&&_a.indexOf("h2")==-1||(le.j=le.l,le.g=new Set,le.h&&(ee(le,le.h),le.h=null))}if(R.D){const io=$r.g?$r.g.getResponseHeader("X-HTTP-Session-Id"):null;io&&(R.ya=io,_t(R.I,R.D,io))}}x.G=3,x.l&&x.l.ua(),x.ba&&(x.R=Date.now()-d.F,x.j.info("Handshake RTT: "+x.R+"ms")),R=x;var Me=d;if(R.qa=Ec(R,R.J?R.ia:null,R.W),Me.K){X(R.h,Me);var kt=Me,Nn=R.L;Nn&&(kt.I=Nn),kt.B&&(hr(kt),pt(kt)),R.g=Me}else va(R);0<x.i.length&&ss(x)}else xt[0]!="stop"&&xt[0]!="close"||si(x,7);else x.G==3&&(xt[0]=="stop"||xt[0]=="close"?xt[0]=="stop"?si(x,7):In(x):xt[0]!="noop"&&x.l&&x.l.ta(xt),x.v=0)}}gn(4)}catch{}}var Wn=class{constructor(d,g){this.g=d,this.map=g}};function w(d){this.l=d||10,f.PerformanceNavigationTiming?(d=f.performance.getEntriesByType("navigation"),d=0<d.length&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(f.chrome&&f.chrome.loadTimes&&f.chrome.loadTimes()&&f.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function D(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function q(d){return d.h?1:d.g?d.g.size:0}function L(d,g){return d.h?d.h==g:d.g?d.g.has(g):!1}function ee(d,g){d.g?d.g.add(g):d.h=g}function X(d,g){d.h&&d.h==g?d.h=null:d.g&&d.g.has(g)&&d.g.delete(g)}w.prototype.cancel=function(){if(this.i=ne(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function ne(d){if(d.h!=null)return d.i.concat(d.h.D);if(d.g!=null&&d.g.size!==0){let g=d.i;for(const x of d.g.values())g=g.concat(x.D);return g}return $(d.i)}function Ae(d){if(d.V&&typeof d.V=="function")return d.V();if(typeof Map<"u"&&d instanceof Map||typeof Set<"u"&&d instanceof Set)return Array.from(d.values());if(typeof d=="string")return d.split("");if(m(d)){for(var g=[],x=d.length,R=0;R<x;R++)g.push(d[R]);return g}g=[],x=0;for(R in d)g[x++]=d[R];return g}function me(d){if(d.na&&typeof d.na=="function")return d.na();if(!d.V||typeof d.V!="function"){if(typeof Map<"u"&&d instanceof Map)return Array.from(d.keys());if(!(typeof Set<"u"&&d instanceof Set)){if(m(d)||typeof d=="string"){var g=[];d=d.length;for(var x=0;x<d;x++)g.push(x);return g}g=[],x=0;for(const R in d)g[x++]=R;return g}}}function De(d,g){if(d.forEach&&typeof d.forEach=="function")d.forEach(g,void 0);else if(m(d)||typeof d=="string")Array.prototype.forEach.call(d,g,void 0);else for(var x=me(d),R=Ae(d),Z=R.length,le=0;le<Z;le++)g.call(void 0,R[le],x&&x[le],d)}var de=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ot(d,g){if(d){d=d.split("&");for(var x=0;x<d.length;x++){var R=d[x].indexOf("="),Z=null;if(0<=R){var le=d[x].substring(0,R);Z=d[x].substring(R+1)}else le=d[x];g(le,Z?decodeURIComponent(Z.replace(/\+/g," ")):"")}}}function Pe(d){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,d instanceof Pe){this.h=d.h,rn(this,d.j),this.o=d.o,this.g=d.g,sn(this,d.s),this.l=d.l;var g=d.i,x=new Or;x.i=g.i,g.g&&(x.g=new Map(g.g),x.h=g.h),Er(this,x),this.m=d.m}else d&&(g=String(d).match(de))?(this.h=!1,rn(this,g[1]||"",!0),this.o=gt(g[2]||""),this.g=gt(g[3]||"",!0),sn(this,g[4]),this.l=gt(g[5]||"",!0),Er(this,g[6]||"",!0),this.m=gt(g[7]||"")):(this.h=!1,this.i=new Or(null,this.h))}Pe.prototype.toString=function(){var d=[],g=this.j;g&&d.push(Os(g,jt,!0),":");var x=this.g;return(x||g=="file")&&(d.push("//"),(g=this.o)&&d.push(Os(g,jt,!0),"@"),d.push(encodeURIComponent(String(x)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),x=this.s,x!=null&&d.push(":",String(x))),(x=this.l)&&(this.g&&x.charAt(0)!="/"&&d.push("/"),d.push(Os(x,x.charAt(0)=="/"?Mr:Fs,!0))),(x=this.i.toString())&&d.push("?",x),(x=this.m)&&d.push("#",Os(x,Ci)),d.join("")};function Je(d){return new Pe(d)}function rn(d,g,x){d.j=x?gt(g,!0):g,d.j&&(d.j=d.j.replace(/:$/,""))}function sn(d,g){if(g){if(g=Number(g),isNaN(g)||0>g)throw Error("Bad port number "+g);d.s=g}else d.s=null}function Er(d,g,x){g instanceof Or?(d.i=g,Fr(d.i,d.h)):(x||(g=Os(g,ga)),d.i=new Or(g,d.h))}function _t(d,g,x){d.i.set(g,x)}function ts(d){return _t(d,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),d}function gt(d,g){return d?g?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function Os(d,g,x){return typeof d=="string"?(d=encodeURI(d).replace(g,ma),x&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function ma(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var jt=/[#\/\?@]/g,Fs=/[#\?:]/g,Mr=/[#\?]/g,ga=/[#\?@]/g,Ci=/#/g;function Or(d,g){this.h=this.g=null,this.i=d||null,this.j=!!g}function bn(d){d.g||(d.g=new Map,d.h=0,d.i&&ot(d.i,function(g,x){d.add(decodeURIComponent(g.replace(/\+/g," ")),x)}))}n=Or.prototype,n.add=function(d,g){bn(this),this.i=null,d=fr(this,d);var x=this.g.get(d);return x||this.g.set(d,x=[]),x.push(g),this.h+=1,this};function Cn(d,g){bn(d),g=fr(d,g),d.g.has(g)&&(d.i=null,d.h-=d.g.get(g).length,d.g.delete(g))}function Tr(d,g){return bn(d),g=fr(d,g),d.g.has(g)}n.forEach=function(d,g){bn(this),this.g.forEach(function(x,R){x.forEach(function(Z){d.call(g,Z,R,this)},this)},this)},n.na=function(){bn(this);const d=Array.from(this.g.values()),g=Array.from(this.g.keys()),x=[];for(let R=0;R<g.length;R++){const Z=d[R];for(let le=0;le<Z.length;le++)x.push(g[R])}return x},n.V=function(d){bn(this);let g=[];if(typeof d=="string")Tr(this,d)&&(g=g.concat(this.g.get(fr(this,d))));else{d=Array.from(this.g.values());for(let x=0;x<d.length;x++)g=g.concat(d[x])}return g},n.set=function(d,g){return bn(this),this.i=null,d=fr(this,d),Tr(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[g]),this.h+=1,this},n.get=function(d,g){return d?(d=this.V(d),0<d.length?String(d[0]):g):g};function Us(d,g,x){Cn(d,g),0<x.length&&(d.i=null,d.g.set(fr(d,g),$(x)),d.h+=x.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],g=Array.from(this.g.keys());for(var x=0;x<g.length;x++){var R=g[x];const le=encodeURIComponent(String(R)),Me=this.V(R);for(R=0;R<Me.length;R++){var Z=le;Me[R]!==""&&(Z+="="+encodeURIComponent(String(Me[R]))),d.push(Z)}}return this.i=d.join("&")};function fr(d,g){return g=String(g),d.j&&(g=g.toLowerCase()),g}function Fr(d,g){g&&!d.j&&(bn(d),d.i=null,d.g.forEach(function(x,R){var Z=R.toLowerCase();R!=Z&&(Cn(this,R),Us(this,Z,x))},d)),d.j=g}function Xa(d,g){const x=new Tt;if(f.Image){const R=new Image;R.onload=F(Gn,x,"TestLoadImage: loaded",!0,g,R),R.onerror=F(Gn,x,"TestLoadImage: error",!1,g,R),R.onabort=F(Gn,x,"TestLoadImage: abort",!1,g,R),R.ontimeout=F(Gn,x,"TestLoadImage: timeout",!1,g,R),f.setTimeout(function(){R.ontimeout&&R.ontimeout()},1e4),R.src=d}else g(!1)}function Za(d,g){const x=new Tt,R=new AbortController,Z=setTimeout(()=>{R.abort(),Gn(x,"TestPingServer: timeout",!1,g)},1e4);fetch(d,{signal:R.signal}).then(le=>{clearTimeout(Z),le.ok?Gn(x,"TestPingServer: ok",!0,g):Gn(x,"TestPingServer: server error",!1,g)}).catch(()=>{clearTimeout(Z),Gn(x,"TestPingServer: error",!1,g)})}function Gn(d,g,x,R,Z){try{Z&&(Z.onload=null,Z.onerror=null,Z.onabort=null,Z.ontimeout=null),R(x)}catch{}}function sl(){this.g=new er}function E(d,g,x){const R=x||"";try{De(d,function(Z,le){let Me=Z;y(Z)&&(Me=Yr(Z)),g.push(R+le+"="+encodeURIComponent(Me))})}catch(Z){throw g.push(R+"type="+encodeURIComponent("_badmap")),Z}}function z(d){this.l=d.Ub||null,this.j=d.eb||!1}J(z,Zt),z.prototype.g=function(){return new W(this.l,this.j)},z.prototype.i=(function(d){return function(){return d}})({});function W(d,g){Mt.call(this),this.D=d,this.o=g,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}J(W,Mt),n=W.prototype,n.open=function(d,g){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=d,this.A=g,this.readyState=1,$e(this)},n.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const g={headers:this.u,method:this.B,credentials:this.m,cache:void 0};d&&(g.body=d),(this.D||f).fetch(new Request(this.A,g)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Te(this)),this.readyState=0},n.Sa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,$e(this)),this.g&&(this.readyState=3,$e(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof f.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;he(this)}else d.text().then(this.Ra.bind(this),this.ga.bind(this))};function he(d){d.j.read().then(d.Pa.bind(d)).catch(d.ga.bind(d))}n.Pa=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var g=d.value?d.value:new Uint8Array(0);(g=this.v.decode(g,{stream:!d.done}))&&(this.response=this.responseText+=g)}d.done?Te(this):$e(this),this.readyState==3&&he(this)}},n.Ra=function(d){this.g&&(this.response=this.responseText=d,Te(this))},n.Qa=function(d){this.g&&(this.response=d,Te(this))},n.ga=function(){this.g&&Te(this)};function Te(d){d.readyState=4,d.l=null,d.j=null,d.v=null,$e(d)}n.setRequestHeader=function(d,g){this.u.append(d,g)},n.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],g=this.h.entries();for(var x=g.next();!x.done;)x=x.value,d.push(x[0]+": "+x[1]),x=g.next();return d.join(`\r
`)};function $e(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(W.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function je(d){let g="";return ae(d,function(x,R){g+=R,g+=":",g+=x,g+=`\r
`}),g}function lt(d,g,x){e:{for(R in x){var R=!1;break e}R=!0}R||(x=je(x),typeof d=="string"?x!=null&&encodeURIComponent(String(x)):_t(d,g,x))}function Ze(d){Mt.call(this),this.headers=new Map,this.o=d||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}J(Ze,Mt);var Vt=/^https?$/i,Bt=["POST","PUT"];n=Ze.prototype,n.Ha=function(d){this.J=d},n.ea=function(d,g,x,R){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);g=g?g.toUpperCase():"GET",this.D=d,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():yn.g(),this.v=this.o?dn(this.o):dn(yn),this.g.onreadystatechange=S(this.Ea,this);try{this.B=!0,this.g.open(g,String(d),!0),this.B=!1}catch(le){Lt(this,le);return}if(d=x||"",x=new Map(this.headers),R)if(Object.getPrototypeOf(R)===Object.prototype)for(var Z in R)x.set(Z,R[Z]);else if(typeof R.keys=="function"&&typeof R.get=="function")for(const le of R.keys())x.set(le,R.get(le));else throw Error("Unknown input type for opt_headers: "+String(R));R=Array.from(x.keys()).find(le=>le.toLowerCase()=="content-type"),Z=f.FormData&&d instanceof f.FormData,!(0<=Array.prototype.indexOf.call(Bt,g,void 0))||R||Z||x.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[le,Me]of x)this.g.setRequestHeader(le,Me);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Ur(this),this.u=!0,this.g.send(d),this.u=!1}catch(le){Lt(this,le)}};function Lt(d,g){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=g,d.m=5,qn(d),dt(d)}function qn(d){d.A||(d.A=!0,Dt(d,"complete"),Dt(d,"error"))}n.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=d||7,Dt(this,"complete"),Dt(this,"abort"),dt(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),dt(this,!0)),Ze.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?hn(this):this.bb())},n.bb=function(){hn(this)};function hn(d){if(d.h&&typeof u<"u"&&(!d.v[1]||Ot(d)!=4||d.Z()!=2)){if(d.u&&Ot(d)==4)ur(d.Ea,0,d);else if(Dt(d,"readystatechange"),Ot(d)==4){d.h=!1;try{const Me=d.Z();e:switch(Me){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var g=!0;break e;default:g=!1}var x;if(!(x=g)){var R;if(R=Me===0){var Z=String(d.D).match(de)[1]||null;!Z&&f.self&&f.self.location&&(Z=f.self.location.protocol.slice(0,-1)),R=!Vt.test(Z?Z.toLowerCase():"")}x=R}if(x)Dt(d,"complete"),Dt(d,"success");else{d.m=6;try{var le=2<Ot(d)?d.g.statusText:""}catch{le=""}d.l=le+" ["+d.Z()+"]",qn(d)}}finally{dt(d)}}}}function dt(d,g){if(d.g){Ur(d);const x=d.g,R=d.v[0]?()=>{}:null;d.g=null,d.v=null,g||Dt(d,"ready");try{x.onreadystatechange=R}catch{}}}function Ur(d){d.I&&(f.clearTimeout(d.I),d.I=null)}n.isActive=function(){return!!this.g};function Ot(d){return d.g?d.g.readyState:0}n.Z=function(){try{return 2<Ot(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(d){if(this.g){var g=this.g.responseText;return d&&g.indexOf(d)==0&&(g=g.substring(d.length)),vs(g)}};function zr(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.H){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function zs(d){const g={};d=(d.g&&2<=Ot(d)&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let R=0;R<d.length;R++){if(_e(d[R]))continue;var x=V(d[R]);const Z=x[0];if(x=x[1],typeof x!="string")continue;x=x.trim();const le=g[Z]||[];g[Z]=le,le.push(x)}I(g,function(R){return R.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ns(d,g,x){return x&&x.internalChannelParams&&x.internalChannelParams[d]||g}function ya(d){this.Aa=0,this.i=[],this.j=new Tt,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ns("failFast",!1,d),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ns("baseRetryDelayMs",5e3,d),this.cb=ns("retryDelaySeedMs",1e4,d),this.Wa=ns("forwardChannelMaxRetries",2,d),this.wa=ns("forwardChannelRequestTimeoutMs",2e4,d),this.pa=d&&d.xmlHttpFactory||void 0,this.Xa=d&&d.Tb||void 0,this.Ca=d&&d.useFetchStreams||!1,this.L=void 0,this.J=d&&d.supportsCrossDomainXhr||!1,this.K="",this.h=new w(d&&d.concurrentRequestLimit),this.Da=new sl,this.P=d&&d.fastHandshake||!1,this.O=d&&d.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=d&&d.Rb||!1,d&&d.xa&&this.j.xa(),d&&d.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&d&&d.detectBufferingProxy||!1,this.ja=void 0,d&&d.longPollingTimeout&&0<d.longPollingTimeout&&(this.ja=d.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=ya.prototype,n.la=8,n.G=1,n.connect=function(d,g,x,R){zt(0),this.W=d,this.H=g||{},x&&R!==void 0&&(this.H.OSID=x,this.H.OAID=R),this.F=this.X,this.I=Ec(this,null,this.W),ss(this)};function In(d){if(rs(d),d.G==3){var g=d.U++,x=Je(d.I);if(_t(x,"SID",d.K),_t(x,"RID",g),_t(x,"TYPE","terminate"),ri(d,x),g=new Qt(d,d.j,g),g.L=2,g.v=ts(Je(x)),x=!1,f.navigator&&f.navigator.sendBeacon)try{x=f.navigator.sendBeacon(g.v.toString(),"")}catch{}!x&&f.Image&&(new Image().src=g.v,x=!0),x||(g.g=Tc(g.j,null),g.g.ea(g.v)),g.F=Date.now(),pt(g)}wc(d)}function Br(d){d.g&&(il(d),d.g.cancel(),d.g=null)}function rs(d){Br(d),d.u&&(f.clearTimeout(d.u),d.u=null),no(d),d.h.cancel(),d.s&&(typeof d.s=="number"&&f.clearTimeout(d.s),d.s=null)}function ss(d){if(!D(d.h)&&!d.s){d.s=!0;var g=d.Ga;fe||Ee(),ce||(fe(),ce=!0),Re.add(g,d),d.B=0}}function Vd(d,g){return q(d.h)>=d.h.j-(d.s?1:0)?!1:d.s?(d.i=g.D.concat(d.i),!0):d.G==1||d.G==2||d.B>=(d.Va?0:d.Wa)?!1:(d.s=Vn(S(d.Ga,d,g),xc(d,d.B)),d.B++,!0)}n.Ga=function(d){if(this.s)if(this.s=null,this.G==1){if(!d){this.U=Math.floor(1e5*Math.random()),d=this.U++;const Z=new Qt(this,this.j,d);let le=this.o;if(this.S&&(le?(le=N(le),U(le,this.S)):le=this.S),this.m!==null||this.O||(Z.H=le,le=null),this.P)e:{for(var g=0,x=0;x<this.i.length;x++){t:{var R=this.i[x];if("__data__"in R.map&&(R=R.map.__data__,typeof R=="string")){R=R.length;break t}R=void 0}if(R===void 0)break;if(g+=R,4096<g){g=x;break e}if(g===4096||x===this.i.length-1){g=x+1;break e}}g=1e3}else g=1e3;g=Ii(this,Z,g),x=Je(this.I),_t(x,"RID",d),_t(x,"CVER",22),this.D&&_t(x,"X-HTTP-Session-Id",this.D),ri(this,x),le&&(this.O?g="headers="+encodeURIComponent(String(je(le)))+"&"+g:this.m&&lt(x,this.m,le)),ee(this.h,Z),this.Ua&&_t(x,"TYPE","init"),this.P?(_t(x,"$req",g),_t(x,"SID","null"),Z.T=!0,xs(Z,x,null)):xs(Z,x,g),this.G=2}}else this.G==3&&(d?eo(this,d):this.i.length==0||D(this.h)||eo(this))};function eo(d,g){var x;g?x=g.l:x=d.U++;const R=Je(d.I);_t(R,"SID",d.K),_t(R,"RID",x),_t(R,"AID",d.T),ri(d,R),d.m&&d.o&&lt(R,d.m,d.o),x=new Qt(d,d.j,x,d.B+1),d.m===null&&(x.H=d.o),g&&(d.i=g.D.concat(d.i)),g=Ii(d,x,1e3),x.I=Math.round(.5*d.wa)+Math.round(.5*d.wa*Math.random()),ee(d.h,x),xs(x,R,g)}function ri(d,g){d.H&&ae(d.H,function(x,R){_t(g,R,x)}),d.l&&De({},function(x,R){_t(g,R,x)})}function Ii(d,g,x){x=Math.min(d.i.length,x);var R=d.l?S(d.l.Na,d.l,d):null;e:{var Z=d.i;let le=-1;for(;;){const Me=["count="+x];le==-1?0<x?(le=Z[0].g,Me.push("ofs="+le)):le=0:Me.push("ofs="+le);let kt=!0;for(let Nn=0;Nn<x;Nn++){let xt=Z[Nn].g;const On=Z[Nn].map;if(xt-=le,0>xt)le=Math.max(0,Z[Nn].g-100),kt=!1;else try{E(On,Me,"req"+xt+"_")}catch{R&&R(On)}}if(kt){R=Me.join("&");break e}}}return d=d.i.splice(0,x),g.D=d,R}function va(d){if(!d.g&&!d.u){d.Y=1;var g=d.Fa;fe||Ee(),ce||(fe(),ce=!0),Re.add(g,d),d.v=0}}function to(d){return d.g||d.u||3<=d.v?!1:(d.Y++,d.u=Vn(S(d.Fa,d),xc(d,d.v)),d.v++,!0)}n.Fa=function(){if(this.u=null,_c(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var d=2*this.R;this.j.info("BP detection timer enabled: "+d),this.A=Vn(S(this.ab,this),d)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,zt(10),Br(this),_c(this))};function il(d){d.A!=null&&(f.clearTimeout(d.A),d.A=null)}function _c(d){d.g=new Qt(d,d.j,"rpc",d.Y),d.m===null&&(d.g.H=d.o),d.g.O=0;var g=Je(d.qa);_t(g,"RID","rpc"),_t(g,"SID",d.K),_t(g,"AID",d.T),_t(g,"CI",d.F?"0":"1"),!d.F&&d.ja&&_t(g,"TO",d.ja),_t(g,"TYPE","xmlhttp"),ri(d,g),d.m&&d.o&&lt(g,d.m,d.o),d.L&&(d.g.I=d.L);var x=d.g;d=d.ia,x.L=1,x.v=ts(Je(g)),x.m=null,x.P=!0,Ms(x,d)}n.Za=function(){this.C!=null&&(this.C=null,Br(this),to(this),zt(19))};function no(d){d.C!=null&&(f.clearTimeout(d.C),d.C=null)}function ro(d,g){var x=null;if(d.g==g){no(d),il(d),d.g=null;var R=2}else if(L(d.h,g))x=g.D,X(d.h,g),R=1;else return;if(d.G!=0){if(g.o)if(R==1){x=g.m?g.m.length:0,g=Date.now()-g.F;var Z=d.B;R=Lr(),Dt(R,new Zr(R,x)),ss(d)}else va(d);else if(Z=g.s,Z==3||Z==0&&0<g.X||!(R==1&&Vd(d,g)||R==2&&to(d)))switch(x&&0<x.length&&(g=d.h,g.i=g.i.concat(x)),Z){case 1:si(d,5);break;case 4:si(d,10);break;case 3:si(d,6);break;default:si(d,2)}}}function xc(d,g){let x=d.Ta+Math.floor(Math.random()*d.cb);return d.isActive()||(x*=2),x*g}function si(d,g){if(d.j.info("Error code "+g),g==2){var x=S(d.fb,d),R=d.Xa;const Z=!R;R=new Pe(R||"//www.google.com/images/cleardot.gif"),f.location&&f.location.protocol=="http"||rn(R,"https"),ts(R),Z?Xa(R.toString(),x):Za(R.toString(),x)}else zt(2);d.G=0,d.l&&d.l.sa(g),wc(d),rs(d)}n.fb=function(d){d?(this.j.info("Successfully pinged google.com"),zt(2)):(this.j.info("Failed to ping google.com"),zt(1))};function wc(d){if(d.G=0,d.ka=[],d.l){const g=ne(d.h);(g.length!=0||d.i.length!=0)&&(B(d.ka,g),B(d.ka,d.i),d.h.i.length=0,$(d.i),d.i.length=0),d.l.ra()}}function Ec(d,g,x){var R=x instanceof Pe?Je(x):new Pe(x);if(R.g!="")g&&(R.g=g+"."+R.g),sn(R,R.s);else{var Z=f.location;R=Z.protocol,g=g?g+"."+Z.hostname:Z.hostname,Z=+Z.port;var le=new Pe(null);R&&rn(le,R),g&&(le.g=g),Z&&sn(le,Z),x&&(le.l=x),R=le}return x=d.D,g=d.ya,x&&g&&_t(R,x,g),_t(R,"VER",d.la),ri(d,R),R}function Tc(d,g,x){if(g&&!d.J)throw Error("Can't create secondary domain capable XhrIo object.");return g=d.Ca&&!d.pa?new Ze(new z({eb:x})):new Ze(d.pa),g.Ha(d.J),g}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function al(){}n=al.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function so(){}so.prototype.g=function(d,g){return new pr(d,g)};function pr(d,g){Mt.call(this),this.g=new ya(g),this.l=d,this.h=g&&g.messageUrlParams||null,d=g&&g.messageHeaders||null,g&&g.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=g&&g.initMessageHeaders||null,g&&g.messageContentType&&(d?d["X-WebChannel-Content-Type"]=g.messageContentType:d={"X-WebChannel-Content-Type":g.messageContentType}),g&&g.va&&(d?d["X-WebChannel-Client-Profile"]=g.va:d={"X-WebChannel-Client-Profile":g.va}),this.g.S=d,(d=g&&g.Sb)&&!_e(d)&&(this.g.m=d),this.v=g&&g.supportsCrossDomainXhr||!1,this.u=g&&g.sendRawJson||!1,(g=g&&g.httpSessionIdParam)&&!_e(g)&&(this.g.D=g,d=this.h,d!==null&&g in d&&(d=this.h,g in d&&delete d[g])),this.j=new Bs(this)}J(pr,Mt),pr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},pr.prototype.close=function(){In(this.g)},pr.prototype.o=function(d){var g=this.g;if(typeof d=="string"){var x={};x.__data__=d,d=x}else this.u&&(x={},x.__data__=Yr(d),d=x);g.i.push(new Wn(g.Ya++,d)),g.G==3&&ss(g)},pr.prototype.N=function(){this.g.l=null,delete this.j,In(this.g),delete this.g,pr.aa.N.call(this)};function Sc(d){Dn.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var g=d.__sm__;if(g){e:{for(const x in g){d=x;break e}d=void 0}(this.i=d)&&(d=this.i,g=g!==null&&d in g?g[d]:void 0),this.data=g}else this.data=d}J(Sc,Dn);function bc(){Xr.call(this),this.status=1}J(bc,Xr);function Bs(d){this.g=d}J(Bs,al),Bs.prototype.ua=function(){Dt(this.g,"a")},Bs.prototype.ta=function(d){Dt(this.g,new Sc(d))},Bs.prototype.sa=function(d){Dt(this.g,new bc)},Bs.prototype.ra=function(){Dt(this.g,"b")},so.prototype.createWebChannel=so.prototype.g,pr.prototype.send=pr.prototype.o,pr.prototype.open=pr.prototype.m,pr.prototype.close=pr.prototype.close,$0=function(){return new so},B0=function(){return Lr()},z0=_r,Of={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},en.NO_ERROR=0,en.TIMEOUT=8,en.HTTP_ERROR=6,Au=en,wr.COMPLETE="complete",U0=wr,Jr.EventType=ht,ht.OPEN="a",ht.CLOSE="b",ht.ERROR="c",ht.MESSAGE="d",Mt.prototype.listen=Mt.prototype.K,Vl=Jr,Ze.prototype.listenOnce=Ze.prototype.L,Ze.prototype.getLastError=Ze.prototype.Ka,Ze.prototype.getLastErrorCode=Ze.prototype.Ba,Ze.prototype.getStatus=Ze.prototype.Z,Ze.prototype.getResponseJson=Ze.prototype.Oa,Ze.prototype.getResponseText=Ze.prototype.oa,Ze.prototype.send=Ze.prototype.ea,Ze.prototype.setWithCredentials=Ze.prototype.Ha,F0=Ze}).apply(typeof xu<"u"?xu:typeof self<"u"?self:typeof window<"u"?window:{});const pv="@firebase/firestore",mv="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ar{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ar.UNAUTHENTICATED=new ar(null),ar.GOOGLE_CREDENTIALS=new ar("google-credentials-uid"),ar.FIRST_PARTY=new ar("first-party-uid"),ar.MOCK_USER=new ar("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zo="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ga=new hp("@firebase/firestore");function Ro(){return Ga.logLevel}function Be(n,...e){if(Ga.logLevel<=yt.DEBUG){const t=e.map(Cp);Ga.debug(`Firestore (${Zo}): ${n}`,...t)}}function xi(n,...e){if(Ga.logLevel<=yt.ERROR){const t=e.map(Cp);Ga.error(`Firestore (${Zo}): ${n}`,...t)}}function na(n,...e){if(Ga.logLevel<=yt.WARN){const t=e.map(Cp);Ga.warn(`Firestore (${Zo}): ${n}`,...t)}}function Cp(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function it(n,e,t){let s="Unexpected state";typeof e=="string"?s=e:t=e,W0(n,s,t)}function W0(n,e,t){let s=`FIRESTORE (${Zo}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{s+=" CONTEXT: "+JSON.stringify(t)}catch{s+=" CONTEXT: "+t}throw xi(s),new Error(s)}function Rt(n,e,t,s){let a="Unexpected state";typeof t=="string"?a=t:s=t,n||W0(e,a,s)}function ut(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ue extends Ti{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gi{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G0{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class BC{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(ar.UNAUTHENTICATED)))}shutdown(){}}class $C{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class WC{constructor(e){this.t=e,this.currentUser=ar.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Rt(this.o===void 0,42304);let s=this.i;const a=m=>this.i!==s?(s=this.i,t(m)):Promise.resolve();let l=new gi;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new gi,e.enqueueRetryable((()=>a(this.currentUser)))};const u=()=>{const m=l;e.enqueueRetryable((async()=>{await m.promise,await a(this.currentUser)}))},f=m=>{Be("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=m,this.o&&(this.auth.addAuthTokenListener(this.o),u())};this.t.onInit((m=>f(m))),setTimeout((()=>{if(!this.auth){const m=this.t.getImmediate({optional:!0});m?f(m):(Be("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new gi)}}),0),u()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((s=>this.i!==e?(Be("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(Rt(typeof s.accessToken=="string",31837,{l:s}),new G0(s.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Rt(e===null||typeof e=="string",2055,{h:e}),new ar(e)}}class GC{constructor(e,t,s){this.P=e,this.T=t,this.I=s,this.type="FirstParty",this.user=ar.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class qC{constructor(e,t,s){this.P=e,this.T=t,this.I=s}getToken(){return Promise.resolve(new GC(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(ar.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class gv{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class HC{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Hr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Rt(this.o===void 0,3512);const s=l=>{l.error!=null&&Be("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const u=l.token!==this.m;return this.m=l.token,Be("FirebaseAppCheckTokenProvider",`Received ${u?"new":"existing"} token.`),u?t(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable((()=>s(l)))};const a=l=>{Be("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((l=>a(l))),setTimeout((()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?a(l):Be("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new gv(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Rt(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new gv(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KC(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let s=0;s<n;s++)t[s]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q0(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ip{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let s="";for(;s.length<20;){const a=KC(40);for(let l=0;l<a.length;++l)s.length<20&&a[l]<t&&(s+=e.charAt(a[l]%62))}return s}}function ft(n,e){return n<e?-1:n>e?1:0}function Ff(n,e){let t=0;for(;t<n.length&&t<e.length;){const s=n.codePointAt(t),a=e.codePointAt(t);if(s!==a){if(s<128&&a<128)return ft(s,a);{const l=q0(),u=QC(l.encode(yv(n,t)),l.encode(yv(e,t)));return u!==0?u:ft(s,a)}}t+=s>65535?2:1}return ft(n.length,e.length)}function yv(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function QC(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return ft(n[t],e[t]);return ft(n.length,e.length)}function Uo(n,e,t){return n.length===e.length&&n.every(((s,a)=>t(s,e[a])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vv="__name__";class Hs{constructor(e,t,s){t===void 0?t=0:t>e.length&&it(637,{offset:t,range:e.length}),s===void 0?s=e.length-t:s>e.length-t&&it(1746,{length:s,range:e.length-t}),this.segments=e,this.offset=t,this.len=s}get length(){return this.len}isEqual(e){return Hs.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Hs?e.forEach((s=>{t.push(s)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,s=this.limit();t<s;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const s=Math.min(e.length,t.length);for(let a=0;a<s;a++){const l=Hs.compareSegments(e.get(a),t.get(a));if(l!==0)return l}return ft(e.length,t.length)}static compareSegments(e,t){const s=Hs.isNumericId(e),a=Hs.isNumericId(t);return s&&!a?-1:!s&&a?1:s&&a?Hs.extractNumericId(e).compare(Hs.extractNumericId(t)):Ff(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ea.fromString(e.substring(4,e.length-2))}}class Ut extends Hs{construct(e,t,s){return new Ut(e,t,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const s of e){if(s.indexOf("//")>=0)throw new Ue(pe.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);t.push(...s.split("/").filter((a=>a.length>0)))}return new Ut(t)}static emptyPath(){return new Ut([])}}const YC=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Yn extends Hs{construct(e,t,s){return new Yn(e,t,s)}static isValidIdentifier(e){return YC.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Yn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===vv}static keyField(){return new Yn([vv])}static fromServerFormat(e){const t=[];let s="",a=0;const l=()=>{if(s.length===0)throw new Ue(pe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(s),s=""};let u=!1;for(;a<e.length;){const f=e[a];if(f==="\\"){if(a+1===e.length)throw new Ue(pe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const m=e[a+1];if(m!=="\\"&&m!=="."&&m!=="`")throw new Ue(pe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=m,a+=2}else f==="`"?(u=!u,a++):f!=="."||u?(s+=f,a++):(l(),a++)}if(l(),u)throw new Ue(pe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Yn(t)}static emptyPath(){return new Yn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xe{constructor(e){this.path=e}static fromPath(e){return new Xe(Ut.fromString(e))}static fromName(e){return new Xe(Ut.fromString(e).popFirst(5))}static empty(){return new Xe(Ut.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ut.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Ut.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Xe(new Ut(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H0(n,e,t){if(!t)throw new Ue(pe.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function JC(n,e,t,s){if(e===!0&&s===!0)throw new Ue(pe.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function _v(n){if(!Xe.isDocumentKey(n))throw new Ue(pe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function xv(n){if(Xe.isDocumentKey(n))throw new Ue(pe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function K0(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function fd(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(s){return s.constructor?s.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":it(12329,{type:typeof n})}function kr(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Ue(pe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=fd(n);throw new Ue(pe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tn(n,e){const t={typeString:n};return e&&(t.value=e),t}function dc(n,e){if(!K0(n))throw new Ue(pe.INVALID_ARGUMENT,"JSON must be an object");let t;for(const s in e)if(e[s]){const a=e[s].typeString,l="value"in e[s]?{value:e[s].value}:void 0;if(!(s in n)){t=`JSON missing required field: '${s}'`;break}const u=n[s];if(a&&typeof u!==a){t=`JSON field '${s}' must be a ${a}.`;break}if(l!==void 0&&u!==l.value){t=`Expected '${s}' field to equal '${l.value}'`;break}}if(t)throw new Ue(pe.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wv=-62135596800,Ev=1e6;class Gt{static now(){return Gt.fromMillis(Date.now())}static fromDate(e){return Gt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),s=Math.floor((e-1e3*t)*Ev);return new Gt(t,s)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ue(pe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ue(pe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<wv)throw new Ue(pe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ue(pe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Ev}_compareTo(e){return this.seconds===e.seconds?ft(this.nanoseconds,e.nanoseconds):ft(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Gt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(dc(e,Gt._jsonSchema))return new Gt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-wv;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Gt._jsonSchemaVersion="firestore/timestamp/1.0",Gt._jsonSchema={type:Tn("string",Gt._jsonSchemaVersion),seconds:Tn("number"),nanoseconds:Tn("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ct{static fromTimestamp(e){return new ct(e)}static min(){return new ct(new Gt(0,0))}static max(){return new ct(new Gt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jl=-1;function XC(n,e){const t=n.toTimestamp().seconds,s=n.toTimestamp().nanoseconds+1,a=ct.fromTimestamp(s===1e9?new Gt(t+1,0):new Gt(t,s));return new ra(a,Xe.empty(),e)}function ZC(n){return new ra(n.readTime,n.key,Jl)}class ra{constructor(e,t,s){this.readTime=e,this.documentKey=t,this.largestBatchId=s}static min(){return new ra(ct.min(),Xe.empty(),Jl)}static max(){return new ra(ct.max(),Xe.empty(),Jl)}}function eI(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Xe.comparator(n.documentKey,e.documentKey),t!==0?t:ft(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tI="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class nI{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function el(n){if(n.code!==pe.FAILED_PRECONDITION||n.message!==tI)throw n;Be("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&it(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new xe(((s,a)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(s,a)},this.catchCallback=l=>{this.wrapFailure(t,l).next(s,a)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof xe?t:xe.resolve(t)}catch(t){return xe.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):xe.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):xe.reject(t)}static resolve(e){return new xe(((t,s)=>{t(e)}))}static reject(e){return new xe(((t,s)=>{s(e)}))}static waitFor(e){return new xe(((t,s)=>{let a=0,l=0,u=!1;e.forEach((f=>{++a,f.next((()=>{++l,u&&l===a&&t()}),(m=>s(m)))})),u=!0,l===a&&t()}))}static or(e){let t=xe.resolve(!1);for(const s of e)t=t.next((a=>a?xe.resolve(a):s()));return t}static forEach(e,t){const s=[];return e.forEach(((a,l)=>{s.push(t.call(this,a,l))})),this.waitFor(s)}static mapArray(e,t){return new xe(((s,a)=>{const l=e.length,u=new Array(l);let f=0;for(let m=0;m<l;m++){const y=m;t(e[y]).next((_=>{u[y]=_,++f,f===l&&s(u)}),(_=>a(_)))}}))}static doWhile(e,t){return new xe(((s,a)=>{const l=()=>{e()===!0?t().next((()=>{l()}),a):s()};l()}))}}function rI(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function tl(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pd{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=s=>this._e(s),this.ae=s=>t.writeSequenceNumber(s))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}}pd.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Np=-1;function md(n){return n==null}function Ku(n){return n===0&&1/n==-1/0}function sI(n){return typeof n=="number"&&Number.isInteger(n)&&!Ku(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q0="";function iI(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Tv(e)),e=aI(n.get(t),e);return Tv(e)}function aI(n,e){let t=e;const s=n.length;for(let a=0;a<s;a++){const l=n.charAt(a);switch(l){case"\0":t+="";break;case Q0:t+="";break;default:t+=l}}return t}function Tv(n){return n+Q0+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sv(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function fa(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Y0(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xt{constructor(e,t){this.comparator=e,this.root=t||Qn.EMPTY}insert(e,t){return new Xt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Qn.BLACK,null,null))}remove(e){return new Xt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Qn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const s=this.comparator(e,t.key);if(s===0)return t.value;s<0?t=t.left:s>0&&(t=t.right)}return null}indexOf(e){let t=0,s=this.root;for(;!s.isEmpty();){const a=this.comparator(e,s.key);if(a===0)return t+s.left.size;a<0?s=s.left:(t+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,s)=>(e(t,s),!1)))}toString(){const e=[];return this.inorderTraversal(((t,s)=>(e.push(`${t}:${s}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new wu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new wu(this.root,e,this.comparator,!1)}getReverseIterator(){return new wu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new wu(this.root,e,this.comparator,!0)}}class wu{constructor(e,t,s,a){this.isReverse=a,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=t?s(e.key,t):1,t&&a&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Qn{constructor(e,t,s,a,l){this.key=e,this.value=t,this.color=s??Qn.RED,this.left=a??Qn.EMPTY,this.right=l??Qn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,s,a,l){return new Qn(e??this.key,t??this.value,s??this.color,a??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,s){let a=this;const l=s(e,a.key);return a=l<0?a.copy(null,null,null,a.left.insert(e,t,s),null):l===0?a.copy(null,t,null,null,null):a.copy(null,null,null,null,a.right.insert(e,t,s)),a.fixUp()}removeMin(){if(this.left.isEmpty())return Qn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let s,a=this;if(t(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,t),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),t(e,a.key)===0){if(a.right.isEmpty())return Qn.EMPTY;s=a.right.min(),a=a.copy(s.key,s.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,t))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Qn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Qn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw it(43730,{key:this.key,value:this.value});if(this.right.isRed())throw it(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw it(27949);return e+(this.isRed()?0:1)}}Qn.EMPTY=null,Qn.RED=!0,Qn.BLACK=!1;Qn.EMPTY=new class{constructor(){this.size=0}get key(){throw it(57766)}get value(){throw it(16141)}get color(){throw it(16727)}get left(){throw it(29726)}get right(){throw it(36894)}copy(e,t,s,a,l){return this}insert(e,t,s){return new Qn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jn{constructor(e){this.comparator=e,this.data=new Xt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,s)=>(e(t),!1)))}forEachInRange(e,t){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const a=s.getNext();if(this.comparator(a.key,e[1])>=0)return;t(a.key)}}forEachWhile(e,t){let s;for(s=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new bv(this.data.getIterator())}getIteratorFrom(e){return new bv(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((s=>{t=t.add(s)})),t}isEqual(e){if(!(e instanceof jn)||this.size!==e.size)return!1;const t=this.data.getIterator(),s=e.data.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=s.getNext().key;if(this.comparator(a,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new jn(this.comparator);return t.data=e,t}}class bv{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kr{constructor(e){this.fields=e,e.sort(Yn.comparator)}static empty(){return new Kr([])}unionWith(e){let t=new jn(Yn.comparator);for(const s of this.fields)t=t.add(s);for(const s of e)t=t.add(s);return new Kr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Uo(this.fields,e.fields,((t,s)=>t.isEqual(s)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J0 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(a){try{return atob(a)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new J0("Invalid base64 string: "+l):l}})(e);return new Jn(t)}static fromUint8Array(e){const t=(function(a){let l="";for(let u=0;u<a.length;++u)l+=String.fromCharCode(a[u]);return l})(e);return new Jn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const s=new Uint8Array(t.length);for(let a=0;a<t.length;a++)s[a]=t.charCodeAt(a);return s})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ft(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Jn.EMPTY_BYTE_STRING=new Jn("");const oI=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function sa(n){if(Rt(!!n,39018),typeof n=="string"){let e=0;const t=oI.exec(n);if(Rt(!!t,46558,{timestamp:n}),t[1]){let a=t[1];a=(a+"000000000").substr(0,9),e=Number(a)}const s=new Date(n);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:pn(n.seconds),nanos:pn(n.nanos)}}function pn(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function ia(n){return typeof n=="string"?Jn.fromBase64String(n):Jn.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X0="server_timestamp",Z0="__type__",ex="__previous_value__",tx="__local_write_time__";function Pp(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[Z0])===null||t===void 0?void 0:t.stringValue)===X0}function gd(n){const e=n.mapValue.fields[ex];return Pp(e)?gd(e):e}function Xl(n){const e=sa(n.mapValue.fields[tx].timestampValue);return new Gt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lI{constructor(e,t,s,a,l,u,f,m,y,_){this.databaseId=e,this.appId=t,this.persistenceKey=s,this.host=a,this.ssl=l,this.forceLongPolling=u,this.autoDetectLongPolling=f,this.longPollingOptions=m,this.useFetchStreams=y,this.isUsingEmulator=_}}const Qu="(default)";class Zl{constructor(e,t){this.projectId=e,this.database=t||Qu}static empty(){return new Zl("","")}get isDefaultDatabase(){return this.database===Qu}isEqual(e){return e instanceof Zl&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nx="__type__",cI="__max__",Eu={mapValue:{}},rx="__vector__",Yu="value";function aa(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Pp(n)?4:dI(n)?9007199254740991:uI(n)?10:11:it(28295,{value:n})}function Zs(n,e){if(n===e)return!0;const t=aa(n);if(t!==aa(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Xl(n).isEqual(Xl(e));case 3:return(function(a,l){if(typeof a.timestampValue=="string"&&typeof l.timestampValue=="string"&&a.timestampValue.length===l.timestampValue.length)return a.timestampValue===l.timestampValue;const u=sa(a.timestampValue),f=sa(l.timestampValue);return u.seconds===f.seconds&&u.nanos===f.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(a,l){return ia(a.bytesValue).isEqual(ia(l.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(a,l){return pn(a.geoPointValue.latitude)===pn(l.geoPointValue.latitude)&&pn(a.geoPointValue.longitude)===pn(l.geoPointValue.longitude)})(n,e);case 2:return(function(a,l){if("integerValue"in a&&"integerValue"in l)return pn(a.integerValue)===pn(l.integerValue);if("doubleValue"in a&&"doubleValue"in l){const u=pn(a.doubleValue),f=pn(l.doubleValue);return u===f?Ku(u)===Ku(f):isNaN(u)&&isNaN(f)}return!1})(n,e);case 9:return Uo(n.arrayValue.values||[],e.arrayValue.values||[],Zs);case 10:case 11:return(function(a,l){const u=a.mapValue.fields||{},f=l.mapValue.fields||{};if(Sv(u)!==Sv(f))return!1;for(const m in u)if(u.hasOwnProperty(m)&&(f[m]===void 0||!Zs(u[m],f[m])))return!1;return!0})(n,e);default:return it(52216,{left:n})}}function ec(n,e){return(n.values||[]).find((t=>Zs(t,e)))!==void 0}function zo(n,e){if(n===e)return 0;const t=aa(n),s=aa(e);if(t!==s)return ft(t,s);switch(t){case 0:case 9007199254740991:return 0;case 1:return ft(n.booleanValue,e.booleanValue);case 2:return(function(l,u){const f=pn(l.integerValue||l.doubleValue),m=pn(u.integerValue||u.doubleValue);return f<m?-1:f>m?1:f===m?0:isNaN(f)?isNaN(m)?0:-1:1})(n,e);case 3:return Cv(n.timestampValue,e.timestampValue);case 4:return Cv(Xl(n),Xl(e));case 5:return Ff(n.stringValue,e.stringValue);case 6:return(function(l,u){const f=ia(l),m=ia(u);return f.compareTo(m)})(n.bytesValue,e.bytesValue);case 7:return(function(l,u){const f=l.split("/"),m=u.split("/");for(let y=0;y<f.length&&y<m.length;y++){const _=ft(f[y],m[y]);if(_!==0)return _}return ft(f.length,m.length)})(n.referenceValue,e.referenceValue);case 8:return(function(l,u){const f=ft(pn(l.latitude),pn(u.latitude));return f!==0?f:ft(pn(l.longitude),pn(u.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Iv(n.arrayValue,e.arrayValue);case 10:return(function(l,u){var f,m,y,_;const T=l.fields||{},S=u.fields||{},F=(f=T[Yu])===null||f===void 0?void 0:f.arrayValue,J=(m=S[Yu])===null||m===void 0?void 0:m.arrayValue,$=ft(((y=F==null?void 0:F.values)===null||y===void 0?void 0:y.length)||0,((_=J==null?void 0:J.values)===null||_===void 0?void 0:_.length)||0);return $!==0?$:Iv(F,J)})(n.mapValue,e.mapValue);case 11:return(function(l,u){if(l===Eu.mapValue&&u===Eu.mapValue)return 0;if(l===Eu.mapValue)return 1;if(u===Eu.mapValue)return-1;const f=l.fields||{},m=Object.keys(f),y=u.fields||{},_=Object.keys(y);m.sort(),_.sort();for(let T=0;T<m.length&&T<_.length;++T){const S=Ff(m[T],_[T]);if(S!==0)return S;const F=zo(f[m[T]],y[_[T]]);if(F!==0)return F}return ft(m.length,_.length)})(n.mapValue,e.mapValue);default:throw it(23264,{le:t})}}function Cv(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ft(n,e);const t=sa(n),s=sa(e),a=ft(t.seconds,s.seconds);return a!==0?a:ft(t.nanos,s.nanos)}function Iv(n,e){const t=n.values||[],s=e.values||[];for(let a=0;a<t.length&&a<s.length;++a){const l=zo(t[a],s[a]);if(l)return l}return ft(t.length,s.length)}function Bo(n){return Uf(n)}function Uf(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const s=sa(t);return`time(${s.seconds},${s.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return ia(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Xe.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let s="[",a=!0;for(const l of t.values||[])a?a=!1:s+=",",s+=Uf(l);return s+"]"})(n.arrayValue):"mapValue"in n?(function(t){const s=Object.keys(t.fields||{}).sort();let a="{",l=!0;for(const u of s)l?l=!1:a+=",",a+=`${u}:${Uf(t.fields[u])}`;return a+"}"})(n.mapValue):it(61005,{value:n})}function ju(n){switch(aa(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=gd(n);return e?16+ju(e):16;case 5:return 2*n.stringValue.length;case 6:return ia(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(s){return(s.values||[]).reduce(((a,l)=>a+ju(l)),0)})(n.arrayValue);case 10:case 11:return(function(s){let a=0;return fa(s.fields,((l,u)=>{a+=l.length+ju(u)})),a})(n.mapValue);default:throw it(13486,{value:n})}}function Nv(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function zf(n){return!!n&&"integerValue"in n}function Rp(n){return!!n&&"arrayValue"in n}function Pv(n){return!!n&&"nullValue"in n}function Rv(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function ku(n){return!!n&&"mapValue"in n}function uI(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[nx])===null||t===void 0?void 0:t.stringValue)===rx}function Bl(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return fa(n.mapValue.fields,((t,s)=>e.mapValue.fields[t]=Bl(s))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Bl(n.arrayValue.values[t]);return e}return Object.assign({},n)}function dI(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===cI}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jr{constructor(e){this.value=e}static empty(){return new jr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let s=0;s<e.length-1;++s)if(t=(t.mapValue.fields||{})[e.get(s)],!ku(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Bl(t)}setAll(e){let t=Yn.emptyPath(),s={},a=[];e.forEach(((u,f)=>{if(!t.isImmediateParentOf(f)){const m=this.getFieldsMap(t);this.applyChanges(m,s,a),s={},a=[],t=f.popLast()}u?s[f.lastSegment()]=Bl(u):a.push(f.lastSegment())}));const l=this.getFieldsMap(t);this.applyChanges(l,s,a)}delete(e){const t=this.field(e.popLast());ku(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Zs(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let s=0;s<e.length;++s){let a=t.mapValue.fields[e.get(s)];ku(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},t.mapValue.fields[e.get(s)]=a),t=a}return t.mapValue.fields}applyChanges(e,t,s){fa(t,((a,l)=>e[a]=l));for(const a of s)delete e[a]}clone(){return new jr(Bl(this.value))}}function sx(n){const e=[];return fa(n.fields,((t,s)=>{const a=new Yn([t]);if(ku(s)){const l=sx(s.mapValue).fields;if(l.length===0)e.push(a);else for(const u of l)e.push(a.child(u))}else e.push(a)})),new Kr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class or{constructor(e,t,s,a,l,u,f){this.key=e,this.documentType=t,this.version=s,this.readTime=a,this.createTime=l,this.data=u,this.documentState=f}static newInvalidDocument(e){return new or(e,0,ct.min(),ct.min(),ct.min(),jr.empty(),0)}static newFoundDocument(e,t,s,a){return new or(e,1,t,ct.min(),s,a,0)}static newNoDocument(e,t){return new or(e,2,t,ct.min(),ct.min(),jr.empty(),0)}static newUnknownDocument(e,t){return new or(e,3,t,ct.min(),ct.min(),jr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ct.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=jr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=jr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ct.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof or&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new or(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ju{constructor(e,t){this.position=e,this.inclusive=t}}function Av(n,e,t){let s=0;for(let a=0;a<n.position.length;a++){const l=e[a],u=n.position[a];if(l.field.isKeyField()?s=Xe.comparator(Xe.fromName(u.referenceValue),t.key):s=zo(u,t.data.field(l.field)),l.dir==="desc"&&(s*=-1),s!==0)break}return s}function jv(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Zs(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tc{constructor(e,t="asc"){this.field=e,this.dir=t}}function hI(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ix{}class En extends ix{constructor(e,t,s){super(),this.field=e,this.op=t,this.value=s}static create(e,t,s){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,s):new pI(e,t,s):t==="array-contains"?new yI(e,s):t==="in"?new vI(e,s):t==="not-in"?new _I(e,s):t==="array-contains-any"?new xI(e,s):new En(e,t,s)}static createKeyFieldInFilter(e,t,s){return t==="in"?new mI(e,s):new gI(e,s)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(zo(t,this.value)):t!==null&&aa(this.value)===aa(t)&&this.matchesComparison(zo(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return it(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class js extends ix{constructor(e,t){super(),this.filters=e,this.op=t,this.he=null}static create(e,t){return new js(e,t)}matches(e){return ax(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function ax(n){return n.op==="and"}function ox(n){return fI(n)&&ax(n)}function fI(n){for(const e of n.filters)if(e instanceof js)return!1;return!0}function Bf(n){if(n instanceof En)return n.field.canonicalString()+n.op.toString()+Bo(n.value);if(ox(n))return n.filters.map((e=>Bf(e))).join(",");{const e=n.filters.map((t=>Bf(t))).join(",");return`${n.op}(${e})`}}function lx(n,e){return n instanceof En?(function(s,a){return a instanceof En&&s.op===a.op&&s.field.isEqual(a.field)&&Zs(s.value,a.value)})(n,e):n instanceof js?(function(s,a){return a instanceof js&&s.op===a.op&&s.filters.length===a.filters.length?s.filters.reduce(((l,u,f)=>l&&lx(u,a.filters[f])),!0):!1})(n,e):void it(19439)}function cx(n){return n instanceof En?(function(t){return`${t.field.canonicalString()} ${t.op} ${Bo(t.value)}`})(n):n instanceof js?(function(t){return t.op.toString()+" {"+t.getFilters().map(cx).join(" ,")+"}"})(n):"Filter"}class pI extends En{constructor(e,t,s){super(e,t,s),this.key=Xe.fromName(s.referenceValue)}matches(e){const t=Xe.comparator(e.key,this.key);return this.matchesComparison(t)}}class mI extends En{constructor(e,t){super(e,"in",t),this.keys=ux("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class gI extends En{constructor(e,t){super(e,"not-in",t),this.keys=ux("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function ux(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map((s=>Xe.fromName(s.referenceValue)))}class yI extends En{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Rp(t)&&ec(t.arrayValue,this.value)}}class vI extends En{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&ec(this.value.arrayValue,t)}}class _I extends En{constructor(e,t){super(e,"not-in",t)}matches(e){if(ec(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!ec(this.value.arrayValue,t)}}class xI extends En{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Rp(t)||!t.arrayValue.values)&&t.arrayValue.values.some((s=>ec(this.value.arrayValue,s)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wI{constructor(e,t=null,s=[],a=[],l=null,u=null,f=null){this.path=e,this.collectionGroup=t,this.orderBy=s,this.filters=a,this.limit=l,this.startAt=u,this.endAt=f,this.Pe=null}}function kv(n,e=null,t=[],s=[],a=null,l=null,u=null){return new wI(n,e,t,s,a,l,u)}function Ap(n){const e=ut(n);if(e.Pe===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((s=>Bf(s))).join(","),t+="|ob:",t+=e.orderBy.map((s=>(function(l){return l.field.canonicalString()+l.dir})(s))).join(","),md(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((s=>Bo(s))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((s=>Bo(s))).join(",")),e.Pe=t}return e.Pe}function jp(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!hI(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!lx(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!jv(n.startAt,e.startAt)&&jv(n.endAt,e.endAt)}function $f(n){return Xe.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nl{constructor(e,t=null,s=[],a=[],l=null,u="F",f=null,m=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=s,this.filters=a,this.limit=l,this.limitType=u,this.startAt=f,this.endAt=m,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function EI(n,e,t,s,a,l,u,f){return new nl(n,e,t,s,a,l,u,f)}function yd(n){return new nl(n)}function Dv(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function dx(n){return n.collectionGroup!==null}function $l(n){const e=ut(n);if(e.Te===null){e.Te=[];const t=new Set;for(const l of e.explicitOrderBy)e.Te.push(l),t.add(l.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(u){let f=new jn(Yn.comparator);return u.filters.forEach((m=>{m.getFlattenedFilters().forEach((y=>{y.isInequality()&&(f=f.add(y.field))}))})),f})(e).forEach((l=>{t.has(l.canonicalString())||l.isKeyField()||e.Te.push(new tc(l,s))})),t.has(Yn.keyField().canonicalString())||e.Te.push(new tc(Yn.keyField(),s))}return e.Te}function Qs(n){const e=ut(n);return e.Ie||(e.Ie=TI(e,$l(n))),e.Ie}function TI(n,e){if(n.limitType==="F")return kv(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((a=>{const l=a.dir==="desc"?"asc":"desc";return new tc(a.field,l)}));const t=n.endAt?new Ju(n.endAt.position,n.endAt.inclusive):null,s=n.startAt?new Ju(n.startAt.position,n.startAt.inclusive):null;return kv(n.path,n.collectionGroup,e,n.filters,n.limit,t,s)}}function Wf(n,e){const t=n.filters.concat([e]);return new nl(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Xu(n,e,t){return new nl(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function vd(n,e){return jp(Qs(n),Qs(e))&&n.limitType===e.limitType}function hx(n){return`${Ap(Qs(n))}|lt:${n.limitType}`}function Ao(n){return`Query(target=${(function(t){let s=t.path.canonicalString();return t.collectionGroup!==null&&(s+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(s+=`, filters: [${t.filters.map((a=>cx(a))).join(", ")}]`),md(t.limit)||(s+=", limit: "+t.limit),t.orderBy.length>0&&(s+=`, orderBy: [${t.orderBy.map((a=>(function(u){return`${u.field.canonicalString()} (${u.dir})`})(a))).join(", ")}]`),t.startAt&&(s+=", startAt: ",s+=t.startAt.inclusive?"b:":"a:",s+=t.startAt.position.map((a=>Bo(a))).join(",")),t.endAt&&(s+=", endAt: ",s+=t.endAt.inclusive?"a:":"b:",s+=t.endAt.position.map((a=>Bo(a))).join(",")),`Target(${s})`})(Qs(n))}; limitType=${n.limitType})`}function _d(n,e){return e.isFoundDocument()&&(function(s,a){const l=a.key.path;return s.collectionGroup!==null?a.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(l):Xe.isDocumentKey(s.path)?s.path.isEqual(l):s.path.isImmediateParentOf(l)})(n,e)&&(function(s,a){for(const l of $l(s))if(!l.field.isKeyField()&&a.data.field(l.field)===null)return!1;return!0})(n,e)&&(function(s,a){for(const l of s.filters)if(!l.matches(a))return!1;return!0})(n,e)&&(function(s,a){return!(s.startAt&&!(function(u,f,m){const y=Av(u,f,m);return u.inclusive?y<=0:y<0})(s.startAt,$l(s),a)||s.endAt&&!(function(u,f,m){const y=Av(u,f,m);return u.inclusive?y>=0:y>0})(s.endAt,$l(s),a))})(n,e)}function SI(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function fx(n){return(e,t)=>{let s=!1;for(const a of $l(n)){const l=bI(a,e,t);if(l!==0)return l;s=s||a.field.isKeyField()}return 0}}function bI(n,e,t){const s=n.field.isKeyField()?Xe.comparator(e.key,t.key):(function(l,u,f){const m=u.data.field(l),y=f.data.field(l);return m!==null&&y!==null?zo(m,y):it(42886)})(n.field,e,t);switch(n.dir){case"asc":return s;case"desc":return-1*s;default:return it(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ha{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s!==void 0){for(const[a,l]of s)if(this.equalsFn(a,e))return l}}has(e){return this.get(e)!==void 0}set(e,t){const s=this.mapKeyFn(e),a=this.inner[s];if(a===void 0)return this.inner[s]=[[e,t]],void this.innerSize++;for(let l=0;l<a.length;l++)if(this.equalsFn(a[l][0],e))return void(a[l]=[e,t]);a.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s===void 0)return!1;for(let a=0;a<s.length;a++)if(this.equalsFn(s[a][0],e))return s.length===1?delete this.inner[t]:s.splice(a,1),this.innerSize--,!0;return!1}forEach(e){fa(this.inner,((t,s)=>{for(const[a,l]of s)e(a,l)}))}isEmpty(){return Y0(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CI=new Xt(Xe.comparator);function wi(){return CI}const px=new Xt(Xe.comparator);function Ll(...n){let e=px;for(const t of n)e=e.insert(t.key,t);return e}function mx(n){let e=px;return n.forEach(((t,s)=>e=e.insert(t,s.overlayedDocument))),e}function La(){return Wl()}function gx(){return Wl()}function Wl(){return new Ha((n=>n.toString()),((n,e)=>n.isEqual(e)))}const II=new Xt(Xe.comparator),NI=new jn(Xe.comparator);function vt(...n){let e=NI;for(const t of n)e=e.add(t);return e}const PI=new jn(ft);function RI(){return PI}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kp(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ku(e)?"-0":e}}function yx(n){return{integerValue:""+n}}function AI(n,e){return sI(e)?yx(e):kp(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xd{constructor(){this._=void 0}}function jI(n,e,t){return n instanceof nc?(function(a,l){const u={fields:{[Z0]:{stringValue:X0},[tx]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return l&&Pp(l)&&(l=gd(l)),l&&(u.fields[ex]=l),{mapValue:u}})(t,e):n instanceof rc?_x(n,e):n instanceof sc?xx(n,e):(function(a,l){const u=vx(a,l),f=Vv(u)+Vv(a.Ee);return zf(u)&&zf(a.Ee)?yx(f):kp(a.serializer,f)})(n,e)}function kI(n,e,t){return n instanceof rc?_x(n,e):n instanceof sc?xx(n,e):t}function vx(n,e){return n instanceof Zu?(function(s){return zf(s)||(function(l){return!!l&&"doubleValue"in l})(s)})(e)?e:{integerValue:0}:null}class nc extends xd{}class rc extends xd{constructor(e){super(),this.elements=e}}function _x(n,e){const t=wx(e);for(const s of n.elements)t.some((a=>Zs(a,s)))||t.push(s);return{arrayValue:{values:t}}}class sc extends xd{constructor(e){super(),this.elements=e}}function xx(n,e){let t=wx(e);for(const s of n.elements)t=t.filter((a=>!Zs(a,s)));return{arrayValue:{values:t}}}class Zu extends xd{constructor(e,t){super(),this.serializer=e,this.Ee=t}}function Vv(n){return pn(n.integerValue||n.doubleValue)}function wx(n){return Rp(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DI{constructor(e,t){this.field=e,this.transform=t}}function VI(n,e){return n.field.isEqual(e.field)&&(function(s,a){return s instanceof rc&&a instanceof rc||s instanceof sc&&a instanceof sc?Uo(s.elements,a.elements,Zs):s instanceof Zu&&a instanceof Zu?Zs(s.Ee,a.Ee):s instanceof nc&&a instanceof nc})(n.transform,e.transform)}class LI{constructor(e,t){this.version=e,this.transformResults=t}}class gs{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new gs}static exists(e){return new gs(void 0,e)}static updateTime(e){return new gs(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Du(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class wd{}function Ex(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Dp(n.key,gs.none()):new hc(n.key,n.data,gs.none());{const t=n.data,s=jr.empty();let a=new jn(Yn.comparator);for(let l of e.fields)if(!a.has(l)){let u=t.field(l);u===null&&l.length>1&&(l=l.popLast(),u=t.field(l)),u===null?s.delete(l):s.set(l,u),a=a.add(l)}return new pa(n.key,s,new Kr(a.toArray()),gs.none())}}function MI(n,e,t){n instanceof hc?(function(a,l,u){const f=a.value.clone(),m=Mv(a.fieldTransforms,l,u.transformResults);f.setAll(m),l.convertToFoundDocument(u.version,f).setHasCommittedMutations()})(n,e,t):n instanceof pa?(function(a,l,u){if(!Du(a.precondition,l))return void l.convertToUnknownDocument(u.version);const f=Mv(a.fieldTransforms,l,u.transformResults),m=l.data;m.setAll(Tx(a)),m.setAll(f),l.convertToFoundDocument(u.version,m).setHasCommittedMutations()})(n,e,t):(function(a,l,u){l.convertToNoDocument(u.version).setHasCommittedMutations()})(0,e,t)}function Gl(n,e,t,s){return n instanceof hc?(function(l,u,f,m){if(!Du(l.precondition,u))return f;const y=l.value.clone(),_=Ov(l.fieldTransforms,m,u);return y.setAll(_),u.convertToFoundDocument(u.version,y).setHasLocalMutations(),null})(n,e,t,s):n instanceof pa?(function(l,u,f,m){if(!Du(l.precondition,u))return f;const y=Ov(l.fieldTransforms,m,u),_=u.data;return _.setAll(Tx(l)),_.setAll(y),u.convertToFoundDocument(u.version,_).setHasLocalMutations(),f===null?null:f.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((T=>T.field)))})(n,e,t,s):(function(l,u,f){return Du(l.precondition,u)?(u.convertToNoDocument(u.version).setHasLocalMutations(),null):f})(n,e,t)}function OI(n,e){let t=null;for(const s of n.fieldTransforms){const a=e.data.field(s.field),l=vx(s.transform,a||null);l!=null&&(t===null&&(t=jr.empty()),t.set(s.field,l))}return t||null}function Lv(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(s,a){return s===void 0&&a===void 0||!(!s||!a)&&Uo(s,a,((l,u)=>VI(l,u)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class hc extends wd{constructor(e,t,s,a=[]){super(),this.key=e,this.value=t,this.precondition=s,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class pa extends wd{constructor(e,t,s,a,l=[]){super(),this.key=e,this.data=t,this.fieldMask=s,this.precondition=a,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function Tx(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const s=n.data.field(t);e.set(t,s)}})),e}function Mv(n,e,t){const s=new Map;Rt(n.length===t.length,32656,{Ae:t.length,Re:n.length});for(let a=0;a<t.length;a++){const l=n[a],u=l.transform,f=e.data.field(l.field);s.set(l.field,kI(u,f,t[a]))}return s}function Ov(n,e,t){const s=new Map;for(const a of n){const l=a.transform,u=t.data.field(a.field);s.set(a.field,jI(l,u,e))}return s}class Dp extends wd{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class FI extends wd{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UI{constructor(e,t,s,a){this.batchId=e,this.localWriteTime=t,this.baseMutations=s,this.mutations=a}applyToRemoteDocument(e,t){const s=t.mutationResults;for(let a=0;a<this.mutations.length;a++){const l=this.mutations[a];l.key.isEqual(e.key)&&MI(l,e,s[a])}}applyToLocalView(e,t){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(t=Gl(s,e,t,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(t=Gl(s,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const s=gx();return this.mutations.forEach((a=>{const l=e.get(a.key),u=l.overlayedDocument;let f=this.applyToLocalView(u,l.mutatedFields);f=t.has(a.key)?null:f;const m=Ex(u,f);m!==null&&s.set(a.key,m),u.isValidDocument()||u.convertToNoDocument(ct.min())})),s}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),vt())}isEqual(e){return this.batchId===e.batchId&&Uo(this.mutations,e.mutations,((t,s)=>Lv(t,s)))&&Uo(this.baseMutations,e.baseMutations,((t,s)=>Lv(t,s)))}}class Vp{constructor(e,t,s,a){this.batch=e,this.commitVersion=t,this.mutationResults=s,this.docVersions=a}static from(e,t,s){Rt(e.mutations.length===s.length,58842,{Ve:e.mutations.length,me:s.length});let a=(function(){return II})();const l=e.mutations;for(let u=0;u<l.length;u++)a=a.insert(l[u].key,s[u].version);return new Vp(e,t,s,a)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zI{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BI{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var wn,wt;function $I(n){switch(n){case pe.OK:return it(64938);case pe.CANCELLED:case pe.UNKNOWN:case pe.DEADLINE_EXCEEDED:case pe.RESOURCE_EXHAUSTED:case pe.INTERNAL:case pe.UNAVAILABLE:case pe.UNAUTHENTICATED:return!1;case pe.INVALID_ARGUMENT:case pe.NOT_FOUND:case pe.ALREADY_EXISTS:case pe.PERMISSION_DENIED:case pe.FAILED_PRECONDITION:case pe.ABORTED:case pe.OUT_OF_RANGE:case pe.UNIMPLEMENTED:case pe.DATA_LOSS:return!0;default:return it(15467,{code:n})}}function Sx(n){if(n===void 0)return xi("GRPC error has no .code"),pe.UNKNOWN;switch(n){case wn.OK:return pe.OK;case wn.CANCELLED:return pe.CANCELLED;case wn.UNKNOWN:return pe.UNKNOWN;case wn.DEADLINE_EXCEEDED:return pe.DEADLINE_EXCEEDED;case wn.RESOURCE_EXHAUSTED:return pe.RESOURCE_EXHAUSTED;case wn.INTERNAL:return pe.INTERNAL;case wn.UNAVAILABLE:return pe.UNAVAILABLE;case wn.UNAUTHENTICATED:return pe.UNAUTHENTICATED;case wn.INVALID_ARGUMENT:return pe.INVALID_ARGUMENT;case wn.NOT_FOUND:return pe.NOT_FOUND;case wn.ALREADY_EXISTS:return pe.ALREADY_EXISTS;case wn.PERMISSION_DENIED:return pe.PERMISSION_DENIED;case wn.FAILED_PRECONDITION:return pe.FAILED_PRECONDITION;case wn.ABORTED:return pe.ABORTED;case wn.OUT_OF_RANGE:return pe.OUT_OF_RANGE;case wn.UNIMPLEMENTED:return pe.UNIMPLEMENTED;case wn.DATA_LOSS:return pe.DATA_LOSS;default:return it(39323,{code:n})}}(wt=wn||(wn={}))[wt.OK=0]="OK",wt[wt.CANCELLED=1]="CANCELLED",wt[wt.UNKNOWN=2]="UNKNOWN",wt[wt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",wt[wt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",wt[wt.NOT_FOUND=5]="NOT_FOUND",wt[wt.ALREADY_EXISTS=6]="ALREADY_EXISTS",wt[wt.PERMISSION_DENIED=7]="PERMISSION_DENIED",wt[wt.UNAUTHENTICATED=16]="UNAUTHENTICATED",wt[wt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",wt[wt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",wt[wt.ABORTED=10]="ABORTED",wt[wt.OUT_OF_RANGE=11]="OUT_OF_RANGE",wt[wt.UNIMPLEMENTED=12]="UNIMPLEMENTED",wt[wt.INTERNAL=13]="INTERNAL",wt[wt.UNAVAILABLE=14]="UNAVAILABLE",wt[wt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WI=new ea([4294967295,4294967295],0);function Fv(n){const e=q0().encode(n),t=new O0;return t.update(e),new Uint8Array(t.digest())}function Uv(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),s=e.getUint32(4,!0),a=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new ea([t,s],0),new ea([a,l],0)]}class Lp{constructor(e,t,s){if(this.bitmap=e,this.padding=t,this.hashCount=s,t<0||t>=8)throw new Ml(`Invalid padding: ${t}`);if(s<0)throw new Ml(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new Ml(`Invalid hash count: ${s}`);if(e.length===0&&t!==0)throw new Ml(`Invalid padding when bitmap length is 0: ${t}`);this.fe=8*e.length-t,this.ge=ea.fromNumber(this.fe)}pe(e,t,s){let a=e.add(t.multiply(ea.fromNumber(s)));return a.compare(WI)===1&&(a=new ea([a.getBits(0),a.getBits(1)],0)),a.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;const t=Fv(e),[s,a]=Uv(t);for(let l=0;l<this.hashCount;l++){const u=this.pe(s,a,l);if(!this.ye(u))return!1}return!0}static create(e,t,s){const a=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),u=new Lp(l,a,t);return s.forEach((f=>u.insert(f))),u}insert(e){if(this.fe===0)return;const t=Fv(e),[s,a]=Uv(t);for(let l=0;l<this.hashCount;l++){const u=this.pe(s,a,l);this.we(u)}}we(e){const t=Math.floor(e/8),s=e%8;this.bitmap[t]|=1<<s}}class Ml extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ed{constructor(e,t,s,a,l){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=s,this.documentUpdates=a,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,t,s){const a=new Map;return a.set(e,fc.createSynthesizedTargetChangeForCurrentChange(e,t,s)),new Ed(ct.min(),a,new Xt(ft),wi(),vt())}}class fc{constructor(e,t,s,a,l){this.resumeToken=e,this.current=t,this.addedDocuments=s,this.modifiedDocuments=a,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,t,s){return new fc(s,t,vt(),vt(),vt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vu{constructor(e,t,s,a){this.Se=e,this.removedTargetIds=t,this.key=s,this.be=a}}class bx{constructor(e,t){this.targetId=e,this.De=t}}class Cx{constructor(e,t,s=Jn.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=t,this.resumeToken=s,this.cause=a}}class zv{constructor(){this.ve=0,this.Ce=Bv(),this.Fe=Jn.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=vt(),t=vt(),s=vt();return this.Ce.forEach(((a,l)=>{switch(l){case 0:e=e.add(a);break;case 2:t=t.add(a);break;case 1:s=s.add(a);break;default:it(38017,{changeType:l})}})),new fc(this.Fe,this.Me,e,t,s)}ke(){this.xe=!1,this.Ce=Bv()}qe(e,t){this.xe=!0,this.Ce=this.Ce.insert(e,t)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,Rt(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class GI{constructor(e){this.We=e,this.Ge=new Map,this.ze=wi(),this.je=Tu(),this.Je=Tu(),this.He=new Xt(ft)}Ye(e){for(const t of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(t,e.be):this.Xe(t,e.key,e.be);for(const t of e.removedTargetIds)this.Xe(t,e.key,e.be)}et(e){this.forEachTarget(e,(t=>{const s=this.tt(t);switch(e.state){case 0:this.nt(t)&&s.Be(e.resumeToken);break;case 1:s.Ue(),s.Oe||s.ke(),s.Be(e.resumeToken);break;case 2:s.Ue(),s.Oe||this.removeTarget(t);break;case 3:this.nt(t)&&(s.Ke(),s.Be(e.resumeToken));break;case 4:this.nt(t)&&(this.rt(t),s.Be(e.resumeToken));break;default:it(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ge.forEach(((s,a)=>{this.nt(a)&&t(a)}))}it(e){const t=e.targetId,s=e.De.count,a=this.st(t);if(a){const l=a.target;if($f(l))if(s===0){const u=new Xe(l.path);this.Xe(t,u,or.newNoDocument(u,ct.min()))}else Rt(s===1,20013,{expectedCount:s});else{const u=this.ot(t);if(u!==s){const f=this._t(e),m=f?this.ut(f,e,u):1;if(m!==0){this.rt(t);const y=m===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(t,y)}}}}}_t(e){const t=e.De.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:s="",padding:a=0},hashCount:l=0}=t;let u,f;try{u=ia(s).toUint8Array()}catch(m){if(m instanceof J0)return na("Decoding the base64 bloom filter in existence filter failed ("+m.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw m}try{f=new Lp(u,a,l)}catch(m){return na(m instanceof Ml?"BloomFilter error: ":"Applying bloom filter failed: ",m),null}return f.fe===0?null:f}ut(e,t,s){return t.De.count===s-this.ht(e,t.targetId)?0:2}ht(e,t){const s=this.We.getRemoteKeysForTarget(t);let a=0;return s.forEach((l=>{const u=this.We.lt(),f=`projects/${u.projectId}/databases/${u.database}/documents/${l.path.canonicalString()}`;e.mightContain(f)||(this.Xe(t,l,null),a++)})),a}Pt(e){const t=new Map;this.Ge.forEach(((l,u)=>{const f=this.st(u);if(f){if(l.current&&$f(f.target)){const m=new Xe(f.target.path);this.Tt(m).has(u)||this.It(u,m)||this.Xe(u,m,or.newNoDocument(m,e))}l.Ne&&(t.set(u,l.Le()),l.ke())}}));let s=vt();this.Je.forEach(((l,u)=>{let f=!0;u.forEachWhile((m=>{const y=this.st(m);return!y||y.purpose==="TargetPurposeLimboResolution"||(f=!1,!1)})),f&&(s=s.add(l))})),this.ze.forEach(((l,u)=>u.setReadTime(e)));const a=new Ed(e,t,this.He,this.ze,s);return this.ze=wi(),this.je=Tu(),this.Je=Tu(),this.He=new Xt(ft),a}Ze(e,t){if(!this.nt(e))return;const s=this.It(e,t.key)?2:0;this.tt(e).qe(t.key,s),this.ze=this.ze.insert(t.key,t),this.je=this.je.insert(t.key,this.Tt(t.key).add(e)),this.Je=this.Je.insert(t.key,this.dt(t.key).add(e))}Xe(e,t,s){if(!this.nt(e))return;const a=this.tt(e);this.It(e,t)?a.qe(t,1):a.Qe(t),this.Je=this.Je.insert(t,this.dt(t).delete(e)),this.Je=this.Je.insert(t,this.dt(t).add(e)),s&&(this.ze=this.ze.insert(t,s))}removeTarget(e){this.Ge.delete(e)}ot(e){const t=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let t=this.Ge.get(e);return t||(t=new zv,this.Ge.set(e,t)),t}dt(e){let t=this.Je.get(e);return t||(t=new jn(ft),this.Je=this.Je.insert(e,t)),t}Tt(e){let t=this.je.get(e);return t||(t=new jn(ft),this.je=this.je.insert(e,t)),t}nt(e){const t=this.st(e)!==null;return t||Be("WatchChangeAggregator","Detected inactive target",e),t}st(e){const t=this.Ge.get(e);return t&&t.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new zv),this.We.getRemoteKeysForTarget(e).forEach((t=>{this.Xe(e,t,null)}))}It(e,t){return this.We.getRemoteKeysForTarget(e).has(t)}}function Tu(){return new Xt(Xe.comparator)}function Bv(){return new Xt(Xe.comparator)}const qI={asc:"ASCENDING",desc:"DESCENDING"},HI={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},KI={and:"AND",or:"OR"};class QI{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Gf(n,e){return n.useProto3Json||md(e)?e:{value:e}}function ed(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Ix(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function YI(n,e){return ed(n,e.toTimestamp())}function Ys(n){return Rt(!!n,49232),ct.fromTimestamp((function(t){const s=sa(t);return new Gt(s.seconds,s.nanos)})(n))}function Mp(n,e){return qf(n,e).canonicalString()}function qf(n,e){const t=(function(a){return new Ut(["projects",a.projectId,"databases",a.database])})(n).child("documents");return e===void 0?t:t.child(e)}function Nx(n){const e=Ut.fromString(n);return Rt(kx(e),10190,{key:e.toString()}),e}function Hf(n,e){return Mp(n.databaseId,e.path)}function mf(n,e){const t=Nx(e);if(t.get(1)!==n.databaseId.projectId)throw new Ue(pe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Ue(pe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Xe(Rx(t))}function Px(n,e){return Mp(n.databaseId,e)}function JI(n){const e=Nx(n);return e.length===4?Ut.emptyPath():Rx(e)}function Kf(n){return new Ut(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Rx(n){return Rt(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function $v(n,e,t){return{name:Hf(n,e),fields:t.value.mapValue.fields}}function XI(n,e){let t;if("targetChange"in e){e.targetChange;const s=(function(y){return y==="NO_CHANGE"?0:y==="ADD"?1:y==="REMOVE"?2:y==="CURRENT"?3:y==="RESET"?4:it(39313,{state:y})})(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],l=(function(y,_){return y.useProto3Json?(Rt(_===void 0||typeof _=="string",58123),Jn.fromBase64String(_||"")):(Rt(_===void 0||_ instanceof Buffer||_ instanceof Uint8Array,16193),Jn.fromUint8Array(_||new Uint8Array))})(n,e.targetChange.resumeToken),u=e.targetChange.cause,f=u&&(function(y){const _=y.code===void 0?pe.UNKNOWN:Sx(y.code);return new Ue(_,y.message||"")})(u);t=new Cx(s,a,l,f||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const a=mf(n,s.document.name),l=Ys(s.document.updateTime),u=s.document.createTime?Ys(s.document.createTime):ct.min(),f=new jr({mapValue:{fields:s.document.fields}}),m=or.newFoundDocument(a,l,u,f),y=s.targetIds||[],_=s.removedTargetIds||[];t=new Vu(y,_,m.key,m)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const a=mf(n,s.document),l=s.readTime?Ys(s.readTime):ct.min(),u=or.newNoDocument(a,l),f=s.removedTargetIds||[];t=new Vu([],f,u.key,u)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const a=mf(n,s.document),l=s.removedTargetIds||[];t=new Vu([],l,a,null)}else{if(!("filter"in e))return it(11601,{At:e});{e.filter;const s=e.filter;s.targetId;const{count:a=0,unchangedNames:l}=s,u=new BI(a,l),f=s.targetId;t=new bx(f,u)}}return t}function ZI(n,e){let t;if(e instanceof hc)t={update:$v(n,e.key,e.value)};else if(e instanceof Dp)t={delete:Hf(n,e.key)};else if(e instanceof pa)t={update:$v(n,e.key,e.data),updateMask:lN(e.fieldMask)};else{if(!(e instanceof FI))return it(16599,{Rt:e.type});t={verify:Hf(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((s=>(function(l,u){const f=u.transform;if(f instanceof nc)return{fieldPath:u.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(f instanceof rc)return{fieldPath:u.field.canonicalString(),appendMissingElements:{values:f.elements}};if(f instanceof sc)return{fieldPath:u.field.canonicalString(),removeAllFromArray:{values:f.elements}};if(f instanceof Zu)return{fieldPath:u.field.canonicalString(),increment:f.Ee};throw it(20930,{transform:u.transform})})(0,s)))),e.precondition.isNone||(t.currentDocument=(function(a,l){return l.updateTime!==void 0?{updateTime:YI(a,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:it(27497)})(n,e.precondition)),t}function eN(n,e){return n&&n.length>0?(Rt(e!==void 0,14353),n.map((t=>(function(a,l){let u=a.updateTime?Ys(a.updateTime):Ys(l);return u.isEqual(ct.min())&&(u=Ys(l)),new LI(u,a.transformResults||[])})(t,e)))):[]}function tN(n,e){return{documents:[Px(n,e.path)]}}function nN(n,e){const t={structuredQuery:{}},s=e.path;let a;e.collectionGroup!==null?(a=s,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=s.popLast(),t.structuredQuery.from=[{collectionId:s.lastSegment()}]),t.parent=Px(n,a);const l=(function(y){if(y.length!==0)return jx(js.create(y,"and"))})(e.filters);l&&(t.structuredQuery.where=l);const u=(function(y){if(y.length!==0)return y.map((_=>(function(S){return{field:jo(S.field),direction:iN(S.dir)}})(_)))})(e.orderBy);u&&(t.structuredQuery.orderBy=u);const f=Gf(n,e.limit);return f!==null&&(t.structuredQuery.limit=f),e.startAt&&(t.structuredQuery.startAt=(function(y){return{before:y.inclusive,values:y.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(y){return{before:!y.inclusive,values:y.position}})(e.endAt)),{Vt:t,parent:a}}function rN(n){let e=JI(n.parent);const t=n.structuredQuery,s=t.from?t.from.length:0;let a=null;if(s>0){Rt(s===1,65062);const _=t.from[0];_.allDescendants?a=_.collectionId:e=e.child(_.collectionId)}let l=[];t.where&&(l=(function(T){const S=Ax(T);return S instanceof js&&ox(S)?S.getFilters():[S]})(t.where));let u=[];t.orderBy&&(u=(function(T){return T.map((S=>(function(J){return new tc(ko(J.field),(function(B){switch(B){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(J.direction))})(S)))})(t.orderBy));let f=null;t.limit&&(f=(function(T){let S;return S=typeof T=="object"?T.value:T,md(S)?null:S})(t.limit));let m=null;t.startAt&&(m=(function(T){const S=!!T.before,F=T.values||[];return new Ju(F,S)})(t.startAt));let y=null;return t.endAt&&(y=(function(T){const S=!T.before,F=T.values||[];return new Ju(F,S)})(t.endAt)),EI(e,a,u,l,f,"F",m,y)}function sN(n,e){const t=(function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return it(28987,{purpose:a})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Ax(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const s=ko(t.unaryFilter.field);return En.create(s,"==",{doubleValue:NaN});case"IS_NULL":const a=ko(t.unaryFilter.field);return En.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=ko(t.unaryFilter.field);return En.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const u=ko(t.unaryFilter.field);return En.create(u,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return it(61313);default:return it(60726)}})(n):n.fieldFilter!==void 0?(function(t){return En.create(ko(t.fieldFilter.field),(function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return it(58110);default:return it(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return js.create(t.compositeFilter.filters.map((s=>Ax(s))),(function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return it(1026)}})(t.compositeFilter.op))})(n):it(30097,{filter:n})}function iN(n){return qI[n]}function aN(n){return HI[n]}function oN(n){return KI[n]}function jo(n){return{fieldPath:n.canonicalString()}}function ko(n){return Yn.fromServerFormat(n.fieldPath)}function jx(n){return n instanceof En?(function(t){if(t.op==="=="){if(Rv(t.value))return{unaryFilter:{field:jo(t.field),op:"IS_NAN"}};if(Pv(t.value))return{unaryFilter:{field:jo(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Rv(t.value))return{unaryFilter:{field:jo(t.field),op:"IS_NOT_NAN"}};if(Pv(t.value))return{unaryFilter:{field:jo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:jo(t.field),op:aN(t.op),value:t.value}}})(n):n instanceof js?(function(t){const s=t.getFilters().map((a=>jx(a)));return s.length===1?s[0]:{compositeFilter:{op:oN(t.op),filters:s}}})(n):it(54877,{filter:n})}function lN(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function kx(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qi{constructor(e,t,s,a,l=ct.min(),u=ct.min(),f=Jn.EMPTY_BYTE_STRING,m=null){this.target=e,this.targetId=t,this.purpose=s,this.sequenceNumber=a,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=u,this.resumeToken=f,this.expectedCount=m}withSequenceNumber(e){return new Qi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Qi(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Qi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Qi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cN{constructor(e){this.gt=e}}function uN(n){const e=rN({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Xu(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dN{constructor(){this.Dn=new hN}addToCollectionParentIndex(e,t){return this.Dn.add(t),xe.resolve()}getCollectionParents(e,t){return xe.resolve(this.Dn.getEntries(t))}addFieldIndex(e,t){return xe.resolve()}deleteFieldIndex(e,t){return xe.resolve()}deleteAllFieldIndexes(e){return xe.resolve()}createTargetIndexes(e,t){return xe.resolve()}getDocumentsMatchingTarget(e,t){return xe.resolve(null)}getIndexType(e,t){return xe.resolve(0)}getFieldIndexes(e,t){return xe.resolve([])}getNextCollectionGroupToUpdate(e){return xe.resolve(null)}getMinOffset(e,t){return xe.resolve(ra.min())}getMinOffsetFromCollectionGroup(e,t){return xe.resolve(ra.min())}updateCollectionGroup(e,t,s){return xe.resolve()}updateIndexEntries(e,t){return xe.resolve()}}class hN{constructor(){this.index={}}add(e){const t=e.lastSegment(),s=e.popLast(),a=this.index[t]||new jn(Ut.comparator),l=!a.has(s);return this.index[t]=a.add(s),l}has(e){const t=e.lastSegment(),s=e.popLast(),a=this.index[t];return a&&a.has(s)}getEntries(e){return(this.index[e]||new jn(Ut.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wv={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Dx=41943040;class Ar{static withCacheSize(e){return new Ar(e,Ar.DEFAULT_COLLECTION_PERCENTILE,Ar.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ar.DEFAULT_COLLECTION_PERCENTILE=10,Ar.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ar.DEFAULT=new Ar(Dx,Ar.DEFAULT_COLLECTION_PERCENTILE,Ar.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ar.DISABLED=new Ar(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $o{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new $o(0)}static ur(){return new $o(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gv="LruGarbageCollector",fN=1048576;function qv([n,e],[t,s]){const a=ft(n,t);return a===0?ft(e,s):a}class pN{constructor(e){this.Tr=e,this.buffer=new jn(qv),this.Ir=0}dr(){return++this.Ir}Er(e){const t=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(t);else{const s=this.buffer.last();qv(t,s)<0&&(this.buffer=this.buffer.delete(s).add(t))}}get maxValue(){return this.buffer.last()[0]}}class mN{constructor(e,t,s){this.garbageCollector=e,this.asyncQueue=t,this.localStore=s,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){Be(Gv,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){tl(t)?Be(Gv,"Ignoring IndexedDB error during garbage collection: ",t):await el(t)}await this.Rr(3e5)}))}}class gN{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.mr(e).next((s=>Math.floor(t/100*s)))}nthSequenceNumber(e,t){if(t===0)return xe.resolve(pd.ue);const s=new pN(t);return this.Vr.forEachTarget(e,(a=>s.Er(a.sequenceNumber))).next((()=>this.Vr.gr(e,(a=>s.Er(a))))).next((()=>s.maxValue))}removeTargets(e,t,s){return this.Vr.removeTargets(e,t,s)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Be("LruGarbageCollector","Garbage collection skipped; disabled"),xe.resolve(Wv)):this.getCacheSize(e).next((s=>s<this.params.cacheSizeCollectionThreshold?(Be("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Wv):this.pr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,t){let s,a,l,u,f,m,y;const _=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((T=>(T>this.params.maximumSequenceNumbersToCollect?(Be("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${T}`),a=this.params.maximumSequenceNumbersToCollect):a=T,u=Date.now(),this.nthSequenceNumber(e,a)))).next((T=>(s=T,f=Date.now(),this.removeTargets(e,s,t)))).next((T=>(l=T,m=Date.now(),this.removeOrphanedDocuments(e,s)))).next((T=>(y=Date.now(),Ro()<=yt.DEBUG&&Be("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${u-_}ms
	Determined least recently used ${a} in `+(f-u)+`ms
	Removed ${l} targets in `+(m-f)+`ms
	Removed ${T} documents in `+(y-m)+`ms
Total Duration: ${y-_}ms`),xe.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:l,documentsRemoved:T}))))}}function yN(n,e){return new gN(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vN{constructor(){this.changes=new Ha((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,or.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const s=this.changes.get(t);return s!==void 0?xe.resolve(s):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _N{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xN{constructor(e,t,s,a){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=s,this.indexManager=a}getDocument(e,t){let s=null;return this.documentOverlayCache.getOverlay(e,t).next((a=>(s=a,this.remoteDocumentCache.getEntry(e,t)))).next((a=>(s!==null&&Gl(s.mutation,a,Kr.empty(),Gt.now()),a)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((s=>this.getLocalViewOfDocuments(e,s,vt()).next((()=>s))))}getLocalViewOfDocuments(e,t,s=vt()){const a=La();return this.populateOverlays(e,a,t).next((()=>this.computeViews(e,t,a,s).next((l=>{let u=Ll();return l.forEach(((f,m)=>{u=u.insert(f,m.overlayedDocument)})),u}))))}getOverlayedDocuments(e,t){const s=La();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,vt())))}populateOverlays(e,t,s){const a=[];return s.forEach((l=>{t.has(l)||a.push(l)})),this.documentOverlayCache.getOverlays(e,a).next((l=>{l.forEach(((u,f)=>{t.set(u,f)}))}))}computeViews(e,t,s,a){let l=wi();const u=Wl(),f=(function(){return Wl()})();return t.forEach(((m,y)=>{const _=s.get(y.key);a.has(y.key)&&(_===void 0||_.mutation instanceof pa)?l=l.insert(y.key,y):_!==void 0?(u.set(y.key,_.mutation.getFieldMask()),Gl(_.mutation,y,_.mutation.getFieldMask(),Gt.now())):u.set(y.key,Kr.empty())})),this.recalculateAndSaveOverlays(e,l).next((m=>(m.forEach(((y,_)=>u.set(y,_))),t.forEach(((y,_)=>{var T;return f.set(y,new _N(_,(T=u.get(y))!==null&&T!==void 0?T:null))})),f)))}recalculateAndSaveOverlays(e,t){const s=Wl();let a=new Xt(((u,f)=>u-f)),l=vt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((u=>{for(const f of u)f.keys().forEach((m=>{const y=t.get(m);if(y===null)return;let _=s.get(m)||Kr.empty();_=f.applyToLocalView(y,_),s.set(m,_);const T=(a.get(f.batchId)||vt()).add(m);a=a.insert(f.batchId,T)}))})).next((()=>{const u=[],f=a.getReverseIterator();for(;f.hasNext();){const m=f.getNext(),y=m.key,_=m.value,T=gx();_.forEach((S=>{if(!l.has(S)){const F=Ex(t.get(S),s.get(S));F!==null&&T.set(S,F),l=l.add(S)}})),u.push(this.documentOverlayCache.saveOverlays(e,y,T))}return xe.waitFor(u)})).next((()=>s))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((s=>this.recalculateAndSaveOverlays(e,s)))}getDocumentsMatchingQuery(e,t,s,a){return(function(u){return Xe.isDocumentKey(u.path)&&u.collectionGroup===null&&u.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):dx(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,s,a):this.getDocumentsMatchingCollectionQuery(e,t,s,a)}getNextDocuments(e,t,s,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,s,a).next((l=>{const u=a-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,s.largestBatchId,a-l.size):xe.resolve(La());let f=Jl,m=l;return u.next((y=>xe.forEach(y,((_,T)=>(f<T.largestBatchId&&(f=T.largestBatchId),l.get(_)?xe.resolve():this.remoteDocumentCache.getEntry(e,_).next((S=>{m=m.insert(_,S)}))))).next((()=>this.populateOverlays(e,y,l))).next((()=>this.computeViews(e,m,y,vt()))).next((_=>({batchId:f,changes:mx(_)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Xe(t)).next((s=>{let a=Ll();return s.isFoundDocument()&&(a=a.insert(s.key,s)),a}))}getDocumentsMatchingCollectionGroupQuery(e,t,s,a){const l=t.collectionGroup;let u=Ll();return this.indexManager.getCollectionParents(e,l).next((f=>xe.forEach(f,(m=>{const y=(function(T,S){return new nl(S,null,T.explicitOrderBy.slice(),T.filters.slice(),T.limit,T.limitType,T.startAt,T.endAt)})(t,m.child(l));return this.getDocumentsMatchingCollectionQuery(e,y,s,a).next((_=>{_.forEach(((T,S)=>{u=u.insert(T,S)}))}))})).next((()=>u))))}getDocumentsMatchingCollectionQuery(e,t,s,a){let l;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,s.largestBatchId).next((u=>(l=u,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,s,l,a)))).next((u=>{l.forEach(((m,y)=>{const _=y.getKey();u.get(_)===null&&(u=u.insert(_,or.newInvalidDocument(_)))}));let f=Ll();return u.forEach(((m,y)=>{const _=l.get(m);_!==void 0&&Gl(_.mutation,y,Kr.empty(),Gt.now()),_d(t,y)&&(f=f.insert(m,y))})),f}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wN{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,t){return xe.resolve(this.Br.get(t))}saveBundleMetadata(e,t){return this.Br.set(t.id,(function(a){return{id:a.id,version:a.version,createTime:Ys(a.createTime)}})(t)),xe.resolve()}getNamedQuery(e,t){return xe.resolve(this.Lr.get(t))}saveNamedQuery(e,t){return this.Lr.set(t.name,(function(a){return{name:a.name,query:uN(a.bundledQuery),readTime:Ys(a.readTime)}})(t)),xe.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EN{constructor(){this.overlays=new Xt(Xe.comparator),this.kr=new Map}getOverlay(e,t){return xe.resolve(this.overlays.get(t))}getOverlays(e,t){const s=La();return xe.forEach(t,(a=>this.getOverlay(e,a).next((l=>{l!==null&&s.set(a,l)})))).next((()=>s))}saveOverlays(e,t,s){return s.forEach(((a,l)=>{this.wt(e,t,l)})),xe.resolve()}removeOverlaysForBatchId(e,t,s){const a=this.kr.get(s);return a!==void 0&&(a.forEach((l=>this.overlays=this.overlays.remove(l))),this.kr.delete(s)),xe.resolve()}getOverlaysForCollection(e,t,s){const a=La(),l=t.length+1,u=new Xe(t.child("")),f=this.overlays.getIteratorFrom(u);for(;f.hasNext();){const m=f.getNext().value,y=m.getKey();if(!t.isPrefixOf(y.path))break;y.path.length===l&&m.largestBatchId>s&&a.set(m.getKey(),m)}return xe.resolve(a)}getOverlaysForCollectionGroup(e,t,s,a){let l=new Xt(((y,_)=>y-_));const u=this.overlays.getIterator();for(;u.hasNext();){const y=u.getNext().value;if(y.getKey().getCollectionGroup()===t&&y.largestBatchId>s){let _=l.get(y.largestBatchId);_===null&&(_=La(),l=l.insert(y.largestBatchId,_)),_.set(y.getKey(),y)}}const f=La(),m=l.getIterator();for(;m.hasNext()&&(m.getNext().value.forEach(((y,_)=>f.set(y,_))),!(f.size()>=a)););return xe.resolve(f)}wt(e,t,s){const a=this.overlays.get(s.key);if(a!==null){const u=this.kr.get(a.largestBatchId).delete(s.key);this.kr.set(a.largestBatchId,u)}this.overlays=this.overlays.insert(s.key,new zI(t,s));let l=this.kr.get(t);l===void 0&&(l=vt(),this.kr.set(t,l)),this.kr.set(t,l.add(s.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TN{constructor(){this.sessionToken=Jn.EMPTY_BYTE_STRING}getSessionToken(e){return xe.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,xe.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Op{constructor(){this.qr=new jn(Bn.Qr),this.$r=new jn(Bn.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,t){const s=new Bn(e,t);this.qr=this.qr.add(s),this.$r=this.$r.add(s)}Kr(e,t){e.forEach((s=>this.addReference(s,t)))}removeReference(e,t){this.Wr(new Bn(e,t))}Gr(e,t){e.forEach((s=>this.removeReference(s,t)))}zr(e){const t=new Xe(new Ut([])),s=new Bn(t,e),a=new Bn(t,e+1),l=[];return this.$r.forEachInRange([s,a],(u=>{this.Wr(u),l.push(u.key)})),l}jr(){this.qr.forEach((e=>this.Wr(e)))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const t=new Xe(new Ut([])),s=new Bn(t,e),a=new Bn(t,e+1);let l=vt();return this.$r.forEachInRange([s,a],(u=>{l=l.add(u.key)})),l}containsKey(e){const t=new Bn(e,0),s=this.qr.firstAfterOrEqual(t);return s!==null&&e.isEqual(s.key)}}class Bn{constructor(e,t){this.key=e,this.Hr=t}static Qr(e,t){return Xe.comparator(e.key,t.key)||ft(e.Hr,t.Hr)}static Ur(e,t){return ft(e.Hr,t.Hr)||Xe.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SN{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.er=1,this.Yr=new jn(Bn.Qr)}checkEmpty(e){return xe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,s,a){const l=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const u=new UI(l,t,s,a);this.mutationQueue.push(u);for(const f of a)this.Yr=this.Yr.add(new Bn(f.key,l)),this.indexManager.addToCollectionParentIndex(e,f.key.path.popLast());return xe.resolve(u)}lookupMutationBatch(e,t){return xe.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const s=t+1,a=this.Xr(s),l=a<0?0:a;return xe.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return xe.resolve(this.mutationQueue.length===0?Np:this.er-1)}getAllMutationBatches(e){return xe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const s=new Bn(t,0),a=new Bn(t,Number.POSITIVE_INFINITY),l=[];return this.Yr.forEachInRange([s,a],(u=>{const f=this.Zr(u.Hr);l.push(f)})),xe.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new jn(ft);return t.forEach((a=>{const l=new Bn(a,0),u=new Bn(a,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([l,u],(f=>{s=s.add(f.Hr)}))})),xe.resolve(this.ei(s))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,a=s.length+1;let l=s;Xe.isDocumentKey(l)||(l=l.child(""));const u=new Bn(new Xe(l),0);let f=new jn(ft);return this.Yr.forEachWhile((m=>{const y=m.key.path;return!!s.isPrefixOf(y)&&(y.length===a&&(f=f.add(m.Hr)),!0)}),u),xe.resolve(this.ei(f))}ei(e){const t=[];return e.forEach((s=>{const a=this.Zr(s);a!==null&&t.push(a)})),t}removeMutationBatch(e,t){Rt(this.ti(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let s=this.Yr;return xe.forEach(t.mutations,(a=>{const l=new Bn(a.key,t.batchId);return s=s.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((()=>{this.Yr=s}))}rr(e){}containsKey(e,t){const s=new Bn(t,0),a=this.Yr.firstAfterOrEqual(s);return xe.resolve(t.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,xe.resolve()}ti(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bN{constructor(e){this.ni=e,this.docs=(function(){return new Xt(Xe.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const s=t.key,a=this.docs.get(s),l=a?a.size:0,u=this.ni(t);return this.docs=this.docs.insert(s,{document:t.mutableCopy(),size:u}),this.size+=u-l,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const s=this.docs.get(t);return xe.resolve(s?s.document.mutableCopy():or.newInvalidDocument(t))}getEntries(e,t){let s=wi();return t.forEach((a=>{const l=this.docs.get(a);s=s.insert(a,l?l.document.mutableCopy():or.newInvalidDocument(a))})),xe.resolve(s)}getDocumentsMatchingQuery(e,t,s,a){let l=wi();const u=t.path,f=new Xe(u.child("__id-9223372036854775808__")),m=this.docs.getIteratorFrom(f);for(;m.hasNext();){const{key:y,value:{document:_}}=m.getNext();if(!u.isPrefixOf(y.path))break;y.path.length>u.length+1||eI(ZC(_),s)<=0||(a.has(_.key)||_d(t,_))&&(l=l.insert(_.key,_.mutableCopy()))}return xe.resolve(l)}getAllFromCollectionGroup(e,t,s,a){it(9500)}ri(e,t){return xe.forEach(this.docs,(s=>t(s)))}newChangeBuffer(e){return new CN(this)}getSize(e){return xe.resolve(this.size)}}class CN extends vN{constructor(e){super(),this.Or=e}applyChanges(e){const t=[];return this.changes.forEach(((s,a)=>{a.isValidDocument()?t.push(this.Or.addEntry(e,a)):this.Or.removeEntry(s)})),xe.waitFor(t)}getFromCache(e,t){return this.Or.getEntry(e,t)}getAllFromCache(e,t){return this.Or.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IN{constructor(e){this.persistence=e,this.ii=new Ha((t=>Ap(t)),jp),this.lastRemoteSnapshotVersion=ct.min(),this.highestTargetId=0,this.si=0,this.oi=new Op,this.targetCount=0,this._i=$o.ar()}forEachTarget(e,t){return this.ii.forEach(((s,a)=>t(a))),xe.resolve()}getLastRemoteSnapshotVersion(e){return xe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return xe.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),xe.resolve(this.highestTargetId)}setTargetsMetadata(e,t,s){return s&&(this.lastRemoteSnapshotVersion=s),t>this.si&&(this.si=t),xe.resolve()}hr(e){this.ii.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this._i=new $o(t),this.highestTargetId=t),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,t){return this.hr(t),this.targetCount+=1,xe.resolve()}updateTargetData(e,t){return this.hr(t),xe.resolve()}removeTargetData(e,t){return this.ii.delete(t.target),this.oi.zr(t.targetId),this.targetCount-=1,xe.resolve()}removeTargets(e,t,s){let a=0;const l=[];return this.ii.forEach(((u,f)=>{f.sequenceNumber<=t&&s.get(f.targetId)===null&&(this.ii.delete(u),l.push(this.removeMatchingKeysForTargetId(e,f.targetId)),a++)})),xe.waitFor(l).next((()=>a))}getTargetCount(e){return xe.resolve(this.targetCount)}getTargetData(e,t){const s=this.ii.get(t)||null;return xe.resolve(s)}addMatchingKeys(e,t,s){return this.oi.Kr(t,s),xe.resolve()}removeMatchingKeys(e,t,s){this.oi.Gr(t,s);const a=this.persistence.referenceDelegate,l=[];return a&&t.forEach((u=>{l.push(a.markPotentiallyOrphaned(e,u))})),xe.waitFor(l)}removeMatchingKeysForTargetId(e,t){return this.oi.zr(t),xe.resolve()}getMatchingKeysForTargetId(e,t){const s=this.oi.Jr(t);return xe.resolve(s)}containsKey(e,t){return xe.resolve(this.oi.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vx{constructor(e,t){this.ai={},this.overlays={},this.ui=new pd(0),this.ci=!1,this.ci=!0,this.li=new TN,this.referenceDelegate=e(this),this.hi=new IN(this),this.indexManager=new dN,this.remoteDocumentCache=(function(a){return new bN(a)})((s=>this.referenceDelegate.Pi(s))),this.serializer=new cN(t),this.Ti=new wN(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new EN,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let s=this.ai[e.toKey()];return s||(s=new SN(t,this.referenceDelegate),this.ai[e.toKey()]=s),s}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,t,s){Be("MemoryPersistence","Starting transaction:",e);const a=new NN(this.ui.next());return this.referenceDelegate.Ii(),s(a).next((l=>this.referenceDelegate.di(a).next((()=>l)))).toPromise().then((l=>(a.raiseOnCommittedEvent(),l)))}Ei(e,t){return xe.or(Object.values(this.ai).map((s=>()=>s.containsKey(e,t))))}}class NN extends nI{constructor(e){super(),this.currentSequenceNumber=e}}class Fp{constructor(e){this.persistence=e,this.Ai=new Op,this.Ri=null}static Vi(e){return new Fp(e)}get mi(){if(this.Ri)return this.Ri;throw it(60996)}addReference(e,t,s){return this.Ai.addReference(s,t),this.mi.delete(s.toString()),xe.resolve()}removeReference(e,t,s){return this.Ai.removeReference(s,t),this.mi.add(s.toString()),xe.resolve()}markPotentiallyOrphaned(e,t){return this.mi.add(t.toString()),xe.resolve()}removeTarget(e,t){this.Ai.zr(t.targetId).forEach((a=>this.mi.add(a.toString())));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,t.targetId).next((a=>{a.forEach((l=>this.mi.add(l.toString())))})).next((()=>s.removeTargetData(e,t)))}Ii(){this.Ri=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return xe.forEach(this.mi,(s=>{const a=Xe.fromPath(s);return this.fi(e,a).next((l=>{l||t.removeEntry(a,ct.min())}))})).next((()=>(this.Ri=null,t.apply(e))))}updateLimboDocument(e,t){return this.fi(e,t).next((s=>{s?this.mi.delete(t.toString()):this.mi.add(t.toString())}))}Pi(e){return 0}fi(e,t){return xe.or([()=>xe.resolve(this.Ai.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class td{constructor(e,t){this.persistence=e,this.gi=new Ha((s=>iI(s.path)),((s,a)=>s.isEqual(a))),this.garbageCollector=yN(this,t)}static Vi(e,t){return new td(e,t)}Ii(){}di(e){return xe.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}mr(e){const t=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next((s=>t.next((a=>s+a))))}yr(e){let t=0;return this.gr(e,(s=>{t++})).next((()=>t))}gr(e,t){return xe.forEach(this.gi,((s,a)=>this.Sr(e,s,a).next((l=>l?xe.resolve():t(a)))))}removeTargets(e,t,s){return this.persistence.getTargetCache().removeTargets(e,t,s)}removeOrphanedDocuments(e,t){let s=0;const a=this.persistence.getRemoteDocumentCache(),l=a.newChangeBuffer();return a.ri(e,(u=>this.Sr(e,u,t).next((f=>{f||(s++,l.removeEntry(u,ct.min()))})))).next((()=>l.apply(e))).next((()=>s))}markPotentiallyOrphaned(e,t){return this.gi.set(t,e.currentSequenceNumber),xe.resolve()}removeTarget(e,t){const s=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,s)}addReference(e,t,s){return this.gi.set(s,e.currentSequenceNumber),xe.resolve()}removeReference(e,t,s){return this.gi.set(s,e.currentSequenceNumber),xe.resolve()}updateLimboDocument(e,t){return this.gi.set(t,e.currentSequenceNumber),xe.resolve()}Pi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=ju(e.data.value)),t}Sr(e,t,s){return xe.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const a=this.gi.get(t);return xe.resolve(a!==void 0&&a>s)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Up{constructor(e,t,s,a){this.targetId=e,this.fromCache=t,this.Is=s,this.ds=a}static Es(e,t){let s=vt(),a=vt();for(const l of t.docChanges)switch(l.type){case 0:s=s.add(l.doc.key);break;case 1:a=a.add(l.doc.key)}return new Up(e,t.fromCache,s,a)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PN{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RN{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=(function(){return iT()?8:rI(lr())>0?6:4})()}initialize(e,t){this.gs=e,this.indexManager=t,this.As=!0}getDocumentsMatchingQuery(e,t,s,a){const l={result:null};return this.ps(e,t).next((u=>{l.result=u})).next((()=>{if(!l.result)return this.ys(e,t,a,s).next((u=>{l.result=u}))})).next((()=>{if(l.result)return;const u=new PN;return this.ws(e,t,u).next((f=>{if(l.result=f,this.Rs)return this.Ss(e,t,u,f.size)}))})).next((()=>l.result))}Ss(e,t,s,a){return s.documentReadCount<this.Vs?(Ro()<=yt.DEBUG&&Be("QueryEngine","SDK will not create cache indexes for query:",Ao(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),xe.resolve()):(Ro()<=yt.DEBUG&&Be("QueryEngine","Query:",Ao(t),"scans",s.documentReadCount,"local documents and returns",a,"documents as results."),s.documentReadCount>this.fs*a?(Ro()<=yt.DEBUG&&Be("QueryEngine","The SDK decides to create cache indexes for query:",Ao(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Qs(t))):xe.resolve())}ps(e,t){if(Dv(t))return xe.resolve(null);let s=Qs(t);return this.indexManager.getIndexType(e,s).next((a=>a===0?null:(t.limit!==null&&a===1&&(t=Xu(t,null,"F"),s=Qs(t)),this.indexManager.getDocumentsMatchingTarget(e,s).next((l=>{const u=vt(...l);return this.gs.getDocuments(e,u).next((f=>this.indexManager.getMinOffset(e,s).next((m=>{const y=this.bs(t,f);return this.Ds(t,y,u,m.readTime)?this.ps(e,Xu(t,null,"F")):this.vs(e,y,t,m)}))))})))))}ys(e,t,s,a){return Dv(t)||a.isEqual(ct.min())?xe.resolve(null):this.gs.getDocuments(e,s).next((l=>{const u=this.bs(t,l);return this.Ds(t,u,s,a)?xe.resolve(null):(Ro()<=yt.DEBUG&&Be("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),Ao(t)),this.vs(e,u,t,XC(a,Jl)).next((f=>f)))}))}bs(e,t){let s=new jn(fx(e));return t.forEach(((a,l)=>{_d(e,l)&&(s=s.add(l))})),s}Ds(e,t,s,a){if(e.limit===null)return!1;if(s.size!==t.size)return!0;const l=e.limitType==="F"?t.last():t.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(a)>0)}ws(e,t,s){return Ro()<=yt.DEBUG&&Be("QueryEngine","Using full collection scan to execute query:",Ao(t)),this.gs.getDocumentsMatchingQuery(e,t,ra.min(),s)}vs(e,t,s,a){return this.gs.getDocumentsMatchingQuery(e,s,a).next((l=>(t.forEach((u=>{l=l.insert(u.key,u)})),l)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zp="LocalStore",AN=3e8;class jN{constructor(e,t,s,a){this.persistence=e,this.Cs=t,this.serializer=a,this.Fs=new Xt(ft),this.Ms=new Ha((l=>Ap(l)),jp),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(s)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new xN(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Fs)))}}function kN(n,e,t,s){return new jN(n,e,t,s)}async function Lx(n,e){const t=ut(n);return await t.persistence.runTransaction("Handle user change","readonly",(s=>{let a;return t.mutationQueue.getAllMutationBatches(s).next((l=>(a=l,t.Ns(e),t.mutationQueue.getAllMutationBatches(s)))).next((l=>{const u=[],f=[];let m=vt();for(const y of a){u.push(y.batchId);for(const _ of y.mutations)m=m.add(_.key)}for(const y of l){f.push(y.batchId);for(const _ of y.mutations)m=m.add(_.key)}return t.localDocuments.getDocuments(s,m).next((y=>({Bs:y,removedBatchIds:u,addedBatchIds:f})))}))}))}function DN(n,e){const t=ut(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(s=>{const a=e.batch.keys(),l=t.Os.newChangeBuffer({trackRemovals:!0});return(function(f,m,y,_){const T=y.batch,S=T.keys();let F=xe.resolve();return S.forEach((J=>{F=F.next((()=>_.getEntry(m,J))).next(($=>{const B=y.docVersions.get(J);Rt(B!==null,48541),$.version.compareTo(B)<0&&(T.applyToRemoteDocument($,y),$.isValidDocument()&&($.setReadTime(y.commitVersion),_.addEntry($)))}))})),F.next((()=>f.mutationQueue.removeMutationBatch(m,T)))})(t,s,e,l).next((()=>l.apply(s))).next((()=>t.mutationQueue.performConsistencyCheck(s))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(s,a,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,(function(f){let m=vt();for(let y=0;y<f.mutationResults.length;++y)f.mutationResults[y].transformResults.length>0&&(m=m.add(f.batch.mutations[y].key));return m})(e)))).next((()=>t.localDocuments.getDocuments(s,a)))}))}function Mx(n){const e=ut(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.hi.getLastRemoteSnapshotVersion(t)))}function VN(n,e){const t=ut(n),s=e.snapshotVersion;let a=t.Fs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const u=t.Os.newChangeBuffer({trackRemovals:!0});a=t.Fs;const f=[];e.targetChanges.forEach(((_,T)=>{const S=a.get(T);if(!S)return;f.push(t.hi.removeMatchingKeys(l,_.removedDocuments,T).next((()=>t.hi.addMatchingKeys(l,_.addedDocuments,T))));let F=S.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(T)!==null?F=F.withResumeToken(Jn.EMPTY_BYTE_STRING,ct.min()).withLastLimboFreeSnapshotVersion(ct.min()):_.resumeToken.approximateByteSize()>0&&(F=F.withResumeToken(_.resumeToken,s)),a=a.insert(T,F),(function($,B,se){return $.resumeToken.approximateByteSize()===0||B.snapshotVersion.toMicroseconds()-$.snapshotVersion.toMicroseconds()>=AN?!0:se.addedDocuments.size+se.modifiedDocuments.size+se.removedDocuments.size>0})(S,F,_)&&f.push(t.hi.updateTargetData(l,F))}));let m=wi(),y=vt();if(e.documentUpdates.forEach((_=>{e.resolvedLimboDocuments.has(_)&&f.push(t.persistence.referenceDelegate.updateLimboDocument(l,_))})),f.push(LN(l,u,e.documentUpdates).next((_=>{m=_.Ls,y=_.ks}))),!s.isEqual(ct.min())){const _=t.hi.getLastRemoteSnapshotVersion(l).next((T=>t.hi.setTargetsMetadata(l,l.currentSequenceNumber,s)));f.push(_)}return xe.waitFor(f).next((()=>u.apply(l))).next((()=>t.localDocuments.getLocalViewOfDocuments(l,m,y))).next((()=>m))})).then((l=>(t.Fs=a,l)))}function LN(n,e,t){let s=vt(),a=vt();return t.forEach((l=>s=s.add(l))),e.getEntries(n,s).next((l=>{let u=wi();return t.forEach(((f,m)=>{const y=l.get(f);m.isFoundDocument()!==y.isFoundDocument()&&(a=a.add(f)),m.isNoDocument()&&m.version.isEqual(ct.min())?(e.removeEntry(f,m.readTime),u=u.insert(f,m)):!y.isValidDocument()||m.version.compareTo(y.version)>0||m.version.compareTo(y.version)===0&&y.hasPendingWrites?(e.addEntry(m),u=u.insert(f,m)):Be(zp,"Ignoring outdated watch update for ",f,". Current version:",y.version," Watch version:",m.version)})),{Ls:u,ks:a}}))}function MN(n,e){const t=ut(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(s=>(e===void 0&&(e=Np),t.mutationQueue.getNextMutationBatchAfterBatchId(s,e))))}function ON(n,e){const t=ut(n);return t.persistence.runTransaction("Allocate target","readwrite",(s=>{let a;return t.hi.getTargetData(s,e).next((l=>l?(a=l,xe.resolve(a)):t.hi.allocateTargetId(s).next((u=>(a=new Qi(e,u,"TargetPurposeListen",s.currentSequenceNumber),t.hi.addTargetData(s,a).next((()=>a)))))))})).then((s=>{const a=t.Fs.get(s.targetId);return(a===null||s.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(t.Fs=t.Fs.insert(s.targetId,s),t.Ms.set(e,s.targetId)),s}))}async function Qf(n,e,t){const s=ut(n),a=s.Fs.get(e),l=t?"readwrite":"readwrite-primary";try{t||await s.persistence.runTransaction("Release target",l,(u=>s.persistence.referenceDelegate.removeTarget(u,a)))}catch(u){if(!tl(u))throw u;Be(zp,`Failed to update sequence numbers for target ${e}: ${u}`)}s.Fs=s.Fs.remove(e),s.Ms.delete(a.target)}function Hv(n,e,t){const s=ut(n);let a=ct.min(),l=vt();return s.persistence.runTransaction("Execute query","readwrite",(u=>(function(m,y,_){const T=ut(m),S=T.Ms.get(_);return S!==void 0?xe.resolve(T.Fs.get(S)):T.hi.getTargetData(y,_)})(s,u,Qs(e)).next((f=>{if(f)return a=f.lastLimboFreeSnapshotVersion,s.hi.getMatchingKeysForTargetId(u,f.targetId).next((m=>{l=m}))})).next((()=>s.Cs.getDocumentsMatchingQuery(u,e,t?a:ct.min(),t?l:vt()))).next((f=>(FN(s,SI(e),f),{documents:f,qs:l})))))}function FN(n,e,t){let s=n.xs.get(e)||ct.min();t.forEach(((a,l)=>{l.readTime.compareTo(s)>0&&(s=l.readTime)})),n.xs.set(e,s)}class Kv{constructor(){this.activeTargetIds=RI()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class UN{constructor(){this.Fo=new Kv,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,s){}addLocalQueryTarget(e,t=!0){return t&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,t,s){this.Mo[e]=t}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new Kv,Promise.resolve()}handleUserChange(e,t,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zN{xo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qv="ConnectivityMonitor";class Yv{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){Be(Qv,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){Be(Qv,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Su=null;function Yf(){return Su===null?Su=(function(){return 268435456+Math.round(2147483648*Math.random())})():Su++,"0x"+Su.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gf="RestConnection",BN={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class $N{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.$o=t+"://"+e.host,this.Uo=`projects/${s}/databases/${a}`,this.Ko=this.databaseId.database===Qu?`project_id=${s}`:`project_id=${s}&database_id=${a}`}Wo(e,t,s,a,l){const u=Yf(),f=this.Go(e,t.toUriEncodedString());Be(gf,`Sending RPC '${e}' ${u}:`,f,s);const m={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(m,a,l);const{host:y}=new URL(f),_=Qo(y);return this.jo(e,f,m,s,_).then((T=>(Be(gf,`Received RPC '${e}' ${u}: `,T),T)),(T=>{throw na(gf,`RPC '${e}' ${u} failed with error: `,T,"url: ",f,"request:",s),T}))}Jo(e,t,s,a,l,u){return this.Wo(e,t,s,a,l)}zo(e,t,s){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Zo})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((a,l)=>e[l]=a)),s&&s.headers.forEach(((a,l)=>e[l]=a))}Go(e,t){const s=BN[e];return`${this.$o}/v1/${t}:${s}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WN{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ir="WebChannelConnection";class GN extends $N{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,t,s,a,l){const u=Yf();return new Promise(((f,m)=>{const y=new F0;y.setWithCredentials(!0),y.listenOnce(U0.COMPLETE,(()=>{try{switch(y.getLastErrorCode()){case Au.NO_ERROR:const T=y.getResponseJson();Be(ir,`XHR for RPC '${e}' ${u} received:`,JSON.stringify(T)),f(T);break;case Au.TIMEOUT:Be(ir,`RPC '${e}' ${u} timed out`),m(new Ue(pe.DEADLINE_EXCEEDED,"Request time out"));break;case Au.HTTP_ERROR:const S=y.getStatus();if(Be(ir,`RPC '${e}' ${u} failed with status:`,S,"response text:",y.getResponseText()),S>0){let F=y.getResponseJson();Array.isArray(F)&&(F=F[0]);const J=F==null?void 0:F.error;if(J&&J.status&&J.message){const $=(function(se){const _e=se.toLowerCase().replace(/_/g,"-");return Object.values(pe).indexOf(_e)>=0?_e:pe.UNKNOWN})(J.status);m(new Ue($,J.message))}else m(new Ue(pe.UNKNOWN,"Server responded with status "+y.getStatus()))}else m(new Ue(pe.UNAVAILABLE,"Connection failed."));break;default:it(9055,{c_:e,streamId:u,l_:y.getLastErrorCode(),h_:y.getLastError()})}}finally{Be(ir,`RPC '${e}' ${u} completed.`)}}));const _=JSON.stringify(a);Be(ir,`RPC '${e}' ${u} sending request:`,a),y.send(t,"POST",_,s,15)}))}P_(e,t,s){const a=Yf(),l=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],u=$0(),f=B0(),m={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},y=this.longPollingOptions.timeoutSeconds;y!==void 0&&(m.longPollingTimeout=Math.round(1e3*y)),this.useFetchStreams&&(m.useFetchStreams=!0),this.zo(m.initMessageHeaders,t,s),m.encodeInitMessageHeaders=!0;const _=l.join("");Be(ir,`Creating RPC '${e}' stream ${a}: ${_}`,m);const T=u.createWebChannel(_,m);this.T_(T);let S=!1,F=!1;const J=new WN({Ho:B=>{F?Be(ir,`Not sending because RPC '${e}' stream ${a} is closed:`,B):(S||(Be(ir,`Opening RPC '${e}' stream ${a} transport.`),T.open(),S=!0),Be(ir,`RPC '${e}' stream ${a} sending:`,B),T.send(B))},Yo:()=>T.close()}),$=(B,se,_e)=>{B.listen(se,(ye=>{try{_e(ye)}catch(we){setTimeout((()=>{throw we}),0)}}))};return $(T,Vl.EventType.OPEN,(()=>{F||(Be(ir,`RPC '${e}' stream ${a} transport opened.`),J.s_())})),$(T,Vl.EventType.CLOSE,(()=>{F||(F=!0,Be(ir,`RPC '${e}' stream ${a} transport closed`),J.__(),this.I_(T))})),$(T,Vl.EventType.ERROR,(B=>{F||(F=!0,na(ir,`RPC '${e}' stream ${a} transport errored. Name:`,B.name,"Message:",B.message),J.__(new Ue(pe.UNAVAILABLE,"The operation could not be completed")))})),$(T,Vl.EventType.MESSAGE,(B=>{var se;if(!F){const _e=B.data[0];Rt(!!_e,16349);const ye=_e,we=(ye==null?void 0:ye.error)||((se=ye[0])===null||se===void 0?void 0:se.error);if(we){Be(ir,`RPC '${e}' stream ${a} received error:`,we);const O=we.status;let ae=(function(A){const U=wn[A];if(U!==void 0)return Sx(U)})(O),I=we.message;ae===void 0&&(ae=pe.INTERNAL,I="Unknown error status: "+O+" with message "+we.message),F=!0,J.__(new Ue(ae,I)),T.close()}else Be(ir,`RPC '${e}' stream ${a} received:`,_e),J.a_(_e)}})),$(f,z0.STAT_EVENT,(B=>{B.stat===Of.PROXY?Be(ir,`RPC '${e}' stream ${a} detected buffering proxy`):B.stat===Of.NOPROXY&&Be(ir,`RPC '${e}' stream ${a} detected no buffering proxy`)})),setTimeout((()=>{J.o_()}),0),J}terminate(){this.u_.forEach((e=>e.close())),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter((t=>t===e))}}function yf(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Td(n){return new QI(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ox{constructor(e,t,s=1e3,a=1.5,l=6e4){this.Fi=e,this.timerId=t,this.d_=s,this.E_=a,this.A_=l,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const t=Math.floor(this.R_+this.p_()),s=Math.max(0,Date.now()-this.m_),a=Math.max(0,t-s);a>0&&Be("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.R_} ms, delay with jitter: ${t} ms, last attempt: ${s} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,a,(()=>(this.m_=Date.now(),e()))),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jv="PersistentStream";class Fx{constructor(e,t,s,a,l,u,f,m){this.Fi=e,this.w_=s,this.S_=a,this.connection=l,this.authCredentialsProvider=u,this.appCheckCredentialsProvider=f,this.listener=m,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new Ox(e,t)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,(()=>this.L_())))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():t&&t.code===pe.RESOURCE_EXHAUSTED?(xi(t.toString()),xi("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):t&&t.code===pe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(t)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),t=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([s,a])=>{this.b_===t&&this.W_(s,a)}),(s=>{e((()=>{const a=new Ue(pe.UNKNOWN,"Fetching auth token failed: "+s.message);return this.G_(a)}))}))}W_(e,t){const s=this.K_(this.b_);this.stream=this.z_(e,t),this.stream.Zo((()=>{s((()=>this.listener.Zo()))})),this.stream.e_((()=>{s((()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,(()=>(this.x_()&&(this.state=3),Promise.resolve()))),this.listener.e_())))})),this.stream.n_((a=>{s((()=>this.G_(a)))})),this.stream.onMessage((a=>{s((()=>++this.C_==1?this.j_(a):this.onNext(a)))}))}O_(){this.state=5,this.F_.g_((async()=>{this.state=0,this.start()}))}G_(e){return Be(Jv,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return t=>{this.Fi.enqueueAndForget((()=>this.b_===e?t():(Be(Jv,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class qN extends Fx{constructor(e,t,s,a,l,u){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,s,a,u),this.serializer=l}z_(e,t){return this.connection.P_("Listen",e,t)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const t=XI(this.serializer,e),s=(function(l){if(!("targetChange"in l))return ct.min();const u=l.targetChange;return u.targetIds&&u.targetIds.length?ct.min():u.readTime?Ys(u.readTime):ct.min()})(e);return this.listener.J_(t,s)}H_(e){const t={};t.database=Kf(this.serializer),t.addTarget=(function(l,u){let f;const m=u.target;if(f=$f(m)?{documents:tN(l,m)}:{query:nN(l,m).Vt},f.targetId=u.targetId,u.resumeToken.approximateByteSize()>0){f.resumeToken=Ix(l,u.resumeToken);const y=Gf(l,u.expectedCount);y!==null&&(f.expectedCount=y)}else if(u.snapshotVersion.compareTo(ct.min())>0){f.readTime=ed(l,u.snapshotVersion.toTimestamp());const y=Gf(l,u.expectedCount);y!==null&&(f.expectedCount=y)}return f})(this.serializer,e);const s=sN(this.serializer,e);s&&(t.labels=s),this.k_(t)}Y_(e){const t={};t.database=Kf(this.serializer),t.removeTarget=e,this.k_(t)}}class HN extends Fx{constructor(e,t,s,a,l,u){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,s,a,u),this.serializer=l}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,t){return this.connection.P_("Write",e,t)}j_(e){return Rt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Rt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){Rt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();const t=eN(e.writeResults,e.commitTime),s=Ys(e.commitTime);return this.listener.ta(s,t)}na(){const e={};e.database=Kf(this.serializer),this.k_(e)}X_(e){const t={streamToken:this.lastStreamToken,writes:e.map((s=>ZI(this.serializer,s)))};this.k_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KN{}class QN extends KN{constructor(e,t,s,a){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=s,this.serializer=a,this.ra=!1}ia(){if(this.ra)throw new Ue(pe.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,s,a){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,u])=>this.connection.Wo(e,qf(t,s),a,l,u))).catch((l=>{throw l.name==="FirebaseError"?(l.code===pe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new Ue(pe.UNKNOWN,l.toString())}))}Jo(e,t,s,a,l){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,f])=>this.connection.Jo(e,qf(t,s),a,u,f,l))).catch((u=>{throw u.name==="FirebaseError"?(u.code===pe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new Ue(pe.UNKNOWN,u.toString())}))}terminate(){this.ra=!0,this.connection.terminate()}}class YN{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve()))))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(xi(t),this._a=!1):Be("OnlineStateTracker",t)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qa="RemoteStore";class JN{constructor(e,t,s,a,l){this.localStore=e,this.datastore=t,this.asyncQueue=s,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=l,this.Ea.xo((u=>{s.enqueueAndForget((async()=>{Ka(this)&&(Be(qa,"Restarting streams for network reachability change."),await(async function(m){const y=ut(m);y.Ia.add(4),await pc(y),y.Aa.set("Unknown"),y.Ia.delete(4),await Sd(y)})(this))}))})),this.Aa=new YN(s,a)}}async function Sd(n){if(Ka(n))for(const e of n.da)await e(!0)}async function pc(n){for(const e of n.da)await e(!1)}function Ux(n,e){const t=ut(n);t.Ta.has(e.targetId)||(t.Ta.set(e.targetId,e),Gp(t)?Wp(t):rl(t).x_()&&$p(t,e))}function Bp(n,e){const t=ut(n),s=rl(t);t.Ta.delete(e),s.x_()&&zx(t,e),t.Ta.size===0&&(s.x_()?s.B_():Ka(t)&&t.Aa.set("Unknown"))}function $p(n,e){if(n.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ct.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}rl(n).H_(e)}function zx(n,e){n.Ra.$e(e),rl(n).Y_(e)}function Wp(n){n.Ra=new GI({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>n.Ta.get(e)||null,lt:()=>n.datastore.serializer.databaseId}),rl(n).start(),n.Aa.aa()}function Gp(n){return Ka(n)&&!rl(n).M_()&&n.Ta.size>0}function Ka(n){return ut(n).Ia.size===0}function Bx(n){n.Ra=void 0}async function XN(n){n.Aa.set("Online")}async function ZN(n){n.Ta.forEach(((e,t)=>{$p(n,e)}))}async function eP(n,e){Bx(n),Gp(n)?(n.Aa.la(e),Wp(n)):n.Aa.set("Unknown")}async function tP(n,e,t){if(n.Aa.set("Online"),e instanceof Cx&&e.state===2&&e.cause)try{await(async function(a,l){const u=l.cause;for(const f of l.targetIds)a.Ta.has(f)&&(await a.remoteSyncer.rejectListen(f,u),a.Ta.delete(f),a.Ra.removeTarget(f))})(n,e)}catch(s){Be(qa,"Failed to remove targets %s: %s ",e.targetIds.join(","),s),await nd(n,s)}else if(e instanceof Vu?n.Ra.Ye(e):e instanceof bx?n.Ra.it(e):n.Ra.et(e),!t.isEqual(ct.min()))try{const s=await Mx(n.localStore);t.compareTo(s)>=0&&await(function(l,u){const f=l.Ra.Pt(u);return f.targetChanges.forEach(((m,y)=>{if(m.resumeToken.approximateByteSize()>0){const _=l.Ta.get(y);_&&l.Ta.set(y,_.withResumeToken(m.resumeToken,u))}})),f.targetMismatches.forEach(((m,y)=>{const _=l.Ta.get(m);if(!_)return;l.Ta.set(m,_.withResumeToken(Jn.EMPTY_BYTE_STRING,_.snapshotVersion)),zx(l,m);const T=new Qi(_.target,m,y,_.sequenceNumber);$p(l,T)})),l.remoteSyncer.applyRemoteEvent(f)})(n,t)}catch(s){Be(qa,"Failed to raise snapshot:",s),await nd(n,s)}}async function nd(n,e,t){if(!tl(e))throw e;n.Ia.add(1),await pc(n),n.Aa.set("Offline"),t||(t=()=>Mx(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{Be(qa,"Retrying IndexedDB access"),await t(),n.Ia.delete(1),await Sd(n)}))}function $x(n,e){return e().catch((t=>nd(n,t,e)))}async function bd(n){const e=ut(n),t=oa(e);let s=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:Np;for(;nP(e);)try{const a=await MN(e.localStore,s);if(a===null){e.Pa.length===0&&t.B_();break}s=a.batchId,rP(e,a)}catch(a){await nd(e,a)}Wx(e)&&Gx(e)}function nP(n){return Ka(n)&&n.Pa.length<10}function rP(n,e){n.Pa.push(e);const t=oa(n);t.x_()&&t.Z_&&t.X_(e.mutations)}function Wx(n){return Ka(n)&&!oa(n).M_()&&n.Pa.length>0}function Gx(n){oa(n).start()}async function sP(n){oa(n).na()}async function iP(n){const e=oa(n);for(const t of n.Pa)e.X_(t.mutations)}async function aP(n,e,t){const s=n.Pa.shift(),a=Vp.from(s,e,t);await $x(n,(()=>n.remoteSyncer.applySuccessfulWrite(a))),await bd(n)}async function oP(n,e){e&&oa(n).Z_&&await(async function(s,a){if((function(u){return $I(u)&&u!==pe.ABORTED})(a.code)){const l=s.Pa.shift();oa(s).N_(),await $x(s,(()=>s.remoteSyncer.rejectFailedWrite(l.batchId,a))),await bd(s)}})(n,e),Wx(n)&&Gx(n)}async function Xv(n,e){const t=ut(n);t.asyncQueue.verifyOperationInProgress(),Be(qa,"RemoteStore received new credentials");const s=Ka(t);t.Ia.add(3),await pc(t),s&&t.Aa.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ia.delete(3),await Sd(t)}async function lP(n,e){const t=ut(n);e?(t.Ia.delete(2),await Sd(t)):e||(t.Ia.add(2),await pc(t),t.Aa.set("Unknown"))}function rl(n){return n.Va||(n.Va=(function(t,s,a){const l=ut(t);return l.ia(),new qN(s,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(n.datastore,n.asyncQueue,{Zo:XN.bind(null,n),e_:ZN.bind(null,n),n_:eP.bind(null,n),J_:tP.bind(null,n)}),n.da.push((async e=>{e?(n.Va.N_(),Gp(n)?Wp(n):n.Aa.set("Unknown")):(await n.Va.stop(),Bx(n))}))),n.Va}function oa(n){return n.ma||(n.ma=(function(t,s,a){const l=ut(t);return l.ia(),new HN(s,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),e_:sP.bind(null,n),n_:oP.bind(null,n),ea:iP.bind(null,n),ta:aP.bind(null,n)}),n.da.push((async e=>{e?(n.ma.N_(),await bd(n)):(await n.ma.stop(),n.Pa.length>0&&(Be(qa,`Stopping write stream with ${n.Pa.length} pending writes`),n.Pa=[]))}))),n.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qp{constructor(e,t,s,a,l){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=s,this.op=a,this.removalCallback=l,this.deferred=new gi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((u=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,s,a,l){const u=Date.now()+s,f=new qp(e,t,u,a,l);return f.start(s),f}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ue(pe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Hp(n,e){if(xi("AsyncQueue",`${e}: ${n}`),tl(n))return new Ue(pe.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mo{static emptySet(e){return new Mo(e.comparator)}constructor(e){this.comparator=e?(t,s)=>e(t,s)||Xe.comparator(t.key,s.key):(t,s)=>Xe.comparator(t.key,s.key),this.keyedMap=Ll(),this.sortedSet=new Xt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,s)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Mo)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=s.getNext().key;if(!a.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const s=new Mo;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=t,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zv{constructor(){this.fa=new Xt(Xe.comparator)}track(e){const t=e.doc.key,s=this.fa.get(t);s?e.type!==0&&s.type===3?this.fa=this.fa.insert(t,e):e.type===3&&s.type!==1?this.fa=this.fa.insert(t,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.fa=this.fa.insert(t,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.fa=this.fa.remove(t):e.type===1&&s.type===2?this.fa=this.fa.insert(t,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):it(63341,{At:e,ga:s}):this.fa=this.fa.insert(t,e)}pa(){const e=[];return this.fa.inorderTraversal(((t,s)=>{e.push(s)})),e}}class Wo{constructor(e,t,s,a,l,u,f,m,y){this.query=e,this.docs=t,this.oldDocs=s,this.docChanges=a,this.mutatedKeys=l,this.fromCache=u,this.syncStateChanged=f,this.excludesMetadataChanges=m,this.hasCachedResults=y}static fromInitialDocuments(e,t,s,a,l){const u=[];return t.forEach((f=>{u.push({type:0,doc:f})})),new Wo(e,t,Mo.emptySet(t),u,s,a,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&vd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,s=e.docChanges;if(t.length!==s.length)return!1;for(let a=0;a<t.length;a++)if(t[a].type!==s[a].type||!t[a].doc.isEqual(s[a].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cP{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some((e=>e.ba()))}}class uP{constructor(){this.queries=e_(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(t,s){const a=ut(t),l=a.queries;a.queries=e_(),l.forEach(((u,f)=>{for(const m of f.wa)m.onError(s)}))})(this,new Ue(pe.ABORTED,"Firestore shutting down"))}}function e_(){return new Ha((n=>hx(n)),vd)}async function Kp(n,e){const t=ut(n);let s=3;const a=e.query;let l=t.queries.get(a);l?!l.Sa()&&e.ba()&&(s=2):(l=new cP,s=e.ba()?0:1);try{switch(s){case 0:l.ya=await t.onListen(a,!0);break;case 1:l.ya=await t.onListen(a,!1);break;case 2:await t.onFirstRemoteStoreListen(a)}}catch(u){const f=Hp(u,`Initialization of query '${Ao(e.query)}' failed`);return void e.onError(f)}t.queries.set(a,l),l.wa.push(e),e.va(t.onlineState),l.ya&&e.Ca(l.ya)&&Yp(t)}async function Qp(n,e){const t=ut(n),s=e.query;let a=3;const l=t.queries.get(s);if(l){const u=l.wa.indexOf(e);u>=0&&(l.wa.splice(u,1),l.wa.length===0?a=e.ba()?0:1:!l.Sa()&&e.ba()&&(a=2))}switch(a){case 0:return t.queries.delete(s),t.onUnlisten(s,!0);case 1:return t.queries.delete(s),t.onUnlisten(s,!1);case 2:return t.onLastRemoteStoreUnlisten(s);default:return}}function dP(n,e){const t=ut(n);let s=!1;for(const a of e){const l=a.query,u=t.queries.get(l);if(u){for(const f of u.wa)f.Ca(a)&&(s=!0);u.ya=a}}s&&Yp(t)}function hP(n,e,t){const s=ut(n),a=s.queries.get(e);if(a)for(const l of a.wa)l.onError(t);s.queries.delete(e)}function Yp(n){n.Da.forEach((e=>{e.next()}))}var Jf,t_;(t_=Jf||(Jf={})).Fa="default",t_.Cache="cache";class Jp{constructor(e,t,s){this.query=e,this.Ma=t,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=s||{}}Ca(e){if(!this.options.includeMetadataChanges){const s=[];for(const a of e.docChanges)a.type!==3&&s.push(a);e=new Wo(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),t=!0):this.Ba(e,this.onlineState)&&(this.La(e),t=!0),this.Oa=e,t}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let t=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),t=!0),t}Ba(e,t){if(!e.fromCache||!this.ba())return!0;const s=t!=="Offline";return(!this.options.ka||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Na(e){if(e.docChanges.length>0)return!0;const t=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}La(e){e=Wo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==Jf.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qx{constructor(e){this.key=e}}class Hx{constructor(e){this.key=e}}class fP{constructor(e,t){this.query=e,this.Ha=t,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=vt(),this.mutatedKeys=vt(),this.Xa=fx(e),this.eu=new Mo(this.Xa)}get tu(){return this.Ha}nu(e,t){const s=t?t.ru:new Zv,a=t?t.eu:this.eu;let l=t?t.mutatedKeys:this.mutatedKeys,u=a,f=!1;const m=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,y=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal(((_,T)=>{const S=a.get(_),F=_d(this.query,T)?T:null,J=!!S&&this.mutatedKeys.has(S.key),$=!!F&&(F.hasLocalMutations||this.mutatedKeys.has(F.key)&&F.hasCommittedMutations);let B=!1;S&&F?S.data.isEqual(F.data)?J!==$&&(s.track({type:3,doc:F}),B=!0):this.iu(S,F)||(s.track({type:2,doc:F}),B=!0,(m&&this.Xa(F,m)>0||y&&this.Xa(F,y)<0)&&(f=!0)):!S&&F?(s.track({type:0,doc:F}),B=!0):S&&!F&&(s.track({type:1,doc:S}),B=!0,(m||y)&&(f=!0)),B&&(F?(u=u.add(F),l=$?l.add(_):l.delete(_)):(u=u.delete(_),l=l.delete(_)))})),this.query.limit!==null)for(;u.size>this.query.limit;){const _=this.query.limitType==="F"?u.last():u.first();u=u.delete(_.key),l=l.delete(_.key),s.track({type:1,doc:_})}return{eu:u,ru:s,Ds:f,mutatedKeys:l}}iu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,s,a){const l=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const u=e.ru.pa();u.sort(((_,T)=>(function(F,J){const $=B=>{switch(B){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return it(20277,{At:B})}};return $(F)-$(J)})(_.type,T.type)||this.Xa(_.doc,T.doc))),this.su(s),a=a!=null&&a;const f=t&&!a?this.ou():[],m=this.Za.size===0&&this.current&&!a?1:0,y=m!==this.Ya;return this.Ya=m,u.length!==0||y?{snapshot:new Wo(this.query,e.eu,l,u,e.mutatedKeys,m===0,y,!1,!!s&&s.resumeToken.approximateByteSize()>0),_u:f}:{_u:f}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new Zv,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach((t=>this.Ha=this.Ha.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ha=this.Ha.delete(t))),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=vt(),this.eu.forEach((s=>{this.au(s.key)&&(this.Za=this.Za.add(s.key))}));const t=[];return e.forEach((s=>{this.Za.has(s)||t.push(new Hx(s))})),this.Za.forEach((s=>{e.has(s)||t.push(new qx(s))})),t}uu(e){this.Ha=e.qs,this.Za=vt();const t=this.nu(e.documents);return this.applyChanges(t,!0)}cu(){return Wo.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const Xp="SyncEngine";class pP{constructor(e,t,s){this.query=e,this.targetId=t,this.view=s}}class mP{constructor(e){this.key=e,this.lu=!1}}class gP{constructor(e,t,s,a,l,u){this.localStore=e,this.remoteStore=t,this.eventManager=s,this.sharedClientState=a,this.currentUser=l,this.maxConcurrentLimboResolutions=u,this.hu={},this.Pu=new Ha((f=>hx(f)),vd),this.Tu=new Map,this.Iu=new Set,this.du=new Xt(Xe.comparator),this.Eu=new Map,this.Au=new Op,this.Ru={},this.Vu=new Map,this.mu=$o.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function yP(n,e,t=!0){const s=Zx(n);let a;const l=s.Pu.get(e);return l?(s.sharedClientState.addLocalQueryTarget(l.targetId),a=l.view.cu()):a=await Kx(s,e,t,!0),a}async function vP(n,e){const t=Zx(n);await Kx(t,e,!0,!1)}async function Kx(n,e,t,s){const a=await ON(n.localStore,Qs(e)),l=a.targetId,u=n.sharedClientState.addLocalQueryTarget(l,t);let f;return s&&(f=await _P(n,e,l,u==="current",a.resumeToken)),n.isPrimaryClient&&t&&Ux(n.remoteStore,a),f}async function _P(n,e,t,s,a){n.gu=(T,S,F)=>(async function($,B,se,_e){let ye=B.view.nu(se);ye.Ds&&(ye=await Hv($.localStore,B.query,!1).then((({documents:I})=>B.view.nu(I,ye))));const we=_e&&_e.targetChanges.get(B.targetId),O=_e&&_e.targetMismatches.get(B.targetId)!=null,ae=B.view.applyChanges(ye,$.isPrimaryClient,we,O);return r_($,B.targetId,ae._u),ae.snapshot})(n,T,S,F);const l=await Hv(n.localStore,e,!0),u=new fP(e,l.qs),f=u.nu(l.documents),m=fc.createSynthesizedTargetChangeForCurrentChange(t,s&&n.onlineState!=="Offline",a),y=u.applyChanges(f,n.isPrimaryClient,m);r_(n,t,y._u);const _=new pP(e,t,u);return n.Pu.set(e,_),n.Tu.has(t)?n.Tu.get(t).push(e):n.Tu.set(t,[e]),y.snapshot}async function xP(n,e,t){const s=ut(n),a=s.Pu.get(e),l=s.Tu.get(a.targetId);if(l.length>1)return s.Tu.set(a.targetId,l.filter((u=>!vd(u,e)))),void s.Pu.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(a.targetId),s.sharedClientState.isActiveQueryTarget(a.targetId)||await Qf(s.localStore,a.targetId,!1).then((()=>{s.sharedClientState.clearQueryState(a.targetId),t&&Bp(s.remoteStore,a.targetId),Xf(s,a.targetId)})).catch(el)):(Xf(s,a.targetId),await Qf(s.localStore,a.targetId,!0))}async function wP(n,e){const t=ut(n),s=t.Pu.get(e),a=t.Tu.get(s.targetId);t.isPrimaryClient&&a.length===1&&(t.sharedClientState.removeLocalQueryTarget(s.targetId),Bp(t.remoteStore,s.targetId))}async function EP(n,e,t){const s=PP(n);try{const a=await(function(u,f){const m=ut(u),y=Gt.now(),_=f.reduce(((F,J)=>F.add(J.key)),vt());let T,S;return m.persistence.runTransaction("Locally write mutations","readwrite",(F=>{let J=wi(),$=vt();return m.Os.getEntries(F,_).next((B=>{J=B,J.forEach(((se,_e)=>{_e.isValidDocument()||($=$.add(se))}))})).next((()=>m.localDocuments.getOverlayedDocuments(F,J))).next((B=>{T=B;const se=[];for(const _e of f){const ye=OI(_e,T.get(_e.key).overlayedDocument);ye!=null&&se.push(new pa(_e.key,ye,sx(ye.value.mapValue),gs.exists(!0)))}return m.mutationQueue.addMutationBatch(F,y,se,f)})).next((B=>{S=B;const se=B.applyToLocalDocumentSet(T,$);return m.documentOverlayCache.saveOverlays(F,B.batchId,se)}))})).then((()=>({batchId:S.batchId,changes:mx(T)})))})(s.localStore,e);s.sharedClientState.addPendingMutation(a.batchId),(function(u,f,m){let y=u.Ru[u.currentUser.toKey()];y||(y=new Xt(ft)),y=y.insert(f,m),u.Ru[u.currentUser.toKey()]=y})(s,a.batchId,t),await mc(s,a.changes),await bd(s.remoteStore)}catch(a){const l=Hp(a,"Failed to persist write");t.reject(l)}}async function Qx(n,e){const t=ut(n);try{const s=await VN(t.localStore,e);e.targetChanges.forEach(((a,l)=>{const u=t.Eu.get(l);u&&(Rt(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?u.lu=!0:a.modifiedDocuments.size>0?Rt(u.lu,14607):a.removedDocuments.size>0&&(Rt(u.lu,42227),u.lu=!1))})),await mc(t,s,e)}catch(s){await el(s)}}function n_(n,e,t){const s=ut(n);if(s.isPrimaryClient&&t===0||!s.isPrimaryClient&&t===1){const a=[];s.Pu.forEach(((l,u)=>{const f=u.view.va(e);f.snapshot&&a.push(f.snapshot)})),(function(u,f){const m=ut(u);m.onlineState=f;let y=!1;m.queries.forEach(((_,T)=>{for(const S of T.wa)S.va(f)&&(y=!0)})),y&&Yp(m)})(s.eventManager,e),a.length&&s.hu.J_(a),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function TP(n,e,t){const s=ut(n);s.sharedClientState.updateQueryState(e,"rejected",t);const a=s.Eu.get(e),l=a&&a.key;if(l){let u=new Xt(Xe.comparator);u=u.insert(l,or.newNoDocument(l,ct.min()));const f=vt().add(l),m=new Ed(ct.min(),new Map,new Xt(ft),u,f);await Qx(s,m),s.du=s.du.remove(l),s.Eu.delete(e),Zp(s)}else await Qf(s.localStore,e,!1).then((()=>Xf(s,e,t))).catch(el)}async function SP(n,e){const t=ut(n),s=e.batch.batchId;try{const a=await DN(t.localStore,e);Jx(t,s,null),Yx(t,s),t.sharedClientState.updateMutationState(s,"acknowledged"),await mc(t,a)}catch(a){await el(a)}}async function bP(n,e,t){const s=ut(n);try{const a=await(function(u,f){const m=ut(u);return m.persistence.runTransaction("Reject batch","readwrite-primary",(y=>{let _;return m.mutationQueue.lookupMutationBatch(y,f).next((T=>(Rt(T!==null,37113),_=T.keys(),m.mutationQueue.removeMutationBatch(y,T)))).next((()=>m.mutationQueue.performConsistencyCheck(y))).next((()=>m.documentOverlayCache.removeOverlaysForBatchId(y,_,f))).next((()=>m.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(y,_))).next((()=>m.localDocuments.getDocuments(y,_)))}))})(s.localStore,e);Jx(s,e,t),Yx(s,e),s.sharedClientState.updateMutationState(e,"rejected",t),await mc(s,a)}catch(a){await el(a)}}function Yx(n,e){(n.Vu.get(e)||[]).forEach((t=>{t.resolve()})),n.Vu.delete(e)}function Jx(n,e,t){const s=ut(n);let a=s.Ru[s.currentUser.toKey()];if(a){const l=a.get(e);l&&(t?l.reject(t):l.resolve(),a=a.remove(e)),s.Ru[s.currentUser.toKey()]=a}}function Xf(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const s of n.Tu.get(e))n.Pu.delete(s),t&&n.hu.pu(s,t);n.Tu.delete(e),n.isPrimaryClient&&n.Au.zr(e).forEach((s=>{n.Au.containsKey(s)||Xx(n,s)}))}function Xx(n,e){n.Iu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(Bp(n.remoteStore,t),n.du=n.du.remove(e),n.Eu.delete(t),Zp(n))}function r_(n,e,t){for(const s of t)s instanceof qx?(n.Au.addReference(s.key,e),CP(n,s)):s instanceof Hx?(Be(Xp,"Document no longer in limbo: "+s.key),n.Au.removeReference(s.key,e),n.Au.containsKey(s.key)||Xx(n,s.key)):it(19791,{yu:s})}function CP(n,e){const t=e.key,s=t.path.canonicalString();n.du.get(t)||n.Iu.has(s)||(Be(Xp,"New document in limbo: "+t),n.Iu.add(s),Zp(n))}function Zp(n){for(;n.Iu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Iu.values().next().value;n.Iu.delete(e);const t=new Xe(Ut.fromString(e)),s=n.mu.next();n.Eu.set(s,new mP(t)),n.du=n.du.insert(t,s),Ux(n.remoteStore,new Qi(Qs(yd(t.path)),s,"TargetPurposeLimboResolution",pd.ue))}}async function mc(n,e,t){const s=ut(n),a=[],l=[],u=[];s.Pu.isEmpty()||(s.Pu.forEach(((f,m)=>{u.push(s.gu(m,e,t).then((y=>{var _;if((y||t)&&s.isPrimaryClient){const T=y?!y.fromCache:(_=t==null?void 0:t.targetChanges.get(m.targetId))===null||_===void 0?void 0:_.current;s.sharedClientState.updateQueryState(m.targetId,T?"current":"not-current")}if(y){a.push(y);const T=Up.Es(m.targetId,y);l.push(T)}})))})),await Promise.all(u),s.hu.J_(a),await(async function(m,y){const _=ut(m);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",(T=>xe.forEach(y,(S=>xe.forEach(S.Is,(F=>_.persistence.referenceDelegate.addReference(T,S.targetId,F))).next((()=>xe.forEach(S.ds,(F=>_.persistence.referenceDelegate.removeReference(T,S.targetId,F)))))))))}catch(T){if(!tl(T))throw T;Be(zp,"Failed to update sequence numbers: "+T)}for(const T of y){const S=T.targetId;if(!T.fromCache){const F=_.Fs.get(S),J=F.snapshotVersion,$=F.withLastLimboFreeSnapshotVersion(J);_.Fs=_.Fs.insert(S,$)}}})(s.localStore,l))}async function IP(n,e){const t=ut(n);if(!t.currentUser.isEqual(e)){Be(Xp,"User change. New user:",e.toKey());const s=await Lx(t.localStore,e);t.currentUser=e,(function(l,u){l.Vu.forEach((f=>{f.forEach((m=>{m.reject(new Ue(pe.CANCELLED,u))}))})),l.Vu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await mc(t,s.Bs)}}function NP(n,e){const t=ut(n),s=t.Eu.get(e);if(s&&s.lu)return vt().add(s.key);{let a=vt();const l=t.Tu.get(e);if(!l)return a;for(const u of l){const f=t.Pu.get(u);a=a.unionWith(f.view.tu)}return a}}function Zx(n){const e=ut(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Qx.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=NP.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=TP.bind(null,e),e.hu.J_=dP.bind(null,e.eventManager),e.hu.pu=hP.bind(null,e.eventManager),e}function PP(n){const e=ut(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=SP.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=bP.bind(null,e),e}class rd{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Td(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,t){return null}Fu(e,t){return null}vu(e){return kN(this.persistence,new RN,e.initialUser,this.serializer)}Du(e){return new Vx(Fp.Vi,this.serializer)}bu(e){return new UN}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}rd.provider={build:()=>new rd};class RP extends rd{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,t){Rt(this.persistence.referenceDelegate instanceof td,46915);const s=this.persistence.referenceDelegate.garbageCollector;return new mN(s,e.asyncQueue,t)}Du(e){const t=this.cacheSizeBytes!==void 0?Ar.withCacheSize(this.cacheSizeBytes):Ar.DEFAULT;return new Vx((s=>td.Vi(s,t)),this.serializer)}}class Zf{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>n_(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=IP.bind(null,this.syncEngine),await lP(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new uP})()}createDatastore(e){const t=Td(e.databaseInfo.databaseId),s=(function(l){return new GN(l)})(e.databaseInfo);return(function(l,u,f,m){return new QN(l,u,f,m)})(e.authCredentials,e.appCheckCredentials,s,t)}createRemoteStore(e){return(function(s,a,l,u,f){return new JN(s,a,l,u,f)})(this.localStore,this.datastore,e.asyncQueue,(t=>n_(this.syncEngine,t,0)),(function(){return Yv.C()?new Yv:new zN})())}createSyncEngine(e,t){return(function(a,l,u,f,m,y,_){const T=new gP(a,l,u,f,m,y);return _&&(T.fu=!0),T})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(a){const l=ut(a);Be(qa,"RemoteStore shutting down."),l.Ia.add(5),await pc(l),l.Ea.shutdown(),l.Aa.set("Unknown")})(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}Zf.provider={build:()=>new Zf};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class em{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):xi("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const la="FirestoreClient";class AP{constructor(e,t,s,a,l){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=s,this.databaseInfo=a,this.user=ar.UNAUTHENTICATED,this.clientId=Ip.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(s,(async u=>{Be(la,"Received user=",u.uid),await this.authCredentialListener(u),this.user=u})),this.appCheckCredentials.start(s,(u=>(Be(la,"Received new app check token=",u),this.appCheckCredentialListener(u,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new gi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const s=Hp(t,"Failed to shutdown persistence");e.reject(s)}})),e.promise}}async function vf(n,e){n.asyncQueue.verifyOperationInProgress(),Be(la,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let s=t.initialUser;n.setCredentialChangeListener((async a=>{s.isEqual(a)||(await Lx(e.localStore,a),s=a)})),e.persistence.setDatabaseDeletedListener((()=>{na("Terminating Firestore due to IndexedDb database deletion"),n.terminate().then((()=>{Be("Terminating Firestore due to IndexedDb database deletion completed successfully")})).catch((a=>{na("Terminating Firestore due to IndexedDb database deletion failed",a)}))})),n._offlineComponents=e}async function s_(n,e){n.asyncQueue.verifyOperationInProgress();const t=await jP(n);Be(la,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((s=>Xv(e.remoteStore,s))),n.setAppCheckTokenChangeListener(((s,a)=>Xv(e.remoteStore,a))),n._onlineComponents=e}async function jP(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Be(la,"Using user provided OfflineComponentProvider");try{await vf(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(a){return a.name==="FirebaseError"?a.code===pe.FAILED_PRECONDITION||a.code===pe.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11})(t))throw t;na("Error using user provided cache. Falling back to memory cache: "+t),await vf(n,new rd)}}else Be(la,"Using default OfflineComponentProvider"),await vf(n,new RP(void 0));return n._offlineComponents}async function ew(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Be(la,"Using user provided OnlineComponentProvider"),await s_(n,n._uninitializedComponentsProvider._online)):(Be(la,"Using default OnlineComponentProvider"),await s_(n,new Zf))),n._onlineComponents}function kP(n){return ew(n).then((e=>e.syncEngine))}async function sd(n){const e=await ew(n),t=e.eventManager;return t.onListen=yP.bind(null,e.syncEngine),t.onUnlisten=xP.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=vP.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=wP.bind(null,e.syncEngine),t}function DP(n,e,t={}){const s=new gi;return n.asyncQueue.enqueueAndForget((async()=>(function(l,u,f,m,y){const _=new em({next:S=>{_.Ou(),u.enqueueAndForget((()=>Qp(l,T)));const F=S.docs.has(f);!F&&S.fromCache?y.reject(new Ue(pe.UNAVAILABLE,"Failed to get document because the client is offline.")):F&&S.fromCache&&m&&m.source==="server"?y.reject(new Ue(pe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):y.resolve(S)},error:S=>y.reject(S)}),T=new Jp(yd(f.path),_,{includeMetadataChanges:!0,ka:!0});return Kp(l,T)})(await sd(n),n.asyncQueue,e,t,s))),s.promise}function VP(n,e,t={}){const s=new gi;return n.asyncQueue.enqueueAndForget((async()=>(function(l,u,f,m,y){const _=new em({next:S=>{_.Ou(),u.enqueueAndForget((()=>Qp(l,T))),S.fromCache&&m.source==="server"?y.reject(new Ue(pe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):y.resolve(S)},error:S=>y.reject(S)}),T=new Jp(f,_,{includeMetadataChanges:!0,ka:!0});return Kp(l,T)})(await sd(n),n.asyncQueue,e,t,s))),s.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tw(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i_=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nw="firestore.googleapis.com",a_=!0;class o_{constructor(e){var t,s;if(e.host===void 0){if(e.ssl!==void 0)throw new Ue(pe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=nw,this.ssl=a_}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:a_;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Dx;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<fN)throw new Ue(pe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}JC("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=tw((s=e.experimentalLongPollingOptions)!==null&&s!==void 0?s:{}),(function(l){if(l.timeoutSeconds!==void 0){if(isNaN(l.timeoutSeconds))throw new Ue(pe.INVALID_ARGUMENT,`invalid long polling timeout: ${l.timeoutSeconds} (must not be NaN)`);if(l.timeoutSeconds<5)throw new Ue(pe.INVALID_ARGUMENT,`invalid long polling timeout: ${l.timeoutSeconds} (minimum allowed value is 5)`);if(l.timeoutSeconds>30)throw new Ue(pe.INVALID_ARGUMENT,`invalid long polling timeout: ${l.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(s,a){return s.timeoutSeconds===a.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Cd{constructor(e,t,s,a){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=s,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new o_({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ue(pe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ue(pe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new o_(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(s){if(!s)return new BC;switch(s.type){case"firstParty":return new qC(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new Ue(pe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const s=i_.get(t);s&&(Be("ComponentProvider","Removing Datastore"),i_.delete(t),s.terminate())})(this),Promise.resolve()}}function LP(n,e,t,s={}){var a;n=kr(n,Cd);const l=Qo(e),u=n._getSettings(),f=Object.assign(Object.assign({},u),{emulatorOptions:n._getEmulatorOptions()}),m=`${e}:${t}`;l&&(H_(`https://${m}`),K_("Firestore",!0)),u.host!==nw&&u.host!==m&&na("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const y=Object.assign(Object.assign({},u),{host:m,ssl:l,emulatorOptions:s});if(!Ba(y,f)&&(n._setSettings(y),s.mockUserToken)){let _,T;if(typeof s.mockUserToken=="string")_=s.mockUserToken,T=ar.MOCK_USER;else{_=Y1(s.mockUserToken,(a=n._app)===null||a===void 0?void 0:a.options.projectId);const S=s.mockUserToken.sub||s.mockUserToken.user_id;if(!S)throw new Ue(pe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");T=new ar(S)}n._authCredentials=new $C(new G0(_,T))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Si{constructor(e,t,s){this.converter=t,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new Si(this.firestore,e,this._query)}}class on{constructor(e,t,s){this.converter=t,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ta(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new on(this.firestore,e,this._key)}toJSON(){return{type:on._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,s){if(dc(t,on._jsonSchema))return new on(e,s||null,new Xe(Ut.fromString(t.referencePath)))}}on._jsonSchemaVersion="firestore/documentReference/1.0",on._jsonSchema={type:Tn("string",on._jsonSchemaVersion),referencePath:Tn("string")};class ta extends Si{constructor(e,t,s){super(e,t,yd(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new on(this.firestore,null,new Xe(e))}withConverter(e){return new ta(this.firestore,e,this._path)}}function An(n,e,...t){if(n=ln(n),H0("collection","path",e),n instanceof Cd){const s=Ut.fromString(e,...t);return xv(s),new ta(n,null,s)}{if(!(n instanceof on||n instanceof ta))throw new Ue(pe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(Ut.fromString(e,...t));return xv(s),new ta(n.firestore,null,s)}}function bt(n,e,...t){if(n=ln(n),arguments.length===1&&(e=Ip.newId()),H0("doc","path",e),n instanceof Cd){const s=Ut.fromString(e,...t);return _v(s),new on(n,null,new Xe(s))}{if(!(n instanceof on||n instanceof ta))throw new Ue(pe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(Ut.fromString(e,...t));return _v(s),new on(n.firestore,n instanceof ta?n.converter:null,new Xe(s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l_="AsyncQueue";class c_{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new Ox(this,"async_queue_retry"),this.oc=()=>{const s=yf();s&&Be(l_,"Visibility state changed to "+s.visibilityState),this.F_.y_()},this._c=e;const t=yf();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const t=yf();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise((()=>{}));const t=new gi;return this.uc((()=>this.Xu&&this.rc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Zu.push(e),this.cc())))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!tl(e))throw e;Be(l_,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_((()=>this.cc()))}}uc(e){const t=this._c.then((()=>(this.nc=!0,e().catch((s=>{throw this.tc=s,this.nc=!1,xi("INTERNAL UNHANDLED ERROR: ",u_(s)),s})).then((s=>(this.nc=!1,s))))));return this._c=t,t}enqueueAfterDelay(e,t,s){this.ac(),this.sc.indexOf(e)>-1&&(t=0);const a=qp.createAndSchedule(this,e,t,s,(l=>this.lc(l)));return this.ec.push(a),a}ac(){this.tc&&it(47125,{hc:u_(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(const t of this.ec)if(t.timerId===e)return!0;return!1}Ic(e){return this.Pc().then((()=>{this.ec.sort(((t,s)=>t.targetTimeMs-s.targetTimeMs));for(const t of this.ec)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Pc()}))}dc(e){this.sc.push(e)}lc(e){const t=this.ec.indexOf(e);this.ec.splice(t,1)}}function u_(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d_(n){return(function(t,s){if(typeof t!="object"||t===null)return!1;const a=t;for(const l of s)if(l in a&&typeof a[l]=="function")return!0;return!1})(n,["next","error","complete"])}class Ei extends Cd{constructor(e,t,s,a){super(e,t,s,a),this.type="firestore",this._queue=new c_,this._persistenceKey=(a==null?void 0:a.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new c_(e),this._firestoreClient=void 0,await e}}}function MP(n,e){const t=typeof n=="object"?n:X_(),s=typeof n=="string"?n:Qu,a=pp(t,"firestore").getImmediate({identifier:s});if(!a._initialized){const l=K1("firestore");l&&LP(a,...l)}return a}function Id(n){if(n._terminated)throw new Ue(pe.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||OP(n),n._firestoreClient}function OP(n){var e,t,s;const a=n._freezeSettings(),l=(function(f,m,y,_){return new lI(f,m,y,_.host,_.ssl,_.experimentalForceLongPolling,_.experimentalAutoDetectLongPolling,tw(_.experimentalLongPollingOptions),_.useFetchStreams,_.isUsingEmulator)})(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,a);n._componentsProvider||!((t=a.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((s=a.localCache)===null||s===void 0)&&s._onlineComponentProvider)&&(n._componentsProvider={_offline:a.localCache._offlineComponentProvider,_online:a.localCache._onlineComponentProvider}),n._firestoreClient=new AP(n._authCredentials,n._appCheckCredentials,n._queue,l,n._componentsProvider&&(function(f){const m=f==null?void 0:f._online.build();return{_offline:f==null?void 0:f._offline.build(m),_online:m}})(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ps{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ps(Jn.fromBase64String(e))}catch(t){throw new Ue(pe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new ps(Jn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ps._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(dc(e,ps._jsonSchema))return ps.fromBase64String(e.bytes)}}ps._jsonSchemaVersion="firestore/bytes/1.0",ps._jsonSchema={type:Tn("string",ps._jsonSchemaVersion),bytes:Tn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nd{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ue(pe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Yn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pd{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Js{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ue(pe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ue(pe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return ft(this._lat,e._lat)||ft(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Js._jsonSchemaVersion}}static fromJSON(e){if(dc(e,Js._jsonSchema))return new Js(e.latitude,e.longitude)}}Js._jsonSchemaVersion="firestore/geoPoint/1.0",Js._jsonSchema={type:Tn("string",Js._jsonSchemaVersion),latitude:Tn("number"),longitude:Tn("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xs{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(s,a){if(s.length!==a.length)return!1;for(let l=0;l<s.length;++l)if(s[l]!==a[l])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Xs._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(dc(e,Xs._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Xs(e.vectorValues);throw new Ue(pe.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Xs._jsonSchemaVersion="firestore/vectorValue/1.0",Xs._jsonSchema={type:Tn("string",Xs._jsonSchemaVersion),vectorValues:Tn("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FP=/^__.*__$/;class UP{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return this.fieldMask!==null?new pa(e,this.data,this.fieldMask,t,this.fieldTransforms):new hc(e,this.data,t,this.fieldTransforms)}}class rw{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return new pa(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function sw(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw it(40011,{Ec:n})}}class tm{constructor(e,t,s,a,l,u){this.settings=e,this.databaseId=t,this.serializer=s,this.ignoreUndefinedProperties=a,l===void 0&&this.Ac(),this.fieldTransforms=l||[],this.fieldMask=u||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new tm(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var t;const s=(t=this.path)===null||t===void 0?void 0:t.child(e),a=this.Rc({path:s,mc:!1});return a.fc(e),a}gc(e){var t;const s=(t=this.path)===null||t===void 0?void 0:t.child(e),a=this.Rc({path:s,mc:!1});return a.Ac(),a}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return id(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(sw(this.Ec)&&FP.test(e))throw this.wc('Document fields cannot begin and end with "__"')}}class zP{constructor(e,t,s){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=s||Td(e)}Dc(e,t,s,a=!1){return new tm({Ec:e,methodName:t,bc:s,path:Yn.emptyPath(),mc:!1,Sc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Rd(n){const e=n._freezeSettings(),t=Td(n._databaseId);return new zP(n._databaseId,!!e.ignoreUndefinedProperties,t)}function iw(n,e,t,s,a,l={}){const u=n.Dc(l.merge||l.mergeFields?2:0,e,t,a);rm("Data must be an object, but it was:",u,s);const f=aw(s,u);let m,y;if(l.merge)m=new Kr(u.fieldMask),y=u.fieldTransforms;else if(l.mergeFields){const _=[];for(const T of l.mergeFields){const S=ep(e,T,t);if(!u.contains(S))throw new Ue(pe.INVALID_ARGUMENT,`Field '${S}' is specified in your field mask but missing from your input data.`);lw(_,S)||_.push(S)}m=new Kr(_),y=u.fieldTransforms.filter((T=>m.covers(T.field)))}else m=null,y=u.fieldTransforms;return new UP(new jr(f),m,y)}class gc extends Pd{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof gc}}class nm extends Pd{_toFieldTransform(e){return new DI(e.path,new nc)}isEqual(e){return e instanceof nm}}function BP(n,e,t,s){const a=n.Dc(1,e,t);rm("Data must be an object, but it was:",a,s);const l=[],u=jr.empty();fa(s,((m,y)=>{const _=sm(e,m,t);y=ln(y);const T=a.gc(_);if(y instanceof gc)l.push(_);else{const S=yc(y,T);S!=null&&(l.push(_),u.set(_,S))}}));const f=new Kr(l);return new rw(u,f,a.fieldTransforms)}function $P(n,e,t,s,a,l){const u=n.Dc(1,e,t),f=[ep(e,s,t)],m=[a];if(l.length%2!=0)throw new Ue(pe.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let S=0;S<l.length;S+=2)f.push(ep(e,l[S])),m.push(l[S+1]);const y=[],_=jr.empty();for(let S=f.length-1;S>=0;--S)if(!lw(y,f[S])){const F=f[S];let J=m[S];J=ln(J);const $=u.gc(F);if(J instanceof gc)y.push(F);else{const B=yc(J,$);B!=null&&(y.push(F),_.set(F,B))}}const T=new Kr(y);return new rw(_,T,u.fieldTransforms)}function WP(n,e,t,s=!1){return yc(t,n.Dc(s?4:3,e))}function yc(n,e){if(ow(n=ln(n)))return rm("Unsupported field value:",e,n),aw(n,e);if(n instanceof Pd)return(function(s,a){if(!sw(a.Ec))throw a.wc(`${s._methodName}() can only be used with update() and set()`);if(!a.path)throw a.wc(`${s._methodName}() is not currently supported inside arrays`);const l=s._toFieldTransform(a);l&&a.fieldTransforms.push(l)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return(function(s,a){const l=[];let u=0;for(const f of s){let m=yc(f,a.yc(u));m==null&&(m={nullValue:"NULL_VALUE"}),l.push(m),u++}return{arrayValue:{values:l}}})(n,e)}return(function(s,a){if((s=ln(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return AI(a.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const l=Gt.fromDate(s);return{timestampValue:ed(a.serializer,l)}}if(s instanceof Gt){const l=new Gt(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:ed(a.serializer,l)}}if(s instanceof Js)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof ps)return{bytesValue:Ix(a.serializer,s._byteString)};if(s instanceof on){const l=a.databaseId,u=s.firestore._databaseId;if(!u.isEqual(l))throw a.wc(`Document reference is for database ${u.projectId}/${u.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:Mp(s.firestore._databaseId||a.databaseId,s._key.path)}}if(s instanceof Xs)return(function(u,f){return{mapValue:{fields:{[nx]:{stringValue:rx},[Yu]:{arrayValue:{values:u.toArray().map((y=>{if(typeof y!="number")throw f.wc("VectorValues must only contain numeric values.");return kp(f.serializer,y)}))}}}}}})(s,a);throw a.wc(`Unsupported field value: ${fd(s)}`)})(n,e)}function aw(n,e){const t={};return Y0(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):fa(n,((s,a)=>{const l=yc(a,e.Vc(s));l!=null&&(t[s]=l)})),{mapValue:{fields:t}}}function ow(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Gt||n instanceof Js||n instanceof ps||n instanceof on||n instanceof Pd||n instanceof Xs)}function rm(n,e,t){if(!ow(t)||!K0(t)){const s=fd(t);throw s==="an object"?e.wc(n+" a custom object"):e.wc(n+" "+s)}}function ep(n,e,t){if((e=ln(e))instanceof Nd)return e._internalPath;if(typeof e=="string")return sm(n,e);throw id("Field path arguments must be of type string or ",n,!1,void 0,t)}const GP=new RegExp("[~\\*/\\[\\]]");function sm(n,e,t){if(e.search(GP)>=0)throw id(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Nd(...e.split("."))._internalPath}catch{throw id(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function id(n,e,t,s,a){const l=s&&!s.isEmpty(),u=a!==void 0;let f=`Function ${e}() called with invalid data`;t&&(f+=" (via `toFirestore()`)"),f+=". ";let m="";return(l||u)&&(m+=" (found",l&&(m+=` in field ${s}`),u&&(m+=` in document ${a}`),m+=")"),new Ue(pe.INVALID_ARGUMENT,f+n+m)}function lw(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cw{constructor(e,t,s,a,l){this._firestore=e,this._userDataWriter=t,this._key=s,this._document=a,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new on(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new qP(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Ad("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class qP extends cw{data(){return super.data()}}function Ad(n,e){return typeof e=="string"?sm(n,e):e instanceof Nd?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uw(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Ue(pe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class im{}class am extends im{}function tp(n,e,...t){let s=[];e instanceof im&&s.push(e),s=s.concat(t),(function(l){const u=l.filter((m=>m instanceof om)).length,f=l.filter((m=>m instanceof jd)).length;if(u>1||u>0&&f>0)throw new Ue(pe.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(s);for(const a of s)n=a._apply(n);return n}class jd extends am{constructor(e,t,s){super(),this._field=e,this._op=t,this._value=s,this.type="where"}static _create(e,t,s){return new jd(e,t,s)}_apply(e){const t=this._parse(e);return hw(e._query,t),new Si(e.firestore,e.converter,Wf(e._query,t))}_parse(e){const t=Rd(e.firestore);return(function(l,u,f,m,y,_,T){let S;if(y.isKeyField()){if(_==="array-contains"||_==="array-contains-any")throw new Ue(pe.INVALID_ARGUMENT,`Invalid Query. You can't perform '${_}' queries on documentId().`);if(_==="in"||_==="not-in"){f_(T,_);const J=[];for(const $ of T)J.push(h_(m,l,$));S={arrayValue:{values:J}}}else S=h_(m,l,T)}else _!=="in"&&_!=="not-in"&&_!=="array-contains-any"||f_(T,_),S=WP(f,u,T,_==="in"||_==="not-in");return En.create(y,_,S)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function dw(n,e,t){const s=e,a=Ad("where",n);return jd._create(a,s,t)}class om extends im{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new om(e,t)}_parse(e){const t=this._queryConstraints.map((s=>s._parse(e))).filter((s=>s.getFilters().length>0));return t.length===1?t[0]:js.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(a,l){let u=a;const f=l.getFlattenedFilters();for(const m of f)hw(u,m),u=Wf(u,m)})(e._query,t),new Si(e.firestore,e.converter,Wf(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class lm extends am{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new lm(e,t)}_apply(e){const t=(function(a,l,u){if(a.startAt!==null)throw new Ue(pe.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(a.endAt!==null)throw new Ue(pe.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new tc(l,u)})(e._query,this._field,this._direction);return new Si(e.firestore,e.converter,(function(a,l){const u=a.explicitOrderBy.concat([l]);return new nl(a.path,a.collectionGroup,u,a.filters.slice(),a.limit,a.limitType,a.startAt,a.endAt)})(e._query,t))}}function np(n,e="asc"){const t=e,s=Ad("orderBy",n);return lm._create(s,t)}class cm extends am{constructor(e,t,s){super(),this.type=e,this._limit=t,this._limitType=s}static _create(e,t,s){return new cm(e,t,s)}_apply(e){return new Si(e.firestore,e.converter,Xu(e._query,this._limit,this._limitType))}}function HP(n){return cm._create("limit",n,"F")}function h_(n,e,t){if(typeof(t=ln(t))=="string"){if(t==="")throw new Ue(pe.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!dx(e)&&t.indexOf("/")!==-1)throw new Ue(pe.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const s=e.path.child(Ut.fromString(t));if(!Xe.isDocumentKey(s))throw new Ue(pe.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return Nv(n,new Xe(s))}if(t instanceof on)return Nv(n,t._key);throw new Ue(pe.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${fd(t)}.`)}function f_(n,e){if(!Array.isArray(n)||n.length===0)throw new Ue(pe.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function hw(n,e){const t=(function(a,l){for(const u of a)for(const f of u.getFlattenedFilters())if(l.indexOf(f.op)>=0)return f.op;return null})(n.filters,(function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new Ue(pe.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ue(pe.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class KP{convertValue(e,t="none"){switch(aa(e)){case 0:return null;case 1:return e.booleanValue;case 2:return pn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ia(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw it(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const s={};return fa(e,((a,l)=>{s[a]=this.convertValue(l,t)})),s}convertVectorValue(e){var t,s,a;const l=(a=(s=(t=e.fields)===null||t===void 0?void 0:t[Yu].arrayValue)===null||s===void 0?void 0:s.values)===null||a===void 0?void 0:a.map((u=>pn(u.doubleValue)));return new Xs(l)}convertGeoPoint(e){return new Js(pn(e.latitude),pn(e.longitude))}convertArray(e,t){return(e.values||[]).map((s=>this.convertValue(s,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const s=gd(e);return s==null?null:this.convertValue(s,t);case"estimate":return this.convertTimestamp(Xl(e));default:return null}}convertTimestamp(e){const t=sa(e);return new Gt(t.seconds,t.nanos)}convertDocumentKey(e,t){const s=Ut.fromString(e);Rt(kx(s),9688,{name:e});const a=new Zl(s.get(1),s.get(3)),l=new Xe(s.popFirst(5));return a.isEqual(t)||xi(`Document ${l} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fw(n,e,t){let s;return s=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,s}class Ol{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Fa extends cw{constructor(e,t,s,a,l,u){super(e,t,s,a,u),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Lu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const s=this._document.data.field(Ad("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ue(pe.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Fa._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Fa._jsonSchemaVersion="firestore/documentSnapshot/1.0",Fa._jsonSchema={type:Tn("string",Fa._jsonSchemaVersion),bundleSource:Tn("string","DocumentSnapshot"),bundleName:Tn("string"),bundle:Tn("string")};class Lu extends Fa{data(e={}){return super.data(e)}}class Ua{constructor(e,t,s,a){this._firestore=e,this._userDataWriter=t,this._snapshot=a,this.metadata=new Ol(a.hasPendingWrites,a.fromCache),this.query=s}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((s=>{e.call(t,new Lu(this._firestore,this._userDataWriter,s.key,s,new Ol(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ue(pe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(a,l){if(a._snapshot.oldDocs.isEmpty()){let u=0;return a._snapshot.docChanges.map((f=>{const m=new Lu(a._firestore,a._userDataWriter,f.doc.key,f.doc,new Ol(a._snapshot.mutatedKeys.has(f.doc.key),a._snapshot.fromCache),a.query.converter);return f.doc,{type:"added",doc:m,oldIndex:-1,newIndex:u++}}))}{let u=a._snapshot.oldDocs;return a._snapshot.docChanges.filter((f=>l||f.type!==3)).map((f=>{const m=new Lu(a._firestore,a._userDataWriter,f.doc.key,f.doc,new Ol(a._snapshot.mutatedKeys.has(f.doc.key),a._snapshot.fromCache),a.query.converter);let y=-1,_=-1;return f.type!==0&&(y=u.indexOf(f.doc.key),u=u.delete(f.doc.key)),f.type!==1&&(u=u.add(f.doc),_=u.indexOf(f.doc.key)),{type:QP(f.type),doc:m,oldIndex:y,newIndex:_}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ue(pe.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Ua._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Ip.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],s=[],a=[];return this.docs.forEach((l=>{l._document!==null&&(t.push(l._document),s.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),a.push(l.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function QP(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return it(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kd(n){n=kr(n,on);const e=kr(n.firestore,Ei);return DP(Id(e),n._key).then((t=>pw(e,n,t)))}Ua._jsonSchemaVersion="firestore/querySnapshot/1.0",Ua._jsonSchema={type:Tn("string",Ua._jsonSchemaVersion),bundleSource:Tn("string","QuerySnapshot"),bundleName:Tn("string"),bundle:Tn("string")};class um extends KP{constructor(e){super(),this.firestore=e}convertBytes(e){return new ps(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new on(this.firestore,null,t)}}function Ns(n){n=kr(n,Si);const e=kr(n.firestore,Ei),t=Id(e),s=new um(e);return uw(n._query),VP(t,n._query).then((a=>new Ua(e,s,n,a)))}function Ps(n,e,t){n=kr(n,on);const s=kr(n.firestore,Ei),a=fw(n.converter,e,t);return Dd(s,[iw(Rd(s),"setDoc",n._key,a,n.converter!==null,t).toMutation(n._key,gs.none())])}function fs(n,e,t,...s){n=kr(n,on);const a=kr(n.firestore,Ei),l=Rd(a);let u;return u=typeof(e=ln(e))=="string"||e instanceof Nd?$P(l,"updateDoc",n._key,e,t,s):BP(l,"updateDoc",n._key,e),Dd(a,[u.toMutation(n._key,gs.exists(!0))])}function Ma(n){return Dd(kr(n.firestore,Ei),[new Dp(n._key,gs.none())])}function Oa(n,e){const t=kr(n.firestore,Ei),s=bt(n),a=fw(n.converter,e);return Dd(t,[iw(Rd(n.firestore),"addDoc",s._key,a,n.converter!==null,{}).toMutation(s._key,gs.exists(!1))]).then((()=>s))}function rp(n,...e){var t,s,a;n=ln(n);let l={includeMetadataChanges:!1,source:"default"},u=0;typeof e[u]!="object"||d_(e[u])||(l=e[u++]);const f={includeMetadataChanges:l.includeMetadataChanges,source:l.source};if(d_(e[u])){const T=e[u];e[u]=(t=T.next)===null||t===void 0?void 0:t.bind(T),e[u+1]=(s=T.error)===null||s===void 0?void 0:s.bind(T),e[u+2]=(a=T.complete)===null||a===void 0?void 0:a.bind(T)}let m,y,_;if(n instanceof on)y=kr(n.firestore,Ei),_=yd(n._key.path),m={next:T=>{e[u]&&e[u](pw(y,n,T))},error:e[u+1],complete:e[u+2]};else{const T=kr(n,Si);y=kr(T.firestore,Ei),_=T._query;const S=new um(y);m={next:F=>{e[u]&&e[u](new Ua(y,S,T,F))},error:e[u+1],complete:e[u+2]},uw(n._query)}return(function(S,F,J,$){const B=new em($),se=new Jp(F,B,J);return S.asyncQueue.enqueueAndForget((async()=>Kp(await sd(S),se))),()=>{B.Ou(),S.asyncQueue.enqueueAndForget((async()=>Qp(await sd(S),se)))}})(Id(y),_,f,m)}function Dd(n,e){return(function(s,a){const l=new gi;return s.asyncQueue.enqueueAndForget((async()=>EP(await kP(s),a,l))),l.promise})(Id(n),e)}function pw(n,e,t){const s=t.docs.get(e._key),a=new um(n);return new Fa(n,a,e._key,s,new Ol(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YP(){return new gc("deleteField")}function za(){return new nm("serverTimestamp")}(function(e,t=!0){(function(a){Zo=a})(Yo),Oo(new $a("firestore",((s,{instanceIdentifier:a,options:l})=>{const u=s.getProvider("app").getImmediate(),f=new Ei(new WC(s.getProvider("auth-internal")),new HC(u,s.getProvider("app-check-internal")),(function(y,_){if(!Object.prototype.hasOwnProperty.apply(y.options,["projectId"]))throw new Ue(pe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Zl(y.options.projectId,_)})(u,a),u);return l=Object.assign({useFetchStreams:t},l),f._setSettings(l),f}),"PUBLIC").setMultipleInstances(!0)),Zi(pv,mv,e),Zi(pv,mv,"esm2017")})();const JP={apiKey:"AIzaSyCOOnlmEcAcJywsS93LLfLSywy9ENqnppM",authDomain:"tyler-manga-library.firebaseapp.com",projectId:"tyler-manga-library",storageBucket:"tyler-manga-library.firebasestorage.app",messagingSenderId:"307412068362",appId:"1:307412068362:web:6cfe5666187439dfa757f3"},mw=J_(JP),ms=UC(mw),rt=MP(mw),gw=j.createContext(null);function XP({children:n}){const e="https://discord.com/api/webhooks/1451655828078723156/EA8QhLeiTT-7jOVQ6jFpV2he2zxVpAddAhlu8CiC6RtGFu9wTAOLdRjKeYHIV1OhVbmm",[t,s]=j.useState(null),[a,l]=j.useState(!1),[u,f]=j.useState("viewer"),[m,y]=j.useState(!0),_=async F=>{if(!F)return null;const J=bt(rt,"users",F.uid);let $=null;try{const se=await kd(J);se.exists()&&($=se.data())}catch(se){console.warn("Failed to read user doc",se)}const B={role:(($==null?void 0:$.role)||"viewer").toLowerCase()==="admin"?"admin":"viewer",email:F.email||($==null?void 0:$.email)||"",displayName:F.displayName||($==null?void 0:$.displayName)||"",createdAt:($==null?void 0:$.createdAt)||za()};try{if(await Ps(J,B,{merge:!0}),!$&&e)try{const se=F.displayName||F.email||F.uid;await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:`New signup: ${se}`})})}catch(se){console.warn("Failed to send signup webhook",se)}}catch(se){console.error("Failed to ensure user doc",se)}return{...$,...B}};j.useEffect(()=>{const F=Rb(ms,async J=>{if(s(J),J)try{const $=await _(J),B=($==null?void 0:$.role)||"viewer";f(B),l(B.toLowerCase()==="admin")}catch($){console.error("Error checking role:",$),l(!1),f("viewer")}else l(!1),f("viewer");y(!1)});return()=>F()},[]);const T=async(F,J)=>{await b0(ms,F,J)},S=async()=>{await C0(ms)};return o.jsx(gw.Provider,{value:{user:t,admin:a,role:u,loading:m,login:T,logout:S},children:n})}function Qa(){return j.useContext(gw)}function ZP({onClose:n}){const[e,t]=j.useState("login"),[s,a]=j.useState(""),[l,u]=j.useState("");async function f(){try{await L0(ms,new Is),n()}catch(_){alert(_.message)}}async function m(_){_.preventDefault();try{await b0(ms,s,l),n()}catch(T){alert(T.message)}}async function y(_){_.preventDefault();try{await bb(ms,s,l),n()}catch(T){alert(T.message)}}return o.jsx("div",{className:"auth-modal-backdrop",onClick:n,children:o.jsxs("div",{className:"auth-modal",onClick:_=>_.stopPropagation(),children:[o.jsx("h2",{className:"auth-title",children:e==="login"?"Sign In":"Create Account"}),o.jsxs("button",{className:"google-btn",onClick:f,children:[o.jsx("img",{src:"https://www.svgrepo.com/show/475656/google-color.svg",alt:"",className:"google-icon"}),"Continue with Google"]}),o.jsx("div",{className:"auth-divider",children:o.jsx("span",{children:"or"})}),o.jsxs("form",{onSubmit:e==="login"?m:y,className:"auth-form",children:[o.jsx("input",{type:"email",placeholder:"Email address",className:"auth-input",value:s,onChange:_=>a(_.target.value),required:!0}),o.jsx("input",{type:"password",placeholder:"Password",className:"auth-input",value:l,onChange:_=>u(_.target.value),required:!0}),o.jsx("button",{className:"auth-submit",children:e==="login"?"Sign In":"Create Account"})]}),o.jsx("div",{className:"auth-switcher",children:e==="login"?o.jsxs("p",{children:["No account?"," ",o.jsx("button",{onClick:()=>t("register"),children:"Register"})]}):o.jsxs("p",{children:["Already have an account?"," ",o.jsx("button",{onClick:()=>t("login"),children:"Sign in"})]})}),o.jsx("button",{className:"auth-close",onClick:n,"aria-label":"Close",children:"X"})]})})}var Mu={exports:{}},eR=Mu.exports,p_;function tR(){return p_||(p_=1,(function(n){(function(e){function t(O,ae){var I=(O&65535)+(ae&65535),N=(O>>16)+(ae>>16)+(I>>16);return N<<16|I&65535}function s(O,ae){return O<<ae|O>>>32-ae}function a(O,ae,I,N,A,U){return t(s(t(t(ae,O),t(N,U)),A),I)}function l(O,ae,I,N,A,U,V){return a(ae&I|~ae&N,O,ae,A,U,V)}function u(O,ae,I,N,A,U,V){return a(ae&N|I&~N,O,ae,A,U,V)}function f(O,ae,I,N,A,U,V){return a(ae^I^N,O,ae,A,U,V)}function m(O,ae,I,N,A,U,V){return a(I^(ae|~N),O,ae,A,U,V)}function y(O,ae){O[ae>>5]|=128<<ae%32,O[(ae+64>>>9<<4)+14]=ae;var I,N,A,U,V,P=1732584193,C=-271733879,Y=-1732584194,ie=271733878;for(I=0;I<O.length;I+=16)N=P,A=C,U=Y,V=ie,P=l(P,C,Y,ie,O[I],7,-680876936),ie=l(ie,P,C,Y,O[I+1],12,-389564586),Y=l(Y,ie,P,C,O[I+2],17,606105819),C=l(C,Y,ie,P,O[I+3],22,-1044525330),P=l(P,C,Y,ie,O[I+4],7,-176418897),ie=l(ie,P,C,Y,O[I+5],12,1200080426),Y=l(Y,ie,P,C,O[I+6],17,-1473231341),C=l(C,Y,ie,P,O[I+7],22,-45705983),P=l(P,C,Y,ie,O[I+8],7,1770035416),ie=l(ie,P,C,Y,O[I+9],12,-1958414417),Y=l(Y,ie,P,C,O[I+10],17,-42063),C=l(C,Y,ie,P,O[I+11],22,-1990404162),P=l(P,C,Y,ie,O[I+12],7,1804603682),ie=l(ie,P,C,Y,O[I+13],12,-40341101),Y=l(Y,ie,P,C,O[I+14],17,-1502002290),C=l(C,Y,ie,P,O[I+15],22,1236535329),P=u(P,C,Y,ie,O[I+1],5,-165796510),ie=u(ie,P,C,Y,O[I+6],9,-1069501632),Y=u(Y,ie,P,C,O[I+11],14,643717713),C=u(C,Y,ie,P,O[I],20,-373897302),P=u(P,C,Y,ie,O[I+5],5,-701558691),ie=u(ie,P,C,Y,O[I+10],9,38016083),Y=u(Y,ie,P,C,O[I+15],14,-660478335),C=u(C,Y,ie,P,O[I+4],20,-405537848),P=u(P,C,Y,ie,O[I+9],5,568446438),ie=u(ie,P,C,Y,O[I+14],9,-1019803690),Y=u(Y,ie,P,C,O[I+3],14,-187363961),C=u(C,Y,ie,P,O[I+8],20,1163531501),P=u(P,C,Y,ie,O[I+13],5,-1444681467),ie=u(ie,P,C,Y,O[I+2],9,-51403784),Y=u(Y,ie,P,C,O[I+7],14,1735328473),C=u(C,Y,ie,P,O[I+12],20,-1926607734),P=f(P,C,Y,ie,O[I+5],4,-378558),ie=f(ie,P,C,Y,O[I+8],11,-2022574463),Y=f(Y,ie,P,C,O[I+11],16,1839030562),C=f(C,Y,ie,P,O[I+14],23,-35309556),P=f(P,C,Y,ie,O[I+1],4,-1530992060),ie=f(ie,P,C,Y,O[I+4],11,1272893353),Y=f(Y,ie,P,C,O[I+7],16,-155497632),C=f(C,Y,ie,P,O[I+10],23,-1094730640),P=f(P,C,Y,ie,O[I+13],4,681279174),ie=f(ie,P,C,Y,O[I],11,-358537222),Y=f(Y,ie,P,C,O[I+3],16,-722521979),C=f(C,Y,ie,P,O[I+6],23,76029189),P=f(P,C,Y,ie,O[I+9],4,-640364487),ie=f(ie,P,C,Y,O[I+12],11,-421815835),Y=f(Y,ie,P,C,O[I+15],16,530742520),C=f(C,Y,ie,P,O[I+2],23,-995338651),P=m(P,C,Y,ie,O[I],6,-198630844),ie=m(ie,P,C,Y,O[I+7],10,1126891415),Y=m(Y,ie,P,C,O[I+14],15,-1416354905),C=m(C,Y,ie,P,O[I+5],21,-57434055),P=m(P,C,Y,ie,O[I+12],6,1700485571),ie=m(ie,P,C,Y,O[I+3],10,-1894986606),Y=m(Y,ie,P,C,O[I+10],15,-1051523),C=m(C,Y,ie,P,O[I+1],21,-2054922799),P=m(P,C,Y,ie,O[I+8],6,1873313359),ie=m(ie,P,C,Y,O[I+15],10,-30611744),Y=m(Y,ie,P,C,O[I+6],15,-1560198380),C=m(C,Y,ie,P,O[I+13],21,1309151649),P=m(P,C,Y,ie,O[I+4],6,-145523070),ie=m(ie,P,C,Y,O[I+11],10,-1120210379),Y=m(Y,ie,P,C,O[I+2],15,718787259),C=m(C,Y,ie,P,O[I+9],21,-343485551),P=t(P,N),C=t(C,A),Y=t(Y,U),ie=t(ie,V);return[P,C,Y,ie]}function _(O){var ae,I="",N=O.length*32;for(ae=0;ae<N;ae+=8)I+=String.fromCharCode(O[ae>>5]>>>ae%32&255);return I}function T(O){var ae,I=[];for(I[(O.length>>2)-1]=void 0,ae=0;ae<I.length;ae+=1)I[ae]=0;var N=O.length*8;for(ae=0;ae<N;ae+=8)I[ae>>5]|=(O.charCodeAt(ae/8)&255)<<ae%32;return I}function S(O){return _(y(T(O),O.length*8))}function F(O,ae){var I,N=T(O),A=[],U=[],V;for(A[15]=U[15]=void 0,N.length>16&&(N=y(N,O.length*8)),I=0;I<16;I+=1)A[I]=N[I]^909522486,U[I]=N[I]^1549556828;return V=y(A.concat(T(ae)),512+ae.length*8),_(y(U.concat(V),640))}function J(O){var ae="0123456789abcdef",I="",N,A;for(A=0;A<O.length;A+=1)N=O.charCodeAt(A),I+=ae.charAt(N>>>4&15)+ae.charAt(N&15);return I}function $(O){return unescape(encodeURIComponent(O))}function B(O){return S($(O))}function se(O){return J(B(O))}function _e(O,ae){return F($(O),$(ae))}function ye(O,ae){return J(_e(O,ae))}function we(O,ae,I){return ae?I?_e(ae,O):ye(ae,O):I?B(O):se(O)}n.exports?n.exports=we:e.md5=we})(eR)})(Mu)),Mu.exports}var nR=tR();const rR=sp(nR);function sR(){var Fe,Qe,st;const n="google.com",e="oidc.discord",[t,s]=j.useState(!1),[a,l]=j.useState(!1),[u,f]=j.useState(!1),[m,y]=j.useState(!1),[_,T]=j.useState(""),[S,F]=j.useState(""),[J,$]=j.useState(""),[B,se]=j.useState({google:!1,discord:!1}),[_e,ye]=j.useState(""),[we,O]=j.useState(!1),[ae,I]=j.useState(!1),[N,A]=j.useState(null),U=j.useRef(null),{user:V,admin:P,role:C}=Qa(),Y=ic();j.useEffect(()=>{var ve;f(!1),y(!1),F(""),$(""),I(!1),T((V==null?void 0:V.displayName)||((ve=V==null?void 0:V.email)==null?void 0:ve.split("@")[0])||"")},[V]),j.useEffect(()=>{const ve=((V==null?void 0:V.email)||"").trim().toLowerCase();if(!ve){ye("");return}const ue=rR(ve),Oe=Date.now();ye(`https://www.gravatar.com/avatar/${ue}?s=160&d=identicon&r=g&cb=${Oe}`)},[V==null?void 0:V.email]),j.useEffect(()=>{let ve=!1;const ue=async()=>{var ge;try{const qe=tp(An(rt,"blogPosts"),dw("status","==","published"),np("publishedAt","desc"),HP(1)),Ye=await Ns(qe);if(ve)return;if(Ye.empty){A(null);return}const Et=Ye.docs[0],Nt=Et.data(),At=(ge=Nt.publishedAt)!=null&&ge.toDate?Nt.publishedAt.toDate():null;if(!At){A(null);return}const It=Nt.title||"New blog post",cn=At.toISOString().slice(0,10),Kt=`blog-alert-${Et.id}-${cn}`;if(!(Date.now()-At.getTime()<=1440*60*1e3)){A(null);return}if(typeof localStorage<"u"&&localStorage.getItem(Kt)==="dismissed")return;A({id:Et.id,title:It,alertKey:Kt,publishedAt:At})}catch(qe){(qe==null?void 0:qe.code)!=="permission-denied"&&console.error("Failed to load blog alert",qe)}};ue();const Oe=setInterval(ue,6e4);return()=>{ve=!0,clearInterval(Oe)}},[]);const ie=ve=>{N!=null&&N.alertKey&&typeof localStorage<"u"&&localStorage.setItem(N.alertKey,"dismissed"),A(null),Y(ve?`/blog?post=${ve}`:"/blog")},Ce=ve=>{ve!=null&&ve.stopPropagation&&ve.stopPropagation(),N!=null&&N.alertKey&&typeof localStorage<"u"&&localStorage.setItem(N.alertKey,"dismissed"),A(null)};async function fe(){try{await C0(ms),s(!1),f(!1),Y("/")}catch(ve){console.error(ve),alert("Logout failed.")}}const ce=()=>{if(!V){s(!1),l(!0);return}f(!1),F(""),$(""),I(!1),y(!0)},Re=async()=>{if(!V){s(!1),l(!0);return}const ve=(_||"").trim();if(!ve){F("Display name is required.");return}O(!0),F(""),I(!1);try{await Ib(ms.currentUser,{displayName:ve}),await Ps(bt(rt,"users",V.uid),{displayName:ve},{merge:!0}),F("Profile updated."),I(!1)}catch(ue){console.error("Failed to update profile",ue),F("Failed to update profile.")}finally{O(!1)}},Ee=ve=>{var ue;return!!((ue=V==null?void 0:V.providerData)!=null&&ue.some(Oe=>Oe.providerId===ve))},Q=async()=>{if(!V){s(!1),l(!0);return}if(Ee(n)){$("Google is already connected.");return}se(ve=>({...ve,google:!0})),$("");try{const ve=new Is,ue=await iv(ms.currentUser,ve);await Ps(bt(rt,"users",V.uid),{connections:{[n]:{email:ue.user.email||"",connectedAt:za()}}},{merge:!0}),$("Google connected.")}catch(ve){console.error("Failed to link Google",ve);const ue=(ve==null?void 0:ve.code)==="auth/credential-already-in-use"?"That Google account is already linked elsewhere. Sign in with it instead.":"Could not connect Google.";$(ue)}finally{se(ve=>({...ve,google:!1}))}},k=async()=>{if(!V){s(!1),l(!0);return}if(Ee(e)){$("Discord is already connected.");return}se(ve=>({...ve,discord:!0})),$("");try{const ve=new zl(e);ve.addScope("identify"),ve.addScope("email");const Oe=(await iv(ms.currentUser,ve)).user.providerData.find(ge=>ge.providerId===e);await Ps(bt(rt,"users",V.uid),{connections:{[e]:{username:(Oe==null?void 0:Oe.displayName)||(Oe==null?void 0:Oe.uid)||"Discord",email:(Oe==null?void 0:Oe.email)||"",connectedAt:za()}}},{merge:!0}),$("Discord connected.")}catch(ve){console.error("Failed to link Discord",ve);const ue=(ve==null?void 0:ve.code)==="auth/credential-already-in-use"?"That Discord account is already linked elsewhere. Sign in with it instead.":"Could not connect Discord.";$(ue)}finally{se(ve=>({...ve,discord:!1}))}},H=async ve=>{if(!V)return;if(V.providerData.length<=1){$("You need at least one sign-in method.");return}const ue=ve===n?"google":"discord";$(""),se(Oe=>({...Oe,[ue]:!0}));try{await xb(ms.currentUser,ve),await Ps(bt(rt,"users",V.uid),{connections:{[ve]:YP()}},{merge:!0}),$("Connection removed.")}catch(Oe){console.error("Failed to unlink",Oe),$("Could not remove connection.")}finally{se(Oe=>({...Oe,[ue]:!1}))}},be=V?(((Fe=V.displayName)==null?void 0:Fe[0])||((Qe=V.email)==null?void 0:Qe[0])||((st=V.uid)==null?void 0:st[0])||"?").toUpperCase():"?",Le=(V==null?void 0:V.displayName)||(V==null?void 0:V.email)||"Guest",Ve=V?P?"admin":C||"viewer":"Not signed in";return o.jsxs(o.Fragment,{children:[N&&o.jsxs("div",{className:"blog-alert-banner",onClick:()=>ie(N.id),role:"button",tabIndex:0,onKeyDown:ve=>{(ve.key==="Enter"||ve.key===" ")&&(ve.preventDefault(),ie(N.id))},children:[o.jsx("div",{className:"blog-alert-dot"}),o.jsxs("div",{className:"blog-alert-text",children:["New blog post today: ",o.jsx("strong",{children:N.title})]}),o.jsxs("div",{className:"blog-alert-actions",children:[o.jsx("button",{type:"button",className:"blog-alert-btn",onClick:ve=>{ve.stopPropagation(),ie(N.id)},children:"Read now"}),o.jsx("button",{type:"button",className:"blog-alert-dismiss",onClick:Ce,children:"Dismiss"})]})]}),o.jsxs("button",{className:`menu-toggle ${t?"active":""}`,onClick:()=>s(!t),children:[o.jsx("span",{}),o.jsx("span",{}),o.jsx("span",{})]}),o.jsxs("nav",{className:`menu-panel ${t?"open":""}`,onMouseLeave:()=>f(!1),children:[o.jsx(Bi,{to:"/",className:"menu-item",onClick:()=>s(!1),children:"Home"}),o.jsx(Bi,{to:"/manga",className:"menu-item",onClick:()=>s(!1),children:"Manga"}),o.jsx(Bi,{to:"/anime",className:"menu-item",onClick:()=>s(!1),children:"Anime"}),o.jsx(Bi,{to:"/tcg",className:"menu-item",onClick:()=>s(!1),children:"TCG"}),o.jsx(Bi,{to:"/music",className:"menu-item",onClick:()=>s(!1),children:"Music"}),o.jsx(Bi,{to:"/steam",className:"menu-item",onClick:()=>s(!1),children:"Gaming"}),P&&o.jsx(Bi,{to:"/blog",className:"menu-item",onClick:()=>s(!1),children:"Blog"}),P&&o.jsx(Bi,{to:"/dashboard",className:"menu-item",onClick:()=>s(!1),children:"Dashboard"}),o.jsxs("div",{className:"menu-footer",children:[o.jsx("div",{className:"profile-divider"}),o.jsxs("div",{className:"profile-card",onMouseEnter:()=>V&&f(!0),onMouseLeave:()=>f(!1),onClick:()=>{V?f(ve=>!ve):(f(!1),s(!1),l(!0))},role:"button",tabIndex:0,onKeyDown:ve=>{(ve.key==="Enter"||ve.key===" ")&&(ve.preventDefault(),V?f(ue=>!ue):(s(!1),l(!0)))},children:[o.jsx("div",{className:"profile-avatar",children:_e?o.jsx("img",{src:_e,alt:`${Le} avatar`,onError:()=>ye("")}):be}),o.jsxs("div",{className:"profile-meta",children:[o.jsx("div",{className:"profile-name",children:Le}),o.jsx("div",{className:"profile-role",children:Ve})]}),V&&u&&o.jsxs("div",{className:"profile-menu",children:[o.jsx("button",{type:"button",className:"profile-menu-item",onClick:ce,children:"Edit profile"}),o.jsx("button",{type:"button",className:"profile-menu-item",onClick:fe,children:"Sign out"})]})]})]})]}),a&&o.jsx(ZP,{onClose:()=>l(!1)}),m&&o.jsx("div",{className:"profile-edit-backdrop",children:o.jsxs("div",{className:"profile-edit-card",children:[o.jsxs("div",{className:"profile-edit-header",children:[o.jsx("h3",{children:"Edit profile"}),o.jsx("button",{type:"button",className:"profile-edit-close",onClick:()=>{y(!1),F(""),$(""),I(!1)},children:""})]}),o.jsxs("div",{className:"profile-edit-body",children:[o.jsxs("a",{className:"profile-edit-avatar clickable",href:"https://gravatar.com/profile",target:"_blank",rel:"noreferrer",title:"Manage your picture on Gravatar (opens in new tab)",children:[_e?o.jsx("img",{src:_e,alt:`${Le} avatar`,onError:()=>ye("")}):be,o.jsx("span",{className:"profile-avatar-hover-hint",children:"Change on Gravatar"})]}),o.jsxs("div",{className:"profile-edit-field",children:[o.jsx("label",{className:"profile-edit-label",htmlFor:"displayName",children:"Display name"}),o.jsxs("div",{className:"profile-edit-input-row",children:[o.jsx("input",{id:"displayName",className:"profile-edit-input",type:"text",readOnly:!ae,value:_,onChange:ve=>T(ve.target.value),maxLength:40,placeholder:"Enter display name",ref:U,onBlur:()=>{ae&&Re()},onKeyDown:ve=>{ve.key==="Enter"&&ae&&(ve.preventDefault(),Re())}}),o.jsx("button",{type:"button",className:"profile-edit-pencil",onClick:()=>{I(!0),F(""),setTimeout(()=>{var ve;return(ve=U.current)==null?void 0:ve.focus()},50)},"aria-label":"Edit display name",children:""})]}),o.jsx("div",{className:"profile-edit-hint",children:"Click the pencil to edit. Changes save on blur or Enter."})]})]}),o.jsxs("div",{className:"profile-connections",children:[o.jsxs("div",{className:"profile-connections-header",children:[o.jsx("span",{children:"Connections"}),J&&o.jsx("span",{className:"profile-connection-status",children:J})]}),o.jsxs("div",{className:"profile-connection-row",children:[o.jsxs("div",{className:"profile-connection-meta",children:[o.jsx("div",{className:"profile-connection-title",children:"Google"}),o.jsx("div",{className:"profile-connection-sub",children:Ee(n)?"Connected":"Not connected"})]}),o.jsx("div",{className:"profile-connection-actions",children:Ee(n)?o.jsx("button",{type:"button",className:"profile-connection-btn secondary",onClick:()=>H(n),disabled:B.google,children:B.google?"Removing...":"Remove"}):o.jsx("button",{type:"button",className:"profile-connection-btn",onClick:Q,disabled:B.google,children:B.google?"Connecting...":"Connect"})})]}),o.jsxs("div",{className:"profile-connection-row",children:[o.jsxs("div",{className:"profile-connection-meta",children:[o.jsx("div",{className:"profile-connection-title",children:"Discord"}),o.jsx("div",{className:"profile-connection-sub",children:Ee(e)?"Connected":"Not connected"})]}),o.jsx("div",{className:"profile-connection-actions",children:Ee(e)?o.jsx("button",{type:"button",className:"profile-connection-btn secondary",onClick:()=>H(e),disabled:B.discord,children:B.discord?"Removing...":"Remove"}):o.jsx("button",{type:"button",className:"profile-connection-btn",onClick:k,disabled:B.discord,children:B.discord?"Connecting...":"Connect"})})]})]}),S&&o.jsx("div",{className:"profile-edit-status",children:S}),we&&o.jsx("div",{className:"profile-edit-status saving",children:"Saving..."}),o.jsx("div",{className:"profile-gravatar-note",children:"Profile pictures are managed through Gravatarclick the avatar to update."})]})})]})}function m_(){const n="Tyler's Collection's and Hobbies",e="",[t,s]=j.useState(""),[a,l]=j.useState(!0),u=j.useRef(null),[f,m]=j.useState("jp"),[y,_]=j.useState(1);return j.useEffect(()=>{document.title="Tyler's Collection"},[]),j.useEffect(()=>(u.current=setInterval(()=>l(T=>!T),450),()=>{u.current&&clearInterval(u.current)}),[]),j.useEffect(()=>{let T=!1;const S=$=>new Promise(B=>setTimeout(B,$)),F=async($,B=120)=>{for(let se=1;se<=$.length;se+=1){if(T)return;s($.slice(0,se)),await S(B)}},J=async($,B=70)=>{for(let se=$.length;se>=0;se-=1){if(T)return;s($.slice(0,se)),await S(B)}};return(async()=>{if(localStorage.getItem("homeTitleTyped")==="1"){m("en"),s(n),l(!1),u.current&&clearInterval(u.current);return}await S(250),m("jp"),await F(e,140),await S(6e3),await J(e,80),await S(320);const B=n;for(let se=1;se<=B.length;se+=1){if(T)return;s(B.slice(0,se)),se===4&&m("en"),await S(110)}m("en"),await S(2e3),l(!1),localStorage.setItem("homeTitleTyped","1"),u.current&&clearInterval(u.current)})(),()=>{T=!0}},[]),o.jsxs("main",{className:"page",children:[o.jsxs("header",{style:{textAlign:"center",marginTop:"32px",marginBottom:"24px"},children:[o.jsxs("h1",{style:{margin:0,fontSize:"2.2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",display:"inline-flex",alignItems:"center",gap:"6px"},children:[o.jsx("span",{children:t||" "}),o.jsx("span",{style:{width:"6px",height:"1.1em",background:"#ffb6c1",opacity:a?1:0,transition:"opacity 0.15s ease"}})]}),o.jsx("p",{style:{margin:"6px 0 0",color:"var(--text-soft)",fontSize:"0.95rem",opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"TCG":"This is my personal webpage to see what is on my shelves, wishlists, and TCG collections."}),o.jsx("div",{style:{display:"inline-flex",alignItems:"center",gap:"10px",padding:"8px 14px",borderRadius:"999px",border:"1px solid rgba(255,182,193,0.5)",background:"linear-gradient(135deg, rgba(255,182,193,0.18), rgba(43,15,29,0.9))",boxShadow:"0 8px 24px rgba(0,0,0,0.55)",marginTop:"14px",fontSize:"0.78rem",color:"#ffe6ed",letterSpacing:"0.05em",textTransform:"uppercase",fontWeight:700,opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?o.jsx("span",{style:{letterSpacing:"0.06em"},children:"          TCG"}):o.jsx("span",{style:{letterSpacing:"0.06em"},children:" Manga   Anime   Music   TCG"})})]}),o.jsxs("section",{style:{display:"grid",gridTemplateColumns:"minmax(0, 2fr) minmax(0, 3fr)",gap:"20px",marginTop:"24px"},children:[o.jsxs("article",{className:"card",children:[o.jsx("h2",{style:{marginTop:0,marginBottom:"8px",fontSize:"1.2rem",color:"#ffb6c1"},children:o.jsx("span",{style:{opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"":"About Me"})}),o.jsx("p",{style:{margin:0,color:"var(--text-soft)",fontSize:"0.9rem",lineHeight:1.5,opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"im.okTCG":"Hey, I am Tyler and I go by im.ok. I hoard manga, binge anime, and collect trading cards."}),o.jsx("p",{style:{marginTop:"10px",color:"var(--text-soft)",fontSize:"0.9rem",opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"TCG":"This site is where I track everything: volumes on my shelves, finished shows, and my TCG collection as they all slowly grow."}),o.jsxs("div",{style:{marginTop:"12px",display:"flex",flexWrap:"wrap",gap:"6px",opacity:y,transition:"opacity 0.25s ease"},children:[o.jsx("span",{className:"pill",children:f==="jp"?"":"Manga library"}),o.jsx("span",{className:"pill",children:f==="jp"?"":"My Anime List (MAL)"}),o.jsx("span",{className:"pill",children:f==="jp"?" & TCG":"Pokemon & One Piece TCG"}),o.jsx("span",{className:"pill",children:f==="jp"?"":"Data Nerd"})]})]}),o.jsxs("article",{className:"card",children:[o.jsx("h2",{style:{marginTop:0,marginBottom:"8px",fontSize:"1.2rem",color:"#ffb6c1"},children:o.jsx("span",{style:{opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Explore these pages"})}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(210px, 1fr))",gap:"14px",marginTop:"10px"},children:[o.jsxs("a",{href:"/base/manga",className:"section-card",children:[o.jsx("h3",{style:{opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Manga Library"}),o.jsx("p",{style:{opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Full manga collection & wishlist."}),o.jsx("div",{className:"section-chip-row",children:o.jsx("span",{className:"section-chip accent",style:{opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Library & wishlist"})})]}),o.jsxs("a",{href:"/base/music",className:"section-card",style:{justifySelf:"end",alignSelf:"end",order:99},children:[o.jsx("h3",{style:{opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Music"}),o.jsx("p",{style:{opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"":"If you are here for my music, this is the page for you! Catch all the latest releases."}),o.jsxs("div",{className:"section-chip-row",children:[o.jsx("span",{className:"section-chip accent",style:{opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Latest tracks"}),o.jsx("span",{className:"section-chip",style:{opacity:y,transition:"opacity 0.25s ease"},children:"Spotify & SoundCloud"})]})]}),o.jsxs("a",{href:"/base/anime",className:"section-card",children:[o.jsx("h3",{style:{opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Anime Library"}),o.jsx("p",{style:{opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"MAL":"The entire watched, plan to watch, and watching list synced directly from MyAnimeList."}),o.jsxs("div",{className:"section-chip-row",children:[o.jsx("span",{className:"section-chip accent",style:{opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"MAL":"MAL synced"}),o.jsx("span",{className:"section-chip",style:{opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Status filters"}),o.jsx("span",{className:"section-chip",style:{opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Quick stats"})]})]}),o.jsxs("a",{href:"/base/tcg",className:"section-card",children:[o.jsx("h3",{style:{opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"TCG":"TCG Collection"}),o.jsx("p",{style:{opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"TCG":"Pokemon & One Piece TCG cards tracked with quantities, prices, and value."}),o.jsxs("div",{className:"section-chip-row",children:[o.jsx("span",{className:"section-chip accent",style:{opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Full Collection"}),o.jsx("span",{className:"section-chip",style:{opacity:y,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Still Under-Construction"})]})]})]})]})]}),o.jsx("footer",{style:{marginTop:"28px",fontSize:"0.78rem",color:"var(--text-soft)",textAlign:"center"},children:"@ 2025 im.ok. All rights reserved."})]})}const iR="modulepreload",aR=function(n){return"/base/"+n},g_={},vc=function(e,t,s){let a=Promise.resolve();if(t&&t.length>0){let u=function(y){return Promise.all(y.map(_=>Promise.resolve(_).then(T=>({status:"fulfilled",value:T}),T=>({status:"rejected",reason:T}))))};document.getElementsByTagName("link");const f=document.querySelector("meta[property=csp-nonce]"),m=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));a=u(t.map(y=>{if(y=aR(y),y in g_)return;g_[y]=!0;const _=y.endsWith(".css"),T=_?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${y}"]${T}`))return;const S=document.createElement("link");if(S.rel=_?"stylesheet":iR,_||(S.as="script"),S.crossOrigin="",S.href=y,m&&S.setAttribute("nonce",m),document.head.appendChild(S),_)return new Promise((F,J)=>{S.addEventListener("load",F),S.addEventListener("error",()=>J(new Error(`Unable to preload CSS for ${y}`)))})}))}function l(u){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=u,window.dispatchEvent(f),!f.defaultPrevented)throw u}return a.then(u=>{for(const f of u||[])f.status==="rejected"&&l(f.reason);return e().catch(l)})};function yw({open:n,title:e,placeholder:t,value:s,status:a,loading:l,onChange:u,onSubmit:f,onClose:m}){if(!n)return null;const y=typeof a=="string"&&a.toLowerCase().startsWith("sent!")?"#a3f0cf":"#ffb6c1";return o.jsx("div",{className:"suggestion-backdrop",onClick:_=>{_.target===_.currentTarget&&m&&m()},children:o.jsxs("div",{className:"suggestion-modal",children:[o.jsxs("div",{className:"suggestion-modal-header",children:[o.jsx("h3",{children:e}),o.jsx("button",{className:"suggestion-close",type:"button",onClick:m,"aria-label":"Close",children:"X"})]}),o.jsx("p",{className:"suggestion-hint",children:"Tell me what to add next. Titles only is fine, but extra notes are welcome."}),o.jsx("textarea",{className:"suggestion-textarea",placeholder:t,value:s,onChange:_=>u==null?void 0:u(_.target.value),maxLength:500}),a&&o.jsx("div",{className:"suggestion-status",style:{color:y},children:a}),o.jsxs("div",{className:"suggestion-actions",children:[o.jsx("button",{className:"suggestion-send",type:"button",onClick:f,disabled:l,children:l?"Sending...":"Send Suggestion"}),o.jsx("button",{className:"suggestion-cancel",type:"button",onClick:m,children:"Cancel"})]})]})})}const dm="mangaLibraryActivityLog",Va="https://discord.com/api/webhooks/1448329790942613667/wsC8psNZ-Ax2D1O9Gl4sJi6ay7df2cr7IrIdxMPwGZTBnkSUIY2NDpeVd98qW_4plz82";let Io=null;function oR(n){return Array.isArray(n)?n.map(e=>({message:e.message,ts:e.ts?new Date(e.ts):new Date,user:e.user||e.email||"",context:e.context||"",details:Array.isArray(e.details)?e.details:[]})).filter(e=>e.message):[]}function lR(){if(typeof window>"u")return[];try{const n=localStorage.getItem(dm);if(!n)return[];const e=JSON.parse(n);return oR(e)}catch(n){return console.warn("Failed to read activity log",n),[]}}function vw(n){try{const e=(n||[]).slice(0,100).map(t=>({message:t.message,ts:t.ts instanceof Date?t.ts.toISOString():t.ts,user:t.user||"",context:t.context||"",details:t.details||[]}));typeof window<"u"&&localStorage.setItem(dm,JSON.stringify(e))}catch(e){console.warn("Failed to persist activity log",e)}}async function cR(){if(Io)return Io;try{const n=bt(rt,"settings","webhooks"),e=await kd(n);if(e.exists())return Io=e.data().activity||Va,Io}catch(n){console.warn("Failed to load activity webhook",n)}return Io=Va,Io}function y_(n){if(n==null)return"";if(typeof n=="object")try{return JSON.stringify(n)}catch{return String(n)}return String(n)}function uR(n){return n?typeof n=="string"?[n]:Array.isArray(n)?n.map(e=>y_(e)):typeof n=="object"?Object.entries(n).map(([e,t])=>`${e}: ${y_(t)}`):[]:[]}async function dR(n,e={}){if(n)try{const{email:t,name:s,webhookOverride:a,context:l,list:u,action:f,detailLines:m=[]}=e,y=a||await cR();if(!y)return;const _=(s||"").trim()||t||"anonymous",T=new Date,S=Intl.DateTimeFormat().resolvedOptions().timeZone||"local time",F=[];F.push(" **Library Activity**"),F.push(` ${n}`),F.push(` ${_}       ${T.toLocaleString()} (${S})`);const J=[];l&&J.push(`Context: ${l}`),u&&J.push(`List: ${u}`),f&&J.push(`Action: ${f}`),J.length&&F.push(J.join("      ")),m.length&&(F.push(" Details:"),m.forEach($=>F.push(` ${$}`))),await fetch(y,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:F.join(`
`)})})}catch(t){console.warn("Activity webhook failed",t)}}async function _w(n,e={}){if(!n)return null;const{email:t,name:s,webhookOverride:a,persistLocal:l=!0,context:u="",list:f="",action:m="",details:y=null}=e,_=uR(y),T={message:n,ts:new Date,user:(s||"").trim()||t||"",context:u,details:_};if(l){const S=lR(),F=[T,...S].slice(0,100);vw(F)}return await dR(n,{email:t,name:s,webhookOverride:a,context:u,list:f,action:m,detailLines:_}),T}const v_=5,hR=3600*1e3,__="mangaSuggestionsSent",x_="mangaViewMode";function Pt(n){let e=(n||"").trim();const t=e.match(/^(.*?)(?:,?\s*(?:Vol\.|Volume)\s*(\d+)(?:\s*[--]\s*\d+)?\s*)?(?:\s*\([^)]*\))?$/i),s=t?t[1].trim().toLowerCase():e.toLowerCase(),a=t&&t[2]?parseInt(t[2],10):0;return{name:s,vol:Number.isFinite(a)?a:0}}function fR(n){if(typeof n=="number")return n;if(n==null||n==="")return 0;const e=parseInt(n,10);return Number.isFinite(e)?e:0}function w_(){const n=new Date,e=n.getFullYear(),t=String(n.getMonth()+1).padStart(2,"0"),s=String(n.getDate()).padStart(2,"0");return`${e}-${t}-${s}`}function No(n){const e=(n==null?void 0:n.pageCount)??(n==null?void 0:n.PageCount)??"",t=String(e??"").trim();if(!t)return!0;const s=fR(t);return!Number.isFinite(s)||s<=0}function Ht(n,e=!1){const t=(n??"").toString().trim();return!t||!e&&t.toLowerCase()==="unknown"}function bu(n,e={}){const t=e.includeIsbn??!1,s=e.includeFinance??!1,a=((n==null?void 0:n.specialType)||"").toLowerCase()==="collectible"||((n==null?void 0:n.SpecialType)||"").toLowerCase()==="collectible",l=Ht(n==null?void 0:n.authors),u=Ht(n==null?void 0:n.publisher),f=Ht(n==null?void 0:n.date),m=t?Ht(n==null?void 0:n.isbn):!1,y=s&&!a?Ht(n==null?void 0:n.amountPaid):!1,_=s&&a?Ht(n==null?void 0:n.collectiblePrice):!1,T=s?Ht((n==null?void 0:n.msrp)??(n==null?void 0:n.MSRP)):!1,S=s?Ht(n==null?void 0:n.datePurchased):!1;return{authorMissing:l,publisherMissing:u,dateMissing:f,isbnMissing:m,amountMissing:y,collectibleMissing:_,msrpMissing:T,purchaseMissing:S,any:l||u||f||m||y||_||T||S}}function Rr(n){if(!n)return"";const e=String(n).trim();if(/^\d{4}-\d{2}-\d{2}$/.test(e))return e;const t=new Date(e);if(Number.isNaN(t.getTime()))return"";const s=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),l=String(t.getDate()).padStart(2,"0");return`${s}-${a}-${l}`}const pR=(n,e)=>{const t=Pt(n.title||""),s=Pt(e.title||""),a=t.name.localeCompare(s.name);return a!==0?a:t.vol-s.vol};function mR(n){const t=(n||"").match(/vol(?:ume)?\.?\s*(\d+)(?:\s*[-]\s*(\d+))?/i);if(!t)return[];const s=parseInt(t[1],10),a=t[2]?parseInt(t[2],10):s;if(!Number.isFinite(s))return[];const l=Number.isFinite(a)&&a>=s?a:s,u=[];for(let f=s;f<=l;f+=1)u.push(f);return u}function ka(n){return Pt(n||"").name}function gR(n,e){const t=new Map;return[...n,...e].forEach(s=>{const a=ka(s.title||"");if(!a)return;const l=t.get(a)||!1;t.set(a,l||!!s.hidden)}),t}function yR(){const{admin:n,user:e,role:t}=Qa(),s=n,a=(w,D={})=>{w&&_w(w,{email:(e==null?void 0:e.email)||"anonymous",name:(e==null?void 0:e.displayName)||"",context:"Manga",...D})},[l,u]=j.useState("library"),[f,m]=j.useState(()=>typeof window>"u"?"series":localStorage.getItem(x_)==="individual"?"individual":"series");j.useEffect(()=>{ve("")},[e]),j.useEffect(()=>{try{localStorage.setItem(x_,f)}catch(w){console.warn("Failed to persist manga view mode",w)}},[f]);const y=async()=>{const w=Date.now(),q=(()=>{try{const L=localStorage.getItem(__);return Array.isArray(JSON.parse(L))?JSON.parse(L):[]}catch{return[]}})().filter(L=>w-L<hR);if(q.length>=v_){ve("Rate limit: please wait a bit (max 5 suggestions per hour).");return}if(!Fe.trim()){ve("Please enter a manga title or note before sending.");return}Oe(!0),ve("");try{const L=`**Manga Suggestion**
${Fe.trim()}
From: ${(e==null?void 0:e.displayName)||(e==null?void 0:e.email)||(e==null?void 0:e.uid)||"anonymous user"}`;await Oa(An(rt,"suggestions"),{content:Fe.trim(),type:"manga",from:(e==null?void 0:e.displayName)||(e==null?void 0:e.email)||(e==null?void 0:e.uid)||"anonymous user",createdAt:new Date().toISOString()}),ve("Sent! I'll review your suggestion soon."),Qe("");const ee=[...q,w].slice(-v_);localStorage.setItem(__,JSON.stringify(ee))}catch(L){console.error("Failed to send suggestion",L),ve("Failed to send suggestion. Please try again later.")}finally{Oe(!1)}},[_,T]=j.useState([]),[S,F]=j.useState([]),[J,$]=j.useState([]),[B,se]=j.useState([]),[_e,ye]=j.useState(!1),[we,O]=j.useState(!0),[ae,I]=j.useState(""),[N,A]=j.useState(""),[U,V]=j.useState(""),[P,C]=j.useState(!1),[Y,ie]=j.useState(()=>new Set);j.useEffect(()=>{f==="series"&&P&&(typeof Ye>"u"||Ye===null)&&(C(!1),ie(new Set))},[f,P]);const[Ce,fe]=j.useState({open:!1,mode:"add",list:"library",data:{title:"",authors:"",publisher:"",demographic:"",genre:"",subGenre:"",date:"",cover:"",isbn:"",pageCount:"",rating:"",amountPaid:"",dateRead:"",datePurchased:"",msrp:"",special:!1,specialType:"",specialVolumes:"",collectiblePrice:"",amazonURL:"",read:!1},editingId:null,multiAdd:!1,startVol:"",endVol:""}),[ce,Re]=j.useState([]),[Ee,Q]=j.useState(0),k=j.useMemo(()=>{const w=Ce.list==="library",D=w&&Ce.data.special&&Ce.data.specialType==="collectible",q=w&&!D;return{author:Ht(Ce.data.authors),publisher:Ht(Ce.data.publisher),date:Ht(Ce.data.date),purchaseDate:w?Ht(Ce.data.datePurchased):!1,page:No({pageCount:Ce.data.pageCount}),isbn:w?Ht(Ce.data.isbn):!1,amountPaid:q?Ht(Ce.data.amountPaid):!1,collectiblePrice:D?Ht(Ce.data.collectiblePrice):!1,msrp:w?Ht(Ce.data.msrp):!1}},[Ce.data,Ce.list]),[H,be]=j.useState({open:!1,index:0,items:[]}),[Le,Ve]=j.useState(!1),[Fe,Qe]=j.useState(""),[st,ve]=j.useState(""),[ue,Oe]=j.useState(!1),[ge,qe]=j.useState(null),[Ye,Et]=j.useState(null);j.useEffect(()=>{const w="Manga | Library";if(!s){document.title=w;return}const D=[..._,...S].reduce((q,L)=>{const ee=No(L),X=bu(L,{includeIsbn:L.kind==="library",includeFinance:L.kind==="library"});return q+(ee||X.any?1:0)},0);document.title=D>0?`(${D}) ${w}`:w},[s,_,S]),j.useEffect(()=>{if(!!ge||!!Ye||Ce.open||H.open||Le){const D=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=D}}},[ge,Ye,Ce.open,H.open,Le]);const Nt=!!e&&t==="viewer";async function At(){const w=await Ns(An(rt,"library")),D=[];w.forEach(q=>{const L=q.data();D.push({id:q.id,title:L.title||"",authors:L.authors||"Unknown",publisher:L.publisher||"Unknown",demographic:L.demographic||"",genre:L.genre||"",subGenre:L.subGenre||"",date:Rr(L.date)||L.date||"Unknown",cover:L.cover||"",isbn:L.isbn||"",pageCount:L.pageCount!==void 0&&L.pageCount!==null?L.pageCount:"",rating:L.rating!==void 0&&L.rating!==null?L.rating:"",amountPaid:L.amountPaid!==void 0&&L.amountPaid!==null?L.amountPaid:"",dateRead:Rr(L.dateRead)||L.dateRead||"",datePurchased:Rr(L.datePurchased)||L.datePurchased||"",msrp:L.msrp!==void 0&&L.msrp!==null?L.msrp:"",specialType:L.specialType||"",specialVolumes:L.specialVolumes!==void 0&&L.specialVolumes!==null?L.specialVolumes:"",collectiblePrice:L.collectiblePrice!==void 0&&L.collectiblePrice!==null?L.collectiblePrice:"",read:!!L.read,amazonURL:L.amazonURL||"",hidden:!!L.hidden,kind:"library"})}),D.sort((q,L)=>{const ee=Pt(q.title),X=Pt(L.title),ne=ee.name.localeCompare(X.name);return ne!==0?ne:ee.vol-X.vol}),T(D),$(q=>{const L=new Set(q);return D.forEach(ee=>L.add(ee.title||"")),Array.from(L).filter(Boolean).sort()})}async function It(){const w=await Ns(An(rt,"wishlist")),D=[];w.forEach(q=>{const L=q.data();D.push({id:q.id,title:L.title||"",authors:L.authors||"Unknown",publisher:L.publisher||"Unknown",date:Rr(L.date)||L.date||"Unknown",cover:L.cover||"",isbn:L.isbn||"",pageCount:L.pageCount!==void 0&&L.pageCount!==null?L.pageCount:"",rating:L.rating!==void 0&&L.rating!==null?L.rating:"",amountPaid:L.amountPaid!==void 0&&L.amountPaid!==null?L.amountPaid:"",datePurchased:Rr(L.datePurchased)||L.datePurchased||"",specialType:L.specialType||"",specialVolumes:L.specialVolumes!==void 0&&L.specialVolumes!==null?L.specialVolumes:"",collectiblePrice:L.collectiblePrice!==void 0&&L.collectiblePrice!==null?L.collectiblePrice:"",amazonURL:L.amazonURL||"",hidden:!!L.hidden,kind:"wishlist"})}),D.sort((q,L)=>{const ee=Pt(q.title),X=Pt(L.title),ne=ee.name.localeCompare(X.name);return ne!==0?ne:ee.vol-X.vol}),F(D),$(q=>{const L=new Set(q);return D.forEach(ee=>L.add(ee.title||"")),Array.from(L).filter(Boolean).sort()})}j.useEffect(()=>{let w=!1,D=!1,q=!1;const L=async()=>{if(!w)try{const me=await fetch("/base/manga-library-wishlist.json",{cache:"no-cache"});if(!me.ok)throw new Error("fallback fetch failed");const De=await me.json(),de=Array.isArray(De.library)?De.library:[],ot=Array.isArray(De.wishlist)?De.wishlist:[];T(de.map((Pe,Je)=>({id:Pe.id||`offline-lib-${Je}`,title:Pe.title||"",authors:Pe.authors||"Unknown",publisher:Pe.publisher||"Unknown",demographic:Pe.demographic||"",genre:Pe.genre||"",subGenre:Pe.subGenre||"",date:Rr(Pe.date)||Pe.date||"Unknown",cover:Pe.cover||"",isbn:Pe.isbn||"",pageCount:Pe.pageCount??"",rating:Pe.rating??"",amountPaid:Pe.amountPaid??"",dateRead:Rr(Pe.dateRead)||Pe.dateRead||"",datePurchased:Rr(Pe.datePurchased)||Pe.datePurchased||"",msrp:Pe.msrp??"",specialType:Pe.specialType||"",specialVolumes:Pe.specialVolumes??"",collectiblePrice:Pe.collectiblePrice??"",amazonURL:Pe.amazonURL||"",read:!!Pe.read,hidden:!!Pe.hidden,kind:"library"}))),F(ot.map((Pe,Je)=>({id:Pe.id||`offline-wish-${Je}`,title:Pe.title||"",authors:Pe.authors||"Unknown",publisher:Pe.publisher||"Unknown",demographic:Pe.demographic||"",genre:Pe.genre||"",subGenre:Pe.subGenre||"",date:Rr(Pe.date)||Pe.date||"Unknown",cover:Pe.cover||"",isbn:Pe.isbn||"",pageCount:Pe.pageCount??"",rating:Pe.rating??"",amountPaid:Pe.amountPaid??"",dateRead:Rr(Pe.dateRead)||Pe.dateRead||"",datePurchased:Rr(Pe.datePurchased)||Pe.datePurchased||"",msrp:Pe.msrp??"",specialType:Pe.specialType||"",specialVolumes:Pe.specialVolumes??"",collectiblePrice:Pe.collectiblePrice??"",amazonURL:Pe.amazonURL||"",read:!!Pe.read,hidden:!!Pe.hidden,kind:"wishlist"}))),I("")}catch(Ae){console.error("Offline fallback failed",Ae),I("Failed to load manga data from Firestore.")}finally{w||O(!1)}},ee=()=>{D&&q&&!w&&O(!1)};O(!0),I("");const X=rp(An(rt,"library"),Ae=>{if(w)return;const me=[];Ae.forEach(De=>{const de=De.data();me.push({id:De.id,title:de.title||"",authors:de.authors||"Unknown",publisher:de.publisher||"Unknown",demographic:de.demographic||"",genre:de.genre||"",subGenre:de.subGenre||"",date:de.date||"Unknown",cover:de.cover||"",isbn:de.isbn||"",pageCount:de.pageCount!==void 0&&de.pageCount!==null?de.pageCount:"",rating:de.rating!==void 0&&de.rating!==null?de.rating:"",amountPaid:de.amountPaid!==void 0&&de.amountPaid!==null?de.amountPaid:"",dateRead:de.dateRead||"",datePurchased:de.datePurchased||"",msrp:de.msrp!==void 0&&de.msrp!==null?de.msrp:"",specialType:de.specialType||"",specialVolumes:de.specialVolumes!==void 0&&de.specialVolumes!==null?de.specialVolumes:"",collectiblePrice:de.collectiblePrice!==void 0&&de.collectiblePrice!==null?de.collectiblePrice:"",read:!!de.read,amazonURL:de.amazonURL||"",hidden:!!de.hidden,kind:"library"})}),me.sort((De,de)=>{const ot=Pt(De.title),Pe=Pt(de.title),Je=ot.name.localeCompare(Pe.name);return Je!==0?Je:ot.vol-Pe.vol}),T(me),$(De=>{const de=new Set(De);return me.forEach(ot=>de.add(ot.title||"")),Array.from(de).filter(Boolean).sort()}),D=!0,ee()},async Ae=>{console.error("Library listener failed",Ae),w||(I("Failed to load manga data from Firestore."),await L())}),ne=rp(An(rt,"wishlist"),Ae=>{if(w)return;const me=[];Ae.forEach(De=>{const de=De.data();me.push({id:De.id,title:de.title||"",authors:de.authors||"Unknown",publisher:de.publisher||"Unknown",demographic:de.demographic||"",genre:de.genre||"",subGenre:de.subGenre||"",date:de.date||"Unknown",cover:de.cover||"",isbn:de.isbn||"",pageCount:de.pageCount!==void 0&&de.pageCount!==null?de.pageCount:"",rating:de.rating!==void 0&&de.rating!==null?de.rating:"",amountPaid:de.amountPaid!==void 0&&de.amountPaid!==null?de.amountPaid:"",datePurchased:de.datePurchased||"",specialType:de.specialType||"",specialVolumes:de.specialVolumes!==void 0&&de.specialVolumes!==null?de.specialVolumes:"",collectiblePrice:de.collectiblePrice!==void 0&&de.collectiblePrice!==null?de.collectiblePrice:"",amazonURL:de.amazonURL||"",hidden:!!de.hidden,kind:"wishlist"})}),me.sort((De,de)=>{const ot=Pt(De.title),Pe=Pt(de.title),Je=ot.name.localeCompare(Pe.name);return Je!==0?Je:ot.vol-Pe.vol}),F(me),$(De=>{const de=new Set(De);return me.forEach(ot=>de.add(ot.title||"")),Array.from(de).filter(Boolean).sort()}),q=!0,ee()},async Ae=>{console.error("Wishlist listener failed",Ae),w||(I("Failed to load manga data from Firestore."),await L())});return()=>{w=!0,X==null||X(),ne==null||ne()}},[e]);const cn=j.useMemo(()=>gR(_,S),[_,S]),Kt=j.useMemo(()=>{const w=N.trim().toLowerCase();return w?_.filter(D=>[D.title,D.authors,D.publisher,D.isbn,D.date,String(D.pageCount??"")].join(" ").toLowerCase().includes(w)):_},[_,N]),yr=w=>{const D=ka(w.title||""),q=cn.get(D);return q??!!w.hidden},cr=j.useMemo(()=>s&&_e?Kt:Kt.filter(w=>!yr(w)),[Kt,s,_e,cn]),un=j.useMemo(()=>{const w=U.trim().toLowerCase();return w?S.filter(D=>[D.title,D.authors,D.publisher,D.isbn,D.date,String(D.pageCount??"")].join(" ").toLowerCase().includes(w)):S},[S,U]),kn=j.useMemo(()=>s&&_e?un:un.filter(w=>!yr(w)),[un,s,_e,cn]),Mt=w=>{m(w==="individual"?"individual":"series"),ie(new Set),C(!1)},Dt=w=>{if(!(w!=null&&w.length))return;const D=(q,L)=>{let ee=[...q];return w.filter(X=>X.target===L).forEach(X=>{const ne=ee.findIndex(me=>me.id===X.id),Ae={...ne>=0?ee[ne]:{},...X.payload,id:X.id,kind:L};ne>=0?ee[ne]=Ae:ee.push(Ae)}),ee.sort(pR),ee};T(q=>D(q,"library")),F(q=>D(q,"wishlist"))},Xn=async(w,D,q=[])=>{if(!w)return;const L=new Set(q||[]),X=[..._,...S].filter(ne=>ka(ne.title||"")===w&&!L.has(ne.id)&&!!ne.hidden!==D);X.length&&(await Promise.all(X.map(ne=>fs(bt(rt,ne.kind==="wishlist"?"wishlist":"library",ne.id),{hidden:D}))),Dt(X.map(ne=>({target:ne.kind==="wishlist"?"wishlist":"library",id:ne.id,payload:{hidden:D}}))))},ur=w=>{C(D=>{const q=!D;if(q){const L=new Set((w||[]).map(ee=>ee.id));ie(ee=>new Set([...ee].filter(X=>L.has(X))))}else ie(new Set);return q})};function vr(){s&&(C(w=>!w),ie(new Set))}function Zn(w){ie(D=>{const q=new Set(D);return q.has(w)?q.delete(w):q.add(w),q})}async function Sn(w,D=null){if(!s){alert("Multi-select actions require admin access.");return}const q=Array.from(Y);if(!q.length){alert("Select at least one item first.");return}const L=l==="library"?"library":"wishlist",ee=D||(L==="library"?"wishlist":"library"),X=L==="library";try{if(w==="move"){const ne=L==="library"?_:S;if(!window.confirm(`Move ${q.length} item(s) from ${L==="library"?"Library":"Wishlist"} to ${ee==="library"?"Library":"Wishlist"}?`))return;for(const Ae of q){const me=ne.find(de=>de.id===Ae);if(!me)continue;const De=ee==="library"?{title:me.title,authors:me.authors,publisher:me.publisher,date:me.date,pageCount:me.pageCount||"",cover:me.cover,amountPaid:"",read:!1,rating:"",msrp:"",collectiblePrice:"",specialType:"",specialVolumes:"",isbn:me.isbn||"",demographic:me.demographic||"",genre:me.genre||"",subGenre:me.subGenre||"",hidden:!!me.hidden,datePurchased:me.datePurchased||"",dateRead:me.dateRead||""}:{title:me.title,authors:me.authors,publisher:me.publisher,date:me.date,pageCount:me.pageCount||"",cover:me.cover,amazonURL:me.amazonURL||"",hidden:!!me.hidden,datePurchased:"",read:!1,rating:"",msrp:"",collectiblePrice:"",specialType:"",specialVolumes:"",isbn:"",demographic:"",genre:"",subGenre:""};if(ee==="library"&&(De.msrp===""||De.msrp===null)){const de=pt(me);de!==""&&de!==null&&de!==void 0&&(De.msrp=de)}await Oa(An(rt,ee),De),await Ma(bt(rt,L,Ae))}a(`Moved ${q.length} item${q.length===1?"":"s"} from ${L==="library"?"Library":"Wishlist"} to ${ee==="library"?"Library":"Wishlist"}`,{action:"move",list:L==="library"?"Library":"Wishlist",details:{count:q.length,from:L,to:ee}})}else if(w==="markRead"&&X){for(const ne of q)await fs(bt(rt,"library",ne),{read:!0,dateRead:w_()});a(`Marked ${q.length} library book${q.length===1?"":"s"} as read`,{action:"markRead",list:"Library",details:{count:q.length}})}else if(w==="markUnread"&&X){for(const ne of q)await fs(bt(rt,"library",ne),{read:!1,dateRead:"",rating:""});a(`Marked ${q.length} library book${q.length===1?"":"s"} as unread`,{action:"markUnread",list:"Library",details:{count:q.length}})}else if(w==="delete"){const ne=X?"library":"wishlist";if(!window.confirm(`Delete ${q.length} item(s) from ${X?"Library":"Wishlist"}?`))return;for(const Ae of q)await Ma(bt(rt,ne,Ae));a(`Deleted ${q.length} item${q.length===1?"":"s"} from ${ne==="library"?"Library":"Wishlist"}`,{action:"delete-multi",list:ne==="library"?"Library":"Wishlist",details:{count:q.length}})}await Promise.all([At(),It()]),ie(new Set),C(!1)}catch(ne){console.error(ne),alert("Failed to apply multi-select action.")}}function Dr(w){qe(w)}function Qr(){qe(null)}function Yr(w){const D=$n.filter(q=>(Pt(q.title||"").name||(q.title||"").toLowerCase()||q.id)===w.key).sort((q,L)=>Pt(q.title).vol-Pt(L.title).vol);Et({series:w,volumes:D})}function vs(){Et(null)}const er=()=>{fe(w=>({...w,open:!1,mode:"add",editingId:null,data:{title:"",authors:"",publisher:"",demographic:"",genre:"",subGenre:"",date:"",cover:"",isbn:"",pageCount:"",rating:"",amountPaid:"",dateRead:"",datePurchased:"",msrp:"",special:!1,specialType:"",specialVolumes:"",collectiblePrice:"",amazonURL:"",read:!1,hidden:!1},multiAdd:!1,startVol:"",endVol:""})),Re([]),Q(0)},Zt=j.useMemo(()=>{const w=new Map;return[..._,...S].forEach(D=>{const q=Pt(D.title||"");if(!q.name)return;const L=(D.title||"").replace(/,?\s*Vol\.?\s*\d+.*/i,"").trim()||D.title||q.name;if(!w.has(q.name))w.set(q.name,{display:L,maxVol:q.vol,authors:D.authors||"",publisher:D.publisher||"",demographic:D.demographic||""});else{const ee=w.get(q.name);ee.maxVol=Math.max(ee.maxVol,q.vol),!ee.authors&&D.authors&&(ee.authors=D.authors),!ee.publisher&&D.publisher&&(ee.publisher=D.publisher),!ee.demographic&&D.demographic&&(ee.demographic=D.demographic)}}),w},[_,S]),dn=w=>{fe(D=>({...D,open:!0,mode:"add",list:w,editingId:null,data:{...D.data,title:"",list:w}})),Re([{kind:"new",id:null,data:{title:"",authors:"",publisher:"",demographic:"",genre:"",subGenre:"",date:"",cover:"",isbn:"",pageCount:"",rating:"",amountPaid:"",dateRead:"",datePurchased:"",msrp:"",specialType:"",specialVolumes:"",collectiblePrice:"",amazonURL:"",read:!1}}]),Q(0)},Jr=w=>{const D={open:!0,mode:"edit",list:w.kind==="wishlist"?"wishlist":"library",editingId:w.id,data:{title:w.title||"",authors:w.authors||"",publisher:w.publisher||"",demographic:w.demographic||"",genre:w.genre||"",subGenre:w.subGenre||"",date:w.date||"",cover:w.cover||"",isbn:w.isbn||"",pageCount:w.pageCount||"",rating:w.rating||"",amountPaid:w.amountPaid||"",dateRead:w.dateRead||"",datePurchased:w.datePurchased||"",msrp:w.msrp||"",special:!!(w.specialType||w.specialVolumes||w.collectiblePrice),specialType:w.specialType||"",specialVolumes:w.specialVolumes||"",collectiblePrice:w.collectiblePrice||"",amazonURL:w.amazonURL||"",read:!!w.read,hidden:!!w.hidden}};fe(D),Re([{kind:"edit",id:w.id,data:{...D.data}}]),Q(0)},ht=(w,D,q="text")=>{if(fe(L=>{const ee={...L.data,[w]:q==="checkbox"?!!D:D};if(w==="special"&&!D&&(ee.specialType="",ee.specialVolumes="",ee.collectiblePrice=""),w==="specialType"&&(D==="collectible"?ee.specialVolumes="":(D==="specialEdition"||(ee.specialVolumes=""),ee.collectiblePrice="")),w==="title"){const X=Pt(D||"");if(X.name&&Zt.has(X.name)){const ne=Zt.get(X.name);ee.authors=ne.authors||ee.authors,ee.publisher=ne.publisher||ee.publisher,ee.demographic=ne.demographic||ee.demographic}}return{...L,data:ee}}),Re(L=>{if(!L.length)return L;const ee=[...L],X={...ee[Ee]};return X.data={...X.data,[w]:q==="checkbox"?!!D:D},ee[Ee]=X,ee}),w==="title"){const L=String(D||"").trim().toLowerCase();if(!L)se([]);else{const ee=[];Zt.forEach(X=>{if(X.display.toLowerCase().includes(L)){const ne=X.maxVol>0?X.maxVol+1:1;ee.push(`${X.display}, Vol. ${ne}`)}}),se(ee.slice(0,6))}}},Dn=w=>{ce[w]&&(Q(w),fe(D=>{const q=ce[w];return{...D,data:{...q.data}}}))},Xr=()=>{const w=Ce.data.title||"",D=Pt(w);if(!D.name){alert("Provide a title with a volume number first (e.g., Series, Vol. 1).");return}const q={kind:Ce.mode,id:Ce.editingId,data:{...Ce.data}},L=ce.length?[...ce]:[];L.length?L[Ee]=q:L.push(q);const ee=w.replace(/,?\s*Vol\.?\s*\d+.*/i,"").trim()||w;let X=D.vol||0;const ne=Zt.get(D.name);ne&&ne.maxVol>X&&(X=ne.maxVol),L.forEach(de=>{const ot=Pt(de.data.title||"");ot.name===D.name&&(X=Math.max(X,ot.vol||0))});const Ae=(X||0)+1,De={title:`${ee}, Vol. ${Ae}`,authors:Ce.data.authors,publisher:Ce.data.publisher,demographic:Ce.data.demographic,genre:Ce.data.genre,subGenre:Ce.data.subGenre,msrp:Ce.data.msrp,hidden:Ce.data.hidden,cover:"",isbn:"",pageCount:"",rating:"",amountPaid:"",date:"",dateRead:"",datePurchased:"",special:!1,specialType:"",specialVolumes:"",collectiblePrice:"",amazonURL:"",read:!1};L.push({kind:"new",id:null,data:De}),Re(L),Q(L.length-1),fe(de=>({...de,mode:"add",data:De}))};async function _r(){if(!s)return;const{list:w}=Ce,D=w||"library",q=new Map,L=ce.length>0?ce:[{kind:Ce.mode,id:Ce.editingId,data:Ce.data}],ee=X=>{const ne=(X.title||"").trim(),Ae=Pt(ne),me=Zt.get(Ae.name)||{},De=(X.authors||"").trim()||me.authors||"",de=(X.publisher||"").trim()||me.publisher||"",ot=(X.demographic||"").trim()||me.demographic||"",Pe=(X.genre||"").trim()||me.genre||"",Je=(X.subGenre||"").trim()||me.subGenre||"";return{title:ne,authors:De,publisher:de,demographic:ot,genre:Pe,subGenre:Je,date:Rr(X.date||""),cover:(X.cover||"").trim(),isbn:D==="wishlist"?"":(X.isbn||"").trim(),pageCount:X.pageCount===""?"":Number(X.pageCount),rating:D==="wishlist"||X.rating===""?"":Math.max(.5,Math.min(5,Number(X.rating))),amountPaid:X.amountPaid===""?"":Number(X.amountPaid),dateRead:Rr(X.dateRead||""),datePurchased:Rr(X.datePurchased||""),msrp:D==="wishlist"||X.msrp===""?"":Number(X.msrp),special:D==="wishlist"?!1:!!(X.special&&(X.specialType||"").trim()),specialType:D==="wishlist"||!(X.special&&(X.specialType||"").trim())?"":(X.specialType||"").trim(),specialVolumes:D==="wishlist"?"":X.special&&X.specialType==="specialEdition"?X.specialVolumes===""?"":Number(X.specialVolumes):"",collectiblePrice:D==="wishlist"?"":X.special&&X.specialType==="collectible"?X.collectiblePrice===""?"":Number(X.collectiblePrice):"",amazonURL:(X.amazonURL||"").trim(),read:D==="wishlist"?!1:!!X.read,hidden:!!X.hidden,kind:w}};try{const X=await Promise.all(L.map(async me=>{const De=ee(me.data);if(D==="library"&&me.kind!=="edit"){const ot=Pt(De.title).name,Pe=_.filter(rn=>Pt(rn.title||rn.Title||"").name===ot),Je=Pe[0];if(Je&&(De.demographic=De.demographic||Je.demographic||Je.Demographic||"",De.genre=De.genre||Je.genre||Je.Genre||"",De.subGenre=De.subGenre||Je.subGenre||Je.SubGenre||"",De.msrp==="")){const rn=Pe.map(sn=>Number(sn.msrp??sn.MSRP)).filter(sn=>Number.isFinite(sn));rn.length>0&&rn.every(Er=>Er===rn[0])&&(De.msrp=rn[0])}}if(!De.title)throw alert("Title is required for every entry."),new Error("missing title");const de=ka(De.title);if(de&&q.set(de,De.hidden),me.kind==="edit"&&me.id)return await fs(bt(rt,D,me.id),De),{target:D,id:me.id,payload:De};{const ot=await Oa(An(rt,D),De);return{target:D,id:ot.id,payload:De}}}));Dt(X.filter(Boolean));const ne=new Map;X.forEach(me=>{var de;const De=ka(((de=me==null?void 0:me.payload)==null?void 0:de.title)||"");De&&(ne.has(De)||ne.set(De,new Set),ne.get(De).add(me.id))});const Ae=[...q.entries()].map(([me,De])=>Xn(me,De,Array.from(ne.get(me)||[])));Ae.length&&await Promise.all(Ae),await Promise.all([At(),It()]),a(`${Ce.mode==="add"?"Added":"Saved"} ${L.length} item${L.length===1?"":"s"} in ${D==="library"?"Library":"Wishlist"}`,{action:Ce.mode==="add"?"create":"update",list:D==="library"?"Library":"Wishlist",details:{entries:L.length,mode:Ce.mode}}),er()}catch(X){console.error(X),alert("Failed to save entry.")}}async function Vr(w,D){if(!s||!window.confirm("Delete this entry?"))return;const L=(D==="wishlist"?S:_).find(ee=>ee.id===w);try{await Ma(bt(rt,D,w)),await Promise.all([At(),It()]),a(`Deleted "${(L==null?void 0:L.title)||"Untitled"}" from ${D==="library"?"Library":"Wishlist"}`,{action:"delete-single",list:D==="library"?"Library":"Wishlist",details:{title:(L==null?void 0:L.title)||"Untitled"}})}catch(ee){console.error(ee),alert("Failed to delete entry.")}}const[Lr,Ds]=j.useState(!1),gn=()=>be({open:!1,index:0,items:[]});async function Vs(w,D,q={}){if(!(w!=null&&w.id))return;const L=w.kind==="wishlist"?"wishlist":"library";Ds(!0);try{await fs(bt(rt,L,w.id),D),Dt([{target:L,id:w.id,payload:D}]),await Promise.all([At(),It()]),a(`Updated "${w.title||"Untitled"}" in ${L==="library"?"Library":"Wishlist"}`,{action:q.action||"inline-update",list:L==="library"?"Library":"Wishlist",details:q.details||{title:w.title||"Untitled",fields:Object.keys(D||{}).join(", "),rating:D.rating??void 0}}),qe(ee=>ee&&ee.id===w.id?{...ee,...D}:ee)}catch(ee){console.error(ee),alert("Failed to update entry.")}finally{Ds(!1)}}const zt=(w,D)=>{const q=D===""?"":Math.max(.5,Math.min(5,Number(D)));Vs(w,{rating:q},{action:"rating",details:{title:w.title||"Untitled",rating:q}})},Zr=(w,D)=>{if(!w)return;const q=D?{read:!0,dateRead:w_(),rating:w.rating??""}:{read:!1,dateRead:"",rating:""};Vs(w,q,{action:D?"mark-read":"mark-unread",details:{title:w.title||"Untitled",dateRead:D?q.dateRead:"cleared",rating:w.rating||"not set"}})},Vn=()=>{if(!Y.size){alert("Select at least one entry first.");return}const D=[..._,...S].filter(L=>Y.has(L.id));if(!D.length){alert("No items selected.");return}const q=D.map(L=>({id:L.id,kind:L.kind||(l==="wishlist"?"wishlist":"library"),data:{title:L.title||"",authors:L.authors||"",publisher:L.publisher||"",demographic:L.demographic||"",genre:L.genre||"",subGenre:L.subGenre||"",date:L.date||"",cover:L.cover||"",isbn:L.isbn||"",pageCount:L.pageCount||"",rating:L.rating||"",amountPaid:L.amountPaid||"",dateRead:L.dateRead||"",datePurchased:L.datePurchased||"",msrp:L.msrp||"",special:!!(L.specialType||L.specialVolumes||L.collectiblePrice),specialType:L.specialType||"",specialVolumes:L.specialVolumes||"",collectiblePrice:L.collectiblePrice||"",amazonURL:L.amazonURL||"",read:!!L.read,hidden:!!L.hidden}}));be({open:!0,index:0,items:q})},Tt=(w,D,q="text")=>{be(L=>{const ee=[...L.items],X={...ee[L.index]},ne={...X.data,[w]:q==="checkbox"?!!D:D};return w==="special"&&!D&&(ne.specialType="",ne.specialVolumes="",ne.collectiblePrice=""),w==="specialType"&&(D==="collectible"?ne.specialVolumes="":(D==="specialEdition"||(ne.specialVolumes=""),ne.collectiblePrice="")),X.data=ne,ee[L.index]=X,{...L,items:ee}})},_s=()=>{be(w=>({...w,index:Math.min(w.index+1,w.items.length-1)}))},xr=()=>{be(w=>({...w,index:Math.max(w.index-1,0)}))};async function dr(){if(!s)return;const w=H.items,D=new Map;if(!w.length){gn();return}try{const q=await Promise.all(w.map(async X=>{const Ae=!(X.kind==="wishlist")&&!!(X.data.special&&(X.data.specialType||"").trim()),me={...X.data,pageCount:X.data.pageCount===""?"":Number(X.data.pageCount),rating:X.data.rating===""?"":Math.max(.5,Math.min(5,Number(X.data.rating))),amountPaid:X.data.amountPaid===""?"":Number(X.data.amountPaid),msrp:X.data.msrp===""?"":Number(X.data.msrp),special:Ae,specialType:Ae?X.data.specialType:"",collectiblePrice:Ae&&X.data.specialType==="collectible"?X.data.collectiblePrice===""?"":Number(X.data.collectiblePrice):"",specialVolumes:Ae&&X.data.specialType==="specialEdition"?X.data.specialVolumes===""?"":Number(X.data.specialVolumes):"",datePurchased:X.data.datePurchased||"",amazonURL:X.data.amazonURL||"",read:!!X.data.read},De=ka(me.title);De&&D.set(De,me.hidden);const de=X.kind==="wishlist"?"wishlist":"library";return await fs(bt(rt,de,X.id),me),{target:de,id:X.id,payload:me}}));Dt(q.filter(Boolean));const L=new Map;q.forEach(X=>{var Ae;const ne=ka(((Ae=X==null?void 0:X.payload)==null?void 0:Ae.title)||"");ne&&(L.has(ne)||L.set(ne,new Set),L.get(ne).add(X.id))});const ee=[...D.entries()].map(([X,ne])=>Xn(X,ne,Array.from(L.get(X)||[])));ee.length&&await Promise.all(ee),await Promise.all([At(),It()]),ie(new Set),C(!1),a(`Bulk edited ${w.length} item${w.length===1?"":"s"} in Library/Wishlist`,{action:"bulk-edit",list:"Library/Wishlist",details:{count:w.length}}),gn()}catch(q){console.error(q),alert("Failed to save bulk edits.")}}const Ls=w=>{const D=new Map;return w.forEach(q=>{const L=Pt(q.title||""),ee=L.name||(q.title||"").toLowerCase()||q.id,X=Zt.get(L.name)||null,ne=(X==null?void 0:X.display)||(q.title||"").replace(/,?\s*Vol\.?\s*\d+.*/i,"").trim()||q.title||"Untitled",Ae=bu(q,{includeIsbn:q.kind==="library",includeFinance:q.kind==="library"}),me=mR(q.title||""),De=Number.isFinite(L.vol)?L.vol:0,de=me.length>0?me:De>0?[De]:[],ot=de.length?de[0]:0,Pe=No(q);if(!D.has(ee))D.set(ee,{id:`series-${ee}`,key:ee,title:ne,authors:q.authors&&q.authors!=="Unknown"?q.authors:(X==null?void 0:X.authors)||"",publisher:q.publisher&&q.publisher!=="Unknown"?q.publisher:(X==null?void 0:X.publisher)||"",demographic:(X==null?void 0:X.demographic)||q.demographic||"",cover:q.cover||"",count:1,readCount:q.read?1:0,minVol:ot,maxVol:ot,representative:q,volumes:[...de],missingPageCount:Pe?1:0,missingMetaCount:Ae.any?1:0,missingVolumeCount:Pe||Ae.any?1:0});else{const Je=D.get(ee);if(Je.count+=1,q.read&&(Je.readCount+=1),Pe&&(Je.missingPageCount+=1),Ae.any&&(Je.missingMetaCount+=1),(Pe||Ae.any)&&(Je.missingVolumeCount+=1),de.length){const rn=Math.min(...de),sn=Math.max(...de);Je.minVol=Math.min(Je.minVol,rn),Je.maxVol=Math.max(Je.maxVol,sn),Je.volumes.push(...de)}!Je.cover&&q.cover&&(Je.cover=q.cover),!Je.authors&&q.authors&&q.authors!=="Unknown"&&(Je.authors=q.authors),!Je.publisher&&q.publisher&&q.publisher!=="Unknown"&&(Je.publisher=q.publisher)}}),Array.from(D.values())},Ja=w=>{const D=Array.from(new Set((w||[]).filter(ne=>Number.isFinite(ne)&&ne>=0))).sort((ne,Ae)=>ne-Ae);if(!D.length)return null;const q=[];let L=D[0],ee=D[0];for(let ne=1;ne<D.length;ne+=1){const Ae=D[ne];if(Ae===ee+1){ee=Ae;continue}q.push([L,ee]),L=Ae,ee=Ae}if(q.push([L,ee]),q.length===1){const[ne,Ae]=q[0];return ne===Ae?`Vol. ${ne}`:`Vol. ${ne}-${Ae}`}return`Vols. ${q.map(([ne,Ae])=>ne===Ae?`${ne}`:`${ne}-${Ae}`).join(", ")}`};function en(w){const D=Y.has(w.id),q=w.kind==="library",L=s&&No(w),ee=s?bu(w,{includeIsbn:q,includeFinance:q}):{any:!1,authorMissing:!1,publisherMissing:!1,dateMissing:!1,isbnMissing:!1},X=()=>{P&&s?Zn(w.id):Dr(w)};return o.jsxs("div",{className:"manga-card"+(w.read&&q?" read":"")+(D?" multiselect-selected":"")+(L?" missing-page":"")+(ee.any?" missing-meta":""),onClick:X,children:[o.jsx("div",{className:"manga-card-cover-wrap",children:o.jsx("img",{src:w.cover||"https://imgur.com/chUgq4W.png",alt:"Cover",loading:"lazy",decoding:"async"})}),o.jsxs("div",{className:"manga-card-body",children:[o.jsx("div",{className:"manga-card-title",children:w.title||"Untitled"}),o.jsxs("div",{className:"manga-card-meta",children:[o.jsx("span",{className:ee.authorMissing?"missing-field":"",children:w.authors&&w.authors!=="Unknown"?w.authors:ee.authorMissing?"Missing author":""}),o.jsx("br",{}),o.jsx("span",{className:ee.publisherMissing?"missing-field":"",children:w.publisher&&w.publisher!=="Unknown"?w.publisher:ee.publisherMissing?"Missing publisher":""}),o.jsx("br",{}),o.jsx("span",{className:ee.dateMissing?"missing-field":"",children:w.date&&w.date!=="Unknown"?w.date:ee.dateMissing?"Missing date":""})]}),w.isbn?o.jsxs("div",{className:"manga-card-isbn",children:["ISBN: ",w.isbn]}):q&&ee.isbnMissing&&o.jsx("div",{className:"manga-card-isbn missing-field",children:"Missing ISBN"}),s&&o.jsxs("div",{className:"manga-card-actions",children:[o.jsx("button",{type:"button",className:"manga-btn mini",onClick:ne=>{ne.stopPropagation(),Jr(w)},children:"Edit"}),o.jsx("button",{type:"button",className:"manga-btn mini danger",onClick:ne=>{ne.stopPropagation(),Vr(w.id,w.kind==="wishlist"?"wishlist":"library")},children:"Delete"})]})]})]},w.id)}function wr(w){var Ae;const D=Ja(w.volumes),q=`${w.count} volume${w.count===1?"":"s"}`;w.readCount>=w.count&&w.count>0||`${w.readCount}${w.count}`;const L=w.readCount>=w.count&&w.count>0,ee=s&&w.missingVolumeCount||0,X=ee>0,ne=[w.authors&&w.authors!=="Unknown"?w.authors:null,w.publisher&&w.publisher!=="Unknown"?w.publisher:null,D?`${q} - ${D}`:q].filter(Boolean);return o.jsxs("div",{className:"manga-card series-view"+(L?" read":"")+(X?" missing-page missing-meta":""),onClick:()=>Yr(w),children:[X&&o.jsx("div",{className:"missing-page-badge",title:"Volumes missing required data",children:ee}),o.jsx("div",{className:"manga-card-cover-wrap",children:o.jsx("img",{src:w.cover||((Ae=w.representative)==null?void 0:Ae.cover)||"https://imgur.com/chUgq4W.png",alt:"Cover",loading:"lazy",decoding:"async"})}),o.jsxs("div",{className:"manga-card-body",children:[o.jsx("div",{className:"manga-card-title",children:w.title||"Untitled Series"}),o.jsx("div",{className:"manga-card-meta",children:ne.map((me,De)=>o.jsxs(ap.Fragment,{children:[me,o.jsx("br",{})]},me+De))}),o.jsx("div",{className:"manga-card-series-count",children:q})]})]},w.id)}const yn=({value:w,onChange:D,interactive:q=!0})=>{const[L,ee]=j.useState(null),X=Math.max(0,Math.min(5,Number(w)||0)),ne=q&&L!=null?L:X,Ae=Array.from({length:10},(ot,Pe)=>(Pe+1)*.5),me=5,De=Array.from({length:me},(ot,Pe)=>Math.max(0,Math.min(1,ne-Pe))),de=q&&typeof D=="function";return o.jsxs("div",{className:`star-shell${de?"":" read-only"}`,role:"group","aria-label":"Rating",children:[o.jsxs("div",{className:"star-visual",style:{"--star-count":me},children:[o.jsx("div",{className:"star-row",children:De.map((ot,Pe)=>o.jsxs("div",{className:"star-icon",children:[o.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",className:"star-base",children:o.jsx("path",{d:"M12 2.5l2.9 5.88 6.5.95-4.7 4.58 1.1 6.43L12 17.9l-5.8 3.44 1.1-6.43-4.7-4.58 6.5-.95L12 2.5z"})}),o.jsx("div",{className:"star-fill",style:{"--pct":`${(Math.max(0,Math.min(1,ot))*100).toFixed(1)}%`},children:o.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:o.jsx("path",{d:"M12 2.5l2.9 5.88 6.5.95-4.7 4.58 1.1 6.43L12 17.9l-5.8 3.44 1.1-6.43-4.7-4.58 6.5-.95L12 2.5z"})})})]},Pe))}),de&&o.jsx("div",{className:"star-hit",children:Ae.map(ot=>o.jsx("button",{type:"button","aria-label":`${ot} stars`,onMouseEnter:()=>ee(ot),onMouseLeave:()=>ee(null),onClick:()=>D(ot)},ot))})]}),o.jsx("div",{className:"star-value",children:ne?ne.toFixed(1):"--"}),de&&o.jsx("button",{type:"button",className:"star-clear",onClick:()=>D(""),"aria-label":"Clear rating",children:"clear"})]})},$n=l==="library"?cr:kn,Qt=l==="library"?_:S,vn=j.useMemo(()=>Ls($n),[$n,Zt]),es=j.useMemo(()=>Ls(Qt),[Qt,Zt]);j.useEffect(()=>{if(!ge&&!Ye)return;const w=[..._,...S];if(ge){const D=w.find(q=>q.id===ge.id);D?(D.title!==ge.title||D.isbn!==ge.isbn||D.publisher!==ge.publisher||D.authors!==ge.authors||D.date!==ge.date||D.pageCount!==ge.pageCount||D.amountPaid!==ge.amountPaid||D.msrp!==ge.msrp||D.rating!==ge.rating||D.read!==ge.read||D.amazonURL!==ge.amazonURL)&&qe(D):qe(null)}if(Ye){const D=vn.find(ne=>ne.key===Ye.series.key);if(!D){Et(null);return}const q=$n.filter(ne=>(Pt(ne.title||"").name||(ne.title||"").toLowerCase()||ne.id)===D.key).sort((ne,Ae)=>Pt(ne.title).vol-Pt(Ae.title).vol),L=q.length===Ye.volumes.length&&q.every((ne,Ae)=>{var me;return((me=Ye.volumes[Ae])==null?void 0:me.id)===ne.id}),ee=q.length!==Ye.volumes.length||q.some((ne,Ae)=>{const me=Ye.volumes[Ae];return!me||me.id!==ne.id?!0:me.title!==ne.title||me.authors!==ne.authors||me.publisher!==ne.publisher||me.date!==ne.date||me.isbn!==ne.isbn||me.cover!==ne.cover||me.read!==ne.read||me.pageCount!==ne.pageCount||me.datePurchased!==ne.datePurchased||me.amountPaid!==ne.amountPaid||me.msrp!==ne.msrp||me.rating!==ne.rating}),X=D.title!==Ye.series.title||D.authors!==Ye.series.authors||D.publisher!==Ye.series.publisher||D.count!==Ye.series.count;(ee||X||!L)&&Et({series:D,volumes:q})}},[_,S,ge,Ye,$n,vn]);const Ln=f==="series"?vn:$n;f==="series"?vn.length:$n.length,f==="series"?es.length:Qt.length;const xs=(w,D)=>{if(!w.length)return;const q=Array.from(w.reduce((me,De)=>(Object.keys(De).forEach(de=>me.add(de)),me),new Set)),L=me=>{const De=me==null?"":String(me);return/[",\n]/.test(De)?`"${De.replace(/"/g,'""')}"`:De},ee=[q.join(",")].concat(w.map(me=>q.map(De=>L(me[De])).join(","))),X=new Blob([ee.join(`
`)],{type:"text/csv"}),ne=URL.createObjectURL(X),Ae=document.createElement("a");Ae.href=ne,Ae.download=D,Ae.click(),URL.revokeObjectURL(ne)},Ms=async(w,D)=>{const q=(ee,X="image")=>(ee||"").toString().toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"").slice(0,100)||X,L=w.filter(ee=>ee.cover).map((ee,X)=>({url:ee.cover,name:q(ee.title||`manga-${X+1}`,`manga-${X+1}`)}));if(!L.length){alert("No images found to download.");return}try{const ee=(await vc(async()=>{const{default:Pe}=await import("https://cdn.jsdelivr.net/npm/jszip@3.10.1/+esm");return{default:Pe}},[])).default,X=new ee,ne=X.folder("images"),Ae={},me=L.map(async(Pe,Je)=>{try{const sn=await(await fetch(Pe.url)).blob(),Er=(Pe.url.split(".").pop()||"jpg").split(/[?#]/)[0],_t=Pe.name||`image-${Je+1}`;Ae[_t]=(Ae[_t]||0)+1;const ts=Ae[_t]>1?`-${Ae[_t]}`:"";ne.file(`${_t}${ts}.${Er}`,sn)}catch(rn){console.warn("Failed to fetch image",Pe.url,rn)}});await Promise.all(me);const De=await X.generateAsync({type:"blob"}),de=URL.createObjectURL(De),ot=document.createElement("a");ot.href=de,ot.download=D,ot.click(),URL.revokeObjectURL(de)}catch(ee){console.error("Zip download failed",ee),alert("Failed to create zip. Please try again.")}},ti=(w,D)=>{const q=new Blob([JSON.stringify(w,null,2)],{type:"application/json"}),L=URL.createObjectURL(q),ee=document.createElement("a");ee.href=L,ee.download=D,ee.click(),URL.revokeObjectURL(L)},ni=w=>({title:w.title||"",authors:w.authors||"",publisher:w.publisher||"",demographic:w.demographic||"",genre:w.genre||"",subGenre:w.subGenre||"",date:w.date||"",pageCount:w.pageCount??"",cover:w.cover||"",amountPaid:w.amountPaid??"",read:!!w.read,rating:w.rating??"",dateRead:w.dateRead||"",datePurchased:w.datePurchased||"",msrp:w.msrp??"",collectiblePrice:w.collectiblePrice??"",specialType:w.specialType||"",specialVolumes:w.specialVolumes??"",isbn:w.isbn||"",amazonURL:w.amazonURL||"",hidden:!!w.hidden}),pt=w=>{const q=Pt(w.title||"").name;if(!q)return"";const ee=[..._,...S].map(ne=>{const me=Pt(ne.title||"").name===q,De=ne.msrp??ne.MSRP??"",de=String(De).trim();if(!me||!de)return null;const ot=Number(de);return Number.isFinite(ot)?ot:null}).filter(ne=>ne!==null);if(!ee.length)return"";const X=ee[0];return ee.every(ne=>ne===X)?X:""},bi=w=>{const q=Pt(w.title||"").name;if(!q)return{demographic:"",genre:"",subGenre:""};const ee=[..._,...S].find(X=>Pt(X.title||"").name===q&&(X.demographic||X.genre||X.subGenre));return{demographic:(ee==null?void 0:ee.demographic)||"",genre:(ee==null?void 0:ee.genre)||"",subGenre:(ee==null?void 0:ee.subGenre)||""}},hr=async w=>{if(!s||!(w!=null&&w.id))return;const D=w.kind==="wishlist"?"wishlist":"library",q=D==="library"?"wishlist":"library";try{const L=ni(w);if(q==="library"){const ee=pt(w);(L.msrp===""||L.msrp===null||L.msrp===void 0)&&(L.msrp=ee);const X=bi(w);L.demographic||(L.demographic=X.demographic),L.genre||(L.genre=X.genre),L.subGenre||(L.subGenre=X.subGenre)}await Oa(An(rt,q),L),await Ma(bt(rt,D,w.id)),await Promise.all([At(),It()]),Et(ee=>ee&&{...ee,volumes:ee.volumes.filter(X=>X.id!==w.id)}),Qr()}catch(L){console.error("Move failed",L),alert("Failed to move item.")}},tn=Ce.list==="wishlist",nn=H.items[H.index]||null,Mn=(nn==null?void 0:nn.kind)==="wishlist",Wn=j.useMemo(()=>{if(!nn)return{author:!1,publisher:!1,date:!1,purchaseDate:!1,page:!1,isbn:!1,amountPaid:!1,collectiblePrice:!1,msrp:!1};const w=nn.data||{},D=nn.kind==="library",q=D&&w.special&&w.specialType==="collectible",L=D&&!q;return{author:Ht(w.authors),publisher:Ht(w.publisher),date:Ht(w.date),purchaseDate:D?Ht(w.datePurchased):!1,page:No({pageCount:w.pageCount}),isbn:D?Ht(w.isbn):!1,amountPaid:L?Ht(w.amountPaid):!1,collectiblePrice:q?Ht(w.collectiblePrice):!1,msrp:D?Ht(w.msrp):!1}},[nn]);return o.jsxs("div",{className:"manga-page",children:[o.jsxs("header",{className:"manga-header",style:{flexDirection:"column",alignItems:"center",textAlign:"center"},children:[o.jsx("div",{className:"manga-header-title",style:{justifyContent:"center",gap:"0.6rem",fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Tyler's Manga Library"}),o.jsx("div",{className:"manga-header-sub",style:{textAlign:"center"},children:"This is my Manga Library and Wishlist. Check and see all the Manga I have in my possession!"})]}),Nt&&o.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"6px"},children:o.jsx("button",{className:"suggestion-trigger",type:"button",onClick:()=>{ve(""),Ve(!0)},children:"+ Suggestion"})}),o.jsxs("div",{className:"manga-tabs",children:[o.jsx("button",{className:"manga-tab-btn"+(l==="library"?" active":""),onClick:()=>{u("library"),C(!1),ie(new Set)},children:"Library"}),o.jsx("button",{className:"manga-tab-btn"+(l==="wishlist"?" active":""),onClick:()=>{u("wishlist"),C(!1),ie(new Set)},children:"Wishlist"})]}),l!=="dashboard"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"manga-toolbar",children:[o.jsxs("div",{className:"manga-toolbar-left",children:[o.jsx("input",{type:"text",className:"manga-search-input",placeholder:l==="library"?"Search library by title, author, ISBN...":"Search wishlist...",value:l==="library"?N:U,onChange:w=>l==="library"?A(w.target.value):V(w.target.value)}),o.jsx("div",{className:"manga-counter",children:(()=>{const w=l==="library",D=(w?N:U).trim(),q=w?_.length:S.length,L=w?Kt.length:un.length;return D?`${L} / ${q} Volumes`:`${q} Volumes`})()})]}),o.jsxs("div",{className:"manga-toolbar-right",children:[o.jsxs("div",{className:"manga-view-toggle",children:[o.jsx("button",{className:"manga-btn secondary"+(f==="series"?" active":""),type:"button","aria-pressed":f==="series","aria-label":"Series view",title:"Series View",onClick:()=>Mt("series"),children:""}),o.jsx("button",{className:"manga-btn secondary"+(f==="individual"?" active":""),type:"button","aria-pressed":f==="individual","aria-label":"Volume view",title:"Volume View",onClick:()=>Mt("individual"),children:""})]}),s&&o.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>ye(w=>!w),children:_e?"Hide Hidden":"Show Hidden"}),s&&o.jsx("button",{className:"manga-btn secondary"+(P?" active":""),disabled:f==="series",onClick:vr,children:P?"Exit Multi-select":"Multi-select"})]})]}),s&&P&&f==="individual"&&o.jsxs("div",{className:"manga-multiselect-bar",children:[o.jsxs("span",{children:["Selected: ",o.jsx("strong",{children:Y.size})]}),o.jsx("button",{className:"manga-btn",onClick:Vn,children:"Bulk Edit"}),o.jsxs("button",{className:"manga-btn secondary",onClick:()=>Sn("move"),children:["Move to ",l==="library"?"Wishlist":"Library"]}),l==="library"&&o.jsxs(o.Fragment,{children:[o.jsx("button",{className:"manga-btn",onClick:()=>Sn("markRead"),children:"Mark Read"}),o.jsx("button",{className:"manga-btn secondary",onClick:()=>Sn("markUnread"),children:"Mark Unread"})]}),o.jsx("button",{className:"manga-btn danger",onClick:()=>Sn("delete"),children:"Delete"})]})]}),we?o.jsx("div",{className:"manga-empty-state",children:"Loading manga from Firestore..."}):ae?o.jsx("div",{className:"manga-empty-state",children:ae}):Ln.length===0?o.jsx("div",{className:"manga-empty-state",children:"No manga found. Try changing your search."}):o.jsx("div",{className:"manga-grid",children:Ln.map(w=>f==="series"?wr(w):en(w))}),Ye&&o.jsx("div",{className:"manga-modal-backdrop visible",onClick:w=>{w.target===w.currentTarget&&vs()},children:o.jsx("div",{className:"manga-modal series",children:o.jsxs("div",{className:"manga-modal-body",children:[o.jsxs("div",{className:"manga-modal-header",children:[o.jsx("div",{className:"manga-modal-title",children:Ye.series.title||"Series"}),o.jsx("button",{className:"manga-modal-close",onClick:vs,type:"button","aria-label":"Close",children:"X"})]}),o.jsxs("div",{className:"manga-modal-subtitle",children:[Ye.series.count," volume",Ye.series.count===1?"":"s"," in this series"]}),s&&o.jsxs("div",{className:"series-bulk-controls",children:[o.jsx("button",{type:"button",className:"manga-btn mini secondary"+(P?" active":""),onClick:()=>ur(Ye.volumes),children:P?"Exit Multi-select":"Multi-select"}),P&&o.jsxs(o.Fragment,{children:[o.jsx("button",{type:"button",className:"manga-btn mini secondary",onClick:()=>{const w=Ye.volumes.map(D=>D.id);ie(new Set(w))},children:"Select All"}),o.jsx("button",{type:"button",className:"manga-btn mini secondary",onClick:()=>{ie(new Set)},children:"Clear"}),l==="wishlist"?o.jsx("button",{type:"button",className:"manga-btn mini",disabled:!Y.size,onClick:()=>{Y.size&&Sn("move","library")},children:"Move to Library"}):o.jsx("button",{type:"button",className:"manga-btn mini",disabled:!Y.size,onClick:()=>{Y.size&&Sn("move","wishlist")},children:"Move to Wishlist"}),o.jsxs("button",{type:"button",className:"manga-btn mini",disabled:!Y.size,onClick:()=>{if(!Y.size)return;const w=new Set(Ye.volumes.map(D=>D.id));ie(D=>new Set([...D].filter(q=>w.has(q)))),Vn()},children:["Bulk Edit Selected (",Y.size||0,")"]})]})]}),o.jsx("div",{className:"manga-series-modal-grid",children:Ye.volumes.map(w=>{const D=bu(w,{includeIsbn:w.kind==="library",includeFinance:w.kind==="library"});return o.jsxs("div",{className:"manga-card mini-card"+(w.read?" read":"")+(s&&No(w)?" missing-page":"")+(s&&D.any?" missing-meta":""),onClick:()=>{if(!s){Dr(w);return}if(P){Zn(w.id);return}Dr(w)},children:[o.jsxs("div",{className:"manga-card-cover-wrap",children:[P&&s&&o.jsx("div",{className:"mini-select-indicator"+(Y.has(w.id)?" selected":""),children:Y.has(w.id)?"X":""}),o.jsx("img",{src:w.cover||"https://imgur.com/chUgq4W.png",alt:w.title||"Cover",loading:"lazy",decoding:"async"})]}),o.jsxs("div",{className:"manga-card-body",children:[o.jsx("div",{className:"manga-card-title",children:w.title||"Untitled"}),o.jsxs("div",{className:"manga-card-meta",children:[o.jsx("span",{className:D.authorMissing?"missing-field":"",children:w.authors&&w.authors!=="Unknown"?w.authors:"Missing author"}),o.jsx("br",{}),o.jsx("span",{className:D.publisherMissing?"missing-field":"",children:w.publisher&&w.publisher!=="Unknown"?w.publisher:"Missing publisher"}),o.jsx("br",{}),o.jsx("span",{className:D.dateMissing?"missing-field":"",children:w.date&&w.date!=="Unknown"?w.date:"Missing date"})]}),w.isbn?o.jsxs("div",{className:"manga-card-isbn",children:["ISBN: ",w.isbn]}):w.kind==="library"&&D.isbnMissing&&o.jsx("div",{className:"manga-card-isbn missing-field",children:"Missing ISBN"})]})]},w.id)})})]})})}),s&&o.jsxs("div",{className:"manga-floating-actions",children:[o.jsxs("button",{className:"manga-btn",type:"button","aria-label":"Add item",onClick:()=>dn(l==="wishlist"?"wishlist":"library"),children:["+ ",l==="wishlist"?"Wishlist":"Library"]}),o.jsxs("div",{className:"manga-export-actions",children:[n&&o.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>ti({library:_,wishlist:S},"manga-library-wishlist.json"),children:"Export JSON"}),o.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>xs(l==="library"?_:S,l==="library"?"manga-library.csv":"manga-wishlist.csv"),children:"Export CSV"}),o.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>Ms(l==="library"?_:S,l==="library"?"manga-library-images.zip":"manga-wishlist-images.zip"),children:"Download Images"})]})]}),ge&&o.jsx("div",{className:"manga-modal-backdrop visible",onClick:w=>{w.target===w.currentTarget&&Qr()},children:o.jsxs("div",{className:"manga-modal",children:[o.jsxs("div",{className:"manga-modal-cover-wrap",children:[ge.kind==="library"&&ge.read&&o.jsx("div",{className:"manga-modal-read-pill",children:"Read"}),o.jsx("img",{src:ge.cover||"https://imgur.com/chUgq4W.png",alt:"Cover"})]}),o.jsxs("div",{className:"manga-modal-body",children:[o.jsxs("div",{className:"manga-modal-header",children:[o.jsx("div",{className:"manga-modal-title",children:ge.title||"Untitled"}),o.jsx("button",{className:"manga-modal-close",onClick:Qr,type:"button","aria-label":"Close",children:"X"})]}),o.jsxs("div",{className:"manga-modal-meta",children:[ge.authors&&ge.authors!=="Unknown"&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"Author(s):"})," ",ge.authors,o.jsx("br",{})]}),ge.publisher&&ge.publisher!=="Unknown"&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"Publisher:"})," ",ge.publisher,o.jsx("br",{})]}),ge.date&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"Release:"})," ",ge.date,o.jsx("br",{})]}),ge.isbn&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"ISBN:"})," ",ge.isbn,o.jsx("br",{})]})]}),o.jsxs("div",{className:"manga-modal-details",children:[ge.pageCount&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"Pages:"})," ",ge.pageCount,o.jsx("br",{})]}),o.jsxs("div",{style:{margin:"6px 0"},children:[o.jsx("strong",{children:"Rating:"})," ",o.jsx(yn,{value:ge.rating||"",onChange:s?w=>zt(ge,w):void 0,interactive:s})]}),ge.amountPaid&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"Amount Paid:"})," $",ge.amountPaid,o.jsx("br",{})]}),ge.msrp&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"MSRP:"})," $",ge.msrp,o.jsx("br",{})]}),ge.collectiblePrice&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"Collectible:"})," $",ge.collectiblePrice,o.jsx("br",{})]}),ge.read&&ge.dateRead&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"Date Read:"})," ",ge.dateRead,o.jsx("br",{})]}),ge.amazonURL&&o.jsx("div",{style:{marginTop:"6px"},children:o.jsx("a",{href:ge.amazonURL,target:"_blank",rel:"noreferrer",children:"View on Amazon"})})]}),o.jsxs("div",{className:"manga-modal-footer",style:{gap:"10px",alignItems:"center"},children:[o.jsx("div",{children:ge.kind==="library"&&ge.read?"Marked as read in your library.":ge.kind==="library"?"In your library (unread).":"Wishlist item - not in library yet."}),o.jsxs("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:[s&&o.jsx("button",{className:"manga-btn mini secondary",type:"button",onClick:()=>Jr(ge),children:"Edit"}),ge.kind==="library"&&s&&o.jsx(o.Fragment,{children:ge.read?o.jsx("button",{className:"manga-btn mini secondary",disabled:Lr,onClick:()=>Zr(ge,!1),type:"button",children:"Mark as unread"}):o.jsx("button",{className:"manga-btn mini",disabled:Lr,onClick:()=>Zr(ge,!0),type:"button",children:"Mark as read"})}),s&&o.jsxs("button",{className:"manga-btn mini",type:"button",onClick:()=>hr(ge),children:["Move to ",ge.kind==="library"?"Wishlist":"Library"]}),s&&o.jsx("button",{className:"manga-btn mini danger",type:"button",onClick:()=>Vr(ge.id,ge.kind==="library"?"library":"wishlist"),children:"Delete"})]})]})]})]})}),s&&Ce.open&&o.jsx("div",{className:"manga-modal-backdrop visible",onClick:w=>{w.target===w.currentTarget&&er()},children:o.jsx("div",{className:"manga-modal admin",children:o.jsxs("div",{className:"manga-modal-body",children:[o.jsxs("div",{className:"manga-modal-header",children:[o.jsx("div",{className:"manga-modal-title",children:Ce.mode==="add"?"Add Entry":"Edit Entry"}),o.jsx("button",{className:"manga-modal-close",onClick:er,type:"button","aria-label":"Close",children:"X"})]}),o.jsxs("div",{className:"admin-form-layout",children:[o.jsx("div",{className:"admin-cover-frame",children:o.jsx("img",{src:Ce.data.cover||"https://imgur.com/chUgq4W.png",alt:"Cover preview"})}),o.jsxs("div",{className:"admin-form-fields",children:[o.jsx("div",{className:"admin-row",children:o.jsxs("label",{children:["Title",o.jsx("input",{type:"text",value:Ce.data.title,onChange:w=>ht("title",w.target.value)})]})}),B.length>0&&o.jsx("div",{className:"title-suggestions",children:B.map((w,D)=>o.jsx("button",{type:"button",className:"manga-btn mini",onClick:()=>ht("title",w),children:w},w+D))}),o.jsxs("div",{className:"admin-row two",style:{alignItems:"flex-end",marginTop:"-8px"},children:[o.jsxs("div",{children:[o.jsxs("div",{className:"manga-modal-subtitle",style:{marginBottom:"6px"},children:["Entry ",Ee+1," / ",Math.max(1,ce.length||1)]}),o.jsxs("div",{style:{display:"flex",gap:"8px"},children:[o.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>Ee>0&&Dn(Ee-1),disabled:Ee===0,children:"Previous"}),o.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>ce.length&&Ee<ce.length-1?Dn(Ee+1):null,disabled:!ce.length||Ee===ce.length-1,children:"Next"})]})]}),o.jsxs("div",{style:{textAlign:"right"},children:[o.jsx("button",{className:"manga-btn",type:"button",onClick:Xr,disabled:!Pt(Ce.data.title||"").vol,children:"Add New Volume"}),o.jsx("div",{className:"manga-stat-sub",style:{marginTop:"4px"},children:"Auto-fills the next volume number for this series."})]})]}),o.jsx("div",{className:"admin-row",children:o.jsxs("label",{className:k.author?"missing-field-input":"",children:["Authors",o.jsx("input",{type:"text",value:Ce.data.authors,onChange:w=>ht("authors",w.target.value)})]})}),o.jsx("div",{className:"admin-row",children:o.jsxs("label",{className:k.publisher?"missing-field-input":"",children:["Publisher",o.jsx("input",{type:"text",value:Ce.data.publisher,onChange:w=>ht("publisher",w.target.value)})]})}),o.jsxs("div",{className:"admin-row three",children:[o.jsxs("label",{className:k.date?"missing-field-input":"",children:["Release Date",o.jsx("input",{type:"date",value:Ce.data.date,onChange:w=>ht("date",w.target.value)})]}),o.jsxs("label",{className:k.purchaseDate?"missing-field-input":"",children:["Purchase Date",o.jsx("input",{type:"date",value:Ce.data.datePurchased,onChange:w=>ht("datePurchased",w.target.value)})]}),!tn&&o.jsxs("label",{children:["Date Read",o.jsx("input",{type:"date",value:Ce.data.dateRead,onChange:w=>ht("dateRead",w.target.value)})]})]}),o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{className:k.page?"missing-field-input":"",children:["Page Count",o.jsx("input",{type:"number",placeholder:"e.g. 192",value:Ce.data.pageCount,onChange:w=>ht("pageCount",w.target.value)})]}),!tn&&o.jsxs("label",{className:k.isbn?"missing-field-input":"",children:["ISBN (library only)",o.jsx("input",{type:"text",value:Ce.data.isbn,onChange:w=>ht("isbn",w.target.value)})]})]}),o.jsx("div",{className:"admin-row",children:o.jsxs("label",{children:["Cover URL",o.jsx("input",{type:"text",placeholder:"Paste image URL here",value:Ce.data.cover,onChange:w=>ht("cover",w.target.value)})]})}),!tn&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"admin-row two",children:[!(Ce.data.special&&Ce.data.specialType==="collectible")&&o.jsxs("label",{className:k.amountPaid?"missing-field-input":"",children:["Amount Paid",o.jsx("input",{type:"number",step:"0.01",value:Ce.data.amountPaid,onChange:w=>ht("amountPaid",w.target.value)})]}),o.jsxs("label",{className:k.msrp?"missing-field-input":"",children:["MSRP",o.jsx("input",{type:"number",step:"0.01",value:Ce.data.msrp,onChange:w=>ht("msrp",w.target.value)})]})]}),o.jsx("div",{className:"admin-row",children:o.jsxs("label",{className:"checkbox-row",children:[o.jsx("input",{type:"checkbox",checked:!!Ce.data.special,onChange:w=>ht("special",w.target.checked,"checkbox")}),o.jsx("span",{children:"Special item?"})]})}),Ce.data.special&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{children:["Special Type",o.jsxs("select",{value:Ce.data.specialType,onChange:w=>ht("specialType",w.target.value),children:[o.jsx("option",{value:"",children:"Select type"}),o.jsx("option",{value:"specialEdition",children:"Special Edition"}),o.jsx("option",{value:"collectible",children:"Collectible"})]})]}),Ce.data.specialType==="collectible"&&o.jsxs("label",{className:k.collectiblePrice?"missing-field-input":"",children:["Collectible Price",o.jsx("input",{type:"number",step:"0.01",value:Ce.data.collectiblePrice,onChange:w=>ht("collectiblePrice",w.target.value)})]})]}),Ce.data.specialType==="specialEdition"&&o.jsx("div",{className:"admin-row",children:o.jsxs("label",{children:["Special Volumes",o.jsx("input",{type:"number",min:"0",value:Ce.data.specialVolumes,onChange:w=>ht("specialVolumes",w.target.value)})]})})]})]}),tn&&o.jsx("div",{className:"admin-row",children:o.jsxs("label",{children:["Amazon URL",o.jsx("input",{type:"text",value:Ce.data.amazonURL,onChange:w=>ht("amazonURL",w.target.value)})]})}),!tn&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"admin-row",children:o.jsxs("label",{children:["Rating (1-5 stars)",o.jsx(yn,{value:Ce.data.rating,onChange:w=>ht("rating",w)})]})}),o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{className:"checkbox-inline",children:[o.jsx("input",{type:"checkbox",checked:Ce.data.read,onChange:w=>ht("read",w.target.checked,"checkbox")}),o.jsx("span",{children:"Mark as read"})]}),o.jsxs("label",{className:"checkbox-inline",children:[o.jsx("input",{type:"checkbox",checked:!!Ce.data.hidden,onChange:w=>ht("hidden",w.target.checked,"checkbox")}),o.jsx("span",{children:"Hide from public"})]})]})]}),tn&&o.jsx("div",{className:"admin-row",children:o.jsxs("label",{className:"checkbox-inline",children:[o.jsx("input",{type:"checkbox",checked:!!Ce.data.hidden,onChange:w=>ht("hidden",w.target.checked,"checkbox")}),o.jsx("span",{children:"Hide from public"})]})})]})]}),o.jsxs("div",{className:"manga-modal-footer",style:{justifyContent:"flex-end",gap:"10px"},children:[o.jsx("button",{className:"manga-btn secondary",onClick:er,type:"button",children:"Cancel"}),o.jsx("button",{className:"manga-btn",onClick:_r,type:"button",children:Ce.mode==="add"?"Add":"Save"})]})]})})}),s&&H.open&&o.jsx("div",{className:"manga-modal-backdrop visible",onClick:w=>{w.target===w.currentTarget&&gn()},children:o.jsx("div",{className:"manga-modal admin",children:o.jsxs("div",{className:"manga-modal-body",children:[o.jsxs("div",{className:"manga-modal-header",children:[o.jsxs("div",{className:"manga-modal-title",children:["Bulk Edit (",H.index+1," / ",H.items.length,")"]}),o.jsx("button",{className:"manga-modal-close",onClick:gn,type:"button","aria-label":"Close",children:"X"})]}),H.items.length>0&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"manga-modal-subtitle",children:["Editing: ",H.items[H.index].data.title||"Untitled"]}),o.jsxs("div",{className:"admin-form-grid two-col",children:[o.jsx("div",{className:"admin-cover",children:o.jsx("div",{className:"manga-card-cover-wrap",children:o.jsx("img",{src:H.items[H.index].data.cover||"https://imgur.com/chUgq4W.png",alt:H.items[H.index].data.title||"Cover",loading:"lazy",decoding:"async"})})}),o.jsxs("div",{className:"admin-fields",children:[o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{className:"full",children:["Title",o.jsx("input",{type:"text",value:H.items[H.index].data.title,onChange:w=>Tt("title",w.target.value)})]}),o.jsxs("div",{className:"admin-entry-info",children:["Entry ",H.index+1," / ",H.items.length]})]}),o.jsx("div",{className:"admin-row",children:o.jsxs("label",{className:Wn.author?"missing-field-input":"",children:["Authors",o.jsx("input",{type:"text",value:H.items[H.index].data.authors,onChange:w=>Tt("authors",w.target.value)})]})}),o.jsx("div",{className:"admin-row",children:o.jsxs("label",{className:Wn.publisher?"missing-field-input":"",children:["Publisher",o.jsx("input",{type:"text",value:H.items[H.index].data.publisher,onChange:w=>Tt("publisher",w.target.value)})]})}),o.jsxs("div",{className:"admin-row three",children:[o.jsxs("label",{className:Wn.date?"missing-field-input":"",children:["Release Date",o.jsx("input",{type:"date",value:H.items[H.index].data.date,onChange:w=>Tt("date",w.target.value)})]}),o.jsxs("label",{className:Wn.purchaseDate?"missing-field-input":"",children:["Purchase Date",o.jsx("input",{type:"date",value:H.items[H.index].data.datePurchased,onChange:w=>Tt("datePurchased",w.target.value)})]}),!Mn&&o.jsxs("label",{children:["Date Read",o.jsx("input",{type:"date",value:H.items[H.index].data.dateRead,onChange:w=>Tt("dateRead",w.target.value)})]})]}),o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{className:Wn.page?"missing-field-input":"",children:["Page Count",o.jsx("input",{type:"number",value:H.items[H.index].data.pageCount,onChange:w=>Tt("pageCount",w.target.value)})]}),!Mn&&o.jsxs("label",{className:Wn.isbn?"missing-field-input":"",children:["ISBN (library only)",o.jsx("input",{type:"text",value:H.items[H.index].data.isbn,onChange:w=>Tt("isbn",w.target.value)})]})]}),o.jsx("div",{className:"admin-row",children:o.jsxs("label",{children:["Cover URL",o.jsx("input",{type:"text",value:H.items[H.index].data.cover,onChange:w=>Tt("cover",w.target.value)})]})}),!Mn&&o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{className:Wn.amountPaid?"missing-field-input":"",children:["Amount Paid",o.jsx("input",{type:"number",step:"0.01",value:H.items[H.index].data.amountPaid,onChange:w=>Tt("amountPaid",w.target.value)})]}),o.jsxs("label",{className:Wn.msrp?"missing-field-input":"",children:["MSRP",o.jsx("input",{type:"number",step:"0.01",value:H.items[H.index].data.msrp,onChange:w=>Tt("msrp",w.target.value)})]})]}),!Mn&&o.jsx("div",{className:"admin-row two",children:o.jsxs("div",{children:[o.jsx("div",{className:"star-label",children:"Rating (1-5 stars)"}),o.jsx(yn,{value:H.items[H.index].data.rating,onChange:w=>Tt("rating",w)})]})}),!Mn&&o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{className:"checkbox-row",children:[o.jsx("input",{type:"checkbox",checked:!!H.items[H.index].data.special,onChange:w=>Tt("special",w.target.checked,"checkbox")}),o.jsx("span",{children:"Special item?"})]}),o.jsxs("label",{className:"checkbox-row",children:[o.jsx("input",{type:"checkbox",checked:H.items[H.index].data.read,onChange:w=>Tt("read",w.target.checked,"checkbox")}),o.jsx("span",{children:"Mark as read"})]})]}),H.items[H.index].data.special&&!Mn&&o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{children:["Special Type",o.jsxs("select",{value:H.items[H.index].data.specialType,onChange:w=>Tt("specialType",w.target.value),children:[o.jsx("option",{value:"",children:"Select type"}),o.jsx("option",{value:"specialEdition",children:"Special Edition"}),o.jsx("option",{value:"collectible",children:"Collectible"})]})]}),H.items[H.index].data.specialType==="specialEdition"&&o.jsxs("label",{children:["Special Volumes",o.jsx("input",{type:"number",value:H.items[H.index].data.specialVolumes,onChange:w=>Tt("specialVolumes",w.target.value)})]}),H.items[H.index].data.specialType==="collectible"&&o.jsxs("label",{className:Wn.collectiblePrice?"missing-field-input":"",children:["Collectible Price",o.jsx("input",{type:"number",step:"0.01",value:H.items[H.index].data.collectiblePrice,onChange:w=>Tt("collectiblePrice",w.target.value)})]})]}),Mn&&o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{children:["Amazon URL",o.jsx("input",{type:"text",value:H.items[H.index].data.amazonURL,onChange:w=>Tt("amazonURL",w.target.value)})]}),o.jsxs("label",{className:"checkbox-row",children:[o.jsx("input",{type:"checkbox",checked:!!H.items[H.index].data.hidden,onChange:w=>Tt("hidden",w.target.checked,"checkbox")}),o.jsx("span",{children:"Hidden from public"})]})]}),!Mn&&o.jsx("div",{className:"admin-row",children:o.jsxs("label",{className:"checkbox-row",children:[o.jsx("input",{type:"checkbox",checked:!!H.items[H.index].data.hidden,onChange:w=>Tt("hidden",w.target.checked,"checkbox")}),o.jsx("span",{children:"Hidden from public"})]})})]})]}),o.jsxs("div",{className:"manga-modal-footer",style:{justifyContent:"space-between",gap:"10px"},children:[o.jsxs("div",{children:[o.jsx("button",{className:"manga-btn secondary",onClick:xr,type:"button",disabled:H.index===0,children:"Previous"}),o.jsx("button",{className:"manga-btn secondary",onClick:_s,type:"button",disabled:H.index===H.items.length-1,style:{marginLeft:"6px"},children:"Next"})]}),o.jsxs("div",{style:{display:"flex",gap:"8px"},children:[o.jsx("button",{className:"manga-btn secondary",onClick:gn,type:"button",children:"Cancel"}),o.jsx("button",{className:"manga-btn",onClick:dr,type:"button",children:"Save Edits"})]})]})]})]})})}),Nt&&o.jsx(yw,{open:Le,title:"Suggest a Manga",placeholder:"Type a manga you'd like me to collect/read...",value:Fe,status:st,loading:ue,onChange:Qe,onSubmit:y,onClose:()=>Ve(!1)}),o.jsx("datalist",{id:"adminTitleSuggestions",children:J.map(w=>o.jsx("option",{value:w},w))})]})}const vR="https://imokmalworker.imokissick.workers.dev/?url=",xw="im_ok",E_=300,_R={1:"watching",2:"completed",3:"on_hold",4:"dropped",6:"plan_to_watch"};function xR(n){const e=n==null?void 0:n.title_localized,t=typeof e=="string"?e:(e==null?void 0:e.en)||(e==null?void 0:e.english);return(n==null?void 0:n.anime_title_eng)||(n==null?void 0:n.title_english)||t||(n==null?void 0:n.anime_title)||(n==null?void 0:n.title)||"Untitled"}function wR(n){const e=(n==null?void 0:n.updated_at)??(n==null?void 0:n.updatedAt)??(n==null?void 0:n.updated_at_ms)??null;if(e==null)return null;const t=Number(e);if(Number.isFinite(t))return t<1e12?t*1e3:t;const s=Date.parse(e);return Number.isNaN(s)?null:s}function ER(n){const e=_R[n.status]||(typeof n.status=="string"?n.status.toLowerCase():"unknown");return{id:n.anime_id||n.id,title:xR(n),updatedAt:wR(n),episodes:n.anime_num_episodes??n.episodes??null,watchedEpisodes:n.num_watched_episodes??n.my_watched_episodes??n.watched_episodes??n.num_watched??0,status:e,score:n.score??null,image:n.anime_image_path||n.image_url||n.anime_img||n.picture||null,synopsis:n.anime_synopsis||n.synopsis||null}}function T_(){const n=Date.now();return[{id:1,title:"Cowboy Bebop",episodes:26,status:"completed",score:10,updatedAt:n-1e3*60*60*24*3,synopsis:"In 2071, bounty hunters Spike and Jet roam the solar system looking for their next payout and a place to belong."},{id:2,title:"Fullmetal Alchemist: Brotherhood",episodes:64,status:"completed",score:10,updatedAt:n-1e3*60*60*24*6,synopsis:"Brothers Edward and Alphonse Elric search for the Philosopher's Stone to restore their bodies after a failed alchemy ritual."},{id:3,title:"Frieren: Beyond Journey's End",episodes:28,status:"watching",score:9,updatedAt:n-1e3*60*60*8,synopsis:"An elven mage retraces the steps of a past adventure to understand humanity and the passage of time."},{id:4,title:"One Piece",episodes:1e3,status:"on_hold",score:8,updatedAt:n-1e3*60*60*24*14,synopsis:"Monkey D. Luffy sails toward the Grand Line seeking the One Piece and a crew to make his dream real."},{id:5,title:"Kaiju No. 8",episodes:12,status:"plan_to_watch",score:null,updatedAt:n-1e3*60*30,synopsis:"A middle-aged worker gains kaiju powers and joins the Defense Force to fight monsters from the inside."}]}async function TR(n,e){const t=`https://myanimelist.net/animelist/${n}/load.json?status=7&offset=${e}`,s=await fetch(`${vR}${encodeURIComponent(t)}`);if(!s.ok)throw new Error(`Failed to fetch MAL list (offset ${e})`);return s.json()}async function SR(n=xw){const e=[];try{let t=0;for(;;){const s=await TR(n,t);if(!Array.isArray(s)||s.length===0||(e.push(...s),s.length<E_))break;t+=E_}}catch(t){return console.error("Failed to load MAL list; falling back to sample data.",t),T_()}return e.length?e.map(ER):T_()}async function bR(n){var e,t;if(!n)return null;try{const s=await fetch(`https://api.jikan.moe/v4/anime/${n}`);if(!s.ok)throw new Error(`Failed to fetch Jikan summary for id ${n}`);const a=await s.json();return((e=a==null?void 0:a.data)==null?void 0:e.synopsis)||((t=a==null?void 0:a.data)==null?void 0:t.background)||null}catch(s){return console.error("Failed to load anime synopsis",n,s),null}}async function CR(n=xw){var e;if(!n)return null;try{const t=await fetch(`https://api.jikan.moe/v4/users/${encodeURIComponent(n)}/statistics`);if(!t.ok)throw new Error(`Failed to fetch user stats for ${n}`);const s=await t.json(),a=((e=s==null?void 0:s.data)==null?void 0:e.anime)||{},l=Number(a.days_watched),u=Number(a.total_episodes??a.episodes_watched);return{daysWatched:Number.isFinite(l)?l:null,episodesWatched:Number.isFinite(u)?u:null}}catch(t){return console.error("Failed to load user stats",n,t),null}}const S_=5,IR=3600*1e3,b_="animeSuggestionsSent";function NR(){const{admin:n,user:e,role:t}=Qa(),s=ue=>ue?ue.toString().replace(/_/g," ").replace(/\b\w/g,Oe=>Oe.toUpperCase()):"Unknown",[a,l]=j.useState([]),[u,f]=j.useState([]),[m,y]=j.useState(""),[_,T]=j.useState("all"),[S,F]=j.useState(!0),[J,$]=j.useState(""),[B,se]=j.useState(null),[_e,ye]=j.useState({}),[we,O]=j.useState(!1),[ae,I]=j.useState(!1),[N,A]=j.useState(null),[U,V]=j.useState(!1),[P,C]=j.useState(""),[Y,ie]=j.useState(""),[Ce,fe]=j.useState(!1);j.useEffect(()=>{document.title="Anime | Library"},[]),j.useEffect(()=>{ie("")},[e]);const ce=ue=>{if(!ue)return"";const Oe=Date.now()-ue,ge=Math.max(Oe,0),qe=Math.floor(ge/6e4);if(qe<1)return"just now";if(qe<60)return`${qe}m ago`;const Ye=Math.floor(qe/60);if(Ye<48)return`${Ye}h ago`;const Et=Math.floor(Ye/24);if(Et<14)return`${Et}d ago`;const Nt=Math.floor(Et/7);return Nt<8?`${Nt}w ago`:`${Math.floor(Et/30)}mo ago`},Re=(ue,Oe="image")=>(ue||"").toString().toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"").slice(0,80)||Oe,Ee=async()=>{const ue=a.filter(Oe=>Oe.image).map((Oe,ge)=>({url:Oe.image,name:Re(Oe.title||`anime-${ge+1}`,`anime-${ge+1}`)}));if(!ue.length){alert("No images found to download.");return}try{const Oe=(await vc(async()=>{const{default:It}=await import("https://cdn.jsdelivr.net/npm/jszip@3.10.1/+esm");return{default:It}},[])).default,ge=new Oe,qe=ge.folder("images"),Ye={};await Promise.all(ue.map(async(It,cn)=>{try{const yr=await(await fetch(It.url)).blob(),cr=(It.url.split(".").pop()||"jpg").split(/[?#]/)[0],un=It.name||`image-${cn+1}`;Ye[un]=(Ye[un]||0)+1;const kn=Ye[un]>1?`-${Ye[un]}`:"";qe.file(`${un}${kn}.${cr}`,yr)}catch(Kt){console.warn("Failed to fetch image",It.url,Kt)}}));const Et=await ge.generateAsync({type:"blob"}),Nt=URL.createObjectURL(Et),At=document.createElement("a");At.href=Nt,At.download="anime-images.zip",At.click(),URL.revokeObjectURL(Nt)}catch(Oe){console.error("Zip download failed",Oe),alert("Failed to create zip. Please try again.")}};j.useEffect(()=>{async function ue(){try{const Oe=await SR();l(Oe),f(Oe)}catch(Oe){console.error(Oe),$("Failed to load data from MAL.")}finally{F(!1)}}ue()},[]),j.useEffect(()=>{CR().then(ue=>{ue&&A(ue)}).catch(()=>{})},[]);const Q=ue=>{switch((ue||"unknown").toLowerCase()){case"watching":return 0;case"completed":return 1;case"on_hold":return 2;case"plan_to_watch":return 3;case"dropped":return 4;default:return 5}},k=ue=>{const Oe=Number.isFinite(Number(ue.watchedEpisodes))?Number(ue.watchedEpisodes):0,ge=Number.isFinite(Number(ue.episodes))?Number(ue.episodes):null;return ge?`${Math.min(Oe,ge)}/${ge} eps`:Oe?`${Oe} eps`:"No progress"};j.useEffect(()=>{let ue=[...a];if(_!=="all"&&(ue=ue.filter(Oe=>(Oe.status||"").toLowerCase()===_)),m){const Oe=m.toLowerCase();ue=ue.filter(ge=>(ge.title||"").toLowerCase().includes(Oe))}ue.sort((Oe,ge)=>{const qe=Q(Oe.status),Ye=Q(ge.status);return qe!==Ye?qe-Ye:(Oe.title||"").localeCompare(ge.title||"")}),f(ue)},[a,_,m]);const H=j.useMemo(()=>[...a].filter(ue=>Number.isFinite(ue.updatedAt)).sort((ue,Oe)=>Oe.updatedAt-ue.updatedAt).slice(0,6),[a]),be=!!e&&t==="viewer",Le=async()=>{const ue=Date.now(),ge=(()=>{try{const qe=localStorage.getItem(b_);return Array.isArray(JSON.parse(qe))?JSON.parse(qe):[]}catch{return[]}})().filter(qe=>ue-qe<IR);if(ge.length>=S_){ie("Rate limit: please wait a bit (max 5 suggestions per hour).");return}if(!P.trim()){ie("Please enter a title or note before sending.");return}fe(!0),ie("");try{const qe=`**Anime Suggestion**
${P.trim()}
From: ${(e==null?void 0:e.displayName)||(e==null?void 0:e.email)||(e==null?void 0:e.uid)||"anonymous user"}`;await Oa(An(rt,"suggestions"),{content:P.trim(),type:"anime",from:(e==null?void 0:e.displayName)||(e==null?void 0:e.email)||(e==null?void 0:e.uid)||"anonymous user",createdAt:new Date().toISOString()}),ie("Sent! I'll review your suggestion soon."),C("");const Ye=[...ge,ue].slice(-S_);localStorage.setItem(b_,JSON.stringify(Ye))}catch(qe){console.error("Failed to send suggestion",qe),ie("Failed to send suggestion. Please try again later.")}finally{fe(!1)}};j.useEffect(()=>{if(!B){I(!1),O(!1);return}I(!!B.synopsis),O(!1)},[B==null?void 0:B.id]);const Ve=j.useMemo(()=>{const ue=a.length,Oe=a.reduce((Nt,At)=>{const It=Number(At.watchedEpisodes);return Number.isFinite(It)?Nt+It:Nt},0),ge=Oe*.4,qe=a.filter(Nt=>Number.isFinite(Nt.score)&&Nt.score>0),Ye=qe.reduce((Nt,At)=>Nt+At.score,0),Et={watching:0,completed:0,on_hold:0,dropped:0,plan_to_watch:0,unknown:0};return a.forEach(Nt=>{const At=(Nt.status||"unknown").toLowerCase();Et[At]!=null?Et[At]+=1:Et.unknown+=1}),{total:ue,totalWatchedEpisodes:Oe,byStatus:Et,avgScore:qe.length?Ye/qe.length:0,totalHours:ge}},[a]),Fe=(N==null?void 0:N.daysWatched)??(Ve.totalHours||0)/24,Qe=(N==null?void 0:N.episodesWatched)??Ve.totalWatchedEpisodes,st=ue=>{const Oe=ue.image||"https://imgur.com/chUgq4W.png",ge=Number.isFinite(Number(ue.watchedEpisodes))?Number(ue.watchedEpisodes):0,qe=Number.isFinite(Number(ue.episodes))?Number(ue.episodes):null,Ye=qe?`Episode ${Math.min(ge,qe)}/${qe}`:`Episode ${ge}`,Et=Number.isFinite(Number(ue.score))&&Number(ue.score)>0?ue.score:"Not rated";return o.jsxs("article",{className:"anime-card",onClick:()=>se(ue.synopsis?ue:{...ue,synopsis:_e[ue.id]}),children:[o.jsxs("div",{className:"anime-cover-wrap",children:[o.jsx("img",{className:"anime-cover",src:Oe,alt:ue.title,loading:"lazy",decoding:"async"}),o.jsx("div",{className:`badge-status ${(ue.status||"unknown").toLowerCase()}`,children:s(ue.status)}),ue.score!=null&&o.jsx("div",{className:"badge-score",children:Et})]}),o.jsxs("div",{className:"anime-meta",children:[o.jsx("div",{className:"anime-title",title:ue.title,children:ue.title}),o.jsx("div",{className:"anime-sub",children:ue.episodes?`${ue.episodes} episodes`:"Episodes: ?"}),o.jsx("div",{className:"anime-progress",children:Ye}),o.jsxs("div",{className:"anime-progress",children:["Status: ",s(ue.status)]})]})]},ue.id||ue.title)},ve=ue=>o.jsxs("article",{className:"anime-update-card",children:[o.jsx("div",{className:"anime-update-title",title:ue.title,children:ue.title}),o.jsxs("div",{className:"anime-update-meta",children:[o.jsx("span",{className:"anime-update-progress",children:k(ue)}),o.jsx("span",{className:"anime-update-dot","aria-hidden":"true",children:""}),o.jsx("span",{className:"anime-update-status",children:s(ue.status)})]}),o.jsx("div",{className:"anime-update-time",children:ce(ue.updatedAt)})]},`update-${ue.id||ue.title}`);return o.jsxs("main",{className:"anime-page",children:[o.jsxs("div",{className:"anime-content",children:[o.jsxs("header",{className:"anime-header",style:{position:"relative",display:"flex",justifyContent:"center",alignItems:"center",textAlign:"center",width:"100%"},children:[o.jsxs("div",{style:{textAlign:"center",margin:"0 auto",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"0 60px"},children:[o.jsx("h1",{className:"anime-title",style:{margin:0,fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Tyler's Anime Library"}),o.jsx("p",{className:"anime-sub",style:{textAlign:"center",margin:"6px 0 0"},children:"The Anime I've watched/watching synced directly from MAL (MyAnimeList)"})]}),(be||n)&&o.jsxs("div",{style:{position:"absolute",right:0,top:"50%",transform:"translateY(-50%)",display:"flex",gap:"10px"},children:[be&&o.jsx("button",{className:"suggestion-trigger",type:"button",onClick:()=>{ie(""),V(!0)},children:"+ Suggestion"}),n&&o.jsx("button",{className:"stat-link",type:"button",onClick:Ee,children:"Download Images"})]})]}),o.jsxs("div",{className:"anime-stats",children:[o.jsxs("div",{className:"anime-stat-card",children:[o.jsx("div",{className:"anime-stat-label",children:"Total Entries"}),o.jsx("div",{className:"anime-stat-value",children:Ve.total})]}),o.jsxs("div",{className:"anime-stat-card",children:[o.jsx("div",{className:"anime-stat-label",children:"Episodes Watched"}),o.jsx("div",{className:"anime-stat-value",children:Qe})]}),o.jsxs("div",{className:"anime-stat-card",children:[o.jsx("div",{className:"anime-stat-label",children:"Watching"}),o.jsx("div",{className:"anime-stat-value",children:Ve.byStatus.watching})]}),o.jsxs("div",{className:"anime-stat-card",children:[o.jsx("div",{className:"anime-stat-label",children:"Completed"}),o.jsx("div",{className:"anime-stat-value",children:Ve.byStatus.completed})]}),o.jsxs("div",{className:"anime-stat-card",children:[o.jsx("div",{className:"anime-stat-label",children:"Plan to Watch"}),o.jsx("div",{className:"anime-stat-value",children:Ve.byStatus.plan_to_watch})]}),o.jsxs("div",{className:"anime-stat-card",children:[o.jsx("div",{className:"anime-stat-label",children:"Avg. Score"}),o.jsx("div",{className:"anime-stat-value",children:Ve.avgScore?Ve.avgScore.toFixed(1):"0.0"})]}),o.jsxs("div",{className:"anime-stat-card",children:[o.jsx("div",{className:"anime-stat-label",children:"Days Watched"}),o.jsx("div",{className:"anime-stat-value",children:Fe.toFixed(1)})]})]}),o.jsxs("section",{className:"anime-toolbar",children:[o.jsx("input",{type:"text",placeholder:"Search anime by title...",value:m,onChange:ue=>y(ue.target.value),className:"anime-input"}),o.jsxs("select",{value:_,onChange:ue=>T(ue.target.value),className:"anime-select",children:[o.jsx("option",{value:"all",children:"All statuses"}),o.jsx("option",{value:"watching",children:"Watching"}),o.jsx("option",{value:"completed",children:"Completed"}),o.jsx("option",{value:"on_hold",children:"On Hold"}),o.jsx("option",{value:"plan_to_watch",children:"Plan to Watch"}),o.jsx("option",{value:"dropped",children:"Dropped"})]})]}),S&&o.jsx("div",{className:"loading",children:"Loading anime list from MAL..."}),J&&o.jsx("div",{className:"error-state",children:J}),!S&&!J&&o.jsx(o.Fragment,{children:u.length===0?o.jsx("div",{className:"empty-state",children:"No results match your filters yet."}):o.jsx("section",{className:"anime-grid",children:u.map(ue=>st(ue))})})]}),H.length>0&&o.jsxs("aside",{className:"anime-updates-float",children:[o.jsxs("div",{className:"anime-updates-header",children:[o.jsx("h3",{children:"Recent Updates"}),o.jsx("span",{className:"anime-updates-caption",children:"Last list activity"})]}),o.jsx("div",{className:"anime-updates-list",children:H.map(ue=>ve(ue))})]}),be&&o.jsx(yw,{open:U,title:"Suggest an Anime",placeholder:"Type an anime you'd like me to watch...",value:P,status:Y,loading:Ce,onChange:C,onSubmit:Le,onClose:()=>V(!1)}),B&&o.jsx("div",{className:"modal-backdrop visible",onClick:ue=>{ue.target===ue.currentTarget&&se(null)},children:o.jsxs("div",{className:"anime-modal",children:[o.jsxs("div",{className:"anime-modal-header",children:[o.jsx("h2",{style:{color:"#ffb6c1",margin:0},children:B.title}),o.jsx("button",{className:"anime-modal-close",onClick:()=>se(null),type:"button","aria-label":"Close",children:"X"})]}),o.jsxs("div",{className:"anime-modal-body",children:[o.jsx("div",{children:o.jsx("img",{className:"anime-modal-cover",src:B.image||"https://imgur.com/chUgq4W.png",alt:B.title})}),o.jsxs("div",{className:"anime-modal-meta",children:[o.jsxs("div",{children:[o.jsx("strong",{children:"Status:"})," ",s(B.status)]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Episodes:"})," ",B.episodes?B.episodes:"Unknown"]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Progress:"})," ",Number.isFinite(Number(B.watchedEpisodes))?`Episode ${B.watchedEpisodes}${Number.isFinite(Number(B.episodes))?`/${B.episodes}`:""}`:"Unknown"]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Score:"})," ",Number.isFinite(Number(B.score))&&Number(B.score)>0?B.score:"Not rated"]})]}),o.jsx(PR,{modalItem:B,modalLoading:we,modalSynopsisShown:ae,onReveal:async()=>{if(!B)return;I(!0);const ue=B.id;if(!ue)return;const Oe=_e[ue];if(Oe!==void 0){se(ge=>ge&&{...ge,synopsis:Oe});return}O(!0);try{const ge=await bR(ue);ye(qe=>({...qe,[ue]:ge||""})),se(qe=>qe&&{...qe,synopsis:ge||""})}catch{ye(qe=>({...qe,[ue]:""})),se(qe=>qe&&{...qe,synopsis:""})}finally{O(!1)}}})]})]})})]})}function PR({modalItem:n,modalLoading:e,modalSynopsisShown:t,onReveal:s}){var m;const a=((m=n==null?void 0:n.synopsis)==null?void 0:m.trim())||"",[l,u]=j.useState(0),f=j.useRef(null);return j.useEffect(()=>{if(t&&f.current){const y=f.current.scrollHeight+12;u(y)}else u(0)},[t,a]),o.jsxs("div",{className:"anime-modal-summary",children:[o.jsxs("div",{className:"anime-modal-summary-header",children:[o.jsx("h3",{children:"Synopsis"}),!t&&o.jsx("button",{className:"anime-synopsis-btn",type:"button",onClick:s,children:e?"Loading...":"Reveal Synopsis"})]}),o.jsx("div",{className:`anime-modal-summary-body ${t?"is-open":""}`,style:{maxHeight:t?`${l}px`:0,opacity:t?1:0},children:o.jsx("div",{ref:f,children:o.jsx("p",{className:"anime-modal-summary-text",children:e&&!a?"Loading synopsis...":a||"No synopsis available."})})}),!t&&o.jsx("p",{className:"anime-modal-summary-text anime-modal-summary-hint",children:"Synopsis hidden. Click reveal to view."})]})}function RR(){const n={game:"pokemon",name:"",setName:"",number:"",rarity:"",condition:"",quantity:1,pricePaid:"",estimatedValue:"",image:"",productURL:"",notes:""},{admin:e,user:t}=Qa(),[s,a]=j.useState(()=>localStorage.getItem("tcgLastGame")||n.game),[l,u]=j.useState([]),[f,m]=j.useState(!0),[y,_]=j.useState(""),[T,S]=j.useState("all"),[F,J]=j.useState("name"),[$,B]=j.useState(!1),[se,_e]=j.useState([]),[ye,we]=j.useState(""),[O,ae]=j.useState(null),[I,N]=j.useState(!1),[A,U]=j.useState(()=>({...n,game:s}));j.useEffect(()=>{document.title="TCG | Collection"},[]),j.useEffect(()=>{let k=!1;const H=async()=>{if(!k)try{const Ve=await fetch("/base/tcg-collection.json",{cache:"no-cache"});if(!Ve.ok)throw new Error("fallback fetch failed");const Fe=await Ve.json(),Qe=Array.isArray(Fe.tcg)?Fe.tcg:[];k||u(Qe.map((st,ve)=>({id:st.id||`offline-${ve}`,...st})))}catch(Le){console.error("TCG offline fallback failed",Le)}finally{k||m(!1)}};async function be(){m(!0);try{const Le=An(rt,"tcg"),Ve=await Ns(Le),Fe=[];Ve.forEach(Qe=>Fe.push({id:Qe.id,...Qe.data()})),k||u(Fe)}catch(Le){console.error("Error loading TCG:",Le),await H()}finally{k||m(!1)}}return be(),()=>{k=!0}},[t]);const V=l.filter(k=>{if(T!=="all"&&k.game!==T)return!1;if(!y)return!0;const H=y.toLowerCase();return(k.name||"").toLowerCase().includes(H)||(k.setName||"").toLowerCase().includes(H)||(k.number||"").toLowerCase().includes(H)}),P=[...V].sort((k,H)=>{const be=(k.name||"").toLowerCase(),Le=(H.name||"").toLowerCase(),Ve=(k.setName||"").toLowerCase(),Fe=(H.setName||"").toLowerCase(),Qe=(k.rarity||"").toLowerCase(),st=(H.rarity||"").toLowerCase(),ve=Number(k.quantity||0),ue=Number(H.quantity||0),Oe=Number(k.estimatedValue||0)*Math.max(1,ve),ge=Number(H.estimatedValue||0)*Math.max(1,ue);switch(F){case"set":return Ve.localeCompare(Fe)||be.localeCompare(Le);case"rarity":return Qe.localeCompare(st)||be.localeCompare(Le);case"quantity":return ue-ve||be.localeCompare(Le);case"value":return ge-Oe||be.localeCompare(Le);case"name":default:return be.localeCompare(Le)}}),C=l.reduce((k,H)=>{const be=Number(H.quantity||1),Le=Number(H.pricePaid||0),Ve=Number(H.estimatedValue||0);k.totalCards+=be,k.totalPaid+=be*Le,k.totalValue+=be*Ve;const Fe=(H.game||"").toLowerCase(),Qe=be*Ve;return Fe==="pokemon"?(k.pokemon+=be,k.valueByGame.pokemon+=Qe):Fe==="onepiece"?(k.onepiece+=be,k.valueByGame.onepiece+=Qe):Fe==="mtg"?(k.mtg+=be,k.valueByGame.mtg+=Qe):k.valueByGame.other+=Qe,k},{totalCards:0,totalPaid:0,totalValue:0,pokemon:0,onepiece:0,mtg:0,valueByGame:{pokemon:0,onepiece:0,mtg:0,other:0}}),Y=C.totalValue-C.totalPaid,ie=[["Pokemon",C.valueByGame.pokemon],["One Piece",C.valueByGame.onepiece],["MTG",C.valueByGame.mtg],["Other",C.valueByGame.other]].filter(([,k])=>k>0).map(([k,H])=>`${k}: $${H.toFixed(2)}`),Ce=ie.length?ie.join(`
`):"No value data yet",fe=(k,H)=>{if(k==="game"){a(H);try{localStorage.setItem("tcgLastGame",H)}catch{}}U(be=>({...be,[k]:H}))},ce=async()=>{if(!e)return;if(!A.name.trim()){alert("Card name is required.");return}const k={game:A.game,name:A.name.trim(),setName:A.setName.trim(),number:A.number.trim(),rarity:A.rarity.trim(),condition:A.condition.trim(),quantity:Number(A.quantity||1),pricePaid:Number(A.pricePaid||0),estimatedValue:Number(A.estimatedValue||0),image:A.image.trim(),productURL:A.productURL.trim(),notes:A.notes.trim()},H=Ve=>({game:(Ve.game||"").toLowerCase().trim(),name:(Ve.name||"").toLowerCase().trim(),setName:(Ve.setName||"").toLowerCase().trim(),number:(Ve.number||"").toLowerCase().trim(),rarity:(Ve.rarity||"").toLowerCase().trim(),condition:(Ve.condition||"").toLowerCase().trim(),pricePaid:Number(Ve.pricePaid||0),estimatedValue:Number(Ve.estimatedValue||0),image:(Ve.image||"").trim(),productURL:(Ve.productURL||"").trim(),notes:(Ve.notes||"").trim()}),be=H(k),Le=l.find(Ve=>{const Fe=H(Ve);return Fe.game===be.game&&Fe.name===be.name&&Fe.setName===be.setName&&Fe.number===be.number&&Fe.rarity===be.rarity&&Fe.condition===be.condition&&Fe.pricePaid===be.pricePaid&&Fe.estimatedValue===be.estimatedValue&&Fe.image===be.image&&Fe.productURL===be.productURL&&Fe.notes===be.notes});try{const Ve=An(rt,"tcg");if(Le!=null&&Le.id){const Fe=Number(Le.quantity||1)+k.quantity;await fs(bt(rt,"tcg",Le.id),{quantity:Fe}),u(Qe=>Qe.map(st=>st.id===Le.id?{...st,quantity:Fe}:st))}else{await Oa(Ve,k);const Fe=await Ns(Ve),Qe=[];Fe.forEach(st=>Qe.push({id:st.id,...st.data()})),u(Qe)}U({...n,game:s}),N(!1)}catch(Ve){console.error("Error adding card:",Ve),alert("Failed to save card.")}},Re=async()=>{if(!e||!O)return;if(!O.name.trim()){alert("Card name is required.");return}const k={game:O.game,name:O.name.trim(),setName:O.setName.trim(),number:O.number.trim(),rarity:O.rarity.trim(),condition:O.condition.trim(),quantity:Number(O.quantity||1),pricePaid:Number(O.pricePaid||0),estimatedValue:Number(O.estimatedValue||0),image:O.image?O.image.trim():"",productURL:O.productURL?O.productURL.trim():"",notes:O.notes?O.notes.trim():""};try{await fs(bt(rt,"tcg",O.id),k),u(H=>H.map(be=>be.id===O.id?{...be,...k}:be)),ae(null)}catch(H){console.error("Error updating card:",H),alert("Failed to update card.")}},Ee=async k=>{if(e&&window.confirm("Delete this card?"))try{await Ma(bt(rt,"tcg",k)),u(H=>H.filter(be=>be.id!==k))}catch(H){console.error("Delete error:",H),alert("Failed to delete card.")}},Q=()=>{if(!l.length){alert("No cards to export.");return}const k=new Blob([JSON.stringify({tcg:l},null,2)],{type:"application/json"}),H=URL.createObjectURL(k),be=document.createElement("a");be.href=H,be.download="tcg-collection.json",be.click(),URL.revokeObjectURL(H)};return o.jsxs("main",{className:"page",children:[o.jsxs("header",{style:{marginTop:"32px",marginBottom:"16px",display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",gap:"6px"},children:[o.jsx("h1",{style:{margin:0,fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Tyler's TCG Collection"}),o.jsx("p",{style:{margin:"6px 0 0",color:"var(--text-soft)",fontSize:"0.9rem"},children:"Check out my TCG Collection with all the data of how much I spent (Under construction) and how much my collection is worth in total!"}),e&&o.jsx("div",{style:{marginTop:"10px"},children:o.jsx("button",{className:"manga-btn secondary",type:"button",onClick:Q,children:"Export JSON"})})]}),e&&o.jsx("button",{className:"manga-btn",type:"button","aria-label":"Add card",onClick:()=>N(!0),style:{position:"fixed",bottom:"20px",right:"20px",zIndex:1e3,width:"56px",height:"56px",borderRadius:"50%",padding:0,fontSize:"28px",display:"flex",alignItems:"center",justifyContent:"center"},children:"+"}),e&&I&&o.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(8,1,10,0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,padding:"12px"},onClick:k=>{k.target===k.currentTarget&&N(!1)},children:o.jsxs("div",{style:{width:"min(720px, 95vw)",background:"#140710",border:"1px solid rgba(255,182,193,0.3)",borderRadius:"12px",padding:"14px",boxShadow:"0 24px 60px rgba(0,0,0,0.85)"},onClick:k=>k.stopPropagation(),children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx("h2",{style:{margin:0,color:"#ffb6c1"},children:"Add card"}),o.jsx("button",{className:"dashboard-close",onClick:()=>N(!1),type:"button","aria-label":"Close",children:"X"})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"180px 1fr",gap:"12px",alignItems:"flex-start",marginTop:"10px"},children:[o.jsx("div",{style:{width:"100%",maxWidth:"180px",borderRadius:"10px",border:"1px solid rgba(255,182,193,0.25)",background:"#1e0d14",overflow:"hidden",aspectRatio:"3 / 4",display:"flex",alignItems:"center",justifyContent:"center"},children:A.image?o.jsx("img",{src:A.image,alt:"Card preview",style:{width:"100%",height:"100%",objectFit:"cover"}}):o.jsx("div",{style:{color:"var(--text-soft)",fontSize:"0.8rem",padding:"6px"},children:"No image"})}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:"8px"},children:[o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Game",o.jsxs("select",{value:A.game,onChange:k=>fe("game",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"},children:[o.jsx("option",{value:"pokemon",children:"Pokemon"}),o.jsx("option",{value:"onepiece",children:"One Piece"}),o.jsx("option",{value:"mtg",children:"MTG"})]})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Card name",o.jsx("input",{type:"text",value:A.name,onChange:k=>fe("name",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Set name",o.jsx("input",{type:"text",value:A.setName,onChange:k=>fe("setName",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Card number",o.jsx("input",{type:"text",value:A.number,onChange:k=>fe("number",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Rarity",o.jsx("input",{type:"text",value:A.rarity,onChange:k=>fe("rarity",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Condition",o.jsx("input",{type:"text",value:A.condition,onChange:k=>fe("condition",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Quantity",o.jsx("input",{type:"number",min:"1",value:A.quantity,onChange:k=>fe("quantity",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Price paid (per card)",o.jsx("input",{type:"number",step:"0.01",min:"0",value:A.pricePaid,onChange:k=>fe("pricePaid",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Estimated value (per card)",o.jsx("input",{type:"number",step:"0.01",min:"0",value:A.estimatedValue,onChange:k=>fe("estimatedValue",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Image URL",o.jsx("input",{type:"text",value:A.image||"",onChange:k=>fe("image",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Product URL (backend only)",o.jsx("input",{type:"text",value:A.productURL||"",onChange:k=>fe("productURL",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{gridColumn:"1 / -1",fontSize:"0.8rem",color:"var(--text-soft)"},children:["Notes",o.jsx("textarea",{value:A.notes,onChange:k=>fe("notes",k.target.value),rows:3,style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff",resize:"vertical"}})]})]})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"12px"},children:[o.jsx("button",{onClick:()=>{U(n),N(!1)},style:{padding:"6px 12px",borderRadius:"999px",border:"1px solid rgba(255,182,193,0.5)",background:"transparent",color:"#ffb6c1",cursor:"pointer"},children:"Cancel"}),o.jsx("button",{onClick:ce,style:{padding:"6px 12px",borderRadius:"999px",border:"none",cursor:"pointer",fontWeight:600,background:"#ff69b4",color:"#1e0d14"},children:"Save card"})]})]})}),e&&O&&o.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(8,1,10,0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,padding:"12px"},onClick:k=>{k.target===k.currentTarget&&ae(null)},children:o.jsxs("div",{style:{width:"min(720px, 95vw)",background:"#140710",border:"1px solid rgba(255,182,193,0.3)",borderRadius:"12px",padding:"14px",boxShadow:"0 24px 60px rgba(0,0,0,0.85)"},onClick:k=>k.stopPropagation(),children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx("h2",{style:{margin:0,color:"#ffb6c1"},children:"Edit card"}),o.jsx("button",{className:"dashboard-close",onClick:()=>ae(null),type:"button","aria-label":"Close",children:"X"})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"180px 1fr",gap:"12px",alignItems:"flex-start",marginTop:"10px"},children:[o.jsx("div",{style:{width:"100%",maxWidth:"180px",borderRadius:"10px",border:"1px solid rgba(255,182,193,0.25)",background:"#1e0d14",overflow:"hidden",aspectRatio:"3 / 4",display:"flex",alignItems:"center",justifyContent:"center"},children:O.image?o.jsx("img",{src:O.image,alt:"Card preview",style:{width:"100%",height:"100%",objectFit:"cover"}}):o.jsx("div",{style:{color:"var(--text-soft)",fontSize:"0.8rem",padding:"6px"},children:"No image"})}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:"8px"},children:[o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Game",o.jsxs("select",{value:O.game,onChange:k=>ae(H=>({...H,game:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"},children:[o.jsx("option",{value:"pokemon",children:"Pokemon"}),o.jsx("option",{value:"onepiece",children:"One Piece"}),o.jsx("option",{value:"mtg",children:"MTG"})]})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Card name",o.jsx("input",{type:"text",value:O.name,onChange:k=>ae(H=>({...H,name:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Set name",o.jsx("input",{type:"text",value:O.setName,onChange:k=>ae(H=>({...H,setName:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Card number",o.jsx("input",{type:"text",value:O.number,onChange:k=>ae(H=>({...H,number:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Rarity",o.jsx("input",{type:"text",value:O.rarity,onChange:k=>ae(H=>({...H,rarity:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Condition",o.jsx("input",{type:"text",value:O.condition,onChange:k=>ae(H=>({...H,condition:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Quantity",o.jsx("input",{type:"number",value:O.quantity,onChange:k=>ae(H=>({...H,quantity:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Price paid (each)",o.jsx("input",{type:"number",value:O.pricePaid,onChange:k=>ae(H=>({...H,pricePaid:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Estimated value (each)",o.jsx("input",{type:"number",value:O.estimatedValue,onChange:k=>ae(H=>({...H,estimatedValue:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Image URL",o.jsx("input",{type:"text",value:O.image||"",onChange:k=>ae(H=>({...H,image:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Product URL (backend only)",o.jsx("input",{type:"text",value:O.productURL||"",onChange:k=>ae(H=>({...H,productURL:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{gridColumn:"1 / -1",fontSize:"0.8rem",color:"var(--text-soft)"},children:["Notes",o.jsx("textarea",{value:O.notes||"",onChange:k=>ae(H=>({...H,notes:k.target.value})),rows:3,style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff",resize:"vertical"}})]})]})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"12px"},children:[o.jsx("button",{onClick:()=>ae(null),style:{padding:"6px 12px",borderRadius:"999px",border:"1px solid rgba(255,182,193,0.5)",background:"transparent",color:"#ffb6c1",cursor:"pointer"},children:"Cancel"}),o.jsx("button",{onClick:Re,style:{padding:"6px 12px",borderRadius:"999px",border:"none",cursor:"pointer",fontWeight:600,background:"#ff69b4",color:"#1e0d14"},children:"Save changes"})]})]})}),o.jsxs("section",{style:{display:"flex",flexWrap:"wrap",gap:"12px",marginTop:"18px",justifyContent:"center"},children:[o.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[o.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Total cards"}),o.jsx("div",{style:{fontSize:"1.1rem",fontWeight:700},children:C.totalCards})]}),C.totalPaid>0&&o.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[o.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Total paid"}),o.jsxs("div",{style:{fontSize:"1.1rem",fontWeight:700},children:["$",C.totalPaid.toFixed(2)]})]}),o.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},title:Ce,children:[o.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Total value"}),o.jsxs("div",{style:{fontSize:"1.1rem",fontWeight:700},children:["$",C.totalValue.toFixed(2)]})]}),C.totalPaid>0&&o.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[o.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Unrealized gain / loss"}),o.jsxs("div",{style:{fontSize:"1.1rem",fontWeight:700,color:Y>=0?"#00e676":"#ff8a80"},children:[Y>=0?"+":"-","$",Math.abs(Y).toFixed(2)]})]}),o.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[o.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Pokemon cards"}),o.jsx("div",{style:{fontSize:"1.1rem",fontWeight:700},children:C.pokemon})]}),o.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[o.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"One Piece cards"}),o.jsx("div",{style:{fontSize:"1.1rem",fontWeight:700},children:C.onepiece})]}),o.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[o.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"MTG cards"}),o.jsx("div",{style:{fontSize:"1.1rem",fontWeight:700},children:C.mtg})]})]}),o.jsxs("section",{style:{display:"flex",flexWrap:"wrap",gap:"10px",marginTop:"16px"},children:[o.jsx("input",{type:"text",placeholder:"Search by name, set, or number...",value:y,onChange:k=>_(k.target.value),style:{flex:"1 1 220px",minWidth:"220px",padding:"8px 12px",borderRadius:"999px",border:"1px solid #bb7f8f",background:"#2b0f1d",color:"#fff"}}),o.jsxs("select",{value:T,onChange:k=>S(k.target.value),style:{flex:"0 0 220px",padding:"8px 12px",borderRadius:"999px",border:"1px solid #bb7f8f",background:"#2b0f1d",color:"#fff"},children:[o.jsx("option",{value:"all",children:"All games"}),o.jsx("option",{value:"pokemon",children:"Pokemon only"}),o.jsx("option",{value:"onepiece",children:"One Piece only"}),o.jsx("option",{value:"mtg",children:"MTG only"})]}),o.jsxs("select",{value:F,onChange:k=>J(k.target.value),style:{flex:"0 0 220px",padding:"8px 12px",borderRadius:"999px",border:"1px solid #bb7f8f",background:"#2b0f1d",color:"#fff"},children:[o.jsx("option",{value:"name",children:"Sort: Name (A-Z)"}),o.jsx("option",{value:"set",children:"Sort: Set (A-Z)"}),o.jsx("option",{value:"rarity",children:"Sort: Rarity (A-Z)"}),o.jsx("option",{value:"quantity",children:"Sort: Quantity (high to low)"}),o.jsx("option",{value:"value",children:"Sort: Value (high to low)"})]})]}),f?o.jsx("p",{style:{marginTop:"20px",color:"var(--text-soft)"},children:"Loading TCG collection..."}):V.length===0?o.jsx("p",{style:{marginTop:"20px",color:"var(--text-soft)"},children:"No cards found."}):o.jsx("section",{className:"grid",style:{gridTemplateColumns:"repeat(auto-fill, minmax(170px, 1fr))",marginTop:"20px"},children:P.map(k=>{const H=Number(k.quantity||1),be=H*Number(k.pricePaid||0),Le=H*Number(k.estimatedValue||0);return o.jsxs("article",{style:{background:"#2b0f1d",borderRadius:"12px",border:"1px solid rgba(255,182,193,0.25)",boxShadow:"0 4px 16px rgba(0,0,0,0.55)",padding:"10px",fontSize:"0.82rem",display:"flex",flexDirection:"column",gap:"6px"},children:[k.image&&o.jsx("div",{style:{width:"100%",paddingTop:"140%",position:"relative",overflow:"hidden",borderRadius:"10px",background:"#1e0d14"},children:o.jsx("img",{src:k.image,alt:k.name||"card image",style:{position:"absolute",inset:0,width:"100%",height:"100%",objectFit:"contain"}})}),o.jsx("div",{style:{fontWeight:700,color:"#ffb6c1",marginBottom:"4px"},children:k.name||"Unnamed card"}),o.jsx("div",{style:{color:"var(--text-soft)",marginBottom:"4px"},children:k.setName||""}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",color:"var(--text-soft)"},children:[o.jsxs("span",{children:["#",k.number||"-"]}),o.jsx("span",{children:k.rarity||""})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",color:"var(--text-soft)",marginTop:"4px"},children:[o.jsxs("span",{children:["Cond: ",k.condition||"N/A"]}),o.jsxs("span",{children:["Qty: ",H]})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",color:"var(--text-soft)",marginTop:"4px"},children:[o.jsxs("span",{children:["Paid: $",be.toFixed(2)]}),o.jsxs("span",{children:["Value: $",Le.toFixed(2)]})]}),k.notes&&o.jsxs("div",{style:{color:"#9c8fa6",fontSize:"0.72rem",fontStyle:"italic",textAlign:"center",marginTop:"6px"},children:['"',k.notes,'"']}),o.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"8px"},children:[o.jsx("span",{style:{padding:"2px 7px",borderRadius:"999px",background:"rgba(255,105,180,0.18)",border:"1px solid rgba(255,105,180,0.5)",color:"#ffb6c1",fontSize:"0.7rem",whiteSpace:"nowrap"},children:{pokemon:"Pokemon",onepiece:"One Piece",mtg:"MTG"}[k.game]||"Other"}),e&&o.jsxs("div",{style:{display:"flex",gap:"6px",alignItems:"center",marginLeft:"auto"},children:[o.jsx("button",{onClick:()=>ae({...k,pricePaid:k.pricePaid??"",estimatedValue:k.estimatedValue??"",quantity:k.quantity??1}),style:{padding:"3px 8px",borderRadius:"999px",border:"1px solid rgba(255,182,193,0.5)",background:"rgba(255,105,180,0.15)",color:"#ffb6c1",fontSize:"0.7rem",cursor:"pointer"},children:"Edit"}),o.jsx("button",{onClick:()=>Ee(k.id),style:{padding:"3px 8px",borderRadius:"999px",border:"1px solid rgba(244,67,54,0.7)",background:"rgba(244,67,54,0.12)",color:"#ff8a80",fontSize:"0.7rem",cursor:"pointer"},children:"Delete"})]})]})]},k.id)})})]})}const Al="https://discord.com/api/webhooks/1448287168845054004/cGWGPoH5LaTFlBZ1vxtgMjOfV9au6qyQ_9ZRnOWN9-AX0MNfwxKNWVcZYQHz0ESA7_4k",jl="https://discord.com/api/webhooks/1448288240871276616/101WI-B2p8tDR34Hl9fZxxb0QG01f1Eo5w1IvbttlQmP2wWFNJ0OI7UnJfJujKRNWW2Q",_f="readNextState";function Ya(n){const e=n==null?"":String(n);return e.trim()?e.replace(/\s*,?\s*(?:vol(?:ume)?\.?)\s+\d+.*$/i,"").trim():""}function ks(n){if(!n)return null;if(n instanceof Date)return n;if(n&&typeof n.toDate=="function")return n.toDate();const e=String(n).trim();if(!e)return null;const t=e.match(/^(\d{4})-(\d{2})-(\d{2})$/);if(t){const[,l,u,f]=t;return new Date(Number(l),Number(u)-1,Number(f))}const s=e.match(/^(\d{1,2})\/(\d{1,2})\/(\d{2,4})$/);if(s){let[,l,u,f]=s;const m=f.length===2?+`20${f}`:Number(f);return new Date(m,Number(l)-1,Number(u))}const a=new Date(e);return isNaN(a.getTime())?null:a}function Go(n){const e=n.seriesKey||n.series||n.Series||n.title||n.Title||"",s=(Ya(e)||e).trim();return s?s.toLowerCase():""}function ww(n){const e=(n==null?void 0:n.series)||(n==null?void 0:n.Series)||(n==null?void 0:n.title)||(n==null?void 0:n.Title)||"Unknown Series";return Ya(e)||"Unknown Series"}function ad(n){const e=(n||"").trim(),t=e.match(/^(.*?)(?:,?\s*(?:vol\.|volume)\s*(\d+)(?:\s*[-]\s*\d+)?\s*)?(?:\s*\([^)]*\))?$/i),s=t?t[1].trim().toLowerCase():e.toLowerCase(),a=t&&t[2]?parseInt(t[2],10):0;return{name:s,vol:Number.isFinite(a)?a:0}}function AR(n,e){const t=(n==null?void 0:n.Title)||(n==null?void 0:n.title)||"",s=(e==null?void 0:e.Title)||(e==null?void 0:e.title)||"",a=ad(t),l=ad(s),u=a.name.localeCompare(l.name);return u!==0?u:a.vol!==l.vol?a.vol-l.vol:t.localeCompare(s)}function xf(){return{publisher:"",demographic:"",genre:"",subGenre:"",datePurchased:"",msrp:"",initialPublisher:"",initialDemographic:"",initialGenre:"",initialSubGenre:"",initialDatePurchased:"",initialMsrp:"",dateMixed:!1,readChecked:!1,readIndeterminate:!1}}function C_(){return{read:!1,datePurchased:"",dateRead:"",pageCount:"",msrp:"",amountPaid:"",rating:"",special:!1,specialType:"",specialVolumes:"",collectiblePrice:""}}function I_(n,e={}){const t=e.ignoreShared,s=(n==null?void 0:n.amountPaid)??(n==null?void 0:n.AmountPaid)??(n==null?void 0:n.paid)??(n==null?void 0:n.Paid)??"",a=(n==null?void 0:n.msrp)??(n==null?void 0:n.MSRP)??"",l=((n==null?void 0:n.datePurchased)||(n==null?void 0:n.DatePurchased)||"").trim(),u=((n==null?void 0:n.publisher)||(n==null?void 0:n.Publisher)||"").trim(),f=((n==null?void 0:n.demographic)||(n==null?void 0:n.Demographic)||"").trim(),m=((n==null?void 0:n.genre)||(n==null?void 0:n.Genre)||"").trim(),y=((n==null?void 0:n.specialType)||(n==null?void 0:n.SpecialType)||"").trim(),_=(n==null?void 0:n.specialVolumes)??(n==null?void 0:n.SpecialVolumes)??(n==null?void 0:n.volumesContained)??"",T=(n==null?void 0:n.collectiblePrice)??(n==null?void 0:n.CollectiblePrice)??"",S=!!y,F=(n==null?void 0:n.pageCount)??(n==null?void 0:n.PageCount)??(n==null?void 0:n.pages)??(n==null?void 0:n.Pages)??"",J=F==null?"":String(F).trim(),$=Number(J),B=!J||Number.isNaN($)||$<=0;return!S&&(s===""||s===null)||B||!l||!t&&(a===""||!u||!f||!m)||S&&!y||S&&y.toLowerCase()==="collectible"&&(T===""||T===null)||S&&y.toLowerCase()==="specialedition"&&(_===""||_===null)}function jR(n){const e=(n==null?void 0:n.amountPaid)??"",t=((n==null?void 0:n.datePurchased)||"").trim(),s=!!(n!=null&&n.specialType)||!!(n!=null&&n.special),a=((n==null?void 0:n.specialType)||"").trim(),l=(n==null?void 0:n.specialVolumes)??"",u=(n==null?void 0:n.collectiblePrice)??"",f=(n==null?void 0:n.pageCount)??"",m=(n==null?void 0:n.msrp)??"",y=((n==null?void 0:n.publisher)||"").trim(),_=((n==null?void 0:n.demographic)||"").trim(),T=((n==null?void 0:n.genre)||"").trim(),S=!s&&(e===""||e===null),F=s&&!a,J=s&&a.toLowerCase()==="collectible"&&(u===""||u===null),$=s&&a.toLowerCase()==="specialedition"&&(l===""||l===null),B=(()=>{const se=(f??"").toString().trim();if(se==="")return!0;const _e=Number(se);return Number.isNaN(_e)||_e<=0})();return{amountPaid:S,datePurchased:!t,specialType:F,collectiblePrice:J,specialVolumes:$,pageCount:B,msrp:m===""||m===null,publisher:!y,demographic:!_,genre:!T}}function kR(n){return!n||!n.books||!n.books.length?!1:n.books.some(e=>{const t=(e==null?void 0:e.msrp)??(e==null?void 0:e.MSRP)??"",s=((e==null?void 0:e.publisher)||(e==null?void 0:e.Publisher)||"").trim(),a=((e==null?void 0:e.demographic)||(e==null?void 0:e.Demographic)||"").trim(),l=((e==null?void 0:e.genre)||(e==null?void 0:e.Genre)||"").trim();return t===""||!s||!a||!l})}function DR(n){const e=new Map;for(const t of n){const s=Go(t)||t.id;if(!e.has(s)){const m=Ya(t.series||t.Series||t.title||t.Title||"Unknown Series")||"Unknown Series";e.set(s,{key:s,title:m,publisher:t.publisher||t.Publisher||"",genre:t.genre||t.Genre||"",demographic:t.demographic||t.Demographic||"",volumes:0,totalPages:0,readPages:0,readVolumes:0,ratingSum:0,ratingCount:0})}const a=e.get(s);a.volumes+=1;const l=Number(t.pages||t.Pages||t.pageCount||0)||0;a.totalPages+=l,(!!t.read||t.status==="Read"||t.Read===!0)&&(a.readVolumes+=1,a.readPages+=l);const f=Number(t.rating||t.Rating);!isNaN(f)&&f>0&&(a.ratingSum+=f,a.ratingCount+=1)}return e}function Po(n,e,t=5){const s=new Map;for(const a of n.values()){const l=(a[e]||"").trim();if(!l)continue;const u=l.split(/[\/,]/).map(f=>f.trim()).filter(Boolean);for(const f of u)s.set(f,(s.get(f)||0)+1)}return[...s.entries()].sort((a,l)=>l[1]-a[1]).slice(0,t).map(([a,l])=>({name:a,count:l}))}function N_(n,e){const t=Array.from({length:12},(s,a)=>{const l=new Date(e,a,1);return{key:`${e}-${a}`,label:l.toLocaleString("default",{month:"short"}),year:e,month:a,value:0}});for(const s of n){const a=ks(s.dateRead||s.DateRead);!a||a.getFullYear()!==e||(t[a.getMonth()].value+=1)}return t}function Da(n){const e=n.getFullYear(),t=`${n.getMonth()+1}`.padStart(2,"0"),s=`${n.getDate()}`.padStart(2,"0");return`${e}-${t}-${s}`}async function P_(n,e){try{await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:e})})}catch(t){console.error("Webhook post failed",t)}}function VR(n){const e=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],t=Array(7).fill(0);for(const l of n){const u=ks(l.dateRead||l.DateRead);u&&(t[u.getDay()]+=1)}if(!t.some(l=>l>0))return[];const a=t.reduce((l,u)=>Math.max(l,u),0)||1;return e.map((l,u)=>({label:l,value:t[u],pct:t[u]/a}))}function LR(n,e=8){const t=[...n.values()];t.sort((l,u)=>u.volumes-l.volumes);const s=t.slice(0,e),a=s.reduce((l,u)=>Math.max(l,u.volumes),0)||1;return s.map(l=>({label:l.title,value:l.volumes,pct:l.volumes/a}))}function MR(n,e){const t=(a,l)=>{const u=ks(a.releaseDate||a.ReleaseDate||a.date||a.Date);if(!u)return null;const f=(a.title||a.series||a.Title||"Unknown Title").trim(),m=ad(f),y=m!=null&&m.vol?m.vol:null,_=f,T=!!(a.datePurchased||a.DatePurchased||"").trim(),S=Ya(_||"").toLowerCase();return{date:u,title:_,purchased:T,source:l,seriesKey:S,volume:y}},s=[];return(e||[]).forEach(a=>{const l=t(a,"wishlist");l&&s.push(l)}),(n||[]).forEach(a=>{const l=t(a,"library");l&&s.push(l)}),s.sort((a,l)=>a.date-l.date),s}function OR(n){const e=new Date;for(const t of n)if(t.date>=e)return t;return n[n.length-1]||null}function FR(n){let e=0,t=0;for(const s of n){const a=ks(s.datePurchased||s.DatePurchased),l=ks(s.dateRead||s.DateRead);if(!a||!l)continue;const u=l-a;u<=0||(e+=u/(1e3*60*60*24),t+=1)}return t?e/t:null}function UR(n){const e=new Map;for(const t of n){const s=ks(t.datePurchased||t.DatePurchased),a=ks(t.dateRead||t.DateRead);if(!s||!a)continue;const l=a-s;if(l<=0)continue;const u=l/(1e3*60*60*24),f=Go(t)||t.id,m=Ya(t.series||t.Series||t.title||t.Title||"Untitled")||"Untitled";e.has(f)||e.set(f,{key:f,title:m,total:0,count:0,min:u,max:u});const y=e.get(f);y.total+=u,y.count+=1,y.min=Math.min(y.min,u),y.max=Math.max(y.max,u)}return[...e.values()].filter(t=>t.count>0).map(t=>({...t,avg:t.total/t.count})).sort((t,s)=>s.avg-t.avg)}function zR(n){const t=n.map(_=>ks(_.dateRead||_.DateRead)).filter(Boolean).sort((_,T)=>_-T);if(!t.length)return{lifetime:null,ytd:null};const s=Date.now(),a=t[0].getTime(),l=Math.max(1,Math.round((s-a)/864e5)+1),u=new Date,f=new Date(u.getFullYear(),0,1),m=Math.max(1,Math.floor((u.getTime()-f.getTime())/864e5)+1),y=t.filter(_=>_.getFullYear()===u.getFullYear()).length;return{lifetime:t.length/l,ytd:y/m}}function BR(n){let e=0,t=0,s=0;for(const a of n){const l=Number(a.msrp||a.MSRP||0)||0,u=Number(a.amountPaid||a.AmountPaid||a.pricePaid||0)||l||0,f=Number(a.collectiblePrice||a.CollectiblePrice||0)||0;e+=l,t+=u,s+=f}return{msrpTotal:e,paidTotal:t,collectibleTotal:s}}function $R(n,e=[]){const t=new Map;let s=0,a=0;n.forEach(u=>{const f=Go(u)||u.id;if(!f)return;const y=ad(u.title||u.Title||u.series||"").vol||0;t.has(f)||t.set(f,{key:f,title:ww(u),highestOwnedVolume:0,lastReadVolume:0,unreadCount:0,readVolumes:0,libraryCount:0,wishlistCount:0,total:0,msrpSum:0,msrpCount:0,latestPurchaseTs:0,latestPurchaseDate:null});const _=t.get(f);_.libraryCount+=1,_.total+=1,_.highestOwnedVolume=Math.max(_.highestOwnedVolume,y),!!u.read||u.status==="Read"||u.Read===!0?(_.lastReadVolume=Math.max(_.lastReadVolume,y),_.readVolumes+=1):_.unreadCount+=1;const S=Number(u.msrp||u.MSRP);!Number.isNaN(S)&&S>0&&(_.msrpSum+=S,_.msrpCount+=1,s+=S,a+=1);const F=ks(u.datePurchased||u.DatePurchased);if(F){const J=F.getTime();J>_.latestPurchaseTs&&(_.latestPurchaseTs=J,_.latestPurchaseDate=F)}}),e.forEach(u=>{const f=Go(u)||u.id;if(!f)return;const m=t.get(f);m&&(m.wishlistCount+=1)}),t.forEach(u=>{u.avgMsrp=u.msrpCount?u.msrpSum/u.msrpCount:null;const f=u.libraryCount+u.wishlistCount;u.ownershipRatio=f?u.libraryCount/f:0,u.fullyOwned=u.wishlistCount===0,u.recentPurchaseScore=u.latestPurchaseTs?Math.max(0,1-(Date.now()-u.latestPurchaseTs)/(1e3*60*60*24*120)):0,u.latestPurchaseDays=u.latestPurchaseTs?Math.round((Date.now()-u.latestPurchaseTs)/(1e3*60*60*24)):null});const l=a?s/a:null;return{map:t,globalAvgMsrp:l}}function WR(n,e,t={},s=0){if(!n||!n.size)return null;const a=new Date,l=new Map;(e||[]).forEach(S=>{if(!S||!S.date||S.date<a)return;const F=S.seriesKey||Ya(S.title||"").toLowerCase();if(!F)return;const J=l.get(F);(!J||S.date<J.date)&&l.set(F,S)});const u=[...n.values()].filter(S=>S.unreadCount>0);if(!u.length)return null;let f=0;for(const S of u){const F=Number.isFinite(S.ownershipRatio)?S.ownershipRatio:0,J=Number.isFinite(S.recentPurchaseScore)?S.recentPurchaseScore:0,$=Math.min(S.wishlistCount||0,6)/6,B=t!=null&&t[S.key]?new Date(t[S.key]):null;if(B&&B>a){S.snoozedUntil=B,S.score=-1/0;continue}const se=l.get(S.key)||null,_e=se?Math.round((se.date-a)/(1e3*60*60*24)):null,ye=se&&Number.isFinite(se.volume)?se.volume:null,we=ye?Math.max(0,ye-S.highestOwnedVolume-1):0,O=ye?Math.max(S.highestOwnedVolume||0,ye-1):S.highestOwnedVolume||S.total,ae=Math.max(0,O-S.lastReadVolume),I=ye?Math.max(0,ye-1-S.lastReadVolume):0,N=Math.max(S.unreadCount,ae,I),A=Math.min(N,8)/8,U=_e!=null&&_e>=0?Math.max(0,120-_e)/120:0,V=_e!=null&&_e<=45?.6:0,P=ye?Math.min(we,12)/12:0,C=we>=6?.6:0,Y=F*1.05-$*.35,ie=S.fullyOwned?.35:0,Ce=J*.8,fe=.85+Math.abs(Math.sin(s+f+1))%.35,ce=1+A*1.15+U*1.1+V+Y+ie+Ce-P*1.25-C,Re={backlogWeight:A,urgency:U,upcomingSoon:V,ownershipBonus:Y,fullyOwnedBoost:ie,recencyBoost:Ce,gapPenalty:P+C};S.score=Math.max(ce,.05)*fe,S.nextRelease=se,S.daysToRelease=_e,S.catchUpTarget=O,S.behindCount=N,S.upcomingVolume=ye,S.ownedVolume=S.highestOwnedVolume,S.ownedVsUpcomingGap=we,S.ownershipRatio=F,S.latestPurchaseDays=S.latestPurchaseDays??null,S.weightBreakdown=Re,f+=1}u.sort((S,F)=>F.score-S.score);const m=u.filter(S=>S.score>-1/0),y=m[0]||null,_=m.find((S,F)=>F>0&&S.unreadCount>0)||null,T={pick:(y==null?void 0:y.weightBreakdown)||null,seed:s};return{pick:y,backup:_,weights:T}}function wf(n){const e={},t=Date.now();return!n||typeof n!="object"||Object.entries(n).forEach(([s,a])=>{const l=Number(a);Number.isFinite(l)&&l>t&&(e[s]=l)}),e}function GR(n,e,t){if(!n||!n.size)return null;const s=new Date,a=new Map;(e||[]).forEach(u=>{if(!u||!u.date||u.date<s)return;const f=u.seriesKey;if(!f)return;const m=a.get(f);(!m||u.date<m.date)&&a.set(f,u)});const l=[];return n.forEach(u=>{const f=a.get(u.key);if(!f||f.purchased)return;const m=f&&Number.isFinite(f.volume)?f.volume:null;if(!m)return;const y=Math.max(0,m-1-u.highestOwnedVolume);if(y<=0)return;const _=f.date instanceof Date?Math.round((f.date-s)/(1e3*60*60*24)):null,T=u.avgMsrp||t||0,S=T>0?T*y:0,F=T>0?1/(1+S/60):.7,J=_!=null&&_>=0?Math.max(0,120-_)/120:0,$=Math.min(y,12)/12,B=Number.isFinite(u.ownershipRatio)?u.ownershipRatio*.9:0,se=1/Math.max(1,y),_e=u.total?(u.readVolumes||0)/u.total:0,ye=_e*.8,we=_!=null&&_<=45?.5:0,O=J*1.2+F*1+se*.8+B+ye+we-$*.9;l.push({...u,nextRelease:f,releaseVolume:m,daysToRelease:_,missingCount:y,costEstimate:S,avgMsrp:T,ownershipRatio:u.ownershipRatio??0,readPct:_e,score:O})}),l.length?(l.sort((u,f)=>f.score-u.score),{pick:l[0],list:l}):null}function qR(n){const e=new Map;for(const t of n){const s=Go(t)||t.id;if(!e.has(s)){const T=t.series||t.Series||t.title||t.Title||"Untitled";e.set(s,{key:s,title:Ya(T)||T.trim()||"Untitled",msrp:0,paid:0,collectible:0,books:0,pages:0,readPages:0,ratings:[]})}const a=e.get(s);a.books+=1;const l=Number(t.msrp||t.MSRP||0)||0,u=Number(t.amountPaid||t.AmountPaid||t.pricePaid||0)||0,f=Number(t.collectiblePrice||t.CollectiblePrice||0)||0,m=Number(t.pages||t.Pages||t.pageCount||0)||0,y=!!t.read||t.status==="Read"||t.Read===!0;a.msrp+=l,a.paid+=u,a.collectible+=f,a.pages+=m,y&&(a.readPages+=m);const _=Number(t.rating||t.Rating);!isNaN(_)&&_>0&&a.ratings.push(_)}return[...e.values()]}function HR(n){let e=0,t=0;for(const s of n){const a=Number(s.pages||s.Pages||s.pageCount||0)||0;e+=a,(!!s.read||s.status==="Read"||s.Read===!0)&&(t+=a)}return{total:e,read:t}}function KR(n){let e=0,t=0;for(const s of n.values())s.ratingCount>0&&(e+=s.ratingSum/s.ratingCount,t+=1);return t?e/t:null}function QR({data:n}){if(!n||!n.length)return o.jsx("div",{className:"line-chart empty",children:"No reading data yet."});const e=n.reduce((y,_)=>Math.max(y,_.value),0)||1,t=480,s=230,a=30,l=s-a*2,u=t/Math.max(n.length-1,1),f=n.map((y,_)=>{const T=_*u,S=s-a-y.value/e*l;return{...y,x:T,y:S}}),m=f.map((y,_)=>_===0?`M ${y.x} ${y.y}`:`L ${y.x} ${y.y}`).join(" ");return o.jsx("div",{className:"line-chart",children:o.jsxs("svg",{viewBox:`0 0 ${t} ${s}`,width:"100%",height:"100%",preserveAspectRatio:"xMidYMid meet",children:[[0,.25,.5,.75,1].map((y,_)=>{const T=s-a-y*l;return o.jsx("line",{className:"line-grid",x1:"0",x2:t,y1:T,y2:T},`h-${_}`)}),f.map((y,_)=>o.jsx("line",{className:"line-grid",x1:y.x,x2:y.x,y1:a/2,y2:s-a/2},`v-${_}`)),o.jsx("path",{className:"line-path",d:m}),f.map((y,_)=>o.jsxs("g",{children:[o.jsx("circle",{className:"line-point",cx:y.x,cy:y.y,r:"1.5"}),o.jsx("text",{className:"line-value",x:y.x,y:y.y-3,children:y.value}),o.jsx("text",{className:"line-label",x:y.x,y:s-4,children:y.label})]},_))]})})}function YR({data:n}){return!n||!n.length?o.jsx("div",{className:"weekday-breakdown empty",children:"No reads recorded yet."}):o.jsx("div",{className:"weekday-bars",children:n.map(e=>o.jsxs("div",{className:"weekday-col",children:[o.jsx("div",{className:"weekday-count",children:e.value}),o.jsx("div",{className:"weekday-bar-vert",children:o.jsx("div",{className:"weekday-bar-vert-fill",style:{height:`${Math.max(e.pct*100,e.value?6:0)}%`}})}),o.jsx("div",{className:"weekday-label",children:e.label})]},e.label))})}function R_(n,e,t){const s=n.getFullYear(),a=n.getMonth(),u=new Date(s,a,1).getDay(),f=new Date(s,a+1,0).getDate(),m=new Map;for(const T of e){const S=T.date;if(S.getFullYear()===s&&S.getMonth()===a){const F=S.getDate();m.has(F)||m.set(F,[]),m.get(F).push(T)}}const y=[];for(let T=0;T<u;T++)y.push({type:"pad"});for(let T=1;T<=f;T++){const S=Da(new Date(s,a,T));y.push({type:"day",day:T,releases:m.get(T)||[],dateKey:S,isToday:S===t})}const _=Math.ceil(y.length/7)*7;for(;y.length<_;)y.push({type:"pad"});return y}function JR(){const{user:n,admin:e,loading:t}=Qa(),[s,a]=j.useState([]),[l,u]=j.useState([]),[f,m]=j.useState(!0),[y,_]=j.useState(null),[T,S]=j.useState("-"),[F,J]=j.useState({yearly:Al,release:jl,activity:Va}),[$,B]=j.useState(new Set),[se,_e]=j.useState(null),[ye,we]=j.useState(null),[O,ae]=j.useState(new Set),[I,N]=j.useState(null),[A,U]=j.useState(""),V=j.useRef(null),[P,C]=j.useState(()=>xf()),[Y,ie]=j.useState(()=>C_()),[Ce,fe]=j.useState([]),[ce,Re]=j.useState(!1),[Ee,Q]=j.useState([]),[k,H]=j.useState(!1),[be,Le]=j.useState([]),[Ve,Fe]=j.useState(!1),[Qe,st]=j.useState(""),[ve,ue]=j.useState({}),[Oe,ge]=j.useState(()=>Math.random()),[qe,Ye]=j.useState(!1),Et=j.useRef(null),[Nt,At]=j.useState(null),[It,cn]=j.useState(null),Kt=async()=>{if(e)try{H(!0);const z=(await Ns(An(rt,"users"))).docs.map(W=>({uid:W.id,...W.data()}));Q(z)}catch(E){console.error("Failed to load users",E)}finally{H(!1)}},yr=async(E,z)=>{const W=(E||"").trim();if(!W){alert("UID is required.");return}try{await Ps(bt(rt,"users",W),{role:z,updatedBy:(n==null?void 0:n.uid)||"manual",updatedAt:new Date().toISOString()},{merge:!0}),await Kt()}catch(he){console.error("Failed to update role",he),alert("Failed to update role.")}},[cr,un]=j.useState(!1),[kn,Mt]=j.useState(()=>new Date),[Dt,Xn]=j.useState(!1),[ur,vr]=j.useState(()=>new Date),[Zn,Sn]=j.useState(null),[Dr,Qr]=j.useState(!1),[Yr,vs]=j.useState(()=>{const E=new Date;return{year:E.getFullYear(),month:E.getMonth()}}),[er,Zt]=j.useState(null),[dn,Jr]=j.useState({open:!1,type:null}),ht=new Date().getFullYear(),Dn=j.useRef(null),Xr=j.useRef(null);j.useEffect(()=>{document.title="Dashboard"},[]),j.useEffect(()=>{Et.current=null},[n==null?void 0:n.uid]),j.useEffect(()=>(cr||dn.open||ce||!!It||Dt||!!Zn||Dr||!!er?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[cr,dn.open,ce,It,Dt,Zn,Dr,er]),j.useEffect(()=>{typeof window>"u"||(Dn.current=localStorage.getItem("dashboard-yearly-posted"),Xr.current=localStorage.getItem("dashboard-release-posted"))},[]),j.useEffect(()=>{if(!e)return;const E=bt(rt,"settings","webhooks");(async()=>{try{const z=await kd(E);if(z.exists()){const W=z.data();J({yearly:W.yearly||Al,release:W.release||jl,activity:W.activity||Va})}else await Ps(E,{yearly:Al,release:jl,activity:Va}),J({yearly:Al,release:jl,activity:Va})}catch(z){console.error("Failed to load webhook settings",z)}})()},[e]),j.useEffect(()=>{if(!e)return;let E=!1;return(async()=>await Kt())(),()=>{E=!0}},[e]),j.useEffect(()=>{let E=!1;if(!n||!e){Le([]),st("");return}return(async()=>{try{Fe(!0);const W=(await Ns(An(rt,"suggestions"))).docs.map(he=>{var je;const Te=he.data();let $e=null;if((je=Te==null?void 0:Te.createdAt)!=null&&je.toDate)$e=Te.createdAt.toDate();else if(Te!=null&&Te.createdAt){const lt=new Date(Te.createdAt);$e=isNaN(lt.getTime())?null:lt}return{id:he.id,...Te,createdAt:$e}});W.sort((he,Te)=>{var $e,je,lt,Ze;return(((je=($e=Te.createdAt)==null?void 0:$e.getTime)==null?void 0:je.call($e))||0)-(((Ze=(lt=he.createdAt)==null?void 0:lt.getTime)==null?void 0:Ze.call(lt))||0)}),E||(Le(W),st(""))}catch(z){console.error("Failed to load suggestions",z),E||(st("Failed to load suggestions."),Le([]))}finally{E||Fe(!1)}})(),()=>{E=!0}},[n,e]);const _r=async E=>{if(!(!e||!E))try{await Ma(bt(rt,"suggestions",E)),Le(z=>z.filter(W=>W.id!==E))}catch(z){console.error("Failed to delete suggestion",z),st("Failed to delete suggestion.")}};j.useEffect(()=>{let E=!1;async function z(){if(!n||!e){a([]),u([]),_(null),m(!1);return}try{m(!0);const[W,he]=await Promise.all([Ns(An(rt,"library")),Ns(An(rt,"wishlist"))]);if(E)return;a(W.docs.map(Te=>({id:Te.id,...Te.data()}))),u(he.docs.map(Te=>({id:Te.id,...Te.data()}))),_(null)}catch(W){console.error(W),E||_("Failed to load dashboard data.")}finally{E||m(!1)}}return z(),()=>{E=!0}},[n,e]);const{map:Vr,globalAvgMsrp:Lr}=j.useMemo(()=>$R(s,l),[s,l]),Ds=j.useMemo(()=>{const E=s.length,z=s.filter(rs=>!!rs.read||rs.status==="Read"||rs.Read===!0).length,W=E-z,he=E?Math.round(z/E*100):0,Te=l.length,$e=DR(s),je=N_(s,ht),lt=N_(s,ht-1),Ze=je.reduce((rs,ss)=>rs+ss.value,0),Vt=VR(s),Bt=LR($e),Lt=MR(s,l),qn=OR(Lt),hn=FR(s),dt=BR(s),Ur=HR(s),Ot=KR($e),zr=UR(s),zs=zR(s),ns=Po($e,"publisher",5),ya=Po($e,"genre",5),In=Po($e,"demographic",5),Br=qR(s);return{totalLibrary:E,readCount:z,unreadCount:W,readPct:he,wishlistCount:Te,seriesMap:$e,monthlyReads:je,prevYearReads:lt,currentYearReadsTotal:Ze,weekdayBreakdown:Vt,topSeriesBars:Bt,releases:Lt,nextRelease:qn,avgDays:hn,purchaseToReadSeries:zr,collectionValue:dt,pages:Ur,avgRating:Ot,avgBooksPerDay:zs,topPublishers:ns,topGenres:ya,topDemographics:In,seriesAggregates:Br}},[s,l,ht]),{totalLibrary:gn,readCount:Vs,unreadCount:zt,readPct:Zr,wishlistCount:Vn,seriesMap:Tt,monthlyReads:_s,prevYearReads:xr,currentYearReadsTotal:dr,weekdayBreakdown:Ls,topSeriesBars:Ja,releases:en,nextRelease:wr,avgDays:yn,purchaseToReadSeries:$n,collectionValue:Qt,pages:vn,avgRating:es,avgBooksPerDay:Ln,topPublishers:xs,topGenres:Ms,topDemographics:ti,seriesAggregates:ni}=Ds,pt=wr?wr.date:null,bi=!!y,hr=Da(new Date),tn=j.useMemo(()=>s.map(E=>{const z=ks(E.dateRead||E.DateRead);return!z||!(E.read||E.status==="Read"||E.Read===!0)?null:{date:z,title:E.title||E.Title||"Untitled"}}).filter(Boolean).sort((E,z)=>E.date-z.date),[s]),nn=j.useMemo(()=>R_(ur,tn,hr),[ur,tn,hr]),Mn=j.useMemo(()=>{const E=new Map;return[...s,...l].forEach(W=>{const he=ks(W.datePurchased||W.DatePurchased);if(!he)return;const Te=Da(he);E.has(Te)||E.set(Te,[]),E.get(Te).push({id:W.id||W.Title||W.title||Te,title:W.title||W.Title||"Untitled"})}),E.forEach(W=>W.sort((he,Te)=>(he.title||"").localeCompare(Te.title||""))),E},[s,l]),Wn=j.useMemo(()=>{const{year:E,month:z}=Yr,he=new Date(E,z,1).getDay(),Te=new Date(E,z+1,0).getDate();let $e=!1;const je=[];for(let Ze=0;Ze<he;Ze+=1)je.push({type:"pad"});for(let Ze=1;Ze<=Te;Ze+=1){const Vt=new Date(E,z,Ze),Bt=Da(Vt),Lt=Mn.get(Bt)||[];Lt.length&&($e=!0),je.push({type:"day",day:Ze,dateKey:Bt,items:Lt,releases:Lt,isToday:Bt===hr})}const lt=Math.ceil(je.length/7)*7;for(;je.length<lt;)je.push({type:"pad"});return{cells:je,hasItems:$e}},[Yr,Mn,hr]);j.useEffect(()=>{try{const E=localStorage.getItem("dashboard.readNextSnoozed");if(!E)return;const z=JSON.parse(E);z&&typeof z=="object"&&ue(wf(z))}catch(E){console.error("Failed to load read-next snoozed state",E)}},[]),j.useEffect(()=>{if(!n){Ye(!1),ue({}),ge(Math.random());return}const E=bt(rt,_f,n.uid),z=rp(E,W=>{const he=W.exists()?W.data()||{}:{};he.snoozed?ue(wf(he.snoozed)):ue({}),Number.isFinite(he.seed)&&ge(he.seed),Ye(!0)},W=>{console.error("Failed to load read-next state",W),Ye(!0)});return()=>{z==null||z()}},[n]),j.useEffect(()=>{const E=wf(ve);if(JSON.stringify(E)!==JSON.stringify(ve)){ue(E);return}try{localStorage.setItem("dashboard.readNextSnoozed",JSON.stringify(E))}catch(W){console.error("Failed to persist read-next snoozed state",W)}if(!n||!qe)return;const z=bt(rt,_f,n.uid);(async()=>{try{await Ps(z,{snoozed:E,seed:Oe,updatedAt:new Date().toISOString()},{merge:!0})}catch(W){console.error("Failed to persist read-next state",W)}})()},[ve,Oe,n,qe]);const w=j.useMemo(()=>WR(Vr,en,ve,Oe),[Vr,en,ve,Oe]),D=(w==null?void 0:w.pick)||null,q=(w==null?void 0:w.backup)||null,L=(D==null?void 0:D.snoozedUntil)||null;j.useEffect(()=>{if(!n||!qe||!w||!D&&!q)return;const E=bt(rt,_f,n.uid),z={pick:D?{key:D.key,title:D.title,score:Number.isFinite(D.score)?Number(D.score.toFixed(3)):null,ownershipRatio:D.ownershipRatio??null,behindCount:D.behindCount??null}:null,backup:q?{key:q.key,title:q.title,behindCount:q.behindCount??null}:null,weights:w.weights||null,updatedAt:new Date().toISOString()},W=JSON.stringify(z);Et.current!==W&&(Et.current=W,(async()=>{try{await Ps(E,{lastSuggestion:z},{merge:!0})}catch(he){console.error("Failed to persist read-next suggestion",he)}})())},[w,D,q,n,qe]);const ee=(E=7)=>{if(!(D!=null&&D.key))return;const z=Date.now()+E*24*60*60*1e3;ue(W=>({...W,[D.key]:z})),ge(W=>W+1)},X=j.useMemo(()=>GR(Vr,en,Lr),[Vr,en,Lr]),ne=(X==null?void 0:X.pick)||null,Ae=j.useMemo(()=>{if(!s||!s.length)return[];const E=new Map;s.forEach(W=>{const he=Go(W)||W.id,Te=ww(W);E.has(he)||E.set(he,{seriesKey:he,displayName:Te,books:[]}),E.get(he).books.push(W)});const z=Array.from(E.values()).map(W=>({...W,books:[...W.books].sort(AR)}));return z.sort((W,he)=>W.displayName.localeCompare(he.displayName)),z},[s]),me=j.useMemo(()=>Ae.flatMap(E=>E.books.map(z=>z.id)),[Ae]);j.useEffect(()=>{ye&&(s.some(E=>E.id===ye)||we(null))},[s,ye]),j.useEffect(()=>{se&&(Ae.some(E=>E.seriesKey===se)||_e(null))},[Ae,se]),j.useEffect(()=>{if(!O.size)return;const E=new Set(s.map(W=>W.id)),z=Array.from(O).filter(W=>!E.has(W));z.length&&ae(W=>{const he=new Set(W);return z.forEach(Te=>he.delete(Te)),he})},[s,O]),j.useEffect(()=>{const E=Array.from(O);if(!E.length){U("");return}const z=Array.from(new Set(E.map(W=>s.find(he=>he.id===W)).filter(Boolean).map(W=>{const he=W.amountPaid??W.AmountPaid??"";return he==null?"":String(he)})));U(z.length===1?z[0]:"")},[O,s]),j.useEffect(()=>{const E=Ae.find(dt=>dt.seriesKey===se);if(!E){C(xf());return}const z=E.books,W=dt=>{const Ur=Array.from(new Set(z.map(Ot=>{const zr=dt(Ot);return zr==null?"":String(zr).trim()})));return Ur.length===1?Ur[0]:""},he=W(dt=>dt.publisher||dt.Publisher),Te=W(dt=>dt.demographic||dt.Demographic),$e=W(dt=>dt.genre||dt.Genre),je=W(dt=>dt.subGenre||dt.SubGenre),lt=W(dt=>dt.msrp??dt.MSRP),Ze=Array.from(new Set(z.map(dt=>(dt.datePurchased||dt.DatePurchased||"").trim()).filter(Boolean))),Vt=Ze.length>1,Bt=Vt?"":Ze[0]||"",Lt=z.filter(dt=>!!dt.read||dt.status==="Read"||dt.Read===!0).length,qn=Lt===z.length&&z.length>0;C({publisher:he,demographic:Te,genre:$e,subGenre:je,datePurchased:Bt,msrp:lt,initialPublisher:he,initialDemographic:Te,initialGenre:$e,initialSubGenre:je,initialDatePurchased:Bt,initialMsrp:lt,dateMixed:Vt,readChecked:qn,readIndeterminate:!qn&&!(Lt===0)})},[Ae,se]),j.useEffect(()=>{V.current&&(V.current.indeterminate=P.readIndeterminate)},[P.readIndeterminate]),j.useEffect(()=>{const E=s.find(W=>W.id===ye);if(!E){ie(C_());return}const z=!!E.read||E.status==="Read"||E.Read===!0;ie({read:z,datePurchased:E.datePurchased||E.DatePurchased||"",dateRead:z&&(E.dateRead||E.DateRead)||"",pageCount:E.pageCount??E.PageCount??E.pages??E.Pages??"",msrp:E.msrp??E.MSRP??"",amountPaid:E.amountPaid??E.AmountPaid??"",rating:z?E.rating??E.Rating??"":"",special:!!(E.specialType||E.SpecialType),specialType:E.specialType??E.SpecialType??"",specialVolumes:E.specialVolumes??E.SpecialVolumes??"",collectiblePrice:E.collectiblePrice??E.CollectiblePrice??"",publisher:E.publisher||E.Publisher||"",demographic:E.demographic||E.Demographic||"",genre:E.genre||E.Genre||""})},[ye,s]),j.useEffect(()=>{if(!xr||!xr.length)return;const E=ht-1,z=xr.reduce(($e,je)=>$e+je.value,0);if(!z||(Dn.current?parseInt(Dn.current,10):null)===E)return;const he=xr.map($e=>`${$e.label}: ${$e.value}`).join(", "),Te=`Yearly reads summary for ${E}: ${z} total. Breakdown: ${he}`;P_(F.yearly,Te).then(()=>{Dn.current=String(E),typeof window<"u"&&localStorage.setItem("dashboard-yearly-posted",String(E))})},[xr,ht]),j.useEffect(()=>{if(!wr||!en.length)return;const E=Da(wr.date),z=Da(new Date);if(E>z||Xr.current===E)return;const W=en.filter(Te=>Da(Te.date)===E);if(!W.length)return;const he=`Wishlist releases for ${E}:
${W.map(Te=>`- ${Te.title}`).join(`
`)}`;P_(F.release,he).then(()=>{Xr.current=E,typeof window<"u"&&localStorage.setItem("dashboard-release-posted",E)})},[wr,en]),j.useEffect(()=>{if(!pt){S("-");return}const E=()=>{const W=pt-new Date;if(W<=0){S("Released");return}const he=Math.floor(W/1e3),Te=Math.floor(he/86400),$e=Math.floor(he%86400/3600).toString().padStart(2,"0"),je=Math.floor(he%3600/60).toString().padStart(2,"0"),lt=Math.floor(he%60).toString().padStart(2,"0");S(`${Te}d ${$e}:${je}:${lt}`)};E();const z=setInterval(E,1e3);return()=>clearInterval(z)},[pt]),j.useEffect(()=>{if(!(typeof window>"u"))try{const E=localStorage.getItem(dm);if(!E)return;const z=JSON.parse(E);if(!Array.isArray(z))return;const W=z.map(he=>({message:he.message,ts:he.ts?new Date(he.ts):new Date})).filter(he=>he.message);W.length&&fe(W)}catch(E){console.warn("Failed to load activity log",E)}},[]);const De=async()=>{try{const E=await Ns(An(rt,"library"));a(E.docs.map(z=>({id:z.id,...z.data()})))}catch(E){console.error("Failed to refresh library",E),_(z=>z||"Failed to refresh library data.")}},de=E=>{const z=(E??"").toString().trim();if(z==="")return"";const W=parseFloat(z);return Number.isFinite(W)?W:""},ot=E=>{const z=(E??"").toString().trim();if(z==="")return"";const W=parseInt(z,10);return Number.isFinite(W)?W:""},Pe=E=>{if(!E)return;const z={message:E,ts:new Date};fe(W=>{const he=[z,...W].slice(0,100);return vw(he),he}),_w(E,{email:(n==null?void 0:n.email)||"anonymous",name:(n==null?void 0:n.displayName)||"",webhookOverride:F.activity,persistLocal:!1})},Je=E=>{B(z=>{const W=new Set(z);return W.has(E)?W.delete(E):W.add(E),W}),_e(E),we(null)},rn=(E,z,W)=>{const he=E.metaKey||E.ctrlKey,Te=E.shiftKey,$e=me.indexOf(z);let je=new Set(O);if(Te&&I!==null&&$e!==-1){const lt=Math.min(I,$e),Ze=Math.max(I,$e);for(let Vt=lt;Vt<=Ze;Vt+=1){const Bt=me[Vt];Bt&&je.add(Bt)}}else he?je.has(z)?je.delete(z):je.add(z):je=new Set;ae(je),N($e),we(z),_e(W),B(lt=>{const Ze=new Set(lt);return Ze.add(W),Ze})},sn=()=>{ae(new Set),N(null)},Er=async()=>{if(!e){alert("Dashboard is read-only for your account.");return}const E=Array.from(O);if(!E.length){alert("Select books in Library Manager (use Ctrl/Cmd or Shift) before bulk editing.");return}const z=(A||"").toString().trim(),W=z!=="",he=de(z);if(W&&he===""){alert("Enter a valid number for Amount Paid.");return}try{await Promise.all(E.map(Te=>fs(bt(rt,"library",Te),{amountPaid:W?he:""}))),await De(),sn(),Pe(`Updated amount paid for ${E.length} book${E.length===1?"":"s"} in library`),alert(`Applied Amount Paid to ${E.length} selection${E.length===1?"":"s"}.`)}catch(Te){console.error("Failed to apply Amount Paid",Te),alert("Failed to apply Amount Paid to selection.")}},_t=async()=>{if(!e){alert("Dashboard is read-only for your account.");return}const E=Ae.find(Lt=>Lt.seriesKey===se);if(!E||!E.books.length)return;const z=!P.readIndeterminate,W=!!P.readChecked,he=P.datePurchased!==P.initialDatePurchased,Te=P.msrp!==P.initialMsrp,$e=P.publisher!==P.initialPublisher,je=P.demographic!==P.initialDemographic,lt=P.genre!==P.initialGenre,Ze=P.subGenre!==P.initialSubGenre;if(!z&&!he&&!Te&&!$e&&!je&&!lt&&!Ze)return;const Vt=String(P.msrp??"").trim(),Bt=Te?de(Vt):"";if(Te&&Vt!==""&&Bt===""){alert("Enter a valid number for MSRP.");return}try{const Lt=[];if(E.books.forEach(qn=>{const hn={};z&&(hn.read=W,hn.dateRead=W?qn.dateRead||qn.DateRead||new Date().toISOString().slice(0,10):""),he&&(hn.datePurchased=P.datePurchased||""),Te&&(hn.msrp=P.msrp===""?"":Bt),$e&&(hn.publisher=P.publisher||""),je&&(hn.demographic=P.demographic||""),lt&&(hn.genre=P.genre||""),Ze&&(hn.subGenre=P.subGenre||""),Object.keys(hn).length&&Lt.push(fs(bt(rt,"library",qn.id),hn))}),!Lt.length)return;await Promise.all(Lt),await De(),we(null),Pe(`Updated series "${E.displayName||"Series"}" (${E.books.length} book${E.books.length===1?"":"s"})`),alert("Series updated.")}catch(Lt){console.error("Failed to save series changes",Lt),alert("Failed to update series.")}},ts=async()=>{if(!e){alert("Dashboard is read-only for your account.");return}if(!ye)return;const E=!!Y.read,z=String(Y.msrp??"").trim(),W=String(Y.amountPaid??"").trim(),he=String(Y.pageCount??"").trim(),Te=String(Y.rating??"").trim(),$e=de(z),je=de(W),lt=ot(he),Ze=de(Te);if(z!==""&&$e===""){alert("Enter a valid number for MSRP.");return}if(W!==""&&je===""){alert("Enter a valid number for Amount Paid.");return}if(he!==""&&lt===""){alert("Enter a valid page count.");return}if(E&&Te!==""&&Ze===""){alert("Enter a valid rating.");return}const Vt=!!Y.special,Bt=ot(Y.specialVolumes),Lt=de(Y.collectiblePrice),qn=String(Y.specialVolumes??"").trim(),hn=String(Y.collectiblePrice??"").trim();if(Vt&&Y.specialType==="specialEdition"&&qn!==""&&Bt===""){alert("Enter a valid number for volumes contained.");return}if(Vt&&Y.specialType==="collectible"&&hn!==""&&Lt===""){alert("Enter a valid collectible price.");return}const dt=E?Y.dateRead||new Date().toISOString().slice(0,10):"",Ur={read:E,datePurchased:Y.datePurchased||"",dateRead:dt,msrp:Y.msrp===""?"":$e,amountPaid:Y.amountPaid===""?"":je,pageCount:Y.pageCount===""?"":lt,rating:E?Y.rating===""?"":Ze:"",specialType:Vt&&Y.specialType||"",specialVolumes:Vt&&Y.specialType==="specialEdition"?Y.specialVolumes===""?"":Bt:"",collectiblePrice:Vt&&Y.specialType==="collectible"?Y.collectiblePrice===""?"":Lt:""};try{await fs(bt(rt,"library",ye),Ur),await De();const Ot=s.find(zs=>zs.id===ye)||jt,zr=(Ot==null?void 0:Ot.Title)||(Ot==null?void 0:Ot.title)||"Untitled";Pe(`Updated "${zr}" in library`),alert("Saved changes.")}catch(Ot){console.error("Failed to save book changes",Ot),alert("Failed to save changes.")}},gt=()=>{_e(null),we(null),sn(),C(xf())},Os=()=>{we(null),N(null)},ma=Ae.find(E=>E.seriesKey===se)||null,jt=s.find(E=>E.id===ye)||null,Fs=se?{msrp:!P.msrp,datePurchased:!P.datePurchased&&!P.dateMixed,publisher:!P.publisher,demographic:!P.demographic,genre:!P.genre}:{},Mr=ye?jR({amountPaid:Y.amountPaid,msrp:Y.msrp,datePurchased:Y.datePurchased,publisher:(jt==null?void 0:jt.publisher)||(jt==null?void 0:jt.Publisher)||"",demographic:(jt==null?void 0:jt.demographic)||(jt==null?void 0:jt.Demographic)||"",genre:(jt==null?void 0:jt.genre)||(jt==null?void 0:jt.Genre)||"",special:Y.special,specialType:Y.specialType,specialVolumes:Y.specialVolumes,collectiblePrice:Y.collectiblePrice,pageCount:Y.pageCount}):{};if(t)return o.jsx("div",{className:"page dashboard-page",children:o.jsxs("div",{className:"dashboard-loading",children:[o.jsx("h1",{children:"Dashboard"}),o.jsx("p",{children:"Checking permissions..."})]})});if(!n||!e)return o.jsx("div",{className:"page dashboard-page",children:o.jsxs("div",{className:"dashboard-locked",children:[o.jsx("h1",{children:"Dashboard"}),o.jsx("p",{children:"This area is restricted to admin accounts."})]})});if(f)return o.jsx("div",{className:"page dashboard-page",children:o.jsxs("div",{className:"dashboard-loading",children:[o.jsx("h1",{children:"Dashboard"}),y?o.jsx("p",{className:"error",children:y}):o.jsx("p",{children:"Loading stats..."})]})});const ga=gn+Vn,Ci=ga?Math.round(gn/ga*100):0,Or=[...Tt.values()].filter(E=>E.ratingCount>0).map(E=>({title:E.title,avg:E.ratingSum/E.ratingCount,count:E.ratingCount})).sort((E,z)=>z.avg-E.avg||z.count-E.count).slice(0,3);function bn(){if(pt)Mt(new Date(pt.getFullYear(),pt.getMonth(),1));else if(en.length){const E=en[0].date;Mt(new Date(E.getFullYear(),E.getMonth(),1))}un(!0)}function Cn(E){Jr({open:!0,type:E})}function Tr(){Jr({open:!1,type:null})}const Us=R_(kn,en,hr),fr=E=>{vs(z=>{const W=new Date(z.year,z.month+E,1);return{year:W.getFullYear(),month:W.getMonth()}})},Fr=E=>{vr(z=>new Date(z.getFullYear(),z.getMonth()+E,1))},Xa=()=>{Qr(!1),Zt(null)},Za=()=>{const E=Array.from(Mn.keys()).sort();if(E.length){const z=E[E.length-1],[W,he]=z.split("-"),Te=Number(W),$e=Number(he)-1;!Number.isNaN(Te)&&!Number.isNaN($e)&&vs({year:Te,month:$e})}Qr(!0)},Gn=()=>{if(tn.length){const E=tn[tn.length-1].date;vr(new Date(E.getFullYear(),E.getMonth(),1))}else vr(new Date);Xn(!0)};function sl(){const E=dn.type;if(!E)return null;if(E==="publishers"){const z=[...Po(Tt,"publisher",100)];return o.jsxs(o.Fragment,{children:[o.jsx("h3",{children:"Top Publishers by Series"}),z.length===0?o.jsx("p",{children:"No publisher data yet."}):o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"#"}),o.jsx("th",{children:"Publisher"}),o.jsx("th",{children:"Series Count"})]})}),o.jsx("tbody",{children:z.map((W,he)=>o.jsxs("tr",{children:[o.jsx("td",{children:he+1}),o.jsx("td",{children:W.name}),o.jsx("td",{children:W.count})]},W.name+he))})]})]})}if(E==="genres"){const z=[...Po(Tt,"genre",100)];return o.jsxs(o.Fragment,{children:[o.jsx("h3",{children:"Top Genres by Series"}),z.length===0?o.jsx("p",{children:"No genre data yet."}):o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"#"}),o.jsx("th",{children:"Genre"}),o.jsx("th",{children:"Series Count"})]})}),o.jsx("tbody",{children:z.map((W,he)=>o.jsxs("tr",{children:[o.jsx("td",{children:he+1}),o.jsx("td",{children:W.name}),o.jsx("td",{children:W.count})]},W.name+he))})]})]})}if(E==="demographics"){const z=[...Po(Tt,"demographic",100)];return o.jsxs(o.Fragment,{children:[o.jsx("h3",{children:"Top Demographics by Series"}),z.length===0?o.jsx("p",{children:"No demographic data yet."}):o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"#"}),o.jsx("th",{children:"Demographic"}),o.jsx("th",{children:"Series Count"})]})}),o.jsx("tbody",{children:z.map((W,he)=>o.jsxs("tr",{children:[o.jsx("td",{children:he+1}),o.jsx("td",{children:W.name}),o.jsx("td",{children:W.count})]},W.name+he))})]})]})}if(E==="timeToRead"){const z=$n||[];return o.jsxs(o.Fragment,{children:[o.jsx("h3",{children:"Average Time From Purchase to Read"}),yn==null?o.jsx("p",{children:"Not enough volumes have both purchase and read dates to calculate this yet."}):o.jsxs(o.Fragment,{children:[o.jsxs("p",{children:["On average, it takes"," ",o.jsxs("strong",{children:[yn.toFixed(1)," days"]})," from purchase to finishing a volume."]}),z.length>0?o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Series"}),o.jsx("th",{children:"Avg Days"}),o.jsx("th",{children:"Longest"}),o.jsx("th",{children:"Shortest"}),o.jsx("th",{children:"Reads Count"})]})}),o.jsx("tbody",{children:z.map(W=>o.jsxs("tr",{children:[o.jsx("td",{children:W.title}),o.jsxs("td",{children:[W.avg.toFixed(1)," days"]}),o.jsxs("td",{children:[Math.round(W.max)," days"]}),o.jsxs("td",{children:[Math.round(W.min)," days"]}),o.jsx("td",{children:W.count})]},W.key))})]}):o.jsx("p",{style:{marginTop:8},children:"No series-level data yet."})]})]})}if(E==="collectionValue"){const{msrpTotal:z,paidTotal:W}=Qt,he=z-W,Te=z>0?(W/z*100).toFixed(1):"-",$e=[...ni].filter(je=>je.msrp||je.paid||je.collectible).sort((je,lt)=>lt.msrp+lt.collectible-(je.msrp+je.collectible));return o.jsxs(o.Fragment,{children:[o.jsx("h3",{children:"Collection Value Breakdown"}),o.jsx("table",{children:o.jsxs("tbody",{children:[o.jsxs("tr",{children:[o.jsx("th",{children:"Total MSRP"}),o.jsxs("td",{children:["$",z.toFixed(2)]})]}),o.jsxs("tr",{children:[o.jsx("th",{children:"Total Paid"}),o.jsxs("td",{children:["$",W.toFixed(2)]})]}),o.jsxs("tr",{children:[o.jsx("th",{children:"Difference"}),o.jsxs("td",{children:["$",he.toFixed(2)]})]}),o.jsxs("tr",{children:[o.jsx("th",{children:"Paid vs MSRP"}),o.jsx("td",{children:Te==="-"?"-":`${Te}%`})]})]})}),$e.length>0&&o.jsxs(o.Fragment,{children:[o.jsx("h4",{style:{marginTop:"14px"},children:"Collection Pricing"}),o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Title"}),o.jsx("th",{children:"MSRP"}),o.jsx("th",{children:"Paid"}),o.jsx("th",{children:"Collectible"}),o.jsx("th",{children:"Books"})]})}),o.jsx("tbody",{children:$e.map((je,lt)=>o.jsxs("tr",{children:[o.jsx("td",{children:je.title}),o.jsxs("td",{children:["$",je.msrp.toFixed(2)]}),o.jsxs("td",{children:["$",je.paid.toFixed(2)]}),o.jsx("td",{children:je.collectible?`$${je.collectible.toFixed(2)}`:"--"}),o.jsx("td",{children:je.books})]},je.title+lt))})]})]})]})}if(E==="pages"){const z=[...ni].filter(W=>W.pages>0).map(W=>({...W,pct:W.pages?Math.round(W.readPages/W.pages*100):0})).sort((W,he)=>he.pages-W.pages);return o.jsxs(o.Fragment,{children:[o.jsx("h3",{children:"Pages Read vs Total"}),o.jsx("table",{children:o.jsxs("tbody",{children:[o.jsxs("tr",{children:[o.jsx("th",{children:"Total Pages"}),o.jsx("td",{children:vn.total.toLocaleString()})]}),o.jsxs("tr",{children:[o.jsx("th",{children:"Pages Read"}),o.jsx("td",{children:vn.read.toLocaleString()})]}),o.jsxs("tr",{children:[o.jsx("th",{children:"Completion"}),o.jsx("td",{children:vn.total?`${(vn.read/vn.total*100).toFixed(1)}%`:"-"})]})]})}),z.length>0&&o.jsxs(o.Fragment,{children:[o.jsx("h4",{style:{marginTop:"14px"},children:"Pages by Series"}),o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Title"}),o.jsx("th",{children:"Read Pages"}),o.jsx("th",{children:"Total Pages"}),o.jsx("th",{children:"% Read"}),o.jsx("th",{children:"Books"})]})}),o.jsx("tbody",{children:z.map((W,he)=>o.jsxs("tr",{children:[o.jsx("td",{children:W.title}),o.jsx("td",{children:W.readPages.toLocaleString()}),o.jsx("td",{children:W.pages.toLocaleString()}),o.jsxs("td",{children:[W.pct,"%"]}),o.jsx("td",{children:W.books})]},W.title+he))})]})]})]})}if(E==="ratings"){const z=[...ni].map(W=>{if(!W.ratings.length)return null;const he=W.ratings.reduce((Te,$e)=>Te+$e,0)/W.ratings.length;return{title:W.title,avg:he,count:W.ratings.length}}).filter(Boolean).sort((W,he)=>he.avg-W.avg||he.count-W.count);return o.jsxs(o.Fragment,{children:[o.jsx("h3",{children:"Ratings Overview"}),es==null?o.jsx("p",{children:"No ratings have been recorded yet."}):o.jsxs("p",{children:["Average series rating across rated series is"," ",o.jsx("strong",{children:es.toFixed(2)}),"."]}),z.length>0&&o.jsxs(o.Fragment,{children:[o.jsx("h4",{style:{marginTop:"14px"},children:"Series Averages"}),o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Title"}),o.jsx("th",{children:"Avg"}),o.jsx("th",{children:"Ratings"})]})}),o.jsx("tbody",{children:z.map((W,he)=>o.jsxs("tr",{children:[o.jsx("td",{children:W.title}),o.jsx("td",{children:W.avg.toFixed(2)}),o.jsx("td",{children:W.count})]},W.title+he))})]})]})]})}return E==="releases"?o.jsxs(o.Fragment,{children:[o.jsx("h3",{children:"Library & Wishlist Releases"}),en.length===0?o.jsx("p",{children:"No wishlist releases found."}):o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Date"}),o.jsx("th",{children:"Title"})]})}),o.jsx("tbody",{children:en.map((z,W)=>o.jsxs("tr",{children:[o.jsx("td",{children:z.date.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}),o.jsx("td",{children:z.title})]},W))})]})]}):null}return o.jsxs("div",{className:"page dashboard-page",children:[o.jsxs("header",{className:"dashboard-header",style:{display:"flex",alignItems:"center",justifyContent:"center",position:"relative",textAlign:"center",width:"100%"},children:[o.jsxs("div",{style:{textAlign:"center",margin:"0 auto",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"0 60px"},children:[o.jsx("h1",{style:{margin:0,fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Dashboard"}),o.jsx("p",{className:"dashboard-sub",style:{textAlign:"center",margin:"6px 0 0"},children:"My Entire Statistics dashboard for my Manga. I still use Excel though."})]}),e&&o.jsx("div",{style:{position:"absolute",right:0,top:"50%",transform:"translateY(-50%)"},children:o.jsx("button",{className:"stat-link",onClick:()=>Re(!0),type:"button",children:"Admin Settings"})})]}),o.jsx("section",{id:"dashboardSection",className:"page-section active",children:o.jsxs("div",{className:"dashboard-grid",children:[o.jsxs("div",{className:"stat-stack",children:[o.jsxs("div",{className:"stat-card mini clickable",onClick:Za,children:[o.jsx("h3",{children:"Total Library Books"}),o.jsx("div",{className:"stat-value",children:gn}),o.jsx("div",{className:"stat-sub",children:"Volumes in your library."})]}),o.jsxs("div",{className:"stat-card mini",children:[o.jsx("h3",{children:"Wishlist Items"}),o.jsx("div",{className:"stat-value",children:Vn}),o.jsx("div",{className:"stat-sub",children:"Tracked upcoming wants."})]})]}),o.jsxs("div",{className:"stat-card clickable",onClick:Gn,role:"button",tabIndex:0,onKeyDown:E=>{(E.key==="Enter"||E.key===" ")&&(E.preventDefault(),Gn())},children:[o.jsx("h3",{children:"Read / Unread"}),o.jsx("div",{className:"pie",style:{"--pct":`${Zr*3.6}deg`},children:o.jsxs("div",{className:"pie-label",children:[Zr,"%"]})}),o.jsxs("div",{className:"stat-value",children:[Vs," read / ",zt," unread"]})]}),o.jsxs("div",{className:"stat-card clickable",onClick:()=>Cn("ratings"),children:[o.jsx("h3",{children:"Ratings"}),o.jsx("div",{className:"stat-value",children:es==null?"-":es.toFixed(2)}),o.jsx("div",{className:"stat-sub",children:"Average across rated series."}),o.jsx("div",{className:"stat-list compact",children:Or.length?Or.map((E,z)=>o.jsxs("div",{className:"stat-list-row",children:[o.jsx("span",{className:"stat-rank",children:z+1}),o.jsx("span",{className:"stat-name",children:E.title}),o.jsx("span",{className:"stat-count",children:E.avg.toFixed(2)})]},E.title+z)):o.jsx("div",{className:"stat-sub",children:"No ratings yet."})})]}),o.jsxs("div",{className:"stat-card clickable",onClick:()=>Cn("pages"),children:[o.jsx("h3",{children:"Page Count Read / Total"}),o.jsxs("div",{className:"stat-value",children:[vn.read.toLocaleString()," / ",vn.total.toLocaleString()]}),o.jsx("div",{className:"stat-sub",children:vn.total?`${(vn.read/vn.total*100).toFixed(1)}% read`:"-"})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("h3",{children:"Library vs Wishlist"}),o.jsx("div",{className:"pie",style:{"--pct":`${Ci*3.6}deg`},children:o.jsxs("div",{className:"pie-label",children:[Ci,"%"]})}),o.jsxs("div",{className:"stat-value",children:[gn," / ",Vn]}),o.jsx("div",{className:"stat-sub",children:"Library vs wishlist share"})]}),o.jsxs("div",{className:"stat-card clickable",onClick:()=>Cn("demographics"),children:[o.jsx("h3",{children:"Top Demographics"}),o.jsx("div",{className:"stat-list",children:ti.length?ti.slice(0,3).map((E,z)=>o.jsxs("div",{className:"stat-list-row",children:[o.jsx("span",{className:"stat-rank",children:z+1}),o.jsx("span",{className:"stat-name",children:E.name}),o.jsx("span",{className:"stat-count",children:E.count})]},E.name)):o.jsx("div",{className:"stat-sub",children:"No demographic data yet."})})]}),o.jsxs("div",{className:"stat-card clickable",onClick:()=>Cn("publishers"),children:[o.jsx("h3",{children:"Top Publishers"}),o.jsx("div",{className:"stat-list",children:xs.length?xs.slice(0,3).map((E,z)=>o.jsxs("div",{className:"stat-list-row",children:[o.jsx("span",{className:"stat-rank",children:z+1}),o.jsx("span",{className:"stat-name",children:E.name}),o.jsx("span",{className:"stat-count",children:E.count})]},E.name)):o.jsx("div",{className:"stat-sub",children:"No publisher data yet."})})]}),o.jsxs("div",{className:"stat-card clickable",onClick:()=>Cn("genres"),children:[o.jsx("h3",{children:"Top Genres"}),o.jsx("div",{className:"stat-list",children:Ms.length?Ms.slice(0,3).map((E,z)=>o.jsxs("div",{className:"stat-list-row",children:[o.jsx("span",{className:"stat-rank",children:z+1}),o.jsx("span",{className:"stat-name",children:E.name}),o.jsx("span",{className:"stat-count",children:E.count})]},E.name)):o.jsx("div",{className:"stat-sub",children:"No genre data yet."})})]}),o.jsxs("div",{className:"stat-card clickable",onClick:()=>{bn()},children:[o.jsx("h3",{children:"Next Wishlist Release"}),o.jsx("div",{className:"stat-value next-release",children:wr?wr.title:"No upcoming releases"}),o.jsxs("div",{className:"stat-sub",children:[pt?pt.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"}):"-",o.jsx("br",{}),o.jsx("span",{id:"statNextCountdown",children:T})]})]}),o.jsxs("div",{className:"stat-card clickable",onClick:()=>Cn("collectionValue"),style:{textAlign:"center"},children:[o.jsx("h3",{children:"Collection Pricing"}),o.jsxs("div",{className:"stat-value stat-msrp",children:["$",Qt.msrpTotal.toFixed(2)]}),o.jsxs("div",{className:"stat-value stat-paid",children:["$",Qt.paidTotal.toFixed(2),Qt.msrpTotal>0&&o.jsxs("span",{className:"stat-paid-pct",children:["(",((1-Qt.paidTotal/Qt.msrpTotal)*100).toFixed(1),"% off)"]})]}),o.jsxs("div",{className:"stat-value stat-collectible",children:["$",Qt.collectibleTotal.toFixed(2)]}),o.jsx("div",{className:"stat-sub",children:"MSRP | Paid | Collectible overrides"})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("h3",{children:"Current Year Reads"}),o.jsx("div",{className:"stat-value",children:dr}),o.jsxs("div",{className:"stat-sub",children:["Reads in ",ht]})]}),o.jsxs("div",{className:"stat-stack",children:[o.jsxs("div",{className:"stat-card mini",children:[o.jsx("h3",{children:"Avg Books / Day"}),o.jsx("div",{className:"stat-value",children:(Ln==null?void 0:Ln.ytd)!=null?Ln.ytd.toFixed(2):"-"}),o.jsx("div",{className:"stat-sub",children:(Ln==null?void 0:Ln.lifetime)!=null?`YTD from Jan 1  Lifetime ${Ln.lifetime.toFixed(2)}`:"No reads logged yet"})]}),o.jsxs("div",{className:"stat-card mini clickable",onClick:()=>Cn("timeToRead"),children:[o.jsx("h3",{children:"Avg Days From Purchase to Read"}),o.jsx("div",{className:"stat-value",children:yn==null?"-":`${yn.toFixed(1)} days`}),o.jsx("div",{className:"stat-sub",children:"When both dates exist"})]})]}),o.jsxs("div",{className:"stat-duo",children:[o.jsxs("div",{className:"stat-card tall",children:[o.jsxs("h3",{children:["Reads Per Month (",ht,")"]}),o.jsx(QR,{data:_s})]}),o.jsxs("div",{className:"stat-card tall",children:[o.jsx("h3",{children:"Reads by Day of Week (Lifetime)"}),o.jsx(YR,{data:Ls}),o.jsx("div",{className:"stat-sub",children:"Based on all entries with a read date."})]})]}),o.jsxs("div",{className:"stat-card wide",style:{position:"relative",overflow:"hidden",background:"linear-gradient(135deg, rgba(255,182,193,0.08), rgba(255,105,180,0.08)) , radial-gradient(120% 120% at 0% 0%, rgba(255,182,193,0.14), rgba(36,12,24,0.8))",border:"1px solid rgba(255,182,193,0.24)",boxShadow:"0 16px 50px rgba(0,0,0,0.52)",paddingTop:18,marginTop:12},children:[o.jsx("div",{style:{position:"absolute",right:-32,top:-32,width:180,height:180,background:"radial-gradient(circle, rgba(255,105,180,0.16), rgba(255,105,180,0))",pointerEvents:"none"}}),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:12},children:[o.jsx("div",{style:{width:6,height:40,borderRadius:999,background:"linear-gradient(180deg, #ff7fb0, #ffb6c1)"}}),o.jsxs("div",{style:{flex:1},children:[o.jsx("h3",{style:{marginBottom:4},children:"Read Next"}),o.jsx("div",{className:"stat-sub",style:{color:"#f7d0dc",fontSize:"0.9rem"},children:"Weighted pick that balances backlog and upcoming releases."})]}),o.jsx("span",{style:{background:"rgba(255,182,193,0.18)",border:"1px solid rgba(255,182,193,0.32)",color:"#ffb6c1",fontSize:"0.78rem",padding:"6px 11px",borderRadius:"999px",letterSpacing:"0.02em"},children:"Smart"})]}),D?o.jsxs(o.Fragment,{children:[o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:14,alignItems:"stretch",textAlign:"center"},children:[o.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:10},children:[o.jsxs("div",{style:{padding:"12px 14px",borderRadius:"14px",border:"1px solid rgba(255,255,255,0.08)",background:"rgba(255,255,255,0.04)",display:"grid",gridTemplateColumns:"1fr",gap:8,textAlign:"center"},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:10,flexWrap:"wrap"},children:[o.jsx("div",{className:"stat-value",style:{lineHeight:1.2},children:D.title}),L&&L>new Date&&o.jsxs("span",{className:"stat-sub",style:{padding:"4px 8px",borderRadius:"999px",border:"1px solid rgba(255,218,123,0.5)",background:"rgba(255,218,123,0.12)",color:"#ffda7b",fontSize:"0.75rem"},children:["Snoozed to ",L.toLocaleDateString(void 0,{month:"short",day:"numeric"})]})]}),o.jsxs("div",{className:"stat-sub",style:{color:"#f7d0dc"},children:["Catch up ",D.behindCount," volume",D.behindCount===1?"":"s"," to reach vol ",D.catchUpTarget,"."]}),D.upcomingVolume?o.jsxs("div",{className:"stat-sub",style:{color:"#c5b3bc"},children:["Own to vol ",D.ownedVolume||0,"; next release is vol ",D.upcomingVolume,D.ownedVsUpcomingGap>0?` (gap ${D.ownedVsUpcomingGap})`:"","."]}):null,o.jsxs("div",{className:"stat-sub",style:{color:"#b6a6af"},children:["Ownership ",Math.round((D.ownershipRatio||0)*100),"%",D.latestPurchaseDays!=null?`  Latest buy ${D.latestPurchaseDays}d ago`:""]}),o.jsxs("div",{className:"stat-sub",style:{color:"#b6a6af"},children:["Queued after:"," ",q?`${q.title} (${q.unreadCount} unread)`:"Shuffle for another option","."]})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,textAlign:"center"},children:[o.jsxs("div",{style:{padding:"10px",borderRadius:"12px",border:"1px solid rgba(255,182,193,0.22)",background:"rgba(255,182,193,0.08)"},children:[o.jsx("div",{className:"stat-sub",style:{marginBottom:4},children:"Next release"}),o.jsx("div",{style:{fontWeight:700,marginBottom:2},children:D.nextRelease?D.nextRelease.date.toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"}):"None scheduled"}),o.jsx("div",{className:"stat-sub",children:D.nextRelease?`${D.daysToRelease} days out`:"Backlog focus"})]}),o.jsxs("div",{style:{padding:"10px",borderRadius:"12px",border:"1px solid rgba(255,255,255,0.12)",background:"rgba(255,255,255,0.05)"},children:[o.jsx("div",{className:"stat-sub",style:{marginBottom:4},children:"Up next"}),o.jsx("div",{style:{fontWeight:700,marginBottom:2},children:q?q.title:"Shuffle for another pick"}),o.jsx("div",{className:"stat-sub",children:q?`${q.unreadCount} unread`:"Queue empty"})]})]})]}),o.jsxs("div",{style:{padding:"12px 14px",borderRadius:"14px",border:"1px solid rgba(255,182,193,0.24)",background:"rgba(255,182,193,0.08)",display:"flex",flexDirection:"column",gap:8,textAlign:"center"},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,justifyContent:"center",flexWrap:"wrap"},children:[o.jsx("h4",{style:{margin:0},children:"Purchase Next"}),o.jsx("span",{className:"stat-sub",style:{padding:"2px 8px",borderRadius:"999px",border:"1px solid rgba(255,255,255,0.18)",background:"rgba(255,255,255,0.06)",fontSize:"0.7rem"},children:"Catch-up buy"})]}),ne?o.jsxs(o.Fragment,{children:[o.jsx("div",{style:{fontWeight:700,fontSize:"1rem"},children:ne.title}),o.jsxs("div",{className:"stat-sub",style:{color:"#f7d0dc"},children:["Need ",ne.missingCount," volume",ne.missingCount===1?"":"s"," to reach vol ",ne.releaseVolume,"."]}),o.jsxs("div",{className:"stat-sub",style:{color:"#b6a6af"},children:["Ownership ",Math.round((ne.ownershipRatio||0)*100),"%  Read"," ",Math.round((ne.readPct||0)*100),"% of owned"]}),o.jsxs("div",{className:"stat-sub",style:{color:"#c5b3bc"},children:["Own to vol ",ne.highestOwnedVolume||0,"; est. catch-up cost"," ",ne.costEstimate?`$${ne.costEstimate.toFixed(2)}`:"n/a"," ",ne.avgMsrp?`(avg $${ne.avgMsrp.toFixed(2)})`:""]}),o.jsxs("div",{className:"stat-sub",children:["Next release:"," ",ne.nextRelease?`${ne.nextRelease.date.toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"})} (${ne.daysToRelease} days)`:"No date"]})]}):o.jsx("div",{className:"stat-sub",children:"No purchase catch-ups needed right now."})]})]}),o.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",marginTop:12,justifyContent:"center"},children:[o.jsx("button",{className:"stat-link",type:"button",onClick:()=>ge(E=>E+1),children:"Shuffle pick"}),o.jsx("button",{type:"button",className:"stat-link",style:{background:"rgba(255,218,123,0.1)",borderColor:"rgba(255,218,123,0.4)",color:"#ffda7b"},onClick:()=>ee(7),children:"Delay 7 days"}),o.jsx("button",{type:"button",className:"stat-link",style:{background:"rgba(255,255,255,0.08)",borderColor:"rgba(255,255,255,0.22)"},onClick:()=>ue({}),children:"Clear delays"})]})]}):o.jsx("div",{className:"stat-sub",children:"Add some unread volumes to get a tailored pick."})]}),o.jsxs("div",{className:"stat-card wide",children:[o.jsx("h3",{children:"Activity Log"}),bi&&o.jsx("div",{className:"error",style:{textAlign:"center"},children:y}),o.jsx("div",{className:"activity-log scrollable",children:Ce.length?Ce.map((E,z)=>{const W=E.ts?new Date(E.ts):null;return o.jsxs("div",{className:"activity-row",children:[o.jsx("span",{className:"activity-title",children:E.message}),o.jsx("span",{className:"activity-date",children:W?W.toLocaleString(void 0,{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}):""})]},(E.message||"activity")+z)}):o.jsx("div",{className:"stat-sub",children:"No recent activity yet."})})]}),o.jsxs("div",{className:"stat-card wide",style:{minHeight:"340px",maxHeight:"480px"},children:[o.jsx("h3",{children:"Suggestions"}),Qe&&o.jsx("div",{className:"error",style:{textAlign:"center"},children:Qe}),o.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",alignItems:"stretch"},children:["anime","manga"].map(E=>{const z=be.filter(W=>(W.type||"").toLowerCase()===E).sort((W,he)=>{var Te,$e,je,lt;return((($e=(Te=he.createdAt)==null?void 0:Te.getTime)==null?void 0:$e.call(Te))||0)-(((lt=(je=W.createdAt)==null?void 0:je.getTime)==null?void 0:lt.call(je))||0)});return o.jsxs("div",{style:{border:"1px solid rgba(255,182,193,0.18)",borderRadius:"16px",padding:"10px 12px",display:"flex",flexDirection:"column",background:"rgba(255,182,193,0.04)",minHeight:"240px"},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"8px",position:"relative"},children:[o.jsx("h4",{style:{margin:0,color:"#ffb6c1",textAlign:"center",flex:1},children:E==="anime"?"Anime":"Manga"}),o.jsxs("span",{className:"stat-sub",style:{position:"absolute",right:0},children:[z.length," suggestion",z.length===1?"":"s"]})]}),o.jsx("div",{className:"scrollable",style:{maxHeight:"280px",height:"280px",paddingRight:"4px",overflowY:"auto"},children:Ve?o.jsx("div",{className:"stat-sub",children:"Loading suggestions..."}):z.length?z.map(W=>{const he=W.createdAt instanceof Date?W.createdAt:W.createdAt?new Date(W.createdAt):null;return o.jsxs("div",{style:{border:"1px solid rgba(255,182,193,0.25)",borderRadius:"12px",padding:"8px 10px",marginBottom:"8px",background:"rgba(255,182,193,0.06)",display:"grid",gridTemplateColumns:"1fr auto",gap:"6px",alignItems:"center"},children:[o.jsxs("div",{children:[o.jsx("div",{style:{fontWeight:600,color:"#f7d0dc"},children:W.content||"(no content)"}),o.jsxs("div",{className:"stat-sub",style:{fontSize:"0.8rem"},children:[he?he.toLocaleString(void 0,{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}):""," ",W.from?`| ${W.from}`:""]})]}),o.jsx("div",{style:{display:"flex",gap:"6px"},children:e&&o.jsx("button",{type:"button",className:"stat-link",onClick:()=>_r(W.id),children:"Delete"})})]},W.id)}):o.jsx("div",{className:"stat-sub",children:"No suggestions yet."})})]},E)})}),o.jsxs("div",{className:"stat-sub",style:{marginTop:"8px",textAlign:"center"},children:["Total suggestions: ",be.length]})]}),o.jsxs("div",{className:"stat-card wide",children:[o.jsx("h3",{children:"Library Manager"}),Ae.length?o.jsxs("div",{className:"dash-library",children:[o.jsxs("div",{className:"dash-library-list",children:[Ae.map(E=>{const z=E.books.filter(je=>!!je.read||je.status==="Read"||je.Read===!0).length,W=$.has(E.seriesKey),he=se===E.seriesKey&&!ye,Te=kR(E),$e=E.books.some(je=>I_(je));return o.jsxs("div",{style:{marginBottom:"8px"},children:[o.jsxs("button",{type:"button",onClick:()=>Je(E.seriesKey),style:{width:"100%",textAlign:"left",background:Te?"rgba(255,179,71,0.08)":"transparent",border:`1px solid ${he?"#ff69b4":Te?"rgba(255,179,71,0.6)":"rgba(255,182,193,0.25)"}`,color:"#ffb6c1",padding:"8px",borderRadius:"8px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"8px",position:"relative",boxShadow:Te?"0 0 10px rgba(255,179,71,0.5)":he?"0 0 8px rgba(255,105,180,0.5)":"none"},children:[o.jsx("span",{style:{transition:"transform 0.2s ease",transform:W?"rotate(90deg)":"none"},children:">"}),o.jsx("span",{style:{flex:1},children:E.displayName}),o.jsxs("span",{style:{fontSize:"11px",color:"#f8d1d8"},children:[E.books.length," book",E.books.length===1?"":"s",E.books.length?` | ${z} read`:""]}),$e&&o.jsx("span",{title:"Some volumes are missing required data",style:{width:"12px",height:"12px",borderRadius:"999px",background:"#ffb347",border:"1px solid rgba(255,255,255,0.25)",boxShadow:"0 0 10px rgba(255,179,71,0.6)"}})]}),o.jsx("div",{style:{margin:"6px 0 10px 10px",paddingLeft:"10px",borderLeft:"1px solid rgba(255,182,193,0.25)",display:W?"block":"none"},children:E.books.map(je=>{const lt=ye===je.id,Ze=O.has(je.id);je.read||je.status==="Read"||je.Read;const Vt=I_(je,{ignoreShared:!0});return o.jsxs("button",{type:"button",onClick:Bt=>rn(Bt,je.id,E.seriesKey),style:{width:"100%",textAlign:"left",background:Vt?"rgba(255,179,71,0.1)":"transparent",border:`1px solid ${lt?"#ff69b4":Ze?"#fff59d":Vt?"rgba(255,179,71,0.6)":"rgba(255,182,193,0.25)"}`,color:"#ffb6c1",padding:"8px",borderRadius:"8px",marginBottom:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"8px",boxShadow:lt?"0 0 8px rgba(255,105,180,0.5)":Ze?"0 0 10px rgba(255,255,180,0.65)":Vt?"0 0 10px rgba(255,179,71,0.5)":"none"},children:[o.jsx("span",{style:{flex:1,minWidth:0},children:je.Title||je.title||"Untitled"}),Vt&&o.jsx("span",{style:{flexShrink:0,padding:"2px 8px",borderRadius:"999px",background:"rgba(255,179,71,0.18)",border:"1px solid rgba(255,179,71,0.6)",color:"#ffd8a1",fontSize:"11px",fontWeight:700,whiteSpace:"nowrap"},children:"Missing data"})]},je.id)})})]},E.seriesKey)}),Ae.length>0&&O.size>0&&o.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:o.jsx("button",{type:"button",style:{padding:"6px 12px",borderRadius:"999px",border:"1px solid #ffb6c1",background:"transparent",color:"#ffb6c1",cursor:"pointer"},onClick:sn,children:"Clear Selection"})})]}),o.jsxs("div",{className:"dash-library-details",children:[O.size>0&&o.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px",padding:"10px",marginBottom:"10px",border:"1px dashed rgba(255,182,193,0.45)",borderRadius:"10px",background:"rgba(255,182,193,0.08)"},children:[o.jsxs("div",{children:["Apply Amount Paid to ",O.size," selected book",O.size===1?"":"s"]}),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",flexWrap:"wrap"},children:[o.jsx("input",{type:"number",step:"0.01",min:"0",value:A,onChange:E=>U(E.target.value),style:{maxWidth:"140px"}}),o.jsx("button",{type:"button",className:"dash-btn primary",onClick:Er,children:"Apply to Selected"})]})]}),!se&&!ye&&o.jsx("div",{className:"stat-sub",style:{marginTop:6},children:"Select a series or book to edit"}),se&&!ye&&ma&&o.jsxs("div",{children:[o.jsx("div",{className:"dash-detail-title",children:ma.displayName}),o.jsx("div",{className:"dash-detail-row",children:o.jsxs("label",{className:"inline-checkbox",children:[o.jsx("input",{ref:V,type:"checkbox",checked:P.readChecked,onChange:E=>C(z=>({...z,readChecked:E.target.checked,readIndeterminate:!1}))}),o.jsx("span",{children:"Mark series as read"})]})}),o.jsxs("div",{className:`dash-detail-row${Fs.publisher?" missing-row":""}`,children:[o.jsx("span",{children:"Publisher"}),o.jsx("input",{type:"text",value:P.publisher,onChange:E=>C(z=>({...z,publisher:E.target.value})),placeholder:"Set publisher for series"})]}),o.jsxs("div",{className:`dash-detail-row${Fs.demographic?" missing-row":""}`,children:[o.jsx("span",{children:"Demographic"}),o.jsxs("select",{value:P.demographic,onChange:E=>C(z=>({...z,demographic:E.target.value})),children:[o.jsx("option",{value:"",children:"Select Demographic"}),o.jsx("option",{value:"Shounen",children:"Shounen"}),o.jsx("option",{value:"Seinen",children:"Seinen"}),o.jsx("option",{value:"Shoujo",children:"Shoujo"}),o.jsx("option",{value:"Josei",children:"Josei"})]})]}),o.jsxs("div",{className:`dash-detail-row${Fs.genre?" missing-row":""}`,children:[o.jsx("span",{children:"Genre"}),o.jsx("input",{type:"text",value:P.genre,onChange:E=>C(z=>({...z,genre:E.target.value})),placeholder:"Primary genre"})]}),o.jsxs("div",{className:"dash-detail-row",children:[o.jsx("span",{children:"Sub-Genre"}),o.jsx("input",{type:"text",value:P.subGenre,onChange:E=>C(z=>({...z,subGenre:E.target.value})),placeholder:"Secondary genre / theme"})]}),!P.dateMixed&&o.jsxs("div",{className:`dash-detail-row${Fs.datePurchased?" missing-row":""}`,children:[o.jsx("span",{children:"Date Purchased"}),o.jsx("input",{type:"date",value:P.datePurchased,onChange:E=>C(z=>({...z,datePurchased:E.target.value}))})]}),o.jsxs("div",{className:`dash-detail-row${Fs.msrp?" missing-row":""}`,children:[o.jsx("span",{children:"MSRP (per book)"}),o.jsx("input",{type:"number",step:"0.01",min:"0",value:P.msrp,onChange:E=>C(z=>({...z,msrp:E.target.value})),placeholder:"0.00"})]}),o.jsxs("div",{className:"dash-detail-actions",children:[o.jsx("button",{type:"button",className:"dash-btn secondary",onClick:gt,children:"Cancel"}),o.jsx("button",{type:"button",className:"dash-btn primary",onClick:_t,children:"Save Series"})]})]}),ye&&jt&&o.jsxs("div",{children:[o.jsx("div",{className:"dash-detail-title",children:jt.Title||jt.title||"Untitled"}),o.jsx("div",{className:"dash-detail-row",children:o.jsxs("label",{className:"inline-checkbox",children:[o.jsx("input",{type:"checkbox",checked:!!Y.read,onChange:E=>ie(z=>({...z,read:E.target.checked,dateRead:E.target.checked?z.dateRead||new Date().toISOString().slice(0,10):"",rating:E.target.checked?z.rating:""}))}),o.jsx("span",{children:"Mark as read"})]})}),o.jsxs("div",{className:`dash-detail-row${Mr.datePurchased?" missing-row":""}`,children:[o.jsx("span",{children:"Date Purchased"}),o.jsx("input",{type:"date",value:Y.datePurchased,onChange:E=>ie(z=>({...z,datePurchased:E.target.value}))})]}),Y.read&&o.jsxs("div",{className:"dash-detail-row",children:[o.jsx("span",{children:"Date Read"}),o.jsx("input",{type:"date",value:Y.dateRead,onChange:E=>ie(z=>({...z,dateRead:E.target.value}))})]}),o.jsxs("div",{className:`dash-detail-row${Mr.pageCount?" missing-row":""}`,children:[o.jsx("span",{children:"Page Count"}),o.jsx("input",{type:"number",min:"0",step:"1",value:Y.pageCount,onChange:E=>ie(z=>({...z,pageCount:E.target.value}))})]}),o.jsxs("div",{className:`dash-detail-row${Mr.msrp?" missing-row":""}`,children:[o.jsx("span",{children:"MSRP (per book)"}),o.jsx("input",{type:"number",step:"0.01",min:"0",value:Y.msrp,onChange:E=>ie(z=>({...z,msrp:E.target.value})),placeholder:"0.00"})]}),!(Y.special&&Y.specialType==="collectible")&&o.jsxs("div",{className:`dash-detail-row${Mr.amountPaid?" missing-row":""}`,children:[o.jsx("span",{children:"Amount Paid"}),o.jsx("input",{type:"number",step:"0.01",min:"0",value:Y.amountPaid,onChange:E=>ie(z=>({...z,amountPaid:E.target.value})),placeholder:"0.00"})]}),Y.read&&o.jsxs("div",{className:"dash-detail-row",children:[o.jsx("span",{children:"Star Rating"}),o.jsx("input",{type:"number",min:"0",max:"5",step:"0.5",value:Y.rating,onChange:E=>ie(z=>({...z,rating:E.target.value})),placeholder:"0-5"})]}),o.jsx("div",{className:`dash-detail-row${Mr.specialType?" missing-row":""}`,children:o.jsxs("label",{className:"inline-checkbox",style:{width:"100%"},children:[o.jsx("input",{type:"checkbox",checked:!!Y.special,onChange:E=>ie(z=>({...z,special:E.target.checked,specialType:E.target.checked?z.specialType:"",specialVolumes:E.target.checked?z.specialVolumes:"",collectiblePrice:E.target.checked?z.collectiblePrice:""}))}),o.jsx("span",{children:"Special?"})]})}),Y.special&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:`dash-detail-row${Mr.specialType?" missing-row":""}`,children:[o.jsx("span",{children:"Special Type"}),o.jsxs("select",{value:Y.specialType,onChange:E=>ie(z=>({...z,specialType:E.target.value,specialVolumes:E.target.value==="specialEdition"?z.specialVolumes:"",collectiblePrice:E.target.value==="collectible"?z.collectiblePrice:""})),children:[o.jsx("option",{value:"",children:"Select type"}),o.jsx("option",{value:"specialEdition",children:"Special Edition"}),o.jsx("option",{value:"collectible",children:"Collectible"})]})]}),Y.specialType==="specialEdition"&&o.jsxs("div",{className:`dash-detail-row${Mr.specialVolumes?" missing-row":""}`,children:[o.jsx("span",{children:"Volumes Contained"}),o.jsx("input",{type:"number",min:"1",step:"1",value:Y.specialVolumes,onChange:E=>ie(z=>({...z,specialVolumes:E.target.value}))})]}),Y.specialType==="collectible"&&o.jsxs("div",{className:`dash-detail-row${Mr.collectiblePrice?" missing-row":""}`,children:[o.jsx("span",{children:"Collectible Price"}),o.jsx("input",{type:"number",min:"0",step:"0.01",value:Y.collectiblePrice,onChange:E=>ie(z=>({...z,collectiblePrice:E.target.value})),placeholder:"0.00"})]})]}),o.jsxs("div",{className:"dash-detail-actions",children:[o.jsx("button",{type:"button",className:"dash-btn secondary",onClick:Os,children:"Cancel"}),o.jsx("button",{type:"button",className:"dash-btn primary",onClick:ts,children:"Save Changes"})]})]})]})]}):o.jsx("div",{className:"stat-sub",children:"No library items."})]})]})}),Dr&&o.jsx("div",{id:"calendarOverlay",onClick:E=>{E.target===E.currentTarget&&Xa()},children:o.jsxs("div",{id:"calendarCard",onClick:E=>E.stopPropagation(),children:[o.jsxs("div",{className:"calendar-header",children:[o.jsx("div",{className:"calendar-title",children:new Date(Yr.year,Yr.month).toLocaleString(void 0,{month:"long",year:"numeric"})}),o.jsxs("div",{className:"calendar-nav",children:[o.jsx("button",{className:"calendar-nav-btn",onClick:()=>fr(-1),type:"button",children:"<"}),o.jsx("button",{className:"calendar-nav-btn",onClick:()=>fr(1),type:"button",children:">"})]})]}),o.jsxs("div",{className:"calendar-weekdays",children:[o.jsx("div",{children:"Sun"}),o.jsx("div",{children:"Mon"}),o.jsx("div",{children:"Tue"}),o.jsx("div",{children:"Wed"}),o.jsx("div",{children:"Thu"}),o.jsx("div",{children:"Fri"}),o.jsx("div",{children:"Sat"})]}),o.jsxs("div",{className:"calendar-grid",children:[Wn.cells.map((E,z)=>{if(E.type==="pad")return o.jsx("div",{className:"calendar-day pad"},`pad-${z}`);const{day:W,dateKey:he,items:Te,isToday:$e}=E;return o.jsxs("div",{className:"calendar-day"+(Te.length?" has-releases":"")+($e?" today":""),onClick:()=>{Te.length&&Zt({date:he,items:Te})},role:"button",tabIndex:0,onKeyDown:je=>{if(je.key==="Enter"||je.key===" "){if(je.preventDefault(),!Te.length)return;Zt({date:he,items:Te})}},children:[o.jsx("div",{className:"day-num",children:W}),o.jsxs("div",{className:"calendar-releases",children:[Te.slice(0,2).map(je=>o.jsx("div",{className:"calendar-release purchased",children:je.title||"Untitled"},je.id)),Te.length>2&&o.jsxs("div",{className:"calendar-release more",children:["+",Te.length-2," more"]})]})]},he)}),!Wn.hasItems&&o.jsx("div",{className:"calendar-empty",children:"No purchases for this month."})]}),o.jsx("button",{id:"calendarClose",onClick:Xa,type:"button",children:"x"})]})}),er&&o.jsx("div",{className:"purchase-overlay",onClick:E=>{E.target===E.currentTarget&&Zt(null)},children:o.jsxs("div",{className:"purchase-day-modal",onClick:E=>E.stopPropagation(),children:[o.jsxs("div",{className:"purchase-day-header",children:[o.jsx("div",{className:"purchase-day-title",children:new Date(er.date).toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"})}),o.jsx("button",{className:"manga-btn secondary",onClick:()=>Zt(null),type:"button",children:"x"})]}),o.jsx("div",{className:"purchase-day-list",children:er.items.map(E=>o.jsx("div",{className:"purchase-day-item",children:E.title||"Untitled"},E.id))})]})}),Dt&&o.jsx("div",{id:"calendarOverlay",onClick:()=>Xn(!1),style:{zIndex:10060},children:o.jsxs("div",{id:"calendarCard",onClick:E=>E.stopPropagation(),children:[o.jsxs("div",{className:"calendar-header",children:[o.jsx("div",{className:"calendar-title",children:ur.toLocaleString(void 0,{month:"long",year:"numeric"})}),o.jsxs("div",{className:"calendar-nav",children:[o.jsx("button",{className:"calendar-nav-btn",onClick:()=>Fr(-1),type:"button",children:"<"}),o.jsx("button",{className:"calendar-nav-btn",onClick:()=>Fr(1),type:"button",children:">"})]})]}),o.jsxs("div",{className:"calendar-weekdays",children:[o.jsx("div",{children:"Sun"}),o.jsx("div",{children:"Mon"}),o.jsx("div",{children:"Tue"}),o.jsx("div",{children:"Wed"}),o.jsx("div",{children:"Thu"}),o.jsx("div",{children:"Fri"}),o.jsx("div",{children:"Sat"})]}),o.jsx("div",{className:"calendar-grid",children:nn.map((E,z)=>{var W;return E.type==="pad"?o.jsx("div",{className:"calendar-day pad"},z):o.jsxs("div",{className:"calendar-day"+(E.isToday?" today":"")+((W=E.releases)!=null&&W.length?" has-releases":""),onClick:()=>{var Te;if(!((Te=E.releases)!=null&&Te.length))return;const he=new Date(ur.getFullYear(),ur.getMonth(),E.day);Sn({dateLabel:he.toLocaleDateString(void 0,{month:"long",day:"numeric",year:"numeric"}),releases:E.releases})},role:"button",tabIndex:0,onKeyDown:he=>{var Te;if(he.key==="Enter"||he.key===" "){if(he.preventDefault(),!((Te=E.releases)!=null&&Te.length))return;const $e=new Date(ur.getFullYear(),ur.getMonth(),E.day);Sn({dateLabel:$e.toLocaleDateString(void 0,{month:"long",day:"numeric",year:"numeric"}),releases:E.releases})}},children:[o.jsx("div",{className:"day-num",children:E.day}),o.jsxs("div",{className:"calendar-releases",children:[(E.releases||[]).slice(0,2).map((he,Te)=>o.jsx("div",{className:"calendar-release purchased",title:he.title,children:he.title},Te)),(E.releases||[]).length>2&&o.jsxs("div",{className:"calendar-release more",children:["+",(E.releases||[]).length-2," more"]})]})]},E.dateKey||z)})}),!tn.length&&o.jsx("div",{className:"calendar-empty",children:"No reads recorded yet."}),o.jsx("button",{id:"calendarClose",onClick:()=>Xn(!1),type:"button",children:"x"})]})}),Zn&&o.jsx("div",{id:"calendarOverlay",onClick:()=>Sn(null),style:{zIndex:10080},children:o.jsxs("div",{id:"calendarCard",onClick:E=>E.stopPropagation(),style:{maxWidth:"520px"},children:[o.jsxs("div",{className:"calendar-header",children:[o.jsx("div",{className:"calendar-title",children:Zn.dateLabel}),o.jsx("button",{className:"calendar-close-btn",onClick:()=>Sn(null),type:"button",children:"x"})]}),o.jsx("div",{className:"calendar-releases modal-list",children:Zn.releases.map((E,z)=>o.jsx("div",{className:"calendar-release purchased",title:E.title,children:E.title},z))})]})}),cr&&o.jsx("div",{id:"calendarOverlay",onClick:()=>un(!1),children:o.jsxs("div",{id:"calendarCard",onClick:E=>E.stopPropagation(),children:[o.jsxs("div",{className:"calendar-header",children:[o.jsx("div",{className:"calendar-title",children:kn.toLocaleString(void 0,{month:"long",year:"numeric"})}),o.jsxs("div",{className:"calendar-nav",children:[o.jsx("button",{className:"calendar-nav-btn",onClick:()=>Mt(new Date(kn.getFullYear(),kn.getMonth()-1,1)),children:"<"}),o.jsx("button",{className:"calendar-nav-btn",onClick:()=>Mt(new Date(kn.getFullYear(),kn.getMonth()+1,1)),children:">"})]})]}),o.jsxs("div",{className:"calendar-weekdays",children:[o.jsx("div",{children:"Sun"}),o.jsx("div",{children:"Mon"}),o.jsx("div",{children:"Tue"}),o.jsx("div",{children:"Wed"}),o.jsx("div",{children:"Thu"}),o.jsx("div",{children:"Fri"}),o.jsx("div",{children:"Sat"})]}),o.jsx("div",{className:"calendar-grid",id:"releaseCalendar",children:Us.map((E,z)=>E.type==="pad"?o.jsx("div",{className:"calendar-day pad"},z):o.jsxs("div",{className:"calendar-day"+(E.isToday?" today":""),children:[o.jsx("div",{className:"day-num",children:E.day}),o.jsxs("div",{className:"calendar-releases",children:[(Nt===E.dateKey?E.releases:E.releases.slice(0,2)).map((W,he)=>o.jsx("div",{className:"calendar-release"+(W.purchased?" purchased":""),title:W.title,children:W.title},he)),E.releases.length>2&&o.jsxs("button",{className:"calendar-more-btn",onClick:()=>{const W=new Date(kn.getFullYear(),kn.getMonth(),E.day);cn({dateLabel:W.toLocaleDateString(void 0,{month:"long",day:"numeric",year:"numeric"}),releases:E.releases})},children:["+",E.releases.length-2," more"]})]})]},z))}),!en.length&&o.jsx("div",{className:"calendar-empty",children:"No wishlist releases found."}),o.jsx("button",{id:"calendarClose",onClick:()=>un(!1),children:"x"})]})}),dn.open&&o.jsx("div",{id:"statDetailOverlay",onClick:Tr,children:o.jsxs("div",{id:"statDetailCard",onClick:E=>E.stopPropagation(),children:[o.jsx("button",{id:"statDetailClose",onClick:Tr,children:"x"}),o.jsxs("h2",{id:"statDetailTitle",children:[dn.type==="publishers"&&"Top Publishers",dn.type==="genres"&&"Top Genres",dn.type==="demographics"&&"Top Demographics",dn.type==="timeToRead"&&"Avg Time From Purchase to Read",dn.type==="collectionValue"&&"Collection Value",dn.type==="pages"&&"Pages Read vs Total",dn.type==="ratings"&&"Ratings",dn.type==="releases"&&"Library & Wishlist Releases"]}),o.jsx("div",{id:"statDetailBody",children:sl()})]})}),It&&o.jsx("div",{id:"calendarOverlay",onClick:()=>cn(null),style:{zIndex:10080},children:o.jsxs("div",{id:"calendarCard",onClick:E=>E.stopPropagation(),style:{maxWidth:"520px"},children:[o.jsxs("div",{className:"calendar-header",children:[o.jsx("div",{className:"calendar-title",children:It.dateLabel}),o.jsx("button",{className:"calendar-close-btn",onClick:()=>cn(null),type:"button",children:"x"})]}),o.jsx("div",{className:"calendar-releases modal-list",children:It.releases.map((E,z)=>o.jsx("div",{className:"calendar-release"+(E.purchased?" purchased":""),title:E.title,children:E.title},z))})]})}),e&&ce&&o.jsx("div",{className:"dashboard-modal-backdrop visible",onClick:E=>{E.target===E.currentTarget&&Re(!1)},children:o.jsxs("div",{className:"dashboard-modal",children:[o.jsxs("div",{className:"dashboard-modal-header",children:[o.jsx("h3",{children:"Webhook Settings"}),o.jsx("button",{className:"dashboard-close",onClick:()=>Re(!1),type:"button",children:"X"})]}),o.jsxs("div",{className:"dashboard-modal-body",children:[o.jsxs("label",{className:"dashboard-input",children:[o.jsx("span",{children:"Yearly summary webhook"}),o.jsx("input",{type:"text",value:F.yearly,onChange:E=>J(z=>({...z,yearly:E.target.value}))})]}),o.jsxs("label",{className:"dashboard-input",children:[o.jsx("span",{children:"Release timer webhook"}),o.jsx("input",{type:"text",value:F.release,onChange:E=>J(z=>({...z,release:E.target.value}))})]}),o.jsxs("label",{className:"dashboard-input",children:[o.jsx("span",{children:"Activity webhook"}),o.jsx("input",{type:"text",value:F.activity,onChange:E=>J(z=>({...z,activity:E.target.value}))})]}),o.jsxs("div",{className:"dashboard-input",style:{borderTop:"1px solid rgba(255,182,193,0.2)",paddingTop:8},children:[o.jsx("span",{children:"User roles"}),o.jsx("div",{style:{marginTop:8,fontSize:"0.85rem",color:"var(--text-soft)"},children:k?o.jsx("span",{children:"Loading users"}):Ee.length===0?o.jsx("span",{children:"No users found."}):o.jsx("ul",{style:{listStyle:"none",margin:"6px 0 0",padding:0,display:"flex",gap:6,flexDirection:"column"},children:Ee.map(E=>o.jsxs("li",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:8,background:"rgba(24,5,18,0.7)",border:"1px solid rgba(255,182,193,0.18)",borderRadius:10,padding:"6px 8px",flexWrap:"wrap"},children:[o.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:2},children:[o.jsx("strong",{children:E.displayName||E.email||E.uid}),o.jsx("span",{style:{fontSize:"0.85rem",opacity:.8},children:E.email||E.uid})]}),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[o.jsx("span",{className:"role-pill",children:E.role||"viewer"}),E.role==="admin"?o.jsx("button",{className:"dashboard-close",type:"button",onClick:()=>yr(E.uid,"viewer"),style:{padding:"4px 10px"},children:"Make viewer"}):o.jsx("button",{className:"stat-link",type:"button",onClick:()=>yr(E.uid,"admin"),style:{padding:"4px 10px"},children:"Make admin"})]})]},E.uid))})})]})]}),o.jsxs("div",{className:"dashboard-modal-footer",children:[o.jsx("button",{className:"stat-link",type:"button",onClick:async()=>{try{await Ps(bt(rt,"settings","webhooks"),{yearly:F.yearly||Al,release:F.release||jl,activity:F.activity||Va}),Re(!1)}catch(E){console.error("Failed to save webhooks",E),alert("Failed to save webhooks.")}},children:"Save"}),o.jsx("button",{className:"stat-link danger",type:"button",onClick:()=>Re(!1),children:"Cancel"})]})]})})]})}function XR(){const[n,e]=j.useState(!0),[t,s]=j.useState(""),[a,l]=j.useState(0),[u,f]=j.useState([]),[m,y]=j.useState(0),_=j.useRef(null);j.useEffect(()=>{document.title="Music | im.ok"},[]),j.useEffect(()=>{let we=!1;async function O(){e(!0),s("");try{const ae=await fetch("https://music-api-worker.imokissick.workers.dev/music");if(!ae.ok)throw new Error("Worker fetch failed");const I=await ae.json();if(we)return;const N=Array.isArray(I.combined)?I.combined:[],A=Array.isArray(I.spotify)?I.spotify:[],U=Array.isArray(I.soundcloud)?I.soundcloud:[],P=[...N,...A,...U].reduce((C,Y)=>{const ie=(Y.title||"").toLowerCase().trim();if(!ie)return C;const Ce=C.findIndex(fe=>(fe.title||"").toLowerCase().trim()===ie);return Ce>=0?(C[Ce].source!=="spotify"&&Y.source==="spotify"&&(C[Ce]=Y),C):(C.push(Y),C)},[]).map(C=>({...C,releaseDate:C.releaseDate?new Date(C.releaseDate):new Date}));f(P)}catch(ae){console.error(ae),we||s("Failed to load music feeds.")}finally{we||e(!1)}}return O(),()=>{we=!0}},[]);const T=Math.min(4,Math.max(1,u.length)),S=T?Math.ceil(u.length/T):0,F=()=>{_.current&&clearInterval(_.current),u.length&&(y(we=>we+1),_.current=setInterval(()=>{l(we=>(Math.floor(we/T)+1)%S*T%u.length),y(we=>we+1)},15e3))};j.useEffect(()=>{if(u.length)return F(),()=>{_.current&&clearInterval(_.current)}},[u,T]);const J=we=>{u.length&&(l(O=>(Math.floor(O/T)+we+S)%S*T%u.length),F())},$=we=>{u.length&&(l(we*T%u.length),F())},B=we=>O=>{O.preventDefault();const I=we.source==="spotify"?`spotify:album:${we.id}`:we.url,N=we.url;try{const A=setTimeout(()=>{window.open(N,"_blank","noopener,noreferrer")},600);window.location.href=I,setTimeout(()=>clearTimeout(A),800)}catch{window.open(N,"_blank","noopener,noreferrer")}},se=u[0],_e=we=>we?{backgroundImage:`url(${we})`,backgroundSize:"cover",backgroundPosition:"center"}:{},ye=se?se.source==="spotify"?"Spotify":"SoundCloud":"";return o.jsxs("main",{className:"page music-page",children:[o.jsxs("header",{className:"music-hero",children:[o.jsxs("div",{className:"music-hero-content",children:[o.jsx("p",{className:"music-pill",children:"im.ok  Artist"}),o.jsx("h1",{children:se?se.title:"Latest & Greatest"}),o.jsx("p",{className:"music-sub",children:"Check out my latest song. I know it's been almost a whole year since I've released. I have been on a much needed hiatus. I felt the whole world crumbling around me and had no time to breathe so this is why I took a break. Here's to 2026!"}),se&&o.jsx("div",{className:"music-badges",children:o.jsx("span",{children:ye})})]}),o.jsx("div",{className:"music-hero-embed",children:o.jsxs("div",{className:"music-hero-art",style:_e(se==null?void 0:se.artwork),children:[!(se!=null&&se.artwork)&&o.jsx("div",{className:"music-hero-art-fallback",children:"Artwork"}),se&&o.jsx("button",{className:"music-link music-play hero-play","aria-label":`Play ${se.title}`,onClick:B(se)})]})})]}),o.jsxs("section",{className:"music-section",children:[o.jsx("div",{className:"music-section-header",children:o.jsx("h2",{children:"Releases"})}),t&&o.jsx("div",{className:"music-error",children:t}),n&&o.jsx("div",{className:"music-loading",children:"Loading music feeds..."}),!n&&u.length===0&&o.jsx("div",{className:"music-empty",children:"Connect Spotify/SoundCloud tokens to see live releases."}),!n&&u.length>0&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"music-carousel-wrap",children:[o.jsx("button",{className:"music-nav left",onClick:()=>J(-1),"aria-label":"Previous releases",children:""}),o.jsx("div",{className:"music-carousel",children:Array.from({length:T}).map((we,O)=>{const ae=u[(a+O)%u.length];return ae?o.jsxs("div",{className:"music-card",children:[o.jsx("div",{className:"music-card-art",style:_e(ae.artwork)}),o.jsxs("div",{className:"music-card-body",children:[o.jsx("div",{className:"music-card-title",children:ae.title}),o.jsx("div",{className:"music-card-actions",children:o.jsx("button",{className:"music-link music-play","aria-label":`Play ${ae.title}`,onClick:B(ae)})})]})]},`${ae.id}-${O}`):null})}),o.jsx("button",{className:"music-nav right",onClick:()=>J(1),"aria-label":"Next releases",children:""})]}),o.jsx("div",{className:"music-dots",children:Array.from({length:S}).map((we,O)=>{const ae=Math.floor(a/T)===O,I=ae?`${O}-${m}`:`${O}-idle`;return o.jsx("button",{className:`dot ${ae?"active":""}`,onClick:()=>$(O),"aria-label":`Go to set ${O+1}`,children:o.jsx("span",{className:"dot-fill"},I)},O)})})]})]}),o.jsxs("div",{className:"music-feeds-row",children:[o.jsxs("section",{className:"music-section",children:[o.jsx("div",{className:"music-section-header",children:o.jsx("h2",{children:"Spotify"})}),o.jsx("div",{className:"music-embed-card",children:o.jsx("iframe",{title:"Spotify Artist",src:"https://open.spotify.com/embed/artist/00sbWLxYLDs8i5BLQL9Qdo?utm_source=generator&theme=0",width:"100%",height:"400",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy"})})]}),o.jsxs("section",{className:"music-section",children:[o.jsx("div",{className:"music-section-header",children:o.jsx("h2",{children:"SoundCloud"})}),o.jsx("div",{className:"music-embed-card",children:o.jsx("iframe",{title:"SoundCloud Player",width:"100%",height:"400",scrolling:"no",frameBorder:"no",allow:"autoplay",src:"https://w.soundcloud.com/player/?url=https%3A//soundcloud.com/imxk&color=%23ff69b4&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true&visual=true"})})]})]})]})}function ZR(){const n=ic(),{user:e}=Qa(),t=async a=>{if(!(a!=null&&a.uid))return;const l=bt(rt,"users",a.uid);try{const u=await kd(l),f=u.exists()?u.data():null,m=(f==null?void 0:f.role)||"viewer";await Ps(l,{role:m,email:a.email||(f==null?void 0:f.email)||"",displayName:a.displayName||(f==null?void 0:f.displayName)||"",createdAt:(f==null?void 0:f.createdAt)||za()},{merge:!0})}catch(u){console.warn("Failed to upsert user doc",u)}};j.useEffect(()=>{e!=null&&e.uid&&t(e).finally(()=>n("/"))},[e,n]);async function s(){try{const a=new Is,l=await L0(ms,a);await t(l.user),n("/")}catch(a){console.error(a),alert("Google Sign-In failed.")}}return o.jsx("div",{className:"signin-page",children:o.jsxs("div",{className:"signin-card",children:[o.jsx("h2",{className:"signin-title",children:"Welcome Back"}),o.jsx("p",{className:"signin-sub",children:"Sign in to access the dashboard & edit collections."}),o.jsxs("button",{className:"google-btn",onClick:s,children:[o.jsx("img",{src:"https://www.svgrepo.com/show/475656/google-color.svg",alt:"",className:"google-icon"}),"Continue with Google"]}),o.jsxs("button",{className:"signin-cancel",onClick:()=>n("/"),children:["<"," Back to Home"]})]})})}const eA=j.lazy(()=>vc(()=>import("./SteamCard-Cd-UN1si.js"),[])),tA=j.lazy(()=>vc(()=>import("./SteamRecents-MtuOiQd8.js"),[])),nA=j.lazy(()=>vc(()=>import("./SteamGames-BM4lpM1C.js"),[]));function rA(){return j.useEffect(()=>{document.title="Tyler's Gaming Lounge"},[]),o.jsxs("div",{className:"steam-page page",children:[o.jsxs("header",{style:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",gap:"6px"},children:[o.jsx("h1",{style:{margin:0,fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Tyler's Gaming Lounge"}),o.jsx("p",{style:{margin:"6px 0 0",color:"var(--text-soft)",fontSize:"0.9rem"},children:"This will be the home to all of my gaming collections, this is still being worked on, but thought it was cool with just steam for now."})]}),o.jsx(Ef,{minHeight:260,children:o.jsx(j.Suspense,{fallback:o.jsx(Ou,{label:"Profile"}),children:o.jsx(eA,{})})}),o.jsx(Ef,{minHeight:240,children:o.jsx(j.Suspense,{fallback:o.jsx(Ou,{label:"Recently played"}),children:o.jsx(tA,{})})}),o.jsx(Ef,{minHeight:400,children:o.jsx(j.Suspense,{fallback:o.jsx(Ou,{label:"Library & Achievements"}),children:o.jsx(nA,{})})})]})}function Ef({children:n,minHeight:e=200}){const[t,s]=j.useState(!1),a=j.useRef(null);j.useEffect(()=>{const u=new IntersectionObserver(f=>{f[0].isIntersecting&&(s(!0),u.disconnect())},{rootMargin:"200px 0px"});return a.current&&u.observe(a.current),()=>u.disconnect()},[]);const l=t?void 0:{minHeight:e};return o.jsx("div",{ref:a,style:l,children:t?n:o.jsx(Ou,{})})}function Ou({label:n="Loading section"}){return o.jsxs("div",{className:"steam-skeleton",children:[o.jsx("div",{className:"steam-skeleton-bar"}),o.jsx("div",{className:"steam-skeleton-bar short"}),o.jsx("p",{className:"steam-skeleton-label",children:n})]})}const Tf={id:null,title:"",summary:"",body:"",cover:"",tags:"",status:"draft",publishedAt:null};function Fu(n){return n?n instanceof Date?n:n!=null&&n.toDate?n.toDate():null:null}function Cu(n){const e=Fu(n);return e?e.toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"}):""}function sA(n=[]){return Array.isArray(n)?n.join(", "):""}function iA(n){return(n||"").split(",").map(e=>e.trim()).filter(Boolean)}function aA(){var Ce;const{admin:n,user:e,loading:t}=Qa(),[s,a]=F1(),[l,u]=j.useState([]),[f,m]=j.useState(!0),[y,_]=j.useState(!1),[T,S]=j.useState(!1),[F,J]=j.useState(""),[$,B]=j.useState(Tf),[se,_e]=j.useState(null),ye=j.useMemo(()=>l.filter(fe=>fe.status==="published"),[l]),we=j.useMemo(()=>n?l:ye,[n,l,ye]),O=j.useMemo(()=>we.find(fe=>fe.id===se)||null,[se,we]);j.useEffect(()=>{document.title="Blog | Reviews"},[]),j.useEffect(()=>{t||N()},[n,t]),j.useEffect(()=>{const fe=s.get("post");fe&&_e(fe)},[s]),j.useEffect(()=>{var Ee;if(f)return;const ce=s.get("post")||se,Re=ce&&we.some(Q=>Q.id===ce)?ce:((Ee=we[0])==null?void 0:Ee.id)||null;A(Re,{list:we})},[f,we]);const ae=!n&&!f&&ye.length===0;function I(fe){return{id:fe.id,title:fe.title||"",summary:fe.summary||"",body:fe.body||"",cover:fe.cover||"",tags:sA(fe.tags),status:fe.status||"draft",publishedAt:fe.publishedAt||null}}async function N(fe=null){var ce;if(!t){m(!0),J("");try{const Re=An(rt,"blogPosts"),Ee=n?tp(Re,np("updatedAt","desc")):tp(Re,dw("status","==","published"),np("publishedAt","desc")),k=(await Ns(Ee)).docs.map(Le=>{const Ve=Le.data();return{id:Le.id,...Ve,createdAt:Fu(Ve.createdAt),updatedAt:Fu(Ve.updatedAt),publishedAt:Fu(Ve.publishedAt),tags:Array.isArray(Ve.tags)?Ve.tags:[]}});u(k);const H=n?k:k.filter(Le=>Le.status==="published"),be=fe||s.get("post")||(H.length?H[0].id:null);be&&H.some(Le=>Le.id===be)?A(be,{list:H}):A(((ce=H[0])==null?void 0:ce.id)||null,{list:H})}catch(Re){console.error("Failed to load blog posts",Re);const Ee=(Re==null?void 0:Re.code)==="permission-denied";J(Ee?"You do not have permission to view these posts. Make sure you are signed in with an admin account.":"Failed to load posts. Try again shortly.")}finally{m(!1)}}}function A(fe,{list:ce}={}){_e(fe||null),a(fe?{post:fe}:{});const Re=ce||l;if(n){const Ee=Re.find(Q=>Q.id===fe);B(Ee?I(Ee):Tf)}}function U(fe){A(fe),window.scrollTo({top:0,behavior:"smooth"})}function V(){B(Tf),_e(null),a({})}function P(fe){const ce=fe||$.status||"draft",Re=ce==="published"?$.publishedAt||za():null;return{title:$.title.trim(),summary:$.summary.trim(),body:$.body.trim(),cover:$.cover.trim(),tags:iA($.tags),status:ce,publishedAt:Re,updatedAt:za()}}async function C(fe="draft"){if(!(!n||y)){if(!$.title.trim()||!$.body.trim()){J("Title and body are required.");return}_(!0),J("");try{const ce=P(fe);let Re=$.id;$.id?await fs(bt(rt,"blogPosts",$.id),ce):Re=(await Oa(An(rt,"blogPosts"),{...ce,createdAt:za()})).id,J(fe==="published"?"Post published and visible to everyone.":"Draft saved."),await N(Re)}catch(ce){console.error("Failed to save blog post",ce),J("Could not save the post. Try again.")}finally{_(!1)}}}async function Y(fe){if(!(!n||!fe||T||!window.confirm("Delete this post? This cannot be undone."))){S(!0),J("");try{await Ma(bt(rt,"blogPosts",fe)),J("Post deleted."),await N(),V()}catch(Re){console.error("Failed to delete post",Re),J("Could not delete the post.")}finally{S(!1)}}}const ie=((O==null?void 0:O.body)||"").split(/\n{2,}/).map((fe,ce)=>o.jsx("p",{className:"blog-body-paragraph",children:fe},ce));return t?o.jsx("div",{className:"page blog-page",children:o.jsx("div",{className:"blog-guard-card",children:"Checking access..."})}):e?n?o.jsxs("div",{className:"page blog-page",children:[o.jsxs("header",{className:"blog-hero",children:[o.jsx("div",{className:"blog-pill",children:n?"Admin workspace":"Latest updates"}),o.jsx("h1",{children:"Blog & Reviews"}),o.jsx("p",{children:"Share reviews for anime or manga you have read. Draft privately, publish when ready, and keep visitors in the loop with new releases."})]}),F&&o.jsx("div",{className:"blog-status",children:F}),o.jsxs("div",{className:"blog-shell",children:[o.jsxs("aside",{className:"blog-sidebar",children:[o.jsxs("div",{className:"blog-sidebar-header",children:[o.jsxs("div",{children:[o.jsx("div",{className:"blog-sidebar-label",children:"Posts"}),o.jsxs("div",{className:"blog-sidebar-count",children:[we.length," ",we.length===1?"entry":"entries"]})]}),n&&o.jsx("button",{type:"button",className:"blog-btn solid",onClick:V,children:"+ New draft"})]}),o.jsxs("div",{className:"blog-list",children:[f&&o.jsx("div",{className:"blog-muted",children:"Loading posts..."}),!f&&!we.length&&o.jsx("div",{className:"blog-muted",children:"No posts yet."}),we.map(fe=>o.jsxs("button",{className:"blog-list-item"+(se===fe.id?" active":""),onClick:()=>U(fe.id),children:[o.jsxs("div",{className:"blog-list-row",children:[o.jsx("span",{className:"blog-list-title",children:fe.title||"Untitled"}),o.jsx("span",{className:"blog-chip "+(fe.status==="published"?"success":"draft"),children:fe.status==="published"?"Published":"Draft"})]}),o.jsx("div",{className:"blog-list-sub",children:fe.status==="published"?`Published ${Cu(fe.publishedAt)}`:`Last touched ${Cu(fe.updatedAt)}`})]},fe.id))]})]}),o.jsxs("section",{className:"blog-main",children:[ae?o.jsxs("div",{className:"blog-guard-card",children:[o.jsx("h3",{children:"Under construction"}),o.jsx("p",{children:"This blog page is being built. Once posts are published, they will appear here. Admins can already create and publish posts."})]}):O?o.jsxs("article",{className:"blog-article",children:[o.jsxs("div",{className:"blog-article-meta",children:[o.jsx("span",{className:"blog-chip "+(O.status==="published"?"success":"draft"),children:O.status==="published"?"Published":"Draft"}),o.jsx("span",{className:"blog-meta-text",children:O.status==="published"?`Published ${Cu(O.publishedAt)}`:`Last saved ${Cu(O.updatedAt)}`})]}),o.jsx("h2",{className:"blog-article-title",children:O.title||"Untitled"}),O.summary&&o.jsx("p",{className:"blog-article-summary",children:O.summary}),O.cover&&o.jsx("div",{className:"blog-cover",children:o.jsx("img",{src:O.cover,alt:""})}),o.jsx("div",{className:"blog-body",children:ie}),(Ce=O.tags)!=null&&Ce.length?o.jsx("div",{className:"blog-tag-row",children:O.tags.map(fe=>o.jsx("span",{className:"blog-chip ghost",children:fe},fe))}):null]}):o.jsxs("div",{className:"blog-guard-card",children:[o.jsx("h3",{children:"No post selected"}),o.jsx("p",{children:"Select a post from the left to read it."})]}),n&&o.jsxs("div",{className:"blog-editor-card",children:[o.jsxs("div",{className:"blog-editor-header",children:[o.jsxs("div",{children:[o.jsx("div",{className:"blog-sidebar-label",children:$.id?"Edit post":"New draft"}),o.jsx("div",{className:"blog-sidebar-count",children:$.id?"Update and publish when ready":"Fill in the details to create"})]}),$.id&&o.jsx("button",{type:"button",className:"blog-btn danger",onClick:()=>Y($.id),disabled:T,children:T?"Deleting...":"Delete"})]}),o.jsxs("div",{className:"blog-form",children:[o.jsxs("label",{className:"blog-field",children:[o.jsx("span",{children:"Title"}),o.jsx("input",{type:"text",value:$.title,onChange:fe=>B(ce=>({...ce,title:fe.target.value})),placeholder:"e.g., Chainsaw Man Volume 14 Review"})]}),o.jsxs("label",{className:"blog-field",children:[o.jsx("span",{children:"Summary"}),o.jsx("input",{type:"text",value:$.summary,onChange:fe=>B(ce=>({...ce,summary:fe.target.value})),placeholder:"One-liner that appears in previews"})]}),o.jsxs("label",{className:"blog-field",children:[o.jsx("span",{children:"Cover image URL (optional)"}),o.jsx("input",{type:"url",value:$.cover,onChange:fe=>B(ce=>({...ce,cover:fe.target.value})),placeholder:"https://..."})]}),o.jsxs("label",{className:"blog-field",children:[o.jsx("span",{children:"Tags (comma separated)"}),o.jsx("input",{type:"text",value:$.tags,onChange:fe=>B(ce=>({...ce,tags:fe.target.value})),placeholder:"anime, manga, review"})]}),o.jsxs("label",{className:"blog-field",children:[o.jsx("span",{children:"Body"}),o.jsx("textarea",{rows:8,value:$.body,onChange:fe=>B(ce=>({...ce,body:fe.target.value})),placeholder:"Write your review here. Separate paragraphs with blank lines."})]}),o.jsxs("div",{className:"blog-actions",children:[o.jsx("button",{type:"button",className:"blog-btn",onClick:()=>C("draft"),disabled:y,children:y?"Saving...":"Save draft"}),o.jsx("button",{type:"button",className:"blog-btn solid",onClick:()=>C("published"),disabled:y,children:y?"Publishing...":"Publish"}),$.status==="published"&&o.jsx("button",{type:"button",className:"blog-btn ghost",onClick:()=>C("draft"),disabled:y,children:"Move to draft"})]})]})]})]})]})]}):o.jsx(bf,{to:"/home",replace:!0}):o.jsx(bf,{to:"/signin",replace:!0})}function oA(){return o.jsxs(XP,{children:[o.jsx(sR,{}),o.jsxs(I1,{children:[o.jsx(hs,{path:"/",element:o.jsx(m_,{})}),o.jsx(hs,{path:"/home",element:o.jsx(m_,{})}),o.jsx(hs,{path:"/manga",element:o.jsx(yR,{})}),o.jsx(hs,{path:"/anime",element:o.jsx(NR,{})}),o.jsx(hs,{path:"/tcg",element:o.jsx(RR,{})}),o.jsx(hs,{path:"/music",element:o.jsx(XR,{})}),o.jsx(hs,{path:"/blog",element:o.jsx(aA,{})}),o.jsx(hs,{path:"/dashboard",element:o.jsx(JR,{})}),o.jsx(hs,{path:"/signin",element:o.jsx(ZR,{})}),o.jsx(hs,{path:"/steam",element:o.jsx(rA,{})}),o.jsx(hs,{path:"*",element:o.jsx(bf,{to:"/home",replace:!0})})]})]})}VE.createRoot(document.getElementById("root")).render(o.jsx(ap.StrictMode,{children:o.jsx(V1,{basename:"/base",children:o.jsx(oA,{})})}));export{o as j,j as r};
