function xE(n,e){for(var t=0;t<e.length;t++){const s=e[t];if(typeof s!="string"&&!Array.isArray(s)){for(const a in s)if(a!=="default"&&!(a in n)){const l=Object.getOwnPropertyDescriptor(s,a);l&&Object.defineProperty(n,a,l.get?l:{enumerable:!0,get:()=>s[a]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const d of l.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&s(d)}).observe(document,{childList:!0,subtree:!0});function t(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(a){if(a.ep)return;a.ep=!0;const l=t(a);fetch(a.href,l)}})();function Zf(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Zh={exports:{}},Cl={},ef={exports:{}},mt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fy;function EE(){if(fy)return mt;fy=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),d=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),v=Symbol.for("react.memo"),w=Symbol.for("react.lazy"),T=Symbol.iterator;function I(Y){return Y===null||typeof Y!="object"?null:(Y=T&&Y[T]||Y["@@iterator"],typeof Y=="function"?Y:null)}var U={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},X=Object.assign,$={};function O(Y,k,q){this.props=Y,this.context=k,this.refs=$,this.updater=q||U}O.prototype.isReactComponent={},O.prototype.setState=function(Y,k){if(typeof Y!="object"&&typeof Y!="function"&&Y!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Y,k,"setState")},O.prototype.forceUpdate=function(Y){this.updater.enqueueForceUpdate(this,Y,"forceUpdate")};function se(){}se.prototype=O.prototype;function Te(Y,k,q){this.props=Y,this.context=k,this.refs=$,this.updater=q||U}var xe=Te.prototype=new se;xe.constructor=Te,X(xe,O.prototype),xe.isPureReactComponent=!0;var _e=Array.isArray,V=Object.prototype.hasOwnProperty,ie={current:null},C={key:!0,ref:!0,__self:!0,__source:!0};function P(Y,k,q){var Ee,Le={},De=null,Fe=null;if(k!=null)for(Ee in k.ref!==void 0&&(Fe=k.ref),k.key!==void 0&&(De=""+k.key),k)V.call(k,Ee)&&!C.hasOwnProperty(Ee)&&(Le[Ee]=k[Ee]);var Qe=arguments.length-2;if(Qe===1)Le.children=q;else if(1<Qe){for(var st=Array(Qe),ye=0;ye<Qe;ye++)st[ye]=arguments[ye+2];Le.children=st}if(Y&&Y.defaultProps)for(Ee in Qe=Y.defaultProps,Qe)Le[Ee]===void 0&&(Le[Ee]=Qe[Ee]);return{$$typeof:n,type:Y,key:De,ref:Fe,props:Le,_owner:ie.current}}function A(Y,k){return{$$typeof:n,type:Y.type,key:k,ref:Y.ref,props:Y.props,_owner:Y._owner}}function M(Y){return typeof Y=="object"&&Y!==null&&Y.$$typeof===n}function D(Y){var k={"=":"=0",":":"=2"};return"$"+Y.replace(/[=:]/g,function(q){return k[q]})}var N=/\/+/g;function b(Y,k){return typeof Y=="object"&&Y!==null&&Y.key!=null?D(""+Y.key):k.toString(36)}function J(Y,k,q,Ee,Le){var De=typeof Y;(De==="undefined"||De==="boolean")&&(Y=null);var Fe=!1;if(Y===null)Fe=!0;else switch(De){case"string":case"number":Fe=!0;break;case"object":switch(Y.$$typeof){case n:case e:Fe=!0}}if(Fe)return Fe=Y,Le=Le(Fe),Y=Ee===""?"."+b(Fe,0):Ee,_e(Le)?(q="",Y!=null&&(q=Y.replace(N,"$&/")+"/"),J(Le,k,q,"",function(ye){return ye})):Le!=null&&(M(Le)&&(Le=A(Le,q+(!Le.key||Fe&&Fe.key===Le.key?"":(""+Le.key).replace(N,"$&/")+"/")+Y)),k.push(Le)),1;if(Fe=0,Ee=Ee===""?".":Ee+":",_e(Y))for(var Qe=0;Qe<Y.length;Qe++){De=Y[Qe];var st=Ee+b(De,Qe);Fe+=J(De,k,q,st,Le)}else if(st=I(Y),typeof st=="function")for(Y=st.call(Y),Qe=0;!(De=Y.next()).done;)De=De.value,st=Ee+b(De,Qe++),Fe+=J(De,k,q,st,Le);else if(De==="object")throw k=String(Y),Error("Objects are not valid as a React child (found: "+(k==="[object Object]"?"object with keys {"+Object.keys(Y).join(", ")+"}":k)+"). If you meant to render a collection of children, use an array instead.");return Fe}function ne(Y,k,q){if(Y==null)return Y;var Ee=[],Le=0;return J(Y,Ee,"","",function(De){return k.call(q,De,Le++)}),Ee}function Re(Y){if(Y._status===-1){var k=Y._result;k=k(),k.then(function(q){(Y._status===0||Y._status===-1)&&(Y._status=1,Y._result=q)},function(q){(Y._status===0||Y._status===-1)&&(Y._status=2,Y._result=q)}),Y._status===-1&&(Y._status=0,Y._result=k)}if(Y._status===1)return Y._result.default;throw Y._result}var he={current:null},le={transition:null},Ie={ReactCurrentDispatcher:he,ReactCurrentBatchConfig:le,ReactCurrentOwner:ie};function ve(){throw Error("act(...) is not supported in production builds of React.")}return mt.Children={map:ne,forEach:function(Y,k,q){ne(Y,function(){k.apply(this,arguments)},q)},count:function(Y){var k=0;return ne(Y,function(){k++}),k},toArray:function(Y){return ne(Y,function(k){return k})||[]},only:function(Y){if(!M(Y))throw Error("React.Children.only expected to receive a single React element child.");return Y}},mt.Component=O,mt.Fragment=t,mt.Profiler=a,mt.PureComponent=Te,mt.StrictMode=s,mt.Suspense=m,mt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ie,mt.act=ve,mt.cloneElement=function(Y,k,q){if(Y==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+Y+".");var Ee=X({},Y.props),Le=Y.key,De=Y.ref,Fe=Y._owner;if(k!=null){if(k.ref!==void 0&&(De=k.ref,Fe=ie.current),k.key!==void 0&&(Le=""+k.key),Y.type&&Y.type.defaultProps)var Qe=Y.type.defaultProps;for(st in k)V.call(k,st)&&!C.hasOwnProperty(st)&&(Ee[st]=k[st]===void 0&&Qe!==void 0?Qe[st]:k[st])}var st=arguments.length-2;if(st===1)Ee.children=q;else if(1<st){Qe=Array(st);for(var ye=0;ye<st;ye++)Qe[ye]=arguments[ye+2];Ee.children=Qe}return{$$typeof:n,type:Y.type,key:Le,ref:De,props:Ee,_owner:Fe}},mt.createContext=function(Y){return Y={$$typeof:d,_currentValue:Y,_currentValue2:Y,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},Y.Provider={$$typeof:l,_context:Y},Y.Consumer=Y},mt.createElement=P,mt.createFactory=function(Y){var k=P.bind(null,Y);return k.type=Y,k},mt.createRef=function(){return{current:null}},mt.forwardRef=function(Y){return{$$typeof:f,render:Y}},mt.isValidElement=M,mt.lazy=function(Y){return{$$typeof:w,_payload:{_status:-1,_result:Y},_init:Re}},mt.memo=function(Y,k){return{$$typeof:v,type:Y,compare:k===void 0?null:k}},mt.startTransition=function(Y){var k=le.transition;le.transition={};try{Y()}finally{le.transition=k}},mt.unstable_act=ve,mt.useCallback=function(Y,k){return he.current.useCallback(Y,k)},mt.useContext=function(Y){return he.current.useContext(Y)},mt.useDebugValue=function(){},mt.useDeferredValue=function(Y){return he.current.useDeferredValue(Y)},mt.useEffect=function(Y,k){return he.current.useEffect(Y,k)},mt.useId=function(){return he.current.useId()},mt.useImperativeHandle=function(Y,k,q){return he.current.useImperativeHandle(Y,k,q)},mt.useInsertionEffect=function(Y,k){return he.current.useInsertionEffect(Y,k)},mt.useLayoutEffect=function(Y,k){return he.current.useLayoutEffect(Y,k)},mt.useMemo=function(Y,k){return he.current.useMemo(Y,k)},mt.useReducer=function(Y,k,q){return he.current.useReducer(Y,k,q)},mt.useRef=function(Y){return he.current.useRef(Y)},mt.useState=function(Y){return he.current.useState(Y)},mt.useSyncExternalStore=function(Y,k,q){return he.current.useSyncExternalStore(Y,k,q)},mt.useTransition=function(){return he.current.useTransition()},mt.version="18.3.1",mt}var py;function ep(){return py||(py=1,ef.exports=EE()),ef.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var my;function TE(){if(my)return Cl;my=1;var n=ep(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,a=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function d(f,m,v){var w,T={},I=null,U=null;v!==void 0&&(I=""+v),m.key!==void 0&&(I=""+m.key),m.ref!==void 0&&(U=m.ref);for(w in m)s.call(m,w)&&!l.hasOwnProperty(w)&&(T[w]=m[w]);if(f&&f.defaultProps)for(w in m=f.defaultProps,m)T[w]===void 0&&(T[w]=m[w]);return{$$typeof:e,type:f,key:I,ref:U,props:T,_owner:a.current}}return Cl.Fragment=t,Cl.jsx=d,Cl.jsxs=d,Cl}var gy;function SE(){return gy||(gy=1,Zh.exports=TE()),Zh.exports}var o=SE(),j=ep();const tp=Zf(j),bE=xE({__proto__:null,default:tp},[j]);var mu={},tf={exports:{}},Er={},nf={exports:{}},rf={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yy;function CE(){return yy||(yy=1,(function(n){function e(le,Ie){var ve=le.length;le.push(Ie);e:for(;0<ve;){var Y=ve-1>>>1,k=le[Y];if(0<a(k,Ie))le[Y]=Ie,le[ve]=k,ve=Y;else break e}}function t(le){return le.length===0?null:le[0]}function s(le){if(le.length===0)return null;var Ie=le[0],ve=le.pop();if(ve!==Ie){le[0]=ve;e:for(var Y=0,k=le.length,q=k>>>1;Y<q;){var Ee=2*(Y+1)-1,Le=le[Ee],De=Ee+1,Fe=le[De];if(0>a(Le,ve))De<k&&0>a(Fe,Le)?(le[Y]=Fe,le[De]=ve,Y=De):(le[Y]=Le,le[Ee]=ve,Y=Ee);else if(De<k&&0>a(Fe,ve))le[Y]=Fe,le[De]=ve,Y=De;else break e}}return Ie}function a(le,Ie){var ve=le.sortIndex-Ie.sortIndex;return ve!==0?ve:le.id-Ie.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;n.unstable_now=function(){return l.now()}}else{var d=Date,f=d.now();n.unstable_now=function(){return d.now()-f}}var m=[],v=[],w=1,T=null,I=3,U=!1,X=!1,$=!1,O=typeof setTimeout=="function"?setTimeout:null,se=typeof clearTimeout=="function"?clearTimeout:null,Te=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function xe(le){for(var Ie=t(v);Ie!==null;){if(Ie.callback===null)s(v);else if(Ie.startTime<=le)s(v),Ie.sortIndex=Ie.expirationTime,e(m,Ie);else break;Ie=t(v)}}function _e(le){if($=!1,xe(le),!X)if(t(m)!==null)X=!0,Re(V);else{var Ie=t(v);Ie!==null&&he(_e,Ie.startTime-le)}}function V(le,Ie){X=!1,$&&($=!1,se(P),P=-1),U=!0;var ve=I;try{for(xe(Ie),T=t(m);T!==null&&(!(T.expirationTime>Ie)||le&&!D());){var Y=T.callback;if(typeof Y=="function"){T.callback=null,I=T.priorityLevel;var k=Y(T.expirationTime<=Ie);Ie=n.unstable_now(),typeof k=="function"?T.callback=k:T===t(m)&&s(m),xe(Ie)}else s(m);T=t(m)}if(T!==null)var q=!0;else{var Ee=t(v);Ee!==null&&he(_e,Ee.startTime-Ie),q=!1}return q}finally{T=null,I=ve,U=!1}}var ie=!1,C=null,P=-1,A=5,M=-1;function D(){return!(n.unstable_now()-M<A)}function N(){if(C!==null){var le=n.unstable_now();M=le;var Ie=!0;try{Ie=C(!0,le)}finally{Ie?b():(ie=!1,C=null)}}else ie=!1}var b;if(typeof Te=="function")b=function(){Te(N)};else if(typeof MessageChannel<"u"){var J=new MessageChannel,ne=J.port2;J.port1.onmessage=N,b=function(){ne.postMessage(null)}}else b=function(){O(N,0)};function Re(le){C=le,ie||(ie=!0,b())}function he(le,Ie){P=O(function(){le(n.unstable_now())},Ie)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(le){le.callback=null},n.unstable_continueExecution=function(){X||U||(X=!0,Re(V))},n.unstable_forceFrameRate=function(le){0>le||125<le?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<le?Math.floor(1e3/le):5},n.unstable_getCurrentPriorityLevel=function(){return I},n.unstable_getFirstCallbackNode=function(){return t(m)},n.unstable_next=function(le){switch(I){case 1:case 2:case 3:var Ie=3;break;default:Ie=I}var ve=I;I=Ie;try{return le()}finally{I=ve}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(le,Ie){switch(le){case 1:case 2:case 3:case 4:case 5:break;default:le=3}var ve=I;I=le;try{return Ie()}finally{I=ve}},n.unstable_scheduleCallback=function(le,Ie,ve){var Y=n.unstable_now();switch(typeof ve=="object"&&ve!==null?(ve=ve.delay,ve=typeof ve=="number"&&0<ve?Y+ve:Y):ve=Y,le){case 1:var k=-1;break;case 2:k=250;break;case 5:k=1073741823;break;case 4:k=1e4;break;default:k=5e3}return k=ve+k,le={id:w++,callback:Ie,priorityLevel:le,startTime:ve,expirationTime:k,sortIndex:-1},ve>Y?(le.sortIndex=ve,e(v,le),t(m)===null&&le===t(v)&&($?(se(P),P=-1):$=!0,he(_e,ve-Y))):(le.sortIndex=k,e(m,le),X||U||(X=!0,Re(V))),le},n.unstable_shouldYield=D,n.unstable_wrapCallback=function(le){var Ie=I;return function(){var ve=I;I=Ie;try{return le.apply(this,arguments)}finally{I=ve}}}})(rf)),rf}var vy;function IE(){return vy||(vy=1,nf.exports=CE()),nf.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _y;function PE(){if(_y)return Er;_y=1;var n=ep(),e=IE();function t(r){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+r,c=1;c<arguments.length;c++)i+="&args[]="+encodeURIComponent(arguments[c]);return"Minified React error #"+r+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,a={};function l(r,i){d(r,i),d(r+"Capture",i)}function d(r,i){for(a[r]=i,r=0;r<i.length;r++)s.add(i[r])}var f=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),m=Object.prototype.hasOwnProperty,v=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,w={},T={};function I(r){return m.call(T,r)?!0:m.call(w,r)?!1:v.test(r)?T[r]=!0:(w[r]=!0,!1)}function U(r,i,c,h){if(c!==null&&c.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return h?!1:c!==null?!c.acceptsBooleans:(r=r.toLowerCase().slice(0,5),r!=="data-"&&r!=="aria-");default:return!1}}function X(r,i,c,h){if(i===null||typeof i>"u"||U(r,i,c,h))return!0;if(h)return!1;if(c!==null)switch(c.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function $(r,i,c,h,p,y,E){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=h,this.attributeNamespace=p,this.mustUseProperty=c,this.propertyName=r,this.type=i,this.sanitizeURL=y,this.removeEmptyString=E}var O={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(r){O[r]=new $(r,0,!1,r,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(r){var i=r[0];O[i]=new $(i,1,!1,r[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(r){O[r]=new $(r,2,!1,r.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(r){O[r]=new $(r,2,!1,r,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(r){O[r]=new $(r,3,!1,r.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(r){O[r]=new $(r,3,!0,r,null,!1,!1)}),["capture","download"].forEach(function(r){O[r]=new $(r,4,!1,r,null,!1,!1)}),["cols","rows","size","span"].forEach(function(r){O[r]=new $(r,6,!1,r,null,!1,!1)}),["rowSpan","start"].forEach(function(r){O[r]=new $(r,5,!1,r.toLowerCase(),null,!1,!1)});var se=/[\-:]([a-z])/g;function Te(r){return r[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(r){var i=r.replace(se,Te);O[i]=new $(i,1,!1,r,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(r){var i=r.replace(se,Te);O[i]=new $(i,1,!1,r,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(r){var i=r.replace(se,Te);O[i]=new $(i,1,!1,r,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(r){O[r]=new $(r,1,!1,r.toLowerCase(),null,!1,!1)}),O.xlinkHref=new $("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(r){O[r]=new $(r,1,!1,r.toLowerCase(),null,!0,!0)});function xe(r,i,c,h){var p=O.hasOwnProperty(i)?O[i]:null;(p!==null?p.type!==0:h||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(X(i,c,p,h)&&(c=null),h||p===null?I(i)&&(c===null?r.removeAttribute(i):r.setAttribute(i,""+c)):p.mustUseProperty?r[p.propertyName]=c===null?p.type===3?!1:"":c:(i=p.attributeName,h=p.attributeNamespace,c===null?r.removeAttribute(i):(p=p.type,c=p===3||p===4&&c===!0?"":""+c,h?r.setAttributeNS(h,i,c):r.setAttribute(i,c))))}var _e=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,V=Symbol.for("react.element"),ie=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),P=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),M=Symbol.for("react.provider"),D=Symbol.for("react.context"),N=Symbol.for("react.forward_ref"),b=Symbol.for("react.suspense"),J=Symbol.for("react.suspense_list"),ne=Symbol.for("react.memo"),Re=Symbol.for("react.lazy"),he=Symbol.for("react.offscreen"),le=Symbol.iterator;function Ie(r){return r===null||typeof r!="object"?null:(r=le&&r[le]||r["@@iterator"],typeof r=="function"?r:null)}var ve=Object.assign,Y;function k(r){if(Y===void 0)try{throw Error()}catch(c){var i=c.stack.trim().match(/\n( *(at )?)/);Y=i&&i[1]||""}return`
`+Y+r}var q=!1;function Ee(r,i){if(!r||q)return"";q=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(re){var h=re}Reflect.construct(r,[],i)}else{try{i.call()}catch(re){h=re}r.call(i.prototype)}else{try{throw Error()}catch(re){h=re}r()}}catch(re){if(re&&h&&typeof re.stack=="string"){for(var p=re.stack.split(`
`),y=h.stack.split(`
`),E=p.length-1,L=y.length-1;1<=E&&0<=L&&p[E]!==y[L];)L--;for(;1<=E&&0<=L;E--,L--)if(p[E]!==y[L]){if(E!==1||L!==1)do if(E--,L--,0>L||p[E]!==y[L]){var B=`
`+p[E].replace(" at new "," at ");return r.displayName&&B.includes("<anonymous>")&&(B=B.replace("<anonymous>",r.displayName)),B}while(1<=E&&0<=L);break}}}finally{q=!1,Error.prepareStackTrace=c}return(r=r?r.displayName||r.name:"")?k(r):""}function Le(r){switch(r.tag){case 5:return k(r.type);case 16:return k("Lazy");case 13:return k("Suspense");case 19:return k("SuspenseList");case 0:case 2:case 15:return r=Ee(r.type,!1),r;case 11:return r=Ee(r.type.render,!1),r;case 1:return r=Ee(r.type,!0),r;default:return""}}function De(r){if(r==null)return null;if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case C:return"Fragment";case ie:return"Portal";case A:return"Profiler";case P:return"StrictMode";case b:return"Suspense";case J:return"SuspenseList"}if(typeof r=="object")switch(r.$$typeof){case D:return(r.displayName||"Context")+".Consumer";case M:return(r._context.displayName||"Context")+".Provider";case N:var i=r.render;return r=r.displayName,r||(r=i.displayName||i.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case ne:return i=r.displayName||null,i!==null?i:De(r.type)||"Memo";case Re:i=r._payload,r=r._init;try{return De(r(i))}catch{}}return null}function Fe(r){var i=r.type;switch(r.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return r=i.render,r=r.displayName||r.name||"",i.displayName||(r!==""?"ForwardRef("+r+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return De(i);case 8:return i===P?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function Qe(r){switch(typeof r){case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function st(r){var i=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function ye(r){var i=st(r)?"checked":"value",c=Object.getOwnPropertyDescriptor(r.constructor.prototype,i),h=""+r[i];if(!r.hasOwnProperty(i)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var p=c.get,y=c.set;return Object.defineProperty(r,i,{configurable:!0,get:function(){return p.call(this)},set:function(E){h=""+E,y.call(this,E)}}),Object.defineProperty(r,i,{enumerable:c.enumerable}),{getValue:function(){return h},setValue:function(E){h=""+E},stopTracking:function(){r._valueTracker=null,delete r[i]}}}}function ce(r){r._valueTracker||(r._valueTracker=ye(r))}function Me(r){if(!r)return!1;var i=r._valueTracker;if(!i)return!0;var c=i.getValue(),h="";return r&&(h=st(r)?r.checked?"true":"false":r.value),r=h,r!==c?(i.setValue(r),!0):!1}function me(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}function He(r,i){var c=i.checked;return ve({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:c??r._wrapperState.initialChecked})}function Ye(r,i){var c=i.defaultValue==null?"":i.defaultValue,h=i.checked!=null?i.checked:i.defaultChecked;c=Qe(i.value!=null?i.value:c),r._wrapperState={initialChecked:h,initialValue:c,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function Tt(r,i){i=i.checked,i!=null&&xe(r,"checked",i,!1)}function Ct(r,i){Tt(r,i);var c=Qe(i.value),h=i.type;if(c!=null)h==="number"?(c===0&&r.value===""||r.value!=c)&&(r.value=""+c):r.value!==""+c&&(r.value=""+c);else if(h==="submit"||h==="reset"){r.removeAttribute("value");return}i.hasOwnProperty("value")?Nt(r,i.type,c):i.hasOwnProperty("defaultValue")&&Nt(r,i.type,Qe(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(r.defaultChecked=!!i.defaultChecked)}function gt(r,i,c){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var h=i.type;if(!(h!=="submit"&&h!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+r._wrapperState.initialValue,c||i===r.value||(r.value=i),r.defaultValue=i}c=r.name,c!==""&&(r.name=""),r.defaultChecked=!!r._wrapperState.initialChecked,c!==""&&(r.name=c)}function Nt(r,i,c){(i!=="number"||me(r.ownerDocument)!==r)&&(c==null?r.defaultValue=""+r._wrapperState.initialValue:r.defaultValue!==""+c&&(r.defaultValue=""+c))}var Qt=Array.isArray;function tn(r,i,c,h){if(r=r.options,i){i={};for(var p=0;p<c.length;p++)i["$"+c[p]]=!0;for(c=0;c<r.length;c++)p=i.hasOwnProperty("$"+r[c].value),r[c].selected!==p&&(r[c].selected=p),p&&h&&(r[c].defaultSelected=!0)}else{for(c=""+Qe(c),i=null,p=0;p<r.length;p++){if(r[p].value===c){r[p].selected=!0,h&&(r[p].defaultSelected=!0);return}i!==null||r[p].disabled||(i=r[p])}i!==null&&(i.selected=!0)}}function nn(r,i){if(i.dangerouslySetInnerHTML!=null)throw Error(t(91));return ve({},i,{value:void 0,defaultValue:void 0,children:""+r._wrapperState.initialValue})}function lr(r,i){var c=i.value;if(c==null){if(c=i.children,i=i.defaultValue,c!=null){if(i!=null)throw Error(t(92));if(Qt(c)){if(1<c.length)throw Error(t(93));c=c[0]}i=c}i==null&&(i=""),c=i}r._wrapperState={initialValue:Qe(c)}}function rn(r,i){var c=Qe(i.value),h=Qe(i.defaultValue);c!=null&&(c=""+c,c!==r.value&&(r.value=c),i.defaultValue==null&&r.defaultValue!==c&&(r.defaultValue=c)),h!=null&&(r.defaultValue=""+h)}function Kn(r){var i=r.textContent;i===r._wrapperState.initialValue&&i!==""&&i!==null&&(r.value=i)}function Ot(r){switch(r){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function $t(r,i){return r==null||r==="http://www.w3.org/1999/xhtml"?Ot(i):r==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":r}var On,cr=(function(r){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,c,h,p){MSApp.execUnsafeLocalFunction(function(){return r(i,c,h,p)})}:r})(function(r,i){if(r.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in r)r.innerHTML=i;else{for(On=On||document.createElement("div"),On.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=On.firstChild;r.firstChild;)r.removeChild(r.firstChild);for(;i.firstChild;)r.appendChild(i.firstChild)}});function Cn(r,i){if(i){var c=r.firstChild;if(c&&c===r.lastChild&&c.nodeType===3){c.nodeValue=i;return}}r.textContent=i}var Fn={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Yt=["Webkit","ms","Moz","O"];Object.keys(Fn).forEach(function(r){Yt.forEach(function(i){i=i+r.charAt(0).toUpperCase()+r.substring(1),Fn[i]=Fn[r]})});function es(r,i,c){return i==null||typeof i=="boolean"||i===""?"":c||typeof i!="number"||i===0||Fn.hasOwnProperty(r)&&Fn[r]?(""+i).trim():i+"px"}function In(r,i){r=r.style;for(var c in i)if(i.hasOwnProperty(c)){var h=c.indexOf("--")===0,p=es(c,i[c],h);c==="float"&&(c="cssFloat"),h?r.setProperty(c,p):r[c]=p}}var gn=ve({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ts(r,i){if(i){if(gn[r]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(t(137,r));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(t(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(t(61))}if(i.style!=null&&typeof i.style!="object")throw Error(t(62))}}function Ts(r,i){if(r.indexOf("-")===-1)return typeof i.is=="string";switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Pt=null;function pr(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Ss=null,Qn=null,Yn=null;function Ir(r){if(r=dl(r)){if(typeof Ss!="function")throw Error(t(280));var i=r.stateNode;i&&(i=Rc(i),Ss(r.stateNode,r.type,i))}}function Pn(r){Qn?Yn?Yn.push(r):Yn=[r]:Qn=r}function Pr(){if(Qn){var r=Qn,i=Yn;if(Yn=Qn=null,Ir(r),i)for(r=0;r<i.length;r++)Ir(i[r])}}function Jn(r,i){return r(i)}function Ws(){}var mr=!1;function Gs(r,i,c){if(mr)return r(i,c);mr=!0;try{return Jn(r,i,c)}finally{mr=!1,(Qn!==null||Yn!==null)&&(Ws(),Pr())}}function rt(r,i){var c=r.stateNode;if(c===null)return null;var h=Rc(c);if(h===null)return null;c=h[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(r=r.type,h=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!h;break e;default:r=!1}if(r)return null;if(c&&typeof c!="function")throw Error(t(231,i,typeof c));return c}var Xn=!1;if(f)try{var Nn={};Object.defineProperty(Nn,"passive",{get:function(){Xn=!0}}),window.addEventListener("test",Nn,Nn),window.removeEventListener("test",Nn,Nn)}catch{Xn=!1}function ns(r,i,c,h,p,y,E,L,B){var re=Array.prototype.slice.call(arguments,3);try{i.apply(c,re)}catch(Se){this.onError(Se)}}var Rn=!1,yn=null,An=!1,bs=null,Cs={onError:function(r){Rn=!0,yn=r}};function Un(r,i,c,h,p,y,E,L,B){Rn=!1,yn=null,ns.apply(Cs,arguments)}function Fr(r,i,c,h,p,y,E,L,B){if(Un.apply(this,arguments),Rn){if(Rn){var re=yn;Rn=!1,yn=null}else throw Error(t(198));An||(An=!0,bs=re)}}function Ft(r){var i=r,c=r;if(r.alternate)for(;i.return;)i=i.return;else{r=i;do i=r,(i.flags&4098)!==0&&(c=i.return),r=i.return;while(r)}return i.tag===3?c:null}function rs(r){if(r.tag===13){var i=r.memoizedState;if(i===null&&(r=r.alternate,r!==null&&(i=r.memoizedState)),i!==null)return i.dehydrated}return null}function un(r){if(Ft(r)!==r)throw Error(t(188))}function Nr(r){var i=r.alternate;if(!i){if(i=Ft(r),i===null)throw Error(t(188));return i!==r?null:r}for(var c=r,h=i;;){var p=c.return;if(p===null)break;var y=p.alternate;if(y===null){if(h=p.return,h!==null){c=h;continue}break}if(p.child===y.child){for(y=p.child;y;){if(y===c)return un(p),r;if(y===h)return un(p),i;y=y.sibling}throw Error(t(188))}if(c.return!==h.return)c=p,h=y;else{for(var E=!1,L=p.child;L;){if(L===c){E=!0,c=p,h=y;break}if(L===h){E=!0,h=p,c=y;break}L=L.sibling}if(!E){for(L=y.child;L;){if(L===c){E=!0,c=y,h=p;break}if(L===h){E=!0,h=y,c=p;break}L=L.sibling}if(!E)throw Error(t(189))}}if(c.alternate!==h)throw Error(t(190))}if(c.tag!==3)throw Error(t(188));return c.stateNode.current===c?r:i}function qs(r){return r=Nr(r),r!==null?Ur(r):null}function Ur(r){if(r.tag===5||r.tag===6)return r;for(r=r.child;r!==null;){var i=Ur(r);if(i!==null)return i;r=r.sibling}return null}var ss=e.unstable_scheduleCallback,vn=e.unstable_cancelCallback,Hs=e.unstable_shouldYield,Ks=e.unstable_requestPaint,ht=e.unstable_now,is=e.unstable_getCurrentPriorityLevel,jn=e.unstable_ImmediatePriority,x=e.unstable_UserBlockingPriority,W=e.unstable_NormalPriority,G=e.unstable_LowPriority,F=e.unstable_IdlePriority,H=null,ue=null;function oe(r){if(ue&&typeof ue.onCommitFiberRoot=="function")try{ue.onCommitFiberRoot(H,r,void 0,(r.current.flags&128)===128)}catch{}}var Ae=Math.clz32?Math.clz32:de,Pe=Math.log,Oe=Math.LN2;function de(r){return r>>>=0,r===0?32:31-(Pe(r)/Oe|0)|0}var Ze=64,je=4194304;function ut(r){switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return r&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return r}}function ur(r,i){var c=r.pendingLanes;if(c===0)return 0;var h=0,p=r.suspendedLanes,y=r.pingedLanes,E=c&268435455;if(E!==0){var L=E&~p;L!==0?h=ut(L):(y&=E,y!==0&&(h=ut(y)))}else E=c&~p,E!==0?h=ut(E):y!==0&&(h=ut(y));if(h===0)return 0;if(i!==0&&i!==h&&(i&p)===0&&(p=h&-h,y=i&-i,p>=y||p===16&&(y&4194240)!==0))return i;if((h&4)!==0&&(h|=c&16),i=r.entangledLanes,i!==0)for(r=r.entanglements,i&=h;0<i;)c=31-Ae(i),p=1<<c,h|=r[c],i&=~p;return h}function Qs(r,i){switch(r){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _n(r,i){for(var c=r.suspendedLanes,h=r.pingedLanes,p=r.expirationTimes,y=r.pendingLanes;0<y;){var E=31-Ae(y),L=1<<E,B=p[E];B===-1?((L&c)===0||(L&h)!==0)&&(p[E]=Qs(L,i)):B<=i&&(r.expiredLanes|=L),y&=~L}}function Jt(r){return r=r.pendingLanes&-1073741825,r!==0?r:r&1073741824?1073741824:0}function as(){var r=Ze;return Ze<<=1,(Ze&4194240)===0&&(Ze=64),r}function os(r){for(var i=[],c=0;31>c;c++)i.push(r);return i}function ls(r,i,c){r.pendingLanes|=i,i!==536870912&&(r.suspendedLanes=0,r.pingedLanes=0),r=r.eventTimes,i=31-Ae(i),r[i]=c}function Rt(r,i){var c=r.pendingLanes&~i;r.pendingLanes=i,r.suspendedLanes=0,r.pingedLanes=0,r.expiredLanes&=i,r.mutableReadLanes&=i,r.entangledLanes&=i,i=r.entanglements;var h=r.eventTimes;for(r=r.expirationTimes;0<c;){var p=31-Ae(c),y=1<<p;i[p]=0,h[p]=-1,r[p]=-1,c&=~y}}function Is(r,i){var c=r.entangledLanes|=i;for(r=r.entanglements;c;){var h=31-Ae(c),p=1<<h;p&i|r[h]&i&&(r[h]|=i),c&=~p}}var pt=0;function Ps(r){return r&=-r,1<r?4<r?(r&268435455)!==0?16:536870912:4:1}var S,z,Q,fe,be,Ge=!1,Ne=[],Je=null,dt=null,yt=null,Lt=new Map,St=new Map,sn=[],wn="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function wt(r,i){switch(r){case"focusin":case"focusout":Je=null;break;case"dragenter":case"dragleave":dt=null;break;case"mouseover":case"mouseout":yt=null;break;case"pointerover":case"pointerout":Lt.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":St.delete(i.pointerId)}}function an(r,i,c,h,p,y){return r===null||r.nativeEvent!==y?(r={blockedOn:i,domEventName:c,eventSystemFlags:h,nativeEvent:y,targetContainers:[p]},i!==null&&(i=dl(i),i!==null&&z(i)),r):(r.eventSystemFlags|=h,i=r.targetContainers,p!==null&&i.indexOf(p)===-1&&i.push(p),r)}function Zn(r,i,c,h,p){switch(i){case"focusin":return Je=an(Je,r,i,c,h,p),!0;case"dragenter":return dt=an(dt,r,i,c,h,p),!0;case"mouseover":return yt=an(yt,r,i,c,h,p),!0;case"pointerover":var y=p.pointerId;return Lt.set(y,an(Lt.get(y)||null,r,i,c,h,p)),!0;case"gotpointercapture":return y=p.pointerId,St.set(y,an(St.get(y)||null,r,i,c,h,p)),!0}return!1}function zr(r){var i=fa(r.target);if(i!==null){var c=Ft(i);if(c!==null){if(i=c.tag,i===13){if(i=rs(c),i!==null){r.blockedOn=i,be(r.priority,function(){Q(c)});return}}else if(i===3&&c.stateNode.current.memoizedState.isDehydrated){r.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Rr(r){if(r.blockedOn!==null)return!1;for(var i=r.targetContainers;0<i.length;){var c=$a(r.domEventName,r.eventSystemFlags,i[0],r.nativeEvent);if(c===null){c=r.nativeEvent;var h=new c.constructor(c.type,c);Pt=h,c.target.dispatchEvent(h),Pt=null}else return i=dl(c),i!==null&&z(i),r.blockedOn=c,!1;i.shift()}return!0}function Ys(r,i,c){Rr(r)&&c.delete(i)}function Ba(){Ge=!1,Je!==null&&Rr(Je)&&(Je=null),dt!==null&&Rr(dt)&&(dt=null),yt!==null&&Rr(yt)&&(yt=null),Lt.forEach(Ys),St.forEach(Ys)}function Ar(r,i){r.blockedOn===i&&(r.blockedOn=null,Ge||(Ge=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Ba)))}function zn(r){function i(p){return Ar(p,r)}if(0<Ne.length){Ar(Ne[0],r);for(var c=1;c<Ne.length;c++){var h=Ne[c];h.blockedOn===r&&(h.blockedOn=null)}}for(Je!==null&&Ar(Je,r),dt!==null&&Ar(dt,r),yt!==null&&Ar(yt,r),Lt.forEach(i),St.forEach(i),c=0;c<sn.length;c++)h=sn[c],h.blockedOn===r&&(h.blockedOn=null);for(;0<sn.length&&(c=sn[0],c.blockedOn===null);)zr(c),c.blockedOn===null&&sn.shift()}var cs=_e.ReactCurrentBatchConfig,xi=!0;function Wt(r,i,c,h){var p=pt,y=cs.transition;cs.transition=null;try{pt=1,Jo(r,i,c,h)}finally{pt=p,cs.transition=y}}function jd(r,i,c,h){var p=pt,y=cs.transition;cs.transition=null;try{pt=4,Jo(r,i,c,h)}finally{pt=p,cs.transition=y}}function Jo(r,i,c,h){if(xi){var p=$a(r,i,c,h);if(p===null)$d(r,i,h,ua,c),wt(r,h);else if(Zn(p,r,i,c,h))h.stopPropagation();else if(wt(r,h),i&4&&-1<wn.indexOf(r)){for(;p!==null;){var y=dl(p);if(y!==null&&S(y),y=$a(r,i,c,h),y===null&&$d(r,i,h,ua,c),y===p)break;p=y}p!==null&&h.stopPropagation()}else $d(r,i,h,null,c)}}var ua=null;function $a(r,i,c,h){if(ua=null,r=pr(h),r=fa(r),r!==null)if(i=Ft(r),i===null)r=null;else if(c=i.tag,c===13){if(r=rs(i),r!==null)return r;r=null}else if(c===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;r=null}else i!==r&&(r=null);return ua=r,null}function Xo(r){switch(r){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(is()){case jn:return 1;case x:return 4;case W:case G:return 16;case F:return 536870912;default:return 16}default:return 16}}var jr=null,Wa=null,gr=null;function Zo(){if(gr)return gr;var r,i=Wa,c=i.length,h,p="value"in jr?jr.value:jr.textContent,y=p.length;for(r=0;r<c&&i[r]===p[r];r++);var E=c-r;for(h=1;h<=E&&i[c-h]===p[y-h];h++);return gr=p.slice(r,1<h?1-h:void 0)}function Ga(r){var i=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&i===13&&(r=13)):r=i,r===10&&(r=13),32<=r||r===13?r:0}function Ns(){return!0}function el(){return!1}function Bn(r){function i(c,h,p,y,E){this._reactName=c,this._targetInst=p,this.type=h,this.nativeEvent=y,this.target=E,this.currentTarget=null;for(var L in r)r.hasOwnProperty(L)&&(c=r[L],this[L]=c?c(y):y[L]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?Ns:el,this.isPropagationStopped=el,this}return ve(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=Ns)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=Ns)},persist:function(){},isPersistent:Ns}),i}var us={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},qa=Bn(us),Rs=ve({},us,{view:0,detail:0}),kd=Bn(Rs),Ha,Js,Ei,da=ve({},Rs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:As,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Ei&&(Ei&&r.type==="mousemove"?(Ha=r.screenX-Ei.screenX,Js=r.screenY-Ei.screenY):Js=Ha=0,Ei=r),Ha)},movementY:function(r){return"movementY"in r?r.movementY:Js}}),Ka=Bn(da),tl=ve({},da,{dataTransfer:0}),gc=Bn(tl),Qa=ve({},Rs,{relatedTarget:0}),Ya=Bn(Qa),yc=ve({},us,{animationName:0,elapsedTime:0,pseudoElement:0}),Xs=Bn(yc),vc=ve({},us,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),_c=Bn(vc),wc=ve({},us,{data:0}),nl=Bn(wc),Ja={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},dr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},xc={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ec(r){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(r):(r=xc[r])?!!i[r]:!1}function As(){return Ec}var u=ve({},Rs,{key:function(r){if(r.key){var i=Ja[r.key]||r.key;if(i!=="Unidentified")return i}return r.type==="keypress"?(r=Ga(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?dr[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:As,charCode:function(r){return r.type==="keypress"?Ga(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?Ga(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),g=Bn(u),_=ve({},da,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),R=Bn(_),Z=ve({},Rs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:As}),ae=Bn(Z),Ve=ve({},us,{propertyName:0,elapsedTime:0,pseudoElement:0}),jt=Bn(Ve),xn=ve({},da,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),xt=Bn(xn),kn=[9,13,27,32],dn=f&&"CompositionEvent"in window,Br=null;f&&"documentMode"in document&&(Br=document.documentMode);var kr=f&&"TextEvent"in window&&!Br,ha=f&&(!dn||Br&&8<Br&&11>=Br),Xa=" ",om=!1;function lm(r,i){switch(r){case"keyup":return kn.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function cm(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var Za=!1;function vx(r,i){switch(r){case"compositionend":return cm(i);case"keypress":return i.which!==32?null:(om=!0,Xa);case"textInput":return r=i.data,r===Xa&&om?null:r;default:return null}}function _x(r,i){if(Za)return r==="compositionend"||!dn&&lm(r,i)?(r=Zo(),gr=Wa=jr=null,Za=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return ha&&i.locale!=="ko"?null:i.data;default:return null}}var wx={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function um(r){var i=r&&r.nodeName&&r.nodeName.toLowerCase();return i==="input"?!!wx[r.type]:i==="textarea"}function dm(r,i,c,h){Pn(h),i=Ic(i,"onChange"),0<i.length&&(c=new qa("onChange","change",null,c,h),r.push({event:c,listeners:i}))}var rl=null,sl=null;function xx(r){Nm(r,0)}function Tc(r){var i=so(r);if(Me(i))return r}function Ex(r,i){if(r==="change")return i}var hm=!1;if(f){var Dd;if(f){var Ld="oninput"in document;if(!Ld){var fm=document.createElement("div");fm.setAttribute("oninput","return;"),Ld=typeof fm.oninput=="function"}Dd=Ld}else Dd=!1;hm=Dd&&(!document.documentMode||9<document.documentMode)}function pm(){rl&&(rl.detachEvent("onpropertychange",mm),sl=rl=null)}function mm(r){if(r.propertyName==="value"&&Tc(sl)){var i=[];dm(i,sl,r,pr(r)),Gs(xx,i)}}function Tx(r,i,c){r==="focusin"?(pm(),rl=i,sl=c,rl.attachEvent("onpropertychange",mm)):r==="focusout"&&pm()}function Sx(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Tc(sl)}function bx(r,i){if(r==="click")return Tc(i)}function Cx(r,i){if(r==="input"||r==="change")return Tc(i)}function Ix(r,i){return r===i&&(r!==0||1/r===1/i)||r!==r&&i!==i}var ds=typeof Object.is=="function"?Object.is:Ix;function il(r,i){if(ds(r,i))return!0;if(typeof r!="object"||r===null||typeof i!="object"||i===null)return!1;var c=Object.keys(r),h=Object.keys(i);if(c.length!==h.length)return!1;for(h=0;h<c.length;h++){var p=c[h];if(!m.call(i,p)||!ds(r[p],i[p]))return!1}return!0}function gm(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function ym(r,i){var c=gm(r);r=0;for(var h;c;){if(c.nodeType===3){if(h=r+c.textContent.length,r<=i&&h>=i)return{node:c,offset:i-r};r=h}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=gm(c)}}function vm(r,i){return r&&i?r===i?!0:r&&r.nodeType===3?!1:i&&i.nodeType===3?vm(r,i.parentNode):"contains"in r?r.contains(i):r.compareDocumentPosition?!!(r.compareDocumentPosition(i)&16):!1:!1}function _m(){for(var r=window,i=me();i instanceof r.HTMLIFrameElement;){try{var c=typeof i.contentWindow.location.href=="string"}catch{c=!1}if(c)r=i.contentWindow;else break;i=me(r.document)}return i}function Vd(r){var i=r&&r.nodeName&&r.nodeName.toLowerCase();return i&&(i==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||i==="textarea"||r.contentEditable==="true")}function Px(r){var i=_m(),c=r.focusedElem,h=r.selectionRange;if(i!==c&&c&&c.ownerDocument&&vm(c.ownerDocument.documentElement,c)){if(h!==null&&Vd(c)){if(i=h.start,r=h.end,r===void 0&&(r=i),"selectionStart"in c)c.selectionStart=i,c.selectionEnd=Math.min(r,c.value.length);else if(r=(i=c.ownerDocument||document)&&i.defaultView||window,r.getSelection){r=r.getSelection();var p=c.textContent.length,y=Math.min(h.start,p);h=h.end===void 0?y:Math.min(h.end,p),!r.extend&&y>h&&(p=h,h=y,y=p),p=ym(c,y);var E=ym(c,h);p&&E&&(r.rangeCount!==1||r.anchorNode!==p.node||r.anchorOffset!==p.offset||r.focusNode!==E.node||r.focusOffset!==E.offset)&&(i=i.createRange(),i.setStart(p.node,p.offset),r.removeAllRanges(),y>h?(r.addRange(i),r.extend(E.node,E.offset)):(i.setEnd(E.node,E.offset),r.addRange(i)))}}for(i=[],r=c;r=r.parentNode;)r.nodeType===1&&i.push({element:r,left:r.scrollLeft,top:r.scrollTop});for(typeof c.focus=="function"&&c.focus(),c=0;c<i.length;c++)r=i[c],r.element.scrollLeft=r.left,r.element.scrollTop=r.top}}var Nx=f&&"documentMode"in document&&11>=document.documentMode,eo=null,Md=null,al=null,Od=!1;function wm(r,i,c){var h=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Od||eo==null||eo!==me(h)||(h=eo,"selectionStart"in h&&Vd(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),al&&il(al,h)||(al=h,h=Ic(Md,"onSelect"),0<h.length&&(i=new qa("onSelect","select",null,i,c),r.push({event:i,listeners:h}),i.target=eo)))}function Sc(r,i){var c={};return c[r.toLowerCase()]=i.toLowerCase(),c["Webkit"+r]="webkit"+i,c["Moz"+r]="moz"+i,c}var to={animationend:Sc("Animation","AnimationEnd"),animationiteration:Sc("Animation","AnimationIteration"),animationstart:Sc("Animation","AnimationStart"),transitionend:Sc("Transition","TransitionEnd")},Fd={},xm={};f&&(xm=document.createElement("div").style,"AnimationEvent"in window||(delete to.animationend.animation,delete to.animationiteration.animation,delete to.animationstart.animation),"TransitionEvent"in window||delete to.transitionend.transition);function bc(r){if(Fd[r])return Fd[r];if(!to[r])return r;var i=to[r],c;for(c in i)if(i.hasOwnProperty(c)&&c in xm)return Fd[r]=i[c];return r}var Em=bc("animationend"),Tm=bc("animationiteration"),Sm=bc("animationstart"),bm=bc("transitionend"),Cm=new Map,Im="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ti(r,i){Cm.set(r,i),l(i,[r])}for(var Ud=0;Ud<Im.length;Ud++){var zd=Im[Ud],Rx=zd.toLowerCase(),Ax=zd[0].toUpperCase()+zd.slice(1);Ti(Rx,"on"+Ax)}Ti(Em,"onAnimationEnd"),Ti(Tm,"onAnimationIteration"),Ti(Sm,"onAnimationStart"),Ti("dblclick","onDoubleClick"),Ti("focusin","onFocus"),Ti("focusout","onBlur"),Ti(bm,"onTransitionEnd"),d("onMouseEnter",["mouseout","mouseover"]),d("onMouseLeave",["mouseout","mouseover"]),d("onPointerEnter",["pointerout","pointerover"]),d("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ol="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),jx=new Set("cancel close invalid load scroll toggle".split(" ").concat(ol));function Pm(r,i,c){var h=r.type||"unknown-event";r.currentTarget=c,Fr(h,i,void 0,r),r.currentTarget=null}function Nm(r,i){i=(i&4)!==0;for(var c=0;c<r.length;c++){var h=r[c],p=h.event;h=h.listeners;e:{var y=void 0;if(i)for(var E=h.length-1;0<=E;E--){var L=h[E],B=L.instance,re=L.currentTarget;if(L=L.listener,B!==y&&p.isPropagationStopped())break e;Pm(p,L,re),y=B}else for(E=0;E<h.length;E++){if(L=h[E],B=L.instance,re=L.currentTarget,L=L.listener,B!==y&&p.isPropagationStopped())break e;Pm(p,L,re),y=B}}}if(An)throw r=bs,An=!1,bs=null,r}function Ut(r,i){var c=i[Qd];c===void 0&&(c=i[Qd]=new Set);var h=r+"__bubble";c.has(h)||(Rm(i,r,2,!1),c.add(h))}function Bd(r,i,c){var h=0;i&&(h|=4),Rm(c,r,h,i)}var Cc="_reactListening"+Math.random().toString(36).slice(2);function ll(r){if(!r[Cc]){r[Cc]=!0,s.forEach(function(c){c!=="selectionchange"&&(jx.has(c)||Bd(c,!1,r),Bd(c,!0,r))});var i=r.nodeType===9?r:r.ownerDocument;i===null||i[Cc]||(i[Cc]=!0,Bd("selectionchange",!1,i))}}function Rm(r,i,c,h){switch(Xo(i)){case 1:var p=Wt;break;case 4:p=jd;break;default:p=Jo}c=p.bind(null,i,c,r),p=void 0,!Xn||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(p=!0),h?p!==void 0?r.addEventListener(i,c,{capture:!0,passive:p}):r.addEventListener(i,c,!0):p!==void 0?r.addEventListener(i,c,{passive:p}):r.addEventListener(i,c,!1)}function $d(r,i,c,h,p){var y=h;if((i&1)===0&&(i&2)===0&&h!==null)e:for(;;){if(h===null)return;var E=h.tag;if(E===3||E===4){var L=h.stateNode.containerInfo;if(L===p||L.nodeType===8&&L.parentNode===p)break;if(E===4)for(E=h.return;E!==null;){var B=E.tag;if((B===3||B===4)&&(B=E.stateNode.containerInfo,B===p||B.nodeType===8&&B.parentNode===p))return;E=E.return}for(;L!==null;){if(E=fa(L),E===null)return;if(B=E.tag,B===5||B===6){h=y=E;continue e}L=L.parentNode}}h=h.return}Gs(function(){var re=y,Se=pr(c),Ce=[];e:{var we=Cm.get(r);if(we!==void 0){var ze=qa,We=r;switch(r){case"keypress":if(Ga(c)===0)break e;case"keydown":case"keyup":ze=g;break;case"focusin":We="focus",ze=Ya;break;case"focusout":We="blur",ze=Ya;break;case"beforeblur":case"afterblur":ze=Ya;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ze=Ka;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ze=gc;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ze=ae;break;case Em:case Tm:case Sm:ze=Xs;break;case bm:ze=jt;break;case"scroll":ze=kd;break;case"wheel":ze=xt;break;case"copy":case"cut":case"paste":ze=_c;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ze=R}var qe=(i&4)!==0,on=!qe&&r==="scroll",ee=qe?we!==null?we+"Capture":null:we;qe=[];for(var K=re,te;K!==null;){te=K;var ke=te.stateNode;if(te.tag===5&&ke!==null&&(te=ke,ee!==null&&(ke=rt(K,ee),ke!=null&&qe.push(cl(K,ke,te)))),on)break;K=K.return}0<qe.length&&(we=new ze(we,We,null,c,Se),Ce.push({event:we,listeners:qe}))}}if((i&7)===0){e:{if(we=r==="mouseover"||r==="pointerover",ze=r==="mouseout"||r==="pointerout",we&&c!==Pt&&(We=c.relatedTarget||c.fromElement)&&(fa(We)||We[Zs]))break e;if((ze||we)&&(we=Se.window===Se?Se:(we=Se.ownerDocument)?we.defaultView||we.parentWindow:window,ze?(We=c.relatedTarget||c.toElement,ze=re,We=We?fa(We):null,We!==null&&(on=Ft(We),We!==on||We.tag!==5&&We.tag!==6)&&(We=null)):(ze=null,We=re),ze!==We)){if(qe=Ka,ke="onMouseLeave",ee="onMouseEnter",K="mouse",(r==="pointerout"||r==="pointerover")&&(qe=R,ke="onPointerLeave",ee="onPointerEnter",K="pointer"),on=ze==null?we:so(ze),te=We==null?we:so(We),we=new qe(ke,K+"leave",ze,c,Se),we.target=on,we.relatedTarget=te,ke=null,fa(Se)===re&&(qe=new qe(ee,K+"enter",We,c,Se),qe.target=te,qe.relatedTarget=on,ke=qe),on=ke,ze&&We)t:{for(qe=ze,ee=We,K=0,te=qe;te;te=no(te))K++;for(te=0,ke=ee;ke;ke=no(ke))te++;for(;0<K-te;)qe=no(qe),K--;for(;0<te-K;)ee=no(ee),te--;for(;K--;){if(qe===ee||ee!==null&&qe===ee.alternate)break t;qe=no(qe),ee=no(ee)}qe=null}else qe=null;ze!==null&&Am(Ce,we,ze,qe,!1),We!==null&&on!==null&&Am(Ce,on,We,qe,!0)}}e:{if(we=re?so(re):window,ze=we.nodeName&&we.nodeName.toLowerCase(),ze==="select"||ze==="input"&&we.type==="file")var Ke=Ex;else if(um(we))if(hm)Ke=Cx;else{Ke=Sx;var et=Tx}else(ze=we.nodeName)&&ze.toLowerCase()==="input"&&(we.type==="checkbox"||we.type==="radio")&&(Ke=bx);if(Ke&&(Ke=Ke(r,re))){dm(Ce,Ke,c,Se);break e}et&&et(r,we,re),r==="focusout"&&(et=we._wrapperState)&&et.controlled&&we.type==="number"&&Nt(we,"number",we.value)}switch(et=re?so(re):window,r){case"focusin":(um(et)||et.contentEditable==="true")&&(eo=et,Md=re,al=null);break;case"focusout":al=Md=eo=null;break;case"mousedown":Od=!0;break;case"contextmenu":case"mouseup":case"dragend":Od=!1,wm(Ce,c,Se);break;case"selectionchange":if(Nx)break;case"keydown":case"keyup":wm(Ce,c,Se)}var tt;if(dn)e:{switch(r){case"compositionstart":var at="onCompositionStart";break e;case"compositionend":at="onCompositionEnd";break e;case"compositionupdate":at="onCompositionUpdate";break e}at=void 0}else Za?lm(r,c)&&(at="onCompositionEnd"):r==="keydown"&&c.keyCode===229&&(at="onCompositionStart");at&&(ha&&c.locale!=="ko"&&(Za||at!=="onCompositionStart"?at==="onCompositionEnd"&&Za&&(tt=Zo()):(jr=Se,Wa="value"in jr?jr.value:jr.textContent,Za=!0)),et=Ic(re,at),0<et.length&&(at=new nl(at,r,null,c,Se),Ce.push({event:at,listeners:et}),tt?at.data=tt:(tt=cm(c),tt!==null&&(at.data=tt)))),(tt=kr?vx(r,c):_x(r,c))&&(re=Ic(re,"onBeforeInput"),0<re.length&&(Se=new nl("onBeforeInput","beforeinput",null,c,Se),Ce.push({event:Se,listeners:re}),Se.data=tt))}Nm(Ce,i)})}function cl(r,i,c){return{instance:r,listener:i,currentTarget:c}}function Ic(r,i){for(var c=i+"Capture",h=[];r!==null;){var p=r,y=p.stateNode;p.tag===5&&y!==null&&(p=y,y=rt(r,c),y!=null&&h.unshift(cl(r,y,p)),y=rt(r,i),y!=null&&h.push(cl(r,y,p))),r=r.return}return h}function no(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5);return r||null}function Am(r,i,c,h,p){for(var y=i._reactName,E=[];c!==null&&c!==h;){var L=c,B=L.alternate,re=L.stateNode;if(B!==null&&B===h)break;L.tag===5&&re!==null&&(L=re,p?(B=rt(c,y),B!=null&&E.unshift(cl(c,B,L))):p||(B=rt(c,y),B!=null&&E.push(cl(c,B,L)))),c=c.return}E.length!==0&&r.push({event:i,listeners:E})}var kx=/\r\n?/g,Dx=/\u0000|\uFFFD/g;function jm(r){return(typeof r=="string"?r:""+r).replace(kx,`
`).replace(Dx,"")}function Pc(r,i,c){if(i=jm(i),jm(r)!==i&&c)throw Error(t(425))}function Nc(){}var Wd=null,Gd=null;function qd(r,i){return r==="textarea"||r==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Hd=typeof setTimeout=="function"?setTimeout:void 0,Lx=typeof clearTimeout=="function"?clearTimeout:void 0,km=typeof Promise=="function"?Promise:void 0,Vx=typeof queueMicrotask=="function"?queueMicrotask:typeof km<"u"?function(r){return km.resolve(null).then(r).catch(Mx)}:Hd;function Mx(r){setTimeout(function(){throw r})}function Kd(r,i){var c=i,h=0;do{var p=c.nextSibling;if(r.removeChild(c),p&&p.nodeType===8)if(c=p.data,c==="/$"){if(h===0){r.removeChild(p),zn(i);return}h--}else c!=="$"&&c!=="$?"&&c!=="$!"||h++;c=p}while(c);zn(i)}function Si(r){for(;r!=null;r=r.nextSibling){var i=r.nodeType;if(i===1||i===3)break;if(i===8){if(i=r.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return r}function Dm(r){r=r.previousSibling;for(var i=0;r;){if(r.nodeType===8){var c=r.data;if(c==="$"||c==="$!"||c==="$?"){if(i===0)return r;i--}else c==="/$"&&i++}r=r.previousSibling}return null}var ro=Math.random().toString(36).slice(2),js="__reactFiber$"+ro,ul="__reactProps$"+ro,Zs="__reactContainer$"+ro,Qd="__reactEvents$"+ro,Ox="__reactListeners$"+ro,Fx="__reactHandles$"+ro;function fa(r){var i=r[js];if(i)return i;for(var c=r.parentNode;c;){if(i=c[Zs]||c[js]){if(c=i.alternate,i.child!==null||c!==null&&c.child!==null)for(r=Dm(r);r!==null;){if(c=r[js])return c;r=Dm(r)}return i}r=c,c=r.parentNode}return null}function dl(r){return r=r[js]||r[Zs],!r||r.tag!==5&&r.tag!==6&&r.tag!==13&&r.tag!==3?null:r}function so(r){if(r.tag===5||r.tag===6)return r.stateNode;throw Error(t(33))}function Rc(r){return r[ul]||null}var Yd=[],io=-1;function bi(r){return{current:r}}function zt(r){0>io||(r.current=Yd[io],Yd[io]=null,io--)}function Vt(r,i){io++,Yd[io]=r.current,r.current=i}var Ci={},er=bi(Ci),yr=bi(!1),pa=Ci;function ao(r,i){var c=r.type.contextTypes;if(!c)return Ci;var h=r.stateNode;if(h&&h.__reactInternalMemoizedUnmaskedChildContext===i)return h.__reactInternalMemoizedMaskedChildContext;var p={},y;for(y in c)p[y]=i[y];return h&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=i,r.__reactInternalMemoizedMaskedChildContext=p),p}function vr(r){return r=r.childContextTypes,r!=null}function Ac(){zt(yr),zt(er)}function Lm(r,i,c){if(er.current!==Ci)throw Error(t(168));Vt(er,i),Vt(yr,c)}function Vm(r,i,c){var h=r.stateNode;if(i=i.childContextTypes,typeof h.getChildContext!="function")return c;h=h.getChildContext();for(var p in h)if(!(p in i))throw Error(t(108,Fe(r)||"Unknown",p));return ve({},c,h)}function jc(r){return r=(r=r.stateNode)&&r.__reactInternalMemoizedMergedChildContext||Ci,pa=er.current,Vt(er,r),Vt(yr,yr.current),!0}function Mm(r,i,c){var h=r.stateNode;if(!h)throw Error(t(169));c?(r=Vm(r,i,pa),h.__reactInternalMemoizedMergedChildContext=r,zt(yr),zt(er),Vt(er,r)):zt(yr),Vt(yr,c)}var ei=null,kc=!1,Jd=!1;function Om(r){ei===null?ei=[r]:ei.push(r)}function Ux(r){kc=!0,Om(r)}function Ii(){if(!Jd&&ei!==null){Jd=!0;var r=0,i=pt;try{var c=ei;for(pt=1;r<c.length;r++){var h=c[r];do h=h(!0);while(h!==null)}ei=null,kc=!1}catch(p){throw ei!==null&&(ei=ei.slice(r+1)),ss(jn,Ii),p}finally{pt=i,Jd=!1}}return null}var oo=[],lo=0,Dc=null,Lc=0,$r=[],Wr=0,ma=null,ti=1,ni="";function ga(r,i){oo[lo++]=Lc,oo[lo++]=Dc,Dc=r,Lc=i}function Fm(r,i,c){$r[Wr++]=ti,$r[Wr++]=ni,$r[Wr++]=ma,ma=r;var h=ti;r=ni;var p=32-Ae(h)-1;h&=~(1<<p),c+=1;var y=32-Ae(i)+p;if(30<y){var E=p-p%5;y=(h&(1<<E)-1).toString(32),h>>=E,p-=E,ti=1<<32-Ae(i)+p|c<<p|h,ni=y+r}else ti=1<<y|c<<p|h,ni=r}function Xd(r){r.return!==null&&(ga(r,1),Fm(r,1,0))}function Zd(r){for(;r===Dc;)Dc=oo[--lo],oo[lo]=null,Lc=oo[--lo],oo[lo]=null;for(;r===ma;)ma=$r[--Wr],$r[Wr]=null,ni=$r[--Wr],$r[Wr]=null,ti=$r[--Wr],$r[Wr]=null}var Dr=null,Lr=null,Gt=!1,hs=null;function Um(r,i){var c=Kr(5,null,null,0);c.elementType="DELETED",c.stateNode=i,c.return=r,i=r.deletions,i===null?(r.deletions=[c],r.flags|=16):i.push(c)}function zm(r,i){switch(r.tag){case 5:var c=r.type;return i=i.nodeType!==1||c.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(r.stateNode=i,Dr=r,Lr=Si(i.firstChild),!0):!1;case 6:return i=r.pendingProps===""||i.nodeType!==3?null:i,i!==null?(r.stateNode=i,Dr=r,Lr=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(c=ma!==null?{id:ti,overflow:ni}:null,r.memoizedState={dehydrated:i,treeContext:c,retryLane:1073741824},c=Kr(18,null,null,0),c.stateNode=i,c.return=r,r.child=c,Dr=r,Lr=null,!0):!1;default:return!1}}function eh(r){return(r.mode&1)!==0&&(r.flags&128)===0}function th(r){if(Gt){var i=Lr;if(i){var c=i;if(!zm(r,i)){if(eh(r))throw Error(t(418));i=Si(c.nextSibling);var h=Dr;i&&zm(r,i)?Um(h,c):(r.flags=r.flags&-4097|2,Gt=!1,Dr=r)}}else{if(eh(r))throw Error(t(418));r.flags=r.flags&-4097|2,Gt=!1,Dr=r}}}function Bm(r){for(r=r.return;r!==null&&r.tag!==5&&r.tag!==3&&r.tag!==13;)r=r.return;Dr=r}function Vc(r){if(r!==Dr)return!1;if(!Gt)return Bm(r),Gt=!0,!1;var i;if((i=r.tag!==3)&&!(i=r.tag!==5)&&(i=r.type,i=i!=="head"&&i!=="body"&&!qd(r.type,r.memoizedProps)),i&&(i=Lr)){if(eh(r))throw $m(),Error(t(418));for(;i;)Um(r,i),i=Si(i.nextSibling)}if(Bm(r),r.tag===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(t(317));e:{for(r=r.nextSibling,i=0;r;){if(r.nodeType===8){var c=r.data;if(c==="/$"){if(i===0){Lr=Si(r.nextSibling);break e}i--}else c!=="$"&&c!=="$!"&&c!=="$?"||i++}r=r.nextSibling}Lr=null}}else Lr=Dr?Si(r.stateNode.nextSibling):null;return!0}function $m(){for(var r=Lr;r;)r=Si(r.nextSibling)}function co(){Lr=Dr=null,Gt=!1}function nh(r){hs===null?hs=[r]:hs.push(r)}var zx=_e.ReactCurrentBatchConfig;function hl(r,i,c){if(r=c.ref,r!==null&&typeof r!="function"&&typeof r!="object"){if(c._owner){if(c=c._owner,c){if(c.tag!==1)throw Error(t(309));var h=c.stateNode}if(!h)throw Error(t(147,r));var p=h,y=""+r;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===y?i.ref:(i=function(E){var L=p.refs;E===null?delete L[y]:L[y]=E},i._stringRef=y,i)}if(typeof r!="string")throw Error(t(284));if(!c._owner)throw Error(t(290,r))}return r}function Mc(r,i){throw r=Object.prototype.toString.call(i),Error(t(31,r==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":r))}function Wm(r){var i=r._init;return i(r._payload)}function Gm(r){function i(ee,K){if(r){var te=ee.deletions;te===null?(ee.deletions=[K],ee.flags|=16):te.push(K)}}function c(ee,K){if(!r)return null;for(;K!==null;)i(ee,K),K=K.sibling;return null}function h(ee,K){for(ee=new Map;K!==null;)K.key!==null?ee.set(K.key,K):ee.set(K.index,K),K=K.sibling;return ee}function p(ee,K){return ee=Li(ee,K),ee.index=0,ee.sibling=null,ee}function y(ee,K,te){return ee.index=te,r?(te=ee.alternate,te!==null?(te=te.index,te<K?(ee.flags|=2,K):te):(ee.flags|=2,K)):(ee.flags|=1048576,K)}function E(ee){return r&&ee.alternate===null&&(ee.flags|=2),ee}function L(ee,K,te,ke){return K===null||K.tag!==6?(K=Hh(te,ee.mode,ke),K.return=ee,K):(K=p(K,te),K.return=ee,K)}function B(ee,K,te,ke){var Ke=te.type;return Ke===C?Se(ee,K,te.props.children,ke,te.key):K!==null&&(K.elementType===Ke||typeof Ke=="object"&&Ke!==null&&Ke.$$typeof===Re&&Wm(Ke)===K.type)?(ke=p(K,te.props),ke.ref=hl(ee,K,te),ke.return=ee,ke):(ke=ou(te.type,te.key,te.props,null,ee.mode,ke),ke.ref=hl(ee,K,te),ke.return=ee,ke)}function re(ee,K,te,ke){return K===null||K.tag!==4||K.stateNode.containerInfo!==te.containerInfo||K.stateNode.implementation!==te.implementation?(K=Kh(te,ee.mode,ke),K.return=ee,K):(K=p(K,te.children||[]),K.return=ee,K)}function Se(ee,K,te,ke,Ke){return K===null||K.tag!==7?(K=Sa(te,ee.mode,ke,Ke),K.return=ee,K):(K=p(K,te),K.return=ee,K)}function Ce(ee,K,te){if(typeof K=="string"&&K!==""||typeof K=="number")return K=Hh(""+K,ee.mode,te),K.return=ee,K;if(typeof K=="object"&&K!==null){switch(K.$$typeof){case V:return te=ou(K.type,K.key,K.props,null,ee.mode,te),te.ref=hl(ee,null,K),te.return=ee,te;case ie:return K=Kh(K,ee.mode,te),K.return=ee,K;case Re:var ke=K._init;return Ce(ee,ke(K._payload),te)}if(Qt(K)||Ie(K))return K=Sa(K,ee.mode,te,null),K.return=ee,K;Mc(ee,K)}return null}function we(ee,K,te,ke){var Ke=K!==null?K.key:null;if(typeof te=="string"&&te!==""||typeof te=="number")return Ke!==null?null:L(ee,K,""+te,ke);if(typeof te=="object"&&te!==null){switch(te.$$typeof){case V:return te.key===Ke?B(ee,K,te,ke):null;case ie:return te.key===Ke?re(ee,K,te,ke):null;case Re:return Ke=te._init,we(ee,K,Ke(te._payload),ke)}if(Qt(te)||Ie(te))return Ke!==null?null:Se(ee,K,te,ke,null);Mc(ee,te)}return null}function ze(ee,K,te,ke,Ke){if(typeof ke=="string"&&ke!==""||typeof ke=="number")return ee=ee.get(te)||null,L(K,ee,""+ke,Ke);if(typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case V:return ee=ee.get(ke.key===null?te:ke.key)||null,B(K,ee,ke,Ke);case ie:return ee=ee.get(ke.key===null?te:ke.key)||null,re(K,ee,ke,Ke);case Re:var et=ke._init;return ze(ee,K,te,et(ke._payload),Ke)}if(Qt(ke)||Ie(ke))return ee=ee.get(te)||null,Se(K,ee,ke,Ke,null);Mc(K,ke)}return null}function We(ee,K,te,ke){for(var Ke=null,et=null,tt=K,at=K=0,Vn=null;tt!==null&&at<te.length;at++){tt.index>at?(Vn=tt,tt=null):Vn=tt.sibling;var It=we(ee,tt,te[at],ke);if(It===null){tt===null&&(tt=Vn);break}r&&tt&&It.alternate===null&&i(ee,tt),K=y(It,K,at),et===null?Ke=It:et.sibling=It,et=It,tt=Vn}if(at===te.length)return c(ee,tt),Gt&&ga(ee,at),Ke;if(tt===null){for(;at<te.length;at++)tt=Ce(ee,te[at],ke),tt!==null&&(K=y(tt,K,at),et===null?Ke=tt:et.sibling=tt,et=tt);return Gt&&ga(ee,at),Ke}for(tt=h(ee,tt);at<te.length;at++)Vn=ze(tt,ee,at,te[at],ke),Vn!==null&&(r&&Vn.alternate!==null&&tt.delete(Vn.key===null?at:Vn.key),K=y(Vn,K,at),et===null?Ke=Vn:et.sibling=Vn,et=Vn);return r&&tt.forEach(function(Vi){return i(ee,Vi)}),Gt&&ga(ee,at),Ke}function qe(ee,K,te,ke){var Ke=Ie(te);if(typeof Ke!="function")throw Error(t(150));if(te=Ke.call(te),te==null)throw Error(t(151));for(var et=Ke=null,tt=K,at=K=0,Vn=null,It=te.next();tt!==null&&!It.done;at++,It=te.next()){tt.index>at?(Vn=tt,tt=null):Vn=tt.sibling;var Vi=we(ee,tt,It.value,ke);if(Vi===null){tt===null&&(tt=Vn);break}r&&tt&&Vi.alternate===null&&i(ee,tt),K=y(Vi,K,at),et===null?Ke=Vi:et.sibling=Vi,et=Vi,tt=Vn}if(It.done)return c(ee,tt),Gt&&ga(ee,at),Ke;if(tt===null){for(;!It.done;at++,It=te.next())It=Ce(ee,It.value,ke),It!==null&&(K=y(It,K,at),et===null?Ke=It:et.sibling=It,et=It);return Gt&&ga(ee,at),Ke}for(tt=h(ee,tt);!It.done;at++,It=te.next())It=ze(tt,ee,at,It.value,ke),It!==null&&(r&&It.alternate!==null&&tt.delete(It.key===null?at:It.key),K=y(It,K,at),et===null?Ke=It:et.sibling=It,et=It);return r&&tt.forEach(function(wE){return i(ee,wE)}),Gt&&ga(ee,at),Ke}function on(ee,K,te,ke){if(typeof te=="object"&&te!==null&&te.type===C&&te.key===null&&(te=te.props.children),typeof te=="object"&&te!==null){switch(te.$$typeof){case V:e:{for(var Ke=te.key,et=K;et!==null;){if(et.key===Ke){if(Ke=te.type,Ke===C){if(et.tag===7){c(ee,et.sibling),K=p(et,te.props.children),K.return=ee,ee=K;break e}}else if(et.elementType===Ke||typeof Ke=="object"&&Ke!==null&&Ke.$$typeof===Re&&Wm(Ke)===et.type){c(ee,et.sibling),K=p(et,te.props),K.ref=hl(ee,et,te),K.return=ee,ee=K;break e}c(ee,et);break}else i(ee,et);et=et.sibling}te.type===C?(K=Sa(te.props.children,ee.mode,ke,te.key),K.return=ee,ee=K):(ke=ou(te.type,te.key,te.props,null,ee.mode,ke),ke.ref=hl(ee,K,te),ke.return=ee,ee=ke)}return E(ee);case ie:e:{for(et=te.key;K!==null;){if(K.key===et)if(K.tag===4&&K.stateNode.containerInfo===te.containerInfo&&K.stateNode.implementation===te.implementation){c(ee,K.sibling),K=p(K,te.children||[]),K.return=ee,ee=K;break e}else{c(ee,K);break}else i(ee,K);K=K.sibling}K=Kh(te,ee.mode,ke),K.return=ee,ee=K}return E(ee);case Re:return et=te._init,on(ee,K,et(te._payload),ke)}if(Qt(te))return We(ee,K,te,ke);if(Ie(te))return qe(ee,K,te,ke);Mc(ee,te)}return typeof te=="string"&&te!==""||typeof te=="number"?(te=""+te,K!==null&&K.tag===6?(c(ee,K.sibling),K=p(K,te),K.return=ee,ee=K):(c(ee,K),K=Hh(te,ee.mode,ke),K.return=ee,ee=K),E(ee)):c(ee,K)}return on}var uo=Gm(!0),qm=Gm(!1),Oc=bi(null),Fc=null,ho=null,rh=null;function sh(){rh=ho=Fc=null}function ih(r){var i=Oc.current;zt(Oc),r._currentValue=i}function ah(r,i,c){for(;r!==null;){var h=r.alternate;if((r.childLanes&i)!==i?(r.childLanes|=i,h!==null&&(h.childLanes|=i)):h!==null&&(h.childLanes&i)!==i&&(h.childLanes|=i),r===c)break;r=r.return}}function fo(r,i){Fc=r,rh=ho=null,r=r.dependencies,r!==null&&r.firstContext!==null&&((r.lanes&i)!==0&&(_r=!0),r.firstContext=null)}function Gr(r){var i=r._currentValue;if(rh!==r)if(r={context:r,memoizedValue:i,next:null},ho===null){if(Fc===null)throw Error(t(308));ho=r,Fc.dependencies={lanes:0,firstContext:r}}else ho=ho.next=r;return i}var ya=null;function oh(r){ya===null?ya=[r]:ya.push(r)}function Hm(r,i,c,h){var p=i.interleaved;return p===null?(c.next=c,oh(i)):(c.next=p.next,p.next=c),i.interleaved=c,ri(r,h)}function ri(r,i){r.lanes|=i;var c=r.alternate;for(c!==null&&(c.lanes|=i),c=r,r=r.return;r!==null;)r.childLanes|=i,c=r.alternate,c!==null&&(c.childLanes|=i),c=r,r=r.return;return c.tag===3?c.stateNode:null}var Pi=!1;function lh(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Km(r,i){r=r.updateQueue,i.updateQueue===r&&(i.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,effects:r.effects})}function si(r,i){return{eventTime:r,lane:i,tag:0,payload:null,callback:null,next:null}}function Ni(r,i,c){var h=r.updateQueue;if(h===null)return null;if(h=h.shared,(bt&2)!==0){var p=h.pending;return p===null?i.next=i:(i.next=p.next,p.next=i),h.pending=i,ri(r,c)}return p=h.interleaved,p===null?(i.next=i,oh(h)):(i.next=p.next,p.next=i),h.interleaved=i,ri(r,c)}function Uc(r,i,c){if(i=i.updateQueue,i!==null&&(i=i.shared,(c&4194240)!==0)){var h=i.lanes;h&=r.pendingLanes,c|=h,i.lanes=c,Is(r,c)}}function Qm(r,i){var c=r.updateQueue,h=r.alternate;if(h!==null&&(h=h.updateQueue,c===h)){var p=null,y=null;if(c=c.firstBaseUpdate,c!==null){do{var E={eventTime:c.eventTime,lane:c.lane,tag:c.tag,payload:c.payload,callback:c.callback,next:null};y===null?p=y=E:y=y.next=E,c=c.next}while(c!==null);y===null?p=y=i:y=y.next=i}else p=y=i;c={baseState:h.baseState,firstBaseUpdate:p,lastBaseUpdate:y,shared:h.shared,effects:h.effects},r.updateQueue=c;return}r=c.lastBaseUpdate,r===null?c.firstBaseUpdate=i:r.next=i,c.lastBaseUpdate=i}function zc(r,i,c,h){var p=r.updateQueue;Pi=!1;var y=p.firstBaseUpdate,E=p.lastBaseUpdate,L=p.shared.pending;if(L!==null){p.shared.pending=null;var B=L,re=B.next;B.next=null,E===null?y=re:E.next=re,E=B;var Se=r.alternate;Se!==null&&(Se=Se.updateQueue,L=Se.lastBaseUpdate,L!==E&&(L===null?Se.firstBaseUpdate=re:L.next=re,Se.lastBaseUpdate=B))}if(y!==null){var Ce=p.baseState;E=0,Se=re=B=null,L=y;do{var we=L.lane,ze=L.eventTime;if((h&we)===we){Se!==null&&(Se=Se.next={eventTime:ze,lane:0,tag:L.tag,payload:L.payload,callback:L.callback,next:null});e:{var We=r,qe=L;switch(we=i,ze=c,qe.tag){case 1:if(We=qe.payload,typeof We=="function"){Ce=We.call(ze,Ce,we);break e}Ce=We;break e;case 3:We.flags=We.flags&-65537|128;case 0:if(We=qe.payload,we=typeof We=="function"?We.call(ze,Ce,we):We,we==null)break e;Ce=ve({},Ce,we);break e;case 2:Pi=!0}}L.callback!==null&&L.lane!==0&&(r.flags|=64,we=p.effects,we===null?p.effects=[L]:we.push(L))}else ze={eventTime:ze,lane:we,tag:L.tag,payload:L.payload,callback:L.callback,next:null},Se===null?(re=Se=ze,B=Ce):Se=Se.next=ze,E|=we;if(L=L.next,L===null){if(L=p.shared.pending,L===null)break;we=L,L=we.next,we.next=null,p.lastBaseUpdate=we,p.shared.pending=null}}while(!0);if(Se===null&&(B=Ce),p.baseState=B,p.firstBaseUpdate=re,p.lastBaseUpdate=Se,i=p.shared.interleaved,i!==null){p=i;do E|=p.lane,p=p.next;while(p!==i)}else y===null&&(p.shared.lanes=0);wa|=E,r.lanes=E,r.memoizedState=Ce}}function Ym(r,i,c){if(r=i.effects,i.effects=null,r!==null)for(i=0;i<r.length;i++){var h=r[i],p=h.callback;if(p!==null){if(h.callback=null,h=c,typeof p!="function")throw Error(t(191,p));p.call(h)}}}var fl={},ks=bi(fl),pl=bi(fl),ml=bi(fl);function va(r){if(r===fl)throw Error(t(174));return r}function ch(r,i){switch(Vt(ml,i),Vt(pl,r),Vt(ks,fl),r=i.nodeType,r){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:$t(null,"");break;default:r=r===8?i.parentNode:i,i=r.namespaceURI||null,r=r.tagName,i=$t(i,r)}zt(ks),Vt(ks,i)}function po(){zt(ks),zt(pl),zt(ml)}function Jm(r){va(ml.current);var i=va(ks.current),c=$t(i,r.type);i!==c&&(Vt(pl,r),Vt(ks,c))}function uh(r){pl.current===r&&(zt(ks),zt(pl))}var qt=bi(0);function Bc(r){for(var i=r;i!==null;){if(i.tag===13){var c=i.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||c.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===r)break;for(;i.sibling===null;){if(i.return===null||i.return===r)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var dh=[];function hh(){for(var r=0;r<dh.length;r++)dh[r]._workInProgressVersionPrimary=null;dh.length=0}var $c=_e.ReactCurrentDispatcher,fh=_e.ReactCurrentBatchConfig,_a=0,Ht=null,En=null,Dn=null,Wc=!1,gl=!1,yl=0,Bx=0;function tr(){throw Error(t(321))}function ph(r,i){if(i===null)return!1;for(var c=0;c<i.length&&c<r.length;c++)if(!ds(r[c],i[c]))return!1;return!0}function mh(r,i,c,h,p,y){if(_a=y,Ht=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,$c.current=r===null||r.memoizedState===null?qx:Hx,r=c(h,p),gl){y=0;do{if(gl=!1,yl=0,25<=y)throw Error(t(301));y+=1,Dn=En=null,i.updateQueue=null,$c.current=Kx,r=c(h,p)}while(gl)}if($c.current=Hc,i=En!==null&&En.next!==null,_a=0,Dn=En=Ht=null,Wc=!1,i)throw Error(t(300));return r}function gh(){var r=yl!==0;return yl=0,r}function Ds(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Dn===null?Ht.memoizedState=Dn=r:Dn=Dn.next=r,Dn}function qr(){if(En===null){var r=Ht.alternate;r=r!==null?r.memoizedState:null}else r=En.next;var i=Dn===null?Ht.memoizedState:Dn.next;if(i!==null)Dn=i,En=r;else{if(r===null)throw Error(t(310));En=r,r={memoizedState:En.memoizedState,baseState:En.baseState,baseQueue:En.baseQueue,queue:En.queue,next:null},Dn===null?Ht.memoizedState=Dn=r:Dn=Dn.next=r}return Dn}function vl(r,i){return typeof i=="function"?i(r):i}function yh(r){var i=qr(),c=i.queue;if(c===null)throw Error(t(311));c.lastRenderedReducer=r;var h=En,p=h.baseQueue,y=c.pending;if(y!==null){if(p!==null){var E=p.next;p.next=y.next,y.next=E}h.baseQueue=p=y,c.pending=null}if(p!==null){y=p.next,h=h.baseState;var L=E=null,B=null,re=y;do{var Se=re.lane;if((_a&Se)===Se)B!==null&&(B=B.next={lane:0,action:re.action,hasEagerState:re.hasEagerState,eagerState:re.eagerState,next:null}),h=re.hasEagerState?re.eagerState:r(h,re.action);else{var Ce={lane:Se,action:re.action,hasEagerState:re.hasEagerState,eagerState:re.eagerState,next:null};B===null?(L=B=Ce,E=h):B=B.next=Ce,Ht.lanes|=Se,wa|=Se}re=re.next}while(re!==null&&re!==y);B===null?E=h:B.next=L,ds(h,i.memoizedState)||(_r=!0),i.memoizedState=h,i.baseState=E,i.baseQueue=B,c.lastRenderedState=h}if(r=c.interleaved,r!==null){p=r;do y=p.lane,Ht.lanes|=y,wa|=y,p=p.next;while(p!==r)}else p===null&&(c.lanes=0);return[i.memoizedState,c.dispatch]}function vh(r){var i=qr(),c=i.queue;if(c===null)throw Error(t(311));c.lastRenderedReducer=r;var h=c.dispatch,p=c.pending,y=i.memoizedState;if(p!==null){c.pending=null;var E=p=p.next;do y=r(y,E.action),E=E.next;while(E!==p);ds(y,i.memoizedState)||(_r=!0),i.memoizedState=y,i.baseQueue===null&&(i.baseState=y),c.lastRenderedState=y}return[y,h]}function Xm(){}function Zm(r,i){var c=Ht,h=qr(),p=i(),y=!ds(h.memoizedState,p);if(y&&(h.memoizedState=p,_r=!0),h=h.queue,_h(ng.bind(null,c,h,r),[r]),h.getSnapshot!==i||y||Dn!==null&&Dn.memoizedState.tag&1){if(c.flags|=2048,_l(9,tg.bind(null,c,h,p,i),void 0,null),Ln===null)throw Error(t(349));(_a&30)!==0||eg(c,i,p)}return p}function eg(r,i,c){r.flags|=16384,r={getSnapshot:i,value:c},i=Ht.updateQueue,i===null?(i={lastEffect:null,stores:null},Ht.updateQueue=i,i.stores=[r]):(c=i.stores,c===null?i.stores=[r]:c.push(r))}function tg(r,i,c,h){i.value=c,i.getSnapshot=h,rg(i)&&sg(r)}function ng(r,i,c){return c(function(){rg(i)&&sg(r)})}function rg(r){var i=r.getSnapshot;r=r.value;try{var c=i();return!ds(r,c)}catch{return!0}}function sg(r){var i=ri(r,1);i!==null&&gs(i,r,1,-1)}function ig(r){var i=Ds();return typeof r=="function"&&(r=r()),i.memoizedState=i.baseState=r,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:vl,lastRenderedState:r},i.queue=r,r=r.dispatch=Gx.bind(null,Ht,r),[i.memoizedState,r]}function _l(r,i,c,h){return r={tag:r,create:i,destroy:c,deps:h,next:null},i=Ht.updateQueue,i===null?(i={lastEffect:null,stores:null},Ht.updateQueue=i,i.lastEffect=r.next=r):(c=i.lastEffect,c===null?i.lastEffect=r.next=r:(h=c.next,c.next=r,r.next=h,i.lastEffect=r)),r}function ag(){return qr().memoizedState}function Gc(r,i,c,h){var p=Ds();Ht.flags|=r,p.memoizedState=_l(1|i,c,void 0,h===void 0?null:h)}function qc(r,i,c,h){var p=qr();h=h===void 0?null:h;var y=void 0;if(En!==null){var E=En.memoizedState;if(y=E.destroy,h!==null&&ph(h,E.deps)){p.memoizedState=_l(i,c,y,h);return}}Ht.flags|=r,p.memoizedState=_l(1|i,c,y,h)}function og(r,i){return Gc(8390656,8,r,i)}function _h(r,i){return qc(2048,8,r,i)}function lg(r,i){return qc(4,2,r,i)}function cg(r,i){return qc(4,4,r,i)}function ug(r,i){if(typeof i=="function")return r=r(),i(r),function(){i(null)};if(i!=null)return r=r(),i.current=r,function(){i.current=null}}function dg(r,i,c){return c=c!=null?c.concat([r]):null,qc(4,4,ug.bind(null,i,r),c)}function wh(){}function hg(r,i){var c=qr();i=i===void 0?null:i;var h=c.memoizedState;return h!==null&&i!==null&&ph(i,h[1])?h[0]:(c.memoizedState=[r,i],r)}function fg(r,i){var c=qr();i=i===void 0?null:i;var h=c.memoizedState;return h!==null&&i!==null&&ph(i,h[1])?h[0]:(r=r(),c.memoizedState=[r,i],r)}function pg(r,i,c){return(_a&21)===0?(r.baseState&&(r.baseState=!1,_r=!0),r.memoizedState=c):(ds(c,i)||(c=as(),Ht.lanes|=c,wa|=c,r.baseState=!0),i)}function $x(r,i){var c=pt;pt=c!==0&&4>c?c:4,r(!0);var h=fh.transition;fh.transition={};try{r(!1),i()}finally{pt=c,fh.transition=h}}function mg(){return qr().memoizedState}function Wx(r,i,c){var h=ki(r);if(c={lane:h,action:c,hasEagerState:!1,eagerState:null,next:null},gg(r))yg(i,c);else if(c=Hm(r,i,c,h),c!==null){var p=fr();gs(c,r,h,p),vg(c,i,h)}}function Gx(r,i,c){var h=ki(r),p={lane:h,action:c,hasEagerState:!1,eagerState:null,next:null};if(gg(r))yg(i,p);else{var y=r.alternate;if(r.lanes===0&&(y===null||y.lanes===0)&&(y=i.lastRenderedReducer,y!==null))try{var E=i.lastRenderedState,L=y(E,c);if(p.hasEagerState=!0,p.eagerState=L,ds(L,E)){var B=i.interleaved;B===null?(p.next=p,oh(i)):(p.next=B.next,B.next=p),i.interleaved=p;return}}catch{}finally{}c=Hm(r,i,p,h),c!==null&&(p=fr(),gs(c,r,h,p),vg(c,i,h))}}function gg(r){var i=r.alternate;return r===Ht||i!==null&&i===Ht}function yg(r,i){gl=Wc=!0;var c=r.pending;c===null?i.next=i:(i.next=c.next,c.next=i),r.pending=i}function vg(r,i,c){if((c&4194240)!==0){var h=i.lanes;h&=r.pendingLanes,c|=h,i.lanes=c,Is(r,c)}}var Hc={readContext:Gr,useCallback:tr,useContext:tr,useEffect:tr,useImperativeHandle:tr,useInsertionEffect:tr,useLayoutEffect:tr,useMemo:tr,useReducer:tr,useRef:tr,useState:tr,useDebugValue:tr,useDeferredValue:tr,useTransition:tr,useMutableSource:tr,useSyncExternalStore:tr,useId:tr,unstable_isNewReconciler:!1},qx={readContext:Gr,useCallback:function(r,i){return Ds().memoizedState=[r,i===void 0?null:i],r},useContext:Gr,useEffect:og,useImperativeHandle:function(r,i,c){return c=c!=null?c.concat([r]):null,Gc(4194308,4,ug.bind(null,i,r),c)},useLayoutEffect:function(r,i){return Gc(4194308,4,r,i)},useInsertionEffect:function(r,i){return Gc(4,2,r,i)},useMemo:function(r,i){var c=Ds();return i=i===void 0?null:i,r=r(),c.memoizedState=[r,i],r},useReducer:function(r,i,c){var h=Ds();return i=c!==void 0?c(i):i,h.memoizedState=h.baseState=i,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:i},h.queue=r,r=r.dispatch=Wx.bind(null,Ht,r),[h.memoizedState,r]},useRef:function(r){var i=Ds();return r={current:r},i.memoizedState=r},useState:ig,useDebugValue:wh,useDeferredValue:function(r){return Ds().memoizedState=r},useTransition:function(){var r=ig(!1),i=r[0];return r=$x.bind(null,r[1]),Ds().memoizedState=r,[i,r]},useMutableSource:function(){},useSyncExternalStore:function(r,i,c){var h=Ht,p=Ds();if(Gt){if(c===void 0)throw Error(t(407));c=c()}else{if(c=i(),Ln===null)throw Error(t(349));(_a&30)!==0||eg(h,i,c)}p.memoizedState=c;var y={value:c,getSnapshot:i};return p.queue=y,og(ng.bind(null,h,y,r),[r]),h.flags|=2048,_l(9,tg.bind(null,h,y,c,i),void 0,null),c},useId:function(){var r=Ds(),i=Ln.identifierPrefix;if(Gt){var c=ni,h=ti;c=(h&~(1<<32-Ae(h)-1)).toString(32)+c,i=":"+i+"R"+c,c=yl++,0<c&&(i+="H"+c.toString(32)),i+=":"}else c=Bx++,i=":"+i+"r"+c.toString(32)+":";return r.memoizedState=i},unstable_isNewReconciler:!1},Hx={readContext:Gr,useCallback:hg,useContext:Gr,useEffect:_h,useImperativeHandle:dg,useInsertionEffect:lg,useLayoutEffect:cg,useMemo:fg,useReducer:yh,useRef:ag,useState:function(){return yh(vl)},useDebugValue:wh,useDeferredValue:function(r){var i=qr();return pg(i,En.memoizedState,r)},useTransition:function(){var r=yh(vl)[0],i=qr().memoizedState;return[r,i]},useMutableSource:Xm,useSyncExternalStore:Zm,useId:mg,unstable_isNewReconciler:!1},Kx={readContext:Gr,useCallback:hg,useContext:Gr,useEffect:_h,useImperativeHandle:dg,useInsertionEffect:lg,useLayoutEffect:cg,useMemo:fg,useReducer:vh,useRef:ag,useState:function(){return vh(vl)},useDebugValue:wh,useDeferredValue:function(r){var i=qr();return En===null?i.memoizedState=r:pg(i,En.memoizedState,r)},useTransition:function(){var r=vh(vl)[0],i=qr().memoizedState;return[r,i]},useMutableSource:Xm,useSyncExternalStore:Zm,useId:mg,unstable_isNewReconciler:!1};function fs(r,i){if(r&&r.defaultProps){i=ve({},i),r=r.defaultProps;for(var c in r)i[c]===void 0&&(i[c]=r[c]);return i}return i}function xh(r,i,c,h){i=r.memoizedState,c=c(h,i),c=c==null?i:ve({},i,c),r.memoizedState=c,r.lanes===0&&(r.updateQueue.baseState=c)}var Kc={isMounted:function(r){return(r=r._reactInternals)?Ft(r)===r:!1},enqueueSetState:function(r,i,c){r=r._reactInternals;var h=fr(),p=ki(r),y=si(h,p);y.payload=i,c!=null&&(y.callback=c),i=Ni(r,y,p),i!==null&&(gs(i,r,p,h),Uc(i,r,p))},enqueueReplaceState:function(r,i,c){r=r._reactInternals;var h=fr(),p=ki(r),y=si(h,p);y.tag=1,y.payload=i,c!=null&&(y.callback=c),i=Ni(r,y,p),i!==null&&(gs(i,r,p,h),Uc(i,r,p))},enqueueForceUpdate:function(r,i){r=r._reactInternals;var c=fr(),h=ki(r),p=si(c,h);p.tag=2,i!=null&&(p.callback=i),i=Ni(r,p,h),i!==null&&(gs(i,r,h,c),Uc(i,r,h))}};function _g(r,i,c,h,p,y,E){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(h,y,E):i.prototype&&i.prototype.isPureReactComponent?!il(c,h)||!il(p,y):!0}function wg(r,i,c){var h=!1,p=Ci,y=i.contextType;return typeof y=="object"&&y!==null?y=Gr(y):(p=vr(i)?pa:er.current,h=i.contextTypes,y=(h=h!=null)?ao(r,p):Ci),i=new i(c,y),r.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=Kc,r.stateNode=i,i._reactInternals=r,h&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=p,r.__reactInternalMemoizedMaskedChildContext=y),i}function xg(r,i,c,h){r=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(c,h),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(c,h),i.state!==r&&Kc.enqueueReplaceState(i,i.state,null)}function Eh(r,i,c,h){var p=r.stateNode;p.props=c,p.state=r.memoizedState,p.refs={},lh(r);var y=i.contextType;typeof y=="object"&&y!==null?p.context=Gr(y):(y=vr(i)?pa:er.current,p.context=ao(r,y)),p.state=r.memoizedState,y=i.getDerivedStateFromProps,typeof y=="function"&&(xh(r,i,y,c),p.state=r.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(i=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),i!==p.state&&Kc.enqueueReplaceState(p,p.state,null),zc(r,c,p,h),p.state=r.memoizedState),typeof p.componentDidMount=="function"&&(r.flags|=4194308)}function mo(r,i){try{var c="",h=i;do c+=Le(h),h=h.return;while(h);var p=c}catch(y){p=`
Error generating stack: `+y.message+`
`+y.stack}return{value:r,source:i,stack:p,digest:null}}function Th(r,i,c){return{value:r,source:null,stack:c??null,digest:i??null}}function Sh(r,i){try{console.error(i.value)}catch(c){setTimeout(function(){throw c})}}var Qx=typeof WeakMap=="function"?WeakMap:Map;function Eg(r,i,c){c=si(-1,c),c.tag=3,c.payload={element:null};var h=i.value;return c.callback=function(){tu||(tu=!0,Fh=h),Sh(r,i)},c}function Tg(r,i,c){c=si(-1,c),c.tag=3;var h=r.type.getDerivedStateFromError;if(typeof h=="function"){var p=i.value;c.payload=function(){return h(p)},c.callback=function(){Sh(r,i)}}var y=r.stateNode;return y!==null&&typeof y.componentDidCatch=="function"&&(c.callback=function(){Sh(r,i),typeof h!="function"&&(Ai===null?Ai=new Set([this]):Ai.add(this));var E=i.stack;this.componentDidCatch(i.value,{componentStack:E!==null?E:""})}),c}function Sg(r,i,c){var h=r.pingCache;if(h===null){h=r.pingCache=new Qx;var p=new Set;h.set(i,p)}else p=h.get(i),p===void 0&&(p=new Set,h.set(i,p));p.has(c)||(p.add(c),r=cE.bind(null,r,i,c),i.then(r,r))}function bg(r){do{var i;if((i=r.tag===13)&&(i=r.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return r;r=r.return}while(r!==null);return null}function Cg(r,i,c,h,p){return(r.mode&1)===0?(r===i?r.flags|=65536:(r.flags|=128,c.flags|=131072,c.flags&=-52805,c.tag===1&&(c.alternate===null?c.tag=17:(i=si(-1,1),i.tag=2,Ni(c,i,1))),c.lanes|=1),r):(r.flags|=65536,r.lanes=p,r)}var Yx=_e.ReactCurrentOwner,_r=!1;function hr(r,i,c,h){i.child=r===null?qm(i,null,c,h):uo(i,r.child,c,h)}function Ig(r,i,c,h,p){c=c.render;var y=i.ref;return fo(i,p),h=mh(r,i,c,h,y,p),c=gh(),r!==null&&!_r?(i.updateQueue=r.updateQueue,i.flags&=-2053,r.lanes&=~p,ii(r,i,p)):(Gt&&c&&Xd(i),i.flags|=1,hr(r,i,h,p),i.child)}function Pg(r,i,c,h,p){if(r===null){var y=c.type;return typeof y=="function"&&!qh(y)&&y.defaultProps===void 0&&c.compare===null&&c.defaultProps===void 0?(i.tag=15,i.type=y,Ng(r,i,y,h,p)):(r=ou(c.type,null,h,i,i.mode,p),r.ref=i.ref,r.return=i,i.child=r)}if(y=r.child,(r.lanes&p)===0){var E=y.memoizedProps;if(c=c.compare,c=c!==null?c:il,c(E,h)&&r.ref===i.ref)return ii(r,i,p)}return i.flags|=1,r=Li(y,h),r.ref=i.ref,r.return=i,i.child=r}function Ng(r,i,c,h,p){if(r!==null){var y=r.memoizedProps;if(il(y,h)&&r.ref===i.ref)if(_r=!1,i.pendingProps=h=y,(r.lanes&p)!==0)(r.flags&131072)!==0&&(_r=!0);else return i.lanes=r.lanes,ii(r,i,p)}return bh(r,i,c,h,p)}function Rg(r,i,c){var h=i.pendingProps,p=h.children,y=r!==null?r.memoizedState:null;if(h.mode==="hidden")if((i.mode&1)===0)i.memoizedState={baseLanes:0,cachePool:null,transitions:null},Vt(yo,Vr),Vr|=c;else{if((c&1073741824)===0)return r=y!==null?y.baseLanes|c:c,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:r,cachePool:null,transitions:null},i.updateQueue=null,Vt(yo,Vr),Vr|=r,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},h=y!==null?y.baseLanes:c,Vt(yo,Vr),Vr|=h}else y!==null?(h=y.baseLanes|c,i.memoizedState=null):h=c,Vt(yo,Vr),Vr|=h;return hr(r,i,p,c),i.child}function Ag(r,i){var c=i.ref;(r===null&&c!==null||r!==null&&r.ref!==c)&&(i.flags|=512,i.flags|=2097152)}function bh(r,i,c,h,p){var y=vr(c)?pa:er.current;return y=ao(i,y),fo(i,p),c=mh(r,i,c,h,y,p),h=gh(),r!==null&&!_r?(i.updateQueue=r.updateQueue,i.flags&=-2053,r.lanes&=~p,ii(r,i,p)):(Gt&&h&&Xd(i),i.flags|=1,hr(r,i,c,p),i.child)}function jg(r,i,c,h,p){if(vr(c)){var y=!0;jc(i)}else y=!1;if(fo(i,p),i.stateNode===null)Yc(r,i),wg(i,c,h),Eh(i,c,h,p),h=!0;else if(r===null){var E=i.stateNode,L=i.memoizedProps;E.props=L;var B=E.context,re=c.contextType;typeof re=="object"&&re!==null?re=Gr(re):(re=vr(c)?pa:er.current,re=ao(i,re));var Se=c.getDerivedStateFromProps,Ce=typeof Se=="function"||typeof E.getSnapshotBeforeUpdate=="function";Ce||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(L!==h||B!==re)&&xg(i,E,h,re),Pi=!1;var we=i.memoizedState;E.state=we,zc(i,h,E,p),B=i.memoizedState,L!==h||we!==B||yr.current||Pi?(typeof Se=="function"&&(xh(i,c,Se,h),B=i.memoizedState),(L=Pi||_g(i,c,L,h,we,B,re))?(Ce||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount()),typeof E.componentDidMount=="function"&&(i.flags|=4194308)):(typeof E.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=h,i.memoizedState=B),E.props=h,E.state=B,E.context=re,h=L):(typeof E.componentDidMount=="function"&&(i.flags|=4194308),h=!1)}else{E=i.stateNode,Km(r,i),L=i.memoizedProps,re=i.type===i.elementType?L:fs(i.type,L),E.props=re,Ce=i.pendingProps,we=E.context,B=c.contextType,typeof B=="object"&&B!==null?B=Gr(B):(B=vr(c)?pa:er.current,B=ao(i,B));var ze=c.getDerivedStateFromProps;(Se=typeof ze=="function"||typeof E.getSnapshotBeforeUpdate=="function")||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(L!==Ce||we!==B)&&xg(i,E,h,B),Pi=!1,we=i.memoizedState,E.state=we,zc(i,h,E,p);var We=i.memoizedState;L!==Ce||we!==We||yr.current||Pi?(typeof ze=="function"&&(xh(i,c,ze,h),We=i.memoizedState),(re=Pi||_g(i,c,re,h,we,We,B)||!1)?(Se||typeof E.UNSAFE_componentWillUpdate!="function"&&typeof E.componentWillUpdate!="function"||(typeof E.componentWillUpdate=="function"&&E.componentWillUpdate(h,We,B),typeof E.UNSAFE_componentWillUpdate=="function"&&E.UNSAFE_componentWillUpdate(h,We,B)),typeof E.componentDidUpdate=="function"&&(i.flags|=4),typeof E.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof E.componentDidUpdate!="function"||L===r.memoizedProps&&we===r.memoizedState||(i.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||L===r.memoizedProps&&we===r.memoizedState||(i.flags|=1024),i.memoizedProps=h,i.memoizedState=We),E.props=h,E.state=We,E.context=B,h=re):(typeof E.componentDidUpdate!="function"||L===r.memoizedProps&&we===r.memoizedState||(i.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||L===r.memoizedProps&&we===r.memoizedState||(i.flags|=1024),h=!1)}return Ch(r,i,c,h,y,p)}function Ch(r,i,c,h,p,y){Ag(r,i);var E=(i.flags&128)!==0;if(!h&&!E)return p&&Mm(i,c,!1),ii(r,i,y);h=i.stateNode,Yx.current=i;var L=E&&typeof c.getDerivedStateFromError!="function"?null:h.render();return i.flags|=1,r!==null&&E?(i.child=uo(i,r.child,null,y),i.child=uo(i,null,L,y)):hr(r,i,L,y),i.memoizedState=h.state,p&&Mm(i,c,!0),i.child}function kg(r){var i=r.stateNode;i.pendingContext?Lm(r,i.pendingContext,i.pendingContext!==i.context):i.context&&Lm(r,i.context,!1),ch(r,i.containerInfo)}function Dg(r,i,c,h,p){return co(),nh(p),i.flags|=256,hr(r,i,c,h),i.child}var Ih={dehydrated:null,treeContext:null,retryLane:0};function Ph(r){return{baseLanes:r,cachePool:null,transitions:null}}function Lg(r,i,c){var h=i.pendingProps,p=qt.current,y=!1,E=(i.flags&128)!==0,L;if((L=E)||(L=r!==null&&r.memoizedState===null?!1:(p&2)!==0),L?(y=!0,i.flags&=-129):(r===null||r.memoizedState!==null)&&(p|=1),Vt(qt,p&1),r===null)return th(i),r=i.memoizedState,r!==null&&(r=r.dehydrated,r!==null)?((i.mode&1)===0?i.lanes=1:r.data==="$!"?i.lanes=8:i.lanes=1073741824,null):(E=h.children,r=h.fallback,y?(h=i.mode,y=i.child,E={mode:"hidden",children:E},(h&1)===0&&y!==null?(y.childLanes=0,y.pendingProps=E):y=lu(E,h,0,null),r=Sa(r,h,c,null),y.return=i,r.return=i,y.sibling=r,i.child=y,i.child.memoizedState=Ph(c),i.memoizedState=Ih,r):Nh(i,E));if(p=r.memoizedState,p!==null&&(L=p.dehydrated,L!==null))return Jx(r,i,E,h,L,p,c);if(y){y=h.fallback,E=i.mode,p=r.child,L=p.sibling;var B={mode:"hidden",children:h.children};return(E&1)===0&&i.child!==p?(h=i.child,h.childLanes=0,h.pendingProps=B,i.deletions=null):(h=Li(p,B),h.subtreeFlags=p.subtreeFlags&14680064),L!==null?y=Li(L,y):(y=Sa(y,E,c,null),y.flags|=2),y.return=i,h.return=i,h.sibling=y,i.child=h,h=y,y=i.child,E=r.child.memoizedState,E=E===null?Ph(c):{baseLanes:E.baseLanes|c,cachePool:null,transitions:E.transitions},y.memoizedState=E,y.childLanes=r.childLanes&~c,i.memoizedState=Ih,h}return y=r.child,r=y.sibling,h=Li(y,{mode:"visible",children:h.children}),(i.mode&1)===0&&(h.lanes=c),h.return=i,h.sibling=null,r!==null&&(c=i.deletions,c===null?(i.deletions=[r],i.flags|=16):c.push(r)),i.child=h,i.memoizedState=null,h}function Nh(r,i){return i=lu({mode:"visible",children:i},r.mode,0,null),i.return=r,r.child=i}function Qc(r,i,c,h){return h!==null&&nh(h),uo(i,r.child,null,c),r=Nh(i,i.pendingProps.children),r.flags|=2,i.memoizedState=null,r}function Jx(r,i,c,h,p,y,E){if(c)return i.flags&256?(i.flags&=-257,h=Th(Error(t(422))),Qc(r,i,E,h)):i.memoizedState!==null?(i.child=r.child,i.flags|=128,null):(y=h.fallback,p=i.mode,h=lu({mode:"visible",children:h.children},p,0,null),y=Sa(y,p,E,null),y.flags|=2,h.return=i,y.return=i,h.sibling=y,i.child=h,(i.mode&1)!==0&&uo(i,r.child,null,E),i.child.memoizedState=Ph(E),i.memoizedState=Ih,y);if((i.mode&1)===0)return Qc(r,i,E,null);if(p.data==="$!"){if(h=p.nextSibling&&p.nextSibling.dataset,h)var L=h.dgst;return h=L,y=Error(t(419)),h=Th(y,h,void 0),Qc(r,i,E,h)}if(L=(E&r.childLanes)!==0,_r||L){if(h=Ln,h!==null){switch(E&-E){case 4:p=2;break;case 16:p=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:p=32;break;case 536870912:p=268435456;break;default:p=0}p=(p&(h.suspendedLanes|E))!==0?0:p,p!==0&&p!==y.retryLane&&(y.retryLane=p,ri(r,p),gs(h,r,p,-1))}return Gh(),h=Th(Error(t(421))),Qc(r,i,E,h)}return p.data==="$?"?(i.flags|=128,i.child=r.child,i=uE.bind(null,r),p._reactRetry=i,null):(r=y.treeContext,Lr=Si(p.nextSibling),Dr=i,Gt=!0,hs=null,r!==null&&($r[Wr++]=ti,$r[Wr++]=ni,$r[Wr++]=ma,ti=r.id,ni=r.overflow,ma=i),i=Nh(i,h.children),i.flags|=4096,i)}function Vg(r,i,c){r.lanes|=i;var h=r.alternate;h!==null&&(h.lanes|=i),ah(r.return,i,c)}function Rh(r,i,c,h,p){var y=r.memoizedState;y===null?r.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:h,tail:c,tailMode:p}:(y.isBackwards=i,y.rendering=null,y.renderingStartTime=0,y.last=h,y.tail=c,y.tailMode=p)}function Mg(r,i,c){var h=i.pendingProps,p=h.revealOrder,y=h.tail;if(hr(r,i,h.children,c),h=qt.current,(h&2)!==0)h=h&1|2,i.flags|=128;else{if(r!==null&&(r.flags&128)!==0)e:for(r=i.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&Vg(r,c,i);else if(r.tag===19)Vg(r,c,i);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===i)break e;for(;r.sibling===null;){if(r.return===null||r.return===i)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}h&=1}if(Vt(qt,h),(i.mode&1)===0)i.memoizedState=null;else switch(p){case"forwards":for(c=i.child,p=null;c!==null;)r=c.alternate,r!==null&&Bc(r)===null&&(p=c),c=c.sibling;c=p,c===null?(p=i.child,i.child=null):(p=c.sibling,c.sibling=null),Rh(i,!1,p,c,y);break;case"backwards":for(c=null,p=i.child,i.child=null;p!==null;){if(r=p.alternate,r!==null&&Bc(r)===null){i.child=p;break}r=p.sibling,p.sibling=c,c=p,p=r}Rh(i,!0,c,null,y);break;case"together":Rh(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function Yc(r,i){(i.mode&1)===0&&r!==null&&(r.alternate=null,i.alternate=null,i.flags|=2)}function ii(r,i,c){if(r!==null&&(i.dependencies=r.dependencies),wa|=i.lanes,(c&i.childLanes)===0)return null;if(r!==null&&i.child!==r.child)throw Error(t(153));if(i.child!==null){for(r=i.child,c=Li(r,r.pendingProps),i.child=c,c.return=i;r.sibling!==null;)r=r.sibling,c=c.sibling=Li(r,r.pendingProps),c.return=i;c.sibling=null}return i.child}function Xx(r,i,c){switch(i.tag){case 3:kg(i),co();break;case 5:Jm(i);break;case 1:vr(i.type)&&jc(i);break;case 4:ch(i,i.stateNode.containerInfo);break;case 10:var h=i.type._context,p=i.memoizedProps.value;Vt(Oc,h._currentValue),h._currentValue=p;break;case 13:if(h=i.memoizedState,h!==null)return h.dehydrated!==null?(Vt(qt,qt.current&1),i.flags|=128,null):(c&i.child.childLanes)!==0?Lg(r,i,c):(Vt(qt,qt.current&1),r=ii(r,i,c),r!==null?r.sibling:null);Vt(qt,qt.current&1);break;case 19:if(h=(c&i.childLanes)!==0,(r.flags&128)!==0){if(h)return Mg(r,i,c);i.flags|=128}if(p=i.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),Vt(qt,qt.current),h)break;return null;case 22:case 23:return i.lanes=0,Rg(r,i,c)}return ii(r,i,c)}var Og,Ah,Fg,Ug;Og=function(r,i){for(var c=i.child;c!==null;){if(c.tag===5||c.tag===6)r.appendChild(c.stateNode);else if(c.tag!==4&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===i)break;for(;c.sibling===null;){if(c.return===null||c.return===i)return;c=c.return}c.sibling.return=c.return,c=c.sibling}},Ah=function(){},Fg=function(r,i,c,h){var p=r.memoizedProps;if(p!==h){r=i.stateNode,va(ks.current);var y=null;switch(c){case"input":p=He(r,p),h=He(r,h),y=[];break;case"select":p=ve({},p,{value:void 0}),h=ve({},h,{value:void 0}),y=[];break;case"textarea":p=nn(r,p),h=nn(r,h),y=[];break;default:typeof p.onClick!="function"&&typeof h.onClick=="function"&&(r.onclick=Nc)}ts(c,h);var E;c=null;for(re in p)if(!h.hasOwnProperty(re)&&p.hasOwnProperty(re)&&p[re]!=null)if(re==="style"){var L=p[re];for(E in L)L.hasOwnProperty(E)&&(c||(c={}),c[E]="")}else re!=="dangerouslySetInnerHTML"&&re!=="children"&&re!=="suppressContentEditableWarning"&&re!=="suppressHydrationWarning"&&re!=="autoFocus"&&(a.hasOwnProperty(re)?y||(y=[]):(y=y||[]).push(re,null));for(re in h){var B=h[re];if(L=p!=null?p[re]:void 0,h.hasOwnProperty(re)&&B!==L&&(B!=null||L!=null))if(re==="style")if(L){for(E in L)!L.hasOwnProperty(E)||B&&B.hasOwnProperty(E)||(c||(c={}),c[E]="");for(E in B)B.hasOwnProperty(E)&&L[E]!==B[E]&&(c||(c={}),c[E]=B[E])}else c||(y||(y=[]),y.push(re,c)),c=B;else re==="dangerouslySetInnerHTML"?(B=B?B.__html:void 0,L=L?L.__html:void 0,B!=null&&L!==B&&(y=y||[]).push(re,B)):re==="children"?typeof B!="string"&&typeof B!="number"||(y=y||[]).push(re,""+B):re!=="suppressContentEditableWarning"&&re!=="suppressHydrationWarning"&&(a.hasOwnProperty(re)?(B!=null&&re==="onScroll"&&Ut("scroll",r),y||L===B||(y=[])):(y=y||[]).push(re,B))}c&&(y=y||[]).push("style",c);var re=y;(i.updateQueue=re)&&(i.flags|=4)}},Ug=function(r,i,c,h){c!==h&&(i.flags|=4)};function wl(r,i){if(!Gt)switch(r.tailMode){case"hidden":i=r.tail;for(var c=null;i!==null;)i.alternate!==null&&(c=i),i=i.sibling;c===null?r.tail=null:c.sibling=null;break;case"collapsed":c=r.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?i||r.tail===null?r.tail=null:r.tail.sibling=null:h.sibling=null}}function nr(r){var i=r.alternate!==null&&r.alternate.child===r.child,c=0,h=0;if(i)for(var p=r.child;p!==null;)c|=p.lanes|p.childLanes,h|=p.subtreeFlags&14680064,h|=p.flags&14680064,p.return=r,p=p.sibling;else for(p=r.child;p!==null;)c|=p.lanes|p.childLanes,h|=p.subtreeFlags,h|=p.flags,p.return=r,p=p.sibling;return r.subtreeFlags|=h,r.childLanes=c,i}function Zx(r,i,c){var h=i.pendingProps;switch(Zd(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return nr(i),null;case 1:return vr(i.type)&&Ac(),nr(i),null;case 3:return h=i.stateNode,po(),zt(yr),zt(er),hh(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(r===null||r.child===null)&&(Vc(i)?i.flags|=4:r===null||r.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,hs!==null&&(Bh(hs),hs=null))),Ah(r,i),nr(i),null;case 5:uh(i);var p=va(ml.current);if(c=i.type,r!==null&&i.stateNode!=null)Fg(r,i,c,h,p),r.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!h){if(i.stateNode===null)throw Error(t(166));return nr(i),null}if(r=va(ks.current),Vc(i)){h=i.stateNode,c=i.type;var y=i.memoizedProps;switch(h[js]=i,h[ul]=y,r=(i.mode&1)!==0,c){case"dialog":Ut("cancel",h),Ut("close",h);break;case"iframe":case"object":case"embed":Ut("load",h);break;case"video":case"audio":for(p=0;p<ol.length;p++)Ut(ol[p],h);break;case"source":Ut("error",h);break;case"img":case"image":case"link":Ut("error",h),Ut("load",h);break;case"details":Ut("toggle",h);break;case"input":Ye(h,y),Ut("invalid",h);break;case"select":h._wrapperState={wasMultiple:!!y.multiple},Ut("invalid",h);break;case"textarea":lr(h,y),Ut("invalid",h)}ts(c,y),p=null;for(var E in y)if(y.hasOwnProperty(E)){var L=y[E];E==="children"?typeof L=="string"?h.textContent!==L&&(y.suppressHydrationWarning!==!0&&Pc(h.textContent,L,r),p=["children",L]):typeof L=="number"&&h.textContent!==""+L&&(y.suppressHydrationWarning!==!0&&Pc(h.textContent,L,r),p=["children",""+L]):a.hasOwnProperty(E)&&L!=null&&E==="onScroll"&&Ut("scroll",h)}switch(c){case"input":ce(h),gt(h,y,!0);break;case"textarea":ce(h),Kn(h);break;case"select":case"option":break;default:typeof y.onClick=="function"&&(h.onclick=Nc)}h=p,i.updateQueue=h,h!==null&&(i.flags|=4)}else{E=p.nodeType===9?p:p.ownerDocument,r==="http://www.w3.org/1999/xhtml"&&(r=Ot(c)),r==="http://www.w3.org/1999/xhtml"?c==="script"?(r=E.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild)):typeof h.is=="string"?r=E.createElement(c,{is:h.is}):(r=E.createElement(c),c==="select"&&(E=r,h.multiple?E.multiple=!0:h.size&&(E.size=h.size))):r=E.createElementNS(r,c),r[js]=i,r[ul]=h,Og(r,i,!1,!1),i.stateNode=r;e:{switch(E=Ts(c,h),c){case"dialog":Ut("cancel",r),Ut("close",r),p=h;break;case"iframe":case"object":case"embed":Ut("load",r),p=h;break;case"video":case"audio":for(p=0;p<ol.length;p++)Ut(ol[p],r);p=h;break;case"source":Ut("error",r),p=h;break;case"img":case"image":case"link":Ut("error",r),Ut("load",r),p=h;break;case"details":Ut("toggle",r),p=h;break;case"input":Ye(r,h),p=He(r,h),Ut("invalid",r);break;case"option":p=h;break;case"select":r._wrapperState={wasMultiple:!!h.multiple},p=ve({},h,{value:void 0}),Ut("invalid",r);break;case"textarea":lr(r,h),p=nn(r,h),Ut("invalid",r);break;default:p=h}ts(c,p),L=p;for(y in L)if(L.hasOwnProperty(y)){var B=L[y];y==="style"?In(r,B):y==="dangerouslySetInnerHTML"?(B=B?B.__html:void 0,B!=null&&cr(r,B)):y==="children"?typeof B=="string"?(c!=="textarea"||B!=="")&&Cn(r,B):typeof B=="number"&&Cn(r,""+B):y!=="suppressContentEditableWarning"&&y!=="suppressHydrationWarning"&&y!=="autoFocus"&&(a.hasOwnProperty(y)?B!=null&&y==="onScroll"&&Ut("scroll",r):B!=null&&xe(r,y,B,E))}switch(c){case"input":ce(r),gt(r,h,!1);break;case"textarea":ce(r),Kn(r);break;case"option":h.value!=null&&r.setAttribute("value",""+Qe(h.value));break;case"select":r.multiple=!!h.multiple,y=h.value,y!=null?tn(r,!!h.multiple,y,!1):h.defaultValue!=null&&tn(r,!!h.multiple,h.defaultValue,!0);break;default:typeof p.onClick=="function"&&(r.onclick=Nc)}switch(c){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}}h&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return nr(i),null;case 6:if(r&&i.stateNode!=null)Ug(r,i,r.memoizedProps,h);else{if(typeof h!="string"&&i.stateNode===null)throw Error(t(166));if(c=va(ml.current),va(ks.current),Vc(i)){if(h=i.stateNode,c=i.memoizedProps,h[js]=i,(y=h.nodeValue!==c)&&(r=Dr,r!==null))switch(r.tag){case 3:Pc(h.nodeValue,c,(r.mode&1)!==0);break;case 5:r.memoizedProps.suppressHydrationWarning!==!0&&Pc(h.nodeValue,c,(r.mode&1)!==0)}y&&(i.flags|=4)}else h=(c.nodeType===9?c:c.ownerDocument).createTextNode(h),h[js]=i,i.stateNode=h}return nr(i),null;case 13:if(zt(qt),h=i.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(Gt&&Lr!==null&&(i.mode&1)!==0&&(i.flags&128)===0)$m(),co(),i.flags|=98560,y=!1;else if(y=Vc(i),h!==null&&h.dehydrated!==null){if(r===null){if(!y)throw Error(t(318));if(y=i.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(t(317));y[js]=i}else co(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;nr(i),y=!1}else hs!==null&&(Bh(hs),hs=null),y=!0;if(!y)return i.flags&65536?i:null}return(i.flags&128)!==0?(i.lanes=c,i):(h=h!==null,h!==(r!==null&&r.memoizedState!==null)&&h&&(i.child.flags|=8192,(i.mode&1)!==0&&(r===null||(qt.current&1)!==0?Tn===0&&(Tn=3):Gh())),i.updateQueue!==null&&(i.flags|=4),nr(i),null);case 4:return po(),Ah(r,i),r===null&&ll(i.stateNode.containerInfo),nr(i),null;case 10:return ih(i.type._context),nr(i),null;case 17:return vr(i.type)&&Ac(),nr(i),null;case 19:if(zt(qt),y=i.memoizedState,y===null)return nr(i),null;if(h=(i.flags&128)!==0,E=y.rendering,E===null)if(h)wl(y,!1);else{if(Tn!==0||r!==null&&(r.flags&128)!==0)for(r=i.child;r!==null;){if(E=Bc(r),E!==null){for(i.flags|=128,wl(y,!1),h=E.updateQueue,h!==null&&(i.updateQueue=h,i.flags|=4),i.subtreeFlags=0,h=c,c=i.child;c!==null;)y=c,r=h,y.flags&=14680066,E=y.alternate,E===null?(y.childLanes=0,y.lanes=r,y.child=null,y.subtreeFlags=0,y.memoizedProps=null,y.memoizedState=null,y.updateQueue=null,y.dependencies=null,y.stateNode=null):(y.childLanes=E.childLanes,y.lanes=E.lanes,y.child=E.child,y.subtreeFlags=0,y.deletions=null,y.memoizedProps=E.memoizedProps,y.memoizedState=E.memoizedState,y.updateQueue=E.updateQueue,y.type=E.type,r=E.dependencies,y.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),c=c.sibling;return Vt(qt,qt.current&1|2),i.child}r=r.sibling}y.tail!==null&&ht()>vo&&(i.flags|=128,h=!0,wl(y,!1),i.lanes=4194304)}else{if(!h)if(r=Bc(E),r!==null){if(i.flags|=128,h=!0,c=r.updateQueue,c!==null&&(i.updateQueue=c,i.flags|=4),wl(y,!0),y.tail===null&&y.tailMode==="hidden"&&!E.alternate&&!Gt)return nr(i),null}else 2*ht()-y.renderingStartTime>vo&&c!==1073741824&&(i.flags|=128,h=!0,wl(y,!1),i.lanes=4194304);y.isBackwards?(E.sibling=i.child,i.child=E):(c=y.last,c!==null?c.sibling=E:i.child=E,y.last=E)}return y.tail!==null?(i=y.tail,y.rendering=i,y.tail=i.sibling,y.renderingStartTime=ht(),i.sibling=null,c=qt.current,Vt(qt,h?c&1|2:c&1),i):(nr(i),null);case 22:case 23:return Wh(),h=i.memoizedState!==null,r!==null&&r.memoizedState!==null!==h&&(i.flags|=8192),h&&(i.mode&1)!==0?(Vr&1073741824)!==0&&(nr(i),i.subtreeFlags&6&&(i.flags|=8192)):nr(i),null;case 24:return null;case 25:return null}throw Error(t(156,i.tag))}function eE(r,i){switch(Zd(i),i.tag){case 1:return vr(i.type)&&Ac(),r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 3:return po(),zt(yr),zt(er),hh(),r=i.flags,(r&65536)!==0&&(r&128)===0?(i.flags=r&-65537|128,i):null;case 5:return uh(i),null;case 13:if(zt(qt),r=i.memoizedState,r!==null&&r.dehydrated!==null){if(i.alternate===null)throw Error(t(340));co()}return r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 19:return zt(qt),null;case 4:return po(),null;case 10:return ih(i.type._context),null;case 22:case 23:return Wh(),null;case 24:return null;default:return null}}var Jc=!1,rr=!1,tE=typeof WeakSet=="function"?WeakSet:Set,$e=null;function go(r,i){var c=r.ref;if(c!==null)if(typeof c=="function")try{c(null)}catch(h){Xt(r,i,h)}else c.current=null}function jh(r,i,c){try{c()}catch(h){Xt(r,i,h)}}var zg=!1;function nE(r,i){if(Wd=xi,r=_m(),Vd(r)){if("selectionStart"in r)var c={start:r.selectionStart,end:r.selectionEnd};else e:{c=(c=r.ownerDocument)&&c.defaultView||window;var h=c.getSelection&&c.getSelection();if(h&&h.rangeCount!==0){c=h.anchorNode;var p=h.anchorOffset,y=h.focusNode;h=h.focusOffset;try{c.nodeType,y.nodeType}catch{c=null;break e}var E=0,L=-1,B=-1,re=0,Se=0,Ce=r,we=null;t:for(;;){for(var ze;Ce!==c||p!==0&&Ce.nodeType!==3||(L=E+p),Ce!==y||h!==0&&Ce.nodeType!==3||(B=E+h),Ce.nodeType===3&&(E+=Ce.nodeValue.length),(ze=Ce.firstChild)!==null;)we=Ce,Ce=ze;for(;;){if(Ce===r)break t;if(we===c&&++re===p&&(L=E),we===y&&++Se===h&&(B=E),(ze=Ce.nextSibling)!==null)break;Ce=we,we=Ce.parentNode}Ce=ze}c=L===-1||B===-1?null:{start:L,end:B}}else c=null}c=c||{start:0,end:0}}else c=null;for(Gd={focusedElem:r,selectionRange:c},xi=!1,$e=i;$e!==null;)if(i=$e,r=i.child,(i.subtreeFlags&1028)!==0&&r!==null)r.return=i,$e=r;else for(;$e!==null;){i=$e;try{var We=i.alternate;if((i.flags&1024)!==0)switch(i.tag){case 0:case 11:case 15:break;case 1:if(We!==null){var qe=We.memoizedProps,on=We.memoizedState,ee=i.stateNode,K=ee.getSnapshotBeforeUpdate(i.elementType===i.type?qe:fs(i.type,qe),on);ee.__reactInternalSnapshotBeforeUpdate=K}break;case 3:var te=i.stateNode.containerInfo;te.nodeType===1?te.textContent="":te.nodeType===9&&te.documentElement&&te.removeChild(te.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(ke){Xt(i,i.return,ke)}if(r=i.sibling,r!==null){r.return=i.return,$e=r;break}$e=i.return}return We=zg,zg=!1,We}function xl(r,i,c){var h=i.updateQueue;if(h=h!==null?h.lastEffect:null,h!==null){var p=h=h.next;do{if((p.tag&r)===r){var y=p.destroy;p.destroy=void 0,y!==void 0&&jh(i,c,y)}p=p.next}while(p!==h)}}function Xc(r,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var c=i=i.next;do{if((c.tag&r)===r){var h=c.create;c.destroy=h()}c=c.next}while(c!==i)}}function kh(r){var i=r.ref;if(i!==null){var c=r.stateNode;switch(r.tag){case 5:r=c;break;default:r=c}typeof i=="function"?i(r):i.current=r}}function Bg(r){var i=r.alternate;i!==null&&(r.alternate=null,Bg(i)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(i=r.stateNode,i!==null&&(delete i[js],delete i[ul],delete i[Qd],delete i[Ox],delete i[Fx])),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}function $g(r){return r.tag===5||r.tag===3||r.tag===4}function Wg(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||$g(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Dh(r,i,c){var h=r.tag;if(h===5||h===6)r=r.stateNode,i?c.nodeType===8?c.parentNode.insertBefore(r,i):c.insertBefore(r,i):(c.nodeType===8?(i=c.parentNode,i.insertBefore(r,c)):(i=c,i.appendChild(r)),c=c._reactRootContainer,c!=null||i.onclick!==null||(i.onclick=Nc));else if(h!==4&&(r=r.child,r!==null))for(Dh(r,i,c),r=r.sibling;r!==null;)Dh(r,i,c),r=r.sibling}function Lh(r,i,c){var h=r.tag;if(h===5||h===6)r=r.stateNode,i?c.insertBefore(r,i):c.appendChild(r);else if(h!==4&&(r=r.child,r!==null))for(Lh(r,i,c),r=r.sibling;r!==null;)Lh(r,i,c),r=r.sibling}var $n=null,ps=!1;function Ri(r,i,c){for(c=c.child;c!==null;)Gg(r,i,c),c=c.sibling}function Gg(r,i,c){if(ue&&typeof ue.onCommitFiberUnmount=="function")try{ue.onCommitFiberUnmount(H,c)}catch{}switch(c.tag){case 5:rr||go(c,i);case 6:var h=$n,p=ps;$n=null,Ri(r,i,c),$n=h,ps=p,$n!==null&&(ps?(r=$n,c=c.stateNode,r.nodeType===8?r.parentNode.removeChild(c):r.removeChild(c)):$n.removeChild(c.stateNode));break;case 18:$n!==null&&(ps?(r=$n,c=c.stateNode,r.nodeType===8?Kd(r.parentNode,c):r.nodeType===1&&Kd(r,c),zn(r)):Kd($n,c.stateNode));break;case 4:h=$n,p=ps,$n=c.stateNode.containerInfo,ps=!0,Ri(r,i,c),$n=h,ps=p;break;case 0:case 11:case 14:case 15:if(!rr&&(h=c.updateQueue,h!==null&&(h=h.lastEffect,h!==null))){p=h=h.next;do{var y=p,E=y.destroy;y=y.tag,E!==void 0&&((y&2)!==0||(y&4)!==0)&&jh(c,i,E),p=p.next}while(p!==h)}Ri(r,i,c);break;case 1:if(!rr&&(go(c,i),h=c.stateNode,typeof h.componentWillUnmount=="function"))try{h.props=c.memoizedProps,h.state=c.memoizedState,h.componentWillUnmount()}catch(L){Xt(c,i,L)}Ri(r,i,c);break;case 21:Ri(r,i,c);break;case 22:c.mode&1?(rr=(h=rr)||c.memoizedState!==null,Ri(r,i,c),rr=h):Ri(r,i,c);break;default:Ri(r,i,c)}}function qg(r){var i=r.updateQueue;if(i!==null){r.updateQueue=null;var c=r.stateNode;c===null&&(c=r.stateNode=new tE),i.forEach(function(h){var p=dE.bind(null,r,h);c.has(h)||(c.add(h),h.then(p,p))})}}function ms(r,i){var c=i.deletions;if(c!==null)for(var h=0;h<c.length;h++){var p=c[h];try{var y=r,E=i,L=E;e:for(;L!==null;){switch(L.tag){case 5:$n=L.stateNode,ps=!1;break e;case 3:$n=L.stateNode.containerInfo,ps=!0;break e;case 4:$n=L.stateNode.containerInfo,ps=!0;break e}L=L.return}if($n===null)throw Error(t(160));Gg(y,E,p),$n=null,ps=!1;var B=p.alternate;B!==null&&(B.return=null),p.return=null}catch(re){Xt(p,i,re)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)Hg(i,r),i=i.sibling}function Hg(r,i){var c=r.alternate,h=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:if(ms(i,r),Ls(r),h&4){try{xl(3,r,r.return),Xc(3,r)}catch(qe){Xt(r,r.return,qe)}try{xl(5,r,r.return)}catch(qe){Xt(r,r.return,qe)}}break;case 1:ms(i,r),Ls(r),h&512&&c!==null&&go(c,c.return);break;case 5:if(ms(i,r),Ls(r),h&512&&c!==null&&go(c,c.return),r.flags&32){var p=r.stateNode;try{Cn(p,"")}catch(qe){Xt(r,r.return,qe)}}if(h&4&&(p=r.stateNode,p!=null)){var y=r.memoizedProps,E=c!==null?c.memoizedProps:y,L=r.type,B=r.updateQueue;if(r.updateQueue=null,B!==null)try{L==="input"&&y.type==="radio"&&y.name!=null&&Tt(p,y),Ts(L,E);var re=Ts(L,y);for(E=0;E<B.length;E+=2){var Se=B[E],Ce=B[E+1];Se==="style"?In(p,Ce):Se==="dangerouslySetInnerHTML"?cr(p,Ce):Se==="children"?Cn(p,Ce):xe(p,Se,Ce,re)}switch(L){case"input":Ct(p,y);break;case"textarea":rn(p,y);break;case"select":var we=p._wrapperState.wasMultiple;p._wrapperState.wasMultiple=!!y.multiple;var ze=y.value;ze!=null?tn(p,!!y.multiple,ze,!1):we!==!!y.multiple&&(y.defaultValue!=null?tn(p,!!y.multiple,y.defaultValue,!0):tn(p,!!y.multiple,y.multiple?[]:"",!1))}p[ul]=y}catch(qe){Xt(r,r.return,qe)}}break;case 6:if(ms(i,r),Ls(r),h&4){if(r.stateNode===null)throw Error(t(162));p=r.stateNode,y=r.memoizedProps;try{p.nodeValue=y}catch(qe){Xt(r,r.return,qe)}}break;case 3:if(ms(i,r),Ls(r),h&4&&c!==null&&c.memoizedState.isDehydrated)try{zn(i.containerInfo)}catch(qe){Xt(r,r.return,qe)}break;case 4:ms(i,r),Ls(r);break;case 13:ms(i,r),Ls(r),p=r.child,p.flags&8192&&(y=p.memoizedState!==null,p.stateNode.isHidden=y,!y||p.alternate!==null&&p.alternate.memoizedState!==null||(Oh=ht())),h&4&&qg(r);break;case 22:if(Se=c!==null&&c.memoizedState!==null,r.mode&1?(rr=(re=rr)||Se,ms(i,r),rr=re):ms(i,r),Ls(r),h&8192){if(re=r.memoizedState!==null,(r.stateNode.isHidden=re)&&!Se&&(r.mode&1)!==0)for($e=r,Se=r.child;Se!==null;){for(Ce=$e=Se;$e!==null;){switch(we=$e,ze=we.child,we.tag){case 0:case 11:case 14:case 15:xl(4,we,we.return);break;case 1:go(we,we.return);var We=we.stateNode;if(typeof We.componentWillUnmount=="function"){h=we,c=we.return;try{i=h,We.props=i.memoizedProps,We.state=i.memoizedState,We.componentWillUnmount()}catch(qe){Xt(h,c,qe)}}break;case 5:go(we,we.return);break;case 22:if(we.memoizedState!==null){Yg(Ce);continue}}ze!==null?(ze.return=we,$e=ze):Yg(Ce)}Se=Se.sibling}e:for(Se=null,Ce=r;;){if(Ce.tag===5){if(Se===null){Se=Ce;try{p=Ce.stateNode,re?(y=p.style,typeof y.setProperty=="function"?y.setProperty("display","none","important"):y.display="none"):(L=Ce.stateNode,B=Ce.memoizedProps.style,E=B!=null&&B.hasOwnProperty("display")?B.display:null,L.style.display=es("display",E))}catch(qe){Xt(r,r.return,qe)}}}else if(Ce.tag===6){if(Se===null)try{Ce.stateNode.nodeValue=re?"":Ce.memoizedProps}catch(qe){Xt(r,r.return,qe)}}else if((Ce.tag!==22&&Ce.tag!==23||Ce.memoizedState===null||Ce===r)&&Ce.child!==null){Ce.child.return=Ce,Ce=Ce.child;continue}if(Ce===r)break e;for(;Ce.sibling===null;){if(Ce.return===null||Ce.return===r)break e;Se===Ce&&(Se=null),Ce=Ce.return}Se===Ce&&(Se=null),Ce.sibling.return=Ce.return,Ce=Ce.sibling}}break;case 19:ms(i,r),Ls(r),h&4&&qg(r);break;case 21:break;default:ms(i,r),Ls(r)}}function Ls(r){var i=r.flags;if(i&2){try{e:{for(var c=r.return;c!==null;){if($g(c)){var h=c;break e}c=c.return}throw Error(t(160))}switch(h.tag){case 5:var p=h.stateNode;h.flags&32&&(Cn(p,""),h.flags&=-33);var y=Wg(r);Lh(r,y,p);break;case 3:case 4:var E=h.stateNode.containerInfo,L=Wg(r);Dh(r,L,E);break;default:throw Error(t(161))}}catch(B){Xt(r,r.return,B)}r.flags&=-3}i&4096&&(r.flags&=-4097)}function rE(r,i,c){$e=r,Kg(r)}function Kg(r,i,c){for(var h=(r.mode&1)!==0;$e!==null;){var p=$e,y=p.child;if(p.tag===22&&h){var E=p.memoizedState!==null||Jc;if(!E){var L=p.alternate,B=L!==null&&L.memoizedState!==null||rr;L=Jc;var re=rr;if(Jc=E,(rr=B)&&!re)for($e=p;$e!==null;)E=$e,B=E.child,E.tag===22&&E.memoizedState!==null?Jg(p):B!==null?(B.return=E,$e=B):Jg(p);for(;y!==null;)$e=y,Kg(y),y=y.sibling;$e=p,Jc=L,rr=re}Qg(r)}else(p.subtreeFlags&8772)!==0&&y!==null?(y.return=p,$e=y):Qg(r)}}function Qg(r){for(;$e!==null;){var i=$e;if((i.flags&8772)!==0){var c=i.alternate;try{if((i.flags&8772)!==0)switch(i.tag){case 0:case 11:case 15:rr||Xc(5,i);break;case 1:var h=i.stateNode;if(i.flags&4&&!rr)if(c===null)h.componentDidMount();else{var p=i.elementType===i.type?c.memoizedProps:fs(i.type,c.memoizedProps);h.componentDidUpdate(p,c.memoizedState,h.__reactInternalSnapshotBeforeUpdate)}var y=i.updateQueue;y!==null&&Ym(i,y,h);break;case 3:var E=i.updateQueue;if(E!==null){if(c=null,i.child!==null)switch(i.child.tag){case 5:c=i.child.stateNode;break;case 1:c=i.child.stateNode}Ym(i,E,c)}break;case 5:var L=i.stateNode;if(c===null&&i.flags&4){c=L;var B=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":B.autoFocus&&c.focus();break;case"img":B.src&&(c.src=B.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var re=i.alternate;if(re!==null){var Se=re.memoizedState;if(Se!==null){var Ce=Se.dehydrated;Ce!==null&&zn(Ce)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}rr||i.flags&512&&kh(i)}catch(we){Xt(i,i.return,we)}}if(i===r){$e=null;break}if(c=i.sibling,c!==null){c.return=i.return,$e=c;break}$e=i.return}}function Yg(r){for(;$e!==null;){var i=$e;if(i===r){$e=null;break}var c=i.sibling;if(c!==null){c.return=i.return,$e=c;break}$e=i.return}}function Jg(r){for(;$e!==null;){var i=$e;try{switch(i.tag){case 0:case 11:case 15:var c=i.return;try{Xc(4,i)}catch(B){Xt(i,c,B)}break;case 1:var h=i.stateNode;if(typeof h.componentDidMount=="function"){var p=i.return;try{h.componentDidMount()}catch(B){Xt(i,p,B)}}var y=i.return;try{kh(i)}catch(B){Xt(i,y,B)}break;case 5:var E=i.return;try{kh(i)}catch(B){Xt(i,E,B)}}}catch(B){Xt(i,i.return,B)}if(i===r){$e=null;break}var L=i.sibling;if(L!==null){L.return=i.return,$e=L;break}$e=i.return}}var sE=Math.ceil,Zc=_e.ReactCurrentDispatcher,Vh=_e.ReactCurrentOwner,Hr=_e.ReactCurrentBatchConfig,bt=0,Ln=null,hn=null,Wn=0,Vr=0,yo=bi(0),Tn=0,El=null,wa=0,eu=0,Mh=0,Tl=null,wr=null,Oh=0,vo=1/0,ai=null,tu=!1,Fh=null,Ai=null,nu=!1,ji=null,ru=0,Sl=0,Uh=null,su=-1,iu=0;function fr(){return(bt&6)!==0?ht():su!==-1?su:su=ht()}function ki(r){return(r.mode&1)===0?1:(bt&2)!==0&&Wn!==0?Wn&-Wn:zx.transition!==null?(iu===0&&(iu=as()),iu):(r=pt,r!==0||(r=window.event,r=r===void 0?16:Xo(r.type)),r)}function gs(r,i,c,h){if(50<Sl)throw Sl=0,Uh=null,Error(t(185));ls(r,c,h),((bt&2)===0||r!==Ln)&&(r===Ln&&((bt&2)===0&&(eu|=c),Tn===4&&Di(r,Wn)),xr(r,h),c===1&&bt===0&&(i.mode&1)===0&&(vo=ht()+500,kc&&Ii()))}function xr(r,i){var c=r.callbackNode;_n(r,i);var h=ur(r,r===Ln?Wn:0);if(h===0)c!==null&&vn(c),r.callbackNode=null,r.callbackPriority=0;else if(i=h&-h,r.callbackPriority!==i){if(c!=null&&vn(c),i===1)r.tag===0?Ux(Zg.bind(null,r)):Om(Zg.bind(null,r)),Vx(function(){(bt&6)===0&&Ii()}),c=null;else{switch(Ps(h)){case 1:c=jn;break;case 4:c=x;break;case 16:c=W;break;case 536870912:c=F;break;default:c=W}c=oy(c,Xg.bind(null,r))}r.callbackPriority=i,r.callbackNode=c}}function Xg(r,i){if(su=-1,iu=0,(bt&6)!==0)throw Error(t(327));var c=r.callbackNode;if(_o()&&r.callbackNode!==c)return null;var h=ur(r,r===Ln?Wn:0);if(h===0)return null;if((h&30)!==0||(h&r.expiredLanes)!==0||i)i=au(r,h);else{i=h;var p=bt;bt|=2;var y=ty();(Ln!==r||Wn!==i)&&(ai=null,vo=ht()+500,Ea(r,i));do try{oE();break}catch(L){ey(r,L)}while(!0);sh(),Zc.current=y,bt=p,hn!==null?i=0:(Ln=null,Wn=0,i=Tn)}if(i!==0){if(i===2&&(p=Jt(r),p!==0&&(h=p,i=zh(r,p))),i===1)throw c=El,Ea(r,0),Di(r,h),xr(r,ht()),c;if(i===6)Di(r,h);else{if(p=r.current.alternate,(h&30)===0&&!iE(p)&&(i=au(r,h),i===2&&(y=Jt(r),y!==0&&(h=y,i=zh(r,y))),i===1))throw c=El,Ea(r,0),Di(r,h),xr(r,ht()),c;switch(r.finishedWork=p,r.finishedLanes=h,i){case 0:case 1:throw Error(t(345));case 2:Ta(r,wr,ai);break;case 3:if(Di(r,h),(h&130023424)===h&&(i=Oh+500-ht(),10<i)){if(ur(r,0)!==0)break;if(p=r.suspendedLanes,(p&h)!==h){fr(),r.pingedLanes|=r.suspendedLanes&p;break}r.timeoutHandle=Hd(Ta.bind(null,r,wr,ai),i);break}Ta(r,wr,ai);break;case 4:if(Di(r,h),(h&4194240)===h)break;for(i=r.eventTimes,p=-1;0<h;){var E=31-Ae(h);y=1<<E,E=i[E],E>p&&(p=E),h&=~y}if(h=p,h=ht()-h,h=(120>h?120:480>h?480:1080>h?1080:1920>h?1920:3e3>h?3e3:4320>h?4320:1960*sE(h/1960))-h,10<h){r.timeoutHandle=Hd(Ta.bind(null,r,wr,ai),h);break}Ta(r,wr,ai);break;case 5:Ta(r,wr,ai);break;default:throw Error(t(329))}}}return xr(r,ht()),r.callbackNode===c?Xg.bind(null,r):null}function zh(r,i){var c=Tl;return r.current.memoizedState.isDehydrated&&(Ea(r,i).flags|=256),r=au(r,i),r!==2&&(i=wr,wr=c,i!==null&&Bh(i)),r}function Bh(r){wr===null?wr=r:wr.push.apply(wr,r)}function iE(r){for(var i=r;;){if(i.flags&16384){var c=i.updateQueue;if(c!==null&&(c=c.stores,c!==null))for(var h=0;h<c.length;h++){var p=c[h],y=p.getSnapshot;p=p.value;try{if(!ds(y(),p))return!1}catch{return!1}}}if(c=i.child,i.subtreeFlags&16384&&c!==null)c.return=i,i=c;else{if(i===r)break;for(;i.sibling===null;){if(i.return===null||i.return===r)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Di(r,i){for(i&=~Mh,i&=~eu,r.suspendedLanes|=i,r.pingedLanes&=~i,r=r.expirationTimes;0<i;){var c=31-Ae(i),h=1<<c;r[c]=-1,i&=~h}}function Zg(r){if((bt&6)!==0)throw Error(t(327));_o();var i=ur(r,0);if((i&1)===0)return xr(r,ht()),null;var c=au(r,i);if(r.tag!==0&&c===2){var h=Jt(r);h!==0&&(i=h,c=zh(r,h))}if(c===1)throw c=El,Ea(r,0),Di(r,i),xr(r,ht()),c;if(c===6)throw Error(t(345));return r.finishedWork=r.current.alternate,r.finishedLanes=i,Ta(r,wr,ai),xr(r,ht()),null}function $h(r,i){var c=bt;bt|=1;try{return r(i)}finally{bt=c,bt===0&&(vo=ht()+500,kc&&Ii())}}function xa(r){ji!==null&&ji.tag===0&&(bt&6)===0&&_o();var i=bt;bt|=1;var c=Hr.transition,h=pt;try{if(Hr.transition=null,pt=1,r)return r()}finally{pt=h,Hr.transition=c,bt=i,(bt&6)===0&&Ii()}}function Wh(){Vr=yo.current,zt(yo)}function Ea(r,i){r.finishedWork=null,r.finishedLanes=0;var c=r.timeoutHandle;if(c!==-1&&(r.timeoutHandle=-1,Lx(c)),hn!==null)for(c=hn.return;c!==null;){var h=c;switch(Zd(h),h.tag){case 1:h=h.type.childContextTypes,h!=null&&Ac();break;case 3:po(),zt(yr),zt(er),hh();break;case 5:uh(h);break;case 4:po();break;case 13:zt(qt);break;case 19:zt(qt);break;case 10:ih(h.type._context);break;case 22:case 23:Wh()}c=c.return}if(Ln=r,hn=r=Li(r.current,null),Wn=Vr=i,Tn=0,El=null,Mh=eu=wa=0,wr=Tl=null,ya!==null){for(i=0;i<ya.length;i++)if(c=ya[i],h=c.interleaved,h!==null){c.interleaved=null;var p=h.next,y=c.pending;if(y!==null){var E=y.next;y.next=p,h.next=E}c.pending=h}ya=null}return r}function ey(r,i){do{var c=hn;try{if(sh(),$c.current=Hc,Wc){for(var h=Ht.memoizedState;h!==null;){var p=h.queue;p!==null&&(p.pending=null),h=h.next}Wc=!1}if(_a=0,Dn=En=Ht=null,gl=!1,yl=0,Vh.current=null,c===null||c.return===null){Tn=1,El=i,hn=null;break}e:{var y=r,E=c.return,L=c,B=i;if(i=Wn,L.flags|=32768,B!==null&&typeof B=="object"&&typeof B.then=="function"){var re=B,Se=L,Ce=Se.tag;if((Se.mode&1)===0&&(Ce===0||Ce===11||Ce===15)){var we=Se.alternate;we?(Se.updateQueue=we.updateQueue,Se.memoizedState=we.memoizedState,Se.lanes=we.lanes):(Se.updateQueue=null,Se.memoizedState=null)}var ze=bg(E);if(ze!==null){ze.flags&=-257,Cg(ze,E,L,y,i),ze.mode&1&&Sg(y,re,i),i=ze,B=re;var We=i.updateQueue;if(We===null){var qe=new Set;qe.add(B),i.updateQueue=qe}else We.add(B);break e}else{if((i&1)===0){Sg(y,re,i),Gh();break e}B=Error(t(426))}}else if(Gt&&L.mode&1){var on=bg(E);if(on!==null){(on.flags&65536)===0&&(on.flags|=256),Cg(on,E,L,y,i),nh(mo(B,L));break e}}y=B=mo(B,L),Tn!==4&&(Tn=2),Tl===null?Tl=[y]:Tl.push(y),y=E;do{switch(y.tag){case 3:y.flags|=65536,i&=-i,y.lanes|=i;var ee=Eg(y,B,i);Qm(y,ee);break e;case 1:L=B;var K=y.type,te=y.stateNode;if((y.flags&128)===0&&(typeof K.getDerivedStateFromError=="function"||te!==null&&typeof te.componentDidCatch=="function"&&(Ai===null||!Ai.has(te)))){y.flags|=65536,i&=-i,y.lanes|=i;var ke=Tg(y,L,i);Qm(y,ke);break e}}y=y.return}while(y!==null)}ry(c)}catch(Ke){i=Ke,hn===c&&c!==null&&(hn=c=c.return);continue}break}while(!0)}function ty(){var r=Zc.current;return Zc.current=Hc,r===null?Hc:r}function Gh(){(Tn===0||Tn===3||Tn===2)&&(Tn=4),Ln===null||(wa&268435455)===0&&(eu&268435455)===0||Di(Ln,Wn)}function au(r,i){var c=bt;bt|=2;var h=ty();(Ln!==r||Wn!==i)&&(ai=null,Ea(r,i));do try{aE();break}catch(p){ey(r,p)}while(!0);if(sh(),bt=c,Zc.current=h,hn!==null)throw Error(t(261));return Ln=null,Wn=0,Tn}function aE(){for(;hn!==null;)ny(hn)}function oE(){for(;hn!==null&&!Hs();)ny(hn)}function ny(r){var i=ay(r.alternate,r,Vr);r.memoizedProps=r.pendingProps,i===null?ry(r):hn=i,Vh.current=null}function ry(r){var i=r;do{var c=i.alternate;if(r=i.return,(i.flags&32768)===0){if(c=Zx(c,i,Vr),c!==null){hn=c;return}}else{if(c=eE(c,i),c!==null){c.flags&=32767,hn=c;return}if(r!==null)r.flags|=32768,r.subtreeFlags=0,r.deletions=null;else{Tn=6,hn=null;return}}if(i=i.sibling,i!==null){hn=i;return}hn=i=r}while(i!==null);Tn===0&&(Tn=5)}function Ta(r,i,c){var h=pt,p=Hr.transition;try{Hr.transition=null,pt=1,lE(r,i,c,h)}finally{Hr.transition=p,pt=h}return null}function lE(r,i,c,h){do _o();while(ji!==null);if((bt&6)!==0)throw Error(t(327));c=r.finishedWork;var p=r.finishedLanes;if(c===null)return null;if(r.finishedWork=null,r.finishedLanes=0,c===r.current)throw Error(t(177));r.callbackNode=null,r.callbackPriority=0;var y=c.lanes|c.childLanes;if(Rt(r,y),r===Ln&&(hn=Ln=null,Wn=0),(c.subtreeFlags&2064)===0&&(c.flags&2064)===0||nu||(nu=!0,oy(W,function(){return _o(),null})),y=(c.flags&15990)!==0,(c.subtreeFlags&15990)!==0||y){y=Hr.transition,Hr.transition=null;var E=pt;pt=1;var L=bt;bt|=4,Vh.current=null,nE(r,c),Hg(c,r),Px(Gd),xi=!!Wd,Gd=Wd=null,r.current=c,rE(c),Ks(),bt=L,pt=E,Hr.transition=y}else r.current=c;if(nu&&(nu=!1,ji=r,ru=p),y=r.pendingLanes,y===0&&(Ai=null),oe(c.stateNode),xr(r,ht()),i!==null)for(h=r.onRecoverableError,c=0;c<i.length;c++)p=i[c],h(p.value,{componentStack:p.stack,digest:p.digest});if(tu)throw tu=!1,r=Fh,Fh=null,r;return(ru&1)!==0&&r.tag!==0&&_o(),y=r.pendingLanes,(y&1)!==0?r===Uh?Sl++:(Sl=0,Uh=r):Sl=0,Ii(),null}function _o(){if(ji!==null){var r=Ps(ru),i=Hr.transition,c=pt;try{if(Hr.transition=null,pt=16>r?16:r,ji===null)var h=!1;else{if(r=ji,ji=null,ru=0,(bt&6)!==0)throw Error(t(331));var p=bt;for(bt|=4,$e=r.current;$e!==null;){var y=$e,E=y.child;if(($e.flags&16)!==0){var L=y.deletions;if(L!==null){for(var B=0;B<L.length;B++){var re=L[B];for($e=re;$e!==null;){var Se=$e;switch(Se.tag){case 0:case 11:case 15:xl(8,Se,y)}var Ce=Se.child;if(Ce!==null)Ce.return=Se,$e=Ce;else for(;$e!==null;){Se=$e;var we=Se.sibling,ze=Se.return;if(Bg(Se),Se===re){$e=null;break}if(we!==null){we.return=ze,$e=we;break}$e=ze}}}var We=y.alternate;if(We!==null){var qe=We.child;if(qe!==null){We.child=null;do{var on=qe.sibling;qe.sibling=null,qe=on}while(qe!==null)}}$e=y}}if((y.subtreeFlags&2064)!==0&&E!==null)E.return=y,$e=E;else e:for(;$e!==null;){if(y=$e,(y.flags&2048)!==0)switch(y.tag){case 0:case 11:case 15:xl(9,y,y.return)}var ee=y.sibling;if(ee!==null){ee.return=y.return,$e=ee;break e}$e=y.return}}var K=r.current;for($e=K;$e!==null;){E=$e;var te=E.child;if((E.subtreeFlags&2064)!==0&&te!==null)te.return=E,$e=te;else e:for(E=K;$e!==null;){if(L=$e,(L.flags&2048)!==0)try{switch(L.tag){case 0:case 11:case 15:Xc(9,L)}}catch(Ke){Xt(L,L.return,Ke)}if(L===E){$e=null;break e}var ke=L.sibling;if(ke!==null){ke.return=L.return,$e=ke;break e}$e=L.return}}if(bt=p,Ii(),ue&&typeof ue.onPostCommitFiberRoot=="function")try{ue.onPostCommitFiberRoot(H,r)}catch{}h=!0}return h}finally{pt=c,Hr.transition=i}}return!1}function sy(r,i,c){i=mo(c,i),i=Eg(r,i,1),r=Ni(r,i,1),i=fr(),r!==null&&(ls(r,1,i),xr(r,i))}function Xt(r,i,c){if(r.tag===3)sy(r,r,c);else for(;i!==null;){if(i.tag===3){sy(i,r,c);break}else if(i.tag===1){var h=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(Ai===null||!Ai.has(h))){r=mo(c,r),r=Tg(i,r,1),i=Ni(i,r,1),r=fr(),i!==null&&(ls(i,1,r),xr(i,r));break}}i=i.return}}function cE(r,i,c){var h=r.pingCache;h!==null&&h.delete(i),i=fr(),r.pingedLanes|=r.suspendedLanes&c,Ln===r&&(Wn&c)===c&&(Tn===4||Tn===3&&(Wn&130023424)===Wn&&500>ht()-Oh?Ea(r,0):Mh|=c),xr(r,i)}function iy(r,i){i===0&&((r.mode&1)===0?i=1:(i=je,je<<=1,(je&130023424)===0&&(je=4194304)));var c=fr();r=ri(r,i),r!==null&&(ls(r,i,c),xr(r,c))}function uE(r){var i=r.memoizedState,c=0;i!==null&&(c=i.retryLane),iy(r,c)}function dE(r,i){var c=0;switch(r.tag){case 13:var h=r.stateNode,p=r.memoizedState;p!==null&&(c=p.retryLane);break;case 19:h=r.stateNode;break;default:throw Error(t(314))}h!==null&&h.delete(i),iy(r,c)}var ay;ay=function(r,i,c){if(r!==null)if(r.memoizedProps!==i.pendingProps||yr.current)_r=!0;else{if((r.lanes&c)===0&&(i.flags&128)===0)return _r=!1,Xx(r,i,c);_r=(r.flags&131072)!==0}else _r=!1,Gt&&(i.flags&1048576)!==0&&Fm(i,Lc,i.index);switch(i.lanes=0,i.tag){case 2:var h=i.type;Yc(r,i),r=i.pendingProps;var p=ao(i,er.current);fo(i,c),p=mh(null,i,h,r,p,c);var y=gh();return i.flags|=1,typeof p=="object"&&p!==null&&typeof p.render=="function"&&p.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,vr(h)?(y=!0,jc(i)):y=!1,i.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,lh(i),p.updater=Kc,i.stateNode=p,p._reactInternals=i,Eh(i,h,r,c),i=Ch(null,i,h,!0,y,c)):(i.tag=0,Gt&&y&&Xd(i),hr(null,i,p,c),i=i.child),i;case 16:h=i.elementType;e:{switch(Yc(r,i),r=i.pendingProps,p=h._init,h=p(h._payload),i.type=h,p=i.tag=fE(h),r=fs(h,r),p){case 0:i=bh(null,i,h,r,c);break e;case 1:i=jg(null,i,h,r,c);break e;case 11:i=Ig(null,i,h,r,c);break e;case 14:i=Pg(null,i,h,fs(h.type,r),c);break e}throw Error(t(306,h,""))}return i;case 0:return h=i.type,p=i.pendingProps,p=i.elementType===h?p:fs(h,p),bh(r,i,h,p,c);case 1:return h=i.type,p=i.pendingProps,p=i.elementType===h?p:fs(h,p),jg(r,i,h,p,c);case 3:e:{if(kg(i),r===null)throw Error(t(387));h=i.pendingProps,y=i.memoizedState,p=y.element,Km(r,i),zc(i,h,null,c);var E=i.memoizedState;if(h=E.element,y.isDehydrated)if(y={element:h,isDehydrated:!1,cache:E.cache,pendingSuspenseBoundaries:E.pendingSuspenseBoundaries,transitions:E.transitions},i.updateQueue.baseState=y,i.memoizedState=y,i.flags&256){p=mo(Error(t(423)),i),i=Dg(r,i,h,c,p);break e}else if(h!==p){p=mo(Error(t(424)),i),i=Dg(r,i,h,c,p);break e}else for(Lr=Si(i.stateNode.containerInfo.firstChild),Dr=i,Gt=!0,hs=null,c=qm(i,null,h,c),i.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{if(co(),h===p){i=ii(r,i,c);break e}hr(r,i,h,c)}i=i.child}return i;case 5:return Jm(i),r===null&&th(i),h=i.type,p=i.pendingProps,y=r!==null?r.memoizedProps:null,E=p.children,qd(h,p)?E=null:y!==null&&qd(h,y)&&(i.flags|=32),Ag(r,i),hr(r,i,E,c),i.child;case 6:return r===null&&th(i),null;case 13:return Lg(r,i,c);case 4:return ch(i,i.stateNode.containerInfo),h=i.pendingProps,r===null?i.child=uo(i,null,h,c):hr(r,i,h,c),i.child;case 11:return h=i.type,p=i.pendingProps,p=i.elementType===h?p:fs(h,p),Ig(r,i,h,p,c);case 7:return hr(r,i,i.pendingProps,c),i.child;case 8:return hr(r,i,i.pendingProps.children,c),i.child;case 12:return hr(r,i,i.pendingProps.children,c),i.child;case 10:e:{if(h=i.type._context,p=i.pendingProps,y=i.memoizedProps,E=p.value,Vt(Oc,h._currentValue),h._currentValue=E,y!==null)if(ds(y.value,E)){if(y.children===p.children&&!yr.current){i=ii(r,i,c);break e}}else for(y=i.child,y!==null&&(y.return=i);y!==null;){var L=y.dependencies;if(L!==null){E=y.child;for(var B=L.firstContext;B!==null;){if(B.context===h){if(y.tag===1){B=si(-1,c&-c),B.tag=2;var re=y.updateQueue;if(re!==null){re=re.shared;var Se=re.pending;Se===null?B.next=B:(B.next=Se.next,Se.next=B),re.pending=B}}y.lanes|=c,B=y.alternate,B!==null&&(B.lanes|=c),ah(y.return,c,i),L.lanes|=c;break}B=B.next}}else if(y.tag===10)E=y.type===i.type?null:y.child;else if(y.tag===18){if(E=y.return,E===null)throw Error(t(341));E.lanes|=c,L=E.alternate,L!==null&&(L.lanes|=c),ah(E,c,i),E=y.sibling}else E=y.child;if(E!==null)E.return=y;else for(E=y;E!==null;){if(E===i){E=null;break}if(y=E.sibling,y!==null){y.return=E.return,E=y;break}E=E.return}y=E}hr(r,i,p.children,c),i=i.child}return i;case 9:return p=i.type,h=i.pendingProps.children,fo(i,c),p=Gr(p),h=h(p),i.flags|=1,hr(r,i,h,c),i.child;case 14:return h=i.type,p=fs(h,i.pendingProps),p=fs(h.type,p),Pg(r,i,h,p,c);case 15:return Ng(r,i,i.type,i.pendingProps,c);case 17:return h=i.type,p=i.pendingProps,p=i.elementType===h?p:fs(h,p),Yc(r,i),i.tag=1,vr(h)?(r=!0,jc(i)):r=!1,fo(i,c),wg(i,h,p),Eh(i,h,p,c),Ch(null,i,h,!0,r,c);case 19:return Mg(r,i,c);case 22:return Rg(r,i,c)}throw Error(t(156,i.tag))};function oy(r,i){return ss(r,i)}function hE(r,i,c,h){this.tag=r,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Kr(r,i,c,h){return new hE(r,i,c,h)}function qh(r){return r=r.prototype,!(!r||!r.isReactComponent)}function fE(r){if(typeof r=="function")return qh(r)?1:0;if(r!=null){if(r=r.$$typeof,r===N)return 11;if(r===ne)return 14}return 2}function Li(r,i){var c=r.alternate;return c===null?(c=Kr(r.tag,i,r.key,r.mode),c.elementType=r.elementType,c.type=r.type,c.stateNode=r.stateNode,c.alternate=r,r.alternate=c):(c.pendingProps=i,c.type=r.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=r.flags&14680064,c.childLanes=r.childLanes,c.lanes=r.lanes,c.child=r.child,c.memoizedProps=r.memoizedProps,c.memoizedState=r.memoizedState,c.updateQueue=r.updateQueue,i=r.dependencies,c.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},c.sibling=r.sibling,c.index=r.index,c.ref=r.ref,c}function ou(r,i,c,h,p,y){var E=2;if(h=r,typeof r=="function")qh(r)&&(E=1);else if(typeof r=="string")E=5;else e:switch(r){case C:return Sa(c.children,p,y,i);case P:E=8,p|=8;break;case A:return r=Kr(12,c,i,p|2),r.elementType=A,r.lanes=y,r;case b:return r=Kr(13,c,i,p),r.elementType=b,r.lanes=y,r;case J:return r=Kr(19,c,i,p),r.elementType=J,r.lanes=y,r;case he:return lu(c,p,y,i);default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case M:E=10;break e;case D:E=9;break e;case N:E=11;break e;case ne:E=14;break e;case Re:E=16,h=null;break e}throw Error(t(130,r==null?r:typeof r,""))}return i=Kr(E,c,i,p),i.elementType=r,i.type=h,i.lanes=y,i}function Sa(r,i,c,h){return r=Kr(7,r,h,i),r.lanes=c,r}function lu(r,i,c,h){return r=Kr(22,r,h,i),r.elementType=he,r.lanes=c,r.stateNode={isHidden:!1},r}function Hh(r,i,c){return r=Kr(6,r,null,i),r.lanes=c,r}function Kh(r,i,c){return i=Kr(4,r.children!==null?r.children:[],r.key,i),i.lanes=c,i.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},i}function pE(r,i,c,h,p){this.tag=i,this.containerInfo=r,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=os(0),this.expirationTimes=os(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=os(0),this.identifierPrefix=h,this.onRecoverableError=p,this.mutableSourceEagerHydrationData=null}function Qh(r,i,c,h,p,y,E,L,B){return r=new pE(r,i,c,L,B),i===1?(i=1,y===!0&&(i|=8)):i=0,y=Kr(3,null,null,i),r.current=y,y.stateNode=r,y.memoizedState={element:h,isDehydrated:c,cache:null,transitions:null,pendingSuspenseBoundaries:null},lh(y),r}function mE(r,i,c){var h=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ie,key:h==null?null:""+h,children:r,containerInfo:i,implementation:c}}function ly(r){if(!r)return Ci;r=r._reactInternals;e:{if(Ft(r)!==r||r.tag!==1)throw Error(t(170));var i=r;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(vr(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(t(171))}if(r.tag===1){var c=r.type;if(vr(c))return Vm(r,c,i)}return i}function cy(r,i,c,h,p,y,E,L,B){return r=Qh(c,h,!0,r,p,y,E,L,B),r.context=ly(null),c=r.current,h=fr(),p=ki(c),y=si(h,p),y.callback=i??null,Ni(c,y,p),r.current.lanes=p,ls(r,p,h),xr(r,h),r}function cu(r,i,c,h){var p=i.current,y=fr(),E=ki(p);return c=ly(c),i.context===null?i.context=c:i.pendingContext=c,i=si(y,E),i.payload={element:r},h=h===void 0?null:h,h!==null&&(i.callback=h),r=Ni(p,i,E),r!==null&&(gs(r,p,E,y),Uc(r,p,E)),E}function uu(r){if(r=r.current,!r.child)return null;switch(r.child.tag){case 5:return r.child.stateNode;default:return r.child.stateNode}}function uy(r,i){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var c=r.retryLane;r.retryLane=c!==0&&c<i?c:i}}function Yh(r,i){uy(r,i),(r=r.alternate)&&uy(r,i)}function gE(){return null}var dy=typeof reportError=="function"?reportError:function(r){console.error(r)};function Jh(r){this._internalRoot=r}du.prototype.render=Jh.prototype.render=function(r){var i=this._internalRoot;if(i===null)throw Error(t(409));cu(r,i,null,null)},du.prototype.unmount=Jh.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var i=r.containerInfo;xa(function(){cu(null,r,null,null)}),i[Zs]=null}};function du(r){this._internalRoot=r}du.prototype.unstable_scheduleHydration=function(r){if(r){var i=fe();r={blockedOn:null,target:r,priority:i};for(var c=0;c<sn.length&&i!==0&&i<sn[c].priority;c++);sn.splice(c,0,r),c===0&&zr(r)}};function Xh(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function hu(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11&&(r.nodeType!==8||r.nodeValue!==" react-mount-point-unstable "))}function hy(){}function yE(r,i,c,h,p){if(p){if(typeof h=="function"){var y=h;h=function(){var re=uu(E);y.call(re)}}var E=cy(i,h,r,0,null,!1,!1,"",hy);return r._reactRootContainer=E,r[Zs]=E.current,ll(r.nodeType===8?r.parentNode:r),xa(),E}for(;p=r.lastChild;)r.removeChild(p);if(typeof h=="function"){var L=h;h=function(){var re=uu(B);L.call(re)}}var B=Qh(r,0,!1,null,null,!1,!1,"",hy);return r._reactRootContainer=B,r[Zs]=B.current,ll(r.nodeType===8?r.parentNode:r),xa(function(){cu(i,B,c,h)}),B}function fu(r,i,c,h,p){var y=c._reactRootContainer;if(y){var E=y;if(typeof p=="function"){var L=p;p=function(){var B=uu(E);L.call(B)}}cu(i,E,r,p)}else E=yE(c,i,r,p,h);return uu(E)}S=function(r){switch(r.tag){case 3:var i=r.stateNode;if(i.current.memoizedState.isDehydrated){var c=ut(i.pendingLanes);c!==0&&(Is(i,c|1),xr(i,ht()),(bt&6)===0&&(vo=ht()+500,Ii()))}break;case 13:xa(function(){var h=ri(r,1);if(h!==null){var p=fr();gs(h,r,1,p)}}),Yh(r,1)}},z=function(r){if(r.tag===13){var i=ri(r,134217728);if(i!==null){var c=fr();gs(i,r,134217728,c)}Yh(r,134217728)}},Q=function(r){if(r.tag===13){var i=ki(r),c=ri(r,i);if(c!==null){var h=fr();gs(c,r,i,h)}Yh(r,i)}},fe=function(){return pt},be=function(r,i){var c=pt;try{return pt=r,i()}finally{pt=c}},Ss=function(r,i,c){switch(i){case"input":if(Ct(r,c),i=c.name,c.type==="radio"&&i!=null){for(c=r;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<c.length;i++){var h=c[i];if(h!==r&&h.form===r.form){var p=Rc(h);if(!p)throw Error(t(90));Me(h),Ct(h,p)}}}break;case"textarea":rn(r,c);break;case"select":i=c.value,i!=null&&tn(r,!!c.multiple,i,!1)}},Jn=$h,Ws=xa;var vE={usingClientEntryPoint:!1,Events:[dl,so,Rc,Pn,Pr,$h]},bl={findFiberByHostInstance:fa,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},_E={bundleType:bl.bundleType,version:bl.version,rendererPackageName:bl.rendererPackageName,rendererConfig:bl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:_e.ReactCurrentDispatcher,findHostInstanceByFiber:function(r){return r=qs(r),r===null?null:r.stateNode},findFiberByHostInstance:bl.findFiberByHostInstance||gE,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var pu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!pu.isDisabled&&pu.supportsFiber)try{H=pu.inject(_E),ue=pu}catch{}}return Er.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=vE,Er.createPortal=function(r,i){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Xh(i))throw Error(t(200));return mE(r,i,null,c)},Er.createRoot=function(r,i){if(!Xh(r))throw Error(t(299));var c=!1,h="",p=dy;return i!=null&&(i.unstable_strictMode===!0&&(c=!0),i.identifierPrefix!==void 0&&(h=i.identifierPrefix),i.onRecoverableError!==void 0&&(p=i.onRecoverableError)),i=Qh(r,1,!1,null,null,c,!1,h,p),r[Zs]=i.current,ll(r.nodeType===8?r.parentNode:r),new Jh(i)},Er.findDOMNode=function(r){if(r==null)return null;if(r.nodeType===1)return r;var i=r._reactInternals;if(i===void 0)throw typeof r.render=="function"?Error(t(188)):(r=Object.keys(r).join(","),Error(t(268,r)));return r=qs(i),r=r===null?null:r.stateNode,r},Er.flushSync=function(r){return xa(r)},Er.hydrate=function(r,i,c){if(!hu(i))throw Error(t(200));return fu(null,r,i,!0,c)},Er.hydrateRoot=function(r,i,c){if(!Xh(r))throw Error(t(405));var h=c!=null&&c.hydratedSources||null,p=!1,y="",E=dy;if(c!=null&&(c.unstable_strictMode===!0&&(p=!0),c.identifierPrefix!==void 0&&(y=c.identifierPrefix),c.onRecoverableError!==void 0&&(E=c.onRecoverableError)),i=cy(i,null,r,1,c??null,p,!1,y,E),r[Zs]=i.current,ll(r),h)for(r=0;r<h.length;r++)c=h[r],p=c._getVersion,p=p(c._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[c,p]:i.mutableSourceEagerHydrationData.push(c,p);return new du(i)},Er.render=function(r,i,c){if(!hu(i))throw Error(t(200));return fu(null,r,i,!1,c)},Er.unmountComponentAtNode=function(r){if(!hu(r))throw Error(t(40));return r._reactRootContainer?(xa(function(){fu(null,null,r,!1,function(){r._reactRootContainer=null,r[Zs]=null})}),!0):!1},Er.unstable_batchedUpdates=$h,Er.unstable_renderSubtreeIntoContainer=function(r,i,c,h){if(!hu(c))throw Error(t(200));if(r==null||r._reactInternals===void 0)throw Error(t(38));return fu(r,i,c,!1,h)},Er.version="18.3.1-next-f1338f8080-20240426",Er}var wy;function P_(){if(wy)return tf.exports;wy=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),tf.exports=PE(),tf.exports}var xy;function NE(){if(xy)return mu;xy=1;var n=P_();return mu.createRoot=n.createRoot,mu.hydrateRoot=n.hydrateRoot,mu}var RE=NE();const AE=Zf(RE);P_();/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Bl(){return Bl=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},Bl.apply(this,arguments)}var Bi;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(Bi||(Bi={}));const Ey="popstate";function jE(n){n===void 0&&(n={});function e(s,a){let{pathname:l,search:d,hash:f}=s.location;return wf("",{pathname:l,search:d,hash:f},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(s,a){return typeof a=="string"?a:Mu(a)}return DE(e,t,null,n)}function cn(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function np(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function kE(){return Math.random().toString(36).substr(2,8)}function Ty(n,e){return{usr:n.state,key:n.key,idx:e}}function wf(n,e,t,s){return t===void 0&&(t=null),Bl({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?Fo(e):e,{state:t,key:e&&e.key||s||kE()})}function Mu(n){let{pathname:e="/",search:t="",hash:s=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),s&&s!=="#"&&(e+=s.charAt(0)==="#"?s:"#"+s),e}function Fo(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let s=n.indexOf("?");s>=0&&(e.search=n.substr(s),n=n.substr(0,s)),n&&(e.pathname=n)}return e}function DE(n,e,t,s){s===void 0&&(s={});let{window:a=document.defaultView,v5Compat:l=!1}=s,d=a.history,f=Bi.Pop,m=null,v=w();v==null&&(v=0,d.replaceState(Bl({},d.state,{idx:v}),""));function w(){return(d.state||{idx:null}).idx}function T(){f=Bi.Pop;let O=w(),se=O==null?null:O-v;v=O,m&&m({action:f,location:$.location,delta:se})}function I(O,se){f=Bi.Push;let Te=wf($.location,O,se);v=w()+1;let xe=Ty(Te,v),_e=$.createHref(Te);try{d.pushState(xe,"",_e)}catch(V){if(V instanceof DOMException&&V.name==="DataCloneError")throw V;a.location.assign(_e)}l&&m&&m({action:f,location:$.location,delta:1})}function U(O,se){f=Bi.Replace;let Te=wf($.location,O,se);v=w();let xe=Ty(Te,v),_e=$.createHref(Te);d.replaceState(xe,"",_e),l&&m&&m({action:f,location:$.location,delta:0})}function X(O){let se=a.location.origin!=="null"?a.location.origin:a.location.href,Te=typeof O=="string"?O:Mu(O);return Te=Te.replace(/ $/,"%20"),cn(se,"No window.location.(origin|href) available to create URL for href: "+Te),new URL(Te,se)}let $={get action(){return f},get location(){return n(a,d)},listen(O){if(m)throw new Error("A history only accepts one active listener");return a.addEventListener(Ey,T),m=O,()=>{a.removeEventListener(Ey,T),m=null}},createHref(O){return e(a,O)},createURL:X,encodeLocation(O){let se=X(O);return{pathname:se.pathname,search:se.search,hash:se.hash}},push:I,replace:U,go(O){return d.go(O)}};return $}var Sy;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(Sy||(Sy={}));function LE(n,e,t){return t===void 0&&(t="/"),VE(n,e,t)}function VE(n,e,t,s){let a=typeof e=="string"?Fo(e):e,l=rp(a.pathname||"/",t);if(l==null)return null;let d=N_(n);ME(d);let f=null;for(let m=0;f==null&&m<d.length;++m){let v=QE(l);f=qE(d[m],v)}return f}function N_(n,e,t,s){e===void 0&&(e=[]),t===void 0&&(t=[]),s===void 0&&(s="");let a=(l,d,f)=>{let m={relativePath:f===void 0?l.path||"":f,caseSensitive:l.caseSensitive===!0,childrenIndex:d,route:l};m.relativePath.startsWith("/")&&(cn(m.relativePath.startsWith(s),'Absolute route path "'+m.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),m.relativePath=m.relativePath.slice(s.length));let v=Gi([s,m.relativePath]),w=t.concat(m);l.children&&l.children.length>0&&(cn(l.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+v+'".')),N_(l.children,e,w,v)),!(l.path==null&&!l.index)&&e.push({path:v,score:WE(v,l.index),routesMeta:w})};return n.forEach((l,d)=>{var f;if(l.path===""||!((f=l.path)!=null&&f.includes("?")))a(l,d);else for(let m of R_(l.path))a(l,d,m)}),e}function R_(n){let e=n.split("/");if(e.length===0)return[];let[t,...s]=e,a=t.endsWith("?"),l=t.replace(/\?$/,"");if(s.length===0)return a?[l,""]:[l];let d=R_(s.join("/")),f=[];return f.push(...d.map(m=>m===""?l:[l,m].join("/"))),a&&f.push(...d),f.map(m=>n.startsWith("/")&&m===""?"/":m)}function ME(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:GE(e.routesMeta.map(s=>s.childrenIndex),t.routesMeta.map(s=>s.childrenIndex)))}const OE=/^:[\w-]+$/,FE=3,UE=2,zE=1,BE=10,$E=-2,by=n=>n==="*";function WE(n,e){let t=n.split("/"),s=t.length;return t.some(by)&&(s+=$E),e&&(s+=UE),t.filter(a=>!by(a)).reduce((a,l)=>a+(OE.test(l)?FE:l===""?zE:BE),s)}function GE(n,e){return n.length===e.length&&n.slice(0,-1).every((s,a)=>s===e[a])?n[n.length-1]-e[e.length-1]:0}function qE(n,e,t){let{routesMeta:s}=n,a={},l="/",d=[];for(let f=0;f<s.length;++f){let m=s[f],v=f===s.length-1,w=l==="/"?e:e.slice(l.length)||"/",T=HE({path:m.relativePath,caseSensitive:m.caseSensitive,end:v},w),I=m.route;if(!T)return null;Object.assign(a,T.params),d.push({params:a,pathname:Gi([l,T.pathname]),pathnameBase:eT(Gi([l,T.pathnameBase])),route:I}),T.pathnameBase!=="/"&&(l=Gi([l,T.pathnameBase]))}return d}function HE(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,s]=KE(n.path,n.caseSensitive,n.end),a=e.match(t);if(!a)return null;let l=a[0],d=l.replace(/(.)\/+$/,"$1"),f=a.slice(1);return{params:s.reduce((v,w,T)=>{let{paramName:I,isOptional:U}=w;if(I==="*"){let $=f[T]||"";d=l.slice(0,l.length-$.length).replace(/(.)\/+$/,"$1")}const X=f[T];return U&&!X?v[I]=void 0:v[I]=(X||"").replace(/%2F/g,"/"),v},{}),pathname:l,pathnameBase:d,pattern:n}}function KE(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),np(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let s=[],a="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,f,m)=>(s.push({paramName:f,isOptional:m!=null}),m?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(s.push({paramName:"*"}),a+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?a+="\\/*$":n!==""&&n!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),s]}function QE(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return np(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function rp(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,s=n.charAt(t);return s&&s!=="/"?null:n.slice(t)||"/"}const YE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,JE=n=>YE.test(n);function XE(n,e){e===void 0&&(e="/");let{pathname:t,search:s="",hash:a=""}=typeof n=="string"?Fo(n):n,l;if(t)if(JE(t))l=t;else{if(t.includes("//")){let d=t;t=t.replace(/\/\/+/g,"/"),np(!1,"Pathnames cannot have embedded double slashes - normalizing "+(d+" -> "+t))}t.startsWith("/")?l=Cy(t.substring(1),"/"):l=Cy(t,e)}else l=e;return{pathname:l,search:tT(s),hash:nT(a)}}function Cy(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(a=>{a===".."?t.length>1&&t.pop():a!=="."&&t.push(a)}),t.length>1?t.join("/"):"/"}function sf(n,e,t,s){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function ZE(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function sp(n,e){let t=ZE(n);return e?t.map((s,a)=>a===t.length-1?s.pathname:s.pathnameBase):t.map(s=>s.pathnameBase)}function ip(n,e,t,s){s===void 0&&(s=!1);let a;typeof n=="string"?a=Fo(n):(a=Bl({},n),cn(!a.pathname||!a.pathname.includes("?"),sf("?","pathname","search",a)),cn(!a.pathname||!a.pathname.includes("#"),sf("#","pathname","hash",a)),cn(!a.search||!a.search.includes("#"),sf("#","search","hash",a)));let l=n===""||a.pathname==="",d=l?"/":a.pathname,f;if(d==null)f=t;else{let T=e.length-1;if(!s&&d.startsWith("..")){let I=d.split("/");for(;I[0]==="..";)I.shift(),T-=1;a.pathname=I.join("/")}f=T>=0?e[T]:"/"}let m=XE(a,f),v=d&&d!=="/"&&d.endsWith("/"),w=(l||d===".")&&t.endsWith("/");return!m.pathname.endsWith("/")&&(v||w)&&(m.pathname+="/"),m}const Gi=n=>n.join("/").replace(/\/\/+/g,"/"),eT=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),tT=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,nT=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function rT(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const A_=["post","put","patch","delete"];new Set(A_);const sT=["get",...A_];new Set(sT);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function $l(){return $l=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},$l.apply(this,arguments)}const ap=j.createContext(null),iT=j.createContext(null),sa=j.createContext(null),rd=j.createContext(null),ia=j.createContext({outlet:null,matches:[],isDataRoute:!1}),j_=j.createContext(null);function aT(n,e){let{relative:t}=e===void 0?{}:e;Uo()||cn(!1);let{basename:s,navigator:a}=j.useContext(sa),{hash:l,pathname:d,search:f}=D_(n,{relative:t}),m=d;return s!=="/"&&(m=d==="/"?s:Gi([s,d])),a.createHref({pathname:m,search:f,hash:l})}function Uo(){return j.useContext(rd)!=null}function zo(){return Uo()||cn(!1),j.useContext(rd).location}function k_(n){j.useContext(sa).static||j.useLayoutEffect(n)}function tc(){let{isDataRoute:n}=j.useContext(ia);return n?_T():oT()}function oT(){Uo()||cn(!1);let n=j.useContext(ap),{basename:e,future:t,navigator:s}=j.useContext(sa),{matches:a}=j.useContext(ia),{pathname:l}=zo(),d=JSON.stringify(sp(a,t.v7_relativeSplatPath)),f=j.useRef(!1);return k_(()=>{f.current=!0}),j.useCallback(function(v,w){if(w===void 0&&(w={}),!f.current)return;if(typeof v=="number"){s.go(v);return}let T=ip(v,JSON.parse(d),l,w.relative==="path");n==null&&e!=="/"&&(T.pathname=T.pathname==="/"?e:Gi([e,T.pathname])),(w.replace?s.replace:s.push)(T,w.state,w)},[e,s,d,l,n])}function D_(n,e){let{relative:t}=e===void 0?{}:e,{future:s}=j.useContext(sa),{matches:a}=j.useContext(ia),{pathname:l}=zo(),d=JSON.stringify(sp(a,s.v7_relativeSplatPath));return j.useMemo(()=>ip(n,JSON.parse(d),l,t==="path"),[n,d,l,t])}function lT(n,e){return cT(n,e)}function cT(n,e,t,s){Uo()||cn(!1);let{navigator:a}=j.useContext(sa),{matches:l}=j.useContext(ia),d=l[l.length-1],f=d?d.params:{};d&&d.pathname;let m=d?d.pathnameBase:"/";d&&d.route;let v=zo(),w;if(e){var T;let O=typeof e=="string"?Fo(e):e;m==="/"||(T=O.pathname)!=null&&T.startsWith(m)||cn(!1),w=O}else w=v;let I=w.pathname||"/",U=I;if(m!=="/"){let O=m.replace(/^\//,"").split("/");U="/"+I.replace(/^\//,"").split("/").slice(O.length).join("/")}let X=LE(n,{pathname:U}),$=pT(X&&X.map(O=>Object.assign({},O,{params:Object.assign({},f,O.params),pathname:Gi([m,a.encodeLocation?a.encodeLocation(O.pathname).pathname:O.pathname]),pathnameBase:O.pathnameBase==="/"?m:Gi([m,a.encodeLocation?a.encodeLocation(O.pathnameBase).pathname:O.pathnameBase])})),l,t,s);return e&&$?j.createElement(rd.Provider,{value:{location:$l({pathname:"/",search:"",hash:"",state:null,key:"default"},w),navigationType:Bi.Pop}},$):$}function uT(){let n=vT(),e=rT(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return j.createElement(j.Fragment,null,j.createElement("h2",null,"Unexpected Application Error!"),j.createElement("h3",{style:{fontStyle:"italic"}},e),t?j.createElement("pre",{style:a},t):null,null)}const dT=j.createElement(uT,null);class hT extends j.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?j.createElement(ia.Provider,{value:this.props.routeContext},j.createElement(j_.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function fT(n){let{routeContext:e,match:t,children:s}=n,a=j.useContext(ap);return a&&a.static&&a.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=t.route.id),j.createElement(ia.Provider,{value:e},s)}function pT(n,e,t,s){var a;if(e===void 0&&(e=[]),t===void 0&&(t=null),s===void 0&&(s=null),n==null){var l;if(!t)return null;if(t.errors)n=t.matches;else if((l=s)!=null&&l.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let d=n,f=(a=t)==null?void 0:a.errors;if(f!=null){let w=d.findIndex(T=>T.route.id&&(f==null?void 0:f[T.route.id])!==void 0);w>=0||cn(!1),d=d.slice(0,Math.min(d.length,w+1))}let m=!1,v=-1;if(t&&s&&s.v7_partialHydration)for(let w=0;w<d.length;w++){let T=d[w];if((T.route.HydrateFallback||T.route.hydrateFallbackElement)&&(v=w),T.route.id){let{loaderData:I,errors:U}=t,X=T.route.loader&&I[T.route.id]===void 0&&(!U||U[T.route.id]===void 0);if(T.route.lazy||X){m=!0,v>=0?d=d.slice(0,v+1):d=[d[0]];break}}}return d.reduceRight((w,T,I)=>{let U,X=!1,$=null,O=null;t&&(U=f&&T.route.id?f[T.route.id]:void 0,$=T.route.errorElement||dT,m&&(v<0&&I===0?(wT("route-fallback"),X=!0,O=null):v===I&&(X=!0,O=T.route.hydrateFallbackElement||null)));let se=e.concat(d.slice(0,I+1)),Te=()=>{let xe;return U?xe=$:X?xe=O:T.route.Component?xe=j.createElement(T.route.Component,null):T.route.element?xe=T.route.element:xe=w,j.createElement(fT,{match:T,routeContext:{outlet:w,matches:se,isDataRoute:t!=null},children:xe})};return t&&(T.route.ErrorBoundary||T.route.errorElement||I===0)?j.createElement(hT,{location:t.location,revalidation:t.revalidation,component:$,error:U,children:Te(),routeContext:{outlet:null,matches:se,isDataRoute:!0}}):Te()},null)}var L_=(function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n})(L_||{}),V_=(function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n})(V_||{});function mT(n){let e=j.useContext(ap);return e||cn(!1),e}function gT(n){let e=j.useContext(iT);return e||cn(!1),e}function yT(n){let e=j.useContext(ia);return e||cn(!1),e}function M_(n){let e=yT(),t=e.matches[e.matches.length-1];return t.route.id||cn(!1),t.route.id}function vT(){var n;let e=j.useContext(j_),t=gT(),s=M_();return e!==void 0?e:(n=t.errors)==null?void 0:n[s]}function _T(){let{router:n}=mT(L_.UseNavigateStable),e=M_(V_.UseNavigateStable),t=j.useRef(!1);return k_(()=>{t.current=!0}),j.useCallback(function(a,l){l===void 0&&(l={}),t.current&&(typeof a=="number"?n.navigate(a):n.navigate(a,$l({fromRouteId:e},l)))},[n,e])}const Iy={};function wT(n,e,t){Iy[n]||(Iy[n]=!0)}function xT(n,e){n==null||n.v7_startTransition,n==null||n.v7_relativeSplatPath}function xf(n){let{to:e,replace:t,state:s,relative:a}=n;Uo()||cn(!1);let{future:l,static:d}=j.useContext(sa),{matches:f}=j.useContext(ia),{pathname:m}=zo(),v=tc(),w=ip(e,sp(f,l.v7_relativeSplatPath),m,a==="path"),T=JSON.stringify(w);return j.useEffect(()=>v(JSON.parse(T),{replace:t,state:s,relative:a}),[v,T,a,t,s]),null}function Qr(n){cn(!1)}function ET(n){let{basename:e="/",children:t=null,location:s,navigationType:a=Bi.Pop,navigator:l,static:d=!1,future:f}=n;Uo()&&cn(!1);let m=e.replace(/^\/*/,"/"),v=j.useMemo(()=>({basename:m,navigator:l,static:d,future:$l({v7_relativeSplatPath:!1},f)}),[m,f,l,d]);typeof s=="string"&&(s=Fo(s));let{pathname:w="/",search:T="",hash:I="",state:U=null,key:X="default"}=s,$=j.useMemo(()=>{let O=rp(w,m);return O==null?null:{location:{pathname:O,search:T,hash:I,state:U,key:X},navigationType:a}},[m,w,T,I,U,X,a]);return $==null?null:j.createElement(sa.Provider,{value:v},j.createElement(rd.Provider,{children:t,value:$}))}function TT(n){let{children:e,location:t}=n;return lT(Ef(e),t)}new Promise(()=>{});function Ef(n,e){e===void 0&&(e=[]);let t=[];return j.Children.forEach(n,(s,a)=>{if(!j.isValidElement(s))return;let l=[...e,a];if(s.type===j.Fragment){t.push.apply(t,Ef(s.props.children,l));return}s.type!==Qr&&cn(!1),!s.props.index||!s.props.children||cn(!1);let d={id:s.props.id||l.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(d.children=Ef(s.props.children,l)),t.push(d)}),t}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Tf(){return Tf=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},Tf.apply(this,arguments)}function ST(n,e){if(n==null)return{};var t={},s=Object.keys(n),a,l;for(l=0;l<s.length;l++)a=s[l],!(e.indexOf(a)>=0)&&(t[a]=n[a]);return t}function bT(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function CT(n,e){return n.button===0&&(!e||e==="_self")&&!bT(n)}function Sf(n){return n===void 0&&(n=""),new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((e,t)=>{let s=n[t];return e.concat(Array.isArray(s)?s.map(a=>[t,a]):[[t,s]])},[]))}function IT(n,e){let t=Sf(n);return e&&e.forEach((s,a)=>{t.has(a)||e.getAll(a).forEach(l=>{t.append(a,l)})}),t}const PT=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],NT="6";try{window.__reactRouterVersion=NT}catch{}const RT="startTransition",Py=bE[RT];function AT(n){let{basename:e,children:t,future:s,window:a}=n,l=j.useRef();l.current==null&&(l.current=jE({window:a,v5Compat:!0}));let d=l.current,[f,m]=j.useState({action:d.action,location:d.location}),{v7_startTransition:v}=s||{},w=j.useCallback(T=>{v&&Py?Py(()=>m(T)):m(T)},[m,v]);return j.useLayoutEffect(()=>d.listen(w),[d,w]),j.useEffect(()=>xT(s),[s]),j.createElement(ET,{basename:e,children:t,location:f.location,navigationType:f.action,navigator:d,future:s})}const jT=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",kT=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Mi=j.forwardRef(function(e,t){let{onClick:s,relative:a,reloadDocument:l,replace:d,state:f,target:m,to:v,preventScrollReset:w,viewTransition:T}=e,I=ST(e,PT),{basename:U}=j.useContext(sa),X,$=!1;if(typeof v=="string"&&kT.test(v)&&(X=v,jT))try{let xe=new URL(window.location.href),_e=v.startsWith("//")?new URL(xe.protocol+v):new URL(v),V=rp(_e.pathname,U);_e.origin===xe.origin&&V!=null?v=V+_e.search+_e.hash:$=!0}catch{}let O=aT(v,{relative:a}),se=DT(v,{replace:d,state:f,target:m,preventScrollReset:w,relative:a,viewTransition:T});function Te(xe){s&&s(xe),xe.defaultPrevented||se(xe)}return j.createElement("a",Tf({},I,{href:X||O,onClick:$||l?s:Te,ref:t,target:m}))});var Ny;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(Ny||(Ny={}));var Ry;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(Ry||(Ry={}));function DT(n,e){let{target:t,replace:s,state:a,preventScrollReset:l,relative:d,viewTransition:f}=e===void 0?{}:e,m=tc(),v=zo(),w=D_(n,{relative:d});return j.useCallback(T=>{if(CT(T,t)){T.preventDefault();let I=s!==void 0?s:Mu(v)===Mu(w);m(n,{replace:I,state:a,preventScrollReset:l,relative:d,viewTransition:f})}},[v,m,w,s,a,t,n,l,d,f])}function LT(n){let e=j.useRef(Sf(n)),t=j.useRef(!1),s=zo(),a=j.useMemo(()=>IT(s.search,t.current?null:e.current),[s.search]),l=tc(),d=j.useCallback((f,m)=>{const v=Sf(typeof f=="function"?f(a):f);t.current=!0,l("?"+v,m)},[l,a]);return[a,d]}const VT=()=>{};var Ay={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O_=function(n){const e=[];let t=0;for(let s=0;s<n.length;s++){let a=n.charCodeAt(s);a<128?e[t++]=a:a<2048?(e[t++]=a>>6|192,e[t++]=a&63|128):(a&64512)===55296&&s+1<n.length&&(n.charCodeAt(s+1)&64512)===56320?(a=65536+((a&1023)<<10)+(n.charCodeAt(++s)&1023),e[t++]=a>>18|240,e[t++]=a>>12&63|128,e[t++]=a>>6&63|128,e[t++]=a&63|128):(e[t++]=a>>12|224,e[t++]=a>>6&63|128,e[t++]=a&63|128)}return e},MT=function(n){const e=[];let t=0,s=0;for(;t<n.length;){const a=n[t++];if(a<128)e[s++]=String.fromCharCode(a);else if(a>191&&a<224){const l=n[t++];e[s++]=String.fromCharCode((a&31)<<6|l&63)}else if(a>239&&a<365){const l=n[t++],d=n[t++],f=n[t++],m=((a&7)<<18|(l&63)<<12|(d&63)<<6|f&63)-65536;e[s++]=String.fromCharCode(55296+(m>>10)),e[s++]=String.fromCharCode(56320+(m&1023))}else{const l=n[t++],d=n[t++];e[s++]=String.fromCharCode((a&15)<<12|(l&63)<<6|d&63)}}return e.join("")},F_={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let a=0;a<n.length;a+=3){const l=n[a],d=a+1<n.length,f=d?n[a+1]:0,m=a+2<n.length,v=m?n[a+2]:0,w=l>>2,T=(l&3)<<4|f>>4;let I=(f&15)<<2|v>>6,U=v&63;m||(U=64,d||(I=64)),s.push(t[w],t[T],t[I],t[U])}return s.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(O_(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):MT(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let a=0;a<n.length;){const l=t[n.charAt(a++)],f=a<n.length?t[n.charAt(a)]:0;++a;const v=a<n.length?t[n.charAt(a)]:64;++a;const T=a<n.length?t[n.charAt(a)]:64;if(++a,l==null||f==null||v==null||T==null)throw new OT;const I=l<<2|f>>4;if(s.push(I),v!==64){const U=f<<4&240|v>>2;if(s.push(U),T!==64){const X=v<<6&192|T;s.push(X)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class OT extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const FT=function(n){const e=O_(n);return F_.encodeByteArray(e,!0)},Ou=function(n){return FT(n).replace(/\./g,"")},U_=function(n){try{return F_.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UT(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zT=()=>UT().__FIREBASE_DEFAULTS__,BT=()=>{if(typeof process>"u"||typeof Ay>"u")return;const n=Ay.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},$T=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&U_(n[1]);return e&&JSON.parse(e)},sd=()=>{try{return VT()||zT()||BT()||$T()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},z_=n=>{var e,t;return(t=(e=sd())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},WT=n=>{const e=z_(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),s]:[e.substring(0,t),s]},B_=()=>{var n;return(n=sd())===null||n===void 0?void 0:n.config},$_=n=>{var e;return(e=sd())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GT{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,s)=>{t?this.reject(t):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,s))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bo(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function W_(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qT(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},s=e||"demo-project",a=n.iat||0,l=n.sub||n.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d=Object.assign({iss:`https://securetoken.google.com/${s}`,aud:s,iat:a,exp:a+3600,auth_time:a,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Ou(JSON.stringify(t)),Ou(JSON.stringify(d)),""].join(".")}const Ll={};function HT(){const n={prod:[],emulator:[]};for(const e of Object.keys(Ll))Ll[e]?n.emulator.push(e):n.prod.push(e);return n}function KT(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let jy=!1;function G_(n,e){if(typeof window>"u"||typeof document>"u"||!Bo(window.location.host)||Ll[n]===e||Ll[n]||jy)return;Ll[n]=e;function t(I){return`__firebase__banner__${I}`}const s="__firebase__banner",l=HT().prod.length>0;function d(){const I=document.getElementById(s);I&&I.remove()}function f(I){I.style.display="flex",I.style.background="#7faaf0",I.style.position="fixed",I.style.bottom="5px",I.style.left="5px",I.style.padding=".5em",I.style.borderRadius="5px",I.style.alignItems="center"}function m(I,U){I.setAttribute("width","24"),I.setAttribute("id",U),I.setAttribute("height","24"),I.setAttribute("viewBox","0 0 24 24"),I.setAttribute("fill","none"),I.style.marginLeft="-6px"}function v(){const I=document.createElement("span");return I.style.cursor="pointer",I.style.marginLeft="16px",I.style.fontSize="24px",I.innerHTML=" &times;",I.onclick=()=>{jy=!0,d()},I}function w(I,U){I.setAttribute("id",U),I.innerText="Learn more",I.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",I.setAttribute("target","__blank"),I.style.paddingLeft="5px",I.style.textDecoration="underline"}function T(){const I=KT(s),U=t("text"),X=document.getElementById(U)||document.createElement("span"),$=t("learnmore"),O=document.getElementById($)||document.createElement("a"),se=t("preprendIcon"),Te=document.getElementById(se)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(I.created){const xe=I.element;f(xe),w(O,$);const _e=v();m(Te,se),xe.append(Te,X,O,_e),document.body.appendChild(xe)}l?(X.innerText="Preview backend disconnected.",Te.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(Te.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,X.innerText="Preview backend running in this workspace."),X.setAttribute("id",U)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",T):T()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function or(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function QT(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(or())}function YT(){var n;const e=(n=sd())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function JT(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function XT(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function ZT(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function eS(){const n=or();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function tS(){return!YT()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function nS(){try{return typeof indexedDB=="object"}catch{return!1}}function rS(){return new Promise((n,e)=>{try{let t=!0;const s="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(s);a.onsuccess=()=>{a.result.close(),t||self.indexedDB.deleteDatabase(s),n(!0)},a.onupgradeneeded=()=>{t=!1},a.onerror=()=>{var l;e(((l=a.error)===null||l===void 0?void 0:l.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sS="FirebaseError";class _i extends Error{constructor(e,t,s){super(t),this.code=e,this.customData=s,this.name=sS,Object.setPrototypeOf(this,_i.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,nc.prototype.create)}}class nc{constructor(e,t,s){this.service=e,this.serviceName=t,this.errors=s}create(e,...t){const s=t[0]||{},a=`${this.service}/${e}`,l=this.errors[e],d=l?iS(l,s):"Error",f=`${this.serviceName}: ${d} (${a}).`;return new _i(a,f,s)}}function iS(n,e){return n.replace(aS,(t,s)=>{const a=e[s];return a!=null?String(a):`<${s}?>`})}const aS=/\{\$([^}]+)}/g;function oS(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Da(n,e){if(n===e)return!0;const t=Object.keys(n),s=Object.keys(e);for(const a of t){if(!s.includes(a))return!1;const l=n[a],d=e[a];if(ky(l)&&ky(d)){if(!Da(l,d))return!1}else if(l!==d)return!1}for(const a of s)if(!t.includes(a))return!1;return!0}function ky(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rc(n){const e=[];for(const[t,s]of Object.entries(n))Array.isArray(s)?s.forEach(a=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function Nl(n){const e={};return n.replace(/^\?/,"").split("&").forEach(s=>{if(s){const[a,l]=s.split("=");e[decodeURIComponent(a)]=decodeURIComponent(l)}}),e}function Rl(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function lS(n,e){const t=new cS(n,e);return t.subscribe.bind(t)}class cS{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,s){let a;if(e===void 0&&t===void 0&&s===void 0)throw new Error("Missing Observer.");uS(e,["next","error","complete"])?a=e:a={next:e,error:t,complete:s},a.next===void 0&&(a.next=af),a.error===void 0&&(a.error=af),a.complete===void 0&&(a.complete=af);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function uS(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function af(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function en(n){return n&&n._delegate?n._delegate:n}class La{constructor(e,t,s){this.name=e,this.instanceFactory=t,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ba="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dS{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const s=new GT;if(this.instancesDeferred.set(t,s),this.isInitialized(t)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:t});a&&s.resolve(a)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const s=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),a=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(s)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:s})}catch(l){if(a)return null;throw l}else{if(a)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(fS(e))try{this.getOrInitializeService({instanceIdentifier:ba})}catch{}for(const[t,s]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(t);try{const l=this.getOrInitializeService({instanceIdentifier:a});s.resolve(l)}catch{}}}}clearInstance(e=ba){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ba){return this.instances.has(e)}getOptions(e=ba){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:s,options:t});for(const[l,d]of this.instancesDeferred.entries()){const f=this.normalizeInstanceIdentifier(l);s===f&&d.resolve(a)}return a}onInit(e,t){var s;const a=this.normalizeInstanceIdentifier(t),l=(s=this.onInitCallbacks.get(a))!==null&&s!==void 0?s:new Set;l.add(e),this.onInitCallbacks.set(a,l);const d=this.instances.get(a);return d&&e(d,a),()=>{l.delete(e)}}invokeOnInitCallbacks(e,t){const s=this.onInitCallbacks.get(t);if(s)for(const a of s)try{a(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:hS(e),options:t}),this.instances.set(e,s),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=ba){return this.component?this.component.multipleInstances?e:ba:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function hS(n){return n===ba?void 0:n}function fS(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pS{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new dS(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var vt;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(vt||(vt={}));const mS={debug:vt.DEBUG,verbose:vt.VERBOSE,info:vt.INFO,warn:vt.WARN,error:vt.ERROR,silent:vt.SILENT},gS=vt.INFO,yS={[vt.DEBUG]:"log",[vt.VERBOSE]:"log",[vt.INFO]:"info",[vt.WARN]:"warn",[vt.ERROR]:"error"},vS=(n,e,...t)=>{if(e<n.logLevel)return;const s=new Date().toISOString(),a=yS[e];if(a)console[a](`[${s}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class op{constructor(e){this.name=e,this._logLevel=gS,this._logHandler=vS,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in vt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?mS[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,vt.DEBUG,...e),this._logHandler(this,vt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,vt.VERBOSE,...e),this._logHandler(this,vt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,vt.INFO,...e),this._logHandler(this,vt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,vt.WARN,...e),this._logHandler(this,vt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,vt.ERROR,...e),this._logHandler(this,vt.ERROR,...e)}}const _S=(n,e)=>e.some(t=>n instanceof t);let Dy,Ly;function wS(){return Dy||(Dy=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function xS(){return Ly||(Ly=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const q_=new WeakMap,bf=new WeakMap,H_=new WeakMap,of=new WeakMap,lp=new WeakMap;function ES(n){const e=new Promise((t,s)=>{const a=()=>{n.removeEventListener("success",l),n.removeEventListener("error",d)},l=()=>{t(qi(n.result)),a()},d=()=>{s(n.error),a()};n.addEventListener("success",l),n.addEventListener("error",d)});return e.then(t=>{t instanceof IDBCursor&&q_.set(t,n)}).catch(()=>{}),lp.set(e,n),e}function TS(n){if(bf.has(n))return;const e=new Promise((t,s)=>{const a=()=>{n.removeEventListener("complete",l),n.removeEventListener("error",d),n.removeEventListener("abort",d)},l=()=>{t(),a()},d=()=>{s(n.error||new DOMException("AbortError","AbortError")),a()};n.addEventListener("complete",l),n.addEventListener("error",d),n.addEventListener("abort",d)});bf.set(n,e)}let Cf={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return bf.get(n);if(e==="objectStoreNames")return n.objectStoreNames||H_.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return qi(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function SS(n){Cf=n(Cf)}function bS(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const s=n.call(lf(this),e,...t);return H_.set(s,e.sort?e.sort():[e]),qi(s)}:xS().includes(n)?function(...e){return n.apply(lf(this),e),qi(q_.get(this))}:function(...e){return qi(n.apply(lf(this),e))}}function CS(n){return typeof n=="function"?bS(n):(n instanceof IDBTransaction&&TS(n),_S(n,wS())?new Proxy(n,Cf):n)}function qi(n){if(n instanceof IDBRequest)return ES(n);if(of.has(n))return of.get(n);const e=CS(n);return e!==n&&(of.set(n,e),lp.set(e,n)),e}const lf=n=>lp.get(n);function IS(n,e,{blocked:t,upgrade:s,blocking:a,terminated:l}={}){const d=indexedDB.open(n,e),f=qi(d);return s&&d.addEventListener("upgradeneeded",m=>{s(qi(d.result),m.oldVersion,m.newVersion,qi(d.transaction),m)}),t&&d.addEventListener("blocked",m=>t(m.oldVersion,m.newVersion,m)),f.then(m=>{l&&m.addEventListener("close",()=>l()),a&&m.addEventListener("versionchange",v=>a(v.oldVersion,v.newVersion,v))}).catch(()=>{}),f}const PS=["get","getKey","getAll","getAllKeys","count"],NS=["put","add","delete","clear"],cf=new Map;function Vy(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(cf.get(e))return cf.get(e);const t=e.replace(/FromIndex$/,""),s=e!==t,a=NS.includes(t);if(!(t in(s?IDBIndex:IDBObjectStore).prototype)||!(a||PS.includes(t)))return;const l=async function(d,...f){const m=this.transaction(d,a?"readwrite":"readonly");let v=m.store;return s&&(v=v.index(f.shift())),(await Promise.all([v[t](...f),a&&m.done]))[0]};return cf.set(e,l),l}SS(n=>({...n,get:(e,t,s)=>Vy(e,t)||n.get(e,t,s),has:(e,t)=>!!Vy(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RS{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(AS(t)){const s=t.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(t=>t).join(" ")}}function AS(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const If="@firebase/app",My="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hi=new op("@firebase/app"),jS="@firebase/app-compat",kS="@firebase/analytics-compat",DS="@firebase/analytics",LS="@firebase/app-check-compat",VS="@firebase/app-check",MS="@firebase/auth",OS="@firebase/auth-compat",FS="@firebase/database",US="@firebase/data-connect",zS="@firebase/database-compat",BS="@firebase/functions",$S="@firebase/functions-compat",WS="@firebase/installations",GS="@firebase/installations-compat",qS="@firebase/messaging",HS="@firebase/messaging-compat",KS="@firebase/performance",QS="@firebase/performance-compat",YS="@firebase/remote-config",JS="@firebase/remote-config-compat",XS="@firebase/storage",ZS="@firebase/storage-compat",e1="@firebase/firestore",t1="@firebase/ai",n1="@firebase/firestore-compat",r1="firebase",s1="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pf="[DEFAULT]",i1={[If]:"fire-core",[jS]:"fire-core-compat",[DS]:"fire-analytics",[kS]:"fire-analytics-compat",[VS]:"fire-app-check",[LS]:"fire-app-check-compat",[MS]:"fire-auth",[OS]:"fire-auth-compat",[FS]:"fire-rtdb",[US]:"fire-data-connect",[zS]:"fire-rtdb-compat",[BS]:"fire-fn",[$S]:"fire-fn-compat",[WS]:"fire-iid",[GS]:"fire-iid-compat",[qS]:"fire-fcm",[HS]:"fire-fcm-compat",[KS]:"fire-perf",[QS]:"fire-perf-compat",[YS]:"fire-rc",[JS]:"fire-rc-compat",[XS]:"fire-gcs",[ZS]:"fire-gcs-compat",[e1]:"fire-fst",[n1]:"fire-fst-compat",[t1]:"fire-vertex","fire-js":"fire-js",[r1]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fu=new Map,a1=new Map,Nf=new Map;function Oy(n,e){try{n.container.addComponent(e)}catch(t){hi.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function jo(n){const e=n.name;if(Nf.has(e))return hi.debug(`There were multiple attempts to register component ${e}.`),!1;Nf.set(e,n);for(const t of Fu.values())Oy(t,n);for(const t of a1.values())Oy(t,n);return!0}function cp(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Mr(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o1={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Hi=new nc("app","Firebase",o1);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l1{constructor(e,t,s){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new La("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Hi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $o=s1;function K_(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const s=Object.assign({name:Pf,automaticDataCollectionEnabled:!0},e),a=s.name;if(typeof a!="string"||!a)throw Hi.create("bad-app-name",{appName:String(a)});if(t||(t=B_()),!t)throw Hi.create("no-options");const l=Fu.get(a);if(l){if(Da(t,l.options)&&Da(s,l.config))return l;throw Hi.create("duplicate-app",{appName:a})}const d=new pS(a);for(const m of Nf.values())d.addComponent(m);const f=new l1(t,s,d);return Fu.set(a,f),f}function Q_(n=Pf){const e=Fu.get(n);if(!e&&n===Pf&&B_())return K_();if(!e)throw Hi.create("no-app",{appName:n});return e}function Ki(n,e,t){var s;let a=(s=i1[n])!==null&&s!==void 0?s:n;t&&(a+=`-${t}`);const l=a.match(/\s|\//),d=e.match(/\s|\//);if(l||d){const f=[`Unable to register library "${a}" with version "${e}":`];l&&f.push(`library name "${a}" contains illegal characters (whitespace or "/")`),l&&d&&f.push("and"),d&&f.push(`version name "${e}" contains illegal characters (whitespace or "/")`),hi.warn(f.join(" "));return}jo(new La(`${a}-version`,()=>({library:a,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c1="firebase-heartbeat-database",u1=1,Wl="firebase-heartbeat-store";let uf=null;function Y_(){return uf||(uf=IS(c1,u1,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Wl)}catch(t){console.warn(t)}}}}).catch(n=>{throw Hi.create("idb-open",{originalErrorMessage:n.message})})),uf}async function d1(n){try{const t=(await Y_()).transaction(Wl),s=await t.objectStore(Wl).get(J_(n));return await t.done,s}catch(e){if(e instanceof _i)hi.warn(e.message);else{const t=Hi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});hi.warn(t.message)}}}async function Fy(n,e){try{const s=(await Y_()).transaction(Wl,"readwrite");await s.objectStore(Wl).put(e,J_(n)),await s.done}catch(t){if(t instanceof _i)hi.warn(t.message);else{const s=Hi.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});hi.warn(s.message)}}}function J_(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h1=1024,f1=30;class p1{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new g1(t),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){var e,t;try{const a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),l=Uy();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===l||this._heartbeatsCache.heartbeats.some(d=>d.date===l))return;if(this._heartbeatsCache.heartbeats.push({date:l,agent:a}),this._heartbeatsCache.heartbeats.length>f1){const d=y1(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(d,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(s){hi.warn(s)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Uy(),{heartbeatsToSend:s,unsentEntries:a}=m1(this._heartbeatsCache.heartbeats),l=Ou(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=t,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(t){return hi.warn(t),""}}}function Uy(){return new Date().toISOString().substring(0,10)}function m1(n,e=h1){const t=[];let s=n.slice();for(const a of n){const l=t.find(d=>d.agent===a.agent);if(l){if(l.dates.push(a.date),zy(t)>e){l.dates.pop();break}}else if(t.push({agent:a.agent,dates:[a.date]}),zy(t)>e){t.pop();break}s=s.slice(1)}return{heartbeatsToSend:t,unsentEntries:s}}class g1{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return nS()?rS().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await d1(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const a=await this.read();return Fy(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:a.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const a=await this.read();return Fy(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:a.lastSentHeartbeatDate,heartbeats:[...a.heartbeats,...e.heartbeats]})}else return}}function zy(n){return Ou(JSON.stringify({version:2,heartbeats:n})).length}function y1(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let s=1;s<n.length;s++)n[s].date<t&&(t=n[s].date,e=s);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v1(n){jo(new La("platform-logger",e=>new RS(e),"PRIVATE")),jo(new La("heartbeat",e=>new p1(e),"PRIVATE")),Ki(If,My,n),Ki(If,My,"esm2017"),Ki("fire-js","")}v1("");var _1="firebase",w1="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ki(_1,w1,"app");function up(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(n);a<s.length;a++)e.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(n,s[a])&&(t[s[a]]=n[s[a]]);return t}function X_(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const x1=X_,Z_=new nc("auth","Firebase",X_());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uu=new op("@firebase/auth");function E1(n,...e){Uu.logLevel<=vt.WARN&&Uu.warn(`Auth (${$o}): ${n}`,...e)}function Su(n,...e){Uu.logLevel<=vt.ERROR&&Uu.error(`Auth (${$o}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zr(n,...e){throw hp(n,...e)}function xs(n,...e){return hp(n,...e)}function dp(n,e,t){const s=Object.assign(Object.assign({},x1()),{[e]:t});return new nc("auth","Firebase",s).create(e,{appName:n.name})}function ui(n){return dp(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function e0(n,e,t){const s=t;if(!(e instanceof s))throw s.name!==e.constructor.name&&Zr(n,"argument-error"),dp(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function hp(n,...e){if(typeof n!="string"){const t=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=n.name),n._errorFactory.create(t,...s)}return Z_.create(n,...e)}function nt(n,e,...t){if(!n)throw hp(e,...t)}function oi(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Su(e),new Error(e)}function fi(n,e){n||oi(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rf(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function T1(){return By()==="http:"||By()==="https:"}function By(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S1(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(T1()||XT()||"connection"in navigator)?navigator.onLine:!0}function b1(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sc{constructor(e,t){this.shortDelay=e,this.longDelay=t,fi(t>e,"Short delay should be less than long delay!"),this.isMobile=QT()||ZT()}get(){return S1()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fp(n,e){fi(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t0{static initialize(e,t,s){this.fetchImpl=e,t&&(this.headersImpl=t),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;oi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;oi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;oi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C1={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I1=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],P1=new sc(3e4,6e4);function aa(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function $s(n,e,t,s,a={}){return n0(n,a,async()=>{let l={},d={};s&&(e==="GET"?d=s:l={body:JSON.stringify(s)});const f=rc(Object.assign({key:n.config.apiKey},d)).slice(1),m=await n._getAdditionalHeaders();m["Content-Type"]="application/json",n.languageCode&&(m["X-Firebase-Locale"]=n.languageCode);const v=Object.assign({method:e,headers:m},l);return JT()||(v.referrerPolicy="no-referrer"),n.emulatorConfig&&Bo(n.emulatorConfig.host)&&(v.credentials="include"),t0.fetch()(await r0(n,n.config.apiHost,t,f),v)})}async function n0(n,e,t){n._canInitEmulator=!1;const s=Object.assign(Object.assign({},C1),e);try{const a=new R1(n),l=await Promise.race([t(),a.promise]);a.clearNetworkTimeout();const d=await l.json();if("needConfirmation"in d)throw gu(n,"account-exists-with-different-credential",d);if(l.ok&&!("errorMessage"in d))return d;{const f=l.ok?d.errorMessage:d.error.message,[m,v]=f.split(" : ");if(m==="FEDERATED_USER_ID_ALREADY_LINKED")throw gu(n,"credential-already-in-use",d);if(m==="EMAIL_EXISTS")throw gu(n,"email-already-in-use",d);if(m==="USER_DISABLED")throw gu(n,"user-disabled",d);const w=s[m]||m.toLowerCase().replace(/[_\s]+/g,"-");if(v)throw dp(n,w,v);Zr(n,w)}}catch(a){if(a instanceof _i)throw a;Zr(n,"network-request-failed",{message:String(a)})}}async function ic(n,e,t,s,a={}){const l=await $s(n,e,t,s,a);return"mfaPendingCredential"in l&&Zr(n,"multi-factor-auth-required",{_serverResponse:l}),l}async function r0(n,e,t,s){const a=`${e}${t}?${s}`,l=n,d=l.config.emulator?fp(n.config,a):`${n.config.apiScheme}://${a}`;return I1.includes(t)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(d).toString():d}function N1(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class R1{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,s)=>{this.timer=setTimeout(()=>s(xs(this.auth,"network-request-failed")),P1.get())})}}function gu(n,e,t){const s={appName:n.name};t.email&&(s.email=t.email),t.phoneNumber&&(s.phoneNumber=t.phoneNumber);const a=xs(n,e,s);return a.customData._tokenResponse=t,a}function $y(n){return n!==void 0&&n.enterprise!==void 0}class A1{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return N1(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function j1(n,e){return $s(n,"GET","/v2/recaptchaConfig",aa(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function k1(n,e){return $s(n,"POST","/v1/accounts:delete",e)}async function D1(n,e){return $s(n,"POST","/v1/accounts:update",e)}async function zu(n,e){return $s(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vl(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function L1(n,e=!1){const t=en(n),s=await t.getIdToken(e),a=pp(s);nt(a&&a.exp&&a.auth_time&&a.iat,t.auth,"internal-error");const l=typeof a.firebase=="object"?a.firebase:void 0,d=l==null?void 0:l.sign_in_provider;return{claims:a,token:s,authTime:Vl(df(a.auth_time)),issuedAtTime:Vl(df(a.iat)),expirationTime:Vl(df(a.exp)),signInProvider:d||null,signInSecondFactor:(l==null?void 0:l.sign_in_second_factor)||null}}function df(n){return Number(n)*1e3}function pp(n){const[e,t,s]=n.split(".");if(e===void 0||t===void 0||s===void 0)return Su("JWT malformed, contained fewer than 3 sections"),null;try{const a=U_(t);return a?JSON.parse(a):(Su("Failed to decode base64 JWT payload"),null)}catch(a){return Su("Caught error parsing JWT payload as JSON",a==null?void 0:a.toString()),null}}function Wy(n){const e=pp(n);return nt(e,"internal-error"),nt(typeof e.exp<"u","internal-error"),nt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ko(n,e,t=!1){if(t)return e;try{return await e}catch(s){throw s instanceof _i&&V1(s)&&n.auth.currentUser===n&&await n.auth.signOut(),s}}function V1({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M1{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const s=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),s}else{this.errorBackoff=3e4;const a=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,a)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Af{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Vl(this.lastLoginAt),this.creationTime=Vl(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gl(n){var e;const t=n.auth,s=await n.getIdToken(),a=await ko(n,zu(t,{idToken:s}));nt(a==null?void 0:a.users.length,t,"internal-error");const l=a.users[0];n._notifyReloadListener(l);const d=!((e=l.providerUserInfo)===null||e===void 0)&&e.length?s0(l.providerUserInfo):[],f=F1(n.providerData,d),m=n.isAnonymous,v=!(n.email&&l.passwordHash)&&!(f!=null&&f.length),w=m?v:!1,T={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:f,metadata:new Af(l.createdAt,l.lastLoginAt),isAnonymous:w};Object.assign(n,T)}async function O1(n){const e=en(n);await Gl(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function F1(n,e){return[...n.filter(s=>!e.some(a=>a.providerId===s.providerId)),...e]}function s0(n){return n.map(e=>{var{providerId:t}=e,s=up(e,["providerId"]);return{providerId:t,uid:s.rawId||"",displayName:s.displayName||null,email:s.email||null,phoneNumber:s.phoneNumber||null,photoURL:s.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function U1(n,e){const t=await n0(n,{},async()=>{const s=rc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:l}=n.config,d=await r0(n,a,"/v1/token",`key=${l}`),f=await n._getAdditionalHeaders();f["Content-Type"]="application/x-www-form-urlencoded";const m={method:"POST",headers:f,body:s};return n.emulatorConfig&&Bo(n.emulatorConfig.host)&&(m.credentials="include"),t0.fetch()(d,m)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function z1(n,e){return $s(n,"POST","/v2/accounts:revokeToken",aa(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Io{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){nt(e.idToken,"internal-error"),nt(typeof e.idToken<"u","internal-error"),nt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Wy(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){nt(e.length!==0,"internal-error");const t=Wy(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(nt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:s,refreshToken:a,expiresIn:l}=await U1(e,t);this.updateTokensAndExpiration(s,a,Number(l))}updateTokensAndExpiration(e,t,s){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,t){const{refreshToken:s,accessToken:a,expirationTime:l}=t,d=new Io;return s&&(nt(typeof s=="string","internal-error",{appName:e}),d.refreshToken=s),a&&(nt(typeof a=="string","internal-error",{appName:e}),d.accessToken=a),l&&(nt(typeof l=="number","internal-error",{appName:e}),d.expirationTime=l),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Io,this.toJSON())}_performRefresh(){return oi("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oi(n,e){nt(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class ws{constructor(e){var{uid:t,auth:s,stsTokenManager:a}=e,l=up(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new M1(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=s,this.stsTokenManager=a,this.accessToken=a.accessToken,this.displayName=l.displayName||null,this.email=l.email||null,this.emailVerified=l.emailVerified||!1,this.phoneNumber=l.phoneNumber||null,this.photoURL=l.photoURL||null,this.isAnonymous=l.isAnonymous||!1,this.tenantId=l.tenantId||null,this.providerData=l.providerData?[...l.providerData]:[],this.metadata=new Af(l.createdAt||void 0,l.lastLoginAt||void 0)}async getIdToken(e){const t=await ko(this,this.stsTokenManager.getToken(this.auth,e));return nt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return L1(this,e)}reload(){return O1(this)}_assign(e){this!==e&&(nt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new ws(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){nt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),t&&await Gl(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Mr(this.auth.app))return Promise.reject(ui(this.auth));const e=await this.getIdToken();return await ko(this,k1(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var s,a,l,d,f,m,v,w;const T=(s=t.displayName)!==null&&s!==void 0?s:void 0,I=(a=t.email)!==null&&a!==void 0?a:void 0,U=(l=t.phoneNumber)!==null&&l!==void 0?l:void 0,X=(d=t.photoURL)!==null&&d!==void 0?d:void 0,$=(f=t.tenantId)!==null&&f!==void 0?f:void 0,O=(m=t._redirectEventId)!==null&&m!==void 0?m:void 0,se=(v=t.createdAt)!==null&&v!==void 0?v:void 0,Te=(w=t.lastLoginAt)!==null&&w!==void 0?w:void 0,{uid:xe,emailVerified:_e,isAnonymous:V,providerData:ie,stsTokenManager:C}=t;nt(xe&&C,e,"internal-error");const P=Io.fromJSON(this.name,C);nt(typeof xe=="string",e,"internal-error"),Oi(T,e.name),Oi(I,e.name),nt(typeof _e=="boolean",e,"internal-error"),nt(typeof V=="boolean",e,"internal-error"),Oi(U,e.name),Oi(X,e.name),Oi($,e.name),Oi(O,e.name),Oi(se,e.name),Oi(Te,e.name);const A=new ws({uid:xe,auth:e,email:I,emailVerified:_e,displayName:T,isAnonymous:V,photoURL:X,phoneNumber:U,tenantId:$,stsTokenManager:P,createdAt:se,lastLoginAt:Te});return ie&&Array.isArray(ie)&&(A.providerData=ie.map(M=>Object.assign({},M))),O&&(A._redirectEventId=O),A}static async _fromIdTokenResponse(e,t,s=!1){const a=new Io;a.updateFromServerResponse(t);const l=new ws({uid:t.localId,auth:e,stsTokenManager:a,isAnonymous:s});return await Gl(l),l}static async _fromGetAccountInfoResponse(e,t,s){const a=t.users[0];nt(a.localId!==void 0,"internal-error");const l=a.providerUserInfo!==void 0?s0(a.providerUserInfo):[],d=!(a.email&&a.passwordHash)&&!(l!=null&&l.length),f=new Io;f.updateFromIdToken(s);const m=new ws({uid:a.localId,auth:e,stsTokenManager:f,isAnonymous:d}),v={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new Af(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!(l!=null&&l.length)};return Object.assign(m,v),m}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gy=new Map;function li(n){fi(n instanceof Function,"Expected a class definition");let e=Gy.get(n);return e?(fi(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Gy.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i0{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}i0.type="NONE";const qy=i0;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bu(n,e,t){return`firebase:${n}:${e}:${t}`}class Po{constructor(e,t,s){this.persistence=e,this.auth=t,this.userKey=s;const{config:a,name:l}=this.auth;this.fullUserKey=bu(this.userKey,a.apiKey,l),this.fullPersistenceKey=bu("persistence",a.apiKey,l),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await zu(this.auth,{idToken:e}).catch(()=>{});return t?ws._fromGetAccountInfoResponse(this.auth,t,e):null}return ws._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,s="authUser"){if(!t.length)return new Po(li(qy),e,s);const a=(await Promise.all(t.map(async v=>{if(await v._isAvailable())return v}))).filter(v=>v);let l=a[0]||li(qy);const d=bu(s,e.config.apiKey,e.name);let f=null;for(const v of t)try{const w=await v._get(d);if(w){let T;if(typeof w=="string"){const I=await zu(e,{idToken:w}).catch(()=>{});if(!I)break;T=await ws._fromGetAccountInfoResponse(e,I,w)}else T=ws._fromJSON(e,w);v!==l&&(f=T),l=v;break}}catch{}const m=a.filter(v=>v._shouldAllowMigration);return!l._shouldAllowMigration||!m.length?new Po(l,e,s):(l=m[0],f&&await l._set(d,f.toJSON()),await Promise.all(t.map(async v=>{if(v!==l)try{await v._remove(d)}catch{}})),new Po(l,e,s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hy(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(c0(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(a0(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(d0(e))return"Blackberry";if(h0(e))return"Webos";if(o0(e))return"Safari";if((e.includes("chrome/")||l0(e))&&!e.includes("edge/"))return"Chrome";if(u0(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=n.match(t);if((s==null?void 0:s.length)===2)return s[1]}return"Other"}function a0(n=or()){return/firefox\//i.test(n)}function o0(n=or()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function l0(n=or()){return/crios\//i.test(n)}function c0(n=or()){return/iemobile/i.test(n)}function u0(n=or()){return/android/i.test(n)}function d0(n=or()){return/blackberry/i.test(n)}function h0(n=or()){return/webos/i.test(n)}function mp(n=or()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function B1(n=or()){var e;return mp(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function $1(){return eS()&&document.documentMode===10}function f0(n=or()){return mp(n)||u0(n)||h0(n)||d0(n)||/windows phone/i.test(n)||c0(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p0(n,e=[]){let t;switch(n){case"Browser":t=Hy(or());break;case"Worker":t=`${Hy(or())}-${n}`;break;default:t=n}const s=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${$o}/${s}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W1{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const s=l=>new Promise((d,f)=>{try{const m=e(l);d(m)}catch(m){f(m)}});s.onAbort=t,this.queue.push(s);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const s of this.queue)await s(e),s.onAbort&&t.push(s.onAbort)}catch(s){t.reverse();for(const a of t)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s==null?void 0:s.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function G1(n,e={}){return $s(n,"GET","/v2/passwordPolicy",aa(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q1=6;class H1{constructor(e){var t,s,a,l;const d=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=d.minPasswordLength)!==null&&t!==void 0?t:q1,d.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=d.maxPasswordLength),d.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=d.containsLowercaseCharacter),d.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=d.containsUppercaseCharacter),d.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=d.containsNumericCharacter),d.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=d.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(a=(s=e.allowedNonAlphanumericCharacters)===null||s===void 0?void 0:s.join(""))!==null&&a!==void 0?a:"",this.forceUpgradeOnSignin=(l=e.forceUpgradeOnSignin)!==null&&l!==void 0?l:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,s,a,l,d,f;const m={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,m),this.validatePasswordCharacterOptions(e,m),m.isValid&&(m.isValid=(t=m.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),m.isValid&&(m.isValid=(s=m.meetsMaxPasswordLength)!==null&&s!==void 0?s:!0),m.isValid&&(m.isValid=(a=m.containsLowercaseLetter)!==null&&a!==void 0?a:!0),m.isValid&&(m.isValid=(l=m.containsUppercaseLetter)!==null&&l!==void 0?l:!0),m.isValid&&(m.isValid=(d=m.containsNumericCharacter)!==null&&d!==void 0?d:!0),m.isValid&&(m.isValid=(f=m.containsNonAlphanumericCharacter)!==null&&f!==void 0?f:!0),m}validatePasswordLengthOptions(e,t){const s=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;s&&(t.meetsMinPasswordLength=e.length>=s),a&&(t.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let s;for(let a=0;a<e.length;a++)s=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(t,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,t,s,a,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K1{constructor(e,t,s,a){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=s,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ky(this),this.idTokenSubscription=new Ky(this),this.beforeStateQueue=new W1(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Z_,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=li(t)),this._initializationPromise=this.queue(async()=>{var s,a,l;if(!this._deleted&&(this.persistenceManager=await Po.create(this,e),(s=this._resolvePersistenceManagerAvailable)===null||s===void 0||s.call(this),!this._deleted)){if(!((a=this._popupRedirectResolver)===null||a===void 0)&&a._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((l=this.currentUser)===null||l===void 0?void 0:l.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await zu(this,{idToken:e}),s=await ws._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(s)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Mr(this.app)){const d=this.app.settings.authIdToken;return d?new Promise(f=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(d).then(f,f))}):this.directlySetCurrentUser(null)}const s=await this.assertedPersistence.getCurrentUser();let a=s,l=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const d=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,f=a==null?void 0:a._redirectEventId,m=await this.tryRedirectSignIn(e);(!d||d===f)&&(m!=null&&m.user)&&(a=m.user,l=!0)}if(!a)return this.directlySetCurrentUser(null);if(!a._redirectEventId){if(l)try{await this.beforeStateQueue.runMiddleware(a)}catch(d){a=s,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(d))}return a?this.reloadAndSetCurrentUserOrClear(a):this.directlySetCurrentUser(null)}return nt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===a._redirectEventId?this.directlySetCurrentUser(a):this.reloadAndSetCurrentUserOrClear(a)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Gl(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=b1()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Mr(this.app))return Promise.reject(ui(this));const t=e?en(e):null;return t&&nt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&nt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Mr(this.app)?Promise.reject(ui(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Mr(this.app)?Promise.reject(ui(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(li(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await G1(this),t=new H1(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new nc("auth","Firebase",e())}onAuthStateChanged(e,t,s){return this.registerStateListener(this.authStateSubscription,e,t,s)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,s){return this.registerStateListener(this.idTokenSubscription,e,t,s)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(s.tenantId=this.tenantId),await z1(this,s)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const s=await this.getOrInitRedirectPersistenceManager(t);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&li(e)||this._popupRedirectResolver;nt(t,this,"argument-error"),this.redirectPersistenceManager=await Po.create(this,[li(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,s;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((s=this.redirectUser)===null||s===void 0?void 0:s._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const s=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==s&&(this.lastNotifiedUid=s,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,s,a){if(this._deleted)return()=>{};const l=typeof t=="function"?t:t.next.bind(t);let d=!1;const f=this._isInitialized?Promise.resolve():this._initializationPromise;if(nt(f,this,"internal-error"),f.then(()=>{d||l(this.currentUser)}),typeof t=="function"){const m=e.addObserver(t,s,a);return()=>{d=!0,m()}}else{const m=e.addObserver(t);return()=>{d=!0,m()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return nt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=p0(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const s=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());s&&(t["X-Firebase-Client"]=s);const a=await this._getAppCheckToken();return a&&(t["X-Firebase-AppCheck"]=a),t}async _getAppCheckToken(){var e;if(Mr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&E1(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function oa(n){return en(n)}class Ky{constructor(e){this.auth=e,this.observer=null,this.addObserver=lS(t=>this.observer=t)}get next(){return nt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let id={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Q1(n){id=n}function m0(n){return id.loadJS(n)}function Y1(){return id.recaptchaEnterpriseScript}function J1(){return id.gapiScript}function X1(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class Z1{constructor(){this.enterprise=new eb}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class eb{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const tb="recaptcha-enterprise",g0="NO_RECAPTCHA";class nb{constructor(e){this.type=tb,this.auth=oa(e)}async verify(e="verify",t=!1){async function s(l){if(!t){if(l.tenantId==null&&l._agentRecaptchaConfig!=null)return l._agentRecaptchaConfig.siteKey;if(l.tenantId!=null&&l._tenantRecaptchaConfigs[l.tenantId]!==void 0)return l._tenantRecaptchaConfigs[l.tenantId].siteKey}return new Promise(async(d,f)=>{j1(l,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(m=>{if(m.recaptchaKey===void 0)f(new Error("recaptcha Enterprise site key undefined"));else{const v=new A1(m);return l.tenantId==null?l._agentRecaptchaConfig=v:l._tenantRecaptchaConfigs[l.tenantId]=v,d(v.siteKey)}}).catch(m=>{f(m)})})}function a(l,d,f){const m=window.grecaptcha;$y(m)?m.enterprise.ready(()=>{m.enterprise.execute(l,{action:e}).then(v=>{d(v)}).catch(()=>{d(g0)})}):f(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new Z1().execute("siteKey",{action:"verify"}):new Promise((l,d)=>{s(this.auth).then(f=>{if(!t&&$y(window.grecaptcha))a(f,l,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let m=Y1();m.length!==0&&(m+=f),m0(m).then(()=>{a(f,l,d)}).catch(v=>{d(v)})}}).catch(f=>{d(f)})})}}async function Qy(n,e,t,s=!1,a=!1){const l=new nb(n);let d;if(a)d=g0;else try{d=await l.verify(t)}catch{d=await l.verify(t,!0)}const f=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in f){const m=f.phoneEnrollmentInfo.phoneNumber,v=f.phoneEnrollmentInfo.recaptchaToken;Object.assign(f,{phoneEnrollmentInfo:{phoneNumber:m,recaptchaToken:v,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in f){const m=f.phoneSignInInfo.recaptchaToken;Object.assign(f,{phoneSignInInfo:{recaptchaToken:m,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return f}return s?Object.assign(f,{captchaResp:d}):Object.assign(f,{captchaResponse:d}),Object.assign(f,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(f,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),f}async function jf(n,e,t,s,a){var l;if(!((l=n._getRecaptchaConfig())===null||l===void 0)&&l.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const d=await Qy(n,e,t,t==="getOobCode");return s(n,d)}else return s(n,e).catch(async d=>{if(d.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const f=await Qy(n,e,t,t==="getOobCode");return s(n,f)}else return Promise.reject(d)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rb(n,e){const t=cp(n,"auth");if(t.isInitialized()){const a=t.getImmediate(),l=t.getOptions();if(Da(l,e??{}))return a;Zr(a,"already-initialized")}return t.initialize({options:e})}function sb(n,e){const t=(e==null?void 0:e.persistence)||[],s=(Array.isArray(t)?t:[t]).map(li);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(s,e==null?void 0:e.popupRedirectResolver)}function ib(n,e,t){const s=oa(n);nt(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const a=!1,l=y0(e),{host:d,port:f}=ab(e),m=f===null?"":`:${f}`,v={url:`${l}//${d}${m}/`},w=Object.freeze({host:d,port:f,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!s._canInitEmulator){nt(s.config.emulator&&s.emulatorConfig,s,"emulator-config-failed"),nt(Da(v,s.config.emulator)&&Da(w,s.emulatorConfig),s,"emulator-config-failed");return}s.config.emulator=v,s.emulatorConfig=w,s.settings.appVerificationDisabledForTesting=!0,Bo(d)?(W_(`${l}//${d}${m}`),G_("Auth",!0)):ob()}function y0(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function ab(n){const e=y0(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const s=t[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(s);if(a){const l=a[1];return{host:l,port:Yy(s.substr(l.length+1))}}else{const[l,d]=s.split(":");return{host:l,port:Yy(d)}}}function Yy(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function ob(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gp{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return oi("not implemented")}_getIdTokenResponse(e){return oi("not implemented")}_linkToIdToken(e,t){return oi("not implemented")}_getReauthenticationResolver(e){return oi("not implemented")}}async function lb(n,e){return $s(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cb(n,e){return ic(n,"POST","/v1/accounts:signInWithPassword",aa(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ub(n,e){return ic(n,"POST","/v1/accounts:signInWithEmailLink",aa(n,e))}async function db(n,e){return ic(n,"POST","/v1/accounts:signInWithEmailLink",aa(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ql extends gp{constructor(e,t,s,a=null){super("password",s),this._email=e,this._password=t,this._tenantId=a}static _fromEmailAndPassword(e,t){return new ql(e,t,"password")}static _fromEmailAndCode(e,t,s=null){return new ql(e,t,"emailLink",s)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return jf(e,t,"signInWithPassword",cb);case"emailLink":return ub(e,{email:this._email,oobCode:this._password});default:Zr(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const s={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return jf(e,s,"signUpPassword",lb);case"emailLink":return db(e,{idToken:t,email:this._email,oobCode:this._password});default:Zr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function No(n,e){return ic(n,"POST","/v1/accounts:signInWithIdp",aa(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hb="http://localhost";class pi extends gp{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new pi(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Zr("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:a}=t,l=up(t,["providerId","signInMethod"]);if(!s||!a)return null;const d=new pi(s,a);return d.idToken=l.idToken||void 0,d.accessToken=l.accessToken||void 0,d.secret=l.secret,d.nonce=l.nonce,d.pendingToken=l.pendingToken||null,d}_getIdTokenResponse(e){const t=this.buildRequest();return No(e,t)}_linkToIdToken(e,t){const s=this.buildRequest();return s.idToken=t,No(e,s)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,No(e,t)}buildRequest(){const e={requestUri:hb,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=rc(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fb(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function pb(n){const e=Nl(Rl(n)).link,t=e?Nl(Rl(e)).deep_link_id:null,s=Nl(Rl(n)).deep_link_id;return(s?Nl(Rl(s)).link:null)||s||t||e||n}class yp{constructor(e){var t,s,a,l,d,f;const m=Nl(Rl(e)),v=(t=m.apiKey)!==null&&t!==void 0?t:null,w=(s=m.oobCode)!==null&&s!==void 0?s:null,T=fb((a=m.mode)!==null&&a!==void 0?a:null);nt(v&&w&&T,"argument-error"),this.apiKey=v,this.operation=T,this.code=w,this.continueUrl=(l=m.continueUrl)!==null&&l!==void 0?l:null,this.languageCode=(d=m.lang)!==null&&d!==void 0?d:null,this.tenantId=(f=m.tenantId)!==null&&f!==void 0?f:null}static parseLink(e){const t=pb(e);try{return new yp(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wo{constructor(){this.providerId=Wo.PROVIDER_ID}static credential(e,t){return ql._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const s=yp.parseLink(t);return nt(s,"argument-error"),ql._fromEmailAndCode(e,s.code,s.tenantId)}}Wo.PROVIDER_ID="password";Wo.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Wo.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ad{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Go extends ad{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Ml extends Go{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return nt("providerId"in t&&"signInMethod"in t,"argument-error"),pi._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return nt(e.idToken||e.accessToken,"argument-error"),pi._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return Ml.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return Ml.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:s,oauthTokenSecret:a,pendingToken:l,nonce:d,providerId:f}=e;if(!s&&!a&&!t&&!l||!f)return null;try{return new Ml(f)._credential({idToken:t,accessToken:s,nonce:d,pendingToken:l})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fi extends Go{constructor(){super("facebook.com")}static credential(e){return pi._fromParams({providerId:Fi.PROVIDER_ID,signInMethod:Fi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Fi.credentialFromTaggedObject(e)}static credentialFromError(e){return Fi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Fi.credential(e.oauthAccessToken)}catch{return null}}}Fi.FACEBOOK_SIGN_IN_METHOD="facebook.com";Fi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ys extends Go{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return pi._fromParams({providerId:ys.PROVIDER_ID,signInMethod:ys.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return ys.credentialFromTaggedObject(e)}static credentialFromError(e){return ys.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:s}=e;if(!t&&!s)return null;try{return ys.credential(t,s)}catch{return null}}}ys.GOOGLE_SIGN_IN_METHOD="google.com";ys.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ui extends Go{constructor(){super("github.com")}static credential(e){return pi._fromParams({providerId:Ui.PROVIDER_ID,signInMethod:Ui.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ui.credentialFromTaggedObject(e)}static credentialFromError(e){return Ui.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ui.credential(e.oauthAccessToken)}catch{return null}}}Ui.GITHUB_SIGN_IN_METHOD="github.com";Ui.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zi extends Go{constructor(){super("twitter.com")}static credential(e,t){return pi._fromParams({providerId:zi.PROVIDER_ID,signInMethod:zi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return zi.credentialFromTaggedObject(e)}static credentialFromError(e){return zi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:s}=e;if(!t||!s)return null;try{return zi.credential(t,s)}catch{return null}}}zi.TWITTER_SIGN_IN_METHOD="twitter.com";zi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mb(n,e){return ic(n,"POST","/v1/accounts:signUp",aa(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Va{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,s,a=!1){const l=await ws._fromIdTokenResponse(e,s,a),d=Jy(s);return new Va({user:l,providerId:d,_tokenResponse:s,operationType:t})}static async _forOperation(e,t,s){await e._updateTokensIfNecessary(s,!0);const a=Jy(s);return new Va({user:e,providerId:a,_tokenResponse:s,operationType:t})}}function Jy(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bu extends _i{constructor(e,t,s,a){var l;super(t.code,t.message),this.operationType=s,this.user=a,Object.setPrototypeOf(this,Bu.prototype),this.customData={appName:e.name,tenantId:(l=e.tenantId)!==null&&l!==void 0?l:void 0,_serverResponse:t.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,t,s,a){return new Bu(e,t,s,a)}}function v0(n,e,t,s){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?Bu._fromErrorAndOperation(n,l,e,s):l})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _0(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gb(n,e){const t=en(n);await vb(!0,t,e);const{providerUserInfo:s}=await D1(t.auth,{idToken:await t.getIdToken(),deleteProvider:[e]}),a=_0(s||[]);return t.providerData=t.providerData.filter(l=>a.has(l.providerId)),a.has("phone")||(t.phoneNumber=null),await t.auth._persistUserIfCurrent(t),t}async function yb(n,e,t=!1){const s=await ko(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Va._forOperation(n,"link",s)}async function vb(n,e,t){await Gl(e);const s=_0(e.providerData);nt(s.has(t)===n,e.auth,"no-such-provider")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _b(n,e,t=!1){const{auth:s}=n;if(Mr(s.app))return Promise.reject(ui(s));const a="reauthenticate";try{const l=await ko(n,v0(s,a,e,n),t);nt(l.idToken,s,"internal-error");const d=pp(l.idToken);nt(d,s,"internal-error");const{sub:f}=d;return nt(n.uid===f,s,"user-mismatch"),Va._forOperation(n,a,l)}catch(l){throw(l==null?void 0:l.code)==="auth/user-not-found"&&Zr(s,"user-mismatch"),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function w0(n,e,t=!1){if(Mr(n.app))return Promise.reject(ui(n));const s="signIn",a=await v0(n,s,e),l=await Va._fromIdTokenResponse(n,s,a);return t||await n._updateCurrentUser(l.user),l}async function wb(n,e){return w0(oa(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function x0(n){const e=oa(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function xb(n,e,t){if(Mr(n.app))return Promise.reject(ui(n));const s=oa(n),d=await jf(s,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",mb).catch(m=>{throw m.code==="auth/password-does-not-meet-requirements"&&x0(n),m}),f=await Va._fromIdTokenResponse(s,"signIn",d);return await s._updateCurrentUser(f.user),f}function E0(n,e,t){return Mr(n.app)?Promise.reject(ui(n)):wb(en(n),Wo.credential(e,t)).catch(async s=>{throw s.code==="auth/password-does-not-meet-requirements"&&x0(n),s})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Eb(n,e){return $s(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Tb(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const s=en(n),l={idToken:await s.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},d=await ko(s,Eb(s.auth,l));s.displayName=d.displayName||null,s.photoURL=d.photoUrl||null;const f=s.providerData.find(({providerId:m})=>m==="password");f&&(f.displayName=s.displayName,f.photoURL=s.photoURL),await s._updateTokensIfNecessary(d)}function Sb(n,e,t,s){return en(n).onIdTokenChanged(e,t,s)}function bb(n,e,t){return en(n).beforeAuthStateChanged(e,t)}function Cb(n,e,t,s){return en(n).onAuthStateChanged(e,t,s)}function T0(n){return en(n).signOut()}const $u="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S0{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem($u,"1"),this.storage.removeItem($u),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ib=1e3,Pb=10;class b0 extends S0{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=f0(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const s=this.storage.getItem(t),a=this.localCache[t];s!==a&&e(t,a,s)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((d,f,m)=>{this.notifyListeners(d,m)});return}const s=e.key;t?this.detachListener():this.stopPolling();const a=()=>{const d=this.storage.getItem(s);!t&&this.localCache[s]===d||this.notifyListeners(s,d)},l=this.storage.getItem(s);$1()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,Pb):a()}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const a of Array.from(s))a(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:s}),!0)})},Ib)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}b0.type="LOCAL";const Nb=b0;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C0 extends S0{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}C0.type="SESSION";const I0=C0;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rb(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class od{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(a=>a.isListeningto(e));if(t)return t;const s=new od(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:s,eventType:a,data:l}=t.data,d=this.handlersMap[a];if(!(d!=null&&d.size))return;t.ports[0].postMessage({status:"ack",eventId:s,eventType:a});const f=Array.from(d).map(async v=>v(t.origin,l)),m=await Rb(f);t.ports[0].postMessage({status:"done",eventId:s,eventType:a,response:m})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}od.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vp(n="",e=10){let t="";for(let s=0;s<e;s++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ab{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,s=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let l,d;return new Promise((f,m)=>{const v=vp("",20);a.port1.start();const w=setTimeout(()=>{m(new Error("unsupported_event"))},s);d={messageChannel:a,onMessage(T){const I=T;if(I.data.eventId===v)switch(I.data.status){case"ack":clearTimeout(w),l=setTimeout(()=>{m(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),f(I.data.response);break;default:clearTimeout(w),clearTimeout(l),m(new Error("invalid_response"));break}}},this.handlers.add(d),a.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:v,data:t},[a.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ms(){return window}function jb(n){Ms().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P0(){return typeof Ms().WorkerGlobalScope<"u"&&typeof Ms().importScripts=="function"}async function kb(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Db(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function Lb(){return P0()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N0="firebaseLocalStorageDb",Vb=1,Wu="firebaseLocalStorage",R0="fbase_key";class ac{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function ld(n,e){return n.transaction([Wu],e?"readwrite":"readonly").objectStore(Wu)}function Mb(){const n=indexedDB.deleteDatabase(N0);return new ac(n).toPromise()}function kf(){const n=indexedDB.open(N0,Vb);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const s=n.result;try{s.createObjectStore(Wu,{keyPath:R0})}catch(a){t(a)}}),n.addEventListener("success",async()=>{const s=n.result;s.objectStoreNames.contains(Wu)?e(s):(s.close(),await Mb(),e(await kf()))})})}async function Xy(n,e,t){const s=ld(n,!0).put({[R0]:e,value:t});return new ac(s).toPromise()}async function Ob(n,e){const t=ld(n,!1).get(e),s=await new ac(t).toPromise();return s===void 0?null:s.value}function Zy(n,e){const t=ld(n,!0).delete(e);return new ac(t).toPromise()}const Fb=800,Ub=3;class A0{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await kf(),this.db)}async _withRetries(e){let t=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(t++>Ub)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return P0()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=od._getInstance(Lb()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await kb(),!this.activeServiceWorker)return;this.sender=new Ab(this.activeServiceWorker);const s=await this.sender._send("ping",{},800);s&&!((e=s[0])===null||e===void 0)&&e.fulfilled&&!((t=s[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Db()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await kf();return await Xy(e,$u,"1"),await Zy(e,$u),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(s=>Xy(s,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(s=>Ob(s,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Zy(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const l=ld(a,!1).getAll();return new ac(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],s=new Set;if(e.length!==0)for(const{fbase_key:a,value:l}of e)s.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(l)&&(this.notifyListeners(a,l),t.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!s.has(a)&&(this.notifyListeners(a,null),t.push(a));return t}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const a of Array.from(s))a(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Fb)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}A0.type="LOCAL";const zb=A0;new sc(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _p(n,e){return e?li(e):(nt(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wp extends gp{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return No(e,this._buildIdpRequest())}_linkToIdToken(e,t){return No(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return No(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Bb(n){return w0(n.auth,new wp(n),n.bypassAuthState)}function $b(n){const{auth:e,user:t}=n;return nt(t,e,"internal-error"),_b(t,new wp(n),n.bypassAuthState)}async function Wb(n){const{auth:e,user:t}=n;return nt(t,e,"internal-error"),yb(t,new wp(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j0{constructor(e,t,s,a,l=!1){this.auth=e,this.resolver=s,this.user=a,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:s,postBody:a,tenantId:l,error:d,type:f}=e;if(d){this.reject(d);return}const m={auth:this.auth,requestUri:t,sessionId:s,tenantId:l||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(f)(m))}catch(v){this.reject(v)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Bb;case"linkViaPopup":case"linkViaRedirect":return Wb;case"reauthViaPopup":case"reauthViaRedirect":return $b;default:Zr(this.auth,"internal-error")}}resolve(e){fi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){fi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gb=new sc(2e3,1e4);async function k0(n,e,t){if(Mr(n.app))return Promise.reject(xs(n,"operation-not-supported-in-this-environment"));const s=oa(n);e0(n,e,ad);const a=_p(s,t);return new $i(s,"signInViaPopup",e,a).executeNotNull()}async function ev(n,e,t){const s=en(n);e0(s.auth,e,ad);const a=_p(s.auth,t);return new $i(s.auth,"linkViaPopup",e,a,s).executeNotNull()}class $i extends j0{constructor(e,t,s,a,l){super(e,t,a,l),this.provider=s,this.authWindow=null,this.pollId=null,$i.currentPopupAction&&$i.currentPopupAction.cancel(),$i.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return nt(e,this.auth,"internal-error"),e}async onExecution(){fi(this.filter.length===1,"Popup operations only handle one event");const e=vp();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(xs(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(xs(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,$i.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,s;if(!((s=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||s===void 0)&&s.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(xs(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Gb.get())};e()}}$i.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qb="pendingRedirect",Cu=new Map;class Hb extends j0{constructor(e,t,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,s),this.eventId=null}async execute(){let e=Cu.get(this.auth._key());if(!e){try{const s=await Kb(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(t){e=()=>Promise.reject(t)}Cu.set(this.auth._key(),e)}return this.bypassAuthState||Cu.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Kb(n,e){const t=Jb(e),s=Yb(n);if(!await s._isAvailable())return!1;const a=await s._get(t)==="true";return await s._remove(t),a}function Qb(n,e){Cu.set(n._key(),e)}function Yb(n){return li(n._redirectPersistence)}function Jb(n){return bu(qb,n.config.apiKey,n.name)}async function Xb(n,e,t=!1){if(Mr(n.app))return Promise.reject(ui(n));const s=oa(n),a=_p(s,e),d=await new Hb(s,a,t).execute();return d&&!t&&(delete d.user._redirectEventId,await s._persistUserIfCurrent(d.user),await s._setRedirectUser(null,e)),d}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zb=600*1e3;class eC{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(t=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!tC(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var s;if(e.error&&!D0(e)){const a=((s=e.error.code)===null||s===void 0?void 0:s.split("auth/")[1])||"internal-error";t.onError(xs(this.auth,a))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const s=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Zb&&this.cachedEventUids.clear(),this.cachedEventUids.has(tv(e))}saveEventToCache(e){this.cachedEventUids.add(tv(e)),this.lastProcessedEventTime=Date.now()}}function tv(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function D0({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function tC(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return D0(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nC(n,e={}){return $s(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rC=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,sC=/^https?/;async function iC(n){if(n.config.emulator)return;const{authorizedDomains:e}=await nC(n);for(const t of e)try{if(aC(t))return}catch{}Zr(n,"unauthorized-domain")}function aC(n){const e=Rf(),{protocol:t,hostname:s}=new URL(e);if(n.startsWith("chrome-extension://")){const d=new URL(n);return d.hostname===""&&s===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&d.hostname===s}if(!sC.test(t))return!1;if(rC.test(n))return s===n;const a=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(s)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oC=new sc(3e4,6e4);function nv(){const n=Ms().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function lC(n){return new Promise((e,t)=>{var s,a,l;function d(){nv(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{nv(),t(xs(n,"network-request-failed"))},timeout:oC.get()})}if(!((a=(s=Ms().gapi)===null||s===void 0?void 0:s.iframes)===null||a===void 0)&&a.Iframe)e(gapi.iframes.getContext());else if(!((l=Ms().gapi)===null||l===void 0)&&l.load)d();else{const f=X1("iframefcb");return Ms()[f]=()=>{gapi.load?d():t(xs(n,"network-request-failed"))},m0(`${J1()}?onload=${f}`).catch(m=>t(m))}}).catch(e=>{throw Iu=null,e})}let Iu=null;function cC(n){return Iu=Iu||lC(n),Iu}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uC=new sc(5e3,15e3),dC="__/auth/iframe",hC="emulator/auth/iframe",fC={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},pC=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function mC(n){const e=n.config;nt(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?fp(e,hC):`https://${n.config.authDomain}/${dC}`,s={apiKey:e.apiKey,appName:n.name,v:$o},a=pC.get(n.config.apiHost);a&&(s.eid=a);const l=n._getFrameworks();return l.length&&(s.fw=l.join(",")),`${t}?${rc(s).slice(1)}`}async function gC(n){const e=await cC(n),t=Ms().gapi;return nt(t,n,"internal-error"),e.open({where:document.body,url:mC(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:fC,dontclear:!0},s=>new Promise(async(a,l)=>{await s.restyle({setHideOnLeave:!1});const d=xs(n,"network-request-failed"),f=Ms().setTimeout(()=>{l(d)},uC.get());function m(){Ms().clearTimeout(f),a(s)}s.ping(m).then(m,()=>{l(d)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yC={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},vC=500,_C=600,wC="_blank",xC="http://localhost";class rv{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function EC(n,e,t,s=vC,a=_C){const l=Math.max((window.screen.availHeight-a)/2,0).toString(),d=Math.max((window.screen.availWidth-s)/2,0).toString();let f="";const m=Object.assign(Object.assign({},yC),{width:s.toString(),height:a.toString(),top:l,left:d}),v=or().toLowerCase();t&&(f=l0(v)?wC:t),a0(v)&&(e=e||xC,m.scrollbars="yes");const w=Object.entries(m).reduce((I,[U,X])=>`${I}${U}=${X},`,"");if(B1(v)&&f!=="_self")return TC(e||"",f),new rv(null);const T=window.open(e||"",f,w);nt(T,n,"popup-blocked");try{T.focus()}catch{}return new rv(T)}function TC(n,e){const t=document.createElement("a");t.href=n,t.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SC="__/auth/handler",bC="emulator/auth/handler",CC=encodeURIComponent("fac");async function sv(n,e,t,s,a,l){nt(n.config.authDomain,n,"auth-domain-config-required"),nt(n.config.apiKey,n,"invalid-api-key");const d={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:s,v:$o,eventId:a};if(e instanceof ad){e.setDefaultLanguage(n.languageCode),d.providerId=e.providerId||"",oS(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[w,T]of Object.entries({}))d[w]=T}if(e instanceof Go){const w=e.getScopes().filter(T=>T!=="");w.length>0&&(d.scopes=w.join(","))}n.tenantId&&(d.tid=n.tenantId);const f=d;for(const w of Object.keys(f))f[w]===void 0&&delete f[w];const m=await n._getAppCheckToken(),v=m?`#${CC}=${encodeURIComponent(m)}`:"";return`${IC(n)}?${rc(f).slice(1)}${v}`}function IC({config:n}){return n.emulator?fp(n,bC):`https://${n.authDomain}/${SC}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hf="webStorageSupport";class PC{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=I0,this._completeRedirectFn=Xb,this._overrideRedirectResult=Qb}async _openPopup(e,t,s,a){var l;fi((l=this.eventManagers[e._key()])===null||l===void 0?void 0:l.manager,"_initialize() not called before _openPopup()");const d=await sv(e,t,s,Rf(),a);return EC(e,d,vp())}async _openRedirect(e,t,s,a){await this._originValidation(e);const l=await sv(e,t,s,Rf(),a);return jb(l),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:a,promise:l}=this.eventManagers[t];return a?Promise.resolve(a):(fi(l,"If manager is not set, promise should be"),l)}const s=this.initAndGetManager(e);return this.eventManagers[t]={promise:s},s.catch(()=>{delete this.eventManagers[t]}),s}async initAndGetManager(e){const t=await gC(e),s=new eC(e);return t.register("authEvent",a=>(nt(a==null?void 0:a.authEvent,e,"invalid-auth-event"),{status:s.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=t,s}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(hf,{type:hf},a=>{var l;const d=(l=a==null?void 0:a[0])===null||l===void 0?void 0:l[hf];d!==void 0&&t(!!d),Zr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=iC(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return f0()||o0()||mp()}}const NC=PC;var iv="@firebase/auth",av="1.10.8";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RC{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(s=>{e((s==null?void 0:s.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){nt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AC(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function jC(n){jo(new La("auth",(e,{options:t})=>{const s=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:d,authDomain:f}=s.options;nt(d&&!d.includes(":"),"invalid-api-key",{appName:s.name});const m={apiKey:d,authDomain:f,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:p0(n)},v=new K1(s,a,l,m);return sb(v,t),v},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,s)=>{e.getProvider("auth-internal").initialize()})),jo(new La("auth-internal",e=>{const t=oa(e.getProvider("auth").getImmediate());return(s=>new RC(s))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ki(iv,av,AC(n)),Ki(iv,av,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kC=300,DC=$_("authIdTokenMaxAge")||kC;let ov=null;const LC=n=>async e=>{const t=e&&await e.getIdTokenResult(),s=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(s&&s>DC)return;const a=t==null?void 0:t.token;ov!==a&&(ov=a,await fetch(n,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function VC(n=Q_()){const e=cp(n,"auth");if(e.isInitialized())return e.getImmediate();const t=rb(n,{popupRedirectResolver:NC,persistence:[zb,Nb,I0]}),s=$_("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const l=new URL(s,location.origin);if(location.origin===l.origin){const d=LC(l.toString());bb(t,d,()=>d(t.currentUser)),Sb(t,f=>d(f))}}const a=z_("auth");return a&&ib(t,`http://${a}`),t}function MC(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}Q1({loadJS(n){return new Promise((e,t)=>{const s=document.createElement("script");s.setAttribute("src",n),s.onload=e,s.onerror=a=>{const l=xs("internal-error");l.customData=a,t(l)},s.type="text/javascript",s.charset="UTF-8",MC().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});jC("Browser");var lv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Qi,L0;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(C,P){function A(){}A.prototype=P.prototype,C.D=P.prototype,C.prototype=new A,C.prototype.constructor=C,C.C=function(M,D,N){for(var b=Array(arguments.length-2),J=2;J<arguments.length;J++)b[J-2]=arguments[J];return P.prototype[D].apply(M,b)}}function t(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(s,t),s.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(C,P,A){A||(A=0);var M=Array(16);if(typeof P=="string")for(var D=0;16>D;++D)M[D]=P.charCodeAt(A++)|P.charCodeAt(A++)<<8|P.charCodeAt(A++)<<16|P.charCodeAt(A++)<<24;else for(D=0;16>D;++D)M[D]=P[A++]|P[A++]<<8|P[A++]<<16|P[A++]<<24;P=C.g[0],A=C.g[1],D=C.g[2];var N=C.g[3],b=P+(N^A&(D^N))+M[0]+3614090360&4294967295;P=A+(b<<7&4294967295|b>>>25),b=N+(D^P&(A^D))+M[1]+3905402710&4294967295,N=P+(b<<12&4294967295|b>>>20),b=D+(A^N&(P^A))+M[2]+606105819&4294967295,D=N+(b<<17&4294967295|b>>>15),b=A+(P^D&(N^P))+M[3]+3250441966&4294967295,A=D+(b<<22&4294967295|b>>>10),b=P+(N^A&(D^N))+M[4]+4118548399&4294967295,P=A+(b<<7&4294967295|b>>>25),b=N+(D^P&(A^D))+M[5]+1200080426&4294967295,N=P+(b<<12&4294967295|b>>>20),b=D+(A^N&(P^A))+M[6]+2821735955&4294967295,D=N+(b<<17&4294967295|b>>>15),b=A+(P^D&(N^P))+M[7]+4249261313&4294967295,A=D+(b<<22&4294967295|b>>>10),b=P+(N^A&(D^N))+M[8]+1770035416&4294967295,P=A+(b<<7&4294967295|b>>>25),b=N+(D^P&(A^D))+M[9]+2336552879&4294967295,N=P+(b<<12&4294967295|b>>>20),b=D+(A^N&(P^A))+M[10]+4294925233&4294967295,D=N+(b<<17&4294967295|b>>>15),b=A+(P^D&(N^P))+M[11]+2304563134&4294967295,A=D+(b<<22&4294967295|b>>>10),b=P+(N^A&(D^N))+M[12]+1804603682&4294967295,P=A+(b<<7&4294967295|b>>>25),b=N+(D^P&(A^D))+M[13]+4254626195&4294967295,N=P+(b<<12&4294967295|b>>>20),b=D+(A^N&(P^A))+M[14]+2792965006&4294967295,D=N+(b<<17&4294967295|b>>>15),b=A+(P^D&(N^P))+M[15]+1236535329&4294967295,A=D+(b<<22&4294967295|b>>>10),b=P+(D^N&(A^D))+M[1]+4129170786&4294967295,P=A+(b<<5&4294967295|b>>>27),b=N+(A^D&(P^A))+M[6]+3225465664&4294967295,N=P+(b<<9&4294967295|b>>>23),b=D+(P^A&(N^P))+M[11]+643717713&4294967295,D=N+(b<<14&4294967295|b>>>18),b=A+(N^P&(D^N))+M[0]+3921069994&4294967295,A=D+(b<<20&4294967295|b>>>12),b=P+(D^N&(A^D))+M[5]+3593408605&4294967295,P=A+(b<<5&4294967295|b>>>27),b=N+(A^D&(P^A))+M[10]+38016083&4294967295,N=P+(b<<9&4294967295|b>>>23),b=D+(P^A&(N^P))+M[15]+3634488961&4294967295,D=N+(b<<14&4294967295|b>>>18),b=A+(N^P&(D^N))+M[4]+3889429448&4294967295,A=D+(b<<20&4294967295|b>>>12),b=P+(D^N&(A^D))+M[9]+568446438&4294967295,P=A+(b<<5&4294967295|b>>>27),b=N+(A^D&(P^A))+M[14]+3275163606&4294967295,N=P+(b<<9&4294967295|b>>>23),b=D+(P^A&(N^P))+M[3]+4107603335&4294967295,D=N+(b<<14&4294967295|b>>>18),b=A+(N^P&(D^N))+M[8]+1163531501&4294967295,A=D+(b<<20&4294967295|b>>>12),b=P+(D^N&(A^D))+M[13]+2850285829&4294967295,P=A+(b<<5&4294967295|b>>>27),b=N+(A^D&(P^A))+M[2]+4243563512&4294967295,N=P+(b<<9&4294967295|b>>>23),b=D+(P^A&(N^P))+M[7]+1735328473&4294967295,D=N+(b<<14&4294967295|b>>>18),b=A+(N^P&(D^N))+M[12]+2368359562&4294967295,A=D+(b<<20&4294967295|b>>>12),b=P+(A^D^N)+M[5]+4294588738&4294967295,P=A+(b<<4&4294967295|b>>>28),b=N+(P^A^D)+M[8]+2272392833&4294967295,N=P+(b<<11&4294967295|b>>>21),b=D+(N^P^A)+M[11]+1839030562&4294967295,D=N+(b<<16&4294967295|b>>>16),b=A+(D^N^P)+M[14]+4259657740&4294967295,A=D+(b<<23&4294967295|b>>>9),b=P+(A^D^N)+M[1]+2763975236&4294967295,P=A+(b<<4&4294967295|b>>>28),b=N+(P^A^D)+M[4]+1272893353&4294967295,N=P+(b<<11&4294967295|b>>>21),b=D+(N^P^A)+M[7]+4139469664&4294967295,D=N+(b<<16&4294967295|b>>>16),b=A+(D^N^P)+M[10]+3200236656&4294967295,A=D+(b<<23&4294967295|b>>>9),b=P+(A^D^N)+M[13]+681279174&4294967295,P=A+(b<<4&4294967295|b>>>28),b=N+(P^A^D)+M[0]+3936430074&4294967295,N=P+(b<<11&4294967295|b>>>21),b=D+(N^P^A)+M[3]+3572445317&4294967295,D=N+(b<<16&4294967295|b>>>16),b=A+(D^N^P)+M[6]+76029189&4294967295,A=D+(b<<23&4294967295|b>>>9),b=P+(A^D^N)+M[9]+3654602809&4294967295,P=A+(b<<4&4294967295|b>>>28),b=N+(P^A^D)+M[12]+3873151461&4294967295,N=P+(b<<11&4294967295|b>>>21),b=D+(N^P^A)+M[15]+530742520&4294967295,D=N+(b<<16&4294967295|b>>>16),b=A+(D^N^P)+M[2]+3299628645&4294967295,A=D+(b<<23&4294967295|b>>>9),b=P+(D^(A|~N))+M[0]+4096336452&4294967295,P=A+(b<<6&4294967295|b>>>26),b=N+(A^(P|~D))+M[7]+1126891415&4294967295,N=P+(b<<10&4294967295|b>>>22),b=D+(P^(N|~A))+M[14]+2878612391&4294967295,D=N+(b<<15&4294967295|b>>>17),b=A+(N^(D|~P))+M[5]+4237533241&4294967295,A=D+(b<<21&4294967295|b>>>11),b=P+(D^(A|~N))+M[12]+1700485571&4294967295,P=A+(b<<6&4294967295|b>>>26),b=N+(A^(P|~D))+M[3]+2399980690&4294967295,N=P+(b<<10&4294967295|b>>>22),b=D+(P^(N|~A))+M[10]+4293915773&4294967295,D=N+(b<<15&4294967295|b>>>17),b=A+(N^(D|~P))+M[1]+2240044497&4294967295,A=D+(b<<21&4294967295|b>>>11),b=P+(D^(A|~N))+M[8]+1873313359&4294967295,P=A+(b<<6&4294967295|b>>>26),b=N+(A^(P|~D))+M[15]+4264355552&4294967295,N=P+(b<<10&4294967295|b>>>22),b=D+(P^(N|~A))+M[6]+2734768916&4294967295,D=N+(b<<15&4294967295|b>>>17),b=A+(N^(D|~P))+M[13]+1309151649&4294967295,A=D+(b<<21&4294967295|b>>>11),b=P+(D^(A|~N))+M[4]+4149444226&4294967295,P=A+(b<<6&4294967295|b>>>26),b=N+(A^(P|~D))+M[11]+3174756917&4294967295,N=P+(b<<10&4294967295|b>>>22),b=D+(P^(N|~A))+M[2]+718787259&4294967295,D=N+(b<<15&4294967295|b>>>17),b=A+(N^(D|~P))+M[9]+3951481745&4294967295,C.g[0]=C.g[0]+P&4294967295,C.g[1]=C.g[1]+(D+(b<<21&4294967295|b>>>11))&4294967295,C.g[2]=C.g[2]+D&4294967295,C.g[3]=C.g[3]+N&4294967295}s.prototype.u=function(C,P){P===void 0&&(P=C.length);for(var A=P-this.blockSize,M=this.B,D=this.h,N=0;N<P;){if(D==0)for(;N<=A;)a(this,C,N),N+=this.blockSize;if(typeof C=="string"){for(;N<P;)if(M[D++]=C.charCodeAt(N++),D==this.blockSize){a(this,M),D=0;break}}else for(;N<P;)if(M[D++]=C[N++],D==this.blockSize){a(this,M),D=0;break}}this.h=D,this.o+=P},s.prototype.v=function(){var C=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);C[0]=128;for(var P=1;P<C.length-8;++P)C[P]=0;var A=8*this.o;for(P=C.length-8;P<C.length;++P)C[P]=A&255,A/=256;for(this.u(C),C=Array(16),P=A=0;4>P;++P)for(var M=0;32>M;M+=8)C[A++]=this.g[P]>>>M&255;return C};function l(C,P){var A=f;return Object.prototype.hasOwnProperty.call(A,C)?A[C]:A[C]=P(C)}function d(C,P){this.h=P;for(var A=[],M=!0,D=C.length-1;0<=D;D--){var N=C[D]|0;M&&N==P||(A[D]=N,M=!1)}this.g=A}var f={};function m(C){return-128<=C&&128>C?l(C,function(P){return new d([P|0],0>P?-1:0)}):new d([C|0],0>C?-1:0)}function v(C){if(isNaN(C)||!isFinite(C))return T;if(0>C)return O(v(-C));for(var P=[],A=1,M=0;C>=A;M++)P[M]=C/A|0,A*=4294967296;return new d(P,0)}function w(C,P){if(C.length==0)throw Error("number format error: empty string");if(P=P||10,2>P||36<P)throw Error("radix out of range: "+P);if(C.charAt(0)=="-")return O(w(C.substring(1),P));if(0<=C.indexOf("-"))throw Error('number format error: interior "-" character');for(var A=v(Math.pow(P,8)),M=T,D=0;D<C.length;D+=8){var N=Math.min(8,C.length-D),b=parseInt(C.substring(D,D+N),P);8>N?(N=v(Math.pow(P,N)),M=M.j(N).add(v(b))):(M=M.j(A),M=M.add(v(b)))}return M}var T=m(0),I=m(1),U=m(16777216);n=d.prototype,n.m=function(){if($(this))return-O(this).m();for(var C=0,P=1,A=0;A<this.g.length;A++){var M=this.i(A);C+=(0<=M?M:4294967296+M)*P,P*=4294967296}return C},n.toString=function(C){if(C=C||10,2>C||36<C)throw Error("radix out of range: "+C);if(X(this))return"0";if($(this))return"-"+O(this).toString(C);for(var P=v(Math.pow(C,6)),A=this,M="";;){var D=_e(A,P).g;A=se(A,D.j(P));var N=((0<A.g.length?A.g[0]:A.h)>>>0).toString(C);if(A=D,X(A))return N+M;for(;6>N.length;)N="0"+N;M=N+M}},n.i=function(C){return 0>C?0:C<this.g.length?this.g[C]:this.h};function X(C){if(C.h!=0)return!1;for(var P=0;P<C.g.length;P++)if(C.g[P]!=0)return!1;return!0}function $(C){return C.h==-1}n.l=function(C){return C=se(this,C),$(C)?-1:X(C)?0:1};function O(C){for(var P=C.g.length,A=[],M=0;M<P;M++)A[M]=~C.g[M];return new d(A,~C.h).add(I)}n.abs=function(){return $(this)?O(this):this},n.add=function(C){for(var P=Math.max(this.g.length,C.g.length),A=[],M=0,D=0;D<=P;D++){var N=M+(this.i(D)&65535)+(C.i(D)&65535),b=(N>>>16)+(this.i(D)>>>16)+(C.i(D)>>>16);M=b>>>16,N&=65535,b&=65535,A[D]=b<<16|N}return new d(A,A[A.length-1]&-2147483648?-1:0)};function se(C,P){return C.add(O(P))}n.j=function(C){if(X(this)||X(C))return T;if($(this))return $(C)?O(this).j(O(C)):O(O(this).j(C));if($(C))return O(this.j(O(C)));if(0>this.l(U)&&0>C.l(U))return v(this.m()*C.m());for(var P=this.g.length+C.g.length,A=[],M=0;M<2*P;M++)A[M]=0;for(M=0;M<this.g.length;M++)for(var D=0;D<C.g.length;D++){var N=this.i(M)>>>16,b=this.i(M)&65535,J=C.i(D)>>>16,ne=C.i(D)&65535;A[2*M+2*D]+=b*ne,Te(A,2*M+2*D),A[2*M+2*D+1]+=N*ne,Te(A,2*M+2*D+1),A[2*M+2*D+1]+=b*J,Te(A,2*M+2*D+1),A[2*M+2*D+2]+=N*J,Te(A,2*M+2*D+2)}for(M=0;M<P;M++)A[M]=A[2*M+1]<<16|A[2*M];for(M=P;M<2*P;M++)A[M]=0;return new d(A,0)};function Te(C,P){for(;(C[P]&65535)!=C[P];)C[P+1]+=C[P]>>>16,C[P]&=65535,P++}function xe(C,P){this.g=C,this.h=P}function _e(C,P){if(X(P))throw Error("division by zero");if(X(C))return new xe(T,T);if($(C))return P=_e(O(C),P),new xe(O(P.g),O(P.h));if($(P))return P=_e(C,O(P)),new xe(O(P.g),P.h);if(30<C.g.length){if($(C)||$(P))throw Error("slowDivide_ only works with positive integers.");for(var A=I,M=P;0>=M.l(C);)A=V(A),M=V(M);var D=ie(A,1),N=ie(M,1);for(M=ie(M,2),A=ie(A,2);!X(M);){var b=N.add(M);0>=b.l(C)&&(D=D.add(A),N=b),M=ie(M,1),A=ie(A,1)}return P=se(C,D.j(P)),new xe(D,P)}for(D=T;0<=C.l(P);){for(A=Math.max(1,Math.floor(C.m()/P.m())),M=Math.ceil(Math.log(A)/Math.LN2),M=48>=M?1:Math.pow(2,M-48),N=v(A),b=N.j(P);$(b)||0<b.l(C);)A-=M,N=v(A),b=N.j(P);X(N)&&(N=I),D=D.add(N),C=se(C,b)}return new xe(D,C)}n.A=function(C){return _e(this,C).h},n.and=function(C){for(var P=Math.max(this.g.length,C.g.length),A=[],M=0;M<P;M++)A[M]=this.i(M)&C.i(M);return new d(A,this.h&C.h)},n.or=function(C){for(var P=Math.max(this.g.length,C.g.length),A=[],M=0;M<P;M++)A[M]=this.i(M)|C.i(M);return new d(A,this.h|C.h)},n.xor=function(C){for(var P=Math.max(this.g.length,C.g.length),A=[],M=0;M<P;M++)A[M]=this.i(M)^C.i(M);return new d(A,this.h^C.h)};function V(C){for(var P=C.g.length+1,A=[],M=0;M<P;M++)A[M]=C.i(M)<<1|C.i(M-1)>>>31;return new d(A,C.h)}function ie(C,P){var A=P>>5;P%=32;for(var M=C.g.length-A,D=[],N=0;N<M;N++)D[N]=0<P?C.i(N+A)>>>P|C.i(N+A+1)<<32-P:C.i(N+A);return new d(D,C.h)}s.prototype.digest=s.prototype.v,s.prototype.reset=s.prototype.s,s.prototype.update=s.prototype.u,L0=s,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.A,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=v,d.fromString=w,Qi=d}).apply(typeof lv<"u"?lv:typeof self<"u"?self:typeof window<"u"?window:{});var yu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var V0,Al,M0,Pu,Df,O0,F0,U0;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,g,_){return u==Array.prototype||u==Object.prototype||(u[g]=_.value),u};function t(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof yu=="object"&&yu];for(var g=0;g<u.length;++g){var _=u[g];if(_&&_.Math==Math)return _}throw Error("Cannot find global object")}var s=t(this);function a(u,g){if(g)e:{var _=s;u=u.split(".");for(var R=0;R<u.length-1;R++){var Z=u[R];if(!(Z in _))break e;_=_[Z]}u=u[u.length-1],R=_[u],g=g(R),g!=R&&g!=null&&e(_,u,{configurable:!0,writable:!0,value:g})}}function l(u,g){u instanceof String&&(u+="");var _=0,R=!1,Z={next:function(){if(!R&&_<u.length){var ae=_++;return{value:g(ae,u[ae]),done:!1}}return R=!0,{done:!0,value:void 0}}};return Z[Symbol.iterator]=function(){return Z},Z}a("Array.prototype.values",function(u){return u||function(){return l(this,function(g,_){return _})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var d=d||{},f=this||self;function m(u){var g=typeof u;return g=g!="object"?g:u?Array.isArray(u)?"array":g:"null",g=="array"||g=="object"&&typeof u.length=="number"}function v(u){var g=typeof u;return g=="object"&&u!=null||g=="function"}function w(u,g,_){return u.call.apply(u.bind,arguments)}function T(u,g,_){if(!u)throw Error();if(2<arguments.length){var R=Array.prototype.slice.call(arguments,2);return function(){var Z=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Z,R),u.apply(g,Z)}}return function(){return u.apply(g,arguments)}}function I(u,g,_){return I=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?w:T,I.apply(null,arguments)}function U(u,g){var _=Array.prototype.slice.call(arguments,1);return function(){var R=_.slice();return R.push.apply(R,arguments),u.apply(this,R)}}function X(u,g){function _(){}_.prototype=g.prototype,u.aa=g.prototype,u.prototype=new _,u.prototype.constructor=u,u.Qb=function(R,Z,ae){for(var Ve=Array(arguments.length-2),jt=2;jt<arguments.length;jt++)Ve[jt-2]=arguments[jt];return g.prototype[Z].apply(R,Ve)}}function $(u){const g=u.length;if(0<g){const _=Array(g);for(let R=0;R<g;R++)_[R]=u[R];return _}return[]}function O(u,g){for(let _=1;_<arguments.length;_++){const R=arguments[_];if(m(R)){const Z=u.length||0,ae=R.length||0;u.length=Z+ae;for(let Ve=0;Ve<ae;Ve++)u[Z+Ve]=R[Ve]}else u.push(R)}}class se{constructor(g,_){this.i=g,this.j=_,this.h=0,this.g=null}get(){let g;return 0<this.h?(this.h--,g=this.g,this.g=g.next,g.next=null):g=this.i(),g}}function Te(u){return/^[\s\xa0]*$/.test(u)}function xe(){var u=f.navigator;return u&&(u=u.userAgent)?u:""}function _e(u){return _e[" "](u),u}_e[" "]=function(){};var V=xe().indexOf("Gecko")!=-1&&!(xe().toLowerCase().indexOf("webkit")!=-1&&xe().indexOf("Edge")==-1)&&!(xe().indexOf("Trident")!=-1||xe().indexOf("MSIE")!=-1)&&xe().indexOf("Edge")==-1;function ie(u,g,_){for(const R in u)g.call(_,u[R],R,u)}function C(u,g){for(const _ in u)g.call(void 0,u[_],_,u)}function P(u){const g={};for(const _ in u)g[_]=u[_];return g}const A="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function M(u,g){let _,R;for(let Z=1;Z<arguments.length;Z++){R=arguments[Z];for(_ in R)u[_]=R[_];for(let ae=0;ae<A.length;ae++)_=A[ae],Object.prototype.hasOwnProperty.call(R,_)&&(u[_]=R[_])}}function D(u){var g=1;u=u.split(":");const _=[];for(;0<g&&u.length;)_.push(u.shift()),g--;return u.length&&_.push(u.join(":")),_}function N(u){f.setTimeout(()=>{throw u},0)}function b(){var u=Ie;let g=null;return u.g&&(g=u.g,u.g=u.g.next,u.g||(u.h=null),g.next=null),g}class J{constructor(){this.h=this.g=null}add(g,_){const R=ne.get();R.set(g,_),this.h?this.h.next=R:this.g=R,this.h=R}}var ne=new se(()=>new Re,u=>u.reset());class Re{constructor(){this.next=this.g=this.h=null}set(g,_){this.h=g,this.g=_,this.next=null}reset(){this.next=this.g=this.h=null}}let he,le=!1,Ie=new J,ve=()=>{const u=f.Promise.resolve(void 0);he=()=>{u.then(Y)}};var Y=()=>{for(var u;u=b();){try{u.h.call(u.g)}catch(_){N(_)}var g=ne;g.j(u),100>g.h&&(g.h++,u.next=g.g,g.g=u)}le=!1};function k(){this.s=this.s,this.C=this.C}k.prototype.s=!1,k.prototype.ma=function(){this.s||(this.s=!0,this.N())},k.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function q(u,g){this.type=u,this.g=this.target=g,this.defaultPrevented=!1}q.prototype.h=function(){this.defaultPrevented=!0};var Ee=(function(){if(!f.addEventListener||!Object.defineProperty)return!1;var u=!1,g=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const _=()=>{};f.addEventListener("test",_,g),f.removeEventListener("test",_,g)}catch{}return u})();function Le(u,g){if(q.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var _=this.type=u.type,R=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=g,g=u.relatedTarget){if(V){e:{try{_e(g.nodeName);var Z=!0;break e}catch{}Z=!1}Z||(g=null)}}else _=="mouseover"?g=u.fromElement:_=="mouseout"&&(g=u.toElement);this.relatedTarget=g,R?(this.clientX=R.clientX!==void 0?R.clientX:R.pageX,this.clientY=R.clientY!==void 0?R.clientY:R.pageY,this.screenX=R.screenX||0,this.screenY=R.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:De[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&Le.aa.h.call(this)}}X(Le,q);var De={2:"touch",3:"pen",4:"mouse"};Le.prototype.h=function(){Le.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var Fe="closure_listenable_"+(1e6*Math.random()|0),Qe=0;function st(u,g,_,R,Z){this.listener=u,this.proxy=null,this.src=g,this.type=_,this.capture=!!R,this.ha=Z,this.key=++Qe,this.da=this.fa=!1}function ye(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function ce(u){this.src=u,this.g={},this.h=0}ce.prototype.add=function(u,g,_,R,Z){var ae=u.toString();u=this.g[ae],u||(u=this.g[ae]=[],this.h++);var Ve=me(u,g,R,Z);return-1<Ve?(g=u[Ve],_||(g.fa=!1)):(g=new st(g,this.src,ae,!!R,Z),g.fa=_,u.push(g)),g};function Me(u,g){var _=g.type;if(_ in u.g){var R=u.g[_],Z=Array.prototype.indexOf.call(R,g,void 0),ae;(ae=0<=Z)&&Array.prototype.splice.call(R,Z,1),ae&&(ye(g),u.g[_].length==0&&(delete u.g[_],u.h--))}}function me(u,g,_,R){for(var Z=0;Z<u.length;++Z){var ae=u[Z];if(!ae.da&&ae.listener==g&&ae.capture==!!_&&ae.ha==R)return Z}return-1}var He="closure_lm_"+(1e6*Math.random()|0),Ye={};function Tt(u,g,_,R,Z){if(Array.isArray(g)){for(var ae=0;ae<g.length;ae++)Tt(u,g[ae],_,R,Z);return null}return _=Kn(_),u&&u[Fe]?u.K(g,_,v(R)?!!R.capture:!1,Z):Ct(u,g,_,!1,R,Z)}function Ct(u,g,_,R,Z,ae){if(!g)throw Error("Invalid event type");var Ve=v(Z)?!!Z.capture:!!Z,jt=lr(u);if(jt||(u[He]=jt=new ce(u)),_=jt.add(g,_,R,Ve,ae),_.proxy)return _;if(R=gt(),_.proxy=R,R.src=u,R.listener=_,u.addEventListener)Ee||(Z=Ve),Z===void 0&&(Z=!1),u.addEventListener(g.toString(),R,Z);else if(u.attachEvent)u.attachEvent(tn(g.toString()),R);else if(u.addListener&&u.removeListener)u.addListener(R);else throw Error("addEventListener and attachEvent are unavailable.");return _}function gt(){function u(_){return g.call(u.src,u.listener,_)}const g=nn;return u}function Nt(u,g,_,R,Z){if(Array.isArray(g))for(var ae=0;ae<g.length;ae++)Nt(u,g[ae],_,R,Z);else R=v(R)?!!R.capture:!!R,_=Kn(_),u&&u[Fe]?(u=u.i,g=String(g).toString(),g in u.g&&(ae=u.g[g],_=me(ae,_,R,Z),-1<_&&(ye(ae[_]),Array.prototype.splice.call(ae,_,1),ae.length==0&&(delete u.g[g],u.h--)))):u&&(u=lr(u))&&(g=u.g[g.toString()],u=-1,g&&(u=me(g,_,R,Z)),(_=-1<u?g[u]:null)&&Qt(_))}function Qt(u){if(typeof u!="number"&&u&&!u.da){var g=u.src;if(g&&g[Fe])Me(g.i,u);else{var _=u.type,R=u.proxy;g.removeEventListener?g.removeEventListener(_,R,u.capture):g.detachEvent?g.detachEvent(tn(_),R):g.addListener&&g.removeListener&&g.removeListener(R),(_=lr(g))?(Me(_,u),_.h==0&&(_.src=null,g[He]=null)):ye(u)}}}function tn(u){return u in Ye?Ye[u]:Ye[u]="on"+u}function nn(u,g){if(u.da)u=!0;else{g=new Le(g,this);var _=u.listener,R=u.ha||u.src;u.fa&&Qt(u),u=_.call(R,g)}return u}function lr(u){return u=u[He],u instanceof ce?u:null}var rn="__closure_events_fn_"+(1e9*Math.random()>>>0);function Kn(u){return typeof u=="function"?u:(u[rn]||(u[rn]=function(g){return u.handleEvent(g)}),u[rn])}function Ot(){k.call(this),this.i=new ce(this),this.M=this,this.F=null}X(Ot,k),Ot.prototype[Fe]=!0,Ot.prototype.removeEventListener=function(u,g,_,R){Nt(this,u,g,_,R)};function $t(u,g){var _,R=u.F;if(R)for(_=[];R;R=R.F)_.push(R);if(u=u.M,R=g.type||g,typeof g=="string")g=new q(g,u);else if(g instanceof q)g.target=g.target||u;else{var Z=g;g=new q(R,u),M(g,Z)}if(Z=!0,_)for(var ae=_.length-1;0<=ae;ae--){var Ve=g.g=_[ae];Z=On(Ve,R,!0,g)&&Z}if(Ve=g.g=u,Z=On(Ve,R,!0,g)&&Z,Z=On(Ve,R,!1,g)&&Z,_)for(ae=0;ae<_.length;ae++)Ve=g.g=_[ae],Z=On(Ve,R,!1,g)&&Z}Ot.prototype.N=function(){if(Ot.aa.N.call(this),this.i){var u=this.i,g;for(g in u.g){for(var _=u.g[g],R=0;R<_.length;R++)ye(_[R]);delete u.g[g],u.h--}}this.F=null},Ot.prototype.K=function(u,g,_,R){return this.i.add(String(u),g,!1,_,R)},Ot.prototype.L=function(u,g,_,R){return this.i.add(String(u),g,!0,_,R)};function On(u,g,_,R){if(g=u.i.g[String(g)],!g)return!0;g=g.concat();for(var Z=!0,ae=0;ae<g.length;++ae){var Ve=g[ae];if(Ve&&!Ve.da&&Ve.capture==_){var jt=Ve.listener,xn=Ve.ha||Ve.src;Ve.fa&&Me(u.i,Ve),Z=jt.call(xn,R)!==!1&&Z}}return Z&&!R.defaultPrevented}function cr(u,g,_){if(typeof u=="function")_&&(u=I(u,_));else if(u&&typeof u.handleEvent=="function")u=I(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(g)?-1:f.setTimeout(u,g||0)}function Cn(u){u.g=cr(()=>{u.g=null,u.i&&(u.i=!1,Cn(u))},u.l);const g=u.h;u.h=null,u.m.apply(null,g)}class Fn extends k{constructor(g,_){super(),this.m=g,this.l=_,this.h=null,this.i=!1,this.g=null}j(g){this.h=arguments,this.g?this.i=!0:Cn(this)}N(){super.N(),this.g&&(f.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Yt(u){k.call(this),this.h=u,this.g={}}X(Yt,k);var es=[];function In(u){ie(u.g,function(g,_){this.g.hasOwnProperty(_)&&Qt(g)},u),u.g={}}Yt.prototype.N=function(){Yt.aa.N.call(this),In(this)},Yt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var gn=f.JSON.stringify,ts=f.JSON.parse,Ts=class{stringify(u){return f.JSON.stringify(u,void 0)}parse(u){return f.JSON.parse(u,void 0)}};function Pt(){}Pt.prototype.h=null;function pr(u){return u.h||(u.h=u.i())}function Ss(){}var Qn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Yn(){q.call(this,"d")}X(Yn,q);function Ir(){q.call(this,"c")}X(Ir,q);var Pn={},Pr=null;function Jn(){return Pr=Pr||new Ot}Pn.La="serverreachability";function Ws(u){q.call(this,Pn.La,u)}X(Ws,q);function mr(u){const g=Jn();$t(g,new Ws(g))}Pn.STAT_EVENT="statevent";function Gs(u,g){q.call(this,Pn.STAT_EVENT,u),this.stat=g}X(Gs,q);function rt(u){const g=Jn();$t(g,new Gs(g,u))}Pn.Ma="timingevent";function Xn(u,g){q.call(this,Pn.Ma,u),this.size=g}X(Xn,q);function Nn(u,g){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return f.setTimeout(function(){u()},g)}function ns(){this.g=!0}ns.prototype.xa=function(){this.g=!1};function Rn(u,g,_,R,Z,ae){u.info(function(){if(u.g)if(ae)for(var Ve="",jt=ae.split("&"),xn=0;xn<jt.length;xn++){var xt=jt[xn].split("=");if(1<xt.length){var kn=xt[0];xt=xt[1];var dn=kn.split("_");Ve=2<=dn.length&&dn[1]=="type"?Ve+(kn+"="+xt+"&"):Ve+(kn+"=redacted&")}}else Ve=null;else Ve=ae;return"XMLHTTP REQ ("+R+") [attempt "+Z+"]: "+g+`
`+_+`
`+Ve})}function yn(u,g,_,R,Z,ae,Ve){u.info(function(){return"XMLHTTP RESP ("+R+") [ attempt "+Z+"]: "+g+`
`+_+`
`+ae+" "+Ve})}function An(u,g,_,R){u.info(function(){return"XMLHTTP TEXT ("+g+"): "+Cs(u,_)+(R?" "+R:"")})}function bs(u,g){u.info(function(){return"TIMEOUT: "+g})}ns.prototype.info=function(){};function Cs(u,g){if(!u.g)return g;if(!g)return null;try{var _=JSON.parse(g);if(_){for(u=0;u<_.length;u++)if(Array.isArray(_[u])){var R=_[u];if(!(2>R.length)){var Z=R[1];if(Array.isArray(Z)&&!(1>Z.length)){var ae=Z[0];if(ae!="noop"&&ae!="stop"&&ae!="close")for(var Ve=1;Ve<Z.length;Ve++)Z[Ve]=""}}}}return gn(_)}catch{return g}}var Un={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Fr={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Ft;function rs(){}X(rs,Pt),rs.prototype.g=function(){return new XMLHttpRequest},rs.prototype.i=function(){return{}},Ft=new rs;function un(u,g,_,R){this.j=u,this.i=g,this.l=_,this.R=R||1,this.U=new Yt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Nr}function Nr(){this.i=null,this.g="",this.h=!1}var qs={},Ur={};function ss(u,g,_){u.L=1,u.v=Is(Jt(g)),u.m=_,u.P=!0,vn(u,null)}function vn(u,g){u.F=Date.now(),ht(u),u.A=Jt(u.v);var _=u.A,R=u.R;Array.isArray(R)||(R=[String(R)]),Lt(_.i,"t",R),u.C=0,_=u.j.J,u.h=new Nr,u.g=wc(u.j,_?g:null,!u.m),0<u.O&&(u.M=new Fn(I(u.Y,u,u.g),u.O)),g=u.U,_=u.g,R=u.ca;var Z="readystatechange";Array.isArray(Z)||(Z&&(es[0]=Z.toString()),Z=es);for(var ae=0;ae<Z.length;ae++){var Ve=Tt(_,Z[ae],R||g.handleEvent,!1,g.h||g);if(!Ve)break;g.g[Ve.key]=Ve}g=u.H?P(u.H):{},u.m?(u.u||(u.u="POST"),g["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,g)):(u.u="GET",u.g.ea(u.A,u.u,null,g)),mr(),Rn(u.i,u.u,u.A,u.l,u.R,u.m)}un.prototype.ca=function(u){u=u.target;const g=this.M;g&&gr(u)==3?g.j():this.Y(u)},un.prototype.Y=function(u){try{if(u==this.g)e:{const dn=gr(this.g);var g=this.g.Ba();const Br=this.g.Z();if(!(3>dn)&&(dn!=3||this.g&&(this.h.h||this.g.oa()||Zo(this.g)))){this.J||dn!=4||g==7||(g==8||0>=Br?mr(3):mr(2)),jn(this);var _=this.g.Z();this.X=_;t:if(Hs(this)){var R=Zo(this.g);u="";var Z=R.length,ae=gr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){W(this),x(this);var Ve="";break t}this.h.i=new f.TextDecoder}for(g=0;g<Z;g++)this.h.h=!0,u+=this.h.i.decode(R[g],{stream:!(ae&&g==Z-1)});R.length=0,this.h.g+=u,this.C=0,Ve=this.h.g}else Ve=this.g.oa();if(this.o=_==200,yn(this.i,this.u,this.A,this.l,this.R,dn,_),this.o){if(this.T&&!this.K){t:{if(this.g){var jt,xn=this.g;if((jt=xn.g?xn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Te(jt)){var xt=jt;break t}}xt=null}if(_=xt)An(this.i,this.l,_,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,G(this,_);else{this.o=!1,this.s=3,rt(12),W(this),x(this);break e}}if(this.P){_=!0;let kr;for(;!this.J&&this.C<Ve.length;)if(kr=Ks(this,Ve),kr==Ur){dn==4&&(this.s=4,rt(14),_=!1),An(this.i,this.l,null,"[Incomplete Response]");break}else if(kr==qs){this.s=4,rt(15),An(this.i,this.l,Ve,"[Invalid Chunk]"),_=!1;break}else An(this.i,this.l,kr,null),G(this,kr);if(Hs(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),dn!=4||Ve.length!=0||this.h.h||(this.s=1,rt(16),_=!1),this.o=this.o&&_,!_)An(this.i,this.l,Ve,"[Invalid Chunked Response]"),W(this),x(this);else if(0<Ve.length&&!this.W){this.W=!0;var kn=this.j;kn.g==this&&kn.ba&&!kn.M&&(kn.j.info("Great, no buffering proxy detected. Bytes received: "+Ve.length),tl(kn),kn.M=!0,rt(11))}}else An(this.i,this.l,Ve,null),G(this,Ve);dn==4&&W(this),this.o&&!this.J&&(dn==4?Ya(this.j,this):(this.o=!1,ht(this)))}else Ga(this.g),_==400&&0<Ve.indexOf("Unknown SID")?(this.s=3,rt(12)):(this.s=0,rt(13)),W(this),x(this)}}}catch{}finally{}};function Hs(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function Ks(u,g){var _=u.C,R=g.indexOf(`
`,_);return R==-1?Ur:(_=Number(g.substring(_,R)),isNaN(_)?qs:(R+=1,R+_>g.length?Ur:(g=g.slice(R,R+_),u.C=R+_,g)))}un.prototype.cancel=function(){this.J=!0,W(this)};function ht(u){u.S=Date.now()+u.I,is(u,u.I)}function is(u,g){if(u.B!=null)throw Error("WatchDog timer not null");u.B=Nn(I(u.ba,u),g)}function jn(u){u.B&&(f.clearTimeout(u.B),u.B=null)}un.prototype.ba=function(){this.B=null;const u=Date.now();0<=u-this.S?(bs(this.i,this.A),this.L!=2&&(mr(),rt(17)),W(this),this.s=2,x(this)):is(this,this.S-u)};function x(u){u.j.G==0||u.J||Ya(u.j,u)}function W(u){jn(u);var g=u.M;g&&typeof g.ma=="function"&&g.ma(),u.M=null,In(u.U),u.g&&(g=u.g,u.g=null,g.abort(),g.ma())}function G(u,g){try{var _=u.j;if(_.G!=0&&(_.g==u||Ae(_.h,u))){if(!u.K&&Ae(_.h,u)&&_.G==3){try{var R=_.Da.g.parse(g)}catch{R=null}if(Array.isArray(R)&&R.length==3){var Z=R;if(Z[0]==0){e:if(!_.u){if(_.g)if(_.g.F+3e3<u.F)Qa(_),us(_);else break e;Ka(_),rt(18)}}else _.za=Z[1],0<_.za-_.T&&37500>Z[2]&&_.F&&_.v==0&&!_.C&&(_.C=Nn(I(_.Za,_),6e3));if(1>=oe(_.h)&&_.ca){try{_.ca()}catch{}_.ca=void 0}}else Xs(_,11)}else if((u.K||_.g==u)&&Qa(_),!Te(g))for(Z=_.Da.g.parse(g),g=0;g<Z.length;g++){let xt=Z[g];if(_.T=xt[0],xt=xt[1],_.G==2)if(xt[0]=="c"){_.K=xt[1],_.ia=xt[2];const kn=xt[3];kn!=null&&(_.la=kn,_.j.info("VER="+_.la));const dn=xt[4];dn!=null&&(_.Aa=dn,_.j.info("SVER="+_.Aa));const Br=xt[5];Br!=null&&typeof Br=="number"&&0<Br&&(R=1.5*Br,_.L=R,_.j.info("backChannelRequestTimeoutMs_="+R)),R=_;const kr=u.g;if(kr){const ha=kr.g?kr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ha){var ae=R.h;ae.g||ha.indexOf("spdy")==-1&&ha.indexOf("quic")==-1&&ha.indexOf("h2")==-1||(ae.j=ae.l,ae.g=new Set,ae.h&&(Pe(ae,ae.h),ae.h=null))}if(R.D){const Xa=kr.g?kr.g.getResponseHeader("X-HTTP-Session-Id"):null;Xa&&(R.ya=Xa,Rt(R.I,R.D,Xa))}}_.G=3,_.l&&_.l.ua(),_.ba&&(_.R=Date.now()-u.F,_.j.info("Handshake RTT: "+_.R+"ms")),R=_;var Ve=u;if(R.qa=_c(R,R.J?R.ia:null,R.W),Ve.K){Oe(R.h,Ve);var jt=Ve,xn=R.L;xn&&(jt.I=xn),jt.B&&(jn(jt),ht(jt)),R.g=Ve}else da(R);0<_.i.length&&Rs(_)}else xt[0]!="stop"&&xt[0]!="close"||Xs(_,7);else _.G==3&&(xt[0]=="stop"||xt[0]=="close"?xt[0]=="stop"?Xs(_,7):Bn(_):xt[0]!="noop"&&_.l&&_.l.ta(xt),_.v=0)}}mr(4)}catch{}}var F=class{constructor(u,g){this.g=u,this.map=g}};function H(u){this.l=u||10,f.PerformanceNavigationTiming?(u=f.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(f.chrome&&f.chrome.loadTimes&&f.chrome.loadTimes()&&f.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function ue(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function oe(u){return u.h?1:u.g?u.g.size:0}function Ae(u,g){return u.h?u.h==g:u.g?u.g.has(g):!1}function Pe(u,g){u.g?u.g.add(g):u.h=g}function Oe(u,g){u.h&&u.h==g?u.h=null:u.g&&u.g.has(g)&&u.g.delete(g)}H.prototype.cancel=function(){if(this.i=de(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function de(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let g=u.i;for(const _ of u.g.values())g=g.concat(_.D);return g}return $(u.i)}function Ze(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(m(u)){for(var g=[],_=u.length,R=0;R<_;R++)g.push(u[R]);return g}g=[],_=0;for(R in u)g[_++]=u[R];return g}function je(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(m(u)||typeof u=="string"){var g=[];u=u.length;for(var _=0;_<u;_++)g.push(_);return g}g=[],_=0;for(const R in u)g[_++]=R;return g}}}function ut(u,g){if(u.forEach&&typeof u.forEach=="function")u.forEach(g,void 0);else if(m(u)||typeof u=="string")Array.prototype.forEach.call(u,g,void 0);else for(var _=je(u),R=Ze(u),Z=R.length,ae=0;ae<Z;ae++)g.call(void 0,R[ae],_&&_[ae],u)}var ur=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Qs(u,g){if(u){u=u.split("&");for(var _=0;_<u.length;_++){var R=u[_].indexOf("="),Z=null;if(0<=R){var ae=u[_].substring(0,R);Z=u[_].substring(R+1)}else ae=u[_];g(ae,Z?decodeURIComponent(Z.replace(/\+/g," ")):"")}}}function _n(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof _n){this.h=u.h,as(this,u.j),this.o=u.o,this.g=u.g,os(this,u.s),this.l=u.l;var g=u.i,_=new Ne;_.i=g.i,g.g&&(_.g=new Map(g.g),_.h=g.h),ls(this,_),this.m=u.m}else u&&(g=String(u).match(ur))?(this.h=!1,as(this,g[1]||"",!0),this.o=pt(g[2]||""),this.g=pt(g[3]||"",!0),os(this,g[4]),this.l=pt(g[5]||"",!0),ls(this,g[6]||"",!0),this.m=pt(g[7]||"")):(this.h=!1,this.i=new Ne(null,this.h))}_n.prototype.toString=function(){var u=[],g=this.j;g&&u.push(Ps(g,z,!0),":");var _=this.g;return(_||g=="file")&&(u.push("//"),(g=this.o)&&u.push(Ps(g,z,!0),"@"),u.push(encodeURIComponent(String(_)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_=this.s,_!=null&&u.push(":",String(_))),(_=this.l)&&(this.g&&_.charAt(0)!="/"&&u.push("/"),u.push(Ps(_,_.charAt(0)=="/"?fe:Q,!0))),(_=this.i.toString())&&u.push("?",_),(_=this.m)&&u.push("#",Ps(_,Ge)),u.join("")};function Jt(u){return new _n(u)}function as(u,g,_){u.j=_?pt(g,!0):g,u.j&&(u.j=u.j.replace(/:$/,""))}function os(u,g){if(g){if(g=Number(g),isNaN(g)||0>g)throw Error("Bad port number "+g);u.s=g}else u.s=null}function ls(u,g,_){g instanceof Ne?(u.i=g,sn(u.i,u.h)):(_||(g=Ps(g,be)),u.i=new Ne(g,u.h))}function Rt(u,g,_){u.i.set(g,_)}function Is(u){return Rt(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function pt(u,g){return u?g?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function Ps(u,g,_){return typeof u=="string"?(u=encodeURI(u).replace(g,S),_&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function S(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var z=/[#\/\?@]/g,Q=/[#\?:]/g,fe=/[#\?]/g,be=/[#\?@]/g,Ge=/#/g;function Ne(u,g){this.h=this.g=null,this.i=u||null,this.j=!!g}function Je(u){u.g||(u.g=new Map,u.h=0,u.i&&Qs(u.i,function(g,_){u.add(decodeURIComponent(g.replace(/\+/g," ")),_)}))}n=Ne.prototype,n.add=function(u,g){Je(this),this.i=null,u=St(this,u);var _=this.g.get(u);return _||this.g.set(u,_=[]),_.push(g),this.h+=1,this};function dt(u,g){Je(u),g=St(u,g),u.g.has(g)&&(u.i=null,u.h-=u.g.get(g).length,u.g.delete(g))}function yt(u,g){return Je(u),g=St(u,g),u.g.has(g)}n.forEach=function(u,g){Je(this),this.g.forEach(function(_,R){_.forEach(function(Z){u.call(g,Z,R,this)},this)},this)},n.na=function(){Je(this);const u=Array.from(this.g.values()),g=Array.from(this.g.keys()),_=[];for(let R=0;R<g.length;R++){const Z=u[R];for(let ae=0;ae<Z.length;ae++)_.push(g[R])}return _},n.V=function(u){Je(this);let g=[];if(typeof u=="string")yt(this,u)&&(g=g.concat(this.g.get(St(this,u))));else{u=Array.from(this.g.values());for(let _=0;_<u.length;_++)g=g.concat(u[_])}return g},n.set=function(u,g){return Je(this),this.i=null,u=St(this,u),yt(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[g]),this.h+=1,this},n.get=function(u,g){return u?(u=this.V(u),0<u.length?String(u[0]):g):g};function Lt(u,g,_){dt(u,g),0<_.length&&(u.i=null,u.g.set(St(u,g),$(_)),u.h+=_.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],g=Array.from(this.g.keys());for(var _=0;_<g.length;_++){var R=g[_];const ae=encodeURIComponent(String(R)),Ve=this.V(R);for(R=0;R<Ve.length;R++){var Z=ae;Ve[R]!==""&&(Z+="="+encodeURIComponent(String(Ve[R]))),u.push(Z)}}return this.i=u.join("&")};function St(u,g){return g=String(g),u.j&&(g=g.toLowerCase()),g}function sn(u,g){g&&!u.j&&(Je(u),u.i=null,u.g.forEach(function(_,R){var Z=R.toLowerCase();R!=Z&&(dt(this,R),Lt(this,Z,_))},u)),u.j=g}function wn(u,g){const _=new ns;if(f.Image){const R=new Image;R.onload=U(an,_,"TestLoadImage: loaded",!0,g,R),R.onerror=U(an,_,"TestLoadImage: error",!1,g,R),R.onabort=U(an,_,"TestLoadImage: abort",!1,g,R),R.ontimeout=U(an,_,"TestLoadImage: timeout",!1,g,R),f.setTimeout(function(){R.ontimeout&&R.ontimeout()},1e4),R.src=u}else g(!1)}function wt(u,g){const _=new ns,R=new AbortController,Z=setTimeout(()=>{R.abort(),an(_,"TestPingServer: timeout",!1,g)},1e4);fetch(u,{signal:R.signal}).then(ae=>{clearTimeout(Z),ae.ok?an(_,"TestPingServer: ok",!0,g):an(_,"TestPingServer: server error",!1,g)}).catch(()=>{clearTimeout(Z),an(_,"TestPingServer: error",!1,g)})}function an(u,g,_,R,Z){try{Z&&(Z.onload=null,Z.onerror=null,Z.onabort=null,Z.ontimeout=null),R(_)}catch{}}function Zn(){this.g=new Ts}function zr(u,g,_){const R=_||"";try{ut(u,function(Z,ae){let Ve=Z;v(Z)&&(Ve=gn(Z)),g.push(R+ae+"="+encodeURIComponent(Ve))})}catch(Z){throw g.push(R+"type="+encodeURIComponent("_badmap")),Z}}function Rr(u){this.l=u.Ub||null,this.j=u.eb||!1}X(Rr,Pt),Rr.prototype.g=function(){return new Ys(this.l,this.j)},Rr.prototype.i=(function(u){return function(){return u}})({});function Ys(u,g){Ot.call(this),this.D=u,this.o=g,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}X(Ys,Ot),n=Ys.prototype,n.open=function(u,g){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=g,this.readyState=1,zn(this)},n.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const g={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(g.body=u),(this.D||f).fetch(new Request(this.A,g)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ar(this)),this.readyState=0},n.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,zn(this)),this.g&&(this.readyState=3,zn(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof f.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Ba(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function Ba(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}n.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var g=u.value?u.value:new Uint8Array(0);(g=this.v.decode(g,{stream:!u.done}))&&(this.response=this.responseText+=g)}u.done?Ar(this):zn(this),this.readyState==3&&Ba(this)}},n.Ra=function(u){this.g&&(this.response=this.responseText=u,Ar(this))},n.Qa=function(u){this.g&&(this.response=u,Ar(this))},n.ga=function(){this.g&&Ar(this)};function Ar(u){u.readyState=4,u.l=null,u.j=null,u.v=null,zn(u)}n.setRequestHeader=function(u,g){this.u.append(u,g)},n.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],g=this.h.entries();for(var _=g.next();!_.done;)_=_.value,u.push(_[0]+": "+_[1]),_=g.next();return u.join(`\r
`)};function zn(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(Ys.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function cs(u){let g="";return ie(u,function(_,R){g+=R,g+=":",g+=_,g+=`\r
`}),g}function xi(u,g,_){e:{for(R in _){var R=!1;break e}R=!0}R||(_=cs(_),typeof u=="string"?_!=null&&encodeURIComponent(String(_)):Rt(u,g,_))}function Wt(u){Ot.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}X(Wt,Ot);var jd=/^https?$/i,Jo=["POST","PUT"];n=Wt.prototype,n.Ha=function(u){this.J=u},n.ea=function(u,g,_,R){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);g=g?g.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ft.g(),this.v=this.o?pr(this.o):pr(Ft),this.g.onreadystatechange=I(this.Ea,this);try{this.B=!0,this.g.open(g,String(u),!0),this.B=!1}catch(ae){ua(this,ae);return}if(u=_||"",_=new Map(this.headers),R)if(Object.getPrototypeOf(R)===Object.prototype)for(var Z in R)_.set(Z,R[Z]);else if(typeof R.keys=="function"&&typeof R.get=="function")for(const ae of R.keys())_.set(ae,R.get(ae));else throw Error("Unknown input type for opt_headers: "+String(R));R=Array.from(_.keys()).find(ae=>ae.toLowerCase()=="content-type"),Z=f.FormData&&u instanceof f.FormData,!(0<=Array.prototype.indexOf.call(Jo,g,void 0))||R||Z||_.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ae,Ve]of _)this.g.setRequestHeader(ae,Ve);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Wa(this),this.u=!0,this.g.send(u),this.u=!1}catch(ae){ua(this,ae)}};function ua(u,g){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=g,u.m=5,$a(u),jr(u)}function $a(u){u.A||(u.A=!0,$t(u,"complete"),$t(u,"error"))}n.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,$t(this,"complete"),$t(this,"abort"),jr(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),jr(this,!0)),Wt.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Xo(this):this.bb())},n.bb=function(){Xo(this)};function Xo(u){if(u.h&&typeof d<"u"&&(!u.v[1]||gr(u)!=4||u.Z()!=2)){if(u.u&&gr(u)==4)cr(u.Ea,0,u);else if($t(u,"readystatechange"),gr(u)==4){u.h=!1;try{const Ve=u.Z();e:switch(Ve){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var g=!0;break e;default:g=!1}var _;if(!(_=g)){var R;if(R=Ve===0){var Z=String(u.D).match(ur)[1]||null;!Z&&f.self&&f.self.location&&(Z=f.self.location.protocol.slice(0,-1)),R=!jd.test(Z?Z.toLowerCase():"")}_=R}if(_)$t(u,"complete"),$t(u,"success");else{u.m=6;try{var ae=2<gr(u)?u.g.statusText:""}catch{ae=""}u.l=ae+" ["+u.Z()+"]",$a(u)}}finally{jr(u)}}}}function jr(u,g){if(u.g){Wa(u);const _=u.g,R=u.v[0]?()=>{}:null;u.g=null,u.v=null,g||$t(u,"ready");try{_.onreadystatechange=R}catch{}}}function Wa(u){u.I&&(f.clearTimeout(u.I),u.I=null)}n.isActive=function(){return!!this.g};function gr(u){return u.g?u.g.readyState:0}n.Z=function(){try{return 2<gr(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(u){if(this.g){var g=this.g.responseText;return u&&g.indexOf(u)==0&&(g=g.substring(u.length)),ts(g)}};function Zo(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function Ga(u){const g={};u=(u.g&&2<=gr(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let R=0;R<u.length;R++){if(Te(u[R]))continue;var _=D(u[R]);const Z=_[0];if(_=_[1],typeof _!="string")continue;_=_.trim();const ae=g[Z]||[];g[Z]=ae,ae.push(_)}C(g,function(R){return R.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ns(u,g,_){return _&&_.internalChannelParams&&_.internalChannelParams[u]||g}function el(u){this.Aa=0,this.i=[],this.j=new ns,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ns("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ns("baseRetryDelayMs",5e3,u),this.cb=Ns("retryDelaySeedMs",1e4,u),this.Wa=Ns("forwardChannelMaxRetries",2,u),this.wa=Ns("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new H(u&&u.concurrentRequestLimit),this.Da=new Zn,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=el.prototype,n.la=8,n.G=1,n.connect=function(u,g,_,R){rt(0),this.W=u,this.H=g||{},_&&R!==void 0&&(this.H.OSID=_,this.H.OAID=R),this.F=this.X,this.I=_c(this,null,this.W),Rs(this)};function Bn(u){if(qa(u),u.G==3){var g=u.U++,_=Jt(u.I);if(Rt(_,"SID",u.K),Rt(_,"RID",g),Rt(_,"TYPE","terminate"),Js(u,_),g=new un(u,u.j,g),g.L=2,g.v=Is(Jt(_)),_=!1,f.navigator&&f.navigator.sendBeacon)try{_=f.navigator.sendBeacon(g.v.toString(),"")}catch{}!_&&f.Image&&(new Image().src=g.v,_=!0),_||(g.g=wc(g.j,null),g.g.ea(g.v)),g.F=Date.now(),ht(g)}vc(u)}function us(u){u.g&&(tl(u),u.g.cancel(),u.g=null)}function qa(u){us(u),u.u&&(f.clearTimeout(u.u),u.u=null),Qa(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&f.clearTimeout(u.s),u.s=null)}function Rs(u){if(!ue(u.h)&&!u.s){u.s=!0;var g=u.Ga;he||ve(),le||(he(),le=!0),Ie.add(g,u),u.B=0}}function kd(u,g){return oe(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=g.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=Nn(I(u.Ga,u,g),yc(u,u.B)),u.B++,!0)}n.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;const Z=new un(this,this.j,u);let ae=this.o;if(this.S&&(ae?(ae=P(ae),M(ae,this.S)):ae=this.S),this.m!==null||this.O||(Z.H=ae,ae=null),this.P)e:{for(var g=0,_=0;_<this.i.length;_++){t:{var R=this.i[_];if("__data__"in R.map&&(R=R.map.__data__,typeof R=="string")){R=R.length;break t}R=void 0}if(R===void 0)break;if(g+=R,4096<g){g=_;break e}if(g===4096||_===this.i.length-1){g=_+1;break e}}g=1e3}else g=1e3;g=Ei(this,Z,g),_=Jt(this.I),Rt(_,"RID",u),Rt(_,"CVER",22),this.D&&Rt(_,"X-HTTP-Session-Id",this.D),Js(this,_),ae&&(this.O?g="headers="+encodeURIComponent(String(cs(ae)))+"&"+g:this.m&&xi(_,this.m,ae)),Pe(this.h,Z),this.Ua&&Rt(_,"TYPE","init"),this.P?(Rt(_,"$req",g),Rt(_,"SID","null"),Z.T=!0,ss(Z,_,null)):ss(Z,_,g),this.G=2}}else this.G==3&&(u?Ha(this,u):this.i.length==0||ue(this.h)||Ha(this))};function Ha(u,g){var _;g?_=g.l:_=u.U++;const R=Jt(u.I);Rt(R,"SID",u.K),Rt(R,"RID",_),Rt(R,"AID",u.T),Js(u,R),u.m&&u.o&&xi(R,u.m,u.o),_=new un(u,u.j,_,u.B+1),u.m===null&&(_.H=u.o),g&&(u.i=g.D.concat(u.i)),g=Ei(u,_,1e3),_.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),Pe(u.h,_),ss(_,R,g)}function Js(u,g){u.H&&ie(u.H,function(_,R){Rt(g,R,_)}),u.l&&ut({},function(_,R){Rt(g,R,_)})}function Ei(u,g,_){_=Math.min(u.i.length,_);var R=u.l?I(u.l.Na,u.l,u):null;e:{var Z=u.i;let ae=-1;for(;;){const Ve=["count="+_];ae==-1?0<_?(ae=Z[0].g,Ve.push("ofs="+ae)):ae=0:Ve.push("ofs="+ae);let jt=!0;for(let xn=0;xn<_;xn++){let xt=Z[xn].g;const kn=Z[xn].map;if(xt-=ae,0>xt)ae=Math.max(0,Z[xn].g-100),jt=!1;else try{zr(kn,Ve,"req"+xt+"_")}catch{R&&R(kn)}}if(jt){R=Ve.join("&");break e}}}return u=u.i.splice(0,_),g.D=u,R}function da(u){if(!u.g&&!u.u){u.Y=1;var g=u.Fa;he||ve(),le||(he(),le=!0),Ie.add(g,u),u.v=0}}function Ka(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=Nn(I(u.Fa,u),yc(u,u.v)),u.v++,!0)}n.Fa=function(){if(this.u=null,gc(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=Nn(I(this.ab,this),u)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,rt(10),us(this),gc(this))};function tl(u){u.A!=null&&(f.clearTimeout(u.A),u.A=null)}function gc(u){u.g=new un(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var g=Jt(u.qa);Rt(g,"RID","rpc"),Rt(g,"SID",u.K),Rt(g,"AID",u.T),Rt(g,"CI",u.F?"0":"1"),!u.F&&u.ja&&Rt(g,"TO",u.ja),Rt(g,"TYPE","xmlhttp"),Js(u,g),u.m&&u.o&&xi(g,u.m,u.o),u.L&&(u.g.I=u.L);var _=u.g;u=u.ia,_.L=1,_.v=Is(Jt(g)),_.m=null,_.P=!0,vn(_,u)}n.Za=function(){this.C!=null&&(this.C=null,us(this),Ka(this),rt(19))};function Qa(u){u.C!=null&&(f.clearTimeout(u.C),u.C=null)}function Ya(u,g){var _=null;if(u.g==g){Qa(u),tl(u),u.g=null;var R=2}else if(Ae(u.h,g))_=g.D,Oe(u.h,g),R=1;else return;if(u.G!=0){if(g.o)if(R==1){_=g.m?g.m.length:0,g=Date.now()-g.F;var Z=u.B;R=Jn(),$t(R,new Xn(R,_)),Rs(u)}else da(u);else if(Z=g.s,Z==3||Z==0&&0<g.X||!(R==1&&kd(u,g)||R==2&&Ka(u)))switch(_&&0<_.length&&(g=u.h,g.i=g.i.concat(_)),Z){case 1:Xs(u,5);break;case 4:Xs(u,10);break;case 3:Xs(u,6);break;default:Xs(u,2)}}}function yc(u,g){let _=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(_*=2),_*g}function Xs(u,g){if(u.j.info("Error code "+g),g==2){var _=I(u.fb,u),R=u.Xa;const Z=!R;R=new _n(R||"//www.google.com/images/cleardot.gif"),f.location&&f.location.protocol=="http"||as(R,"https"),Is(R),Z?wn(R.toString(),_):wt(R.toString(),_)}else rt(2);u.G=0,u.l&&u.l.sa(g),vc(u),qa(u)}n.fb=function(u){u?(this.j.info("Successfully pinged google.com"),rt(2)):(this.j.info("Failed to ping google.com"),rt(1))};function vc(u){if(u.G=0,u.ka=[],u.l){const g=de(u.h);(g.length!=0||u.i.length!=0)&&(O(u.ka,g),O(u.ka,u.i),u.h.i.length=0,$(u.i),u.i.length=0),u.l.ra()}}function _c(u,g,_){var R=_ instanceof _n?Jt(_):new _n(_);if(R.g!="")g&&(R.g=g+"."+R.g),os(R,R.s);else{var Z=f.location;R=Z.protocol,g=g?g+"."+Z.hostname:Z.hostname,Z=+Z.port;var ae=new _n(null);R&&as(ae,R),g&&(ae.g=g),Z&&os(ae,Z),_&&(ae.l=_),R=ae}return _=u.D,g=u.ya,_&&g&&Rt(R,_,g),Rt(R,"VER",u.la),Js(u,R),R}function wc(u,g,_){if(g&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return g=u.Ca&&!u.pa?new Wt(new Rr({eb:_})):new Wt(u.pa),g.Ha(u.J),g}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function nl(){}n=nl.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Ja(){}Ja.prototype.g=function(u,g){return new dr(u,g)};function dr(u,g){Ot.call(this),this.g=new el(g),this.l=u,this.h=g&&g.messageUrlParams||null,u=g&&g.messageHeaders||null,g&&g.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=g&&g.initMessageHeaders||null,g&&g.messageContentType&&(u?u["X-WebChannel-Content-Type"]=g.messageContentType:u={"X-WebChannel-Content-Type":g.messageContentType}),g&&g.va&&(u?u["X-WebChannel-Client-Profile"]=g.va:u={"X-WebChannel-Client-Profile":g.va}),this.g.S=u,(u=g&&g.Sb)&&!Te(u)&&(this.g.m=u),this.v=g&&g.supportsCrossDomainXhr||!1,this.u=g&&g.sendRawJson||!1,(g=g&&g.httpSessionIdParam)&&!Te(g)&&(this.g.D=g,u=this.h,u!==null&&g in u&&(u=this.h,g in u&&delete u[g])),this.j=new As(this)}X(dr,Ot),dr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},dr.prototype.close=function(){Bn(this.g)},dr.prototype.o=function(u){var g=this.g;if(typeof u=="string"){var _={};_.__data__=u,u=_}else this.u&&(_={},_.__data__=gn(u),u=_);g.i.push(new F(g.Ya++,u)),g.G==3&&Rs(g)},dr.prototype.N=function(){this.g.l=null,delete this.j,Bn(this.g),delete this.g,dr.aa.N.call(this)};function xc(u){Yn.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var g=u.__sm__;if(g){e:{for(const _ in g){u=_;break e}u=void 0}(this.i=u)&&(u=this.i,g=g!==null&&u in g?g[u]:void 0),this.data=g}else this.data=u}X(xc,Yn);function Ec(){Ir.call(this),this.status=1}X(Ec,Ir);function As(u){this.g=u}X(As,nl),As.prototype.ua=function(){$t(this.g,"a")},As.prototype.ta=function(u){$t(this.g,new xc(u))},As.prototype.sa=function(u){$t(this.g,new Ec)},As.prototype.ra=function(){$t(this.g,"b")},Ja.prototype.createWebChannel=Ja.prototype.g,dr.prototype.send=dr.prototype.o,dr.prototype.open=dr.prototype.m,dr.prototype.close=dr.prototype.close,U0=function(){return new Ja},F0=function(){return Jn()},O0=Pn,Df={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Un.NO_ERROR=0,Un.TIMEOUT=8,Un.HTTP_ERROR=6,Pu=Un,Fr.COMPLETE="complete",M0=Fr,Ss.EventType=Qn,Qn.OPEN="a",Qn.CLOSE="b",Qn.ERROR="c",Qn.MESSAGE="d",Ot.prototype.listen=Ot.prototype.K,Al=Ss,Wt.prototype.listenOnce=Wt.prototype.L,Wt.prototype.getLastError=Wt.prototype.Ka,Wt.prototype.getLastErrorCode=Wt.prototype.Ba,Wt.prototype.getStatus=Wt.prototype.Z,Wt.prototype.getResponseJson=Wt.prototype.Oa,Wt.prototype.getResponseText=Wt.prototype.oa,Wt.prototype.send=Wt.prototype.ea,Wt.prototype.setWithCredentials=Wt.prototype.Ha,V0=Wt}).apply(typeof yu<"u"?yu:typeof self<"u"?self:typeof window<"u"?window:{});const cv="@firebase/firestore",uv="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ir{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ir.UNAUTHENTICATED=new ir(null),ir.GOOGLE_CREDENTIALS=new ir("google-credentials-uid"),ir.FIRST_PARTY=new ir("first-party-uid"),ir.MOCK_USER=new ir("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let qo="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ma=new op("@firebase/firestore");function To(){return Ma.logLevel}function Be(n,...e){if(Ma.logLevel<=vt.DEBUG){const t=e.map(xp);Ma.debug(`Firestore (${qo}): ${n}`,...t)}}function mi(n,...e){if(Ma.logLevel<=vt.ERROR){const t=e.map(xp);Ma.error(`Firestore (${qo}): ${n}`,...t)}}function Ji(n,...e){if(Ma.logLevel<=vt.WARN){const t=e.map(xp);Ma.warn(`Firestore (${qo}): ${n}`,...t)}}function xp(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function it(n,e,t){let s="Unexpected state";typeof e=="string"?s=e:t=e,z0(n,s,t)}function z0(n,e,t){let s=`FIRESTORE (${qo}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{s+=" CONTEXT: "+JSON.stringify(t)}catch{s+=" CONTEXT: "+t}throw mi(s),new Error(s)}function At(n,e,t,s){let a="Unexpected state";typeof t=="string"?a=t:s=t,n||z0(e,a,s)}function ct(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ue extends _i{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class di{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B0{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class OC{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(ir.UNAUTHENTICATED)))}shutdown(){}}class FC{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class UC{constructor(e){this.t=e,this.currentUser=ir.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){At(this.o===void 0,42304);let s=this.i;const a=m=>this.i!==s?(s=this.i,t(m)):Promise.resolve();let l=new di;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new di,e.enqueueRetryable((()=>a(this.currentUser)))};const d=()=>{const m=l;e.enqueueRetryable((async()=>{await m.promise,await a(this.currentUser)}))},f=m=>{Be("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=m,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit((m=>f(m))),setTimeout((()=>{if(!this.auth){const m=this.t.getImmediate({optional:!0});m?f(m):(Be("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new di)}}),0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((s=>this.i!==e?(Be("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(At(typeof s.accessToken=="string",31837,{l:s}),new B0(s.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return At(e===null||typeof e=="string",2055,{h:e}),new ir(e)}}class zC{constructor(e,t,s){this.P=e,this.T=t,this.I=s,this.type="FirstParty",this.user=ir.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class BC{constructor(e,t,s){this.P=e,this.T=t,this.I=s}getToken(){return Promise.resolve(new zC(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(ir.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class dv{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class $C{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Mr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){At(this.o===void 0,3512);const s=l=>{l.error!=null&&Be("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const d=l.token!==this.m;return this.m=l.token,Be("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?t(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable((()=>s(l)))};const a=l=>{Be("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((l=>a(l))),setTimeout((()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?a(l):Be("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new dv(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(At(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new dv(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WC(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let s=0;s<n;s++)t[s]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $0(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ep{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let s="";for(;s.length<20;){const a=WC(40);for(let l=0;l<a.length;++l)s.length<20&&a[l]<t&&(s+=e.charAt(a[l]%62))}return s}}function ft(n,e){return n<e?-1:n>e?1:0}function Lf(n,e){let t=0;for(;t<n.length&&t<e.length;){const s=n.codePointAt(t),a=e.codePointAt(t);if(s!==a){if(s<128&&a<128)return ft(s,a);{const l=$0(),d=GC(l.encode(hv(n,t)),l.encode(hv(e,t)));return d!==0?d:ft(s,a)}}t+=s>65535?2:1}return ft(n.length,e.length)}function hv(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function GC(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return ft(n[t],e[t]);return ft(n.length,e.length)}function Do(n,e,t){return n.length===e.length&&n.every(((s,a)=>t(s,e[a])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fv="__name__";class Vs{constructor(e,t,s){t===void 0?t=0:t>e.length&&it(637,{offset:t,range:e.length}),s===void 0?s=e.length-t:s>e.length-t&&it(1746,{length:s,range:e.length-t}),this.segments=e,this.offset=t,this.len=s}get length(){return this.len}isEqual(e){return Vs.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Vs?e.forEach((s=>{t.push(s)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,s=this.limit();t<s;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const s=Math.min(e.length,t.length);for(let a=0;a<s;a++){const l=Vs.compareSegments(e.get(a),t.get(a));if(l!==0)return l}return ft(e.length,t.length)}static compareSegments(e,t){const s=Vs.isNumericId(e),a=Vs.isNumericId(t);return s&&!a?-1:!s&&a?1:s&&a?Vs.extractNumericId(e).compare(Vs.extractNumericId(t)):Lf(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Qi.fromString(e.substring(4,e.length-2))}}class Mt extends Vs{construct(e,t,s){return new Mt(e,t,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const s of e){if(s.indexOf("//")>=0)throw new Ue(pe.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);t.push(...s.split("/").filter((a=>a.length>0)))}return new Mt(t)}static emptyPath(){return new Mt([])}}const qC=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class qn extends Vs{construct(e,t,s){return new qn(e,t,s)}static isValidIdentifier(e){return qC.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),qn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===fv}static keyField(){return new qn([fv])}static fromServerFormat(e){const t=[];let s="",a=0;const l=()=>{if(s.length===0)throw new Ue(pe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(s),s=""};let d=!1;for(;a<e.length;){const f=e[a];if(f==="\\"){if(a+1===e.length)throw new Ue(pe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const m=e[a+1];if(m!=="\\"&&m!=="."&&m!=="`")throw new Ue(pe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=m,a+=2}else f==="`"?(d=!d,a++):f!=="."||d?(s+=f,a++):(l(),a++)}if(l(),d)throw new Ue(pe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new qn(t)}static emptyPath(){return new qn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xe{constructor(e){this.path=e}static fromPath(e){return new Xe(Mt.fromString(e))}static fromName(e){return new Xe(Mt.fromString(e).popFirst(5))}static empty(){return new Xe(Mt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Mt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Mt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Xe(new Mt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W0(n,e,t){if(!t)throw new Ue(pe.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function HC(n,e,t,s){if(e===!0&&s===!0)throw new Ue(pe.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function pv(n){if(!Xe.isDocumentKey(n))throw new Ue(pe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function mv(n){if(Xe.isDocumentKey(n))throw new Ue(pe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function G0(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function cd(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(s){return s.constructor?s.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":it(12329,{type:typeof n})}function Cr(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Ue(pe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=cd(n);throw new Ue(pe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mn(n,e){const t={typeString:n};return e&&(t.value=e),t}function oc(n,e){if(!G0(n))throw new Ue(pe.INVALID_ARGUMENT,"JSON must be an object");let t;for(const s in e)if(e[s]){const a=e[s].typeString,l="value"in e[s]?{value:e[s].value}:void 0;if(!(s in n)){t=`JSON missing required field: '${s}'`;break}const d=n[s];if(a&&typeof d!==a){t=`JSON field '${s}' must be a ${a}.`;break}if(l!==void 0&&d!==l.value){t=`Expected '${s}' field to equal '${l.value}'`;break}}if(t)throw new Ue(pe.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gv=-62135596800,yv=1e6;class Bt{static now(){return Bt.fromMillis(Date.now())}static fromDate(e){return Bt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),s=Math.floor((e-1e3*t)*yv);return new Bt(t,s)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ue(pe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ue(pe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<gv)throw new Ue(pe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ue(pe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/yv}_compareTo(e){return this.seconds===e.seconds?ft(this.nanoseconds,e.nanoseconds):ft(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Bt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(oc(e,Bt._jsonSchema))return new Bt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-gv;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Bt._jsonSchemaVersion="firestore/timestamp/1.0",Bt._jsonSchema={type:mn("string",Bt._jsonSchemaVersion),seconds:mn("number"),nanoseconds:mn("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lt{static fromTimestamp(e){return new lt(e)}static min(){return new lt(new Bt(0,0))}static max(){return new lt(new Bt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hl=-1;function KC(n,e){const t=n.toTimestamp().seconds,s=n.toTimestamp().nanoseconds+1,a=lt.fromTimestamp(s===1e9?new Bt(t+1,0):new Bt(t,s));return new Xi(a,Xe.empty(),e)}function QC(n){return new Xi(n.readTime,n.key,Hl)}class Xi{constructor(e,t,s){this.readTime=e,this.documentKey=t,this.largestBatchId=s}static min(){return new Xi(lt.min(),Xe.empty(),Hl)}static max(){return new Xi(lt.max(),Xe.empty(),Hl)}}function YC(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Xe.comparator(n.documentKey,e.documentKey),t!==0?t:ft(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JC="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class XC{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ho(n){if(n.code!==pe.FAILED_PRECONDITION||n.message!==JC)throw n;Be("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ge{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&it(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ge(((s,a)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(s,a)},this.catchCallback=l=>{this.wrapFailure(t,l).next(s,a)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof ge?t:ge.resolve(t)}catch(t){return ge.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):ge.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):ge.reject(t)}static resolve(e){return new ge(((t,s)=>{t(e)}))}static reject(e){return new ge(((t,s)=>{s(e)}))}static waitFor(e){return new ge(((t,s)=>{let a=0,l=0,d=!1;e.forEach((f=>{++a,f.next((()=>{++l,d&&l===a&&t()}),(m=>s(m)))})),d=!0,l===a&&t()}))}static or(e){let t=ge.resolve(!1);for(const s of e)t=t.next((a=>a?ge.resolve(a):s()));return t}static forEach(e,t){const s=[];return e.forEach(((a,l)=>{s.push(t.call(this,a,l))})),this.waitFor(s)}static mapArray(e,t){return new ge(((s,a)=>{const l=e.length,d=new Array(l);let f=0;for(let m=0;m<l;m++){const v=m;t(e[v]).next((w=>{d[v]=w,++f,f===l&&s(d)}),(w=>a(w)))}}))}static doWhile(e,t){return new ge(((s,a)=>{const l=()=>{e()===!0?t().next((()=>{l()}),a):s()};l()}))}}function ZC(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Ko(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ud{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=s=>this._e(s),this.ae=s=>t.writeSequenceNumber(s))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}}ud.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tp=-1;function dd(n){return n==null}function Gu(n){return n===0&&1/n==-1/0}function eI(n){return typeof n=="number"&&Number.isInteger(n)&&!Gu(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q0="";function tI(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=vv(e)),e=nI(n.get(t),e);return vv(e)}function nI(n,e){let t=e;const s=n.length;for(let a=0;a<s;a++){const l=n.charAt(a);switch(l){case"\0":t+="";break;case q0:t+="";break;default:t+=l}}return t}function vv(n){return n+q0+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _v(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function la(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function H0(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kt{constructor(e,t){this.comparator=e,this.root=t||Gn.EMPTY}insert(e,t){return new Kt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Gn.BLACK,null,null))}remove(e){return new Kt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Gn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const s=this.comparator(e,t.key);if(s===0)return t.value;s<0?t=t.left:s>0&&(t=t.right)}return null}indexOf(e){let t=0,s=this.root;for(;!s.isEmpty();){const a=this.comparator(e,s.key);if(a===0)return t+s.left.size;a<0?s=s.left:(t+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,s)=>(e(t,s),!1)))}toString(){const e=[];return this.inorderTraversal(((t,s)=>(e.push(`${t}:${s}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new vu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new vu(this.root,e,this.comparator,!1)}getReverseIterator(){return new vu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new vu(this.root,e,this.comparator,!0)}}class vu{constructor(e,t,s,a){this.isReverse=a,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=t?s(e.key,t):1,t&&a&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Gn{constructor(e,t,s,a,l){this.key=e,this.value=t,this.color=s??Gn.RED,this.left=a??Gn.EMPTY,this.right=l??Gn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,s,a,l){return new Gn(e??this.key,t??this.value,s??this.color,a??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,s){let a=this;const l=s(e,a.key);return a=l<0?a.copy(null,null,null,a.left.insert(e,t,s),null):l===0?a.copy(null,t,null,null,null):a.copy(null,null,null,null,a.right.insert(e,t,s)),a.fixUp()}removeMin(){if(this.left.isEmpty())return Gn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let s,a=this;if(t(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,t),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),t(e,a.key)===0){if(a.right.isEmpty())return Gn.EMPTY;s=a.right.min(),a=a.copy(s.key,s.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,t))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Gn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Gn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw it(43730,{key:this.key,value:this.value});if(this.right.isRed())throw it(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw it(27949);return e+(this.isRed()?0:1)}}Gn.EMPTY=null,Gn.RED=!0,Gn.BLACK=!1;Gn.EMPTY=new class{constructor(){this.size=0}get key(){throw it(57766)}get value(){throw it(16141)}get color(){throw it(16727)}get left(){throw it(29726)}get right(){throw it(36894)}copy(e,t,s,a,l){return this}insert(e,t,s){return new Gn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bn{constructor(e){this.comparator=e,this.data=new Kt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,s)=>(e(t),!1)))}forEachInRange(e,t){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const a=s.getNext();if(this.comparator(a.key,e[1])>=0)return;t(a.key)}}forEachWhile(e,t){let s;for(s=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new wv(this.data.getIterator())}getIteratorFrom(e){return new wv(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((s=>{t=t.add(s)})),t}isEqual(e){if(!(e instanceof bn)||this.size!==e.size)return!1;const t=this.data.getIterator(),s=e.data.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=s.getNext().key;if(this.comparator(a,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new bn(this.comparator);return t.data=e,t}}class wv{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Or{constructor(e){this.fields=e,e.sort(qn.comparator)}static empty(){return new Or([])}unionWith(e){let t=new bn(qn.comparator);for(const s of this.fields)t=t.add(s);for(const s of e)t=t.add(s);return new Or(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Do(this.fields,e.fields,((t,s)=>t.isEqual(s)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K0 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(a){try{return atob(a)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new K0("Invalid base64 string: "+l):l}})(e);return new Hn(t)}static fromUint8Array(e){const t=(function(a){let l="";for(let d=0;d<a.length;++d)l+=String.fromCharCode(a[d]);return l})(e);return new Hn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const s=new Uint8Array(t.length);for(let a=0;a<t.length;a++)s[a]=t.charCodeAt(a);return s})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ft(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Hn.EMPTY_BYTE_STRING=new Hn("");const rI=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Zi(n){if(At(!!n,39018),typeof n=="string"){let e=0;const t=rI.exec(n);if(At(!!t,46558,{timestamp:n}),t[1]){let a=t[1];a=(a+"000000000").substr(0,9),e=Number(a)}const s=new Date(n);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:ln(n.seconds),nanos:ln(n.nanos)}}function ln(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function ea(n){return typeof n=="string"?Hn.fromBase64String(n):Hn.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q0="server_timestamp",Y0="__type__",J0="__previous_value__",X0="__local_write_time__";function Sp(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[Y0])===null||t===void 0?void 0:t.stringValue)===Q0}function hd(n){const e=n.mapValue.fields[J0];return Sp(e)?hd(e):e}function Kl(n){const e=Zi(n.mapValue.fields[X0].timestampValue);return new Bt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sI{constructor(e,t,s,a,l,d,f,m,v,w){this.databaseId=e,this.appId=t,this.persistenceKey=s,this.host=a,this.ssl=l,this.forceLongPolling=d,this.autoDetectLongPolling=f,this.longPollingOptions=m,this.useFetchStreams=v,this.isUsingEmulator=w}}const qu="(default)";class Ql{constructor(e,t){this.projectId=e,this.database=t||qu}static empty(){return new Ql("","")}get isDefaultDatabase(){return this.database===qu}isEqual(e){return e instanceof Ql&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z0="__type__",iI="__max__",_u={mapValue:{}},ew="__vector__",Hu="value";function ta(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Sp(n)?4:oI(n)?9007199254740991:aI(n)?10:11:it(28295,{value:n})}function Bs(n,e){if(n===e)return!0;const t=ta(n);if(t!==ta(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Kl(n).isEqual(Kl(e));case 3:return(function(a,l){if(typeof a.timestampValue=="string"&&typeof l.timestampValue=="string"&&a.timestampValue.length===l.timestampValue.length)return a.timestampValue===l.timestampValue;const d=Zi(a.timestampValue),f=Zi(l.timestampValue);return d.seconds===f.seconds&&d.nanos===f.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(a,l){return ea(a.bytesValue).isEqual(ea(l.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(a,l){return ln(a.geoPointValue.latitude)===ln(l.geoPointValue.latitude)&&ln(a.geoPointValue.longitude)===ln(l.geoPointValue.longitude)})(n,e);case 2:return(function(a,l){if("integerValue"in a&&"integerValue"in l)return ln(a.integerValue)===ln(l.integerValue);if("doubleValue"in a&&"doubleValue"in l){const d=ln(a.doubleValue),f=ln(l.doubleValue);return d===f?Gu(d)===Gu(f):isNaN(d)&&isNaN(f)}return!1})(n,e);case 9:return Do(n.arrayValue.values||[],e.arrayValue.values||[],Bs);case 10:case 11:return(function(a,l){const d=a.mapValue.fields||{},f=l.mapValue.fields||{};if(_v(d)!==_v(f))return!1;for(const m in d)if(d.hasOwnProperty(m)&&(f[m]===void 0||!Bs(d[m],f[m])))return!1;return!0})(n,e);default:return it(52216,{left:n})}}function Yl(n,e){return(n.values||[]).find((t=>Bs(t,e)))!==void 0}function Lo(n,e){if(n===e)return 0;const t=ta(n),s=ta(e);if(t!==s)return ft(t,s);switch(t){case 0:case 9007199254740991:return 0;case 1:return ft(n.booleanValue,e.booleanValue);case 2:return(function(l,d){const f=ln(l.integerValue||l.doubleValue),m=ln(d.integerValue||d.doubleValue);return f<m?-1:f>m?1:f===m?0:isNaN(f)?isNaN(m)?0:-1:1})(n,e);case 3:return xv(n.timestampValue,e.timestampValue);case 4:return xv(Kl(n),Kl(e));case 5:return Lf(n.stringValue,e.stringValue);case 6:return(function(l,d){const f=ea(l),m=ea(d);return f.compareTo(m)})(n.bytesValue,e.bytesValue);case 7:return(function(l,d){const f=l.split("/"),m=d.split("/");for(let v=0;v<f.length&&v<m.length;v++){const w=ft(f[v],m[v]);if(w!==0)return w}return ft(f.length,m.length)})(n.referenceValue,e.referenceValue);case 8:return(function(l,d){const f=ft(ln(l.latitude),ln(d.latitude));return f!==0?f:ft(ln(l.longitude),ln(d.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Ev(n.arrayValue,e.arrayValue);case 10:return(function(l,d){var f,m,v,w;const T=l.fields||{},I=d.fields||{},U=(f=T[Hu])===null||f===void 0?void 0:f.arrayValue,X=(m=I[Hu])===null||m===void 0?void 0:m.arrayValue,$=ft(((v=U==null?void 0:U.values)===null||v===void 0?void 0:v.length)||0,((w=X==null?void 0:X.values)===null||w===void 0?void 0:w.length)||0);return $!==0?$:Ev(U,X)})(n.mapValue,e.mapValue);case 11:return(function(l,d){if(l===_u.mapValue&&d===_u.mapValue)return 0;if(l===_u.mapValue)return 1;if(d===_u.mapValue)return-1;const f=l.fields||{},m=Object.keys(f),v=d.fields||{},w=Object.keys(v);m.sort(),w.sort();for(let T=0;T<m.length&&T<w.length;++T){const I=Lf(m[T],w[T]);if(I!==0)return I;const U=Lo(f[m[T]],v[w[T]]);if(U!==0)return U}return ft(m.length,w.length)})(n.mapValue,e.mapValue);default:throw it(23264,{le:t})}}function xv(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ft(n,e);const t=Zi(n),s=Zi(e),a=ft(t.seconds,s.seconds);return a!==0?a:ft(t.nanos,s.nanos)}function Ev(n,e){const t=n.values||[],s=e.values||[];for(let a=0;a<t.length&&a<s.length;++a){const l=Lo(t[a],s[a]);if(l)return l}return ft(t.length,s.length)}function Vo(n){return Vf(n)}function Vf(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const s=Zi(t);return`time(${s.seconds},${s.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return ea(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Xe.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let s="[",a=!0;for(const l of t.values||[])a?a=!1:s+=",",s+=Vf(l);return s+"]"})(n.arrayValue):"mapValue"in n?(function(t){const s=Object.keys(t.fields||{}).sort();let a="{",l=!0;for(const d of s)l?l=!1:a+=",",a+=`${d}:${Vf(t.fields[d])}`;return a+"}"})(n.mapValue):it(61005,{value:n})}function Nu(n){switch(ta(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=hd(n);return e?16+Nu(e):16;case 5:return 2*n.stringValue.length;case 6:return ea(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(s){return(s.values||[]).reduce(((a,l)=>a+Nu(l)),0)})(n.arrayValue);case 10:case 11:return(function(s){let a=0;return la(s.fields,((l,d)=>{a+=l.length+Nu(d)})),a})(n.mapValue);default:throw it(13486,{value:n})}}function Tv(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Mf(n){return!!n&&"integerValue"in n}function bp(n){return!!n&&"arrayValue"in n}function Sv(n){return!!n&&"nullValue"in n}function bv(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Ru(n){return!!n&&"mapValue"in n}function aI(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[Z0])===null||t===void 0?void 0:t.stringValue)===ew}function Ol(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return la(n.mapValue.fields,((t,s)=>e.mapValue.fields[t]=Ol(s))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Ol(n.arrayValue.values[t]);return e}return Object.assign({},n)}function oI(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===iI}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class br{constructor(e){this.value=e}static empty(){return new br({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let s=0;s<e.length-1;++s)if(t=(t.mapValue.fields||{})[e.get(s)],!Ru(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ol(t)}setAll(e){let t=qn.emptyPath(),s={},a=[];e.forEach(((d,f)=>{if(!t.isImmediateParentOf(f)){const m=this.getFieldsMap(t);this.applyChanges(m,s,a),s={},a=[],t=f.popLast()}d?s[f.lastSegment()]=Ol(d):a.push(f.lastSegment())}));const l=this.getFieldsMap(t);this.applyChanges(l,s,a)}delete(e){const t=this.field(e.popLast());Ru(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Bs(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let s=0;s<e.length;++s){let a=t.mapValue.fields[e.get(s)];Ru(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},t.mapValue.fields[e.get(s)]=a),t=a}return t.mapValue.fields}applyChanges(e,t,s){la(t,((a,l)=>e[a]=l));for(const a of s)delete e[a]}clone(){return new br(Ol(this.value))}}function tw(n){const e=[];return la(n.fields,((t,s)=>{const a=new qn([t]);if(Ru(s)){const l=tw(s.mapValue).fields;if(l.length===0)e.push(a);else for(const d of l)e.push(a.child(d))}else e.push(a)})),new Or(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ar{constructor(e,t,s,a,l,d,f){this.key=e,this.documentType=t,this.version=s,this.readTime=a,this.createTime=l,this.data=d,this.documentState=f}static newInvalidDocument(e){return new ar(e,0,lt.min(),lt.min(),lt.min(),br.empty(),0)}static newFoundDocument(e,t,s,a){return new ar(e,1,t,lt.min(),s,a,0)}static newNoDocument(e,t){return new ar(e,2,t,lt.min(),lt.min(),br.empty(),0)}static newUnknownDocument(e,t){return new ar(e,3,t,lt.min(),lt.min(),br.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(lt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=br.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=br.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=lt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ar&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ar(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ku{constructor(e,t){this.position=e,this.inclusive=t}}function Cv(n,e,t){let s=0;for(let a=0;a<n.position.length;a++){const l=e[a],d=n.position[a];if(l.field.isKeyField()?s=Xe.comparator(Xe.fromName(d.referenceValue),t.key):s=Lo(d,t.data.field(l.field)),l.dir==="desc"&&(s*=-1),s!==0)break}return s}function Iv(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Bs(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jl{constructor(e,t="asc"){this.field=e,this.dir=t}}function lI(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nw{}class pn extends nw{constructor(e,t,s){super(),this.field=e,this.op=t,this.value=s}static create(e,t,s){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,s):new uI(e,t,s):t==="array-contains"?new fI(e,s):t==="in"?new pI(e,s):t==="not-in"?new mI(e,s):t==="array-contains-any"?new gI(e,s):new pn(e,t,s)}static createKeyFieldInFilter(e,t,s){return t==="in"?new dI(e,s):new hI(e,s)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Lo(t,this.value)):t!==null&&ta(this.value)===ta(t)&&this.matchesComparison(Lo(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return it(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Es extends nw{constructor(e,t){super(),this.filters=e,this.op=t,this.he=null}static create(e,t){return new Es(e,t)}matches(e){return rw(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function rw(n){return n.op==="and"}function sw(n){return cI(n)&&rw(n)}function cI(n){for(const e of n.filters)if(e instanceof Es)return!1;return!0}function Of(n){if(n instanceof pn)return n.field.canonicalString()+n.op.toString()+Vo(n.value);if(sw(n))return n.filters.map((e=>Of(e))).join(",");{const e=n.filters.map((t=>Of(t))).join(",");return`${n.op}(${e})`}}function iw(n,e){return n instanceof pn?(function(s,a){return a instanceof pn&&s.op===a.op&&s.field.isEqual(a.field)&&Bs(s.value,a.value)})(n,e):n instanceof Es?(function(s,a){return a instanceof Es&&s.op===a.op&&s.filters.length===a.filters.length?s.filters.reduce(((l,d,f)=>l&&iw(d,a.filters[f])),!0):!1})(n,e):void it(19439)}function aw(n){return n instanceof pn?(function(t){return`${t.field.canonicalString()} ${t.op} ${Vo(t.value)}`})(n):n instanceof Es?(function(t){return t.op.toString()+" {"+t.getFilters().map(aw).join(" ,")+"}"})(n):"Filter"}class uI extends pn{constructor(e,t,s){super(e,t,s),this.key=Xe.fromName(s.referenceValue)}matches(e){const t=Xe.comparator(e.key,this.key);return this.matchesComparison(t)}}class dI extends pn{constructor(e,t){super(e,"in",t),this.keys=ow("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class hI extends pn{constructor(e,t){super(e,"not-in",t),this.keys=ow("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function ow(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map((s=>Xe.fromName(s.referenceValue)))}class fI extends pn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return bp(t)&&Yl(t.arrayValue,this.value)}}class pI extends pn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Yl(this.value.arrayValue,t)}}class mI extends pn{constructor(e,t){super(e,"not-in",t)}matches(e){if(Yl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Yl(this.value.arrayValue,t)}}class gI extends pn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!bp(t)||!t.arrayValue.values)&&t.arrayValue.values.some((s=>Yl(this.value.arrayValue,s)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yI{constructor(e,t=null,s=[],a=[],l=null,d=null,f=null){this.path=e,this.collectionGroup=t,this.orderBy=s,this.filters=a,this.limit=l,this.startAt=d,this.endAt=f,this.Pe=null}}function Pv(n,e=null,t=[],s=[],a=null,l=null,d=null){return new yI(n,e,t,s,a,l,d)}function Cp(n){const e=ct(n);if(e.Pe===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((s=>Of(s))).join(","),t+="|ob:",t+=e.orderBy.map((s=>(function(l){return l.field.canonicalString()+l.dir})(s))).join(","),dd(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((s=>Vo(s))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((s=>Vo(s))).join(",")),e.Pe=t}return e.Pe}function Ip(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!lI(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!iw(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Iv(n.startAt,e.startAt)&&Iv(n.endAt,e.endAt)}function Ff(n){return Xe.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qo{constructor(e,t=null,s=[],a=[],l=null,d="F",f=null,m=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=s,this.filters=a,this.limit=l,this.limitType=d,this.startAt=f,this.endAt=m,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function vI(n,e,t,s,a,l,d,f){return new Qo(n,e,t,s,a,l,d,f)}function fd(n){return new Qo(n)}function Nv(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function lw(n){return n.collectionGroup!==null}function Fl(n){const e=ct(n);if(e.Te===null){e.Te=[];const t=new Set;for(const l of e.explicitOrderBy)e.Te.push(l),t.add(l.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let f=new bn(qn.comparator);return d.filters.forEach((m=>{m.getFlattenedFilters().forEach((v=>{v.isInequality()&&(f=f.add(v.field))}))})),f})(e).forEach((l=>{t.has(l.canonicalString())||l.isKeyField()||e.Te.push(new Jl(l,s))})),t.has(qn.keyField().canonicalString())||e.Te.push(new Jl(qn.keyField(),s))}return e.Te}function Os(n){const e=ct(n);return e.Ie||(e.Ie=_I(e,Fl(n))),e.Ie}function _I(n,e){if(n.limitType==="F")return Pv(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((a=>{const l=a.dir==="desc"?"asc":"desc";return new Jl(a.field,l)}));const t=n.endAt?new Ku(n.endAt.position,n.endAt.inclusive):null,s=n.startAt?new Ku(n.startAt.position,n.startAt.inclusive):null;return Pv(n.path,n.collectionGroup,e,n.filters,n.limit,t,s)}}function Uf(n,e){const t=n.filters.concat([e]);return new Qo(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Qu(n,e,t){return new Qo(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function pd(n,e){return Ip(Os(n),Os(e))&&n.limitType===e.limitType}function cw(n){return`${Cp(Os(n))}|lt:${n.limitType}`}function So(n){return`Query(target=${(function(t){let s=t.path.canonicalString();return t.collectionGroup!==null&&(s+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(s+=`, filters: [${t.filters.map((a=>aw(a))).join(", ")}]`),dd(t.limit)||(s+=", limit: "+t.limit),t.orderBy.length>0&&(s+=`, orderBy: [${t.orderBy.map((a=>(function(d){return`${d.field.canonicalString()} (${d.dir})`})(a))).join(", ")}]`),t.startAt&&(s+=", startAt: ",s+=t.startAt.inclusive?"b:":"a:",s+=t.startAt.position.map((a=>Vo(a))).join(",")),t.endAt&&(s+=", endAt: ",s+=t.endAt.inclusive?"a:":"b:",s+=t.endAt.position.map((a=>Vo(a))).join(",")),`Target(${s})`})(Os(n))}; limitType=${n.limitType})`}function md(n,e){return e.isFoundDocument()&&(function(s,a){const l=a.key.path;return s.collectionGroup!==null?a.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(l):Xe.isDocumentKey(s.path)?s.path.isEqual(l):s.path.isImmediateParentOf(l)})(n,e)&&(function(s,a){for(const l of Fl(s))if(!l.field.isKeyField()&&a.data.field(l.field)===null)return!1;return!0})(n,e)&&(function(s,a){for(const l of s.filters)if(!l.matches(a))return!1;return!0})(n,e)&&(function(s,a){return!(s.startAt&&!(function(d,f,m){const v=Cv(d,f,m);return d.inclusive?v<=0:v<0})(s.startAt,Fl(s),a)||s.endAt&&!(function(d,f,m){const v=Cv(d,f,m);return d.inclusive?v>=0:v>0})(s.endAt,Fl(s),a))})(n,e)}function wI(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function uw(n){return(e,t)=>{let s=!1;for(const a of Fl(n)){const l=xI(a,e,t);if(l!==0)return l;s=s||a.field.isKeyField()}return 0}}function xI(n,e,t){const s=n.field.isKeyField()?Xe.comparator(e.key,t.key):(function(l,d,f){const m=d.data.field(l),v=f.data.field(l);return m!==null&&v!==null?Lo(m,v):it(42886)})(n.field,e,t);switch(n.dir){case"asc":return s;case"desc":return-1*s;default:return it(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fa{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s!==void 0){for(const[a,l]of s)if(this.equalsFn(a,e))return l}}has(e){return this.get(e)!==void 0}set(e,t){const s=this.mapKeyFn(e),a=this.inner[s];if(a===void 0)return this.inner[s]=[[e,t]],void this.innerSize++;for(let l=0;l<a.length;l++)if(this.equalsFn(a[l][0],e))return void(a[l]=[e,t]);a.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s===void 0)return!1;for(let a=0;a<s.length;a++)if(this.equalsFn(s[a][0],e))return s.length===1?delete this.inner[t]:s.splice(a,1),this.innerSize--,!0;return!1}forEach(e){la(this.inner,((t,s)=>{for(const[a,l]of s)e(a,l)}))}isEmpty(){return H0(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EI=new Kt(Xe.comparator);function gi(){return EI}const dw=new Kt(Xe.comparator);function jl(...n){let e=dw;for(const t of n)e=e.insert(t.key,t);return e}function hw(n){let e=dw;return n.forEach(((t,s)=>e=e.insert(t,s.overlayedDocument))),e}function Pa(){return Ul()}function fw(){return Ul()}function Ul(){return new Fa((n=>n.toString()),((n,e)=>n.isEqual(e)))}const TI=new Kt(Xe.comparator),SI=new bn(Xe.comparator);function _t(...n){let e=SI;for(const t of n)e=e.add(t);return e}const bI=new bn(ft);function CI(){return bI}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pp(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Gu(e)?"-0":e}}function pw(n){return{integerValue:""+n}}function II(n,e){return eI(e)?pw(e):Pp(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gd{constructor(){this._=void 0}}function PI(n,e,t){return n instanceof Xl?(function(a,l){const d={fields:{[Y0]:{stringValue:Q0},[X0]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return l&&Sp(l)&&(l=hd(l)),l&&(d.fields[J0]=l),{mapValue:d}})(t,e):n instanceof Zl?gw(n,e):n instanceof ec?yw(n,e):(function(a,l){const d=mw(a,l),f=Rv(d)+Rv(a.Ee);return Mf(d)&&Mf(a.Ee)?pw(f):Pp(a.serializer,f)})(n,e)}function NI(n,e,t){return n instanceof Zl?gw(n,e):n instanceof ec?yw(n,e):t}function mw(n,e){return n instanceof Yu?(function(s){return Mf(s)||(function(l){return!!l&&"doubleValue"in l})(s)})(e)?e:{integerValue:0}:null}class Xl extends gd{}class Zl extends gd{constructor(e){super(),this.elements=e}}function gw(n,e){const t=vw(e);for(const s of n.elements)t.some((a=>Bs(a,s)))||t.push(s);return{arrayValue:{values:t}}}class ec extends gd{constructor(e){super(),this.elements=e}}function yw(n,e){let t=vw(e);for(const s of n.elements)t=t.filter((a=>!Bs(a,s)));return{arrayValue:{values:t}}}class Yu extends gd{constructor(e,t){super(),this.serializer=e,this.Ee=t}}function Rv(n){return ln(n.integerValue||n.doubleValue)}function vw(n){return bp(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RI{constructor(e,t){this.field=e,this.transform=t}}function AI(n,e){return n.field.isEqual(e.field)&&(function(s,a){return s instanceof Zl&&a instanceof Zl||s instanceof ec&&a instanceof ec?Do(s.elements,a.elements,Bs):s instanceof Yu&&a instanceof Yu?Bs(s.Ee,a.Ee):s instanceof Xl&&a instanceof Xl})(n.transform,e.transform)}class jI{constructor(e,t){this.version=e,this.transformResults=t}}class Xr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Xr}static exists(e){return new Xr(void 0,e)}static updateTime(e){return new Xr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Au(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class yd{}function _w(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Np(n.key,Xr.none()):new lc(n.key,n.data,Xr.none());{const t=n.data,s=br.empty();let a=new bn(qn.comparator);for(let l of e.fields)if(!a.has(l)){let d=t.field(l);d===null&&l.length>1&&(l=l.popLast(),d=t.field(l)),d===null?s.delete(l):s.set(l,d),a=a.add(l)}return new ca(n.key,s,new Or(a.toArray()),Xr.none())}}function kI(n,e,t){n instanceof lc?(function(a,l,d){const f=a.value.clone(),m=jv(a.fieldTransforms,l,d.transformResults);f.setAll(m),l.convertToFoundDocument(d.version,f).setHasCommittedMutations()})(n,e,t):n instanceof ca?(function(a,l,d){if(!Au(a.precondition,l))return void l.convertToUnknownDocument(d.version);const f=jv(a.fieldTransforms,l,d.transformResults),m=l.data;m.setAll(ww(a)),m.setAll(f),l.convertToFoundDocument(d.version,m).setHasCommittedMutations()})(n,e,t):(function(a,l,d){l.convertToNoDocument(d.version).setHasCommittedMutations()})(0,e,t)}function zl(n,e,t,s){return n instanceof lc?(function(l,d,f,m){if(!Au(l.precondition,d))return f;const v=l.value.clone(),w=kv(l.fieldTransforms,m,d);return v.setAll(w),d.convertToFoundDocument(d.version,v).setHasLocalMutations(),null})(n,e,t,s):n instanceof ca?(function(l,d,f,m){if(!Au(l.precondition,d))return f;const v=kv(l.fieldTransforms,m,d),w=d.data;return w.setAll(ww(l)),w.setAll(v),d.convertToFoundDocument(d.version,w).setHasLocalMutations(),f===null?null:f.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((T=>T.field)))})(n,e,t,s):(function(l,d,f){return Au(l.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):f})(n,e,t)}function DI(n,e){let t=null;for(const s of n.fieldTransforms){const a=e.data.field(s.field),l=mw(s.transform,a||null);l!=null&&(t===null&&(t=br.empty()),t.set(s.field,l))}return t||null}function Av(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(s,a){return s===void 0&&a===void 0||!(!s||!a)&&Do(s,a,((l,d)=>AI(l,d)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class lc extends yd{constructor(e,t,s,a=[]){super(),this.key=e,this.value=t,this.precondition=s,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class ca extends yd{constructor(e,t,s,a,l=[]){super(),this.key=e,this.data=t,this.fieldMask=s,this.precondition=a,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function ww(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const s=n.data.field(t);e.set(t,s)}})),e}function jv(n,e,t){const s=new Map;At(n.length===t.length,32656,{Ae:t.length,Re:n.length});for(let a=0;a<t.length;a++){const l=n[a],d=l.transform,f=e.data.field(l.field);s.set(l.field,NI(d,f,t[a]))}return s}function kv(n,e,t){const s=new Map;for(const a of n){const l=a.transform,d=t.data.field(a.field);s.set(a.field,PI(l,d,e))}return s}class Np extends yd{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class LI extends yd{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VI{constructor(e,t,s,a){this.batchId=e,this.localWriteTime=t,this.baseMutations=s,this.mutations=a}applyToRemoteDocument(e,t){const s=t.mutationResults;for(let a=0;a<this.mutations.length;a++){const l=this.mutations[a];l.key.isEqual(e.key)&&kI(l,e,s[a])}}applyToLocalView(e,t){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(t=zl(s,e,t,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(t=zl(s,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const s=fw();return this.mutations.forEach((a=>{const l=e.get(a.key),d=l.overlayedDocument;let f=this.applyToLocalView(d,l.mutatedFields);f=t.has(a.key)?null:f;const m=_w(d,f);m!==null&&s.set(a.key,m),d.isValidDocument()||d.convertToNoDocument(lt.min())})),s}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),_t())}isEqual(e){return this.batchId===e.batchId&&Do(this.mutations,e.mutations,((t,s)=>Av(t,s)))&&Do(this.baseMutations,e.baseMutations,((t,s)=>Av(t,s)))}}class Rp{constructor(e,t,s,a){this.batch=e,this.commitVersion=t,this.mutationResults=s,this.docVersions=a}static from(e,t,s){At(e.mutations.length===s.length,58842,{Ve:e.mutations.length,me:s.length});let a=(function(){return TI})();const l=e.mutations;for(let d=0;d<l.length;d++)a=a.insert(l[d].key,s[d].version);return new Rp(e,t,s,a)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MI{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OI{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var fn,Et;function FI(n){switch(n){case pe.OK:return it(64938);case pe.CANCELLED:case pe.UNKNOWN:case pe.DEADLINE_EXCEEDED:case pe.RESOURCE_EXHAUSTED:case pe.INTERNAL:case pe.UNAVAILABLE:case pe.UNAUTHENTICATED:return!1;case pe.INVALID_ARGUMENT:case pe.NOT_FOUND:case pe.ALREADY_EXISTS:case pe.PERMISSION_DENIED:case pe.FAILED_PRECONDITION:case pe.ABORTED:case pe.OUT_OF_RANGE:case pe.UNIMPLEMENTED:case pe.DATA_LOSS:return!0;default:return it(15467,{code:n})}}function xw(n){if(n===void 0)return mi("GRPC error has no .code"),pe.UNKNOWN;switch(n){case fn.OK:return pe.OK;case fn.CANCELLED:return pe.CANCELLED;case fn.UNKNOWN:return pe.UNKNOWN;case fn.DEADLINE_EXCEEDED:return pe.DEADLINE_EXCEEDED;case fn.RESOURCE_EXHAUSTED:return pe.RESOURCE_EXHAUSTED;case fn.INTERNAL:return pe.INTERNAL;case fn.UNAVAILABLE:return pe.UNAVAILABLE;case fn.UNAUTHENTICATED:return pe.UNAUTHENTICATED;case fn.INVALID_ARGUMENT:return pe.INVALID_ARGUMENT;case fn.NOT_FOUND:return pe.NOT_FOUND;case fn.ALREADY_EXISTS:return pe.ALREADY_EXISTS;case fn.PERMISSION_DENIED:return pe.PERMISSION_DENIED;case fn.FAILED_PRECONDITION:return pe.FAILED_PRECONDITION;case fn.ABORTED:return pe.ABORTED;case fn.OUT_OF_RANGE:return pe.OUT_OF_RANGE;case fn.UNIMPLEMENTED:return pe.UNIMPLEMENTED;case fn.DATA_LOSS:return pe.DATA_LOSS;default:return it(39323,{code:n})}}(Et=fn||(fn={}))[Et.OK=0]="OK",Et[Et.CANCELLED=1]="CANCELLED",Et[Et.UNKNOWN=2]="UNKNOWN",Et[Et.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Et[Et.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Et[Et.NOT_FOUND=5]="NOT_FOUND",Et[Et.ALREADY_EXISTS=6]="ALREADY_EXISTS",Et[Et.PERMISSION_DENIED=7]="PERMISSION_DENIED",Et[Et.UNAUTHENTICATED=16]="UNAUTHENTICATED",Et[Et.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Et[Et.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Et[Et.ABORTED=10]="ABORTED",Et[Et.OUT_OF_RANGE=11]="OUT_OF_RANGE",Et[Et.UNIMPLEMENTED=12]="UNIMPLEMENTED",Et[Et.INTERNAL=13]="INTERNAL",Et[Et.UNAVAILABLE=14]="UNAVAILABLE",Et[Et.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UI=new Qi([4294967295,4294967295],0);function Dv(n){const e=$0().encode(n),t=new L0;return t.update(e),new Uint8Array(t.digest())}function Lv(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),s=e.getUint32(4,!0),a=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new Qi([t,s],0),new Qi([a,l],0)]}class Ap{constructor(e,t,s){if(this.bitmap=e,this.padding=t,this.hashCount=s,t<0||t>=8)throw new kl(`Invalid padding: ${t}`);if(s<0)throw new kl(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new kl(`Invalid hash count: ${s}`);if(e.length===0&&t!==0)throw new kl(`Invalid padding when bitmap length is 0: ${t}`);this.fe=8*e.length-t,this.ge=Qi.fromNumber(this.fe)}pe(e,t,s){let a=e.add(t.multiply(Qi.fromNumber(s)));return a.compare(UI)===1&&(a=new Qi([a.getBits(0),a.getBits(1)],0)),a.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;const t=Dv(e),[s,a]=Lv(t);for(let l=0;l<this.hashCount;l++){const d=this.pe(s,a,l);if(!this.ye(d))return!1}return!0}static create(e,t,s){const a=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),d=new Ap(l,a,t);return s.forEach((f=>d.insert(f))),d}insert(e){if(this.fe===0)return;const t=Dv(e),[s,a]=Lv(t);for(let l=0;l<this.hashCount;l++){const d=this.pe(s,a,l);this.we(d)}}we(e){const t=Math.floor(e/8),s=e%8;this.bitmap[t]|=1<<s}}class kl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vd{constructor(e,t,s,a,l){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=s,this.documentUpdates=a,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,t,s){const a=new Map;return a.set(e,cc.createSynthesizedTargetChangeForCurrentChange(e,t,s)),new vd(lt.min(),a,new Kt(ft),gi(),_t())}}class cc{constructor(e,t,s,a,l){this.resumeToken=e,this.current=t,this.addedDocuments=s,this.modifiedDocuments=a,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,t,s){return new cc(s,t,_t(),_t(),_t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ju{constructor(e,t,s,a){this.Se=e,this.removedTargetIds=t,this.key=s,this.be=a}}class Ew{constructor(e,t){this.targetId=e,this.De=t}}class Tw{constructor(e,t,s=Hn.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=t,this.resumeToken=s,this.cause=a}}class Vv{constructor(){this.ve=0,this.Ce=Mv(),this.Fe=Hn.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=_t(),t=_t(),s=_t();return this.Ce.forEach(((a,l)=>{switch(l){case 0:e=e.add(a);break;case 2:t=t.add(a);break;case 1:s=s.add(a);break;default:it(38017,{changeType:l})}})),new cc(this.Fe,this.Me,e,t,s)}ke(){this.xe=!1,this.Ce=Mv()}qe(e,t){this.xe=!0,this.Ce=this.Ce.insert(e,t)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,At(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class zI{constructor(e){this.We=e,this.Ge=new Map,this.ze=gi(),this.je=wu(),this.Je=wu(),this.He=new Kt(ft)}Ye(e){for(const t of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(t,e.be):this.Xe(t,e.key,e.be);for(const t of e.removedTargetIds)this.Xe(t,e.key,e.be)}et(e){this.forEachTarget(e,(t=>{const s=this.tt(t);switch(e.state){case 0:this.nt(t)&&s.Be(e.resumeToken);break;case 1:s.Ue(),s.Oe||s.ke(),s.Be(e.resumeToken);break;case 2:s.Ue(),s.Oe||this.removeTarget(t);break;case 3:this.nt(t)&&(s.Ke(),s.Be(e.resumeToken));break;case 4:this.nt(t)&&(this.rt(t),s.Be(e.resumeToken));break;default:it(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ge.forEach(((s,a)=>{this.nt(a)&&t(a)}))}it(e){const t=e.targetId,s=e.De.count,a=this.st(t);if(a){const l=a.target;if(Ff(l))if(s===0){const d=new Xe(l.path);this.Xe(t,d,ar.newNoDocument(d,lt.min()))}else At(s===1,20013,{expectedCount:s});else{const d=this.ot(t);if(d!==s){const f=this._t(e),m=f?this.ut(f,e,d):1;if(m!==0){this.rt(t);const v=m===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(t,v)}}}}}_t(e){const t=e.De.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:s="",padding:a=0},hashCount:l=0}=t;let d,f;try{d=ea(s).toUint8Array()}catch(m){if(m instanceof K0)return Ji("Decoding the base64 bloom filter in existence filter failed ("+m.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw m}try{f=new Ap(d,a,l)}catch(m){return Ji(m instanceof kl?"BloomFilter error: ":"Applying bloom filter failed: ",m),null}return f.fe===0?null:f}ut(e,t,s){return t.De.count===s-this.ht(e,t.targetId)?0:2}ht(e,t){const s=this.We.getRemoteKeysForTarget(t);let a=0;return s.forEach((l=>{const d=this.We.lt(),f=`projects/${d.projectId}/databases/${d.database}/documents/${l.path.canonicalString()}`;e.mightContain(f)||(this.Xe(t,l,null),a++)})),a}Pt(e){const t=new Map;this.Ge.forEach(((l,d)=>{const f=this.st(d);if(f){if(l.current&&Ff(f.target)){const m=new Xe(f.target.path);this.Tt(m).has(d)||this.It(d,m)||this.Xe(d,m,ar.newNoDocument(m,e))}l.Ne&&(t.set(d,l.Le()),l.ke())}}));let s=_t();this.Je.forEach(((l,d)=>{let f=!0;d.forEachWhile((m=>{const v=this.st(m);return!v||v.purpose==="TargetPurposeLimboResolution"||(f=!1,!1)})),f&&(s=s.add(l))})),this.ze.forEach(((l,d)=>d.setReadTime(e)));const a=new vd(e,t,this.He,this.ze,s);return this.ze=gi(),this.je=wu(),this.Je=wu(),this.He=new Kt(ft),a}Ze(e,t){if(!this.nt(e))return;const s=this.It(e,t.key)?2:0;this.tt(e).qe(t.key,s),this.ze=this.ze.insert(t.key,t),this.je=this.je.insert(t.key,this.Tt(t.key).add(e)),this.Je=this.Je.insert(t.key,this.dt(t.key).add(e))}Xe(e,t,s){if(!this.nt(e))return;const a=this.tt(e);this.It(e,t)?a.qe(t,1):a.Qe(t),this.Je=this.Je.insert(t,this.dt(t).delete(e)),this.Je=this.Je.insert(t,this.dt(t).add(e)),s&&(this.ze=this.ze.insert(t,s))}removeTarget(e){this.Ge.delete(e)}ot(e){const t=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let t=this.Ge.get(e);return t||(t=new Vv,this.Ge.set(e,t)),t}dt(e){let t=this.Je.get(e);return t||(t=new bn(ft),this.Je=this.Je.insert(e,t)),t}Tt(e){let t=this.je.get(e);return t||(t=new bn(ft),this.je=this.je.insert(e,t)),t}nt(e){const t=this.st(e)!==null;return t||Be("WatchChangeAggregator","Detected inactive target",e),t}st(e){const t=this.Ge.get(e);return t&&t.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new Vv),this.We.getRemoteKeysForTarget(e).forEach((t=>{this.Xe(e,t,null)}))}It(e,t){return this.We.getRemoteKeysForTarget(e).has(t)}}function wu(){return new Kt(Xe.comparator)}function Mv(){return new Kt(Xe.comparator)}const BI={asc:"ASCENDING",desc:"DESCENDING"},$I={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},WI={and:"AND",or:"OR"};class GI{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function zf(n,e){return n.useProto3Json||dd(e)?e:{value:e}}function Ju(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Sw(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function qI(n,e){return Ju(n,e.toTimestamp())}function Fs(n){return At(!!n,49232),lt.fromTimestamp((function(t){const s=Zi(t);return new Bt(s.seconds,s.nanos)})(n))}function jp(n,e){return Bf(n,e).canonicalString()}function Bf(n,e){const t=(function(a){return new Mt(["projects",a.projectId,"databases",a.database])})(n).child("documents");return e===void 0?t:t.child(e)}function bw(n){const e=Mt.fromString(n);return At(Rw(e),10190,{key:e.toString()}),e}function $f(n,e){return jp(n.databaseId,e.path)}function ff(n,e){const t=bw(e);if(t.get(1)!==n.databaseId.projectId)throw new Ue(pe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Ue(pe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Xe(Iw(t))}function Cw(n,e){return jp(n.databaseId,e)}function HI(n){const e=bw(n);return e.length===4?Mt.emptyPath():Iw(e)}function Wf(n){return new Mt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Iw(n){return At(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function Ov(n,e,t){return{name:$f(n,e),fields:t.value.mapValue.fields}}function KI(n,e){let t;if("targetChange"in e){e.targetChange;const s=(function(v){return v==="NO_CHANGE"?0:v==="ADD"?1:v==="REMOVE"?2:v==="CURRENT"?3:v==="RESET"?4:it(39313,{state:v})})(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],l=(function(v,w){return v.useProto3Json?(At(w===void 0||typeof w=="string",58123),Hn.fromBase64String(w||"")):(At(w===void 0||w instanceof Buffer||w instanceof Uint8Array,16193),Hn.fromUint8Array(w||new Uint8Array))})(n,e.targetChange.resumeToken),d=e.targetChange.cause,f=d&&(function(v){const w=v.code===void 0?pe.UNKNOWN:xw(v.code);return new Ue(w,v.message||"")})(d);t=new Tw(s,a,l,f||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const a=ff(n,s.document.name),l=Fs(s.document.updateTime),d=s.document.createTime?Fs(s.document.createTime):lt.min(),f=new br({mapValue:{fields:s.document.fields}}),m=ar.newFoundDocument(a,l,d,f),v=s.targetIds||[],w=s.removedTargetIds||[];t=new ju(v,w,m.key,m)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const a=ff(n,s.document),l=s.readTime?Fs(s.readTime):lt.min(),d=ar.newNoDocument(a,l),f=s.removedTargetIds||[];t=new ju([],f,d.key,d)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const a=ff(n,s.document),l=s.removedTargetIds||[];t=new ju([],l,a,null)}else{if(!("filter"in e))return it(11601,{At:e});{e.filter;const s=e.filter;s.targetId;const{count:a=0,unchangedNames:l}=s,d=new OI(a,l),f=s.targetId;t=new Ew(f,d)}}return t}function QI(n,e){let t;if(e instanceof lc)t={update:Ov(n,e.key,e.value)};else if(e instanceof Np)t={delete:$f(n,e.key)};else if(e instanceof ca)t={update:Ov(n,e.key,e.data),updateMask:sP(e.fieldMask)};else{if(!(e instanceof LI))return it(16599,{Rt:e.type});t={verify:$f(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((s=>(function(l,d){const f=d.transform;if(f instanceof Xl)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(f instanceof Zl)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:f.elements}};if(f instanceof ec)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:f.elements}};if(f instanceof Yu)return{fieldPath:d.field.canonicalString(),increment:f.Ee};throw it(20930,{transform:d.transform})})(0,s)))),e.precondition.isNone||(t.currentDocument=(function(a,l){return l.updateTime!==void 0?{updateTime:qI(a,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:it(27497)})(n,e.precondition)),t}function YI(n,e){return n&&n.length>0?(At(e!==void 0,14353),n.map((t=>(function(a,l){let d=a.updateTime?Fs(a.updateTime):Fs(l);return d.isEqual(lt.min())&&(d=Fs(l)),new jI(d,a.transformResults||[])})(t,e)))):[]}function JI(n,e){return{documents:[Cw(n,e.path)]}}function XI(n,e){const t={structuredQuery:{}},s=e.path;let a;e.collectionGroup!==null?(a=s,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=s.popLast(),t.structuredQuery.from=[{collectionId:s.lastSegment()}]),t.parent=Cw(n,a);const l=(function(v){if(v.length!==0)return Nw(Es.create(v,"and"))})(e.filters);l&&(t.structuredQuery.where=l);const d=(function(v){if(v.length!==0)return v.map((w=>(function(I){return{field:bo(I.field),direction:tP(I.dir)}})(w)))})(e.orderBy);d&&(t.structuredQuery.orderBy=d);const f=zf(n,e.limit);return f!==null&&(t.structuredQuery.limit=f),e.startAt&&(t.structuredQuery.startAt=(function(v){return{before:v.inclusive,values:v.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(v){return{before:!v.inclusive,values:v.position}})(e.endAt)),{Vt:t,parent:a}}function ZI(n){let e=HI(n.parent);const t=n.structuredQuery,s=t.from?t.from.length:0;let a=null;if(s>0){At(s===1,65062);const w=t.from[0];w.allDescendants?a=w.collectionId:e=e.child(w.collectionId)}let l=[];t.where&&(l=(function(T){const I=Pw(T);return I instanceof Es&&sw(I)?I.getFilters():[I]})(t.where));let d=[];t.orderBy&&(d=(function(T){return T.map((I=>(function(X){return new Jl(Co(X.field),(function(O){switch(O){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(X.direction))})(I)))})(t.orderBy));let f=null;t.limit&&(f=(function(T){let I;return I=typeof T=="object"?T.value:T,dd(I)?null:I})(t.limit));let m=null;t.startAt&&(m=(function(T){const I=!!T.before,U=T.values||[];return new Ku(U,I)})(t.startAt));let v=null;return t.endAt&&(v=(function(T){const I=!T.before,U=T.values||[];return new Ku(U,I)})(t.endAt)),vI(e,a,d,l,f,"F",m,v)}function eP(n,e){const t=(function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return it(28987,{purpose:a})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Pw(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const s=Co(t.unaryFilter.field);return pn.create(s,"==",{doubleValue:NaN});case"IS_NULL":const a=Co(t.unaryFilter.field);return pn.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=Co(t.unaryFilter.field);return pn.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=Co(t.unaryFilter.field);return pn.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return it(61313);default:return it(60726)}})(n):n.fieldFilter!==void 0?(function(t){return pn.create(Co(t.fieldFilter.field),(function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return it(58110);default:return it(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Es.create(t.compositeFilter.filters.map((s=>Pw(s))),(function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return it(1026)}})(t.compositeFilter.op))})(n):it(30097,{filter:n})}function tP(n){return BI[n]}function nP(n){return $I[n]}function rP(n){return WI[n]}function bo(n){return{fieldPath:n.canonicalString()}}function Co(n){return qn.fromServerFormat(n.fieldPath)}function Nw(n){return n instanceof pn?(function(t){if(t.op==="=="){if(bv(t.value))return{unaryFilter:{field:bo(t.field),op:"IS_NAN"}};if(Sv(t.value))return{unaryFilter:{field:bo(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(bv(t.value))return{unaryFilter:{field:bo(t.field),op:"IS_NOT_NAN"}};if(Sv(t.value))return{unaryFilter:{field:bo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:bo(t.field),op:nP(t.op),value:t.value}}})(n):n instanceof Es?(function(t){const s=t.getFilters().map((a=>Nw(a)));return s.length===1?s[0]:{compositeFilter:{op:rP(t.op),filters:s}}})(n):it(54877,{filter:n})}function sP(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function Rw(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wi{constructor(e,t,s,a,l=lt.min(),d=lt.min(),f=Hn.EMPTY_BYTE_STRING,m=null){this.target=e,this.targetId=t,this.purpose=s,this.sequenceNumber=a,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=f,this.expectedCount=m}withSequenceNumber(e){return new Wi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Wi(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Wi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Wi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iP{constructor(e){this.gt=e}}function aP(n){const e=ZI({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Qu(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oP{constructor(){this.Dn=new lP}addToCollectionParentIndex(e,t){return this.Dn.add(t),ge.resolve()}getCollectionParents(e,t){return ge.resolve(this.Dn.getEntries(t))}addFieldIndex(e,t){return ge.resolve()}deleteFieldIndex(e,t){return ge.resolve()}deleteAllFieldIndexes(e){return ge.resolve()}createTargetIndexes(e,t){return ge.resolve()}getDocumentsMatchingTarget(e,t){return ge.resolve(null)}getIndexType(e,t){return ge.resolve(0)}getFieldIndexes(e,t){return ge.resolve([])}getNextCollectionGroupToUpdate(e){return ge.resolve(null)}getMinOffset(e,t){return ge.resolve(Xi.min())}getMinOffsetFromCollectionGroup(e,t){return ge.resolve(Xi.min())}updateCollectionGroup(e,t,s){return ge.resolve()}updateIndexEntries(e,t){return ge.resolve()}}class lP{constructor(){this.index={}}add(e){const t=e.lastSegment(),s=e.popLast(),a=this.index[t]||new bn(Mt.comparator),l=!a.has(s);return this.index[t]=a.add(s),l}has(e){const t=e.lastSegment(),s=e.popLast(),a=this.index[t];return a&&a.has(s)}getEntries(e){return(this.index[e]||new bn(Mt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fv={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Aw=41943040;class Sr{static withCacheSize(e){return new Sr(e,Sr.DEFAULT_COLLECTION_PERCENTILE,Sr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Sr.DEFAULT_COLLECTION_PERCENTILE=10,Sr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Sr.DEFAULT=new Sr(Aw,Sr.DEFAULT_COLLECTION_PERCENTILE,Sr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Sr.DISABLED=new Sr(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mo{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new Mo(0)}static ur(){return new Mo(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uv="LruGarbageCollector",cP=1048576;function zv([n,e],[t,s]){const a=ft(n,t);return a===0?ft(e,s):a}class uP{constructor(e){this.Tr=e,this.buffer=new bn(zv),this.Ir=0}dr(){return++this.Ir}Er(e){const t=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(t);else{const s=this.buffer.last();zv(t,s)<0&&(this.buffer=this.buffer.delete(s).add(t))}}get maxValue(){return this.buffer.last()[0]}}class dP{constructor(e,t,s){this.garbageCollector=e,this.asyncQueue=t,this.localStore=s,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){Be(Uv,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Ko(t)?Be(Uv,"Ignoring IndexedDB error during garbage collection: ",t):await Ho(t)}await this.Rr(3e5)}))}}class hP{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.mr(e).next((s=>Math.floor(t/100*s)))}nthSequenceNumber(e,t){if(t===0)return ge.resolve(ud.ue);const s=new uP(t);return this.Vr.forEachTarget(e,(a=>s.Er(a.sequenceNumber))).next((()=>this.Vr.gr(e,(a=>s.Er(a))))).next((()=>s.maxValue))}removeTargets(e,t,s){return this.Vr.removeTargets(e,t,s)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Be("LruGarbageCollector","Garbage collection skipped; disabled"),ge.resolve(Fv)):this.getCacheSize(e).next((s=>s<this.params.cacheSizeCollectionThreshold?(Be("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Fv):this.pr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,t){let s,a,l,d,f,m,v;const w=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((T=>(T>this.params.maximumSequenceNumbersToCollect?(Be("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${T}`),a=this.params.maximumSequenceNumbersToCollect):a=T,d=Date.now(),this.nthSequenceNumber(e,a)))).next((T=>(s=T,f=Date.now(),this.removeTargets(e,s,t)))).next((T=>(l=T,m=Date.now(),this.removeOrphanedDocuments(e,s)))).next((T=>(v=Date.now(),To()<=vt.DEBUG&&Be("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-w}ms
	Determined least recently used ${a} in `+(f-d)+`ms
	Removed ${l} targets in `+(m-f)+`ms
	Removed ${T} documents in `+(v-m)+`ms
Total Duration: ${v-w}ms`),ge.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:l,documentsRemoved:T}))))}}function fP(n,e){return new hP(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pP{constructor(){this.changes=new Fa((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ar.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const s=this.changes.get(t);return s!==void 0?ge.resolve(s):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mP{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gP{constructor(e,t,s,a){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=s,this.indexManager=a}getDocument(e,t){let s=null;return this.documentOverlayCache.getOverlay(e,t).next((a=>(s=a,this.remoteDocumentCache.getEntry(e,t)))).next((a=>(s!==null&&zl(s.mutation,a,Or.empty(),Bt.now()),a)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((s=>this.getLocalViewOfDocuments(e,s,_t()).next((()=>s))))}getLocalViewOfDocuments(e,t,s=_t()){const a=Pa();return this.populateOverlays(e,a,t).next((()=>this.computeViews(e,t,a,s).next((l=>{let d=jl();return l.forEach(((f,m)=>{d=d.insert(f,m.overlayedDocument)})),d}))))}getOverlayedDocuments(e,t){const s=Pa();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,_t())))}populateOverlays(e,t,s){const a=[];return s.forEach((l=>{t.has(l)||a.push(l)})),this.documentOverlayCache.getOverlays(e,a).next((l=>{l.forEach(((d,f)=>{t.set(d,f)}))}))}computeViews(e,t,s,a){let l=gi();const d=Ul(),f=(function(){return Ul()})();return t.forEach(((m,v)=>{const w=s.get(v.key);a.has(v.key)&&(w===void 0||w.mutation instanceof ca)?l=l.insert(v.key,v):w!==void 0?(d.set(v.key,w.mutation.getFieldMask()),zl(w.mutation,v,w.mutation.getFieldMask(),Bt.now())):d.set(v.key,Or.empty())})),this.recalculateAndSaveOverlays(e,l).next((m=>(m.forEach(((v,w)=>d.set(v,w))),t.forEach(((v,w)=>{var T;return f.set(v,new mP(w,(T=d.get(v))!==null&&T!==void 0?T:null))})),f)))}recalculateAndSaveOverlays(e,t){const s=Ul();let a=new Kt(((d,f)=>d-f)),l=_t();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((d=>{for(const f of d)f.keys().forEach((m=>{const v=t.get(m);if(v===null)return;let w=s.get(m)||Or.empty();w=f.applyToLocalView(v,w),s.set(m,w);const T=(a.get(f.batchId)||_t()).add(m);a=a.insert(f.batchId,T)}))})).next((()=>{const d=[],f=a.getReverseIterator();for(;f.hasNext();){const m=f.getNext(),v=m.key,w=m.value,T=fw();w.forEach((I=>{if(!l.has(I)){const U=_w(t.get(I),s.get(I));U!==null&&T.set(I,U),l=l.add(I)}})),d.push(this.documentOverlayCache.saveOverlays(e,v,T))}return ge.waitFor(d)})).next((()=>s))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((s=>this.recalculateAndSaveOverlays(e,s)))}getDocumentsMatchingQuery(e,t,s,a){return(function(d){return Xe.isDocumentKey(d.path)&&d.collectionGroup===null&&d.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):lw(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,s,a):this.getDocumentsMatchingCollectionQuery(e,t,s,a)}getNextDocuments(e,t,s,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,s,a).next((l=>{const d=a-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,s.largestBatchId,a-l.size):ge.resolve(Pa());let f=Hl,m=l;return d.next((v=>ge.forEach(v,((w,T)=>(f<T.largestBatchId&&(f=T.largestBatchId),l.get(w)?ge.resolve():this.remoteDocumentCache.getEntry(e,w).next((I=>{m=m.insert(w,I)}))))).next((()=>this.populateOverlays(e,v,l))).next((()=>this.computeViews(e,m,v,_t()))).next((w=>({batchId:f,changes:hw(w)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Xe(t)).next((s=>{let a=jl();return s.isFoundDocument()&&(a=a.insert(s.key,s)),a}))}getDocumentsMatchingCollectionGroupQuery(e,t,s,a){const l=t.collectionGroup;let d=jl();return this.indexManager.getCollectionParents(e,l).next((f=>ge.forEach(f,(m=>{const v=(function(T,I){return new Qo(I,null,T.explicitOrderBy.slice(),T.filters.slice(),T.limit,T.limitType,T.startAt,T.endAt)})(t,m.child(l));return this.getDocumentsMatchingCollectionQuery(e,v,s,a).next((w=>{w.forEach(((T,I)=>{d=d.insert(T,I)}))}))})).next((()=>d))))}getDocumentsMatchingCollectionQuery(e,t,s,a){let l;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,s.largestBatchId).next((d=>(l=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,s,l,a)))).next((d=>{l.forEach(((m,v)=>{const w=v.getKey();d.get(w)===null&&(d=d.insert(w,ar.newInvalidDocument(w)))}));let f=jl();return d.forEach(((m,v)=>{const w=l.get(m);w!==void 0&&zl(w.mutation,v,Or.empty(),Bt.now()),md(t,v)&&(f=f.insert(m,v))})),f}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yP{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,t){return ge.resolve(this.Br.get(t))}saveBundleMetadata(e,t){return this.Br.set(t.id,(function(a){return{id:a.id,version:a.version,createTime:Fs(a.createTime)}})(t)),ge.resolve()}getNamedQuery(e,t){return ge.resolve(this.Lr.get(t))}saveNamedQuery(e,t){return this.Lr.set(t.name,(function(a){return{name:a.name,query:aP(a.bundledQuery),readTime:Fs(a.readTime)}})(t)),ge.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vP{constructor(){this.overlays=new Kt(Xe.comparator),this.kr=new Map}getOverlay(e,t){return ge.resolve(this.overlays.get(t))}getOverlays(e,t){const s=Pa();return ge.forEach(t,(a=>this.getOverlay(e,a).next((l=>{l!==null&&s.set(a,l)})))).next((()=>s))}saveOverlays(e,t,s){return s.forEach(((a,l)=>{this.wt(e,t,l)})),ge.resolve()}removeOverlaysForBatchId(e,t,s){const a=this.kr.get(s);return a!==void 0&&(a.forEach((l=>this.overlays=this.overlays.remove(l))),this.kr.delete(s)),ge.resolve()}getOverlaysForCollection(e,t,s){const a=Pa(),l=t.length+1,d=new Xe(t.child("")),f=this.overlays.getIteratorFrom(d);for(;f.hasNext();){const m=f.getNext().value,v=m.getKey();if(!t.isPrefixOf(v.path))break;v.path.length===l&&m.largestBatchId>s&&a.set(m.getKey(),m)}return ge.resolve(a)}getOverlaysForCollectionGroup(e,t,s,a){let l=new Kt(((v,w)=>v-w));const d=this.overlays.getIterator();for(;d.hasNext();){const v=d.getNext().value;if(v.getKey().getCollectionGroup()===t&&v.largestBatchId>s){let w=l.get(v.largestBatchId);w===null&&(w=Pa(),l=l.insert(v.largestBatchId,w)),w.set(v.getKey(),v)}}const f=Pa(),m=l.getIterator();for(;m.hasNext()&&(m.getNext().value.forEach(((v,w)=>f.set(v,w))),!(f.size()>=a)););return ge.resolve(f)}wt(e,t,s){const a=this.overlays.get(s.key);if(a!==null){const d=this.kr.get(a.largestBatchId).delete(s.key);this.kr.set(a.largestBatchId,d)}this.overlays=this.overlays.insert(s.key,new MI(t,s));let l=this.kr.get(t);l===void 0&&(l=_t(),this.kr.set(t,l)),this.kr.set(t,l.add(s.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _P{constructor(){this.sessionToken=Hn.EMPTY_BYTE_STRING}getSessionToken(e){return ge.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ge.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kp{constructor(){this.qr=new bn(Mn.Qr),this.$r=new bn(Mn.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,t){const s=new Mn(e,t);this.qr=this.qr.add(s),this.$r=this.$r.add(s)}Kr(e,t){e.forEach((s=>this.addReference(s,t)))}removeReference(e,t){this.Wr(new Mn(e,t))}Gr(e,t){e.forEach((s=>this.removeReference(s,t)))}zr(e){const t=new Xe(new Mt([])),s=new Mn(t,e),a=new Mn(t,e+1),l=[];return this.$r.forEachInRange([s,a],(d=>{this.Wr(d),l.push(d.key)})),l}jr(){this.qr.forEach((e=>this.Wr(e)))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const t=new Xe(new Mt([])),s=new Mn(t,e),a=new Mn(t,e+1);let l=_t();return this.$r.forEachInRange([s,a],(d=>{l=l.add(d.key)})),l}containsKey(e){const t=new Mn(e,0),s=this.qr.firstAfterOrEqual(t);return s!==null&&e.isEqual(s.key)}}class Mn{constructor(e,t){this.key=e,this.Hr=t}static Qr(e,t){return Xe.comparator(e.key,t.key)||ft(e.Hr,t.Hr)}static Ur(e,t){return ft(e.Hr,t.Hr)||Xe.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wP{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.er=1,this.Yr=new bn(Mn.Qr)}checkEmpty(e){return ge.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,s,a){const l=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new VI(l,t,s,a);this.mutationQueue.push(d);for(const f of a)this.Yr=this.Yr.add(new Mn(f.key,l)),this.indexManager.addToCollectionParentIndex(e,f.key.path.popLast());return ge.resolve(d)}lookupMutationBatch(e,t){return ge.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const s=t+1,a=this.Xr(s),l=a<0?0:a;return ge.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return ge.resolve(this.mutationQueue.length===0?Tp:this.er-1)}getAllMutationBatches(e){return ge.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const s=new Mn(t,0),a=new Mn(t,Number.POSITIVE_INFINITY),l=[];return this.Yr.forEachInRange([s,a],(d=>{const f=this.Zr(d.Hr);l.push(f)})),ge.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new bn(ft);return t.forEach((a=>{const l=new Mn(a,0),d=new Mn(a,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([l,d],(f=>{s=s.add(f.Hr)}))})),ge.resolve(this.ei(s))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,a=s.length+1;let l=s;Xe.isDocumentKey(l)||(l=l.child(""));const d=new Mn(new Xe(l),0);let f=new bn(ft);return this.Yr.forEachWhile((m=>{const v=m.key.path;return!!s.isPrefixOf(v)&&(v.length===a&&(f=f.add(m.Hr)),!0)}),d),ge.resolve(this.ei(f))}ei(e){const t=[];return e.forEach((s=>{const a=this.Zr(s);a!==null&&t.push(a)})),t}removeMutationBatch(e,t){At(this.ti(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let s=this.Yr;return ge.forEach(t.mutations,(a=>{const l=new Mn(a.key,t.batchId);return s=s.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((()=>{this.Yr=s}))}rr(e){}containsKey(e,t){const s=new Mn(t,0),a=this.Yr.firstAfterOrEqual(s);return ge.resolve(t.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,ge.resolve()}ti(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xP{constructor(e){this.ni=e,this.docs=(function(){return new Kt(Xe.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const s=t.key,a=this.docs.get(s),l=a?a.size:0,d=this.ni(t);return this.docs=this.docs.insert(s,{document:t.mutableCopy(),size:d}),this.size+=d-l,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const s=this.docs.get(t);return ge.resolve(s?s.document.mutableCopy():ar.newInvalidDocument(t))}getEntries(e,t){let s=gi();return t.forEach((a=>{const l=this.docs.get(a);s=s.insert(a,l?l.document.mutableCopy():ar.newInvalidDocument(a))})),ge.resolve(s)}getDocumentsMatchingQuery(e,t,s,a){let l=gi();const d=t.path,f=new Xe(d.child("__id-9223372036854775808__")),m=this.docs.getIteratorFrom(f);for(;m.hasNext();){const{key:v,value:{document:w}}=m.getNext();if(!d.isPrefixOf(v.path))break;v.path.length>d.length+1||YC(QC(w),s)<=0||(a.has(w.key)||md(t,w))&&(l=l.insert(w.key,w.mutableCopy()))}return ge.resolve(l)}getAllFromCollectionGroup(e,t,s,a){it(9500)}ri(e,t){return ge.forEach(this.docs,(s=>t(s)))}newChangeBuffer(e){return new EP(this)}getSize(e){return ge.resolve(this.size)}}class EP extends pP{constructor(e){super(),this.Or=e}applyChanges(e){const t=[];return this.changes.forEach(((s,a)=>{a.isValidDocument()?t.push(this.Or.addEntry(e,a)):this.Or.removeEntry(s)})),ge.waitFor(t)}getFromCache(e,t){return this.Or.getEntry(e,t)}getAllFromCache(e,t){return this.Or.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TP{constructor(e){this.persistence=e,this.ii=new Fa((t=>Cp(t)),Ip),this.lastRemoteSnapshotVersion=lt.min(),this.highestTargetId=0,this.si=0,this.oi=new kp,this.targetCount=0,this._i=Mo.ar()}forEachTarget(e,t){return this.ii.forEach(((s,a)=>t(a))),ge.resolve()}getLastRemoteSnapshotVersion(e){return ge.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ge.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),ge.resolve(this.highestTargetId)}setTargetsMetadata(e,t,s){return s&&(this.lastRemoteSnapshotVersion=s),t>this.si&&(this.si=t),ge.resolve()}hr(e){this.ii.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this._i=new Mo(t),this.highestTargetId=t),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,t){return this.hr(t),this.targetCount+=1,ge.resolve()}updateTargetData(e,t){return this.hr(t),ge.resolve()}removeTargetData(e,t){return this.ii.delete(t.target),this.oi.zr(t.targetId),this.targetCount-=1,ge.resolve()}removeTargets(e,t,s){let a=0;const l=[];return this.ii.forEach(((d,f)=>{f.sequenceNumber<=t&&s.get(f.targetId)===null&&(this.ii.delete(d),l.push(this.removeMatchingKeysForTargetId(e,f.targetId)),a++)})),ge.waitFor(l).next((()=>a))}getTargetCount(e){return ge.resolve(this.targetCount)}getTargetData(e,t){const s=this.ii.get(t)||null;return ge.resolve(s)}addMatchingKeys(e,t,s){return this.oi.Kr(t,s),ge.resolve()}removeMatchingKeys(e,t,s){this.oi.Gr(t,s);const a=this.persistence.referenceDelegate,l=[];return a&&t.forEach((d=>{l.push(a.markPotentiallyOrphaned(e,d))})),ge.waitFor(l)}removeMatchingKeysForTargetId(e,t){return this.oi.zr(t),ge.resolve()}getMatchingKeysForTargetId(e,t){const s=this.oi.Jr(t);return ge.resolve(s)}containsKey(e,t){return ge.resolve(this.oi.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jw{constructor(e,t){this.ai={},this.overlays={},this.ui=new ud(0),this.ci=!1,this.ci=!0,this.li=new _P,this.referenceDelegate=e(this),this.hi=new TP(this),this.indexManager=new oP,this.remoteDocumentCache=(function(a){return new xP(a)})((s=>this.referenceDelegate.Pi(s))),this.serializer=new iP(t),this.Ti=new yP(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new vP,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let s=this.ai[e.toKey()];return s||(s=new wP(t,this.referenceDelegate),this.ai[e.toKey()]=s),s}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,t,s){Be("MemoryPersistence","Starting transaction:",e);const a=new SP(this.ui.next());return this.referenceDelegate.Ii(),s(a).next((l=>this.referenceDelegate.di(a).next((()=>l)))).toPromise().then((l=>(a.raiseOnCommittedEvent(),l)))}Ei(e,t){return ge.or(Object.values(this.ai).map((s=>()=>s.containsKey(e,t))))}}class SP extends XC{constructor(e){super(),this.currentSequenceNumber=e}}class Dp{constructor(e){this.persistence=e,this.Ai=new kp,this.Ri=null}static Vi(e){return new Dp(e)}get mi(){if(this.Ri)return this.Ri;throw it(60996)}addReference(e,t,s){return this.Ai.addReference(s,t),this.mi.delete(s.toString()),ge.resolve()}removeReference(e,t,s){return this.Ai.removeReference(s,t),this.mi.add(s.toString()),ge.resolve()}markPotentiallyOrphaned(e,t){return this.mi.add(t.toString()),ge.resolve()}removeTarget(e,t){this.Ai.zr(t.targetId).forEach((a=>this.mi.add(a.toString())));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,t.targetId).next((a=>{a.forEach((l=>this.mi.add(l.toString())))})).next((()=>s.removeTargetData(e,t)))}Ii(){this.Ri=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ge.forEach(this.mi,(s=>{const a=Xe.fromPath(s);return this.fi(e,a).next((l=>{l||t.removeEntry(a,lt.min())}))})).next((()=>(this.Ri=null,t.apply(e))))}updateLimboDocument(e,t){return this.fi(e,t).next((s=>{s?this.mi.delete(t.toString()):this.mi.add(t.toString())}))}Pi(e){return 0}fi(e,t){return ge.or([()=>ge.resolve(this.Ai.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class Xu{constructor(e,t){this.persistence=e,this.gi=new Fa((s=>tI(s.path)),((s,a)=>s.isEqual(a))),this.garbageCollector=fP(this,t)}static Vi(e,t){return new Xu(e,t)}Ii(){}di(e){return ge.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}mr(e){const t=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next((s=>t.next((a=>s+a))))}yr(e){let t=0;return this.gr(e,(s=>{t++})).next((()=>t))}gr(e,t){return ge.forEach(this.gi,((s,a)=>this.Sr(e,s,a).next((l=>l?ge.resolve():t(a)))))}removeTargets(e,t,s){return this.persistence.getTargetCache().removeTargets(e,t,s)}removeOrphanedDocuments(e,t){let s=0;const a=this.persistence.getRemoteDocumentCache(),l=a.newChangeBuffer();return a.ri(e,(d=>this.Sr(e,d,t).next((f=>{f||(s++,l.removeEntry(d,lt.min()))})))).next((()=>l.apply(e))).next((()=>s))}markPotentiallyOrphaned(e,t){return this.gi.set(t,e.currentSequenceNumber),ge.resolve()}removeTarget(e,t){const s=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,s)}addReference(e,t,s){return this.gi.set(s,e.currentSequenceNumber),ge.resolve()}removeReference(e,t,s){return this.gi.set(s,e.currentSequenceNumber),ge.resolve()}updateLimboDocument(e,t){return this.gi.set(t,e.currentSequenceNumber),ge.resolve()}Pi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Nu(e.data.value)),t}Sr(e,t,s){return ge.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const a=this.gi.get(t);return ge.resolve(a!==void 0&&a>s)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lp{constructor(e,t,s,a){this.targetId=e,this.fromCache=t,this.Is=s,this.ds=a}static Es(e,t){let s=_t(),a=_t();for(const l of t.docChanges)switch(l.type){case 0:s=s.add(l.doc.key);break;case 1:a=a.add(l.doc.key)}return new Lp(e,t.fromCache,s,a)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bP{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CP{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=(function(){return tS()?8:ZC(or())>0?6:4})()}initialize(e,t){this.gs=e,this.indexManager=t,this.As=!0}getDocumentsMatchingQuery(e,t,s,a){const l={result:null};return this.ps(e,t).next((d=>{l.result=d})).next((()=>{if(!l.result)return this.ys(e,t,a,s).next((d=>{l.result=d}))})).next((()=>{if(l.result)return;const d=new bP;return this.ws(e,t,d).next((f=>{if(l.result=f,this.Rs)return this.Ss(e,t,d,f.size)}))})).next((()=>l.result))}Ss(e,t,s,a){return s.documentReadCount<this.Vs?(To()<=vt.DEBUG&&Be("QueryEngine","SDK will not create cache indexes for query:",So(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),ge.resolve()):(To()<=vt.DEBUG&&Be("QueryEngine","Query:",So(t),"scans",s.documentReadCount,"local documents and returns",a,"documents as results."),s.documentReadCount>this.fs*a?(To()<=vt.DEBUG&&Be("QueryEngine","The SDK decides to create cache indexes for query:",So(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Os(t))):ge.resolve())}ps(e,t){if(Nv(t))return ge.resolve(null);let s=Os(t);return this.indexManager.getIndexType(e,s).next((a=>a===0?null:(t.limit!==null&&a===1&&(t=Qu(t,null,"F"),s=Os(t)),this.indexManager.getDocumentsMatchingTarget(e,s).next((l=>{const d=_t(...l);return this.gs.getDocuments(e,d).next((f=>this.indexManager.getMinOffset(e,s).next((m=>{const v=this.bs(t,f);return this.Ds(t,v,d,m.readTime)?this.ps(e,Qu(t,null,"F")):this.vs(e,v,t,m)}))))})))))}ys(e,t,s,a){return Nv(t)||a.isEqual(lt.min())?ge.resolve(null):this.gs.getDocuments(e,s).next((l=>{const d=this.bs(t,l);return this.Ds(t,d,s,a)?ge.resolve(null):(To()<=vt.DEBUG&&Be("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),So(t)),this.vs(e,d,t,KC(a,Hl)).next((f=>f)))}))}bs(e,t){let s=new bn(uw(e));return t.forEach(((a,l)=>{md(e,l)&&(s=s.add(l))})),s}Ds(e,t,s,a){if(e.limit===null)return!1;if(s.size!==t.size)return!0;const l=e.limitType==="F"?t.last():t.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(a)>0)}ws(e,t,s){return To()<=vt.DEBUG&&Be("QueryEngine","Using full collection scan to execute query:",So(t)),this.gs.getDocumentsMatchingQuery(e,t,Xi.min(),s)}vs(e,t,s,a){return this.gs.getDocumentsMatchingQuery(e,s,a).next((l=>(t.forEach((d=>{l=l.insert(d.key,d)})),l)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vp="LocalStore",IP=3e8;class PP{constructor(e,t,s,a){this.persistence=e,this.Cs=t,this.serializer=a,this.Fs=new Kt(ft),this.Ms=new Fa((l=>Cp(l)),Ip),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(s)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new gP(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Fs)))}}function NP(n,e,t,s){return new PP(n,e,t,s)}async function kw(n,e){const t=ct(n);return await t.persistence.runTransaction("Handle user change","readonly",(s=>{let a;return t.mutationQueue.getAllMutationBatches(s).next((l=>(a=l,t.Ns(e),t.mutationQueue.getAllMutationBatches(s)))).next((l=>{const d=[],f=[];let m=_t();for(const v of a){d.push(v.batchId);for(const w of v.mutations)m=m.add(w.key)}for(const v of l){f.push(v.batchId);for(const w of v.mutations)m=m.add(w.key)}return t.localDocuments.getDocuments(s,m).next((v=>({Bs:v,removedBatchIds:d,addedBatchIds:f})))}))}))}function RP(n,e){const t=ct(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(s=>{const a=e.batch.keys(),l=t.Os.newChangeBuffer({trackRemovals:!0});return(function(f,m,v,w){const T=v.batch,I=T.keys();let U=ge.resolve();return I.forEach((X=>{U=U.next((()=>w.getEntry(m,X))).next(($=>{const O=v.docVersions.get(X);At(O!==null,48541),$.version.compareTo(O)<0&&(T.applyToRemoteDocument($,v),$.isValidDocument()&&($.setReadTime(v.commitVersion),w.addEntry($)))}))})),U.next((()=>f.mutationQueue.removeMutationBatch(m,T)))})(t,s,e,l).next((()=>l.apply(s))).next((()=>t.mutationQueue.performConsistencyCheck(s))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(s,a,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,(function(f){let m=_t();for(let v=0;v<f.mutationResults.length;++v)f.mutationResults[v].transformResults.length>0&&(m=m.add(f.batch.mutations[v].key));return m})(e)))).next((()=>t.localDocuments.getDocuments(s,a)))}))}function Dw(n){const e=ct(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.hi.getLastRemoteSnapshotVersion(t)))}function AP(n,e){const t=ct(n),s=e.snapshotVersion;let a=t.Fs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const d=t.Os.newChangeBuffer({trackRemovals:!0});a=t.Fs;const f=[];e.targetChanges.forEach(((w,T)=>{const I=a.get(T);if(!I)return;f.push(t.hi.removeMatchingKeys(l,w.removedDocuments,T).next((()=>t.hi.addMatchingKeys(l,w.addedDocuments,T))));let U=I.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(T)!==null?U=U.withResumeToken(Hn.EMPTY_BYTE_STRING,lt.min()).withLastLimboFreeSnapshotVersion(lt.min()):w.resumeToken.approximateByteSize()>0&&(U=U.withResumeToken(w.resumeToken,s)),a=a.insert(T,U),(function($,O,se){return $.resumeToken.approximateByteSize()===0||O.snapshotVersion.toMicroseconds()-$.snapshotVersion.toMicroseconds()>=IP?!0:se.addedDocuments.size+se.modifiedDocuments.size+se.removedDocuments.size>0})(I,U,w)&&f.push(t.hi.updateTargetData(l,U))}));let m=gi(),v=_t();if(e.documentUpdates.forEach((w=>{e.resolvedLimboDocuments.has(w)&&f.push(t.persistence.referenceDelegate.updateLimboDocument(l,w))})),f.push(jP(l,d,e.documentUpdates).next((w=>{m=w.Ls,v=w.ks}))),!s.isEqual(lt.min())){const w=t.hi.getLastRemoteSnapshotVersion(l).next((T=>t.hi.setTargetsMetadata(l,l.currentSequenceNumber,s)));f.push(w)}return ge.waitFor(f).next((()=>d.apply(l))).next((()=>t.localDocuments.getLocalViewOfDocuments(l,m,v))).next((()=>m))})).then((l=>(t.Fs=a,l)))}function jP(n,e,t){let s=_t(),a=_t();return t.forEach((l=>s=s.add(l))),e.getEntries(n,s).next((l=>{let d=gi();return t.forEach(((f,m)=>{const v=l.get(f);m.isFoundDocument()!==v.isFoundDocument()&&(a=a.add(f)),m.isNoDocument()&&m.version.isEqual(lt.min())?(e.removeEntry(f,m.readTime),d=d.insert(f,m)):!v.isValidDocument()||m.version.compareTo(v.version)>0||m.version.compareTo(v.version)===0&&v.hasPendingWrites?(e.addEntry(m),d=d.insert(f,m)):Be(Vp,"Ignoring outdated watch update for ",f,". Current version:",v.version," Watch version:",m.version)})),{Ls:d,ks:a}}))}function kP(n,e){const t=ct(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(s=>(e===void 0&&(e=Tp),t.mutationQueue.getNextMutationBatchAfterBatchId(s,e))))}function DP(n,e){const t=ct(n);return t.persistence.runTransaction("Allocate target","readwrite",(s=>{let a;return t.hi.getTargetData(s,e).next((l=>l?(a=l,ge.resolve(a)):t.hi.allocateTargetId(s).next((d=>(a=new Wi(e,d,"TargetPurposeListen",s.currentSequenceNumber),t.hi.addTargetData(s,a).next((()=>a)))))))})).then((s=>{const a=t.Fs.get(s.targetId);return(a===null||s.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(t.Fs=t.Fs.insert(s.targetId,s),t.Ms.set(e,s.targetId)),s}))}async function Gf(n,e,t){const s=ct(n),a=s.Fs.get(e),l=t?"readwrite":"readwrite-primary";try{t||await s.persistence.runTransaction("Release target",l,(d=>s.persistence.referenceDelegate.removeTarget(d,a)))}catch(d){if(!Ko(d))throw d;Be(Vp,`Failed to update sequence numbers for target ${e}: ${d}`)}s.Fs=s.Fs.remove(e),s.Ms.delete(a.target)}function Bv(n,e,t){const s=ct(n);let a=lt.min(),l=_t();return s.persistence.runTransaction("Execute query","readwrite",(d=>(function(m,v,w){const T=ct(m),I=T.Ms.get(w);return I!==void 0?ge.resolve(T.Fs.get(I)):T.hi.getTargetData(v,w)})(s,d,Os(e)).next((f=>{if(f)return a=f.lastLimboFreeSnapshotVersion,s.hi.getMatchingKeysForTargetId(d,f.targetId).next((m=>{l=m}))})).next((()=>s.Cs.getDocumentsMatchingQuery(d,e,t?a:lt.min(),t?l:_t()))).next((f=>(LP(s,wI(e),f),{documents:f,qs:l})))))}function LP(n,e,t){let s=n.xs.get(e)||lt.min();t.forEach(((a,l)=>{l.readTime.compareTo(s)>0&&(s=l.readTime)})),n.xs.set(e,s)}class $v{constructor(){this.activeTargetIds=CI()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class VP{constructor(){this.Fo=new $v,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,s){}addLocalQueryTarget(e,t=!0){return t&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,t,s){this.Mo[e]=t}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new $v,Promise.resolve()}handleUserChange(e,t,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MP{xo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wv="ConnectivityMonitor";class Gv{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){Be(Wv,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){Be(Wv,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xu=null;function qf(){return xu===null?xu=(function(){return 268435456+Math.round(2147483648*Math.random())})():xu++,"0x"+xu.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pf="RestConnection",OP={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class FP{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.$o=t+"://"+e.host,this.Uo=`projects/${s}/databases/${a}`,this.Ko=this.databaseId.database===qu?`project_id=${s}`:`project_id=${s}&database_id=${a}`}Wo(e,t,s,a,l){const d=qf(),f=this.Go(e,t.toUriEncodedString());Be(pf,`Sending RPC '${e}' ${d}:`,f,s);const m={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(m,a,l);const{host:v}=new URL(f),w=Bo(v);return this.jo(e,f,m,s,w).then((T=>(Be(pf,`Received RPC '${e}' ${d}: `,T),T)),(T=>{throw Ji(pf,`RPC '${e}' ${d} failed with error: `,T,"url: ",f,"request:",s),T}))}Jo(e,t,s,a,l,d){return this.Wo(e,t,s,a,l)}zo(e,t,s){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+qo})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((a,l)=>e[l]=a)),s&&s.headers.forEach(((a,l)=>e[l]=a))}Go(e,t){const s=OP[e];return`${this.$o}/v1/${t}:${s}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UP{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sr="WebChannelConnection";class zP extends FP{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,t,s,a,l){const d=qf();return new Promise(((f,m)=>{const v=new V0;v.setWithCredentials(!0),v.listenOnce(M0.COMPLETE,(()=>{try{switch(v.getLastErrorCode()){case Pu.NO_ERROR:const T=v.getResponseJson();Be(sr,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(T)),f(T);break;case Pu.TIMEOUT:Be(sr,`RPC '${e}' ${d} timed out`),m(new Ue(pe.DEADLINE_EXCEEDED,"Request time out"));break;case Pu.HTTP_ERROR:const I=v.getStatus();if(Be(sr,`RPC '${e}' ${d} failed with status:`,I,"response text:",v.getResponseText()),I>0){let U=v.getResponseJson();Array.isArray(U)&&(U=U[0]);const X=U==null?void 0:U.error;if(X&&X.status&&X.message){const $=(function(se){const Te=se.toLowerCase().replace(/_/g,"-");return Object.values(pe).indexOf(Te)>=0?Te:pe.UNKNOWN})(X.status);m(new Ue($,X.message))}else m(new Ue(pe.UNKNOWN,"Server responded with status "+v.getStatus()))}else m(new Ue(pe.UNAVAILABLE,"Connection failed."));break;default:it(9055,{c_:e,streamId:d,l_:v.getLastErrorCode(),h_:v.getLastError()})}}finally{Be(sr,`RPC '${e}' ${d} completed.`)}}));const w=JSON.stringify(a);Be(sr,`RPC '${e}' ${d} sending request:`,a),v.send(t,"POST",w,s,15)}))}P_(e,t,s){const a=qf(),l=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=U0(),f=F0(),m={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},v=this.longPollingOptions.timeoutSeconds;v!==void 0&&(m.longPollingTimeout=Math.round(1e3*v)),this.useFetchStreams&&(m.useFetchStreams=!0),this.zo(m.initMessageHeaders,t,s),m.encodeInitMessageHeaders=!0;const w=l.join("");Be(sr,`Creating RPC '${e}' stream ${a}: ${w}`,m);const T=d.createWebChannel(w,m);this.T_(T);let I=!1,U=!1;const X=new UP({Ho:O=>{U?Be(sr,`Not sending because RPC '${e}' stream ${a} is closed:`,O):(I||(Be(sr,`Opening RPC '${e}' stream ${a} transport.`),T.open(),I=!0),Be(sr,`RPC '${e}' stream ${a} sending:`,O),T.send(O))},Yo:()=>T.close()}),$=(O,se,Te)=>{O.listen(se,(xe=>{try{Te(xe)}catch(_e){setTimeout((()=>{throw _e}),0)}}))};return $(T,Al.EventType.OPEN,(()=>{U||(Be(sr,`RPC '${e}' stream ${a} transport opened.`),X.s_())})),$(T,Al.EventType.CLOSE,(()=>{U||(U=!0,Be(sr,`RPC '${e}' stream ${a} transport closed`),X.__(),this.I_(T))})),$(T,Al.EventType.ERROR,(O=>{U||(U=!0,Ji(sr,`RPC '${e}' stream ${a} transport errored. Name:`,O.name,"Message:",O.message),X.__(new Ue(pe.UNAVAILABLE,"The operation could not be completed")))})),$(T,Al.EventType.MESSAGE,(O=>{var se;if(!U){const Te=O.data[0];At(!!Te,16349);const xe=Te,_e=(xe==null?void 0:xe.error)||((se=xe[0])===null||se===void 0?void 0:se.error);if(_e){Be(sr,`RPC '${e}' stream ${a} received error:`,_e);const V=_e.status;let ie=(function(A){const M=fn[A];if(M!==void 0)return xw(M)})(V),C=_e.message;ie===void 0&&(ie=pe.INTERNAL,C="Unknown error status: "+V+" with message "+_e.message),U=!0,X.__(new Ue(ie,C)),T.close()}else Be(sr,`RPC '${e}' stream ${a} received:`,Te),X.a_(Te)}})),$(f,O0.STAT_EVENT,(O=>{O.stat===Df.PROXY?Be(sr,`RPC '${e}' stream ${a} detected buffering proxy`):O.stat===Df.NOPROXY&&Be(sr,`RPC '${e}' stream ${a} detected no buffering proxy`)})),setTimeout((()=>{X.o_()}),0),X}terminate(){this.u_.forEach((e=>e.close())),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter((t=>t===e))}}function mf(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _d(n){return new GI(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lw{constructor(e,t,s=1e3,a=1.5,l=6e4){this.Fi=e,this.timerId=t,this.d_=s,this.E_=a,this.A_=l,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const t=Math.floor(this.R_+this.p_()),s=Math.max(0,Date.now()-this.m_),a=Math.max(0,t-s);a>0&&Be("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.R_} ms, delay with jitter: ${t} ms, last attempt: ${s} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,a,(()=>(this.m_=Date.now(),e()))),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qv="PersistentStream";class Vw{constructor(e,t,s,a,l,d,f,m){this.Fi=e,this.w_=s,this.S_=a,this.connection=l,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=f,this.listener=m,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new Lw(e,t)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,(()=>this.L_())))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():t&&t.code===pe.RESOURCE_EXHAUSTED?(mi(t.toString()),mi("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):t&&t.code===pe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(t)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),t=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([s,a])=>{this.b_===t&&this.W_(s,a)}),(s=>{e((()=>{const a=new Ue(pe.UNKNOWN,"Fetching auth token failed: "+s.message);return this.G_(a)}))}))}W_(e,t){const s=this.K_(this.b_);this.stream=this.z_(e,t),this.stream.Zo((()=>{s((()=>this.listener.Zo()))})),this.stream.e_((()=>{s((()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,(()=>(this.x_()&&(this.state=3),Promise.resolve()))),this.listener.e_())))})),this.stream.n_((a=>{s((()=>this.G_(a)))})),this.stream.onMessage((a=>{s((()=>++this.C_==1?this.j_(a):this.onNext(a)))}))}O_(){this.state=5,this.F_.g_((async()=>{this.state=0,this.start()}))}G_(e){return Be(qv,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return t=>{this.Fi.enqueueAndForget((()=>this.b_===e?t():(Be(qv,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class BP extends Vw{constructor(e,t,s,a,l,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,s,a,d),this.serializer=l}z_(e,t){return this.connection.P_("Listen",e,t)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const t=KI(this.serializer,e),s=(function(l){if(!("targetChange"in l))return lt.min();const d=l.targetChange;return d.targetIds&&d.targetIds.length?lt.min():d.readTime?Fs(d.readTime):lt.min()})(e);return this.listener.J_(t,s)}H_(e){const t={};t.database=Wf(this.serializer),t.addTarget=(function(l,d){let f;const m=d.target;if(f=Ff(m)?{documents:JI(l,m)}:{query:XI(l,m).Vt},f.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){f.resumeToken=Sw(l,d.resumeToken);const v=zf(l,d.expectedCount);v!==null&&(f.expectedCount=v)}else if(d.snapshotVersion.compareTo(lt.min())>0){f.readTime=Ju(l,d.snapshotVersion.toTimestamp());const v=zf(l,d.expectedCount);v!==null&&(f.expectedCount=v)}return f})(this.serializer,e);const s=eP(this.serializer,e);s&&(t.labels=s),this.k_(t)}Y_(e){const t={};t.database=Wf(this.serializer),t.removeTarget=e,this.k_(t)}}class $P extends Vw{constructor(e,t,s,a,l,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,s,a,d),this.serializer=l}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,t){return this.connection.P_("Write",e,t)}j_(e){return At(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,At(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){At(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();const t=YI(e.writeResults,e.commitTime),s=Fs(e.commitTime);return this.listener.ta(s,t)}na(){const e={};e.database=Wf(this.serializer),this.k_(e)}X_(e){const t={streamToken:this.lastStreamToken,writes:e.map((s=>QI(this.serializer,s)))};this.k_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WP{}class GP extends WP{constructor(e,t,s,a){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=s,this.serializer=a,this.ra=!1}ia(){if(this.ra)throw new Ue(pe.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,s,a){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,d])=>this.connection.Wo(e,Bf(t,s),a,l,d))).catch((l=>{throw l.name==="FirebaseError"?(l.code===pe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new Ue(pe.UNKNOWN,l.toString())}))}Jo(e,t,s,a,l){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([d,f])=>this.connection.Jo(e,Bf(t,s),a,d,f,l))).catch((d=>{throw d.name==="FirebaseError"?(d.code===pe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new Ue(pe.UNKNOWN,d.toString())}))}terminate(){this.ra=!0,this.connection.terminate()}}class qP{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve()))))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(mi(t),this._a=!1):Be("OnlineStateTracker",t)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oa="RemoteStore";class HP{constructor(e,t,s,a,l){this.localStore=e,this.datastore=t,this.asyncQueue=s,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=l,this.Ea.xo((d=>{s.enqueueAndForget((async()=>{Ua(this)&&(Be(Oa,"Restarting streams for network reachability change."),await(async function(m){const v=ct(m);v.Ia.add(4),await uc(v),v.Aa.set("Unknown"),v.Ia.delete(4),await wd(v)})(this))}))})),this.Aa=new qP(s,a)}}async function wd(n){if(Ua(n))for(const e of n.da)await e(!0)}async function uc(n){for(const e of n.da)await e(!1)}function Mw(n,e){const t=ct(n);t.Ta.has(e.targetId)||(t.Ta.set(e.targetId,e),Up(t)?Fp(t):Yo(t).x_()&&Op(t,e))}function Mp(n,e){const t=ct(n),s=Yo(t);t.Ta.delete(e),s.x_()&&Ow(t,e),t.Ta.size===0&&(s.x_()?s.B_():Ua(t)&&t.Aa.set("Unknown"))}function Op(n,e){if(n.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(lt.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Yo(n).H_(e)}function Ow(n,e){n.Ra.$e(e),Yo(n).Y_(e)}function Fp(n){n.Ra=new zI({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>n.Ta.get(e)||null,lt:()=>n.datastore.serializer.databaseId}),Yo(n).start(),n.Aa.aa()}function Up(n){return Ua(n)&&!Yo(n).M_()&&n.Ta.size>0}function Ua(n){return ct(n).Ia.size===0}function Fw(n){n.Ra=void 0}async function KP(n){n.Aa.set("Online")}async function QP(n){n.Ta.forEach(((e,t)=>{Op(n,e)}))}async function YP(n,e){Fw(n),Up(n)?(n.Aa.la(e),Fp(n)):n.Aa.set("Unknown")}async function JP(n,e,t){if(n.Aa.set("Online"),e instanceof Tw&&e.state===2&&e.cause)try{await(async function(a,l){const d=l.cause;for(const f of l.targetIds)a.Ta.has(f)&&(await a.remoteSyncer.rejectListen(f,d),a.Ta.delete(f),a.Ra.removeTarget(f))})(n,e)}catch(s){Be(Oa,"Failed to remove targets %s: %s ",e.targetIds.join(","),s),await Zu(n,s)}else if(e instanceof ju?n.Ra.Ye(e):e instanceof Ew?n.Ra.it(e):n.Ra.et(e),!t.isEqual(lt.min()))try{const s=await Dw(n.localStore);t.compareTo(s)>=0&&await(function(l,d){const f=l.Ra.Pt(d);return f.targetChanges.forEach(((m,v)=>{if(m.resumeToken.approximateByteSize()>0){const w=l.Ta.get(v);w&&l.Ta.set(v,w.withResumeToken(m.resumeToken,d))}})),f.targetMismatches.forEach(((m,v)=>{const w=l.Ta.get(m);if(!w)return;l.Ta.set(m,w.withResumeToken(Hn.EMPTY_BYTE_STRING,w.snapshotVersion)),Ow(l,m);const T=new Wi(w.target,m,v,w.sequenceNumber);Op(l,T)})),l.remoteSyncer.applyRemoteEvent(f)})(n,t)}catch(s){Be(Oa,"Failed to raise snapshot:",s),await Zu(n,s)}}async function Zu(n,e,t){if(!Ko(e))throw e;n.Ia.add(1),await uc(n),n.Aa.set("Offline"),t||(t=()=>Dw(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{Be(Oa,"Retrying IndexedDB access"),await t(),n.Ia.delete(1),await wd(n)}))}function Uw(n,e){return e().catch((t=>Zu(n,t,e)))}async function xd(n){const e=ct(n),t=na(e);let s=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:Tp;for(;XP(e);)try{const a=await kP(e.localStore,s);if(a===null){e.Pa.length===0&&t.B_();break}s=a.batchId,ZP(e,a)}catch(a){await Zu(e,a)}zw(e)&&Bw(e)}function XP(n){return Ua(n)&&n.Pa.length<10}function ZP(n,e){n.Pa.push(e);const t=na(n);t.x_()&&t.Z_&&t.X_(e.mutations)}function zw(n){return Ua(n)&&!na(n).M_()&&n.Pa.length>0}function Bw(n){na(n).start()}async function eN(n){na(n).na()}async function tN(n){const e=na(n);for(const t of n.Pa)e.X_(t.mutations)}async function nN(n,e,t){const s=n.Pa.shift(),a=Rp.from(s,e,t);await Uw(n,(()=>n.remoteSyncer.applySuccessfulWrite(a))),await xd(n)}async function rN(n,e){e&&na(n).Z_&&await(async function(s,a){if((function(d){return FI(d)&&d!==pe.ABORTED})(a.code)){const l=s.Pa.shift();na(s).N_(),await Uw(s,(()=>s.remoteSyncer.rejectFailedWrite(l.batchId,a))),await xd(s)}})(n,e),zw(n)&&Bw(n)}async function Hv(n,e){const t=ct(n);t.asyncQueue.verifyOperationInProgress(),Be(Oa,"RemoteStore received new credentials");const s=Ua(t);t.Ia.add(3),await uc(t),s&&t.Aa.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ia.delete(3),await wd(t)}async function sN(n,e){const t=ct(n);e?(t.Ia.delete(2),await wd(t)):e||(t.Ia.add(2),await uc(t),t.Aa.set("Unknown"))}function Yo(n){return n.Va||(n.Va=(function(t,s,a){const l=ct(t);return l.ia(),new BP(s,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(n.datastore,n.asyncQueue,{Zo:KP.bind(null,n),e_:QP.bind(null,n),n_:YP.bind(null,n),J_:JP.bind(null,n)}),n.da.push((async e=>{e?(n.Va.N_(),Up(n)?Fp(n):n.Aa.set("Unknown")):(await n.Va.stop(),Fw(n))}))),n.Va}function na(n){return n.ma||(n.ma=(function(t,s,a){const l=ct(t);return l.ia(),new $P(s,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),e_:eN.bind(null,n),n_:rN.bind(null,n),ea:tN.bind(null,n),ta:nN.bind(null,n)}),n.da.push((async e=>{e?(n.ma.N_(),await xd(n)):(await n.ma.stop(),n.Pa.length>0&&(Be(Oa,`Stopping write stream with ${n.Pa.length} pending writes`),n.Pa=[]))}))),n.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zp{constructor(e,t,s,a,l){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=s,this.op=a,this.removalCallback=l,this.deferred=new di,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((d=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,s,a,l){const d=Date.now()+s,f=new zp(e,t,d,a,l);return f.start(s),f}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ue(pe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Bp(n,e){if(mi("AsyncQueue",`${e}: ${n}`),Ko(n))return new Ue(pe.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ro{static emptySet(e){return new Ro(e.comparator)}constructor(e){this.comparator=e?(t,s)=>e(t,s)||Xe.comparator(t.key,s.key):(t,s)=>Xe.comparator(t.key,s.key),this.keyedMap=jl(),this.sortedSet=new Kt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,s)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Ro)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=s.getNext().key;if(!a.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const s=new Ro;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=t,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kv{constructor(){this.fa=new Kt(Xe.comparator)}track(e){const t=e.doc.key,s=this.fa.get(t);s?e.type!==0&&s.type===3?this.fa=this.fa.insert(t,e):e.type===3&&s.type!==1?this.fa=this.fa.insert(t,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.fa=this.fa.insert(t,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.fa=this.fa.remove(t):e.type===1&&s.type===2?this.fa=this.fa.insert(t,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):it(63341,{At:e,ga:s}):this.fa=this.fa.insert(t,e)}pa(){const e=[];return this.fa.inorderTraversal(((t,s)=>{e.push(s)})),e}}class Oo{constructor(e,t,s,a,l,d,f,m,v){this.query=e,this.docs=t,this.oldDocs=s,this.docChanges=a,this.mutatedKeys=l,this.fromCache=d,this.syncStateChanged=f,this.excludesMetadataChanges=m,this.hasCachedResults=v}static fromInitialDocuments(e,t,s,a,l){const d=[];return t.forEach((f=>{d.push({type:0,doc:f})})),new Oo(e,t,Ro.emptySet(t),d,s,a,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&pd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,s=e.docChanges;if(t.length!==s.length)return!1;for(let a=0;a<t.length;a++)if(t[a].type!==s[a].type||!t[a].doc.isEqual(s[a].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iN{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some((e=>e.ba()))}}class aN{constructor(){this.queries=Qv(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(t,s){const a=ct(t),l=a.queries;a.queries=Qv(),l.forEach(((d,f)=>{for(const m of f.wa)m.onError(s)}))})(this,new Ue(pe.ABORTED,"Firestore shutting down"))}}function Qv(){return new Fa((n=>cw(n)),pd)}async function $p(n,e){const t=ct(n);let s=3;const a=e.query;let l=t.queries.get(a);l?!l.Sa()&&e.ba()&&(s=2):(l=new iN,s=e.ba()?0:1);try{switch(s){case 0:l.ya=await t.onListen(a,!0);break;case 1:l.ya=await t.onListen(a,!1);break;case 2:await t.onFirstRemoteStoreListen(a)}}catch(d){const f=Bp(d,`Initialization of query '${So(e.query)}' failed`);return void e.onError(f)}t.queries.set(a,l),l.wa.push(e),e.va(t.onlineState),l.ya&&e.Ca(l.ya)&&Gp(t)}async function Wp(n,e){const t=ct(n),s=e.query;let a=3;const l=t.queries.get(s);if(l){const d=l.wa.indexOf(e);d>=0&&(l.wa.splice(d,1),l.wa.length===0?a=e.ba()?0:1:!l.Sa()&&e.ba()&&(a=2))}switch(a){case 0:return t.queries.delete(s),t.onUnlisten(s,!0);case 1:return t.queries.delete(s),t.onUnlisten(s,!1);case 2:return t.onLastRemoteStoreUnlisten(s);default:return}}function oN(n,e){const t=ct(n);let s=!1;for(const a of e){const l=a.query,d=t.queries.get(l);if(d){for(const f of d.wa)f.Ca(a)&&(s=!0);d.ya=a}}s&&Gp(t)}function lN(n,e,t){const s=ct(n),a=s.queries.get(e);if(a)for(const l of a.wa)l.onError(t);s.queries.delete(e)}function Gp(n){n.Da.forEach((e=>{e.next()}))}var Hf,Yv;(Yv=Hf||(Hf={})).Fa="default",Yv.Cache="cache";class qp{constructor(e,t,s){this.query=e,this.Ma=t,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=s||{}}Ca(e){if(!this.options.includeMetadataChanges){const s=[];for(const a of e.docChanges)a.type!==3&&s.push(a);e=new Oo(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),t=!0):this.Ba(e,this.onlineState)&&(this.La(e),t=!0),this.Oa=e,t}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let t=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),t=!0),t}Ba(e,t){if(!e.fromCache||!this.ba())return!0;const s=t!=="Offline";return(!this.options.ka||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Na(e){if(e.docChanges.length>0)return!0;const t=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}La(e){e=Oo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==Hf.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $w{constructor(e){this.key=e}}class Ww{constructor(e){this.key=e}}class cN{constructor(e,t){this.query=e,this.Ha=t,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=_t(),this.mutatedKeys=_t(),this.Xa=uw(e),this.eu=new Ro(this.Xa)}get tu(){return this.Ha}nu(e,t){const s=t?t.ru:new Kv,a=t?t.eu:this.eu;let l=t?t.mutatedKeys:this.mutatedKeys,d=a,f=!1;const m=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,v=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal(((w,T)=>{const I=a.get(w),U=md(this.query,T)?T:null,X=!!I&&this.mutatedKeys.has(I.key),$=!!U&&(U.hasLocalMutations||this.mutatedKeys.has(U.key)&&U.hasCommittedMutations);let O=!1;I&&U?I.data.isEqual(U.data)?X!==$&&(s.track({type:3,doc:U}),O=!0):this.iu(I,U)||(s.track({type:2,doc:U}),O=!0,(m&&this.Xa(U,m)>0||v&&this.Xa(U,v)<0)&&(f=!0)):!I&&U?(s.track({type:0,doc:U}),O=!0):I&&!U&&(s.track({type:1,doc:I}),O=!0,(m||v)&&(f=!0)),O&&(U?(d=d.add(U),l=$?l.add(w):l.delete(w)):(d=d.delete(w),l=l.delete(w)))})),this.query.limit!==null)for(;d.size>this.query.limit;){const w=this.query.limitType==="F"?d.last():d.first();d=d.delete(w.key),l=l.delete(w.key),s.track({type:1,doc:w})}return{eu:d,ru:s,Ds:f,mutatedKeys:l}}iu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,s,a){const l=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const d=e.ru.pa();d.sort(((w,T)=>(function(U,X){const $=O=>{switch(O){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return it(20277,{At:O})}};return $(U)-$(X)})(w.type,T.type)||this.Xa(w.doc,T.doc))),this.su(s),a=a!=null&&a;const f=t&&!a?this.ou():[],m=this.Za.size===0&&this.current&&!a?1:0,v=m!==this.Ya;return this.Ya=m,d.length!==0||v?{snapshot:new Oo(this.query,e.eu,l,d,e.mutatedKeys,m===0,v,!1,!!s&&s.resumeToken.approximateByteSize()>0),_u:f}:{_u:f}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new Kv,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach((t=>this.Ha=this.Ha.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ha=this.Ha.delete(t))),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=_t(),this.eu.forEach((s=>{this.au(s.key)&&(this.Za=this.Za.add(s.key))}));const t=[];return e.forEach((s=>{this.Za.has(s)||t.push(new Ww(s))})),this.Za.forEach((s=>{e.has(s)||t.push(new $w(s))})),t}uu(e){this.Ha=e.qs,this.Za=_t();const t=this.nu(e.documents);return this.applyChanges(t,!0)}cu(){return Oo.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const Hp="SyncEngine";class uN{constructor(e,t,s){this.query=e,this.targetId=t,this.view=s}}class dN{constructor(e){this.key=e,this.lu=!1}}class hN{constructor(e,t,s,a,l,d){this.localStore=e,this.remoteStore=t,this.eventManager=s,this.sharedClientState=a,this.currentUser=l,this.maxConcurrentLimboResolutions=d,this.hu={},this.Pu=new Fa((f=>cw(f)),pd),this.Tu=new Map,this.Iu=new Set,this.du=new Kt(Xe.comparator),this.Eu=new Map,this.Au=new kp,this.Ru={},this.Vu=new Map,this.mu=Mo.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function fN(n,e,t=!0){const s=Yw(n);let a;const l=s.Pu.get(e);return l?(s.sharedClientState.addLocalQueryTarget(l.targetId),a=l.view.cu()):a=await Gw(s,e,t,!0),a}async function pN(n,e){const t=Yw(n);await Gw(t,e,!0,!1)}async function Gw(n,e,t,s){const a=await DP(n.localStore,Os(e)),l=a.targetId,d=n.sharedClientState.addLocalQueryTarget(l,t);let f;return s&&(f=await mN(n,e,l,d==="current",a.resumeToken)),n.isPrimaryClient&&t&&Mw(n.remoteStore,a),f}async function mN(n,e,t,s,a){n.gu=(T,I,U)=>(async function($,O,se,Te){let xe=O.view.nu(se);xe.Ds&&(xe=await Bv($.localStore,O.query,!1).then((({documents:C})=>O.view.nu(C,xe))));const _e=Te&&Te.targetChanges.get(O.targetId),V=Te&&Te.targetMismatches.get(O.targetId)!=null,ie=O.view.applyChanges(xe,$.isPrimaryClient,_e,V);return Xv($,O.targetId,ie._u),ie.snapshot})(n,T,I,U);const l=await Bv(n.localStore,e,!0),d=new cN(e,l.qs),f=d.nu(l.documents),m=cc.createSynthesizedTargetChangeForCurrentChange(t,s&&n.onlineState!=="Offline",a),v=d.applyChanges(f,n.isPrimaryClient,m);Xv(n,t,v._u);const w=new uN(e,t,d);return n.Pu.set(e,w),n.Tu.has(t)?n.Tu.get(t).push(e):n.Tu.set(t,[e]),v.snapshot}async function gN(n,e,t){const s=ct(n),a=s.Pu.get(e),l=s.Tu.get(a.targetId);if(l.length>1)return s.Tu.set(a.targetId,l.filter((d=>!pd(d,e)))),void s.Pu.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(a.targetId),s.sharedClientState.isActiveQueryTarget(a.targetId)||await Gf(s.localStore,a.targetId,!1).then((()=>{s.sharedClientState.clearQueryState(a.targetId),t&&Mp(s.remoteStore,a.targetId),Kf(s,a.targetId)})).catch(Ho)):(Kf(s,a.targetId),await Gf(s.localStore,a.targetId,!0))}async function yN(n,e){const t=ct(n),s=t.Pu.get(e),a=t.Tu.get(s.targetId);t.isPrimaryClient&&a.length===1&&(t.sharedClientState.removeLocalQueryTarget(s.targetId),Mp(t.remoteStore,s.targetId))}async function vN(n,e,t){const s=bN(n);try{const a=await(function(d,f){const m=ct(d),v=Bt.now(),w=f.reduce(((U,X)=>U.add(X.key)),_t());let T,I;return m.persistence.runTransaction("Locally write mutations","readwrite",(U=>{let X=gi(),$=_t();return m.Os.getEntries(U,w).next((O=>{X=O,X.forEach(((se,Te)=>{Te.isValidDocument()||($=$.add(se))}))})).next((()=>m.localDocuments.getOverlayedDocuments(U,X))).next((O=>{T=O;const se=[];for(const Te of f){const xe=DI(Te,T.get(Te.key).overlayedDocument);xe!=null&&se.push(new ca(Te.key,xe,tw(xe.value.mapValue),Xr.exists(!0)))}return m.mutationQueue.addMutationBatch(U,v,se,f)})).next((O=>{I=O;const se=O.applyToLocalDocumentSet(T,$);return m.documentOverlayCache.saveOverlays(U,O.batchId,se)}))})).then((()=>({batchId:I.batchId,changes:hw(T)})))})(s.localStore,e);s.sharedClientState.addPendingMutation(a.batchId),(function(d,f,m){let v=d.Ru[d.currentUser.toKey()];v||(v=new Kt(ft)),v=v.insert(f,m),d.Ru[d.currentUser.toKey()]=v})(s,a.batchId,t),await dc(s,a.changes),await xd(s.remoteStore)}catch(a){const l=Bp(a,"Failed to persist write");t.reject(l)}}async function qw(n,e){const t=ct(n);try{const s=await AP(t.localStore,e);e.targetChanges.forEach(((a,l)=>{const d=t.Eu.get(l);d&&(At(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?d.lu=!0:a.modifiedDocuments.size>0?At(d.lu,14607):a.removedDocuments.size>0&&(At(d.lu,42227),d.lu=!1))})),await dc(t,s,e)}catch(s){await Ho(s)}}function Jv(n,e,t){const s=ct(n);if(s.isPrimaryClient&&t===0||!s.isPrimaryClient&&t===1){const a=[];s.Pu.forEach(((l,d)=>{const f=d.view.va(e);f.snapshot&&a.push(f.snapshot)})),(function(d,f){const m=ct(d);m.onlineState=f;let v=!1;m.queries.forEach(((w,T)=>{for(const I of T.wa)I.va(f)&&(v=!0)})),v&&Gp(m)})(s.eventManager,e),a.length&&s.hu.J_(a),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function _N(n,e,t){const s=ct(n);s.sharedClientState.updateQueryState(e,"rejected",t);const a=s.Eu.get(e),l=a&&a.key;if(l){let d=new Kt(Xe.comparator);d=d.insert(l,ar.newNoDocument(l,lt.min()));const f=_t().add(l),m=new vd(lt.min(),new Map,new Kt(ft),d,f);await qw(s,m),s.du=s.du.remove(l),s.Eu.delete(e),Kp(s)}else await Gf(s.localStore,e,!1).then((()=>Kf(s,e,t))).catch(Ho)}async function wN(n,e){const t=ct(n),s=e.batch.batchId;try{const a=await RP(t.localStore,e);Kw(t,s,null),Hw(t,s),t.sharedClientState.updateMutationState(s,"acknowledged"),await dc(t,a)}catch(a){await Ho(a)}}async function xN(n,e,t){const s=ct(n);try{const a=await(function(d,f){const m=ct(d);return m.persistence.runTransaction("Reject batch","readwrite-primary",(v=>{let w;return m.mutationQueue.lookupMutationBatch(v,f).next((T=>(At(T!==null,37113),w=T.keys(),m.mutationQueue.removeMutationBatch(v,T)))).next((()=>m.mutationQueue.performConsistencyCheck(v))).next((()=>m.documentOverlayCache.removeOverlaysForBatchId(v,w,f))).next((()=>m.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(v,w))).next((()=>m.localDocuments.getDocuments(v,w)))}))})(s.localStore,e);Kw(s,e,t),Hw(s,e),s.sharedClientState.updateMutationState(e,"rejected",t),await dc(s,a)}catch(a){await Ho(a)}}function Hw(n,e){(n.Vu.get(e)||[]).forEach((t=>{t.resolve()})),n.Vu.delete(e)}function Kw(n,e,t){const s=ct(n);let a=s.Ru[s.currentUser.toKey()];if(a){const l=a.get(e);l&&(t?l.reject(t):l.resolve(),a=a.remove(e)),s.Ru[s.currentUser.toKey()]=a}}function Kf(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const s of n.Tu.get(e))n.Pu.delete(s),t&&n.hu.pu(s,t);n.Tu.delete(e),n.isPrimaryClient&&n.Au.zr(e).forEach((s=>{n.Au.containsKey(s)||Qw(n,s)}))}function Qw(n,e){n.Iu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(Mp(n.remoteStore,t),n.du=n.du.remove(e),n.Eu.delete(t),Kp(n))}function Xv(n,e,t){for(const s of t)s instanceof $w?(n.Au.addReference(s.key,e),EN(n,s)):s instanceof Ww?(Be(Hp,"Document no longer in limbo: "+s.key),n.Au.removeReference(s.key,e),n.Au.containsKey(s.key)||Qw(n,s.key)):it(19791,{yu:s})}function EN(n,e){const t=e.key,s=t.path.canonicalString();n.du.get(t)||n.Iu.has(s)||(Be(Hp,"New document in limbo: "+t),n.Iu.add(s),Kp(n))}function Kp(n){for(;n.Iu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Iu.values().next().value;n.Iu.delete(e);const t=new Xe(Mt.fromString(e)),s=n.mu.next();n.Eu.set(s,new dN(t)),n.du=n.du.insert(t,s),Mw(n.remoteStore,new Wi(Os(fd(t.path)),s,"TargetPurposeLimboResolution",ud.ue))}}async function dc(n,e,t){const s=ct(n),a=[],l=[],d=[];s.Pu.isEmpty()||(s.Pu.forEach(((f,m)=>{d.push(s.gu(m,e,t).then((v=>{var w;if((v||t)&&s.isPrimaryClient){const T=v?!v.fromCache:(w=t==null?void 0:t.targetChanges.get(m.targetId))===null||w===void 0?void 0:w.current;s.sharedClientState.updateQueryState(m.targetId,T?"current":"not-current")}if(v){a.push(v);const T=Lp.Es(m.targetId,v);l.push(T)}})))})),await Promise.all(d),s.hu.J_(a),await(async function(m,v){const w=ct(m);try{await w.persistence.runTransaction("notifyLocalViewChanges","readwrite",(T=>ge.forEach(v,(I=>ge.forEach(I.Is,(U=>w.persistence.referenceDelegate.addReference(T,I.targetId,U))).next((()=>ge.forEach(I.ds,(U=>w.persistence.referenceDelegate.removeReference(T,I.targetId,U)))))))))}catch(T){if(!Ko(T))throw T;Be(Vp,"Failed to update sequence numbers: "+T)}for(const T of v){const I=T.targetId;if(!T.fromCache){const U=w.Fs.get(I),X=U.snapshotVersion,$=U.withLastLimboFreeSnapshotVersion(X);w.Fs=w.Fs.insert(I,$)}}})(s.localStore,l))}async function TN(n,e){const t=ct(n);if(!t.currentUser.isEqual(e)){Be(Hp,"User change. New user:",e.toKey());const s=await kw(t.localStore,e);t.currentUser=e,(function(l,d){l.Vu.forEach((f=>{f.forEach((m=>{m.reject(new Ue(pe.CANCELLED,d))}))})),l.Vu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await dc(t,s.Bs)}}function SN(n,e){const t=ct(n),s=t.Eu.get(e);if(s&&s.lu)return _t().add(s.key);{let a=_t();const l=t.Tu.get(e);if(!l)return a;for(const d of l){const f=t.Pu.get(d);a=a.unionWith(f.view.tu)}return a}}function Yw(n){const e=ct(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=qw.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=SN.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=_N.bind(null,e),e.hu.J_=oN.bind(null,e.eventManager),e.hu.pu=lN.bind(null,e.eventManager),e}function bN(n){const e=ct(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=wN.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=xN.bind(null,e),e}class ed{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=_d(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,t){return null}Fu(e,t){return null}vu(e){return NP(this.persistence,new CP,e.initialUser,this.serializer)}Du(e){return new jw(Dp.Vi,this.serializer)}bu(e){return new VP}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}ed.provider={build:()=>new ed};class CN extends ed{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,t){At(this.persistence.referenceDelegate instanceof Xu,46915);const s=this.persistence.referenceDelegate.garbageCollector;return new dP(s,e.asyncQueue,t)}Du(e){const t=this.cacheSizeBytes!==void 0?Sr.withCacheSize(this.cacheSizeBytes):Sr.DEFAULT;return new jw((s=>Xu.Vi(s,t)),this.serializer)}}class Qf{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>Jv(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=TN.bind(null,this.syncEngine),await sN(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new aN})()}createDatastore(e){const t=_d(e.databaseInfo.databaseId),s=(function(l){return new zP(l)})(e.databaseInfo);return(function(l,d,f,m){return new GP(l,d,f,m)})(e.authCredentials,e.appCheckCredentials,s,t)}createRemoteStore(e){return(function(s,a,l,d,f){return new HP(s,a,l,d,f)})(this.localStore,this.datastore,e.asyncQueue,(t=>Jv(this.syncEngine,t,0)),(function(){return Gv.C()?new Gv:new MP})())}createSyncEngine(e,t){return(function(a,l,d,f,m,v,w){const T=new hN(a,l,d,f,m,v);return w&&(T.fu=!0),T})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(a){const l=ct(a);Be(Oa,"RemoteStore shutting down."),l.Ia.add(5),await uc(l),l.Ea.shutdown(),l.Aa.set("Unknown")})(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}Qf.provider={build:()=>new Qf};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qp{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):mi("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ra="FirestoreClient";class IN{constructor(e,t,s,a,l){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=s,this.databaseInfo=a,this.user=ir.UNAUTHENTICATED,this.clientId=Ep.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(s,(async d=>{Be(ra,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d})),this.appCheckCredentials.start(s,(d=>(Be(ra,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new di;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const s=Bp(t,"Failed to shutdown persistence");e.reject(s)}})),e.promise}}async function gf(n,e){n.asyncQueue.verifyOperationInProgress(),Be(ra,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let s=t.initialUser;n.setCredentialChangeListener((async a=>{s.isEqual(a)||(await kw(e.localStore,a),s=a)})),e.persistence.setDatabaseDeletedListener((()=>{Ji("Terminating Firestore due to IndexedDb database deletion"),n.terminate().then((()=>{Be("Terminating Firestore due to IndexedDb database deletion completed successfully")})).catch((a=>{Ji("Terminating Firestore due to IndexedDb database deletion failed",a)}))})),n._offlineComponents=e}async function Zv(n,e){n.asyncQueue.verifyOperationInProgress();const t=await PN(n);Be(ra,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((s=>Hv(e.remoteStore,s))),n.setAppCheckTokenChangeListener(((s,a)=>Hv(e.remoteStore,a))),n._onlineComponents=e}async function PN(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Be(ra,"Using user provided OfflineComponentProvider");try{await gf(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(a){return a.name==="FirebaseError"?a.code===pe.FAILED_PRECONDITION||a.code===pe.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11})(t))throw t;Ji("Error using user provided cache. Falling back to memory cache: "+t),await gf(n,new ed)}}else Be(ra,"Using default OfflineComponentProvider"),await gf(n,new CN(void 0));return n._offlineComponents}async function Jw(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Be(ra,"Using user provided OnlineComponentProvider"),await Zv(n,n._uninitializedComponentsProvider._online)):(Be(ra,"Using default OnlineComponentProvider"),await Zv(n,new Qf))),n._onlineComponents}function NN(n){return Jw(n).then((e=>e.syncEngine))}async function td(n){const e=await Jw(n),t=e.eventManager;return t.onListen=fN.bind(null,e.syncEngine),t.onUnlisten=gN.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=pN.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=yN.bind(null,e.syncEngine),t}function RN(n,e,t={}){const s=new di;return n.asyncQueue.enqueueAndForget((async()=>(function(l,d,f,m,v){const w=new Qp({next:I=>{w.Ou(),d.enqueueAndForget((()=>Wp(l,T)));const U=I.docs.has(f);!U&&I.fromCache?v.reject(new Ue(pe.UNAVAILABLE,"Failed to get document because the client is offline.")):U&&I.fromCache&&m&&m.source==="server"?v.reject(new Ue(pe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):v.resolve(I)},error:I=>v.reject(I)}),T=new qp(fd(f.path),w,{includeMetadataChanges:!0,ka:!0});return $p(l,T)})(await td(n),n.asyncQueue,e,t,s))),s.promise}function AN(n,e,t={}){const s=new di;return n.asyncQueue.enqueueAndForget((async()=>(function(l,d,f,m,v){const w=new Qp({next:I=>{w.Ou(),d.enqueueAndForget((()=>Wp(l,T))),I.fromCache&&m.source==="server"?v.reject(new Ue(pe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):v.resolve(I)},error:I=>v.reject(I)}),T=new qp(f,w,{includeMetadataChanges:!0,ka:!0});return $p(l,T)})(await td(n),n.asyncQueue,e,t,s))),s.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xw(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e_=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zw="firestore.googleapis.com",t_=!0;class n_{constructor(e){var t,s;if(e.host===void 0){if(e.ssl!==void 0)throw new Ue(pe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Zw,this.ssl=t_}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:t_;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Aw;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<cP)throw new Ue(pe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}HC("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Xw((s=e.experimentalLongPollingOptions)!==null&&s!==void 0?s:{}),(function(l){if(l.timeoutSeconds!==void 0){if(isNaN(l.timeoutSeconds))throw new Ue(pe.INVALID_ARGUMENT,`invalid long polling timeout: ${l.timeoutSeconds} (must not be NaN)`);if(l.timeoutSeconds<5)throw new Ue(pe.INVALID_ARGUMENT,`invalid long polling timeout: ${l.timeoutSeconds} (minimum allowed value is 5)`);if(l.timeoutSeconds>30)throw new Ue(pe.INVALID_ARGUMENT,`invalid long polling timeout: ${l.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(s,a){return s.timeoutSeconds===a.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ed{constructor(e,t,s,a){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=s,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new n_({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ue(pe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ue(pe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new n_(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(s){if(!s)return new OC;switch(s.type){case"firstParty":return new BC(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new Ue(pe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const s=e_.get(t);s&&(Be("ComponentProvider","Removing Datastore"),e_.delete(t),s.terminate())})(this),Promise.resolve()}}function jN(n,e,t,s={}){var a;n=Cr(n,Ed);const l=Bo(e),d=n._getSettings(),f=Object.assign(Object.assign({},d),{emulatorOptions:n._getEmulatorOptions()}),m=`${e}:${t}`;l&&(W_(`https://${m}`),G_("Firestore",!0)),d.host!==Zw&&d.host!==m&&Ji("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const v=Object.assign(Object.assign({},d),{host:m,ssl:l,emulatorOptions:s});if(!Da(v,f)&&(n._setSettings(v),s.mockUserToken)){let w,T;if(typeof s.mockUserToken=="string")w=s.mockUserToken,T=ir.MOCK_USER;else{w=qT(s.mockUserToken,(a=n._app)===null||a===void 0?void 0:a.options.projectId);const I=s.mockUserToken.sub||s.mockUserToken.user_id;if(!I)throw new Ue(pe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");T=new ir(I)}n._authCredentials=new FC(new B0(w,T))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wi{constructor(e,t,s){this.converter=t,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new wi(this.firestore,e,this._query)}}class Zt{constructor(e,t,s){this.converter=t,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Yi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Zt(this.firestore,e,this._key)}toJSON(){return{type:Zt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,s){if(oc(t,Zt._jsonSchema))return new Zt(e,s||null,new Xe(Mt.fromString(t.referencePath)))}}Zt._jsonSchemaVersion="firestore/documentReference/1.0",Zt._jsonSchema={type:mn("string",Zt._jsonSchemaVersion),referencePath:mn("string")};class Yi extends wi{constructor(e,t,s){super(e,t,fd(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Zt(this.firestore,null,new Xe(e))}withConverter(e){return new Yi(this.firestore,e,this._path)}}function Sn(n,e,...t){if(n=en(n),W0("collection","path",e),n instanceof Ed){const s=Mt.fromString(e,...t);return mv(s),new Yi(n,null,s)}{if(!(n instanceof Zt||n instanceof Yi))throw new Ue(pe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(Mt.fromString(e,...t));return mv(s),new Yi(n.firestore,null,s)}}function Dt(n,e,...t){if(n=en(n),arguments.length===1&&(e=Ep.newId()),W0("doc","path",e),n instanceof Ed){const s=Mt.fromString(e,...t);return pv(s),new Zt(n,null,new Xe(s))}{if(!(n instanceof Zt||n instanceof Yi))throw new Ue(pe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(Mt.fromString(e,...t));return pv(s),new Zt(n.firestore,n instanceof Yi?n.converter:null,new Xe(s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r_="AsyncQueue";class s_{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new Lw(this,"async_queue_retry"),this.oc=()=>{const s=mf();s&&Be(r_,"Visibility state changed to "+s.visibilityState),this.F_.y_()},this._c=e;const t=mf();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const t=mf();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise((()=>{}));const t=new di;return this.uc((()=>this.Xu&&this.rc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Zu.push(e),this.cc())))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!Ko(e))throw e;Be(r_,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_((()=>this.cc()))}}uc(e){const t=this._c.then((()=>(this.nc=!0,e().catch((s=>{throw this.tc=s,this.nc=!1,mi("INTERNAL UNHANDLED ERROR: ",i_(s)),s})).then((s=>(this.nc=!1,s))))));return this._c=t,t}enqueueAfterDelay(e,t,s){this.ac(),this.sc.indexOf(e)>-1&&(t=0);const a=zp.createAndSchedule(this,e,t,s,(l=>this.lc(l)));return this.ec.push(a),a}ac(){this.tc&&it(47125,{hc:i_(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(const t of this.ec)if(t.timerId===e)return!0;return!1}Ic(e){return this.Pc().then((()=>{this.ec.sort(((t,s)=>t.targetTimeMs-s.targetTimeMs));for(const t of this.ec)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Pc()}))}dc(e){this.sc.push(e)}lc(e){const t=this.ec.indexOf(e);this.ec.splice(t,1)}}function i_(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a_(n){return(function(t,s){if(typeof t!="object"||t===null)return!1;const a=t;for(const l of s)if(l in a&&typeof a[l]=="function")return!0;return!1})(n,["next","error","complete"])}class yi extends Ed{constructor(e,t,s,a){super(e,t,s,a),this.type="firestore",this._queue=new s_,this._persistenceKey=(a==null?void 0:a.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new s_(e),this._firestoreClient=void 0,await e}}}function kN(n,e){const t=typeof n=="object"?n:Q_(),s=typeof n=="string"?n:qu,a=cp(t,"firestore").getImmediate({identifier:s});if(!a._initialized){const l=WT("firestore");l&&jN(a,...l)}return a}function Td(n){if(n._terminated)throw new Ue(pe.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||DN(n),n._firestoreClient}function DN(n){var e,t,s;const a=n._freezeSettings(),l=(function(f,m,v,w){return new sI(f,m,v,w.host,w.ssl,w.experimentalForceLongPolling,w.experimentalAutoDetectLongPolling,Xw(w.experimentalLongPollingOptions),w.useFetchStreams,w.isUsingEmulator)})(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,a);n._componentsProvider||!((t=a.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((s=a.localCache)===null||s===void 0)&&s._onlineComponentProvider)&&(n._componentsProvider={_offline:a.localCache._offlineComponentProvider,_online:a.localCache._onlineComponentProvider}),n._firestoreClient=new IN(n._authCredentials,n._appCheckCredentials,n._queue,l,n._componentsProvider&&(function(f){const m=f==null?void 0:f._online.build();return{_offline:f==null?void 0:f._offline.build(m),_online:m}})(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Yr(Hn.fromBase64String(e))}catch(t){throw new Ue(pe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Yr(Hn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Yr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(oc(e,Yr._jsonSchema))return Yr.fromBase64String(e.bytes)}}Yr._jsonSchemaVersion="firestore/bytes/1.0",Yr._jsonSchema={type:mn("string",Yr._jsonSchemaVersion),bytes:mn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sd{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ue(pe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new qn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bd{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Us{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ue(pe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ue(pe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return ft(this._lat,e._lat)||ft(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Us._jsonSchemaVersion}}static fromJSON(e){if(oc(e,Us._jsonSchema))return new Us(e.latitude,e.longitude)}}Us._jsonSchemaVersion="firestore/geoPoint/1.0",Us._jsonSchema={type:mn("string",Us._jsonSchemaVersion),latitude:mn("number"),longitude:mn("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zs{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(s,a){if(s.length!==a.length)return!1;for(let l=0;l<s.length;++l)if(s[l]!==a[l])return!1;return!0})(this._values,e._values)}toJSON(){return{type:zs._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(oc(e,zs._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new zs(e.vectorValues);throw new Ue(pe.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}zs._jsonSchemaVersion="firestore/vectorValue/1.0",zs._jsonSchema={type:mn("string",zs._jsonSchemaVersion),vectorValues:mn("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LN=/^__.*__$/;class VN{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return this.fieldMask!==null?new ca(e,this.data,this.fieldMask,t,this.fieldTransforms):new lc(e,this.data,t,this.fieldTransforms)}}class ex{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return new ca(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function tx(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw it(40011,{Ec:n})}}class Yp{constructor(e,t,s,a,l,d){this.settings=e,this.databaseId=t,this.serializer=s,this.ignoreUndefinedProperties=a,l===void 0&&this.Ac(),this.fieldTransforms=l||[],this.fieldMask=d||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new Yp(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var t;const s=(t=this.path)===null||t===void 0?void 0:t.child(e),a=this.Rc({path:s,mc:!1});return a.fc(e),a}gc(e){var t;const s=(t=this.path)===null||t===void 0?void 0:t.child(e),a=this.Rc({path:s,mc:!1});return a.Ac(),a}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return nd(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(tx(this.Ec)&&LN.test(e))throw this.wc('Document fields cannot begin and end with "__"')}}class MN{constructor(e,t,s){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=s||_d(e)}Dc(e,t,s,a=!1){return new Yp({Ec:e,methodName:t,bc:s,path:qn.emptyPath(),mc:!1,Sc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Cd(n){const e=n._freezeSettings(),t=_d(n._databaseId);return new MN(n._databaseId,!!e.ignoreUndefinedProperties,t)}function nx(n,e,t,s,a,l={}){const d=n.Dc(l.merge||l.mergeFields?2:0,e,t,a);Xp("Data must be an object, but it was:",d,s);const f=rx(s,d);let m,v;if(l.merge)m=new Or(d.fieldMask),v=d.fieldTransforms;else if(l.mergeFields){const w=[];for(const T of l.mergeFields){const I=Yf(e,T,t);if(!d.contains(I))throw new Ue(pe.INVALID_ARGUMENT,`Field '${I}' is specified in your field mask but missing from your input data.`);ix(w,I)||w.push(I)}m=new Or(w),v=d.fieldTransforms.filter((T=>m.covers(T.field)))}else m=null,v=d.fieldTransforms;return new VN(new br(f),m,v)}class hc extends bd{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof hc}}class Jp extends bd{_toFieldTransform(e){return new RI(e.path,new Xl)}isEqual(e){return e instanceof Jp}}function ON(n,e,t,s){const a=n.Dc(1,e,t);Xp("Data must be an object, but it was:",a,s);const l=[],d=br.empty();la(s,((m,v)=>{const w=Zp(e,m,t);v=en(v);const T=a.gc(w);if(v instanceof hc)l.push(w);else{const I=fc(v,T);I!=null&&(l.push(w),d.set(w,I))}}));const f=new Or(l);return new ex(d,f,a.fieldTransforms)}function FN(n,e,t,s,a,l){const d=n.Dc(1,e,t),f=[Yf(e,s,t)],m=[a];if(l.length%2!=0)throw new Ue(pe.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let I=0;I<l.length;I+=2)f.push(Yf(e,l[I])),m.push(l[I+1]);const v=[],w=br.empty();for(let I=f.length-1;I>=0;--I)if(!ix(v,f[I])){const U=f[I];let X=m[I];X=en(X);const $=d.gc(U);if(X instanceof hc)v.push(U);else{const O=fc(X,$);O!=null&&(v.push(U),w.set(U,O))}}const T=new Or(v);return new ex(w,T,d.fieldTransforms)}function UN(n,e,t,s=!1){return fc(t,n.Dc(s?4:3,e))}function fc(n,e){if(sx(n=en(n)))return Xp("Unsupported field value:",e,n),rx(n,e);if(n instanceof bd)return(function(s,a){if(!tx(a.Ec))throw a.wc(`${s._methodName}() can only be used with update() and set()`);if(!a.path)throw a.wc(`${s._methodName}() is not currently supported inside arrays`);const l=s._toFieldTransform(a);l&&a.fieldTransforms.push(l)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return(function(s,a){const l=[];let d=0;for(const f of s){let m=fc(f,a.yc(d));m==null&&(m={nullValue:"NULL_VALUE"}),l.push(m),d++}return{arrayValue:{values:l}}})(n,e)}return(function(s,a){if((s=en(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return II(a.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const l=Bt.fromDate(s);return{timestampValue:Ju(a.serializer,l)}}if(s instanceof Bt){const l=new Bt(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:Ju(a.serializer,l)}}if(s instanceof Us)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof Yr)return{bytesValue:Sw(a.serializer,s._byteString)};if(s instanceof Zt){const l=a.databaseId,d=s.firestore._databaseId;if(!d.isEqual(l))throw a.wc(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:jp(s.firestore._databaseId||a.databaseId,s._key.path)}}if(s instanceof zs)return(function(d,f){return{mapValue:{fields:{[Z0]:{stringValue:ew},[Hu]:{arrayValue:{values:d.toArray().map((v=>{if(typeof v!="number")throw f.wc("VectorValues must only contain numeric values.");return Pp(f.serializer,v)}))}}}}}})(s,a);throw a.wc(`Unsupported field value: ${cd(s)}`)})(n,e)}function rx(n,e){const t={};return H0(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):la(n,((s,a)=>{const l=fc(a,e.Vc(s));l!=null&&(t[s]=l)})),{mapValue:{fields:t}}}function sx(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Bt||n instanceof Us||n instanceof Yr||n instanceof Zt||n instanceof bd||n instanceof zs)}function Xp(n,e,t){if(!sx(t)||!G0(t)){const s=cd(t);throw s==="an object"?e.wc(n+" a custom object"):e.wc(n+" "+s)}}function Yf(n,e,t){if((e=en(e))instanceof Sd)return e._internalPath;if(typeof e=="string")return Zp(n,e);throw nd("Field path arguments must be of type string or ",n,!1,void 0,t)}const zN=new RegExp("[~\\*/\\[\\]]");function Zp(n,e,t){if(e.search(zN)>=0)throw nd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Sd(...e.split("."))._internalPath}catch{throw nd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function nd(n,e,t,s,a){const l=s&&!s.isEmpty(),d=a!==void 0;let f=`Function ${e}() called with invalid data`;t&&(f+=" (via `toFirestore()`)"),f+=". ";let m="";return(l||d)&&(m+=" (found",l&&(m+=` in field ${s}`),d&&(m+=` in document ${a}`),m+=")"),new Ue(pe.INVALID_ARGUMENT,f+n+m)}function ix(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ax{constructor(e,t,s,a,l){this._firestore=e,this._userDataWriter=t,this._key=s,this._document=a,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new Zt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new BN(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Id("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class BN extends ax{data(){return super.data()}}function Id(n,e){return typeof e=="string"?Zp(n,e):e instanceof Sd?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ox(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Ue(pe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class em{}class tm extends em{}function Jf(n,e,...t){let s=[];e instanceof em&&s.push(e),s=s.concat(t),(function(l){const d=l.filter((m=>m instanceof nm)).length,f=l.filter((m=>m instanceof Pd)).length;if(d>1||d>0&&f>0)throw new Ue(pe.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(s);for(const a of s)n=a._apply(n);return n}class Pd extends tm{constructor(e,t,s){super(),this._field=e,this._op=t,this._value=s,this.type="where"}static _create(e,t,s){return new Pd(e,t,s)}_apply(e){const t=this._parse(e);return cx(e._query,t),new wi(e.firestore,e.converter,Uf(e._query,t))}_parse(e){const t=Cd(e.firestore);return(function(l,d,f,m,v,w,T){let I;if(v.isKeyField()){if(w==="array-contains"||w==="array-contains-any")throw new Ue(pe.INVALID_ARGUMENT,`Invalid Query. You can't perform '${w}' queries on documentId().`);if(w==="in"||w==="not-in"){l_(T,w);const X=[];for(const $ of T)X.push(o_(m,l,$));I={arrayValue:{values:X}}}else I=o_(m,l,T)}else w!=="in"&&w!=="not-in"&&w!=="array-contains-any"||l_(T,w),I=UN(f,d,T,w==="in"||w==="not-in");return pn.create(v,w,I)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function lx(n,e,t){const s=e,a=Id("where",n);return Pd._create(a,s,t)}class nm extends em{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new nm(e,t)}_parse(e){const t=this._queryConstraints.map((s=>s._parse(e))).filter((s=>s.getFilters().length>0));return t.length===1?t[0]:Es.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(a,l){let d=a;const f=l.getFlattenedFilters();for(const m of f)cx(d,m),d=Uf(d,m)})(e._query,t),new wi(e.firestore,e.converter,Uf(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class rm extends tm{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new rm(e,t)}_apply(e){const t=(function(a,l,d){if(a.startAt!==null)throw new Ue(pe.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(a.endAt!==null)throw new Ue(pe.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Jl(l,d)})(e._query,this._field,this._direction);return new wi(e.firestore,e.converter,(function(a,l){const d=a.explicitOrderBy.concat([l]);return new Qo(a.path,a.collectionGroup,d,a.filters.slice(),a.limit,a.limitType,a.startAt,a.endAt)})(e._query,t))}}function Xf(n,e="asc"){const t=e,s=Id("orderBy",n);return rm._create(s,t)}class sm extends tm{constructor(e,t,s){super(),this.type=e,this._limit=t,this._limitType=s}static _create(e,t,s){return new sm(e,t,s)}_apply(e){return new wi(e.firestore,e.converter,Qu(e._query,this._limit,this._limitType))}}function $N(n){return sm._create("limit",n,"F")}function o_(n,e,t){if(typeof(t=en(t))=="string"){if(t==="")throw new Ue(pe.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!lw(e)&&t.indexOf("/")!==-1)throw new Ue(pe.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const s=e.path.child(Mt.fromString(t));if(!Xe.isDocumentKey(s))throw new Ue(pe.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return Tv(n,new Xe(s))}if(t instanceof Zt)return Tv(n,t._key);throw new Ue(pe.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${cd(t)}.`)}function l_(n,e){if(!Array.isArray(n)||n.length===0)throw new Ue(pe.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function cx(n,e){const t=(function(a,l){for(const d of a)for(const f of d.getFlattenedFilters())if(l.indexOf(f.op)>=0)return f.op;return null})(n.filters,(function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new Ue(pe.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ue(pe.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class WN{convertValue(e,t="none"){switch(ta(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ln(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ea(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw it(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const s={};return la(e,((a,l)=>{s[a]=this.convertValue(l,t)})),s}convertVectorValue(e){var t,s,a;const l=(a=(s=(t=e.fields)===null||t===void 0?void 0:t[Hu].arrayValue)===null||s===void 0?void 0:s.values)===null||a===void 0?void 0:a.map((d=>ln(d.doubleValue)));return new zs(l)}convertGeoPoint(e){return new Us(ln(e.latitude),ln(e.longitude))}convertArray(e,t){return(e.values||[]).map((s=>this.convertValue(s,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const s=hd(e);return s==null?null:this.convertValue(s,t);case"estimate":return this.convertTimestamp(Kl(e));default:return null}}convertTimestamp(e){const t=Zi(e);return new Bt(t.seconds,t.nanos)}convertDocumentKey(e,t){const s=Mt.fromString(e);At(Rw(s),9688,{name:e});const a=new Ql(s.get(1),s.get(3)),l=new Xe(s.popFirst(5));return a.isEqual(t)||mi(`Document ${l} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ux(n,e,t){let s;return s=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,s}class Dl{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Aa extends ax{constructor(e,t,s,a,l,d){super(e,t,s,a,d),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new ku(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const s=this._document.data.field(Id("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ue(pe.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Aa._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Aa._jsonSchemaVersion="firestore/documentSnapshot/1.0",Aa._jsonSchema={type:mn("string",Aa._jsonSchemaVersion),bundleSource:mn("string","DocumentSnapshot"),bundleName:mn("string"),bundle:mn("string")};class ku extends Aa{data(e={}){return super.data(e)}}class ja{constructor(e,t,s,a){this._firestore=e,this._userDataWriter=t,this._snapshot=a,this.metadata=new Dl(a.hasPendingWrites,a.fromCache),this.query=s}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((s=>{e.call(t,new ku(this._firestore,this._userDataWriter,s.key,s,new Dl(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ue(pe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(a,l){if(a._snapshot.oldDocs.isEmpty()){let d=0;return a._snapshot.docChanges.map((f=>{const m=new ku(a._firestore,a._userDataWriter,f.doc.key,f.doc,new Dl(a._snapshot.mutatedKeys.has(f.doc.key),a._snapshot.fromCache),a.query.converter);return f.doc,{type:"added",doc:m,oldIndex:-1,newIndex:d++}}))}{let d=a._snapshot.oldDocs;return a._snapshot.docChanges.filter((f=>l||f.type!==3)).map((f=>{const m=new ku(a._firestore,a._userDataWriter,f.doc.key,f.doc,new Dl(a._snapshot.mutatedKeys.has(f.doc.key),a._snapshot.fromCache),a.query.converter);let v=-1,w=-1;return f.type!==0&&(v=d.indexOf(f.doc.key),d=d.delete(f.doc.key)),f.type!==1&&(d=d.add(f.doc),w=d.indexOf(f.doc.key)),{type:GN(f.type),doc:m,oldIndex:v,newIndex:w}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ue(pe.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ja._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Ep.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],s=[],a=[];return this.docs.forEach((l=>{l._document!==null&&(t.push(l._document),s.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),a.push(l.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function GN(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return it(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nd(n){n=Cr(n,Zt);const e=Cr(n.firestore,yi);return RN(Td(e),n._key).then((t=>dx(e,n,t)))}ja._jsonSchemaVersion="firestore/querySnapshot/1.0",ja._jsonSchema={type:mn("string",ja._jsonSchemaVersion),bundleSource:mn("string","QuerySnapshot"),bundleName:mn("string"),bundle:mn("string")};class im extends WN{constructor(e){super(),this.firestore=e}convertBytes(e){return new Yr(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Zt(this.firestore,null,t)}}function vs(n){n=Cr(n,wi);const e=Cr(n.firestore,yi),t=Td(e),s=new im(e);return ox(n._query),AN(t,n._query).then((a=>new ja(e,s,n,a)))}function ci(n,e,t){n=Cr(n,Zt);const s=Cr(n.firestore,yi),a=ux(n.converter,e,t);return Rd(s,[nx(Cd(s),"setDoc",n._key,a,n.converter!==null,t).toMutation(n._key,Xr.none())])}function _s(n,e,t,...s){n=Cr(n,Zt);const a=Cr(n.firestore,yi),l=Cd(a);let d;return d=typeof(e=en(e))=="string"||e instanceof Sd?FN(l,"updateDoc",n._key,e,t,s):ON(l,"updateDoc",n._key,e),Rd(a,[d.toMutation(n._key,Xr.exists(!0))])}function Na(n){return Rd(Cr(n.firestore,yi),[new Np(n._key,Xr.none())])}function Ra(n,e){const t=Cr(n.firestore,yi),s=Dt(n),a=ux(n.converter,e);return Rd(t,[nx(Cd(n.firestore),"addDoc",s._key,a,n.converter!==null,{}).toMutation(s._key,Xr.exists(!1))]).then((()=>s))}function c_(n,...e){var t,s,a;n=en(n);let l={includeMetadataChanges:!1,source:"default"},d=0;typeof e[d]!="object"||a_(e[d])||(l=e[d++]);const f={includeMetadataChanges:l.includeMetadataChanges,source:l.source};if(a_(e[d])){const T=e[d];e[d]=(t=T.next)===null||t===void 0?void 0:t.bind(T),e[d+1]=(s=T.error)===null||s===void 0?void 0:s.bind(T),e[d+2]=(a=T.complete)===null||a===void 0?void 0:a.bind(T)}let m,v,w;if(n instanceof Zt)v=Cr(n.firestore,yi),w=fd(n._key.path),m={next:T=>{e[d]&&e[d](dx(v,n,T))},error:e[d+1],complete:e[d+2]};else{const T=Cr(n,wi);v=Cr(T.firestore,yi),w=T._query;const I=new im(v);m={next:U=>{e[d]&&e[d](new ja(v,I,T,U))},error:e[d+1],complete:e[d+2]},ox(n._query)}return(function(I,U,X,$){const O=new Qp($),se=new qp(U,O,X);return I.asyncQueue.enqueueAndForget((async()=>$p(await td(I),se))),()=>{O.Ou(),I.asyncQueue.enqueueAndForget((async()=>Wp(await td(I),se)))}})(Td(v),w,f,m)}function Rd(n,e){return(function(s,a){const l=new di;return s.asyncQueue.enqueueAndForget((async()=>vN(await NN(s),a,l))),l.promise})(Td(n),e)}function dx(n,e,t){const s=t.docs.get(e._key),a=new im(n);return new Aa(n,a,e._key,s,new Dl(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qN(){return new hc("deleteField")}function ka(){return new Jp("serverTimestamp")}(function(e,t=!0){(function(a){qo=a})($o),jo(new La("firestore",((s,{instanceIdentifier:a,options:l})=>{const d=s.getProvider("app").getImmediate(),f=new yi(new UC(s.getProvider("auth-internal")),new $C(d,s.getProvider("app-check-internal")),(function(v,w){if(!Object.prototype.hasOwnProperty.apply(v.options,["projectId"]))throw new Ue(pe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ql(v.options.projectId,w)})(d,a),d);return l=Object.assign({useFetchStreams:t},l),f._setSettings(l),f}),"PUBLIC").setMultipleInstances(!0)),Ki(cv,uv,e),Ki(cv,uv,"esm2017")})();const HN={apiKey:"AIzaSyCOOnlmEcAcJywsS93LLfLSywy9ENqnppM",authDomain:"tyler-manga-library.firebaseapp.com",projectId:"tyler-manga-library",storageBucket:"tyler-manga-library.firebasestorage.app",messagingSenderId:"307412068362",appId:"1:307412068362:web:6cfe5666187439dfa757f3"},hx=K_(HN),Jr=VC(hx),ot=kN(hx),fx=j.createContext(null);function KN({children:n}){const e="https://discord.com/api/webhooks/1451655828078723156/EA8QhLeiTT-7jOVQ6jFpV2he2zxVpAddAhlu8CiC6RtGFu9wTAOLdRjKeYHIV1OhVbmm",[t,s]=j.useState(null),[a,l]=j.useState(!1),[d,f]=j.useState("viewer"),[m,v]=j.useState(!0),w=async U=>{if(!U)return null;const X=Dt(ot,"users",U.uid);let $=null;try{const se=await Nd(X);se.exists()&&($=se.data())}catch(se){console.warn("Failed to read user doc",se)}const O={role:(($==null?void 0:$.role)||"viewer").toLowerCase()==="admin"?"admin":"viewer",email:U.email||($==null?void 0:$.email)||"",displayName:U.displayName||($==null?void 0:$.displayName)||"",createdAt:($==null?void 0:$.createdAt)||ka()};try{if(await ci(X,O,{merge:!0}),!$&&e)try{const se=U.displayName||U.email||U.uid;await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:`New signup: ${se}`})})}catch(se){console.warn("Failed to send signup webhook",se)}}catch(se){console.error("Failed to ensure user doc",se)}return{...$,...O}};j.useEffect(()=>{const U=Cb(Jr,async X=>{if(s(X),X)try{const $=await w(X),O=($==null?void 0:$.role)||"viewer";f(O),l(O.toLowerCase()==="admin")}catch($){console.error("Error checking role:",$),l(!1),f("viewer")}else l(!1),f("viewer");v(!1)});return()=>U()},[]);const T=async(U,X)=>{await E0(Jr,U,X)},I=async()=>{await T0(Jr)};return o.jsx(fx.Provider,{value:{user:t,admin:a,role:d,loading:m,login:T,logout:I},children:n})}function za(){return j.useContext(fx)}function QN({onClose:n}){const[e,t]=j.useState("login"),[s,a]=j.useState(""),[l,d]=j.useState("");async function f(){try{await k0(Jr,new ys),n()}catch(w){alert(w.message)}}async function m(w){w.preventDefault();try{await E0(Jr,s,l),n()}catch(T){alert(T.message)}}async function v(w){w.preventDefault();try{await xb(Jr,s,l),n()}catch(T){alert(T.message)}}return o.jsx("div",{className:"auth-modal-backdrop",onClick:n,children:o.jsxs("div",{className:"auth-modal",onClick:w=>w.stopPropagation(),children:[o.jsx("h2",{className:"auth-title",children:e==="login"?"Sign In":"Create Account"}),o.jsxs("button",{className:"google-btn",onClick:f,children:[o.jsx("img",{src:"https://www.svgrepo.com/show/475656/google-color.svg",alt:"",className:"google-icon"}),"Continue with Google"]}),o.jsx("div",{className:"auth-divider",children:o.jsx("span",{children:"or"})}),o.jsxs("form",{onSubmit:e==="login"?m:v,className:"auth-form",children:[o.jsx("input",{type:"email",placeholder:"Email address",className:"auth-input",value:s,onChange:w=>a(w.target.value),required:!0}),o.jsx("input",{type:"password",placeholder:"Password",className:"auth-input",value:l,onChange:w=>d(w.target.value),required:!0}),o.jsx("button",{className:"auth-submit",children:e==="login"?"Sign In":"Create Account"})]}),o.jsx("div",{className:"auth-switcher",children:e==="login"?o.jsxs("p",{children:["No account?"," ",o.jsx("button",{onClick:()=>t("register"),children:"Register"})]}):o.jsxs("p",{children:["Already have an account?"," ",o.jsx("button",{onClick:()=>t("login"),children:"Sign in"})]})}),o.jsx("button",{className:"auth-close",onClick:n,"aria-label":"Close",children:"X"})]})})}var Du={exports:{}},YN=Du.exports,u_;function JN(){return u_||(u_=1,(function(n){(function(e){function t(V,ie){var C=(V&65535)+(ie&65535),P=(V>>16)+(ie>>16)+(C>>16);return P<<16|C&65535}function s(V,ie){return V<<ie|V>>>32-ie}function a(V,ie,C,P,A,M){return t(s(t(t(ie,V),t(P,M)),A),C)}function l(V,ie,C,P,A,M,D){return a(ie&C|~ie&P,V,ie,A,M,D)}function d(V,ie,C,P,A,M,D){return a(ie&P|C&~P,V,ie,A,M,D)}function f(V,ie,C,P,A,M,D){return a(ie^C^P,V,ie,A,M,D)}function m(V,ie,C,P,A,M,D){return a(C^(ie|~P),V,ie,A,M,D)}function v(V,ie){V[ie>>5]|=128<<ie%32,V[(ie+64>>>9<<4)+14]=ie;var C,P,A,M,D,N=1732584193,b=-271733879,J=-1732584194,ne=271733878;for(C=0;C<V.length;C+=16)P=N,A=b,M=J,D=ne,N=l(N,b,J,ne,V[C],7,-680876936),ne=l(ne,N,b,J,V[C+1],12,-389564586),J=l(J,ne,N,b,V[C+2],17,606105819),b=l(b,J,ne,N,V[C+3],22,-1044525330),N=l(N,b,J,ne,V[C+4],7,-176418897),ne=l(ne,N,b,J,V[C+5],12,1200080426),J=l(J,ne,N,b,V[C+6],17,-1473231341),b=l(b,J,ne,N,V[C+7],22,-45705983),N=l(N,b,J,ne,V[C+8],7,1770035416),ne=l(ne,N,b,J,V[C+9],12,-1958414417),J=l(J,ne,N,b,V[C+10],17,-42063),b=l(b,J,ne,N,V[C+11],22,-1990404162),N=l(N,b,J,ne,V[C+12],7,1804603682),ne=l(ne,N,b,J,V[C+13],12,-40341101),J=l(J,ne,N,b,V[C+14],17,-1502002290),b=l(b,J,ne,N,V[C+15],22,1236535329),N=d(N,b,J,ne,V[C+1],5,-165796510),ne=d(ne,N,b,J,V[C+6],9,-1069501632),J=d(J,ne,N,b,V[C+11],14,643717713),b=d(b,J,ne,N,V[C],20,-373897302),N=d(N,b,J,ne,V[C+5],5,-701558691),ne=d(ne,N,b,J,V[C+10],9,38016083),J=d(J,ne,N,b,V[C+15],14,-660478335),b=d(b,J,ne,N,V[C+4],20,-405537848),N=d(N,b,J,ne,V[C+9],5,568446438),ne=d(ne,N,b,J,V[C+14],9,-1019803690),J=d(J,ne,N,b,V[C+3],14,-187363961),b=d(b,J,ne,N,V[C+8],20,1163531501),N=d(N,b,J,ne,V[C+13],5,-1444681467),ne=d(ne,N,b,J,V[C+2],9,-51403784),J=d(J,ne,N,b,V[C+7],14,1735328473),b=d(b,J,ne,N,V[C+12],20,-1926607734),N=f(N,b,J,ne,V[C+5],4,-378558),ne=f(ne,N,b,J,V[C+8],11,-2022574463),J=f(J,ne,N,b,V[C+11],16,1839030562),b=f(b,J,ne,N,V[C+14],23,-35309556),N=f(N,b,J,ne,V[C+1],4,-1530992060),ne=f(ne,N,b,J,V[C+4],11,1272893353),J=f(J,ne,N,b,V[C+7],16,-155497632),b=f(b,J,ne,N,V[C+10],23,-1094730640),N=f(N,b,J,ne,V[C+13],4,681279174),ne=f(ne,N,b,J,V[C],11,-358537222),J=f(J,ne,N,b,V[C+3],16,-722521979),b=f(b,J,ne,N,V[C+6],23,76029189),N=f(N,b,J,ne,V[C+9],4,-640364487),ne=f(ne,N,b,J,V[C+12],11,-421815835),J=f(J,ne,N,b,V[C+15],16,530742520),b=f(b,J,ne,N,V[C+2],23,-995338651),N=m(N,b,J,ne,V[C],6,-198630844),ne=m(ne,N,b,J,V[C+7],10,1126891415),J=m(J,ne,N,b,V[C+14],15,-1416354905),b=m(b,J,ne,N,V[C+5],21,-57434055),N=m(N,b,J,ne,V[C+12],6,1700485571),ne=m(ne,N,b,J,V[C+3],10,-1894986606),J=m(J,ne,N,b,V[C+10],15,-1051523),b=m(b,J,ne,N,V[C+1],21,-2054922799),N=m(N,b,J,ne,V[C+8],6,1873313359),ne=m(ne,N,b,J,V[C+15],10,-30611744),J=m(J,ne,N,b,V[C+6],15,-1560198380),b=m(b,J,ne,N,V[C+13],21,1309151649),N=m(N,b,J,ne,V[C+4],6,-145523070),ne=m(ne,N,b,J,V[C+11],10,-1120210379),J=m(J,ne,N,b,V[C+2],15,718787259),b=m(b,J,ne,N,V[C+9],21,-343485551),N=t(N,P),b=t(b,A),J=t(J,M),ne=t(ne,D);return[N,b,J,ne]}function w(V){var ie,C="",P=V.length*32;for(ie=0;ie<P;ie+=8)C+=String.fromCharCode(V[ie>>5]>>>ie%32&255);return C}function T(V){var ie,C=[];for(C[(V.length>>2)-1]=void 0,ie=0;ie<C.length;ie+=1)C[ie]=0;var P=V.length*8;for(ie=0;ie<P;ie+=8)C[ie>>5]|=(V.charCodeAt(ie/8)&255)<<ie%32;return C}function I(V){return w(v(T(V),V.length*8))}function U(V,ie){var C,P=T(V),A=[],M=[],D;for(A[15]=M[15]=void 0,P.length>16&&(P=v(P,V.length*8)),C=0;C<16;C+=1)A[C]=P[C]^909522486,M[C]=P[C]^1549556828;return D=v(A.concat(T(ie)),512+ie.length*8),w(v(M.concat(D),640))}function X(V){var ie="0123456789abcdef",C="",P,A;for(A=0;A<V.length;A+=1)P=V.charCodeAt(A),C+=ie.charAt(P>>>4&15)+ie.charAt(P&15);return C}function $(V){return unescape(encodeURIComponent(V))}function O(V){return I($(V))}function se(V){return X(O(V))}function Te(V,ie){return U($(V),$(ie))}function xe(V,ie){return X(Te(V,ie))}function _e(V,ie,C){return ie?C?Te(ie,V):xe(ie,V):C?O(V):se(V)}n.exports?n.exports=_e:e.md5=_e})(YN)})(Du)),Du.exports}var XN=JN();const ZN=Zf(XN);function eR(){var Fe,Qe,st;const n="google.com",e="oidc.discord",[t,s]=j.useState(!1),[a,l]=j.useState(!1),[d,f]=j.useState(!1),[m,v]=j.useState(!1),[w,T]=j.useState(""),[I,U]=j.useState(""),[X,$]=j.useState(""),[O,se]=j.useState({google:!1,discord:!1}),[Te,xe]=j.useState(""),[_e,V]=j.useState(!1),[ie,C]=j.useState(!1),[P,A]=j.useState(null),M=j.useRef(null),{user:D,admin:N,role:b}=za(),J=tc();j.useEffect(()=>{var ye;f(!1),v(!1),U(""),$(""),C(!1),T((D==null?void 0:D.displayName)||((ye=D==null?void 0:D.email)==null?void 0:ye.split("@")[0])||"")},[D]),j.useEffect(()=>{const ye=((D==null?void 0:D.email)||"").trim().toLowerCase();if(!ye){xe("");return}const ce=ZN(ye),Me=Date.now();xe(`https://www.gravatar.com/avatar/${ce}?s=160&d=identicon&r=g&cb=${Me}`)},[D==null?void 0:D.email]),j.useEffect(()=>{let ye=!1;const ce=async()=>{var me;try{const He=Jf(Sn(ot,"blogPosts"),lx("status","==","published"),Xf("publishedAt","desc"),$N(1)),Ye=await vs(He);if(ye)return;if(Ye.empty){A(null);return}const Tt=Ye.docs[0],Ct=Tt.data(),gt=(me=Ct.publishedAt)!=null&&me.toDate?Ct.publishedAt.toDate():null;if(!gt){A(null);return}const Nt=Ct.title||"New blog post",Qt=gt.toISOString().slice(0,10),tn=`blog-alert-${Tt.id}-${Qt}`;if(!(Date.now()-gt.getTime()<=1440*60*1e3)){A(null);return}if(typeof localStorage<"u"&&localStorage.getItem(tn)==="dismissed")return;A({id:Tt.id,title:Nt,alertKey:tn,publishedAt:gt})}catch(He){(He==null?void 0:He.code)!=="permission-denied"&&console.error("Failed to load blog alert",He)}};ce();const Me=setInterval(ce,6e4);return()=>{ye=!0,clearInterval(Me)}},[]);const ne=ye=>{P!=null&&P.alertKey&&typeof localStorage<"u"&&localStorage.setItem(P.alertKey,"dismissed"),A(null),J(ye?`/blog?post=${ye}`:"/blog")},Re=ye=>{ye!=null&&ye.stopPropagation&&ye.stopPropagation(),P!=null&&P.alertKey&&typeof localStorage<"u"&&localStorage.setItem(P.alertKey,"dismissed"),A(null)};async function he(){try{await T0(Jr),s(!1),f(!1),J("/")}catch(ye){console.error(ye),alert("Logout failed.")}}const le=()=>{if(!D){s(!1),l(!0);return}f(!1),U(""),$(""),C(!1),v(!0)},Ie=async()=>{if(!D){s(!1),l(!0);return}const ye=(w||"").trim();if(!ye){U("Display name is required.");return}V(!0),U(""),C(!1);try{await Tb(Jr.currentUser,{displayName:ye}),await ci(Dt(ot,"users",D.uid),{displayName:ye},{merge:!0}),U("Profile updated."),C(!1)}catch(ce){console.error("Failed to update profile",ce),U("Failed to update profile.")}finally{V(!1)}},ve=ye=>{var ce;return!!((ce=D==null?void 0:D.providerData)!=null&&ce.some(Me=>Me.providerId===ye))},Y=async()=>{if(!D){s(!1),l(!0);return}if(ve(n)){$("Google is already connected.");return}se(ye=>({...ye,google:!0})),$("");try{const ye=new ys,ce=await ev(Jr.currentUser,ye);await ci(Dt(ot,"users",D.uid),{connections:{[n]:{email:ce.user.email||"",connectedAt:ka()}}},{merge:!0}),$("Google connected.")}catch(ye){console.error("Failed to link Google",ye);const ce=(ye==null?void 0:ye.code)==="auth/credential-already-in-use"?"That Google account is already linked elsewhere. Sign in with it instead.":"Could not connect Google.";$(ce)}finally{se(ye=>({...ye,google:!1}))}},k=async()=>{if(!D){s(!1),l(!0);return}if(ve(e)){$("Discord is already connected.");return}se(ye=>({...ye,discord:!0})),$("");try{const ye=new Ml(e);ye.addScope("identify"),ye.addScope("email");const Me=(await ev(Jr.currentUser,ye)).user.providerData.find(me=>me.providerId===e);await ci(Dt(ot,"users",D.uid),{connections:{[e]:{username:(Me==null?void 0:Me.displayName)||(Me==null?void 0:Me.uid)||"Discord",email:(Me==null?void 0:Me.email)||"",connectedAt:ka()}}},{merge:!0}),$("Discord connected.")}catch(ye){console.error("Failed to link Discord",ye);const ce=(ye==null?void 0:ye.code)==="auth/credential-already-in-use"?"That Discord account is already linked elsewhere. Sign in with it instead.":"Could not connect Discord.";$(ce)}finally{se(ye=>({...ye,discord:!1}))}},q=async ye=>{if(!D)return;if(D.providerData.length<=1){$("You need at least one sign-in method.");return}const ce=ye===n?"google":"discord";$(""),se(Me=>({...Me,[ce]:!0}));try{await gb(Jr.currentUser,ye),await ci(Dt(ot,"users",D.uid),{connections:{[ye]:qN()}},{merge:!0}),$("Connection removed.")}catch(Me){console.error("Failed to unlink",Me),$("Could not remove connection.")}finally{se(Me=>({...Me,[ce]:!1}))}},Ee=D?(((Fe=D.displayName)==null?void 0:Fe[0])||((Qe=D.email)==null?void 0:Qe[0])||((st=D.uid)==null?void 0:st[0])||"?").toUpperCase():"?",Le=(D==null?void 0:D.displayName)||(D==null?void 0:D.email)||"Guest",De=D?N?"admin":b||"viewer":"Not signed in";return o.jsxs(o.Fragment,{children:[P&&o.jsxs("div",{className:"blog-alert-banner",onClick:()=>ne(P.id),role:"button",tabIndex:0,onKeyDown:ye=>{(ye.key==="Enter"||ye.key===" ")&&(ye.preventDefault(),ne(P.id))},children:[o.jsx("div",{className:"blog-alert-dot"}),o.jsxs("div",{className:"blog-alert-text",children:["New blog post today: ",o.jsx("strong",{children:P.title})]}),o.jsxs("div",{className:"blog-alert-actions",children:[o.jsx("button",{type:"button",className:"blog-alert-btn",onClick:ye=>{ye.stopPropagation(),ne(P.id)},children:"Read now"}),o.jsx("button",{type:"button",className:"blog-alert-dismiss",onClick:Re,children:"Dismiss"})]})]}),o.jsxs("button",{className:`menu-toggle ${t?"active":""}`,onClick:()=>s(!t),children:[o.jsx("span",{}),o.jsx("span",{}),o.jsx("span",{})]}),o.jsxs("nav",{className:`menu-panel ${t?"open":""}`,onMouseLeave:()=>f(!1),children:[o.jsx(Mi,{to:"/",className:"menu-item",onClick:()=>s(!1),children:"Home"}),o.jsx(Mi,{to:"/manga",className:"menu-item",onClick:()=>s(!1),children:"Manga"}),o.jsx(Mi,{to:"/anime",className:"menu-item",onClick:()=>s(!1),children:"Anime"}),o.jsx(Mi,{to:"/tcg",className:"menu-item",onClick:()=>s(!1),children:"TCG"}),o.jsx(Mi,{to:"/music",className:"menu-item",onClick:()=>s(!1),children:"Music"}),o.jsx(Mi,{to:"/steam",className:"menu-item",onClick:()=>s(!1),children:"Gaming"}),N&&o.jsx(Mi,{to:"/blog",className:"menu-item",onClick:()=>s(!1),children:"Blog"}),N&&o.jsx(Mi,{to:"/dashboard",className:"menu-item",onClick:()=>s(!1),children:"Dashboard"}),o.jsxs("div",{className:"menu-footer",children:[o.jsx("div",{className:"profile-divider"}),o.jsxs("div",{className:"profile-card",onMouseEnter:()=>D&&f(!0),onMouseLeave:()=>f(!1),onClick:()=>{D?f(ye=>!ye):(f(!1),s(!1),l(!0))},role:"button",tabIndex:0,onKeyDown:ye=>{(ye.key==="Enter"||ye.key===" ")&&(ye.preventDefault(),D?f(ce=>!ce):(s(!1),l(!0)))},children:[o.jsx("div",{className:"profile-avatar",children:Te?o.jsx("img",{src:Te,alt:`${Le} avatar`,onError:()=>xe("")}):Ee}),o.jsxs("div",{className:"profile-meta",children:[o.jsx("div",{className:"profile-name",children:Le}),o.jsx("div",{className:"profile-role",children:De})]}),D&&d&&o.jsxs("div",{className:"profile-menu",children:[o.jsx("button",{type:"button",className:"profile-menu-item",onClick:le,children:"Edit profile"}),o.jsx("button",{type:"button",className:"profile-menu-item",onClick:he,children:"Sign out"})]})]})]})]}),a&&o.jsx(QN,{onClose:()=>l(!1)}),m&&o.jsx("div",{className:"profile-edit-backdrop",children:o.jsxs("div",{className:"profile-edit-card",children:[o.jsxs("div",{className:"profile-edit-header",children:[o.jsx("h3",{children:"Edit profile"}),o.jsx("button",{type:"button",className:"profile-edit-close",onClick:()=>{v(!1),U(""),$(""),C(!1)},children:""})]}),o.jsxs("div",{className:"profile-edit-body",children:[o.jsxs("a",{className:"profile-edit-avatar clickable",href:"https://gravatar.com/profile",target:"_blank",rel:"noreferrer",title:"Manage your picture on Gravatar (opens in new tab)",children:[Te?o.jsx("img",{src:Te,alt:`${Le} avatar`,onError:()=>xe("")}):Ee,o.jsx("span",{className:"profile-avatar-hover-hint",children:"Change on Gravatar"})]}),o.jsxs("div",{className:"profile-edit-field",children:[o.jsx("label",{className:"profile-edit-label",htmlFor:"displayName",children:"Display name"}),o.jsxs("div",{className:"profile-edit-input-row",children:[o.jsx("input",{id:"displayName",className:"profile-edit-input",type:"text",readOnly:!ie,value:w,onChange:ye=>T(ye.target.value),maxLength:40,placeholder:"Enter display name",ref:M,onBlur:()=>{ie&&Ie()},onKeyDown:ye=>{ye.key==="Enter"&&ie&&(ye.preventDefault(),Ie())}}),o.jsx("button",{type:"button",className:"profile-edit-pencil",onClick:()=>{C(!0),U(""),setTimeout(()=>{var ye;return(ye=M.current)==null?void 0:ye.focus()},50)},"aria-label":"Edit display name",children:""})]}),o.jsx("div",{className:"profile-edit-hint",children:"Click the pencil to edit. Changes save on blur or Enter."})]})]}),o.jsxs("div",{className:"profile-connections",children:[o.jsxs("div",{className:"profile-connections-header",children:[o.jsx("span",{children:"Connections"}),X&&o.jsx("span",{className:"profile-connection-status",children:X})]}),o.jsxs("div",{className:"profile-connection-row",children:[o.jsxs("div",{className:"profile-connection-meta",children:[o.jsx("div",{className:"profile-connection-title",children:"Google"}),o.jsx("div",{className:"profile-connection-sub",children:ve(n)?"Connected":"Not connected"})]}),o.jsx("div",{className:"profile-connection-actions",children:ve(n)?o.jsx("button",{type:"button",className:"profile-connection-btn secondary",onClick:()=>q(n),disabled:O.google,children:O.google?"Removing...":"Remove"}):o.jsx("button",{type:"button",className:"profile-connection-btn",onClick:Y,disabled:O.google,children:O.google?"Connecting...":"Connect"})})]}),o.jsxs("div",{className:"profile-connection-row",children:[o.jsxs("div",{className:"profile-connection-meta",children:[o.jsx("div",{className:"profile-connection-title",children:"Discord"}),o.jsx("div",{className:"profile-connection-sub",children:ve(e)?"Connected":"Not connected"})]}),o.jsx("div",{className:"profile-connection-actions",children:ve(e)?o.jsx("button",{type:"button",className:"profile-connection-btn secondary",onClick:()=>q(e),disabled:O.discord,children:O.discord?"Removing...":"Remove"}):o.jsx("button",{type:"button",className:"profile-connection-btn",onClick:k,disabled:O.discord,children:O.discord?"Connecting...":"Connect"})})]})]}),I&&o.jsx("div",{className:"profile-edit-status",children:I}),_e&&o.jsx("div",{className:"profile-edit-status saving",children:"Saving..."}),o.jsx("div",{className:"profile-gravatar-note",children:"Profile pictures are managed through Gravatarclick the avatar to update."})]})})]})}function d_(){const n="Tyler's Collection's and Hobbies",e="",[t,s]=j.useState(""),[a,l]=j.useState(!0),d=j.useRef(null),[f,m]=j.useState("jp"),[v,w]=j.useState(1);return j.useEffect(()=>{document.title="Tyler's Collection"},[]),j.useEffect(()=>(d.current=setInterval(()=>l(T=>!T),450),()=>{d.current&&clearInterval(d.current)}),[]),j.useEffect(()=>{let T=!1;const I=$=>new Promise(O=>setTimeout(O,$)),U=async($,O=120)=>{for(let se=1;se<=$.length;se+=1){if(T)return;s($.slice(0,se)),await I(O)}},X=async($,O=70)=>{for(let se=$.length;se>=0;se-=1){if(T)return;s($.slice(0,se)),await I(O)}};return(async()=>{if(localStorage.getItem("homeTitleTyped")==="1"){m("en"),s(n),l(!1),d.current&&clearInterval(d.current);return}await I(250),m("jp"),await U(e,140),await I(6e3),await X(e,80),await I(320);const O=n;for(let se=1;se<=O.length;se+=1){if(T)return;s(O.slice(0,se)),se===4&&m("en"),await I(110)}m("en"),await I(2e3),l(!1),localStorage.setItem("homeTitleTyped","1"),d.current&&clearInterval(d.current)})(),()=>{T=!0}},[]),o.jsxs("main",{className:"page",children:[o.jsxs("header",{style:{textAlign:"center",marginTop:"32px",marginBottom:"24px"},children:[o.jsxs("h1",{style:{margin:0,fontSize:"2.2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",display:"inline-flex",alignItems:"center",gap:"6px"},children:[o.jsx("span",{children:t||" "}),o.jsx("span",{style:{width:"6px",height:"1.1em",background:"#ffb6c1",opacity:a?1:0,transition:"opacity 0.15s ease"}})]}),o.jsx("p",{style:{margin:"6px 0 0",color:"var(--text-soft)",fontSize:"0.95rem",opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"TCG":"This is my personal webpage to see what is on my shelves, wishlists, and TCG collections."}),o.jsx("div",{style:{display:"inline-flex",alignItems:"center",gap:"10px",padding:"8px 14px",borderRadius:"999px",border:"1px solid rgba(255,182,193,0.5)",background:"linear-gradient(135deg, rgba(255,182,193,0.18), rgba(43,15,29,0.9))",boxShadow:"0 8px 24px rgba(0,0,0,0.55)",marginTop:"14px",fontSize:"0.78rem",color:"#ffe6ed",letterSpacing:"0.05em",textTransform:"uppercase",fontWeight:700,opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?o.jsx("span",{style:{letterSpacing:"0.06em"},children:"          TCG"}):o.jsx("span",{style:{letterSpacing:"0.06em"},children:" Manga   Anime   Music   TCG"})})]}),o.jsxs("section",{style:{display:"grid",gridTemplateColumns:"minmax(0, 2fr) minmax(0, 3fr)",gap:"20px",marginTop:"24px"},children:[o.jsxs("article",{className:"card",children:[o.jsx("h2",{style:{marginTop:0,marginBottom:"8px",fontSize:"1.2rem",color:"#ffb6c1"},children:o.jsx("span",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"About Me"})}),o.jsx("p",{style:{margin:0,color:"var(--text-soft)",fontSize:"0.9rem",lineHeight:1.5,opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"im.okTCG":"Hey, I am Tyler and I go by im.ok. I hoard manga, binge anime, and collect trading cards."}),o.jsx("p",{style:{marginTop:"10px",color:"var(--text-soft)",fontSize:"0.9rem",opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"TCG":"This site is where I track everything: volumes on my shelves, finished shows, and my TCG collection as they all slowly grow."}),o.jsxs("div",{style:{marginTop:"12px",display:"flex",flexWrap:"wrap",gap:"6px",opacity:v,transition:"opacity 0.25s ease"},children:[o.jsx("span",{className:"pill",children:f==="jp"?"":"Manga library"}),o.jsx("span",{className:"pill",children:f==="jp"?"":"My Anime List (MAL)"}),o.jsx("span",{className:"pill",children:f==="jp"?" & TCG":"Pokemon & One Piece TCG"}),o.jsx("span",{className:"pill",children:f==="jp"?"":"Data Nerd"})]})]}),o.jsxs("article",{className:"card",children:[o.jsx("h2",{style:{marginTop:0,marginBottom:"8px",fontSize:"1.2rem",color:"#ffb6c1"},children:o.jsx("span",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Explore these pages"})}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(210px, 1fr))",gap:"14px",marginTop:"10px"},children:[o.jsxs("a",{href:"/base/manga",className:"section-card",children:[o.jsx("h3",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Manga Library"}),o.jsx("p",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Full manga collection & wishlist."}),o.jsx("div",{className:"section-chip-row",children:o.jsx("span",{className:"section-chip accent",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Library & wishlist"})})]}),o.jsxs("a",{href:"/base/music",className:"section-card",style:{justifySelf:"end",alignSelf:"end",order:99},children:[o.jsx("h3",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Music"}),o.jsx("p",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"If you are here for my music, this is the page for you! Catch all the latest releases."}),o.jsxs("div",{className:"section-chip-row",children:[o.jsx("span",{className:"section-chip accent",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Latest tracks"}),o.jsx("span",{className:"section-chip",style:{opacity:v,transition:"opacity 0.25s ease"},children:"Spotify & SoundCloud"})]})]}),o.jsxs("a",{href:"/base/anime",className:"section-card",children:[o.jsx("h3",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Anime Library"}),o.jsx("p",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"MAL":"The entire watched, plan to watch, and watching list synced directly from MyAnimeList."}),o.jsxs("div",{className:"section-chip-row",children:[o.jsx("span",{className:"section-chip accent",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"MAL":"MAL synced"}),o.jsx("span",{className:"section-chip",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Status filters"}),o.jsx("span",{className:"section-chip",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Quick stats"})]})]}),o.jsxs("a",{href:"/base/tcg",className:"section-card",children:[o.jsx("h3",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"TCG":"TCG Collection"}),o.jsx("p",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"TCG":"Pokemon & One Piece TCG cards tracked with quantities, prices, and value."}),o.jsxs("div",{className:"section-chip-row",children:[o.jsx("span",{className:"section-chip accent",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Full Collection"}),o.jsx("span",{className:"section-chip",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Still Under-Construction"})]})]})]})]})]}),o.jsx("footer",{style:{marginTop:"28px",fontSize:"0.78rem",color:"var(--text-soft)",textAlign:"center"},children:"@ 2025 im.ok. All rights reserved."})]})}const tR="modulepreload",nR=function(n){return"/base/"+n},h_={},pc=function(e,t,s){let a=Promise.resolve();if(t&&t.length>0){let d=function(v){return Promise.all(v.map(w=>Promise.resolve(w).then(T=>({status:"fulfilled",value:T}),T=>({status:"rejected",reason:T}))))};document.getElementsByTagName("link");const f=document.querySelector("meta[property=csp-nonce]"),m=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));a=d(t.map(v=>{if(v=nR(v),v in h_)return;h_[v]=!0;const w=v.endsWith(".css"),T=w?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${v}"]${T}`))return;const I=document.createElement("link");if(I.rel=w?"stylesheet":tR,w||(I.as="script"),I.crossOrigin="",I.href=v,m&&I.setAttribute("nonce",m),document.head.appendChild(I),w)return new Promise((U,X)=>{I.addEventListener("load",U),I.addEventListener("error",()=>X(new Error(`Unable to preload CSS for ${v}`)))})}))}function l(d){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=d,window.dispatchEvent(f),!f.defaultPrevented)throw d}return a.then(d=>{for(const f of d||[])f.status==="rejected"&&l(f.reason);return e().catch(l)})};function px({open:n,title:e,placeholder:t,value:s,status:a,loading:l,onChange:d,onSubmit:f,onClose:m}){if(!n)return null;const v=typeof a=="string"&&a.toLowerCase().startsWith("sent!")?"#a3f0cf":"#ffb6c1";return o.jsx("div",{className:"suggestion-backdrop",onClick:w=>{w.target===w.currentTarget&&m&&m()},children:o.jsxs("div",{className:"suggestion-modal",children:[o.jsxs("div",{className:"suggestion-modal-header",children:[o.jsx("h3",{children:e}),o.jsx("button",{className:"suggestion-close",type:"button",onClick:m,"aria-label":"Close",children:"X"})]}),o.jsx("p",{className:"suggestion-hint",children:"Tell me what to add next. Titles only is fine, but extra notes are welcome."}),o.jsx("textarea",{className:"suggestion-textarea",placeholder:t,value:s,onChange:w=>d==null?void 0:d(w.target.value),maxLength:500}),a&&o.jsx("div",{className:"suggestion-status",style:{color:v},children:a}),o.jsxs("div",{className:"suggestion-actions",children:[o.jsx("button",{className:"suggestion-send",type:"button",onClick:f,disabled:l,children:l?"Sending...":"Send Suggestion"}),o.jsx("button",{className:"suggestion-cancel",type:"button",onClick:m,children:"Cancel"})]})]})})}const am="mangaLibraryActivityLog",Ia="https://discord.com/api/webhooks/1448329790942613667/wsC8psNZ-Ax2D1O9Gl4sJi6ay7df2cr7IrIdxMPwGZTBnkSUIY2NDpeVd98qW_4plz82";let wo=null;function rR(n){return Array.isArray(n)?n.map(e=>({message:e.message,ts:e.ts?new Date(e.ts):new Date,user:e.user||e.email||"",context:e.context||"",details:Array.isArray(e.details)?e.details:[]})).filter(e=>e.message):[]}function sR(){if(typeof window>"u")return[];try{const n=localStorage.getItem(am);if(!n)return[];const e=JSON.parse(n);return rR(e)}catch(n){return console.warn("Failed to read activity log",n),[]}}function mx(n){try{const e=(n||[]).slice(0,100).map(t=>({message:t.message,ts:t.ts instanceof Date?t.ts.toISOString():t.ts,user:t.user||"",context:t.context||"",details:t.details||[]}));typeof window<"u"&&localStorage.setItem(am,JSON.stringify(e))}catch(e){console.warn("Failed to persist activity log",e)}}async function iR(){if(wo)return wo;try{const n=Dt(ot,"settings","webhooks"),e=await Nd(n);if(e.exists())return wo=e.data().activity||Ia,wo}catch(n){console.warn("Failed to load activity webhook",n)}return wo=Ia,wo}function f_(n){if(n==null)return"";if(typeof n=="object")try{return JSON.stringify(n)}catch{return String(n)}return String(n)}function aR(n){return n?typeof n=="string"?[n]:Array.isArray(n)?n.map(e=>f_(e)):typeof n=="object"?Object.entries(n).map(([e,t])=>`${e}: ${f_(t)}`):[]:[]}async function oR(n,e={}){if(n)try{const{email:t,name:s,webhookOverride:a,context:l,list:d,action:f,detailLines:m=[]}=e,v=a||await iR();if(!v)return;const w=(s||"").trim()||t||"anonymous",T=new Date,I=Intl.DateTimeFormat().resolvedOptions().timeZone||"local time",U=[];U.push(" **Library Activity**"),U.push(` ${n}`),U.push(` ${w}       ${T.toLocaleString()} (${I})`);const X=[];l&&X.push(`Context: ${l}`),d&&X.push(`List: ${d}`),f&&X.push(`Action: ${f}`),X.length&&U.push(X.join("      ")),m.length&&(U.push(" Details:"),m.forEach($=>U.push(` ${$}`))),await fetch(v,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:U.join(`
`)})})}catch(t){console.warn("Activity webhook failed",t)}}async function gx(n,e={}){if(!n)return null;const{email:t,name:s,webhookOverride:a,persistLocal:l=!0,context:d="",list:f="",action:m="",details:v=null}=e,w=aR(v),T={message:n,ts:new Date,user:(s||"").trim()||t||"",context:d,details:w};if(l){const I=sR(),U=[T,...I].slice(0,100);mx(U)}return await oR(n,{email:t,name:s,webhookOverride:a,context:d,list:f,action:m,detailLines:w}),T}const p_=5,lR=3600*1e3,m_="mangaSuggestionsSent",g_="mangaViewMode";function kt(n){let e=(n||"").trim();const t=e.match(/^(.*?)(?:,?\s*(?:Vol\.|Volume)\s*(\d+)(?:\s*[--]\s*\d+)?\s*)?(?:\s*\([^)]*\))?$/i),s=t?t[1].trim().toLowerCase():e.toLowerCase(),a=t&&t[2]?parseInt(t[2],10):0;return{name:s,vol:Number.isFinite(a)?a:0}}function cR(n){if(typeof n=="number")return n;if(n==null||n==="")return 0;const e=parseInt(n,10);return Number.isFinite(e)?e:0}function y_(){const n=new Date,e=n.getFullYear(),t=String(n.getMonth()+1).padStart(2,"0"),s=String(n.getDate()).padStart(2,"0");return`${e}-${t}-${s}`}function Eu(n){const e=(n==null?void 0:n.pageCount)??(n==null?void 0:n.PageCount)??"",t=String(e??"").trim();if(!t)return!0;const s=cR(t);return!Number.isFinite(s)||s<=0}function Ao(n,e=!1){const t=(n??"").toString().trim();return!t||!e&&t.toLowerCase()==="unknown"}function xo(n){const e=Ao(n==null?void 0:n.authors),t=Ao(n==null?void 0:n.publisher),s=Ao(n==null?void 0:n.date);return{authorMissing:e,publisherMissing:t,dateMissing:s,any:e||t||s}}function Tr(n){if(!n)return"";const e=String(n).trim();if(/^\d{4}-\d{2}-\d{2}$/.test(e))return e;const t=new Date(e);if(Number.isNaN(t.getTime()))return"";const s=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),l=String(t.getDate()).padStart(2,"0");return`${s}-${a}-${l}`}const uR=(n,e)=>{const t=kt(n.title||""),s=kt(e.title||""),a=t.name.localeCompare(s.name);return a!==0?a:t.vol-s.vol};function dR(n){const t=(n||"").match(/vol(?:ume)?\.?\s*(\d+)(?:\s*[-]\s*(\d+))?/i);if(!t)return[];const s=parseInt(t[1],10),a=t[2]?parseInt(t[2],10):s;if(!Number.isFinite(s))return[];const l=Number.isFinite(a)&&a>=s?a:s,d=[];for(let f=s;f<=l;f+=1)d.push(f);return d}function hR(){const{admin:n,user:e,role:t}=za(),s=n,a=(x,W={})=>{x&&gx(x,{email:(e==null?void 0:e.email)||"anonymous",name:(e==null?void 0:e.displayName)||"",context:"Manga",...W})},[l,d]=j.useState("library"),[f,m]=j.useState(()=>typeof window>"u"?"series":localStorage.getItem(g_)==="individual"?"individual":"series");j.useEffect(()=>{document.title="Manga | Library"},[]),j.useEffect(()=>{ye("")},[e]),j.useEffect(()=>{try{localStorage.setItem(g_,f)}catch(x){console.warn("Failed to persist manga view mode",x)}},[f]);const v=async()=>{const x=Date.now(),G=(()=>{try{const F=localStorage.getItem(m_);return Array.isArray(JSON.parse(F))?JSON.parse(F):[]}catch{return[]}})().filter(F=>x-F<lR);if(G.length>=p_){ye("Rate limit: please wait a bit (max 5 suggestions per hour).");return}if(!Fe.trim()){ye("Please enter a manga title or note before sending.");return}Me(!0),ye("");try{const F=`**Manga Suggestion**
${Fe.trim()}
From: ${(e==null?void 0:e.displayName)||(e==null?void 0:e.email)||(e==null?void 0:e.uid)||"anonymous user"}`;await Ra(Sn(ot,"suggestions"),{content:Fe.trim(),type:"manga",from:(e==null?void 0:e.displayName)||(e==null?void 0:e.email)||(e==null?void 0:e.uid)||"anonymous user",createdAt:new Date().toISOString()}),ye("Sent! I'll review your suggestion soon."),Qe("");const H=[...G,x].slice(-p_);localStorage.setItem(m_,JSON.stringify(H))}catch(F){console.error("Failed to send suggestion",F),ye("Failed to send suggestion. Please try again later.")}finally{Me(!1)}},[w,T]=j.useState([]),[I,U]=j.useState([]),[X,$]=j.useState([]),[O,se]=j.useState([]),[Te,xe]=j.useState(!1),[_e,V]=j.useState(!0),[ie,C]=j.useState(""),[P,A]=j.useState(""),[M,D]=j.useState(""),[N,b]=j.useState(!1),[J,ne]=j.useState(()=>new Set);j.useEffect(()=>{f==="series"&&N&&(typeof Ye>"u"||Ye===null)&&(b(!1),ne(new Set))},[f,N]);const[Re,he]=j.useState({open:!1,mode:"add",list:"library",data:{title:"",authors:"",publisher:"",demographic:"",genre:"",subGenre:"",date:"",cover:"",isbn:"",pageCount:"",rating:"",amountPaid:"",dateRead:"",datePurchased:"",msrp:"",special:!1,specialType:"",specialVolumes:"",collectiblePrice:"",amazonURL:"",read:!1},editingId:null,multiAdd:!1,startVol:"",endVol:""}),[le,Ie]=j.useState([]),[ve,Y]=j.useState(0),k=j.useMemo(()=>({author:Ao(Re.data.authors),publisher:Ao(Re.data.publisher),date:Ao(Re.data.date),page:Eu({pageCount:Re.data.pageCount})}),[Re.data]),[q,Ee]=j.useState({open:!1,index:0,items:[]}),[Le,De]=j.useState(!1),[Fe,Qe]=j.useState(""),[st,ye]=j.useState(""),[ce,Me]=j.useState(!1),[me,He]=j.useState(null),[Ye,Tt]=j.useState(null);j.useEffect(()=>{if(!!me||!!Ye||Re.open||q.open||Le){const W=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=W}}},[me,Ye,Re.open,q.open,Le]);const Ct=!!e&&t==="viewer";async function gt(){const x=await vs(Sn(ot,"library")),W=[];x.forEach(G=>{const F=G.data();W.push({id:G.id,title:F.title||"",authors:F.authors||"Unknown",publisher:F.publisher||"Unknown",demographic:F.demographic||"",genre:F.genre||"",subGenre:F.subGenre||"",date:Tr(F.date)||F.date||"Unknown",cover:F.cover||"",isbn:F.isbn||"",pageCount:F.pageCount!==void 0&&F.pageCount!==null?F.pageCount:"",rating:F.rating!==void 0&&F.rating!==null?F.rating:"",amountPaid:F.amountPaid!==void 0&&F.amountPaid!==null?F.amountPaid:"",dateRead:Tr(F.dateRead)||F.dateRead||"",datePurchased:Tr(F.datePurchased)||F.datePurchased||"",msrp:F.msrp!==void 0&&F.msrp!==null?F.msrp:"",specialType:F.specialType||"",specialVolumes:F.specialVolumes!==void 0&&F.specialVolumes!==null?F.specialVolumes:"",collectiblePrice:F.collectiblePrice!==void 0&&F.collectiblePrice!==null?F.collectiblePrice:"",read:!!F.read,amazonURL:F.amazonURL||"",hidden:!!F.hidden,kind:"library"})}),W.sort((G,F)=>{const H=kt(G.title),ue=kt(F.title),oe=H.name.localeCompare(ue.name);return oe!==0?oe:H.vol-ue.vol}),T(W),$(G=>{const F=new Set(G);return W.forEach(H=>F.add(H.title||"")),Array.from(F).filter(Boolean).sort()})}async function Nt(){const x=await vs(Sn(ot,"wishlist")),W=[];x.forEach(G=>{const F=G.data();W.push({id:G.id,title:F.title||"",authors:F.authors||"Unknown",publisher:F.publisher||"Unknown",date:Tr(F.date)||F.date||"Unknown",cover:F.cover||"",isbn:F.isbn||"",pageCount:F.pageCount!==void 0&&F.pageCount!==null?F.pageCount:"",rating:F.rating!==void 0&&F.rating!==null?F.rating:"",amountPaid:F.amountPaid!==void 0&&F.amountPaid!==null?F.amountPaid:"",datePurchased:Tr(F.datePurchased)||F.datePurchased||"",specialType:F.specialType||"",specialVolumes:F.specialVolumes!==void 0&&F.specialVolumes!==null?F.specialVolumes:"",collectiblePrice:F.collectiblePrice!==void 0&&F.collectiblePrice!==null?F.collectiblePrice:"",amazonURL:F.amazonURL||"",hidden:!!F.hidden,kind:"wishlist"})}),W.sort((G,F)=>{const H=kt(G.title),ue=kt(F.title),oe=H.name.localeCompare(ue.name);return oe!==0?oe:H.vol-ue.vol}),U(W),$(G=>{const F=new Set(G);return W.forEach(H=>F.add(H.title||"")),Array.from(F).filter(Boolean).sort()})}j.useEffect(()=>{let x=!1,W=!1,G=!1;const F=async()=>{if(!x)try{const Pe=await fetch("/base/manga-library-wishlist.json",{cache:"no-cache"});if(!Pe.ok)throw new Error("fallback fetch failed");const Oe=await Pe.json(),de=Array.isArray(Oe.library)?Oe.library:[],Ze=Array.isArray(Oe.wishlist)?Oe.wishlist:[];T(de.map((je,ut)=>({id:je.id||`offline-lib-${ut}`,title:je.title||"",authors:je.authors||"Unknown",publisher:je.publisher||"Unknown",demographic:je.demographic||"",genre:je.genre||"",subGenre:je.subGenre||"",date:Tr(je.date)||je.date||"Unknown",cover:je.cover||"",isbn:je.isbn||"",pageCount:je.pageCount??"",rating:je.rating??"",amountPaid:je.amountPaid??"",dateRead:Tr(je.dateRead)||je.dateRead||"",datePurchased:Tr(je.datePurchased)||je.datePurchased||"",msrp:je.msrp??"",specialType:je.specialType||"",specialVolumes:je.specialVolumes??"",collectiblePrice:je.collectiblePrice??"",amazonURL:je.amazonURL||"",read:!!je.read,hidden:!!je.hidden,kind:"library"}))),U(Ze.map((je,ut)=>({id:je.id||`offline-wish-${ut}`,title:je.title||"",authors:je.authors||"Unknown",publisher:je.publisher||"Unknown",demographic:je.demographic||"",genre:je.genre||"",subGenre:je.subGenre||"",date:Tr(je.date)||je.date||"Unknown",cover:je.cover||"",isbn:je.isbn||"",pageCount:je.pageCount??"",rating:je.rating??"",amountPaid:je.amountPaid??"",dateRead:Tr(je.dateRead)||je.dateRead||"",datePurchased:Tr(je.datePurchased)||je.datePurchased||"",msrp:je.msrp??"",specialType:je.specialType||"",specialVolumes:je.specialVolumes??"",collectiblePrice:je.collectiblePrice??"",amazonURL:je.amazonURL||"",read:!!je.read,hidden:!!je.hidden,kind:"wishlist"}))),C("")}catch(Ae){console.error("Offline fallback failed",Ae),C("Failed to load manga data from Firestore.")}finally{x||V(!1)}},H=()=>{W&&G&&!x&&V(!1)};if(!e)return;V(!0),C("");const ue=c_(Sn(ot,"library"),Ae=>{if(x)return;const Pe=[];Ae.forEach(Oe=>{const de=Oe.data();Pe.push({id:Oe.id,title:de.title||"",authors:de.authors||"Unknown",publisher:de.publisher||"Unknown",demographic:de.demographic||"",genre:de.genre||"",subGenre:de.subGenre||"",date:de.date||"Unknown",cover:de.cover||"",isbn:de.isbn||"",pageCount:de.pageCount!==void 0&&de.pageCount!==null?de.pageCount:"",rating:de.rating!==void 0&&de.rating!==null?de.rating:"",amountPaid:de.amountPaid!==void 0&&de.amountPaid!==null?de.amountPaid:"",dateRead:de.dateRead||"",datePurchased:de.datePurchased||"",msrp:de.msrp!==void 0&&de.msrp!==null?de.msrp:"",specialType:de.specialType||"",specialVolumes:de.specialVolumes!==void 0&&de.specialVolumes!==null?de.specialVolumes:"",collectiblePrice:de.collectiblePrice!==void 0&&de.collectiblePrice!==null?de.collectiblePrice:"",read:!!de.read,amazonURL:de.amazonURL||"",hidden:!!de.hidden,kind:"library"})}),Pe.sort((Oe,de)=>{const Ze=kt(Oe.title),je=kt(de.title),ut=Ze.name.localeCompare(je.name);return ut!==0?ut:Ze.vol-je.vol}),T(Pe),$(Oe=>{const de=new Set(Oe);return Pe.forEach(Ze=>de.add(Ze.title||"")),Array.from(de).filter(Boolean).sort()}),W=!0,H()},async Ae=>{console.error("Library listener failed",Ae),x||(C("Failed to load manga data from Firestore."),await F())}),oe=c_(Sn(ot,"wishlist"),Ae=>{if(x)return;const Pe=[];Ae.forEach(Oe=>{const de=Oe.data();Pe.push({id:Oe.id,title:de.title||"",authors:de.authors||"Unknown",publisher:de.publisher||"Unknown",demographic:de.demographic||"",genre:de.genre||"",subGenre:de.subGenre||"",date:de.date||"Unknown",cover:de.cover||"",isbn:de.isbn||"",pageCount:de.pageCount!==void 0&&de.pageCount!==null?de.pageCount:"",rating:de.rating!==void 0&&de.rating!==null?de.rating:"",amountPaid:de.amountPaid!==void 0&&de.amountPaid!==null?de.amountPaid:"",datePurchased:de.datePurchased||"",specialType:de.specialType||"",specialVolumes:de.specialVolumes!==void 0&&de.specialVolumes!==null?de.specialVolumes:"",collectiblePrice:de.collectiblePrice!==void 0&&de.collectiblePrice!==null?de.collectiblePrice:"",amazonURL:de.amazonURL||"",hidden:!!de.hidden,kind:"wishlist"})}),Pe.sort((Oe,de)=>{const Ze=kt(Oe.title),je=kt(de.title),ut=Ze.name.localeCompare(je.name);return ut!==0?ut:Ze.vol-je.vol}),U(Pe),$(Oe=>{const de=new Set(Oe);return Pe.forEach(Ze=>de.add(Ze.title||"")),Array.from(de).filter(Boolean).sort()}),G=!0,H()},async Ae=>{console.error("Wishlist listener failed",Ae),x||(C("Failed to load manga data from Firestore."),await F())});return()=>{x=!0,ue==null||ue(),oe==null||oe()}},[e]);const Qt=j.useMemo(()=>{const x=P.trim().toLowerCase();return x?w.filter(W=>[W.title,W.authors,W.publisher,W.isbn,W.date,String(W.pageCount??"")].join(" ").toLowerCase().includes(x)):w},[w,P]),tn=j.useMemo(()=>s&&Te?Qt:Qt.filter(x=>!x.hidden),[Qt,s,Te]),nn=j.useMemo(()=>{const x=M.trim().toLowerCase();return x?I.filter(W=>[W.title,W.authors,W.publisher,W.isbn,W.date,String(W.pageCount??"")].join(" ").toLowerCase().includes(x)):I},[I,M]),lr=j.useMemo(()=>s&&Te?nn:nn.filter(x=>!x.hidden),[nn,s,Te]),rn=x=>{m(x==="individual"?"individual":"series"),ne(new Set),b(!1)},Kn=x=>{if(!(x!=null&&x.length))return;const W=(G,F)=>{let H=[...G];return x.filter(ue=>ue.target===F).forEach(ue=>{const oe=H.findIndex(Pe=>Pe.id===ue.id),Ae={...oe>=0?H[oe]:{},...ue.payload,id:ue.id,kind:F};oe>=0?H[oe]=Ae:H.push(Ae)}),H.sort(uR),H};T(G=>W(G,"library")),U(G=>W(G,"wishlist"))},Ot=x=>{b(W=>{const G=!W;if(G){const F=new Set((x||[]).map(H=>H.id));ne(H=>new Set([...H].filter(ue=>F.has(ue))))}else ne(new Set);return G})};function $t(){s&&(b(x=>!x),ne(new Set))}function On(x){ne(W=>{const G=new Set(W);return G.has(x)?G.delete(x):G.add(x),G})}async function cr(x,W=null){if(!s){alert("Multi-select actions require admin access.");return}const G=Array.from(J);if(!G.length){alert("Select at least one item first.");return}const F=l==="library"?"library":"wishlist",H=W||(F==="library"?"wishlist":"library"),ue=F==="library";try{if(x==="move"){const oe=F==="library"?w:I;if(!window.confirm(`Move ${G.length} item(s) from ${F==="library"?"Library":"Wishlist"} to ${H==="library"?"Library":"Wishlist"}?`))return;for(const Ae of G){const Pe=oe.find(de=>de.id===Ae);if(!Pe)continue;const Oe=H==="library"?{title:Pe.title,authors:Pe.authors,publisher:Pe.publisher,date:Pe.date,pageCount:Pe.pageCount||"",cover:Pe.cover,amountPaid:"",read:!1,rating:"",msrp:"",collectiblePrice:"",specialType:"",specialVolumes:"",isbn:Pe.isbn||"",demographic:Pe.demographic||"",genre:Pe.genre||"",subGenre:Pe.subGenre||"",hidden:!!Pe.hidden,datePurchased:Pe.datePurchased||"",dateRead:Pe.dateRead||""}:{title:Pe.title,authors:Pe.authors,publisher:Pe.publisher,date:Pe.date,pageCount:Pe.pageCount||"",cover:Pe.cover,amazonURL:Pe.amazonURL||"",hidden:!!Pe.hidden,datePurchased:"",read:!1,rating:"",msrp:"",collectiblePrice:"",specialType:"",specialVolumes:"",isbn:"",demographic:"",genre:"",subGenre:""};await Ra(Sn(ot,H),Oe),await Na(Dt(ot,F,Ae))}a(`Moved ${G.length} item${G.length===1?"":"s"} from ${F==="library"?"Library":"Wishlist"} to ${H==="library"?"Library":"Wishlist"}`,{action:"move",list:F==="library"?"Library":"Wishlist",details:{count:G.length,from:F,to:H}})}else if(x==="markRead"&&ue){for(const oe of G)await _s(Dt(ot,"library",oe),{read:!0,dateRead:y_()});a(`Marked ${G.length} library book${G.length===1?"":"s"} as read`,{action:"markRead",list:"Library",details:{count:G.length}})}else if(x==="markUnread"&&ue){for(const oe of G)await _s(Dt(ot,"library",oe),{read:!1,dateRead:"",rating:""});a(`Marked ${G.length} library book${G.length===1?"":"s"} as unread`,{action:"markUnread",list:"Library",details:{count:G.length}})}else if(x==="delete"){const oe=ue?"library":"wishlist";if(!window.confirm(`Delete ${G.length} item(s) from ${ue?"Library":"Wishlist"}?`))return;for(const Ae of G)await Na(Dt(ot,oe,Ae));a(`Deleted ${G.length} item${G.length===1?"":"s"} from ${oe==="library"?"Library":"Wishlist"}`,{action:"delete-multi",list:oe==="library"?"Library":"Wishlist",details:{count:G.length}})}await Promise.all([gt(),Nt()]),ne(new Set),b(!1)}catch(oe){console.error(oe),alert("Failed to apply multi-select action.")}}function Cn(x){He(x)}function Fn(){He(null)}function Yt(x){const W=Un.filter(G=>(kt(G.title||"").name||(G.title||"").toLowerCase()||G.id)===x.key).sort((G,F)=>kt(G.title).vol-kt(F.title).vol);Tt({series:x,volumes:W})}function es(){Tt(null)}const In=()=>{he(x=>({...x,open:!1,mode:"add",editingId:null,data:{title:"",authors:"",publisher:"",demographic:"",genre:"",subGenre:"",date:"",cover:"",isbn:"",pageCount:"",rating:"",amountPaid:"",dateRead:"",datePurchased:"",msrp:"",special:!1,specialType:"",specialVolumes:"",collectiblePrice:"",amazonURL:"",read:!1,hidden:!1},multiAdd:!1,startVol:"",endVol:""})),Ie([]),Y(0)},gn=j.useMemo(()=>{const x=new Map;return[...w,...I].forEach(W=>{const G=kt(W.title||"");if(!G.name)return;const F=(W.title||"").replace(/,?\s*Vol\.?\s*\d+.*/i,"").trim()||W.title||G.name;if(!x.has(G.name))x.set(G.name,{display:F,maxVol:G.vol,authors:W.authors||"",publisher:W.publisher||"",demographic:W.demographic||""});else{const H=x.get(G.name);H.maxVol=Math.max(H.maxVol,G.vol),!H.authors&&W.authors&&(H.authors=W.authors),!H.publisher&&W.publisher&&(H.publisher=W.publisher),!H.demographic&&W.demographic&&(H.demographic=W.demographic)}}),x},[w,I]),ts=x=>{he(W=>({...W,open:!0,mode:"add",list:x,editingId:null,data:{...W.data,title:"",list:x}})),Ie([{kind:"new",id:null,data:{title:"",authors:"",publisher:"",demographic:"",genre:"",subGenre:"",date:"",cover:"",isbn:"",pageCount:"",rating:"",amountPaid:"",dateRead:"",datePurchased:"",msrp:"",specialType:"",specialVolumes:"",collectiblePrice:"",amazonURL:"",read:!1}}]),Y(0)},Ts=x=>{const W={open:!0,mode:"edit",list:x.kind==="wishlist"?"wishlist":"library",editingId:x.id,data:{title:x.title||"",authors:x.authors||"",publisher:x.publisher||"",demographic:x.demographic||"",genre:x.genre||"",subGenre:x.subGenre||"",date:x.date||"",cover:x.cover||"",isbn:x.isbn||"",pageCount:x.pageCount||"",rating:x.rating||"",amountPaid:x.amountPaid||"",dateRead:x.dateRead||"",datePurchased:x.datePurchased||"",msrp:x.msrp||"",special:!!(x.specialType||x.specialVolumes||x.collectiblePrice),specialType:x.specialType||"",specialVolumes:x.specialVolumes||"",collectiblePrice:x.collectiblePrice||"",amazonURL:x.amazonURL||"",read:!!x.read,hidden:!!x.hidden}};he(W),Ie([{kind:"edit",id:x.id,data:{...W.data}}]),Y(0)},Pt=(x,W,G="text")=>{if(he(F=>{const H={...F.data,[x]:G==="checkbox"?!!W:W};if(x==="special"&&!W&&(H.specialType="",H.specialVolumes="",H.collectiblePrice=""),x==="specialType"&&(W==="collectible"?H.specialVolumes="":(W==="specialEdition"||(H.specialVolumes=""),H.collectiblePrice="")),x==="title"){const ue=kt(W||"");if(ue.name&&gn.has(ue.name)){const oe=gn.get(ue.name);H.authors=oe.authors||H.authors,H.publisher=oe.publisher||H.publisher,H.demographic=oe.demographic||H.demographic}}return{...F,data:H}}),Ie(F=>{if(!F.length)return F;const H=[...F],ue={...H[ve]};return ue.data={...ue.data,[x]:G==="checkbox"?!!W:W},H[ve]=ue,H}),x==="title"){const F=String(W||"").trim().toLowerCase();if(!F)se([]);else{const H=[];gn.forEach(ue=>{if(ue.display.toLowerCase().includes(F)){const oe=ue.maxVol>0?ue.maxVol+1:1;H.push(`${ue.display}, Vol. ${oe}`)}}),se(H.slice(0,6))}}},pr=x=>{le[x]&&(Y(x),he(W=>{const G=le[x];return{...W,data:{...G.data}}}))},Ss=()=>{const x=Re.data.title||"",W=kt(x);if(!W.name){alert("Provide a title with a volume number first (e.g., Series, Vol. 1).");return}const G={kind:Re.mode,id:Re.editingId,data:{...Re.data}},F=le.length?[...le]:[];F.length?F[ve]=G:F.push(G);const H=x.replace(/,?\s*Vol\.?\s*\d+.*/i,"").trim()||x;let ue=W.vol||0;const oe=gn.get(W.name);oe&&oe.maxVol>ue&&(ue=oe.maxVol),F.forEach(de=>{const Ze=kt(de.data.title||"");Ze.name===W.name&&(ue=Math.max(ue,Ze.vol||0))});const Ae=(ue||0)+1,Oe={title:`${H}, Vol. ${Ae}`,authors:Re.data.authors,publisher:Re.data.publisher,demographic:Re.data.demographic,genre:Re.data.genre,subGenre:Re.data.subGenre,msrp:Re.data.msrp,hidden:Re.data.hidden,cover:"",isbn:"",pageCount:"",rating:"",amountPaid:"",date:"",dateRead:"",datePurchased:"",special:!1,specialType:"",specialVolumes:"",collectiblePrice:"",amazonURL:"",read:!1};F.push({kind:"new",id:null,data:Oe}),Ie(F),Y(F.length-1),he(de=>({...de,mode:"add",data:Oe}))};async function Qn(){if(!s)return;const{list:x}=Re,W=x||"library",G=le.length>0?le:[{kind:Re.mode,id:Re.editingId,data:Re.data}],F=H=>{const ue=(H.title||"").trim(),oe=kt(ue),Ae=gn.get(oe.name)||{},Pe=(H.authors||"").trim()||Ae.authors||"",Oe=(H.publisher||"").trim()||Ae.publisher||"",de=(H.demographic||"").trim()||Ae.demographic||"",Ze=(H.genre||"").trim()||Ae.genre||"",je=(H.subGenre||"").trim()||Ae.subGenre||"";return{title:ue,authors:Pe,publisher:Oe,demographic:de,genre:Ze,subGenre:je,date:Tr(H.date||""),cover:(H.cover||"").trim(),isbn:W==="wishlist"?"":(H.isbn||"").trim(),pageCount:H.pageCount===""?"":Number(H.pageCount),rating:W==="wishlist"||H.rating===""?"":Math.max(.5,Math.min(5,Number(H.rating))),amountPaid:H.amountPaid===""?"":Number(H.amountPaid),dateRead:Tr(H.dateRead||""),datePurchased:Tr(H.datePurchased||""),msrp:W==="wishlist"||H.msrp===""?"":Number(H.msrp),special:W==="wishlist"?!1:!!(H.special&&(H.specialType||"").trim()),specialType:W==="wishlist"||!(H.special&&(H.specialType||"").trim())?"":(H.specialType||"").trim(),specialVolumes:W==="wishlist"?"":H.special&&H.specialType==="specialEdition"?H.specialVolumes===""?"":Number(H.specialVolumes):"",collectiblePrice:W==="wishlist"?"":H.special&&H.specialType==="collectible"?H.collectiblePrice===""?"":Number(H.collectiblePrice):"",amazonURL:(H.amazonURL||"").trim(),read:W==="wishlist"?!1:!!H.read,hidden:!!H.hidden,kind:x}};try{const H=await Promise.all(G.map(async ue=>{const oe=F(ue.data);if(W==="library"&&ue.kind!=="edit"){const Ae=kt(oe.title).name,Pe=w.filter(de=>kt(de.title||de.Title||"").name===Ae),Oe=Pe[0];if(Oe&&(oe.demographic=oe.demographic||Oe.demographic||Oe.Demographic||"",oe.genre=oe.genre||Oe.genre||Oe.Genre||"",oe.subGenre=oe.subGenre||Oe.subGenre||Oe.SubGenre||"",oe.msrp==="")){const de=Pe.map(Ze=>Number(Ze.msrp??Ze.MSRP)).filter(Ze=>Number.isFinite(Ze));de.length>0&&de.every(je=>je===de[0])&&(oe.msrp=de[0])}}if(!oe.title)throw alert("Title is required for every entry."),new Error("missing title");if(ue.kind==="edit"&&ue.id)return await _s(Dt(ot,W,ue.id),oe),{target:W,id:ue.id,payload:oe};{const Ae=await Ra(Sn(ot,W),oe);return{target:W,id:Ae.id,payload:oe}}}));Kn(H.filter(Boolean)),await Promise.all([gt(),Nt()]),a(`${Re.mode==="add"?"Added":"Saved"} ${G.length} item${G.length===1?"":"s"} in ${W==="library"?"Library":"Wishlist"}`,{action:Re.mode==="add"?"create":"update",list:W==="library"?"Library":"Wishlist",details:{entries:G.length,mode:Re.mode}}),In()}catch(H){console.error(H),alert("Failed to save entry.")}}async function Yn(x,W){if(!s||!window.confirm("Delete this entry?"))return;const F=(W==="wishlist"?I:w).find(H=>H.id===x);try{await Na(Dt(ot,W,x)),await Promise.all([gt(),Nt()]),a(`Deleted "${(F==null?void 0:F.title)||"Untitled"}" from ${W==="library"?"Library":"Wishlist"}`,{action:"delete-single",list:W==="library"?"Library":"Wishlist",details:{title:(F==null?void 0:F.title)||"Untitled"}})}catch(H){console.error(H),alert("Failed to delete entry.")}}const[Ir,Pn]=j.useState(!1),Pr=()=>Ee({open:!1,index:0,items:[]});async function Jn(x,W,G={}){if(!(x!=null&&x.id))return;const F=x.kind==="wishlist"?"wishlist":"library";Pn(!0);try{await _s(Dt(ot,F,x.id),W),Kn([{target:F,id:x.id,payload:W}]),await Promise.all([gt(),Nt()]),a(`Updated "${x.title||"Untitled"}" in ${F==="library"?"Library":"Wishlist"}`,{action:G.action||"inline-update",list:F==="library"?"Library":"Wishlist",details:G.details||{title:x.title||"Untitled",fields:Object.keys(W||{}).join(", "),rating:W.rating??void 0}}),He(H=>H&&H.id===x.id?{...H,...W}:H)}catch(H){console.error(H),alert("Failed to update entry.")}finally{Pn(!1)}}const Ws=(x,W)=>{const G=W===""?"":Math.max(.5,Math.min(5,Number(W)));Jn(x,{rating:G},{action:"rating",details:{title:x.title||"Untitled",rating:G}})},mr=(x,W)=>{if(!x)return;const G=W?{read:!0,dateRead:y_(),rating:x.rating??""}:{read:!1,dateRead:"",rating:""};Jn(x,G,{action:W?"mark-read":"mark-unread",details:{title:x.title||"Untitled",dateRead:W?G.dateRead:"cleared",rating:x.rating||"not set"}})},Gs=()=>{if(!J.size){alert("Select at least one entry first.");return}const W=[...w,...I].filter(F=>J.has(F.id));if(!W.length){alert("No items selected.");return}const G=W.map(F=>({id:F.id,kind:F.kind||(l==="wishlist"?"wishlist":"library"),data:{title:F.title||"",authors:F.authors||"",publisher:F.publisher||"",demographic:F.demographic||"",genre:F.genre||"",subGenre:F.subGenre||"",date:F.date||"",cover:F.cover||"",isbn:F.isbn||"",pageCount:F.pageCount||"",rating:F.rating||"",amountPaid:F.amountPaid||"",dateRead:F.dateRead||"",datePurchased:F.datePurchased||"",msrp:F.msrp||"",special:!!(F.specialType||F.specialVolumes||F.collectiblePrice),specialType:F.specialType||"",specialVolumes:F.specialVolumes||"",collectiblePrice:F.collectiblePrice||"",amazonURL:F.amazonURL||"",read:!!F.read,hidden:!!F.hidden}}));Ee({open:!0,index:0,items:G})},rt=(x,W,G="text")=>{Ee(F=>{const H=[...F.items],ue={...H[F.index]},oe={...ue.data,[x]:G==="checkbox"?!!W:W};return x==="special"&&!W&&(oe.specialType="",oe.specialVolumes="",oe.collectiblePrice=""),x==="specialType"&&(W==="collectible"?oe.specialVolumes="":(W==="specialEdition"||(oe.specialVolumes=""),oe.collectiblePrice="")),ue.data=oe,H[F.index]=ue,{...F,items:H}})},Xn=()=>{Ee(x=>({...x,index:Math.min(x.index+1,x.items.length-1)}))},Nn=()=>{Ee(x=>({...x,index:Math.max(x.index-1,0)}))};async function ns(){if(!s)return;const x=q.items;if(!x.length){Pr();return}try{const W=await Promise.all(x.map(async G=>{const H=!(G.kind==="wishlist")&&!!(G.data.special&&(G.data.specialType||"").trim()),ue={...G.data,pageCount:G.data.pageCount===""?"":Number(G.data.pageCount),rating:G.data.rating===""?"":Math.max(.5,Math.min(5,Number(G.data.rating))),amountPaid:G.data.amountPaid===""?"":Number(G.data.amountPaid),msrp:G.data.msrp===""?"":Number(G.data.msrp),special:H,specialType:H?G.data.specialType:"",collectiblePrice:H&&G.data.specialType==="collectible"?G.data.collectiblePrice===""?"":Number(G.data.collectiblePrice):"",specialVolumes:H&&G.data.specialType==="specialEdition"?G.data.specialVolumes===""?"":Number(G.data.specialVolumes):"",datePurchased:G.data.datePurchased||"",amazonURL:G.data.amazonURL||"",read:!!G.data.read},oe=G.kind==="wishlist"?"wishlist":"library";return await _s(Dt(ot,oe,G.id),ue),{target:oe,id:G.id,payload:ue}}));Kn(W.filter(Boolean)),await Promise.all([gt(),Nt()]),ne(new Set),b(!1),a(`Bulk edited ${x.length} item${x.length===1?"":"s"} in Library/Wishlist`,{action:"bulk-edit",list:"Library/Wishlist",details:{count:x.length}}),Pr()}catch(W){console.error(W),alert("Failed to save bulk edits.")}}const Rn=x=>{const W=new Map;return x.forEach(G=>{const F=kt(G.title||""),H=F.name||(G.title||"").toLowerCase()||G.id,ue=gn.get(F.name)||null,oe=(ue==null?void 0:ue.display)||(G.title||"").replace(/,?\s*Vol\.?\s*\d+.*/i,"").trim()||G.title||"Untitled",Ae=xo(G),Pe=dR(G.title||""),Oe=Number.isFinite(F.vol)?F.vol:0,de=Pe.length>0?Pe:Oe>0?[Oe]:[],Ze=de.length?de[0]:0,je=Eu(G);if(!W.has(H))W.set(H,{id:`series-${H}`,key:H,title:oe,authors:G.authors&&G.authors!=="Unknown"?G.authors:(ue==null?void 0:ue.authors)||"",publisher:G.publisher&&G.publisher!=="Unknown"?G.publisher:(ue==null?void 0:ue.publisher)||"",demographic:(ue==null?void 0:ue.demographic)||G.demographic||"",cover:G.cover||"",count:1,readCount:G.read?1:0,minVol:Ze,maxVol:Ze,representative:G,volumes:[...de],missingPageCount:je?1:0,missingMetaCount:Ae.any?1:0,missingVolumeCount:je||Ae.any?1:0});else{const ut=W.get(H);if(ut.count+=1,G.read&&(ut.readCount+=1),je&&(ut.missingPageCount+=1),Ae.any&&(ut.missingMetaCount+=1),(je||Ae.any)&&(ut.missingVolumeCount+=1),de.length){const ur=Math.min(...de),Qs=Math.max(...de);ut.minVol=Math.min(ut.minVol,ur),ut.maxVol=Math.max(ut.maxVol,Qs),ut.volumes.push(...de)}!ut.cover&&G.cover&&(ut.cover=G.cover),!ut.authors&&G.authors&&G.authors!=="Unknown"&&(ut.authors=G.authors),!ut.publisher&&G.publisher&&G.publisher!=="Unknown"&&(ut.publisher=G.publisher)}}),Array.from(W.values())},yn=x=>{const W=Array.from(new Set((x||[]).filter(oe=>Number.isFinite(oe)&&oe>=0))).sort((oe,Ae)=>oe-Ae);if(!W.length)return null;const G=[];let F=W[0],H=W[0];for(let oe=1;oe<W.length;oe+=1){const Ae=W[oe];if(Ae===H+1){H=Ae;continue}G.push([F,H]),F=Ae,H=Ae}if(G.push([F,H]),G.length===1){const[oe,Ae]=G[0];return oe===Ae?`Vol. ${oe}`:`Vol. ${oe}-${Ae}`}return`Vols. ${G.map(([oe,Ae])=>oe===Ae?`${oe}`:`${oe}-${Ae}`).join(", ")}`};function An(x){const W=J.has(x.id),G=x.kind==="library",F=s&&Eu(x),H=s?xo(x):{any:!1,authorMissing:!1,publisherMissing:!1,dateMissing:!1},ue=()=>{N&&s?On(x.id):Cn(x)};return o.jsxs("div",{className:"manga-card"+(x.read&&G?" read":"")+(W?" multiselect-selected":"")+(F?" missing-page":"")+(H.any?" missing-meta":""),onClick:ue,children:[o.jsx("div",{className:"manga-card-cover-wrap",children:o.jsx("img",{src:x.cover||"https://imgur.com/chUgq4W.png",alt:"Cover",loading:"lazy",decoding:"async"})}),o.jsxs("div",{className:"manga-card-body",children:[o.jsx("div",{className:"manga-card-title",children:x.title||"Untitled"}),o.jsxs("div",{className:"manga-card-meta",children:[o.jsx("span",{className:H.authorMissing?"missing-field":"",children:x.authors&&x.authors!=="Unknown"?x.authors:H.authorMissing?"Missing author":""}),o.jsx("br",{}),o.jsx("span",{className:H.publisherMissing?"missing-field":"",children:x.publisher&&x.publisher!=="Unknown"?x.publisher:H.publisherMissing?"Missing publisher":""}),o.jsx("br",{}),o.jsx("span",{className:H.dateMissing?"missing-field":"",children:x.date&&x.date!=="Unknown"?x.date:H.dateMissing?"Missing date":""})]}),x.isbn&&o.jsxs("div",{className:"manga-card-isbn",children:["ISBN: ",x.isbn]}),s&&o.jsxs("div",{className:"manga-card-actions",children:[o.jsx("button",{type:"button",className:"manga-btn mini",onClick:oe=>{oe.stopPropagation(),Ts(x)},children:"Edit"}),o.jsx("button",{type:"button",className:"manga-btn mini danger",onClick:oe=>{oe.stopPropagation(),Yn(x.id,x.kind==="wishlist"?"wishlist":"library")},children:"Delete"})]})]})]},x.id)}function bs(x){var Ae;const W=yn(x.volumes),G=`${x.count} volume${x.count===1?"":"s"}`;x.readCount>=x.count&&x.count>0||`${x.readCount}${x.count}`;const F=x.readCount>=x.count&&x.count>0,H=s&&x.missingVolumeCount||0,ue=H>0,oe=[x.authors&&x.authors!=="Unknown"?x.authors:null,x.publisher&&x.publisher!=="Unknown"?x.publisher:null,W?`${G} - ${W}`:G].filter(Boolean);return o.jsxs("div",{className:"manga-card series-view"+(F?" read":"")+(ue?" missing-page missing-meta":""),onClick:()=>Yt(x),children:[ue&&o.jsx("div",{className:"missing-page-badge",title:"Volumes missing required data",children:H}),o.jsx("div",{className:"manga-card-cover-wrap",children:o.jsx("img",{src:x.cover||((Ae=x.representative)==null?void 0:Ae.cover)||"https://imgur.com/chUgq4W.png",alt:"Cover",loading:"lazy",decoding:"async"})}),o.jsxs("div",{className:"manga-card-body",children:[o.jsx("div",{className:"manga-card-title",children:x.title||"Untitled Series"}),o.jsx("div",{className:"manga-card-meta",children:oe.map((Pe,Oe)=>o.jsxs(tp.Fragment,{children:[Pe,o.jsx("br",{})]},Pe+Oe))}),o.jsx("div",{className:"manga-card-series-count",children:G})]})]},x.id)}const Cs=({value:x,onChange:W,interactive:G=!0})=>{const[F,H]=j.useState(null),ue=Math.max(0,Math.min(5,Number(x)||0)),oe=G&&F!=null?F:ue,Ae=Array.from({length:10},(Ze,je)=>(je+1)*.5),Pe=5,Oe=Array.from({length:Pe},(Ze,je)=>Math.max(0,Math.min(1,oe-je))),de=G&&typeof W=="function";return o.jsxs("div",{className:`star-shell${de?"":" read-only"}`,role:"group","aria-label":"Rating",children:[o.jsxs("div",{className:"star-visual",style:{"--star-count":Pe},children:[o.jsx("div",{className:"star-row",children:Oe.map((Ze,je)=>o.jsxs("div",{className:"star-icon",children:[o.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",className:"star-base",children:o.jsx("path",{d:"M12 2.5l2.9 5.88 6.5.95-4.7 4.58 1.1 6.43L12 17.9l-5.8 3.44 1.1-6.43-4.7-4.58 6.5-.95L12 2.5z"})}),o.jsx("div",{className:"star-fill",style:{"--pct":`${(Math.max(0,Math.min(1,Ze))*100).toFixed(1)}%`},children:o.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:o.jsx("path",{d:"M12 2.5l2.9 5.88 6.5.95-4.7 4.58 1.1 6.43L12 17.9l-5.8 3.44 1.1-6.43-4.7-4.58 6.5-.95L12 2.5z"})})})]},je))}),de&&o.jsx("div",{className:"star-hit",children:Ae.map(Ze=>o.jsx("button",{type:"button","aria-label":`${Ze} stars`,onMouseEnter:()=>H(Ze),onMouseLeave:()=>H(null),onClick:()=>W(Ze)},Ze))})]}),o.jsx("div",{className:"star-value",children:oe?oe.toFixed(1):"--"}),de&&o.jsx("button",{type:"button",className:"star-clear",onClick:()=>W(""),"aria-label":"Clear rating",children:"clear"})]})},Un=l==="library"?tn:lr,Fr=l==="library"?w:I,Ft=j.useMemo(()=>Rn(Un),[Un,gn]),rs=j.useMemo(()=>Rn(Fr),[Fr,gn]);j.useEffect(()=>{if(!me&&!Ye)return;const x=[...w,...I];if(me){const W=x.find(G=>G.id===me.id);W?(W.title!==me.title||W.isbn!==me.isbn||W.publisher!==me.publisher||W.authors!==me.authors||W.date!==me.date||W.pageCount!==me.pageCount||W.amountPaid!==me.amountPaid||W.msrp!==me.msrp||W.rating!==me.rating||W.read!==me.read||W.amazonURL!==me.amazonURL)&&He(W):He(null)}if(Ye){const W=Ft.find(oe=>oe.key===Ye.series.key);if(!W){Tt(null);return}const G=Un.filter(oe=>(kt(oe.title||"").name||(oe.title||"").toLowerCase()||oe.id)===W.key).sort((oe,Ae)=>kt(oe.title).vol-kt(Ae.title).vol),F=G.length===Ye.volumes.length&&G.every((oe,Ae)=>{var Pe;return((Pe=Ye.volumes[Ae])==null?void 0:Pe.id)===oe.id}),H=G.length!==Ye.volumes.length||G.some((oe,Ae)=>{const Pe=Ye.volumes[Ae];return!Pe||Pe.id!==oe.id?!0:Pe.title!==oe.title||Pe.authors!==oe.authors||Pe.publisher!==oe.publisher||Pe.date!==oe.date||Pe.isbn!==oe.isbn||Pe.cover!==oe.cover||Pe.read!==oe.read||Pe.pageCount!==oe.pageCount||Pe.amountPaid!==oe.amountPaid||Pe.msrp!==oe.msrp||Pe.rating!==oe.rating}),ue=W.title!==Ye.series.title||W.authors!==Ye.series.authors||W.publisher!==Ye.series.publisher||W.count!==Ye.series.count;(H||ue||!F)&&Tt({series:W,volumes:G})}},[w,I,me,Ye,Un,Ft]);const un=f==="series"?Ft:Un;f==="series"?Ft.length:Un.length,f==="series"?rs.length:Fr.length;const Nr=(x,W)=>{if(!x.length)return;const G=Array.from(x.reduce((Pe,Oe)=>(Object.keys(Oe).forEach(de=>Pe.add(de)),Pe),new Set)),F=Pe=>{const Oe=Pe==null?"":String(Pe);return/[",\n]/.test(Oe)?`"${Oe.replace(/"/g,'""')}"`:Oe},H=[G.join(",")].concat(x.map(Pe=>G.map(Oe=>F(Pe[Oe])).join(","))),ue=new Blob([H.join(`
`)],{type:"text/csv"}),oe=URL.createObjectURL(ue),Ae=document.createElement("a");Ae.href=oe,Ae.download=W,Ae.click(),URL.revokeObjectURL(oe)},qs=async(x,W)=>{const G=(H,ue="image")=>(H||"").toString().toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"").slice(0,100)||ue,F=x.filter(H=>H.cover).map((H,ue)=>({url:H.cover,name:G(H.title||`manga-${ue+1}`,`manga-${ue+1}`)}));if(!F.length){alert("No images found to download.");return}try{const H=(await pc(async()=>{const{default:je}=await import("https://cdn.jsdelivr.net/npm/jszip@3.10.1/+esm");return{default:je}},[])).default,ue=new H,oe=ue.folder("images"),Ae={},Pe=F.map(async(je,ut)=>{try{const Qs=await(await fetch(je.url)).blob(),_n=(je.url.split(".").pop()||"jpg").split(/[?#]/)[0],Jt=je.name||`image-${ut+1}`;Ae[Jt]=(Ae[Jt]||0)+1;const as=Ae[Jt]>1?`-${Ae[Jt]}`:"";oe.file(`${Jt}${as}.${_n}`,Qs)}catch(ur){console.warn("Failed to fetch image",je.url,ur)}});await Promise.all(Pe);const Oe=await ue.generateAsync({type:"blob"}),de=URL.createObjectURL(Oe),Ze=document.createElement("a");Ze.href=de,Ze.download=W,Ze.click(),URL.revokeObjectURL(de)}catch(H){console.error("Zip download failed",H),alert("Failed to create zip. Please try again.")}},Ur=(x,W)=>{const G=new Blob([JSON.stringify(x,null,2)],{type:"application/json"}),F=URL.createObjectURL(G),H=document.createElement("a");H.href=F,H.download=W,H.click(),URL.revokeObjectURL(F)},ss=x=>({title:x.title||"",authors:x.authors||"",publisher:x.publisher||"",demographic:x.demographic||"",genre:x.genre||"",subGenre:x.subGenre||"",date:x.date||"",pageCount:x.pageCount??"",cover:x.cover||"",amountPaid:x.amountPaid??"",read:!!x.read,rating:x.rating??"",dateRead:x.dateRead||"",datePurchased:x.datePurchased||"",msrp:x.msrp??"",collectiblePrice:x.collectiblePrice??"",specialType:x.specialType||"",specialVolumes:x.specialVolumes??"",isbn:x.isbn||"",amazonURL:x.amazonURL||"",hidden:!!x.hidden}),vn=x=>{const G=kt(x.title||"").name;if(!G)return"";const H=[...w,...I].find(ue=>{const Ae=kt(ue.title||"").name===G,Pe=ue.msrp!==void 0&&ue.msrp!==null&&ue.msrp!=="";return Ae&&Pe});return H?H.msrp:""},Hs=x=>{const G=kt(x.title||"").name;if(!G)return{demographic:"",genre:"",subGenre:""};const H=[...w,...I].find(ue=>kt(ue.title||"").name===G&&(ue.demographic||ue.genre||ue.subGenre));return{demographic:(H==null?void 0:H.demographic)||"",genre:(H==null?void 0:H.genre)||"",subGenre:(H==null?void 0:H.subGenre)||""}},Ks=async x=>{if(!s||!(x!=null&&x.id))return;const W=x.kind==="wishlist"?"wishlist":"library",G=W==="library"?"wishlist":"library";try{const F=ss(x);if(G==="library"){const H=vn(x);(F.msrp===""||F.msrp===null||F.msrp===void 0)&&(F.msrp=H);const ue=Hs(x);F.demographic||(F.demographic=ue.demographic),F.genre||(F.genre=ue.genre),F.subGenre||(F.subGenre=ue.subGenre)}await Ra(Sn(ot,G),F),await Na(Dt(ot,W,x.id)),await Promise.all([gt(),Nt()]),Tt(H=>H&&{...H,volumes:H.volumes.filter(ue=>ue.id!==x.id)}),Fn()}catch(F){console.error("Move failed",F),alert("Failed to move item.")}},ht=Re.list==="wishlist",is=q.items[q.index]||null,jn=(is==null?void 0:is.kind)==="wishlist";return o.jsxs("div",{className:"manga-page",children:[o.jsxs("header",{className:"manga-header",style:{flexDirection:"column",alignItems:"center",textAlign:"center"},children:[o.jsx("div",{className:"manga-header-title",style:{justifyContent:"center",gap:"0.6rem",fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Tyler's Manga Library"}),o.jsx("div",{className:"manga-header-sub",style:{textAlign:"center"},children:"This is my Manga Library and Wishlist. Check and see all the Manga I have in my possession!"})]}),Ct&&o.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"6px"},children:o.jsx("button",{className:"suggestion-trigger",type:"button",onClick:()=>{ye(""),De(!0)},children:"+ Suggestion"})}),o.jsxs("div",{className:"manga-tabs",children:[o.jsx("button",{className:"manga-tab-btn"+(l==="library"?" active":""),onClick:()=>{d("library"),b(!1),ne(new Set)},children:"Library"}),o.jsx("button",{className:"manga-tab-btn"+(l==="wishlist"?" active":""),onClick:()=>{d("wishlist"),b(!1),ne(new Set)},children:"Wishlist"})]}),l!=="dashboard"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"manga-toolbar",children:[o.jsxs("div",{className:"manga-toolbar-left",children:[o.jsx("input",{type:"text",className:"manga-search-input",placeholder:l==="library"?"Search library by title, author, ISBN...":"Search wishlist...",value:l==="library"?P:M,onChange:x=>l==="library"?A(x.target.value):D(x.target.value)}),o.jsx("div",{className:"manga-counter",children:(()=>{const x=l==="library",W=(x?P:M).trim(),G=x?w.length:I.length,F=x?Qt.length:nn.length;return W?`${F} / ${G} Volumes`:`${G} Volumes`})()})]}),o.jsxs("div",{className:"manga-toolbar-right",children:[o.jsxs("div",{className:"manga-view-toggle",children:[o.jsx("button",{className:"manga-btn secondary"+(f==="series"?" active":""),type:"button","aria-pressed":f==="series","aria-label":"Series view",title:"Series View",onClick:()=>rn("series"),children:""}),o.jsx("button",{className:"manga-btn secondary"+(f==="individual"?" active":""),type:"button","aria-pressed":f==="individual","aria-label":"Volume view",title:"Volume View",onClick:()=>rn("individual"),children:""})]}),s&&o.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>xe(x=>!x),children:Te?"Hide Hidden":"Show Hidden"}),s&&o.jsx("button",{className:"manga-btn secondary"+(N?" active":""),disabled:f==="series",onClick:$t,children:N?"Exit Multi-select":"Multi-select"})]})]}),s&&N&&f==="individual"&&o.jsxs("div",{className:"manga-multiselect-bar",children:[o.jsxs("span",{children:["Selected: ",o.jsx("strong",{children:J.size})]}),o.jsx("button",{className:"manga-btn",onClick:Gs,children:"Bulk Edit"}),o.jsxs("button",{className:"manga-btn secondary",onClick:()=>cr("move"),children:["Move to ",l==="library"?"Wishlist":"Library"]}),l==="library"&&o.jsxs(o.Fragment,{children:[o.jsx("button",{className:"manga-btn",onClick:()=>cr("markRead"),children:"Mark Read"}),o.jsx("button",{className:"manga-btn secondary",onClick:()=>cr("markUnread"),children:"Mark Unread"})]}),o.jsx("button",{className:"manga-btn danger",onClick:()=>cr("delete"),children:"Delete"})]})]}),_e?o.jsx("div",{className:"manga-empty-state",children:"Loading manga from Firestore..."}):ie?o.jsx("div",{className:"manga-empty-state",children:ie}):un.length===0?o.jsx("div",{className:"manga-empty-state",children:"No manga found. Try changing your search."}):o.jsx("div",{className:"manga-grid",children:un.map(x=>f==="series"?bs(x):An(x))}),Ye&&o.jsx("div",{className:"manga-modal-backdrop visible",onClick:x=>{x.target===x.currentTarget&&es()},children:o.jsx("div",{className:"manga-modal series",children:o.jsxs("div",{className:"manga-modal-body",children:[o.jsxs("div",{className:"manga-modal-header",children:[o.jsx("div",{className:"manga-modal-title",children:Ye.series.title||"Series"}),o.jsx("button",{className:"manga-modal-close",onClick:es,type:"button","aria-label":"Close",children:"X"})]}),o.jsxs("div",{className:"manga-modal-subtitle",children:[Ye.series.count," volume",Ye.series.count===1?"":"s"," in this series"]}),s&&o.jsxs("div",{className:"series-bulk-controls",children:[o.jsx("button",{type:"button",className:"manga-btn mini secondary"+(N?" active":""),onClick:()=>Ot(Ye.volumes),children:N?"Exit Multi-select":"Multi-select"}),N&&o.jsxs(o.Fragment,{children:[o.jsx("button",{type:"button",className:"manga-btn mini secondary",onClick:()=>{const x=Ye.volumes.map(W=>W.id);ne(new Set(x))},children:"Select All"}),o.jsx("button",{type:"button",className:"manga-btn mini secondary",onClick:()=>{ne(new Set)},children:"Clear"}),l==="wishlist"?o.jsx("button",{type:"button",className:"manga-btn mini",disabled:!J.size,onClick:()=>{J.size&&cr("move","library")},children:"Move to Library"}):o.jsx("button",{type:"button",className:"manga-btn mini",disabled:!J.size,onClick:()=>{J.size&&cr("move","wishlist")},children:"Move to Wishlist"}),o.jsxs("button",{type:"button",className:"manga-btn mini",disabled:!J.size,onClick:()=>{if(!J.size)return;const x=new Set(Ye.volumes.map(W=>W.id));ne(W=>new Set([...W].filter(G=>x.has(G)))),Gs()},children:["Bulk Edit Selected (",J.size||0,")"]})]})]}),o.jsx("div",{className:"manga-series-modal-grid",children:Ye.volumes.map(x=>o.jsxs("div",{className:"manga-card mini-card"+(x.read?" read":"")+(s&&Eu(x)?" missing-page":"")+(s&&xo(x).any?" missing-meta":""),onClick:()=>{if(!s){Cn(x);return}if(N){On(x.id);return}Cn(x)},children:[o.jsxs("div",{className:"manga-card-cover-wrap",children:[N&&s&&o.jsx("div",{className:"mini-select-indicator"+(J.has(x.id)?" selected":""),children:J.has(x.id)?"X":""}),o.jsx("img",{src:x.cover||"https://imgur.com/chUgq4W.png",alt:x.title||"Cover",loading:"lazy",decoding:"async"})]}),o.jsxs("div",{className:"manga-card-body",children:[o.jsx("div",{className:"manga-card-title",children:x.title||"Untitled"}),o.jsxs("div",{className:"manga-card-meta",children:[o.jsx("span",{className:xo(x).authorMissing?"missing-field":"",children:x.authors&&x.authors!=="Unknown"?x.authors:"Missing author"}),o.jsx("br",{}),o.jsx("span",{className:xo(x).publisherMissing?"missing-field":"",children:x.publisher&&x.publisher!=="Unknown"?x.publisher:"Missing publisher"}),o.jsx("br",{}),o.jsx("span",{className:xo(x).dateMissing?"missing-field":"",children:x.date&&x.date!=="Unknown"?x.date:"Missing date"})]}),x.isbn&&o.jsxs("div",{className:"manga-card-isbn",children:["ISBN: ",x.isbn]})]})]},x.id))})]})})}),s&&o.jsxs("div",{className:"manga-floating-actions",children:[o.jsxs("button",{className:"manga-btn",type:"button","aria-label":"Add item",onClick:()=>ts(l==="wishlist"?"wishlist":"library"),children:["+ ",l==="wishlist"?"Wishlist":"Library"]}),o.jsxs("div",{className:"manga-export-actions",children:[n&&o.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>Ur({library:w,wishlist:I},"manga-library-wishlist.json"),children:"Export JSON"}),o.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>Nr(l==="library"?w:I,l==="library"?"manga-library.csv":"manga-wishlist.csv"),children:"Export CSV"}),o.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>qs(l==="library"?w:I,l==="library"?"manga-library-images.zip":"manga-wishlist-images.zip"),children:"Download Images"})]})]}),me&&o.jsx("div",{className:"manga-modal-backdrop visible",onClick:x=>{x.target===x.currentTarget&&Fn()},children:o.jsxs("div",{className:"manga-modal",children:[o.jsxs("div",{className:"manga-modal-cover-wrap",children:[me.kind==="library"&&me.read&&o.jsx("div",{className:"manga-modal-read-pill",children:"Read"}),o.jsx("img",{src:me.cover||"https://imgur.com/chUgq4W.png",alt:"Cover"})]}),o.jsxs("div",{className:"manga-modal-body",children:[o.jsxs("div",{className:"manga-modal-header",children:[o.jsx("div",{className:"manga-modal-title",children:me.title||"Untitled"}),o.jsx("button",{className:"manga-modal-close",onClick:Fn,type:"button","aria-label":"Close",children:"X"})]}),o.jsxs("div",{className:"manga-modal-meta",children:[me.authors&&me.authors!=="Unknown"&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"Author(s):"})," ",me.authors,o.jsx("br",{})]}),me.publisher&&me.publisher!=="Unknown"&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"Publisher:"})," ",me.publisher,o.jsx("br",{})]}),me.date&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"Release:"})," ",me.date,o.jsx("br",{})]}),me.isbn&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"ISBN:"})," ",me.isbn,o.jsx("br",{})]})]}),o.jsxs("div",{className:"manga-modal-details",children:[me.pageCount&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"Pages:"})," ",me.pageCount,o.jsx("br",{})]}),o.jsxs("div",{style:{margin:"6px 0"},children:[o.jsx("strong",{children:"Rating:"})," ",o.jsx(Cs,{value:me.rating||"",onChange:s?x=>Ws(me,x):void 0,interactive:s})]}),me.amountPaid&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"Amount Paid:"})," $",me.amountPaid,o.jsx("br",{})]}),me.msrp&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"MSRP:"})," $",me.msrp,o.jsx("br",{})]}),me.collectiblePrice&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"Collectible:"})," $",me.collectiblePrice,o.jsx("br",{})]}),me.read&&me.dateRead&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"Date Read:"})," ",me.dateRead,o.jsx("br",{})]}),me.amazonURL&&o.jsx("div",{style:{marginTop:"6px"},children:o.jsx("a",{href:me.amazonURL,target:"_blank",rel:"noreferrer",children:"View on Amazon"})})]}),o.jsxs("div",{className:"manga-modal-footer",style:{gap:"10px",alignItems:"center"},children:[o.jsx("div",{children:me.kind==="library"&&me.read?"Marked as read in your library.":me.kind==="library"?"In your library (unread).":"Wishlist item - not in library yet."}),o.jsxs("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:[s&&o.jsx("button",{className:"manga-btn mini secondary",type:"button",onClick:()=>Ts(me),children:"Edit"}),me.kind==="library"&&s&&o.jsx(o.Fragment,{children:me.read?o.jsx("button",{className:"manga-btn mini secondary",disabled:Ir,onClick:()=>mr(me,!1),type:"button",children:"Mark as unread"}):o.jsx("button",{className:"manga-btn mini",disabled:Ir,onClick:()=>mr(me,!0),type:"button",children:"Mark as read"})}),s&&o.jsxs("button",{className:"manga-btn mini",type:"button",onClick:()=>Ks(me),children:["Move to ",me.kind==="library"?"Wishlist":"Library"]}),s&&o.jsx("button",{className:"manga-btn mini danger",type:"button",onClick:()=>Yn(me.id,me.kind==="library"?"library":"wishlist"),children:"Delete"})]})]})]})]})}),s&&Re.open&&o.jsx("div",{className:"manga-modal-backdrop visible",onClick:x=>{x.target===x.currentTarget&&In()},children:o.jsx("div",{className:"manga-modal admin",children:o.jsxs("div",{className:"manga-modal-body",children:[o.jsxs("div",{className:"manga-modal-header",children:[o.jsx("div",{className:"manga-modal-title",children:Re.mode==="add"?"Add Entry":"Edit Entry"}),o.jsx("button",{className:"manga-modal-close",onClick:In,type:"button","aria-label":"Close",children:"X"})]}),o.jsxs("div",{className:"admin-form-layout",children:[o.jsx("div",{className:"admin-cover-frame",children:o.jsx("img",{src:Re.data.cover||"https://imgur.com/chUgq4W.png",alt:"Cover preview"})}),o.jsxs("div",{className:"admin-form-fields",children:[o.jsx("div",{className:"admin-row",children:o.jsxs("label",{children:["Title",o.jsx("input",{type:"text",value:Re.data.title,onChange:x=>Pt("title",x.target.value)})]})}),O.length>0&&o.jsx("div",{className:"title-suggestions",children:O.map((x,W)=>o.jsx("button",{type:"button",className:"manga-btn mini",onClick:()=>Pt("title",x),children:x},x+W))}),o.jsxs("div",{className:"admin-row two",style:{alignItems:"flex-end",marginTop:"-8px"},children:[o.jsxs("div",{children:[o.jsxs("div",{className:"manga-modal-subtitle",style:{marginBottom:"6px"},children:["Entry ",ve+1," / ",Math.max(1,le.length||1)]}),o.jsxs("div",{style:{display:"flex",gap:"8px"},children:[o.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>ve>0&&pr(ve-1),disabled:ve===0,children:"Previous"}),o.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>le.length&&ve<le.length-1?pr(ve+1):null,disabled:!le.length||ve===le.length-1,children:"Next"})]})]}),o.jsxs("div",{style:{textAlign:"right"},children:[o.jsx("button",{className:"manga-btn",type:"button",onClick:Ss,disabled:!kt(Re.data.title||"").vol,children:"Add New Volume"}),o.jsx("div",{className:"manga-stat-sub",style:{marginTop:"4px"},children:"Auto-fills the next volume number for this series."})]})]}),o.jsx("div",{className:"admin-row",children:o.jsxs("label",{className:k.author?"missing-field-input":"",children:["Authors",o.jsx("input",{type:"text",value:Re.data.authors,onChange:x=>Pt("authors",x.target.value)})]})}),o.jsx("div",{className:"admin-row",children:o.jsxs("label",{className:k.publisher?"missing-field-input":"",children:["Publisher",o.jsx("input",{type:"text",value:Re.data.publisher,onChange:x=>Pt("publisher",x.target.value)})]})}),o.jsxs("div",{className:"admin-row three",children:[o.jsxs("label",{className:k.date?"missing-field-input":"",children:["Release Date",o.jsx("input",{type:"date",value:Re.data.date,onChange:x=>Pt("date",x.target.value)})]}),o.jsxs("label",{children:["Purchase Date",o.jsx("input",{type:"date",value:Re.data.datePurchased,onChange:x=>Pt("datePurchased",x.target.value)})]}),!ht&&o.jsxs("label",{children:["Date Read",o.jsx("input",{type:"date",value:Re.data.dateRead,onChange:x=>Pt("dateRead",x.target.value)})]})]}),o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{className:k.page?"missing-field-input":"",children:["Page Count",o.jsx("input",{type:"number",placeholder:"e.g. 192",value:Re.data.pageCount,onChange:x=>Pt("pageCount",x.target.value)})]}),!ht&&o.jsxs("label",{children:["ISBN (library only)",o.jsx("input",{type:"text",value:Re.data.isbn,onChange:x=>Pt("isbn",x.target.value)})]})]}),o.jsx("div",{className:"admin-row",children:o.jsxs("label",{children:["Cover URL",o.jsx("input",{type:"text",placeholder:"Paste image URL here",value:Re.data.cover,onChange:x=>Pt("cover",x.target.value)})]})}),!ht&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"admin-row two",children:[!(Re.data.special&&Re.data.specialType==="collectible")&&o.jsxs("label",{children:["Amount Paid",o.jsx("input",{type:"number",step:"0.01",value:Re.data.amountPaid,onChange:x=>Pt("amountPaid",x.target.value)})]}),o.jsxs("label",{children:["MSRP",o.jsx("input",{type:"number",step:"0.01",value:Re.data.msrp,onChange:x=>Pt("msrp",x.target.value)})]})]}),o.jsx("div",{className:"admin-row",children:o.jsxs("label",{className:"checkbox-row",children:[o.jsx("input",{type:"checkbox",checked:!!Re.data.special,onChange:x=>Pt("special",x.target.checked,"checkbox")}),o.jsx("span",{children:"Special item?"})]})}),Re.data.special&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{children:["Special Type",o.jsxs("select",{value:Re.data.specialType,onChange:x=>Pt("specialType",x.target.value),children:[o.jsx("option",{value:"",children:"Select type"}),o.jsx("option",{value:"specialEdition",children:"Special Edition"}),o.jsx("option",{value:"collectible",children:"Collectible"})]})]}),Re.data.specialType==="collectible"&&o.jsxs("label",{children:["Collectible Price",o.jsx("input",{type:"number",step:"0.01",value:Re.data.collectiblePrice,onChange:x=>Pt("collectiblePrice",x.target.value)})]})]}),Re.data.specialType==="specialEdition"&&o.jsx("div",{className:"admin-row",children:o.jsxs("label",{children:["Special Volumes",o.jsx("input",{type:"number",min:"0",value:Re.data.specialVolumes,onChange:x=>Pt("specialVolumes",x.target.value)})]})})]})]}),ht&&o.jsx("div",{className:"admin-row",children:o.jsxs("label",{children:["Amazon URL",o.jsx("input",{type:"text",value:Re.data.amazonURL,onChange:x=>Pt("amazonURL",x.target.value)})]})}),!ht&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"admin-row",children:o.jsxs("label",{children:["Rating (1-5 stars)",o.jsx(Cs,{value:Re.data.rating,onChange:x=>Pt("rating",x)})]})}),o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{className:"checkbox-inline",children:[o.jsx("input",{type:"checkbox",checked:Re.data.read,onChange:x=>Pt("read",x.target.checked,"checkbox")}),o.jsx("span",{children:"Mark as read"})]}),o.jsxs("label",{className:"checkbox-inline",children:[o.jsx("input",{type:"checkbox",checked:!!Re.data.hidden,onChange:x=>Pt("hidden",x.target.checked,"checkbox")}),o.jsx("span",{children:"Hide from public"})]})]})]}),ht&&o.jsx("div",{className:"admin-row",children:o.jsxs("label",{className:"checkbox-inline",children:[o.jsx("input",{type:"checkbox",checked:!!Re.data.hidden,onChange:x=>Pt("hidden",x.target.checked,"checkbox")}),o.jsx("span",{children:"Hide from public"})]})})]})]}),o.jsxs("div",{className:"manga-modal-footer",style:{justifyContent:"flex-end",gap:"10px"},children:[o.jsx("button",{className:"manga-btn secondary",onClick:In,type:"button",children:"Cancel"}),o.jsx("button",{className:"manga-btn",onClick:Qn,type:"button",children:Re.mode==="add"?"Add":"Save"})]})]})})}),s&&q.open&&o.jsx("div",{className:"manga-modal-backdrop visible",onClick:x=>{x.target===x.currentTarget&&Pr()},children:o.jsx("div",{className:"manga-modal admin",children:o.jsxs("div",{className:"manga-modal-body",children:[o.jsxs("div",{className:"manga-modal-header",children:[o.jsxs("div",{className:"manga-modal-title",children:["Bulk Edit (",q.index+1," / ",q.items.length,")"]}),o.jsx("button",{className:"manga-modal-close",onClick:Pr,type:"button","aria-label":"Close",children:"X"})]}),q.items.length>0&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"manga-modal-subtitle",children:["Editing: ",q.items[q.index].data.title||"Untitled"]}),o.jsxs("div",{className:"admin-form-grid two-col",children:[o.jsx("div",{className:"admin-cover",children:o.jsx("div",{className:"manga-card-cover-wrap",children:o.jsx("img",{src:q.items[q.index].data.cover||"https://imgur.com/chUgq4W.png",alt:q.items[q.index].data.title||"Cover",loading:"lazy",decoding:"async"})})}),o.jsxs("div",{className:"admin-fields",children:[o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{className:"full",children:["Title",o.jsx("input",{type:"text",value:q.items[q.index].data.title,onChange:x=>rt("title",x.target.value)})]}),o.jsxs("div",{className:"admin-entry-info",children:["Entry ",q.index+1," / ",q.items.length]})]}),o.jsx("div",{className:"admin-row",children:o.jsxs("label",{children:["Authors",o.jsx("input",{type:"text",value:q.items[q.index].data.authors,onChange:x=>rt("authors",x.target.value)})]})}),o.jsx("div",{className:"admin-row",children:o.jsxs("label",{children:["Publisher",o.jsx("input",{type:"text",value:q.items[q.index].data.publisher,onChange:x=>rt("publisher",x.target.value)})]})}),o.jsxs("div",{className:"admin-row three",children:[o.jsxs("label",{children:["Release Date",o.jsx("input",{type:"date",value:q.items[q.index].data.date,onChange:x=>rt("date",x.target.value)})]}),o.jsxs("label",{children:["Purchase Date",o.jsx("input",{type:"date",value:q.items[q.index].data.datePurchased,onChange:x=>rt("datePurchased",x.target.value)})]}),!jn&&o.jsxs("label",{children:["Date Read",o.jsx("input",{type:"date",value:q.items[q.index].data.dateRead,onChange:x=>rt("dateRead",x.target.value)})]})]}),o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{children:["Page Count",o.jsx("input",{type:"number",value:q.items[q.index].data.pageCount,onChange:x=>rt("pageCount",x.target.value)})]}),!jn&&o.jsxs("label",{children:["ISBN (library only)",o.jsx("input",{type:"text",value:q.items[q.index].data.isbn,onChange:x=>rt("isbn",x.target.value)})]})]}),o.jsx("div",{className:"admin-row",children:o.jsxs("label",{children:["Cover URL",o.jsx("input",{type:"text",value:q.items[q.index].data.cover,onChange:x=>rt("cover",x.target.value)})]})}),!jn&&o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{children:["Amount Paid",o.jsx("input",{type:"number",step:"0.01",value:q.items[q.index].data.amountPaid,onChange:x=>rt("amountPaid",x.target.value)})]}),o.jsxs("label",{children:["MSRP",o.jsx("input",{type:"number",step:"0.01",value:q.items[q.index].data.msrp,onChange:x=>rt("msrp",x.target.value)})]})]}),!jn&&o.jsx("div",{className:"admin-row two",children:o.jsxs("div",{children:[o.jsx("div",{className:"star-label",children:"Rating (1-5 stars)"}),o.jsx(Cs,{value:q.items[q.index].data.rating,onChange:x=>rt("rating",x)})]})}),!jn&&o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{className:"checkbox-row",children:[o.jsx("input",{type:"checkbox",checked:!!q.items[q.index].data.special,onChange:x=>rt("special",x.target.checked,"checkbox")}),o.jsx("span",{children:"Special item?"})]}),o.jsxs("label",{className:"checkbox-row",children:[o.jsx("input",{type:"checkbox",checked:q.items[q.index].data.read,onChange:x=>rt("read",x.target.checked,"checkbox")}),o.jsx("span",{children:"Mark as read"})]})]}),q.items[q.index].data.special&&!jn&&o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{children:["Special Type",o.jsxs("select",{value:q.items[q.index].data.specialType,onChange:x=>rt("specialType",x.target.value),children:[o.jsx("option",{value:"",children:"Select type"}),o.jsx("option",{value:"specialEdition",children:"Special Edition"}),o.jsx("option",{value:"collectible",children:"Collectible"})]})]}),q.items[q.index].data.specialType==="specialEdition"&&o.jsxs("label",{children:["Special Volumes",o.jsx("input",{type:"number",value:q.items[q.index].data.specialVolumes,onChange:x=>rt("specialVolumes",x.target.value)})]}),q.items[q.index].data.specialType==="collectible"&&o.jsxs("label",{children:["Collectible Price",o.jsx("input",{type:"number",step:"0.01",value:q.items[q.index].data.collectiblePrice,onChange:x=>rt("collectiblePrice",x.target.value)})]})]}),o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{children:["Amazon URL",o.jsx("input",{type:"text",value:q.items[q.index].data.amazonURL,onChange:x=>rt("amazonURL",x.target.value)})]}),o.jsxs("label",{className:"checkbox-row",children:[o.jsx("input",{type:"checkbox",checked:!!q.items[q.index].data.hidden,onChange:x=>rt("hidden",x.target.checked,"checkbox")}),o.jsx("span",{children:"Hidden from public"})]})]})]})]}),o.jsxs("div",{className:"manga-modal-footer",style:{justifyContent:"space-between",gap:"10px"},children:[o.jsxs("div",{children:[o.jsx("button",{className:"manga-btn secondary",onClick:Nn,type:"button",disabled:q.index===0,children:"Previous"}),o.jsx("button",{className:"manga-btn secondary",onClick:Xn,type:"button",disabled:q.index===q.items.length-1,style:{marginLeft:"6px"},children:"Next"})]}),o.jsxs("div",{style:{display:"flex",gap:"8px"},children:[o.jsx("button",{className:"manga-btn secondary",onClick:Pr,type:"button",children:"Cancel"}),o.jsx("button",{className:"manga-btn",onClick:ns,type:"button",children:"Save Edits"})]})]})]})]})})}),Ct&&o.jsx(px,{open:Le,title:"Suggest a Manga",placeholder:"Type a manga you'd like me to collect/read...",value:Fe,status:st,loading:ce,onChange:Qe,onSubmit:v,onClose:()=>De(!1)}),o.jsx("datalist",{id:"adminTitleSuggestions",children:X.map(x=>o.jsx("option",{value:x},x))})]})}const fR="https://imokmalworker.imokissick.workers.dev/?url=",yx="im_ok",v_=300,pR={1:"watching",2:"completed",3:"on_hold",4:"dropped",6:"plan_to_watch"};function mR(n){const e=n==null?void 0:n.title_localized,t=typeof e=="string"?e:(e==null?void 0:e.en)||(e==null?void 0:e.english);return(n==null?void 0:n.anime_title_eng)||(n==null?void 0:n.title_english)||t||(n==null?void 0:n.anime_title)||(n==null?void 0:n.title)||"Untitled"}function gR(n){const e=(n==null?void 0:n.updated_at)??(n==null?void 0:n.updatedAt)??(n==null?void 0:n.updated_at_ms)??null;if(e==null)return null;const t=Number(e);if(Number.isFinite(t))return t<1e12?t*1e3:t;const s=Date.parse(e);return Number.isNaN(s)?null:s}function yR(n){const e=pR[n.status]||(typeof n.status=="string"?n.status.toLowerCase():"unknown");return{id:n.anime_id||n.id,title:mR(n),updatedAt:gR(n),episodes:n.anime_num_episodes??n.episodes??null,watchedEpisodes:n.num_watched_episodes??n.my_watched_episodes??n.watched_episodes??n.num_watched??0,status:e,score:n.score??null,image:n.anime_image_path||n.image_url||n.anime_img||n.picture||null,synopsis:n.anime_synopsis||n.synopsis||null}}function __(){const n=Date.now();return[{id:1,title:"Cowboy Bebop",episodes:26,status:"completed",score:10,updatedAt:n-1e3*60*60*24*3,synopsis:"In 2071, bounty hunters Spike and Jet roam the solar system looking for their next payout and a place to belong."},{id:2,title:"Fullmetal Alchemist: Brotherhood",episodes:64,status:"completed",score:10,updatedAt:n-1e3*60*60*24*6,synopsis:"Brothers Edward and Alphonse Elric search for the Philosopher's Stone to restore their bodies after a failed alchemy ritual."},{id:3,title:"Frieren: Beyond Journey's End",episodes:28,status:"watching",score:9,updatedAt:n-1e3*60*60*8,synopsis:"An elven mage retraces the steps of a past adventure to understand humanity and the passage of time."},{id:4,title:"One Piece",episodes:1e3,status:"on_hold",score:8,updatedAt:n-1e3*60*60*24*14,synopsis:"Monkey D. Luffy sails toward the Grand Line seeking the One Piece and a crew to make his dream real."},{id:5,title:"Kaiju No. 8",episodes:12,status:"plan_to_watch",score:null,updatedAt:n-1e3*60*30,synopsis:"A middle-aged worker gains kaiju powers and joins the Defense Force to fight monsters from the inside."}]}async function vR(n,e){const t=`https://myanimelist.net/animelist/${n}/load.json?status=7&offset=${e}`,s=await fetch(`${fR}${encodeURIComponent(t)}`);if(!s.ok)throw new Error(`Failed to fetch MAL list (offset ${e})`);return s.json()}async function _R(n=yx){const e=[];try{let t=0;for(;;){const s=await vR(n,t);if(!Array.isArray(s)||s.length===0||(e.push(...s),s.length<v_))break;t+=v_}}catch(t){return console.error("Failed to load MAL list; falling back to sample data.",t),__()}return e.length?e.map(yR):__()}async function wR(n){var e,t;if(!n)return null;try{const s=await fetch(`https://api.jikan.moe/v4/anime/${n}`);if(!s.ok)throw new Error(`Failed to fetch Jikan summary for id ${n}`);const a=await s.json();return((e=a==null?void 0:a.data)==null?void 0:e.synopsis)||((t=a==null?void 0:a.data)==null?void 0:t.background)||null}catch(s){return console.error("Failed to load anime synopsis",n,s),null}}async function xR(n=yx){var e;if(!n)return null;try{const t=await fetch(`https://api.jikan.moe/v4/users/${encodeURIComponent(n)}/statistics`);if(!t.ok)throw new Error(`Failed to fetch user stats for ${n}`);const s=await t.json(),a=((e=s==null?void 0:s.data)==null?void 0:e.anime)||{},l=Number(a.days_watched),d=Number(a.total_episodes??a.episodes_watched);return{daysWatched:Number.isFinite(l)?l:null,episodesWatched:Number.isFinite(d)?d:null}}catch(t){return console.error("Failed to load user stats",n,t),null}}const w_=5,ER=3600*1e3,x_="animeSuggestionsSent";function TR(){const{admin:n,user:e,role:t}=za(),s=ce=>ce?ce.toString().replace(/_/g," ").replace(/\b\w/g,Me=>Me.toUpperCase()):"Unknown",[a,l]=j.useState([]),[d,f]=j.useState([]),[m,v]=j.useState(""),[w,T]=j.useState("all"),[I,U]=j.useState(!0),[X,$]=j.useState(""),[O,se]=j.useState(null),[Te,xe]=j.useState({}),[_e,V]=j.useState(!1),[ie,C]=j.useState(!1),[P,A]=j.useState(null),[M,D]=j.useState(!1),[N,b]=j.useState(""),[J,ne]=j.useState(""),[Re,he]=j.useState(!1);j.useEffect(()=>{document.title="Anime | Library"},[]),j.useEffect(()=>{ne("")},[e]);const le=ce=>{if(!ce)return"";const Me=Date.now()-ce,me=Math.max(Me,0),He=Math.floor(me/6e4);if(He<1)return"just now";if(He<60)return`${He}m ago`;const Ye=Math.floor(He/60);if(Ye<48)return`${Ye}h ago`;const Tt=Math.floor(Ye/24);if(Tt<14)return`${Tt}d ago`;const Ct=Math.floor(Tt/7);return Ct<8?`${Ct}w ago`:`${Math.floor(Tt/30)}mo ago`},Ie=(ce,Me="image")=>(ce||"").toString().toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"").slice(0,80)||Me,ve=async()=>{const ce=a.filter(Me=>Me.image).map((Me,me)=>({url:Me.image,name:Ie(Me.title||`anime-${me+1}`,`anime-${me+1}`)}));if(!ce.length){alert("No images found to download.");return}try{const Me=(await pc(async()=>{const{default:Nt}=await import("https://cdn.jsdelivr.net/npm/jszip@3.10.1/+esm");return{default:Nt}},[])).default,me=new Me,He=me.folder("images"),Ye={};await Promise.all(ce.map(async(Nt,Qt)=>{try{const nn=await(await fetch(Nt.url)).blob(),lr=(Nt.url.split(".").pop()||"jpg").split(/[?#]/)[0],rn=Nt.name||`image-${Qt+1}`;Ye[rn]=(Ye[rn]||0)+1;const Kn=Ye[rn]>1?`-${Ye[rn]}`:"";He.file(`${rn}${Kn}.${lr}`,nn)}catch(tn){console.warn("Failed to fetch image",Nt.url,tn)}}));const Tt=await me.generateAsync({type:"blob"}),Ct=URL.createObjectURL(Tt),gt=document.createElement("a");gt.href=Ct,gt.download="anime-images.zip",gt.click(),URL.revokeObjectURL(Ct)}catch(Me){console.error("Zip download failed",Me),alert("Failed to create zip. Please try again.")}};j.useEffect(()=>{async function ce(){try{const Me=await _R();l(Me),f(Me)}catch(Me){console.error(Me),$("Failed to load data from MAL.")}finally{U(!1)}}ce()},[]),j.useEffect(()=>{xR().then(ce=>{ce&&A(ce)}).catch(()=>{})},[]);const Y=ce=>{switch((ce||"unknown").toLowerCase()){case"watching":return 0;case"completed":return 1;case"on_hold":return 2;case"plan_to_watch":return 3;case"dropped":return 4;default:return 5}},k=ce=>{const Me=Number.isFinite(Number(ce.watchedEpisodes))?Number(ce.watchedEpisodes):0,me=Number.isFinite(Number(ce.episodes))?Number(ce.episodes):null;return me?`${Math.min(Me,me)}/${me} eps`:Me?`${Me} eps`:"No progress"};j.useEffect(()=>{let ce=[...a];if(w!=="all"&&(ce=ce.filter(Me=>(Me.status||"").toLowerCase()===w)),m){const Me=m.toLowerCase();ce=ce.filter(me=>(me.title||"").toLowerCase().includes(Me))}ce.sort((Me,me)=>{const He=Y(Me.status),Ye=Y(me.status);return He!==Ye?He-Ye:(Me.title||"").localeCompare(me.title||"")}),f(ce)},[a,w,m]);const q=j.useMemo(()=>[...a].filter(ce=>Number.isFinite(ce.updatedAt)).sort((ce,Me)=>Me.updatedAt-ce.updatedAt).slice(0,6),[a]),Ee=!!e&&t==="viewer",Le=async()=>{const ce=Date.now(),me=(()=>{try{const He=localStorage.getItem(x_);return Array.isArray(JSON.parse(He))?JSON.parse(He):[]}catch{return[]}})().filter(He=>ce-He<ER);if(me.length>=w_){ne("Rate limit: please wait a bit (max 5 suggestions per hour).");return}if(!N.trim()){ne("Please enter a title or note before sending.");return}he(!0),ne("");try{const He=`**Anime Suggestion**
${N.trim()}
From: ${(e==null?void 0:e.displayName)||(e==null?void 0:e.email)||(e==null?void 0:e.uid)||"anonymous user"}`;await Ra(Sn(ot,"suggestions"),{content:N.trim(),type:"anime",from:(e==null?void 0:e.displayName)||(e==null?void 0:e.email)||(e==null?void 0:e.uid)||"anonymous user",createdAt:new Date().toISOString()}),ne("Sent! I'll review your suggestion soon."),b("");const Ye=[...me,ce].slice(-w_);localStorage.setItem(x_,JSON.stringify(Ye))}catch(He){console.error("Failed to send suggestion",He),ne("Failed to send suggestion. Please try again later.")}finally{he(!1)}};j.useEffect(()=>{if(!O){C(!1),V(!1);return}C(!!O.synopsis),V(!1)},[O==null?void 0:O.id]);const De=j.useMemo(()=>{const ce=a.length,Me=a.reduce((Ct,gt)=>{const Nt=Number(gt.watchedEpisodes);return Number.isFinite(Nt)?Ct+Nt:Ct},0),me=Me*.4,He=a.filter(Ct=>Number.isFinite(Ct.score)&&Ct.score>0),Ye=He.reduce((Ct,gt)=>Ct+gt.score,0),Tt={watching:0,completed:0,on_hold:0,dropped:0,plan_to_watch:0,unknown:0};return a.forEach(Ct=>{const gt=(Ct.status||"unknown").toLowerCase();Tt[gt]!=null?Tt[gt]+=1:Tt.unknown+=1}),{total:ce,totalWatchedEpisodes:Me,byStatus:Tt,avgScore:He.length?Ye/He.length:0,totalHours:me}},[a]),Fe=(P==null?void 0:P.daysWatched)??(De.totalHours||0)/24,Qe=(P==null?void 0:P.episodesWatched)??De.totalWatchedEpisodes,st=ce=>{const Me=ce.image||"https://imgur.com/chUgq4W.png",me=Number.isFinite(Number(ce.watchedEpisodes))?Number(ce.watchedEpisodes):0,He=Number.isFinite(Number(ce.episodes))?Number(ce.episodes):null,Ye=He?`Episode ${Math.min(me,He)}/${He}`:`Episode ${me}`,Tt=Number.isFinite(Number(ce.score))&&Number(ce.score)>0?ce.score:"Not rated";return o.jsxs("article",{className:"anime-card",onClick:()=>se(ce.synopsis?ce:{...ce,synopsis:Te[ce.id]}),children:[o.jsxs("div",{className:"anime-cover-wrap",children:[o.jsx("img",{className:"anime-cover",src:Me,alt:ce.title,loading:"lazy",decoding:"async"}),o.jsx("div",{className:`badge-status ${(ce.status||"unknown").toLowerCase()}`,children:s(ce.status)}),ce.score!=null&&o.jsx("div",{className:"badge-score",children:Tt})]}),o.jsxs("div",{className:"anime-meta",children:[o.jsx("div",{className:"anime-title",title:ce.title,children:ce.title}),o.jsx("div",{className:"anime-sub",children:ce.episodes?`${ce.episodes} episodes`:"Episodes: ?"}),o.jsx("div",{className:"anime-progress",children:Ye}),o.jsxs("div",{className:"anime-progress",children:["Status: ",s(ce.status)]})]})]},ce.id||ce.title)},ye=ce=>o.jsxs("article",{className:"anime-update-card",children:[o.jsx("div",{className:"anime-update-title",title:ce.title,children:ce.title}),o.jsxs("div",{className:"anime-update-meta",children:[o.jsx("span",{className:"anime-update-progress",children:k(ce)}),o.jsx("span",{className:"anime-update-dot","aria-hidden":"true",children:""}),o.jsx("span",{className:"anime-update-status",children:s(ce.status)})]}),o.jsx("div",{className:"anime-update-time",children:le(ce.updatedAt)})]},`update-${ce.id||ce.title}`);return o.jsxs("main",{className:"anime-page",children:[o.jsxs("div",{className:"anime-content",children:[o.jsxs("header",{className:"anime-header",style:{position:"relative",display:"flex",justifyContent:"center",alignItems:"center",textAlign:"center",width:"100%"},children:[o.jsxs("div",{style:{textAlign:"center",margin:"0 auto",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"0 60px"},children:[o.jsx("h1",{className:"anime-title",style:{margin:0,fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Tyler's Anime Library"}),o.jsx("p",{className:"anime-sub",style:{textAlign:"center",margin:"6px 0 0"},children:"The Anime I've watched/watching synced directly from MAL (MyAnimeList)"})]}),(Ee||n)&&o.jsxs("div",{style:{position:"absolute",right:0,top:"50%",transform:"translateY(-50%)",display:"flex",gap:"10px"},children:[Ee&&o.jsx("button",{className:"suggestion-trigger",type:"button",onClick:()=>{ne(""),D(!0)},children:"+ Suggestion"}),n&&o.jsx("button",{className:"stat-link",type:"button",onClick:ve,children:"Download Images"})]})]}),o.jsxs("div",{className:"anime-stats",children:[o.jsxs("div",{className:"anime-stat-card",children:[o.jsx("div",{className:"anime-stat-label",children:"Total Entries"}),o.jsx("div",{className:"anime-stat-value",children:De.total})]}),o.jsxs("div",{className:"anime-stat-card",children:[o.jsx("div",{className:"anime-stat-label",children:"Episodes Watched"}),o.jsx("div",{className:"anime-stat-value",children:Qe})]}),o.jsxs("div",{className:"anime-stat-card",children:[o.jsx("div",{className:"anime-stat-label",children:"Watching"}),o.jsx("div",{className:"anime-stat-value",children:De.byStatus.watching})]}),o.jsxs("div",{className:"anime-stat-card",children:[o.jsx("div",{className:"anime-stat-label",children:"Completed"}),o.jsx("div",{className:"anime-stat-value",children:De.byStatus.completed})]}),o.jsxs("div",{className:"anime-stat-card",children:[o.jsx("div",{className:"anime-stat-label",children:"Plan to Watch"}),o.jsx("div",{className:"anime-stat-value",children:De.byStatus.plan_to_watch})]}),o.jsxs("div",{className:"anime-stat-card",children:[o.jsx("div",{className:"anime-stat-label",children:"Avg. Score"}),o.jsx("div",{className:"anime-stat-value",children:De.avgScore?De.avgScore.toFixed(1):"0.0"})]}),o.jsxs("div",{className:"anime-stat-card",children:[o.jsx("div",{className:"anime-stat-label",children:"Days Watched"}),o.jsx("div",{className:"anime-stat-value",children:Fe.toFixed(1)})]})]}),o.jsxs("section",{className:"anime-toolbar",children:[o.jsx("input",{type:"text",placeholder:"Search anime by title...",value:m,onChange:ce=>v(ce.target.value),className:"anime-input"}),o.jsxs("select",{value:w,onChange:ce=>T(ce.target.value),className:"anime-select",children:[o.jsx("option",{value:"all",children:"All statuses"}),o.jsx("option",{value:"watching",children:"Watching"}),o.jsx("option",{value:"completed",children:"Completed"}),o.jsx("option",{value:"on_hold",children:"On Hold"}),o.jsx("option",{value:"plan_to_watch",children:"Plan to Watch"}),o.jsx("option",{value:"dropped",children:"Dropped"})]})]}),I&&o.jsx("div",{className:"loading",children:"Loading anime list from MAL..."}),X&&o.jsx("div",{className:"error-state",children:X}),!I&&!X&&o.jsx(o.Fragment,{children:d.length===0?o.jsx("div",{className:"empty-state",children:"No results match your filters yet."}):o.jsx("section",{className:"anime-grid",children:d.map(ce=>st(ce))})})]}),q.length>0&&o.jsxs("aside",{className:"anime-updates-float",children:[o.jsxs("div",{className:"anime-updates-header",children:[o.jsx("h3",{children:"Recent Updates"}),o.jsx("span",{className:"anime-updates-caption",children:"Last list activity"})]}),o.jsx("div",{className:"anime-updates-list",children:q.map(ce=>ye(ce))})]}),Ee&&o.jsx(px,{open:M,title:"Suggest an Anime",placeholder:"Type an anime you'd like me to watch...",value:N,status:J,loading:Re,onChange:b,onSubmit:Le,onClose:()=>D(!1)}),O&&o.jsx("div",{className:"modal-backdrop visible",onClick:ce=>{ce.target===ce.currentTarget&&se(null)},children:o.jsxs("div",{className:"anime-modal",children:[o.jsxs("div",{className:"anime-modal-header",children:[o.jsx("h2",{style:{color:"#ffb6c1",margin:0},children:O.title}),o.jsx("button",{className:"anime-modal-close",onClick:()=>se(null),type:"button","aria-label":"Close",children:"X"})]}),o.jsxs("div",{className:"anime-modal-body",children:[o.jsx("div",{children:o.jsx("img",{className:"anime-modal-cover",src:O.image||"https://imgur.com/chUgq4W.png",alt:O.title})}),o.jsxs("div",{className:"anime-modal-meta",children:[o.jsxs("div",{children:[o.jsx("strong",{children:"Status:"})," ",s(O.status)]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Episodes:"})," ",O.episodes?O.episodes:"Unknown"]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Progress:"})," ",Number.isFinite(Number(O.watchedEpisodes))?`Episode ${O.watchedEpisodes}${Number.isFinite(Number(O.episodes))?`/${O.episodes}`:""}`:"Unknown"]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Score:"})," ",Number.isFinite(Number(O.score))&&Number(O.score)>0?O.score:"Not rated"]})]}),o.jsx(SR,{modalItem:O,modalLoading:_e,modalSynopsisShown:ie,onReveal:async()=>{if(!O)return;C(!0);const ce=O.id;if(!ce)return;const Me=Te[ce];if(Me!==void 0){se(me=>me&&{...me,synopsis:Me});return}V(!0);try{const me=await wR(ce);xe(He=>({...He,[ce]:me||""})),se(He=>He&&{...He,synopsis:me||""})}catch{xe(He=>({...He,[ce]:""})),se(He=>He&&{...He,synopsis:""})}finally{V(!1)}}})]})]})})]})}function SR({modalItem:n,modalLoading:e,modalSynopsisShown:t,onReveal:s}){var m;const a=((m=n==null?void 0:n.synopsis)==null?void 0:m.trim())||"",[l,d]=j.useState(0),f=j.useRef(null);return j.useEffect(()=>{if(t&&f.current){const v=f.current.scrollHeight+12;d(v)}else d(0)},[t,a]),o.jsxs("div",{className:"anime-modal-summary",children:[o.jsxs("div",{className:"anime-modal-summary-header",children:[o.jsx("h3",{children:"Synopsis"}),!t&&o.jsx("button",{className:"anime-synopsis-btn",type:"button",onClick:s,children:e?"Loading...":"Reveal Synopsis"})]}),o.jsx("div",{className:`anime-modal-summary-body ${t?"is-open":""}`,style:{maxHeight:t?`${l}px`:0,opacity:t?1:0},children:o.jsx("div",{ref:f,children:o.jsx("p",{className:"anime-modal-summary-text",children:e&&!a?"Loading synopsis...":a||"No synopsis available."})})}),!t&&o.jsx("p",{className:"anime-modal-summary-text anime-modal-summary-hint",children:"Synopsis hidden. Click reveal to view."})]})}function bR(){const n={game:"pokemon",name:"",setName:"",number:"",rarity:"",condition:"",quantity:1,pricePaid:"",estimatedValue:"",image:"",productURL:"",notes:""},{admin:e,user:t}=za(),[s,a]=j.useState(()=>localStorage.getItem("tcgLastGame")||n.game),[l,d]=j.useState([]),[f,m]=j.useState(!0),[v,w]=j.useState(""),[T,I]=j.useState("all"),[U,X]=j.useState("name"),[$,O]=j.useState(!1),[se,Te]=j.useState([]),[xe,_e]=j.useState(""),[V,ie]=j.useState(null),[C,P]=j.useState(!1),[A,M]=j.useState(()=>({...n,game:s}));j.useEffect(()=>{document.title="TCG | Collection"},[]),j.useEffect(()=>{let k=!1;const q=async()=>{if(!k)try{const De=await fetch("/base/tcg-collection.json",{cache:"no-cache"});if(!De.ok)throw new Error("fallback fetch failed");const Fe=await De.json(),Qe=Array.isArray(Fe.tcg)?Fe.tcg:[];k||d(Qe.map((st,ye)=>({id:st.id||`offline-${ye}`,...st})))}catch(Le){console.error("TCG offline fallback failed",Le)}finally{k||m(!1)}};async function Ee(){m(!0);try{const Le=Sn(ot,"tcg"),De=await vs(Le),Fe=[];De.forEach(Qe=>Fe.push({id:Qe.id,...Qe.data()})),k||d(Fe)}catch(Le){console.error("Error loading TCG:",Le),await q()}finally{k||m(!1)}}return Ee(),()=>{k=!0}},[t]);const D=l.filter(k=>{if(T!=="all"&&k.game!==T)return!1;if(!v)return!0;const q=v.toLowerCase();return(k.name||"").toLowerCase().includes(q)||(k.setName||"").toLowerCase().includes(q)||(k.number||"").toLowerCase().includes(q)}),N=[...D].sort((k,q)=>{const Ee=(k.name||"").toLowerCase(),Le=(q.name||"").toLowerCase(),De=(k.setName||"").toLowerCase(),Fe=(q.setName||"").toLowerCase(),Qe=(k.rarity||"").toLowerCase(),st=(q.rarity||"").toLowerCase(),ye=Number(k.quantity||0),ce=Number(q.quantity||0),Me=Number(k.estimatedValue||0)*Math.max(1,ye),me=Number(q.estimatedValue||0)*Math.max(1,ce);switch(U){case"set":return De.localeCompare(Fe)||Ee.localeCompare(Le);case"rarity":return Qe.localeCompare(st)||Ee.localeCompare(Le);case"quantity":return ce-ye||Ee.localeCompare(Le);case"value":return me-Me||Ee.localeCompare(Le);case"name":default:return Ee.localeCompare(Le)}}),b=l.reduce((k,q)=>{const Ee=Number(q.quantity||1),Le=Number(q.pricePaid||0),De=Number(q.estimatedValue||0);k.totalCards+=Ee,k.totalPaid+=Ee*Le,k.totalValue+=Ee*De;const Fe=(q.game||"").toLowerCase(),Qe=Ee*De;return Fe==="pokemon"?(k.pokemon+=Ee,k.valueByGame.pokemon+=Qe):Fe==="onepiece"?(k.onepiece+=Ee,k.valueByGame.onepiece+=Qe):Fe==="mtg"?(k.mtg+=Ee,k.valueByGame.mtg+=Qe):k.valueByGame.other+=Qe,k},{totalCards:0,totalPaid:0,totalValue:0,pokemon:0,onepiece:0,mtg:0,valueByGame:{pokemon:0,onepiece:0,mtg:0,other:0}}),J=b.totalValue-b.totalPaid,ne=[["Pokemon",b.valueByGame.pokemon],["One Piece",b.valueByGame.onepiece],["MTG",b.valueByGame.mtg],["Other",b.valueByGame.other]].filter(([,k])=>k>0).map(([k,q])=>`${k}: $${q.toFixed(2)}`),Re=ne.length?ne.join(`
`):"No value data yet",he=(k,q)=>{if(k==="game"){a(q);try{localStorage.setItem("tcgLastGame",q)}catch{}}M(Ee=>({...Ee,[k]:q}))},le=async()=>{if(!e)return;if(!A.name.trim()){alert("Card name is required.");return}const k={game:A.game,name:A.name.trim(),setName:A.setName.trim(),number:A.number.trim(),rarity:A.rarity.trim(),condition:A.condition.trim(),quantity:Number(A.quantity||1),pricePaid:Number(A.pricePaid||0),estimatedValue:Number(A.estimatedValue||0),image:A.image.trim(),productURL:A.productURL.trim(),notes:A.notes.trim()},q=De=>({game:(De.game||"").toLowerCase().trim(),name:(De.name||"").toLowerCase().trim(),setName:(De.setName||"").toLowerCase().trim(),number:(De.number||"").toLowerCase().trim(),rarity:(De.rarity||"").toLowerCase().trim(),condition:(De.condition||"").toLowerCase().trim(),pricePaid:Number(De.pricePaid||0),estimatedValue:Number(De.estimatedValue||0),image:(De.image||"").trim(),productURL:(De.productURL||"").trim(),notes:(De.notes||"").trim()}),Ee=q(k),Le=l.find(De=>{const Fe=q(De);return Fe.game===Ee.game&&Fe.name===Ee.name&&Fe.setName===Ee.setName&&Fe.number===Ee.number&&Fe.rarity===Ee.rarity&&Fe.condition===Ee.condition&&Fe.pricePaid===Ee.pricePaid&&Fe.estimatedValue===Ee.estimatedValue&&Fe.image===Ee.image&&Fe.productURL===Ee.productURL&&Fe.notes===Ee.notes});try{const De=Sn(ot,"tcg");if(Le!=null&&Le.id){const Fe=Number(Le.quantity||1)+k.quantity;await _s(Dt(ot,"tcg",Le.id),{quantity:Fe}),d(Qe=>Qe.map(st=>st.id===Le.id?{...st,quantity:Fe}:st))}else{await Ra(De,k);const Fe=await vs(De),Qe=[];Fe.forEach(st=>Qe.push({id:st.id,...st.data()})),d(Qe)}M({...n,game:s}),P(!1)}catch(De){console.error("Error adding card:",De),alert("Failed to save card.")}},Ie=async()=>{if(!e||!V)return;if(!V.name.trim()){alert("Card name is required.");return}const k={game:V.game,name:V.name.trim(),setName:V.setName.trim(),number:V.number.trim(),rarity:V.rarity.trim(),condition:V.condition.trim(),quantity:Number(V.quantity||1),pricePaid:Number(V.pricePaid||0),estimatedValue:Number(V.estimatedValue||0),image:V.image?V.image.trim():"",productURL:V.productURL?V.productURL.trim():"",notes:V.notes?V.notes.trim():""};try{await _s(Dt(ot,"tcg",V.id),k),d(q=>q.map(Ee=>Ee.id===V.id?{...Ee,...k}:Ee)),ie(null)}catch(q){console.error("Error updating card:",q),alert("Failed to update card.")}},ve=async k=>{if(e&&window.confirm("Delete this card?"))try{await Na(Dt(ot,"tcg",k)),d(q=>q.filter(Ee=>Ee.id!==k))}catch(q){console.error("Delete error:",q),alert("Failed to delete card.")}},Y=()=>{if(!l.length){alert("No cards to export.");return}const k=new Blob([JSON.stringify({tcg:l},null,2)],{type:"application/json"}),q=URL.createObjectURL(k),Ee=document.createElement("a");Ee.href=q,Ee.download="tcg-collection.json",Ee.click(),URL.revokeObjectURL(q)};return o.jsxs("main",{className:"page",children:[o.jsxs("header",{style:{marginTop:"32px",marginBottom:"16px",display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",gap:"6px"},children:[o.jsx("h1",{style:{margin:0,fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Tyler's TCG Collection"}),o.jsx("p",{style:{margin:"6px 0 0",color:"var(--text-soft)",fontSize:"0.9rem"},children:"Check out my TCG Collection with all the data of how much I spent (Under construction) and how much my collection is worth in total!"}),e&&o.jsx("div",{style:{marginTop:"10px"},children:o.jsx("button",{className:"manga-btn secondary",type:"button",onClick:Y,children:"Export JSON"})})]}),e&&o.jsx("button",{className:"manga-btn",type:"button","aria-label":"Add card",onClick:()=>P(!0),style:{position:"fixed",bottom:"20px",right:"20px",zIndex:1e3,width:"56px",height:"56px",borderRadius:"50%",padding:0,fontSize:"28px",display:"flex",alignItems:"center",justifyContent:"center"},children:"+"}),e&&C&&o.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(8,1,10,0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,padding:"12px"},onClick:k=>{k.target===k.currentTarget&&P(!1)},children:o.jsxs("div",{style:{width:"min(720px, 95vw)",background:"#140710",border:"1px solid rgba(255,182,193,0.3)",borderRadius:"12px",padding:"14px",boxShadow:"0 24px 60px rgba(0,0,0,0.85)"},onClick:k=>k.stopPropagation(),children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx("h2",{style:{margin:0,color:"#ffb6c1"},children:"Add card"}),o.jsx("button",{className:"dashboard-close",onClick:()=>P(!1),type:"button","aria-label":"Close",children:"X"})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"180px 1fr",gap:"12px",alignItems:"flex-start",marginTop:"10px"},children:[o.jsx("div",{style:{width:"100%",maxWidth:"180px",borderRadius:"10px",border:"1px solid rgba(255,182,193,0.25)",background:"#1e0d14",overflow:"hidden",aspectRatio:"3 / 4",display:"flex",alignItems:"center",justifyContent:"center"},children:A.image?o.jsx("img",{src:A.image,alt:"Card preview",style:{width:"100%",height:"100%",objectFit:"cover"}}):o.jsx("div",{style:{color:"var(--text-soft)",fontSize:"0.8rem",padding:"6px"},children:"No image"})}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:"8px"},children:[o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Game",o.jsxs("select",{value:A.game,onChange:k=>he("game",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"},children:[o.jsx("option",{value:"pokemon",children:"Pokemon"}),o.jsx("option",{value:"onepiece",children:"One Piece"}),o.jsx("option",{value:"mtg",children:"MTG"})]})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Card name",o.jsx("input",{type:"text",value:A.name,onChange:k=>he("name",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Set name",o.jsx("input",{type:"text",value:A.setName,onChange:k=>he("setName",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Card number",o.jsx("input",{type:"text",value:A.number,onChange:k=>he("number",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Rarity",o.jsx("input",{type:"text",value:A.rarity,onChange:k=>he("rarity",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Condition",o.jsx("input",{type:"text",value:A.condition,onChange:k=>he("condition",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Quantity",o.jsx("input",{type:"number",min:"1",value:A.quantity,onChange:k=>he("quantity",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Price paid (per card)",o.jsx("input",{type:"number",step:"0.01",min:"0",value:A.pricePaid,onChange:k=>he("pricePaid",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Estimated value (per card)",o.jsx("input",{type:"number",step:"0.01",min:"0",value:A.estimatedValue,onChange:k=>he("estimatedValue",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Image URL",o.jsx("input",{type:"text",value:A.image||"",onChange:k=>he("image",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Product URL (backend only)",o.jsx("input",{type:"text",value:A.productURL||"",onChange:k=>he("productURL",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{gridColumn:"1 / -1",fontSize:"0.8rem",color:"var(--text-soft)"},children:["Notes",o.jsx("textarea",{value:A.notes,onChange:k=>he("notes",k.target.value),rows:3,style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff",resize:"vertical"}})]})]})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"12px"},children:[o.jsx("button",{onClick:()=>{M(n),P(!1)},style:{padding:"6px 12px",borderRadius:"999px",border:"1px solid rgba(255,182,193,0.5)",background:"transparent",color:"#ffb6c1",cursor:"pointer"},children:"Cancel"}),o.jsx("button",{onClick:le,style:{padding:"6px 12px",borderRadius:"999px",border:"none",cursor:"pointer",fontWeight:600,background:"#ff69b4",color:"#1e0d14"},children:"Save card"})]})]})}),e&&V&&o.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(8,1,10,0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,padding:"12px"},onClick:k=>{k.target===k.currentTarget&&ie(null)},children:o.jsxs("div",{style:{width:"min(720px, 95vw)",background:"#140710",border:"1px solid rgba(255,182,193,0.3)",borderRadius:"12px",padding:"14px",boxShadow:"0 24px 60px rgba(0,0,0,0.85)"},onClick:k=>k.stopPropagation(),children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx("h2",{style:{margin:0,color:"#ffb6c1"},children:"Edit card"}),o.jsx("button",{className:"dashboard-close",onClick:()=>ie(null),type:"button","aria-label":"Close",children:"X"})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"180px 1fr",gap:"12px",alignItems:"flex-start",marginTop:"10px"},children:[o.jsx("div",{style:{width:"100%",maxWidth:"180px",borderRadius:"10px",border:"1px solid rgba(255,182,193,0.25)",background:"#1e0d14",overflow:"hidden",aspectRatio:"3 / 4",display:"flex",alignItems:"center",justifyContent:"center"},children:V.image?o.jsx("img",{src:V.image,alt:"Card preview",style:{width:"100%",height:"100%",objectFit:"cover"}}):o.jsx("div",{style:{color:"var(--text-soft)",fontSize:"0.8rem",padding:"6px"},children:"No image"})}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:"8px"},children:[o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Game",o.jsxs("select",{value:V.game,onChange:k=>ie(q=>({...q,game:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"},children:[o.jsx("option",{value:"pokemon",children:"Pokemon"}),o.jsx("option",{value:"onepiece",children:"One Piece"}),o.jsx("option",{value:"mtg",children:"MTG"})]})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Card name",o.jsx("input",{type:"text",value:V.name,onChange:k=>ie(q=>({...q,name:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Set name",o.jsx("input",{type:"text",value:V.setName,onChange:k=>ie(q=>({...q,setName:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Card number",o.jsx("input",{type:"text",value:V.number,onChange:k=>ie(q=>({...q,number:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Rarity",o.jsx("input",{type:"text",value:V.rarity,onChange:k=>ie(q=>({...q,rarity:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Condition",o.jsx("input",{type:"text",value:V.condition,onChange:k=>ie(q=>({...q,condition:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Quantity",o.jsx("input",{type:"number",value:V.quantity,onChange:k=>ie(q=>({...q,quantity:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Price paid (each)",o.jsx("input",{type:"number",value:V.pricePaid,onChange:k=>ie(q=>({...q,pricePaid:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Estimated value (each)",o.jsx("input",{type:"number",value:V.estimatedValue,onChange:k=>ie(q=>({...q,estimatedValue:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Image URL",o.jsx("input",{type:"text",value:V.image||"",onChange:k=>ie(q=>({...q,image:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Product URL (backend only)",o.jsx("input",{type:"text",value:V.productURL||"",onChange:k=>ie(q=>({...q,productURL:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{gridColumn:"1 / -1",fontSize:"0.8rem",color:"var(--text-soft)"},children:["Notes",o.jsx("textarea",{value:V.notes||"",onChange:k=>ie(q=>({...q,notes:k.target.value})),rows:3,style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff",resize:"vertical"}})]})]})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"12px"},children:[o.jsx("button",{onClick:()=>ie(null),style:{padding:"6px 12px",borderRadius:"999px",border:"1px solid rgba(255,182,193,0.5)",background:"transparent",color:"#ffb6c1",cursor:"pointer"},children:"Cancel"}),o.jsx("button",{onClick:Ie,style:{padding:"6px 12px",borderRadius:"999px",border:"none",cursor:"pointer",fontWeight:600,background:"#ff69b4",color:"#1e0d14"},children:"Save changes"})]})]})}),o.jsxs("section",{style:{display:"flex",flexWrap:"wrap",gap:"12px",marginTop:"18px",justifyContent:"center"},children:[o.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[o.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Total cards"}),o.jsx("div",{style:{fontSize:"1.1rem",fontWeight:700},children:b.totalCards})]}),b.totalPaid>0&&o.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[o.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Total paid"}),o.jsxs("div",{style:{fontSize:"1.1rem",fontWeight:700},children:["$",b.totalPaid.toFixed(2)]})]}),o.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},title:Re,children:[o.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Total value"}),o.jsxs("div",{style:{fontSize:"1.1rem",fontWeight:700},children:["$",b.totalValue.toFixed(2)]})]}),o.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[o.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Unrealized gain / loss"}),o.jsxs("div",{style:{fontSize:"1.1rem",fontWeight:700,color:J>=0?"#00e676":"#ff8a80"},children:[J>=0?"+":"-","$",Math.abs(J).toFixed(2)]})]}),o.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[o.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Pokemon cards"}),o.jsx("div",{style:{fontSize:"1.1rem",fontWeight:700},children:b.pokemon})]}),o.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[o.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"One Piece cards"}),o.jsx("div",{style:{fontSize:"1.1rem",fontWeight:700},children:b.onepiece})]}),o.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[o.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"MTG cards"}),o.jsx("div",{style:{fontSize:"1.1rem",fontWeight:700},children:b.mtg})]})]}),o.jsxs("section",{style:{display:"flex",flexWrap:"wrap",gap:"10px",marginTop:"16px"},children:[o.jsx("input",{type:"text",placeholder:"Search by name, set, or number...",value:v,onChange:k=>w(k.target.value),style:{flex:"1 1 220px",minWidth:"220px",padding:"8px 12px",borderRadius:"999px",border:"1px solid #bb7f8f",background:"#2b0f1d",color:"#fff"}}),o.jsxs("select",{value:T,onChange:k=>I(k.target.value),style:{flex:"0 0 220px",padding:"8px 12px",borderRadius:"999px",border:"1px solid #bb7f8f",background:"#2b0f1d",color:"#fff"},children:[o.jsx("option",{value:"all",children:"All games"}),o.jsx("option",{value:"pokemon",children:"Pokemon only"}),o.jsx("option",{value:"onepiece",children:"One Piece only"}),o.jsx("option",{value:"mtg",children:"MTG only"})]}),o.jsxs("select",{value:U,onChange:k=>X(k.target.value),style:{flex:"0 0 220px",padding:"8px 12px",borderRadius:"999px",border:"1px solid #bb7f8f",background:"#2b0f1d",color:"#fff"},children:[o.jsx("option",{value:"name",children:"Sort: Name (A-Z)"}),o.jsx("option",{value:"set",children:"Sort: Set (A-Z)"}),o.jsx("option",{value:"rarity",children:"Sort: Rarity (A-Z)"}),o.jsx("option",{value:"quantity",children:"Sort: Quantity (high to low)"}),o.jsx("option",{value:"value",children:"Sort: Value (high to low)"})]})]}),f?o.jsx("p",{style:{marginTop:"20px",color:"var(--text-soft)"},children:"Loading TCG collection..."}):D.length===0?o.jsx("p",{style:{marginTop:"20px",color:"var(--text-soft)"},children:"No cards found."}):o.jsx("section",{className:"grid",style:{gridTemplateColumns:"repeat(auto-fill, minmax(170px, 1fr))",marginTop:"20px"},children:N.map(k=>{const q=Number(k.quantity||1),Ee=q*Number(k.pricePaid||0),Le=q*Number(k.estimatedValue||0);return o.jsxs("article",{style:{background:"#2b0f1d",borderRadius:"12px",border:"1px solid rgba(255,182,193,0.25)",boxShadow:"0 4px 16px rgba(0,0,0,0.55)",padding:"10px",fontSize:"0.82rem",display:"flex",flexDirection:"column",gap:"6px"},children:[k.image&&o.jsx("div",{style:{width:"100%",paddingTop:"140%",position:"relative",overflow:"hidden",borderRadius:"10px",background:"#1e0d14"},children:o.jsx("img",{src:k.image,alt:k.name||"card image",style:{position:"absolute",inset:0,width:"100%",height:"100%",objectFit:"contain"}})}),o.jsx("div",{style:{fontWeight:700,color:"#ffb6c1",marginBottom:"4px"},children:k.name||"Unnamed card"}),o.jsx("div",{style:{color:"var(--text-soft)",marginBottom:"4px"},children:k.setName||""}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",color:"var(--text-soft)"},children:[o.jsxs("span",{children:["#",k.number||"-"]}),o.jsx("span",{children:k.rarity||""})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",color:"var(--text-soft)",marginTop:"4px"},children:[o.jsxs("span",{children:["Cond: ",k.condition||"N/A"]}),o.jsxs("span",{children:["Qty: ",q]})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",color:"var(--text-soft)",marginTop:"4px"},children:[o.jsxs("span",{children:["Paid: $",Ee.toFixed(2)]}),o.jsxs("span",{children:["Value: $",Le.toFixed(2)]})]}),k.notes&&o.jsxs("div",{style:{color:"#9c8fa6",fontSize:"0.72rem",fontStyle:"italic",textAlign:"center",marginTop:"6px"},children:['"',k.notes,'"']}),o.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"8px"},children:[o.jsx("span",{style:{padding:"2px 7px",borderRadius:"999px",background:"rgba(255,105,180,0.18)",border:"1px solid rgba(255,105,180,0.5)",color:"#ffb6c1",fontSize:"0.7rem",whiteSpace:"nowrap"},children:{pokemon:"Pokemon",onepiece:"One Piece",mtg:"MTG"}[k.game]||"Other"}),e&&o.jsxs("div",{style:{display:"flex",gap:"6px",alignItems:"center",marginLeft:"auto"},children:[o.jsx("button",{onClick:()=>ie({...k,pricePaid:k.pricePaid??"",estimatedValue:k.estimatedValue??"",quantity:k.quantity??1}),style:{padding:"3px 8px",borderRadius:"999px",border:"1px solid rgba(255,182,193,0.5)",background:"rgba(255,105,180,0.15)",color:"#ffb6c1",fontSize:"0.7rem",cursor:"pointer"},children:"Edit"}),o.jsx("button",{onClick:()=>ve(k.id),style:{padding:"3px 8px",borderRadius:"999px",border:"1px solid rgba(244,67,54,0.7)",background:"rgba(244,67,54,0.12)",color:"#ff8a80",fontSize:"0.7rem",cursor:"pointer"},children:"Delete"})]})]})]},k.id)})})]})}const Il="https://discord.com/api/webhooks/1448287168845054004/cGWGPoH5LaTFlBZ1vxtgMjOfV9au6qyQ_9ZRnOWN9-AX0MNfwxKNWVcZYQHz0ESA7_4k",Pl="https://discord.com/api/webhooks/1448288240871276616/101WI-B2p8tDR34Hl9fZxxb0QG01f1Eo5w1IvbttlQmP2wWFNJ0OI7UnJfJujKRNWW2Q";function mc(n){const e=n==null?"":String(n);return e.trim()?e.replace(/\s*,?\s*(?:vol(?:ume)?\.?)\s+\d+.*$/i,"").trim():""}function vi(n){if(!n)return null;if(n instanceof Date)return n;if(n&&typeof n.toDate=="function")return n.toDate();const e=String(n).trim();if(!e)return null;const t=e.match(/^(\d{4})-(\d{2})-(\d{2})$/);if(t){const[,l,d,f]=t;return new Date(Number(l),Number(d)-1,Number(f))}const s=e.match(/^(\d{1,2})\/(\d{1,2})\/(\d{2,4})$/);if(s){let[,l,d,f]=s;const m=f.length===2?+`20${f}`:Number(f);return new Date(m,Number(l)-1,Number(d))}const a=new Date(e);return isNaN(a.getTime())?null:a}function Ad(n){const e=n.seriesKey||n.series||n.Series||n.title||n.Title||"",s=(mc(e)||e).trim();return s?s.toLowerCase():""}function CR(n){const e=(n==null?void 0:n.series)||(n==null?void 0:n.Series)||(n==null?void 0:n.title)||(n==null?void 0:n.Title)||"Unknown Series";return mc(e)||"Unknown Series"}function E_(n){const e=(n||"").trim(),t=e.match(/^(.*?)(?:,?\s*(?:vol\.|volume)\s*(\d+)(?:\s*[-]\s*\d+)?\s*)?(?:\s*\([^)]*\))?$/i),s=t?t[1].trim().toLowerCase():e.toLowerCase(),a=t&&t[2]?parseInt(t[2],10):0;return{name:s,vol:Number.isFinite(a)?a:0}}function IR(n,e){const t=(n==null?void 0:n.Title)||(n==null?void 0:n.title)||"",s=(e==null?void 0:e.Title)||(e==null?void 0:e.title)||"",a=E_(t),l=E_(s),d=a.name.localeCompare(l.name);return d!==0?d:a.vol!==l.vol?a.vol-l.vol:t.localeCompare(s)}function yf(){return{publisher:"",demographic:"",genre:"",subGenre:"",datePurchased:"",msrp:"",initialPublisher:"",initialDemographic:"",initialGenre:"",initialSubGenre:"",initialDatePurchased:"",initialMsrp:"",dateMixed:!1,readChecked:!1,readIndeterminate:!1}}function T_(){return{read:!1,datePurchased:"",dateRead:"",pageCount:"",msrp:"",amountPaid:"",rating:"",special:!1,specialType:"",specialVolumes:"",collectiblePrice:""}}function S_(n,e={}){const t=e.ignoreShared,s=(n==null?void 0:n.amountPaid)??(n==null?void 0:n.AmountPaid)??(n==null?void 0:n.paid)??(n==null?void 0:n.Paid)??"",a=(n==null?void 0:n.msrp)??(n==null?void 0:n.MSRP)??"",l=((n==null?void 0:n.datePurchased)||(n==null?void 0:n.DatePurchased)||"").trim(),d=((n==null?void 0:n.publisher)||(n==null?void 0:n.Publisher)||"").trim(),f=((n==null?void 0:n.demographic)||(n==null?void 0:n.Demographic)||"").trim(),m=((n==null?void 0:n.genre)||(n==null?void 0:n.Genre)||"").trim(),v=((n==null?void 0:n.specialType)||(n==null?void 0:n.SpecialType)||"").trim(),w=(n==null?void 0:n.specialVolumes)??(n==null?void 0:n.SpecialVolumes)??(n==null?void 0:n.volumesContained)??"",T=(n==null?void 0:n.collectiblePrice)??(n==null?void 0:n.CollectiblePrice)??"",I=!!v,U=(n==null?void 0:n.pageCount)??(n==null?void 0:n.PageCount)??(n==null?void 0:n.pages)??(n==null?void 0:n.Pages)??"",X=U==null?"":String(U).trim(),$=Number(X),O=!X||Number.isNaN($)||$<=0;return!I&&(s===""||s===null)||O||!l||!t&&(a===""||!d||!f||!m)||I&&!v||I&&v.toLowerCase()==="collectible"&&(T===""||T===null)||I&&v.toLowerCase()==="specialedition"&&(w===""||w===null)}function PR(n){const e=(n==null?void 0:n.amountPaid)??"",t=((n==null?void 0:n.datePurchased)||"").trim(),s=!!(n!=null&&n.specialType)||!!(n!=null&&n.special),a=((n==null?void 0:n.specialType)||"").trim(),l=(n==null?void 0:n.specialVolumes)??"",d=(n==null?void 0:n.collectiblePrice)??"",f=(n==null?void 0:n.pageCount)??"",m=(n==null?void 0:n.msrp)??"",v=((n==null?void 0:n.publisher)||"").trim(),w=((n==null?void 0:n.demographic)||"").trim(),T=((n==null?void 0:n.genre)||"").trim(),I=!s&&(e===""||e===null),U=s&&!a,X=s&&a.toLowerCase()==="collectible"&&(d===""||d===null),$=s&&a.toLowerCase()==="specialedition"&&(l===""||l===null),O=(()=>{const se=(f??"").toString().trim();if(se==="")return!0;const Te=Number(se);return Number.isNaN(Te)||Te<=0})();return{amountPaid:I,datePurchased:!t,specialType:U,collectiblePrice:X,specialVolumes:$,pageCount:O,msrp:m===""||m===null,publisher:!v,demographic:!w,genre:!T}}function NR(n){return!n||!n.books||!n.books.length?!1:n.books.some(e=>{const t=(e==null?void 0:e.msrp)??(e==null?void 0:e.MSRP)??"",s=((e==null?void 0:e.publisher)||(e==null?void 0:e.Publisher)||"").trim(),a=((e==null?void 0:e.demographic)||(e==null?void 0:e.Demographic)||"").trim(),l=((e==null?void 0:e.genre)||(e==null?void 0:e.Genre)||"").trim();return t===""||!s||!a||!l})}function RR(n){const e=new Map;for(const t of n){const s=Ad(t)||t.id;if(!e.has(s)){const m=mc(t.series||t.Series||t.title||t.Title||"Unknown Series")||"Unknown Series";e.set(s,{key:s,title:m,publisher:t.publisher||t.Publisher||"",genre:t.genre||t.Genre||"",demographic:t.demographic||t.Demographic||"",volumes:0,totalPages:0,readPages:0,readVolumes:0,ratingSum:0,ratingCount:0})}const a=e.get(s);a.volumes+=1;const l=Number(t.pages||t.Pages||t.pageCount||0)||0;a.totalPages+=l,(!!t.read||t.status==="Read"||t.Read===!0)&&(a.readVolumes+=1,a.readPages+=l);const f=Number(t.rating||t.Rating);!isNaN(f)&&f>0&&(a.ratingSum+=f,a.ratingCount+=1)}return e}function Eo(n,e,t=5){const s=new Map;for(const a of n.values()){const l=(a[e]||"").trim();if(!l)continue;const d=l.split(/[\/,]/).map(f=>f.trim()).filter(Boolean);for(const f of d)s.set(f,(s.get(f)||0)+1)}return[...s.entries()].sort((a,l)=>l[1]-a[1]).slice(0,t).map(([a,l])=>({name:a,count:l}))}function b_(n,e){const t=Array.from({length:12},(s,a)=>{const l=new Date(e,a,1);return{key:`${e}-${a}`,label:l.toLocaleString("default",{month:"short"}),year:e,month:a,value:0}});for(const s of n){const a=vi(s.dateRead||s.DateRead);!a||a.getFullYear()!==e||(t[a.getMonth()].value+=1)}return t}function Ca(n){const e=n.getFullYear(),t=`${n.getMonth()+1}`.padStart(2,"0"),s=`${n.getDate()}`.padStart(2,"0");return`${e}-${t}-${s}`}async function C_(n,e){try{await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:e})})}catch(t){console.error("Webhook post failed",t)}}function AR(n){const e=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],t=Array(7).fill(0);for(const l of n){const d=vi(l.dateRead||l.DateRead);d&&(t[d.getDay()]+=1)}if(!t.some(l=>l>0))return[];const a=t.reduce((l,d)=>Math.max(l,d),0)||1;return e.map((l,d)=>({label:l,value:t[d],pct:t[d]/a}))}function jR(n,e=8){const t=[...n.values()];t.sort((l,d)=>d.volumes-l.volumes);const s=t.slice(0,e),a=s.reduce((l,d)=>Math.max(l,d.volumes),0)||1;return s.map(l=>({label:l.title,value:l.volumes,pct:l.volumes/a}))}function kR(n,e){const t=(a,l)=>{const d=vi(a.releaseDate||a.ReleaseDate||a.date||a.Date);if(!d)return null;const f=(a.title||a.series||a.Title||"Unknown Title").trim(),m=!!(a.datePurchased||a.DatePurchased||"").trim();return{date:d,title:f,purchased:m,source:l}},s=[];return(e||[]).forEach(a=>{const l=t(a,"wishlist");l&&s.push(l)}),(n||[]).forEach(a=>{const l=t(a,"library");l&&s.push(l)}),s.sort((a,l)=>a.date-l.date),s}function DR(n){const e=new Date;for(const t of n)if(t.date>=e)return t;return n[n.length-1]||null}function LR(n){let e=0,t=0;for(const s of n){const a=vi(s.datePurchased||s.DatePurchased),l=vi(s.dateRead||s.DateRead);if(!a||!l)continue;const d=l-a;d<=0||(e+=d/(1e3*60*60*24),t+=1)}return t?e/t:null}function VR(n){const e=new Map;for(const t of n){const s=vi(t.datePurchased||t.DatePurchased),a=vi(t.dateRead||t.DateRead);if(!s||!a)continue;const l=a-s;if(l<=0)continue;const d=l/(1e3*60*60*24),f=Ad(t)||t.id,m=mc(t.series||t.Series||t.title||t.Title||"Untitled")||"Untitled";e.has(f)||e.set(f,{key:f,title:m,total:0,count:0,min:d,max:d});const v=e.get(f);v.total+=d,v.count+=1,v.min=Math.min(v.min,d),v.max=Math.max(v.max,d)}return[...e.values()].filter(t=>t.count>0).map(t=>({...t,avg:t.total/t.count})).sort((t,s)=>s.avg-t.avg)}function MR(n){let e=0,t=0,s=0;for(const a of n){const l=Number(a.msrp||a.MSRP||0)||0,d=Number(a.amountPaid||a.AmountPaid||a.pricePaid||0)||l||0,f=Number(a.collectiblePrice||a.CollectiblePrice||0)||0;e+=l,t+=d,s+=f}return{msrpTotal:e,paidTotal:t,collectibleTotal:s}}function OR(n){const e=new Map;for(const t of n){const s=Ad(t)||t.id;if(!e.has(s)){const T=t.series||t.Series||t.title||t.Title||"Untitled";e.set(s,{key:s,title:mc(T)||T.trim()||"Untitled",msrp:0,paid:0,collectible:0,books:0,pages:0,readPages:0,ratings:[]})}const a=e.get(s);a.books+=1;const l=Number(t.msrp||t.MSRP||0)||0,d=Number(t.amountPaid||t.AmountPaid||t.pricePaid||0)||0,f=Number(t.collectiblePrice||t.CollectiblePrice||0)||0,m=Number(t.pages||t.Pages||t.pageCount||0)||0,v=!!t.read||t.status==="Read"||t.Read===!0;a.msrp+=l,a.paid+=d,a.collectible+=f,a.pages+=m,v&&(a.readPages+=m);const w=Number(t.rating||t.Rating);!isNaN(w)&&w>0&&a.ratings.push(w)}return[...e.values()]}function FR(n){let e=0,t=0;for(const s of n){const a=Number(s.pages||s.Pages||s.pageCount||0)||0;e+=a,(!!s.read||s.status==="Read"||s.Read===!0)&&(t+=a)}return{total:e,read:t}}function UR(n){let e=0,t=0;for(const s of n.values())s.ratingCount>0&&(e+=s.ratingSum/s.ratingCount,t+=1);return t?e/t:null}function zR({data:n}){if(!n||!n.length)return o.jsx("div",{className:"line-chart empty",children:"No reading data yet."});const e=n.reduce((v,w)=>Math.max(v,w.value),0)||1,t=480,s=230,a=30,l=s-a*2,d=t/Math.max(n.length-1,1),f=n.map((v,w)=>{const T=w*d,I=s-a-v.value/e*l;return{...v,x:T,y:I}}),m=f.map((v,w)=>w===0?`M ${v.x} ${v.y}`:`L ${v.x} ${v.y}`).join(" ");return o.jsx("div",{className:"line-chart",children:o.jsxs("svg",{viewBox:`0 0 ${t} ${s}`,width:"100%",height:"100%",preserveAspectRatio:"xMidYMid meet",children:[[0,.25,.5,.75,1].map((v,w)=>{const T=s-a-v*l;return o.jsx("line",{className:"line-grid",x1:"0",x2:t,y1:T,y2:T},`h-${w}`)}),f.map((v,w)=>o.jsx("line",{className:"line-grid",x1:v.x,x2:v.x,y1:a/2,y2:s-a/2},`v-${w}`)),o.jsx("path",{className:"line-path",d:m}),f.map((v,w)=>o.jsxs("g",{children:[o.jsx("circle",{className:"line-point",cx:v.x,cy:v.y,r:"1.5"}),o.jsx("text",{className:"line-value",x:v.x,y:v.y-3,children:v.value}),o.jsx("text",{className:"line-label",x:v.x,y:s-4,children:v.label})]},w))]})})}function BR({data:n}){return!n||!n.length?o.jsx("div",{className:"weekday-breakdown empty",children:"No reads recorded yet."}):o.jsx("div",{className:"weekday-bars",children:n.map(e=>o.jsxs("div",{className:"weekday-col",children:[o.jsx("div",{className:"weekday-count",children:e.value}),o.jsx("div",{className:"weekday-bar-vert",children:o.jsx("div",{className:"weekday-bar-vert-fill",style:{height:`${Math.max(e.pct*100,e.value?6:0)}%`}})}),o.jsx("div",{className:"weekday-label",children:e.label})]},e.label))})}function I_(n,e,t){const s=n.getFullYear(),a=n.getMonth(),d=new Date(s,a,1).getDay(),f=new Date(s,a+1,0).getDate(),m=new Map;for(const T of e){const I=T.date;if(I.getFullYear()===s&&I.getMonth()===a){const U=I.getDate();m.has(U)||m.set(U,[]),m.get(U).push(T)}}const v=[];for(let T=0;T<d;T++)v.push({type:"pad"});for(let T=1;T<=f;T++){const I=Ca(new Date(s,a,T));v.push({type:"day",day:T,releases:m.get(T)||[],dateKey:I,isToday:I===t})}const w=Math.ceil(v.length/7)*7;for(;v.length<w;)v.push({type:"pad"});return v}function $R(){const{user:n,admin:e,loading:t}=za(),[s,a]=j.useState([]),[l,d]=j.useState([]),[f,m]=j.useState(!0),[v,w]=j.useState(null),[T,I]=j.useState("-"),[U,X]=j.useState({yearly:Il,release:Pl,activity:Ia}),[$,O]=j.useState(new Set),[se,Te]=j.useState(null),[xe,_e]=j.useState(null),[V,ie]=j.useState(new Set),[C,P]=j.useState(null),[A,M]=j.useState(""),D=j.useRef(null),[N,b]=j.useState(()=>yf()),[J,ne]=j.useState(()=>T_()),[Re,he]=j.useState([]),[le,Ie]=j.useState(!1),[ve,Y]=j.useState([]),[k,q]=j.useState(!1),[Ee,Le]=j.useState([]),[De,Fe]=j.useState(!1),[Qe,st]=j.useState(""),[ye,ce]=j.useState(null),[Me,me]=j.useState(null),He=async()=>{if(e)try{q(!0);const z=(await vs(Sn(ot,"users"))).docs.map(Q=>({uid:Q.id,...Q.data()}));Y(z)}catch(S){console.error("Failed to load users",S)}finally{q(!1)}},Ye=async(S,z)=>{const Q=(S||"").trim();if(!Q){alert("UID is required.");return}try{await ci(Dt(ot,"users",Q),{role:z,updatedBy:(n==null?void 0:n.uid)||"manual",updatedAt:new Date().toISOString()},{merge:!0}),await He()}catch(fe){console.error("Failed to update role",fe),alert("Failed to update role.")}},[Tt,Ct]=j.useState(!1),[gt,Nt]=j.useState(()=>new Date),[Qt,tn]=j.useState(!1),[nn,lr]=j.useState(()=>new Date),[rn,Kn]=j.useState(null),[Ot,$t]=j.useState(!1),[On,cr]=j.useState(()=>{const S=new Date;return{year:S.getFullYear(),month:S.getMonth()}}),[Cn,Fn]=j.useState(null),[Yt,es]=j.useState({open:!1,type:null}),In=new Date().getFullYear(),gn=j.useRef(null),ts=j.useRef(null);j.useEffect(()=>{document.title="Dashboard"},[]),j.useEffect(()=>(Tt||Yt.open||le||!!Me||Qt||!!rn||Ot||!!Cn?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[Tt,Yt.open,le,Me,Qt,rn,Ot,Cn]),j.useEffect(()=>{typeof window>"u"||(gn.current=localStorage.getItem("dashboard-yearly-posted"),ts.current=localStorage.getItem("dashboard-release-posted"))},[]),j.useEffect(()=>{if(!e)return;const S=Dt(ot,"settings","webhooks");(async()=>{try{const z=await Nd(S);if(z.exists()){const Q=z.data();X({yearly:Q.yearly||Il,release:Q.release||Pl,activity:Q.activity||Ia})}else await ci(S,{yearly:Il,release:Pl,activity:Ia}),X({yearly:Il,release:Pl,activity:Ia})}catch(z){console.error("Failed to load webhook settings",z)}})()},[e]),j.useEffect(()=>{if(!e)return;let S=!1;return(async()=>await He())(),()=>{S=!0}},[e]),j.useEffect(()=>{let S=!1;if(!n||!e){Le([]),st("");return}return(async()=>{try{Fe(!0);const Q=(await vs(Sn(ot,"suggestions"))).docs.map(fe=>{var Ne;const be=fe.data();let Ge=null;if((Ne=be==null?void 0:be.createdAt)!=null&&Ne.toDate)Ge=be.createdAt.toDate();else if(be!=null&&be.createdAt){const Je=new Date(be.createdAt);Ge=isNaN(Je.getTime())?null:Je}return{id:fe.id,...be,createdAt:Ge}});Q.sort((fe,be)=>{var Ge,Ne,Je,dt;return(((Ne=(Ge=be.createdAt)==null?void 0:Ge.getTime)==null?void 0:Ne.call(Ge))||0)-(((dt=(Je=fe.createdAt)==null?void 0:Je.getTime)==null?void 0:dt.call(Je))||0)}),S||(Le(Q),st(""))}catch(z){console.error("Failed to load suggestions",z),S||(st("Failed to load suggestions."),Le([]))}finally{S||Fe(!1)}})(),()=>{S=!0}},[n,e]);const Ts=async S=>{if(!(!e||!S))try{await Na(Dt(ot,"suggestions",S)),Le(z=>z.filter(Q=>Q.id!==S))}catch(z){console.error("Failed to delete suggestion",z),st("Failed to delete suggestion.")}};j.useEffect(()=>{let S=!1;async function z(){if(!n||!e){a([]),d([]),w(null),m(!1);return}try{m(!0);const[Q,fe]=await Promise.all([vs(Sn(ot,"library")),vs(Sn(ot,"wishlist"))]);if(S)return;a(Q.docs.map(be=>({id:be.id,...be.data()}))),d(fe.docs.map(be=>({id:be.id,...be.data()}))),w(null)}catch(Q){console.error(Q),S||w("Failed to load dashboard data.")}finally{S||m(!1)}}return z(),()=>{S=!0}},[n,e]);const Pt=j.useMemo(()=>{const S=s.length,z=s.filter(zn=>!!zn.read||zn.status==="Read"||zn.Read===!0).length,Q=S-z,fe=S?Math.round(z/S*100):0,be=l.length,Ge=RR(s),Ne=b_(s,In),Je=b_(s,In-1),dt=Ne.reduce((zn,cs)=>zn+cs.value,0),yt=AR(s),Lt=jR(Ge),St=kR(s,l),sn=DR(St),wn=LR(s),wt=MR(s),an=FR(s),Zn=UR(Ge),zr=VR(s),Rr=Eo(Ge,"publisher",5),Ys=Eo(Ge,"genre",5),Ba=Eo(Ge,"demographic",5),Ar=OR(s);return{totalLibrary:S,readCount:z,unreadCount:Q,readPct:fe,wishlistCount:be,seriesMap:Ge,monthlyReads:Ne,prevYearReads:Je,currentYearReadsTotal:dt,weekdayBreakdown:yt,topSeriesBars:Lt,releases:St,nextRelease:sn,avgDays:wn,purchaseToReadSeries:zr,collectionValue:wt,pages:an,avgRating:Zn,topPublishers:Rr,topGenres:Ys,topDemographics:Ba,seriesAggregates:Ar}},[s,l,In]),{totalLibrary:pr,readCount:Ss,unreadCount:Qn,readPct:Yn,wishlistCount:Ir,seriesMap:Pn,monthlyReads:Pr,prevYearReads:Jn,currentYearReadsTotal:Ws,weekdayBreakdown:mr,topSeriesBars:Gs,releases:rt,nextRelease:Xn,avgDays:Nn,purchaseToReadSeries:ns,collectionValue:Rn,pages:yn,avgRating:An,topPublishers:bs,topGenres:Cs,topDemographics:Un,seriesAggregates:Fr}=Pt,Ft=Xn?Xn.date:null,rs=!!v,un=Ca(new Date),Nr=j.useMemo(()=>s.map(S=>{const z=vi(S.dateRead||S.DateRead);return!z||!(S.read||S.status==="Read"||S.Read===!0)?null:{date:z,title:S.title||S.Title||"Untitled"}}).filter(Boolean).sort((S,z)=>S.date-z.date),[s]),qs=j.useMemo(()=>I_(nn,Nr,un),[nn,Nr,un]),Ur=j.useMemo(()=>{const S=new Map;return[...s,...l].forEach(Q=>{const fe=vi(Q.datePurchased||Q.DatePurchased);if(!fe)return;const be=Ca(fe);S.has(be)||S.set(be,[]),S.get(be).push({id:Q.id||Q.Title||Q.title||be,title:Q.title||Q.Title||"Untitled"})}),S.forEach(Q=>Q.sort((fe,be)=>(fe.title||"").localeCompare(be.title||""))),S},[s,l]),ss=j.useMemo(()=>{const{year:S,month:z}=On,fe=new Date(S,z,1).getDay(),be=new Date(S,z+1,0).getDate();let Ge=!1;const Ne=[];for(let dt=0;dt<fe;dt+=1)Ne.push({type:"pad"});for(let dt=1;dt<=be;dt+=1){const yt=new Date(S,z,dt),Lt=Ca(yt),St=Ur.get(Lt)||[];St.length&&(Ge=!0),Ne.push({type:"day",day:dt,dateKey:Lt,items:St,releases:St,isToday:Lt===un})}const Je=Math.ceil(Ne.length/7)*7;for(;Ne.length<Je;)Ne.push({type:"pad"});return{cells:Ne,hasItems:Ge}},[On,Ur,un]),vn=j.useMemo(()=>{if(!s||!s.length)return[];const S=new Map;s.forEach(Q=>{const fe=Ad(Q)||Q.id,be=CR(Q);S.has(fe)||S.set(fe,{seriesKey:fe,displayName:be,books:[]}),S.get(fe).books.push(Q)});const z=Array.from(S.values()).map(Q=>({...Q,books:[...Q.books].sort(IR)}));return z.sort((Q,fe)=>Q.displayName.localeCompare(fe.displayName)),z},[s]),Hs=j.useMemo(()=>vn.flatMap(S=>S.books.map(z=>z.id)),[vn]);j.useEffect(()=>{xe&&(s.some(S=>S.id===xe)||_e(null))},[s,xe]),j.useEffect(()=>{se&&(vn.some(S=>S.seriesKey===se)||Te(null))},[vn,se]),j.useEffect(()=>{if(!V.size)return;const S=new Set(s.map(Q=>Q.id)),z=Array.from(V).filter(Q=>!S.has(Q));z.length&&ie(Q=>{const fe=new Set(Q);return z.forEach(be=>fe.delete(be)),fe})},[s,V]),j.useEffect(()=>{const S=Array.from(V);if(!S.length){M("");return}const z=Array.from(new Set(S.map(Q=>s.find(fe=>fe.id===Q)).filter(Boolean).map(Q=>{const fe=Q.amountPaid??Q.AmountPaid??"";return fe==null?"":String(fe)})));M(z.length===1?z[0]:"")},[V,s]),j.useEffect(()=>{const S=vn.find(wt=>wt.seriesKey===se);if(!S){b(yf());return}const z=S.books,Q=wt=>{const an=Array.from(new Set(z.map(Zn=>{const zr=wt(Zn);return zr==null?"":String(zr).trim()})));return an.length===1?an[0]:""},fe=Q(wt=>wt.publisher||wt.Publisher),be=Q(wt=>wt.demographic||wt.Demographic),Ge=Q(wt=>wt.genre||wt.Genre),Ne=Q(wt=>wt.subGenre||wt.SubGenre),Je=Q(wt=>wt.msrp??wt.MSRP),dt=Array.from(new Set(z.map(wt=>(wt.datePurchased||wt.DatePurchased||"").trim()).filter(Boolean))),yt=dt.length>1,Lt=yt?"":dt[0]||"",St=z.filter(wt=>!!wt.read||wt.status==="Read"||wt.Read===!0).length,sn=St===z.length&&z.length>0;b({publisher:fe,demographic:be,genre:Ge,subGenre:Ne,datePurchased:Lt,msrp:Je,initialPublisher:fe,initialDemographic:be,initialGenre:Ge,initialSubGenre:Ne,initialDatePurchased:Lt,initialMsrp:Je,dateMixed:yt,readChecked:sn,readIndeterminate:!sn&&!(St===0)})},[vn,se]),j.useEffect(()=>{D.current&&(D.current.indeterminate=N.readIndeterminate)},[N.readIndeterminate]),j.useEffect(()=>{const S=s.find(Q=>Q.id===xe);if(!S){ne(T_());return}const z=!!S.read||S.status==="Read"||S.Read===!0;ne({read:z,datePurchased:S.datePurchased||S.DatePurchased||"",dateRead:z&&(S.dateRead||S.DateRead)||"",pageCount:S.pageCount??S.PageCount??S.pages??S.Pages??"",msrp:S.msrp??S.MSRP??"",amountPaid:S.amountPaid??S.AmountPaid??"",rating:z?S.rating??S.Rating??"":"",special:!!(S.specialType||S.SpecialType),specialType:S.specialType??S.SpecialType??"",specialVolumes:S.specialVolumes??S.SpecialVolumes??"",collectiblePrice:S.collectiblePrice??S.CollectiblePrice??"",publisher:S.publisher||S.Publisher||"",demographic:S.demographic||S.Demographic||"",genre:S.genre||S.Genre||""})},[xe,s]),j.useEffect(()=>{if(!Jn||!Jn.length)return;const S=In-1,z=Jn.reduce((Ge,Ne)=>Ge+Ne.value,0);if(!z||(gn.current?parseInt(gn.current,10):null)===S)return;const fe=Jn.map(Ge=>`${Ge.label}: ${Ge.value}`).join(", "),be=`Yearly reads summary for ${S}: ${z} total. Breakdown: ${fe}`;C_(U.yearly,be).then(()=>{gn.current=String(S),typeof window<"u"&&localStorage.setItem("dashboard-yearly-posted",String(S))})},[Jn,In]),j.useEffect(()=>{if(!Xn||!rt.length)return;const S=Ca(Xn.date),z=Ca(new Date);if(S>z||ts.current===S)return;const Q=rt.filter(be=>Ca(be.date)===S);if(!Q.length)return;const fe=`Wishlist releases for ${S}:
${Q.map(be=>`- ${be.title}`).join(`
`)}`;C_(U.release,fe).then(()=>{ts.current=S,typeof window<"u"&&localStorage.setItem("dashboard-release-posted",S)})},[Xn,rt]),j.useEffect(()=>{if(!Ft){I("-");return}const S=()=>{const Q=Ft-new Date;if(Q<=0){I("Released");return}const fe=Math.floor(Q/1e3),be=Math.floor(fe/86400),Ge=Math.floor(fe%86400/3600).toString().padStart(2,"0"),Ne=Math.floor(fe%3600/60).toString().padStart(2,"0"),Je=Math.floor(fe%60).toString().padStart(2,"0");I(`${be}d ${Ge}:${Ne}:${Je}`)};S();const z=setInterval(S,1e3);return()=>clearInterval(z)},[Ft]),j.useEffect(()=>{if(!(typeof window>"u"))try{const S=localStorage.getItem(am);if(!S)return;const z=JSON.parse(S);if(!Array.isArray(z))return;const Q=z.map(fe=>({message:fe.message,ts:fe.ts?new Date(fe.ts):new Date})).filter(fe=>fe.message);Q.length&&he(Q)}catch(S){console.warn("Failed to load activity log",S)}},[]);const Ks=async()=>{try{const S=await vs(Sn(ot,"library"));a(S.docs.map(z=>({id:z.id,...z.data()})))}catch(S){console.error("Failed to refresh library",S),w(z=>z||"Failed to refresh library data.")}},ht=S=>{const z=(S??"").toString().trim();if(z==="")return"";const Q=parseFloat(z);return Number.isFinite(Q)?Q:""},is=S=>{const z=(S??"").toString().trim();if(z==="")return"";const Q=parseInt(z,10);return Number.isFinite(Q)?Q:""},jn=S=>{if(!S)return;const z={message:S,ts:new Date};he(Q=>{const fe=[z,...Q].slice(0,100);return mx(fe),fe}),gx(S,{email:(n==null?void 0:n.email)||"anonymous",name:(n==null?void 0:n.displayName)||"",webhookOverride:U.activity,persistLocal:!1})},x=S=>{O(z=>{const Q=new Set(z);return Q.has(S)?Q.delete(S):Q.add(S),Q}),Te(S),_e(null)},W=(S,z,Q)=>{const fe=S.metaKey||S.ctrlKey,be=S.shiftKey,Ge=Hs.indexOf(z);let Ne=new Set(V);if(be&&C!==null&&Ge!==-1){const Je=Math.min(C,Ge),dt=Math.max(C,Ge);for(let yt=Je;yt<=dt;yt+=1){const Lt=Hs[yt];Lt&&Ne.add(Lt)}}else fe?Ne.has(z)?Ne.delete(z):Ne.add(z):Ne=new Set;ie(Ne),P(Ge),_e(z),Te(Q),O(Je=>{const dt=new Set(Je);return dt.add(Q),dt})},G=()=>{ie(new Set),P(null)},F=async()=>{if(!e){alert("Dashboard is read-only for your account.");return}const S=Array.from(V);if(!S.length){alert("Select books in Library Manager (use Ctrl/Cmd or Shift) before bulk editing.");return}const z=(A||"").toString().trim(),Q=z!=="",fe=ht(z);if(Q&&fe===""){alert("Enter a valid number for Amount Paid.");return}try{await Promise.all(S.map(be=>_s(Dt(ot,"library",be),{amountPaid:Q?fe:""}))),await Ks(),G(),jn(`Updated amount paid for ${S.length} book${S.length===1?"":"s"} in library`),alert(`Applied Amount Paid to ${S.length} selection${S.length===1?"":"s"}.`)}catch(be){console.error("Failed to apply Amount Paid",be),alert("Failed to apply Amount Paid to selection.")}},H=async()=>{if(!e){alert("Dashboard is read-only for your account.");return}const S=vn.find(St=>St.seriesKey===se);if(!S||!S.books.length)return;const z=!N.readIndeterminate,Q=!!N.readChecked,fe=N.datePurchased!==N.initialDatePurchased,be=N.msrp!==N.initialMsrp,Ge=N.publisher!==N.initialPublisher,Ne=N.demographic!==N.initialDemographic,Je=N.genre!==N.initialGenre,dt=N.subGenre!==N.initialSubGenre;if(!z&&!fe&&!be&&!Ge&&!Ne&&!Je&&!dt)return;const yt=String(N.msrp??"").trim(),Lt=be?ht(yt):"";if(be&&yt!==""&&Lt===""){alert("Enter a valid number for MSRP.");return}try{const St=[];if(S.books.forEach(sn=>{const wn={};z&&(wn.read=Q,wn.dateRead=Q?sn.dateRead||sn.DateRead||new Date().toISOString().slice(0,10):""),fe&&(wn.datePurchased=N.datePurchased||""),be&&(wn.msrp=N.msrp===""?"":Lt),Ge&&(wn.publisher=N.publisher||""),Ne&&(wn.demographic=N.demographic||""),Je&&(wn.genre=N.genre||""),dt&&(wn.subGenre=N.subGenre||""),Object.keys(wn).length&&St.push(_s(Dt(ot,"library",sn.id),wn))}),!St.length)return;await Promise.all(St),await Ks(),_e(null),jn(`Updated series "${S.displayName||"Series"}" (${S.books.length} book${S.books.length===1?"":"s"})`),alert("Series updated.")}catch(St){console.error("Failed to save series changes",St),alert("Failed to update series.")}},ue=async()=>{if(!e){alert("Dashboard is read-only for your account.");return}if(!xe)return;const S=!!J.read,z=String(J.msrp??"").trim(),Q=String(J.amountPaid??"").trim(),fe=String(J.pageCount??"").trim(),be=String(J.rating??"").trim(),Ge=ht(z),Ne=ht(Q),Je=is(fe),dt=ht(be);if(z!==""&&Ge===""){alert("Enter a valid number for MSRP.");return}if(Q!==""&&Ne===""){alert("Enter a valid number for Amount Paid.");return}if(fe!==""&&Je===""){alert("Enter a valid page count.");return}if(S&&be!==""&&dt===""){alert("Enter a valid rating.");return}const yt=!!J.special,Lt=is(J.specialVolumes),St=ht(J.collectiblePrice),sn=String(J.specialVolumes??"").trim(),wn=String(J.collectiblePrice??"").trim();if(yt&&J.specialType==="specialEdition"&&sn!==""&&Lt===""){alert("Enter a valid number for volumes contained.");return}if(yt&&J.specialType==="collectible"&&wn!==""&&St===""){alert("Enter a valid collectible price.");return}const wt=S?J.dateRead||new Date().toISOString().slice(0,10):"",an={read:S,datePurchased:J.datePurchased||"",dateRead:wt,msrp:J.msrp===""?"":Ge,amountPaid:J.amountPaid===""?"":Ne,pageCount:J.pageCount===""?"":Je,rating:S?J.rating===""?"":dt:"",specialType:yt&&J.specialType||"",specialVolumes:yt&&J.specialType==="specialEdition"?J.specialVolumes===""?"":Lt:"",collectiblePrice:yt&&J.specialType==="collectible"?J.collectiblePrice===""?"":St:""};try{await _s(Dt(ot,"library",xe),an),await Ks();const Zn=s.find(Rr=>Rr.id===xe)||Oe,zr=(Zn==null?void 0:Zn.Title)||(Zn==null?void 0:Zn.title)||"Untitled";jn(`Updated "${zr}" in library`),alert("Saved changes.")}catch(Zn){console.error("Failed to save book changes",Zn),alert("Failed to save changes.")}},oe=()=>{Te(null),_e(null),G(),b(yf())},Ae=()=>{_e(null),P(null)},Pe=vn.find(S=>S.seriesKey===se)||null,Oe=s.find(S=>S.id===xe)||null,de=se?{msrp:!N.msrp,datePurchased:!N.datePurchased&&!N.dateMixed,publisher:!N.publisher,demographic:!N.demographic,genre:!N.genre}:{},Ze=xe?PR({amountPaid:J.amountPaid,msrp:J.msrp,datePurchased:J.datePurchased,publisher:(Oe==null?void 0:Oe.publisher)||(Oe==null?void 0:Oe.Publisher)||"",demographic:(Oe==null?void 0:Oe.demographic)||(Oe==null?void 0:Oe.Demographic)||"",genre:(Oe==null?void 0:Oe.genre)||(Oe==null?void 0:Oe.Genre)||"",special:J.special,specialType:J.specialType,specialVolumes:J.specialVolumes,collectiblePrice:J.collectiblePrice,pageCount:J.pageCount}):{};if(t)return o.jsx("div",{className:"page dashboard-page",children:o.jsxs("div",{className:"dashboard-loading",children:[o.jsx("h1",{children:"Dashboard"}),o.jsx("p",{children:"Checking permissions..."})]})});if(!n||!e)return o.jsx("div",{className:"page dashboard-page",children:o.jsxs("div",{className:"dashboard-locked",children:[o.jsx("h1",{children:"Dashboard"}),o.jsx("p",{children:"This area is restricted to admin accounts."})]})});if(f)return o.jsx("div",{className:"page dashboard-page",children:o.jsxs("div",{className:"dashboard-loading",children:[o.jsx("h1",{children:"Dashboard"}),v?o.jsx("p",{className:"error",children:v}):o.jsx("p",{children:"Loading stats..."})]})});const je=pr+Ir,ut=je?Math.round(pr/je*100):0,ur=[...Pn.values()].filter(S=>S.ratingCount>0).map(S=>({title:S.title,avg:S.ratingSum/S.ratingCount,count:S.ratingCount})).sort((S,z)=>z.avg-S.avg||z.count-S.count).slice(0,3);function Qs(){if(Ft)Nt(new Date(Ft.getFullYear(),Ft.getMonth(),1));else if(rt.length){const S=rt[0].date;Nt(new Date(S.getFullYear(),S.getMonth(),1))}Ct(!0)}function _n(S){es({open:!0,type:S})}function Jt(){es({open:!1,type:null})}const as=I_(gt,rt,un),os=S=>{cr(z=>{const Q=new Date(z.year,z.month+S,1);return{year:Q.getFullYear(),month:Q.getMonth()}})},ls=S=>{lr(z=>new Date(z.getFullYear(),z.getMonth()+S,1))},Rt=()=>{$t(!1),Fn(null)},Is=()=>{const S=Array.from(Ur.keys()).sort();if(S.length){const z=S[S.length-1],[Q,fe]=z.split("-"),be=Number(Q),Ge=Number(fe)-1;!Number.isNaN(be)&&!Number.isNaN(Ge)&&cr({year:be,month:Ge})}$t(!0)},pt=()=>{if(Nr.length){const S=Nr[Nr.length-1].date;lr(new Date(S.getFullYear(),S.getMonth(),1))}else lr(new Date);tn(!0)};function Ps(){const S=Yt.type;if(!S)return null;if(S==="publishers"){const z=[...Eo(Pn,"publisher",100)];return o.jsxs(o.Fragment,{children:[o.jsx("h3",{children:"Top Publishers by Series"}),z.length===0?o.jsx("p",{children:"No publisher data yet."}):o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"#"}),o.jsx("th",{children:"Publisher"}),o.jsx("th",{children:"Series Count"})]})}),o.jsx("tbody",{children:z.map((Q,fe)=>o.jsxs("tr",{children:[o.jsx("td",{children:fe+1}),o.jsx("td",{children:Q.name}),o.jsx("td",{children:Q.count})]},Q.name+fe))})]})]})}if(S==="genres"){const z=[...Eo(Pn,"genre",100)];return o.jsxs(o.Fragment,{children:[o.jsx("h3",{children:"Top Genres by Series"}),z.length===0?o.jsx("p",{children:"No genre data yet."}):o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"#"}),o.jsx("th",{children:"Genre"}),o.jsx("th",{children:"Series Count"})]})}),o.jsx("tbody",{children:z.map((Q,fe)=>o.jsxs("tr",{children:[o.jsx("td",{children:fe+1}),o.jsx("td",{children:Q.name}),o.jsx("td",{children:Q.count})]},Q.name+fe))})]})]})}if(S==="demographics"){const z=[...Eo(Pn,"demographic",100)];return o.jsxs(o.Fragment,{children:[o.jsx("h3",{children:"Top Demographics by Series"}),z.length===0?o.jsx("p",{children:"No demographic data yet."}):o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"#"}),o.jsx("th",{children:"Demographic"}),o.jsx("th",{children:"Series Count"})]})}),o.jsx("tbody",{children:z.map((Q,fe)=>o.jsxs("tr",{children:[o.jsx("td",{children:fe+1}),o.jsx("td",{children:Q.name}),o.jsx("td",{children:Q.count})]},Q.name+fe))})]})]})}if(S==="timeToRead"){const z=ns||[];return o.jsxs(o.Fragment,{children:[o.jsx("h3",{children:"Average Time From Purchase to Read"}),Nn==null?o.jsx("p",{children:"Not enough volumes have both purchase and read dates to calculate this yet."}):o.jsxs(o.Fragment,{children:[o.jsxs("p",{children:["On average, it takes"," ",o.jsxs("strong",{children:[Nn.toFixed(1)," days"]})," from purchase to finishing a volume."]}),z.length>0?o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Series"}),o.jsx("th",{children:"Avg Days"}),o.jsx("th",{children:"Longest"}),o.jsx("th",{children:"Shortest"}),o.jsx("th",{children:"Reads Count"})]})}),o.jsx("tbody",{children:z.map(Q=>o.jsxs("tr",{children:[o.jsx("td",{children:Q.title}),o.jsxs("td",{children:[Q.avg.toFixed(1)," days"]}),o.jsxs("td",{children:[Math.round(Q.max)," days"]}),o.jsxs("td",{children:[Math.round(Q.min)," days"]}),o.jsx("td",{children:Q.count})]},Q.key))})]}):o.jsx("p",{style:{marginTop:8},children:"No series-level data yet."})]})]})}if(S==="collectionValue"){const{msrpTotal:z,paidTotal:Q}=Rn,fe=z-Q,be=z>0?(Q/z*100).toFixed(1):"-",Ge=[...Fr].filter(Ne=>Ne.msrp||Ne.paid||Ne.collectible).sort((Ne,Je)=>Je.msrp+Je.collectible-(Ne.msrp+Ne.collectible));return o.jsxs(o.Fragment,{children:[o.jsx("h3",{children:"Collection Value Breakdown"}),o.jsx("table",{children:o.jsxs("tbody",{children:[o.jsxs("tr",{children:[o.jsx("th",{children:"Total MSRP"}),o.jsxs("td",{children:["$",z.toFixed(2)]})]}),o.jsxs("tr",{children:[o.jsx("th",{children:"Total Paid"}),o.jsxs("td",{children:["$",Q.toFixed(2)]})]}),o.jsxs("tr",{children:[o.jsx("th",{children:"Difference"}),o.jsxs("td",{children:["$",fe.toFixed(2)]})]}),o.jsxs("tr",{children:[o.jsx("th",{children:"Paid vs MSRP"}),o.jsx("td",{children:be==="-"?"-":`${be}%`})]})]})}),Ge.length>0&&o.jsxs(o.Fragment,{children:[o.jsx("h4",{style:{marginTop:"14px"},children:"Collection Pricing"}),o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Title"}),o.jsx("th",{children:"MSRP"}),o.jsx("th",{children:"Paid"}),o.jsx("th",{children:"Collectible"}),o.jsx("th",{children:"Books"})]})}),o.jsx("tbody",{children:Ge.map((Ne,Je)=>o.jsxs("tr",{children:[o.jsx("td",{children:Ne.title}),o.jsxs("td",{children:["$",Ne.msrp.toFixed(2)]}),o.jsxs("td",{children:["$",Ne.paid.toFixed(2)]}),o.jsx("td",{children:Ne.collectible?`$${Ne.collectible.toFixed(2)}`:"--"}),o.jsx("td",{children:Ne.books})]},Ne.title+Je))})]})]})]})}if(S==="pages"){const z=[...Fr].filter(Q=>Q.pages>0).map(Q=>({...Q,pct:Q.pages?Math.round(Q.readPages/Q.pages*100):0})).sort((Q,fe)=>fe.pages-Q.pages);return o.jsxs(o.Fragment,{children:[o.jsx("h3",{children:"Pages Read vs Total"}),o.jsx("table",{children:o.jsxs("tbody",{children:[o.jsxs("tr",{children:[o.jsx("th",{children:"Total Pages"}),o.jsx("td",{children:yn.total.toLocaleString()})]}),o.jsxs("tr",{children:[o.jsx("th",{children:"Pages Read"}),o.jsx("td",{children:yn.read.toLocaleString()})]}),o.jsxs("tr",{children:[o.jsx("th",{children:"Completion"}),o.jsx("td",{children:yn.total?`${(yn.read/yn.total*100).toFixed(1)}%`:"-"})]})]})}),z.length>0&&o.jsxs(o.Fragment,{children:[o.jsx("h4",{style:{marginTop:"14px"},children:"Pages by Series"}),o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Title"}),o.jsx("th",{children:"Read Pages"}),o.jsx("th",{children:"Total Pages"}),o.jsx("th",{children:"% Read"}),o.jsx("th",{children:"Books"})]})}),o.jsx("tbody",{children:z.map((Q,fe)=>o.jsxs("tr",{children:[o.jsx("td",{children:Q.title}),o.jsx("td",{children:Q.readPages.toLocaleString()}),o.jsx("td",{children:Q.pages.toLocaleString()}),o.jsxs("td",{children:[Q.pct,"%"]}),o.jsx("td",{children:Q.books})]},Q.title+fe))})]})]})]})}if(S==="ratings"){const z=[...Fr].map(Q=>{if(!Q.ratings.length)return null;const fe=Q.ratings.reduce((be,Ge)=>be+Ge,0)/Q.ratings.length;return{title:Q.title,avg:fe,count:Q.ratings.length}}).filter(Boolean).sort((Q,fe)=>fe.avg-Q.avg||fe.count-Q.count);return o.jsxs(o.Fragment,{children:[o.jsx("h3",{children:"Ratings Overview"}),An==null?o.jsx("p",{children:"No ratings have been recorded yet."}):o.jsxs("p",{children:["Average series rating across rated series is"," ",o.jsx("strong",{children:An.toFixed(2)}),"."]}),z.length>0&&o.jsxs(o.Fragment,{children:[o.jsx("h4",{style:{marginTop:"14px"},children:"Series Averages"}),o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Title"}),o.jsx("th",{children:"Avg"}),o.jsx("th",{children:"Ratings"})]})}),o.jsx("tbody",{children:z.map((Q,fe)=>o.jsxs("tr",{children:[o.jsx("td",{children:Q.title}),o.jsx("td",{children:Q.avg.toFixed(2)}),o.jsx("td",{children:Q.count})]},Q.title+fe))})]})]})]})}return S==="releases"?o.jsxs(o.Fragment,{children:[o.jsx("h3",{children:"Library & Wishlist Releases"}),rt.length===0?o.jsx("p",{children:"No wishlist releases found."}):o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Date"}),o.jsx("th",{children:"Title"})]})}),o.jsx("tbody",{children:rt.map((z,Q)=>o.jsxs("tr",{children:[o.jsx("td",{children:z.date.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}),o.jsx("td",{children:z.title})]},Q))})]})]}):null}return o.jsxs("div",{className:"page dashboard-page",children:[o.jsxs("header",{className:"dashboard-header",style:{display:"flex",alignItems:"center",justifyContent:"center",position:"relative",textAlign:"center",width:"100%"},children:[o.jsxs("div",{style:{textAlign:"center",margin:"0 auto",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"0 60px"},children:[o.jsx("h1",{style:{margin:0,fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Dashboard"}),o.jsx("p",{className:"dashboard-sub",style:{textAlign:"center",margin:"6px 0 0"},children:"My Entire Statistics dashboard for my Manga. I still use Excel though."})]}),e&&o.jsx("div",{style:{position:"absolute",right:0,top:"50%",transform:"translateY(-50%)"},children:o.jsx("button",{className:"stat-link",onClick:()=>Ie(!0),type:"button",children:"Admin Settings"})})]}),o.jsx("section",{id:"dashboardSection",className:"page-section active",children:o.jsxs("div",{className:"dashboard-grid",children:[o.jsxs("div",{className:"stat-stack",children:[o.jsxs("div",{className:"stat-card mini clickable",onClick:Is,children:[o.jsx("h3",{children:"Total Library Books"}),o.jsx("div",{className:"stat-value",children:pr}),o.jsx("div",{className:"stat-sub",children:"Volumes in your library."})]}),o.jsxs("div",{className:"stat-card mini",children:[o.jsx("h3",{children:"Wishlist Items"}),o.jsx("div",{className:"stat-value",children:Ir}),o.jsx("div",{className:"stat-sub",children:"Tracked upcoming wants."})]})]}),o.jsxs("div",{className:"stat-card clickable",onClick:pt,role:"button",tabIndex:0,onKeyDown:S=>{(S.key==="Enter"||S.key===" ")&&(S.preventDefault(),pt())},children:[o.jsx("h3",{children:"Read / Unread"}),o.jsx("div",{className:"pie",style:{"--pct":`${Yn*3.6}deg`},children:o.jsxs("div",{className:"pie-label",children:[Yn,"%"]})}),o.jsxs("div",{className:"stat-value",children:[Ss," read / ",Qn," unread"]})]}),o.jsxs("div",{className:"stat-card clickable",onClick:()=>_n("ratings"),children:[o.jsx("h3",{children:"Ratings"}),o.jsx("div",{className:"stat-value",children:An==null?"-":An.toFixed(2)}),o.jsx("div",{className:"stat-sub",children:"Average across rated series."}),o.jsx("div",{className:"stat-list compact",children:ur.length?ur.map((S,z)=>o.jsxs("div",{className:"stat-list-row",children:[o.jsx("span",{className:"stat-rank",children:z+1}),o.jsx("span",{className:"stat-name",children:S.title}),o.jsx("span",{className:"stat-count",children:S.avg.toFixed(2)})]},S.title+z)):o.jsx("div",{className:"stat-sub",children:"No ratings yet."})})]}),o.jsxs("div",{className:"stat-card clickable",onClick:()=>_n("pages"),children:[o.jsx("h3",{children:"Page Count Read / Total"}),o.jsxs("div",{className:"stat-value",children:[yn.read.toLocaleString()," / ",yn.total.toLocaleString()]}),o.jsx("div",{className:"stat-sub",children:yn.total?`${(yn.read/yn.total*100).toFixed(1)}% read`:"-"})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("h3",{children:"Library vs Wishlist"}),o.jsx("div",{className:"pie",style:{"--pct":`${ut*3.6}deg`},children:o.jsxs("div",{className:"pie-label",children:[ut,"%"]})}),o.jsxs("div",{className:"stat-value",children:[pr," / ",Ir]}),o.jsx("div",{className:"stat-sub",children:"Library vs wishlist share"})]}),o.jsxs("div",{className:"stat-card clickable",onClick:()=>_n("demographics"),children:[o.jsx("h3",{children:"Top Demographics"}),o.jsx("div",{className:"stat-list",children:Un.length?Un.slice(0,3).map((S,z)=>o.jsxs("div",{className:"stat-list-row",children:[o.jsx("span",{className:"stat-rank",children:z+1}),o.jsx("span",{className:"stat-name",children:S.name}),o.jsx("span",{className:"stat-count",children:S.count})]},S.name)):o.jsx("div",{className:"stat-sub",children:"No demographic data yet."})})]}),o.jsxs("div",{className:"stat-card clickable",onClick:()=>_n("publishers"),children:[o.jsx("h3",{children:"Top Publishers"}),o.jsx("div",{className:"stat-list",children:bs.length?bs.slice(0,3).map((S,z)=>o.jsxs("div",{className:"stat-list-row",children:[o.jsx("span",{className:"stat-rank",children:z+1}),o.jsx("span",{className:"stat-name",children:S.name}),o.jsx("span",{className:"stat-count",children:S.count})]},S.name)):o.jsx("div",{className:"stat-sub",children:"No publisher data yet."})})]}),o.jsxs("div",{className:"stat-card clickable",onClick:()=>_n("genres"),children:[o.jsx("h3",{children:"Top Genres"}),o.jsx("div",{className:"stat-list",children:Cs.length?Cs.slice(0,3).map((S,z)=>o.jsxs("div",{className:"stat-list-row",children:[o.jsx("span",{className:"stat-rank",children:z+1}),o.jsx("span",{className:"stat-name",children:S.name}),o.jsx("span",{className:"stat-count",children:S.count})]},S.name)):o.jsx("div",{className:"stat-sub",children:"No genre data yet."})})]}),o.jsxs("div",{className:"stat-card clickable",onClick:()=>{Qs()},children:[o.jsx("h3",{children:"Next Wishlist Release"}),o.jsx("div",{className:"stat-value next-release",children:Xn?Xn.title:"No upcoming releases"}),o.jsxs("div",{className:"stat-sub",children:[Ft?Ft.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"}):"-",o.jsx("br",{}),o.jsx("span",{id:"statNextCountdown",children:T})]})]}),o.jsxs("div",{className:"stat-card clickable",onClick:()=>_n("collectionValue"),style:{textAlign:"center"},children:[o.jsx("h3",{children:"Collection Pricing"}),o.jsxs("div",{className:"stat-value stat-msrp",children:["$",Rn.msrpTotal.toFixed(2)]}),o.jsxs("div",{className:"stat-value stat-paid",children:["$",Rn.paidTotal.toFixed(2),Rn.msrpTotal>0&&o.jsxs("span",{className:"stat-paid-pct",children:["(",((1-Rn.paidTotal/Rn.msrpTotal)*100).toFixed(1),"% off)"]})]}),o.jsxs("div",{className:"stat-value stat-collectible",children:["$",Rn.collectibleTotal.toFixed(2)]}),o.jsx("div",{className:"stat-sub",children:"MSRP | Paid | Collectible overrides"})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("h3",{children:"Current Year Reads"}),o.jsx("div",{className:"stat-value",children:Ws}),o.jsxs("div",{className:"stat-sub",children:["Reads in ",In]})]}),o.jsxs("div",{className:"stat-card clickable",onClick:()=>_n("timeToRead"),children:[o.jsx("h3",{children:"Avg Days From Purchase to Read"}),o.jsx("div",{className:"stat-value",children:Nn==null?"-":`${Nn.toFixed(1)} days`}),o.jsx("div",{className:"stat-sub",children:"When both dates exist"})]}),o.jsxs("div",{className:"stat-duo",children:[o.jsxs("div",{className:"stat-card tall",children:[o.jsxs("h3",{children:["Reads Per Month (",In,")"]}),o.jsx(zR,{data:Pr})]}),o.jsxs("div",{className:"stat-card tall",children:[o.jsx("h3",{children:"Reads by Day of Week (Lifetime)"}),o.jsx(BR,{data:mr}),o.jsx("div",{className:"stat-sub",children:"Based on all entries with a read date."})]})]}),o.jsxs("div",{className:"stat-card wide",children:[o.jsx("h3",{children:"Activity Log"}),rs&&o.jsx("div",{className:"error",style:{textAlign:"center"},children:v}),o.jsx("div",{className:"activity-log scrollable",children:Re.length?Re.map((S,z)=>{const Q=S.ts?new Date(S.ts):null;return o.jsxs("div",{className:"activity-row",children:[o.jsx("span",{className:"activity-title",children:S.message}),o.jsx("span",{className:"activity-date",children:Q?Q.toLocaleString(void 0,{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}):""})]},(S.message||"activity")+z)}):o.jsx("div",{className:"stat-sub",children:"No recent activity yet."})})]}),o.jsxs("div",{className:"stat-card wide",style:{minHeight:"340px",maxHeight:"480px"},children:[o.jsx("h3",{children:"Suggestions"}),Qe&&o.jsx("div",{className:"error",style:{textAlign:"center"},children:Qe}),o.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",alignItems:"stretch"},children:["anime","manga"].map(S=>{const z=Ee.filter(Q=>(Q.type||"").toLowerCase()===S).sort((Q,fe)=>{var be,Ge,Ne,Je;return(((Ge=(be=fe.createdAt)==null?void 0:be.getTime)==null?void 0:Ge.call(be))||0)-(((Je=(Ne=Q.createdAt)==null?void 0:Ne.getTime)==null?void 0:Je.call(Ne))||0)});return o.jsxs("div",{style:{border:"1px solid rgba(255,182,193,0.18)",borderRadius:"16px",padding:"10px 12px",display:"flex",flexDirection:"column",background:"rgba(255,182,193,0.04)",minHeight:"240px"},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"8px",position:"relative"},children:[o.jsx("h4",{style:{margin:0,color:"#ffb6c1",textAlign:"center",flex:1},children:S==="anime"?"Anime":"Manga"}),o.jsxs("span",{className:"stat-sub",style:{position:"absolute",right:0},children:[z.length," suggestion",z.length===1?"":"s"]})]}),o.jsx("div",{className:"scrollable",style:{maxHeight:"280px",height:"280px",paddingRight:"4px",overflowY:"auto"},children:De?o.jsx("div",{className:"stat-sub",children:"Loading suggestions..."}):z.length?z.map(Q=>{const fe=Q.createdAt instanceof Date?Q.createdAt:Q.createdAt?new Date(Q.createdAt):null;return o.jsxs("div",{style:{border:"1px solid rgba(255,182,193,0.25)",borderRadius:"12px",padding:"8px 10px",marginBottom:"8px",background:"rgba(255,182,193,0.06)",display:"grid",gridTemplateColumns:"1fr auto",gap:"6px",alignItems:"center"},children:[o.jsxs("div",{children:[o.jsx("div",{style:{fontWeight:600,color:"#f7d0dc"},children:Q.content||"(no content)"}),o.jsxs("div",{className:"stat-sub",style:{fontSize:"0.8rem"},children:[fe?fe.toLocaleString(void 0,{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}):""," ",Q.from?`| ${Q.from}`:""]})]}),o.jsx("div",{style:{display:"flex",gap:"6px"},children:e&&o.jsx("button",{type:"button",className:"stat-link",onClick:()=>Ts(Q.id),children:"Delete"})})]},Q.id)}):o.jsx("div",{className:"stat-sub",children:"No suggestions yet."})})]},S)})}),o.jsxs("div",{className:"stat-sub",style:{marginTop:"8px",textAlign:"center"},children:["Total suggestions: ",Ee.length]})]}),o.jsxs("div",{className:"stat-card wide",children:[o.jsx("h3",{children:"Library Manager"}),vn.length?o.jsxs("div",{className:"dash-library",children:[o.jsxs("div",{className:"dash-library-list",children:[vn.map(S=>{const z=S.books.filter(Ne=>!!Ne.read||Ne.status==="Read"||Ne.Read===!0).length,Q=$.has(S.seriesKey),fe=se===S.seriesKey&&!xe,be=NR(S),Ge=S.books.some(Ne=>S_(Ne));return o.jsxs("div",{style:{marginBottom:"8px"},children:[o.jsxs("button",{type:"button",onClick:()=>x(S.seriesKey),style:{width:"100%",textAlign:"left",background:be?"rgba(255,179,71,0.08)":"transparent",border:`1px solid ${fe?"#ff69b4":be?"rgba(255,179,71,0.6)":"rgba(255,182,193,0.25)"}`,color:"#ffb6c1",padding:"8px",borderRadius:"8px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"8px",position:"relative",boxShadow:be?"0 0 10px rgba(255,179,71,0.5)":fe?"0 0 8px rgba(255,105,180,0.5)":"none"},children:[o.jsx("span",{style:{transition:"transform 0.2s ease",transform:Q?"rotate(90deg)":"none"},children:">"}),o.jsx("span",{style:{flex:1},children:S.displayName}),o.jsxs("span",{style:{fontSize:"11px",color:"#f8d1d8"},children:[S.books.length," book",S.books.length===1?"":"s",S.books.length?` | ${z} read`:""]}),Ge&&o.jsx("span",{title:"Some volumes are missing required data",style:{width:"12px",height:"12px",borderRadius:"999px",background:"#ffb347",border:"1px solid rgba(255,255,255,0.25)",boxShadow:"0 0 10px rgba(255,179,71,0.6)"}})]}),o.jsx("div",{style:{margin:"6px 0 10px 10px",paddingLeft:"10px",borderLeft:"1px solid rgba(255,182,193,0.25)",display:Q?"block":"none"},children:S.books.map(Ne=>{const Je=xe===Ne.id,dt=V.has(Ne.id);Ne.read||Ne.status==="Read"||Ne.Read;const yt=S_(Ne,{ignoreShared:!0});return o.jsxs("button",{type:"button",onClick:Lt=>W(Lt,Ne.id,S.seriesKey),style:{width:"100%",textAlign:"left",background:yt?"rgba(255,179,71,0.1)":"transparent",border:`1px solid ${Je?"#ff69b4":dt?"#fff59d":yt?"rgba(255,179,71,0.6)":"rgba(255,182,193,0.25)"}`,color:"#ffb6c1",padding:"8px",borderRadius:"8px",marginBottom:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"8px",boxShadow:Je?"0 0 8px rgba(255,105,180,0.5)":dt?"0 0 10px rgba(255,255,180,0.65)":yt?"0 0 10px rgba(255,179,71,0.5)":"none"},children:[o.jsx("span",{style:{flex:1,minWidth:0},children:Ne.Title||Ne.title||"Untitled"}),yt&&o.jsx("span",{style:{flexShrink:0,padding:"2px 8px",borderRadius:"999px",background:"rgba(255,179,71,0.18)",border:"1px solid rgba(255,179,71,0.6)",color:"#ffd8a1",fontSize:"11px",fontWeight:700,whiteSpace:"nowrap"},children:"Missing data"})]},Ne.id)})})]},S.seriesKey)}),vn.length>0&&V.size>0&&o.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:o.jsx("button",{type:"button",style:{padding:"6px 12px",borderRadius:"999px",border:"1px solid #ffb6c1",background:"transparent",color:"#ffb6c1",cursor:"pointer"},onClick:G,children:"Clear Selection"})})]}),o.jsxs("div",{className:"dash-library-details",children:[V.size>0&&o.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px",padding:"10px",marginBottom:"10px",border:"1px dashed rgba(255,182,193,0.45)",borderRadius:"10px",background:"rgba(255,182,193,0.08)"},children:[o.jsxs("div",{children:["Apply Amount Paid to ",V.size," selected book",V.size===1?"":"s"]}),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",flexWrap:"wrap"},children:[o.jsx("input",{type:"number",step:"0.01",min:"0",value:A,onChange:S=>M(S.target.value),style:{maxWidth:"140px"}}),o.jsx("button",{type:"button",className:"dash-btn primary",onClick:F,children:"Apply to Selected"})]})]}),!se&&!xe&&o.jsx("div",{className:"stat-sub",style:{marginTop:6},children:"Select a series or book to edit"}),se&&!xe&&Pe&&o.jsxs("div",{children:[o.jsx("div",{className:"dash-detail-title",children:Pe.displayName}),o.jsx("div",{className:"dash-detail-row",children:o.jsxs("label",{className:"inline-checkbox",children:[o.jsx("input",{ref:D,type:"checkbox",checked:N.readChecked,onChange:S=>b(z=>({...z,readChecked:S.target.checked,readIndeterminate:!1}))}),o.jsx("span",{children:"Mark series as read"})]})}),o.jsxs("div",{className:`dash-detail-row${de.publisher?" missing-row":""}`,children:[o.jsx("span",{children:"Publisher"}),o.jsx("input",{type:"text",value:N.publisher,onChange:S=>b(z=>({...z,publisher:S.target.value})),placeholder:"Set publisher for series"})]}),o.jsxs("div",{className:`dash-detail-row${de.demographic?" missing-row":""}`,children:[o.jsx("span",{children:"Demographic"}),o.jsxs("select",{value:N.demographic,onChange:S=>b(z=>({...z,demographic:S.target.value})),children:[o.jsx("option",{value:"",children:"Select Demographic"}),o.jsx("option",{value:"Shounen",children:"Shounen"}),o.jsx("option",{value:"Seinen",children:"Seinen"}),o.jsx("option",{value:"Shoujo",children:"Shoujo"}),o.jsx("option",{value:"Josei",children:"Josei"})]})]}),o.jsxs("div",{className:`dash-detail-row${de.genre?" missing-row":""}`,children:[o.jsx("span",{children:"Genre"}),o.jsx("input",{type:"text",value:N.genre,onChange:S=>b(z=>({...z,genre:S.target.value})),placeholder:"Primary genre"})]}),o.jsxs("div",{className:"dash-detail-row",children:[o.jsx("span",{children:"Sub-Genre"}),o.jsx("input",{type:"text",value:N.subGenre,onChange:S=>b(z=>({...z,subGenre:S.target.value})),placeholder:"Secondary genre / theme"})]}),!N.dateMixed&&o.jsxs("div",{className:`dash-detail-row${de.datePurchased?" missing-row":""}`,children:[o.jsx("span",{children:"Date Purchased"}),o.jsx("input",{type:"date",value:N.datePurchased,onChange:S=>b(z=>({...z,datePurchased:S.target.value}))})]}),o.jsxs("div",{className:`dash-detail-row${de.msrp?" missing-row":""}`,children:[o.jsx("span",{children:"MSRP (per book)"}),o.jsx("input",{type:"number",step:"0.01",min:"0",value:N.msrp,onChange:S=>b(z=>({...z,msrp:S.target.value})),placeholder:"0.00"})]}),o.jsxs("div",{className:"dash-detail-actions",children:[o.jsx("button",{type:"button",className:"dash-btn secondary",onClick:oe,children:"Cancel"}),o.jsx("button",{type:"button",className:"dash-btn primary",onClick:H,children:"Save Series"})]})]}),xe&&Oe&&o.jsxs("div",{children:[o.jsx("div",{className:"dash-detail-title",children:Oe.Title||Oe.title||"Untitled"}),o.jsx("div",{className:"dash-detail-row",children:o.jsxs("label",{className:"inline-checkbox",children:[o.jsx("input",{type:"checkbox",checked:!!J.read,onChange:S=>ne(z=>({...z,read:S.target.checked,dateRead:S.target.checked?z.dateRead||new Date().toISOString().slice(0,10):"",rating:S.target.checked?z.rating:""}))}),o.jsx("span",{children:"Mark as read"})]})}),o.jsxs("div",{className:`dash-detail-row${Ze.datePurchased?" missing-row":""}`,children:[o.jsx("span",{children:"Date Purchased"}),o.jsx("input",{type:"date",value:J.datePurchased,onChange:S=>ne(z=>({...z,datePurchased:S.target.value}))})]}),J.read&&o.jsxs("div",{className:"dash-detail-row",children:[o.jsx("span",{children:"Date Read"}),o.jsx("input",{type:"date",value:J.dateRead,onChange:S=>ne(z=>({...z,dateRead:S.target.value}))})]}),o.jsxs("div",{className:`dash-detail-row${Ze.pageCount?" missing-row":""}`,children:[o.jsx("span",{children:"Page Count"}),o.jsx("input",{type:"number",min:"0",step:"1",value:J.pageCount,onChange:S=>ne(z=>({...z,pageCount:S.target.value}))})]}),o.jsxs("div",{className:`dash-detail-row${Ze.msrp?" missing-row":""}`,children:[o.jsx("span",{children:"MSRP (per book)"}),o.jsx("input",{type:"number",step:"0.01",min:"0",value:J.msrp,onChange:S=>ne(z=>({...z,msrp:S.target.value})),placeholder:"0.00"})]}),!(J.special&&J.specialType==="collectible")&&o.jsxs("div",{className:`dash-detail-row${Ze.amountPaid?" missing-row":""}`,children:[o.jsx("span",{children:"Amount Paid"}),o.jsx("input",{type:"number",step:"0.01",min:"0",value:J.amountPaid,onChange:S=>ne(z=>({...z,amountPaid:S.target.value})),placeholder:"0.00"})]}),J.read&&o.jsxs("div",{className:"dash-detail-row",children:[o.jsx("span",{children:"Star Rating"}),o.jsx("input",{type:"number",min:"0",max:"5",step:"0.5",value:J.rating,onChange:S=>ne(z=>({...z,rating:S.target.value})),placeholder:"0-5"})]}),o.jsx("div",{className:`dash-detail-row${Ze.specialType?" missing-row":""}`,children:o.jsxs("label",{className:"inline-checkbox",style:{width:"100%"},children:[o.jsx("input",{type:"checkbox",checked:!!J.special,onChange:S=>ne(z=>({...z,special:S.target.checked,specialType:S.target.checked?z.specialType:"",specialVolumes:S.target.checked?z.specialVolumes:"",collectiblePrice:S.target.checked?z.collectiblePrice:""}))}),o.jsx("span",{children:"Special?"})]})}),J.special&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:`dash-detail-row${Ze.specialType?" missing-row":""}`,children:[o.jsx("span",{children:"Special Type"}),o.jsxs("select",{value:J.specialType,onChange:S=>ne(z=>({...z,specialType:S.target.value,specialVolumes:S.target.value==="specialEdition"?z.specialVolumes:"",collectiblePrice:S.target.value==="collectible"?z.collectiblePrice:""})),children:[o.jsx("option",{value:"",children:"Select type"}),o.jsx("option",{value:"specialEdition",children:"Special Edition"}),o.jsx("option",{value:"collectible",children:"Collectible"})]})]}),J.specialType==="specialEdition"&&o.jsxs("div",{className:`dash-detail-row${Ze.specialVolumes?" missing-row":""}`,children:[o.jsx("span",{children:"Volumes Contained"}),o.jsx("input",{type:"number",min:"1",step:"1",value:J.specialVolumes,onChange:S=>ne(z=>({...z,specialVolumes:S.target.value}))})]}),J.specialType==="collectible"&&o.jsxs("div",{className:`dash-detail-row${Ze.collectiblePrice?" missing-row":""}`,children:[o.jsx("span",{children:"Collectible Price"}),o.jsx("input",{type:"number",min:"0",step:"0.01",value:J.collectiblePrice,onChange:S=>ne(z=>({...z,collectiblePrice:S.target.value})),placeholder:"0.00"})]})]}),o.jsxs("div",{className:"dash-detail-actions",children:[o.jsx("button",{type:"button",className:"dash-btn secondary",onClick:Ae,children:"Cancel"}),o.jsx("button",{type:"button",className:"dash-btn primary",onClick:ue,children:"Save Changes"})]})]})]})]}):o.jsx("div",{className:"stat-sub",children:"No library items."})]})]})}),Ot&&o.jsx("div",{id:"calendarOverlay",onClick:S=>{S.target===S.currentTarget&&Rt()},children:o.jsxs("div",{id:"calendarCard",onClick:S=>S.stopPropagation(),children:[o.jsxs("div",{className:"calendar-header",children:[o.jsx("div",{className:"calendar-title",children:new Date(On.year,On.month).toLocaleString(void 0,{month:"long",year:"numeric"})}),o.jsxs("div",{className:"calendar-nav",children:[o.jsx("button",{className:"calendar-nav-btn",onClick:()=>os(-1),type:"button",children:"<"}),o.jsx("button",{className:"calendar-nav-btn",onClick:()=>os(1),type:"button",children:">"})]})]}),o.jsxs("div",{className:"calendar-weekdays",children:[o.jsx("div",{children:"Sun"}),o.jsx("div",{children:"Mon"}),o.jsx("div",{children:"Tue"}),o.jsx("div",{children:"Wed"}),o.jsx("div",{children:"Thu"}),o.jsx("div",{children:"Fri"}),o.jsx("div",{children:"Sat"})]}),o.jsxs("div",{className:"calendar-grid",children:[ss.cells.map((S,z)=>{if(S.type==="pad")return o.jsx("div",{className:"calendar-day pad"},`pad-${z}`);const{day:Q,dateKey:fe,items:be,isToday:Ge}=S;return o.jsxs("div",{className:"calendar-day"+(be.length?" has-releases":"")+(Ge?" today":""),onClick:()=>{be.length&&Fn({date:fe,items:be})},role:"button",tabIndex:0,onKeyDown:Ne=>{if(Ne.key==="Enter"||Ne.key===" "){if(Ne.preventDefault(),!be.length)return;Fn({date:fe,items:be})}},children:[o.jsx("div",{className:"day-num",children:Q}),o.jsxs("div",{className:"calendar-releases",children:[be.slice(0,2).map(Ne=>o.jsx("div",{className:"calendar-release purchased",children:Ne.title||"Untitled"},Ne.id)),be.length>2&&o.jsxs("div",{className:"calendar-release more",children:["+",be.length-2," more"]})]})]},fe)}),!ss.hasItems&&o.jsx("div",{className:"calendar-empty",children:"No purchases for this month."})]}),o.jsx("button",{id:"calendarClose",onClick:Rt,type:"button",children:"x"})]})}),Cn&&o.jsx("div",{className:"purchase-overlay",onClick:S=>{S.target===S.currentTarget&&Fn(null)},children:o.jsxs("div",{className:"purchase-day-modal",onClick:S=>S.stopPropagation(),children:[o.jsxs("div",{className:"purchase-day-header",children:[o.jsx("div",{className:"purchase-day-title",children:new Date(Cn.date).toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"})}),o.jsx("button",{className:"manga-btn secondary",onClick:()=>Fn(null),type:"button",children:"x"})]}),o.jsx("div",{className:"purchase-day-list",children:Cn.items.map(S=>o.jsx("div",{className:"purchase-day-item",children:S.title||"Untitled"},S.id))})]})}),Qt&&o.jsx("div",{id:"calendarOverlay",onClick:()=>tn(!1),style:{zIndex:10060},children:o.jsxs("div",{id:"calendarCard",onClick:S=>S.stopPropagation(),children:[o.jsxs("div",{className:"calendar-header",children:[o.jsx("div",{className:"calendar-title",children:nn.toLocaleString(void 0,{month:"long",year:"numeric"})}),o.jsxs("div",{className:"calendar-nav",children:[o.jsx("button",{className:"calendar-nav-btn",onClick:()=>ls(-1),type:"button",children:"<"}),o.jsx("button",{className:"calendar-nav-btn",onClick:()=>ls(1),type:"button",children:">"})]})]}),o.jsxs("div",{className:"calendar-weekdays",children:[o.jsx("div",{children:"Sun"}),o.jsx("div",{children:"Mon"}),o.jsx("div",{children:"Tue"}),o.jsx("div",{children:"Wed"}),o.jsx("div",{children:"Thu"}),o.jsx("div",{children:"Fri"}),o.jsx("div",{children:"Sat"})]}),o.jsx("div",{className:"calendar-grid",children:qs.map((S,z)=>{var Q;return S.type==="pad"?o.jsx("div",{className:"calendar-day pad"},z):o.jsxs("div",{className:"calendar-day"+(S.isToday?" today":"")+((Q=S.releases)!=null&&Q.length?" has-releases":""),onClick:()=>{var be;if(!((be=S.releases)!=null&&be.length))return;const fe=new Date(nn.getFullYear(),nn.getMonth(),S.day);Kn({dateLabel:fe.toLocaleDateString(void 0,{month:"long",day:"numeric",year:"numeric"}),releases:S.releases})},role:"button",tabIndex:0,onKeyDown:fe=>{var be;if(fe.key==="Enter"||fe.key===" "){if(fe.preventDefault(),!((be=S.releases)!=null&&be.length))return;const Ge=new Date(nn.getFullYear(),nn.getMonth(),S.day);Kn({dateLabel:Ge.toLocaleDateString(void 0,{month:"long",day:"numeric",year:"numeric"}),releases:S.releases})}},children:[o.jsx("div",{className:"day-num",children:S.day}),o.jsxs("div",{className:"calendar-releases",children:[(S.releases||[]).slice(0,2).map((fe,be)=>o.jsx("div",{className:"calendar-release purchased",title:fe.title,children:fe.title},be)),(S.releases||[]).length>2&&o.jsxs("div",{className:"calendar-release more",children:["+",(S.releases||[]).length-2," more"]})]})]},S.dateKey||z)})}),!Nr.length&&o.jsx("div",{className:"calendar-empty",children:"No reads recorded yet."}),o.jsx("button",{id:"calendarClose",onClick:()=>tn(!1),type:"button",children:"x"})]})}),rn&&o.jsx("div",{id:"calendarOverlay",onClick:()=>Kn(null),style:{zIndex:10080},children:o.jsxs("div",{id:"calendarCard",onClick:S=>S.stopPropagation(),style:{maxWidth:"520px"},children:[o.jsxs("div",{className:"calendar-header",children:[o.jsx("div",{className:"calendar-title",children:rn.dateLabel}),o.jsx("button",{className:"calendar-close-btn",onClick:()=>Kn(null),type:"button",children:"x"})]}),o.jsx("div",{className:"calendar-releases",children:rn.releases.map((S,z)=>o.jsx("div",{className:"calendar-release purchased",title:S.title,children:S.title},z))})]})}),Tt&&o.jsx("div",{id:"calendarOverlay",onClick:()=>Ct(!1),children:o.jsxs("div",{id:"calendarCard",onClick:S=>S.stopPropagation(),children:[o.jsxs("div",{className:"calendar-header",children:[o.jsx("div",{className:"calendar-title",children:gt.toLocaleString(void 0,{month:"long",year:"numeric"})}),o.jsxs("div",{className:"calendar-nav",children:[o.jsx("button",{className:"calendar-nav-btn",onClick:()=>Nt(new Date(gt.getFullYear(),gt.getMonth()-1,1)),children:"<"}),o.jsx("button",{className:"calendar-nav-btn",onClick:()=>Nt(new Date(gt.getFullYear(),gt.getMonth()+1,1)),children:">"})]})]}),o.jsxs("div",{className:"calendar-weekdays",children:[o.jsx("div",{children:"Sun"}),o.jsx("div",{children:"Mon"}),o.jsx("div",{children:"Tue"}),o.jsx("div",{children:"Wed"}),o.jsx("div",{children:"Thu"}),o.jsx("div",{children:"Fri"}),o.jsx("div",{children:"Sat"})]}),o.jsx("div",{className:"calendar-grid",id:"releaseCalendar",children:as.map((S,z)=>S.type==="pad"?o.jsx("div",{className:"calendar-day pad"},z):o.jsxs("div",{className:"calendar-day"+(S.isToday?" today":""),children:[o.jsx("div",{className:"day-num",children:S.day}),o.jsxs("div",{className:"calendar-releases",children:[(ye===S.dateKey?S.releases:S.releases.slice(0,2)).map((Q,fe)=>o.jsx("div",{className:"calendar-release"+(Q.purchased?" purchased":""),title:Q.title,children:Q.title},fe)),S.releases.length>2&&o.jsxs("button",{className:"calendar-more-btn",onClick:()=>{const Q=new Date(gt.getFullYear(),gt.getMonth(),S.day);me({dateLabel:Q.toLocaleDateString(void 0,{month:"long",day:"numeric",year:"numeric"}),releases:S.releases})},children:["+",S.releases.length-2," more"]})]})]},z))}),!rt.length&&o.jsx("div",{className:"calendar-empty",children:"No wishlist releases found."}),o.jsx("button",{id:"calendarClose",onClick:()=>Ct(!1),children:"x"})]})}),Yt.open&&o.jsx("div",{id:"statDetailOverlay",onClick:Jt,children:o.jsxs("div",{id:"statDetailCard",onClick:S=>S.stopPropagation(),children:[o.jsx("button",{id:"statDetailClose",onClick:Jt,children:"x"}),o.jsxs("h2",{id:"statDetailTitle",children:[Yt.type==="publishers"&&"Top Publishers",Yt.type==="genres"&&"Top Genres",Yt.type==="demographics"&&"Top Demographics",Yt.type==="timeToRead"&&"Avg Time From Purchase to Read",Yt.type==="collectionValue"&&"Collection Value",Yt.type==="pages"&&"Pages Read vs Total",Yt.type==="ratings"&&"Ratings",Yt.type==="releases"&&"Library & Wishlist Releases"]}),o.jsx("div",{id:"statDetailBody",children:Ps()})]})}),Me&&o.jsx("div",{id:"calendarOverlay",onClick:()=>me(null),style:{zIndex:10080},children:o.jsxs("div",{id:"calendarCard",onClick:S=>S.stopPropagation(),style:{maxWidth:"520px"},children:[o.jsxs("div",{className:"calendar-header",children:[o.jsx("div",{className:"calendar-title",children:Me.dateLabel}),o.jsx("button",{className:"calendar-close-btn",onClick:()=>me(null),type:"button",children:"x"})]}),o.jsx("div",{className:"calendar-releases",children:Me.releases.map((S,z)=>o.jsx("div",{className:"calendar-release"+(S.purchased?" purchased":""),title:S.title,children:S.title},z))})]})}),e&&le&&o.jsx("div",{className:"dashboard-modal-backdrop visible",onClick:S=>{S.target===S.currentTarget&&Ie(!1)},children:o.jsxs("div",{className:"dashboard-modal",children:[o.jsxs("div",{className:"dashboard-modal-header",children:[o.jsx("h3",{children:"Webhook Settings"}),o.jsx("button",{className:"dashboard-close",onClick:()=>Ie(!1),type:"button",children:"X"})]}),o.jsxs("div",{className:"dashboard-modal-body",children:[o.jsxs("label",{className:"dashboard-input",children:[o.jsx("span",{children:"Yearly summary webhook"}),o.jsx("input",{type:"text",value:U.yearly,onChange:S=>X(z=>({...z,yearly:S.target.value}))})]}),o.jsxs("label",{className:"dashboard-input",children:[o.jsx("span",{children:"Release timer webhook"}),o.jsx("input",{type:"text",value:U.release,onChange:S=>X(z=>({...z,release:S.target.value}))})]}),o.jsxs("label",{className:"dashboard-input",children:[o.jsx("span",{children:"Activity webhook"}),o.jsx("input",{type:"text",value:U.activity,onChange:S=>X(z=>({...z,activity:S.target.value}))})]}),o.jsxs("div",{className:"dashboard-input",style:{borderTop:"1px solid rgba(255,182,193,0.2)",paddingTop:8},children:[o.jsx("span",{children:"User roles"}),o.jsx("div",{style:{marginTop:8,fontSize:"0.85rem",color:"var(--text-soft)"},children:k?o.jsx("span",{children:"Loading users"}):ve.length===0?o.jsx("span",{children:"No users found."}):o.jsx("ul",{style:{listStyle:"none",margin:"6px 0 0",padding:0,display:"flex",gap:6,flexDirection:"column"},children:ve.map(S=>o.jsxs("li",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:8,background:"rgba(24,5,18,0.7)",border:"1px solid rgba(255,182,193,0.18)",borderRadius:10,padding:"6px 8px",flexWrap:"wrap"},children:[o.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:2},children:[o.jsx("strong",{children:S.displayName||S.email||S.uid}),o.jsx("span",{style:{fontSize:"0.85rem",opacity:.8},children:S.email||S.uid})]}),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[o.jsx("span",{className:"role-pill",children:S.role||"viewer"}),S.role==="admin"?o.jsx("button",{className:"dashboard-close",type:"button",onClick:()=>Ye(S.uid,"viewer"),style:{padding:"4px 10px"},children:"Make viewer"}):o.jsx("button",{className:"stat-link",type:"button",onClick:()=>Ye(S.uid,"admin"),style:{padding:"4px 10px"},children:"Make admin"})]})]},S.uid))})})]})]}),o.jsxs("div",{className:"dashboard-modal-footer",children:[o.jsx("button",{className:"stat-link",type:"button",onClick:async()=>{try{await ci(Dt(ot,"settings","webhooks"),{yearly:U.yearly||Il,release:U.release||Pl,activity:U.activity||Ia}),Ie(!1)}catch(S){console.error("Failed to save webhooks",S),alert("Failed to save webhooks.")}},children:"Save"}),o.jsx("button",{className:"stat-link danger",type:"button",onClick:()=>Ie(!1),children:"Cancel"})]})]})})]})}function WR(){const[n,e]=j.useState(!0),[t,s]=j.useState(""),[a,l]=j.useState(0),[d,f]=j.useState([]),[m,v]=j.useState(0),w=j.useRef(null);j.useEffect(()=>{document.title="Music | im.ok"},[]),j.useEffect(()=>{let _e=!1;async function V(){e(!0),s("");try{const ie=await fetch("https://music-api-worker.imokissick.workers.dev/music");if(!ie.ok)throw new Error("Worker fetch failed");const C=await ie.json();if(_e)return;const P=Array.isArray(C.combined)?C.combined:[],A=Array.isArray(C.spotify)?C.spotify:[],M=Array.isArray(C.soundcloud)?C.soundcloud:[],N=[...P,...A,...M].reduce((b,J)=>{const ne=(J.title||"").toLowerCase().trim();if(!ne)return b;const Re=b.findIndex(he=>(he.title||"").toLowerCase().trim()===ne);return Re>=0?(b[Re].source!=="spotify"&&J.source==="spotify"&&(b[Re]=J),b):(b.push(J),b)},[]).map(b=>({...b,releaseDate:b.releaseDate?new Date(b.releaseDate):new Date}));f(N)}catch(ie){console.error(ie),_e||s("Failed to load music feeds.")}finally{_e||e(!1)}}return V(),()=>{_e=!0}},[]);const T=Math.min(4,Math.max(1,d.length)),I=T?Math.ceil(d.length/T):0,U=()=>{w.current&&clearInterval(w.current),d.length&&(v(_e=>_e+1),w.current=setInterval(()=>{l(_e=>(Math.floor(_e/T)+1)%I*T%d.length),v(_e=>_e+1)},15e3))};j.useEffect(()=>{if(d.length)return U(),()=>{w.current&&clearInterval(w.current)}},[d,T]);const X=_e=>{d.length&&(l(V=>(Math.floor(V/T)+_e+I)%I*T%d.length),U())},$=_e=>{d.length&&(l(_e*T%d.length),U())},O=_e=>V=>{V.preventDefault();const C=_e.source==="spotify"?`spotify:album:${_e.id}`:_e.url,P=_e.url;try{const A=setTimeout(()=>{window.open(P,"_blank","noopener,noreferrer")},600);window.location.href=C,setTimeout(()=>clearTimeout(A),800)}catch{window.open(P,"_blank","noopener,noreferrer")}},se=d[0],Te=_e=>_e?{backgroundImage:`url(${_e})`,backgroundSize:"cover",backgroundPosition:"center"}:{},xe=se?se.source==="spotify"?"Spotify":"SoundCloud":"";return o.jsxs("main",{className:"page music-page",children:[o.jsxs("header",{className:"music-hero",children:[o.jsxs("div",{className:"music-hero-content",children:[o.jsx("p",{className:"music-pill",children:"im.ok  Artist"}),o.jsx("h1",{children:se?se.title:"Latest & Greatest"}),o.jsx("p",{className:"music-sub",children:"Check out my latest song. I know it's been almost a whole year since I've released. I have been on a much needed hiatus. I felt the whole world crumbling around me and had no time to breathe so this is why I took a break. Here's to 2026!"}),se&&o.jsx("div",{className:"music-badges",children:o.jsx("span",{children:xe})})]}),o.jsx("div",{className:"music-hero-embed",children:o.jsxs("div",{className:"music-hero-art",style:Te(se==null?void 0:se.artwork),children:[!(se!=null&&se.artwork)&&o.jsx("div",{className:"music-hero-art-fallback",children:"Artwork"}),se&&o.jsx("button",{className:"music-link music-play hero-play","aria-label":`Play ${se.title}`,onClick:O(se)})]})})]}),o.jsxs("section",{className:"music-section",children:[o.jsx("div",{className:"music-section-header",children:o.jsx("h2",{children:"Releases"})}),t&&o.jsx("div",{className:"music-error",children:t}),n&&o.jsx("div",{className:"music-loading",children:"Loading music feeds..."}),!n&&d.length===0&&o.jsx("div",{className:"music-empty",children:"Connect Spotify/SoundCloud tokens to see live releases."}),!n&&d.length>0&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"music-carousel-wrap",children:[o.jsx("button",{className:"music-nav left",onClick:()=>X(-1),"aria-label":"Previous releases",children:""}),o.jsx("div",{className:"music-carousel",children:Array.from({length:T}).map((_e,V)=>{const ie=d[(a+V)%d.length];return ie?o.jsxs("div",{className:"music-card",children:[o.jsx("div",{className:"music-card-art",style:Te(ie.artwork)}),o.jsxs("div",{className:"music-card-body",children:[o.jsx("div",{className:"music-card-title",children:ie.title}),o.jsx("div",{className:"music-card-actions",children:o.jsx("button",{className:"music-link music-play","aria-label":`Play ${ie.title}`,onClick:O(ie)})})]})]},`${ie.id}-${V}`):null})}),o.jsx("button",{className:"music-nav right",onClick:()=>X(1),"aria-label":"Next releases",children:""})]}),o.jsx("div",{className:"music-dots",children:Array.from({length:I}).map((_e,V)=>{const ie=Math.floor(a/T)===V,C=ie?`${V}-${m}`:`${V}-idle`;return o.jsx("button",{className:`dot ${ie?"active":""}`,onClick:()=>$(V),"aria-label":`Go to set ${V+1}`,children:o.jsx("span",{className:"dot-fill"},C)},V)})})]})]}),o.jsxs("div",{className:"music-feeds-row",children:[o.jsxs("section",{className:"music-section",children:[o.jsx("div",{className:"music-section-header",children:o.jsx("h2",{children:"Spotify"})}),o.jsx("div",{className:"music-embed-card",children:o.jsx("iframe",{title:"Spotify Artist",src:"https://open.spotify.com/embed/artist/00sbWLxYLDs8i5BLQL9Qdo?utm_source=generator&theme=0",width:"100%",height:"400",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy"})})]}),o.jsxs("section",{className:"music-section",children:[o.jsx("div",{className:"music-section-header",children:o.jsx("h2",{children:"SoundCloud"})}),o.jsx("div",{className:"music-embed-card",children:o.jsx("iframe",{title:"SoundCloud Player",width:"100%",height:"400",scrolling:"no",frameBorder:"no",allow:"autoplay",src:"https://w.soundcloud.com/player/?url=https%3A//soundcloud.com/imxk&color=%23ff69b4&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true&visual=true"})})]})]})]})}function GR(){const n=tc(),{user:e}=za(),t=async a=>{if(!(a!=null&&a.uid))return;const l=Dt(ot,"users",a.uid);try{const d=await Nd(l),f=d.exists()?d.data():null,m=(f==null?void 0:f.role)||"viewer";await ci(l,{role:m,email:a.email||(f==null?void 0:f.email)||"",displayName:a.displayName||(f==null?void 0:f.displayName)||"",createdAt:(f==null?void 0:f.createdAt)||ka()},{merge:!0})}catch(d){console.warn("Failed to upsert user doc",d)}};j.useEffect(()=>{e!=null&&e.uid&&t(e).finally(()=>n("/"))},[e,n]);async function s(){try{const a=new ys,l=await k0(Jr,a);await t(l.user),n("/")}catch(a){console.error(a),alert("Google Sign-In failed.")}}return o.jsx("div",{className:"signin-page",children:o.jsxs("div",{className:"signin-card",children:[o.jsx("h2",{className:"signin-title",children:"Welcome Back"}),o.jsx("p",{className:"signin-sub",children:"Sign in to access the dashboard & edit collections."}),o.jsxs("button",{className:"google-btn",onClick:s,children:[o.jsx("img",{src:"https://www.svgrepo.com/show/475656/google-color.svg",alt:"",className:"google-icon"}),"Continue with Google"]}),o.jsxs("button",{className:"signin-cancel",onClick:()=>n("/"),children:["<"," Back to Home"]})]})})}const qR=j.lazy(()=>pc(()=>import("./SteamCard-E_HhNDM_.js"),[])),HR=j.lazy(()=>pc(()=>import("./SteamRecents-YZqOprAB.js"),[])),KR=j.lazy(()=>pc(()=>import("./SteamGames-tkN04JD7.js"),[]));function QR(){return j.useEffect(()=>{document.title="Tyler's Gaming Lounge"},[]),o.jsxs("div",{className:"steam-page page",children:[o.jsxs("header",{style:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",gap:"6px"},children:[o.jsx("h1",{style:{margin:0,fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Tyler's Gaming Lounge"}),o.jsx("p",{style:{margin:"6px 0 0",color:"var(--text-soft)",fontSize:"0.9rem"},children:"This will be the home to all of my gaming collections, this is still being worked on, but thought it was cool with just steam for now."})]}),o.jsx(vf,{minHeight:260,children:o.jsx(j.Suspense,{fallback:o.jsx(Lu,{label:"Profile"}),children:o.jsx(qR,{})})}),o.jsx(vf,{minHeight:240,children:o.jsx(j.Suspense,{fallback:o.jsx(Lu,{label:"Recently played"}),children:o.jsx(HR,{})})}),o.jsx(vf,{minHeight:400,children:o.jsx(j.Suspense,{fallback:o.jsx(Lu,{label:"Library & Achievements"}),children:o.jsx(KR,{})})})]})}function vf({children:n,minHeight:e=200}){const[t,s]=j.useState(!1),a=j.useRef(null);j.useEffect(()=>{const d=new IntersectionObserver(f=>{f[0].isIntersecting&&(s(!0),d.disconnect())},{rootMargin:"200px 0px"});return a.current&&d.observe(a.current),()=>d.disconnect()},[]);const l=t?void 0:{minHeight:e};return o.jsx("div",{ref:a,style:l,children:t?n:o.jsx(Lu,{})})}function Lu({label:n="Loading section"}){return o.jsxs("div",{className:"steam-skeleton",children:[o.jsx("div",{className:"steam-skeleton-bar"}),o.jsx("div",{className:"steam-skeleton-bar short"}),o.jsx("p",{className:"steam-skeleton-label",children:n})]})}const _f={id:null,title:"",summary:"",body:"",cover:"",tags:"",status:"draft",publishedAt:null};function Vu(n){return n?n instanceof Date?n:n!=null&&n.toDate?n.toDate():null:null}function Tu(n){const e=Vu(n);return e?e.toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"}):""}function YR(n=[]){return Array.isArray(n)?n.join(", "):""}function JR(n){return(n||"").split(",").map(e=>e.trim()).filter(Boolean)}function XR(){var Re;const{admin:n,user:e,loading:t}=za(),[s,a]=LT(),[l,d]=j.useState([]),[f,m]=j.useState(!0),[v,w]=j.useState(!1),[T,I]=j.useState(!1),[U,X]=j.useState(""),[$,O]=j.useState(_f),[se,Te]=j.useState(null),xe=j.useMemo(()=>l.filter(he=>he.status==="published"),[l]),_e=j.useMemo(()=>n?l:xe,[n,l,xe]),V=j.useMemo(()=>_e.find(he=>he.id===se)||null,[se,_e]);j.useEffect(()=>{document.title="Blog | Reviews"},[]),j.useEffect(()=>{t||P()},[n,t]),j.useEffect(()=>{const he=s.get("post");he&&Te(he)},[s]),j.useEffect(()=>{var ve;if(f)return;const le=s.get("post")||se,Ie=le&&_e.some(Y=>Y.id===le)?le:((ve=_e[0])==null?void 0:ve.id)||null;A(Ie,{list:_e})},[f,_e]);const ie=!n&&!f&&xe.length===0;function C(he){return{id:he.id,title:he.title||"",summary:he.summary||"",body:he.body||"",cover:he.cover||"",tags:YR(he.tags),status:he.status||"draft",publishedAt:he.publishedAt||null}}async function P(he=null){var le;if(!t){m(!0),X("");try{const Ie=Sn(ot,"blogPosts"),ve=n?Jf(Ie,Xf("updatedAt","desc")):Jf(Ie,lx("status","==","published"),Xf("publishedAt","desc")),k=(await vs(ve)).docs.map(Le=>{const De=Le.data();return{id:Le.id,...De,createdAt:Vu(De.createdAt),updatedAt:Vu(De.updatedAt),publishedAt:Vu(De.publishedAt),tags:Array.isArray(De.tags)?De.tags:[]}});d(k);const q=n?k:k.filter(Le=>Le.status==="published"),Ee=he||s.get("post")||(q.length?q[0].id:null);Ee&&q.some(Le=>Le.id===Ee)?A(Ee,{list:q}):A(((le=q[0])==null?void 0:le.id)||null,{list:q})}catch(Ie){console.error("Failed to load blog posts",Ie);const ve=(Ie==null?void 0:Ie.code)==="permission-denied";X(ve?"You do not have permission to view these posts. Make sure you are signed in with an admin account.":"Failed to load posts. Try again shortly.")}finally{m(!1)}}}function A(he,{list:le}={}){Te(he||null),a(he?{post:he}:{});const Ie=le||l;if(n){const ve=Ie.find(Y=>Y.id===he);O(ve?C(ve):_f)}}function M(he){A(he),window.scrollTo({top:0,behavior:"smooth"})}function D(){O(_f),Te(null),a({})}function N(he){const le=he||$.status||"draft",Ie=le==="published"?$.publishedAt||ka():null;return{title:$.title.trim(),summary:$.summary.trim(),body:$.body.trim(),cover:$.cover.trim(),tags:JR($.tags),status:le,publishedAt:Ie,updatedAt:ka()}}async function b(he="draft"){if(!(!n||v)){if(!$.title.trim()||!$.body.trim()){X("Title and body are required.");return}w(!0),X("");try{const le=N(he);let Ie=$.id;$.id?await _s(Dt(ot,"blogPosts",$.id),le):Ie=(await Ra(Sn(ot,"blogPosts"),{...le,createdAt:ka()})).id,X(he==="published"?"Post published and visible to everyone.":"Draft saved."),await P(Ie)}catch(le){console.error("Failed to save blog post",le),X("Could not save the post. Try again.")}finally{w(!1)}}}async function J(he){if(!(!n||!he||T||!window.confirm("Delete this post? This cannot be undone."))){I(!0),X("");try{await Na(Dt(ot,"blogPosts",he)),X("Post deleted."),await P(),D()}catch(Ie){console.error("Failed to delete post",Ie),X("Could not delete the post.")}finally{I(!1)}}}const ne=((V==null?void 0:V.body)||"").split(/\n{2,}/).map((he,le)=>o.jsx("p",{className:"blog-body-paragraph",children:he},le));return t?o.jsx("div",{className:"page blog-page",children:o.jsx("div",{className:"blog-guard-card",children:"Checking access..."})}):e?n?o.jsxs("div",{className:"page blog-page",children:[o.jsxs("header",{className:"blog-hero",children:[o.jsx("div",{className:"blog-pill",children:n?"Admin workspace":"Latest updates"}),o.jsx("h1",{children:"Blog & Reviews"}),o.jsx("p",{children:"Share reviews for anime or manga you have read. Draft privately, publish when ready, and keep visitors in the loop with new releases."})]}),U&&o.jsx("div",{className:"blog-status",children:U}),o.jsxs("div",{className:"blog-shell",children:[o.jsxs("aside",{className:"blog-sidebar",children:[o.jsxs("div",{className:"blog-sidebar-header",children:[o.jsxs("div",{children:[o.jsx("div",{className:"blog-sidebar-label",children:"Posts"}),o.jsxs("div",{className:"blog-sidebar-count",children:[_e.length," ",_e.length===1?"entry":"entries"]})]}),n&&o.jsx("button",{type:"button",className:"blog-btn solid",onClick:D,children:"+ New draft"})]}),o.jsxs("div",{className:"blog-list",children:[f&&o.jsx("div",{className:"blog-muted",children:"Loading posts..."}),!f&&!_e.length&&o.jsx("div",{className:"blog-muted",children:"No posts yet."}),_e.map(he=>o.jsxs("button",{className:"blog-list-item"+(se===he.id?" active":""),onClick:()=>M(he.id),children:[o.jsxs("div",{className:"blog-list-row",children:[o.jsx("span",{className:"blog-list-title",children:he.title||"Untitled"}),o.jsx("span",{className:"blog-chip "+(he.status==="published"?"success":"draft"),children:he.status==="published"?"Published":"Draft"})]}),o.jsx("div",{className:"blog-list-sub",children:he.status==="published"?`Published ${Tu(he.publishedAt)}`:`Last touched ${Tu(he.updatedAt)}`})]},he.id))]})]}),o.jsxs("section",{className:"blog-main",children:[ie?o.jsxs("div",{className:"blog-guard-card",children:[o.jsx("h3",{children:"Under construction"}),o.jsx("p",{children:"This blog page is being built. Once posts are published, they will appear here. Admins can already create and publish posts."})]}):V?o.jsxs("article",{className:"blog-article",children:[o.jsxs("div",{className:"blog-article-meta",children:[o.jsx("span",{className:"blog-chip "+(V.status==="published"?"success":"draft"),children:V.status==="published"?"Published":"Draft"}),o.jsx("span",{className:"blog-meta-text",children:V.status==="published"?`Published ${Tu(V.publishedAt)}`:`Last saved ${Tu(V.updatedAt)}`})]}),o.jsx("h2",{className:"blog-article-title",children:V.title||"Untitled"}),V.summary&&o.jsx("p",{className:"blog-article-summary",children:V.summary}),V.cover&&o.jsx("div",{className:"blog-cover",children:o.jsx("img",{src:V.cover,alt:""})}),o.jsx("div",{className:"blog-body",children:ne}),(Re=V.tags)!=null&&Re.length?o.jsx("div",{className:"blog-tag-row",children:V.tags.map(he=>o.jsx("span",{className:"blog-chip ghost",children:he},he))}):null]}):o.jsxs("div",{className:"blog-guard-card",children:[o.jsx("h3",{children:"No post selected"}),o.jsx("p",{children:"Select a post from the left to read it."})]}),n&&o.jsxs("div",{className:"blog-editor-card",children:[o.jsxs("div",{className:"blog-editor-header",children:[o.jsxs("div",{children:[o.jsx("div",{className:"blog-sidebar-label",children:$.id?"Edit post":"New draft"}),o.jsx("div",{className:"blog-sidebar-count",children:$.id?"Update and publish when ready":"Fill in the details to create"})]}),$.id&&o.jsx("button",{type:"button",className:"blog-btn danger",onClick:()=>J($.id),disabled:T,children:T?"Deleting...":"Delete"})]}),o.jsxs("div",{className:"blog-form",children:[o.jsxs("label",{className:"blog-field",children:[o.jsx("span",{children:"Title"}),o.jsx("input",{type:"text",value:$.title,onChange:he=>O(le=>({...le,title:he.target.value})),placeholder:"e.g., Chainsaw Man Volume 14 Review"})]}),o.jsxs("label",{className:"blog-field",children:[o.jsx("span",{children:"Summary"}),o.jsx("input",{type:"text",value:$.summary,onChange:he=>O(le=>({...le,summary:he.target.value})),placeholder:"One-liner that appears in previews"})]}),o.jsxs("label",{className:"blog-field",children:[o.jsx("span",{children:"Cover image URL (optional)"}),o.jsx("input",{type:"url",value:$.cover,onChange:he=>O(le=>({...le,cover:he.target.value})),placeholder:"https://..."})]}),o.jsxs("label",{className:"blog-field",children:[o.jsx("span",{children:"Tags (comma separated)"}),o.jsx("input",{type:"text",value:$.tags,onChange:he=>O(le=>({...le,tags:he.target.value})),placeholder:"anime, manga, review"})]}),o.jsxs("label",{className:"blog-field",children:[o.jsx("span",{children:"Body"}),o.jsx("textarea",{rows:8,value:$.body,onChange:he=>O(le=>({...le,body:he.target.value})),placeholder:"Write your review here. Separate paragraphs with blank lines."})]}),o.jsxs("div",{className:"blog-actions",children:[o.jsx("button",{type:"button",className:"blog-btn",onClick:()=>b("draft"),disabled:v,children:v?"Saving...":"Save draft"}),o.jsx("button",{type:"button",className:"blog-btn solid",onClick:()=>b("published"),disabled:v,children:v?"Publishing...":"Publish"}),$.status==="published"&&o.jsx("button",{type:"button",className:"blog-btn ghost",onClick:()=>b("draft"),disabled:v,children:"Move to draft"})]})]})]})]})]})]}):o.jsx(xf,{to:"/home",replace:!0}):o.jsx(xf,{to:"/signin",replace:!0})}function ZR(){return o.jsxs(KN,{children:[o.jsx(eR,{}),o.jsxs(TT,{children:[o.jsx(Qr,{path:"/",element:o.jsx(d_,{})}),o.jsx(Qr,{path:"/home",element:o.jsx(d_,{})}),o.jsx(Qr,{path:"/manga",element:o.jsx(hR,{})}),o.jsx(Qr,{path:"/anime",element:o.jsx(TR,{})}),o.jsx(Qr,{path:"/tcg",element:o.jsx(bR,{})}),o.jsx(Qr,{path:"/music",element:o.jsx(WR,{})}),o.jsx(Qr,{path:"/blog",element:o.jsx(XR,{})}),o.jsx(Qr,{path:"/dashboard",element:o.jsx($R,{})}),o.jsx(Qr,{path:"/signin",element:o.jsx(GR,{})}),o.jsx(Qr,{path:"/steam",element:o.jsx(QR,{})}),o.jsx(Qr,{path:"*",element:o.jsx(xf,{to:"/home",replace:!0})})]})]})}AE.createRoot(document.getElementById("root")).render(o.jsx(tp.StrictMode,{children:o.jsx(AT,{basename:"/base",children:o.jsx(ZR,{})})}));export{o as j,j as r};
