function xE(n,e){for(var t=0;t<e.length;t++){const s=e[t];if(typeof s!="string"&&!Array.isArray(s)){for(const a in s)if(a!=="default"&&!(a in n)){const l=Object.getOwnPropertyDescriptor(s,a);l&&Object.defineProperty(n,a,l.get?l:{enumerable:!0,get:()=>s[a]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const d of l.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&s(d)}).observe(document,{childList:!0,subtree:!0});function t(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(a){if(a.ep)return;a.ep=!0;const l=t(a);fetch(a.href,l)}})();function Zf(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Zh={exports:{}},Cl={},ef={exports:{}},mt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fy;function EE(){if(fy)return mt;fy=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),d=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),v=Symbol.for("react.memo"),w=Symbol.for("react.lazy"),T=Symbol.iterator;function C(Y){return Y===null||typeof Y!="object"?null:(Y=T&&Y[T]||Y["@@iterator"],typeof Y=="function"?Y:null)}var U={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},X=Object.assign,q={};function F(Y,k,H){this.props=Y,this.context=k,this.refs=q,this.updater=H||U}F.prototype.isReactComponent={},F.prototype.setState=function(Y,k){if(typeof Y!="object"&&typeof Y!="function"&&Y!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Y,k,"setState")},F.prototype.forceUpdate=function(Y){this.updater.enqueueForceUpdate(this,Y,"forceUpdate")};function ie(){}ie.prototype=F.prototype;function Se(Y,k,H){this.props=Y,this.context=k,this.refs=q,this.updater=H||U}var Ee=Se.prototype=new ie;Ee.constructor=Se,X(Ee,F.prototype),Ee.isPureReactComponent=!0;var we=Array.isArray,V=Object.prototype.hasOwnProperty,ae={current:null},I={key:!0,ref:!0,__self:!0,__source:!0};function P(Y,k,H){var Te,De={},ke=null,Oe=null;if(k!=null)for(Te in k.ref!==void 0&&(Oe=k.ref),k.key!==void 0&&(ke=""+k.key),k)V.call(k,Te)&&!I.hasOwnProperty(Te)&&(De[Te]=k[Te]);var Qe=arguments.length-2;if(Qe===1)De.children=H;else if(1<Qe){for(var st=Array(Qe),ve=0;ve<Qe;ve++)st[ve]=arguments[ve+2];De.children=st}if(Y&&Y.defaultProps)for(Te in Qe=Y.defaultProps,Qe)De[Te]===void 0&&(De[Te]=Qe[Te]);return{$$typeof:n,type:Y,key:ke,ref:Oe,props:De,_owner:ae.current}}function A(Y,k){return{$$typeof:n,type:Y.type,key:k,ref:Y.ref,props:Y.props,_owner:Y._owner}}function M(Y){return typeof Y=="object"&&Y!==null&&Y.$$typeof===n}function D(Y){var k={"=":"=0",":":"=2"};return"$"+Y.replace(/[=:]/g,function(H){return k[H]})}var N=/\/+/g;function b(Y,k){return typeof Y=="object"&&Y!==null&&Y.key!=null?D(""+Y.key):k.toString(36)}function J(Y,k,H,Te,De){var ke=typeof Y;(ke==="undefined"||ke==="boolean")&&(Y=null);var Oe=!1;if(Y===null)Oe=!0;else switch(ke){case"string":case"number":Oe=!0;break;case"object":switch(Y.$$typeof){case n:case e:Oe=!0}}if(Oe)return Oe=Y,De=De(Oe),Y=Te===""?"."+b(Oe,0):Te,we(De)?(H="",Y!=null&&(H=Y.replace(N,"$&/")+"/"),J(De,k,H,"",function(ve){return ve})):De!=null&&(M(De)&&(De=A(De,H+(!De.key||Oe&&Oe.key===De.key?"":(""+De.key).replace(N,"$&/")+"/")+Y)),k.push(De)),1;if(Oe=0,Te=Te===""?".":Te+":",we(Y))for(var Qe=0;Qe<Y.length;Qe++){ke=Y[Qe];var st=Te+b(ke,Qe);Oe+=J(ke,k,H,st,De)}else if(st=C(Y),typeof st=="function")for(Y=st.call(Y),Qe=0;!(ke=Y.next()).done;)ke=ke.value,st=Te+b(ke,Qe++),Oe+=J(ke,k,H,st,De);else if(ke==="object")throw k=String(Y),Error("Objects are not valid as a React child (found: "+(k==="[object Object]"?"object with keys {"+Object.keys(Y).join(", ")+"}":k)+"). If you meant to render a collection of children, use an array instead.");return Oe}function re(Y,k,H){if(Y==null)return Y;var Te=[],De=0;return J(Y,Te,"","",function(ke){return k.call(H,ke,De++)}),Te}function Ce(Y){if(Y._status===-1){var k=Y._result;k=k(),k.then(function(H){(Y._status===0||Y._status===-1)&&(Y._status=1,Y._result=H)},function(H){(Y._status===0||Y._status===-1)&&(Y._status=2,Y._result=H)}),Y._status===-1&&(Y._status=0,Y._result=k)}if(Y._status===1)return Y._result.default;throw Y._result}var de={current:null},ce={transition:null},Ne={ReactCurrentDispatcher:de,ReactCurrentBatchConfig:ce,ReactCurrentOwner:ae};function _e(){throw Error("act(...) is not supported in production builds of React.")}return mt.Children={map:re,forEach:function(Y,k,H){re(Y,function(){k.apply(this,arguments)},H)},count:function(Y){var k=0;return re(Y,function(){k++}),k},toArray:function(Y){return re(Y,function(k){return k})||[]},only:function(Y){if(!M(Y))throw Error("React.Children.only expected to receive a single React element child.");return Y}},mt.Component=F,mt.Fragment=t,mt.Profiler=a,mt.PureComponent=Se,mt.StrictMode=s,mt.Suspense=m,mt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ne,mt.act=_e,mt.cloneElement=function(Y,k,H){if(Y==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+Y+".");var Te=X({},Y.props),De=Y.key,ke=Y.ref,Oe=Y._owner;if(k!=null){if(k.ref!==void 0&&(ke=k.ref,Oe=ae.current),k.key!==void 0&&(De=""+k.key),Y.type&&Y.type.defaultProps)var Qe=Y.type.defaultProps;for(st in k)V.call(k,st)&&!I.hasOwnProperty(st)&&(Te[st]=k[st]===void 0&&Qe!==void 0?Qe[st]:k[st])}var st=arguments.length-2;if(st===1)Te.children=H;else if(1<st){Qe=Array(st);for(var ve=0;ve<st;ve++)Qe[ve]=arguments[ve+2];Te.children=Qe}return{$$typeof:n,type:Y.type,key:De,ref:ke,props:Te,_owner:Oe}},mt.createContext=function(Y){return Y={$$typeof:d,_currentValue:Y,_currentValue2:Y,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},Y.Provider={$$typeof:l,_context:Y},Y.Consumer=Y},mt.createElement=P,mt.createFactory=function(Y){var k=P.bind(null,Y);return k.type=Y,k},mt.createRef=function(){return{current:null}},mt.forwardRef=function(Y){return{$$typeof:f,render:Y}},mt.isValidElement=M,mt.lazy=function(Y){return{$$typeof:w,_payload:{_status:-1,_result:Y},_init:Ce}},mt.memo=function(Y,k){return{$$typeof:v,type:Y,compare:k===void 0?null:k}},mt.startTransition=function(Y){var k=ce.transition;ce.transition={};try{Y()}finally{ce.transition=k}},mt.unstable_act=_e,mt.useCallback=function(Y,k){return de.current.useCallback(Y,k)},mt.useContext=function(Y){return de.current.useContext(Y)},mt.useDebugValue=function(){},mt.useDeferredValue=function(Y){return de.current.useDeferredValue(Y)},mt.useEffect=function(Y,k){return de.current.useEffect(Y,k)},mt.useId=function(){return de.current.useId()},mt.useImperativeHandle=function(Y,k,H){return de.current.useImperativeHandle(Y,k,H)},mt.useInsertionEffect=function(Y,k){return de.current.useInsertionEffect(Y,k)},mt.useLayoutEffect=function(Y,k){return de.current.useLayoutEffect(Y,k)},mt.useMemo=function(Y,k){return de.current.useMemo(Y,k)},mt.useReducer=function(Y,k,H){return de.current.useReducer(Y,k,H)},mt.useRef=function(Y){return de.current.useRef(Y)},mt.useState=function(Y){return de.current.useState(Y)},mt.useSyncExternalStore=function(Y,k,H){return de.current.useSyncExternalStore(Y,k,H)},mt.useTransition=function(){return de.current.useTransition()},mt.version="18.3.1",mt}var py;function ep(){return py||(py=1,ef.exports=EE()),ef.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var my;function TE(){if(my)return Cl;my=1;var n=ep(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,a=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function d(f,m,v){var w,T={},C=null,U=null;v!==void 0&&(C=""+v),m.key!==void 0&&(C=""+m.key),m.ref!==void 0&&(U=m.ref);for(w in m)s.call(m,w)&&!l.hasOwnProperty(w)&&(T[w]=m[w]);if(f&&f.defaultProps)for(w in m=f.defaultProps,m)T[w]===void 0&&(T[w]=m[w]);return{$$typeof:e,type:f,key:C,ref:U,props:T,_owner:a.current}}return Cl.Fragment=t,Cl.jsx=d,Cl.jsxs=d,Cl}var gy;function SE(){return gy||(gy=1,Zh.exports=TE()),Zh.exports}var o=SE(),j=ep();const tp=Zf(j),bE=xE({__proto__:null,default:tp},[j]);var mu={},tf={exports:{}},br={},nf={exports:{}},rf={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yy;function CE(){return yy||(yy=1,(function(n){function e(ce,Ne){var _e=ce.length;ce.push(Ne);e:for(;0<_e;){var Y=_e-1>>>1,k=ce[Y];if(0<a(k,Ne))ce[Y]=Ne,ce[_e]=k,_e=Y;else break e}}function t(ce){return ce.length===0?null:ce[0]}function s(ce){if(ce.length===0)return null;var Ne=ce[0],_e=ce.pop();if(_e!==Ne){ce[0]=_e;e:for(var Y=0,k=ce.length,H=k>>>1;Y<H;){var Te=2*(Y+1)-1,De=ce[Te],ke=Te+1,Oe=ce[ke];if(0>a(De,_e))ke<k&&0>a(Oe,De)?(ce[Y]=Oe,ce[ke]=_e,Y=ke):(ce[Y]=De,ce[Te]=_e,Y=Te);else if(ke<k&&0>a(Oe,_e))ce[Y]=Oe,ce[ke]=_e,Y=ke;else break e}}return Ne}function a(ce,Ne){var _e=ce.sortIndex-Ne.sortIndex;return _e!==0?_e:ce.id-Ne.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;n.unstable_now=function(){return l.now()}}else{var d=Date,f=d.now();n.unstable_now=function(){return d.now()-f}}var m=[],v=[],w=1,T=null,C=3,U=!1,X=!1,q=!1,F=typeof setTimeout=="function"?setTimeout:null,ie=typeof clearTimeout=="function"?clearTimeout:null,Se=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function Ee(ce){for(var Ne=t(v);Ne!==null;){if(Ne.callback===null)s(v);else if(Ne.startTime<=ce)s(v),Ne.sortIndex=Ne.expirationTime,e(m,Ne);else break;Ne=t(v)}}function we(ce){if(q=!1,Ee(ce),!X)if(t(m)!==null)X=!0,Ce(V);else{var Ne=t(v);Ne!==null&&de(we,Ne.startTime-ce)}}function V(ce,Ne){X=!1,q&&(q=!1,ie(P),P=-1),U=!0;var _e=C;try{for(Ee(Ne),T=t(m);T!==null&&(!(T.expirationTime>Ne)||ce&&!D());){var Y=T.callback;if(typeof Y=="function"){T.callback=null,C=T.priorityLevel;var k=Y(T.expirationTime<=Ne);Ne=n.unstable_now(),typeof k=="function"?T.callback=k:T===t(m)&&s(m),Ee(Ne)}else s(m);T=t(m)}if(T!==null)var H=!0;else{var Te=t(v);Te!==null&&de(we,Te.startTime-Ne),H=!1}return H}finally{T=null,C=_e,U=!1}}var ae=!1,I=null,P=-1,A=5,M=-1;function D(){return!(n.unstable_now()-M<A)}function N(){if(I!==null){var ce=n.unstable_now();M=ce;var Ne=!0;try{Ne=I(!0,ce)}finally{Ne?b():(ae=!1,I=null)}}else ae=!1}var b;if(typeof Se=="function")b=function(){Se(N)};else if(typeof MessageChannel<"u"){var J=new MessageChannel,re=J.port2;J.port1.onmessage=N,b=function(){re.postMessage(null)}}else b=function(){F(N,0)};function Ce(ce){I=ce,ae||(ae=!0,b())}function de(ce,Ne){P=F(function(){ce(n.unstable_now())},Ne)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ce){ce.callback=null},n.unstable_continueExecution=function(){X||U||(X=!0,Ce(V))},n.unstable_forceFrameRate=function(ce){0>ce||125<ce?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<ce?Math.floor(1e3/ce):5},n.unstable_getCurrentPriorityLevel=function(){return C},n.unstable_getFirstCallbackNode=function(){return t(m)},n.unstable_next=function(ce){switch(C){case 1:case 2:case 3:var Ne=3;break;default:Ne=C}var _e=C;C=Ne;try{return ce()}finally{C=_e}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(ce,Ne){switch(ce){case 1:case 2:case 3:case 4:case 5:break;default:ce=3}var _e=C;C=ce;try{return Ne()}finally{C=_e}},n.unstable_scheduleCallback=function(ce,Ne,_e){var Y=n.unstable_now();switch(typeof _e=="object"&&_e!==null?(_e=_e.delay,_e=typeof _e=="number"&&0<_e?Y+_e:Y):_e=Y,ce){case 1:var k=-1;break;case 2:k=250;break;case 5:k=1073741823;break;case 4:k=1e4;break;default:k=5e3}return k=_e+k,ce={id:w++,callback:Ne,priorityLevel:ce,startTime:_e,expirationTime:k,sortIndex:-1},_e>Y?(ce.sortIndex=_e,e(v,ce),t(m)===null&&ce===t(v)&&(q?(ie(P),P=-1):q=!0,de(we,_e-Y))):(ce.sortIndex=k,e(m,ce),X||U||(X=!0,Ce(V))),ce},n.unstable_shouldYield=D,n.unstable_wrapCallback=function(ce){var Ne=C;return function(){var _e=C;C=Ne;try{return ce.apply(this,arguments)}finally{C=_e}}}})(rf)),rf}var vy;function IE(){return vy||(vy=1,nf.exports=CE()),nf.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _y;function PE(){if(_y)return br;_y=1;var n=ep(),e=IE();function t(r){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+r,c=1;c<arguments.length;c++)i+="&args[]="+encodeURIComponent(arguments[c]);return"Minified React error #"+r+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,a={};function l(r,i){d(r,i),d(r+"Capture",i)}function d(r,i){for(a[r]=i,r=0;r<i.length;r++)s.add(i[r])}var f=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),m=Object.prototype.hasOwnProperty,v=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,w={},T={};function C(r){return m.call(T,r)?!0:m.call(w,r)?!1:v.test(r)?T[r]=!0:(w[r]=!0,!1)}function U(r,i,c,h){if(c!==null&&c.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return h?!1:c!==null?!c.acceptsBooleans:(r=r.toLowerCase().slice(0,5),r!=="data-"&&r!=="aria-");default:return!1}}function X(r,i,c,h){if(i===null||typeof i>"u"||U(r,i,c,h))return!0;if(h)return!1;if(c!==null)switch(c.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function q(r,i,c,h,p,y,E){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=h,this.attributeNamespace=p,this.mustUseProperty=c,this.propertyName=r,this.type=i,this.sanitizeURL=y,this.removeEmptyString=E}var F={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(r){F[r]=new q(r,0,!1,r,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(r){var i=r[0];F[i]=new q(i,1,!1,r[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(r){F[r]=new q(r,2,!1,r.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(r){F[r]=new q(r,2,!1,r,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(r){F[r]=new q(r,3,!1,r.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(r){F[r]=new q(r,3,!0,r,null,!1,!1)}),["capture","download"].forEach(function(r){F[r]=new q(r,4,!1,r,null,!1,!1)}),["cols","rows","size","span"].forEach(function(r){F[r]=new q(r,6,!1,r,null,!1,!1)}),["rowSpan","start"].forEach(function(r){F[r]=new q(r,5,!1,r.toLowerCase(),null,!1,!1)});var ie=/[\-:]([a-z])/g;function Se(r){return r[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(r){var i=r.replace(ie,Se);F[i]=new q(i,1,!1,r,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(r){var i=r.replace(ie,Se);F[i]=new q(i,1,!1,r,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(r){var i=r.replace(ie,Se);F[i]=new q(i,1,!1,r,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(r){F[r]=new q(r,1,!1,r.toLowerCase(),null,!1,!1)}),F.xlinkHref=new q("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(r){F[r]=new q(r,1,!1,r.toLowerCase(),null,!0,!0)});function Ee(r,i,c,h){var p=F.hasOwnProperty(i)?F[i]:null;(p!==null?p.type!==0:h||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(X(i,c,p,h)&&(c=null),h||p===null?C(i)&&(c===null?r.removeAttribute(i):r.setAttribute(i,""+c)):p.mustUseProperty?r[p.propertyName]=c===null?p.type===3?!1:"":c:(i=p.attributeName,h=p.attributeNamespace,c===null?r.removeAttribute(i):(p=p.type,c=p===3||p===4&&c===!0?"":""+c,h?r.setAttributeNS(h,i,c):r.setAttribute(i,c))))}var we=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,V=Symbol.for("react.element"),ae=Symbol.for("react.portal"),I=Symbol.for("react.fragment"),P=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),M=Symbol.for("react.provider"),D=Symbol.for("react.context"),N=Symbol.for("react.forward_ref"),b=Symbol.for("react.suspense"),J=Symbol.for("react.suspense_list"),re=Symbol.for("react.memo"),Ce=Symbol.for("react.lazy"),de=Symbol.for("react.offscreen"),ce=Symbol.iterator;function Ne(r){return r===null||typeof r!="object"?null:(r=ce&&r[ce]||r["@@iterator"],typeof r=="function"?r:null)}var _e=Object.assign,Y;function k(r){if(Y===void 0)try{throw Error()}catch(c){var i=c.stack.trim().match(/\n( *(at )?)/);Y=i&&i[1]||""}return`
`+Y+r}var H=!1;function Te(r,i){if(!r||H)return"";H=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(se){var h=se}Reflect.construct(r,[],i)}else{try{i.call()}catch(se){h=se}r.call(i.prototype)}else{try{throw Error()}catch(se){h=se}r()}}catch(se){if(se&&h&&typeof se.stack=="string"){for(var p=se.stack.split(`
`),y=h.stack.split(`
`),E=p.length-1,L=y.length-1;1<=E&&0<=L&&p[E]!==y[L];)L--;for(;1<=E&&0<=L;E--,L--)if(p[E]!==y[L]){if(E!==1||L!==1)do if(E--,L--,0>L||p[E]!==y[L]){var G=`
`+p[E].replace(" at new "," at ");return r.displayName&&G.includes("<anonymous>")&&(G=G.replace("<anonymous>",r.displayName)),G}while(1<=E&&0<=L);break}}}finally{H=!1,Error.prepareStackTrace=c}return(r=r?r.displayName||r.name:"")?k(r):""}function De(r){switch(r.tag){case 5:return k(r.type);case 16:return k("Lazy");case 13:return k("Suspense");case 19:return k("SuspenseList");case 0:case 2:case 15:return r=Te(r.type,!1),r;case 11:return r=Te(r.type.render,!1),r;case 1:return r=Te(r.type,!0),r;default:return""}}function ke(r){if(r==null)return null;if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case I:return"Fragment";case ae:return"Portal";case A:return"Profiler";case P:return"StrictMode";case b:return"Suspense";case J:return"SuspenseList"}if(typeof r=="object")switch(r.$$typeof){case D:return(r.displayName||"Context")+".Consumer";case M:return(r._context.displayName||"Context")+".Provider";case N:var i=r.render;return r=r.displayName,r||(r=i.displayName||i.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case re:return i=r.displayName||null,i!==null?i:ke(r.type)||"Memo";case Ce:i=r._payload,r=r._init;try{return ke(r(i))}catch{}}return null}function Oe(r){var i=r.type;switch(r.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return r=i.render,r=r.displayName||r.name||"",i.displayName||(r!==""?"ForwardRef("+r+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ke(i);case 8:return i===P?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function Qe(r){switch(typeof r){case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function st(r){var i=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function ve(r){var i=st(r)?"checked":"value",c=Object.getOwnPropertyDescriptor(r.constructor.prototype,i),h=""+r[i];if(!r.hasOwnProperty(i)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var p=c.get,y=c.set;return Object.defineProperty(r,i,{configurable:!0,get:function(){return p.call(this)},set:function(E){h=""+E,y.call(this,E)}}),Object.defineProperty(r,i,{enumerable:c.enumerable}),{getValue:function(){return h},setValue:function(E){h=""+E},stopTracking:function(){r._valueTracker=null,delete r[i]}}}}function ue(r){r._valueTracker||(r._valueTracker=ve(r))}function Ve(r){if(!r)return!1;var i=r._valueTracker;if(!i)return!0;var c=i.getValue(),h="";return r&&(h=st(r)?r.checked?"true":"false":r.value),r=h,r!==c?(i.setValue(r),!0):!1}function me(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}function He(r,i){var c=i.checked;return _e({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:c??r._wrapperState.initialChecked})}function Ye(r,i){var c=i.defaultValue==null?"":i.defaultValue,h=i.checked!=null?i.checked:i.defaultChecked;c=Qe(i.value!=null?i.value:c),r._wrapperState={initialChecked:h,initialValue:c,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function Tt(r,i){i=i.checked,i!=null&&Ee(r,"checked",i,!1)}function Ct(r,i){Tt(r,i);var c=Qe(i.value),h=i.type;if(c!=null)h==="number"?(c===0&&r.value===""||r.value!=c)&&(r.value=""+c):r.value!==""+c&&(r.value=""+c);else if(h==="submit"||h==="reset"){r.removeAttribute("value");return}i.hasOwnProperty("value")?Nt(r,i.type,c):i.hasOwnProperty("defaultValue")&&Nt(r,i.type,Qe(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(r.defaultChecked=!!i.defaultChecked)}function gt(r,i,c){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var h=i.type;if(!(h!=="submit"&&h!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+r._wrapperState.initialValue,c||i===r.value||(r.value=i),r.defaultValue=i}c=r.name,c!==""&&(r.name=""),r.defaultChecked=!!r._wrapperState.initialChecked,c!==""&&(r.name=c)}function Nt(r,i,c){(i!=="number"||me(r.ownerDocument)!==r)&&(c==null?r.defaultValue=""+r._wrapperState.initialValue:r.defaultValue!==""+c&&(r.defaultValue=""+c))}var Yt=Array.isArray;function tn(r,i,c,h){if(r=r.options,i){i={};for(var p=0;p<c.length;p++)i["$"+c[p]]=!0;for(c=0;c<r.length;c++)p=i.hasOwnProperty("$"+r[c].value),r[c].selected!==p&&(r[c].selected=p),p&&h&&(r[c].defaultSelected=!0)}else{for(c=""+Qe(c),i=null,p=0;p<r.length;p++){if(r[p].value===c){r[p].selected=!0,h&&(r[p].defaultSelected=!0);return}i!==null||r[p].disabled||(i=r[p])}i!==null&&(i.selected=!0)}}function nn(r,i){if(i.dangerouslySetInnerHTML!=null)throw Error(t(91));return _e({},i,{value:void 0,defaultValue:void 0,children:""+r._wrapperState.initialValue})}function ur(r,i){var c=i.value;if(c==null){if(c=i.children,i=i.defaultValue,c!=null){if(i!=null)throw Error(t(92));if(Yt(c)){if(1<c.length)throw Error(t(93));c=c[0]}i=c}i==null&&(i=""),c=i}r._wrapperState={initialValue:Qe(c)}}function rn(r,i){var c=Qe(i.value),h=Qe(i.defaultValue);c!=null&&(c=""+c,c!==r.value&&(r.value=c),i.defaultValue==null&&r.defaultValue!==c&&(r.defaultValue=c)),h!=null&&(r.defaultValue=""+h)}function Yn(r){var i=r.textContent;i===r._wrapperState.initialValue&&i!==""&&i!==null&&(r.value=i)}function Ot(r){switch(r){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function $t(r,i){return r==null||r==="http://www.w3.org/1999/xhtml"?Ot(i):r==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":r}var Un,dr=(function(r){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,c,h,p){MSApp.execUnsafeLocalFunction(function(){return r(i,c,h,p)})}:r})(function(r,i){if(r.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in r)r.innerHTML=i;else{for(Un=Un||document.createElement("div"),Un.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=Un.firstChild;r.firstChild;)r.removeChild(r.firstChild);for(;i.firstChild;)r.appendChild(i.firstChild)}});function Pn(r,i){if(i){var c=r.firstChild;if(c&&c===r.lastChild&&c.nodeType===3){c.nodeValue=i;return}}r.textContent=i}var zn={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Jt=["Webkit","ms","Moz","O"];Object.keys(zn).forEach(function(r){Jt.forEach(function(i){i=i+r.charAt(0).toUpperCase()+r.substring(1),zn[i]=zn[r]})});function ss(r,i,c){return i==null||typeof i=="boolean"||i===""?"":c||typeof i!="number"||i===0||zn.hasOwnProperty(r)&&zn[r]?(""+i).trim():i+"px"}function Nn(r,i){r=r.style;for(var c in i)if(i.hasOwnProperty(c)){var h=c.indexOf("--")===0,p=ss(c,i[c],h);c==="float"&&(c="cssFloat"),h?r.setProperty(c,p):r[c]=p}}var wn=_e({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function is(r,i){if(i){if(wn[r]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(t(137,r));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(t(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(t(61))}if(i.style!=null&&typeof i.style!="object")throw Error(t(62))}}function Ss(r,i){if(r.indexOf("-")===-1)return typeof i.is=="string";switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Pt=null;function yr(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var bs=null,Jn=null,Xn=null;function Rr(r){if(r=dl(r)){if(typeof bs!="function")throw Error(t(280));var i=r.stateNode;i&&(i=Rc(i),bs(r.stateNode,r.type,i))}}function Rn(r){Jn?Xn?Xn.push(r):Xn=[r]:Jn=r}function Ar(){if(Jn){var r=Jn,i=Xn;if(Xn=Jn=null,Rr(r),i)for(r=0;r<i.length;r++)Rr(i[r])}}function Zn(r,i){return r(i)}function qs(){}var vr=!1;function Hs(r,i,c){if(vr)return r(i,c);vr=!0;try{return Zn(r,i,c)}finally{vr=!1,(Jn!==null||Xn!==null)&&(qs(),Ar())}}function Ze(r,i){var c=r.stateNode;if(c===null)return null;var h=Rc(c);if(h===null)return null;c=h[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(r=r.type,h=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!h;break e;default:r=!1}if(r)return null;if(c&&typeof c!="function")throw Error(t(231,i,typeof c));return c}var er=!1;if(f)try{var An={};Object.defineProperty(An,"passive",{get:function(){er=!0}}),window.addEventListener("test",An,An),window.removeEventListener("test",An,An)}catch{er=!1}function as(r,i,c,h,p,y,E,L,G){var se=Array.prototype.slice.call(arguments,3);try{i.apply(c,se)}catch(be){this.onError(be)}}var jn=!1,xn=null,kn=!1,Cs=null,Is={onError:function(r){jn=!0,xn=r}};function Bn(r,i,c,h,p,y,E,L,G){jn=!1,xn=null,as.apply(Is,arguments)}function $r(r,i,c,h,p,y,E,L,G){if(Bn.apply(this,arguments),jn){if(jn){var se=xn;jn=!1,xn=null}else throw Error(t(198));kn||(kn=!0,Cs=se)}}function Ft(r){var i=r,c=r;if(r.alternate)for(;i.return;)i=i.return;else{r=i;do i=r,(i.flags&4098)!==0&&(c=i.return),r=i.return;while(r)}return i.tag===3?c:null}function os(r){if(r.tag===13){var i=r.memoizedState;if(i===null&&(r=r.alternate,r!==null&&(i=r.memoizedState)),i!==null)return i.dehydrated}return null}function dn(r){if(Ft(r)!==r)throw Error(t(188))}function jr(r){var i=r.alternate;if(!i){if(i=Ft(r),i===null)throw Error(t(188));return i!==r?null:r}for(var c=r,h=i;;){var p=c.return;if(p===null)break;var y=p.alternate;if(y===null){if(h=p.return,h!==null){c=h;continue}break}if(p.child===y.child){for(y=p.child;y;){if(y===c)return dn(p),r;if(y===h)return dn(p),i;y=y.sibling}throw Error(t(188))}if(c.return!==h.return)c=p,h=y;else{for(var E=!1,L=p.child;L;){if(L===c){E=!0,c=p,h=y;break}if(L===h){E=!0,h=p,c=y;break}L=L.sibling}if(!E){for(L=y.child;L;){if(L===c){E=!0,c=y,h=p;break}if(L===h){E=!0,h=y,c=p;break}L=L.sibling}if(!E)throw Error(t(189))}}if(c.alternate!==h)throw Error(t(190))}if(c.tag!==3)throw Error(t(188));return c.stateNode.current===c?r:i}function Ks(r){return r=jr(r),r!==null?Wr(r):null}function Wr(r){if(r.tag===5||r.tag===6)return r;for(r=r.child;r!==null;){var i=Wr(r);if(i!==null)return i;r=r.sibling}return null}var ls=e.unstable_scheduleCallback,hn=e.unstable_cancelCallback,Qs=e.unstable_shouldYield,Ys=e.unstable_requestPaint,dt=e.unstable_now,hr=e.unstable_getCurrentPriorityLevel,fn=e.unstable_ImmediatePriority,pn=e.unstable_UserBlockingPriority,x=e.unstable_NormalPriority,z=e.unstable_LowPriority,$=e.unstable_IdlePriority,O=null,W=null;function pe(r){if(W&&typeof W.onCommitFiberRoot=="function")try{W.onCommitFiberRoot(O,r,void 0,(r.current.flags&128)===128)}catch{}}var ne=Math.clz32?Math.clz32:Be,Me=Math.log,ge=Math.LN2;function Be(r){return r>>>=0,r===0?32:31-(Me(r)/ge|0)|0}var le=64,rt=4194304;function Re(r){switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return r&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return r}}function ht(r,i){var c=r.pendingLanes;if(c===0)return 0;var h=0,p=r.suspendedLanes,y=r.pingedLanes,E=c&268435455;if(E!==0){var L=E&~p;L!==0?h=Re(L):(y&=E,y!==0&&(h=Re(y)))}else E=c&~p,E!==0?h=Re(E):y!==0&&(h=Re(y));if(h===0)return 0;if(i!==0&&i!==h&&(i&p)===0&&(p=h&-h,y=i&-i,p>=y||p===16&&(y&4194240)!==0))return i;if((h&4)!==0&&(h|=c&16),i=r.entangledLanes,i!==0)for(r=r.entanglements,i&=h;0<i;)c=31-ne(i),p=1<<c,h|=r[c],i&=~p;return h}function Ps(r,i){switch(r){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function sn(r,i){for(var c=r.suspendedLanes,h=r.pingedLanes,p=r.expirationTimes,y=r.pendingLanes;0<y;){var E=31-ne(y),L=1<<E,G=p[E];G===-1?((L&c)===0||(L&h)!==0)&&(p[E]=Ps(L,i)):G<=i&&(r.expiredLanes|=L),y&=~L}}function Dn(r){return r=r.pendingLanes&-1073741825,r!==0?r:r&1073741824?1073741824:0}function fr(){var r=le;return le<<=1,(le&4194240)===0&&(le=64),r}function kr(r){for(var i=[],c=0;31>c;c++)i.push(r);return i}function cs(r,i,c){r.pendingLanes|=i,i!==536870912&&(r.suspendedLanes=0,r.pingedLanes=0),r=r.eventTimes,i=31-ne(i),r[i]=c}function Rt(r,i){var c=r.pendingLanes&~i;r.pendingLanes=i,r.suspendedLanes=0,r.pingedLanes=0,r.expiredLanes&=i,r.mutableReadLanes&=i,r.entangledLanes&=i,i=r.entanglements;var h=r.eventTimes;for(r=r.expirationTimes;0<c;){var p=31-ne(c),y=1<<p;i[p]=0,h[p]=-1,r[p]=-1,c&=~y}}function Ns(r,i){var c=r.entangledLanes|=i;for(r=r.entanglements;c;){var h=31-ne(c),p=1<<h;p&i|r[h]&i&&(r[h]|=i),c&=~p}}var pt=0;function Rs(r){return r&=-r,1<r?4<r?(r&268435455)!==0?16:536870912:4:1}var S,B,Q,he,Ie,Ge=!1,Ae=[],Je=null,ut=null,yt=null,Lt=new Map,St=new Map,an=[],En="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function wt(r,i){switch(r){case"focusin":case"focusout":Je=null;break;case"dragenter":case"dragleave":ut=null;break;case"mouseover":case"mouseout":yt=null;break;case"pointerover":case"pointerout":Lt.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":St.delete(i.pointerId)}}function on(r,i,c,h,p,y){return r===null||r.nativeEvent!==y?(r={blockedOn:i,domEventName:c,eventSystemFlags:h,nativeEvent:y,targetContainers:[p]},i!==null&&(i=dl(i),i!==null&&B(i)),r):(r.eventSystemFlags|=h,i=r.targetContainers,p!==null&&i.indexOf(p)===-1&&i.push(p),r)}function tr(r,i,c,h,p){switch(i){case"focusin":return Je=on(Je,r,i,c,h,p),!0;case"dragenter":return ut=on(ut,r,i,c,h,p),!0;case"mouseover":return yt=on(yt,r,i,c,h,p),!0;case"pointerover":var y=p.pointerId;return Lt.set(y,on(Lt.get(y)||null,r,i,c,h,p)),!0;case"gotpointercapture":return y=p.pointerId,St.set(y,on(St.get(y)||null,r,i,c,h,p)),!0}return!1}function Gr(r){var i=pa(r.target);if(i!==null){var c=Ft(i);if(c!==null){if(i=c.tag,i===13){if(i=os(c),i!==null){r.blockedOn=i,Ie(r.priority,function(){Q(c)});return}}else if(i===3&&c.stateNode.current.memoizedState.isDehydrated){r.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Dr(r){if(r.blockedOn!==null)return!1;for(var i=r.targetContainers;0<i.length;){var c=Wa(r.domEventName,r.eventSystemFlags,i[0],r.nativeEvent);if(c===null){c=r.nativeEvent;var h=new c.constructor(c.type,c);Pt=h,c.target.dispatchEvent(h),Pt=null}else return i=dl(c),i!==null&&B(i),r.blockedOn=c,!1;i.shift()}return!0}function Js(r,i,c){Dr(r)&&c.delete(i)}function $a(){Ge=!1,Je!==null&&Dr(Je)&&(Je=null),ut!==null&&Dr(ut)&&(ut=null),yt!==null&&Dr(yt)&&(yt=null),Lt.forEach(Js),St.forEach(Js)}function Lr(r,i){r.blockedOn===i&&(r.blockedOn=null,Ge||(Ge=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,$a)))}function $n(r){function i(p){return Lr(p,r)}if(0<Ae.length){Lr(Ae[0],r);for(var c=1;c<Ae.length;c++){var h=Ae[c];h.blockedOn===r&&(h.blockedOn=null)}}for(Je!==null&&Lr(Je,r),ut!==null&&Lr(ut,r),yt!==null&&Lr(yt,r),Lt.forEach(i),St.forEach(i),c=0;c<an.length;c++)h=an[c],h.blockedOn===r&&(h.blockedOn=null);for(;0<an.length&&(c=an[0],c.blockedOn===null);)Gr(c),c.blockedOn===null&&an.shift()}var us=we.ReactCurrentBatchConfig,Ei=!0;function Wt(r,i,c,h){var p=pt,y=us.transition;us.transition=null;try{pt=1,Jo(r,i,c,h)}finally{pt=p,us.transition=y}}function jd(r,i,c,h){var p=pt,y=us.transition;us.transition=null;try{pt=4,Jo(r,i,c,h)}finally{pt=p,us.transition=y}}function Jo(r,i,c,h){if(Ei){var p=Wa(r,i,c,h);if(p===null)$d(r,i,h,da,c),wt(r,h);else if(tr(p,r,i,c,h))h.stopPropagation();else if(wt(r,h),i&4&&-1<En.indexOf(r)){for(;p!==null;){var y=dl(p);if(y!==null&&S(y),y=Wa(r,i,c,h),y===null&&$d(r,i,h,da,c),y===p)break;p=y}p!==null&&h.stopPropagation()}else $d(r,i,h,null,c)}}var da=null;function Wa(r,i,c,h){if(da=null,r=yr(h),r=pa(r),r!==null)if(i=Ft(r),i===null)r=null;else if(c=i.tag,c===13){if(r=os(i),r!==null)return r;r=null}else if(c===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;r=null}else i!==r&&(r=null);return da=r,null}function Xo(r){switch(r){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(hr()){case fn:return 1;case pn:return 4;case x:case z:return 16;case $:return 536870912;default:return 16}default:return 16}}var Vr=null,Ga=null,_r=null;function Zo(){if(_r)return _r;var r,i=Ga,c=i.length,h,p="value"in Vr?Vr.value:Vr.textContent,y=p.length;for(r=0;r<c&&i[r]===p[r];r++);var E=c-r;for(h=1;h<=E&&i[c-h]===p[y-h];h++);return _r=p.slice(r,1<h?1-h:void 0)}function qa(r){var i=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&i===13&&(r=13)):r=i,r===10&&(r=13),32<=r||r===13?r:0}function As(){return!0}function el(){return!1}function Wn(r){function i(c,h,p,y,E){this._reactName=c,this._targetInst=p,this.type=h,this.nativeEvent=y,this.target=E,this.currentTarget=null;for(var L in r)r.hasOwnProperty(L)&&(c=r[L],this[L]=c?c(y):y[L]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?As:el,this.isPropagationStopped=el,this}return _e(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=As)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=As)},persist:function(){},isPersistent:As}),i}var ds={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ha=Wn(ds),js=_e({},ds,{view:0,detail:0}),kd=Wn(js),Ka,Xs,Ti,ha=_e({},js,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ks,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Ti&&(Ti&&r.type==="mousemove"?(Ka=r.screenX-Ti.screenX,Xs=r.screenY-Ti.screenY):Xs=Ka=0,Ti=r),Ka)},movementY:function(r){return"movementY"in r?r.movementY:Xs}}),Qa=Wn(ha),tl=_e({},ha,{dataTransfer:0}),gc=Wn(tl),Ya=_e({},js,{relatedTarget:0}),Ja=Wn(Ya),yc=_e({},ds,{animationName:0,elapsedTime:0,pseudoElement:0}),Zs=Wn(yc),vc=_e({},ds,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),_c=Wn(vc),wc=_e({},ds,{data:0}),nl=Wn(wc),Xa={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},pr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},xc={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ec(r){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(r):(r=xc[r])?!!i[r]:!1}function ks(){return Ec}var u=_e({},js,{key:function(r){if(r.key){var i=Xa[r.key]||r.key;if(i!=="Unidentified")return i}return r.type==="keypress"?(r=qa(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?pr[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ks,charCode:function(r){return r.type==="keypress"?qa(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?qa(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),g=Wn(u),_=_e({},ha,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),R=Wn(_),Z=_e({},js,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ks}),oe=Wn(Z),Le=_e({},ds,{propertyName:0,elapsedTime:0,pseudoElement:0}),jt=Wn(Le),Tn=_e({},ha,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),xt=Wn(Tn),Ln=[9,13,27,32],mn=f&&"CompositionEvent"in window,qr=null;f&&"documentMode"in document&&(qr=document.documentMode);var Mr=f&&"TextEvent"in window&&!qr,fa=f&&(!mn||qr&&8<qr&&11>=qr),Za=" ",om=!1;function lm(r,i){switch(r){case"keyup":return Ln.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function cm(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var eo=!1;function vx(r,i){switch(r){case"compositionend":return cm(i);case"keypress":return i.which!==32?null:(om=!0,Za);case"textInput":return r=i.data,r===Za&&om?null:r;default:return null}}function _x(r,i){if(eo)return r==="compositionend"||!mn&&lm(r,i)?(r=Zo(),_r=Ga=Vr=null,eo=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return fa&&i.locale!=="ko"?null:i.data;default:return null}}var wx={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function um(r){var i=r&&r.nodeName&&r.nodeName.toLowerCase();return i==="input"?!!wx[r.type]:i==="textarea"}function dm(r,i,c,h){Rn(h),i=Ic(i,"onChange"),0<i.length&&(c=new Ha("onChange","change",null,c,h),r.push({event:c,listeners:i}))}var rl=null,sl=null;function xx(r){Nm(r,0)}function Tc(r){var i=io(r);if(Ve(i))return r}function Ex(r,i){if(r==="change")return i}var hm=!1;if(f){var Dd;if(f){var Ld="oninput"in document;if(!Ld){var fm=document.createElement("div");fm.setAttribute("oninput","return;"),Ld=typeof fm.oninput=="function"}Dd=Ld}else Dd=!1;hm=Dd&&(!document.documentMode||9<document.documentMode)}function pm(){rl&&(rl.detachEvent("onpropertychange",mm),sl=rl=null)}function mm(r){if(r.propertyName==="value"&&Tc(sl)){var i=[];dm(i,sl,r,yr(r)),Hs(xx,i)}}function Tx(r,i,c){r==="focusin"?(pm(),rl=i,sl=c,rl.attachEvent("onpropertychange",mm)):r==="focusout"&&pm()}function Sx(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Tc(sl)}function bx(r,i){if(r==="click")return Tc(i)}function Cx(r,i){if(r==="input"||r==="change")return Tc(i)}function Ix(r,i){return r===i&&(r!==0||1/r===1/i)||r!==r&&i!==i}var hs=typeof Object.is=="function"?Object.is:Ix;function il(r,i){if(hs(r,i))return!0;if(typeof r!="object"||r===null||typeof i!="object"||i===null)return!1;var c=Object.keys(r),h=Object.keys(i);if(c.length!==h.length)return!1;for(h=0;h<c.length;h++){var p=c[h];if(!m.call(i,p)||!hs(r[p],i[p]))return!1}return!0}function gm(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function ym(r,i){var c=gm(r);r=0;for(var h;c;){if(c.nodeType===3){if(h=r+c.textContent.length,r<=i&&h>=i)return{node:c,offset:i-r};r=h}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=gm(c)}}function vm(r,i){return r&&i?r===i?!0:r&&r.nodeType===3?!1:i&&i.nodeType===3?vm(r,i.parentNode):"contains"in r?r.contains(i):r.compareDocumentPosition?!!(r.compareDocumentPosition(i)&16):!1:!1}function _m(){for(var r=window,i=me();i instanceof r.HTMLIFrameElement;){try{var c=typeof i.contentWindow.location.href=="string"}catch{c=!1}if(c)r=i.contentWindow;else break;i=me(r.document)}return i}function Vd(r){var i=r&&r.nodeName&&r.nodeName.toLowerCase();return i&&(i==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||i==="textarea"||r.contentEditable==="true")}function Px(r){var i=_m(),c=r.focusedElem,h=r.selectionRange;if(i!==c&&c&&c.ownerDocument&&vm(c.ownerDocument.documentElement,c)){if(h!==null&&Vd(c)){if(i=h.start,r=h.end,r===void 0&&(r=i),"selectionStart"in c)c.selectionStart=i,c.selectionEnd=Math.min(r,c.value.length);else if(r=(i=c.ownerDocument||document)&&i.defaultView||window,r.getSelection){r=r.getSelection();var p=c.textContent.length,y=Math.min(h.start,p);h=h.end===void 0?y:Math.min(h.end,p),!r.extend&&y>h&&(p=h,h=y,y=p),p=ym(c,y);var E=ym(c,h);p&&E&&(r.rangeCount!==1||r.anchorNode!==p.node||r.anchorOffset!==p.offset||r.focusNode!==E.node||r.focusOffset!==E.offset)&&(i=i.createRange(),i.setStart(p.node,p.offset),r.removeAllRanges(),y>h?(r.addRange(i),r.extend(E.node,E.offset)):(i.setEnd(E.node,E.offset),r.addRange(i)))}}for(i=[],r=c;r=r.parentNode;)r.nodeType===1&&i.push({element:r,left:r.scrollLeft,top:r.scrollTop});for(typeof c.focus=="function"&&c.focus(),c=0;c<i.length;c++)r=i[c],r.element.scrollLeft=r.left,r.element.scrollTop=r.top}}var Nx=f&&"documentMode"in document&&11>=document.documentMode,to=null,Md=null,al=null,Od=!1;function wm(r,i,c){var h=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Od||to==null||to!==me(h)||(h=to,"selectionStart"in h&&Vd(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),al&&il(al,h)||(al=h,h=Ic(Md,"onSelect"),0<h.length&&(i=new Ha("onSelect","select",null,i,c),r.push({event:i,listeners:h}),i.target=to)))}function Sc(r,i){var c={};return c[r.toLowerCase()]=i.toLowerCase(),c["Webkit"+r]="webkit"+i,c["Moz"+r]="moz"+i,c}var no={animationend:Sc("Animation","AnimationEnd"),animationiteration:Sc("Animation","AnimationIteration"),animationstart:Sc("Animation","AnimationStart"),transitionend:Sc("Transition","TransitionEnd")},Fd={},xm={};f&&(xm=document.createElement("div").style,"AnimationEvent"in window||(delete no.animationend.animation,delete no.animationiteration.animation,delete no.animationstart.animation),"TransitionEvent"in window||delete no.transitionend.transition);function bc(r){if(Fd[r])return Fd[r];if(!no[r])return r;var i=no[r],c;for(c in i)if(i.hasOwnProperty(c)&&c in xm)return Fd[r]=i[c];return r}var Em=bc("animationend"),Tm=bc("animationiteration"),Sm=bc("animationstart"),bm=bc("transitionend"),Cm=new Map,Im="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Si(r,i){Cm.set(r,i),l(i,[r])}for(var Ud=0;Ud<Im.length;Ud++){var zd=Im[Ud],Rx=zd.toLowerCase(),Ax=zd[0].toUpperCase()+zd.slice(1);Si(Rx,"on"+Ax)}Si(Em,"onAnimationEnd"),Si(Tm,"onAnimationIteration"),Si(Sm,"onAnimationStart"),Si("dblclick","onDoubleClick"),Si("focusin","onFocus"),Si("focusout","onBlur"),Si(bm,"onTransitionEnd"),d("onMouseEnter",["mouseout","mouseover"]),d("onMouseLeave",["mouseout","mouseover"]),d("onPointerEnter",["pointerout","pointerover"]),d("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ol="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),jx=new Set("cancel close invalid load scroll toggle".split(" ").concat(ol));function Pm(r,i,c){var h=r.type||"unknown-event";r.currentTarget=c,$r(h,i,void 0,r),r.currentTarget=null}function Nm(r,i){i=(i&4)!==0;for(var c=0;c<r.length;c++){var h=r[c],p=h.event;h=h.listeners;e:{var y=void 0;if(i)for(var E=h.length-1;0<=E;E--){var L=h[E],G=L.instance,se=L.currentTarget;if(L=L.listener,G!==y&&p.isPropagationStopped())break e;Pm(p,L,se),y=G}else for(E=0;E<h.length;E++){if(L=h[E],G=L.instance,se=L.currentTarget,L=L.listener,G!==y&&p.isPropagationStopped())break e;Pm(p,L,se),y=G}}}if(kn)throw r=Cs,kn=!1,Cs=null,r}function Ut(r,i){var c=i[Qd];c===void 0&&(c=i[Qd]=new Set);var h=r+"__bubble";c.has(h)||(Rm(i,r,2,!1),c.add(h))}function Bd(r,i,c){var h=0;i&&(h|=4),Rm(c,r,h,i)}var Cc="_reactListening"+Math.random().toString(36).slice(2);function ll(r){if(!r[Cc]){r[Cc]=!0,s.forEach(function(c){c!=="selectionchange"&&(jx.has(c)||Bd(c,!1,r),Bd(c,!0,r))});var i=r.nodeType===9?r:r.ownerDocument;i===null||i[Cc]||(i[Cc]=!0,Bd("selectionchange",!1,i))}}function Rm(r,i,c,h){switch(Xo(i)){case 1:var p=Wt;break;case 4:p=jd;break;default:p=Jo}c=p.bind(null,i,c,r),p=void 0,!er||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(p=!0),h?p!==void 0?r.addEventListener(i,c,{capture:!0,passive:p}):r.addEventListener(i,c,!0):p!==void 0?r.addEventListener(i,c,{passive:p}):r.addEventListener(i,c,!1)}function $d(r,i,c,h,p){var y=h;if((i&1)===0&&(i&2)===0&&h!==null)e:for(;;){if(h===null)return;var E=h.tag;if(E===3||E===4){var L=h.stateNode.containerInfo;if(L===p||L.nodeType===8&&L.parentNode===p)break;if(E===4)for(E=h.return;E!==null;){var G=E.tag;if((G===3||G===4)&&(G=E.stateNode.containerInfo,G===p||G.nodeType===8&&G.parentNode===p))return;E=E.return}for(;L!==null;){if(E=pa(L),E===null)return;if(G=E.tag,G===5||G===6){h=y=E;continue e}L=L.parentNode}}h=h.return}Hs(function(){var se=y,be=yr(c),Pe=[];e:{var xe=Cm.get(r);if(xe!==void 0){var Ue=Ha,We=r;switch(r){case"keypress":if(qa(c)===0)break e;case"keydown":case"keyup":Ue=g;break;case"focusin":We="focus",Ue=Ja;break;case"focusout":We="blur",Ue=Ja;break;case"beforeblur":case"afterblur":Ue=Ja;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ue=Qa;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ue=gc;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ue=oe;break;case Em:case Tm:case Sm:Ue=Zs;break;case bm:Ue=jt;break;case"scroll":Ue=kd;break;case"wheel":Ue=xt;break;case"copy":case"cut":case"paste":Ue=_c;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ue=R}var qe=(i&4)!==0,ln=!qe&&r==="scroll",ee=qe?xe!==null?xe+"Capture":null:xe;qe=[];for(var K=se,te;K!==null;){te=K;var je=te.stateNode;if(te.tag===5&&je!==null&&(te=je,ee!==null&&(je=Ze(K,ee),je!=null&&qe.push(cl(K,je,te)))),ln)break;K=K.return}0<qe.length&&(xe=new Ue(xe,We,null,c,be),Pe.push({event:xe,listeners:qe}))}}if((i&7)===0){e:{if(xe=r==="mouseover"||r==="pointerover",Ue=r==="mouseout"||r==="pointerout",xe&&c!==Pt&&(We=c.relatedTarget||c.fromElement)&&(pa(We)||We[ei]))break e;if((Ue||xe)&&(xe=be.window===be?be:(xe=be.ownerDocument)?xe.defaultView||xe.parentWindow:window,Ue?(We=c.relatedTarget||c.toElement,Ue=se,We=We?pa(We):null,We!==null&&(ln=Ft(We),We!==ln||We.tag!==5&&We.tag!==6)&&(We=null)):(Ue=null,We=se),Ue!==We)){if(qe=Qa,je="onMouseLeave",ee="onMouseEnter",K="mouse",(r==="pointerout"||r==="pointerover")&&(qe=R,je="onPointerLeave",ee="onPointerEnter",K="pointer"),ln=Ue==null?xe:io(Ue),te=We==null?xe:io(We),xe=new qe(je,K+"leave",Ue,c,be),xe.target=ln,xe.relatedTarget=te,je=null,pa(be)===se&&(qe=new qe(ee,K+"enter",We,c,be),qe.target=te,qe.relatedTarget=ln,je=qe),ln=je,Ue&&We)t:{for(qe=Ue,ee=We,K=0,te=qe;te;te=ro(te))K++;for(te=0,je=ee;je;je=ro(je))te++;for(;0<K-te;)qe=ro(qe),K--;for(;0<te-K;)ee=ro(ee),te--;for(;K--;){if(qe===ee||ee!==null&&qe===ee.alternate)break t;qe=ro(qe),ee=ro(ee)}qe=null}else qe=null;Ue!==null&&Am(Pe,xe,Ue,qe,!1),We!==null&&ln!==null&&Am(Pe,ln,We,qe,!0)}}e:{if(xe=se?io(se):window,Ue=xe.nodeName&&xe.nodeName.toLowerCase(),Ue==="select"||Ue==="input"&&xe.type==="file")var Ke=Ex;else if(um(xe))if(hm)Ke=Cx;else{Ke=Sx;var et=Tx}else(Ue=xe.nodeName)&&Ue.toLowerCase()==="input"&&(xe.type==="checkbox"||xe.type==="radio")&&(Ke=bx);if(Ke&&(Ke=Ke(r,se))){dm(Pe,Ke,c,be);break e}et&&et(r,xe,se),r==="focusout"&&(et=xe._wrapperState)&&et.controlled&&xe.type==="number"&&Nt(xe,"number",xe.value)}switch(et=se?io(se):window,r){case"focusin":(um(et)||et.contentEditable==="true")&&(to=et,Md=se,al=null);break;case"focusout":al=Md=to=null;break;case"mousedown":Od=!0;break;case"contextmenu":case"mouseup":case"dragend":Od=!1,wm(Pe,c,be);break;case"selectionchange":if(Nx)break;case"keydown":case"keyup":wm(Pe,c,be)}var tt;if(mn)e:{switch(r){case"compositionstart":var at="onCompositionStart";break e;case"compositionend":at="onCompositionEnd";break e;case"compositionupdate":at="onCompositionUpdate";break e}at=void 0}else eo?lm(r,c)&&(at="onCompositionEnd"):r==="keydown"&&c.keyCode===229&&(at="onCompositionStart");at&&(fa&&c.locale!=="ko"&&(eo||at!=="onCompositionStart"?at==="onCompositionEnd"&&eo&&(tt=Zo()):(Vr=be,Ga="value"in Vr?Vr.value:Vr.textContent,eo=!0)),et=Ic(se,at),0<et.length&&(at=new nl(at,r,null,c,be),Pe.push({event:at,listeners:et}),tt?at.data=tt:(tt=cm(c),tt!==null&&(at.data=tt)))),(tt=Mr?vx(r,c):_x(r,c))&&(se=Ic(se,"onBeforeInput"),0<se.length&&(be=new nl("onBeforeInput","beforeinput",null,c,be),Pe.push({event:be,listeners:se}),be.data=tt))}Nm(Pe,i)})}function cl(r,i,c){return{instance:r,listener:i,currentTarget:c}}function Ic(r,i){for(var c=i+"Capture",h=[];r!==null;){var p=r,y=p.stateNode;p.tag===5&&y!==null&&(p=y,y=Ze(r,c),y!=null&&h.unshift(cl(r,y,p)),y=Ze(r,i),y!=null&&h.push(cl(r,y,p))),r=r.return}return h}function ro(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5);return r||null}function Am(r,i,c,h,p){for(var y=i._reactName,E=[];c!==null&&c!==h;){var L=c,G=L.alternate,se=L.stateNode;if(G!==null&&G===h)break;L.tag===5&&se!==null&&(L=se,p?(G=Ze(c,y),G!=null&&E.unshift(cl(c,G,L))):p||(G=Ze(c,y),G!=null&&E.push(cl(c,G,L)))),c=c.return}E.length!==0&&r.push({event:i,listeners:E})}var kx=/\r\n?/g,Dx=/\u0000|\uFFFD/g;function jm(r){return(typeof r=="string"?r:""+r).replace(kx,`
`).replace(Dx,"")}function Pc(r,i,c){if(i=jm(i),jm(r)!==i&&c)throw Error(t(425))}function Nc(){}var Wd=null,Gd=null;function qd(r,i){return r==="textarea"||r==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Hd=typeof setTimeout=="function"?setTimeout:void 0,Lx=typeof clearTimeout=="function"?clearTimeout:void 0,km=typeof Promise=="function"?Promise:void 0,Vx=typeof queueMicrotask=="function"?queueMicrotask:typeof km<"u"?function(r){return km.resolve(null).then(r).catch(Mx)}:Hd;function Mx(r){setTimeout(function(){throw r})}function Kd(r,i){var c=i,h=0;do{var p=c.nextSibling;if(r.removeChild(c),p&&p.nodeType===8)if(c=p.data,c==="/$"){if(h===0){r.removeChild(p),$n(i);return}h--}else c!=="$"&&c!=="$?"&&c!=="$!"||h++;c=p}while(c);$n(i)}function bi(r){for(;r!=null;r=r.nextSibling){var i=r.nodeType;if(i===1||i===3)break;if(i===8){if(i=r.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return r}function Dm(r){r=r.previousSibling;for(var i=0;r;){if(r.nodeType===8){var c=r.data;if(c==="$"||c==="$!"||c==="$?"){if(i===0)return r;i--}else c==="/$"&&i++}r=r.previousSibling}return null}var so=Math.random().toString(36).slice(2),Ds="__reactFiber$"+so,ul="__reactProps$"+so,ei="__reactContainer$"+so,Qd="__reactEvents$"+so,Ox="__reactListeners$"+so,Fx="__reactHandles$"+so;function pa(r){var i=r[Ds];if(i)return i;for(var c=r.parentNode;c;){if(i=c[ei]||c[Ds]){if(c=i.alternate,i.child!==null||c!==null&&c.child!==null)for(r=Dm(r);r!==null;){if(c=r[Ds])return c;r=Dm(r)}return i}r=c,c=r.parentNode}return null}function dl(r){return r=r[Ds]||r[ei],!r||r.tag!==5&&r.tag!==6&&r.tag!==13&&r.tag!==3?null:r}function io(r){if(r.tag===5||r.tag===6)return r.stateNode;throw Error(t(33))}function Rc(r){return r[ul]||null}var Yd=[],ao=-1;function Ci(r){return{current:r}}function zt(r){0>ao||(r.current=Yd[ao],Yd[ao]=null,ao--)}function Vt(r,i){ao++,Yd[ao]=r.current,r.current=i}var Ii={},nr=Ci(Ii),wr=Ci(!1),ma=Ii;function oo(r,i){var c=r.type.contextTypes;if(!c)return Ii;var h=r.stateNode;if(h&&h.__reactInternalMemoizedUnmaskedChildContext===i)return h.__reactInternalMemoizedMaskedChildContext;var p={},y;for(y in c)p[y]=i[y];return h&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=i,r.__reactInternalMemoizedMaskedChildContext=p),p}function xr(r){return r=r.childContextTypes,r!=null}function Ac(){zt(wr),zt(nr)}function Lm(r,i,c){if(nr.current!==Ii)throw Error(t(168));Vt(nr,i),Vt(wr,c)}function Vm(r,i,c){var h=r.stateNode;if(i=i.childContextTypes,typeof h.getChildContext!="function")return c;h=h.getChildContext();for(var p in h)if(!(p in i))throw Error(t(108,Oe(r)||"Unknown",p));return _e({},c,h)}function jc(r){return r=(r=r.stateNode)&&r.__reactInternalMemoizedMergedChildContext||Ii,ma=nr.current,Vt(nr,r),Vt(wr,wr.current),!0}function Mm(r,i,c){var h=r.stateNode;if(!h)throw Error(t(169));c?(r=Vm(r,i,ma),h.__reactInternalMemoizedMergedChildContext=r,zt(wr),zt(nr),Vt(nr,r)):zt(wr),Vt(wr,c)}var ti=null,kc=!1,Jd=!1;function Om(r){ti===null?ti=[r]:ti.push(r)}function Ux(r){kc=!0,Om(r)}function Pi(){if(!Jd&&ti!==null){Jd=!0;var r=0,i=pt;try{var c=ti;for(pt=1;r<c.length;r++){var h=c[r];do h=h(!0);while(h!==null)}ti=null,kc=!1}catch(p){throw ti!==null&&(ti=ti.slice(r+1)),ls(fn,Pi),p}finally{pt=i,Jd=!1}}return null}var lo=[],co=0,Dc=null,Lc=0,Hr=[],Kr=0,ga=null,ni=1,ri="";function ya(r,i){lo[co++]=Lc,lo[co++]=Dc,Dc=r,Lc=i}function Fm(r,i,c){Hr[Kr++]=ni,Hr[Kr++]=ri,Hr[Kr++]=ga,ga=r;var h=ni;r=ri;var p=32-ne(h)-1;h&=~(1<<p),c+=1;var y=32-ne(i)+p;if(30<y){var E=p-p%5;y=(h&(1<<E)-1).toString(32),h>>=E,p-=E,ni=1<<32-ne(i)+p|c<<p|h,ri=y+r}else ni=1<<y|c<<p|h,ri=r}function Xd(r){r.return!==null&&(ya(r,1),Fm(r,1,0))}function Zd(r){for(;r===Dc;)Dc=lo[--co],lo[co]=null,Lc=lo[--co],lo[co]=null;for(;r===ga;)ga=Hr[--Kr],Hr[Kr]=null,ri=Hr[--Kr],Hr[Kr]=null,ni=Hr[--Kr],Hr[Kr]=null}var Or=null,Fr=null,Gt=!1,fs=null;function Um(r,i){var c=Xr(5,null,null,0);c.elementType="DELETED",c.stateNode=i,c.return=r,i=r.deletions,i===null?(r.deletions=[c],r.flags|=16):i.push(c)}function zm(r,i){switch(r.tag){case 5:var c=r.type;return i=i.nodeType!==1||c.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(r.stateNode=i,Or=r,Fr=bi(i.firstChild),!0):!1;case 6:return i=r.pendingProps===""||i.nodeType!==3?null:i,i!==null?(r.stateNode=i,Or=r,Fr=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(c=ga!==null?{id:ni,overflow:ri}:null,r.memoizedState={dehydrated:i,treeContext:c,retryLane:1073741824},c=Xr(18,null,null,0),c.stateNode=i,c.return=r,r.child=c,Or=r,Fr=null,!0):!1;default:return!1}}function eh(r){return(r.mode&1)!==0&&(r.flags&128)===0}function th(r){if(Gt){var i=Fr;if(i){var c=i;if(!zm(r,i)){if(eh(r))throw Error(t(418));i=bi(c.nextSibling);var h=Or;i&&zm(r,i)?Um(h,c):(r.flags=r.flags&-4097|2,Gt=!1,Or=r)}}else{if(eh(r))throw Error(t(418));r.flags=r.flags&-4097|2,Gt=!1,Or=r}}}function Bm(r){for(r=r.return;r!==null&&r.tag!==5&&r.tag!==3&&r.tag!==13;)r=r.return;Or=r}function Vc(r){if(r!==Or)return!1;if(!Gt)return Bm(r),Gt=!0,!1;var i;if((i=r.tag!==3)&&!(i=r.tag!==5)&&(i=r.type,i=i!=="head"&&i!=="body"&&!qd(r.type,r.memoizedProps)),i&&(i=Fr)){if(eh(r))throw $m(),Error(t(418));for(;i;)Um(r,i),i=bi(i.nextSibling)}if(Bm(r),r.tag===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(t(317));e:{for(r=r.nextSibling,i=0;r;){if(r.nodeType===8){var c=r.data;if(c==="/$"){if(i===0){Fr=bi(r.nextSibling);break e}i--}else c!=="$"&&c!=="$!"&&c!=="$?"||i++}r=r.nextSibling}Fr=null}}else Fr=Or?bi(r.stateNode.nextSibling):null;return!0}function $m(){for(var r=Fr;r;)r=bi(r.nextSibling)}function uo(){Fr=Or=null,Gt=!1}function nh(r){fs===null?fs=[r]:fs.push(r)}var zx=we.ReactCurrentBatchConfig;function hl(r,i,c){if(r=c.ref,r!==null&&typeof r!="function"&&typeof r!="object"){if(c._owner){if(c=c._owner,c){if(c.tag!==1)throw Error(t(309));var h=c.stateNode}if(!h)throw Error(t(147,r));var p=h,y=""+r;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===y?i.ref:(i=function(E){var L=p.refs;E===null?delete L[y]:L[y]=E},i._stringRef=y,i)}if(typeof r!="string")throw Error(t(284));if(!c._owner)throw Error(t(290,r))}return r}function Mc(r,i){throw r=Object.prototype.toString.call(i),Error(t(31,r==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":r))}function Wm(r){var i=r._init;return i(r._payload)}function Gm(r){function i(ee,K){if(r){var te=ee.deletions;te===null?(ee.deletions=[K],ee.flags|=16):te.push(K)}}function c(ee,K){if(!r)return null;for(;K!==null;)i(ee,K),K=K.sibling;return null}function h(ee,K){for(ee=new Map;K!==null;)K.key!==null?ee.set(K.key,K):ee.set(K.index,K),K=K.sibling;return ee}function p(ee,K){return ee=Vi(ee,K),ee.index=0,ee.sibling=null,ee}function y(ee,K,te){return ee.index=te,r?(te=ee.alternate,te!==null?(te=te.index,te<K?(ee.flags|=2,K):te):(ee.flags|=2,K)):(ee.flags|=1048576,K)}function E(ee){return r&&ee.alternate===null&&(ee.flags|=2),ee}function L(ee,K,te,je){return K===null||K.tag!==6?(K=Hh(te,ee.mode,je),K.return=ee,K):(K=p(K,te),K.return=ee,K)}function G(ee,K,te,je){var Ke=te.type;return Ke===I?be(ee,K,te.props.children,je,te.key):K!==null&&(K.elementType===Ke||typeof Ke=="object"&&Ke!==null&&Ke.$$typeof===Ce&&Wm(Ke)===K.type)?(je=p(K,te.props),je.ref=hl(ee,K,te),je.return=ee,je):(je=ou(te.type,te.key,te.props,null,ee.mode,je),je.ref=hl(ee,K,te),je.return=ee,je)}function se(ee,K,te,je){return K===null||K.tag!==4||K.stateNode.containerInfo!==te.containerInfo||K.stateNode.implementation!==te.implementation?(K=Kh(te,ee.mode,je),K.return=ee,K):(K=p(K,te.children||[]),K.return=ee,K)}function be(ee,K,te,je,Ke){return K===null||K.tag!==7?(K=ba(te,ee.mode,je,Ke),K.return=ee,K):(K=p(K,te),K.return=ee,K)}function Pe(ee,K,te){if(typeof K=="string"&&K!==""||typeof K=="number")return K=Hh(""+K,ee.mode,te),K.return=ee,K;if(typeof K=="object"&&K!==null){switch(K.$$typeof){case V:return te=ou(K.type,K.key,K.props,null,ee.mode,te),te.ref=hl(ee,null,K),te.return=ee,te;case ae:return K=Kh(K,ee.mode,te),K.return=ee,K;case Ce:var je=K._init;return Pe(ee,je(K._payload),te)}if(Yt(K)||Ne(K))return K=ba(K,ee.mode,te,null),K.return=ee,K;Mc(ee,K)}return null}function xe(ee,K,te,je){var Ke=K!==null?K.key:null;if(typeof te=="string"&&te!==""||typeof te=="number")return Ke!==null?null:L(ee,K,""+te,je);if(typeof te=="object"&&te!==null){switch(te.$$typeof){case V:return te.key===Ke?G(ee,K,te,je):null;case ae:return te.key===Ke?se(ee,K,te,je):null;case Ce:return Ke=te._init,xe(ee,K,Ke(te._payload),je)}if(Yt(te)||Ne(te))return Ke!==null?null:be(ee,K,te,je,null);Mc(ee,te)}return null}function Ue(ee,K,te,je,Ke){if(typeof je=="string"&&je!==""||typeof je=="number")return ee=ee.get(te)||null,L(K,ee,""+je,Ke);if(typeof je=="object"&&je!==null){switch(je.$$typeof){case V:return ee=ee.get(je.key===null?te:je.key)||null,G(K,ee,je,Ke);case ae:return ee=ee.get(je.key===null?te:je.key)||null,se(K,ee,je,Ke);case Ce:var et=je._init;return Ue(ee,K,te,et(je._payload),Ke)}if(Yt(je)||Ne(je))return ee=ee.get(te)||null,be(K,ee,je,Ke,null);Mc(K,je)}return null}function We(ee,K,te,je){for(var Ke=null,et=null,tt=K,at=K=0,On=null;tt!==null&&at<te.length;at++){tt.index>at?(On=tt,tt=null):On=tt.sibling;var It=xe(ee,tt,te[at],je);if(It===null){tt===null&&(tt=On);break}r&&tt&&It.alternate===null&&i(ee,tt),K=y(It,K,at),et===null?Ke=It:et.sibling=It,et=It,tt=On}if(at===te.length)return c(ee,tt),Gt&&ya(ee,at),Ke;if(tt===null){for(;at<te.length;at++)tt=Pe(ee,te[at],je),tt!==null&&(K=y(tt,K,at),et===null?Ke=tt:et.sibling=tt,et=tt);return Gt&&ya(ee,at),Ke}for(tt=h(ee,tt);at<te.length;at++)On=Ue(tt,ee,at,te[at],je),On!==null&&(r&&On.alternate!==null&&tt.delete(On.key===null?at:On.key),K=y(On,K,at),et===null?Ke=On:et.sibling=On,et=On);return r&&tt.forEach(function(Mi){return i(ee,Mi)}),Gt&&ya(ee,at),Ke}function qe(ee,K,te,je){var Ke=Ne(te);if(typeof Ke!="function")throw Error(t(150));if(te=Ke.call(te),te==null)throw Error(t(151));for(var et=Ke=null,tt=K,at=K=0,On=null,It=te.next();tt!==null&&!It.done;at++,It=te.next()){tt.index>at?(On=tt,tt=null):On=tt.sibling;var Mi=xe(ee,tt,It.value,je);if(Mi===null){tt===null&&(tt=On);break}r&&tt&&Mi.alternate===null&&i(ee,tt),K=y(Mi,K,at),et===null?Ke=Mi:et.sibling=Mi,et=Mi,tt=On}if(It.done)return c(ee,tt),Gt&&ya(ee,at),Ke;if(tt===null){for(;!It.done;at++,It=te.next())It=Pe(ee,It.value,je),It!==null&&(K=y(It,K,at),et===null?Ke=It:et.sibling=It,et=It);return Gt&&ya(ee,at),Ke}for(tt=h(ee,tt);!It.done;at++,It=te.next())It=Ue(tt,ee,at,It.value,je),It!==null&&(r&&It.alternate!==null&&tt.delete(It.key===null?at:It.key),K=y(It,K,at),et===null?Ke=It:et.sibling=It,et=It);return r&&tt.forEach(function(wE){return i(ee,wE)}),Gt&&ya(ee,at),Ke}function ln(ee,K,te,je){if(typeof te=="object"&&te!==null&&te.type===I&&te.key===null&&(te=te.props.children),typeof te=="object"&&te!==null){switch(te.$$typeof){case V:e:{for(var Ke=te.key,et=K;et!==null;){if(et.key===Ke){if(Ke=te.type,Ke===I){if(et.tag===7){c(ee,et.sibling),K=p(et,te.props.children),K.return=ee,ee=K;break e}}else if(et.elementType===Ke||typeof Ke=="object"&&Ke!==null&&Ke.$$typeof===Ce&&Wm(Ke)===et.type){c(ee,et.sibling),K=p(et,te.props),K.ref=hl(ee,et,te),K.return=ee,ee=K;break e}c(ee,et);break}else i(ee,et);et=et.sibling}te.type===I?(K=ba(te.props.children,ee.mode,je,te.key),K.return=ee,ee=K):(je=ou(te.type,te.key,te.props,null,ee.mode,je),je.ref=hl(ee,K,te),je.return=ee,ee=je)}return E(ee);case ae:e:{for(et=te.key;K!==null;){if(K.key===et)if(K.tag===4&&K.stateNode.containerInfo===te.containerInfo&&K.stateNode.implementation===te.implementation){c(ee,K.sibling),K=p(K,te.children||[]),K.return=ee,ee=K;break e}else{c(ee,K);break}else i(ee,K);K=K.sibling}K=Kh(te,ee.mode,je),K.return=ee,ee=K}return E(ee);case Ce:return et=te._init,ln(ee,K,et(te._payload),je)}if(Yt(te))return We(ee,K,te,je);if(Ne(te))return qe(ee,K,te,je);Mc(ee,te)}return typeof te=="string"&&te!==""||typeof te=="number"?(te=""+te,K!==null&&K.tag===6?(c(ee,K.sibling),K=p(K,te),K.return=ee,ee=K):(c(ee,K),K=Hh(te,ee.mode,je),K.return=ee,ee=K),E(ee)):c(ee,K)}return ln}var ho=Gm(!0),qm=Gm(!1),Oc=Ci(null),Fc=null,fo=null,rh=null;function sh(){rh=fo=Fc=null}function ih(r){var i=Oc.current;zt(Oc),r._currentValue=i}function ah(r,i,c){for(;r!==null;){var h=r.alternate;if((r.childLanes&i)!==i?(r.childLanes|=i,h!==null&&(h.childLanes|=i)):h!==null&&(h.childLanes&i)!==i&&(h.childLanes|=i),r===c)break;r=r.return}}function po(r,i){Fc=r,rh=fo=null,r=r.dependencies,r!==null&&r.firstContext!==null&&((r.lanes&i)!==0&&(Er=!0),r.firstContext=null)}function Qr(r){var i=r._currentValue;if(rh!==r)if(r={context:r,memoizedValue:i,next:null},fo===null){if(Fc===null)throw Error(t(308));fo=r,Fc.dependencies={lanes:0,firstContext:r}}else fo=fo.next=r;return i}var va=null;function oh(r){va===null?va=[r]:va.push(r)}function Hm(r,i,c,h){var p=i.interleaved;return p===null?(c.next=c,oh(i)):(c.next=p.next,p.next=c),i.interleaved=c,si(r,h)}function si(r,i){r.lanes|=i;var c=r.alternate;for(c!==null&&(c.lanes|=i),c=r,r=r.return;r!==null;)r.childLanes|=i,c=r.alternate,c!==null&&(c.childLanes|=i),c=r,r=r.return;return c.tag===3?c.stateNode:null}var Ni=!1;function lh(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Km(r,i){r=r.updateQueue,i.updateQueue===r&&(i.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,effects:r.effects})}function ii(r,i){return{eventTime:r,lane:i,tag:0,payload:null,callback:null,next:null}}function Ri(r,i,c){var h=r.updateQueue;if(h===null)return null;if(h=h.shared,(bt&2)!==0){var p=h.pending;return p===null?i.next=i:(i.next=p.next,p.next=i),h.pending=i,si(r,c)}return p=h.interleaved,p===null?(i.next=i,oh(h)):(i.next=p.next,p.next=i),h.interleaved=i,si(r,c)}function Uc(r,i,c){if(i=i.updateQueue,i!==null&&(i=i.shared,(c&4194240)!==0)){var h=i.lanes;h&=r.pendingLanes,c|=h,i.lanes=c,Ns(r,c)}}function Qm(r,i){var c=r.updateQueue,h=r.alternate;if(h!==null&&(h=h.updateQueue,c===h)){var p=null,y=null;if(c=c.firstBaseUpdate,c!==null){do{var E={eventTime:c.eventTime,lane:c.lane,tag:c.tag,payload:c.payload,callback:c.callback,next:null};y===null?p=y=E:y=y.next=E,c=c.next}while(c!==null);y===null?p=y=i:y=y.next=i}else p=y=i;c={baseState:h.baseState,firstBaseUpdate:p,lastBaseUpdate:y,shared:h.shared,effects:h.effects},r.updateQueue=c;return}r=c.lastBaseUpdate,r===null?c.firstBaseUpdate=i:r.next=i,c.lastBaseUpdate=i}function zc(r,i,c,h){var p=r.updateQueue;Ni=!1;var y=p.firstBaseUpdate,E=p.lastBaseUpdate,L=p.shared.pending;if(L!==null){p.shared.pending=null;var G=L,se=G.next;G.next=null,E===null?y=se:E.next=se,E=G;var be=r.alternate;be!==null&&(be=be.updateQueue,L=be.lastBaseUpdate,L!==E&&(L===null?be.firstBaseUpdate=se:L.next=se,be.lastBaseUpdate=G))}if(y!==null){var Pe=p.baseState;E=0,be=se=G=null,L=y;do{var xe=L.lane,Ue=L.eventTime;if((h&xe)===xe){be!==null&&(be=be.next={eventTime:Ue,lane:0,tag:L.tag,payload:L.payload,callback:L.callback,next:null});e:{var We=r,qe=L;switch(xe=i,Ue=c,qe.tag){case 1:if(We=qe.payload,typeof We=="function"){Pe=We.call(Ue,Pe,xe);break e}Pe=We;break e;case 3:We.flags=We.flags&-65537|128;case 0:if(We=qe.payload,xe=typeof We=="function"?We.call(Ue,Pe,xe):We,xe==null)break e;Pe=_e({},Pe,xe);break e;case 2:Ni=!0}}L.callback!==null&&L.lane!==0&&(r.flags|=64,xe=p.effects,xe===null?p.effects=[L]:xe.push(L))}else Ue={eventTime:Ue,lane:xe,tag:L.tag,payload:L.payload,callback:L.callback,next:null},be===null?(se=be=Ue,G=Pe):be=be.next=Ue,E|=xe;if(L=L.next,L===null){if(L=p.shared.pending,L===null)break;xe=L,L=xe.next,xe.next=null,p.lastBaseUpdate=xe,p.shared.pending=null}}while(!0);if(be===null&&(G=Pe),p.baseState=G,p.firstBaseUpdate=se,p.lastBaseUpdate=be,i=p.shared.interleaved,i!==null){p=i;do E|=p.lane,p=p.next;while(p!==i)}else y===null&&(p.shared.lanes=0);xa|=E,r.lanes=E,r.memoizedState=Pe}}function Ym(r,i,c){if(r=i.effects,i.effects=null,r!==null)for(i=0;i<r.length;i++){var h=r[i],p=h.callback;if(p!==null){if(h.callback=null,h=c,typeof p!="function")throw Error(t(191,p));p.call(h)}}}var fl={},Ls=Ci(fl),pl=Ci(fl),ml=Ci(fl);function _a(r){if(r===fl)throw Error(t(174));return r}function ch(r,i){switch(Vt(ml,i),Vt(pl,r),Vt(Ls,fl),r=i.nodeType,r){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:$t(null,"");break;default:r=r===8?i.parentNode:i,i=r.namespaceURI||null,r=r.tagName,i=$t(i,r)}zt(Ls),Vt(Ls,i)}function mo(){zt(Ls),zt(pl),zt(ml)}function Jm(r){_a(ml.current);var i=_a(Ls.current),c=$t(i,r.type);i!==c&&(Vt(pl,r),Vt(Ls,c))}function uh(r){pl.current===r&&(zt(Ls),zt(pl))}var Ht=Ci(0);function Bc(r){for(var i=r;i!==null;){if(i.tag===13){var c=i.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||c.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===r)break;for(;i.sibling===null;){if(i.return===null||i.return===r)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var dh=[];function hh(){for(var r=0;r<dh.length;r++)dh[r]._workInProgressVersionPrimary=null;dh.length=0}var $c=we.ReactCurrentDispatcher,fh=we.ReactCurrentBatchConfig,wa=0,Kt=null,Sn=null,Vn=null,Wc=!1,gl=!1,yl=0,Bx=0;function rr(){throw Error(t(321))}function ph(r,i){if(i===null)return!1;for(var c=0;c<i.length&&c<r.length;c++)if(!hs(r[c],i[c]))return!1;return!0}function mh(r,i,c,h,p,y){if(wa=y,Kt=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,$c.current=r===null||r.memoizedState===null?qx:Hx,r=c(h,p),gl){y=0;do{if(gl=!1,yl=0,25<=y)throw Error(t(301));y+=1,Vn=Sn=null,i.updateQueue=null,$c.current=Kx,r=c(h,p)}while(gl)}if($c.current=Hc,i=Sn!==null&&Sn.next!==null,wa=0,Vn=Sn=Kt=null,Wc=!1,i)throw Error(t(300));return r}function gh(){var r=yl!==0;return yl=0,r}function Vs(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Vn===null?Kt.memoizedState=Vn=r:Vn=Vn.next=r,Vn}function Yr(){if(Sn===null){var r=Kt.alternate;r=r!==null?r.memoizedState:null}else r=Sn.next;var i=Vn===null?Kt.memoizedState:Vn.next;if(i!==null)Vn=i,Sn=r;else{if(r===null)throw Error(t(310));Sn=r,r={memoizedState:Sn.memoizedState,baseState:Sn.baseState,baseQueue:Sn.baseQueue,queue:Sn.queue,next:null},Vn===null?Kt.memoizedState=Vn=r:Vn=Vn.next=r}return Vn}function vl(r,i){return typeof i=="function"?i(r):i}function yh(r){var i=Yr(),c=i.queue;if(c===null)throw Error(t(311));c.lastRenderedReducer=r;var h=Sn,p=h.baseQueue,y=c.pending;if(y!==null){if(p!==null){var E=p.next;p.next=y.next,y.next=E}h.baseQueue=p=y,c.pending=null}if(p!==null){y=p.next,h=h.baseState;var L=E=null,G=null,se=y;do{var be=se.lane;if((wa&be)===be)G!==null&&(G=G.next={lane:0,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null}),h=se.hasEagerState?se.eagerState:r(h,se.action);else{var Pe={lane:be,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null};G===null?(L=G=Pe,E=h):G=G.next=Pe,Kt.lanes|=be,xa|=be}se=se.next}while(se!==null&&se!==y);G===null?E=h:G.next=L,hs(h,i.memoizedState)||(Er=!0),i.memoizedState=h,i.baseState=E,i.baseQueue=G,c.lastRenderedState=h}if(r=c.interleaved,r!==null){p=r;do y=p.lane,Kt.lanes|=y,xa|=y,p=p.next;while(p!==r)}else p===null&&(c.lanes=0);return[i.memoizedState,c.dispatch]}function vh(r){var i=Yr(),c=i.queue;if(c===null)throw Error(t(311));c.lastRenderedReducer=r;var h=c.dispatch,p=c.pending,y=i.memoizedState;if(p!==null){c.pending=null;var E=p=p.next;do y=r(y,E.action),E=E.next;while(E!==p);hs(y,i.memoizedState)||(Er=!0),i.memoizedState=y,i.baseQueue===null&&(i.baseState=y),c.lastRenderedState=y}return[y,h]}function Xm(){}function Zm(r,i){var c=Kt,h=Yr(),p=i(),y=!hs(h.memoizedState,p);if(y&&(h.memoizedState=p,Er=!0),h=h.queue,_h(ng.bind(null,c,h,r),[r]),h.getSnapshot!==i||y||Vn!==null&&Vn.memoizedState.tag&1){if(c.flags|=2048,_l(9,tg.bind(null,c,h,p,i),void 0,null),Mn===null)throw Error(t(349));(wa&30)!==0||eg(c,i,p)}return p}function eg(r,i,c){r.flags|=16384,r={getSnapshot:i,value:c},i=Kt.updateQueue,i===null?(i={lastEffect:null,stores:null},Kt.updateQueue=i,i.stores=[r]):(c=i.stores,c===null?i.stores=[r]:c.push(r))}function tg(r,i,c,h){i.value=c,i.getSnapshot=h,rg(i)&&sg(r)}function ng(r,i,c){return c(function(){rg(i)&&sg(r)})}function rg(r){var i=r.getSnapshot;r=r.value;try{var c=i();return!hs(r,c)}catch{return!0}}function sg(r){var i=si(r,1);i!==null&&ys(i,r,1,-1)}function ig(r){var i=Vs();return typeof r=="function"&&(r=r()),i.memoizedState=i.baseState=r,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:vl,lastRenderedState:r},i.queue=r,r=r.dispatch=Gx.bind(null,Kt,r),[i.memoizedState,r]}function _l(r,i,c,h){return r={tag:r,create:i,destroy:c,deps:h,next:null},i=Kt.updateQueue,i===null?(i={lastEffect:null,stores:null},Kt.updateQueue=i,i.lastEffect=r.next=r):(c=i.lastEffect,c===null?i.lastEffect=r.next=r:(h=c.next,c.next=r,r.next=h,i.lastEffect=r)),r}function ag(){return Yr().memoizedState}function Gc(r,i,c,h){var p=Vs();Kt.flags|=r,p.memoizedState=_l(1|i,c,void 0,h===void 0?null:h)}function qc(r,i,c,h){var p=Yr();h=h===void 0?null:h;var y=void 0;if(Sn!==null){var E=Sn.memoizedState;if(y=E.destroy,h!==null&&ph(h,E.deps)){p.memoizedState=_l(i,c,y,h);return}}Kt.flags|=r,p.memoizedState=_l(1|i,c,y,h)}function og(r,i){return Gc(8390656,8,r,i)}function _h(r,i){return qc(2048,8,r,i)}function lg(r,i){return qc(4,2,r,i)}function cg(r,i){return qc(4,4,r,i)}function ug(r,i){if(typeof i=="function")return r=r(),i(r),function(){i(null)};if(i!=null)return r=r(),i.current=r,function(){i.current=null}}function dg(r,i,c){return c=c!=null?c.concat([r]):null,qc(4,4,ug.bind(null,i,r),c)}function wh(){}function hg(r,i){var c=Yr();i=i===void 0?null:i;var h=c.memoizedState;return h!==null&&i!==null&&ph(i,h[1])?h[0]:(c.memoizedState=[r,i],r)}function fg(r,i){var c=Yr();i=i===void 0?null:i;var h=c.memoizedState;return h!==null&&i!==null&&ph(i,h[1])?h[0]:(r=r(),c.memoizedState=[r,i],r)}function pg(r,i,c){return(wa&21)===0?(r.baseState&&(r.baseState=!1,Er=!0),r.memoizedState=c):(hs(c,i)||(c=fr(),Kt.lanes|=c,xa|=c,r.baseState=!0),i)}function $x(r,i){var c=pt;pt=c!==0&&4>c?c:4,r(!0);var h=fh.transition;fh.transition={};try{r(!1),i()}finally{pt=c,fh.transition=h}}function mg(){return Yr().memoizedState}function Wx(r,i,c){var h=Di(r);if(c={lane:h,action:c,hasEagerState:!1,eagerState:null,next:null},gg(r))yg(i,c);else if(c=Hm(r,i,c,h),c!==null){var p=gr();ys(c,r,h,p),vg(c,i,h)}}function Gx(r,i,c){var h=Di(r),p={lane:h,action:c,hasEagerState:!1,eagerState:null,next:null};if(gg(r))yg(i,p);else{var y=r.alternate;if(r.lanes===0&&(y===null||y.lanes===0)&&(y=i.lastRenderedReducer,y!==null))try{var E=i.lastRenderedState,L=y(E,c);if(p.hasEagerState=!0,p.eagerState=L,hs(L,E)){var G=i.interleaved;G===null?(p.next=p,oh(i)):(p.next=G.next,G.next=p),i.interleaved=p;return}}catch{}finally{}c=Hm(r,i,p,h),c!==null&&(p=gr(),ys(c,r,h,p),vg(c,i,h))}}function gg(r){var i=r.alternate;return r===Kt||i!==null&&i===Kt}function yg(r,i){gl=Wc=!0;var c=r.pending;c===null?i.next=i:(i.next=c.next,c.next=i),r.pending=i}function vg(r,i,c){if((c&4194240)!==0){var h=i.lanes;h&=r.pendingLanes,c|=h,i.lanes=c,Ns(r,c)}}var Hc={readContext:Qr,useCallback:rr,useContext:rr,useEffect:rr,useImperativeHandle:rr,useInsertionEffect:rr,useLayoutEffect:rr,useMemo:rr,useReducer:rr,useRef:rr,useState:rr,useDebugValue:rr,useDeferredValue:rr,useTransition:rr,useMutableSource:rr,useSyncExternalStore:rr,useId:rr,unstable_isNewReconciler:!1},qx={readContext:Qr,useCallback:function(r,i){return Vs().memoizedState=[r,i===void 0?null:i],r},useContext:Qr,useEffect:og,useImperativeHandle:function(r,i,c){return c=c!=null?c.concat([r]):null,Gc(4194308,4,ug.bind(null,i,r),c)},useLayoutEffect:function(r,i){return Gc(4194308,4,r,i)},useInsertionEffect:function(r,i){return Gc(4,2,r,i)},useMemo:function(r,i){var c=Vs();return i=i===void 0?null:i,r=r(),c.memoizedState=[r,i],r},useReducer:function(r,i,c){var h=Vs();return i=c!==void 0?c(i):i,h.memoizedState=h.baseState=i,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:i},h.queue=r,r=r.dispatch=Wx.bind(null,Kt,r),[h.memoizedState,r]},useRef:function(r){var i=Vs();return r={current:r},i.memoizedState=r},useState:ig,useDebugValue:wh,useDeferredValue:function(r){return Vs().memoizedState=r},useTransition:function(){var r=ig(!1),i=r[0];return r=$x.bind(null,r[1]),Vs().memoizedState=r,[i,r]},useMutableSource:function(){},useSyncExternalStore:function(r,i,c){var h=Kt,p=Vs();if(Gt){if(c===void 0)throw Error(t(407));c=c()}else{if(c=i(),Mn===null)throw Error(t(349));(wa&30)!==0||eg(h,i,c)}p.memoizedState=c;var y={value:c,getSnapshot:i};return p.queue=y,og(ng.bind(null,h,y,r),[r]),h.flags|=2048,_l(9,tg.bind(null,h,y,c,i),void 0,null),c},useId:function(){var r=Vs(),i=Mn.identifierPrefix;if(Gt){var c=ri,h=ni;c=(h&~(1<<32-ne(h)-1)).toString(32)+c,i=":"+i+"R"+c,c=yl++,0<c&&(i+="H"+c.toString(32)),i+=":"}else c=Bx++,i=":"+i+"r"+c.toString(32)+":";return r.memoizedState=i},unstable_isNewReconciler:!1},Hx={readContext:Qr,useCallback:hg,useContext:Qr,useEffect:_h,useImperativeHandle:dg,useInsertionEffect:lg,useLayoutEffect:cg,useMemo:fg,useReducer:yh,useRef:ag,useState:function(){return yh(vl)},useDebugValue:wh,useDeferredValue:function(r){var i=Yr();return pg(i,Sn.memoizedState,r)},useTransition:function(){var r=yh(vl)[0],i=Yr().memoizedState;return[r,i]},useMutableSource:Xm,useSyncExternalStore:Zm,useId:mg,unstable_isNewReconciler:!1},Kx={readContext:Qr,useCallback:hg,useContext:Qr,useEffect:_h,useImperativeHandle:dg,useInsertionEffect:lg,useLayoutEffect:cg,useMemo:fg,useReducer:vh,useRef:ag,useState:function(){return vh(vl)},useDebugValue:wh,useDeferredValue:function(r){var i=Yr();return Sn===null?i.memoizedState=r:pg(i,Sn.memoizedState,r)},useTransition:function(){var r=vh(vl)[0],i=Yr().memoizedState;return[r,i]},useMutableSource:Xm,useSyncExternalStore:Zm,useId:mg,unstable_isNewReconciler:!1};function ps(r,i){if(r&&r.defaultProps){i=_e({},i),r=r.defaultProps;for(var c in r)i[c]===void 0&&(i[c]=r[c]);return i}return i}function xh(r,i,c,h){i=r.memoizedState,c=c(h,i),c=c==null?i:_e({},i,c),r.memoizedState=c,r.lanes===0&&(r.updateQueue.baseState=c)}var Kc={isMounted:function(r){return(r=r._reactInternals)?Ft(r)===r:!1},enqueueSetState:function(r,i,c){r=r._reactInternals;var h=gr(),p=Di(r),y=ii(h,p);y.payload=i,c!=null&&(y.callback=c),i=Ri(r,y,p),i!==null&&(ys(i,r,p,h),Uc(i,r,p))},enqueueReplaceState:function(r,i,c){r=r._reactInternals;var h=gr(),p=Di(r),y=ii(h,p);y.tag=1,y.payload=i,c!=null&&(y.callback=c),i=Ri(r,y,p),i!==null&&(ys(i,r,p,h),Uc(i,r,p))},enqueueForceUpdate:function(r,i){r=r._reactInternals;var c=gr(),h=Di(r),p=ii(c,h);p.tag=2,i!=null&&(p.callback=i),i=Ri(r,p,h),i!==null&&(ys(i,r,h,c),Uc(i,r,h))}};function _g(r,i,c,h,p,y,E){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(h,y,E):i.prototype&&i.prototype.isPureReactComponent?!il(c,h)||!il(p,y):!0}function wg(r,i,c){var h=!1,p=Ii,y=i.contextType;return typeof y=="object"&&y!==null?y=Qr(y):(p=xr(i)?ma:nr.current,h=i.contextTypes,y=(h=h!=null)?oo(r,p):Ii),i=new i(c,y),r.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=Kc,r.stateNode=i,i._reactInternals=r,h&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=p,r.__reactInternalMemoizedMaskedChildContext=y),i}function xg(r,i,c,h){r=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(c,h),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(c,h),i.state!==r&&Kc.enqueueReplaceState(i,i.state,null)}function Eh(r,i,c,h){var p=r.stateNode;p.props=c,p.state=r.memoizedState,p.refs={},lh(r);var y=i.contextType;typeof y=="object"&&y!==null?p.context=Qr(y):(y=xr(i)?ma:nr.current,p.context=oo(r,y)),p.state=r.memoizedState,y=i.getDerivedStateFromProps,typeof y=="function"&&(xh(r,i,y,c),p.state=r.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(i=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),i!==p.state&&Kc.enqueueReplaceState(p,p.state,null),zc(r,c,p,h),p.state=r.memoizedState),typeof p.componentDidMount=="function"&&(r.flags|=4194308)}function go(r,i){try{var c="",h=i;do c+=De(h),h=h.return;while(h);var p=c}catch(y){p=`
Error generating stack: `+y.message+`
`+y.stack}return{value:r,source:i,stack:p,digest:null}}function Th(r,i,c){return{value:r,source:null,stack:c??null,digest:i??null}}function Sh(r,i){try{console.error(i.value)}catch(c){setTimeout(function(){throw c})}}var Qx=typeof WeakMap=="function"?WeakMap:Map;function Eg(r,i,c){c=ii(-1,c),c.tag=3,c.payload={element:null};var h=i.value;return c.callback=function(){tu||(tu=!0,Fh=h),Sh(r,i)},c}function Tg(r,i,c){c=ii(-1,c),c.tag=3;var h=r.type.getDerivedStateFromError;if(typeof h=="function"){var p=i.value;c.payload=function(){return h(p)},c.callback=function(){Sh(r,i)}}var y=r.stateNode;return y!==null&&typeof y.componentDidCatch=="function"&&(c.callback=function(){Sh(r,i),typeof h!="function"&&(ji===null?ji=new Set([this]):ji.add(this));var E=i.stack;this.componentDidCatch(i.value,{componentStack:E!==null?E:""})}),c}function Sg(r,i,c){var h=r.pingCache;if(h===null){h=r.pingCache=new Qx;var p=new Set;h.set(i,p)}else p=h.get(i),p===void 0&&(p=new Set,h.set(i,p));p.has(c)||(p.add(c),r=cE.bind(null,r,i,c),i.then(r,r))}function bg(r){do{var i;if((i=r.tag===13)&&(i=r.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return r;r=r.return}while(r!==null);return null}function Cg(r,i,c,h,p){return(r.mode&1)===0?(r===i?r.flags|=65536:(r.flags|=128,c.flags|=131072,c.flags&=-52805,c.tag===1&&(c.alternate===null?c.tag=17:(i=ii(-1,1),i.tag=2,Ri(c,i,1))),c.lanes|=1),r):(r.flags|=65536,r.lanes=p,r)}var Yx=we.ReactCurrentOwner,Er=!1;function mr(r,i,c,h){i.child=r===null?qm(i,null,c,h):ho(i,r.child,c,h)}function Ig(r,i,c,h,p){c=c.render;var y=i.ref;return po(i,p),h=mh(r,i,c,h,y,p),c=gh(),r!==null&&!Er?(i.updateQueue=r.updateQueue,i.flags&=-2053,r.lanes&=~p,ai(r,i,p)):(Gt&&c&&Xd(i),i.flags|=1,mr(r,i,h,p),i.child)}function Pg(r,i,c,h,p){if(r===null){var y=c.type;return typeof y=="function"&&!qh(y)&&y.defaultProps===void 0&&c.compare===null&&c.defaultProps===void 0?(i.tag=15,i.type=y,Ng(r,i,y,h,p)):(r=ou(c.type,null,h,i,i.mode,p),r.ref=i.ref,r.return=i,i.child=r)}if(y=r.child,(r.lanes&p)===0){var E=y.memoizedProps;if(c=c.compare,c=c!==null?c:il,c(E,h)&&r.ref===i.ref)return ai(r,i,p)}return i.flags|=1,r=Vi(y,h),r.ref=i.ref,r.return=i,i.child=r}function Ng(r,i,c,h,p){if(r!==null){var y=r.memoizedProps;if(il(y,h)&&r.ref===i.ref)if(Er=!1,i.pendingProps=h=y,(r.lanes&p)!==0)(r.flags&131072)!==0&&(Er=!0);else return i.lanes=r.lanes,ai(r,i,p)}return bh(r,i,c,h,p)}function Rg(r,i,c){var h=i.pendingProps,p=h.children,y=r!==null?r.memoizedState:null;if(h.mode==="hidden")if((i.mode&1)===0)i.memoizedState={baseLanes:0,cachePool:null,transitions:null},Vt(vo,Ur),Ur|=c;else{if((c&1073741824)===0)return r=y!==null?y.baseLanes|c:c,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:r,cachePool:null,transitions:null},i.updateQueue=null,Vt(vo,Ur),Ur|=r,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},h=y!==null?y.baseLanes:c,Vt(vo,Ur),Ur|=h}else y!==null?(h=y.baseLanes|c,i.memoizedState=null):h=c,Vt(vo,Ur),Ur|=h;return mr(r,i,p,c),i.child}function Ag(r,i){var c=i.ref;(r===null&&c!==null||r!==null&&r.ref!==c)&&(i.flags|=512,i.flags|=2097152)}function bh(r,i,c,h,p){var y=xr(c)?ma:nr.current;return y=oo(i,y),po(i,p),c=mh(r,i,c,h,y,p),h=gh(),r!==null&&!Er?(i.updateQueue=r.updateQueue,i.flags&=-2053,r.lanes&=~p,ai(r,i,p)):(Gt&&h&&Xd(i),i.flags|=1,mr(r,i,c,p),i.child)}function jg(r,i,c,h,p){if(xr(c)){var y=!0;jc(i)}else y=!1;if(po(i,p),i.stateNode===null)Yc(r,i),wg(i,c,h),Eh(i,c,h,p),h=!0;else if(r===null){var E=i.stateNode,L=i.memoizedProps;E.props=L;var G=E.context,se=c.contextType;typeof se=="object"&&se!==null?se=Qr(se):(se=xr(c)?ma:nr.current,se=oo(i,se));var be=c.getDerivedStateFromProps,Pe=typeof be=="function"||typeof E.getSnapshotBeforeUpdate=="function";Pe||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(L!==h||G!==se)&&xg(i,E,h,se),Ni=!1;var xe=i.memoizedState;E.state=xe,zc(i,h,E,p),G=i.memoizedState,L!==h||xe!==G||wr.current||Ni?(typeof be=="function"&&(xh(i,c,be,h),G=i.memoizedState),(L=Ni||_g(i,c,L,h,xe,G,se))?(Pe||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount()),typeof E.componentDidMount=="function"&&(i.flags|=4194308)):(typeof E.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=h,i.memoizedState=G),E.props=h,E.state=G,E.context=se,h=L):(typeof E.componentDidMount=="function"&&(i.flags|=4194308),h=!1)}else{E=i.stateNode,Km(r,i),L=i.memoizedProps,se=i.type===i.elementType?L:ps(i.type,L),E.props=se,Pe=i.pendingProps,xe=E.context,G=c.contextType,typeof G=="object"&&G!==null?G=Qr(G):(G=xr(c)?ma:nr.current,G=oo(i,G));var Ue=c.getDerivedStateFromProps;(be=typeof Ue=="function"||typeof E.getSnapshotBeforeUpdate=="function")||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(L!==Pe||xe!==G)&&xg(i,E,h,G),Ni=!1,xe=i.memoizedState,E.state=xe,zc(i,h,E,p);var We=i.memoizedState;L!==Pe||xe!==We||wr.current||Ni?(typeof Ue=="function"&&(xh(i,c,Ue,h),We=i.memoizedState),(se=Ni||_g(i,c,se,h,xe,We,G)||!1)?(be||typeof E.UNSAFE_componentWillUpdate!="function"&&typeof E.componentWillUpdate!="function"||(typeof E.componentWillUpdate=="function"&&E.componentWillUpdate(h,We,G),typeof E.UNSAFE_componentWillUpdate=="function"&&E.UNSAFE_componentWillUpdate(h,We,G)),typeof E.componentDidUpdate=="function"&&(i.flags|=4),typeof E.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof E.componentDidUpdate!="function"||L===r.memoizedProps&&xe===r.memoizedState||(i.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||L===r.memoizedProps&&xe===r.memoizedState||(i.flags|=1024),i.memoizedProps=h,i.memoizedState=We),E.props=h,E.state=We,E.context=G,h=se):(typeof E.componentDidUpdate!="function"||L===r.memoizedProps&&xe===r.memoizedState||(i.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||L===r.memoizedProps&&xe===r.memoizedState||(i.flags|=1024),h=!1)}return Ch(r,i,c,h,y,p)}function Ch(r,i,c,h,p,y){Ag(r,i);var E=(i.flags&128)!==0;if(!h&&!E)return p&&Mm(i,c,!1),ai(r,i,y);h=i.stateNode,Yx.current=i;var L=E&&typeof c.getDerivedStateFromError!="function"?null:h.render();return i.flags|=1,r!==null&&E?(i.child=ho(i,r.child,null,y),i.child=ho(i,null,L,y)):mr(r,i,L,y),i.memoizedState=h.state,p&&Mm(i,c,!0),i.child}function kg(r){var i=r.stateNode;i.pendingContext?Lm(r,i.pendingContext,i.pendingContext!==i.context):i.context&&Lm(r,i.context,!1),ch(r,i.containerInfo)}function Dg(r,i,c,h,p){return uo(),nh(p),i.flags|=256,mr(r,i,c,h),i.child}var Ih={dehydrated:null,treeContext:null,retryLane:0};function Ph(r){return{baseLanes:r,cachePool:null,transitions:null}}function Lg(r,i,c){var h=i.pendingProps,p=Ht.current,y=!1,E=(i.flags&128)!==0,L;if((L=E)||(L=r!==null&&r.memoizedState===null?!1:(p&2)!==0),L?(y=!0,i.flags&=-129):(r===null||r.memoizedState!==null)&&(p|=1),Vt(Ht,p&1),r===null)return th(i),r=i.memoizedState,r!==null&&(r=r.dehydrated,r!==null)?((i.mode&1)===0?i.lanes=1:r.data==="$!"?i.lanes=8:i.lanes=1073741824,null):(E=h.children,r=h.fallback,y?(h=i.mode,y=i.child,E={mode:"hidden",children:E},(h&1)===0&&y!==null?(y.childLanes=0,y.pendingProps=E):y=lu(E,h,0,null),r=ba(r,h,c,null),y.return=i,r.return=i,y.sibling=r,i.child=y,i.child.memoizedState=Ph(c),i.memoizedState=Ih,r):Nh(i,E));if(p=r.memoizedState,p!==null&&(L=p.dehydrated,L!==null))return Jx(r,i,E,h,L,p,c);if(y){y=h.fallback,E=i.mode,p=r.child,L=p.sibling;var G={mode:"hidden",children:h.children};return(E&1)===0&&i.child!==p?(h=i.child,h.childLanes=0,h.pendingProps=G,i.deletions=null):(h=Vi(p,G),h.subtreeFlags=p.subtreeFlags&14680064),L!==null?y=Vi(L,y):(y=ba(y,E,c,null),y.flags|=2),y.return=i,h.return=i,h.sibling=y,i.child=h,h=y,y=i.child,E=r.child.memoizedState,E=E===null?Ph(c):{baseLanes:E.baseLanes|c,cachePool:null,transitions:E.transitions},y.memoizedState=E,y.childLanes=r.childLanes&~c,i.memoizedState=Ih,h}return y=r.child,r=y.sibling,h=Vi(y,{mode:"visible",children:h.children}),(i.mode&1)===0&&(h.lanes=c),h.return=i,h.sibling=null,r!==null&&(c=i.deletions,c===null?(i.deletions=[r],i.flags|=16):c.push(r)),i.child=h,i.memoizedState=null,h}function Nh(r,i){return i=lu({mode:"visible",children:i},r.mode,0,null),i.return=r,r.child=i}function Qc(r,i,c,h){return h!==null&&nh(h),ho(i,r.child,null,c),r=Nh(i,i.pendingProps.children),r.flags|=2,i.memoizedState=null,r}function Jx(r,i,c,h,p,y,E){if(c)return i.flags&256?(i.flags&=-257,h=Th(Error(t(422))),Qc(r,i,E,h)):i.memoizedState!==null?(i.child=r.child,i.flags|=128,null):(y=h.fallback,p=i.mode,h=lu({mode:"visible",children:h.children},p,0,null),y=ba(y,p,E,null),y.flags|=2,h.return=i,y.return=i,h.sibling=y,i.child=h,(i.mode&1)!==0&&ho(i,r.child,null,E),i.child.memoizedState=Ph(E),i.memoizedState=Ih,y);if((i.mode&1)===0)return Qc(r,i,E,null);if(p.data==="$!"){if(h=p.nextSibling&&p.nextSibling.dataset,h)var L=h.dgst;return h=L,y=Error(t(419)),h=Th(y,h,void 0),Qc(r,i,E,h)}if(L=(E&r.childLanes)!==0,Er||L){if(h=Mn,h!==null){switch(E&-E){case 4:p=2;break;case 16:p=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:p=32;break;case 536870912:p=268435456;break;default:p=0}p=(p&(h.suspendedLanes|E))!==0?0:p,p!==0&&p!==y.retryLane&&(y.retryLane=p,si(r,p),ys(h,r,p,-1))}return Gh(),h=Th(Error(t(421))),Qc(r,i,E,h)}return p.data==="$?"?(i.flags|=128,i.child=r.child,i=uE.bind(null,r),p._reactRetry=i,null):(r=y.treeContext,Fr=bi(p.nextSibling),Or=i,Gt=!0,fs=null,r!==null&&(Hr[Kr++]=ni,Hr[Kr++]=ri,Hr[Kr++]=ga,ni=r.id,ri=r.overflow,ga=i),i=Nh(i,h.children),i.flags|=4096,i)}function Vg(r,i,c){r.lanes|=i;var h=r.alternate;h!==null&&(h.lanes|=i),ah(r.return,i,c)}function Rh(r,i,c,h,p){var y=r.memoizedState;y===null?r.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:h,tail:c,tailMode:p}:(y.isBackwards=i,y.rendering=null,y.renderingStartTime=0,y.last=h,y.tail=c,y.tailMode=p)}function Mg(r,i,c){var h=i.pendingProps,p=h.revealOrder,y=h.tail;if(mr(r,i,h.children,c),h=Ht.current,(h&2)!==0)h=h&1|2,i.flags|=128;else{if(r!==null&&(r.flags&128)!==0)e:for(r=i.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&Vg(r,c,i);else if(r.tag===19)Vg(r,c,i);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===i)break e;for(;r.sibling===null;){if(r.return===null||r.return===i)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}h&=1}if(Vt(Ht,h),(i.mode&1)===0)i.memoizedState=null;else switch(p){case"forwards":for(c=i.child,p=null;c!==null;)r=c.alternate,r!==null&&Bc(r)===null&&(p=c),c=c.sibling;c=p,c===null?(p=i.child,i.child=null):(p=c.sibling,c.sibling=null),Rh(i,!1,p,c,y);break;case"backwards":for(c=null,p=i.child,i.child=null;p!==null;){if(r=p.alternate,r!==null&&Bc(r)===null){i.child=p;break}r=p.sibling,p.sibling=c,c=p,p=r}Rh(i,!0,c,null,y);break;case"together":Rh(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function Yc(r,i){(i.mode&1)===0&&r!==null&&(r.alternate=null,i.alternate=null,i.flags|=2)}function ai(r,i,c){if(r!==null&&(i.dependencies=r.dependencies),xa|=i.lanes,(c&i.childLanes)===0)return null;if(r!==null&&i.child!==r.child)throw Error(t(153));if(i.child!==null){for(r=i.child,c=Vi(r,r.pendingProps),i.child=c,c.return=i;r.sibling!==null;)r=r.sibling,c=c.sibling=Vi(r,r.pendingProps),c.return=i;c.sibling=null}return i.child}function Xx(r,i,c){switch(i.tag){case 3:kg(i),uo();break;case 5:Jm(i);break;case 1:xr(i.type)&&jc(i);break;case 4:ch(i,i.stateNode.containerInfo);break;case 10:var h=i.type._context,p=i.memoizedProps.value;Vt(Oc,h._currentValue),h._currentValue=p;break;case 13:if(h=i.memoizedState,h!==null)return h.dehydrated!==null?(Vt(Ht,Ht.current&1),i.flags|=128,null):(c&i.child.childLanes)!==0?Lg(r,i,c):(Vt(Ht,Ht.current&1),r=ai(r,i,c),r!==null?r.sibling:null);Vt(Ht,Ht.current&1);break;case 19:if(h=(c&i.childLanes)!==0,(r.flags&128)!==0){if(h)return Mg(r,i,c);i.flags|=128}if(p=i.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),Vt(Ht,Ht.current),h)break;return null;case 22:case 23:return i.lanes=0,Rg(r,i,c)}return ai(r,i,c)}var Og,Ah,Fg,Ug;Og=function(r,i){for(var c=i.child;c!==null;){if(c.tag===5||c.tag===6)r.appendChild(c.stateNode);else if(c.tag!==4&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===i)break;for(;c.sibling===null;){if(c.return===null||c.return===i)return;c=c.return}c.sibling.return=c.return,c=c.sibling}},Ah=function(){},Fg=function(r,i,c,h){var p=r.memoizedProps;if(p!==h){r=i.stateNode,_a(Ls.current);var y=null;switch(c){case"input":p=He(r,p),h=He(r,h),y=[];break;case"select":p=_e({},p,{value:void 0}),h=_e({},h,{value:void 0}),y=[];break;case"textarea":p=nn(r,p),h=nn(r,h),y=[];break;default:typeof p.onClick!="function"&&typeof h.onClick=="function"&&(r.onclick=Nc)}is(c,h);var E;c=null;for(se in p)if(!h.hasOwnProperty(se)&&p.hasOwnProperty(se)&&p[se]!=null)if(se==="style"){var L=p[se];for(E in L)L.hasOwnProperty(E)&&(c||(c={}),c[E]="")}else se!=="dangerouslySetInnerHTML"&&se!=="children"&&se!=="suppressContentEditableWarning"&&se!=="suppressHydrationWarning"&&se!=="autoFocus"&&(a.hasOwnProperty(se)?y||(y=[]):(y=y||[]).push(se,null));for(se in h){var G=h[se];if(L=p!=null?p[se]:void 0,h.hasOwnProperty(se)&&G!==L&&(G!=null||L!=null))if(se==="style")if(L){for(E in L)!L.hasOwnProperty(E)||G&&G.hasOwnProperty(E)||(c||(c={}),c[E]="");for(E in G)G.hasOwnProperty(E)&&L[E]!==G[E]&&(c||(c={}),c[E]=G[E])}else c||(y||(y=[]),y.push(se,c)),c=G;else se==="dangerouslySetInnerHTML"?(G=G?G.__html:void 0,L=L?L.__html:void 0,G!=null&&L!==G&&(y=y||[]).push(se,G)):se==="children"?typeof G!="string"&&typeof G!="number"||(y=y||[]).push(se,""+G):se!=="suppressContentEditableWarning"&&se!=="suppressHydrationWarning"&&(a.hasOwnProperty(se)?(G!=null&&se==="onScroll"&&Ut("scroll",r),y||L===G||(y=[])):(y=y||[]).push(se,G))}c&&(y=y||[]).push("style",c);var se=y;(i.updateQueue=se)&&(i.flags|=4)}},Ug=function(r,i,c,h){c!==h&&(i.flags|=4)};function wl(r,i){if(!Gt)switch(r.tailMode){case"hidden":i=r.tail;for(var c=null;i!==null;)i.alternate!==null&&(c=i),i=i.sibling;c===null?r.tail=null:c.sibling=null;break;case"collapsed":c=r.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?i||r.tail===null?r.tail=null:r.tail.sibling=null:h.sibling=null}}function sr(r){var i=r.alternate!==null&&r.alternate.child===r.child,c=0,h=0;if(i)for(var p=r.child;p!==null;)c|=p.lanes|p.childLanes,h|=p.subtreeFlags&14680064,h|=p.flags&14680064,p.return=r,p=p.sibling;else for(p=r.child;p!==null;)c|=p.lanes|p.childLanes,h|=p.subtreeFlags,h|=p.flags,p.return=r,p=p.sibling;return r.subtreeFlags|=h,r.childLanes=c,i}function Zx(r,i,c){var h=i.pendingProps;switch(Zd(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return sr(i),null;case 1:return xr(i.type)&&Ac(),sr(i),null;case 3:return h=i.stateNode,mo(),zt(wr),zt(nr),hh(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(r===null||r.child===null)&&(Vc(i)?i.flags|=4:r===null||r.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,fs!==null&&(Bh(fs),fs=null))),Ah(r,i),sr(i),null;case 5:uh(i);var p=_a(ml.current);if(c=i.type,r!==null&&i.stateNode!=null)Fg(r,i,c,h,p),r.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!h){if(i.stateNode===null)throw Error(t(166));return sr(i),null}if(r=_a(Ls.current),Vc(i)){h=i.stateNode,c=i.type;var y=i.memoizedProps;switch(h[Ds]=i,h[ul]=y,r=(i.mode&1)!==0,c){case"dialog":Ut("cancel",h),Ut("close",h);break;case"iframe":case"object":case"embed":Ut("load",h);break;case"video":case"audio":for(p=0;p<ol.length;p++)Ut(ol[p],h);break;case"source":Ut("error",h);break;case"img":case"image":case"link":Ut("error",h),Ut("load",h);break;case"details":Ut("toggle",h);break;case"input":Ye(h,y),Ut("invalid",h);break;case"select":h._wrapperState={wasMultiple:!!y.multiple},Ut("invalid",h);break;case"textarea":ur(h,y),Ut("invalid",h)}is(c,y),p=null;for(var E in y)if(y.hasOwnProperty(E)){var L=y[E];E==="children"?typeof L=="string"?h.textContent!==L&&(y.suppressHydrationWarning!==!0&&Pc(h.textContent,L,r),p=["children",L]):typeof L=="number"&&h.textContent!==""+L&&(y.suppressHydrationWarning!==!0&&Pc(h.textContent,L,r),p=["children",""+L]):a.hasOwnProperty(E)&&L!=null&&E==="onScroll"&&Ut("scroll",h)}switch(c){case"input":ue(h),gt(h,y,!0);break;case"textarea":ue(h),Yn(h);break;case"select":case"option":break;default:typeof y.onClick=="function"&&(h.onclick=Nc)}h=p,i.updateQueue=h,h!==null&&(i.flags|=4)}else{E=p.nodeType===9?p:p.ownerDocument,r==="http://www.w3.org/1999/xhtml"&&(r=Ot(c)),r==="http://www.w3.org/1999/xhtml"?c==="script"?(r=E.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild)):typeof h.is=="string"?r=E.createElement(c,{is:h.is}):(r=E.createElement(c),c==="select"&&(E=r,h.multiple?E.multiple=!0:h.size&&(E.size=h.size))):r=E.createElementNS(r,c),r[Ds]=i,r[ul]=h,Og(r,i,!1,!1),i.stateNode=r;e:{switch(E=Ss(c,h),c){case"dialog":Ut("cancel",r),Ut("close",r),p=h;break;case"iframe":case"object":case"embed":Ut("load",r),p=h;break;case"video":case"audio":for(p=0;p<ol.length;p++)Ut(ol[p],r);p=h;break;case"source":Ut("error",r),p=h;break;case"img":case"image":case"link":Ut("error",r),Ut("load",r),p=h;break;case"details":Ut("toggle",r),p=h;break;case"input":Ye(r,h),p=He(r,h),Ut("invalid",r);break;case"option":p=h;break;case"select":r._wrapperState={wasMultiple:!!h.multiple},p=_e({},h,{value:void 0}),Ut("invalid",r);break;case"textarea":ur(r,h),p=nn(r,h),Ut("invalid",r);break;default:p=h}is(c,p),L=p;for(y in L)if(L.hasOwnProperty(y)){var G=L[y];y==="style"?Nn(r,G):y==="dangerouslySetInnerHTML"?(G=G?G.__html:void 0,G!=null&&dr(r,G)):y==="children"?typeof G=="string"?(c!=="textarea"||G!=="")&&Pn(r,G):typeof G=="number"&&Pn(r,""+G):y!=="suppressContentEditableWarning"&&y!=="suppressHydrationWarning"&&y!=="autoFocus"&&(a.hasOwnProperty(y)?G!=null&&y==="onScroll"&&Ut("scroll",r):G!=null&&Ee(r,y,G,E))}switch(c){case"input":ue(r),gt(r,h,!1);break;case"textarea":ue(r),Yn(r);break;case"option":h.value!=null&&r.setAttribute("value",""+Qe(h.value));break;case"select":r.multiple=!!h.multiple,y=h.value,y!=null?tn(r,!!h.multiple,y,!1):h.defaultValue!=null&&tn(r,!!h.multiple,h.defaultValue,!0);break;default:typeof p.onClick=="function"&&(r.onclick=Nc)}switch(c){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}}h&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return sr(i),null;case 6:if(r&&i.stateNode!=null)Ug(r,i,r.memoizedProps,h);else{if(typeof h!="string"&&i.stateNode===null)throw Error(t(166));if(c=_a(ml.current),_a(Ls.current),Vc(i)){if(h=i.stateNode,c=i.memoizedProps,h[Ds]=i,(y=h.nodeValue!==c)&&(r=Or,r!==null))switch(r.tag){case 3:Pc(h.nodeValue,c,(r.mode&1)!==0);break;case 5:r.memoizedProps.suppressHydrationWarning!==!0&&Pc(h.nodeValue,c,(r.mode&1)!==0)}y&&(i.flags|=4)}else h=(c.nodeType===9?c:c.ownerDocument).createTextNode(h),h[Ds]=i,i.stateNode=h}return sr(i),null;case 13:if(zt(Ht),h=i.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(Gt&&Fr!==null&&(i.mode&1)!==0&&(i.flags&128)===0)$m(),uo(),i.flags|=98560,y=!1;else if(y=Vc(i),h!==null&&h.dehydrated!==null){if(r===null){if(!y)throw Error(t(318));if(y=i.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(t(317));y[Ds]=i}else uo(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;sr(i),y=!1}else fs!==null&&(Bh(fs),fs=null),y=!0;if(!y)return i.flags&65536?i:null}return(i.flags&128)!==0?(i.lanes=c,i):(h=h!==null,h!==(r!==null&&r.memoizedState!==null)&&h&&(i.child.flags|=8192,(i.mode&1)!==0&&(r===null||(Ht.current&1)!==0?bn===0&&(bn=3):Gh())),i.updateQueue!==null&&(i.flags|=4),sr(i),null);case 4:return mo(),Ah(r,i),r===null&&ll(i.stateNode.containerInfo),sr(i),null;case 10:return ih(i.type._context),sr(i),null;case 17:return xr(i.type)&&Ac(),sr(i),null;case 19:if(zt(Ht),y=i.memoizedState,y===null)return sr(i),null;if(h=(i.flags&128)!==0,E=y.rendering,E===null)if(h)wl(y,!1);else{if(bn!==0||r!==null&&(r.flags&128)!==0)for(r=i.child;r!==null;){if(E=Bc(r),E!==null){for(i.flags|=128,wl(y,!1),h=E.updateQueue,h!==null&&(i.updateQueue=h,i.flags|=4),i.subtreeFlags=0,h=c,c=i.child;c!==null;)y=c,r=h,y.flags&=14680066,E=y.alternate,E===null?(y.childLanes=0,y.lanes=r,y.child=null,y.subtreeFlags=0,y.memoizedProps=null,y.memoizedState=null,y.updateQueue=null,y.dependencies=null,y.stateNode=null):(y.childLanes=E.childLanes,y.lanes=E.lanes,y.child=E.child,y.subtreeFlags=0,y.deletions=null,y.memoizedProps=E.memoizedProps,y.memoizedState=E.memoizedState,y.updateQueue=E.updateQueue,y.type=E.type,r=E.dependencies,y.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),c=c.sibling;return Vt(Ht,Ht.current&1|2),i.child}r=r.sibling}y.tail!==null&&dt()>_o&&(i.flags|=128,h=!0,wl(y,!1),i.lanes=4194304)}else{if(!h)if(r=Bc(E),r!==null){if(i.flags|=128,h=!0,c=r.updateQueue,c!==null&&(i.updateQueue=c,i.flags|=4),wl(y,!0),y.tail===null&&y.tailMode==="hidden"&&!E.alternate&&!Gt)return sr(i),null}else 2*dt()-y.renderingStartTime>_o&&c!==1073741824&&(i.flags|=128,h=!0,wl(y,!1),i.lanes=4194304);y.isBackwards?(E.sibling=i.child,i.child=E):(c=y.last,c!==null?c.sibling=E:i.child=E,y.last=E)}return y.tail!==null?(i=y.tail,y.rendering=i,y.tail=i.sibling,y.renderingStartTime=dt(),i.sibling=null,c=Ht.current,Vt(Ht,h?c&1|2:c&1),i):(sr(i),null);case 22:case 23:return Wh(),h=i.memoizedState!==null,r!==null&&r.memoizedState!==null!==h&&(i.flags|=8192),h&&(i.mode&1)!==0?(Ur&1073741824)!==0&&(sr(i),i.subtreeFlags&6&&(i.flags|=8192)):sr(i),null;case 24:return null;case 25:return null}throw Error(t(156,i.tag))}function eE(r,i){switch(Zd(i),i.tag){case 1:return xr(i.type)&&Ac(),r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 3:return mo(),zt(wr),zt(nr),hh(),r=i.flags,(r&65536)!==0&&(r&128)===0?(i.flags=r&-65537|128,i):null;case 5:return uh(i),null;case 13:if(zt(Ht),r=i.memoizedState,r!==null&&r.dehydrated!==null){if(i.alternate===null)throw Error(t(340));uo()}return r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 19:return zt(Ht),null;case 4:return mo(),null;case 10:return ih(i.type._context),null;case 22:case 23:return Wh(),null;case 24:return null;default:return null}}var Jc=!1,ir=!1,tE=typeof WeakSet=="function"?WeakSet:Set,$e=null;function yo(r,i){var c=r.ref;if(c!==null)if(typeof c=="function")try{c(null)}catch(h){Xt(r,i,h)}else c.current=null}function jh(r,i,c){try{c()}catch(h){Xt(r,i,h)}}var zg=!1;function nE(r,i){if(Wd=Ei,r=_m(),Vd(r)){if("selectionStart"in r)var c={start:r.selectionStart,end:r.selectionEnd};else e:{c=(c=r.ownerDocument)&&c.defaultView||window;var h=c.getSelection&&c.getSelection();if(h&&h.rangeCount!==0){c=h.anchorNode;var p=h.anchorOffset,y=h.focusNode;h=h.focusOffset;try{c.nodeType,y.nodeType}catch{c=null;break e}var E=0,L=-1,G=-1,se=0,be=0,Pe=r,xe=null;t:for(;;){for(var Ue;Pe!==c||p!==0&&Pe.nodeType!==3||(L=E+p),Pe!==y||h!==0&&Pe.nodeType!==3||(G=E+h),Pe.nodeType===3&&(E+=Pe.nodeValue.length),(Ue=Pe.firstChild)!==null;)xe=Pe,Pe=Ue;for(;;){if(Pe===r)break t;if(xe===c&&++se===p&&(L=E),xe===y&&++be===h&&(G=E),(Ue=Pe.nextSibling)!==null)break;Pe=xe,xe=Pe.parentNode}Pe=Ue}c=L===-1||G===-1?null:{start:L,end:G}}else c=null}c=c||{start:0,end:0}}else c=null;for(Gd={focusedElem:r,selectionRange:c},Ei=!1,$e=i;$e!==null;)if(i=$e,r=i.child,(i.subtreeFlags&1028)!==0&&r!==null)r.return=i,$e=r;else for(;$e!==null;){i=$e;try{var We=i.alternate;if((i.flags&1024)!==0)switch(i.tag){case 0:case 11:case 15:break;case 1:if(We!==null){var qe=We.memoizedProps,ln=We.memoizedState,ee=i.stateNode,K=ee.getSnapshotBeforeUpdate(i.elementType===i.type?qe:ps(i.type,qe),ln);ee.__reactInternalSnapshotBeforeUpdate=K}break;case 3:var te=i.stateNode.containerInfo;te.nodeType===1?te.textContent="":te.nodeType===9&&te.documentElement&&te.removeChild(te.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(je){Xt(i,i.return,je)}if(r=i.sibling,r!==null){r.return=i.return,$e=r;break}$e=i.return}return We=zg,zg=!1,We}function xl(r,i,c){var h=i.updateQueue;if(h=h!==null?h.lastEffect:null,h!==null){var p=h=h.next;do{if((p.tag&r)===r){var y=p.destroy;p.destroy=void 0,y!==void 0&&jh(i,c,y)}p=p.next}while(p!==h)}}function Xc(r,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var c=i=i.next;do{if((c.tag&r)===r){var h=c.create;c.destroy=h()}c=c.next}while(c!==i)}}function kh(r){var i=r.ref;if(i!==null){var c=r.stateNode;switch(r.tag){case 5:r=c;break;default:r=c}typeof i=="function"?i(r):i.current=r}}function Bg(r){var i=r.alternate;i!==null&&(r.alternate=null,Bg(i)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(i=r.stateNode,i!==null&&(delete i[Ds],delete i[ul],delete i[Qd],delete i[Ox],delete i[Fx])),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}function $g(r){return r.tag===5||r.tag===3||r.tag===4}function Wg(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||$g(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Dh(r,i,c){var h=r.tag;if(h===5||h===6)r=r.stateNode,i?c.nodeType===8?c.parentNode.insertBefore(r,i):c.insertBefore(r,i):(c.nodeType===8?(i=c.parentNode,i.insertBefore(r,c)):(i=c,i.appendChild(r)),c=c._reactRootContainer,c!=null||i.onclick!==null||(i.onclick=Nc));else if(h!==4&&(r=r.child,r!==null))for(Dh(r,i,c),r=r.sibling;r!==null;)Dh(r,i,c),r=r.sibling}function Lh(r,i,c){var h=r.tag;if(h===5||h===6)r=r.stateNode,i?c.insertBefore(r,i):c.appendChild(r);else if(h!==4&&(r=r.child,r!==null))for(Lh(r,i,c),r=r.sibling;r!==null;)Lh(r,i,c),r=r.sibling}var Gn=null,ms=!1;function Ai(r,i,c){for(c=c.child;c!==null;)Gg(r,i,c),c=c.sibling}function Gg(r,i,c){if(W&&typeof W.onCommitFiberUnmount=="function")try{W.onCommitFiberUnmount(O,c)}catch{}switch(c.tag){case 5:ir||yo(c,i);case 6:var h=Gn,p=ms;Gn=null,Ai(r,i,c),Gn=h,ms=p,Gn!==null&&(ms?(r=Gn,c=c.stateNode,r.nodeType===8?r.parentNode.removeChild(c):r.removeChild(c)):Gn.removeChild(c.stateNode));break;case 18:Gn!==null&&(ms?(r=Gn,c=c.stateNode,r.nodeType===8?Kd(r.parentNode,c):r.nodeType===1&&Kd(r,c),$n(r)):Kd(Gn,c.stateNode));break;case 4:h=Gn,p=ms,Gn=c.stateNode.containerInfo,ms=!0,Ai(r,i,c),Gn=h,ms=p;break;case 0:case 11:case 14:case 15:if(!ir&&(h=c.updateQueue,h!==null&&(h=h.lastEffect,h!==null))){p=h=h.next;do{var y=p,E=y.destroy;y=y.tag,E!==void 0&&((y&2)!==0||(y&4)!==0)&&jh(c,i,E),p=p.next}while(p!==h)}Ai(r,i,c);break;case 1:if(!ir&&(yo(c,i),h=c.stateNode,typeof h.componentWillUnmount=="function"))try{h.props=c.memoizedProps,h.state=c.memoizedState,h.componentWillUnmount()}catch(L){Xt(c,i,L)}Ai(r,i,c);break;case 21:Ai(r,i,c);break;case 22:c.mode&1?(ir=(h=ir)||c.memoizedState!==null,Ai(r,i,c),ir=h):Ai(r,i,c);break;default:Ai(r,i,c)}}function qg(r){var i=r.updateQueue;if(i!==null){r.updateQueue=null;var c=r.stateNode;c===null&&(c=r.stateNode=new tE),i.forEach(function(h){var p=dE.bind(null,r,h);c.has(h)||(c.add(h),h.then(p,p))})}}function gs(r,i){var c=i.deletions;if(c!==null)for(var h=0;h<c.length;h++){var p=c[h];try{var y=r,E=i,L=E;e:for(;L!==null;){switch(L.tag){case 5:Gn=L.stateNode,ms=!1;break e;case 3:Gn=L.stateNode.containerInfo,ms=!0;break e;case 4:Gn=L.stateNode.containerInfo,ms=!0;break e}L=L.return}if(Gn===null)throw Error(t(160));Gg(y,E,p),Gn=null,ms=!1;var G=p.alternate;G!==null&&(G.return=null),p.return=null}catch(se){Xt(p,i,se)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)Hg(i,r),i=i.sibling}function Hg(r,i){var c=r.alternate,h=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:if(gs(i,r),Ms(r),h&4){try{xl(3,r,r.return),Xc(3,r)}catch(qe){Xt(r,r.return,qe)}try{xl(5,r,r.return)}catch(qe){Xt(r,r.return,qe)}}break;case 1:gs(i,r),Ms(r),h&512&&c!==null&&yo(c,c.return);break;case 5:if(gs(i,r),Ms(r),h&512&&c!==null&&yo(c,c.return),r.flags&32){var p=r.stateNode;try{Pn(p,"")}catch(qe){Xt(r,r.return,qe)}}if(h&4&&(p=r.stateNode,p!=null)){var y=r.memoizedProps,E=c!==null?c.memoizedProps:y,L=r.type,G=r.updateQueue;if(r.updateQueue=null,G!==null)try{L==="input"&&y.type==="radio"&&y.name!=null&&Tt(p,y),Ss(L,E);var se=Ss(L,y);for(E=0;E<G.length;E+=2){var be=G[E],Pe=G[E+1];be==="style"?Nn(p,Pe):be==="dangerouslySetInnerHTML"?dr(p,Pe):be==="children"?Pn(p,Pe):Ee(p,be,Pe,se)}switch(L){case"input":Ct(p,y);break;case"textarea":rn(p,y);break;case"select":var xe=p._wrapperState.wasMultiple;p._wrapperState.wasMultiple=!!y.multiple;var Ue=y.value;Ue!=null?tn(p,!!y.multiple,Ue,!1):xe!==!!y.multiple&&(y.defaultValue!=null?tn(p,!!y.multiple,y.defaultValue,!0):tn(p,!!y.multiple,y.multiple?[]:"",!1))}p[ul]=y}catch(qe){Xt(r,r.return,qe)}}break;case 6:if(gs(i,r),Ms(r),h&4){if(r.stateNode===null)throw Error(t(162));p=r.stateNode,y=r.memoizedProps;try{p.nodeValue=y}catch(qe){Xt(r,r.return,qe)}}break;case 3:if(gs(i,r),Ms(r),h&4&&c!==null&&c.memoizedState.isDehydrated)try{$n(i.containerInfo)}catch(qe){Xt(r,r.return,qe)}break;case 4:gs(i,r),Ms(r);break;case 13:gs(i,r),Ms(r),p=r.child,p.flags&8192&&(y=p.memoizedState!==null,p.stateNode.isHidden=y,!y||p.alternate!==null&&p.alternate.memoizedState!==null||(Oh=dt())),h&4&&qg(r);break;case 22:if(be=c!==null&&c.memoizedState!==null,r.mode&1?(ir=(se=ir)||be,gs(i,r),ir=se):gs(i,r),Ms(r),h&8192){if(se=r.memoizedState!==null,(r.stateNode.isHidden=se)&&!be&&(r.mode&1)!==0)for($e=r,be=r.child;be!==null;){for(Pe=$e=be;$e!==null;){switch(xe=$e,Ue=xe.child,xe.tag){case 0:case 11:case 14:case 15:xl(4,xe,xe.return);break;case 1:yo(xe,xe.return);var We=xe.stateNode;if(typeof We.componentWillUnmount=="function"){h=xe,c=xe.return;try{i=h,We.props=i.memoizedProps,We.state=i.memoizedState,We.componentWillUnmount()}catch(qe){Xt(h,c,qe)}}break;case 5:yo(xe,xe.return);break;case 22:if(xe.memoizedState!==null){Yg(Pe);continue}}Ue!==null?(Ue.return=xe,$e=Ue):Yg(Pe)}be=be.sibling}e:for(be=null,Pe=r;;){if(Pe.tag===5){if(be===null){be=Pe;try{p=Pe.stateNode,se?(y=p.style,typeof y.setProperty=="function"?y.setProperty("display","none","important"):y.display="none"):(L=Pe.stateNode,G=Pe.memoizedProps.style,E=G!=null&&G.hasOwnProperty("display")?G.display:null,L.style.display=ss("display",E))}catch(qe){Xt(r,r.return,qe)}}}else if(Pe.tag===6){if(be===null)try{Pe.stateNode.nodeValue=se?"":Pe.memoizedProps}catch(qe){Xt(r,r.return,qe)}}else if((Pe.tag!==22&&Pe.tag!==23||Pe.memoizedState===null||Pe===r)&&Pe.child!==null){Pe.child.return=Pe,Pe=Pe.child;continue}if(Pe===r)break e;for(;Pe.sibling===null;){if(Pe.return===null||Pe.return===r)break e;be===Pe&&(be=null),Pe=Pe.return}be===Pe&&(be=null),Pe.sibling.return=Pe.return,Pe=Pe.sibling}}break;case 19:gs(i,r),Ms(r),h&4&&qg(r);break;case 21:break;default:gs(i,r),Ms(r)}}function Ms(r){var i=r.flags;if(i&2){try{e:{for(var c=r.return;c!==null;){if($g(c)){var h=c;break e}c=c.return}throw Error(t(160))}switch(h.tag){case 5:var p=h.stateNode;h.flags&32&&(Pn(p,""),h.flags&=-33);var y=Wg(r);Lh(r,y,p);break;case 3:case 4:var E=h.stateNode.containerInfo,L=Wg(r);Dh(r,L,E);break;default:throw Error(t(161))}}catch(G){Xt(r,r.return,G)}r.flags&=-3}i&4096&&(r.flags&=-4097)}function rE(r,i,c){$e=r,Kg(r)}function Kg(r,i,c){for(var h=(r.mode&1)!==0;$e!==null;){var p=$e,y=p.child;if(p.tag===22&&h){var E=p.memoizedState!==null||Jc;if(!E){var L=p.alternate,G=L!==null&&L.memoizedState!==null||ir;L=Jc;var se=ir;if(Jc=E,(ir=G)&&!se)for($e=p;$e!==null;)E=$e,G=E.child,E.tag===22&&E.memoizedState!==null?Jg(p):G!==null?(G.return=E,$e=G):Jg(p);for(;y!==null;)$e=y,Kg(y),y=y.sibling;$e=p,Jc=L,ir=se}Qg(r)}else(p.subtreeFlags&8772)!==0&&y!==null?(y.return=p,$e=y):Qg(r)}}function Qg(r){for(;$e!==null;){var i=$e;if((i.flags&8772)!==0){var c=i.alternate;try{if((i.flags&8772)!==0)switch(i.tag){case 0:case 11:case 15:ir||Xc(5,i);break;case 1:var h=i.stateNode;if(i.flags&4&&!ir)if(c===null)h.componentDidMount();else{var p=i.elementType===i.type?c.memoizedProps:ps(i.type,c.memoizedProps);h.componentDidUpdate(p,c.memoizedState,h.__reactInternalSnapshotBeforeUpdate)}var y=i.updateQueue;y!==null&&Ym(i,y,h);break;case 3:var E=i.updateQueue;if(E!==null){if(c=null,i.child!==null)switch(i.child.tag){case 5:c=i.child.stateNode;break;case 1:c=i.child.stateNode}Ym(i,E,c)}break;case 5:var L=i.stateNode;if(c===null&&i.flags&4){c=L;var G=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":G.autoFocus&&c.focus();break;case"img":G.src&&(c.src=G.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var se=i.alternate;if(se!==null){var be=se.memoizedState;if(be!==null){var Pe=be.dehydrated;Pe!==null&&$n(Pe)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}ir||i.flags&512&&kh(i)}catch(xe){Xt(i,i.return,xe)}}if(i===r){$e=null;break}if(c=i.sibling,c!==null){c.return=i.return,$e=c;break}$e=i.return}}function Yg(r){for(;$e!==null;){var i=$e;if(i===r){$e=null;break}var c=i.sibling;if(c!==null){c.return=i.return,$e=c;break}$e=i.return}}function Jg(r){for(;$e!==null;){var i=$e;try{switch(i.tag){case 0:case 11:case 15:var c=i.return;try{Xc(4,i)}catch(G){Xt(i,c,G)}break;case 1:var h=i.stateNode;if(typeof h.componentDidMount=="function"){var p=i.return;try{h.componentDidMount()}catch(G){Xt(i,p,G)}}var y=i.return;try{kh(i)}catch(G){Xt(i,y,G)}break;case 5:var E=i.return;try{kh(i)}catch(G){Xt(i,E,G)}}}catch(G){Xt(i,i.return,G)}if(i===r){$e=null;break}var L=i.sibling;if(L!==null){L.return=i.return,$e=L;break}$e=i.return}}var sE=Math.ceil,Zc=we.ReactCurrentDispatcher,Vh=we.ReactCurrentOwner,Jr=we.ReactCurrentBatchConfig,bt=0,Mn=null,gn=null,qn=0,Ur=0,vo=Ci(0),bn=0,El=null,xa=0,eu=0,Mh=0,Tl=null,Tr=null,Oh=0,_o=1/0,oi=null,tu=!1,Fh=null,ji=null,nu=!1,ki=null,ru=0,Sl=0,Uh=null,su=-1,iu=0;function gr(){return(bt&6)!==0?dt():su!==-1?su:su=dt()}function Di(r){return(r.mode&1)===0?1:(bt&2)!==0&&qn!==0?qn&-qn:zx.transition!==null?(iu===0&&(iu=fr()),iu):(r=pt,r!==0||(r=window.event,r=r===void 0?16:Xo(r.type)),r)}function ys(r,i,c,h){if(50<Sl)throw Sl=0,Uh=null,Error(t(185));cs(r,c,h),((bt&2)===0||r!==Mn)&&(r===Mn&&((bt&2)===0&&(eu|=c),bn===4&&Li(r,qn)),Sr(r,h),c===1&&bt===0&&(i.mode&1)===0&&(_o=dt()+500,kc&&Pi()))}function Sr(r,i){var c=r.callbackNode;sn(r,i);var h=ht(r,r===Mn?qn:0);if(h===0)c!==null&&hn(c),r.callbackNode=null,r.callbackPriority=0;else if(i=h&-h,r.callbackPriority!==i){if(c!=null&&hn(c),i===1)r.tag===0?Ux(Zg.bind(null,r)):Om(Zg.bind(null,r)),Vx(function(){(bt&6)===0&&Pi()}),c=null;else{switch(Rs(h)){case 1:c=fn;break;case 4:c=pn;break;case 16:c=x;break;case 536870912:c=$;break;default:c=x}c=oy(c,Xg.bind(null,r))}r.callbackPriority=i,r.callbackNode=c}}function Xg(r,i){if(su=-1,iu=0,(bt&6)!==0)throw Error(t(327));var c=r.callbackNode;if(wo()&&r.callbackNode!==c)return null;var h=ht(r,r===Mn?qn:0);if(h===0)return null;if((h&30)!==0||(h&r.expiredLanes)!==0||i)i=au(r,h);else{i=h;var p=bt;bt|=2;var y=ty();(Mn!==r||qn!==i)&&(oi=null,_o=dt()+500,Ta(r,i));do try{oE();break}catch(L){ey(r,L)}while(!0);sh(),Zc.current=y,bt=p,gn!==null?i=0:(Mn=null,qn=0,i=bn)}if(i!==0){if(i===2&&(p=Dn(r),p!==0&&(h=p,i=zh(r,p))),i===1)throw c=El,Ta(r,0),Li(r,h),Sr(r,dt()),c;if(i===6)Li(r,h);else{if(p=r.current.alternate,(h&30)===0&&!iE(p)&&(i=au(r,h),i===2&&(y=Dn(r),y!==0&&(h=y,i=zh(r,y))),i===1))throw c=El,Ta(r,0),Li(r,h),Sr(r,dt()),c;switch(r.finishedWork=p,r.finishedLanes=h,i){case 0:case 1:throw Error(t(345));case 2:Sa(r,Tr,oi);break;case 3:if(Li(r,h),(h&130023424)===h&&(i=Oh+500-dt(),10<i)){if(ht(r,0)!==0)break;if(p=r.suspendedLanes,(p&h)!==h){gr(),r.pingedLanes|=r.suspendedLanes&p;break}r.timeoutHandle=Hd(Sa.bind(null,r,Tr,oi),i);break}Sa(r,Tr,oi);break;case 4:if(Li(r,h),(h&4194240)===h)break;for(i=r.eventTimes,p=-1;0<h;){var E=31-ne(h);y=1<<E,E=i[E],E>p&&(p=E),h&=~y}if(h=p,h=dt()-h,h=(120>h?120:480>h?480:1080>h?1080:1920>h?1920:3e3>h?3e3:4320>h?4320:1960*sE(h/1960))-h,10<h){r.timeoutHandle=Hd(Sa.bind(null,r,Tr,oi),h);break}Sa(r,Tr,oi);break;case 5:Sa(r,Tr,oi);break;default:throw Error(t(329))}}}return Sr(r,dt()),r.callbackNode===c?Xg.bind(null,r):null}function zh(r,i){var c=Tl;return r.current.memoizedState.isDehydrated&&(Ta(r,i).flags|=256),r=au(r,i),r!==2&&(i=Tr,Tr=c,i!==null&&Bh(i)),r}function Bh(r){Tr===null?Tr=r:Tr.push.apply(Tr,r)}function iE(r){for(var i=r;;){if(i.flags&16384){var c=i.updateQueue;if(c!==null&&(c=c.stores,c!==null))for(var h=0;h<c.length;h++){var p=c[h],y=p.getSnapshot;p=p.value;try{if(!hs(y(),p))return!1}catch{return!1}}}if(c=i.child,i.subtreeFlags&16384&&c!==null)c.return=i,i=c;else{if(i===r)break;for(;i.sibling===null;){if(i.return===null||i.return===r)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Li(r,i){for(i&=~Mh,i&=~eu,r.suspendedLanes|=i,r.pingedLanes&=~i,r=r.expirationTimes;0<i;){var c=31-ne(i),h=1<<c;r[c]=-1,i&=~h}}function Zg(r){if((bt&6)!==0)throw Error(t(327));wo();var i=ht(r,0);if((i&1)===0)return Sr(r,dt()),null;var c=au(r,i);if(r.tag!==0&&c===2){var h=Dn(r);h!==0&&(i=h,c=zh(r,h))}if(c===1)throw c=El,Ta(r,0),Li(r,i),Sr(r,dt()),c;if(c===6)throw Error(t(345));return r.finishedWork=r.current.alternate,r.finishedLanes=i,Sa(r,Tr,oi),Sr(r,dt()),null}function $h(r,i){var c=bt;bt|=1;try{return r(i)}finally{bt=c,bt===0&&(_o=dt()+500,kc&&Pi())}}function Ea(r){ki!==null&&ki.tag===0&&(bt&6)===0&&wo();var i=bt;bt|=1;var c=Jr.transition,h=pt;try{if(Jr.transition=null,pt=1,r)return r()}finally{pt=h,Jr.transition=c,bt=i,(bt&6)===0&&Pi()}}function Wh(){Ur=vo.current,zt(vo)}function Ta(r,i){r.finishedWork=null,r.finishedLanes=0;var c=r.timeoutHandle;if(c!==-1&&(r.timeoutHandle=-1,Lx(c)),gn!==null)for(c=gn.return;c!==null;){var h=c;switch(Zd(h),h.tag){case 1:h=h.type.childContextTypes,h!=null&&Ac();break;case 3:mo(),zt(wr),zt(nr),hh();break;case 5:uh(h);break;case 4:mo();break;case 13:zt(Ht);break;case 19:zt(Ht);break;case 10:ih(h.type._context);break;case 22:case 23:Wh()}c=c.return}if(Mn=r,gn=r=Vi(r.current,null),qn=Ur=i,bn=0,El=null,Mh=eu=xa=0,Tr=Tl=null,va!==null){for(i=0;i<va.length;i++)if(c=va[i],h=c.interleaved,h!==null){c.interleaved=null;var p=h.next,y=c.pending;if(y!==null){var E=y.next;y.next=p,h.next=E}c.pending=h}va=null}return r}function ey(r,i){do{var c=gn;try{if(sh(),$c.current=Hc,Wc){for(var h=Kt.memoizedState;h!==null;){var p=h.queue;p!==null&&(p.pending=null),h=h.next}Wc=!1}if(wa=0,Vn=Sn=Kt=null,gl=!1,yl=0,Vh.current=null,c===null||c.return===null){bn=1,El=i,gn=null;break}e:{var y=r,E=c.return,L=c,G=i;if(i=qn,L.flags|=32768,G!==null&&typeof G=="object"&&typeof G.then=="function"){var se=G,be=L,Pe=be.tag;if((be.mode&1)===0&&(Pe===0||Pe===11||Pe===15)){var xe=be.alternate;xe?(be.updateQueue=xe.updateQueue,be.memoizedState=xe.memoizedState,be.lanes=xe.lanes):(be.updateQueue=null,be.memoizedState=null)}var Ue=bg(E);if(Ue!==null){Ue.flags&=-257,Cg(Ue,E,L,y,i),Ue.mode&1&&Sg(y,se,i),i=Ue,G=se;var We=i.updateQueue;if(We===null){var qe=new Set;qe.add(G),i.updateQueue=qe}else We.add(G);break e}else{if((i&1)===0){Sg(y,se,i),Gh();break e}G=Error(t(426))}}else if(Gt&&L.mode&1){var ln=bg(E);if(ln!==null){(ln.flags&65536)===0&&(ln.flags|=256),Cg(ln,E,L,y,i),nh(go(G,L));break e}}y=G=go(G,L),bn!==4&&(bn=2),Tl===null?Tl=[y]:Tl.push(y),y=E;do{switch(y.tag){case 3:y.flags|=65536,i&=-i,y.lanes|=i;var ee=Eg(y,G,i);Qm(y,ee);break e;case 1:L=G;var K=y.type,te=y.stateNode;if((y.flags&128)===0&&(typeof K.getDerivedStateFromError=="function"||te!==null&&typeof te.componentDidCatch=="function"&&(ji===null||!ji.has(te)))){y.flags|=65536,i&=-i,y.lanes|=i;var je=Tg(y,L,i);Qm(y,je);break e}}y=y.return}while(y!==null)}ry(c)}catch(Ke){i=Ke,gn===c&&c!==null&&(gn=c=c.return);continue}break}while(!0)}function ty(){var r=Zc.current;return Zc.current=Hc,r===null?Hc:r}function Gh(){(bn===0||bn===3||bn===2)&&(bn=4),Mn===null||(xa&268435455)===0&&(eu&268435455)===0||Li(Mn,qn)}function au(r,i){var c=bt;bt|=2;var h=ty();(Mn!==r||qn!==i)&&(oi=null,Ta(r,i));do try{aE();break}catch(p){ey(r,p)}while(!0);if(sh(),bt=c,Zc.current=h,gn!==null)throw Error(t(261));return Mn=null,qn=0,bn}function aE(){for(;gn!==null;)ny(gn)}function oE(){for(;gn!==null&&!Qs();)ny(gn)}function ny(r){var i=ay(r.alternate,r,Ur);r.memoizedProps=r.pendingProps,i===null?ry(r):gn=i,Vh.current=null}function ry(r){var i=r;do{var c=i.alternate;if(r=i.return,(i.flags&32768)===0){if(c=Zx(c,i,Ur),c!==null){gn=c;return}}else{if(c=eE(c,i),c!==null){c.flags&=32767,gn=c;return}if(r!==null)r.flags|=32768,r.subtreeFlags=0,r.deletions=null;else{bn=6,gn=null;return}}if(i=i.sibling,i!==null){gn=i;return}gn=i=r}while(i!==null);bn===0&&(bn=5)}function Sa(r,i,c){var h=pt,p=Jr.transition;try{Jr.transition=null,pt=1,lE(r,i,c,h)}finally{Jr.transition=p,pt=h}return null}function lE(r,i,c,h){do wo();while(ki!==null);if((bt&6)!==0)throw Error(t(327));c=r.finishedWork;var p=r.finishedLanes;if(c===null)return null;if(r.finishedWork=null,r.finishedLanes=0,c===r.current)throw Error(t(177));r.callbackNode=null,r.callbackPriority=0;var y=c.lanes|c.childLanes;if(Rt(r,y),r===Mn&&(gn=Mn=null,qn=0),(c.subtreeFlags&2064)===0&&(c.flags&2064)===0||nu||(nu=!0,oy(x,function(){return wo(),null})),y=(c.flags&15990)!==0,(c.subtreeFlags&15990)!==0||y){y=Jr.transition,Jr.transition=null;var E=pt;pt=1;var L=bt;bt|=4,Vh.current=null,nE(r,c),Hg(c,r),Px(Gd),Ei=!!Wd,Gd=Wd=null,r.current=c,rE(c),Ys(),bt=L,pt=E,Jr.transition=y}else r.current=c;if(nu&&(nu=!1,ki=r,ru=p),y=r.pendingLanes,y===0&&(ji=null),pe(c.stateNode),Sr(r,dt()),i!==null)for(h=r.onRecoverableError,c=0;c<i.length;c++)p=i[c],h(p.value,{componentStack:p.stack,digest:p.digest});if(tu)throw tu=!1,r=Fh,Fh=null,r;return(ru&1)!==0&&r.tag!==0&&wo(),y=r.pendingLanes,(y&1)!==0?r===Uh?Sl++:(Sl=0,Uh=r):Sl=0,Pi(),null}function wo(){if(ki!==null){var r=Rs(ru),i=Jr.transition,c=pt;try{if(Jr.transition=null,pt=16>r?16:r,ki===null)var h=!1;else{if(r=ki,ki=null,ru=0,(bt&6)!==0)throw Error(t(331));var p=bt;for(bt|=4,$e=r.current;$e!==null;){var y=$e,E=y.child;if(($e.flags&16)!==0){var L=y.deletions;if(L!==null){for(var G=0;G<L.length;G++){var se=L[G];for($e=se;$e!==null;){var be=$e;switch(be.tag){case 0:case 11:case 15:xl(8,be,y)}var Pe=be.child;if(Pe!==null)Pe.return=be,$e=Pe;else for(;$e!==null;){be=$e;var xe=be.sibling,Ue=be.return;if(Bg(be),be===se){$e=null;break}if(xe!==null){xe.return=Ue,$e=xe;break}$e=Ue}}}var We=y.alternate;if(We!==null){var qe=We.child;if(qe!==null){We.child=null;do{var ln=qe.sibling;qe.sibling=null,qe=ln}while(qe!==null)}}$e=y}}if((y.subtreeFlags&2064)!==0&&E!==null)E.return=y,$e=E;else e:for(;$e!==null;){if(y=$e,(y.flags&2048)!==0)switch(y.tag){case 0:case 11:case 15:xl(9,y,y.return)}var ee=y.sibling;if(ee!==null){ee.return=y.return,$e=ee;break e}$e=y.return}}var K=r.current;for($e=K;$e!==null;){E=$e;var te=E.child;if((E.subtreeFlags&2064)!==0&&te!==null)te.return=E,$e=te;else e:for(E=K;$e!==null;){if(L=$e,(L.flags&2048)!==0)try{switch(L.tag){case 0:case 11:case 15:Xc(9,L)}}catch(Ke){Xt(L,L.return,Ke)}if(L===E){$e=null;break e}var je=L.sibling;if(je!==null){je.return=L.return,$e=je;break e}$e=L.return}}if(bt=p,Pi(),W&&typeof W.onPostCommitFiberRoot=="function")try{W.onPostCommitFiberRoot(O,r)}catch{}h=!0}return h}finally{pt=c,Jr.transition=i}}return!1}function sy(r,i,c){i=go(c,i),i=Eg(r,i,1),r=Ri(r,i,1),i=gr(),r!==null&&(cs(r,1,i),Sr(r,i))}function Xt(r,i,c){if(r.tag===3)sy(r,r,c);else for(;i!==null;){if(i.tag===3){sy(i,r,c);break}else if(i.tag===1){var h=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(ji===null||!ji.has(h))){r=go(c,r),r=Tg(i,r,1),i=Ri(i,r,1),r=gr(),i!==null&&(cs(i,1,r),Sr(i,r));break}}i=i.return}}function cE(r,i,c){var h=r.pingCache;h!==null&&h.delete(i),i=gr(),r.pingedLanes|=r.suspendedLanes&c,Mn===r&&(qn&c)===c&&(bn===4||bn===3&&(qn&130023424)===qn&&500>dt()-Oh?Ta(r,0):Mh|=c),Sr(r,i)}function iy(r,i){i===0&&((r.mode&1)===0?i=1:(i=rt,rt<<=1,(rt&130023424)===0&&(rt=4194304)));var c=gr();r=si(r,i),r!==null&&(cs(r,i,c),Sr(r,c))}function uE(r){var i=r.memoizedState,c=0;i!==null&&(c=i.retryLane),iy(r,c)}function dE(r,i){var c=0;switch(r.tag){case 13:var h=r.stateNode,p=r.memoizedState;p!==null&&(c=p.retryLane);break;case 19:h=r.stateNode;break;default:throw Error(t(314))}h!==null&&h.delete(i),iy(r,c)}var ay;ay=function(r,i,c){if(r!==null)if(r.memoizedProps!==i.pendingProps||wr.current)Er=!0;else{if((r.lanes&c)===0&&(i.flags&128)===0)return Er=!1,Xx(r,i,c);Er=(r.flags&131072)!==0}else Er=!1,Gt&&(i.flags&1048576)!==0&&Fm(i,Lc,i.index);switch(i.lanes=0,i.tag){case 2:var h=i.type;Yc(r,i),r=i.pendingProps;var p=oo(i,nr.current);po(i,c),p=mh(null,i,h,r,p,c);var y=gh();return i.flags|=1,typeof p=="object"&&p!==null&&typeof p.render=="function"&&p.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,xr(h)?(y=!0,jc(i)):y=!1,i.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,lh(i),p.updater=Kc,i.stateNode=p,p._reactInternals=i,Eh(i,h,r,c),i=Ch(null,i,h,!0,y,c)):(i.tag=0,Gt&&y&&Xd(i),mr(null,i,p,c),i=i.child),i;case 16:h=i.elementType;e:{switch(Yc(r,i),r=i.pendingProps,p=h._init,h=p(h._payload),i.type=h,p=i.tag=fE(h),r=ps(h,r),p){case 0:i=bh(null,i,h,r,c);break e;case 1:i=jg(null,i,h,r,c);break e;case 11:i=Ig(null,i,h,r,c);break e;case 14:i=Pg(null,i,h,ps(h.type,r),c);break e}throw Error(t(306,h,""))}return i;case 0:return h=i.type,p=i.pendingProps,p=i.elementType===h?p:ps(h,p),bh(r,i,h,p,c);case 1:return h=i.type,p=i.pendingProps,p=i.elementType===h?p:ps(h,p),jg(r,i,h,p,c);case 3:e:{if(kg(i),r===null)throw Error(t(387));h=i.pendingProps,y=i.memoizedState,p=y.element,Km(r,i),zc(i,h,null,c);var E=i.memoizedState;if(h=E.element,y.isDehydrated)if(y={element:h,isDehydrated:!1,cache:E.cache,pendingSuspenseBoundaries:E.pendingSuspenseBoundaries,transitions:E.transitions},i.updateQueue.baseState=y,i.memoizedState=y,i.flags&256){p=go(Error(t(423)),i),i=Dg(r,i,h,c,p);break e}else if(h!==p){p=go(Error(t(424)),i),i=Dg(r,i,h,c,p);break e}else for(Fr=bi(i.stateNode.containerInfo.firstChild),Or=i,Gt=!0,fs=null,c=qm(i,null,h,c),i.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{if(uo(),h===p){i=ai(r,i,c);break e}mr(r,i,h,c)}i=i.child}return i;case 5:return Jm(i),r===null&&th(i),h=i.type,p=i.pendingProps,y=r!==null?r.memoizedProps:null,E=p.children,qd(h,p)?E=null:y!==null&&qd(h,y)&&(i.flags|=32),Ag(r,i),mr(r,i,E,c),i.child;case 6:return r===null&&th(i),null;case 13:return Lg(r,i,c);case 4:return ch(i,i.stateNode.containerInfo),h=i.pendingProps,r===null?i.child=ho(i,null,h,c):mr(r,i,h,c),i.child;case 11:return h=i.type,p=i.pendingProps,p=i.elementType===h?p:ps(h,p),Ig(r,i,h,p,c);case 7:return mr(r,i,i.pendingProps,c),i.child;case 8:return mr(r,i,i.pendingProps.children,c),i.child;case 12:return mr(r,i,i.pendingProps.children,c),i.child;case 10:e:{if(h=i.type._context,p=i.pendingProps,y=i.memoizedProps,E=p.value,Vt(Oc,h._currentValue),h._currentValue=E,y!==null)if(hs(y.value,E)){if(y.children===p.children&&!wr.current){i=ai(r,i,c);break e}}else for(y=i.child,y!==null&&(y.return=i);y!==null;){var L=y.dependencies;if(L!==null){E=y.child;for(var G=L.firstContext;G!==null;){if(G.context===h){if(y.tag===1){G=ii(-1,c&-c),G.tag=2;var se=y.updateQueue;if(se!==null){se=se.shared;var be=se.pending;be===null?G.next=G:(G.next=be.next,be.next=G),se.pending=G}}y.lanes|=c,G=y.alternate,G!==null&&(G.lanes|=c),ah(y.return,c,i),L.lanes|=c;break}G=G.next}}else if(y.tag===10)E=y.type===i.type?null:y.child;else if(y.tag===18){if(E=y.return,E===null)throw Error(t(341));E.lanes|=c,L=E.alternate,L!==null&&(L.lanes|=c),ah(E,c,i),E=y.sibling}else E=y.child;if(E!==null)E.return=y;else for(E=y;E!==null;){if(E===i){E=null;break}if(y=E.sibling,y!==null){y.return=E.return,E=y;break}E=E.return}y=E}mr(r,i,p.children,c),i=i.child}return i;case 9:return p=i.type,h=i.pendingProps.children,po(i,c),p=Qr(p),h=h(p),i.flags|=1,mr(r,i,h,c),i.child;case 14:return h=i.type,p=ps(h,i.pendingProps),p=ps(h.type,p),Pg(r,i,h,p,c);case 15:return Ng(r,i,i.type,i.pendingProps,c);case 17:return h=i.type,p=i.pendingProps,p=i.elementType===h?p:ps(h,p),Yc(r,i),i.tag=1,xr(h)?(r=!0,jc(i)):r=!1,po(i,c),wg(i,h,p),Eh(i,h,p,c),Ch(null,i,h,!0,r,c);case 19:return Mg(r,i,c);case 22:return Rg(r,i,c)}throw Error(t(156,i.tag))};function oy(r,i){return ls(r,i)}function hE(r,i,c,h){this.tag=r,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Xr(r,i,c,h){return new hE(r,i,c,h)}function qh(r){return r=r.prototype,!(!r||!r.isReactComponent)}function fE(r){if(typeof r=="function")return qh(r)?1:0;if(r!=null){if(r=r.$$typeof,r===N)return 11;if(r===re)return 14}return 2}function Vi(r,i){var c=r.alternate;return c===null?(c=Xr(r.tag,i,r.key,r.mode),c.elementType=r.elementType,c.type=r.type,c.stateNode=r.stateNode,c.alternate=r,r.alternate=c):(c.pendingProps=i,c.type=r.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=r.flags&14680064,c.childLanes=r.childLanes,c.lanes=r.lanes,c.child=r.child,c.memoizedProps=r.memoizedProps,c.memoizedState=r.memoizedState,c.updateQueue=r.updateQueue,i=r.dependencies,c.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},c.sibling=r.sibling,c.index=r.index,c.ref=r.ref,c}function ou(r,i,c,h,p,y){var E=2;if(h=r,typeof r=="function")qh(r)&&(E=1);else if(typeof r=="string")E=5;else e:switch(r){case I:return ba(c.children,p,y,i);case P:E=8,p|=8;break;case A:return r=Xr(12,c,i,p|2),r.elementType=A,r.lanes=y,r;case b:return r=Xr(13,c,i,p),r.elementType=b,r.lanes=y,r;case J:return r=Xr(19,c,i,p),r.elementType=J,r.lanes=y,r;case de:return lu(c,p,y,i);default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case M:E=10;break e;case D:E=9;break e;case N:E=11;break e;case re:E=14;break e;case Ce:E=16,h=null;break e}throw Error(t(130,r==null?r:typeof r,""))}return i=Xr(E,c,i,p),i.elementType=r,i.type=h,i.lanes=y,i}function ba(r,i,c,h){return r=Xr(7,r,h,i),r.lanes=c,r}function lu(r,i,c,h){return r=Xr(22,r,h,i),r.elementType=de,r.lanes=c,r.stateNode={isHidden:!1},r}function Hh(r,i,c){return r=Xr(6,r,null,i),r.lanes=c,r}function Kh(r,i,c){return i=Xr(4,r.children!==null?r.children:[],r.key,i),i.lanes=c,i.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},i}function pE(r,i,c,h,p){this.tag=i,this.containerInfo=r,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=kr(0),this.expirationTimes=kr(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=kr(0),this.identifierPrefix=h,this.onRecoverableError=p,this.mutableSourceEagerHydrationData=null}function Qh(r,i,c,h,p,y,E,L,G){return r=new pE(r,i,c,L,G),i===1?(i=1,y===!0&&(i|=8)):i=0,y=Xr(3,null,null,i),r.current=y,y.stateNode=r,y.memoizedState={element:h,isDehydrated:c,cache:null,transitions:null,pendingSuspenseBoundaries:null},lh(y),r}function mE(r,i,c){var h=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ae,key:h==null?null:""+h,children:r,containerInfo:i,implementation:c}}function ly(r){if(!r)return Ii;r=r._reactInternals;e:{if(Ft(r)!==r||r.tag!==1)throw Error(t(170));var i=r;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(xr(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(t(171))}if(r.tag===1){var c=r.type;if(xr(c))return Vm(r,c,i)}return i}function cy(r,i,c,h,p,y,E,L,G){return r=Qh(c,h,!0,r,p,y,E,L,G),r.context=ly(null),c=r.current,h=gr(),p=Di(c),y=ii(h,p),y.callback=i??null,Ri(c,y,p),r.current.lanes=p,cs(r,p,h),Sr(r,h),r}function cu(r,i,c,h){var p=i.current,y=gr(),E=Di(p);return c=ly(c),i.context===null?i.context=c:i.pendingContext=c,i=ii(y,E),i.payload={element:r},h=h===void 0?null:h,h!==null&&(i.callback=h),r=Ri(p,i,E),r!==null&&(ys(r,p,E,y),Uc(r,p,E)),E}function uu(r){if(r=r.current,!r.child)return null;switch(r.child.tag){case 5:return r.child.stateNode;default:return r.child.stateNode}}function uy(r,i){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var c=r.retryLane;r.retryLane=c!==0&&c<i?c:i}}function Yh(r,i){uy(r,i),(r=r.alternate)&&uy(r,i)}function gE(){return null}var dy=typeof reportError=="function"?reportError:function(r){console.error(r)};function Jh(r){this._internalRoot=r}du.prototype.render=Jh.prototype.render=function(r){var i=this._internalRoot;if(i===null)throw Error(t(409));cu(r,i,null,null)},du.prototype.unmount=Jh.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var i=r.containerInfo;Ea(function(){cu(null,r,null,null)}),i[ei]=null}};function du(r){this._internalRoot=r}du.prototype.unstable_scheduleHydration=function(r){if(r){var i=he();r={blockedOn:null,target:r,priority:i};for(var c=0;c<an.length&&i!==0&&i<an[c].priority;c++);an.splice(c,0,r),c===0&&Gr(r)}};function Xh(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function hu(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11&&(r.nodeType!==8||r.nodeValue!==" react-mount-point-unstable "))}function hy(){}function yE(r,i,c,h,p){if(p){if(typeof h=="function"){var y=h;h=function(){var se=uu(E);y.call(se)}}var E=cy(i,h,r,0,null,!1,!1,"",hy);return r._reactRootContainer=E,r[ei]=E.current,ll(r.nodeType===8?r.parentNode:r),Ea(),E}for(;p=r.lastChild;)r.removeChild(p);if(typeof h=="function"){var L=h;h=function(){var se=uu(G);L.call(se)}}var G=Qh(r,0,!1,null,null,!1,!1,"",hy);return r._reactRootContainer=G,r[ei]=G.current,ll(r.nodeType===8?r.parentNode:r),Ea(function(){cu(i,G,c,h)}),G}function fu(r,i,c,h,p){var y=c._reactRootContainer;if(y){var E=y;if(typeof p=="function"){var L=p;p=function(){var G=uu(E);L.call(G)}}cu(i,E,r,p)}else E=yE(c,i,r,p,h);return uu(E)}S=function(r){switch(r.tag){case 3:var i=r.stateNode;if(i.current.memoizedState.isDehydrated){var c=Re(i.pendingLanes);c!==0&&(Ns(i,c|1),Sr(i,dt()),(bt&6)===0&&(_o=dt()+500,Pi()))}break;case 13:Ea(function(){var h=si(r,1);if(h!==null){var p=gr();ys(h,r,1,p)}}),Yh(r,1)}},B=function(r){if(r.tag===13){var i=si(r,134217728);if(i!==null){var c=gr();ys(i,r,134217728,c)}Yh(r,134217728)}},Q=function(r){if(r.tag===13){var i=Di(r),c=si(r,i);if(c!==null){var h=gr();ys(c,r,i,h)}Yh(r,i)}},he=function(){return pt},Ie=function(r,i){var c=pt;try{return pt=r,i()}finally{pt=c}},bs=function(r,i,c){switch(i){case"input":if(Ct(r,c),i=c.name,c.type==="radio"&&i!=null){for(c=r;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<c.length;i++){var h=c[i];if(h!==r&&h.form===r.form){var p=Rc(h);if(!p)throw Error(t(90));Ve(h),Ct(h,p)}}}break;case"textarea":rn(r,c);break;case"select":i=c.value,i!=null&&tn(r,!!c.multiple,i,!1)}},Zn=$h,qs=Ea;var vE={usingClientEntryPoint:!1,Events:[dl,io,Rc,Rn,Ar,$h]},bl={findFiberByHostInstance:pa,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},_E={bundleType:bl.bundleType,version:bl.version,rendererPackageName:bl.rendererPackageName,rendererConfig:bl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:we.ReactCurrentDispatcher,findHostInstanceByFiber:function(r){return r=Ks(r),r===null?null:r.stateNode},findFiberByHostInstance:bl.findFiberByHostInstance||gE,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var pu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!pu.isDisabled&&pu.supportsFiber)try{O=pu.inject(_E),W=pu}catch{}}return br.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=vE,br.createPortal=function(r,i){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Xh(i))throw Error(t(200));return mE(r,i,null,c)},br.createRoot=function(r,i){if(!Xh(r))throw Error(t(299));var c=!1,h="",p=dy;return i!=null&&(i.unstable_strictMode===!0&&(c=!0),i.identifierPrefix!==void 0&&(h=i.identifierPrefix),i.onRecoverableError!==void 0&&(p=i.onRecoverableError)),i=Qh(r,1,!1,null,null,c,!1,h,p),r[ei]=i.current,ll(r.nodeType===8?r.parentNode:r),new Jh(i)},br.findDOMNode=function(r){if(r==null)return null;if(r.nodeType===1)return r;var i=r._reactInternals;if(i===void 0)throw typeof r.render=="function"?Error(t(188)):(r=Object.keys(r).join(","),Error(t(268,r)));return r=Ks(i),r=r===null?null:r.stateNode,r},br.flushSync=function(r){return Ea(r)},br.hydrate=function(r,i,c){if(!hu(i))throw Error(t(200));return fu(null,r,i,!0,c)},br.hydrateRoot=function(r,i,c){if(!Xh(r))throw Error(t(405));var h=c!=null&&c.hydratedSources||null,p=!1,y="",E=dy;if(c!=null&&(c.unstable_strictMode===!0&&(p=!0),c.identifierPrefix!==void 0&&(y=c.identifierPrefix),c.onRecoverableError!==void 0&&(E=c.onRecoverableError)),i=cy(i,null,r,1,c??null,p,!1,y,E),r[ei]=i.current,ll(r),h)for(r=0;r<h.length;r++)c=h[r],p=c._getVersion,p=p(c._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[c,p]:i.mutableSourceEagerHydrationData.push(c,p);return new du(i)},br.render=function(r,i,c){if(!hu(i))throw Error(t(200));return fu(null,r,i,!1,c)},br.unmountComponentAtNode=function(r){if(!hu(r))throw Error(t(40));return r._reactRootContainer?(Ea(function(){fu(null,null,r,!1,function(){r._reactRootContainer=null,r[ei]=null})}),!0):!1},br.unstable_batchedUpdates=$h,br.unstable_renderSubtreeIntoContainer=function(r,i,c,h){if(!hu(c))throw Error(t(200));if(r==null||r._reactInternals===void 0)throw Error(t(38));return fu(r,i,c,!1,h)},br.version="18.3.1-next-f1338f8080-20240426",br}var wy;function P_(){if(wy)return tf.exports;wy=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),tf.exports=PE(),tf.exports}var xy;function NE(){if(xy)return mu;xy=1;var n=P_();return mu.createRoot=n.createRoot,mu.hydrateRoot=n.hydrateRoot,mu}var RE=NE();const AE=Zf(RE);P_();/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Bl(){return Bl=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},Bl.apply(this,arguments)}var $i;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})($i||($i={}));const Ey="popstate";function jE(n){n===void 0&&(n={});function e(s,a){let{pathname:l,search:d,hash:f}=s.location;return wf("",{pathname:l,search:d,hash:f},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(s,a){return typeof a=="string"?a:Mu(a)}return DE(e,t,null,n)}function un(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function np(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function kE(){return Math.random().toString(36).substr(2,8)}function Ty(n,e){return{usr:n.state,key:n.key,idx:e}}function wf(n,e,t,s){return t===void 0&&(t=null),Bl({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?Fo(e):e,{state:t,key:e&&e.key||s||kE()})}function Mu(n){let{pathname:e="/",search:t="",hash:s=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),s&&s!=="#"&&(e+=s.charAt(0)==="#"?s:"#"+s),e}function Fo(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let s=n.indexOf("?");s>=0&&(e.search=n.substr(s),n=n.substr(0,s)),n&&(e.pathname=n)}return e}function DE(n,e,t,s){s===void 0&&(s={});let{window:a=document.defaultView,v5Compat:l=!1}=s,d=a.history,f=$i.Pop,m=null,v=w();v==null&&(v=0,d.replaceState(Bl({},d.state,{idx:v}),""));function w(){return(d.state||{idx:null}).idx}function T(){f=$i.Pop;let F=w(),ie=F==null?null:F-v;v=F,m&&m({action:f,location:q.location,delta:ie})}function C(F,ie){f=$i.Push;let Se=wf(q.location,F,ie);v=w()+1;let Ee=Ty(Se,v),we=q.createHref(Se);try{d.pushState(Ee,"",we)}catch(V){if(V instanceof DOMException&&V.name==="DataCloneError")throw V;a.location.assign(we)}l&&m&&m({action:f,location:q.location,delta:1})}function U(F,ie){f=$i.Replace;let Se=wf(q.location,F,ie);v=w();let Ee=Ty(Se,v),we=q.createHref(Se);d.replaceState(Ee,"",we),l&&m&&m({action:f,location:q.location,delta:0})}function X(F){let ie=a.location.origin!=="null"?a.location.origin:a.location.href,Se=typeof F=="string"?F:Mu(F);return Se=Se.replace(/ $/,"%20"),un(ie,"No window.location.(origin|href) available to create URL for href: "+Se),new URL(Se,ie)}let q={get action(){return f},get location(){return n(a,d)},listen(F){if(m)throw new Error("A history only accepts one active listener");return a.addEventListener(Ey,T),m=F,()=>{a.removeEventListener(Ey,T),m=null}},createHref(F){return e(a,F)},createURL:X,encodeLocation(F){let ie=X(F);return{pathname:ie.pathname,search:ie.search,hash:ie.hash}},push:C,replace:U,go(F){return d.go(F)}};return q}var Sy;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(Sy||(Sy={}));function LE(n,e,t){return t===void 0&&(t="/"),VE(n,e,t)}function VE(n,e,t,s){let a=typeof e=="string"?Fo(e):e,l=rp(a.pathname||"/",t);if(l==null)return null;let d=N_(n);ME(d);let f=null;for(let m=0;f==null&&m<d.length;++m){let v=QE(l);f=qE(d[m],v)}return f}function N_(n,e,t,s){e===void 0&&(e=[]),t===void 0&&(t=[]),s===void 0&&(s="");let a=(l,d,f)=>{let m={relativePath:f===void 0?l.path||"":f,caseSensitive:l.caseSensitive===!0,childrenIndex:d,route:l};m.relativePath.startsWith("/")&&(un(m.relativePath.startsWith(s),'Absolute route path "'+m.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),m.relativePath=m.relativePath.slice(s.length));let v=qi([s,m.relativePath]),w=t.concat(m);l.children&&l.children.length>0&&(un(l.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+v+'".')),N_(l.children,e,w,v)),!(l.path==null&&!l.index)&&e.push({path:v,score:WE(v,l.index),routesMeta:w})};return n.forEach((l,d)=>{var f;if(l.path===""||!((f=l.path)!=null&&f.includes("?")))a(l,d);else for(let m of R_(l.path))a(l,d,m)}),e}function R_(n){let e=n.split("/");if(e.length===0)return[];let[t,...s]=e,a=t.endsWith("?"),l=t.replace(/\?$/,"");if(s.length===0)return a?[l,""]:[l];let d=R_(s.join("/")),f=[];return f.push(...d.map(m=>m===""?l:[l,m].join("/"))),a&&f.push(...d),f.map(m=>n.startsWith("/")&&m===""?"/":m)}function ME(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:GE(e.routesMeta.map(s=>s.childrenIndex),t.routesMeta.map(s=>s.childrenIndex)))}const OE=/^:[\w-]+$/,FE=3,UE=2,zE=1,BE=10,$E=-2,by=n=>n==="*";function WE(n,e){let t=n.split("/"),s=t.length;return t.some(by)&&(s+=$E),e&&(s+=UE),t.filter(a=>!by(a)).reduce((a,l)=>a+(OE.test(l)?FE:l===""?zE:BE),s)}function GE(n,e){return n.length===e.length&&n.slice(0,-1).every((s,a)=>s===e[a])?n[n.length-1]-e[e.length-1]:0}function qE(n,e,t){let{routesMeta:s}=n,a={},l="/",d=[];for(let f=0;f<s.length;++f){let m=s[f],v=f===s.length-1,w=l==="/"?e:e.slice(l.length)||"/",T=HE({path:m.relativePath,caseSensitive:m.caseSensitive,end:v},w),C=m.route;if(!T)return null;Object.assign(a,T.params),d.push({params:a,pathname:qi([l,T.pathname]),pathnameBase:eT(qi([l,T.pathnameBase])),route:C}),T.pathnameBase!=="/"&&(l=qi([l,T.pathnameBase]))}return d}function HE(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,s]=KE(n.path,n.caseSensitive,n.end),a=e.match(t);if(!a)return null;let l=a[0],d=l.replace(/(.)\/+$/,"$1"),f=a.slice(1);return{params:s.reduce((v,w,T)=>{let{paramName:C,isOptional:U}=w;if(C==="*"){let q=f[T]||"";d=l.slice(0,l.length-q.length).replace(/(.)\/+$/,"$1")}const X=f[T];return U&&!X?v[C]=void 0:v[C]=(X||"").replace(/%2F/g,"/"),v},{}),pathname:l,pathnameBase:d,pattern:n}}function KE(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),np(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let s=[],a="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,f,m)=>(s.push({paramName:f,isOptional:m!=null}),m?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(s.push({paramName:"*"}),a+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?a+="\\/*$":n!==""&&n!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),s]}function QE(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return np(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function rp(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,s=n.charAt(t);return s&&s!=="/"?null:n.slice(t)||"/"}const YE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,JE=n=>YE.test(n);function XE(n,e){e===void 0&&(e="/");let{pathname:t,search:s="",hash:a=""}=typeof n=="string"?Fo(n):n,l;if(t)if(JE(t))l=t;else{if(t.includes("//")){let d=t;t=t.replace(/\/\/+/g,"/"),np(!1,"Pathnames cannot have embedded double slashes - normalizing "+(d+" -> "+t))}t.startsWith("/")?l=Cy(t.substring(1),"/"):l=Cy(t,e)}else l=e;return{pathname:l,search:tT(s),hash:nT(a)}}function Cy(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(a=>{a===".."?t.length>1&&t.pop():a!=="."&&t.push(a)}),t.length>1?t.join("/"):"/"}function sf(n,e,t,s){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function ZE(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function sp(n,e){let t=ZE(n);return e?t.map((s,a)=>a===t.length-1?s.pathname:s.pathnameBase):t.map(s=>s.pathnameBase)}function ip(n,e,t,s){s===void 0&&(s=!1);let a;typeof n=="string"?a=Fo(n):(a=Bl({},n),un(!a.pathname||!a.pathname.includes("?"),sf("?","pathname","search",a)),un(!a.pathname||!a.pathname.includes("#"),sf("#","pathname","hash",a)),un(!a.search||!a.search.includes("#"),sf("#","search","hash",a)));let l=n===""||a.pathname==="",d=l?"/":a.pathname,f;if(d==null)f=t;else{let T=e.length-1;if(!s&&d.startsWith("..")){let C=d.split("/");for(;C[0]==="..";)C.shift(),T-=1;a.pathname=C.join("/")}f=T>=0?e[T]:"/"}let m=XE(a,f),v=d&&d!=="/"&&d.endsWith("/"),w=(l||d===".")&&t.endsWith("/");return!m.pathname.endsWith("/")&&(v||w)&&(m.pathname+="/"),m}const qi=n=>n.join("/").replace(/\/\/+/g,"/"),eT=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),tT=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,nT=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function rT(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const A_=["post","put","patch","delete"];new Set(A_);const sT=["get",...A_];new Set(sT);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function $l(){return $l=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},$l.apply(this,arguments)}const ap=j.createContext(null),iT=j.createContext(null),ia=j.createContext(null),rd=j.createContext(null),aa=j.createContext({outlet:null,matches:[],isDataRoute:!1}),j_=j.createContext(null);function aT(n,e){let{relative:t}=e===void 0?{}:e;Uo()||un(!1);let{basename:s,navigator:a}=j.useContext(ia),{hash:l,pathname:d,search:f}=D_(n,{relative:t}),m=d;return s!=="/"&&(m=d==="/"?s:qi([s,d])),a.createHref({pathname:m,search:f,hash:l})}function Uo(){return j.useContext(rd)!=null}function zo(){return Uo()||un(!1),j.useContext(rd).location}function k_(n){j.useContext(ia).static||j.useLayoutEffect(n)}function tc(){let{isDataRoute:n}=j.useContext(aa);return n?_T():oT()}function oT(){Uo()||un(!1);let n=j.useContext(ap),{basename:e,future:t,navigator:s}=j.useContext(ia),{matches:a}=j.useContext(aa),{pathname:l}=zo(),d=JSON.stringify(sp(a,t.v7_relativeSplatPath)),f=j.useRef(!1);return k_(()=>{f.current=!0}),j.useCallback(function(v,w){if(w===void 0&&(w={}),!f.current)return;if(typeof v=="number"){s.go(v);return}let T=ip(v,JSON.parse(d),l,w.relative==="path");n==null&&e!=="/"&&(T.pathname=T.pathname==="/"?e:qi([e,T.pathname])),(w.replace?s.replace:s.push)(T,w.state,w)},[e,s,d,l,n])}function D_(n,e){let{relative:t}=e===void 0?{}:e,{future:s}=j.useContext(ia),{matches:a}=j.useContext(aa),{pathname:l}=zo(),d=JSON.stringify(sp(a,s.v7_relativeSplatPath));return j.useMemo(()=>ip(n,JSON.parse(d),l,t==="path"),[n,d,l,t])}function lT(n,e){return cT(n,e)}function cT(n,e,t,s){Uo()||un(!1);let{navigator:a}=j.useContext(ia),{matches:l}=j.useContext(aa),d=l[l.length-1],f=d?d.params:{};d&&d.pathname;let m=d?d.pathnameBase:"/";d&&d.route;let v=zo(),w;if(e){var T;let F=typeof e=="string"?Fo(e):e;m==="/"||(T=F.pathname)!=null&&T.startsWith(m)||un(!1),w=F}else w=v;let C=w.pathname||"/",U=C;if(m!=="/"){let F=m.replace(/^\//,"").split("/");U="/"+C.replace(/^\//,"").split("/").slice(F.length).join("/")}let X=LE(n,{pathname:U}),q=pT(X&&X.map(F=>Object.assign({},F,{params:Object.assign({},f,F.params),pathname:qi([m,a.encodeLocation?a.encodeLocation(F.pathname).pathname:F.pathname]),pathnameBase:F.pathnameBase==="/"?m:qi([m,a.encodeLocation?a.encodeLocation(F.pathnameBase).pathname:F.pathnameBase])})),l,t,s);return e&&q?j.createElement(rd.Provider,{value:{location:$l({pathname:"/",search:"",hash:"",state:null,key:"default"},w),navigationType:$i.Pop}},q):q}function uT(){let n=vT(),e=rT(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return j.createElement(j.Fragment,null,j.createElement("h2",null,"Unexpected Application Error!"),j.createElement("h3",{style:{fontStyle:"italic"}},e),t?j.createElement("pre",{style:a},t):null,null)}const dT=j.createElement(uT,null);class hT extends j.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?j.createElement(aa.Provider,{value:this.props.routeContext},j.createElement(j_.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function fT(n){let{routeContext:e,match:t,children:s}=n,a=j.useContext(ap);return a&&a.static&&a.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=t.route.id),j.createElement(aa.Provider,{value:e},s)}function pT(n,e,t,s){var a;if(e===void 0&&(e=[]),t===void 0&&(t=null),s===void 0&&(s=null),n==null){var l;if(!t)return null;if(t.errors)n=t.matches;else if((l=s)!=null&&l.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let d=n,f=(a=t)==null?void 0:a.errors;if(f!=null){let w=d.findIndex(T=>T.route.id&&(f==null?void 0:f[T.route.id])!==void 0);w>=0||un(!1),d=d.slice(0,Math.min(d.length,w+1))}let m=!1,v=-1;if(t&&s&&s.v7_partialHydration)for(let w=0;w<d.length;w++){let T=d[w];if((T.route.HydrateFallback||T.route.hydrateFallbackElement)&&(v=w),T.route.id){let{loaderData:C,errors:U}=t,X=T.route.loader&&C[T.route.id]===void 0&&(!U||U[T.route.id]===void 0);if(T.route.lazy||X){m=!0,v>=0?d=d.slice(0,v+1):d=[d[0]];break}}}return d.reduceRight((w,T,C)=>{let U,X=!1,q=null,F=null;t&&(U=f&&T.route.id?f[T.route.id]:void 0,q=T.route.errorElement||dT,m&&(v<0&&C===0?(wT("route-fallback"),X=!0,F=null):v===C&&(X=!0,F=T.route.hydrateFallbackElement||null)));let ie=e.concat(d.slice(0,C+1)),Se=()=>{let Ee;return U?Ee=q:X?Ee=F:T.route.Component?Ee=j.createElement(T.route.Component,null):T.route.element?Ee=T.route.element:Ee=w,j.createElement(fT,{match:T,routeContext:{outlet:w,matches:ie,isDataRoute:t!=null},children:Ee})};return t&&(T.route.ErrorBoundary||T.route.errorElement||C===0)?j.createElement(hT,{location:t.location,revalidation:t.revalidation,component:q,error:U,children:Se(),routeContext:{outlet:null,matches:ie,isDataRoute:!0}}):Se()},null)}var L_=(function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n})(L_||{}),V_=(function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n})(V_||{});function mT(n){let e=j.useContext(ap);return e||un(!1),e}function gT(n){let e=j.useContext(iT);return e||un(!1),e}function yT(n){let e=j.useContext(aa);return e||un(!1),e}function M_(n){let e=yT(),t=e.matches[e.matches.length-1];return t.route.id||un(!1),t.route.id}function vT(){var n;let e=j.useContext(j_),t=gT(),s=M_();return e!==void 0?e:(n=t.errors)==null?void 0:n[s]}function _T(){let{router:n}=mT(L_.UseNavigateStable),e=M_(V_.UseNavigateStable),t=j.useRef(!1);return k_(()=>{t.current=!0}),j.useCallback(function(a,l){l===void 0&&(l={}),t.current&&(typeof a=="number"?n.navigate(a):n.navigate(a,$l({fromRouteId:e},l)))},[n,e])}const Iy={};function wT(n,e,t){Iy[n]||(Iy[n]=!0)}function xT(n,e){n==null||n.v7_startTransition,n==null||n.v7_relativeSplatPath}function xf(n){let{to:e,replace:t,state:s,relative:a}=n;Uo()||un(!1);let{future:l,static:d}=j.useContext(ia),{matches:f}=j.useContext(aa),{pathname:m}=zo(),v=tc(),w=ip(e,sp(f,l.v7_relativeSplatPath),m,a==="path"),T=JSON.stringify(w);return j.useEffect(()=>v(JSON.parse(T),{replace:t,state:s,relative:a}),[v,T,a,t,s]),null}function Zr(n){un(!1)}function ET(n){let{basename:e="/",children:t=null,location:s,navigationType:a=$i.Pop,navigator:l,static:d=!1,future:f}=n;Uo()&&un(!1);let m=e.replace(/^\/*/,"/"),v=j.useMemo(()=>({basename:m,navigator:l,static:d,future:$l({v7_relativeSplatPath:!1},f)}),[m,f,l,d]);typeof s=="string"&&(s=Fo(s));let{pathname:w="/",search:T="",hash:C="",state:U=null,key:X="default"}=s,q=j.useMemo(()=>{let F=rp(w,m);return F==null?null:{location:{pathname:F,search:T,hash:C,state:U,key:X},navigationType:a}},[m,w,T,C,U,X,a]);return q==null?null:j.createElement(ia.Provider,{value:v},j.createElement(rd.Provider,{children:t,value:q}))}function TT(n){let{children:e,location:t}=n;return lT(Ef(e),t)}new Promise(()=>{});function Ef(n,e){e===void 0&&(e=[]);let t=[];return j.Children.forEach(n,(s,a)=>{if(!j.isValidElement(s))return;let l=[...e,a];if(s.type===j.Fragment){t.push.apply(t,Ef(s.props.children,l));return}s.type!==Zr&&un(!1),!s.props.index||!s.props.children||un(!1);let d={id:s.props.id||l.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(d.children=Ef(s.props.children,l)),t.push(d)}),t}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Tf(){return Tf=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},Tf.apply(this,arguments)}function ST(n,e){if(n==null)return{};var t={},s=Object.keys(n),a,l;for(l=0;l<s.length;l++)a=s[l],!(e.indexOf(a)>=0)&&(t[a]=n[a]);return t}function bT(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function CT(n,e){return n.button===0&&(!e||e==="_self")&&!bT(n)}function Sf(n){return n===void 0&&(n=""),new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((e,t)=>{let s=n[t];return e.concat(Array.isArray(s)?s.map(a=>[t,a]):[[t,s]])},[]))}function IT(n,e){let t=Sf(n);return e&&e.forEach((s,a)=>{t.has(a)||e.getAll(a).forEach(l=>{t.append(a,l)})}),t}const PT=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],NT="6";try{window.__reactRouterVersion=NT}catch{}const RT="startTransition",Py=bE[RT];function AT(n){let{basename:e,children:t,future:s,window:a}=n,l=j.useRef();l.current==null&&(l.current=jE({window:a,v5Compat:!0}));let d=l.current,[f,m]=j.useState({action:d.action,location:d.location}),{v7_startTransition:v}=s||{},w=j.useCallback(T=>{v&&Py?Py(()=>m(T)):m(T)},[m,v]);return j.useLayoutEffect(()=>d.listen(w),[d,w]),j.useEffect(()=>xT(s),[s]),j.createElement(ET,{basename:e,children:t,location:f.location,navigationType:f.action,navigator:d,future:s})}const jT=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",kT=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Oi=j.forwardRef(function(e,t){let{onClick:s,relative:a,reloadDocument:l,replace:d,state:f,target:m,to:v,preventScrollReset:w,viewTransition:T}=e,C=ST(e,PT),{basename:U}=j.useContext(ia),X,q=!1;if(typeof v=="string"&&kT.test(v)&&(X=v,jT))try{let Ee=new URL(window.location.href),we=v.startsWith("//")?new URL(Ee.protocol+v):new URL(v),V=rp(we.pathname,U);we.origin===Ee.origin&&V!=null?v=V+we.search+we.hash:q=!0}catch{}let F=aT(v,{relative:a}),ie=DT(v,{replace:d,state:f,target:m,preventScrollReset:w,relative:a,viewTransition:T});function Se(Ee){s&&s(Ee),Ee.defaultPrevented||ie(Ee)}return j.createElement("a",Tf({},C,{href:X||F,onClick:q||l?s:Se,ref:t,target:m}))});var Ny;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(Ny||(Ny={}));var Ry;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(Ry||(Ry={}));function DT(n,e){let{target:t,replace:s,state:a,preventScrollReset:l,relative:d,viewTransition:f}=e===void 0?{}:e,m=tc(),v=zo(),w=D_(n,{relative:d});return j.useCallback(T=>{if(CT(T,t)){T.preventDefault();let C=s!==void 0?s:Mu(v)===Mu(w);m(n,{replace:C,state:a,preventScrollReset:l,relative:d,viewTransition:f})}},[v,m,w,s,a,t,n,l,d,f])}function LT(n){let e=j.useRef(Sf(n)),t=j.useRef(!1),s=zo(),a=j.useMemo(()=>IT(s.search,t.current?null:e.current),[s.search]),l=tc(),d=j.useCallback((f,m)=>{const v=Sf(typeof f=="function"?f(a):f);t.current=!0,l("?"+v,m)},[l,a]);return[a,d]}const VT=()=>{};var Ay={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O_=function(n){const e=[];let t=0;for(let s=0;s<n.length;s++){let a=n.charCodeAt(s);a<128?e[t++]=a:a<2048?(e[t++]=a>>6|192,e[t++]=a&63|128):(a&64512)===55296&&s+1<n.length&&(n.charCodeAt(s+1)&64512)===56320?(a=65536+((a&1023)<<10)+(n.charCodeAt(++s)&1023),e[t++]=a>>18|240,e[t++]=a>>12&63|128,e[t++]=a>>6&63|128,e[t++]=a&63|128):(e[t++]=a>>12|224,e[t++]=a>>6&63|128,e[t++]=a&63|128)}return e},MT=function(n){const e=[];let t=0,s=0;for(;t<n.length;){const a=n[t++];if(a<128)e[s++]=String.fromCharCode(a);else if(a>191&&a<224){const l=n[t++];e[s++]=String.fromCharCode((a&31)<<6|l&63)}else if(a>239&&a<365){const l=n[t++],d=n[t++],f=n[t++],m=((a&7)<<18|(l&63)<<12|(d&63)<<6|f&63)-65536;e[s++]=String.fromCharCode(55296+(m>>10)),e[s++]=String.fromCharCode(56320+(m&1023))}else{const l=n[t++],d=n[t++];e[s++]=String.fromCharCode((a&15)<<12|(l&63)<<6|d&63)}}return e.join("")},F_={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let a=0;a<n.length;a+=3){const l=n[a],d=a+1<n.length,f=d?n[a+1]:0,m=a+2<n.length,v=m?n[a+2]:0,w=l>>2,T=(l&3)<<4|f>>4;let C=(f&15)<<2|v>>6,U=v&63;m||(U=64,d||(C=64)),s.push(t[w],t[T],t[C],t[U])}return s.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(O_(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):MT(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let a=0;a<n.length;){const l=t[n.charAt(a++)],f=a<n.length?t[n.charAt(a)]:0;++a;const v=a<n.length?t[n.charAt(a)]:64;++a;const T=a<n.length?t[n.charAt(a)]:64;if(++a,l==null||f==null||v==null||T==null)throw new OT;const C=l<<2|f>>4;if(s.push(C),v!==64){const U=f<<4&240|v>>2;if(s.push(U),T!==64){const X=v<<6&192|T;s.push(X)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class OT extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const FT=function(n){const e=O_(n);return F_.encodeByteArray(e,!0)},Ou=function(n){return FT(n).replace(/\./g,"")},U_=function(n){try{return F_.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UT(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zT=()=>UT().__FIREBASE_DEFAULTS__,BT=()=>{if(typeof process>"u"||typeof Ay>"u")return;const n=Ay.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},$T=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&U_(n[1]);return e&&JSON.parse(e)},sd=()=>{try{return VT()||zT()||BT()||$T()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},z_=n=>{var e,t;return(t=(e=sd())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},WT=n=>{const e=z_(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),s]:[e.substring(0,t),s]},B_=()=>{var n;return(n=sd())===null||n===void 0?void 0:n.config},$_=n=>{var e;return(e=sd())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GT{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,s)=>{t?this.reject(t):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,s))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bo(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function W_(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qT(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},s=e||"demo-project",a=n.iat||0,l=n.sub||n.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d=Object.assign({iss:`https://securetoken.google.com/${s}`,aud:s,iat:a,exp:a+3600,auth_time:a,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Ou(JSON.stringify(t)),Ou(JSON.stringify(d)),""].join(".")}const Ll={};function HT(){const n={prod:[],emulator:[]};for(const e of Object.keys(Ll))Ll[e]?n.emulator.push(e):n.prod.push(e);return n}function KT(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let jy=!1;function G_(n,e){if(typeof window>"u"||typeof document>"u"||!Bo(window.location.host)||Ll[n]===e||Ll[n]||jy)return;Ll[n]=e;function t(C){return`__firebase__banner__${C}`}const s="__firebase__banner",l=HT().prod.length>0;function d(){const C=document.getElementById(s);C&&C.remove()}function f(C){C.style.display="flex",C.style.background="#7faaf0",C.style.position="fixed",C.style.bottom="5px",C.style.left="5px",C.style.padding=".5em",C.style.borderRadius="5px",C.style.alignItems="center"}function m(C,U){C.setAttribute("width","24"),C.setAttribute("id",U),C.setAttribute("height","24"),C.setAttribute("viewBox","0 0 24 24"),C.setAttribute("fill","none"),C.style.marginLeft="-6px"}function v(){const C=document.createElement("span");return C.style.cursor="pointer",C.style.marginLeft="16px",C.style.fontSize="24px",C.innerHTML=" &times;",C.onclick=()=>{jy=!0,d()},C}function w(C,U){C.setAttribute("id",U),C.innerText="Learn more",C.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",C.setAttribute("target","__blank"),C.style.paddingLeft="5px",C.style.textDecoration="underline"}function T(){const C=KT(s),U=t("text"),X=document.getElementById(U)||document.createElement("span"),q=t("learnmore"),F=document.getElementById(q)||document.createElement("a"),ie=t("preprendIcon"),Se=document.getElementById(ie)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(C.created){const Ee=C.element;f(Ee),w(F,q);const we=v();m(Se,ie),Ee.append(Se,X,F,we),document.body.appendChild(Ee)}l?(X.innerText="Preview backend disconnected.",Se.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(Se.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,X.innerText="Preview backend running in this workspace."),X.setAttribute("id",U)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",T):T()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function QT(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(cr())}function YT(){var n;const e=(n=sd())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function JT(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function XT(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function ZT(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function eS(){const n=cr();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function tS(){return!YT()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function nS(){try{return typeof indexedDB=="object"}catch{return!1}}function rS(){return new Promise((n,e)=>{try{let t=!0;const s="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(s);a.onsuccess=()=>{a.result.close(),t||self.indexedDB.deleteDatabase(s),n(!0)},a.onupgradeneeded=()=>{t=!1},a.onerror=()=>{var l;e(((l=a.error)===null||l===void 0?void 0:l.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sS="FirebaseError";class wi extends Error{constructor(e,t,s){super(t),this.code=e,this.customData=s,this.name=sS,Object.setPrototypeOf(this,wi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,nc.prototype.create)}}class nc{constructor(e,t,s){this.service=e,this.serviceName=t,this.errors=s}create(e,...t){const s=t[0]||{},a=`${this.service}/${e}`,l=this.errors[e],d=l?iS(l,s):"Error",f=`${this.serviceName}: ${d} (${a}).`;return new wi(a,f,s)}}function iS(n,e){return n.replace(aS,(t,s)=>{const a=e[s];return a!=null?String(a):`<${s}?>`})}const aS=/\{\$([^}]+)}/g;function oS(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function La(n,e){if(n===e)return!0;const t=Object.keys(n),s=Object.keys(e);for(const a of t){if(!s.includes(a))return!1;const l=n[a],d=e[a];if(ky(l)&&ky(d)){if(!La(l,d))return!1}else if(l!==d)return!1}for(const a of s)if(!t.includes(a))return!1;return!0}function ky(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rc(n){const e=[];for(const[t,s]of Object.entries(n))Array.isArray(s)?s.forEach(a=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function Nl(n){const e={};return n.replace(/^\?/,"").split("&").forEach(s=>{if(s){const[a,l]=s.split("=");e[decodeURIComponent(a)]=decodeURIComponent(l)}}),e}function Rl(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function lS(n,e){const t=new cS(n,e);return t.subscribe.bind(t)}class cS{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,s){let a;if(e===void 0&&t===void 0&&s===void 0)throw new Error("Missing Observer.");uS(e,["next","error","complete"])?a=e:a={next:e,error:t,complete:s},a.next===void 0&&(a.next=af),a.error===void 0&&(a.error=af),a.complete===void 0&&(a.complete=af);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function uS(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function af(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function en(n){return n&&n._delegate?n._delegate:n}class Va{constructor(e,t,s){this.name=e,this.instanceFactory=t,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ca="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dS{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const s=new GT;if(this.instancesDeferred.set(t,s),this.isInitialized(t)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:t});a&&s.resolve(a)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const s=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),a=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(s)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:s})}catch(l){if(a)return null;throw l}else{if(a)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(fS(e))try{this.getOrInitializeService({instanceIdentifier:Ca})}catch{}for(const[t,s]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(t);try{const l=this.getOrInitializeService({instanceIdentifier:a});s.resolve(l)}catch{}}}}clearInstance(e=Ca){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ca){return this.instances.has(e)}getOptions(e=Ca){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:s,options:t});for(const[l,d]of this.instancesDeferred.entries()){const f=this.normalizeInstanceIdentifier(l);s===f&&d.resolve(a)}return a}onInit(e,t){var s;const a=this.normalizeInstanceIdentifier(t),l=(s=this.onInitCallbacks.get(a))!==null&&s!==void 0?s:new Set;l.add(e),this.onInitCallbacks.set(a,l);const d=this.instances.get(a);return d&&e(d,a),()=>{l.delete(e)}}invokeOnInitCallbacks(e,t){const s=this.onInitCallbacks.get(t);if(s)for(const a of s)try{a(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:hS(e),options:t}),this.instances.set(e,s),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=Ca){return this.component?this.component.multipleInstances?e:Ca:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function hS(n){return n===Ca?void 0:n}function fS(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pS{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new dS(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var vt;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(vt||(vt={}));const mS={debug:vt.DEBUG,verbose:vt.VERBOSE,info:vt.INFO,warn:vt.WARN,error:vt.ERROR,silent:vt.SILENT},gS=vt.INFO,yS={[vt.DEBUG]:"log",[vt.VERBOSE]:"log",[vt.INFO]:"info",[vt.WARN]:"warn",[vt.ERROR]:"error"},vS=(n,e,...t)=>{if(e<n.logLevel)return;const s=new Date().toISOString(),a=yS[e];if(a)console[a](`[${s}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class op{constructor(e){this.name=e,this._logLevel=gS,this._logHandler=vS,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in vt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?mS[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,vt.DEBUG,...e),this._logHandler(this,vt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,vt.VERBOSE,...e),this._logHandler(this,vt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,vt.INFO,...e),this._logHandler(this,vt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,vt.WARN,...e),this._logHandler(this,vt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,vt.ERROR,...e),this._logHandler(this,vt.ERROR,...e)}}const _S=(n,e)=>e.some(t=>n instanceof t);let Dy,Ly;function wS(){return Dy||(Dy=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function xS(){return Ly||(Ly=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const q_=new WeakMap,bf=new WeakMap,H_=new WeakMap,of=new WeakMap,lp=new WeakMap;function ES(n){const e=new Promise((t,s)=>{const a=()=>{n.removeEventListener("success",l),n.removeEventListener("error",d)},l=()=>{t(Hi(n.result)),a()},d=()=>{s(n.error),a()};n.addEventListener("success",l),n.addEventListener("error",d)});return e.then(t=>{t instanceof IDBCursor&&q_.set(t,n)}).catch(()=>{}),lp.set(e,n),e}function TS(n){if(bf.has(n))return;const e=new Promise((t,s)=>{const a=()=>{n.removeEventListener("complete",l),n.removeEventListener("error",d),n.removeEventListener("abort",d)},l=()=>{t(),a()},d=()=>{s(n.error||new DOMException("AbortError","AbortError")),a()};n.addEventListener("complete",l),n.addEventListener("error",d),n.addEventListener("abort",d)});bf.set(n,e)}let Cf={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return bf.get(n);if(e==="objectStoreNames")return n.objectStoreNames||H_.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Hi(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function SS(n){Cf=n(Cf)}function bS(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const s=n.call(lf(this),e,...t);return H_.set(s,e.sort?e.sort():[e]),Hi(s)}:xS().includes(n)?function(...e){return n.apply(lf(this),e),Hi(q_.get(this))}:function(...e){return Hi(n.apply(lf(this),e))}}function CS(n){return typeof n=="function"?bS(n):(n instanceof IDBTransaction&&TS(n),_S(n,wS())?new Proxy(n,Cf):n)}function Hi(n){if(n instanceof IDBRequest)return ES(n);if(of.has(n))return of.get(n);const e=CS(n);return e!==n&&(of.set(n,e),lp.set(e,n)),e}const lf=n=>lp.get(n);function IS(n,e,{blocked:t,upgrade:s,blocking:a,terminated:l}={}){const d=indexedDB.open(n,e),f=Hi(d);return s&&d.addEventListener("upgradeneeded",m=>{s(Hi(d.result),m.oldVersion,m.newVersion,Hi(d.transaction),m)}),t&&d.addEventListener("blocked",m=>t(m.oldVersion,m.newVersion,m)),f.then(m=>{l&&m.addEventListener("close",()=>l()),a&&m.addEventListener("versionchange",v=>a(v.oldVersion,v.newVersion,v))}).catch(()=>{}),f}const PS=["get","getKey","getAll","getAllKeys","count"],NS=["put","add","delete","clear"],cf=new Map;function Vy(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(cf.get(e))return cf.get(e);const t=e.replace(/FromIndex$/,""),s=e!==t,a=NS.includes(t);if(!(t in(s?IDBIndex:IDBObjectStore).prototype)||!(a||PS.includes(t)))return;const l=async function(d,...f){const m=this.transaction(d,a?"readwrite":"readonly");let v=m.store;return s&&(v=v.index(f.shift())),(await Promise.all([v[t](...f),a&&m.done]))[0]};return cf.set(e,l),l}SS(n=>({...n,get:(e,t,s)=>Vy(e,t)||n.get(e,t,s),has:(e,t)=>!!Vy(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RS{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(AS(t)){const s=t.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(t=>t).join(" ")}}function AS(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const If="@firebase/app",My="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fi=new op("@firebase/app"),jS="@firebase/app-compat",kS="@firebase/analytics-compat",DS="@firebase/analytics",LS="@firebase/app-check-compat",VS="@firebase/app-check",MS="@firebase/auth",OS="@firebase/auth-compat",FS="@firebase/database",US="@firebase/data-connect",zS="@firebase/database-compat",BS="@firebase/functions",$S="@firebase/functions-compat",WS="@firebase/installations",GS="@firebase/installations-compat",qS="@firebase/messaging",HS="@firebase/messaging-compat",KS="@firebase/performance",QS="@firebase/performance-compat",YS="@firebase/remote-config",JS="@firebase/remote-config-compat",XS="@firebase/storage",ZS="@firebase/storage-compat",e1="@firebase/firestore",t1="@firebase/ai",n1="@firebase/firestore-compat",r1="firebase",s1="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pf="[DEFAULT]",i1={[If]:"fire-core",[jS]:"fire-core-compat",[DS]:"fire-analytics",[kS]:"fire-analytics-compat",[VS]:"fire-app-check",[LS]:"fire-app-check-compat",[MS]:"fire-auth",[OS]:"fire-auth-compat",[FS]:"fire-rtdb",[US]:"fire-data-connect",[zS]:"fire-rtdb-compat",[BS]:"fire-fn",[$S]:"fire-fn-compat",[WS]:"fire-iid",[GS]:"fire-iid-compat",[qS]:"fire-fcm",[HS]:"fire-fcm-compat",[KS]:"fire-perf",[QS]:"fire-perf-compat",[YS]:"fire-rc",[JS]:"fire-rc-compat",[XS]:"fire-gcs",[ZS]:"fire-gcs-compat",[e1]:"fire-fst",[n1]:"fire-fst-compat",[t1]:"fire-vertex","fire-js":"fire-js",[r1]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fu=new Map,a1=new Map,Nf=new Map;function Oy(n,e){try{n.container.addComponent(e)}catch(t){fi.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function jo(n){const e=n.name;if(Nf.has(e))return fi.debug(`There were multiple attempts to register component ${e}.`),!1;Nf.set(e,n);for(const t of Fu.values())Oy(t,n);for(const t of a1.values())Oy(t,n);return!0}function cp(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function zr(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o1={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ki=new nc("app","Firebase",o1);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l1{constructor(e,t,s){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new Va("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ki.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $o=s1;function K_(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const s=Object.assign({name:Pf,automaticDataCollectionEnabled:!0},e),a=s.name;if(typeof a!="string"||!a)throw Ki.create("bad-app-name",{appName:String(a)});if(t||(t=B_()),!t)throw Ki.create("no-options");const l=Fu.get(a);if(l){if(La(t,l.options)&&La(s,l.config))return l;throw Ki.create("duplicate-app",{appName:a})}const d=new pS(a);for(const m of Nf.values())d.addComponent(m);const f=new l1(t,s,d);return Fu.set(a,f),f}function Q_(n=Pf){const e=Fu.get(n);if(!e&&n===Pf&&B_())return K_();if(!e)throw Ki.create("no-app",{appName:n});return e}function Qi(n,e,t){var s;let a=(s=i1[n])!==null&&s!==void 0?s:n;t&&(a+=`-${t}`);const l=a.match(/\s|\//),d=e.match(/\s|\//);if(l||d){const f=[`Unable to register library "${a}" with version "${e}":`];l&&f.push(`library name "${a}" contains illegal characters (whitespace or "/")`),l&&d&&f.push("and"),d&&f.push(`version name "${e}" contains illegal characters (whitespace or "/")`),fi.warn(f.join(" "));return}jo(new Va(`${a}-version`,()=>({library:a,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c1="firebase-heartbeat-database",u1=1,Wl="firebase-heartbeat-store";let uf=null;function Y_(){return uf||(uf=IS(c1,u1,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Wl)}catch(t){console.warn(t)}}}}).catch(n=>{throw Ki.create("idb-open",{originalErrorMessage:n.message})})),uf}async function d1(n){try{const t=(await Y_()).transaction(Wl),s=await t.objectStore(Wl).get(J_(n));return await t.done,s}catch(e){if(e instanceof wi)fi.warn(e.message);else{const t=Ki.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});fi.warn(t.message)}}}async function Fy(n,e){try{const s=(await Y_()).transaction(Wl,"readwrite");await s.objectStore(Wl).put(e,J_(n)),await s.done}catch(t){if(t instanceof wi)fi.warn(t.message);else{const s=Ki.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});fi.warn(s.message)}}}function J_(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h1=1024,f1=30;class p1{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new g1(t),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){var e,t;try{const a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),l=Uy();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===l||this._heartbeatsCache.heartbeats.some(d=>d.date===l))return;if(this._heartbeatsCache.heartbeats.push({date:l,agent:a}),this._heartbeatsCache.heartbeats.length>f1){const d=y1(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(d,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(s){fi.warn(s)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Uy(),{heartbeatsToSend:s,unsentEntries:a}=m1(this._heartbeatsCache.heartbeats),l=Ou(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=t,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(t){return fi.warn(t),""}}}function Uy(){return new Date().toISOString().substring(0,10)}function m1(n,e=h1){const t=[];let s=n.slice();for(const a of n){const l=t.find(d=>d.agent===a.agent);if(l){if(l.dates.push(a.date),zy(t)>e){l.dates.pop();break}}else if(t.push({agent:a.agent,dates:[a.date]}),zy(t)>e){t.pop();break}s=s.slice(1)}return{heartbeatsToSend:t,unsentEntries:s}}class g1{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return nS()?rS().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await d1(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const a=await this.read();return Fy(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:a.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const a=await this.read();return Fy(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:a.lastSentHeartbeatDate,heartbeats:[...a.heartbeats,...e.heartbeats]})}else return}}function zy(n){return Ou(JSON.stringify({version:2,heartbeats:n})).length}function y1(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let s=1;s<n.length;s++)n[s].date<t&&(t=n[s].date,e=s);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v1(n){jo(new Va("platform-logger",e=>new RS(e),"PRIVATE")),jo(new Va("heartbeat",e=>new p1(e),"PRIVATE")),Qi(If,My,n),Qi(If,My,"esm2017"),Qi("fire-js","")}v1("");var _1="firebase",w1="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Qi(_1,w1,"app");function up(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(n);a<s.length;a++)e.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(n,s[a])&&(t[s[a]]=n[s[a]]);return t}function X_(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const x1=X_,Z_=new nc("auth","Firebase",X_());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uu=new op("@firebase/auth");function E1(n,...e){Uu.logLevel<=vt.WARN&&Uu.warn(`Auth (${$o}): ${n}`,...e)}function Su(n,...e){Uu.logLevel<=vt.ERROR&&Uu.error(`Auth (${$o}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rs(n,...e){throw hp(n,...e)}function Es(n,...e){return hp(n,...e)}function dp(n,e,t){const s=Object.assign(Object.assign({},x1()),{[e]:t});return new nc("auth","Firebase",s).create(e,{appName:n.name})}function di(n){return dp(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function e0(n,e,t){const s=t;if(!(e instanceof s))throw s.name!==e.constructor.name&&rs(n,"argument-error"),dp(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function hp(n,...e){if(typeof n!="string"){const t=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=n.name),n._errorFactory.create(t,...s)}return Z_.create(n,...e)}function nt(n,e,...t){if(!n)throw hp(e,...t)}function li(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Su(e),new Error(e)}function pi(n,e){n||li(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rf(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function T1(){return By()==="http:"||By()==="https:"}function By(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S1(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(T1()||XT()||"connection"in navigator)?navigator.onLine:!0}function b1(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sc{constructor(e,t){this.shortDelay=e,this.longDelay=t,pi(t>e,"Short delay should be less than long delay!"),this.isMobile=QT()||ZT()}get(){return S1()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fp(n,e){pi(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t0{static initialize(e,t,s){this.fetchImpl=e,t&&(this.headersImpl=t),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;li("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;li("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;li("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C1={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I1=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],P1=new sc(3e4,6e4);function oa(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function Gs(n,e,t,s,a={}){return n0(n,a,async()=>{let l={},d={};s&&(e==="GET"?d=s:l={body:JSON.stringify(s)});const f=rc(Object.assign({key:n.config.apiKey},d)).slice(1),m=await n._getAdditionalHeaders();m["Content-Type"]="application/json",n.languageCode&&(m["X-Firebase-Locale"]=n.languageCode);const v=Object.assign({method:e,headers:m},l);return JT()||(v.referrerPolicy="no-referrer"),n.emulatorConfig&&Bo(n.emulatorConfig.host)&&(v.credentials="include"),t0.fetch()(await r0(n,n.config.apiHost,t,f),v)})}async function n0(n,e,t){n._canInitEmulator=!1;const s=Object.assign(Object.assign({},C1),e);try{const a=new R1(n),l=await Promise.race([t(),a.promise]);a.clearNetworkTimeout();const d=await l.json();if("needConfirmation"in d)throw gu(n,"account-exists-with-different-credential",d);if(l.ok&&!("errorMessage"in d))return d;{const f=l.ok?d.errorMessage:d.error.message,[m,v]=f.split(" : ");if(m==="FEDERATED_USER_ID_ALREADY_LINKED")throw gu(n,"credential-already-in-use",d);if(m==="EMAIL_EXISTS")throw gu(n,"email-already-in-use",d);if(m==="USER_DISABLED")throw gu(n,"user-disabled",d);const w=s[m]||m.toLowerCase().replace(/[_\s]+/g,"-");if(v)throw dp(n,w,v);rs(n,w)}}catch(a){if(a instanceof wi)throw a;rs(n,"network-request-failed",{message:String(a)})}}async function ic(n,e,t,s,a={}){const l=await Gs(n,e,t,s,a);return"mfaPendingCredential"in l&&rs(n,"multi-factor-auth-required",{_serverResponse:l}),l}async function r0(n,e,t,s){const a=`${e}${t}?${s}`,l=n,d=l.config.emulator?fp(n.config,a):`${n.config.apiScheme}://${a}`;return I1.includes(t)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(d).toString():d}function N1(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class R1{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,s)=>{this.timer=setTimeout(()=>s(Es(this.auth,"network-request-failed")),P1.get())})}}function gu(n,e,t){const s={appName:n.name};t.email&&(s.email=t.email),t.phoneNumber&&(s.phoneNumber=t.phoneNumber);const a=Es(n,e,s);return a.customData._tokenResponse=t,a}function $y(n){return n!==void 0&&n.enterprise!==void 0}class A1{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return N1(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function j1(n,e){return Gs(n,"GET","/v2/recaptchaConfig",oa(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function k1(n,e){return Gs(n,"POST","/v1/accounts:delete",e)}async function D1(n,e){return Gs(n,"POST","/v1/accounts:update",e)}async function zu(n,e){return Gs(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vl(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function L1(n,e=!1){const t=en(n),s=await t.getIdToken(e),a=pp(s);nt(a&&a.exp&&a.auth_time&&a.iat,t.auth,"internal-error");const l=typeof a.firebase=="object"?a.firebase:void 0,d=l==null?void 0:l.sign_in_provider;return{claims:a,token:s,authTime:Vl(df(a.auth_time)),issuedAtTime:Vl(df(a.iat)),expirationTime:Vl(df(a.exp)),signInProvider:d||null,signInSecondFactor:(l==null?void 0:l.sign_in_second_factor)||null}}function df(n){return Number(n)*1e3}function pp(n){const[e,t,s]=n.split(".");if(e===void 0||t===void 0||s===void 0)return Su("JWT malformed, contained fewer than 3 sections"),null;try{const a=U_(t);return a?JSON.parse(a):(Su("Failed to decode base64 JWT payload"),null)}catch(a){return Su("Caught error parsing JWT payload as JSON",a==null?void 0:a.toString()),null}}function Wy(n){const e=pp(n);return nt(e,"internal-error"),nt(typeof e.exp<"u","internal-error"),nt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ko(n,e,t=!1){if(t)return e;try{return await e}catch(s){throw s instanceof wi&&V1(s)&&n.auth.currentUser===n&&await n.auth.signOut(),s}}function V1({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M1{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const s=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),s}else{this.errorBackoff=3e4;const a=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,a)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Af{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Vl(this.lastLoginAt),this.creationTime=Vl(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gl(n){var e;const t=n.auth,s=await n.getIdToken(),a=await ko(n,zu(t,{idToken:s}));nt(a==null?void 0:a.users.length,t,"internal-error");const l=a.users[0];n._notifyReloadListener(l);const d=!((e=l.providerUserInfo)===null||e===void 0)&&e.length?s0(l.providerUserInfo):[],f=F1(n.providerData,d),m=n.isAnonymous,v=!(n.email&&l.passwordHash)&&!(f!=null&&f.length),w=m?v:!1,T={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:f,metadata:new Af(l.createdAt,l.lastLoginAt),isAnonymous:w};Object.assign(n,T)}async function O1(n){const e=en(n);await Gl(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function F1(n,e){return[...n.filter(s=>!e.some(a=>a.providerId===s.providerId)),...e]}function s0(n){return n.map(e=>{var{providerId:t}=e,s=up(e,["providerId"]);return{providerId:t,uid:s.rawId||"",displayName:s.displayName||null,email:s.email||null,phoneNumber:s.phoneNumber||null,photoURL:s.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function U1(n,e){const t=await n0(n,{},async()=>{const s=rc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:l}=n.config,d=await r0(n,a,"/v1/token",`key=${l}`),f=await n._getAdditionalHeaders();f["Content-Type"]="application/x-www-form-urlencoded";const m={method:"POST",headers:f,body:s};return n.emulatorConfig&&Bo(n.emulatorConfig.host)&&(m.credentials="include"),t0.fetch()(d,m)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function z1(n,e){return Gs(n,"POST","/v2/accounts:revokeToken",oa(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Po{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){nt(e.idToken,"internal-error"),nt(typeof e.idToken<"u","internal-error"),nt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Wy(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){nt(e.length!==0,"internal-error");const t=Wy(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(nt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:s,refreshToken:a,expiresIn:l}=await U1(e,t);this.updateTokensAndExpiration(s,a,Number(l))}updateTokensAndExpiration(e,t,s){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,t){const{refreshToken:s,accessToken:a,expirationTime:l}=t,d=new Po;return s&&(nt(typeof s=="string","internal-error",{appName:e}),d.refreshToken=s),a&&(nt(typeof a=="string","internal-error",{appName:e}),d.accessToken=a),l&&(nt(typeof l=="number","internal-error",{appName:e}),d.expirationTime=l),d}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Po,this.toJSON())}_performRefresh(){return li("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fi(n,e){nt(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class xs{constructor(e){var{uid:t,auth:s,stsTokenManager:a}=e,l=up(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new M1(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=s,this.stsTokenManager=a,this.accessToken=a.accessToken,this.displayName=l.displayName||null,this.email=l.email||null,this.emailVerified=l.emailVerified||!1,this.phoneNumber=l.phoneNumber||null,this.photoURL=l.photoURL||null,this.isAnonymous=l.isAnonymous||!1,this.tenantId=l.tenantId||null,this.providerData=l.providerData?[...l.providerData]:[],this.metadata=new Af(l.createdAt||void 0,l.lastLoginAt||void 0)}async getIdToken(e){const t=await ko(this,this.stsTokenManager.getToken(this.auth,e));return nt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return L1(this,e)}reload(){return O1(this)}_assign(e){this!==e&&(nt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new xs(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){nt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),t&&await Gl(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(zr(this.auth.app))return Promise.reject(di(this.auth));const e=await this.getIdToken();return await ko(this,k1(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var s,a,l,d,f,m,v,w;const T=(s=t.displayName)!==null&&s!==void 0?s:void 0,C=(a=t.email)!==null&&a!==void 0?a:void 0,U=(l=t.phoneNumber)!==null&&l!==void 0?l:void 0,X=(d=t.photoURL)!==null&&d!==void 0?d:void 0,q=(f=t.tenantId)!==null&&f!==void 0?f:void 0,F=(m=t._redirectEventId)!==null&&m!==void 0?m:void 0,ie=(v=t.createdAt)!==null&&v!==void 0?v:void 0,Se=(w=t.lastLoginAt)!==null&&w!==void 0?w:void 0,{uid:Ee,emailVerified:we,isAnonymous:V,providerData:ae,stsTokenManager:I}=t;nt(Ee&&I,e,"internal-error");const P=Po.fromJSON(this.name,I);nt(typeof Ee=="string",e,"internal-error"),Fi(T,e.name),Fi(C,e.name),nt(typeof we=="boolean",e,"internal-error"),nt(typeof V=="boolean",e,"internal-error"),Fi(U,e.name),Fi(X,e.name),Fi(q,e.name),Fi(F,e.name),Fi(ie,e.name),Fi(Se,e.name);const A=new xs({uid:Ee,auth:e,email:C,emailVerified:we,displayName:T,isAnonymous:V,photoURL:X,phoneNumber:U,tenantId:q,stsTokenManager:P,createdAt:ie,lastLoginAt:Se});return ae&&Array.isArray(ae)&&(A.providerData=ae.map(M=>Object.assign({},M))),F&&(A._redirectEventId=F),A}static async _fromIdTokenResponse(e,t,s=!1){const a=new Po;a.updateFromServerResponse(t);const l=new xs({uid:t.localId,auth:e,stsTokenManager:a,isAnonymous:s});return await Gl(l),l}static async _fromGetAccountInfoResponse(e,t,s){const a=t.users[0];nt(a.localId!==void 0,"internal-error");const l=a.providerUserInfo!==void 0?s0(a.providerUserInfo):[],d=!(a.email&&a.passwordHash)&&!(l!=null&&l.length),f=new Po;f.updateFromIdToken(s);const m=new xs({uid:a.localId,auth:e,stsTokenManager:f,isAnonymous:d}),v={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new Af(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!(l!=null&&l.length)};return Object.assign(m,v),m}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gy=new Map;function ci(n){pi(n instanceof Function,"Expected a class definition");let e=Gy.get(n);return e?(pi(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Gy.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i0{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}i0.type="NONE";const qy=i0;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bu(n,e,t){return`firebase:${n}:${e}:${t}`}class No{constructor(e,t,s){this.persistence=e,this.auth=t,this.userKey=s;const{config:a,name:l}=this.auth;this.fullUserKey=bu(this.userKey,a.apiKey,l),this.fullPersistenceKey=bu("persistence",a.apiKey,l),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await zu(this.auth,{idToken:e}).catch(()=>{});return t?xs._fromGetAccountInfoResponse(this.auth,t,e):null}return xs._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,s="authUser"){if(!t.length)return new No(ci(qy),e,s);const a=(await Promise.all(t.map(async v=>{if(await v._isAvailable())return v}))).filter(v=>v);let l=a[0]||ci(qy);const d=bu(s,e.config.apiKey,e.name);let f=null;for(const v of t)try{const w=await v._get(d);if(w){let T;if(typeof w=="string"){const C=await zu(e,{idToken:w}).catch(()=>{});if(!C)break;T=await xs._fromGetAccountInfoResponse(e,C,w)}else T=xs._fromJSON(e,w);v!==l&&(f=T),l=v;break}}catch{}const m=a.filter(v=>v._shouldAllowMigration);return!l._shouldAllowMigration||!m.length?new No(l,e,s):(l=m[0],f&&await l._set(d,f.toJSON()),await Promise.all(t.map(async v=>{if(v!==l)try{await v._remove(d)}catch{}})),new No(l,e,s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hy(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(c0(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(a0(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(d0(e))return"Blackberry";if(h0(e))return"Webos";if(o0(e))return"Safari";if((e.includes("chrome/")||l0(e))&&!e.includes("edge/"))return"Chrome";if(u0(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=n.match(t);if((s==null?void 0:s.length)===2)return s[1]}return"Other"}function a0(n=cr()){return/firefox\//i.test(n)}function o0(n=cr()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function l0(n=cr()){return/crios\//i.test(n)}function c0(n=cr()){return/iemobile/i.test(n)}function u0(n=cr()){return/android/i.test(n)}function d0(n=cr()){return/blackberry/i.test(n)}function h0(n=cr()){return/webos/i.test(n)}function mp(n=cr()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function B1(n=cr()){var e;return mp(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function $1(){return eS()&&document.documentMode===10}function f0(n=cr()){return mp(n)||u0(n)||h0(n)||d0(n)||/windows phone/i.test(n)||c0(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p0(n,e=[]){let t;switch(n){case"Browser":t=Hy(cr());break;case"Worker":t=`${Hy(cr())}-${n}`;break;default:t=n}const s=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${$o}/${s}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W1{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const s=l=>new Promise((d,f)=>{try{const m=e(l);d(m)}catch(m){f(m)}});s.onAbort=t,this.queue.push(s);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const s of this.queue)await s(e),s.onAbort&&t.push(s.onAbort)}catch(s){t.reverse();for(const a of t)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s==null?void 0:s.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function G1(n,e={}){return Gs(n,"GET","/v2/passwordPolicy",oa(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q1=6;class H1{constructor(e){var t,s,a,l;const d=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=d.minPasswordLength)!==null&&t!==void 0?t:q1,d.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=d.maxPasswordLength),d.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=d.containsLowercaseCharacter),d.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=d.containsUppercaseCharacter),d.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=d.containsNumericCharacter),d.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=d.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(a=(s=e.allowedNonAlphanumericCharacters)===null||s===void 0?void 0:s.join(""))!==null&&a!==void 0?a:"",this.forceUpgradeOnSignin=(l=e.forceUpgradeOnSignin)!==null&&l!==void 0?l:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,s,a,l,d,f;const m={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,m),this.validatePasswordCharacterOptions(e,m),m.isValid&&(m.isValid=(t=m.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),m.isValid&&(m.isValid=(s=m.meetsMaxPasswordLength)!==null&&s!==void 0?s:!0),m.isValid&&(m.isValid=(a=m.containsLowercaseLetter)!==null&&a!==void 0?a:!0),m.isValid&&(m.isValid=(l=m.containsUppercaseLetter)!==null&&l!==void 0?l:!0),m.isValid&&(m.isValid=(d=m.containsNumericCharacter)!==null&&d!==void 0?d:!0),m.isValid&&(m.isValid=(f=m.containsNonAlphanumericCharacter)!==null&&f!==void 0?f:!0),m}validatePasswordLengthOptions(e,t){const s=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;s&&(t.meetsMinPasswordLength=e.length>=s),a&&(t.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let s;for(let a=0;a<e.length;a++)s=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(t,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,t,s,a,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K1{constructor(e,t,s,a){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=s,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ky(this),this.idTokenSubscription=new Ky(this),this.beforeStateQueue=new W1(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Z_,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ci(t)),this._initializationPromise=this.queue(async()=>{var s,a,l;if(!this._deleted&&(this.persistenceManager=await No.create(this,e),(s=this._resolvePersistenceManagerAvailable)===null||s===void 0||s.call(this),!this._deleted)){if(!((a=this._popupRedirectResolver)===null||a===void 0)&&a._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((l=this.currentUser)===null||l===void 0?void 0:l.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await zu(this,{idToken:e}),s=await xs._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(s)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(zr(this.app)){const d=this.app.settings.authIdToken;return d?new Promise(f=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(d).then(f,f))}):this.directlySetCurrentUser(null)}const s=await this.assertedPersistence.getCurrentUser();let a=s,l=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const d=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,f=a==null?void 0:a._redirectEventId,m=await this.tryRedirectSignIn(e);(!d||d===f)&&(m!=null&&m.user)&&(a=m.user,l=!0)}if(!a)return this.directlySetCurrentUser(null);if(!a._redirectEventId){if(l)try{await this.beforeStateQueue.runMiddleware(a)}catch(d){a=s,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(d))}return a?this.reloadAndSetCurrentUserOrClear(a):this.directlySetCurrentUser(null)}return nt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===a._redirectEventId?this.directlySetCurrentUser(a):this.reloadAndSetCurrentUserOrClear(a)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Gl(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=b1()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(zr(this.app))return Promise.reject(di(this));const t=e?en(e):null;return t&&nt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&nt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return zr(this.app)?Promise.reject(di(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return zr(this.app)?Promise.reject(di(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ci(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await G1(this),t=new H1(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new nc("auth","Firebase",e())}onAuthStateChanged(e,t,s){return this.registerStateListener(this.authStateSubscription,e,t,s)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,s){return this.registerStateListener(this.idTokenSubscription,e,t,s)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(s.tenantId=this.tenantId),await z1(this,s)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const s=await this.getOrInitRedirectPersistenceManager(t);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&ci(e)||this._popupRedirectResolver;nt(t,this,"argument-error"),this.redirectPersistenceManager=await No.create(this,[ci(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,s;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((s=this.redirectUser)===null||s===void 0?void 0:s._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const s=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==s&&(this.lastNotifiedUid=s,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,s,a){if(this._deleted)return()=>{};const l=typeof t=="function"?t:t.next.bind(t);let d=!1;const f=this._isInitialized?Promise.resolve():this._initializationPromise;if(nt(f,this,"internal-error"),f.then(()=>{d||l(this.currentUser)}),typeof t=="function"){const m=e.addObserver(t,s,a);return()=>{d=!0,m()}}else{const m=e.addObserver(t);return()=>{d=!0,m()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return nt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=p0(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const s=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());s&&(t["X-Firebase-Client"]=s);const a=await this._getAppCheckToken();return a&&(t["X-Firebase-AppCheck"]=a),t}async _getAppCheckToken(){var e;if(zr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&E1(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function la(n){return en(n)}class Ky{constructor(e){this.auth=e,this.observer=null,this.addObserver=lS(t=>this.observer=t)}get next(){return nt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let id={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Q1(n){id=n}function m0(n){return id.loadJS(n)}function Y1(){return id.recaptchaEnterpriseScript}function J1(){return id.gapiScript}function X1(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class Z1{constructor(){this.enterprise=new eb}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class eb{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const tb="recaptcha-enterprise",g0="NO_RECAPTCHA";class nb{constructor(e){this.type=tb,this.auth=la(e)}async verify(e="verify",t=!1){async function s(l){if(!t){if(l.tenantId==null&&l._agentRecaptchaConfig!=null)return l._agentRecaptchaConfig.siteKey;if(l.tenantId!=null&&l._tenantRecaptchaConfigs[l.tenantId]!==void 0)return l._tenantRecaptchaConfigs[l.tenantId].siteKey}return new Promise(async(d,f)=>{j1(l,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(m=>{if(m.recaptchaKey===void 0)f(new Error("recaptcha Enterprise site key undefined"));else{const v=new A1(m);return l.tenantId==null?l._agentRecaptchaConfig=v:l._tenantRecaptchaConfigs[l.tenantId]=v,d(v.siteKey)}}).catch(m=>{f(m)})})}function a(l,d,f){const m=window.grecaptcha;$y(m)?m.enterprise.ready(()=>{m.enterprise.execute(l,{action:e}).then(v=>{d(v)}).catch(()=>{d(g0)})}):f(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new Z1().execute("siteKey",{action:"verify"}):new Promise((l,d)=>{s(this.auth).then(f=>{if(!t&&$y(window.grecaptcha))a(f,l,d);else{if(typeof window>"u"){d(new Error("RecaptchaVerifier is only supported in browser"));return}let m=Y1();m.length!==0&&(m+=f),m0(m).then(()=>{a(f,l,d)}).catch(v=>{d(v)})}}).catch(f=>{d(f)})})}}async function Qy(n,e,t,s=!1,a=!1){const l=new nb(n);let d;if(a)d=g0;else try{d=await l.verify(t)}catch{d=await l.verify(t,!0)}const f=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in f){const m=f.phoneEnrollmentInfo.phoneNumber,v=f.phoneEnrollmentInfo.recaptchaToken;Object.assign(f,{phoneEnrollmentInfo:{phoneNumber:m,recaptchaToken:v,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in f){const m=f.phoneSignInInfo.recaptchaToken;Object.assign(f,{phoneSignInInfo:{recaptchaToken:m,captchaResponse:d,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return f}return s?Object.assign(f,{captchaResp:d}):Object.assign(f,{captchaResponse:d}),Object.assign(f,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(f,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),f}async function jf(n,e,t,s,a){var l;if(!((l=n._getRecaptchaConfig())===null||l===void 0)&&l.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const d=await Qy(n,e,t,t==="getOobCode");return s(n,d)}else return s(n,e).catch(async d=>{if(d.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const f=await Qy(n,e,t,t==="getOobCode");return s(n,f)}else return Promise.reject(d)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rb(n,e){const t=cp(n,"auth");if(t.isInitialized()){const a=t.getImmediate(),l=t.getOptions();if(La(l,e??{}))return a;rs(a,"already-initialized")}return t.initialize({options:e})}function sb(n,e){const t=(e==null?void 0:e.persistence)||[],s=(Array.isArray(t)?t:[t]).map(ci);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(s,e==null?void 0:e.popupRedirectResolver)}function ib(n,e,t){const s=la(n);nt(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const a=!1,l=y0(e),{host:d,port:f}=ab(e),m=f===null?"":`:${f}`,v={url:`${l}//${d}${m}/`},w=Object.freeze({host:d,port:f,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!s._canInitEmulator){nt(s.config.emulator&&s.emulatorConfig,s,"emulator-config-failed"),nt(La(v,s.config.emulator)&&La(w,s.emulatorConfig),s,"emulator-config-failed");return}s.config.emulator=v,s.emulatorConfig=w,s.settings.appVerificationDisabledForTesting=!0,Bo(d)?(W_(`${l}//${d}${m}`),G_("Auth",!0)):ob()}function y0(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function ab(n){const e=y0(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const s=t[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(s);if(a){const l=a[1];return{host:l,port:Yy(s.substr(l.length+1))}}else{const[l,d]=s.split(":");return{host:l,port:Yy(d)}}}function Yy(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function ob(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gp{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return li("not implemented")}_getIdTokenResponse(e){return li("not implemented")}_linkToIdToken(e,t){return li("not implemented")}_getReauthenticationResolver(e){return li("not implemented")}}async function lb(n,e){return Gs(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cb(n,e){return ic(n,"POST","/v1/accounts:signInWithPassword",oa(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ub(n,e){return ic(n,"POST","/v1/accounts:signInWithEmailLink",oa(n,e))}async function db(n,e){return ic(n,"POST","/v1/accounts:signInWithEmailLink",oa(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ql extends gp{constructor(e,t,s,a=null){super("password",s),this._email=e,this._password=t,this._tenantId=a}static _fromEmailAndPassword(e,t){return new ql(e,t,"password")}static _fromEmailAndCode(e,t,s=null){return new ql(e,t,"emailLink",s)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return jf(e,t,"signInWithPassword",cb);case"emailLink":return ub(e,{email:this._email,oobCode:this._password});default:rs(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const s={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return jf(e,s,"signUpPassword",lb);case"emailLink":return db(e,{idToken:t,email:this._email,oobCode:this._password});default:rs(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ro(n,e){return ic(n,"POST","/v1/accounts:signInWithIdp",oa(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hb="http://localhost";class mi extends gp{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new mi(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):rs("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:a}=t,l=up(t,["providerId","signInMethod"]);if(!s||!a)return null;const d=new mi(s,a);return d.idToken=l.idToken||void 0,d.accessToken=l.accessToken||void 0,d.secret=l.secret,d.nonce=l.nonce,d.pendingToken=l.pendingToken||null,d}_getIdTokenResponse(e){const t=this.buildRequest();return Ro(e,t)}_linkToIdToken(e,t){const s=this.buildRequest();return s.idToken=t,Ro(e,s)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Ro(e,t)}buildRequest(){const e={requestUri:hb,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=rc(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fb(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function pb(n){const e=Nl(Rl(n)).link,t=e?Nl(Rl(e)).deep_link_id:null,s=Nl(Rl(n)).deep_link_id;return(s?Nl(Rl(s)).link:null)||s||t||e||n}class yp{constructor(e){var t,s,a,l,d,f;const m=Nl(Rl(e)),v=(t=m.apiKey)!==null&&t!==void 0?t:null,w=(s=m.oobCode)!==null&&s!==void 0?s:null,T=fb((a=m.mode)!==null&&a!==void 0?a:null);nt(v&&w&&T,"argument-error"),this.apiKey=v,this.operation=T,this.code=w,this.continueUrl=(l=m.continueUrl)!==null&&l!==void 0?l:null,this.languageCode=(d=m.lang)!==null&&d!==void 0?d:null,this.tenantId=(f=m.tenantId)!==null&&f!==void 0?f:null}static parseLink(e){const t=pb(e);try{return new yp(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wo{constructor(){this.providerId=Wo.PROVIDER_ID}static credential(e,t){return ql._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const s=yp.parseLink(t);return nt(s,"argument-error"),ql._fromEmailAndCode(e,s.code,s.tenantId)}}Wo.PROVIDER_ID="password";Wo.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Wo.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ad{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Go extends ad{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Ml extends Go{static credentialFromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;return nt("providerId"in t&&"signInMethod"in t,"argument-error"),mi._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return nt(e.idToken||e.accessToken,"argument-error"),mi._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return Ml.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return Ml.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:s,oauthTokenSecret:a,pendingToken:l,nonce:d,providerId:f}=e;if(!s&&!a&&!t&&!l||!f)return null;try{return new Ml(f)._credential({idToken:t,accessToken:s,nonce:d,pendingToken:l})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ui extends Go{constructor(){super("facebook.com")}static credential(e){return mi._fromParams({providerId:Ui.PROVIDER_ID,signInMethod:Ui.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ui.credentialFromTaggedObject(e)}static credentialFromError(e){return Ui.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ui.credential(e.oauthAccessToken)}catch{return null}}}Ui.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ui.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vs extends Go{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return mi._fromParams({providerId:vs.PROVIDER_ID,signInMethod:vs.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return vs.credentialFromTaggedObject(e)}static credentialFromError(e){return vs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:s}=e;if(!t&&!s)return null;try{return vs.credential(t,s)}catch{return null}}}vs.GOOGLE_SIGN_IN_METHOD="google.com";vs.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zi extends Go{constructor(){super("github.com")}static credential(e){return mi._fromParams({providerId:zi.PROVIDER_ID,signInMethod:zi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return zi.credentialFromTaggedObject(e)}static credentialFromError(e){return zi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return zi.credential(e.oauthAccessToken)}catch{return null}}}zi.GITHUB_SIGN_IN_METHOD="github.com";zi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bi extends Go{constructor(){super("twitter.com")}static credential(e,t){return mi._fromParams({providerId:Bi.PROVIDER_ID,signInMethod:Bi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Bi.credentialFromTaggedObject(e)}static credentialFromError(e){return Bi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:s}=e;if(!t||!s)return null;try{return Bi.credential(t,s)}catch{return null}}}Bi.TWITTER_SIGN_IN_METHOD="twitter.com";Bi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mb(n,e){return ic(n,"POST","/v1/accounts:signUp",oa(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ma{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,s,a=!1){const l=await xs._fromIdTokenResponse(e,s,a),d=Jy(s);return new Ma({user:l,providerId:d,_tokenResponse:s,operationType:t})}static async _forOperation(e,t,s){await e._updateTokensIfNecessary(s,!0);const a=Jy(s);return new Ma({user:e,providerId:a,_tokenResponse:s,operationType:t})}}function Jy(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bu extends wi{constructor(e,t,s,a){var l;super(t.code,t.message),this.operationType=s,this.user=a,Object.setPrototypeOf(this,Bu.prototype),this.customData={appName:e.name,tenantId:(l=e.tenantId)!==null&&l!==void 0?l:void 0,_serverResponse:t.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,t,s,a){return new Bu(e,t,s,a)}}function v0(n,e,t,s){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?Bu._fromErrorAndOperation(n,l,e,s):l})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _0(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gb(n,e){const t=en(n);await vb(!0,t,e);const{providerUserInfo:s}=await D1(t.auth,{idToken:await t.getIdToken(),deleteProvider:[e]}),a=_0(s||[]);return t.providerData=t.providerData.filter(l=>a.has(l.providerId)),a.has("phone")||(t.phoneNumber=null),await t.auth._persistUserIfCurrent(t),t}async function yb(n,e,t=!1){const s=await ko(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Ma._forOperation(n,"link",s)}async function vb(n,e,t){await Gl(e);const s=_0(e.providerData);nt(s.has(t)===n,e.auth,"no-such-provider")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _b(n,e,t=!1){const{auth:s}=n;if(zr(s.app))return Promise.reject(di(s));const a="reauthenticate";try{const l=await ko(n,v0(s,a,e,n),t);nt(l.idToken,s,"internal-error");const d=pp(l.idToken);nt(d,s,"internal-error");const{sub:f}=d;return nt(n.uid===f,s,"user-mismatch"),Ma._forOperation(n,a,l)}catch(l){throw(l==null?void 0:l.code)==="auth/user-not-found"&&rs(s,"user-mismatch"),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function w0(n,e,t=!1){if(zr(n.app))return Promise.reject(di(n));const s="signIn",a=await v0(n,s,e),l=await Ma._fromIdTokenResponse(n,s,a);return t||await n._updateCurrentUser(l.user),l}async function wb(n,e){return w0(la(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function x0(n){const e=la(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function xb(n,e,t){if(zr(n.app))return Promise.reject(di(n));const s=la(n),d=await jf(s,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",mb).catch(m=>{throw m.code==="auth/password-does-not-meet-requirements"&&x0(n),m}),f=await Ma._fromIdTokenResponse(s,"signIn",d);return await s._updateCurrentUser(f.user),f}function E0(n,e,t){return zr(n.app)?Promise.reject(di(n)):wb(en(n),Wo.credential(e,t)).catch(async s=>{throw s.code==="auth/password-does-not-meet-requirements"&&x0(n),s})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Eb(n,e){return Gs(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Tb(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const s=en(n),l={idToken:await s.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},d=await ko(s,Eb(s.auth,l));s.displayName=d.displayName||null,s.photoURL=d.photoUrl||null;const f=s.providerData.find(({providerId:m})=>m==="password");f&&(f.displayName=s.displayName,f.photoURL=s.photoURL),await s._updateTokensIfNecessary(d)}function Sb(n,e,t,s){return en(n).onIdTokenChanged(e,t,s)}function bb(n,e,t){return en(n).beforeAuthStateChanged(e,t)}function Cb(n,e,t,s){return en(n).onAuthStateChanged(e,t,s)}function T0(n){return en(n).signOut()}const $u="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S0{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem($u,"1"),this.storage.removeItem($u),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ib=1e3,Pb=10;class b0 extends S0{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=f0(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const s=this.storage.getItem(t),a=this.localCache[t];s!==a&&e(t,a,s)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((d,f,m)=>{this.notifyListeners(d,m)});return}const s=e.key;t?this.detachListener():this.stopPolling();const a=()=>{const d=this.storage.getItem(s);!t&&this.localCache[s]===d||this.notifyListeners(s,d)},l=this.storage.getItem(s);$1()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,Pb):a()}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const a of Array.from(s))a(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:s}),!0)})},Ib)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}b0.type="LOCAL";const Nb=b0;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C0 extends S0{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}C0.type="SESSION";const I0=C0;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rb(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class od{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(a=>a.isListeningto(e));if(t)return t;const s=new od(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:s,eventType:a,data:l}=t.data,d=this.handlersMap[a];if(!(d!=null&&d.size))return;t.ports[0].postMessage({status:"ack",eventId:s,eventType:a});const f=Array.from(d).map(async v=>v(t.origin,l)),m=await Rb(f);t.ports[0].postMessage({status:"done",eventId:s,eventType:a,response:m})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}od.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vp(n="",e=10){let t="";for(let s=0;s<e;s++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ab{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,s=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let l,d;return new Promise((f,m)=>{const v=vp("",20);a.port1.start();const w=setTimeout(()=>{m(new Error("unsupported_event"))},s);d={messageChannel:a,onMessage(T){const C=T;if(C.data.eventId===v)switch(C.data.status){case"ack":clearTimeout(w),l=setTimeout(()=>{m(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),f(C.data.response);break;default:clearTimeout(w),clearTimeout(l),m(new Error("invalid_response"));break}}},this.handlers.add(d),a.port1.addEventListener("message",d.onMessage),this.target.postMessage({eventType:e,eventId:v,data:t},[a.port2])}).finally(()=>{d&&this.removeMessageHandler(d)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fs(){return window}function jb(n){Fs().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P0(){return typeof Fs().WorkerGlobalScope<"u"&&typeof Fs().importScripts=="function"}async function kb(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Db(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function Lb(){return P0()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N0="firebaseLocalStorageDb",Vb=1,Wu="firebaseLocalStorage",R0="fbase_key";class ac{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function ld(n,e){return n.transaction([Wu],e?"readwrite":"readonly").objectStore(Wu)}function Mb(){const n=indexedDB.deleteDatabase(N0);return new ac(n).toPromise()}function kf(){const n=indexedDB.open(N0,Vb);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const s=n.result;try{s.createObjectStore(Wu,{keyPath:R0})}catch(a){t(a)}}),n.addEventListener("success",async()=>{const s=n.result;s.objectStoreNames.contains(Wu)?e(s):(s.close(),await Mb(),e(await kf()))})})}async function Xy(n,e,t){const s=ld(n,!0).put({[R0]:e,value:t});return new ac(s).toPromise()}async function Ob(n,e){const t=ld(n,!1).get(e),s=await new ac(t).toPromise();return s===void 0?null:s.value}function Zy(n,e){const t=ld(n,!0).delete(e);return new ac(t).toPromise()}const Fb=800,Ub=3;class A0{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await kf(),this.db)}async _withRetries(e){let t=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(t++>Ub)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return P0()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=od._getInstance(Lb()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await kb(),!this.activeServiceWorker)return;this.sender=new Ab(this.activeServiceWorker);const s=await this.sender._send("ping",{},800);s&&!((e=s[0])===null||e===void 0)&&e.fulfilled&&!((t=s[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Db()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await kf();return await Xy(e,$u,"1"),await Zy(e,$u),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(s=>Xy(s,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(s=>Ob(s,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Zy(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const l=ld(a,!1).getAll();return new ac(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],s=new Set;if(e.length!==0)for(const{fbase_key:a,value:l}of e)s.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(l)&&(this.notifyListeners(a,l),t.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!s.has(a)&&(this.notifyListeners(a,null),t.push(a));return t}notifyListeners(e,t){this.localCache[e]=t;const s=this.listeners[e];if(s)for(const a of Array.from(s))a(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Fb)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}A0.type="LOCAL";const zb=A0;new sc(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _p(n,e){return e?ci(e):(nt(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wp extends gp{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ro(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Ro(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Ro(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Bb(n){return w0(n.auth,new wp(n),n.bypassAuthState)}function $b(n){const{auth:e,user:t}=n;return nt(t,e,"internal-error"),_b(t,new wp(n),n.bypassAuthState)}async function Wb(n){const{auth:e,user:t}=n;return nt(t,e,"internal-error"),yb(t,new wp(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j0{constructor(e,t,s,a,l=!1){this.auth=e,this.resolver=s,this.user=a,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:s,postBody:a,tenantId:l,error:d,type:f}=e;if(d){this.reject(d);return}const m={auth:this.auth,requestUri:t,sessionId:s,tenantId:l||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(f)(m))}catch(v){this.reject(v)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Bb;case"linkViaPopup":case"linkViaRedirect":return Wb;case"reauthViaPopup":case"reauthViaRedirect":return $b;default:rs(this.auth,"internal-error")}}resolve(e){pi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){pi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gb=new sc(2e3,1e4);async function k0(n,e,t){if(zr(n.app))return Promise.reject(Es(n,"operation-not-supported-in-this-environment"));const s=la(n);e0(n,e,ad);const a=_p(s,t);return new Wi(s,"signInViaPopup",e,a).executeNotNull()}async function ev(n,e,t){const s=en(n);e0(s.auth,e,ad);const a=_p(s.auth,t);return new Wi(s.auth,"linkViaPopup",e,a,s).executeNotNull()}class Wi extends j0{constructor(e,t,s,a,l){super(e,t,a,l),this.provider=s,this.authWindow=null,this.pollId=null,Wi.currentPopupAction&&Wi.currentPopupAction.cancel(),Wi.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return nt(e,this.auth,"internal-error"),e}async onExecution(){pi(this.filter.length===1,"Popup operations only handle one event");const e=vp();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Es(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Es(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Wi.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,s;if(!((s=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||s===void 0)&&s.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Es(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Gb.get())};e()}}Wi.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qb="pendingRedirect",Cu=new Map;class Hb extends j0{constructor(e,t,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,s),this.eventId=null}async execute(){let e=Cu.get(this.auth._key());if(!e){try{const s=await Kb(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(t){e=()=>Promise.reject(t)}Cu.set(this.auth._key(),e)}return this.bypassAuthState||Cu.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Kb(n,e){const t=Jb(e),s=Yb(n);if(!await s._isAvailable())return!1;const a=await s._get(t)==="true";return await s._remove(t),a}function Qb(n,e){Cu.set(n._key(),e)}function Yb(n){return ci(n._redirectPersistence)}function Jb(n){return bu(qb,n.config.apiKey,n.name)}async function Xb(n,e,t=!1){if(zr(n.app))return Promise.reject(di(n));const s=la(n),a=_p(s,e),d=await new Hb(s,a,t).execute();return d&&!t&&(delete d.user._redirectEventId,await s._persistUserIfCurrent(d.user),await s._setRedirectUser(null,e)),d}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zb=600*1e3;class eC{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(t=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!tC(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var s;if(e.error&&!D0(e)){const a=((s=e.error.code)===null||s===void 0?void 0:s.split("auth/")[1])||"internal-error";t.onError(Es(this.auth,a))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const s=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Zb&&this.cachedEventUids.clear(),this.cachedEventUids.has(tv(e))}saveEventToCache(e){this.cachedEventUids.add(tv(e)),this.lastProcessedEventTime=Date.now()}}function tv(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function D0({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function tC(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return D0(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nC(n,e={}){return Gs(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rC=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,sC=/^https?/;async function iC(n){if(n.config.emulator)return;const{authorizedDomains:e}=await nC(n);for(const t of e)try{if(aC(t))return}catch{}rs(n,"unauthorized-domain")}function aC(n){const e=Rf(),{protocol:t,hostname:s}=new URL(e);if(n.startsWith("chrome-extension://")){const d=new URL(n);return d.hostname===""&&s===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&d.hostname===s}if(!sC.test(t))return!1;if(rC.test(n))return s===n;const a=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(s)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oC=new sc(3e4,6e4);function nv(){const n=Fs().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function lC(n){return new Promise((e,t)=>{var s,a,l;function d(){nv(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{nv(),t(Es(n,"network-request-failed"))},timeout:oC.get()})}if(!((a=(s=Fs().gapi)===null||s===void 0?void 0:s.iframes)===null||a===void 0)&&a.Iframe)e(gapi.iframes.getContext());else if(!((l=Fs().gapi)===null||l===void 0)&&l.load)d();else{const f=X1("iframefcb");return Fs()[f]=()=>{gapi.load?d():t(Es(n,"network-request-failed"))},m0(`${J1()}?onload=${f}`).catch(m=>t(m))}}).catch(e=>{throw Iu=null,e})}let Iu=null;function cC(n){return Iu=Iu||lC(n),Iu}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uC=new sc(5e3,15e3),dC="__/auth/iframe",hC="emulator/auth/iframe",fC={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},pC=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function mC(n){const e=n.config;nt(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?fp(e,hC):`https://${n.config.authDomain}/${dC}`,s={apiKey:e.apiKey,appName:n.name,v:$o},a=pC.get(n.config.apiHost);a&&(s.eid=a);const l=n._getFrameworks();return l.length&&(s.fw=l.join(",")),`${t}?${rc(s).slice(1)}`}async function gC(n){const e=await cC(n),t=Fs().gapi;return nt(t,n,"internal-error"),e.open({where:document.body,url:mC(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:fC,dontclear:!0},s=>new Promise(async(a,l)=>{await s.restyle({setHideOnLeave:!1});const d=Es(n,"network-request-failed"),f=Fs().setTimeout(()=>{l(d)},uC.get());function m(){Fs().clearTimeout(f),a(s)}s.ping(m).then(m,()=>{l(d)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yC={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},vC=500,_C=600,wC="_blank",xC="http://localhost";class rv{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function EC(n,e,t,s=vC,a=_C){const l=Math.max((window.screen.availHeight-a)/2,0).toString(),d=Math.max((window.screen.availWidth-s)/2,0).toString();let f="";const m=Object.assign(Object.assign({},yC),{width:s.toString(),height:a.toString(),top:l,left:d}),v=cr().toLowerCase();t&&(f=l0(v)?wC:t),a0(v)&&(e=e||xC,m.scrollbars="yes");const w=Object.entries(m).reduce((C,[U,X])=>`${C}${U}=${X},`,"");if(B1(v)&&f!=="_self")return TC(e||"",f),new rv(null);const T=window.open(e||"",f,w);nt(T,n,"popup-blocked");try{T.focus()}catch{}return new rv(T)}function TC(n,e){const t=document.createElement("a");t.href=n,t.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SC="__/auth/handler",bC="emulator/auth/handler",CC=encodeURIComponent("fac");async function sv(n,e,t,s,a,l){nt(n.config.authDomain,n,"auth-domain-config-required"),nt(n.config.apiKey,n,"invalid-api-key");const d={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:s,v:$o,eventId:a};if(e instanceof ad){e.setDefaultLanguage(n.languageCode),d.providerId=e.providerId||"",oS(e.getCustomParameters())||(d.customParameters=JSON.stringify(e.getCustomParameters()));for(const[w,T]of Object.entries({}))d[w]=T}if(e instanceof Go){const w=e.getScopes().filter(T=>T!=="");w.length>0&&(d.scopes=w.join(","))}n.tenantId&&(d.tid=n.tenantId);const f=d;for(const w of Object.keys(f))f[w]===void 0&&delete f[w];const m=await n._getAppCheckToken(),v=m?`#${CC}=${encodeURIComponent(m)}`:"";return`${IC(n)}?${rc(f).slice(1)}${v}`}function IC({config:n}){return n.emulator?fp(n,bC):`https://${n.authDomain}/${SC}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hf="webStorageSupport";class PC{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=I0,this._completeRedirectFn=Xb,this._overrideRedirectResult=Qb}async _openPopup(e,t,s,a){var l;pi((l=this.eventManagers[e._key()])===null||l===void 0?void 0:l.manager,"_initialize() not called before _openPopup()");const d=await sv(e,t,s,Rf(),a);return EC(e,d,vp())}async _openRedirect(e,t,s,a){await this._originValidation(e);const l=await sv(e,t,s,Rf(),a);return jb(l),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:a,promise:l}=this.eventManagers[t];return a?Promise.resolve(a):(pi(l,"If manager is not set, promise should be"),l)}const s=this.initAndGetManager(e);return this.eventManagers[t]={promise:s},s.catch(()=>{delete this.eventManagers[t]}),s}async initAndGetManager(e){const t=await gC(e),s=new eC(e);return t.register("authEvent",a=>(nt(a==null?void 0:a.authEvent,e,"invalid-auth-event"),{status:s.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=t,s}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(hf,{type:hf},a=>{var l;const d=(l=a==null?void 0:a[0])===null||l===void 0?void 0:l[hf];d!==void 0&&t(!!d),rs(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=iC(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return f0()||o0()||mp()}}const NC=PC;var iv="@firebase/auth",av="1.10.8";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RC{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(s=>{e((s==null?void 0:s.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){nt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AC(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function jC(n){jo(new Va("auth",(e,{options:t})=>{const s=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:d,authDomain:f}=s.options;nt(d&&!d.includes(":"),"invalid-api-key",{appName:s.name});const m={apiKey:d,authDomain:f,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:p0(n)},v=new K1(s,a,l,m);return sb(v,t),v},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,s)=>{e.getProvider("auth-internal").initialize()})),jo(new Va("auth-internal",e=>{const t=la(e.getProvider("auth").getImmediate());return(s=>new RC(s))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Qi(iv,av,AC(n)),Qi(iv,av,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kC=300,DC=$_("authIdTokenMaxAge")||kC;let ov=null;const LC=n=>async e=>{const t=e&&await e.getIdTokenResult(),s=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(s&&s>DC)return;const a=t==null?void 0:t.token;ov!==a&&(ov=a,await fetch(n,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function VC(n=Q_()){const e=cp(n,"auth");if(e.isInitialized())return e.getImmediate();const t=rb(n,{popupRedirectResolver:NC,persistence:[zb,Nb,I0]}),s=$_("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const l=new URL(s,location.origin);if(location.origin===l.origin){const d=LC(l.toString());bb(t,d,()=>d(t.currentUser)),Sb(t,f=>d(f))}}const a=z_("auth");return a&&ib(t,`http://${a}`),t}function MC(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}Q1({loadJS(n){return new Promise((e,t)=>{const s=document.createElement("script");s.setAttribute("src",n),s.onload=e,s.onerror=a=>{const l=Es("internal-error");l.customData=a,t(l)},s.type="text/javascript",s.charset="UTF-8",MC().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});jC("Browser");var lv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Yi,L0;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(I,P){function A(){}A.prototype=P.prototype,I.D=P.prototype,I.prototype=new A,I.prototype.constructor=I,I.C=function(M,D,N){for(var b=Array(arguments.length-2),J=2;J<arguments.length;J++)b[J-2]=arguments[J];return P.prototype[D].apply(M,b)}}function t(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(s,t),s.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(I,P,A){A||(A=0);var M=Array(16);if(typeof P=="string")for(var D=0;16>D;++D)M[D]=P.charCodeAt(A++)|P.charCodeAt(A++)<<8|P.charCodeAt(A++)<<16|P.charCodeAt(A++)<<24;else for(D=0;16>D;++D)M[D]=P[A++]|P[A++]<<8|P[A++]<<16|P[A++]<<24;P=I.g[0],A=I.g[1],D=I.g[2];var N=I.g[3],b=P+(N^A&(D^N))+M[0]+3614090360&4294967295;P=A+(b<<7&4294967295|b>>>25),b=N+(D^P&(A^D))+M[1]+3905402710&4294967295,N=P+(b<<12&4294967295|b>>>20),b=D+(A^N&(P^A))+M[2]+606105819&4294967295,D=N+(b<<17&4294967295|b>>>15),b=A+(P^D&(N^P))+M[3]+3250441966&4294967295,A=D+(b<<22&4294967295|b>>>10),b=P+(N^A&(D^N))+M[4]+4118548399&4294967295,P=A+(b<<7&4294967295|b>>>25),b=N+(D^P&(A^D))+M[5]+1200080426&4294967295,N=P+(b<<12&4294967295|b>>>20),b=D+(A^N&(P^A))+M[6]+2821735955&4294967295,D=N+(b<<17&4294967295|b>>>15),b=A+(P^D&(N^P))+M[7]+4249261313&4294967295,A=D+(b<<22&4294967295|b>>>10),b=P+(N^A&(D^N))+M[8]+1770035416&4294967295,P=A+(b<<7&4294967295|b>>>25),b=N+(D^P&(A^D))+M[9]+2336552879&4294967295,N=P+(b<<12&4294967295|b>>>20),b=D+(A^N&(P^A))+M[10]+4294925233&4294967295,D=N+(b<<17&4294967295|b>>>15),b=A+(P^D&(N^P))+M[11]+2304563134&4294967295,A=D+(b<<22&4294967295|b>>>10),b=P+(N^A&(D^N))+M[12]+1804603682&4294967295,P=A+(b<<7&4294967295|b>>>25),b=N+(D^P&(A^D))+M[13]+4254626195&4294967295,N=P+(b<<12&4294967295|b>>>20),b=D+(A^N&(P^A))+M[14]+2792965006&4294967295,D=N+(b<<17&4294967295|b>>>15),b=A+(P^D&(N^P))+M[15]+1236535329&4294967295,A=D+(b<<22&4294967295|b>>>10),b=P+(D^N&(A^D))+M[1]+4129170786&4294967295,P=A+(b<<5&4294967295|b>>>27),b=N+(A^D&(P^A))+M[6]+3225465664&4294967295,N=P+(b<<9&4294967295|b>>>23),b=D+(P^A&(N^P))+M[11]+643717713&4294967295,D=N+(b<<14&4294967295|b>>>18),b=A+(N^P&(D^N))+M[0]+3921069994&4294967295,A=D+(b<<20&4294967295|b>>>12),b=P+(D^N&(A^D))+M[5]+3593408605&4294967295,P=A+(b<<5&4294967295|b>>>27),b=N+(A^D&(P^A))+M[10]+38016083&4294967295,N=P+(b<<9&4294967295|b>>>23),b=D+(P^A&(N^P))+M[15]+3634488961&4294967295,D=N+(b<<14&4294967295|b>>>18),b=A+(N^P&(D^N))+M[4]+3889429448&4294967295,A=D+(b<<20&4294967295|b>>>12),b=P+(D^N&(A^D))+M[9]+568446438&4294967295,P=A+(b<<5&4294967295|b>>>27),b=N+(A^D&(P^A))+M[14]+3275163606&4294967295,N=P+(b<<9&4294967295|b>>>23),b=D+(P^A&(N^P))+M[3]+4107603335&4294967295,D=N+(b<<14&4294967295|b>>>18),b=A+(N^P&(D^N))+M[8]+1163531501&4294967295,A=D+(b<<20&4294967295|b>>>12),b=P+(D^N&(A^D))+M[13]+2850285829&4294967295,P=A+(b<<5&4294967295|b>>>27),b=N+(A^D&(P^A))+M[2]+4243563512&4294967295,N=P+(b<<9&4294967295|b>>>23),b=D+(P^A&(N^P))+M[7]+1735328473&4294967295,D=N+(b<<14&4294967295|b>>>18),b=A+(N^P&(D^N))+M[12]+2368359562&4294967295,A=D+(b<<20&4294967295|b>>>12),b=P+(A^D^N)+M[5]+4294588738&4294967295,P=A+(b<<4&4294967295|b>>>28),b=N+(P^A^D)+M[8]+2272392833&4294967295,N=P+(b<<11&4294967295|b>>>21),b=D+(N^P^A)+M[11]+1839030562&4294967295,D=N+(b<<16&4294967295|b>>>16),b=A+(D^N^P)+M[14]+4259657740&4294967295,A=D+(b<<23&4294967295|b>>>9),b=P+(A^D^N)+M[1]+2763975236&4294967295,P=A+(b<<4&4294967295|b>>>28),b=N+(P^A^D)+M[4]+1272893353&4294967295,N=P+(b<<11&4294967295|b>>>21),b=D+(N^P^A)+M[7]+4139469664&4294967295,D=N+(b<<16&4294967295|b>>>16),b=A+(D^N^P)+M[10]+3200236656&4294967295,A=D+(b<<23&4294967295|b>>>9),b=P+(A^D^N)+M[13]+681279174&4294967295,P=A+(b<<4&4294967295|b>>>28),b=N+(P^A^D)+M[0]+3936430074&4294967295,N=P+(b<<11&4294967295|b>>>21),b=D+(N^P^A)+M[3]+3572445317&4294967295,D=N+(b<<16&4294967295|b>>>16),b=A+(D^N^P)+M[6]+76029189&4294967295,A=D+(b<<23&4294967295|b>>>9),b=P+(A^D^N)+M[9]+3654602809&4294967295,P=A+(b<<4&4294967295|b>>>28),b=N+(P^A^D)+M[12]+3873151461&4294967295,N=P+(b<<11&4294967295|b>>>21),b=D+(N^P^A)+M[15]+530742520&4294967295,D=N+(b<<16&4294967295|b>>>16),b=A+(D^N^P)+M[2]+3299628645&4294967295,A=D+(b<<23&4294967295|b>>>9),b=P+(D^(A|~N))+M[0]+4096336452&4294967295,P=A+(b<<6&4294967295|b>>>26),b=N+(A^(P|~D))+M[7]+1126891415&4294967295,N=P+(b<<10&4294967295|b>>>22),b=D+(P^(N|~A))+M[14]+2878612391&4294967295,D=N+(b<<15&4294967295|b>>>17),b=A+(N^(D|~P))+M[5]+4237533241&4294967295,A=D+(b<<21&4294967295|b>>>11),b=P+(D^(A|~N))+M[12]+1700485571&4294967295,P=A+(b<<6&4294967295|b>>>26),b=N+(A^(P|~D))+M[3]+2399980690&4294967295,N=P+(b<<10&4294967295|b>>>22),b=D+(P^(N|~A))+M[10]+4293915773&4294967295,D=N+(b<<15&4294967295|b>>>17),b=A+(N^(D|~P))+M[1]+2240044497&4294967295,A=D+(b<<21&4294967295|b>>>11),b=P+(D^(A|~N))+M[8]+1873313359&4294967295,P=A+(b<<6&4294967295|b>>>26),b=N+(A^(P|~D))+M[15]+4264355552&4294967295,N=P+(b<<10&4294967295|b>>>22),b=D+(P^(N|~A))+M[6]+2734768916&4294967295,D=N+(b<<15&4294967295|b>>>17),b=A+(N^(D|~P))+M[13]+1309151649&4294967295,A=D+(b<<21&4294967295|b>>>11),b=P+(D^(A|~N))+M[4]+4149444226&4294967295,P=A+(b<<6&4294967295|b>>>26),b=N+(A^(P|~D))+M[11]+3174756917&4294967295,N=P+(b<<10&4294967295|b>>>22),b=D+(P^(N|~A))+M[2]+718787259&4294967295,D=N+(b<<15&4294967295|b>>>17),b=A+(N^(D|~P))+M[9]+3951481745&4294967295,I.g[0]=I.g[0]+P&4294967295,I.g[1]=I.g[1]+(D+(b<<21&4294967295|b>>>11))&4294967295,I.g[2]=I.g[2]+D&4294967295,I.g[3]=I.g[3]+N&4294967295}s.prototype.u=function(I,P){P===void 0&&(P=I.length);for(var A=P-this.blockSize,M=this.B,D=this.h,N=0;N<P;){if(D==0)for(;N<=A;)a(this,I,N),N+=this.blockSize;if(typeof I=="string"){for(;N<P;)if(M[D++]=I.charCodeAt(N++),D==this.blockSize){a(this,M),D=0;break}}else for(;N<P;)if(M[D++]=I[N++],D==this.blockSize){a(this,M),D=0;break}}this.h=D,this.o+=P},s.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var P=1;P<I.length-8;++P)I[P]=0;var A=8*this.o;for(P=I.length-8;P<I.length;++P)I[P]=A&255,A/=256;for(this.u(I),I=Array(16),P=A=0;4>P;++P)for(var M=0;32>M;M+=8)I[A++]=this.g[P]>>>M&255;return I};function l(I,P){var A=f;return Object.prototype.hasOwnProperty.call(A,I)?A[I]:A[I]=P(I)}function d(I,P){this.h=P;for(var A=[],M=!0,D=I.length-1;0<=D;D--){var N=I[D]|0;M&&N==P||(A[D]=N,M=!1)}this.g=A}var f={};function m(I){return-128<=I&&128>I?l(I,function(P){return new d([P|0],0>P?-1:0)}):new d([I|0],0>I?-1:0)}function v(I){if(isNaN(I)||!isFinite(I))return T;if(0>I)return F(v(-I));for(var P=[],A=1,M=0;I>=A;M++)P[M]=I/A|0,A*=4294967296;return new d(P,0)}function w(I,P){if(I.length==0)throw Error("number format error: empty string");if(P=P||10,2>P||36<P)throw Error("radix out of range: "+P);if(I.charAt(0)=="-")return F(w(I.substring(1),P));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var A=v(Math.pow(P,8)),M=T,D=0;D<I.length;D+=8){var N=Math.min(8,I.length-D),b=parseInt(I.substring(D,D+N),P);8>N?(N=v(Math.pow(P,N)),M=M.j(N).add(v(b))):(M=M.j(A),M=M.add(v(b)))}return M}var T=m(0),C=m(1),U=m(16777216);n=d.prototype,n.m=function(){if(q(this))return-F(this).m();for(var I=0,P=1,A=0;A<this.g.length;A++){var M=this.i(A);I+=(0<=M?M:4294967296+M)*P,P*=4294967296}return I},n.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(X(this))return"0";if(q(this))return"-"+F(this).toString(I);for(var P=v(Math.pow(I,6)),A=this,M="";;){var D=we(A,P).g;A=ie(A,D.j(P));var N=((0<A.g.length?A.g[0]:A.h)>>>0).toString(I);if(A=D,X(A))return N+M;for(;6>N.length;)N="0"+N;M=N+M}},n.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function X(I){if(I.h!=0)return!1;for(var P=0;P<I.g.length;P++)if(I.g[P]!=0)return!1;return!0}function q(I){return I.h==-1}n.l=function(I){return I=ie(this,I),q(I)?-1:X(I)?0:1};function F(I){for(var P=I.g.length,A=[],M=0;M<P;M++)A[M]=~I.g[M];return new d(A,~I.h).add(C)}n.abs=function(){return q(this)?F(this):this},n.add=function(I){for(var P=Math.max(this.g.length,I.g.length),A=[],M=0,D=0;D<=P;D++){var N=M+(this.i(D)&65535)+(I.i(D)&65535),b=(N>>>16)+(this.i(D)>>>16)+(I.i(D)>>>16);M=b>>>16,N&=65535,b&=65535,A[D]=b<<16|N}return new d(A,A[A.length-1]&-2147483648?-1:0)};function ie(I,P){return I.add(F(P))}n.j=function(I){if(X(this)||X(I))return T;if(q(this))return q(I)?F(this).j(F(I)):F(F(this).j(I));if(q(I))return F(this.j(F(I)));if(0>this.l(U)&&0>I.l(U))return v(this.m()*I.m());for(var P=this.g.length+I.g.length,A=[],M=0;M<2*P;M++)A[M]=0;for(M=0;M<this.g.length;M++)for(var D=0;D<I.g.length;D++){var N=this.i(M)>>>16,b=this.i(M)&65535,J=I.i(D)>>>16,re=I.i(D)&65535;A[2*M+2*D]+=b*re,Se(A,2*M+2*D),A[2*M+2*D+1]+=N*re,Se(A,2*M+2*D+1),A[2*M+2*D+1]+=b*J,Se(A,2*M+2*D+1),A[2*M+2*D+2]+=N*J,Se(A,2*M+2*D+2)}for(M=0;M<P;M++)A[M]=A[2*M+1]<<16|A[2*M];for(M=P;M<2*P;M++)A[M]=0;return new d(A,0)};function Se(I,P){for(;(I[P]&65535)!=I[P];)I[P+1]+=I[P]>>>16,I[P]&=65535,P++}function Ee(I,P){this.g=I,this.h=P}function we(I,P){if(X(P))throw Error("division by zero");if(X(I))return new Ee(T,T);if(q(I))return P=we(F(I),P),new Ee(F(P.g),F(P.h));if(q(P))return P=we(I,F(P)),new Ee(F(P.g),P.h);if(30<I.g.length){if(q(I)||q(P))throw Error("slowDivide_ only works with positive integers.");for(var A=C,M=P;0>=M.l(I);)A=V(A),M=V(M);var D=ae(A,1),N=ae(M,1);for(M=ae(M,2),A=ae(A,2);!X(M);){var b=N.add(M);0>=b.l(I)&&(D=D.add(A),N=b),M=ae(M,1),A=ae(A,1)}return P=ie(I,D.j(P)),new Ee(D,P)}for(D=T;0<=I.l(P);){for(A=Math.max(1,Math.floor(I.m()/P.m())),M=Math.ceil(Math.log(A)/Math.LN2),M=48>=M?1:Math.pow(2,M-48),N=v(A),b=N.j(P);q(b)||0<b.l(I);)A-=M,N=v(A),b=N.j(P);X(N)&&(N=C),D=D.add(N),I=ie(I,b)}return new Ee(D,I)}n.A=function(I){return we(this,I).h},n.and=function(I){for(var P=Math.max(this.g.length,I.g.length),A=[],M=0;M<P;M++)A[M]=this.i(M)&I.i(M);return new d(A,this.h&I.h)},n.or=function(I){for(var P=Math.max(this.g.length,I.g.length),A=[],M=0;M<P;M++)A[M]=this.i(M)|I.i(M);return new d(A,this.h|I.h)},n.xor=function(I){for(var P=Math.max(this.g.length,I.g.length),A=[],M=0;M<P;M++)A[M]=this.i(M)^I.i(M);return new d(A,this.h^I.h)};function V(I){for(var P=I.g.length+1,A=[],M=0;M<P;M++)A[M]=I.i(M)<<1|I.i(M-1)>>>31;return new d(A,I.h)}function ae(I,P){var A=P>>5;P%=32;for(var M=I.g.length-A,D=[],N=0;N<M;N++)D[N]=0<P?I.i(N+A)>>>P|I.i(N+A+1)<<32-P:I.i(N+A);return new d(D,I.h)}s.prototype.digest=s.prototype.v,s.prototype.reset=s.prototype.s,s.prototype.update=s.prototype.u,L0=s,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.A,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=v,d.fromString=w,Yi=d}).apply(typeof lv<"u"?lv:typeof self<"u"?self:typeof window<"u"?window:{});var yu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var V0,Al,M0,Pu,Df,O0,F0,U0;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,g,_){return u==Array.prototype||u==Object.prototype||(u[g]=_.value),u};function t(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof yu=="object"&&yu];for(var g=0;g<u.length;++g){var _=u[g];if(_&&_.Math==Math)return _}throw Error("Cannot find global object")}var s=t(this);function a(u,g){if(g)e:{var _=s;u=u.split(".");for(var R=0;R<u.length-1;R++){var Z=u[R];if(!(Z in _))break e;_=_[Z]}u=u[u.length-1],R=_[u],g=g(R),g!=R&&g!=null&&e(_,u,{configurable:!0,writable:!0,value:g})}}function l(u,g){u instanceof String&&(u+="");var _=0,R=!1,Z={next:function(){if(!R&&_<u.length){var oe=_++;return{value:g(oe,u[oe]),done:!1}}return R=!0,{done:!0,value:void 0}}};return Z[Symbol.iterator]=function(){return Z},Z}a("Array.prototype.values",function(u){return u||function(){return l(this,function(g,_){return _})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var d=d||{},f=this||self;function m(u){var g=typeof u;return g=g!="object"?g:u?Array.isArray(u)?"array":g:"null",g=="array"||g=="object"&&typeof u.length=="number"}function v(u){var g=typeof u;return g=="object"&&u!=null||g=="function"}function w(u,g,_){return u.call.apply(u.bind,arguments)}function T(u,g,_){if(!u)throw Error();if(2<arguments.length){var R=Array.prototype.slice.call(arguments,2);return function(){var Z=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Z,R),u.apply(g,Z)}}return function(){return u.apply(g,arguments)}}function C(u,g,_){return C=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?w:T,C.apply(null,arguments)}function U(u,g){var _=Array.prototype.slice.call(arguments,1);return function(){var R=_.slice();return R.push.apply(R,arguments),u.apply(this,R)}}function X(u,g){function _(){}_.prototype=g.prototype,u.aa=g.prototype,u.prototype=new _,u.prototype.constructor=u,u.Qb=function(R,Z,oe){for(var Le=Array(arguments.length-2),jt=2;jt<arguments.length;jt++)Le[jt-2]=arguments[jt];return g.prototype[Z].apply(R,Le)}}function q(u){const g=u.length;if(0<g){const _=Array(g);for(let R=0;R<g;R++)_[R]=u[R];return _}return[]}function F(u,g){for(let _=1;_<arguments.length;_++){const R=arguments[_];if(m(R)){const Z=u.length||0,oe=R.length||0;u.length=Z+oe;for(let Le=0;Le<oe;Le++)u[Z+Le]=R[Le]}else u.push(R)}}class ie{constructor(g,_){this.i=g,this.j=_,this.h=0,this.g=null}get(){let g;return 0<this.h?(this.h--,g=this.g,this.g=g.next,g.next=null):g=this.i(),g}}function Se(u){return/^[\s\xa0]*$/.test(u)}function Ee(){var u=f.navigator;return u&&(u=u.userAgent)?u:""}function we(u){return we[" "](u),u}we[" "]=function(){};var V=Ee().indexOf("Gecko")!=-1&&!(Ee().toLowerCase().indexOf("webkit")!=-1&&Ee().indexOf("Edge")==-1)&&!(Ee().indexOf("Trident")!=-1||Ee().indexOf("MSIE")!=-1)&&Ee().indexOf("Edge")==-1;function ae(u,g,_){for(const R in u)g.call(_,u[R],R,u)}function I(u,g){for(const _ in u)g.call(void 0,u[_],_,u)}function P(u){const g={};for(const _ in u)g[_]=u[_];return g}const A="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function M(u,g){let _,R;for(let Z=1;Z<arguments.length;Z++){R=arguments[Z];for(_ in R)u[_]=R[_];for(let oe=0;oe<A.length;oe++)_=A[oe],Object.prototype.hasOwnProperty.call(R,_)&&(u[_]=R[_])}}function D(u){var g=1;u=u.split(":");const _=[];for(;0<g&&u.length;)_.push(u.shift()),g--;return u.length&&_.push(u.join(":")),_}function N(u){f.setTimeout(()=>{throw u},0)}function b(){var u=Ne;let g=null;return u.g&&(g=u.g,u.g=u.g.next,u.g||(u.h=null),g.next=null),g}class J{constructor(){this.h=this.g=null}add(g,_){const R=re.get();R.set(g,_),this.h?this.h.next=R:this.g=R,this.h=R}}var re=new ie(()=>new Ce,u=>u.reset());class Ce{constructor(){this.next=this.g=this.h=null}set(g,_){this.h=g,this.g=_,this.next=null}reset(){this.next=this.g=this.h=null}}let de,ce=!1,Ne=new J,_e=()=>{const u=f.Promise.resolve(void 0);de=()=>{u.then(Y)}};var Y=()=>{for(var u;u=b();){try{u.h.call(u.g)}catch(_){N(_)}var g=re;g.j(u),100>g.h&&(g.h++,u.next=g.g,g.g=u)}ce=!1};function k(){this.s=this.s,this.C=this.C}k.prototype.s=!1,k.prototype.ma=function(){this.s||(this.s=!0,this.N())},k.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function H(u,g){this.type=u,this.g=this.target=g,this.defaultPrevented=!1}H.prototype.h=function(){this.defaultPrevented=!0};var Te=(function(){if(!f.addEventListener||!Object.defineProperty)return!1;var u=!1,g=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const _=()=>{};f.addEventListener("test",_,g),f.removeEventListener("test",_,g)}catch{}return u})();function De(u,g){if(H.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var _=this.type=u.type,R=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=g,g=u.relatedTarget){if(V){e:{try{we(g.nodeName);var Z=!0;break e}catch{}Z=!1}Z||(g=null)}}else _=="mouseover"?g=u.fromElement:_=="mouseout"&&(g=u.toElement);this.relatedTarget=g,R?(this.clientX=R.clientX!==void 0?R.clientX:R.pageX,this.clientY=R.clientY!==void 0?R.clientY:R.pageY,this.screenX=R.screenX||0,this.screenY=R.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:ke[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&De.aa.h.call(this)}}X(De,H);var ke={2:"touch",3:"pen",4:"mouse"};De.prototype.h=function(){De.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var Oe="closure_listenable_"+(1e6*Math.random()|0),Qe=0;function st(u,g,_,R,Z){this.listener=u,this.proxy=null,this.src=g,this.type=_,this.capture=!!R,this.ha=Z,this.key=++Qe,this.da=this.fa=!1}function ve(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function ue(u){this.src=u,this.g={},this.h=0}ue.prototype.add=function(u,g,_,R,Z){var oe=u.toString();u=this.g[oe],u||(u=this.g[oe]=[],this.h++);var Le=me(u,g,R,Z);return-1<Le?(g=u[Le],_||(g.fa=!1)):(g=new st(g,this.src,oe,!!R,Z),g.fa=_,u.push(g)),g};function Ve(u,g){var _=g.type;if(_ in u.g){var R=u.g[_],Z=Array.prototype.indexOf.call(R,g,void 0),oe;(oe=0<=Z)&&Array.prototype.splice.call(R,Z,1),oe&&(ve(g),u.g[_].length==0&&(delete u.g[_],u.h--))}}function me(u,g,_,R){for(var Z=0;Z<u.length;++Z){var oe=u[Z];if(!oe.da&&oe.listener==g&&oe.capture==!!_&&oe.ha==R)return Z}return-1}var He="closure_lm_"+(1e6*Math.random()|0),Ye={};function Tt(u,g,_,R,Z){if(Array.isArray(g)){for(var oe=0;oe<g.length;oe++)Tt(u,g[oe],_,R,Z);return null}return _=Yn(_),u&&u[Oe]?u.K(g,_,v(R)?!!R.capture:!1,Z):Ct(u,g,_,!1,R,Z)}function Ct(u,g,_,R,Z,oe){if(!g)throw Error("Invalid event type");var Le=v(Z)?!!Z.capture:!!Z,jt=ur(u);if(jt||(u[He]=jt=new ue(u)),_=jt.add(g,_,R,Le,oe),_.proxy)return _;if(R=gt(),_.proxy=R,R.src=u,R.listener=_,u.addEventListener)Te||(Z=Le),Z===void 0&&(Z=!1),u.addEventListener(g.toString(),R,Z);else if(u.attachEvent)u.attachEvent(tn(g.toString()),R);else if(u.addListener&&u.removeListener)u.addListener(R);else throw Error("addEventListener and attachEvent are unavailable.");return _}function gt(){function u(_){return g.call(u.src,u.listener,_)}const g=nn;return u}function Nt(u,g,_,R,Z){if(Array.isArray(g))for(var oe=0;oe<g.length;oe++)Nt(u,g[oe],_,R,Z);else R=v(R)?!!R.capture:!!R,_=Yn(_),u&&u[Oe]?(u=u.i,g=String(g).toString(),g in u.g&&(oe=u.g[g],_=me(oe,_,R,Z),-1<_&&(ve(oe[_]),Array.prototype.splice.call(oe,_,1),oe.length==0&&(delete u.g[g],u.h--)))):u&&(u=ur(u))&&(g=u.g[g.toString()],u=-1,g&&(u=me(g,_,R,Z)),(_=-1<u?g[u]:null)&&Yt(_))}function Yt(u){if(typeof u!="number"&&u&&!u.da){var g=u.src;if(g&&g[Oe])Ve(g.i,u);else{var _=u.type,R=u.proxy;g.removeEventListener?g.removeEventListener(_,R,u.capture):g.detachEvent?g.detachEvent(tn(_),R):g.addListener&&g.removeListener&&g.removeListener(R),(_=ur(g))?(Ve(_,u),_.h==0&&(_.src=null,g[He]=null)):ve(u)}}}function tn(u){return u in Ye?Ye[u]:Ye[u]="on"+u}function nn(u,g){if(u.da)u=!0;else{g=new De(g,this);var _=u.listener,R=u.ha||u.src;u.fa&&Yt(u),u=_.call(R,g)}return u}function ur(u){return u=u[He],u instanceof ue?u:null}var rn="__closure_events_fn_"+(1e9*Math.random()>>>0);function Yn(u){return typeof u=="function"?u:(u[rn]||(u[rn]=function(g){return u.handleEvent(g)}),u[rn])}function Ot(){k.call(this),this.i=new ue(this),this.M=this,this.F=null}X(Ot,k),Ot.prototype[Oe]=!0,Ot.prototype.removeEventListener=function(u,g,_,R){Nt(this,u,g,_,R)};function $t(u,g){var _,R=u.F;if(R)for(_=[];R;R=R.F)_.push(R);if(u=u.M,R=g.type||g,typeof g=="string")g=new H(g,u);else if(g instanceof H)g.target=g.target||u;else{var Z=g;g=new H(R,u),M(g,Z)}if(Z=!0,_)for(var oe=_.length-1;0<=oe;oe--){var Le=g.g=_[oe];Z=Un(Le,R,!0,g)&&Z}if(Le=g.g=u,Z=Un(Le,R,!0,g)&&Z,Z=Un(Le,R,!1,g)&&Z,_)for(oe=0;oe<_.length;oe++)Le=g.g=_[oe],Z=Un(Le,R,!1,g)&&Z}Ot.prototype.N=function(){if(Ot.aa.N.call(this),this.i){var u=this.i,g;for(g in u.g){for(var _=u.g[g],R=0;R<_.length;R++)ve(_[R]);delete u.g[g],u.h--}}this.F=null},Ot.prototype.K=function(u,g,_,R){return this.i.add(String(u),g,!1,_,R)},Ot.prototype.L=function(u,g,_,R){return this.i.add(String(u),g,!0,_,R)};function Un(u,g,_,R){if(g=u.i.g[String(g)],!g)return!0;g=g.concat();for(var Z=!0,oe=0;oe<g.length;++oe){var Le=g[oe];if(Le&&!Le.da&&Le.capture==_){var jt=Le.listener,Tn=Le.ha||Le.src;Le.fa&&Ve(u.i,Le),Z=jt.call(Tn,R)!==!1&&Z}}return Z&&!R.defaultPrevented}function dr(u,g,_){if(typeof u=="function")_&&(u=C(u,_));else if(u&&typeof u.handleEvent=="function")u=C(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(g)?-1:f.setTimeout(u,g||0)}function Pn(u){u.g=dr(()=>{u.g=null,u.i&&(u.i=!1,Pn(u))},u.l);const g=u.h;u.h=null,u.m.apply(null,g)}class zn extends k{constructor(g,_){super(),this.m=g,this.l=_,this.h=null,this.i=!1,this.g=null}j(g){this.h=arguments,this.g?this.i=!0:Pn(this)}N(){super.N(),this.g&&(f.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Jt(u){k.call(this),this.h=u,this.g={}}X(Jt,k);var ss=[];function Nn(u){ae(u.g,function(g,_){this.g.hasOwnProperty(_)&&Yt(g)},u),u.g={}}Jt.prototype.N=function(){Jt.aa.N.call(this),Nn(this)},Jt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var wn=f.JSON.stringify,is=f.JSON.parse,Ss=class{stringify(u){return f.JSON.stringify(u,void 0)}parse(u){return f.JSON.parse(u,void 0)}};function Pt(){}Pt.prototype.h=null;function yr(u){return u.h||(u.h=u.i())}function bs(){}var Jn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Xn(){H.call(this,"d")}X(Xn,H);function Rr(){H.call(this,"c")}X(Rr,H);var Rn={},Ar=null;function Zn(){return Ar=Ar||new Ot}Rn.La="serverreachability";function qs(u){H.call(this,Rn.La,u)}X(qs,H);function vr(u){const g=Zn();$t(g,new qs(g))}Rn.STAT_EVENT="statevent";function Hs(u,g){H.call(this,Rn.STAT_EVENT,u),this.stat=g}X(Hs,H);function Ze(u){const g=Zn();$t(g,new Hs(g,u))}Rn.Ma="timingevent";function er(u,g){H.call(this,Rn.Ma,u),this.size=g}X(er,H);function An(u,g){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return f.setTimeout(function(){u()},g)}function as(){this.g=!0}as.prototype.xa=function(){this.g=!1};function jn(u,g,_,R,Z,oe){u.info(function(){if(u.g)if(oe)for(var Le="",jt=oe.split("&"),Tn=0;Tn<jt.length;Tn++){var xt=jt[Tn].split("=");if(1<xt.length){var Ln=xt[0];xt=xt[1];var mn=Ln.split("_");Le=2<=mn.length&&mn[1]=="type"?Le+(Ln+"="+xt+"&"):Le+(Ln+"=redacted&")}}else Le=null;else Le=oe;return"XMLHTTP REQ ("+R+") [attempt "+Z+"]: "+g+`
`+_+`
`+Le})}function xn(u,g,_,R,Z,oe,Le){u.info(function(){return"XMLHTTP RESP ("+R+") [ attempt "+Z+"]: "+g+`
`+_+`
`+oe+" "+Le})}function kn(u,g,_,R){u.info(function(){return"XMLHTTP TEXT ("+g+"): "+Is(u,_)+(R?" "+R:"")})}function Cs(u,g){u.info(function(){return"TIMEOUT: "+g})}as.prototype.info=function(){};function Is(u,g){if(!u.g)return g;if(!g)return null;try{var _=JSON.parse(g);if(_){for(u=0;u<_.length;u++)if(Array.isArray(_[u])){var R=_[u];if(!(2>R.length)){var Z=R[1];if(Array.isArray(Z)&&!(1>Z.length)){var oe=Z[0];if(oe!="noop"&&oe!="stop"&&oe!="close")for(var Le=1;Le<Z.length;Le++)Z[Le]=""}}}}return wn(_)}catch{return g}}var Bn={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},$r={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Ft;function os(){}X(os,Pt),os.prototype.g=function(){return new XMLHttpRequest},os.prototype.i=function(){return{}},Ft=new os;function dn(u,g,_,R){this.j=u,this.i=g,this.l=_,this.R=R||1,this.U=new Jt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new jr}function jr(){this.i=null,this.g="",this.h=!1}var Ks={},Wr={};function ls(u,g,_){u.L=1,u.v=Ns(Dn(g)),u.m=_,u.P=!0,hn(u,null)}function hn(u,g){u.F=Date.now(),dt(u),u.A=Dn(u.v);var _=u.A,R=u.R;Array.isArray(R)||(R=[String(R)]),Lt(_.i,"t",R),u.C=0,_=u.j.J,u.h=new jr,u.g=wc(u.j,_?g:null,!u.m),0<u.O&&(u.M=new zn(C(u.Y,u,u.g),u.O)),g=u.U,_=u.g,R=u.ca;var Z="readystatechange";Array.isArray(Z)||(Z&&(ss[0]=Z.toString()),Z=ss);for(var oe=0;oe<Z.length;oe++){var Le=Tt(_,Z[oe],R||g.handleEvent,!1,g.h||g);if(!Le)break;g.g[Le.key]=Le}g=u.H?P(u.H):{},u.m?(u.u||(u.u="POST"),g["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,g)):(u.u="GET",u.g.ea(u.A,u.u,null,g)),vr(),jn(u.i,u.u,u.A,u.l,u.R,u.m)}dn.prototype.ca=function(u){u=u.target;const g=this.M;g&&_r(u)==3?g.j():this.Y(u)},dn.prototype.Y=function(u){try{if(u==this.g)e:{const mn=_r(this.g);var g=this.g.Ba();const qr=this.g.Z();if(!(3>mn)&&(mn!=3||this.g&&(this.h.h||this.g.oa()||Zo(this.g)))){this.J||mn!=4||g==7||(g==8||0>=qr?vr(3):vr(2)),fn(this);var _=this.g.Z();this.X=_;t:if(Qs(this)){var R=Zo(this.g);u="";var Z=R.length,oe=_r(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){x(this),pn(this);var Le="";break t}this.h.i=new f.TextDecoder}for(g=0;g<Z;g++)this.h.h=!0,u+=this.h.i.decode(R[g],{stream:!(oe&&g==Z-1)});R.length=0,this.h.g+=u,this.C=0,Le=this.h.g}else Le=this.g.oa();if(this.o=_==200,xn(this.i,this.u,this.A,this.l,this.R,mn,_),this.o){if(this.T&&!this.K){t:{if(this.g){var jt,Tn=this.g;if((jt=Tn.g?Tn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Se(jt)){var xt=jt;break t}}xt=null}if(_=xt)kn(this.i,this.l,_,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,z(this,_);else{this.o=!1,this.s=3,Ze(12),x(this),pn(this);break e}}if(this.P){_=!0;let Mr;for(;!this.J&&this.C<Le.length;)if(Mr=Ys(this,Le),Mr==Wr){mn==4&&(this.s=4,Ze(14),_=!1),kn(this.i,this.l,null,"[Incomplete Response]");break}else if(Mr==Ks){this.s=4,Ze(15),kn(this.i,this.l,Le,"[Invalid Chunk]"),_=!1;break}else kn(this.i,this.l,Mr,null),z(this,Mr);if(Qs(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),mn!=4||Le.length!=0||this.h.h||(this.s=1,Ze(16),_=!1),this.o=this.o&&_,!_)kn(this.i,this.l,Le,"[Invalid Chunked Response]"),x(this),pn(this);else if(0<Le.length&&!this.W){this.W=!0;var Ln=this.j;Ln.g==this&&Ln.ba&&!Ln.M&&(Ln.j.info("Great, no buffering proxy detected. Bytes received: "+Le.length),tl(Ln),Ln.M=!0,Ze(11))}}else kn(this.i,this.l,Le,null),z(this,Le);mn==4&&x(this),this.o&&!this.J&&(mn==4?Ja(this.j,this):(this.o=!1,dt(this)))}else qa(this.g),_==400&&0<Le.indexOf("Unknown SID")?(this.s=3,Ze(12)):(this.s=0,Ze(13)),x(this),pn(this)}}}catch{}finally{}};function Qs(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function Ys(u,g){var _=u.C,R=g.indexOf(`
`,_);return R==-1?Wr:(_=Number(g.substring(_,R)),isNaN(_)?Ks:(R+=1,R+_>g.length?Wr:(g=g.slice(R,R+_),u.C=R+_,g)))}dn.prototype.cancel=function(){this.J=!0,x(this)};function dt(u){u.S=Date.now()+u.I,hr(u,u.I)}function hr(u,g){if(u.B!=null)throw Error("WatchDog timer not null");u.B=An(C(u.ba,u),g)}function fn(u){u.B&&(f.clearTimeout(u.B),u.B=null)}dn.prototype.ba=function(){this.B=null;const u=Date.now();0<=u-this.S?(Cs(this.i,this.A),this.L!=2&&(vr(),Ze(17)),x(this),this.s=2,pn(this)):hr(this,this.S-u)};function pn(u){u.j.G==0||u.J||Ja(u.j,u)}function x(u){fn(u);var g=u.M;g&&typeof g.ma=="function"&&g.ma(),u.M=null,Nn(u.U),u.g&&(g=u.g,u.g=null,g.abort(),g.ma())}function z(u,g){try{var _=u.j;if(_.G!=0&&(_.g==u||ne(_.h,u))){if(!u.K&&ne(_.h,u)&&_.G==3){try{var R=_.Da.g.parse(g)}catch{R=null}if(Array.isArray(R)&&R.length==3){var Z=R;if(Z[0]==0){e:if(!_.u){if(_.g)if(_.g.F+3e3<u.F)Ya(_),ds(_);else break e;Qa(_),Ze(18)}}else _.za=Z[1],0<_.za-_.T&&37500>Z[2]&&_.F&&_.v==0&&!_.C&&(_.C=An(C(_.Za,_),6e3));if(1>=pe(_.h)&&_.ca){try{_.ca()}catch{}_.ca=void 0}}else Zs(_,11)}else if((u.K||_.g==u)&&Ya(_),!Se(g))for(Z=_.Da.g.parse(g),g=0;g<Z.length;g++){let xt=Z[g];if(_.T=xt[0],xt=xt[1],_.G==2)if(xt[0]=="c"){_.K=xt[1],_.ia=xt[2];const Ln=xt[3];Ln!=null&&(_.la=Ln,_.j.info("VER="+_.la));const mn=xt[4];mn!=null&&(_.Aa=mn,_.j.info("SVER="+_.Aa));const qr=xt[5];qr!=null&&typeof qr=="number"&&0<qr&&(R=1.5*qr,_.L=R,_.j.info("backChannelRequestTimeoutMs_="+R)),R=_;const Mr=u.g;if(Mr){const fa=Mr.g?Mr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(fa){var oe=R.h;oe.g||fa.indexOf("spdy")==-1&&fa.indexOf("quic")==-1&&fa.indexOf("h2")==-1||(oe.j=oe.l,oe.g=new Set,oe.h&&(Me(oe,oe.h),oe.h=null))}if(R.D){const Za=Mr.g?Mr.g.getResponseHeader("X-HTTP-Session-Id"):null;Za&&(R.ya=Za,Rt(R.I,R.D,Za))}}_.G=3,_.l&&_.l.ua(),_.ba&&(_.R=Date.now()-u.F,_.j.info("Handshake RTT: "+_.R+"ms")),R=_;var Le=u;if(R.qa=_c(R,R.J?R.ia:null,R.W),Le.K){ge(R.h,Le);var jt=Le,Tn=R.L;Tn&&(jt.I=Tn),jt.B&&(fn(jt),dt(jt)),R.g=Le}else ha(R);0<_.i.length&&js(_)}else xt[0]!="stop"&&xt[0]!="close"||Zs(_,7);else _.G==3&&(xt[0]=="stop"||xt[0]=="close"?xt[0]=="stop"?Zs(_,7):Wn(_):xt[0]!="noop"&&_.l&&_.l.ta(xt),_.v=0)}}vr(4)}catch{}}var $=class{constructor(u,g){this.g=u,this.map=g}};function O(u){this.l=u||10,f.PerformanceNavigationTiming?(u=f.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(f.chrome&&f.chrome.loadTimes&&f.chrome.loadTimes()&&f.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function W(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function pe(u){return u.h?1:u.g?u.g.size:0}function ne(u,g){return u.h?u.h==g:u.g?u.g.has(g):!1}function Me(u,g){u.g?u.g.add(g):u.h=g}function ge(u,g){u.h&&u.h==g?u.h=null:u.g&&u.g.has(g)&&u.g.delete(g)}O.prototype.cancel=function(){if(this.i=Be(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function Be(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let g=u.i;for(const _ of u.g.values())g=g.concat(_.D);return g}return q(u.i)}function le(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(m(u)){for(var g=[],_=u.length,R=0;R<_;R++)g.push(u[R]);return g}g=[],_=0;for(R in u)g[_++]=u[R];return g}function rt(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(m(u)||typeof u=="string"){var g=[];u=u.length;for(var _=0;_<u;_++)g.push(_);return g}g=[],_=0;for(const R in u)g[_++]=R;return g}}}function Re(u,g){if(u.forEach&&typeof u.forEach=="function")u.forEach(g,void 0);else if(m(u)||typeof u=="string")Array.prototype.forEach.call(u,g,void 0);else for(var _=rt(u),R=le(u),Z=R.length,oe=0;oe<Z;oe++)g.call(void 0,R[oe],_&&_[oe],u)}var ht=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ps(u,g){if(u){u=u.split("&");for(var _=0;_<u.length;_++){var R=u[_].indexOf("="),Z=null;if(0<=R){var oe=u[_].substring(0,R);Z=u[_].substring(R+1)}else oe=u[_];g(oe,Z?decodeURIComponent(Z.replace(/\+/g," ")):"")}}}function sn(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof sn){this.h=u.h,fr(this,u.j),this.o=u.o,this.g=u.g,kr(this,u.s),this.l=u.l;var g=u.i,_=new Ae;_.i=g.i,g.g&&(_.g=new Map(g.g),_.h=g.h),cs(this,_),this.m=u.m}else u&&(g=String(u).match(ht))?(this.h=!1,fr(this,g[1]||"",!0),this.o=pt(g[2]||""),this.g=pt(g[3]||"",!0),kr(this,g[4]),this.l=pt(g[5]||"",!0),cs(this,g[6]||"",!0),this.m=pt(g[7]||"")):(this.h=!1,this.i=new Ae(null,this.h))}sn.prototype.toString=function(){var u=[],g=this.j;g&&u.push(Rs(g,B,!0),":");var _=this.g;return(_||g=="file")&&(u.push("//"),(g=this.o)&&u.push(Rs(g,B,!0),"@"),u.push(encodeURIComponent(String(_)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_=this.s,_!=null&&u.push(":",String(_))),(_=this.l)&&(this.g&&_.charAt(0)!="/"&&u.push("/"),u.push(Rs(_,_.charAt(0)=="/"?he:Q,!0))),(_=this.i.toString())&&u.push("?",_),(_=this.m)&&u.push("#",Rs(_,Ge)),u.join("")};function Dn(u){return new sn(u)}function fr(u,g,_){u.j=_?pt(g,!0):g,u.j&&(u.j=u.j.replace(/:$/,""))}function kr(u,g){if(g){if(g=Number(g),isNaN(g)||0>g)throw Error("Bad port number "+g);u.s=g}else u.s=null}function cs(u,g,_){g instanceof Ae?(u.i=g,an(u.i,u.h)):(_||(g=Rs(g,Ie)),u.i=new Ae(g,u.h))}function Rt(u,g,_){u.i.set(g,_)}function Ns(u){return Rt(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function pt(u,g){return u?g?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function Rs(u,g,_){return typeof u=="string"?(u=encodeURI(u).replace(g,S),_&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function S(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var B=/[#\/\?@]/g,Q=/[#\?:]/g,he=/[#\?]/g,Ie=/[#\?@]/g,Ge=/#/g;function Ae(u,g){this.h=this.g=null,this.i=u||null,this.j=!!g}function Je(u){u.g||(u.g=new Map,u.h=0,u.i&&Ps(u.i,function(g,_){u.add(decodeURIComponent(g.replace(/\+/g," ")),_)}))}n=Ae.prototype,n.add=function(u,g){Je(this),this.i=null,u=St(this,u);var _=this.g.get(u);return _||this.g.set(u,_=[]),_.push(g),this.h+=1,this};function ut(u,g){Je(u),g=St(u,g),u.g.has(g)&&(u.i=null,u.h-=u.g.get(g).length,u.g.delete(g))}function yt(u,g){return Je(u),g=St(u,g),u.g.has(g)}n.forEach=function(u,g){Je(this),this.g.forEach(function(_,R){_.forEach(function(Z){u.call(g,Z,R,this)},this)},this)},n.na=function(){Je(this);const u=Array.from(this.g.values()),g=Array.from(this.g.keys()),_=[];for(let R=0;R<g.length;R++){const Z=u[R];for(let oe=0;oe<Z.length;oe++)_.push(g[R])}return _},n.V=function(u){Je(this);let g=[];if(typeof u=="string")yt(this,u)&&(g=g.concat(this.g.get(St(this,u))));else{u=Array.from(this.g.values());for(let _=0;_<u.length;_++)g=g.concat(u[_])}return g},n.set=function(u,g){return Je(this),this.i=null,u=St(this,u),yt(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[g]),this.h+=1,this},n.get=function(u,g){return u?(u=this.V(u),0<u.length?String(u[0]):g):g};function Lt(u,g,_){ut(u,g),0<_.length&&(u.i=null,u.g.set(St(u,g),q(_)),u.h+=_.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],g=Array.from(this.g.keys());for(var _=0;_<g.length;_++){var R=g[_];const oe=encodeURIComponent(String(R)),Le=this.V(R);for(R=0;R<Le.length;R++){var Z=oe;Le[R]!==""&&(Z+="="+encodeURIComponent(String(Le[R]))),u.push(Z)}}return this.i=u.join("&")};function St(u,g){return g=String(g),u.j&&(g=g.toLowerCase()),g}function an(u,g){g&&!u.j&&(Je(u),u.i=null,u.g.forEach(function(_,R){var Z=R.toLowerCase();R!=Z&&(ut(this,R),Lt(this,Z,_))},u)),u.j=g}function En(u,g){const _=new as;if(f.Image){const R=new Image;R.onload=U(on,_,"TestLoadImage: loaded",!0,g,R),R.onerror=U(on,_,"TestLoadImage: error",!1,g,R),R.onabort=U(on,_,"TestLoadImage: abort",!1,g,R),R.ontimeout=U(on,_,"TestLoadImage: timeout",!1,g,R),f.setTimeout(function(){R.ontimeout&&R.ontimeout()},1e4),R.src=u}else g(!1)}function wt(u,g){const _=new as,R=new AbortController,Z=setTimeout(()=>{R.abort(),on(_,"TestPingServer: timeout",!1,g)},1e4);fetch(u,{signal:R.signal}).then(oe=>{clearTimeout(Z),oe.ok?on(_,"TestPingServer: ok",!0,g):on(_,"TestPingServer: server error",!1,g)}).catch(()=>{clearTimeout(Z),on(_,"TestPingServer: error",!1,g)})}function on(u,g,_,R,Z){try{Z&&(Z.onload=null,Z.onerror=null,Z.onabort=null,Z.ontimeout=null),R(_)}catch{}}function tr(){this.g=new Ss}function Gr(u,g,_){const R=_||"";try{Re(u,function(Z,oe){let Le=Z;v(Z)&&(Le=wn(Z)),g.push(R+oe+"="+encodeURIComponent(Le))})}catch(Z){throw g.push(R+"type="+encodeURIComponent("_badmap")),Z}}function Dr(u){this.l=u.Ub||null,this.j=u.eb||!1}X(Dr,Pt),Dr.prototype.g=function(){return new Js(this.l,this.j)},Dr.prototype.i=(function(u){return function(){return u}})({});function Js(u,g){Ot.call(this),this.D=u,this.o=g,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}X(Js,Ot),n=Js.prototype,n.open=function(u,g){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=g,this.readyState=1,$n(this)},n.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const g={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(g.body=u),(this.D||f).fetch(new Request(this.A,g)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Lr(this)),this.readyState=0},n.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,$n(this)),this.g&&(this.readyState=3,$n(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof f.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;$a(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function $a(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}n.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var g=u.value?u.value:new Uint8Array(0);(g=this.v.decode(g,{stream:!u.done}))&&(this.response=this.responseText+=g)}u.done?Lr(this):$n(this),this.readyState==3&&$a(this)}},n.Ra=function(u){this.g&&(this.response=this.responseText=u,Lr(this))},n.Qa=function(u){this.g&&(this.response=u,Lr(this))},n.ga=function(){this.g&&Lr(this)};function Lr(u){u.readyState=4,u.l=null,u.j=null,u.v=null,$n(u)}n.setRequestHeader=function(u,g){this.u.append(u,g)},n.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],g=this.h.entries();for(var _=g.next();!_.done;)_=_.value,u.push(_[0]+": "+_[1]),_=g.next();return u.join(`\r
`)};function $n(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(Js.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function us(u){let g="";return ae(u,function(_,R){g+=R,g+=":",g+=_,g+=`\r
`}),g}function Ei(u,g,_){e:{for(R in _){var R=!1;break e}R=!0}R||(_=us(_),typeof u=="string"?_!=null&&encodeURIComponent(String(_)):Rt(u,g,_))}function Wt(u){Ot.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}X(Wt,Ot);var jd=/^https?$/i,Jo=["POST","PUT"];n=Wt.prototype,n.Ha=function(u){this.J=u},n.ea=function(u,g,_,R){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);g=g?g.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ft.g(),this.v=this.o?yr(this.o):yr(Ft),this.g.onreadystatechange=C(this.Ea,this);try{this.B=!0,this.g.open(g,String(u),!0),this.B=!1}catch(oe){da(this,oe);return}if(u=_||"",_=new Map(this.headers),R)if(Object.getPrototypeOf(R)===Object.prototype)for(var Z in R)_.set(Z,R[Z]);else if(typeof R.keys=="function"&&typeof R.get=="function")for(const oe of R.keys())_.set(oe,R.get(oe));else throw Error("Unknown input type for opt_headers: "+String(R));R=Array.from(_.keys()).find(oe=>oe.toLowerCase()=="content-type"),Z=f.FormData&&u instanceof f.FormData,!(0<=Array.prototype.indexOf.call(Jo,g,void 0))||R||Z||_.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[oe,Le]of _)this.g.setRequestHeader(oe,Le);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Ga(this),this.u=!0,this.g.send(u),this.u=!1}catch(oe){da(this,oe)}};function da(u,g){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=g,u.m=5,Wa(u),Vr(u)}function Wa(u){u.A||(u.A=!0,$t(u,"complete"),$t(u,"error"))}n.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,$t(this,"complete"),$t(this,"abort"),Vr(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Vr(this,!0)),Wt.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Xo(this):this.bb())},n.bb=function(){Xo(this)};function Xo(u){if(u.h&&typeof d<"u"&&(!u.v[1]||_r(u)!=4||u.Z()!=2)){if(u.u&&_r(u)==4)dr(u.Ea,0,u);else if($t(u,"readystatechange"),_r(u)==4){u.h=!1;try{const Le=u.Z();e:switch(Le){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var g=!0;break e;default:g=!1}var _;if(!(_=g)){var R;if(R=Le===0){var Z=String(u.D).match(ht)[1]||null;!Z&&f.self&&f.self.location&&(Z=f.self.location.protocol.slice(0,-1)),R=!jd.test(Z?Z.toLowerCase():"")}_=R}if(_)$t(u,"complete"),$t(u,"success");else{u.m=6;try{var oe=2<_r(u)?u.g.statusText:""}catch{oe=""}u.l=oe+" ["+u.Z()+"]",Wa(u)}}finally{Vr(u)}}}}function Vr(u,g){if(u.g){Ga(u);const _=u.g,R=u.v[0]?()=>{}:null;u.g=null,u.v=null,g||$t(u,"ready");try{_.onreadystatechange=R}catch{}}}function Ga(u){u.I&&(f.clearTimeout(u.I),u.I=null)}n.isActive=function(){return!!this.g};function _r(u){return u.g?u.g.readyState:0}n.Z=function(){try{return 2<_r(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(u){if(this.g){var g=this.g.responseText;return u&&g.indexOf(u)==0&&(g=g.substring(u.length)),is(g)}};function Zo(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function qa(u){const g={};u=(u.g&&2<=_r(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let R=0;R<u.length;R++){if(Se(u[R]))continue;var _=D(u[R]);const Z=_[0];if(_=_[1],typeof _!="string")continue;_=_.trim();const oe=g[Z]||[];g[Z]=oe,oe.push(_)}I(g,function(R){return R.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function As(u,g,_){return _&&_.internalChannelParams&&_.internalChannelParams[u]||g}function el(u){this.Aa=0,this.i=[],this.j=new as,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=As("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=As("baseRetryDelayMs",5e3,u),this.cb=As("retryDelaySeedMs",1e4,u),this.Wa=As("forwardChannelMaxRetries",2,u),this.wa=As("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new O(u&&u.concurrentRequestLimit),this.Da=new tr,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=el.prototype,n.la=8,n.G=1,n.connect=function(u,g,_,R){Ze(0),this.W=u,this.H=g||{},_&&R!==void 0&&(this.H.OSID=_,this.H.OAID=R),this.F=this.X,this.I=_c(this,null,this.W),js(this)};function Wn(u){if(Ha(u),u.G==3){var g=u.U++,_=Dn(u.I);if(Rt(_,"SID",u.K),Rt(_,"RID",g),Rt(_,"TYPE","terminate"),Xs(u,_),g=new dn(u,u.j,g),g.L=2,g.v=Ns(Dn(_)),_=!1,f.navigator&&f.navigator.sendBeacon)try{_=f.navigator.sendBeacon(g.v.toString(),"")}catch{}!_&&f.Image&&(new Image().src=g.v,_=!0),_||(g.g=wc(g.j,null),g.g.ea(g.v)),g.F=Date.now(),dt(g)}vc(u)}function ds(u){u.g&&(tl(u),u.g.cancel(),u.g=null)}function Ha(u){ds(u),u.u&&(f.clearTimeout(u.u),u.u=null),Ya(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&f.clearTimeout(u.s),u.s=null)}function js(u){if(!W(u.h)&&!u.s){u.s=!0;var g=u.Ga;de||_e(),ce||(de(),ce=!0),Ne.add(g,u),u.B=0}}function kd(u,g){return pe(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=g.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=An(C(u.Ga,u,g),yc(u,u.B)),u.B++,!0)}n.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;const Z=new dn(this,this.j,u);let oe=this.o;if(this.S&&(oe?(oe=P(oe),M(oe,this.S)):oe=this.S),this.m!==null||this.O||(Z.H=oe,oe=null),this.P)e:{for(var g=0,_=0;_<this.i.length;_++){t:{var R=this.i[_];if("__data__"in R.map&&(R=R.map.__data__,typeof R=="string")){R=R.length;break t}R=void 0}if(R===void 0)break;if(g+=R,4096<g){g=_;break e}if(g===4096||_===this.i.length-1){g=_+1;break e}}g=1e3}else g=1e3;g=Ti(this,Z,g),_=Dn(this.I),Rt(_,"RID",u),Rt(_,"CVER",22),this.D&&Rt(_,"X-HTTP-Session-Id",this.D),Xs(this,_),oe&&(this.O?g="headers="+encodeURIComponent(String(us(oe)))+"&"+g:this.m&&Ei(_,this.m,oe)),Me(this.h,Z),this.Ua&&Rt(_,"TYPE","init"),this.P?(Rt(_,"$req",g),Rt(_,"SID","null"),Z.T=!0,ls(Z,_,null)):ls(Z,_,g),this.G=2}}else this.G==3&&(u?Ka(this,u):this.i.length==0||W(this.h)||Ka(this))};function Ka(u,g){var _;g?_=g.l:_=u.U++;const R=Dn(u.I);Rt(R,"SID",u.K),Rt(R,"RID",_),Rt(R,"AID",u.T),Xs(u,R),u.m&&u.o&&Ei(R,u.m,u.o),_=new dn(u,u.j,_,u.B+1),u.m===null&&(_.H=u.o),g&&(u.i=g.D.concat(u.i)),g=Ti(u,_,1e3),_.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),Me(u.h,_),ls(_,R,g)}function Xs(u,g){u.H&&ae(u.H,function(_,R){Rt(g,R,_)}),u.l&&Re({},function(_,R){Rt(g,R,_)})}function Ti(u,g,_){_=Math.min(u.i.length,_);var R=u.l?C(u.l.Na,u.l,u):null;e:{var Z=u.i;let oe=-1;for(;;){const Le=["count="+_];oe==-1?0<_?(oe=Z[0].g,Le.push("ofs="+oe)):oe=0:Le.push("ofs="+oe);let jt=!0;for(let Tn=0;Tn<_;Tn++){let xt=Z[Tn].g;const Ln=Z[Tn].map;if(xt-=oe,0>xt)oe=Math.max(0,Z[Tn].g-100),jt=!1;else try{Gr(Ln,Le,"req"+xt+"_")}catch{R&&R(Ln)}}if(jt){R=Le.join("&");break e}}}return u=u.i.splice(0,_),g.D=u,R}function ha(u){if(!u.g&&!u.u){u.Y=1;var g=u.Fa;de||_e(),ce||(de(),ce=!0),Ne.add(g,u),u.v=0}}function Qa(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=An(C(u.Fa,u),yc(u,u.v)),u.v++,!0)}n.Fa=function(){if(this.u=null,gc(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=An(C(this.ab,this),u)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ze(10),ds(this),gc(this))};function tl(u){u.A!=null&&(f.clearTimeout(u.A),u.A=null)}function gc(u){u.g=new dn(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var g=Dn(u.qa);Rt(g,"RID","rpc"),Rt(g,"SID",u.K),Rt(g,"AID",u.T),Rt(g,"CI",u.F?"0":"1"),!u.F&&u.ja&&Rt(g,"TO",u.ja),Rt(g,"TYPE","xmlhttp"),Xs(u,g),u.m&&u.o&&Ei(g,u.m,u.o),u.L&&(u.g.I=u.L);var _=u.g;u=u.ia,_.L=1,_.v=Ns(Dn(g)),_.m=null,_.P=!0,hn(_,u)}n.Za=function(){this.C!=null&&(this.C=null,ds(this),Qa(this),Ze(19))};function Ya(u){u.C!=null&&(f.clearTimeout(u.C),u.C=null)}function Ja(u,g){var _=null;if(u.g==g){Ya(u),tl(u),u.g=null;var R=2}else if(ne(u.h,g))_=g.D,ge(u.h,g),R=1;else return;if(u.G!=0){if(g.o)if(R==1){_=g.m?g.m.length:0,g=Date.now()-g.F;var Z=u.B;R=Zn(),$t(R,new er(R,_)),js(u)}else ha(u);else if(Z=g.s,Z==3||Z==0&&0<g.X||!(R==1&&kd(u,g)||R==2&&Qa(u)))switch(_&&0<_.length&&(g=u.h,g.i=g.i.concat(_)),Z){case 1:Zs(u,5);break;case 4:Zs(u,10);break;case 3:Zs(u,6);break;default:Zs(u,2)}}}function yc(u,g){let _=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(_*=2),_*g}function Zs(u,g){if(u.j.info("Error code "+g),g==2){var _=C(u.fb,u),R=u.Xa;const Z=!R;R=new sn(R||"//www.google.com/images/cleardot.gif"),f.location&&f.location.protocol=="http"||fr(R,"https"),Ns(R),Z?En(R.toString(),_):wt(R.toString(),_)}else Ze(2);u.G=0,u.l&&u.l.sa(g),vc(u),Ha(u)}n.fb=function(u){u?(this.j.info("Successfully pinged google.com"),Ze(2)):(this.j.info("Failed to ping google.com"),Ze(1))};function vc(u){if(u.G=0,u.ka=[],u.l){const g=Be(u.h);(g.length!=0||u.i.length!=0)&&(F(u.ka,g),F(u.ka,u.i),u.h.i.length=0,q(u.i),u.i.length=0),u.l.ra()}}function _c(u,g,_){var R=_ instanceof sn?Dn(_):new sn(_);if(R.g!="")g&&(R.g=g+"."+R.g),kr(R,R.s);else{var Z=f.location;R=Z.protocol,g=g?g+"."+Z.hostname:Z.hostname,Z=+Z.port;var oe=new sn(null);R&&fr(oe,R),g&&(oe.g=g),Z&&kr(oe,Z),_&&(oe.l=_),R=oe}return _=u.D,g=u.ya,_&&g&&Rt(R,_,g),Rt(R,"VER",u.la),Xs(u,R),R}function wc(u,g,_){if(g&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return g=u.Ca&&!u.pa?new Wt(new Dr({eb:_})):new Wt(u.pa),g.Ha(u.J),g}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function nl(){}n=nl.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Xa(){}Xa.prototype.g=function(u,g){return new pr(u,g)};function pr(u,g){Ot.call(this),this.g=new el(g),this.l=u,this.h=g&&g.messageUrlParams||null,u=g&&g.messageHeaders||null,g&&g.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=g&&g.initMessageHeaders||null,g&&g.messageContentType&&(u?u["X-WebChannel-Content-Type"]=g.messageContentType:u={"X-WebChannel-Content-Type":g.messageContentType}),g&&g.va&&(u?u["X-WebChannel-Client-Profile"]=g.va:u={"X-WebChannel-Client-Profile":g.va}),this.g.S=u,(u=g&&g.Sb)&&!Se(u)&&(this.g.m=u),this.v=g&&g.supportsCrossDomainXhr||!1,this.u=g&&g.sendRawJson||!1,(g=g&&g.httpSessionIdParam)&&!Se(g)&&(this.g.D=g,u=this.h,u!==null&&g in u&&(u=this.h,g in u&&delete u[g])),this.j=new ks(this)}X(pr,Ot),pr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},pr.prototype.close=function(){Wn(this.g)},pr.prototype.o=function(u){var g=this.g;if(typeof u=="string"){var _={};_.__data__=u,u=_}else this.u&&(_={},_.__data__=wn(u),u=_);g.i.push(new $(g.Ya++,u)),g.G==3&&js(g)},pr.prototype.N=function(){this.g.l=null,delete this.j,Wn(this.g),delete this.g,pr.aa.N.call(this)};function xc(u){Xn.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var g=u.__sm__;if(g){e:{for(const _ in g){u=_;break e}u=void 0}(this.i=u)&&(u=this.i,g=g!==null&&u in g?g[u]:void 0),this.data=g}else this.data=u}X(xc,Xn);function Ec(){Rr.call(this),this.status=1}X(Ec,Rr);function ks(u){this.g=u}X(ks,nl),ks.prototype.ua=function(){$t(this.g,"a")},ks.prototype.ta=function(u){$t(this.g,new xc(u))},ks.prototype.sa=function(u){$t(this.g,new Ec)},ks.prototype.ra=function(){$t(this.g,"b")},Xa.prototype.createWebChannel=Xa.prototype.g,pr.prototype.send=pr.prototype.o,pr.prototype.open=pr.prototype.m,pr.prototype.close=pr.prototype.close,U0=function(){return new Xa},F0=function(){return Zn()},O0=Rn,Df={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Bn.NO_ERROR=0,Bn.TIMEOUT=8,Bn.HTTP_ERROR=6,Pu=Bn,$r.COMPLETE="complete",M0=$r,bs.EventType=Jn,Jn.OPEN="a",Jn.CLOSE="b",Jn.ERROR="c",Jn.MESSAGE="d",Ot.prototype.listen=Ot.prototype.K,Al=bs,Wt.prototype.listenOnce=Wt.prototype.L,Wt.prototype.getLastError=Wt.prototype.Ka,Wt.prototype.getLastErrorCode=Wt.prototype.Ba,Wt.prototype.getStatus=Wt.prototype.Z,Wt.prototype.getResponseJson=Wt.prototype.Oa,Wt.prototype.getResponseText=Wt.prototype.oa,Wt.prototype.send=Wt.prototype.ea,Wt.prototype.setWithCredentials=Wt.prototype.Ha,V0=Wt}).apply(typeof yu<"u"?yu:typeof self<"u"?self:typeof window<"u"?window:{});const cv="@firebase/firestore",uv="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class or{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}or.UNAUTHENTICATED=new or(null),or.GOOGLE_CREDENTIALS=new or("google-credentials-uid"),or.FIRST_PARTY=new or("first-party-uid"),or.MOCK_USER=new or("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let qo="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oa=new op("@firebase/firestore");function So(){return Oa.logLevel}function ze(n,...e){if(Oa.logLevel<=vt.DEBUG){const t=e.map(xp);Oa.debug(`Firestore (${qo}): ${n}`,...t)}}function gi(n,...e){if(Oa.logLevel<=vt.ERROR){const t=e.map(xp);Oa.error(`Firestore (${qo}): ${n}`,...t)}}function Xi(n,...e){if(Oa.logLevel<=vt.WARN){const t=e.map(xp);Oa.warn(`Firestore (${qo}): ${n}`,...t)}}function xp(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function it(n,e,t){let s="Unexpected state";typeof e=="string"?s=e:t=e,z0(n,s,t)}function z0(n,e,t){let s=`FIRESTORE (${qo}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{s+=" CONTEXT: "+JSON.stringify(t)}catch{s+=" CONTEXT: "+t}throw gi(s),new Error(s)}function At(n,e,t,s){let a="Unexpected state";typeof t=="string"?a=t:s=t,n||z0(e,a,s)}function ct(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Fe extends wi{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hi{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B0{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class OC{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(or.UNAUTHENTICATED)))}shutdown(){}}class FC{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class UC{constructor(e){this.t=e,this.currentUser=or.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){At(this.o===void 0,42304);let s=this.i;const a=m=>this.i!==s?(s=this.i,t(m)):Promise.resolve();let l=new hi;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new hi,e.enqueueRetryable((()=>a(this.currentUser)))};const d=()=>{const m=l;e.enqueueRetryable((async()=>{await m.promise,await a(this.currentUser)}))},f=m=>{ze("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=m,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit((m=>f(m))),setTimeout((()=>{if(!this.auth){const m=this.t.getImmediate({optional:!0});m?f(m):(ze("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new hi)}}),0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((s=>this.i!==e?(ze("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(At(typeof s.accessToken=="string",31837,{l:s}),new B0(s.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return At(e===null||typeof e=="string",2055,{h:e}),new or(e)}}class zC{constructor(e,t,s){this.P=e,this.T=t,this.I=s,this.type="FirstParty",this.user=or.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class BC{constructor(e,t,s){this.P=e,this.T=t,this.I=s}getToken(){return Promise.resolve(new zC(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(or.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class dv{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class $C{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,zr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){At(this.o===void 0,3512);const s=l=>{l.error!=null&&ze("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const d=l.token!==this.m;return this.m=l.token,ze("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?t(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable((()=>s(l)))};const a=l=>{ze("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((l=>a(l))),setTimeout((()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?a(l):ze("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new dv(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(At(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new dv(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WC(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let s=0;s<n;s++)t[s]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $0(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ep{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let s="";for(;s.length<20;){const a=WC(40);for(let l=0;l<a.length;++l)s.length<20&&a[l]<t&&(s+=e.charAt(a[l]%62))}return s}}function ft(n,e){return n<e?-1:n>e?1:0}function Lf(n,e){let t=0;for(;t<n.length&&t<e.length;){const s=n.codePointAt(t),a=e.codePointAt(t);if(s!==a){if(s<128&&a<128)return ft(s,a);{const l=$0(),d=GC(l.encode(hv(n,t)),l.encode(hv(e,t)));return d!==0?d:ft(s,a)}}t+=s>65535?2:1}return ft(n.length,e.length)}function hv(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function GC(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return ft(n[t],e[t]);return ft(n.length,e.length)}function Do(n,e,t){return n.length===e.length&&n.every(((s,a)=>t(s,e[a])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fv="__name__";class Os{constructor(e,t,s){t===void 0?t=0:t>e.length&&it(637,{offset:t,range:e.length}),s===void 0?s=e.length-t:s>e.length-t&&it(1746,{length:s,range:e.length-t}),this.segments=e,this.offset=t,this.len=s}get length(){return this.len}isEqual(e){return Os.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Os?e.forEach((s=>{t.push(s)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,s=this.limit();t<s;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const s=Math.min(e.length,t.length);for(let a=0;a<s;a++){const l=Os.compareSegments(e.get(a),t.get(a));if(l!==0)return l}return ft(e.length,t.length)}static compareSegments(e,t){const s=Os.isNumericId(e),a=Os.isNumericId(t);return s&&!a?-1:!s&&a?1:s&&a?Os.extractNumericId(e).compare(Os.extractNumericId(t)):Lf(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Yi.fromString(e.substring(4,e.length-2))}}class Mt extends Os{construct(e,t,s){return new Mt(e,t,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const s of e){if(s.indexOf("//")>=0)throw new Fe(fe.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);t.push(...s.split("/").filter((a=>a.length>0)))}return new Mt(t)}static emptyPath(){return new Mt([])}}const qC=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Kn extends Os{construct(e,t,s){return new Kn(e,t,s)}static isValidIdentifier(e){return qC.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Kn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===fv}static keyField(){return new Kn([fv])}static fromServerFormat(e){const t=[];let s="",a=0;const l=()=>{if(s.length===0)throw new Fe(fe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(s),s=""};let d=!1;for(;a<e.length;){const f=e[a];if(f==="\\"){if(a+1===e.length)throw new Fe(fe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const m=e[a+1];if(m!=="\\"&&m!=="."&&m!=="`")throw new Fe(fe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=m,a+=2}else f==="`"?(d=!d,a++):f!=="."||d?(s+=f,a++):(l(),a++)}if(l(),d)throw new Fe(fe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Kn(t)}static emptyPath(){return new Kn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xe{constructor(e){this.path=e}static fromPath(e){return new Xe(Mt.fromString(e))}static fromName(e){return new Xe(Mt.fromString(e).popFirst(5))}static empty(){return new Xe(Mt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Mt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Mt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Xe(new Mt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W0(n,e,t){if(!t)throw new Fe(fe.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function HC(n,e,t,s){if(e===!0&&s===!0)throw new Fe(fe.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function pv(n){if(!Xe.isDocumentKey(n))throw new Fe(fe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function mv(n){if(Xe.isDocumentKey(n))throw new Fe(fe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function G0(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function cd(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(s){return s.constructor?s.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":it(12329,{type:typeof n})}function Nr(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Fe(fe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=cd(n);throw new Fe(fe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _n(n,e){const t={typeString:n};return e&&(t.value=e),t}function oc(n,e){if(!G0(n))throw new Fe(fe.INVALID_ARGUMENT,"JSON must be an object");let t;for(const s in e)if(e[s]){const a=e[s].typeString,l="value"in e[s]?{value:e[s].value}:void 0;if(!(s in n)){t=`JSON missing required field: '${s}'`;break}const d=n[s];if(a&&typeof d!==a){t=`JSON field '${s}' must be a ${a}.`;break}if(l!==void 0&&d!==l.value){t=`Expected '${s}' field to equal '${l.value}'`;break}}if(t)throw new Fe(fe.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gv=-62135596800,yv=1e6;class Bt{static now(){return Bt.fromMillis(Date.now())}static fromDate(e){return Bt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),s=Math.floor((e-1e3*t)*yv);return new Bt(t,s)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Fe(fe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Fe(fe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<gv)throw new Fe(fe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Fe(fe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/yv}_compareTo(e){return this.seconds===e.seconds?ft(this.nanoseconds,e.nanoseconds):ft(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Bt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(oc(e,Bt._jsonSchema))return new Bt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-gv;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Bt._jsonSchemaVersion="firestore/timestamp/1.0",Bt._jsonSchema={type:_n("string",Bt._jsonSchemaVersion),seconds:_n("number"),nanoseconds:_n("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lt{static fromTimestamp(e){return new lt(e)}static min(){return new lt(new Bt(0,0))}static max(){return new lt(new Bt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hl=-1;function KC(n,e){const t=n.toTimestamp().seconds,s=n.toTimestamp().nanoseconds+1,a=lt.fromTimestamp(s===1e9?new Bt(t+1,0):new Bt(t,s));return new Zi(a,Xe.empty(),e)}function QC(n){return new Zi(n.readTime,n.key,Hl)}class Zi{constructor(e,t,s){this.readTime=e,this.documentKey=t,this.largestBatchId=s}static min(){return new Zi(lt.min(),Xe.empty(),Hl)}static max(){return new Zi(lt.max(),Xe.empty(),Hl)}}function YC(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Xe.comparator(n.documentKey,e.documentKey),t!==0?t:ft(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JC="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class XC{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ho(n){if(n.code!==fe.FAILED_PRECONDITION||n.message!==JC)throw n;ze("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ye{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&it(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ye(((s,a)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(s,a)},this.catchCallback=l=>{this.wrapFailure(t,l).next(s,a)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof ye?t:ye.resolve(t)}catch(t){return ye.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):ye.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):ye.reject(t)}static resolve(e){return new ye(((t,s)=>{t(e)}))}static reject(e){return new ye(((t,s)=>{s(e)}))}static waitFor(e){return new ye(((t,s)=>{let a=0,l=0,d=!1;e.forEach((f=>{++a,f.next((()=>{++l,d&&l===a&&t()}),(m=>s(m)))})),d=!0,l===a&&t()}))}static or(e){let t=ye.resolve(!1);for(const s of e)t=t.next((a=>a?ye.resolve(a):s()));return t}static forEach(e,t){const s=[];return e.forEach(((a,l)=>{s.push(t.call(this,a,l))})),this.waitFor(s)}static mapArray(e,t){return new ye(((s,a)=>{const l=e.length,d=new Array(l);let f=0;for(let m=0;m<l;m++){const v=m;t(e[v]).next((w=>{d[v]=w,++f,f===l&&s(d)}),(w=>a(w)))}}))}static doWhile(e,t){return new ye(((s,a)=>{const l=()=>{e()===!0?t().next((()=>{l()}),a):s()};l()}))}}function ZC(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Ko(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ud{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=s=>this._e(s),this.ae=s=>t.writeSequenceNumber(s))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}}ud.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tp=-1;function dd(n){return n==null}function Gu(n){return n===0&&1/n==-1/0}function eI(n){return typeof n=="number"&&Number.isInteger(n)&&!Gu(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q0="";function tI(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=vv(e)),e=nI(n.get(t),e);return vv(e)}function nI(n,e){let t=e;const s=n.length;for(let a=0;a<s;a++){const l=n.charAt(a);switch(l){case"\0":t+="";break;case q0:t+="";break;default:t+=l}}return t}function vv(n){return n+q0+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _v(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function ca(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function H0(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qt{constructor(e,t){this.comparator=e,this.root=t||Hn.EMPTY}insert(e,t){return new Qt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Hn.BLACK,null,null))}remove(e){return new Qt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Hn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const s=this.comparator(e,t.key);if(s===0)return t.value;s<0?t=t.left:s>0&&(t=t.right)}return null}indexOf(e){let t=0,s=this.root;for(;!s.isEmpty();){const a=this.comparator(e,s.key);if(a===0)return t+s.left.size;a<0?s=s.left:(t+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,s)=>(e(t,s),!1)))}toString(){const e=[];return this.inorderTraversal(((t,s)=>(e.push(`${t}:${s}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new vu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new vu(this.root,e,this.comparator,!1)}getReverseIterator(){return new vu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new vu(this.root,e,this.comparator,!0)}}class vu{constructor(e,t,s,a){this.isReverse=a,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=t?s(e.key,t):1,t&&a&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Hn{constructor(e,t,s,a,l){this.key=e,this.value=t,this.color=s??Hn.RED,this.left=a??Hn.EMPTY,this.right=l??Hn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,s,a,l){return new Hn(e??this.key,t??this.value,s??this.color,a??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,s){let a=this;const l=s(e,a.key);return a=l<0?a.copy(null,null,null,a.left.insert(e,t,s),null):l===0?a.copy(null,t,null,null,null):a.copy(null,null,null,null,a.right.insert(e,t,s)),a.fixUp()}removeMin(){if(this.left.isEmpty())return Hn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let s,a=this;if(t(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,t),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),t(e,a.key)===0){if(a.right.isEmpty())return Hn.EMPTY;s=a.right.min(),a=a.copy(s.key,s.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,t))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Hn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Hn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw it(43730,{key:this.key,value:this.value});if(this.right.isRed())throw it(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw it(27949);return e+(this.isRed()?0:1)}}Hn.EMPTY=null,Hn.RED=!0,Hn.BLACK=!1;Hn.EMPTY=new class{constructor(){this.size=0}get key(){throw it(57766)}get value(){throw it(16141)}get color(){throw it(16727)}get left(){throw it(29726)}get right(){throw it(36894)}copy(e,t,s,a,l){return this}insert(e,t,s){return new Hn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class In{constructor(e){this.comparator=e,this.data=new Qt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,s)=>(e(t),!1)))}forEachInRange(e,t){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const a=s.getNext();if(this.comparator(a.key,e[1])>=0)return;t(a.key)}}forEachWhile(e,t){let s;for(s=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new wv(this.data.getIterator())}getIteratorFrom(e){return new wv(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((s=>{t=t.add(s)})),t}isEqual(e){if(!(e instanceof In)||this.size!==e.size)return!1;const t=this.data.getIterator(),s=e.data.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=s.getNext().key;if(this.comparator(a,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new In(this.comparator);return t.data=e,t}}class wv{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Br{constructor(e){this.fields=e,e.sort(Kn.comparator)}static empty(){return new Br([])}unionWith(e){let t=new In(Kn.comparator);for(const s of this.fields)t=t.add(s);for(const s of e)t=t.add(s);return new Br(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Do(this.fields,e.fields,((t,s)=>t.isEqual(s)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K0 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(a){try{return atob(a)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new K0("Invalid base64 string: "+l):l}})(e);return new Qn(t)}static fromUint8Array(e){const t=(function(a){let l="";for(let d=0;d<a.length;++d)l+=String.fromCharCode(a[d]);return l})(e);return new Qn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const s=new Uint8Array(t.length);for(let a=0;a<t.length;a++)s[a]=t.charCodeAt(a);return s})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ft(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Qn.EMPTY_BYTE_STRING=new Qn("");const rI=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ea(n){if(At(!!n,39018),typeof n=="string"){let e=0;const t=rI.exec(n);if(At(!!t,46558,{timestamp:n}),t[1]){let a=t[1];a=(a+"000000000").substr(0,9),e=Number(a)}const s=new Date(n);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:cn(n.seconds),nanos:cn(n.nanos)}}function cn(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function ta(n){return typeof n=="string"?Qn.fromBase64String(n):Qn.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q0="server_timestamp",Y0="__type__",J0="__previous_value__",X0="__local_write_time__";function Sp(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[Y0])===null||t===void 0?void 0:t.stringValue)===Q0}function hd(n){const e=n.mapValue.fields[J0];return Sp(e)?hd(e):e}function Kl(n){const e=ea(n.mapValue.fields[X0].timestampValue);return new Bt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sI{constructor(e,t,s,a,l,d,f,m,v,w){this.databaseId=e,this.appId=t,this.persistenceKey=s,this.host=a,this.ssl=l,this.forceLongPolling=d,this.autoDetectLongPolling=f,this.longPollingOptions=m,this.useFetchStreams=v,this.isUsingEmulator=w}}const qu="(default)";class Ql{constructor(e,t){this.projectId=e,this.database=t||qu}static empty(){return new Ql("","")}get isDefaultDatabase(){return this.database===qu}isEqual(e){return e instanceof Ql&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z0="__type__",iI="__max__",_u={mapValue:{}},ew="__vector__",Hu="value";function na(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Sp(n)?4:oI(n)?9007199254740991:aI(n)?10:11:it(28295,{value:n})}function Ws(n,e){if(n===e)return!0;const t=na(n);if(t!==na(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Kl(n).isEqual(Kl(e));case 3:return(function(a,l){if(typeof a.timestampValue=="string"&&typeof l.timestampValue=="string"&&a.timestampValue.length===l.timestampValue.length)return a.timestampValue===l.timestampValue;const d=ea(a.timestampValue),f=ea(l.timestampValue);return d.seconds===f.seconds&&d.nanos===f.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(a,l){return ta(a.bytesValue).isEqual(ta(l.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(a,l){return cn(a.geoPointValue.latitude)===cn(l.geoPointValue.latitude)&&cn(a.geoPointValue.longitude)===cn(l.geoPointValue.longitude)})(n,e);case 2:return(function(a,l){if("integerValue"in a&&"integerValue"in l)return cn(a.integerValue)===cn(l.integerValue);if("doubleValue"in a&&"doubleValue"in l){const d=cn(a.doubleValue),f=cn(l.doubleValue);return d===f?Gu(d)===Gu(f):isNaN(d)&&isNaN(f)}return!1})(n,e);case 9:return Do(n.arrayValue.values||[],e.arrayValue.values||[],Ws);case 10:case 11:return(function(a,l){const d=a.mapValue.fields||{},f=l.mapValue.fields||{};if(_v(d)!==_v(f))return!1;for(const m in d)if(d.hasOwnProperty(m)&&(f[m]===void 0||!Ws(d[m],f[m])))return!1;return!0})(n,e);default:return it(52216,{left:n})}}function Yl(n,e){return(n.values||[]).find((t=>Ws(t,e)))!==void 0}function Lo(n,e){if(n===e)return 0;const t=na(n),s=na(e);if(t!==s)return ft(t,s);switch(t){case 0:case 9007199254740991:return 0;case 1:return ft(n.booleanValue,e.booleanValue);case 2:return(function(l,d){const f=cn(l.integerValue||l.doubleValue),m=cn(d.integerValue||d.doubleValue);return f<m?-1:f>m?1:f===m?0:isNaN(f)?isNaN(m)?0:-1:1})(n,e);case 3:return xv(n.timestampValue,e.timestampValue);case 4:return xv(Kl(n),Kl(e));case 5:return Lf(n.stringValue,e.stringValue);case 6:return(function(l,d){const f=ta(l),m=ta(d);return f.compareTo(m)})(n.bytesValue,e.bytesValue);case 7:return(function(l,d){const f=l.split("/"),m=d.split("/");for(let v=0;v<f.length&&v<m.length;v++){const w=ft(f[v],m[v]);if(w!==0)return w}return ft(f.length,m.length)})(n.referenceValue,e.referenceValue);case 8:return(function(l,d){const f=ft(cn(l.latitude),cn(d.latitude));return f!==0?f:ft(cn(l.longitude),cn(d.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Ev(n.arrayValue,e.arrayValue);case 10:return(function(l,d){var f,m,v,w;const T=l.fields||{},C=d.fields||{},U=(f=T[Hu])===null||f===void 0?void 0:f.arrayValue,X=(m=C[Hu])===null||m===void 0?void 0:m.arrayValue,q=ft(((v=U==null?void 0:U.values)===null||v===void 0?void 0:v.length)||0,((w=X==null?void 0:X.values)===null||w===void 0?void 0:w.length)||0);return q!==0?q:Ev(U,X)})(n.mapValue,e.mapValue);case 11:return(function(l,d){if(l===_u.mapValue&&d===_u.mapValue)return 0;if(l===_u.mapValue)return 1;if(d===_u.mapValue)return-1;const f=l.fields||{},m=Object.keys(f),v=d.fields||{},w=Object.keys(v);m.sort(),w.sort();for(let T=0;T<m.length&&T<w.length;++T){const C=Lf(m[T],w[T]);if(C!==0)return C;const U=Lo(f[m[T]],v[w[T]]);if(U!==0)return U}return ft(m.length,w.length)})(n.mapValue,e.mapValue);default:throw it(23264,{le:t})}}function xv(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ft(n,e);const t=ea(n),s=ea(e),a=ft(t.seconds,s.seconds);return a!==0?a:ft(t.nanos,s.nanos)}function Ev(n,e){const t=n.values||[],s=e.values||[];for(let a=0;a<t.length&&a<s.length;++a){const l=Lo(t[a],s[a]);if(l)return l}return ft(t.length,s.length)}function Vo(n){return Vf(n)}function Vf(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const s=ea(t);return`time(${s.seconds},${s.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return ta(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Xe.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let s="[",a=!0;for(const l of t.values||[])a?a=!1:s+=",",s+=Vf(l);return s+"]"})(n.arrayValue):"mapValue"in n?(function(t){const s=Object.keys(t.fields||{}).sort();let a="{",l=!0;for(const d of s)l?l=!1:a+=",",a+=`${d}:${Vf(t.fields[d])}`;return a+"}"})(n.mapValue):it(61005,{value:n})}function Nu(n){switch(na(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=hd(n);return e?16+Nu(e):16;case 5:return 2*n.stringValue.length;case 6:return ta(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(s){return(s.values||[]).reduce(((a,l)=>a+Nu(l)),0)})(n.arrayValue);case 10:case 11:return(function(s){let a=0;return ca(s.fields,((l,d)=>{a+=l.length+Nu(d)})),a})(n.mapValue);default:throw it(13486,{value:n})}}function Tv(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Mf(n){return!!n&&"integerValue"in n}function bp(n){return!!n&&"arrayValue"in n}function Sv(n){return!!n&&"nullValue"in n}function bv(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Ru(n){return!!n&&"mapValue"in n}function aI(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[Z0])===null||t===void 0?void 0:t.stringValue)===ew}function Ol(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return ca(n.mapValue.fields,((t,s)=>e.mapValue.fields[t]=Ol(s))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Ol(n.arrayValue.values[t]);return e}return Object.assign({},n)}function oI(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===iI}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pr{constructor(e){this.value=e}static empty(){return new Pr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let s=0;s<e.length-1;++s)if(t=(t.mapValue.fields||{})[e.get(s)],!Ru(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ol(t)}setAll(e){let t=Kn.emptyPath(),s={},a=[];e.forEach(((d,f)=>{if(!t.isImmediateParentOf(f)){const m=this.getFieldsMap(t);this.applyChanges(m,s,a),s={},a=[],t=f.popLast()}d?s[f.lastSegment()]=Ol(d):a.push(f.lastSegment())}));const l=this.getFieldsMap(t);this.applyChanges(l,s,a)}delete(e){const t=this.field(e.popLast());Ru(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ws(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let s=0;s<e.length;++s){let a=t.mapValue.fields[e.get(s)];Ru(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},t.mapValue.fields[e.get(s)]=a),t=a}return t.mapValue.fields}applyChanges(e,t,s){ca(t,((a,l)=>e[a]=l));for(const a of s)delete e[a]}clone(){return new Pr(Ol(this.value))}}function tw(n){const e=[];return ca(n.fields,((t,s)=>{const a=new Kn([t]);if(Ru(s)){const l=tw(s.mapValue).fields;if(l.length===0)e.push(a);else for(const d of l)e.push(a.child(d))}else e.push(a)})),new Br(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lr{constructor(e,t,s,a,l,d,f){this.key=e,this.documentType=t,this.version=s,this.readTime=a,this.createTime=l,this.data=d,this.documentState=f}static newInvalidDocument(e){return new lr(e,0,lt.min(),lt.min(),lt.min(),Pr.empty(),0)}static newFoundDocument(e,t,s,a){return new lr(e,1,t,lt.min(),s,a,0)}static newNoDocument(e,t){return new lr(e,2,t,lt.min(),lt.min(),Pr.empty(),0)}static newUnknownDocument(e,t){return new lr(e,3,t,lt.min(),lt.min(),Pr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(lt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Pr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Pr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=lt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof lr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new lr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ku{constructor(e,t){this.position=e,this.inclusive=t}}function Cv(n,e,t){let s=0;for(let a=0;a<n.position.length;a++){const l=e[a],d=n.position[a];if(l.field.isKeyField()?s=Xe.comparator(Xe.fromName(d.referenceValue),t.key):s=Lo(d,t.data.field(l.field)),l.dir==="desc"&&(s*=-1),s!==0)break}return s}function Iv(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Ws(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jl{constructor(e,t="asc"){this.field=e,this.dir=t}}function lI(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nw{}class vn extends nw{constructor(e,t,s){super(),this.field=e,this.op=t,this.value=s}static create(e,t,s){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,s):new uI(e,t,s):t==="array-contains"?new fI(e,s):t==="in"?new pI(e,s):t==="not-in"?new mI(e,s):t==="array-contains-any"?new gI(e,s):new vn(e,t,s)}static createKeyFieldInFilter(e,t,s){return t==="in"?new dI(e,s):new hI(e,s)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Lo(t,this.value)):t!==null&&na(this.value)===na(t)&&this.matchesComparison(Lo(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return it(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ts extends nw{constructor(e,t){super(),this.filters=e,this.op=t,this.he=null}static create(e,t){return new Ts(e,t)}matches(e){return rw(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function rw(n){return n.op==="and"}function sw(n){return cI(n)&&rw(n)}function cI(n){for(const e of n.filters)if(e instanceof Ts)return!1;return!0}function Of(n){if(n instanceof vn)return n.field.canonicalString()+n.op.toString()+Vo(n.value);if(sw(n))return n.filters.map((e=>Of(e))).join(",");{const e=n.filters.map((t=>Of(t))).join(",");return`${n.op}(${e})`}}function iw(n,e){return n instanceof vn?(function(s,a){return a instanceof vn&&s.op===a.op&&s.field.isEqual(a.field)&&Ws(s.value,a.value)})(n,e):n instanceof Ts?(function(s,a){return a instanceof Ts&&s.op===a.op&&s.filters.length===a.filters.length?s.filters.reduce(((l,d,f)=>l&&iw(d,a.filters[f])),!0):!1})(n,e):void it(19439)}function aw(n){return n instanceof vn?(function(t){return`${t.field.canonicalString()} ${t.op} ${Vo(t.value)}`})(n):n instanceof Ts?(function(t){return t.op.toString()+" {"+t.getFilters().map(aw).join(" ,")+"}"})(n):"Filter"}class uI extends vn{constructor(e,t,s){super(e,t,s),this.key=Xe.fromName(s.referenceValue)}matches(e){const t=Xe.comparator(e.key,this.key);return this.matchesComparison(t)}}class dI extends vn{constructor(e,t){super(e,"in",t),this.keys=ow("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class hI extends vn{constructor(e,t){super(e,"not-in",t),this.keys=ow("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function ow(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map((s=>Xe.fromName(s.referenceValue)))}class fI extends vn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return bp(t)&&Yl(t.arrayValue,this.value)}}class pI extends vn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Yl(this.value.arrayValue,t)}}class mI extends vn{constructor(e,t){super(e,"not-in",t)}matches(e){if(Yl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Yl(this.value.arrayValue,t)}}class gI extends vn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!bp(t)||!t.arrayValue.values)&&t.arrayValue.values.some((s=>Yl(this.value.arrayValue,s)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yI{constructor(e,t=null,s=[],a=[],l=null,d=null,f=null){this.path=e,this.collectionGroup=t,this.orderBy=s,this.filters=a,this.limit=l,this.startAt=d,this.endAt=f,this.Pe=null}}function Pv(n,e=null,t=[],s=[],a=null,l=null,d=null){return new yI(n,e,t,s,a,l,d)}function Cp(n){const e=ct(n);if(e.Pe===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((s=>Of(s))).join(","),t+="|ob:",t+=e.orderBy.map((s=>(function(l){return l.field.canonicalString()+l.dir})(s))).join(","),dd(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((s=>Vo(s))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((s=>Vo(s))).join(",")),e.Pe=t}return e.Pe}function Ip(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!lI(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!iw(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Iv(n.startAt,e.startAt)&&Iv(n.endAt,e.endAt)}function Ff(n){return Xe.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qo{constructor(e,t=null,s=[],a=[],l=null,d="F",f=null,m=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=s,this.filters=a,this.limit=l,this.limitType=d,this.startAt=f,this.endAt=m,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function vI(n,e,t,s,a,l,d,f){return new Qo(n,e,t,s,a,l,d,f)}function fd(n){return new Qo(n)}function Nv(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function lw(n){return n.collectionGroup!==null}function Fl(n){const e=ct(n);if(e.Te===null){e.Te=[];const t=new Set;for(const l of e.explicitOrderBy)e.Te.push(l),t.add(l.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let f=new In(Kn.comparator);return d.filters.forEach((m=>{m.getFlattenedFilters().forEach((v=>{v.isInequality()&&(f=f.add(v.field))}))})),f})(e).forEach((l=>{t.has(l.canonicalString())||l.isKeyField()||e.Te.push(new Jl(l,s))})),t.has(Kn.keyField().canonicalString())||e.Te.push(new Jl(Kn.keyField(),s))}return e.Te}function Us(n){const e=ct(n);return e.Ie||(e.Ie=_I(e,Fl(n))),e.Ie}function _I(n,e){if(n.limitType==="F")return Pv(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((a=>{const l=a.dir==="desc"?"asc":"desc";return new Jl(a.field,l)}));const t=n.endAt?new Ku(n.endAt.position,n.endAt.inclusive):null,s=n.startAt?new Ku(n.startAt.position,n.startAt.inclusive):null;return Pv(n.path,n.collectionGroup,e,n.filters,n.limit,t,s)}}function Uf(n,e){const t=n.filters.concat([e]);return new Qo(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Qu(n,e,t){return new Qo(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function pd(n,e){return Ip(Us(n),Us(e))&&n.limitType===e.limitType}function cw(n){return`${Cp(Us(n))}|lt:${n.limitType}`}function bo(n){return`Query(target=${(function(t){let s=t.path.canonicalString();return t.collectionGroup!==null&&(s+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(s+=`, filters: [${t.filters.map((a=>aw(a))).join(", ")}]`),dd(t.limit)||(s+=", limit: "+t.limit),t.orderBy.length>0&&(s+=`, orderBy: [${t.orderBy.map((a=>(function(d){return`${d.field.canonicalString()} (${d.dir})`})(a))).join(", ")}]`),t.startAt&&(s+=", startAt: ",s+=t.startAt.inclusive?"b:":"a:",s+=t.startAt.position.map((a=>Vo(a))).join(",")),t.endAt&&(s+=", endAt: ",s+=t.endAt.inclusive?"a:":"b:",s+=t.endAt.position.map((a=>Vo(a))).join(",")),`Target(${s})`})(Us(n))}; limitType=${n.limitType})`}function md(n,e){return e.isFoundDocument()&&(function(s,a){const l=a.key.path;return s.collectionGroup!==null?a.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(l):Xe.isDocumentKey(s.path)?s.path.isEqual(l):s.path.isImmediateParentOf(l)})(n,e)&&(function(s,a){for(const l of Fl(s))if(!l.field.isKeyField()&&a.data.field(l.field)===null)return!1;return!0})(n,e)&&(function(s,a){for(const l of s.filters)if(!l.matches(a))return!1;return!0})(n,e)&&(function(s,a){return!(s.startAt&&!(function(d,f,m){const v=Cv(d,f,m);return d.inclusive?v<=0:v<0})(s.startAt,Fl(s),a)||s.endAt&&!(function(d,f,m){const v=Cv(d,f,m);return d.inclusive?v>=0:v>0})(s.endAt,Fl(s),a))})(n,e)}function wI(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function uw(n){return(e,t)=>{let s=!1;for(const a of Fl(n)){const l=xI(a,e,t);if(l!==0)return l;s=s||a.field.isKeyField()}return 0}}function xI(n,e,t){const s=n.field.isKeyField()?Xe.comparator(e.key,t.key):(function(l,d,f){const m=d.data.field(l),v=f.data.field(l);return m!==null&&v!==null?Lo(m,v):it(42886)})(n.field,e,t);switch(n.dir){case"asc":return s;case"desc":return-1*s;default:return it(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ua{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s!==void 0){for(const[a,l]of s)if(this.equalsFn(a,e))return l}}has(e){return this.get(e)!==void 0}set(e,t){const s=this.mapKeyFn(e),a=this.inner[s];if(a===void 0)return this.inner[s]=[[e,t]],void this.innerSize++;for(let l=0;l<a.length;l++)if(this.equalsFn(a[l][0],e))return void(a[l]=[e,t]);a.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),s=this.inner[t];if(s===void 0)return!1;for(let a=0;a<s.length;a++)if(this.equalsFn(s[a][0],e))return s.length===1?delete this.inner[t]:s.splice(a,1),this.innerSize--,!0;return!1}forEach(e){ca(this.inner,((t,s)=>{for(const[a,l]of s)e(a,l)}))}isEmpty(){return H0(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EI=new Qt(Xe.comparator);function yi(){return EI}const dw=new Qt(Xe.comparator);function jl(...n){let e=dw;for(const t of n)e=e.insert(t.key,t);return e}function hw(n){let e=dw;return n.forEach(((t,s)=>e=e.insert(t,s.overlayedDocument))),e}function Na(){return Ul()}function fw(){return Ul()}function Ul(){return new Ua((n=>n.toString()),((n,e)=>n.isEqual(e)))}const TI=new Qt(Xe.comparator),SI=new In(Xe.comparator);function _t(...n){let e=SI;for(const t of n)e=e.add(t);return e}const bI=new In(ft);function CI(){return bI}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pp(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Gu(e)?"-0":e}}function pw(n){return{integerValue:""+n}}function II(n,e){return eI(e)?pw(e):Pp(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gd{constructor(){this._=void 0}}function PI(n,e,t){return n instanceof Xl?(function(a,l){const d={fields:{[Y0]:{stringValue:Q0},[X0]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return l&&Sp(l)&&(l=hd(l)),l&&(d.fields[J0]=l),{mapValue:d}})(t,e):n instanceof Zl?gw(n,e):n instanceof ec?yw(n,e):(function(a,l){const d=mw(a,l),f=Rv(d)+Rv(a.Ee);return Mf(d)&&Mf(a.Ee)?pw(f):Pp(a.serializer,f)})(n,e)}function NI(n,e,t){return n instanceof Zl?gw(n,e):n instanceof ec?yw(n,e):t}function mw(n,e){return n instanceof Yu?(function(s){return Mf(s)||(function(l){return!!l&&"doubleValue"in l})(s)})(e)?e:{integerValue:0}:null}class Xl extends gd{}class Zl extends gd{constructor(e){super(),this.elements=e}}function gw(n,e){const t=vw(e);for(const s of n.elements)t.some((a=>Ws(a,s)))||t.push(s);return{arrayValue:{values:t}}}class ec extends gd{constructor(e){super(),this.elements=e}}function yw(n,e){let t=vw(e);for(const s of n.elements)t=t.filter((a=>!Ws(a,s)));return{arrayValue:{values:t}}}class Yu extends gd{constructor(e,t){super(),this.serializer=e,this.Ee=t}}function Rv(n){return cn(n.integerValue||n.doubleValue)}function vw(n){return bp(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RI{constructor(e,t){this.field=e,this.transform=t}}function AI(n,e){return n.field.isEqual(e.field)&&(function(s,a){return s instanceof Zl&&a instanceof Zl||s instanceof ec&&a instanceof ec?Do(s.elements,a.elements,Ws):s instanceof Yu&&a instanceof Yu?Ws(s.Ee,a.Ee):s instanceof Xl&&a instanceof Xl})(n.transform,e.transform)}class jI{constructor(e,t){this.version=e,this.transformResults=t}}class ns{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new ns}static exists(e){return new ns(void 0,e)}static updateTime(e){return new ns(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Au(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class yd{}function _w(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Np(n.key,ns.none()):new lc(n.key,n.data,ns.none());{const t=n.data,s=Pr.empty();let a=new In(Kn.comparator);for(let l of e.fields)if(!a.has(l)){let d=t.field(l);d===null&&l.length>1&&(l=l.popLast(),d=t.field(l)),d===null?s.delete(l):s.set(l,d),a=a.add(l)}return new ua(n.key,s,new Br(a.toArray()),ns.none())}}function kI(n,e,t){n instanceof lc?(function(a,l,d){const f=a.value.clone(),m=jv(a.fieldTransforms,l,d.transformResults);f.setAll(m),l.convertToFoundDocument(d.version,f).setHasCommittedMutations()})(n,e,t):n instanceof ua?(function(a,l,d){if(!Au(a.precondition,l))return void l.convertToUnknownDocument(d.version);const f=jv(a.fieldTransforms,l,d.transformResults),m=l.data;m.setAll(ww(a)),m.setAll(f),l.convertToFoundDocument(d.version,m).setHasCommittedMutations()})(n,e,t):(function(a,l,d){l.convertToNoDocument(d.version).setHasCommittedMutations()})(0,e,t)}function zl(n,e,t,s){return n instanceof lc?(function(l,d,f,m){if(!Au(l.precondition,d))return f;const v=l.value.clone(),w=kv(l.fieldTransforms,m,d);return v.setAll(w),d.convertToFoundDocument(d.version,v).setHasLocalMutations(),null})(n,e,t,s):n instanceof ua?(function(l,d,f,m){if(!Au(l.precondition,d))return f;const v=kv(l.fieldTransforms,m,d),w=d.data;return w.setAll(ww(l)),w.setAll(v),d.convertToFoundDocument(d.version,w).setHasLocalMutations(),f===null?null:f.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((T=>T.field)))})(n,e,t,s):(function(l,d,f){return Au(l.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):f})(n,e,t)}function DI(n,e){let t=null;for(const s of n.fieldTransforms){const a=e.data.field(s.field),l=mw(s.transform,a||null);l!=null&&(t===null&&(t=Pr.empty()),t.set(s.field,l))}return t||null}function Av(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(s,a){return s===void 0&&a===void 0||!(!s||!a)&&Do(s,a,((l,d)=>AI(l,d)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class lc extends yd{constructor(e,t,s,a=[]){super(),this.key=e,this.value=t,this.precondition=s,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class ua extends yd{constructor(e,t,s,a,l=[]){super(),this.key=e,this.data=t,this.fieldMask=s,this.precondition=a,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function ww(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const s=n.data.field(t);e.set(t,s)}})),e}function jv(n,e,t){const s=new Map;At(n.length===t.length,32656,{Ae:t.length,Re:n.length});for(let a=0;a<t.length;a++){const l=n[a],d=l.transform,f=e.data.field(l.field);s.set(l.field,NI(d,f,t[a]))}return s}function kv(n,e,t){const s=new Map;for(const a of n){const l=a.transform,d=t.data.field(a.field);s.set(a.field,PI(l,d,e))}return s}class Np extends yd{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class LI extends yd{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VI{constructor(e,t,s,a){this.batchId=e,this.localWriteTime=t,this.baseMutations=s,this.mutations=a}applyToRemoteDocument(e,t){const s=t.mutationResults;for(let a=0;a<this.mutations.length;a++){const l=this.mutations[a];l.key.isEqual(e.key)&&kI(l,e,s[a])}}applyToLocalView(e,t){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(t=zl(s,e,t,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(t=zl(s,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const s=fw();return this.mutations.forEach((a=>{const l=e.get(a.key),d=l.overlayedDocument;let f=this.applyToLocalView(d,l.mutatedFields);f=t.has(a.key)?null:f;const m=_w(d,f);m!==null&&s.set(a.key,m),d.isValidDocument()||d.convertToNoDocument(lt.min())})),s}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),_t())}isEqual(e){return this.batchId===e.batchId&&Do(this.mutations,e.mutations,((t,s)=>Av(t,s)))&&Do(this.baseMutations,e.baseMutations,((t,s)=>Av(t,s)))}}class Rp{constructor(e,t,s,a){this.batch=e,this.commitVersion=t,this.mutationResults=s,this.docVersions=a}static from(e,t,s){At(e.mutations.length===s.length,58842,{Ve:e.mutations.length,me:s.length});let a=(function(){return TI})();const l=e.mutations;for(let d=0;d<l.length;d++)a=a.insert(l[d].key,s[d].version);return new Rp(e,t,s,a)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MI{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OI{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var yn,Et;function FI(n){switch(n){case fe.OK:return it(64938);case fe.CANCELLED:case fe.UNKNOWN:case fe.DEADLINE_EXCEEDED:case fe.RESOURCE_EXHAUSTED:case fe.INTERNAL:case fe.UNAVAILABLE:case fe.UNAUTHENTICATED:return!1;case fe.INVALID_ARGUMENT:case fe.NOT_FOUND:case fe.ALREADY_EXISTS:case fe.PERMISSION_DENIED:case fe.FAILED_PRECONDITION:case fe.ABORTED:case fe.OUT_OF_RANGE:case fe.UNIMPLEMENTED:case fe.DATA_LOSS:return!0;default:return it(15467,{code:n})}}function xw(n){if(n===void 0)return gi("GRPC error has no .code"),fe.UNKNOWN;switch(n){case yn.OK:return fe.OK;case yn.CANCELLED:return fe.CANCELLED;case yn.UNKNOWN:return fe.UNKNOWN;case yn.DEADLINE_EXCEEDED:return fe.DEADLINE_EXCEEDED;case yn.RESOURCE_EXHAUSTED:return fe.RESOURCE_EXHAUSTED;case yn.INTERNAL:return fe.INTERNAL;case yn.UNAVAILABLE:return fe.UNAVAILABLE;case yn.UNAUTHENTICATED:return fe.UNAUTHENTICATED;case yn.INVALID_ARGUMENT:return fe.INVALID_ARGUMENT;case yn.NOT_FOUND:return fe.NOT_FOUND;case yn.ALREADY_EXISTS:return fe.ALREADY_EXISTS;case yn.PERMISSION_DENIED:return fe.PERMISSION_DENIED;case yn.FAILED_PRECONDITION:return fe.FAILED_PRECONDITION;case yn.ABORTED:return fe.ABORTED;case yn.OUT_OF_RANGE:return fe.OUT_OF_RANGE;case yn.UNIMPLEMENTED:return fe.UNIMPLEMENTED;case yn.DATA_LOSS:return fe.DATA_LOSS;default:return it(39323,{code:n})}}(Et=yn||(yn={}))[Et.OK=0]="OK",Et[Et.CANCELLED=1]="CANCELLED",Et[Et.UNKNOWN=2]="UNKNOWN",Et[Et.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Et[Et.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Et[Et.NOT_FOUND=5]="NOT_FOUND",Et[Et.ALREADY_EXISTS=6]="ALREADY_EXISTS",Et[Et.PERMISSION_DENIED=7]="PERMISSION_DENIED",Et[Et.UNAUTHENTICATED=16]="UNAUTHENTICATED",Et[Et.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Et[Et.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Et[Et.ABORTED=10]="ABORTED",Et[Et.OUT_OF_RANGE=11]="OUT_OF_RANGE",Et[Et.UNIMPLEMENTED=12]="UNIMPLEMENTED",Et[Et.INTERNAL=13]="INTERNAL",Et[Et.UNAVAILABLE=14]="UNAVAILABLE",Et[Et.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UI=new Yi([4294967295,4294967295],0);function Dv(n){const e=$0().encode(n),t=new L0;return t.update(e),new Uint8Array(t.digest())}function Lv(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),s=e.getUint32(4,!0),a=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new Yi([t,s],0),new Yi([a,l],0)]}class Ap{constructor(e,t,s){if(this.bitmap=e,this.padding=t,this.hashCount=s,t<0||t>=8)throw new kl(`Invalid padding: ${t}`);if(s<0)throw new kl(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new kl(`Invalid hash count: ${s}`);if(e.length===0&&t!==0)throw new kl(`Invalid padding when bitmap length is 0: ${t}`);this.fe=8*e.length-t,this.ge=Yi.fromNumber(this.fe)}pe(e,t,s){let a=e.add(t.multiply(Yi.fromNumber(s)));return a.compare(UI)===1&&(a=new Yi([a.getBits(0),a.getBits(1)],0)),a.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;const t=Dv(e),[s,a]=Lv(t);for(let l=0;l<this.hashCount;l++){const d=this.pe(s,a,l);if(!this.ye(d))return!1}return!0}static create(e,t,s){const a=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),d=new Ap(l,a,t);return s.forEach((f=>d.insert(f))),d}insert(e){if(this.fe===0)return;const t=Dv(e),[s,a]=Lv(t);for(let l=0;l<this.hashCount;l++){const d=this.pe(s,a,l);this.we(d)}}we(e){const t=Math.floor(e/8),s=e%8;this.bitmap[t]|=1<<s}}class kl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vd{constructor(e,t,s,a,l){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=s,this.documentUpdates=a,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,t,s){const a=new Map;return a.set(e,cc.createSynthesizedTargetChangeForCurrentChange(e,t,s)),new vd(lt.min(),a,new Qt(ft),yi(),_t())}}class cc{constructor(e,t,s,a,l){this.resumeToken=e,this.current=t,this.addedDocuments=s,this.modifiedDocuments=a,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,t,s){return new cc(s,t,_t(),_t(),_t())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ju{constructor(e,t,s,a){this.Se=e,this.removedTargetIds=t,this.key=s,this.be=a}}class Ew{constructor(e,t){this.targetId=e,this.De=t}}class Tw{constructor(e,t,s=Qn.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=t,this.resumeToken=s,this.cause=a}}class Vv{constructor(){this.ve=0,this.Ce=Mv(),this.Fe=Qn.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=_t(),t=_t(),s=_t();return this.Ce.forEach(((a,l)=>{switch(l){case 0:e=e.add(a);break;case 2:t=t.add(a);break;case 1:s=s.add(a);break;default:it(38017,{changeType:l})}})),new cc(this.Fe,this.Me,e,t,s)}ke(){this.xe=!1,this.Ce=Mv()}qe(e,t){this.xe=!0,this.Ce=this.Ce.insert(e,t)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,At(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class zI{constructor(e){this.We=e,this.Ge=new Map,this.ze=yi(),this.je=wu(),this.Je=wu(),this.He=new Qt(ft)}Ye(e){for(const t of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(t,e.be):this.Xe(t,e.key,e.be);for(const t of e.removedTargetIds)this.Xe(t,e.key,e.be)}et(e){this.forEachTarget(e,(t=>{const s=this.tt(t);switch(e.state){case 0:this.nt(t)&&s.Be(e.resumeToken);break;case 1:s.Ue(),s.Oe||s.ke(),s.Be(e.resumeToken);break;case 2:s.Ue(),s.Oe||this.removeTarget(t);break;case 3:this.nt(t)&&(s.Ke(),s.Be(e.resumeToken));break;case 4:this.nt(t)&&(this.rt(t),s.Be(e.resumeToken));break;default:it(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ge.forEach(((s,a)=>{this.nt(a)&&t(a)}))}it(e){const t=e.targetId,s=e.De.count,a=this.st(t);if(a){const l=a.target;if(Ff(l))if(s===0){const d=new Xe(l.path);this.Xe(t,d,lr.newNoDocument(d,lt.min()))}else At(s===1,20013,{expectedCount:s});else{const d=this.ot(t);if(d!==s){const f=this._t(e),m=f?this.ut(f,e,d):1;if(m!==0){this.rt(t);const v=m===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(t,v)}}}}}_t(e){const t=e.De.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:s="",padding:a=0},hashCount:l=0}=t;let d,f;try{d=ta(s).toUint8Array()}catch(m){if(m instanceof K0)return Xi("Decoding the base64 bloom filter in existence filter failed ("+m.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw m}try{f=new Ap(d,a,l)}catch(m){return Xi(m instanceof kl?"BloomFilter error: ":"Applying bloom filter failed: ",m),null}return f.fe===0?null:f}ut(e,t,s){return t.De.count===s-this.ht(e,t.targetId)?0:2}ht(e,t){const s=this.We.getRemoteKeysForTarget(t);let a=0;return s.forEach((l=>{const d=this.We.lt(),f=`projects/${d.projectId}/databases/${d.database}/documents/${l.path.canonicalString()}`;e.mightContain(f)||(this.Xe(t,l,null),a++)})),a}Pt(e){const t=new Map;this.Ge.forEach(((l,d)=>{const f=this.st(d);if(f){if(l.current&&Ff(f.target)){const m=new Xe(f.target.path);this.Tt(m).has(d)||this.It(d,m)||this.Xe(d,m,lr.newNoDocument(m,e))}l.Ne&&(t.set(d,l.Le()),l.ke())}}));let s=_t();this.Je.forEach(((l,d)=>{let f=!0;d.forEachWhile((m=>{const v=this.st(m);return!v||v.purpose==="TargetPurposeLimboResolution"||(f=!1,!1)})),f&&(s=s.add(l))})),this.ze.forEach(((l,d)=>d.setReadTime(e)));const a=new vd(e,t,this.He,this.ze,s);return this.ze=yi(),this.je=wu(),this.Je=wu(),this.He=new Qt(ft),a}Ze(e,t){if(!this.nt(e))return;const s=this.It(e,t.key)?2:0;this.tt(e).qe(t.key,s),this.ze=this.ze.insert(t.key,t),this.je=this.je.insert(t.key,this.Tt(t.key).add(e)),this.Je=this.Je.insert(t.key,this.dt(t.key).add(e))}Xe(e,t,s){if(!this.nt(e))return;const a=this.tt(e);this.It(e,t)?a.qe(t,1):a.Qe(t),this.Je=this.Je.insert(t,this.dt(t).delete(e)),this.Je=this.Je.insert(t,this.dt(t).add(e)),s&&(this.ze=this.ze.insert(t,s))}removeTarget(e){this.Ge.delete(e)}ot(e){const t=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let t=this.Ge.get(e);return t||(t=new Vv,this.Ge.set(e,t)),t}dt(e){let t=this.Je.get(e);return t||(t=new In(ft),this.Je=this.Je.insert(e,t)),t}Tt(e){let t=this.je.get(e);return t||(t=new In(ft),this.je=this.je.insert(e,t)),t}nt(e){const t=this.st(e)!==null;return t||ze("WatchChangeAggregator","Detected inactive target",e),t}st(e){const t=this.Ge.get(e);return t&&t.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new Vv),this.We.getRemoteKeysForTarget(e).forEach((t=>{this.Xe(e,t,null)}))}It(e,t){return this.We.getRemoteKeysForTarget(e).has(t)}}function wu(){return new Qt(Xe.comparator)}function Mv(){return new Qt(Xe.comparator)}const BI={asc:"ASCENDING",desc:"DESCENDING"},$I={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},WI={and:"AND",or:"OR"};class GI{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function zf(n,e){return n.useProto3Json||dd(e)?e:{value:e}}function Ju(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Sw(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function qI(n,e){return Ju(n,e.toTimestamp())}function zs(n){return At(!!n,49232),lt.fromTimestamp((function(t){const s=ea(t);return new Bt(s.seconds,s.nanos)})(n))}function jp(n,e){return Bf(n,e).canonicalString()}function Bf(n,e){const t=(function(a){return new Mt(["projects",a.projectId,"databases",a.database])})(n).child("documents");return e===void 0?t:t.child(e)}function bw(n){const e=Mt.fromString(n);return At(Rw(e),10190,{key:e.toString()}),e}function $f(n,e){return jp(n.databaseId,e.path)}function ff(n,e){const t=bw(e);if(t.get(1)!==n.databaseId.projectId)throw new Fe(fe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Fe(fe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Xe(Iw(t))}function Cw(n,e){return jp(n.databaseId,e)}function HI(n){const e=bw(n);return e.length===4?Mt.emptyPath():Iw(e)}function Wf(n){return new Mt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Iw(n){return At(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function Ov(n,e,t){return{name:$f(n,e),fields:t.value.mapValue.fields}}function KI(n,e){let t;if("targetChange"in e){e.targetChange;const s=(function(v){return v==="NO_CHANGE"?0:v==="ADD"?1:v==="REMOVE"?2:v==="CURRENT"?3:v==="RESET"?4:it(39313,{state:v})})(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],l=(function(v,w){return v.useProto3Json?(At(w===void 0||typeof w=="string",58123),Qn.fromBase64String(w||"")):(At(w===void 0||w instanceof Buffer||w instanceof Uint8Array,16193),Qn.fromUint8Array(w||new Uint8Array))})(n,e.targetChange.resumeToken),d=e.targetChange.cause,f=d&&(function(v){const w=v.code===void 0?fe.UNKNOWN:xw(v.code);return new Fe(w,v.message||"")})(d);t=new Tw(s,a,l,f||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const a=ff(n,s.document.name),l=zs(s.document.updateTime),d=s.document.createTime?zs(s.document.createTime):lt.min(),f=new Pr({mapValue:{fields:s.document.fields}}),m=lr.newFoundDocument(a,l,d,f),v=s.targetIds||[],w=s.removedTargetIds||[];t=new ju(v,w,m.key,m)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const a=ff(n,s.document),l=s.readTime?zs(s.readTime):lt.min(),d=lr.newNoDocument(a,l),f=s.removedTargetIds||[];t=new ju([],f,d.key,d)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const a=ff(n,s.document),l=s.removedTargetIds||[];t=new ju([],l,a,null)}else{if(!("filter"in e))return it(11601,{At:e});{e.filter;const s=e.filter;s.targetId;const{count:a=0,unchangedNames:l}=s,d=new OI(a,l),f=s.targetId;t=new Ew(f,d)}}return t}function QI(n,e){let t;if(e instanceof lc)t={update:Ov(n,e.key,e.value)};else if(e instanceof Np)t={delete:$f(n,e.key)};else if(e instanceof ua)t={update:Ov(n,e.key,e.data),updateMask:sP(e.fieldMask)};else{if(!(e instanceof LI))return it(16599,{Rt:e.type});t={verify:$f(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((s=>(function(l,d){const f=d.transform;if(f instanceof Xl)return{fieldPath:d.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(f instanceof Zl)return{fieldPath:d.field.canonicalString(),appendMissingElements:{values:f.elements}};if(f instanceof ec)return{fieldPath:d.field.canonicalString(),removeAllFromArray:{values:f.elements}};if(f instanceof Yu)return{fieldPath:d.field.canonicalString(),increment:f.Ee};throw it(20930,{transform:d.transform})})(0,s)))),e.precondition.isNone||(t.currentDocument=(function(a,l){return l.updateTime!==void 0?{updateTime:qI(a,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:it(27497)})(n,e.precondition)),t}function YI(n,e){return n&&n.length>0?(At(e!==void 0,14353),n.map((t=>(function(a,l){let d=a.updateTime?zs(a.updateTime):zs(l);return d.isEqual(lt.min())&&(d=zs(l)),new jI(d,a.transformResults||[])})(t,e)))):[]}function JI(n,e){return{documents:[Cw(n,e.path)]}}function XI(n,e){const t={structuredQuery:{}},s=e.path;let a;e.collectionGroup!==null?(a=s,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=s.popLast(),t.structuredQuery.from=[{collectionId:s.lastSegment()}]),t.parent=Cw(n,a);const l=(function(v){if(v.length!==0)return Nw(Ts.create(v,"and"))})(e.filters);l&&(t.structuredQuery.where=l);const d=(function(v){if(v.length!==0)return v.map((w=>(function(C){return{field:Co(C.field),direction:tP(C.dir)}})(w)))})(e.orderBy);d&&(t.structuredQuery.orderBy=d);const f=zf(n,e.limit);return f!==null&&(t.structuredQuery.limit=f),e.startAt&&(t.structuredQuery.startAt=(function(v){return{before:v.inclusive,values:v.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(v){return{before:!v.inclusive,values:v.position}})(e.endAt)),{Vt:t,parent:a}}function ZI(n){let e=HI(n.parent);const t=n.structuredQuery,s=t.from?t.from.length:0;let a=null;if(s>0){At(s===1,65062);const w=t.from[0];w.allDescendants?a=w.collectionId:e=e.child(w.collectionId)}let l=[];t.where&&(l=(function(T){const C=Pw(T);return C instanceof Ts&&sw(C)?C.getFilters():[C]})(t.where));let d=[];t.orderBy&&(d=(function(T){return T.map((C=>(function(X){return new Jl(Io(X.field),(function(F){switch(F){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(X.direction))})(C)))})(t.orderBy));let f=null;t.limit&&(f=(function(T){let C;return C=typeof T=="object"?T.value:T,dd(C)?null:C})(t.limit));let m=null;t.startAt&&(m=(function(T){const C=!!T.before,U=T.values||[];return new Ku(U,C)})(t.startAt));let v=null;return t.endAt&&(v=(function(T){const C=!T.before,U=T.values||[];return new Ku(U,C)})(t.endAt)),vI(e,a,d,l,f,"F",m,v)}function eP(n,e){const t=(function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return it(28987,{purpose:a})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Pw(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const s=Io(t.unaryFilter.field);return vn.create(s,"==",{doubleValue:NaN});case"IS_NULL":const a=Io(t.unaryFilter.field);return vn.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=Io(t.unaryFilter.field);return vn.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=Io(t.unaryFilter.field);return vn.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return it(61313);default:return it(60726)}})(n):n.fieldFilter!==void 0?(function(t){return vn.create(Io(t.fieldFilter.field),(function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return it(58110);default:return it(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Ts.create(t.compositeFilter.filters.map((s=>Pw(s))),(function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return it(1026)}})(t.compositeFilter.op))})(n):it(30097,{filter:n})}function tP(n){return BI[n]}function nP(n){return $I[n]}function rP(n){return WI[n]}function Co(n){return{fieldPath:n.canonicalString()}}function Io(n){return Kn.fromServerFormat(n.fieldPath)}function Nw(n){return n instanceof vn?(function(t){if(t.op==="=="){if(bv(t.value))return{unaryFilter:{field:Co(t.field),op:"IS_NAN"}};if(Sv(t.value))return{unaryFilter:{field:Co(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(bv(t.value))return{unaryFilter:{field:Co(t.field),op:"IS_NOT_NAN"}};if(Sv(t.value))return{unaryFilter:{field:Co(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Co(t.field),op:nP(t.op),value:t.value}}})(n):n instanceof Ts?(function(t){const s=t.getFilters().map((a=>Nw(a)));return s.length===1?s[0]:{compositeFilter:{op:rP(t.op),filters:s}}})(n):it(54877,{filter:n})}function sP(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function Rw(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gi{constructor(e,t,s,a,l=lt.min(),d=lt.min(),f=Qn.EMPTY_BYTE_STRING,m=null){this.target=e,this.targetId=t,this.purpose=s,this.sequenceNumber=a,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=f,this.expectedCount=m}withSequenceNumber(e){return new Gi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Gi(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Gi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Gi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iP{constructor(e){this.gt=e}}function aP(n){const e=ZI({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Qu(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oP{constructor(){this.Dn=new lP}addToCollectionParentIndex(e,t){return this.Dn.add(t),ye.resolve()}getCollectionParents(e,t){return ye.resolve(this.Dn.getEntries(t))}addFieldIndex(e,t){return ye.resolve()}deleteFieldIndex(e,t){return ye.resolve()}deleteAllFieldIndexes(e){return ye.resolve()}createTargetIndexes(e,t){return ye.resolve()}getDocumentsMatchingTarget(e,t){return ye.resolve(null)}getIndexType(e,t){return ye.resolve(0)}getFieldIndexes(e,t){return ye.resolve([])}getNextCollectionGroupToUpdate(e){return ye.resolve(null)}getMinOffset(e,t){return ye.resolve(Zi.min())}getMinOffsetFromCollectionGroup(e,t){return ye.resolve(Zi.min())}updateCollectionGroup(e,t,s){return ye.resolve()}updateIndexEntries(e,t){return ye.resolve()}}class lP{constructor(){this.index={}}add(e){const t=e.lastSegment(),s=e.popLast(),a=this.index[t]||new In(Mt.comparator),l=!a.has(s);return this.index[t]=a.add(s),l}has(e){const t=e.lastSegment(),s=e.popLast(),a=this.index[t];return a&&a.has(s)}getEntries(e){return(this.index[e]||new In(Mt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fv={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Aw=41943040;class Ir{static withCacheSize(e){return new Ir(e,Ir.DEFAULT_COLLECTION_PERCENTILE,Ir.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ir.DEFAULT_COLLECTION_PERCENTILE=10,Ir.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ir.DEFAULT=new Ir(Aw,Ir.DEFAULT_COLLECTION_PERCENTILE,Ir.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ir.DISABLED=new Ir(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mo{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new Mo(0)}static ur(){return new Mo(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uv="LruGarbageCollector",cP=1048576;function zv([n,e],[t,s]){const a=ft(n,t);return a===0?ft(e,s):a}class uP{constructor(e){this.Tr=e,this.buffer=new In(zv),this.Ir=0}dr(){return++this.Ir}Er(e){const t=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(t);else{const s=this.buffer.last();zv(t,s)<0&&(this.buffer=this.buffer.delete(s).add(t))}}get maxValue(){return this.buffer.last()[0]}}class dP{constructor(e,t,s){this.garbageCollector=e,this.asyncQueue=t,this.localStore=s,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){ze(Uv,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Ko(t)?ze(Uv,"Ignoring IndexedDB error during garbage collection: ",t):await Ho(t)}await this.Rr(3e5)}))}}class hP{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.mr(e).next((s=>Math.floor(t/100*s)))}nthSequenceNumber(e,t){if(t===0)return ye.resolve(ud.ue);const s=new uP(t);return this.Vr.forEachTarget(e,(a=>s.Er(a.sequenceNumber))).next((()=>this.Vr.gr(e,(a=>s.Er(a))))).next((()=>s.maxValue))}removeTargets(e,t,s){return this.Vr.removeTargets(e,t,s)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ze("LruGarbageCollector","Garbage collection skipped; disabled"),ye.resolve(Fv)):this.getCacheSize(e).next((s=>s<this.params.cacheSizeCollectionThreshold?(ze("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Fv):this.pr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,t){let s,a,l,d,f,m,v;const w=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((T=>(T>this.params.maximumSequenceNumbersToCollect?(ze("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${T}`),a=this.params.maximumSequenceNumbersToCollect):a=T,d=Date.now(),this.nthSequenceNumber(e,a)))).next((T=>(s=T,f=Date.now(),this.removeTargets(e,s,t)))).next((T=>(l=T,m=Date.now(),this.removeOrphanedDocuments(e,s)))).next((T=>(v=Date.now(),So()<=vt.DEBUG&&ze("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-w}ms
	Determined least recently used ${a} in `+(f-d)+`ms
	Removed ${l} targets in `+(m-f)+`ms
	Removed ${T} documents in `+(v-m)+`ms
Total Duration: ${v-w}ms`),ye.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:l,documentsRemoved:T}))))}}function fP(n,e){return new hP(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pP{constructor(){this.changes=new Ua((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,lr.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const s=this.changes.get(t);return s!==void 0?ye.resolve(s):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mP{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gP{constructor(e,t,s,a){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=s,this.indexManager=a}getDocument(e,t){let s=null;return this.documentOverlayCache.getOverlay(e,t).next((a=>(s=a,this.remoteDocumentCache.getEntry(e,t)))).next((a=>(s!==null&&zl(s.mutation,a,Br.empty(),Bt.now()),a)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((s=>this.getLocalViewOfDocuments(e,s,_t()).next((()=>s))))}getLocalViewOfDocuments(e,t,s=_t()){const a=Na();return this.populateOverlays(e,a,t).next((()=>this.computeViews(e,t,a,s).next((l=>{let d=jl();return l.forEach(((f,m)=>{d=d.insert(f,m.overlayedDocument)})),d}))))}getOverlayedDocuments(e,t){const s=Na();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,_t())))}populateOverlays(e,t,s){const a=[];return s.forEach((l=>{t.has(l)||a.push(l)})),this.documentOverlayCache.getOverlays(e,a).next((l=>{l.forEach(((d,f)=>{t.set(d,f)}))}))}computeViews(e,t,s,a){let l=yi();const d=Ul(),f=(function(){return Ul()})();return t.forEach(((m,v)=>{const w=s.get(v.key);a.has(v.key)&&(w===void 0||w.mutation instanceof ua)?l=l.insert(v.key,v):w!==void 0?(d.set(v.key,w.mutation.getFieldMask()),zl(w.mutation,v,w.mutation.getFieldMask(),Bt.now())):d.set(v.key,Br.empty())})),this.recalculateAndSaveOverlays(e,l).next((m=>(m.forEach(((v,w)=>d.set(v,w))),t.forEach(((v,w)=>{var T;return f.set(v,new mP(w,(T=d.get(v))!==null&&T!==void 0?T:null))})),f)))}recalculateAndSaveOverlays(e,t){const s=Ul();let a=new Qt(((d,f)=>d-f)),l=_t();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((d=>{for(const f of d)f.keys().forEach((m=>{const v=t.get(m);if(v===null)return;let w=s.get(m)||Br.empty();w=f.applyToLocalView(v,w),s.set(m,w);const T=(a.get(f.batchId)||_t()).add(m);a=a.insert(f.batchId,T)}))})).next((()=>{const d=[],f=a.getReverseIterator();for(;f.hasNext();){const m=f.getNext(),v=m.key,w=m.value,T=fw();w.forEach((C=>{if(!l.has(C)){const U=_w(t.get(C),s.get(C));U!==null&&T.set(C,U),l=l.add(C)}})),d.push(this.documentOverlayCache.saveOverlays(e,v,T))}return ye.waitFor(d)})).next((()=>s))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((s=>this.recalculateAndSaveOverlays(e,s)))}getDocumentsMatchingQuery(e,t,s,a){return(function(d){return Xe.isDocumentKey(d.path)&&d.collectionGroup===null&&d.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):lw(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,s,a):this.getDocumentsMatchingCollectionQuery(e,t,s,a)}getNextDocuments(e,t,s,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,s,a).next((l=>{const d=a-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,s.largestBatchId,a-l.size):ye.resolve(Na());let f=Hl,m=l;return d.next((v=>ye.forEach(v,((w,T)=>(f<T.largestBatchId&&(f=T.largestBatchId),l.get(w)?ye.resolve():this.remoteDocumentCache.getEntry(e,w).next((C=>{m=m.insert(w,C)}))))).next((()=>this.populateOverlays(e,v,l))).next((()=>this.computeViews(e,m,v,_t()))).next((w=>({batchId:f,changes:hw(w)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Xe(t)).next((s=>{let a=jl();return s.isFoundDocument()&&(a=a.insert(s.key,s)),a}))}getDocumentsMatchingCollectionGroupQuery(e,t,s,a){const l=t.collectionGroup;let d=jl();return this.indexManager.getCollectionParents(e,l).next((f=>ye.forEach(f,(m=>{const v=(function(T,C){return new Qo(C,null,T.explicitOrderBy.slice(),T.filters.slice(),T.limit,T.limitType,T.startAt,T.endAt)})(t,m.child(l));return this.getDocumentsMatchingCollectionQuery(e,v,s,a).next((w=>{w.forEach(((T,C)=>{d=d.insert(T,C)}))}))})).next((()=>d))))}getDocumentsMatchingCollectionQuery(e,t,s,a){let l;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,s.largestBatchId).next((d=>(l=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,s,l,a)))).next((d=>{l.forEach(((m,v)=>{const w=v.getKey();d.get(w)===null&&(d=d.insert(w,lr.newInvalidDocument(w)))}));let f=jl();return d.forEach(((m,v)=>{const w=l.get(m);w!==void 0&&zl(w.mutation,v,Br.empty(),Bt.now()),md(t,v)&&(f=f.insert(m,v))})),f}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yP{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,t){return ye.resolve(this.Br.get(t))}saveBundleMetadata(e,t){return this.Br.set(t.id,(function(a){return{id:a.id,version:a.version,createTime:zs(a.createTime)}})(t)),ye.resolve()}getNamedQuery(e,t){return ye.resolve(this.Lr.get(t))}saveNamedQuery(e,t){return this.Lr.set(t.name,(function(a){return{name:a.name,query:aP(a.bundledQuery),readTime:zs(a.readTime)}})(t)),ye.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vP{constructor(){this.overlays=new Qt(Xe.comparator),this.kr=new Map}getOverlay(e,t){return ye.resolve(this.overlays.get(t))}getOverlays(e,t){const s=Na();return ye.forEach(t,(a=>this.getOverlay(e,a).next((l=>{l!==null&&s.set(a,l)})))).next((()=>s))}saveOverlays(e,t,s){return s.forEach(((a,l)=>{this.wt(e,t,l)})),ye.resolve()}removeOverlaysForBatchId(e,t,s){const a=this.kr.get(s);return a!==void 0&&(a.forEach((l=>this.overlays=this.overlays.remove(l))),this.kr.delete(s)),ye.resolve()}getOverlaysForCollection(e,t,s){const a=Na(),l=t.length+1,d=new Xe(t.child("")),f=this.overlays.getIteratorFrom(d);for(;f.hasNext();){const m=f.getNext().value,v=m.getKey();if(!t.isPrefixOf(v.path))break;v.path.length===l&&m.largestBatchId>s&&a.set(m.getKey(),m)}return ye.resolve(a)}getOverlaysForCollectionGroup(e,t,s,a){let l=new Qt(((v,w)=>v-w));const d=this.overlays.getIterator();for(;d.hasNext();){const v=d.getNext().value;if(v.getKey().getCollectionGroup()===t&&v.largestBatchId>s){let w=l.get(v.largestBatchId);w===null&&(w=Na(),l=l.insert(v.largestBatchId,w)),w.set(v.getKey(),v)}}const f=Na(),m=l.getIterator();for(;m.hasNext()&&(m.getNext().value.forEach(((v,w)=>f.set(v,w))),!(f.size()>=a)););return ye.resolve(f)}wt(e,t,s){const a=this.overlays.get(s.key);if(a!==null){const d=this.kr.get(a.largestBatchId).delete(s.key);this.kr.set(a.largestBatchId,d)}this.overlays=this.overlays.insert(s.key,new MI(t,s));let l=this.kr.get(t);l===void 0&&(l=_t(),this.kr.set(t,l)),this.kr.set(t,l.add(s.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _P{constructor(){this.sessionToken=Qn.EMPTY_BYTE_STRING}getSessionToken(e){return ye.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ye.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kp{constructor(){this.qr=new In(Fn.Qr),this.$r=new In(Fn.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,t){const s=new Fn(e,t);this.qr=this.qr.add(s),this.$r=this.$r.add(s)}Kr(e,t){e.forEach((s=>this.addReference(s,t)))}removeReference(e,t){this.Wr(new Fn(e,t))}Gr(e,t){e.forEach((s=>this.removeReference(s,t)))}zr(e){const t=new Xe(new Mt([])),s=new Fn(t,e),a=new Fn(t,e+1),l=[];return this.$r.forEachInRange([s,a],(d=>{this.Wr(d),l.push(d.key)})),l}jr(){this.qr.forEach((e=>this.Wr(e)))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const t=new Xe(new Mt([])),s=new Fn(t,e),a=new Fn(t,e+1);let l=_t();return this.$r.forEachInRange([s,a],(d=>{l=l.add(d.key)})),l}containsKey(e){const t=new Fn(e,0),s=this.qr.firstAfterOrEqual(t);return s!==null&&e.isEqual(s.key)}}class Fn{constructor(e,t){this.key=e,this.Hr=t}static Qr(e,t){return Xe.comparator(e.key,t.key)||ft(e.Hr,t.Hr)}static Ur(e,t){return ft(e.Hr,t.Hr)||Xe.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wP{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.er=1,this.Yr=new In(Fn.Qr)}checkEmpty(e){return ye.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,s,a){const l=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new VI(l,t,s,a);this.mutationQueue.push(d);for(const f of a)this.Yr=this.Yr.add(new Fn(f.key,l)),this.indexManager.addToCollectionParentIndex(e,f.key.path.popLast());return ye.resolve(d)}lookupMutationBatch(e,t){return ye.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const s=t+1,a=this.Xr(s),l=a<0?0:a;return ye.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return ye.resolve(this.mutationQueue.length===0?Tp:this.er-1)}getAllMutationBatches(e){return ye.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const s=new Fn(t,0),a=new Fn(t,Number.POSITIVE_INFINITY),l=[];return this.Yr.forEachInRange([s,a],(d=>{const f=this.Zr(d.Hr);l.push(f)})),ye.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,t){let s=new In(ft);return t.forEach((a=>{const l=new Fn(a,0),d=new Fn(a,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([l,d],(f=>{s=s.add(f.Hr)}))})),ye.resolve(this.ei(s))}getAllMutationBatchesAffectingQuery(e,t){const s=t.path,a=s.length+1;let l=s;Xe.isDocumentKey(l)||(l=l.child(""));const d=new Fn(new Xe(l),0);let f=new In(ft);return this.Yr.forEachWhile((m=>{const v=m.key.path;return!!s.isPrefixOf(v)&&(v.length===a&&(f=f.add(m.Hr)),!0)}),d),ye.resolve(this.ei(f))}ei(e){const t=[];return e.forEach((s=>{const a=this.Zr(s);a!==null&&t.push(a)})),t}removeMutationBatch(e,t){At(this.ti(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let s=this.Yr;return ye.forEach(t.mutations,(a=>{const l=new Fn(a.key,t.batchId);return s=s.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((()=>{this.Yr=s}))}rr(e){}containsKey(e,t){const s=new Fn(t,0),a=this.Yr.firstAfterOrEqual(s);return ye.resolve(t.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,ye.resolve()}ti(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xP{constructor(e){this.ni=e,this.docs=(function(){return new Qt(Xe.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const s=t.key,a=this.docs.get(s),l=a?a.size:0,d=this.ni(t);return this.docs=this.docs.insert(s,{document:t.mutableCopy(),size:d}),this.size+=d-l,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const s=this.docs.get(t);return ye.resolve(s?s.document.mutableCopy():lr.newInvalidDocument(t))}getEntries(e,t){let s=yi();return t.forEach((a=>{const l=this.docs.get(a);s=s.insert(a,l?l.document.mutableCopy():lr.newInvalidDocument(a))})),ye.resolve(s)}getDocumentsMatchingQuery(e,t,s,a){let l=yi();const d=t.path,f=new Xe(d.child("__id-9223372036854775808__")),m=this.docs.getIteratorFrom(f);for(;m.hasNext();){const{key:v,value:{document:w}}=m.getNext();if(!d.isPrefixOf(v.path))break;v.path.length>d.length+1||YC(QC(w),s)<=0||(a.has(w.key)||md(t,w))&&(l=l.insert(w.key,w.mutableCopy()))}return ye.resolve(l)}getAllFromCollectionGroup(e,t,s,a){it(9500)}ri(e,t){return ye.forEach(this.docs,(s=>t(s)))}newChangeBuffer(e){return new EP(this)}getSize(e){return ye.resolve(this.size)}}class EP extends pP{constructor(e){super(),this.Or=e}applyChanges(e){const t=[];return this.changes.forEach(((s,a)=>{a.isValidDocument()?t.push(this.Or.addEntry(e,a)):this.Or.removeEntry(s)})),ye.waitFor(t)}getFromCache(e,t){return this.Or.getEntry(e,t)}getAllFromCache(e,t){return this.Or.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TP{constructor(e){this.persistence=e,this.ii=new Ua((t=>Cp(t)),Ip),this.lastRemoteSnapshotVersion=lt.min(),this.highestTargetId=0,this.si=0,this.oi=new kp,this.targetCount=0,this._i=Mo.ar()}forEachTarget(e,t){return this.ii.forEach(((s,a)=>t(a))),ye.resolve()}getLastRemoteSnapshotVersion(e){return ye.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ye.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),ye.resolve(this.highestTargetId)}setTargetsMetadata(e,t,s){return s&&(this.lastRemoteSnapshotVersion=s),t>this.si&&(this.si=t),ye.resolve()}hr(e){this.ii.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this._i=new Mo(t),this.highestTargetId=t),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,t){return this.hr(t),this.targetCount+=1,ye.resolve()}updateTargetData(e,t){return this.hr(t),ye.resolve()}removeTargetData(e,t){return this.ii.delete(t.target),this.oi.zr(t.targetId),this.targetCount-=1,ye.resolve()}removeTargets(e,t,s){let a=0;const l=[];return this.ii.forEach(((d,f)=>{f.sequenceNumber<=t&&s.get(f.targetId)===null&&(this.ii.delete(d),l.push(this.removeMatchingKeysForTargetId(e,f.targetId)),a++)})),ye.waitFor(l).next((()=>a))}getTargetCount(e){return ye.resolve(this.targetCount)}getTargetData(e,t){const s=this.ii.get(t)||null;return ye.resolve(s)}addMatchingKeys(e,t,s){return this.oi.Kr(t,s),ye.resolve()}removeMatchingKeys(e,t,s){this.oi.Gr(t,s);const a=this.persistence.referenceDelegate,l=[];return a&&t.forEach((d=>{l.push(a.markPotentiallyOrphaned(e,d))})),ye.waitFor(l)}removeMatchingKeysForTargetId(e,t){return this.oi.zr(t),ye.resolve()}getMatchingKeysForTargetId(e,t){const s=this.oi.Jr(t);return ye.resolve(s)}containsKey(e,t){return ye.resolve(this.oi.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jw{constructor(e,t){this.ai={},this.overlays={},this.ui=new ud(0),this.ci=!1,this.ci=!0,this.li=new _P,this.referenceDelegate=e(this),this.hi=new TP(this),this.indexManager=new oP,this.remoteDocumentCache=(function(a){return new xP(a)})((s=>this.referenceDelegate.Pi(s))),this.serializer=new iP(t),this.Ti=new yP(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new vP,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let s=this.ai[e.toKey()];return s||(s=new wP(t,this.referenceDelegate),this.ai[e.toKey()]=s),s}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,t,s){ze("MemoryPersistence","Starting transaction:",e);const a=new SP(this.ui.next());return this.referenceDelegate.Ii(),s(a).next((l=>this.referenceDelegate.di(a).next((()=>l)))).toPromise().then((l=>(a.raiseOnCommittedEvent(),l)))}Ei(e,t){return ye.or(Object.values(this.ai).map((s=>()=>s.containsKey(e,t))))}}class SP extends XC{constructor(e){super(),this.currentSequenceNumber=e}}class Dp{constructor(e){this.persistence=e,this.Ai=new kp,this.Ri=null}static Vi(e){return new Dp(e)}get mi(){if(this.Ri)return this.Ri;throw it(60996)}addReference(e,t,s){return this.Ai.addReference(s,t),this.mi.delete(s.toString()),ye.resolve()}removeReference(e,t,s){return this.Ai.removeReference(s,t),this.mi.add(s.toString()),ye.resolve()}markPotentiallyOrphaned(e,t){return this.mi.add(t.toString()),ye.resolve()}removeTarget(e,t){this.Ai.zr(t.targetId).forEach((a=>this.mi.add(a.toString())));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,t.targetId).next((a=>{a.forEach((l=>this.mi.add(l.toString())))})).next((()=>s.removeTargetData(e,t)))}Ii(){this.Ri=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ye.forEach(this.mi,(s=>{const a=Xe.fromPath(s);return this.fi(e,a).next((l=>{l||t.removeEntry(a,lt.min())}))})).next((()=>(this.Ri=null,t.apply(e))))}updateLimboDocument(e,t){return this.fi(e,t).next((s=>{s?this.mi.delete(t.toString()):this.mi.add(t.toString())}))}Pi(e){return 0}fi(e,t){return ye.or([()=>ye.resolve(this.Ai.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class Xu{constructor(e,t){this.persistence=e,this.gi=new Ua((s=>tI(s.path)),((s,a)=>s.isEqual(a))),this.garbageCollector=fP(this,t)}static Vi(e,t){return new Xu(e,t)}Ii(){}di(e){return ye.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}mr(e){const t=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next((s=>t.next((a=>s+a))))}yr(e){let t=0;return this.gr(e,(s=>{t++})).next((()=>t))}gr(e,t){return ye.forEach(this.gi,((s,a)=>this.Sr(e,s,a).next((l=>l?ye.resolve():t(a)))))}removeTargets(e,t,s){return this.persistence.getTargetCache().removeTargets(e,t,s)}removeOrphanedDocuments(e,t){let s=0;const a=this.persistence.getRemoteDocumentCache(),l=a.newChangeBuffer();return a.ri(e,(d=>this.Sr(e,d,t).next((f=>{f||(s++,l.removeEntry(d,lt.min()))})))).next((()=>l.apply(e))).next((()=>s))}markPotentiallyOrphaned(e,t){return this.gi.set(t,e.currentSequenceNumber),ye.resolve()}removeTarget(e,t){const s=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,s)}addReference(e,t,s){return this.gi.set(s,e.currentSequenceNumber),ye.resolve()}removeReference(e,t,s){return this.gi.set(s,e.currentSequenceNumber),ye.resolve()}updateLimboDocument(e,t){return this.gi.set(t,e.currentSequenceNumber),ye.resolve()}Pi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Nu(e.data.value)),t}Sr(e,t,s){return ye.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const a=this.gi.get(t);return ye.resolve(a!==void 0&&a>s)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lp{constructor(e,t,s,a){this.targetId=e,this.fromCache=t,this.Is=s,this.ds=a}static Es(e,t){let s=_t(),a=_t();for(const l of t.docChanges)switch(l.type){case 0:s=s.add(l.doc.key);break;case 1:a=a.add(l.doc.key)}return new Lp(e,t.fromCache,s,a)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bP{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CP{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=(function(){return tS()?8:ZC(cr())>0?6:4})()}initialize(e,t){this.gs=e,this.indexManager=t,this.As=!0}getDocumentsMatchingQuery(e,t,s,a){const l={result:null};return this.ps(e,t).next((d=>{l.result=d})).next((()=>{if(!l.result)return this.ys(e,t,a,s).next((d=>{l.result=d}))})).next((()=>{if(l.result)return;const d=new bP;return this.ws(e,t,d).next((f=>{if(l.result=f,this.Rs)return this.Ss(e,t,d,f.size)}))})).next((()=>l.result))}Ss(e,t,s,a){return s.documentReadCount<this.Vs?(So()<=vt.DEBUG&&ze("QueryEngine","SDK will not create cache indexes for query:",bo(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),ye.resolve()):(So()<=vt.DEBUG&&ze("QueryEngine","Query:",bo(t),"scans",s.documentReadCount,"local documents and returns",a,"documents as results."),s.documentReadCount>this.fs*a?(So()<=vt.DEBUG&&ze("QueryEngine","The SDK decides to create cache indexes for query:",bo(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Us(t))):ye.resolve())}ps(e,t){if(Nv(t))return ye.resolve(null);let s=Us(t);return this.indexManager.getIndexType(e,s).next((a=>a===0?null:(t.limit!==null&&a===1&&(t=Qu(t,null,"F"),s=Us(t)),this.indexManager.getDocumentsMatchingTarget(e,s).next((l=>{const d=_t(...l);return this.gs.getDocuments(e,d).next((f=>this.indexManager.getMinOffset(e,s).next((m=>{const v=this.bs(t,f);return this.Ds(t,v,d,m.readTime)?this.ps(e,Qu(t,null,"F")):this.vs(e,v,t,m)}))))})))))}ys(e,t,s,a){return Nv(t)||a.isEqual(lt.min())?ye.resolve(null):this.gs.getDocuments(e,s).next((l=>{const d=this.bs(t,l);return this.Ds(t,d,s,a)?ye.resolve(null):(So()<=vt.DEBUG&&ze("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),bo(t)),this.vs(e,d,t,KC(a,Hl)).next((f=>f)))}))}bs(e,t){let s=new In(uw(e));return t.forEach(((a,l)=>{md(e,l)&&(s=s.add(l))})),s}Ds(e,t,s,a){if(e.limit===null)return!1;if(s.size!==t.size)return!0;const l=e.limitType==="F"?t.last():t.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(a)>0)}ws(e,t,s){return So()<=vt.DEBUG&&ze("QueryEngine","Using full collection scan to execute query:",bo(t)),this.gs.getDocumentsMatchingQuery(e,t,Zi.min(),s)}vs(e,t,s,a){return this.gs.getDocumentsMatchingQuery(e,s,a).next((l=>(t.forEach((d=>{l=l.insert(d.key,d)})),l)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vp="LocalStore",IP=3e8;class PP{constructor(e,t,s,a){this.persistence=e,this.Cs=t,this.serializer=a,this.Fs=new Qt(ft),this.Ms=new Ua((l=>Cp(l)),Ip),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(s)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new gP(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Fs)))}}function NP(n,e,t,s){return new PP(n,e,t,s)}async function kw(n,e){const t=ct(n);return await t.persistence.runTransaction("Handle user change","readonly",(s=>{let a;return t.mutationQueue.getAllMutationBatches(s).next((l=>(a=l,t.Ns(e),t.mutationQueue.getAllMutationBatches(s)))).next((l=>{const d=[],f=[];let m=_t();for(const v of a){d.push(v.batchId);for(const w of v.mutations)m=m.add(w.key)}for(const v of l){f.push(v.batchId);for(const w of v.mutations)m=m.add(w.key)}return t.localDocuments.getDocuments(s,m).next((v=>({Bs:v,removedBatchIds:d,addedBatchIds:f})))}))}))}function RP(n,e){const t=ct(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(s=>{const a=e.batch.keys(),l=t.Os.newChangeBuffer({trackRemovals:!0});return(function(f,m,v,w){const T=v.batch,C=T.keys();let U=ye.resolve();return C.forEach((X=>{U=U.next((()=>w.getEntry(m,X))).next((q=>{const F=v.docVersions.get(X);At(F!==null,48541),q.version.compareTo(F)<0&&(T.applyToRemoteDocument(q,v),q.isValidDocument()&&(q.setReadTime(v.commitVersion),w.addEntry(q)))}))})),U.next((()=>f.mutationQueue.removeMutationBatch(m,T)))})(t,s,e,l).next((()=>l.apply(s))).next((()=>t.mutationQueue.performConsistencyCheck(s))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(s,a,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,(function(f){let m=_t();for(let v=0;v<f.mutationResults.length;++v)f.mutationResults[v].transformResults.length>0&&(m=m.add(f.batch.mutations[v].key));return m})(e)))).next((()=>t.localDocuments.getDocuments(s,a)))}))}function Dw(n){const e=ct(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.hi.getLastRemoteSnapshotVersion(t)))}function AP(n,e){const t=ct(n),s=e.snapshotVersion;let a=t.Fs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const d=t.Os.newChangeBuffer({trackRemovals:!0});a=t.Fs;const f=[];e.targetChanges.forEach(((w,T)=>{const C=a.get(T);if(!C)return;f.push(t.hi.removeMatchingKeys(l,w.removedDocuments,T).next((()=>t.hi.addMatchingKeys(l,w.addedDocuments,T))));let U=C.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(T)!==null?U=U.withResumeToken(Qn.EMPTY_BYTE_STRING,lt.min()).withLastLimboFreeSnapshotVersion(lt.min()):w.resumeToken.approximateByteSize()>0&&(U=U.withResumeToken(w.resumeToken,s)),a=a.insert(T,U),(function(q,F,ie){return q.resumeToken.approximateByteSize()===0||F.snapshotVersion.toMicroseconds()-q.snapshotVersion.toMicroseconds()>=IP?!0:ie.addedDocuments.size+ie.modifiedDocuments.size+ie.removedDocuments.size>0})(C,U,w)&&f.push(t.hi.updateTargetData(l,U))}));let m=yi(),v=_t();if(e.documentUpdates.forEach((w=>{e.resolvedLimboDocuments.has(w)&&f.push(t.persistence.referenceDelegate.updateLimboDocument(l,w))})),f.push(jP(l,d,e.documentUpdates).next((w=>{m=w.Ls,v=w.ks}))),!s.isEqual(lt.min())){const w=t.hi.getLastRemoteSnapshotVersion(l).next((T=>t.hi.setTargetsMetadata(l,l.currentSequenceNumber,s)));f.push(w)}return ye.waitFor(f).next((()=>d.apply(l))).next((()=>t.localDocuments.getLocalViewOfDocuments(l,m,v))).next((()=>m))})).then((l=>(t.Fs=a,l)))}function jP(n,e,t){let s=_t(),a=_t();return t.forEach((l=>s=s.add(l))),e.getEntries(n,s).next((l=>{let d=yi();return t.forEach(((f,m)=>{const v=l.get(f);m.isFoundDocument()!==v.isFoundDocument()&&(a=a.add(f)),m.isNoDocument()&&m.version.isEqual(lt.min())?(e.removeEntry(f,m.readTime),d=d.insert(f,m)):!v.isValidDocument()||m.version.compareTo(v.version)>0||m.version.compareTo(v.version)===0&&v.hasPendingWrites?(e.addEntry(m),d=d.insert(f,m)):ze(Vp,"Ignoring outdated watch update for ",f,". Current version:",v.version," Watch version:",m.version)})),{Ls:d,ks:a}}))}function kP(n,e){const t=ct(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(s=>(e===void 0&&(e=Tp),t.mutationQueue.getNextMutationBatchAfterBatchId(s,e))))}function DP(n,e){const t=ct(n);return t.persistence.runTransaction("Allocate target","readwrite",(s=>{let a;return t.hi.getTargetData(s,e).next((l=>l?(a=l,ye.resolve(a)):t.hi.allocateTargetId(s).next((d=>(a=new Gi(e,d,"TargetPurposeListen",s.currentSequenceNumber),t.hi.addTargetData(s,a).next((()=>a)))))))})).then((s=>{const a=t.Fs.get(s.targetId);return(a===null||s.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(t.Fs=t.Fs.insert(s.targetId,s),t.Ms.set(e,s.targetId)),s}))}async function Gf(n,e,t){const s=ct(n),a=s.Fs.get(e),l=t?"readwrite":"readwrite-primary";try{t||await s.persistence.runTransaction("Release target",l,(d=>s.persistence.referenceDelegate.removeTarget(d,a)))}catch(d){if(!Ko(d))throw d;ze(Vp,`Failed to update sequence numbers for target ${e}: ${d}`)}s.Fs=s.Fs.remove(e),s.Ms.delete(a.target)}function Bv(n,e,t){const s=ct(n);let a=lt.min(),l=_t();return s.persistence.runTransaction("Execute query","readwrite",(d=>(function(m,v,w){const T=ct(m),C=T.Ms.get(w);return C!==void 0?ye.resolve(T.Fs.get(C)):T.hi.getTargetData(v,w)})(s,d,Us(e)).next((f=>{if(f)return a=f.lastLimboFreeSnapshotVersion,s.hi.getMatchingKeysForTargetId(d,f.targetId).next((m=>{l=m}))})).next((()=>s.Cs.getDocumentsMatchingQuery(d,e,t?a:lt.min(),t?l:_t()))).next((f=>(LP(s,wI(e),f),{documents:f,qs:l})))))}function LP(n,e,t){let s=n.xs.get(e)||lt.min();t.forEach(((a,l)=>{l.readTime.compareTo(s)>0&&(s=l.readTime)})),n.xs.set(e,s)}class $v{constructor(){this.activeTargetIds=CI()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class VP{constructor(){this.Fo=new $v,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,s){}addLocalQueryTarget(e,t=!0){return t&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,t,s){this.Mo[e]=t}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new $v,Promise.resolve()}handleUserChange(e,t,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MP{xo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wv="ConnectivityMonitor";class Gv{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){ze(Wv,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){ze(Wv,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xu=null;function qf(){return xu===null?xu=(function(){return 268435456+Math.round(2147483648*Math.random())})():xu++,"0x"+xu.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pf="RestConnection",OP={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class FP{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.$o=t+"://"+e.host,this.Uo=`projects/${s}/databases/${a}`,this.Ko=this.databaseId.database===qu?`project_id=${s}`:`project_id=${s}&database_id=${a}`}Wo(e,t,s,a,l){const d=qf(),f=this.Go(e,t.toUriEncodedString());ze(pf,`Sending RPC '${e}' ${d}:`,f,s);const m={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(m,a,l);const{host:v}=new URL(f),w=Bo(v);return this.jo(e,f,m,s,w).then((T=>(ze(pf,`Received RPC '${e}' ${d}: `,T),T)),(T=>{throw Xi(pf,`RPC '${e}' ${d} failed with error: `,T,"url: ",f,"request:",s),T}))}Jo(e,t,s,a,l,d){return this.Wo(e,t,s,a,l)}zo(e,t,s){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+qo})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((a,l)=>e[l]=a)),s&&s.headers.forEach(((a,l)=>e[l]=a))}Go(e,t){const s=OP[e];return`${this.$o}/v1/${t}:${s}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UP{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ar="WebChannelConnection";class zP extends FP{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,t,s,a,l){const d=qf();return new Promise(((f,m)=>{const v=new V0;v.setWithCredentials(!0),v.listenOnce(M0.COMPLETE,(()=>{try{switch(v.getLastErrorCode()){case Pu.NO_ERROR:const T=v.getResponseJson();ze(ar,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(T)),f(T);break;case Pu.TIMEOUT:ze(ar,`RPC '${e}' ${d} timed out`),m(new Fe(fe.DEADLINE_EXCEEDED,"Request time out"));break;case Pu.HTTP_ERROR:const C=v.getStatus();if(ze(ar,`RPC '${e}' ${d} failed with status:`,C,"response text:",v.getResponseText()),C>0){let U=v.getResponseJson();Array.isArray(U)&&(U=U[0]);const X=U==null?void 0:U.error;if(X&&X.status&&X.message){const q=(function(ie){const Se=ie.toLowerCase().replace(/_/g,"-");return Object.values(fe).indexOf(Se)>=0?Se:fe.UNKNOWN})(X.status);m(new Fe(q,X.message))}else m(new Fe(fe.UNKNOWN,"Server responded with status "+v.getStatus()))}else m(new Fe(fe.UNAVAILABLE,"Connection failed."));break;default:it(9055,{c_:e,streamId:d,l_:v.getLastErrorCode(),h_:v.getLastError()})}}finally{ze(ar,`RPC '${e}' ${d} completed.`)}}));const w=JSON.stringify(a);ze(ar,`RPC '${e}' ${d} sending request:`,a),v.send(t,"POST",w,s,15)}))}P_(e,t,s){const a=qf(),l=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=U0(),f=F0(),m={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},v=this.longPollingOptions.timeoutSeconds;v!==void 0&&(m.longPollingTimeout=Math.round(1e3*v)),this.useFetchStreams&&(m.useFetchStreams=!0),this.zo(m.initMessageHeaders,t,s),m.encodeInitMessageHeaders=!0;const w=l.join("");ze(ar,`Creating RPC '${e}' stream ${a}: ${w}`,m);const T=d.createWebChannel(w,m);this.T_(T);let C=!1,U=!1;const X=new UP({Ho:F=>{U?ze(ar,`Not sending because RPC '${e}' stream ${a} is closed:`,F):(C||(ze(ar,`Opening RPC '${e}' stream ${a} transport.`),T.open(),C=!0),ze(ar,`RPC '${e}' stream ${a} sending:`,F),T.send(F))},Yo:()=>T.close()}),q=(F,ie,Se)=>{F.listen(ie,(Ee=>{try{Se(Ee)}catch(we){setTimeout((()=>{throw we}),0)}}))};return q(T,Al.EventType.OPEN,(()=>{U||(ze(ar,`RPC '${e}' stream ${a} transport opened.`),X.s_())})),q(T,Al.EventType.CLOSE,(()=>{U||(U=!0,ze(ar,`RPC '${e}' stream ${a} transport closed`),X.__(),this.I_(T))})),q(T,Al.EventType.ERROR,(F=>{U||(U=!0,Xi(ar,`RPC '${e}' stream ${a} transport errored. Name:`,F.name,"Message:",F.message),X.__(new Fe(fe.UNAVAILABLE,"The operation could not be completed")))})),q(T,Al.EventType.MESSAGE,(F=>{var ie;if(!U){const Se=F.data[0];At(!!Se,16349);const Ee=Se,we=(Ee==null?void 0:Ee.error)||((ie=Ee[0])===null||ie===void 0?void 0:ie.error);if(we){ze(ar,`RPC '${e}' stream ${a} received error:`,we);const V=we.status;let ae=(function(A){const M=yn[A];if(M!==void 0)return xw(M)})(V),I=we.message;ae===void 0&&(ae=fe.INTERNAL,I="Unknown error status: "+V+" with message "+we.message),U=!0,X.__(new Fe(ae,I)),T.close()}else ze(ar,`RPC '${e}' stream ${a} received:`,Se),X.a_(Se)}})),q(f,O0.STAT_EVENT,(F=>{F.stat===Df.PROXY?ze(ar,`RPC '${e}' stream ${a} detected buffering proxy`):F.stat===Df.NOPROXY&&ze(ar,`RPC '${e}' stream ${a} detected no buffering proxy`)})),setTimeout((()=>{X.o_()}),0),X}terminate(){this.u_.forEach((e=>e.close())),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter((t=>t===e))}}function mf(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _d(n){return new GI(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lw{constructor(e,t,s=1e3,a=1.5,l=6e4){this.Fi=e,this.timerId=t,this.d_=s,this.E_=a,this.A_=l,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const t=Math.floor(this.R_+this.p_()),s=Math.max(0,Date.now()-this.m_),a=Math.max(0,t-s);a>0&&ze("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.R_} ms, delay with jitter: ${t} ms, last attempt: ${s} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,a,(()=>(this.m_=Date.now(),e()))),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qv="PersistentStream";class Vw{constructor(e,t,s,a,l,d,f,m){this.Fi=e,this.w_=s,this.S_=a,this.connection=l,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=f,this.listener=m,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new Lw(e,t)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,(()=>this.L_())))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():t&&t.code===fe.RESOURCE_EXHAUSTED?(gi(t.toString()),gi("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):t&&t.code===fe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(t)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),t=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([s,a])=>{this.b_===t&&this.W_(s,a)}),(s=>{e((()=>{const a=new Fe(fe.UNKNOWN,"Fetching auth token failed: "+s.message);return this.G_(a)}))}))}W_(e,t){const s=this.K_(this.b_);this.stream=this.z_(e,t),this.stream.Zo((()=>{s((()=>this.listener.Zo()))})),this.stream.e_((()=>{s((()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,(()=>(this.x_()&&(this.state=3),Promise.resolve()))),this.listener.e_())))})),this.stream.n_((a=>{s((()=>this.G_(a)))})),this.stream.onMessage((a=>{s((()=>++this.C_==1?this.j_(a):this.onNext(a)))}))}O_(){this.state=5,this.F_.g_((async()=>{this.state=0,this.start()}))}G_(e){return ze(qv,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return t=>{this.Fi.enqueueAndForget((()=>this.b_===e?t():(ze(qv,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class BP extends Vw{constructor(e,t,s,a,l,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,s,a,d),this.serializer=l}z_(e,t){return this.connection.P_("Listen",e,t)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const t=KI(this.serializer,e),s=(function(l){if(!("targetChange"in l))return lt.min();const d=l.targetChange;return d.targetIds&&d.targetIds.length?lt.min():d.readTime?zs(d.readTime):lt.min()})(e);return this.listener.J_(t,s)}H_(e){const t={};t.database=Wf(this.serializer),t.addTarget=(function(l,d){let f;const m=d.target;if(f=Ff(m)?{documents:JI(l,m)}:{query:XI(l,m).Vt},f.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){f.resumeToken=Sw(l,d.resumeToken);const v=zf(l,d.expectedCount);v!==null&&(f.expectedCount=v)}else if(d.snapshotVersion.compareTo(lt.min())>0){f.readTime=Ju(l,d.snapshotVersion.toTimestamp());const v=zf(l,d.expectedCount);v!==null&&(f.expectedCount=v)}return f})(this.serializer,e);const s=eP(this.serializer,e);s&&(t.labels=s),this.k_(t)}Y_(e){const t={};t.database=Wf(this.serializer),t.removeTarget=e,this.k_(t)}}class $P extends Vw{constructor(e,t,s,a,l,d){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,s,a,d),this.serializer=l}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,t){return this.connection.P_("Write",e,t)}j_(e){return At(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,At(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){At(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();const t=YI(e.writeResults,e.commitTime),s=zs(e.commitTime);return this.listener.ta(s,t)}na(){const e={};e.database=Wf(this.serializer),this.k_(e)}X_(e){const t={streamToken:this.lastStreamToken,writes:e.map((s=>QI(this.serializer,s)))};this.k_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WP{}class GP extends WP{constructor(e,t,s,a){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=s,this.serializer=a,this.ra=!1}ia(){if(this.ra)throw new Fe(fe.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,s,a){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,d])=>this.connection.Wo(e,Bf(t,s),a,l,d))).catch((l=>{throw l.name==="FirebaseError"?(l.code===fe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new Fe(fe.UNKNOWN,l.toString())}))}Jo(e,t,s,a,l){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([d,f])=>this.connection.Jo(e,Bf(t,s),a,d,f,l))).catch((d=>{throw d.name==="FirebaseError"?(d.code===fe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new Fe(fe.UNKNOWN,d.toString())}))}terminate(){this.ra=!0,this.connection.terminate()}}class qP{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve()))))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(gi(t),this._a=!1):ze("OnlineStateTracker",t)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fa="RemoteStore";class HP{constructor(e,t,s,a,l){this.localStore=e,this.datastore=t,this.asyncQueue=s,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=l,this.Ea.xo((d=>{s.enqueueAndForget((async()=>{za(this)&&(ze(Fa,"Restarting streams for network reachability change."),await(async function(m){const v=ct(m);v.Ia.add(4),await uc(v),v.Aa.set("Unknown"),v.Ia.delete(4),await wd(v)})(this))}))})),this.Aa=new qP(s,a)}}async function wd(n){if(za(n))for(const e of n.da)await e(!0)}async function uc(n){for(const e of n.da)await e(!1)}function Mw(n,e){const t=ct(n);t.Ta.has(e.targetId)||(t.Ta.set(e.targetId,e),Up(t)?Fp(t):Yo(t).x_()&&Op(t,e))}function Mp(n,e){const t=ct(n),s=Yo(t);t.Ta.delete(e),s.x_()&&Ow(t,e),t.Ta.size===0&&(s.x_()?s.B_():za(t)&&t.Aa.set("Unknown"))}function Op(n,e){if(n.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(lt.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Yo(n).H_(e)}function Ow(n,e){n.Ra.$e(e),Yo(n).Y_(e)}function Fp(n){n.Ra=new zI({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>n.Ta.get(e)||null,lt:()=>n.datastore.serializer.databaseId}),Yo(n).start(),n.Aa.aa()}function Up(n){return za(n)&&!Yo(n).M_()&&n.Ta.size>0}function za(n){return ct(n).Ia.size===0}function Fw(n){n.Ra=void 0}async function KP(n){n.Aa.set("Online")}async function QP(n){n.Ta.forEach(((e,t)=>{Op(n,e)}))}async function YP(n,e){Fw(n),Up(n)?(n.Aa.la(e),Fp(n)):n.Aa.set("Unknown")}async function JP(n,e,t){if(n.Aa.set("Online"),e instanceof Tw&&e.state===2&&e.cause)try{await(async function(a,l){const d=l.cause;for(const f of l.targetIds)a.Ta.has(f)&&(await a.remoteSyncer.rejectListen(f,d),a.Ta.delete(f),a.Ra.removeTarget(f))})(n,e)}catch(s){ze(Fa,"Failed to remove targets %s: %s ",e.targetIds.join(","),s),await Zu(n,s)}else if(e instanceof ju?n.Ra.Ye(e):e instanceof Ew?n.Ra.it(e):n.Ra.et(e),!t.isEqual(lt.min()))try{const s=await Dw(n.localStore);t.compareTo(s)>=0&&await(function(l,d){const f=l.Ra.Pt(d);return f.targetChanges.forEach(((m,v)=>{if(m.resumeToken.approximateByteSize()>0){const w=l.Ta.get(v);w&&l.Ta.set(v,w.withResumeToken(m.resumeToken,d))}})),f.targetMismatches.forEach(((m,v)=>{const w=l.Ta.get(m);if(!w)return;l.Ta.set(m,w.withResumeToken(Qn.EMPTY_BYTE_STRING,w.snapshotVersion)),Ow(l,m);const T=new Gi(w.target,m,v,w.sequenceNumber);Op(l,T)})),l.remoteSyncer.applyRemoteEvent(f)})(n,t)}catch(s){ze(Fa,"Failed to raise snapshot:",s),await Zu(n,s)}}async function Zu(n,e,t){if(!Ko(e))throw e;n.Ia.add(1),await uc(n),n.Aa.set("Offline"),t||(t=()=>Dw(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{ze(Fa,"Retrying IndexedDB access"),await t(),n.Ia.delete(1),await wd(n)}))}function Uw(n,e){return e().catch((t=>Zu(n,t,e)))}async function xd(n){const e=ct(n),t=ra(e);let s=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:Tp;for(;XP(e);)try{const a=await kP(e.localStore,s);if(a===null){e.Pa.length===0&&t.B_();break}s=a.batchId,ZP(e,a)}catch(a){await Zu(e,a)}zw(e)&&Bw(e)}function XP(n){return za(n)&&n.Pa.length<10}function ZP(n,e){n.Pa.push(e);const t=ra(n);t.x_()&&t.Z_&&t.X_(e.mutations)}function zw(n){return za(n)&&!ra(n).M_()&&n.Pa.length>0}function Bw(n){ra(n).start()}async function eN(n){ra(n).na()}async function tN(n){const e=ra(n);for(const t of n.Pa)e.X_(t.mutations)}async function nN(n,e,t){const s=n.Pa.shift(),a=Rp.from(s,e,t);await Uw(n,(()=>n.remoteSyncer.applySuccessfulWrite(a))),await xd(n)}async function rN(n,e){e&&ra(n).Z_&&await(async function(s,a){if((function(d){return FI(d)&&d!==fe.ABORTED})(a.code)){const l=s.Pa.shift();ra(s).N_(),await Uw(s,(()=>s.remoteSyncer.rejectFailedWrite(l.batchId,a))),await xd(s)}})(n,e),zw(n)&&Bw(n)}async function Hv(n,e){const t=ct(n);t.asyncQueue.verifyOperationInProgress(),ze(Fa,"RemoteStore received new credentials");const s=za(t);t.Ia.add(3),await uc(t),s&&t.Aa.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ia.delete(3),await wd(t)}async function sN(n,e){const t=ct(n);e?(t.Ia.delete(2),await wd(t)):e||(t.Ia.add(2),await uc(t),t.Aa.set("Unknown"))}function Yo(n){return n.Va||(n.Va=(function(t,s,a){const l=ct(t);return l.ia(),new BP(s,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(n.datastore,n.asyncQueue,{Zo:KP.bind(null,n),e_:QP.bind(null,n),n_:YP.bind(null,n),J_:JP.bind(null,n)}),n.da.push((async e=>{e?(n.Va.N_(),Up(n)?Fp(n):n.Aa.set("Unknown")):(await n.Va.stop(),Fw(n))}))),n.Va}function ra(n){return n.ma||(n.ma=(function(t,s,a){const l=ct(t);return l.ia(),new $P(s,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),e_:eN.bind(null,n),n_:rN.bind(null,n),ea:tN.bind(null,n),ta:nN.bind(null,n)}),n.da.push((async e=>{e?(n.ma.N_(),await xd(n)):(await n.ma.stop(),n.Pa.length>0&&(ze(Fa,`Stopping write stream with ${n.Pa.length} pending writes`),n.Pa=[]))}))),n.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zp{constructor(e,t,s,a,l){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=s,this.op=a,this.removalCallback=l,this.deferred=new hi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((d=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,s,a,l){const d=Date.now()+s,f=new zp(e,t,d,a,l);return f.start(s),f}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Fe(fe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Bp(n,e){if(gi("AsyncQueue",`${e}: ${n}`),Ko(n))return new Fe(fe.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ao{static emptySet(e){return new Ao(e.comparator)}constructor(e){this.comparator=e?(t,s)=>e(t,s)||Xe.comparator(t.key,s.key):(t,s)=>Xe.comparator(t.key,s.key),this.keyedMap=jl(),this.sortedSet=new Qt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,s)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Ao)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;t.hasNext();){const a=t.getNext().key,l=s.getNext().key;if(!a.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const s=new Ao;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=t,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kv{constructor(){this.fa=new Qt(Xe.comparator)}track(e){const t=e.doc.key,s=this.fa.get(t);s?e.type!==0&&s.type===3?this.fa=this.fa.insert(t,e):e.type===3&&s.type!==1?this.fa=this.fa.insert(t,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.fa=this.fa.insert(t,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.fa=this.fa.remove(t):e.type===1&&s.type===2?this.fa=this.fa.insert(t,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):it(63341,{At:e,ga:s}):this.fa=this.fa.insert(t,e)}pa(){const e=[];return this.fa.inorderTraversal(((t,s)=>{e.push(s)})),e}}class Oo{constructor(e,t,s,a,l,d,f,m,v){this.query=e,this.docs=t,this.oldDocs=s,this.docChanges=a,this.mutatedKeys=l,this.fromCache=d,this.syncStateChanged=f,this.excludesMetadataChanges=m,this.hasCachedResults=v}static fromInitialDocuments(e,t,s,a,l){const d=[];return t.forEach((f=>{d.push({type:0,doc:f})})),new Oo(e,t,Ao.emptySet(t),d,s,a,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&pd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,s=e.docChanges;if(t.length!==s.length)return!1;for(let a=0;a<t.length;a++)if(t[a].type!==s[a].type||!t[a].doc.isEqual(s[a].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iN{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some((e=>e.ba()))}}class aN{constructor(){this.queries=Qv(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(t,s){const a=ct(t),l=a.queries;a.queries=Qv(),l.forEach(((d,f)=>{for(const m of f.wa)m.onError(s)}))})(this,new Fe(fe.ABORTED,"Firestore shutting down"))}}function Qv(){return new Ua((n=>cw(n)),pd)}async function $p(n,e){const t=ct(n);let s=3;const a=e.query;let l=t.queries.get(a);l?!l.Sa()&&e.ba()&&(s=2):(l=new iN,s=e.ba()?0:1);try{switch(s){case 0:l.ya=await t.onListen(a,!0);break;case 1:l.ya=await t.onListen(a,!1);break;case 2:await t.onFirstRemoteStoreListen(a)}}catch(d){const f=Bp(d,`Initialization of query '${bo(e.query)}' failed`);return void e.onError(f)}t.queries.set(a,l),l.wa.push(e),e.va(t.onlineState),l.ya&&e.Ca(l.ya)&&Gp(t)}async function Wp(n,e){const t=ct(n),s=e.query;let a=3;const l=t.queries.get(s);if(l){const d=l.wa.indexOf(e);d>=0&&(l.wa.splice(d,1),l.wa.length===0?a=e.ba()?0:1:!l.Sa()&&e.ba()&&(a=2))}switch(a){case 0:return t.queries.delete(s),t.onUnlisten(s,!0);case 1:return t.queries.delete(s),t.onUnlisten(s,!1);case 2:return t.onLastRemoteStoreUnlisten(s);default:return}}function oN(n,e){const t=ct(n);let s=!1;for(const a of e){const l=a.query,d=t.queries.get(l);if(d){for(const f of d.wa)f.Ca(a)&&(s=!0);d.ya=a}}s&&Gp(t)}function lN(n,e,t){const s=ct(n),a=s.queries.get(e);if(a)for(const l of a.wa)l.onError(t);s.queries.delete(e)}function Gp(n){n.Da.forEach((e=>{e.next()}))}var Hf,Yv;(Yv=Hf||(Hf={})).Fa="default",Yv.Cache="cache";class qp{constructor(e,t,s){this.query=e,this.Ma=t,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=s||{}}Ca(e){if(!this.options.includeMetadataChanges){const s=[];for(const a of e.docChanges)a.type!==3&&s.push(a);e=new Oo(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),t=!0):this.Ba(e,this.onlineState)&&(this.La(e),t=!0),this.Oa=e,t}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let t=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),t=!0),t}Ba(e,t){if(!e.fromCache||!this.ba())return!0;const s=t!=="Offline";return(!this.options.ka||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Na(e){if(e.docChanges.length>0)return!0;const t=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}La(e){e=Oo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==Hf.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $w{constructor(e){this.key=e}}class Ww{constructor(e){this.key=e}}class cN{constructor(e,t){this.query=e,this.Ha=t,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=_t(),this.mutatedKeys=_t(),this.Xa=uw(e),this.eu=new Ao(this.Xa)}get tu(){return this.Ha}nu(e,t){const s=t?t.ru:new Kv,a=t?t.eu:this.eu;let l=t?t.mutatedKeys:this.mutatedKeys,d=a,f=!1;const m=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,v=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal(((w,T)=>{const C=a.get(w),U=md(this.query,T)?T:null,X=!!C&&this.mutatedKeys.has(C.key),q=!!U&&(U.hasLocalMutations||this.mutatedKeys.has(U.key)&&U.hasCommittedMutations);let F=!1;C&&U?C.data.isEqual(U.data)?X!==q&&(s.track({type:3,doc:U}),F=!0):this.iu(C,U)||(s.track({type:2,doc:U}),F=!0,(m&&this.Xa(U,m)>0||v&&this.Xa(U,v)<0)&&(f=!0)):!C&&U?(s.track({type:0,doc:U}),F=!0):C&&!U&&(s.track({type:1,doc:C}),F=!0,(m||v)&&(f=!0)),F&&(U?(d=d.add(U),l=q?l.add(w):l.delete(w)):(d=d.delete(w),l=l.delete(w)))})),this.query.limit!==null)for(;d.size>this.query.limit;){const w=this.query.limitType==="F"?d.last():d.first();d=d.delete(w.key),l=l.delete(w.key),s.track({type:1,doc:w})}return{eu:d,ru:s,Ds:f,mutatedKeys:l}}iu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,s,a){const l=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const d=e.ru.pa();d.sort(((w,T)=>(function(U,X){const q=F=>{switch(F){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return it(20277,{At:F})}};return q(U)-q(X)})(w.type,T.type)||this.Xa(w.doc,T.doc))),this.su(s),a=a!=null&&a;const f=t&&!a?this.ou():[],m=this.Za.size===0&&this.current&&!a?1:0,v=m!==this.Ya;return this.Ya=m,d.length!==0||v?{snapshot:new Oo(this.query,e.eu,l,d,e.mutatedKeys,m===0,v,!1,!!s&&s.resumeToken.approximateByteSize()>0),_u:f}:{_u:f}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new Kv,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach((t=>this.Ha=this.Ha.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ha=this.Ha.delete(t))),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=_t(),this.eu.forEach((s=>{this.au(s.key)&&(this.Za=this.Za.add(s.key))}));const t=[];return e.forEach((s=>{this.Za.has(s)||t.push(new Ww(s))})),this.Za.forEach((s=>{e.has(s)||t.push(new $w(s))})),t}uu(e){this.Ha=e.qs,this.Za=_t();const t=this.nu(e.documents);return this.applyChanges(t,!0)}cu(){return Oo.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const Hp="SyncEngine";class uN{constructor(e,t,s){this.query=e,this.targetId=t,this.view=s}}class dN{constructor(e){this.key=e,this.lu=!1}}class hN{constructor(e,t,s,a,l,d){this.localStore=e,this.remoteStore=t,this.eventManager=s,this.sharedClientState=a,this.currentUser=l,this.maxConcurrentLimboResolutions=d,this.hu={},this.Pu=new Ua((f=>cw(f)),pd),this.Tu=new Map,this.Iu=new Set,this.du=new Qt(Xe.comparator),this.Eu=new Map,this.Au=new kp,this.Ru={},this.Vu=new Map,this.mu=Mo.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function fN(n,e,t=!0){const s=Yw(n);let a;const l=s.Pu.get(e);return l?(s.sharedClientState.addLocalQueryTarget(l.targetId),a=l.view.cu()):a=await Gw(s,e,t,!0),a}async function pN(n,e){const t=Yw(n);await Gw(t,e,!0,!1)}async function Gw(n,e,t,s){const a=await DP(n.localStore,Us(e)),l=a.targetId,d=n.sharedClientState.addLocalQueryTarget(l,t);let f;return s&&(f=await mN(n,e,l,d==="current",a.resumeToken)),n.isPrimaryClient&&t&&Mw(n.remoteStore,a),f}async function mN(n,e,t,s,a){n.gu=(T,C,U)=>(async function(q,F,ie,Se){let Ee=F.view.nu(ie);Ee.Ds&&(Ee=await Bv(q.localStore,F.query,!1).then((({documents:I})=>F.view.nu(I,Ee))));const we=Se&&Se.targetChanges.get(F.targetId),V=Se&&Se.targetMismatches.get(F.targetId)!=null,ae=F.view.applyChanges(Ee,q.isPrimaryClient,we,V);return Xv(q,F.targetId,ae._u),ae.snapshot})(n,T,C,U);const l=await Bv(n.localStore,e,!0),d=new cN(e,l.qs),f=d.nu(l.documents),m=cc.createSynthesizedTargetChangeForCurrentChange(t,s&&n.onlineState!=="Offline",a),v=d.applyChanges(f,n.isPrimaryClient,m);Xv(n,t,v._u);const w=new uN(e,t,d);return n.Pu.set(e,w),n.Tu.has(t)?n.Tu.get(t).push(e):n.Tu.set(t,[e]),v.snapshot}async function gN(n,e,t){const s=ct(n),a=s.Pu.get(e),l=s.Tu.get(a.targetId);if(l.length>1)return s.Tu.set(a.targetId,l.filter((d=>!pd(d,e)))),void s.Pu.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(a.targetId),s.sharedClientState.isActiveQueryTarget(a.targetId)||await Gf(s.localStore,a.targetId,!1).then((()=>{s.sharedClientState.clearQueryState(a.targetId),t&&Mp(s.remoteStore,a.targetId),Kf(s,a.targetId)})).catch(Ho)):(Kf(s,a.targetId),await Gf(s.localStore,a.targetId,!0))}async function yN(n,e){const t=ct(n),s=t.Pu.get(e),a=t.Tu.get(s.targetId);t.isPrimaryClient&&a.length===1&&(t.sharedClientState.removeLocalQueryTarget(s.targetId),Mp(t.remoteStore,s.targetId))}async function vN(n,e,t){const s=bN(n);try{const a=await(function(d,f){const m=ct(d),v=Bt.now(),w=f.reduce(((U,X)=>U.add(X.key)),_t());let T,C;return m.persistence.runTransaction("Locally write mutations","readwrite",(U=>{let X=yi(),q=_t();return m.Os.getEntries(U,w).next((F=>{X=F,X.forEach(((ie,Se)=>{Se.isValidDocument()||(q=q.add(ie))}))})).next((()=>m.localDocuments.getOverlayedDocuments(U,X))).next((F=>{T=F;const ie=[];for(const Se of f){const Ee=DI(Se,T.get(Se.key).overlayedDocument);Ee!=null&&ie.push(new ua(Se.key,Ee,tw(Ee.value.mapValue),ns.exists(!0)))}return m.mutationQueue.addMutationBatch(U,v,ie,f)})).next((F=>{C=F;const ie=F.applyToLocalDocumentSet(T,q);return m.documentOverlayCache.saveOverlays(U,F.batchId,ie)}))})).then((()=>({batchId:C.batchId,changes:hw(T)})))})(s.localStore,e);s.sharedClientState.addPendingMutation(a.batchId),(function(d,f,m){let v=d.Ru[d.currentUser.toKey()];v||(v=new Qt(ft)),v=v.insert(f,m),d.Ru[d.currentUser.toKey()]=v})(s,a.batchId,t),await dc(s,a.changes),await xd(s.remoteStore)}catch(a){const l=Bp(a,"Failed to persist write");t.reject(l)}}async function qw(n,e){const t=ct(n);try{const s=await AP(t.localStore,e);e.targetChanges.forEach(((a,l)=>{const d=t.Eu.get(l);d&&(At(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?d.lu=!0:a.modifiedDocuments.size>0?At(d.lu,14607):a.removedDocuments.size>0&&(At(d.lu,42227),d.lu=!1))})),await dc(t,s,e)}catch(s){await Ho(s)}}function Jv(n,e,t){const s=ct(n);if(s.isPrimaryClient&&t===0||!s.isPrimaryClient&&t===1){const a=[];s.Pu.forEach(((l,d)=>{const f=d.view.va(e);f.snapshot&&a.push(f.snapshot)})),(function(d,f){const m=ct(d);m.onlineState=f;let v=!1;m.queries.forEach(((w,T)=>{for(const C of T.wa)C.va(f)&&(v=!0)})),v&&Gp(m)})(s.eventManager,e),a.length&&s.hu.J_(a),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function _N(n,e,t){const s=ct(n);s.sharedClientState.updateQueryState(e,"rejected",t);const a=s.Eu.get(e),l=a&&a.key;if(l){let d=new Qt(Xe.comparator);d=d.insert(l,lr.newNoDocument(l,lt.min()));const f=_t().add(l),m=new vd(lt.min(),new Map,new Qt(ft),d,f);await qw(s,m),s.du=s.du.remove(l),s.Eu.delete(e),Kp(s)}else await Gf(s.localStore,e,!1).then((()=>Kf(s,e,t))).catch(Ho)}async function wN(n,e){const t=ct(n),s=e.batch.batchId;try{const a=await RP(t.localStore,e);Kw(t,s,null),Hw(t,s),t.sharedClientState.updateMutationState(s,"acknowledged"),await dc(t,a)}catch(a){await Ho(a)}}async function xN(n,e,t){const s=ct(n);try{const a=await(function(d,f){const m=ct(d);return m.persistence.runTransaction("Reject batch","readwrite-primary",(v=>{let w;return m.mutationQueue.lookupMutationBatch(v,f).next((T=>(At(T!==null,37113),w=T.keys(),m.mutationQueue.removeMutationBatch(v,T)))).next((()=>m.mutationQueue.performConsistencyCheck(v))).next((()=>m.documentOverlayCache.removeOverlaysForBatchId(v,w,f))).next((()=>m.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(v,w))).next((()=>m.localDocuments.getDocuments(v,w)))}))})(s.localStore,e);Kw(s,e,t),Hw(s,e),s.sharedClientState.updateMutationState(e,"rejected",t),await dc(s,a)}catch(a){await Ho(a)}}function Hw(n,e){(n.Vu.get(e)||[]).forEach((t=>{t.resolve()})),n.Vu.delete(e)}function Kw(n,e,t){const s=ct(n);let a=s.Ru[s.currentUser.toKey()];if(a){const l=a.get(e);l&&(t?l.reject(t):l.resolve(),a=a.remove(e)),s.Ru[s.currentUser.toKey()]=a}}function Kf(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const s of n.Tu.get(e))n.Pu.delete(s),t&&n.hu.pu(s,t);n.Tu.delete(e),n.isPrimaryClient&&n.Au.zr(e).forEach((s=>{n.Au.containsKey(s)||Qw(n,s)}))}function Qw(n,e){n.Iu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(Mp(n.remoteStore,t),n.du=n.du.remove(e),n.Eu.delete(t),Kp(n))}function Xv(n,e,t){for(const s of t)s instanceof $w?(n.Au.addReference(s.key,e),EN(n,s)):s instanceof Ww?(ze(Hp,"Document no longer in limbo: "+s.key),n.Au.removeReference(s.key,e),n.Au.containsKey(s.key)||Qw(n,s.key)):it(19791,{yu:s})}function EN(n,e){const t=e.key,s=t.path.canonicalString();n.du.get(t)||n.Iu.has(s)||(ze(Hp,"New document in limbo: "+t),n.Iu.add(s),Kp(n))}function Kp(n){for(;n.Iu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Iu.values().next().value;n.Iu.delete(e);const t=new Xe(Mt.fromString(e)),s=n.mu.next();n.Eu.set(s,new dN(t)),n.du=n.du.insert(t,s),Mw(n.remoteStore,new Gi(Us(fd(t.path)),s,"TargetPurposeLimboResolution",ud.ue))}}async function dc(n,e,t){const s=ct(n),a=[],l=[],d=[];s.Pu.isEmpty()||(s.Pu.forEach(((f,m)=>{d.push(s.gu(m,e,t).then((v=>{var w;if((v||t)&&s.isPrimaryClient){const T=v?!v.fromCache:(w=t==null?void 0:t.targetChanges.get(m.targetId))===null||w===void 0?void 0:w.current;s.sharedClientState.updateQueryState(m.targetId,T?"current":"not-current")}if(v){a.push(v);const T=Lp.Es(m.targetId,v);l.push(T)}})))})),await Promise.all(d),s.hu.J_(a),await(async function(m,v){const w=ct(m);try{await w.persistence.runTransaction("notifyLocalViewChanges","readwrite",(T=>ye.forEach(v,(C=>ye.forEach(C.Is,(U=>w.persistence.referenceDelegate.addReference(T,C.targetId,U))).next((()=>ye.forEach(C.ds,(U=>w.persistence.referenceDelegate.removeReference(T,C.targetId,U)))))))))}catch(T){if(!Ko(T))throw T;ze(Vp,"Failed to update sequence numbers: "+T)}for(const T of v){const C=T.targetId;if(!T.fromCache){const U=w.Fs.get(C),X=U.snapshotVersion,q=U.withLastLimboFreeSnapshotVersion(X);w.Fs=w.Fs.insert(C,q)}}})(s.localStore,l))}async function TN(n,e){const t=ct(n);if(!t.currentUser.isEqual(e)){ze(Hp,"User change. New user:",e.toKey());const s=await kw(t.localStore,e);t.currentUser=e,(function(l,d){l.Vu.forEach((f=>{f.forEach((m=>{m.reject(new Fe(fe.CANCELLED,d))}))})),l.Vu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await dc(t,s.Bs)}}function SN(n,e){const t=ct(n),s=t.Eu.get(e);if(s&&s.lu)return _t().add(s.key);{let a=_t();const l=t.Tu.get(e);if(!l)return a;for(const d of l){const f=t.Pu.get(d);a=a.unionWith(f.view.tu)}return a}}function Yw(n){const e=ct(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=qw.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=SN.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=_N.bind(null,e),e.hu.J_=oN.bind(null,e.eventManager),e.hu.pu=lN.bind(null,e.eventManager),e}function bN(n){const e=ct(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=wN.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=xN.bind(null,e),e}class ed{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=_d(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,t){return null}Fu(e,t){return null}vu(e){return NP(this.persistence,new CP,e.initialUser,this.serializer)}Du(e){return new jw(Dp.Vi,this.serializer)}bu(e){return new VP}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}ed.provider={build:()=>new ed};class CN extends ed{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,t){At(this.persistence.referenceDelegate instanceof Xu,46915);const s=this.persistence.referenceDelegate.garbageCollector;return new dP(s,e.asyncQueue,t)}Du(e){const t=this.cacheSizeBytes!==void 0?Ir.withCacheSize(this.cacheSizeBytes):Ir.DEFAULT;return new jw((s=>Xu.Vi(s,t)),this.serializer)}}class Qf{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>Jv(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=TN.bind(null,this.syncEngine),await sN(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new aN})()}createDatastore(e){const t=_d(e.databaseInfo.databaseId),s=(function(l){return new zP(l)})(e.databaseInfo);return(function(l,d,f,m){return new GP(l,d,f,m)})(e.authCredentials,e.appCheckCredentials,s,t)}createRemoteStore(e){return(function(s,a,l,d,f){return new HP(s,a,l,d,f)})(this.localStore,this.datastore,e.asyncQueue,(t=>Jv(this.syncEngine,t,0)),(function(){return Gv.C()?new Gv:new MP})())}createSyncEngine(e,t){return(function(a,l,d,f,m,v,w){const T=new hN(a,l,d,f,m,v);return w&&(T.fu=!0),T})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(a){const l=ct(a);ze(Fa,"RemoteStore shutting down."),l.Ia.add(5),await uc(l),l.Ea.shutdown(),l.Aa.set("Unknown")})(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}Qf.provider={build:()=>new Qf};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qp{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):gi("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sa="FirestoreClient";class IN{constructor(e,t,s,a,l){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=s,this.databaseInfo=a,this.user=or.UNAUTHENTICATED,this.clientId=Ep.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(s,(async d=>{ze(sa,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d})),this.appCheckCredentials.start(s,(d=>(ze(sa,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new hi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const s=Bp(t,"Failed to shutdown persistence");e.reject(s)}})),e.promise}}async function gf(n,e){n.asyncQueue.verifyOperationInProgress(),ze(sa,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let s=t.initialUser;n.setCredentialChangeListener((async a=>{s.isEqual(a)||(await kw(e.localStore,a),s=a)})),e.persistence.setDatabaseDeletedListener((()=>{Xi("Terminating Firestore due to IndexedDb database deletion"),n.terminate().then((()=>{ze("Terminating Firestore due to IndexedDb database deletion completed successfully")})).catch((a=>{Xi("Terminating Firestore due to IndexedDb database deletion failed",a)}))})),n._offlineComponents=e}async function Zv(n,e){n.asyncQueue.verifyOperationInProgress();const t=await PN(n);ze(sa,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((s=>Hv(e.remoteStore,s))),n.setAppCheckTokenChangeListener(((s,a)=>Hv(e.remoteStore,a))),n._onlineComponents=e}async function PN(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){ze(sa,"Using user provided OfflineComponentProvider");try{await gf(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(a){return a.name==="FirebaseError"?a.code===fe.FAILED_PRECONDITION||a.code===fe.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11})(t))throw t;Xi("Error using user provided cache. Falling back to memory cache: "+t),await gf(n,new ed)}}else ze(sa,"Using default OfflineComponentProvider"),await gf(n,new CN(void 0));return n._offlineComponents}async function Jw(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(ze(sa,"Using user provided OnlineComponentProvider"),await Zv(n,n._uninitializedComponentsProvider._online)):(ze(sa,"Using default OnlineComponentProvider"),await Zv(n,new Qf))),n._onlineComponents}function NN(n){return Jw(n).then((e=>e.syncEngine))}async function td(n){const e=await Jw(n),t=e.eventManager;return t.onListen=fN.bind(null,e.syncEngine),t.onUnlisten=gN.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=pN.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=yN.bind(null,e.syncEngine),t}function RN(n,e,t={}){const s=new hi;return n.asyncQueue.enqueueAndForget((async()=>(function(l,d,f,m,v){const w=new Qp({next:C=>{w.Ou(),d.enqueueAndForget((()=>Wp(l,T)));const U=C.docs.has(f);!U&&C.fromCache?v.reject(new Fe(fe.UNAVAILABLE,"Failed to get document because the client is offline.")):U&&C.fromCache&&m&&m.source==="server"?v.reject(new Fe(fe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):v.resolve(C)},error:C=>v.reject(C)}),T=new qp(fd(f.path),w,{includeMetadataChanges:!0,ka:!0});return $p(l,T)})(await td(n),n.asyncQueue,e,t,s))),s.promise}function AN(n,e,t={}){const s=new hi;return n.asyncQueue.enqueueAndForget((async()=>(function(l,d,f,m,v){const w=new Qp({next:C=>{w.Ou(),d.enqueueAndForget((()=>Wp(l,T))),C.fromCache&&m.source==="server"?v.reject(new Fe(fe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):v.resolve(C)},error:C=>v.reject(C)}),T=new qp(f,w,{includeMetadataChanges:!0,ka:!0});return $p(l,T)})(await td(n),n.asyncQueue,e,t,s))),s.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xw(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e_=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zw="firestore.googleapis.com",t_=!0;class n_{constructor(e){var t,s;if(e.host===void 0){if(e.ssl!==void 0)throw new Fe(fe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Zw,this.ssl=t_}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:t_;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Aw;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<cP)throw new Fe(fe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}HC("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Xw((s=e.experimentalLongPollingOptions)!==null&&s!==void 0?s:{}),(function(l){if(l.timeoutSeconds!==void 0){if(isNaN(l.timeoutSeconds))throw new Fe(fe.INVALID_ARGUMENT,`invalid long polling timeout: ${l.timeoutSeconds} (must not be NaN)`);if(l.timeoutSeconds<5)throw new Fe(fe.INVALID_ARGUMENT,`invalid long polling timeout: ${l.timeoutSeconds} (minimum allowed value is 5)`);if(l.timeoutSeconds>30)throw new Fe(fe.INVALID_ARGUMENT,`invalid long polling timeout: ${l.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(s,a){return s.timeoutSeconds===a.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ed{constructor(e,t,s,a){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=s,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new n_({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Fe(fe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Fe(fe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new n_(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(s){if(!s)return new OC;switch(s.type){case"firstParty":return new BC(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new Fe(fe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const s=e_.get(t);s&&(ze("ComponentProvider","Removing Datastore"),e_.delete(t),s.terminate())})(this),Promise.resolve()}}function jN(n,e,t,s={}){var a;n=Nr(n,Ed);const l=Bo(e),d=n._getSettings(),f=Object.assign(Object.assign({},d),{emulatorOptions:n._getEmulatorOptions()}),m=`${e}:${t}`;l&&(W_(`https://${m}`),G_("Firestore",!0)),d.host!==Zw&&d.host!==m&&Xi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const v=Object.assign(Object.assign({},d),{host:m,ssl:l,emulatorOptions:s});if(!La(v,f)&&(n._setSettings(v),s.mockUserToken)){let w,T;if(typeof s.mockUserToken=="string")w=s.mockUserToken,T=or.MOCK_USER;else{w=qT(s.mockUserToken,(a=n._app)===null||a===void 0?void 0:a.options.projectId);const C=s.mockUserToken.sub||s.mockUserToken.user_id;if(!C)throw new Fe(fe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");T=new or(C)}n._authCredentials=new FC(new B0(w,T))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xi{constructor(e,t,s){this.converter=t,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new xi(this.firestore,e,this._query)}}class Zt{constructor(e,t,s){this.converter=t,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ji(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Zt(this.firestore,e,this._key)}toJSON(){return{type:Zt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,s){if(oc(t,Zt._jsonSchema))return new Zt(e,s||null,new Xe(Mt.fromString(t.referencePath)))}}Zt._jsonSchemaVersion="firestore/documentReference/1.0",Zt._jsonSchema={type:_n("string",Zt._jsonSchemaVersion),referencePath:_n("string")};class Ji extends xi{constructor(e,t,s){super(e,t,fd(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Zt(this.firestore,null,new Xe(e))}withConverter(e){return new Ji(this.firestore,e,this._path)}}function Cn(n,e,...t){if(n=en(n),W0("collection","path",e),n instanceof Ed){const s=Mt.fromString(e,...t);return mv(s),new Ji(n,null,s)}{if(!(n instanceof Zt||n instanceof Ji))throw new Fe(fe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(Mt.fromString(e,...t));return mv(s),new Ji(n.firestore,null,s)}}function Dt(n,e,...t){if(n=en(n),arguments.length===1&&(e=Ep.newId()),W0("doc","path",e),n instanceof Ed){const s=Mt.fromString(e,...t);return pv(s),new Zt(n,null,new Xe(s))}{if(!(n instanceof Zt||n instanceof Ji))throw new Fe(fe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=n._path.child(Mt.fromString(e,...t));return pv(s),new Zt(n.firestore,n instanceof Ji?n.converter:null,new Xe(s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r_="AsyncQueue";class s_{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new Lw(this,"async_queue_retry"),this.oc=()=>{const s=mf();s&&ze(r_,"Visibility state changed to "+s.visibilityState),this.F_.y_()},this._c=e;const t=mf();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const t=mf();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise((()=>{}));const t=new hi;return this.uc((()=>this.Xu&&this.rc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Zu.push(e),this.cc())))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!Ko(e))throw e;ze(r_,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_((()=>this.cc()))}}uc(e){const t=this._c.then((()=>(this.nc=!0,e().catch((s=>{throw this.tc=s,this.nc=!1,gi("INTERNAL UNHANDLED ERROR: ",i_(s)),s})).then((s=>(this.nc=!1,s))))));return this._c=t,t}enqueueAfterDelay(e,t,s){this.ac(),this.sc.indexOf(e)>-1&&(t=0);const a=zp.createAndSchedule(this,e,t,s,(l=>this.lc(l)));return this.ec.push(a),a}ac(){this.tc&&it(47125,{hc:i_(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(const t of this.ec)if(t.timerId===e)return!0;return!1}Ic(e){return this.Pc().then((()=>{this.ec.sort(((t,s)=>t.targetTimeMs-s.targetTimeMs));for(const t of this.ec)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Pc()}))}dc(e){this.sc.push(e)}lc(e){const t=this.ec.indexOf(e);this.ec.splice(t,1)}}function i_(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a_(n){return(function(t,s){if(typeof t!="object"||t===null)return!1;const a=t;for(const l of s)if(l in a&&typeof a[l]=="function")return!0;return!1})(n,["next","error","complete"])}class vi extends Ed{constructor(e,t,s,a){super(e,t,s,a),this.type="firestore",this._queue=new s_,this._persistenceKey=(a==null?void 0:a.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new s_(e),this._firestoreClient=void 0,await e}}}function kN(n,e){const t=typeof n=="object"?n:Q_(),s=typeof n=="string"?n:qu,a=cp(t,"firestore").getImmediate({identifier:s});if(!a._initialized){const l=WT("firestore");l&&jN(a,...l)}return a}function Td(n){if(n._terminated)throw new Fe(fe.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||DN(n),n._firestoreClient}function DN(n){var e,t,s;const a=n._freezeSettings(),l=(function(f,m,v,w){return new sI(f,m,v,w.host,w.ssl,w.experimentalForceLongPolling,w.experimentalAutoDetectLongPolling,Xw(w.experimentalLongPollingOptions),w.useFetchStreams,w.isUsingEmulator)})(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,a);n._componentsProvider||!((t=a.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((s=a.localCache)===null||s===void 0)&&s._onlineComponentProvider)&&(n._componentsProvider={_offline:a.localCache._offlineComponentProvider,_online:a.localCache._onlineComponentProvider}),n._firestoreClient=new IN(n._authCredentials,n._appCheckCredentials,n._queue,l,n._componentsProvider&&(function(f){const m=f==null?void 0:f._online.build();return{_offline:f==null?void 0:f._offline.build(m),_online:m}})(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class es{constructor(e){this._byteString=e}static fromBase64String(e){try{return new es(Qn.fromBase64String(e))}catch(t){throw new Fe(fe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new es(Qn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:es._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(oc(e,es._jsonSchema))return es.fromBase64String(e.bytes)}}es._jsonSchemaVersion="firestore/bytes/1.0",es._jsonSchema={type:_n("string",es._jsonSchemaVersion),bytes:_n("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sd{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Fe(fe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Kn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bd{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bs{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Fe(fe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Fe(fe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return ft(this._lat,e._lat)||ft(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Bs._jsonSchemaVersion}}static fromJSON(e){if(oc(e,Bs._jsonSchema))return new Bs(e.latitude,e.longitude)}}Bs._jsonSchemaVersion="firestore/geoPoint/1.0",Bs._jsonSchema={type:_n("string",Bs._jsonSchemaVersion),latitude:_n("number"),longitude:_n("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $s{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(s,a){if(s.length!==a.length)return!1;for(let l=0;l<s.length;++l)if(s[l]!==a[l])return!1;return!0})(this._values,e._values)}toJSON(){return{type:$s._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(oc(e,$s._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new $s(e.vectorValues);throw new Fe(fe.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}$s._jsonSchemaVersion="firestore/vectorValue/1.0",$s._jsonSchema={type:_n("string",$s._jsonSchemaVersion),vectorValues:_n("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LN=/^__.*__$/;class VN{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return this.fieldMask!==null?new ua(e,this.data,this.fieldMask,t,this.fieldTransforms):new lc(e,this.data,t,this.fieldTransforms)}}class ex{constructor(e,t,s){this.data=e,this.fieldMask=t,this.fieldTransforms=s}toMutation(e,t){return new ua(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function tx(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw it(40011,{Ec:n})}}class Yp{constructor(e,t,s,a,l,d){this.settings=e,this.databaseId=t,this.serializer=s,this.ignoreUndefinedProperties=a,l===void 0&&this.Ac(),this.fieldTransforms=l||[],this.fieldMask=d||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new Yp(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var t;const s=(t=this.path)===null||t===void 0?void 0:t.child(e),a=this.Rc({path:s,mc:!1});return a.fc(e),a}gc(e){var t;const s=(t=this.path)===null||t===void 0?void 0:t.child(e),a=this.Rc({path:s,mc:!1});return a.Ac(),a}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return nd(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(tx(this.Ec)&&LN.test(e))throw this.wc('Document fields cannot begin and end with "__"')}}class MN{constructor(e,t,s){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=s||_d(e)}Dc(e,t,s,a=!1){return new Yp({Ec:e,methodName:t,bc:s,path:Kn.emptyPath(),mc:!1,Sc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Cd(n){const e=n._freezeSettings(),t=_d(n._databaseId);return new MN(n._databaseId,!!e.ignoreUndefinedProperties,t)}function nx(n,e,t,s,a,l={}){const d=n.Dc(l.merge||l.mergeFields?2:0,e,t,a);Xp("Data must be an object, but it was:",d,s);const f=rx(s,d);let m,v;if(l.merge)m=new Br(d.fieldMask),v=d.fieldTransforms;else if(l.mergeFields){const w=[];for(const T of l.mergeFields){const C=Yf(e,T,t);if(!d.contains(C))throw new Fe(fe.INVALID_ARGUMENT,`Field '${C}' is specified in your field mask but missing from your input data.`);ix(w,C)||w.push(C)}m=new Br(w),v=d.fieldTransforms.filter((T=>m.covers(T.field)))}else m=null,v=d.fieldTransforms;return new VN(new Pr(f),m,v)}class hc extends bd{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof hc}}class Jp extends bd{_toFieldTransform(e){return new RI(e.path,new Xl)}isEqual(e){return e instanceof Jp}}function ON(n,e,t,s){const a=n.Dc(1,e,t);Xp("Data must be an object, but it was:",a,s);const l=[],d=Pr.empty();ca(s,((m,v)=>{const w=Zp(e,m,t);v=en(v);const T=a.gc(w);if(v instanceof hc)l.push(w);else{const C=fc(v,T);C!=null&&(l.push(w),d.set(w,C))}}));const f=new Br(l);return new ex(d,f,a.fieldTransforms)}function FN(n,e,t,s,a,l){const d=n.Dc(1,e,t),f=[Yf(e,s,t)],m=[a];if(l.length%2!=0)throw new Fe(fe.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let C=0;C<l.length;C+=2)f.push(Yf(e,l[C])),m.push(l[C+1]);const v=[],w=Pr.empty();for(let C=f.length-1;C>=0;--C)if(!ix(v,f[C])){const U=f[C];let X=m[C];X=en(X);const q=d.gc(U);if(X instanceof hc)v.push(U);else{const F=fc(X,q);F!=null&&(v.push(U),w.set(U,F))}}const T=new Br(v);return new ex(w,T,d.fieldTransforms)}function UN(n,e,t,s=!1){return fc(t,n.Dc(s?4:3,e))}function fc(n,e){if(sx(n=en(n)))return Xp("Unsupported field value:",e,n),rx(n,e);if(n instanceof bd)return(function(s,a){if(!tx(a.Ec))throw a.wc(`${s._methodName}() can only be used with update() and set()`);if(!a.path)throw a.wc(`${s._methodName}() is not currently supported inside arrays`);const l=s._toFieldTransform(a);l&&a.fieldTransforms.push(l)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return(function(s,a){const l=[];let d=0;for(const f of s){let m=fc(f,a.yc(d));m==null&&(m={nullValue:"NULL_VALUE"}),l.push(m),d++}return{arrayValue:{values:l}}})(n,e)}return(function(s,a){if((s=en(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return II(a.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const l=Bt.fromDate(s);return{timestampValue:Ju(a.serializer,l)}}if(s instanceof Bt){const l=new Bt(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:Ju(a.serializer,l)}}if(s instanceof Bs)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof es)return{bytesValue:Sw(a.serializer,s._byteString)};if(s instanceof Zt){const l=a.databaseId,d=s.firestore._databaseId;if(!d.isEqual(l))throw a.wc(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:jp(s.firestore._databaseId||a.databaseId,s._key.path)}}if(s instanceof $s)return(function(d,f){return{mapValue:{fields:{[Z0]:{stringValue:ew},[Hu]:{arrayValue:{values:d.toArray().map((v=>{if(typeof v!="number")throw f.wc("VectorValues must only contain numeric values.");return Pp(f.serializer,v)}))}}}}}})(s,a);throw a.wc(`Unsupported field value: ${cd(s)}`)})(n,e)}function rx(n,e){const t={};return H0(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ca(n,((s,a)=>{const l=fc(a,e.Vc(s));l!=null&&(t[s]=l)})),{mapValue:{fields:t}}}function sx(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Bt||n instanceof Bs||n instanceof es||n instanceof Zt||n instanceof bd||n instanceof $s)}function Xp(n,e,t){if(!sx(t)||!G0(t)){const s=cd(t);throw s==="an object"?e.wc(n+" a custom object"):e.wc(n+" "+s)}}function Yf(n,e,t){if((e=en(e))instanceof Sd)return e._internalPath;if(typeof e=="string")return Zp(n,e);throw nd("Field path arguments must be of type string or ",n,!1,void 0,t)}const zN=new RegExp("[~\\*/\\[\\]]");function Zp(n,e,t){if(e.search(zN)>=0)throw nd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Sd(...e.split("."))._internalPath}catch{throw nd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function nd(n,e,t,s,a){const l=s&&!s.isEmpty(),d=a!==void 0;let f=`Function ${e}() called with invalid data`;t&&(f+=" (via `toFirestore()`)"),f+=". ";let m="";return(l||d)&&(m+=" (found",l&&(m+=` in field ${s}`),d&&(m+=` in document ${a}`),m+=")"),new Fe(fe.INVALID_ARGUMENT,f+n+m)}function ix(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ax{constructor(e,t,s,a,l){this._firestore=e,this._userDataWriter=t,this._key=s,this._document=a,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new Zt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new BN(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Id("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class BN extends ax{data(){return super.data()}}function Id(n,e){return typeof e=="string"?Zp(n,e):e instanceof Sd?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ox(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Fe(fe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class em{}class tm extends em{}function Jf(n,e,...t){let s=[];e instanceof em&&s.push(e),s=s.concat(t),(function(l){const d=l.filter((m=>m instanceof nm)).length,f=l.filter((m=>m instanceof Pd)).length;if(d>1||d>0&&f>0)throw new Fe(fe.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(s);for(const a of s)n=a._apply(n);return n}class Pd extends tm{constructor(e,t,s){super(),this._field=e,this._op=t,this._value=s,this.type="where"}static _create(e,t,s){return new Pd(e,t,s)}_apply(e){const t=this._parse(e);return cx(e._query,t),new xi(e.firestore,e.converter,Uf(e._query,t))}_parse(e){const t=Cd(e.firestore);return(function(l,d,f,m,v,w,T){let C;if(v.isKeyField()){if(w==="array-contains"||w==="array-contains-any")throw new Fe(fe.INVALID_ARGUMENT,`Invalid Query. You can't perform '${w}' queries on documentId().`);if(w==="in"||w==="not-in"){l_(T,w);const X=[];for(const q of T)X.push(o_(m,l,q));C={arrayValue:{values:X}}}else C=o_(m,l,T)}else w!=="in"&&w!=="not-in"&&w!=="array-contains-any"||l_(T,w),C=UN(f,d,T,w==="in"||w==="not-in");return vn.create(v,w,C)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function lx(n,e,t){const s=e,a=Id("where",n);return Pd._create(a,s,t)}class nm extends em{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new nm(e,t)}_parse(e){const t=this._queryConstraints.map((s=>s._parse(e))).filter((s=>s.getFilters().length>0));return t.length===1?t[0]:Ts.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(a,l){let d=a;const f=l.getFlattenedFilters();for(const m of f)cx(d,m),d=Uf(d,m)})(e._query,t),new xi(e.firestore,e.converter,Uf(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class rm extends tm{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new rm(e,t)}_apply(e){const t=(function(a,l,d){if(a.startAt!==null)throw new Fe(fe.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(a.endAt!==null)throw new Fe(fe.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Jl(l,d)})(e._query,this._field,this._direction);return new xi(e.firestore,e.converter,(function(a,l){const d=a.explicitOrderBy.concat([l]);return new Qo(a.path,a.collectionGroup,d,a.filters.slice(),a.limit,a.limitType,a.startAt,a.endAt)})(e._query,t))}}function Xf(n,e="asc"){const t=e,s=Id("orderBy",n);return rm._create(s,t)}class sm extends tm{constructor(e,t,s){super(),this.type=e,this._limit=t,this._limitType=s}static _create(e,t,s){return new sm(e,t,s)}_apply(e){return new xi(e.firestore,e.converter,Qu(e._query,this._limit,this._limitType))}}function $N(n){return sm._create("limit",n,"F")}function o_(n,e,t){if(typeof(t=en(t))=="string"){if(t==="")throw new Fe(fe.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!lw(e)&&t.indexOf("/")!==-1)throw new Fe(fe.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const s=e.path.child(Mt.fromString(t));if(!Xe.isDocumentKey(s))throw new Fe(fe.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return Tv(n,new Xe(s))}if(t instanceof Zt)return Tv(n,t._key);throw new Fe(fe.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${cd(t)}.`)}function l_(n,e){if(!Array.isArray(n)||n.length===0)throw new Fe(fe.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function cx(n,e){const t=(function(a,l){for(const d of a)for(const f of d.getFlattenedFilters())if(l.indexOf(f.op)>=0)return f.op;return null})(n.filters,(function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new Fe(fe.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Fe(fe.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class WN{convertValue(e,t="none"){switch(na(e)){case 0:return null;case 1:return e.booleanValue;case 2:return cn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ta(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw it(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const s={};return ca(e,((a,l)=>{s[a]=this.convertValue(l,t)})),s}convertVectorValue(e){var t,s,a;const l=(a=(s=(t=e.fields)===null||t===void 0?void 0:t[Hu].arrayValue)===null||s===void 0?void 0:s.values)===null||a===void 0?void 0:a.map((d=>cn(d.doubleValue)));return new $s(l)}convertGeoPoint(e){return new Bs(cn(e.latitude),cn(e.longitude))}convertArray(e,t){return(e.values||[]).map((s=>this.convertValue(s,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const s=hd(e);return s==null?null:this.convertValue(s,t);case"estimate":return this.convertTimestamp(Kl(e));default:return null}}convertTimestamp(e){const t=ea(e);return new Bt(t.seconds,t.nanos)}convertDocumentKey(e,t){const s=Mt.fromString(e);At(Rw(s),9688,{name:e});const a=new Ql(s.get(1),s.get(3)),l=new Xe(s.popFirst(5));return a.isEqual(t)||gi(`Document ${l} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ux(n,e,t){let s;return s=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,s}class Dl{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ja extends ax{constructor(e,t,s,a,l,d){super(e,t,s,a,d),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new ku(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const s=this._document.data.field(Id("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Fe(fe.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=ja._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}ja._jsonSchemaVersion="firestore/documentSnapshot/1.0",ja._jsonSchema={type:_n("string",ja._jsonSchemaVersion),bundleSource:_n("string","DocumentSnapshot"),bundleName:_n("string"),bundle:_n("string")};class ku extends ja{data(e={}){return super.data(e)}}class ka{constructor(e,t,s,a){this._firestore=e,this._userDataWriter=t,this._snapshot=a,this.metadata=new Dl(a.hasPendingWrites,a.fromCache),this.query=s}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((s=>{e.call(t,new ku(this._firestore,this._userDataWriter,s.key,s,new Dl(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Fe(fe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(a,l){if(a._snapshot.oldDocs.isEmpty()){let d=0;return a._snapshot.docChanges.map((f=>{const m=new ku(a._firestore,a._userDataWriter,f.doc.key,f.doc,new Dl(a._snapshot.mutatedKeys.has(f.doc.key),a._snapshot.fromCache),a.query.converter);return f.doc,{type:"added",doc:m,oldIndex:-1,newIndex:d++}}))}{let d=a._snapshot.oldDocs;return a._snapshot.docChanges.filter((f=>l||f.type!==3)).map((f=>{const m=new ku(a._firestore,a._userDataWriter,f.doc.key,f.doc,new Dl(a._snapshot.mutatedKeys.has(f.doc.key),a._snapshot.fromCache),a.query.converter);let v=-1,w=-1;return f.type!==0&&(v=d.indexOf(f.doc.key),d=d.delete(f.doc.key)),f.type!==1&&(d=d.add(f.doc),w=d.indexOf(f.doc.key)),{type:GN(f.type),doc:m,oldIndex:v,newIndex:w}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Fe(fe.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ka._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Ep.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],s=[],a=[];return this.docs.forEach((l=>{l._document!==null&&(t.push(l._document),s.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),a.push(l.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function GN(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return it(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nd(n){n=Nr(n,Zt);const e=Nr(n.firestore,vi);return RN(Td(e),n._key).then((t=>dx(e,n,t)))}ka._jsonSchemaVersion="firestore/querySnapshot/1.0",ka._jsonSchema={type:_n("string",ka._jsonSchemaVersion),bundleSource:_n("string","QuerySnapshot"),bundleName:_n("string"),bundle:_n("string")};class im extends WN{constructor(e){super(),this.firestore=e}convertBytes(e){return new es(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Zt(this.firestore,null,t)}}function _s(n){n=Nr(n,xi);const e=Nr(n.firestore,vi),t=Td(e),s=new im(e);return ox(n._query),AN(t,n._query).then((a=>new ka(e,s,n,a)))}function ui(n,e,t){n=Nr(n,Zt);const s=Nr(n.firestore,vi),a=ux(n.converter,e,t);return Rd(s,[nx(Cd(s),"setDoc",n._key,a,n.converter!==null,t).toMutation(n._key,ns.none())])}function ws(n,e,t,...s){n=Nr(n,Zt);const a=Nr(n.firestore,vi),l=Cd(a);let d;return d=typeof(e=en(e))=="string"||e instanceof Sd?FN(l,"updateDoc",n._key,e,t,s):ON(l,"updateDoc",n._key,e),Rd(a,[d.toMutation(n._key,ns.exists(!0))])}function Ra(n){return Rd(Nr(n.firestore,vi),[new Np(n._key,ns.none())])}function Aa(n,e){const t=Nr(n.firestore,vi),s=Dt(n),a=ux(n.converter,e);return Rd(t,[nx(Cd(n.firestore),"addDoc",s._key,a,n.converter!==null,{}).toMutation(s._key,ns.exists(!1))]).then((()=>s))}function c_(n,...e){var t,s,a;n=en(n);let l={includeMetadataChanges:!1,source:"default"},d=0;typeof e[d]!="object"||a_(e[d])||(l=e[d++]);const f={includeMetadataChanges:l.includeMetadataChanges,source:l.source};if(a_(e[d])){const T=e[d];e[d]=(t=T.next)===null||t===void 0?void 0:t.bind(T),e[d+1]=(s=T.error)===null||s===void 0?void 0:s.bind(T),e[d+2]=(a=T.complete)===null||a===void 0?void 0:a.bind(T)}let m,v,w;if(n instanceof Zt)v=Nr(n.firestore,vi),w=fd(n._key.path),m={next:T=>{e[d]&&e[d](dx(v,n,T))},error:e[d+1],complete:e[d+2]};else{const T=Nr(n,xi);v=Nr(T.firestore,vi),w=T._query;const C=new im(v);m={next:U=>{e[d]&&e[d](new ka(v,C,T,U))},error:e[d+1],complete:e[d+2]},ox(n._query)}return(function(C,U,X,q){const F=new Qp(q),ie=new qp(U,F,X);return C.asyncQueue.enqueueAndForget((async()=>$p(await td(C),ie))),()=>{F.Ou(),C.asyncQueue.enqueueAndForget((async()=>Wp(await td(C),ie)))}})(Td(v),w,f,m)}function Rd(n,e){return(function(s,a){const l=new hi;return s.asyncQueue.enqueueAndForget((async()=>vN(await NN(s),a,l))),l.promise})(Td(n),e)}function dx(n,e,t){const s=t.docs.get(e._key),a=new im(n);return new ja(n,a,e._key,s,new Dl(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qN(){return new hc("deleteField")}function Da(){return new Jp("serverTimestamp")}(function(e,t=!0){(function(a){qo=a})($o),jo(new Va("firestore",((s,{instanceIdentifier:a,options:l})=>{const d=s.getProvider("app").getImmediate(),f=new vi(new UC(s.getProvider("auth-internal")),new $C(d,s.getProvider("app-check-internal")),(function(v,w){if(!Object.prototype.hasOwnProperty.apply(v.options,["projectId"]))throw new Fe(fe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ql(v.options.projectId,w)})(d,a),d);return l=Object.assign({useFetchStreams:t},l),f._setSettings(l),f}),"PUBLIC").setMultipleInstances(!0)),Qi(cv,uv,e),Qi(cv,uv,"esm2017")})();const HN={apiKey:"AIzaSyCOOnlmEcAcJywsS93LLfLSywy9ENqnppM",authDomain:"tyler-manga-library.firebaseapp.com",projectId:"tyler-manga-library",storageBucket:"tyler-manga-library.firebasestorage.app",messagingSenderId:"307412068362",appId:"1:307412068362:web:6cfe5666187439dfa757f3"},hx=K_(HN),ts=VC(hx),ot=kN(hx),fx=j.createContext(null);function KN({children:n}){const e="https://discord.com/api/webhooks/1451655828078723156/EA8QhLeiTT-7jOVQ6jFpV2he2zxVpAddAhlu8CiC6RtGFu9wTAOLdRjKeYHIV1OhVbmm",[t,s]=j.useState(null),[a,l]=j.useState(!1),[d,f]=j.useState("viewer"),[m,v]=j.useState(!0),w=async U=>{if(!U)return null;const X=Dt(ot,"users",U.uid);let q=null;try{const ie=await Nd(X);ie.exists()&&(q=ie.data())}catch(ie){console.warn("Failed to read user doc",ie)}const F={role:((q==null?void 0:q.role)||"viewer").toLowerCase()==="admin"?"admin":"viewer",email:U.email||(q==null?void 0:q.email)||"",displayName:U.displayName||(q==null?void 0:q.displayName)||"",createdAt:(q==null?void 0:q.createdAt)||Da()};try{if(await ui(X,F,{merge:!0}),!q&&e)try{const ie=U.displayName||U.email||U.uid;await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:`New signup: ${ie}`})})}catch(ie){console.warn("Failed to send signup webhook",ie)}}catch(ie){console.error("Failed to ensure user doc",ie)}return{...q,...F}};j.useEffect(()=>{const U=Cb(ts,async X=>{if(s(X),X)try{const q=await w(X),F=(q==null?void 0:q.role)||"viewer";f(F),l(F.toLowerCase()==="admin")}catch(q){console.error("Error checking role:",q),l(!1),f("viewer")}else l(!1),f("viewer");v(!1)});return()=>U()},[]);const T=async(U,X)=>{await E0(ts,U,X)},C=async()=>{await T0(ts)};return o.jsx(fx.Provider,{value:{user:t,admin:a,role:d,loading:m,login:T,logout:C},children:n})}function Ba(){return j.useContext(fx)}function QN({onClose:n}){const[e,t]=j.useState("login"),[s,a]=j.useState(""),[l,d]=j.useState("");async function f(){try{await k0(ts,new vs),n()}catch(w){alert(w.message)}}async function m(w){w.preventDefault();try{await E0(ts,s,l),n()}catch(T){alert(T.message)}}async function v(w){w.preventDefault();try{await xb(ts,s,l),n()}catch(T){alert(T.message)}}return o.jsx("div",{className:"auth-modal-backdrop",onClick:n,children:o.jsxs("div",{className:"auth-modal",onClick:w=>w.stopPropagation(),children:[o.jsx("h2",{className:"auth-title",children:e==="login"?"Sign In":"Create Account"}),o.jsxs("button",{className:"google-btn",onClick:f,children:[o.jsx("img",{src:"https://www.svgrepo.com/show/475656/google-color.svg",alt:"",className:"google-icon"}),"Continue with Google"]}),o.jsx("div",{className:"auth-divider",children:o.jsx("span",{children:"or"})}),o.jsxs("form",{onSubmit:e==="login"?m:v,className:"auth-form",children:[o.jsx("input",{type:"email",placeholder:"Email address",className:"auth-input",value:s,onChange:w=>a(w.target.value),required:!0}),o.jsx("input",{type:"password",placeholder:"Password",className:"auth-input",value:l,onChange:w=>d(w.target.value),required:!0}),o.jsx("button",{className:"auth-submit",children:e==="login"?"Sign In":"Create Account"})]}),o.jsx("div",{className:"auth-switcher",children:e==="login"?o.jsxs("p",{children:["No account?"," ",o.jsx("button",{onClick:()=>t("register"),children:"Register"})]}):o.jsxs("p",{children:["Already have an account?"," ",o.jsx("button",{onClick:()=>t("login"),children:"Sign in"})]})}),o.jsx("button",{className:"auth-close",onClick:n,"aria-label":"Close",children:"X"})]})})}var Du={exports:{}},YN=Du.exports,u_;function JN(){return u_||(u_=1,(function(n){(function(e){function t(V,ae){var I=(V&65535)+(ae&65535),P=(V>>16)+(ae>>16)+(I>>16);return P<<16|I&65535}function s(V,ae){return V<<ae|V>>>32-ae}function a(V,ae,I,P,A,M){return t(s(t(t(ae,V),t(P,M)),A),I)}function l(V,ae,I,P,A,M,D){return a(ae&I|~ae&P,V,ae,A,M,D)}function d(V,ae,I,P,A,M,D){return a(ae&P|I&~P,V,ae,A,M,D)}function f(V,ae,I,P,A,M,D){return a(ae^I^P,V,ae,A,M,D)}function m(V,ae,I,P,A,M,D){return a(I^(ae|~P),V,ae,A,M,D)}function v(V,ae){V[ae>>5]|=128<<ae%32,V[(ae+64>>>9<<4)+14]=ae;var I,P,A,M,D,N=1732584193,b=-271733879,J=-1732584194,re=271733878;for(I=0;I<V.length;I+=16)P=N,A=b,M=J,D=re,N=l(N,b,J,re,V[I],7,-680876936),re=l(re,N,b,J,V[I+1],12,-389564586),J=l(J,re,N,b,V[I+2],17,606105819),b=l(b,J,re,N,V[I+3],22,-1044525330),N=l(N,b,J,re,V[I+4],7,-176418897),re=l(re,N,b,J,V[I+5],12,1200080426),J=l(J,re,N,b,V[I+6],17,-1473231341),b=l(b,J,re,N,V[I+7],22,-45705983),N=l(N,b,J,re,V[I+8],7,1770035416),re=l(re,N,b,J,V[I+9],12,-1958414417),J=l(J,re,N,b,V[I+10],17,-42063),b=l(b,J,re,N,V[I+11],22,-1990404162),N=l(N,b,J,re,V[I+12],7,1804603682),re=l(re,N,b,J,V[I+13],12,-40341101),J=l(J,re,N,b,V[I+14],17,-1502002290),b=l(b,J,re,N,V[I+15],22,1236535329),N=d(N,b,J,re,V[I+1],5,-165796510),re=d(re,N,b,J,V[I+6],9,-1069501632),J=d(J,re,N,b,V[I+11],14,643717713),b=d(b,J,re,N,V[I],20,-373897302),N=d(N,b,J,re,V[I+5],5,-701558691),re=d(re,N,b,J,V[I+10],9,38016083),J=d(J,re,N,b,V[I+15],14,-660478335),b=d(b,J,re,N,V[I+4],20,-405537848),N=d(N,b,J,re,V[I+9],5,568446438),re=d(re,N,b,J,V[I+14],9,-1019803690),J=d(J,re,N,b,V[I+3],14,-187363961),b=d(b,J,re,N,V[I+8],20,1163531501),N=d(N,b,J,re,V[I+13],5,-1444681467),re=d(re,N,b,J,V[I+2],9,-51403784),J=d(J,re,N,b,V[I+7],14,1735328473),b=d(b,J,re,N,V[I+12],20,-1926607734),N=f(N,b,J,re,V[I+5],4,-378558),re=f(re,N,b,J,V[I+8],11,-2022574463),J=f(J,re,N,b,V[I+11],16,1839030562),b=f(b,J,re,N,V[I+14],23,-35309556),N=f(N,b,J,re,V[I+1],4,-1530992060),re=f(re,N,b,J,V[I+4],11,1272893353),J=f(J,re,N,b,V[I+7],16,-155497632),b=f(b,J,re,N,V[I+10],23,-1094730640),N=f(N,b,J,re,V[I+13],4,681279174),re=f(re,N,b,J,V[I],11,-358537222),J=f(J,re,N,b,V[I+3],16,-722521979),b=f(b,J,re,N,V[I+6],23,76029189),N=f(N,b,J,re,V[I+9],4,-640364487),re=f(re,N,b,J,V[I+12],11,-421815835),J=f(J,re,N,b,V[I+15],16,530742520),b=f(b,J,re,N,V[I+2],23,-995338651),N=m(N,b,J,re,V[I],6,-198630844),re=m(re,N,b,J,V[I+7],10,1126891415),J=m(J,re,N,b,V[I+14],15,-1416354905),b=m(b,J,re,N,V[I+5],21,-57434055),N=m(N,b,J,re,V[I+12],6,1700485571),re=m(re,N,b,J,V[I+3],10,-1894986606),J=m(J,re,N,b,V[I+10],15,-1051523),b=m(b,J,re,N,V[I+1],21,-2054922799),N=m(N,b,J,re,V[I+8],6,1873313359),re=m(re,N,b,J,V[I+15],10,-30611744),J=m(J,re,N,b,V[I+6],15,-1560198380),b=m(b,J,re,N,V[I+13],21,1309151649),N=m(N,b,J,re,V[I+4],6,-145523070),re=m(re,N,b,J,V[I+11],10,-1120210379),J=m(J,re,N,b,V[I+2],15,718787259),b=m(b,J,re,N,V[I+9],21,-343485551),N=t(N,P),b=t(b,A),J=t(J,M),re=t(re,D);return[N,b,J,re]}function w(V){var ae,I="",P=V.length*32;for(ae=0;ae<P;ae+=8)I+=String.fromCharCode(V[ae>>5]>>>ae%32&255);return I}function T(V){var ae,I=[];for(I[(V.length>>2)-1]=void 0,ae=0;ae<I.length;ae+=1)I[ae]=0;var P=V.length*8;for(ae=0;ae<P;ae+=8)I[ae>>5]|=(V.charCodeAt(ae/8)&255)<<ae%32;return I}function C(V){return w(v(T(V),V.length*8))}function U(V,ae){var I,P=T(V),A=[],M=[],D;for(A[15]=M[15]=void 0,P.length>16&&(P=v(P,V.length*8)),I=0;I<16;I+=1)A[I]=P[I]^909522486,M[I]=P[I]^1549556828;return D=v(A.concat(T(ae)),512+ae.length*8),w(v(M.concat(D),640))}function X(V){var ae="0123456789abcdef",I="",P,A;for(A=0;A<V.length;A+=1)P=V.charCodeAt(A),I+=ae.charAt(P>>>4&15)+ae.charAt(P&15);return I}function q(V){return unescape(encodeURIComponent(V))}function F(V){return C(q(V))}function ie(V){return X(F(V))}function Se(V,ae){return U(q(V),q(ae))}function Ee(V,ae){return X(Se(V,ae))}function we(V,ae,I){return ae?I?Se(ae,V):Ee(ae,V):I?F(V):ie(V)}n.exports?n.exports=we:e.md5=we})(YN)})(Du)),Du.exports}var XN=JN();const ZN=Zf(XN);function eR(){var Oe,Qe,st;const n="google.com",e="oidc.discord",[t,s]=j.useState(!1),[a,l]=j.useState(!1),[d,f]=j.useState(!1),[m,v]=j.useState(!1),[w,T]=j.useState(""),[C,U]=j.useState(""),[X,q]=j.useState(""),[F,ie]=j.useState({google:!1,discord:!1}),[Se,Ee]=j.useState(""),[we,V]=j.useState(!1),[ae,I]=j.useState(!1),[P,A]=j.useState(null),M=j.useRef(null),{user:D,admin:N,role:b}=Ba(),J=tc();j.useEffect(()=>{var ve;f(!1),v(!1),U(""),q(""),I(!1),T((D==null?void 0:D.displayName)||((ve=D==null?void 0:D.email)==null?void 0:ve.split("@")[0])||"")},[D]),j.useEffect(()=>{const ve=((D==null?void 0:D.email)||"").trim().toLowerCase();if(!ve){Ee("");return}const ue=ZN(ve),Ve=Date.now();Ee(`https://www.gravatar.com/avatar/${ue}?s=160&d=identicon&r=g&cb=${Ve}`)},[D==null?void 0:D.email]),j.useEffect(()=>{let ve=!1;const ue=async()=>{var me;try{const He=Jf(Cn(ot,"blogPosts"),lx("status","==","published"),Xf("publishedAt","desc"),$N(1)),Ye=await _s(He);if(ve)return;if(Ye.empty){A(null);return}const Tt=Ye.docs[0],Ct=Tt.data(),gt=(me=Ct.publishedAt)!=null&&me.toDate?Ct.publishedAt.toDate():null;if(!gt){A(null);return}const Nt=Ct.title||"New blog post",Yt=gt.toISOString().slice(0,10),tn=`blog-alert-${Tt.id}-${Yt}`;if(!(Date.now()-gt.getTime()<=1440*60*1e3)){A(null);return}if(typeof localStorage<"u"&&localStorage.getItem(tn)==="dismissed")return;A({id:Tt.id,title:Nt,alertKey:tn,publishedAt:gt})}catch(He){(He==null?void 0:He.code)!=="permission-denied"&&console.error("Failed to load blog alert",He)}};ue();const Ve=setInterval(ue,6e4);return()=>{ve=!0,clearInterval(Ve)}},[]);const re=ve=>{P!=null&&P.alertKey&&typeof localStorage<"u"&&localStorage.setItem(P.alertKey,"dismissed"),A(null),J(ve?`/blog?post=${ve}`:"/blog")},Ce=ve=>{ve!=null&&ve.stopPropagation&&ve.stopPropagation(),P!=null&&P.alertKey&&typeof localStorage<"u"&&localStorage.setItem(P.alertKey,"dismissed"),A(null)};async function de(){try{await T0(ts),s(!1),f(!1),J("/")}catch(ve){console.error(ve),alert("Logout failed.")}}const ce=()=>{if(!D){s(!1),l(!0);return}f(!1),U(""),q(""),I(!1),v(!0)},Ne=async()=>{if(!D){s(!1),l(!0);return}const ve=(w||"").trim();if(!ve){U("Display name is required.");return}V(!0),U(""),I(!1);try{await Tb(ts.currentUser,{displayName:ve}),await ui(Dt(ot,"users",D.uid),{displayName:ve},{merge:!0}),U("Profile updated."),I(!1)}catch(ue){console.error("Failed to update profile",ue),U("Failed to update profile.")}finally{V(!1)}},_e=ve=>{var ue;return!!((ue=D==null?void 0:D.providerData)!=null&&ue.some(Ve=>Ve.providerId===ve))},Y=async()=>{if(!D){s(!1),l(!0);return}if(_e(n)){q("Google is already connected.");return}ie(ve=>({...ve,google:!0})),q("");try{const ve=new vs,ue=await ev(ts.currentUser,ve);await ui(Dt(ot,"users",D.uid),{connections:{[n]:{email:ue.user.email||"",connectedAt:Da()}}},{merge:!0}),q("Google connected.")}catch(ve){console.error("Failed to link Google",ve);const ue=(ve==null?void 0:ve.code)==="auth/credential-already-in-use"?"That Google account is already linked elsewhere. Sign in with it instead.":"Could not connect Google.";q(ue)}finally{ie(ve=>({...ve,google:!1}))}},k=async()=>{if(!D){s(!1),l(!0);return}if(_e(e)){q("Discord is already connected.");return}ie(ve=>({...ve,discord:!0})),q("");try{const ve=new Ml(e);ve.addScope("identify"),ve.addScope("email");const Ve=(await ev(ts.currentUser,ve)).user.providerData.find(me=>me.providerId===e);await ui(Dt(ot,"users",D.uid),{connections:{[e]:{username:(Ve==null?void 0:Ve.displayName)||(Ve==null?void 0:Ve.uid)||"Discord",email:(Ve==null?void 0:Ve.email)||"",connectedAt:Da()}}},{merge:!0}),q("Discord connected.")}catch(ve){console.error("Failed to link Discord",ve);const ue=(ve==null?void 0:ve.code)==="auth/credential-already-in-use"?"That Discord account is already linked elsewhere. Sign in with it instead.":"Could not connect Discord.";q(ue)}finally{ie(ve=>({...ve,discord:!1}))}},H=async ve=>{if(!D)return;if(D.providerData.length<=1){q("You need at least one sign-in method.");return}const ue=ve===n?"google":"discord";q(""),ie(Ve=>({...Ve,[ue]:!0}));try{await gb(ts.currentUser,ve),await ui(Dt(ot,"users",D.uid),{connections:{[ve]:qN()}},{merge:!0}),q("Connection removed.")}catch(Ve){console.error("Failed to unlink",Ve),q("Could not remove connection.")}finally{ie(Ve=>({...Ve,[ue]:!1}))}},Te=D?(((Oe=D.displayName)==null?void 0:Oe[0])||((Qe=D.email)==null?void 0:Qe[0])||((st=D.uid)==null?void 0:st[0])||"?").toUpperCase():"?",De=(D==null?void 0:D.displayName)||(D==null?void 0:D.email)||"Guest",ke=D?N?"admin":b||"viewer":"Not signed in";return o.jsxs(o.Fragment,{children:[P&&o.jsxs("div",{className:"blog-alert-banner",onClick:()=>re(P.id),role:"button",tabIndex:0,onKeyDown:ve=>{(ve.key==="Enter"||ve.key===" ")&&(ve.preventDefault(),re(P.id))},children:[o.jsx("div",{className:"blog-alert-dot"}),o.jsxs("div",{className:"blog-alert-text",children:["New blog post today: ",o.jsx("strong",{children:P.title})]}),o.jsxs("div",{className:"blog-alert-actions",children:[o.jsx("button",{type:"button",className:"blog-alert-btn",onClick:ve=>{ve.stopPropagation(),re(P.id)},children:"Read now"}),o.jsx("button",{type:"button",className:"blog-alert-dismiss",onClick:Ce,children:"Dismiss"})]})]}),o.jsxs("button",{className:`menu-toggle ${t?"active":""}`,onClick:()=>s(!t),children:[o.jsx("span",{}),o.jsx("span",{}),o.jsx("span",{})]}),o.jsxs("nav",{className:`menu-panel ${t?"open":""}`,onMouseLeave:()=>f(!1),children:[o.jsx(Oi,{to:"/",className:"menu-item",onClick:()=>s(!1),children:"Home"}),o.jsx(Oi,{to:"/manga",className:"menu-item",onClick:()=>s(!1),children:"Manga"}),o.jsx(Oi,{to:"/anime",className:"menu-item",onClick:()=>s(!1),children:"Anime"}),o.jsx(Oi,{to:"/tcg",className:"menu-item",onClick:()=>s(!1),children:"TCG"}),o.jsx(Oi,{to:"/music",className:"menu-item",onClick:()=>s(!1),children:"Music"}),o.jsx(Oi,{to:"/steam",className:"menu-item",onClick:()=>s(!1),children:"Gaming"}),N&&o.jsx(Oi,{to:"/blog",className:"menu-item",onClick:()=>s(!1),children:"Blog"}),N&&o.jsx(Oi,{to:"/dashboard",className:"menu-item",onClick:()=>s(!1),children:"Dashboard"}),o.jsxs("div",{className:"menu-footer",children:[o.jsx("div",{className:"profile-divider"}),o.jsxs("div",{className:"profile-card",onMouseEnter:()=>D&&f(!0),onMouseLeave:()=>f(!1),onClick:()=>{D?f(ve=>!ve):(f(!1),s(!1),l(!0))},role:"button",tabIndex:0,onKeyDown:ve=>{(ve.key==="Enter"||ve.key===" ")&&(ve.preventDefault(),D?f(ue=>!ue):(s(!1),l(!0)))},children:[o.jsx("div",{className:"profile-avatar",children:Se?o.jsx("img",{src:Se,alt:`${De} avatar`,onError:()=>Ee("")}):Te}),o.jsxs("div",{className:"profile-meta",children:[o.jsx("div",{className:"profile-name",children:De}),o.jsx("div",{className:"profile-role",children:ke})]}),D&&d&&o.jsxs("div",{className:"profile-menu",children:[o.jsx("button",{type:"button",className:"profile-menu-item",onClick:ce,children:"Edit profile"}),o.jsx("button",{type:"button",className:"profile-menu-item",onClick:de,children:"Sign out"})]})]})]})]}),a&&o.jsx(QN,{onClose:()=>l(!1)}),m&&o.jsx("div",{className:"profile-edit-backdrop",children:o.jsxs("div",{className:"profile-edit-card",children:[o.jsxs("div",{className:"profile-edit-header",children:[o.jsx("h3",{children:"Edit profile"}),o.jsx("button",{type:"button",className:"profile-edit-close",onClick:()=>{v(!1),U(""),q(""),I(!1)},children:""})]}),o.jsxs("div",{className:"profile-edit-body",children:[o.jsxs("a",{className:"profile-edit-avatar clickable",href:"https://gravatar.com/profile",target:"_blank",rel:"noreferrer",title:"Manage your picture on Gravatar (opens in new tab)",children:[Se?o.jsx("img",{src:Se,alt:`${De} avatar`,onError:()=>Ee("")}):Te,o.jsx("span",{className:"profile-avatar-hover-hint",children:"Change on Gravatar"})]}),o.jsxs("div",{className:"profile-edit-field",children:[o.jsx("label",{className:"profile-edit-label",htmlFor:"displayName",children:"Display name"}),o.jsxs("div",{className:"profile-edit-input-row",children:[o.jsx("input",{id:"displayName",className:"profile-edit-input",type:"text",readOnly:!ae,value:w,onChange:ve=>T(ve.target.value),maxLength:40,placeholder:"Enter display name",ref:M,onBlur:()=>{ae&&Ne()},onKeyDown:ve=>{ve.key==="Enter"&&ae&&(ve.preventDefault(),Ne())}}),o.jsx("button",{type:"button",className:"profile-edit-pencil",onClick:()=>{I(!0),U(""),setTimeout(()=>{var ve;return(ve=M.current)==null?void 0:ve.focus()},50)},"aria-label":"Edit display name",children:""})]}),o.jsx("div",{className:"profile-edit-hint",children:"Click the pencil to edit. Changes save on blur or Enter."})]})]}),o.jsxs("div",{className:"profile-connections",children:[o.jsxs("div",{className:"profile-connections-header",children:[o.jsx("span",{children:"Connections"}),X&&o.jsx("span",{className:"profile-connection-status",children:X})]}),o.jsxs("div",{className:"profile-connection-row",children:[o.jsxs("div",{className:"profile-connection-meta",children:[o.jsx("div",{className:"profile-connection-title",children:"Google"}),o.jsx("div",{className:"profile-connection-sub",children:_e(n)?"Connected":"Not connected"})]}),o.jsx("div",{className:"profile-connection-actions",children:_e(n)?o.jsx("button",{type:"button",className:"profile-connection-btn secondary",onClick:()=>H(n),disabled:F.google,children:F.google?"Removing...":"Remove"}):o.jsx("button",{type:"button",className:"profile-connection-btn",onClick:Y,disabled:F.google,children:F.google?"Connecting...":"Connect"})})]}),o.jsxs("div",{className:"profile-connection-row",children:[o.jsxs("div",{className:"profile-connection-meta",children:[o.jsx("div",{className:"profile-connection-title",children:"Discord"}),o.jsx("div",{className:"profile-connection-sub",children:_e(e)?"Connected":"Not connected"})]}),o.jsx("div",{className:"profile-connection-actions",children:_e(e)?o.jsx("button",{type:"button",className:"profile-connection-btn secondary",onClick:()=>H(e),disabled:F.discord,children:F.discord?"Removing...":"Remove"}):o.jsx("button",{type:"button",className:"profile-connection-btn",onClick:k,disabled:F.discord,children:F.discord?"Connecting...":"Connect"})})]})]}),C&&o.jsx("div",{className:"profile-edit-status",children:C}),we&&o.jsx("div",{className:"profile-edit-status saving",children:"Saving..."}),o.jsx("div",{className:"profile-gravatar-note",children:"Profile pictures are managed through Gravatarclick the avatar to update."})]})})]})}function d_(){const n="Tyler's Collection's and Hobbies",e="",[t,s]=j.useState(""),[a,l]=j.useState(!0),d=j.useRef(null),[f,m]=j.useState("jp"),[v,w]=j.useState(1);return j.useEffect(()=>{document.title="Tyler's Collection"},[]),j.useEffect(()=>(d.current=setInterval(()=>l(T=>!T),450),()=>{d.current&&clearInterval(d.current)}),[]),j.useEffect(()=>{let T=!1;const C=q=>new Promise(F=>setTimeout(F,q)),U=async(q,F=120)=>{for(let ie=1;ie<=q.length;ie+=1){if(T)return;s(q.slice(0,ie)),await C(F)}},X=async(q,F=70)=>{for(let ie=q.length;ie>=0;ie-=1){if(T)return;s(q.slice(0,ie)),await C(F)}};return(async()=>{if(localStorage.getItem("homeTitleTyped")==="1"){m("en"),s(n),l(!1),d.current&&clearInterval(d.current);return}await C(250),m("jp"),await U(e,140),await C(6e3),await X(e,80),await C(320);const F=n;for(let ie=1;ie<=F.length;ie+=1){if(T)return;s(F.slice(0,ie)),ie===4&&m("en"),await C(110)}m("en"),await C(2e3),l(!1),localStorage.setItem("homeTitleTyped","1"),d.current&&clearInterval(d.current)})(),()=>{T=!0}},[]),o.jsxs("main",{className:"page",children:[o.jsxs("header",{style:{textAlign:"center",marginTop:"32px",marginBottom:"24px"},children:[o.jsxs("h1",{style:{margin:0,fontSize:"2.2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",display:"inline-flex",alignItems:"center",gap:"6px"},children:[o.jsx("span",{children:t||" "}),o.jsx("span",{style:{width:"6px",height:"1.1em",background:"#ffb6c1",opacity:a?1:0,transition:"opacity 0.15s ease"}})]}),o.jsx("p",{style:{margin:"6px 0 0",color:"var(--text-soft)",fontSize:"0.95rem",opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"TCG":"This is my personal webpage to see what is on my shelves, wishlists, and TCG collections."}),o.jsx("div",{style:{display:"inline-flex",alignItems:"center",gap:"10px",padding:"8px 14px",borderRadius:"999px",border:"1px solid rgba(255,182,193,0.5)",background:"linear-gradient(135deg, rgba(255,182,193,0.18), rgba(43,15,29,0.9))",boxShadow:"0 8px 24px rgba(0,0,0,0.55)",marginTop:"14px",fontSize:"0.78rem",color:"#ffe6ed",letterSpacing:"0.05em",textTransform:"uppercase",fontWeight:700,opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?o.jsx("span",{style:{letterSpacing:"0.06em"},children:"          TCG"}):o.jsx("span",{style:{letterSpacing:"0.06em"},children:" Manga   Anime   Music   TCG"})})]}),o.jsxs("section",{style:{display:"grid",gridTemplateColumns:"minmax(0, 2fr) minmax(0, 3fr)",gap:"20px",marginTop:"24px"},children:[o.jsxs("article",{className:"card",children:[o.jsx("h2",{style:{marginTop:0,marginBottom:"8px",fontSize:"1.2rem",color:"#ffb6c1"},children:o.jsx("span",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"About Me"})}),o.jsx("p",{style:{margin:0,color:"var(--text-soft)",fontSize:"0.9rem",lineHeight:1.5,opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"im.okTCG":"Hey, I am Tyler and I go by im.ok. I hoard manga, binge anime, and collect trading cards."}),o.jsx("p",{style:{marginTop:"10px",color:"var(--text-soft)",fontSize:"0.9rem",opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"TCG":"This site is where I track everything: volumes on my shelves, finished shows, and my TCG collection as they all slowly grow."}),o.jsxs("div",{style:{marginTop:"12px",display:"flex",flexWrap:"wrap",gap:"6px",opacity:v,transition:"opacity 0.25s ease"},children:[o.jsx("span",{className:"pill",children:f==="jp"?"":"Manga library"}),o.jsx("span",{className:"pill",children:f==="jp"?"":"My Anime List (MAL)"}),o.jsx("span",{className:"pill",children:f==="jp"?" & TCG":"Pokemon & One Piece TCG"}),o.jsx("span",{className:"pill",children:f==="jp"?"":"Data Nerd"})]})]}),o.jsxs("article",{className:"card",children:[o.jsx("h2",{style:{marginTop:0,marginBottom:"8px",fontSize:"1.2rem",color:"#ffb6c1"},children:o.jsx("span",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Explore these pages"})}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(210px, 1fr))",gap:"14px",marginTop:"10px"},children:[o.jsxs("a",{href:"/base/manga",className:"section-card",children:[o.jsx("h3",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Manga Library"}),o.jsx("p",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Full manga collection & wishlist."}),o.jsx("div",{className:"section-chip-row",children:o.jsx("span",{className:"section-chip accent",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Library & wishlist"})})]}),o.jsxs("a",{href:"/base/music",className:"section-card",style:{justifySelf:"end",alignSelf:"end",order:99},children:[o.jsx("h3",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Music"}),o.jsx("p",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"If you are here for my music, this is the page for you! Catch all the latest releases."}),o.jsxs("div",{className:"section-chip-row",children:[o.jsx("span",{className:"section-chip accent",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Latest tracks"}),o.jsx("span",{className:"section-chip",style:{opacity:v,transition:"opacity 0.25s ease"},children:"Spotify & SoundCloud"})]})]}),o.jsxs("a",{href:"/base/anime",className:"section-card",children:[o.jsx("h3",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Anime Library"}),o.jsx("p",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"MAL":"The entire watched, plan to watch, and watching list synced directly from MyAnimeList."}),o.jsxs("div",{className:"section-chip-row",children:[o.jsx("span",{className:"section-chip accent",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"MAL":"MAL synced"}),o.jsx("span",{className:"section-chip",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Status filters"}),o.jsx("span",{className:"section-chip",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Quick stats"})]})]}),o.jsxs("a",{href:"/base/tcg",className:"section-card",children:[o.jsx("h3",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"TCG":"TCG Collection"}),o.jsx("p",{style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"TCG":"Pokemon & One Piece TCG cards tracked with quantities, prices, and value."}),o.jsxs("div",{className:"section-chip-row",children:[o.jsx("span",{className:"section-chip accent",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Full Collection"}),o.jsx("span",{className:"section-chip",style:{opacity:v,transition:"opacity 0.25s ease"},children:f==="jp"?"":"Still Under-Construction"})]})]})]})]})]}),o.jsx("footer",{style:{marginTop:"28px",fontSize:"0.78rem",color:"var(--text-soft)",textAlign:"center"},children:"@ 2025 im.ok. All rights reserved."})]})}const tR="modulepreload",nR=function(n){return"/base/"+n},h_={},pc=function(e,t,s){let a=Promise.resolve();if(t&&t.length>0){let d=function(v){return Promise.all(v.map(w=>Promise.resolve(w).then(T=>({status:"fulfilled",value:T}),T=>({status:"rejected",reason:T}))))};document.getElementsByTagName("link");const f=document.querySelector("meta[property=csp-nonce]"),m=(f==null?void 0:f.nonce)||(f==null?void 0:f.getAttribute("nonce"));a=d(t.map(v=>{if(v=nR(v),v in h_)return;h_[v]=!0;const w=v.endsWith(".css"),T=w?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${v}"]${T}`))return;const C=document.createElement("link");if(C.rel=w?"stylesheet":tR,w||(C.as="script"),C.crossOrigin="",C.href=v,m&&C.setAttribute("nonce",m),document.head.appendChild(C),w)return new Promise((U,X)=>{C.addEventListener("load",U),C.addEventListener("error",()=>X(new Error(`Unable to preload CSS for ${v}`)))})}))}function l(d){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=d,window.dispatchEvent(f),!f.defaultPrevented)throw d}return a.then(d=>{for(const f of d||[])f.status==="rejected"&&l(f.reason);return e().catch(l)})};function px({open:n,title:e,placeholder:t,value:s,status:a,loading:l,onChange:d,onSubmit:f,onClose:m}){if(!n)return null;const v=typeof a=="string"&&a.toLowerCase().startsWith("sent!")?"#a3f0cf":"#ffb6c1";return o.jsx("div",{className:"suggestion-backdrop",onClick:w=>{w.target===w.currentTarget&&m&&m()},children:o.jsxs("div",{className:"suggestion-modal",children:[o.jsxs("div",{className:"suggestion-modal-header",children:[o.jsx("h3",{children:e}),o.jsx("button",{className:"suggestion-close",type:"button",onClick:m,"aria-label":"Close",children:"X"})]}),o.jsx("p",{className:"suggestion-hint",children:"Tell me what to add next. Titles only is fine, but extra notes are welcome."}),o.jsx("textarea",{className:"suggestion-textarea",placeholder:t,value:s,onChange:w=>d==null?void 0:d(w.target.value),maxLength:500}),a&&o.jsx("div",{className:"suggestion-status",style:{color:v},children:a}),o.jsxs("div",{className:"suggestion-actions",children:[o.jsx("button",{className:"suggestion-send",type:"button",onClick:f,disabled:l,children:l?"Sending...":"Send Suggestion"}),o.jsx("button",{className:"suggestion-cancel",type:"button",onClick:m,children:"Cancel"})]})]})})}const am="mangaLibraryActivityLog",Pa="https://discord.com/api/webhooks/1448329790942613667/wsC8psNZ-Ax2D1O9Gl4sJi6ay7df2cr7IrIdxMPwGZTBnkSUIY2NDpeVd98qW_4plz82";let xo=null;function rR(n){return Array.isArray(n)?n.map(e=>({message:e.message,ts:e.ts?new Date(e.ts):new Date,user:e.user||e.email||"",context:e.context||"",details:Array.isArray(e.details)?e.details:[]})).filter(e=>e.message):[]}function sR(){if(typeof window>"u")return[];try{const n=localStorage.getItem(am);if(!n)return[];const e=JSON.parse(n);return rR(e)}catch(n){return console.warn("Failed to read activity log",n),[]}}function mx(n){try{const e=(n||[]).slice(0,100).map(t=>({message:t.message,ts:t.ts instanceof Date?t.ts.toISOString():t.ts,user:t.user||"",context:t.context||"",details:t.details||[]}));typeof window<"u"&&localStorage.setItem(am,JSON.stringify(e))}catch(e){console.warn("Failed to persist activity log",e)}}async function iR(){if(xo)return xo;try{const n=Dt(ot,"settings","webhooks"),e=await Nd(n);if(e.exists())return xo=e.data().activity||Pa,xo}catch(n){console.warn("Failed to load activity webhook",n)}return xo=Pa,xo}function f_(n){if(n==null)return"";if(typeof n=="object")try{return JSON.stringify(n)}catch{return String(n)}return String(n)}function aR(n){return n?typeof n=="string"?[n]:Array.isArray(n)?n.map(e=>f_(e)):typeof n=="object"?Object.entries(n).map(([e,t])=>`${e}: ${f_(t)}`):[]:[]}async function oR(n,e={}){if(n)try{const{email:t,name:s,webhookOverride:a,context:l,list:d,action:f,detailLines:m=[]}=e,v=a||await iR();if(!v)return;const w=(s||"").trim()||t||"anonymous",T=new Date,C=Intl.DateTimeFormat().resolvedOptions().timeZone||"local time",U=[];U.push(" **Library Activity**"),U.push(` ${n}`),U.push(` ${w}       ${T.toLocaleString()} (${C})`);const X=[];l&&X.push(`Context: ${l}`),d&&X.push(`List: ${d}`),f&&X.push(`Action: ${f}`),X.length&&U.push(X.join("      ")),m.length&&(U.push(" Details:"),m.forEach(q=>U.push(` ${q}`))),await fetch(v,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:U.join(`
`)})})}catch(t){console.warn("Activity webhook failed",t)}}async function gx(n,e={}){if(!n)return null;const{email:t,name:s,webhookOverride:a,persistLocal:l=!0,context:d="",list:f="",action:m="",details:v=null}=e,w=aR(v),T={message:n,ts:new Date,user:(s||"").trim()||t||"",context:d,details:w};if(l){const C=sR(),U=[T,...C].slice(0,100);mx(U)}return await oR(n,{email:t,name:s,webhookOverride:a,context:d,list:f,action:m,detailLines:w}),T}const p_=5,lR=3600*1e3,m_="mangaSuggestionsSent",g_="mangaViewMode";function kt(n){let e=(n||"").trim();const t=e.match(/^(.*?)(?:,?\s*(?:Vol\.|Volume)\s*(\d+)(?:\s*[--]\s*\d+)?\s*)?(?:\s*\([^)]*\))?$/i),s=t?t[1].trim().toLowerCase():e.toLowerCase(),a=t&&t[2]?parseInt(t[2],10):0;return{name:s,vol:Number.isFinite(a)?a:0}}function cR(n){if(typeof n=="number")return n;if(n==null||n==="")return 0;const e=parseInt(n,10);return Number.isFinite(e)?e:0}function y_(){const n=new Date,e=n.getFullYear(),t=String(n.getMonth()+1).padStart(2,"0"),s=String(n.getDate()).padStart(2,"0");return`${e}-${t}-${s}`}function Eo(n){const e=(n==null?void 0:n.pageCount)??(n==null?void 0:n.PageCount)??"",t=String(e??"").trim();if(!t)return!0;const s=cR(t);return!Number.isFinite(s)||s<=0}function qt(n,e=!1){const t=(n??"").toString().trim();return!t||!e&&t.toLowerCase()==="unknown"}function Eu(n,e={}){const t=e.includeIsbn??!1,s=e.includeFinance??!1,a=((n==null?void 0:n.specialType)||"").toLowerCase()==="collectible"||((n==null?void 0:n.SpecialType)||"").toLowerCase()==="collectible",l=qt(n==null?void 0:n.authors),d=qt(n==null?void 0:n.publisher),f=qt(n==null?void 0:n.date),m=t?qt(n==null?void 0:n.isbn):!1,v=s&&!a?qt(n==null?void 0:n.amountPaid):!1,w=s&&a?qt(n==null?void 0:n.collectiblePrice):!1,T=s?qt((n==null?void 0:n.msrp)??(n==null?void 0:n.MSRP)):!1,C=s?qt(n==null?void 0:n.datePurchased):!1;return{authorMissing:l,publisherMissing:d,dateMissing:f,isbnMissing:m,amountMissing:v,collectibleMissing:w,msrpMissing:T,purchaseMissing:C,any:l||d||f||m||v||w||T||C}}function Cr(n){if(!n)return"";const e=String(n).trim();if(/^\d{4}-\d{2}-\d{2}$/.test(e))return e;const t=new Date(e);if(Number.isNaN(t.getTime()))return"";const s=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),l=String(t.getDate()).padStart(2,"0");return`${s}-${a}-${l}`}const uR=(n,e)=>{const t=kt(n.title||""),s=kt(e.title||""),a=t.name.localeCompare(s.name);return a!==0?a:t.vol-s.vol};function dR(n){const t=(n||"").match(/vol(?:ume)?\.?\s*(\d+)(?:\s*[-]\s*(\d+))?/i);if(!t)return[];const s=parseInt(t[1],10),a=t[2]?parseInt(t[2],10):s;if(!Number.isFinite(s))return[];const l=Number.isFinite(a)&&a>=s?a:s,d=[];for(let f=s;f<=l;f+=1)d.push(f);return d}function hR(){const{admin:n,user:e,role:t}=Ba(),s=n,a=(x,z={})=>{x&&gx(x,{email:(e==null?void 0:e.email)||"anonymous",name:(e==null?void 0:e.displayName)||"",context:"Manga",...z})},[l,d]=j.useState("library"),[f,m]=j.useState(()=>typeof window>"u"?"series":localStorage.getItem(g_)==="individual"?"individual":"series");j.useEffect(()=>{ve("")},[e]),j.useEffect(()=>{try{localStorage.setItem(g_,f)}catch(x){console.warn("Failed to persist manga view mode",x)}},[f]);const v=async()=>{const x=Date.now(),$=(()=>{try{const O=localStorage.getItem(m_);return Array.isArray(JSON.parse(O))?JSON.parse(O):[]}catch{return[]}})().filter(O=>x-O<lR);if($.length>=p_){ve("Rate limit: please wait a bit (max 5 suggestions per hour).");return}if(!Oe.trim()){ve("Please enter a manga title or note before sending.");return}Ve(!0),ve("");try{const O=`**Manga Suggestion**
${Oe.trim()}
From: ${(e==null?void 0:e.displayName)||(e==null?void 0:e.email)||(e==null?void 0:e.uid)||"anonymous user"}`;await Aa(Cn(ot,"suggestions"),{content:Oe.trim(),type:"manga",from:(e==null?void 0:e.displayName)||(e==null?void 0:e.email)||(e==null?void 0:e.uid)||"anonymous user",createdAt:new Date().toISOString()}),ve("Sent! I'll review your suggestion soon."),Qe("");const W=[...$,x].slice(-p_);localStorage.setItem(m_,JSON.stringify(W))}catch(O){console.error("Failed to send suggestion",O),ve("Failed to send suggestion. Please try again later.")}finally{Ve(!1)}},[w,T]=j.useState([]),[C,U]=j.useState([]),[X,q]=j.useState([]),[F,ie]=j.useState([]),[Se,Ee]=j.useState(!1),[we,V]=j.useState(!0),[ae,I]=j.useState(""),[P,A]=j.useState(""),[M,D]=j.useState(""),[N,b]=j.useState(!1),[J,re]=j.useState(()=>new Set);j.useEffect(()=>{f==="series"&&N&&(typeof Ye>"u"||Ye===null)&&(b(!1),re(new Set))},[f,N]);const[Ce,de]=j.useState({open:!1,mode:"add",list:"library",data:{title:"",authors:"",publisher:"",demographic:"",genre:"",subGenre:"",date:"",cover:"",isbn:"",pageCount:"",rating:"",amountPaid:"",dateRead:"",datePurchased:"",msrp:"",special:!1,specialType:"",specialVolumes:"",collectiblePrice:"",amazonURL:"",read:!1},editingId:null,multiAdd:!1,startVol:"",endVol:""}),[ce,Ne]=j.useState([]),[_e,Y]=j.useState(0),k=j.useMemo(()=>{const x=Ce.list==="library",z=x&&Ce.data.special&&Ce.data.specialType==="collectible",$=x&&!z;return{author:qt(Ce.data.authors),publisher:qt(Ce.data.publisher),date:qt(Ce.data.date),purchaseDate:x?qt(Ce.data.datePurchased):!1,page:Eo({pageCount:Ce.data.pageCount}),isbn:x?qt(Ce.data.isbn):!1,amountPaid:$?qt(Ce.data.amountPaid):!1,collectiblePrice:z?qt(Ce.data.collectiblePrice):!1,msrp:x?qt(Ce.data.msrp):!1}},[Ce.data,Ce.list]),[H,Te]=j.useState({open:!1,index:0,items:[]}),[De,ke]=j.useState(!1),[Oe,Qe]=j.useState(""),[st,ve]=j.useState(""),[ue,Ve]=j.useState(!1),[me,He]=j.useState(null),[Ye,Tt]=j.useState(null);j.useEffect(()=>{const x="Manga | Library";if(!s){document.title=x;return}const z=[...w,...C].reduce(($,O)=>{const W=Eo(O),pe=Eu(O,{includeIsbn:O.kind==="library",includeFinance:O.kind==="library"});return $+(W||pe.any?1:0)},0);document.title=z>0?`(${z}) ${x}`:x},[s,w,C]),j.useEffect(()=>{if(!!me||!!Ye||Ce.open||H.open||De){const z=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=z}}},[me,Ye,Ce.open,H.open,De]);const Ct=!!e&&t==="viewer";async function gt(){const x=await _s(Cn(ot,"library")),z=[];x.forEach($=>{const O=$.data();z.push({id:$.id,title:O.title||"",authors:O.authors||"Unknown",publisher:O.publisher||"Unknown",demographic:O.demographic||"",genre:O.genre||"",subGenre:O.subGenre||"",date:Cr(O.date)||O.date||"Unknown",cover:O.cover||"",isbn:O.isbn||"",pageCount:O.pageCount!==void 0&&O.pageCount!==null?O.pageCount:"",rating:O.rating!==void 0&&O.rating!==null?O.rating:"",amountPaid:O.amountPaid!==void 0&&O.amountPaid!==null?O.amountPaid:"",dateRead:Cr(O.dateRead)||O.dateRead||"",datePurchased:Cr(O.datePurchased)||O.datePurchased||"",msrp:O.msrp!==void 0&&O.msrp!==null?O.msrp:"",specialType:O.specialType||"",specialVolumes:O.specialVolumes!==void 0&&O.specialVolumes!==null?O.specialVolumes:"",collectiblePrice:O.collectiblePrice!==void 0&&O.collectiblePrice!==null?O.collectiblePrice:"",read:!!O.read,amazonURL:O.amazonURL||"",hidden:!!O.hidden,kind:"library"})}),z.sort(($,O)=>{const W=kt($.title),pe=kt(O.title),ne=W.name.localeCompare(pe.name);return ne!==0?ne:W.vol-pe.vol}),T(z),q($=>{const O=new Set($);return z.forEach(W=>O.add(W.title||"")),Array.from(O).filter(Boolean).sort()})}async function Nt(){const x=await _s(Cn(ot,"wishlist")),z=[];x.forEach($=>{const O=$.data();z.push({id:$.id,title:O.title||"",authors:O.authors||"Unknown",publisher:O.publisher||"Unknown",date:Cr(O.date)||O.date||"Unknown",cover:O.cover||"",isbn:O.isbn||"",pageCount:O.pageCount!==void 0&&O.pageCount!==null?O.pageCount:"",rating:O.rating!==void 0&&O.rating!==null?O.rating:"",amountPaid:O.amountPaid!==void 0&&O.amountPaid!==null?O.amountPaid:"",datePurchased:Cr(O.datePurchased)||O.datePurchased||"",specialType:O.specialType||"",specialVolumes:O.specialVolumes!==void 0&&O.specialVolumes!==null?O.specialVolumes:"",collectiblePrice:O.collectiblePrice!==void 0&&O.collectiblePrice!==null?O.collectiblePrice:"",amazonURL:O.amazonURL||"",hidden:!!O.hidden,kind:"wishlist"})}),z.sort(($,O)=>{const W=kt($.title),pe=kt(O.title),ne=W.name.localeCompare(pe.name);return ne!==0?ne:W.vol-pe.vol}),U(z),q($=>{const O=new Set($);return z.forEach(W=>O.add(W.title||"")),Array.from(O).filter(Boolean).sort()})}j.useEffect(()=>{let x=!1,z=!1,$=!1;const O=async()=>{if(!x)try{const ge=await fetch("/base/manga-library-wishlist.json",{cache:"no-cache"});if(!ge.ok)throw new Error("fallback fetch failed");const Be=await ge.json(),le=Array.isArray(Be.library)?Be.library:[],rt=Array.isArray(Be.wishlist)?Be.wishlist:[];T(le.map((Re,ht)=>({id:Re.id||`offline-lib-${ht}`,title:Re.title||"",authors:Re.authors||"Unknown",publisher:Re.publisher||"Unknown",demographic:Re.demographic||"",genre:Re.genre||"",subGenre:Re.subGenre||"",date:Cr(Re.date)||Re.date||"Unknown",cover:Re.cover||"",isbn:Re.isbn||"",pageCount:Re.pageCount??"",rating:Re.rating??"",amountPaid:Re.amountPaid??"",dateRead:Cr(Re.dateRead)||Re.dateRead||"",datePurchased:Cr(Re.datePurchased)||Re.datePurchased||"",msrp:Re.msrp??"",specialType:Re.specialType||"",specialVolumes:Re.specialVolumes??"",collectiblePrice:Re.collectiblePrice??"",amazonURL:Re.amazonURL||"",read:!!Re.read,hidden:!!Re.hidden,kind:"library"}))),U(rt.map((Re,ht)=>({id:Re.id||`offline-wish-${ht}`,title:Re.title||"",authors:Re.authors||"Unknown",publisher:Re.publisher||"Unknown",demographic:Re.demographic||"",genre:Re.genre||"",subGenre:Re.subGenre||"",date:Cr(Re.date)||Re.date||"Unknown",cover:Re.cover||"",isbn:Re.isbn||"",pageCount:Re.pageCount??"",rating:Re.rating??"",amountPaid:Re.amountPaid??"",dateRead:Cr(Re.dateRead)||Re.dateRead||"",datePurchased:Cr(Re.datePurchased)||Re.datePurchased||"",msrp:Re.msrp??"",specialType:Re.specialType||"",specialVolumes:Re.specialVolumes??"",collectiblePrice:Re.collectiblePrice??"",amazonURL:Re.amazonURL||"",read:!!Re.read,hidden:!!Re.hidden,kind:"wishlist"}))),I("")}catch(Me){console.error("Offline fallback failed",Me),I("Failed to load manga data from Firestore.")}finally{x||V(!1)}},W=()=>{z&&$&&!x&&V(!1)};if(!e)return;V(!0),I("");const pe=c_(Cn(ot,"library"),Me=>{if(x)return;const ge=[];Me.forEach(Be=>{const le=Be.data();ge.push({id:Be.id,title:le.title||"",authors:le.authors||"Unknown",publisher:le.publisher||"Unknown",demographic:le.demographic||"",genre:le.genre||"",subGenre:le.subGenre||"",date:le.date||"Unknown",cover:le.cover||"",isbn:le.isbn||"",pageCount:le.pageCount!==void 0&&le.pageCount!==null?le.pageCount:"",rating:le.rating!==void 0&&le.rating!==null?le.rating:"",amountPaid:le.amountPaid!==void 0&&le.amountPaid!==null?le.amountPaid:"",dateRead:le.dateRead||"",datePurchased:le.datePurchased||"",msrp:le.msrp!==void 0&&le.msrp!==null?le.msrp:"",specialType:le.specialType||"",specialVolumes:le.specialVolumes!==void 0&&le.specialVolumes!==null?le.specialVolumes:"",collectiblePrice:le.collectiblePrice!==void 0&&le.collectiblePrice!==null?le.collectiblePrice:"",read:!!le.read,amazonURL:le.amazonURL||"",hidden:!!le.hidden,kind:"library"})}),ge.sort((Be,le)=>{const rt=kt(Be.title),Re=kt(le.title),ht=rt.name.localeCompare(Re.name);return ht!==0?ht:rt.vol-Re.vol}),T(ge),q(Be=>{const le=new Set(Be);return ge.forEach(rt=>le.add(rt.title||"")),Array.from(le).filter(Boolean).sort()}),z=!0,W()},async Me=>{console.error("Library listener failed",Me),x||(I("Failed to load manga data from Firestore."),await O())}),ne=c_(Cn(ot,"wishlist"),Me=>{if(x)return;const ge=[];Me.forEach(Be=>{const le=Be.data();ge.push({id:Be.id,title:le.title||"",authors:le.authors||"Unknown",publisher:le.publisher||"Unknown",demographic:le.demographic||"",genre:le.genre||"",subGenre:le.subGenre||"",date:le.date||"Unknown",cover:le.cover||"",isbn:le.isbn||"",pageCount:le.pageCount!==void 0&&le.pageCount!==null?le.pageCount:"",rating:le.rating!==void 0&&le.rating!==null?le.rating:"",amountPaid:le.amountPaid!==void 0&&le.amountPaid!==null?le.amountPaid:"",datePurchased:le.datePurchased||"",specialType:le.specialType||"",specialVolumes:le.specialVolumes!==void 0&&le.specialVolumes!==null?le.specialVolumes:"",collectiblePrice:le.collectiblePrice!==void 0&&le.collectiblePrice!==null?le.collectiblePrice:"",amazonURL:le.amazonURL||"",hidden:!!le.hidden,kind:"wishlist"})}),ge.sort((Be,le)=>{const rt=kt(Be.title),Re=kt(le.title),ht=rt.name.localeCompare(Re.name);return ht!==0?ht:rt.vol-Re.vol}),U(ge),q(Be=>{const le=new Set(Be);return ge.forEach(rt=>le.add(rt.title||"")),Array.from(le).filter(Boolean).sort()}),$=!0,W()},async Me=>{console.error("Wishlist listener failed",Me),x||(I("Failed to load manga data from Firestore."),await O())});return()=>{x=!0,pe==null||pe(),ne==null||ne()}},[e]);const Yt=j.useMemo(()=>{const x=P.trim().toLowerCase();return x?w.filter(z=>[z.title,z.authors,z.publisher,z.isbn,z.date,String(z.pageCount??"")].join(" ").toLowerCase().includes(x)):w},[w,P]),tn=j.useMemo(()=>s&&Se?Yt:Yt.filter(x=>!x.hidden),[Yt,s,Se]),nn=j.useMemo(()=>{const x=M.trim().toLowerCase();return x?C.filter(z=>[z.title,z.authors,z.publisher,z.isbn,z.date,String(z.pageCount??"")].join(" ").toLowerCase().includes(x)):C},[C,M]),ur=j.useMemo(()=>s&&Se?nn:nn.filter(x=>!x.hidden),[nn,s,Se]),rn=x=>{m(x==="individual"?"individual":"series"),re(new Set),b(!1)},Yn=x=>{if(!(x!=null&&x.length))return;const z=($,O)=>{let W=[...$];return x.filter(pe=>pe.target===O).forEach(pe=>{const ne=W.findIndex(ge=>ge.id===pe.id),Me={...ne>=0?W[ne]:{},...pe.payload,id:pe.id,kind:O};ne>=0?W[ne]=Me:W.push(Me)}),W.sort(uR),W};T($=>z($,"library")),U($=>z($,"wishlist"))},Ot=x=>{b(z=>{const $=!z;if($){const O=new Set((x||[]).map(W=>W.id));re(W=>new Set([...W].filter(pe=>O.has(pe))))}else re(new Set);return $})};function $t(){s&&(b(x=>!x),re(new Set))}function Un(x){re(z=>{const $=new Set(z);return $.has(x)?$.delete(x):$.add(x),$})}async function dr(x,z=null){if(!s){alert("Multi-select actions require admin access.");return}const $=Array.from(J);if(!$.length){alert("Select at least one item first.");return}const O=l==="library"?"library":"wishlist",W=z||(O==="library"?"wishlist":"library"),pe=O==="library";try{if(x==="move"){const ne=O==="library"?w:C;if(!window.confirm(`Move ${$.length} item(s) from ${O==="library"?"Library":"Wishlist"} to ${W==="library"?"Library":"Wishlist"}?`))return;for(const Me of $){const ge=ne.find(le=>le.id===Me);if(!ge)continue;const Be=W==="library"?{title:ge.title,authors:ge.authors,publisher:ge.publisher,date:ge.date,pageCount:ge.pageCount||"",cover:ge.cover,amountPaid:"",read:!1,rating:"",msrp:"",collectiblePrice:"",specialType:"",specialVolumes:"",isbn:ge.isbn||"",demographic:ge.demographic||"",genre:ge.genre||"",subGenre:ge.subGenre||"",hidden:!!ge.hidden,datePurchased:ge.datePurchased||"",dateRead:ge.dateRead||""}:{title:ge.title,authors:ge.authors,publisher:ge.publisher,date:ge.date,pageCount:ge.pageCount||"",cover:ge.cover,amazonURL:ge.amazonURL||"",hidden:!!ge.hidden,datePurchased:"",read:!1,rating:"",msrp:"",collectiblePrice:"",specialType:"",specialVolumes:"",isbn:"",demographic:"",genre:"",subGenre:""};if(W==="library"&&(Be.msrp===""||Be.msrp===null)){const le=hn(ge);le!==""&&le!==null&&le!==void 0&&(Be.msrp=le)}await Aa(Cn(ot,W),Be),await Ra(Dt(ot,O,Me))}a(`Moved ${$.length} item${$.length===1?"":"s"} from ${O==="library"?"Library":"Wishlist"} to ${W==="library"?"Library":"Wishlist"}`,{action:"move",list:O==="library"?"Library":"Wishlist",details:{count:$.length,from:O,to:W}})}else if(x==="markRead"&&pe){for(const ne of $)await ws(Dt(ot,"library",ne),{read:!0,dateRead:y_()});a(`Marked ${$.length} library book${$.length===1?"":"s"} as read`,{action:"markRead",list:"Library",details:{count:$.length}})}else if(x==="markUnread"&&pe){for(const ne of $)await ws(Dt(ot,"library",ne),{read:!1,dateRead:"",rating:""});a(`Marked ${$.length} library book${$.length===1?"":"s"} as unread`,{action:"markUnread",list:"Library",details:{count:$.length}})}else if(x==="delete"){const ne=pe?"library":"wishlist";if(!window.confirm(`Delete ${$.length} item(s) from ${pe?"Library":"Wishlist"}?`))return;for(const Me of $)await Ra(Dt(ot,ne,Me));a(`Deleted ${$.length} item${$.length===1?"":"s"} from ${ne==="library"?"Library":"Wishlist"}`,{action:"delete-multi",list:ne==="library"?"Library":"Wishlist",details:{count:$.length}})}await Promise.all([gt(),Nt()]),re(new Set),b(!1)}catch(ne){console.error(ne),alert("Failed to apply multi-select action.")}}function Pn(x){He(x)}function zn(){He(null)}function Jt(x){const z=Bn.filter($=>(kt($.title||"").name||($.title||"").toLowerCase()||$.id)===x.key).sort(($,O)=>kt($.title).vol-kt(O.title).vol);Tt({series:x,volumes:z})}function ss(){Tt(null)}const Nn=()=>{de(x=>({...x,open:!1,mode:"add",editingId:null,data:{title:"",authors:"",publisher:"",demographic:"",genre:"",subGenre:"",date:"",cover:"",isbn:"",pageCount:"",rating:"",amountPaid:"",dateRead:"",datePurchased:"",msrp:"",special:!1,specialType:"",specialVolumes:"",collectiblePrice:"",amazonURL:"",read:!1,hidden:!1},multiAdd:!1,startVol:"",endVol:""})),Ne([]),Y(0)},wn=j.useMemo(()=>{const x=new Map;return[...w,...C].forEach(z=>{const $=kt(z.title||"");if(!$.name)return;const O=(z.title||"").replace(/,?\s*Vol\.?\s*\d+.*/i,"").trim()||z.title||$.name;if(!x.has($.name))x.set($.name,{display:O,maxVol:$.vol,authors:z.authors||"",publisher:z.publisher||"",demographic:z.demographic||""});else{const W=x.get($.name);W.maxVol=Math.max(W.maxVol,$.vol),!W.authors&&z.authors&&(W.authors=z.authors),!W.publisher&&z.publisher&&(W.publisher=z.publisher),!W.demographic&&z.demographic&&(W.demographic=z.demographic)}}),x},[w,C]),is=x=>{de(z=>({...z,open:!0,mode:"add",list:x,editingId:null,data:{...z.data,title:"",list:x}})),Ne([{kind:"new",id:null,data:{title:"",authors:"",publisher:"",demographic:"",genre:"",subGenre:"",date:"",cover:"",isbn:"",pageCount:"",rating:"",amountPaid:"",dateRead:"",datePurchased:"",msrp:"",specialType:"",specialVolumes:"",collectiblePrice:"",amazonURL:"",read:!1}}]),Y(0)},Ss=x=>{const z={open:!0,mode:"edit",list:x.kind==="wishlist"?"wishlist":"library",editingId:x.id,data:{title:x.title||"",authors:x.authors||"",publisher:x.publisher||"",demographic:x.demographic||"",genre:x.genre||"",subGenre:x.subGenre||"",date:x.date||"",cover:x.cover||"",isbn:x.isbn||"",pageCount:x.pageCount||"",rating:x.rating||"",amountPaid:x.amountPaid||"",dateRead:x.dateRead||"",datePurchased:x.datePurchased||"",msrp:x.msrp||"",special:!!(x.specialType||x.specialVolumes||x.collectiblePrice),specialType:x.specialType||"",specialVolumes:x.specialVolumes||"",collectiblePrice:x.collectiblePrice||"",amazonURL:x.amazonURL||"",read:!!x.read,hidden:!!x.hidden}};de(z),Ne([{kind:"edit",id:x.id,data:{...z.data}}]),Y(0)},Pt=(x,z,$="text")=>{if(de(O=>{const W={...O.data,[x]:$==="checkbox"?!!z:z};if(x==="special"&&!z&&(W.specialType="",W.specialVolumes="",W.collectiblePrice=""),x==="specialType"&&(z==="collectible"?W.specialVolumes="":(z==="specialEdition"||(W.specialVolumes=""),W.collectiblePrice="")),x==="title"){const pe=kt(z||"");if(pe.name&&wn.has(pe.name)){const ne=wn.get(pe.name);W.authors=ne.authors||W.authors,W.publisher=ne.publisher||W.publisher,W.demographic=ne.demographic||W.demographic}}return{...O,data:W}}),Ne(O=>{if(!O.length)return O;const W=[...O],pe={...W[_e]};return pe.data={...pe.data,[x]:$==="checkbox"?!!z:z},W[_e]=pe,W}),x==="title"){const O=String(z||"").trim().toLowerCase();if(!O)ie([]);else{const W=[];wn.forEach(pe=>{if(pe.display.toLowerCase().includes(O)){const ne=pe.maxVol>0?pe.maxVol+1:1;W.push(`${pe.display}, Vol. ${ne}`)}}),ie(W.slice(0,6))}}},yr=x=>{ce[x]&&(Y(x),de(z=>{const $=ce[x];return{...z,data:{...$.data}}}))},bs=()=>{const x=Ce.data.title||"",z=kt(x);if(!z.name){alert("Provide a title with a volume number first (e.g., Series, Vol. 1).");return}const $={kind:Ce.mode,id:Ce.editingId,data:{...Ce.data}},O=ce.length?[...ce]:[];O.length?O[_e]=$:O.push($);const W=x.replace(/,?\s*Vol\.?\s*\d+.*/i,"").trim()||x;let pe=z.vol||0;const ne=wn.get(z.name);ne&&ne.maxVol>pe&&(pe=ne.maxVol),O.forEach(le=>{const rt=kt(le.data.title||"");rt.name===z.name&&(pe=Math.max(pe,rt.vol||0))});const Me=(pe||0)+1,Be={title:`${W}, Vol. ${Me}`,authors:Ce.data.authors,publisher:Ce.data.publisher,demographic:Ce.data.demographic,genre:Ce.data.genre,subGenre:Ce.data.subGenre,msrp:Ce.data.msrp,hidden:Ce.data.hidden,cover:"",isbn:"",pageCount:"",rating:"",amountPaid:"",date:"",dateRead:"",datePurchased:"",special:!1,specialType:"",specialVolumes:"",collectiblePrice:"",amazonURL:"",read:!1};O.push({kind:"new",id:null,data:Be}),Ne(O),Y(O.length-1),de(le=>({...le,mode:"add",data:Be}))};async function Jn(){if(!s)return;const{list:x}=Ce,z=x||"library",$=ce.length>0?ce:[{kind:Ce.mode,id:Ce.editingId,data:Ce.data}],O=W=>{const pe=(W.title||"").trim(),ne=kt(pe),Me=wn.get(ne.name)||{},ge=(W.authors||"").trim()||Me.authors||"",Be=(W.publisher||"").trim()||Me.publisher||"",le=(W.demographic||"").trim()||Me.demographic||"",rt=(W.genre||"").trim()||Me.genre||"",Re=(W.subGenre||"").trim()||Me.subGenre||"";return{title:pe,authors:ge,publisher:Be,demographic:le,genre:rt,subGenre:Re,date:Cr(W.date||""),cover:(W.cover||"").trim(),isbn:z==="wishlist"?"":(W.isbn||"").trim(),pageCount:W.pageCount===""?"":Number(W.pageCount),rating:z==="wishlist"||W.rating===""?"":Math.max(.5,Math.min(5,Number(W.rating))),amountPaid:W.amountPaid===""?"":Number(W.amountPaid),dateRead:Cr(W.dateRead||""),datePurchased:Cr(W.datePurchased||""),msrp:z==="wishlist"||W.msrp===""?"":Number(W.msrp),special:z==="wishlist"?!1:!!(W.special&&(W.specialType||"").trim()),specialType:z==="wishlist"||!(W.special&&(W.specialType||"").trim())?"":(W.specialType||"").trim(),specialVolumes:z==="wishlist"?"":W.special&&W.specialType==="specialEdition"?W.specialVolumes===""?"":Number(W.specialVolumes):"",collectiblePrice:z==="wishlist"?"":W.special&&W.specialType==="collectible"?W.collectiblePrice===""?"":Number(W.collectiblePrice):"",amazonURL:(W.amazonURL||"").trim(),read:z==="wishlist"?!1:!!W.read,hidden:!!W.hidden,kind:x}};try{const W=await Promise.all($.map(async pe=>{const ne=O(pe.data);if(z==="library"&&pe.kind!=="edit"){const Me=kt(ne.title).name,ge=w.filter(le=>kt(le.title||le.Title||"").name===Me),Be=ge[0];if(Be&&(ne.demographic=ne.demographic||Be.demographic||Be.Demographic||"",ne.genre=ne.genre||Be.genre||Be.Genre||"",ne.subGenre=ne.subGenre||Be.subGenre||Be.SubGenre||"",ne.msrp==="")){const le=ge.map(rt=>Number(rt.msrp??rt.MSRP)).filter(rt=>Number.isFinite(rt));le.length>0&&le.every(Re=>Re===le[0])&&(ne.msrp=le[0])}}if(!ne.title)throw alert("Title is required for every entry."),new Error("missing title");if(pe.kind==="edit"&&pe.id)return await ws(Dt(ot,z,pe.id),ne),{target:z,id:pe.id,payload:ne};{const Me=await Aa(Cn(ot,z),ne);return{target:z,id:Me.id,payload:ne}}}));Yn(W.filter(Boolean)),await Promise.all([gt(),Nt()]),a(`${Ce.mode==="add"?"Added":"Saved"} ${$.length} item${$.length===1?"":"s"} in ${z==="library"?"Library":"Wishlist"}`,{action:Ce.mode==="add"?"create":"update",list:z==="library"?"Library":"Wishlist",details:{entries:$.length,mode:Ce.mode}}),Nn()}catch(W){console.error(W),alert("Failed to save entry.")}}async function Xn(x,z){if(!s||!window.confirm("Delete this entry?"))return;const O=(z==="wishlist"?C:w).find(W=>W.id===x);try{await Ra(Dt(ot,z,x)),await Promise.all([gt(),Nt()]),a(`Deleted "${(O==null?void 0:O.title)||"Untitled"}" from ${z==="library"?"Library":"Wishlist"}`,{action:"delete-single",list:z==="library"?"Library":"Wishlist",details:{title:(O==null?void 0:O.title)||"Untitled"}})}catch(W){console.error(W),alert("Failed to delete entry.")}}const[Rr,Rn]=j.useState(!1),Ar=()=>Te({open:!1,index:0,items:[]});async function Zn(x,z,$={}){if(!(x!=null&&x.id))return;const O=x.kind==="wishlist"?"wishlist":"library";Rn(!0);try{await ws(Dt(ot,O,x.id),z),Yn([{target:O,id:x.id,payload:z}]),await Promise.all([gt(),Nt()]),a(`Updated "${x.title||"Untitled"}" in ${O==="library"?"Library":"Wishlist"}`,{action:$.action||"inline-update",list:O==="library"?"Library":"Wishlist",details:$.details||{title:x.title||"Untitled",fields:Object.keys(z||{}).join(", "),rating:z.rating??void 0}}),He(W=>W&&W.id===x.id?{...W,...z}:W)}catch(W){console.error(W),alert("Failed to update entry.")}finally{Rn(!1)}}const qs=(x,z)=>{const $=z===""?"":Math.max(.5,Math.min(5,Number(z)));Zn(x,{rating:$},{action:"rating",details:{title:x.title||"Untitled",rating:$}})},vr=(x,z)=>{if(!x)return;const $=z?{read:!0,dateRead:y_(),rating:x.rating??""}:{read:!1,dateRead:"",rating:""};Zn(x,$,{action:z?"mark-read":"mark-unread",details:{title:x.title||"Untitled",dateRead:z?$.dateRead:"cleared",rating:x.rating||"not set"}})},Hs=()=>{if(!J.size){alert("Select at least one entry first.");return}const z=[...w,...C].filter(O=>J.has(O.id));if(!z.length){alert("No items selected.");return}const $=z.map(O=>({id:O.id,kind:O.kind||(l==="wishlist"?"wishlist":"library"),data:{title:O.title||"",authors:O.authors||"",publisher:O.publisher||"",demographic:O.demographic||"",genre:O.genre||"",subGenre:O.subGenre||"",date:O.date||"",cover:O.cover||"",isbn:O.isbn||"",pageCount:O.pageCount||"",rating:O.rating||"",amountPaid:O.amountPaid||"",dateRead:O.dateRead||"",datePurchased:O.datePurchased||"",msrp:O.msrp||"",special:!!(O.specialType||O.specialVolumes||O.collectiblePrice),specialType:O.specialType||"",specialVolumes:O.specialVolumes||"",collectiblePrice:O.collectiblePrice||"",amazonURL:O.amazonURL||"",read:!!O.read,hidden:!!O.hidden}}));Te({open:!0,index:0,items:$})},Ze=(x,z,$="text")=>{Te(O=>{const W=[...O.items],pe={...W[O.index]},ne={...pe.data,[x]:$==="checkbox"?!!z:z};return x==="special"&&!z&&(ne.specialType="",ne.specialVolumes="",ne.collectiblePrice=""),x==="specialType"&&(z==="collectible"?ne.specialVolumes="":(z==="specialEdition"||(ne.specialVolumes=""),ne.collectiblePrice="")),pe.data=ne,W[O.index]=pe,{...O,items:W}})},er=()=>{Te(x=>({...x,index:Math.min(x.index+1,x.items.length-1)}))},An=()=>{Te(x=>({...x,index:Math.max(x.index-1,0)}))};async function as(){if(!s)return;const x=H.items;if(!x.length){Ar();return}try{const z=await Promise.all(x.map(async $=>{const W=!($.kind==="wishlist")&&!!($.data.special&&($.data.specialType||"").trim()),pe={...$.data,pageCount:$.data.pageCount===""?"":Number($.data.pageCount),rating:$.data.rating===""?"":Math.max(.5,Math.min(5,Number($.data.rating))),amountPaid:$.data.amountPaid===""?"":Number($.data.amountPaid),msrp:$.data.msrp===""?"":Number($.data.msrp),special:W,specialType:W?$.data.specialType:"",collectiblePrice:W&&$.data.specialType==="collectible"?$.data.collectiblePrice===""?"":Number($.data.collectiblePrice):"",specialVolumes:W&&$.data.specialType==="specialEdition"?$.data.specialVolumes===""?"":Number($.data.specialVolumes):"",datePurchased:$.data.datePurchased||"",amazonURL:$.data.amazonURL||"",read:!!$.data.read},ne=$.kind==="wishlist"?"wishlist":"library";return await ws(Dt(ot,ne,$.id),pe),{target:ne,id:$.id,payload:pe}}));Yn(z.filter(Boolean)),await Promise.all([gt(),Nt()]),re(new Set),b(!1),a(`Bulk edited ${x.length} item${x.length===1?"":"s"} in Library/Wishlist`,{action:"bulk-edit",list:"Library/Wishlist",details:{count:x.length}}),Ar()}catch(z){console.error(z),alert("Failed to save bulk edits.")}}const jn=x=>{const z=new Map;return x.forEach($=>{const O=kt($.title||""),W=O.name||($.title||"").toLowerCase()||$.id,pe=wn.get(O.name)||null,ne=(pe==null?void 0:pe.display)||($.title||"").replace(/,?\s*Vol\.?\s*\d+.*/i,"").trim()||$.title||"Untitled",Me=Eu($,{includeIsbn:$.kind==="library",includeFinance:$.kind==="library"}),ge=dR($.title||""),Be=Number.isFinite(O.vol)?O.vol:0,le=ge.length>0?ge:Be>0?[Be]:[],rt=le.length?le[0]:0,Re=Eo($);if(!z.has(W))z.set(W,{id:`series-${W}`,key:W,title:ne,authors:$.authors&&$.authors!=="Unknown"?$.authors:(pe==null?void 0:pe.authors)||"",publisher:$.publisher&&$.publisher!=="Unknown"?$.publisher:(pe==null?void 0:pe.publisher)||"",demographic:(pe==null?void 0:pe.demographic)||$.demographic||"",cover:$.cover||"",count:1,readCount:$.read?1:0,minVol:rt,maxVol:rt,representative:$,volumes:[...le],missingPageCount:Re?1:0,missingMetaCount:Me.any?1:0,missingVolumeCount:Re||Me.any?1:0});else{const ht=z.get(W);if(ht.count+=1,$.read&&(ht.readCount+=1),Re&&(ht.missingPageCount+=1),Me.any&&(ht.missingMetaCount+=1),(Re||Me.any)&&(ht.missingVolumeCount+=1),le.length){const Ps=Math.min(...le),sn=Math.max(...le);ht.minVol=Math.min(ht.minVol,Ps),ht.maxVol=Math.max(ht.maxVol,sn),ht.volumes.push(...le)}!ht.cover&&$.cover&&(ht.cover=$.cover),!ht.authors&&$.authors&&$.authors!=="Unknown"&&(ht.authors=$.authors),!ht.publisher&&$.publisher&&$.publisher!=="Unknown"&&(ht.publisher=$.publisher)}}),Array.from(z.values())},xn=x=>{const z=Array.from(new Set((x||[]).filter(ne=>Number.isFinite(ne)&&ne>=0))).sort((ne,Me)=>ne-Me);if(!z.length)return null;const $=[];let O=z[0],W=z[0];for(let ne=1;ne<z.length;ne+=1){const Me=z[ne];if(Me===W+1){W=Me;continue}$.push([O,W]),O=Me,W=Me}if($.push([O,W]),$.length===1){const[ne,Me]=$[0];return ne===Me?`Vol. ${ne}`:`Vol. ${ne}-${Me}`}return`Vols. ${$.map(([ne,Me])=>ne===Me?`${ne}`:`${ne}-${Me}`).join(", ")}`};function kn(x){const z=J.has(x.id),$=x.kind==="library",O=s&&Eo(x),W=s?Eu(x,{includeIsbn:$,includeFinance:$}):{any:!1,authorMissing:!1,publisherMissing:!1,dateMissing:!1,isbnMissing:!1},pe=()=>{N&&s?Un(x.id):Pn(x)};return o.jsxs("div",{className:"manga-card"+(x.read&&$?" read":"")+(z?" multiselect-selected":"")+(O?" missing-page":"")+(W.any?" missing-meta":""),onClick:pe,children:[o.jsx("div",{className:"manga-card-cover-wrap",children:o.jsx("img",{src:x.cover||"https://imgur.com/chUgq4W.png",alt:"Cover",loading:"lazy",decoding:"async"})}),o.jsxs("div",{className:"manga-card-body",children:[o.jsx("div",{className:"manga-card-title",children:x.title||"Untitled"}),o.jsxs("div",{className:"manga-card-meta",children:[o.jsx("span",{className:W.authorMissing?"missing-field":"",children:x.authors&&x.authors!=="Unknown"?x.authors:W.authorMissing?"Missing author":""}),o.jsx("br",{}),o.jsx("span",{className:W.publisherMissing?"missing-field":"",children:x.publisher&&x.publisher!=="Unknown"?x.publisher:W.publisherMissing?"Missing publisher":""}),o.jsx("br",{}),o.jsx("span",{className:W.dateMissing?"missing-field":"",children:x.date&&x.date!=="Unknown"?x.date:W.dateMissing?"Missing date":""})]}),x.isbn?o.jsxs("div",{className:"manga-card-isbn",children:["ISBN: ",x.isbn]}):$&&W.isbnMissing&&o.jsx("div",{className:"manga-card-isbn missing-field",children:"Missing ISBN"}),s&&o.jsxs("div",{className:"manga-card-actions",children:[o.jsx("button",{type:"button",className:"manga-btn mini",onClick:ne=>{ne.stopPropagation(),Ss(x)},children:"Edit"}),o.jsx("button",{type:"button",className:"manga-btn mini danger",onClick:ne=>{ne.stopPropagation(),Xn(x.id,x.kind==="wishlist"?"wishlist":"library")},children:"Delete"})]})]})]},x.id)}function Cs(x){var Me;const z=xn(x.volumes),$=`${x.count} volume${x.count===1?"":"s"}`;x.readCount>=x.count&&x.count>0||`${x.readCount}${x.count}`;const O=x.readCount>=x.count&&x.count>0,W=s&&x.missingVolumeCount||0,pe=W>0,ne=[x.authors&&x.authors!=="Unknown"?x.authors:null,x.publisher&&x.publisher!=="Unknown"?x.publisher:null,z?`${$} - ${z}`:$].filter(Boolean);return o.jsxs("div",{className:"manga-card series-view"+(O?" read":"")+(pe?" missing-page missing-meta":""),onClick:()=>Jt(x),children:[pe&&o.jsx("div",{className:"missing-page-badge",title:"Volumes missing required data",children:W}),o.jsx("div",{className:"manga-card-cover-wrap",children:o.jsx("img",{src:x.cover||((Me=x.representative)==null?void 0:Me.cover)||"https://imgur.com/chUgq4W.png",alt:"Cover",loading:"lazy",decoding:"async"})}),o.jsxs("div",{className:"manga-card-body",children:[o.jsx("div",{className:"manga-card-title",children:x.title||"Untitled Series"}),o.jsx("div",{className:"manga-card-meta",children:ne.map((ge,Be)=>o.jsxs(tp.Fragment,{children:[ge,o.jsx("br",{})]},ge+Be))}),o.jsx("div",{className:"manga-card-series-count",children:$})]})]},x.id)}const Is=({value:x,onChange:z,interactive:$=!0})=>{const[O,W]=j.useState(null),pe=Math.max(0,Math.min(5,Number(x)||0)),ne=$&&O!=null?O:pe,Me=Array.from({length:10},(rt,Re)=>(Re+1)*.5),ge=5,Be=Array.from({length:ge},(rt,Re)=>Math.max(0,Math.min(1,ne-Re))),le=$&&typeof z=="function";return o.jsxs("div",{className:`star-shell${le?"":" read-only"}`,role:"group","aria-label":"Rating",children:[o.jsxs("div",{className:"star-visual",style:{"--star-count":ge},children:[o.jsx("div",{className:"star-row",children:Be.map((rt,Re)=>o.jsxs("div",{className:"star-icon",children:[o.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",className:"star-base",children:o.jsx("path",{d:"M12 2.5l2.9 5.88 6.5.95-4.7 4.58 1.1 6.43L12 17.9l-5.8 3.44 1.1-6.43-4.7-4.58 6.5-.95L12 2.5z"})}),o.jsx("div",{className:"star-fill",style:{"--pct":`${(Math.max(0,Math.min(1,rt))*100).toFixed(1)}%`},children:o.jsx("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:o.jsx("path",{d:"M12 2.5l2.9 5.88 6.5.95-4.7 4.58 1.1 6.43L12 17.9l-5.8 3.44 1.1-6.43-4.7-4.58 6.5-.95L12 2.5z"})})})]},Re))}),le&&o.jsx("div",{className:"star-hit",children:Me.map(rt=>o.jsx("button",{type:"button","aria-label":`${rt} stars`,onMouseEnter:()=>W(rt),onMouseLeave:()=>W(null),onClick:()=>z(rt)},rt))})]}),o.jsx("div",{className:"star-value",children:ne?ne.toFixed(1):"--"}),le&&o.jsx("button",{type:"button",className:"star-clear",onClick:()=>z(""),"aria-label":"Clear rating",children:"clear"})]})},Bn=l==="library"?tn:ur,$r=l==="library"?w:C,Ft=j.useMemo(()=>jn(Bn),[Bn,wn]),os=j.useMemo(()=>jn($r),[$r,wn]);j.useEffect(()=>{if(!me&&!Ye)return;const x=[...w,...C];if(me){const z=x.find($=>$.id===me.id);z?(z.title!==me.title||z.isbn!==me.isbn||z.publisher!==me.publisher||z.authors!==me.authors||z.date!==me.date||z.pageCount!==me.pageCount||z.amountPaid!==me.amountPaid||z.msrp!==me.msrp||z.rating!==me.rating||z.read!==me.read||z.amazonURL!==me.amazonURL)&&He(z):He(null)}if(Ye){const z=Ft.find(ne=>ne.key===Ye.series.key);if(!z){Tt(null);return}const $=Bn.filter(ne=>(kt(ne.title||"").name||(ne.title||"").toLowerCase()||ne.id)===z.key).sort((ne,Me)=>kt(ne.title).vol-kt(Me.title).vol),O=$.length===Ye.volumes.length&&$.every((ne,Me)=>{var ge;return((ge=Ye.volumes[Me])==null?void 0:ge.id)===ne.id}),W=$.length!==Ye.volumes.length||$.some((ne,Me)=>{const ge=Ye.volumes[Me];return!ge||ge.id!==ne.id?!0:ge.title!==ne.title||ge.authors!==ne.authors||ge.publisher!==ne.publisher||ge.date!==ne.date||ge.isbn!==ne.isbn||ge.cover!==ne.cover||ge.read!==ne.read||ge.pageCount!==ne.pageCount||ge.datePurchased!==ne.datePurchased||ge.amountPaid!==ne.amountPaid||ge.msrp!==ne.msrp||ge.rating!==ne.rating}),pe=z.title!==Ye.series.title||z.authors!==Ye.series.authors||z.publisher!==Ye.series.publisher||z.count!==Ye.series.count;(W||pe||!O)&&Tt({series:z,volumes:$})}},[w,C,me,Ye,Bn,Ft]);const dn=f==="series"?Ft:Bn;f==="series"?Ft.length:Bn.length,f==="series"?os.length:$r.length;const jr=(x,z)=>{if(!x.length)return;const $=Array.from(x.reduce((ge,Be)=>(Object.keys(Be).forEach(le=>ge.add(le)),ge),new Set)),O=ge=>{const Be=ge==null?"":String(ge);return/[",\n]/.test(Be)?`"${Be.replace(/"/g,'""')}"`:Be},W=[$.join(",")].concat(x.map(ge=>$.map(Be=>O(ge[Be])).join(","))),pe=new Blob([W.join(`
`)],{type:"text/csv"}),ne=URL.createObjectURL(pe),Me=document.createElement("a");Me.href=ne,Me.download=z,Me.click(),URL.revokeObjectURL(ne)},Ks=async(x,z)=>{const $=(W,pe="image")=>(W||"").toString().toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"").slice(0,100)||pe,O=x.filter(W=>W.cover).map((W,pe)=>({url:W.cover,name:$(W.title||`manga-${pe+1}`,`manga-${pe+1}`)}));if(!O.length){alert("No images found to download.");return}try{const W=(await pc(async()=>{const{default:Re}=await import("https://cdn.jsdelivr.net/npm/jszip@3.10.1/+esm");return{default:Re}},[])).default,pe=new W,ne=pe.folder("images"),Me={},ge=O.map(async(Re,ht)=>{try{const sn=await(await fetch(Re.url)).blob(),Dn=(Re.url.split(".").pop()||"jpg").split(/[?#]/)[0],fr=Re.name||`image-${ht+1}`;Me[fr]=(Me[fr]||0)+1;const kr=Me[fr]>1?`-${Me[fr]}`:"";ne.file(`${fr}${kr}.${Dn}`,sn)}catch(Ps){console.warn("Failed to fetch image",Re.url,Ps)}});await Promise.all(ge);const Be=await pe.generateAsync({type:"blob"}),le=URL.createObjectURL(Be),rt=document.createElement("a");rt.href=le,rt.download=z,rt.click(),URL.revokeObjectURL(le)}catch(W){console.error("Zip download failed",W),alert("Failed to create zip. Please try again.")}},Wr=(x,z)=>{const $=new Blob([JSON.stringify(x,null,2)],{type:"application/json"}),O=URL.createObjectURL($),W=document.createElement("a");W.href=O,W.download=z,W.click(),URL.revokeObjectURL(O)},ls=x=>({title:x.title||"",authors:x.authors||"",publisher:x.publisher||"",demographic:x.demographic||"",genre:x.genre||"",subGenre:x.subGenre||"",date:x.date||"",pageCount:x.pageCount??"",cover:x.cover||"",amountPaid:x.amountPaid??"",read:!!x.read,rating:x.rating??"",dateRead:x.dateRead||"",datePurchased:x.datePurchased||"",msrp:x.msrp??"",collectiblePrice:x.collectiblePrice??"",specialType:x.specialType||"",specialVolumes:x.specialVolumes??"",isbn:x.isbn||"",amazonURL:x.amazonURL||"",hidden:!!x.hidden}),hn=x=>{const $=kt(x.title||"").name;if(!$)return"";const W=[...w,...C].map(ne=>{const ge=kt(ne.title||"").name===$,Be=ne.msrp??ne.MSRP??"",le=String(Be).trim();if(!ge||!le)return null;const rt=Number(le);return Number.isFinite(rt)?rt:null}).filter(ne=>ne!==null);if(!W.length)return"";const pe=W[0];return W.every(ne=>ne===pe)?pe:""},Qs=x=>{const $=kt(x.title||"").name;if(!$)return{demographic:"",genre:"",subGenre:""};const W=[...w,...C].find(pe=>kt(pe.title||"").name===$&&(pe.demographic||pe.genre||pe.subGenre));return{demographic:(W==null?void 0:W.demographic)||"",genre:(W==null?void 0:W.genre)||"",subGenre:(W==null?void 0:W.subGenre)||""}},Ys=async x=>{if(!s||!(x!=null&&x.id))return;const z=x.kind==="wishlist"?"wishlist":"library",$=z==="library"?"wishlist":"library";try{const O=ls(x);if($==="library"){const W=hn(x);(O.msrp===""||O.msrp===null||O.msrp===void 0)&&(O.msrp=W);const pe=Qs(x);O.demographic||(O.demographic=pe.demographic),O.genre||(O.genre=pe.genre),O.subGenre||(O.subGenre=pe.subGenre)}await Aa(Cn(ot,$),O),await Ra(Dt(ot,z,x.id)),await Promise.all([gt(),Nt()]),Tt(W=>W&&{...W,volumes:W.volumes.filter(pe=>pe.id!==x.id)}),zn()}catch(O){console.error("Move failed",O),alert("Failed to move item.")}},dt=Ce.list==="wishlist",hr=H.items[H.index]||null,fn=(hr==null?void 0:hr.kind)==="wishlist",pn=j.useMemo(()=>{if(!hr)return{author:!1,publisher:!1,date:!1,purchaseDate:!1,page:!1,isbn:!1,amountPaid:!1,collectiblePrice:!1,msrp:!1};const x=hr.data||{},z=hr.kind==="library",$=z&&x.special&&x.specialType==="collectible",O=z&&!$;return{author:qt(x.authors),publisher:qt(x.publisher),date:qt(x.date),purchaseDate:z?qt(x.datePurchased):!1,page:Eo({pageCount:x.pageCount}),isbn:z?qt(x.isbn):!1,amountPaid:O?qt(x.amountPaid):!1,collectiblePrice:$?qt(x.collectiblePrice):!1,msrp:z?qt(x.msrp):!1}},[hr]);return o.jsxs("div",{className:"manga-page",children:[o.jsxs("header",{className:"manga-header",style:{flexDirection:"column",alignItems:"center",textAlign:"center"},children:[o.jsx("div",{className:"manga-header-title",style:{justifyContent:"center",gap:"0.6rem",fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Tyler's Manga Library"}),o.jsx("div",{className:"manga-header-sub",style:{textAlign:"center"},children:"This is my Manga Library and Wishlist. Check and see all the Manga I have in my possession!"})]}),Ct&&o.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"6px"},children:o.jsx("button",{className:"suggestion-trigger",type:"button",onClick:()=>{ve(""),ke(!0)},children:"+ Suggestion"})}),o.jsxs("div",{className:"manga-tabs",children:[o.jsx("button",{className:"manga-tab-btn"+(l==="library"?" active":""),onClick:()=>{d("library"),b(!1),re(new Set)},children:"Library"}),o.jsx("button",{className:"manga-tab-btn"+(l==="wishlist"?" active":""),onClick:()=>{d("wishlist"),b(!1),re(new Set)},children:"Wishlist"})]}),l!=="dashboard"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"manga-toolbar",children:[o.jsxs("div",{className:"manga-toolbar-left",children:[o.jsx("input",{type:"text",className:"manga-search-input",placeholder:l==="library"?"Search library by title, author, ISBN...":"Search wishlist...",value:l==="library"?P:M,onChange:x=>l==="library"?A(x.target.value):D(x.target.value)}),o.jsx("div",{className:"manga-counter",children:(()=>{const x=l==="library",z=(x?P:M).trim(),$=x?w.length:C.length,O=x?Yt.length:nn.length;return z?`${O} / ${$} Volumes`:`${$} Volumes`})()})]}),o.jsxs("div",{className:"manga-toolbar-right",children:[o.jsxs("div",{className:"manga-view-toggle",children:[o.jsx("button",{className:"manga-btn secondary"+(f==="series"?" active":""),type:"button","aria-pressed":f==="series","aria-label":"Series view",title:"Series View",onClick:()=>rn("series"),children:""}),o.jsx("button",{className:"manga-btn secondary"+(f==="individual"?" active":""),type:"button","aria-pressed":f==="individual","aria-label":"Volume view",title:"Volume View",onClick:()=>rn("individual"),children:""})]}),s&&o.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>Ee(x=>!x),children:Se?"Hide Hidden":"Show Hidden"}),s&&o.jsx("button",{className:"manga-btn secondary"+(N?" active":""),disabled:f==="series",onClick:$t,children:N?"Exit Multi-select":"Multi-select"})]})]}),s&&N&&f==="individual"&&o.jsxs("div",{className:"manga-multiselect-bar",children:[o.jsxs("span",{children:["Selected: ",o.jsx("strong",{children:J.size})]}),o.jsx("button",{className:"manga-btn",onClick:Hs,children:"Bulk Edit"}),o.jsxs("button",{className:"manga-btn secondary",onClick:()=>dr("move"),children:["Move to ",l==="library"?"Wishlist":"Library"]}),l==="library"&&o.jsxs(o.Fragment,{children:[o.jsx("button",{className:"manga-btn",onClick:()=>dr("markRead"),children:"Mark Read"}),o.jsx("button",{className:"manga-btn secondary",onClick:()=>dr("markUnread"),children:"Mark Unread"})]}),o.jsx("button",{className:"manga-btn danger",onClick:()=>dr("delete"),children:"Delete"})]})]}),we?o.jsx("div",{className:"manga-empty-state",children:"Loading manga from Firestore..."}):ae?o.jsx("div",{className:"manga-empty-state",children:ae}):dn.length===0?o.jsx("div",{className:"manga-empty-state",children:"No manga found. Try changing your search."}):o.jsx("div",{className:"manga-grid",children:dn.map(x=>f==="series"?Cs(x):kn(x))}),Ye&&o.jsx("div",{className:"manga-modal-backdrop visible",onClick:x=>{x.target===x.currentTarget&&ss()},children:o.jsx("div",{className:"manga-modal series",children:o.jsxs("div",{className:"manga-modal-body",children:[o.jsxs("div",{className:"manga-modal-header",children:[o.jsx("div",{className:"manga-modal-title",children:Ye.series.title||"Series"}),o.jsx("button",{className:"manga-modal-close",onClick:ss,type:"button","aria-label":"Close",children:"X"})]}),o.jsxs("div",{className:"manga-modal-subtitle",children:[Ye.series.count," volume",Ye.series.count===1?"":"s"," in this series"]}),s&&o.jsxs("div",{className:"series-bulk-controls",children:[o.jsx("button",{type:"button",className:"manga-btn mini secondary"+(N?" active":""),onClick:()=>Ot(Ye.volumes),children:N?"Exit Multi-select":"Multi-select"}),N&&o.jsxs(o.Fragment,{children:[o.jsx("button",{type:"button",className:"manga-btn mini secondary",onClick:()=>{const x=Ye.volumes.map(z=>z.id);re(new Set(x))},children:"Select All"}),o.jsx("button",{type:"button",className:"manga-btn mini secondary",onClick:()=>{re(new Set)},children:"Clear"}),l==="wishlist"?o.jsx("button",{type:"button",className:"manga-btn mini",disabled:!J.size,onClick:()=>{J.size&&dr("move","library")},children:"Move to Library"}):o.jsx("button",{type:"button",className:"manga-btn mini",disabled:!J.size,onClick:()=>{J.size&&dr("move","wishlist")},children:"Move to Wishlist"}),o.jsxs("button",{type:"button",className:"manga-btn mini",disabled:!J.size,onClick:()=>{if(!J.size)return;const x=new Set(Ye.volumes.map(z=>z.id));re(z=>new Set([...z].filter($=>x.has($)))),Hs()},children:["Bulk Edit Selected (",J.size||0,")"]})]})]}),o.jsx("div",{className:"manga-series-modal-grid",children:Ye.volumes.map(x=>{const z=Eu(x,{includeIsbn:x.kind==="library",includeFinance:x.kind==="library"});return o.jsxs("div",{className:"manga-card mini-card"+(x.read?" read":"")+(s&&Eo(x)?" missing-page":"")+(s&&z.any?" missing-meta":""),onClick:()=>{if(!s){Pn(x);return}if(N){Un(x.id);return}Pn(x)},children:[o.jsxs("div",{className:"manga-card-cover-wrap",children:[N&&s&&o.jsx("div",{className:"mini-select-indicator"+(J.has(x.id)?" selected":""),children:J.has(x.id)?"X":""}),o.jsx("img",{src:x.cover||"https://imgur.com/chUgq4W.png",alt:x.title||"Cover",loading:"lazy",decoding:"async"})]}),o.jsxs("div",{className:"manga-card-body",children:[o.jsx("div",{className:"manga-card-title",children:x.title||"Untitled"}),o.jsxs("div",{className:"manga-card-meta",children:[o.jsx("span",{className:z.authorMissing?"missing-field":"",children:x.authors&&x.authors!=="Unknown"?x.authors:"Missing author"}),o.jsx("br",{}),o.jsx("span",{className:z.publisherMissing?"missing-field":"",children:x.publisher&&x.publisher!=="Unknown"?x.publisher:"Missing publisher"}),o.jsx("br",{}),o.jsx("span",{className:z.dateMissing?"missing-field":"",children:x.date&&x.date!=="Unknown"?x.date:"Missing date"})]}),x.isbn?o.jsxs("div",{className:"manga-card-isbn",children:["ISBN: ",x.isbn]}):x.kind==="library"&&z.isbnMissing&&o.jsx("div",{className:"manga-card-isbn missing-field",children:"Missing ISBN"})]})]},x.id)})})]})})}),s&&o.jsxs("div",{className:"manga-floating-actions",children:[o.jsxs("button",{className:"manga-btn",type:"button","aria-label":"Add item",onClick:()=>is(l==="wishlist"?"wishlist":"library"),children:["+ ",l==="wishlist"?"Wishlist":"Library"]}),o.jsxs("div",{className:"manga-export-actions",children:[n&&o.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>Wr({library:w,wishlist:C},"manga-library-wishlist.json"),children:"Export JSON"}),o.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>jr(l==="library"?w:C,l==="library"?"manga-library.csv":"manga-wishlist.csv"),children:"Export CSV"}),o.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>Ks(l==="library"?w:C,l==="library"?"manga-library-images.zip":"manga-wishlist-images.zip"),children:"Download Images"})]})]}),me&&o.jsx("div",{className:"manga-modal-backdrop visible",onClick:x=>{x.target===x.currentTarget&&zn()},children:o.jsxs("div",{className:"manga-modal",children:[o.jsxs("div",{className:"manga-modal-cover-wrap",children:[me.kind==="library"&&me.read&&o.jsx("div",{className:"manga-modal-read-pill",children:"Read"}),o.jsx("img",{src:me.cover||"https://imgur.com/chUgq4W.png",alt:"Cover"})]}),o.jsxs("div",{className:"manga-modal-body",children:[o.jsxs("div",{className:"manga-modal-header",children:[o.jsx("div",{className:"manga-modal-title",children:me.title||"Untitled"}),o.jsx("button",{className:"manga-modal-close",onClick:zn,type:"button","aria-label":"Close",children:"X"})]}),o.jsxs("div",{className:"manga-modal-meta",children:[me.authors&&me.authors!=="Unknown"&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"Author(s):"})," ",me.authors,o.jsx("br",{})]}),me.publisher&&me.publisher!=="Unknown"&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"Publisher:"})," ",me.publisher,o.jsx("br",{})]}),me.date&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"Release:"})," ",me.date,o.jsx("br",{})]}),me.isbn&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"ISBN:"})," ",me.isbn,o.jsx("br",{})]})]}),o.jsxs("div",{className:"manga-modal-details",children:[me.pageCount&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"Pages:"})," ",me.pageCount,o.jsx("br",{})]}),o.jsxs("div",{style:{margin:"6px 0"},children:[o.jsx("strong",{children:"Rating:"})," ",o.jsx(Is,{value:me.rating||"",onChange:s?x=>qs(me,x):void 0,interactive:s})]}),me.amountPaid&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"Amount Paid:"})," $",me.amountPaid,o.jsx("br",{})]}),me.msrp&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"MSRP:"})," $",me.msrp,o.jsx("br",{})]}),me.collectiblePrice&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"Collectible:"})," $",me.collectiblePrice,o.jsx("br",{})]}),me.read&&me.dateRead&&o.jsxs(o.Fragment,{children:[o.jsx("strong",{children:"Date Read:"})," ",me.dateRead,o.jsx("br",{})]}),me.amazonURL&&o.jsx("div",{style:{marginTop:"6px"},children:o.jsx("a",{href:me.amazonURL,target:"_blank",rel:"noreferrer",children:"View on Amazon"})})]}),o.jsxs("div",{className:"manga-modal-footer",style:{gap:"10px",alignItems:"center"},children:[o.jsx("div",{children:me.kind==="library"&&me.read?"Marked as read in your library.":me.kind==="library"?"In your library (unread).":"Wishlist item - not in library yet."}),o.jsxs("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:[s&&o.jsx("button",{className:"manga-btn mini secondary",type:"button",onClick:()=>Ss(me),children:"Edit"}),me.kind==="library"&&s&&o.jsx(o.Fragment,{children:me.read?o.jsx("button",{className:"manga-btn mini secondary",disabled:Rr,onClick:()=>vr(me,!1),type:"button",children:"Mark as unread"}):o.jsx("button",{className:"manga-btn mini",disabled:Rr,onClick:()=>vr(me,!0),type:"button",children:"Mark as read"})}),s&&o.jsxs("button",{className:"manga-btn mini",type:"button",onClick:()=>Ys(me),children:["Move to ",me.kind==="library"?"Wishlist":"Library"]}),s&&o.jsx("button",{className:"manga-btn mini danger",type:"button",onClick:()=>Xn(me.id,me.kind==="library"?"library":"wishlist"),children:"Delete"})]})]})]})]})}),s&&Ce.open&&o.jsx("div",{className:"manga-modal-backdrop visible",onClick:x=>{x.target===x.currentTarget&&Nn()},children:o.jsx("div",{className:"manga-modal admin",children:o.jsxs("div",{className:"manga-modal-body",children:[o.jsxs("div",{className:"manga-modal-header",children:[o.jsx("div",{className:"manga-modal-title",children:Ce.mode==="add"?"Add Entry":"Edit Entry"}),o.jsx("button",{className:"manga-modal-close",onClick:Nn,type:"button","aria-label":"Close",children:"X"})]}),o.jsxs("div",{className:"admin-form-layout",children:[o.jsx("div",{className:"admin-cover-frame",children:o.jsx("img",{src:Ce.data.cover||"https://imgur.com/chUgq4W.png",alt:"Cover preview"})}),o.jsxs("div",{className:"admin-form-fields",children:[o.jsx("div",{className:"admin-row",children:o.jsxs("label",{children:["Title",o.jsx("input",{type:"text",value:Ce.data.title,onChange:x=>Pt("title",x.target.value)})]})}),F.length>0&&o.jsx("div",{className:"title-suggestions",children:F.map((x,z)=>o.jsx("button",{type:"button",className:"manga-btn mini",onClick:()=>Pt("title",x),children:x},x+z))}),o.jsxs("div",{className:"admin-row two",style:{alignItems:"flex-end",marginTop:"-8px"},children:[o.jsxs("div",{children:[o.jsxs("div",{className:"manga-modal-subtitle",style:{marginBottom:"6px"},children:["Entry ",_e+1," / ",Math.max(1,ce.length||1)]}),o.jsxs("div",{style:{display:"flex",gap:"8px"},children:[o.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>_e>0&&yr(_e-1),disabled:_e===0,children:"Previous"}),o.jsx("button",{className:"manga-btn secondary",type:"button",onClick:()=>ce.length&&_e<ce.length-1?yr(_e+1):null,disabled:!ce.length||_e===ce.length-1,children:"Next"})]})]}),o.jsxs("div",{style:{textAlign:"right"},children:[o.jsx("button",{className:"manga-btn",type:"button",onClick:bs,disabled:!kt(Ce.data.title||"").vol,children:"Add New Volume"}),o.jsx("div",{className:"manga-stat-sub",style:{marginTop:"4px"},children:"Auto-fills the next volume number for this series."})]})]}),o.jsx("div",{className:"admin-row",children:o.jsxs("label",{className:k.author?"missing-field-input":"",children:["Authors",o.jsx("input",{type:"text",value:Ce.data.authors,onChange:x=>Pt("authors",x.target.value)})]})}),o.jsx("div",{className:"admin-row",children:o.jsxs("label",{className:k.publisher?"missing-field-input":"",children:["Publisher",o.jsx("input",{type:"text",value:Ce.data.publisher,onChange:x=>Pt("publisher",x.target.value)})]})}),o.jsxs("div",{className:"admin-row three",children:[o.jsxs("label",{className:k.date?"missing-field-input":"",children:["Release Date",o.jsx("input",{type:"date",value:Ce.data.date,onChange:x=>Pt("date",x.target.value)})]}),o.jsxs("label",{className:k.purchaseDate?"missing-field-input":"",children:["Purchase Date",o.jsx("input",{type:"date",value:Ce.data.datePurchased,onChange:x=>Pt("datePurchased",x.target.value)})]}),!dt&&o.jsxs("label",{children:["Date Read",o.jsx("input",{type:"date",value:Ce.data.dateRead,onChange:x=>Pt("dateRead",x.target.value)})]})]}),o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{className:k.page?"missing-field-input":"",children:["Page Count",o.jsx("input",{type:"number",placeholder:"e.g. 192",value:Ce.data.pageCount,onChange:x=>Pt("pageCount",x.target.value)})]}),!dt&&o.jsxs("label",{className:k.isbn?"missing-field-input":"",children:["ISBN (library only)",o.jsx("input",{type:"text",value:Ce.data.isbn,onChange:x=>Pt("isbn",x.target.value)})]})]}),o.jsx("div",{className:"admin-row",children:o.jsxs("label",{children:["Cover URL",o.jsx("input",{type:"text",placeholder:"Paste image URL here",value:Ce.data.cover,onChange:x=>Pt("cover",x.target.value)})]})}),!dt&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"admin-row two",children:[!(Ce.data.special&&Ce.data.specialType==="collectible")&&o.jsxs("label",{className:k.amountPaid?"missing-field-input":"",children:["Amount Paid",o.jsx("input",{type:"number",step:"0.01",value:Ce.data.amountPaid,onChange:x=>Pt("amountPaid",x.target.value)})]}),o.jsxs("label",{className:k.msrp?"missing-field-input":"",children:["MSRP",o.jsx("input",{type:"number",step:"0.01",value:Ce.data.msrp,onChange:x=>Pt("msrp",x.target.value)})]})]}),o.jsx("div",{className:"admin-row",children:o.jsxs("label",{className:"checkbox-row",children:[o.jsx("input",{type:"checkbox",checked:!!Ce.data.special,onChange:x=>Pt("special",x.target.checked,"checkbox")}),o.jsx("span",{children:"Special item?"})]})}),Ce.data.special&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{children:["Special Type",o.jsxs("select",{value:Ce.data.specialType,onChange:x=>Pt("specialType",x.target.value),children:[o.jsx("option",{value:"",children:"Select type"}),o.jsx("option",{value:"specialEdition",children:"Special Edition"}),o.jsx("option",{value:"collectible",children:"Collectible"})]})]}),Ce.data.specialType==="collectible"&&o.jsxs("label",{className:k.collectiblePrice?"missing-field-input":"",children:["Collectible Price",o.jsx("input",{type:"number",step:"0.01",value:Ce.data.collectiblePrice,onChange:x=>Pt("collectiblePrice",x.target.value)})]})]}),Ce.data.specialType==="specialEdition"&&o.jsx("div",{className:"admin-row",children:o.jsxs("label",{children:["Special Volumes",o.jsx("input",{type:"number",min:"0",value:Ce.data.specialVolumes,onChange:x=>Pt("specialVolumes",x.target.value)})]})})]})]}),dt&&o.jsx("div",{className:"admin-row",children:o.jsxs("label",{children:["Amazon URL",o.jsx("input",{type:"text",value:Ce.data.amazonURL,onChange:x=>Pt("amazonURL",x.target.value)})]})}),!dt&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"admin-row",children:o.jsxs("label",{children:["Rating (1-5 stars)",o.jsx(Is,{value:Ce.data.rating,onChange:x=>Pt("rating",x)})]})}),o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{className:"checkbox-inline",children:[o.jsx("input",{type:"checkbox",checked:Ce.data.read,onChange:x=>Pt("read",x.target.checked,"checkbox")}),o.jsx("span",{children:"Mark as read"})]}),o.jsxs("label",{className:"checkbox-inline",children:[o.jsx("input",{type:"checkbox",checked:!!Ce.data.hidden,onChange:x=>Pt("hidden",x.target.checked,"checkbox")}),o.jsx("span",{children:"Hide from public"})]})]})]}),dt&&o.jsx("div",{className:"admin-row",children:o.jsxs("label",{className:"checkbox-inline",children:[o.jsx("input",{type:"checkbox",checked:!!Ce.data.hidden,onChange:x=>Pt("hidden",x.target.checked,"checkbox")}),o.jsx("span",{children:"Hide from public"})]})})]})]}),o.jsxs("div",{className:"manga-modal-footer",style:{justifyContent:"flex-end",gap:"10px"},children:[o.jsx("button",{className:"manga-btn secondary",onClick:Nn,type:"button",children:"Cancel"}),o.jsx("button",{className:"manga-btn",onClick:Jn,type:"button",children:Ce.mode==="add"?"Add":"Save"})]})]})})}),s&&H.open&&o.jsx("div",{className:"manga-modal-backdrop visible",onClick:x=>{x.target===x.currentTarget&&Ar()},children:o.jsx("div",{className:"manga-modal admin",children:o.jsxs("div",{className:"manga-modal-body",children:[o.jsxs("div",{className:"manga-modal-header",children:[o.jsxs("div",{className:"manga-modal-title",children:["Bulk Edit (",H.index+1," / ",H.items.length,")"]}),o.jsx("button",{className:"manga-modal-close",onClick:Ar,type:"button","aria-label":"Close",children:"X"})]}),H.items.length>0&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"manga-modal-subtitle",children:["Editing: ",H.items[H.index].data.title||"Untitled"]}),o.jsxs("div",{className:"admin-form-grid two-col",children:[o.jsx("div",{className:"admin-cover",children:o.jsx("div",{className:"manga-card-cover-wrap",children:o.jsx("img",{src:H.items[H.index].data.cover||"https://imgur.com/chUgq4W.png",alt:H.items[H.index].data.title||"Cover",loading:"lazy",decoding:"async"})})}),o.jsxs("div",{className:"admin-fields",children:[o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{className:"full",children:["Title",o.jsx("input",{type:"text",value:H.items[H.index].data.title,onChange:x=>Ze("title",x.target.value)})]}),o.jsxs("div",{className:"admin-entry-info",children:["Entry ",H.index+1," / ",H.items.length]})]}),o.jsx("div",{className:"admin-row",children:o.jsxs("label",{className:pn.author?"missing-field-input":"",children:["Authors",o.jsx("input",{type:"text",value:H.items[H.index].data.authors,onChange:x=>Ze("authors",x.target.value)})]})}),o.jsx("div",{className:"admin-row",children:o.jsxs("label",{className:pn.publisher?"missing-field-input":"",children:["Publisher",o.jsx("input",{type:"text",value:H.items[H.index].data.publisher,onChange:x=>Ze("publisher",x.target.value)})]})}),o.jsxs("div",{className:"admin-row three",children:[o.jsxs("label",{className:pn.date?"missing-field-input":"",children:["Release Date",o.jsx("input",{type:"date",value:H.items[H.index].data.date,onChange:x=>Ze("date",x.target.value)})]}),o.jsxs("label",{className:pn.purchaseDate?"missing-field-input":"",children:["Purchase Date",o.jsx("input",{type:"date",value:H.items[H.index].data.datePurchased,onChange:x=>Ze("datePurchased",x.target.value)})]}),!fn&&o.jsxs("label",{children:["Date Read",o.jsx("input",{type:"date",value:H.items[H.index].data.dateRead,onChange:x=>Ze("dateRead",x.target.value)})]})]}),o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{className:pn.page?"missing-field-input":"",children:["Page Count",o.jsx("input",{type:"number",value:H.items[H.index].data.pageCount,onChange:x=>Ze("pageCount",x.target.value)})]}),!fn&&o.jsxs("label",{className:pn.isbn?"missing-field-input":"",children:["ISBN (library only)",o.jsx("input",{type:"text",value:H.items[H.index].data.isbn,onChange:x=>Ze("isbn",x.target.value)})]})]}),o.jsx("div",{className:"admin-row",children:o.jsxs("label",{children:["Cover URL",o.jsx("input",{type:"text",value:H.items[H.index].data.cover,onChange:x=>Ze("cover",x.target.value)})]})}),!fn&&o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{className:pn.amountPaid?"missing-field-input":"",children:["Amount Paid",o.jsx("input",{type:"number",step:"0.01",value:H.items[H.index].data.amountPaid,onChange:x=>Ze("amountPaid",x.target.value)})]}),o.jsxs("label",{className:pn.msrp?"missing-field-input":"",children:["MSRP",o.jsx("input",{type:"number",step:"0.01",value:H.items[H.index].data.msrp,onChange:x=>Ze("msrp",x.target.value)})]})]}),!fn&&o.jsx("div",{className:"admin-row two",children:o.jsxs("div",{children:[o.jsx("div",{className:"star-label",children:"Rating (1-5 stars)"}),o.jsx(Is,{value:H.items[H.index].data.rating,onChange:x=>Ze("rating",x)})]})}),!fn&&o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{className:"checkbox-row",children:[o.jsx("input",{type:"checkbox",checked:!!H.items[H.index].data.special,onChange:x=>Ze("special",x.target.checked,"checkbox")}),o.jsx("span",{children:"Special item?"})]}),o.jsxs("label",{className:"checkbox-row",children:[o.jsx("input",{type:"checkbox",checked:H.items[H.index].data.read,onChange:x=>Ze("read",x.target.checked,"checkbox")}),o.jsx("span",{children:"Mark as read"})]})]}),H.items[H.index].data.special&&!fn&&o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{children:["Special Type",o.jsxs("select",{value:H.items[H.index].data.specialType,onChange:x=>Ze("specialType",x.target.value),children:[o.jsx("option",{value:"",children:"Select type"}),o.jsx("option",{value:"specialEdition",children:"Special Edition"}),o.jsx("option",{value:"collectible",children:"Collectible"})]})]}),H.items[H.index].data.specialType==="specialEdition"&&o.jsxs("label",{children:["Special Volumes",o.jsx("input",{type:"number",value:H.items[H.index].data.specialVolumes,onChange:x=>Ze("specialVolumes",x.target.value)})]}),H.items[H.index].data.specialType==="collectible"&&o.jsxs("label",{className:pn.collectiblePrice?"missing-field-input":"",children:["Collectible Price",o.jsx("input",{type:"number",step:"0.01",value:H.items[H.index].data.collectiblePrice,onChange:x=>Ze("collectiblePrice",x.target.value)})]})]}),fn&&o.jsxs("div",{className:"admin-row two",children:[o.jsxs("label",{children:["Amazon URL",o.jsx("input",{type:"text",value:H.items[H.index].data.amazonURL,onChange:x=>Ze("amazonURL",x.target.value)})]}),o.jsxs("label",{className:"checkbox-row",children:[o.jsx("input",{type:"checkbox",checked:!!H.items[H.index].data.hidden,onChange:x=>Ze("hidden",x.target.checked,"checkbox")}),o.jsx("span",{children:"Hidden from public"})]})]}),!fn&&o.jsx("div",{className:"admin-row",children:o.jsxs("label",{className:"checkbox-row",children:[o.jsx("input",{type:"checkbox",checked:!!H.items[H.index].data.hidden,onChange:x=>Ze("hidden",x.target.checked,"checkbox")}),o.jsx("span",{children:"Hidden from public"})]})})]})]}),o.jsxs("div",{className:"manga-modal-footer",style:{justifyContent:"space-between",gap:"10px"},children:[o.jsxs("div",{children:[o.jsx("button",{className:"manga-btn secondary",onClick:An,type:"button",disabled:H.index===0,children:"Previous"}),o.jsx("button",{className:"manga-btn secondary",onClick:er,type:"button",disabled:H.index===H.items.length-1,style:{marginLeft:"6px"},children:"Next"})]}),o.jsxs("div",{style:{display:"flex",gap:"8px"},children:[o.jsx("button",{className:"manga-btn secondary",onClick:Ar,type:"button",children:"Cancel"}),o.jsx("button",{className:"manga-btn",onClick:as,type:"button",children:"Save Edits"})]})]})]})]})})}),Ct&&o.jsx(px,{open:De,title:"Suggest a Manga",placeholder:"Type a manga you'd like me to collect/read...",value:Oe,status:st,loading:ue,onChange:Qe,onSubmit:v,onClose:()=>ke(!1)}),o.jsx("datalist",{id:"adminTitleSuggestions",children:X.map(x=>o.jsx("option",{value:x},x))})]})}const fR="https://imokmalworker.imokissick.workers.dev/?url=",yx="im_ok",v_=300,pR={1:"watching",2:"completed",3:"on_hold",4:"dropped",6:"plan_to_watch"};function mR(n){const e=n==null?void 0:n.title_localized,t=typeof e=="string"?e:(e==null?void 0:e.en)||(e==null?void 0:e.english);return(n==null?void 0:n.anime_title_eng)||(n==null?void 0:n.title_english)||t||(n==null?void 0:n.anime_title)||(n==null?void 0:n.title)||"Untitled"}function gR(n){const e=(n==null?void 0:n.updated_at)??(n==null?void 0:n.updatedAt)??(n==null?void 0:n.updated_at_ms)??null;if(e==null)return null;const t=Number(e);if(Number.isFinite(t))return t<1e12?t*1e3:t;const s=Date.parse(e);return Number.isNaN(s)?null:s}function yR(n){const e=pR[n.status]||(typeof n.status=="string"?n.status.toLowerCase():"unknown");return{id:n.anime_id||n.id,title:mR(n),updatedAt:gR(n),episodes:n.anime_num_episodes??n.episodes??null,watchedEpisodes:n.num_watched_episodes??n.my_watched_episodes??n.watched_episodes??n.num_watched??0,status:e,score:n.score??null,image:n.anime_image_path||n.image_url||n.anime_img||n.picture||null,synopsis:n.anime_synopsis||n.synopsis||null}}function __(){const n=Date.now();return[{id:1,title:"Cowboy Bebop",episodes:26,status:"completed",score:10,updatedAt:n-1e3*60*60*24*3,synopsis:"In 2071, bounty hunters Spike and Jet roam the solar system looking for their next payout and a place to belong."},{id:2,title:"Fullmetal Alchemist: Brotherhood",episodes:64,status:"completed",score:10,updatedAt:n-1e3*60*60*24*6,synopsis:"Brothers Edward and Alphonse Elric search for the Philosopher's Stone to restore their bodies after a failed alchemy ritual."},{id:3,title:"Frieren: Beyond Journey's End",episodes:28,status:"watching",score:9,updatedAt:n-1e3*60*60*8,synopsis:"An elven mage retraces the steps of a past adventure to understand humanity and the passage of time."},{id:4,title:"One Piece",episodes:1e3,status:"on_hold",score:8,updatedAt:n-1e3*60*60*24*14,synopsis:"Monkey D. Luffy sails toward the Grand Line seeking the One Piece and a crew to make his dream real."},{id:5,title:"Kaiju No. 8",episodes:12,status:"plan_to_watch",score:null,updatedAt:n-1e3*60*30,synopsis:"A middle-aged worker gains kaiju powers and joins the Defense Force to fight monsters from the inside."}]}async function vR(n,e){const t=`https://myanimelist.net/animelist/${n}/load.json?status=7&offset=${e}`,s=await fetch(`${fR}${encodeURIComponent(t)}`);if(!s.ok)throw new Error(`Failed to fetch MAL list (offset ${e})`);return s.json()}async function _R(n=yx){const e=[];try{let t=0;for(;;){const s=await vR(n,t);if(!Array.isArray(s)||s.length===0||(e.push(...s),s.length<v_))break;t+=v_}}catch(t){return console.error("Failed to load MAL list; falling back to sample data.",t),__()}return e.length?e.map(yR):__()}async function wR(n){var e,t;if(!n)return null;try{const s=await fetch(`https://api.jikan.moe/v4/anime/${n}`);if(!s.ok)throw new Error(`Failed to fetch Jikan summary for id ${n}`);const a=await s.json();return((e=a==null?void 0:a.data)==null?void 0:e.synopsis)||((t=a==null?void 0:a.data)==null?void 0:t.background)||null}catch(s){return console.error("Failed to load anime synopsis",n,s),null}}async function xR(n=yx){var e;if(!n)return null;try{const t=await fetch(`https://api.jikan.moe/v4/users/${encodeURIComponent(n)}/statistics`);if(!t.ok)throw new Error(`Failed to fetch user stats for ${n}`);const s=await t.json(),a=((e=s==null?void 0:s.data)==null?void 0:e.anime)||{},l=Number(a.days_watched),d=Number(a.total_episodes??a.episodes_watched);return{daysWatched:Number.isFinite(l)?l:null,episodesWatched:Number.isFinite(d)?d:null}}catch(t){return console.error("Failed to load user stats",n,t),null}}const w_=5,ER=3600*1e3,x_="animeSuggestionsSent";function TR(){const{admin:n,user:e,role:t}=Ba(),s=ue=>ue?ue.toString().replace(/_/g," ").replace(/\b\w/g,Ve=>Ve.toUpperCase()):"Unknown",[a,l]=j.useState([]),[d,f]=j.useState([]),[m,v]=j.useState(""),[w,T]=j.useState("all"),[C,U]=j.useState(!0),[X,q]=j.useState(""),[F,ie]=j.useState(null),[Se,Ee]=j.useState({}),[we,V]=j.useState(!1),[ae,I]=j.useState(!1),[P,A]=j.useState(null),[M,D]=j.useState(!1),[N,b]=j.useState(""),[J,re]=j.useState(""),[Ce,de]=j.useState(!1);j.useEffect(()=>{document.title="Anime | Library"},[]),j.useEffect(()=>{re("")},[e]);const ce=ue=>{if(!ue)return"";const Ve=Date.now()-ue,me=Math.max(Ve,0),He=Math.floor(me/6e4);if(He<1)return"just now";if(He<60)return`${He}m ago`;const Ye=Math.floor(He/60);if(Ye<48)return`${Ye}h ago`;const Tt=Math.floor(Ye/24);if(Tt<14)return`${Tt}d ago`;const Ct=Math.floor(Tt/7);return Ct<8?`${Ct}w ago`:`${Math.floor(Tt/30)}mo ago`},Ne=(ue,Ve="image")=>(ue||"").toString().toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"").slice(0,80)||Ve,_e=async()=>{const ue=a.filter(Ve=>Ve.image).map((Ve,me)=>({url:Ve.image,name:Ne(Ve.title||`anime-${me+1}`,`anime-${me+1}`)}));if(!ue.length){alert("No images found to download.");return}try{const Ve=(await pc(async()=>{const{default:Nt}=await import("https://cdn.jsdelivr.net/npm/jszip@3.10.1/+esm");return{default:Nt}},[])).default,me=new Ve,He=me.folder("images"),Ye={};await Promise.all(ue.map(async(Nt,Yt)=>{try{const nn=await(await fetch(Nt.url)).blob(),ur=(Nt.url.split(".").pop()||"jpg").split(/[?#]/)[0],rn=Nt.name||`image-${Yt+1}`;Ye[rn]=(Ye[rn]||0)+1;const Yn=Ye[rn]>1?`-${Ye[rn]}`:"";He.file(`${rn}${Yn}.${ur}`,nn)}catch(tn){console.warn("Failed to fetch image",Nt.url,tn)}}));const Tt=await me.generateAsync({type:"blob"}),Ct=URL.createObjectURL(Tt),gt=document.createElement("a");gt.href=Ct,gt.download="anime-images.zip",gt.click(),URL.revokeObjectURL(Ct)}catch(Ve){console.error("Zip download failed",Ve),alert("Failed to create zip. Please try again.")}};j.useEffect(()=>{async function ue(){try{const Ve=await _R();l(Ve),f(Ve)}catch(Ve){console.error(Ve),q("Failed to load data from MAL.")}finally{U(!1)}}ue()},[]),j.useEffect(()=>{xR().then(ue=>{ue&&A(ue)}).catch(()=>{})},[]);const Y=ue=>{switch((ue||"unknown").toLowerCase()){case"watching":return 0;case"completed":return 1;case"on_hold":return 2;case"plan_to_watch":return 3;case"dropped":return 4;default:return 5}},k=ue=>{const Ve=Number.isFinite(Number(ue.watchedEpisodes))?Number(ue.watchedEpisodes):0,me=Number.isFinite(Number(ue.episodes))?Number(ue.episodes):null;return me?`${Math.min(Ve,me)}/${me} eps`:Ve?`${Ve} eps`:"No progress"};j.useEffect(()=>{let ue=[...a];if(w!=="all"&&(ue=ue.filter(Ve=>(Ve.status||"").toLowerCase()===w)),m){const Ve=m.toLowerCase();ue=ue.filter(me=>(me.title||"").toLowerCase().includes(Ve))}ue.sort((Ve,me)=>{const He=Y(Ve.status),Ye=Y(me.status);return He!==Ye?He-Ye:(Ve.title||"").localeCompare(me.title||"")}),f(ue)},[a,w,m]);const H=j.useMemo(()=>[...a].filter(ue=>Number.isFinite(ue.updatedAt)).sort((ue,Ve)=>Ve.updatedAt-ue.updatedAt).slice(0,6),[a]),Te=!!e&&t==="viewer",De=async()=>{const ue=Date.now(),me=(()=>{try{const He=localStorage.getItem(x_);return Array.isArray(JSON.parse(He))?JSON.parse(He):[]}catch{return[]}})().filter(He=>ue-He<ER);if(me.length>=w_){re("Rate limit: please wait a bit (max 5 suggestions per hour).");return}if(!N.trim()){re("Please enter a title or note before sending.");return}de(!0),re("");try{const He=`**Anime Suggestion**
${N.trim()}
From: ${(e==null?void 0:e.displayName)||(e==null?void 0:e.email)||(e==null?void 0:e.uid)||"anonymous user"}`;await Aa(Cn(ot,"suggestions"),{content:N.trim(),type:"anime",from:(e==null?void 0:e.displayName)||(e==null?void 0:e.email)||(e==null?void 0:e.uid)||"anonymous user",createdAt:new Date().toISOString()}),re("Sent! I'll review your suggestion soon."),b("");const Ye=[...me,ue].slice(-w_);localStorage.setItem(x_,JSON.stringify(Ye))}catch(He){console.error("Failed to send suggestion",He),re("Failed to send suggestion. Please try again later.")}finally{de(!1)}};j.useEffect(()=>{if(!F){I(!1),V(!1);return}I(!!F.synopsis),V(!1)},[F==null?void 0:F.id]);const ke=j.useMemo(()=>{const ue=a.length,Ve=a.reduce((Ct,gt)=>{const Nt=Number(gt.watchedEpisodes);return Number.isFinite(Nt)?Ct+Nt:Ct},0),me=Ve*.4,He=a.filter(Ct=>Number.isFinite(Ct.score)&&Ct.score>0),Ye=He.reduce((Ct,gt)=>Ct+gt.score,0),Tt={watching:0,completed:0,on_hold:0,dropped:0,plan_to_watch:0,unknown:0};return a.forEach(Ct=>{const gt=(Ct.status||"unknown").toLowerCase();Tt[gt]!=null?Tt[gt]+=1:Tt.unknown+=1}),{total:ue,totalWatchedEpisodes:Ve,byStatus:Tt,avgScore:He.length?Ye/He.length:0,totalHours:me}},[a]),Oe=(P==null?void 0:P.daysWatched)??(ke.totalHours||0)/24,Qe=(P==null?void 0:P.episodesWatched)??ke.totalWatchedEpisodes,st=ue=>{const Ve=ue.image||"https://imgur.com/chUgq4W.png",me=Number.isFinite(Number(ue.watchedEpisodes))?Number(ue.watchedEpisodes):0,He=Number.isFinite(Number(ue.episodes))?Number(ue.episodes):null,Ye=He?`Episode ${Math.min(me,He)}/${He}`:`Episode ${me}`,Tt=Number.isFinite(Number(ue.score))&&Number(ue.score)>0?ue.score:"Not rated";return o.jsxs("article",{className:"anime-card",onClick:()=>ie(ue.synopsis?ue:{...ue,synopsis:Se[ue.id]}),children:[o.jsxs("div",{className:"anime-cover-wrap",children:[o.jsx("img",{className:"anime-cover",src:Ve,alt:ue.title,loading:"lazy",decoding:"async"}),o.jsx("div",{className:`badge-status ${(ue.status||"unknown").toLowerCase()}`,children:s(ue.status)}),ue.score!=null&&o.jsx("div",{className:"badge-score",children:Tt})]}),o.jsxs("div",{className:"anime-meta",children:[o.jsx("div",{className:"anime-title",title:ue.title,children:ue.title}),o.jsx("div",{className:"anime-sub",children:ue.episodes?`${ue.episodes} episodes`:"Episodes: ?"}),o.jsx("div",{className:"anime-progress",children:Ye}),o.jsxs("div",{className:"anime-progress",children:["Status: ",s(ue.status)]})]})]},ue.id||ue.title)},ve=ue=>o.jsxs("article",{className:"anime-update-card",children:[o.jsx("div",{className:"anime-update-title",title:ue.title,children:ue.title}),o.jsxs("div",{className:"anime-update-meta",children:[o.jsx("span",{className:"anime-update-progress",children:k(ue)}),o.jsx("span",{className:"anime-update-dot","aria-hidden":"true",children:""}),o.jsx("span",{className:"anime-update-status",children:s(ue.status)})]}),o.jsx("div",{className:"anime-update-time",children:ce(ue.updatedAt)})]},`update-${ue.id||ue.title}`);return o.jsxs("main",{className:"anime-page",children:[o.jsxs("div",{className:"anime-content",children:[o.jsxs("header",{className:"anime-header",style:{position:"relative",display:"flex",justifyContent:"center",alignItems:"center",textAlign:"center",width:"100%"},children:[o.jsxs("div",{style:{textAlign:"center",margin:"0 auto",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"0 60px"},children:[o.jsx("h1",{className:"anime-title",style:{margin:0,fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Tyler's Anime Library"}),o.jsx("p",{className:"anime-sub",style:{textAlign:"center",margin:"6px 0 0"},children:"The Anime I've watched/watching synced directly from MAL (MyAnimeList)"})]}),(Te||n)&&o.jsxs("div",{style:{position:"absolute",right:0,top:"50%",transform:"translateY(-50%)",display:"flex",gap:"10px"},children:[Te&&o.jsx("button",{className:"suggestion-trigger",type:"button",onClick:()=>{re(""),D(!0)},children:"+ Suggestion"}),n&&o.jsx("button",{className:"stat-link",type:"button",onClick:_e,children:"Download Images"})]})]}),o.jsxs("div",{className:"anime-stats",children:[o.jsxs("div",{className:"anime-stat-card",children:[o.jsx("div",{className:"anime-stat-label",children:"Total Entries"}),o.jsx("div",{className:"anime-stat-value",children:ke.total})]}),o.jsxs("div",{className:"anime-stat-card",children:[o.jsx("div",{className:"anime-stat-label",children:"Episodes Watched"}),o.jsx("div",{className:"anime-stat-value",children:Qe})]}),o.jsxs("div",{className:"anime-stat-card",children:[o.jsx("div",{className:"anime-stat-label",children:"Watching"}),o.jsx("div",{className:"anime-stat-value",children:ke.byStatus.watching})]}),o.jsxs("div",{className:"anime-stat-card",children:[o.jsx("div",{className:"anime-stat-label",children:"Completed"}),o.jsx("div",{className:"anime-stat-value",children:ke.byStatus.completed})]}),o.jsxs("div",{className:"anime-stat-card",children:[o.jsx("div",{className:"anime-stat-label",children:"Plan to Watch"}),o.jsx("div",{className:"anime-stat-value",children:ke.byStatus.plan_to_watch})]}),o.jsxs("div",{className:"anime-stat-card",children:[o.jsx("div",{className:"anime-stat-label",children:"Avg. Score"}),o.jsx("div",{className:"anime-stat-value",children:ke.avgScore?ke.avgScore.toFixed(1):"0.0"})]}),o.jsxs("div",{className:"anime-stat-card",children:[o.jsx("div",{className:"anime-stat-label",children:"Days Watched"}),o.jsx("div",{className:"anime-stat-value",children:Oe.toFixed(1)})]})]}),o.jsxs("section",{className:"anime-toolbar",children:[o.jsx("input",{type:"text",placeholder:"Search anime by title...",value:m,onChange:ue=>v(ue.target.value),className:"anime-input"}),o.jsxs("select",{value:w,onChange:ue=>T(ue.target.value),className:"anime-select",children:[o.jsx("option",{value:"all",children:"All statuses"}),o.jsx("option",{value:"watching",children:"Watching"}),o.jsx("option",{value:"completed",children:"Completed"}),o.jsx("option",{value:"on_hold",children:"On Hold"}),o.jsx("option",{value:"plan_to_watch",children:"Plan to Watch"}),o.jsx("option",{value:"dropped",children:"Dropped"})]})]}),C&&o.jsx("div",{className:"loading",children:"Loading anime list from MAL..."}),X&&o.jsx("div",{className:"error-state",children:X}),!C&&!X&&o.jsx(o.Fragment,{children:d.length===0?o.jsx("div",{className:"empty-state",children:"No results match your filters yet."}):o.jsx("section",{className:"anime-grid",children:d.map(ue=>st(ue))})})]}),H.length>0&&o.jsxs("aside",{className:"anime-updates-float",children:[o.jsxs("div",{className:"anime-updates-header",children:[o.jsx("h3",{children:"Recent Updates"}),o.jsx("span",{className:"anime-updates-caption",children:"Last list activity"})]}),o.jsx("div",{className:"anime-updates-list",children:H.map(ue=>ve(ue))})]}),Te&&o.jsx(px,{open:M,title:"Suggest an Anime",placeholder:"Type an anime you'd like me to watch...",value:N,status:J,loading:Ce,onChange:b,onSubmit:De,onClose:()=>D(!1)}),F&&o.jsx("div",{className:"modal-backdrop visible",onClick:ue=>{ue.target===ue.currentTarget&&ie(null)},children:o.jsxs("div",{className:"anime-modal",children:[o.jsxs("div",{className:"anime-modal-header",children:[o.jsx("h2",{style:{color:"#ffb6c1",margin:0},children:F.title}),o.jsx("button",{className:"anime-modal-close",onClick:()=>ie(null),type:"button","aria-label":"Close",children:"X"})]}),o.jsxs("div",{className:"anime-modal-body",children:[o.jsx("div",{children:o.jsx("img",{className:"anime-modal-cover",src:F.image||"https://imgur.com/chUgq4W.png",alt:F.title})}),o.jsxs("div",{className:"anime-modal-meta",children:[o.jsxs("div",{children:[o.jsx("strong",{children:"Status:"})," ",s(F.status)]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Episodes:"})," ",F.episodes?F.episodes:"Unknown"]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Progress:"})," ",Number.isFinite(Number(F.watchedEpisodes))?`Episode ${F.watchedEpisodes}${Number.isFinite(Number(F.episodes))?`/${F.episodes}`:""}`:"Unknown"]}),o.jsxs("div",{children:[o.jsx("strong",{children:"Score:"})," ",Number.isFinite(Number(F.score))&&Number(F.score)>0?F.score:"Not rated"]})]}),o.jsx(SR,{modalItem:F,modalLoading:we,modalSynopsisShown:ae,onReveal:async()=>{if(!F)return;I(!0);const ue=F.id;if(!ue)return;const Ve=Se[ue];if(Ve!==void 0){ie(me=>me&&{...me,synopsis:Ve});return}V(!0);try{const me=await wR(ue);Ee(He=>({...He,[ue]:me||""})),ie(He=>He&&{...He,synopsis:me||""})}catch{Ee(He=>({...He,[ue]:""})),ie(He=>He&&{...He,synopsis:""})}finally{V(!1)}}})]})]})})]})}function SR({modalItem:n,modalLoading:e,modalSynopsisShown:t,onReveal:s}){var m;const a=((m=n==null?void 0:n.synopsis)==null?void 0:m.trim())||"",[l,d]=j.useState(0),f=j.useRef(null);return j.useEffect(()=>{if(t&&f.current){const v=f.current.scrollHeight+12;d(v)}else d(0)},[t,a]),o.jsxs("div",{className:"anime-modal-summary",children:[o.jsxs("div",{className:"anime-modal-summary-header",children:[o.jsx("h3",{children:"Synopsis"}),!t&&o.jsx("button",{className:"anime-synopsis-btn",type:"button",onClick:s,children:e?"Loading...":"Reveal Synopsis"})]}),o.jsx("div",{className:`anime-modal-summary-body ${t?"is-open":""}`,style:{maxHeight:t?`${l}px`:0,opacity:t?1:0},children:o.jsx("div",{ref:f,children:o.jsx("p",{className:"anime-modal-summary-text",children:e&&!a?"Loading synopsis...":a||"No synopsis available."})})}),!t&&o.jsx("p",{className:"anime-modal-summary-text anime-modal-summary-hint",children:"Synopsis hidden. Click reveal to view."})]})}function bR(){const n={game:"pokemon",name:"",setName:"",number:"",rarity:"",condition:"",quantity:1,pricePaid:"",estimatedValue:"",image:"",productURL:"",notes:""},{admin:e,user:t}=Ba(),[s,a]=j.useState(()=>localStorage.getItem("tcgLastGame")||n.game),[l,d]=j.useState([]),[f,m]=j.useState(!0),[v,w]=j.useState(""),[T,C]=j.useState("all"),[U,X]=j.useState("name"),[q,F]=j.useState(!1),[ie,Se]=j.useState([]),[Ee,we]=j.useState(""),[V,ae]=j.useState(null),[I,P]=j.useState(!1),[A,M]=j.useState(()=>({...n,game:s}));j.useEffect(()=>{document.title="TCG | Collection"},[]),j.useEffect(()=>{let k=!1;const H=async()=>{if(!k)try{const ke=await fetch("/base/tcg-collection.json",{cache:"no-cache"});if(!ke.ok)throw new Error("fallback fetch failed");const Oe=await ke.json(),Qe=Array.isArray(Oe.tcg)?Oe.tcg:[];k||d(Qe.map((st,ve)=>({id:st.id||`offline-${ve}`,...st})))}catch(De){console.error("TCG offline fallback failed",De)}finally{k||m(!1)}};async function Te(){m(!0);try{const De=Cn(ot,"tcg"),ke=await _s(De),Oe=[];ke.forEach(Qe=>Oe.push({id:Qe.id,...Qe.data()})),k||d(Oe)}catch(De){console.error("Error loading TCG:",De),await H()}finally{k||m(!1)}}return Te(),()=>{k=!0}},[t]);const D=l.filter(k=>{if(T!=="all"&&k.game!==T)return!1;if(!v)return!0;const H=v.toLowerCase();return(k.name||"").toLowerCase().includes(H)||(k.setName||"").toLowerCase().includes(H)||(k.number||"").toLowerCase().includes(H)}),N=[...D].sort((k,H)=>{const Te=(k.name||"").toLowerCase(),De=(H.name||"").toLowerCase(),ke=(k.setName||"").toLowerCase(),Oe=(H.setName||"").toLowerCase(),Qe=(k.rarity||"").toLowerCase(),st=(H.rarity||"").toLowerCase(),ve=Number(k.quantity||0),ue=Number(H.quantity||0),Ve=Number(k.estimatedValue||0)*Math.max(1,ve),me=Number(H.estimatedValue||0)*Math.max(1,ue);switch(U){case"set":return ke.localeCompare(Oe)||Te.localeCompare(De);case"rarity":return Qe.localeCompare(st)||Te.localeCompare(De);case"quantity":return ue-ve||Te.localeCompare(De);case"value":return me-Ve||Te.localeCompare(De);case"name":default:return Te.localeCompare(De)}}),b=l.reduce((k,H)=>{const Te=Number(H.quantity||1),De=Number(H.pricePaid||0),ke=Number(H.estimatedValue||0);k.totalCards+=Te,k.totalPaid+=Te*De,k.totalValue+=Te*ke;const Oe=(H.game||"").toLowerCase(),Qe=Te*ke;return Oe==="pokemon"?(k.pokemon+=Te,k.valueByGame.pokemon+=Qe):Oe==="onepiece"?(k.onepiece+=Te,k.valueByGame.onepiece+=Qe):Oe==="mtg"?(k.mtg+=Te,k.valueByGame.mtg+=Qe):k.valueByGame.other+=Qe,k},{totalCards:0,totalPaid:0,totalValue:0,pokemon:0,onepiece:0,mtg:0,valueByGame:{pokemon:0,onepiece:0,mtg:0,other:0}}),J=b.totalValue-b.totalPaid,re=[["Pokemon",b.valueByGame.pokemon],["One Piece",b.valueByGame.onepiece],["MTG",b.valueByGame.mtg],["Other",b.valueByGame.other]].filter(([,k])=>k>0).map(([k,H])=>`${k}: $${H.toFixed(2)}`),Ce=re.length?re.join(`
`):"No value data yet",de=(k,H)=>{if(k==="game"){a(H);try{localStorage.setItem("tcgLastGame",H)}catch{}}M(Te=>({...Te,[k]:H}))},ce=async()=>{if(!e)return;if(!A.name.trim()){alert("Card name is required.");return}const k={game:A.game,name:A.name.trim(),setName:A.setName.trim(),number:A.number.trim(),rarity:A.rarity.trim(),condition:A.condition.trim(),quantity:Number(A.quantity||1),pricePaid:Number(A.pricePaid||0),estimatedValue:Number(A.estimatedValue||0),image:A.image.trim(),productURL:A.productURL.trim(),notes:A.notes.trim()},H=ke=>({game:(ke.game||"").toLowerCase().trim(),name:(ke.name||"").toLowerCase().trim(),setName:(ke.setName||"").toLowerCase().trim(),number:(ke.number||"").toLowerCase().trim(),rarity:(ke.rarity||"").toLowerCase().trim(),condition:(ke.condition||"").toLowerCase().trim(),pricePaid:Number(ke.pricePaid||0),estimatedValue:Number(ke.estimatedValue||0),image:(ke.image||"").trim(),productURL:(ke.productURL||"").trim(),notes:(ke.notes||"").trim()}),Te=H(k),De=l.find(ke=>{const Oe=H(ke);return Oe.game===Te.game&&Oe.name===Te.name&&Oe.setName===Te.setName&&Oe.number===Te.number&&Oe.rarity===Te.rarity&&Oe.condition===Te.condition&&Oe.pricePaid===Te.pricePaid&&Oe.estimatedValue===Te.estimatedValue&&Oe.image===Te.image&&Oe.productURL===Te.productURL&&Oe.notes===Te.notes});try{const ke=Cn(ot,"tcg");if(De!=null&&De.id){const Oe=Number(De.quantity||1)+k.quantity;await ws(Dt(ot,"tcg",De.id),{quantity:Oe}),d(Qe=>Qe.map(st=>st.id===De.id?{...st,quantity:Oe}:st))}else{await Aa(ke,k);const Oe=await _s(ke),Qe=[];Oe.forEach(st=>Qe.push({id:st.id,...st.data()})),d(Qe)}M({...n,game:s}),P(!1)}catch(ke){console.error("Error adding card:",ke),alert("Failed to save card.")}},Ne=async()=>{if(!e||!V)return;if(!V.name.trim()){alert("Card name is required.");return}const k={game:V.game,name:V.name.trim(),setName:V.setName.trim(),number:V.number.trim(),rarity:V.rarity.trim(),condition:V.condition.trim(),quantity:Number(V.quantity||1),pricePaid:Number(V.pricePaid||0),estimatedValue:Number(V.estimatedValue||0),image:V.image?V.image.trim():"",productURL:V.productURL?V.productURL.trim():"",notes:V.notes?V.notes.trim():""};try{await ws(Dt(ot,"tcg",V.id),k),d(H=>H.map(Te=>Te.id===V.id?{...Te,...k}:Te)),ae(null)}catch(H){console.error("Error updating card:",H),alert("Failed to update card.")}},_e=async k=>{if(e&&window.confirm("Delete this card?"))try{await Ra(Dt(ot,"tcg",k)),d(H=>H.filter(Te=>Te.id!==k))}catch(H){console.error("Delete error:",H),alert("Failed to delete card.")}},Y=()=>{if(!l.length){alert("No cards to export.");return}const k=new Blob([JSON.stringify({tcg:l},null,2)],{type:"application/json"}),H=URL.createObjectURL(k),Te=document.createElement("a");Te.href=H,Te.download="tcg-collection.json",Te.click(),URL.revokeObjectURL(H)};return o.jsxs("main",{className:"page",children:[o.jsxs("header",{style:{marginTop:"32px",marginBottom:"16px",display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",gap:"6px"},children:[o.jsx("h1",{style:{margin:0,fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Tyler's TCG Collection"}),o.jsx("p",{style:{margin:"6px 0 0",color:"var(--text-soft)",fontSize:"0.9rem"},children:"Check out my TCG Collection with all the data of how much I spent (Under construction) and how much my collection is worth in total!"}),e&&o.jsx("div",{style:{marginTop:"10px"},children:o.jsx("button",{className:"manga-btn secondary",type:"button",onClick:Y,children:"Export JSON"})})]}),e&&o.jsx("button",{className:"manga-btn",type:"button","aria-label":"Add card",onClick:()=>P(!0),style:{position:"fixed",bottom:"20px",right:"20px",zIndex:1e3,width:"56px",height:"56px",borderRadius:"50%",padding:0,fontSize:"28px",display:"flex",alignItems:"center",justifyContent:"center"},children:"+"}),e&&I&&o.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(8,1,10,0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,padding:"12px"},onClick:k=>{k.target===k.currentTarget&&P(!1)},children:o.jsxs("div",{style:{width:"min(720px, 95vw)",background:"#140710",border:"1px solid rgba(255,182,193,0.3)",borderRadius:"12px",padding:"14px",boxShadow:"0 24px 60px rgba(0,0,0,0.85)"},onClick:k=>k.stopPropagation(),children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx("h2",{style:{margin:0,color:"#ffb6c1"},children:"Add card"}),o.jsx("button",{className:"dashboard-close",onClick:()=>P(!1),type:"button","aria-label":"Close",children:"X"})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"180px 1fr",gap:"12px",alignItems:"flex-start",marginTop:"10px"},children:[o.jsx("div",{style:{width:"100%",maxWidth:"180px",borderRadius:"10px",border:"1px solid rgba(255,182,193,0.25)",background:"#1e0d14",overflow:"hidden",aspectRatio:"3 / 4",display:"flex",alignItems:"center",justifyContent:"center"},children:A.image?o.jsx("img",{src:A.image,alt:"Card preview",style:{width:"100%",height:"100%",objectFit:"cover"}}):o.jsx("div",{style:{color:"var(--text-soft)",fontSize:"0.8rem",padding:"6px"},children:"No image"})}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:"8px"},children:[o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Game",o.jsxs("select",{value:A.game,onChange:k=>de("game",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"},children:[o.jsx("option",{value:"pokemon",children:"Pokemon"}),o.jsx("option",{value:"onepiece",children:"One Piece"}),o.jsx("option",{value:"mtg",children:"MTG"})]})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Card name",o.jsx("input",{type:"text",value:A.name,onChange:k=>de("name",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Set name",o.jsx("input",{type:"text",value:A.setName,onChange:k=>de("setName",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Card number",o.jsx("input",{type:"text",value:A.number,onChange:k=>de("number",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Rarity",o.jsx("input",{type:"text",value:A.rarity,onChange:k=>de("rarity",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Condition",o.jsx("input",{type:"text",value:A.condition,onChange:k=>de("condition",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Quantity",o.jsx("input",{type:"number",min:"1",value:A.quantity,onChange:k=>de("quantity",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Price paid (per card)",o.jsx("input",{type:"number",step:"0.01",min:"0",value:A.pricePaid,onChange:k=>de("pricePaid",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Estimated value (per card)",o.jsx("input",{type:"number",step:"0.01",min:"0",value:A.estimatedValue,onChange:k=>de("estimatedValue",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Image URL",o.jsx("input",{type:"text",value:A.image||"",onChange:k=>de("image",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Product URL (backend only)",o.jsx("input",{type:"text",value:A.productURL||"",onChange:k=>de("productURL",k.target.value),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{gridColumn:"1 / -1",fontSize:"0.8rem",color:"var(--text-soft)"},children:["Notes",o.jsx("textarea",{value:A.notes,onChange:k=>de("notes",k.target.value),rows:3,style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff",resize:"vertical"}})]})]})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"12px"},children:[o.jsx("button",{onClick:()=>{M(n),P(!1)},style:{padding:"6px 12px",borderRadius:"999px",border:"1px solid rgba(255,182,193,0.5)",background:"transparent",color:"#ffb6c1",cursor:"pointer"},children:"Cancel"}),o.jsx("button",{onClick:ce,style:{padding:"6px 12px",borderRadius:"999px",border:"none",cursor:"pointer",fontWeight:600,background:"#ff69b4",color:"#1e0d14"},children:"Save card"})]})]})}),e&&V&&o.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(8,1,10,0.85)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,padding:"12px"},onClick:k=>{k.target===k.currentTarget&&ae(null)},children:o.jsxs("div",{style:{width:"min(720px, 95vw)",background:"#140710",border:"1px solid rgba(255,182,193,0.3)",borderRadius:"12px",padding:"14px",boxShadow:"0 24px 60px rgba(0,0,0,0.85)"},onClick:k=>k.stopPropagation(),children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx("h2",{style:{margin:0,color:"#ffb6c1"},children:"Edit card"}),o.jsx("button",{className:"dashboard-close",onClick:()=>ae(null),type:"button","aria-label":"Close",children:"X"})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"180px 1fr",gap:"12px",alignItems:"flex-start",marginTop:"10px"},children:[o.jsx("div",{style:{width:"100%",maxWidth:"180px",borderRadius:"10px",border:"1px solid rgba(255,182,193,0.25)",background:"#1e0d14",overflow:"hidden",aspectRatio:"3 / 4",display:"flex",alignItems:"center",justifyContent:"center"},children:V.image?o.jsx("img",{src:V.image,alt:"Card preview",style:{width:"100%",height:"100%",objectFit:"cover"}}):o.jsx("div",{style:{color:"var(--text-soft)",fontSize:"0.8rem",padding:"6px"},children:"No image"})}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:"8px"},children:[o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Game",o.jsxs("select",{value:V.game,onChange:k=>ae(H=>({...H,game:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"},children:[o.jsx("option",{value:"pokemon",children:"Pokemon"}),o.jsx("option",{value:"onepiece",children:"One Piece"}),o.jsx("option",{value:"mtg",children:"MTG"})]})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Card name",o.jsx("input",{type:"text",value:V.name,onChange:k=>ae(H=>({...H,name:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Set name",o.jsx("input",{type:"text",value:V.setName,onChange:k=>ae(H=>({...H,setName:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Card number",o.jsx("input",{type:"text",value:V.number,onChange:k=>ae(H=>({...H,number:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Rarity",o.jsx("input",{type:"text",value:V.rarity,onChange:k=>ae(H=>({...H,rarity:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Condition",o.jsx("input",{type:"text",value:V.condition,onChange:k=>ae(H=>({...H,condition:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Quantity",o.jsx("input",{type:"number",value:V.quantity,onChange:k=>ae(H=>({...H,quantity:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Price paid (each)",o.jsx("input",{type:"number",value:V.pricePaid,onChange:k=>ae(H=>({...H,pricePaid:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Estimated value (each)",o.jsx("input",{type:"number",value:V.estimatedValue,onChange:k=>ae(H=>({...H,estimatedValue:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Image URL",o.jsx("input",{type:"text",value:V.image||"",onChange:k=>ae(H=>({...H,image:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:["Product URL (backend only)",o.jsx("input",{type:"text",value:V.productURL||"",onChange:k=>ae(H=>({...H,productURL:k.target.value})),style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff"}})]}),o.jsxs("label",{style:{gridColumn:"1 / -1",fontSize:"0.8rem",color:"var(--text-soft)"},children:["Notes",o.jsx("textarea",{value:V.notes||"",onChange:k=>ae(H=>({...H,notes:k.target.value})),rows:3,style:{width:"100%",marginTop:"3px",padding:"6px 8px",borderRadius:"8px",border:"1px solid #bb7f8f",background:"#1e0d14",color:"#fff",resize:"vertical"}})]})]})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"12px"},children:[o.jsx("button",{onClick:()=>ae(null),style:{padding:"6px 12px",borderRadius:"999px",border:"1px solid rgba(255,182,193,0.5)",background:"transparent",color:"#ffb6c1",cursor:"pointer"},children:"Cancel"}),o.jsx("button",{onClick:Ne,style:{padding:"6px 12px",borderRadius:"999px",border:"none",cursor:"pointer",fontWeight:600,background:"#ff69b4",color:"#1e0d14"},children:"Save changes"})]})]})}),o.jsxs("section",{style:{display:"flex",flexWrap:"wrap",gap:"12px",marginTop:"18px",justifyContent:"center"},children:[o.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[o.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Total cards"}),o.jsx("div",{style:{fontSize:"1.1rem",fontWeight:700},children:b.totalCards})]}),b.totalPaid>0&&o.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[o.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Total paid"}),o.jsxs("div",{style:{fontSize:"1.1rem",fontWeight:700},children:["$",b.totalPaid.toFixed(2)]})]}),o.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},title:Ce,children:[o.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Total value"}),o.jsxs("div",{style:{fontSize:"1.1rem",fontWeight:700},children:["$",b.totalValue.toFixed(2)]})]}),o.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[o.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Unrealized gain / loss"}),o.jsxs("div",{style:{fontSize:"1.1rem",fontWeight:700,color:J>=0?"#00e676":"#ff8a80"},children:[J>=0?"+":"-","$",Math.abs(J).toFixed(2)]})]}),o.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[o.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"Pokemon cards"}),o.jsx("div",{style:{fontSize:"1.1rem",fontWeight:700},children:b.pokemon})]}),o.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[o.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"One Piece cards"}),o.jsx("div",{style:{fontSize:"1.1rem",fontWeight:700},children:b.onepiece})]}),o.jsxs("div",{className:"card",style:{padding:"10px 12px",textAlign:"center",minWidth:"170px"},children:[o.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-soft)"},children:"MTG cards"}),o.jsx("div",{style:{fontSize:"1.1rem",fontWeight:700},children:b.mtg})]})]}),o.jsxs("section",{style:{display:"flex",flexWrap:"wrap",gap:"10px",marginTop:"16px"},children:[o.jsx("input",{type:"text",placeholder:"Search by name, set, or number...",value:v,onChange:k=>w(k.target.value),style:{flex:"1 1 220px",minWidth:"220px",padding:"8px 12px",borderRadius:"999px",border:"1px solid #bb7f8f",background:"#2b0f1d",color:"#fff"}}),o.jsxs("select",{value:T,onChange:k=>C(k.target.value),style:{flex:"0 0 220px",padding:"8px 12px",borderRadius:"999px",border:"1px solid #bb7f8f",background:"#2b0f1d",color:"#fff"},children:[o.jsx("option",{value:"all",children:"All games"}),o.jsx("option",{value:"pokemon",children:"Pokemon only"}),o.jsx("option",{value:"onepiece",children:"One Piece only"}),o.jsx("option",{value:"mtg",children:"MTG only"})]}),o.jsxs("select",{value:U,onChange:k=>X(k.target.value),style:{flex:"0 0 220px",padding:"8px 12px",borderRadius:"999px",border:"1px solid #bb7f8f",background:"#2b0f1d",color:"#fff"},children:[o.jsx("option",{value:"name",children:"Sort: Name (A-Z)"}),o.jsx("option",{value:"set",children:"Sort: Set (A-Z)"}),o.jsx("option",{value:"rarity",children:"Sort: Rarity (A-Z)"}),o.jsx("option",{value:"quantity",children:"Sort: Quantity (high to low)"}),o.jsx("option",{value:"value",children:"Sort: Value (high to low)"})]})]}),f?o.jsx("p",{style:{marginTop:"20px",color:"var(--text-soft)"},children:"Loading TCG collection..."}):D.length===0?o.jsx("p",{style:{marginTop:"20px",color:"var(--text-soft)"},children:"No cards found."}):o.jsx("section",{className:"grid",style:{gridTemplateColumns:"repeat(auto-fill, minmax(170px, 1fr))",marginTop:"20px"},children:N.map(k=>{const H=Number(k.quantity||1),Te=H*Number(k.pricePaid||0),De=H*Number(k.estimatedValue||0);return o.jsxs("article",{style:{background:"#2b0f1d",borderRadius:"12px",border:"1px solid rgba(255,182,193,0.25)",boxShadow:"0 4px 16px rgba(0,0,0,0.55)",padding:"10px",fontSize:"0.82rem",display:"flex",flexDirection:"column",gap:"6px"},children:[k.image&&o.jsx("div",{style:{width:"100%",paddingTop:"140%",position:"relative",overflow:"hidden",borderRadius:"10px",background:"#1e0d14"},children:o.jsx("img",{src:k.image,alt:k.name||"card image",style:{position:"absolute",inset:0,width:"100%",height:"100%",objectFit:"contain"}})}),o.jsx("div",{style:{fontWeight:700,color:"#ffb6c1",marginBottom:"4px"},children:k.name||"Unnamed card"}),o.jsx("div",{style:{color:"var(--text-soft)",marginBottom:"4px"},children:k.setName||""}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",color:"var(--text-soft)"},children:[o.jsxs("span",{children:["#",k.number||"-"]}),o.jsx("span",{children:k.rarity||""})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",color:"var(--text-soft)",marginTop:"4px"},children:[o.jsxs("span",{children:["Cond: ",k.condition||"N/A"]}),o.jsxs("span",{children:["Qty: ",H]})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",color:"var(--text-soft)",marginTop:"4px"},children:[o.jsxs("span",{children:["Paid: $",Te.toFixed(2)]}),o.jsxs("span",{children:["Value: $",De.toFixed(2)]})]}),k.notes&&o.jsxs("div",{style:{color:"#9c8fa6",fontSize:"0.72rem",fontStyle:"italic",textAlign:"center",marginTop:"6px"},children:['"',k.notes,'"']}),o.jsxs("div",{style:{marginTop:"4px",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"8px"},children:[o.jsx("span",{style:{padding:"2px 7px",borderRadius:"999px",background:"rgba(255,105,180,0.18)",border:"1px solid rgba(255,105,180,0.5)",color:"#ffb6c1",fontSize:"0.7rem",whiteSpace:"nowrap"},children:{pokemon:"Pokemon",onepiece:"One Piece",mtg:"MTG"}[k.game]||"Other"}),e&&o.jsxs("div",{style:{display:"flex",gap:"6px",alignItems:"center",marginLeft:"auto"},children:[o.jsx("button",{onClick:()=>ae({...k,pricePaid:k.pricePaid??"",estimatedValue:k.estimatedValue??"",quantity:k.quantity??1}),style:{padding:"3px 8px",borderRadius:"999px",border:"1px solid rgba(255,182,193,0.5)",background:"rgba(255,105,180,0.15)",color:"#ffb6c1",fontSize:"0.7rem",cursor:"pointer"},children:"Edit"}),o.jsx("button",{onClick:()=>_e(k.id),style:{padding:"3px 8px",borderRadius:"999px",border:"1px solid rgba(244,67,54,0.7)",background:"rgba(244,67,54,0.12)",color:"#ff8a80",fontSize:"0.7rem",cursor:"pointer"},children:"Delete"})]})]})]},k.id)})})]})}const Il="https://discord.com/api/webhooks/1448287168845054004/cGWGPoH5LaTFlBZ1vxtgMjOfV9au6qyQ_9ZRnOWN9-AX0MNfwxKNWVcZYQHz0ESA7_4k",Pl="https://discord.com/api/webhooks/1448288240871276616/101WI-B2p8tDR34Hl9fZxxb0QG01f1Eo5w1IvbttlQmP2wWFNJ0OI7UnJfJujKRNWW2Q";function mc(n){const e=n==null?"":String(n);return e.trim()?e.replace(/\s*,?\s*(?:vol(?:ume)?\.?)\s+\d+.*$/i,"").trim():""}function _i(n){if(!n)return null;if(n instanceof Date)return n;if(n&&typeof n.toDate=="function")return n.toDate();const e=String(n).trim();if(!e)return null;const t=e.match(/^(\d{4})-(\d{2})-(\d{2})$/);if(t){const[,l,d,f]=t;return new Date(Number(l),Number(d)-1,Number(f))}const s=e.match(/^(\d{1,2})\/(\d{1,2})\/(\d{2,4})$/);if(s){let[,l,d,f]=s;const m=f.length===2?+`20${f}`:Number(f);return new Date(m,Number(l)-1,Number(d))}const a=new Date(e);return isNaN(a.getTime())?null:a}function Ad(n){const e=n.seriesKey||n.series||n.Series||n.title||n.Title||"",s=(mc(e)||e).trim();return s?s.toLowerCase():""}function CR(n){const e=(n==null?void 0:n.series)||(n==null?void 0:n.Series)||(n==null?void 0:n.title)||(n==null?void 0:n.Title)||"Unknown Series";return mc(e)||"Unknown Series"}function E_(n){const e=(n||"").trim(),t=e.match(/^(.*?)(?:,?\s*(?:vol\.|volume)\s*(\d+)(?:\s*[-]\s*\d+)?\s*)?(?:\s*\([^)]*\))?$/i),s=t?t[1].trim().toLowerCase():e.toLowerCase(),a=t&&t[2]?parseInt(t[2],10):0;return{name:s,vol:Number.isFinite(a)?a:0}}function IR(n,e){const t=(n==null?void 0:n.Title)||(n==null?void 0:n.title)||"",s=(e==null?void 0:e.Title)||(e==null?void 0:e.title)||"",a=E_(t),l=E_(s),d=a.name.localeCompare(l.name);return d!==0?d:a.vol!==l.vol?a.vol-l.vol:t.localeCompare(s)}function yf(){return{publisher:"",demographic:"",genre:"",subGenre:"",datePurchased:"",msrp:"",initialPublisher:"",initialDemographic:"",initialGenre:"",initialSubGenre:"",initialDatePurchased:"",initialMsrp:"",dateMixed:!1,readChecked:!1,readIndeterminate:!1}}function T_(){return{read:!1,datePurchased:"",dateRead:"",pageCount:"",msrp:"",amountPaid:"",rating:"",special:!1,specialType:"",specialVolumes:"",collectiblePrice:""}}function S_(n,e={}){const t=e.ignoreShared,s=(n==null?void 0:n.amountPaid)??(n==null?void 0:n.AmountPaid)??(n==null?void 0:n.paid)??(n==null?void 0:n.Paid)??"",a=(n==null?void 0:n.msrp)??(n==null?void 0:n.MSRP)??"",l=((n==null?void 0:n.datePurchased)||(n==null?void 0:n.DatePurchased)||"").trim(),d=((n==null?void 0:n.publisher)||(n==null?void 0:n.Publisher)||"").trim(),f=((n==null?void 0:n.demographic)||(n==null?void 0:n.Demographic)||"").trim(),m=((n==null?void 0:n.genre)||(n==null?void 0:n.Genre)||"").trim(),v=((n==null?void 0:n.specialType)||(n==null?void 0:n.SpecialType)||"").trim(),w=(n==null?void 0:n.specialVolumes)??(n==null?void 0:n.SpecialVolumes)??(n==null?void 0:n.volumesContained)??"",T=(n==null?void 0:n.collectiblePrice)??(n==null?void 0:n.CollectiblePrice)??"",C=!!v,U=(n==null?void 0:n.pageCount)??(n==null?void 0:n.PageCount)??(n==null?void 0:n.pages)??(n==null?void 0:n.Pages)??"",X=U==null?"":String(U).trim(),q=Number(X),F=!X||Number.isNaN(q)||q<=0;return!C&&(s===""||s===null)||F||!l||!t&&(a===""||!d||!f||!m)||C&&!v||C&&v.toLowerCase()==="collectible"&&(T===""||T===null)||C&&v.toLowerCase()==="specialedition"&&(w===""||w===null)}function PR(n){const e=(n==null?void 0:n.amountPaid)??"",t=((n==null?void 0:n.datePurchased)||"").trim(),s=!!(n!=null&&n.specialType)||!!(n!=null&&n.special),a=((n==null?void 0:n.specialType)||"").trim(),l=(n==null?void 0:n.specialVolumes)??"",d=(n==null?void 0:n.collectiblePrice)??"",f=(n==null?void 0:n.pageCount)??"",m=(n==null?void 0:n.msrp)??"",v=((n==null?void 0:n.publisher)||"").trim(),w=((n==null?void 0:n.demographic)||"").trim(),T=((n==null?void 0:n.genre)||"").trim(),C=!s&&(e===""||e===null),U=s&&!a,X=s&&a.toLowerCase()==="collectible"&&(d===""||d===null),q=s&&a.toLowerCase()==="specialedition"&&(l===""||l===null),F=(()=>{const ie=(f??"").toString().trim();if(ie==="")return!0;const Se=Number(ie);return Number.isNaN(Se)||Se<=0})();return{amountPaid:C,datePurchased:!t,specialType:U,collectiblePrice:X,specialVolumes:q,pageCount:F,msrp:m===""||m===null,publisher:!v,demographic:!w,genre:!T}}function NR(n){return!n||!n.books||!n.books.length?!1:n.books.some(e=>{const t=(e==null?void 0:e.msrp)??(e==null?void 0:e.MSRP)??"",s=((e==null?void 0:e.publisher)||(e==null?void 0:e.Publisher)||"").trim(),a=((e==null?void 0:e.demographic)||(e==null?void 0:e.Demographic)||"").trim(),l=((e==null?void 0:e.genre)||(e==null?void 0:e.Genre)||"").trim();return t===""||!s||!a||!l})}function RR(n){const e=new Map;for(const t of n){const s=Ad(t)||t.id;if(!e.has(s)){const m=mc(t.series||t.Series||t.title||t.Title||"Unknown Series")||"Unknown Series";e.set(s,{key:s,title:m,publisher:t.publisher||t.Publisher||"",genre:t.genre||t.Genre||"",demographic:t.demographic||t.Demographic||"",volumes:0,totalPages:0,readPages:0,readVolumes:0,ratingSum:0,ratingCount:0})}const a=e.get(s);a.volumes+=1;const l=Number(t.pages||t.Pages||t.pageCount||0)||0;a.totalPages+=l,(!!t.read||t.status==="Read"||t.Read===!0)&&(a.readVolumes+=1,a.readPages+=l);const f=Number(t.rating||t.Rating);!isNaN(f)&&f>0&&(a.ratingSum+=f,a.ratingCount+=1)}return e}function To(n,e,t=5){const s=new Map;for(const a of n.values()){const l=(a[e]||"").trim();if(!l)continue;const d=l.split(/[\/,]/).map(f=>f.trim()).filter(Boolean);for(const f of d)s.set(f,(s.get(f)||0)+1)}return[...s.entries()].sort((a,l)=>l[1]-a[1]).slice(0,t).map(([a,l])=>({name:a,count:l}))}function b_(n,e){const t=Array.from({length:12},(s,a)=>{const l=new Date(e,a,1);return{key:`${e}-${a}`,label:l.toLocaleString("default",{month:"short"}),year:e,month:a,value:0}});for(const s of n){const a=_i(s.dateRead||s.DateRead);!a||a.getFullYear()!==e||(t[a.getMonth()].value+=1)}return t}function Ia(n){const e=n.getFullYear(),t=`${n.getMonth()+1}`.padStart(2,"0"),s=`${n.getDate()}`.padStart(2,"0");return`${e}-${t}-${s}`}async function C_(n,e){try{await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:e})})}catch(t){console.error("Webhook post failed",t)}}function AR(n){const e=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],t=Array(7).fill(0);for(const l of n){const d=_i(l.dateRead||l.DateRead);d&&(t[d.getDay()]+=1)}if(!t.some(l=>l>0))return[];const a=t.reduce((l,d)=>Math.max(l,d),0)||1;return e.map((l,d)=>({label:l,value:t[d],pct:t[d]/a}))}function jR(n,e=8){const t=[...n.values()];t.sort((l,d)=>d.volumes-l.volumes);const s=t.slice(0,e),a=s.reduce((l,d)=>Math.max(l,d.volumes),0)||1;return s.map(l=>({label:l.title,value:l.volumes,pct:l.volumes/a}))}function kR(n,e){const t=(a,l)=>{const d=_i(a.releaseDate||a.ReleaseDate||a.date||a.Date);if(!d)return null;const f=(a.title||a.series||a.Title||"Unknown Title").trim(),m=!!(a.datePurchased||a.DatePurchased||"").trim();return{date:d,title:f,purchased:m,source:l}},s=[];return(e||[]).forEach(a=>{const l=t(a,"wishlist");l&&s.push(l)}),(n||[]).forEach(a=>{const l=t(a,"library");l&&s.push(l)}),s.sort((a,l)=>a.date-l.date),s}function DR(n){const e=new Date;for(const t of n)if(t.date>=e)return t;return n[n.length-1]||null}function LR(n){let e=0,t=0;for(const s of n){const a=_i(s.datePurchased||s.DatePurchased),l=_i(s.dateRead||s.DateRead);if(!a||!l)continue;const d=l-a;d<=0||(e+=d/(1e3*60*60*24),t+=1)}return t?e/t:null}function VR(n){const e=new Map;for(const t of n){const s=_i(t.datePurchased||t.DatePurchased),a=_i(t.dateRead||t.DateRead);if(!s||!a)continue;const l=a-s;if(l<=0)continue;const d=l/(1e3*60*60*24),f=Ad(t)||t.id,m=mc(t.series||t.Series||t.title||t.Title||"Untitled")||"Untitled";e.has(f)||e.set(f,{key:f,title:m,total:0,count:0,min:d,max:d});const v=e.get(f);v.total+=d,v.count+=1,v.min=Math.min(v.min,d),v.max=Math.max(v.max,d)}return[...e.values()].filter(t=>t.count>0).map(t=>({...t,avg:t.total/t.count})).sort((t,s)=>s.avg-t.avg)}function MR(n){let e=0,t=0,s=0;for(const a of n){const l=Number(a.msrp||a.MSRP||0)||0,d=Number(a.amountPaid||a.AmountPaid||a.pricePaid||0)||l||0,f=Number(a.collectiblePrice||a.CollectiblePrice||0)||0;e+=l,t+=d,s+=f}return{msrpTotal:e,paidTotal:t,collectibleTotal:s}}function OR(n){const e=new Map;for(const t of n){const s=Ad(t)||t.id;if(!e.has(s)){const T=t.series||t.Series||t.title||t.Title||"Untitled";e.set(s,{key:s,title:mc(T)||T.trim()||"Untitled",msrp:0,paid:0,collectible:0,books:0,pages:0,readPages:0,ratings:[]})}const a=e.get(s);a.books+=1;const l=Number(t.msrp||t.MSRP||0)||0,d=Number(t.amountPaid||t.AmountPaid||t.pricePaid||0)||0,f=Number(t.collectiblePrice||t.CollectiblePrice||0)||0,m=Number(t.pages||t.Pages||t.pageCount||0)||0,v=!!t.read||t.status==="Read"||t.Read===!0;a.msrp+=l,a.paid+=d,a.collectible+=f,a.pages+=m,v&&(a.readPages+=m);const w=Number(t.rating||t.Rating);!isNaN(w)&&w>0&&a.ratings.push(w)}return[...e.values()]}function FR(n){let e=0,t=0;for(const s of n){const a=Number(s.pages||s.Pages||s.pageCount||0)||0;e+=a,(!!s.read||s.status==="Read"||s.Read===!0)&&(t+=a)}return{total:e,read:t}}function UR(n){let e=0,t=0;for(const s of n.values())s.ratingCount>0&&(e+=s.ratingSum/s.ratingCount,t+=1);return t?e/t:null}function zR({data:n}){if(!n||!n.length)return o.jsx("div",{className:"line-chart empty",children:"No reading data yet."});const e=n.reduce((v,w)=>Math.max(v,w.value),0)||1,t=480,s=230,a=30,l=s-a*2,d=t/Math.max(n.length-1,1),f=n.map((v,w)=>{const T=w*d,C=s-a-v.value/e*l;return{...v,x:T,y:C}}),m=f.map((v,w)=>w===0?`M ${v.x} ${v.y}`:`L ${v.x} ${v.y}`).join(" ");return o.jsx("div",{className:"line-chart",children:o.jsxs("svg",{viewBox:`0 0 ${t} ${s}`,width:"100%",height:"100%",preserveAspectRatio:"xMidYMid meet",children:[[0,.25,.5,.75,1].map((v,w)=>{const T=s-a-v*l;return o.jsx("line",{className:"line-grid",x1:"0",x2:t,y1:T,y2:T},`h-${w}`)}),f.map((v,w)=>o.jsx("line",{className:"line-grid",x1:v.x,x2:v.x,y1:a/2,y2:s-a/2},`v-${w}`)),o.jsx("path",{className:"line-path",d:m}),f.map((v,w)=>o.jsxs("g",{children:[o.jsx("circle",{className:"line-point",cx:v.x,cy:v.y,r:"1.5"}),o.jsx("text",{className:"line-value",x:v.x,y:v.y-3,children:v.value}),o.jsx("text",{className:"line-label",x:v.x,y:s-4,children:v.label})]},w))]})})}function BR({data:n}){return!n||!n.length?o.jsx("div",{className:"weekday-breakdown empty",children:"No reads recorded yet."}):o.jsx("div",{className:"weekday-bars",children:n.map(e=>o.jsxs("div",{className:"weekday-col",children:[o.jsx("div",{className:"weekday-count",children:e.value}),o.jsx("div",{className:"weekday-bar-vert",children:o.jsx("div",{className:"weekday-bar-vert-fill",style:{height:`${Math.max(e.pct*100,e.value?6:0)}%`}})}),o.jsx("div",{className:"weekday-label",children:e.label})]},e.label))})}function I_(n,e,t){const s=n.getFullYear(),a=n.getMonth(),d=new Date(s,a,1).getDay(),f=new Date(s,a+1,0).getDate(),m=new Map;for(const T of e){const C=T.date;if(C.getFullYear()===s&&C.getMonth()===a){const U=C.getDate();m.has(U)||m.set(U,[]),m.get(U).push(T)}}const v=[];for(let T=0;T<d;T++)v.push({type:"pad"});for(let T=1;T<=f;T++){const C=Ia(new Date(s,a,T));v.push({type:"day",day:T,releases:m.get(T)||[],dateKey:C,isToday:C===t})}const w=Math.ceil(v.length/7)*7;for(;v.length<w;)v.push({type:"pad"});return v}function $R(){const{user:n,admin:e,loading:t}=Ba(),[s,a]=j.useState([]),[l,d]=j.useState([]),[f,m]=j.useState(!0),[v,w]=j.useState(null),[T,C]=j.useState("-"),[U,X]=j.useState({yearly:Il,release:Pl,activity:Pa}),[q,F]=j.useState(new Set),[ie,Se]=j.useState(null),[Ee,we]=j.useState(null),[V,ae]=j.useState(new Set),[I,P]=j.useState(null),[A,M]=j.useState(""),D=j.useRef(null),[N,b]=j.useState(()=>yf()),[J,re]=j.useState(()=>T_()),[Ce,de]=j.useState([]),[ce,Ne]=j.useState(!1),[_e,Y]=j.useState([]),[k,H]=j.useState(!1),[Te,De]=j.useState([]),[ke,Oe]=j.useState(!1),[Qe,st]=j.useState(""),[ve,ue]=j.useState(null),[Ve,me]=j.useState(null),He=async()=>{if(e)try{H(!0);const B=(await _s(Cn(ot,"users"))).docs.map(Q=>({uid:Q.id,...Q.data()}));Y(B)}catch(S){console.error("Failed to load users",S)}finally{H(!1)}},Ye=async(S,B)=>{const Q=(S||"").trim();if(!Q){alert("UID is required.");return}try{await ui(Dt(ot,"users",Q),{role:B,updatedBy:(n==null?void 0:n.uid)||"manual",updatedAt:new Date().toISOString()},{merge:!0}),await He()}catch(he){console.error("Failed to update role",he),alert("Failed to update role.")}},[Tt,Ct]=j.useState(!1),[gt,Nt]=j.useState(()=>new Date),[Yt,tn]=j.useState(!1),[nn,ur]=j.useState(()=>new Date),[rn,Yn]=j.useState(null),[Ot,$t]=j.useState(!1),[Un,dr]=j.useState(()=>{const S=new Date;return{year:S.getFullYear(),month:S.getMonth()}}),[Pn,zn]=j.useState(null),[Jt,ss]=j.useState({open:!1,type:null}),Nn=new Date().getFullYear(),wn=j.useRef(null),is=j.useRef(null);j.useEffect(()=>{document.title="Dashboard"},[]),j.useEffect(()=>(Tt||Jt.open||ce||!!Ve||Yt||!!rn||Ot||!!Pn?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[Tt,Jt.open,ce,Ve,Yt,rn,Ot,Pn]),j.useEffect(()=>{typeof window>"u"||(wn.current=localStorage.getItem("dashboard-yearly-posted"),is.current=localStorage.getItem("dashboard-release-posted"))},[]),j.useEffect(()=>{if(!e)return;const S=Dt(ot,"settings","webhooks");(async()=>{try{const B=await Nd(S);if(B.exists()){const Q=B.data();X({yearly:Q.yearly||Il,release:Q.release||Pl,activity:Q.activity||Pa})}else await ui(S,{yearly:Il,release:Pl,activity:Pa}),X({yearly:Il,release:Pl,activity:Pa})}catch(B){console.error("Failed to load webhook settings",B)}})()},[e]),j.useEffect(()=>{if(!e)return;let S=!1;return(async()=>await He())(),()=>{S=!0}},[e]),j.useEffect(()=>{let S=!1;if(!n||!e){De([]),st("");return}return(async()=>{try{Oe(!0);const Q=(await _s(Cn(ot,"suggestions"))).docs.map(he=>{var Ae;const Ie=he.data();let Ge=null;if((Ae=Ie==null?void 0:Ie.createdAt)!=null&&Ae.toDate)Ge=Ie.createdAt.toDate();else if(Ie!=null&&Ie.createdAt){const Je=new Date(Ie.createdAt);Ge=isNaN(Je.getTime())?null:Je}return{id:he.id,...Ie,createdAt:Ge}});Q.sort((he,Ie)=>{var Ge,Ae,Je,ut;return(((Ae=(Ge=Ie.createdAt)==null?void 0:Ge.getTime)==null?void 0:Ae.call(Ge))||0)-(((ut=(Je=he.createdAt)==null?void 0:Je.getTime)==null?void 0:ut.call(Je))||0)}),S||(De(Q),st(""))}catch(B){console.error("Failed to load suggestions",B),S||(st("Failed to load suggestions."),De([]))}finally{S||Oe(!1)}})(),()=>{S=!0}},[n,e]);const Ss=async S=>{if(!(!e||!S))try{await Ra(Dt(ot,"suggestions",S)),De(B=>B.filter(Q=>Q.id!==S))}catch(B){console.error("Failed to delete suggestion",B),st("Failed to delete suggestion.")}};j.useEffect(()=>{let S=!1;async function B(){if(!n||!e){a([]),d([]),w(null),m(!1);return}try{m(!0);const[Q,he]=await Promise.all([_s(Cn(ot,"library")),_s(Cn(ot,"wishlist"))]);if(S)return;a(Q.docs.map(Ie=>({id:Ie.id,...Ie.data()}))),d(he.docs.map(Ie=>({id:Ie.id,...Ie.data()}))),w(null)}catch(Q){console.error(Q),S||w("Failed to load dashboard data.")}finally{S||m(!1)}}return B(),()=>{S=!0}},[n,e]);const Pt=j.useMemo(()=>{const S=s.length,B=s.filter($n=>!!$n.read||$n.status==="Read"||$n.Read===!0).length,Q=S-B,he=S?Math.round(B/S*100):0,Ie=l.length,Ge=RR(s),Ae=b_(s,Nn),Je=b_(s,Nn-1),ut=Ae.reduce(($n,us)=>$n+us.value,0),yt=AR(s),Lt=jR(Ge),St=kR(s,l),an=DR(St),En=LR(s),wt=MR(s),on=FR(s),tr=UR(Ge),Gr=VR(s),Dr=To(Ge,"publisher",5),Js=To(Ge,"genre",5),$a=To(Ge,"demographic",5),Lr=OR(s);return{totalLibrary:S,readCount:B,unreadCount:Q,readPct:he,wishlistCount:Ie,seriesMap:Ge,monthlyReads:Ae,prevYearReads:Je,currentYearReadsTotal:ut,weekdayBreakdown:yt,topSeriesBars:Lt,releases:St,nextRelease:an,avgDays:En,purchaseToReadSeries:Gr,collectionValue:wt,pages:on,avgRating:tr,topPublishers:Dr,topGenres:Js,topDemographics:$a,seriesAggregates:Lr}},[s,l,Nn]),{totalLibrary:yr,readCount:bs,unreadCount:Jn,readPct:Xn,wishlistCount:Rr,seriesMap:Rn,monthlyReads:Ar,prevYearReads:Zn,currentYearReadsTotal:qs,weekdayBreakdown:vr,topSeriesBars:Hs,releases:Ze,nextRelease:er,avgDays:An,purchaseToReadSeries:as,collectionValue:jn,pages:xn,avgRating:kn,topPublishers:Cs,topGenres:Is,topDemographics:Bn,seriesAggregates:$r}=Pt,Ft=er?er.date:null,os=!!v,dn=Ia(new Date),jr=j.useMemo(()=>s.map(S=>{const B=_i(S.dateRead||S.DateRead);return!B||!(S.read||S.status==="Read"||S.Read===!0)?null:{date:B,title:S.title||S.Title||"Untitled"}}).filter(Boolean).sort((S,B)=>S.date-B.date),[s]),Ks=j.useMemo(()=>I_(nn,jr,dn),[nn,jr,dn]),Wr=j.useMemo(()=>{const S=new Map;return[...s,...l].forEach(Q=>{const he=_i(Q.datePurchased||Q.DatePurchased);if(!he)return;const Ie=Ia(he);S.has(Ie)||S.set(Ie,[]),S.get(Ie).push({id:Q.id||Q.Title||Q.title||Ie,title:Q.title||Q.Title||"Untitled"})}),S.forEach(Q=>Q.sort((he,Ie)=>(he.title||"").localeCompare(Ie.title||""))),S},[s,l]),ls=j.useMemo(()=>{const{year:S,month:B}=Un,he=new Date(S,B,1).getDay(),Ie=new Date(S,B+1,0).getDate();let Ge=!1;const Ae=[];for(let ut=0;ut<he;ut+=1)Ae.push({type:"pad"});for(let ut=1;ut<=Ie;ut+=1){const yt=new Date(S,B,ut),Lt=Ia(yt),St=Wr.get(Lt)||[];St.length&&(Ge=!0),Ae.push({type:"day",day:ut,dateKey:Lt,items:St,releases:St,isToday:Lt===dn})}const Je=Math.ceil(Ae.length/7)*7;for(;Ae.length<Je;)Ae.push({type:"pad"});return{cells:Ae,hasItems:Ge}},[Un,Wr,dn]),hn=j.useMemo(()=>{if(!s||!s.length)return[];const S=new Map;s.forEach(Q=>{const he=Ad(Q)||Q.id,Ie=CR(Q);S.has(he)||S.set(he,{seriesKey:he,displayName:Ie,books:[]}),S.get(he).books.push(Q)});const B=Array.from(S.values()).map(Q=>({...Q,books:[...Q.books].sort(IR)}));return B.sort((Q,he)=>Q.displayName.localeCompare(he.displayName)),B},[s]),Qs=j.useMemo(()=>hn.flatMap(S=>S.books.map(B=>B.id)),[hn]);j.useEffect(()=>{Ee&&(s.some(S=>S.id===Ee)||we(null))},[s,Ee]),j.useEffect(()=>{ie&&(hn.some(S=>S.seriesKey===ie)||Se(null))},[hn,ie]),j.useEffect(()=>{if(!V.size)return;const S=new Set(s.map(Q=>Q.id)),B=Array.from(V).filter(Q=>!S.has(Q));B.length&&ae(Q=>{const he=new Set(Q);return B.forEach(Ie=>he.delete(Ie)),he})},[s,V]),j.useEffect(()=>{const S=Array.from(V);if(!S.length){M("");return}const B=Array.from(new Set(S.map(Q=>s.find(he=>he.id===Q)).filter(Boolean).map(Q=>{const he=Q.amountPaid??Q.AmountPaid??"";return he==null?"":String(he)})));M(B.length===1?B[0]:"")},[V,s]),j.useEffect(()=>{const S=hn.find(wt=>wt.seriesKey===ie);if(!S){b(yf());return}const B=S.books,Q=wt=>{const on=Array.from(new Set(B.map(tr=>{const Gr=wt(tr);return Gr==null?"":String(Gr).trim()})));return on.length===1?on[0]:""},he=Q(wt=>wt.publisher||wt.Publisher),Ie=Q(wt=>wt.demographic||wt.Demographic),Ge=Q(wt=>wt.genre||wt.Genre),Ae=Q(wt=>wt.subGenre||wt.SubGenre),Je=Q(wt=>wt.msrp??wt.MSRP),ut=Array.from(new Set(B.map(wt=>(wt.datePurchased||wt.DatePurchased||"").trim()).filter(Boolean))),yt=ut.length>1,Lt=yt?"":ut[0]||"",St=B.filter(wt=>!!wt.read||wt.status==="Read"||wt.Read===!0).length,an=St===B.length&&B.length>0;b({publisher:he,demographic:Ie,genre:Ge,subGenre:Ae,datePurchased:Lt,msrp:Je,initialPublisher:he,initialDemographic:Ie,initialGenre:Ge,initialSubGenre:Ae,initialDatePurchased:Lt,initialMsrp:Je,dateMixed:yt,readChecked:an,readIndeterminate:!an&&!(St===0)})},[hn,ie]),j.useEffect(()=>{D.current&&(D.current.indeterminate=N.readIndeterminate)},[N.readIndeterminate]),j.useEffect(()=>{const S=s.find(Q=>Q.id===Ee);if(!S){re(T_());return}const B=!!S.read||S.status==="Read"||S.Read===!0;re({read:B,datePurchased:S.datePurchased||S.DatePurchased||"",dateRead:B&&(S.dateRead||S.DateRead)||"",pageCount:S.pageCount??S.PageCount??S.pages??S.Pages??"",msrp:S.msrp??S.MSRP??"",amountPaid:S.amountPaid??S.AmountPaid??"",rating:B?S.rating??S.Rating??"":"",special:!!(S.specialType||S.SpecialType),specialType:S.specialType??S.SpecialType??"",specialVolumes:S.specialVolumes??S.SpecialVolumes??"",collectiblePrice:S.collectiblePrice??S.CollectiblePrice??"",publisher:S.publisher||S.Publisher||"",demographic:S.demographic||S.Demographic||"",genre:S.genre||S.Genre||""})},[Ee,s]),j.useEffect(()=>{if(!Zn||!Zn.length)return;const S=Nn-1,B=Zn.reduce((Ge,Ae)=>Ge+Ae.value,0);if(!B||(wn.current?parseInt(wn.current,10):null)===S)return;const he=Zn.map(Ge=>`${Ge.label}: ${Ge.value}`).join(", "),Ie=`Yearly reads summary for ${S}: ${B} total. Breakdown: ${he}`;C_(U.yearly,Ie).then(()=>{wn.current=String(S),typeof window<"u"&&localStorage.setItem("dashboard-yearly-posted",String(S))})},[Zn,Nn]),j.useEffect(()=>{if(!er||!Ze.length)return;const S=Ia(er.date),B=Ia(new Date);if(S>B||is.current===S)return;const Q=Ze.filter(Ie=>Ia(Ie.date)===S);if(!Q.length)return;const he=`Wishlist releases for ${S}:
${Q.map(Ie=>`- ${Ie.title}`).join(`
`)}`;C_(U.release,he).then(()=>{is.current=S,typeof window<"u"&&localStorage.setItem("dashboard-release-posted",S)})},[er,Ze]),j.useEffect(()=>{if(!Ft){C("-");return}const S=()=>{const Q=Ft-new Date;if(Q<=0){C("Released");return}const he=Math.floor(Q/1e3),Ie=Math.floor(he/86400),Ge=Math.floor(he%86400/3600).toString().padStart(2,"0"),Ae=Math.floor(he%3600/60).toString().padStart(2,"0"),Je=Math.floor(he%60).toString().padStart(2,"0");C(`${Ie}d ${Ge}:${Ae}:${Je}`)};S();const B=setInterval(S,1e3);return()=>clearInterval(B)},[Ft]),j.useEffect(()=>{if(!(typeof window>"u"))try{const S=localStorage.getItem(am);if(!S)return;const B=JSON.parse(S);if(!Array.isArray(B))return;const Q=B.map(he=>({message:he.message,ts:he.ts?new Date(he.ts):new Date})).filter(he=>he.message);Q.length&&de(Q)}catch(S){console.warn("Failed to load activity log",S)}},[]);const Ys=async()=>{try{const S=await _s(Cn(ot,"library"));a(S.docs.map(B=>({id:B.id,...B.data()})))}catch(S){console.error("Failed to refresh library",S),w(B=>B||"Failed to refresh library data.")}},dt=S=>{const B=(S??"").toString().trim();if(B==="")return"";const Q=parseFloat(B);return Number.isFinite(Q)?Q:""},hr=S=>{const B=(S??"").toString().trim();if(B==="")return"";const Q=parseInt(B,10);return Number.isFinite(Q)?Q:""},fn=S=>{if(!S)return;const B={message:S,ts:new Date};de(Q=>{const he=[B,...Q].slice(0,100);return mx(he),he}),gx(S,{email:(n==null?void 0:n.email)||"anonymous",name:(n==null?void 0:n.displayName)||"",webhookOverride:U.activity,persistLocal:!1})},pn=S=>{F(B=>{const Q=new Set(B);return Q.has(S)?Q.delete(S):Q.add(S),Q}),Se(S),we(null)},x=(S,B,Q)=>{const he=S.metaKey||S.ctrlKey,Ie=S.shiftKey,Ge=Qs.indexOf(B);let Ae=new Set(V);if(Ie&&I!==null&&Ge!==-1){const Je=Math.min(I,Ge),ut=Math.max(I,Ge);for(let yt=Je;yt<=ut;yt+=1){const Lt=Qs[yt];Lt&&Ae.add(Lt)}}else he?Ae.has(B)?Ae.delete(B):Ae.add(B):Ae=new Set;ae(Ae),P(Ge),we(B),Se(Q),F(Je=>{const ut=new Set(Je);return ut.add(Q),ut})},z=()=>{ae(new Set),P(null)},$=async()=>{if(!e){alert("Dashboard is read-only for your account.");return}const S=Array.from(V);if(!S.length){alert("Select books in Library Manager (use Ctrl/Cmd or Shift) before bulk editing.");return}const B=(A||"").toString().trim(),Q=B!=="",he=dt(B);if(Q&&he===""){alert("Enter a valid number for Amount Paid.");return}try{await Promise.all(S.map(Ie=>ws(Dt(ot,"library",Ie),{amountPaid:Q?he:""}))),await Ys(),z(),fn(`Updated amount paid for ${S.length} book${S.length===1?"":"s"} in library`),alert(`Applied Amount Paid to ${S.length} selection${S.length===1?"":"s"}.`)}catch(Ie){console.error("Failed to apply Amount Paid",Ie),alert("Failed to apply Amount Paid to selection.")}},O=async()=>{if(!e){alert("Dashboard is read-only for your account.");return}const S=hn.find(St=>St.seriesKey===ie);if(!S||!S.books.length)return;const B=!N.readIndeterminate,Q=!!N.readChecked,he=N.datePurchased!==N.initialDatePurchased,Ie=N.msrp!==N.initialMsrp,Ge=N.publisher!==N.initialPublisher,Ae=N.demographic!==N.initialDemographic,Je=N.genre!==N.initialGenre,ut=N.subGenre!==N.initialSubGenre;if(!B&&!he&&!Ie&&!Ge&&!Ae&&!Je&&!ut)return;const yt=String(N.msrp??"").trim(),Lt=Ie?dt(yt):"";if(Ie&&yt!==""&&Lt===""){alert("Enter a valid number for MSRP.");return}try{const St=[];if(S.books.forEach(an=>{const En={};B&&(En.read=Q,En.dateRead=Q?an.dateRead||an.DateRead||new Date().toISOString().slice(0,10):""),he&&(En.datePurchased=N.datePurchased||""),Ie&&(En.msrp=N.msrp===""?"":Lt),Ge&&(En.publisher=N.publisher||""),Ae&&(En.demographic=N.demographic||""),Je&&(En.genre=N.genre||""),ut&&(En.subGenre=N.subGenre||""),Object.keys(En).length&&St.push(ws(Dt(ot,"library",an.id),En))}),!St.length)return;await Promise.all(St),await Ys(),we(null),fn(`Updated series "${S.displayName||"Series"}" (${S.books.length} book${S.books.length===1?"":"s"})`),alert("Series updated.")}catch(St){console.error("Failed to save series changes",St),alert("Failed to update series.")}},W=async()=>{if(!e){alert("Dashboard is read-only for your account.");return}if(!Ee)return;const S=!!J.read,B=String(J.msrp??"").trim(),Q=String(J.amountPaid??"").trim(),he=String(J.pageCount??"").trim(),Ie=String(J.rating??"").trim(),Ge=dt(B),Ae=dt(Q),Je=hr(he),ut=dt(Ie);if(B!==""&&Ge===""){alert("Enter a valid number for MSRP.");return}if(Q!==""&&Ae===""){alert("Enter a valid number for Amount Paid.");return}if(he!==""&&Je===""){alert("Enter a valid page count.");return}if(S&&Ie!==""&&ut===""){alert("Enter a valid rating.");return}const yt=!!J.special,Lt=hr(J.specialVolumes),St=dt(J.collectiblePrice),an=String(J.specialVolumes??"").trim(),En=String(J.collectiblePrice??"").trim();if(yt&&J.specialType==="specialEdition"&&an!==""&&Lt===""){alert("Enter a valid number for volumes contained.");return}if(yt&&J.specialType==="collectible"&&En!==""&&St===""){alert("Enter a valid collectible price.");return}const wt=S?J.dateRead||new Date().toISOString().slice(0,10):"",on={read:S,datePurchased:J.datePurchased||"",dateRead:wt,msrp:J.msrp===""?"":Ge,amountPaid:J.amountPaid===""?"":Ae,pageCount:J.pageCount===""?"":Je,rating:S?J.rating===""?"":ut:"",specialType:yt&&J.specialType||"",specialVolumes:yt&&J.specialType==="specialEdition"?J.specialVolumes===""?"":Lt:"",collectiblePrice:yt&&J.specialType==="collectible"?J.collectiblePrice===""?"":St:""};try{await ws(Dt(ot,"library",Ee),on),await Ys();const tr=s.find(Dr=>Dr.id===Ee)||ge,Gr=(tr==null?void 0:tr.Title)||(tr==null?void 0:tr.title)||"Untitled";fn(`Updated "${Gr}" in library`),alert("Saved changes.")}catch(tr){console.error("Failed to save book changes",tr),alert("Failed to save changes.")}},pe=()=>{Se(null),we(null),z(),b(yf())},ne=()=>{we(null),P(null)},Me=hn.find(S=>S.seriesKey===ie)||null,ge=s.find(S=>S.id===Ee)||null,Be=ie?{msrp:!N.msrp,datePurchased:!N.datePurchased&&!N.dateMixed,publisher:!N.publisher,demographic:!N.demographic,genre:!N.genre}:{},le=Ee?PR({amountPaid:J.amountPaid,msrp:J.msrp,datePurchased:J.datePurchased,publisher:(ge==null?void 0:ge.publisher)||(ge==null?void 0:ge.Publisher)||"",demographic:(ge==null?void 0:ge.demographic)||(ge==null?void 0:ge.Demographic)||"",genre:(ge==null?void 0:ge.genre)||(ge==null?void 0:ge.Genre)||"",special:J.special,specialType:J.specialType,specialVolumes:J.specialVolumes,collectiblePrice:J.collectiblePrice,pageCount:J.pageCount}):{};if(t)return o.jsx("div",{className:"page dashboard-page",children:o.jsxs("div",{className:"dashboard-loading",children:[o.jsx("h1",{children:"Dashboard"}),o.jsx("p",{children:"Checking permissions..."})]})});if(!n||!e)return o.jsx("div",{className:"page dashboard-page",children:o.jsxs("div",{className:"dashboard-locked",children:[o.jsx("h1",{children:"Dashboard"}),o.jsx("p",{children:"This area is restricted to admin accounts."})]})});if(f)return o.jsx("div",{className:"page dashboard-page",children:o.jsxs("div",{className:"dashboard-loading",children:[o.jsx("h1",{children:"Dashboard"}),v?o.jsx("p",{className:"error",children:v}):o.jsx("p",{children:"Loading stats..."})]})});const rt=yr+Rr,Re=rt?Math.round(yr/rt*100):0,ht=[...Rn.values()].filter(S=>S.ratingCount>0).map(S=>({title:S.title,avg:S.ratingSum/S.ratingCount,count:S.ratingCount})).sort((S,B)=>B.avg-S.avg||B.count-S.count).slice(0,3);function Ps(){if(Ft)Nt(new Date(Ft.getFullYear(),Ft.getMonth(),1));else if(Ze.length){const S=Ze[0].date;Nt(new Date(S.getFullYear(),S.getMonth(),1))}Ct(!0)}function sn(S){ss({open:!0,type:S})}function Dn(){ss({open:!1,type:null})}const fr=I_(gt,Ze,dn),kr=S=>{dr(B=>{const Q=new Date(B.year,B.month+S,1);return{year:Q.getFullYear(),month:Q.getMonth()}})},cs=S=>{ur(B=>new Date(B.getFullYear(),B.getMonth()+S,1))},Rt=()=>{$t(!1),zn(null)},Ns=()=>{const S=Array.from(Wr.keys()).sort();if(S.length){const B=S[S.length-1],[Q,he]=B.split("-"),Ie=Number(Q),Ge=Number(he)-1;!Number.isNaN(Ie)&&!Number.isNaN(Ge)&&dr({year:Ie,month:Ge})}$t(!0)},pt=()=>{if(jr.length){const S=jr[jr.length-1].date;ur(new Date(S.getFullYear(),S.getMonth(),1))}else ur(new Date);tn(!0)};function Rs(){const S=Jt.type;if(!S)return null;if(S==="publishers"){const B=[...To(Rn,"publisher",100)];return o.jsxs(o.Fragment,{children:[o.jsx("h3",{children:"Top Publishers by Series"}),B.length===0?o.jsx("p",{children:"No publisher data yet."}):o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"#"}),o.jsx("th",{children:"Publisher"}),o.jsx("th",{children:"Series Count"})]})}),o.jsx("tbody",{children:B.map((Q,he)=>o.jsxs("tr",{children:[o.jsx("td",{children:he+1}),o.jsx("td",{children:Q.name}),o.jsx("td",{children:Q.count})]},Q.name+he))})]})]})}if(S==="genres"){const B=[...To(Rn,"genre",100)];return o.jsxs(o.Fragment,{children:[o.jsx("h3",{children:"Top Genres by Series"}),B.length===0?o.jsx("p",{children:"No genre data yet."}):o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"#"}),o.jsx("th",{children:"Genre"}),o.jsx("th",{children:"Series Count"})]})}),o.jsx("tbody",{children:B.map((Q,he)=>o.jsxs("tr",{children:[o.jsx("td",{children:he+1}),o.jsx("td",{children:Q.name}),o.jsx("td",{children:Q.count})]},Q.name+he))})]})]})}if(S==="demographics"){const B=[...To(Rn,"demographic",100)];return o.jsxs(o.Fragment,{children:[o.jsx("h3",{children:"Top Demographics by Series"}),B.length===0?o.jsx("p",{children:"No demographic data yet."}):o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"#"}),o.jsx("th",{children:"Demographic"}),o.jsx("th",{children:"Series Count"})]})}),o.jsx("tbody",{children:B.map((Q,he)=>o.jsxs("tr",{children:[o.jsx("td",{children:he+1}),o.jsx("td",{children:Q.name}),o.jsx("td",{children:Q.count})]},Q.name+he))})]})]})}if(S==="timeToRead"){const B=as||[];return o.jsxs(o.Fragment,{children:[o.jsx("h3",{children:"Average Time From Purchase to Read"}),An==null?o.jsx("p",{children:"Not enough volumes have both purchase and read dates to calculate this yet."}):o.jsxs(o.Fragment,{children:[o.jsxs("p",{children:["On average, it takes"," ",o.jsxs("strong",{children:[An.toFixed(1)," days"]})," from purchase to finishing a volume."]}),B.length>0?o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Series"}),o.jsx("th",{children:"Avg Days"}),o.jsx("th",{children:"Longest"}),o.jsx("th",{children:"Shortest"}),o.jsx("th",{children:"Reads Count"})]})}),o.jsx("tbody",{children:B.map(Q=>o.jsxs("tr",{children:[o.jsx("td",{children:Q.title}),o.jsxs("td",{children:[Q.avg.toFixed(1)," days"]}),o.jsxs("td",{children:[Math.round(Q.max)," days"]}),o.jsxs("td",{children:[Math.round(Q.min)," days"]}),o.jsx("td",{children:Q.count})]},Q.key))})]}):o.jsx("p",{style:{marginTop:8},children:"No series-level data yet."})]})]})}if(S==="collectionValue"){const{msrpTotal:B,paidTotal:Q}=jn,he=B-Q,Ie=B>0?(Q/B*100).toFixed(1):"-",Ge=[...$r].filter(Ae=>Ae.msrp||Ae.paid||Ae.collectible).sort((Ae,Je)=>Je.msrp+Je.collectible-(Ae.msrp+Ae.collectible));return o.jsxs(o.Fragment,{children:[o.jsx("h3",{children:"Collection Value Breakdown"}),o.jsx("table",{children:o.jsxs("tbody",{children:[o.jsxs("tr",{children:[o.jsx("th",{children:"Total MSRP"}),o.jsxs("td",{children:["$",B.toFixed(2)]})]}),o.jsxs("tr",{children:[o.jsx("th",{children:"Total Paid"}),o.jsxs("td",{children:["$",Q.toFixed(2)]})]}),o.jsxs("tr",{children:[o.jsx("th",{children:"Difference"}),o.jsxs("td",{children:["$",he.toFixed(2)]})]}),o.jsxs("tr",{children:[o.jsx("th",{children:"Paid vs MSRP"}),o.jsx("td",{children:Ie==="-"?"-":`${Ie}%`})]})]})}),Ge.length>0&&o.jsxs(o.Fragment,{children:[o.jsx("h4",{style:{marginTop:"14px"},children:"Collection Pricing"}),o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Title"}),o.jsx("th",{children:"MSRP"}),o.jsx("th",{children:"Paid"}),o.jsx("th",{children:"Collectible"}),o.jsx("th",{children:"Books"})]})}),o.jsx("tbody",{children:Ge.map((Ae,Je)=>o.jsxs("tr",{children:[o.jsx("td",{children:Ae.title}),o.jsxs("td",{children:["$",Ae.msrp.toFixed(2)]}),o.jsxs("td",{children:["$",Ae.paid.toFixed(2)]}),o.jsx("td",{children:Ae.collectible?`$${Ae.collectible.toFixed(2)}`:"--"}),o.jsx("td",{children:Ae.books})]},Ae.title+Je))})]})]})]})}if(S==="pages"){const B=[...$r].filter(Q=>Q.pages>0).map(Q=>({...Q,pct:Q.pages?Math.round(Q.readPages/Q.pages*100):0})).sort((Q,he)=>he.pages-Q.pages);return o.jsxs(o.Fragment,{children:[o.jsx("h3",{children:"Pages Read vs Total"}),o.jsx("table",{children:o.jsxs("tbody",{children:[o.jsxs("tr",{children:[o.jsx("th",{children:"Total Pages"}),o.jsx("td",{children:xn.total.toLocaleString()})]}),o.jsxs("tr",{children:[o.jsx("th",{children:"Pages Read"}),o.jsx("td",{children:xn.read.toLocaleString()})]}),o.jsxs("tr",{children:[o.jsx("th",{children:"Completion"}),o.jsx("td",{children:xn.total?`${(xn.read/xn.total*100).toFixed(1)}%`:"-"})]})]})}),B.length>0&&o.jsxs(o.Fragment,{children:[o.jsx("h4",{style:{marginTop:"14px"},children:"Pages by Series"}),o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Title"}),o.jsx("th",{children:"Read Pages"}),o.jsx("th",{children:"Total Pages"}),o.jsx("th",{children:"% Read"}),o.jsx("th",{children:"Books"})]})}),o.jsx("tbody",{children:B.map((Q,he)=>o.jsxs("tr",{children:[o.jsx("td",{children:Q.title}),o.jsx("td",{children:Q.readPages.toLocaleString()}),o.jsx("td",{children:Q.pages.toLocaleString()}),o.jsxs("td",{children:[Q.pct,"%"]}),o.jsx("td",{children:Q.books})]},Q.title+he))})]})]})]})}if(S==="ratings"){const B=[...$r].map(Q=>{if(!Q.ratings.length)return null;const he=Q.ratings.reduce((Ie,Ge)=>Ie+Ge,0)/Q.ratings.length;return{title:Q.title,avg:he,count:Q.ratings.length}}).filter(Boolean).sort((Q,he)=>he.avg-Q.avg||he.count-Q.count);return o.jsxs(o.Fragment,{children:[o.jsx("h3",{children:"Ratings Overview"}),kn==null?o.jsx("p",{children:"No ratings have been recorded yet."}):o.jsxs("p",{children:["Average series rating across rated series is"," ",o.jsx("strong",{children:kn.toFixed(2)}),"."]}),B.length>0&&o.jsxs(o.Fragment,{children:[o.jsx("h4",{style:{marginTop:"14px"},children:"Series Averages"}),o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Title"}),o.jsx("th",{children:"Avg"}),o.jsx("th",{children:"Ratings"})]})}),o.jsx("tbody",{children:B.map((Q,he)=>o.jsxs("tr",{children:[o.jsx("td",{children:Q.title}),o.jsx("td",{children:Q.avg.toFixed(2)}),o.jsx("td",{children:Q.count})]},Q.title+he))})]})]})]})}return S==="releases"?o.jsxs(o.Fragment,{children:[o.jsx("h3",{children:"Library & Wishlist Releases"}),Ze.length===0?o.jsx("p",{children:"No wishlist releases found."}):o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Date"}),o.jsx("th",{children:"Title"})]})}),o.jsx("tbody",{children:Ze.map((B,Q)=>o.jsxs("tr",{children:[o.jsx("td",{children:B.date.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}),o.jsx("td",{children:B.title})]},Q))})]})]}):null}return o.jsxs("div",{className:"page dashboard-page",children:[o.jsxs("header",{className:"dashboard-header",style:{display:"flex",alignItems:"center",justifyContent:"center",position:"relative",textAlign:"center",width:"100%"},children:[o.jsxs("div",{style:{textAlign:"center",margin:"0 auto",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"0 60px"},children:[o.jsx("h1",{style:{margin:0,fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Dashboard"}),o.jsx("p",{className:"dashboard-sub",style:{textAlign:"center",margin:"6px 0 0"},children:"My Entire Statistics dashboard for my Manga. I still use Excel though."})]}),e&&o.jsx("div",{style:{position:"absolute",right:0,top:"50%",transform:"translateY(-50%)"},children:o.jsx("button",{className:"stat-link",onClick:()=>Ne(!0),type:"button",children:"Admin Settings"})})]}),o.jsx("section",{id:"dashboardSection",className:"page-section active",children:o.jsxs("div",{className:"dashboard-grid",children:[o.jsxs("div",{className:"stat-stack",children:[o.jsxs("div",{className:"stat-card mini clickable",onClick:Ns,children:[o.jsx("h3",{children:"Total Library Books"}),o.jsx("div",{className:"stat-value",children:yr}),o.jsx("div",{className:"stat-sub",children:"Volumes in your library."})]}),o.jsxs("div",{className:"stat-card mini",children:[o.jsx("h3",{children:"Wishlist Items"}),o.jsx("div",{className:"stat-value",children:Rr}),o.jsx("div",{className:"stat-sub",children:"Tracked upcoming wants."})]})]}),o.jsxs("div",{className:"stat-card clickable",onClick:pt,role:"button",tabIndex:0,onKeyDown:S=>{(S.key==="Enter"||S.key===" ")&&(S.preventDefault(),pt())},children:[o.jsx("h3",{children:"Read / Unread"}),o.jsx("div",{className:"pie",style:{"--pct":`${Xn*3.6}deg`},children:o.jsxs("div",{className:"pie-label",children:[Xn,"%"]})}),o.jsxs("div",{className:"stat-value",children:[bs," read / ",Jn," unread"]})]}),o.jsxs("div",{className:"stat-card clickable",onClick:()=>sn("ratings"),children:[o.jsx("h3",{children:"Ratings"}),o.jsx("div",{className:"stat-value",children:kn==null?"-":kn.toFixed(2)}),o.jsx("div",{className:"stat-sub",children:"Average across rated series."}),o.jsx("div",{className:"stat-list compact",children:ht.length?ht.map((S,B)=>o.jsxs("div",{className:"stat-list-row",children:[o.jsx("span",{className:"stat-rank",children:B+1}),o.jsx("span",{className:"stat-name",children:S.title}),o.jsx("span",{className:"stat-count",children:S.avg.toFixed(2)})]},S.title+B)):o.jsx("div",{className:"stat-sub",children:"No ratings yet."})})]}),o.jsxs("div",{className:"stat-card clickable",onClick:()=>sn("pages"),children:[o.jsx("h3",{children:"Page Count Read / Total"}),o.jsxs("div",{className:"stat-value",children:[xn.read.toLocaleString()," / ",xn.total.toLocaleString()]}),o.jsx("div",{className:"stat-sub",children:xn.total?`${(xn.read/xn.total*100).toFixed(1)}% read`:"-"})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("h3",{children:"Library vs Wishlist"}),o.jsx("div",{className:"pie",style:{"--pct":`${Re*3.6}deg`},children:o.jsxs("div",{className:"pie-label",children:[Re,"%"]})}),o.jsxs("div",{className:"stat-value",children:[yr," / ",Rr]}),o.jsx("div",{className:"stat-sub",children:"Library vs wishlist share"})]}),o.jsxs("div",{className:"stat-card clickable",onClick:()=>sn("demographics"),children:[o.jsx("h3",{children:"Top Demographics"}),o.jsx("div",{className:"stat-list",children:Bn.length?Bn.slice(0,3).map((S,B)=>o.jsxs("div",{className:"stat-list-row",children:[o.jsx("span",{className:"stat-rank",children:B+1}),o.jsx("span",{className:"stat-name",children:S.name}),o.jsx("span",{className:"stat-count",children:S.count})]},S.name)):o.jsx("div",{className:"stat-sub",children:"No demographic data yet."})})]}),o.jsxs("div",{className:"stat-card clickable",onClick:()=>sn("publishers"),children:[o.jsx("h3",{children:"Top Publishers"}),o.jsx("div",{className:"stat-list",children:Cs.length?Cs.slice(0,3).map((S,B)=>o.jsxs("div",{className:"stat-list-row",children:[o.jsx("span",{className:"stat-rank",children:B+1}),o.jsx("span",{className:"stat-name",children:S.name}),o.jsx("span",{className:"stat-count",children:S.count})]},S.name)):o.jsx("div",{className:"stat-sub",children:"No publisher data yet."})})]}),o.jsxs("div",{className:"stat-card clickable",onClick:()=>sn("genres"),children:[o.jsx("h3",{children:"Top Genres"}),o.jsx("div",{className:"stat-list",children:Is.length?Is.slice(0,3).map((S,B)=>o.jsxs("div",{className:"stat-list-row",children:[o.jsx("span",{className:"stat-rank",children:B+1}),o.jsx("span",{className:"stat-name",children:S.name}),o.jsx("span",{className:"stat-count",children:S.count})]},S.name)):o.jsx("div",{className:"stat-sub",children:"No genre data yet."})})]}),o.jsxs("div",{className:"stat-card clickable",onClick:()=>{Ps()},children:[o.jsx("h3",{children:"Next Wishlist Release"}),o.jsx("div",{className:"stat-value next-release",children:er?er.title:"No upcoming releases"}),o.jsxs("div",{className:"stat-sub",children:[Ft?Ft.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"}):"-",o.jsx("br",{}),o.jsx("span",{id:"statNextCountdown",children:T})]})]}),o.jsxs("div",{className:"stat-card clickable",onClick:()=>sn("collectionValue"),style:{textAlign:"center"},children:[o.jsx("h3",{children:"Collection Pricing"}),o.jsxs("div",{className:"stat-value stat-msrp",children:["$",jn.msrpTotal.toFixed(2)]}),o.jsxs("div",{className:"stat-value stat-paid",children:["$",jn.paidTotal.toFixed(2),jn.msrpTotal>0&&o.jsxs("span",{className:"stat-paid-pct",children:["(",((1-jn.paidTotal/jn.msrpTotal)*100).toFixed(1),"% off)"]})]}),o.jsxs("div",{className:"stat-value stat-collectible",children:["$",jn.collectibleTotal.toFixed(2)]}),o.jsx("div",{className:"stat-sub",children:"MSRP | Paid | Collectible overrides"})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("h3",{children:"Current Year Reads"}),o.jsx("div",{className:"stat-value",children:qs}),o.jsxs("div",{className:"stat-sub",children:["Reads in ",Nn]})]}),o.jsxs("div",{className:"stat-card clickable",onClick:()=>sn("timeToRead"),children:[o.jsx("h3",{children:"Avg Days From Purchase to Read"}),o.jsx("div",{className:"stat-value",children:An==null?"-":`${An.toFixed(1)} days`}),o.jsx("div",{className:"stat-sub",children:"When both dates exist"})]}),o.jsxs("div",{className:"stat-duo",children:[o.jsxs("div",{className:"stat-card tall",children:[o.jsxs("h3",{children:["Reads Per Month (",Nn,")"]}),o.jsx(zR,{data:Ar})]}),o.jsxs("div",{className:"stat-card tall",children:[o.jsx("h3",{children:"Reads by Day of Week (Lifetime)"}),o.jsx(BR,{data:vr}),o.jsx("div",{className:"stat-sub",children:"Based on all entries with a read date."})]})]}),o.jsxs("div",{className:"stat-card wide",children:[o.jsx("h3",{children:"Activity Log"}),os&&o.jsx("div",{className:"error",style:{textAlign:"center"},children:v}),o.jsx("div",{className:"activity-log scrollable",children:Ce.length?Ce.map((S,B)=>{const Q=S.ts?new Date(S.ts):null;return o.jsxs("div",{className:"activity-row",children:[o.jsx("span",{className:"activity-title",children:S.message}),o.jsx("span",{className:"activity-date",children:Q?Q.toLocaleString(void 0,{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}):""})]},(S.message||"activity")+B)}):o.jsx("div",{className:"stat-sub",children:"No recent activity yet."})})]}),o.jsxs("div",{className:"stat-card wide",style:{minHeight:"340px",maxHeight:"480px"},children:[o.jsx("h3",{children:"Suggestions"}),Qe&&o.jsx("div",{className:"error",style:{textAlign:"center"},children:Qe}),o.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",alignItems:"stretch"},children:["anime","manga"].map(S=>{const B=Te.filter(Q=>(Q.type||"").toLowerCase()===S).sort((Q,he)=>{var Ie,Ge,Ae,Je;return(((Ge=(Ie=he.createdAt)==null?void 0:Ie.getTime)==null?void 0:Ge.call(Ie))||0)-(((Je=(Ae=Q.createdAt)==null?void 0:Ae.getTime)==null?void 0:Je.call(Ae))||0)});return o.jsxs("div",{style:{border:"1px solid rgba(255,182,193,0.18)",borderRadius:"16px",padding:"10px 12px",display:"flex",flexDirection:"column",background:"rgba(255,182,193,0.04)",minHeight:"240px"},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"8px",position:"relative"},children:[o.jsx("h4",{style:{margin:0,color:"#ffb6c1",textAlign:"center",flex:1},children:S==="anime"?"Anime":"Manga"}),o.jsxs("span",{className:"stat-sub",style:{position:"absolute",right:0},children:[B.length," suggestion",B.length===1?"":"s"]})]}),o.jsx("div",{className:"scrollable",style:{maxHeight:"280px",height:"280px",paddingRight:"4px",overflowY:"auto"},children:ke?o.jsx("div",{className:"stat-sub",children:"Loading suggestions..."}):B.length?B.map(Q=>{const he=Q.createdAt instanceof Date?Q.createdAt:Q.createdAt?new Date(Q.createdAt):null;return o.jsxs("div",{style:{border:"1px solid rgba(255,182,193,0.25)",borderRadius:"12px",padding:"8px 10px",marginBottom:"8px",background:"rgba(255,182,193,0.06)",display:"grid",gridTemplateColumns:"1fr auto",gap:"6px",alignItems:"center"},children:[o.jsxs("div",{children:[o.jsx("div",{style:{fontWeight:600,color:"#f7d0dc"},children:Q.content||"(no content)"}),o.jsxs("div",{className:"stat-sub",style:{fontSize:"0.8rem"},children:[he?he.toLocaleString(void 0,{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}):""," ",Q.from?`| ${Q.from}`:""]})]}),o.jsx("div",{style:{display:"flex",gap:"6px"},children:e&&o.jsx("button",{type:"button",className:"stat-link",onClick:()=>Ss(Q.id),children:"Delete"})})]},Q.id)}):o.jsx("div",{className:"stat-sub",children:"No suggestions yet."})})]},S)})}),o.jsxs("div",{className:"stat-sub",style:{marginTop:"8px",textAlign:"center"},children:["Total suggestions: ",Te.length]})]}),o.jsxs("div",{className:"stat-card wide",children:[o.jsx("h3",{children:"Library Manager"}),hn.length?o.jsxs("div",{className:"dash-library",children:[o.jsxs("div",{className:"dash-library-list",children:[hn.map(S=>{const B=S.books.filter(Ae=>!!Ae.read||Ae.status==="Read"||Ae.Read===!0).length,Q=q.has(S.seriesKey),he=ie===S.seriesKey&&!Ee,Ie=NR(S),Ge=S.books.some(Ae=>S_(Ae));return o.jsxs("div",{style:{marginBottom:"8px"},children:[o.jsxs("button",{type:"button",onClick:()=>pn(S.seriesKey),style:{width:"100%",textAlign:"left",background:Ie?"rgba(255,179,71,0.08)":"transparent",border:`1px solid ${he?"#ff69b4":Ie?"rgba(255,179,71,0.6)":"rgba(255,182,193,0.25)"}`,color:"#ffb6c1",padding:"8px",borderRadius:"8px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"8px",position:"relative",boxShadow:Ie?"0 0 10px rgba(255,179,71,0.5)":he?"0 0 8px rgba(255,105,180,0.5)":"none"},children:[o.jsx("span",{style:{transition:"transform 0.2s ease",transform:Q?"rotate(90deg)":"none"},children:">"}),o.jsx("span",{style:{flex:1},children:S.displayName}),o.jsxs("span",{style:{fontSize:"11px",color:"#f8d1d8"},children:[S.books.length," book",S.books.length===1?"":"s",S.books.length?` | ${B} read`:""]}),Ge&&o.jsx("span",{title:"Some volumes are missing required data",style:{width:"12px",height:"12px",borderRadius:"999px",background:"#ffb347",border:"1px solid rgba(255,255,255,0.25)",boxShadow:"0 0 10px rgba(255,179,71,0.6)"}})]}),o.jsx("div",{style:{margin:"6px 0 10px 10px",paddingLeft:"10px",borderLeft:"1px solid rgba(255,182,193,0.25)",display:Q?"block":"none"},children:S.books.map(Ae=>{const Je=Ee===Ae.id,ut=V.has(Ae.id);Ae.read||Ae.status==="Read"||Ae.Read;const yt=S_(Ae,{ignoreShared:!0});return o.jsxs("button",{type:"button",onClick:Lt=>x(Lt,Ae.id,S.seriesKey),style:{width:"100%",textAlign:"left",background:yt?"rgba(255,179,71,0.1)":"transparent",border:`1px solid ${Je?"#ff69b4":ut?"#fff59d":yt?"rgba(255,179,71,0.6)":"rgba(255,182,193,0.25)"}`,color:"#ffb6c1",padding:"8px",borderRadius:"8px",marginBottom:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"8px",boxShadow:Je?"0 0 8px rgba(255,105,180,0.5)":ut?"0 0 10px rgba(255,255,180,0.65)":yt?"0 0 10px rgba(255,179,71,0.5)":"none"},children:[o.jsx("span",{style:{flex:1,minWidth:0},children:Ae.Title||Ae.title||"Untitled"}),yt&&o.jsx("span",{style:{flexShrink:0,padding:"2px 8px",borderRadius:"999px",background:"rgba(255,179,71,0.18)",border:"1px solid rgba(255,179,71,0.6)",color:"#ffd8a1",fontSize:"11px",fontWeight:700,whiteSpace:"nowrap"},children:"Missing data"})]},Ae.id)})})]},S.seriesKey)}),hn.length>0&&V.size>0&&o.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:o.jsx("button",{type:"button",style:{padding:"6px 12px",borderRadius:"999px",border:"1px solid #ffb6c1",background:"transparent",color:"#ffb6c1",cursor:"pointer"},onClick:z,children:"Clear Selection"})})]}),o.jsxs("div",{className:"dash-library-details",children:[V.size>0&&o.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px",padding:"10px",marginBottom:"10px",border:"1px dashed rgba(255,182,193,0.45)",borderRadius:"10px",background:"rgba(255,182,193,0.08)"},children:[o.jsxs("div",{children:["Apply Amount Paid to ",V.size," selected book",V.size===1?"":"s"]}),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",flexWrap:"wrap"},children:[o.jsx("input",{type:"number",step:"0.01",min:"0",value:A,onChange:S=>M(S.target.value),style:{maxWidth:"140px"}}),o.jsx("button",{type:"button",className:"dash-btn primary",onClick:$,children:"Apply to Selected"})]})]}),!ie&&!Ee&&o.jsx("div",{className:"stat-sub",style:{marginTop:6},children:"Select a series or book to edit"}),ie&&!Ee&&Me&&o.jsxs("div",{children:[o.jsx("div",{className:"dash-detail-title",children:Me.displayName}),o.jsx("div",{className:"dash-detail-row",children:o.jsxs("label",{className:"inline-checkbox",children:[o.jsx("input",{ref:D,type:"checkbox",checked:N.readChecked,onChange:S=>b(B=>({...B,readChecked:S.target.checked,readIndeterminate:!1}))}),o.jsx("span",{children:"Mark series as read"})]})}),o.jsxs("div",{className:`dash-detail-row${Be.publisher?" missing-row":""}`,children:[o.jsx("span",{children:"Publisher"}),o.jsx("input",{type:"text",value:N.publisher,onChange:S=>b(B=>({...B,publisher:S.target.value})),placeholder:"Set publisher for series"})]}),o.jsxs("div",{className:`dash-detail-row${Be.demographic?" missing-row":""}`,children:[o.jsx("span",{children:"Demographic"}),o.jsxs("select",{value:N.demographic,onChange:S=>b(B=>({...B,demographic:S.target.value})),children:[o.jsx("option",{value:"",children:"Select Demographic"}),o.jsx("option",{value:"Shounen",children:"Shounen"}),o.jsx("option",{value:"Seinen",children:"Seinen"}),o.jsx("option",{value:"Shoujo",children:"Shoujo"}),o.jsx("option",{value:"Josei",children:"Josei"})]})]}),o.jsxs("div",{className:`dash-detail-row${Be.genre?" missing-row":""}`,children:[o.jsx("span",{children:"Genre"}),o.jsx("input",{type:"text",value:N.genre,onChange:S=>b(B=>({...B,genre:S.target.value})),placeholder:"Primary genre"})]}),o.jsxs("div",{className:"dash-detail-row",children:[o.jsx("span",{children:"Sub-Genre"}),o.jsx("input",{type:"text",value:N.subGenre,onChange:S=>b(B=>({...B,subGenre:S.target.value})),placeholder:"Secondary genre / theme"})]}),!N.dateMixed&&o.jsxs("div",{className:`dash-detail-row${Be.datePurchased?" missing-row":""}`,children:[o.jsx("span",{children:"Date Purchased"}),o.jsx("input",{type:"date",value:N.datePurchased,onChange:S=>b(B=>({...B,datePurchased:S.target.value}))})]}),o.jsxs("div",{className:`dash-detail-row${Be.msrp?" missing-row":""}`,children:[o.jsx("span",{children:"MSRP (per book)"}),o.jsx("input",{type:"number",step:"0.01",min:"0",value:N.msrp,onChange:S=>b(B=>({...B,msrp:S.target.value})),placeholder:"0.00"})]}),o.jsxs("div",{className:"dash-detail-actions",children:[o.jsx("button",{type:"button",className:"dash-btn secondary",onClick:pe,children:"Cancel"}),o.jsx("button",{type:"button",className:"dash-btn primary",onClick:O,children:"Save Series"})]})]}),Ee&&ge&&o.jsxs("div",{children:[o.jsx("div",{className:"dash-detail-title",children:ge.Title||ge.title||"Untitled"}),o.jsx("div",{className:"dash-detail-row",children:o.jsxs("label",{className:"inline-checkbox",children:[o.jsx("input",{type:"checkbox",checked:!!J.read,onChange:S=>re(B=>({...B,read:S.target.checked,dateRead:S.target.checked?B.dateRead||new Date().toISOString().slice(0,10):"",rating:S.target.checked?B.rating:""}))}),o.jsx("span",{children:"Mark as read"})]})}),o.jsxs("div",{className:`dash-detail-row${le.datePurchased?" missing-row":""}`,children:[o.jsx("span",{children:"Date Purchased"}),o.jsx("input",{type:"date",value:J.datePurchased,onChange:S=>re(B=>({...B,datePurchased:S.target.value}))})]}),J.read&&o.jsxs("div",{className:"dash-detail-row",children:[o.jsx("span",{children:"Date Read"}),o.jsx("input",{type:"date",value:J.dateRead,onChange:S=>re(B=>({...B,dateRead:S.target.value}))})]}),o.jsxs("div",{className:`dash-detail-row${le.pageCount?" missing-row":""}`,children:[o.jsx("span",{children:"Page Count"}),o.jsx("input",{type:"number",min:"0",step:"1",value:J.pageCount,onChange:S=>re(B=>({...B,pageCount:S.target.value}))})]}),o.jsxs("div",{className:`dash-detail-row${le.msrp?" missing-row":""}`,children:[o.jsx("span",{children:"MSRP (per book)"}),o.jsx("input",{type:"number",step:"0.01",min:"0",value:J.msrp,onChange:S=>re(B=>({...B,msrp:S.target.value})),placeholder:"0.00"})]}),!(J.special&&J.specialType==="collectible")&&o.jsxs("div",{className:`dash-detail-row${le.amountPaid?" missing-row":""}`,children:[o.jsx("span",{children:"Amount Paid"}),o.jsx("input",{type:"number",step:"0.01",min:"0",value:J.amountPaid,onChange:S=>re(B=>({...B,amountPaid:S.target.value})),placeholder:"0.00"})]}),J.read&&o.jsxs("div",{className:"dash-detail-row",children:[o.jsx("span",{children:"Star Rating"}),o.jsx("input",{type:"number",min:"0",max:"5",step:"0.5",value:J.rating,onChange:S=>re(B=>({...B,rating:S.target.value})),placeholder:"0-5"})]}),o.jsx("div",{className:`dash-detail-row${le.specialType?" missing-row":""}`,children:o.jsxs("label",{className:"inline-checkbox",style:{width:"100%"},children:[o.jsx("input",{type:"checkbox",checked:!!J.special,onChange:S=>re(B=>({...B,special:S.target.checked,specialType:S.target.checked?B.specialType:"",specialVolumes:S.target.checked?B.specialVolumes:"",collectiblePrice:S.target.checked?B.collectiblePrice:""}))}),o.jsx("span",{children:"Special?"})]})}),J.special&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:`dash-detail-row${le.specialType?" missing-row":""}`,children:[o.jsx("span",{children:"Special Type"}),o.jsxs("select",{value:J.specialType,onChange:S=>re(B=>({...B,specialType:S.target.value,specialVolumes:S.target.value==="specialEdition"?B.specialVolumes:"",collectiblePrice:S.target.value==="collectible"?B.collectiblePrice:""})),children:[o.jsx("option",{value:"",children:"Select type"}),o.jsx("option",{value:"specialEdition",children:"Special Edition"}),o.jsx("option",{value:"collectible",children:"Collectible"})]})]}),J.specialType==="specialEdition"&&o.jsxs("div",{className:`dash-detail-row${le.specialVolumes?" missing-row":""}`,children:[o.jsx("span",{children:"Volumes Contained"}),o.jsx("input",{type:"number",min:"1",step:"1",value:J.specialVolumes,onChange:S=>re(B=>({...B,specialVolumes:S.target.value}))})]}),J.specialType==="collectible"&&o.jsxs("div",{className:`dash-detail-row${le.collectiblePrice?" missing-row":""}`,children:[o.jsx("span",{children:"Collectible Price"}),o.jsx("input",{type:"number",min:"0",step:"0.01",value:J.collectiblePrice,onChange:S=>re(B=>({...B,collectiblePrice:S.target.value})),placeholder:"0.00"})]})]}),o.jsxs("div",{className:"dash-detail-actions",children:[o.jsx("button",{type:"button",className:"dash-btn secondary",onClick:ne,children:"Cancel"}),o.jsx("button",{type:"button",className:"dash-btn primary",onClick:W,children:"Save Changes"})]})]})]})]}):o.jsx("div",{className:"stat-sub",children:"No library items."})]})]})}),Ot&&o.jsx("div",{id:"calendarOverlay",onClick:S=>{S.target===S.currentTarget&&Rt()},children:o.jsxs("div",{id:"calendarCard",onClick:S=>S.stopPropagation(),children:[o.jsxs("div",{className:"calendar-header",children:[o.jsx("div",{className:"calendar-title",children:new Date(Un.year,Un.month).toLocaleString(void 0,{month:"long",year:"numeric"})}),o.jsxs("div",{className:"calendar-nav",children:[o.jsx("button",{className:"calendar-nav-btn",onClick:()=>kr(-1),type:"button",children:"<"}),o.jsx("button",{className:"calendar-nav-btn",onClick:()=>kr(1),type:"button",children:">"})]})]}),o.jsxs("div",{className:"calendar-weekdays",children:[o.jsx("div",{children:"Sun"}),o.jsx("div",{children:"Mon"}),o.jsx("div",{children:"Tue"}),o.jsx("div",{children:"Wed"}),o.jsx("div",{children:"Thu"}),o.jsx("div",{children:"Fri"}),o.jsx("div",{children:"Sat"})]}),o.jsxs("div",{className:"calendar-grid",children:[ls.cells.map((S,B)=>{if(S.type==="pad")return o.jsx("div",{className:"calendar-day pad"},`pad-${B}`);const{day:Q,dateKey:he,items:Ie,isToday:Ge}=S;return o.jsxs("div",{className:"calendar-day"+(Ie.length?" has-releases":"")+(Ge?" today":""),onClick:()=>{Ie.length&&zn({date:he,items:Ie})},role:"button",tabIndex:0,onKeyDown:Ae=>{if(Ae.key==="Enter"||Ae.key===" "){if(Ae.preventDefault(),!Ie.length)return;zn({date:he,items:Ie})}},children:[o.jsx("div",{className:"day-num",children:Q}),o.jsxs("div",{className:"calendar-releases",children:[Ie.slice(0,2).map(Ae=>o.jsx("div",{className:"calendar-release purchased",children:Ae.title||"Untitled"},Ae.id)),Ie.length>2&&o.jsxs("div",{className:"calendar-release more",children:["+",Ie.length-2," more"]})]})]},he)}),!ls.hasItems&&o.jsx("div",{className:"calendar-empty",children:"No purchases for this month."})]}),o.jsx("button",{id:"calendarClose",onClick:Rt,type:"button",children:"x"})]})}),Pn&&o.jsx("div",{className:"purchase-overlay",onClick:S=>{S.target===S.currentTarget&&zn(null)},children:o.jsxs("div",{className:"purchase-day-modal",onClick:S=>S.stopPropagation(),children:[o.jsxs("div",{className:"purchase-day-header",children:[o.jsx("div",{className:"purchase-day-title",children:new Date(Pn.date).toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"})}),o.jsx("button",{className:"manga-btn secondary",onClick:()=>zn(null),type:"button",children:"x"})]}),o.jsx("div",{className:"purchase-day-list",children:Pn.items.map(S=>o.jsx("div",{className:"purchase-day-item",children:S.title||"Untitled"},S.id))})]})}),Yt&&o.jsx("div",{id:"calendarOverlay",onClick:()=>tn(!1),style:{zIndex:10060},children:o.jsxs("div",{id:"calendarCard",onClick:S=>S.stopPropagation(),children:[o.jsxs("div",{className:"calendar-header",children:[o.jsx("div",{className:"calendar-title",children:nn.toLocaleString(void 0,{month:"long",year:"numeric"})}),o.jsxs("div",{className:"calendar-nav",children:[o.jsx("button",{className:"calendar-nav-btn",onClick:()=>cs(-1),type:"button",children:"<"}),o.jsx("button",{className:"calendar-nav-btn",onClick:()=>cs(1),type:"button",children:">"})]})]}),o.jsxs("div",{className:"calendar-weekdays",children:[o.jsx("div",{children:"Sun"}),o.jsx("div",{children:"Mon"}),o.jsx("div",{children:"Tue"}),o.jsx("div",{children:"Wed"}),o.jsx("div",{children:"Thu"}),o.jsx("div",{children:"Fri"}),o.jsx("div",{children:"Sat"})]}),o.jsx("div",{className:"calendar-grid",children:Ks.map((S,B)=>{var Q;return S.type==="pad"?o.jsx("div",{className:"calendar-day pad"},B):o.jsxs("div",{className:"calendar-day"+(S.isToday?" today":"")+((Q=S.releases)!=null&&Q.length?" has-releases":""),onClick:()=>{var Ie;if(!((Ie=S.releases)!=null&&Ie.length))return;const he=new Date(nn.getFullYear(),nn.getMonth(),S.day);Yn({dateLabel:he.toLocaleDateString(void 0,{month:"long",day:"numeric",year:"numeric"}),releases:S.releases})},role:"button",tabIndex:0,onKeyDown:he=>{var Ie;if(he.key==="Enter"||he.key===" "){if(he.preventDefault(),!((Ie=S.releases)!=null&&Ie.length))return;const Ge=new Date(nn.getFullYear(),nn.getMonth(),S.day);Yn({dateLabel:Ge.toLocaleDateString(void 0,{month:"long",day:"numeric",year:"numeric"}),releases:S.releases})}},children:[o.jsx("div",{className:"day-num",children:S.day}),o.jsxs("div",{className:"calendar-releases",children:[(S.releases||[]).slice(0,2).map((he,Ie)=>o.jsx("div",{className:"calendar-release purchased",title:he.title,children:he.title},Ie)),(S.releases||[]).length>2&&o.jsxs("div",{className:"calendar-release more",children:["+",(S.releases||[]).length-2," more"]})]})]},S.dateKey||B)})}),!jr.length&&o.jsx("div",{className:"calendar-empty",children:"No reads recorded yet."}),o.jsx("button",{id:"calendarClose",onClick:()=>tn(!1),type:"button",children:"x"})]})}),rn&&o.jsx("div",{id:"calendarOverlay",onClick:()=>Yn(null),style:{zIndex:10080},children:o.jsxs("div",{id:"calendarCard",onClick:S=>S.stopPropagation(),style:{maxWidth:"520px"},children:[o.jsxs("div",{className:"calendar-header",children:[o.jsx("div",{className:"calendar-title",children:rn.dateLabel}),o.jsx("button",{className:"calendar-close-btn",onClick:()=>Yn(null),type:"button",children:"x"})]}),o.jsx("div",{className:"calendar-releases modal-list",children:rn.releases.map((S,B)=>o.jsx("div",{className:"calendar-release purchased",title:S.title,children:S.title},B))})]})}),Tt&&o.jsx("div",{id:"calendarOverlay",onClick:()=>Ct(!1),children:o.jsxs("div",{id:"calendarCard",onClick:S=>S.stopPropagation(),children:[o.jsxs("div",{className:"calendar-header",children:[o.jsx("div",{className:"calendar-title",children:gt.toLocaleString(void 0,{month:"long",year:"numeric"})}),o.jsxs("div",{className:"calendar-nav",children:[o.jsx("button",{className:"calendar-nav-btn",onClick:()=>Nt(new Date(gt.getFullYear(),gt.getMonth()-1,1)),children:"<"}),o.jsx("button",{className:"calendar-nav-btn",onClick:()=>Nt(new Date(gt.getFullYear(),gt.getMonth()+1,1)),children:">"})]})]}),o.jsxs("div",{className:"calendar-weekdays",children:[o.jsx("div",{children:"Sun"}),o.jsx("div",{children:"Mon"}),o.jsx("div",{children:"Tue"}),o.jsx("div",{children:"Wed"}),o.jsx("div",{children:"Thu"}),o.jsx("div",{children:"Fri"}),o.jsx("div",{children:"Sat"})]}),o.jsx("div",{className:"calendar-grid",id:"releaseCalendar",children:fr.map((S,B)=>S.type==="pad"?o.jsx("div",{className:"calendar-day pad"},B):o.jsxs("div",{className:"calendar-day"+(S.isToday?" today":""),children:[o.jsx("div",{className:"day-num",children:S.day}),o.jsxs("div",{className:"calendar-releases",children:[(ve===S.dateKey?S.releases:S.releases.slice(0,2)).map((Q,he)=>o.jsx("div",{className:"calendar-release"+(Q.purchased?" purchased":""),title:Q.title,children:Q.title},he)),S.releases.length>2&&o.jsxs("button",{className:"calendar-more-btn",onClick:()=>{const Q=new Date(gt.getFullYear(),gt.getMonth(),S.day);me({dateLabel:Q.toLocaleDateString(void 0,{month:"long",day:"numeric",year:"numeric"}),releases:S.releases})},children:["+",S.releases.length-2," more"]})]})]},B))}),!Ze.length&&o.jsx("div",{className:"calendar-empty",children:"No wishlist releases found."}),o.jsx("button",{id:"calendarClose",onClick:()=>Ct(!1),children:"x"})]})}),Jt.open&&o.jsx("div",{id:"statDetailOverlay",onClick:Dn,children:o.jsxs("div",{id:"statDetailCard",onClick:S=>S.stopPropagation(),children:[o.jsx("button",{id:"statDetailClose",onClick:Dn,children:"x"}),o.jsxs("h2",{id:"statDetailTitle",children:[Jt.type==="publishers"&&"Top Publishers",Jt.type==="genres"&&"Top Genres",Jt.type==="demographics"&&"Top Demographics",Jt.type==="timeToRead"&&"Avg Time From Purchase to Read",Jt.type==="collectionValue"&&"Collection Value",Jt.type==="pages"&&"Pages Read vs Total",Jt.type==="ratings"&&"Ratings",Jt.type==="releases"&&"Library & Wishlist Releases"]}),o.jsx("div",{id:"statDetailBody",children:Rs()})]})}),Ve&&o.jsx("div",{id:"calendarOverlay",onClick:()=>me(null),style:{zIndex:10080},children:o.jsxs("div",{id:"calendarCard",onClick:S=>S.stopPropagation(),style:{maxWidth:"520px"},children:[o.jsxs("div",{className:"calendar-header",children:[o.jsx("div",{className:"calendar-title",children:Ve.dateLabel}),o.jsx("button",{className:"calendar-close-btn",onClick:()=>me(null),type:"button",children:"x"})]}),o.jsx("div",{className:"calendar-releases modal-list",children:Ve.releases.map((S,B)=>o.jsx("div",{className:"calendar-release"+(S.purchased?" purchased":""),title:S.title,children:S.title},B))})]})}),e&&ce&&o.jsx("div",{className:"dashboard-modal-backdrop visible",onClick:S=>{S.target===S.currentTarget&&Ne(!1)},children:o.jsxs("div",{className:"dashboard-modal",children:[o.jsxs("div",{className:"dashboard-modal-header",children:[o.jsx("h3",{children:"Webhook Settings"}),o.jsx("button",{className:"dashboard-close",onClick:()=>Ne(!1),type:"button",children:"X"})]}),o.jsxs("div",{className:"dashboard-modal-body",children:[o.jsxs("label",{className:"dashboard-input",children:[o.jsx("span",{children:"Yearly summary webhook"}),o.jsx("input",{type:"text",value:U.yearly,onChange:S=>X(B=>({...B,yearly:S.target.value}))})]}),o.jsxs("label",{className:"dashboard-input",children:[o.jsx("span",{children:"Release timer webhook"}),o.jsx("input",{type:"text",value:U.release,onChange:S=>X(B=>({...B,release:S.target.value}))})]}),o.jsxs("label",{className:"dashboard-input",children:[o.jsx("span",{children:"Activity webhook"}),o.jsx("input",{type:"text",value:U.activity,onChange:S=>X(B=>({...B,activity:S.target.value}))})]}),o.jsxs("div",{className:"dashboard-input",style:{borderTop:"1px solid rgba(255,182,193,0.2)",paddingTop:8},children:[o.jsx("span",{children:"User roles"}),o.jsx("div",{style:{marginTop:8,fontSize:"0.85rem",color:"var(--text-soft)"},children:k?o.jsx("span",{children:"Loading users"}):_e.length===0?o.jsx("span",{children:"No users found."}):o.jsx("ul",{style:{listStyle:"none",margin:"6px 0 0",padding:0,display:"flex",gap:6,flexDirection:"column"},children:_e.map(S=>o.jsxs("li",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:8,background:"rgba(24,5,18,0.7)",border:"1px solid rgba(255,182,193,0.18)",borderRadius:10,padding:"6px 8px",flexWrap:"wrap"},children:[o.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:2},children:[o.jsx("strong",{children:S.displayName||S.email||S.uid}),o.jsx("span",{style:{fontSize:"0.85rem",opacity:.8},children:S.email||S.uid})]}),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[o.jsx("span",{className:"role-pill",children:S.role||"viewer"}),S.role==="admin"?o.jsx("button",{className:"dashboard-close",type:"button",onClick:()=>Ye(S.uid,"viewer"),style:{padding:"4px 10px"},children:"Make viewer"}):o.jsx("button",{className:"stat-link",type:"button",onClick:()=>Ye(S.uid,"admin"),style:{padding:"4px 10px"},children:"Make admin"})]})]},S.uid))})})]})]}),o.jsxs("div",{className:"dashboard-modal-footer",children:[o.jsx("button",{className:"stat-link",type:"button",onClick:async()=>{try{await ui(Dt(ot,"settings","webhooks"),{yearly:U.yearly||Il,release:U.release||Pl,activity:U.activity||Pa}),Ne(!1)}catch(S){console.error("Failed to save webhooks",S),alert("Failed to save webhooks.")}},children:"Save"}),o.jsx("button",{className:"stat-link danger",type:"button",onClick:()=>Ne(!1),children:"Cancel"})]})]})})]})}function WR(){const[n,e]=j.useState(!0),[t,s]=j.useState(""),[a,l]=j.useState(0),[d,f]=j.useState([]),[m,v]=j.useState(0),w=j.useRef(null);j.useEffect(()=>{document.title="Music | im.ok"},[]),j.useEffect(()=>{let we=!1;async function V(){e(!0),s("");try{const ae=await fetch("https://music-api-worker.imokissick.workers.dev/music");if(!ae.ok)throw new Error("Worker fetch failed");const I=await ae.json();if(we)return;const P=Array.isArray(I.combined)?I.combined:[],A=Array.isArray(I.spotify)?I.spotify:[],M=Array.isArray(I.soundcloud)?I.soundcloud:[],N=[...P,...A,...M].reduce((b,J)=>{const re=(J.title||"").toLowerCase().trim();if(!re)return b;const Ce=b.findIndex(de=>(de.title||"").toLowerCase().trim()===re);return Ce>=0?(b[Ce].source!=="spotify"&&J.source==="spotify"&&(b[Ce]=J),b):(b.push(J),b)},[]).map(b=>({...b,releaseDate:b.releaseDate?new Date(b.releaseDate):new Date}));f(N)}catch(ae){console.error(ae),we||s("Failed to load music feeds.")}finally{we||e(!1)}}return V(),()=>{we=!0}},[]);const T=Math.min(4,Math.max(1,d.length)),C=T?Math.ceil(d.length/T):0,U=()=>{w.current&&clearInterval(w.current),d.length&&(v(we=>we+1),w.current=setInterval(()=>{l(we=>(Math.floor(we/T)+1)%C*T%d.length),v(we=>we+1)},15e3))};j.useEffect(()=>{if(d.length)return U(),()=>{w.current&&clearInterval(w.current)}},[d,T]);const X=we=>{d.length&&(l(V=>(Math.floor(V/T)+we+C)%C*T%d.length),U())},q=we=>{d.length&&(l(we*T%d.length),U())},F=we=>V=>{V.preventDefault();const I=we.source==="spotify"?`spotify:album:${we.id}`:we.url,P=we.url;try{const A=setTimeout(()=>{window.open(P,"_blank","noopener,noreferrer")},600);window.location.href=I,setTimeout(()=>clearTimeout(A),800)}catch{window.open(P,"_blank","noopener,noreferrer")}},ie=d[0],Se=we=>we?{backgroundImage:`url(${we})`,backgroundSize:"cover",backgroundPosition:"center"}:{},Ee=ie?ie.source==="spotify"?"Spotify":"SoundCloud":"";return o.jsxs("main",{className:"page music-page",children:[o.jsxs("header",{className:"music-hero",children:[o.jsxs("div",{className:"music-hero-content",children:[o.jsx("p",{className:"music-pill",children:"im.ok  Artist"}),o.jsx("h1",{children:ie?ie.title:"Latest & Greatest"}),o.jsx("p",{className:"music-sub",children:"Check out my latest song. I know it's been almost a whole year since I've released. I have been on a much needed hiatus. I felt the whole world crumbling around me and had no time to breathe so this is why I took a break. Here's to 2026!"}),ie&&o.jsx("div",{className:"music-badges",children:o.jsx("span",{children:Ee})})]}),o.jsx("div",{className:"music-hero-embed",children:o.jsxs("div",{className:"music-hero-art",style:Se(ie==null?void 0:ie.artwork),children:[!(ie!=null&&ie.artwork)&&o.jsx("div",{className:"music-hero-art-fallback",children:"Artwork"}),ie&&o.jsx("button",{className:"music-link music-play hero-play","aria-label":`Play ${ie.title}`,onClick:F(ie)})]})})]}),o.jsxs("section",{className:"music-section",children:[o.jsx("div",{className:"music-section-header",children:o.jsx("h2",{children:"Releases"})}),t&&o.jsx("div",{className:"music-error",children:t}),n&&o.jsx("div",{className:"music-loading",children:"Loading music feeds..."}),!n&&d.length===0&&o.jsx("div",{className:"music-empty",children:"Connect Spotify/SoundCloud tokens to see live releases."}),!n&&d.length>0&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"music-carousel-wrap",children:[o.jsx("button",{className:"music-nav left",onClick:()=>X(-1),"aria-label":"Previous releases",children:""}),o.jsx("div",{className:"music-carousel",children:Array.from({length:T}).map((we,V)=>{const ae=d[(a+V)%d.length];return ae?o.jsxs("div",{className:"music-card",children:[o.jsx("div",{className:"music-card-art",style:Se(ae.artwork)}),o.jsxs("div",{className:"music-card-body",children:[o.jsx("div",{className:"music-card-title",children:ae.title}),o.jsx("div",{className:"music-card-actions",children:o.jsx("button",{className:"music-link music-play","aria-label":`Play ${ae.title}`,onClick:F(ae)})})]})]},`${ae.id}-${V}`):null})}),o.jsx("button",{className:"music-nav right",onClick:()=>X(1),"aria-label":"Next releases",children:""})]}),o.jsx("div",{className:"music-dots",children:Array.from({length:C}).map((we,V)=>{const ae=Math.floor(a/T)===V,I=ae?`${V}-${m}`:`${V}-idle`;return o.jsx("button",{className:`dot ${ae?"active":""}`,onClick:()=>q(V),"aria-label":`Go to set ${V+1}`,children:o.jsx("span",{className:"dot-fill"},I)},V)})})]})]}),o.jsxs("div",{className:"music-feeds-row",children:[o.jsxs("section",{className:"music-section",children:[o.jsx("div",{className:"music-section-header",children:o.jsx("h2",{children:"Spotify"})}),o.jsx("div",{className:"music-embed-card",children:o.jsx("iframe",{title:"Spotify Artist",src:"https://open.spotify.com/embed/artist/00sbWLxYLDs8i5BLQL9Qdo?utm_source=generator&theme=0",width:"100%",height:"400",frameBorder:"0",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy"})})]}),o.jsxs("section",{className:"music-section",children:[o.jsx("div",{className:"music-section-header",children:o.jsx("h2",{children:"SoundCloud"})}),o.jsx("div",{className:"music-embed-card",children:o.jsx("iframe",{title:"SoundCloud Player",width:"100%",height:"400",scrolling:"no",frameBorder:"no",allow:"autoplay",src:"https://w.soundcloud.com/player/?url=https%3A//soundcloud.com/imxk&color=%23ff69b4&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true&visual=true"})})]})]})]})}function GR(){const n=tc(),{user:e}=Ba(),t=async a=>{if(!(a!=null&&a.uid))return;const l=Dt(ot,"users",a.uid);try{const d=await Nd(l),f=d.exists()?d.data():null,m=(f==null?void 0:f.role)||"viewer";await ui(l,{role:m,email:a.email||(f==null?void 0:f.email)||"",displayName:a.displayName||(f==null?void 0:f.displayName)||"",createdAt:(f==null?void 0:f.createdAt)||Da()},{merge:!0})}catch(d){console.warn("Failed to upsert user doc",d)}};j.useEffect(()=>{e!=null&&e.uid&&t(e).finally(()=>n("/"))},[e,n]);async function s(){try{const a=new vs,l=await k0(ts,a);await t(l.user),n("/")}catch(a){console.error(a),alert("Google Sign-In failed.")}}return o.jsx("div",{className:"signin-page",children:o.jsxs("div",{className:"signin-card",children:[o.jsx("h2",{className:"signin-title",children:"Welcome Back"}),o.jsx("p",{className:"signin-sub",children:"Sign in to access the dashboard & edit collections."}),o.jsxs("button",{className:"google-btn",onClick:s,children:[o.jsx("img",{src:"https://www.svgrepo.com/show/475656/google-color.svg",alt:"",className:"google-icon"}),"Continue with Google"]}),o.jsxs("button",{className:"signin-cancel",onClick:()=>n("/"),children:["<"," Back to Home"]})]})})}const qR=j.lazy(()=>pc(()=>import("./SteamCard-yEgjDLQJ.js"),[])),HR=j.lazy(()=>pc(()=>import("./SteamRecents-DxBcO_0n.js"),[])),KR=j.lazy(()=>pc(()=>import("./SteamGames-TsDa54qC.js"),[]));function QR(){return j.useEffect(()=>{document.title="Tyler's Gaming Lounge"},[]),o.jsxs("div",{className:"steam-page page",children:[o.jsxs("header",{style:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center",gap:"6px"},children:[o.jsx("h1",{style:{margin:0,fontSize:"2rem",color:"#ffb6c1",textShadow:"0 0 8px rgba(255,182,193,0.8)",fontWeight:700},children:"Tyler's Gaming Lounge"}),o.jsx("p",{style:{margin:"6px 0 0",color:"var(--text-soft)",fontSize:"0.9rem"},children:"This will be the home to all of my gaming collections, this is still being worked on, but thought it was cool with just steam for now."})]}),o.jsx(vf,{minHeight:260,children:o.jsx(j.Suspense,{fallback:o.jsx(Lu,{label:"Profile"}),children:o.jsx(qR,{})})}),o.jsx(vf,{minHeight:240,children:o.jsx(j.Suspense,{fallback:o.jsx(Lu,{label:"Recently played"}),children:o.jsx(HR,{})})}),o.jsx(vf,{minHeight:400,children:o.jsx(j.Suspense,{fallback:o.jsx(Lu,{label:"Library & Achievements"}),children:o.jsx(KR,{})})})]})}function vf({children:n,minHeight:e=200}){const[t,s]=j.useState(!1),a=j.useRef(null);j.useEffect(()=>{const d=new IntersectionObserver(f=>{f[0].isIntersecting&&(s(!0),d.disconnect())},{rootMargin:"200px 0px"});return a.current&&d.observe(a.current),()=>d.disconnect()},[]);const l=t?void 0:{minHeight:e};return o.jsx("div",{ref:a,style:l,children:t?n:o.jsx(Lu,{})})}function Lu({label:n="Loading section"}){return o.jsxs("div",{className:"steam-skeleton",children:[o.jsx("div",{className:"steam-skeleton-bar"}),o.jsx("div",{className:"steam-skeleton-bar short"}),o.jsx("p",{className:"steam-skeleton-label",children:n})]})}const _f={id:null,title:"",summary:"",body:"",cover:"",tags:"",status:"draft",publishedAt:null};function Vu(n){return n?n instanceof Date?n:n!=null&&n.toDate?n.toDate():null:null}function Tu(n){const e=Vu(n);return e?e.toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"}):""}function YR(n=[]){return Array.isArray(n)?n.join(", "):""}function JR(n){return(n||"").split(",").map(e=>e.trim()).filter(Boolean)}function XR(){var Ce;const{admin:n,user:e,loading:t}=Ba(),[s,a]=LT(),[l,d]=j.useState([]),[f,m]=j.useState(!0),[v,w]=j.useState(!1),[T,C]=j.useState(!1),[U,X]=j.useState(""),[q,F]=j.useState(_f),[ie,Se]=j.useState(null),Ee=j.useMemo(()=>l.filter(de=>de.status==="published"),[l]),we=j.useMemo(()=>n?l:Ee,[n,l,Ee]),V=j.useMemo(()=>we.find(de=>de.id===ie)||null,[ie,we]);j.useEffect(()=>{document.title="Blog | Reviews"},[]),j.useEffect(()=>{t||P()},[n,t]),j.useEffect(()=>{const de=s.get("post");de&&Se(de)},[s]),j.useEffect(()=>{var _e;if(f)return;const ce=s.get("post")||ie,Ne=ce&&we.some(Y=>Y.id===ce)?ce:((_e=we[0])==null?void 0:_e.id)||null;A(Ne,{list:we})},[f,we]);const ae=!n&&!f&&Ee.length===0;function I(de){return{id:de.id,title:de.title||"",summary:de.summary||"",body:de.body||"",cover:de.cover||"",tags:YR(de.tags),status:de.status||"draft",publishedAt:de.publishedAt||null}}async function P(de=null){var ce;if(!t){m(!0),X("");try{const Ne=Cn(ot,"blogPosts"),_e=n?Jf(Ne,Xf("updatedAt","desc")):Jf(Ne,lx("status","==","published"),Xf("publishedAt","desc")),k=(await _s(_e)).docs.map(De=>{const ke=De.data();return{id:De.id,...ke,createdAt:Vu(ke.createdAt),updatedAt:Vu(ke.updatedAt),publishedAt:Vu(ke.publishedAt),tags:Array.isArray(ke.tags)?ke.tags:[]}});d(k);const H=n?k:k.filter(De=>De.status==="published"),Te=de||s.get("post")||(H.length?H[0].id:null);Te&&H.some(De=>De.id===Te)?A(Te,{list:H}):A(((ce=H[0])==null?void 0:ce.id)||null,{list:H})}catch(Ne){console.error("Failed to load blog posts",Ne);const _e=(Ne==null?void 0:Ne.code)==="permission-denied";X(_e?"You do not have permission to view these posts. Make sure you are signed in with an admin account.":"Failed to load posts. Try again shortly.")}finally{m(!1)}}}function A(de,{list:ce}={}){Se(de||null),a(de?{post:de}:{});const Ne=ce||l;if(n){const _e=Ne.find(Y=>Y.id===de);F(_e?I(_e):_f)}}function M(de){A(de),window.scrollTo({top:0,behavior:"smooth"})}function D(){F(_f),Se(null),a({})}function N(de){const ce=de||q.status||"draft",Ne=ce==="published"?q.publishedAt||Da():null;return{title:q.title.trim(),summary:q.summary.trim(),body:q.body.trim(),cover:q.cover.trim(),tags:JR(q.tags),status:ce,publishedAt:Ne,updatedAt:Da()}}async function b(de="draft"){if(!(!n||v)){if(!q.title.trim()||!q.body.trim()){X("Title and body are required.");return}w(!0),X("");try{const ce=N(de);let Ne=q.id;q.id?await ws(Dt(ot,"blogPosts",q.id),ce):Ne=(await Aa(Cn(ot,"blogPosts"),{...ce,createdAt:Da()})).id,X(de==="published"?"Post published and visible to everyone.":"Draft saved."),await P(Ne)}catch(ce){console.error("Failed to save blog post",ce),X("Could not save the post. Try again.")}finally{w(!1)}}}async function J(de){if(!(!n||!de||T||!window.confirm("Delete this post? This cannot be undone."))){C(!0),X("");try{await Ra(Dt(ot,"blogPosts",de)),X("Post deleted."),await P(),D()}catch(Ne){console.error("Failed to delete post",Ne),X("Could not delete the post.")}finally{C(!1)}}}const re=((V==null?void 0:V.body)||"").split(/\n{2,}/).map((de,ce)=>o.jsx("p",{className:"blog-body-paragraph",children:de},ce));return t?o.jsx("div",{className:"page blog-page",children:o.jsx("div",{className:"blog-guard-card",children:"Checking access..."})}):e?n?o.jsxs("div",{className:"page blog-page",children:[o.jsxs("header",{className:"blog-hero",children:[o.jsx("div",{className:"blog-pill",children:n?"Admin workspace":"Latest updates"}),o.jsx("h1",{children:"Blog & Reviews"}),o.jsx("p",{children:"Share reviews for anime or manga you have read. Draft privately, publish when ready, and keep visitors in the loop with new releases."})]}),U&&o.jsx("div",{className:"blog-status",children:U}),o.jsxs("div",{className:"blog-shell",children:[o.jsxs("aside",{className:"blog-sidebar",children:[o.jsxs("div",{className:"blog-sidebar-header",children:[o.jsxs("div",{children:[o.jsx("div",{className:"blog-sidebar-label",children:"Posts"}),o.jsxs("div",{className:"blog-sidebar-count",children:[we.length," ",we.length===1?"entry":"entries"]})]}),n&&o.jsx("button",{type:"button",className:"blog-btn solid",onClick:D,children:"+ New draft"})]}),o.jsxs("div",{className:"blog-list",children:[f&&o.jsx("div",{className:"blog-muted",children:"Loading posts..."}),!f&&!we.length&&o.jsx("div",{className:"blog-muted",children:"No posts yet."}),we.map(de=>o.jsxs("button",{className:"blog-list-item"+(ie===de.id?" active":""),onClick:()=>M(de.id),children:[o.jsxs("div",{className:"blog-list-row",children:[o.jsx("span",{className:"blog-list-title",children:de.title||"Untitled"}),o.jsx("span",{className:"blog-chip "+(de.status==="published"?"success":"draft"),children:de.status==="published"?"Published":"Draft"})]}),o.jsx("div",{className:"blog-list-sub",children:de.status==="published"?`Published ${Tu(de.publishedAt)}`:`Last touched ${Tu(de.updatedAt)}`})]},de.id))]})]}),o.jsxs("section",{className:"blog-main",children:[ae?o.jsxs("div",{className:"blog-guard-card",children:[o.jsx("h3",{children:"Under construction"}),o.jsx("p",{children:"This blog page is being built. Once posts are published, they will appear here. Admins can already create and publish posts."})]}):V?o.jsxs("article",{className:"blog-article",children:[o.jsxs("div",{className:"blog-article-meta",children:[o.jsx("span",{className:"blog-chip "+(V.status==="published"?"success":"draft"),children:V.status==="published"?"Published":"Draft"}),o.jsx("span",{className:"blog-meta-text",children:V.status==="published"?`Published ${Tu(V.publishedAt)}`:`Last saved ${Tu(V.updatedAt)}`})]}),o.jsx("h2",{className:"blog-article-title",children:V.title||"Untitled"}),V.summary&&o.jsx("p",{className:"blog-article-summary",children:V.summary}),V.cover&&o.jsx("div",{className:"blog-cover",children:o.jsx("img",{src:V.cover,alt:""})}),o.jsx("div",{className:"blog-body",children:re}),(Ce=V.tags)!=null&&Ce.length?o.jsx("div",{className:"blog-tag-row",children:V.tags.map(de=>o.jsx("span",{className:"blog-chip ghost",children:de},de))}):null]}):o.jsxs("div",{className:"blog-guard-card",children:[o.jsx("h3",{children:"No post selected"}),o.jsx("p",{children:"Select a post from the left to read it."})]}),n&&o.jsxs("div",{className:"blog-editor-card",children:[o.jsxs("div",{className:"blog-editor-header",children:[o.jsxs("div",{children:[o.jsx("div",{className:"blog-sidebar-label",children:q.id?"Edit post":"New draft"}),o.jsx("div",{className:"blog-sidebar-count",children:q.id?"Update and publish when ready":"Fill in the details to create"})]}),q.id&&o.jsx("button",{type:"button",className:"blog-btn danger",onClick:()=>J(q.id),disabled:T,children:T?"Deleting...":"Delete"})]}),o.jsxs("div",{className:"blog-form",children:[o.jsxs("label",{className:"blog-field",children:[o.jsx("span",{children:"Title"}),o.jsx("input",{type:"text",value:q.title,onChange:de=>F(ce=>({...ce,title:de.target.value})),placeholder:"e.g., Chainsaw Man Volume 14 Review"})]}),o.jsxs("label",{className:"blog-field",children:[o.jsx("span",{children:"Summary"}),o.jsx("input",{type:"text",value:q.summary,onChange:de=>F(ce=>({...ce,summary:de.target.value})),placeholder:"One-liner that appears in previews"})]}),o.jsxs("label",{className:"blog-field",children:[o.jsx("span",{children:"Cover image URL (optional)"}),o.jsx("input",{type:"url",value:q.cover,onChange:de=>F(ce=>({...ce,cover:de.target.value})),placeholder:"https://..."})]}),o.jsxs("label",{className:"blog-field",children:[o.jsx("span",{children:"Tags (comma separated)"}),o.jsx("input",{type:"text",value:q.tags,onChange:de=>F(ce=>({...ce,tags:de.target.value})),placeholder:"anime, manga, review"})]}),o.jsxs("label",{className:"blog-field",children:[o.jsx("span",{children:"Body"}),o.jsx("textarea",{rows:8,value:q.body,onChange:de=>F(ce=>({...ce,body:de.target.value})),placeholder:"Write your review here. Separate paragraphs with blank lines."})]}),o.jsxs("div",{className:"blog-actions",children:[o.jsx("button",{type:"button",className:"blog-btn",onClick:()=>b("draft"),disabled:v,children:v?"Saving...":"Save draft"}),o.jsx("button",{type:"button",className:"blog-btn solid",onClick:()=>b("published"),disabled:v,children:v?"Publishing...":"Publish"}),q.status==="published"&&o.jsx("button",{type:"button",className:"blog-btn ghost",onClick:()=>b("draft"),disabled:v,children:"Move to draft"})]})]})]})]})]})]}):o.jsx(xf,{to:"/home",replace:!0}):o.jsx(xf,{to:"/signin",replace:!0})}function ZR(){return o.jsxs(KN,{children:[o.jsx(eR,{}),o.jsxs(TT,{children:[o.jsx(Zr,{path:"/",element:o.jsx(d_,{})}),o.jsx(Zr,{path:"/home",element:o.jsx(d_,{})}),o.jsx(Zr,{path:"/manga",element:o.jsx(hR,{})}),o.jsx(Zr,{path:"/anime",element:o.jsx(TR,{})}),o.jsx(Zr,{path:"/tcg",element:o.jsx(bR,{})}),o.jsx(Zr,{path:"/music",element:o.jsx(WR,{})}),o.jsx(Zr,{path:"/blog",element:o.jsx(XR,{})}),o.jsx(Zr,{path:"/dashboard",element:o.jsx($R,{})}),o.jsx(Zr,{path:"/signin",element:o.jsx(GR,{})}),o.jsx(Zr,{path:"/steam",element:o.jsx(QR,{})}),o.jsx(Zr,{path:"*",element:o.jsx(xf,{to:"/home",replace:!0})})]})]})}AE.createRoot(document.getElementById("root")).render(o.jsx(tp.StrictMode,{children:o.jsx(AT,{basename:"/base",children:o.jsx(ZR,{})})}));export{o as j,j as r};
